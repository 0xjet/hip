{
    "id": "b563eb7e-db7a-46f9-9598-a14be78570a7",
    "created_at": "2023-01-12T15:04:23.853644Z",
    "updated_at": "2025-03-27T02:09:30.343959Z",
    "deleted_at": null,
    "sha1_hash": "8a68939a9562bb205a6a58c88ca2647cbecd46c3",
    "title": "2021-11-03 - The Darker Things BlackMatter and their victims",
    "authors": "",
    "file_creation_date": "2022-05-29T10:47:35Z",
    "file_modification_date": "2022-05-29T10:47:35Z",
    "file_size": 9031431,
    "plain_text": "# The Darker Things\n\n**blog.group-ib.com/blackmatter2**\n\n03.11.2021\n\nBlackMatter and their victims\n\n\n-----\n\nAndrey Zhdanov\n\nThreat Hunter at Group-IB DFIR Team\n\nToday, on November 3, BlackMatter gang announced it was shutting its Ransomware-as-aService program due to the \"pressure from the authorities\".\n\nHowever, it doesn't mean that BlackMatter's affiliates will stop malicious activity. They will\nmost likely join other RaaS programs. In addition, this might just be an attempt to have a\nfresh start under a different name. Just like BlackMatter was a rebranding of DarkSide, a new\n[successor may appear soon. Therefore, given the similarities that we observed between](https://blog.group-ib.com/blackmatter)\nDarkSide and BlackMatter ransomware back in August, it's important to be aware of the\nlatest ransomware versions' features: malware configuration, encryption mechanisms in use\netc.\n\n\n-----\n\nFor this purpose the experts from Group-IB s Digital Forensics and Incident Response Team\nanalyzed new BlackMatter samples for Windows and Linux, Andrey Zhdanov, Group-IB's\nthreat hunter, will share new data on his findings.\n\nA US architectural firm was among the first to fall victim to BlackMatter in late July 2021.\nSince then, the BlackMatter operators' appetites have grown considerably, the frequency of\nattacks has increased, and the threat actors seem to have been constantly improving their\ntools. The average ransom demand is $5.3 million, with the maximum, which the attackers\ndemanded from Japan's Olympus Corporation, reaching $30 million.\n\nBlackMatter affiliates try their best to pick their victims carefully, so as not to draw too much\nattention, but they are not exactly succeeding. Since the first BlackMatter attacks were\nreported, they have received a lot of very close attention from threat researchers. And on 18\nOctober 2021, the CISA, FBI, and NSA issued joint recommendations, naming BlackMatter\nransomware responsible for attacks on U.S. critical infrastructure that had begun in July\n2021. As of November 2021, the list of BlackMatter victims consists of more than 50\ncompanies based in the US, Austria, Italy, France, Japan, and other countries.\n\n\n-----\n\n**BlackMatter for Windows**\n\nDepending on command line parameters, ransomware for Windows can operate in five\ndifferent modes. We were able to obtain command line arguments based on analysis of their\nhashes.\n\n-path [PATH] – encryption of the specified object (directory, file, network resource).\n\n-safe – self-registration in the RunOnce key of system registry, reboot for file encryption in\nsafe mode.\n\n\n-----\n\n-wall – creating a BMP image with information about encryption of files and setting it as the\ndesktop wallpaper.\n\n[PATH] – encryption of a specified directory/file.\n\nWhen other parameters are set or any parameters are absent, the system is fully encrypted\naccording to the configuration settings. Upon completing the encryption, the ransomware\ncreates a BMP image alerting that files have been encrypted, which it then sets as the\ndesktop wallpaper. Starting from version 1.4, the ransomware can also print the text of the\ndemand for ransom on the victim's default printer.\n\nWhen BlackMatter launches, it checks the rights of the current user and, if necessary, tries to\nbypass the UAC (User Account Control) through privilege escalation using the ICMLuaUtil\nCOM interface. Also, if the appropriate flag is set in the configuration, it attempts to\nauthenticate using the credentials contained in the configuration data.\n\nBefore starting the encryption, BlackMatter deletes shadow copies of partitions using WQL\nqueries (WMI Query Language).\n\nTo encrypt files, BlackMatter uses the most efficient multithreading implementation based on\nthe use of the I/O (input/output) completion port. The malware also sets the highest priority\n(THREAD_PRIORITY_HIGHEST) for the file enumeration and encryption streams. By\ndefault, only the first megabyte of file contents is encrypted. In earlier versions, data was\nencrypted using Salsa20. Apparently, the authors of BlackMatter, just like the authors of\nanother extortionist Petya five years ago, made mistakes in the implementation of the\nSalsa20 algorithm. Starting from version 1.9, the contents of the files are encrypted already\nusing a modified version of the implementation of the ChaCha20 algorithm, presumably\ntaken from CryptoPP library. Furthermore, the ChaCha20 encryption algorithm is\nimplemented using SSSE3 processor instructions. ChaCha20 keys are encrypted using the\nRSA-1024 public key. A data block with an encrypted key is appended to the end of the file.\nThe names of the encrypted files are as follows:\n\n[FILENAME].[VICTIM_ID]\n\nFILENAME – is the original name of the file.\n\nVICTIM_ID – is the victim ID generated on the basis of the string contained in the\nMachineGuid value of the HKLM\\SOFTWARE\\Microsoft\\Cryptography registry key.\n\nThe BlackMatter configuration contains the names of directories, files and extensions\nskipped during the encryption process as lists of checksums (hashes).\n\nIn each processed directory, the ransomware creates text files containing the demand for\nransom:\n\n[VICTIM_ID].README.txt\n\n\n-----\n\n**Configuration**\n\nThe BlackMatter configuration data for Windows is contained in a section disguised as a\n\".rsrc\" resource section, but there are no resources in it.\n\n\n-----\n\nThe first 64-bit number (0F8B2AB512017D0F5h) in the section represents the initial value for\nthe pseudo-random sequence generator (random seed) used to encrypt the program data.\nThe next 32-bit value represents the actual size of the configuration data. Prior to encryption,\nthe configuration data was pre-compressed using the aPLib compression algorithm, which is\npopular among ransomware developers. Previously, this algorithm was found, for example, in\nsuch ransomware families as DarkSide, DoppelPaymer, Clop, and others.\n\nConfiguration data after decryption and decompression.\n\nLogical flags that indicate the ransomware settings:\n\nOffset table of configuration parameter values.\n\nThe table contains 32-bit numbers that represent offsets relative to the beginning of the list\nitself to the rest of the configuration data fields as Base64 strings, ending with a null byte. If\nthe offset is 0, there is no field value.\n\n\n-----\n\n**Known versions**\n\n**BlackMatter for Linux**\n\nBlackMatter ransomware for Linux targets VMware ESXi servers. According to the settings in\nthe configuration data, the ransomware can stop virtual machines and terminate specified\nprocesses before data encryption. The ransomware also disables the firewall. To encrypt\nvirtual machine files, the ransomware uses the esxcli utility to obtain a list of storages with\n\"vmfs\", \"vffs\" and \"nfs\" file systems.\n\nBlackMatter for Linux implements multithreaded file encryption with the extensions specified\nin the configuration. Data is encrypted in blocks that are multiples of one megabyte using the\nHC-256 stream encryption algorithm. HC-256 keys are encrypted using the RSA-4096 public\nkey. The CryptoPP crypto library is used to implement encryption algorithms.\n\nData transferring to the attacker-controlled resources on the internet is implemented in the\nmalware using the libcurl library.\n**Configuration**\n\nBlackMatter configuration data for Linux is contained in the \".cfgETD\" section of the ELF file.\nThe data is encrypted, compressed using the zlib data compression library, and encoded\nusing Base64.\n\nEncrypted configuration data after Base64 decoding and zlib decompression:\n\nConfiguration data is encrypted using a cyclic bytewise XOR operation using the key\ncontained in the first 32 bytes.\n\nAfter decryption, the configuration data is in JSON format.\n\n\n-----\n\nConfiguration parameters\n\n**Known versions**\n\n**Victims and threat actors**\n\n\n-----\n\nTo identify its victims, BlackMatter uses a unique 16-byte identifier contained in the\nconfiguration data: company_id (Windows version) and bot-id (Linux version). For each\nvictim, the attackers create a Tor chat room for communication. The link to this chat is\nspecified in the text file containing the ransom demand.\n\nWhen the ultimatum expires, the threat actors double the ransom amount, and later publish\nthe stolen documents after the victim refuses to pay.\n\n\n-----\n\nInitially, these chats were public, and many people were privy to the correspondence\nbetween BlackMatter \"tech support\" and their victims and even tried to outwit them.\n\n\n-----\n\n-----\n\nSource: https://twitter.com/ddd1ms/status/1441044423798820889\n\nOn September 23, 2021, BlackMatter partners closed public access to chat rooms, and now\na session key is required to log in, which requires verification of the company and\nconfirmation of the victim's affiliation.\n\n\n-----\n\n-----\n\n**Victimology**\n\nCompany_id IDs and Tor links extracted from the ransomware and text files containing the\nransom demand.\n\nAs mentioned above, BlackMatter partners are trying not to draw attention to their activities,\nso the threat actors choose small and medium-sized businesses as the targets of their\nattacks. However, the attacks on Olympus and NEW cooperative caused a public outcry.\n\n**Indicators of compromise**\n\nhttps://paymenthacks[.]com\n\nhttp://paymenthacks[.]com\n\nhttps://mojobiden[.]com\n\n\n-----\n\nhttp://mojobiden[.]com\nhttps://nowautomation[.]com\nhttp://nowautomation[.]com\nhttps://fluentzip[.]org\nhttp://fluentzip[.]org\n\n**SHA-256**\n\n072158f5588440e6c94cb419ae06a27cf584afe3b0cb09c28eff0b4662c15486\n\n22d7d67c3af10b1a37f277ebabe2d1eb4fd25afbd6437d4377400e148bcc08d6\n\n2c323453e959257c7aa86dc180bb3aaaa5c5ec06fa4e72b632d9e4b817052009\n\n3a03530c732ebe53cdd7c17bee0988896d36c2b632dbd6118613697c2af82117\n\n4ad9432cc817afa905bab2f16d4f713af42ea42f5e4fcf53e6d4b631a7d6da91\n\n6155637f8b98426258f5d4321bce4104df56c7771967813d61362c2118632a7b\n\n668a4a2300f36c9df0f7307cc614be3297f036fa312a424765cdb2c169187fe6\n\n72687c63258efe66b99c2287748d686b6cca2b0eb6f5398d17f31cb46294012c\n\n7f6dd0ca03f04b64024e86a72a6d7cfab6abccc2173b85896fc4b431990a5984\n\nc6e2ef30a86baa670590bd21acf5b91822117e0cbe6060060bc5fe0182dace99\n\nc728e3a0d4a293e44314d663945354427848c220d05d5d87cdedd9995fee3dfe\n\nf63c6d08ebfba65173763c61d3767667936851161efa51ff4146c96041a02b20\n\n84af3f15701d259f3729d83beb15ca738028432c261353d1f9242469d791714f\na6e14988d91f09db44273c79cba51c16b444afafa37ba5968851badb2a62ef27\n\n7c642cdeaa55f56c563d82837f4dc630583b516a5d02d5a94b57b65489d74425\n\ncf60d0d6b05bfe2e51ca9dac01a4ae506b90d78d8d9d0fc266e3c01d8d2ba6b7\n\n6d4712df42ad0982041ef0e2e109ab5718b43830f2966bd9207a7fac3af883db\n\n86c84c07e27cc8aba129e1cf51215b65c445f178b94f2e8c4c10e6bc110daa94\n\nb824bbc645f15e213b4cb2628f7d383e9e37282059b03f6fe60f7c84ea1fed1f\n\ne4fd947a781611c85ea2e5afa51b186de7f351026c28eb067ad70028acd72cda\n2466fca0e29b06c78ffa8a44193fb58c30e6bec4e54bbef8e6622349b95cce4c\n\n\n-----\n\n0751c422962dcd500d7cf2cf8bf544ddf5b2fe3465df7dd9b9998f6bba5e08a4\n\n1c63a4fdee1528429886a0de5e89eaa540a058bf27cd378b8d139e045a2f7849\n\n1eea3cbd729d4493c0c0a84efe6840abf1760efe221dc971d32ca5017b5c19c2\n\n20742987e6f743814b25e214f8b2cd43111e2f60a8856a6cca87cafd85422f41\n\n2cdb5edf3039863c30818ca34d9240cb0068ad33128895500721bcdca70c78fd\n\n2e50eb85f6e271001e69c5733af95c34728893145766066c5ff8708dcc0e43b2\n\n3a4bd5288b89aa26fbe39353b93c1205efa671be4f96e50beae0965f45fdcc40\n\n4be85e2083b64838fb66b92195a250228a721cdb5ae91817ea97b37aa53f4a2b\n\n520bd9ed608c668810971dbd51184c6a29819674280b018dc4027bc38fc42e57\n\n5da8d2e1b36be0d661d276ea6523760dbe3fa4f3fdb7e32b144812ce50c483fa\n\n66e6563ecef8f33b1b283a63404a2029550af9a6574b84e0fb3f2c6a8f42e89f\n\n706f3eec328e91ff7f66c8f0a2fb9b556325c153a329a2062dc85879c540839d\n\n8323fdfda08300c691d330badec2607ea050cc10ee39934faeebedf3877df3ac\n\n8f1b0affffb2f2f58b477515d1ce54f4daa40a761d828041603d5536c2d53539\n\n9cf9441554ac727f9d191ad9de1dc101867ffe5264699cafcf2734a4b89d5d6a\n\nb0e929e35c47a60f65e4420389cad46190c26e8cfaabe922efd73747b682776a\n\nb4b9fdf30c017af1a8a3375218e43073117690a71c3f00ac5f6361993471e5e7\n\ncb5a89a31a97f8d815776ff43f22f4fec00b32aae4f580080c7300875d991163\n\ne4a2260bcba8059207fdcc2d59841a8c4ddbe39b6b835feef671bceb95cd232d\n\ne9b24041847844a5d57b033bf0b41dc637eba7664acfb43da5db635ae920a1b4\n\neaac447d6ae733210a07b1f79e97eda017a442e721d8fafe618e2c789b18234b\n\neafce6e79a087b26475260afe43f337e7168056616b3e073832891bf18c299c1\n\nf7b3da61cb6a37569270554776dbbd1406d7203718c0419c922aa393c07e9884\n\n496cd9b6b6b96d6e781ab011d1d02ac3fc3532c8bdd07cae5d43286da6e4838d\n\n2aad85dbd4c79bd21c6218892552d5c9fb216293a251559ba59d45d56a01437c\n\n\n-----\n\n4524784688e60313b8fefdebde441ca447c1330d90b86885fb55d099071c6ec9\n\n5236a8753ab103634867289db0ba1f075f0140355925c7bd014de829454a14a0\n\n69e5f8287029bcc65354abefabb6854b4f7183735bd50b2da0624eb3ae252ea8\n\n730f2d6243055c786d737bae0665267b962c64f57132e9ab401d6e7625c3d0a4\n\n8eada5114fbbc73b7d648b38623fc206367c94c0e76cb3b395a33ea8859d2952\n\nccee26ea662c87a6c3171b091044282849cc8d46d4b9b9da6cf429b8114c4239\n\ned47e6ecca056bba20f2b299b9df1022caf2f3e7af1f526c1fe3b8bf2d6e7404\n\nfe2b2beeff98cae90f58a5b2f01dab31eaa98d274757a7dd9f70f4dc8432a6e2\n\n26a7146fbed74a17e9f2f18145063de07cc103ce53c75c8d79bbc5560235c345\n\n7a223a0aa0f88e84a68da6cde7f7f5c3bb2890049b0bf3269230d87d2b027296\n\n9bae897c19f237c22b6bdc024df27455e739be24bed07ef0d409f2df87eeda58\n\n2f20732aaa3d5ce8d2efeb37fe6fed7e73a29104d8227a1160e8538a3ee27dad\n\n9a8cd3a30e54a2ebb6d73fd7792ba60a6278a7301232321f226bb29fb8d0b3d6\n\n1247a68b960aa81b7517c614c12c8b5d1921d1d2fdf17be636079ad94caf970f\n\n6a7b7147fea63d77368c73cef205eb75d16ef209a246b05698358a28fd16e502\n\n1247a68b960aa81b7517c614c12c8b5d1921d1d2fdf17be636079ad94caf970f\n\n6a7b7147fea63d77368c73cef205eb75d16ef209a246b05698358a28fd16e502\nd4645d2c29505cf10d1b201826c777b62cbf9d752cb1008bef1192e0dd545a82\n\n**YARA rules**\n\n\n-----\n\n```\n/\nBlackMatter ransomware\n*/\nimport \"elf\"\nrule DarkSide_BM\n{\n  meta:\n    author = \"Andrey Zhdanov\"\n    company = \"Group-IB\"\n    family = \"ransomware.darkside_blackmatter\"\n    description = \"DarkSide/BlackMatter ransomware Windows payload\"\n    severity = 10\n    score = 100\n  strings:\n    $h1 = { 64 A1 30 00 00 00 8B B0 A4 00 00 00 8B B8 A8 00\n        00 00 83 FE 05 75 05 83 FF 01 }\n  condition:\n    ((uint16(0) == 0x5A4D) and (uint32(uint32(0x3C)) == 0x00004550)) and\n    (\n      (1 of ($h*))\n    )\n}\nrule BlackMatter\n{\n  meta:\n    author = \"Andrey Zhdanov\"\n    company = \"Group-IB\"\n    family = \"ransomware.blackmatter.windows\"\n    description = \"BlackMatter ransomware Windows payload\"\n    severity = 10\n    score = 100\n  strings:\n    $h0 = { 80 C6 61 80 EE 61 C1 CA 0D 03 D0 }\n    $h1 = { 02 F1 2A F1 B9 0D 00 00 00 D3 CA 03 D0 }\n    $h2 = { 3C 2B 75 04 B0 78 EB 0E 3C 2F 75 04 B0 69 EB 06\n        3C 3D 75 02 B0 7A }\n    $h3 = { 33 C0 40 40 8D 0C C5 01 00 00 00 83 7D 0? 00 75\n        04 F7 D8 EB 0? }\n  condition:\n    ((uint16(0) == 0x5A4D) and (uint32(uint32(0x3C)) == 0x00004550)) and\n    (\n      (1 of ($h*))\n    )\n}\nrule BlackMatter_Linux\n{\n  meta:\n\n```\n\n-----\n\n```\n    author Andrey Zhdanov \n    company = \"Group-IB\"\n    family = \"ransomware.blackmatter.linux\"\n    description = \"BlackMatter ransomware Linux payload\"\n    severity = 10\n    score = 100\n  strings:\n    $h0 = { 0F B6 10 84 D2 74 19 0F B6 34 0F 40 38 F2 74 10\n        48 83 C1 01 31 F2 48 83 F9 20 88 10 49 0F 44 C9\n        48 83 C0 01 4C 39 C0 75 D7 }\n    $h1 = { 44 42 46 44 C7 4? [1-2] 30 35 35 43 C7 4? [1-2]\n        2D 39 43 46 C7 4? [1-2] 32 2D 34 42 C7 4? [1-2]\n        42 38 2D 39 C7 4? [1-2] 30 38 45 2D C7 4? [1-2]\n        36 44 41 32 C7 4? [1-2] 32 33 32 31 C7 4? [1-2]\n        42 46 31 37 }\n  condition:\n    (uint32(0) == 0x464C457F) and\n    (\n      (1 of ($h*)) or\n      for any i in (0..elf.number_of_sections-2):\n      (\n        (elf.sections[i].name == \".app.version\") and\n        (elf.sections[i+1].name == \".cfgETD\")\n      )\n    )\n}\n\n```\n**How to protect your network against ransomware:**\n\nMake your remote access tools secure. Use multifactor authentication or at least set complex\npasswords and change them regularly.\n\nEliminate vulnerabilities in publicly accessible apps as soon as possible, especially those\nthat could allow attackers to bypass the external perimeter.\n\nImplement comprehensive email protection to detect and stem the most sophisticated\nthreats. [More](https://www.group-ib.com/atmosphere.html)\nMonitor what your contractors do in your network. Providing them with remote access should\nbe strictly regulated.\n\nInstantly patch vulnerabilities on hosts on the internal network that attackers could leverage\nto escalate privileges or propagate across the network.\n\nMonitor the use of dual-use tools that could help attackers conduct network reconnaissance,\nobtain authentication data, and much more.\n\nRestrict access to cloud storage. This will help keep attackers from exfiltrating data from the\ncorporate network.\n\n\n-----\n\nMake sure all accounts have the least possible privileges on the systems. In case of an\nattack, this will make it difficult for threat actors to move laterally across the network.\n\nUse separate accounts with multifactor authentication to access servers containing backups.\nMoreover, make sure that you have offline copies.\n\nImplement a modern threat monitoring and blocking tool that will help contain and repel\nattacks at any stage of the kill chain. [More](https://www.group-ib.com/threat-hunting-framework.html)\nFor more information about attacks using manually controlled ransomware, see the Group-IB\nreport \" Ransomware 2020/2021\":\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-03 - The Darker Things BlackMatter and their victims.pdf"
    ],
    "report_names": [
        "2021-11-03 - The Darker Things BlackMatter and their victims.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535863,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653821255,
    "ts_modification_date": 1653821255,
    "files": {
        "pdf": "https://archive.orkl.eu/8a68939a9562bb205a6a58c88ca2647cbecd46c3.pdf",
        "text": "https://archive.orkl.eu/8a68939a9562bb205a6a58c88ca2647cbecd46c3.txt",
        "img": "https://archive.orkl.eu/8a68939a9562bb205a6a58c88ca2647cbecd46c3.jpg"
    }
}