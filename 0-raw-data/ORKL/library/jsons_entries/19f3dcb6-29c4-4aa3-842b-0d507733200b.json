{
    "id": "19f3dcb6-29c4-4aa3-842b-0d507733200b",
    "created_at": "2022-10-25T16:48:11.78139Z",
    "updated_at": "2025-03-27T02:14:34.830631Z",
    "deleted_at": null,
    "sha1_hash": "98bbb00de1817bdd930ea37e6aa4e943e0a6e2db",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-10-23T15:30:16Z",
    "file_modification_date": "2019-10-23T15:30:21Z",
    "file_size": 5489230,
    "plain_text": "# Calypso APT\n\n## 2019\n\n##### ptsecurity.com\n\n\n-----\n\n#### Содержание\n\n###### Calypso APT 2\n\n Исходный вектор 3\n\n Продвижение по сети 4\n\n Атрибуция 4\n\n Анализ вредоносного кода Calypso RAT 6\n\n Дроппер 6\n\n Установочный BAT-скрипт 7\n\n Shellcode x86 — Stager 9\n\n Модули 10\n\n Команды 11\n\n Сетевой код 13\n\n Shellcode x64 – Stager (Base backdoor) 13\n\n Модули 14\n\n Команды 15\n\n Сетевой код 18\n\n Другие варианты 20\n\n Дроппер-stager 20\n\n Hussar 20\n\n Инициализация  20\n\n Модули 22\n\n FlyingDutchman 23\n\n Заключение 26\n\n Индикаторы компрометации 26\n\n Файловые индикаторы 26\n\n MITRE ATT&CK 28\n\n\n-----\n\n### Calypso APT\n\nВпервые активность группы Calypso была выявлена\n\nспециалистами PT Expert Security Center в марте 2019 года,\n\nв ходе работ по обнаружению киберугроз. В результате\n\nбыло получено множество образцов ВПО данной груп\nпы, выявлены пострадавшие организации и контрольные\n\nсерверы злоумышленников.\n\nПо нашим данным, группа активна как минимум с сентя\nбря 2016 года. Основной целью группы является кража\n\nконфиденциальных данных, основные жертвы — государ\nственные учреждения из Бразилии, Индии, Казахстана,\n\nРоссии, Таиланда, Турции.\n\nПолученные нами данные позволяют считать, что группа\n\nимеет азиатские корни[1].\n\n1. См. раздел «Атрибуция».\n\n\n-----\n\n#### Исходный вектор\n\nЗлоумышленники получали доступ к внутренней сети скомпрометированной организации\n\nчерез ASPX-веб-шелл. Они загружали веб-шелл посредством эксплуатации уязвимости\n\nили же могли взломать одну из стандартных учетных записей для сервисов удаленного\n\nдоступа. Нам удалось получить живой трафик между злоумышленниками и веб-шеллом.\n\nРисунок 1. Часть записанного трафика\n\nТрафик показывает, что подключение осуществлялось с IP-адреса 46.166.129.241. На этом\n\nузле располагается домен tv.teldcomtv.com, который является контрольным сервером для\n\nтрояна данной группы. Таким образом, контрольные серверы используются не только для\n\nуправления ВПО, но и для доступа к узлам скомпрометированных инфраструктур.\n\nЧерез веб-шелл злоумышленники загружали утилиты[1] и ВПО[2], исполняли различные\n\nкоманды, а также распространяли ВПО внутри сети. Примеры команд из трафика можно\n\nувидеть ниже.\n\nРисунок 2. Команды, посланные на веб-шелл\n\n1. См. раздел «Продвижение по сети».\n\n2. См. раздел «Анализ вредоносного кода Calypso RAT».\n\n\n-----\n\n#### Продвижение по сети\n\nДля продвижения внутри скомпрометированной сети группа использовала общедоступ\nные утилиты и эксплойты:\n\n\n� SysInternals,\n\n� Nbtscan,\n\n� Mimikatz,\n\n� ZXPortMap,\n\n� TCP Port Scanner,\n\n� Netcat,\n\n� QuarksPwDump,\n\n\n� WmiExec,\n\n� EarthWorm,\n\n� OS_Check_445,\n\n� DoublePulsar,\n\n� EternalBlue,\n\n� EternalRomance.\n\n\nДля хранения ВПО и утилит на скомпрометированных машинах группа использовала либо\n\nC:\\RECYCLER, либо C:\\ProgramData. Первый вариант использовался только на машинах с\n\nсистемами Windows XP или Windows Server 2003 с NTFS на диске C.\n\nЗлоумышленники продвигались внутри сети либо с помощью эксплуатации уязвимости\n\nMS17-010, либо с помощью украденных учетных данных. В одном случае через 13 дней\n\nпосле получения доступа внутрь сети злоумышленники с помощью DCSync через Mimikatz\n\nполучили Kerberos ticket доменного администратора и с его помощью перемещались по\n\nсети и заражали новые машины.\n\nРисунок 3. Получение данных учетной записи через DCSync\n\nИспользование многих названных выше утилит является стандартным для многих APT\nгрупп; большинство этих утилит являются легитимными и используются специалистами\n\nдля администрирования сети. Этот фактор позволяет злоумышленникам дольше оста\nваться незамеченными.\n\n#### Атрибуция\n\nВ одной из атак группа использовала ВПО Calypso RAT, PlugX и троян Byeby. Calypso RAT\n\nявляется уникальным ВПО для данной группы и его детальный анализ будет приведен ниже.\n\nPlugX традиционно используют многие APT-группы азиатского происхождения.\n\nИспользование PlugX не указывает на какую-то конкретную группировку, но в целом свиде\nтельствует в пользу ее азиатских корней.\n\nТроян Byeby[1] использовался в атаках во время кампании SongXY[5] в 2017 году. Используемая\n\nздесь версия является модифицированной. Группа, которая проводила данную кампанию,\n\nтакже имеет азиатские корни и проводила целевые атаки на организации ВПК и правитель\nственные структуры России и стран СНГ. Однако явной связи между данными вредоносны\nми кампаниями мы не обнаружили.\n\nВо время анализа трафика между сервером злоумышленников и веб-шеллом мы обна\nружили, что злоумышленники использовали не анонимный прокси-сервер. В заголовке\n\nX-Forwarded-For передавался, предположительно, реальный (то есть первый в цепи прок\nси-серверов) IP-адрес злоумышленников (36.44.74.47).\n\n1. [unit42.paloaltonetworks.com/unit42-threat-actors-target-government-belarus-using-cmstar-trojan/](https://unit42.paloaltonetworks.com/unit42-threat-actors-target-government-belarus-using-cmstar-trojan/)\n\n2. [ptsecurity.com/upload/corporate/ru-ru/analytics/Cybersecurity-threatscape-2017-Q4-rus.pdf](https://www.ptsecurity.com/upload/corporate/ru-ru/analytics/Cybersecurity-threatscape-2017-Q4-rus.pdf)\n\n\n-----\n\nРисунок 4. Заголовки запроса к веб-шеллу\n\nIP-адрес принадлежит провайдеру China Telecom. Мы предполагаем, что злоумышлен\nники по неосторожности неверно настроили прокси-сервер, чем выдали свой реальный\n\nIP-адрес. Это первое свидетельство азиатского происхождения группы.\n\nРисунок 5. Информация о найденном IP-адресе\n\nЗлоумышленники также оставили множество системных артефактов, следов в конфигу\nрациях утилит и вспомогательных скриптах, по которым можно сделать вывод о проис\nхождении группы.\n\nТак, например, в одном из конфигурационных файлов DoublePulsar был указан внешний\n\nIP-адрес 103.224.82.47, предположительно — для тестирования; при этом во всех осталь\nных конфигурационных файлах были внутренние адреса.\n\nРисунок 6. IP-адрес, найденный в конфигурации DoublePulsar\n\nУказанный IP-адрес, также как и предыдущий, принадлежит китайскому провайдеру и,\n\nскорее всего, был оставлен злоумышленниками по невнимательности. Это второе свиде\nтельство азиатского происхождения группы.\n\nРисунок 7. Информация о найденном IP-адресе\n\n\n-----\n\nМы также обнаружили BAT-скрипты, которые запускали утилиты для проброса портов\n\nZxPortMap и EarthWorm. Внутри них были обнаружены сетевые индикаторы www.sultris.\n\ncom и 46.105.227.110.\n\nРисунок 8. Сетевые индикаторы, найденные в BAT-скриптах\n\nУказанный домен не только использовался для туннелирования трафика, но и являлся\n\nконтрольным сервером для ВПО PlugX, которое также было обнаружено нами в скомпро\nметированной системе. Как мы уже упоминали, PlugX традиционно используют группы\n\nазиатского происхождения; это третье свидетельство.\n\nИтак, используемое злоумышленниками ВПО, а также используемая ими сетевая инфра\nструктура — свидетельствуют об азиатском происхождении группы.\n\n#### Анализ вредоносного кода Calypso RAT\n\nСтруктура ВПО и процесс его установки на узлы скомпрометированной сети выглядят\n\nследующим образом.\n\nРисунок 9. Общая структура ВПО и его установка\n\n#### Дроппер\n\nДроппер извлекает из себя полезную нагрузку в виде установочного BAT-скрипта и CAB\nархива и сохраняет ее на диск. Встроенная внутрь дроппера полезная нагрузка имеет\n\nmagic-заголовок, поиск которого осуществляет дроппер. Пример структуры пейлоада\n\nможно видеть на рисунке ниже.\n\n\n-----\n\nРисунок 10. Структура полезной нагрузки, зашитой в дроппере\n\nДля шифрования и расшифровки данных дроппер использует собственный алгоритм, в\n\nкотором использует CRC32 как PRNG. Алгоритм выполняет арифметические операции\n\nсложения (вычитания) между генерируемыми данными и данными, которые необходимо\n\nзашифровать (расшифровать).\n\nРисунок 11. Собственный алгоритм дроппера для шифрования и расшифровки\n\nРасшифрованная полезная нагрузка сохраняется на диск по пути %ALLUSERSPROFILE;\\\n\nTMP_%d%d, где два последних числа заменяются на случайные, получаемые с помощью\n\nвызовов функции rand(). В зависимости от конфигурации в CAB-архиве содержатся либо\n\nDLL и зашифрованный шеллкод, либо DLL c закодированным загрузчиком в ресурсах,\n\nлибо EXE-файл. Последний вариант нам обнаружить не удалось.\n\n#### Установочный BAT-скрипт\n\nИспользуемый BAT-скрипт закодирован с помощью метода подстановки из заранее задан\nного словаря символов, который инициализирован в одной из переменных установочного\n\nскрипта.\n\nРисунок 12. Пример обфускации установочного скрипта\n\nВ раскодированном скрипте можно увидеть комментарии, которые дают подсказки об\n\nосновных функциях скрипта:\n\n� REM Goto temp directory & extract file (пойти в директорию TEMP и извлечь туда\nфайлы),\n\n� REM Uninstall old version (удалить старую версию),\n\n� REM Copy file (скопировать файл),\n\n\n-----\n\n� REM Run pre-install script (запустить установочный BAT-скрипт),\n\n� REM Create service (создать сервис для запуска ВПО при старте системы),\n\n� REM Create Registry Run (создать значение в ветке реестра для автозапуска).\n\nВ начале каждого скрипта можно увидеть набор переменных, которые скрипт использует\n\nдля сохранения файлов, модификации сервисов, модификации ключей реестра.\n\nРисунок 13. Инициализирующие переменные в деобфусцированном скрипте\n\nВ одном из самых ранних образцов ВПО, скомпилированном в 2016 году, мы обнаружили\n\nскрипт, в котором присутствовали комментарии для конфигурации всех переменных.\n\nРисунок 14. Ранний вариант скрипта с комментариями\n\n\n-----\n\n#### Shellcode x86 — Stager\n\nВ большинстве проанализированных семплов дроппер был сконфигурирован для выпол\nнения шеллкода. Дроппер сохранял на диск DLL и зашифрованный шеллкод. Название\n\nшеллкода всегда повторяло название DLL, но имело расширение .dll.crt. Шеллкод зашиф\nрован таким же алгоритмом, что и полезная нагрузка в дроппере. Шеллкод выполняет роль\n\nстейджера, который предоставляет интерфейс для взаимодействия с С2 и для загрузки\n\nмодулей. Имеет два способа взаимодействия с С2 через TCP и SSL. SSL реализуется через\n\nбиблиотеку mbed_tls.\n\nНачальный анализ шеллкода показал, что помимо динамического поиска API-функций\n\nвыполняется еще одна операция, повторяющая процесс настройки адресов PE-файла.\n\nСтруктура таблицы настройки адресов также повторяет схожую таблицу из PE-файла.\n\nРисунок 15. Структура релокаций шеллкода\n\nТак как процесс настройки адресов шеллкода повторяет процесс настройки адре\nсов PE-файла, можно выдвинуть предположение, что изначально ВПО компилируется в\n\nPE-файл, и после этого билдером превращается в шеллкод. В пользу этого говорит и то,\n\nчто внутри шеллкода обнаружена отладочная информация.\n\nРисунок 16. Отладочная информация внутри шеллкода\n\nПосле динамического поиска API-функций и настройки адресов происходит разбор кон\nфигурации, которая зашита внутри шеллкода. Конфигурация содержит информацию об\n\nадресе контрольного сервера, используемом протоколе и типе подключения.\n\nРисунок 17. Пример конфигурации шеллкода\n\nДалее создается подключение к С2. Генерируется случайный заголовок пакета, который\n\nотправляется на С2. В ответ ВПО получает сетевой ключ, который сохраняется и впослед\nствии используется при каждом взаимодействии с С2. Далее собирается информация о\n\nзараженной машине и отправляется на С2.\n\nЗатем запускаются три потока. Один представляет собой heartbeat, который раз в 54 секунды\n\nотправляет пустой пакет на С2. Другой занимается непосредственной обработкой команд\n\nот С2 и их выполнением. Назначение третьего установить доподлинно невозможно, так как\n\nвырезан участок кода, отвечающий за его функциональность. Можно лишь сказать, что этот\n\nпоток, аналогично первому, должен был «просыпаться» раз в 54 секунды.\n\n\n-----\n\n#### Модули\n\nНа данный момент нам не удалось обнаружить какие-либо модули. Но по анализу кода\n\nвзаимодействия шеллкода и модулей мы можем сказать об их функциональности.Каждый\n\nмодуль представляет собой шеллкод, которому передается управление по нулевому\n\nсмещению. Также каждый модуль существует в отдельном контейнере. Под контейнером\n\nподразумевается процесс, внутрь которого внедряется загруженный модуль. По умолча\nнию таким процессом является svchost.exe. При создании контейнера в него внедряется\n\nнебольшой шеллкод, который осуществляет бесконечный sleep. Он также зашит внутрь\n\nосновного шеллкода, и, вероятно, JustWait.pdb относится именно к нему.\n\nМодуль внедряется внутрь с помощью обычного writeprocess и запускается либо с помо\nщью NtCreateThreadEx, либо — если ВПО запущенно на ОС с версией ниже чем Vista — с\n\nпомощью CreateRemoteThread.\n\nТакже для каждого модуля создаются два пайпа: один для передачи данных от модуля\n\nна С2 и другой для получения данных от С2. Вероятно, модули не имеют своего сетевого\n\nкода и используют пайпы для взаимодействия с внешним управляющим сервером через\n\nосновной шеллкод.\n\nРисунок 18. Создание пайпов для модулей\n\nКаждый модуль обладает своим уникальным идентификатором, который назначается С2.\n\nКонтейнеры также отличаются по способу запуска. Контейнер может быть запущен в кон\nкретной сессии, открытой в ОС, или в той, в которой запущен stager. Запуск контейнера\n\nв конкретной сессии осуществляется путем получения хендла токена, авторизованного\n\nв сессии пользователя, с последующим запуском процесса от имени этого пользователя.\n\n\n-----\n\nРисунок 19. Создание процесса контейнера в другой сессии\n\n#### Команды\n\nИсследованное ВПО может обработать 12 команд. Все они так или иначе относятся к рабо\nте с модулями. Ниже перечислены все идентификаторы команд, обнаруженные ВПО, вме\nсте с теми, что отправляет само ВПО в различных ситуациях.\n\n**Иденти-**\n**Направление** **Тип** **Описание**\n**фикатор**\n\nСоздать описатель модуля. Данная команда\n\nсодержит информацию о размере модуля и его\n\n\n0x401 От С2 Команда\n\n0x402 От С2 Команда\n\n0x403 От С2 Команда\n\n0x404 От С2 Команда\n\n\nидентификаторе, а также выделяет память под\n\nданные модуля. Эта команда, вероятно, долж\nна быть первой в цепочке команд, приводящих\n\nк загрузке модуля\n\nПринять данные модуля, и если все данные\n\nприняты, то осуществить запуск модуля внутри\n\nконтейнера, запущенного в той же сессии,\n\nчто и stager\n\nТо же, что и 0x402, только запуск модуля\n\nосуществляется в контейнере, запущенном\n\nв другой сессии\n\nЗаписать данные в пайп для модуля,\n\nзапущенного внутри контейнера,\n\nработающего в той же сессии, что и stager\n\n\nЗаписать данные в пайп для модуля,\n0x405 От С2 Команда\n\nзапущенного в контейнере в другой сессии\n\n\n0x409 От С2 Команда\n\n\nСгенерировать константу с помощью вызова\n\nGetTickCount() и сохранить ее. Данная константа\n\nиспользуется в описанном выше третьем потоке,\n\nназначение которого установить не удалось\n\n\n-----\n\n0х201 От С2 Команда\n\n0х202 От С2 Команда\n\n0х203 От С2 Команда\n\n0х204 От С2 Команда\n\n0x206 От С2 Команда\n\n0х207 От С2 Команда\n\n0x409 От ВПО Ответ\n\n\nЗапустить модуль, если размер буфера храняще\nгося в описателе модуля равен размеру моду\nля. Не осуществляет прием данных, в отличие\n\nот команд 0х402 и 0х403. Модуль запускается\n\nв контейнере, работающем в той же сессии,\n\nчто и stager\n\nТо же, что и 0х201, только запуск модуля осу\nществляется в контейнере, работающем в дру\nгой сессии\n\nЗакрыть все пайпы, связанные с конкретным\n\nмодулем, работающим в контейнере, который\n\nзапущен в той же сессии, что и stager\n\nТо же, что и 0х203, только для модуля, работаю\nщего в контейнере, который запущен в другой\n\nсессии\n\nСобрать информацию о сессиях, открытых\n\nв системе, и отправить ее на С2 (идентификато\nры сессий, имена машин и т. п.)\n\nНазначить идентификатор сессии. Данный иден\nтификатор будет использоваться для запуска\n\nконтейнеров в этой сессии\n\nДанный идентификатор используется в пустых\n\nheartbeat-пакетах (описанный выше первый\n\nпоток)\n\n\nИдентификатор пакета, содержащего информа0x103 От ВПО Ответ\n\nцию о зараженной машине\n\n\n0x302 От ВПО Ответ\n\n0х304 От ВПО Ответ\n\n\nИдентификатор пакета, отправляемого после\n\nсохранения принятого идентификатора сессии\n\n(команда 0х207)\n\nИдентификатор пакета, отправляемого после\n\nуспешного внедрения модуля внутрь контей\nнера. Данный код отправляется после запуска\n\nмодуля в другой сессии\n\n\nТо же, что 0х304, только модуль был запущен\n0х303 От ВПО Ответ\n\nвнутри той же сессии, что и stager\n\n\n0x406 От ВПО Ответ\n\n\nИдентификатор пакета, который содержит дан\nные, которые записал в свой пайп модуль, рабо\nтающий в контейнере, который запущен в той же\n\nсессии, что и stager\n\n\n-----\n\nАналогично 0х406, только от модуля,\n0x407 От ВПО Ответ\nзапущенного в другой сессии\n\nИдентификатор пакета, отправляемого в случае,\n\n\n0x308 От ВПО Ответ\n\n0x408 От ВПО Ответ\n\n#### Сетевой код\n\n\nесли не удалось получить хендл токена автори\nзованного пользователя в сессии\n\nИдентификатор пакета, отправляемого в случае,\n\nесли невозможно получить информацию о сес\nсиях. Перед отправкой пакета осуществляется\n\nпроверка версии ОС, и если она ниже, чем Vista,\n\nто считается, что реализованным в ВПО спосо\nбом получить информацию невозможно, так как\n\nиспользуемые API-функции Windows появились\n\nначиная с версии Vista\n\n\nИнициализация сетевого взаимодействия происходит после получения сетевого ключа\n\nот С2. Для этого ВПО отправляет на С2 случайную последовательность из 12 байт. В ответ\n\nоно ожидает также 12 байт, где по нулевому смещению должно располагаться то же значе\nние (_DWORD), что и перед отправкой. Если эта проверка проходит, то из ответа берутся\n\n4 байта по смещению 8 и затем выполняется их расшифровка с помощью RC4. В качестве\n\nключа выступают 4 байта, которые были отправлены ранее, располагающиеся также по\n\nсмещению 8. Полученные в результате этого данные и являются сетевым ключом, который\n\nсохраняется и впоследствии используется при отправке данных.\n\nВсе передаваемые пакеты имеют следующую структуру:\n\n\nstruct Packet{\nstruct PacketHeader{\n_ DWORD key;\n_ WORD cmdId;\n_ WORD szPacketPayload;\n_ DWORD moduleId;\n};\n_ BYTE [max 0xF000] packetPayload;\n};\n\n\nДля каждого пакета генерируется случайный 4-байтовый ключ, которым впоследствии\n\nзашифровывается часть заголовка начиная с поля cmdId; с его же помощью шифруется и\n\nполезная нагрузка пакета. Для шифрования используется алгоритм RC4. Сам ключ шиф\nруется с помощью операции XOR c сетевым ключом и сохраняется в соответствующее\n\nполе заголовка пакета.\n\n#### Shellcode x64 — Stager (Base backdoor)\n\nДанный шеллкод очень похож на предыдущий, однако его стоит описать отдельно, так как\n\nон обладает рядом отличий в сетевом коде, а также в способе, которым запускаются моду\nли. Этот шеллкод имеет базовые функции по взаимодействию с файловой системой, кото\nрых нет в ранее описанном шеллкоде. Также данный шеллкод имеет сходство по формату\n\nконфигурации, сетевому коду и сетевым адресам, используемым в качестве С2, с кодом из\n\nпоста в блоге NCC Group от 2018 года о вариации Gh0st RAT[1]. Однако связи с Gh0st RAT мы\n\nне обнаружили.\n\n1. [nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/april/](https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/april/decoding-network-data-fr)\n[decoding-network-data-from-a-gh0st-rat-variant/](https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/april/decoding-network-data-fr)\n\n\n-----\n\nВ данном варианте шеллкода реализован всего один канал взаимодействия через SSL.\n\nШеллкод имплементирует его с помощью двух легитимных библиотек libeay32.dll и ssleay32.\n\ndll, зашитых непосредственно внутрь шеллкода.\n\nВначале происходит динамический поиск API-функций и загрузка SSL-библиотек. SSL\nбиблиотеки не сохраняются на диск, а сразу вычитываются из шеллкода и маппятся в\n\nпамять. Затем ВПО ищет в размеченном образе функции, необходимые для его работы.\n\nДалее происходит разбор конфигурационной строки, также зашитой внутрь шеллкода.\n\nКонфигурация содержит информацию об адресах серверов управления, а также распи\nсание, по которому оно будет работать.\n\nРисунок 20. Пример конфигурационной строки\n\nПосле запускается основной цикл работы ВПО. Осуществляется проверка того, является\n\nли текущее время рабочим временем ВПО, если это не так, то ВПО засыпает примерно на\n\n7 минут и затем проводит проверку еще раз. И так до тех пор, пока текущее время не ока\nжется рабочим, и только тогда ВПО продолжит свою работу. Обратите внимание на рис.\n\n20, в данном примере ВПО будет активно во все дни недели и во все часы.\n\nКогда наступило рабочее время, ВПО начинает последовательно пытаться подключиться\n\nко всем указанным в конфигурации С2. Первый, к которому удалось подключиться, будет\n\nпринят в качестве рабочего.\n\nДалее отправляется информация о зараженной машине (имя компьютера, текущая дата,\n\nверсия ОС, разрядность процессора, разрядность ОС, IP-адреса на сетевых интерфей\nсах, а также их MAC-адреса). Отправив информацию о зараженной машине, ВПО ожидает\n\nответа от С2, и если С2 возвращает необходимый код, то операция отправки информации\n\nо зараженной машине считается успешной, и ВПО продолжает свою работу, а иначе ВПО\n\nвозвращается к этапу последовательного перебора адресов С2. Далее запускается про\nцесс обработки команд, приходящих от С2.\n\n#### Модули\n\nКаждый модуль — это валидный MZPE-файл, который размечается в адресном простран\nстве того же процесса, в котором работает шеллкод. Также модуль может экспортиро\nвать символ GetClassObject, на который передается управление при его запуске (если это\n\nнеобходимо).\n\nКаждый модуль имеет свой описатель, который создается в результате выполнения коман\nды от контрольного сервера. Контрольный сервер присылает массив байтов, описываю\nщий модуль (размером 0x15). Данный массив содержит информацию о модуле: необхо\nдимо ли его запускать через экспорт, тип модуля (по факту — нужны ли ему пайпы для\n\nобратной связи), размер модуля, RVA точки входа (используется, если не установлен флаг\n\nзапуска через экспорт) и ключ для расшифровки данных модуля. Этот ключ представляет\n\nсобой, по большому счету, данные, которые используются для форматирования настоя\nщего ключа.\n\n\n-----\n\nРисунок 21. Расшифровка модуля\n\nТакже отметим, что расшифровка производится — только если modKey не равен зашитой\n\nвнутрь шеллкода константе 7AC9h. Эта проверка влияет только на процесс дешифровки.\n\nЕсли все же modKey будет равен константе, ВПО перейдет сразу к загрузке модуля. Это\n\nбудет означать, что модуль не зашифрован.\n\nДля запуска каждого модуля создается отдельный поток, внутри которого и запускается\n\nмодуль. Процесс запуска с пайпами следующий:\n\n� ВПО создает поток для модуля, начинается процесс маппинга модуля и передача ему\nуправления внутри созданного для него потока;\n\n� ВПО создает новое подключение до текущего рабочего С2;\n\n� ВПО создает пайп с именем, получаемым по форматной строке \\\\.\\pipe\\\nwindows@#%02XMon (значение, которое будет вставлено вместо %02X,\nпередается с С2 вместе с командой на запуск модуля);\n\n� ВПО запускает два потока, транслирующие данные из пайпа на С2 и с С2\nв пайпы с использованием подключения, созданного на предыдущем этапе.\nВнутри потоков создаются еще два пайпа — \\\\.\\pipe\\windows@#%02Xfir и \\\\.\\pipe\\\nwindows@#%02Xsec. Пайп с окончанием fir используется для передачи данных от\nмодуля до С2. Пайп с окончанием sec используется для передачи данных и команд от\nС2 до модулей.\n\nВторой поток, который обрабатывает команды от С2 до модулей, имеет свой собственный\n\nобработчик. О нем подробнее написано в разделе команд, но сейчас отметим только то,\n\nчто одна из команд может запустить локальный асинхронный TCP-сервер. Он будет при\nнимать данные от того, кто у нему подключится, передавать их на С2 и пересылать их с\n\nС2 обратно. Он биндится на адрес 127.0.0.1 и на тот порт, на который получится, начиная с\n\n5000, последовательно перебирая их.\n\n#### Команды\n\nНиже приведены идентификаторы команд, которые может принимать ВПО, а также те, что\n\nотправляет само ВПО в различных ситуациях.\n\n**Иденти-**\n**Направление** **Тип** **Описание**\n**фикатор**\n\n0x294C От С2 Команда Создать описатель модуля\n\n\n-----\n\nПринять данные, содержащие модуль,\n0x2AC8 От С2 Команда\nи сохранить их\n\nЗапустить модуль без создания\n0x230E От С2 Команда\nдополнительных пайпов\n\n0x2D06 От С2 Команда Разрушить объект описателя модуля\n\nЗапустить встроенный модуль работы\n0x590A От С2 Команда\nс файловой системой\n\nЗапустить модуль, а также создать\n0x3099 От С2 Команда\nдополнительные пайпы для взаимодействия\n\nСамоудаление. Выполняется BAT-скрипт,\n0x1C1C От С2 Команда удаляющий persistence и очищающий созданные\nдиректории\n\n0x55C3 От С2 Команда Загрузить файл с машины на С2\n\n0x55C5 От С2 Команда Рекурсивный листинг директории\n\n0x55C7 От С2 Команда Загрузить файл с С2 на машину\n\n0x3167 От С2 Команда Записать данные в пайп с окончанием «Mon»\n\nЗаписать в пайп с окончанием «Mon» команду\n\n\n0x38AF От С2 Команда\n\n\n0x38AF. После этого завершается открытое\n\nсоединение для модуля. Возможно, означает\n\n«завершить работу модуля»\n\n\n0x3716 От С2 Команда Переслать данные модуля другому модулю\n\n0x3A0B От С2 Команда То же, что и 0x3099\n\nЗапустить асинхронный TCP-сервер,\n0x3CD0 От С2 Команда транслирующий данные между С2 и клиентом,\nкоторый подключится к нему\n\nОтвет Данный идентификатор имеет пакет,\n0x129E От ВПО\nсодержащий информацию о машине\n\n\n0x132A От С2 Ответ\n\n\nДанный идентификатор имеет пакет,\nприходящий от С2 в ответ на отправку данных\nо зараженной машине. Получение такого пакета\nрасценивается ВПО как успешная отсылка\nинформации о машине\n\n\n-----\n\n0x155B От ВПО Ответ\n\n\nДанный идентификатор имеет\nпакет, содержащий информацию\nоб инициализированных описателях модулей.\nПакет выполняет роль “GetCommand”.\nОтвет на него содержит одну из возможных\nкоманд\n\n\nДанный идентификатор имеет пакет,\n0x2873 От ВПО Ответ отправляемый в случае, если инициализация\nописателя модуля прошла успешно (0x294C)\n\n\n0x2D06 От ВПО Ответ\n\n0x2873 От ВПО Ответ\n\n\nДанный идентификатор имеет пакет,\nотправляемый в случае, если инициализация\nописателя модуля завершилась с ошибкой\n(0x294C)\n\nДанный идентификатор имеет пакет,\nотправляемый после принятия данных\nмодуля(0x2AC8). Содержит в себе количество\nуже сохраненных байтов\n\n\nДанный идентификатор имеет пакет, отправляе0x2743 От ВПО Ответ\n\nмый после запуска модуля без пайпов (0x230E)\n\nДанный идентификатор имеет пакет,\n0x2D06 От ВПО Ответ отправляемый после того, как описатель модуля\nбыл разрушен (0x2D06)\n\nДанный идентификатор имеет пакет,\n0x3F15 От ВПО Ответ отправляемый после того, как запущен\nмодуль с пайпами\n\n\n0x32E0 От ВПО Ответ\n\n\nДанный идентификатор имеет пакет,\nотправляемый в случае, если имеет место\nповторная попытка инициализации уже\nсозданных пайпов для модуля\n\n\nДанный идентификатор имеет пакет,\n0x34A7 От ВПО Ответ содержащий данные, пересылаемые\nиз пайпа на С2\n\nДанный идентификатор имеет пакет,\n0x9F37 От ВПО Ответ содержащий данные, пересылаемые\nс TCP-сервера на С2\n\n\n-----\n\n#### Сетевой код\n\nКаждый пакет имеет следующую структуру:\n\n\nStruct Packet{\nStruct Header{\n_ DWORD rand _ k1;\n_ DWORD rand _ k2;\n_ DWORD rand _ k3;\n_ DWORD szPaylaod;\n_ DWORD protoConst;\n_ DWORD packetId;\n_ DWORD unk1;\n_ DWORD packetKey;\n};\n_ BYTE [max 0x2000] packetPayload;\n};\n\n\nКаждый пакет имеет уникальный ключ, определяемый как szPayload + GetTickCount() %\n\nhardcodedConst. Данный ключ сохраняется в соответствующее поле заголовка packetKey.\n\nИз него генерируется другой ключ, который используется для шифрования алгоритмом\n\nRC4 заголовка пакета (без поля packetKey, оно не зашифровывается). Генерация RC4\nключа для заголовка представлена на рисунке ниже.\n\nРисунок 22. Генерация RC4-ключа для заголовка\n\nДалее из зашифрованных полей szPayload, packetId, protoConst, rand_k3 генерируется\n\nеще один RC4-ключ, который используется для шифрования полезной нагрузки пакета.\n\n\n-----\n\nРисунок 23. Генерация RC4-ключа для полезной нагрузки пакета\n\nДалее формируются HTTP-заголовки и сформированный пакет отправляется на С2. Кроме\n\nтого, каждый пакет снабжается своим номером, который фигурирует в URL. Модули могут\n\nпередавать свой идентификатор, который используется для нахождения подключения,\n\nсозданного на этапе запуска модуля. Идентификатор модуля 0 зарезервирован для основ\nного подключения стейджера.\n\nРисунок 24. Формирование HTTP-заголовков\n\n\n-----\n\n#### Другие варианты\n\nКак мы уже упоминали, дроппер может быть сконфигурирован на запуск не только шелл­\n\nкода, но и исполняемых файлов. Мы обнаружили один и тот же дроппер-stager с разной\n\nполезной нагрузкой на борту: это Hussar и FlyingDutchman.\n\n#### Дроппер-stager\n\nОсновными задачами данного дроппера являются распаковка и маппинг полезной нагруз\nки, хранящейся в закодированном виде в ресурсах. Также дроппер хранит закодирован\nные конфигурационные данные, которые он передает как параметр полезной нагрузке.\n\nРисунок 25. Процесс распаковки полезной нагрузки\n\n#### Hussar\n\nHussar по смыслу похож на те шеллкоды, что описаны выше. Он позволяет загружать моду\nли и собирать базовую информацию о машине, а также может добавлять себя в список\n\nавторизированных приложений брандмауэра Windows.\n\n#### Инициализация\n\nПервым делом ВПО осуществляет разбор переданной ему из загрузчика конфигурации.\n\nРисунок 26. Пример конфигурации\n\nСтруктура конфигурации следующая:\n\n\nStruct RawConfig{\n_ DWORD protocolId;\n_ BYTE c2Strings [0x100];\n};\n\n\n-----\n\nПоле protocoId показывает, по какому протоколу будет вестись взаимодействие с С2. Всего\n\nих реализовано три:\n\n� protocolId равно 1 — будет использован протокол на основе TCP;\n\n� protocolId равно 2 — на основе HTTP;\n\n� protocolId равно 3 — на основе HTTPS.\n\nЗатем генерируется идентификатор машины. Он состоит из имени компьютера и времен\nной метки. Временная метка может быть просчитана из реестра из ключа SOFTWARE\\\n\nMicrosoft\\Windows\\CurrentVersion\\Telephony (значение Perf0). В случае если прочитать ее\n\nне удалось, к идентификатору машины добавляется temp.\n\nРисунок 27. Генерация идентификатора машины\n\nДалее создается окно, которое впоследствии используется для обработки приходящих\n\nсообщений.\n\nРисунок 28. Создание окна диспетчера\n\nЗатем ВПО добавляет себя в список авторизованных приложений брандмауэра Windows с\n\nпомощью COM-интерфейса INetFwMgr.\n\nИнициализация заканчивается созданием потока, который осуществляет подключе\nние к С2 и периодическую отправку запроса на команду. Функция, работающая в пото\nке, использует API WSAAsyncSelect для оповещения ранее созданного окна о том, что\n\nнад созданным подключением возможно выполнить действия (сокет «готово для чтения»,\n\n«подключен», «закрыто»).\n\n\n-----\n\nРисунок 29. Связь между открытым сокетом и окном\n\nВ общем окно и механизм сообщений Windows используются ВПО как способ передачи\n\nкоманд. Так как хендл окна передается модулям, а в диспетчере есть не используемые\n\nсамим стейджером ветви, можно предположить, что модули могут использовать окно для\n\nвзаимодействия С2.\n\n#### Модули\n\nКаждый модуль представляет собой MZPE-файл, который загружается в то же адресное\n\nпространство, что и стейджер. Модуль должен экспортировать функцию GetModulInfo,\n\nкоторая вызывается стейджером после маппинга образа.\n\nИденти\nНаправление Тип Описание\nфикатор\n\nСобрать информацию о зараженной ма\nшине (версия ОС, имя пользователя, имя\n\n\n0x835 От С2 Команда\n\n\nкомпьютера, строка, содержащая текущее\n\nвремя, имя процессора из реестра, а так\nже — является ли ОС 64-разрядной)\n\n\nЗагрузить модуль. Данные модуля прихо0x9CA4 От С2 Команда\n\nдят от С2\n\n\n0xC358\n\n(Window MSG\n\nCode)\n\n0xC359\n\n(Window MSG\n\nCode)\n\n0x834,\n\n0x835, 0x838,\n\n0x9CA4, ни\n\nодин из пере\nчисленных\n\n\n??? Команда Передать данные из LPARAM на С2\n\nПередать конфигурацию С2 модулю.\n\n\n??? Команда\n\n\nИдентификатор модуля передается\n\nв LPARAM\n\n\nПередать принятый пакет модулю.\n??? Команда\n\nИдентификатор модуля передается от С2\n\n\n-----\n\n#### FlyingDutchman\n\nПолезная нагрузка предоставляет удаленный доступ к зараженной машине. Включает в\n\nсебя функции по захвату скриншотов с экрана, удаленный шелл, операции с файловой\n\nсистемой, позволяет управлять процессами и сервисами в системе. Состоит из нескольких\n\nмодулей.\n\nИдентификатор Идентификатор\n\nНаправление Тип Описание\nмодуля CMD\n\n\n0xafc8 0xAFD3 От С2 Команда Ping модуля\n\n\n0xAFD4 От С2 Команда\n\n\nОтправляет информацию о зараженной машине (версию операционной\nсистемы, включая установленные\nсервис-­паки, наименование процессора, строку, содержащую текущее время,\nразрешение экрана, информацию\nо свободном и занятом месте на дисках)\n\n\nОтправляет список процессов, запу0xAFD5 От С2 Команда\nщенных в системе\n\nЗавершить процесс. PID процесса пере0xAFD7 От С2 Команда\nдается от С2\n\nОтправляет список окон, существую0xAFD9 От С2 Команда\nщих в системе, вместе с заголовками\n\nОтправить заданному окну сообщение\n0xAFDA От С2 Команда\nWM_CLOSE\n\n0xAFDB От С2 Команда Развернуть окно\n\n0xAFDC От С2 Команда Свернуть окно\n\n0xAFDD От С2 Команда Показать окно\n\n0xAFDE От С2 Команда Скрыть окно\n\n\n-----\n\nОтправляет список сервисов, суще0xAFE0 От С2 Команда\nствующих в системе\n\n\n0xAFE1 От С2 Команда\n\n\nОсуществляет модификацию состояния\nсуществующего сервиса. Имя сервиса\nполучается от С2. Может запустить сервис или перевести его в одно из состояний STOP, PAUSE, CONTINUE. Данные\nо том, какое состояние необходимо\nприменять, также получаются с С2\n\n\nУдалить существующий сервис.\n0xAFE2 От С2 Команда\nИмя сервиса получается с С2\n\nИзменить тип старта сервиса. Имя сер0xAFE3 От С2 Команда\nвиса получается с С2\n\n0xabe0 0xABEB От С2 Команда Ping модуля\n\nЗапустить процесс передачи скрин0xABEC От С2 Команда шотов с экрана зараженной машины.\nСкриншоты снимаются раз в секунду\n\nПриостановить процесс создания\n0xABED От С2 Команда\nскриншотов\n\nОстановить процесс создания скрин0xABF1 От С2 Команда\nшотов. Модуль завершает свою работу\n\n\n0xa7f8 0xA803 От С2 Команда\n\n\nЗапустить cmd.exe, а также поток,\nкоторый будет считывать из связанного\nпайпа данные вывода консоли и отправлять их на С2\n\n\nЗаписать команду в пайп, связанный\n0xA804 От С2 Команда\nс STDIN ранее созданного cmd.exe\n\nЗавершить работу процесса cmd.exe,\n0xA805 От С2 Команда а также всех ассоциированных с ним\nпайпов. Модуль завершает свою работу\n\n\n-----\n\nОтправляет информацию о дисках,\n0xa410 0xA41B От С2 Команда\nустановленных в системе, и их типах\n\nОтправляет листинг директории. Путь\n0xA41C От С2 Команда до необходимой директории передается с С2\n\n0xA41E От С2 Команда Загрузить файл с машины на С2\n\n0xA41F От С2 Команда Запустить файл\n\n0xA420 От С2 Команда Удалить файл\n\n0xA421 От С2 Команда Загрузить файл с С2\n\n0xA424 От С2 Команда Переместить файл\n\n0xA425 От С2 Команда Создать директорию\n\n0xA426 От С2 Команда File Touch\n\nОтправляет на С2 размер переданного\n0xA428 От С2 Команда\nфайла. Путь до файла передается от С2\n\n\n-----\n\n#### Заключение\n\nГруппа уже имеет за спиной несколько успешных взломов, однако допускает ошибки,\n\nпозволяющие судить о ее происхождении. По всем приведенным данным, группа проис\nходит из Азии и использует ранее никем не описанное ВПО. Троян Byeby связывает эту\n\nгруппу с обнаруженной нами ранее группой SongXY, пик активности которой пришелся\n\nна 2017 год.\n\nМы продолжаем тщательно следить за активностью группы Calypso и прогнозируем новые\n\nатаки с ее участием.\n\n#### Индикаторы компрометации\n\n###### Сетевые\n\n23.227.207.137\n\n45.63.96.120\n\n45.63.114.127\n\nr01.etheraval.com\n\ntc.streleases.com\n\ntv.teldcomtv.com\n\nkrgod.qqm8.com\n\n###### Файловые индикаторы\n\n Дропперы и полезная нагрузка\n\nC9C39045FA14E94618DD631044053824 Dropper\n\nE24A62D9826869BC4817366800A8805C Dll\n\nF0F5DA1A4490326AA0FC8B54C2D3912D Shellcode\n\nCB914FC73C67B325F948DD1BF97F5733 Dropper\n\n6347E42F49A86AFF2DEA7C8BF455A52A Dll\n\n0171E3C76345FEE31B90C44570C75BAD Shellcode\n\n17E05041730DCD0732E5B296DB16D757 Dropper\n\n69322703B8EF9D490A20033684C28493 Dll\n\n22953384F3D15625D36583C524F3480A Shellcode\n\n1E765FED294A7AD082169819C95D2C85 Dropper\n\nC84DF4B2CD0D3E7729210F15112DA7AC Dll\n\nACAAB4AA4E1EA7CE2F5D044F198F0095 Shellcode\n\n\n-----\n\n###### Дропперы с одинаковой полезной нагрузкой\n\n85CE60B365EDF4BEEBBDD85CC971E84D dropper\n\n1ED72C14C4AAB3B66E830E16EF90B37B dropper\n\nCB914FC73C67B325F948DD1BF97F5733 dropper\n\n###### Полезная нагрузка без дроппера\n\nE3E61F30F8A39CD7AA25149D0F8AF5EF Dll\n\n974298EB7E2ADFA019CAE4D1A927AB07 Shellcode\n\nAA1CF5791A60D56F7AE6DA9BB1E7F01E Dll\n\n05F472A9D926F4C8A0A372E1A7193998 Shellcode\n\n0D532484193B8B098D7EB14319CEFCD3 Dll\n\nE1A578A069B1910A25C95E2D9450C710 Shellcode\n\n2807236C2D905A0675878E530ED8B1F8 Dll\n\n847B5A145330229CE149788F5E221805 Shellcode\n\nD1A1166BEC950C75B65FDC7361DCDC63 Dll\n\nCCE8C8EE42FEAED68E9623185C3F7FE4 Shellcode\n\n###### Hussar\n\n43B7D48D4B2AFD7CF8D4BD0804D62E8B\n\n617D588ECCD942F243FFA8CB13679D9C\n\n###### FlyingDutchman\n\n5199EF9D086C97732D97EDDEF56591EC\n\n06C1D7BF234CE99BB14639C194B3B318\n\n\n-----\n\n#### MITRE ATT&CK\n\n**Tactic** **ID** **Name**\n\nExecution T1059 Command-Line Interface\n\nPersistence T1060 Registry Run Keys / Startup Folder\n\nT1053 Scheduled Task\n\nT1158 Hidden Files and Directories\n\nDefense Evasion T1027 Obfuscated Files or Information\n\nT1085 Rundll32\n\nT1064 Scripting\n\nCredential Access T1003 Credential Dumping\n\nDiscovery T1087 Account Discovery\n\nT1046 Network Service Scanning\n\nT1135 Network Share Discovery\n\nT1082 System Information Discovery\n\nLateral Movement T1097 Pass the Ticket\n\nCollection T1114 Email Collection\n\nT1113 Screen Capture\n\nT1005 Data from Local System\n\nCommand And Control T1043 Commonly Used Port\n\nT1024 Custom Cryptographic Protocol\n\nT1001 Data Obfuscation\n\n\nО компании\n\nptsecurity.com\n[pt@ptsecurity.com](mailto:pt%40ptsecurity.com?subject=)\n[facebook.com/PositiveTechnologies](http://facebook.com/PositiveTechnologies)\n[facebook.com/PHDays](http://facebook.com/PHDays)\n\nCalypso APT_A4.RUS.0003.02.OCT.23.2019\n\n\nPositive Technologies — один из лидеров европейского рынка систем анализа защищенности и соответствия стандартам,\nа также защиты веб-приложений. Организации во многих странах мира используют решения Positive Technologies для\nоценки уровня безопасности своих сетей и приложений, для выполнения требований регулирующих организаций\nи блокирования атак в режиме реального времени. Благодаря многолетним исследованиям специалисты Positive\nTechnologies заслужили репутацию экспертов международного уровня в вопросах защиты SCADA- и ERP-систем,\nкрупнейших банков и телеком-операторов.\n\nДеятельность компании лицензирована Минобороны России, ФСБ России и ФСТЭК России, продукция сертифицирована\nМинобороны России и ФСТЭК России.\n\n\n-----",
    "language": "RU",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://www.ptsecurity.com/upload/corporate/ru-ru/analytics/calypso-apt-2019-rus.pdf"
    ],
    "report_names": [
        "calypso-apt-2019-rus.pdf"
    ],
    "threat_actors": [
        {
            "id": "3c5b0e7e-2388-4b63-9b97-6b027bec4bf7",
            "created_at": "2023-01-06T13:46:39.068694Z",
            "updated_at": "2025-03-27T02:00:02.989445Z",
            "deleted_at": null,
            "main_name": "Calypso",
            "aliases": [
                "BRONZE MEDLEY"
            ],
            "source_name": "MISPGALAXY:Calypso",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "13d9c5fc-af82-4474-90dd-188c4e40a399",
            "created_at": "2022-10-25T16:07:23.435079Z",
            "updated_at": "2025-03-27T02:02:09.800346Z",
            "deleted_at": null,
            "main_name": "Calypso",
            "aliases": [
                "Bronze Medley"
            ],
            "source_name": "ETDA:Calypso",
            "tools": [
                "Agent.dhwf",
                "Byeby",
                "Calypso RAT",
                "DCSync",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EternalBlue",
                "EternalRomance",
                "FlyingDutchman",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "NBTscan",
                "OS_Check_445",
                "PlugX",
                "Quarks PwDump",
                "RedDelta",
                "SAMRID",
                "Sogu",
                "SysInternals",
                "TCP Port Scanner",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Whitebird",
                "Xamtrav",
                "ZXPortMap",
                "nbtscan",
                "netcat"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e6c64ba5-12e1-4f04-97d5-077d83da95e1",
            "created_at": "2024-10-08T02:00:04.466964Z",
            "updated_at": "2025-03-27T02:00:03.436873Z",
            "deleted_at": null,
            "main_name": "SongXY",
            "aliases": [],
            "source_name": "MISPGALAXY:SongXY",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4b066585-3591-4ddd-b3cc-f4e19e0e00ef",
            "created_at": "2022-10-25T16:07:24.086915Z",
            "updated_at": "2025-03-27T02:02:10.103556Z",
            "deleted_at": null,
            "main_name": "Putter Panda",
            "aliases": [
                "APT 2",
                "Group 36",
                "Putter Panda",
                "SearchFire",
                "TG-6952"
            ],
            "source_name": "ETDA:Putter Panda",
            "tools": [
                "3PARA RAT",
                "4H RAT",
                "4h_rat",
                "MSUpdater",
                "httpclient",
                "pngdowner"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c39b0fe6-5642-4717-9a05-9e94265e3e3a",
            "created_at": "2022-10-25T16:07:24.332084Z",
            "updated_at": "2025-03-27T02:02:10.175452Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "Bronze Huntley",
                "CactusPete",
                "Earth Akhlut",
                "HartBeat",
                "Karma Panda",
                "LoneRanger",
                "Operation Bitter Biscuit",
                "TAG-74",
                "Tonto Team"
            ],
            "source_name": "ETDA:Tonto Team",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Bioazih",
                "Bisonal",
                "CONIME",
                "Dexbia",
                "Korlia",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041674,
    "ts_creation_date": 1571844616,
    "ts_modification_date": 1571844621,
    "files": {
        "pdf": "https://archive.orkl.eu/98bbb00de1817bdd930ea37e6aa4e943e0a6e2db.pdf",
        "text": "https://archive.orkl.eu/98bbb00de1817bdd930ea37e6aa4e943e0a6e2db.txt",
        "img": "https://archive.orkl.eu/98bbb00de1817bdd930ea37e6aa4e943e0a6e2db.jpg"
    }
}