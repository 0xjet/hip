{
    "id": "472d6ad7-57d1-4693-be3a-59111ded09ac",
    "created_at": "2023-01-12T15:02:29.577512Z",
    "updated_at": "2025-03-27T02:05:53.312792Z",
    "deleted_at": null,
    "sha1_hash": "efc6d76d1baba371e7ea6b4f6bcc1ccb86f84774",
    "title": "2017-07-31 - A new era in mobile banking Trojans",
    "authors": "",
    "file_creation_date": "2022-05-29T01:03:25Z",
    "file_modification_date": "2022-05-29T01:03:25Z",
    "file_size": 394995,
    "plain_text": "# A new era in mobile banking Trojans\n\n**[securelist.com/a-new-era-in-mobile-banking-trojans/79198/](https://securelist.com/a-new-era-in-mobile-banking-trojans/79198/)**\n\nAuthors\n\n[Roman Unuchek](https://securelist.com/author/romanunuchek/)\n\n## Svpeng turns keylogger and steals everything through accessibility services\n\nIn mid-July 2017, we found a new modification of the well-known mobile banking malware\nfamily Svpeng – Trojan-Banker.AndroidOS.Svpeng.ae. In this modification, the\ncybercriminals have added new functionality: it now also works as a keylogger, stealing\nentered text through the use of accessibility services.\n\nAccessibility services generally provide user interface (UI) enhancements for users with\ndisabilities or those temporarily unable to interact fully with a device, perhaps because they\nare driving. Abusing this system feature allows the Trojan not only to steal entered text from\nother apps installed on the device, but also to grant itself more permissions and rights, and to\ncounteract attempts to uninstall the Trojan.\n\n\n-----\n\nAttack data suggests this Trojan is not yet widely deployed. In the space of a week, we\nobserved only a small number of users attacked, but these targets spanned 23 countries.\nMost attacked users were in Russia (29%), Germany (27%), Turkey (15%), Poland (6%) and\nFrance (3%). It is worth noting that, even though most attacked users are from Russia, this\nTrojan won’t work on devices running the Russian language. This is a standard tactic for\nRussian cybercriminals looking to evade detection and arrest.\n\nThe Svpeng malware family is known for being innovative. Starting from 2013, it was among\nthe first to begin [attacking SMS banking,](https://securelist.ru/grabitel-s-ruchny-m-upravleniem/3290/) to use phishing pages to overlay other apps to steal\ncredentials, [and to block devices and demand money. In 2016, cybercriminals were actively](https://securelist.com/latest-version-of-svpeng-targets-users-in-us/63746/)\n[distributing Svpeng through AdSense using a vulnerability in the Chrome browser. This](https://securelist.com/disassembling-a-mobile-trojan-attack/76286/)\nmakes Svpeng one of the most dangerous mobile malware families, and it is why we monitor\nthe functionality of new versions.\n\n### The attack process\n\nAfter starting, the Trojan-Banker.AndroidOS.Svpeng.ae checks the device language and, if it\nis not Russian, asks the device for permission to use accessibility services. In abusing this\nprivilege, it can do many harmful things. It grants itself device administrator rights, draws\nitself over other apps, installs itself as a default SMS app, and grants itself some dynamic\npermissions that include the ability to send and receive SMS, make calls, and read contacts.\nFurthermore, using its newly-gained abilities the Trojan can block any attempt to remove\ndevice administrator rights – thereby preventing its uninstallation. It is interesting that in\ndoing so it also blocks any attempt to add or remove device administrator rights for any other\napp too.\n\n\n-----\n\nSvpeng was able to become a device administrator without any interaction with the user just by using\n\naccessibility services.\n\nUsing accessibility services allows the Trojan to get access to the UI of other apps and to\nsteal data from them, such as the names of the interface elements and their content, if it is\navailable. This includes entered text. Furthermore, it takes screenshots every time the user\npresses a button on the keyboard, and uploads them to the malicious server. It supports not\nonly the standard Android keyboard but also a few third-party keyboards.\n\nSome apps, mainly banking ones, do not allow screenshots to be taken when they are on\ntop. In such cases, the Trojan has another option to steal data – it draws its phishing window\nover the attacked app. It is interesting that, in order to find out which app is on top, it uses\naccessibility services too.\n\n\n-----\n\nFrom the information Svpeng receives from its command and control server (CnC), I was\nable to intercept an encrypted configuration file and decrypt it to find out the attacked apps,\nand to obtain a URL with phishing pages.\n\nI uncovered a few antivirus apps that the Trojan attempted to block, and some apps with\nphishing URLs to overlay them. Like most mobile bankers, Svpeng overlays some Google\napps to steal credit card details.\n\n\n-----\n\n-----\n\nAlso, the config file contained a phishing URL for the PayPal and eBay mobile apps to steal\ncredentials and URLs for banking apps from different countries:\n\nUK– 14 attacked banking apps\nGermany – 10 attacked banking apps\nTurkey– 9 attacked banking apps\nAustralia– 9 attacked banking apps\nFrance– 8 attacked banking apps\nPoland– 7 attacked banking apps\nSingapore– 6 attacked banking apps\n\nThere was one more app in this configuration file – Speedway app, which is a rewards app,\nnot a financial app. Svpeng will overlay it with a phishing window to steal credentials.\n\n\n-----\n\nIt can also receive commands from the CnC:\n\nTo send SMS\nTo collect info (Contacts, installed apps and call logs)\nTo collect all SMS from the device\nTo open URL\nTo start stealing incoming SMS\n\n### Distribution and protection\n\nThe Trojan-Banker.AndroidOS.Svpeng.ae is distributed from malicious websites as a fake\nflash player. Its malicious techniques work even on fully-updated devices with the latest\nAndroid version and all security updates installed. By accessing only one system feature this\nTrojan can gain all necessary additional rights and steal lots of data.\n\n\n-----\n\n### MD5\n\nF536BC5B79C16E9A84546C2049E810E1\n\nA new era in mobile banking Trojans\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-07-31 - A new era in mobile banking Trojans.pdf"
    ],
    "report_names": [
        "2017-07-31 - A new era in mobile banking Trojans.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535749,
    "ts_updated_at": 1743041153,
    "ts_creation_date": 1653786205,
    "ts_modification_date": 1653786205,
    "files": {
        "pdf": "https://archive.orkl.eu/efc6d76d1baba371e7ea6b4f6bcc1ccb86f84774.pdf",
        "text": "https://archive.orkl.eu/efc6d76d1baba371e7ea6b4f6bcc1ccb86f84774.txt",
        "img": "https://archive.orkl.eu/efc6d76d1baba371e7ea6b4f6bcc1ccb86f84774.jpg"
    }
}