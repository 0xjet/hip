{
    "id": "5bd5e6f3-e561-4e83-9037-0a32ab8c7903",
    "created_at": "2023-01-12T15:07:03.218658Z",
    "updated_at": "2025-03-27T02:16:25.596429Z",
    "deleted_at": null,
    "sha1_hash": "8052ecfde6606abf2be804f3781e0ab5cda5e02d",
    "title": "2021-06-19 - Android FluBot enters Switzerland",
    "authors": "",
    "file_creation_date": "2022-05-28T19:55:21Z",
    "file_modification_date": "2022-05-28T19:55:21Z",
    "file_size": 422705,
    "plain_text": "# Android FluBot enters Switzerland\n\n**[securityblog.switch.ch/2021/06/19/android-flubot-enters-switzerland/](https://securityblog.switch.ch/2021/06/19/android-flubot-enters-switzerland/)**\n\nJune 19, 2021\n\nFluBot is a new Android malware first discovered in December 2020. During the first few\nmonths, FluBot has been active in Spain, Hungary and Poland. Since then, the development\nof the malware advanced quickly and the malware has set foot in almost all European\ncountries.\n\n\n-----\n\nOn the 18th of June 2021 FluBot version 4.6 was spotted which added a configuration for\nSwitzerland. As of today it is actively being spamertized through SMS.\n\n## Alias Names\n\nFluBot is known by different names. The name “FluBot” is best known because this was the\nname given in the first public technical writing. Below the reference to the most well known\naliases:\n\nJanuary 2021, ThreatFabric was the first to give it the name “Cabassous” in a Twitter\npost\n[March 2021, ProDaft published a detailed technical report and gave it the name](https://github.com/prodaft/malware-ioc/tree/master/FluBot)\n**“FluBot”**\n[April 2021, IBM Trusteer took a deeper look at the different FluBot versions and gave it](https://securityintelligence.com/posts/story-of-fakechat-malware/)\nthe name “FakeChat“\n\n## Distribution\n\nFluBot is distributed using smishing (a combination from the words SMS and phishing). The\nvictim receives an SMS with a link to an URL which distributes the APK. The installation is\n[straight forward using sideloading.](https://en.wikipedia.org/wiki/Sideloading)\n\n\n-----\n\nIf the recipient device is not an Android mobile phone or the fraudster does not want to\ndistribute the malware at that time, the URL redirects the user to a scam website or with the\n[Voicemail lure we have seen a redirection to the Voicemail app from Deutsche Telekom AG](https://play.google.com/store/apps/details?id=de.telekom.mds.mbp)\non the Google Playstore.\n\nFluBot SMS are typically sent from other infected mobile phones. If the number of infected\ndevices within a country is not very high it has been seen that infected devices from other\ncountries are used to send the SMS.\n\nThe SMS text message may vary as do the URLs. Sometimes they talk about parcel delivery\nusing brands such as DHL or UPS. The current campaign in Switzerland uses Voicemail as a\nlure. The malware distributed in Switzerland from the smishing URLs are currently all FluBot\nsamples. However, this may change as in other countries it has been seen that another well\n[known trojan called Anatsa is dropped instead. See also tweet by ThreatFabric.](https://mobile.twitter.com/ThreatFabric/status/1406210709248266244)\n\n## Installation\n\n\n-----\n\nOnce installed and started, FluBot asks for Accessibility Service permission (Screenshot on\nthe right side). This permission is normally used by apps to help users with disabilities to use\na mobile device. However, if granted to FluBot, it can control the mobile device as if done by\na normal user. First, it will grant itself additional permissions automatically. For example, it\nwill set itself as the default SMS application, grant itself access to read the phone book,\n**read or block notifications and more. Secondly, Accessibility Service is also used to**\nprevent the user from uninstalling the malware. The user has to boot into “Safe Mode” in\norder to uninstall it. Third and finally, it uses accessibility permission to monitor the device\nusage and e.g. start overlays if for example targetted app is started. The overlay, because\nstarted a fraction of a second later, will take over the screen and trick the user into enter\ncredentials or other sensitive information.\n\nThe installed FluBot app has no user interface for the user. If the user starts the app a short\nmessage appears informing the user that the installation failed.\n\n## Network Communication\n\n\n-----\n\nFluBot uses a Domain-Generation-Algorithm (DGA) to find the command and control (c2)\nserver domain name. The DGA generates 5000 domain names per month and uses different\nseeds. The following DGA seeds have been observed over time:\n\n1136 (+34 ES)\n1642 (+44 UK)\n1813 (+39 IT)\n1905 (+81 JP)\n1945 (+41 de-CH, +43 AT, +49 DE)\n1949 (+36 HU)\n2931 (+30 GR, +31 NL, +32 BE, +40 RO, +41 fr-CH, +45 DK, and many more)\n\nThe following python script can be used to generate the DGA domain names. For\nSwitzerland the seeds 1945 and 2931 are relevant:\n\n\n-----\n\n```\n#!/usr/bin/env python3\nimport argparse\nimport time\nimport math\nfrom datetime import datetime\ndef get_seed(init, year, month):\n  year = year\n  month = month - 1\n  j = ((year ^ month) ^ 0)\n  j2 = j * 2\n  j3 = j2 * (year ^ j2)\n  j4 = j3 * (month ^ j3)\n  # original java code uses long values which is limited to 64 bit\n  j5 = (j4 * j4)%2**64\n  seed = j5 + init;\n  return seed\nif __name__ == '__main__':\n  parser = argparse.ArgumentParser(description = 'apk.flubot-dga')\n  parser.add_argument('-s', '--seed', type=int, required = True)\n  parser.add_argument('-y', '--year', help='default current year (YYYY)', type=int,\nrequired = False)\n  parser.add_argument('-m', '--month', help='default current month (MM)', type=int,\nrequired = False)\n  # parse arguments\n  args = parser.parse_args()\n  seedinit = args.seed\n  now = datetime.utcnow()\n  if args.year:\n    year = args.year\n  else:\n    year = now.year\n  if args.month:\n    month = args.month\n  else:\n    month = now.month\n  # generate domains\n  domain = \"\"\n  max_hosts = 5000\n  seed = get_seed(seedinit, year, month)\n  # class Random source, https://github.com/MostAwesomeDude/javarandom/blob/master/javarandom.py\n  r = Random(seed)\n  for i in range(max_hosts):\n    label = \"\"\n    for y in range(15):\n      label = label + chr(r.nextInt(25) + 97);\n    if (i % 3 == 0):\n      domain = label + \".ru\"\n    elif (i % 2 == 0):\n\n```\n\n-----\n\n```\n      domain label + .su ;\n    else:\n      domain = label + \".cn\";\n    print(domain)\n\n```\nAt the time of writing, the command and control server for the month of July for these two\nseeds are as following:\n\nSeed 1945, `dlnoryuolxttcvp.su`\nSeed 2931, `jaxubdocesmgxnb.su`\n\nFluBot uses one of the following DNS lookup methods to resolve the DGA domain names:\n\n[CloudFlare DNS Json API,](https://developers.cloudflare.com/1.1.1.1/dns-over-https/json-format) `https://cloudflare-dns.com/dns-query?`\n```\n   name=%s&type=A\n\n```\n[Google DNS Json API,](https://developers.google.com/speed/public-dns/docs/doh/json) `https://dns.google/resolve?name=%s&type=A`\n[Ali DNS Json API,](https://alidns.com/knowledge?type=SETTING_DOCS#company_json) `https://dns.alidns.com/resolve?name=%s&type=A`\nor classical DNS resolution over the network provisioned DNS resolver\n\nA network operator who wants to block the communication to the c2 will not succeed by\nblocking DNS resolution to the c2 domain names as the malware can opt to use the other\nmentioned methods. However, in order to detect some infected mobile devices, it is useful\nand recommend to sinkhole infected bots and report the infection to the mobile user.\n\nFor all resolved domain names, FluBot uses public-/private crypto to communicate with the\nc2 server. Only if the c2 correctly answers the “ping” command of the bot it will attempt to\nregister itself on the server. Sinkholing a c2 domain name does not allow to disrupt the\ncommunication but merely provides statistics of newly infected devices.\n\nA FluBot DGA domain name typically resolves to up to 10 IP addresses. These IP addresses\nchange within minutes or days. It will be hard for mobile operators to block all IP address in\norder to prevent FluBot from communicating with its c2 server. Even if the mobile operator\nwere to succeed with that, most mobile devices will at some point enter a WiFi network\nwhere these defense mechanism are not in place. That said, it’s best to use network controls\nin order to detect infected devices and report these to the user.\n\n## Malware Capabilities\n\nFluBot will upload the address book to the c2 server and then asks for an SMS rate at which\nit will send out smishing URLs to further infect other mobile phones. This is a worm like\nbehavior. The typical SMS rate is between 10 and 30 seconds. At this rate, FluBot contacts\nits c2 server to receive SMS tasks. These tasks may look as following:\n\n\n-----\n\n```\n 0766430xxx,Neue Voicemail: https://taurus.dn.ua/voicemail/?cwidiwa \n'0763434xxx,Neue Voicemail: https://taurus.dn.ua/voicemail/?7l0mz7v9a7'\n'0765430xxx,Neue Voicemail: http://swagtown420.com/y/?wgj3c3iov2'\n'0766162xxx,Neue Voicemail: http://swagtown420.com/y/?q5eq4ii87c'\n'0792869xxx,Neue Voicemail: https://lakonich.com/click/?07oqodq7'\n'0764062xxx,Neue Voicemail: https://lakonich.com/click/?tla301m08o'\n'0792159xxx,Neue Voicemail: http://rongnhosabudo.com/url/?8puv9uk2g4'\n'0789228xxx,Neue Voicemail: http://rongnhosabudo.com/url/?6ljxntzuy'\n'0754297xxx,Neue Voicemail: http://rongnhosabudo.com/url/?vg8edhyz'\n'0793108xxx,Neue Voicemail: http://rongnhosabudo.com/url/?tgvv7adja'\n'0794526xxx,Neue Voicemail: https://sazenlee.com/path/?hyzoatx'\n\n```\nThis instructs the malware to send SMS to the given number with the shown text message.\n\nThe main malware capabilities are as follow:\n\nread/block notifications\nread/block/send SMS messages\nsteal contact list\nperform calls\nsocks proxy (can be used by the fraudster to access the Internet)\noverlay for credential/cc phishing\n\nFor more detailed information about the capabilities, please refer to the linked technical\nreports in the section “Alias Names”.\n\nThe targeted apps for the overlay attack differ per country and also may change over time. At\nthis time, the following apps are targetted by overlay attacks:\n\n[Biance (Bitcoin), com.binance.dev](https://play.google.com/store/apps/details?id=com.binance.dev)\n[Coinbase, com.coinbase.android](https://play.google.com/store/apps/details?id=com.coinbase.android)\nBlockchain.com Wallet, [piuk.blockchain.android](https://play.google.com/store/apps/details?id=piuk.blockchain.android)\nGmail, [com.google.android.gm](https://play.google.com/store/apps/details?id=com.google.android.gm)\n\nFollowing some example screenshots of the overlays for Gmail and Binance:\n\n\n-----\n\n## IOCs\n\nFluBot samples:\n```\npackage name: com.baidu.searchbox\nname: Voicemail\nmd5: b0989b77a305b7a542fd6e157d2380a2\npackage name: com.bilibili.app.in\nname: Voicemail\nmd5: b0cd0ffb967b2c337c5850d07cd91159\n\n```\nCommand and Control (c2) servers currently in use:\n```\nSeed 1945, dlnoryuolxttcvp.su\nSeed 2931, jaxubdocesmgxnb.su\n\n```\nThese c2 domain names are valid utmost until end of July 2021.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-19 - Android FluBot enters Switzerland.pdf"
    ],
    "report_names": [
        "2021-06-19 - Android FluBot enters Switzerland.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536023,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653767721,
    "ts_modification_date": 1653767721,
    "files": {
        "pdf": "https://archive.orkl.eu/8052ecfde6606abf2be804f3781e0ab5cda5e02d.pdf",
        "text": "https://archive.orkl.eu/8052ecfde6606abf2be804f3781e0ab5cda5e02d.txt",
        "img": "https://archive.orkl.eu/8052ecfde6606abf2be804f3781e0ab5cda5e02d.jpg"
    }
}