{
    "id": "4333806c-9d59-425f-9ac1-9976ab06a2d5",
    "created_at": "2023-01-12T15:07:02.480672Z",
    "updated_at": "2025-03-27T02:17:02.706434Z",
    "deleted_at": null,
    "sha1_hash": "85b8a636ae72969169ca6e61f23eca1d7f819f2f",
    "title": "2022-08-25 - Roasting 0ktapus- The phishing campaign going after Okta identity credentials",
    "authors": "",
    "file_creation_date": "2022-09-01T10:27:42Z",
    "file_modification_date": "2022-09-01T10:27:42Z",
    "file_size": 1597464,
    "plain_text": "# Roasting 0ktapus: The phishing campaign going after Okta identity credentials\n\n**blog.group-ib.com/0ktapus**\n\n25.08.2022\n\nOver 130 organizations have been compromised in a sophisticated attack using simple\nphishing kits\n\nRoberto Martinez\n\nSr. Threat Intelligence Analyst, Group-IB (Europe)\n\n\n-----\n\nRustam Mirkasymov\n\nHead of cyber threat research, Group-IB (Europe)\n\nMulti-factor authentication (MFA) is often implemented as a form of enterprise identity\nsecurity to protect organizations against credential theft, dictionary attacks, and brute force\ntechniques. But what if MFA is intercepted by a fraudster? In the cyber arena, where there is\na continuous arms race with offensive and defensive strategies trying to outcompete each\nother, techniques that overcome MFA have existed for some time. In this blog, we share the\ntechniques that utilize surprisingly simple tools that were used to overcome enterprise\nidentity access management (IAM) and conduct supply chain attacks.\n\n**Introduction**\n\nFor many years, cybercriminals have used social engineering and phishing attacks to trick\nunsuspected victims into providing their credentials. These credentials have been used to\nprovide cybercriminals with access to a wide range of company resources for a number of\n[well-documented purposes. To remain ahead of threat actors, and in its mission to fight all](https://www.group-ib.com/resources/threat-research/2021-reports.html#report-5)\ntypes of cybercrime, Group-IB helps organizations protect their digital assets and identify the\nmiscreants targeting them by investigating phishing attacks.\n\n\n-----\n\nOn July 26, 2022, Group-IB intelligence analysts received a request from a client of our\nThreat Intelligence solution asking for additional information on a recent phishing attack that\nthey had experienced. The investigation started after the client provided domain names and\nIP addresses used in the attack.\n\n[Using a combination of Group-IB Threat Intelligence, and in-house and public tools we](https://www.group-ib.com/products/threat-intelligence/)\nwere able to obtain a list of domains that had been attacked. Our client was only one of\nseveral well-known organizations that were targeted in a massive phishing campaign\ncodenamed 0ktapus by Group-IB researchers. The initial objective of the attackers was\nclear: obtain Okta identity credentials and two-factor authentication (2FA) codes from users\nof the targeted organizations. With this information in hand, the attackers could gain\nunauthorized access to any enterprise resources the victims have access to.\n\nThis case is of interest because despite using low-skill methods it was able to compromise a\nlarge number of well-known organizations. Furthermore, once the attackers compromised an\norganization they were quickly able to pivot and launch subsequent supply chain attacks,\nindicating that the attack was planned carefully in advance.\n\n[Group-IB decided to make its research on 0ktapus publicly available when Signal reported](https://support.signal.org/hc/en-us/articles/4850133017242)\n1,900 of their user’s accounts were probably hacked. We hope this blog will provide a better\nunderstanding of what happened and will give useful recommendations on how to prevent\nyour organization from becoming a victim.\n\n**Attack scheme overview**\n\n[Based on the request from our client, and from public reports made by Twilio and](https://www.twilio.com/blog/august-2022-social-engineering-attack) [Cloudflare,](https://blog.cloudflare.com/2022-07-sms-phishing-attacks/)\nthe attacks were well designed and executed. The attackers targeted employees of\ncompanies that are customers of IAM leader Okta. These employees received text\nmessages containing links to phishing sites that mimicked the Okta authentication page of\ntheir organization. Examples of observed phishing SMS messages can be found in the two\npublic reports mentioned above.\n\n\n-----\n\n**Deep dive into the attack**\n\nPhishing sites\n\nIn total, the Group-IB Threat Intelligence team detected 169 unique domains involved in the\n**0ktapus campaign. When analyzing these phishing sites, Group-IB analysts pay attention to**\nall resources being used. On many occasions, there are images, fonts or scripts that are\nunique enough that they can be used to find other sites using the same phishing kit. In this\ncase, we found an image that is legitimately used by sites leveraging Okta authentication,\nbeing used by the phishing kit.\n\nIf we correlate the hash value of this image with the keyword “_nuxt” (which is a folder name\nutilized by the frontend of the phishing kit), we can obtain a unique list of related domains.\nThese domains were all used by the attackers to target organizations in multiple industries,\nlocated mostly in the United States and Canada. Based on the fact that many of these\norganizations use Okta’s Identity and Access Management services to secure access to\nenterprise resources, we named this campaign 0ktapus.\n\nAt this time, it became very clear that the threat actors’ immediate intentions were to gain\naccess to the corporate services of the organizations.\n\n\n-----\n\n_Figure 1: Web resource found in all of the sites emulating Okta authentication pages involved_\n_in the phishing campaigns_\n\n_Figure 2: Sample of phishing sites found that emulate Okta authentication pages_\n\nInterestingly, the domains being registered for the attacks used keywords like sso, vpn, okta,\n_mfa, and help. Although, those are commonly used keywords, on occasions other keywords_\nare used, or no keywords at all. As part of best practices, we also started tracking those\nkeywords. However, often we only need to discover one domain to find the others.\n\nFrom the victim’s point of view, the phishing site looks quite convincing as it is very similar to\nthe authentication page they are used to seeing. Victims are prompted for their username\nand password, and once provided a second page is shown asking for their 2FA code. Once\nthe code has been handed to the phishers, the browser is forced to download a legitimate\ncopy of the remote administration tool AnyDesk. It is still unknown the true purpose of\npushing AnyDesk.exe to the victim’s asset, especially when the phishing link was sent via\nSMS to a mobile phone. Thus we decided the attacker didn’t configure the phishing kit\nproperly in order to target mobile devices. That may indicate that the attacker is\ninexperienced.\n\n\n-----\n\n_Figure 3: Example of a phishing site emulating the Okta authentication page of a target_\n_organization_\n\nThe frontend of the phishing sites uses the Nuxt.js framework while the backend uses\nDjango, running on port 8080.\n\n_Figure 4: Django admin interface running on port 8080 that was used in phishing attack that_\n_emulated Okta authentication pages_\n\nThe phishing site is static, meaning attackers cannot interact with victims in real-time like\nmore sophisticated phishing kits do. However, to gain access before the 2FA codes expire,\nthe attackers need to use the compromised data as soon as they get it. Most likely, this\nmeans that attackers were continuously monitoring their tools and using the credentials as\nsoon as they received them.\n\nPhishing kit analysis\n\n\n-----\n\nWith an efficient way to find new phishing sites, the next step was to locate a copy of the\nphishing kit being used. For this, we used Virustotal. It is well known that even cyber\ncriminals use the popular antivirus scan service. A search for the hash of the image we were\nusing to track phishing domains resulted in many false positives and one true positive. It\nappears that the miscreants had shared the kit among themselves using the file hosting\nservice Pomf.cat and one of them scanned the link with Virustotal to make sure there was no\nmalware in it.\n\nWith a copy of the phishing kit in our possession, we were ready to start digging and get a\nbetter understanding of the threat our client was facing.\n\n_Figure 5: Phishing kit structure, that emulated Okta authentication pages, used by the_\n_attacker in their campaigns_\n\n_Figure 6: Phishing kit structure, that emulated Okta authentication pages, used by the_\n_attacker in their campaigns_\n\nNowadays, many phishing actors prefer to use kits that deliver the compromised data\nobtained from victims to a Telegram channel controlled by them. Therefore, we were not too\nsurprised to see that this kit was not any different. Hiding at the end of the file containing the\nsettings for Django, were a few lines dedicated to the configuration of the Telegram bot and\nthe channel used by the kit to drop compromised data.\n\n\n-----\n\n_Figure 7: Function to send compromised data to Telegram used by the attackers to send_\n_credentials to themselves from the emulated Okta authentication pages in their phishing_\n_campaigns_\n\nAnalysis of compromised data\n\nGroup-IB utilized patented technologies implemented in Threat Intelligence service to\nuncover the information obtained from all 0ktapus campaigns launched since March 2022.\nThe analysis of compromised credentials sheds light on targets and helps us understand the\nattacks’ potential impact.\n\n\n-----\n\nThe analysis shows that most targeted companies are located in the USA. That list also\nincludes companies that are headquartered in other countries but have US-based employees\nthat were targeted.\n\n\n-----\n\nUnfortunately, we didn t manage to identify all targeted companies, because ⅔ of the data\ndidn’t contain a corporate email, but only usernames and 2FA codes. In those cases, we\ncould only identify the region of residence of the victims.\n\nMost companies in the victims’ list are providing IT, software development, and cloud\nservices. As described in Twilio’s blog, the attackers try to obtain credentials in order to\naccess private data, corporate emails and internal documents.\n\nSeeing financial companies in the compromised list gives us the idea that the attackers were\nalso trying to steal money. Furthermore, some of the targeted companies provide access to\ncrypto assets and markets, whereas others develop investment tools.\n\n[Based on recent news about hacked Signal accounts, we can assume the fraudsters may try](https://support.signal.org/hc/en-us/articles/4850133017242)\nto get access to private conversations and data. That information can be used as business\nintelligence and reselled to the victim's competitors or could be used to ransom a victim.\n\nAccording to published blogs by Twillio and Cloudflare, victims received SMS with phishing\nlinks. It is still unknown how fraudsters prepared their target list and how they obtained the\nphone numbers. But, according to the compromised data we analyzed, the actors started\ntheir attacks targeting mobile operators and telecommunications companies. Chances are,\nsome phone numbers may have been obtained from those initial attacks.\n\n\n-----\n\nSupply chain attacks\n\nRecent disclosures reveal that the initial compromises were just part of the attack. In many\ncases the attacker targeted mailing lists or customer-facing systems in order to launch\nsupply chain attacks:\n\n[Marketing firm Klaviyo was breached and personal information connected to](https://www.bleepingcomputer.com/news/security/email-marketing-firm-hacked-to-steal-crypto-focused-mailing-lists/)\ncryptocurrency-related accounts, reportedly including names, addresses, emails, and\nphone numbers, was stolen. This information could be used in order to steal\ncryptocurrency.\nEmail platform [Mailchimp was breached to gain access to data from crypto-related](https://mailchimp.com/en-gb/august-2022-security-incident/)\ncompanies and disrupt operations. Mailchimp was used by technology firm\n[DigitalOcean to send confirmation emails, password resets, email-based alerts. By](https://www.digitalocean.com/blog/digitalocean-response-to-mailchimp-security-incident)\ninitiating and redirecting password resets the customers of DigitalOcean could have\nbeen compromised.\n[Phone number verification provider Twilio was breached, which allowed the attacker to](https://www.twilio.com/blog/august-2022-social-engineering-attack)\nattempt to re-register [Signal accounts to new mobile devices.](https://support.signal.org/hc/en-us/articles/4850133017242-Twilio-Incident-What-Signal-Users-Need-to-Know-)\n\nWhile it is possible that the threat actor may have been lucky in their attacks it is far more\nlikely that they carefully crafted their attacks in order to launch the sophisticated supply chain\nattacks outlined above. It is not yet clear if the attacks were planned end-to-end in advance\nor whether opportunistic actions were taken at each stage. Regardless, it is clear that the\nattack has been incredibly successful and the full scale of the attack may not be known for\nsome time.\n\nSubject X\n\nUsing Telegram features, it is possible to get some information about the channel used by\nthe phishing kit to collect compromised data, such as its name and the users administering it.\n\n_Figure 8: Telegram channel used as drop for credentials by the attackers in their phishing_\n_campaigns emulating Okta authentication pages_\n\n\n-----\n\n-----\n\n_Figure 9: Administrators of the Telegram channel “Okta” used by attackers in their phishing_\n_campaigns that emulated Okta authentication pages_\n\nUnfortunately, there was no useful information on the first Telegram account, but luck was on\nour side with the second one. For now, we will call the creator of the “Okta” channel, Subject\nX, allegedly a 22-year-old software developer.\n\n_Figure 10: Subject X’s Telegram account_\n\nUsing [Group-IB Threat Intelligence to monitor Telegram channels used by cybercriminals, we](https://www.group-ib.com/products/threat-intelligence/)\nwere able to identify a few channels where Subject X was active at some point. One of the\nposts made by Subject X in 2019 led us to his Twitter account. The same tool also gave us\nthe name and last name the administrator of the channel was using, before adopting the\nname “X”.\n\n\n-----\n\n_Figure 11: Telegram post showing the Twitter account of Subject X_\n\n_Figure 12: Subject X’s Twitter account_\n\nLooking up the Twitter handle on Google gives back a GitHub account containing the same\nusername and profile picture. This account also suggests the location of Subject X is North\nCarolina, United States.\n\n\n-----\n\n_Figure 13: Subject X’s GitHub account_\n\n\n-----\n\nFrom here, we went down the rabbit hole of Internet clues that led us to the alleged identity\nof Subject X.\n\nRecommendations to avoid becoming a victim\n\nMaintaining a secure organization requires ongoing vigilance. Security measures such as\nMFA can appear secure but it is clear that attackers can overcome them with relatively\n[simple tools. Using Group-IB Threat Intelligence helps maintain a strong security posture by](https://www.group-ib.com/products/threat-intelligence/)\nequipping security teams and tools with the latest insight into attackers.\n\n**Group-IB recommends the following to mitigate similar attacks:**\n\n1. End users should always check, carefully, the URL of the site where you are entering\n\nyour credentials. This is especially important for users with privileged accounts.\n2. Treat all URLs that were received from unknown sources as suspicious. If in doubt,\n\nforward them to your security team for analysis.\n3. Implement a FIDO2-compliant security key from a vendor like YubiKey for multi-factor\n\nauthentication, like Cloudflare suggests\n4. If you think your credentials might have been compromised, immediately change your\n\npassword, sign off from all active sessions, and report the incident to your manager and\nsecurity team.\n\nIn line with Group-IB's mission of fighting cybercrime, we will continue to explore the\nmethods, tools, and tactics used by these phishing actors. We will also continue to inform\nand warn targeted organizations worldwide. We always strive to ensure that organizations\nunder attack are notified as quickly as possible to help reduce potential damage. We also\nconsider it our responsibility to share our findings with the cybersecurity community and\nencourage researchers to study advanced threats, share data, and use our technologies to\ncombat cybercrime — together.\n\nIf you are interested in what we do and would like to become an expert in the same field, you\ncan take our Digital Forensics, Incident Response, and Threat Intelligence training courses.\n[We also welcome applications to join the Group-IB team. Please check our vacancies on the](https://www.group-ib.com/careers.html)\nwebsite.\n\nTry Group-IB Threat Intelligence now!\n\nOptimize strategic, operational and tactical decision-making with best-in-class cyber threat\nanalytics\n\nTest Drive Group-IB Threat Intelligence\n\nIOCs\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-25 - Roasting 0ktapus- The phishing campaign going after Okta identity credentials.pdf"
    ],
    "report_names": [
        "2022-08-25 - Roasting 0ktapus- The phishing campaign going after Okta identity credentials.pdf"
    ],
    "threat_actors": [
        {
            "id": "9ddc7baf-2ea7-4294-af2c-5fce1021e8e8",
            "created_at": "2023-06-23T02:04:34.386651Z",
            "updated_at": "2025-03-27T02:02:10.009484Z",
            "deleted_at": null,
            "main_name": "Muddled Libra",
            "aliases": [
                "0ktapus",
                "Scatter Swine",
                "Scattered Spider"
            ],
            "source_name": "ETDA:Muddled Libra",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c3b908de-3dd1-4e5d-ba24-5af8217371f0",
            "created_at": "2023-10-03T02:00:08.510742Z",
            "updated_at": "2025-03-27T02:00:03.139677Z",
            "deleted_at": null,
            "main_name": "Scattered Spider",
            "aliases": [
                "Scatter Swine",
                "Storm-0971",
                "UNC3944",
                "Scattered Swine",
                "Octo Tempest",
                "0ktapus",
                "DEV-0971",
                "Starfraud",
                "Muddled Libra",
                "Oktapus"
            ],
            "source_name": "MISPGALAXY:Scattered Spider",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d093e8d9-b093-47b8-a988-2a5cbf3ccec9",
            "created_at": "2023-10-14T02:03:13.99057Z",
            "updated_at": "2025-03-27T02:02:09.728121Z",
            "deleted_at": null,
            "main_name": "Scattered Spider",
            "aliases": [
                "0ktapus",
                "LUCR-3",
                "Muddled Libra",
                "Octo Tempest",
                "Scatter Swine",
                "Scattered Spider",
                "Star Fraud",
                "Storm-0875",
                "UNC3944"
            ],
            "source_name": "ETDA:Scattered Spider",
            "tools": [
                "ADRecon",
                "AnyDesk",
                "ConnectWise",
                "DCSync",
                "FiveTran",
                "FleetDeck",
                "Govmomi",
                "Hekatomb",
                "Impacket",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "Lumma Stealer",
                "LummaC2",
                "Mimikatz",
                "Ngrok",
                "PingCastle",
                "ProcDump",
                "PsExec",
                "Pulseway",
                "Pure Storage FlashArray",
                "Pure Storage FlashArray PowerShell SDK",
                "RedLine Stealer",
                "Rsocx",
                "RustDesk",
                "ScreenConnect",
                "SharpHound",
                "Socat",
                "Spidey Bot",
                "Splashtop",
                "Stealc",
                "TacticalRMM",
                "Tailscale",
                "TightVNC",
                "VIDAR",
                "Vidar Stealer",
                "WinRAR",
                "WsTunnel",
                "gosecretsdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536022,
    "ts_updated_at": 1743041822,
    "ts_creation_date": 1662028062,
    "ts_modification_date": 1662028062,
    "files": {
        "pdf": "https://archive.orkl.eu/85b8a636ae72969169ca6e61f23eca1d7f819f2f.pdf",
        "text": "https://archive.orkl.eu/85b8a636ae72969169ca6e61f23eca1d7f819f2f.txt",
        "img": "https://archive.orkl.eu/85b8a636ae72969169ca6e61f23eca1d7f819f2f.jpg"
    }
}