{
    "id": "c1a3c159-9722-461f-b84c-ac7167935a8f",
    "created_at": "2022-10-25T16:48:24.587156Z",
    "updated_at": "2025-03-27T02:05:22.879815Z",
    "deleted_at": null,
    "sha1_hash": "ac49429483d9005f38f5202b77e8bf79c524e22b",
    "title": "Targeted information stealing attacks in South Asia use email, signed binaries",
    "authors": "",
    "file_creation_date": "2018-12-21T03:41:57Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 665481,
    "plain_text": "# Targeted information stealing attacks in South Asia use email, signed binaries\n\n**[welivesecurity.com/2013/05/16/targeted-threat-pakistan-india/](https://www.welivesecurity.com/2013/05/16/targeted-threat-pakistan-india/)**\n\nMay 16, 2013\n\nDetailed analysis of a targeted campaign that tries to steal sensitive information from\ndifferent organizations throughout the world, but particularly in Pakistan.\n\n[Update: Norman released a comprehensive [white paper profiling the group behind these](http://blogs.norman.com/2013/security-research/the-hangover-report)\nattacks]\n\nIn the past few months, we have analyzed a targeted campaign that tries to steal sensitive\ninformation from different organizations throughout the world, but particularly in Pakistan.\nDuring the course of our investigations we uncovered several leads that indicate this threat\nhas its origin in India and has been going on for at least two years. The journey began with\na code-signing certificate and an exploit and the scope of the investigation has widened\never since. In this blog post, we will highlight several interesting artifacts of the campaign,\nbut more will be revealed in my upcoming presentation at the 7th International CARO\nWorkshop in mid-May.\n\n## Code signing certificate\n\nFor part of this campaign a code signing certificate was used to sign malicious binaries\nand improve their potential to spread. This certificate was issued in late 2011 to an Indian\ncompany called Technical and Commercial Consulting Pvt. Ltd., based in New Delhi.\n\n\n-----\n\nWhen we started our investigation, the certificate had been revoked for files signed after\nMarch 31 2012. We contacted VeriSign with evidence that this certificate had been usedst\nmaliciously since it was issued and they promptly revoked the certificate unconditionally.\nOverall, we found more than 70 signed malicious binaries using this certificate. Since each\nsigned sample comes with an authoritative timestamp, it is possible to draw a timeline\ndepicting when these binaries were produced:\n\nFigure 1 Timeline of signing times. Black lines represent one sample signing time\n\nFrom the information we gathered, the attackers were actively signing malicious binaries\nfrom March until June 2012. Then, there is a gap in the timeline, from the beginning of July\nuntil the beginning of August 2012. We then see another spike in certificate usage (even\nthough it had already been revoked) in August and September 2012. There are several\npossible explanations as to why there is a gap during the summer of 2012, but it is likely\nthat this was the off-season for both the attackers and their targets.\n\nAlthough the investigation started with this code signing certificate, we then discovered\nseveral similar unsigned samples that were used in this campaign. Some of them were\ncollected as far back as early 2011.\n\n\n-----\n\nThe first infection vector we saw was using the famous [CVE-2012-0158 vulnerability. This](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0158)\nvulnerability can be exploited by a specially crafted Microsoft Office documents and allows\narbitrary code execution. In the case we analyzed, a two-stage shellcode is executed when\nthe user opens an RTF document. First, the shellcode sends information about the system\nto the domain feds.comule.com and then downloads a malicious binary from\ndigitalapp.org.\n\nThe other infection vector we found used PE files disguised as Microsoft Word or PDF\ndocuments, most likely distributed through email. When the user executes the file, the\nmalicious program downloads and executes additional malicious binaries (more on these\nexecutables below). To evade suspicion by the victim, a decoy Word document is shown to\nthe user. We have identified several different documents that followed different themes.\n\nOne of these themes is the Indian armed forces. We do not have inside information as to\nwhich individuals or organizations were really targeted by these files. However, based on\nour detection metrics, it is our assumption that people and institutions in Pakistan were\ntargeted.\n\nThe text in this first document seems to be a collage of various sources. The fake PDF\ndocument was delivered through a self-extracting archive called\n“pakistandefencetoindiantopmiltrysecreat.exe”:\n\n\n-----\n\nThis other PDF document was delivered through an executable called\n“pakterrisiomforindian.exe”:\n\n\n-----\n\nIn this case, the text comes from the Asian Defence blog, a blog aggregating Asian military\nnews. Our telemetry data shows that this file was first seen in August 2011 on a system in\nPakistan.\n\n## Payloads\n\nWe found many different types of payloads installed by the droppers, all of them were\ngeared towards exfiltrating data from an infected computer to the attackers’ servers. The\nfollowing table groups the binaries in different families and details their general\ncharacteristics.\n\nCategory Description\n\nDownloader Downloads executables from C&C and executes them.\n\nDocument Searches and uploads documents (csv, pdf, doc, docx, xlsx, etc) found in the trash\nuploader and in the “My Documents” folder.\n\nSystem Sends information about the infected system to the C&C using GET requests. It uses\ninformation WMI to gather information on the infected system such as: Antivirus installed on\ngathering machine; OS version; Presence of files to upload\n\nKeylogger Records keystrokes and sends log to attacker server using POST requests.\n\nScreenshot Takes a screenshot of the desktop and sends it to the C&C.\n\nConnect-back Continually tries to connect back to an hardcoded IP address and allows the attacker\nshell to open a remote command shell.\n\nPublic Tools [We found two public tools (WebPassView and Mail PassView) from NirSoft and](http://www.nirsoft.net/)\nsigned by the malicious certificate. These legitimate tools can be used to recover\n\n|Category|Description|\n|---|---|\n|Downloader|Downloads executables from C&C and executes them.|\n|Document uploader|Searches and uploads documents (csv, pdf, doc, docx, xlsx, etc) found in the trash and in the “My Documents” folder.|\n|System information gathering|Sends information about the infected system to the C&C using GET requests. It uses WMI to gather information on the infected system such as: Antivirus installed on machine; OS version; Presence of files to upload|\n|Keylogger|Records keystrokes and sends log to attacker server using POST requests.|\n|Screenshot|Takes a screenshot of the desktop and sends it to the C&C.|\n|Connect-back shell|Continually tries to connect back to an hardcoded IP address and allows the attacker to open a remote command shell.|\n\n\n-----\n\nreplication\nthrough\nremovable\ndrives\n\n\ninserted drive. It tries to lure the user into executing one of the copied files by\nrenaming it with an existing folder name and hiding the latter.\n\n\nThe information stolen from an infected computer is uploaded to the attacker’s server\nunencrypted. The decision not to use encryption is puzzling considering that adding basic\nencryption would be easy and provide additional stealth to the operation. The screenshot\nbelow shows a typical keylogger log:\n\nThe logs are very verbose and display the active window, the characters typed and the\nspecial keys in brackets. Since these logs are sent unencrypted, it is easy to detect the\npresence of an infected machine on your network by examining your HTTP network traffic.\n\nIn terms of persistence, many binaries we have analyzed add an entry in the Windows\nstartup menu with a deceptive name. The screen shot below shows an example of such a\nstartup menu:\n\n\n-----\n\nWhile this technique allows the different components of the attack to be launched after\neach system reboot, it cannot be labelled as stealthy. Since targeted attacks usually try to\nstay under the radar as long as possible, we were surprised to see this technique used in\nthis case.\n\n## C&C infrastructure\n\nMost of the analyzed binaries contain a URL from which additional components are\ndownloaded or to which an infected system’s content is uploaded. Sometimes, the C&C\nURL appears unencrypted in the binary. Other times, it is trivially encoded using a simple\none-character rotation (ROT-1) as depicted below:\n\n1 “gjmftbttpdjbuf/ofu” encrypted to “filesassociate.net”\n\nWe uncovered more than 20 domains linked to this campaign. While some still had an\nactive DNS record, most of them did not resolve to an IP address. Using historical data\naround these domains, we were able to discover where these sites were hosted. It turns out\nthat almost a third of all domains were hosted by OVH. This web hosting service has a\n[reputation for hosting malware and spam content. In a recent HOSTExploit report it was](http://hostexploit.com/downloads/viewdownload/7/46.html)\nranked number 5 in the top 50 hosts for concentration of malicious activity served from an\nAutonomous System.\n\nMost of the domain names are very close to real site or company names. This is a common\ntactic to try to conceal the true purpose of the C&C server. Two examples are\n“wearwellgarments.eu” and “secuina.com”. The former is very close to a real website called\n“wearwellgarments.com” while the latter looks like a misspelling of information security\nfi S i\n\n\n-----\n\nAnalyzing this campaign allowed us to identify a few key indicators pointing to the\ngeographic origin of these malicious files. We believe they all come from India. First, the\ncode signing certificate was issued to an Indian company. In addition, all the signing\ntimestamps are between 5:06 and 13:45 UTC, which is consistent with 8-hour work shifts\nfalling between 10:36 and 19:15 in Indian Standard Time. This might seem a bit late, but\nconsidering that signing the binary is the last step in the development effort, it is likely that\nthe malware authors were living in this time zone.\n\nWe also found several strings in the binaries that are related to Indian culture. In several\nscripts, a variable called ramukaka is used:\n\nRamu Kaka is a typical Bollywood-style servant in a house. Considering that this variable is\nresponsible for achieving persistence on the system, this definition is a good fit.\n\nThe most compelling argument is found in our telemetry data. We found that many\nmalware variants tied to this campaign appeared in the same location over a very small\nperiod of time. Each variant had only minor differences from each other, strongly\nsuggesting an attempt by a malware creator to evade detection by our product. These files\nall appeared in the same region of India.\n\n## Infection statistics\n\nOur telemetry data shows that Pakistan is heavily affected by this campaign. The following\ngraph shows the detection distribution we have observed for all the malicious files we\nlinked to this campaign in the last two years.\n\n\n-----\n\nThanks to our sinkholing of three domain names used by this campaign, we were also able\nto gather statistics on the geographical location of infected hosts.\n\nAs one can see, the regional distribution presented in the last two graphs is very different.\nUkraine and Kazakhstan account for three quarters of all IP addresses seen during the\nsinkholing operation. This difference can be explained by the possibility that unique\ndomains are only for specific sub-operation in this campaign. If that was the case, the\nsinkhole data we are seeing would only be a very partial view of the whole campaign.\n\n## Conclusion\n\nThis post examined evidence of a far-reaching targeted campaign aimed at different\n\n\n-----\n\nthat the most prominent target is Pakistan. Targeted attacks are all too common these\ndays, but this one is certainly noteworthy for its failure to employ advanced tools to conduct\nits campaigns. String obfuscation using simple rotation (a shift cipher), no cryptography\nused in network communication, persistence achieved through the startup menu and use of\nexisting, publicly-available tools to gather information on infected systems shows that the\nattackers did not go to great lengths to cover their tracks. On the other hand, maybe they\nsee no need to implement stealthier techniques because the simple ways still work.\n\n### SHA1 Hashes\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n\nCVE-2012-0158 RTF Document:         3b1d9d65159bea24ab1060e5603f9e3c2d38d08d\n\npakterrisiomforindian.exe:          d859f1cf99049f89258c1faa59dcd97f587e45ac\n\npakistandefencetoindiantopmiltrysecreat.exe: 1db89237ef786c7f22a8d4cd7eccda8f6286a6de\n\nDownloader:                 08ce405f0a0277de355454862b164ffd94a7ea36\n\nDocument uploader:              DB22E7DEA0C1CAF203072693485DE4E4FD2CB56A\n\nSystem information gathering:        0D610F3F51750EADCF426E10E6DE5313605400FA\n\nKeylogger:                  AE7B9CFB10CD65B98C59DC012D6726B66BE92897\n\nScreenshot:                 A0DD0B8FD0C98E917BFDC96182088CAB5505CCD2\n\nConnect-back shell:             09D4ECA67B1D071E57C5951D97FE9DD9C62F1580\n\nSelf-replication through removable drives:  20A29D1F89C07BAFBB4C61CE208531D68125C8E\n\n\n### Detection Names\n\nBelow are ESET threat names related to this case:\n\n\n-----\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n\nWin32/Spy.Agent.NZD trojan\n\nWin32/Spy.Agent.OBF trojan\n\nWin32/Spy.Agent.OBV trojan\n\nWin32/Spy.KeyLogger.NZL trojan\n\nWin32/Spy.KeyLogger.NZN trojan\n\nWin32/Spy.VB.NOF trojan\n\nWin32/Spy.VB.NRP trojan\n\nWin32/TrojanDownloader.Agent.RNT trojan\n\nWin32/TrojanDownloader.Agent.RNV trojan\n\nWin32/TrojanDownloader.Agent.RNW trojan\n\nWin32/VB.NTC trojan\n\nWin32/VB.NVM trojan\n\nWin32/VB.NWB trojan\n\nWin32/VB.QPK trojan\n\nWin32/VB.QTV trojan\n\nWin32/VB.QTY trojan\n\nWin32/Spy.Agent.NVL trojan\n\nWin32/Spy.Agent.OAZ trojan\n\n\n[Jean-Ian Boutin 16 May 2013 - 10:15AM](https://www.welivesecurity.com/author/boutin/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2013/2013.05.16.targeted-threat-pakistan-india/welivesecurity.com-Targeted%20information%20stealing%20attacks%20in%20South%20Asia%20use%20email%20signed%20binaries.pdf"
    ],
    "report_names": [
        "welivesecurity.com-Targeted information stealing attacks in South Asia use email signed binaries"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041122,
    "ts_creation_date": 1545363717,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/ac49429483d9005f38f5202b77e8bf79c524e22b.pdf",
        "text": "https://archive.orkl.eu/ac49429483d9005f38f5202b77e8bf79c524e22b.txt",
        "img": "https://archive.orkl.eu/ac49429483d9005f38f5202b77e8bf79c524e22b.jpg"
    }
}