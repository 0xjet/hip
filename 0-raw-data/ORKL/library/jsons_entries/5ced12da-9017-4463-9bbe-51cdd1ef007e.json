{
    "id": "5ced12da-9017-4463-9bbe-51cdd1ef007e",
    "created_at": "2023-01-12T15:03:57.496151Z",
    "updated_at": "2025-03-27T02:16:05.779313Z",
    "deleted_at": null,
    "sha1_hash": "9fc97bf12ea2b9c3f950ba841b9ad597cea0de69",
    "title": "2017-10-02 - Evidence Aurora Operation Still Active Part 2- More Ties Uncovered Between CCleaner Hack & Chinese Hackers",
    "authors": "",
    "file_creation_date": "2022-05-28T18:28:15Z",
    "file_modification_date": "2022-05-28T18:28:15Z",
    "file_size": 4526520,
    "plain_text": "# Evidence Aurora Operation Still Active Part 2: More Ties Uncovered Between CCleaner Hack & Chinese Hackers\n\n**intezer.com/evidence-aurora-operation-still-active-part-2-more-ties-uncovered-between-ccleaner-hack-chinese-**\nhackers/\n\nOctober 2, 2017\n\nWritten by Jay Rosenberg - 2 October 2017\n\n## Get Free Account\n\nJoin Now\n\nSince my [last post, we have found new evidence in the next stage payloads of the](https://www.intezer.com//evidence-aurora-operation-still-active-supply-chain-attack-through-ccleaner/)\nCCleaner supply chain attack that provide a stronger link between this attack and the Axiom\ngroup.\n\nFirst of all, our researchers would like to thank the entire team at Cisco Talos for their\n[excellent work on this attack (their post regarding stage 2 can be found here) as well as](http://blog.talosintelligence.com/2017/09/ccleaner-c2-concern.html)\ntheir cooperation by allowing us access to the stage 2 payload. Also, we would like to give a\nspecial thanks to Kaspersky Labs for their collaboration.\n\n**The Next Connection**\n\n\n-----\n\nStarting from the stage 2 payload, I reverse engineered the module, extracting other hidden\n[shellcode and binaries within. After uploading the different binaries to Intezer Analyze™, the](https://www.intezer.com//intezer-analyze/)\nfinal payload (that I have access to) had a match with a binary relating to the Axiom group.\n\nAt first glance, I believed it was going to be the same custom base64 function as mentioned\nin my [previous blog post. A deeper look in the shared code proved otherwise.](https://www.intezer.com//evidence-aurora-operation-still-active-supply-chain-attack-through-ccleaner/)\n\nBinary in screenshot:\n\nf0d1f88c59a005312faad902528d60acbf9cd5a7b36093db8ca811f763e1292a\n\nRelated APT17 samples:\n\n07f93e49c7015b68e2542fc591ad2b4a1bc01349f79d48db67c53938ad4b525d\n\n0375b4216334c85a4b29441a3d37e61d7797c2e1cb94b14cf6292449fb25c7b2\n\n20cd49fd0f244944a8f5ba1d7656af3026e67d170133c1b3546c8b2de38d4f27\n\nee362a8161bd442073775363bf5fa1305abac2ce39b903d63df0d7121ba60550\n\n\n-----\n\nNot only did the first payload have shared code between the Axiom group and CCBkdr, but\nthe second did as well. The above photo shows the same function between two binaries.\nLet me put this into better context for you: out of all the billions and billions of pieces of code\n(both trusted and malicious) contained in the Intezer Code Genome Database, we found\nthis code in only these APTs. It is also worth noting that this isn’t a standard method one\nwould use to call an API. The attacker used the simple technique of employing an array to\nhide a string from being in clear sight of those analyzing the binary (although to those who\nare more experienced, it is obvious) and remain undetected from antivirus signatures. The\nauthor probably copied and pasted the code, which is what often happens to avoid\nduplicative efforts: rewriting the same code for the same functionality twice.\n\n\n-----\n\nDue to the uniqueness of the shared code, we strongly concluded that the code was written\nby the same attacker.\n\n**Technical Analysis:**\n\nThe stage two payload that was analyzed in this report\n(dc9b5e8aa6ec86db8af0a7aa897ca61db3e5f3d2e0942e319074db1aaccfdc83), after\nlaunching the infected version of CCleaner, was dropped to only a selective group of\ntargets, as reported by Talos. Although there is an x64 version, the following analysis will\nonly include the x86 version because they are nearly identical. I will not be going too far in\ndepth as full comprehension of the technical analysis will require an understanding of\nreverse engineering.\n\nInstead of using the typical API (VirtualAlloc) to allocate memory, the attackers allocated\nmemory on the heap using LocalAlloc, and then copied a compressed payload to the\nallocated memory.\n\n\n-----\n\nIt looks like the attackers used version 1.1.4 of zlib to decompress the payload into this\nallocated memory region.\n\n\n-----\n\nDepending on if you’re running x86 or x64 Windows, it will drop a different module. (32-bit\n07fb252d2e853a9b1b32f30ede411f2efbb9f01e4a7782db5eacf3f55cf34902, 64-bit\n128aca58be325174f0220bd7ca6030e4e206b4378796e82da460055733bb6f4f) Both\nmodules are actually legitimate software with additional code and a modified execution flow.\n\n\n-----\n\nThe last modified time on the modules is changed to match that of the msvcrt.dll that is\nlocated in your system32 folder–a technique to stay under the radar by not being able to\ncheck last modified files.\n\n\n-----\n\nSome shellcode and another module are written to the registry.\n\n\n-----\n\n-----\n\nAfter the module is successfully dropped, a service is created under the name Spooler or\nSessionEnv, depending upon your environment, which then loads the newly dropped\nmodule.\n\nThe new module being run by the service allocates memory, reads the registry where the\nother payload is located, and then copies it to memory.\n\n\n-----\n\n-----\n\nThe next payload is executed, which decrypts another module and loads it. If we look at the\nmemory of the next decrypted payload, we can see something that looks like a PE header\nwithout the MZ signature. From here, it is as simple as modifying the first two bytes to\nrepresent MZ and we have a valid PE file.\n(f0d1f88c59a005312faad902528d60acbf9cd5a7b36093db8ca811f763e1292a)\n\n\n-----\n\nThe next module is a essentially another backdoor that connects to a few domains; before\nrevealing the true IP, it will connect to for the next stage payload.\n\n\n-----\n\n[It starts by ensuring it receives the correct response from https://www.microsoft.com and](https://www.microsoft.com/)\n[https://update.microsoft.com.](https://update.micrsoft.com/)\n\n\n-----\n\nThe malware proceeds to decrypt two more URLs.\n\nThe malware authors used steganography to store the IP address in a ptoken field of the\nHTML.\n\nHere you can see the GitHub page with the ptoken field.\n\n\n-----\n\nThe value is then XOR decrypted by 0x31415926 which gives you 0x5A093B0D or the IP\naddress: 13.59.9.90\n\n**Conclusion:**\n\nThe complexity and quality of this particular attack has led our team to conclude that it was\nmost likely state-sponsored. Considering this new evidence, the malware can be attributed\nto the Axiom group due to both the nature of the attack itself and the specific code reuse\nthroughout that our technology was able to uncover.\n\n**IOCs:**\n\nStage 2 Payload:\ndc9b5e8aa6ec86db8af0a7aa897ca61db3e5f3d2e0942e319074db1aaccfdc83\n\nx86 Trojanized Binary:\n07fb252d2e853a9b1b32f30ede411f2efbb9f01e4a7782db5eacf3f55cf34902\n\nx86 Registry Payload:\nf0d1f88c59a005312faad902528d60acbf9cd5a7b36093db8ca811f763e1292a\n\nx64 Trojanized Binary:\n128aca58be325174f0220bd7ca6030e4e206b4378796e82da460055733bb6f4f\n\n\n-----\n\nx64 Registry Payload:\n75eaa1889dbc93f11544cf3e40e3b9342b81b1678af5d83026496ee6a1b2ef79\n\nRegistry Keys:\n\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\001\n\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\002\n\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\003\n\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\004\n\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WbemPerf\\HBP\n\n**About Intezer:**\n\nThrough its ‘DNA mapping’ approach to code, Intezer provides enterprises with unparalleled\nthreat detection that accelerates incident response and eliminates false positives, while\nprotecting against fileless malware, APTs, code tampering and vulnerable software.\n\n_Curious to learn what’s next for Intezer? Join us on our journey toward achieving these_\n_[endeavors here on the blog or request a community free edition invite](https://intezer.viewpage.co/free-community-edition)_\n\n**Jay Rosenberg**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-10-02 - Evidence Aurora Operation Still Active Part 2- More Ties Uncovered Between CCleaner Hack & Chinese Hackers.pdf"
    ],
    "report_names": [
        "2017-10-02 - Evidence Aurora Operation Still Active Part 2- More Ties Uncovered Between CCleaner Hack & Chinese Hackers.pdf"
    ],
    "threat_actors": [
        {
            "id": "cea5ceec-0f14-4e34-bd0e-4074bc1a707d",
            "created_at": "2022-10-25T15:50:23.629983Z",
            "updated_at": "2025-03-27T02:00:55.509459Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72"
            ],
            "source_name": "MITRE:Axiom",
            "tools": [
                "ZxShell",
                "gh0st RAT",
                "Zox",
                "PlugX",
                "Hikit",
                "PoisonIvy",
                "Derusbi",
                "Hydraq"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2150d1ac-edf0-46d4-a78a-a8899e45b2b5",
            "created_at": "2022-10-25T15:50:23.269339Z",
            "updated_at": "2025-03-27T02:00:55.416524Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "APT17",
                "Deputy Dog"
            ],
            "source_name": "MITRE:APT17",
            "tools": [
                "BLACKCOFFEE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5c74936a-79d1-41b8-81eb-01d03c90a26b",
            "created_at": "2022-10-25T16:07:23.371052Z",
            "updated_at": "2025-03-27T02:02:09.766782Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72",
                "Operation SMN"
            ],
            "source_name": "ETDA:Axiom",
            "tools": [
                "9002 RAT",
                "Agent.dhwf",
                "AngryRebel",
                "BlackCoffee",
                "BleDoor",
                "Chymine",
                "Darkmoon",
                "DeputyDog",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Fexel",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Gresim",
                "HOMEUNIX",
                "HiKit",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Kaba",
                "Korplug",
                "McRAT",
                "MdmBot",
                "Moudour",
                "Mydoor",
                "PCRat",
                "PNGRAT",
                "PlugX",
                "Poison Ivy",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Roarur",
                "SPIVY",
                "Sensocode",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "ZXShell",
                "Zox",
                "ZoxPNG",
                "ZoxRPC",
                "gresim",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "0769c188-62ce-44ee-8e9d-1067f3d3c083",
            "created_at": "2022-10-25T16:07:24.259063Z",
            "updated_at": "2025-03-27T02:02:10.152956Z",
            "deleted_at": null,
            "main_name": "Pat Bear",
            "aliases": [
                "APT-C-37",
                "Pat Bear",
                "Racquet Bear"
            ],
            "source_name": "ETDA:Pat Bear",
            "tools": [
                "Bladabindi",
                "CypherRat",
                "DroidJack",
                "H-Worm",
                "H-Worm RAT",
                "Houdini",
                "Houdini RAT",
                "Hworm",
                "Iniduoh",
                "Jenxcus",
                "Jorik",
                "Kognito",
                "Njw0rm",
                "SSLove RAT",
                "SpyNote",
                "SpyNote RAT",
                "WSHRAT",
                "dinihou",
                "dunihi",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1edcac0b-efd9-47b1-9aca-33827d5bd085",
            "created_at": "2024-05-01T02:03:07.964773Z",
            "updated_at": "2025-03-27T02:05:17.273595Z",
            "deleted_at": null,
            "main_name": "BRONZE KEYSTONE",
            "aliases": [
                "Aurora Panda ",
                "DeputyDog ",
                "Group 72 ",
                "Hidden Lynx ",
                "Shell Crew",
                "TG-8153 ",
                "Tailgater Team",
                "APT17 "
            ],
            "source_name": "Secureworks:BRONZE KEYSTONE",
            "tools": [
                " BlackCoffee",
                " DeputyDog",
                " Derusbi",
                " Gh0stHTTPSDropper",
                " HiKit",
                " InternalCMD",
                " PlugX",
                " PoisonIvy",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535837,
    "ts_updated_at": 1743041765,
    "ts_creation_date": 1653762495,
    "ts_modification_date": 1653762495,
    "files": {
        "pdf": "https://archive.orkl.eu/9fc97bf12ea2b9c3f950ba841b9ad597cea0de69.pdf",
        "text": "https://archive.orkl.eu/9fc97bf12ea2b9c3f950ba841b9ad597cea0de69.txt",
        "img": "https://archive.orkl.eu/9fc97bf12ea2b9c3f950ba841b9ad597cea0de69.jpg"
    }
}