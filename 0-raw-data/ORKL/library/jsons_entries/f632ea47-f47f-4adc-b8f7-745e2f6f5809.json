{
    "id": "f632ea47-f47f-4adc-b8f7-745e2f6f5809",
    "created_at": "2023-01-12T15:06:00.754623Z",
    "updated_at": "2025-03-27T02:16:11.536707Z",
    "deleted_at": null,
    "sha1_hash": "b02c032f90dea590dc80ef2defc1adbb6b47b7d1",
    "title": "2022-02-01 - StrifeWater RAT- Iranian APT Moses Staff Adds New Trojan to Ransomware Operations",
    "authors": "",
    "file_creation_date": "2022-05-28T00:32:39Z",
    "file_modification_date": "2022-05-28T00:32:39Z",
    "file_size": 767806,
    "plain_text": "# StrifeWater RAT: Iranian APT Moses Staff Adds New Trojan to Ransomware Operations\n\n**[cybereason.com/blog/strifewater-rat-iranian-apt-moses-staff-adds-new-trojan-to-ransomware-operations](https://www.cybereason.com/blog/strifewater-rat-iranian-apt-moses-staff-adds-new-trojan-to-ransomware-operations)**\n\nWritten By\nCybereason Nocturnus\n\nFebruary 1, 2022 | 7 minute read\n\n\n-----\n\nOver the past months, the [Cybereason Nocturnus Team has been tracking the Iranian](https://www.cybereason.com/blog/authors/cybereason-nocturnus)\n[hacker group known as Moses Staff. The group was first spotted in October 2021 and claims](https://twitter.com/campuscodi/status/1450455259202166799)\ntheir motivation is to harm Israeli companies by leaking sensitive, stolen data.\n\nAside from Israel, which appears to be the main target of the group, Moses Staff was\nobserved targeting organizations in other countries, including Italy, India, Germany, Chile,\nTurkey, UAE, and the US. The group targets a variety of industries, among them\nGovernment, Finance, Travel, Energy, Manufacturing, and the Utilities industry.\n\n[Following recently published research detailing the group’s TTPs including their main tools](https://research.checkpoint.com/2021/mosesstaff-targeting-israeli-companies/)\n“PyDcrypt” and “DCSrv”, the Cybereason Nocturnus team discovered a previously\nunidentified Remote Access Trojan (RAT) in the Moses Staff arsenal dubbed StrifeWater.\n\nThe StrifeWater RAT appears to be used in the initial stage of the attack and this stealthy\nRAT has the ability to remove itself from the system to cover the Iranian group’s tracks. The\nRAT possesses other capabilities, such as command execution and screen capturing, as well\nas the ability to download additional extensions.\n\nNormally, once the group infiltrates an organization and steals sensitive data, they deploy\nransomware to encrypt the infected machines. Unlike financially motivated cybercrime\nransomware groups who encrypt the files as leverage for ransom payment, the encryption of\nthe files in the Moses Staff attacks serves two purposes: inflicting damages by disrupting\ncritical business operations, and covering the attackers’ tracks.\n\nThe end goal for Moses Staff appears to be more politically-motivated rather than financial.\nAnalysis of the group’s conduct and operations suggests that Moses Staff leverages cyber\nespionage and sabotage to advance Iran’s geopolitical goals by inflicting damage and\nspreading fear. (Related Iranian APT research: PowerLess Trojan: Iranian APT Phosphorus\nAdds New PowerShell Backdoor for Espionage).\n\n## Key Findings\n\n**Novel Remote Access Trojan: A newly undocumented RAT dubbed StrifeWater**\nassessed to be part of the arsenal used by Iranian APT Moses Staff. The RAT is\nassessed to be specifically used in the initial phase of infection and is later replaced\nwith other tools\n\n**Various Functionality: The StrifeWater RAT has various capabilities, among them:**\nlisting system files, executing system commands, taking screen captures, creating\npersistence, and downloading updates and auxiliary modules.\n\n**Under the Radar: The StrifeWater RAT appears to be removed from the infected**\nenvironment in time for the deployment of the ransomware. This is likely the reason the\nRAT was not detected before.\n\n\n-----\n\n**State-Sponsored Ransomware: Moses Staff employs ransomware post-exfiltration**\nnot for financial gain, but to disrupt operations, obfuscate espionage activity, and to\ninflict damage to systems to advance Iran’s geopolitical goals.\n**Victims Across the Globe: The Moses Staff list of victims includes multiple countries**\nand regions, among them: Israel, Italy, India, Germany, Chile, Turkey, UAE, and the\nUS.\n\n### StrifeWater: A New Iranian RAT\n\nThe Cybereason Nocturnus Team has been tracking the activities of the Moses Staff threat\ngroup since their operations first became known in 2021. While monitoring the group’s\nactivity, Cybereason researchers discovered an undocumented RAT dubbed StrifeWater that\nis used by Moses Staff in the initial stage of the attack. It was observed that the StrifeWater\nRAT was deployed in infected environments under the name “calc.exe”. One of the key clues\nthat led to the discovery of the StrifeWater RAT came from an analysis of a new variant of\nthe PyDCrypt malware used by the Moses Staff group.\n\n**Zeroing-in on the Moses Staff PyDCrypt Malware**\n\nThe Nocturnus Team found a new sample of the PyDCrypt malware, which was described in\n[Checkpoint’s blog published in November 2021. PyDCrypt is written in python and compiled](https://research.checkpoint.com/2021/mosesstaff-targeting-israeli-companies/)\nusing [PyInstaller. Its goal is to spread to other computers and to drop the payload “DCSrv”, a](https://www.pyinstaller.org/)\n[ransomware variant based on the publicly available tool DiskCryptor.](https://github.com/DavidXanatos/DiskCryptor)\n\nAccording to previous observations, the Moses Staff group builds a new sample of PyDCrypt\nfor each targeted organization with hard coded parameters such as an admin username and\npassword, a machines list, and a local domain. The inclusion of this hard coded information\nmeans PyDCrypt is only deployed in a late stage of the attack after the environment is\nalready compromised and sufficient reconnaissance efforts to map out the target’s\nenvironment have already taken place.\n\nThe newly discovered PyDCrypt variant had one significant change to it: instead of the\nransomware payload, the script contains what appears to be a test executable embedded\nwhich merely prints “Hello” upon execution. This could indicate that this variant is still in the\ndevelopment and testing phase.\n\nMoses Staff often uses the folder “C:\\Users\\Public” to store its deployed tools. As part of its\nexecution, PyDCrypt copies the original Windows calculator binary (calc.exe) from system32\nto the folder where the rest of the payloads are saved (C:\\Users\\Public\\calc.exe) and then\ndeletes it:\n\n_From PyDCrypt source code: Removing a file named “calc exe”_\n\n\n-----\n\nWe suspect that PyDCrypt s removal of calc.exe from the infected machine is an attempt to\nremove evidence of the StrifeWater RAT, which is also named “calc.exe” by the attackers.\nWe estimate that the replacement of the StrifeWater RAT with the original Windows\nCalculator binary and its immediate deletion, was done in an attempt to cover the attackers’\ntracks and thwart forensic analysis efforts.\n\nDue to the fact that PyDCrypt is a late stage attack tool that is deployed after reconnaissance\nwas undertaken, Moses Staff must have a foothold of the infected environments before its\ndeployment. Based on our analysis of the StrifeWater RAT, we suspect that it is used by the\nattackers to gain a foothold and to conduct initial reconnaissance on the compromised\ntarget.\n\nStrifeWater AnalysisStrifeWater is a previously undocumented RAT that is suspected to be\nused in the initial stages of the Moses Staff infection chain in order to achieve persistence\nand gain control over the network, appearing as the file “calc.exe”:\n\n_StrifeWater execution as seen in the_\n\n_Cybereason XDR Platform_\n\nThe main capabilities of StrifeWater include:\n\nListing system files\nExecuting shell commands using cmd.exe\nTaking screen captures\nCreating persistence via a scheduled task\nDownloading updates and auxiliary modules\n\nIn addition, the RAT can extend its capabilities by downloading several module extensions,\nalthough the functionality of these modules is not known at the time of writing.\n\nThe RAT has the following PDB string:\n“C:\\Users\\win8\\Desktop\\ishdar_win8\\1\\x64\\Release\\brokerhost.pdb”\n\nIt uses a hard coded IP address and URI to communicate with its command and control (C2)\nserver (87.120.8[.]210:80/RVP/index8.php):\n\n\n-----\n\n_StrifeWater Command and Control as seen in the Cybereason XDR Platform_\n\nAlthough the malware always uses the same IP address and URL, it also contains a domain\nand an additional URL that have yet been observed in use:\n\ntechzenspace[.]com\nRVP/index3.php\n\n_Hardcoded domain, IP, and URI_\n\nAt the beginning of execution, the StrifeWater RAT collects profiling data about the infected\nmachine in order to create a unique token for that device. The data used to create the token\nare:\n\n\n-----\n\nMachine name\nUser name\nOS version\nArchitecture\nTime zone\nUser privileges\n\n_Infected machine profiling data string_\n\nThe string displayed in the image above is then XORed with a hard coded key and combined\nwith an additional hard coded string in order to create the token:\n\n_Unique token sent to the C2_\n\nThe same key (“9c4arSBr32g6IOni”) is used to encrypt all commands that are sent and\nreceived from the C2.\n\n**StrifeWater RAT Key Commands**\n\nThe StrifeWater RAT receives various commands from the C2, including:\n\n**Listing system files**\n\n_Going through Windows folders function_\n\n**Executing shell commands using cmd.exe**\n\n_Executing cmd.exe function_\n\n\n-----\n\n**Taking screen captures**\n\n_Taking screen captures function_\n\n**Persistence**\n\nThe RAT will create persistence using a scheduled task named: ”Mozilla\\Firefox Default\n_Browser Agent 409046Z0FF4A39CB”_\n\n_Creating a scheduled task for persistence_\n\n**Download an updated version of the RAT**\n**Self deletion**\n\n**Download files to the infected machine**\n\n**Updating the sleep time responses of the malware (the default is 20 - 22**\n**seconds)**\n\n**Auxiliary Modules**\n\nThe StrifeWater RAT has the capability to download different modules based on the\ncommand received, although the functionality of these other modules are not known at the\ntime of writing this report. The available extensions are named:\n\nmainfunc\n\n\n-----\n\nAh13\nmkb64\nstrt\n\n_Downloading and loading the auxiliary module “mainfunc”_\n\nIn case the command to download the extension “strt” is received and the extension is\nalready loaded, the RAT will send to the C2 the contents of a file named:\n“C:\\users\\public\\libraries\\async.dat”\n\nThis file probably contains data that is related to the functionality of the extension “strt”.\n\n**C2 Communication Parameters**\n\nThe StrifeWater RAT appears to distinguish between the type of data that is being sent to the\nC2 by the parameter “name” that is being sent in the packet to the C2. The parameter can be\nany value between “name0” to “name12”:\n\n_C2 communication with parameter “name0”_\n\n_C2 communication with parameter “name2”_\n\n_C2 communication with parameter “name3”_\n\nMeaning of the different “name parameters”:\n\n**Parameter** **Data Sent**\n\nname0 signal that a command is executing\n\nname1 first communication with the C2\n\nname2 sending a list of system files\n\nname3 cmd shell command output\n\n\n-----\n\nname4 sending a screen capture\n\nname5 confirmation that a file has been downloaded\n\nname6 sending the output of the extension “mainfunc”\n\nname7 sending the “async.dat” file\n\nname8 unknown\n\nname9 request to download a file (update/extension)\n\nname10 confirmation that the sleep time was updated successfully\n\nname11 sending the output of the \"mkb64\" extension\n\nname12 unknown\n\n_Name parameters table_\n\n## Conclusion\n\nIn this report, the Cybereason Nocturnus Team analyzed a previously unknown RAT dubbed\n_StrifeWater that is being used in targeted ransomware attacks, carried out by the Iranian APT_\ngroup Moses Staff. The StrifeWater RAT is suspected to be one of the main tools that are\nused to create a foothold in victim environments, and appears to only be used in the earlier\nstages of the attack.\n\nOur analysis suggests that the Moses Staff operators make conscious efforts to stay under\nthe radar and avoid detection until the last phase of the attack when they deploy and execute\ntheir ransomware payload. Furthermore, our research shows that the Moses Staff modus\noperandi includes attempts to masquerade its arsenal as legitimate Windows software along\nwith the removal of their initial persistence and reconnaissance tools. This tactic helps to\nprevent investigators from discovering the full flow of the attack and thus the StrifeWater RAT\nremained undetected.\n\nMoses Staff’s goals seem aligned with Iran’s cyber warfare doctrine, seeking to sabotage\ngovernment, military, and civilian organizations related to its geo-political opponents. Unlike\ncriminal cybercrime groups that use ransomware to coerce their victims to pay a ransom fee,\n\n\n-----\n\nit is assessed that the Moses Staff group will leak sensitive information without demanding a\nransom fee, and it was [previously assessed that their goals are political in nature.](https://therecord.media/new-moses-staff-group-targets-israeli-organizations-in-destructive-attacks/#:~:text=Instead%20of%20trying%20to%20hide,their%20intrusions%20are%20politically%20motivated.&text=As%20a%20result%2C%20the%20group,in%20a%20ransom%20negotiation%20process.)\n\nThe emergence of new PyDyrcypt malware samples, further shows that the Iranian APT\ngroup Moses Staff is still active and continues its nefarious activities and development of its\nattack arsenal.\n\nThe [Cybereason XDR Platform detects and blocks the StrifeWater RAT and other advanced](https://www.cybereason.com/platform/xdr)\nTTPs used in this operation. Cybereason is dedicated to teaming with defenders to end\nattacks on the endpoint, across enterprise, to everywhere the battle is taking place.\n\n## MITRE ATT&CK BREAKDOWN\n\n**Reconnaissance** **Execution** **Persistence** **Defense Evasion**\n\n\nGather Victim Host\nInformation\n\nGather Victim Identity\nInformation\n\n\nCommand-line\ninterface\n\n\nScheduled\nTask/Job\n\n\nIndicator Removal on\nHost\n\n[Masquerading](https://attack.mitre.org/techniques/T1036/)\n\n**Impact**\n\n\n**Discovery** **Collection** **Command and**\n**Control**\n\n\nFile and Directory\nDiscovery\n\n\nScreen\nCapture\n\n\n[Data Encoding](https://attack.mitre.org/techniques/T1132/) Data Encrypted for\nImpact\n\n\n## About the Researcher\n\nTOM FAKTERMAN\n\nTom Fakterman, Cyber Security Analyst with the Cybereason Nocturnus Research Team,\nspecializes in protecting critical networks and incident response. Tom has experience in\nresearching malware, computer forensics and developing scripts and tools for automated\n\n\n-----\n\ncyber investigations.\n\n## Indicators of Compromise | StrifeWater RAT\n\n**PyDcrypt**\n\n29a08031c4debc7f91ca8efb40b7858c9aafc3ed\n\n**StrifeWater RAT**\n\n76a35d4087a766e2a5a06da7e25ef76a8314ec84\n\n5cacfad2bb7979d7e823a92fb936c5929081e691\n\n**Domains**\n\ntechzenspace[.]com\n\n**IP Addresses**\n\n87.120.8[.]210\n\n**URIs**\n\n/RVP/index8.php\n\n/RVP/index3.php\n\nAbout the Author\n\n**Cybereason Nocturnus**\n\n\n-----\n\nThe Cybereason Nocturnus Team has brought the world s brightest minds from the military,\ngovernment intelligence, and enterprise security to uncover emerging threats across the\nglobe. They specialize in analyzing new attack methodologies, reverse-engineering malware,\nand exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first\nto release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.\n\n[All Posts by Cybereason Nocturnus](https://www.cybereason.com/blog/authors/cybereason-nocturnus)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-01 - StrifeWater RAT- Iranian APT Moses Staff Adds New Trojan to Ransomware Operations.pdf"
    ],
    "report_names": [
        "2022-02-01 - StrifeWater RAT- Iranian APT Moses Staff Adds New Trojan to Ransomware Operations.pdf"
    ],
    "threat_actors": [
        {
            "id": "527e04ee-7f5f-49aa-8653-f893b43730bd",
            "created_at": "2022-10-25T16:07:24.512541Z",
            "updated_at": "2025-03-27T02:02:10.266333Z",
            "deleted_at": null,
            "main_name": "Moses Staff",
            "aliases": [
                "Abraham's Ax",
                "Cobalt Sapling",
                "DEV-0500",
                "Marigold Sandstorm",
                "Vengeful Kitten",
                "White Dev 95"
            ],
            "source_name": "ETDA:Moses Staff",
            "tools": [
                "DCSrv",
                "DCrSrv",
                "PyDCrypt",
                "StrifeWater",
                "StrifeWater RAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d8af157e-741b-4933-bb4a-b78490951d97",
            "created_at": "2023-01-06T13:46:38.748929Z",
            "updated_at": "2025-03-27T02:00:02.908256Z",
            "deleted_at": null,
            "main_name": "APT35",
            "aliases": [
                "Newscaster Team",
                "Magic Hound",
                "G0059",
                "Phosphorus",
                "Mint Sandstorm",
                "TunnelVision",
                "COBALT MIRAGE"
            ],
            "source_name": "MISPGALAXY:APT35",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "04888f75-158b-47f9-8ad9-4ff83f618ece",
            "created_at": "2024-05-01T02:03:08.03763Z",
            "updated_at": "2025-03-27T02:05:17.319276Z",
            "deleted_at": null,
            "main_name": "COBALT MIRAGE",
            "aliases": [
                "Nemesis Kitten ",
                "PHOSPHORUS ",
                "TunnelVision ",
                "UNC2448 ",
                "DEV-0270 "
            ],
            "source_name": "Secureworks:COBALT MIRAGE",
            "tools": [
                " Custom powershell scripts",
                " DiskCryptor",
                " Drokbk",
                " FRPC",
                " Fast Reverse Proxy (FRP)",
                " Impacket wmiexec",
                " Ngrok",
                " Plink",
                " PowerLessCLR",
                " TunnelFish",
                "BitLocker"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ba5bc606-8b26-416a-881d-76cdefc6c75c",
            "created_at": "2024-06-04T02:03:07.777739Z",
            "updated_at": "2025-03-27T02:05:17.322164Z",
            "deleted_at": null,
            "main_name": "COBALT SAPLING",
            "aliases": [
                "Moses Staff",
                "Abraham's Ax"
            ],
            "source_name": "Secureworks:COBALT SAPLING",
            "tools": [
                " PyDcrypt",
                " StrifeWater RAT",
                "DCSrv"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bef06c82-0f51-44ba-8451-049cd4ad8a52",
            "created_at": "2023-01-06T13:46:39.325635Z",
            "updated_at": "2025-03-27T02:00:03.05159Z",
            "deleted_at": null,
            "main_name": "MosesStaff",
            "aliases": [
                "Moses Staff",
                "Marigold Sandstorm",
                "DEV-0500"
            ],
            "source_name": "MISPGALAXY:MosesStaff",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c4d0e4e1-5ad3-4455-8291-ce72a1e09e46",
            "created_at": "2022-10-27T08:27:13.055675Z",
            "updated_at": "2025-03-27T02:00:55.458634Z",
            "deleted_at": null,
            "main_name": "Moses Staff",
            "aliases": [
                "Moses Staff",
                "DEV-0500",
                "Marigold Sandstorm"
            ],
            "source_name": "MITRE:Moses Staff",
            "tools": [
                "PyDCrypt",
                "PsExec",
                "DCSrv",
                "StrifeWater"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e3676dfe-3d40-4b3a-bfbd-4fc1f8c896f4",
            "created_at": "2022-10-25T15:50:23.808974Z",
            "updated_at": "2025-03-27T02:00:55.550912Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "Magic Hound",
                "TA453",
                "COBALT ILLUSION",
                "Charming Kitten",
                "ITG18",
                "Phosphorus",
                "APT35",
                "Mint Sandstorm"
            ],
            "source_name": "MITRE:Magic Hound",
            "tools": [
                "Impacket",
                "CharmPower",
                "FRP",
                "Mimikatz",
                "Systeminfo",
                "ipconfig",
                "netsh",
                "PowerLess",
                "Pupy",
                "DownPaper",
                "PsExec",
                "Havij",
                "sqlmap"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1699fb41-b83f-42ff-a6ec-984ae4a1031f",
            "created_at": "2022-10-25T16:07:23.83826Z",
            "updated_at": "2025-03-27T02:02:09.995863Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "APT 35",
                "Ballistic Bobcat",
                "Charming Kitten",
                "CharmingCypress",
                "Cobalt Illusion",
                "Cobalt Mirage",
                "Educated Manticore",
                "Magic Hound",
                "Mint Sandstorm",
                "Operation BadBlood",
                "Operation Sponsoring Access",
                "Operation SpoofedScholars",
                "Operation Thamar Reservoir",
                "Phosphorus",
                "TA453",
                "TEMP.Beanie",
                "Tarh Andishan",
                "Timberworm",
                "TunnelVision",
                "UNC788",
                "Yellow Garuda"
            ],
            "source_name": "ETDA:Magic Hound",
            "tools": [
                "7-Zip",
                "AnvilEcho",
                "BASICSTAR",
                "CORRUPT KITTEN",
                "CWoolger",
                "CharmPower",
                "ChromeHistoryView",
                "CommandCam",
                "DistTrack",
                "DownPaper",
                "FRP",
                "Fast Reverse Proxy",
                "FireMalv",
                "Ghambar",
                "GoProxy",
                "GorjolEcho",
                "HYPERSCRAPE",
                "Havij",
                "MPK",
                "MPKBot",
                "Matryoshka",
                "Matryoshka RAT",
                "MediaPl",
                "Mimikatz",
                "MischiefTut",
                "NETWoolger",
                "NOKNOK",
                "PINEFLOWER",
                "POWERSTAR",
                "PowerLess Backdoor",
                "PsList",
                "Pupy",
                "PupyRAT",
                "SNAILPROXY",
                "Shamoon",
                "TDTESS",
                "WinRAR",
                "WoolenLogger",
                "Woolger",
                "pupy",
                "sqlmap"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535960,
    "ts_updated_at": 1743041771,
    "ts_creation_date": 1653697959,
    "ts_modification_date": 1653697959,
    "files": {
        "pdf": "https://archive.orkl.eu/b02c032f90dea590dc80ef2defc1adbb6b47b7d1.pdf",
        "text": "https://archive.orkl.eu/b02c032f90dea590dc80ef2defc1adbb6b47b7d1.txt",
        "img": "https://archive.orkl.eu/b02c032f90dea590dc80ef2defc1adbb6b47b7d1.jpg"
    }
}