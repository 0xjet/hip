{
    "id": "120929e4-edd8-41b6-a8ac-1d6771a97e02",
    "created_at": "2022-10-25T16:48:21.405365Z",
    "updated_at": "2025-03-27T02:11:00.246111Z",
    "deleted_at": null,
    "sha1_hash": "86b8c909afd63ec436249037400dd59428798f1d",
    "title": "Massive Admedia/Adverting iFrame Infection - Sucuri Blog",
    "authors": "",
    "file_creation_date": "2016-02-15T10:44:01Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 538849,
    "plain_text": "**[SUCURISUCURI](http://sucuri.net/)** **[ENGLISHENGLISH](https://blog.sucuri.net)** **[ESPAÑOLESPAÑOL](https://blog.sucuri.net/espanol/)** **[PORTUGUÊSPORTUGUÊS](https://blog.sucuri.net/portugues/)** **[WEBSITE ANTIVIRUSWEBSITE ANTIVIRUS](http://affl.sucuri.net/?affl=5f37c2f361ef3b1ddadae7d6627427e1&trid=sucurienglish&signup=http://sucuri.net/website-antivirus/signup)** **[WEBSITE FIREWALLWEBSITE FIREWALL](http://affl.sucuri.net/?affl=5f37c2f361ef3b1ddadae7d6627427e1&trid=sucurienglish&cpsignup=http://sucuri.net/website-firewall/signup)**\n\n# Massive Admedia/Adverting iFrame Infection\n\n**[By Denis Sinegubko on February 1, 2016 .](https://blog.sucuri.net/author/denis/)** **31 Comments**\n\n**This past weekend we registered a spike in WordPress infections where hackers injected**\n**encrypted code at the end of all legitimate .js files.**\n\n\n-----\n\n**Encrypted admedia code (shortened version).**\n\n**The distinguishing features of this malware are:**\n\n**1. 32 hex digit comments at the beginning and end of the malicious code.**\n\n**E.g. /*e8def60c62ec31519121bfdb43fa078f*/ This comment is unique on every**\n**infected site. Most likely an MD5 hash based on the domain name.**\n**2. The first comment is immediately followed by ;window[“\\x64\\x6f…. and a long array of**\n\n**string constants in their hexadecimal representation.**\n**3. It always ends with “.join(\\”\\”);”));“**\n\n**The encrypted part mutates from site to site, but once decrypted it always looks like this:**\n\n\n-----\n\n**Decoded admedia script**\n\n**This malware only infects first time visitors, it sets the ad-cookie cookie (er2vdr5gdc3ds)**\n**that expires in 24 hours and injects an invisible iframe.**\n\n# IFrame URL – Admedia / Adverting\n\n**The URL of the iFrames is the only changing part of the code.**\n\n**hxxp://template.poln1uewt1aniwki[.]ws/admedia/?**\n**id=8695834&keyword=85c86e3646fb1b15c0bc0647c257c029&ad_id=Twiue123**\n\n**hxxp://js.polnue2wtani2wki[.]ws/admedia/?**\n**id=8695834&keyword=396f3d9d490aed315d71b60ec1efda53&ad_id=Twiue123**\n\n**hxxp://get.malenkiuniger[.]net/admedia/?**\n**id=8695834&keyword=8580b2135c1fdc0c650156eb174b4985&ad_id=Twiue123**\n\n**hxxp://track.findyourwaytotr[.]net/admedia/?**\n**id=8695834&keyword=46731f99a65ceac12e0632d08e551ca5&ad_id=Twiue123**\n\n**hxxp://img.oduvanchiksawa[.]biz/adverting/?**\n**id=5345896&keyword=fd2f2243cd2046d674aeec495cd2e74b&uyijo=86tyh978**\n\n**It’s easy to spot a pattern in these URLs:**\n\n**Third level domains**\n\n**Ad** **di** **d** **ti i** **i** **th** **th** **t** **f th** **URL (** **ll d thi** **l**\n\n\n-----\n\n**The same structure of URL parameter, including ad_id which is always the same –**\n**Twiue123.**\n\n# Malicious Domains\n\n**The use of the third level domains is typical for “domain shadowing.” This involves adding**\n**malicious subdomains on legitimate second level domains after gaining access to DNS**\n**records. In this case we deal with a domain registered specifically for this attack.**\n\n**WHOIS records show that they all had been registered by “Vasunya” at valera.valera-146 @**\n**yandex.ru within the last two months:**\n\n**poln1uewt1aniwki[.]ws – created on Dec 22, 2015**\n\n**findyourwaytotr[.]net – created on Jan 8, 2016**\n\n**oduvanchiksawa[.]biz – created on Feb 1, 2016**\n\n**malenkiuniger[.]net – created on Feb 1, 2016**\n\n**The last one was created Feb 1st,** **probably to work around blacklisting of the other domains.**\n**Nonetheless, Google has already blacklisted it as**\n**well: https://www.google.com/transparencyreport/safebrowsing/diagnostic/?**\n**#url=malenkiuniger.org**\n\n# Digital Ocean\n\n**It is worth mentioning that all the malicious domains and subdomains point to servers**\n**to Digital Ocean’s network: 46.101.84.214, 178.62.37.217, 178.62.37.131, 178.62.90.65**\n\n**It’s not common to see malware hosted there, so it’s not a surprise to see Google listing only**\n**domains related to this attack as examples of known dangerous site on the AS202109**\n**(DIGITALOCEAN-ASN-2) network.**\n\n# Previous Version of the Malware\n\n**In the screenshot below you can see the gabosik12345[.]ws domain that I didn’t mention**\n**above. This domain was registered by the same “Vasunya” on December 23, 2015. It was**\n**used in the previous incarnation of this attack along with some other domains registered last**\n**fall: trymyfinger[.]website, goroda235[.]pw, suchka46[.]pw, etc.**\n\n\n-----\n\n**SafeBrowsing report for AS202109 (DIGITALOCEAN-ASN-2)**\n\n**[We still detect quite a few sites infected with the last fall’s malware variation:](https://sitecheck.sucuri.net/)**\n\n**SiteCheck reports malware in a .js file**\n\n**It also injected similar JavaScript code at the bottom of .js files and also used the ad-**\n**cookie=”er2vdr5gdc3ds” cookie, but the iframe URLs were slightly different,**\n**e.g. hxxp://static.suchka46[.]pw/?id=6947627&keyword=557334&ad_id=Xn5be4 .**\n\n\n-----\n\n**This malware uploads multiple backdoors into various locations on the webserver and**\n**frequently updates the injected code. This is why many webmasters are experiencing**\n**constant reinfections post-cleanup of their .js files.**\n\n**The malware tries to infect all accessible .js files. This means that if you host several domains**\n**on the same hosting account all of them will be infected via a concept known as cross-site**\n**contamination. It’s not enough to clean just one site (e.g. the one you care about) or all but**\n**one (e.g. you don’t care about a test or backup site) in such situations – an abandoned site**\n**[will be the source of the reinfection. In other words, you either need to isolate every sites or](https://blog.sucuri.net/2015/03/why-website-reinfections-happen.html)**\n**clean/update/protect all of them at the same time!**\n\n**[filed under: website security, wordpress security](https://blog.sucuri.net/category/website-security/)** **[tagged with: iframe, javascript, digitalocean, encoded,](https://blog.sucuri.net/tag/iframe/)**\n**[admedia, adverting](https://blog.sucuri.net/tag/admedia/)**\n\n\n**About Denis Sinegubko**\n**Denis is the founder of Unmask Parasites and a Senior Malware Researcher at Sucuri.**\n**[Follow him on Twitter at @unmaskparasites.](https://twitter.com/unmaskparasites)**\n\n|Blog Search|Col2|\n|---|---|\n||Search|\n|Search this website …||\n|||\n\n\n**We love to socialize, let’s connect..**\n\n**[�](https://www.facebook.com/SucuriSecurity)** **[�](http://www.linkedin.com/company/sucuri-security)** **[�](http://feeds.feedburner.com/sucuri/blog)** **[�](http://twitter.com/sucurisecurity)** **[�](http://youtube.com/SucuriSec)**\n\n\n###### Join 20,000 Subscribers!!\n\n##### * indicates required\n**Email Address**\n\n## *\n\n**First Name**\n\n\n-----\n\n**Categories**\n\n**[Ask Sucuri](https://blog.sucuri.net/category/ask/)**\n\n**[ddos](https://blog.sucuri.net/category/ddos/)**\n\n**[Drupal](https://blog.sucuri.net/category/other-cms-security/drupal/)**\n\n**[Ecommerce Security](https://blog.sucuri.net/category/website-security/ecommerce-security/)**\n\n**[godaddy](https://blog.sucuri.net/category/godaddy/)**\n\n**[htaccess](https://blog.sucuri.net/category/htaccess/)**\n\n**[Joomla! Security](https://blog.sucuri.net/category/joomla-security/)**\n\n**[Learn](https://blog.sucuri.net/category/ask/learn/)**\n\n**[Linux Server](https://blog.sucuri.net/category/linux-server/)**\n\n**[Magento Security](https://blog.sucuri.net/category/other-cms-security/magento-security/)**\n\n**[malware_updates](https://blog.sucuri.net/category/malware_updates/)**\n\n**[Modx Security](https://blog.sucuri.net/category/other-cms-security/modx-security/)**\n\n**[OpenX Security](https://blog.sucuri.net/category/other-cms-security/openx-security/)**\n\n\n-----\n\n**[ossec](https://blog.sucuri.net/category/ossec/)**\n\n**[Other CMS Security](https://blog.sucuri.net/category/other-cms-security/)**\n\n**[PCI DSS](https://blog.sucuri.net/category/website-security/pci-dss-website-security/)**\n\n**[pharma](https://blog.sucuri.net/category/pharma/)**\n\n**[Presentation](https://blog.sucuri.net/category/ask/presentation/)**\n\n**[Product Update](https://blog.sucuri.net/category/product-update/)**\n\n**[Ruby on Rails Security](https://blog.sucuri.net/category/other-cms-security/ruby-on-rails-security/)**\n\n**[SEO Spam](https://blog.sucuri.net/category/website-infections/website-spam/seo-spam/)**\n\n**[Server Security](https://blog.sucuri.net/category/server-security/)**\n\n**[SiteCheck](https://blog.sucuri.net/category/product-update/sitecheck/)**\n\n**[sucuri](https://blog.sucuri.net/category/sucuri/)**\n\n**[Uncategorized](https://blog.sucuri.net/category/uncategorized/)**\n\n**[vBulletin Security](https://blog.sucuri.net/category/other-cms-security/vbulletin-security/)**\n\n**[vulnerability](https://blog.sucuri.net/category/vulnerability/)**\n\n**[Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure/)**\n\n**[Webserver Infections](https://blog.sucuri.net/category/website-infections/webserver-infections/)**\n\n**[Website Attacks](https://blog.sucuri.net/category/website-security/website-attacks/)**\n\n**[Website Auditing](https://blog.sucuri.net/category/website-security/website-auditing/)**\n\n**[Website Backdoor](https://blog.sucuri.net/category/website-infections/website-backdoor/)**\n\n**[Website Backup](https://blog.sucuri.net/category/website-security/website-backup/)**\n\n**[Website Blacklist](https://blog.sucuri.net/category/website-infections/blacklisted/)**\n\n**[Website Defacement](https://blog.sucuri.net/category/website-infections/website-defacement/)**\n\n**[Website Firewall](https://blog.sucuri.net/category/website-firewall/)**\n\n**[Website Hacked](https://blog.sucuri.net/category/website-infections/hacked/)**\n\n**[Website Infection[s]](https://blog.sucuri.net/category/website-infections/)**\n\n\n-----\n\n**[Website Security](https://blog.sucuri.net/category/website-security/)**\n\n**[Website Spam](https://blog.sucuri.net/category/website-infections/website-spam/)**\n\n**[woocommerce](https://blog.sucuri.net/category/woocommerce/)**\n\n**[WordPress Security](https://blog.sucuri.net/category/wordpress-security/)**\n\n**[WordPress Security Plugin](https://blog.sucuri.net/category/product-update/wordpress-security-plugin/)**\n\n**[Zencart Security](https://blog.sucuri.net/category/other-cms-security/zencart-security/)**\n\n**People are Talking:**\n\n**[Mohammad Javed on Fake SUPEE-5344 Patch Steals Payment Details](http://www.mjcoder.co.uk)**\n\n**[disciple2819 on The Hidden Backdoors to the City of Cron](https://blog.sucuri.net/2014/01/the-hidden-backdoors-to-the-city-of-cron.html/comment-page-1/#comment-7335)**\n\n**[Rafael Corrêa Gomes ♛ on Fake SUPEE-5344 Patch Steals Payment Details](http://rafaelstz.github.io)**\n\n**[William LA on Massive Admedia/Adverting iFrame Infection](http://william.solutions)**\n\n**[Todd on Malicious Google Analytics Referral Spam](https://wireflare.com/)**\n\n**[Peter Kulcsár on Massive Admedia/Adverting iFrame Infection](https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html/comment-page-1/#comment-7331)**\n\n**[Piet on Malicious Google Analytics Referral Spam](http://senlinonline.com/)**\n\n**[Namit Mhatre on Massive Admedia/Adverting iFrame Infection](https://blog.sucuri.net/2016/02/massive-admedia-iframe-javascript-infection.html/comment-page-1/#comment-7329)**\n\n**[Todd on Malicious Google Analytics Referral Spam](https://wireflare.com/)**\n\n**[Piet on Malicious Google Analytics Referral Spam](http://senlinonline.com/)**\n\n###### Recent PostsRecent Posts\n\n**[Fake SUPEE-5344 Patch Steals Payment Details](https://blog.sucuri.net/2016/02/fake-supee-5344-patch-steals-payment-details.html)**\n\n**[Seo-moz.com SEO Spam Campaign](https://blog.sucuri.net/2016/02/seo-moz-com-seo-spam-campaign.html)**\n\n**[Magento PCI Compliance Issues and Theft Over TLS](https://blog.sucuri.net/2016/02/theft-over-tls-or-illusion-of-pci-compliance.html)**\n\n**[Server Security: Import WordPress Events to OSSEC](https://blog.sucuri.net/2016/02/server-security-adding-wordpress-visibility-into-ossec.html)**\n\n\n-----\n\n**[The Risks of Hiring a Bad SEO Company](https://blog.sucuri.net/2016/01/hiring-the-wrong-seo-company.html)**\n\n**[Security Advisory: Stored XSS in Magento](https://blog.sucuri.net/2016/01/security-advisory-stored-xss-in-magento.html)**\n\n###### TagsTags\n\n**[apache](https://blog.sucuri.net/tag/apache/)** **[Ask Sucuri](https://blog.sucuri.net/tag/ask/)** **[awareness](https://blog.sucuri.net/tag/awareness/)** **[backdoor](https://blog.sucuri.net/tag/backdoor/)** **[best practices](https://blog.sucuri.net/tag/best-practices/)** **[brute force](https://blog.sucuri.net/tag/brute-force/)** **[cloudproxy](https://blog.sucuri.net/tag/cloudproxy/)** **[conditional](https://blog.sucuri.net/tag/conditional/)** **[ddos](https://blog.sucuri.net/tag/ddos/)** **drive-by-**\n\n**download** **[godaddy](https://blog.sucuri.net/tag/godaddy/)** **[google](https://blog.sucuri.net/tag/google/)** **[htaccess](https://blog.sucuri.net/tag/htaccess/)** **[iframe](https://blog.sucuri.net/tag/iframe/)** **[iis](https://blog.sucuri.net/tag/iis/)** **[JavaScript](https://blog.sucuri.net/tag/javascript-2/)** **[Joomla! Security](https://blog.sucuri.net/tag/joomla-security/)** **[linux](https://blog.sucuri.net/tag/linux/)** **[malvertising](https://blog.sucuri.net/tag/malvertising/)**\n### malware_updates osCommerce Security passwords pharma phishing php redirect research\n\n**[scan](https://blog.sucuri.net/tag/scan/)** **[seo](https://blog.sucuri.net/tag/seo/)** **[sucuri](https://blog.sucuri.net/tag/sucuri/)** **[updates](https://blog.sucuri.net/tag/updates/)** **[vBulletin Security](https://blog.sucuri.net/tag/vbulletin-security/)** **[vulnerability](https://blog.sucuri.net/tag/vulnerability/)** **[waf](https://blog.sucuri.net/tag/waf/)** **[Website Backdoor](https://blog.sucuri.net/tag/website-backdoor/)** **Website**\n\n###### Blacklist Website Blacklist 2 Website Hacked Website Malware\n## Website Security Website Spam wordpress WordPress Security\n\n**[WordPress Security Plugin](https://blog.sucuri.net/tag/wordpress-security-plugin/)** **[xss](https://blog.sucuri.net/tag/xss/)**\n\n###### BookmarksBookmarks\n\n**[Has Google Blacklisted Your Website?](https://sucuri.net/website-security/google-blacklisted-my-website)**\n\n**[Is your website infected? Hacked?](https://sucuri.net/website-antivirus/malware-removal)**\n\n**[Learn more about WordPress Security?](https://sucuri.net/wordpress-security/)**\n\n**[Monitor WordPress for Security Issues?](https://sucuri.net/wordpress-security/wordpress-security-monitoring)**\n\n**[Need more info on PCI Compliance?](https://sucuri.net/website-firewall/pci-compliance)**\n\n**[Website under a DDoS Attack?](https://sucuri.net/website-firewall/ddos-protection)**\n\n**[Worried about Software Vulnerabilities?](https://sucuri.net/website-firewall/stop-website-attacks-and-hacks)**\n\n**[Copyright © 2016 Sucuri Inc. · Terms of Service · Privacy Policy](http://sucuri.net)**\n**Sucuri® is a registered trademark of Sucuri Inc. in the United States and/or other countries.**\n\n**Return to top of page**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.02.01.Massive_Admedia_Adverting_iFrame_Infection/massive-admedia-iframe-javascript-infection.html.pdf"
    ],
    "report_names": [
        "massive-admedia-iframe-javascript-infection.html"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3fad11c6-4336-4b28-a606-f510eca5452e",
            "created_at": "2022-10-25T16:07:24.346573Z",
            "updated_at": "2025-03-27T02:02:10.183211Z",
            "deleted_at": null,
            "main_name": "Turbine Panda",
            "aliases": [
                "APT 26",
                "Black Vine",
                "Bronze Express",
                "Group 13",
                "JerseyMikes",
                "KungFu Kittens",
                "PinkPanther",
                "Shell Crew",
                "Turbine Panda",
                "WebMasters"
            ],
            "source_name": "ETDA:Turbine Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Hurix",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mivast",
                "PlugX",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Sakula",
                "Sakula RAT",
                "Sakurel",
                "Sogu",
                "StreamEx",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "cobeacon",
                "ffrat"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "64ca1755-3883-4173-8e0a-6e5cf92faafd",
            "created_at": "2022-10-25T15:50:23.636456Z",
            "updated_at": "2025-03-27T02:00:55.51077Z",
            "deleted_at": null,
            "main_name": "Deep Panda",
            "aliases": [
                "Deep Panda",
                "Shell Crew",
                "KungFu Kittens",
                "PinkPanther",
                "Black Vine"
            ],
            "source_name": "MITRE:Deep Panda",
            "tools": [
                "Mivast",
                "StreamEx",
                "Sakula",
                "Tasklist",
                "Derusbi"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716501,
    "ts_updated_at": 1743041460,
    "ts_creation_date": 1455533041,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/86b8c909afd63ec436249037400dd59428798f1d.pdf",
        "text": "https://archive.orkl.eu/86b8c909afd63ec436249037400dd59428798f1d.txt",
        "img": "https://archive.orkl.eu/86b8c909afd63ec436249037400dd59428798f1d.jpg"
    }
}