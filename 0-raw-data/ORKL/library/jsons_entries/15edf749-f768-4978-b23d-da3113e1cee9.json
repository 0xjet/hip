{
    "id": "15edf749-f768-4978-b23d-da3113e1cee9",
    "created_at": "2023-05-06T02:08:09.220272Z",
    "updated_at": "2025-03-27T02:09:18.025238Z",
    "deleted_at": null,
    "sha1_hash": "e5702e8ee20126aaf8e98976bce605689f0f0ad0",
    "title": "2023-03-30 - X-Force Prevents Zero Day from Going Anywhere",
    "authors": "",
    "file_creation_date": "2023-05-05T01:46:53Z",
    "file_modification_date": "2023-05-05T01:46:53Z",
    "file_size": 3336711,
    "plain_text": "# X-Force Prevents Zero Day from Going Anywhere\n\n**[securityintelligence.com/posts/x-force-prevents-zero-day-from-going-anywhere](https://securityintelligence.com/posts/x-force-prevents-zero-day-from-going-anywhere)**\n\n[Software Vulnerabilities\nMarch 30, 2023](https://securityintelligence.com/category/x-force/software-vulnerabilities/)\nBy [John Dwyer\n8 min read](https://securityintelligence.com/author/john-dwyer/)\n_This blog was made possible through contributions from Fred Chidsey and Joseph Lozowski._\n\nThe 2023 X-Force Threat Intelligence Index shows that vulnerability discovery has rapidly\nincreased year-over-year and according to X-Force’s cumulative vulnerability and exploit\ndatabase, only 3% of vulnerabilities are associated with a zero day. X-Force often observes\nzero-day exploitation on Internet-facing systems as a vector for initial access however, XForce has also observed zero-day attacks leveraged by attackers to accomplish their goals\nand objectives after initial access was obtained.\n\nIn this post, X-Force will detail an investigation associated with a zero-day attack that\noccurred less than 24 hours after the release of the zero day — one of the fastest adoption\ntimes for financially motivated cybercriminals identified by X-Force since 2020. This incident\n[is connected to a recent mass ransomware attack, which takes advantage of a vulnerability](https://www.bankinfosecurity.com/clop-goanywhere-attacks-have-now-hit-130-organizations-a-21526)\nin Forta’s file-transfer tool, GoAnyWhere.\n\nThis blog will also explore the relationship between ransomware attack paths and the\nadoption of zero days by cybercriminals: by analyzing the most commonly used zero-day\nexploits by cybercriminals observed by X-Force over the last three years, we’ve found that\nthe ransomware attack lifecycle is a key driver behind zero-day adoption for cyber criminals.\n\n\n-----\n\n## GoAnyWhere But Laterally\n\nIn February 2023, X-Force responded to an incident where a client had received alerts from\ntheir security tooling regarding potential lateral movement originating from a server within\ntheir network. The client’s security team discovered an authorized user account operating on\na GoAnyWhere MFT server. Through analysis of existing security telemetry and forensic\nevidence, X-Force identified evidence of post-exploitation activity and exploitation of CVE2023-0669 on the GoAnyWhere MFT server.\n\nX-Force uncovered exploitation of CVE-2023-0669 through timeline analysis indicating a\ncommon post-exploitation command to download a file from a remote IP address was\nexecuted on the GoAnyWhere server at the same time a GoAnyWhere license error log was\nwritten referencing the same remote IP address. Upon first exploitation, the attacker\nattempted to download and execute a malicious payload which would have established a\ncommand and control (C2) channel via a Cobalt Strike but the security tooling on the\nGoAnyWhere server detected and removed the malicious payload. X-Force recovered\nsimilar evidence indicating that the attacker attempted to execute Mimikatz through the\nexploitation of the vulnerability and was prevented.\n\nWith security tooling blocking the execution of remote post-exploitation commands, the\nattacker pivoted to interactive access via remote desktop protocol (RDP) by leveraging the\nvulnerability to create a new user account and then accessing the server via RDP. With\ninteractive access to the server via RDP, the attacker continued with credential harvesting\noperations by accessing credential data using Task Manager to dump the contents of the\nLSASS process.\n\nFollowing the credential harvesting operations, the attacker began internal reconnaissance\nfocusing on Active Directory using CSVDE and scanning for accessible SMB shares.\nComma Separated Value Directory Exchange (CSVDE) is Microsoft Windows utility that\nenables the user to import and export objects into or from Active Directory.\n\nThe attacker pivoted C2 channels by uploading a web shell to the GoAnyWhere server and\nbegan executing point-exploitation commands focused on reconnaissance and user account\ncreation. When the web shell was detected and contained, the attacker returned to the\nserver through RDP and performed more credential harvesting activities and leveraged\nSharpHound to perform additional Active Directory data collections. SharpHound is a\ncomponent of BloodHound which is an Active Directory reconnaissance tool designed to\nenumerate and analyze Active Directory relationships and attack paths.\n\nWith an understanding of the attacker’s access and scope of the incident in place,\ncontainment actions were taken to remove the attack from the network completely. Further\nintelligence gathering of the data collected from the incident indicates that the attacker was a\nfinancially motivated attacker focused on ransomware attacks to extort payment.\n\n\n-----\n\n## Detecting CVE-2023-0669\n\nCVE-2023-0669 is a remote code injection vulnerability impacting Fortra’s GoAnyWhere MFT\nfile transfer software. The vulnerability enables a remote attacker with access to the\nadministrative console to inject pre-authentication commands in the License Response\nServlet. Exploitation of CVE-2023-0669 occurs when a remote attacker sends a specially\ncrafted request to the URI “/goanywhere/lic/accept” to take advantage of an insecure\ndeserialization flaw in the License Response Servlet class. Due to the use of hard-coded\nkeys within the source code of the GoAnyWhere functions, a remote attacker can encrypt\nand encode arbitrary commands for execution on the target system within the Bundle\nparameter which is processed by the License Server Servlet without authentication. It is\nimportant to note that this exploit requires that the administrative interface for the\nGoAnyWhere server is accessible to the attacker. At the time of writing this post, X-Force\ndetected over 700 GoAnyWhere servers available on the Internet with nearly 100\nGoAnyWhere servers with the default license management ports exposed.\n\n\n-----\n\nAs detailed by security researcher, [frycos, a payload to exploit the vulnerability can be](https://frycos.github.io/vulns4free/2023/02/06/goanywhere-forgotten.html)\n[created using ysoserial and the hardcoded secret keys. Ysoserial, created by frohoff, is a](https://github.com/frohoff/ysoserial)\ncollection of utilities discovered in common java libraries that can exploit Java applications\nvulnerable to unsafe deserialization of objects.\n\n\n-----\n\n### Detection Opportunity Via Process Execution\n\nInvoking Process = <GoAnyWhereInstallDir>/GoAnywhere/jre/bin/java\n\nProcess Name = command interpreters or LOLBins (cmd.exe, powershell.exe, certutil.exe,\nwmic.exe, whoami.exe, python, perl, bash, whoami, etc.)\n\n### Detection Opportunity Via Log Monitoring\n\nLog file = %GoAnyWhereInstallDir%\\userdata\\logs\\goanywhere.log\n\nString Match = “request URI ‘/goanywhere/lic/accept/’ from ip address” AND “HTTP status\ncode is ‘500’”\n\n### Detection Opportunity Via Network Traffic\n\nPOST or GET to URI “<MFTServer>/goanywhere/lic/accept?bundle=” and URI contains\n“bundle=” FROM Untrusted Hosts\n\n## Threat Driven Approach to Zero Days\n\n\n-----\n\nDuring this incident, the time between the security advisory and the exploitation of CVE2023-0669 was less than 1 day making it one of the fastest adoption time frames by finically\nmotivated attackers observed by X-Force since 2020. The X-Force Vulnerability and Exploit\nDatabase, which has been curating vulnerability and exploit data since 1993 shows that the\nnumber of zero days released is increasing year over year, but X-Force observes just a\nhandful of zero days rapidly adopted by cyber criminals each year. It begs to question, “why\nare some zero days rapidly and widely adopted for criminal operations and others not?”.\nBased on the data from the X-Force database and incident response engagements, it\nappears that that not every zero day is created equal. While every zero day is important and\norganizations should still devote efforts to patching zero days once a patch is released, there\nare characteristics of certain zero days that make them more likely to be rapidly and widely\nadopted by cyber criminals.\n\nThe following CVEs were the most rapidly and widely adopted zero days by cyber criminals\nobserved by X-Force since 2020:\n\nCVE-2020-1472 (ZeroLogon)\nCVE-2021-26855 (ProxyLogon)\nCVE-2021-34473, CVE-2021-34523, CVE-2021-31207 (ProxyShell)\nCVE-2021-34527 (PrintNightmare)\nCVE-2022-26925 (PetitPotam)\nCVE-2023-0669 (GoAnyWhere)\n\n[In 2021 X-Force released a blog detailing “How Ransomware Attacks Happen” and it turns](https://securityintelligence.com/posts/how-ransomware-attacks-happen/)\nout that the attack path detailed in that post has a direct relationship with zero day adoption\nby cyber criminals. Analyzing the most widely used zero days, what an attacker can achieve\nthrough exploitation, and the incidents in which they were used, indicates that the zero days\nthat enable ransomware operators to quickly and easily obtain their goals and objectives are\nmore likely to be used “in the wild”.\n\nZeroLogon — Allows an unauthenticated attacker with network access to a domain controller\nto exploit a NetLogon session and gain domain administrator privilege.\n\nPrintNightmare — Is a vulnerability affecting the Windows Print Spooler service that enables\nan attacker to escalate privileges either locally or remotely by loading a malicious DLL which\nwill be executed as SYSTEM.\n\nPetitPotam — Is a NTLM relay attack that allows a remote, unauthenticated attacker to take\ncontrol of an Active Directory domain by triggering a domain controller to relay its credentials\nto a system controlled by the attacker. With the domain controller NTLM credentials, the\nattacker can relay them to Active Directory Certificate Services (AD CS) to obtain a DC\ncertificate. The attacker can use the DC certificate request a TGT (Ticket Granting Ticket)\nand take control of the entire domain through Pass-The-Ticket attacks.\n\n\n-----\n\nBecause ZeroLogon, PrintNightmare, and PetitPotam allow an attacker to obtain privileged\naccess to Active Directory without credential harvesting or lateral movement, it significantly\nsimplifies the ransomware attack path and as such X-Force observed their use on multiple\nransomware attacks.\n\nProxyShell and ProxyLogon are vulnerabilities that affect on-premises Microsoft Exchange\nthat enable a remote attacker to elevate privileges and execute arbitrary commands on\nvulnerable servers. Microsoft Exchange is an attractive target for attackers because they\nhost business email which can enable internal phishing as well as but also given the tight\nintegration between Exchange and Active Directory, it can also be exploited to move laterally\n[to other high-value systems or access privileged account credentials. According to Microsoft,](https://www.microsoft.com/en-us/security/blog/2020/06/24/defending-exchange-servers-under-attack/)\n“If compromised, Exchange servers provide a unique environment that could allow attackers\nto perform various tasks using the same built-in tools or scripts that admins use for\nmaintenance.”\n\nX-Force has observed ProxyShell and ProxyLogon leveraged in multiple ransomware attacks\nwhere the attacker was able to obtain domain administrator privileges, exfiltrate sensitive\nbusiness data, and deploy ransomware directly from the Exchange servers.\n\nRegarding GoAnyWhere, X-Force’s observations are that the servers that are exploited tend\nto be domain-joined Microsoft Windows system that enable the attacker to immediately\nobtain an opportunity to gain access to high-value systems within Active Directory.\n\nA notable absentee from the widely adopted zero-day list was Log4J. While Log4J gained\nwidespread media attention, X-Force did not respond to many serious finically motivated\nincidents where Log4J was exploited. It is possible that organizations did a heroic job of\npatching vulnerable systems, however, given the number of systems still vulnerable to CVE2021-44228 it appears that cyber criminals have not adopted it as widely for another reason.\nOne interesting data point that may explain why Log4J has not been observed in as many\nincident response engagements is that based on X-Force vulnerability data, the majority of\nvulnerable Log4J systems are running Linux. Pivoting from Linux to Microsoft Active\nDirectory requires more knowledge, capabilities and falls outside of the normal ransomware\nattack lifecycle further indicating that the ransomware attack lifecycle is driving zero-day\nadoption for cyber criminals.\n\n## A Path Forward: Understanding the Attackers\n\nThe path forward for zero-day preparation and management requires organizations adopt a\nthreat driven approach. It’s critical that organizations understand which attackers are most\nlikely going to target them, what the attackers’ goals and objectives are, and how the\nattackers going about accomplishing them. With this knowledge, organizations will be better\nprepared to identify which vulnerabilities and zero days are most likely going to be adopted.\nBut prevention alone is no longer enough. It’s equally important today to focus on detection\n\n\n-----\n\nengineering – finding new ways to lengthen attack lifecycles and making it harder for threat\nactors to execute their objectives. By improving detection and response capabilities,\nbusinesses can make it more difficult for attackers to complete their goals even if they are\nable to gain access through vulnerability exploitation.\n\n## IBM X-Force\n\nIf you are interested in learning more about detection and response, vulnerability\nmanagement, or threat hunting, X-Force provides world class proactive and reactive services\nto ensure your organization achieves complete preparedness for zero-day attacks. To learn\nhow IBM X-Force can help you with anything regarding cybersecurity including incident\nresponse, threat intelligence, or offensive security services schedule a follow up meeting\nhere:\n\n[IBM X-Force Scheduler](https://www.ibm.com/security/services/incident-response-services?schedulerform)\n\nIf you are experiencing cybersecurity issues or an incident, contact X-Force to help:\n\nUS hotline 1-888-241-9812 Global hotline (+001) 312-212-8034.\n\n[Endpoint\n |](https://securityintelligence.com/category/topics/incident-response/) [Incident Response](https://securityintelligence.com/category/topics/incident-response/)\n[John Dwyer](https://securityintelligence.com/author/john-dwyer/)\nHead of Research, IBM Security X-Force\n\nJohn (@TactiKoolSec) is the Head of Research for the IBM Security X-Force where he leads\nresearch efforts to understand and model adversary operations, devel...\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-30 - X-Force Prevents Zero Day from Going Anywhere.pdf"
    ],
    "report_names": [
        "2023-03-30 - X-Force Prevents Zero Day from Going Anywhere.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1683338889,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1683251213,
    "ts_modification_date": 1683251213,
    "files": {
        "pdf": "https://archive.orkl.eu/e5702e8ee20126aaf8e98976bce605689f0f0ad0.pdf",
        "text": "https://archive.orkl.eu/e5702e8ee20126aaf8e98976bce605689f0f0ad0.txt",
        "img": "https://archive.orkl.eu/e5702e8ee20126aaf8e98976bce605689f0f0ad0.jpg"
    }
}