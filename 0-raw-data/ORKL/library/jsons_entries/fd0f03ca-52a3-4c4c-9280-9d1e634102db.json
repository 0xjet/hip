{
    "id": "fd0f03ca-52a3-4c4c-9280-9d1e634102db",
    "created_at": "2023-01-12T15:01:47.939265Z",
    "updated_at": "2025-03-27T02:06:15.222511Z",
    "deleted_at": null,
    "sha1_hash": "f880ca934aacdfc1cc939e0dfd1b8eb81c040a9d",
    "title": "2018-11-01 - Trickbot Shows Off New Trick- Password Grabber Module",
    "authors": "",
    "file_creation_date": "2022-05-28T15:17:45Z",
    "file_modification_date": "2022-05-28T15:17:45Z",
    "file_size": 162967,
    "plain_text": "# Trickbot Shows Off New Trick: Password Grabber Module\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/trickbot-shows-off-new-trick-password-grabber-module](https://blog.trendmicro.com/trendlabs-security-intelligence/trickbot-shows-off-new-trick-password-grabber-module)**\n\nNovember 1, 2018\n\nTrickbot, which used to be a simple banking trojan, has come a long way. Over time, we’ve\nseen how cybercriminals continue to add more features to this malware. Last March, Trickbot\n[added a new module that gave it increased detection evasion and a screen-locking feature.](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/evolving-trickbot-adds-detection-evasion-and-screen-locking-features)\nThis month, we saw that Trickbot (detected by Trend Micro as [TSPY_TRICKBOT.THOIBEAI)](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/TSPY_TRICKBOT.THOIBEAI)\nnow has a password grabber module (pwgrab32) that steals access from several\napplications and browsers, such as Microsoft Outlook, Filezilla, WinSCP, Google Chrome,\nMozilla Firefox, Internet Explorer, and Microsoft Edge. Based on our telemetry, we saw that\nthis Trickbot variant has affected users mainly in the United States, Canada, and the\nPhilippines.\n\n**Analyzing Trickbot’s modules**\n\nMalware authors continue to cash in on Trickbot’s modular structure — its ability to\ncontinually update itself by downloading new modules from a C&C server and change its\nconfiguration make for a malware that’s ripe for updating. To gain a better understanding of\nthis threat, we analyzed Trickbot’s different modules, starting with the new pwgrab32 module\nthat we saw this month.\n\n**_pwgrab32 module_**\n\n\n-----\n\nTrickbot s new module, called pwgrab32 or PasswordGrabber, steals credentials from\napplications such as Filezilla, Microsoft Outlook, and WinSCP.\n\nFigure 1. A screen capture of Trickbot’s new module, pwgrab32, in an affected system\n\nFigure 2. A screen capture of the new module’s code that steals FTP passwords from\nFileZilla\n\nFigure 3. A screen capture of the new module’s code that steals Microsoft Outlook\ncredentials\n\nFigure 4. A screen capture of Trickbot harvesting passwords from open-source FTP WinSCP\n\nAside from stealing credentials from applications, it also steals the following information from\nseveral popular web browsers such as Google Chrome, Mozilla Firefox, Internet Explorer,\nand Microsoft Edge:\n\nUsernames and Passwords\nInternet Cookies\nBrowsing History\nAutofills\nHTTP Posts\n\nFigure 5. A screen capture of Trickbot’s code that is structured to steal passwords from\npopular web browsers\n\nIt should be noted that this Trickbot variant is not capable of stealing passwords from thirdparty password manager applications. We are studying this malware further to see if it is able\nto steal passwords from password managers that have browser plugins.\n\n**_shareDll32 module_**\n\nTrickbot uses the shareDll32 module to help propagate itself throughout the network. It\nconnects to a C&C server http[:]//185[.]251[.]39[.]251/radiance[.]png to download a copy of\nitself and save it as setuplog.tmp.\n\n\n-----\n\nFigure 6. Trickbot s shareDll32 module allows it to connect to a C&C server to download a\ncopy of itself\n\nFigure 7. The downloaded file is saved as setuplog.tmp\n\nThe shareDll32 module then enumerates and identifies systems connected on the same\ndomain using WNetEnumResource and GetComputerNameW.\n\nFigure 8. Screen capture of code that enumerates and identifies connected systems using\nWNetEnumResourceW and GetComputerNameW\n\nThe file setuplog.tmp is then copied in the administrative shares of the discovered machines\nor systems.\n\nFigure 9. A screenshot of setuplog.tmp copied in the administrative shares\n\nTo make the malware more persistent, it has an auto-start service that allows Trickbot to run\nwhenever the machine boots. This service can have the following display names:\n\nService Techno\nService_Techno2\nTechnics-service2\nTechnoservices\nAdvanced-Technic-Service\n\nServiceTechno5\n\n**_wormDll module_**\n\nThe wormDll32 module attempts to identify servers and domain controllers in the network\nusing NetServerEnum and LDAP queries. Trickbot’s worm-like propagation capability was\nfirst [observed by security researchers from Flashpoint in 2017.](https://www.flashpoint-intel.com/blog/new-version-trickbot-adds-worm-propagation-module/)\n\nFigure 10. Screen capture of code that identifies workstations and servers in a domain using\nNetServerEnum\n\nFigure 11. Screen capture of code that identifies domain controllers in a network using LDAP\nqueries\n\n\n-----\n\nFigure 12. Screen capture of code that identifies machines which are not domain controllers\nin a network using LDAP queries\n\nWe also discovered that there is a possible SMB protocol implementation using “pysmb,”\nutilizing the NT LM 0.12 query for older Windows operating systems and IPC shares. It\nshould be noted that this function seems to still be in development.\n\nFigure13. Screen capture of code showing possible SMB communication\n\n**_networkDll32_**\n\nTrickbot uses this encrypted module to scan the network and steal relevant network\ninformation. It executes the following commands to gather information on the infected\nsystem:\n\nFigure 14. Screen capture of the commands executed by the networkDll32 module to gather\nnetwork information\n\n**_Wormdll32 module_**\n\nWormdll32 is an encrypted module that Trickbot uses to propagate itself via SMB and LDAP\nqueries. It is used together with the module “wormDll” to propagate across the network.\n\n**_importDll32 module_**\n\nThis module is responsible for stealing browser data such as browsing history, cookies, and\nplug-ins, among others.\n\n**_systeminfo32 module_**\n\nOnce successfully installed in a system, Trickbot will gather system information such as OS,\nCPU, and memory information, user accounts, lists of installed programs and services.\n\n**_mailsearcher32 module_**\n\nThis module searches the infected system’s files to gather email addresses for informationstealing purposes. Collecting email addresses for spam campaign-related needs is usual\n[malware behavior, however, Kryptos Research recently reported that the Emotet banking](https://blog.kryptoslogic.com/malware/2018/10/31/emotet-email-theft.html)\ntrojan doesn't just steal email addresses; it also harvests emails sent and received via\n[Microsoft Outlook on an Emotet-infected device. Emotet, according to previous research by](https://isc.sans.edu/diary/One+Emotet+infection+leads+to+three+follow-up+malware+infections/24140)\nBrad Duncan, is also responsible for delivering this password-grabbing Trickbot variant, as\nwell as [Azorult, to users.](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/spam/3661/spam-campaign-leads-to-azorult-trojan-spyware)\n\n**_injectDll32 module_**\n\n\n-----\n\nThis encrypted module monitors websites that banking applications might use. It s also used\n[to inject code into its target processes using the Reflective DLL Injection technique.](https://github.com/stephenfewer/ReflectiveDLLInjection)\n\nThe injectDll32 monitors banking-related websites for two different credential-stealing\nmethods:\n\nFirst, when a user logs in to any of the monitored banking websites on its list such as Chase,\nCiti, Bank of America, Sparda-Bank, Santander, HSBC, Canadian Imperial Bank of\nCommerce (CIBC), and Metrobank, Trickbot will then send a POST response to the C&C\nserver to extract the user’s login credentials.\n\nSecond, Trickbot monitors if a user accesses certain banking-related websites on its list,\nsuch as C. Hoare & Co bank, St. James’s Place Bank, and Royal Bank of Scotland, and will\nredirect users to fake phishing websites.\n\nThe banking URLs Trickbot monitors include websites from the United States, Canada, UK,\nGermany, Australia, Austria, Ireland, London, Switzerland, and Scotland.\n\n**Trickbot’s other notable tricks**\n\n[Trickbot is usually sent via malicious spam campaigns. The malware disables Microsoft’s](https://blog.trendmicro.com/trendlabs-security-intelligence/look-locky-ransomwares-recent-spam-activities/?_ga=2.67425105.153681460.1540774662-609786015.1505725418)\nbuilt-in antivirus Windows Defender by executing certain commands and modifying registry\nentries. Additionally, it also terminates Windows Defender-related processes such as\nMSASCuil.exe, MSASCui.exe, and antispyware utility Msmpeng.exe. It also has an autostart\nmechanism (Msntcs) that is triggered at system startup and every ten minutes after it is first\nexecuted.\n\nIt disables the following anti-malware services:\n\nMBamService (Malwarebytes-related Process)\nSAVService (Sophos AV-related process)\n\nIts anti-analysis capability checks the system and terminates itself when it finds certain\nmodules, such as pstorec.dll, vmcheck.dll, wpespy.dll, and dbghelp.dll.\n\n**Defending against Trickbot’s tricks: Trend Micro solutions**\n\nMalware authors continue to update banking trojans like Trickbot and Emotet with new\nmodules that make it more difficult to detect and combat. Users and enterprises can benefit\nfrom protection that use a multi-layered approach to mitigate the risks brought by threats like\nbanking trojans.\n\n[Trend Micro Smart Protection Suites provide a cross-generational blend of threat defense](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html)\ntechniques to protect systems from all types of threats, including banking trojans,\n[ransomware, and cryptocurrency-mining malware. It features high-fidelity machine](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/machine-learning)\n\n\n-----\n\n[learning on gateways and endpoints, and protects physical, virtual, and cloud workloads.](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/machine-learning)\nWith capabilities like web/URL filtering, behavioral analysis, and custom sandboxing, XGen\nsecurity protects against today’s threats that bypass traditional controls; exploit known,\nunknown, or undisclosed vulnerabilities; either steal or encrypt personally identifiable data; or\nconduct malicious cryptocurrency mining. Smart, optimized, and connected, XGen security\npowers Trend Micro’s suite.\n\n**Indicators of Compromise**\n\nTrickbot C&C servers\n\n103[.]10[.]145[.]197:449\n103[.]110[.]91[.]118:449\n103[.]111[.]53[.]126:449\n107[.]173[.]102[.]231:443\n107[.]175[.]127[.]147:443\n115[.]78[.]3[.]170:443\n116[.]212[.]152[.]12:449\n121[.]58[.]242[.]206:449\n128[.]201[.]92[.]41:449\n167[.]114[.]13[.]91:443\n170[.]81[.]32[.]66:449\n173[.]239[.]128[.]74:443\n178[.]116[.]83[.]49:443\n181[.]113[.]17[.]230:449\n182[.]253[.]20[.]66:449\n182[.]50[.]64[.]148:449\n185[.]66[.]227[.]183:443\n187[.]190[.]249[.]230:443\n190[.]145[.]74[.]84:449\n192[.]252[.]209[.]44:443\n197[.]232[.]50[.]85:443\n198[.]100[.]157[.]163:443\n212[.]23[.]70[.]149:443\n23[.]226[.]138[.]169:443\n23[.]92[.]93[.]229:443\n23[.]94[.]233[.]142:443\n23[.]94[.]41[.]215:443\n42[.]115[.]91[.]177:443\n46[.]149[.]182[.]112:449\n47[.]49[.]168[.]50:443\n62[.]141[.]94[.]107:443\n68[.]109[.]83[.]22:443\n\n\n-----\n\n70[.]48[.]101[.]54:443\n71[.]13[.]140[.]89:443\n75[.]103[.]4[.]186:443\n81[.]17[.]86[.]112:443\n82[.]222[.]40[.]119:449\n94[.]181[.]47[.]198:449\n\nTSPY_TRICKBOT.THOIBEAI:\n\n806bc3a91b86dbc5c367ecc259136f77482266d9fedca009e4e78f7465058d16\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-11-01 - Trickbot Shows Off New Trick- Password Grabber Module.pdf"
    ],
    "report_names": [
        "2018-11-01 - Trickbot Shows Off New Trick- Password Grabber Module.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535707,
    "ts_updated_at": 1743041175,
    "ts_creation_date": 1653751065,
    "ts_modification_date": 1653751065,
    "files": {
        "pdf": "https://archive.orkl.eu/f880ca934aacdfc1cc939e0dfd1b8eb81c040a9d.pdf",
        "text": "https://archive.orkl.eu/f880ca934aacdfc1cc939e0dfd1b8eb81c040a9d.txt",
        "img": "https://archive.orkl.eu/f880ca934aacdfc1cc939e0dfd1b8eb81c040a9d.jpg"
    }
}