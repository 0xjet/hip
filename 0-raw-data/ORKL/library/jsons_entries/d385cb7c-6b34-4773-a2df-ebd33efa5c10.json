{
    "id": "d385cb7c-6b34-4773-a2df-ebd33efa5c10",
    "created_at": "2023-01-12T15:01:23.675329Z",
    "updated_at": "2025-03-27T02:09:55.087631Z",
    "deleted_at": null,
    "sha1_hash": "68cbfae84358d15b1a840096d91dd4c5bcedd4d6",
    "title": "2018-10-23 - sLoad and Ramnit pairing in sustained campaigns against UK and Italy",
    "authors": "",
    "file_creation_date": "2022-05-28T19:51:33Z",
    "file_modification_date": "2022-05-28T19:51:33Z",
    "file_size": 3111596,
    "plain_text": "# sLoad and Ramnit pairing in sustained campaigns against UK and Italy\n\n**[proofpoint.com/us/threat-insight/post/sload-and-ramnit-pairing-sustained-campaigns-against-uk-and-italy](https://www.proofpoint.com/us/threat-insight/post/sload-and-ramnit-pairing-sustained-campaigns-against-uk-and-italy)**\n\nOctober 23, 2018\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nsLoad and Ramnit pairing in sustained campaigns against UK and Italy\n\n\n-----\n\nOctober 23, 2018 Proofpoint Staff\n\n_Editor's note: This post has been updated to reflect a change in TTPs for the actor that occurred after the original blog_\n_was finalized._\n\n**Overview**\n\nSince May 2018, Proofpoint researchers have observed email campaigns using a new downloader called sLoad.\nsLoad is a PowerShell downloader that most frequently delivers Ramnit banker and includes noteworthy\nreconnaissance features. The malware gathers information about the infected system including a list of running\nprocesses, the presence of Outlook, and the presence of Citrix-related files. sLoad can also take screenshots and\ncheck the DNS cache for specific domains (e.g., targeted banks), as well as load external binaries. In this post we will:\n\nIntroduce sLoad\nDescribe sLoad campaigns by an actor with long history of activity, including the personalization of email\nmessages with the recipient's name and address\nCover geographic targeting of the UK, Italy, and Canada, particularly via geofencing, which is performed at\nmultiple points in the infection chain.\n\n**Delivery**\n\nWhile initial versions of sLoad appeared in May 2018, we began tracking the campaigns from this actor (internally\nnamed TA554) since at least the beginning of 2017. Other researchers also noticed some of these campaigns [2][3]\n\n[4]. The following figure shows a snapshot of the actor’s recent activity, starting slightly before the introduction of\nsLoad.\n\n\n-----\n\n_Figure 1: Snapshot of TA554’s recent activity_\n\nHistorically, this actor has targeted Italy, Canada, and the United Kingdom, specifically sending malicious emails to\nrecipients in these countries. The emails are crafted in the targeted country’s language and are often personalized to\ninclude recipients’ names and addresses in various parts of the email such as email body and subject. TA554\nfrequently uses package delivery or order notification lures; the emails contain URLs linking to zipped LNK files or\nzipped documents. The LNK file or document macros in turn download the next stage -- typically a PowerShell script\nwhich may download the final payload or another downloader such as sLoad.\n\n\n-----\n\n_Figure 2: Email targeting Italian recipients on October 14, 2018_\n\n_Figure 3: Email targeting United Kingdom recipients on October 11, 2018. This email was personalized to include the_\n_recipient’s name and address_\n\nThe actor frequently, but not always, uses one or more intermediate downloader, such as an as yet unnamed\nPowerShell script, sLoad, Snatch, or Godzilla. We have observed final payloads including Ramnit, Gootkit, DarkVNC,\nUrsnif, and PsiXBot.\n\n\n-----\n\nGeofencing restricting access to content based on the user s location, determined via the source IP address is\nperformed at all steps of the infection chain. For example, we observed checks being performed at:\n\n1. Download of the zipped-LNK\n2. LNK downloading PowerShell\n3. PowerShell downloading sLoad\n4. sLoad communications with its command and control (C&C)\n5. sLoad receiving a task/command (base64-encoded binary)\n\nSteps 2 and 5 are additionally “Headers-fenced”, meaning that the request must also match those of BITS\n(Background Intelligent Transfer Service).\n\n**Malware Analysis**\n\n_Overview_\n\nFigure 4 shows an overview of the network traffic in this infection chain.\n\n_Figure 4: The full infection chain on October 17, starting from the user’s click on a link in a malicious email, to the_\n_download of PowerShell and sLoad, to subsequent sLoad C&C traffic_\n\nThe main elements of the infection chain are detailed below:\n\nLine 1: the initial user click on the URL in email, resulting in the download of a zipped LNK (a Windows shortcut\nfile [5]) from invasivespecies[.]us\nLine 3: the LNK, which was run by the user, downloads the next stage (PowerShell) from hotline[.]com/otki2/kine\nLine 5: PowerShell downloads sLoad (from lookper[.]eu/userfiles/p2.txt)\nLine 7: PowerShell downloads a file containing sLoad C&C hosts (from lookper[.]eu/userfiles/h2.txt)\nLine 8-9: sLoad initial beacon\nLine 10-11: sLoad reporting infected system information and polling for commands\nLine 13: sLoad downloading Ramnit, after receiving a command to do so. Note that we have observed extended\nwaits -- more than one day -- until sLoad receives a command to download the next stage\nLine 14: sLoad sending screenshots to the C&C\n\n_LNK_\n\n\n-----\n\nTypically when we see LNK files used as the first stage downloader, they tend to point to a PowerShell command that\nperforms the download, all inside the link target field. With files like this, it is easy to extract and analyze the\nPowerShell command. For example, on Windows this can be performed manually by right-clicking on the shortcut file,\nselecting Properties, and analyzing the command in the “Target:” box.\n\nLess commonly, data can be appended to the end of a LNK file after the termination block (four NULL bytes) [7] as\nWindows will stop reading data in the LNK after seeing a termination block. So it is possible to add [malicious] data to\nthe end of the file which can be parsed externally using PowerShell / Certutil / external tools to execute code. We\nhave observed this used to hide long series’ of commands such as described in [6].\n\nIn our case, the additional commands are appended after the end of the LNK file. Hence, the link target field\nessentially contains a short “carving script” that finds and executes commands located after the end of the LNK file.\nThe actual LNK is 1528 bytes long and additional 1486 bytes of PowerShell code is added at the end.\n\n_Figure 5: Screenshot of the example LNK properties_\n\nThe “Target:” field contains an obfuscated command that uses the “findstr” (“nwfxdrtsdnif” reversed), a Windows greplike command, to find the malicious code appended at the end of the LNK file, which is marked with the “mrekikaso”\nstring.\n\n_Figure 6: This screenshot shows the PowerShell code appended after the end of the LNK. This code performs the_\n_download of the next stage (more PowerShell)_\n\n\n-----\n\n_sLoad Downloader_\n\nThe LNK downloads a small PowerShell script (unnamed) which itself contains a few notable features:\n\nIt performs a check to see if any security processes are running on the system and exits if found\nDownloads sLoad (e.g., from lookper[.]eu/userfiles/p2.txt) and stores it encrypted with a hardcoded key as\n“config.ini”\nDownloads sLoad C&C hosts file (e.g. from lookper[.]eu/userfiles/h2.txt) and stores it encrypted with a\nhardcoded key as “web.ini”\nUses a Scheduled Task to execute sLoad\n\n_Figure 7: PowerShell (sLoad downloader) searching for security tools prior to performing any further action_\n\n_sLoad_\n\nsLoad is also written in PowerShell. At the time of this writing, the latest version of sLoad was 5.07b, which we will\nanalyze here. It includes noteworthy features such as:\n\nCollection of information to report to the C&C server that includes:\n\nA list of running process\nPresence of .ICA files on the system (likely Citrix-related)\nWhether an Outlook folder is present on the system\nAdditional reconnaissance data\nThe ability to take screenshots\nChecking the DNS cache for specific domains (e.g., targeted banks)\nLoading external binaries\n\nsLoad’s network communication begins with an initial C&C beacon to path “/img.php?ch=1”, which is an empty\nrequest. It may receive an “sok” from the server.\n\nAfter the initial beacon, sLoad enters a loop in which it pushes extensive information about the victim’s system to the\nC&C, expects and executes commands from the server, and sends screenshots to the server. In this loop, it first\nperforms a request to “captcha.php” and sends information about the infected system via the URL parameters.\n\n_Table 1: Breakdown of URL parameters and values in the “captcha.php” request_\n\n**Parameter** **Example Value** **Explanation**\n\ng “pu” Hardcoded value\n\nc “0” If any files with .ICA extension are found on the system, searched\nstarting from the “C:\\users” folder, this value is “1”. Otherwise this value\nis “0”. We assume .ICA files are the most likely Citrix-related.\n\n\n-----\n\nid System’s UUID generated with: (Get-WmiObject\nWin32_ComputerSystemProduct).UUID\n\n\nv “Microsoft Windows 7\nUltimate”\n\n\nOS caption generated with: (gwmi win32_operatingsystem).caption\n\n\nc “GLklWOaPjmVuQiCD” Random string of 16 upper and lower letters, generated for each such\nrequest\n\na “*armsvc*cmd*cmd*conhost” “*”-separated list of running processes\n\nd The point of this parameter is to count the number of computers in the\ncurrent domain or network. This parameter could be empty if there are\nnone, or can have a value such as “{in network:1}”\n\nn “MARK-PC” Computer name generated with: $env:ComputerName\n\nbu “*nwolb.com*barclays.co.uk” “*”-separated list of hostnames from the system’s DNS cache that\nmatch the hostnames from a hardcoded list of targeted banks\n\n\ncpu “Intel(R) Core(TM) i5-780HQ\nCPU @ 2.91GHz”\n\n\nSystem processor information\n\n\no “0” If \"\\..\\Microsoft\\Outlook\\\" (starting from current working directory) exists\nthen “1”, else “0”\n\nsLoad reads and saves the server’s response to the “captcha.php” request. If any response is returned, sLoad checks\nit and acts upon it. The response can begin with:\n\n_Table 2: Explanation of possible responses from the C&C to the “captcha.php” request_\n\n\n**Server**\n**Response**\n**(begins with)**\n\n\n**Explanation**\n\n\n“run=” This is followed by a URL which is downloaded and its PowerShell content executed\n\n“updateps=” This is followed by a URL which is downloaded and its PowerShell content saved. Essentially\nthis implements the “update self” functionality. The contents of the file storing sLoad on disk are\nreplaced, and the current sLoad instance is stopped\n\n\nAny other\nresponse with\nlength greater\nthan 3\n\n\nIs expected to be a URL, whose content is downloaded, decoded with “certutil”, and saved as\nan executable, at which point the executable is started\n\n\nNear the end of the main loop, sLoad will upload the screenshots it took of the victim’s Desktop to the “p.php” URI.\nsLoad executes a long sleep of 10 minutes before it polls the server again for commands and to upload additional\nscreenshots.\n\n\n-----\n\n_Figure 8: sLoad posting a screenshot to its C&C_\n\n_Figure 9: sLoad contains a hardcoded array of banking keywords and hostnames (in this instance, for Italian banks). It_\n_compares the infected machine’s DNS cache to this list, and reports any matches to the C&C in the “bu” parameter._\n\n_Figure 10: sLoad contains a hardcoded array of banking keywords and hostnames (in this instance for UK banks). It_\n_compares the infected machines DNS cache to this list, and reports any matches to the C&C in the “bu” parameter._\n\n_Figure 11: sLoad searching for files with .ICA extension, starting in “C:\\users” folder. We assume these are most likely_\n_Citrix-related due to this format used for Citrix application servers as a configuration file and the “$cit” variable._\n\n_sLoad Versions_\n\n\n-----\n\nSince May 2018 we have observed multiple versions of sLoad, which introduced incremental changes.\n\n_Table 3: sLoad versions observed_\n\n**Version** **Date Observed**\n\n0.01b 2018-05-01\n\n2.01b 2018-05-09\n\n2.11b 2018-05-12\n\n2.37b 2018-06-06\n\n3.47b 2018-06-26\n\n4.07b 2018-08-23\n\n5.07b 2018-09-20\n\n5.08b 2018-10-03\n\nWe were also able to observe control panels for a number of these versions (Figures 12-15).\n\n_Figure 12: Screenshot of the C&C panel, version 0.01b_\n\n\n-----\n\n_Figure 13: Screenshot of the C&C panel, version 2.01b_\n\n_Figure 14: Screenshot of the C&C panel, version 2.37b_\n\n\n-----\n\n_Figure 15: Screenshot of the C&C panel, version 4.07b_\n\n**Updated October 23, 2018 - New TTP**\n\nOn October 22, 2018, the actor added a victim facing landing at the zipped-lnk download step [8] (Figure 16). In this\ncase, the .LNK was downloading sLoad directly without the additional intermediate PowerShell.\n\n_Figure 16: New victim-facing landing page_\n\n\n-----\n\n**Conclusion**\n\nProofpoint researchers identified yet another stealthy downloader, this time paired with personalized email lures and\nsophisticated geofencing. sLoad, like other downloaders we have profiled recently, fingerprints infected systems,\nallowing threat actors to better choose targets of interest for the payloads of their choice. In this case, that final\npayload is generally a banking Trojan via which the actors can not only steal additional data but perform man-in-thebrowser attacks on infected individuals. Downloaders, though, like sLoad, Marap, and others, provide high degrees of\nflexibility to threat actors, whether avoiding vendor sandboxes, delivering ransomware to a system that appears\nmission critical, or delivering a banking Trojan to systems with the most likely return.\n\n**References**\n\n[1] [https://asert.arbornetworks.com/snatchloader-reloaded/](https://asert.arbornetworks.com/snatchloader-reloaded/)\n\n[2] [https://isc.sans.edu/forums/diary/Malicious+Powershell+Targeting+UK+Bank+Customers/23675/](https://isc.sans.edu/forums/diary/Malicious+Powershell+Targeting+UK+Bank+Customers/23675/)\n\n[3] [https://myonlinesecurity.co.uk/your-order-no-8194788-has-been-processed-malspam-delivers-malware/](https://myonlinesecurity.co.uk/your-order-no-8194788-has-been-processed-malspam-delivers-malware/)\n\n[4] [http://blog.dynamoo.com/2017/02/highly-personalised-malspam-making.html](http://blog.dynamoo.com/2017/02/highly-personalised-malspam-making.html)\n\n[5] [https://msdn.microsoft.com/en-us/library/dd871305.aspx](https://msdn.microsoft.com/en-us/library/dd871305.aspx)\n\n[6] [https://www.uperesia.com/booby-trapped-shortcut-generator](https://www.uperesia.com/booby-trapped-shortcut-generator)\n\n[7] [https://lifeinhex.com/analyzing-malicious-lnk-file/](https://lifeinhex.com/analyzing-malicious-lnk-file/)\n\n[8] [https://twitter.com/ps66uk/status/1054706165878321152](https://twitter.com/ps66uk/status/1054706165878321152)\n\n**Indicators of Compromise (IOCs)**\n\n**IOC** **IOC Type** **Description**\n\nhxxps://invasivespecies[.]us/htmlTicket-access/ticket-T559658356711702 URL URL in email - 201810-17\n\nhxxps://davidharvill[.]org/htmlTicket-access/ticket-V081650502356 URL URL in email - 201810-17\n\nhxxps://schwerdt[.]org/htmlTicket-access/ticket-823624156690858 URL URL in email - 201810-17\n\n5ea968cdefd2faabb3b4380a3ff7cb9ad21e03277bcd327d85eb87aaeecda282 SHA256 ticketT559658356711702.zip\n\n                                             - 2018-10-17\n\nhxxps://hotkine[.]com/otki2/kine URL Zipped LNK gets\nPowerShell - 2018-1017\n\na446afb6df85ad7819b90026849a72de495f2beed1da7dcd55c09cd33669d416 SHA256 kine - ps1 - 2018-10-17\n\nhxxps://lookper[.]eu/userfiles/p2.txt URL PowerShell gets sLoad\n\n                                             - 2018-10-17\n\n\n-----\n\nhxxps://lookper[.]eu/userfiles/h2.txt URL PowerShell gets sLoad\nhosts file - 2018-10-17\n\n79233b83115161065e51c6630634213644f97008c4da28673e7159d1b4f50dc2 SHA256 p2.txt sLoad - GBR 2018-10-17\n\n245c12a6d3d43420883a688f7e68e7164b3dda16d6b7979b1794cafd58a34d6d SHA256 h2.txt sLoad hosts GBR - 2018-10-17\n\nhxxps://maleass[.]eu/images//img.php?ch=1 URL sLoad C&C - 2018-1017\n\nhxxps://informanetwork[.]com/update/thrthh.txt URL sLoad payload\n(Ramnit) - 2018-10-17\n\nb1032db65464a1c5a18714ce3541fca3c82d0a47fb2e01c31d7d4c3d5ed60040 SHA256 Ramnit - 2018-10-17\n\nxohrikvjhiu[.]eu|185.197.75.35 DOMAIN|IP Ramnit C&C - 201810-17\n\n**ET and ETPRO Suricata/Snort Signatures**\n\n2830633 || ETPRO TROJAN sLoad CnC Checkin M2\n\n2830632 || ETPRO TROJAN sLoad CnC Checkin\n\n2018856 || ET TROJAN Windows executable base64 encoded\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-10-23 - sLoad and Ramnit pairing in sustained campaigns against UK and Italy.pdf"
    ],
    "report_names": [
        "2018-10-23 - sLoad and Ramnit pairing in sustained campaigns against UK and Italy.pdf"
    ],
    "threat_actors": [
        {
            "id": "9be98f84-4a93-41c7-90bd-3ea66ba5bfd7",
            "created_at": "2022-10-25T16:07:24.581954Z",
            "updated_at": "2025-03-27T02:02:10.287921Z",
            "deleted_at": null,
            "main_name": "TA554",
            "aliases": [
                "TH-163"
            ],
            "source_name": "ETDA:TA554",
            "tools": [
                "DarkVNC",
                "Godzilla",
                "Godzilla Loader",
                "Gootkit",
                "Gootloader",
                "Gozi ISFB",
                "ISFB",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Nimnul",
                "Pandemyia",
                "PsiX",
                "PsiXBot",
                "Ramnit",
                "StarsLord",
                "Waldek",
                "Xswkit",
                "sLoad",
                "talalpek"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a3808e4f-c7fd-4d25-aa84-aacc27061826",
            "created_at": "2023-01-06T13:46:39.316216Z",
            "updated_at": "2025-03-27T02:00:03.049128Z",
            "deleted_at": null,
            "main_name": "TA554",
            "aliases": [
                "TH-163"
            ],
            "source_name": "MISPGALAXY:TA554",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535683,
    "ts_updated_at": 1743041395,
    "ts_creation_date": 1653767493,
    "ts_modification_date": 1653767493,
    "files": {
        "pdf": "https://archive.orkl.eu/68cbfae84358d15b1a840096d91dd4c5bcedd4d6.pdf",
        "text": "https://archive.orkl.eu/68cbfae84358d15b1a840096d91dd4c5bcedd4d6.txt",
        "img": "https://archive.orkl.eu/68cbfae84358d15b1a840096d91dd4c5bcedd4d6.jpg"
    }
}