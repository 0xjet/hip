{
    "id": "e0bd1a39-7302-46ea-bdb2-f4e4ba4bc0ca",
    "created_at": "2023-01-12T14:58:54.820057Z",
    "updated_at": "2025-03-27T02:08:41.43058Z",
    "deleted_at": null,
    "sha1_hash": "84ece5c5184030bdcffb50fffcf841865ee63d93",
    "title": "2018-11-16 - Exploring Emotet- Examining Emotet’s Activities, Infrastructure",
    "authors": "",
    "file_creation_date": "2022-05-28T16:00:51Z",
    "file_modification_date": "2022-05-28T16:00:51Z",
    "file_size": 302381,
    "plain_text": "# Examining Emotet’s Activities, Infrastructure\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/exploring-emotet-examining-emotets-activities-infrastructure/](https://blog.trendmicro.com/trendlabs-security-intelligence/exploring-emotet-examining-emotets-activities-infrastructure/)**\n\nNovember 16, 2018\n\nMalware\n\nWe did comprehensive research on Emotet’s artifacts — 8,528 unique URLs, 5,849\ndocument droppers, and 571 executables collected between June 1, 2018 and September\n15, 2018 — to discover it’s infrastructure as well as possible attribution information.\n\nBy: Trend Micro November 16, 2018 Read time: ( words)\n\nDiscovered by Trend Micro in 2014, the banking Trojan [Emotet has been brought back to life](https://blog.trendmicro.com/trendlabs-security-intelligence/new-banking-malware-uses-network-sniffing-for-data-theft/)\n[by malware authors last year with its own spamming module that has allowed it to spread,](https://blog.trendmicro.com/trendlabs-security-intelligence/emotet-returns-starts-spreading-via-spam-botnet/)\ntarget new industries and regions, and evade sandbox and malware analysis techniques.\nThis year, we examined Emotet’s activities to learn more about how this modular malware\nwreaks havoc: We did a comprehensive research on Emotet’s artifacts — 8,528 unique\nURLs, 5,849 document droppers, and 571 executables collected between June 1, 2018 and\nSeptember 15, 2018 — to discover Emotet’s infrastructure as well as possible attribution\ninformation.\n\nSome of the highlights of our research include the following:\n\n\n-----\n\n1. We discovered that there are at least two infrastructures running parallel to one\n\n**another that support the Emotet botnet. By grouping the C&C servers and the RSA**\nkeys of the malware, we were able to see two distinct groups of infrastructures. We\nalso saw that the threat actors switched RSA keys on a monthly basis. While the nextstage payloads each group pushed does not show any major difference in terms of\npurpose or targets, the differing infrastructures of both groups may be designed to\nmake it more difficult to track Emotet and minimize the possibility of failure.\n2. Multilayer operating mechanisms might have been adopted in the creation of\n\n**Emotet’s artifacts. The inconsistency between the activity patterns show that the**\ninfrastructure used to create and spread document droppers are different from those\nused to pack and deploy Emotet executables. The creation of document droppers\nstops during the non-working hours between 1:00 to 6:00 (UTC). Meanwhile, there\nmight be three sets of machines that are used to pack and deploy Emotet’s executable\npayloads, two of which are probably set to the time zones UTC +0 and UTC +7,\nrespectively.\n3. The author of the Emotet malware may live somewhere in the UTC+10 time zone,\n\n**or further east. After we grouped the executable samples by their unpacked payloads’**\ncompilation timestamps, we found two sample groups that showed an inconsistency\nbetween the compilation timestamps and the corresponding first-seen records in the\nwild. This might lead to the possibility that the compilation timestamps are pointing to\nthe local time on the malware author’s machine. The conclusion of the malware author\nprobably staying in UTC +10 time zone or further east can therefore be drawn if the\nlocal time is accurate.\n\n**Emotet’s two infrastructures**\n\nWe have collected and analyzed 571 executable samples of Emotet. The configuration\ninside an executable includes a list of C&C servers and an RSA key for connection\nencryption.\n\nThere were only six unique RSA public keys extracted from the executable samples. Each\nRSA key has a 768-bit modulus and uses the public exponent 65537. We calculated the\nCRC32 of each RSA key blob and gave each key a name for easier identification.\n\n**Key Name** **CRC32** **Emotet Group**\n\nA fcb2fb3b 1\n\nB 86e9acef 1\n\nC ceff5362 1\n\nD fc8e8aaa 2\n\nE 8f1eb5e 2\n\n\n-----\n\nF aef0def8 2\n\nTable 1. The RSA keys extracted from Emotet executables\n\nMeanwhile, Emotet’s C&C server is an IP/port pair on top of its HTTP protocol. We extracted\n721 unique C&C servers in total. On average, one Emotet sample contains 39 C&C servers,\nwith a maximum number of 44 and a minimum of 14. Based on our observation, only a few\nC&C servers embedded in a single Emotet sample are actually active.\n\nWe found that most of the C&C servers are located in the United States, Mexico, and\nCanada. The top 3 ASN connected to Emotet are ASN7922, ASN8151 and ASN22773.\n\nFigure 1. Countries wherein Emotet C&C servers are distributed\n\nFigure 2. Distribution of Emotet C&C servers’ ports\n\nWe visualized the relationship between each RSA key and its set of C&C servers and\ndiscovered that there were two RSA key groups. Keys A, B, and C were in one group (Group\n1), and keys D, E, and F were in another (Group 2).\n\nFigure 3. Relationships between RSA keys and C&C servers. Each blue dot represents a\nunique C&C server, while the red ones indicate RSA public keys.\n\nAs Figure 3 shows, these two distinct groups do not share C&C servers.\n\nFigure 4. Timestamps when the RSA keys were received. The green dots represent the keys\nused by Group 1, while the orange dots represent the keys used by Group 2. Each dot\nrepresents the timestamp when each RSA key was found in the configuration of a new\nsample.\n\n**Month** **June** **July** **August** **September**\n\nKeys used by Group 1 fcb2fb3b (A) 86e9acef (B) 86e9acef (B) ceff5362 (C)\n\nKeys used by Group 2 fc8e8aaa (D) 8f1eb5e (E) aef0def8 (F)\n\nTable 2. Two groups of RSA keys and the corresponding months they have shown activity\n\nOur analysis shows a link between the dates the RSA keys were received and the two\ngroups’ activities: each RSA key was observed to have been used for one month before\nthreat actors switched to another RSA key on the first working day of the succeeding month\n(i.e. Jul. 2, 2018 and Sep. 3, 2018, both fall on a Monday).\n\n\n-----\n\nWe also observed that there were more artifacts belonging to Group 1 compared to those in\nGroup 2. Based on our data, we received 469 unpacked Emotet samples for Group 1 and\n102 for Group 2, respectively. We also did not find any activity for Group 2 for the month of\nAugust, as shown in Figure 4.\n\n**Two different Emotet groups, two different agendas?**\n\nOur initial assumption was that the two Emotet groups were created for different purposes or\nare being utilized by different operators. To prove this assumption, we referred to data from\n[@malware_traffic and categorized the IoCs respectively. However, we did not find any major](https://twitter.com/malware_traffic)\ndifference between the IoCs under these two groups. For instance, TrickBot with gtag arz1\nwas found to have been sent by Group 1 on September 20 and by Group 2 the next day.\nWithout any strong evidence, we can only tell that the two groups might be different\ninfrastructures designed to make tracking Emotet more difficult and help minimize the\npossibility of failure.\n\n**Date** **Emotet Group** **RSA Key** **Next-stage Payload**\n\n2018-07-03 2 E Panda Banker\n\n2018-07-09 1 B Panda Banker\n\n2018-07-16 2 E Panda Banker\n\n2018-07-19 2 E Panda Banker\n\n2018-07-30 1 B Panda Banker\n\n2018-07-31 1 B Panda Banker\n\n2018-08-08 1 B Trickbot\n\n2018-08-10 1 B Panda Banker\n\n2018-08-13 1 B Panda Banker\n\n2018-08-14 1 B Panda Banker\n\n2018-08-15 1 B Panda Banker\n\n2018-08-16 1 B Panda Banker\n\n2018-08-22 1 B Panda Banker\n\n2018-08-24 1 B Panda Banker\n\n2018-08-26 1 B Panda Banker\n\n2018-09-04 2 F IcedID, TrickBot\n\n\n-----\n\n2018-09-05 2 F IcedID, AZORult\n\n2018-09-06 1 C IcedID, AZORult\n\n2018-09-14 1 C TrickBot gtag: del72\n\n2018-09-20 1 C TrickBot gtag: arz1\n\n2018-09-21 2 F TrickBot gtag: arz1, del77, jim316, lib316\n\nTable 3. The next-stage payload delivered by Emotet’s two infrastructures between July and\nSeptember 2018\n\n**Compiling Emotet’s Source Code for Each Infrastructure**\n\nEmotet payloads are protected by customized packers and obfuscators. We studied the\ncompilation of timestamps against each sample before and after packing and saw that some\nof the timestamps in packed samples were forged, while some seemed legitimate. The\nsamples with legitimate timestamps show just a few minutes difference from being compiled\nto that of when they were found in the wild. For example, sample SHA256:\n648dce03ac4c32217ce5c0b279bc3775faf030cafb313c74009fe60ffde3c924 (Detected by\nTrend Micro as TSPY_EMOTET.NSFOGAH) was compiled at 2018-06-06 05:40:17 and was\nfound in the wild four minutes later. However, sample SHA256:\n07deb1b8a86d2a4c7a3015899383dcc4c15dfadcfafc3f2b8d1e3aa89a6c7ac4 (Detected by\nTrend Micro as TSPY_EMOTET.TTIBBJD) was compiled at 2035-07-30 21:36:11, which is\nobviously a fake timestamp. Since it is difficult to distinguish legitimate timestamps from\nforged ones, research on the packed files’ timestamps may prove to be fruitless.\n\nEven though the compilation timestamp might be bogus, we decided to analyze the\nunpacked Emotet samples and saw that their timestamps seem legitimate. Out of 571\nunpacked Emotet samples, only 11 distinct compilation timestamps were found. If the\ntimestamp is forged during every compilation, the samples compiled with the same pieces of\ncode should contain identical code sections but with different compilation timestamps.\nHowever, we found that the unpacked samples with the same timestamp share the identical\ncode section, while differences can be found among those with different timestamps. The\nchanges between the different timestamps also seem to be new-version updates.\n\nData in Table 4 show that the actor might have used automatic tools or scripts to compile\nEmotet’s source code for each infrastructure, since a number of unique samples share the\nsame compilation timestamp. The data also shows that the actors prepared the payload for\nGroups 1 and 2 sequentially. For example, on June 3, 2018, 46 Emotet samples were\ngenerated at 20:08 UTC by using Group 1’s RSA public key and C&C servers. Two minutes\nlater, 37 other Emotet samples were generated.\n\n\n-----\n\nWe noticed that the attackers tended to update Emotet samples on Monday or Wednesday\n(UTC). We also observed that the code section is exactly the same among the samples that\nhad the same compilation timestamp. The only difference is the C&C servers embedded in\nthe data section. It is possible that each time a source code is compiled, several C&C\nservers on the attacker’s control list were chosen for generating a new sample.\n\n\n**Emotet**\n**Group**\n\n\n**RSA**\n**Key**\n\n\n**Compilation**\n**Timestamp in Epoch**\n\n\n**Payload's Compilation**\n**Timestamp (UTC)**\n\n\n**Unique**\n**Sample**\n**Count**\n\n\n1 A 1528056487 2018-06-03 20:08:07 56\n\n2 D 1528056680 2018-06-03 20:11:20 38\n\n1 B 1530547690 2018-07-02 16:08:10 28\n\n2 E 1530547815 2018-07-02 16:10:15 25\n\n1 B 1531161666 2018-07-09 18:41:06 31\n\n2 E 1531161732 2018-07-09 18:42:12 18\n\n2 E 1531899206 2018-07-18 07:33:26 57\n\n2 E 1531906587 2018-07-18 09:36:27 5\n\n1 B 1532502303 2018-07-25 07:05:03 276\n\n1 C 1536011873 2018-09-03 21:57:53 21\n\n2 F 1536011945 2018-09-03 21:59:05 16\n\nTable 4. Unique samples collected in the wild with corresponding compilation timestamps\n\nWe will release more information about Emotet’s technical details and also possible\nattribution-related intelligence at a later time.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-11-16 - Exploring Emotet- Examining Emotet’s Activities, Infrastructure.pdf"
    ],
    "report_names": [
        "2018-11-16 - Exploring Emotet- Examining Emotet’s Activities, Infrastructure.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535534,
    "ts_updated_at": 1743041321,
    "ts_creation_date": 1653753651,
    "ts_modification_date": 1653753651,
    "files": {
        "pdf": "https://archive.orkl.eu/84ece5c5184030bdcffb50fffcf841865ee63d93.pdf",
        "text": "https://archive.orkl.eu/84ece5c5184030bdcffb50fffcf841865ee63d93.txt",
        "img": "https://archive.orkl.eu/84ece5c5184030bdcffb50fffcf841865ee63d93.jpg"
    }
}