{
    "id": "cd34e147-3aed-45da-9086-7689df04ce0e",
    "created_at": "2023-01-12T15:08:57.158847Z",
    "updated_at": "2025-03-27T02:09:44.512193Z",
    "deleted_at": null,
    "sha1_hash": "9e399e59b1024989b203ab786434748c454da7d4",
    "title": "2021-04-21 - Donot Team APT Group Is Back To Using Old Malicious Patterns",
    "authors": "",
    "file_creation_date": "2022-05-27T23:07:34Z",
    "file_modification_date": "2022-05-27T23:07:34Z",
    "file_size": 1082780,
    "plain_text": "# Donot Team APT Group Is Back To Using Old Malicious Patterns\n\n**cybleinc.com/2021/04/21/donot-team-apt-group-is-back-to-using-old-malicious-patterns/**\n\nThe Donot Team APT organization (APT-C-35) is an Advanced Persistent Threat (APT) group that targets organizations having\na government background. The threat group is known to carry out APT attacks against Pakistan, China, and countries in\nSouth Asia. The group mainly uses malicious programs developed in C++, python, .net, and other languages.\n\n\nApril 21, 2021\n\n\nIn addition to spreading malware via spear phishing emails with attachments containing either a vulnerability or a malicious macro, this group\nis particularly good at leveraging malicious Android APKs in their target attacks. These Android applications are often disguised as system\ntools and can be identified by scanning them through VirusTotal. In some cases, these applications may be disguised\nas fake apps, mobile games, and news apps. After installation, these apps perform the Trojan functions in the background. For instance, they\nmay remotely control the victim’s system and steal confidential information from the targeted device.\n\nIn a recent [tweet, a security researcher shared the digests leading to the app. Upon analysis of the digests, researchers at Cyble found](https://twitter.com/bl4ckh0l3z/status/1384062821034459138)\nall apps leading to the application package “com.update.gooqle”, a fake app disguised as a legitimate Google update application. For further\nanalysis, Cyble’s SaaS threat intelligence platform Cyble Vision was used to fetch more information on the application by picking one\n[digest from among the links shared in the Tweet.](https://pastebin.com/raw/syZnsZkc)\n\n_Figure 1: Information from Cyblethreat intelligence platform_\n\nSample digest used for our analysis: be6ceeea0ca5df85c1788ae30cf0b7e6093aa543e3963a44b24139856ef083dd\n\nAs shown in Fig.1, the name of the sample digest is visible as “com.update.gooqle”. It is important to note that the package name\nis spelled “gooqle” in an attempt to pass it off as ”Google”.\n\nBelow are the file hashes for the above digest:\n\n\n-----\n\n_Figure 2: Information on file hashes_\n\nAs shown in the figure below, the scan result of the analyzed digest from VirusTotal reveals the application to be “A\nVariant of Android/Spy.Agent.AGY”, which falls under spyware, a type of malware.\n\n_Figure 3:VirusTotalscan result_\n\nOn reviewing the static code of the digest, the malware is seen to support up to 20 remote control commands, including test operations. The\nremote-control commands include critical actions such as obtaining contact lists, text messages, call records, geographic locations, user files,\nand installed applications, etc. For these actions to be performed, the app requests the following sensitive permissions, as found in its manifest\nfile.\n\n\n-----\n\n_Figure 4: Sensitive permissions requested by the app_\n\nIn order to control the user’s mobile phone remotely, the malware obtains remote control command by reading a local database file.\n\n_Figure 5:Code used by app to get control instructions_\n\n_Figure 6:Code used by app to get job details from the database_\n\nBelow are the suspicious permissions, services, and receivers found from the above application:\n\n\n-----\n\n**e** **ss o s**\n\nandroid.permission.READ_CALENDAR\nandroid.permission.PROCESS_OUTGOING_CALLS\nandroid.permission.ACCESS_COARSE_LOCATION\nandroid.permission.INTERNET\nandroid.permission.ACCESS_FINE_LOCATION\nandroid.permission.SEND_SMS\nandroid.permission.READ_CALL_LOG\ncom.android.browser.permission.READ_HISTORY_BOOKMARKS\nandroid.permission.WRITE_EXTERNAL_STORAGE\nandroid.permission.RECORD_AUDIO\nandroid.permission.CALL_PHONE\nandroid.permission.READ_PHONE_STATE\nandroid.permission.READ_SMS\nandroid.permission.RECEIVE_SMS\nandroid.permission.READ_CONTACTS\n\n**Services:**\n\ncom.jgoogle.android.gservicekns.ten.ten\ncom.jgoogle.android.gservicekns.nine.ninere\ncom.evernote.android.job.v21.PlatformJobService\ncom.evernote.android.job.v14.PlatformAlarmService\ncom.evernote.android.job.v14.PlatformAlarmServiceExact\ncom.evernote.android.job.gcm.PlatformGcmService\ncom.evernote.android.job.Job RescheduleService\n\n**Receivers:**\n\ncom.jgoogle.android.gservicekns.onere\ncom.jgoogle.android.gservicekns.four.fourre\ncom.jgoogle.android.gservicekns.five.fivere\ncom.jgoogle.android.gservicekns.twenty.twenty\ncom.jgoogle.android.gservicekns.seven.PhonecallReceiver\ncom.jgoogle.android.gservicekns.eight.eightre\ncom.evernote.android.job.v14.PlatformAlarmReceiver\nCom.evernote.android.job.JobBootReceiver\n\nUsing the above permissions granted from users, the following data is fetched from the devices:\n\n1. The app installs an application shortcut on the screen and removes its application launcher icon to stay hidden.\n\n_Figure 7: Code used to create app shortcut on the screen_\n\n\n-----\n\n_Figure 8: Code that checks packages and removes the application launcher_\n\n1. Queries the device phone number and monitors outgoing and incoming phone calls\n\n_Figure 9:Code that monitors outgoing and incoming phone calls_\n\n1. Creates SMS data from the protocol data unit (PDU) and monitors Incoming SMSes\n\n\n-----\n\n_Figure 10:Code that monitors incoming text message_\n\n1. It also parses and Queries SMS data\n\n_Figure 11: Code that queries SMS data_\n\n1. Looks for the list of installed applications\n\n\n-----\n\n_Figure 12: Gets the list of installed apps and stores it in text file_\n\n1. The app gets the history of calls logs and call list from the user’s device\n\n_Figure 13:Code that fetches and stores contact list and call logs in text file_\n\n1. Gets phone contact information and email messages from the victim device\n\n\n-----\n\n_Figure 14: Code that saves phone contacts and email messages in text file_\n\n1. The app also accesses Android OS build fields to evade the malware analysis system\n\n_Figure 15:Code that gets Android build fields_\n\n1. Along with all the above details, the app also fetches the phone location used for geo-tracking to get the last known location.\n\n\n-----\n\n_Figure 16:Code for location tracking_\n\nAll the data collected from the device is saved in the “corresponding text” file. In case of the old variant of this malicious file, these\nfiles are saved in the local file, while in the case of the new variant, the files are saved in the corresponding .json file and upload to the C2 link.\n\n_Figure 17: Information fetched from the user machine stored in text files_\n\n[Upon further inspection of the Android package, we found that it communicates with the domain http://www.geoip-db.com to grab the](http://www.geoip-db.com/)\n[infected device’s geolocation information and external IP address. The URL https://www.geoip-db.com/json still works; however, the root of the](https://www.geoip-db.com/json)\n[domain is no longer operational and directs users to a new location: http://geolocation-db.com/.](http://geolocation-db.com/)\n\n\n-----\n\n_Figure 18: Code that fetches the geolocation information_\n\n**SafetyRecommendations:**\n\n1. Use security software on smartphones.\n\n2. It is recommended to download mobile applications only through reliable application markets and avoid downloading and installing through\nshared links.\n\n3. Ensure the timely upgrading of the mobile phone operating system to reduce the possibility of attackers exploiting system vulnerabilities.\n\n4. People concerned about the exposure of their stolen credentials in the darkweb can register at AmiBreached.com to ascertain their\nexposure.\n\n**MITRE ATT&CK® Techniques– for Mobile**\n\n\n**Tactic** **Technique**\n**ID**\n\nDefense Evasion [T1418](https://attack.mitre.org/techniques/T1418/)\n[T1406](https://attack.mitre.org/techniques/T1406/)\n\n\n**Technique Name**\n\n1. Application discovery 2. Obfuscated files or information\n\n1. Capture SMSes 2. Access stored application data\n\n1. System network connections discovery 2. Location tracking 3. Application discovery 4. System information dis\n\n1. Access contact list 2. Access call log 3. Location tracking 4. Capture audio 5. Network information discovery 6\n\n\nCredential\naccess\n\n\n[T1412](https://attack.mitre.org/techniques/T1412/)\n[T1409](https://attack.mitre.org/techniques/T1409/)\n\n\nDiscovery [T1421](https://attack.mitre.org/techniques/T1421)\n[T1430](https://attack.mitre.org/techniques/T1430/)\n[T1418](https://attack.mitre.org/techniques/T1418/)\n[T1426](https://attack.mitre.org/techniques/T1426/)\n\nCollection [T1432](https://attack.mitre.org/techniques/T1432/)\n[T1433](https://attack.mitre.org/techniques/T1433/)\n[T1430](https://attack.mitre.org/techniques/T1430/)\n[T1429](https://attack.mitre.org/techniques/T1429/)\n[T1507](https://attack.mitre.org/techniques/T1507/)\n[T1412](https://attack.mitre.org/techniques/T1412/)\n[T1409](https://attack.mitre.org/techniques/T1409/)\n\n\n-----\n\nCommand and\nControl\n\n\n[T1573](https://attack.mitre.org/techniques/T1573/)\n[T1071](https://attack.mitre.org/techniques/T1071/)\n\n\n1. Encrypted channel 2. Application layer protocol\n\n\nImpact [T1448](https://attack.mitre.org/techniques/T1448/) Carrier billing fraud\n\n**Indicators of Compromise (IoCs):**\n\n**IOC** **IOC Type**\n\n288ea46d1e08fd9eca3369156b4430b1 MD5 Hashes\n\nbe6ceeea0ca5df85c1788ae30cf0b7e6093aa543e3963a44b24139856ef083dd SHA256\n\nandroid.accessibilityservice.AccessibilityService Intent by Action\n\n[https://www.geoip-db.com/json&nbsp;](https://www.geoip-db.com/json&nbsp) Interesting URL\n\n167.99.135.134 IP address\n\n/data/data/com.update.gooqle/files/accounts.txt File path dropped\n\n/data/data/com.update.gooqle/files/contacts.txt File path dropped\n\n/data/data/com.update.gooqle/files/CallLogs.txt File path dropped\n\n**About Cyble**\n\n[Cyble is a global threat intelligence SaaS provider that helps enterprises protect themselves from cybercrimes and exposure in](https://cyble.com/)\nthe darkweb. Cyble’s prime focus is to provide organizations with real-time visibility into their digital risk footprint. Backed by Y Combinator as\npart of the 2021 winter cohort, Cyble has also been recognized by Forbes as one of the top 20 Best Cybersecurity Startups To Watch In\n2020. Headquartered in Alpharetta, Georgia, and with offices in Australia, Singapore, and India, Cyble has a global presence. To learn more\n[about Cyble, visit www.cyble.com.](http://www.cyble.com/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-21 - Donot Team APT Group Is Back To Using Old Malicious Patterns.pdf"
    ],
    "report_names": [
        "2021-04-21 - Donot Team APT Group Is Back To Using Old Malicious Patterns.pdf"
    ],
    "threat_actors": [
        {
            "id": "2ac63ef4-a7b8-4a30-96ad-b30ccb2073fc",
            "created_at": "2022-10-25T16:07:23.546262Z",
            "updated_at": "2025-03-27T02:02:09.856624Z",
            "deleted_at": null,
            "main_name": "Donot Team",
            "aliases": [
                "APT-C-35",
                "SectorE02"
            ],
            "source_name": "ETDA:Donot Team",
            "tools": [
                "BackConfig",
                "EHDevel",
                "Jaca",
                "yty"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cfdd350b-de30-4d29-bbee-28159f26c8c2",
            "created_at": "2023-01-06T13:46:38.433736Z",
            "updated_at": "2025-03-27T02:00:02.832565Z",
            "deleted_at": null,
            "main_name": "VICEROY TIGER",
            "aliases": [
                "OPERATION HANGOVER",
                "Donot Team",
                "APT-C-35",
                "SectorE02",
                "Orange Kala"
            ],
            "source_name": "MISPGALAXY:VICEROY TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536137,
    "ts_updated_at": 1743041384,
    "ts_creation_date": 1653692854,
    "ts_modification_date": 1653692854,
    "files": {
        "pdf": "https://archive.orkl.eu/9e399e59b1024989b203ab786434748c454da7d4.pdf",
        "text": "https://archive.orkl.eu/9e399e59b1024989b203ab786434748c454da7d4.txt",
        "img": "https://archive.orkl.eu/9e399e59b1024989b203ab786434748c454da7d4.jpg"
    }
}