{
    "id": "37f59bb8-5884-4952-92c8-3da86f5fc23b",
    "created_at": "2024-06-25T07:48:16.062447Z",
    "updated_at": "2025-03-27T02:14:11.702187Z",
    "deleted_at": null,
    "sha1_hash": "171b1c463aeea22759e3e9ea4c8feac1ef337731",
    "title": "Attachment 1 - Night Dragon Specific Protection Measures for Consideration",
    "authors": "",
    "file_creation_date": "2011-02-18T10:58:14Z",
    "file_modification_date": "2011-04-07T09:51:57Z",
    "file_size": 85018,
    "plain_text": "# Attachment 1 - Night Dragon Specific Protection Measures for Consideration\n\nThe exploits and methods contained in Night Dragon’s attack set are not new or unique to\nour industry, nor are the approaches or methods to combat it. However NERC issues this\nAdvisory in response to an identified pattern of activity that has been directed against the\nenergy sector. This Advisory communicates specific information and suggested actions for\nNight Dragon in accordance with standard detection, prevention, and recovery phases of a\nstrong incident response program.\n\nThe following framework provides two sets of prioritized measures and countermeasures\nthat may be useful to prevent traffic to and from known “command and control” (C&C)\nservers and domains, and identify the presence of Night Dragon activity on specific\nsystems. They begin with simple low-cost, low-impact, high-value prevention and detection\nsuggestions, and escalate to more invasive actions should evidence of Night Dragon\nactivity or compromise be found.\n\nThese actions are based on information available as of February 18, 2011, and while they\noffer good suggestions to detect and combat Night Dragon, they provide no guarantee that\na targeted attack against your systems would be unsuccessful. If you have not already\ndone so, take this opportunity to establish a reporting relationship with ICS CERT and\nNERC’s ES-ISAC for real-time sharing of any new information on this attack set such as\nadditional C&C servers, updated search strings, new variants, etc.\n\nEntities should also closely monitor their relevant security vendors for signature updates\nand detection and removal tools. Some of these measures are invasive and could create\nproblems with operational systems. It is important to understand your technology\nenvironment and the impact these tools could have on operational systems prior to any\ndeployment.\n\n# Primary Protection and Discovery Measures\n\nThe following three actions are important first steps in detecting and preventing known\nNight Dragon activity.\n\n1. Apply access control restrictions on all perimeter devices.\n\na. Modify email blacklists and firewall Access Control Lists ACLs to deny, log\nand alert on traffic to/from the following primary domains used by the known\nC&C servers. And, according to McAfee[1] all four domains have been used\n\nfrequently by other Malware so blocking them may be warranted regardless.\n\ni. is-a-chef.com\n\nii. thruhere.net\n\niii. office-on-the.net\n\n1 [http://www.mcafee.com/us/about/night-dragon.aspx?cid=WBB009](http://www.mcafee.com/us/about/night-dragon.aspx?cid=WBB009)\n\nNight Dragon\n\n\n-----\n\niv. selfip.com.\n\nb. Modify Intrusion Detection Systems (IDS), Intrusion Prevention Systems\n(IPS), and other deep-packet inspection tools to detect and alert on network\ntraffic associated with Night Dragon activity. If detected, validate as malicious\nand consider blocking the traffic in addition to triggering an alert:\n\ni. Each communication packet between compromised hosts and the\nC&C servers are signed with a plain text signature of “hW$.” (Or\n“\\x68\\x57\\x24\\x13”) at the byte offset 0x0C within the TCP packet.\n\nii. Backdoor beacon, identified by a 5-second interval with an initial\npacket with the pattern: “\\x01\\x50[\\x00-\\xff]+\\x68\\x57\\x24\\x13.”\n\niii. Beacon acknowledgement with the pattern: “\\x02\\x60[\\x00\\xff]+\\x68\\x57\\x24\\x13.”\n\niv. Periodic heartbeat or keep-alive signal with the pattern:\n“\\x03\\x50[\\x00-\\xff]+\\x68\\x57\\x24\\x13.”\n\nv. Plaintext password exchange with the pattern: “\\x03\\x50[\\x00\\xff]+\\x68\\x57\\x24\\x13.”\n\nc. Open source IDS signatures have been made available on a number of open\nsource websites and added to open source rule sets. Some commercially\navailable IDS / IPS signatures have also been updated to include Night\nDragon detection.\n\ni. CISCO specific information can be found here:\n\n_[http://tools.cisco.com/security/center/viewIpsSignature.x?signatureId=33819&signatureSubId=0](http://tools.cisco.com/security/center/viewIpsSignature.x?signatureId=33819&signatureSubId=0)_\n\nii. SNORT specific information can be found here:\n\n_[http://www.snort.org/vrt/docs/ruleset_changelogs/2_9_0_4/changes-2011-02-10.html](http://www.snort.org/vrt/docs/ruleset_changelogs/2_9_0_4/changes-2011-02-10.html)_\n\nd. Identify and examine any hosts generating suspected Night Dragon traffic\nand take necessary action to respond and recover.\n\ne. Maintain vigil for additions to Night Dragon’s C&C server and signature lists\nand quickly update your defenses accordingly.\n\n2. While there is no “patch” for Night Dragon, as a preventative measure ensure that\nsecurity patches on all servers are up to date, especially for external-facing web\nservers as they are primary attack vectors.\n\n3. Conduct keyword searches or “greps” of current and archived perimeter logs\nlooking for signs of traffic to/from the known C&C servers (e.g. “find ‘is-a-chef.com’”\nor “grep 'is-a-chef.com' /logfilename”). Examine both ICS and corporate network\nperimeter logs and as far back as possible to the dates recommended by the\nMacAfee whitepaper.\n\n# Secondary Protection Measures\n\nNight Dragon\n\n\n-----\n\nFor entities wishing to pursue a more vigorous course of action or if entities discover\nevidence of Night Dragon activity or compromises using the previous steps, the following\nactions may be useful in helping to determine compromises at the host level.\n\n1. Review any systems/networks with trust relationships and analyze the active\ncommunications paths from those assets.\n\n2. Run host-based automatic detection tools capable of discovering related Malware\non all hosts. Examples of free tools include _[Stinger and the Night Dragon](http://www.mcafee.com/us/downloads/free-tools/stinger.aspx)_\n_[Vulnerability Scanner, available at](http://www.mcafee.com/us/downloads/free-tools/night-dragon-vulnerability.aspx)_ [http://www.mcafee.com/us/downloads/free-](http://www.mcafee.com/us/downloads/free-tools/index.aspx)\n[tools/index.aspx](http://www.mcafee.com/us/downloads/free-tools/index.aspx)\n\n3. Search systems for the following command and control programs and eliminate as\napplicable:\n\n**Filename** **MD5 Checksum**\n\nShell.exe 093640a69c8eafbc60343bf9cd1d3ad3\n\nzwShell.exe 18801e3e7083bc2928a275e212a5590e\n\nzwShell.exe 85df6b3e2c1a4c6ce20fc8080e0b53e9\n\n4. A Trojan dropper, which is a delivery mechanism for malware, is commonly used in\nNight Dragon attacks. It is usually executed through a PSEXEC or an RDP session\nand may leave valuable forensic information in system event logs. When executed,\nthe dropper creates a temporary file that is reflected in Windows update logs\n(“KB*.log” files in “C:\\Windows”). This temporary file may have limited usefulness,\nas it may disappear if a backdoor is successfully opened. Its lack of existence\ndoesn’t guarantee a system is free of infection.\n\n5. A Trojan backdoor may exist as a DLL usually located in the %System%\\System32\nor %System%\\SysWow64 directory. This DLL is a system or hidden file, 19 KB to\n23 KB in size, and includes an XOR-encoded data section that is defined by the\nC&C application when the dropper is created. It includes the network service\nidentifier, registry service key, service description, mutex name, C&C server\naddress, port, and dropper temporary file name. The backdoor may operate from\nany configured TCP port.\n\n6. Two potential Trojan backdoors:\n\n**Filename** **MD5 Checksum**\n\nstartup.dll A6CBA73405C77FEDEAF4722AD7D35D60\n\nconnect.dll 6E31CCA77255F9CDE228A2DB9E2A3855\n\n7. And finally, if compromises are suspected or discovered, work closely with your\noperating system and application vendors to ensure safe and complete eradication.\n\nNight Dragon\n\n|Filename|MD5 Checksum|\n|---|---|\n|Shell.exe|093640a69c8eafbc60343bf9cd1d3ad3|\n|zwShell.exe|18801e3e7083bc2928a275e212a5590e|\n|zwShell.exe|85df6b3e2c1a4c6ce20fc8080e0b53e9|\n\n|Filename|MD5 Checksum|\n|---|---|\n|startup.dll|A6CBA73405C77FEDEAF4722AD7D35D60|\n|connect.dll|6E31CCA77255F9CDE228A2DB9E2A3855|\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2011/2011.02.18.Night_Dragon.Specific/Alerts%20DL-2011%20Alerts-A-2011-02-18-01%20Night%20Dragon%20Attachment%201.pdf"
    ],
    "report_names": [
        "Alerts DL-2011 Alerts-A-2011-02-18-01 Night Dragon Attachment 1"
    ],
    "threat_actors": [
        {
            "id": "ea844ee6-eb12-42c0-8426-11395fe81e6f",
            "created_at": "2022-10-25T15:50:23.300796Z",
            "updated_at": "2025-03-27T02:00:55.434471Z",
            "deleted_at": null,
            "main_name": "Night Dragon",
            "aliases": [
                "Night Dragon"
            ],
            "source_name": "MITRE:Night Dragon",
            "tools": [
                "at",
                "gsecdump",
                "zwShell",
                "PsExec",
                "ASPXSpy",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "09a8f8fe-e907-47b4-8709-a97717dde3cc",
            "created_at": "2022-10-25T16:07:23.90252Z",
            "updated_at": "2025-03-27T02:02:10.020919Z",
            "deleted_at": null,
            "main_name": "Night Dragon",
            "aliases": [],
            "source_name": "ETDA:Night Dragon",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Cain & Abel",
                "gsecdump",
                "zwShell"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "020794ec-7315-47de-818c-2032c362fd15",
            "created_at": "2023-01-06T13:46:38.306576Z",
            "updated_at": "2025-03-27T02:00:02.800515Z",
            "deleted_at": null,
            "main_name": "Night Dragon",
            "aliases": [
                "G0014"
            ],
            "source_name": "MISPGALAXY:Night Dragon",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1719301696,
    "ts_updated_at": 1743041651,
    "ts_creation_date": 1298026694,
    "ts_modification_date": 1302169917,
    "files": {
        "pdf": "https://archive.orkl.eu/171b1c463aeea22759e3e9ea4c8feac1ef337731.pdf",
        "text": "https://archive.orkl.eu/171b1c463aeea22759e3e9ea4c8feac1ef337731.txt",
        "img": "https://archive.orkl.eu/171b1c463aeea22759e3e9ea4c8feac1ef337731.jpg"
    }
}