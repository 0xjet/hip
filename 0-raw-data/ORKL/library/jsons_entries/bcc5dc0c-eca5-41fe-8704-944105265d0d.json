{
    "id": "bcc5dc0c-eca5-41fe-8704-944105265d0d",
    "created_at": "2023-01-12T15:06:13.047063Z",
    "updated_at": "2025-03-27T02:05:45.13042Z",
    "deleted_at": null,
    "sha1_hash": "3cf7bd1720e03f066242119bd716845442326258",
    "title": "2019-01-02 - Analysis of Neutrino Bot Sample (dated 2018-08-27)",
    "authors": "",
    "file_creation_date": "2022-05-28T17:43:12Z",
    "file_modification_date": "2022-05-28T17:43:12Z",
    "file_size": 1623651,
    "plain_text": "# Analysis of Neutrino Bot Sample (dated 2018-08-27)\n\n**[peppermalware.com/2019/01/analysis-of-neutrino-bot-sample-2018-08-27.html](http://www.peppermalware.com/2019/01/analysis-of-neutrino-bot-sample-2018-08-27.html)**\n\nIn this post I analyze a Neutrino Bot sample. It was probably generated 2018-08-27. I will\ncompare the analyzed Neutrino sample with the NukeBot's source code that was leaked on\nspring, 2017, and I will check that Neutrino Bot is probably an evolution (or, at least, it reuses\nparts) of the [NukeBot leaked code.](https://github.com/p3pperp0tts/malware-leaked-sources-1/tree/master/TinyNuke)\n\n**Original Packed Sample:** [3F77B24C569600E73F9C112B9E7BE43F](https://www.hybrid-analysis.com/sample/13000a0da5fc8da437e70649fe39802cce240bf1529b6ab7ce3c273a592eb615)\n**Automatic Generated Report:** [PepperMalware Report](https://sandbox.peppermalware.com/publicreport/?filter=3f77b24c569600e73f9c112b9e7be43f&action=showpdf)\n**Virustotal First Submission: 2018-08-28 14:36:26**\n**Sample Creation Date: 2018-08-27**\n**Unpacked Banker Module:** [896609A8EE8CC860C2214FCD1E3CF264](https://www.hybrid-analysis.com/sample/fbc59d467919dd07a343f59e0e8718610fb663a08bb373d6a04bf0b70b073f82)\n**Internal executable id: aug27**\n**Related links:**\n\n[https://www.malware-traffic-analysis.net/2018/08/21/index2.html](https://www.malware-traffic-analysis.net/2018/08/21/index2.html)\n[https://twitter.com/malware_traffic/status/1032066941953945600](https://twitter.com/malware_traffic/status/1032066941953945600)\nhttps://blog.malwarebytes.com/threat-analysis/2017/02/new-neutrino-bot-comesin-a-protective-loader/\n[https://securelist.com/jimmy-nukebot-from-neutrino-with-love/81667/](https://securelist.com/jimmy-nukebot-from-neutrino-with-love/81667/)\n\n## Analysis\n\n1. Loader\n\n1.1. First stage packer\n1.2. Second stage, custom packer / injector\n1.2.1. Antidebug Tricks\n1.2.1.1. Antidebug tricks: API Obfuscation\n\n\n-----\n\n1.2.1.2. Antidebug tricks: Time Tricks\n1.2.1.3. Antidebug tricks: HKCU\\Software\\Microsoft\\Windows\\Identifier\n1.2.1.3. Antidebug tricks: CPUID checks\n1.2.1.4. Antidebug tricks: Walk running processes searching for wellknown names\n1.2.1.5. Antidebug tricks: Walk own process' modules searching for wellknown\nnames\n1.2.1.6. Antidebug tricks: IsDebuggerPresent / CheckRemoteDebuggerPresent\n1.2.2. Injection\n1.2.3. Other details\n1.2.3.1. BotId and mutex\n1.2.3.2. PRNG\n2. Banker module\n\n2.1. WebInjects\n2.2. Browser hooks\n2.3. Other stealer capabilities\n3. Similarities with NukeBot leaked source code\n\n3.1. InjectDll function at banker module\n3.2. Hollow-process explorer.exe\n3.3. Random BotId\n4. Yara rules\n5. Conclussions\n\n### 1. Loader\n\n**1.1. First stage packer**\n\nIn the first stage, the sample is packed with an usual packer that allocates a memory block\nwhere it copies a shellcode that decrypts a second stage code, and that second stage code\nis overwritten over the original PE in memory.\n\n\n-----\n\n**1.2. Second stage, custom packer / injector**\n\nThis second stage is an executable that is unpacked over the original executable in memory.\nThis second stage perfoms some antidebug tricks such as VM detection and API calls\nobfuscation. In addition, it decrypts the third stage PE: the main banking code, and it injects\nthis third stage PE to explorer.exe process.\n\n1.2.1. Antidebug Tricks\nThe analyzed sample performs a somo usual antidebug tricks. From analyzed sample (IDA\ndecompiled):\n\n1.2.1.1. Antidebug tricks: API Obfuscation\n\nIn the Neutrino Bot loader, each time a API is going to be called, it is got from a hash.\n\n\n-----\n\nIt seems to be using a custom hash algorithm, not crc32 or similar well-known algorithm\n(frequently used by other malware families).\n\n1.2.1.2. Antidebug tricks: Time Tricks\n\nThe analyzed sample plays with GetTickCount and waits (Sleep and WaitForSingleObject),\nperforming usual tricks to detect that it is running into a VM. From analyzed sample (IDA\ndecompiled):\n\n1.2.1.3. Antidebug tricks: HKCU\\Software\\Microsoft\\Windows\\Identifier\n\nThe analyzed sample checks the key: HKCU\\Software\\Microsoft\\Windows value: Identifier, it\n[hashs the content of that value with Fowler–Noll–Vo hash algorithm and it compares the](https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function)\nhash with 0xC9C8F009. I don't know exactly what content would match this hash, but\nprobably it matchs an specified content for some wellknown VMs (virtualbox, vmware, ...).\nFrom analyzed sample (IDA decompiled):\n\n\n-----\n\n1.2.1.3. Antidebug tricks: CPUID checks\n\nThe analyzed sample executes cpuid instruction to get cpu information, then it calculates a\nfowler-noll-vo hash with the information returned by cpuid, and compares that hash with a set\nof values: 0x3A72221D, 0xB609E57D, 0x11482F93, 0xA7C9423F, 0x7816EDDD,\n0x6361F34. I don't know exactly the original data causing these hashes, but probably they\nare values returned by cpuid related to wellknown VMs such as vmware, virtualbox, etc...\nFrom analyzed sample (IDA decompiled):\n\n\n-----\n\n1.2.1.4. Antidebug tricks: Walk running processes searching for wellknown process's names\n\nThe analyzed sample calls toolhelp32's functions to walk running processes. Again, it\ncalculates the fowler-noll-vo hash foreach process name and compares against a set of\nprecalculated hashes: 0x4FAEA2EB, 0x689ED848, 0x57337435, 0xE8BC3AB9,\n0x3C30BBA6, 0xA421254D, 0x26638D6A, 0xE3449C1. These hashes probably correspond\nto names such as vmtoolsd.exe and other well known processes associated to VMs and\nsecurity products.From analyzed sample (IDA decompiled):\n\n\n-----\n\n1.2.1.5. Antidebug tricks: Walk own process' modules searching for wellknown module'\nnames\n\nIn addition, it walks the modules of the current process searching for wellknown libraries\nsuch as SbieDll.dll, etc... It compares the fowler-noll-vo hash of each module's name with the\nfollowing set of hashes: 0xCC23DB0E, 0xCCFE57BB, 0x9FECD578, 0xE69D9465,\n0xC55CC270, 0x601CDCE9, 0x9DF7C709, 0x23E9F2F5, 0x70E2598E, 0x2C82D8A,\n0x99CC8618, 0xB62000C5. From analyzed sample (IDA decompiled):\n\n\n-----\n\n1.2.1.6. Antidebug tricks: IsDebuggerPresent / CheckRemoteDebuggerPresent\n\nNot necesary explanation, usual antidebug checks:\n\n\n-----\n\n1.2.1.7. Antidebug tricks: Query device' names\n\nThe analyzed sample calls QueryDosDeviceW to get a list of devices, and calculates the\nfowler-noll-vo hash foreach name, and then compares each name with a set of values:\n0x5C86B533, 0x7F65B61C, 0x464768AD, 0x9A781952. It tries to detect VM's common\ndevices, such as vmci or HGFS. From analyzed sample (IDA decompiled):\n\n1.2.2. Injection\n\nThe analyzed sample decrypts the third stage PE (the banking module) by using the RC4\nalgorithm + decompression. It creates an explorer.exe instance, and it will inject the\ndecrypted PE into the address space of that explorer.exe instance (hollow process). From\nanalyzed sample (IDA decompiled):\n\n\n-----\n\n1.2.3. Other details\n\n1.2.3.1. BotId and mutex\nThe analyzed sample contains a kind of executable id, and the name of the mutex is created\nbased on that executable id. In the case of the analyzed sample this exe id is \"aug27\",\nprobably the date that it was generated (the virustotal first analysis date is 2018/08/28). From\nanalyzed sample (IDA decompiled):\n\nA fowler-noll-vo hash is calculated from the string \"aug27\". Later, it uses the calculated hash\nto initialize a PRNG (based on idum=1664525*idum+1013904223) to generate a random\nguid, that will be the name of the created mutex. From analyzed sample (IDA decompiled):\n\n\n-----\n\n1.2.3.2. PRNG\nFrom analyzed sample (IDA decompiled):\n\n\n-----\n\n### 2. Banker module\n\nThe third stage is the banker module. You can find the unpacked banker module's dll that I\n[unpacked here. It is quite similar to](https://www.hybrid-analysis.com/sample/fbc59d467919dd07a343f59e0e8718610fb663a08bb373d6a04bf0b70b073f82) [this other dll that was extracted by](https://www.hybrid-analysis.com/sample/5d27da308eb6d494b656d67cbaded6a183e45823a7d9430e86573bd38011f3f4?environmentId=100) [@james_in_the_box](https://twitter.com/james_inthe_box)\n(you can read about at twitter, [here) from a sample shared by @malware_traffic,](https://twitter.com/malware_traffic/status/1032066941953945600) [here.](https://www.malware-traffic-analysis.net/2018/08/21/index2.html)\n\n[This is a list of strings of the Neutrino Bot unpacked banker module.](https://pastebin.com/xctbmghM)\n\n**2.1. WebInjects**\n\nThe banker module performs webinjects. The following parts of code manage the\ndownloaded injects (IDA decompiled):\n\n\n-----\n\n**2.2. Browser hooks**\n\nIt performs hooks at frequently targetted nss3 and wininet APIs at browsers.\n\nNss3 hooks (IDA decompiled):\n\nWininet hooks (IDA decompiled):\n\n\n-----\n\n**2.3. Other stealer capabilities**\n\nOther strings found into the banker module reveal additional stealer capabilities:\n\n### 3. Similarities with NukeBot leaked source\n\nComparing some parts of the NukeBot code that was leaked on spring 2017 with the\ndisassembled/decompiled code of the analyzed sample, we can check that there are\nsimilarities between them. Probably Neutrino Bot is an evolution or, at least, it reused code\nfrom NukeBot leaked code.\n\nIn this section, I comment about some parts of code where I found similarities, but probably,\nthere are other parts of code that are very similar too.\n\n**3.1. InjectDll function at banker module**\n\nInjectDll is a function that appears in NukeBot leaked code and Neutrino Banker module.You\ncan find the full code of both functions here:\n\n[InjectDll source code from NukeBot leaked source: https://pastebin.com/LL9PnVb6](https://pastebin.com/LL9PnVb6)\n\n\n-----\n\nInjectDll decompiled code from Neutrino Bot analyzed\n[sample: https://pastebin.com/K4cfUq4C](https://pastebin.com/K4cfUq4C)\n\nComparing both codes, we can check both functions are almost identical between NukeBot\nleaked source code and Neutrino analyzed sample. Probably this part of code was reused.\n\n**3.2. Hollow-process explorer.exe**\n\nThe following parts of code from the neutrino and nukebot loader get the path of\nexplorer.exe, create an instance of the process, and inject it (hollow process).\n\n\n-----\n\nFrom NukeBot leaked source code:\n\nFrom Neutrino analyzed sample's loader (IDA decompiled):\n\nThe code used to inject processes is quite similar between the leaked source code and the\nanalyzed version:\n\nFrom Nukebot leaked source code:\n\nFrom Neutrino analyzed sample's loader (IDA decompiled):\n\n\n-----\n\n**3.3. Random BotId**\n\nBoth, leaked NukeBot and Neutrino, generate a random GUID that is used as botid and to\ncreate a mutex that the malware uses to know it is already running.\n\nFrom NukeBot leaked code:\n\nRandom GUID is used to create the mutex:\n\n\n-----\n\nFrom Neutrino analyzed sample (IDA decompiled):\n\nRandom GUID is used to create the mutex:\n\n### 4. Yara rules\n\n\n-----\n\nBanker module:\n```\nrule jimmy_08_2018 {\nstrings:\n    $string1 = \"reg add HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\n/ve /t REG_SZ /d \\\"%ls\\\" /f\" wide\n    $string2 = \"Rundll32.exe SHELL32.DLL,ShellExec_RunDLL \\\"cmd.exe\\\" \\\"/c %ls\\\"\"\nwide\n    $string3 = \"Rundll32.exe SHELL32.DLL,ShellExec_RunDLL \\\"%ls\\\"\" wide\n    $string4 = \"Rundll32.exe url.dll,FileProtocolHandler \\\"%ls\\\"\" wide\n    $string5 = \"Rundll32.exe zipfldr.dll,RouteTheCall \\\"%ls\\\"\" wide\n    $string6 = \"/a /c %s\" wide\n    $string7 = \"%ls_%ls_DLL\" wide\n    $string8 = \"Cookie: %s=%s;uid=%ls\"\n    $string9 = \"%ls\\\\nss3.dll\" wide\n    $injects1 = \"injects\"\n    $injects2 = \"set_host\"\n    $injects3 = \"set_path\"\n    $injects4 = \"inject_setting\"\n    $injects5 = \"data_keyword\"\n    $injects6 = \"inject_before_keyword\"\n    $injects7 = \"inject_after_keyword\"\ncondition:\n    (all of them)\n}\n\n```\nPacker stage 2:\n```\nrule neutrino_packer_stage2_08_2018 {\nstrings:\n $code1 = { 6A 25 [0-15] 6A 6C [0-15] 6A 73 [0-15] 6A 5C [0-15] 6A 2A [0-15] 6A 25\n[0-15] 6A 6C [0-15] 6A 73 [0-15] 6A 5C [0-15] 6A 25 [0-15] 6A 6C [0-15] 6A 73 }\n $code2 = { 6A 65 [0-15] 6A 78 [0-15] 6A 70 [0-15] 6A 6C [0-15] 6A 6F [0-15] 6A 72\n[0-15] 6A 72 [0-15] 6A 2E [0-15] 6A 78 }\n $code3 = { 6A 6B [0-15] 6A 65 [0-15] 6A 72 [0-15] 6A 6E [0-15] 6A 65 [0-15] 6A 6C\n[0-15] 6A 33 [0-15] 6A 32 [0-15] 6A 2E [0-15] 6A 64 [0-15] 6A 6C }\n $code4 = { 6A 25 [0-15] 6A 6C [0-15] 6A 73 [0-15] 6A 5C [0-15] 6A 25 [0-15] 6A 6C\n[0-15] 6A 73 }\ncondition:\n all of them\n}\n\n```\n\n-----\n\n### 5. Conclussions\n\nWe have analyzed a Neutrino Bot sample dated 2018/08/27. After analyzing the sample\n(3F77B24C569600E73F9C112B9E7BE43F), we have checked it could be an evolution (or at\nleast, could be using parts) of the leaked NukeBot source code's loader. Nukebot /\nJimmyNukebot / NeutrinoBot / ... Probably, this set of families share code between them and\nare in continuous development.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-01-02 - Analysis of Neutrino Bot Sample (dated 2018-08-27).pdf"
    ],
    "report_names": [
        "2019-01-02 - Analysis of Neutrino Bot Sample (dated 2018-08-27).pdf"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2c7ecb0e-337c-478f-95d4-7dbe9ba44c39",
            "created_at": "2022-10-25T16:07:23.690871Z",
            "updated_at": "2025-03-27T02:02:09.921431Z",
            "deleted_at": null,
            "main_name": "Goblin Panda",
            "aliases": [
                "1937CN",
                "Conimes",
                "Cycldek",
                "Goblin Panda"
            ],
            "source_name": "ETDA:Goblin Panda",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "BackDoor-FBZT!52D84425CDF2",
                "BlueCore",
                "BrowsingHistoryView",
                "ChromePass",
                "CoreLoader",
                "Custom HDoor",
                "Destroy RAT",
                "DestroyRAT",
                "DropPhone",
                "FoundCore",
                "HDoor",
                "HTTPTunnel",
                "JsonCookies",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "NBTscan",
                "NewCore RAT",
                "PlugX",
                "ProcDump",
                "PsExec",
                "QCRat",
                "RainyDay",
                "RedCore",
                "RedDelta",
                "RoyalRoad",
                "Sisfader",
                "Sisfader RAT",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trojan.Win32.Staser.ytq",
                "USBCulprit",
                "Win32/Zegost.BW",
                "Xamtrav",
                "ZeGhost",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7d553b83-a7b2-431f-9bc9-08da59f3c4ea",
            "created_at": "2023-01-06T13:46:39.444946Z",
            "updated_at": "2025-03-27T02:00:03.093712Z",
            "deleted_at": null,
            "main_name": "GOBLIN PANDA",
            "aliases": [
                "Conimes",
                "Cycldek"
            ],
            "source_name": "MISPGALAXY:GOBLIN PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535973,
    "ts_updated_at": 1743041145,
    "ts_creation_date": 1653759792,
    "ts_modification_date": 1653759792,
    "files": {
        "pdf": "https://archive.orkl.eu/3cf7bd1720e03f066242119bd716845442326258.pdf",
        "text": "https://archive.orkl.eu/3cf7bd1720e03f066242119bd716845442326258.txt",
        "img": "https://archive.orkl.eu/3cf7bd1720e03f066242119bd716845442326258.jpg"
    }
}