{
    "id": "ec9b4220-5c6c-4708-8945-f65b0d352441",
    "created_at": "2023-01-12T15:02:08.66455Z",
    "updated_at": "2025-03-27T02:06:14.661543Z",
    "deleted_at": null,
    "sha1_hash": "83c3abccbdf0831d0d78c7e925312dda9b680539",
    "title": "2020-07-08 - How to unpack Chinoxy backdoor and decipher the configuration of the backdoor",
    "authors": "",
    "file_creation_date": "2022-05-28T05:10:17Z",
    "file_modification_date": "2022-05-28T05:10:17Z",
    "file_size": 623552,
    "plain_text": "# How to unpack Chinoxy backdoor and decipher the configuration of the backdoor\n\n**medium.com/@Sebdraven/how-to-unpack-chinoxy-backdoor-and-decipher-the-configuration-of-the-backdoor-**\n4ffd98ca2a02\n\nSebdraven July 8, 2020\n\n[Sebdraven](https://medium.com/?source=post_page-----4ffd98ca2a02--------------------------------)\n\nJul 8, 2020\n\n\n3 min read\n\nIn my last article on Chinoxy backdoor, this version has its configuration in a resource called\nNNKK and it is deciphered. The purpose of this article is to explain the unpacking and\ndeciphering of the configuration of this backdoor.\n\nThe backdoor is loading with the program confax.exe, a utility of Logitech for the Bluetooth.\n\nThe function called by confax.exe is LGBT_Launch.\n\nIn checking this function,\n\n\n-----\n\nThe entry of the thread is pointed by the address DAT_10011fe0. this address is in the\nsection .bss. This section has rwx and the entropy is very high.\n\nBefore the unpack, there are not a call with the function using this resource.\n\nAnd at the address DAT_10011fe0, there is just data without code.\n\nSo the unpack procedure is using the entrypoint of the backdoor, and the code is executing\nwhen confax.exe load LBTServ.dll.\n\nThe entrypoint of the dll, the function interesting is FUN_10007800.\n\nthe code call the function 10007770 with two parameters: an handle on the dll and the key\nhceqhqn of the xor.\n\n\n-----\n\nIn this function, the xor is at the end of the function after manipulating the the\n&DAT_1001a7dc for a copy.\n\nthe xor function is located at 10007730.\n\nAnd after the function, if the dll is dumped. We found the good function of the thread and the\nfunction manipulating the resource.\n\n\n-----\n\nSo we check the function 10005c50 using this resource called by the thread.\n\nIn this function, the ressource is locked and two keys are catching:\n\nThe keys are just top of the resource of TYPELIB.\n\n\n-----\n\nAnd the deciphered function is the function 10005bf0.\n\nthe param1 is the pointer on the resource and the param 2 the number of the step for the\nloop deciphering.\n\n[In python, the algorithm is the following. with the RatDecoders, we found the resource](https://github.com/kevthehermit/RATDecoders)\n\nfrom malwareconfig import fileparser\n\nimport binascii\n\nrsc = file info pe resource by name(‘NNKK’)\n\n\n-----\n\nkey_1= b 369698565690\nkey_2= b’221359875650'\n\nres=b’’.join([chr((key_1[i%12] ^ key_2[i%12]) & 0x27 ^ key_1[i%12] ^ rsc[i]).encode() for i in\nrange(0,0x1300)])\n\nres.replace(b’\\x00',b’’).replace(b’0',b’’)\n\nwe have like result:\n```\nb'\\x0f0\\xc2\\xb7\\xc2\\x99\\x03YnJh0bmRzLm05ld3N00LmRuc20Fici5j0b206Mz0AxMHxi0cmFuZH0MubmV\n 0Group000005300000001.000000000006604893880000000000'\n\n```\nwith a little cleaning, and base64 ninja, we have the result.\n\nbrands.newst.dnsabr.com:3010|brands.newst.dnsabr.com:3010|ru.mst.dnscloud.net:3010|\n\nThis IOCs has been already done.\n\n## Conclusion\n\nthe purpose of this article is to explain to unpack quickly the Chinoxy backdoor and retrieve\nthe configuration without reverse the backdoor.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-08 - How to unpack Chinoxy backdoor and decipher the configuration of the backdoor.pdf"
    ],
    "report_names": [
        "2020-07-08 - How to unpack Chinoxy backdoor and decipher the configuration of the backdoor.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535728,
    "ts_updated_at": 1743041174,
    "ts_creation_date": 1653714617,
    "ts_modification_date": 1653714617,
    "files": {
        "pdf": "https://archive.orkl.eu/83c3abccbdf0831d0d78c7e925312dda9b680539.pdf",
        "text": "https://archive.orkl.eu/83c3abccbdf0831d0d78c7e925312dda9b680539.txt",
        "img": "https://archive.orkl.eu/83c3abccbdf0831d0d78c7e925312dda9b680539.jpg"
    }
}