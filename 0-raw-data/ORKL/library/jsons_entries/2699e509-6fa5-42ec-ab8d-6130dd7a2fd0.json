{
    "id": "2699e509-6fa5-42ec-ab8d-6130dd7a2fd0",
    "created_at": "2022-10-25T16:48:19.916144Z",
    "updated_at": "2025-03-27T02:08:33.381442Z",
    "deleted_at": null,
    "sha1_hash": "50be553c398b512ddd9741a0ab0350dccd600a3b",
    "title": "Secret Malware In European Union Attack Linked To U.S. And British Intelligence",
    "authors": "The Intercept",
    "file_creation_date": "2014-11-25T17:32:48Z",
    "file_modification_date": "2014-11-25T17:32:48Z",
    "file_size": 496208,
    "plain_text": "Complex malware known as Regin is the suspected technology behind sophisticated cyberattacks conducted by U.S. and British intelligence agencies on the\n\nEuropean Union and a Belgian telecommunications company, according to security industry sources and technical analysis conducted by The Intercept.\n\nRegin was found on infected internal computer systems and email servers at Belgacom, a partly state-owned Belgian phone and internet provider, following\n\nreports last year that the company was targeted in a top-secret surveillance operation carried out by British spy agency Government Communications\n\nHeadquarters, industry sources told The Intercept.\n\nThe malware, which steals data from infected systems and disguises itself as legitimate Microsoft software, has also been identified on the same European Union\n\ncomputer systems that were targeted for surveillance by the National Security Agency.\n\nThe hacking operations against Belgacom and the European Union were first revealed last year through documents leaked by NSA whistleblower Edward\n\nSnowden. The specific malware used in the attacks has never been disclosed, however.\n\n[The Regin malware, whose existence was first reported by the security firm Symantec on Sunday, is among the most sophisticated ever discovered by researchers.](http://www.symantec.com/connect/blogs/regin-top-tier-espionage-tool-enables-stealthy-surveillance)\n\nSymantec compared Regin to Stuxnet, a state-sponsored malware program developed by the U.S. and Israel to sabotage computers at an Iranian nuclear facility.\n\nSources familiar with internal investigations at Belgacom and the European Union have confirmed to The Intercept that the Regin malware was found on their\n\nsystems after they were compromised, linking the spy tool to the secret GCHQ and NSA operations.\n\n[Ronald Prins, a security expert whose company Fox IT was hired to remove the malware from Belgacom’s networks, told The Intercept that it was “the most](https://www.fox-it.com/en/)\n\nsophisticated malware” he had ever studied.\n\n“Having analyzed this malware and looked at the [previously published] Snowden documents,” Prins said, “I’m convinced Regin is used by British and American\n\nintelligence services.”\n\nA spokesman for Belgacom declined to comment specifically about the Regin revelations, but said that the company had shared “every element about the attack”\n\nwith a federal prosecutor in Belgium who is conducting a criminal investigation into the intrusion. “It’s impossible for us to comment on this,” said Jan Margot, a\n\nspokesman for Belgacom. “It’s always been clear to us the malware was highly sophisticated, but ever since the clean-up this whole story belongs to the past for\n\nus.”\n\nIn a hacking mission codenamed Operation Socialist, GCHQ gained access to Belgacom’s internal systems in 2010 by targeting engineers at the company. The\n\n[agency secretly installed so-called malware “implants” on the employees’ computers by sending their internet connection to a fake LinkedIn page. The malicious](http://www.spiegel.de/international/world/ghcq-targets-engineers-with-fake-linkedin-pages-a-932821.html)\n\nLinkedIn page launched a malware attack, infecting the employees’ computers and giving the spies total control of their systems, allowing GCHQ to get deep\n\ninside Belgacom’s networks to steal data.\n\nThe implants allowed GCHQ to conduct surveillance of internal Belgacom company communications and gave British spies the ability to gather data from the\n\ncompany’s network and customers, which include the European Commission, the European Parliament, and the European Council. The software implants used in\n\nthis case were part of the suite of malware now known as Regin.\n\nOne of the keys to Regin is its stealth: To avoid detection and frustrate analysis, malware used in such operations frequently adhere to a modular design. This\n\ninvolves the deployment of the malware in stages, making it more difficult to analyze and mitigating certain risks of being caught.\n\nBased on an analysis of the malware samples, Regin appears to have been developed over the course of more than a decade; The Intercept has identified traces of\n\n[its components dating back as far as 2003. Regin was mentioned at a recent Hack.lu conference in Luxembourg, and Symantec’s report on Sunday said the](http://2014.hack.lu/archive/2014/hacklu-joker-presentation.pdf)\n\n\n-----\n\n[The use of hacking techniques and malware in state-sponsored espionage has been publicly](http://www.washingtonpost.com/wp-dyn/content/article/2010/01/13/AR2010011300359.html) [documented over the last few years: China has been linked to extensive](http://www.nytimes.com/2013/02/19/technology/chinas-army-is-seen-as-tied-to-hacking-against-us.html?pagewanted=all)\n\n[cyber espionage, and recently the Russian government was also alleged to have been behind a cyber attack on the White House. Regin further demonstrates that](http://www.theatlantic.com/politics/archive/2014/10/white-house-hacked/382063/)\n\nWestern intelligence agencies are also involved in covert cyberespionage.\n\nGCHQ declined to comment for this story. The agency issued its standard response to inquiries, saying that “it is longstanding policy that we do not comment on\n\nintelligence matters” and “all of GCHQ’s work is carried out in accordance with a strict legal and policy framework, which ensures that our activities are\n\nauthorised, necessary and proportionate.”\n\nThe NSA said in a statement, “We are not going to comment on The Intercept’s speculation.”\n\n_The Intercept has obtained samples of the malware from sources in the security community and is making it available for public download in an effort to_\n\n[encourage further research and analysis. (To download the malware, click here. The file is encrypted; to access it on your machine use the password “infected.”)](https://s3.amazonaws.com/tiregin/regin.zip)\n\nWhat follows is a brief technical analysis of Regin conducted by The Intercept’s computer security staff. Regin is an extremely complex, multi-faceted piece of\n\nwork and this is by no means a definitive analysis.\n\nIn the coming weeks, The Intercept will publish more details about Regin and the infiltration of Belgacom as part of an investigation in partnership with Belgian\n\n[and Dutch newspapers De Standaard and NRC Handelsblad.](http://www.standaard.be/cnt/dmf20141124_01393276)\n\n## Origin of Regin\n\nIn Nordic mythology, the name Regin is associated with a violent dwarf who is corrupted by greed. It is unclear how the Regin malware first got its name, but the\n\nname appeared for the first time on the VirusTotal website on March 9[th] 2011.\n\n_[Der Spiegel reported that, according to Snowden documents, the computer networks of the European Union were infiltrated by the NSA in the months before the](http://www.spiegel.de/international/europe/nsa-spied-on-european-union-offices-a-908590.html)_\n\nfirst discovery of Regin.\n\nIndustry sources familiar with the European Parliament intrusion told The Intercept that such attacks were conducted through the use of Regin and provided\n\nsamples of its code. This discovery, the sources said, may have been what brought Regin to the wider attention of security vendors.\n\n[Also on March 9[th] 2011, Microsoft added related entries to its Malware Encyclopedia:](http://www.microsoft.com/security/portal/threat/encyclopedia/entry.aspx?name=Trojan%3AWinNT%2FRegin.A#tab=1)\n\n_Alert level: Severe_\n\n_First detected by definition: 1.99.894.0_\n\n_Latest detected by definition: 1.173.2181.0 and higher_\n\n_First detected on: Mar 09, 2011_\n\n_This entry was first published on: Mar 09, 2011_\n\n_This entry was updated on: Not available_\n\n[Two more variants of Regin have been added to the Encyclopedia, Regin.B and Regin.C. Microsoft appears to detect the 64-bit variants of Regin as Prax.A and](http://www.microsoft.com/security/portal/threat/encyclopedia/entry.aspx?Name=Trojan%3AWinNT%2FRegin.gen!B)\n\nPrax.B. None of the Regin/Prax entries are provided with any sort of summary or technical information.\n\nThe following Regin components have been identified:\n\n**Loaders**\n\nThe first stage are drivers which act as loaders for a second stage. They have an encrypted block which points to the location of the 2[nd] stage payload. On NTFS,\n\nthat is an Extended Attribute Stream; on FAT, they use the registry to store the body. When started, this stage simply loads and executes Stage 2.\n\nThe Regin loaders that are disguised as Microsoft drivers with names such as:\n\n_serial.sys_\n\n_cdaudio.sys_\n\n_atdisk.sys_\n\n_parclass.sys_\n\n_usbclass.sys_\n\n\n-----\n\n**g**\n\nWhen launched, it cleans traces of the initial loader, loads the next part of the toolkit and monitors its execution. On failure, Stage 2 is able to disinfect the\n\ncompromised device. The malware zeroes out its PE (Portable Executable, the Windows executable format) headers in memory, replacing “MZ” with its own magic\n\nmarker 0xfedcbafe.\n\n**Orchestrator**\n\nThis component consists of a service orchestrator working in Windows’ kernel. It initializes the core components of the architecture and loads the next parts of the\n\nmalware.\n\n**Information Harvesters**\n\nThis stage is composed of a service orchestrator located in user land, provided with many modules which are loaded dynamically as needed. These modules can\n\ninclude data collectors, a self-defense engine which detects if attempts to detect the toolkit occur, functionality for encrypted communications, network capture\n\nprograms, and remote controllers of different kinds.\n\n**Stealth Implant**\n\n_The Intercept’s investigation revealed a sample uploaded on VirusTotal on March 14th 2012 that presents the unique 0xfedcbafe header, which is a sign that it_\n\nmight have been loaded by a Regin driver and it appears to provide stealth functionality for the tool kit.\n\n_This picture shows the very first bytes of the sample in question, showing the unique 0xfedcbafe header at the beginning._\n\nIn order to access information stored in the computer’s memory, programs use objects that reference specific locations in memory called pointers. This binary file\n\ncontains some of such pointers initialized, which corroborates the hypothesis that the file was dumped from memory during a forensic analysis of a compromised\n\nsystem.\n\nThe sample has the following SHA256 hash:\n\n_fe1419e9dde6d479bd7cda27edd39fafdab2668d498931931a2769b370727129_\n\nThis sample gives a sense of the sophistication of the actors and the length of the precautions they have been taking in order to operate as stealthily as possible.\n\nWhen a Windows kernel driver needs to allocate memory to store some type of data, it creates so called kernel pools. Such memory allocations have specific\n\nheaders and tags that are used to identify the type of objects contained within the block. For example such tags could be Proc, Thrd or File, which respectively\n\nindicate that the given block would contain a process, thread or file object structure.\n\nWhen performing forensic analysis of a computer’s memory, it is common to use a technique called pool scanning to parse the kernel memory, enumerate such\n\n_kernel pools, identify the type of content and extract it._\n\nJust like Regin loader drivers, this driver repeatedly uses the generic “Ddk “ tag with ExAllocatePoolWithTag() when allocating all kernel pools:\n\n\n-----\n\n_This picture shows the use of the “ddk “ tag when allocating memory with the Windows ExAllocatePoolWIthTag() function._\n\nThe generic tag which is used throughout the operating system when a proper tag is not specified. This makes it more difficult for forensic analysts to find any\n\nuseful information when doing pool scanning, since all its memory allocations will mix with many generic others.\n\nIn addition, when freeing memory using ExFreePool(), the driver zeroes the content, probably to avoid leaving traces in pool memory.\n\nThe driver also contains routines to check for specific builds of the Windows kernel in use, including very old versions such as for Windows NT4 Terminal Server\n\nand Windows 2000, and then adapts its behavior accordingly.\n\nWindows kernel drivers operate on different levels of priority, from the lowest PASSIVE_LEVEL to the highest HIGH_LEVEL. This level is used by the processor\n\nto know what service give execution priority to and to make sure that the system doesn’t try to allocate used resources which could result in a crash.\n\nThis Regin driver recurrently checks that the current IRQL (Interrupt Request Level) is set to PASSIVE_LEVEL using the KeGetCurrentIrql() function in many\n\nparts of the code, probably in order to operate as silently as possible and to prevent possible IRQL confusion. This technique is another example of the level of\n\nprecaution the developers took while designing this malware framework.\n\nUpon execution of the unload routine (located at 0xFDEFA04A), the driver performs a long sequence of steps to remove remaining traces and artifacts.\n\n## Belgacom Sample\n\n[In an interview given to the Belgian magazine MondiaalNiews, Fabrice Clément, head of security of Belgacom, said that the company first identified the attack on](http://www.mo.be/interview/belgacom-blikt-terug-op-spionage-affaire)\n\nJune 21, 2013.\n\nIn the same interview Clément says that the computers targeted by the attackers included staff workstations as well as email servers.\n\nThese statements confirm the timing and techniques used in the attack.\n\n[From previously identified Regin samples, The Intercept developed unique signatures which could identify this toolkit. A zip archive with a sample identified as](https://www.virustotal.com/en/file/4d6cebe37861ace885aa00046e2769b500084cc79750d2bf8c1e290a1c42aaff/analysis/)\n\nRegin/Prax was found in VirusTotal, a free, online website which allows people to submit files to be scanned by several anti-virus products. The zip archive was\n\nsubmitted on 2013-06-21 07:58:37 UTC from Belgium, the date identified by Clément. Sources familiar with the Belgacom intrusion told The Intercept that this\n\nsample was uploaded by a systems administrator at the company, who discovered the malware and uploaded it in an attempt to research what type of malware it\n\nwas.\n\nThe archive contains:\n\n\n-----\n\nThe malware in question is “0001000000000C1C_svcsstat.exe_sample ”. This is a 64bit variant of the first stage Regin loader aforementioned.\n\nThe archive also contains the output of ProcMon, “Process Monitor”, a system monitoring tool distributed by Microsoft and commonly used in forensics and\n\nintrusion analysis.\n\nThis file identifies the infected system and provides a variety of interesting information about the network. For instance:\n\n_USERDNSDOMAIN=BGC.NET_\n\n_USERDOMAIN=BELGACOM_\n\n_USERNAME=id051897a_\n\n_USERPROFILE=C:\\Users\\id051897a_\n\nThe following environment variable shows that the system was provided with a Microsoft SQL server and a Microsoft Exchange server, indicating that it might one\n\nof the compromised corporate mail server Fabrice Clément mentioned to Mondiaal News:\n\n_Path=C:\\Program_\n\n_Files\\Legato\\nsr\\bin;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Program_\n\n_Files\\Microsoft Network Monitor 3\\;C:\\Program Files\\System Center Operations Manager 2007\\;c:\\Program Files (x86)\\Microsoft SQL_\n\n_Server\\90\\Tools\\binn\\;D:\\Program Files\\Microsoft\\Exchange Server\\bin_\n\n[Below is a list of hashes for the files The Intercept is making available for download. Given that that it has been over a year since the Belgacom operation was](https://s3.amazonaws.com/tiregin/regin.zip)\n\npublicly outed, The Intercept considers it likely that the GCHQ/NSA has replaced their toolkit and no current operations will be affected by the publication of\n\nthese samples.\n\n## Regin Samples\n\n**32-bit Loaders**\n\n20831e820af5f41353b5afab659f2ad42ec6df5d9692448872f3ed8bbb40ab92\n\n7553d4a5914af58b23a9e0ce6a262cd230ed8bb2c30da3d42d26b295f9144ab7\n\nf89549fc84a8d0f8617841c6aa4bb1678ea2b6081c1f7f74ab1aebd4db4176e4\n\nfd92fd7d0f925ccc0b4cbb6b402e8b99b64fa6a4636d985d78e5507bd4cfecef\n\n225e9596de85ca7b1025d6e444f6a01aa6507feef213f4d2e20da9e7d5d8e430\n\n9cd5127ef31da0e8a4e36292f2af5a9ec1de3b294da367d7c05786fe2d5de44f\n\nb12c7d57507286bbbe36d7acf9b34c22c96606ffd904e3c23008399a4a50c047\n\nf1d903251db466d35533c28e3c032b7212aa43c8d64ddf8c5521b43031e69e1e\n\n4e39bc95e35323ab586d740725a1c8cbcde01fe453f7c4cac7cced9a26e42cc9\n\na0d82c3730bc41e267711480c8009883d1412b68977ab175421eabc34e4ef355\n\na7493fac96345a989b1a03772444075754a2ef11daa22a7600466adc1f69a669\n\n5001793790939009355ba841610412e0f8d60ef5461f2ea272ccf4fd4c83b823\n\na6603f27c42648a857b8a1cbf301ed4f0877be75627f6bbe99c0bfd9dc4adb35\n\n8d7be9ed64811ea7986d788a75cbc4ca166702c6ff68c33873270d7c6597f5db\n\n40c46bcab9acc0d6d235491c01a66d4c6f35d884c19c6f410901af6d1e33513b\n\ndf77132b5c192bd8d2d26b1ebb19853cf03b01d38afd5d382ce77e0d7219c18c\n\n7d38eb24cf5644e090e45d5efa923aff0e69a600fb0ab627e8929bb485243926\n\na7e3ad8ea7edf1ca10b0e5b0d976675c3016e5933219f97e94900dea0d470abe\n\na0e3c52a2c99c39b70155a9115a6c74ea79f8a68111190faa45a8fd1e50f8880\n\nd42300fea6eddcb2f65ffec9e179e46d87d91affad55510279ecbb0250d7fdff\n\n5c81cf8262f9a8b0e100d2a220f7119e54edfc10c4fb906ab7848a015cd12d90\n\nb755ed82c908d92043d4ec3723611c6c5a7c162e78ac8065eb77993447368fce\n\nc0cf8e008fbfa0cb2c61d968057b4a077d62f64d7320769982d28107db370513\n\ncca1850725f278587845cd19cbdf3dceb6f65790d11df950f17c5ff6beb18601\n\necd7de3387b64b7dab9a7fb52e8aa65cb7ec9193f8eac6a7d79407a6a932ef69\n\ne1ba03a10a40aab909b2ba58dcdfd378b4d264f1f4a554b669797bbb8c8ac902\n\n\n-----\n\n8389b0d3fb28a5f525742ca2bf80a81cf264c806f99ef684052439d6856bc7e7\n\n**32-bit Rootkit**\n\nfe1419e9dde6d479bd7cda27edd39fafdab2668d498931931a2769b370727129\n\n**32-bit Orchestrator**\n\ne420d0cf7a7983f78f5a15e6cb460e93c7603683ae6c41b27bf7f2fa34b2d935\n\n4139149552b0322f2c5c993abccc0f0d1b38db4476189a9f9901ac0d57a656be\n\n**64-bit Loader (Belgacom)**\n\n4d6cebe37861ace885aa00046e2769b500084cc79750d2bf8c1e290a1c42aaff\n\n_Photo credit: Winfried Rothermel/AP_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/qpegircfwykf835shpflarf87ah2438x",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.11.24.Regin_TheIntercept/Regin_The_Intercept.pdf"
    ],
    "report_names": [
        "Regis_The_Intercept",
        "Regin_The_Intercept"
    ],
    "threat_actors": [
        {
            "id": "5d2bd376-fcdc-4c6a-bc2c-17ebbb5b81a4",
            "created_at": "2022-10-25T16:07:23.667223Z",
            "updated_at": "2025-03-27T02:02:09.916086Z",
            "deleted_at": null,
            "main_name": "GCHQ",
            "aliases": [
                "Government Communications Headquarters",
                "Operation Socialist"
            ],
            "source_name": "ETDA:GCHQ",
            "tools": [
                "Prax",
                "Regin",
                "WarriorPride"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041313,
    "ts_creation_date": 1416936768,
    "ts_modification_date": 1416936768,
    "files": {
        "pdf": "https://archive.orkl.eu/50be553c398b512ddd9741a0ab0350dccd600a3b.pdf",
        "text": "https://archive.orkl.eu/50be553c398b512ddd9741a0ab0350dccd600a3b.txt",
        "img": "https://archive.orkl.eu/50be553c398b512ddd9741a0ab0350dccd600a3b.jpg"
    }
}