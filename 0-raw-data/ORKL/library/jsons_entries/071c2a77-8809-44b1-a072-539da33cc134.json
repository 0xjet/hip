{
    "id": "071c2a77-8809-44b1-a072-539da33cc134",
    "created_at": "2023-01-12T15:05:07.067151Z",
    "updated_at": "2025-03-27T02:15:11.026658Z",
    "deleted_at": null,
    "sha1_hash": "0c5ffb2bd3e6a5b4cb1571db6d2f0df056b5cf5c",
    "title": "2022-03-31 - State-sponsored Attack Groups Capitalise on Russia-Ukraine War for Cyber Espionage",
    "authors": "",
    "file_creation_date": "2022-05-28T18:15:49Z",
    "file_modification_date": "2022-05-28T18:15:49Z",
    "file_size": 2614697,
    "plain_text": "# State-sponsored Attack Groups Capitalise on Russia- Ukraine War for Cyber Espionage\n\n**[research.checkpoint.com/2022/state-sponsored-attack-groups-capitalise-on-russia-ukraine-war-for-cyber-espionage/](https://research.checkpoint.com/2022/state-sponsored-attack-groups-capitalise-on-russia-ukraine-war-for-cyber-espionage/)**\n\nMarch 31, 2022\n\nMarch 31, 2022\n\n## Introduction\n\nGeopolitical tensions often make headlines and present a golden opportunity for threat\nactors to exploit the situation, especially those targeting high-profile victims. In the past\nmonth while the Russian invasion of Ukraine was unfolding, Check Point Research (CPR)\nhas observed advanced persistent threat (APT) groups around the world launching new\ncampaigns, or quickly adapting ongoing ones to target victims with spear-phishing emails\nusing the war as a lure. The attackers use decoys ranging from official-looking documents to\nnews articles or even job postings, depending on the targets and region. Many of these lure\ndocuments utilize malicious macros or template injection to gain an initial foothold into the\ntargeted organizations, and then launch malware attacks.\n\nThe use of the conflict as a bait is not limited to a specific region or APT group, it goes from\nLatin America to the Middle East and to Asia. In this article, CPR will provide an overview of\nseveral campaigns by different APT groups using the ongoing Russia-Ukraine war to\n\n\n-----\n\nincrease the efficiency of their campaigns. CPR will discuss the victimology of these\ncampaigns; the tactics used, and provide technical analysis of the observed malicious\npayloads and malware. Below are the campaigns identified and profiled in this article:\n\n**APT Name** **APT Origin** **Targeted Sector** **Targeted Countries**\n\n\nEl Machete Spanish-speaking\nCountry\n\n\nFinancial, Governmental\n\n\nNicaragua,\nVenezuela\n\n\nLyceum Iran Energy Israel, Saudi Arabia\n\nSideWinder Possibly India Unknown Pakistan\n\n## Latin America: El Machete APT\n\n**Targets: Financial and governmental sectors**\n\nKaspersky first publicly disclosed El Machete, a Spanish-speaking threat actor that focuses\non Latin American’s targets, [in 2014 with the group’s activity dating back to 2010. The](https://securelist.com/el-machete/66108/)\ngroup’s activities have persisted throughout the years, adopting the practice of using\ngovernment-themed documents as decoys, as well as using lures related to the current\npolitical situation.\n\nIn mid-March, El Machete was spotted sending spear-phishing emails to financial\norganizations in Nicaragua, with an attached Word document titled “Dark plans of the neo**[Nazi regime in Ukraine.” The document contained an article written and published by](https://www.el19digital.com/articulos/ver/titulo:126145-planes-oscuros-del-regimen-neonazi-de-ucrania)**\nAlexander Khokholikov, the Russian Ambassador to Nicaragua that discussed the RussoUkrainian conflict from the perspective of the Kremlin.\n\n\n-----\n\n_Figure 1 – Lure document that contains an article about the Russia-Ukraine conflict, sent by_\n_El Machete APT to Nicaraguan financial institutions._\n\n### Infection chain\n\n\n-----\n\nThe malicious macro inside the document drops a base64-encoded file named\n```\n~djXsfwEFYETE.txt, uses the built-in certutil.exe to decode it to ~djXsfwEFYETE.vbe, an\n\n```\nencoded VBScript file. The macro then launches the `wscript.exe to execute the .vbe file,`\nwhose primary objective is to execute `msiexec.exe with a remotely hosted .msi file titled`\n```\nAdobe.msi, which masquerades itself as Adobe software.\n\n```\n_Figure 2 – Schema of the main components of the infection chain._\n\nThe `Adobe.msi installer initially installs malware-related files to a subfolder in the user’s`\nTEMP directory. Later, the malware copies itself from the TEMP directory to a working\ndirectory `C:\\ProgramData\\PD, which is set as hidden to make sure users do not see it`\nwhen they open the ProgramData folder in File Explorer. The malware is primarily written in\nPython, and comes with two different Python interpreters that also masquerade as\nexecutables related to Adobe, `AdobeReaderUpdate.exe and` `ReaderSetting.exe . The`\nmalware sets up persistence via a scheduled task that runs every 5 minutes, pretending to\nbe an update task for Adobe Reader named `UpdateAdobeReader . The task executes the`\n```\nAdobeReaderUpdate script, a customized version of the open-source Loki.Rat which has\n\n```\n[been used by the El Machete APT group in an ongoing campaign since 2020.](https://www.accenture.com/us-en/blogs/cyber-defense/machete-adopts-lokirat-toolset)\n\n### C&C communication\n\nThe malware does not have a hardcoded C&C server address. Instead, it relies on a file\ncalled `license.dll, which contains a Base64-encoded URL to a BlogSpot webpage. This`\npage seemingly contains security-related content and discuses asymmetric encryption.\nHowever, embedded inside the BlogSpot page is another base64 string that contains the\nencoded C&C URL that the malware will eventually use. To find the relevant URL, the\nmalware knows to search between two hardcoded strings that are 6-7 characters long. They\ntend to follow the pattern of `/AAAA/ and` `*AAAA/, where the AAAA represents a 4-5-letter`\nstring.\n\n\n-----\n\n_Figure 3 – BlogSpot page used by Adobe.msi. The C&C server is encoded between /noul/_\n_and *noul/._\n\nThis method of retrieving the C&C servers has several advantages. Foremost, it easily\nallows the attacker to make the initial connection look innocuous by connecting to a\n[subdomain of a known and seemingly benign server (blogspot.com). In addition, the](https://blogspot.com/)\nattackers can switch C&C infrastructure very easily without having to redeploy new code to\nthe victims’ machines.\n\nThe data is submitted to the C&C server in a somewhat obfuscated but consistent JSON\nformat:\n\n\n-----\n\n```\n{\n    \"nu8\": \"<hostname-username>\",\n    \"d4\": \"<tag>\",\n    \"r88\": \"<module name/data type>\",\n    \"m77\": \"<file path>.pgp\",\n    \"ns32\": \"<payload>\",\n    \"submit\": \"submit\"\n}\n\n```\nThe tag in the d4 field used by the Adobe malware is `Utopiya_Nyusha_Maksim, which El`\n[Machete has used since 2020.](https://www.accenture.com/us-en/blogs/cyber-defense/machete-adopts-lokirat-toolset)\n\n### The Loki.Rat Backdoor\n\nEach of the Python script files is obfuscated using base64 encoding. However, once\ndecoded from base64, the code is relatively straightforward, only with few minor variable\nname obfuscation.\n\n\n-----\n\n_Figure 4 – Deobfuscated AdobeReaderUpdate script._\n\nMalware capabilities include:\n\nKeylogging – The keylogger runs as a separate process and script: the\n```\n   ReaderSetting.exe Python interpreter is used to run a separate file called\n   SearchAdobeReader .\n\n```\n\n-----\n\nCollect credentials stored in Chrome and Firefox browsers.\nUpload and download files.\nCollect information about the files on each drive – collect file names and file sizes for all\nthe files with the extensions from the list: `.doc, .docx, .pdf, .xlsx, .xls, .ppt,`\n```\n   .pptx, .jpg, .jpeg, .rar, .zip, .odt, .ott, .odm, .ods, .ots, .odp.\n\n```\nexcept excluded (system, temp) folders.\nTake screenshots.\nCollect clipboard data.\nExecute commands.\n\n### Commands and payloads\n\nThe actors first send several commands to understand if the infected machine is interesting\nenough to proceed: these commands perform screenshots, keylogging, and listing files on\nthe system. If deemed worthwhile, the actors execute a command to download and install\nanother malware, `JavaOracle.msi, via` `msiexec.exe .`\n\nSimilar to `Adobe.msi,` `JavaOracle.msi installs a Python-based malware and uses`\nscheduled tasks for persistence. However, the Python scripts are not based on the Loki.Rat\nbackdoor, although they offer some similar functionality through the modules placed in the\ndirectory `Libs\\site-packages\\Java . The malware was observed launching multiple`\nPython interpreters in parallel, each one running a different module. The Python executables\nare disguised as `JavaHosts.exe,` `JavaExt.exe and` `JavaAdd.exe, and the actors also`\nuse these Python “clones” to check if a certain script/module is running, based on the\nprocess name. The modules include the following capabilities:\n\nDownload a payload from the C&C server ( GAME module) – The code implies that the\npayload is expected to be either a .exe or a .msi file. The payload is written to the\ndirectory `C:\\ProgramData\\ControlD\\, which it sets as a folder with system and`\nhidden attributes.\nKeylogger ( TIME module) – This is similar to the one that came with the Adobe.msi\npayload, but it never writes to disk. Instead, it posts the keylogger data directly to the\nC&C server.\n```\n   BOX module – This iterates over files in the system and uploads files of interest that\n\n```\nare less than 5 MB, encoded as base64. The module first checks connectivity by\n[opening a TCP socket to google.es. If the site is not accessible, the script exits.](https://google.es/)\nScreenshot ( LIST module) – The module saves screenshots to `-shopt.png inside`\na directory masquerading as Microsoft, namely\n```\n   %APPDATA%\\Microsoft\\ControlDesktop\\ . It then uploads the screenshot to the\n\n```\nC&C server and proceeds to delete all PNG files in this directory. Similar to BOX, it\n[initially checks that it can open a TCP socket to google.ru. If it fails, the script exits.](https://google.ru/)\n\n\n-----\n\nClipboard stealer ( SCAN module) – Posts the data directly to the C&C server, without\nwriting the data to disk. Before doing so, it checks that it can open a TCP connection to\n[google.ru.](https://google.ru/)\n\nThe malware from the `JavaOracle.msi file seems to be using a new hardcoded tag,`\n```\nFoo_Fighters_Everlong . The timing appears to be coincidental, as the payload was first\n\n```\nseen a few days before the news that Foo Fighters drummer Taylor Hawkins died.\n\n_Figure 5 – JavaOracle code steals the clipboard contents and posts the data to the C&C with_\n_a custom tag._\n\n### Targets and goals\n\nAlthough the specific email trap targeted a financial institution in Nicaragua, multiple artifacts\nsuggest that this is part of a larger campaign, which is also targeting government entities in\nVenezuela. Judging by the activities that the actors perform in the infected networks, the\npurpose of the whole campaign is deemed a cyberespionage operation, consistent with the\n\n\n-----\n\npreviously disclosed activity by the same attack group. This indicates that El Machete APT\ngroup continues to operate with slightly changing TTPs, even after researchers published\ntechnical descriptions and indicators of compromise for the malware used by the group.\n\n## Middle East: Lyceum\n\n**Targets: Energy sector**\n\nBelieved to be active since 2017, Lyceum is an Iranian APT group active in the Middle East\nand Africa, and is known to target sectors of strategic national importance to carry out cyber\nespionage. Mid March, an Israeli energy company received an email from the address\n```\n[email protected][.]com with the subject “Russian war crimes in Ukraine”. The email\n\n```\ncontained a few pictures taken from public media sources and contained a link to an article\nhosted on the `news-spot[.]live domain:`\n\n_Figure 6 – Lure email utilizing the Russia-Ukraine conflict theme sent by Lyceum group_\n\n\n-----\n\n[The link in the email leads to a document that contains the article Researchers gather](https://www.theguardian.com/world/2022/mar/02/researchers-gather-evidence-of-possible-russian-war-crimes-in-ukraine)\nevidence of possible Russian war crimes in Ukraine” published by The Guardian:\n\n\n-----\n\n_Figure 7 – Lure document that contains The Guardian article on possible Russian war crimes_\n_in Ukraine._\n\nThe same domain hosts a few more malicious documents related to the Russia and Russia[Ukraine conflict, such as a copy of an article by The Atlantic Council from 2020 on Russian](https://www.atlanticcouncil.org/in-depth-research-reports/issue-brief/russias-exotic-nuclear-weapons-and-implications-for-the-united-states-and-nato/)\nnuclear weapons, and a job posting for the “Extraction / Protective Agent” agent in Ukraine:\n\n_Figure 8 – Russia-Ukraine war-related decoy documents used by the Lyceum APT group._\n\n### Infection chain\n\nThe malicious Office document executes a macro code when the document is closed. The\nmacro deobfuscates an executable embedded in the document and saves it to the\n```\n%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\ directory. By using\n\n```\nthis method, the payload isn’t executed directly by the Office document, but it will run the\nnext time the computer is restarted.\n\nAs part of the wider Lyceum campaign, we also observed different executable droppers.\nThese are executables bearing PDF icons, not documents:\n\n\n-----\n\n_Figure 9 – Two variants of Lyceum infection chain: lures related to the RU-UA conflict (top)_\n_and to Iran (bottom)._\n\nAll the executables are written slightly differently but the main idea is the same: first, the\ndropper extracts a lure PDF file embedded as a resource and opens it, in the background\nand unnoticed by a victim, the dropper then downloads and executes the payload. We\nidentified three categories of droppers:\n\n**.NET DNS dropper – Used to drop the .NET DNS backdoor (discussed later):**\n\n_Figure 10 – The .NET dropper opens the decoy PDF and downloads the payload._\n\n\n-----\n\n**.NET TCP Dropper – Drops the .NET HTTP backdoor variant, and adds a scheduled**\ntask to run it.\n**Golang Dropper – Drops the Golang backdoor to the** `Startup folder and the`\n```\n   Public\\Downloads folder. In addition, it drops a PDF file (a report about the Iranian\n\n```\ncyber threat, similar to the other droppers) to the `Public\\Downloads folder and`\nexecutes it. After the PDF report is opened, the dropper finally executes the Golang\nbackdoor from `Public\\Downloads folder.`\n\n_Figure 11 – Code snippet of the Golang dropper, which drops a Golang backdoor and a PDF_\n_report titled “Iranian Cyber Threat”._\n\nThe dropped files can be downloaded from the internet, or extracted from the dropper itself,\ndepending on the sample.\n\n### Payloads\n\nEach dropper bring its own type of payload. We observed the following backdoors deployed:\n\n**.NET DNS Backdoor**\n\n\n-----\n\nThe .NET DNS backdoor is a modified version of a tool called DnsDig, with code added to\nform frm1 that uses [HeijdenDNS and DnsDig capabilities.](https://github.com/ghuntley/Heijden.Dns)\n\n_Figure 12 – Original DnsDig tool (left) vs Modified DnsDig (added frm1)._\n\nThe backdoor uses DNS tunneling to communicate with its C&C server, and is able to\ndownload/upload files and execute commands.\n\n**.NET TCP Backdoor**\n\nThe backdoor communicates with the C&C using raw TCP sockets, and it implements its\nown communication protocol on top of this. Each sample contains a configuration that\ndefines how it should communicate with the C&C, including separator characters, TCP ports\nand mapping of command types to numbers:\n\n\n-----\n\n_Figure 13 – Configuration snippet of the .NET TCP backdoor._\n\nAlthough the malware contains a configuration for the C&C communication, it still uses\nhardcoded values in the code itself, instead of the configuration constants. This indicates that\nthe malware might still be under active development.\n\nThe capabilities of this backdoor include:\n\nExecute commands.\nTake screenshots.\nList files/directories.\nList installed applications.\nUpload/download/execute files.\n\n**Golang HTTP Backdoor**\n\n\n-----\n\nThe execution of the HTTP backdoor, written in Golang, consists of 3 stages, that occur in a\nloop:\n\n**Stage 1 – Connectivity check. The malware generates a unique ID for the victim, based on**\nthe MD5 hash of the username. It then sends an empty HTTP POST request to the URI\n```\n/GO/1.php of the C&C server. If the server responds with OK, the backdoor continues to\n\n```\nthe next stage.\n\n**Stage 2 – Victim registration. In this step, the malware sends basic details of the victim in a**\nPOST request to the URI `/GO/2.php, to register the victim in the attacker’s C&C server.`\n\n**Stage 3** **–** **Commands retrieval and execution. First, the malware sends HTTP POST**\nrequests to the URI `/GO/3.php to get commands for execution. Like the other backdoors`\nwe described, the backdoor supports commands that allow it to download/upload files and\nexecute shell commands.\n\n\n-----\n\n_Figure 14 – Network traffic of the Golang HTTP backdoor, per execution stage_\n\n### Attribution and victimology\n\nIn addition to targets in the Israeli energy sector, when hunting for the files and infrastructure\nrelated to this attack, CPR observed some artifacts uploaded to VirusTotal (VT) from Saudi\nArabia. Although these artifacts contain traps related to Iran, the other documents found on\nthe relevant infrastructure suggest that the group might have used the baits related to the\nRussia-Ukraine war in Saudi Arabia as well, and probably in other countries in the region,\nwhich is the primary focus of the group’s activities\n\n\n-----\n\nAs well as the clear victimology, other indicators that suggest this activity is from the Lyceum\nAPT group include:\n\nUse of Heijden.DNS open-source library, which was [used by Lyceum in their previous](https://malware.news/t/deep-dive-into-the-lyceum-danbot-malware/36216)\nattacks. This time, the actors did not obfuscate the library name but modified a tool\nnamed DnsDig that uses Heijden.DNS.\nDNS tunneling technique in the C&C communication widely used in previous Lyceum\ncampaigns.\n[Overlaps in the infrastructure, such as known Lyceum C&C servers hosted on the](https://www.clearskysec.com/wp-content/uploads/2021/08/Siamesekitten.pdf)\nsame ASN in the same networks with C&C from this campaign, and use of the same\ndomain registrars such as Namecheap.\n[Use of Protonmail email addresses to send the malicious email to their targets or to](https://www.clearskysec.com/wp-content/uploads/2021/08/Siamesekitten.pdf)\nregister the domains.\n\nJudging by the timestamps artifacts found and malicious domains registration, this specific\ncampaign has been running for a few months. The adoption of more relevant lures and\nconstant malware retooling suggests that the Lyceum group will continue to conduct and\nadjust their espionage operations in the Middle East, despite public disclosures.\n\n## South Asia: SideWinder\n\n**Targets: Entities in Pakistan**\n\nSideWinder is a suspected Indian APT group that strongly focuses on Pakistan and China\ngovernment organizations. SideWinder’s malicious document, which also exploit the RussiaUkraine conflict, was uploaded to VT in the middle of March. Judging by its content, the\nintended targets are Pakistani entities; the bait document contains the document of National\nInstitute of Maritime Affairs of Bahria University in Islamabad, and is titled “Focused talk on\nRussian Ukraine Conflict Impact on Pakistan.”\n\n\n-----\n\n_Figure 15 – Decoy document related to Russia-Ukraine war, by Sidewinder APT._\n\n\n-----\n\nThis malicious document uses remote template injection. When it s opened, the document\nretrieves a remote template from an actor-controlled server. The external template that’s\ndownloaded is an RTF file that exploits the CVE-2017-11882 (Equation Editor) vulnerability.\nWhen the vulnerability is exploited, it drops and executes 1.a package, that contains\nobfuscated JavaScript. The Sidewinder campaigns TTPs have not changed in the last few\nyears, so we do not include exact technical details here, as they have been thoroughly\n[described by multiple researchers.](https://cluster25.io/wp-content/uploads/2021/09/a_rattlesnake_in_the_navy.pdf)\n\nHowever, it is worth mentioning that a typical SideWinder APT payload is aaaaa .NET-based\ninfostealer, originally called “SystemApp.dll”, and is capable of gathering system information,\nexfiltrating files from the infected machine and executing commands. The infostealer has\nbeen used with minor modifications in the group’s espionage campaigns since early 2019.\n\n## Conclusion\n\nCPR shared a few examples of APT groups attempting to abuse the interest in the ongoing\nwar between Russia and Ukraine. As some of these campaigns contain previously\nundisclosed technical details or updated malware, CPR researchers included Yara rules in\nthe Appendix, which can assist with threat hunting for these APT campaigns and the tools\nthey utilize.\n\nAlthough the attention of the public does not usually linger on a single issue for an extended\nperiod, the Russian-Ukrainian war is an obvious exception. This war affects multiple regions\naround the world and has potentially far-reaching ramifications. As a result, we can expect\nthat APT threat actors will continue to use this crisis to conduct targeted phishing campaigns\nfor espionage purposes.\n\n## IOCs\n\n**Lyceum APT:**\n\n\n-----\n\n```\n13814a190f61b36aff24d6aa1de56fe2\nf9fd9e32cb04c4fc93e65f48562ecad3\n53542ec51daf61fba2d26fe91b7d701f\nd962dd55fde800d972a156f5c63a6243\n1a5489147a888c4f5f32e97ffcb01733\n9fcad8f97eeae10f7a222eca94cb9a5f\nf8c29040122cf892190bcf3665975d2f\na5dbfd729b6fd64a6c4fd77a3e356989\n8b01dec07856a67db0e0d849bc84fd9e\n23d174e6a0905fd59b2613d5ac106261\na437f997d45bc14e76d0f2482f572a34\nce186cda677f0120cfdb308803b8e8d8\n214011a0d57b1d8238532be4f6414f58\n8d51fbb90ad5942cd1a5a6534bd9d1d7\n6aeca48c9090b301b3fdf9da4382c882\nc41ffcbd933039bb6981d05b4c4c673e\ne03c7e3e8957ede592de07d3dca247b7\nf72768f352994ecce3b9e5109fe93eec\n8199f14502e80581000bd5b3bda250ee\nd79687676d2d152aec4143c852bdbc4a\n2bc2abefc1a721908bc805894b62227d\n37a1514a7a5f9b2c6786096129a30721\n1c444ebeba24dcba8628b7dfe5fec7c6\n85ca334f87667bd7fa0c47ae6149353e\n73bddd5f1a0847ae5f5d55e7d9c177f6\n9fb86915db1b7c00f1a4587de4e052de\n37fe608983d4b06a5549247f0e16bc11\n5916e5189ef0050dfcc3cc19382d08d5\nf3b395661cc663c1baad41b439622071\n8044dc6078b003698d6e1cbbd22a9ea6\nbcb465cc2257e5777bab431690ca5039\nnews-spot[.]live\nnews-spot[.]xyz\ncyberclub[.]one\nscience-news[.]live\nnews-reporter[.]xyz\n104.249.26[.]60\n85.206.175[.]201\n185.243.112[.]136\n\n```\n**El Machete APT:**\n\n\n-----\n\n```\n8e1360cc27e95fc47924d9ba3ef84cb8fa9e142cfd16e1503c5277d0c16ae241\ne2c67e495166be1b97134e67b2326e1b800d3d4d8dba4bc61fd3f8eb3a92d612\ne3718adaca6eafeba6ff171669210cb55a3b8babf3b78072cc513273b99a7639\ned09da9d48afe918f9c7f72fe4466167e2f127a28a7641ba80d6165e82f48431\nb9bf3e9725696331916e32e5936111e1166867b1d2d3ab05e46b9fff8679cf8f\nc6c794348d17d40c544487154ca72e8e6199b670f804ee25d7bcd9ff884d67b1\n7115580f8235a0bbce61e8af79c3ed5cbe46900912eb0765ccaee82213a9275e\n907ccb541d0066d36701310e86e1d2b61448178d1d36f6748af0b3163ca273ac\n7ea7cae7dd6353831359179f4834ac4c2e9022659e205ca8506f372aad63f629\nbb4b04eff1b5154d23b2636fc55222e4f27c654777f348edee47c920e457835e\nebbcc2075fcb0ba18d43475b8454c51b35bb65e1ed323b657ea7d9651e98074d\nda81697353fe3238920a8c2c4cbbf25a298b3e3414f988ece0cf7afb73e3e0a5\n4c22116b68732f8fe9e2fb5e56e9ff798f30805f9008e4f7a4be1e1c830162b8\n65e48c986d185d156999adc762d7bff84ddbf44851419d66c2985a2ccc2e072d\ncaac5087528dde6839481133737de12af973080184b2aa0b2eb35af88875adbb\na5f0af1124f7abf06e712a2bfb4f1104ee0df179343020577959339617db69b3\nca4182fbaf3f02d9b428f7e851d5a679d6dcfceafabb245cff155b48d9c09307\n96b33df5720901b4f2fc6fb810b6eca994fb8b2ff0edc0aa456195a7c9115615\ne27f75c4e4e74bff20270ec0f2bd41a4b54c121bcb811451a67c831dba1e4c03\na26751cde843d44506ccece87d6347ede5071703bfd63fb12f8982eae7aaf3dd\ne60ea877d008e61cb625b4f8b2d712ce9289892f7e799dbb1030301e2db4b0ac\nhxxps://correomindefensagobvemyspace[.]com/kolomenskoye/Adobe.msi\nhxxps://solutionconect[.]online/uu2/x3/JavaOracle.msi\nhxxps://great-jepsen.51-79-62-98[.]plesk[.]page/MKS/w3/Adobe.msi\nhxxps://asymmetricfile.blogspot[.]com\nhxxps://postinfomatico.blogspot[.]com\nhxxp://31.207.44[.]72:8080\nhxxps://Intelligent-archimedes.51-79-62-98[.]plesk[.]page/x3/Uu-3.php\n\n```\n**Sidewinder APT:**\n```\nf765b0b6e4a34eb95c6f0ddf058bc88d5ef9ec2b11a5f3504d1673f4f69aceca\nmaritimepakistan.kpt-pk[.]net\nkpt-pk[.]net\n\n## Appendix – YARA rules\n\n```\n\n-----\n\n```\nrule lyceum_dotnet_dns_backdoor\n{\n  meta:\n    author = \"CPR\"\n    hash1 = \"8199f14502e80581000bd5b3bda250ee\"\n    hash2 = \"d79687676d2d152aec4143c852bdbc4a\"\n    hash3 = \"bcb465cc2257e5777bab431690ca5039\"\n    hash4 = \"2bc2abefc1a721908bc805894b62227d\"\n    hash5 = \"37a1514a7a5f9b2c6786096129a30721\"\n  strings:\n    $log1 = \"MSG SIZE rcvd\" wide\n    $log2 = \"Empty output\" wide\n    $log3 = \"Big Output. lines: \" wide\n    $com1 = \"Enddd\" wide\n    $com2 = \"uploaddd\" wide\n    $com3 = \"downloaddd\" wide\n    $dga = \"trailers.apple.com\" wide\n    $replace1 = \"BackSlashh\" wide\n    $replace2 = \"QuotationMarkk\" wide\n    $re_pattern = \"60\\\\s+IN\\\\s+TXT\" wide\n    $func1 = \"comRun\"\n    $func2 = \"PlaceDot\"\n    $func3 = \"sendAns\"\n    $heijden1 = \"Heijden.DNS\"\n    $heijden2 = \"DnsHeijden\"\n  condition:\n    uint16(0)==0x5a4d and (all of ($log*) or all of ($com*) or all of ($replace*)\nor all of ($func*) or (any of ($heijden*) and $re_pattern and $dga))\n}\nrule lyceum_dotnet_http_backdoor\n{\n  meta:\n    author = \"CPR\"\n    hash1 = \"1c444ebeba24dcba8628b7dfe5fec7c6\"\n    hash2 = \"85ca334f87667bd7fa0c47ae6149353e\"\n    hash3 = \"73bddd5f1a0847ae5f5d55e7d9c177f6\"\n    hash4 = \"9fb86915db1b7c00f1a4587de4e052de\"\n    hash5 = \"37fe608983d4b06a5549247f0e16bc11\"\n    hash6 = \"5916e5189ef0050dfcc3cc19382d08d5\"\n  strings:\n    $class1 = \"Funcss\"\n    $class2 = \"Constantss\"\n    $class3 = \"Reqss\"\n    $class4 = \"Screenss\"\n    $class5 = \"Shll\"\n    $class6 = \"test_A1\"\n    $class7 = \"Uploadss\"\n    $class8 = \"WebDL\"\n    $cnc_uri1 = \"/upload\" wide\n    $cnc_uri2 = \"/screenshot\" wide\n    $cnc_pattern_hex1 = {43 6f 6e 74 65 6e 74 2d 44 69 73 70 6f 73 69 74 69 6f 6e\n3a 20 66 6f 72 6d 2d 64 61 74 61 3b 20 6e 61 6d 65 3d 22 7b 30 7d 22 0d 0a 0d 0a}\n    $cnc_pattern_hex2 = {6d 75 6c 74 69 70 61 72 74 2f 66 6f 72 6d 2d 64 61 74 61\n3b 20 62 6f 75 6e 64 61 72 79 3d 7b 30 7d}\n\n```\n\n-----\n\n```\n    $cnc_pattern_hex3 {43 6f 6e 74 65 6e 74 2d 44 69 73 70 6f 73 69 74 69 6f 6e\n3a 20 66 6f 72 6d 2d 64 61 74 61 3b 20 6e 61 6d 65 3d 22 7b 30 7d 22 3b 20 66 69 6c\n65 6e 61 6d 65 3d 22 7b 31 7d 22 0d 0a 43 6f 6e 74 65 6e 74 2d 54 79 70 65 3a 20 7b\n32 7d 0d 0a 0d 0a}\n    $constant1 = \"FILE_DIR_SEPARATOR\"\n    $constant2 = \"APPS_PARAMS_SEPARATOR\"\n    $constant3 = \"TYPE_SENDTOKEN\"\n    $constant4 = \"TYPE_DATA1\"\n    $constant5 = \"TYPE_SEND_RESPONSE_IN_SOCKET\"\n    $constant6 = \"TYPE_FILES_LIST\"\n    $constant7 = \"TYPE_FILES_DELETE\"\n    $constant8 = \"TYPE_FILES_RUN\"\n    $constant9 = \"TYPE_FILES_UPLOAD_TO_SERVER\"\n    $constant10 = \"TYPE_FILES_DELETE_FOLDER\"\n    $constant11 = \"TYPE_FILES_CREATE_FOLDER\"\n    $constant12 = \"TYPE_FILES_DOWNLOAD_URL\"\n    $constant13 = \"TYPE_OPEN_CMD\"\n    $constant14 = \"TYPE_CMD_RES\"\n    $constant15 = \"TYPE_CLOSE_CMD\"\n    $constant16 = \"TYPE_CMD_REQ\"\n    $constant17 = \"TYPE_INSTALLED_APPS\"\n    $constant18 = \"TYPE_SCREENSHOT\"\n    $constant19 = \"_RG_APP_NAME_\"\n    $constant20 = \"_RG_APP_VERSION_\"\n    $constant21 = \"_RG_APP_DATE_\"\n    $constant22 = \"_RG_APP_PUB_\"\n    $constant23 = \"_RG_APP_SEP_\"\n    $constant24 = \"_SC_EXT_\"\n  condition:\n    uint16(0)==0x5a4d and (4 of ($class*) or 4 of ($cnc_*) or 4 of ($constant*))\n}\nrule lyceum_golang_backdoor\n{\n  meta:\n    author = \"CPR\"\n    hash1 = \"a437f997d45bc14e76d0f2482f572a34\"\n    hash2 = \"23d174e6a0905fd59b2613d5ac106261\"\n    hash3 = \"bcb465cc2257e5777bab431690ca5039\"\n  strings:\n    $func1 = \"main.Ase256\"\n    $func2 = \"main.DecryptAse256\"\n    $func3 = \"main.IsServerUp\"\n    $func4 = \"main.register\"\n    $func5 = \"main.commandforrun\"\n    $func6 = \"main.UPLOAD\"\n    $func7 = \"main.commandforanswer\"\n    $func8 = \"main.GetMD5Hash\"\n    $func9 = \"main.get_uid\"\n    $func10 = \"main.commandrun\"\n    $func11 = \"main.download\"\n    $func12 = \"main.postFile\"\n    $func13 = \"main.sendAns\"\n    $func14 = \"main.comRun\"\n    $cnc_uri1 = \"/GO/1.php\"\n\n```\n\n-----\n\n```\n    $cnc_uri2 /GO/2.php \n    $cnc_uri3 = \"/GO/3.php\"\n    $auth_token = \"auth_token=\\\"XXXXXXX\\\"\"\n    $log1 = \"client registred\"\n    $log2 = \"no command\"\n    $log3 = \"can not create file\"\n    $log4 = \"errorGettingUserName\"\n    $log5 = \"New record created successfully\"\n    $log6 = \"SERVER_IS_DOWN\"\n    $dga = \"trailers.apple.com.\"\n  condition:\n    uint16(0)==0x5a4d and ((10 of ($func*) or any of ($cnc_uri*) or $auth_token\nor 3 of ($log*)) or ($dga and 4 of them))\n}\nrule ElMachete_doc\n{\n  meta:\n    author = \"CPR\"\n    hash1 = \"8E1360CC27E95FC47924D9BA3EF84CB8FA9E142CFD16E1503C5277D0C16AE241\"\n  strings:\n    $s1 = \"You want to continue with the Document\" ascii\n    $s2 = \"certutil -decode\" ascii\n    $s3 = /C:\\\\ProgramData\\\\.{1,20}\\.txt/\n    $s4 = /C:\\\\ProgramData\\\\.{1,20}\\.vbe/\n  condition:\n    uint16be(0) == 0xD0CF and 2 of ($s*)\n}\nrule ElMachete_msi\n{\n  meta:\n    author = \"CPR\"\n    hash1 = \"ED09DA9D48AFE918F9C7F72FE4466167E2F127A28A7641BA80D6165E82F48431\"\n  strings:\n    $s1 = \"MSI Wrapper (8.0.26.0)\"\n    $s2 = \"Windows Installer XML Toolset (3.11.0.1701)\"\n    $s3 = \"\\\\Lib\\\\site-packages\\\\PIL\\\\\"\n    $s4 = \"\\\\Lib\\\\site-packages\\\\pyHook\\\\\"\n    $s5 = \"\\\\Lib\\\\site-packages\\\\requests\\\\\"\n    $s6 = \"\\\\Lib\\\\site-packages\\\\win32com\\\\\"\n    $s7 = \"\\\\Lib\\\\site-packages\\\\Crypto\\\\\"\n  condition:\n    4 of them\n}\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-31 - State-sponsored Attack Groups Capitalise on Russia-Ukraine War for Cyber Espionage.pdf"
    ],
    "report_names": [
        "2022-03-31 - State-sponsored Attack Groups Capitalise on Russia-Ukraine War for Cyber Espionage.pdf"
    ],
    "threat_actors": [
        {
            "id": "d303c77e-0110-471b-a3a6-37fce9ac848d",
            "created_at": "2022-10-25T15:50:23.342452Z",
            "updated_at": "2025-03-27T02:00:55.447692Z",
            "deleted_at": null,
            "main_name": "Machete",
            "aliases": [
                "APT-C-43",
                "El Machete"
            ],
            "source_name": "MITRE:Machete",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "edc11896-f4f1-4132-9c38-d073ccdcf5b6",
            "created_at": "2022-10-25T16:07:23.576476Z",
            "updated_at": "2025-03-27T02:02:09.873658Z",
            "deleted_at": null,
            "main_name": "El Machete",
            "aliases": [
                "APT-C-43",
                "ATK 97",
                "Operation HpReact",
                "TAG-NS1",
                "TEMP.Andromeda"
            ],
            "source_name": "ETDA:El Machete",
            "tools": [
                "El Machete",
                "ForeIT",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "Pyark"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cde987a8-c71f-49e2-b761-5b7fa2b4ada6",
            "created_at": "2022-10-25T16:07:23.706646Z",
            "updated_at": "2025-03-27T02:02:09.933918Z",
            "deleted_at": null,
            "main_name": "Hexane",
            "aliases": [
                "ATK 120",
                "Cobalt Lyceum",
                "Lyceum",
                "Operation Out to Sea",
                "Siamesekitten",
                "Yellow Dev 9"
            ],
            "source_name": "ETDA:Hexane",
            "tools": [
                "DanBot",
                "DanDrop",
                "Decrypt-RDCMan.ps1",
                "Get-LAPSP.ps1",
                "James",
                "Milan",
                "kl.ps1"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6b9fc913-06c6-4432-8c58-86a3ac614564",
            "created_at": "2022-10-25T16:07:24.185236Z",
            "updated_at": "2025-03-27T02:02:10.135195Z",
            "deleted_at": null,
            "main_name": "SideWinder",
            "aliases": [
                "APT-C-17",
                "APT-Q-39",
                "BabyElephant",
                "GroupA21",
                "HN2",
                "Hardcore Nationalist",
                "Rattlesnake",
                "Razor Tiger",
                "SideWinder",
                "T-APT-04"
            ],
            "source_name": "ETDA:SideWinder",
            "tools": [
                "BroStealer",
                "Capriccio RAT",
                "callCam"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ba4f277c-c3da-45e6-a2fb-4ed556dbae64",
            "created_at": "2023-01-06T13:46:38.605117Z",
            "updated_at": "2025-03-27T02:00:02.871423Z",
            "deleted_at": null,
            "main_name": "El Machete",
            "aliases": [
                "APT-C-43",
                "G0095",
                "machete-apt"
            ],
            "source_name": "MISPGALAXY:El Machete",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "808d8d52-ca06-4a5f-a2c1-e7b1ce986680",
            "created_at": "2022-10-25T16:07:23.899157Z",
            "updated_at": "2025-03-27T02:02:10.019417Z",
            "deleted_at": null,
            "main_name": "NetTraveler",
            "aliases": [
                "APT 21",
                "Hammer Panda",
                "NetTraveler",
                "TEMP.Zhenbao"
            ],
            "source_name": "ETDA:NetTraveler",
            "tools": [
                "Agent.dhwf",
                "Destroy RAT",
                "DestroyRAT",
                "Kaba",
                "Korplug",
                "NetTraveler",
                "Netfile",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TravNet",
                "Xamtrav"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dd583696-3de6-4c23-bfb6-e675a38a7000",
            "created_at": "2022-10-25T16:07:23.338398Z",
            "updated_at": "2025-03-27T02:02:09.744409Z",
            "deleted_at": null,
            "main_name": "APT 20",
            "aliases": [
                "APT 20",
                "APT 8",
                "Crawling Taurus",
                "Operation Wocao",
                "TH3Bug",
                "Violin Panda"
            ],
            "source_name": "ETDA:APT 20",
            "tools": [
                "Agent.dhwf",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Filesnfer",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "KeeThief",
                "Kerberoast",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "PlugX",
                "Poison Ivy",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SMBExec",
                "SPIVY",
                "SharpHound",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "WinRAR",
                "XServer",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a7df240e-6750-4b71-99de-85831b92faa2",
            "created_at": "2022-10-25T15:50:23.859253Z",
            "updated_at": "2025-03-27T02:00:55.546377Z",
            "deleted_at": null,
            "main_name": "HEXANE",
            "aliases": [
                "Lyceum",
                "Siamesekitten",
                "Spirlin"
            ],
            "source_name": "MITRE:HEXANE",
            "tools": [
                "Milan",
                "netstat",
                "BITSAdmin",
                "DnsSystem",
                "DanBot",
                "ipconfig",
                "Mimikatz",
                "Kevin",
                "PoshC2"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "173f1641-36e3-4bce-9834-c5372468b4f7",
            "created_at": "2022-10-25T15:50:23.349637Z",
            "updated_at": "2025-03-27T02:00:55.450857Z",
            "deleted_at": null,
            "main_name": "Sidewinder",
            "aliases": [
                "Sidewinder",
                "T-APT-04"
            ],
            "source_name": "MITRE:Sidewinder",
            "tools": [
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "fb8f3a5f-01a9-498e-9396-52f844424c33",
            "created_at": "2023-01-06T13:46:39.045338Z",
            "updated_at": "2025-03-27T02:00:02.984648Z",
            "deleted_at": null,
            "main_name": "LYCEUM",
            "aliases": [
                "siamesekitten",
                "Chrono Kitten",
                "Storm-0133",
                "COBALT LYCEUM",
                "UNC1530",
                "Spirlin",
                "MYSTICDOME"
            ],
            "source_name": "MISPGALAXY:LYCEUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d0c0a5ea-3066-42a5-846c-b13527f64a3e",
            "created_at": "2023-01-06T13:46:39.080551Z",
            "updated_at": "2025-03-27T02:00:02.992026Z",
            "deleted_at": null,
            "main_name": "RAZOR TIGER",
            "aliases": [
                "SideWinder",
                "APT-C-17",
                "T-APT-04"
            ],
            "source_name": "MISPGALAXY:RAZOR TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "273a41a8-5115-4f55-865f-0960a765f18c",
            "created_at": "2022-10-25T16:07:24.397947Z",
            "updated_at": "2025-03-27T02:02:10.208221Z",
            "deleted_at": null,
            "main_name": "Wicked Spider",
            "aliases": [
                "APT 22",
                "Bronze Export",
                "Bronze Olive",
                "Wicked Spider"
            ],
            "source_name": "ETDA:Wicked Spider",
            "tools": [
                "Agent.dhwf",
                "AngryRebel",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EternalBlue",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "Kaba",
                "Korplug",
                "Moudour",
                "Mydoor",
                "PCRat",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Xamtrav"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535907,
    "ts_updated_at": 1743041711,
    "ts_creation_date": 1653761749,
    "ts_modification_date": 1653761749,
    "files": {
        "pdf": "https://archive.orkl.eu/0c5ffb2bd3e6a5b4cb1571db6d2f0df056b5cf5c.pdf",
        "text": "https://archive.orkl.eu/0c5ffb2bd3e6a5b4cb1571db6d2f0df056b5cf5c.txt",
        "img": "https://archive.orkl.eu/0c5ffb2bd3e6a5b4cb1571db6d2f0df056b5cf5c.jpg"
    }
}