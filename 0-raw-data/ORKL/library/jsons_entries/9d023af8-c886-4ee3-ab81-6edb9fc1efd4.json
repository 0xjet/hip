{
    "id": "9d023af8-c886-4ee3-ab81-6edb9fc1efd4",
    "created_at": "2022-10-25T16:48:15.855517Z",
    "updated_at": "2025-03-27T02:16:09.294649Z",
    "deleted_at": null,
    "sha1_hash": "d2c884f5d1d49194f6688d640bb71dbb50ad332e",
    "title": "Snow abuse and gluttony: Analysis of suspected Lazarus attack activities against Korean companies",
    "authors": "Qianxin",
    "file_creation_date": "2022-04-29T04:39:57Z",
    "file_modification_date": "2022-04-29T04:39:57Z",
    "file_size": 3847588,
    "plain_text": "# Snow Abuse: Analysis of the Suspected Lazarus Attack Activities against South Korean Companies\n\nOriginal red raindrops team [qianxin threat intelligence center](javascript:void(0);) 2022-04-11 00:27\n\n\nincluded in the collection\n\n#东亚地区 8 #APT 59 #Lazarus 4\n\n\n## overview\n\nSpear phishing attacks have long been one of the most convenient ways to get\n\ninto an enterprise network. Spear phishing attacks are often used against large\n\ncorporations, banks, or influencers, and most commonly target high-level employees\n\nwho have access to rich information, or employees in departments that need to open\n\na lot of foreign documents at work. Generally speaking, attack files are macro code\n\nwritten in Microsoft Word or JavaScript code, which are very small, have no\n\nsuperfluous programs built into the files, and whose sole purpose is to download\n\nmore destructive malware on the target object's computer. Once downloaded,\n\nmalware spreads further through the targeted network or is only used to steal all\n\navailable information, helping attackers find targets in the network.\n\nrecently, the red raindrop team of the qianxin threat intelligence center has\n\ncaptured a large number of spear phishing attack samples against south korean\n\ncompanies in the daily threat hunt. it is infected through a vulnerable document or\n\nchm file, and distinguishes the number of bits of the current operating system, and\n\nexecutes macro code corresponding to the number of bits of the system to achieve\n\nthe best attack effect. after research, the characteristics of this attack are as follows:\n\n1. THE INITIAL INFECTED DOCUMENTS ARE DOWNLOADED FOR SUBSEQUENT\n\nEXECUTION USING CVE-2017-0199 REMOTE CODE EXECUTION VULNERABILITY;\n\n2. The subsequent attack uses the UAC Bypass technology of the local RPC\n\ninterface to elevate the privilege;\n\n3. subsequent load packing interference analysis and use simple means to detect\n\nwhether it is in the sandbox;\n\n## sample analysis\n\n### 0x01 decoy file\n\n\n-----\n\nOffice/WordPad remote code execution vulnerability, its vulnerability number is CVE\n2017-0199, and the decoy analysis of the related samples is as follows:\n\nthe bait file induces the victim to click \"enable content\" in a number of ways. for\n\nexample, 긴급재난지원금신청서양식 .docx (emergency disaster assistance request form)\n\ninduces users to click on enable content by displaying garbled file content.\n\n\n-----\n\nThe bait file 대한광산개발(주) .docx (Daehan Mine Development Shares) shows that\n\nthe document was produced by Windows 11, inducing the victim to click on the\n\nenabled content.\n\n\n-----\n\nor fake microsoft's error message, the same purpose is to induce users to click to\n\nenable content.\n\n\n-----\n\n### 0x02 malicious macro\n\nHere, take 통지서 .docx (notification) as an example, click on the execution bait fil\n\ne, access the remote template http://VM2rJOnQ.naveicoipg.online/ACMS/0hUxr3Lx/p\n\nolice0?mid=h1o5cYfJ download execution, and the file downloaded and executed is a\n\ns follows.\n\n\n-----\n\n(32Bit/64Bit) from the outside:\n\nmount page for payload:\n\nthe payload is then decrypted and injected into the winword .exe process.\n\n\n-----\n\n### 0x03 injected code\n\nthe injected code is first anti-sandboxed in the main function.\n\nAt the same time, it will detect whether the currently running process contains v3l\n\n4sp .exe, and if so, exit the program. v3l4sp .exe a subroutine of south Korean AhnLa\n\nb's free antivirus software V3 Lite, indicating that the target of this attack is not for in\n\ndividual users in South Korea.\n\n\n-----\n\nSubsequently, the error .log is released in the %AppData%Local\\Microsoft\\TokenB\n\nroker directory, and \"s/o2ldz9l95itdj2e/error.txt?dl=0\", and the Release RuntimeBroke\n\nr .exe is decrypted in the same directory.\n\nThe UAC Bypass technology of the native RPC interface is then used to perform\n\nthe RuntimeBroker .exe.\n\n\n-----\n\nfinally, it is persisted through the registry startup key.\n\n\n-----\n\nRuntimeBroker .exe interfered with the researchers' analysis by adding a UPX shel\n\nl, and after dehulling, it was found that it also detected the sandbox in the main func\n\ntion, and also detected whether the currently running process contained v3l4sp.exe a\n\nnd AYAgent.aye. AYAgent.aye is part of ALYac, south Korea's Internet security suite, es\n\ntsoft.\n\nVerify whether the currently running program path is a RuntimeBroker .exe in the\n\n%AppData%Local\\Microsoft\\TokenBroker directory, or delete itself if it is not, which is\n\nto evade dynamic detection of the sandbox.\n\n\n-----\n\nIt is then added to windows Defender's exclusion list using the PowerShell\n\ncommand.\n\nRead the contents of the released error .log file and stitch it together with the\n\nURL dl.dropboxusercontent.com of the cloud server Dropbox, so that it acts as an\n\nintermediary to pass the C2 information.\n\n\n-----\n\nThe user information is then uploaded to the hxxp://naveicoipg.online/post2.php\n\nin the specified format \"uid=%s&avtype=%d&avtype=%d&majorv=%d\", where the va\n\nlue of avtype is 1 when no soft kill is specified, 2 when v3l4sp .exe is present, and 3 w\n\nhen AYAgent.aye is present.\n\nSubsequent visits naveicoipg.online's \"/fecommand.acm\" page to get the payload,\n\nwhere uid is the victim ID of the previous callback C2.\n\n\n-----\n\nthe obtained instruction content calls the function sub_401410 executed, and the\n\nmalware maintains an array of structs of size 100 to record the executed instructions.\n\n\n-----\n\nIf the instruction has not been executed before, the calling function sub_401280\n\ndownload the corresponding subsequent payload from C2, download the subsequent\n\nURL format is \"/< instruction name >\", and the obtained content will be executed as\n\na PE file.\n\n\n-----\n\nunfortunately, subsequent content is not available as of the time of analysis.\n\n## traceability and correlation\n\nBy searching the database for the keyword \"fecommand.acm\", we discovered\n\nanother way to spread attack samples, distributed by using CHM files.\n\n\n-----\n\nthe short link in the bait chm file was redirected to the actual website of the\n\nkorean centers for disease control and prevention, which echoed the bait file name,\n\nmaking it easier for the victim to get caught.\n\nAfter comparison, the chmext .exe is basically the same as the above injected cod\n\ne, only C2 is different, chmext .exe C2 is naveicoipc.tech.\n\nIN THE PROCESS OF CONTINUING TO TRACE THE SOURCE, WE ALSO FOUND\n\nPHISHING EMAILS THAT IMPERSONATED THE KOREAN INTERNET INFORMATION\n\nCENTER COMBINED WITH VARIOUS INDICATIONS WE SUSPECT THAT THIS ATTACK IS\n\n\n-----\n\nINDIVIDUAL ORDINARY USER, THE ATTACK METHODS ARE COMPLEX AND\n\nCHANGEABLE, ITS FOLLOW-UP REAL PAYLOAD IS RELATIVELY HIDDEN, AND THE\n\nNUMBER OF ATTACK SAMPLES IS LARGE, AND WE HAVE CAPTURED A LARGE NUMBER\n\nOF ATTACK SAMPLES IN A SHORT PERIOD OF TIME.\n\nCombing through the APT organization targeting South Korea, we found that this\n\nattack is suspected to be from the APT organization Lazarus, as early as a few years a\n\ngo, the Lazarus organization was good at using the cloud server Dropbox to carry out\n\nthe attack, followed by the February malwarebytes labs disclosed Lazarus's report [[1]],\n\nLazarus also created the RuntimeBroker process in the attack process.\n\n\n-----\n\nCoincidentally, in the process of tracing the origin of C2, we found that as early a\n\ns March 25, the foreign security company Rewterz made an early warning of the navei\n\ncoipc.tech domain name [[2]], and the URL link in its warning was basically consistent w\n\nith the sample link we captured earlier.\n\n\n-----\n\n## summary\n\nas of the end of the draft, there are still new attack samples being discovered, whi\n\nch is worth our vigilance!\n\nPHISHING EMAILS HAVE ALWAYS BEEN ONE OF THE IMPORTANT MEANS OF ATTA\n\nCKS BY APT ORGANIZATIONS, AND MOST USERS ARE NOT SECURITY-CONSCIOUS AN\n\nD ARE EASILY CONFUSED BY SPOOFED EMAILS, DISGUISED DOCUMENTS, AND DECEP\n\nTIVE HEADERS. THE QIANXIN RED RAINDROP TEAM REMINDS USERS TO BEWARE OF\n\nPHISHING ATTACKS, NEVER OPEN LINKS OF UNKNOWN ORIGIN SHARED ON SOCIAL\n\nMEDIA, DO NOT CLICK ON EMAIL ATTACHMENTS THAT EXECUTE UNKNOWN SOURCE\n\nS, DO NOT RUN UNKNOWN FILES WITH EXAGGERATED TITLES, AND DO NOT INSTALL\n\n\n-----\n\nUPDATE AND INSTALL PATCHES.\n\nIf you need to run, install an application of unknown origin, you can first use the\n\nQianxin Threat Intelligence File Deep Analysis Platform (https://sandbox.ti.qianxin.co\n\nm/sandbox/page) to identify. At present, it supports in-depth analysis of files in vario\n\nus formats, including Windows and Android platforms [[3].]\n\nAT PRESENT, THE FULL RANGE OF THREAT INTELLIGENCE DATA BASED ON THE QI\n\nANXIN THREAT INTELLIGENCE CENTER, INCLUDING THE QIANXIN THREAT INTELLIGEN\n\nCE PLATFORM (TIP), TIANQING, TIANYAN ADVANCED THREAT DETECTION SYSTEM, QI\n\nANXIN NGSOC, ANDRXIN SITUATIONAL AWARENESS, ETC., HAVE SUPPORTED THE AC\n\nCURATE DETECTION OF SUCH ATTACKS.\n\n## IOCs\n\n**MD5**\n\n44BE20C67A80AF8066F9401C5BEE43CB\n\n65ABAD905E80F8BC0A48E67C62E40119\n\n1FD8FEF169BF48CFDCF506151264128C\n\n7B07CD6BB6B5D4ED6A2892A738FE892B\n\n9AD00E513364E9F44F1B6712907CBA9B\n\n15A7125FE9E629122E1D1389062AF712\n\n749CCB545B74B8EB9DFF57FCB6A07020\n\n1769A818548A0B52C7BE2A0A213A9384\n\n\n-----\n\nB587851D8A42FC8C23F638BBC2EB866B\n\nBDFB5071F5374F5C0A3714464B1FA5E6\n\nC0B24DC8F53227CE0C64439B302CA930\n\n619649CE3FC1682C702D9159E778F8FD\n\nD19DD02CF375D0D03F557556D5207061\n\nD47F7FCBE46369C70147A214C8189F8A\n\nE3FFDA448DF223B240A20DAE41E20CEF\n\n825730D9DD22DBAE7F2BD89131466415\n\n4382384FEB5AD6B574F68E431006905E\n\nAAD5A9F3BE23D327B9122A7F7E102443\n\n556ABC167348FE96ABFBF5079C3AD488\n\n**URL**\n\nhttp://VM2rJOnQ.naveicoipg.online/ACMS/0hUxr3Lx/police0?mid=h1o5cYfJ\n\nhttp://twlekqnwl.naveicoipg.online/ACMS/0y0fMbUp/supportTemplate7?\n\ncid=yypwjelnblw\n\nhttp://olsnvolqwe.naveicoipg.online/ACMS/0y0fMbUp/supportTemplate5?\n\ncid=pqwnlqwjqg\n\nhttp://vnwoei.naveicoipg.online/ACMS/0s4AtPuk/wwwTemplate?cid=nnwoieopq\n\nhttp://jvnquetbon.naveicoipg.online/ACMS/0pxCtBMz/policeTemplate1?\n\nmid=ksndoqiweyp\n\nhttp://AOsM8Cts.naveicoipg.online/ACMS/0ucLxIjP/toyotaTemplate8?tid=CN2xsRPI\n\nhttp://ADzJvazJ.naveicoipg.online/ACMS/0ucLxIjP/toyotaTemplate1?tid=2uiSmhx2\n\nhttp://CEcOMTp3.naveicoipg.online/ACMS/0o0WQher/ttt3?qwe=v0OSWog5\n\nhttp://123fisd.naveicoipg.online/ACMS/0mFCUrPf/temp04060?ttuq=qcnvoiek\n\nhttp://naveicoipc.tech/ACMS/0Mogk1Cs/topAccounts?uid=3490blxl\n\nhttp://1xJOiKZd.naveicoipa.tech/ACMS/Cjtpp17D/Cjtpp17D64.acm\n\nhttp:// uzzmuqwv.naveicoipc.tech/ACMS/1uFnvppj/1uFnvppj32.acm\n\nhttp://naveicoipd.tech/ACMS/018ueCdS/blockchainTemplate\n\nhttp://bcvbert.naveicoipe.tech/ACMS/01AweT9Z/01AweT9Z64.acm\n\nhttp://xjowihgnxcvb.naveicoipf.online/ACMS/07RRwrwK/07RRwrwK64.acm\n\n## reference links\n\n[1]. https://blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus\napt-leverages-windows-update-client-github-in-latest-campaign/\n\n\n-----\n\ncs-6\n\n[3]. https://ti.qianxin.com/portal\n\n\nClick to read the original article to ALPHA 5.0\n\ninstantly assist in threat research\n\n\nIncluded in the collection #APT 59\n\nprevious\n\nLazarus Arsenal Update: Andariel Recent\nAttack Sample Analysis\n\n\nnext\n\nanalysis of the recent attack activities of\nthe \"blind eagle\" in forging judicial bans\n\n\nModified on 2022-04-11\n\n[Read more](javascript:;)\n\n\nPeople who liked this content also liked\n\n### the mysterious hacking organization that hacked microsoft, samsung, and nvidia was exposed, and behind it was a 16-year-old british teenager who...\n\nbig data digest\n\n### Facebook blocks cyberattacks against Ukraine by Russia and Belarus; Ubuntu developers terminate russian operations\n\n21CTO\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/r1g8ofc5i4b8h7bgwig4r53k5zi9coro"
    ],
    "report_names": [
        "Qianxin_Analysis of the Suspected Lazarus Attack Activities against South Korean Companies(04-11-2022)"
    ],
    "threat_actors": [
        {
            "id": "838f6ced-12a4-4893-991a-36d231d96efd",
            "created_at": "2022-10-25T15:50:23.347455Z",
            "updated_at": "2025-03-27T02:00:55.449316Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "Andariel",
                "Silent Chollima",
                "PLUTONIUM",
                "Onyx Sleet"
            ],
            "source_name": "MITRE:Andariel",
            "tools": [
                "Rifdoor",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "98b22fd7-bf1b-41a6-b51c-0e33a0ffd813",
            "created_at": "2022-10-25T15:50:23.688973Z",
            "updated_at": "2025-03-27T02:00:55.524322Z",
            "deleted_at": null,
            "main_name": "APT-C-36",
            "aliases": [
                "APT-C-36",
                "Blind Eagle"
            ],
            "source_name": "MITRE:APT-C-36",
            "tools": [
                "Imminent Monitor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bd43391b-b835-4cb3-839a-d830aa1a3410",
            "created_at": "2023-01-06T13:46:38.925525Z",
            "updated_at": "2025-03-27T02:00:02.95302Z",
            "deleted_at": null,
            "main_name": "APT-C-36",
            "aliases": [
                "Blind Eagle"
            ],
            "source_name": "MISPGALAXY:APT-C-36",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "110e7160-a8cc-4a66-8550-f19f7d418117",
            "created_at": "2023-01-06T13:46:38.427592Z",
            "updated_at": "2025-03-27T02:00:02.830659Z",
            "deleted_at": null,
            "main_name": "Silent Chollima",
            "aliases": [
                "Subgroup: Andariel",
                "Onyx Sleet",
                "PLUTONIUM",
                "OperationTroy",
                "Guardian of Peace",
                "GOP",
                "WHOis Team",
                "Andariel"
            ],
            "source_name": "MISPGALAXY:Silent Chollima",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4a502340-ae29-4a3a-8142-7fbbc2ec79b5",
            "created_at": "2024-05-01T02:03:08.138302Z",
            "updated_at": "2025-03-27T02:05:17.416542Z",
            "deleted_at": null,
            "main_name": "NICKEL HYATT",
            "aliases": [
                "Dark Seoul",
                "Jumpy Pisces ",
                "Onyx Sleet ",
                "RIFLE Campaign",
                "Silent Chollima ",
                "Andariel"
            ],
            "source_name": "Secureworks:NICKEL HYATT",
            "tools": [
                " DTrack",
                " Rifle",
                " UnitBot",
                " Valefor",
                "ActiveX 0-day"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bc6e3644-3249-44f3-a277-354b7966dd1b",
            "created_at": "2022-10-25T16:07:23.760559Z",
            "updated_at": "2025-03-27T02:02:09.968605Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "APT 45",
                "Andariel",
                "Jumpy Pisces",
                "Onyx Sleet",
                "Operation BLACKMINE",
                "Operation BLACKSHEEP/Phase 3.",
                "Operation Blacksmith",
                "Operation DESERTWOLF/Phase 3",
                "Operation GHOSTRAT",
                "Operation GoldenAxe",
                "Operation INITROY/Phase 1",
                "Operation INITROY/Phase 2",
                "Operation Mayday",
                "Operation VANXATM",
                "Operation XEDA",
                "Plutonium",
                "Silent Chollima",
                "Stonefly"
            ],
            "source_name": "ETDA:Andariel",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "be597b07-0cde-47bc-80c3-790a8df34af4",
            "created_at": "2022-10-25T16:07:23.407484Z",
            "updated_at": "2025-03-27T02:02:09.784411Z",
            "deleted_at": null,
            "main_name": "Blind Eagle",
            "aliases": [
                "APT-C-36",
                "APT-Q-98",
                "AguilaCiega"
            ],
            "source_name": "ETDA:Blind Eagle",
            "tools": [
                "AsyncRAT",
                "BitRAT",
                "Bladabindi",
                "BlotchyQuasar",
                "Imminent Monitor",
                "Imminent Monitor RAT",
                "Jorik",
                "LimeRAT",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "Socmer",
                "Warzone",
                "Warzone RAT",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041769,
    "ts_creation_date": 1651207197,
    "ts_modification_date": 1651207197,
    "files": {
        "pdf": "https://archive.orkl.eu/d2c884f5d1d49194f6688d640bb71dbb50ad332e.pdf",
        "text": "https://archive.orkl.eu/d2c884f5d1d49194f6688d640bb71dbb50ad332e.txt",
        "img": "https://archive.orkl.eu/d2c884f5d1d49194f6688d640bb71dbb50ad332e.jpg"
    }
}