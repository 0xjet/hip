{
    "id": "2672e1de-e3c9-4408-8e5e-15a75511cb40",
    "created_at": "2023-01-12T15:09:42.72251Z",
    "updated_at": "2025-03-27T02:05:48.272424Z",
    "deleted_at": null,
    "sha1_hash": "877bd12cb056f018985a98dd2c30c64ab21da521",
    "title": "2020-02-20 - ObliqueRAT- New RAT hits victims' endpoints via malicious documents",
    "authors": "",
    "file_creation_date": "2022-05-28T15:28:20Z",
    "file_modification_date": "2022-05-28T15:28:20Z",
    "file_size": 910037,
    "plain_text": "# ObliqueRAT: New RAT hits victims' endpoints via malicious documents\n\n**[blog.talosintelligence.com/2020/02/obliquerat-hits-victims-via-maldocs.html](https://blog.talosintelligence.com/2020/02/obliquerat-hits-victims-via-maldocs.html)**\n\nBy Asheer Malhotra.\n\nCisco Talos has observed a malware campaign that utilizes malicious Microsoft Office\ndocuments (maldocs) to spread a remote access trojan (RAT) we're calling\n\"ObliqueRAT.\"\n\nThese maldocs use malicious macros to deliver the second stage RAT payload.\n\n\n-----\n\nThis campaign appears to target organizations in Southeast Asia.\nNetwork based detection, although important, should be combined with endpoint\nprotections to combat this threat and provide multiple layers of security.\n\n### What's New?\n\nCisco Talos has recently discovered a new campaign distributing a malicious remote access\ntrojan (RAT) family we're calling \"ObliqueRAT.\" Cisco Talos also discovered a link between\nObliqueRAT and another campaign from December 2019 distributing CrimsonRAT sharing\nsimilar maldocs and macros. CrimsonRAT has been known to target diplomatic and\ngovernment organizations in Southeast Asia.\n\n### How did it work?\n\nThis RAT is dropped to a victim's endpoint using malicious Microsoft Office Documents\n(maldocs). The maldocs aim to achieve persistence for the second-stage implant that\ncontains a variety of RAT capabilities, which we're calling \"ObliqueRAT.\" In this post, we\nillustrate the core technical capabilities of the maldocs and the RAT components including:\n\nThe maldocs based infection chain\nA variant distributed using a dropper EXE.\nDetailed capabilities and command codes of the RAT implant (2nd stage payload).\nCommunication mechanisms used.\n\n### So what?\n\nThis malware is an example of how a simple, yet effective RAT, is used to implement a wide\nvariety of malicious capabilities. Key capabilities of ObliqueRAT include:\n\nAbility to execute arbitrary commands on an infected endpoint.\nAbility to exfiltrate files.\nAbility to drop additional files.\nAbility to terminate process on the infected endpoint etc.\n\nAnalysis of a recently discovered preliminary variant of ObliqueRAT in this post presents\ninsights into the evolution of this threat. Analyses of the key similarities and differences\nbetween the two campaigns of ObliqueRAT and CrimsonRAT show us the changes in tactics\nand techniques of the attackers used to continue attacks while trying to bypass detections.\nThis campaign also shows us that while network-based detection is important, it can be\ncomplemented with system behavior analysis and endpoint protections for additional layers\nof security.\n\n\n-----\n\n## Analysis of Maldocs\n\n### Initial Infection Vector\n\nThis threat arrives on the endpoint in the form of malicious Microsoft Word documents. The\nmalicious documents (maldocs) prompt the end-user for a password to view the contents of\nthe maldocs. The malicious VB script in the maldocs is activated once the user enters the\ncorrect password for the document.\n\nThe maldocs have been known to have seemingly benign file names in the wild such as:\n\nCompany-Terms.doc\nDOT_JD_GM.doc\n\n[DOT_JD_GM may possibly stand for \"Department Of Telecommunications_Job\nDescription_General Manager\"]\n\nThese file names indicate that the maldocs may be targeted towards specific individuals as\npart of a targeted distribution campaign. The initial infection vector of this threat is most likely\nemail based with the body of the malicious email containing the password required to open\nthe maldocs.\n\n### Malicious VBA Analysis\n\nOnce opened, the maldoc activates a malicious VBA script that performs the following\nmalicious activities:\n\n1. Extracts the contents of a form/textbox.\n\n2. This content consists of an MS Windows binary embedded as a character\n\nrepresentation of the binary's bytes delimited using a specific character (e.g. \"O\" used\nas a delimiter).\n\n\n-----\n\nDelimited Malicious MZ embedded in maldoc highlighted.\n\n3. The malicious binary is extracted from the maldoc by the VBA script and dropped on\n\nthe endpoint to the location:\nC:\\Users\\Public\\sgrmbrokr.doc\n\n4. The file is consequently renamed to an exe : C:\\Users\\Public\\sgrmbrokr.exe\n\n5. The malicious VBScript then creates a shortcut in the currently logged in user's Start\nUp directory to achieve persistence across reboots for the malicious executable (MZ)\nwritten to the file system in previous steps. The shortcut created is:\n%userprofile%\\\\AppData\\Roaming\\Microsoft\\Windows\\Start\nMenu\\Programs\\Startup\\saver.url\n\n6. Once the shortcut is created the VBScript stops execution without executing the actual\n\nsecond-stage payload (ObliqueRAT).\n\n\n-----\n\nMalicious VBA script in madocs\n\n## Second-stage payload analysis: ObliqueRAT\n\nThe second-stage binary (ObliqueRAT) contains the following features:\n\nRAT capabilities (detailed below).\nAbility to communicate with the command and control server (C2) to obtain command\ncodes and send back executed command outputs.\n\nThreat Grid detects this implant as malicious.\n\nThreat Grid behavioral indicators for the implant.\n\n### Mutex Creation\n\nThe RAT ensures that only one instance of its process is running on the infected endpoint at\nany given time by creating and checking for a mutex named \"Oblique\". If the named mutex\nalready exists on the endpoint then the RAT will stop executing until the next login of the\ninfected user account.\n\n\n-----\n\nMutex creation by implant\n\n### Gather initial system fingerprint\n\nOnce the malware has created the named mutex, it attempts to gather an initial fingerprint of\nthe system to identify the system. This information is then sent to the operating C2 to\nfingerprint the system to decide which commands to send next.\n\nSysinfo gathered by the RAT:\n\nComputer Name.\nCurrent User Account Name.\nWindows operating system (OS) version in the form of a textual representation:\n\nXP\nXP SP2\nVista\n7\n8\n8.1\n10\n\nOS bitness i.e.\n\n64 bits\n32 bits\n\nDirectory & File Check: A unique feature of the RAT is that it looks for the presence of a\nspecific directory and all files residing inside it. The directory path (folderpath) is\nhardcoded in the RAT: C:\\ProgramData\\System\\Dump.\n\nIf this directory is present on the infected system then the RAT sends the keyword\n\"Yes\" to its C2 and \"No\" otherwise.\n\n\n-----\n\nAnother hard coded value from the implant 5.2 is sent to the C2. (May indicate\nversion number of the implant)\n\nThe sysinfo gathered by the implant is then put together as a single string with the character\n\">\" used as a delimiter.\n\nFormat used:\n\n(_variable_ = used for depicting a variable value)\n\n_ComputerName_>_UserName_>Windows _version-string_>_implant-name-on-disk_>_OSbitness_>_Dump_dir_files_exist_>_hardcoded_implant_version_number_>\n\nE.g.\n\nDESKTOP-SCOTTPC>jon>Windows 10>sgrmbrokr>64 bits>Yes>5.2>\n\nAlthough the implant gathers the system information initially, it only sends this information out\nif it receives a specific command code from the C2. The implant also performs anti-infection\nchecks before it fully activates itself on the endpoint.\n\n### Anti-Infection Checks\n\nAnother interesting feature in the implant is that after it gathers the preliminary system\ninformation for fingerprinting, it performs a series of checks against the user and computer\nname it has obtained to identify an endpoint or user account it must avoid its execution\non/for. If any of the values from its blocklist match the current user/computer name, it simply\nstops its execution.\n\nThe usernames blocklisted by the implant are:\n\nJohn\nTest\nJohsnson\nArtifact\nVince\nSerena\nLisa\nJOHNSON\nVINCE\nSERENA\n\nA similar check is done for the computer name as well. The list of computer name values\nblocklisted by the implant are:\n\nJOHN\n\n\n-----\n\nTEST\n\nBlocklisted user & computer names in the implant\n\nThe anti-infection checks may have been implemented to:\n\nAvoid successful execution of the implant on a Sandbox based detection system (AntiAnalysis Technique) OR\nPrevent execution of the implant in the attackers' test environment.\n\n### RAT command codes and functionalities\n\nThe implant then connects to its C2 server using hardcoded values of its IP Address and\nPort Number.\n\n\n-----\n\nImplant connecting to hardcoded C2 server.\n\nOn connection, the implant receives a command code from the C2 that corresponds to the\ncapability the implant is supposed to execute next on the endpoint. Also, everytime the\nimplant receives a command from the C2 it sends back an acknowledgement message to\nthe C2 indicating that it has received the command code.\n\nThe acknowledgment sent to the C2 is always the keyword \"ack\".\n\n\"ack\" sent to the C2 as an acknowledgment\n\n\n-----\n\nThe command codes, supporting command data (both sent by the C2) and capability\ndescription are detailed below.\n\n**Command Code = \"5\" Command Data = <filename or folderpath>**\n\nThis command code is used to find files and record file sizes in KB for files specified by a\nspecific folder or file path. The data gathered by the implant is in format:\n\n(_variable_ = used for depicting a variable value)\n\n_filepath_<_size_in_KB_;_filepath_<_size_in_KB_;\n\nE.g.\n\npony.txt<4;bigpony.txt<100;\n\n**Command Code = \"0\" Command Data = None**\n\nSend the already gathered system information (sysinfo) described previously to the C2\nserver for fingerprinting the infected host.\n\nImplant sending initial sysinfo to its C2 server.\n\n**Command Code = \"1\" Command Data = None**\n\nThis command is aimed to trigger the implant to discover the category of various drives on\nthe endpoint. The drives to be checked for are listed as hardcoded drive letters in the\nimplant:\n\nA:\nB:\nC:\nD:\nE:\nF:\nG:\nH:\nI:\nJ:\nK:\nL:\n\nThe drive types for the drives checked on the system are represented textually by the\nimplant using the following keywords:\n\n\n-----\n\nUnknown\nRemovable Drive\nHard Drive\nNetwork Drive\nCD Drive\nRAM Disk\n\nThe data sent out for this command is in format:\n\n(_variable_ = used for depicting a variable value)\n_drive-letter_>_Drive-type_|_drive-letter_>_Drive-type_|\n\nE.g.\nC:>Hard Drive|D:>CD Drive|\n\n\n-----\n\nDrive letters and identification strings in the implant.\n\n**Command Code =\"4\" Command Data=<filename> & <zip_file_name>**\n\nReceive a target filename and ZIP filename from the C2server. Create a new ZIP file with the\nname provided in the %temp% directory and add the target file to it. Once done, send the\ncontents of the ZIP file to the C2 server.\n\nThe ZIP file is subsequently deleted from the endpoint after exfiltration.\n\nThe implant also records the target filename that has been exfiltrated (in ZIP form) from the\nendpoint to a log file called: %temp%\\lgb\n\nLog file containing the list of files exfiltrated from the endpoint.\n\n**Command Code =\"4a\" or \"4e\" Command Data=<target filename>**\n\nVariant of command code \"4.\" The difference here is that the implant doesn't require a\ndifferent ZIP file name from the C2 it simply uses the name of the target filename and creates\na ZIP file.\n\nE.g. if the target file name is \"abc.txt\" then the ZIP file name is \"abc.txt.zip\"\n\n**Command Code =\"6\" Command Data=<folder path>**\n\nAccept a folder path from the C2 server, recursively find all files residing in the folders and\nZIP them up into a ZIP file with the same name as the folder path specified by the C2. (The\nZIP file is created in the operating directory of the implant). This ZIP file is then exfiltrated by\nthe implant to the C2 and subsequently deleted.\n\n**Command Code =\"3\" Command Data=<foldername>**\n\nVariant of command code =\"5\". The difference here is that implant accepts only a foldername\nand recursively calculates the file sizes and builds the list of filepaths and filesizes in the\nsame format:\n\n_filepath_<_filesize_;_filepath_<_filesize_;_filepath_<_filesize_;\n\n**Command Code =\"7\" Command Data=<command_line>**\n\nExecute given command line on the endpoint with a high priority (The output of the command\nexecuted on the endpoint is not sent back to the C2 though).\n\n\n-----\n\nSample command executed by the implant on the endpoint.\n\n**Command Code =\"8\" Command Data=<filename>, <filesize> & <file_contents>**\n\nThis command is used by the implant to write a file sent by the C2 to the infected endpoint.\nTo achieve this functionality the implant recvs the following info from the C2 server:\n\nPath of the file to be written to on disk.\nSize of the file to be being sent by the C2.\nContents of the file to be written to disk.\n\n**Command Code =\"backed\" Command Data= None**\n\nBackup the contents of the lgb log file to another file. The backup is done\n\nFrom = %temp%\\lgb\n\nTo = %temp\\lgb2\n\nThe implant reads the lgb log file character by character and writes it to the lgb2 file. On\nencountering a newline character, the newline is replaced by \"*\\n\" instead.\n\nOnce the backup is done the implant will remove the \"lgb\" log file and then rename the lgb2\nfile back to \"lgb\" (Convoluted backup mechanism used here).\n\n**Command Code =\"rnm\" Command Data= <old_filename> & <new_filename>**\n\nRename a file to a new name provided by the C2.\n\nFile rename capability of the implant.\n\n**Command Code =\"tsk\" Command Data= None**\n\n\n-----\n\nThis command is used to gather the list of running processes on the system, record this\ninformation to a log file and exfiltrate the contents of the log file. Once the log file has been\nsent to the C2 it is removed from the endpoint.\n\nLog filepath used = C:\\ProgramData\\a.txt\n\nLog file format =\n\nRunning Processes\n<process_image_name>\n<process_image_name>\n<process_image_name>\n.\n.\n.\n\nProcess list snippet written to log file by the implant.\n\n**Command Code =\"exit\" Command Data= None**\n\nStop execution of implant on the endpoint without removing persistence from Star-tUp folder.\n\n**Command Code =\"restart\" Command Data=None**\n\nRestart the socket connection to the C2.\n\n**Command Code =\"kill\" Command Data=<process_name>**\n\nFind all processes by the name specified by the C2 and terminate them.\n\n\n-----\n\nThe implant's capability to terminate processes running on the endpoint.\n\n**Command Code =\"auto\" Command Data= Custom**\n\nThis command code is used to trigger a recursive search sweep of one or more directories\nspecified by the C2 server. This sweep is done to verify the presence of files specified by a\nfilename. The data specified by the C2 is:\n\nFolder path(s) to find files in.\nFile name(s) to find.\nFile extension(s) to find files.\n\nAny files matching the specified criteria are logged into the file C:\\ProgramData\\auto.txt\n\nFormat:\n\n_folderpath_>_filename1_,_filename2_,_filenameN_<_file-extn1_,_file-extn2_,_file-extnN_\n\nE.g.\n\nIf the command data sent by the C2 is:\n\nc:\\dummy>pony.txt,blah.exe<txt,exe\n\nThen if these files exist, the log file (\"auto.txt\") will contain:\n\nc:\\dummy\\pony.txt\n\nc:\\dummy\\blah.exe\n\nThe log file (auto.txt) is then read and the contents are sent to the C2 followed by its deletion.\n\n**Command Code =\"rht\" Command Data= <filepath>**\n\nThis command is used to delete (remove) a file specified by the C2 server from the endpoint.\n\n### RAT(Implant's) Communication Mechanisms\n\nObliqueRAT utilizes the ws2_32.dll library to communicate with its C2. This library is used to\nimplement the core socket libraries supported by MS Windows.\n\n\n-----\n\nKeywords used by the RAT during communication are:\n\n\"ack\\0\" = Acknowledgment of the command code received as well as an indicator of\nsuccessful command execution.\n\"nak\\0\" = Indicates failure to execute functionality without providing reason for failure to\nthe C2.\n\n## Variant #0 - ObliqueRAT\n\nCisco Talos also discovered another variation of the ObliqueRAT attack distributed via a\nmalicious dropper. The malicious dropper contains 2 EXEs embedded in it that will be\ndropped to disk during execution to complete the infection chain. The initial distribution\nvector of this dropper is currently unknown.\n\n### Variant #0 Artifacts:\n\nDropper EXE:\n\n4a25e48b8cf515f4cdd6711a69ccc875429dcc32007adb133fb25d63e53e2ac6\n\nObliqueRAT Variant #0 EXE:\n\n9da1a55b88bda3810ccd482051dc7e0088e8539ef8da5ddd29c583f593244e1c\n\nPersistence Component EXE:\n\nad17ada0171b9e619000902e62b26b949afb01b974a65258e4a7ecd59c248dba\n\n### Variant #0 Dropper Analysis\n\nThe dropper consists of one EXE with another two additional EXEs embedded in it. During\nexecution the dropper will perform the following activities:\n\nIf specific file markers exist in the dropper's binary file on disk: (Markers used= \"***\")\n\n1. If the markers exist then read the data between the markers (there will be 2 such\n\nmarkers for 2 embedded EXEs) and write it to files on disk:\n\nC:\\Users\\Public\\Video\\hrss.exe\nC:\\Users\\Public\\Video\\lphsi.exe\n2. Execute these files using the ShellExecute API.\n\nIf the markers do not exist then it will package its components into a new copy of itself:\n\n1. Look for files named \"a.exe\" and \"b.exe\" in the current working directory and read their\n\ncontents into memory.\n2. Rename itself (the dropper) to \"fin.exe\".\n\n\n-----\n\n3. Append to itself (fin.exe) the magic markers specified ( ) and the contents of a.exe\nand \"b.exe\" thereby completing the packing process.\n\n### ObliqueRAT component Functionalities (lphsi.exe)\n\nThe ObliqueRAT sample dropped by the dropper has the same capabilities as the\nObliqueRAT sample discussed above. There is a slight variation though (discussed in the\ncomparison section below).\n\n### Persistence Module (hrss.exe)\n\nThe 2nd EXE (hrss.exe) executed by the dropper is used only to establish persistence for the\nObliqueRAT sample (lphsi.exe). This is done by creating a shortcut in the currently logged in\nuser's Start-Up directory to execute ObliqueRAT whenever the user logs into the infected\nendpoint.\n\nShortcut created: %userprofile%\\AppData\\Roaming\\Microsoft\\Windows\\Start\nMenu\\Programs\\Startup\\script.lnk\n\nMalicious shortcut (script.lnk) used for persistence.\n\n### Variant #0 Comparison\n\nVariant #0 (9da1a55b88bda3810ccd482051dc7e0088e8539ef8da5ddd29c583f593244e1c)\ndiscovered by Cisco Talos looks like a preliminary version of the ObliqueRAT attack detailed\nin this post (37c7500ed49671fe78bd88afa583bfb59f33d3ee135a577908d633b4e9aa4035).\n\nThis is because of the following factors:\n\n1. Variant #0 has an earlier compile time of 04/11/2019 12:12:04 UTC while the\n\nObliqueRAT implant detailed in this post has a later compile time of 27/11/2019\n08:40:10 UTC.\n\n\n-----\n\n2. Although the hardcoded version number of both the implants is 5.2, variant #0\n\ncontains an additional feature where, if the implant fails to connect to the C2 server it\nwill display any of two Message Boxes consisting of:\nTitle = scokerr\nText = sockerror\n\nand\n\nTitle = grace\nText = grace\n\nThis indicates that variant #0 may be a test copy of ObliqueRAT that was released into the\nwild by the attackers without scrubbing the Message Boxes used for debugging the C2\nconnection functionality (Thus identified as \"Variant #0\").\n\n## Related campaigns: CrimsonRAT vs. ObliqueRAT\n\nThe malicious VBA Scripts in the maldocs discovered by Talos semantically resemble a\npreviously observed maldoc distribution campaign (from 2019) delivering another .NET\nbased RAT family popularly known as CrimsonRAT. [CrimsonRAT has been known to target](https://attack.mitre.org/software/S0115/)\norganizations in Southeast Asia.\n\nAn example of a maldoc (from December 2019) observed distributing the CrimsonRAT\nmalware is:\n\n965b90d435c1676fa78cdce1eee2ec70e3194c0e4f0d993bc36bfd9f77697969\n\nThe CrimsonRAT sample dropped by the maldoc is:\n\n98894973a86aa01c4f7496ae339dc73b5e6da2f1dbcd5fe1215f70ea7b889b85\n\n### Similarities Between the Two Campaigns\n\nThis CrimsonRAT maldoc although not password protected (as in the case of the maldocs\ncontaining ObliqueRAT) contains the following similarities w.r.t the ObliqueRAT maldocs:\n\n\n-----\n\nSimilar VB variable naming conventions for filenames, folder names, ZIP file names:\nE.g.\n\nThe ObliqueRAT VBScripts use variables named:\n**file_Salan_name, fldr_Salan_name, zip_Salan_file**\n\nwhile the CrimsonRAT VBScripts use variables named:\n**file_Allbh_name, fldr_Allbh_name, zip_Allbh_file**\n\nSimilar decoding technique for the next stage payload:\nBoth sets of VBScripts extract the embedded next stage payload from a form (textbox)\nwhere the bytes of the next stage payload are character representations (of decimal\nnumbers) delimited by a specific character.\n\n### Differences Between the Two Campaigns\n\nThe CrimsonRAT maldocs drop the next stage payload to a ZIP file (E.g.\n%allusersprofile%\\intaRD\\thnaviwa.zip) on the filesystem.\n\nHowever the ObliqueRAT maldocs drop the RAT payload directly to a file named:\n\nC:\\Users\\Public\\sgrmbrokr.exe\n\nAs mentioned above, the CrimsonRAT maldocs drop a malicious ZIP file on the disk\nfirst and then extract the EXE within the archive file. This malicious EXE (.NET based\nCrimsonRAT) is then executed on the infected endpoint.\n\nThe ObliqueRAT maldocs however simply drop the malicious EXE (ObliqueRAT EXE)\ndirectly on the filesystem, create a shortcut in the infected user's StartUp folder. The\nEXE is not executed and the malware relies on the user to re-login for the ObliqueRAT\ninfection to trigger.\n\n\n-----\n\nObliqueRAT VBA (Left) vs CrimsonRAT VBA (Right) code\n\n## Conclusion\n\nThis campaign shows a threat actor conducting a targeted distribution of maldocs similar to\nthose utilized in the distribution of CrimsonRAT. However, what stands out here is that the\nactor is now distributing a new family of RATS. Although it isn't technically sophisticated,\nObliqueRAT consists of a plethora of capabilities that can be used to carry out various\nmalicious activities on the infected endpoint. The fact that the maldocs are password\nprotected (and that the ObliqueRAT implant consists of probable anti-analysis techniques)\nindicates the attackers' intent to hide the malicious activities of the infection from an analyst.\nThis campaign started in January 2020 and is still ongoing. This campaign also shows us\nthat while network-based detection is important, it must be complemented with system\nbehavior analysis and endpoint protections.\n\n## Coverage\n\nWays our customers can detect and block this threat are listed below.\n\n[Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the](https://www.cisco.com/c/en/us/products/security/advanced-malware-protection)\nmalware detailed in this post. Below is a screenshot showing how AMP can protect\ncustomers from this threat. Try AMP for free [here.](https://cisco.com/go/tryamp)\n\n[Cisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html)\naccess to malicious websites and detects malware used in these attacks.\n\n\n-----\n\n[Email Security can block malicious emails sent by threat actors as part of their campaign.](https://www.cisco.com/c/en/us/products/security/email-security-appliance/index.html)\n\n[Network Security appliances such as Next-Generation Firewall (NGFW), Next-Generation](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\n[Intrusion Prevention System (NGIPS), and](https://www.cisco.com/c/en/us/products/security/intrusion-prevention-system-ips/index.html) [Meraki MX can detect malicious activity](https://meraki.cisco.com/products/appliances)\nassociated with this threat.\n\n[Threat Grid helps identify malicious binaries and build protection into all Cisco Security](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\nproducts.\n\n[Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs, and URLs, whether users are on or off the corporate network.\n\nAdditional protections with context to your specific environment and threat data are available\nfrom the [Firepower Management Center.](https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html)\n\nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\n### AMP Detections\n\nAMP detects the ObliqueRAT implants as follows:\n\nObliqueRAT AMP detection\n\nObliqueRAT variant #0 AMP detection\n\n\n-----\n\n## Indicators Of Compromise (IOCs)\n\nThe following IOCs are related to this threat:\n\n### ObliqueRAT\n\nMaldocs\n\n057da080ae0983585ae21195bee60d82664355a7fd78c25f21791b165c250212\ndfad2a80dac91e7703266197ebbf5d67ef77467ab341dd491ad25d92d8118cac\n\nDropper (for Variant #0)\n\n4a25e48b8cf515f4cdd6711a69ccc875429dcc32007adb133fb25d63e53e2ac6\n\n2nd Stage Malicious EXEs\n\nObliqueRAT 37c7500ed49671fe78bd88afa583bfb59f33d3ee135a577908d633b4e9aa4035\nVariant #0 9da1a55b88bda3810ccd482051dc7e0088e8539ef8da5ddd29c583f593244e1c\n\nPersistence Component\n\nad17ada0171b9e619000902e62b26b949afb01b974a65258e4a7ecd59c248dba\n\nMutexes Created by 2nd Stage EXEs:\n\n\"Oblique\"\n\nC2 IP Addresses and URLs:\n\n185[dot]117.73.222:3344\n\n### CrimsonRAT\n\nMaldocs\n\n965b90d435c1676fa78cdce1eee2ec70e3194c0e4f0d993bc36bfd9f77697969\n\nNext Stage Malicious ZIPs & EXEs\n\n3671b7ed9f67098d2a534673ed9ff46e90c03269c0bdd9b6f39ae462915ecdcb [ZIP]\n2911a3da2299817533ca27a0d44c8234fdf9ecd0a285358041da245581673d6f [ZIP]\n98894973a86aa01c4f7496ae339dc73b5e6da2f1dbcd5fe1215f70ea7b889b85 [exe]\ne436be68cdbdb7ea20e5640ad5fa5eca1da71edb9943c3bde446b4c75dacfbd0 [exe]\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-02-20 - ObliqueRAT- New RAT hits victims' endpoints via malicious documents.pdf"
    ],
    "report_names": [
        "2020-02-20 - ObliqueRAT- New RAT hits victims' endpoints via malicious documents.pdf"
    ],
    "threat_actors": [
        {
            "id": "732bfd4b-8c15-42a5-ac4b-14a9a4b902e9",
            "created_at": "2022-10-25T16:07:23.38079Z",
            "updated_at": "2025-03-27T02:02:09.771357Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "ETDA:Bahamut",
            "tools": [
                "Bahamut",
                "DownPaper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f99641e0-2688-47b0-97bc-7410659d49a0",
            "created_at": "2023-01-06T13:46:38.802141Z",
            "updated_at": "2025-03-27T02:00:02.922907Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "MISPGALAXY:Bahamut",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ada9e5d3-1cb2-4b70-a3c8-96808c304ac8",
            "created_at": "2022-10-25T15:50:23.6515Z",
            "updated_at": "2025-03-27T02:00:55.513513Z",
            "deleted_at": null,
            "main_name": "Windshift",
            "aliases": [
                "Windshift",
                "Bahamut"
            ],
            "source_name": "MITRE:Windshift",
            "tools": [
                "WindTail"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536182,
    "ts_updated_at": 1743041148,
    "ts_creation_date": 1653751700,
    "ts_modification_date": 1653751700,
    "files": {
        "pdf": "https://archive.orkl.eu/877bd12cb056f018985a98dd2c30c64ab21da521.pdf",
        "text": "https://archive.orkl.eu/877bd12cb056f018985a98dd2c30c64ab21da521.txt",
        "img": "https://archive.orkl.eu/877bd12cb056f018985a98dd2c30c64ab21da521.jpg"
    }
}