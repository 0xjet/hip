{
    "id": "0b7a4009-4146-4c9c-8fd8-738511a0c1e8",
    "created_at": "2024-01-05T02:07:03.423374Z",
    "updated_at": "2025-03-27T02:17:23.617109Z",
    "deleted_at": null,
    "sha1_hash": "d775eada6c8549d916011b4505bc4862328c454b",
    "title": "Lazarus supply-chain attack in South Korea",
    "authors": "ESET",
    "file_creation_date": "2024-01-04T04:29:15Z",
    "file_modification_date": "2024-01-04T04:29:15Z",
    "file_size": 1080448,
    "plain_text": "# Lazarus supply-chain attack in South Korea\n\n**welivesecurity.com/2020/11/16/lazarus-supply-chain-attack-south-korea**\n\nESET telemetry data recently led our researchers to discover attempts to deploy Lazarus malware via a supply-chain attack in\nSouth Korea. In order to deliver its malware, the attackers used an unusual supply-chain mechanism, abusing legitimate South\nKorean security software and digital certificates stolen from two different companies.\n\n## Lazarus toolset\n\nThe Lazarus group was first identified in Novetta’s report [Operation Blockbuster in February 2016; US-CERT and the FBI call](https://www.operationblockbuster.comhttps//web-assets.esetstatic.com/wls/2016/02/Operation-Blockbuster-Report.pdf)\nthis group [HIDDEN COBRA. These cybercriminals rose to prominence with the infamous case of cybersabotage against Sony](https://us-cert.cisa.gov/northkorea)\nPictures Entertainment.\n\nSome of the past attacks attributed to the Lazarus group attracted the interest of security researchers who relied on Novetta et\n[al.’s white papers with hundreds of pages describing the tools used in the attacks – the Polish and Mexican banks,](https://www.welivesecurity.com/2017/02/16/demystifying-targeted-malware-used-polish-banks/) the\nWannaCryptor outbreak, [phishing campaigns against US defense contractors,](https://researchcenter.paloaltonetworks.com/2017/08/unit42-blockbuster-saga-continues/) Lazarus KillDisk attack against Central\nAmerican casino, etc. – and provides grounds for the attribution of these attacks to the Lazarus group.\n\nNote that the Lazarus toolset (i.e., the collection of all files that are considered by the security industry as fingerprints of the\ngroup’s activity) is extremely broad, and we believe there are numerous subgroups. Unlike toolsets used by some other\ncybercriminal groups, none of the source code of any Lazarus tools has ever been disclosed in a public leak.\n\n## Latest Lazarus supply-chain attack\n\nTo understand this novel supply-chain attack, you should be aware that South Korean internet users are often asked to install\nadditional security software when visiting government or internet banking websites.\n\nWIZVERA VeraPort, referred to as an integration installation program, is a South Korean application that helps manage such\nadditional security software. With WIZVERA VeraPort installed on their devices, users receive and install all necessarily\nsoftware required by a specific website with VeraPort (e.g., browser plug-ins, security software, identity verification software,\netc.). Minimal user interaction is required to start such a software installation from a website that supports WIZVERA VeraPort.\nUsually, this software is used by government and banking websites in South Korea. For some of these websites it is mandatory\nto have WIZVERA VeraPort installed for users to be able to access the sites’ services.\n\n_Figure 1 A WIZVERA VeraPort window displayed to the user when installing additional software_\n\n\n-----\n\nThe Lazarus attackers abused the above mentioned mechanism of installing security software in order to deliver Lazarus\nmalware from a legitimate but compromised website. However, it should be noted that a successful malware deployment using\nthis method requires a number of preconditions; that’s why it was used in limited Lazarus campaigns. To make this attack\npossible:\n\nthe victim must have WIZVERA VeraPort software installed\nthe victim must visit a compromised website that already has support for WIZVERA VeraPort\nthis website must have specific entries in its VeraPort configuration file that allows attackers to replace regular software in\nits VeraPort software bundle with their malware.\n\nIt is important to note that, based on our analysis, we believe that these supply-chain attacks happen at websites that use\nWIZVERA VeraPort, rather than at WIZVERA itself.\n\nWebsites that support WIZVERA VeraPort software contain a server-side component, specifically some JavaScripts and a\nWIZVERA configuration file. The configuration file is base64-encoded XML containing the website address, a list of software to\ninstall, download URLs, and other parameters.\n\n_Figure 2. An example of a WIZVERA VeraPort configuration (redacted by ESET)_\n\nThese configuration files are digitally signed by WIZVERA. Once downloaded, they are verified using a strong cryptographic\nalgorithm (RSA), which is why attackers can’t easily modify the content of these configuration files or set up their own fake\nwebsite. However, the attackers can replace the software to be delivered to WIZVERA VeraPort users from a legitimate but\ncompromised website. We believe this is the scenario the Lazarus attackers used.\n\n\n-----\n\n_Figure 3. Simplified scheme of the WIZVERA supply-chain attack conducted by the Lazarus group_\n\nIt should be noted that WIZVERA VeraPort configurations contain an option to verify the digital signature of downloaded\nbinaries before they are executed, and in most cases this option is enabled by default. However, VeraPort only verifies that the\ndigital signature is valid, without checking to whom it belongs. Thus, to abuse WIZVERA VeraPort, attackers must have any\nvalid code-signing certificate in order to push their payload via this method or get lucky and find a VeraPort configuration that\ndoes not require code-signing verification.\n\nSo far, we have observed two malware samples that were delivered using this supply-chain attack and both were signed:\n\n**SHA-1** **Filename** **Digital signature**\n\n3D311117D09F4A6AD300E471C2FB2B3C63344B1D Delfino.exe ALEXIS SECURITY GROUP, LLC\n\n3ABFEC6FC3445759730789D4322B0BE73DC695C7 MagicLineNPIZ.exe DREAM SECURITY USA INC\n\nThe attackers used illegally obtained code-signing certificates in order to sign the malware samples. Interestingly, one of these\ncertificates was issued to the US branch of a South Korean security company.\n\n\n-----\n\n_Figure 4. The ALEXIS SECURITY GROUP, LLC code-signing certificate used to sign Lazarus malware_\n\n_Figure 5. The DREAM SECURITY USA INC code-signing certificate used to sign Lazarus malware_\n\nThe attackers camouflaged the Lazarus malware samples as legitimate software. These samples have similar filenames, icons\nand VERSIONINFO resources as legitimate South Korean software often delivered via WIZVERA VeraPort. Binaries that are\ndownloaded and executed via the WIZVERA VeraPort mechanism are stored in %Temp%\\[12_RANDOM_DIGITS]\\.\n\nIt should be noted that WIZVERA VeraPort’s configuration has an option not only to verify digital signatures, but also to verify\nthe hash of downloaded binaries. If this option is enabled, then such an attack cannot be performed so easily, even if the\nwebsite with WIZVERA VeraPort is compromised.\n\n## Attribution\n\n\n-----\n\nWe strongly attribute this supply chain attack to the Lazarus group, based on the following aspects:\n\n1. Community agreement: The current attack is a continuation of what KrCERT has called Operation Bookcodes. While\n\n[KrCERT hasn’t attributed that campaign to the Lazarus group, Kaspersky did in their report about Q2 2020 APT trends.](https://securelist.com/apt-trends-report-q2-2020/97937/)\n2. Toolset characteristics and detection:\n\n1. The initial dropper is a console application that requires parameters, executing the next stages in a cascade and\n\n[utilizes an encryption, cf. the watering hole attacks against Polish and Mexican banks](https://www.welivesecurity.com/2017/02/16/demystifying-targeted-malware-used-polish-banks/)\n2. The final payload is a RAT module, with TCP communications and its commands indexed by 32-bit integers, cf.\n\n[KillDisk in Central America](https://www.welivesecurity.com/2018/04/03/lazarus-killdisk-central-american-casino/)\n3. Many tools delivered via this chain are already flagged as NukeSped by ESET software. For example, the signed\n\nDownloader in the Analysis section is based on a project called WinHttpClient and it leads to the similar tool with\nhash 1EA7481878F0D9053CCD81B4589CECAEFC306CF2, which we link with with a sample from Operation\nBlockbuster (CB818BE1FCE5393A83FBFCB3B6F4AC5A3B5B8A4B). The connection between the latter two is the\ndynamic resolution of Windows APIs where the names are XOR-encrypted by 0x23, e.g.,\ndFWwLHFMjMELQNBWJLM is the encoding of GetTokenInformation.\n[3. Victimology: the Lazarus group has a long history of attacks against victims in South Korea like Operation Troy, including](https://www.mcafee.com/enterprise/en-us/assets/white-papers/wp-dissecting-operation-troy.pdf)\n\nDDoS attacks [Ten Days of Rain in 2011,](https://www.mcafee.comhttps//web-assets.esetstatic.com/wls/2011/07/McAfee-Labs-10-Days-of-Rain-July-2011.pdf) [South Korean Cyberattacks in 2013, or South Korean cryptocurrency](https://www.nytimes.com/2013/03/21/world/asia/south-korea-computer-network-crashes.html)\nexchanges targeted in 2017.\n\n4. Network infrastructure: the server-side techniques of webshells and the organization of C&Cs are covered very precisely\n\nin KrCERT’s white paper #2. The current campaign uses a very similar setup as well.\n\n5. Eccentric approach:\n\n1. In intrusion methods: The unusual method of infiltration is a clue that could be attributed to a sophisticated and\n\nprofessionally organized actor like Lazarus. In the past, we saw how a vulnerability in software existing only in\nspecific networks was leveraged by this group, and not visible with any other APT actor. For example, the case of\n“A Strange Coinminer” delivered through the ManageEngine Desktop Central software.\n2. In encryption methods: We saw a Spritz variant of RC4 in the watering hole attacks against Polish and Mexican\n\n[banks; later Lazarus used a modified RC4 in Operation In(ter)ception. In this campaign, it is a modified A5/1 stream](https://web-assets.esetstatic.com/wls/2020/06/ESET_Operation_Interception.pdf)\ncipher that degrades to a single-byte XOR in many cases.\n\n## Malware analysis\n\nIt is a common characteristic of many APT groups, especially Lazarus, that they unleash their arsenal within several stages\nthat execute as a cascade: from the dropper to intermediate products (the Loader, serving as an injector) up to the final\npayloads (the Downloader, the Module). The same is true for this campaign.\n\nDuring our analysis we found similarities in code and architecture between Lazarus malware delivered via this WIZVERA\n[supply-chain attack and the malware described in the Operation BookCodes report (part one,](https://www.boho.or.kr/filedownload.do?attach_file_seq=2452&attach_file_id=EpF2452.pdf) [part two) published by Korea](https://www.boho.or.kr/filedownload.do?attach_file_seq=2455&attach_file_id=EpF2455.pdf)\nInternet & Security Agency this year.\n\n### Comparison with Operation BookCodes\n\n_Table 1. Common characteristics between two Lazarus operations_\n\n**Parameter/**\n**Campaign** **Operation BookCodes** **Via WIZVERA Vera Port**\n\n\nLocation of\ntargets\n\n\nSouth Korea South Korea\n\n\nTime Q1-Q2 2020 Q2-Q3 2020\n\n\nMethods of\ncompromise\n\nFilename of\nthe dropper\n\n\nKorean spearphishing email (link to download or\nHWP attachment)\n\nWatering hole website\n\nC:\\Windows\\SoftwareDistribution\\Download\\BIT[45digits].tmp\n\n\nSupply-chain attack\n\nC:\\Windows\\SoftwareDistribution\\Download\\BIT388293.tmp\n\n\n-----\n\n**Parameter/**\n**Campaign** **Operation BookCodes** **Via WIZVERA Vera Port**\n\n\nBinary\nconfiguration\nfile\n\nLoader\nname\n\n\nperf91nc.inf (12000 bytes) assocnet.inf (8348 bytes)\n\nnwsapagentmonsvc.dll Btserv.dll\n\niasregmonsvc.dll\n\n\nRC4 key 1qaz2wsx3edc4rfv5tgb$%^&*!@#$ 1q2w3e4r!@#$%^&*\n\nLog file %Temp%\\services_dll.log %Temp%\\server_dll.log\n\n## Signed initial downloader\n\nThis is the Lazarus component delivered via the VeraPort hijack described earlier. The signed initial downloaders are Themidaprotected binaries, which download, decrypt and execute other payloads in memory, without dropping them to the disk. This\ndownloader sends an HTTP POST request to a hardcoded C&C server, decrypts the server’s answer using the RC4 algorithm,\nand executes it in memory using its own loader for PE files.\n\n_Figure 6. The POST request made by the initial downloader_\n\nInterestingly, both discovered samples send a small, hardcoded ID in the body of the POST request: MagicLineNPIZ.gif or\ndelfino.gif.\n\n\n-----\n\n-----\n\n_g_ _p_\n\n### Dropper\n\nThis is the initial stage of the cascade. While one can’t see any polymorphism or obfuscation in the code, it encapsulates three\nencrypted files in its resources. Moreover, it’s a console application expecting three parameters in an encrypted state: the\nname of the first file (the Loader, Btserv.dll), the name of the second file (the Downloader, bcyp655.tlb), and the necessary\ndecryption key for the previous values (542).\n\nBIT388293.tmp oJaRh5CUzIaOjg== aGlzejw/PyR+Zmg= 542\n\nThe extraction of resources is one of two main roles of the dropper; it does so in the %WINDOWS%\\SYSTEM32 folder,\ndecrypting the Loader and preserving the encrypted state of the Downloader that will be decrypted just before being injected\ninto another process. It also drops the configuration file assocnet.inf that will later be leveraged by the final payloads, namely\nthe Downloader and the Module. Then it chooses a service by checking the following list of three legitimate service names\nWinmgmt;ProfSvc;wmiApSrv; and injects the Downloader into the matched service using reflective DLL injection.\n\nThe file name of the Loader is stored in the following Windows registry value:\n\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages\n\n_Figure 8. The decompiled code of the dropper_\n\n### Loader\n\nThis component is a Themida-protected file. We estimate the version of Themida to be 2.0-2.5, which agrees with KrCERT’s\nreport (page 20). The Loader serves as a simple injector that is looking for its injection parameters in the resources: the name\nof the encrypted file and the decryption key, which is the string “542”. The instance delivered by the dropper looks for the file\nbcyp655.tlb (the Downloader). It creates a mutex Global\\RRfreshRA_Mutex_Object. The choice of the targeted service and the\ninjection method are the same as in the dropper.\n\nLet us talk for a while about the encryption method used by the dropper and by this loader. The common key is the string\n“542”, which is initially provided as a command-line parameter to the Dropper and subsequently as a 3-byte encrypted\nresource for the Loader. To expand a short master key to a larger expanded key (so-called key scheduling), the MD5 hash of\nthe string is computed, which is 7DCD340D84F762EBA80AA538B0C527F7. Then it takes first three double words, let's\n\n\n-----\n\ndenote them A : 0x7DCD340D, B : 0x84f762EB, C: 0xA80aa538. The length of an encrypted buffer is divided by 3, and\nthis is the number of iterations that transforms the initial sequence (A,B,C) into the proper key. In every iteration (X,Y,Z)\nbecomes (X^Y, Y^Z, X^Y^Z). Because the XOR operation (denoted ^) is commutative and transitive, and its square is zero,\nwhich leaves everything unchanged, we can compute that after 8 iterations we get the identity, so the key could reach just 7\npairwise different states and is equal to the first 12 characters of the MD5 hash of \"542\" if the length is a multiple of 24.\n\nWhat is interesting is how the remainder of the length division by 3 is treated. If the number of iterations was increased by this\nremainder, then we would reach just another of the 7 states of the key. However, the twist is in the change of operation: ^ is\nreplaced with the OR operation in the code for the remainder. For example, the key with the remainder 1 becomes {FE F7 3A\nF9 F7 D7 FF FD FF F7 FF FD} for one of the states (of (C, A^B, B^C) to be precise), so we get new possible transformations\nof the key that tend to be more likely to be ones than zeroes.\n\n[That was the part preparing the key. The encryption algorithm itself looks like A5/1 at first glance. It was a secret technology](https://en.wikipedia.org/wiki/A5/1)\ndeveloped in 1987 and used in over-the-air communication privacy in the GSM cellular telephone standard until reverseengineered in 1999. The crucial part of the algorithm is three linear feedback shift registers (LFSRs). However, only the lengths\nof LFSRs in the malware code coincide with the official implementation, not the constants.\n\n_Table 2. Comparison of crypto algorithms between malware and the official implementation_\n\n**LFSR** **Malware code** **Official A5/1**\n\n1 Length: 19 Length: 19\n\nConstants: 13, 16, 17, 18 Constants: 13, 16, 17, 18\n\n2 Length: 22 Length: 22\n\nConstants: 12, 16, 20, 21 Constants: 20, 21\n\n3 Length: 23 Length: 23\n\nConstants: 17,18,21,22 Constants: 7, 20, 21, 22\n\nThe decryption loop in each iteration basically derives a 1-byte XOR key for the corresponding byte of the encrypted buffer.\nThe purpose of LFSRs is that they could transform the key, so the whole process is much more complicated. But due to the\nmentioned change of the operation, LFSRs would not affect it and the 1-byte XOR key remains the same for all iterations.\n\n### Downloader, aka WinHttpClient\n\nThe main downloader is dropped by the Dropper component under the bcyp655.tlb name and injected into one of the services\nby the Loader. Its main purpose is to deliver additional stages onto the victim’s computers. The network protocol is based on\nHTTP but requires several stages to establish a trusted connection.\n\nThe malware fingerprints the victim’s system: see Figure 9.\n\n\n-----\n\n_Figure 9. The length of the buffer is 0x114 and contains campaign ID, local IP address, Windows version, processor version_\n\n_(cf. KrCERT page 59, Figure [4-17])_\n\nThe first step is authorization. After sending randomly generated, generic parameters code and id, the expected response\nstarts with <!DOCTYPE HTML PUBLIC Authentication En> followed by additional data delimited by a semicolon. However, in\nthe next POST request the parameters are already based on the victim’s IP. Because we didn’t know which victims were\ntargeted, during our investigation, we always received a “Not Found” reply, not the successful “OK”.\n\n_Figure 10. Primary message exchange with C&C having generic parameters code and id_\n\n\n-----\n\n_Figure 11. Secondary message exchange with C&C having a specific parameter name_\n\nIf the victim passes these introductory messages and the connection is acknowledged, then the decrypted response starts with\nan interesting artifact: a keyword ohayogonbangwa!!. As a whole, we haven’t found that word on the internet, but the closest\nmeaning could be “Ohayo, Konbangwa” (おはようこんばんぐぁ), which is “Good morning, good evening” in Japanese. From\nthis point, there are more messages that are exchanged, with the final exchange asking for an executable to load into memory.\n\n_Figure 12. Japanese artifact in the code_\n\n### Module, the final RAT payload\n\n\n-----\n\nThis is a RAT with a set of typical features used by the Lazarus group. The commands include operations on the victim s\nfilesystem and the download and execution of additional tools from the attacker’s arsenal. They are indexed by 32-bit integers\nand coincide with those reported by KrCERT on page 61.\n\n_Figure 13. Some of the commands supported by Module_\n\n## Conclusion\n\nAttackers are constantly trying to find new ways to deliver malware to target computers. Attackers are particularly interested in\nsupply-chain attacks, because they allow them to covertly deploy malware on many computers at the same time. In recent\n[years ESET researchers analyzed such cases as M.E.Doc,](https://www.welivesecurity.com/2017/07/04/analysis-of-telebots-cunning-backdoor/) [Elmedia Player,](https://www.welivesecurity.com/2017/10/20/osx-proton-supply-chain-attack-elmedia/) [VestaCP,](https://www.welivesecurity.com/2018/10/18/new-linux-chachaddos-malware-distributed-servers-vestacp-installed/) [Statcounter, and the](https://www.welivesecurity.com/2018/11/06/supply-chain-attack-cryptocurrency-exchange-gate-io/) [gaming industry.](https://www.welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/)\nWe can safely predict that the number of supply-chain attacks will increase in the future, especially against companies whose\nservices are popular in specific regions or in specific industry verticals.\n\nThis time we analyzed how the Lazarus group used a very interesting approach to target South Korean users of WIZVERA\nVeraPort software. As mentioned in our analysis, it’s the combination of compromised websites with WIZVERA VeraPort\nsupport and specific VeraPort configuration options that allow attackers to perform this attack. Owners of such websites could\ndecrease the possibility of such attacks, even if their sites are compromised, by enabling specific options (e.g. by specifying\nhashes of binaries in the VeraPort configuration).\n\nSpecial thanks to Dávid Gábriš and Peter Košinár.\n\n_For any inquiries, or to make sample submissions related to the subject, contact us at threatintel@eset.com_\n\n## Indicators of Compromise (IoCs)\n\n### ESET detection names\n\nWin32/NukeSped.HW\n\nWin32/NukeSped.FO\n\nWin32/NukeSped.HG\n\nWin32/NukeSped.HI\n\nWin64/NukeSped.CV\n\nWin64/NukeSped.DH\n\nWin64/NukeSped.DI\n\nWin64/NukeSped.DK\n\nWin64/NukeSped.EP\n\n### SHA-1 of signed samples\n\n3D311117D09F4A6AD300E471C2FB2B3C63344B1D\n\n3ABFEC6FC3445759730789D4322B0BE73DC695C7\n\n\n-----\n\n### SHA 1 of samples\n\n5CE3CDFB61F3097E5974F5A07CF0BD2186585776\n\nFAC3FB1C20F2A56887BDBA892E470700C76C81BA\n\nAA374FA424CC31D2E5EC8ECE2BA745C28CB4E1E8\n\nE50AD1A7A30A385A9D0A2C0A483D85D906EF4A9C\n\nDC72D464289102CAAF47EC318B6110ED6AF7E5E4\n\n9F7B4004018229FAD8489B17F60AADB3281D6177\n\n2A2839F69EC1BA74853B11F8A8505F7086F1C07A\n\n8EDB488B5F280490102241B56F1A8A71EBEEF8E3\n\n### Code signing certificate serial numbers\n\n00B7F19B13DE9BEE8A52FF365CED6F67FA\n\n4C8DEF294478B7D59EE95C61FAE3D965\n\n### C&C\n\nhttp://www.ikrea.or[.]kr/main/main_board.asp\n\nhttp://www.fored.or[.]kr/home/board/view.php\n\nhttps://www.zndance[.]com/shop/post.asp\n\nhttp://www.cowp.or[.]kr/html/board/main.asp\nhttp://www.style1.co[.]kr/main/view.asp\n\nhttp://www.erpmas.co[.]kr/Member/franchise_modify.asp\n\nhttps://www.wowpress.co[.]kr/customer/refuse_05.asp\n\nhttps://www.quecue[.]kr/okproj/ex_join.asp\n\nhttp://www.pcdesk.co[.]kr/Freeboard/mn_board.asp\n\nhttp://www.gongsinet[.]kr/comm/comm_gongsi.asp\n\nhttp://www.goojoo[.]net/board/banner01.asp\n\nhttp://www.pgak[.]net/service/engine/release.asp\n\nhttps://www.gncaf.or[.]kr/cafe/cafe_board.asp\n\nhttps://www.hsbutton.co[.]kr/bbs/bbs_write.asp\n\nhttps://www.hstudymall.co[.]kr/easypay/web/bottom.asp\n\n### Mutexes\n\nGlobal\\RRfreshRA_Mutex_Object\n\n## References\n\n[KrCERT/CC, “Operation BookCodes TTPs#1 Controlling local network through vulnerable websites”, English Translation, 1st](https://www.boho.or.kr/filedownload.do?attach_file_seq=2452&attach_file_id=EpF2452.pdf)\nApril 2020\n\nKrCERT/CC, “Operation BookCodes TTPs#2 스피어 [피싱으로](https://www.boho.or.kr/filedownload.do?attach_file_seq=2455&attach_file_id=EpF2455.pdf) 정보를 수집하는 공격망 구성 방식 분석”, Korean, 29 Juneth\n2020\n\n[P. Kálnai, M. Poslušný: “Lazarus Group: a mahjong game played in different sets of tiles”, Virus Bulletin 2018 (Montreal)](https://www.virusbulletin.com/uploads/pdf/magazine/2018/VB2018-Kalnai-Poslusny.pdf)\n\n[P. Kálnai: “Demystifying targeted malware used against Polish banks”, WeLiveSecurity, February 2017](https://www.welivesecurity.com/2017/02/16/demystifying-targeted-malware-used-polish-banks/)\n\n[P. Kálnai, A. Cherepanov “Lazarus KillDisks Central American casino”, WeLiveSecurity, April 2018](https://www.welivesecurity.com/2018/04/03/lazarus-killdisk-central-american-casino)\n\n[D. Breitenbacher, K. Osis: “Operation In(ter)ception: Aerospace and military companies in the crosshairs of cyberspies”, June](https://web-assets.esetstatic.com/wls/2020/06/ESET_Operation_Interception.pdf)\n2020\n\n[Novetta et al, “Operation Blockbuster”, February 2016, https://www.operationblockbuster.com/resources](https://www.operationblockbuster.comhttps//web-assets.esetstatic.com/wls/2016/02/Operation-Blockbuster-Report.pdf)\n\n[Marcus Hutchins, “How to accidentally stop a global cyber-attack”, May 2015](https://www.malwaretech.com/2017/05/how-to-accidentally-stop-a-global-cyber-attacks.html)\n\n[Kaspersky GReAT: “APT trends report Q2 2020”, July 2020](https://securelist.com/apt-trends-report-q2-2020/97937/)\n\n[A. Kasza: “The Blockbuster Saga Continues”, Palo Alto Networks, August 2017](https://researchcenter.paloaltonetworks.com/2017/08/unit42-blockbuster-saga-continues/)\n\nUS-CERT CISA, [https://us-cert.cisa.gov/northkorea](https://us-cert.cisa.gov/northkorea)\n\n[WeLiveSecurity: “Sony Pictures hacking traced to Thai hotel as North Korea denies involvement”, December 2014](https://www.welivesecurity.com/2014/12/08/sony-pictures-hacking-traced-thai-hotel-north-korea-denies-involvement/)\n\n[R. Sherstobitoff, I. Liba. J. Walter: “Dissecting Operation Troy: Cyberespionage in South Korea”, McAfee® Labs, May 2018](https://www.mcafee.com/enterprise/en-us/assets/white-papers/wp-dissecting-operation-troy.pdf)\n\n[McAfee Labs: “Ten Days of Rain”, July 2011](https://www.mcafee.com/https://web-assets.esetstatic.com/wls/2011/07/McAfee-Labs-10-Days-of-Rain-July-2011.pdf)\n\n\n-----\n\n[Fireye/Mandiant: Why Is North Korea So Interested in Bitcoin?, September 2017](https://www.fireeye.com/blog/threat-research/2017/09/north-korea-interested-in-bitcoin.html)\n[Choe Sang-Hun: “Computer Networks in South Korea Are Paralyzed in Cyberattacks”, March 2013](https://www.nytimes.com/2013/03/21/world/asia/south-korea-computer-network-crashes.html)\n\nA5/1 stream cipher, [Wikipedia](https://en.wikipedia.org/wiki/A5/1)\n\n## MITRE ATT&CK techniques\n\n[Note: This table was built using version 8 of the MITRE ATT&CK framework.](https://attack.mitre.org/versions/v8/)\n\n**Tactic** **ID** **Name** **Description**\n\n\nResource\nDevelopment\n\n\n[T1584.004](https://attack.mitre.org/versions/v8/techniques/T1584/004/) Compromise Infrastructure:\nServer\n\n\nThe Lazarus group uses compromised servers as\ninfrastructure.\n\n\n[T1587.001](https://attack.mitre.org/versions/v8/techniques/T1587/001/) Develop Capabilities: Malware The Lazarus group developed custom malware and malware\ncomponents.\n\n\n[T1588.003](https://attack.mitre.org/versions/v8/techniques/T1588/003/) Obtain Capabilities: Code\nSigning Certificates\n\nInitial Access [T1195.002](https://attack.mitre.org/versions/v8/techniques/T1195/002/) Supply Chain Compromise:\nCompromise Software Supply\nChain\n\n\nThe Lazarus group obtained code-signing certificates.\n\nThe Lazarus group pushed this malware using a supply-chain\nattack via WIZVERA VeraPort.\n\n\nExecution [T1106](https://attack.mitre.org/versions/v8/techniques/T1106/) Native API The Lazarus payload is executed using native API calls.\n\n\nPersistence [T1547.005](https://attack.mitre.org/versions/v8/techniques/T1547/005/) Boot or Logon Autostart\nExecution: Security Support\nProvider\n\n\nThe Lazarus malware maintains persistence by installing an\nSSP DLL.\n\n\nDefense\nEvasion\n\nCommand\nand Control\n\n\n[T1036](https://attack.mitre.org/versions/v8/techniques/T1036/) Masquerading The Lazarus malware masqueraded as a South Korean\nsecurity software\n\n\n[T1553.002](https://attack.mitre.org/versions/v8/techniques/T1553/002/) Subvert Trust Controls: Code\nSigning\n\n[T1071.001](https://attack.mitre.org/versions/v8/techniques/T1071/001/) Application Layer Protocol:\nWeb Protocols\n\n[T1573.001](https://attack.mitre.org/versions/v8/techniques/T1573/001/) Encrypted Channel:\nSymmetric Cryptography\n\n\n[T1027.002](https://attack.mitre.org/versions/v8/techniques/T1027/002/) Obfuscated Files or\nInformation: Software Packing\n\n\nThe Lazarus group uses Themida-protected malware.\n\n\n[T1055](https://attack.mitre.org/versions/v8/techniques/T1055/) Process Injection The Lazarus malware injects itself in svchost.exe.\n\n\nThe Lazarus group used illegally obtained code-signing\ncertificates to sign the initial downloader used in this supplychain attack.\n\nThe Lazarus malware uses HTTP for C&C.\n\nThe Lazarus malware uses the RC4 algorithm to encrypt its\nC&C communications.\n\n\nExfiltration [T1041](https://attack.mitre.org/versions/v8/techniques/T1041/) Exfiltration Over C2 Channel The Lazarus malware exfiltrates data over the C&C channel.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/opajzpvg0i3c0gncj3eranvuhdxajckd"
    ],
    "report_names": [
        "ESET_Lazarus-supply-chain-attack-SouthKorea(11-16-2020)"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "39842197-944a-49fd-9bec-eafa1807e0ea",
            "created_at": "2022-10-25T16:07:24.310589Z",
            "updated_at": "2025-03-27T02:02:10.167471Z",
            "deleted_at": null,
            "main_name": "TeleBots",
            "aliases": [],
            "source_name": "ETDA:TeleBots",
            "tools": [
                "BadRabbit",
                "Black Energy",
                "BlackEnergy",
                "CredRaptor",
                "Diskcoder.C",
                "EternalPetya",
                "ExPetr",
                "Exaramel",
                "FakeTC",
                "Felixroot",
                "GreyEnergy",
                "GreyEnergy mini",
                "KillDisk",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "NonPetya",
                "NotPetya",
                "Nyetya",
                "Petna",
                "Petrwrap",
                "Pnyetya",
                "TeleBot",
                "TeleDoor",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "nPetya"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1704420423,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1704342555,
    "ts_modification_date": 1704342555,
    "files": {
        "pdf": "https://archive.orkl.eu/d775eada6c8549d916011b4505bc4862328c454b.pdf",
        "text": "https://archive.orkl.eu/d775eada6c8549d916011b4505bc4862328c454b.txt",
        "img": "https://archive.orkl.eu/d775eada6c8549d916011b4505bc4862328c454b.jpg"
    }
}