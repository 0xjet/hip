{
    "id": "5e55e4c9-ddbe-4bcb-af4c-27d7c3b391e8",
    "created_at": "2022-10-25T16:48:24.340361Z",
    "updated_at": "2025-03-27T02:15:38.084986Z",
    "deleted_at": null,
    "sha1_hash": "2e682dca2ba1ed2bf2ac50d0d07f22c9b6bb0359",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-10-20T06:06:16Z",
    "file_modification_date": "2021-10-20T06:06:16Z",
    "file_size": 2409092,
    "plain_text": "# Whatta TA: TA505 Ramps Up Activity, Delivers New FlawedGrace Variant\n\n**[proofpoint.com/us/blog/threat-insight/whatta-ta-ta505-ramps-activity-delivers-new-flawedgrace-variant](https://www.proofpoint.com/us/blog/threat-insight/whatta-ta-ta505-ramps-activity-delivers-new-flawedgrace-variant)**\n\nOctober 15, 2021\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nWhatta TA: TA505 Ramps Up Activity, Delivers New FlawedGrace Variant\n\nOctober 19, 2021\nZydeca Cass, Axel F, Crista Giering, Matthew Mesa, Georgi Mladenov,\nand Brandon Murphy\n\n## Key Takeaways\n\nThe prominent TA505 has returned to distributing large volumes of malicious\nemails affecting most industries.\nNew tools include a KiXtart Loader, the MirrorBlast loader, an updated\nFlawedGrace variant, and updated malicious Excel attachments.\nOne of the region-specific campaigns targeted German-speaking countries, notably\nGermany and Austria.\nThe campaigns share many similarities with TA505 campaigns from 2019 and\n2020.\n\n## Overview\n\nSince early September 2021, Proofpoint researchers are tracking renewed malware\n[campaigns by the financially driven TA505. The campaigns, which are distributed across](https://www.proofpoint.com/us/threat-insight/post/threat-actor-profile-ta505-dridex-globeimposter)\na wide range of industries, started with low volume email waves that ramped up in late\nSeptember, resulting in tens to hundreds of thousands of emails.\n\nMany of the campaigns, especially the large volume ones, strongly resemble the historic\nTA505 activity from 2019 and 2020. The commonalities include similar domain naming\nconventions, email lures, Excel file lures, and the delivery of the FlawedGrace remote\n\n\n-----\n\naccess trojan (RAT). The campaigns also contain some noteworthy, new developments,\nsuch as retooled intermediate loader stages scripted in Rebol and KiXtart, which are used\ninstead of the previously popular Get2 downloader. The new downloaders perform\nsimilar functionality of reconnaissance and pulling in the next stages. Lastly, there is an\nupdated version of FlawedGrace.\n\n## Evolving Campaigns\n\nThe initial campaigns observed by Proofpoint in September 2021 were comparatively\nsmall in volume, several thousand emails per wave, and delivered malicious Excel\nattachments. In late September and in early October 2021 this changed, and TA505 began\nsending higher email volumes, tens to hundreds of thousands, to more industries.\nAdditionally, the actor began leveraging both URL and attachment-based email\ncampaigns and diversified from targeting predominantly North America to also targeting\nGerman-speaking countries, including Germany and Austria.\n\n## September 2021 Campaigns\n\nThe early campaigns identified by Proofpoint in September 2021 were low volume\ncompared to typical TA505 activity, with only several thousand messages per wave.\nTA505 used more specific lures that did not affect as many industries as the more recent\nOctober 2021 campaigns. Example lures included legal, media release, situation report,\nand health claim themes. These early campaigns also largely focused on targets in North\nAmerica, such as United States and Canada.\n\nThe emails contained an Excel attachment that, when opened and macros enabled, would\nlead to the download and running of an MSI file. The MSI file in turn would execute an\nembedded Rebol loader, dubbed by Proofpoint as MirrorBlast.\n\n\n-----\n\n_Figure 1. Email purporting to be from an insurance claims analyst, part of the_\n_September 28, 2021 campaign._\n\n_Figure 2. The insurance claim Excel attachment, part of the September 28, 2021_\n_campaign._\n\n## October 2021 Campaigns\n\n\n-----\n\nIn late September and throughout October 2021, Proofpoint observed a shift to familiar\nTA505 tactics, techniques, and procedures (TTPs) that are reminiscent of the actor’s 2019\nand 2020 campaigns. An additional intermediary loader scripted in KiXtart was\nintroduced, and the attack chain evolved to the following:\n\nAn email containing one of the below:\n\nExcel attachment\nHTML attachment that links to the download of an Excel file\nURL linking to a landing page that redirects to the download of an Excel file\nURL directly linking to an Excel file\nThe Excel file macros download and run an MSI file\nThe MSI file executes an embedded KiXtart loader\nThe KiXtart loader receives a command from the C&C server to download another\nMSI file that executes MirrorBlast\nMirrorBlast then downloads additional Rebol script stagers\nThe follow-on Rebol stagers drop ReflectiveGnome\nReflectiveGnome in turn downloads more shellcode, that will then drop and\ndetonate FlawedGrace\n\nThe email lures moved away from the detailed lures seen initially in this spate of\ncampaigns. They became more generic, with subjects such as “SECUREFILE,” “SECURE\nDOCUMENT,” and “You’ve been sent a secure message.” Additionally, the themes and\nabused brands included COVID-19, DocuSign, insurance, invoices, and Microsoft.\n\n_Figure 3 October 13 2021 German-language email using a OneDrive shared file lure_\n\n\n-----\n\n_Figure 4. October 13, 2021 landing page abusing Microsoft and OneDrive branding._\n\n_Figure 5. Excel file used in the October 13, 2021 campaign with a simple green lure._\n\n## Similarities to Historic TA505 Activity\n\n\n-----\n\nThere is much similarity between the new and historic TA505 campaigns, starting with\nthe emails.\n\n_Figure 6. The OneDrive shared file email lure used in August 21, 2020 (left) strongly_\n_resembles a similar email from October 7, 2021 (right). Note the additional use of a_\n_COVID-19 theme in the recent campaign._\n\nThe landing pages in historic and current TA505 campaigns contain “IP Logger” links\nthat likely enable TA505 to track the IP addresses of the machines downloading the\nmalicious files. Additionally, TA505 is still mimicking file hosting services in the landing\npages.\n\n\n-----\n\n_Figure 7. The landing page used in a November 21, 2019 campaign is shown on the left,_\n_while the landing page used in the October 7, 2021 campaign is shown on the right._\n\nWhile the Excel macros VBA code in the recent TA505 campaigns is different, some of the\n**Excel graphic lures are similar or identical to those previously used by TA505.**\n\n\n-----\n\n_Figure 8. The Excel sheet lure spoofing Microsoft logos remained identical from_\n_September 2, 2020 (Left) to October 6, 2021 (Right)._\n\n**Domain naming conventions: It is also notable that TA505 has historically used**\ndomains that mimic various file hosting service providers and structured them in formats\nwith hyphen separated terms. The domains used in late September 2021 and onward\nfollow this structure.\n\n**Code reuse: Proofpoint researchers found code reuse in parts of the delivery chain such**\n[as in multiple parts of the landing page (see an example mentioned here).](https://twitter.com/stoerchl/status/1448561662181658628)\n\n## Excel Macros Analysis\n\nFor TA505’s 2021 campaigns to be successful, potential victims must enable macros after\nopening the malicious Excel files. The code responsible for downloading the next stage\nMSI file was typically lightly obfuscated with filler characters, string reversing or similar\nsimple functions and hidden in the document Comments, Title, in a Cell or other\nlocations.\n\n\n-----\n\n_Figure 9. Example Excel macros code._\n\n_Figure 10. The parameters Subject and Comments are stored in the workbook_\n_properties._\n\n_Figure 11. Deobfuscated downloader JScript. This pulls the next stage—an MSI file._\n\n## Intermediate Loaders\n\n\n-----\n\nTA505 now uses multiple intermediate loaders before the delivery of the FlawedGrace\nRAT. The new loader stages are coded in uncommon scripting languages—Rebol and\n[KiXtart. They appear to serve the same purpose as Get2—a downloader that has been in](https://www.proofpoint.com/us/threat-insight/post/ta505-distributes-new-sdbbot-remote-access-trojan-get2-downloader)\nuse by TA505 since 2019 to deliver a variety of secondary payloads. The loaders perform\nminimal reconnaissance of an infected machine, such as collecting user domain and\nusername information, and download further payloads.\n\n_Figure 12. Attack paths ultimately leading to FlawedGrace._\n\nIn the attack chain, the Excel macros download the first MSI file, which executes the first\nloader, encoded in KiXtart scripting language. The KiXtart interpreter then receives a\ncommand from the C&C server to download a follow-on MSI package. Of note, KiXtart\nloader is not always part of the attack chain. The second MSI package contains multiple\nfiles that may have different names, for example, AudioDriver.exe (the Rebol interpreter),\nAudioDriver.exe.lnk (command that informs .ico execution), and image.ico (the Rebol\nscript). This Rebol script is the second new downloader in the chain, that Proofpoint\ndubbed MirrorBlast.\n\n_Figure 13. Example of MirrorBlast script, it may be slightly different in different_\n_campaigns._\n\nMirrorBlast in turn downloads additional Rebol script stagers that execute simple\ndownloaders, dubbed by Proofpoint as ReflectiveGnome. ReflectiveGnome in turn\ndownloads more shellcode, that will then drop and detonate FlawedGrace.\n\n\n-----\n\n_Figure 14. Rebol script downloaded by MirrorBlast that drops ReflectiveGnome loader_\n_(dwm-x64.exe / dwm-x32.exe)._\n\n\n-----\n\n_Figure 15. ReflectiveGnome loader which executes the next stage as a shellcode._\n\n\n-----\n\n_Figure 16. This shellcode drops and detonates an updated FlawedGrace._\n\n## Updated FlawedGrace RAT\n\n[Proofpoint researchers first observed FlawedGrace in November 2017. It is a full-featured](https://www.proofpoint.com/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505)\nRAT written in C++ that can receive the following commands from its C&C via a custom\nbinary protocol on TCP port 443:\n\ntarget_remove\ntarget_update\ntarget_reboot\ntarget_module_load\ntarget_module_load_external\ntarget_module_unload\ntarget_download\ntarget_upload\ntarget_rdp\ntarget_passwords\ntarget_servers\ntarget_script\ndestroy_os\n\n\n-----\n\ndesktop_stat\n\nWhile Proofpoint researchers are still investigating the updates to this version of\nFlawedGrace, some notable changes include:\n\nEncrypted strings\nObfuscated API calls\nConfiguration is now stored as an encrypted resource (initial/default config), then it\nis stored both in a mapped memory region (current configuration instance) and in\nthe registry (persistence)\n\n## Attribution\n\nProofpoint attributes the campaigns discussed in this blog to TA505 with high confidence.\nProofpoint's assessment that TA505 is responsible for this renewed activity is based on\nthe aforementioned similarities between historic TA505 campaigns and this new activity,\nincluding, but not limited to, code similarities, domain naming patterns and the use of\nFlawedGrace, which has been almost exclusively linked to TA505 activity.\n\n## Outlook\n\nTA505 is an established threat actor that is financially motivated and known for\nconducting malicious email campaigns on a previously unprecedented scale. The group\n[regularly changes their TTPs and are considered trendsetters in the world of cybercrime.](https://www.proofpoint.com/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505)\nThis threat actor does not limit its target set, and is, in fact, an equal opportunist with the\ngeographies and verticals it chooses to attack. This combined with TA505’s ability to be\nflexible, focusing on what is the most lucrative and shifting its TTPs as necessary, make\nthe actor a continued threat.\n\nProofpoint researchers expect TA505 to continue to adjust its operations and methods\nalways with an eye to financial gain. Using intermediate loaders in its attack chain is also\nlikely to become a longer-term technique employed by the threat actor.\n\n**EmergingThreats Detection Rules**\n\n2034012 - ET TROJAN MirrorBlast Checkin (trojan.rules)\n\n2034022 - ET TROJAN MirrorBlast CnC Activity M2 (trojan.rules)\n\n2034023 - ET TROJAN MirrorBlast CnC Activity M3 (trojan.rules)\n\n2034091 - ET TROJAN MirrorBlast KiXtart Downloader Client Request (trojan.rules)\n\n2034110 - ET TROJAN MirrorBlast KiXtart Downloader Server Response (trojan.rules)\n\n2034136 - ET TROJAN MirrorBlast KiXtart Downloader Client Request M2 (trojan.rules)\n\n2034042 - ET TROJAN ReflectiveGnome Download Activity (trojan.rules)\n\n\n-----\n\n**EmergingThreats PRO Detection Rules**\n\n2850099 - ETPRO TROJAN FlawedGrace CnC Activity M2 (trojan.rules)\n\n2850098 - ETPRO TROJAN FlawedGrace CnC Activity M1 (trojan.rules)\n\n**Indicators of Compromise**\n\n\n**IOC** **IOC**\n**Type**\n\n\n**Description**\n\n\nhxxp://139.59.93.223/c[.]php URL MirrorBlast C&C\n\nhxxp://menorukis[.]su URL MirrorBlast C&C\n\nhxxp://fidufagios[.]com/ URL MirrorBlast C&C\n\nhxxp://feristoaul[.]com/ URL MirrorBlast C&C\n\nhxxp://172.105.178.119/install[.]msi URL MSI Download\n\nhxxp://207.246.101.153/chrome[.]msi URL MSI Download\n\nhxxp://207.246.101.153/setup[.]msi URL MSI Download\n\ncdn-wfs-nspod[.]com Domain FlawedGrace\nC&C\n\n\nhxxps://cdn03664-dlfileshare[.]com/files/xls/Employee%20Update%20%20Covid[.]xls\n\nhxxps://cdn-8846-sharepointoffice[.]com/CL09302021_00137[.]xls\n\nhxxps://cdn-8846-sharepointoffice[.]com/COVID19_list[.]xls\n\nhxxps://cdn-8846-sharepointoffice[.]com/FP01102021_001[.]xls\n\n\nURL Initial Download\n\nURL Initial Download\n\nURL Initial Download\n\nURL Initial Download\n\n\n-----\n\nhxxps://dzikic-mysharepoint[.]com/file/Manulife_policy[.]xls\n\nhxxps://dzikics-mysharepoint[.]com/file/Employee_Authorization_Form[.]xls\n\n\nURL Initial Download\n\nURL Initial Download\n\n\nhxxp://141.164.41[.]231/host64_sh[.]bin URL MirrorBlast\nPayload\n(FlawedGrace)\n\nhxxp://141.164.41[.]231/host32_pic[.]bin URL MirrorBlast\nPayload\n(FlawedGrace)\n\nhxxp://89.44.197[.]46/host64_sh[.]bin URL MirrorBlast\nPayload\n(FlawedGrace)\n\nhxxp://89.44.197[.]46/host32_pic[.]bin URL MirrorBlast\nPayload\n(FlawedGrace)\n\nhxxp://193.42.36[.]110/host64_sh[.]bin URL MirrorBlast\nPayload\n(FlawedGrace)\n\nhxxp://193.42.36[.]110/host32_pic[.]bin URL MirrorBlast\nPayload\n(FlawedGrace)\n\nhxxp://5.149.255[.]14/host64_sh[.]bin URL MirrorBlast\nPayload\n(FlawedGrace)\n\nhxxp://5.149.255[.]14/host32_pic[.]bin URL MirrorBlast\nPayload\n(FlawedGrace)\n\nhxxp://155.138.205[.]35/?pool URL First Stage Kixtart\nScript Payload\n\nhxxp://45.79.239[.]23/version.php?data= URL First Stage Kixtart\nScript C&C\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2021/2021.10.19.TA505_New_FlawedGrace/Whatta%20TA_%20TA505%20Ramps%20Up%20Activity%2C%20Delivers%20New%20FlawedGrace%20Variant%20_%20Proofpoint%20US.pdf"
    ],
    "report_names": [
        "Whatta TA_ TA505 Ramps Up Activity, Delivers New FlawedGrace Variant _ Proofpoint US"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041738,
    "ts_creation_date": 1634709976,
    "ts_modification_date": 1634709976,
    "files": {
        "pdf": "https://archive.orkl.eu/2e682dca2ba1ed2bf2ac50d0d07f22c9b6bb0359.pdf",
        "text": "https://archive.orkl.eu/2e682dca2ba1ed2bf2ac50d0d07f22c9b6bb0359.txt",
        "img": "https://archive.orkl.eu/2e682dca2ba1ed2bf2ac50d0d07f22c9b6bb0359.jpg"
    }
}