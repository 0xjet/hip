{
    "id": "74f96ace-b481-461c-99b4-ce07131a0a71",
    "created_at": "2023-01-12T15:09:03.476597Z",
    "updated_at": "2025-03-27T02:06:03.18933Z",
    "deleted_at": null,
    "sha1_hash": "8d0ffd3f6f1d4757e4e415dd6bf0de01da4c5aff",
    "title": "2021-11-02 - BlackMatter Ransomware- In-Depth Analysis & Recommendations",
    "authors": "",
    "file_creation_date": "2022-05-28T19:06:51Z",
    "file_modification_date": "2022-05-28T19:06:51Z",
    "file_size": 1209540,
    "plain_text": "# BlackMatter Ransomware: In-Depth Analysis & Recommendations\n\n**varonis.com/blog/blackmatter-ransomware/**\n\n## Executive Summary\n\nCISA has issued a [security bulletin regarding the BlackMatter 'big game hunter' ransomware](https://mcas-proxyweb.mcas.ms/certificate-checker?login=false&originalUrl=https%3A%2F%2Fus-cert.cisa.gov.mcas.ms%2Fncas%2Falerts%2Faa21-291a%3FMcasTsid%3D15600&McasCSRF=2bc60a206191aca56d9d8478b5cf62edfc32895f37160307f5c737c7445b92e7)\ngroup following a sharp increase in cases targeting U.S. businesses. To mitigate these\nattacks, it is recommended that organizations employ multifactor authentication (MFA) as\nwell as updating vulnerable software and systems, such as those that are commonly\nexploited by ransomware groups.\n\n## Background\n\nOver the July 4th holiday, REvil [attacked Kaseya's customers using a Sodinokibi payload](https://mcas-proxyweb.mcas.ms/certificate-checker?login=false&originalUrl=https%3A%2F%2Fwww.varonis.com.mcas.ms%2Fblog%2Frevil-msp-supply-chain-attack%2F%3FMcasTsid%3D15600&McasCSRF=2bc60a206191aca56d9d8478b5cf62edfc32895f37160307f5c737c7445b92e7)\nthat, amongst its many indicators of compromise (IOC), included a \"Blacklivesmatter\" registry\nentry.\n\n[Not long after, REvil seemingly disappeared from the dark web, potentially in an attempt to](https://mcas-proxyweb.mcas.ms/certificate-checker?login=false&originalUrl=https%3A%2F%2Fwww.bbc.com.mcas.ms%2Fnews%2Ftechnology-57826851%3FMcasTsid%3D15600&McasCSRF=2bc60a206191aca56d9d8478b5cf62edfc32895f37160307f5c737c7445b92e7)\navoid law enforcement attention or as the result of some take down action.\n\nAside from being an interesting indicator of compromise (IOC) at the time, the\n\"Blacklivesmatter\" registry entry seemingly provides an early indication of things to come,\nnamely the formation of a big game hunter ransomware group using the moniker,\n\"BlackMatter,\" that, based on our research, appears to be an amalgamation of REvil and\nDarkside's team members and tradecraft. The groups exhibit strong similarities in their\ncodebases, infrastructure configuration, techniques, and operating philosophies.\n\n\n-----\n\n[REvil and Darkside, as we know, have been two of the most prolific ransomware groups](https://www.varonis.com/blog/darkside-ransomware?hsLang=en)\nthroughout 2020 and 2021, with landmark attacks on Colonial Pipeline and JBS as well as\nthe infamous Travelex incident that saw the organization and their customers suffering\ndisruption for months.\n\n## Targets\n\nWhile mainly targeting Windows based systems, we have observed unique payloads\ntargeting Linux systems, as well. Linux payloads don't encrypt data; they act as remote\naccess trojans (RATs) to pivot to other windows-based machines.\n\nSince forming BlackMatter in mid-July 2021, the group's first foray seemingly targeted a USbased architecture company in, or around, July 28, 2021, some three weeks after the\n[Kaseya incident.](https://www.varonis.com/blog/revil-msp-supply-chain-attack?hsLang=en)\n\nFigure 1 - Example BlackMatter Ransom Negotiations\nBlackMatter offers threat actors and affiliates access to custom configurable binary payloads\nfor each victim that include unique traits such as a tailored ransom note, often providing\nproof of the stolen data, as well as the victim's name and their identifier.\n\n\n-----\n\nBased on dark web posts by an identity purporting to be BlackMatter, the group is only\ninterested in targeting businesses with more than $100M annual revenues and they are\navoiding networks that were previously compromised by Darkside or REvil. To incentivize\nothers to provide access to new potential victim networks, theoretically appealing to\nmalicious insider threats as well as initial access operators, the group offers a $100K bounty.\n\nAs seen in REvil's recruitment activity during 2020, BlackMatter have provided proof and\nreassurances of their ability to pay any would-be affiliate by depositing 4BTC (~$247K) with\nthe forum.\n\nFigure 2 - BlackMatter Forum Post\nNotably, the group appears to target organizations in English-speaking countries (explicitly\nlisting Australia, Canada, the United Kingdom, and the United States) although they exclude\nhealthcare and government institutions, likely to avoid local law enforcement action resulting\nfrom political pressure, especially in the wake of an attack that might be considered an act of\ncyber warfare.\n\n\n-----\n\n## Delivery\n\nUnlike many cyberattacks that rely on phishing to establish a foothold, BlackMatter appears\nto gain initial access primarily via the compromise of vulnerable edge devices and the abuse\nof corporate credentials obtained from other sources.\n\nWhile it is possible that some edge cases may see the use of spear-phishing campaigns and\nmalicious document payloads, leading to the compact ~80kb BlackMatter payload being\ndropped or downloaded, this has not been observed in any investigations we have\nconducted.\n\nIn addition to BlackMatter members exploiting infrastructure vulnerabilities, such as those\nfound in remote desktop, virtualization and VPN appliances or servers, initial access\noperators affiliated with the group will likely bring their own TTP and may favor exploiting\nsome vulnerabilities over others.\n\nAdditionally, the group are thought to make use of credentials obtained from other sources,\nsuch as third-party credential leaks, broad phishing campaigns or purchased from dark web\nmarketplaces, taking advantage of credential reuse and exploiting organizations that don't\nenforce multi-factor authentication on internet-facing services.\n\nIn many cases, BlackMatter and their affiliates appear opportunistic, happening on\nvulnerable organizations potentially based on their susceptibility to a preferred intrusion\nmethod rather than investing time and effort toward a specific target.\n\nIn other cases, it is apparent that BlackMatter has gained an extensive and intimate\nknowledge of the victim's infrastructure with victim-specific ransomware configurations,\nincluding tailored process and service names to ensure they are terminated prior to the\nencryption phase, as well as an embedded list of high-privilege credential, these credentials\nmay include domain administrator or service accounts that provide the the ability to access\nand encrypt data throughout the network.\n\n### What can we say about the payload?\n\nHighly efficient multithreaded executable, written in C, that is only ~80kb in size.\nVersion 3.0 hides the configuration in different locations, making it harder to extract and\nanalyze.\nTo hide execution flow, every function is decoded, loaded to memory, executed and\nthen purged.\nRelies on native Windows cryptography libraries, making the payload much smaller.\nEncrypts files using a combination of Salsa20 and 1024-bit RSA keys.\nAllows specified file extensions and filenames to be excluded from the encryption\nprocess, often to ensure that Windows will still boot.\n\n\n-----\n\nNot specific to BlackMatter and previously used by Darkside and MedusaLocker, a\nfour-year old `ICMLuaUtil COM-based user account control (UAC) bypass impacting`\nWindows 7 thru 10 is used to elevate privileges (due to it being considered a 'feature'\nby Microsoft, no fix will be released).\nBlackMatter's configuration allows previously acquired credentials to be specified and\npotentially used with the UAC bypass.\nEnumerates and deletes shadow copies using the Windows Management\nInstrumentation Command-Line (WMIC) utility: `IWbemServices::ExecQuery -`\n```\n   ROOT\\CIMV2 : SELECT * FROM Win32_ShadowCopy\n\n```\nVictim ID along with the ransom note filename and encrypted file extension is based on\nthe `MachineGuid value within the Registry`\n( HKLM\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid ).\nThe resulting encrypted file extension includes nine mixed-case alphanumeric\ncharacters along with the ransom note being saved on the victim's desktop and to\n```\n   c:\\%extension%-README.txt, both of which may evade some dictionary-based\n\n```\ndetection methods.\nEncryption process involves reading the target file, renaming it with the new extension,\npartially encrypting and re-writing 1024KB of data.\nEnumerates Active Directory environments using native LDAP queries, specifically the\nbuilt-in computers folder `LDAP://CN=Computers to identify potential target machines.`\nUpdates the victim's desktop wallpaper to inform them of the situation:\n\nFigure 3 - BlackMatter Wallpaper\n\n\n-----\n\nSets the Access Control List of encrypted files to Everyone, granting any and all\nusers access.\nTo avoid detection and allow file encryption without interference of security controls,\nBlackMatter supports the use of Windows 'safe-mode' with the built-in local\nadministrator account being enabled and set for automatic sign in along with the runonce Registry key being set to execute the BlackMatter payload.\n\nThe victim-specific ransom note advises the victim of both the data encryption and theft,\nadvising them to install the TOR browser bundle so that the dark web negotiation site can be\naccessed.\n\nFigure 4 - Ransom Note\nIn the past, REvil and Darkside have avoided the encryption of machines identified as being\nwithin countries that are members of the Commonwealth of Independent States (CIS), based\non identifying the country code used by victim's keyboard layout.\n\nThis, combined with early cybercrime forum posts indicating that only native Russian\nspeakers are eligible to work with the group provides a strong indication that the founding\nmembers of the group originate and operated from within the region.\n\nNotably, BlackMatter does not appear to perform the same geolocation checks, perhaps in\nan attempt to avoid association with the region and their past escapades.\n\n## Command and Control\n\nThe payload will communicate to command-and-control (C2) infrastructure over HTTPS,\nencrypted using AES. The victim sends a beacon including the machine name, OS version\nand CPU architecture, OS language, username, domain name, disk sizes, and potential\n\n\n-----\n\nencryption keys:\n\nFigure 5 - C2 Communications\nThis communication was observed as impersonating the following user-agent strings that\nmay be anomalous in some environments:\n\nMozilla/5.0 (Windows NT 6.1)\nFirefox/89.0\nGecko/20100101\nEdge/91.0.864.37\nSafari/537.36\n\n## Payload Configuration\n\nThe BlackMatter configuration, seemingly a JSON structure, allows the payload to be tailored\ntoward a specific victim including:\n\nRSA public key to be used to encrypt the Salsa20 encryption key.\nCompany victim ID\nAES Key to be used during Salsa20 key initialization (used later in file encryption).\nBot malware version, mentioning the payload version.\nOdd Crypt Large Files - to further damage large files such as databases.\nNeed Make Logon - will attempt to authenticate using the mentioned credentials in the\nconfig.\nMount units and crypt - attempt to mount volumes and encrypt them.\nLook for network shares and AD resources to attempt and encrypt them as well.\nProcesses and services exit prior to encryption to ensure maximum impact.\nCreating mutex's to avoid detection.\nPreparing victim's data and exfiltrating.\nDropping ransom notes post file encryption.\nC2 domains to communicate over HTTP or HTTPS.\n\n\n-----\n\nSetting a unique ransom note.\n\nFigure 6 - Payload Configuration\n\n## Recommendations\n\nEnforce MFA wherever possible.\nKeep backup plans well maintained and operational.\nEmploy Patch Management processes on externally facing appliances such as VPN's.\nContinuously assess external organization posture while looking for accessible\ndevices, such as Exchange and vCenter servers.\nRotate users, admins and service accounts passwords while checking continuously for\nleaked credentials.\nPrepare and practice Incident Response procedures for ransomware attacks.\nBlock the mentioned servers and IOC's.\n\n## Indicators of Compromise (IOCs)\n\nSHA256 Windows payloads:\n\n1. 02ec55a8f4f97a84370ca72b03912ae8625d344b7bd1af92a2de4b636183f2ab\n2. 072158f5588440e6c94cb419ae06a27cf584afe3b0cb09c28eff0b4662c15486\n3. 0751c422962dcd500d7cf2cf8bf544ddf5b2fe3465df7dd9b9998f6bba5e08a4\n4. 14a3e308c90183b3785b6c26ec40d29405361cd8dec204a62235733401bf5f5c\n5. 1c63a4fdee1528429886a0de5e89eaa540a058bf27cd378b8d139e045a2f7849\n6. 1eea3cbd729d4493c0c0a84efe6840abf1760efe221dc971d32ca5017b5c19c2\n7. 20742987e6f743814b25e214f8b2cd43111e2f60a8856a6cca87cafd85422f41\n8. 22d7d67c3af10b1a37f277ebabe2d1eb4fd25afbd6437d4377400e148bcc08d6\n9. 2466fca0e29b06c78ffa8a44193fb58c30e6bec4e54bbef8e6622349b95cce4c\n10. 2aad85dbd4c79bd21c6218892552d5c9fb216293a251559ba59d45d56a01437c\n\n11. 2c323453e959257c7aa86dc180bb3aaaa5c5ec06fa4e72b632d9e4b817052009\n12. 2cdb5edf3039863c30818ca34d9240cb0068ad33128895500721bcdca70c78fd\n13. 2e50eb85f6e271001e69c5733af95c34728893145766066c5ff8708dcc0e43b2\n\n\n-----\n\n14. 3a03530c732ebe53cdd7c17bee0988896d36c2b632dbd6118613697c2af82117\n15. 3a4bd5288b89aa26fbe39353b93c1205efa671be4f96e50beae0965f45fdcc40\n16. 4ad9432cc817afa905bab2f16d4f713af42ea42f5e4fcf53e6d4b631a7d6da91\n17. 4be85e2083b64838fb66b92195a250228a721cdb5ae91817ea97b37aa53f4a2b\n18. 520bd9ed608c668810971dbd51184c6a29819674280b018dc4027bc38fc42e57\n19. 5da8d2e1b36be0d661d276ea6523760dbe3fa4f3fdb7e32b144812ce50c483fa\n20. 668a4a2300f36c9df0f7307cc614be3297f036fa312a424765cdb2c169187fe6\n21. 66e6563ecef8f33b1b283a63404a2029550af9a6574b84e0fb3f2c6a8f42e89f\n22. 6d4712df42ad0982041ef0e2e109ab5718b43830f2966bd9207a7fac3af883db\n23. 6e846881115448d5d4b69bf020fcd5872a0efef56e582f6ac8e3e80ea79b7a55\n24. 706f3eec328e91ff7f66c8f0a2fb9b556325c153a329a2062dc85879c540839d\n25. 730f2d6243055c786d737bae0665267b962c64f57132e9ab401d6e7625c3d0a4\n26. 77340f01535db5c80c1f3e725a8f8de17bb227f567b8f568dd339be6ddacf60e\n27. 7f6dd0ca03f04b64024e86a72a6d7cfab6abccc2173b85896fc4b431990a5984\n28. 8323fdfda08300c691d330badec2607ea050cc10ee39934faeebedf3877df3ac\n29. 86c84c07e27cc8aba129e1cf51215b65c445f178b94f2e8c4c10e6bc110daa94\n30. 8eada5114fbbc73b7d648b38623fc206367c94c0e76cb3b395a33ea8859d2952\n31. 8f1b0affffb2f2f58b477515d1ce54f4daa40a761d828041603d5536c2d53539\n32. 98227953d55c5aee2271851cbea3680925d4d0838ee0d63090da143c8d71ac55\n33. 9bae897c19f237c22b6bdc024df27455e739be24bed07ef0d409f2df87eeda58\n34. 9cf9441554ac727f9d191ad9de1dc101867ffe5264699cafcf2734a4b89d5d6a\n35. a5cdca5a8120b5532f6de3395b9b6d411ad9234b857ce17bb3cc5747be6a7dd2\n36. b0e929e35c47a60f65e4420389cad46190c26e8cfaabe922efd73747b682776a\n37. b1891a5375198e262dfe6f83a89574e7aa438f41e2853d5d31e101bcec95cbf3\n38. b3e82b43750c7d0833f69abd3d31751c9e8face5063573946f61abbdda513eb8\n39. b4b9fdf30c017af1a8a3375218e43073117690a71c3f00ac5f6361993471e5e7\n40. b824bbc645f15e213b4cb2628f7d383e9e37282059b03f6fe60f7c84ea1fed1f\n41. c6e2ef30a86baa670590bd21acf5b91822117e0cbe6060060bc5fe0182dace99\n42. c728e3a0d4a293e44314d663945354427848c220d05d5d87cdedd9995fee3dfe\n43. cf60d0d6b05bfe2e51ca9dac01a4ae506b90d78d8d9d0fc266e3c01d8d2ba6b7\n44. d4645d2c29505cf10d1b201826c777b62cbf9d752cb1008bef1192e0dd545a82\n45. d4647619fa2dc8fef5560d1662cbee6eb7dc95298dd40edf12dd4c8ee902d767\n46. daed41395ba663bef2c52e3d1723ac46253a9008b582bb8d9da9cb0044991720\n47. e146f17a53300e19ec480d069b341688127d46198ff0fdd0e059914130d56f56\n48. e4a2260bcba8059207fdcc2d59841a8c4ddbe39b6b835feef671bceb95cd232d\n49. e9b24041847844a5d57b033bf0b41dc637eba7664acfb43da5db635ae920a1b4\n50. eaac447d6ae733210a07b1f79e97eda017a442e721d8fafe618e2c789b18234b\n51. eafce6e79a087b26475260afe43f337e7168056616b3e073832891bf18c299c1\n52. ed47e6ecca056bba20f2b299b9df1022caf2f3e7af1f526c1fe3b8bf2d6e7404\n53. f32604fba766c946b429cf7e152273794ebba9935999986b7e137ca46cd165fc\n54. f7b3da61cb6a37569270554776dbbd1406d7203718c0419c922aa393c07e9884\n55. fe2b2beeff98cae90f58a5b2f01dab31eaa98d274757a7dd9f70f4dc8432a6e2\n\n\n-----\n\nSHA256 Linux payloads:\n\n1. 6a7b7147fea63d77368c73cef205eb75d16ef209a246b05698358a28fd16e502\n2. d4645d2c29505cf10d1b201826c777b62cbf9d752cb1008bef1192e0dd545a82\n\nDomains:\n\nnowautomation[.]com\nfluentzip[.]org\nmojobiden[.]com\npaymenthacks[.]com\n\nIP addresses:\n\n99.83.154[.]118\n\nDvir Sason\n\nDvir manages the Varonis Research Team. He has ~10 years of Offensive & Defensive\nsecurity experience, focusing on red teaming, IR, SecOps, governance, security research,\nthreat intel, and cloud security. Certified CISSP and OSCP, Dvir loves to solve problems,\ncoding automations (PowerShell ‚ù§, Python), and breaking stuff.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-02 - BlackMatter Ransomware- In-Depth Analysis & Recommendations.pdf"
    ],
    "report_names": [
        "2021-11-02 - BlackMatter Ransomware- In-Depth Analysis & Recommendations.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536143,
    "ts_updated_at": 1743041163,
    "ts_creation_date": 1653764811,
    "ts_modification_date": 1653764811,
    "files": {
        "pdf": "https://archive.orkl.eu/8d0ffd3f6f1d4757e4e415dd6bf0de01da4c5aff.pdf",
        "text": "https://archive.orkl.eu/8d0ffd3f6f1d4757e4e415dd6bf0de01da4c5aff.txt",
        "img": "https://archive.orkl.eu/8d0ffd3f6f1d4757e4e415dd6bf0de01da4c5aff.jpg"
    }
}