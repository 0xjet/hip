{
    "id": "477d0a93-f123-4e7e-9f44-d2736e0116e9",
    "created_at": "2023-01-12T15:02:11.505373Z",
    "updated_at": "2025-03-27T02:08:40.677394Z",
    "deleted_at": null,
    "sha1_hash": "df2c7586e616c40eaa916c5f072c043eb89a1757",
    "title": "2021-05-06 - GrelosGTM group abuses Google Tag Manager to attack e-commerce websites",
    "authors": "",
    "file_creation_date": "2022-05-28T17:05:57Z",
    "file_modification_date": "2022-05-28T17:05:57Z",
    "file_size": 1854854,
    "plain_text": "# GrelosGTM group abuses Google Tag Manager to attack e-commerce websites\n\n**blog.group-ib.com/grelosgtm**\n\n06.05.2021\n\n\n-----\n\nViktor Okorokov\n\nLead Threat Intelligence & Attribution analyst at Group-IB\n\n**Analysis of campaign**\n\nGroup-IB analysts for the first time detected activities of a cybercriminal group that was\nsubsequently dubbed GrelosGTM by our Threat Intelligence team in early April 2020, but the\nearliest sample associated with this group dates back to January 2020. Since the beginning\nof their attacks the group had two distinctive features: they preferred to use multi-stage\nJavaScript malware and files without extension or with .css extension for storing code of\ntheir JavaScript sniffers\n\n\n-----\n\nIn their first attacks on e-commerce websites, this group used domains, which impersonated\nlegitimate services like Google Analytics and Google Tag Manager. One year later, in April\n2021, Group-IB specialists detected that apart from using domains mimicking the services,\nGrelosGTM group started to abuse Google Tag Manager legitimate functionality for their own\npurposes in infections of online shops.\n**Analysis of attacks**\n\nThis specific campaign started in February 2021 and affected at least seven websites\nrunning CMS Magento in Belgium, Italy, the United Kingdom, and the United States. At the\ntime of the publication, the JS sniffer has been active on at least four websites. Group-IB\nComputer Emergency Response Team (CERT-GIB) has informed all the websites infected of\nthe incident.\n\nFor the initial stage of infection GrelosGTM group injected their own Google Tag Manager\nscripts to the source code of targeted websites. In most cases attackers used a direct link to\nthe script located on legitimate googletagmanager.com domain, but in some infections they\nused an injector as shown on Figure 1.\n\n_Figure 1. Example of the injected code: Google Tag Manager script \"GTM-5SF293J\" was_\n_created by hackers_\n\nThis Google Tag Manager script (Figure 2) contains malicious inject, which loads the next\nstage script from the attacker's website by URL hXXs://webfaset[.]com/str.css.\n\n\n-----\n\n_Figure 2: Google Tag Manager script with a malicious inject_\n\nInjected script is responsible for detecting the checkout page using regular expression and\nfor downloading the main payload of JS sniffer using WebSocket from URL\nwss://webfaset[.]com:80/bootstrap.min.css (Figure 3).\n\n_Figure 3: Fragment of the source code of WebSocket-based injector_\n\nThe final payload is a heavily obfuscated JavaScript sniffer designed for collecting shoppers'\nbank card information during checkout using a fake payment form. All collected cards will be\nsent to attackers' server via gate hXXs://webfaset[.]com/media/logo.img.\n\n\n-----\n\n_Figure 4: Fragment of source code of JavaScript sniffer used by GrelosGTM group_\n\nBelow you can find both MITRE ATT&CK mapping and corresponding mitigations list.\n\n[Lear more about Group-IB's Threat Intelligence & Attribution,](https://www.group-ib.com/intelligence-attribution.html) [Fraud Hunting Platform, and](https://www.group-ib.com/fraud-hunting-platform.html)\n[Security Assessment service on our](https://www.group-ib.com/security-assessment.html) [website.](https://www.group-ib.com/)\n**Indicators of compromise**\n\nwebfaset[.]com\n\n\n-----\n\nfountm[.]online\n\njqwereid[.]online\n\nbulder[.]online\n\ngstatcs[.]com\n\nhXXps://www.googletagmanager[.]com/gtm.js?id=GTM-5SF293J\n\nShare\n\nReceive insights on the latest cybercrime trends\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-06 - GrelosGTM group abuses Google Tag Manager to attack e-commerce websites.pdf"
    ],
    "report_names": [
        "2021-05-06 - GrelosGTM group abuses Google Tag Manager to attack e-commerce websites.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535731,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653757557,
    "ts_modification_date": 1653757557,
    "files": {
        "pdf": "https://archive.orkl.eu/df2c7586e616c40eaa916c5f072c043eb89a1757.pdf",
        "text": "https://archive.orkl.eu/df2c7586e616c40eaa916c5f072c043eb89a1757.txt",
        "img": "https://archive.orkl.eu/df2c7586e616c40eaa916c5f072c043eb89a1757.jpg"
    }
}