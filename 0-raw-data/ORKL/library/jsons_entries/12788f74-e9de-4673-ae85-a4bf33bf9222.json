{
    "id": "12788f74-e9de-4673-ae85-a4bf33bf9222",
    "created_at": "2023-01-12T15:03:50.381251Z",
    "updated_at": "2025-03-27T02:15:35.633129Z",
    "deleted_at": null,
    "sha1_hash": "f5179ba7cf5d2059f19b9cd965878474ce449244",
    "title": "2016-01-01 - Die erste Ransomware in JavaScript- Ransom32",
    "authors": "",
    "file_creation_date": "2022-05-28T19:06:35Z",
    "file_modification_date": "2022-05-28T19:06:35Z",
    "file_size": 1695838,
    "plain_text": "# Die erste Ransomware in JavaScript: Ransom32\n\n**[blog.emsisoft.com/de/21077/meet-ransom32-the-first-javascript-ransomware/](https://blog.emsisoft.com/de/21077/meet-ransom32-the-first-javascript-ransomware/)**\n\nSarah January 1, 2016\n\n[Software as a service (Software als Dienstleistung) – kurz SaaS – ist ein relativ neues](https://en.wikipedia.org/wiki/Software_as_a_service)\nGeschäftsmodell, dem sich viele Softwareanbieter heutzutage mit großem Erfolg bedienen.\nDaher dürfte es nicht überraschen, dass Malware-Programmierer und andere digitale\nStrauchdiebe das Modell auch für ihre gemeinen Zwecke einsetzen wollen. Im vergangenen\n[Jahr erschienen mit Tox,](http://www.bleepingcomputer.com/forums/t/577746/tox-affiliate-ransomware-spotted-in-spam-emails-while-dev-offers-chat-support/) [Fakben oder](http://www.bleepingcomputer.com/news/security/new-ransomware-as-a-service-announced-called-cryptolocker-service/) [Radamant bereits etliche dieser „Ransomware as a](https://blog.emsisoft.com/2015/12/29/strong-indications-that-ransomware-devs-dont-like-emsisoft/)\nService“-Kampagnen auf der Bildfläche. Heute möchten wir Sie über die neueste Aktion\ninformieren\n\n\n-----\n\n## Hier kommt Ransom32\n\nAuf den ersten Blick ist Ransom32 eine Malware-Kampagne wie jede andere. Die\n[Anmeldung erfolgt über einen im Tor-Netzwerk versteckten Server. Dazu muss lediglich eine](https://en.wikipedia.org/wiki/Tor_%28anonymity_network%29)\n[Bitcoin-Adresse eingegeben werden, an die alle von der Ransomware erpressten](https://en.wikipedia.org/wiki/Bitcoin)\nLösegelder gesendet werden sollen.\n\nFür eine persönliche Ransomware wird nur eine Bitcoin-Adresse benötigt, an die die „Einnahmen“\n\ngesendet werden sollen.\n\n[Nachdem die Bitcoin-Adresse abgeschickt wurde, erhalten die Benutzer Zugriff auf einen](https://en.wikipedia.org/wiki/Bitcoin)\ngrundlegenden Verwaltungsbereich. Hier werden verschiedene Statistiken angezeigt, etwa\nwie viele Systeme infiziert sind und wie viele Personen bereits gezahlt haben. Außerdem\nkann der „Client“ – so wird die eigentliche Malware von den Kampagnengründern genannt –\n[konfiguriert werden. Es lassen sich beispielsweise der Bitcoin-Betrag ändern, den die](https://en.wikipedia.org/wiki/Bitcoin)\nMalware fordert, und weitere Parameter konfigurieren, beispielsweise beim Installieren der\nMalware zur Täuschung angezeigte Meldungen.\n\n\n-----\n\nÜber eine Weboberfläche kann die Malware angepasst werden und der Benutzer erhält einen\n\nÜberblick, wie viele Systeme infiziert und wie viele Bitcoins eingenommen wurden.\n\nMit dem Klick auf „Download client.scr“ wird die Malware entsprechend der vorgenommenen\nEinstellungen erzeugt und die 22 MB große Client-Datei heruntergeladen. Spätestens jetzt\nwird klar, dass Ransom32 keine typische Ransomware ist. Deren Dateien sind in der Regel\nselten größer als 1 MB. Einige Ransomware-Programmierer werben sogar mit den kleinen\nDateigrößen ihrer tückischen Produkte, wenn sie ihre Kampagnen in den illegalen\nHackerforen anpreisen. Ransom32 hatte unser Interesse geweckt.\n\n\n-----\n\n## Der Gigant im Detail\n\nNach näherer Untersuchung entpuppte sich die heruntergeladene Datei als ein\nselbstentpackendes WinRAR-Archiv.\n\nDer Inhalt des SFX-Archivs.\n\nDie Malware nutzt die in WinRAR integrierte Scriptsprache, um ihren Inhalt automatisch in\nden temporären Ordner des Benutzers zu entpacken und die darin enthaltene Datei\n„chrome.exe“ auszuführen. Die Dateien in dem Archiv haben folgende Zwecke:\n\n„chrome“ enthält eine Kopie der Lizenzvereinbarung für freie Software (GNU GPL).\n[„chrome.exe“ ist eine gepackte NW.js-Anwendung. Sie enthält den eigentlichen](http://nwjs.io/)\nMalware-Code und bildet den sogenannten Framework (also das Gerüst) zum\nAusführen der Malware.\n[„ffmpegsumo.dll“, „nw.pak“, „icudtl.dat“ und „locales“ enthalten die für den NW.js-](http://nwjs.io/)\nFramework erforderlichen Daten.\n[„rundll32.exe“ ist eine umbenannte Kopie des Tor-Clients.](https://en.wikipedia.org/wiki/Tor_%28anonymity_network%29)\n„s.exe“ ist eine umbenannte Kopie von Optimum X Shortcut. Mit dem Programm lassen\nsich Verknüpfungen auf dem Desktop und im Startmenü erstellen und ändern.\n„g“ enthält die Malware-Einstellungen, die über die Weboberfläche konfiguriert wurden.\n„msgbox.vbs“ ist ein kleines Script, über das die zuvor individuell angepasste Meldung\nangezeigt wird.\n\n\n-----\n\n„u.vbs ist ein kleines Script, das alle Dateien und Ordner in einem vorgegebenen\nVerzeichnis durchnummeriert und löscht.\n\nDie Datei „g“ enthält die als JSON (ein Datenaustauschformat) formatierte Konfiguration der\n\nMalware.\n\nDie interessanteste Datei in dem ganzen Paket ist die „chrome.exe“. Auf den ersten\nBlick sieht sie verdächtig wie eine Kopie des bekannten Browsers „Chrome“ aus. Die\nFälschung verrät sich lediglich dadurch, dass sie keine eigene digitale Signatur hat und\n[Versionsinformationen fehlen. Weitere Analysen enttarnen sie als eine gepackte NW.js-](http://nwjs.io/)\nAnwendung.\n\n## Moderne webbasierte Technologien und Ransomware\n\n[Was genau ist denn nun eine NW.js-Datei? Die NW.js ist im Wesentlichen das](http://nwjs.io/)\n„Gerüst“, mit dem unter Verwendung von JavaScript normale Computeranwendungen\nfür Windows, Linux und Mac OS X entwickelt werden. Als Basis dienen oftmals die\n[Node.js– und Chromium-Projekte. JavaScript ist normalerweise auf den Browser](https://nodejs.org/en/)\nbeschränkt und hat keinen Zugriff auf das System, auf dem es ausgeführt wird. Die\n[NW.js verfügt jedoch über wesentlich mehr Kontrolle und Berechtigungen in dem](http://nwjs.io/)\njeweiligen Betriebssystem. Dadurch wird JavaScript nahezu alles ermöglicht, was\n„normale“ Programmiersprachen wie C++ oder Delphi auch können. Für die Entwickler\nist das natürlich ein großer Vorteil, weil sie aus ihren Anwendungen relativ leicht\n[reguläre Computerprogramme machen können. Mit der NW.js lassen sich](http://nwjs.io/)\nbeispielsweise dieselben JavaScript-Codes auf unterschiedlichen Plattformen\nausführen. Der Entwickler muss die Anwendung also nur einmal schreiben und kann\nsie dann unter Windows, Linux und Mac OS X einsetzen.\n\nDas sollte bedeuten, dass sich Ransom32 auch leicht für Linux und Mac OS X packen\nlässt – zumindest in der Theorie. Bisher gibt es jedoch keine Hinweise auf derartige\nPakete, sodass Ransom32 derzeit höchstwahrscheinlich allein unter Windows für\nProbleme sorgt. Ein großer Vorteil für die Malware-Programmierer ist die\n\n\n-----\n\n[Rechtmäßigkeit von NW.js-Frameworks und Anwendungen. Es ist also nicht](http://nwjs.io/)\nverwunderlich, dass die Signatur-Erkennung noch immer unglaublich schlecht ist,\nobwohl die Malware bereits vor knapp 2 Wochen erstellt wurde.\n\nSobald Ransom32 auf ein System gelangt und ausgeführt wird, entpackt sie alle\nDateien in den Ordner der temporären Dateien. Von hier kopiert sie sich in das\nVerzeichnis „%AppData%\\Chrome Browser“. Mithilfe der enthaltenen „s.exe“ erstellt sie\nim Autostart/Startup-Ordner die Verknüpfung „ChromeService“, damit die Malware\ngarantiert bei jedem Systemstart ausgeführt wird. Über den integrierten Tor-Client\nverbindet sie sich dann mit ihrem Befehls- und Steuerserver (C2-Server), der im TorNetzwerk versteckt auf Port 85 liegt. Von hier werden der zum Verschlüsseln\nverwendete Kryptografieschlüssel und die Bitcoin-Adresse abgerufen, an die das\nLösegeld gehen soll. War die Verbindung zum C2-Server erfolgreich, wird von der\nMalware schließlich die Erpressermeldung angezeigt.\n\nDie in der Malware angezeigte Erpressermeldung\n\nAnschließend werden die Dateien des Benutzers verschlüsselt. Davon sind alle\nDateien mit folgenden Endungen betroffen:\n\n*.jpg, *.jpeg, *.raw, *.tif, *.gif, *.png, *.bmp, *.3dm, *.max, *.accdb, *.db, *.dbf, *.mdb,\n*.pdb, *.sql, *.*sav*, *.*spv*, *.*grle*, *.*mlx*, *.*sv5*, *.*game*, *.*slot*, *.dwg, *.dxf, *.c,\n*.cpp, *.cs, *.h, *.php, *.asp, *.rb, *.java, *.jar, *.class, *.aaf, *.aep, *.aepx, *.plb, *.prel,\n*.prproj, *.aet, *.ppj, *.psd, *.indd, *.indl, *.indt, *.indb, *.inx, *.idml, *.pmd, *.xqx, *.xqx,\n*.ai, *.eps, *.ps, *.svg, *.swf, *.fla, *.as3, *.as, *.txt, *.doc, *.dot, *.docx, *.docm, *.dotx,\n*.dotm, *.docb, *.rtf, *.wpd, *.wps, *.msg, *.pdf, *.xls, *.xlt, *.xlm, *.xlsx, *.xlsm, *.xltx,\n*.xltm, *.xlsb, *.xla, *.xlam, *.xll, *.xlw, *.ppt, *.pot, *.pps, *.pptx, *.pptm, *.potx, *.potm,\n\n\n-----\n\n.ppam, .ppsx, .ppsm, .sldx, .sldm, .wav, .mp3, .aif, .iff, .m3u, .m4u, .mid,\n*.mpa, *.wma, *.ra, *.avi, *.mov, *.mp4, *.3gp, *.mpeg, *.3g2, *.asf, *.asx, *.flv, *.mpg,\n*.wmv, *.vob, *.m3u8, *.csv, *.efx, *.sdf, *.vcf, *.xml, *.ses, *.dat\n\nDie Malware verschlüsselt jedoch keine Dateien in Verzeichnissen, die eine der\nfolgenden Zeichenfolgen enthalten:\n\n:\\windows\\\n:\\winnt\\\nprogramdata\\\nboot\\\ntemp\\\ntmp\\\n$recycle.bin\\\n[Die Verschlüsselung erfolgt unter dem AES (Advanced Encryption Standard) als 128-](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard)\nBit-Schlüssel mit der Betriebsart CTR. Für jede Datei wird ein neuer Schlüssel erstellt.\n[Dieser wird wiederum mit dem RSA-Algorithmus und einem öffentlichen Schlüssel](https://en.wikipedia.org/wiki/RSA_%28cryptosystem%29)\nverschlüsselt, der bei der ersten Kommunikation mit dem C2-Server abgerufen wurde.\n\nAuszug aus dem individuellen Protokollaustausch zwischen Ransom32 und dem C2-Server,\n\num Bitcoin-Adresse (violett) und öffentlichen Schlüssel (Länge in Gelb, Schlüssel in Grün)\n\nabzurufen.\n\n\n-----\n\nDer verschlüsselte AES-Schlüssel wird zusammen mit den AES-verschlüsselten Daten\nin der – jetzt ebenfalls verschlüsselten – Datei gespeichert.\n\nDie Malware bietet auch an, eine einzelne Datei wieder zu entschlüsseln, um dem\nOpfer zu beweisen, dass der Malware-Entwickler die Verschlüsselung auch tatsächlich\nwieder aufheben kann. Dazu schickt sie den verschlüsselten AES-Schlüssel der\ngewählten Datei an den C2-Server, der dann den entschlüsselten AES-Schlüssel für\ndie Datei zurücksendet.\n\n## Wie können Sie sich vor Ransom32 schützen?\n\nWie bereits in [unserem letzten Artikel zu Ransomware erläutert, ist der beste Schutz](https://blog.emsisoft.com/2015/12/22/how-its-done-right-emsisofts-behavior-blocker-vs-20-crypto-ransomware-families/)\neine gut organisierte Sicherungsstrategie. Als ein weiterer guter Schutz haben sich\nerneut die in Emsisoft Anti-Malware und Emsisoft Internet Security eingesetzten\nTechnologien zur Verhaltensanalyse erwiesen. Damit sind alle unsere Benutzer vor\ndieser und Hunderten anderen Arten von Ransomware geschützt – unabhängig von\nSignaturen.\n\nUsers of Emsisoft Anti-Malware and Emsisoft Internet Security are protected from Ransom32\n\nand other ransomware families by the behavior blocker\n\nBenutzer von Emsisoft Anti-Malware und Emsisoft Internet Security sind durch die\nVerhaltensanalyse vor Ransom32 und anderen Ransomware-Familien geschützt.\n\n\n-----\n\nRansomware ist eine der größten Bedrohungen des vergangenen Jahres und wir\nwerden auch 2016 unser Möglichstes tun, um unsere Benutzer wie bisher optimal zu\nschützen.\n\nIn diesem Sinne: Die Malware-Experten von Emsisoft wünschen Ihnen ein großartiges\nund malwarefreies neues Jahr.\n\n[Zu guter Letzt noch ein Wort des Dankes an unsere Freunde von BleepingComputer,](http://www.bleepingcomputer.com/)\ndie uns als Erste auf diese Bedrohung hingewiesen haben. Insbesondere xXToffeeXx\nvon BleepingComputer sei in diesem Zusammenhang erwähnt. Sie hat uns mit ihren\nBeiträgen beim Analysieren und Rückentwickeln (Reverse Engineering) dieser\nRansomware wertvolle Unterstützung geleistet.\n\n\n-----",
    "language": "DE",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-01-01 - Die erste Ransomware in JavaScript- Ransom32.pdf"
    ],
    "report_names": [
        "2016-01-01 - Die erste Ransomware in JavaScript- Ransom32.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535830,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1653764795,
    "ts_modification_date": 1653764795,
    "files": {
        "pdf": "https://archive.orkl.eu/f5179ba7cf5d2059f19b9cd965878474ce449244.pdf",
        "text": "https://archive.orkl.eu/f5179ba7cf5d2059f19b9cd965878474ce449244.txt",
        "img": "https://archive.orkl.eu/f5179ba7cf5d2059f19b9cd965878474ce449244.jpg"
    }
}