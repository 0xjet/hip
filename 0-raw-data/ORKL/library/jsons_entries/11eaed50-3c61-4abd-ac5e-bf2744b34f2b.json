{
    "id": "11eaed50-3c61-4abd-ac5e-bf2744b34f2b",
    "created_at": "2023-01-12T15:07:27.303359Z",
    "updated_at": "2025-03-27T02:08:00.15187Z",
    "deleted_at": null,
    "sha1_hash": "6d8769bfe8b92c28ecd433a1570c6b84964f2cf7",
    "title": "2020-11-18 - Malware Analysis Spotlight- AZORult Delivered by GuLoader",
    "authors": "",
    "file_creation_date": "2022-05-28T22:08:20Z",
    "file_modification_date": "2022-05-28T22:08:20Z",
    "file_size": 1652795,
    "plain_text": "# Malware Analysis Spotlight: AZORult Delivered by GuLoader\n\n**vmray.com/cyber-security-blog/azorult-delivered-by-guloader-malware-analysis-spotlight/**\n\n[Earlier this year, in one of our blog posts we covered GuLoader, a downloader outfitted with advanced anti-analysis techniques that has](https://www.vmray.com/cyber-security-blog/guloader-evasion-techniques-threat-bulletin/)\ndelivered FormBook, NanoCore, LokiBot, and Remcos among others. Recently, we’ve observed GuLoader delivering AZORult.\n\nActive for many years, AZORult is an information stealer that has seen many iterations and is typically spread via spam emails or malicious\nsoftware.\n\nGuLoader’s evasive techniques coupled with AZORult’s information-stealing capabilities make this an interesting combination for an attacker to\nhit their target.\n\nIn this [Malware Analysis Spotlight, we will analyze a delivery chain that uses malicious e-mail attachments and GuLoader to spread AZORult.](https://www.vmray.com/cyber-security-blog/tag/malware-analysis-spotlight/)\n\n## Analysis of the AZORult Delivery Chain\n\n[Our investigation started from a single sample that matched our AZORult v3 network communication YARA rule. We decided to get more](https://www.vmray.com/analyses/5ff8a87fd762/report/yara.html)\nbackground information and look for the delivery method. The delivery payload turned out to be an RTF document delivered as an email\nattachment (Figure 1) and exploiting a vulnerability in one of Microsoft’s Office products.\n\nStarting from the email, the attack actually contained three steps and downloaded two payloads during its execution. At least one of the\npayloads was AZORult. We also investigated the other parts of the executions chain and it turned out that the infamous GuLoader was used\nas one of the links in the execution chain.\n\n\n-----\n\n_Figure 1: Spam email that delivers the malicious RTF document._\n\n[The document is abusing the equation editor (CVE-2017-11882) vulnerability to achieve execution on the victim’s machine. This leads to the](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)\ndownload and execution of the next payload which is GuLoader (Figure 2).\n\nIn our investigation, we found multiple unique domains responsible for hosting the GuLoader payload (see list of IOCs) associated with similar\nspam emails leveraging this type of execution chain.\n\n_Figure 2: VMRay Analyzer – Download of the next GuLoader payload by exploiting a vulnerability in the equation editor._\n\n[As we have described in one of our previous Threat Bulletin, GuLoader is equipped with advanced anti-analysis, sandbox detection, and](https://www.vmray.com/cyber-security-blog/guloader-evasion-techniques-threat-bulletin/)\nevasion techniques to increase its chances of delivering malware to its intended target.\n\nIn the [VMRay Analyzer Report, we observed the typical behavior of GuLoader, using shellcode in two instances (processes). The shellcode](https://www.vmray.com/analyses/guloader-delivering-azorult/report/overview.html)\nuses its advanced techniques to thwart dynamic analysis followed by the final payload downloaded from a publicly available cloud provider.\n\nCompared to the previously analyzed GuLoader samples, this one shows additional behavior in the enumeration of products currently\n[advertised/installed (MsiEnumProductsA) and services (EnumServicesStatusA) (Figure 3). This might be an indicator of further detection or](https://docs.microsoft.com/en-us/windows/win32/api/msi/nf-msi-msienumproductsa)\nevasion techniques present in this GuLoader sample.\n\n\n-----\n\n_Figure 3: VMRay Analyzer’s function log – Comparison of GuLoader’s new behavior (left) with previously analyzed samples (right)_\n\nLast, it downloads the final AZORult stealer payload, maps it into its own process, and transfers control flow (Figure 4).\n\n### AZORult’s Behavior\n\nFrom this point on, the behavior of AZORult is visible. AZORult is an information stealer that targets login credentials, cookies, cryptocurrency\nwallets, and more (Figure 5).\n\n\n-----\n\n_Figure 5: VMRay Analyzer – AZORult’s data collection_\n\nAZORult v3 always appends the XOR key used to encrypt the following message sent to its C&C at the beginning of the message. Thus, the\ninitial communication always starts with three NUL bytes followed by an XOR encrypted ID hash (Figure 6). In our investigation, we found\nmultiple servers used as its C&C (see IOCs) that all contain the same path.\n\n_Figure 6: VMRay Analyzer – AZORult’s initial message sent to its C&C server._\n\n### Conclusion\n\nBy using GuLoader in the delivery chain, the attackers can profit from the many features provided by GuLoader that are not offered by\nAZORult on its own. This obstructs dynamic analysis, complicates manual analysis and provides a flexible, easy distribution of tasks to the\n[attacker without the requirement of advanced specialized knowledge. Despite all that, the VMRay Analyzer monitored the complete delivery](https://www.vmray.com/products/analyzer-malware-sandbox/)\nchain from the initial RTF document to the final payload.\n\nAs mentioned before, these documents are sent via spam emails which are typical attack vectors that attackers use as an entry into the\n[network. Including the VMRay Email Threat Defender (ETD) in the network helps to detect and prevent such attacks.](https://www.vmray.com/products/email-threat-defender/)\n\n### IOCs\n\n**Documents** 5ff8a87fd7626d4beab7a5be7f285f1d1d64478509f27aca6fd9de\n\n9a5f4116b1be763a38e25cb14869b57daf9ae4fe1c2e72adc433eccc95d5f539\n\n08df240668051225b392d88174dadd0db2703ee1ba93c62e3b020cb2be188c17\n\n6a39c54717f2c9f76f5cf9bde58ca256ab1ed77985b3f590d3797fd6655c19ac\n\nf0fb1c2a2150e9a33488974952af6c8f0cd52d463ab656e36d17b7d224d04f8e\n\n\n-----\n\ncc88795da896ebd8df6fdd996179ae53285c021b0d7437fa9bffca4e5fbc0473\n\nd0f83c5b91494e26b3c0cc108aa43f6865a17eee870a28f1f7d89669e177d279\n\n3bd6858a664535a00192021b4b89ab96d47fcf08c32fee5ea97ded3099e39ba8\n\n**GuLoader using MsiEnumProducts** e000b0cae7df0753ea12d97175e393bacf905613eef1a59d7e17\n\n1e6a09e38553c090a119156022d61670adf96f8a635a3dac11f11dd395c107ba\n\n4487e0798fb74f9891c48625b3a189dbd1e05e2c400cd710f4ea0bdf03b9adbd\n\nc256466dc256d55f7cba0f1c2201f208b82deabd903dd3a71a4e7989e6a61ff7\n\nc87290bb28696eddacaadc0f01805f841bda964d55efa9c39d0a06f1d31ede3b\n\n1623c45e067729ec3b334294da18855e0e5312fd4d9d28f95d4e38b074255892\n\nb5389059c8b005b1968197bb1bb38edc024501c02bf8941d287b1c01358b121a\n\ne97e14f57e6f9ad987e4b5079b7ba8a387115b89784958d40d1f65d79d027315\n\n**Domains hosting GuLoader** kalpvedafoundation[.]com\n\ncieloabiertocasahogar[.]com\n\nwww[.]cecadperu[.]com\n\n**AZORult C&Cs** skilldrivinget[.]com/ojman/PL341//index[.]php\n\nlaninesolution[.]com/roky/PL341/index[.]php\n\ntarot-sunce[.]com/linko/PL341/index[.]php\n\neksodus[.]id/ghytoja/PL341/index[.]php\n\nlaninesolution[.]com/roky/PL341/index[.]php\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-18 - Malware Analysis Spotlight- AZORult Delivered by GuLoader.pdf"
    ],
    "report_names": [
        "2020-11-18 - Malware Analysis Spotlight- AZORult Delivered by GuLoader.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536047,
    "ts_updated_at": 1743041280,
    "ts_creation_date": 1653775700,
    "ts_modification_date": 1653775700,
    "files": {
        "pdf": "https://archive.orkl.eu/6d8769bfe8b92c28ecd433a1570c6b84964f2cf7.pdf",
        "text": "https://archive.orkl.eu/6d8769bfe8b92c28ecd433a1570c6b84964f2cf7.txt",
        "img": "https://archive.orkl.eu/6d8769bfe8b92c28ecd433a1570c6b84964f2cf7.jpg"
    }
}