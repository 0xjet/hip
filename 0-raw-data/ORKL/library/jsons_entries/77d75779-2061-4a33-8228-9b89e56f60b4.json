{
    "id": "77d75779-2061-4a33-8228-9b89e56f60b4",
    "created_at": "2023-01-12T15:08:54.897825Z",
    "updated_at": "2025-03-27T02:13:29.266044Z",
    "deleted_at": null,
    "sha1_hash": "8a8cc45607d317d0c92876f8191570251a564338",
    "title": "2020-10-31 - Ryuk and Splunk Detections",
    "authors": "",
    "file_creation_date": "2022-05-28T04:05:26Z",
    "file_modification_date": "2022-05-28T04:05:26Z",
    "file_size": 113114,
    "plain_text": "# Ryuk and Splunk Detections\n\n**[splunk.com/en_us/blog/security/ryuk-and-splunk-detections.html](https://www.splunk.com/en_us/blog/security/ryuk-and-splunk-detections.html)**\n\nOctober 30, 2020\n\nBy [Ryan Kovar October 30, 2020](https://www.splunk.com/en_us/blog/author/rkovar.html)\n\n[Several weeks ago, my good friend Katie Nickels (Director of Intelligence at Red Canary](https://redcanary.com/authors/katie-nickels/)\nextraordinaire) and I were chatting about Ransomware. She was super interested and\npassionate about some new uses of a ransomware variant named “Ryuk” (first\ndetected in 2018 and named after a manga/anime character) [1]. I was, to be honest,\nmuch less interested. It turns out, as usual, Katie was right; this was a big deal (although as\nyou will see, I’m right too… still dull stuff!).\n\n[On October 29th CISA (Cybersecurity and Infrastructure Agency) posted Alert AA-20-302](https://us-cert.cisa.gov/ncas/alerts/aa20-302a)\n(since updated) discussing Ryuk as an “imminent cybercrime threat to U.S. hospitals and\nhealthcare providers.” If you’ve been paying attention to the ransomware world for the last\ncouple of months, there was a declared “ceasefire” as ransomware operators proclaimed\nthat they would not target hospitals during COVID. This announcement was, perhaps not\nsurprisingly, not accurate. Over the last couple of months, Ryuk has been ravaging public\ninstitutions like hospitals and city governments, causing delays in surgeries and possibly\ncausing actual deaths [2] [3]. Suppose you are interested in the attribution of the Ryuk\noperators or a deep dive into the malware? In that case, I recommend you read some of the\n\n\n-----\n\n[great blogs/postings from Mandiant or](https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html) [Red Canary on the subject. Otherwise, buckle up for](https://www.google.com/search?q=inurl%3Ahttps%3A%2F%2Fredcanary.com%2Fblog%2F+ryuk&rlz=1C5CHFA_enUS714US714&oq=inurl%3Ahttps%3A%2F%2Fredcanary.com%2Fblog%2F+ryuk&aqs=chrome..69i57j69i58.18465j0j7&sourceid=chrome&ie=UTF-8)\ndiscussion on some resources to help detect and even possibly remediate Ryuk using\nSplunk!\n\n## Quick Breakdown of the Ryuk Kill Chain\n\nAlthough Ryuk is getting the headlines, what I find most interesting about Ryuk is that it is\nactually the final step of a multi-staged attack. Historically Ryuk was delivered with a\nspearphishing attack using a weaponized Microsoft Word document to drop Emotet or\nTrickbot trojans. The malware would be installed and used to survey a network, steal creds,\nmove laterally, and gain footholds on critical servers like domain controllers to modify GPO\nsettings. All of this amounts to a type of reconnaissance to find the most vital “crown jewels”\nof the company that are ripe for ransom. The most recent behavior has shown actors\nsending google documents with embedded links asking the user to click on the URL, which\nthen delivers a newish-trojan named Bazar or even Cobalt Strike. Then, using Bazar’s\ncapabilities, the actors perform the same reconnaissance and establishment of footholds.\nThe outcome of either of these initial vectors is the use of Ryuk ransomware to encrypt files\nand demand a payout via “RyukReadMe.txt” (which was the genesis of the Ryuk name).\n\nSo what’s new, fascinating, or different about Ryuk versus other ransomware? To be\nhonest... not much. It’s just typical Spearphishing with a 2-year-old (albeit updated) variant\nof ransomware (if you are interested, my colleague Rod Soto from the Splunk Threat\n[Research team also released a blog, Detecting Ryuk Using Splunk Attack Range, showing](https://www.splunk.com/en_us/blog/security/detecting-ryuk-using-splunk-attack-range.html)\nhow to use the Splunk Attack Range to simulate and detect Ryuk). The reason it’s hitting\n\nthe news is that they are targeting healthcare facilities amid a global pandemic.\nSuppose I had to pick one thing out of the mix of Ryuk/Bazar/Trickbot TTPs to stay\nawake about? I’d probably point out that the ransomware uses the initial trojan vector\nto ensure that the ransomware is deployed on the most critical parts of an organization’s\nnetwork rather than just “encrypt and pray.” Some reports have shown a 56-minute delta\nbetween initial infection and ransomware encryption activity. THAT “human touch” has been\nwhat has made it so maddeningly effective and dangerous.\n\n## Detection of Ryuk\n\nUsually, this blog post section is filled with fun TTPs pulled from the zero-day or possibly a\nbreakdown of a new malware variant. But, after reviewing the last six years of content that\nSplunk has created, I am proud to say that we already have you covered. On top of the\n**corpus of general ransomware detection information listed below, it is essential to**\n**note that the Splunk Threat Research team has released detections to Ryuk, Trickbot**\n**and Bazar to both Splunk Security Essentials (SSE) and Splunk Enterprise Security**\n**Content Update (ESCU) in release 3.0.9. In my list of detections below, you will notice that**\nI did not break out IOCs. As David Bianco has pyramidized in the past, IOCs are ephemeral\nand change often! I recommend working with a threat intel provider for any low-level IOCs\n\n\n-----\n\n[like hashes or IPs. Throw them into a Lookup table or](https://www.splunk.com/en_us/blog/security/hunting-covid-themed-attacks-with-iocs.html) [ES threat intel framework, and off you](https://www.splunk.com/en_us/blog/security/how-do-i-add-covid-threat-intelligence-from-the-internet-to-enterprise-security.html)\ngo! If you don’t have a threat intel provider, start skimming Twitter for some tremendous\nopen-source lists.\n\n## Splunk Security Essentials\n\nIn case you are unaware (or living under a rock for the last two years), Splunk Security\nEssentials is one of the key places to get Splunk’s security content. When you boot up the\napp, navigate to “security content,” and search for Ransomware, you get a plethora of\ncontent!\n\n[On top of that, I took the MITRE ATT&CK Techniques from the CISA alert and selected the](https://us-cert.cisa.gov/ncas/alerts/aa20-302a)\nSSE detection content that mapped to them. It turns out we have over 45 searches to\ndetect Ryuk and trojans like Bazar, Trickbot, or Emotet.\n\nI bet you would love to get this information, wouldn’t you… Well, you can either download\nthis [825 page PDF OR copy the](https://drive.google.com/file/d/1OoeDL2bIMwpzhyQl-B3okqBLPEAJSwem/view?usp=sharing) [JSON blob here of this bookmarked content and upload it](https://docs.google.com/document/d/1Ms4jaZmIDLXSJehJaKTp6ZkdrHd9oUdE5arvIYtMHnI/edit?usp=sharing)\ninto your updated SSE local instance. As always, try in dev before prod! Also, some of\nthese searches may need to be modified to detect Ryuk with greater confidence. Refer to\nthe [CISA alert or the excellent work from](https://us-cert.cisa.gov/ncas/alerts/aa20-302a) [Red Canary if you want more atomic TTPs of the](https://www.google.com/search?q=inurl%3Ahttps%3A%2F%2Fredcanary.com%2Fblog%2F+ryuk&rlz=1C5CHFA_enUS714US714&oq=inurl%3Ahttps%3A%2F%2Fredcanary.com%2Fblog%2F+ryuk&aqs=chrome..69i57j69i58.18465j0j7&sourceid=chrome&ie=UTF-8)\nmalware for integration into your signatures.\n\n## Historical Corpus\n\nNow, of course, this is not the only content that Splunk has created around Ransomware. In\n[addition, take a peek at Rod Soto’s blog for some examples of where our Security](https://www.splunk.com/en_us/blog/security/detecting-ryuk-using-splunk-attack-range.html)\nResearch team is developing explicit Ryuk content.\n\n**James Brodsky (our security Ransomware SC magazine author)**\n\n- [Splunking the Endpoint: “Hands on!” Ransomware Edition |](https://conf.splunk.com/files/2016/slides/splunking-the-endpoint-hands-on.pdf) [Recording (.conf2016](https://conf.splunk.com/files/2016/recordings/splunking-the-endpoint-hands-on.mp4)\npresentation)\n\n- [How Splunk Can Help You Prevent Ransomware From Holding Your Business Hostage](https://www.splunk.com/en_us/blog/security/How%20Splunk%20Can%20Help%20You%20Prevent%20Ransomware%20From%20Holding%20Your%20Business%20Hostage)\n(Blog)\n\n- Windows Ransomware Detection with Splunk (1 of 6) – Vulnerability Detection and\nWindows Patch Status (YouTube Video Series)\n\n**Whitepaper**\n\n[- Splunk Security: Detecting Unknown Malware and Ransomware](https://www.splunk.com/en_us/form/detecting-unknown-malware.html)\n\n\n-----\n\n**Splunk Phantom Resources**\n- [Automate Your Response to WannaCry Ransomware (Blog)](https://www.splunk.com/en_us/blog/security/automate-your-response-to-wannacry-ransomware.html)\n- [Playbook: Detect, Block, Contain, and Remediate Ransomware (Blog)](https://www.splunk.com/en_us/blog/security/playbook-ransomware-detect-block-contain-and-remediate.html)\n\n**Other Ransomware Blogs to Check Out**\n- [Detect Ransomware in Your Data with the Machine Learning Cloud Service](https://www.splunk.com/en_us/blog/security/detect-ransomware-in-your-data-with-the-machine-learning-cloud-service.html)\n- [Operationalize Ransomware Detections Quickly and Easily with Splunk](https://www.splunk.com/en_us/blog/industries/operationalize-ransomware-detections-quickly-and-easily-with-splunk.html)\n\nAs always, Happy Hunting and good luck :-)\n\nP.S. If you are much of a MITRE ATT&CK junkie as I am, take a peek at this great Bzar/\nCabolt Strike/ Ryuk ATTACK navigator that Red Canary created!\n\nAlso a big shout out to Katie Nickels for reminding me that Ransomware is still kind of a big\ndeal. ;-)\n\n[1] https://www.virusbulletin.com/virusbulletin/2019/10/vb2019-paper-shinigamis-revengelong-tail-ryuk-malware\n\n[2] [https://twitter.com/search?q=%23Ryuk&src=typeahead_click](https://twitter.com/search?q=%23Ryuk&src=typeahead_click)\n\n[3] https://www.washingtonpost.com/national-security/hospitals-being-hit-in-coordinated[targeted-ransomware-attack-from-russian-speaking-criminals/2020/10/28/e6e48c38-196e-](https://www.washingtonpost.com/national-security/hospitals-being-hit-in-coordinated-targeted-ransomware-attack-from-russian-speaking-criminals/2020/10/28/e6e48c38-196e-11eb-befb-8864259bd2d8_story.html)\n11eb-befb-8864259bd2d8_story.html\n\n\n-----\n\nPosted by\n\n**[Ryan Kovar](https://www.splunk.com/en_us/blog/author/rkovar.html)**\n\nNY. AZ. Navy. SOCA. KBMG. DARPA. Splunk.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-31 - Ryuk and Splunk Detections.pdf"
    ],
    "report_names": [
        "2020-10-31 - Ryuk and Splunk Detections.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536134,
    "ts_updated_at": 1743041609,
    "ts_creation_date": 1653710726,
    "ts_modification_date": 1653710726,
    "files": {
        "pdf": "https://archive.orkl.eu/8a8cc45607d317d0c92876f8191570251a564338.pdf",
        "text": "https://archive.orkl.eu/8a8cc45607d317d0c92876f8191570251a564338.txt",
        "img": "https://archive.orkl.eu/8a8cc45607d317d0c92876f8191570251a564338.jpg"
    }
}