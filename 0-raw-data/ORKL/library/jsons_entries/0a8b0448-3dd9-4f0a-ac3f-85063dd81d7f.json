{
    "id": "0a8b0448-3dd9-4f0a-ac3f-85063dd81d7f",
    "created_at": "2023-01-12T15:07:29.24232Z",
    "updated_at": "2025-03-27T02:17:00.842105Z",
    "deleted_at": null,
    "sha1_hash": "6c3539564214b22c880ce68c7c07d02c6bf4857d",
    "title": "2020-03-05 - Human-operated ransomware attacks- A preventable disaster",
    "authors": "",
    "file_creation_date": "2022-05-28T22:03:27Z",
    "file_modification_date": "2022-05-28T22:03:27Z",
    "file_size": 1923487,
    "plain_text": "# Human-operated ransomware attacks: A preventable disaster\n\n**[microsoft.com/security/blog/2020/03/05/human-operated-ransomware-attacks-a-preventable-disaster/](https://www.microsoft.com/security/blog/2020/03/05/human-operated-ransomware-attacks-a-preventable-disaster/)**\n\nMarch 5, 2020\n\nHuman-operated ransomware campaigns pose a significant and growing threat to\nbusinesses and represent one of the most impactful trends in cyberattacks today. In these\nhands-on-keyboard attacks, which are different from auto-spreading ransomware like\nWannaCry or NotPetya, adversaries employ credential theft and lateral movement methods\ntraditionally associated with targeted attacks like those from nation-state actors. They exhibit\nextensive knowledge of systems administration and common network security\nmisconfigurations, perform thorough reconnaissance, and adapt to what they discover in a\ncompromised network.\n\n**_Additional resources_**\n_[Protect your organization against ransomware: aka.ms/ransomware](https://aka.ms/ransomware)_\n\n_Learn how attackers operate: Ransomware groups continue to target healthcare, critical_\n_services; here’s how to reduce risk_\n\nThese attacks are known to take advantage of network configuration weaknesses and\nvulnerable services to deploy ransomware payloads. And while ransomware is the very\nvisible action taken in these attacks, human operators also deliver other malicious payloads,\nsteal credentials, and access and exfiltrate data from compromised networks.\n\nNews about ransomware attacks often focus on the downtimes they cause, the ransom\npayments, and the details of the ransomware payload, leaving out details of the oftentimes\nlong-running campaigns and preventable domain compromise that allow these humanoperated attacks to succeed.\n\nBased on our investigations, these campaigns appear unconcerned with stealth and have\nshown that they could operate unfettered in networks. Human operators compromise\naccounts with higher privileges, escalate privilege, or use credential dumping techniques to\nestablish a foothold on machines and continue unabated in infiltrating target environments.\n\nHuman-operated ransomware campaigns often start with “commodity malware” like banking\nTrojans or “unsophisticated” attack vectors that typically trigger multiple detection alerts;\nhowever, these tend to be triaged as unimportant and therefore not thoroughly investigated\nand remediated. In addition, the initial payloads are frequently stopped by antivirus solutions,\n\n\n-----\n\nbut attackers just deploy a different payload or use administrative access to disable the\nantivirus without attracting the attention of incident responders or security operations centers\n(SOCs).\n\n[Some well-known human-operated ransomware campaigns include REvil, Samas,](https://www.microsoft.com/security/blog/2016/03/17/no-mas-samas-whats-in-this-ransomwares-modus-operandi/)\nBitpaymer, and Ryuk. Microsoft actively monitors these and other long-running humanoperated ransomware campaigns, which have overlapping attack patterns. They take\nadvantage of similar security weaknesses, highlighting a few key lessons in security, notably\nthat these attacks are often preventable and detectable.\n\nCombating and preventing attacks of this nature requires a shift in mindset, one that focuses\non comprehensive protection required to slow and stop attackers before they can succeed.\nHuman-operated attacks will continue to take advantage of security weaknesses to deploy\ndestructive attacks until defenders consistently and aggressively apply security best\npractices to their networks. In this blog, we will highlight case studies of human-operated\nransomware campaigns that use different entrance vectors and post-exploitation techniques\nbut have overwhelming overlap in the security misconfigurations they abuse and the impact\nthey have on organizations.\n\n## PARINACOTA group: Smash-and-grab monetization campaigns\n\nOne actor that has emerged in this trend of human-operated attacks is an active, highly\nadaptive group that frequently drops Wadhrama as payload. Microsoft has been tracking this\ngroup for some time, but now refers to them as PARINACOTA, using our new naming\ndesignation for digital crime actors based on global volcanoes.\n\nPARINACOTA impacts three to four organizations every week and appears quite resourceful:\nduring the 18 months that we have been monitoring it, we have observed the group change\ntactics to match its needs and use compromised machines for various purposes, including\ncryptocurrency mining, sending spam emails, or proxying for other attacks. The group’s goals\nand payloads have shifted over time, influenced by the type of compromised infrastructure,\nbut in recent months, they have mostly deployed the Wadhrama ransomware.\n\nThe group most often employs a smash-and-grab method, whereby they attempt to infiltrate\na machine in a network and proceed with subsequent ransom in less than an hour. There are\noutlier campaigns in which they attempt reconnaissance and lateral movement, typically\nwhen they land on a machine and network that allows them to quickly and easily move\nthroughout the environment.\n\nPARINACOTA’s attacks typically brute forces their way into servers that have Remote\nDesktop Protocol (RDP) exposed to the internet, with the goal of moving laterally inside a\nnetwork or performing further brute-force activities against targets outside the network. This\nallows the group to expand compromised infrastructure under their control. Frequently, the\n\n\n-----\n\ngroup targets built-in local administrator accounts or a list of common account names. In\nother instances, the group targets Active Directory (AD) accounts that they compromised or\nhave prior knowledge of, such as service accounts of known vendors.\n\nThe group adopted the RDP brute force technique that the older ransomware called Samas\n(also known as SamSam) infamously used. Other malware families like GandCrab,\nMegaCortext, LockerGoga, Hermes, and RobbinHood have also used this method in\ntargeted ransomware attacks. PARINACOTA, however, has also been observed to adapt to\nany path of least resistance they can utilize. For instance, they sometimes discover\nunpatched systems and use disclosed vulnerabilities to gain initial access or elevate\nprivileges.\n\n_Figure 1. PARINACOTA infection chain_\n\n\n-----\n\nWe gained insight into these attacks by investigating compromised infrastructure that the\ngroup often utilizes to proxy attacks onto their next targets. To find targets, the group scans\nthe internet for machines that listen on RDP port 3389. The attackers do this from\ncompromised machines using tools like Masscan.exe, which can find vulnerable machines\non the entire internet in under six minutes.\n\nOnce a vulnerable target is found, the group proceeds with a brute force attack using tools\nlike NLbrute.exe or ForcerX, starting with common usernames like ‘admin’, ‘administrator’,\n‘guest’, or ‘test’. After successfully gaining access to a network, the group tests the\ncompromised machine for internet connectivity and processing capacity. They determine if\nthe machine meets certain requirements before using it to conduct subsequent RDP brute\nforce attacks against other targets. This tactic, which has not been observed being used by\nsimilar ransomware operators, gives them access to additional infrastructure that is less\nlikely to be blocked. In fact, the group has been observed leaving their tools running on\ncompromised machines for months on end.\n\nOn machines that the group doesn’t use for subsequent RDP brute-force attacks, they\nproceed with a separate set of actions. This technique helps the attackers evade reputationbased detection, which may block their scanning boxes; it also preserves their commandand-control (C2) infrastructure. In addition, PARINACOTA utilizes administrative privileges\ngained via stolen credentials to turn off or stop any running services that might lead to their\n[detection. Tamper protection in Microsoft Defender ATP prevents malicious and unauthorized](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-antivirus/prevent-changes-to-security-settings-with-tamper-protection)\nto settings, including antivirus solutions and cloud-based detection capabilities.\n\nAfter disabling security solutions, the group often downloads a ZIP archive that contains\ndozens of well-known attacker tools and batch files for credential theft, persistence,\nreconnaissance, and other activities without fear of the next stages of the attack being\nprevented. With these tools and batch files, the group clears event logs using wevutil.exe, as\nwell as conducts extensive reconnaissance on the machine and the network, typically\nlooking for opportunities to move laterally using common network scanning tools. When\nnecessary, the group elevates privileges from local administrator to SYSTEM using\naccessibility features in conjunction with a batch file or exploit-laden files named after the\nspecific CVEs they impact, also known as the “Sticky Keys” attack.\n\nThe group dumps credentials from the LSASS process, using tools like Mimikatz and\nProcDump, to gain access to matching local administrator passwords or service accounts\nwith high privileges that may be used to start as a scheduled task or service, or even used\ninteractively. PARINACOTA then uses the same remote desktop session to exfiltrate\nacquired credentials. The group also attempts to get credentials for specific banking or\nfinancial websites, using findstr.exe to check for cookies associated with these sites.\n\n\n-----\n\n_Figure 2. Microsoft Defender ATP alert for credential theft_\n\nWith credentials on hand, PARINACOTA establishes persistence using various methods,\nincluding:\n\nRegistry modifications using .bat or .reg files to allow RDP connections\n\nSetting up access through existing remote assistance apps or installing a backdoor\n\n\n-----\n\nCreating new local accounts and adding them to the local administrators group\n\nTo determine the type of payload to deploy, PARINACOTA uses tools like Process Hacker to\nidentify active processes. The attackers don’t always install ransomware immediately; they\nhave been observed installing coin miners and using massmail.exe to run spam campaigns,\nessentially using corporate networks as distributed computing infrastructure for profit. The\ngroup, however, eventually returns to the same machines after a few weeks to install\nransomware.\n\nThe group performs the same general activities to deliver the ransomware payload:\n\nPlants a malicious HTA file (hta in many instances) using various autostart extensibility\npoints (ASEPs), but often the registry Run keys or the Startup folder. The HTA file\ndisplays ransom payment instructions.\nDeletes local backups using tools like exe to stifle recovery of ransomed files.\nStops active services that might interfere with encryption using exe, net.exe, or other\ntools.\n\n\n-----\n\n_Figure 3. PARINACOTA stopping services and processes_\n\nDrops an array of malware executables, often naming the files based on their intended\nbehavior. If previous attempts to stop antivirus software have been unsuccessful, the\ngroup simply drops multiple variants of a malware until they manage to execute one\nthat is not detected, indicating that even when detections and alerts are occurring,\nnetwork admins are either not seeing them or not reacting to them.\n\nAs mentioned, PARINACOTA has recently mostly dropped the Wadhrama ransomware,\nwhich leaves the following ransom note after encrypting target files:\n\n\n-----\n\n_Figure 4. Wadhrama ransom note_\n\nIn several observed cases, targeted organizations that were able to resolve ransomware\ninfections were unable to fully remove persistence mechanisms, allowing the group to come\nback and deploy ransomware again.\n\n_Figure 5. Microsoft Defender ATP machine view showing reinfection by Wadhrama_\n\n\n-----\n\nPARINACOTA routinely uses Monero coin miners on compromised machines, allowing them\nto collect uniform returns regardless of the type of machine they access. Monero is popular\namong cybercriminals for its privacy benefits: Monero not only restricts access to wallet\nbalances, but also mixes in coins from other transactions to help hide the specifics of each\ntransaction, resulting in transactions that aren’t as easily traceable by amount as other digital\ncurrencies.\n\nAs for the ransomware component, we have seen reports of the group charging anywhere\nfrom .5 to 2 Bitcoins per compromised machine. This varies depending on what the attackers\nknow about the organization and the assets that they have compromised. The ransom\namount is adjusted based on the likelihood the organization will pay due to impact to their\ncompany or the perceived importance of the target.\n\n## Doppelpaymer: Ransomware follows Dridex\n\nDoppelpaymer ransomware recently caused havoc in several highly publicized attacks\nagainst various organizations around the world. Some of these attacks involved large\nransom demands, with attackers asking for millions of dollars in some cases.\n\nDoppelpaymer ransomware, like Wadhrama, Samas, LockerGoga, and Bitpaymer before it,\ndoes not have inherent worm capabilities. Human operators manually spread it within\ncompromised networks using stolen credentials for privileged accounts along with common\ntools like PsExec and Group Policy. They often abuse service accounts, including accounts\nused to manage security products, that have domain admin privileges to run native\ncommands, often stopping antivirus software and other security controls.\n\nThe presence of banking Trojans like Dridex on machines compromised by Doppelpaymer\npoint to the possibility that Dridex (or other malware) is introduced during earlier attack\nstages through fake updaters, malicious documents in phishing email, or even by being\ndelivered via the Emotet botnet.\n\nWhile Dridex is likely used as initial access for delivering Doppelpaymer on machines in\naffected networks, most of the same networks contain artifacts indicating RDP brute force.\nThis is in addition to numerous indicators of credential theft and the use of reconnaissance\ntools. Investigators have in fact found artifacts indicating that affected networks have been\ncompromised in some manner by various attackers for several months before the\nransomware is deployed, showing that these attacks (and others) are successful and\nunresolved in networks where diligence in security controls and monitoring is not applied.\n\nThe use of numerous attack methods reflects how attackers freely operate without disruption\n– even when available endpoint detection and response (EDR) and endpoint protection\nplatform (EPP) sensors already detect their activities. In many cases, some machines run\n\n\n-----\n\nwithout standard safeguards, like security updates and cloud-delivered antivirus protection.\nThere is also the lack of credential hygiene, over-privileged accounts, predictable local\nadministrator and RDP passwords, and unattended EDR alerts for suspicious activities.\n\n_Figure 6. Sample Microsoft Defender ATP alert_\n\nThe success of attacks relies on whether campaign operators manage to gain control over\ndomain accounts with elevated privileges after establishing initial access. Attackers utilize\nvarious methods to gain access to privileged accounts, including common credential theft\ntools like Mimikatz and LaZagne. Microsoft has also observed the use of the Sysinternals\ntool ProcDump to obtain credentials from LSASS process memory. Attackers might also use\n\n\n-----\n\nLSASecretsView or a similar tool to access credentials stored in the LSA secrets portion of\nthe registry. Accessible to local admins, this portion of the registry can reveal credentials for\ndomain accounts used to run scheduled tasks and services.\n\n_Figure 7. Doppelpaymer infection chain_\n\nCampaign operators continually steal credentials, progressively gaining higher privileges\nuntil they control a domain administrator-level account. In some cases, operators create new\naccounts and grant Remote Desktop privileges to those accounts.\n\nApart from securing privileged accounts, attackers use other ways of establishing persistent\naccess to compromised systems. In several cases, affected machines are observed\nlaunching a base64-encoded PowerShell Empire script that connects to a C2 server,\n\n\n-----\n\nproviding attackers with persistent control over the machines. Limited evidence suggests that\nattackers set up WMI persistence mechanisms, possibly during earlier breaches, to launch\nPowerShell Empire.\n\nAfter obtaining adequate credentials, attackers perform extensive reconnaissance of\nmachines and running software to identify targets for ransomware delivery. They use the\nbuilt-in command qwinsta to check for active RDP sessions, run tools that query Active\nDirectory or LDAP, and ping multiple machines. In some cases, the attackers target highimpact machines, such as machines running systems management software. Attackers also\nidentify machines that they could use to stay persistent on the networks after deploying\nransomware.\n\nAttackers use various protocols or system frameworks (WMI, WinRM, RDP, and SMB) in\nconjunction with PsExec to move laterally and distribute ransomware. Upon reaching a new\ndevice through lateral movement, attackers attempt to stop services that can prevent or stifle\nsuccessful ransomware distribution and execution. As in other ransomware campaigns, the\nattackers use native commands to stop Exchange Server, SQL Server, and similar services\nthat can lock certain files and disrupt attempts to encrypt them. They also stop antivirus\nsoftware right before dropping the ransomware file itself.\n\nAttempts to bypass antivirus protection and deploy ransomware are particularly successful in\ncases where:\n\nAttackers already have domain admin privileges\nTamper protection is off\nCloud-delivered protection is off\nAntivirus software is not properly managed or is not in a healthy state\n\nMicrosoft Defender ATP generates alerts for many activities associated with these attacks.\nHowever, in many of these cases, affected network segments and their associated alerts are\nnot actively being monitored or responded to.\n\nAttackers also employ a few other techniques to bypass protections and run ransomware\ncode. In some cases, we found artifacts indicating that they introduce a legitimate binary and\nuse Alternate Data Streams to masquerade the execution of the ransomware binary as\nlegitimate binary.\n\n\n-----\n\n_Figure 8. Command prompt dump output of the Alternate Data Stream_\n\nThe Doppelpaymer ransomware binary used in many attacks are signed using what appears\nto be stolen certificates from OFFERS CLOUD LTD, which might be trusted by various\nsecurity solutions.\n\nDoppelpaymer encrypts various files and displays a ransom note. In observed cases, it uses\na custom extension name for encrypted files using information about the affected\nenvironment. For example, it has used l33tspeak versions of company names and company\nphone numbers.\n\nNotably, Doppelpaymer campaigns do not fully infect compromised networks with\nransomware. Only a subset of the machines have the malware binary and a slightly smaller\nsubset have their files encrypted. The attackers maintain persistence on machines that don’t\n\n\n-----\n\nhave the ransomware and appear intent to use these machines to come back to networks\nthat pay the ransom or do not perform a full incident response and recovery.\n\n## Ryuk: Human-operated ransomware initiated from Trickbot infections\n\nRyuk is another active human-operated ransomware campaign that wreaks havoc on\norganizations, from corporate entities to local governments to non-profits by disrupting\nbusinesses and demanding massive ransom. Ryuk originated as a ransomware payload\ndistributed over email, and but it has since been adopted by human operated ransomware\noperators.\n\nLike Doppelpaymer, Ryuk is one of possible eventual payloads delivered by human\noperators that enter networks via banking Trojan infections, in this case Trickbot. At the\nbeginning of a Ryuk infection, an existing Trickbot implant downloads a new payload, often\nCobalt Strike or PowerShell Empire, and begins to move laterally across a network,\nactivating the Trickbot infection for ransomware deployment. The use of Cobalt Strike\nbeacon or a PowerShell Empire payload gives operators more maneuverability and options\nfor lateral movement on a network. Based on our investigation, in some networks, this may\nalso provide the added benefit to the attackers of blending in with red team activities and\ntools.\n\nIn our investigations, we found that this activation occurs on Trickbot implants of varying\nages, indicating that the human operators behind Ryuk likely have some sort of list of checkins and targets for deployment of the ransomware. In many cases, however, this activation\nphase comes well after the initial Trickbot infection, and the eventual deployment of a\nransomware payload may happen weeks or even months after the initial infection.\n\nIn many networks, Trickbot, which can be distributed directly via email or as a second-stage\npayload to other Trojans like Emotet, is often considered a low-priority threat, and not\nremediated and isolated with the same degree of scrutiny as other, more high-profile\nmalware. This works in favor of attackers, allowing them to have long-running persistence on\na wide variety of networks. Trickbot, and the Ryuk operators, also take advantage of users\nrunning as local administrators in environments and use these permissions to disable\nsecurity tools that would otherwise impede their actions.\n\n\n-----\n\n_Figure 9. Ryuk infection chain_\n\nOnce the operators have activated on a network, they utilize their Cobalt Strike or\nPowerShell tools to initiate reconnaissance and lateral movement on a network. Their initial\nsteps are usually to use built-in commands such as net group to enumerate group\nmembership of high-value groups like domain administrators and enterprise administrators,\nand to identify targets for credential theft.\n\nRyuk operators then use a variety of techniques to steal credentials, including the LaZagne\ncredential theft tool. The attackers also save various registry hives to extract credentials from\nLocal Accounts and the LSA Secrets portion of the registry that stores passwords of service\naccounts, as well as Scheduled Tasks configured to auto start with a defined account. In\n\n\n-----\n\nmany cases, services like security and systems management software are configured with\nprivileged accounts, such as domain administrator; this makes it easy for Ryuk operators to\nmigrate from an initial desktop to server-class systems and domain controllers. In addition, in\nmany environments successfully compromised by Ryuk, operators are able to utilize the\nbuilt-in administrator account to move laterally, as these passwords are matching and not\nrandomized.\n\nOnce they have performed initial basic reconnaissance and credential theft, the attackers in\nsome cases utilize the open source security audit tool known as BloodHound to gather\ndetailed information about the Active Directory environment and probable attack paths. This\ndata and associated stolen credentials are accessed by the attacker and likely retained, even\nafter the ransomware portion is ended.\n\nThe attackers then continue to move laterally to higher value systems, inspecting and\nenumerating files of interest to them as they go, possibly exfiltrating this data. The attackers\nthen elevate to domain administrator and utilize these permissions to deploy the Ryuk\npayload.\n\nThe ransomware deployment often occurs weeks or even months after the attackers begin\nactivity on a network. The Ryuk operators use stolen Domain Admin credentials, often from\nan interactive logon session on a domain controller, to distribute the Ryuk payload. They\nhave been seen doing this via Group Policies, setting a startup item in the SYSVOL share,\nor, most commonly in recent attacks, via PsExec sessions emanating from the domain\ncontroller itself.\n\n## Improving defenses to stop human-operated ransomware\n\nIn human-operated ransomware campaigns, even if the ransom is paid, some attackers\nremain active on affected networks with persistence via PowerShell Empire and other\nmalware on machines that may seem unrelated to ransomware activities. To fully recover\nfrom human-powered ransomware attacks, comprehensive incident response procedures\nand subsequent network hardening need to be performed.\n\nAs we have learned from the adaptability and resourcefulness of attackers, human-operated\ncampaigns are intent on circumventing protections and cleverly use what’s available to them\nto achieve their goal, motivated by profit. The techniques and methods used by the humanoperated ransomware attacks we discussed in this blog highlight these important lessons in\nsecurity:\n\n1. IT pros play an important role in security\n\nSome of the most successful human-operated ransomware campaigns have been against\nservers that have antivirus software and other security intentionally disabled, which admins\nmay do to improve performance. Many of the observed attacks leverage malware and tools\n\n\n-----\n\nthat are already detected by antivirus. The same servers also often lack firewall protection\nand MFA, have weak domain credentials, and use non-randomized local admin passwords.\nOftentimes these protections are not deployed because there is a fear that security controls\nwill disrupt operations or impact performance. IT pros can help with determining the true\nimpact of these settings and collaborate with security teams on mitigations.\n\nAttackers are preying on settings and configurations that many IT admins manage and\ncontrol. Given the key role they play, IT pros should be part of security teams.\n\n1. Seemingly rare, isolated, or commodity malware alerts can indicate new attacks\n\nunfolding and offer the best chance to prevent larger damage\n\nHuman-operated attacks involve a fairly lengthy and complex attack chain before the\nransomware payload is deployed. The earlier steps involve activities like commodity malware\ninfections and credential theft that Microsoft Defender ATP detects and raises alerts on. If\nthese alerts are immediately prioritized, security operations teams can better mitigate attacks\nand prevent the ransomware payload. Commodity malware infections like Emotet, Dridex,\nand Trickbot should be remediated and treated as a potential full compromise of the system,\nincluding any credentials present on it.\n\n1. Truly mitigating modern attacks requires addressing the infrastructure weakness that\n\nlet attackers in\n\nHuman-operated ransomware groups routinely hit the same targets multiple times. This is\ntypically due to failure to eliminate persistence mechanisms, which allow the operators to go\nback and deploy succeeding rounds of payloads, as targeted organizations focus on working\nto resolve the ransomware infections.\n\nOrganizations should focus less on resolving alerts in the shortest possible time and more on\ninvestigating the attack surface that allowed the alert to happen. This requires understanding\nthe entire attack chain, but more importantly, identifying and fixing the weaknesses in the\ninfrastructure to keep attackers out.\n\nWhile Wadhrama, Doppelpaymer, Ryuk, Samas, REvil, and other human-operated attacks\nrequire a shift in mindset, the challenges they pose are hardly unique.\n\nRemoving the ability of attackers to move laterally from one machine to another in a network\nwould make the impact of human-operated ransomware attacks less impactful and make the\nnetwork more resilient against all kinds of cyberattacks. The top recommendations for\nmitigating ransomware and other human-operated campaigns are to practice credential\nhygiene and stop unnecessary communication between endpoints.\n\nHere are relevant mitigation actions that enterprises can apply to build better security posture\nand be more resistant against cyberattacks in general:\n\n\n-----\n\n[Harden internet-facing assets and ensure they have the latest security updates. Use](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-security-baselines)\n[threat and vulnerability management to audit these assets regularly for vulnerabilities,](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/next-gen-threat-and-vuln-mgt)\nmisconfigurations, and suspicious activity.\nSecure Remote Desktop Gateway using solutions like Azure Multi-Factor\nAuthentication (MFA). If you don’t have an MFA gateway, enable network-level\nauthentication (NLA).\nPractice the principle of least-privilege and maintain credential hygiene. Avoid the use\nof domain-wide, admin-level service accounts. Enforce strong randomized, just-in-time\n[local administrator passwords. Use tools like LAPS.](https://technet.microsoft.com/en-us/mt227395.aspx)\nMonitor for brute-force attempts. Check excessive failed authentication attempts\n(Windows security event ID 4625).\nMonitor for clearing of Event Logs, especially the Security Event log and PowerShell\nOperational logs. Microsoft Defender ATP raises the alert “Event log was cleared” and\nWindows generates an Event ID 1102 when this occurs.\nTurn on [tamper protection features to prevent attackers from stopping security](https://techcommunity.microsoft.com/t5/Microsoft-Defender-ATP/Tamper-protection-now-generally-available-for-Microsoft-Defender/ba-p/911482)\nservices.\nDetermine where highly privileged accounts are logging on and exposing credentials.\nMonitor and investigate logon events (event ID 4624) for logon type attributes. Domain\nadmin accounts and other accounts with high privilege should not be present on\nworkstations.\n[Turn on cloud-delivered protection and automatic sample submission on Windows](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-antivirus/enable-cloud-protection-windows-defender-antivirus)\nDefender Antivirus. These capabilities use artificial intelligence and machine learning to\nquickly identify and stop new and unknown threats.\n[Turn on attack surface reduction rules, including rules that block credential theft,](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-exploit-guard/attack-surface-reduction-exploit-guard)\nransomware activity, and suspicious use of PsExec and WMI. To address malicious\nactivity initiated through weaponized Office documents, use rules that block advanced\nmacro activity, executable content, process creation, and process injection initiated by\nOffice applications. To assess the impact of these rules, deploy them in audit mode.\nTurn on [AMSI for Office VBA if you have Office 365.](https://www.microsoft.com/security/blog/2018/09/12/office-vba-amsi-parting-the-veil-on-malicious-macros/)\nUtilize the [Windows Defender Firewall and your network firewall to prevent RPC and](https://channel9.msdn.com/Events/Ignite/New-Zealand-2016/M377)\nSMB communication among endpoints whenever possible. This limits lateral movement\nas well as other attack activities.\n\n\n-----\n\n_Figure 10. Improving defenses against human-operated ransomware_\n\n## How Microsoft empowers customers to combat human-operated attacks\n\nThe rise of adaptable, resourceful, and persistent human-operated attacks characterizes the\n[need for advanced protection on multiple attack surfaces. Microsoft Threat Protection](https://www.microsoft.com/en-us/security/technology/threat-protection)\ndelivers comprehensive protection for identities, endpoints, data, apps, and infrastructure.\nThrough built-intelligence, automation, and integration, Microsoft Threat Protection combines\nand orchestrates into a single solution the capabilities of Microsoft Defender Advanced\nThreat Protection (ATP), Office 365 ATP, Azure ATP, and Microsoft Cloud App Security,\nproviding customers integrated security and unparalleled visibility across attack vectors.\n\nBuilding an optimal organizational security posture is key to defending networks against\n[human-operated attacks and other sophisticated threats. Microsoft Secure Score assesses](https://www.microsoft.com/security/blog/2020/03/05/human-operated-ransomware-attacks-a-preventable-disaster/)\nand measures an organization’s security posture and provides recommended improvement\nactions, guidance, and control. Using a centralized dashboard in Microsoft 365 security\ncenter, organizations can compare their security posture with benchmarks and establish key\nperformance indicators (KPIs).\n\n\n-----\n\nOn endpoints, [Microsoft Defender ATP provides unified protection, investigation, and](https://www.microsoft.com/en-us/microsoft-365/windows/microsoft-defender-atp)\nresponse capabilities. Durable machine learning and behavior-based protections detect\nhuman-operated campaigns at multiple points in the attack chain, before the ransomware\npayload is deployed. These advanced detections raise alerts on the Microsoft Defender\nSecurity Center, enabling security operations teams to immediately respond to attacks using\nthe rich capabilities in Microsoft Defender ATP.\n\nThe [Threat and Vulnerability Management capability uses a risk-based approach to the](https://techcommunity.microsoft.com/t5/Microsoft-Defender-ATP/MDATP-Threat-amp-Vulnerability-Management-now-publicly-available/ba-p/460977)\ndiscovery, prioritization, and remediation of misconfigurations and vulnerabilities on\nendpoints. Notably, it allows security administrators and IT administrators to collaborate\nseamlessly to remediate issues. For example, through Microsoft Defender ATP’s integration\nwith Microsoft Intune and System Center Configuration Manager (SCCM), security\nadministrators can create a remediation task in Microsoft Intune with one click.\n\nMicrosoft experts have been tracking multiple human operated ransomware groups. To\nfurther help customers, we released a Microsoft Defender ATP [Threat Analytics report on the](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/threat-analytics)\ncampaigns and mitigations against the attack. Through Threat Analytics, customers can see\nindicators of Wadhrama, Doppelpaymer, Samas, and other campaign activities in their\nenvironments and get details and recommendations that are designed to help security\noperations teams to investigate and respond to attacks. The reports also include relevant\nadvanced hunting queries that can further help security teams look for signs of attacks in\ntheir network.\n\n[Customers subscribed to Microsoft Threat Experts, the managed threat hunting service in](https://www.microsoft.com/security/blog/2019/02/28/announcing-microsoft-threat-experts/)\nMicrosoft Defender ATP, get [targeted attack notification on emerging ransomware campaigns](https://techcommunity.microsoft.com/t5/Microsoft-Defender-ATP/Microsoft-Threat-Experts-reaches-general-availability/ba-p/502493)\nthat our experts find during threat hunting. The email notifications are designed to inform\ncustomers about threats that they need to prioritize, as well as critical information like\ntimeline of events, affected machines, and indicators of compromise, which help in\ninvestigating and mitigating attacks. Additionally, with [experts on demand, customers can](https://www.microsoft.com/security/blog/2019/10/28/experts-on-demand-your-direct-line-to-microsoft-security-insight-guidance-and-expertise/)\nengage directly with Microsoft security analysts to get guidance and insights to better\nunderstand, prevent, and respond to human-operated attacks and other complex threats.\n\n**_Microsoft Threat Protection Intelligence Team_**\n\n### Talk to us\n\nQuestions, concerns, or insights on this story? Join discussions at the Microsoft Threat\nProtection and [Microsoft Defender ATP tech communities.](https://techcommunity.microsoft.com/t5/Microsoft-Defender-ATP/bg-p/MicrosoftDefenderATPBlog)\n\n[Read all Microsoft security intelligence blog posts.](https://www.microsoft.com/security/blog/microsoft-security-intelligence/)\n\nFollow us on Twitter **[@MsftSecIntel.](https://twitter.com/MsftSecIntel)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-03-05 - Human-operated ransomware attacks- A preventable disaster.pdf"
    ],
    "report_names": [
        "2020-03-05 - Human-operated ransomware attacks- A preventable disaster.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "703c2493-d713-4697-a691-4c2e09c032e9",
            "created_at": "2022-10-25T16:07:24.53647Z",
            "updated_at": "2025-03-27T02:02:10.274017Z",
            "deleted_at": null,
            "main_name": "Parinacota",
            "aliases": [
                "Wine Tempest"
            ],
            "source_name": "ETDA:Parinacota",
            "tools": [
                "Mimikatz",
                "ProcDump",
                "Wadhrama"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b774174f-aeca-4ea8-8f2a-b4a70a2a0b85",
            "created_at": "2023-01-06T13:46:39.451474Z",
            "updated_at": "2025-03-27T02:00:03.095913Z",
            "deleted_at": null,
            "main_name": "PARINACOTA",
            "aliases": [
                "Wine Tempest"
            ],
            "source_name": "MISPGALAXY:PARINACOTA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536049,
    "ts_updated_at": 1743041820,
    "ts_creation_date": 1653775407,
    "ts_modification_date": 1653775407,
    "files": {
        "pdf": "https://archive.orkl.eu/6c3539564214b22c880ce68c7c07d02c6bf4857d.pdf",
        "text": "https://archive.orkl.eu/6c3539564214b22c880ce68c7c07d02c6bf4857d.txt",
        "img": "https://archive.orkl.eu/6c3539564214b22c880ce68c7c07d02c6bf4857d.jpg"
    }
}