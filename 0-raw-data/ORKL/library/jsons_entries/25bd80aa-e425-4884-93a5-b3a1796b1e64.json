{
    "id": "25bd80aa-e425-4884-93a5-b3a1796b1e64",
    "created_at": "2023-01-12T15:00:23.474124Z",
    "updated_at": "2025-03-27T02:08:23.120853Z",
    "deleted_at": null,
    "sha1_hash": "6602af4ed11b05f2adb3d6ebd7fbc5957c426daf",
    "title": "2020-02-04 - Similarity between Qealler-Pyrogenic variants -Part 0x3",
    "authors": "",
    "file_creation_date": "2022-05-28T19:20:29Z",
    "file_modification_date": "2022-05-28T19:20:29Z",
    "file_size": 632855,
    "plain_text": "# Similarity between Qealler/Pyrogenic variants -Part 0x3\n\n**[securityinbits.com/malware-analysis/similarity-between-qealler-pyrogenic-variants-part-0x3/](https://www.securityinbits.com/malware-analysis/similarity-between-qealler-pyrogenic-variants-part-0x3/)**\n\nFebruary 4, 2020\n\n\nIn this last part, we will compare Old Qealler with the new Qealler/Pyrogenic variant. The\n[previous posts Pyrogenic Infostealer static analysis ‚Äì Part 0x1 &](https://www.securityinbits.com/malware-analysis/pyrogenic-infostealer-static-analysis-part-0x1/) Unpacking\nPyrogenic/Qealler using Java agent -Part 0x2 went through the latest Pyrogenic/Qealler\nstatically and dumping the unpacked code using Java agent.\n\nCONTENTS\n\n**Brief Timeline**\n\nFirst Old Qealler sample [4] (MD5: 65ab1ef8e9cef5c489d4b01cbb8a2a22) found on\nANY.RUN\n\n\n\n[6]\n\n\nThe tweet[1] by @James_inthe_box first mentioned the Old Qealler. @jeFF0Falltrades\nposted Qealler Unloaded deep dive analysis [2] .\n\nMultiple cyber security company posted articles[3] about Qealler variant using the Qazagne\nPython credential harvester.\n\n\nBased on ANY.RUN submissions, Old Qealler variant using the Qazagne stopped around\nApril 2019\n\nBased on ANY.RUN submissions, Qealler tagged samples started around Aug 2019 and\ncontinue till now Aug 2020.\n\n**June 2018**\nFirst Old Qealler sample [4] (MD5: 65ab1ef8e9cef5c489d4b01cbb8a2a22) found on\nANY.RUN\n\n\n**Aug - Sep 2018**\nThe tweet[1] by @James_inthe_box first mentioned the Old Qealler. @jeFF0Falltrades\nposted Qealler Unloaded deep dive analysis [2] .\n\n**Jan-Feb 2019**\nMultiple cyber security company posted articles[3] about Qealler variant using the Qazagne\nPython credential harvester.\n\n**Apr 2019**\nBased on ANY.RUN submissions, Old Qealler variant using the Qazagne stopped around\nApril 2019\n\n\n-----\n\n**Aug 2019 - Now**\nBased on ANY.RUN submissions, Qealler tagged samples started around Aug 2019 and\ncontinue till now Aug 2020.\n\n_grade_\n\nNote: When this post mention Old Qealler it means that the variant which was using the\nQazagne Python credential harvester.\n\n**Similarity between Qealler variants**\n\nFor easy/fast comparison, I have imported unpacked code of both Qealler variant in Eclipse\nIDE. I will compare this Old Qealler (MD5: 8D564A18B902461C19936CCB1F4E2F12) [5]\nand new Pyrogenic/Qealler sample (MD5: F0E21C7789CD57EEBF8ECDB9FADAB26B) [6]\nused in the previous posts. Highly recommended to read through the existing analysis of Old\nQealler Unloaded[2] by @jeFF0Falltrades & article [3] by Zscaler.\n\n\nBoth Qealler variants use the same Qrypter packer variant.\n\n1. AES Key bbb6fec5ebef0d93\n\nYou will find multiple references to bbb6fec5ebef0d93 as shown below. This is the AES key\nused in both variant.\n\n\n-----\n\nSame AES Key bbb6fec5ebef0d93\n\n2. UUID Key 2a898bc98aaf6c96f2054bb1eadc9848eb77633039e9e9ffd833184ce553fe9b\n\nConfig is stored in a key value pair and key for UUID present in both variants. This key is\nalso present in the Old Qealler Unloaded[2] article and the same string ‚ÄúLoaded:‚Äù is used in\nboth variants.\n\nSame UUID key\n\n3. Systeminfo in JSON format\n\nIt collects the system info in JSON format before encrypting and sending it to CC. Both\nQealler variants use the same key e.g osName, osVersion, osArch, totalMemory and\ncode structure as shown below. localIpAddress & globalIpAddress keys are added to the\nnew Qealler version.\n\n\n-----\n\nSysteminfo in JSON format Qealler Pyrogenic\n\n4. ShutdownHook\n\nIt is used when we want to run some code when JVM is shutting down and both variants use\nthe addShutdownHook() to delete the files.\n\n\n-----\n\nShutdownHook\n\n5. QeallerV4 string\n\nFound this string ‚Äúobfuscated/META-INF/QeallerV4.kotlin_module‚Äù in memory in the new\nQealler/Pyrogenic sample. Maybe this is version 4 ?\n\n**Conclusion**\n\nIn this Java malware analysis series we started with static analysis, then moved to\nUnpacking code using Java agent and in this last part we compared the Qealler variant.\nThese above similarities are the most significant which I can find based on code analysis. I\ncan conclude that the Malware author moved the Credential stealing from Python to Java\nbased code. Malware authors are experienced coder\n\nas they divided the source code in multiple sensible packages and gave proper name to\nfunctions, variables and classes.\n[Hope you enjoyed this post, please Follow @Securityinbits me on Twitter to get the latest](https://twitter.com/Securityinbits?ref_src=twsrc%5Etfw)\nupdate about my malware analysis & DFIR journey. Happy Reversing üòä\n\n**References**\n\n[1. Tweet by @James_inthe_box ‚Äì (MD5: 65ab1ef8e9cef5c489d4b01cbb8a2a22) First](https://twitter.com/James_inthe_box/status/1035190253697396737)\n\nOld Qealler tweet Aug 2018\n[2. Qealler Unloaded by @jeFF0Falltrades ‚Äì Sep 2018](https://github.com/jeFF0Falltrades/Malware-Writeups/blob/master/Qealler/Qealler-Unloaded.pdf)\n\n\n-----\n\n[3. Qealler ‚Äì a new JAR-based information stealer ‚Äì Feb 2019](https://www.zscaler.com/blogs/research/qealler-new-jar-based-information-stealer)\n[4. ANY.RUN ‚Äì (MD5: 65ab1ef8e9cef5c489d4b01cbb8a2a22) Old Qealler June 2018](https://app.any.run/tasks/e00a9231-8b1e-41da-a9d9-4a14b70637a7/)\n[5. ANY.RUN ‚Äì (MD5: 8D564A18B902461C19936CCB1F4E2F12) Old Qealler Sep 2018](https://app.any.run/tasks/fac4ef49-9f8b-4000-a838-e3421c0578db/)\n[6. ANY.RUN ‚Äì (MD5: F0E21C7789CD57EEBF8ECDB9FADAB26B) New](https://app.any.run/tasks/b59d58a1-4512-48a4-949e-6c80af823a5d/)\n\nQealler/Pyrogenic Nov 2019\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-02-04 - Similarity between Qealler-Pyrogenic variants -Part 0x3.pdf"
    ],
    "report_names": [
        "2020-02-04 - Similarity between Qealler-Pyrogenic variants -Part 0x3.pdf"
    ],
    "threat_actors": [
        {
            "id": "81dde5cc-c29f-430d-8c6e-e5e92d5015e7",
            "created_at": "2022-10-25T16:07:23.704358Z",
            "updated_at": "2025-03-27T02:02:09.932453Z",
            "deleted_at": null,
            "main_name": "Harvester",
            "aliases": [],
            "source_name": "ETDA:Harvester",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Graphon",
                "Metasploit",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535623,
    "ts_updated_at": 1743041303,
    "ts_creation_date": 1653765629,
    "ts_modification_date": 1653765629,
    "files": {
        "pdf": "https://archive.orkl.eu/6602af4ed11b05f2adb3d6ebd7fbc5957c426daf.pdf",
        "text": "https://archive.orkl.eu/6602af4ed11b05f2adb3d6ebd7fbc5957c426daf.txt",
        "img": "https://archive.orkl.eu/6602af4ed11b05f2adb3d6ebd7fbc5957c426daf.jpg"
    }
}