{
    "id": "70a31a80-2a92-431f-9141-ba2a22fed472",
    "created_at": "2022-10-25T16:48:21.771414Z",
    "updated_at": "2025-03-27T02:05:21.292028Z",
    "deleted_at": null,
    "sha1_hash": "af6cf2581e3ae03234ddda2ad04cc1065498279e",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-07-18T07:10:22Z",
    "file_modification_date": "2018-07-18T07:10:22Z",
    "file_size": 622472,
    "plain_text": "##### THREAT RESEARCH\n\n## Hussarini – Targeted Cyber Attack in the\n Philippines\n\n\n[By Jasper Manuel and Rommel Joven | July 08, 2018](https://www.fortinet.com/blog/search.html?author=Jasper+Manuel+and+Rommel+Joven)\n\nwo weeks ago, FortiGuard Labs spotted a malicious document with the politically themed file name\n\n“Draft PH-US Dialogue on Cyber Security.doc”. This document takes advantage of the\n\n# T\n\n[vulnerability CVE-2017-11882. Upon successful exploitation, it drops a malware in the victim’s %temp%](https://www.fortinet.com/blog/threat-research/cve-2017-11826-exploited-in-the-wild-with-politically-themed-rtf-document.html)\n\ndirectory.\n\nOur analysis of this malware shows that it belongs to Hussarini, also known as Sarhust, a backdoor family\n\nthat has been used actively in APT attacks targeting countries in the ASEAN region since 2014.\n\n[According to reports, the Philippines is the most exposed country in ASEAN to the cyberattacks known](http://news.abs-cbn.com/business/08/15/14/philippines-most-exposed-cyber-attack-threats-report)\n\nas advanced persistent threats, or APTs. After several massive data breaches in 2016, the Philippines\n\n[started to invest in beefing up their defences against cyberattacks. In spite of these investments,](http://cnnphilippines.com/business/2017/05/04/Govt-to-invest-P2B-for-national-cybersecurity.html)\n\n[however, the Philippines is still among the most prone countries to be targeted by these sorts of APT](http://business.inquirer.net/250163/ph-among-prone-cybersecurity-attacks)\n\nattacks.\n\n**Exploit Document**\n\nOur analysis begins with the exploit document named “Draft PH-US Dialogue on Cyber Security.doc” that\n\ntakes advantage of the CVE-2017-11882 vulnerability. Upon successful exploitation, the malicious\n\ndocument file drops two files in the %Temp% directory.\n\n -   Outllib.dll\n\n -   OutExtra.exe\n\nOutExtra.exe is a signed legitimate application from Microsoft named finder.exe. This file is part of the\n\nMicrosoft Office suite and can be used to find keywords within Outlook data files. However, in this attack,\n\nthis file is used to load the Hussarini backdoor via DLL hijacking.\n\n\n##### THREAT RESEARCH\n\n## Hussarini – Targeted Cyber Attack in the\n Philippines\n\n\n##### 232\n\n\n-----\n\n(.exe) loading the benign DLL, the application is tricked into loading a DLL containing malicious code.\n\nUsing this technique, a malware can evade the Host Intrusion Prevention System (HIPS) of security\n\nprograms that monitor the behaviors of executed files. Most HIPS tools whitelist signed or trusted files,\n\nthereby excluding any malware loaded using DLL hijacking by those signed files from any behavior\n\nmonitoring. In the context of this attack, OutExtra.exe is a signed legitimate application; however, it is\n\ntricked into loading a malware file that is disguised as the legitimate Outllib.dll file.\n\n**Decoy Document**\n\nTo avoid suspicion by the victim, the exploit downloads a decoy document from the legitimate-seeming\n\nhxxp://157.52.167.71:29317/office/word/2003/ph2/philip.varilla. During our analysis, though, the\n\ndownload link for the decoy document was already down.\n\nHowever, taking a look at the URI, we spotted several clues as to where/from whom the hacker possibly\n\nwants the user to believe the document came from. First is the “ph2,” which could mean “ph” for\n\nPhilippines and “2” as its second directory of decoy documents. And second is “philip.varilla”. A quick\n\nGoogle search on this name led us to the Service Director of the Philippines Department of Information\n\nand Communications Technology (DICT), who has the same name. DICT is the agency responsible for the\n\nplanning, development, and promotion of the Philippines’ information and communications technology\n\nincluding cybersecurity.\n\n**Hussarini**\n\nIn fact, the file Outllib.dll is actually the Hussarini backdoor, a DLL which exports functions containing the\n\nmalicious code. When the file OutExtra.exe is executed, some of these functions are called, effectively\n\nexecuting its malicious code.\n\nFig 1. Hussarini export functions\n\nWhile the original Outllib.dll also has some of the functions above, notice that this backdoor has a lot\n\nmore exported functions than just the backdoor DLL.\n\n\n-----\n\nFig 2. Export functions of the original Outllib.dll file\n\nThere is also a big difference in the file size. The original Outllib.dll has a file size range of 4-8 MB,\n\ndepending on the version, but the fake file only ranges from 40-50 KB. One of the reasons for this big\n\ndifference in file size is that only one of the exported functions of the backdoor DLL contains the\n\nmalicious code. All of the others are just RETN functions that do nothing.\n\nThus, we will focus our analysis on the function that contains the backdoor code named\n\n_RenInitInstance@12. This function begins by instantiating a class initializing the setting of the bot. It then_\n\ncreates two concurrent threads taking the created object as its parameter.\n\n\n-----\n\nFig 3. Hussarini main function\n\nThe first thread acts as a client thread that is responsible for communicating with the command and\n\ncontrol (C&C) server and listening for commands. The response is then parsed and passed to the second\n\nthread that acts as the worker. The worker thread executes the commands and reports the result to the\n\nclient thread.\n\nBefore communicating with its command and control (C&C), the malware saves a ServerID in the registry\n\nwith a randomly generated value. This ID identifies this bot in the botnet.\n\nFig 4. Bot ServerID\n\n**C&C Communication**\n\n\n-----\n\n[server. This IP address is replaced at runtime with the real C&C publicdfaph.publicvm.com.](http://publicdfaph.publicvm.com/)\n\nWhen communicating with its C&C, Hussarini uses its own custom protocol encoded with base64, which\n\nis sent over HTTP. Due to the high-level nature of the code and limited analysis time, we were not able to\n\nidentify all the fields of the protocol, but knowing some important parts is enough to understand how the\n\ncommunication works.\n\nFig 5. Hussarini protocol\n\nThe initial data it sends contains the generated ServerID, the size, and the checksum of the message. This\n\ndata is encoded with base64 and sent as an argument to the HTTP GET request.\n\nFig 6. Initial message to the command and control server\n\nThe response from the C&C is enclosed with the tag <CHECK></CHECK>. The data in between is also\n\nbase64 encoded. When decoded, we can see that it follows the same data structure as the initial\n\nmessage.\n\nFig 7. Initial response from the command and control server\n\nAfter the check, the malware gets the following system information, which it sends to the C&C via an\n\nHTTP POST request:\n\n-   User name, Computer Name, OS, and CPU information\n\nFig 8. Sending of machine information to the C&C\n\nIt took a while before we were able to receive commands from the C&C, and when we did we suddenly\n\nlost connection to the C&C, which could mean that the hacker controls the C&C manually. The connection\n\ndisruption could be because the attacker detected that the bot was being analysed and blocked our\n\nanalysis environment from communicating with the C&C, or just that the machine is not interesting to\n\n\n-----\n\ncommands are pretty obvious since its strings are not encrypted after decoding the data.\n\nFig 9. Receiving commands from the C&C\n\nThe first command includes the string “cache.txt”. The worker thread is called with this command to\n\ncreate the following files in the same directory where the malware is running.\n\n-   cache.txt\n\n-   cache.txt.cfg\n\nThe second command contains commands for the Command Prompt (cmd.exe).\n\nFig 10. Receiving next commands from the C&C\n\nThe following cmd commands sent from the C&C are then passed to the worker thread and written to\n\ncache.txt.\n\nFig 11. Commands written in\ncache.txt\n\nThe description of the commands written on cache.txt are as follows:\n\n-   systeminfo – get the systeminfo of the computer\n\n-   arp –a – view the mapping of IP addresses to MAC addresses\n\n-   ipconfig /all – display all current TCP/IP network configuration values\n\n-   netstat -ano - displays protocols statistics and current TCP/IP network connections\n\n\n-----\n\n-   net start – starts any of the various services that are running\n\n-   net view – displays the other computers that are visible on the network\n\n-   dir \"c:\\users\" /o-d – displays all users\n\nAfter sending these cmd commands, the C&C stopped responding. It could be that the hacker decided to\n\nblock the connection after seeing the result of these commands.\n\nBased on its code, this malware is capable of executing the following commands from the hacker:\n\n-   Create, read, write files\n\n-   Download and execute files/components\n\n-   Launch remote shell using cmd.exe\n\nWhile other APT backdoors have more capabilities, such as keylogging, taking screen shots, etc.,\n\nHussarini only has few, including the capability to download and execute files/components. However, its\n\nfunctionality can be extended by the hacker. Also, since this backdoor can launch a remote cmd shell, all\n\ncmd commands are available for the attacker to use, such as those seen in Figure 11.\n\n_Hussarini uses a dynamic domain to maintain anonymity and to also possibly be able to change the C&C_\n\nserver IP address. At the time of this analysis, however, we only saw it resolved to the IP address\n\n157.52.167.71, which is the same IP used to host the decoy document.\n\nFig 12. C&C domain name resolution\n\n**Final thoughts**\n\nWe are unsure how the document is being distributed; however, taking a look at the C&C domain name\n\n_[publicdfaph.publicvm.com and considering the file name of the exploit document “Draft PH-US Dialogue](http://publicdfaph.publicvm.com/)_\n\non Cyber Security.doc” and the clues from the decoy document download link\n\nhxxp://157.52.167.71:29317/office/word/2003/ph2/philip.varilla, there is one scenario that seems to make\n\nthe most sense.\n\nIt seems likely that the names used were crafted to make it look like the document came from the\n\nDepartment of Information and Communications Technology (DICT), or possibly from the Service Director,\n\nwhich would imply that the employees of the Department of Foreign Affairs (DFA) are the target. Clearly,\n\nthe use of publicdfaph in the C&C domain name is used to camouflage the traffic and to trick a network\n\nadministrator into thinking that this domain is under DFA so as not to raise any suspicion\n\n\n-----\n\nHussarini was first mentioned in APT campaigns targeting the Philippines and Thailand in 2014. Today,\n\nthis malware is still actively being used against the Philippines. The Department of Information and\n\n[Communications Technology was only formed in 2016 and has acknowledged that the Philippines’ state](https://www.rappler.com/technology/news/168634-dict-launches-ph-5-year-natl-cybersecurity-plan)\n\nof cybersecurity is still in infancy. In general, this contributes to the Philippines continuing to be a target\n\nfor cybercrime/cyberespionage or even state-sponsored attacks. Because of this, we expect that attacks\n\ntargeting that region will continue to evolve in both quantity and quality. As always, we here at FortiGuard\n\nLabs will continue to monitor events in order to hunt for, catch, and block these attacks.\n\n**Solution:**\n\nFortinet detects the exploit document as MSOffice/CVE_2017_11882.A!tr and the Hussarini samples as\n\nW32/Sarhust.D!tr. Malicious URLs related to this malware are also blocked by FortiGuard Web Filtering\n\nService.\n\n-= FortiGuard Lion Team =\n**IOCs:**\n\n_SHA256:_\n\n154261a4aab73f1ceef28695d8837902cc1e8b5cca0b8fc81ddeda350564adc0 \nMSOffice/CVE_2017_11882.A!tr\n\n05dcc7856661244d082daa88a074d2f266c70623789a7bb5a919282b178d8f98 - W32/Sarhust.D!tr\n\n_CC:_\n\nhxxp://157.52.167.71:29317/office/word/2003/ph2/philip.varilla\n\nhxxp://publicdfaph.publicvm.com:8080/\n\n\n-----\n\n_[Check out our latest Quarterly Threat Landscape Report for more details about recent threats.](http://go.fortinet.com/LP=4658?utm_source=social&utm_medium=blog&utm_campaign=GEN-WP-Q1-2018-Threat-Landscape-Report&elq_src=Social&elq_cid=70134000001StUhAAK&elq_staid=10&elq_eid=10258&elq_sid=11288)_\n\n_[Sign up for our weekly FortiGuard Threat Brief or for our FortiGuard Threat Intelligence Service.](https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html?utm_source=nreleaseblog&utm_campaign=2018-q2-fortiguardlabs-cta)_\n\n[Tags: apt, APT Campaign](http://www.fortinet.com/blog/search.html?tag=apt)\n\n### Related Posts\n\n\n-----\n\n###### THREAT RESEARCH\n\n Rehashed RAT Used in APT Campaign Against Vietnamese Organizations\n\n THREAT RESEARCH\n\n A Deep Dive Analysis of the FALLCHILL Remote Administration Tool\n\n\n###### THREAT RESEARCH\n\n A Deep Dive Analysis of the FALLCHILL Remote Administration Tool\n\n\n-----\n\n###### THREAT RESEARCH\n\n New Ransomworm Follows WannaCry Exploits\n\n### Join the Discussion\n\n\n###### THREAT RESEARCH\n\n New Ransomworm Follows WannaCry Exploits\n\n### Join the Discussion\n\n**Comments for this thread are now closed.** **×**\n\n###### 0 Comments FortinetBlog 1 Login\n\n\n Recommend\n\n\n##### ⤤ Share Sort by Best\n\n###### This discussion has been closed.\n\n\n###### ✉ Subscribe d Add Disqus to your siteAdd DisqusAdd � Disqus' Privacy PolicyPrivacy PolicyPrivacy\n\n\n#### News & Articles\n\n[News Releases](https://www.fortinet.com/corporate/about-us/newsroom/press-releases.html)\n\n[News Articles](https://www.fortinet.com/corporate/about-us/newsroom/news.html)\n\n[Trademarks](https://www.fortinet.com/corporate/about-us/contact-us/fortinet-trademark-guidelines.html)\n\n\n-----\n\n[Threat Research](https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html)\n\n[FortiGuard Labs](https://fortiguard.com/)\n\n[Threat Map](https://www.fortinet.com/fortiguard/threat-intelligence/threat-map.html)\n\n[Threat Briefs](http://demand.fortinet.com/FortiGuard)\n\n[Ransomware](https://www.fortinet.com/solutions/ransomware.html)\n\n#### Connect With Us\n\n[Blog](https://www.fortinet.com/blog/)\n\n[Fuse](https://fusecommunity.fortinet.com/)\n\n#### Company\n\n[About Us](https://www.fortinet.com/corporate/about-us/about-us.html)\n\n[Why Fortinet](https://www.fortinet.com/corporate/about-us/why-fortinet.html)\n\n[Security Fabric](https://www.fortinet.com/corporate/about-us/security-fabric.html)\n\n[Exec Mgmt](https://www.fortinet.com/corporate/about-us/executive-management.html)\n\n[Careers](https://www.fortinet.com/corporate/careers.html)\n\n[Certifications](https://www.fortinet.com/corporate/about-us/product-certifications.html)\n\n[Events](https://www.fortinet.com/corporate/about-us/events.html)\n\n[Industry Awards](https://www.fortinet.com/corporate/about-us/industry-awards.html)\n\n#### Contact Us\n\n(866) 868-3678\n\n[Copyright © 2018 Fortinet, Inc. All Rights Reserved Terms of Services Privacy Policy](https://www.fortinet.com/corporate/about-us/legal.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.07.08.Hussarini/hussarini---targeted-cyber-attack-in-the-philippines.pdf"
    ],
    "report_names": [
        "hussarini---targeted-cyber-attack-in-the-philippines"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716501,
    "ts_updated_at": 1743041121,
    "ts_creation_date": 1531897822,
    "ts_modification_date": 1531897822,
    "files": {
        "pdf": "https://archive.orkl.eu/af6cf2581e3ae03234ddda2ad04cc1065498279e.pdf",
        "text": "https://archive.orkl.eu/af6cf2581e3ae03234ddda2ad04cc1065498279e.txt",
        "img": "https://archive.orkl.eu/af6cf2581e3ae03234ddda2ad04cc1065498279e.jpg"
    }
}