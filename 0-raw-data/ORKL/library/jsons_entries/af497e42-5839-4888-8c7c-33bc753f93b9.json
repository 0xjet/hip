{
    "id": "af497e42-5839-4888-8c7c-33bc753f93b9",
    "created_at": "2022-10-25T16:48:23.875904Z",
    "updated_at": "2025-03-27T02:05:17.997534Z",
    "deleted_at": null,
    "sha1_hash": "d721478a2354fb695d2f066e276e69ad5d1eaf73",
    "title": "A Totally Tubular Treatise on TRITON and TriStation « A Totally Tubular Treatise on TRITON and TriStation | FireEye Inc",
    "authors": "",
    "file_creation_date": "2018-06-08T02:07:27Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1554285,
    "plain_text": "[Home](https://www.fireeye.com/)  [FireEye Blogs](https://www.fireeye.com/blog.html)  [Threat Research](https://www.fireeye.com/blog/threat-research.html)  A Totally Tubular Treatise on TRITON and TriStatio...\n\n\n# A Totally Tubular Treatise on TRITON and TriStation\n\n[June 07, 2018 | by Steve Miller, Evan Reese](https://www.fireeye.com/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/cap-steve-miller)\n\n### Introduction\n\n[In December 2017, FireEye's Mandiant discussed an incident response involving the](https://www.fireeye.com/services.html)\n\n[TRITON framework. The TRITON attack and many of the publicly discussed ICS intrusions](https://www.fireeye.com/blog/threat-research/2017/12/attackers-deploy-new-ics-attack-framework-triton.html)\ninvolved routine techniques where the threat actors used only what is necessary to\n\nsucceed in their mission. For both INDUSTROYER and TRITON, the attackers moved\n\nfrom the IT network to the OT (operational technology) network through systems that\n\nwere accessible to both environments. Traditional malware backdoors, Mimikatz\n\ndistillates, remote desktop sessions, and other well-documented, easily-detected attack\n\nmethods were used throughout these intrusions.\n\nDespite the routine techniques employed to gain access to an OT environment, the\n\nthreat actors behind the TRITON malware framework invested significant time learning\n\nabout the Triconex Safety Instrumented System (SIS) controllers and TriStation, a\n\nproprietary network communications protocol. The investment and purpose of the\nTriconex SIS controllers leads Mandiant to assess the attacker's objective was likely to\n\nbuild the capability to cause physical consequences.\n\nTriStation remains closed source and there is no official public information detailing the\n\n\n-----\n\nFireEye’s Advanced Practices Team was born to investigate adversary methodologies,\n\nand to answer these types of questions, so we started with a deeper look at the\nTRITON’s own Python scripts.\n\nGlossary:\n\nTRITON – Malware framework designed to operate Triconex SIS controllers via the\n\nTriStation protocol.\n\nTriStation – UDP network protocol specific to Triconex controllers.\nTRITON threat actor – The human beings who developed, deployed and/or\n\noperated TRITON.\n\n### Diving into TRITON's Implementation of TriStation\n\nTriStation is a proprietary network protocol and there is no public documentation\n\ndetailing its structure or how to create software applications that use TriStation. The\ncurrent TriStation UDP/IP protocol is little understood, but natively implemented\n\nthrough the TriStation 1131 software suite. TriStation operates by UDP over port 1502 and\nallows for communications between designated masters (PCs with the software that are\n“engineering workstations”) and slaves (Triconex controllers with special\n\ncommunications modules) over a network.\n\nTo us, the Triconex systems, software and associated terminology sound foreign and\ncomplicated, and the TriStation protocol is no different. Attempting to understand the\n\nprotocol from ground zero would take a considerable amount of time and reverse\nengineering effort – so why not learn from TRITON itself? With the TRITON framework\n\ncontaining TriStation communication functionality, we pursued studying the framework\nto better understand this mysterious protocol. Work smarter, not harder, amirite?\n\n[The TRITON framework has a multitude of functionalities, but we started with the basic](https://www.fireeye.com/blog/threat-research/2017/12/attackers-deploy-new-ics-attack-framework-triton.html)\ncomponents:\n\n\n-----\n\nTsLow.pyc (Figure 1) contains several pieces of code for error handling, but these also\npresent some cues to the protocol structure.\n\nFigure 1: TsLow.pyc function print_last_error()\n\nIn the TsLow.pyc’s function for print_last_error we see error handling for “TCM Error”.\nThis compares the TriStation packet value at offset 0 with a value in a corresponding\narray from TS_cnames.pyc (Figure 2), which is largely used as a “dictionary” for the\n\nprotocol.\n\n\n-----\n\nFigure 2: TS_cnames.pyc TS_cst array.\n\nFrom this we can infer that offset 0 of the TriStation protocol contains message types.\nThis is supported by an additional function, tcm_result, which declares type, size =\nstruct.unpack('<HH', data_received[0:4]), stating that the first two bytes should be\nhandled as integer type and the second two bytes are integer size of the TriStation\nmessage. This is our first glimpse into what the threat actor(s) understood about the\n\nTriStation protocol.\n\nSince there are only 11 defined message types, it really doesn't matter much if the type is\none byte or two because the second byte will always be 0x00.\n\nWe also have indications that message type 5 is for all Execution Command Requests\nand Responses, so it is curious to observe that the TRITON developers called this\n\n“Command Reply.” (We won’t understand this naming convention until later.)\n\nNext we examine TsLow.pyc’s print_last_error function (Figure 3) to look at “TS Error”\nand “TS_names.” We begin by looking at the ts_err variable and see that it references\nts_result.\n\n\n-----\n\nFigure 3: TsLow.pyc function print_last_error() with ts_err highlighted\n\nWe follow that thread to ts_result, which defines a few variables in the next 10 bytes\n\n(Figure 4): dir, cid, cmd, cnt, unk, cks, siz = struct.unpack('<, ts_packet[0:10]). Now\nthings are heating up. What fun. There’s a lot to unpack here, but the most interesting\nthing is how this piece script breaks down 10 bytes from ts_packet into different\nvariables.\n\n\n-----\n\nFigure 5: tcm_result\n\nReferencing tcm_result (Figure 5) we see that it defines type and size as the first four\nbytes (offset 0 – 3) and tcm_result returns the packet bytes 4:-2 (offset 4 to the end\nminus 2, because the last two bytes are the CRC-16 checksum). Now that we know where\ntcm_result leaves off, we know that the ts_reply “cmd” is a single byte at offset 6, and\n\ncorresponds to the values in the TS_cnames.pyc array and TS_names (Figure 6). The\nTRITON script also tells us that any integer value over 100 is a likely “command reply.”\nSweet.\n\nWhen looking back at the ts_result packet header definitions, we begin to see some\ngaps in the TRITON developer's knowledge: dir, cid, cmd, cnt, unk, cks, siz =\nstruct.unpack('<, ts_packet[0:10]). We're clearly speculating based on naming\n\nconventions, but we get an impression that offsets 4, 5 and 6 could be \"direction\",\n\"controller ID\" and \"command\", respectively. Values such as \"unk\" show that the\ndeveloper either did not know or did not care to identify this value. We suspect it is a\nconstant, but this value is still unknown to us.\n\n\n-----\n\nFigure 6: Excerpt TS_cnames.pyc TS_names array, which contain TRITON actor’s notes for execution\n\ncommand function codes.\n\n### TriStation Protocol Packet Structure\n\nThe TRITON threat actor’s knowledge and reverse engineering effort provides us a\nbetter understanding of the protocol. From here we can start to form a more complete\npicture and document the basic functionality of TriStation. We are primarily interested in\nmessage type 5, Execution Command, which best illustrates the overall structure of the\nprotocol. Other, smaller message types will have varying structure.\n\n\n-----\n\nFigure 7: Sample TriStation Allocate Program Execution Command, with color annotation and protocol\n\nlegend.\n\n### Corroborating the TriStation Analysis\n\nMinute discrepancies aside, the TriStation structure detailed in Figure 7 is supported by\nother public analyses. Foremost, researchers from the Coordinated Science Laboratory\n(CSL) at University of Illinois at Urbana-Champaign published a 2017 paper titled\n\n[\"Attack Induced Common-Mode Failures on PLC-based Safety System in a Nuclear](https://ieeexplore.ieee.org/iel7/7919908/7920579/07920614.pdf)\nPower Plant\". The CSL team mentions that they used the Triconex System Access\n\nApplication (TSAA) protocol to reverse engineer elements of the TriStation protocol.\nTSAA is a protocol developed by the same company as TriStation. Unlike TriStation, the\n\nTSAA protocol structure is described within official documentation. CSL assessed\nsimilarities between the two protocols would exist and they leveraged TSAA to better\n\nunderstand TriStation. The team's overall research and analysis of the general packet\nstructure aligns with our TRITON-sourced packet structure.\n\nThere are some awesome blog posts and whitepapers out there that support our\n[findings in one way or another. Writeups by Midnight Blue Labs, Accenture, and US-](https://www.midnightbluelabs.com/blog/2018/1/16/analyzing-the-triton-industrial-malware)\n\nCERT each explain how the TRITON framework relates to the TriStation protocol in\nsuperb detail.\n\n### TriStation's Reverse Engineering and TRITON's Development\n\nWhen TRITON was discovered, we began to wonder how the TRITON actor reverse\nengineered TriStation and implemented it into the framework. We have a lot of theories,\n\nall of which seemed plausible: Did they build, buy, borrow, or steal? Or some\ncombination thereof?\n\nOur initial theory was that the threat actor purchased a Triconex controller and software\nfor their own testing and reverse engineering from the \"ground up\", although if this was\n\nthe case we do not believe they had a controller with the exact vulnerable firmware\nversion else they would have had fewer problems with TRITON in practice at the victim\n\n\n-----\n\ndevelopment. But then again, it is possible that they borrowed TriStation software,\n\nTriconex hardware and Python connectors from government-owned utility that was\nusing them legitimately.\n\nLooking at the raw TRITON code, some of the comments may appear oddly phrased, but\n\nwe do get a sense that the developer is clearly using many of the right vernacular and\n\nacronyms, showing smarts on PLC programming. The TS_cnames.pyc script contains\ninteresting typos such as 'Set lable', 'Alocate network accepted', 'Symbol table ccepted'\n\nand 'Set program information reponse'. These appear to be normal human error and\nreflect neither poor written English nor laziness in coding. The significant amount of\n\nannotation, cascading logic, and robust error handling throughout the code suggests\nthoughtful development and testing of the framework. This complicates the theory of\n\n\"ground up\" development, so did they base their code on something else?\n\nWhile learning from the TriStation functionality within TRITON, we continued to explore\n\nlegitimate TriStation software. We began our search for \"TS1131.exe\" and hit dead ends\nsorting through TriStation DLLs until we came across a variety of TriStation utilities in\n\nMSI form. We ultimately stumbled across a juicy archive containing \"Trilog v4.\" Upon\nfurther inspection, this file installed \"TriLog.exe,\" which the original TRITON executable\n\nmimicked, and a couple of supporting DLLs, all of which were timestamped around\n\nAugust 2006.\n\nWhen we saw the DLL file description \"Tricon Communications Interface\" and original\nfile name \"TricCom.DLL\", we knew we were in the right place. With a simple look at the\n\nfile strings, \"BAZINGA!\" We struck gold.\n\nFile Name tr1com40.dll\n\nMD5 069247DF527A96A0E048732CA57E7D3D\n\nSize 110592\n\n|File Name|tr1com40.dll|\n|---|---|\n|MD5|069247DF527A96A0E048732CA57E7D3D|\n\n\n-----\n\nFile Description Tricon Communications Interface\n\nProduct Name TricCom Dynamic Link Library\n\nFile Version 4.2.441\n\nOriginal File Name TricCom.DLL\n\nCopyright Copyright © 1993-2006 Triconex Corporation\n\nThe tr1com40.DLL is exactly what you would expect to see in a custom application\n\npackage. It is a library that helps support the communications for a Triconex controller. If\nyou've pored over TRITON as much as we have, the moment you look at strings you can\n\nsee the obvious overlaps between the legitimate DLL and TRITON's own TS_cnames.pyc.\n\n|Product Name|TricCom Dynamic Link Library|\n|---|---|\n|File Version|4.2.441|\n|Original File Name|TricCom.DLL|\n|Copyright|Copyright © 1993-2006 Triconex Corporation|\n\n\n-----\n\nFigure 8: Strings excerpt from tr1com40.DLL\n\nEach of the execution command \"error codes\" from TS_cnames.pyc are in the strings of\n\ntr1com40.DLL (Figure 8). We see \"An MP has re-educated\" and \"Invalid Tristation I\n\ncommand\". Even misspelled command strings verbatim such as \"Non-existant data item\"\nand \"Alocate network accepted\". We also see many of the same unknown values. What\n\nis obvious from this discovery is that some of the strings in TRITON are likely based on\ncode used in communications libraries for Trident and Tricon controllers.\n\nIn our brief survey of the legitimate Triconex Corporation binaries, we observed a few\nsamples with related string tables.\n\nCompile\nPe:dllname Reference CPP Strings Code\n\nDate\n\n$Workfile:  LAGSTRS.CPP $ $Modtime:  Jul 21 1999\nLagcom40.dll 2004/11/19\n17:17:26 $ $Revision:  1.0\n\n$Workfile:  TR1STRS.CPP $ $Modtime:  May 16 2006\nTr1com40.dll 2006/08/23\n\n09:55:20 $ $Revision: 1 4\n\n|Pe:dllname|Compile Date|Reference CPP Strings Code|\n|---|---|---|\n|Lagcom40.dll|2004/11/19|$Workfile: LAGSTRS.CPP $ $Modtime: Jul 21 1999 17:17:26 $ $Revision: 1.0|\n\n\n-----\n\n|Triccom.dll|2008/07/23|$Workfile: TR1STRS.CPP $ $Modtime: May 16 2006 09:55:20 $ $Revision: 1.4|\n|---|---|---|\n|Tridcom.dll|2010/09/29|$Workfile: LAGSTRS.CPP $ $Modtime: Jul 21 1999 17:17:26 $ $Revision: 1.0|\n|Tr1com.dll|2011/04/27|$Workfile: TR1STRS.CPP $ $Modtime: May 16 2006 09:55:20 $ $Revision: 1.4|\n|Lagcom.dll|2011/04/27|$Workfile: LAGSTRS.CPP $ $Modtime: Jul 21 1999 17:17:26 $ $Revision: 1.0|\n|Triccom.dll|2011/04/27|$Workfile: TR1STRS.CPP $ $Modtime: May 16 2006 09:55:20 $ $Revision: 1.4|\n\n\nWe extracted the CPP string tables in TR1STRS and LAGSTRS and the TS_cnames.pyc\n\nTS_names array from TRITON, and compared the 210, 204, and 212 relevant strings from\neach respective file.\n\nTS_cnames.pyc TS_names and tr1com40.dll share 202 of 220 combined table strings.\nThe remaining strings are unique to each, as seen here:\n\nTS_cnames.TS_names (2017 pyc) Tr1com40.dll (2006 CPP)\n\nGo to DOWNLOAD mode <200>\n\nNot set <209>\n\n|TS_cnames.TS_names (2017 pyc)|Tr1com40.dll (2006 CPP)|\n|---|---|\n|Go to DOWNLOAD mode|<200>|\n\n\n-----\n\nUnk76 Bad message type\n\nUnk77 Bad TMI version number\n\nUnk78 Module did not respond\n\nUnk79 Open Connection: Invalid SAP %d\n\nUnsupported message for this TMI\nUnk81\nversion\n\nUnk83\n\nWrong command\n\nTS_cnames.pyc TS_names and Tridcom.dll (1999 CPP) shared only 151 of 268 combined\ntable strings, showing a much smaller overlap with the seemingly older CPP library. This\n\nmakes sense based on the context that Tridcom.dll is meant for a Trident controller, not\na Tricon controller. It does seem as though Tr1com40.dll and TR1STRS.CPP code was\n\nbased on older work.\n\nWe are not shocked to find that the threat actor reversed legitimate code to bolster\n\ndevelopment of the TRITON framework. They want to work smarter, not harder, too. But\nafter reverse engineering legitimate software and implementing the basics of the\n\nTriStation, the threat actors still had an incomplete understanding of the protocol. In\n\nTRITON's TS_cnames.pyc we saw \"Unk75\", \"Unk76\", \"Unk83\" and other values that were\nnot present in the tr1com40.DLL strings, indicating that the TRITON threat actor may\n\nhave explored the protocol and annotated their findings beyond what they reverse\n\n|Unk77|Bad TMI version number|\n|---|---|\n|Unk78|Module did not respond|\n|Unk79|Open Connection: Invalid SAP %d|\n|Unk81|Unsupported message for this TMI version|\n|Unk83||\n|Wrong command||\n\n\n-----\n\nYou can see more of the Trilog and Triconex DLL files on VirusTotal.\n\nItem Name MD5 Description\n\nTricom Communcations\nTr1com40.dll 069247df527a96a0e048732ca57e7d3d\nDLL\n\nData1.cab e6a3c93a6d433cbaf6f573b6c09d76c4 Parent of Tr1com40.dll\n\nTrilog v4.1.360R 13a3b83ba2c4236ca59aba679941c8a5 RAR Archive of TriLog\n\nTrident Communications\nTridCom.dll 5c2ed617fdec4779cb33c89082a43100\nDLL\n\n### Afterthoughts\n\nSeeing Triconex systems targeted with malicious intent was new to the world six months\n\nago. Moving forward it would be reasonable to anticipate additional frameworks, such\nas TRITON, designed for usage against other SIS controllers and associated technologies.\n\nIf Triconex was within scope, we may see similar attacker methodologies affecting the\n\ndominant industrial safety technologies.\n\nBasic security measures do little to thwart truly persistent threat actors and monitoring\nonly IT networks is not an ideal situation. Visibility into both the IT and OT environments\n\nis critical for detecting the various stages of an ICS intrusion. Simple detection concepts\nsuch as baseline deviation can provide insight into abnormal activity.\n\nWhile the TRITON framework was actively in use, how many traditional ICS “alarms”\nwere set off while the actors tested their exploits and backdoors on the Triconex\n\n|Item Name|MD5|Description|\n|---|---|---|\n|Tr1com40.dll|069247df527a96a0e048732ca57e7d3d|Tricom Communcations DLL|\n|Data1.cab|e6a3c93a6d433cbaf6f573b6c09d76c4|Parent of Tr1com40.dll|\n|Trilog v4.1.360R|13a3b83ba2c4236ca59aba679941c8a5|RAR Archive of TriLog|\n|TridCom.dll|5c2ed617fdec4779cb33c89082a43100|Trident Communications DLL|\n\n\n-----\n\nWe believe that we can identify these anomalies in the long run if we strive for increased\n\nvisibility into ICS technologies.\n\nWe hope that by holding public discussions about ICS technologies, the Infosec\ncommunity can cultivate closer relationships with ICS vendors and give the world better\n\ninsight into how attackers move from the IT to the OT space. We want to foster more\nconversations like this and generally share good techniques for finding evil. Since most\n\nof all ICS attacks involve standard IT intrusions, we should probably come together to\n\ninvent and improve any guidelines for how to monitor PCs and engineering workstations\nthat bridge the IT and OT networks. We envision a world where attacking or disrupting\n\nICS operations costs the threat actor their cover, their toolkits, their time, and their\nfreedom. It's an ideal world, but something nice to shoot for.\n\n### Thanks and Future Work\n\nThere is still much to do for TRITON and TriStation. There are many more sub-message\n\ntypes and nuances for parsing out the nitty gritty details, which is hard to do without a\n\ncontroller of our own. And although we’ve published much of what we learned about the\n\nTriStation here on the blog, our work will continue as we continue our study of the\nprotocol.\n\nThanks to everyone who did so much public research on TRITON and TriStation. We have\n\ncited a few individuals in this blog post, but there is a lot more community-sourced\n\ninformation that gave us clues and leads for our research and testing of the framework\nand protocol. We also have to acknowledge the research performed by the TRITON\n\nattackers. We borrowed a lot of your knowledge about TriStation from the TRITON\n\nframework itself.\n\nFinally, remember that we're here to collaborate. We think most of our research is right,\nbut if you notice any errors or omissions, or have ideas for improvements, please\n\ncontact: smiller@fireeye.com.\n\n### Recommended Reading\n\n\n-----\n\nPower Plant: Practical Experience Report\n\nDevelopment of a tailored methodology and forensic toolkit for industrial control\n\nsystems incident response\n\n[Analyzing the TRITON industrial malware](https://www.midnightbluelabs.com/blog/2018/1/16/analyzing-the-triton-industrial-malware)\n\nRepository containting original and decompiled files of TRISIS/TRITON/HATMAN\n\nmalware\n\n[MAR-17-352-01 HatMan - Safety System Targeted Malware (Update A)](https://ics-cert.us-cert.gov/MAR-17-352-01-HatMan-Safety-System-Targeted-Malware-Update)\n\n[TRISIS Malware Analysis of Safety System Targeted Malware](https://dragos.com/blog/trisis/TRISIS-01.pdf)\n\n### Appendix A: TriStation Message Type Codes\n\nThe following table consists of hex values at offset 0 in the TriStation UDP packets and\n\nthe associated dictionary definitions, extracted verbatim from the TRITON framework in\n\nlibrary TS_cnames.pyc.\n\nValue at 0x0 Message Type\n\n1 Connection Request\n\n2 Connection Response\n\n3 Disconnect Request\n\n4 Disconnect Response\n\n5 Execution Command\n\n6 Ping Command\n\n|Value at 0x0|Message Type|\n|---|---|\n|1|Connection Request|\n|2|Connection Response|\n|3|Disconnect Request|\n|4|Disconnect Response|\n|5|Execution Command|\n\n\n-----\n\n|9|MPS Are Dead|\n|---|---|\n|10|Access Denied|\n|11|Connection Failed|\n\n\n### Appendix B: TriStation Execution Command Function Codes\n\nThe following table consists of hex values at offset 6 in the TriStation UDP packets and\n\nthe associated dictionary definitions, extracted verbatim from the TRITON framework in\n\nlibrary TS_cnames.pyc.\n\nValue at 0x6 TS_cnames String\n\n0 0: 'Start download all',\n\n1 1: 'Start download change',\n\n2 2: 'Update configuration',\n\n3 3: 'Upload configuration',\n\n4 4: 'Set I/O addresses',\n\n5 5: 'Allocate network',\n\n|Value at 0x6|TS_cnames String|\n|---|---|\n|0|0: 'Start download all',|\n|1|1: 'Start download change',|\n|2|2: 'Update configuration',|\n|3|3: 'Upload configuration',|\n|4|4: 'Set I/O addresses',|\n\n\n-----\n\n7 7: Set calendar,\n\n|8|8: 'Get calendar',|\n|---|---|\n|9|9: 'Set scan time',|\n|A|10: 'End download all',|\n|B|11: 'End download change',|\n|C|12: 'Cancel download change',|\n|D|13: 'Attach TRICON',|\n|E|14: 'Set I/O address limits',|\n|F|15: 'Configure module',|\n|10|16: 'Set multiple point values',|\n|11|17: 'Enable all points',|\n|12|18: 'Upload vector table',|\n|13|19: 'Get CP status ',|\n\n\n-----\n\n|16|22: 'Pause program',|\n|---|---|\n|17|23: 'Do single scan',|\n|18|24: 'Get chassis status',|\n|19|25: 'Get minimum scan time',|\n|1A|26: 'Set node number',|\n|1B|27: 'Set I/O point values',|\n|1C|28: 'Get I/O point values',|\n|1D|29: 'Get MP status',|\n|1E|30: 'Set retentive values',|\n|1F|31: 'Adjust clock calendar',|\n|20|32: 'Clear module alarms',|\n|21|33: 'Get event log',|\n\n\n22 34: 'Set SOE block',\n\n\n-----\n\n24 36: 'Get SOE data',\n\n25 37: 'Enable OVD',\n\n26 38: 'Disable OVD',\n\n27 39: 'Enable all OVDs',\n\n28 40: 'Disable all OVDs',\n\n29 41: 'Process MODBUS',\n\n2A 42: 'Upload network',\n\n2B 43: 'Set lable',\n\n2C 44: 'Configure system variables',\n\n2D 45: 'Deconfigure module',\n\n2E 46: 'Get system variables',\n\n2F 47: 'Get module types',\n\n30 48: 'Begin conversion table download',\n\n|25|37: 'Enable OVD',|\n|---|---|\n|26|38: 'Disable OVD',|\n|27|39: 'Enable all OVDs',|\n|28|40: 'Disable all OVDs',|\n|29|41: 'Process MODBUS',|\n|2A|42: 'Upload network',|\n|2B|43: 'Set lable',|\n|2C|44: 'Configure system variables',|\n|2D|45: 'Deconfigure module',|\n|2E|46: 'Get system variables',|\n|2F|47: 'Get module types',|\n\n\n-----\n\n|33|51: 'Get conversion table',|\n|---|---|\n|34|52: 'Set ICM status',|\n|35|53: 'Broadcast SOE data available',|\n|36|54: 'Get module versions',|\n|37|55: 'Allocate program',|\n|38|56: 'Allocate function',|\n|39|57: 'Clear retentives',|\n|3A|58: 'Set initial values',|\n|3B|59: 'Start TS2 program download',|\n|3C|60: 'Set TS2 data area',|\n|3D|61: 'Get TS2 data',|\n|3E|62: 'Set TS2 data',|\n\n\n3F 63: 'Set program information'\n\n\n-----\n\n41 65: 'Upload program',\n\n42 66: 'Upload function',\n\n43 67: 'Get point groups',\n\n44 68: 'Allocate symbol table',\n\n45 69: 'Get I/O address',\n\n46 70: 'Resend I/O address',\n\n47 71: 'Get program timing',\n\n48 72: 'Allocate multiple functions',\n\n49 73: 'Get node number',\n\n4A 74: 'Get symbol table',\n\n4B 75: 'Unk75',\n\n4C 76: 'Unk76',\n\n4D 77: 'Unk77',\n\n|42|66: 'Upload function',|\n|---|---|\n|43|67: 'Get point groups',|\n|44|68: 'Allocate symbol table',|\n|45|69: 'Get I/O address',|\n|46|70: 'Resend I/O address',|\n|47|71: 'Get program timing',|\n|48|72: 'Allocate multiple functions',|\n|49|73: 'Get node number',|\n|4A|74: 'Get symbol table',|\n|4B|75: 'Unk75',|\n|4C|76: 'Unk76',|\n\n\n-----\n\n|50|80: 'Go to DOWNLOAD mode',|\n|---|---|\n|51|81: 'Unk81',|\n|52||\n|53|83: 'Unk83',|\n|54||\n|55||\n|56||\n|57||\n|58||\n|59||\n|5A||\n|5B||\n\n\n5C\n\n\n-----\n\n5E\n\n5F\n\n60\n\n61\n\n62\n\n63\n\n64 100: 'Command rejected',\n\n65 101: 'Download all permitted',\n\n66 102: 'Download change permitted',\n\n67 103: 'Modification accepted',\n\n68 104: 'Download cancelled',\n\n69 105: 'Program accepted',\n\n6A 106: 'TRICON attached',\n\n|5F|Col2|\n|---|---|\n|60||\n|61||\n|62||\n|63||\n|64|100: 'Command rejected',|\n|65|101: 'Download all permitted',|\n|66|102: 'Download change permitted',|\n|67|103: 'Modification accepted',|\n|68|104: 'Download cancelled',|\n|69|105: 'Program accepted',|\n\n\n-----\n\n|6D|109: 'Program is running',|\n|---|---|\n|6E|110: 'Program is halted',|\n|6F|111: 'Program is paused',|\n|70|112: 'End of single scan',|\n|71|113: 'Get chassis configuration response',|\n|72|114: 'Scan period modified',|\n|73|115: '<115>',|\n|74|116: '<116>',|\n|75|117: 'Module configured',|\n|76|118: '<118>',|\n|77|119: 'Get chassis status response',|\n|78|120: 'Vectors response',|\n\n\n-----\n\n|7B|123: 'Configuration updated',|\n|---|---|\n|7C|124: 'Get minimum scan time response',|\n|7D|125: '<125>',|\n|7E|126: 'Node number set',|\n|7F|127: 'Get MP status response',|\n|80|128: 'Retentive values set',|\n|81|129: 'SOE block set',|\n|82|130: 'Module alarms cleared',|\n|83|131: 'Get event log response',|\n|84|132: 'Symbol table ccepted',|\n|85|133: 'OVD enable accepted',|\n|86|134: 'OVD disable accepted',|\n\n\n87 135: 'Record event log response',\n\n\n-----\n\np,\n\n|8A|138: 'Alocate network accepted',|\n|---|---|\n|8B|139: 'Load vector table accepted',|\n|8C|140: 'Get calendar response',|\n|8D|141: 'Label set',|\n|8E|142: 'Get module types response',|\n|8F|143: 'System variables configured',|\n|90|144: 'Module deconfigured',|\n|91|145: '<145>',|\n|92|146: '<146>',|\n|93|147: 'Get conversion table response',|\n|94|148: 'ICM print data sent',|\n|95|149: 'Set ICM status response',|\n\n\n-----\n\n|98|152: 'Process MODBUS response',|\n|---|---|\n|99|153: 'Allocate program response',|\n|9A|154: 'Allocate function response',|\n|9B|155: 'Clear retentives response',|\n|9C|156: 'Set initial values response',|\n|9D|157: 'Set TS2 data area response',|\n|9E|158: 'Get TS2 data response',|\n|9F|159: 'Set TS2 data response',|\n|A0|160: 'Set program information reponse',|\n|A1|161: 'Get program information response',|\n|A2|162: 'Upload program response',|\n|A3|163: 'Upload function response',|\n\n\nA4 164: 'Get point groups response',\n\n\n-----\n\nA6 166: Program timing response,\n\nA7 167: 'Disable points full',\n\nA8 168: 'Allocate multiple functions response',\n\nA9 169: 'Get node number response',\n\nAA 170: 'Symbol table response',\n\nAB\n\nAC\n\nAD\n\nAE\n\nAF\n\nB0\n\nB1\n\nB2\n\n|A7|167: 'Disable points full',|\n|---|---|\n|A8|168: 'Allocate multiple functions response',|\n|A9|169: 'Get node number response',|\n|AA|170: 'Symbol table response',|\n|AB||\n|AC||\n|AD||\n|AE||\n|AF||\n|B0||\n|B1||\n\n\n-----\n\n|B5|Col2|\n|---|---|\n|B6||\n|B7||\n|B8||\n|B9||\n|BA||\n|BB||\n|BC||\n|BD||\n|BE||\n|BF||\n|C0||\n\n\nC1\n\n\n-----\n\nC3\n\nC4\n\nC5\n\nC6\n\nC7\n\nC8 200: 'Wrong command',\n\nC9 201: 'Load is in progress',\n\nCA 202: 'Bad clock calendar data',\n\nCB 203: 'Control program not halted',\n\nCC 204: 'Control program checksum error',\n\nCD 205: 'No memory available',\n\nCE 206: 'Control program not valid',\n\nCF 207: 'Not loading a control program',\n\n|C4|Col2|\n|---|---|\n|C5||\n|C6||\n|C7||\n|C8|200: 'Wrong command',|\n|C9|201: 'Load is in progress',|\n|CA|202: 'Bad clock calendar data',|\n|CB|203: 'Control program not halted',|\n|CC|204: 'Control program checksum error',|\n|CD|205: 'No memory available',|\n|CE|206: 'Control program not valid',|\n\n\n-----\n\n|D2|210: 'A Network is missing',|\n|---|---|\n|D3|211: 'The download time mismatches',|\n|D4|212: 'Key setting prohibits this operation',|\n|D5|213: 'Bad control program version',|\n|D6|214: 'Command not in correct sequence',|\n|D7|215: '<215>',|\n|D8|216: 'Bad Index for a module',|\n|D9|217: 'Module address is invalid',|\n|DA|218: '<218>',|\n|DB|219: '<219>',|\n|DC|220: 'Bad offset for an I/O point',|\n|DD|221: 'Invalid point type',|\n\n\nDE 222: 'Invalid Point Location'\n\n\n-----\n\nE0 224: '<224>',\n\nE1 225: '<225>',\n\nE2 226: '<226>',\n\nE3 227: 'Invalid module type',\n\nE4 228: '<228>',\n\nE5 229: 'Invalid table type',\n\nE6 230: '<230>',\n\nE7 231: 'Invalid network continuation',\n\nE8 232: 'Invalid scan time',\n\nE9 233: 'Load is busy',\n\nEA 234: 'An MP has re-educated',\n\nEB 235: 'Invalid chassis or slot',\n\nEC 236: 'Invalid SOE number',\n\n|E1|225: '<225>',|\n|---|---|\n|E2|226: '<226>',|\n|E3|227: 'Invalid module type',|\n|E4|228: '<228>',|\n|E5|229: 'Invalid table type',|\n|E6|230: '<230>',|\n|E7|231: 'Invalid network continuation',|\n|E8|232: 'Invalid scan time',|\n|E9|233: 'Load is busy',|\n|EA|234: 'An MP has re-educated',|\n|EB|235: 'Invalid chassis or slot',|\n\n\n-----\n\n|EF|239: 'The variable is write protected',|\n|---|---|\n|F0|240: 'Node number mismatch',|\n|F1|241: 'Command not allowed',|\n|F2|242: 'Invalid sequence number',|\n|F3|243: 'Time change on non-master TRICON',|\n|F4|244: 'No free Tristation ports',|\n|F5|245: 'Invalid Tristation I command',|\n|F6|246: 'Invalid TriStation 1131 command',|\n|F7|247: 'Only one chassis allowed',|\n|F8|248: 'Bad variable address',|\n|F9|249: 'Response overflow',|\n|FA|250: 'Invalid bus',|\n\n\nbl ll d\n\n\n-----\n\nFD 253: 'Point cannot be disabled',\n\nFE 254: 'Too many retentive variables',\n\nFF 255: 'LOADER_CONNECT',\n\n256: 'Unknown reject code'\n\n[This entry was posted on Thu Jun 07 10:00 EDT 2018 and filed under Ics, python,](https://www.fireeye.com/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/ics)\n[analysis, Evan Reese, Industrial Control Systems, and Steve Miller.](https://www.fireeye.com/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/analysis)\n\n|FE|254: 'Too many retentive variables',|\n|---|---|\n|FF|255: 'LOADER_CONNECT',|\n||256: 'Unknown reject code'|\n\n\n-----\n\n## Sign up for email updates\n\nGet information and insight on\n\ntoday's advanced threats from the\nleader in advanced threat\n\nprevention.\n\nFirst Name Last Name\n\nEmail Address\n\nCompany Name\n\nThreat Research Blog\n\nProducts and Services\nBlog\n\nExecutive Perspectives\nBlog\n\nSUBSCRIBE\n\n\n-----\n\n[About FireEye](https://www.fireeye.com/company/why-fireeye.html)\n\n[Customer Stories](https://www.fireeye.com/customers.html)\n\n[Careers](https://www.fireeye.com/company/jobs.html)\n\n[Partners](https://www.fireeye.com/partners.html)\n\n[Investor Relations](http://investors.fireeye.com/)\n\n[Supplier Documents](https://www.fireeye.com/company/supplier.html)\n\n\n[Newsroom](https://www.fireeye.com/company/newsroom.html)\n\n[Press Releases](https://www.fireeye.com/company/press-releases.html)\n\n[Webinars](https://www.fireeye.com/company/webinars.html)\n\n[Events](https://www.fireeye.com/company/events.html)\n\n[Awards and Honors](https://www.fireeye.com/company/awards.html)\n\n[Email Preferences](https://www2.fireeye.com/manage-your-preferences.html)\n\n\n[Incident?](https://www.fireeye.com/company/incident-response.html)\n\n[Report Security Issue](https://www.fireeye.com/company/security.html)\n\n[Contact Support](https://www.fireeye.com/support/contacts.html)\n\n[Customer Portal](https://csportal.fireeye.com/secur/login_portal.jsp?orgId=00D3000000063LS&portalId=06030000000pSNE)\n\n[Communities](https://community.fireeye.com/welcome)\n\n[Documentation Portal](https://docs.fireeye.com)\n\n\n[Threat Research](https://www.fireeye.com/blog/threat-research.html)\n\n[Products and Services](https://www.fireeye.com/blog/products-and-services.html)\n\n[Executive Perspectives](https://www.fireeye.com/blog/executive-perspective.html)\n\nThreat Map\n\n[View the Latest Threats](https://www.fireeye.com/cyber-map/threat-map.html)\n\n\n[1 877 347 3393](tel:+1 877-347-3393)\n\nStay Connected\n\n## \n\n\nCopyright © 2018 FireEye, Inc. All rights reserved.\n\n[Privacy & Cookies Policy | Privacy Shield | Legal Documentation](https://www.fireeye.com/company/privacy.html)\n\n\nSite Language\n\nEnglish \n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.06.07.Totally_Tubular_Treatise_on_TRITON_TriStation/totally-tubular-treatise-on-triton-and-tristation.pdf"
    ],
    "report_names": [
        "totally-tubular-treatise-on-triton-and-tristation"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041117,
    "ts_creation_date": 1528423647,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/d721478a2354fb695d2f066e276e69ad5d1eaf73.pdf",
        "text": "https://archive.orkl.eu/d721478a2354fb695d2f066e276e69ad5d1eaf73.txt",
        "img": "https://archive.orkl.eu/d721478a2354fb695d2f066e276e69ad5d1eaf73.jpg"
    }
}