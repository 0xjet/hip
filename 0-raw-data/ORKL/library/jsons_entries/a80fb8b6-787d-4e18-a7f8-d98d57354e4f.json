{
    "id": "a80fb8b6-787d-4e18-a7f8-d98d57354e4f",
    "created_at": "2024-06-20T02:03:14.788824Z",
    "updated_at": "2025-03-27T02:17:11.842838Z",
    "deleted_at": null,
    "sha1_hash": "1311cbedf6aabe75e742b6c72dc6af50847c8c4b",
    "title": "GRU's BlueDelta Targets Key Networks in Europe with Multi-Phase Espionage Campaigns",
    "authors": "",
    "file_creation_date": "2024-05-29T14:26:37Z",
    "file_modification_date": "2024-05-30T10:05:58Z",
    "file_size": 4124621,
    "plain_text": "##### CYBER\n\n THREAT\n\n ANALYSIS By Insikt Group®\n\n**RUSSIA**\n\nMay 30, 2024\n\n# GRU’s BlueDelta Targets Key\n Networks in Europe with Multi-Phase Espionage Campaigns\n\n**BlueDelta conducted sophisticated** **Operational infrastructure was** **Credential harvesting campaigns**\n**credential-stealing campaigns** **continuously evolved to deploy** **targeted webmail service**\ntargeting Ukraine’s Ministry of **Headlace malware through three** **users, using scripts hosted on**\nDefence, Ukrainian weapons import distinct phases, abusing legitimate compromised routers to defeat\nand export companies and an services such as GitHub, Mocky, two-factor authentication and\n\n\n-----\n\n1 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n## Key Findings\n\n\n\n  - BlueDelta has been observed conducting espionage using Headlace malware against targets in\nEurope by using phishing emails, legitimate internet services, and living off-the-land binaries.\n\n  - The group regularly updates and improves its operational infrastructure, indicating sophistication\nand agility.\n\n  - Since March 2022, BlueDelta has conducted regular credential harvesting campaigns targeting\nYahoo and UKR[.]net webmail service users.\n\n  - BlueDelta’s campaigns targeted Ukraine’s Ministry of Defence, Ukrainian weapons import and\nexport companies, and a think tank in Azerbaijan, with the most recent campaigns observed in\nFebruary and March 2024.\n\n  - This targeting matches Russia’s strategic interests, with a strong focus on gathering information\nto support its war effort in Ukraine, as well as monitoring the geopolitical landscape of\nneighboring countries and North Atlantic Treaty Organization (NATO) members.\n\n  - BlueDelta uses credential harvesting pages that can defeat two-factor authentication and\nCAPTCHA challenges by relaying requests between legitimate services and compromised\nUbiquiti routers.\n\n  - Recorded Future customers should turn on real-time alerting through Recorded Future’s\nIntelligence Cloud to detect typosquat domains that mimic their brands, assess suspicious email\nattachments with Recorded Future Malware Intelligence, and monitor their companies’ attack\nsurface by using Recorded Future’s Attack Surface Intelligence.\n\n## Background\n\n[On September 4, 2023, CERT-UA](https://cert.gov.ua/article/5702579) reported a phishing campaign that leveraged Headlace malware to\ntarget a critical energy infrastructure facility in Ukraine. During this campaign, BlueDelta sent phishing\nemails from a fake sender address that contained links to archive files. The archive files contained lure\nimages and Windows BAT script, which, if executed, would result in the whoami command being run\nand the results being exfiltrated back to the threat actor. On September 6, 2023, Zscaler published a\n[new blog post titled “Steal-It Campaign”. This report provided additional information covering several](https://www.zscaler.com/blogs/security-research/steal-it-campaign)\nnew attack chains used by BlueDelta, which targeted entities in Australia, Belgium, and Poland.\n\nIn October 2023, Insikt Group shared an internal report on BlueDelta activity involving\nliving-off-the-land binaries and abuse of LIS to target European victims. During this campaign, three\nseparate infection chains were observed, which used geo-fencing techniques to exploit victims located\nonly in Austria, Lithuania, and Spain. The report detailed the threat actor's use of the free mock\napplication programming interface (API) services Mockbin (mockbin[.]org) and Mocky (mocky[.]io) to\nsurvey Windows operating systems and capture NT LAN Manager (NTLM) hashes. BlueDelta used\nseven different infrastructure stages, as shown in Figure 1, to filter out sandboxes and incompatible\noperating systems and to restrict payloads to systems in targeted countries. Victims who failed these\nchecks downloaded a benign file and were redirected to Microsoft’s web portal, msn[.]com, whereas\n\n2 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n    - *.rf[.]gd\n\n    - *infinityfreeapp[.]com\n\n    - *.000[.]pe\n\n    - *.lovestoblog[.]com\n\n    - *.kesug[.]com\n\n    - *.wuaze[.]com\n\n    - *.great-site[.]net\n\n    - *.42web[.]io\n\n    - *.free[.]nf\n\n3 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n4 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n- https://windows-update-service[.]github[.]io/kb5021042/update.html?id=[GUID]\n\n- https://microsoft-update-com[.]github[.]io/kb5021042/update.html?id=[GUID]\n\n\n##### Stage Two\n\n\nFollowing either of the stage-one links redirects the victim to the stage-two script hosted at Mockbin,\nas shown in Figure 4.\n\n5 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n6 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\nThe stage-four ZIP payloads were essentially unchanged from the stage-four payloads detected in\nphase one. The ZIP files contain a BAT script and a benign CAB file for the Windows Update\nkb5021042. Upon execution, the BAT script creates a visual basic script (VBScript) and an additional\nBAT script. The VBScript is then executed and calls the newly created BAT script. The only purpose of\nVBScript is to execute the newly created BAT script.\n\nWhen executed, the newly created BAT script displays a command prompt showing a fake installation of\na Windows Update, as shown in Figure 6. As per phase one (see Figure 1), the new BAT script runs in a\nloop every five minutes (300 seconds) and downloads a third BAT script (stage six) via Mockbin and\nMocky, which masquerades as a CSS file and is run via Microsoft Edge in headless mode. The final\ndownloaded BAT script is then moved to the victim’s C:\\ProgramData\\ directory before being\nexecuted and finally deleted.\n\n**Figure 6: Fake Windows update installer (Source: Recorded Future)**\n\n7 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n##### Lure Documents and Malware\n\nInsikt Group identified three separate ZIP files used in phase two, as shown in Table 1. The ZIP files\ncontained the first malicious BAT and benign CAB files and no further lure documents.\n\n8 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n|File Name|Hash (SHA256)|\n|---|---|\n|kb5021042.zip|d712744a128b22a0919ecde2508bbfeffa33a61870a941c424e8b301183 c44fe|\n|kb5021042.cmd|7ec80bd3469656f3d8d406a64097d2f0b2bbd1fd0e49f260ae7b285244 70c0fe|\n|update-kb-5021042.zip|54a27464c7ad7f2e32cd123b27c0f9082590cd5ba48526bf00728e8107 048f48|\n|Install-kb-5021042.cmd|12d98b5c513fe9668661e3fdabb93f595a82a81554f28fbd84658de0aab 2a929|\n|update-kb-5021042.zip|6c0658ac52ca6eb315ab8b6b702a9e24d02d58f24d6d6feb55716b0c0 5252e51|\n|install-kb-5021042.cmd|d9be3235d7236ff66c871d4070b98fd0fe46319d0ef04047c1ab4e8c725 4d8a5|\n\n\n9 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n|Domain|First Detected|\n|---|---|\n|calc-dwn[.]infinityfreeapp[.]com|2023-10-30|\n|clouddrive[.]infinityfreeapp[.]com|2023-10-12|\n|document-c[.]infinityfreeapp[.]com|2023-10-30|\n|document-d[.]infinityfreeapp[.]com|2023-10-30|\n|documents-cloud[.]infinityfreeapp[.]com|2023-12-06|\n|downloadc[.]infinityfreeapp[.]com|2023-11-08|\n|downloaddoc[.]infinityfreeapp[.]com|2023-11-07|\n|downloadfile[.]infinityfreeapp[.]com|2023-10-24|\n|downloadingdoc[.]infinityfreeapp[.]com|2023-11-07|\n|downloadinge[.]infinityfreeapp[.]com|2023-10-26|\n|downloadingf[.]infinityfreeapp[.]com|2023-10-19|\n|downloadingq[.]infinityfreeapp[.]com|2023-10-26|\n|downloadingw[.]infinityfreeapp[.]com|2023-10-26|\n|downloadx[.]infinityfreeapp[.]com|2023-11-13|\n|downloadz[.]infinityfreeapp[.]com|2023-11-08|\n|fdsagdfg[.]rf[.]gd|2023-10-17|\n|file-download[.]infinityfreeapp[.]com|2023-12-15|\n|filedwn[.]infinityfreeapp[.]com|2023-10-25|\n|filehosting[.]infinityfreeapp[.]com|2023-10-25|\n|filihosting[.]infinityfreeapp[.]com|2023-10-25|\n|microsoft-files[.]infinityfreeapp[.]com|2023-10-24|\n|online-download[.]infinityfreeapp[.]com|2023-11-13|\n|online-drive[.]infinityfreeapp[.]com|2023-11-13|\n\n\n10 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n|online-files[.]infinityfreeapp[.]com|2023-11-06|\n|---|---|\n|opendoc[.]infinityfreeapp[.]com|2023-11-13|\n|opendocument[.]infinityfreeapp[.]com|2023-11-13|\n|opendocuments[.]infinityfreeapp[.]com|2023-11-13|\n\n\n**Table 2: BlueDelta phase-three, stage-one, redirection domains (Source: Recorded Future)**\n\n\nAdditionally, for phase three, the actors made slight changes to the infrastructure stages, combining\nprevious stages two and three into a single PHP script, as shown in Figure 8.\n\n\n**Figure 8: Phase-three infrastructure stages (Source: Recorded Future)**\n\n\n##### Stage One\n\n\nPreviously, in phase two, stage one, the actors used an HTML redirection script to forward victims to\nMockbin, as described in Figure 3.\n\nIn phase three, the redirection technique was modified to use the web server's root directory, which\nforwarded victims to a new PHP script called filedwn.php. For example, *.infinityfreeapp[.]com/?id=\nwould redirect to *.infinityfreeapp[.]com/filedwn.php?id=.\n\n\n##### Stage Two\n\n\nIn phase three, the aforementioned file filedwn.php replaced the previously used stages two and\nthree in the infection chain. Due to PHP being a server-side programming language, it is not possible to\nsee the actual code used, but it’s assumed that the malicious script carries out similar sandbox,\n\n11 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\nbrowser, and geo-fencing checks as per the previous stages in phases one and two. If the victim fails\nthe checks, filedwn.php serves the victim a benign ZIP file and redirects them to msn[.]com; if they\npass, they receive a malicious ZIP. It is suspected that the threat actors may have added some sort of\ncount function limiting the number of times the malicious payload can be downloaded, as during our\nresearch, it was noted that the payload could only be downloaded once, and subsequent requests\nwould receive the benign ZIP file.\n\n\n##### Stage Three\n\n\nThe payload for stage three was changed slightly from the previous two phases. As shown In Figure 9,\none lure theme was “news_week_6” and when decompressed, the ZIP file contained a folder with an\nexecutable called news_week_6 and hidden files named calc.cmd, WindowsCodecs.dll,\n```\nnews_week_6, and news_week_6.docx.\n\n```\n**Figure 9: Contents of the stage-four payload (Source: Recorded Future)**\n\nThe news_week_6 executable file is a benign copy of calc.exe that loads WindowsCodecs.dll via\ndynamic-link library (DLL) search order hijacking. Once loaded, the DLLMain function executes\n```\ncalc.cmd via a call to system(), as shown in Figure 10. The news_week_6 executable file had several\n\n```\nspaces appended to the file name, which were probably added to hide the fact that it was an\nexecutable file.\n\n12 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n**Figure 10: WindowsCodec.dll used to execute cmd.cmd (Source: Recorded Future)**\n\nThe calc.cmd script creates similar BAT and VBS files, as seen in phases one and two. It then launches\nthe decoy document news_week_6.docx, removes the malicious payload from the victim’s machine,\nand replaces it with a copy of the benign payload news_week_6 file.\n\nAs shown in Figure 11, the first line of the calc.cmd script is the same as seen in the first two phases.\nThis creates a VBS script and another BAT script that repeatedly checks in with the\ncommand-and-control (C2) for new payloads masquerading as CSS files. The calc.cmd script then\ncontinues by killing any running instances of WINWORD.exe, removing the malicious artifacts from its\npayload, copying the benign copy of its payload into the user’s download directory, and then opening\nthe decoy document.\n\n**Figure 11: calc.cmd script (Source: Recorded Future)**\n\nA minor change to the BAT script used to retrieve a new CSS payload was observed. When running\nMicrosoft Edge in headless mode, rather than using the URL for the C2, an encoded HTML page is\ninstead provided, as shown in Figure 12.\n\n13 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n**Figure 12: BAT script used to repeatedly retrieve new CSS payloads from the C2 server (Source: Recorded Future)**\n\nAs shown in Figure 13, when Microsoft Edge loads the encoded page, a JavaScript script redirects the\nbrowser to an infinityfreeapp[.]com URL rather than Mockbin, as used in phases one and two.\n\n\n**Figure 13: Decoded HTML page used to redirect the victim to the C2 server (Source: Recorded Future)**\n\n\n##### Stage Four\n\n\nThe stage-four script, execdwn.php, was also changed to PHP from HTML and is hosted at InfinityFree\nrather than Mockbin. The content of this script is not viewable, but it is expected to be similar to the\nprevious stage-five script containing JavaScript, as shown earlier in Figure 7. The script conducts\nbrowser and operating system checks before forwarding the victim to a final payload hosted at Mocky,\nwhich contains commands to be executed on the victim's system. As per the previous Mockbin file, this\nstage is also used to capture the output of these commands after stage six for the actors to collect.\n\n\n##### Stage Five\n\n\nSeveral payload scripts were captured in this phase. The scripts remained the same as those found in\nphase one and contained a second geo-fencing check that, if passed, allowed the victim to download a\nmalicious CSS payload via HTML smuggling, which contained commands to be run on the victim's\nmachine, as shown in Figure 14.\n\n14 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\nThe final CSS payload was updated slightly compared to phases one and two. As shown in Figure 15,\nBlueDelta printed the username and userdomain to a file rather than using the whoami command.\n\n**Figure 15: Stage-five geofence and final payload script (Source: Recorded Future)**\n\n##### Stage Six\n\nAt stage six, BlueDelta sent the results of the commands run on the victim system to the PHP file\n```\nexecdwn.php rather than Mockbin, as in phases one and two.\n\n##### Phishing Emails and Lure Documents\n\n```\nInsikt Group uncovered one phishing email linked to BlueDelta’s phase-three campaign, as shown in\n**Figure 16. The email appeared to be sent from the Chancellery of the Prime Minister in Poland and used**\na report on the human rights of Palestine and Arab-occupied territories as a lure. The email contained a\nhyperlink to opendoc[.]infinityfreeapp[.]com, with the display text war.zip.\n\n15 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n**Figure 16: Phishing email possibly spoofed from the Polish Government (Source: Recorded Future)**\n\n\nFollowing the link downloads a malicious ZIP file containing a legitimate, publicly available United\nNations document entitled “Report of the Special Committee to Investigate Israeli Practices Affecting\nthe Human Rights of the Palestinian People and Other Arabs of the Occupied Territories”, alongside\nhidden files as shown in Figure 17. These files provide similar functionality to those described earlier in\n[the report, in phase three, stage three. IBM](https://securityintelligence.com/x-force/itg05-ops-leverage-israel-hamas-conflict-lures-to-deliver-headlace-malware/) previously reported this lure document in December 2023.\n\n\n**Figure 17: Hidden files contained inside War.zip (Source: Recorded Future)**\n\n\n16 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n|File Name|Type|SHA256|\n|---|---|---|\n|2023-12-bois-position-on-accessing-capit al-pr.zip|Payload|a0a67412968c10224e04bfbe32e6012b34e4a4e cc36fc72332101b90acec8fa4|\n|2023-12-bois-position-on-accessing-capit al-pr.zip|Benign|d5eb88c1fe88e274a9212ff6647e8220f1bfbc250 e0e891f60ea8a28afc9b19c|\n|20231113_ROU_ROAD_MOV_REQUEST-NAT OTF20231113NN001-302.zip|Benign|2f498a25049f89a809550a11e379912ac053eba 881470ddd3a4e2b487a31c2d0|\n|calc.war.zip|Benign|763d47f16a230f7c2d8c135b30535a52d66a1ed 210596333ca1c3890d72e6efc|\n|IN11897.zip|Payload|f9f8ca7fa979766c168d7162df572f3549c7af2e7 07e5a5ac8e06bd352bb7399|\n|IN11897.zip|Benign|0a5109479620c4c567928680f8e4be685a74e4 b31efaa98811f3b54992697e2d|\n|news_week_6.zip|Benign|bbe435a3f0adb1ef4810d22ed74f5eba8907201c ba01230b8c98dbe5963e11a8|\n|Roadmap.zip|Benign|f70c4f5f417b7360a9edb493ac2bc982bc59a18e ee064825c859ad889b0be167|\n|SEDE-PV-2023-10-09-1_EN.zip|Benign|07c06492d3252236579097d5b114bbbea217325 5b017fb26df7217ea986d6d10|\n|SEDE-PV-2023-10-09-1_EN.zip|Benign|8dba6356fdb0e89db9b4dad10fdf3ba37e92ae4 2d55e7bb8f76b3d10cd7a780c|\n|SEDE-PV-2023-10-09-1_EN.zip|Benign|555eafd28474cf01b5eea4648ec6b417d08d17ab a151c5592c8843672812cffa|\n|war.zip|Benign|8cc664ff412fc80485d0af61fb0617f818d37776e 5a06b799f74fe0179b31768|\n|war.zip|Payload|b0604f58c55fdba4c4381e411689b29c031dbce 3fb16c656a6b5fadb578deb76|\n|Zeyilname.zip|Benign|2f1c2afdf17831e744841029bb5d5a3ea9fda569 958303be03e50fb3a764913f|\n\n\n**Table 3: BlueDelta lure ZIP files used in phase three (Source: Recorded Future)**\n\n\n17 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n18 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n    - Webhook[.]site - webhook[.]site\n\n    - Pipedream - pipedream[.]com\n\n    - Mocky - mocky[.]io\n\n    - Forge - getforge[.]com\n\nBlueDelta used these free LIS for page- and code-hosting, credential capture, and exfiltration. As\nshown in Table 4, eighteen pages that were active between March 2022 and March 2024 were\n[uncovered. Google’s Threat Analysis Group (TAG) and](https://blog.google/threat-analysis-group/update-threat-landscape-ukraine/) [Sekoia previously attributed some of the pages to](https://blog.sekoia.io/apt28-leverages-multiple-phishing-techniques-to-target-ukrainian-civil-society/)\nBlueDelta, as highlighted in Appendix A.\n\n**Date Live** **Page URL** **Exfil URL** **Page Theme**\n\nwebhook[.]site/f5eace0b-062\n\n2022-02-16 consumerpanel0x254a2[.]frge[.]io b-402f-a006-63b97e4950c3 Ukraine MOD\n\nwebhook[.]site/d466f7a7-63a\n\n2022-03-05 Hatdfg-rhgreh684[.]frge[.]io 1-4c04-8347-fe2d0a96081f ukr[.]net\n\nwebhook[.]site/d466f7a7-63a\n\n2022-03-14 id-unconfirmeduser[.]frge[.]io 1-4c04-8347-fe2d0a96081f ukr[.]net\n\nwebhook[.]site/d466f7a7-63a ukr[.]net\n\n2022-03-17 ua-consumerpanel[.]frge[.]io 1-4c04-8347-fe2d0a96081f\n\nwebhook[.]site/f5eace0b-062\n\n2022-03-19 Panelunregistertle-348[.]frge[.]io b-402f-a006-63b97e4950c3 Ukraine MOD\n\neoytfd39hbrspa3.m.pipedrea\n\n2023-01-17 settings-panel[.]frge[.]io m[.]net Yahoo\n\n2023-02-26 eo6kgbwpysq0laa[.]m[.]pipedream[.]net 37.191.122[.]186:3578 Yahoo\n\n2023-03-01 ukrprivacysite[.]frge[.]io 68.76.150[.]97:8080 ukr[.]net\n\n2023-03-21 xgfdstu6k[.]frge[.]io 174.53.242[.]108:8080 ukr[.]net\n\n2023-04-03 setnewcred[.]ukr[.]net[.]frge[.]io 174.53.242[.]108:8080 ukr[.]net\n\n2023-05-24 eottxji4yk4vg5x[.]m[.]pipedream[.]net 37.191.122[.]186:3578 Yahoo\n\n19 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n|Date Live|Page URL|Exfil URL|Page Theme|\n|---|---|---|---|\n|2022-02-16|consumerpanel0x254a2[.]frge[.]io|webhook[.]site/f5eace0b-062 b-402f-a006-63b97e4950c3|Ukraine MOD|\n|2022-03-05|Hatdfg-rhgreh684[.]frge[.]io|webhook[.]site/d466f7a7-63a 1-4c04-8347-fe2d0a96081f|ukr[.]net|\n|2022-03-14|id-unconfirmeduser[.]frge[.]io|webhook[.]site/d466f7a7-63a 1-4c04-8347-fe2d0a96081f|ukr[.]net|\n|2022-03-17|ua-consumerpanel[.]frge[.]io|webhook[.]site/d466f7a7-63a 1-4c04-8347-fe2d0a96081f|ukr[.]net|\n|2022-03-19|Panelunregistertle-348[.]frge[.]io|webhook[.]site/f5eace0b-062 b-402f-a006-63b97e4950c3|Ukraine MOD|\n|2023-01-17|settings-panel[.]frge[.]io|eoytfd39hbrspa3.m.pipedrea m[.]net|Yahoo|\n|2023-02-26|eo6kgbwpysq0laa[.]m[.]pipedream[.]net|37.191.122[.]186:3578|Yahoo|\n|2023-03-01|ukrprivacysite[.]frge[.]io|68.76.150[.]97:8080|ukr[.]net|\n|2023-03-21|xgfdstu6k[.]frge[.]io|174.53.242[.]108:8080|ukr[.]net|\n|2023-04-03|setnewcred[.]ukr[.]net[.]frge[.]io|174.53.242[.]108:8080|ukr[.]net|\n|2023-05-24|eottxji4yk4vg5x[.]m[.]pipedream[.]net|37.191.122[.]186:3578|Yahoo|\n\n\n-----\n\n|2023-06-25|eoy6vrzslpn9vu[.]m[.]pipedream[.]net|37.191.122[.]186:3578. AND eos93vb2cwsu3xf.m.pipedrea m[.]net|Yahoo|\n|---|---|---|---|\n|2023-07-13|eomhv6vdu4v5qyt[.]m[.]pipedream[.]net|eo1ws2wgj75rdfd.m.pipedrea m[.]net|ste.kiev[.]ua|\n|2023-07-18|eogo85tybrrn2r[.]m[.]pipedream[.]net|Not captured|Yahoo|\n|2023-09-27|xzdgsdfhfgtjdfj[.]wuaze[.]com|73.80.9[.]137:35780|Yahoo|\n|2024-02-21|run[.]mocky[.]io/v3/4e14d583-bbf5-4af3 -9a86-4c0938a7802a|3.80.9[.]137:35770|ukr[.]net|\n|2024-03-05|turbify-biz-cesdaz[.]rf[.]gd|webhook[.]site/e7f39f18-bcb 3-40e3-9e82-8cf7f807cc80|CESD AZ - Azerbaijan think tank|\n|2024-03-06|consumerpanelapp[.]42web[.]io|eoytfd39hbrspa3.m.pipedrea m[.]net|SE SFTF PROGRES|\n\n\n20 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\ncredentials are submitted to the router from the harvesting page, the script waits for one of five\nresponses:\n\n  - If it receives the response “Finlay”, it calls the function show_last. This function hides three\nHTML elements on the page with the IDs \"first\", \"second\", and \"third\" by setting their style\nattribute to \"display:none\", effectively making these elements invisible on the webpage.\nSimultaneously, it makes a fourth element with the ID \"last\" visible by setting its style attribute\nto \"display:block\". The HTML elements with IDs \"first\", \"second\", \"third\", and “last\" all\ncontain HTML forms with slightly different content, which are loaded dynamically in different\nscenarios.\n\n  - If the credential harvesting script receives the response “Redirect” from the compromised\nrouter, it redirects the browser window to mail.ukr[.]net, indicating the credentials have been\nsuccessfully captured.\n\n  - If it receives the response “AGAIN”, the credential harvesting script re-posts the credentials to\nthe compromised router.\n\n  - If the response “BAD” is received, the text on the form with the “first” element ID is changed to\n\"Неправильні дані\", which is Ukrainian for \"Incorrect data\". The form's background color is set to\nred and the “nowait” function is called, which resets the submit button status so it can be used\nagain.\n\n  - Finally, if the response contains the term “DATA=”, the script splits and isolates the string after\nthe search term, replaces single quotes with double quotes, and then uses the JSON.parse\nfunction to turn the stringified JSON data into a JavaScript object. It then iterates over each\nelement in this data structure. This allows BlueDeltat to dynamically update the displayed web\npage based on the data received from the compromised router.\n\nInsikt Group was unable to recover the malicious script hosted on the compromised router, but it is\nassumed that it can also relay any CAPTCHA challenges issued by the legitimate website, as described\nin the Sekoia report mentioned above. This can be assumed due to similar JavaScript functions noted\non the harvesting page.\n\n21 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n22 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n23 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n24 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n25 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\ncompromised Ubiquiti EdgeRouters via fixed high-ephemeral ports. The domains targeting Yahoo users\nwere:\n\n    - eo6kgbwpysq0laa[.]m[.]pipedream[.]net\n\n    - eogo85tybrrn2r[.]m[.]pipedream[.]net\n\n    - eottxji4yk4vg5x[.]m[.]pipedream[.]net\n\n    - eoy6vrzslpn9vu[.]m[.]pipedream[.]net\n\n    - xzdgsdfhfgtjdfj[.]wuaze[.]com\n\nSome of these pages displayed fake account activity pages that claimed the victim’s accounts had been\nlogged into by unauthorized users located in Belarus, China, and Iran. The page also suggested that the\nuser should reset the password associated with these accounts, as shown in Figure 26.\n\n26 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n27 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n  - “OPDATA”: If this string is returned, a user prompt asking for a verification code, either via phone\nor email, is displayed based on the device returned from the XML HTTP request\n\n  - “BAD-VCODE”: This string indicates the verification code entered was incorrect; the input fields\nare editable again to enable the user to retry\n\n##### ● “OPTIONS”: Similar to OPDATA, but provides different authentication options\n ● “Finaly”: This value indicates the authentication process is complete; the user is then\nredirected to another page; in this case, mail.yahoo[.]com\n\n##### ● “AGAIN”: The server requests the client to resend the data, which triggers a recursive call to the\nsend function with the same data\n\n  - “CHANGE, BAD, BAD-PASSWORD, BAD-CODE, YAK-CODE, and PUSH”: These handle various states of\nthe authentication process, such as changing the password; incorrect username, password, or\ncode; and push notification verification; the user interface (UI) is updated for each case to\nprompt the user to take the next step or correct errors\n\n28 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n29 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n## Victimology\n\n\nUpon analyzing Headlace geofencing scripts and countries targeted by credential harvesting\ncampaigns from 2022 onwards, Insikt Group identified that thirteen separate countries were targeted\nby BlueDelta. As expected, Ukraine topped the list, accounting for 40% of the activity. Türkiye might\nseem like an unexpected target with 10%, but it's important to note that it was singled out only by\nHeadlace geofencing, unlike Ukraine, Poland, and Azerbaijan, which were targeted through both\nHeadlace geofencing and credential harvesting.\n\n\n**Figure 28: Countries targeted with either Headlace or credential harvesting since 2022 (Source: Recorded Future)**\n\n\n30 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n## Mitigations\n\n\n\n##### ● Establish real-time alerts through Recorded Future's Intelligence Cloud to detect typosquat domains that mimic your brand. This proactive measure helps guard against entities like BlueDelta, which could exploit these domains for credential harvesting and phishing.\n\n- Use Recorded Future Identity Intelligence to monitor, detect, and mitigate widespread credential\n##### leaks and theft, enhancing account protection.\n ● Implement multi-factor authentication (MFA) to add an extra layer of security and make it more\nchallenging for attackers to abuse compromised credentials.\n\n##### ● Monitor Insikt Group reporting for the latest threat actor tradecraft, TTPs, targeting, and indicators of compromise (IoCs) to ensure you are informed of the threat.\n ● Use this intelligence to provide comprehensive training on email security best practices,\nincluding identifying phishing emails, suspicious attachments, and links. Regularly reinforce\ntraining to maintain a high level of awareness and vigilance.\n\n- Assess suspicious email attachments with Recorded Future Malware Intelligence for instant\n##### analysis to quickly assess and understand the associated threats.\n ● Monitor your company's attack surface by using Recorded Future’s Attack Surface Intelligence to\nautomate the detection of potential entry points for attackers and highlight network\nconfiguration changes.\n\n##### ● Ensure that both software and browser updates are prioritized using the Recorded Future\nVulnerability Intelligence Module and installed regularly. Updates often include patches for\nvulnerabilities and replace outdated plug-ins and add-ons, making it harder for threat actors to\nexploit these vulnerabilities to compromise a device.\n\n- Implement a domain name system (DNS)-blocking policy to prevent connections to free hosting\napex domains, such as those used by InfinityFree and free API services, if your company does\nnot use them.\n\n- Participate in Recorded Future Collective Insights to harness the power of the Recorded Future\nIntelligence Cloud and customer signals to give visibility into threats based on your environment,\nindustry, and in-the-wild incidents.\n\n\n## Outlook\n\n\nInsikt Group anticipates that BlueDelta will continue the operations detailed in this report, with an\nintensified emphasis on gaining insights into operational capabilities and potential vulnerabilities in\nUkraine's defense sector. BlueDelta’s objective is to acquire intelligence that bolsters Russia's military\nendeavors in Ukraine and gather insights into geopolitical dynamics in neighboring nations and NATO\nmember states. The adaptability, skill, and ferocity demonstrated in this report will continue at pace as\nRussia tries to capture intelligence, which gives it an edge on the battlefield and regarding geopolitical\ninterests.\n\n31 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n## Appendix A — Indicators\n\n\n32 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n33 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n## Appendix B — Mitre ATT&CK Techniques\n\n|Appendix B — Mitre ATT&CK Techniques|Col2|\n|---|---|\n|Tactic: Technique|ATT&CK Code|\n|Resource Development: Acquire Infrastructure: Domains|T1583.001|\n|Resource Development: Acquire Infrastructure: Web Services|T1583.006|\n|Resource Development: Stage Capabilities: Upload Malware|T1608.001|\n|Resource Development: Stage Capabilities: Link Target|T1608.005|\n|Initial Access: Spearphishing Attachment|T1566.001|\n|Initial Access: Spearphishing Link|T1566.002|\n|Execution: Command and Scripting Interpreter: PowerShell|T1059.001|\n|Execution: Command and Scripting Interpreter: Windows Command Shell|T1059.003|\n|Execution: Command and Scripting Interpreter: Visual Basic|T1059.005|\n|Execution: Command and Scripting Interpreter: JavaScript|T1059.007|\n|Defense Evasion: Virtualization/Sandbox Evasion: System Checks|T1497.001|\n|Defense Evasion: Hide Artifacts: Hidden Window|T1564.003|\n|Credential Access: Web Portal Capture|T1056.003|\n|Credential Access: Multi-Factor Authentication Interception|T1111|\n|Discovery: System Owner/User Discovery|T1033|\n|Command and Control: Web Service: Dead Drop Resolver|T1102.001|\n|Command and Control: Web Service: One-Way Communication|T1102.003|\n|Command and Control: Standard Encoding|T1132.001|\n\n\n34 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n35 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\nRecorded Future reporting contains expressions of likelihood or probability consistent\n[with US Intelligence Community Directive (ICD) 203: Analytic Standards (published](https://irp.fas.org/dni/icd/icd-203.pdf)\nJanuary 2, 2015). Recorded Future reporting also uses confidence level standards\n[employed by the US Intelligence Community to assess the quality and quantity of the](https://www.dni.gov/files/ODNI/documents/assessments/ICA-declass-16MAR21.pdf)\nsource information supporting our analytic judgments.\n\nAbout Insikt Group[®]\n\nRecorded Future’s Insikt Group, the company’s threat research division, comprises\nanalysts and security researchers with deep government, law enforcement, military, and\nintelligence agency experience. Their mission is to produce intelligence that reduces risk\nfor clients, enables tangible outcomes, and prevents business disruption.\n\nAbout Recorded Future[®]\n\nRecorded Future is the world’s largest threat intelligence company. Recorded Future’s\nIntelligence Cloud provides end-to-end intelligence across adversaries, infrastructure,\nand targets. Indexing the internet across the open web, dark web, and technical\nsources, Recorded Future provides real-time visibility into an expanding attack surface\nand threat landscape, empowering clients to act with speed and confidence to reduce\nrisk and securely drive business forward. Headquartered in Boston with offices and\nemployees around the world, Recorded Future works with over 1,800 businesses and\ngovernment organizations across more than 75 countries to provide real-time, unbiased,\nand actionable intelligence.\n\nLearn more at recordedfuture.com\n\n\nrisk and securely drive business forward. Headquartered in Boston with offices and\nemployees around the world, Recorded Future works with over 1,800 businesses and\ngovernment organizations across more than 75 countries to provide real-time, unbiased,\nand actionable intelligence.\n\nLearn more at recordedfuture.com\n\n36 CTA-RU-2024-0530 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://go.recordedfuture.com/hubfs/reports/CTA-RU-2024-0530.pdf"
    ],
    "report_names": [
        "CTA-RU-2024-0530.pdf"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1718848994,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1716992797,
    "ts_modification_date": 1717063558,
    "files": {
        "pdf": "https://archive.orkl.eu/1311cbedf6aabe75e742b6c72dc6af50847c8c4b.pdf",
        "text": "https://archive.orkl.eu/1311cbedf6aabe75e742b6c72dc6af50847c8c4b.txt",
        "img": "https://archive.orkl.eu/1311cbedf6aabe75e742b6c72dc6af50847c8c4b.jpg"
    }
}