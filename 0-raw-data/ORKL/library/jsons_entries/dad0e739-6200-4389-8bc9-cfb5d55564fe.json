{
    "id": "dad0e739-6200-4389-8bc9-cfb5d55564fe",
    "created_at": "2023-01-12T14:59:40.213671Z",
    "updated_at": "2025-03-27T02:15:49.37941Z",
    "deleted_at": null,
    "sha1_hash": "bca9ef652354ce6cd74d63c0c0ca435f69fe33e5",
    "title": "2021-04-17 - Adversary Dossier- Ryuk Ransomware Anatomy of an Attack in 2021",
    "authors": "",
    "file_creation_date": "2022-05-28T04:44:45Z",
    "file_modification_date": "2022-05-28T04:44:45Z",
    "file_size": 1024464,
    "plain_text": "# Adversary Dossier: Ryuk Ransomware Anatomy of an Attack in 2021\n\n**[advanced-intel.com/post/adversary-dossier-ryuk-ransomware-anatomy-of-an-attack-in-2021](https://www.advanced-intel.com/post/adversary-dossier-ryuk-ransomware-anatomy-of-an-attack-in-2021)**\n\nAdvIntel April 16, 2021\n\nApr 16, 2021\n\n6 min read\n\n**_By Vitali Kremez, Al Calleo, Yelisey Boguslavskiy_**\n\n_Ryuk ransomware infections have been observed since late 2018. Ryuk actors are_\n_constantly evolving the TTPs used in Ryuk attributed campaigns. Some of the most notable_\n_targets of these campaigns have been hospitals, government entities, and large_\n\n\n-----\n\n_corporations. The Ryuk adversary group is widely considered to be one of the most_\n_successful and impactful targeting corporations and governments worldwide._\n\n_This report is an excerpt of the tactical report from the flagship Andariel platform_ _produced by_\n_the subject matter expert team._\n\n**Background**\n\nThis report illustrates some of the new and existing Tactics, Techniques, and Procedures\n(TTPs) of the Ryuk ransomware variants that Advintel has witnessed throughout their\ninvestigations in 2021.\n\n\n-----\n\n**Initial Attack Vector: RDP Brute Force / Other Means of Initial Attack Vector**\n\nRyuk operators gain initial access to a network most often through two methods in 2021.\n\nService-Based RDP Compromise\n\nBotnet-Based Malware Delivery\n\nAdvintel has noticed an overall increase of RDP compromise as the initial infection vector\nacross Ryuk-attributed attacks. Threat actors have been observed in the wild employing\nlarge-scale brute force and password spraying attacks against exposed RDP-hosts to\ncompromise user credentials.\n\nTargeted phishing emails coupled with the support service center calls such as \"BazaCall\"\nhave also been observed as an initial infection vector in many Ryuk-attributed attacks. This\nweaponized document will have instructions that tell the user to “enable content” which will\n\n\n-----\n\nactivate a macro and enable the document to download a malicious payload through a\nPowerShell script that is executed through a command prompt.\n\n_Figure 1. Ryuk Kill chain. (Source: Advintel)_\n\n**Reconnaissance I: Victim Value Local Reconnaissance Stage**\n\nOnce a foothold has been established Ryuk operators will attempt to enumerate domain\ntrusts such as local domains, network shares, users, and Active Directory Organization\nUnits. During this stage, the actors attempt to gather information about the organization to\ndetermine what resources within the infected domain are of value to perpetrating the rest of\nthe attack. Bloodhound and AdFind have become popular tools used by actors trying to\nenumerate active directory information within an infected domain.\n\n\n-----\n\n**Reconnaissance II: ZoomInfo and Open Source Target Revenue Enrichment**\n\nAdvintel has observed actors conducting OSINT research related to the compromised host\ndomain to identify the infected victim company and evaluate their revenue. Ransomware\noperators use the total annual revenue of the victim’s company to assess what the ransom\namount will be. Specifically, actors have been observed searching across services such as\nZoomInfo to retrieve information about the victim company such as technologies used,\nrecent mergers and acquisitions, corporate hierarchies, personnel, and various other\nelements of data related to the company that may be of value to their operations.\n\n**Post-Exploitation: Cobalt Strike as Golden Standard Tool**\n\nAfter infection, Ryuk operators utilize Post-Exploitation toolkits such as Cobalt Strike to\nconduct further reconnaissance and operation.\n\n**Network Breach Possible Roadblocks: Anti-Virus & Endpoint Detection Response**\n**Bypass**\n\n\n-----\n\nRyuk operators will utilize information collected by bot scans and their own scans to gain\ninformation about anti-virus (AV) and Endpoint Detection Response (EDR) tools present on\nhosts before formulating their attack. It is worth noting that operators will leverage OSINT\nmethods and communication with other threat actors to gain information on the AV and EDR\nsystems present in the networks that they are attacking especially if a network has been\npreviously compromised the information obtained from the attack can be shared between\nthreat groups. Once the operators successfully compromise a domain administrator account,\nthey will work to disable AV and EDR services.\n\nSome of the more sophisticated and novel red teaming techniques used to target and bypass\nEDR and protection tools:\n\nHunting for a local IT administrator with access to EDR software and leveraging a\nPowerShell tool \"KeeThief.ps1\" to extract administrator credentials for EDR software\nfrom popular KeePass password manager\n\n_Allows for the extraction of KeePass 2.X key material from memory, as well as the_\n_backdooring and enumeration of the KeePass trigger system._\n\n_Deploying portable Notepad++ version to run PowerShell scripts on the host system_\n_to bypass PowerShell executionrestriction. The portable Notepad++ includes_\nPowerShell version1.\n\n**Host Privilege Escalation**\n\nAdvintel has witnessed two new TTPs relative to Ryuk ransomware campaigns that\norganizations should monitor closely as a means of detecting infections within their domain.\n\n**CVE-2018-8453**\n\nCVE-2018-8453 is an elevation of privilege vulnerability in Windows when the win23k.sys\ncomponent fails to properly handle objects in memory. The exploitation of this vulnerability\nallows an attacker to run an arbitrary kernel with read/write privileges.\n\n**CVE-2019-1069**\n\n\n-----\n\nCVE-2019-1069 is a privilege escalation vulnerability that leverages the way Windows Task\nScheduler handles saved tasks. Task Scheduler stores tasks as files in two locations,\nC:\\Windows\\Tasks and C:\\Windows\\System32\\Tasks. If an RPC client modifies a task using\nthe service in the C:\\Windows\\Tasks location when modifications are saved the task will be\nmigrated to C:\\Windows\\System32\\Tasks. When saving a task file, the Task Scheduler\nservice will set ownership and full control of the file to the owner of the task. This process\nallows an attacker to perpetrate a hard link attack. Therefore, if an attacker manually places\na file within C:\\Windows\\Tasks the attacker will be able to run this file with the highest level of\nprivilege since the Task Scheduler service runs at the maximum level of privilege defined by\nthe local machine.\n\n**Lateral Movement**\n\nRyuk operators demonstrate high levels of sophistication in their abilities to gather\ninformation and move laterally within a network. Specific built-in tools of the Cobalt Strike\ntoolkit have been witnessed being executed by actors including DACheck, and Mimikatz. A\nscript “Invoke-DACheck” has been witnessed being used to identify domain admin accounts\nwithin the network. Actors will also use Mimikatz and LaZagne to collect passwords.\n\nAdvintel has recently witnessed Ryuk actors using CrackMapExec for local admin hunting\nand password extraction. CrackMapExec is a publicly available post-exploitation tool with a\nvariety of enumeration, discovery, and brute force capabilities. It is likely that actors are using\nthis tool to search for local admin accounts and then executing SMB and NTLM relay attack\nfunctions from this tool for authentication.\n\n**Ransomware Deployment**\n\nOnce actors have successfully compromised a local or domain admin account, they\ndistribute the Ryuk payload through Group Policy Objects, PsExec sessions from a domain\ncontroller, or by utilizing a startup item in the SYSVOL share.\n\n**Risk Mitigation Recommendations**\n\nDetections for use of Mimikatz and PsExec execution within the network.\n\nDetections and alerts for the presence of AdFind, Bloodhound, and LaZagne within the\nnetwork.\n\n\n-----\n\nEnsure all operating systems and software are up to date with the latest updates and\nsecurity patches.\n\nImplement multi-factor authentication for RDP access.\n\nImplement network segmentation and controls to scrutinize SMB and NTLM traffic\nwithin the network.\n\nRoutinely review account permissions to prevent privilege creep and maintain principle\nof least privilege.\n\nRoutinely review Group Policy Objects and logon scripts.\n\nUpdate systems to prevent exploitation of CVE-2018-8453 and CVE-2019-1069.\n\n**Conclusion**\n\nRyuk ransomware campaigns continue to evolve their TTPs to avoid detection and navigate\nthroughout a network in 2021. Advintel continues to observe threat actors discussing new\nTTPs amongst themselves and will continue to monitor their communications to provide intel\nto prevent these campaigns from being perpetrated successfully.\n\n**_Vitali Kremez is CEO and Chairman of Advanced Intelligence LLC. Vitali specializes in_**\n_researching and investigating complex cyberattacks, network intrusions, and data breaches._\n_Over his government and private sector career, Kremez has made numerous_\n_groundbreaking findings into Eastern Europe’s cybercrime underworld and has earned_\n_virtually every major certification available in the fields of IT, security, and digital forensics._\n_Advanced Intelligence is an elite threat prevention firm. We provide our customers with_\n_tailored support and access to the proprietary industry-leading “Andariel” Platform to achieve_\n_unmatched visibility into botnet breaches, underground and DarkWeb economy and mitigate_\n_any existing or emerging threats._\n\n**Al Calleo investigates ransomware incidents, data breaches, threat actor infrastructure, and**\nperforms research into emerging threats at Advanced Intelligence, LLC. He possesses a\nBachelor’s in Digital Media Production from SUNY New Paltz and is currently in the process\nof completing a Bachelor’s in Cyber Security and Information Assurance from Western\nGovernor’s University. Al has experience working as a technical engineer for managed\nservice providers. His responsibilities involved system and network administration, incident\n\n\n-----\n\nresponse, and restoration of critical systems as needed to ensure clients maintain business\ncontinuity. He is determined to help defend against the latest threats targeting major\ninfrastructure and institutions.\n\n**_Yelisey Boguslavskiy currently oversees AdvIntel's research and investigative and security_**\n_operations. He leads AdvIntel's Security & Development Team, conducting advanced_\n_HUMINT and SIGINT investigations into cyber fraud, ransomware, APT threats, political_\n_manipulation, and violent extremist propaganda conducted through digital infrastructure._\n_Yelisey is an author of \"Security Pragmatism: The Peripheral Alliance\" – a non-fiction_\n_monograph that follows 30 years of security and intelligence cooperation between Turkey,_\n_Iran, and Israel from 1947 to 1977 and beyond. Prior to Advanced Intelligence LLC, Yelisey_\n_worked as an investigator in the business intelligence community, including Kroll, a division_\n_of Duff & Phelps. He holds an M.A. degree in Security Policy Studies from the Elliott School_\n_of International Affairs of the George Washington University._\n\n**_Advanced Intelligence is an elite threat prevention firm. We provide our customers_**\n**_with tailored support and access to the proprietary industry-leading “Andariel”_**\n**_Platform to achieve unmatched visibility into botnet breaches, underground and dark_**\n**_web economy, and mitigate any existing or emerging threats._**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-17 - Adversary Dossier- Ryuk Ransomware Anatomy of an Attack in 2021.pdf"
    ],
    "report_names": [
        "2021-04-17 - Adversary Dossier- Ryuk Ransomware Anatomy of an Attack in 2021.pdf"
    ],
    "threat_actors": [
        {
            "id": "838f6ced-12a4-4893-991a-36d231d96efd",
            "created_at": "2022-10-25T15:50:23.347455Z",
            "updated_at": "2025-03-27T02:00:55.449316Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "Andariel",
                "Silent Chollima",
                "PLUTONIUM",
                "Onyx Sleet"
            ],
            "source_name": "MITRE:Andariel",
            "tools": [
                "Rifdoor",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "110e7160-a8cc-4a66-8550-f19f7d418117",
            "created_at": "2023-01-06T13:46:38.427592Z",
            "updated_at": "2025-03-27T02:00:02.830659Z",
            "deleted_at": null,
            "main_name": "Silent Chollima",
            "aliases": [
                "Subgroup: Andariel",
                "Onyx Sleet",
                "PLUTONIUM",
                "OperationTroy",
                "Guardian of Peace",
                "GOP",
                "WHOis Team",
                "Andariel"
            ],
            "source_name": "MISPGALAXY:Silent Chollima",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4a502340-ae29-4a3a-8142-7fbbc2ec79b5",
            "created_at": "2024-05-01T02:03:08.138302Z",
            "updated_at": "2025-03-27T02:05:17.416542Z",
            "deleted_at": null,
            "main_name": "NICKEL HYATT",
            "aliases": [
                "Dark Seoul",
                "Jumpy Pisces ",
                "Onyx Sleet ",
                "RIFLE Campaign",
                "Silent Chollima ",
                "Andariel"
            ],
            "source_name": "Secureworks:NICKEL HYATT",
            "tools": [
                " DTrack",
                " Rifle",
                " UnitBot",
                " Valefor",
                "ActiveX 0-day"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d1f8bd4e-bcd4-4101-9158-6158f1806b38",
            "created_at": "2023-01-06T13:46:39.487358Z",
            "updated_at": "2025-03-27T02:00:03.107568Z",
            "deleted_at": null,
            "main_name": "BazarCall",
            "aliases": [
                "BazaCall",
                "BazzarCall"
            ],
            "source_name": "MISPGALAXY:BazarCall",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bc6e3644-3249-44f3-a277-354b7966dd1b",
            "created_at": "2022-10-25T16:07:23.760559Z",
            "updated_at": "2025-03-27T02:02:09.968605Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "APT 45",
                "Andariel",
                "Jumpy Pisces",
                "Onyx Sleet",
                "Operation BLACKMINE",
                "Operation BLACKSHEEP/Phase 3.",
                "Operation Blacksmith",
                "Operation DESERTWOLF/Phase 3",
                "Operation GHOSTRAT",
                "Operation GoldenAxe",
                "Operation INITROY/Phase 1",
                "Operation INITROY/Phase 2",
                "Operation Mayday",
                "Operation VANXATM",
                "Operation XEDA",
                "Plutonium",
                "Silent Chollima",
                "Stonefly"
            ],
            "source_name": "ETDA:Andariel",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535580,
    "ts_updated_at": 1743041749,
    "ts_creation_date": 1653713085,
    "ts_modification_date": 1653713085,
    "files": {
        "pdf": "https://archive.orkl.eu/bca9ef652354ce6cd74d63c0c0ca435f69fe33e5.pdf",
        "text": "https://archive.orkl.eu/bca9ef652354ce6cd74d63c0c0ca435f69fe33e5.txt",
        "img": "https://archive.orkl.eu/bca9ef652354ce6cd74d63c0c0ca435f69fe33e5.jpg"
    }
}