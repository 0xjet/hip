{
    "id": "051ebc63-2301-4a8a-87ed-fbc7f1a076ec",
    "created_at": "2023-01-12T14:59:54.806625Z",
    "updated_at": "2025-03-27T02:05:45.04745Z",
    "deleted_at": null,
    "sha1_hash": "e02ebf855049406cdbc478a8cf4cc506df5a6df3",
    "title": "2017-07-11 - Spam Campaign Delivers Cross-platform Remote Access Trojan Adwind",
    "authors": "",
    "file_creation_date": "2022-05-29T01:33:03Z",
    "file_modification_date": "2022-05-29T01:33:03Z",
    "file_size": 199279,
    "plain_text": "# Spam Campaign Delivers Cross-platform RAT Adwind\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/spam-remote-access-trojan-adwind-jrat](http://blog.trendmicro.com/trendlabs-security-intelligence/spam-remote-access-trojan-adwind-jrat)**\n\nJuly 11, 2017\n\nSpam\n\nAdwind/jRAT resurfaces in another spam campaign. This time, however, it’s mainly targeting\nenterprises in the aerospace industry, with Switzerland, Ukraine, Austria, and the US the\nmost affected countries.\n\nBy: Rubio Wu, Marshall Chen, Ryan Maglaque July 11, 2017 Read time: ( words)\n\nCybercriminals are opportunists. As other operating systems (OS) are more widely used,\n[they, too, would diversify their targets, tools, and techniques in order to cash in on more](https://www.trendmicro.com/vinfo/us/security/research-and-analysis/predictions/2017)\nvictims. That’s the value proposition of malware that can adapt and cross over different\nplatforms. And when combined with a business model that can commercially peddle this\nmalware to other bad guys, the impact becomes more pervasive.\n\nCase in point: Adwind/jRAT, which Trend Micro detects as JAVA_ADWIND. It’s a crossplatform remote access Trojan (RAT) that can be run on any machine installed with Java,\nincluding Windows, Mac OSX, Linux, and Android.\n\n\n-----\n\nUnsurprisingly we saw it resurface in another spam campaign. This time, however, it s mainly\ntargeting enterprises in the aerospace industry, with Switzerland, Ukraine, Austria, and the\nUS the most affected countries.\n\n**Adwind operators are active**\n\nThe spam campaign actually corresponds to our telemetry for JAVA_ADWIND. In fact, the\nmalware has had a steady increase in detections since the start of the year. From a mere\n5,286 in January 2017, it surged to 117,649 in June. It’s notable, too, that JAVA_ADWIND\ndetections from May to June, 2017 increased by 107%, indicating that cybercriminals are\nactively pushing and distributing the malware.\n\nAdwind/jRAT can steal credentials, record and harvest keystrokes, take pictures or\nscreenshots, film and retrieve videos, and exfiltrate data. Adwind iterations were used to\n[target banks and](https://www.theregister.co.uk/2016/02/08/adwind/) [Danish businesses, and even turned infected machines into botnets.](https://www.scmagazineuk.com/adwind-rat-found-in-spam-emails-targeting-danish-companies/article/529351/)\n\nNotorious as a multiplatform do-it-yourself RAT, Adwind has many aliases: jRAT, Universal\n[Remote Control Multi-Platform (UNRECOM), AlienSpy,](http://www.zdnet.com/article/alienspy-rat-strikes-over-400000-victims-worldwide/) [Frutas, and](https://www.helpnetsecurity.com/2013/08/16/cross-platform-frutas-rat-delivered-via-targeted-emails/) [JSocket. In 2014 we](https://arstechnica.com/security/2016/02/java-rat-as-a-service-backdoor-openly-sold-through-website-to-scammers/)\nfound an [Android version of Adwind/jRAT modified to add a cryptocurrency-mining capability.](http://blog.trendmicro.com/trendlabs-security-intelligence/old-java-rat-updates-includes-litecoin-plugin/)\nThe fact that it’s sold as a service means this threat can be deployed by more cybercriminals\nwho can customize their own builds and equip them with diverse functionalities.\n\n_Figure 1: JAVA_ADWIND detections from January to June, 2017_ _Figure 2: Adwind’s_\n_infection chain_\n\n**Spam campaign was deployed in two waves**\n\nThe spam campaign we observed was deployed in two waves and is a classic example of\nsocial engineering. We saw the first on June 7, 2017 using a different URL to divert victims to\ntheir .NET-written malware equipped with spyware capabilities. The second wave was\nobserved on June 14, and used different domains that hosted their malware and command\nand control (C&C) servers. Both waves apparently employed a similar social engineering\ntactic to lure victims into clicking the malicious URLs.\n\nThe spam email’s message impersonates the chair of the Mediterranean Yacht Broker\nAssociation (MYBA) Charter Committee. The spam email’s subject line, “Changes in 2017 –\nMYBA Charter Agreement”, tries to cause a sense of urgency for potential victims. It uses a\nforged sender address, (info[@]myba[.]net) and a seemingly legitimate content to trick\nwould-be victims into clicking the malicious URL.\n\n_Figure 3: Snapshot of the information sent to the C&C server_ _Figure 4: Snapshot of the_\n_spam email_\n\n**Analyzing Adwind’s attack chain**\n\n\n-----\n\nThe malicious URL will drop a Program Information file (PIF). PIFs contain information on\nhow Windows can run MS-DOS applications, and can be launched normally like any\nexecutable (EXE). The file is written in .NET and serves as a downloader. The process\nspawned by the file kicks off the infection chain by first modifying the system certificate.\n\n[The URL we traced the malicious PIF file (TROJ_DLOADR.AUSUDT) to also contained](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/TROJ_DLOADR.AUSUDT)\nvarious phishing and spam email-related HTML files. It’s possible that these are the landing\npages from which victims are diverted to the malicious PIF file.\n\n_Figure 5: The downloader trying to modify the system certificate by calling Windows_\n_Application Programming Interface (API)_\n\n_Figure 6: Snapshot showing a successfully modified certificate_\n\nAfter the certificate has been poisoned, a Java EXE, dynamic-link library (DLL) and 7-Zip\ninstaller will be fetched from a domain that we uncovered to be a file-sharing platform abused\nby the spam operators:\n\nhxxps://nup[.]pw/DJojQE[.]7z\nhxxp://nup[.]pw/e2BXtK[.]exe\nhxxps://nup[.]pw/9aHiCq[.]dll\n\nThe installer has a wrapper function, which are typically employed by RATs to call additional\nroutines without sacrificing computational resources. The wrapper we analyzed was in a\nJava ARchive file format (JAR) that we have dubbed jRAT-wrapper\n[(JAVA_ADWIND.JEJPCO), which will connect to a C&C server and drop the Adwind/jRAT in](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/JAVA_ADWIND.JEJPCO)\nruntime.\n\nBased on jRAT-wrapper’s import header, it appears to have the capability to check for the\ninfected system’s internet access. It can also perform reflection, a dynamic code generation\nin Java. The latter is a particularly useful feature in Java that enables\ndevelopers/programmers to dynamically inspect, call, and instantiate attributes and classes\nat runtime. In cybercriminal hands, it can be abused to evade static analysis from traditional\nantivirus (AV) solutions.\n\n_Figure 7: Code snapshot of the PIF file that downloads a wrapper (jRAT-wrapper), which then_\n_retrieves the payload_\n\n_Figure 8: The domain nup[.]pw is a file-hosting server abused by the spam operators_\n\n_Figure 9: Snapshot of an obfuscated Java class within jRAT-wrapper_\n\n\n-----\n\n_Figure 10: jRAT-wrapper’s import header_\n\n_Figure 11: The byte code we decompiled in jRAT-wrapper_\n\njRAT-wrapper also tries to connect to another C&C IP address, 174[.]127[.]99[.]234:1033,\nwhich we construe to be from a legitimate hosting service that was abused by the attackers.\njRAT-wrapper also uses Visual Basic scripts (VBS) to collect the system’s fingerprints,\nnotably the installed antivirus (AV) product and firewall. It’s also coded to drop and execute\nthe JAR file in the User Temp directory and copy malicious Java libraries to the Application\nData folder. It will then drop a copy of itself in the current user directory and create an\nautorun registry for persistence.\n\nHowever, we found that the IP address was already down during our analysis, preventing us\nfrom getting further information related to this IP address.\n\n_Figure 12: Malicious VBS file that gathers the infected system’s configurations_\n\n_Figure 13: The properties of Adwind/jRAT_\n\n\n-----\n\nSecurity researcher Michael Helwig s [rundown of jRAT-wrapper helped us decrypt the](https://www.codemetrix.net/decrypting-adwind-jrat-jbifrost-trojan/)\nproperties of the payload. The configuration file of the sample we analyzed indicated that the\nnetwork traffic is designed to be hijacked to a proxy listen at the loopback address,\n127[.]0[.]0[.]1:7777.\n\nHowever, we were not able to record any proxy setting during our analysis as the C&C\nserver that the jRAT-wrapper tried to connect to was already inaccessible. We can infer that\nthe attackers intentionally shut down this C&C server. Once attackers successfully\naccomplish what they want in the infected system, they can shut it down to deter further\nanalysis. It’s also possible that the hosting service/ISP actually took it down for abuse.\n\nIn this instance, we can construe that a successful C&C communication entails the C&C\nserver changing the proxy setting to the victims.\n\n_Figure 14: A part of Adwind’s configuration file_\n\n**Countermeasures**\n\nAdwind is a cross-platform, Java-based malware. This calls for a multilayered approach to\nsecurity that covers the [gateway,](http://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) [endpoints,](http://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) [networks,](http://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection.html) [servers, and](http://blog.trendmicro.com/en_us/business/products/hybrid-cloud.html) [mobile devices.](http://blog.trendmicro.com/en_us/business/products/user-protection/sps/mobile.html)\nIT/system administrators and information security professionals, as well as\ndevelopers/programmers that use Java should also adopt best practices for using and\n[securing Java and regularly keep it patched and updated.](http://blog.trendmicro.com/trendlabs-security-intelligence/oracle-improves-java-security-what-it-means-for-end-users/)\n\nAdwind’s main infection vector is spam email. This underscores the importance of securing\nthe email gateway to mitigate threats that use email as an entry point to the system and\n[network. Spam filters, policy management, and email security mechanisms that can](http://blog.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration.html) block\nmalicious URLs are just some of the solutions that can be used to help mitigate email-based\nthreats. Users and IT/system administrators should also adopt best practices to help\n[safeguard networks with bring-your-own device (BYOD) policies from threats like Adwind](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/-infosec-guide-bring-your-own-device-byod)\nthat can steal important data.\n\n[A crucial element in Adwind’s attack chain is social engineering. This highlights the need to](https://www.trendmicro.com/vinfo/us/security/definition/social-engineering)\n[cultivate a cybersecurity-aware workforce and foster conscientiousness against email scams:](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/keep-an-eye-out-for-these-social-engineering-scams)\nthink before you click, be more prudent when opening unknown or unsolicited emails, and be\nmore aware of different social engineering tactics cybercriminals use. These best practices\ncan significantly help reduce an organization’s exposure to these malware.\n\n**Trend Micro Solutions**\n\n[Trend Micro endpoint solutions such as Trend Micro™ Smart Protection Suites and](http://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) WorryFree™ Business Security can protect users and businesses from these threats by detecting\nmalicious files, and spammed messages as well as blocking all related malicious\n\n\n-----\n\nURLs. [Trend Micro Deep Discovery™ has an email inspection layer that can protect](http://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection.html)\nenterprises by detecting malicious attachment and URLs.\n\n[Trend Micro™ Hosted Email Security is a no-maintenance cloud solution that delivers](http://blog.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/email-security.html)\ncontinuously updated protection to stop spam, malware, spear phishing, ransomware, and\nadvanced targeted attacks before they reach the network. It protects Microsoft\nExchange, [Microsoft Office 365, Google Apps, and other hosted and on-premises email](http://blog.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/cloud-app-security.html)\nsolutions.\n\n[Trend Micro™ OfficeScan™ with](http://blog.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html) [XGen™ endpoint security infuses high-fidelity machine](http://www.trendmicro.com/us/business/xgen/index.html)\nlearning with other detection technologies and global threat intelligence for comprehensive\nprotection against advanced malware.\n\n**Indicators of Compromise**\n\n_Files and URLs related to Adwind/jRAT:_\n\nhxxp://ccb-ba[.]adv[.]br/wp-admin/network/ok/index[.]php\nhxxp://www[.]employersfinder[.]com/2017-MYBA-Charter[.]Agreement[.]pif\nhxxps://nup[.]pw/e2BXtK[.]exe\nhxxps://nup[.]pw/Qcaq5e[.]jar\n\n_Related Hashes:_\n\n3fc826ce8eb9e69b3c384b84351b7af63f558f774dc547fccc23d2f9788ebab4\n[(TROJ_DLOADR.AUSUDT)](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/TROJ_DLOADR.AUSUDT)\nc16519f1de64c6768c698de89549804c1223addd88964c57ee036f65d57fd39b\n[(JAVA_ADWIND.JEJPCO)](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/JAVA_ADWIND.JEJPCO)\n97d585b6aff62fb4e43e7e6a5f816dcd7a14be11a88b109a9ba9e8cd4c456eb9\n(JAVA_ADWIND.AUJC)\n705325922cffac1bca8b1854913176f8b2df83a70e0df0c8d683ec56c6632ddb\n(BKDR64_AGENT.TYUCT)\n\n_Related C&C servers:_\n\n174[.]127[.]99[.]234 Port 1033\nhxxp://vacanzaimmobiliare[.]it/testla/WebPanel/post[.]php\n\nTags\n\n[Spam |](http://blog.trendmicro.com/en_us/research.html?category=trend-micro-research:threats/spam) [Endpoints |](http://blog.trendmicro.com/en_us/research.html?category=trend-micro-research:environments/endpoints) [Research](http://blog.trendmicro.com/en_us/research.html?category=trend-micro-research:article-type/research)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-07-11 - Spam Campaign Delivers Cross-platform Remote Access Trojan Adwind.pdf"
    ],
    "report_names": [
        "2017-07-11 - Spam Campaign Delivers Cross-platform Remote Access Trojan Adwind.pdf"
    ],
    "threat_actors": [
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535594,
    "ts_updated_at": 1743041145,
    "ts_creation_date": 1653787983,
    "ts_modification_date": 1653787983,
    "files": {
        "pdf": "https://archive.orkl.eu/e02ebf855049406cdbc478a8cf4cc506df5a6df3.pdf",
        "text": "https://archive.orkl.eu/e02ebf855049406cdbc478a8cf4cc506df5a6df3.txt",
        "img": "https://archive.orkl.eu/e02ebf855049406cdbc478a8cf4cc506df5a6df3.jpg"
    }
}