{
    "id": "c4ba807f-b488-4d17-9458-50e585454c93",
    "created_at": "2023-01-12T14:59:20.271913Z",
    "updated_at": "2025-03-27T02:10:05.182062Z",
    "deleted_at": null,
    "sha1_hash": "d6eaa0118fd5163981835d2bce64d096ea04d182",
    "title": "2016-08-04 - Iranian Actor -Group5- Targeting Syrian Opposition",
    "authors": "",
    "file_creation_date": "2019-09-04T10:37:23Z",
    "file_modification_date": "2019-09-04T10:37:23Z",
    "file_size": 458459,
    "plain_text": "# Lesson Learned \n## Risks Posed by Firewall Firmware Vulnerabilities\n\n**Primary Interest Groups**\nTransmission Operators (TOPs)\nTransmission Owners (TOs)\nGeneration Operators (GOPs)\nGeneration Owners (GOs)\nDistribution Providers (DPs)\nReliability Coordinators (RCs)\nBalancing Authorities (BAs)\n\n**Problem Statement**\nA vulnerability in the web interface of a vendor’s firewall was exploited, allowing an unauthenticated\nattacker to cause unexpected reboots of the devices. This resulted in a denial of service (DoS)[1] condition at\na low-impact control center and multiple remote low-impact generation sites. These unexpected reboots\nresulted in brief communications outages (i.e., less than five minutes) between field devices at sites and\nbetween the sites and the control center.\n\n**Details**\nA registered entity with a low-impact control center experienced brief (i.e., less than five minutes) outages\nof internet-facing firewalls that controlled communications between the control center and multiple\nremote generation sites and between equipment on these sites. The affected firewalls were all perimeter\ndevices that served as the outer security layer. These outages had no impact to generation. Seeing several\nof these outages at different sites raised suspicion and led to a more in-depth investigation. This\ninvestigation revealed that the communications outages were due to reboots of the firewalls at each of the\nsites. The entity’s system monitoring tools also provided notification of the firewall reboots. These records\nshow the firewall reboots occurred over a 10-hour time period with each firewall showing offline status for\nless than five minutes.\n\nAfter an initial internal investigation, the entity decided that, in order to fully characterize the nature of the\nreboots and the potential causes, the firewall manufacturer should review logs. Subsequent analysis\ndetermined that the reboots were initiated by an external entity exploiting a known firewall vulnerability.\nAfter receiving this notification, the entity initiated their event reporting procedure as dictated by their\ncybersecurity incident response plan. Along with identifying the cause of the reboots, the firewall\nmanufacturer offered a firmware update that would address the vulnerability. The entity assessed the\nupdate details and determined it was appropriate to deploy immediately. The entity first deployed the\n\n[1 See previous NERC Lessons Learned LL20181001, “Networking Packet Broadcast Storms” for a discussion of a self-inflicted problem having](https://www.nerc.com/pa/rrm/ea/Lessons%20Learned%20Document%20Library/LL20181001_Networking_Packet_Broadcast_Storms.pdf)\nsimilar symptoms to a DoS attack.\n\n\n# Lesson Learned \n## Risks Posed by Firewall Firmware Vulnerabilities\n\n**Primary Interest Groups**\nTransmission Operators (TOPs)\nTransmission Owners (TOs)\nGeneration Operators (GOPs)\nGeneration Owners (GOs)\nDistribution Providers (DPs)\nReliability Coordinators (RCs)\nBalancing Authorities (BAs)\n\n**Problem Statement**\nA vulnerability in the web interface of a vendor’s firewall was exploited, allowing an unauthenticated\nattacker to cause unexpected reboots of the devices. This resulted in a denial of service (DoS)[1] condition at\n\n\n-----\n\nfirmware patch on a firewall within a non-critical environment[2] at the entity’s control center that would not\nimpact operational assets and monitored the changes for any adverse effects. After seeing no adverse\neffects, the entity deployed the firmware patch at an operational generation site that night. After\nmonitoring traffic in the production environment overnight and early the following morning, the entity\ndeployed the update to all remaining BES assets that had common hardware with the firmware\nvulnerability.\n\n**Corrective Actions**\nAfter completing mitigation efforts to address the immediate risk posed by the firmware vulnerability, the\nentity performed an internal assessment to identify internal process improvements to reduce the likelihood\nof an event with a similar cause from happening again. Given that a firmware update to address the\nexploited vulnerability had been released prior to the event, the entity’s process for assessing and\nimplementing firmware updates was reviewed. Based on this review, the entity decided to implement a\nmore formal and more frequent review of vendor firmware updates that would be tracked within internal\ncompliance tracking software. It should be noted that the entity was already working to develop internal\nprocedures to support this process; however, these were not completed or being practiced at the time of\nthe event. Additionally, the entity now utilizes firewall rules that restrict allowable traffic to the minimum\nrequired to operate the assets.\n\n**Lesson Learned**\nEven in cases involving low-Impact BES assets, an entity should strive for good cyber security policies and\nprocedures. Consider some of the following lessons:\n\n  - Follow good industry practices for vulnerability and patch management.\n\n    - Close monitoring of vendor firmware releases and their implementation is a key element of a\n\nstrong cybersecurity posture. Firewall firmware updates need to be reviewed as quickly as\npossible after release for risk and applicability.\n\n    - Testing in a development (or “sandbox”) environment prior to deployment is the best way to\n\ncheck for the patch’s potential to introduce new problems.\n\n  - Reduce and control your attack surface.\n\n    - Have as few internet facing devices as possible.\n\n  - Use virtual private networks.\n\n  - Use access control lists (ACLs) to filter inbound traffic prior to handling by the firewall; minimize\n\nthe traffic through a denial by default configuration with whitelisting for the allowed and expected\nIP addresses. Limit outbound traffic similarly for information security purposes.\n\n2 Even in an emergency, still test before applying patches to control systems to ensure no adverse effects upon patch implementation,\npreferably testing in a development environment. If that is not possible, then test in a less critical part of the environment as was done in this\ncase. Also, when designing the network, include the ability to perform maintenance on VPN terminators without having to take down the\nedge firewall because if it is hard or expensive to do, the chances it won’t be completed increase.\n\n\n-----\n\n  - Layer defenses. It is harder to penetrate a screening router, a virtual private network terminator,\n\nand a firewall in series than just a firewall (assuming the ACLs and other configurations are\nappropriate).\n\n  - Segment your network. Restrict lateral communication to necessary and expected traffic to reduce\n\nthe impact of a breach.\n\n  - Know your exploitable vulnerabilities so you can pursue fixes.\n\n    - Maintain awareness of vulnerabilities and understanding of those in your environment through\n\n[product vendor websites and user groups and third party resources, such as the National](https://nvd.nist.gov/)\n[Vulnerability Database[3], SANS Internet Storm Center[4], Exploit Database[5], etc.](https://nvd.nist.gov/)\n\n    - [Consider asking the Department of Homeland Security under the “National Cybersecurity](https://www.us-cert.gov/resources/ncats)\n\n[Assessment and Technical Services (NCATS) program[6]” (or a security vendor) to conduct](https://www.us-cert.gov/resources/ncats)\nexternal vulnerability scanning.\n\n    - [Join the Electricity Information Sharing and Analysis Center (E-ISAC)[7].](https://www.nerc.com/pa/CI/ESISAC/Pages/default.aspx)\n\n  - Monitor your network.\n\n    - System performance monitoring increases the likelihood that brief communications outages\n\nwith little actual impact to generator operations will be more closely investigated. This is how\nthis lesson learned came to be.\n\n    - Use tools for firewall log analysis to detect events and support post-event investigations. This\n\nwill provide information about the nature of attacks and exploits used.\n\n    - Report attacks and suspicious activity to the E-ISAC.\n\n  - Employ redundant solutions to provide resilience and on-line maintenance capabilities:\n\n    - Of the entity’s sites impacted by the firewall reboot, not all experienced communications\n\ndisruptions. Following the event, it was discovered that the sites running firewalls in highavailability/redundant pair configuration maintained communications during the reboots. At\nsites utilizing this design, the secondary firewall maintained communications while the primary\nfirewall rebooted.\n\n    - Firewall redundancy preserves functionality in the event of a single firewall failure.\n\n    - Firewall redundancy reduces impact of firmware updates since each firewall can be updated\n\nindependently without interrupting communications during the update process.\n\nNERC’s goal with publishing lessons learned is to provide industry with technical and understandable\ninformation that assists them with maintaining the reliability of the bulk power system. NERC is asking\n\n[3 National Vulnerability Database https://nvd.nist.gov/](https://nvd.nist.gov/)\n[4 SANS Internet Storm Center https://isc.sans.edu/](https://isc.sans.edu/)\n[5 Exploit Database https://www.exploit.db.com/](https://www.exploit.db.com/)\n[6 National Cybersecurity Assessment and Technical Services https://www.us-cert.gov/resources/ncats](https://www.us-cert.gov/resources/ncats)\n[7 Electricity Information Sharing and Analysis Center https://www.nerc.com/pa/CI/ESISAC/Pages/default.aspx](https://www.nerc.com/pa/CI/ESISAC/Pages/default.aspx)\n\n\n-----\n\nentities who have taken action on this lesson learned to respond to the short survey provided in the link\nbelow.\n\n**Click here for:** [Lesson Learned Comment Form](https://www.surveymonkey.com/r/ll20190901)\n\n**For more Information please contact:**\n\n[NERC – Lessons Learned](mailto:NERC.LessonsLearned@nerc.net) (via email) [WECC Event Analysis](mailto:operations@wecc.org)\n\nSource of Lesson Learned: Western Electric Coordinating Council\n\nLesson Learned #: 20190901\n\nDate Published: September 4, 2019\n\nCategory: Communications\n\n_This document is designed to convey lessons learned from NERC’s various activities. It is not intended to establish new requirements under_\n_NERC’s Reliability Standards or to modify the requirements in any existing Reliability Standards. Compliance will continue to be determined based_\n_on language in the NERC Reliability Standards as they may be amended from time to time. Implementation of this lesson learned is not a_\n_substitute for compliance with requirements in NERC’s Reliability Standards._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/ICS SCADA/ICS Vulnerabilities/Lesson Learned - Risks Posed by Firewall Firmware Vulnerabilities.pdf"
    ],
    "report_names": [
        "Lesson Learned - Risks Posed by Firewall Firmware Vulnerabilities.pdf"
    ],
    "threat_actors": [
        {
            "id": "cf0704ab-99e4-44d7-96d9-3cba91339229",
            "created_at": "2022-10-25T15:50:23.485375Z",
            "updated_at": "2025-03-27T02:00:55.482473Z",
            "deleted_at": null,
            "main_name": "Group5",
            "aliases": [
                "Group5"
            ],
            "source_name": "MITRE:Group5",
            "tools": [
                "njRAT",
                "NanoCore"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9aa9b489-a297-4dbd-8601-8fc0370201a6",
            "created_at": "2022-10-25T16:07:23.696796Z",
            "updated_at": "2025-03-27T02:02:09.928416Z",
            "deleted_at": null,
            "main_name": "Group5",
            "aliases": [],
            "source_name": "ETDA:Group5",
            "tools": [
                "Atros2.CKPN",
                "Bladabindi",
                "DroidJack",
                "Jorik",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "Zurten",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "094d8210-4c64-4457-ad97-a94fc7af7630",
            "created_at": "2023-01-06T13:46:38.98103Z",
            "updated_at": "2025-03-27T02:00:02.968603Z",
            "deleted_at": null,
            "main_name": "Group5",
            "aliases": [
                "G0043"
            ],
            "source_name": "MISPGALAXY:Group5",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535560,
    "ts_updated_at": 1743041405,
    "ts_creation_date": 1567593443,
    "ts_modification_date": 1567593443,
    "files": {
        "pdf": "https://archive.orkl.eu/d6eaa0118fd5163981835d2bce64d096ea04d182.pdf",
        "text": "https://archive.orkl.eu/d6eaa0118fd5163981835d2bce64d096ea04d182.txt",
        "img": "https://archive.orkl.eu/d6eaa0118fd5163981835d2bce64d096ea04d182.jpg"
    }
}