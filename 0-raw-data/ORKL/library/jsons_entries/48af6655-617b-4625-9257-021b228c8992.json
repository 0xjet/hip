{
    "id": "48af6655-617b-4625-9257-021b228c8992",
    "created_at": "2023-01-12T15:06:34.791571Z",
    "updated_at": "2025-03-27T02:06:14.468627Z",
    "deleted_at": null,
    "sha1_hash": "5b7a863f434f96a01176a780c2f365a0e322b454",
    "title": "2022-04-13 - Fodcha, a new DDos botnet",
    "authors": "",
    "file_creation_date": "2022-05-29T01:21:30Z",
    "file_modification_date": "2022-05-29T01:21:30Z",
    "file_size": 1170967,
    "plain_text": "# Fodcha, a new DDos botnet\n\n**blog.netlab.360.com/fodcha-a-new-ddos-botnet/**\n\nHui Wang April 13, 2022\n\n13 April 2022 / [Botnet](https://blog.netlab.360.com/tag/botnet/)\n\n## Overview\n\nRecently, CNCERT and 360netlab worked together and discovered a rapidly spreading\nDDoS botnet on the Internet. The global infection looks fairly big as just in China there are\nmore than 10,000 daily active bots (IPs) and alsomore than 100 DDoS victims beingtargeted\non a daily basis. We named the botnet Fodcha because of its initial use of the C2 domain\nname folded.in and its use of the chacha algorithm to encrypt network traffic.\n\n## Botnet size\n\nFrom March 29 to April 10, 2022, the total number of unique Fodcha bots(IPs) has exceeded\n62,000, and daily numbers fluctuate around 10,000. A daily breakdown is shown below.\n\nNetlab note:\n\nBased on direct data from the security community that we worked with, the number of\ndaily live bots are more than 56000.\n\n\n-----\n\nWhen we look at the domestic data, the top provinces that the bots are coming from are the\nShandong Province (12.9%), the Liaoning Province (11.8%) and the Zhejiang Province\n(9.9%).The service providers that these bots originate from are China Unicom(59.9%), China\nTelecom(39.4%), and China Mobile(0.5%).\n\n## Spread method\n\n\n-----\n\nFodcha is mainly spreading through the following NDay vulnerabilities and Telnet/SSH weak\npasswords.\n\nNetlab note:\nWe observed that a brute-force cracking tool we named Crazyfia appears on the same\ndownloader server of FodchaThe scan results of this tool will be used by the Fodcha\nauthor to install Fodcha samples on the vulnerable devices.\n\nList of main vulnerabilities:\n\n**Vulnerability** **Affected Device/Service**\n\n[Android ADB Debug Server RCE](https://www.exploit-db.com/exploits/39328) Android\n\n[CVE-2021-22205](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-22205) GitLab\n\n[CVE-2021-35394](https://nvd.nist.gov/vuln/detail/CVE-2021-35394) Realtek Jungle SDK\n\n[JAWS Webserver unauthenticated shell command execution](https://www.exploit-db.com/exploits/41471/) MVPower DVR\n\n[LILIN DVR RCE](https://blog.netlab.360.com/multiple-botnets-are-spreading-using-lilin-dvr-0-day/) LILIN DVR\n\n[TOTOLINK Routers Backdoor](https://www.exploit-db.com/exploits/37770) TOTOLINK Routers\n\n[ZHONE Router Web RCE](https://www.exploit-db.com/exploits/38453) ZHONE Router\n\n\n-----\n\n## Sample Analysis\n\nThe Fodcha botnet includes samples targeting mips, mpsl, arm, x86, and other CPU\narchitectures. In the past 3 months, the Fodcha samples we captured can be divided into two\nversions, v1 and v2. Their main functions are almost the same. By cross-referencing the\ndifferent versions, we can tell that the Fodcha operators are really trying to hide their C2s\nand load-balance among the C2s.\n\n\n**MAPPING(Domain<-**\n**->IP)**\n\n\n**MAPPING(IP<-**\n**->PORT )**\n\n\n**Version** **Chacha20**\n\n\n**C2**\n**Format** **C2**\n\n\nv1 yes plaintext folded.in 1:N N:1\n\nv2 yes ciphertext fridgexperts.cc 1:N N:10\n\nThe latest sample of V2 X86 CPU architecture is selected as the main object of analysis in\nthis paper, and its basic information is as follows.\n```\n8ea56a9fa9b11b15443b369f49fa9719\nELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, stripped\nPacker:None\n\n```\nFodcha's function is simple. When it executes on the compromised device, it first checks the\nruntime parameters. When there are no parameters, it exits out. Fodcha does this as a\nsimple countermeasure to deter sandbox. When parameters are present, it first decrypts the\nkey configurations data, the data include some sensitive information such as C2s will It then\nprints “here we are” on the Console, and uses a random string to disguise the process name.\nFinally communication with the C2 will be established. The following section will focus on\nFodcha's decryption method and network communication.\n\n**Decrypting key configurations**\n\nFodcha uses a multiple-Xor encryption method to protect its key configurations such as C2\ndata.\n\n\n-----\n\nThe corresponding python implementation is shown below, taking the ciphertext `EB D3 EB`\n```\nC9 C2 EF F6 FD FD FC FB F1 A3 FB E9 in the sample as an example. After decryption,\n\n```\nwe will get the Fodcha's C2: fridgexperts.cc.\n\n\n-----\n\n```\ncipher [ 0xEB, 0xD3, 0xEB, 0xC9, 0xC2, 0xEF, 0xF6, 0xFD, 0xFD, 0xFC, \n 0xFB, 0xF1, 0xA3, 0xFB, 0xE9]\nkey=[0x66, 0x4A, 0x69, 0x46, 0x4E, 0x61, 0x65, 0x66, 0x73, 0x65, \n 0x64, 0x69, 0x66, 0x73, 0x61, 0x69, 0x66, 0x73, 0x69,00]\ntmp=[]\nfor i in range(len(cipher)):\n  tmp.append((cipher[i] ^ key[i])%0xff^0xbe)\nfor i in range(len(tmp)):\n  for j in key:\n    tmp[i]^=j\nout=''.join([chr(i) for i in tmp])\nprint out\n\n```\n**Network communication**\n\nFodcha establishes a connection with C2 through the following code fragment where the\nDNS A record IP of the C2 domain corresponds to the PORT of N:10.\n\n\n-----\n\nOnce the connection is successfully established with C2, the Bot must go through 5 rounds\nof interaction with C2 before it can actually communicate with C2. We use arm as the packet\nstring, which generates the network traffic shown in the following figure.\n\nLet us elaborate on how this traffic is generated:\n\nStep 1: Bot-->C2 (fixed length 5 bytes)\n\nThe hard-coded `ee 00 00 is calculated by the tcp/ip checksum method to get the 2-byte`\nchecksum value 0xff11, which is filled to the last 2 bytes.\n```\ndef checksum(data):\n s = 0\n n = len(data) % 2\n for i in range(0, len(data)-n, 2):\n  s+= ord(data[i]) + (ord(data[i+1]) << 8)\n if n:\n  s+= ord(data[i+1])\n while (s >> 16):\n  s = (s & 0xFFFF) + (s >> 16)\n s = ~s & 0xffff\n return s\n\n```\nStep 2: C2-->BOT (2 times, the first 32 bytes; the second 12 bytes)\n\nNote that the key and nonce are generated by the C2 side, not fixed.\n```\n32 bytes at the beginning is chacha20 key:\n26 14 2d 4d 58 d2 9e 26 67 98 bc e4 ef 69 b9 04\ne6 d0 73 17 5c 4f 71 33 9f 97 18 f7 31 8d d4 d6\n12 bytes at the last is chacha20 nonce:\n2f 8a 5c da 57 50 a6 64 d7 98 f5 5d\n\n```\nStep 3: BOT-->C2 (fixed length 5 bytes)\n\nHard-coded `55 00 00 by checksum, calculate the checksum value 0xffaa, fill in the last 2`\nbytes, become `55 00 00 aa ff, then use chacha20 algorithm to encrypt, the number of`\nrounds is 1, get `99 9e 95 f6 32 .`\n\nStep 4: C2-->BOT(fixed length 5 bytes)\n\n\n-----\n\nAt this point, if the format of the 5 bytes received is `0x55 at the beginning and the last 2`\nbytes are the checksum value, it means the previous interaction is right, enter Step 5 and\nask BOT to start sending packet information.\n\nStep 5: Bot--->C2 (2 times, the first 5 bytes, the second grouping)\n\nFirst time\nHard-coded `fe 00 00, the third byte is really the grouping length, becomes` `fe 00`\n```\n   03, calculate the checksum value 0xfefe, fill in the tail to get fe 00 03 fe fe\n\n```\nSecond time\ngrouping string `arm, use chacha20 encryption, round number 1, get` `ad ec f8`\n\nAt this point the BOT is successfully registered and waits to execute the instruction issued by\nC2. The instruction code and its meaning are shown below:\n\n- 0x69, Heartbeat\n\n- 0xEB, DDoS Attack\n\n- 0xFB, Exit\n\n## C2 Tracking\n\nOur botnet tracking system data shows that Fodcha has been launching DDoS attacks non\nstop since it came online, with the following trends in attack targets.\n\n\n-----\n\nAs you can see, the DDoS behavior of this family is very active:\n\nThe most active attack time was on 2022-03-01, with over 130k attacking commands\nbeing recorded.\nIn the recent week, the average daily attack command has exceeded 7k, targeting\n100+ DDoS victims.\n\nAt the same time, we can also clearly see from the DNS perspective that the C2 domain of\nthis family made a turnover around 2022-03-19, corresponding to the shift from v1 to v2 in\nthe aforementioned sample analysis section.\n\n\n-----\n\nNetlab note:\n\nThe shift from v1 to v2 is due to the fact that the C2 servers corresponding to the v1\nversion were shutdown by a their cloud vendor, so Fodcha's operators had no choice\nbut to re-launch v2 and update C2. The new C2 is mapped to more than a dozen IPs\nand is distributed across multiple countries including the US, Korea, Japan, and India,\nit involves more cloud providers such as Amazon, DediPath, DigitalOcean, Linode, and\nmany others.\n\n## IoC\n\n**Sample Hash(md5)**\n\n\n-----\n\n```\n0e3ff1a19fcd087138ec85d5dba59715\n1b637faa5e424966393928cd6df31849\n208e72261e10672caa60070c770644ba\n2251cf2ed00229c8804fc91868b3c1cb\n2a02e6502db381fa4d4aeb356633af73\n2ed0c36ebbeddb65015d01e6244a2846\n2fe2deeb66e1a08ea18dab520988d9e4\n37adb95cbe4875a9f072ff7f2ee4d4ae\n3fc8ae41752c7715f7550dabda0eb3ba\n40f53c47d360c1c773338ef5c42332f8\n4635112e2dfe5068a4fe1ebb1c5c8771\n525670acfd097fa0762262d9298c3b3b\n54e4334baa01289fa4ee966a806ef7f1\n5567bebd550f26f0a6df17b95507ca6d\n5bdb128072c02f52153eaeea6899a5b1\n6244e9da30a69997cf2e61d8391976d9\n65dd4b23518cba77caab3e8170af8001\n6788598e9c37d79fd02b7c570141ddcf\n760b2c21c40e33599b0a10cf0958cfd4\n792fdd3b9f0360b2bbee5864845c324c\n7a6ebf1567de7e432f09f53ad14d7bc5\n9413d6d7b875f071314e8acae2f7e390\n954879959743a7c63784d1204efc7ed3\n977b4f1a153e7943c4db6e5a3bf40345\n9defda7768d2d806b06775c5768428c4\n9dfa80650f974dffe2bda3ff8495b394\na996e86b511037713a1be09ee7af7490\nb11d8e45f7888ce85a67f98ed7f2cd89\nb1776a09d5490702c12d85ab6c6186cd\nb774ad07f0384c61f96a7897e87f96c0\nc99db0e8c3ecab4dd7f13f3946374720\nc9cbf28561272c705c5a6b44897757ca\ncbdb65e4765fbd7bcae93b393698724c\nd9c240dbed6dfc584a20246e8a79bdae\ne372e5ca89dbb7b5c1f9f58fe68a8fc7\nebf81131188e3454fe066380fa469d22\nfe58b08ea78f3e6b1f59e5fe40447b11\n\n```\n**Download Links**\n\n\n-----\n\n```\nhttp://139.177.195.192/bins/arm\nhttp://139.177.195.192/bins/arm5\nhttp://139.177.195.192/bins/arm7\nhttp://139.177.195.192/bins/mips\nhttp://139.177.195.192/bins/realtek.mips\nhttp://139.177.195.192/blah\nhttp://139.177.195.192/linnn\nhttp://139.177.195.192/skidrt\nhttp://139.177.195.192/z.sh\nhttp://162.33.179.171/bins/arm\nhttp://162.33.179.171/bins/arm7\nhttp://162.33.179.171/bins/mpsl\nhttp://162.33.179.171/bins/realtek.mips\nhttp://162.33.179.171/bins/realtek.mpsl\nhttp://162.33.179.171/blah\nhttp://162.33.179.171/k.sh\nhttp://162.33.179.171/linnn\nhttp://162.33.179.171/z.sh\nhttp://206.188.197.104/bins/arm7\nhttp://206.188.197.104/bins/realtek.mips\nhttp://206.188.197.104/skidrt\nhttp://31.214.245.253/bins/arm\nhttp://31.214.245.253/bins/arm7\nhttp://31.214.245.253/bins/mips\nhttp://31.214.245.253/bins/mpsl\nhttp://31.214.245.253/bins/x86\nhttp://31.214.245.253/k.sh\nhttp://31.214.245.253/kk.sh\n\n```\n**C2 domain**\n```\nfolded.in\nfridgexperts.cc\n\n## Contact us\n\n```\nReaders are always welcomed to reach us on Twitter or email us to netlab at 360 dot cn.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-13 - Fodcha, a new DDos botnet.pdf"
    ],
    "report_names": [
        "2022-04-13 - Fodcha, a new DDos botnet.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535994,
    "ts_updated_at": 1743041174,
    "ts_creation_date": 1653787290,
    "ts_modification_date": 1653787290,
    "files": {
        "pdf": "https://archive.orkl.eu/5b7a863f434f96a01176a780c2f365a0e322b454.pdf",
        "text": "https://archive.orkl.eu/5b7a863f434f96a01176a780c2f365a0e322b454.txt",
        "img": "https://archive.orkl.eu/5b7a863f434f96a01176a780c2f365a0e322b454.jpg"
    }
}