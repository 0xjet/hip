{
    "id": "dbb03ff4-3f8c-409b-9d8f-2a534638019f",
    "created_at": "2023-01-12T14:59:13.974574Z",
    "updated_at": "2025-03-27T02:13:34.78542Z",
    "deleted_at": null,
    "sha1_hash": "88e2c87059c05efd54e7dcab0722ffb2d191a9e9",
    "title": "2022-09-01 - PyPI Phishing Campaign - JuiceLedger Threat Actor Pivots From Fake Apps to Supply Chain Attacks",
    "authors": "",
    "file_creation_date": "2022-09-12T12:00:49Z",
    "file_modification_date": "2022-09-12T12:00:49Z",
    "file_size": 1082222,
    "plain_text": "# PyPI Phishing Campaign | JuiceLedger Threat Actor Pivots From Fake Apps to Supply Chain Attacks\n\n**[sentinelone.com/labs/pypi-phishing-campaign-juiceledger-threat-actor-pivots-from-fake-apps-to-supply-chain-attacks/](https://www.sentinelone.com/labs/pypi-phishing-campaign-juiceledger-threat-actor-pivots-from-fake-apps-to-supply-chain-attacks/)**\n\nAmitai Ben Shushan Ehrlich\n\n## Executive Summary\n\nJuiceLedger is a relativey new threat actor focused on infostealing through a .NET\nassembly called ‘JuiceStealer’\nJuiceLedger has rapidly evolved its attack chain from fraudulent applications to supply\nchain attacks in little over 6 months\nIn August, JuiceLedger conducted a phishing campaign against PyPI contributors and\nsuccessfully compromised a number of legitimate packages\nHundreds of typosquatting packages delivering JuiceStealer malware have been\nidentified\nAt least two packages with combined downloads of almost 700,000 were compromised\nPyPI says that known malicious packages and typosquats have now been removed or\ntaken down\n\n## Overview\n\n[SentinelLabs, in collaboration with Checkmarx, has been tracking the activity and evolution](https://checkmarx.com/blog/first-known-phishing-attack-against-pypi-users/)\nof a threat actor dubbed “JuiceLedger”. In early 2022, JuiceLedger began running relatively\nlow-key campaigns, spreading fraudulent Python installer applications with ‘JuiceStealer’, a\n\n\n-----\n\n```\n.NET application designed to steal sensitive data from victims browsers. In August 2022,\n\n```\nthe threat actor engaged in poisoning open-source packages as a way to target a wider\naudience with the infostealer through a supply chain attack, raising the threat level posed by\nthis group considerably.\n\nJuiceLedger operators have actively targeted PyPi package contributors in a phishing\ncampaign, successfully poisoning at least two legitimate packages with malware. Several\nhundred more malicious packages are known to have been typosquatted.\n\nIn this post, we detail the evolution of JuiceLedger, describe the group’s attack vectors and\nactivity, and provide an analysis of the JuiceStealer payload.\n\n## Dual Pronged Attack – Fake Apps and Supply Chain Attacks\n\n[The supply chain attack on PyPi package contributors appears to be an escalation of a](https://twitter.com/pypi/status/1562442188285308929)\ncampaign begun earlier in the year which initially targeted potential victims through fake\ncryptocurrency trading applications, among them a bot the threat actors marketed as an “AI\nCrypto trading bot” named “The Tesla Trading bot”.\n\nThe attack on PyPI in August involves a far more complex attack chain, including phishing\nemails to PyPI developers, typosquatting, and malicious packages intended to infect\ndownstream users with the JuiceStealer malware. This vector seems to be utilized in parallel\n\n\n-----\n\nto the earlier JuiceLedger infection method, as similar payloads were delivered around the\nsame time through fake cryptocurrency ledger websites.\n\n## Targeting PyPI Contributors\n\n[On August 24, 2022, PyPi published details of an ongoing phishing campaign targeting PyPi](https://twitter.com/pypi/status/1562442188285308929)\nusers. According to their report, this is the first known phishing attack against PyPI. The\nphishing email states that a mandatory ‘validation’ process requires the contributor to\nvalidate their package or risk having it removed from PyPI.\n\nExample of a phishing email sent to PyPI contributors. Source: PyPI via Twitter\nThe phishing emails point victims to a Google site’s landing page mimicking the PyPI login\npage. The credentials provided there were sent to a known JuiceLedger domain:\n```\nlinkedopports[.]com .\n\n```\n\n-----\n\n[PyPi Phishing site.Source: PyPI via Twitter](https://twitter.com/pypi/status/1562442199811309568?s=20&t=cG3jJe6qSl2DOOfCWVq6Qg)\nSome of those phishing attacks appear to have been successful, leading to the compromise\nof legitimate code packages whose contributors credentials were compromised.\n\nPyPI also reported that they had found a number of typosquatting packages that conformed\nto a similar pattern; JuiceLedger has also used typosquatting to deliver its malicious\napplications.\n\nTyposquatting popular code packages is nothing new. Reports of similar attacks have\n[emerged during the last few years, including the CrateDepression campaign targeting Rust](https://www.sentinelone.com/labs/cratedepression-rust-supply-chain-attack-infects-cloud-ci-pipelines-with-go-malware/)\ndevelopers and recently reported by SentinelLabs.\n\nCompromised packages uploaded by JuiceLedger in the August campaign contain a short\ncode snippet, responsible for downloading and executing a signed variant of JuiceStealer.\nThe malicious code added is depicted below.\n\n\n-----\n\n[Malicious code snippet. Source: Checkmarx](https://checkmarx.com/blog/first-known-phishing-attack-against-pypi-users/)\nThe code snippet added to those packages is quite similar to the ones added in the\ntyposquatting packages. According to PyPI, the malicious code snippets were found on the\nfollowing packages:\n```\n exotel==0.1.6\n\n spam==2.0.2 and ==4.0.2\n\n\n```\nA look at the code snippet from compromised packages suggests that the actors added an\nindication of the compromised package in the registration URL.\n\n[A snippet from exotel poisoned code. Source: PyPi via Twitter](https://twitter.com/pypi/status/1562442207079976966?s=20&t=cG3jJe6qSl2DOOfCWVq6Qg)\n\n\n-----\n\nJuiceLedger s August campaign also contained a Ledger-themed fraudulent application.\nUsers of Ledger, a hardware “cold storage” wallet technology for crypto assets, have been\ntargeted with a digitally-signed version of JuiceStealer embedded in fake Ledger installation\npacks.\n\nCertificate used to\n\nsign JuiceStealer malware\nThe certificate `13CFDF20DFA846C94358DBAC6A3802DC0671EAB2 was used to sign a total of`\nfour samples, one of which appears to be unrelated, although all are malicious.\n\n## Analysis of JuiceStealer Malware\n\nJuiceLedger’s infostealer, dubbed JuiceStealer, is a relatively simple `.NET application,`\ninternally named “meta”. First indications of the stealer started emerging in February this\nyear. Over several iterations, the infostealer was embedded in a number of fraudulent\napplications and installers.\n\n### Python Installers\n\nThe first version of JuiceStealer ( d249f19db3fe6ea4439f095bfe7aafd5a0a5d4d2 ),\nuploaded to VirusTotal on February 13, appears to be incomplete and may be a test\nsubmitted by the developers. It is the first in a set of variants mimicking Python installers.\n\n\n-----\n\nThis sample iterates over processes containing the word chrome, shuts them down and\nthen searches for Google Chrome Extension log files. The infostealer iterates over logs that\ncontain the word “vault”, possibly searching for cryptocurrency vaults, and reports back to an\nembedded C2 server over HTTP.\n```\nprivate static void Main(string[] args)\n\n{\n\n Console.WriteLine(\"Please wait while Python installs...\");\n\n string[] directories = Directory.GetDirectories(\"C:\\\\Users\\\\\" +\nEnvironment.UserName + \"\\\\AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\");\n\n foreach (Process process in Process.GetProcessesByName(\"chrome\"))\n\n process.Kill();\n\n Thread.Sleep(2500);\n\n Console.WriteLine(\"Python is almost ready...\");\n\n\n```\nA fully fledged version of the fraudulent installer was submitted a few days later as part of a\nzip file named “python-v23.zip” ( 1a7464489568003173cd048a3bad41ca32dbf94f ),\ncontaining a newer version of the infostealer, a legitimate Python installer and an instruction\nfile, “INSTRUCTIONS.exe”.\n\nFake Python installer instructions file\nThis version of the infostealer introduces a new class, named ‘Juice’ (hence the name), and\nalso searches for Google Chrome passwords, querying Chrome SQLite files. It also launches\na Python installer contained in the zip named “config.exe”. Naming legitimate software\n“config.exe” appears to be common in various JuiceStealer variants.\n\nLike many of the JuiceStealer samples we analyzed, it was compiled as a self-contained\n```\n.NET app. This makes the files significantly larger.\n\n```\nA `pdb path common to many earlier versions of the JuiceStealer contains the user name`\n“reece” and internal project name “meta”.\n```\nC:\\Users\\reece\\source\\repos\\meta\\meta\\obj\\Release\\netcoreapp3.1\\win-x86\\meta.pdb\n\n## Evolution of JuiceStealer\n\n```\nPivoting off the `pdb paths observed, we were able to link additional activities to`\nJuiceLedger. Those, together with our additional findings of the development phases of\nJuiceStealer, suggest the group began operating in late 2021.\n\n### Pre-JuiceStealer Fake Installers\n\n\n-----\n\nOn January 30, a set of three fake installers compiled as self-contained applications were\nuploaded to VirusTotal from the submitter f40316fe, located in GB. The same submitter also\nuploaded the first variant of JuiceStealer, which also appears to be a test. All the fake\ninstallers had a similar `pdb path, containing the username “reece”, and appear to be the`\nthreat actor’s first iterations of the JuiceStelaer.\n```\nC:\\Users\\reece\\source\\repos\\install-python\\installpython\\obj\\Release\\netcoreapp3.1\\win-x86\\install-python.pdb\n\n\n### Nowblox Scam Website\n\n```\nThroughout the research, we came across a possible connection to Nowblox, a scam\nwebsite that operated in 2021, offering free Robux. Several applications named\n“Nowblox.exe” were systematically uploaded to VirusTotal from submitters in GB, all with the\nfollowing `pdb path:`\n```\nC:\\\\Users\\\\reece\\\\source\\\\repos\\\\Nowblox\\\\Nowblox\\\\obj\\\\Debug\\\\Nowblox.pdb\n\n\n```\nWhile the path on its own is not a very strong indication, we came across another link to\nNowblox in our research, in the form of a file named\n“NowbloxCodes.iso”( 5eb92c45e0700d80dc24d3ad07a7e2d5b030c933 ). The use of an ISO\nfile might suggest it was sent out in a phishing email, as ISO files have become a popular\nattack vector for bypassing email security products. However, we have no data to validate\nthis.\n\nThe file contains an LNK file ( e5286353dec9a7fc0c6db378b407e0293b711e9b ), triggering\nthe execution of an obfuscated PowerShell command, which in turn runs `mstha to load an`\n```\n.HTA file from hxxps://rblxdem[.]com/brace.hta, which is currently offline.\n\n```\nThe domain `rblxdem[.]com is hosted on` `45.153.35[.]53, which was used to host`\nseveral Ledger phishing domains as well as a JuiceStealer C2 domain\n```\nthefutzibag[.]com, providing another possible link to JuiceLedger.\n\n## Fraudulent Apps – The Tesla Trading Bot\n\n```\nOver time, JuiceLedger operators started using direct crypto-themed fraudulent applications,\namong them, an application they named “Tesla Trading bot”. Delivered in a similar scheme to\nthe Python installer, it was embedded within a zip file with additional legitimate software. The\nJuiceStealer has evolved significantly during this period, adding support both for additional\nbrowsers as well as Discord.\n\nThe embedded instructions message is very similar to the one found in the fake Python\ninstaller, prompting users to disable their security solutions.\n\n\n-----\n\nJuiceLedger installer urges users to bypass their own security\nWhile the delivery mechanism remains unclear, it seems JuiceLedger operators maintained a\nwebsite for the fake trading bot, prompting users to download the fraudulent application.\n\n\n-----\n\nDownload site for malicious Tesla Trading bot\n\n## PyPI Response\n\nPyPI have [stated that they are actively reviewing reports of malicious packages and have](https://twitter.com/pypi/status/1562442209177522177?s=20&t=cG3jJe6qSl2DOOfCWVq6Qg)\ntaken down several hundred typosquats. Package maintainers are urged to use 2FA\nauthorization on their accounts where available and to confirm that the URL in the address\nbar is `http://pypi.org when entering credentials. Users can also check that the site’s`\nTLS certificate is issued to `pypi.org .`\n\nMaintainers who believe they may have been victim of a JuiceLedger attack are advised to\n[reset passwords immediately and to report any suspicious activity to [email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n## Conclusion\n\n\n-----\n\nJuiceLedger appears to have evolved very quickly from opportunistic, small-scale infections\nonly a few months ago to conducting a supply chain attack on a major software distributor.\nThe escalation in complexity in the attack on PyPI contributors, involving a targeted phishing\ncampaign, hundreds of typosquatted packages and account takeovers of trusted developers,\nindicates that the threat actor has time and resources at their disposal.\n\nGiven the widespread use of PyPI and other open source packages in enterprise\nenvironments, attacks such as these are a cause of concern and security teams are urged to\nreview the provided indicators and take appropriate mitigation measures.\n\n## Indicators of Compromise\n\n**Fake Python installers**\n\n90b7da4c4a51c631bd0cbe8709635b73de7f7290\n\ndd569ccfe61921ab60323a550cc7c8edf8fb51d8\n\n97c541c6915ccbbc8c2b0bc243127db9b43d4b34\n\nf29a339e904c6a83dbacd8393f57126b67bdd3dd\n\n71c849fc30c1abdb49c35786c86499acbb875eb5\n\n2fb194bdae05c259102274300060479adf3b222e\n\n**Nowblox ISO file**\n\n5eb92c45e0700d80dc24d3ad07a7e2d5b030c933\n\ne5286353dec9a7fc0c6db378b407e0293b711e9b\n\n**CryptoJuice Samples**\n\n\n**SHA1** **Submission**\n**Date**\n\ncbc47435ccc62006310a130abd420c5fb4b278d2 2022-08-24\n11:00:45\n\n8bbf55a78b6333ddb4c619d615099cc35dfeb4fb 2022-08-24\n10:59:40\n\nbac2d08c542f82d8c8720a67c4717d2e70ad4cd9 2022-08-23\n21:34:01\n\n567e1d5aa3a409a910631e109263d718ebd60506 2022-08-23\n21:33:58\n\n1e697bc7d6a9762bfec958ee278510583039579c 2022-08-23\n21:32:31\n\nea14f11e0bd36c2d036244e0242704f3cf721456 2022-08-20\n13:29:20\n\n\n**Domain**\n\nlinkedopports[.]com\n\nlinkedopports[.]com\n\nlinkedopports[.]com\n\nlinkedopports[.]com\n\nlinkedopports[.]com\n\nledgrestartings[.]com\n\n\n-----\n\n5703ed6565888f0b06fffcc40030ba679936d29f 2022-08-20\n13:25:59\n\ncd0b8746487d7ede0ec07645fd4ec655789c675b 2022-08-18\n08:43:43\n\nd3ed1c7c0496311bb7d1695331dc8d3934fbc8ec 2022-08-18\n08:33:28\n\n0a6731eba992c490d85d7a464fded2379996d77c 2022-08-18\n08:32:00\n\na30df748d43fbb0b656b6898dd6957c686e50a66 2022-08-08\n00:10:52\n\n52b7e42e44297fdcef7a4956079e89810f64e113 2022-08-08\n00:07:36\n\naa8c4dffeeacc1f7317b2b3537d2962e8165faa2 2022-08-05\n10:19:20\n\na6348aea65ad01ee4c7dd70b0492f308915774a3 2022-08-05\n10:06:04\n\nb305c16cb2bc6d88b5f6fe0ee889aaf8674d686e 2022-05-04\n03:15:56\n\n666e5554ccdafcb37a41f0623bb9acc53851d84f 2022-04-06\n10:45:39\n\n463897fa2dd2727a930b8f3397d10a796b6aa0d6 2022-04-06\n10:38:24\n\ne2e239f40fdb2e5bf9d37b9607b152f173db285c 2022-03-30\n04:58:00\n\nc0e3c2436e225f7d99991a880bf37d32ff09c5bd 2022-03-27\n18:14:18\n\n6f3c5a06d1a53fac45182e76897e7eab90d4a186 2022-03-22\n09:08:18\n\nbd7eb97b3dc47e72392738d64007df5fc29de565 2022-03-21\n15:10:01\n\nde4596669f540b8bd34aa7cbf50e977f04f3bba3 2022-03-20\n22:07:30\n\n55ba11f522532d105f68220db44392887952e57b 2022-03-14\n05:02:04\n\n\nledgrestartings[.]com\n\npython-release[.]com\n\npython-release[.]com\n\npython-release[.]com\n\npython-release[.]com\n\npython-release[.]com\n\nthefutzibag[.]com\n\nthefutzibag[.]com\n\nledge-pc[.]com\n\ntrezsetup[.]com\n\ntrezsetup[.]com\n\naxiesinfintity[.]com\n\naxiesinfintity[.]com\n\ncampus-art[.]com\n\ncampus-art[.]com\n\nteslatradingbot[.]com\n\nbarkbackbakery[.]com\n\n\n-----\n\n9e9c6af67962b041d2a87f2abec7a068327fa53a 2022-03-13\n05:01:47\n\ned9a4ce2d68d8cc9182bb36a46d35a9a8d0510cb 2022-03-06\n23:21:48\n\nf10006f7b13e4746c2293a609badd2d4e5794922 2022-03-06\n23:14:04\n\nf07954ba3932afd8ad7520c99a7f9263aa513197 2022-03-06\n17:29:24\n\n56e3421689d65e78ff75703dd6675956b86e09e8 2022-03-05\n22:53:42\n\n004c66532c49cb9345fc31520e1132ffc7003258 2022-03-05\n21:01:36\n\n6fe5f25205679e148b7b93f1ae80a659d99c7715 2022-03-04\n18:35:32\n\n964e29e877c65ff97070b7c06980112462cd7461 2022-03-02\n02:08:58\n\n225638350f089ee56eae7126d048b297fce27b7d 2022-02-28\n19:30:23\n\n9fb18a3426efa0034f87dadffe06d490b105bda3 2022-02-28\n19:23:51\n\na78dd3cd9569bd418d5db6f6ebf5c0c5e362919b 2022-02-18\n22:53:42\n\nd249f19db3fe6ea4439f095bfe7aafd5a0a5d4d2 2022-02-13\n07:10:09\n\n\nbarkbackbakery[.]com\n\ncapritagworld[.]com\n\ncapritagworld[.]com\n\nteslatradingbot[.]com\n\nideasdays[.]com\n\nideasdays[.]com\n\nteslatradingbot[.]com\n\nteslatradingbot[.]com\n\nhitwars[.]com\n\nhitwars[.]com\n\nbarkbackbakery[.]com\n\nbarkbackbakery[.]com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-01 - PyPI Phishing Campaign - JuiceLedger Threat Actor Pivots From Fake Apps to Supply Chain Attacks.pdf"
    ],
    "report_names": [
        "2022-09-01 - PyPI Phishing Campaign - JuiceLedger Threat Actor Pivots From Fake Apps to Supply Chain Attacks.pdf"
    ],
    "threat_actors": [
        {
            "id": "4cef49db-dec5-45ae-adcd-b0c0b5da5556",
            "created_at": "2024-06-25T02:00:05.040596Z",
            "updated_at": "2025-03-27T02:00:03.388625Z",
            "deleted_at": null,
            "main_name": "JuiceLedger",
            "aliases": [],
            "source_name": "MISPGALAXY:JuiceLedger",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535553,
    "ts_updated_at": 1743041614,
    "ts_creation_date": 1662984049,
    "ts_modification_date": 1662984049,
    "files": {
        "pdf": "https://archive.orkl.eu/88e2c87059c05efd54e7dcab0722ffb2d191a9e9.pdf",
        "text": "https://archive.orkl.eu/88e2c87059c05efd54e7dcab0722ffb2d191a9e9.txt",
        "img": "https://archive.orkl.eu/88e2c87059c05efd54e7dcab0722ffb2d191a9e9.jpg"
    }
}