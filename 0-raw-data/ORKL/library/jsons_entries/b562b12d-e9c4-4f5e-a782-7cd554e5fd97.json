{
    "id": "b562b12d-e9c4-4f5e-a782-7cd554e5fd97",
    "created_at": "2023-01-12T15:02:49.593036Z",
    "updated_at": "2025-03-27T02:06:00.317503Z",
    "deleted_at": null,
    "sha1_hash": "3bff7ecc933a007a39438e9a9a2441ad13fd50fd",
    "title": "2022-07-05 - QBot Spreads via LNK Files – Detection & Response",
    "authors": "",
    "file_creation_date": "2022-07-18T18:21:14Z",
    "file_modification_date": "2022-07-18T18:21:14Z",
    "file_size": 803600,
    "plain_text": "# QBot Spreads via LNK Files – Detection & Response\n\n**[socinvestigation.com/qbot-spreads-via-lnk-files-detection-response/](https://www.socinvestigation.com/qbot-spreads-via-lnk-files-detection-response/)**\n\nJuly 5, 2022\n\n#### IOC\n\n QakBot, also known as QBot, QuackBot, or Pinkslipbot, is a banking trojan malware that has existed for over a decade. In recent years, QakBot has become one of the leading banking trojans around the globe. Its main purpose is to steal banking credentials (e.g., logins, passwords, etc.)\n\n Most of the QBot infections are done by the initial vectors of XLS documents. Now, they started using the .lnk files to infect their targeted machines. As usual, this can be done by using spam campaigns or malicious URLs to deliver LNK files to their targets.\n\n## QBot LNK Infection Chain:\n\n\n-----\n\n#### Here, the initial vector is the .html file which contains a .zip file with the targeted path of .LNK file. Once the user opens the .LNK file, internal embedded codes will be executed, and it will start its infection chain.\n\n Recent infection can be done by using legitimate applications like PowerShell, CMD, and MSHTA to download the malicious payload files.\n\n## Why are LNK files being used?\n\n#### LNK file is a shortcut or “link” used by Windows as a reference to an original file, folder, or application. It contains the shortcut target type, location, and filename as well as the program that opens the target file and an optional shortcut key. The file can be created in Windows by right-clicking a file, folder, or executable program and then selecting create a shortcut.\n\n Also Read: Latest IOCs – Threat Actor URLs, IP’s & Malware Hashes\n\n In the .lnk files, we can be able to see the target path if it’s in a shorter range. However, command-line arguments can be up to 4096, so malicious actors can that this advantage and pass on long arguments as they will not be visible in the properties section.\n\n Sample Information:\n\n## The main content of this QBot LNK:\n\n\n-----\n\n## How does QBot LNK work?\n\n#### With reference to edge application, Echo > Ping 15.org > %appdata% > curl.exe > .dat > echo > regsvr.\n\n Ping [Packet Internet or Inter-Network Groper ] utility uses the echo request, and echo reply messages within the Internet Control Message Protocol (ICMP), an integral part of any IP network. Here, the ping sends ICMP packets to the destination. Then it waits for the echo reply.\n\n Also Read: Latest Cyber Security News – Hacker News !\n\n Then, Curl.exe is the main executable for running cURL. a cURL is a command-line tool and library for transferring data with URLs. Usually, a generic data file stores information specific to the application it refers to.\n\n Targeted Command Line:\n\n\n-----\n\n#### Hex_View of the .dat file Here, the targeted command line clearly reveals the malicious .dat file which will download the payload file.\n\n Also Read: Soc Interview Questions and Answers – CYBER SECURITY ANALYST\n\n Detection & Response:\n\n Qradar:\n```\nSELECT UTF8(payload) from events where LOGSOURCETYPENAME(devicetype)='Microsoft\nWindows Security Event Log' and (\"ParentImage\" ilike '%\\cmd.exe') and \"Process\nCommandLine\" ilike '%http://%' and \"Process CommandLine\" ilike '%ping15.org%' and\n\"Process CommandLine\" ilike '%..\\%' and \"Process CommandLine\" ilike '%curl.exe%' and\n\"Process CommandLine\" ilike '%regsvr32.exe%' and \"Process CommandLine\" ilike\n'%msedge.exe%'\n\n Splunk:\n\n```\n\n-----\n\n```\n((ParentImage \\\\cmd.exe ) AND CommandLine http:// AND\nCommandLine=\"*ping15.org*\" AND CommandLine=\"*..\\\\*\" AND CommandLine=\"*curl.exe*\" AND\nCommandLine=\"*regsvr32.exe*\" AND CommandLine=\"*msedge.exe*\") AND\nsource=\"WinEventLog:*\"\n\n#### Elastic Query:\n(process.parent.executable:*\\\\cmd.exe AND process.command_line:*http\\:\\/\\/* AND\nprocess.command_line:*ping15.org* AND process.command_line:*..\\\\* AND\nprocess.command_line:*curl.exe* AND process.command_line:*regsvr32.exe* AND\nprocess.command_line:*msedge.exe*)\n\n Arcsight:\n(sourceProcessName CONTAINS \"*\\\\cmd.exe\" AND ((deviceCustomString1 CONTAINS\n\"*http://*\" OR destinationServiceName CONTAINS \"*http://*\")) AND\n((deviceCustomString1 CONTAINS \"*ping15.org*\" OR destinationServiceName CONTAINS\n\"*ping15.org*\")) AND ((deviceCustomString1 CONTAINS \"*..\\\\\\\\*\" OR\ndestinationServiceName CONTAINS \"*..\\\\\\\\*\")) AND ((deviceCustomString1 CONTAINS\n\"*curl.exe*\" OR destinationServiceName CONTAINS \"*curl.exe*\")) AND\n((deviceCustomString1 CONTAINS \"*regsvr32.exe*\" OR destinationServiceName CONTAINS\n\"*regsvr32.exe*\")) AND ((deviceCustomString1 CONTAINS \"*msedge.exe*\" OR\ndestinationServiceName CONTAINS \"*msedge.exe*\")))\n\n CarbonBlack:\n(parent_name:*\\\\cmd.exe AND process_cmdline:*http\\:\\/\\/* AND\nprocess_cmdline:*ping15.org* AND process_cmdline:*..\\\\* AND\nprocess_cmdline:*curl.exe* AND process_cmdline:*regsvr32.exe* AND\nprocess_cmdline:*msedge.exe*)\n\n Crowdstike:\n((ParentBaseFileName=\"*\\\\cmd.exe\") AND (CommandLine=\"*http://*\" OR\nCommandHistory=\"*http://*\") AND (CommandLine=\"*ping15.org*\" OR\nCommandHistory=\"*ping15.org*\") AND (CommandLine=\"*..\\\\*\" OR CommandHistory=\"*..\\\\*\")\nAND (CommandLine=\"*curl.exe*\" OR CommandHistory=\"*curl.exe*\") AND\n(CommandLine=\"*regsvr32.exe*\" OR CommandHistory=\"*regsvr32.exe*\") AND\n(CommandLine=\"*msedge.exe*\" OR CommandHistory=\"*msedge.exe*\"))\n\n FireEye:\n(metaclass:`windows` pprocess:`*\\cmd.exe` args:`http://` args:`ping15.org`\nargs:`..\\\\` args:`curl.exe` args:`regsvr32.exe` args:`msedge.exe`)\n\n GrayLog:\n(ParentImage.keyword:*\\\\cmd.exe AND CommandLine.keyword:*http\\:\\/\\/* AND\nCommandLine.keyword:*ping15.org* AND CommandLine.keyword:*..\\\\* AND\nCommandLine.keyword:*curl.exe* AND CommandLine.keyword:*regsvr32.exe* AND\nCommandLine.keyword:*msedge.exe*)\n\n```\n\n-----\n\n#### Google Chronicle:\n```\nprincipal.process.file.full_path = /.*\\\\cmd\\.exe$/ and target.process.command_line =\n/.*http:\\/\\/.*/ and target.process.command_line = /.*ping15\\.org.*/ and\ntarget.process.command_line = /.*\\.\\..*/ and target.process.command_line =\n/.*curl\\.exe.*/ and target.process.command_line = /.*regsvr32\\.exe.*/ and\ntarget.process.command_line = /.*msedge\\.exe.*/\n\n Logpoint:\n(ParentImage IN \"*\\\\cmd.exe\" CommandLine=\"*http://*\" CommandLine=\"*ping15.org*\"\nCommandLine=\"*..\\\\*\" CommandLine=\"*curl.exe*\" CommandLine=\"*regsvr32.exe*\"\nCommandLine=\"*msedge.exe*\")\n\n Microsoft Defender:\nDeviceProcessEvents | where ((InitiatingProcessFolderPath endswith @\"\\cmd.exe\") and\nProcessCommandLine contains \"http://\" and ProcessCommandLine contains \"ping15.org\"\nand ProcessCommandLine contains @\"..\\\" and ProcessCommandLine contains \"curl.exe\" and\nProcessCommandLine contains \"regsvr32.exe\" and ProcessCommandLine contains\n\"msedge.exe\")\n\n Microsoft Sentinel:\nSecurityEvent | where EventID == 4688 | where ((ParentProcessName endswith\n@'\\cmd.exe') and CommandLine contains 'http://' and CommandLine contains 'ping15.org'\nand CommandLine contains @'..\\' and CommandLine contains 'curl.exe' and CommandLine\ncontains 'regsvr32.exe' and CommandLine contains 'msedge.exe')\n\n RSA Netwitness:\n((ParentImage contains '\\cmd\\.exe') && (CommandLine contains 'http://') &&\n(CommandLine contains 'ping15.org') && (CommandLine contains '..\\\\') && (CommandLine\ncontains 'curl.exe') && (CommandLine contains 'regsvr32.exe') && (CommandLine\ncontains 'msedge.exe'))\n\n SumoLogic:\n(_sourceCategory=*windows* AND (ParentImage = \"*\\cmd.exe\") AND\nCommandLine=\"*http://*\" AND CommandLine=\"*ping15.org*\" AND CommandLine=\"*..\\\\*\" AND\nCommandLine=\"*curl.exe*\" AND CommandLine=\"*regsvr32.exe*\" AND\nCommandLine=\"*msedge.exe*\")\n\n Aws Opensearch:\n(process.parent.executable:*\\\\cmd.exe AND process.command_line:*http\\:\\/\\/* AND\nprocess.command_line:*ping15.org* AND process.command_line:*..\\\\* AND\nprocess.command_line:*curl.exe* AND process.command_line:*regsvr32.exe* AND\nprocess.command_line:*msedge.exe*)\n\n```\n\n-----\n\n### LEAVE A REPLY\n\n#### Please enter your comment!\n\n Please enter your name here\n\n You have entered an incorrect email address!\n\n Please enter your email address here\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-05 - QBot Spreads via LNK Files – Detection & Response.pdf"
    ],
    "report_names": [
        "2022-07-05 - QBot Spreads via LNK Files – Detection & Response.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535769,
    "ts_updated_at": 1743041160,
    "ts_creation_date": 1658168474,
    "ts_modification_date": 1658168474,
    "files": {
        "pdf": "https://archive.orkl.eu/3bff7ecc933a007a39438e9a9a2441ad13fd50fd.pdf",
        "text": "https://archive.orkl.eu/3bff7ecc933a007a39438e9a9a2441ad13fd50fd.txt",
        "img": "https://archive.orkl.eu/3bff7ecc933a007a39438e9a9a2441ad13fd50fd.jpg"
    }
}