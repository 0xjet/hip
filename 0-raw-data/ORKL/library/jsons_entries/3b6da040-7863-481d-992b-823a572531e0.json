{
    "id": "3b6da040-7863-481d-992b-823a572531e0",
    "created_at": "2022-10-25T16:48:10.458018Z",
    "updated_at": "2025-03-27T02:16:17.280834Z",
    "deleted_at": null,
    "sha1_hash": "4622da4f28cb5b28c61aaebc8eaa43ed4bfd45e2",
    "title": "BabaDeda and LorecCPL downloaders used to run Outsteel against Ukraine",
    "authors": "telsy",
    "file_creation_date": "2022-02-16T10:57:02Z",
    "file_modification_date": "2022-02-16T10:57:02Z",
    "file_size": 4379954,
    "plain_text": "### Cyber Reports\n\n# BabaDeda and LorecCPL downloaders used to run Outsteel against Ukraine\n\n**TELSY S.p.A.**\n\nCorso Svizzera, 185 - 10149 Torino – ITALIA\n\nVia del Pellegrino 155 - 00186 Roma - ITALIA 16/02/2022\n\ntel +39.011.771.4343 - fax +39.011.741.9090\n\n\nemail: telsy@telsy.it\n\n\n-----\n\n### INDEX\n\n**1** **Introduction .................................................................................................................................... 3**\n\n**2** **Analysis ........................................................................................................................................... 4**\n\n**2.1** **Double BabaDeda crypter downloaded from LNK or docm template ................ 6**\n\n**2.1.1** **First Stage ........................................................................................................................................ 8**\n\n**2.1.2** **WhisperGate Code OVERLAP .................................................................................................. 19**\n\n**2.2** **BABADEDA Crypter Dropped from a new Downloader ......................................... 22**\n\n**2.3** **LorecCPL downloads ASPProtected Outsteel ............................................................ 27**\n\n**3** **Indicators of Compromise ........................................................................................................ 33**\n\n**4** **ATT&CK Matrix ............................................................................................................................ 34**\n\n\n2\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\n## 1 Introduction\n\nBeginning in January 2022, there was a series of attacks on numerous organizations in\nUkraine spanning the government, the military, non-governmental organizations (NGOs),\nwith the primary intent of exfiltrating sensitive information and maintaining access.\n\nBased on these new details and **_Telsy's threat hunt, we uncovered several links that_**\nstrongly support the idea that these attacks were part of a larger campaign that has been\nrunning for a few months and has undergone several evolutions.\n\nIn this way we have mapped the various clusters and in particular three chains of infection,\ncomposed of a series of techniques and procedures, with several significant elements that\nwe consider important to better understand the various phases implemented.\n\nOne of the most used access vectors in these campaigns are spear-phishing emails with\nmalicious attachments. Phishing attachments contain a first-stage payload that\ndownloads and executes additional payloads. The main payload provided by the malware\nis an infostealer written in AutoIt compiled (OutSteel). Its main goal is to steal files from\nthe victim's machine by uploading them to a default Command and control (C2) server.\nThe element detected in these latter chains is the downloader used to load the infostealer\n“Outsteel”. In the past this was loaded by the **SaintBot tool while in these campaigns, it is**\nloaded by the **BabaDeda** crypter.\n\nBased on victimology and the fact that this attack attempts to steal files from government\nentities, it is assumed to be a state-sponsored group.\n\nSome evidence suggests that these activities are carried out by a hacker group called\n“Lorec53” as namede by the security firm **_“NSFocus”. The group is suspected of being_**\nemployed by other high-level espionage organisations to conduct espionage attacks,\ntargeting government employees in Georgia and Ukraine. This group uses the infostealer\n\"Outsteel\" and the downloader \"LorecCPL\", both of which have overlapping code with the\nsame artefacts identified in the campaigns analysed in this report. We can therefore\nassume that the BabaDeda crypter is also one of the tools in use by this group.\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n3\n\n\n-----\n\n_entities graph_\n\n## 2 Analysis\n\nTelsy detected several infection chains starting with different initial stages: document\ntemplate, LNK file or a CPL file representing a new type of downloader very similar to a\nshellcode in the way the stack is used.\n\nThe second phase uses the BabaDeda crypter to run the infostealer called OutSteel.\n\n_BabaDeda Crypter_ is an evasive malware that acts like an installer and executes a\nshellcode stored encrypted in a file usually, xml or pdf, dropped by the installer self. The\nmain binary of _BabaDeda Crypter_ it’s a malicious binary, _compiled with text segment_\n_writable, that has only the purpose to load the 1[st] malicious library._\n\nThe first malicious DLL side loaded decrypt the shellcode storing it in the text section of\nthe main binary and loads/execute the secondary malicious library in another thread then\nreturn to the decrypted shellcode.\n\n\n_entities graph_\n\n\n4\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\nThe decrypted shellcode represents the real payload embedded in the installer by the\nthreat actor while the 2[nd] malicious library can embed every kind of malware. In the\nsamples that we found the 2[nd] library is used sometime as downloader and in other cases\nas thread to achieve persistence, it depends by the stage.\n\n\n_execution process graph_\n\nBelow a kind of time line that describes how the tools were employed in the time, most\nlikely, by the same threat actor.\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n5\n\n\n-----\n\n#### 2.1 Double BabaDeda crypter downloaded from LNK or docm template\n\nThis infection chain, which can be placed in the period September / October 2021\naccording to the compilation times, starts with a link (LNK) or a WORD template\ndocument that downloads the BabaDeda crypter. The BabaDeda crypter includes Outsteel\nas a payload and a downloader as 2[nd] library.\n\n_execution process graph_\n\nThe **lnk file with hash** _931a86f402fee99ae1358bb0b76d055b2d04518f, most likely_\ndistributed by e-mail, named “Особливі **_документи_** **_СБУ.lnk” (Special documents of the_**\n**_SBU.lnk) is, clearly, a decoy document for Ukrainian defense officers. This lnk file was_**\ncontained in zip archives hosted on discord.\n\nWhen open it executes a PowerShell command to download and execute the first phase\nfrom the URL: “hxxp: //3237.site/test01.exe”\n\nThe downloaded executable with hash _0d584d72fe321332df0b0a17720191ad96737f47 is_\nstored in the public directory and it is executed from the PowerShell self.\n\n\n6\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\nInstead the document with hash ac672a07c62d48c0a7f98554038913770efaef11 is a word\n**dotm model and starts the first phase of the infection in the same way as the lnk file,**\ndownloading and executing the same artifact through PowerShell:\n_hxxp://3237.site/test01.exe._\n\nThe following document header suggests that this document may have been used after\nSeptember 2021.\n\n_“Addition to the decision of the National Security and Defense Council of Ukraine of_\n_September 7, 2021 \"On Amendments to Personal Special Economic and Other Restrictive_\n_Measures (Sanctions)”_\n\nThe template contains a macro that on the open event drops a cmd file with a PowerShell\ncommand inside.\n\nThe cmd file is stored in “C:\\Users\\Public\\Documents\\programtwo.cmd” and contains the\nPowerShell command to download the artifact from URL “hxxp: //3237.site/test01.exe”\nand save it in “C:\\Users\\Public\\Documents\\manlevel.exe”.\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n7\n\n\n-----\n\nAs in the previous LNK document the PowerShell command runs the downloaded file.\nAlso, the WORD template has been hosted on discord and is most likely downloaded as a\nremote template from a docx released by email.\n\n**2.1.1** **First Stage**\n\nBoth files, lnk and WORD template, downloads the same installer has been created with\n_Inno Setup._\n\nOnce executed, it extracts all the components in the path:\n\n“C:\\Users\\admin\\AppData\\Roaming\\mXParser”.\n\nThe main executable, named “mathparser.exe” whose hash is\n_26474ba449682e82ca38fef32836dcb23ee24012, is executed directly by the installer after_\nall the components have been extracted.\n\nThis installation is a BabaDeda crypter, i.e. a type of loader. In fact, as described in the\nblog of the security company \"Morphisec”, it is used to evasively load a malicious payload\nstored in another file. Since the analysis cited by the blog is exhaustive, it was not\nperformed.\n\nThis loader was reported in November 2021 in connection with attacks against the NFT\nand **_Crypto community. Instead, it was used in these campaigns, leading to the_**\n\n\n8\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\nassumption that it could be code reuse or the action of the same cybercriminal group in\nfavour of a state-sponsored threat actor.\n\nBasically, the BabaDeda crypter phases are:\n\n1. Main Binary load and run a malicious DLL;\n2. The malicious DLL load and execute in another thread the second malicious DLL;\n3. The first malicious DLL read and parse the shellcode and write it in the text section\n\nof the main binary;\n4. The first malicious DLL returns to the shellcode entry point;\n5. The decryption shellcode has three main tasks: first, it extracts the loader shellcode\n\nand the payload, then it decrypts them, and finally, it transfers the execution to the\ndecrypted loader shellcode.\n6. Finally, the payload is executed.\n\nSince the second loaded DLL and the final payload can be customised, BabaDeda crypter\ncan be used to load any type of installation, in fact in this particular infection chain the\nfirst installer is intended to download and run another BabaDeda crypter. This differs from\nthe analysis carried out by the company Morphisec in November 2021 in which the samples\nanalysed were only used to directly upload malicious artefacts.\n\nThe “mathparser” installation directory contains the following malicious files:\n\n**NAME** **SHA1** **PURPOSE**\n\nmathparser.exe 26474ba449682e82ca38fef32836dcb23ee24012 Main malicious Binary\nJxCnv40.dll 7d44391b76368b8331c4f468f8ddbaf6ee5a6793 1[st] Loaded DLL\nlibics4.0.dll e1d92e085df142d703ed9fd9c65ed92562a759fa 2[nd] Loaded DLL\nmanual.pdf 8423b25054aa78535c49042295558f33d34deae1 Shellcode Container\n\nSo, the main binary before loading the library named “JxCnv40.dll” set the current\ndirectory to the right path to be sure that side loading technique works.\n\n|NAME|SHA1|PURPOSE|\n|---|---|---|\n|mathparser.exe|26474ba449682e82ca38fef32836dcb23ee24012|Main malicious Binary|\n|JxCnv40.dll|7d44391b76368b8331c4f468f8ddbaf6ee5a6793|1st Loaded DLL|\n|libics4.0.dll|e1d92e085df142d703ed9fd9c65ed92562a759fa|2nd Loaded DLL|\n|manual.pdf|8423b25054aa78535c49042295558f33d34deae1|Shellcode Container|\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n9\n\n\n-----\n\nThis library, whit hash 7d44391b76368b8331c4f468f8ddbaf6ee5a6793, run in a thread the\nsecond malicious library.\n\n\n10\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\nBasically, the first library open “manual.pdf” reads all the content, then starts a new thread\nand after copy the 0x226 bytes from the file content into the main binary text section. The\nmain binary is compiled with text section writable, so it does not need any virtual protect\nAPI. The shellcode taken from the file is located at a specified offset and it has a fixed size,\nthis means that the BabaDeda crypter is not so ductile, indeed the binary is strictly linked\nto the shellcode and the file that contains the shellcode. This makes harder to re-use it\nwithout having the BabaDeda crypter build tools. A threat actor could use it changing the\noffsets manually to load another shellcode of different length from another file.\n\nBelow the routine that loads the second library:\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n11\n\n\n-----\n\nMeanwhile the second library is executed in another thread, the final payload is decrypted\nand executed in the main binary thread. The payload named _Outsteel sends the_\ndocuments to be exfiltrated to the URL “hxxp://185.244.41.109:8080/upld/”.\n\nThis IP was disclosed as an IoC by the Ukrainian CERT in February 2022, although the same\nhas been in use since at least October 2021. The final payload was decompiled with AutoIt\ntools and a code snippet follows.\n\n_Outsteel snippet code_\n\nThe second library, with hash _e1d92e085df142d703ed9fd9c65ed92562a759fa, is a mere_\ndownloader. Its main and only purpose is to download the next stage and run it.\n\n\n12\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\nThen the library with hash e1d92e085df142d703ed9fd9c65ed92562a759fa downloads from\nthe URL \"hxxp://smm2021.net/load2022.exe\" the artefact, stores it in the path\n\"C:\\Users\\<user>\\Downloads\\installation.exe\" and finally executes it.\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n13\n\n\n-----\n\nThe downloaded file represents the second BabaDeda crypter installation and has hash:\n_75afd05e721553211ce2b6d6760b3e6426378469._\n\nIn particular, once executed, it runs an msiexec command to extract each component of\nthe installation to “C:\\Users\\admin\\AppData\\Roaming\\AdoptOpenJDK\\Network OpenJDK\n_11 2.1.11.53”. After that, the main binary is executed automatically._\n\nThe malicious files released are:\n\n**NAME** **SHA1** **PURPOSE**\nadfrecorder.exe adea1f5656c54983880c4f1841df85016828eece Main malicious Binary\nff_wmv9.dll ba9cea9ae60f473d7990c4fb6247c11c080788d3 1[st] Loaded DLL\nlibegl3.dll 3a0a4e711c95e35c91a196266aeaf1dc0674739d 2[nd] Loaded DLL\nusage.pdf fa7887bc9d48fcfc6fd0e774092ca711ae28993a Shellcode Container\n\nThe workflow is quite like the previous, the difference is in the final payload and in the\nsecond malicious library.\n\n|NAME|SHA1|PURPOSE|\n|---|---|---|\n|adfrecorder.exe|adea1f5656c54983880c4f1841df85016828eece|Main malicious Binary|\n|ff_wmv9.dll|ba9cea9ae60f473d7990c4fb6247c11c080788d3|1st Loaded DLL|\n|libegl3.dll|3a0a4e711c95e35c91a196266aeaf1dc0674739d|2nd Loaded DLL|\n|usage.pdf|fa7887bc9d48fcfc6fd0e774092ca711ae28993a|Shellcode Container|\n\n\n14\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\nThe library “ff_wmv9.dll”, with hash _ba9cea9ae60f473d7990c4fb6247c11c080788d3, is_\nexecuted to decrypt the final payload and loads the second library.\n\n`\n\nIt opens the library “usage.pdf” reads the content, create a new thread and it copies in text\nsegment the shellcode located at a specific offset and run it.\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n15\n\n\n-----\n\nThe second library is loaded and executed.\n\nThe second library achieves the persistence creating a link file pointing to the main binary\nin the start-up directory. The link file is created via COM object interface, in particular using\nthe IShellLinkW interface.\n\n\n16\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\nThe start-up directory is obtained using SHGetFolderPathW() API.\n\n.\n\nMeanwhile the second library gains the persistence, the main thread run the real payload\nafter that it is decrypted as described for BabaDeda crypter. To have the final payload the\nmain binary has been dumped just after the decryption phase. The final payload is a\ndownloader that tries to download the next stage and run it in another process.\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n17\n\n\n-----\n\nThreat actor used a particular way to check the file size. It run a stat() and checked the\nsize field. If it is 1 then the file and the malware is removed otherwise it is executed. The\ndownloaded file is executed in a new process.\n\nOn the other hand, below the function to delete itself.\n\n\n18\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\nUnfortunately, the C2 “hxxp://45.12.5.62/<timestamp in hex>” was not working so no\nfurther payloads are available.\n\n**2.1.2** **WhisperGate Code OVERLAP**\n\nSome similarity has been found between the final payload, especially in the self-deletion\nroutine. In particular the similarity is with the file having the hash\n_34ca75a8c190f20b8a7596afeb255f2228cb2467bd210b2637965b61ac7ea907, i.e. the file_\n“Wiper”.\n\nIndeed the file wiper reported by “Unit42” in shows that the self-deletion command string\nis almost identical.\n\nBelow the two strings used:\n\n**Executable** **Command**\n_File Wiper (WhisperGate)_ cmd.exe /min /C ping 111.111.111.111 -n 5 -w 10 > Nul & Del /f /q \\\"%s\\\"\n_adfrecorder.exe_ _(final_ cmd.exe /min /C ping 111.111.111.111 -n 1 -w 10 > Nul & Del /f /q \"%s\"\n_payload)_\n\nIn the following snippet the difference between the two functions.\n\n|Executable|Command|\n|---|---|\n|File Wiper (WhisperGate)|cmd.exe /min /C ping 111.111.111.111 -n 5 -w 10 > Nul & Del /f /q \\\"%s\\\"|\n|adfrecorder.exe (final payload)|cmd.exe /min /C ping 111.111.111.111 -n 1 -w 10 > Nul & Del /f /q \"%s\"|\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n19\n\n\n-----\n\n_adfrecorder.exe (final payload)_\n\n_File Wiper (WhisperGate)_\n\nAlso the routine to run the command is very similar.\n\n\n20\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\n_adfrecorder.exe (final payload)_\n\n_File Wiper (WhisperGate)_\n\nAlthough the code is quite similar, at the same time it can be quite common. Nevertheless,\nthe CMD command, its options and the use of the IP _111.111.111 as a whole suggest a_\nsimilarity between the two artefacts. In addition, both malware processes close after\nexecution of the CMD command.\n\n\n_File Wiper (WhisperGate)_\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n21\n\n\n-----\n\n#### 2.2 BABADEDA Crypter Dropped from a new Downloader\nThe second infection chain analysed begins with an archive containing a file with the\nextension \".cpl\" that subsequently downloads the _BabaDeda crypter. Based on the_\ncompilation date of the cpl file, it is assumed that this campaign can be traced back to\nNovember 2021.\n\n_execution process graph_\n\nIn terms of analysis, looking at a CPL file is essentially identical to a DLL file. However,\nunlike the latter, it is automatically run when double-clicked. This makes it similar to EXE\nfiles; however uneducated users may be more likely to try to execute CPL files if they do\nnot know any better. These files with the extension CPL have code overlaid with LorecCPL\ndescribed by the security company NSFocus.\n\nThe zip archive, with hash 33ddc1b13c079001eaa3514de7354019fa4d470a, was hosted on\ndiscord and contains the LorecCPL file with hash:\n\n_3bbe45cdcc2731c0bb4751d1098eccc50f98ef66._\n\nThe latter is named:\n\n\n22\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\n“PDF – _Інструкція_ _отримання_ _бонусу_ _за_ _вакцинацію______________________-pdf.cpl”_\nwhich means “PDF _–_ _Instructions_ _for_ _receiving_ _the_ _vaccination_ _bonus_\n_________________________- pdf.cpl”_\n\nThe _LorecCPL_ file downloads an MSI file and installs it in the path:\n“C:\\Users\\admin\\AppData\\Roaming\\3delite\\Memory Test Toolkit”.\n\nThe LorecCPL file is therefore only a downloader and has a structure similar to a shellcode\nas shown in the following figure:\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n23\n\n\n-----\n\nBasically, the code and the useful data are both in the text section. The return address in\nthe stack is used to insert the address of the value that will be used by the call. The\nfollowing routine is used to find the module addresses, walking the PEB structure:\n\nOnce the address of the library has been obtained, of course the necessary APIs will\nactually be resolved:\n\n\n24\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\nThe function to find the library address and to resolve the API name are used few times to\nget the address of the APIs LoadLibraryW() and GetProcAddr(), respectively the addresses\nare stored in the EDI and ESI registers. So further in the code when a library or a API should\nbe resolved the EDI/ESI register are used to call the proper API.\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n25\n\n\n-----\n\nThe library downloads an executable, with hash\n\"7b67ed1f42e5cf388a0a981566598E716D9B4F99\" from the URL\n\"CDN.Discordapp.com/attachments/908281957039869965/911202801695/9112028016965\n_/91120280162882172/adobeaacrobatreaderUpdate.exe\" using the \"WinHTTP\" library,_\nsaves it in the path: “C:\\Users\\Public\\svchosts.exe” and finally executes it.\n\nThe file with hash 7b67ed1f42e5cf388a0a981566598e716d9b4f99 install BabaDeda crypter\nand starts the main malicious binary named also in this case mathparser.exe.\n\nThe malicious files extracted are always the same:\n\n|NAME|SHA1|PURPOSE|\n|---|---|---|\n|mathparser.exe|f2b8ab6f531621ab355912de64385410c39c1909|Main malicious Binary|\n|JxCnv40.dll|7d44391b76368b8331c4f468f8ddbaf6ee5a6793|1st Loaded DLL|\n\n\n26\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\nlibics4.0.dll e1d92e085df142d703ed9fd9c65ed92562a759fa 2[nd] Loaded DLL\nmanual.pdf 8423b25054aa78535c49042295558f33d34deae1 Shellcode Container\n\nThe LorecCPL libraries have been used to download Outsteel or BabaDeda crypter.\n\n_Outsteel snippet code_\n\n#### 2.3 LorecCPL downloads ASPProtected Outsteel\nThis infection chain according to the compilation time is of December 2021, differently\nfrom the previous one it does not uses BabaDeda crypter as loader but just uses LorecCPL\nto download Outsteel packed.\n\nTelsy Report – BabaDeda and LorecCPL downloaders 27\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n|libics4.0.dll|e1d92e085df142d703ed9fd9c65ed92562a759fa|2nd Loaded DLL|\n|---|---|---|\n|manual.pdf|8423b25054aa78535c49042295558f33d34deae1|Shellcode Container|\n\n\nfrom the previous one it does not uses BabaDeda crypter as loader but just uses LorecCPL\n_Outsteel packed._\n\nTelsy Report – BabaDeda and LorecCPL downloaders 27\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\nThe chain starts with an archive, with hash\n_0d94bac4c4df1fe3ad9fd5d6171c7460b30d8203, containing a LorecCPL file, with hash_\n_f9d5b4cd52b42858917a4e1a1a60763c039f8930, and named_\n\n_pdf - Приклад_ _заповнення_ _пояснювальної_ _текст_ _заповнюється_ _вручну.cpl ._\n\nThe CPL file, having the text segment writable, decrypts the real code via xor and then\njump on it. After the xor operation the code goes on the decrypted zone and execute the\nusual LorecCPL flow, i.e. putting arguments on the stack as return address and use them\nin functions.\n\n\n28\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\nIndeed dumping the process the visual of the code is equals to the previous one.\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n29\n\n\n-----\n\nThe LorecCPL will download from \"stun.site/zepok101.exe\" the Outsteel infostealer, with\nhash dbc9c8a492ae270bb7ed845680b81b94483ab585, packaged with the ASProtect tool .\n\nAfter decompressing and unpacking it, the “Outsteel” infostealer was found to exfiltrate\ndocuments on C2: “hxxp://185.244.41.109:8080/upld/”\n\n_Outsteel snippet code_\n\nBelonging to the same campaign, for the same infection chain and period there is another\narchive, with hash 66117493eed35fbd3824e35971b0919190cd1de7, hosted at the following\nURL:\n“hxxp://flexspace.app/images/%D0%A2%D0%9B%D0%A4%20%D0%B8%D0%BD%D1%8\n_4%D0%BE%D1%80%D0%BC%20%D0%92%D0%A0%D0%A3.docx.rar”._\n\nThis RAR file containing the usual _LorecCPL_ file inside, with hash\n_d0f1518db54f280dde5008404a2750641e76ceb2, named “ТЛФ_ _информ_ _ВРУ.docx.cpl”._\n\nThe LorecCPL file, just like the previous one, starts decrypting its payload and then acts\nlike the previous downloading the Outsteel ASPRotected.\n\n\n30\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\nLorecCPL file before decryption:\n\n_LorecCPL file after decryption:_\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n31\n\n\n-----\n\nThe _LorecCPL will download the next stage_ _Outsteel from the following URL:_\n“hxxp://stun.site/42348728347829.exe”.\n\nThe next stage, with hash _942337f3ea28f553b47dc05726bb062befe09fef, is still packed_\nwith _ASProtector. The exfiltrated documents are still sent to the same IP address:_\n_185.244.41.109._\n\n_Outsteel snippet code_\n\n\n32\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\n## 3 Indicators of Compromise\n\n**TYPE** **_HASH_** **_PURPOSE_**\n\n_Start_ _Chain_ _Document_\n_DOTM_ _ac672a07c62d48c0a7f98554038913770efaef11_\n_downloader_\n_LNK_ _931°86f402fee99ae1358bb0b76d055b2d04518f_ _Start Chain Link file downloader_\n_CPL_ _3bbe45cdcc2731c0bb4751d1098eccc50f98ef66_ _Start Chain CPL file downloader_\n_EXE_\n_0d584d72fe321332df0b0a17720191ad96737f47_ _BABADEDA Crypter Installer_\n_(Installer)_\n\n_EXE_\n_75afd05e721553211ce2b6d6760b3e6426378469_ _BABADEDA Crypter Installer_\n_(Installer)_\n\n_EXE_ _26474ba449682e82ca38fef32836dcb23ee24012_ _Mathparser.exe main binary_\n_EXE_ _f2b8ab6f531621ab355912de64385410c39c1909_ _Mathparser.exe main binary_\n\n_JxCnv40.dll malicious library shellcode_\n_DLL_ _7d44391b76368b8331c4f468f8ddbaf6ee5a6793_\n_injector (1[st] stage)_\n\n_ff_wmv9.dll malicious library shellcode_\n_DLL_ _ba9cea9ae60f473d7990c4fb6247c11c080788d3_\n_injector (1[st] stage)_\n\n_libics4.0.dll malicious library downloader_\n_DLL_ _e1d92e085df142d703ed9fd9c65ed92562a759fa_\n_(2[nd] stage)_\n\n_libegl3.dll_ _malicious_\n\n_DLL_ _3a0a4e711c95e35c91a196266aeaf1dc0674739d_ _persistence_\n\n_(2[nd] stage)_\n_PDF_\n_8423b25054aa78535c49042295558f33d34deae1_ _manual.pdf shellcode container_\n_(Shellcode)_\n\n_PDF_\n_fa7887bc9d48fcfc6fd0e774092ca711ae28993a_ _usage.pdf shellcode container_\n_(Shellcode)_\n\n_Archive_ _0d94bac4c4df1fe3ad9fd5d6171c7460b30d8203_ _Archive (CPL container)_\n_CPL_ _f9d5b4cd52b42858917a4e1a1a60763c039f8930_ _Outsteel downloader_\n_EXE_ _dbc9c8a492ae270bb7ed845680b81b94483ab585_ _Outsteel Asprotected_\n_Archive_ _66117493eed35fbd3824e35971b0919190cd1de7_ _Archive (CPL container)_\n_CPL_ _d0f1518db54f280dde5008404a2750641e76ceb2_ _Outsteel downloader_\n_EXE_ _942337f3ea28f553b47dc05726bb062befe09fef_ _Outsteel Asprotected_\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n|TYPE|HASH|PURPOSE|\n|---|---|---|\n|DOTM|ac672a07c62d48c0a7f98554038913770efaef11|Start Chain Document Template downloader|\n|LNK|931°86f402fee99ae1358bb0b76d055b2d04518f|Start Chain Link file downloader|\n|CPL|3bbe45cdcc2731c0bb4751d1098eccc50f98ef66|Start Chain CPL file downloader|\n|EXE (Installer)|0d584d72fe321332df0b0a17720191ad96737f47|BABADEDA Crypter Installer|\n|EXE (Installer)|75afd05e721553211ce2b6d6760b3e6426378469|BABADEDA Crypter Installer|\n|EXE|26474ba449682e82ca38fef32836dcb23ee24012|Mathparser.exe main binary|\n|EXE|f2b8ab6f531621ab355912de64385410c39c1909|Mathparser.exe main binary|\n|DLL|7d44391b76368b8331c4f468f8ddbaf6ee5a6793|JxCnv40.dll malicious library shellcode injector (1st stage)|\n|DLL|ba9cea9ae60f473d7990c4fb6247c11c080788d3|ff_wmv9.dll malicious library shellcode injector (1st stage)|\n|DLL|e1d92e085df142d703ed9fd9c65ed92562a759fa|libics4.0.dll malicious library downloader (2nd stage)|\n|DLL|3a0a4e711c95e35c91a196266aeaf1dc0674739d|libegl3.dll malicious library for persistence (2nd stage)|\n|PDF (Shellcode)|8423b25054aa78535c49042295558f33d34deae1|manual.pdf shellcode container|\n|PDF (Shellcode)|fa7887bc9d48fcfc6fd0e774092ca711ae28993a|usage.pdf shellcode container|\n|Archive|0d94bac4c4df1fe3ad9fd5d6171c7460b30d8203|Archive (CPL container)|\n|CPL|f9d5b4cd52b42858917a4e1a1a60763c039f8930|Outsteel downloader|\n|EXE|dbc9c8a492ae270bb7ed845680b81b94483ab585|Outsteel Asprotected|\n|Archive|66117493eed35fbd3824e35971b0919190cd1de7|Archive (CPL container)|\n|CPL|d0f1518db54f280dde5008404a2750641e76ceb2|Outsteel downloader|\n|EXE|942337f3ea28f553b47dc05726bb062befe09fef|Outsteel Asprotected|\n\n\n33\n\n\n-----\n\n**_DOMAIN - IP - URL_**\n\n\n_smm2021.net_\n\n\n_http://smm2021.net/load2022.exe_\n\n\n_3237.site_\n\n\n_http://3237.site/test01.exe_\n\n\n_45.12.5.62_\n\n\n_cdn.discordapp.com/attachments/908281957039869965/911202801416282172/AdobeAc_\n_robatReaderUpdate.exe_\n\n\n_185.244.41.109_\n\n\n_hxxp://185.244.41.109:8080/upld/_\n\n\n_flexspace.app_\n\n\n_hxxp://flexspace.app/images/%D0%A2%D0%9B%D0%A4%20%D0%B8%D0%BD%D1%_\n_84%D0%BE%D1%80%D0%BC%20%D0%92%D0%A0%D0%A3.docx.rar_\n\n\n_stun.site_\n\n\n_http://stun.site/zepok101.exe_\n\n## 4 ATT&CK Matrix\n\n34\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n-----\n\n**Telsy is the Digital Champion of TIM Group for**\ncybersecurity and cryptography. For 50 years it has been\nat the service of the defense of the country, supporting\narmed forces and institutions in the defense of\ncommunications and the Italian cyber perimeter.\nWorking in synergy with the other factories of the TIM\nGroup, Telsy is the Cybersecurity competence center,\nwhich develops, besides the innovative core business\nfocused on communication security, firmware security,\nMSS, data center security, and decision intelligence &\ndata analytics solutions.\nTelsy complies with the Golden Power regulation, being a\nstrategic company to the national security and defense.\n\nThis report was produced by Telsy’s “Cyber Threat\n**Intelligence” team with the help of its CTI platform,**\nwhich allows to analyze and stay updated on adversaries\nand threats that could impact customers’ business.\n\n_©2022 Telsy. All rights reserved. The reproduction and distribution of this_\n_material is prohibited without express written permission from Telsy._\n\n\n**TELSY S.p.A.**\nCorso Svizzera, 185 - 10149 Torino – ITALIA\n\nwww.telsy.com\nemail: telsy@telsy.it\n\n\nTelsy Report – BabaDeda and LorecCPL downloaders\n\nused to run Outsteel against Ukraine © Telsy 2022\n\n\n35\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/uobrphf3bkfzyy4wt9tqh41v4m09bggk"
    ],
    "report_names": [
        "Telsy_BabaDeda-LorecCPL-Outsteel-Ukraine(02-16-2022)"
    ],
    "threat_actors": [
        {
            "id": "c28760b2-5ec6-42ad-852f-be00372a7ce4",
            "created_at": "2022-10-27T08:27:13.172734Z",
            "updated_at": "2025-03-27T02:00:55.511386Z",
            "deleted_at": null,
            "main_name": "Ember Bear",
            "aliases": [
                "Ember Bear",
                "UNC2589",
                "Bleeding Bear",
                "DEV-0586",
                "Cadet Blizzard",
                "Frozenvista",
                "UAC-0056"
            ],
            "source_name": "MITRE:Ember Bear",
            "tools": [
                "P.A.S. Webshell",
                "CrackMapExec",
                "ngrok",
                "WhisperGate",
                "Saint Bot",
                "PsExec",
                "Rclone",
                "Impacket",
                "OutSteel"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "083d63b2-3eee-42a8-b1bd-54e657a229e8",
            "created_at": "2022-10-25T16:07:24.143338Z",
            "updated_at": "2025-03-27T02:02:10.12138Z",
            "deleted_at": null,
            "main_name": "SaintBear",
            "aliases": [
                "Ember Bear",
                "FROZENVISTA",
                "Lorec53",
                "Nascent Ursa",
                "Nodaria",
                "SaintBear",
                "Storm-0587",
                "TA471",
                "UAC-0056",
                "UNC2589"
            ],
            "source_name": "ETDA:SaintBear",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Elephant Client",
                "Elephant Implant",
                "GraphSteel",
                "Graphiron",
                "GrimPlant",
                "OutSteel",
                "Saint Bot",
                "SaintBot",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "eecf54a2-2deb-41e5-9857-fed94a53f858",
            "created_at": "2023-01-06T13:46:39.349959Z",
            "updated_at": "2025-03-27T02:00:03.057647Z",
            "deleted_at": null,
            "main_name": "SaintBear",
            "aliases": [
                "UAC-0056",
                "Nascent Ursa",
                "Nodaria",
                "FROZENVISTA",
                "Storm-0587",
                "Lorec53",
                "Lorec Bear",
                "UNC2589",
                "TA471",
                "DEV-0587",
                "Saint Bear",
                "EMBER BEAR",
                "Bleeding Bear"
            ],
            "source_name": "MISPGALAXY:SaintBear",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "03a6f362-cbab-4ce9-925d-306b8c937bf1",
            "created_at": "2024-11-01T02:00:52.635907Z",
            "updated_at": "2025-03-27T02:00:55.474243Z",
            "deleted_at": null,
            "main_name": "Saint Bear",
            "aliases": [
                "Saint Bear",
                "Storm-0587",
                "TA471",
                "UAC-0056",
                "Lorec53"
            ],
            "source_name": "MITRE:Saint Bear",
            "tools": [
                "OutSteel",
                "Saint Bot"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716490,
    "ts_updated_at": 1743041777,
    "ts_creation_date": 1645009022,
    "ts_modification_date": 1645009022,
    "files": {
        "pdf": "https://archive.orkl.eu/4622da4f28cb5b28c61aaebc8eaa43ed4bfd45e2.pdf",
        "text": "https://archive.orkl.eu/4622da4f28cb5b28c61aaebc8eaa43ed4bfd45e2.txt",
        "img": "https://archive.orkl.eu/4622da4f28cb5b28c61aaebc8eaa43ed4bfd45e2.jpg"
    }
}