{
    "id": "cd61805b-6398-425d-ae70-6ed6b09929e1",
    "created_at": "2022-10-25T16:48:18.95945Z",
    "updated_at": "2025-03-27T02:15:06.26485Z",
    "deleted_at": null,
    "sha1_hash": "8aa09365daf1885aba46f3f46d07582ae06754d9",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-03-02T02:26:51Z",
    "file_modification_date": "2022-03-02T02:26:51Z",
    "file_size": 1063374,
    "plain_text": "# Confucius Uses Pegasus Spyware-related Lures to Target Pakistani Military\n\n**[trendmicro.com/en_us/research/21/h/confucius-uses-pegasus-spyware-related-lures-to-target-pakistani.html](https://www.trendmicro.com/en_us/research/21/h/confucius-uses-pegasus-spyware-related-lures-to-target-pakistani.html)**\n\nAPT & Targeted Attacks\n\n\nAugust 17, 2021\n\n\nWhile investigating the Confucius threat actor, we found a recent spear phishing campaign that utilizes\nPegasus spyware-related lures to entice victims into opening a malicious document downloading a file\nstealer.\n\nBy: Daniel Lunghi\nAugust 17, 2021\nRead time: 4 min (1215 words)\n\n## Introduction\n\n[While investigating the Confucius threat actor, we found a recent spear phishing campaign that utilizes](https://www.trendmicro.com/en_us/research/18/b/deciphering-confucius-cyberespionage-operations.html)\nPegasus spyware-related lures to entice victims into opening a malicious document downloading a file\n[stealer. The NSO Group’s spyware spurred a collaborative investigation that found that it was being used to](https://www.amnesty.org/en/latest/news/2021/07/the-pegasus-project/)\ntarget high-ranking individuals in 11 different countries.\n\nIn this blog entry, we take a look at the lures used by the malicious actor and provide a short analysis of the\nfile stealer used in the campaign, which was launched in early August.\n\n## The contents of the spear phishing email\n\nThe campaign involves a two-step attack. During the first phase, an email without a malicious payload\ncontaining content copied from a legitimate Pakistani newspaper’s article is sent to the target. The sender\naddress, which is spoofed, impersonates the PR wing of the Pakistani Armed Forces (info@ispr.gov.pk).\n\nTwo days later, a second email — purportedly a warning from a Pakistani military about the Pegasus\nspyware — containing a cutt.ly link to a malicious encrypted Word document and the password for\ndecryption will be sent to the target. The sender address impersonates a service similar to that on the first\nemail (alert@ispr.gov.pk).\n\n\n-----\n\nFigure 1. Spear-phishing email from early August. Notice the insertion of logos from the Pakistani Army, Air Force, Navy,\n\nand PR department.\n\nIf the target clicks on either the link or on the “unsubscribe” link, it will download a Word document from\nthe domain parinari[.]xyz.\n\nThe emails are sent either from an ExpressVPN exit node in Pakistan, or from a mail server under the\nattacker’s control.\n\n## Examining the encrypted document containing macros\n\nAfter entering the password mentioned in the message, a document containing macros is displayed on\nscreen.\n\n\n-----\n\nFigure 2. Malicious document containing macros\n\nIf the victim enables macros, the malicious code will be loaded. If the victim enters any phone number and\nclicks “SUBMIT,” the text field will be replaced by the message “Phone Number Not Found.”\n\nBehind the scenes, a .NET DLL file named skfk.txt, which is filled with content found inside the\n“Comments” property of the document, is created in the temporary directory. The file is then loaded in\nmemory via PowerShell.\n\nStage 1 is a simple download & execute program. It downloads an ASCII file from the same domain and\nconverts it into binary before loading it on to the memory and jump to a dynamic function.\n\nStage 2 is also .NET DLL file that downloads a third file from parinari[.]xyz, converts it from ASCII to\nbinary, and then creates a scheduled task to load it.\n\nStage 3 is similar to stage 1, with the only change being the URL to retrieve the next stage.\n\nStage 4 is the final payload (analyzed in the next section). it is never written in clear text to the file disk.\n\n\n-----\n\nFigure 3. File stealer loading scheme\n\nIt should be noted that most of the compilation timestamps of these DLL files have been modified by the\nattacker to a year in the far future (2060, 2099 …), and the server IP addresses are often hidden behind\nCloudFlare.\n\n## Analysis of the file stealer\n\nThe final payload is a .NET DLL file designed to steal documents and images with the following extensions:\n\n|File extension|Description|\n|---|---|\n|TXT|Text file|\n|PDF|PDF file|\n|PNG|Image file in PNG format|\n|JPG|Image file in JPG format|\n|DOC|Word document|\n|XLS|Excel document|\n|XLM|Excel document with macros|\n|ODP|OpenDocument Presentation|\n|ODS|OpenDocument Sheet|\n\n\n-----\n\n|ODT|OpenDocument Text|\n|---|---|\n|RTF|Rich Text Format file|\n|PPT|PowerPoint document|\n|XLSX|Excel document|\n|XLSM|Excel document with macros|\n|DOCX|Word document|\n|PPTX|PowerPoint document|\n|JPEG|Image file in JPEG format|\n\n\nThe “Documents,” “Downloads,” “Desktop,” and “Pictures” folders of every user are checked. The DLL file\nalso examines drives other than C:.\n\n\n-----\n\nFigure 4. Code showing the main function of the file stealer\n\nWhen a file matching one of the listed extensions is found, its MD5 hash is calculated and compared to an\nexclusion list retrieved from the command-and-control (C&C) server pirnaram[.]xyz.\n\nIf the hash is not listed, the file is sent via the C&C to a directory named after the concatenation of the\nmachine name and the username. The exclusion list is different for every machine name-username string.\n\n## Other campaigns\n\nDuring our monitoring of Confucius, we came across a campaign delivering the same payload, using a\n[different lure. In this instance, the campaign impersonated the Pakistani Defense Housing Authority.](https://en.wikipedia.org/wiki/Defence_Housing_Authority)\nAgain, this threat actor’s interest in military personnel is obvious.\n\n\n-----\n\nFigure 5. Spear-phishing email from early August\n\nThe lures used in an older campaign from April 2021 impersonated the Federal Board of Revenue. There\nwere minor differences in tools, tactics, and procedures: the malicious document was directly attached to\nthe spear phishing email — still encrypted — and the decryption password was sent in a different email.\nThe first stage was also hidden in the “Comments” section. However, the second stage contained the final\npayload, which was once again a file stealer with the exact same structure (a .NET DLL). Instead of\nexfiltrating the files through PHP scripts, they were done via FTP server.\n\nIt should be noted that in some occasions, the threat actor sent spear-phishing emails from the domain\n[name mailerservice[.]directory which we attributed to the Patchwork threat actor in previous research. We](https://documents.trendmicro.com/assets/tech-brief-untangling-the-patchwork-cyberespionage-group.pdf)\n[disclosed multiple links between Patchwork and Confucius threat actors in the past, so this came as no](https://www.trendmicro.com/en_us/research/18/h/the-urpage-connection-to-bahamut-confucius-and-patchwork.html)\nsurprise to us.\n\n## The creative use of social engineering lures and how to defend against them\n\n\n-----\n\n[In our previous research, we already found Confucius, which is known for targeting Pakistan military for](https://documents.trendmicro.com/assets/research-deciphering-confucius-cyberespionage-operations.pdf)\nespionage purposes, employing multiple file stealers. While the code quality of its payloads is not of the\nhighest standard, this threat actor uses innovative techniques when crafting its malicious documents, such\nas hiding malicious code in the comments section, or using encrypted documents to prevent automatic\nanalysis. Therefore, it’s highly likely that Confucius will continue to experiment and try out different kinds\nof social engineering lures in future campaigns.\n\nDespite the variety of lures used by the threat actor, best security practices still apply to these attacks.\nUsers should always be wary and avoid clicking on any link or downloading any file from unsolicited emails\nor suspicious sources. Red flags such as unusual sender domains or grammatical and spelling errors are\nalso a sign that the email is malicious in nature, or at the very least, should be approached with proper\nsecurity protocols in mind.\n\nThe following security solutions can also protect users from email-based attacks:\n\n**[Trend Micro™ Cloud App Security– Enhances the security of Microsoft Office 365 and other](https://www.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/cloud-app-security.html)**\ncloud services via computer vision and real-time scanning. It also protects organizations from emailbased threats.\n**[Trend Micro™ Deep Discovery™ Email Inspector– Defends users through a combination of](https://www.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/email-inspector.html)**\nreal-time scanning and advanced analysis techniques for known and unknown attacks.\n\n## Indicators of Compromise\n\n Hashes of the malicious encrypted documents:\n\nSHA256 Detection name\n\ndacf7868a71440a7d7d8797caca1aa29b7780801e6f3b3bc33123f16989354b2 Trojan.W97M.CONFUCIUS.A\n\n0f6bcbdf4d192f8273887f9858819dd4690397a92fb28a60bb731c873c438e07 Trojan.W97M.CONFUCIUS.B\n\n508bcc1f3906f5641116cde26b830b43f38f9c68a32b67e03a3e7e3f920b1f4a Trojan.W97M.CONFUCIUS.B\n\n654c7021a4482da21e149ded58643b279ffbce66badf1a0a7fc3551acd607312 Trojan.W97M.CONFUCIUS.C\n\n712172b5b1895bbfcced961a83baa448e26e93e301be407e6b9dc8cb6526277f Trojan.Win32.DLOADR.TIOIBELQ\n\nURLs/Domains/IP Addresses\n\n**Server hosting malicious documents**\n\nparinari[.]xyz\n\n**Server used for file exfiltration**\n\npirnaram[.]xyz\n\n|SHA256|Detection name|\n|---|---|\n|dacf7868a71440a7d7d8797caca1aa29b7780801e6f3b3bc33123f16989354b2|Trojan.W97M.CONFUCIUS.A|\n|0f6bcbdf4d192f8273887f9858819dd4690397a92fb28a60bb731c873c438e07|Trojan.W97M.CONFUCIUS.B|\n|508bcc1f3906f5641116cde26b830b43f38f9c68a32b67e03a3e7e3f920b1f4a|Trojan.W97M.CONFUCIUS.B|\n|654c7021a4482da21e149ded58643b279ffbce66badf1a0a7fc3551acd607312|Trojan.W97M.CONFUCIUS.C|\n|712172b5b1895bbfcced961a83baa448e26e93e301be407e6b9dc8cb6526277f|Trojan.Win32.DLOADR.TIOIBELQ|\n\n\n-----\n\n**Domain names linked to other campaigns**\n\npemra[.]email\n\nispr[.]email\n\nfbr[.]news\n\ndefencepk[.]email\n\npakistanarmy[.]email\n\npmogovpk[.]email\n\nmailerservice[.]directory\n\nfile-dnld[.]com\n\nfuntifu[.]live\n\ncnic-update[.]com\n\ncnic-ferify[.]live\n\nfbr-update[.]com\n\ndownload.fbr[.]tax\n\nsupport-team[.]tech\n\napi.priveetalk[.]com\n\nSender email addresses\n\nlatest_info@fbr.news\n\nnotice@fbr.news\n\nalert@fbr.news\n\nthenewsinernational@mailerservice.directory\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2021/2021.08.17.Confucius_Pegasus/Confucius%20Uses%20Pegasus%20Spyware-related%20Lures%20to%20Target%20Pakistani%20Military.pdf"
    ],
    "report_names": [
        "Confucius Uses Pegasus Spyware-related Lures to Target Pakistani Military"
    ],
    "threat_actors": [
        {
            "id": "caf95a6f-2705-4293-9ee1-6b7ed9d9eb4c",
            "created_at": "2022-10-25T15:50:23.472432Z",
            "updated_at": "2025-03-27T02:00:55.479021Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [
                "Confucius",
                "Confucius APT"
            ],
            "source_name": "MITRE:Confucius",
            "tools": [
                "WarzoneRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "732bfd4b-8c15-42a5-ac4b-14a9a4b902e9",
            "created_at": "2022-10-25T16:07:23.38079Z",
            "updated_at": "2025-03-27T02:02:09.771357Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "ETDA:Bahamut",
            "tools": [
                "Bahamut",
                "DownPaper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "37714790-40c0-4b6b-8e49-1c8f45a0463f",
            "created_at": "2022-10-25T16:07:24.37091Z",
            "updated_at": "2025-03-27T02:02:10.196909Z",
            "deleted_at": null,
            "main_name": "Urpage",
            "aliases": [],
            "source_name": "ETDA:Urpage",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f99641e0-2688-47b0-97bc-7410659d49a0",
            "created_at": "2023-01-06T13:46:38.802141Z",
            "updated_at": "2025-03-27T02:00:02.922907Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "MISPGALAXY:Bahamut",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ada9e5d3-1cb2-4b70-a3c8-96808c304ac8",
            "created_at": "2022-10-25T15:50:23.6515Z",
            "updated_at": "2025-03-27T02:00:55.513513Z",
            "deleted_at": null,
            "main_name": "Windshift",
            "aliases": [
                "Windshift",
                "Bahamut"
            ],
            "source_name": "MITRE:Windshift",
            "tools": [
                "WindTail"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7a8dbc5e-51a8-437a-8540-7dcb1cc110b8",
            "created_at": "2022-10-25T16:07:23.482856Z",
            "updated_at": "2025-03-27T02:02:09.827887Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [],
            "source_name": "ETDA:Confucius",
            "tools": [
                "ApacheStealer",
                "ByeByeShell",
                "ChatSpy",
                "Confucius",
                "MY24",
                "Sneepy",
                "remote-access-c3",
                "sctrls",
                "sip_telephone",
                "swissknife2"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8fddd571-37dc-4bb2-84b4-e41ac6fd11f5",
            "created_at": "2024-02-08T02:00:04.32487Z",
            "updated_at": "2025-03-27T02:00:03.329395Z",
            "deleted_at": null,
            "main_name": "Urpage",
            "aliases": [],
            "source_name": "MISPGALAXY:Urpage",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041706,
    "ts_creation_date": 1646188011,
    "ts_modification_date": 1646188011,
    "files": {
        "pdf": "https://archive.orkl.eu/8aa09365daf1885aba46f3f46d07582ae06754d9.pdf",
        "text": "https://archive.orkl.eu/8aa09365daf1885aba46f3f46d07582ae06754d9.txt",
        "img": "https://archive.orkl.eu/8aa09365daf1885aba46f3f46d07582ae06754d9.jpg"
    }
}