{
    "id": "63a7f4b9-538f-453d-9ad9-f240edf204e5",
    "created_at": "2023-01-12T15:00:12.350679Z",
    "updated_at": "2025-03-27T02:10:49.42517Z",
    "deleted_at": null,
    "sha1_hash": "b453a778c1b177a6d3088a62c8fca791c0da4384",
    "title": "2019-05-03 - Mirrorthief Group Uses Magecart Skimming Attack to Hit Hundreds of Campus Online Stores in US and Canada",
    "authors": "",
    "file_creation_date": "2022-05-27T22:34:16Z",
    "file_modification_date": "2022-05-27T22:34:16Z",
    "file_size": 159071,
    "plain_text": "# Mirrorthief Hits Campus Online Stores Using Magecart\n\n**blog.trendmicro.com/trendlabs-security-intelligence/mirrorthief-group-uses-magecart-skimming-attack-to-hit-hundreds-of-campus-online-**\nstores-in-us-and-canada/\n\nMay 3, 2019\n\nWe uncovered a recent activity involving the notorious online credit card skimming attack known as\n[Magecart. The attack, facilitated by a new cybercrime group, impacted 201 online campus stores in the](https://blog.trendmicro.com/trendlabs-security-intelligence/new-magecart-attack-delivered-through-compromised-advertising-supply-chain/)\nUnited States and Canada.\n\nWe started detecting the attacks against multiple campus store websites on April 14, during which the sites\nwere injected with a malicious skimming script (detected by Trend Micro as Trojan.JS.MIRRORTHEIF.AA) at\ntheir payment checkout pages. The skimming script can scrape credit card information, as well as personal\ndetails entered on the payment page. The stolen information is consequently sent to a remote server. After\n[looking into this attack, we learned that the attackers compromised PrismWeb, which is an e-commerce](https://prismrbsdotcom.azureedge.net/wp-content/uploads/2018/09/PW_ER.pdf)\n[platform designed for college stores by company PrismRBS, a subsidiary of Nebraska Book Company.](https://www.prismrbs.com/)\n\nThe attacker injected their skimming script into the shared JavaScript libraries used by online stores on the\nPrismWeb platform. We confirmed that their scripts were loaded by 201 campus book and merchandise\nonline stores, which serves 176 colleges and universities in the U.S. and 21 in Canada. The amount of\npayment information that was stolen is still unknown.\n\nWe disclosed our findings to PrismRBS. The company has since released an official statement regarding the\nskimming attack: \"On April 26, 2019, PrismRBS became aware that an unauthorized third-party obtained\naccess to some of our customers’ e-commerce websites that PrismRBS hosts. Upon learning of this incident,\nwe immediately took action to halt the current attack, initiated an investigation, engaged an external IT\nforensic firm to assist in our review, notified law enforcement and payment card companies. Our investigation\nis ongoing to determine the scope of the issue, including who and what information may have been impacted.\nBased on our review to date, we have determined that an unauthorized party was able to install malicious\nsoftware designed to capture payment card information on some of our customers’ e-commerce websites.\n\n\n-----\n\nWe are proactively notifying potentially impacted customers to let them know about the incident, the steps we\nare taking to address the situation, and steps they can take to protect their end users. We deeply regret any\nconcern or frustration this incident may cause. Protecting the security and privacy of information remains a\ntop priority. We are taking steps to further strengthen the security of our systems, including enhanced clientside and back-end monitoring tools and a comprehensive end-to-end audit of our systems. Once our\ninvestigation concludes, we will be providing our customers with additional information and guidance.\"\n\nSince we can’t connect the said attack to any previous Magecart groups — even if the attack shared some\nsimilar characteristics with a few of them — we labeled this new group “Mirrorthief”.\n\n[Figure 1. Mirrorthief attack chain](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/05/magecart-mirrorthief-attack-chain-fig-1.jpg)\n\nFigure 1. Mirrorthief attack chain\n\nFigure 2. Payment page of PrismWeb online store loads Mirrorthief’s skimming script\n\nFigure 3. Mirrorthief injection on PrismWeb checkout payment’s library\n\n## How Mirrorthief performs their skimming activities\n\nOn April 14, the attackers injected a script to the payment checkout libraries used by the PrismWeb platform.\nThe location of injected payment checkout libraries on affected online stores were:\n\nhxxps://[online store domain]/innerweb/v4.0/include/js/checkout_payment[.]js\nhxxps://[online store domain]/innerweb/v3.1/include/js/checkout_payment[.]js\n\n[The injected script forged the Google Analytics script format, but loaded a different script from the attackers’](https://developers.google.com/analytics/devguides/collection/analyticsjs/)\nserver. The loaded script is the main script that steals the payment information. Unlike many web skimmers,\nwhich are designed to collect information from many kinds of e-commerce payment pages in general, the\nskimmer that the Mirrorthief group used was designed specifically for PrismWeb’s payment page. The\nskimmer collects data only from HTML elements with the specific IDs on PrismWeb’s payment form. The\nstolen credit card information includes card number, expiry date, card type, card verification number (CVN),\nand the cardholder’s name. The skimmer also steals personal information like addresses and phone numbers\nfor billing.\n\nOnce the user has finished filling in the payment form and clicked on the payment review, the skimmer copies\nthe targeted information into JavaScript Object Notation (JSON) format data and encrypts it with AES\nencryption and Base64 encoding. Next, the skimmer will send it to a remote server by creating an HTML\nimage element, which connects to their URL appended with the encrypted payment information as a query\nstring. The server then receives the skimmed data from the URL’s query string and returns a 1 pixel PNG\npicture.\n\n**HTML Element ID** **Mirrorthief JSON Data Schema** **Information**\n\n_cc_number aa Credit card number\n\n_cc_expmonth bb Credit card expiration month\n\n_cc_expyear cc Credit card expiration year\n\ncc type dd Credit card type\n\n\n-----\n\n_cc_cvn ee Credit card CVN number\n\ncc_first_name ff First name of cardholder\n\ncc_last_name gg Last name of cardholder\n\nbill_to_phone hh Phone number for billing\n\nbill_to_country ii Billing address (country)\n\nbill_to_state jj Billing address (state)\n\nbill_to_street1 kk Billing address (street)\n\nbill_to_street2 ll Billing address (street)\n\nbill_to_city mm Billing address (city)\n\nbill_to_zip nn Billing address (zip code)\n\nTable 1. Sensitive data targeted by Mirrorthief’s skimmer\n\nFigure 4. Mirrorthief skimming script copies payment information and encrypts it with AES encryption\n(deobfuscated)\n\nFigure 4. Mirrorthief skimming script copies payment information and encrypts it with AES encryption\n(deobfuscated)\n\n## Comparing Magecart-wielding groups\n\nThe Mirrorthief group made the injected script on the compromised libraries similar to legitimate Google\nAnalytics script and registered their malicious domain (which also appears similar to the original Google\nAnalytics domain) to disguise their activity. Impersonating the Google Analytics service is a known tactic also\n[used by Magecart Group 11, the group behind the Vision Direct breach. Another group called ReactGet,](https://www.riskiq.com/blog/labs/magecart-vision-direct/)\nwhich infected many e-commerce websites around the world, was also recently seen adopting a similar\nimpersonation tactic.\n\nWhen we checked Mirrorthief’s network infrastructure, we found that it did not have any overlap with any\nknown cybercrime groups. In addition, the skimmer Mirrorthief used in the attack is very different from the\nothers since it’s specially designed to skim PrismWeb’s payment form. It sends the skimmed data through a\nunique JSON schema, which may hint that they use a unique backend data receiver instead of popular\nskimming kits. Moreover, the three groups encrypted the skimmed data before the transfer, but used different\nJavaScript libraries. Below is a table for comparison.\n\n**Group** **Encryption Algorithm** **JavaScript Library**\n\nMagecart Group 11 AES Gibberish-AES\n\nReactGet RSA JSEncrypt\n\nMirrorthief AES Crypto-JS\n\nTable 2. Comparison of encryption algorithms used by the different groups\n\n[Figure 5. Magecart Group 11 injection pattern](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/05/magecart-group-11-injection-fig-5.png)\n\n\n-----\n\nFigure 5. Magecart Group 11 injection pattern\n\n[Figure 6. ReactGet Group injection pattern](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/05/magecart-reactget-injection-fig-6.png)\n\nFigure 6. ReactGet Group injection pattern\n\n[Figure 7. Mirrorthief Group injection pattern](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/05/magecart-mirrorthief-injection-fig-7.png)\n\nFigure 7. Mirrorthief Group injection pattern\n\nMagecart has evolved its tactics and exposed many sites to skimming attacks over the years. Groups that\nemploy this digital attack have been known to come up with new ways to stay undetected on the sites they\ncompromise. To defend against this type of threat, website owners should regularly check and strengthen\ntheir security with patches and server segregation. Site owners should also employ robust authentication\n[mechanisms, especially for those that store and manage sensitive data. IT and security teams should restrict](https://www.trendmicro.com/vinfo/us/security/news/online-privacy/on-the-safe-side-building-better-data-protection-and-steering-clear-of-gdpr-violations)\nor disable outdated components, and habitually monitor websites and applications for any indicators of\nsuspicious activity that could lead to data exfiltration, execution of unknown scripts, or unauthorized access\nand modification.\n\n[The following Trend Micro solutions, powered by XGen™ security, protect users and businesses by blocking](http://go.trendmicro.com/sem/sem/www.trendmicro.com/us/business/xgen/index.html)\nthe scripts and preventing access to the malicious domains:\n\n[Trend Micro™ Security](https://blog.trendmicro.com/en_us/forHome/products.html)\n[Smart Protection Suites and](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) [Worry-Free™ Business Security](https://blog.trendmicro.com/en_us/small-business.html)\n[Trend Micro Network Defense](https://blog.trendmicro.com/en_us/business/products/network.html)\n[Hybrid Cloud Security](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud.html)\n\n## Indicators of Compromise (IoCs)\n\n**Indicator** **Attribution**\n\n30c8be0d9deb59d98f7e047579763559f2c2dd9a7b4477636afcbebaaebc7dc5 Mirrorthief skimming script\nhash (detected as\nTrojan.JS.MIRRORTHEIF.AA)\n\ncloudmetric-analytics[.]com Mirrorthief malicious domain\n\nhxxps://cloudmetric-analytics[.]com/ga[.]js Mirrorthief malicious URL\n\nhxxps://cloudmetric-analytics[.]com/analytics[.]js Mirrorthief malicious URL\n\nhxxps://cloudmetric-analytics[.]com/analytic[.]php?ccm_post= Mirrorthief malicious URL\n\nhxxps://g-analytics[.]com/libs/analytics[.]js Magecart Group 11 malicious\nURL\n\nhxxps://ebitbr[.]com/api[.]js ReactGet Group malicious\nURL\n\n**_With special thanks to our colleagues at_** **_[abuse.ch and](https://abuse.ch/)_** **_[The Shadowserver Foundation for helping with](http://shadowserver.org/)_**\n**_the sinkholing of Mirrothief’s malicious domain and remediation reporting_**\n\nMalware\n\n\n-----\n\nWe uncovered a recent activity involving the notorious online credit card skimming attack known as\nMagecart. The attack, facilitated by a new cybercrime group, impacted 201 online campus stores in the\nUnited States and Canada.\n\nBy: Joseph C Chen May 03, 2019 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-05-03 - Mirrorthief Group Uses Magecart Skimming Attack to Hit Hundreds of Campus Online Stores in US and Canada.pdf"
    ],
    "report_names": [
        "2019-05-03 - Mirrorthief Group Uses Magecart Skimming Attack to Hit Hundreds of Campus Online Stores in US and Canada.pdf"
    ],
    "threat_actors": [
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535612,
    "ts_updated_at": 1743041449,
    "ts_creation_date": 1653690856,
    "ts_modification_date": 1653690856,
    "files": {
        "pdf": "https://archive.orkl.eu/b453a778c1b177a6d3088a62c8fca791c0da4384.pdf",
        "text": "https://archive.orkl.eu/b453a778c1b177a6d3088a62c8fca791c0da4384.txt",
        "img": "https://archive.orkl.eu/b453a778c1b177a6d3088a62c8fca791c0da4384.jpg"
    }
}