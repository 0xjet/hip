{
    "id": "009d3d44-eaee-492e-b414-d51800f200aa",
    "created_at": "2022-10-25T16:48:17.674011Z",
    "updated_at": "2025-03-27T02:17:11.330255Z",
    "deleted_at": null,
    "sha1_hash": "4e645016b3627272cceb28a3b8bbba536eb9a6b4",
    "title": "Pawn Storm Update: Ios Espionage App Found",
    "authors": "Trend Micro",
    "file_creation_date": "2015-02-04T17:14:51Z",
    "file_modification_date": "2015-02-04T17:14:51Z",
    "file_size": 710237,
    "plain_text": "In our continued research on Operation Pawn Storm, we found one interesting poisoned pawn—spyware\n\nspecifically designed for espionage on iOS devices. While spyware targeting Apple users is highly notable\n\nby itself, this particular spyware is also involved in a targeted attack.\n\n**_Background of Operation Pawn Storm_**\n\n[Operation Pawn Storm is an active economic and political cyber-espionage operation that targets a wide](http://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/pawn-storm-espionage-attacks-use-decoys-deliver-sednit)\n\nrange of entities, like the military, governments, defense industries, and the media.\n\nThe actors of Pawn Storm tend to first move a lot of pawns in the hopes they come close to their actual,\n\nhigh profile targets. When they finally successfully infect a high profile target, they might decide to move\n\ntheir next pawn forward: advanced espionage malware.\n\nThe iOS malware we found is among those advanced malware. We believe the iOS malware gets installed\n\non already compromised systems, and it is very similar to next stage SEDNIT malware we have found for\n\nMicrosoft Windows’ systems.\n\nWe found two malicious iOS applications in Operation Pawn Storm. One is called XAgent (detected as\n\nIOS_XAGENT.A) and the other one uses the name of a legitimate iOS game, MadCap (detected as IOS_\n\nXAGENT.B). After analysis, we concluded that both are applications related to SEDNIT.\n\nThe obvious goal of the SEDNIT-related spyware is to steal personal data, record audio, make screenshots,\n\nand send them to a remote command-and-control (C&C) server. As of this publishing, the C&C server\n\ncontacted by the iOS malware is live.\n\n**_Analysis of XAgent_**\n\nThe XAgent app is fully functional malware. After being installed on iOS 7, the app’s icon is hidden and it\n\nruns in the background immediately. When we try to terminate it by killing the process, it will restart\n\nalmost immediately.\n\nInstalling the malware into an iOS 8 device yields different results. The icon is not hidden and it also\n\ncannot restart automatically. This suggests that the malware was designed prior to the release of iOS 8 last\n\nSeptember 2014.\n\n**_Data Theft Capabilities_**\n\nThe app is designed to collect all kind of information on an iOS device. It is able to perform the following\n\nroutines:\n\n\n-----\n\nGet contact lists\n\nGet pictures\n\nCollect geo-location data\n\nStart voice recording\n\nGet a list of installed apps\n\nGet a list of processes\n\nGet the Wi-Fi status\n\n**_C&C Communication_**\n\n\n_Figure 1. XAgent code structure_\n\n\nBesides collecting information from the iOS device, the app sends the information out via HTTP. It uses\n\nPOST request to send messages, and GET request to receive commands.\n\n**_Formatted Log Messages_**\n\nThe malware’s log messages are written in HTML and color coded, making it easier for human operators\n\nto read. Error messages tend to be in red, while others are in green as shown in the figure below.\n\n\n-----\n\n_Figure 2. Color-coded HTML log messages_\n\n**_A Well-Designed Code Structure_**\n\nWe can see that the code structure of the malware is very organized. The malware looks carefully\n\nmaintained and consistently updated.\n\n_Figure 3. XAgent code structure_\n\nThe app uses the commands watch, search, find, results, _open, and close._\n\n_Figure 4. List of base URIs_\n\n**_Randomly Generated URI_**\n\n\n-----\n\ntemplate agreed upon with the C&C server. The base URI can be seen in Figure 4, and parameters are\n\nchosen from the list below and appended to the base URI.\n\n_Figure 5. List of parameters used with URIs_\n\nHere are corresponding implementations we got during our reversing:\n\n_Figures 6 and 7. Code for URI generation_\n\n**_Token Format and Encoding_**\n\nThe malware uses a token to identify which module is communicating. The token is Base64 encoded data,\n\nbut padded with a 5-byte random prefix so that it looks like valid Base64 data. See the first line “ai=” part\n\nin the figure below.\n\n\n-----\n\n_Figure 8. Client (XAgent) request_\n\nReverse engineering also revealed additional communication functions.\n\n_Figure 9. HTTP communication functions_\n\n_Figure 10. C2 server_\n\n**_FTP Communication_**\n\n\n-----\n\n_Figure 11. FTP communication functions_\n\n**_Analysis of “MadCap”_**\n\n“Madcap” is similar to the XAgent malware, but the former is focused on recording audio. “Madcap”\n\ncan only be installed on jailbroken devices.\n\n_Figure 12. Code structure of Madcap_\n\n**_Possible Infection Methods_**\n\n\n-----\n\ndoesn t have to be jailbroken per se. We have seen one instance wherein a lure involving XAgent simply\n\nsays “Tap Here to Install the Application.” The app uses Apple’s ad hoc provisioning, which is a standard\n\ndistribution method of Apple for iOS App developers. Through ad hoc provisioning, the malware can be\n\ninstalled simply by clicking on a link, such as in the picture below. The link will lead to https://www.\n\n_{BLOCKED}/adhoc/XAgent.plist, a service that installs applications wirelessly._\n\n_Figure 13. Site used in downloading XAgent_\n\nThere may be other methods of infection that are used to install this particular malware. One possible\n\n[scenario is infecting an iPhone after connecting it to a compromised or infected Windows laptop via a USB](http://blog.trendmicro.com/trendlabs-security-intelligence/the-other-side-of-masque-attacks-data-encryption-not-found-in-ios-apps/)\n\ncable.\n\n_To learn more about this campaign, you may refer to our report, Operation Pawn Storm Using Decoys_\n\n_to Evade Detection._\n\nThe hashes of the related files are:\n\n05298a48e4ca6d9778b32259c8ae74527be33815\n\n176e92e7cfc0e57be83e901c36ba17b255ba0b1b\n\n30e4decd68808cb607c2aba4aa69fb5fdb598c64\n\n**_Special thanks to Loucif Kharouni and Fernando Merces for additional insights._**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/9b7dfetwel6ywbcfai2wa0ja20cym721",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.02.04.Pawn_Storm_Update_iOS_Espionage/PawnStorm_iOS.pdf"
    ],
    "report_names": [
        "PawnStorm_iOS"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1423070091,
    "ts_modification_date": 1423070091,
    "files": {
        "pdf": "https://archive.orkl.eu/4e645016b3627272cceb28a3b8bbba536eb9a6b4.pdf",
        "text": "https://archive.orkl.eu/4e645016b3627272cceb28a3b8bbba536eb9a6b4.txt",
        "img": "https://archive.orkl.eu/4e645016b3627272cceb28a3b8bbba536eb9a6b4.jpg"
    }
}