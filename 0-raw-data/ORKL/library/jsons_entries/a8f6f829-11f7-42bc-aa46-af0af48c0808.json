{
    "id": "a8f6f829-11f7-42bc-aa46-af0af48c0808",
    "created_at": "2023-01-12T15:08:54.673294Z",
    "updated_at": "2025-03-27T02:05:33.437401Z",
    "deleted_at": null,
    "sha1_hash": "19a804af2d39aa0781369a97b6a5a2cbebacdcbc",
    "title": "2014-05-22 - Meet the Zberp Trojan",
    "authors": "",
    "file_creation_date": "2022-05-28T21:44:28Z",
    "file_modification_date": "2022-05-28T21:44:28Z",
    "file_size": 729284,
    "plain_text": "# New Trojan in Town: Meet the Zberp Trojan\n\n**[securityintelligence.com/new-zberp-trojan-discovered-zeus-zbot-carberp/](https://securityintelligence.com/new-zberp-trojan-discovered-zeus-zbot-carberp/)**\n\n[Advanced Threats May 22, 2014](https://securityintelligence.com/category/x-force/threats/)\n\n\nMay 22, 2014\n\n\n-----\n\nBy [Dana Tamir 4 min read](https://securityintelligence.com/author/dana-tamir/)\n\n## A New Trojan in Town: Meet Zberp\n\nTrusteer researchers recently discovered a new Trojan that has been targeting more than\n450 financial institutions around the world, mainly in the U.S., U.K. and Australia. The new\nTrojan, which seems to be a variant of the well-known Zeus Trojan (a.k.a. Zbot), also\ndemonstrates behaviors associated with the Carberp Trojan family. Therefore, we named it\nthe Zberp Trojan.\n\n[According to an analysis conducted by Trusteer researchers Martin G. Korman and](https://securityintelligence.com/author/martin-korman/) Tal\nDarsan, the Trojan seems to have been assembled from the leaked source code of two wellknown Trojans: Zeus and Carberp. The Zeus source code was exposed to the public in 2011,\nand it is already used by some criminal groups that customize its behavior and develop new\n[features. The Carberp source code was offered for sale last year.](https://www.trusteer.com/blog/carberp-source-code-for-sale-free-bootkit-included)\n\n“Since the source code of the Carberp Trojan was leaked to the public, we had a theory that\nit won’t take cyber criminals too long to combine the Carberp source code with the Zeus\ncode and create an evil monster,” explained Korman and Darsan. “It was only a theory, but a\nfew weeks ago we found samples of the ‘Andromeda’ botnet that were downloading the\nhybrid beast.”\n\nThe new Zberp Trojan, a variant of the Zeus VM Trojan, enables cyber criminals to grab\nbasic information about the infected computer, including the Computer name, IP and more. It\ncan take screen shots and send them to the attacker. It steals data submitted in HTTP forms,\nuser SSL certificates and even FTP and POP account credentials. The Zberp Trojan also\nincludes optional features that enable Web injections, dynamic Web injections, MITB/MITM\nattacks and VNC/RDP connections.\n\nIn addition to its malicious capabilities, the Zberp Trojan uses a combination of evasion\ntechniques that it inherited from both the Zeus and the Carberp Trojans.\n\nZberp uses an “invisible persistence” feature that is has been used by the Zeus VM variant:\nthe malware deletes its persistence key from the registry during the Windows startup process\nto prevent security solutions from detecting it during normal system scans that take place\nafter the system boots. To ensure persistency, however, the malware rewrites the persistence\nkey back to the registry during system shutdown.\n\nThe Trojan also disguises the configuration code in an image file through steganography, a\ntechnique used by malware authors to embed code in a file format that looks legitimate and\nbypasses malware detection solutions.\n\n\n-----\n\nheader of the configuration image\n\nimage\n\n\nFigure 1: The\n\nFigure 2: The configuration is disguised in an “Apple”\n\nFigure 3: The\n\n\nbase64 encoded configuration hidden within the image\n\nThe Carberp source code contribution to the Zberp Trojan can be seen in its “hooking”\ntechnique, commonly used by malware developers to control the browser, grab key strokes\nand steal information. It also keeps the malware “invisible,” evading detection by anti-virus\nand anti-malware tools.\n\n\n-----\n\nThe figure below shows that the hook is implemented in the same place, but its\nimplementation is slightly different: The push instruction highlighted in the Carberp code (on\nthe left) was changed by one byte in the Zberp code (on the right), and a ‘mov’ instruction\nwas added to it. These changes ensure that even security solutions capable of detecting\nCarberp variants will not identify the new code.\n\nFigure 4: Comparison between Carberp and Zberp hooks\n\nAnother evasion technique that has been embedded in the Zberp Trojan is the use of SSL,\nwhich secures the communications with the Command and Control server and evades\ndetection by network security products.\n\nAccording to a Virus-Total scan, the Zberp Trojan was able to evade most anti-virus solutions\nwhen it was first detected. Trusteer’s endpoint protection solutions, which do not require prior\nknowledge about emerging threats in order to stop them, detected and removed the Zberp\nTrojan immediately — on ‘day zero.’\n\nHow Trusteer Customers Are Protected\n\n## Trusteer Customers Are Protected!\n\nTrusteer, an IBM company, is the leading provider of endpoint cyber crime prevention.\nTrusteer solutions combine multi-layer defenses with real-time threat intelligence to achieve\nsustainable protection against malware and targeted attacks.\n\n**Preventing Enterprise Breach**\n\n[Trusteer Apex protects enterprise endpoints by preventing infections via the exploitation of](https://www.trusteer.com/products/trusteer-apex)\nvulnerabilities in endpoint applications. In addition, it detects, mitigates and removes Zberp\n(and other Zeus variants) from infected user devices. No product update is needed.\n\n**Preventing Online Financial Fraud**\n\n[Trusteer Rapport protects customer endpoints by detecting, mitigating and removing Zberp](https://www.ibm.com/us-en/marketplace/phishing-and-malware-protection)\n(and other Zeus variants) from infected devices. No product update is needed.\n\n[Trusteer Pinpoint Malware Detection can identify and warn organizations of malware-infected](https://www.ibm.com/us-en/marketplace/trusteer-pinpoint-detect)\ndevices that attempt to log in and transact with their website. No product update is needed.\n\n\n-----\n\n[Dana Tamir](https://securityintelligence.com/author/dana-tamir/)\nDirector of Enterprise Security at Trusteer, an IBM Company\n\nDana Tamir is Director of Enterprise Security at Trusteer, an IBM Company. In her role she\nleads activities related to enterprise advanced threat protection ...\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-05-22 - Meet the Zberp Trojan.pdf"
    ],
    "report_names": [
        "2014-05-22 - Meet the Zberp Trojan.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536134,
    "ts_updated_at": 1743041133,
    "ts_creation_date": 1653774268,
    "ts_modification_date": 1653774268,
    "files": {
        "pdf": "https://archive.orkl.eu/19a804af2d39aa0781369a97b6a5a2cbebacdcbc.pdf",
        "text": "https://archive.orkl.eu/19a804af2d39aa0781369a97b6a5a2cbebacdcbc.txt",
        "img": "https://archive.orkl.eu/19a804af2d39aa0781369a97b6a5a2cbebacdcbc.jpg"
    }
}