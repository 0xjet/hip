{
    "id": "e62ce398-300a-4afc-8fe9-ddb7937d1a1b",
    "created_at": "2023-01-12T15:00:21.070253Z",
    "updated_at": "2025-03-27T02:05:37.879539Z",
    "deleted_at": null,
    "sha1_hash": "0d600ce631b4e5ab6e375a814c371fe865cd21e3",
    "title": "2016-09-23 - Dissecting a Hacktivist’s DDoS Tool- Saphyra Revealed",
    "authors": "",
    "file_creation_date": "2022-05-28T15:50:54Z",
    "file_modification_date": "2022-05-28T15:50:54Z",
    "file_size": 954536,
    "plain_text": "# Dissecting a Hacktivist's DDoS Tool: Saphyra Revealed\n\n**securityintelligence.com/dissecting-hacktivists-ddos-tool-saphyra-revealed/**\n\nSeptember 23, 2016\n\n[Advanced Threats September 23, 2016](https://securityintelligence.com/category/x-force/threats/)\nBy [Dave McMillen 4 min read](https://securityintelligence.com/author/david-mcmillen/)\n[Distributed denial-of-service (DDoS) attacks have been all over the news in recent months, with hacktivist groups taking major targets](https://securityintelligence.com/hacktivism-fearmongering-or-real-threat/)\ncompletely offline. According to IBM Managed Security Services data, the vast majority of DDoS attacks come in one of two flavors: SYN flood\nattacks, in which bad actors send multiple SYN requests to a victim’s webserver in an attempt to consume enough resources to render the\nsystem unresponsive, and UDP/DNS attacks on network layers 3 (network) and 4 (transport), also known as reflection attacks.\n\n\n-----\n\nWe know, however, that attackers are constantly tweaking their techniques. With this in mind, we decided to take a look at a newer DDoS\n[tactic. The tool in question, dubbed the Saphyra iDDoS Priv8 Tool, targets network layer 7 (application) and results in an HTTP flood DDoS](https://www.youtube.com/watch?v=NpgPkrdwFkw)\nattack. This tool was responsible for taking down the NASA website earlier this year, according to [Yahoo Tech. Other modifications of this tool](https://www.yahoo.com/tech/watch-anonymous-down-slew-brazilian-171500088.html)\nare called Sadattack, Thor and Hulk.\n\n## What Is an HTTP Flood Attack?\n\nAn HTTP flood attack is a type of layer 7 application attack that utilizes the standard, valid GET/POST requests used to fetch information, as\nin typical URL data retrievals, during SSL sessions. An HTTP GET/POST flood is a volumetric attack that does not use malformed packets,\nspoofing or reflection techniques.\n\n## How Saphyra Works\n\nThe Saphyra iDDoS tool is a Python script that can be run on virtually any device, including mobile phones. Let’s take a look at this relatively\nsimple script to understand how it operates and why it is hard to defend against.\n\n_Figure 1. Saphyra iDDoS Tool Command Line Interface_\n\n\n-----\n\n_Figure 2. Saphyra iDDoS Tool script header_\n\nThe script contains over 3,200 unique user agent strings and over 300 unique referrer field strings. This would allow for more than 1 million\npossible combinations of user agent string/referrer instances. When the tool is executed, a unique combination is sent in the form of HTTP\nrequests to the victim’s website.\n\nIts main purpose is to generate unique requests, avoiding or bypassing caching engines and directly impacting the server load. This can result\nin website failure as the server becomes quickly overwhelmed by the volume of requests. The tool interface boasts an affiliation with almost\n1.8 billion bots, but this could not be confirmed at the time of analysis.\n\n## The Tool’s Techniques\n\nThe Saphyra tool operates using a variety of techniques, including:\n\nObfuscation of source client: By using a list of known user agents, the user agent is constructed as a random value out of the known list.\nReferer spoofing: This enables the sending of incorrect referer information in an HTTP request to prevent a website from obtaining\naccurate data on the identity of the webpage previously visited by the user.\nPersistence: The tool uses standard HTTP commands to force the server to maintain open connections by using keep-alives with\ndefinable time window.\nNo cache: By requesting the HTTP server for no cache, the sever presents a unique page for each request.\n\n\n-----\n\n_Figure 3. Example of user agent strings in script_\n\n\n-----\n\n_Figure 4. Example of referer strings in the script_\n\nBelow is what the traffic looks like. Note the random GET request as well as user agent/referrer fields.\n\nGET /?.o.=Uc.z^.P].. HTTP/1.1Accept-Encoding: identityHost: victim.comKeep-Alive: 113User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X; de-de) AppleWebKit/418 (KHTML, like Gecko) Shiira/1.2.2 Safari/125Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7Connection: closeReferer: http://techtv.mit.edu/search?q=SZCqT.U]..y`y.U.d..n.cMU.Bjf.Ugjt\\SyjT\\z.d.A^qX…{…Z…d.DCache-Control: no-cache\n\nGET /?Ch.Bg^=.r.J HTTP/1.1\nAccept-Encoding: identity\nHost: victim.com\nKeep-Alive: 141\nUser-Agent: Mozilla/5.0 (Windows; U; MSIE 7.0; Windows NT 6.0; en-US)\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nConnection: close\nReferer: http://www.google.com/?q=~o~.Es..Te…y^F.j….wCB~Lta..`N}..FlJ.Mqom`..E.Qyn|.{GM.XhzN.Fx..C.P.G\\[r..VM…zoo.`..p..m.\nCache-Control: no-cache\n\nGET /?IVC=sGQj.ck HTTP/1.1Accept-Encoding: identityHost: victim.comKeep-Alive: 130User-Agent: Lynx/2.8.6rel.4 libwww-FM/2.14 SSL-MM/1.4.1 OpenSSL/0.9.8gAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7Connection: closeReferer: http://millercenter.org/search?q=DRn}W.}q.H.w.~.QImfZb.H.H.oBU|L.N.aBG[…X.^rmumr.w.F…ZD..Vf|akaPhSs..Kj^.I..SYtbH.dUp..mCache-Control: no-cache\n\nThe figure below shows a small snapshot of traffic while executing the tool. We were able to generate over 7,500 individual connections per\nsecond against a test server in our lab.\n\n\n-----\n\n_Figure 5. View of traffic in Wireshark depicting randomized HTTP GET requests_\n\n## Mitigation Methods\n\nHTTP flood attacks are some of the most advanced nonvulnerability threats being perpetrated against web servers today. It is difficult for\nnetwork security endpoints to distinguish between legitimate and malicious web traffic. This could create a high number of false-positive alerts.\nAdditionally, rate-based detection engines are incapable of detecting HTTP flood attacks when the traffic volume of HTTP floods is under\ndetection thresholds.\n\nThe Saphyra tool is designed to prevent server defenses from recognizing a pattern and filtering the attack traffic. There are, however, some\ntactics that can be deployed to both an IPS and to the web server itself.\n\nFirst, consider using a rewrite modification on NGINX. In /etc/nginx/conf.d/default.conf or similar, add the following inside the server block:\n\nif ($args ~* “(.{1,})=(.{1,})” ){rewrite ^/$ /444_rewrite?;}\n\nreturn 444;[location /444_rewrite {]}\n\n\n-----\n\nThe regex argument (.{1,}) (.{1,}) tells Nginx to redirect all GET requests that have any characters with between them and redirect them to\n444 (No Response).\n\nThe example GET request below shows the equal sign that is common to all requests:\n\nGET /?uQQ[oKYF%7DH=TPTYKsO%257D%257E%255C HTTP/1.1\n\nThis tactic can be used on other web platforms as well. Consult your server documentation for instructions to create a rewrite mod.\n\n## Distinguishing Between Legitimate and Malicious Traffic\n\nWith some DDoS attacks, it’s difficult to determine what traffic is legitimate and what is malicious. The best defense is a comprehensive\nincident response plan, including failovers and a methodology for identifying, analyzing and neutralizing the threat. As a secondary tactic,\n[consider a managed security solution that deflects and absorbs DDoS traffic before it reaches the target.](https://www.ibm.com/security/services/managed-security-services/)\n\n[Dave McMillen](https://securityintelligence.com/author/david-mcmillen/)\nSenior Threat Researcher, IBM X-Force\n\nDave brings over 25 years of network security knowledge to IBM. Dave began his career in IBM over 15 years ago where he was part of a\ncore team of six IBMers...\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-09-23 - Dissecting a Hacktivist’s DDoS Tool- Saphyra Revealed.pdf"
    ],
    "report_names": [
        "2016-09-23 - Dissecting a Hacktivist’s DDoS Tool- Saphyra Revealed.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535621,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1653753054,
    "ts_modification_date": 1653753054,
    "files": {
        "pdf": "https://archive.orkl.eu/0d600ce631b4e5ab6e375a814c371fe865cd21e3.pdf",
        "text": "https://archive.orkl.eu/0d600ce631b4e5ab6e375a814c371fe865cd21e3.txt",
        "img": "https://archive.orkl.eu/0d600ce631b4e5ab6e375a814c371fe865cd21e3.jpg"
    }
}