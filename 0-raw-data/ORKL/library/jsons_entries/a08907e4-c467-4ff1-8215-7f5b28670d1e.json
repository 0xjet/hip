{
    "id": "a08907e4-c467-4ff1-8215-7f5b28670d1e",
    "created_at": "2023-01-12T15:01:24.991303Z",
    "updated_at": "2025-03-27T02:11:53.067557Z",
    "deleted_at": null,
    "sha1_hash": "0a3afe8875a5ab846e787bcb22186c4187da5f01",
    "title": "2019-12-12 - GALLIUM- Targeting global telecom",
    "authors": "",
    "file_creation_date": "2022-06-18T23:17:29Z",
    "file_modification_date": "2022-06-18T23:17:29Z",
    "file_size": 281632,
    "plain_text": "# GALLIUM: Targeting global telecom\n\n**[microsoft.com/security/blog/2019/12/12/gallium-targeting-global-telecom/](https://www.microsoft.com/security/blog/2019/12/12/gallium-targeting-global-telecom/)**\n\nDecember 12, 2019\n\nMicrosoft Threat Intelligence Center (MSTIC) is raising awareness of the ongoing activity by\na group we call GALLIUM, targeting telecommunication providers. When Microsoft\ncustomers have been targeted by this activity, we notified them directly with the relevant\ninformation they need to protect themselves. By sharing the detailed methodology and\nindicators related to GALLIUM activity, we’re encouraging the security community to\nimplement active defenses to secure the broader ecosystem from these attacks.\n\nTo compromise targeted networks, GALLIUM target unpatched internet-facing services using\npublicly available exploits and have been known to target vulnerabilities in WildFly/JBoss.\nOnce persistence is established in a network, GALLIUM uses common techniques and tools\nlike Mimikatz to obtain credentials that allows for lateral movement across the target network.\nWithin compromised networks, GALLIUM makes no attempt to obfuscate their intent and are\nknown to use common versions of malware and publicly available toolkits with small\nmodifications. The operators rely on low cost and easy to replace infrastructure that consists\nof dynamic-DNS domains and regularly reused hop points.\n\nThis activity from GALLIUM has been identified predominantly through 2018 to mid-2019.\nGALLIUM is still active; however, activity levels have dropped when compared to what was\npreviously observed.\n\nFollowing Microsoft’s internal practices of assigning chemical elements to activity groups,\nGALLIUM is the code name for this activity group.\n\n## GALLIUM’s profile\n\n**Reconnaissance methods**\n\nAs is often the case with the reconnaissance methods, it’s difficult to be definitive about\nthose employed by GALLIUM. This is due to the passive nature of reconnaissance activities\nby the actor including the use of freely available data from open sources, such as public\nwebsites and social media outlets. However, based on MSTIC analyst assessments,\nGALLIUM’s exploitation of internet-facing services indicates it’s likely they use open source\nresearch and network scanning tools to identify likely targets.\n\n## Delivery and exploitation\n\nTo gain initial access a target network, GALLIUM locates and exploits internet-facing\nservices such as web servers. GALLIUM has been observed exploiting unpatched web\nservices, such as WildFly/JBoss, for which exploits are widely available. Compromising a\n\n\n-----\n\nweb server gives GALLIUM a foothold in the victim network that doesn t require user\ninteraction, such as traditional delivery methods like phishing.\n\n[Following exploitation of the web servers, GALLIUM actors typically install web shells, and](https://attack.mitre.org/techniques/T1100/)\nthen install additional tooling to allow them to explore the target network.\n\n**Lateral movement**\n\nGALLIUM uses a variety of tools to perform reconnaissance and move laterally within a\ntarget network. The majority of these are off-the-shelf tools or modified versions of known\nsecurity tools. MSTIC investigations indicate that GALLIUM modifies its tooling to the extent\nit evades antimalware detections rather than develop custom functionality. This behavior has\nbeen observed with GALLIUM actors across several operational areas.\n\nGALLIUM has been observed using several tools. Samples of the most prevalent are noted\nin Table 1.\n\n**Tool** **Purpose**\n\n[HTRAN](https://attack.mitre.org/software/S0040/) Connection bouncer to proxy connections.\n\n[Mimikatz](https://attack.mitre.org/software/S0002/) Credential dumper.\n\n[NBTScan](https://sectools.org/tool/nbtscan/) Scanner for open NETBIOS nameservers on a local or\nremote TCP/IP network.\n\nNetcat Reads from and writes to network connections using TCP or\nUDP protocols.\n\n[PsExec](https://docs.microsoft.com/en-us/sysinternals/downloads/psexec) Executes a command line process on a remote machine.\n\n\nWindows Credential\nEditor (WCE)\n\n\nCredential dumper.\n\n\nWinRAR Archiving utility.\n\n_Table 1: GALLIUM tooling._\n\nGALLIUM has signed several tools using stolen code signing certificates. For example,\nthey’ve used a credential dumping tool signed using a stolen certificate from Whizzimo, LLC,\nas shown in Figure 1. The code signing certificate shown in Figure 1 was no longer valid at\nthe time of writing; however, it shows GALLIUM had access to such certificates.\n\n\n-----\n\n_Figure 1. Credential dumping tool signed using a stolen Whizzimo, LLC certificate._\n\nGALLIUM primarily relies on compromised domain credentials to move through the target\nnetwork, and as outlined above, uses several credential harvesting tools. Once they have\nacquired credentials, the activity group uses PsExec extensively to move laterally between\nhosts in the target network.\n\n**Installation**\n\nGALLIUM predominantly uses widely available tools. In certain instances, GALLIUM has\nmodified these tools to add additional functionality. However, it’s likely these modifications\nhave been made to subvert antimalware solutions since much of the malware and tooling\nemployed by GALLIUM is historic and is widely detected by security products. For example,\n[QuarkBandit is a modified version of the widely used Gh0st RAT, an openly available remote](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Win32/QuarkBandit.A!dha)\naccess tool (RAT). Similarly, GALLIUM has made use of a modified version of the widely\n[available Poison Ivy RAT. These RATs and the](https://www.cyber.nj.gov/threat-profiles/trojan-variants/poison-ivy) [China Chopper web shell form the basis of](https://attack.mitre.org/software/S0020/)\nGALLIUM’s toolkit for maintaining access to a victim network.\n\n**Infrastructure**\n\nGALLIUM predominantly uses dynamic DNS subdomains to provide command and control\n(C2) infrastructure for their malware. Typically, the group uses the ddns.net and myftp.biz\ndomains provided by noip.com. MSTIC analysis indicates the use of dynamic DNS providers\nas opposed to registered domains is in line with GALLIUM’s trend towards low cost and low\neffort operations.\n\nGALLIUM domains have been observed hosted on infrastructure in mainland China, Hong\nKong SAR, and Taiwan.\n\nWhen connecting to web shells on a target network GALLIUM has been observed employing\nTaiwan-based servers. Observed IP addresses appear to be exclusive to GALLIUM, have\nlittle to no legitimate activity and are reused in multiple operations These servers provide\n\n\n-----\n\nhigh fidelity pivot points during an investigation.\n\nA package of GALLIUM indicators containing GALLIUM command and control domains used\n[during this operation have been prepared for Azure Sentinel and is available on the Microsoft](https://azure.microsoft.com/en-us/services/azure-sentinel/)\nGitHub.\n\n_Figure 2. Azure Sentinel query of GALLIUM indicators._\n\n## GALLIUM use of malware\n\n**First stage**\n\nGALLIUM does not typically use a traditional first stage installer for their malware. Instead,\nthe group relies heavily on web shells as a first method of persistence in a victim network\nfollowing successful exploitation. Subsequent malware is then delivered through existing web\nshell access.\n\n\n-----\n\nMicrosoft Defender Advanced Threat Protection (ATP) exposes anomalous behavior that\nindicate web shell installation and post compromise activity by analysing script file writes and\n[process executions. Microsoft Defender ATP offers a number of detections for web shell](https://www.microsoft.com/en-us/microsoft-365/windows/microsoft-defender-atp)\nactivity protecting customers not just from GALLIUM activity but broader web shell activity\n[too. Read the full report in your Microsoft Defender ATP portal.](https://securitycenter.windows.com/threatanalytics2/52fd70be-ec19-48d7-84e8-dfb7a0ed7123)\n\n_Figure 3. Microsoft Defender ATP web shell detection._\n\nWhen alerted of these activities, the security operations team can then use the rich\ncapabilities in Microsoft Defender ATP to investigate web shell activity and subsequent\nreconnaissance and enumeration activity to resolve web shell attacks.\n\n\nImage showing a Microsoft\nDefender ATP web shell process\ntree.\n\n\n_Figure 4. Microsoft Defender ATP web shell process tree._\n\n\n-----\n\n[In addition to standard China Chopper, GALLIUM has been observed using a native web](https://attack.mitre.org/software/S0020/)\nshell for servers running Microsoft IIS that is based on the China Chopper web shell;\nMicrosoft has called this “BlackMould.”\n\nBlackMould contains functionality to perform the following tasks on a victim host:\n\nEnumerate local drives.\nEmploy basic file operations like find, read, write, delete, and copy.\nSet file attributes.\nExfiltrate and infiltrate files.\nRun cmd.exe with parameters.\n\nCommands are sent in the body of HTTP POST requests.\n\n**Second stage**\n\nIn cases where GALLIUM has deployed additional malware on a victim network, they’ve\n[used versions of the Gh0st RAT (modified Ghost RAT detected as QuarkBandit) and Poison](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Win32/QuarkBandit.A!dha)\nIvy malware. In both cases, GALLIUM has modified the communication method used by the\nmalware, likely to prevent detection through existing antimalware signatures since both\nmalware families have several detections based on their original communication methods.\nMalware families are noted in Table 2.\n\n\n**Malware**\n**family**\n\n\n**Description and primary usage**\n\n\n[BlackMould](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan%3aWin32%2fChopper.A) Native IIS web shell based on the China Chopper web shell.\n\n\nChina\nChopper\n\n[Poison Ivy](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?name=Win32/Poison)\n(modified)\n\n\nCommonly used and widely shared web shell used by several threat actors.\nNot unique to GALLIUM.\n\nPoison Ivy is a widely shared remote access tool (RAT) first identified in\n2005. While Poison Ivy is widely used, the variant GALLIUM has been\nobserved using is a modified version that appears to be unique to\nGALLIUM.\n\n\nQuarkBandit Gh0st RAT variant with modified configuration options and encryption.\n\n_Table 2. GALLIUM malware families._\n\nGALLIUM’s malware and tools appear to be highly disposable and low cost. In cases where\nGALLIUM has invested in modifications to their toolset, they appear to focus on evading\nantimalware detection, likely to make the malware and tooling more effective.\n\nThe MSTIC team works closely with Microsoft security products to implement detections and\nprotections for GALLIUM malware and tooling in a number of Microsoft products. Figure 4\nshows one such detection for a GALLIUM PoisonIvy loader in Microsoft Defender ATP.\n\n\n-----\n\n_Figure 5. GALLIUM PoisonIvy loader in Microsoft Defender ATP._\n\nAdditionally, MSTIC has authored a number of antimalware signatures for Windows Defender\nAntivirus covering the aforementioned malware families, a list of GALLIUM exclusive\nsignature can be found in the Related indicators” section.\n\nIn addition to these malware families, GALLIUM has been observed employing SoftEther\nVPN software to facilitate access and maintain persistence to a target network. By installing\nSoftEther on internal systems, GALLIUM is able to connect through that system as though\nthey are on the internal network of the target. SoftEther provides GALLIUM with another\nmeans of persistence and flexibility with the added benefit that its traffic may appear to be\nbenign on the target network.\n\n## Recommended defenses\n\nThe following are recommended defenses security operations teams can take to mitigate the\nimpact of threats like GALLIUM in your corporate environment:\n\nMaintain web server patching and log audits, run web services with minimum required\noperating system permissions\nInstall security updates on all applications and operating systems promptly. Check the\n[Security Update Guide for detailed information about available Microsoft security](https://portal.msrc.microsoft.com/)\nupdates.\nFor efficient incident response, maintain a forensics-ready network with centralized\nevent logging, file detonation services, and up-to-date asset inventories.\nEnable cloud-delivered protection and maintain updated antivirus.\nTurn on cloud-delivered protection and automatic sample submission on Windows\nDefender Antivirus. These capabilities use artificial intelligence (AI) and machine\nlearning to quickly identify and stop new and unknown threats.\nUse behavior detection solutions to catch credential dumping or other activity that may\nindicate a breach.\n\n\n-----\n\nAdopt [Azure ATP—a cloud-based security solution that leverages your on-premises](https://docs.microsoft.com/en-us/azure-advanced-threat-protection/what-is-atp)\nActive Directory signals—to identify, detect, and investigate advanced threats,\ncompromised identities, and malicious insider actions directed at your organization.\nUse [Microsoft Defender ATP to help enterprise networks prevent, detect, investigate,](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/microsoft-defender-advanced-threat-protection)\nand respond to advanced threats. Educate users about protecting personal and\nbusiness information in social media, filtering unsolicited communication, identifying\nlures in spear-phishing email and watering holes, and reporting of reconnaissance\nattempts and other suspicious activity.\nEncourage users to use Microsoft Edge and other web browsers that support\nSmartScreen, which identifies and blocks malicious websites, including phishing sites,\nscam sites, and sites that contain exploits and host malware.\nInstitute Multi-Factor Authentication (MFA) to mitigate against compromised accounts.\n\n**Note: Microsoft strongly encourages all customers download and use**\n[passwordless solutions like the Microsoft Authenticator app or Windows Hello to](https://www.microsoft.com/en-us/account/authenticator/)\nsecure your accounts.\nFor Office 365 users, see [MFA support.](https://docs.microsoft.com/en-us/office365/admin/security-and-compliance/set-up-multi-factor-authentication?view=o365worldwide)\n[For consumer and personal email accounts, see how to use two-step verification.](https://support.microsoft.com/en-us/help/12408/microsoft-account-how-to-use-two-step-verification)\n\n## Related indicators\n\nThe list below provides known GALLIUM tooling and Indicators of Compromise (IOCs)\nobserved during this activity. Microsoft encourages customers to implement detections and\nprotections to identify possible prior campaigns or prevent future campaigns against their\nsystems.\n\n**Tooling**\n\n**Tool** **Purpose**\n\nHTRAN Connection bouncer to proxy connections.\n\nMimikatz Credential dumper.\n\nNBTScan Scanner for open NETBIOS nameservers on a local or\nremote TCP/IP network.\n\nNetcat Reads from and writes to network connections using TCP or\nUDP protocols.\n\nPsExec Executes a command line process on a remote machine.\n\n\nWindows Credential\nEditor (WCE)\n\n\nCredential dumper.\n\n\nWinRAR Archiving utility.\n\n**Malware**\n\n\n-----\n\n**Malware** **Notes**\n\nBlackMould Native IIS version of the China Chopper web shell.\n\n\nChina\nChopper\n\nPoison Ivy\n(modified)\n\n\nCommonly used and widely shared web shell used by several threat actors.\nNot unique to GALLIUM.\n\nPoison Ivy is a widely shared remote access tool (RAT) first identified in\n2005. While Poison Ivy is widely used, the variant GALLIUM has been\nobserved using is a modified version which appears to be unique to\nGALLIUM.\n\n\nQuarkBandit Gh0st RAT variant with modified configuration options and encryption.\n\n**Indicators**\n\n**Indicator** **Type**\n\nasyspy256[.]ddns[.]net Domain\n\nhotkillmail9sddcc[.]ddns[.]net Domain\n\nrosaf112[.]ddns[.]net Domain\n\ncvdfhjh1231[.]myftp[.]biz Domain\n\nsz2016rose[.]ddns[.]net Domain\n\ndffwescwer4325[.]myftp[.]biz Domain\n\ncvdfhjh1231[.]ddns[.]net Domain\n\n9ae7c4a4e1cfe9b505c3a47e66551eb1357affee65bfefb0109d02f4e97c06dd Sha256\n\n7772d624e1aed327abcd24ce2068063da0e31bb1d5d3bf2841fc977e198c6c5b Sha256\n\n657fc7e6447e0065d488a7db2caab13071e44741875044f9024ca843fe4e86b5 Sha256\n\n2ef157a97e28574356e1d871abf75deca7d7a1ea662f38b577a06dd039dbae29 Sha256\n\n52fd7b90d7144ac448af4008be639d4d45c252e51823f4311011af3207a5fc77 Sha256\n\na370e47cb97b35f1ae6590d14ada7561d22b4a73be0cb6df7e851d85054b1ac3 Sha256\n\n5bf80b871278a29f356bd42af1e35428aead20cd90b0c7642247afcaaa95b022 Sha256\n\n6f690ccfd54c2b02f0c3cb89c938162c10cbeee693286e809579c540b07ed883 Sha256\n\n3c884f776fbd16597c072afd81029e8764dd57ee79d798829ca111f5e170bd8e Sha256\n\n1922a419f57afb351b58330ed456143cc8de8b3ebcbd236d26a219b03b3464d7 Sha256\n\n\n-----\n\nfe0e4ef832b62d49b43433e10c47dc51072959af93963c790892efc20ec422f1 Sha256\n\n7ce9e1c5562c8a5c93878629a47fe6071a35d604ed57a8f918f3eadf82c11a9c Sha256\n\n178d5ee8c04401d332af331087a80fb4e5e2937edfba7266f9be34a5029b6945 Sha256\n\n51f70956fa8c487784fd21ab795f6ba2199b5c2d346acdeef1de0318a4c729d9 Sha256\n\n889bca95f1a69e94aaade1e959ed0d3620531dc0fc563be9a8decf41899b4d79 Sha256\n\n332ddaa00e2eb862742cb8d7e24ce52a5d38ffb22f6c8bd51162bd35e84d7ddf Sha256\n\n44bcf82fa536318622798504e8369e9dcdb32686b95fcb44579f0b4efa79df08 Sha256\n\n63552772fdd8c947712a2cff00dfe25c7a34133716784b6d486227384f8cf3ef Sha256\n\n056744a3c371b5938d63c396fe094afce8fb153796a65afa5103e1bffd7ca070 Sha256\n\nTrojanDropper:Win32/BlackMould.A!dha Signature\nName\n\nTrojan:Win32/BlackMould.B!dha Signature\nName\n\nTrojan:Win32/QuarkBandit.A!dha Signature\nName\n\nTrojan:Win32/Sidelod.A!dha Signature\nName\n\n[Bookmark the Security blog to keep up with our expert coverage on security matters. Also,](https://www.microsoft.com/security/blog/)\n[follow us at @MSFTSecurity for the latest news and updates on cybersecurity.](https://twitter.com/@MSFTSecurity)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-12-12 - GALLIUM- Targeting global telecom.pdf"
    ],
    "report_names": [
        "2019-12-12 - GALLIUM- Targeting global telecom.pdf"
    ],
    "threat_actors": [
        {
            "id": "9faf32b7-0221-46ac-a716-c330c1f10c95",
            "created_at": "2022-10-25T16:07:23.652281Z",
            "updated_at": "2025-03-27T02:02:09.908624Z",
            "deleted_at": null,
            "main_name": "Gallium",
            "aliases": [
                "Alloy Taurus",
                "Granite Typhoon",
                "Phantom Panda"
            ],
            "source_name": "ETDA:Gallium",
            "tools": [
                "Agentemis",
                "BlackMould",
                "CHINACHOPPER",
                "China Chopper",
                "Chymine",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "Gh0stCringe RAT",
                "HTran",
                "HUC Packet Transmit Tool",
                "LaZagne",
                "Mimikatz",
                "NBTscan",
                "PingPull",
                "Plink",
                "Poison Ivy",
                "PsExec",
                "PuTTY Link",
                "QuarkBandit",
                "Quasar RAT",
                "QuasarRAT",
                "Reshell",
                "SPIVY",
                "SinoChopper",
                "SoftEther VPN",
                "Sword2033",
                "WCE",
                "WinRAR",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Yggdrasil",
                "cobeacon",
                "nbtscan",
                "netcat",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7bf3ffe5-09ba-4378-8ea4-a6d748a494fd",
            "created_at": "2022-10-25T15:50:23.264584Z",
            "updated_at": "2025-03-27T02:00:55.414817Z",
            "deleted_at": null,
            "main_name": "GALLIUM",
            "aliases": [
                "GALLIUM",
                "Granite Typhoon"
            ],
            "source_name": "MITRE:GALLIUM",
            "tools": [
                "ipconfig",
                "cmd",
                "China Chopper",
                "PoisonIvy",
                "at",
                "PlugX",
                "PingPull",
                "BlackMould",
                "Mimikatz",
                "PsExec",
                "HTRAN",
                "NBTscan",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c87ee2df-e528-4fa0-bed6-6ed29e390688",
            "created_at": "2023-01-06T13:46:39.150432Z",
            "updated_at": "2025-03-27T02:00:03.008665Z",
            "deleted_at": null,
            "main_name": "GALLIUM",
            "aliases": [
                "Red Dev 4",
                "Alloy Taurus",
                "Granite Typhoon"
            ],
            "source_name": "MISPGALAXY:GALLIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535684,
    "ts_updated_at": 1743041513,
    "ts_creation_date": 1655594249,
    "ts_modification_date": 1655594249,
    "files": {
        "pdf": "https://archive.orkl.eu/0a3afe8875a5ab846e787bcb22186c4187da5f01.pdf",
        "text": "https://archive.orkl.eu/0a3afe8875a5ab846e787bcb22186c4187da5f01.txt",
        "img": "https://archive.orkl.eu/0a3afe8875a5ab846e787bcb22186c4187da5f01.jpg"
    }
}