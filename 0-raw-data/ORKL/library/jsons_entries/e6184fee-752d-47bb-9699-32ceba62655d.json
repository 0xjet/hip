{
    "id": "e6184fee-752d-47bb-9699-32ceba62655d",
    "created_at": "2023-01-12T15:04:33.711448Z",
    "updated_at": "2025-03-27T02:13:08.230641Z",
    "deleted_at": null,
    "sha1_hash": "19936ddae56acf5b6cd24e20672963b042c07909",
    "title": "2021-05-11 - Campo, a New Attack Campaign Targeting Japan",
    "authors": "",
    "file_creation_date": "2022-05-28T15:28:12Z",
    "file_modification_date": "2022-05-28T15:28:12Z",
    "file_size": 2094821,
    "plain_text": "# Campo, a New Attack Campaign Targeting Japan\n\n**[mal-eats.net/en/2021/05/11/campo_new_attack_campaign_targeting_japan/](https://mal-eats.net/en/2021/05/11/campo_new_attack_campaign_targeting_japan/)**\n\n@mal_eats 2021年5月11日\n\nSince around March 2021, campaigns in Japan using an infrastructure called\ncampo/openfield have been observed. This campaign has the potential to deliver subsequent\nmalware depending on the infected organization, and some cases eventually could result in\nransomware incidents overseas.\n\nWe keep tracking this attack campaign, and it started to be observed at least around October\n2020 as far as we are aware. We anticipate that attackers will continue to be active in the\nfuture, and we are concerned that this could lead to serious impacts including ransomware\nencryption in the worst case. Therefore, in order to prepare for such threats, we will share in\nthis blog the characteristics of campaigns for Japan and how to check for malware execution\ntraces based on our research.\n\n## Update history\n\nDate Details\n\n2021/5/11 Published this blog\n\n## Observation cases of this campaign in Japan\n\nReports of suspicious emails in Japan have been shared on social networking sites.\n\nThe reports are shown below in chronological order.\n\n2020/10/14\n\n[https://twitter.com/bomccss/status/1316163808319041536](https://twitter.com/bomccss/status/1316163808319041536)\n\n\n-----\n\n2021/3/10\n[https://twitter.com/bomccss/status/1369612781209591813](https://twitter.com/bomccss/status/1369612781209591813)\n\n2021/3/24\n[https://twitter.com/bomccss/status/1374526482890944515](https://twitter.com/bomccss/status/1374526482890944515)\n\n2021/3/31\n[https://twitter.com/bomccss/status/1377280535710494729](https://twitter.com/bomccss/status/1377280535710494729)\n\n2021/4/6\n[https://twitter.com/bomccss/status/1379240664362143744](https://twitter.com/bomccss/status/1379240664362143744)\n\n2021/4/7\n[https://twitter.com/bomccss/status/1379602541495738371](https://twitter.com/bomccss/status/1379602541495738371)\n\n2021/4/8\n[https://twitter.com/bomccss/status/1379970130642235392](https://twitter.com/bomccss/status/1379970130642235392)\n\n2021/4/9\n[https://twitter.com/bomccss/status/1380327966765314050](https://twitter.com/bomccss/status/1380327966765314050)\n\n## Big picture of attack campaign\n\nThe big picture of the attack campaign is as shown in Figure1. The attack begins with\nincoming Japanese emails. The body of the email contains a URL link and a password, and\nwhen the user accesses the URL link, they can download a ZIP file with the password. After\nextracting this zip file and opening the document file to enable the content, a downloader\ncalled Campo Loader is dropped and executed, then starts communication. In addition, it\ninfects DFDownloader as a follow-up malware which can download and execute additional\npayloads by communicating with the C2 server.\n\nFigure1. The big picture of the attack campaign\n\n\n-----\n\nWe believe that the attacker is using an anti-bot service called BlackTDS to communicate\nwith the both host of the URL link and the host of the Campo Loader. This service enables\ncommunications for research activities to redirect to unintentionally legitimate sites. Details of\nhow this service works are described later.\n\nThe DFDownloader used in this campaign against Japan has the ability to download and\nexecute additional malware, but at this time we have not observed any following payloads\nyet. The DFDownloader has not yet been reported overseas. Hence, the final payload via\nDFDownloader is not known.\n\nOn the other hand, similar cases of infection with the follow-up malware via Campo Loader\nhave been reported overseas.\n\nTrickbot\nUrsnif\nBazarLoader -> CobaltStrike, AnchorDNS\nPhobosRansom\n\nWe also believe that the attackers in past campaigns attempting to infect Zloader may have\nbeen the same attacker group. We will discuss these at the end of this paper.\n\n## Features of Emails\n\nAn example of emails is shown in Figure 2. In the attack campaign for Japan, the email is\nwritten in Japanese. As for the content of the email, it pretends to be a real company\nrepresentative and asks the user to download a ZIP file with a password linked to it in the\nform of an invoice. The email address is different from a legitimate corporate email address,\nand the attacker is pretending to be a corporation. We have confirmed that the passwords for\nthe linked files in the email are all the same as far as we can currently observe. Furthermore,\nbased on the email headers, we assume that the attacker is using Roundcube Webmail, an\nopen source webmail, to deliver the message.\n\n\n-----\n\nFigure2. Email samples in Japanese\n\n## Features of the linked server\n\nWe have confirmed that all the linked URLs where the passworded ZIPs are located have\nhttps. It also has the following features. The IP address associated with the domain name is\noften common.\n\nAs a result of our investigation, it is possible that this server is using an anti-bot service\ncalled “BlackTDS”. This service is described on the official website as “the best solution for\ncleaning traffic and protecting bots” (Figure 3), but in fact it is reported by ProofPoint to be\nabused by attackers as Drive-by as a service [1].\n\n\n-----\n\nFigure3. BlackTDS\n\n[1]Drive-by as a service: BlackTDS\n[https://www.proofpoint.com/us/threat-insight/post/drive-service-blacktds](https://www.proofpoint.com/us/threat-insight/post/drive-service-blacktds)\n\nIn this campaign for Japan, the following filtering of the service may be used.\n\nFiltering by IPs that fully support IPv6\nFiltering by ISP\nFiltering by referrer\nFiltering by hardware ID.\nFiltering by hardware ID – Filtering by anti-bot database with more than 440,000 IP\nanti-viruses, moderators, search engines, and checker bots\n\nTherefore, BlackTDS makes it difficult to retrieve files by security researchers and\nsandboxes. In other words, it increases the difficulty of the investigation.\n\n## Features of document files\n\nIn the case of the campaign for Japan, when extracting a ZIP file with a password\ndownloaded from a link in an email and opening the document file, a template with a\nJapanese design is displayed, as shown in Figure4.\n\n\n-----\n\nFigure4. Example of a malicious document file in Japanese\nSince the design of the document file may be common to other malware, it may be difficult to\ndetermine whether it is related to this attack by appearance. It is also possible that the\ndesign may change in the future.\n\nThe following sections provide an overview of the behavior and the latest document file\nbehavior at the time of writing (April 2021).\n\n### Overview of malicious document Behaviour\n\nIf the Office product has default settings, when a user opens a document file and clicks on\n“Enable Content”, an Excel 4.0 macro (referred to as “macro”) is executed and the file is\ndropped with the text embedded in the document file.\n\nIn the document file that we have seen in the series of attacks, the sheet where the macro is\nset is hidden, and the sheet contains the string to execute the macro. (shown in Figure5,\nFigure6)\n\nAlso, due to the “Auto_Open” setting of the document file book, malicious macros will be\nautomatically executed when the document file is opened.(shown in Figure5, Figure6)\n\n\n-----\n\nFigure5. Example of macro functions on April 9, 2021\n\nFigure6. Another example of macro functions on April 9, 2021\nThe string saved by the SAVE.AS function is decoded using certutil.exe and saved under a\ndifferent file name. (Campo Loader) After that, Campo Loader is executed using rundll32.exe\nwith CALL function etc. (Figure7).\n\nFigure7. Example of macro functions on April 9, 2021\nThese series of behaviors are implemented by directly calling the functions of the standard\nWindows modules (DLL) in addition to macros.\n\n### Document files used in the April 9\n\nThe following shows the flow from the most recent (April 9) document file observed to the\nexecution of Campo Loader (Figures 8 and 9).\n\n\n-----\n\nFigure8. Infection flow when a document file is opened\n\nFigure9. Process tree when a document file is opened\nThe flow of operation is as follows.\n\n1. When the document file is opened and the content is activated, the malicious macro is\n\nactivated.\n2. The string embedded in the sheet of the document file will be saved as\n\n%PUBLIC%\\14118.doy. *1\n3. The string embedded in the sheet of the document file will be saved as\n\n%PUBLIC%\\14118.xlsb. *2\n4. The contents of %PUBLIC%\\14118.doy will be BASE64 decoded and the result will be\n\nsaved as %PUBLIC%\\14118.biy.\n5. A fake input form will be displayed (Figure10).\n6. rundll32.exe will execute Campo Loader(%PUBLIC%\\14118.biy). In this case, DF1 is\n\nspecified as the argument and the DF1 function is called.\n*1 The numbers in the file name are generated randomly from 9999 to 19999 by a\nfunction, but in reality, the numbers are fixed values, as they were when the attacker\nsaved the file.\n*2 This file is just created and is not actually needed for the attack.\n\n\n-----\n\nFigure10. Fake input form\n\n## Features of Campo Loader malware\n\nCampo Loader (a.k.a NLoader) is a malware that is executed after being dropped from a\ndocument file. This malware is a downloader, and it has the ability to perform HTTP\ncommunication to obtain and execute additional payloads. Since it accesses a path\ncontaining “/campo/” during communication, Orange Cyberdefense named this malware\n“Campo Loader”[2] and came to be used on social networking sites.\n\nCampo Loader appears to have been updated in early March, and the features of HTTP\ncommunication have changed. This blog will explain the latest one.\n\n[2] 「In the eye of our CyberSOC: Campo Loader, analysis and detection\nperspectives」, Orange Cyberdefense, 2021/03/23\n\nhttps://orangecyberdefense.com/global/blog/cybersoc/in-the-eye-of-our-cybersoccampo-loader-analysis-and-detection-perspectives/\n\nWhen the Campo Loader is executed, it first creates a directory. As shown in the figure\nbelow, the directory name to be created is hard-coded.\n\n\n-----\n\nFigure11. Function of creating a directory\nNext, send the string “ping” to the server using the POST method (Figure12). The server to\nbe communicated with at this time is called the “Openfield server” in the following.\n\nFigure12. Example of a request generated by Campo Loader.\nIn this stage of communication, the Openfield server returns a URL as a response (see\nbelow for details). For this reason, Campo Loader checks if the response starts with “h”, and\nif it does not, it terminates the process (Figure13).\n\nFigure13. Checking the character of “h”\nIf the response starts with an “h”, send a second “ping” message to that URL using the\nPOST method. As a result, an additional payload will be downloaded and saved as a file.\nThe name of the file to be saved is also hard-coded (Figure14).\n\n\n-----\n\nFigure14. Example of hardcoded URLs\nThen rundll32.exe will be used to call the function in the DLL file you downloaded. The name\nof the function to be called is usually the “DF” function *. This call argument is also hardcoded.\n\nCampo Loader is also available as an exe file that can be downloaded and executed. In past\ncases in Japan, Campo Loader has directly executed malware such as Ursnif and Zloader.\nHowever, recent campaigns for Japan have tended to use DLL versions, and have shifted to\ndownloading and executing to the DFDownloader described later in this article.\n\n*Note that Campo Loader uses function names such as “DF” and “DF1” as the export\nfunction, but DFDownloader, the malware described later, also uses the same name “DF” as\nthe function name, so be careful not to confuse Campo Loader and DFDownloader in this\nsection.\n\n## Features of Openfield\n\nThe Openfield server indicates the server where the payload is hosted for Campo Loader to\nget. One of the main features is the inclusion of the string “/campo/” in the URL when getting\nthe payload. In this section, we will explain the contents of the response and the results of\nour investigation for this server.\n\n### Response from Openfield Server\n\nBy sending “ping” in the HTTP body by the POST method under the “campo” directory, the\nnext URL to access can be obtained (Figure15 and 16).In past cases, we observed cases\nwhere the response indicated a redirection, but nowadays, the response generally includes\nthe URL.\n\nFigure15. Example of the response 1\n\n\n-----\n\nFigure16. Example of the response 2\nThere is a possibility that BlackTDS is used for the Openfield server as well as “5. Features\nof the linked server”. Hence, if the BlackTDS service determines that the connection is\ncoming from cyber security researchers, it will redirect the user to a legitimate site such as\nYahoo or GNU.\n\nThe URL to be passed to Campo Loader as a response can be one of the following two\ncases.\n\n1. A URL that indicates a different directory on the same server (such as under\n\n/uploads/files/)\n2. URLs of other Openfield servers.\n\nIn addition, we have observed cases in which malware was placed on compromised servers\nin past campaigns for Japan and overseas.\n\n### Characteristics of IP address and Domain name combination\n\nBoth IP addresses and domain names have been used for URLs in the past, but recently\nattackers have tended to use domain names. Domain names are registered with the\nNamecheap service, and have the regularity of “word + number + xyz domain”. Our research\nalso shows that the range of IP addresses associated with domain names is\n176.111.174.0/24. (shown in Table1.)\n\nTable1. Examples of combination of domain name and resolved IP address used for the\nOpenfield\n\n**Target** **Domain names** **IP Addresses**\n\nNot Japan bfdnews[.]xyz 176.111.174[.]72\n\nNot Japan groupeu[.]xyz 176.111.174[.]72\n\n\n-----\n\nNot Japan allcafe[.]xyz 176.111.174[.]72\n\nNot Japan gainme[.]xyz 176.111.174[.]53\n\nJapan ship4[.]xyz 176.111.174[.]53\n\nJapan gopigs[.]xyz 176.111.174[.]53\n\nNot Japan beauty1[.]xyz 176.111.174[.]53\n\nNot Japan about2[.]xyz 176.111.174[.]57\n\nJapan board3[.]xyz 176.111.174[.]57\n\nJapan cake3[.]xyz 176.111.174[.]58\n\nJapan dance4[.]xyz 176.111.174[.]61\n\nNot Japan hall4[.]xyz 176.111.174[.]62\n\nNot Japan keep2[.]xyz 176.111.174[.]62\n\nNot Japan lie3[.]xyz 176.111.174[.]59\n\nNot Japan out2[.]xyz 176.111.174[.]60\n\nNot Japan noise1[.]xyz 176.111.174[.]60\n\n### The origin and function of the Openfield server\n\n“Openfield” is the name given by the Cryptolaemus Team (@Cryptolaemus1), an\ninternational security research team, to identify this server.\n\n[#Trickbot gtag mon88](https://twitter.com/hashtag/Trickbot?src=hash&ref_src=twsrc%5Etfw) [https://t.co/D3U5S10zJQ](https://t.co/D3U5S10zJQ)\n\nThis /campo/x/x actor is some sort of distro as a service group that loves to do these 1\nor 2 letter subdirectories like that. We have started to call them [#openfield or](https://twitter.com/hashtag/openfield?src=hash&ref_src=twsrc%5Etfw)\n[#campoloader because they always have the same structure.](https://twitter.com/hashtag/campoloader?src=hash&ref_src=twsrc%5Etfw)\n\n[— Cryptolaemus (@Cryptolaemus1) February 27, 2021](https://twitter.com/Cryptolaemus1/status/1365494339883958272?ref_src=twsrc%5Etfw)\n\nThe name comes from the fact that the directory listing feature of the web server has been\nenabled, and the contents could be viewed (commonly referred to as “open directory”). In our\nresearch, we confirmed that the list of contents on the Openfield server had been viewable.\nHowever, this setting has been modified.(shown in Figure17)\n\n\n-----\n\nFigure17. Directory listing of the Openfield server\nThe Openfield server also has a login panel. As shown in Figure17 (left), the Openfield\nserver may have functions related to sending mail, since the names “smtp” and “mails” are\nused in the directory.(Figure18)\n\nFigure18. The login panel of the Openfield server\n\n## Features of the DFDownloader malware\n\nDFDownloader is the second stage malware that is downloaded and executed by Campo\nLoader. This malware is a downloader and is responsible for downloading and executing the\nnext stage of malware. In addition to downloading and executing, it also has the ability to\npersist and update itself, making it more feature-rich than Campo Loader. In addition,\nDFDownloader has embedded version information, and since it is frequently upgraded, it is\n\n\n-----\n\nexpected to be used continuously in the future. In the following sections, we will explain the\noperation of DFDownloader. As we will explain later, we have confirmed that some overseas\ncases do not use DFDownloader.\n\n### Anti-Sandbox Function\n\nDFDownloader has an anti-sandbox feature: DFDownloader will first check the total amount\nof memory on your system, and if it is less than 4 GiB, it will kill the process. There are also\nseveral loops in the sleep function, and these functions may prevent the process from\nrunning properly in a sandboxed environment.(Figure19)\n\nFigure19. Memory checking\n\n### Encryption\n\nAs shown in Figure20, DFDownloader keeps the string to be used encrypted with XOR.\nThese strings contain information about C2 and the functions to be used. The XOR routines\nfor decrypting these strings are also used when decrypting the response from the server.\n\n\n-----\n\nFigure20. Example of XOR strings\n\n### Communication flow\n\nThe communication flow by DFDownloader is shown in the figure below. There are four types\nof data formats that DFDownloader uses when it communicates with the C2 server.\n\n\n-----\n\nFigure 21: Communication flow of DFDownloader\n\n① Communication of SYS identifiers\n\nDFDownloader sends the information collected by the first infected host using the POST\nmethod (see the figure below). The information sent at this time is encoded in Base64, and\ncontains identifiers and other information.\n\nFigure22. First communication example (SYS identifier)\nThe details of the information sent to the server are shown in the table below. For these\nrequests, the server usually returns a response with the HTTP status code “200 OK”.\n\nTable2 The details of the sending data\n\nValue samples Description\n\nSYS Identifier\n\n10 OS Major Version\n\n17763 OS Build Number\n\nDESKTOP-AABSVH71760622929 Computername and Volume serial number\n\ntest Username\n\n\n-----\n\n64 OS-bit number\n\n1.28r DFDownloader version number\n\n0 0 or 1\n\n7545391 N/A\n\n②Communication with BIN identifier\n\nThe second communication using the BIN identifier (see the figure below).\n\nFigure23. Second traffic example (BIN identifier)\nWhen you receive a response from the server, DFDownloader decrypts the response with\nXOR and checks if the first byte starts with “MZ” (the magic number of the PE file). If it is a\nPE file, it saves the received data as a file, and then registers the value in the registry using\nthe path of the created file (as shown below).\n\nFigure 24. Example of registry values\nThis registration in the registry will cause the DFDownloader to run when the user logs on to\nthe terminal, this means persistence of the infection. We have confirmed that this\ncommunication causes the DFDownloader to be updated. When this happens, it saves new\nfiles, rewrites the registry values, and deletes old files and directories.\n\n\n-----\n\n③Communication with PNG Identifier\n\nThe third communication using the PNG identifier.\n\nFigure25. Third communication example (PNG identifier)\nDepending on the value received from the server in this communication, the process\nbranches as shown in the table below. Some parts of the branching process are still under\ndevelopment, and it is expected that additional functions will be added in future versions.\n\nTable 3 Commands\n\nValue Description\n\n0x31 Save and execute the file (DLL or EXE) to be retrieved in the following\ncommunication; the function name can be specified in the case of DLL\n\n0x32 Save and execute the file (DLL) to be acquired in the following communication.\nIn this case, the DFDownloader process exits after execution.\n\n0x33 unimplemented\n\n0x34 unimplemented\n\n④Communication with the BN identifier\n\nFinally, the communication using the BN identifier (see the figure below). In this\ncommunication, depending on the result of communication ③, the payload to be executed in\neach branch is obtained from the server. As mentioned earlier, the payload to be obtained is\na DLL file or an EXE file.\n\nFigure 26. Fourth communication example (BN identifier)\nThen, a new process is created by the CreateProcessA function; if it is an EXE file, it is\nexecuted as is; if it is a DLL file, rundll32.exe is used. Since loop processing is implemented\nin this malware, even if this couldn’t get the expected response from the server, the\ncommunication in ③ and ④ will occur again and again. ( The communication interval is not\nconstant.)\n\n\n-----\n\n## Consideration of follow-up malwares\n\nAt the time of writing (April 2021), we have not been able to confirm any follow-up payloads.\nHowever, similar cases have been reported overseas, and we assume that infections by this\ncampaign may spread in Japan like these cases in the future. Also, before the use of Campo\nLoader and DFDownloader, we have seen attack campaigns by the same attacker group, so\nit is not difficult to guess the attack trend. In this section, we will discuss the malware that can\nbe infected based on overseas cases and past cases.\n\nThe following figure shows the malware that may be infected subsequently based on similar\ncases so far. There have been cases where the Campo Loader has been infected with the\nmalware shown in the blue box in the figure below, and we think that this infection may\nprogress in the same way from the DFDownloader.\n\nFigure27. Consideration of infection step of follow-up malwares\nAs you can see, various types of impact can be expected depending on the type of malware,\nsuch as information theft, remote access, and ransomware.\n\n### Previous attacks on Japan using Campo Loader\n\nWe have observed cases of Ursnif and Zloader infection [3] before this attack campaign In\nJapan. In this case, the Openfield server was used, but not the Campo Loader or\nDFDownloader. It is possible that this attack campaign may also infect Ursnif and Zloader\nlike past cases.\n\n[3] 「2020/10/14(火) 添付ファイル付不審メール「【お振込口座変更のご連絡】」\n（ZLoader）の調査」, bomb_blog, 2020/10/28\n\n[https://bomccss.hatenablog.jp/entry/2020/10/28/125630](https://bomccss.hatenablog.jp/entry/2020/10/28/125630)\n\n### The other cases of using Campo Loader except Japan\n\nThere are several reported cases of the use of Campo Loader. In these cases, the URL\nreturned as a response to the Campo Loader is malware\n\n\n-----\n\nAnother similar case except Japan is an attack campaign called Bazar Call . In this\ncampaign, users call a contact listed in an email, which leads them to a link in a document\nfile that leads to infection. [4]\n\nThis campaign also uses the Campo Loader, which is dropped from the document file as in\nthis attack campaign, runs and accesses the Openfield server to download and execute the\nBazarLoader (Figure 28).\n\nFigure 28. Example of communication to get the BazarLoader in the BazarCall campaign.\n(Source: https://www.malware-traffic-analysis.net/2021/04/16/index2.html)\n\n[4] BazarCall malware uses malicious call centers to infect victims\nhttps://www.bleepingcomputer.com/news/security/bazarcall-malware-uses-maliciouscall-centers-to-infect-victims/\n\nIn other cases, there have been reports of Trickbot and Phobos Ransomware infections from\nthe older Campo Loader; these cases were reported around September-October 2020, but\nthe malware is still active, so we have to be careful.\n\n[5]「Deep Analysis – The EKING Variant of Phobos Ransomware」, Fortinet,\n2020/10/13\nhttps://www.fortinet.com/blog/threat-research/deep-analysis-the-eking-variant-ofphobos-ransomware\n\n[6] 「TRICKBOT AND EMOTET DELIVERY THROUGH WORD MACRO」,\nMorphisec, 2020/9/16\n[https://blog.morphisec.com/trickbot-emotet-delivery-through-word-macro](https://blog.morphisec.com/trickbot-emotet-delivery-through-word-macro)\n\n## Relevance to other campaigns\n\nThis section explains the relevance to other campaigns that were discovered during the\nresearch process.\n\n### Relevance to the BazarCall campaign\n\n\n-----\n\nAs an example, the fake input form displayed when opening the document file used in the\nApril 9 attack on Japan is almost the same as a fake input form mentioned in the report [7]\nreleased by Sophos on April 15. (Figure29, and 30)\n\n[7] “BazarLoader deploys a pair of novel spam vectors”, Sophos, 2021/04/15\n[https://news.sophos.com/en-us/2021/04/15/bazarloader/](https://news.sophos.com/en-us/2021/04/15/bazarloader/)\n\nFigure29. Fake input form shown in the April 9 attack campaign for Japan.\n\n\n-----\n\nFigure 30. Fake input form mentioned in the report published by Sophos.\n(Source : https://news.sophos.com/en-us/2021/04/15/bazarloader/)\nFurthermore, the behavior of the document files used in the series of attacks for Japan is\nalmost the same as well (Figure31 and 32).\n\nFigure 31. Process tree of the document file in the April 9 attack campaign against Japan.\n\n\n-----\n\nFigure32. Process tree mentioned in the report published by Sophos.\n(Source : https://news.sophos.com/en-us/2021/04/15/bazarloader/)\n\n### Similarity of packers\n\nThere are multiple variations of the packer used in Campo Loader and DFDownloader, and\nsome of the packers are similar to those used in Trickbot and BazarLoader.\n\nThe figure below shows part of the code of the packer used in Campo Loader and\nDFDownloader (1.28r). The packer uses the CryptoAPI to encrypt the malware itself, with the\nCryptImportKey function importing the RSA2 key and CryptEncrypt processing the data in\nRC4 cipher.\n\nFigure 33. Example of Campo Loader’s packer\n\n\n-----\n\nFigure 34. Example of DFDownloader’s packer.\nThese source codes show similar characteristics to the packer used by BazarLoader, as\ndescribed in Cybereason’s blog [8], and the packer used by Trickbot, as described in VIPRE\nLabs’ blog [9]. These similarities also indicate that Trickbot and BazarLoader might be\nrelated to this attack campaign.\n\n[8] A Bazar of Tricks: Following Team9’s Development Cycles\nhttps://www.cybereason.com/blog/a-bazar-of-tricks-following-team9s-developmentcycles\n\n[9] 「Trickbot’s Tricks」Posted by VIPRE Labs\n[https://labs.vipre.com/trickbots-tricks/](https://labs.vipre.com/trickbots-tricks/)\n\n## How to check for malware execution traces\n\nThe following is how to check the malware execution traces.\n\n### Automatic Startup Settings\n\n**Registry**\n\nDFDownloader registers a DLL file in the registry for persistence.\nDFDownloader is executed when the user logs on to the terminal.\n\nTable 4. Registry values\n\n\n-----\n\nItem Value\n\nRegistry key HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\n\nValue Shell\n\nData type REG_SZ\n\nData (e.g.) explorer.exe, regsvr32.exe C:\\ProgramData\\nmvhg\\nmvhg.dll\n\nFigure 35. Example of the registry values\n\n### Network Traffic and Proxy Logs\n\n**Communication of Campo Loader**\n\nUse the POST method with no User-Agent in the HTTP header.\nThe domain name tends to be the xyz domain.\nThe URL can be expressed by regular expression as “\\/campo\\/([a-z0-9]{1,2})\\/([a-z09]{1,3})”.\n\n\n-----\n\nFigure 36. Campo Loader communication example\n\n**Communication of DFDownloader**\n\nThe POST method is used with no User-Agent in the HTTP header.\nThe domain name tends to use the xyz domain.\nThe Content-Length of a request is about 40 to 100 bytes.\nServer responses are encrypted with XOR, and the XOR key is a different value for\neach infected host. Example: “DESKTOP-AABSVH71760622929”.\n\nFigure 37. Example of DFDownloader communication 1\n\nFigure 38. Example of DFDownloader communication 2\n\n### Created Files\n\nPlease check if any of the following files have been created.\n\n*Please note that the name and destination of the file can be easily changed by an attacker.\n\n**Document files**\n\nThe folder path used to store the files is consistently “C:\\Users\\Public\\”, and the file\nname changes depending on the attack campaign.\nThe table below shows the generated files for the document files we checked.\n\n\n-----\n\nTable 5. Examples of generated files by document file\n\nFile Description\n\nC:\\Users\\Public\\14118.doy File dropped by document file.\nUsed in a campaign for Japan on April 9, 2021.\n\nC:\\Users\\Public\\14118.xlsb File dropped by document file.\nUsed in a campaign for Japan on April 9, 2021.\n\nC:\\Users\\Public\\14118.biy The file generated by Base64 decoding the data in\n“C:\\Users\\Public\\14118.doy” (Campo Loader).\nUsed in a campaign for Japan on April 9, 2021.\n\n**Campo Loader**\n\nThe saved file path and file name are hard-coded in the Campo Loader that is dropped\nfrom the document file.\nThe folder path used to store the files is consistently “C:\\ProgramData\\”\nThe files generated by Campo Loader are as shown in the table below.\n\nTable 6. Examples of files generated by Campo Loader\n\nFiles Description\n\nC:\\ProgramData\\jyqwkf\\jyqwkf.dll DLL file downloaded by Campo Loader.\nUsed in a campaign for Japan on April 9, 2021.\n\nC:\\ProgramData\\yosgu\\yosgu.dll DLL file downloaded by Campo Loader.\nUsed in a campaign for Japan on April 2 and 8, 2021.\n\n**DFDownloader**\n\nThe file path and filename saved by DFDownloader are randomly generated.\nDepending on the communication result, the folder and file may be deleted.\nThe following table shows the files generated by DFDownloader.\n\nTable 7. Examples of files generated by DFDownloader\n\nFiles Description\n\n\n-----\n\nC:\\ProgramData\\<random string>\\<random\nstring>.dll\n(e.g.)C:\\ProgramData\\nmvhg\\nmvhg.dll\n\nC:\\ProgramData\\<random string>\\<random\nstring>.exe\n(e.g.) C:\\ProgramData\\nmvhg\\nmvhg.exe\n\n## Acknowledgments\n\n\nDLL file downloaded by\nDFDownloader\n\nEXE file downloaded by\nDFDownloader\n\n\nWe would like to thank the following security researchers for sharing their information with us\nin writing this blog.\n\nCryptolaemus Team (@Cryptolaemus1)\nExecuteMalware (@executemalware)\nbom (@bomccss)\nわが (@waga_tw)\nmoto_sato (@58_158_177_102)\nMalware Traffic Analysis\n\n[https://www.malware-traffic-analysis.net/](https://www.malware-traffic-analysis.net/)\n\n## IoCs (As of May 10)\n\n### Document file\n\n7d1ff39fc6daab153ad6477554415336578256257aa81fd796a48b89c7a8b2e8\n\n### Campo Loader\n\nb8212f866c5cdf1a823031e24fe10444aab103d8fb55a25821e1c7c7366e580f\n\n### DFDownloader\n\n8589e2d840c3ed5adbdc160724bdb3c2e703adeec1ec1e29983960c9c00c4469\n\n### Where to communicate with Campo Loader\n\nSince Openfield servers are also used by malware other than Campo Loader, the following\nmay include communication destinations used by BazarCall and others. In addition, other\n[Openfield URL information can be found at URLhaus.](https://urlhaus.abuse.ch/browse/tag/openfield/)\n\nhxxp://nightsalmon[.]xyz/campo/b/b\n\nhxxp://foreverbold[.]xyz/campo/b/b\n\nhxxp://superstartart[.]xyz/campo/b/b\n\n\n-----\n\nhxxp://steeltits[.]xyz/campo/z/z\nhxxp://steeltits[.]xyz/campo/LHq/cD\nhxxp://139.162.150[.]121/campo/b/j\nhxxp://185.14.31[.]147/campo/j1/j2\nhxxp://ship4[.]xyz/campo/i/i\nhxxp://gopigs[.]xyz/campo/k/k\nhxxp://board3[.]xyz/campo/h/h2\nhxxp://cake3[.]xyz/campo/c4/c4\nhxxp://dance4[.]xyz/campo/c5/c5\nhxxp://cake3[.]xyz/uploads/files/120.dll\nhxxp://chance5[.]xyz/uploads/files/1.dll\nhxxp://dance4[.]xyz/uploads/files/120-cr.dll\n\n### Where to communicate with DFDownloader\n\nshowstoreonline[.]com\n\nmoviesmenia[.]com\n\navydabiz[.]com\n\nkingdomcoffee[.]com\n\ndomaindnsresolver[.]xyz\n\ndomainutility[.]xyz\n\ndomainservicing[.]xyz\n\ndomainsupply[.]xyz\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-11 - Campo, a New Attack Campaign Targeting Japan.pdf"
    ],
    "report_names": [
        "2021-05-11 - Campo, a New Attack Campaign Targeting Japan.pdf"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d1f8bd4e-bcd4-4101-9158-6158f1806b38",
            "created_at": "2023-01-06T13:46:39.487358Z",
            "updated_at": "2025-03-27T02:00:03.107568Z",
            "deleted_at": null,
            "main_name": "BazarCall",
            "aliases": [
                "BazaCall",
                "BazzarCall"
            ],
            "source_name": "MISPGALAXY:BazarCall",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535873,
    "ts_updated_at": 1743041588,
    "ts_creation_date": 1653751692,
    "ts_modification_date": 1653751692,
    "files": {
        "pdf": "https://archive.orkl.eu/19936ddae56acf5b6cd24e20672963b042c07909.pdf",
        "text": "https://archive.orkl.eu/19936ddae56acf5b6cd24e20672963b042c07909.txt",
        "img": "https://archive.orkl.eu/19936ddae56acf5b6cd24e20672963b042c07909.jpg"
    }
}