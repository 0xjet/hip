{
    "id": "fc642f7e-58e8-492d-be9e-862ce94746a3",
    "created_at": "2023-01-12T15:06:01.613619Z",
    "updated_at": "2025-03-27T02:08:40.902198Z",
    "deleted_at": null,
    "sha1_hash": "d73cbae37d51048ea0617fe38e44c204b9c2d0a2",
    "title": "2011-10-06 - ZeuS-in-the-Mobile – Facts and Theories",
    "authors": "",
    "file_creation_date": "2022-05-28T15:44:55Z",
    "file_modification_date": "2022-05-28T15:44:55Z",
    "file_size": 388230,
    "plain_text": "# ZeuS-in-the-Mobile – Facts and Theories\n\n**[securelist.com/zeus-in-the-mobile-facts-and-theories/36424/](https://securelist.com/zeus-in-the-mobile-facts-and-theories/36424/)**\n\nAuthors\n\n[Denis Maslennikov](https://securelist.com/author/denis/)\n\n## Introduction\n\nOnline banking is now a run-of-the-mill affair for most. More and more banks are trying to\nmaximize the range of services available to clients online. With the added convenience and\nspeed, it might seem as though there is no downside to online banking. However, where\nthere is money — in any form — there are usually scammers.\n\nIt’s hard to pinpoint exactly when the first attacks against online banking customers were\nlaunched — and in this case, it’s not all that important. We have encountered two types of\nattacks: attacks that use classic phishing methods, and attacks that employ a variety of\nmalicious programs. Initially, these attacks were meant to identify online banking system\nusers — i.e. to harvest usernames and passwords. As banks improved their security\nmechanisms, cyber criminals responded by improving malicious programs and learned how\nto bypass most of the transaction confirmation processes used in online banking systems.\n\n\n-----\n\nThese days, the most popular security features of online banking services are TAN codes\n(Transaction Authentication Number) with digital signatures. In some cases, banks send TAN\ncodes via a text message (these are called mTANs, or mobile transaction authentication\nnumbers). Prior to September 2010, there were no recorded instances of attacks using\nmTAN codes. In 2009, rumors went around that hackers were buying up Nokia 1100s in bulk\nfor tens of thousands of dollars — not just any 1100s, but specifically ones that were\nmanufactured at a factory in Bochum, Germany. Allegedly, these particular handsets had\nspecial features (or vulnerabilities?) that made it possible to intercept all text messages,\nincluding those containing mTAN codes. However, no such cases were ever confirmed.\n\nWhen the ZeuS Trojan for mobile platforms (aka ZeuS-in-the-Mobile, or ZitMo) came out in\nlate September 2010, it became the first malicious program designed to steal mTAN codes.\nThis article will discuss ZitMo in detail.\n\n## ZitMo’s plan of attack\n\nMobile ZeuS, or Trojan-Spy.*.Zitmo, was designed for one sole purpose: to quickly steal\nmTAN codes without mobile users noticing. The first important thing to point out is that ZitMo\nworks in close collaboration with the regular ZeuS Trojan. By the regular ZeuS we will mean\na modification of the Trojan that targets the Win32 platform and which is classified as TrojanSpy.Win32.Zbot by Kaspersky Lab.\n\nReaders may recall that ZeuS for PCs running on Windows has been around for some time\nnow. Its first modifications appeared back in 2007. Check out Dmitri Tarakanov’s article for\nmore about [ZeuS.](https://securelist.com/zeus-on-the-hunt/36289/)\n\nWhat happens when a user whose computer is infected with ZeuS gets ready to log in to an\nonline banking system? The user attempts to navigate to his bank’s webpage and log into\nthe system. The PC version of ZeuS registers that the victim is going to an address of\ninterest, and modifies this webpage in the browser so that the personal data entered by the\nuser for authentication is not sent to the bank, but to the ZeuS botnet command center.\n\n**How ZeuS works**\n\nSometime in September 2010, malicious users added a new function to the PC-based ZeuS.\nThe way it worked remained more or less the same, only now a modified authentication page\nwould also ask the user to enter data about their mobile device (the make, model, and\n\n\n-----\n\ntelephone number) in addition to their username and password. Users were told that the data\nwas requested for the alleged purpose of certificate updates.\n\n**A portion of an online banking authentication page which has been modified by malicious users. This**\n\n**page asks users to enter information about their telephone model and number.**\n\n**(Source:** **[http://securityblog.s21sec.com/2010/09/zeus-mitmo-man-in-mobile-ii.html)](http://securityblog.s21sec.com/2010/09/zeus-mitmo-man-in-mobile-ii.html)**\n\nSooner or later, users who provided information to malicious users about their cell phones\nwould receive a text messages asking them to install a new security certificate. This “security\ncertificate” could be downloaded via a link that was provided in the text message. However,\nthis “certificate” was in fact the mobile version of the ZeuS Trojan. If the user followed the\nlink, downloaded and installed the application, then his mobile phone would be infected by\nZitMo, the primary function of which is to send a text message to a malicious user’s phone as\nspecified in the body of the Trojan.\n\nZitMo is still spread in the same way: users download it to their mobile devices under the\nassumption that it is legitimate software.\n\nThe malicious users who successfully used the PC-based ZeuS to steal personal user data\nfor online banking systems and infect victims’ phones with ZitMo were thus able to overcome\nthe last barrier of online banking security systems: the mTAN code. By entering a user’s login\nand password, they were able to access their bank accounts and conduct transactions (such\nas transferring money from the user’s account to their own bank accounts). These\ntransactions required additional authentication using a code sent by the bank via text\nmessage to the client’s phone. After the client submitted a transaction request, the bank\nwould send the client an authentication code. The code would be sent to the ZitMo-infected\nhandset, which immediately forwarded it to the malicious user’s number, who would then use\nthe stolen mTAN to authenticate the transaction. And the victim would be none the wiser.\n\nThe attacks are generally orchestrated as follows:\n\n\n-----\n\n1. Cyber criminals use the PC-based ZeuS to steal the data needed to access online\n\nbanking accounts and client cell phone numbers.\n2. The victim’s mobile phone (see point 1) receives a text message with a request to\n\ninstall an updated security certificate, or some other necessary software. However, the\nlink in the text message will actually lead to the mobile version of ZeuS.\n3. If the victim installs this software and infects the phone, the malicious user can then\n\nuse the stolen personal data and attempt to make cash transactions from the\ncompromised account, but still needs an mTAN code to authenticate the transaction.\n4. The bank sends out a text message with the mTAN code to the client’s mobile phone.\n5. ZitMo forwards the text message with the mTAN code to the malicious user’s phone.\n6. The malicious user is then able to use the mTAN code to authenticate the transaction.\n\n## Known attacks\n\nZitMo’s was first detected on September 25, 2010. At that time, the Spanish-based data\nsecurity company S21sec had written about this threat (see:\n[http://securityblog.s21sec.com/2010/09/zeus-mitmo-man-in-mobile-i.html). However, it was](http://securityblog.s21sec.com/2010/09/zeus-mitmo-man-in-mobile-i.html)\nnot clear which banks were targeted. All of the data available leads us to believe that the\nvictims were clients of one Spanish bank.\n\nAfter that article was published, antivirus companies began their own research. S21sec\nreported it had detected ZitMo on two different mobile platforms: Symbian and BlackBerry.\nExamples of the malicious program for Symbian were quickly found, but for a long time the\nmobile version of ZeuS for BlackBerry existed only in theory and on paper as no one was\nable to get their hands on a sample.\n\nA Polish blogger wrote about the second ZitMo attack on 21 February 2011 (see:\n[http://niebezpiecznik.pl/post/zeus-straszy-polskie-banki/) and the names of the banks whose](http://niebezpiecznik.pl/post/zeus-straszy-polskie-banki/)\nclients were being targeted finally came to light: ING and mBank.\n\n\n-----\n\n**ZeuS’s modification of ING’s online banking web page**\n\n**(Source:** **[http://niebezpiecznik.pl/post/zeus-straszy-polskie-banki/)](http://niebezpiecznik.pl/post/zeus-straszy-polskie-banki/)**\n\nThe list of targeted platforms also grew, and now included smartphones running on Windows\nMobile.\n\nAt that point, only the ZitMo attacks described above had been detected. It remains unclear\nwhether other attacks had taken place. If so, then they will probably not be discussed in\npublic.\n\n## Platforms\n\nAt the time of this article’s publication (October 2011), various modifications of ZitMo had\nbeen detected for the following platforms: Symbian, Windows Mobile, BlackBerry and\nAndroid.\n\nAbove, we described the general sequence of events that occur during attacks and the main\nobjective of the mobile version of ZeuS, i.e. to obtain text messages with mTAN codes. The\nfunctions for ZitMo versions targeting different platforms (save for Android) are identical,\nalthough it’s still important to take a closer look at the individual versions for each mobile\nplatform.\n\n\n-----\n\nFor starters, let us take a look at one crucial and interesting detail of all ZitMo versions, with\nthe exception of Android. A Trojan running on a smartphone is controlled by commands that\nare received via text message. So essentially, ZitMo is a text-bot, the C&C of which is\nanother telephone, or to be more precise, a telephone number.\n\nBy July 2011, the following C&C numbers had been identified:\n\n+44778148****\n+44778148****\n+44778148****\n+44778620****\n+44778148****\n\nThese are all UK numbers. Is this indirect evidence that the authors of the malicious program\nwere located in the UK during the attack? It’s possible.\n\n### Symbian\n\nThe ZitMo version for Symbian was the first sample of this threat obtained by antivirus\ncompanies (in late September 2010). Another point worth mentioning is that this malicious\nprogram was given a legitimate digital signature (which has since been recalled).\n\n**One of ZitMo’s digital signatures**\n\nSo how does ZitMo for Symbian operate?\n\nImmediately after a smartphone is infected, the Trojan sends the text message ‘App installed\nOK’ to the C&C number, thus notifying the malicious users that the program has been\ninstalled and is ready to accept commands. ZitMo then creates a database named\nNumbersDB.db with three tables: tbl_contact, tbl_phone, and tbl_history.\n\nAfter infection, ZitMo can receive text messages from the C&C number with the following\ncommands:\n\nADD SENDER\nREM SENDER\nSET SENDER\n\n\n-----\n\nSET ADMIN\nBLOCK ON or OFF\nON or OFF\n\nThe ADD SENDER command is one of the most critical for ZitMo, since it orders the\nforwarding of text messages from specified telephone numbers (the numbers which banks\nuse to send mTAN codes via text message) to the C&C number. In other words, this\ncommand activates the forwarding of text messages with authentication codes for\ntransactions executed by malicious users.\n\nThe REM SENDER command ends the forwarding of text messages from the number\nspecified in the command to the C&C number.\n\nThe SET SENDER command allows the malicious users to update the telephone number\nfrom which the text messages are forwarded to the C&C.\n\nThe SET ADMIN command lets malicious users change the C&C number. This is the only\ncommand that can be sent to an infected mobile device from a telephone number other than\nthe C&C number, enabling malicious users to change the command center.\n\nThe BLOCK ON/BLOCK OFF commands allow malicious users to block or unblock all\nincoming and outgoing calls.\n\nThe ON/OFF command allows the malicious users to switch ZitMo on and off.\n\nZitMo does not contain any “personal” commands and is designed with one goal in mind: to\ntransfer text messages with mTAN codes.\n\nThe second version of ZitMo, detected in a second identified attack, was slightly different\nfrom the first, but only negligibly. First of all, what is clear is that the C&C number was\ndifferent. However, the country code (UK) in this number remained the same. Second, ZitMo\nbegan to scan both incoming and outgoing text messages, which is a bit strange, since the\nprimary objective of the Trojan is to harvest mTAN codes. The third difference is that ‘App\ninstalled OK’ text messages were sent every time a SET ADMIN command was successfully\nreceived and executed. Previously these messages were only sent after a Trojan was\ninstalled.\n\n### Windows Mobile\n\nZitMo for Windows Mobile was detected during the Trojan’s second known attack, which also\ninvolved the Symbian version. It comes as no surprise that the C&C number for both the\nWindows Mobile and Symbian versions of the threat was the same.\n\n\n-----\n\n**A fragment of code from Trojan-Spy.WinCE.Zitmo.a**\n\n**A fragment of code from Trojan-Spy.SymbOS.Zitmo.b**\n\nThere are no differences in the functions between the Windows Mobile and Symbian\nversions of ZitMo. The Trojan is capable of receiving and executing the same commands on\nboth platforms.\n\n### BlackBerry\n\nThe BlackBerry version of ZitMo turned out to be quite complex and a bit of a mystery. The\nthreat was first identified in the same blog which announced the first confirmed appearance\nof ZitMo. But after five months of research, antivirus companies could not detect any files\nassociated with ZitMo for BlackBerry and some people began to speculate that there was, in\n\n\n-----\n\nfact, no active BlackBerry version of ZitMo. Kaspersky Lab finally detected the file\nsertificate.cod shortly after the second ZitMo attack in late February 2011, which turned out\nto be the elusive ZueS-in-the-Mobile for BlackBerry.\n\n**A fragment of the sertificate.cod file**\n\nA quick glance at the file shows that in terms of the commands for this ZitMo version, there\nare no major differences from the other versions. A more detailed analysis brought the\nfollowing to light.\n\nThe main methods used by this Trojan are stored in the file OptionDB.java. Among the\nnames of the methods, one can find getAdminNumber, which is used, among other things, in\nthe following Trojan installation confirmation process:\n\n**A part of the Trojan’s installation confirmation process**\n\nLogical methods can be found, such as isForwardSms, which determines whether or not a\ntext message will be forwarded, and isBlockAllCalls determines whether or not telephone\ncalls will be blocked.\n\nThe main processes required by this program’s operations can be found in the file\nSmsListener.java. These include, for example, a number verification process to identify the\nsenders of incoming text messages that then determines which messages should be\nforwarded to the malicious users.\n\n### Android\n\nZitMo for Android was detected last of all, in early July 2011. The sample that was found is\nvery different from all previous ZeuS-in-the-Mobile versions. The threat’s functions are so\nprimitive that it might seem as though the APK file is entirely unconnected to ZitMol.\nHowever, research confirmed that it really is ZeuS-in-the-Mobile for Android.\n\n\n-----\n\nWe have written about how ZeuS operates. In brief, when a user attempts to visit his bank s\nwebsite and log in, he will instead see a page that has been modified by ZeuS asking him to\nenter data which is then sent to a malicious user’s server, not the bank.\n\nThe first attacks using ZitMo for Android began in the first two weeks of June. The tactics\nused to spread the threat were the same. The following message was found in one of the\nconfiguration files of Trojan-Spy.Win32.Zbot:\n\n**ZeuS’s “welcome message”**\n\nOnce a user selects “Android” and clicks “Continue”, he is led to the following page, where\nhe is “strongly recommended” to download “a special software which will help to protect you\nfrom fraud”.\n\n\n-----\n\n**A recommendation to download a so-called anti-fraud utility**\n\nIf a user selects an OS other than Android, then nothing will happen. The user will see the\nfollowing message.\n\n**The message for non-Android users stating that no “additional protection” is required**\n\nIn other words, this specific version of ZitMo targets the Android platform exclusively.\n\nAfter downloading and installing the allegedly legitimate software, the user will receive the\nmalicious program on his smartphone, the only purpose of which is to forward all incoming\ntext messages (including those with mTAN codes) to a remote server\n(http://******rifty.com/security.jsp) in the following format:\n\n\n-----\n\nf0={SMS_sender_number}&b0={SMS_text}&pid={infected_device_ID}\n\nThere are no other additional functions — not even any C&C numbers or text message\ncommands in ZitMo for Android! However, ZitMo for Android still definitely has a connection\nto the PC-based ZeuS.\n\nAlso of note: the malicious program has been on the Android Market for some time now. It\nwas uploaded there on 18 June, although the date it was removed is not clear. It was\ndownloaded from Android Market less than 50 times.\n\n## What next?\n\nThe ZitMo Trojan, which works in collaboration with the PC-based ZeuS Trojan, is perhaps\none of the most complex recent mobile threats for the following reasons:\n\nIt is a Trojan with a very narrow specialization: forwarding incoming text messages with\nmTAN codes to malicious users (or a server, in cases involving ZitMo for Android) so\nthat the latter can execute financial transactions using hacked bank accounts.\nThere are versions for multiple mobile platforms. ZitMo versions for Symbian, Windows\nMobile, BlackBerry, and Android have been detected.\nIt works with ZeuS as a “team”. If you look at ZitMo separately, i.e. without any\nconnection to the PC-based ZeuS, then it becomes mere spyware capable of\nforwarding text messages. However, if used in combination with the classic PC-based\nZeuS, then malicious users will be able to clear the final hurdle of online banking\nauthentication processes using stolen mTAN codes.\n\nIn the future, attacks involving ZitMo (or a malicious program with similar functions) that are\ndesigned to somehow steal mTAN codes (or perhaps other confidential information that is\nsent via text message) will continue, although it is likely that they will become more\nspecifically targeted against a smaller number of victims.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2011/2011-10-06 - ZeuS-in-the-Mobile – Facts and Theories.pdf"
    ],
    "report_names": [
        "2011-10-06 - ZeuS-in-the-Mobile – Facts and Theories.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535961,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653752695,
    "ts_modification_date": 1653752695,
    "files": {
        "pdf": "https://archive.orkl.eu/d73cbae37d51048ea0617fe38e44c204b9c2d0a2.pdf",
        "text": "https://archive.orkl.eu/d73cbae37d51048ea0617fe38e44c204b9c2d0a2.txt",
        "img": "https://archive.orkl.eu/d73cbae37d51048ea0617fe38e44c204b9c2d0a2.jpg"
    }
}