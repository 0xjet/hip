{
    "id": "b2067b29-86a7-4b1a-89c0-cd92e4a9668e",
    "created_at": "2023-01-12T15:08:44.572707Z",
    "updated_at": "2025-03-27T02:12:11.105144Z",
    "deleted_at": null,
    "sha1_hash": "fe775ecd99cab4a0cc06bd3b8cd8f4571190d616",
    "title": "2022-04-29 - Sliver Case Study- Assessing Common Offensive Security Tools The Use of the Sliver C2 Framework for Malicious Purposes",
    "authors": "",
    "file_creation_date": "2022-11-28T18:58:24Z",
    "file_modification_date": "2022-11-28T18:58:24Z",
    "file_size": 362525,
    "plain_text": "# Sliver Case Study: Assessing Common Offensive Security Tools\n\n**[team-cymru.com/post/sliver-case-study-assessing-common-offensive-security-tools](https://www.team-cymru.com/post/sliver-case-study-assessing-common-offensive-security-tools)**\n\nS2 Research Team May 3, 2022\n\nS2 Research Team\n\nMay 3\n\n6 min read\n\nThe Use of the Sliver C2 Framework for Malicious Purposes\n\n\n-----\n\nThe proliferation of Cobalt Strike during the early 2020s has been undeniable, and its impact unquestionable. In\n[response to this challenge, the detection strategies of defenders have steadily matured. Consequently, threat actor](https://github.com/MichaelKoczwara/Awesome-CobaltStrike-Defence)\ndecision making with regards to tooling is likely evolving too. We therefore decided to identify and track Cobalt\nStrike “alternatives”, specifically off-the-shelf Offensive Security Tools (OST).\n\n[In this post we will discuss the Sliver C2 framework and its usage for potentially malicious purposes since the start](https://github.com/BishopFox/sliver)\nof 2022.\n\nSliver is a Golang based implant and thus is compatible with the major operating systems. Our focus centered on\nthe detection of new Sliver samples associated with Linux, MacOS, and Windows operating systems, and the\nextracted network infrastructure contained within those samples. To understand threat actor TTPs, we\nsubsequently tracked network telemetry for the wider C2 infrastructure in cases where Sliver was deployed.\n\n### Key Findings\n\nSliver utilized as a beachhead for the initial infection tool-chain\n\nSliver utilized in the ransomware delivery framework for attacks observed in the wild\n\nSliver deployed via active opportunistic scanning and possible exploitation of Log4j / VMware Horizon\nvulnerabilities\n\nSliver utilized in the targeting of organizations within Government, Research, Telecom, and University\nsectors, in addition to sporadic victims of opportunity\n\n## Identification of Sliver Samples\n\nSliver’s current advantage lies in its obscurity alongside other less commonly utilized OSTs, with most\norganizations still focused on Cobalt Strike detection. This opens a possible gap in coverage – no one can be\nexpected to detect all the things. This gap exposes organizations to the risk of these lesser known, yet still highly\ncapable, OST C2 frameworks.\n\nDuring Q1 of 2022, we observed 143 Sliver samples, detected with the potential for usage as a first stage tool in\nmalicious activity. For comparison, 4,455 samples of Cobalt Strike were observed within the same time-period.\nBased on the continued prevalence of Cobalt Strike, organizations focusing on detection of that toolset are\ncertainly justified. However, if organizations have the resources to do so, we strongly recommend some study of\nSliver to identify possible detection opportunities.\n\n**This should be considered an anecdotal analysis of samples, as no detection rule is infallible, and no**\n**malware corpus complete. It is also not feasible to distinguish between legitimate versus malicious use for**\n**the totality of samples identified.**\n\nWhat follows is our analysis of two distinct malicious campaigns which leveraged Sliver for C2 purposes.\n\n## Sliver Campaign 1 – “Scan & Exploit”\n\n\n-----\n\n**93** **8** **(S** **C** **,** **U)**\n\n**C2 PORTS: 8888, 13338, 23338, 33338**\n\nBetween 03 February – 04 March 2022 Sliver samples were discovered, utilizing Russian-hosted infrastructure, in\nthe targeting of organizations in various sectors distributed globally. These samples and associated C2 IP\n(193.27.228.127) were deemed malicious, based on observations of 193.27.228.127 sweeping ranges in an\nindiscriminate manner, likely seeking exploitation opportunities.\n\nData from [GreyNoise further highlighted the use of 193.27.228.127 for malicious purposes, targeting Log4j and](https://viz.greynoise.io/)\nExchange (ProxyShell) vulnerabilities.\n\nBased on the identification of Virlock samples (as discussed later in this blog) it is assessed that in some cases the\nactors sought to monetize the accesses they had gained.\n\nIn one instance, a victim was observed connecting to TCP/80 on 193.27.228.127, potentially indicative of an\nexploitation of Log4j, with subsequent connections to 193.27.228.127:8888. This victim was identified running\n[VMware Horizon and was therefore likely vulnerable to CVE-2021-44228 and CVE-2021-45046.](https://kb.vmware.com/s/article/87073)\n\nThe use of TCP/8888 aligns with several identified Sliver samples configured to communicate with\n**193.27.228.127. After a period of approximately 14 days, we observed the C2 communications ‘migrate’ to**\nTCP/13338, TCP/23338, and TCP/33338.\n\nNOTE: TCP/8888 is associated with Sliver’s default mTLS configuration, the use of the additional TCP ports\nending in *3338 appeared more unique to this threat actor and were utilized in circumstances where victim\ncommunications persisted over extended time-periods.\n\nThe following samples (Table 1) were observed communicating with C2 IP 193.27.228.127.\n\n\n​SHA-256 Hash **First**\n**Detected**\n\n1f95397c4634f3348f3001a02eab269148f4c08271c2e2461905a4359f7c4761 2022-0204\n\nd8241e046cb9efcfa7ce733249d580eacff996d8669adbe71019eedafb696a55 2022-0209\n\n08137096b85a3a2611249bb57ba9ace4e8efc9ba28cfddd8557edc3e11e9690c 2022-0213\n\n2190a7d8d7eafd4af56b01d9a828ab2dc553a804ccda4c291dce51ce01da81f8 2022-0216\n\n\n**Sample Name**\n\nugly.exe\n\nSENIOR_REALITY.exe\n\nPRIMARY_FLUTE.exe\n\ninstall.exe\n\n\n-----\n\n**When generating payloads, the Sliver configurator outputs a binary based on a naming convention of**\nRANDOMWORD1_RANDOMWORD2.exe by default.\n\nIn this case, Sliver was utilized for C2 communications in the first stage of the breach activity. A subsequent\nsample, identified as Atera Remote Management software, also communicated with 193.27.228.127. This sample\nwas first uploaded to VirusTotal on February 11, 2022. It appeared the actor used these two tools in concert,\npotentially switching to the use of Atera after initial compromise was achieved.\n\n**Atera Sample**\n\nSHA-256: 0ef7eebec233eb5e4156a8a4715c8d21d8930ea97c19780fc274a62260499412\n\n**176.113.115.107 (Red Bytes LLC, RU)**\n\n**C2 PORTS: 8888, 13338, 23338, 33338**\n\nApproximately 30 days after first observing victim communications with 193.27.228.127, the actor was observed\nswitching victims to a new C2 IP (176.113.115.107), again assigned to a provider in Russia. As previously, victim\ncommunications continued over TCP/13338, TCP/23338, and TCP/33338.\n\n‘In-the-wild’ file names for samples communicating with 176.113.115.107 continued to point towards exploitation of\nLog4j and VMware Horizon vulnerabilities (Table 2).\n\n**SHA-256 Hash** **Name** **Tool**\n\nfc2b02476805361fc5042adfb40b529431151a9c7da2b21fa3fa73e98fba9f64 vmware_kb.exe Sliver\n\nd2958f7b646c092fe645cbdc4c7805490ff9d134c12fa8d945132e71880dd6fd vmware_kb.exe Sliver\n\n7f0deab21a3773295319e7a0afca1bea792943de0041e22523eb0d61a1c155e2 vmware_kb.exe Sliver\n\nc139a777b9b1bca0d7e43335d23c123171dbaceccf45a9eeaf359051e0d0be8e N/A PowerShell\n\nIn addition to the above referenced samples, a sample with possible Virlock ransomware capabilities was also\nobserved communicating with 176.113.115.107. This sample was first uploaded to VirusTotal on March 11, 2022.\nThis finding is indicative of the actor attempting to monetize the access gained by deploying ransomware on a\ncompromised host. It is unclear whether ransomware deployment was the intended final goal in every case.\n\n**Virlock Sample**\n\nSHA-256: 2d6785797cd3f2bfb377b985efe55db0220e12e3c7b1e12ee83888b61a5ad8da\n\n**45.9.148.243 (NICEIT, DM)**\n\n**C2 PORT: 8888**\n\nFinally, in recent days an additional Sliver sample was detected, communicating with a ‘new’ C2 IP (45.9.148.243)\nassigned to a provider in Dominica. Network telemetry data does not indicate any current victim communications\nand it is unclear how this sample / C2 IP is connected to this activity. Updates on this activity will be posted on\n\n\n-----\n\nTwitter via [@teamcymru_S2.](https://twitter.com/teamcymru_S2)\n\n**Sliver Sample**\n\nSHA-256: b9e95117e23e6a69e71441aef07f9683cf0682f34f8f84f876822d8143a05776\n\nOne of the challenges faced when tracking this activity was the volume of noise generated by the ongoing\nexploitation of hosts via vulnerabilities in utilities such as Log4j and Exchange. In several cases, we observed the\nsame victim likely compromised by multiple threat actors. However, what can be concluded is the apparent\nutilization of Sliver in malicious activity, coupled with the continuous scanning, exploitation, and triage of victim\ninfrastructure.\n\nThe activity associated with this cluster was previously commented on in other public reporting:\n\n**Sophos:** [Horde of miner bots and backdoors leveraged Log4J to attack VMware Horizon servers](https://news.sophos.com/en-us/2022/03/29/horde-of-miner-bots-and-backdoors-leveraged-log4j-to-attack-vmware-horizon-servers/)\n\n\n-----\n\n**[TrueSec: FIN12/Conti Syndicate Use TeamTNT Tools in Ransomware Attacks](https://www.truesec.com/hub/blog/teamtnt-gang-is-part-of-fin12-conti-syndicate-a-truesec-investigation)**\n\n## Sliver Campaign #2 – Pakistan & Turkey\n\nThe second campaign identified leveraging Sliver was deemed malicious based on the domain name utilized by\nthe actors, which appeared to target government entities in Pakistan and Turkey.\n\nThe detected Sliver samples communicated with ping.turkey.g0v.cq.cn, which resolved to IP 16.162.223.161\n(AMAZON-02, US).\n\n**Sliver Samples**\n\nSHA-256: f301e581bb62b251abc7009a709fb163ceeb63de42625d6bfc2ac9a07d9d3adb\n\nSHA-256: a862e2d3aa3a74e23665010ded23510210927d3c056d645f32479be0974e057a\n\nNetwork telemetry data for 16.162.223.161 did not identify current victim communications, however this does not\nrule out ongoing or future malicious activity.\n\nPassive DNS data for 16.162.223.161 identified three further domains resolving to this IP address:\n\nnationalhelpdesk.pk\n\npkgov.org\n\nsngpl.org.pk\n\nGiven the similarity in the apparent spoofing of government entities, it was inferred that these domains related to\nthe domain (ping.turkey.g0v.cq.cn) identified in the Sliver samples.\n\nA further pivot on pkgov.org identified an email address (abdulrehm8282@gmail.com) used in the domain\nregistration. This email address was used in the registration of two further domains, which resolved to IP\n**15.152.186.38 (AMAZON-02, US):**\n\nntcgov.org\n\nuno-desk.org\n\nIn this case, network telemetry for 15.152.186.38:80 provided evidence of inbound connections from potential\nvictims located in Pakistan.\n\n**NTC is likely a reference to one of two Pakistani organizations; the National Telecom Corporation, or the**\n**National Technology Council.**\n\nData from our Botnet Analysis and Reporting Service (BARS) indicated that a Cobalt Strike Beacon server was\nlistening on TCP/80 of 15.152.186.38, associated with the following shellcode sample:\n\nSHA-256: bc94d6ed7abfea4239e941817cdad65a0a243e2e4a718ef401db4cbbef0bf478\n\n\n-----\n\nPassive DNS data for ntcgov.org identified several subdomains, providing an insight into the intended targets of\nthis campaign:\n\ndxb.ntcgov.org\n\ngeo-raabta.ntcgov.org\n\ngeo-tv.ntcgov.org\n\nThe string dxb possibly relates to DXB, the airport code for Dubai International, and the string raabta possibly\nrelates to a project undertaken by the Centre for Pakistan and Gulf Studies.\n\nIt could be inferred that this campaign was undertaken to gain insight into collaborative projects conducted\nbetween Pakistan and the Gulf States (which includes Dubai, UAE).\n\n## CONCLUSION\n\nWe have observed a steady increase in detected Sliver samples over Q1 of 2022, providing insight into actor\ndeployment methods and objectives. Of note we identified two separate campaigns which leveraged Sliver for\nlikely malicious purposes. The latter campaign highlighted the potential use of both Sliver and Cobalt Strike in\nconjunction with each other. As previously stated, the threat posed by malicious utilization of Cobalt Strike has not\ndiminished, however we would recommend that organizations also remain mindful of other OSTs, by applying\nresources to develop detection mechanisms for frameworks like Sliver.\n\n## RECOMMENDATIONS\n\n**Improve visibility**\n\nConsider an attack surface management solution to track remediation of vulnerable assets.\n\n**Be proactive**\n\nMonitor (and hunt externally, beyond your network perimeter) for Sliver with community Snort / YARA rules,\nfor example:\n\n\n-----\n\n[UK NCSC (link)](https://www.ncsc.gov.uk/files/Advisory%20Further%20TTPs%20associated%20with%20SVR%20cyber%20actors.pdf)\n\n[Travis Green (link)](https://travisgreen.net/2021/05/18/2032936-suspected-sliver-dns-cnc-fp-report.html)\n\nMonitor and hunt internally within your infrastructures, look specifically for Sliver as an initial payload, or in\nconcert with other OSTs (like Cobalt Strike).\n\n**Research**\n\nReview threat actor TTPs where Sliver was leveraged in previous malicious campaigns, for example:\n\n[SANS (link)](https://isc.sans.edu/forums/diary/Stolen%2BImages%2BEvidence%2Bcampaign%2Bpushes%2BSliverbased%2Bmalware/27954/)\n\n[@pathtofile (link)](https://blog.tofile.dev/2021/09/04/sliver.html)\n\n[Alexis Rodriguez (link)](https://medium.com/geekculture/payload-delivery-over-ipfs-30771c6c0db)\n\n## FURTHER READING\n\nIf you are concerned about the risks and vulnerabilities of external assets, you can access our eBook on Attack\nSurface Management here: https://team-cymru.com/ebook-the-future-of-attack-surface-management-brad-laporte/\n\n## INDICATORS OF COMPROMISE\n\n**IP Addresses**\n\n193.27.228.127\n\n176.113.115.107\n\n45.9.148.243\n\n16.162.223.161\n\n15.152.186.38\n\n**Domains**\n\nping.turkey.g0v.cq.cn\n\nnationalhelpdesk.pk\n\npkgov.org\n\nsngpl.org.pk\n\nuno-desk.org\n\ndxb.ntcgov.org\n\ngeo-raabta.ntcgov.org\n\n\n-----\n\ngeo tv.ntcgov.org\n\n**SHA-256 Hashes**\n\n1f95397c4634f3348f3001a02eab269148f4c08271c2e2461905a4359f7c4761\n\nd8241e046cb9efcfa7ce733249d580eacff996d8669adbe71019eedafb696a55\n\n08137096b85a3a2611249bb57ba9ace4e8efc9ba28cfddd8557edc3e11e9690c\n\n2190a7d8d7eafd4af56b01d9a828ab2dc553a804ccda4c291dce51ce01da81f8\n\n0ef7eebec233eb5e4156a8a4715c8d21d8930ea97c19780fc274a62260499412\n\nfc2b02476805361fc5042adfb40b529431151a9c7da2b21fa3fa73e98fba9f64\n\nd2958f7b646c092fe645cbdc4c7805490ff9d134c12fa8d945132e71880dd6fd\n\n7f0deab21a3773295319e7a0afca1bea792943de0041e22523eb0d61a1c155e2\n\nc139a777b9b1bca0d7e43335d23c123171dbaceccf45a9eeaf359051e0d0be8e\n\n2d6785797cd3f2bfb377b985efe55db0220e12e3c7b1e12ee83888b61a5ad8da\n\nb9e95117e23e6a69e71441aef07f9683cf0682f34f8f84f876822d8143a05776\n\nf301e581bb62b251abc7009a709fb163ceeb63de42625d6bfc2ac9a07d9d3adb\n\na862e2d3aa3a74e23665010ded23510210927d3c056d645f32479be0974e057a\n\nbc94d6ed7abfea4239e941817cdad65a0a243e2e4a718ef401db4cbbef0bf478\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-29 - Sliver Case Study- Assessing Common Offensive Security Tools The Use of the Sliver C2 Framework for Malicious Purposes.pdf"
    ],
    "report_names": [
        "2022-04-29 - Sliver Case Study- Assessing Common Offensive Security Tools The Use of the Sliver C2 Framework for Malicious Purposes.pdf"
    ],
    "threat_actors": [
        {
            "id": "a2d3f35f-3b29-4509-bff5-af2638140d39",
            "created_at": "2022-10-25T16:07:23.633982Z",
            "updated_at": "2025-03-27T02:02:09.898653Z",
            "deleted_at": null,
            "main_name": "FIN12",
            "aliases": [],
            "source_name": "ETDA:FIN12",
            "tools": [
                "Agentemis",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "KEGTAP",
                "TSPY_TRICKLOAD",
                "Team9Backdoor",
                "The Trick",
                "TheTrick",
                "Totbrick",
                "TrickBot",
                "TrickLoader",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "63061658-5810-4f01-9620-7eada7e9ae2e",
            "created_at": "2022-10-25T15:50:23.752974Z",
            "updated_at": "2025-03-27T02:00:55.538582Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "Wizard Spider",
                "UNC1878",
                "TEMP.MixMaster",
                "Grim Spider",
                "FIN12",
                "GOLD BLACKBURN",
                "ITG23",
                "Periwinkle Tempest",
                "DEV-0193"
            ],
            "source_name": "MITRE:Wizard Spider",
            "tools": [
                "TrickBot",
                "AdFind",
                "BITSAdmin",
                "Bazar",
                "LaZagne",
                "Nltest",
                "GrimAgent",
                "Dyre",
                "Ryuk",
                "Conti",
                "Emotet",
                "Rubeus",
                "Mimikatz",
                "Diavol",
                "PsExec",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f6f91e1c-9202-4497-bf22-9cd5ef477600",
            "created_at": "2023-01-06T13:46:38.86765Z",
            "updated_at": "2025-03-27T02:00:02.938998Z",
            "deleted_at": null,
            "main_name": "WIZARD SPIDER",
            "aliases": [
                "FIN12",
                "UNC2053",
                "Pistachio Tempest",
                "TEMP.MixMaster",
                "GOLD BLACKBURN",
                "Periwinkle Tempest",
                "DEV-0193",
                "Storm-0193",
                "Trickbot LLC",
                "DEV-0237"
            ],
            "source_name": "MISPGALAXY:WIZARD SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536124,
    "ts_updated_at": 1743041531,
    "ts_creation_date": 1669661904,
    "ts_modification_date": 1669661904,
    "files": {
        "pdf": "https://archive.orkl.eu/fe775ecd99cab4a0cc06bd3b8cd8f4571190d616.pdf",
        "text": "https://archive.orkl.eu/fe775ecd99cab4a0cc06bd3b8cd8f4571190d616.txt",
        "img": "https://archive.orkl.eu/fe775ecd99cab4a0cc06bd3b8cd8f4571190d616.jpg"
    }
}