{
    "id": "7009ba68-2a89-43c8-b816-c7c6ab92f233",
    "created_at": "2022-10-25T16:48:20.829226Z",
    "updated_at": "2025-03-27T02:17:05.596096Z",
    "deleted_at": null,
    "sha1_hash": "a2d8d9f2ddc271beaa46705c6eed1487d95a23aa",
    "title": "Cherepanov-Lipovsky-VB2016-from1.indd",
    "authors": "",
    "file_creation_date": "2017-07-03T09:28:03Z",
    "file_modification_date": "2017-07-03T09:28:03Z",
    "file_size": 1331332,
    "plain_text": "# BLACKENERGY – WHAT WE REALLY KNOW ABOUT THE NOTORIOUS CYBER ATTACKS\n## Anton Cherepanov & Robert Lipovsky ESET, Slovakia\n\n Email {cherepanov, lipovsky}@eset.sk\n\n ABSTRACT\n\nIn the past two years, BlackEnergy has become one of the top\nmalware families of interest to system administrators with the\nresponsibility of protecting the networks of potential targets, to\nsecurity researchers who have the family in their sights, and also\nto the media – both technical and mainstream.\n\nBlackEnergy recently made the headlines again after we\ndiscovered that it was used in cyber attacks against electricity\ndistribution companies, which resulted in massive power outages\nin Ukraine in December 2015.\n\nBut cyber attacks using the BlackEnergy malware are nothing\nnew. We fi rst discussed the malware and the perpetrators behind\nit (later nicknamed the Sandworm Team) during our talk at the\n_Virus Bulletin conference in 2014, where we discussed how it_\ntransformed from a regular piece of crimeware for DDoS attacks\nand online banking fraud into a complex piece of malware for\nespionage and industrial sabotage. Now we are publishing our\nmost comprehensive paper on the cybercrime operations based\non our three years of research.\n\nOne of the main reasons why the BlackEnergy attacks have\ngrabbed so much attention is because they were – and still are –\nused in the midst of a tense geopolitical situation in Ukraine. In\naddition to electricity distribution companies, the targets in that\ncountry have included state institutions, news media\norganizations, airports, and railway companies. Ukrainian\noffi cials were quick to point an accusing fi nger at Russia, and\nmany others – including security companies – followed with\nsimilar allegations. The power grid compromise has become\nknown as the fi rst-of-its-kind confi rmed cyber warfare attack\naffecting civilians.\n\nIn our paper we share insights about the discoveries and our\nfollowing research, including previously unpublished details. We\nattempt to separate facts from speculations, reality from hype,\nand clearly state what we know and don’t know – both in regard\nto attribution, as well as other disputed details of the attacks.\n\n## INTRODUCTION\n\nThe BlackEnergy malware has evolved signifi cantly from its\ninitial version fi rst seen in 2007, which has little in common with\nthe samples in the wild (and in the headlines) in 2016. Over the\nyears, the malware family has been used for (petty) cybercrime,\ncyber espionage, and most recently, cyber sabotage.\n\nIt is important to point out these technical aspects, since there\nhave been many reports in recent years about ‘the group’ behind\nBlackEnergy and the origin of the malware. The initial version of\n\n\nBlackEnergy had Russian origins, was sold on underground\nforums, and its source code was leaked. Version 2 of the malware\n(2010) was a complete code rewrite that introduced a modular\narchitecture. Since then, it has been used for a wide range of\npurposes. We know little about the perpetrators behind the\ncurrent BlackEnergy attacks, but as the malware family has been\nused in common cybercrime attacks simultaneously with targeted\nattacks, it is likely that there are several groups in possession of\nthe trojan. In this paper, we will focus on the recent targeted\nattacks.\n\nWe discussed the evolution of the malware, technical details, as\nwell as some of the cyber espionage attacks conducted with it\nagainst state organizations in Ukraine, in our 2014 talk at the\n_Virus Bulletin conference [1] and in a blog post [2]._\n\nThe attackers continued to be active in 2015, and their activity\nculminated in the widely publicized attacks against the Ukrainian\npower grid at the end of that year.\n\nFollowing our initial discovery that attackers using the\nBlackEnergy malware were responsible for the massive power\noutages [3], several reports have been released that explain the\nchain of events leading up to the blackout [4, 5]. It was a\nwell-planned operation that took several months of\nreconnaissance to prepare.\n\nThe aim of this paper is to provide additional details about the\n_modus operandi of the BlackEnergy APT group and to add_\npreviously undisclosed context.\n\n## HISTORY AND FOCUS ON UKRAINE\n\nThe BlackEnergy group has been focused on Ukraine ever since\nwe fi rst observed the trojan being used in targeted attacks. We\nhave collected various documents containing Microsoft Word\nexploits that were used by this group.\n\n**Approximate** **Filename** **Vulnerability**\n**date of use**\n\nMay 2012 EU chief Barroso to CVE-2012-0158,\nsnub Euro 2012 in Fixed in MS12-027\nUkraine.doc\n\nNovember Shale Gas.docx CVE-2013-3906,\n2013 Fixed in MS13-096\n\nDecember Ukraine Protests.docx CVE-2012-0158,\n2013 Fixed in MS12-027\n\n_Table 1: Exploits for Microsoft Offi ce used by the BlackEnergy_\n_group._\n\nAll of these examples use Ukraine-related topics in their\nfi lenames or in decoy-documents. Moreover, there are\nindications that some of these fi les contained exploits for\nsecurity fl aws that were unpatched at that time (zero-days).\n\nIn May 2014, this group used spear-phishing emails against\nvarious targets, including elements of critical infrastructure such\nas energy companies. In these emails attackers impersonated\ngovernment entities. Figure 1 shows an example of a spearphishing email with a forged sender address. The attackers were\nimpersonating the Ministry of Industrial Policy of Ukraine and\n\n|Approximate date of use|Filename|Vulnerability|\n|---|---|---|\n|May 2012|EU chief Barroso to snub Euro 2012 in Ukraine.doc|CVE-2012-0158, Fixed in MS12-027|\n|November 2013|Shale Gas.docx|CVE-2013-3906, Fixed in MS13-096|\n|December 2013|Ukraine Protests.docx|CVE-2012-0158, Fixed in MS12-027|\n\n\n-----\n\nthe text of these emails explained that recipients should change\ntheir passwords if they were contained in a list of passwords\nattached to the email. The attached zip archive actually\ncontained the BlackEnergy executable.\n\n_Figure 1: An email impersonating the Ministry of Industrial_\n_Policy of Ukraine._\n\nIn the beginning of August 2014 the group started to send\nspear-phishing emails with a PowerPoint presentation attached.\nThe PowerPoint fi le was named ‘zdacha_krovi.ppsx’ (Ukrainian\nfor ‘blood donation’). The PowerPoint presentation included\none of the fi rst exploits of the CVE-2014-4114 vulnerability. At\nthat time, the vulnerability had not been patched.\n\n_Figure 2: Decoy text displayed by zero-day exploit sample used_\n_by the BlackEnergy group in August 2014._\n\nTen days later the attackers started using a new PowerPoint fi le,\nnamed ‘spiski_deputatov_done.ppsx’, in a much larger spearphishing campaign [1]. That’s when it was spotted by ESET and\n_iSIGHT Partners and reported to Microsoft by both companies._\n\nThe vulnerability, in the Windows Object Linking and\nEmbedding (OLE) package, allowed attackers to perform\nremote code execution on the target system. The PowerPoint\npackage contained two embedded OLE objects, each with a\nremote path where the resource was located. The fi nal payload\nwas located on a remote SMB share. Other fi les were also\nlocated on the SMB share, including fi les which were possibly\nused against users of a SCADA platform called the\n_CIMPLICITY HMI solution suite [6]._\n\nIn late October 2014, the Department of Homeland Security’s\n(DHS) Industrial Control Systems Cyber Emergency Response\nTeam (ICS-CERT) issued an alert warning stating that the\nBlackEnergy group was targeting the human-machine\n\n\n_Figure 3: Content of remote SMB share used by the_\n_BlackEnergy group._\n\ninterfaces (HMIs) of industrial control systems [7]. The alert\nwarned that users of GE CIMPLICITY, Advantech/Broadwin\n_WebAccess, and Siemens WinCC had been targeted by this_\ncyber threat actor.\n\nThese fi ndings demonstrated the interest of the BlackEnergy\ngroup in Ukraine and industrial control systems.\n\n## ATTACKS IN 2015\n\nFor some of the victims, attacks in 2015 started in February. At\nthat time the attackers sent out spear-phishing messages, but\nsurprisingly these messages didn’t contain any malicious\nobjects. Instead, the emails contained HTML content with a link\nto a .PNG fi le located on a remote server, so that the attackers\nwould receive a notifi cation that the email had been delivered\nand opened by the target. The name of the .PNG fi le was unique\nto each recipient and represented the victim’s base64 encoded\nemail address. (It should be noted that not all email clients load\nremote content by default.)\n\nThe attached PowerPoint presentation was not malicious, but it\nalso contained external pictures. Once opened, PowerPoint\ndisplays a warning and does not load such pictures by default.\n\nWe have a conjecture that by sending these spear-phishing\nemails, the attackers intended to fi nd out how many people read\nthe emails, and how many of them actually open attachments.\n\n_Figure 4: The spear-phishing email with forged sender used by_\n_the BlackEnergy group in February 2015._\n\n\n-----\n\n_Figure 5: HTML content of email with PNG fi le on remote_\n_server._\n\nDuring the next few months, the attackers were sending\nspear-phishing emails that actually contained malicious\nattachments – specifi cally Microsoft Offi ce fi les with malicious\nmacros, and PowerPoint fi les. Once such a PowerPoint fi le was\nopened, it displayed a security warning to the victim about\npotentially malicious content. If the user allowed this content,\nthen PowerPoint made an attempt to create and execute a\n\n_Figure 6: The Microsoft Excel document with a malicious macro_\n_that was used against Ukrainian media companies._\n\n_Figure 7: The Microsoft Excel document with a malicious macro_\n_that may have been used against the Ukrainian railway_\n_company._\n\n\nmalicious .JAR fi le, which tried to launch the BlackEnergy\ndropper. This approach relied on the assumption that the victim\nhad Java Runtime Installed.\n\nThe Microsoft Offi ce fi les used in the 2015 attacks had different\ncontent and layout; in some cases, attackers used a template that\nwas customized for a particular victim. Previously unpublished\nexamples of such malicious Excel fi les are shown in Figures 6\nand 7.\n\n## BLACKENERGY ATTACKS ON THE ENERGY SECTOR\n\nOn 23 December 2015, attackers behind the BlackEnergy\nmalware successfully caused power outages for several hours in\ndifferent regions of Ukraine. This cyber attack against three\nenergy companies has been confi rmed by the Ukrainian\ngovernment [8] and by the DHS [9].\n\nWhile some security experts are skeptical about any\ninvolvement of the BlackEnergy malware in the power outage\nincident, we should say that this malware was indeed detected\nin Ukrainian energy companies. It is likely that attackers didn’t\nuse the BlackEnergy malware to cause the outage itself, but the\nmalware was defi nitely used for the preparation of power outage\nattacks.\n\nWe are aware of a case in which attackers used existing tools\nwithin the environment, specifi cally the Radmin application.\n_Radmin is client-server software that allows computers to be_\ncontrolled remotely; it’s often used by network administrators to\nfi x various issues. The attackers gained access to an operator’s\ncomputer using this tool and, ‘on behalf of operator’, performed\noperations that caused a power outage. Since this software has a\nverbose log fi le, the coherence between the time of incoming\n_Radmin connections to the operator’s machine and the time of_\noutage strengthens the assumption that Radmin software was\nused.\n\nIn some reports there was information about a telephone DDoS\nattack (also sometimes referred to as a ‘telephone fl ood’ by\ncybercriminals) against one energy company [10]. This tactic\nhas been used in the past by cybercriminals to hide a cyber heist\nor major hack [11]. In fact, there are individuals on underground\nforums who are offering such services to anyone for US$50 per\nday, which means that the victim of such an attack would\nreceive a huge number of incoming calls for a whole day and it\nwould cost the attacker only US$50 (see Figure 8).\n\n## TACTICS, TOOLS AND PROCEDURES\n\nIn this section, we will examine the different tactics, tools and\nprocedures used by the BlackEnergy group at each stage of the\nattack.\n\n## Entry point and initial phase\n\nAs explained before, the BlackEnergy group makes heavy use\nof spear-phishing emails. The attached fi le that leads to\ncompromise takes a variety of forms; we have seen the use of\n_Microsoft Word or Excel documents with a malicious VBA_\nmacro, Rich Text Format (RTF) documents embedding exploits\n\n\n-----\n\n_Figure 8: Russian-speaking individual offering telephone DDoS services on an underground forum._\n\n\nfor Microsoft Word, PowerPoint fi les, including zero-day\nexploits, and straightforward executable binaries.\n\nIn addition, there is a report by the Ukrainian security company\n_CyS Centrum that states that the BlackEnergy group_\ncompromised a web server that was connected to the company’s\nlocal network. Afterwards, attackers were able to move onto the\nlocal network via the compromised web server [12].\n\nThe BlackEnergy group may use different approaches for\nspear-phishing attacks. In some cases, we observed the attackers\nmass-mailing spear-phishing messages to a number of\nemployees in targeted organizations. Alternatively, attackers may\nselect just a few email addresses and target those addresses only.\n\nSince many victims in corporate environments don’t have\nadministrator privileges, the attackers introduced the\nBlackEnergy3 (mini or light) version in 2013. The major\ndifference between BlackEnergy2 and BlackEnergy3 is that the\nlatter was designed to work without administrator privileges.\nOther differences between these versions are less signifi cant. We\nare aware of an analysis of BlackEnergy3 malware that\ninaccurately claims that the malware is able to start system\nservices or works as a network sniffer. However, BlackEnergy3\ndoes not have these features simply because it was not designed\nto have them. The researchers confused BlackEnergy itself with\nits wrapper, which was used to disguise one of BlackEnergy’s\ncomponents.\n\nWhile monitoring this threat, we observed another interesting\ndetail. When the attackers are not familiar with the security\nmeasures implemented in the victim’s network, or when they\nare attempting to attack the victim for the fi rst time, they prefer\nto use HTTP rather than HTTPS, for communication with C&C\nservers. However, the HTTP communication is still encrypted\nwith the RC4 algorithm. Such behaviour could be explained by\nthe fact that some security solutions are able to notify a system\nadministrator about suspicious HTTPS traffi c in the network. If\n\n\nthere were no such issue, then the attacker would switch to\nHTTPS communication later.\n\n## Reconnaissance and lateral movement\n\nAs with a number of modern, sophisticated threats, the\nBlackEnergy malware has a modular architecture. The core\ncomponent of BlackEnergy does not provide the attackers with\nmuch functionality: it is able merely to download and execute a\nbinary or shell command, uninstall itself, modify internal\nsettings, or load additional modules.\n\nThe functionality of BlackEnergy can dramatically be extended\nwith additional modules. These modules are stored in encrypted\nform in a separate fi le, which can be referred to as a plug-incontainer. Thus, analysing such containers can reveal interesting\ndetails about new functionality or other changes.\n\nDuring our research in 2014 we discovered and analysed 14\ndifferent BlackEnergy plug-ins [1], while in other publications\non BlackEnergy activity, researchers revealed 17 plug-ins [13].\nThe difference could be explained by a focus on different\nbotnets. BlackEnergy operators don’t push all the possible\nplug-ins at once; they use only those plug-ins that they need at\nthat time.\n\nIn 2015, we collected and analysed 20 containers from various\nvictims, including energy companies. Five of those containers\nwere empty. The malware has a command which allows an\noperator to modify or delete entries in a container.\n\nTable 2 lists the BlackEnergy plug-ins used in attacks in 2015.\n\nSince some of the plug-in containers were recovered from\ncomputers in energy companies in Ukraine, we expected to\ndiscover new plug-ins that potentially could be used in attacks\nagainst SCADA systems. However, nothing like that was found.\nMoreover, if the PE timestamps are genuine, it means that the\nattackers hadn’t even updated plug-ins since 2013 and 2014.\n\n\n-----\n\n|Module name|PE time stamp|Purpose|\n|---|---|---|\n|ps.dll|Nov 10 05:25:51 2013|Password stealer|\n|vs.dll|Nov 10 05:27:45 2013|Network discovery & remote execution|\n|ss.dll|Nov 10 05:27:02 2013|Screenshots|\n|scan.dll|Nov 10 05:28:06 2013|Network scanner|\n|kl.dll|Aug 04 07:17:07 2014|Key logger|\n|fs.dll|Apr 10 16:15:37 2015 Jul 17 09:02:39 2015|File system operations, gathering information about the victim’s system|\n\n\n_Table 2: BlackEnergy modules used in 2015._\n_Figure 9: The binary of the Nmap scanner used by the_\n_BlackEnergy group and made to look like a normal Windows_\n\nPerhaps the existing functionality was enough for their _component._\npurposes.\n\n\nWhen attackers get into the local network, they start to gather\ninformation about the system and network perimeter. Initial\nreconnaissance is made by the FS plug-in. This module collects\na great deal of valuable information for attackers: Windows\nversion, current privileges, installed applications, running\nprocesses, proxy settings, and the output of system utilities such\nas systeminfo, ipconfi g, netstat, route, and tracert. In addition,\nthis module may parse and collect information from the\n_Windows System Event Log. Specifi cally, it collects the dates_\nand times of system starts, reboots and shutdowns. This\ninformation reveals to attackers the victim’s work habits, for\nexample whether the employee turns his computer off over the\nweekend, or at what time he or she comes to work and turns the\ncomputer on.\n\nWith help from the password stealer and key logger plug-ins,\nattackers are able to collect login credentials to various\napplications such as browsers, email clients and passwords\nstored in the Windows Credentials Store. Once the BlackEnergy\noperators have obtained valid credentials, they are able to move\nto the other computers in the network. This is done by use of the\nVS module. This module has embedded PsExec within it – a\nlegitimate Microsoft tool that allows the execution of programs\non remote systems.\n\nThe attackers may explore the network perimeter using their\nSCAN module, which allows them to map the network and scan\nhosts for open ports. Interestingly, it seems that this module was\nnot effi cient enough for the attackers. We have seen them\nmaking use of the Nmap network scanner version 6.47. The\nscanner tool’s executable was located in the C:\\Windows\\Temp\\\nSyslog\\ directory and disguised as the Microsoft svchost.exe\nexecutable (see Figure 9).\n\nThe ultimate goal for any APT is to gain access to the Active\nDirectory server and obtain domain administrator privileges.\nThe BlackEnergy group is no exception, and to do that they\nused Mimikatz. This is a tool that can retrieve Windows account\npasswords and hashes from memory. We have seen that\nattackers were trying to download the Mimikatz tool right away\nfrom the GitHub site. Since Mimikatz requires local\n\n\nadministrator or system privileges in order to perform certain\nactions, attackers need to obtain such privileges beforehand. We\ndidn’t observe any use of local privilege escalation (LPE)\nexploits by this group, but we don’t exclude that possibility.\n\nOnce the attackers have gained the required credentials, they\ncan infect key network nodes using BlackEnergy2:\nspecifi cally, this group is interested in infecting Windows\nservers. BlackEnergy2 exists in the form of a kernel-mode\ndriver, which makes it harder for network administrators to\ndiscover the compromise. Current versions of the Windows\n_Server operating system don’t exist for 32-bit platforms, and_\nfor 64-bit platforms Microsoft driver signing policy requires\nkernel-mode drivers to have a valid digital signature [14].\nPreviously, the BlackEnergy2 dropper bypassed this security\nmeasure by enabling the TESTSIGNING boot confi guration\noption [15]. However, the infected system still needed to be\nrebooted in order to start the BlackEnergy driver. This\nunplanned reboot of the Windows server could raise suspicion.\nTo solve the reboot issue, in 2015 the attackers started to use a\ntool called DSEFix [16]. This is an open-source tool that\nexploits CVE-2008-3431, a vulnerability in the legitimate\nVirtualBox driver, in order to disable the driver signature\ncheck. Since DSEFix disables this check only until the next\nreboot, the attackers made a custom version of DSEFix that\nalso modifi es boot confi guration data (BCD) in order to enable\nTESTSIGNING mode.\n\nAnother tool that we discovered in BlackEnergy’s 2015 arsenal\nis detected by ESET products as the Win32/SSHBearDoor.A\ntrojan [17]. This is a backdoored version of a legitimate SSH\nserver called Dropbear SSH. The attackers used this tool to\nregain access to the server, in the event that the BlackEnergy\nmalware was discovered and deleted.\n\nSometimes the BlackEnergy group may insert their implant on\ncomputers that are used as part of critical infrastructure and wait\nuntil they need it, ‘just in case’. In such cases the attackers are\ntrying to stay under the radar: they don’t exfi ltrate large amounts\nof data to C&C servers or even attempt to perform lateral\nmovement.\n\n\n-----\n\nWe observed that attackers may use a unique C&C server for\neach infected computer in the same network. This tactic has the\npotential to allow attackers to stay longer on the network, since\neven if infection is discovered on a particular computer, other\ninfections may remain unnoticed.\n\n## Final phase\n\nIn 2015, attackers used the KillDisk component as the fi nal\nphase of attacks. This destructive component deletes important\nfi les on the disk drive, empties Windows event logs and, to\nmake the system unbootable, rewrites the fi rst sectors on\nphysical drives. The fi rst use of this component was\ndocumented by CERT-UA against media companies [18]. In\nthe case described by CERT-UA, it is unclear whether this\ncomponent was used to cover tracks or whether it was the\noriginal intent of the attackers.\n\n## Use of other malware\n\nOn 20 January 2016, ESET identifi ed a new attempted attack on\nenergy companies in Ukraine [19]. The attackers used exactly\nthe same infection vector as in previous attacks: a\nspear-phishing email with an attached Excel document\ncontaining a malicious VBA macro. This time, however, instead\nof using BlackEnergy, the attackers used different malware. The\nfi rst-stage payload was a simple trojan downloader, which\nconnected to and downloaded a second-stage payload from a\ncompromised Ukrainian server. The second-stage payload was a\nbackdoor, written in Python, called Gcat. This backdoor is open\nsource and freely available to everyone on GitHub.\n\nWhy do we conclude t hat the same group was behind this\nattack? We know because the spear-phishing emails were sent\nfrom the same server as was used by the BlackEnergy group\n\n[20]. In addition, the attackers’ email used the same notifi cation\ntechnique, with a PNG image, as described above.\n\nThe fact that this group is able to use different types of malware\ninspired us to look for similar cases in the past. We found one\nsuch case, but there is no proven link to the BlackEnergy group\nas seen in the 20 January 2016 case. However, we still believe\nthat it was used by the same group.\n\nAs before, the initial infection vector was an Excel document\ncontaining a malicious VBA macro. The document was named\nЗагальний довідник ДП АМПУ на 23 07 15.xls, which\ntranslates from Ukrainian as the General Directory of State\nEnterprise «Ukrainian Sea Ports Authority» on 23 07 15. Since\nthis document uses the topic of sea ports, and we are aware that\nthe BlackEnergy group is known to attack such critical\ninfrastructure components, it is fair to assume that this\ndocument was used against sea port companies or companies in\nsome way associated with them (see Figure 10).\n\nThe VBA macro code in this document is very similar to a\nmacro used by BlackEnergy in delivering documents. Once the\nmacro is activated, this document creates the fi le vba_macro.exe\nin %TEMP% and executes it afterwards. The executable is an\nobfuscated .NET binary, which simply downloads a\nsecond-stage payload. Unfortunately, it is not possible to say\nnow what was downloaded when the server was active.\n\n\n_Figure 10: The Excel document with a malicious macro, which_\n_is possibly intended for use against Ukrainian sea ports._\n\nThe document was saved on 23 July 2015 and the payload\ndropped was detected by our products in the fourth quarter of\n2015. We don’t know how successful this attempted attack was.\n\n## CONCLUSION\n\nThe perpetrators behind BlackEnergy have caused the fi rst\ndocumented act of cyber sabotage against a mass civilian\npopulation. That fact by itself makes the threat and threat actors\ninteresting but, as our research has showed, there are also many\nother noteworthy details that have come to light over the years,\nfor example, the use of the PowerPoint zero-day exploit\nCVE-2014-4114.\n\nThe BlackEnergy attacks in Ukraine have been taking place at\nthe time of an armed confl ict, which makes it an exceptionally\nsensitive issue. Given the geopolitical situation in the region and\nthe types of victims targeted in the attacks (high-value state and\ngovernment organizations but also critical infrastructure –\npower grid, railway, airport, news media, and others) political\nmotives are very likely. Ukrainian offi cials were quick to point\nan accusing fi nger at Russia, and many others – including\nsecurity companies – followed with similar allegations. Since\nattribution in the cyber world is always tricky, we can neither\nconfi rm nor deny this. In fact, it is somewhat disturbing when\nspeculations are presented as facts without hard evidence.\n\nWhoever stands behind the BlackEnergy attacks, we can expect\nto see more in the future. We will continue monitoring the\nsituation for new developments.\n\n\n-----\n\n## INDICATORS OF COMPROMISE\n\n**Exploits:**\n\n4AE76B5ABF77B3589031E435EBE034A33E0888F369513D4\nA84592196C3C13D9C\n\n38531CAEB2C314487714E4CE7A5B9791B67E7AA8693FE12\nE33A585AFD5313FC5\n\nEB4E5923DCE5E2906BB51A4AE0B536F42C5659CAED2CD\n991F23F6C91FA38A188\n\n15F42698829D169AB783F799615E7E14EEF7658F354534EOF\nB79814A9AB7CF4D\n\n**Malicious documents:**\n\n554D284C533231466A79D798334AE3212F4EFA30637B055E\n26842209CB5B24C1\n\n2CD03D202E02D6B3E6715924BA5E6E1B5C29B87840C7835\n4764C659DC46173AC\n\n969E9156C3ED97F56E3F2C9A7B372ED193A4ED7ADD74AF\n533955B1482A3BB519\n\n3E843F2973E6A1486A04CC980A14B9E3EBD19B5D3AD5E2\nD45828239E543C784E\n\n**Tools:**\n\n5CB4147C6FE72BA3782CC6C2BC0B1DA69D5576B2E993C6\nC3649B0488E2364472 (Nmap scanner)\n\nBC190E0533C4F75F3E303979BE21C06C40B3F6CEEC86071\nA46692C3D85370772 (Custom DSEFix)\n\n0969DAAC4ADC84AB7B50D4F9FFB16C4E1A07C6DBFC96\n8BD6649497C794A161CD (Win32/SSHBearDoor.A)\n\n## REFERENCES\n\n[1] Lipovsky R.; Cherepanov A. Back in BlackEnergy:\n2014 targeted attacks in the Ukraine and Poland.\nSeptember 2014. https://www.virusbulletin.com/\nconference/vb2014/abstracts/back-blackenergy-2014targeted-attacks-ukraine-and-poland.\nhttp://www.welivesecurity.com/2014/09/22/back-inblackenergy-2014/.\n\n[2] Lipovsky R. CVE-2014-4114: Details on August\nBlackEnergy PowerPoint Campaigns. October 2014.\nhttp://www.welivesecurity.com/2014/10/14/cve-20144114-details-august-blackenergy-powerpointcampaigns.\n\n[3] Lipovsky R.; Cherepanov A. BlackEnergy trojan strikes\nagain: Attacks Ukrainian electric power industry.\nJanuary 2016. http://www.welivesecurity.com/2016/01/\n04/blackenergy-trojan-strikes-again-attacks-ukrainianelectric-power-industry/.\n\n[4] Zetter K. Everything We Know About Ukraine’s Power\nPlant Hack. Jauary 2016. https://www.wired.com/2016/\n01/everything-we-know-about-ukraines-power-planthack/.\n\n[5] Zetter K. Inside the Cunning, Unprecedented Hack of\nUkraine’s Power Grid. March 2016.\n\n\nhttps://www.wired.com/2016/03/inside-cunningunprecedented-hack-ukraines-power-grid/.\n\n[6] Wilhoit K.; Gogolinski J. Sandworm to Blacken: The\nSCADA Connection. October 2014.\nhttp://blog.trendmicro.com/trendlabs-securityintelligence/sandworm-to-blacken-the-scada-connection.\n\n[7] ICS-CERT. Alert (ICS-ALERT-14-281-01E) Ongoing\nSophisticated Malware Campaign Compromising ICS.\nOctober 2014. https://ics-cert.us-cert.gov/alerts/\nICS-ALERT-14-281-01B.\n\n[8] The Ministry of Energy and Coal Mining of Ukraine.\nМіненерговугілля має намір утворити групу за участю\nпредставників усіх енергетичних компаній, що входять до\nсфери управління Міністерства, для вивчення можливостей\nщодо запобігання несанкціонованому втручанню в роботу\n\nенергомереж. February 2016. http://mpe.kmu.gov.ua/\nminugol/control/uk/publish/article?art_\nid=245086886&cat_id=35109.\n\n[9] US Department of Homeland Security. DHS Works\nwith Critical Infrastructure Owners and Operators to\nRaise Awareness of Cyber Threats. March 2016.\nhttps://www.dhs.gov/blog/2016/03/07/dhs-workscritical-infrastructure-owners-and-operators-raiseawareness-cyber-threats.\n\n[10] SANS ICS; E-ISAC. Analysis of the Cyber Attack on\nthe Ukrainian Power Grid. http://ics.sans.org/duc5.\n\n[11] Federal Bureau of Investigation. The Latest Phone\nScam. June 2010. https://www.fbi.gov/news/\nstories/2010/june/phone-scam.\n\n[12] CyS Centrum. Киберугроза BlackEnergy2/3. История атак на\n\nкритическую ИТ инфраструктуру Украины. January 2016.\nhttps://cys-centrum.com/ru/news/black_energy_2_3\n\n[13] Baumgartner K.; Garnaeva M. BE2 custom plugins,\nrouter abuse, and target profi les. November 2014.\nhttps://securelist.com/blog/research/67353/be2-customplugins-router-abuse-and-target-profi les.\n\n[14] Microsoft. Driver Signing Policy.\nhttps://msdn.microsoft.com/en-us/library/windows/\nhardware/ff548231(v=vs.85).aspx.\n\n[15] Microsoft. The TESTSIGNING Boot Confi guration\nOption. https://msdn.microsoft.com/en-us/library/\nwindows/hardware/ff553484(v=vs.85).aspx.\n\n[16] hfi ref0x. Windows x64 Driver Signature Enforcement\nOverrider. https://github.com/hfi ref0x/DSEFix.\n\n[17] Cherepanov A. BlackEnergy by the SSHBearDoor:\nattacks against Ukrainian news media and electric\nindustry. January 2016. http://www.welivesecurity.com/\n2016/01/03/blackenergy-sshbeardoor-details-2015attacks-ukrainian-news-media-electric-industry.\n\n[18] CERT UA. Українські ЗМІ атакують за допомогою Black\nEnergy. November 2015. http://cert.gov.ua/?p=2370.\n\n[19] Lipovsky R. New wave of cyberattacks against\nUkrainian power industry. January 2016.\nhttp://www.welivesecurity.com/2016/01/20/new-waveattacks-ukrainian-power-industry.\n\n\n-----\n\n[20] CyS Centrum. Атака на энергетические объекты 19-20\n\nянваря 2016 года. Постфактум. January 2016.\nhttps://cys-centrum.com/ru/news/attack_on_energy_\nfacilities_jan_ps.\n\n[21] F-Secure. BlackEnergy & Quedagh: The convergence\nof crimeware and APT attacks. September 2014.\nhttps://www.f-secure.com/documents/996508/1030745/\nblackenergy_whitepaper.pdf.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://www.virusbulletin.com/uploads/pdf/magazine/2016/VB2016-Cherepanov-Lipovsky.pdf",
        "https://papers.vx-underground.org/papers/ICS SCADA/GreyEnergy and BlackEnergy/BlackEnergy – What we really know about the notorious cyber attacks.pdf"
    ],
    "report_names": [
        "VB2016-Cherepanov-Lipovsky.pdf",
        "BlackEnergy – What we really know about the notorious cyber attacks.pdf"
    ],
    "threat_actors": [
        {
            "id": "4d9cdc7f-72d6-4e17-89d8-f6323bfcaebb",
            "created_at": "2023-01-06T13:46:38.82716Z",
            "updated_at": "2025-03-27T02:00:02.928984Z",
            "deleted_at": null,
            "main_name": "GreyEnergy",
            "aliases": [],
            "source_name": "MISPGALAXY:GreyEnergy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1499074083,
    "ts_modification_date": 1499074083,
    "files": {
        "pdf": "https://archive.orkl.eu/a2d8d9f2ddc271beaa46705c6eed1487d95a23aa.pdf",
        "text": "https://archive.orkl.eu/a2d8d9f2ddc271beaa46705c6eed1487d95a23aa.txt",
        "img": "https://archive.orkl.eu/a2d8d9f2ddc271beaa46705c6eed1487d95a23aa.jpg"
    }
}