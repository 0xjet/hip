{
    "id": "9c6cbb1c-a73c-42a7-a753-cb5e2d0e4e69",
    "created_at": "2024-04-24T02:05:24.316783Z",
    "updated_at": "2025-03-27T02:15:45.463721Z",
    "deleted_at": null,
    "sha1_hash": "901161938c36f7b0988905ad178f0b6cc2addd82",
    "title": "PowerPoint Presentation",
    "authors": "",
    "file_creation_date": "2023-06-30T09:52:04Z",
    "file_modification_date": "2023-06-30T09:52:10Z",
    "file_size": 1822159,
    "plain_text": "# Abusing Electron- based applications in targeted attacks\n\n###### Jaromír Hořejší (@JaromirHorejsi)\n\n FIRSTCON23, Montreal, Canada\n\n\n-----\n\n## Outline\n\n\n\n###### • Introduction\n\n • Overview of Electron framework\n\n • Methods of abusing Electron-based applications\n\n • Selected APT cases abusing Electron-based applications\n\n −Iron Tiger (MiMi secure chat)\n\n −Unclassified (Comm100 & LiveHelp100 customer engagement platforms)\n\n −Water Labbu (MeiQia live chat)\n\n • Conclusion\n\n\n-----\n\n# Introduction\n\n\n-----\n\n## Introduction\n\n\n\n##### • Open-source project\n\n • Uses web developing languages\n\n###### −JavaScript, HTML, CSS\n\n##### • Allows to maintain one codebase\n\n • Framework to build cross-platform desktop apps\n\n\n-----\n\n## Introduction\n\n\n\n##### • Node.js\n\n###### −server-side JavaScript runtime environment\n\n −runs V8 JavaScript engine\n\n −asynchronous event-driven JavaScript runtime\n\n −bundles npm (node package manager)\n\n\n-----\n\n## Introduction\n\n\n\n##### • Multi-process architecture inherited from Chromium\n\n###### −Framework architecturally similar to modern web browsers\n\n −Main process (single process)\n\n • Application entry point\n\n • Runs in Node.js environment\n\n • Creates and manages application windows (BrowserWindow module)\n\n • Controls application lifecycle (ready, launch window, finish launching, all windows closed, before quit, …)\n\n • Can interact with operating system via custom API\n\n\n-----\n\n## Introduction\n\n\n-----\n\n## Introduction\n\n\n\n###### • Lots of applications built with Electron (https://www.electronjs.org/apps)\n\n −Productivity apps\n\n • Github Desktop\n\n −Social\n\n • Discord, Signal, Skype, WhatsApp\n\n −Business\n\n • Microsoft Teams, Slack\n\n −Developer tools\n\n • Visual Studio Code\n\n\n-----\n\n# Overview of Electron framework\n\n\n-----\n\n## Overview of Electron framework\n\n\n\n##### • Creating Electron project\n\n###### −package.json, index.html, main.js, preload.js\n\n\n-----\n\n## Overview of Electron framework\n\n\n\n##### • Structure of Electron application folder\n\n###### −To distribute application, one needs to package it (using tools or manually)\n\n −Use tools like Electron Forge, electron-builder, …\n\n\n-----\n\n## Overview of Electron framework\n\n\n\n##### • Packaging/building the project for different platforms\n\n###### − npx electron-builder -mwl\n\n\n-----\n\n## Overview of Electron framework\n\n\n\n##### • Compiling/packaging the project for different platforms\n\n\n-----\n\n## Overview of Electron framework\n\n\n\n##### • ASAR archive\n\n###### −ASAR stands for Atom Shell Archive Format\n\n −simple extensive archive format\n\n −Works like tar (tape archive)\n\n • Concatenates files together\n\n • No compression\n\n • Random access support (Electron can read arbitrary files from it without unpacking the whole archive)\n\n −Uses JSON to store information about files\n\n\n-----\n\n## Overview of Electron framework\n\n\n-----\n\n## Overview of Electron framework\n\n\n\n##### • ASAR archive\n\n###### −electron-test-1.0.0-mac.zip\\electron-test.app\\Contents\\Resources\\app.asar\n\n −electron-test-1.0.0.dmg\\electron-test 1.0.0\\electron\n test.app\\Contents\\Resources\\app.asar\n\n −electron-test_1.0.0_amd64.snap\\resources\\app.asar\n\n −electron-test Setup 1.0.0.exe\\$PLUGINSDIR\\app-64.7z\\resources\\app.asar\n\n\n-----\n\n## Overview of Electron framework\n\n\n\n##### • Tools for viewing/extracting ASAR archive contents\n\n\n###### −7-zip plugin\n\n −winasar\n\n\n###### −7-zip plugin\n\n −winasar\n\n\n-----\n\n# Methods of abusing Electron-\n\n based applications\n\n\n-----\n\n## Methods of abusing Electron-based applications\n\n\n-----\n\n## Methods of abusing Electron-based applications\n\n\n\n##### • Exploiting vulnerabilities\n\n###### −CVE-2021-21220 had been used in-the-wild by threat actors\n\n • Vulnerability in Chromium prior to 89.0.4389.128\n\n • Insufficient validation of untrusted input in V8 for x86_64\n\n • the exploit code works when it is rendered in a non-sandboxed window\n\n\n-----\n\n## Methods of abusing Electron-based applications\n\n\n-----\n\n## Methods of abusing Electron-based applications\n\n\n\n##### • Patching existing application\n\n###### −Searching strings in app.asar archive and replacing them\n\n\n-----\n\n# Selected APT cases\n\n\n-----\n\n## Selected APT cases\n\n\n\n##### • Iron Tiger\n\n###### −MiMi secure chat application\n\n##### • Unclassified actor\n\n###### −Comm100 & LiveHelp100 customer engagement platforms\n\n##### • Water Labbu\n\n###### −MeiQia live chat\n\n\n-----\n\n## MiMi secure chat application\n\n\n-----\n\n## MiMi secure chat application\n\n\n\n##### • Desktop chat application\n\n###### − electron-main.js file modified to download the malicious payload\n\n\n-----\n\n## MiMi secure chat application\n\n\n\n##### • electron-main.js contains code obfuscated with Dean Edwards’ JS\n\n packer\n\n\n-----\n\n## MiMi secure chat application\n\n\n\n##### • Dean Edwards’ JS packer\n\n\n-----\n\n## MiMi secure chat application\n\n\n-----\n\n## MiMi secure chat application\n\n\n-----\n\n## MiMi secure chat application\n\n\n\n##### • We retrieved clean (left) and malicious (right) installer\n\n • The modification time interval between both versions was very short\n\n (1h30)\n\n\n-----\n\n## MiMi secure chat application\n\n\n-----\n\n## MiMi secure chat application\n\n\n-----\n\n### Comm100 & LiveHelp100 customer engagement platforms\n\n\n\n##### • Based on our telemetry, actor behind the campaign compromised the\n\n web application since at least February 2022\n\n • Client application downloading backdoor at least since August 2022\n\n • Noticed around the end of September 2022\n\n\n-----\n\n### Comm100 & LiveHelp100 customer engagement platforms\n\n\n###### Loads\n\n\n###### Drops\n\n\n###### Sideloads\n\n\n###### Trojanized Electron app\n\n\n###### JavaScript backdoor\n\n\n###### Legitimage EXE file\n\n\n-----\n\n### Comm100 & LiveHelp100 customer engagement platforms\n\n\n-----\n\n### Comm100 & LiveHelp100 customer engagement platforms\n\n\n\n##### • <URL>/livehelp/collect returns obfuscated JavaScript code\n\n • Backdoor function executed by trojanized application\n\n • Collection of OS information\n\n\n-----\n\n### Comm100 & LiveHelp100 customer engagement platforms\n\n\n-----\n\n### Comm100 & LiveHelp100 customer engagement platforms\n\n\n\n##### • Second stage script from <URL>/livehelp/init\n\n • Responsible for\n\n###### −additional trojanizing/modifying the original application and dropping next\n\n stage malware\n\n −dropping additional malicious files\n\n\n-----\n\n## MeiQia(美洽) live chat application\n\n\n\n##### • Discovery\n\n###### −Found Cobalt Strike sample associated with\n\n campaign responsible for stealing\n\n\n-----\n\n## MeiQia(美洽) live chat application\n\n\n-----\n\n## MeiQia(美洽) live chat application\n\n\n\n##### • Infection vector\n\n###### −threat actor likely sent the exploit through the live chat box\n\n −weaponized HTML files containing a screenshot which looks like a withdrawal\n\n confirmation of crypto funds\n\n\n-----\n\n## MeiQia(美洽) live chat application\n\n\n\n##### • Some old versions of the MeiQia(美洽) application\n\n###### −open external links inside the MeiQia(美洽) application (loadURL)\n\n −render the webpage without sandboxing (from Electron 20, the sandbox is\n\n enabled for renderer processes without any further configuration)\n\n\n###### // 为了安全考虑，所有链接都通过外部浏览器打开 // For security reasons, all links are opened through external browsers\n\n\n###### // 为了安全考虑，所有链接都通过外部浏览器打开 // For security reasons, all links are opened through external browsers\n\n\n-----\n\n## MeiQia(美洽) live chat application\n\n\n-----\n\n## MeiQia(美洽) live chat application\n\n\n\n###### • Batch/ps1 scripts patch MeiQia app\n\n − downloading already patched app.asar archive and replacing it\n\n − running a patcher script\n\n • Patcher script changes .\\modules\\create-window.js inside app.asar archive\n\n • Modifications include\n\n − Disabling auto updates\n\n − Setting fixed window size\n\n − Replacing the default URL (https://app.meiqia.com) with a malicious one\n\n − Embedding additional JavaScripts to be executed within MeiQia application context\n\n\n-----\n\n## MeiQia(美洽) live chat application\n\n\n-----\n\n## MeiQia(美洽) live chat application\n\n\n-----\n\n# Conclusion\n\n\n-----\n\n## Takeaways\n\n\n\n###### • Electron applications are usually “big” projects, consist of many files, which may be modified by threat actors\n\n • App.asar archives contain even more files, which may hide malicious payload\n\n • It is important to know where to look for possible malicious modifications\n\n • Supply chain attacks defeat even cautious targets\n\n • Running unsigned installer displays warnings on both Windows and MacOS, users likely used to ignore them\n\n\n-----\n\n## Conclusion\n\n\n\n##### • Advanced threat actors with strong technical capabilities\n\n • Patched Electron applications serve as downloaders/droppers to load\n\n additional native malware\n\n • Custom malware toolkits working on multiple platforms\n\n • The motivation of first two actors is espionage, motivation of Water\n\n Labbu is financial\n\n\n-----\n\n## References\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://www.first.org/resources/papers/conf2023/FIRSTCON23-TLP-CLEAR-Horejsi-Abusing-Electron-Based-Applications-in-Targeted-Attacks.pdf"
    ],
    "report_names": [
        "FIRSTCON23-TLP-CLEAR-Horejsi-Abusing-Electron-Based-Applications-in-Targeted-Attacks.pdf"
    ],
    "threat_actors": [
        {
            "id": "2128689c-108c-4d66-b551-de8e4fcf8653",
            "created_at": "2023-11-14T02:00:07.084086Z",
            "updated_at": "2025-03-27T02:00:03.217821Z",
            "deleted_at": null,
            "main_name": "Water Labbu",
            "aliases": [],
            "source_name": "MISPGALAXY:Water Labbu",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c980ea7-04c4-4193-8535-52f87e66a96e",
            "created_at": "2024-05-01T02:03:07.994126Z",
            "updated_at": "2025-03-27T02:05:17.293799Z",
            "deleted_at": null,
            "main_name": "BRONZE UNION",
            "aliases": [
                "Budworm ",
                "Emissary Panda ",
                "Iron Tiger ",
                "Lucky Mouse ",
                "TG-3390 ",
                "Temp.Hippo ",
                "APT27 "
            ],
            "source_name": "Secureworks:BRONZE UNION",
            "tools": [
                " ASPXSpy",
                " China Chopper",
                " Enfal",
                " Gh0st RAT",
                " HttpBrowser",
                " Hunter",
                " HyperBro",
                " OwaAuth",
                " PlugX",
                " PoisonIvy",
                " Sysupdate",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1713924324,
    "ts_updated_at": 1743041745,
    "ts_creation_date": 1688118724,
    "ts_modification_date": 1688118730,
    "files": {
        "pdf": "https://archive.orkl.eu/901161938c36f7b0988905ad178f0b6cc2addd82.pdf",
        "text": "https://archive.orkl.eu/901161938c36f7b0988905ad178f0b6cc2addd82.txt",
        "img": "https://archive.orkl.eu/901161938c36f7b0988905ad178f0b6cc2addd82.jpg"
    }
}