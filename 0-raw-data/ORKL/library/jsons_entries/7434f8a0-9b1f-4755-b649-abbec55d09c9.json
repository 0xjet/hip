{
    "id": "7434f8a0-9b1f-4755-b649-abbec55d09c9",
    "created_at": "2023-01-12T15:08:23.65589Z",
    "updated_at": "2025-03-27T02:16:47.092746Z",
    "deleted_at": null,
    "sha1_hash": "081d4a2b113bfcdcd80b9de6b0975312caaabdbf",
    "title": "2022-10-06 - Mustang Panda Abuses Legitimate Apps to Target Myanmar Based Victims",
    "authors": "",
    "file_creation_date": "2022-11-28T18:53:47Z",
    "file_modification_date": "2022-11-28T18:53:47Z",
    "file_size": 1955535,
    "plain_text": "# Mustang Panda Abuses Legitimate Apps to Target Myanmar Based Victims\n\n**[blogs.blackberry.com/en/2022/10/mustang-panda-abuses-legitimate-apps-to-target-myanmar-based-victims](https://blogs.blackberry.com/en/2022/10/mustang-panda-abuses-legitimate-apps-to-target-myanmar-based-victims)**\n\nThe BlackBerry Research & Intelligence Team\n\n1. [BlackBerry Blog](https://blogs.blackberry.com/en.html)\n2. Mustang Panda Abuses Legitimate Apps to Target Myanmar Based Victims\n\n## Executive Summary\n\nThe BlackBerry Research & Intelligence Team recently uncovered a campaign by an advanced persistent threat (APT) group called Mustang\nPanda that is leveraging the PlugX malware family to target the Southeast Asian state of Myanmar.\n\nOur team analyzed the samples in question and found their embedded configurations revealed a set of command-and-control (C2) domains\n[that masquerade as Myanmar news outlets. This is not the first time a campaign targeting this state has impersonated Myanmar news outlets](https://securelist.com/apt-luminousmoth/103332/)\nor used PlugX malware.\n\n[These tactics, techniques, and procedures (TTPs), along with other corroborating evidence – such as a previous indication that the group was](https://twitter.com/AvastThreatLabs/status/1404864965584977922)\n[active in this location – lead us to assert with reasonable confidence that the China-based threat group known as Mustang Panda is](https://en.wikipedia.org/wiki/Analytic_confidence)\nresponsible for this campaign\n\n## Mustang Panda: an Origin Story\n\nMustang Panda (aka HoneyMyte, Bronze President or Red Delta) is a prolific APT group that has been publicly attributed as being based in\n[China. This group conducted malware campaigns as far back as 2012, which primarily related to cyber-espionage.](https://blog.talosintelligence.com/2022/05/mustang-panda-targets-europe.html)\n\nTheir targets have included Government and Non-Government Organizations (NGO) in many locations around the world, from various states\nin Southeast Asia to the European Union to the U.S. and beyond.\n\n\n-----\n\n_Figure 1 – Partial map of countries previously targeted by Mustang Panda_\n\n### Mustang Panda Attack Vector\n\nMustang Panda typically sends phishing emails with malicious document attachments as an initial infection vector. These documents are\nusually designed to mimic those of the targeted country or organization, or even current world affairs applicable to that region.\n\n[Once threat actors gain a foothold within a target organization, they typically deploy one of a variety of payloads such as Cobalt Strike, Poison](https://blogs.blackberry.com/en/2021/11/all-your-beacon-are-belong-to-us-new-blackberry-book-cracks-code-of-cobalt-strike-threat-actors)\nIvy, or [PlugX, the latter of which is used most extensively.](https://blogs.blackberry.com/en/2016/06/cylanceprotect-vs-plugx)\n\n### Initial Thread\n\nIn late May of this year, BlackBerry detected some unusual network traffic to a domain – www[.]myanmarnewsonline[.]org. At first glance, this\nURL appeared to be a Myanmar news website.\n\nThe files found to be communicating with this site were encompassed in several .RAR files. These files had a relatively low detection ratio on\nVirusTotal (VT), and as shown in Figure 2, they followed a naming convention designed to make them appear to be legitimate utilities relating\nto Hewlett-Packard (HP) printers.\n\n_Figure 2 – Communicating RAR files_\n\nThe RAR archives contained a legitimate signed utility from HP, along with a DLL loader and a DAT file that is an encrypted PlugX payload.\n\nOne of the legitimate utilities (“HPCustParticUI.exe” – SHA256 8857232077b4b0f0e4a2c3bb5717fd65079209784f41694f8e1b469e34754cf6)\n[was previously used in a similar fashion as part of a PlugX execution chain, which was documented by another vendor in September 2021.](https://www.trellix.com/en-us/about/newsroom/stories/threat-labs/operation-harvest-a-deep-dive-into-a-long-term-campaign.html)\n\nIn early June of this year, a tweet from the user @kienbigmummy (shown in Figure 3) mentioned an additional .RAR file titled “service\nLog.rar” that was linked with a sub-domain of the previously mentioned website – images[.]myanmarnewsonline[.]org – that was associated\nwith PlugX and the Mustang Panda APT group\n\n\n-----\n\n_Figure 3 – June 2nd PlugX tweet by @kienbigmummy_\n\nWe examined the network infrastructure (shown in Figure 4) linked to each of these three RAR files, which provided evidence of additional\nsamples that conform to the same or similar TTPs going back as far as late 2020, along with other sample types such as Cobalt Strike\nbeacon.\n\n_Figure 4 – VirusTotal graph of network infrastructure_\n\n### What is PlugX?\n\nPlugX is a remote access tool (RAT) used by [several threat groups. It is the malware of choice for the Chinese APT group Mustang Panda.](https://attack.mitre.org/software/S0013/)\nThis group delivers the PlugX implant in the form of an encrypted data blob, which is typically paired with a DLL loader as well as a benign\napplication.\n\n\n-----\n\ns acto as co o y e [p oyed t e stea t y tec](https://blog.talosintelligence.com/2022/05/mustang-panda-targets-europe.html) que o s de oad g t e a c ous s to eg t ate app cat o s du g e ecut o\nThis action then deploys the PlugX implant into memory.\n\nWe noted threat actors had used three separate legitimate applications within our RAR files; A free VPN service, and two legitimate HP\napplications related to HP’s Digital Imaging. Each legitimate application was bundled with a DLL and a data file. In two out of the three RAR\nfiles, the DAT file masqueraded as a different file format, such as JSON or CHM.\n\nUpon execution of the legitimate application, the threat loads a malicious DLL loader in a specific set order, which the threat actor has\nstrategically placed in the same folder to replace a legitimate one. This proceeds to side-load the DLL by abusing the DLL search order, which\n[is a technique also known as DLL Search Order Hijacking. The malicious DLL is then loaded into the legitimate application, where it decrypts,](https://attack.mitre.org/techniques/T1574/001/)\nloads and deploys the malicious PlugX implant. This execution chain is shown in Figure 5.\n\n_Figure 5 – PlugX side-loading execution chain_\n\n## Technical Analysis\n\nThe DLL loader is heavily obfuscated and employs dynamic API resolution upon runtime. It retrieves a handle to the encrypted PlugX implant,\nthen reads the data into a newly allocated region within memory. Execution is then passed to the implant, where the shellcode is executed,\nand it XOR decrypts the embedded payload, as shown in Figure 6. Once decryption is complete, RtlDecompressBuffer is called to\ndecompress the decrypted payload to its final form as shown in Figure 7.\n\n\n-----\n\n_Figure 6 – Decryption routine_\n\n_Figure 7 – Decrypted payload header_\n\n## Conclusion\n\nMustang Panda, which is publicly known as a Chinese-affiliated APT group, has an established history of using the PlugX malware and\ntargeting nations throughout South-East Asia. This threat actor has been previously linked to campaigns targeting Myanmar government\n[entities using custom lures and compromising the website of the office of](https://blog.talosintelligence.com/2022/05/mustang-panda-targets-europe.html) [Myanmar’s president.](https://twitter.com/ESETresearch/status/1400165767488970764)\n\nThe TTPs associated with the campaign covered in this report align with those of Mustang Panda. We observed a typical attack chain\nemployed by the group, where attackers used a benign executable to side-load a malicious DLL loader, which then decrypts and loads the\nPlugX implant. We have also confirmed the C2 infrastructure associated with this campaign has been used to target entities in Myanmar,\nincluding a government VPN portal from early March onwards\n\n\n-----\n\n## Indicators of Compromise (IoCs)\n\n### File\n\n**SHA256** **Name** **Description**\n\n843709a59f12ff7aa06a5837be7a1a93fdf6f02f99936af6658c166e8abcaa2d Service Log.rar RAR file encompassing a legit signed\nutility + a DLL loader + a DAT PlugX\npayload\n\n0f3ec2a01ae57c7dd2bb8f130f0f2d1c20fcb397e5b8bbff491517b6d179919e HP.rar RAR file encompassing a legit signed\nutility + a DLL loader + a DAT PlugX\npayload\n\n558cbbcb969fe2fa3f1c74c376e307efcdbe3bad7497095619927edd5762363a HP RAR file encompassing a legit signed\n\nColorLaserJet.rar utility + a DLL loader + a DAT PlugX\n\npayload\n\n### Network\n\n**Indicator** **Type** **Description**\n\nUpdate[.]hilifimyanmar[.]com Domain C&C\n\nDownload[.]hilifimyanmar[.]com Domain C&C\n\nImages[.]myanmarnewsonline[.]org Domain C&C\n\nwww[.]myanmarnewsonline[.]org Domain C&C\n\n154[.]204[.]26[.]120 IP C&C\n\n45[.]134[.]83[.]4 IP C&C\n\n## Defense\n\n### Yara Rule for Mustang Panda\n\nrule targeted_MustangPanda_dll {\n\nmeta:\n\ndescription = \"Rule to detect malicious DLL originally used to target Myanmar\"\n\nauthor = \"The BlackBerry Research & Intelligence team\"\n\nversion = \"1.0\"\n\nlast_modified = \"2022-08-02\"\n\nhash = \"74fe609eb8f344405b41708a3bb3c39b9c1e12ff93232d4b7efe648d66ea7380\"\n\nhash = \"a0d7e541d5c579d2e0493794879fee58d8603b4f3fb146df227efa34c23d830e\"\n\nhash = \"efade7cf8f2caeb5a5d1cf647796975b0b153feac67217fccbdd203e473a4928\"\n\nlicense = \"This Yara rule is provided under the Apache License 2.0 (https://www.apache.org/licenses/LICENSE-2.0) and open to any user\n\nor organization, as long as you use it under this license and ensure originator credit in any derivative to The BlackBerry Research & Intelligence\n\nTeam\"\n\nstrings:\n$code1 = {88E280F20088DD20D588C680F6FF80E60020D008E908C630F188D834FF88CA30C220CA88D834FF88F920C180F7FF20FB\nD988C834FF88D530C520D588D034FF88CE20C680F1FF20CA08D688E834FF88F180F1FF80F4}\n\n$code2 =\n{EA08D188DA80F2FF88CD30D520CD34FF88F980F1FF88E280F20008C880CA0034FF20D088E920C130C508E988D834FF88FA20C288F83\nF88DD20C508EA88D820}\n\ncondition:\n\nuint16(0) == 0x5A4D and\n\nfilesize < 10MB and\n\nany of them\n\n}\n\n\n-----\n\n### &C\n\n[T1583.001 Acquire Infrastructure: Domains](https://attack.mitre.org/techniques/T1583/001/)\n\n[T1027 Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027/)\n\n[T1036.005 Masquerading: Match Legitimate Name or Location](https://attack.mitre.org/techniques/T1036/005/)\n\n[T1574.002 Hijack Execution Flow: DLL Side-Loading](https://attack.mitre.org/techniques/T1574/002/)\n\n### D3FEND\n\nD3-FA (File Analysis)\n\nD3-LFP (Local File Permissions)\n\nD3-DA (Dynamic Analysis)\n\nD3-EFA (Emulated File Analysis)\n\nD3-EAL (Executable Allowlisting)\n\nD3-SCA (System Call Analysis)\n\n**Further Reading:**\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats, providing intelligence analysis for the benefit of\ndefenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-10-06 - Mustang Panda Abuses Legitimate Apps to Target Myanmar Based Victims.pdf"
    ],
    "report_names": [
        "2022-10-06 - Mustang Panda Abuses Legitimate Apps to Target Myanmar Based Victims.pdf"
    ],
    "threat_actors": [
        {
            "id": "7c00086d-9535-4552-8201-1dd725e41b12",
            "created_at": "2023-04-26T02:03:03.128736Z",
            "updated_at": "2025-03-27T02:00:55.516541Z",
            "deleted_at": null,
            "main_name": "LuminousMoth",
            "aliases": [
                "LuminousMoth"
            ],
            "source_name": "MITRE:LuminousMoth",
            "tools": [
                "PlugX",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "92049df8-7902-48e8-ad17-97398b923698",
            "created_at": "2022-10-25T16:07:23.81315Z",
            "updated_at": "2025-03-27T02:02:09.990217Z",
            "deleted_at": null,
            "main_name": "LuminousMoth",
            "aliases": [],
            "source_name": "ETDA:LuminousMoth",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b5449533-0ff1-4048-999d-7d4bfd8e6da6",
            "created_at": "2022-10-25T16:07:24.114365Z",
            "updated_at": "2025-03-27T02:02:10.111256Z",
            "deleted_at": null,
            "main_name": "RedDelta",
            "aliases": [
                "Operation Dianxun",
                "TA416"
            ],
            "source_name": "ETDA:RedDelta",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Chymine",
                "Cobalt Strike",
                "CobaltStrike",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Xamtrav",
                "cobeacon",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "46b409af-b2ea-43b8-9223-e01d982e00ce",
            "created_at": "2022-10-25T16:07:23.966265Z",
            "updated_at": "2025-03-27T02:02:10.052693Z",
            "deleted_at": null,
            "main_name": "Operation Harvest",
            "aliases": [],
            "source_name": "ETDA:Operation Harvest",
            "tools": [
                "Agent.dhwf",
                "BadPotato",
                "BleDoor",
                "Destroy RAT",
                "DestroyRAT",
                "Impacket",
                "Kaba",
                "Korplug",
                "Mimikatz",
                "NBTscan",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "RottenPotato",
                "SMBExec",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "WinRAR",
                "Winnti",
                "Xamtrav",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa90ad17-8852-4732-9dba-72ffb64db493",
            "created_at": "2023-07-11T02:00:10.067957Z",
            "updated_at": "2025-03-27T02:00:03.134199Z",
            "deleted_at": null,
            "main_name": "RedDelta",
            "aliases": [],
            "source_name": "MISPGALAXY:RedDelta",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1691c25f-1aa4-4168-8ce2-7aa8f23246e7",
            "created_at": "2024-06-04T02:03:07.724221Z",
            "updated_at": "2025-03-27T02:05:17.284601Z",
            "deleted_at": null,
            "main_name": "BRONZE PRESIDENT",
            "aliases": [
                "Mustang Panda ",
                "Red Lich ",
                "Temp.Hex ",
                "HoneyMyte "
            ],
            "source_name": "Secureworks:BRONZE PRESIDENT",
            "tools": [
                " Cobalt Strike",
                " ORat",
                " PlugX",
                " RCSession",
                "China Chopper"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b69037ec-2605-4de4-bb32-a20d780a8406",
            "created_at": "2023-01-06T13:46:38.790766Z",
            "updated_at": "2025-03-27T02:00:02.919758Z",
            "deleted_at": null,
            "main_name": "MUSTANG PANDA",
            "aliases": [
                "TEMP.HEX",
                "TA416",
                "TANTALUM",
                "Twill Typhoon",
                "Earth Preta",
                "Stately Taurus",
                "LuminousMoth",
                "Polaris",
                "BRONZE PRESIDENT",
                "HoneyMyte",
                "Red Lich"
            ],
            "source_name": "MISPGALAXY:MUSTANG PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9baa7519-772a-4862-b412-6f0463691b89",
            "created_at": "2022-10-25T15:50:23.354429Z",
            "updated_at": "2025-03-27T02:00:55.45162Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Mustang Panda",
                "TA416",
                "RedDelta",
                "BRONZE PRESIDENT"
            ],
            "source_name": "MITRE:Mustang Panda",
            "tools": [
                "Cobalt Strike",
                "RCSession",
                "NBTscan",
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2ee03999-5432-4a65-a850-c543b4fefc3d",
            "created_at": "2022-10-25T16:07:23.882813Z",
            "updated_at": "2025-03-27T02:02:10.0116Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Bronze President",
                "Camaro Dragon",
                "Earth Preta",
                "HoneyMyte",
                "Mustang Panda",
                "Operation SMUGX",
                "Operation SmugX",
                "PKPLUG",
                "Red Lich",
                "Stately Taurus",
                "TEMP.Hex"
            ],
            "source_name": "ETDA:Mustang Panda",
            "tools": [
                "9002 RAT",
                "AdFind",
                "Agent.dhwf",
                "Agentemis",
                "CHINACHOPPER",
                "China Chopper",
                "Chymine",
                "ClaimLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "DCSync",
                "DOPLUGS",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Farseer",
                "Gen:Trojan.Heur.PT",
                "HOMEUNIX",
                "Hdump",
                "HenBox",
                "HidraQ",
                "Hodur",
                "Homux",
                "HopperTick",
                "Hydraq",
                "Impacket",
                "Kaba",
                "Korplug",
                "LadonGo",
                "MQsTTang",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "NBTscan",
                "NetSess",
                "Netview",
                "Orat",
                "POISONPLUG.SHADOW",
                "PUBLOAD",
                "PVE Find AD Users",
                "PlugX",
                "Poison Ivy",
                "PowerView",
                "QMAGENT",
                "RCSession",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Sogu",
                "TIGERPLUG",
                "TONEINS",
                "TONESHELL",
                "TVT",
                "TeamViewer",
                "Thoper",
                "TinyNote",
                "WispRider",
                "WmiExec",
                "XShellGhost",
                "Xamtrav",
                "Zupdax",
                "cobeacon",
                "nbtscan",
                "nmap",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536103,
    "ts_updated_at": 1743041807,
    "ts_creation_date": 1669661627,
    "ts_modification_date": 1669661627,
    "files": {
        "pdf": "https://archive.orkl.eu/081d4a2b113bfcdcd80b9de6b0975312caaabdbf.pdf",
        "text": "https://archive.orkl.eu/081d4a2b113bfcdcd80b9de6b0975312caaabdbf.txt",
        "img": "https://archive.orkl.eu/081d4a2b113bfcdcd80b9de6b0975312caaabdbf.jpg"
    }
}