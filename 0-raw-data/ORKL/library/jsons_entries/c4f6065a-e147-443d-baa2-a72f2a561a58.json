{
    "id": "c4f6065a-e147-443d-baa2-a72f2a561a58",
    "created_at": "2023-01-12T15:03:57.267248Z",
    "updated_at": "2025-03-27T02:10:04.928572Z",
    "deleted_at": null,
    "sha1_hash": "a38871871c47155f67d82889f158861f3ee5230f",
    "title": "2022-07-18 - Ongoing Roaming Mantis smishing campaign targeting France",
    "authors": "",
    "file_creation_date": "2022-08-18T03:21:25Z",
    "file_modification_date": "2022-08-18T03:21:25Z",
    "file_size": 1541582,
    "plain_text": "# Ongoing Roaming Mantis smishing campaign targeting France\n\n**[blog.sekoia.io/ongoing-roaming-mantis-smishing-campaign-targeting-france/](https://blog.sekoia.io/ongoing-roaming-mantis-smishing-campaign-targeting-france/)**\n\n18 July 2022\n\n_This blog post on Roaming Mantis group is an extract of the “FLINT 2022-037 – Ongoing_\n**_[Roaming Mantis smishing campaign targeting France” report (SEKOIA.IO Flash](https://www.sekoia.io/en/sekoia-io-cti/)_**\n_Intelligence) sent to our clients on July 07, 2022._\n\n## Summary\n\nOn July 4, 2022, a SEKOIA.IO analyst received phishing SMS (also called smishing)\nembedding a malicious URL. The URL either deploys the MoqHao Android malware, or\nredirects to an Apple login details credential harvesting page. Analysing this smishing activity\nled us to identify an active campaign targeting France wide victims.\n\n\n-----\n\nObserved modus operandi during the ongoing campaign targeting French mobile phone\nusers is congruent with past observed Roaming Mantis’ activities documented by multiple\nsecurity vendors. The campaigns distributing MoqHao in Japan, South Korea, Taiwan,\nGermany, France, the UK and the US, have similar techniques. Our investigation shows that\n**this campaign widely impacts France and possibly results in around 70.000 Android**\ndevice compromises.\n\n**MoqHao (aka Wroba, XLoader for Android) is an Android Remote Access Trojan (RAT)**\n**with information-stealing and backdoor capabilities that likely spreads via SMS.It is**\nattributed to Roaming Mantis, assessed to be a financially motivated Chinese threat group.\n\nSEKOIA.IO analysts monitor and track this threat since the beginning of 2022. In this blog\npost, we describe each step of the ongoing smishing campaign and share our investigation\non Roaming Mantis’ infrastructure.\n\n## Ongoing smishing campaign\n\n[The Roaming Mantis smishing campaign was first observed by SEKOIA.IO analysts through](https://sekoia.io/en)\nfour malicious SMS received on two mobile phones. The distribution campaign shows\ngeofencing and operating system checking capabilities. We assess that these features allow\nRoaming Mantis to tailor their attack, as well as hinder analysis and detection efforts.\n\nHere is an overview of the infection chain depending on the victim’s location (based on their\nIP address) and operating system (based on its user-agent).\n\n\n-----\n\n_Figure 1. MoqHao’s infection chain_\n\n### Step-by-step MoqHao’s compromise\n\nThe initial attack vector is a text message distributed by SMS and containing a malicious\nURL, as shown in the following figure.\n\n\n-----\n\n_Figure 2. Phishing SMS (translated from French: “Your package has been sent. Please_\n_check it and receive it.”)_\n\nIf the target clicks on the link, an HTTP request is sent to the server. Depending on the\nlocation of the victim (likely inferred from its IP address), and its operating system (inferred\nfrom the user-agent), the server responds:\n\nNothing (404 Not found), if the victim’s device is not located in France;\nAn HTML page containing JavaScript code displaying an alert and redirecting to an\nAPK (Android Package Kit) file, if the mobile is located in France and runs Android;\nA fake Apple login web page, if the mobile is located in France and is an iPhone.\n\nThe smishing campaign is therefore geofenced and aims to install Android malware, or\ncollect Apple iCloud credentials.\n\nIf the victim’s mobile phone is running the Android operating system, a message entices the\n[victim to download the malicious APK as a web browser update (SHA256:](https://blog.sekoia.io/bumblebee-a-new-trendy-loader-for-initial-access-brokers/)\n3ba2b1c0352ea9988edeb608abf2c0 37b1f30482bbc05c3ae79265bab7a44c9). This file\n[corresponds to the MoqHao malware according to the analysis of the Hatching Triage](https://tria.ge/220706-pm7tmscgcp)\nsandbox.\n\nOnce the victim downloaded and executed the malware, the application requests permission\nto read and send SMS messages. This permission allows the malware, among other things,\nto intercept SMS from victims’ mobile phones. It is worth noting the studied MoqHao sample\nmimics the Chrome application to lure the victim to give the permission.\n\n\n-----\n\nThe malware then retrieves its C2 server by requesting one of the social network profiles\nstored in the payload. In the analysed sample, the profiles are: shaoye77, shaoye88 and\nshaoye99 on Imgur service. In the above Triage analysis, the malware requests the profile\nshaoye99 on the legitimate image hosting service Imgur\n(hxxps://imgur[.]com/user/shaoye99/about).\n\nAs shown in the figure, the “about” section contains the string\n“bgfrewiFaRPCdEp9o0GfWPL3dhKU2 uwZh-Z7eg9bgfrewi” which embeds the DESencrypted C2 server contained between the markers “bgfrewi”. By using the following recipe\nin CyberChef, we obtain the final IP address and port pair (107.148.243[.]103:28867).\n\n_Figure 4. CyberChef recipe to decrypt the string containing the C2 server_\n\nIt is worth noting the character “-” is replaced by “+” in URL safe Base64 encoding\nrepresentation. Since 2020, the DES key and IV (41 62 35 64 31 51 33 32) are unchanged.\n\n[Discover our CTI and XDR products](https://sekoia.io/en/contact/)\n\n## Analysis of the Roaming Mantis campaign\n\n**Chinese intrusion set Roaming Mantis is assessed to be a financially motivated group,**\nwith a history of targeting developed countries.\n\nIn addition to the received message, several French people are currently reporting this\ncampaign on Twitter, as well as on French websites dedicated to phishing. As reported by\n[Kaspersky and](https://securelist.com/roaming-mantis-reaches-europe/105596/) [Team Cymru in early 2022, and based on our observation of more than](https://team-cymru.com/blog/2021/08/11/moqhao-part-1-5-high-level-trends-of-recent-campaigns-targeting-japan/)\n\n\n-----\n\n**90.000 unique IP addresses that requested the C2 server distributing MoqHao, we**\nconfirm that the threat group Roaming Mantis currently focuses on France.\n\nThis activity leveraging MoqHao or Apple IDs’ credential harvesting pages notably provides\nRoaming Mantis access to data from the local system, SD card, applications, messages or\ncontact list, iCloud backups, iMessage, call history, as well as allowing remote interaction\nwith a victims’ device.\n\nWe assess Roaming Mantis’ wide collection of sensitive data could be further used in\nextortion schemes, sold to other threat groups or possibly leveraged in “Big Game Hunting”\noperations.\n\n## Roaming Mantis infrastructure\n\nWe noticed two different infection chains depending on the user-agent of the target. In the\nfollowing sections, we describe the infrastructure associated with these attack chains.\n\n**Android payloads**\n\nThe infrastructure hosting Android payloads was detailed by Team Cymru in their part 2\nblogpost from April 2022. According to our analysis, this infrastructure still has the same\ncharacteristics:\n\nServers are used to target only one country, meaning if an IP address from another\ncountry contacts the servers, it will get a 404 error.\nThe open ports on the servers are still the same:\nTCP/443,TCP/5985,TCP/10081andTCP/47001.\nThe certificate identified in April is still in use on these servers:\n\nSHA1: 834024f91f67445a7fd1a98689cb3f49b4c3ade7\nSHA256:\n76de629b3e446e99d45541e95da0bfa18db43a48daa23f5551fdbde0c295a36c\n\n**Apple phishing**\n\nSEKOIA analysts also studied the infrastructure of Apple phishing pages:\n\nThose servers have the following ports open: TCP/80, TCP/5432, TCP/5985 and\nTCP/47001.\nThe landing page mimics the Apple ID login page. As the Android infrastructure, the\ngeofencing is set and the landing page language matches the language of targeted\nusers.\n\n\n-----\n\n_Figure 5. Apple ID phishing page in French (source: urlscan)_\n\nThose pages can be tracked on scanning services like urlscan using hashes of subressources requested by the main page such as Card.js file\n(6d5516bbbebba2d51878f1e791b642f3b2944270b8e 84770f15a16376b202213).\n\n**Domains**\n\nDomains used inside SMS messages are either registered with Godaddy or use dynamic dns\nservices such as duckdns.org. The intrusion set uses more than hundreds subdomains.\nIndeed each IP address is resolved by dozens of FQDN (eg: more than 5000 FQDN resolve\nto 134[.]119[.]205[.]21). As it is complex to list all domains, SEKOIA rather tracks associated\nIP addresses to monitor this intrusion set.\n\n**MoqHao C2 server**\n\nRoaming Mantis uses a separate infrastructure for the MoqHao C2 servers.\n\nAt the time of writing, we were able to identify 9 servers hosted on EHOSTIDC and\nVELIANET Autonomous Systems.\n\n\n-----\n\nAll infrastructures are monitored by SEKOIA internal project SEKOIA C2 Trackers and can\nbe found in our Intelligence Center portal.\n\n[Discover our CTI and XDR products](https://sekoia.io/en/contact/)\n\n## MITRE ATT&CK TTPs\n\n**T1583.001 – Acquire Infrastructure: Domains**\n\n**T1583.004 – Acquire Infrastructure: Server**\n\n**T1583.006 – Acquire Infrastructure: Web Services**\n\n**T1566.002 – Phishing: Spearphishing Link**\n\n**T1204.001 – User Execution: Malicious Link**\n\n**T1102.001 – Web Service: Dead Drop Resolver**\n\n**T1071.001 – Application Layer Protocol: Web Protocols**\n\n**T1041 – Exfiltration Over C2 Channel**\n\n## MoqHao malware IOCs & Technical Details\n\n**Domains contained in SMS**\n```\ncoqrf.xpddg[.]com\n\nznjjq.udsuc[.]com\n\ngesee.udsuc[.]com\n\nbswhd.mrheu[.]com\n\nxpddg[.]com\n\nudsuc[.]com\n\nmrheu[.]com\n\n```\n**Malicious APK**\n```\n83ba2b1c0352ea9988edeb608abf2c037b1f30482bbc05c3ae79265bab7a44c9\n\n```\n**APK permissions**\n\n\n-----\n\n```\nandroid.permission.BROADCAST_SMS\n\nandroid.permission.BROADCAST_WAP_PUSH\n\nandroid.permission.SEND_RESPOND_VIA_MESSAGE\n\nandroid.permission.ACCESS_WIFI_STATE\n\nandroid.permission.BROADCAST_WAP_PUSH\n\nandroid.permission.SEND_RESPOND_VIA_MESSAGE\n\nandroid.permission.ACCESS_WIFI_STATE\n\nandroid.permission.CHANGE_NETWORK_STATE\n\nandroid.permission.CALL_PHONE\n\nandroid.permission.WRITE_EXTERNAL_STORAGE\n\nandroid.permission.READ_EXTERNAL_STORAGE\n\nandroid.permission.ACCESS_NETWORK_STATE\n\nandroid.permission.MODIFY_AUDIO_SETTINGS\n\nandroid.permission.RECEIVE_BOOT_COMPLETED\n\nandroid.permission.WAKE_LOCK\n\nandroid.permission.INTERNET\n\nandroid.permission.RECEIVE_SMS\n\nandroid.permission.READ_SMS\n\nandroid.permission.WRITE_SMS\n\nandroid.permission.SEND_SMS\n\nandroid.permission.SYSTEM_ALERT_WINDOW\n\nandroid.permission.READ_CONTACTS\n\nandroid.permission.READ_PHONE_STATE\n\nandroid.permission.GET_ACCOUNTS\n\n```\n**Android payload servers**\n```\n134[.]119[.]193[.]106\n\n134[.]119[.]193[.]108\n\n134[.]119[.]193[.]109\n\n134[.]119[.]193[.]110\n\n134[.]119[.]205[.]18\n\n134[.]119[.]205[.]21\n\n134[.]119[.]205[.]22\n\n142[.]0[.]136[.]49\n\n142[.]0[.]136[.]50\n\n142[.]0[.]136[.]52\n\n142[.]4[.]97[.]105\n\n142[.]4[.]97[.]106\n\n142[.]4[.]97[.]107\n\n142[.]4[.]97[.]108\n\n142[.]4[.]97[.]109\n\n146[.]0[.]74[.]157\n\n```\n\n-----\n\n```\n146[.]0[.]74[.]197\n\n146[.]0[.]74[.]199\n\n146[.]0[.]74[.]202\n\n146[.]0[.]74[.]203\n\n146[.]0[.]74[.]205\n\n146[.]0[.]74[.]206\n\n146[.]0[.]74[.]228\n\n192[.]51[.]188[.]107\n\n192[.]51[.]188[.]108\n\n192[.]51[.]188[.]109\n\n192[.]51[.]188[.]142\n\n192[.]51[.]188[.]145\n\n192[.]51[.]188[.]146\n\n27[.]124[.]36[.]32\n\n27[.]124[.]36[.]34\n\n27[.]124[.]36[.]52\n27[.]124[.]39[.]241\n\n27[.]124[.]39[.]242\n\n27[.]124[.]39[.]243\n\n91[.]204[.]227[.]19\n\n91[.]204[.]227[.]20\n\n91[.]204[.]227[.]21\n\n91[.]204[.]227[.]22\n\n91[.]204[.]227[.]23\n\n91[.]204[.]227[.]24\n\n91[.]204[.]227[.]25\n\n91[.]204[.]227[.]26\n\n91[.]204[.]227[.]27\n\n91[.]204[.]227[.]28\n\n```\n**Apple phishing servers**\n```\n172[.]81[.]131[.]12\n\n172[.]81[.]131[.]14\n\n172[.]81[.]131[.]10\n\n172[.]81[.]131[.]11\n\n172[.]81[.]131[.]13\n\n103[.]80[.]134[.]41\n\n103[.]80[.]134[.]40\n\n103[.]80[.]134[.]42\n\n```\n**MoqHao C2 servers**\n\n\n-----\n\n```\n61[.]97[.]248[.]6\n\n61[.]97[.]248[.]7\n\n61[.]97[.]248[.]8\n\n61[.]97[.]248[.]9\n\n103[.]249[.]28[.]206\n\n103[.]249[.]28[.]207\n\n103[.]249[.]28[.]208\n\n103[.]249[.]28[.]209\n\n92[.]204[.]255[.]172\n\n```\n**Imgur profile used as Dead Drop resolvers**\n```\nhxxps://imgur[.]com/user/shaoye99/about\n\nhxxps://imgur[.]com/user/shaoye88/about\n\nhxxps://imgur[.]com/user/shaoye77/about\n\nhxxps://imgur[.]com/user/shaoye66/about\n\nhxxps://imgur[.]com/user/shaoye55/about\n\nhxxps://imgur[.]com/user/shaoye44/about\n\nhxxps://imgur[.]com/user/shaoye33/about\n\nhxxps://imgur[.]com/user/shaoye22/about\n\nhxxps://imgur[.]com/user/shaoye11/about\n\n```\nIoCs are available on the SEKOIA.IO Community Github: https://github.com/SEKOIAIO/Community/blob/main/IOCs/roamingmantis/roaming_mantis_iocs_20220718.csv\n\nMore IoCs related to MoqHao malware or Roaming Mantis intrusion set are available on\nSEKOIA.IO for our XDR and CTI customers.\n\n## Chat with our team!\n\nWould you like to know more about our solutions? Do you want to discover our XDR and CTI\nproducts? Do you have a cybersecurity project in your organization? Make an appointment\nand meet us!\n\n**[Contact us](https://www.sekoia.io/en/contact/)**\nYou can find out [how we track threats on our SOC platform SEKOIA.IO.](https://www.sekoia.io/en/continuously-tracking-threats/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-18 - Ongoing Roaming Mantis smishing campaign targeting France.pdf"
    ],
    "report_names": [
        "2022-07-18 - Ongoing Roaming Mantis smishing campaign targeting France.pdf"
    ],
    "threat_actors": [
        {
            "id": "f9bc28d0-ce98-4991-84ae-5036e5f9d4e3",
            "created_at": "2022-10-25T16:07:24.546437Z",
            "updated_at": "2025-03-27T02:02:10.277573Z",
            "deleted_at": null,
            "main_name": "Roaming Mantis",
            "aliases": [
                "Roaming Mantis Group",
                "Shaoye"
            ],
            "source_name": "ETDA:Roaming Mantis",
            "tools": [
                "MoqHao",
                "Roaming Mantis",
                "SmsSpy",
                "Wroba",
                "XLoader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c94cb0e9-6fa9-47e9-a286-c9c9c9b23f4a",
            "created_at": "2023-01-06T13:46:38.823793Z",
            "updated_at": "2025-03-27T02:00:02.928254Z",
            "deleted_at": null,
            "main_name": "Roaming Mantis",
            "aliases": [
                "Roaming Mantis Group"
            ],
            "source_name": "MISPGALAXY:Roaming Mantis",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535837,
    "ts_updated_at": 1743041404,
    "ts_creation_date": 1660792885,
    "ts_modification_date": 1660792885,
    "files": {
        "pdf": "https://archive.orkl.eu/a38871871c47155f67d82889f158861f3ee5230f.pdf",
        "text": "https://archive.orkl.eu/a38871871c47155f67d82889f158861f3ee5230f.txt",
        "img": "https://archive.orkl.eu/a38871871c47155f67d82889f158861f3ee5230f.jpg"
    }
}