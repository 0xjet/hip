{
    "id": "756f1b82-3280-4230-8faf-e59214d29549",
    "created_at": "2022-10-25T16:48:14.875765Z",
    "updated_at": "2025-03-27T02:15:02.674503Z",
    "deleted_at": null,
    "sha1_hash": "2854f4326f7784a76a6bccec982f76334fea02dd",
    "title": "Longhorn: Tools used by cyberespionage group",
    "authors": "Symantec",
    "file_creation_date": "2018-08-10T12:03:14Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 58068,
    "plain_text": "# Longhorn: Tools used by cyberespionage group linked to Vault 7\n\n**[symantec.com/connect/blogs/longhorn-tools-used-cyberespionage-group-linked-vault-7](https://www.symantec.com/connect/blogs/longhorn-tools-used-cyberespionage-group-linked-vault-7)**\n\nApril 9, 2017\n\nFirst evidence linking Vault 7 tools to known cyberattacks.\n\n[By: Symantec Security ResponseSymantec Employee](https://www.symantec.com/connect/user/symantec-security-response)\n\nCreated 10 Apr 2017\n: [简体中文,](https://www.symantec.com/connect/zh-hans/blogs/longhorn-vault-7) [日本語](https://www.symantec.com/connect/ja/blogs/longhorn-vault-7-0)\n\nSpying tools and operational protocols detailed in the recent Vault 7 leak have been used in\ncyberattacks against at least 40 targets in 16 different countries by a group Symantec calls\nLonghorn. Symantec has been protecting its customers from Longhorn’s tools for the past\nthree years and has continued to track the group in order to learn more about its tools, tactics,\nand procedures.\n\nThe tools used by Longhorn closely follow development timelines and technical specifications\nlaid out in documents disclosed by WikiLeaks. The Longhorn group shares some of the same\ncryptographic protocols specified in the Vault 7 documents, in addition to following leaked\nguidelines on tactics to avoid detection. Given the close similarities between the tools and\ntechniques, there can be little doubt that Longhorn's activities and the Vault 7 documents are\nthe work of the same group.\n\n## Who is Longhorn?\n\nLonghorn has been active since at least 2011. It has used a range of back door Trojans in\naddition to zero-day vulnerabilities to compromise its targets. Longhorn has infiltrated\ngovernments and internationally operating organizations, in addition to targets in the financial,\ntelecoms, energy, aerospace, information technology, education, and natural resources\nsectors. All of the organizations targeted would be of interest to a nation-state attacker.\n\nLonghorn has infected 40 targets in at least 16 countries across the Middle East, Europe, Asia,\nand Africa. On one occasion a computer in the United States was compromised but, following\ninfection, an uninstaller was launched within hours, which may indicate this victim was infected\nunintentionally.\n\n#Vault7 linked #Longhorn group infiltrated governments, international orgs, other targets\n\n## The link to Vault 7\n\nA number of documents disclosed by WikiLeaks outline specifications and requirements for\nmalware tools. One document is a development timeline for a piece of malware called\n\n|Symantec Security Response|Symantec Employee|\n|---|---|\n\n\n-----\n\nSymantec. New features in Corentry consistently appeared in samples obtained by Symantec\neither on the same date listed in the Vault 7 document or several days later, leaving little doubt\nthat Corentry is the malware described in the leaked document.\n\nEarly versions of Corentry seen by Symantec contained a reference to the file path for the\nFluxwire program database (PDB) file. The Vault 7 document lists removal of the full path for\nthe PDB as one of the changes implemented in Version 3.5.0.\n\nUp until 2014, versions of Corentry were compiled using GCC. According to the Vault 7\ndocument, Fluxwire switched to a MSVC compiler for version 3.3.0 on February 25, 2015. This\nwas reflected in samples of Corentry, where a version compiled on February 25, 2015 had\nused MSVC as a compiler.\n\n**Embedded**\n\n**Date/time** **Corentry** **Vault 7** **Vault 7**\n**of sample** **version** **Corentry** **changelog** **changelog**\n\n**Corentry sample (MD5 hash)** **compilation** **number** **compiler** **number** **date**\n\nN/A N/A N/A N/A 2.1.0 - Jan 12,\n2.4.1 2011 - Feb\n\n28, 2013\n\n\ne20d5255d8ab1ff5f157847d2f3ffb25 23/08/2013\n10:20\n\n5df76f1ad59e019e52862585d27f1de2 21/02/2014\n11:07\n\n318d8b61d642274dd0513c293e535b38 15/05/2014\n09:01\n\n\n3.0.0 GCC 3.0.0 Aug 23,\n2013\n\n3.1.0 GCC 3.1.0 Feb 20,\n2014\n\n3.1.1 GCC 3.1.1 May 14,\n2014\n\n\nN/A N/A N/A N/A 3.2.0 Jul 15,\n2014\n\n\n511a473e26e7f10947561ded8f73ffd0 03/09/2014\n00:12\n\nc06d422656ca69827f63802667723932 25/02/2015\n16:50\n\n\n3.2.1 GCC 3.2.1 Aug 18,\n2014\n\nN/A MSVC 3.3.0 Feb 25,\n2015\n\n\nN/A N/A N/A N/A 3.3.1 ->\n3.5.0\n\n\nMay 17,\n2015 ->\nNov 13,\n2015\n\n\n_Table. Corentry version numbers and compilation dates compared to Fluxwire version_\n_numbers and changelog dates disclosed in Vault 7_\n\nA second Vault 7 document details Fire and Forget, a specification for user-mode injection of a\npayload by a tool called Archangel. The specification of the payload and the interface used to\n[load it was closely matched in another Longhorn tool called Backdoor.Plexor.](https://www.symantec.com/security_response/writeup.jsp?docid=2017-040703-3623-99)\n\nA third document outlines cryptographic protocols that malware tools should follow. These\n\n\n-----\n\nalign with the cryptographic practices observed by Symantec in all of the Longhorn tools.\n\nOther Vault 7 documents outline tradecraft practices to be used, such as use of the Real-time\nTransport Protocol (RTP) as a means of command and control (C&C) communications,\nemploying wipe-on-use as standard practice, in-memory string de-obfuscation, using a unique\ndeployment-time key for string obfuscation, and the use of secure erase protocols involving\nrenaming and overwriting. Symantec has observed Longhorn tools following all of these\npractices. While other malware families are known to use some of these practices, the fact that\nso many of them are followed by Longhorn makes it noteworthy.\n\n## Global reach: Longhorn’s operations\n\nWhile active since at least 2011, with some evidence of activity dating back as far as 2007,\nLonghorn first came to Symantec’s attention in 2014 with the use of a zero-day exploit (CVE2014-4148) embedded in a Word document to infect a target with Plexor.\n\nThe malware had all the hallmarks of a sophisticated cyberespionage group. Aside from\naccess to zero-day exploits, the group had preconfigured Plexor with elements that indicated\nprior knowledge of the target environment.\n\nTo date, Symantec has found evidence of Longhorn activities against 40 targets spread across\n16 different countries. Symantec has seen Longhorn use four different malware tools against\n[its targets: Corentry, Plexor, Backdoor.Trojan.LH1, and Backdoor.Trojan.LH2.](https://www.symantec.com/security_response/writeup.jsp?docid=2017-040703-1537-99)\n\nBefore deploying malware to a target, the Longhorn group will preconfigure it with what\nappears to be target-specific code words and distinct C&C domains and IP addresses for\ncommunications back to the attackers. Longhorn tools have embedded capitalized code\nwords, internally referenced as “groupid” and “siteid”, which may be used to identify campaigns\nand victims. Over 40 of these identifiers have been observed, and typically follow the theme of\nmovies, characters, food, or music. One example was a nod to the band The Police, with the\ncode words REDLIGHT and ROXANNE used.\n\nLonghorn’s malware has an extensive list of commands for remote control of the infected\ncomputer. Most of the malware can also be customized with additional plugins and modules,\nsome of which have been observed by Symantec.\n\nLonghorn’s malware appears to be specifically built for espionage-type operations, with\ndetailed system fingerprinting, discovery, and exfiltration capabilities. The malware uses a high\ndegree of operational security, communicating externally at only select times, with upload\nlimits on exfiltrated data, and randomization of communication intervals—all attempts to stay\nunder the radar during intrusions.\n\nFor C&C servers, Longhorn typically configures a specific domain and IP address combination\nper target. The domains appear to be registered by the attackers; however they use privacy\n\ni t hid th i l id tit Th IP dd t i ll d b l iti t\n\n\n-----\n\ncommunicates with C&C servers over HTTPS using a custom underlying cryptographic\nprotocol to protect communications from identification.\n\nPrior to the Vault 7 leak, Symantec’s assessment of Longhorn was that it was a well-resourced\norganization which was involved in intelligence gathering operations. This assessment was\nbased on its global range of targets and access to a range of comprehensively developed\nmalware and zero-day exploits. The group appeared to work a standard Monday to Friday\nworking week, based on timestamps and domain name registration dates, behavior which is\nconsistent with state-sponsored groups.\n\nSymantec’s analysis uncovered a number of indicators that Longhorn was from an Englishspeaking, North American country. The acronym MTWRFSU (Monday Tuesday Wednesday\nThuRsday Friday Saturday SUnday) was used to configure which day of the week malware\nwould communicate with the attackers. This acronym is common in academic calendars in\nNorth America. Some of the code words found in the malware, such as SCOOBYSNACK,\nwould be most familiar in North America. In addition to this, the compilation times of tools with\nreliable timestamps indicate a time zone in the Americas.\n\n## Distinctive fingerprints\n\nLonghorn has used advanced malware tools and zero-day vulnerabilities to infiltrate a string of\ntargets worldwide. Taken in combination, the tools, techniques, and procedures employed by\nLonghorn are distinctive and unique to this group, leaving little doubt about its link to Vault 7.\n\nThroughout its investigation of Longhorn, Symantec’s priority has been protection of its\ncustomers. Through identifying different strains of Longhorn malware, connecting them to a\nsingle actor, and learning more about the group’s tactics and procedures, Symantec has been\nable to better defend customer organizations against this and similar threats. In publishing this\nnew information, Symantec’s goal remains unchanged: to reassure customers that it is aware\nof this threat and actively working to protect them from it.\n\n## Protection\n\nSymantec and Norton products have been protecting against Longhorn malware for a number\nof years with the following detections:\n\n[Tags: Products, Endpoint Protection, Endpoint Protection Cloud, Security Response,](https://www.symantec.com/connect/search?filters=im_vid_31:691)\n[AIT, APT, Backdoor.Plexor,,, Investigation, Longhorn, Trojan.Corentry, Vault 7](https://www.symantec.com/connect/search?filters=im_vid_111:102921)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/jpmrhxe5hbpjv7l7a8x0hlusep41zo5q"
    ],
    "report_names": [
        "Symantec_Longhorn-Tools(04-10-2017)"
    ],
    "threat_actors": [
        {
            "id": "23dfc9f5-1862-4510-a6ae-53d8e51f17b1",
            "created_at": "2024-05-01T02:03:08.146025Z",
            "updated_at": "2025-03-27T02:05:17.420497Z",
            "deleted_at": null,
            "main_name": "PLATINUM TERMINAL",
            "aliases": [
                "Longhorn ",
                "The Lamberts ",
                "Vault7 ",
                "APT-C-39 "
            ],
            "source_name": "Secureworks:PLATINUM TERMINAL",
            "tools": [
                " Assassin",
                " Marble Framework",
                "AfterMidnight"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e993faab-f941-4561-bd87-7c33d609a4fc",
            "created_at": "2022-10-25T16:07:23.460301Z",
            "updated_at": "2025-03-27T02:02:09.814816Z",
            "deleted_at": null,
            "main_name": "Longhorn",
            "aliases": [
                "APT-C-39",
                "Platinum Terminal",
                "The Lamberts"
            ],
            "source_name": "ETDA:Longhorn",
            "tools": [
                "Black Lambert",
                "Blue Lambert",
                "Corentry",
                "Cyan Lambert",
                "Fluxwire",
                "Gray Lambert",
                "Green Lambert",
                "Magenta Lambert",
                "Pink Lambert",
                "Plexor",
                "Purple Lambert",
                "Silver Lambert",
                "Violet Lambert",
                "White Lambert"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "70db80bd-31b7-4581-accb-914cd8252913",
            "created_at": "2023-01-06T13:46:38.57727Z",
            "updated_at": "2025-03-27T02:00:02.865012Z",
            "deleted_at": null,
            "main_name": "Longhorn",
            "aliases": [
                "the Lamberts",
                "APT-C-39",
                "PLATINUM TERMINAL"
            ],
            "source_name": "MISPGALAXY:Longhorn",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041702,
    "ts_creation_date": 1533902594,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/2854f4326f7784a76a6bccec982f76334fea02dd.pdf",
        "text": "https://archive.orkl.eu/2854f4326f7784a76a6bccec982f76334fea02dd.txt",
        "img": "https://archive.orkl.eu/2854f4326f7784a76a6bccec982f76334fea02dd.jpg"
    }
}