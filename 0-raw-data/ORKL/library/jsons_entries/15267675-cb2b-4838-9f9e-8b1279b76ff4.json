{
    "id": "15267675-cb2b-4838-9f9e-8b1279b76ff4",
    "created_at": "2022-10-25T16:48:22.804705Z",
    "updated_at": "2025-03-27T02:05:20.898454Z",
    "deleted_at": null,
    "sha1_hash": "680326f4ffb2f446f27f40fb66eaaae9fd0254fd",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-11-27T03:04:11Z",
    "file_modification_date": "2020-11-27T03:04:11Z",
    "file_size": 5565964,
    "plain_text": "# S2W LAB Analysis of Clop Ransomware suspiciously related to the Recent Incident English)\n\n###### Author: TALON (BLKSMTH, HOTSAUCE)\n\n Date: 2020-11-23\n\n## Executive Summary\n\n\n-----\n\n### • [The ransomware Clop has hit the network of conglomerate and retail giant in ]\n\n###### South Korea which suspended nearly half of stores due to its attack. We have analyzed the ransomware related to the incident and the summary of the analysis can be seen below. \n\n### • [A new variant of the Clop ransomware seems to generate separate key files ]\n\n###### and store encryption keys for each encrypted files as opposed to the previous behavior of changing the file content and extension and saving the encryption key at the final stage\n\n### • [Key File Extension : .cllp]\n • [Key File Header : Cllp^_-]\n • [Ransom Note: We have identified that the contact email used in ransom note ]\n\n###### is identical to the email used by Clop Ransomware on the Dark Web where they leak corporate data when negotiations fails.\n\n### • [We have also detected the same variant of the ransomware that contained ]\n\n###### identical signatures on Virus Total (Build time: Nov-21-2020).\n\n\n-----\n\nExecutive Summary\n\nDistribution\n\nAnalysis of Clop Ransomware (#01)\n\n1) Basic Properties (#01, Marker for Relation Analysis)\n\n2) Malware Behaviour\n\nFull execution flow of Clop ransomware\n\nStage1 (Allocates executable code to memory)\n\nStage2 (Main code to memory allocation after self-deletion)\n\nStage3 (Main malicious code)\n\nRansom Note\n\n1) Contact (E-mail)\n\n2) Leaks Website of Clop Ransomware (ekbgzchl6x2ias37[.]onion)\n\n3) Tor page for negotiation\n\nChat (hxxp://cvfzmngbtwzywfnryt45zro4ocpze7cqdtzj2n6jz7eucpdglsulcsid[.]onion)\n\nAbout Us\n\nBuy Bitcoin\n\nIntelligence Analysis\n\nComparison between current Clop and Clop from first half of the year 2019\n\nPast Ransom Note\n\nSignature information\n\nClop Ransomware(#02) : Identified using the same signature\n\n#02 : 8fc09cb1540a6dea87a078b92c8f2b0a\n\nBasic Properties\n\nMain features\n\nResults after confirming the code with malware activity\n\nKey strings identified in malware\n\nResult of Similarity\n\nIOC\n\nHASH\n\nETC\n\n\n-----\n\n## Distribution\n\n### • [We have yet finalized the deploying patterns but we can assume the intrusion ]\n\n###### technique by referring to previous incidents.\n\n 1. Network intrusion using SMB exploit.\n\n 2. A massive deployment by compromised administrator account of an Active\n Directory.\n\n 3. Malicious document files distributed as attachments via spear phishing\n emails.\n\n## Analysis of Clop Ransomware (#01\n\n### 1 Basic Properties (#01, Marker for Relation Analysis)\n\n##### MD5 : 8b6c413e2539823ef8f8b85900d19724  SHA-1 : 2d92a9ec1091cb801ff86403374594c74210cd44  SHA-256 : 3d94c4a92382c5c45062d8ea0517be4011be8ba42e9c9a614a99 327d0ebdf05b  Type : Win32 EXE (PE32 executable for MS Windows (GUI) Intel 80386 32-bit)  Build Time : 2020-11-20 18�18�18\n\n### 2 Malware Behaviour\n\n#### Full execution flow of Clop ransomware\n\n\n-----\n\n#### Stage1 Allocates executable code to memory)\n\n### • [It is configured to be executed by allocating to the memory (VirtualAlloc) so that ]\n\n###### the structure of the malicious code cannot be understood.\n\n#### Stage2 Main code to memory allocation after self-deletion)\n\n\n-----\n\n### • [Self-deletion is executed after generating ex.bat file]\n\n\n-----\n\n#### Stage3 Main malicious code)\n\n### • [MD5 : 14B7069B25B04EBA875F264BE4F140DA]\n • [Build Time : 2020-11-20 14�35�08]\n\n\n-----\n\n### • [Infection Routine]\n\n###### 1. Run and register itself as a service\n\n### • [Service name : WinCheckDRVs]\n\n###### 2. Uses mutex to check if another instance is running (duplication check)\n\n### • [Mutex name : GKLJHWRnjktn32uyhrjn23io#666]\n\n###### 3. Self execution\n\n### • [Self execute with duplicated token of 'EXPLORER.EXE' and sets \"runrun\" ]\n\n###### as a parameter\n\n 4. Run event log deletion command\n\n```\ncmd.exe /C for /F \\\"tokens=*\\\" %1 in ('wevtutil.exe el') DO\nwevtutil.exe cl \\\"%1\\\"\n\n```\n\n###### 5. Attempts to encrypt the entire drive from A to Z except Floppy Disk, CD-ROM.\n\n### • [RSA Public Key hard coded inside the malware.]\n\n```\n-----BEGIN PUBLIC KEY----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCecUuskA+/EYRGu9HUFkpICA\ne3MeraGTOS8wa6lZfirCt0oRPARUcF1aNVupKfLeqc02BX+MAn3n15EJpoe1SR\niESj5Z+dJl2WBFaYoV/SBg5EQWganz32HN3dhH037t3vrDP7jsQa2lziD32hLd\nSEktD4Gmz87O+0blTQIDAQAB -----END PUBLIC KEY----\n```\n\n\n### • [Skips Desktop path when encrypting files]\n • [Avoids certain files by matching hash value of file name]\n • [Clop passes encrypting certain file extensions:]\n\n • [.CI0P : Previously encrypted file extension]\n • [.OCX : Object linking and embedding files (ActiveX)]\n • [.DLL : Compiled library (dynamic)]\n • [.EXE : Execution file]\n • [.SYS : Driver file]\n\n\n-----\n\n### • [.LNK : Shortcut file]\n • [.ICO : Icon file]\n • [.INI : Initialization file]\n • [.MSI : Installer file]\n • [.CHM : Compiled HTML help file]\n • [.HLF]\n • [.LNG : Language pack file]\n • [.TTF : Font file]\n • [.CMD : Script file]\n • [.BAT : Batch file]\n • [.CLLP : Current encrypted ransomware file]\n • [Encryption technique varies depending on the size of target files]\n\n • [sizeof(TargetFile) < 17KB : Passes encryption]\n • [1.7KB < sizeof(TargetFile) < 2.13MB : Encrypts from 0x4000 to ]\n\n###### EOF(End of File)\n\n### • [Uses general file input/output method]\n • [sizeof(TargetFile) < 2.13MB : 0x10000~0x1F89D0 Encryption]\n\n • [MMF method is used to handle large size files efficiently.]\n • [MMF : Through the Memory Mapped File(MMF), the contents of a ]\n\n###### file in virtual memory space can be linked enabling an application to write the file directly to the memory.\n\n### • [A diagram of encryption method by Clop ransomware]\n\n\n-----\n\n### • [Encryption schemes]\n\n • [Creates a 117byte long key by randomly referencing the 256byte table ]\n\n```\ne3 e4 e5 e6 e7 e8 e9 ea eb ec ed ee ef f0 f1 f2 cd ef 34\n56 78 9a b1 31 41 51 61 71 81 91 a1 b1 c1 d1 e1 fc 3c 4c\n5c 6c 7c 8c 9c ac bc cc dc ec fd 0d 1d 20 12 d3 d4 d5 d6\nd7 d8 d9 da db dc dd de df e0 e1 e2 cd ef 83 84 85 86 87\n88 89 8a 8b 8c 8d 8e 8f 90 91 92 a3 a4 a5 a6 a7 a8 a9 aa\nab ac ad ae af b0 b1 b2 ab 7f 80 81 82 00 01 02 03 04 05\n06 07 08 0b 0c 0e 0f 10 11 12 b3 b4 b5 b6 b7 b8 b9 ba bb\nbc bd be bf c0 c1 c2 93 94 95 96 97 98 99 9a 9b 9c 9d 9e\n9f a0 a1 a2 f3 f4 f5 f6 f7 f8 f9 fa fb fc fd fe ff\n\n```\n\n\n###### [Encryption schemes]\n\n### • [Creates a 117byte long key by randomly referencing the 256byte table ]\n\n###### below (Mersenne Twister algorithm is used when generating the random number)\n```\n    e3 e4 e5 e6 e7 e8 e9 ea eb ec ed ee ef f0 f1 f2 cd ef 34\n\n```\n\n\n### • [117byte default key is used when creation fails ]\n\n```\nab 9d 89 0a b9 2b ba fa 19 f2 10 21 4c 9c 6a 7f 3a 31 8b\nfd e9 ff fa 6c f1 f1 11 8e b6 c7 81 17 a5 b2 89 ad 1e 78\nfa e3 82 83 1b cd 9d 92 ad dc c5 d8 b1 8d 01 1b b2 f1 b9\n89 e2 c7 41 71 e2 f7 a3 1d 6c aa 28 0c 6e db 3c f8 fd 10\n1f b1 f1 b9 89 8e\n\n```\n\n\n### • [117byte key is used as RC4 algorithm key to encrypt the original data, ]\n\n###### then updates\n\n### • [It overwrites the encrypted data rather than deleting the original ]\n\n###### file\n\n### • [Key storage file [encryption target file name].cllp is created to ]\n\n###### manage encryption keys per file\n\n### • [Key File Header : Cllp^_- (7byte)]\n\n\n-----\n\n### • [Key File Data : 117byte RC4 Key (128byte) encrypted by RSA ]\n\n###### public Key\n\n### • [135 bytes fixed in total]\n\n###### 6. Tours around shared folders and attempts to encrypt\n\n### • [Including Desktop path]\n • [Identical encrypting schemes is used to encrypt afterwards]\n\n###### 7. Attempts to encrypt files from the C Drive\n\n 8. Ransom note created in every encrypted file\n\n### • [Ransom note file name : README_README.txt]\n • [Ransom note created by following procedure]\n\n • [Extract encoded data in resource section inside malicious code]\n\n • [Resource ID : 39339, Resource NAME : ID_HTML]\n • [Extract the original data by XOR decoding the resource data and the ]\n\n###### table below\n```\n          JKHfg34789t6y8f9JLKHFUEWir3289457yfnKLSFEj2jk34y57823fjvsdi\n\n### • [When Command line parameter = temp.dat]\n\n###### 1. Reads temp.dat upon execution and attempts to only encrypt the path that\n has been specified\n\n### • [Function exists, however is the option that is not executed from the actual ]\n\n###### code\n\n## Ransom Note\n\n```\n\n-----\n\n```\n  HELLO DEAR KMALL *DO NOT ATTEMPT TO RESTORE OR MOVE THE FILES YOURSELF. T\n  THEM* Also, we have stolen very important information from your servers.\n  for details. If you refuse to cooperate, all data will be published for f\n  our portal (USE TOR BROWSER): http://ekbgzchl6x2ias37[.]onion/ CONTACTS:\n  dinoriuss1973@tutanota[.]com AND unlock@support-box[.]com OR unlock@suppo\n  WRITE TO THE CHAT (USE TOR BROWSER):\n  http://cvfzmngbtwzywfnryt45zro4ocpze7cqdtzj2n6jz7eucpdglsulcsid[.]onion/r\n  7c5a-4b5d-9e19-3610beadffc6?secret=km2021\n\n### 1 Contact E-mail)\n\n##### dinoriuss1973@tutanota[.]com  unlock@support-box[.]com  unlock@support-iron[.]com\n\n### • [Contact (E-mail addresses) information is identical with the information from the ]\n\n###### Darkweb website that list-up the Clop ransomware victims (Leaks Website*).\n\n### 2 Leaks Website of Clop Ransomware (ekbgzchl62ias37.]onion)\n\n```\n\n-----\n\n### • Number of Clop Ransomware Victims on the Darkweb: 17\n • Data uploading cycle for negotiated firm: Approximately 7 days – 1 month\n • Uploaded Data\n\n • Employee credential\n • Employee emails\n • Accounting related information\n • ETC\n\n\n-----\n\n### 3 Tor page for negotiation\n\n#### Chat (hxxp://cvfzmngbtwzywfnryt45zro4ocpze7cqdtzj2n6jz7eucpd glsulcsid[.]onion)\n\n About Us\n\n\n-----\n\n#### Buy Bitcoin\n\n\n-----\n\n## Intelligence Analysis\n\n### Comparison between current Clop and Clop from first half of the year 2019\n\n Past Ransom Note\n\n\n-----\n\n```\n!!!Your networks has been penetrated!!! All files on each host in the\nnetwork have been encrypted with a strong algorithm! Backups were\neither encrypted or deleted or backup disks were formatted! Shadow\ncopies also removed, so F8 or any other methods may damage encrypted\ndata but not recover! We exclusively have decryption software for your\nsituation! No decryption software is available in the public. !!!DO\nNOT DELETE readme files!!! !!!DO NOT RENAME OR MOVE the encrypted and\nreadme files!!! !!!DO NOT RESET OR SHUTDOWN – files may be damaged!!!\nThis may lead to the impossibility of recovery of the certain files!\nPhotorec, RannohDecryptor etc. repair tools are useless and can\ndestroy your files irreversibly! If you want to restore your files\nwrite to emails [contacts are at the bottom of the sheet] and attach 3\n- 4 encrypted files [Less than 6 Mb each, non-archived and your files\nshould not contain valuable information [Databases, backups, large\nexcel sheets, etc.]]! You will receive decrypted samples and our\nconditions how to get the decoder! !_!Attention!_! Your warranty decrypted samples! Do not rename encrypted files! Do not try to\ndecrypt your data using third party software!!! We don`t need your\nfiles and your information! But after 2 weeks all your files and keys\nwill be deleted automatically. Contact EMAILS: ldtwinj@protonmail.com\nand unlock@eqaltech.su Please write to both emails! !!!The final price\ndepends on how fast you write to us!!! Nothing personal just business!\nClop^_\n```\n\n### Signature information\n\n###### of other malware similar to recent sample 1\n\n\n-----\n\n### • [11 different malware code MD5 lists that share identical signature information]\n\n```\n8fc09cb1540a6dea87a078b92c8f2b0a 8b6c413e2539823ef8f8b85900d19724\n9246d60c24591855bc1792aa0a672ff7 34f8228a3f12fa9542f1a4181f96edec\n731d5ed57434e05c9466107052af5a6a b96f79eb633d0b2c0e79e6d889dac0da\nefb886d6eaa54d666dcfde173ae02d81 e3bc953a18fe466cb008184a45c6c858\nd014969ab6421bde1419cbd30d0d5ebb a98dc09226b97ddc0d959e0aaa08abe0\n8274514bc52e98bb4431ef61109fb15c\n\n```\n\n### Clop Ransomware(#02) : Identified using the same signature\n\n #02 : 8fc09cb1540a6dea87a078b92c8f2b0a\n\n#### Basic Properties\n\n\n-----\n\n##### MD5 : 8fc09cb1540a6dea87a078b92c8f2b0a SHA-1 : 16f48624ea2a575e1bdceb4ac6151d97d4de80b6  SHA-256 :  389e03b1a1fd1c527d48df74d3c26a0483a5b105f36841193172f1e e80e62c1b  Build Time 2020-11-21 15�56�31\n\n### • [Confirmed that Malware code has been created more recently than #01 Clop ]\n\n###### Ransomware (8b6c413e2539823ef8f8b85900d19724)\n\n#### Main features\n\n### • [Identical method to import the malware activity file with #01 Clop ]\n\n###### Ransomware(8b6c413e2539823ef8f8b85900d19724)\n\n#### Results after confirming the code with malware activity\n\n###### Basic Properties\n\n##### MD5 : AC0FE3E86F9FC7E5FD08D9E618B601F3  SHA1 : 8C7173BDDE2919B524B22EA257A80360DF33A333  SHA256 : 71DB30A0174795E9387F6A6CCA940359028CAD3BC3B7BEF24B 48E150102DB391  Build TIme 2020-11-21 14�43�58\n\n#### Key strings identified in malware\n\n\n-----\n\n```\n  .rdata:00413440 00000014 C (16 bits) - UTF-16LE %s%s.Cllp .rdata:00413454\n  .rdata:0041345C 00000008 C Cllp^_- .rdata:00413618 00000014 C (16 bits)   .rdata:00413630 00000040 C (16 bits) - UTF-16LE 666GKLJHWRnjktn32uyhrjn23\n  0000001A C (16 bits) - UTF-16LE EXPLORER.EXE .rdata:00413690 00000047 C /\n  %1 in ('wevtutil.exe el') DO wevtutil.exe cl \\\"%1\\\" .rdata:004136F0 00000\n  16LE WinCheckDRVs .rdata:0041370C 0000000E C (16 bits) - UTF-16LE runrun\n  00000012 C (16 bits) - UTF-16LE temp.dat .rdata:00413730 0000001C C (16 b\n  .rdata:0041374C 0000001A C (16 bits) - UTF-16LE WinCheckDRVs .rdata:00413\n  BEGIN PUBLIC KEY----- MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCecUuskA+/EYR\n  e3MeraGTOS8wa6lZfirCt0oRPARUcF1aNVupKfLeqc02BX+MAn3n15EJpoe1SRya\n  iESj5Z+dJl2WBFaYoV/SBg5EQWganz32HN3dhH037t3vrDP7jsQa2lziD32hLd3y SEktD4Gm\n  END PUBLIC KEY----- .rdata:00413878 00000060 C\n  JKHfg34789t6y8f9JLKHFUEWir3289457yfnKLSFEj2jk34y57823fjvsdiogh23funrjtubh\n  .rdata:004138D8 0000002A C (16 bits) - UTF-16LE %s\\\\README_README.txt\n\n#### Result of Similarity\n\n```\n\n-----\n\n### • [After analyzing the actual malware code that operates on memory #01 and #02, ]\n\n###### most of the codes are similar except for some functions (Confidence 99.2%, Similarity : 82.38%)\n\n### • [#02 : 8fc09cb1540a6dea87a078b92c8f2b0a Final Malware code (Left)]\n • [#01 : 8b6c413e2539823ef8f8b85900d19724 Final Malware code (Right)]\n\n\n-----\n\n### • [Some functions have been added, however the key code used for the ]\n\n###### ransomware operation is the same format.\n\n## IOC\n\n### HASH\n\n```\n8b6c413e2539823ef8f8b85900d19724 14B7069B25B04EBA875F264BE4F140DA\n8fc09cb1540a6dea87a078b92c8f2b0a 8b6c413e2539823ef8f8b85900d19724\n9246d60c24591855bc1792aa0a672ff7 34f8228a3f12fa9542f1a4181f96edec\n731d5ed57434e05c9466107052af5a6a b96f79eb633d0b2c0e79e6d889dac0da\nefb886d6eaa54d666dcfde173ae02d81 e3bc953a18fe466cb008184a45c6c858\nd014969ab6421bde1419cbd30d0d5ebb a98dc09226b97ddc0d959e0aaa08abe0\n8274514bc52e98bb4431ef61109fb15c AC0FE3E86F9FC7E5FD08D9E618B601F3\n\n```\n\n### ETC\n\n###### ONION\n\n\n-----\n\n```\nCl0p Ransomware leak site: ekbgzchl6x2ias37[.]onion Cl0p Ransomware\nChat site:\nhxxp://cvfzmngbtwzywfnryt45zro4ocpze7cqdtzj2n6jz7eucpdglsulcsid[.]onion\n\n```\n\n\n### • [https://www.s2wlab.com]\n • [Facebook https://www.facebook.com/S2WLAB/]\n • [Twitter] [https://twitter.com/s2wlab]\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.11.23.Clop_Campaign/%5BS2W%20LAB%5D%20Analysis%20of%20Clop%20Ransomware%20suspiciously%20related%20to%20the%20Recent%20Incident%20%28English%29.pdf"
    ],
    "report_names": [
        "[S2W LAB] Analysis of Clop Ransomware suspiciously related to the Recent Incident (English)"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041120,
    "ts_creation_date": 1606446251,
    "ts_modification_date": 1606446251,
    "files": {
        "pdf": "https://archive.orkl.eu/680326f4ffb2f446f27f40fb66eaaae9fd0254fd.pdf",
        "text": "https://archive.orkl.eu/680326f4ffb2f446f27f40fb66eaaae9fd0254fd.txt",
        "img": "https://archive.orkl.eu/680326f4ffb2f446f27f40fb66eaaae9fd0254fd.jpg"
    }
}