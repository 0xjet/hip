{
    "id": "86276028-2ea7-45f5-824a-77daaf246711",
    "created_at": "2022-10-25T16:48:23.148855Z",
    "updated_at": "2025-03-27T02:16:26.424987Z",
    "deleted_at": null,
    "sha1_hash": "791e4be4ccaf81a83beea4fc815af9e572222ef2",
    "title": "",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1743937,
    "plain_text": "# Brunhilda DaaS Malware Analysis Report\n\n\n-----\n\n### Table Of Contents\n\n**1** **Introduction** **3**\n1.1 Scope . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n\n**2** **Technical Analysis** **7**\n2.1 Command and Control Panel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7\n2.2 Brunhilda malware disguised as authentication/fitness applications . . . . . . 7\n2.3 Example Analysis : com.secureauthetnicator2fa.club . . . . . . . . . . . . . . . . . 8\n2.4 Alien Installation - Second Stage . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9\n\n**3** **Conclusion** **17**\n\n**4** **Related IOCs** **18**\n\n\n-----\n\n### 1 Introduction\n\n**Report Reference** BRN01\n**Prepared By** Ahmet Bilal Can\n**Approved By** Ege Balcı\n**Date of Analysis** 14.11.2020\n**Date of Report** 28.12.2020\n\nThis report is based on an analysis of the Brunhilda dropper service which is detected by the\nPRODAFT Threat Intelligence (PTI) team. Brunhilda is a dropper service that utilizes the Google\nPlay Store to distribute banking malware (currently Alien malware is used). While cybercrime\ngroups tend to start operating as MaaS businesses, currently there is an upward trend of\nDaaS (Dropper as a Service) variations. We used the term DaaS as it is a new method, which\nsolely focuses on the distribution of any malware. After Brunhilda executes the Alien malware\non the victim’s device, Alien starts listening for newly launched applications. If the launched\napplications include any targeted by malware (e.g., banking or financial applications), a\nphishing attack is triggered by webview. For each target application, a prepared phishing\ntemplate/screen is displayed by the malware. This screen is downloaded from the commandcontrol-server(C&C) and automatically pops up over the target application to lure victims\ninto entering their credentials. Given how quickly this process takes place upon opening a\nlegitimate application, the user suspects nothing. When the user name and password are\nentered into the phishing overlay screen, they are automatically sent to the server controlled\nby the attacker.\nMalware can perform several critical operations on the device, such as reading incoming\nSMS messages, forwarding phone calls, and stealing Google Authenticator codes. All the\nfeatures of the malware are listed below :\n\n## • [Providing access to the user’s file system]\n • [Stealing Google Authenticator codes]\n • [Sending SMS messages to phone contacts]\n • [Sending USSD codes]\n • [Forwarding phone calls]\n • [Muting phone sound]\n • [Removing applications from the user’s device]\n\n|Report Reference|BRN01|\n|---|---|\n|Prepared By|Ahmet Bilal Can|\n|Approved By|Ege Balcı|\n|Date of Analysis|14.11.2020|\n|Date of Report|28.12.2020|\n\n\n-----\n\n**Figure 1. Brunhilda malware distribution framework**\n\n**Note : Brunhild, also known as Brunhilda or Brynhild (Old Norse : Brynhildr, Middle High**\nGerman : Brünhilt, Modern German : Brünhild or Brünhilde), is a powerful female figure from\nGermanic heroic legend. source : Wikipedia\n\n\n-----\n\n#### 1.1 Scope\n\nWe analyzed the following applications containing the Brunhilda dropper. These applications were found within the distribution panel, in use by an as-yet-unknown cybercrime\ngroup. More information about the applications and the distribution framework is discussed\nin Section 2.\n\n**Filename** **com.secureauthetnicator2fa.club**\nMD5 935F8557CD5304434F616EED103C6168\nSHA256 26C91532833A8851BE5C8DF8C04D3C4B8E29EF8D6E2B16D207F053EB71CFA590\n\n**Filename** **com.welnessfitnessclub.app**\nMD5 B70BDA43AB8325E5A687485FF4232EDA\nSHA256 5742F9ED94711B378DC93C7E8F3F5D3E4789AE156DCA677049044418C6D3AE36\n\n**Filename** **com.gymwithoutproblems.app**\nMD5 75AF7B48FF3CA3A0D17C617FE5BF3C5C\nSHA256 16A2C6F62870FEA44828C53152A964B1A8FFA21CA93671564207A9447DA20CB3\n\n**Filename** **com.tfapasswords.app**\nMD5 0F4733A3A188CA0DDF3F730B17B23E20\nSHA256 301BACDC7163C5494BCBD165C3571659175B355C5EF640277D3929EA280E937F\n\n**Filename** **com.safeyourdata.app**\nMD5 FE7A15B4CD8A472C9B146FA9797DD4EC\nSHA256 9A71B14ABFBC6FF4D8768DBDFCC3A573CFD107151D3D42F6D6CF11B7D7C699EF\n\n**Filename** **com.yourweather.app**\nMD5 8D6254C0A59EF1C6DAE5403D92A0F9B9\nSHA256 196CCA4C237FE013A273955C29F712AD07E61F2F5E44242FB336323FE7444371\n\n**Filename** **com.radiofun.app**\nMD5 95DF249DB6C7B745AA42AB362D44BAB7\nSHA256 91AC84BFA47D2EE5ADDB2EB7047F2F21FD7712C4D99FD224C6C1CB4F6E6A2FFA\n\n**Filename** **club.amazingteam.passvault**\nMD5 A6129E463E85D0AC0EF7764D7F8EC887\nSHA256 121B3779A0BD540EEAE5897EAC4DD94B0D8FA63CB8CC3023D5A8E914AC827B51\n\n**Filename** **com.fitnessworkoutforyou.app**\nMD5 DC234D845BCB5BDAF3A7D7B73D5EA5AD\nSHA256 4ED4EDAA979FA129A6C739E492FA58BE2CDB9399C8452D1FAF10537A9F03AA25\n\n**Filename** **workout.com.appforyou**\nMD5 38CCB576775C31F969BE18FA211C2751\nSHA256 40B6F76B371D69ED4DA4493525265F8D005D39BDFC6920E266ED659CAC3239E4\n\n\n-----\n\n**Filename** **com.fitness2you.club**\nMD5 51093DED1B425F46669F51A84E0664C1\nSHA256 6366D374A7A189908CB22CE7AB53F7A4D795334DDB7AAF20C45AA64889782E98\n\n**Filename** **com.ourfitnessapp.club**\nMD5 17520F6E37FF64FC7D71015E8AEED6A4\nSHA256 D750CA521FE6D12A263E1E5114C7C9C54941501CB070F6E30656E7811692817A\n\n**Filename** **com.fitness.strategy**\nMD5 A39304C60BACDF3AC7DD67D371A8D20C\nSHA256 ABA7FEB1240D4AF3FAE753D380EEBF2ED169CB8C499B11D65F414A374D69C77A\n\n**Filename** **com.itsyourhealth.app**\nMD5 83218F35BC846C24E86FDF3FF02B5BE2\nSHA256 ABA7FEB1240D4AF3FAE753D380EEBF2ED169CB8C499B11D65F414A374D69C77A\n\n**Filename** **com.ultimateyogaguide.ultimateyogaguide**\nMD5 9E90C3FD34B749B1395143E479AD960D\nSHA256 67DE5F5646722AF8966A98A7FC78BA459694E474FCBF3FE314EC6AA49B97D80F\n\n**Filename** **com.waller.world**\nMD5 CC926287BB18CD44AE835E8A02BB4B2A\nSHA256 E4F73D078FBE0847FD890D4E08EA68F121969DF894A37AE11ADF27F75E9311CF\n\n\n-----\n\n### 2 Technical Analysis\n\nThis section includes technical details of the Brunhilda malware analysis.\n\n#### 2.1 Command and Control Panel\n\nEach malicious application in the Google Play Store, when downloaded, communicates\nwith a proxy URL/IP to notify the Brunhilda distribution framework by sending a registration\nrequest. The request contains information about the victim’s phone such as device model,\nAndroid version, package name, and default language.\n\nWe observed that the distribution framework only registers victims using specific language\nsettings (see Fig 2). Our analysis revealed that Brunhilda checked French (around October\n2020) and Spanish (around July 2020 and November 2020) to accept incoming victim\nregistrations. According to our knowledge and experience in this field, we conclude that\nBrunhilda was sold to two different clients targeting Spanish and French-speaking countries.\n\nDropper applications on Google Play require Android 8.0 or above. This might be another\nstrategy to keep a low profile.\n\n**Figure 2. Firewall rules excluding non-Spanish victims**\n\n#### 2.2 Brunhilda malware disguised as authentication/fitness applications\n\nThe following applications were detected by the PTI team after a careful investigation\nof the package names from the Brunhilda panel and finding similar applications through\nour mobile threat detection platform, SKALA. Brunhilda mostly utilizes Authenticator and\ngym/fitness applications (see Table 1) to facilitate the spread of the Alien malware. This IOC\naligns with other types of attack vectors used by cyber-criminals focused on the needs of\npeople during the COVID-19 pandemic.\n\n\n-----\n\n**Table 1. Some applications used as a dropper service in Google Play Store**\n\n#### 2.3 Example Analysis : com.secureauthetnicator2fa.club\n\nAll the Brunhilda applications in the Google Play Store have the same structure and permission list. In this report we provide details only for the package\n\ncom.secureauthetnicator2fa.club . The dropper with this package name requires the\nfollowing permissions. :\n\n1 `android.permission.ACCESS_NETWORK_STATE`\n\n2 `android.permission.CAMERA`\n\n3 `android.permission.DISABLE_KEYGUARD`\n\n4 `android.permission.FOREGROUND_SERVICE`\n\n5 `android.permission.INTERNET`\n\n6 `android.permission.RECEIVE_BOOT_COMPLETED`\n\n7 `android.permission.REQUEST_INSTALL_PACKAGES`\n\n8 `android.permission.SYSTEM_ALERT_WINDOW`\n\n9 `android.permission.WAKE_LOCK`\n\nUpon acquiring these permissions, the dropper application has the necessary permissions to\nperform Application installation and Accessing the internet. After the malware is executed, it\nsends the information it collects about the device to the Brunhilda distribution framework\nthrough a proxy server as a registration request. After successful registration, it downloads\nanother malware required for the second phase of the attack. Secure Authenticator\napplication with the package name com.secureauthetnicator2fa.club was available as\nof this writing in the Google Play Store with over 500+ installs. According to our findings,\none client of Brunhilda is capable of distributing to 5000-10000 victims using multiple\napplications over a three-month period.\n\n\n-----\n\n**Figure 3. Brunhilda dropper disguised as Secure Authenticator**\n\n**Figure 4. Statistics for Secure Authenticator**\n\nThe PTI team reported the droppers mentioned in this report and they were removed from\nthe Play Store.\n\n#### 2.4 Alien Installation - Second Stage\n\nThe second part of the attack starts with the famous Alien malware sample. Alien, which\nis still being investigated by our PTI team, was first seen around January 2020. It is a fork\nof another popular Android malware called ’Cerberus’ and continues to be renewed and\nimproved. Currently, Alien contains most of the functions available in a commercial-grade\nRAT and is one of the most popular Android malware targeting the financial sector. The\nsample downloaded via the Brunhilda dropper asks for the following permissions. :\n\n1 `android.permission.ACCESS_NETWORK_STATE`\n\n2 `android.permission.CALL_PHONE`\n\n3 `android.permission.FOREGROUND_SERVICE`\n\n4 `android.permission.GET_ACCOUNTS`\n\n5 `android.permission.INTERNET`\n\n6 `android.permission.READ_CONTACTS`\n\n7 `android.permission.READ_EXTERNAL_STORAGE`\n\n8 `android.permission.READ_PHONE_STATE`\n\n9 `android.permission.READ_SMS`\n\n10 `android.permission.RECEIVE_BOOT_COMPLETED`\n\n11 `android.permission.RECEIVE_SMS`\n\n12 `android.permission.RECORD_AUDIO`\n\n13 `android.permission.REQUEST_DELETE_PACKAGES`\n\n14 `android.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS`\n\n\n-----\n\n15 `android.permission.SEND_SMS`\n\n16 `android.permission.USE_FULL_SCREEN_INTENT`\n\n17 `android.permission.WAKE_LOCK`\n\n18 `android.permission.WRITE_EXTERNAL_STORAGE`\n\nThe malware has the necessary permissions to perform following operations :\n\n## • [Accessing the Internet]\n • [Reading SMS logs]\n • [Sending SMS]\n • [Reading the phone book]\n • [Making calls]\n • [Write to external memory]\n\nWe observed that the malware imitates the Google service application by using ”Google\n**Activity Tracker” as the application name and the following image as the application icon.**\n\n**Figure 5. Application Icon and Name of the second stage malware**\n\nUpon execution, it requests activation of it’s accessibility service under the name ”Google\n**Activity Tracker” (see Fig 6). The malware uses accessibility rights to press the buttons on the**\nscreen, read user inputs such as user clicks, run applications, and monitor what users have\ntyped in a certain text field.\n\n\n-----\n\n**Figure 6. Accessibility service request**\n\nMalware is packed via a commercial packer to bypass antivirus detection. This also makes it\nhard to perform static and dynamic analyses. Figure 7 shows an application’s manifest file,\nwhich contains undefined class names resulting from the packer.\n\n**Figure 7. Android manifest and classes**\n\nWhen the malware is successfully executed, it decrypts files from its assets folder and drops\nthem into the file system. It then loads the rest of the undefined classes. Most of the malicious\nactivity is coded in the dropped dex file. The scrambled classes in the dex file can be\nobserved in Figure 8.\n\n\n-----\n\n**Figure 8. Malicious classes from dropped dex file**\n\n**Figure 9. Scrambled malware configuration**\n\nFor registration requests, the malware collects phone information such as installed applications, accounts, device IMEI number, and phone model before sending it all to the C&C\nserver. The following image contains code related to collecting installed applications on a\nphone.\n\n\n-----\n\n**Figure 10. Code block to get installed application list and related packages**\n\nRC4 is still quite popular among malware coders. The following image contains encrypted\nnetwork requests to the C&C server. The requested body is encrypted with RC4. The server\nresponds with a body encrypted with the same RC4 key.\n\n**Figure 11. The request the malware sends to the command control server**\n\nA server sends targeted application lists to the malware in question. Malware listens to\nopened applications and, when a targeted application is launched, sends a request to the\nC&C server. The server responds with an HTML file containing a phishing template for the\ntargeted application, causing the user’s credentials to be stolen.\n\n\n-----\n\n**Figure 12. Loading URL with webview**\n\nThe following image shows an example overlay attack for the Paypal application.\n\n**Figure 13. Overlay attack**\n\nIn addition to an overlay attack, malware has other capabilities such as reading and sending\nSMS messages to phone contacts. The following image contains related code parts of the\nmalware in question.\n\n\n-----\n\n**Figure 14. Reading SMS**\n\n**Figure 15. Sending SMS to Contacts**\n\nMalware can drop modules from a C&C server and execute them with DexClassLoader.\n\n\n-----\n\n**Figure 16. Installing modules**\n\nAll commands that the malware receives from the C&C server, along with their descriptions,\nare listed in the following table.\n\n**Command** **Description**\ngrabbing_lockpattern Using overlay attack to grab lockpattern\nrun_record_audio Uses microphone to record audio\nrun_socks5 Opens socket on victims phone\nupdate_inject Updates inject files for targeted applications\nstop_socks5 Stops sockets\nrat_connect Connects to user’s file system\nchange_url_connect Changes the C&C server url\nrequest_permission Requests new permissions\nchange_url_recover Changes proxy url\nsend_mailing_sms Sends SMS messages to phones\nrun_admin_device Requests device admin permission\naccess_notifications Requests access to notifications\nurl Opens up an url\nussd Runs ussd codes\nsms_mailing_phonebook Send SMS messages to contacts\nget_data_logs Gets data logs such as keylogs\nget_all_permission Gets granted permission list\ngrabbing_google_authenticator2 Grabs authenticator codes using accessibility\nnotification Shows a fake notification\ngrabbing_pass_gmail Uses gmail phishing overlay\nremove_app Removes app from user’s phone. Such as AV apps\nremove_bot Removes bot from user’s phone\nsend_sms Sends SMS messages to received number\nrun_app Launches any installed application\ncall_forward Configures call forwarding\npatch_update Patches dropped module\n\n\n-----\n\n### 3 Conclusion\n\nThe Brunhilda distribution framework utilizes the Google Play Store to distribute Alien\nmalware. Back in 2018, Anubis actors were using the Google Play Store to distribute\ntheir samples, but such chains of infection are relatively new. Cybercrime groups started\ndeveloping DaaS platforms to quickly monetize their business, as it is easy to replace the\ndistributed malware while maintaining a low profile. There is a significant difference between\nearlier Play Store droppers and the Brunhilda framework. Emulator detection, country filters,\nand the Android version requirements make it difficult to find dropper applications distributed\nthrough the Play Store. Moreover, using proxy networks to cover the DaaS panel makes it\nhard for the researchers to find the actual service. Following detection of the Brunhilda\nframework, our PTI team analyzed all artifacts, including the panel, access logs, Alien\nsamples, and dropper applications. This report was made public to raise awareness of the\nsituation and does not contain any confidential data that would identify any person or group.\n\n**Figure 17. Brunhilda DaaS panel**\n\n\n-----\n\n### 4 Related IOCs\n\nThe following IP addresses are related to this DaaS and we recommend you block them\nimmediately :\n```\ngymwithoutproblems.club\nwelnessfitnessclub.club\nskeletontree.top\nttdom.xyz\n95.142.40.68\n185.177.93.242\n185.177.93.32\n185.177.93.72\n185.177.93.73\n198.54.125.121\n185.177.93.120\n185.177.92.213\n185.177.93.44\n185.177.93.145\n185.177.93.105\n185.177.93.111\n45.142.212.216\n\n```\nAll APKs mentioned in this report and detailed information about IOCs can be retrieved from\nour github repository : www.github.com/prodaft/malware-ioc\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2021/2021.01.07.Brunhilda_DaaS_Malware/BrunHilda_DaaS.pdf",
        "https://www.prodaft.com/m/reports/BrunHilda_DaaS.pdf"
    ],
    "report_names": [
        "BrunHilda_DaaS",
        "BrunHilda_DaaS.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/791e4be4ccaf81a83beea4fc815af9e572222ef2.pdf",
        "text": "https://archive.orkl.eu/791e4be4ccaf81a83beea4fc815af9e572222ef2.txt",
        "img": "https://archive.orkl.eu/791e4be4ccaf81a83beea4fc815af9e572222ef2.jpg"
    }
}