{
    "id": "e5578f02-98d9-458e-8e7c-db9cef583ab0",
    "created_at": "2023-01-12T15:02:57.542379Z",
    "updated_at": "2025-03-27T02:06:04.171921Z",
    "deleted_at": null,
    "sha1_hash": "c355fffb67601163c692c8ec8edc03e64e718c40",
    "title": "2017-05-11 - Cyber Attack Impersonating Identity of Indian Think Tank to Target Central Bureau of Investigation CBI and Possibly Indian Army Officials",
    "authors": "",
    "file_creation_date": "2022-05-25T14:34:12Z",
    "file_modification_date": "2022-05-25T14:34:12Z",
    "file_size": 6362707,
    "plain_text": "# Cyber Attack Impersonating Identity of Indian Think Tank to Target Central Bureau of Investigation (CBI) and Possibly Indian Army Officials\n\n**[cysinfo.com/cyber-attack-targeting-cbi-and-possibly-indian-army-officials](https://cysinfo.com/cyber-attack-targeting-cbi-and-possibly-indian-army-officials/)**\n\n5 years ago\n\nIn my previous blog posts I posted details of cyber attacks targeting Indian Ministry of\n[External Affairs and Indian Navy’s Warship and Submarine Manufacturer. This blog post](https://cysinfo.com/cyber-attack-targeting-indian-navys-submarine-warship-manufacturer/)\ndescribes another attack campaign where attackers impersonated identity of Indian think\ntank [IDSA (Institute for Defence Studies and Analyses) and sent out spear-phishing emails to](https://en.wikipedia.org/wiki/Institute_for_Defence_Studies_and_Analyses)\ntarget officials of the Central Bureau of Investigation (CBI) and possibly the officials\nof Indian Army.\n\n[IDSA (Institute for Defence Studies and Analyses) is an Indian think tank for advanced](https://en.wikipedia.org/wiki/Institute_for_Defence_Studies_and_Analyses)\nresearch in international relations, especially strategic and security issues, and also trains\ncivilian and military officers of the Government of India and deals with objective research\nand policy relating to all aspects of defense and National security.\n\nThe [Central Bureau of Investigation (CBI) is the domestic intelligence and security service of](https://en.wikipedia.org/wiki/Central_Bureau_of_Investigation)\nIndia and serves as the India’s premier investigative and Interpol agency operating under the\njurisdiction of the Government of India.\n\nIn order to infect the victims, the attackers distributed spear-phishing emails containing\nmalicious excel file which when opened dropped a malware capable of downloading\nadditional components and spying on infected systems. To distribute the malicious excel file,\nthe attackers registered a domain which impersonated the identity of most influential Indian\nthink tank [IDSA (Institute for Defence Studies and Analyses) and used the email id from the](https://en.wikipedia.org/wiki/Institute_for_Defence_Studies_and_Analyses)\nimpersonating domain to send out the spear-phishing emails to the victims.\n\n**Overview of the Malicious Emails**\n\nIn the first wave of attack, The attackers sent out spear-phishing emails containing malicious\nexcel file (Case Detail of Suspected abuser.xls) to an unit of Central Bureau of Investigation\n(CBI) on February 21st, 2017 and the email was sent from an email id associated with an\nimpersonating domain idsadesk[.]in. To lure the victims to open the malicious attachment\nthe email subject relevant to the victims were chosen and to avoid suspicion the email was\nmade to look like it was sent by a person associated with IDSA asking to take action against a\npending case as shown in the screen shot below.\n\n\n-----\n\nIn the second wave of attack, a spear-phishing email containing a different malicious excel\nfile (Contact List of attendees.xls) was sent to an email id on the same day February 21st,\n2017. The email was made to look like a person associated with IDSA is asking to confirm the\nphone number of an attendee in the attendee list. When the victim opens the attached excel\nfile it drops the malware and displays a decoy excel sheet containing the list of names, which\nseems be the names of senior army officers. Even though the identity of the recipient email\ncould not be fully verified as this email id is nowhere available on the internet but based on\nthe format of the recipient email id and from the list of attendees that is displayed to the\nvictim in the decoy excel file, the recipient email could be possibly be associated with either\nthe Indian Army or a Government entity. This suggests that attackers had prior knowledge of\nthe recipient email id through other means.\n\n\n-----\n\nIn both the cases when the victims opens the attached malicious excel file the same malware\nsample was dropped and executed on the victim’s system. From the emails (and the\nattachments) it looks like the goal of the attackers was to infect and take control of the\nsystems and to spy on the victims.\n\n**Anti-Analysis Techniques in the Malicious Excel File**\n\nWhen the victim opens the attached excel file it prompts the user to enable macro content as\nshown in the below screen shot.\n\nTo prevent viewing of the macro code and to make manual analysis harder attackers\npassword protected the macro content as show below.\n\nEven though the macro is password protected, It is possible to extract macro code using\n[analysis tools like oletools. In this case oletools was used to extract the macro content but it](https://www.decalage.info/python/oletools)\nturns out that the oletools was able to extract only partial macro content but it failed to\n\n\n-----\n\nextract the malicious content present inside a Textbox within the Userform. Below screen\nshot shows the macro content extracted by the oletools.\n\nThis extracted macro content was copied to new excel workbook and the environment was\nsetup to debug the macro code. Debugging the macro code failed because the macro code\naccesses the textbox content within the UserForm (which oletools failed to extract). The\ntechnique of storing the malicious content inside the TextBox within the UserForm allowed\nthe attackers to bypass analysis tools. Below screen shot shows the macro code accessing the\ncontent from the TextBox and the error triggered by the code due to the absence of the\n_TextBox content._\n\nTo bypass the anti-analysis technique and to extract the content stored in the TextBox within\nthe UserForm the password protection was bypassed which allowed to extract the content\nstored within the UserForm. Below screen shot shows the TextBox content stored within the\n_UserForm._\n\n\n-----\n\nAt this point all the components (macro code and the UserForm content) required for\nanalysis was extracted and an environment similar to the original excel file was created to\ndebug the malicious macro. Below screen shots show the new excel file containing extracted\nmacro code and the UserForm content.\n\n**Analysis of Malicious Excel File**\n\n\n-----\n\nWhen the victim opens the excel file and enables the macro content, The malicious macro\ncode within the excel file is executed. The macro code first generates a random filename as\nshown in the below screen shot.\n\nIt then reads the executable content stored in the TextBox within the UserForm and then\nwrites the executable content to the randomly generate filename in the %AppData%\ndirectory. The executable is written in .NET framework\n\nThe content stored in the TexBox within the UserForm is an executable content in the\ndecimal format. Below screen shot shows converted data from decimal to text. In this case\nthe attackers used the TextBox within the UserForm to store the malicious executable\n\n\n-----\n\ncontent.\n\n\n-----\n\n-----\n\nThe dropped file in the %AppData% directory is then executed as shown in the below screen\nshot.\n\nOnce the dropped file is executed it copies itself into %AppData%\\SQLite directory as\n_SQLite.exe and executes as shown below._\n\nAs a result of executing SQLite.exe it makes a HTTP connection to the C2 server\n_(qhavcloud[.]com). The C2 communication shown below contains a hard coded user-agent_\nand the double slash (//) in the GET request this can be used to create network based\n\n\n-----\n\nsignatures.\n\n**Reverse Engineering the Dropped File (SQLite.exe)**\n\nThe dynamic/sandbox analysis did not reveal much about the functionality of the malware,\nin order to understand the capabilities of the malware, the sample had be reverse engineered.\nThe malware sample was reverse engineered in an isolated environment (without actually\nallowing it to connect to the c2 server).This section contains reverse engineering details of\nthis malware and its various features.\n\n**_a) Malware Validates C2 Connection_**\n\nMalware checks if the executable is running as SQLite.exe from %AppData%\\SQLite\ndirectory, if not it copies itself as SQLite.exe to %AppData%\\SQLite directory as shown\nbelow.\n\nIt then launches the executable (SQLite.exe) with the command line arguments as shown in\nthe below screen shots.\n\n\n-----\n\nMalware performs multiple checks to make sure that it is connecting to the correct C2 server\nbefore doing anything malicious. first its pings the C2 domain qhavcloud[.]com. Below\nscreen shots show the ping to the C2 server.\n\nIf the ping succeeds then it determines if C2 server is alive by sending an HTTP request, it\nthen reads the content from the C2 server and looks for a specific string “Connection!”. If it\ndoes not find the string “Connection!” it assumes that C2 is not alive or it is connecting to the\nwrong C2 server. This technique allows the attackers to validate if they are connecting to the\ncorrect C2 server and also this technique does not reveal any malicious behavior in\ndynamic/sandbox analysis until the correct response is given to the malware. Below screen\nshots show the code that is performing the C2 connection and the validation.\n\n\n-----\n\nIf the ping does not succeed or if the C2 response does not contain the string “Connection!”\nthen the malware gets the list of backup C2 servers to connect by downloading a text file from\nthe Google drive link. This technique of storing a text file containing the list of backup C2\nservers on the legitimate site has advantages and it is highly unlikely to trigger any suspicion\nin security monitoring and also can bypass reputation based devices. Below screen shots\nshow the code that downloads the text file and text file (info.txt) saved on the disk.\n\n\n-----\n\nDuring the time of analysis the text file downloaded from the Google drive link was populated\nwith two private IP addresses, it looks like the attackers deliberately populated the IP\naddresses with two private IP addresses to prevent the researchers from determining actual\nIP/domain names of the backup C2 servers. Below screen shot shows the IP addresses in the\ntext file.\n\nOnce the text file is downloaded the malware reads each and every IP address from the text\nfile and performs the same C2 validation check (ping and checks for the string “Connection!”\nfrom the C2 response). Below screen shot shows the HTTP connection made to those IP\naddresses.\n\n\n-----\n\n**_b) Malware Sends System Information_**\n\nBased on the analysis it was determined that the malware looks for a string “Connection!” in\nthe C2 response, so the analysis environment was configured to respond with a string\n_“Connection!” whenever the malware made a C2 connection. Below screen shot shows the C2_\ncommunication made by the malware and the expected response.\n\nOnce the malware validates the C2 connection then the malware creates an XML file\n_(SQLite.xml) inside which it stores the user name and the password to communicate with_\nthe C2 server.\n\nMalware generates the user name to communicate with the C2 by concatenating a) the\n_machine name, b) a random number between 1000 to 9999 and c) the product version of_\n_the file. Below screen shot shows the code that generates the user name_\n\n\n-----\n\nMalware generates the password to communicate with the C2 by building an array of 16\nrandom bytes, these random bytes are then encoded using base64 encoding algorithm and\nmalware then replaces the characters “+” and “/” with “-“ and “_” respectively from the\nencoded data. The attackers use the technique of replacing the standard characters with\ncustom characters to makes it difficult to decode the string (containing the characters “+” and\n_“/”) using standard base64 algorithm. Below screen shot shows the code that generates the_\npassword.\n\nOnce the user name and password is generated, malware then creates an XML file\n_(SQLITE.xml) and populates the XML file with the generated user name and password._\nBelow screen shot shows the code that creates the XML file\n\n\n-----\n\nBelow screen shot shows the XML file populated with the user name and the password\nwhich is used by the malware to communicate with the C2 server.\n\nThe malware then collects system information like the computer name, operating system\n_caption, IP address of the infected system, product version of the executable file and sends it_\nto the C2 server along with the generated user name and password using a POST request to\n_postdata.php. Below screen shots show the code that collects the system information and the_\ndata that is sent to the attacker.\n\n\n-----\n\n**_c) Malware Sends Process Information_**\n\nMalware then enumerates the list of all the processes running on the system and sends it to\nthe C2 server along with the user name and password using a POST request to\n_JobProcesses.php as shown in the below screen shots. This allows the attackers to know_\nwhich programs are running on the system or if any analysis tools are used to inspect the\nmalware.\n\n\n-----\n\n**Malware Functionalities**\n\nApart from sending the system information and process information to the C2 server, the\nmalware also has the capability to perform various other tasks by taking command from the\nC2. This section focuses on different functionalities of the malware\n\n**_a) Download & Execute Functionality 1_**\n\nMalware triggers the download functionality by connecting to the C2 server and making a\nrequest to either Jobwork1.php or Jobwork2.php, if the C2 response satisfies the condition\nthen it downloads & executes the file. After understanding the logic (logic is mentioned\nbelow) & to satisfy the condition the environment was configured to give proper response\nwhenever the malware made a request to Jobwork1.php or Jobwork2.php. Below screen shot\nshows the response given to the malware.\n\nMalware then reads the response successfully as shown in the below screen shot.\n\n\n-----\n\nfrom the C2 response it extracts two things a) URL to download an executable file and b) the\n_command string that will trigger the download functionality_\n\nFrom the C2 response the URL is extracted starting from offset 14 (i.e 15th character) and it\ndetermines the length of the string (URL) to extract by finding the start offset of the string\n_“clientpermission” once it finds it, its offset value is subtracted with 17._\n\nThe command string to trigger the download functionality is extracted from the C2 response\nusing the logic shown below. Below screen shot shows the logic used to extract the URL and\nthe command strings, in the below screen shot the extracted command string is stored in the\nvariable ServerTask1Permission.\n\nOnce the URL and command string is extracted, the malware compares the command string\nwith the string “Pending”, only if the command string matches with string “Pending” the\ndownload functionality is triggered.\n\n\n-----\n\nWhen all the above mentioned conditions are satisfied the malware downloads the\nexecutable from the URL extracted from the C2 response. Below screen shot shows the URL\nextracted from the C2 response.\n\n**_Note:_** _In the below screen shot the URL (hxxp://c2xy.com/a.exe) is not the actual URL used_\n_by the malware for downloading the file, this is a test URL used to determine the_\n_functionality, so this URL should not used as an indicator._\n\nBelow screen shot shows the network traffic of malware trying to download the executable\nfile from the extracted URL.\n\n\n-----\n\nThe downloaded executable is saved in the %AppData%\\SQLite directory as shown in the\nbelow screen shot.\n\nThe downloaded file is then executed by the malware as shown in the below screen shot.\n\nOnce the downloaded file is executed the malware reports that the download & execute was\nsuccessful by making a POST request to JobDone.php as shown in the below screen shots\n\n\n-----\n\nThis functionality allows the attacker to change their hosting site (from where the malware\nwill be downloaded), this can be achieved by changing the C2 response containing different\nURL.\n\n**_b) Download & Execute Functionality 2_**\n\nMalware also supports second type of download functionality,instead of extracting the URL\nfrom the C2 response and downloading the executable, it gets executable content from the\nnetworks stream from a hard coded IP address and then writes it to the disk and executes it.\n\nThis functionality is triggered by making a request to either JobTcp1.php or JobTcp2.php, if\nthe C2 response satisfies the condition then it gets the executable content from a hard coded\nIP address. After understanding the logic & to satisfy the condition the environment was\nconfigured to give proper response when the malware made a request to JobTcp1.php or\n_JobTcp2.php. Below screen shot shows the response given to the malware._\n\n\n-----\n\nMalware then reads the c2 response and from the C2 response it extracts two things a)\n_filename and b) the command string that will trigger the download functionality._\n\nFrom the C2 response the filename is extracted starting from offset 14 (i.e 15th character)\nand it determines the length of the string to extract by finding the start offset of the string\n_“clientpermission” once it finds it, its offset value is subtracted with 17. The command string_\nto trigger the download functionality is extracted from the C2 response using the logic shown\nbelow. Below screen shot shows the logic used to extract the filename and the command\nstring, in the below screen shot the extracted command string is stored in the variable\n_ServerTask1Permission._\n\nOnce the filename and command string is extracted, the malware compares the command\nstring with the string “Pending”, if the command string matches with string “Pending” then\nthe extracted filename (in this case the extracted filename is “testfile”) from the C2 response\nis concatenated with “.exe” as shown below.\n\n\n-----\n\nIt then connects to the hard coded IP 91[.]205[.]173[.]3 on port 6134, and it sends the\nconcatenated filename (testfile.exe) as shown below.\n\n\n-----\n\nThe IP address after verifying the filename then returns the executable content which\nmalware reads directly from the network stream and writes to the disk in the\n_%Appdata%\\SQLIte directory as shown below._\n\n\n-----\n\nThe dropped file is then executed as shown in the below screen shot.\n\n**_c) Update Functionality_**\n\nMalware has the capability to update itself this is done by making a request to\n_updateproductdownload.php, if C2 response satisfies the condition then it downloads the_\nupdated executable from an URL. After understanding the logic & to satisfy the condition the\nenvironment was configured to give proper response. Below screen shot shows the response\ngiven to the malware when it makes a request to updateproductdownload.php\n\n\n-----\n\nMalware then reads the c2 response and from the C2 response it extracts two things a) URL\n_to download the updated executable and b) the command string that will trigger the update_\n_functionality_\n\nFrom the C2 response the URL is extracted by finding the start offset of the string\n_“updatetpermission” once it finds it, its offset value is subtracted with 17 to get the URL from_\nwhere the updated executable will be downloaded. To get the command string malware\nextracts the string starting from the offset of the string “updatetpermission” + 19 and extracts\na 7 character length string which it uses as the command string.\n\nBelow screen shot shows the logic used to extract the URL and the command string, in the\nbelow screen shot the extracted command string is stored in the variable\n_ServerUpdatePermissionInstruction._\n\nOnce the URL and command string is extracted, the malware compares the command string\nwith the string “Pending”, only if the command string matches with string “Pending” then the\nmalware downloads the updated executable from the extracted URL. Below screen shot\nshows the code which performs the check and and extracted URL\n\n**_Note: In the below screen shot the URL (hxxp://c2xyup.com/update.exe) is not the actual_**\n_URL used by the malware for updating, this is a test URL used to determine the_\n_functionality, so this URL should not used as an indicator._\n\n\n-----\n\nThe malware then downloads the updated executable and drops it in the %Appdata%\\SQLite\ndirectory as shown in the below screen shots.\n\nOnce it downloads the updated executable then the malware creates a value in the Run\nregistry key for persistence, before that it deletes the old entry and adds the new entry so that\nnext time when the system starts the updated executable will run. Below screen shots show\nthe registry entry added by the malware.\n\n\n-----\n\nThe functionality allows the attacker to update their malware components.\n\n**_d) Delete/Uninstall Functionality_**\n\nMalware also has the capability to delete itself this is done by making a request to\n_Uninstaller.php. Below screen shot shows the code that makes this request._\n\n\n-----\n\nThe environment was configured to give a proper response to trigger the uninstall/delete\nfunctionality. Below screen shot shows the network traffic making the POST request to\n_Uninstaller.php and the returned response._\n\nMalware then checks if the C2 response contains the string “delete”. Below screen shots show\nthe code that reads the C2 response and the code that performs the check.\n\n\n-----\n\nIf the C2 response contains the string “delete”, then the malware first deletes the entry from\nthe Run registry that the malware uses for persistence as shown below.\n\nAfter deleting the registry entry, malware deletes all the files from the %Appdata%\\SQLite\ndirectory by creating a batch script. The batch script pings a hard coded IP address\n_180[ ]92[ ]154[ ]176 10 times (this is a technique used to sleep for 10 seconds) before deleting_\n\n\n-----\n\nall the files.\n\nOnce the all the files are deleted the malware kills its own process as shown in the below\nscreen shot.\n\nThis functionality allows the attackers to delete their footprints on the system.\n\n**C2 Information**\n\nThis section contains the details of the C2 domain qhavcloud[.]com. This C2 domain was\nassociated with two IP addresses. Both of these IP addresses is associated with hosting\nprovider in Germany as shown in the screen shots below.\n\n\n-----\n\nThe hard coded IP address 91[.]205[.]173[.]3 in the binary from where the malware\ndownloads additional components is also associated with the same hosting provider in\nGermany as shown below.\n\nThe C2 domain qhavcloud[.]com was also found to be associated with multiple malware\nsamples in the past. Below screen shot shows the md5 hashes of the samples that is\nassociated with the C2 domain.\n\n\n-----\n\nThe C2 domain qhavcloud[.]com and the hard coded IP address 91[.]205[.]173[.]3 were also\n[found to be associated with another attack campaign which targeted the senior army officers.](https://ciso.economictimes.indiatimes.com/news/cyber-security-team-discover-coordinated-attempt-of-hackers-targeting-senior-army-officers/58007868)\nThis suggests that the same espionage group involved in this attack also targeted the senior\narmy officers using a different email theme.\n\n**Threat Intelligence**\n\nInvestigating the domain idsadesk[.]in (which was used to send the email by impersonating\nthe identity of IDSA) shows that it was created on 20th Feb 2017 (which is the day before the\nspear-phishing email was sent to the victims). Most of the registrant information seems to be\nfake and another notable detail that is of interest is the registrant country and country code\n(+92) of registrant phone number is associated with Pakistan.\n\n\n-----\n\nFurther investigation shows that the same registrant email id was also used to register\nanother similar domain (idsagroup[.]in) which also impersonates the identity of IDSA. This\nimpersonating domain was also registered on the same day 20th February 2017 and this\ndomain could also be used by the attackers to send out spear-phishing emails to different\ntargets.\n\n\n-----\n\nWhile investigating the malware’s uninstall/delete functionality it was determined that\nmalware creates a batch script to delete all its files but before deleting all the files it pings 10\ntimes to an hard coded IP address 180[.]92[.]154[.]176 as shown below.\n\nInvestigating this hard coded IP address shows that it is located in Pakistan. The Pakistan\nconnection in the whois information and the hard coded IP address is interesting because the\n[previous two attacks against Indian Ministry of External Affairs and Indian Navy’s](https://cysinfo.com/uri-terror-attack-spear-phishing-emails-targeting-indian-embassies-and-indian-mea/)\nsubmarine manufacturer also had a Pakistan connection. Based on just the whois\ninformation (which can be faked) and the location of the IP address it is hard to say if the\nPakistan espionage group is involved in this attack, but based on the email theme, tactics\nused to impersonate Indian think tank (IDSA) and the targets chosen that possibility is\nhighly likely. Below screen shot shows the location of the hard coded IP address.\n\n**Indicators Of Compromise (IOC)**\n\n\n-----\n\nIn this campaign the cyber espionage group targeted Central Bureau of Investigation (CBI)\nbut it is possible that other government entities could also be targeted as part of this attack\ncampaign. The indicators associated with this attack are provided so that the organizations\n(Government, Public, Private organizations and Defense sectors) can use these indicators to\ndetect, remediate and investigate this attack campaign. Below are the indicators\n\n**_Dropped Malware Sample:_**\n_f8daa49c489f606c87d39a88ab76a1ba_\n\n**_Related Malware Samples:_**\n_15588a9ba1c0abefd38ac2594ee5be53_\n_04b4b036a48dc2d2022cc7704f85a560_\n_becc8e77ef003a4c88f7e6348ffd3609_\n_ceeeacbaf38792bcf06022e2b4874782_\n_515dce0ede42052ff3ef664db9873cea_\n_50c1d394bfa187ffd6251df6dd14e939_\n_3bd16cc1d1fea7190c36b3bd10c6810d_\n_b6c861556412a15b7979459176b7d82f_\n\n**_Network Indicators Associated with C2:_**\n_qhavcloud[.]com_\n_173[.]212[.]194[.]214_\n_173[.]212[.]193[.]53_\n_91[.]205[.]173[.]3_\n_180[.]92[.]154[.]176_\n\n**_Domains Impersonating the Identity of Indian Think Tank (IDSA):_**\n_idsadesk[.]in_\n_idsagroup[.]in_\n\n**_Email Indicator:_**\n_iasia69@z7az14m[.]com_\n\n**_C2 Communication Patterns:_**\n_hxxp://qhavcloud[.]com//northernlights//PingPong.php_\n_hxxp://qhavcloud[.]com//northernlights//postdata.php_\n_hxxp://qhavcloud[.]com//northernlights//JobProcesses.php_\n_hxxp://qhavcloud[.]com//northernlights//JobWork1.php_\n_hxxp://qhavcloud[.]com//northernlights//JobWork2.php_\n_hxxp://qhavcloud[.]com//northernlights//JobTCP1.php_\n_hxxp://qhavcloud[.]com//northernlights//JobTCP2.php_\n_hxxp://qhavcloud[.]com//northernlights//updateproductdownload.php_\n_hxxp://qhavcloud[.]com//northernlights//Uninstaller.php_\n\n\n-----\n\n**Conclusion**\n\nAttackers in this case made every attempt to launch a clever attack campaign by\nimpersonating the identity of highly influential Indian Think tank to target Indian\ninvestigative agency and the officials of the Indian army by using an email theme relevant to\nthe targets. The following factors in this cyber attack suggests the possible involvement of\nPakistan state sponsored cyber espionage group to spy or to take control of the systems of the\nofficials of Central Bureau of Investigation (CBI) and officials of the Indian Army.\n\nUse of domain impersonating the identity of highly influential Indian think tank\nVictims/targets chosen (CBI and Army officials)\nUse of Email theme that is of interest to the targets\nLocation of one of the hard coded IP address in the binary\nUse of TTP’s (tactics, techniques & procedures) similar to the previous campaigns\n[targeting Indian Ministry of External Affairs and Indian Navy’s Warship Manufacturer.](https://cysinfo.com/uri-terror-attack-spear-phishing-emails-targeting-indian-embassies-and-indian-mea/)\n[Use of the same C2 infrastructure that was used to target senior army officers](https://ciso.economictimes.indiatimes.com/news/cyber-security-team-discover-coordinated-attempt-of-hackers-targeting-senior-army-officers/58007868)\n\nThe attackers in this case used multiple techniques to avoid detection and to frustrate\nanalysts. The following factors reveal the attackers intention to remain stealthy and to gain\nlong-term access by evading analysis and security monitoring at both the desktop and\nnetwork levels.\n\nUse of password protected macro to prevent viewing the code and to make manual\nanalysis harder\nUse of TextBox within the UserForm to store malicious content to bypass analysis tools\nUse of legitimate service like Google drive to store the list of back up C2 servers to\nbypass security monitoring and reputation based devices.\nUse of malware that performs various checks before performing any malicious activity\nUse of backup C2 servers and hosting sites to keep the operation up and running\nUse of hosting provider to host C2 infrastructure\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-05-11 - Cyber Attack Impersonating Identity of Indian Think Tank to Target Central Bureau of Investigation CBI and Possibly Indian Army Officials.pdf"
    ],
    "report_names": [
        "2017-05-11 - Cyber Attack Impersonating Identity of Indian Think Tank to Target Central Bureau of Investigation CBI and Possibly Indian Army Officials.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535777,
    "ts_updated_at": 1743041164,
    "ts_creation_date": 1653489252,
    "ts_modification_date": 1653489252,
    "files": {
        "pdf": "https://archive.orkl.eu/c355fffb67601163c692c8ec8edc03e64e718c40.pdf",
        "text": "https://archive.orkl.eu/c355fffb67601163c692c8ec8edc03e64e718c40.txt",
        "img": "https://archive.orkl.eu/c355fffb67601163c692c8ec8edc03e64e718c40.jpg"
    }
}