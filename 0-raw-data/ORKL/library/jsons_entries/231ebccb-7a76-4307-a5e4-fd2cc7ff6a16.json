{
    "id": "231ebccb-7a76-4307-a5e4-fd2cc7ff6a16",
    "created_at": "2023-01-12T15:03:33.572455Z",
    "updated_at": "2025-03-27T02:06:08.837136Z",
    "deleted_at": null,
    "sha1_hash": "1ec525762531f4803a80612fe1ec2535534974b0",
    "title": "2017-04-25 - Philadelphia Ransomware Brings Customization to Commodity Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T19:50:21Z",
    "file_modification_date": "2022-05-28T19:50:21Z",
    "file_size": 3064419,
    "plain_text": "# Philadelphia Ransomware Brings Customization to Commodity Malware\n\n**[proofpoint.com/us/threat-insight/post/philadelphia-ransomware-customization-commodity-malware](https://www.proofpoint.com/us/threat-insight/post/philadelphia-ransomware-customization-commodity-malware)**\n\nApril 25, 2017\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nPhiladelphia Ransomware Brings Customization to Commodity Malware\n\n\n-----\n\nApril 25, 2017 Proofpoint Staff\n\n**Overview**\n\n[Philadelphia ransomware is a relatively new ransomware variant, first observed in September of last](https://www.proofpoint.com/us/threat-reference/ransomware)\nyear. Designed as an easy-to-use piece of malicious software with low barriers to entry for new\nransomware actors, Philadelphia is simple to customize and deploy. Although we most often associate\nransomware, including Philadelphia, with large-scale, \"spray and pray\" campaigns that send high\nmessage volumes to a wide spectrum of consumers and organizations, we are beginning to see\nsignificant differentiation among attacks, ransoms, scale, and even targeting.\n\nIn this blog, we focus on a recent Philadelphia ransomware campaign used in a series of targeted email\nattacks against a small number of organizations using lures and attachments highly customized for the\ntargeted organizations. In addition to explicit targeting, recent attacks using Philadelphia highlight the\nability to customize what is essentially commercial off-the-shelf (COTS) [malware, personalizing aspects](https://www.proofpoint.com/us/threat-reference/malware)\nof attacks such as the ransom note and ransom amounts.\n\n**Analysis**\n\nSince late last month, we have seen actors using Philadelphia to target specific healthcare institutions,\namong other organizations in the same city. In this case, email messages purporting to be from an\nemployee at a targeted company with subjects such as \"Patient Referral\" contained bit.do (URL\nshortener) links leading to the download of Philadelphia.\n\n\n-----\n\n_Figure 1: Email sample with patient referral lure_\n\n[Although redacted in Figure 1, the use of so-called \"display name spoofing\" to make the emails appear](https://www.proofpoint.com/us/corporate-blog/post/research-reveals-surge-bec-attacks-domain-spoofing)\nto be from internal senders is a technique commonly associated with targeted attacks and has been on\nthe rise among business email compromise (BEC) actors.\n\nAdditionally, the actor took an extra step to customize the ransom note by:\n\n(1) Calling out the potential victim organization by name\n\n(2) Setting the ransom to a high amount of 15 Bitcoins (approximately $18,000 USD) and\n\n(3) Threatening to delete 99 files every 45 minutes\n\n\n-----\n\n_Figure 2: Customized ransom note_\n\n**Ransom Note Customizations**\n\nWe determined that the demanded ransom amount is configurable and is returned in the command and\ncontrol (C&C) server response to the initial check-in beacon by the victim machine. The Bitcoin address\nand victim ID are returned in the same response. However, this is the first instance of ransom note\ncustomization we have observed with Philadelphia ransomware. This customization occurs through a\nsetting that is built into the malware itself. Examining our malware corpus, we found several other\ninstances of ransom note customization for Philadelphia ransomware, tailored to a variety of different\nsituations.\n\nIn one case, the ransom note was colored pink and included a small payoff amount of 0.05 Bitcoins.\nThe note threatened the victim, claiming “YOU HAVE BEEN EXPOSED!” and that three files will be\ndeleted every hour, ostensibly as a consequence for browsing pornography. At this time, we have not\ndetermined how this particular instance of Philadelphia ransomware was spread to potential victims.\n\n\n-----\n\n_Figure 3: Pink ransom note displayed by a sample with SHA256 hash of_\n_a1e1b22f907b4b5d801e7c1dd3855d77bf28831eaadc2fbf9ed16ee0cdcc8ccf_\n\nIn another case, we found a sample with a Russian-language ransom note. The English translation\n(see full text in Appendix A) told victims “Do not write to us if you do not like the price. We do not\nbargain.”\n\n\n-----\n\n_Figure 4: Red ransom note displayed by a sample with SHA256 hash of_\n_55793f2cd2a061646e73f0520f5f43a82da1c890624c0317777d5917efe68761_\n\n**Delivery**\n\nAs in the healthcare-targeted campaign, we have seen Philadelphia ransomware spreading via URLs\n[linking to zipped executables in email. A related healthcare campaign from the same actor also](https://blogs.forcepoint.com/security-labs/shelf-ransomware-used-target-healthcare-sector)\ntargeted hospitals with URLs, but in that case led to macro-laden Microsoft Word documents.\n\nWe also found a sample of a Microsoft Word document named CV.doc (Figure 5) that used macros and\nPowershell to download Philadelphia from a payload site.\n\n\n-----\n\n_Figure 5: Document attachment sample with SHA256 hash of_\n_6c852f2dcd2189f2c24c7b779dce62b114b293b983b5daa0858f7648af4a5424, which downloads the_\n_final payload_\n\nIt appears that Philadelphia is also spread via keygen and cracking sites as we found samples of the\nransomware bundled with various keygen programs and Bitcoin-related software.\n\n\n-----\n\n_Figure 6: The ransomware sample with SHA256 of_\n_e5d52926187e2b4b3086b14fe718d1896516a6d99e20efeb77e44b25e2f3de3e) is bundled with this_\n_keygen program_\n\n_Figure 7: The ransomware sample with SHA256 hash of_\n_a4450709af37731f17d29ddf4d83f9daafbae7dc67393e7f13fb2dcaf9a321e6 is bundled with this_\n_program_\n\nFinally, we have also observed Philadelphia being distributed via Sundown and RIG exploit kits.\n\n**Configuration File**\n\nAs noted above, a server-side script controls several parameters, including the ransom amount. In\nFigure 8, this parameter is set to 0.2 Bitcoins. The “confirmations” parameter, shown with the value “3”,\nappears to be the number of times the victim has to confirm that he or she paid the ransom.\n\n\n-----\n\n_Figure 8: Example Philadelphia configuration as stored on the C&C server for the sample with SHA256_\n_hash of b6be75155ca197c4931ed166dcc7725ad44adcfc8b9b6947f7cb69d2bf63ff64_\n\n_Figure 9: The server response to the initial victim check-in returns the victim ID, followed by a Bitcoin_\n_address (highlighted) and then by the ransom amount. In this case, the amount is 0.2 as specified in_\n_the configuration file._\n\n**Conclusion**\n\nWhile geographically targeted ransomware has been a part of the threat landscape for some time,\ntargeting of ransomware at specific companies or verticals has been rare. As these recent Philadelphia\nransomware examples show, even ‘entry-level’ ransomware is adopting the techniques of targeted\nemail-based attacks, including:\n\nEmail lures and attachment filenames customized for the targeted organization\nSpoofing to make it appear that the message was sent internally\nCustomized payment amounts, deletion schedules, ransom messages, languages, and even\ncolors per organization.\n\nThese targeted campaigns are carried out even as we continue to observe broad-based distribution of\nPhiladelphia ransomware through both email and web-based attacks.\n\nRansomware can be quite lucrative for threat actors in broad-based campaigns where actors generally\nrely on high volumes and relatively low ransoms to monetize ransomware. However, healthcare\norganizations are becoming a favorite for more targeted, higher-ransom attacks as well. Philadelphia\n\n\n-----\n\nransomware in particular is not considered especially sophisticated in its coding or encryption but is\nnotable for being an early example of \"commodity ransomware\", sold cheaply for widespread use\namong various threat actors. We have also observed cracked versions of Philadelphia in the wild that\ndo not require any upfront costs for would-be ransomware actors.\n\nChanges in the ransomware landscape are not limited to Philadelphia. For example, we have recently\nobserved narrow-spread Sage ransomware campaigns being delivered to small numbers of\norganizations in a few verticals. On the other hand, Locky returned to large-scale distribution recently\nbut in sporadic campaigns using new distribution vectors and demanding a higher ransom. In our\nrecent [first quarter Threat Report, we highlighted the continued rapid growth of ransomware variants in](https://www.proofpoint.com/us/quarterly-threat-summary)\nthe wild. While many of these new variants fail to gain traction, others come with new approaches and\nfeatures.\n\n_Figure 10: Indexed growth of ransomware variants reported or observed since December 2015_\n\nAs commodity ransomware becomes more sophisticated and customizable, new strains emerge\nrapidly, and ransomware-as-a-service becomes more commonplace, the possibilities for threat actors to\nuse this type of malware in unexpected ways increase. Organizations need to adopt robust strategies\nto stop ransomware messages at the door as effective attacks can have major financial impacts, both\ndirectly in terms of large ransoms and indirectly in terms of time, productivity, and effectiveness.\n\n**Indicators of Compromise (IOCs)**\n\n\n**IOC** **IOC**\n**Type**\n\n\n**Description**\n\n\na1e1b22f907b4b5d801e7c1dd3855d77bf28831eaadc2fbf9ed16ee0cdcc8ccf SHA256 Philadelphia\nransomware\n\n6c3d69053a19e336289efbe0ee65eba1ef21076019a4b71b39bca8bd105e86cd SHA256 Philadelphia\nransomware\n\n\n-----\n\n55793f2cd2a061646e73f0520f5f43a82da1c890624c0317777d5917efe68761 SHA256 Philadelphia\nransomware\n\nb6be75155ca197c4931ed166dcc7725ad44adcfc8b9b6947f7cb69d2bf63ff64 SHA256 Philadelphia\nransomware\n\n6c852f2dcd2189f2c24c7b779dce62b114b293b983b5daa0858f7648af4a5424 SHA256 MS Word\ndocument\nspreading\nPhiladelphia\n\ne5d52926187e2b4b3086b14fe718d1896516a6d99e20efeb77e44b25e2f3de3e SHA256 Philadelphia\nbundled\nwith keygen\nprogram\n\na4450709af37731f17d29ddf4d83f9daafbae7dc67393e7f13fb2dcaf9a321e6 SHA256 Philadelphia\nbundled\nwith keygen\nprogram\n\nfoolonthehill[.]website Domain Philadelphia\nC&C\n\nwhole-sale-deals[.]com Domain Philadelphia\nC&C\n\n191.101.242[.]123:53161 IP Philadelphia\nC&C\n\n95.211.147[.]156:80 IP Philadelphia\nC&C\n\n**ET and ETPRO Suricata/Snort Coverage**\n\n2822596 | ETPRO TROJAN Win32/Philadelphia Ransomware Encryption Activity\n\n2822136 | ETPRO TROJAN Win32/Philadelphia Ransomware CnC Checkin\n\n**Appendix A**\n\nFull ransom note for sample with SHA256\n55793f2cd2a061646e73f0520f5f43a82da1c890624c0317777d5917efe68761\n\n_Original ransom note text:_\n\nВаши файлы были зашифрованы.\n\n\n-----\n\nВы можете самостоятельно восстановить их.\nДля этого нужно отправить $200 в биткоинах на счет указанный в поле «Номер кошелька».\n\nДля создания собственного кошелька используйте проверенный ресурс:\nhttps://blockchain.info/\n\nДля обмена рублей в биткоины рекомендуем следующие ресурсы:\nhttps://www.savechange[.]ru\nhttps://x-obmen[.]ru\nhttps://x-pay[.]cc\nhttps://kassa[.]cc\n\nПосле оплаты необходимо ввести код транзакции в поле «Код транзакции».\nЗатем отправить его нам, нажав кнопку «Отправить».\n\nПосле получения 3-х подтверждений мы начинаем расшифровку ваших файлов.\nВ течение от 5 минут до часа Ваши файлы будут расшифрованы автоматически,\nесли компьютер будет подключен к интернету.\n\nВ случае возникновения проблем с расшифровкой обратитесь по адресу:\nkenthottoren@gmail[.]com\n\nВ письме требуется указать Ваш IP-адрес и имя пользователя.\nЭту информацию можно посмотреть на сайте:\nhttp://2ip[.]ru\n\nНе пытайтесь восстановить данные с помощью антивирусных утилит, испортите все файлы.\n\nЕсли хотите попробывать, пробуйте на другом ПК и минимум файлов, иначе потом даже я не\nсмогу помочь.\n\nИ помните пожалуйста, что цена каждый день растет.\n\nP.S. Пишите четко, ясно, предельно понятно, учитывайте, что кроме Вас пишет много людей.\n\nВ диалоги не вступаю, работа по приницпу быстро заплатил, сразу получил.\nНе устраивает цена услуги, больше не пишите.\n\nПопытки расшифровать самостоятельно не приведут ни к чему, кроме безвозвратной потери\nинформации.\n\n_Ransom note translation:_\nAll the important files on your computer were encrypted.\n\nTo decrypt the files you should send $200 in Bitcoin to address written in form «Wallet ID».\nTo create your ouw wallet use trusted resource:\nhttps://blockchain.info/\n\nFor currency exchange you can use follow links:\nhttps://www.savechange[.]ru\nhttps://x-obmen[.]ru\n\n\n-----\n\nhttps://x-pay[.]cc\nhttps://kassa[.]cc\n\nAfter sucсessfull payment, paste the transaction number in «Transaction ID» and send it to us «Send».\n\nWithin 5 minutes to an hour after payment, all your files will be decrypted automatically, but required\ninternet access.\n\nIn case of problems, contact:\nkenthottoren@gmail[.]com\n\nWe cant help you without your IP address and username. So you should put this information in your email.\n\nAll the attempts of decryption by yourself will result only in irrevocable loss of your data.\n\nQuickly paid/immediately received. Do not write to us if you do not like the price.\nWe do not bargain.\n\nAnd please remember that the price is growing every day.\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-04-25 - Philadelphia Ransomware Brings Customization to Commodity Malware.pdf"
    ],
    "report_names": [
        "2017-04-25 - Philadelphia Ransomware Brings Customization to Commodity Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535813,
    "ts_updated_at": 1743041168,
    "ts_creation_date": 1653767421,
    "ts_modification_date": 1653767421,
    "files": {
        "pdf": "https://archive.orkl.eu/1ec525762531f4803a80612fe1ec2535534974b0.pdf",
        "text": "https://archive.orkl.eu/1ec525762531f4803a80612fe1ec2535534974b0.txt",
        "img": "https://archive.orkl.eu/1ec525762531f4803a80612fe1ec2535534974b0.jpg"
    }
}