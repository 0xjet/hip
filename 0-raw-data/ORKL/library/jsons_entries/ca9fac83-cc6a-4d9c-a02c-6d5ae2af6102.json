{
    "id": "ca9fac83-cc6a-4d9c-a02c-6d5ae2af6102",
    "created_at": "2022-12-27T17:06:05.888655Z",
    "updated_at": "2025-03-18T19:54:51.31067Z",
    "deleted_at": null,
    "sha1_hash": "00a66464451d8fe769b4b3285d01702c0ba8607d",
    "title": "Threat Actors Exploiting F5 BIG-IP CVE-2022-1388",
    "authors": "CISA, MS-ISAC",
    "file_creation_date": "2022-05-17T18:42:00Z",
    "file_modification_date": "2022-05-17T18:42:00Z",
    "file_size": 513013,
    "plain_text": "Coauthored by:\n\nTLP:WHITE\n\nProduct ID: AA22-138A\nMay 18, 2022\n\nThreat Actors Exploiting F5 BIG-IP CVE-2022-1388\nSUMMARY\nThe Cybersecurity and Infrastructure Security Agency\n(CISA) and the Multi-State Information Sharing & Analysis\nCenter (MS-ISAC) are releasing this joint Cybersecurity\nAdvisory (CSA) in response to active exploitation of CVE2022-1388. This recently disclosed vulnerability in certain\nversions of F5 Networks, Inc., (F5) BIG-IP enables an\nunauthenticated actor to gain control of affected systems\nvia the management port or self-IP addresses.\n\nActions for administrators to take\ntoday:\n• Do not expose management\ninterfaces to the internet.\n• Enforce multi-factor\nauthentication.\n• Consider using CISA’s Cyber\nHygiene Services.\n\nF5 released a patch for CVE-2022-1388 on May 4, 2022,\nand proof of concept (POC) exploits have since been\npublicly released, enabling less sophisticated actors to exploit the vulnerability. Due to previous\nexploitation of F5 BIG-IP vulnerabilities, CISA and MS-ISAC assess unpatched F5 BIG-IP devices are\nan attractive target; organizations that have not applied the patch are vulnerable to actors taking\ncontrol of their systems.\nAccording to public reporting, there is active exploitation of this vulnerability, and CISA and MS-ISAC\nexpect to see widespread exploitation of unpatched F5 BIG-IP devices (mostly with publicly exposed\nmanagement ports or self IPs) in both government and private sector networks. CISA and MS-ISAC\nstrongly urge users and administrators to remain aware of the ramifications of exploitation and use\nthe recommendations in this CSA—including upgrading their software to fixed versions—to help\nsecure their organization’s systems against malicious cyber operations. Additionally, CISA and MSISAC strongly encourage administrators to deploy the signatures included in this CSA to help\ndetermine whether their systems have been compromised. CISA and MS-ISAC especially encourage\norganizations who did not patch immediately or whose F5 BIG-IP device management interface has\nbeen exposed to the internet to assume compromise and hunt for malicious activity using the\ndetection signatures in this CSA. If potential compromise is detected, organizations should apply the\nincident response recommendations included in this CSA.\n\nThis document is marked TLP:WHITE. Disclosure is not limited. Sources may use TLP:WHITE when information\ncarries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public\nrelease. Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction.\nFor more information on the Traffic Light Protocol, see http://www.cisa.gov/tlp/.\n\nTLP: WHITE\n\nCISA | MS-ISAC\n\nTLP:WHITE\n\nTECHNICAL DETAILS\nCVE-2022-1388 is a critical iControl REST authentication bypass vulnerability affecting the following\nversions of F5 BIG-IP:[1]\n•\n•\n•\n•\n•\n\n16.1.x versions prior to 16.1.2.2\n15.1.x versions prior to 15.1.5.1\n14.1.x versions prior to 14.1.4.6\n13.1.x versions prior to 13.1.5\nAll 12.1.x and 11.6.x versions\n\nAn unauthenticated actor with network access to the BIG-IP system through the management port or\nself IP addresses could exploit the vulnerability to execute arbitrary system commands, create or\ndelete files, or disable services. F5 released a patch for CVE-2022-1388 for all affected versions—\nexcept 12.1.x and 11.6.x versions—on May 4, 2022 (12.1.x and 11.6.x versions are end of life [EOL],\nand F5 has stated they will not release patches).[2]\nPOC exploits for this vulnerability have been publicly released, and on May 11, 2022, CISA added\nthis vulnerability its Known Exploited Vulnerabilities Catalog, based on evidence of active exploitation.\nDue to the POCs and ease of exploitation, CISA and MS-ISAC expect to see widespread exploitation\nof unpatched F5 BIG-IP devices in government and private networks.\n\nDETECTION METHODS\nCISA recommends administrators, especially of organizations who did not immediately patch, to:\n•\n•\n•\n\nSee the F5 Security Advisory K23605346 for indicators of compromise.\nSee the F5 guidance K11438344 if you suspect a compromise.\nDeploy the following CISA-created Snort signature:\nalert tcp any any -> any $HTTP_PORTS (msg:”BIG-IP F5 iControl:HTTP POST URI\n‘/mgmt./tm/util/bash’ and content data ‘command’ and ‘utilCmdArgs’:CVE2022-1388”; sid:1; rev:1; flow:established,to_server;\nflowbits:isnotset,bigip20221388.tagged; content:”POST”; http_method;\ncontent:”/mgmt/tm/util/bash”; http_uri; content:”command”;\nhttp_client_body; content:”utilCmdArgs”; http_client_body;\nflowbits:set,bigip20221388.tagged; tag:session,10,packets; reference:cve2022-1388; reference:url,github.com/alt3kx/CVE-2022-1388_PoC; priority:2;\nmetadata:service http;)\n\nAdditional resources to detect possible exploitation or compromise are identified below:\n•\n\nEmerging Threats suricata signatures. Note: CISA and MS-ISAC have verified these\nsignatures are successful in detection of both inbound exploitation attempts (SID: 2036546) as\nwell as post exploitation, indicating code execution (SID: 2036547).\n\nPage 2 of 5 | Product ID: AA22-138A\n\nTLP: WHITE\n\nCISA | MS-ISAC\n\nTLP:WHITE\no\n\nSID 2036546\nalert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"ET EXPLOIT F5 BIGIP iControl REST Authentication Bypass (CVE 2022-1388) M1\";\nflow:established,to_server; content:\"POST\"; http_method;\ncontent:\"/mgmt/tm/util/bash\"; http_uri; fast_pattern;\ncontent:\"Authorization|3a 20|Basic YWRtaW46\"; http_header;\ncontent:\"command\"; http_client_body; content:\"run\"; http_client_body;\ndistance:0; content:\"utilCmdArgs\"; http_client_body; distance:0;\nhttp_connection; content:\"x-F5-Auth-Token\"; nocase; http_header_names;\ncontent:!\"Referer\"; content:\"X-F5-Auth-Token\";\nflowbits:set,ET.F5AuthBypass; reference:cve,2022-1388;\nclasstype:trojan-activity; sid:2036546; rev:2; metadata:attack_target\nWeb_Server, created_at 2022_05_09, deployment Perimeter, deployment\nSSLDecrypt, former_category EXPLOIT, performance_impact Low,\nsignature_severity Major, updated_at 2022_05_09;)\n\no\n\nSID 2036547\nalert http $HOME_NET any -> any any (msg:\"ET EXPLOIT F5 BIG-IP\niControl REST Authentication Bypass Server Response (CVE 2022-1388)\";\nflow:established,to_client; flowbits:isset,ET.F5AuthBypass;\ncontent:\"200\"; http_stat_code; file_data; content:\"kind\";\ncontent:\"tm|3a|util|3a|bash|3a|runstate\"; fast_pattern; distance:0;\ncontent:\"command\"; distance:0; content:\"run\"; distance:0;\ncontent:\"utilCmdArgs\"; distance:0; content:\"commandResult\";\ndistance:0; reference:cve,2022-1388; classtype:trojan-activity;\nsid:2036547; rev:1; metadata:attack_target Web_Server, created_at\n2022_05_09, deployment Perimeter, deployment SSLDecrypt,\nformer_category EXPLOIT, performance_impact Low, signature_severity\nMajor, updated_at 2022_05_09;)\n\n•\n\n•\n\n•\n\nPalo Alto Networks Unit 42 Threat Brief: CVE-2022-1388. This brief includes indicators of\ncompromise. Note: due to the urgency to share this information, CISA and MS-ISAC have not\nyet validated this content.\nCisco Talos Intelligence Group - Comprehensive Threat Intelligence: Threat Advisory: Critical\nF5 BIG-IP Vulnerability. This blog includes indicators of compromise. Note: due to the\nurgency to share this information, CISA and MS-ISAC have not yet validated this content.\nRandori’s bash script. This script can be used to identify vulnerable instances of BIG-IP. Note:\nMS-ISAC has verified this bash script identifies vulnerable instances of BIG-IP.\n\nPage 3 of 5 | Product ID: AA22-138A\n\nTLP: WHITE\n\nCISA | MS-ISAC\n\nTLP:WHITE\n\nINCIDENT RESPONSE\nIf an organization’s IT security personnel discover system compromise, CISA and MS-ISAC\nrecommend they:\nQuarantine or take offline potentially affected hosts.\nReimage compromised hosts.\nProvision new account credentials.\nLimit access to the management interface to the fullest extent possible.\nCollect and review artifacts such as running processes/services, unusual authentications,\nand recent network connections.\n6. Report the compromise to CISA via CISA’s 24/7 Operations Center (report@cisa.gov or\n888-282-0870). State, local, tribal, or territorial government entities can also report to MSISAC (SOC@cisecurity.org or 866-787-4722).\n\n1.\n2.\n3.\n4.\n5.\n\nSee the joint CSA from the cybersecurity authorities of Australia, Canada, New Zealand, the United\nKingdom, and the United States on Technical Approaches to Uncovering and Remediating Malicious\nActivity for additional guidance on hunting or investigating a network, and for common mistakes in\nincident handling. CISA and MS-ISAC also encourage government network administrators to see\nCISA’s Federal Government Cybersecurity Incident and Vulnerability Response Playbooks. Although\ntailored to federal civilian branch agencies, these playbooks provide operational procedures for\nplanning and conducting cybersecurity incident and vulnerability response activities and detail steps\nfor both incident and vulnerability response.\n\nMITIGATIONS\nCISA and MS-ISAC recommend organizations:\n•\n•\n\nUpgrade F5 BIG-IP software to fixed versions; organizations using versions 12.1.x and 11.6.x\nshould upgrade to supported versions.\nIf unable to immediately patch, implement F5’s temporary workarounds:\no Block iControl REST access through the self IP address.\no Block iControl REST access through the management interface.\no Modify the BIG-IP httpd configuration.\n\nSee F5 Security Advisory K23605346 for more information on how to implement the above\nworkarounds.\nCISA and MS-ISAC also recommend organizations apply the following best practices to reduce risk of\ncompromise:\n•\n•\n\nMaintain and test an incident response plan.\nEnsure your organization has a vulnerability program in place and that it prioritizes patch\nmanagement and vulnerability scanning. Note: CISA’s Cyber Hygiene Services (CyHy) are\nfree to all SLTT organizations and public and private sector critical infrastructure\norganizations: https://www.cisa.gov/cyber-hygiene-services.\n\nPage 4 of 5 | Product ID: AA22-138A\n\nTLP: WHITE\n\nCISA | MS-ISAC\n\nTLP:WHITE\n•\n\nProperly configure and secure internet-facing network devices.\no Do not expose management interfaces to the internet.\no Disable unused or unnecessary network ports and protocols.\no Disable/remove unused network services and devices.\n\n•\n\nAdopt zero-trust principles and architecture, including:\no Micro-segmenting networks and functions to limit or block lateral movements.\no Enforcing multifactor authentication (MFA) for all users and VPN connections.\no Restricting access to trusted devices and users on the networks.\n\nREFERENCES\n[1] K23605346: BIG-IP iControl REST vulnerability CVE-2022-1388\n[2] K11438344: Considerations and guidance when you suspect a security compromise on a BIG-IP\nsystem\n\nPage 5 of 5 | Product ID: AA22-138A\n\nTLP: WHITE",
    "language": "EN",
    "sources": [
        {
            "id": "4e039bf8-7239-4999-8ec0-eb202d1465af",
            "created_at": "2022-12-04T11:19:36.52593Z",
            "updated_at": "2022-12-04T11:19:36.52593Z",
            "deleted_at": null,
            "name": "ORKL",
            "url": "https://github.com/ORKL/library",
            "description": "ORKL Community Contributed Content",
            "reports": null
        }
    ],
    "references": [
        "https://www.cisa.gov/uscert/ncas/alerts/aa22-138a",
        "https://www.cisa.gov/uscert/sites/default/files/publications/AA22-138A-Threat_Actors_Exploiting_F5_BIG-IP_CVE-2022-1388_F5.pdf"
    ],
    "report_names": [
        "AA22-138A-Threat_Actors_Exploiting_F5_BIG-IP_CVE-2022-1388_F5.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1672160765,
    "ts_updated_at": 1742327691,
    "ts_creation_date": 1652812920,
    "ts_modification_date": 1652812920,
    "files": {
        "pdf": "https://archive.orkl.eu/00a66464451d8fe769b4b3285d01702c0ba8607d.pdf",
        "text": "https://archive.orkl.eu/00a66464451d8fe769b4b3285d01702c0ba8607d.txt",
        "img": "https://archive.orkl.eu/00a66464451d8fe769b4b3285d01702c0ba8607d.jpg"
    }
}