{
    "id": "7d94b22a-30c5-4b41-abaf-c306d6fcfb10",
    "created_at": "2023-01-12T15:04:33.814434Z",
    "updated_at": "2025-03-27T02:05:20.53842Z",
    "deleted_at": null,
    "sha1_hash": "3eb905e0dfcbbfe81cc2b71900b07834586b0ded",
    "title": "2022-09-08 - The art and science behind Microsoft threat hunting- Part 1",
    "authors": "",
    "file_creation_date": "2022-10-02T12:02:39Z",
    "file_modification_date": "2022-10-02T12:02:39Z",
    "file_size": 145340,
    "plain_text": "# The art and science behind Microsoft threat hunting: Part 1\n\n**[microsoft.com/security/blog/2022/09/08/part-1-the-art-and-science-of-threat-hunting/](https://www.microsoft.com/security/blog/2022/09/08/part-1-the-art-and-science-of-threat-hunting/)**\n\nSeptember 8, 2022\n\nAt Microsoft, we define threat hunting as the practice of actively looking for cyberthreats that\nhave covertly (or not so covertly) penetrated an environment. This involves looking beyond\nthe known alerts or malicious threats to discover new potential threats and vulnerabilities.\n\n## Why do incident responders hunt?\n\nThe Microsoft Detection and Response Team (DART) mission is to respond to security\nincidents and help our customers become cyber-resilient. This involves incorporating threat\n[hunting as part of our proactive and reactive investigative service offerings to determine the](https://www.microsoft.com/security/business/services/microsoft-security-services-incident-response)\nfollowing:\n\nWhether systems are under targeted exploitation through investigation for signs of\nadvanced implants and anomalous behavior.\nIdentifying groundwork for the recovery process of evicting the attacker from the\nenvironment.\nStrategic recommendations for protecting against sophisticated threat actors.\n\nIn reactive incident response investigations, threat hunting helps determine the full scope of\nthe incident and informs an effective recovery and remediation strategy. In proactive\ninvestigations, a threat hunt can discover latent threats or existing compromises as well as\ndemonstrate the effectiveness of current security controls and their security operations\n\n\n-----\n\nprocesses. By uncovering novel attacker campaigns and previously undetected threats,\nDART provides valuable feedback to improve product detections, both for Microsoft security\nproducts and for the entire security ecosystem.\n\n## How do we approach threat hunting?\n\nThe canonical definition of threat hunting involves three interrelated things:\n\n**Targeted threat hunting—We define targeted hunting as actively looking for and**\nrooting out cyberthreats that have penetrated an environment, and looking beyond the\nknown alerts or malicious threats to discover new potential threats and vulnerabilities.\nTargeted threat hunting has a scope where we are looking for specific classes of\nindicators. For example, given a recently revealed attack, an organization may want to\nassess its environment to see if it, too, has been affected.\n**Security monitoring—Process of continuously monitoring the state of an environment**\nto detect unusual or unauthorized activities. This involves a network operations center\n(NOC) and an SOC to ensure that networks are protected against disruptions and\nthreats.\n**Incident response investigation—An investigation to identify the root cause and**\ndevelop a remediation plan to regain and retain positive control over the environment\nfollowing the detection of unauthorized access or suspicious activity.\n\nEach organization approaches threat hunting differently. Sometimes, the customer will have\nspecific outcomes in mind that align with the known techniques. We center on a general\napproach based on anomaly detection and pivoting combined with a knowledge of the\noverall environment. This allows us to accomplish multiple goals, versus employing an\napproach solely focused on a targeted threat hunt where additional threats and risks may be\noverlooked.\n\nWe will go into more detail about hunting for anomalies later in this blog.\n\n## Threat hunting principles\n\nOur forensic investigators at DART lean on the [Alexiou Principle, which states four key](https://thedigitalstandard.blogspot.com/2009/06/alexiou-principle.html)\nquestions for our investigators to answer:\n\n### 1. What question are you trying to answer?\n\nThreat hunting varies depending on the main objectives or questions that need to be\nanswered. This involves trying to understand a threat actor’s main objective, the cyber terrain\nin which they operate, and understanding how you can get closer to those objectives.\nFraming the question clearly helps us define the scope of every threat hunt.\n\n### 2. What data do you need to answer that question?\n\n\n-----\n\nTo answer the previous question would involve a two-pronged approach with a focus on\ndetermining what data is required, and how to obtain that data. During DART investigations,\nwe often get a variety of datasets while entering a customer investigation, such as live feeds\nand telemetry. We want to pick up everything that is currently in the environment, enumerate\ndirectories that we know bad actors like to live in, collect event logs that will potentially show\nus evidence of historical or current badness, registry keys that we see bad actors like to\ntamper with, and many more.\n\nWe use a tiered data collection model and start by collecting a snapshot of the densest, most\nindicator-rich data we can from every object and endpoint we can reach. This data is\nintended to provide information about any known threats, known attack patterns, and many\n(but not all) indicators of suspicious or anomalous activity. Where systems of interest are\nidentified, we return and collect a larger, more complete dataset of logs and forensic artifacts.\n\n### 3. How do you extract that data?\n\nNow that you’ve identified the data, you’ll need to capture it using various toolsets, such as a\npoint-in-time snapshot tool or, if the customer doesn’t have one deployed already, an\n[endpoint detection and response tool, such as Microsoft Defender for Endpoint, to obtain the](https://www.microsoft.com/security/business/endpoint-security/microsoft-defender-endpoint)\ndata. From the analytics captured, we can see things that are potentially good, bad, or\ninteresting. Part of this phase also takes data ingestion into account. We consider how the\ncollected data is consumed and how to efficiently separate threats from the background\nnoise of a complex global enterprise.\n\n### 4. What does the data tell you?\n\nLooking at the collected data now becomes an exercise in data analytics. It’s a question of\nevaluating prevalence and frequency by taking everything that occurs within an environment\nand trying to figure out what belongs and what doesn’t belong. This train of thought can take\na handful of different forms, that can be something as simple as “How often does this secure\n_hashing algorithm_ _show up across the entire environment?” to a more nuanced and precise_\nway, such as asking “How often does it show up only on domain controllers? On devices in\n_this organizational unit? How about when it’s seen with this other user account?”_\n\nAs it turns out, there are a lot of different ways for us to do this counting game. Our role as\nthreat hunters is to figure out the most relevant, high-priority way to account for these\ninteresting findings and see if patterns revealed themselves. We’re looking for indicators of\nattack or compromise that maybe others haven’t found. It all depends on what data is\navailable to us and understanding it.\n\n## Understanding the data\n\n\n-----\n\nWe approach understanding the data by looking for anomalies, the current state, and the\nabsence of data.\n\n### Where the rubber meets the road: forming the attack narrative\n\nWe believe there’s a clear art and science to threat hunting, but at the end of the day, we\nseek to understand the anomalies in the acquired evidence. One way we do this is by using\nthe knowledge of what is typical in an environment to identify what isn’t. Understanding the\ntypical scenario and marrying that with the knowledge of threat actor tools, techniques, and\nprocesses allows us to gain a deep understanding of the data and the systems we’re looking\nat. Stringing these anomalies together can then create a pattern of anomalies, helping us\nform a story using analytical opinions based on facts, also known as the attack narrative.\n\nThe ability to identify anomalies makes for an important skill set for an analyst, but\nunderstanding the current state is just as crucial. Anomaly-based hunting will be discussed in\nmore detail in the second part of this series when we go into general hunting strategies.\n\n### Looking at the current state\n\nIf an investigator is lucky enough, they might be dealing with forensic data for the anomaly\nhunt. But often, there will be times when our observations are limited to the current state of\nthe environment. Even if we don’t have the luxury of historical artifacts, looking at the current\nstate can provide valuable information.\n\nOur [proactive Cybersecurity Operations Services prior to an incident allow organizations to](https://www.microsoft.com/en-us/security/business/services/microsoft-security-services-incident-response#office-ContentAreaHeadingTemplate-8xs2edj)\ngain better knowledge of their current security posture and risk exposure before an incident\neven occurs.\n\nBy understanding the current state and its configurations, you can determine where the\npotentially malicious or anomalous activity lies as an initial starting point.\n\nAsking questions like “How did it get into that state? Was that it in that state intentionally or\n_was that the result of somebody doing something malicious?” allows our investigators to_\nbuild from something of interest, look a little bit closer, and then pivot from there until we find\ntrue signs of malicious activity.\n\n### Looking at the absence of data\n\nThe absence of data is just as important as understanding the presence of it. Often, we are\nprovided with data that is lacking or missing, and so the questions gleaned from these\nobservations become: “Why don’t I have that artifact(s)? What didn’t happen? Was it\n_because this data wasn’t recorded? Was the data removed?”_\n\n\n-----\n\nIn the absence of data, we also try to determine what could have happened at a given stage\nof a compromise and what normally happens at that stage. With that information, we try and\nform our hypothesis about the stages of compromise, if it occurs in an environment. For\ninstance, a customer during an incident response engagement might halt further\ninvestigation or response simply because they’re not seeing data exfiltration activity on their\nsensors and logs.\n\nThe approach to understanding the data varies depending on the analyst, but the goal is to\nanswer a series of questions and turn those questions into more questions, and then stop at\nsome point so you can paint the most complete picture possible.\n\n## Knowing when to stop\n\nFollowing an investigative trail results in some form of data aggregation. Knowing when to\nstop this trail can often be challenging. An indication of knowing when to stop is when the\npicture doesn’t change even after pulling in more information, leaving you with a nexus of\ntruth about that event or indicator. A comparison to this is the computer science algorithm of\ndepth-first search versus breadth-first search, where investigators can potentially chase one\nsingle trail too far, investing too much time on one possible indicator of an attack, and\nrunning out of time to investigate other possible indicators. One approach we take to avoid\nthe pitfalls of digging for data is to consult with fellow analysts to get a different perspective\nto ensure that you are looking at everything from every possible angle. Weighted risk\nanalysis also helps us narrow down what leads to follow. We ask ourselves “what is the\nprobability that a lead I’m investigating will turn out to be malicious?” Multiply that by the\npotential impact that malicious activity would have. Using that value to rank which leads are\nmost important to follow first helps find higher-risk threats (ransomware, full-domain\ncompromises) faster than low-risk threats (adware, coin miners).\n\nWe’ve just described DART’s threat hunting principles and the art form that is understanding\nthe data we’re dealing with when it comes to our incident response work, combing through\nthe data, and creating patterns of suspicious activity by applying critical thinking. In our\nfollow-up post, we will talk about general strategies behind threat hunting and how we work\nwith [threat intelligence. Stay tuned.](https://www.microsoft.com/security/business/siem-and-xdr/microsoft-defender-threat-intelligence)\n\n## Learn more\n\nGo to our DART blog series to learn more about the Microsoft Detection and Response\nTeam.\n\n[To learn more about Microsoft Security solutions, visit our website. Bookmark the](https://www.microsoft.com/security/business/solutions) Security\nblog to keep up with our expert coverage on security matters. Also, follow us\nat [@MSFTSecurity for the latest news and updates on cybersecurity.](https://twitter.com/@MSFTSecurity)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-08 - The art and science behind Microsoft threat hunting- Part 1.pdf"
    ],
    "report_names": [
        "2022-09-08 - The art and science behind Microsoft threat hunting- Part 1.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535873,
    "ts_updated_at": 1743041120,
    "ts_creation_date": 1664712159,
    "ts_modification_date": 1664712159,
    "files": {
        "pdf": "https://archive.orkl.eu/3eb905e0dfcbbfe81cc2b71900b07834586b0ded.pdf",
        "text": "https://archive.orkl.eu/3eb905e0dfcbbfe81cc2b71900b07834586b0ded.txt",
        "img": "https://archive.orkl.eu/3eb905e0dfcbbfe81cc2b71900b07834586b0ded.jpg"
    }
}