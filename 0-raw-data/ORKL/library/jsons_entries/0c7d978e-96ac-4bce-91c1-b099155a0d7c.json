{
    "id": "0c7d978e-96ac-4bce-91c1-b099155a0d7c",
    "created_at": "2022-10-25T16:48:18.096754Z",
    "updated_at": "2025-03-27T02:08:40.582009Z",
    "deleted_at": null,
    "sha1_hash": "af54e77fd3be3089a4cb100c87b57243eeb33c5c",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-07-02T15:47:44Z",
    "file_modification_date": "2019-07-02T15:47:44Z",
    "file_size": 6159903,
    "plain_text": "# Operation Tripoli\n\n**research.checkpoint.com/operation-tripoli**\n\nJuly 1, 2019\n\nJuly 1, 2019\nCheck Point Research recently came across a large-scale campaign that for years was\nusing Facebook pages to spread malware across mobile and desktop environments,\nwith one target country in mind: Libya.\n\nIt seems that the tense political situation in Libya is useful to some, who use it to lure\nvictims into clicking links and downloading files that are supposed to inform about the\nlatest airstrike in the country, or the capturing of terrorists, but instead contain malware.\n\nOur investigation started when we came across a Facebook page impersonating the\ncommander of Libya’s National Army, Khalifa Haftar. In addition to being a Field Marshal,\nHaftar is a prominent figure in Libya’s political arena and has had major roles as a\nmilitary leader in the country’s ongoing civil war.\n\nThrough this Facebook page we were able to trace this malicious activity all the way\ndown to the attacker responsible for it and find out how they have been taking advantage\nof the social networking platform for years, compromising legitimate websites to host\nmalware and, in the end, successfully made their way to tens of thousands of victims\nmainly from Libya, but also in Europe, the United States and Canada.\n\nBased on information we shared, Facebook took down the pages and accounts that\ndistributed the malicious artifacts belonging to this operation.\n\n**In the Name of Haftar**\n\n\n-----\n\nThe Facebook page impersonating Khalifa Haftar was created at the beginning of April\n2019, and has since managed to recruit more than 11,000 followers. The page shares\nposts which have political themes, and include URLs to download files marketed as\nleaks from Libya’s intelligence units.\n\nThe description in the posts claims that those leaks contain documents exposing\ncountries such as Qatar or Turkey conspiring against Libya, or photos of a captured pilot\nthat tried to bomb the capital city of Tripoli.\n\nSome of the URLs were even supposed to lead to mobile applications that are intended\nfor citizens interested in joining the Libyan armed forces:\n\nBut instead of the promised\ncontent in the posts, the links\nwould download malicious\nVBE or WSF files for\nWindows environments, and\nAPK files for Android.\n\nThe threat actor opted for\nopen source tools instead of\ndeveloping their own, and\ninfected the victims with\nknown remote administration\ntools (RATs) such as Houdini,\nRemcos, and SpyNote, which\nare often used in run-of-themill attacks.\n\nIn our case, the malicious\nsamples would usually be\nstored in file hosting services\nsuch as Google Drive,\nDropbox, Box and more.\n\nThe username in the page’s\nweb address (@kalifhafatr)\nmisspells Haftar’s name, and\nlooking it up online leads to a\nBlogger account with the same name. This account has been active since 2015, and\nmanages multiple blog pages:\n\n\n-----\n\nThe most recent blog published by this account also uses Haftar’s name and downloads\na malicious VBE automatically when accessed:\n\n**Grammatical Mistakes and Giveaways**\n\nAnother warning sign about the legitimacy of the page was the amount of grammatical\nmistakes that were found in almost every post. Haftar’s name was not the only thing\nmisspelled in the Facebook page, as the posts included many misspelled words, missing\nletters and repeated typos in Arabic. Below is one of the posts from the page, with all of\nthe grammatical mistakes highlighted:\n\nMost of those mistakes are repetitive, and some of the posts use words which do not\nexist in Arabic, because the originally intended ones are missing certain letters (for\nexample “Pove” instead of “Prove”). Those spelling mistakes are not ones that can be\ngenerated by online translation engines, and can indicate that the text was written by an\nArabic speaker.\n\nLooking up some combinations of the incorrect phrasing led us to numerous posts\nacross a network of Facebook pages that repeat the same unique mistakes. Those\npages appeared to be operated by the same threat actor, and they revealed an ongoing\nwidespread operation that has been after Libyans and people who are interested in\nLibya’s politics for years\n\n\n-----\n\nBy looking up the unique\nmistakes, we were able to find\nmore than 30 Facebook pages\nthat have been spreading\nmalicious links since at least\n2014. Some of those pages\nare extremely popular, have\nbeen active for many years,\nand are followed by more than\n100K users. Below are the five\nmost popular Facebook pages\nthat used in this attack, and\nthe amount of followers each\none has:\n\nLooking at the activity over the years, it seems that the threat actor gained access to\nsome of the pages after they were created and operated by the original owners for a\nwhile (perhaps by compromising a device belonging to one of the administrators).\n\nThe pages deal with different topics but the one thing they have in common is the target\naudience that they seem to be after: Libyans. Some of the pages impersonate important\nLibyan figures and leaders, others are supportive of certain political campaigns or\nmilitary operations in the country, and the majority are news pages from cities such as\nTripoli or Benghazi.\n\nIn total, there are more than 40 unique malicious links used by the attacker over the\nyears, which were shared in those pages. When visualizing the connections between the\npages and the URLs used in different phases of this operation, we found that the\nmalicious activity was highly intertwined as many of the links were spread by more than\none page:\n\n\n-----\n\n**Successful Targeting**\n\nSince the attacker used URL shortening services (bit.ly, goo.gl, tinyurl, etc.), we could tell\nhow many people exactly clicked on each link. In certain cases, we were even able to\nsee which country those users came from, and which environment they used. The\nmajority of the URLs had thousands of clicks, mostly around the time they were created\nand shared:\n\n\n-----\n\nThe referrers to these URLs are mainly domains that belong to Facebook, which can\nindicate that the social network is the most common infection vector used in this attack:\n\nAlthough a click does not mean a successful infection, it did support our suspicion\nregarding the targeting of this campaign and confirmed that most of the affected users\nwere indeed from Libya; however, there were victims from Europe, the U.S. and Canada\nas well. The following screenshot shows the statistics from one link which was clicked\napproximately 6,500 times, 5,120 out of which came from Libya:\n\n**Libyan Politics 101**\n\nTo engage the followers and not arouse their suspicion by sharing malicious links only,\nthe pages would also publish updates about the most recent events in Libya. Similarly to\nthe malicious URLs, the same posts would also be copied across multiple pages on the\nsame day:\n\n\n-----\n\nConsidering the fragile state of Libya, this makes those news an efficient bait for people\ninterested in keeping up with the latest updates in the country. There are ongoing\nconflicts between the forces led by Khalifa Haftar (Libyan National Army), and the\nelected government backed by the United Nations. These conflicts have even resulted in\nHaftar leading an attack on the capital city in April.\n\nThis might explain why the threat actor chooses those themes and social engineering\ntricks to easily persuade users into clicking the URLs and running the files.\n\nDespite this, there does not seem to be a hidden propaganda behind this activity, as the\nattacker does not appear to favor one political party over another. For example, one of\nthe involved pages supports Libya’s Prime Minister Fayez al-Serraj, who is considered to\nbe Khalifa Haftar’s opponent.\n\nFunnily enough, one of the pages whose name is “We All Stand with Major General\n**Khalifa Haftar” shared a post calling Haftar a criminal:**\n\n\n-----\n\nIn general, the content has a national agenda that above all cares for the greater good of\nLibya and warns against external or internal threats.\n\nThere were some exceptions to the political themes in the posts, although they still used\nthe victims’ common areas of interest. Back in 2018, one of the mobile RATs\nmasqueraded as an application that allows its users to watch the FIFA World Cup\nmatches for free. In another instance, an application offered VPN services that would\nhelp access any blocked sites in the country: (The downloaded apps were variants of the\nSpyNote RAT)\n\nAll in all, this suggests that\nthe threat actor behind this\nleveraged their knowledge of\nthe target audience, and was\nfamiliar with what the Libyan\nvictims are likely to click or\ndownload, enabling them to\nspread the files using simple\nyet effective methods.\n\n**Compromised Websites**\n\nAlthough most of the\nmalicious files were stored in\nservices such as Google\nDrive, in some cases the\nattacker managed to\ncompromise legitimate\nwebsites and host malicious\nfiles on them. This included a\nRussian website, an Israeli website, and a Moroccan news website:\n\n\n-----\n\nThe most interesting one was perhaps the website belonging to Libyana, one of the\nlargest mobile operators in Libya:\n\n\n-----\n\nThis major company was compromised, and its website hosted a RAR archive back in\n2014. This archive was advertised on some pages as a credit package given away for\nfree by the mobile operator, but actually contained a malicious .NET executable:\n\n**Tracking down the Attacker**\n\nAll of the applications and VBE\nscripts shared by the initial page\nwe investigated communicated\nwith the same command and\ncontrol server:\ndrpc.duckdns[.]org.\n\n\n-----\n\nAt a certain point, the domain resolved to an IP address that was associated with\nanother website: libya-10[.]com[.]ly. This domain was also used as a C&C in some of the\nmalicious files distributed back in 2017.\n\nThe WHOIS information of\nthis website shows that it was\nregistered using the e-mail\naddress\ndrpc1070@gmail[.]com,\nwhich was associated with\nother domains:\n\n“Dexter Ly”, which is used in two of the registered domains above, is the attacker’s\ncurrent avatar. Looking it up online led us to a Facebook account under that name that\nbelongs to the attacker, who appears to be of Libyan origin:\n\n\n-----\n\nThis account repeated the same typos that we have observed in the involved pages,\nenabling us to assess with high confidence that this is the same person that wrote the\nposts’ content. The account also openly shared almost every aspect of this malicious\nactivity, including screenshots from the panels where the victims were managed:\n\nThe attacker shared sensitive information they were able to get their hands on from\ninfecting victims. This included secret documents belonging to Libya’s government,\nexchanged e-mails, phone numbers belonging to officials and even pictures of the\nofficials’ passports:\n\n\n-----\n\nA link in one of the posts led to the attacker’s website defacement history starting from\n2013, showing that the attacker participated in operations such as OpSyria. Looking at\nthose records, we can see that the “Dr.Pc” avatar (which appears in the new C&C and\nWHOIS information) was used back then instead of “Dexter Ly”:\n\n**Conclusion**\n\nBy mapping this activity we were able to trace several seemingly unrelated Facebook\npages that are followed by thousands of users and find the attacker abusing them to\nspread malware. We were also able to observe the evolution of this attacker from the\nearly days of defacing websites to being able to run a more sophisticated operation.\n\nAlthough the set of tools which the attacker utilized is not advanced nor impressive per\nse, the use of tailored content, legitimate websites and highly active pages with many\nfollowers made it much easier to potentially infect thousands of victims. The sensitive\n\n\n-----\n\nmaterial shared in the Dexter Ly profile implies that the attacker has managed to infect\nhigh profile officials as well.\n\nAlthough the attacker does not endorse a political party or any of the conflicting sides in\nLibya, their actions do seem to be motivated by political events. This can be implied from\nthe participation in operations like OpSyria years ago, as well as the willingness to\nexpose secret documents and personal information stolen from the Libyan government.\nThis is juxtaposed with the constant targeting of Libyan victims but might mean that the\nattacker is after certain individuals within the larger crowd.\n\nCheck Point’s [Threat Emulation,](https://www.checkpoint.com/products/threat-emulation-sandboxing/) [SandBlast Agent,](https://www.checkpoint.com/products/advanced-endpoint-protection/) [SandBlast Mobile,](https://www.checkpoint.com/products/mobile-security/) [IPS and AB/AV](https://www.checkpoint.com/products/ips-software-blade/)\nprotect against Operation Tripoli. For more information, please visit [CheckPoint.com](https://www.checkpoint.com/)\n\n**Indicators of Compromise**\n\ndrpc.duckdns[.]org\n\nlibya-10[.]com[.]ly\n\nkalifhaftar[.]blogspot[.]com\n\nlibyanews111[.]blogspot[.]com\n\ngoo[.]gl/wBSkdh\n\ngoo[.]gl/kTxPjR\n\ngoo[.]gl/RQCdYS\n\ngoo[.]gl/nGWjRb\n\ngoo[.]gl/7dJWTD\n\ngoo[.]gl/nEvL9B\n\ngoo[.]gl/yMaSa2\n\ngoo[.]gl/so0ZQv\n\ngoo[.]gl/ssg3F5\n\ngoo[.]gl/ieUZJH\n\nbit[.]ly/1LVdtNP\n\nbit[.]ly/2cQBSxE\n\nbit[.]ly/1MzGMq8\n\nbit[.]ly/2tzu4Gb\n\nbit[.]ly/2sudDeR\n\n\n-----\n\nbit[.]ly/2r4Zw0D\n\nbit[.]ly/2oDyR9W\n\nbit[.]ly/2namqlt\n\nbit[.]ly/2nLTmO6\n\nbit[.]ly/2jlUZUV\n\nbit[.]ly/2oN3DOT\n\nbit[.]ly/2k0cR8i\n\nbit[.]ly/2o0q7dW\n\nbit[.]ly/2lJlu2Q\n\nbit[.]ly/2aJIf6W\n\nbit[.]ly/2s9NYaw\n\nbit[.]ly/2D5KRaV\n\nbit[.]ly/2nRVtA6\n\nbit[.]ly/2ZbTVEo\n\nbit[.]ly/2uZwNew\n\nbit[.]ly/2UwHoNf\n\nbit[.]ly/2UaG913\n\nbit[.]ly/2VDLT4X\n\nbit[.]ly/2I3JxJL\n\nbit[.]ly/2U86NYk\n\nbit[.]ly/2G7ji2Z\n\ncutt[.]us/88D9S\n\ntinyurl[.]com/jdndrea\n\naarasid[.]com/libya/index.html\n\nsirtggp[.]com/libyanew/index.html\n\nclientstats[.]epss[.]org[.]ly/E-Care\n\nlibyana[.]ly/libyana.rar\n\n\n-----\n\n76d14a79e2be1543ab79873e7b87f0deee8aad17\n21f9a82d04fdf3b6c58ac470d970d43ba6e567bd\n05aba51baa275677f637cecc2a615b65ba940291\n43fe796c59d9904a8a12f91588e53e931bcc2690\nea273ac505505ebbc2cba716922ad9bcec385aa8\n2e18ec1c14381d97b9202e20f5962189cec49d8e\nf0e1e62bed46a85ede82423fab40f6c2bc71de21\n07f1b0a4a47726bf853793adf3d02b8d1b341f30\nedd1df11ba59cc15f5b7fceb845097fa308baf93\n3a5f33dea709de482e477ffdacda60c6b36002df\n26e52120f02de03da00a39329bfa311dc22aeab8\n3aada37272e2f2d900d95bc1b0ee5ce8634e90ae\n587711daaced49c3613f93b87a910c09f89b4595\n02c6d99c677ffa78a7deff7405c0800fe780e2d3\na85dfa2f781c248be2046424a3c7e329af370e26\n0ea9c9be1cebb6542619dd69732689beacf1a262\naee4156d4871f4bd9188076f6e20dafede5fb6ac\n7c0ae04b61e4ac9c6713769594e1d1d49b27631b\n096ef1ef526265e80fb41d45344469a30a83c67b\n4bd4db3281c0e95983efe26261db1eb49bf59ba7\n9193ba6c5674de1d5f1412231aab7766ebea7f98\n0cdca63826c515720f0fb994437dd9a056a90dfa\n7a4303a775a0b13af53e13dc640589bc9f129117\n3bafa8a27e7309c1cf4b53a30d14b27aa9eb943e\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.07.01.Operation_Tripoli/Operation%20Tripoli%20.pdf"
    ],
    "report_names": [
        "Operation Tripoli "
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1562082464,
    "ts_modification_date": 1562082464,
    "files": {
        "pdf": "https://archive.orkl.eu/af54e77fd3be3089a4cb100c87b57243eeb33c5c.pdf",
        "text": "https://archive.orkl.eu/af54e77fd3be3089a4cb100c87b57243eeb33c5c.txt",
        "img": "https://archive.orkl.eu/af54e77fd3be3089a4cb100c87b57243eeb33c5c.jpg"
    }
}