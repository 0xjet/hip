{
    "id": "ff5435ec-e79a-4a3f-b6b7-4199c247ac2d",
    "created_at": "2022-10-25T16:48:23.78217Z",
    "updated_at": "2025-03-27T02:16:37.243146Z",
    "deleted_at": null,
    "sha1_hash": "5e759d952b6255cad781503243d2dc75cba479f9",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-03-23T16:58:39Z",
    "file_modification_date": "2018-03-23T16:58:39Z",
    "file_size": 1481646,
    "plain_text": "Mar 23, 2018\n\n### Targeted Attacks on South Korean Organizations\n\nAttacks Using Local Word Processor\n\nSep 2016 - Dec 2017\n\nAnalysis Research Team, AhnLab Security Emergency Response Center (ASEC)\n\n220, Pangyoyeok-ro, Bundang-gu, Seongnam-si, Gyeonggi-do, Republic of Korea, 13493 | Tel: +82 (0)31-722-8000 |\nFax: +82 (0)31-722-8901 | http://global.ahnlab.com\n\n© AhnLab, Inc. All rights reserved\n\n\n-----\n\nTargeted Attacks on South Korean Organizations\n\n## Contents\n\n#### Summary ........................................................................................................................................ 3\n\n Overview ......................................................................................................................................... 4\n\n Attack Methods ............................................................................................................................... 4\n\n Types of Malicious Hangul Files ...................................................................................................... 4\n\n Vulnerabilities .............................................................................................................................. 5\n\n JavaScript ................................................................................................................................... 5\n\n Encapsulated PostScript (EPS) ................................................................................................... 6\n\n Embedded Objects ...................................................................................................................... 6\n\n Status of malicious Hangul document files ...................................................................................... 7\n\n Change in Malware Source Codes Used in Hangul Document File Attacks .................................. 10\n\n Attack groups ................................................................................................................................ 10\n\n Group A - Red Eyes .................................................................................................................. 10\n\n Group B ..................................................................................................................................... 12\n\n Group C..................................................................................................................................... 13\n\n Other ......................................................................................................................................... 15\n\n Response and Prevention ............................................................................................................. 16\n\n Reference ..................................................................................................................................... 16\n\n\n-----\n\nTargeted Attacks on South Korean Organizations\n\n# Summary\n\nHangul (also known as Hangul Word Processor or HWP) is a proprietary word processing application published by\nthe South Korean company Hancom Inc.. Hangul's specialized support for the Korean written language has gained\nits widespread use in South Korea, especially by the government. Malicious attackers targeting Korea are now\nusing Hangul files.\n\nThis report is based on AhnLab’s analysis malicious Hangul files found over 16 months, from September 2016 to\nDecember 2017, and found the target of attack to be mainly employees of North Korea related businesses and\nvirtual currency related business.\n\nThe attack methods using Hangul files came in many forms: exploiting different vulnerabilities, JavaScripts,\nEncapsulated PostScripts (EPS), and embedded objects. Current attacks mainly use the EPS method.\n\nAhnLab analyzed the problem classifying the attack groups by attack target, attack method, and malware. The\nattackers can be divided into three groups, and two of the three groups are actively using Hangul files as a delivery\nmechanism.\n\nIn the past, the attacks using Hangul files created and executed a backdoor, which exploited a Hangul vulnerability\non the user's computer. However, attacks found after September 2016 are mainly executed in the memory of a\ncomputer. This seems to be a technique to bypass behavior-based diagnostics of security solutions, which detect\nthe creation of malware in document files.\n\nFortunately, there is no new malware exploiting Hangul’s vulnerabilities since the second half of 2016. This means\nthat the attacker is exploiting a vulnerability that has already been patched so the users can prevent attacks by\nsimply conducting the latest Hangul security update. This, however, does not apply to the embedded object type of\nmalware found in Hangul files.\n\n\n-----\n\nTargeted Attacks on South Korean Organizations\n\n# Overview\n\nHangul (also known as Hangul Word Processor or HWP) is a proprietary word processing application published by\nthe South Korean company Hancom Inc.. Hangul's specialized support for the Korean written language has gained\nits widespread use in South Korea, especially by the government and schools. Thus the attackers using Hangul as\na method are those wishing to target Korean governmental institutions. AhnLab has analyzed the malicious Hangul\nfiles found from September 2016 to December 2017 and summarized the attack targets, attack method, and the\nattack groups.\n\n# Attack Methods\n\nThe most common attack method is via email. An attacker creates an email masquerading as content that\nwould interest the chosen target and induces the target to open the Hangul files containing malware.\n\nEither an attacker can use the method of sending an email attachment or the attacker can alternately attempt to\ndeliver the malware by adding a download URL in the email.\n\n[Figure 1] Hangul file link mail\n\n# Types of Malicious Hangul Files\n\nHangul file attacks use methods such as vulnerability exploitation, scripts, Encapsulated PostScript (EPS), and\nembedded objects, which will be discussed in details below.\n\n\n-----\n\nTargeted Attacks on South Korean Organizations\n\nAn attacker may use other executable files, such as EXE and LNK files disguised as HWP files. However, though\nwidely used, it is not considered an actual Hangul file attack.\n\n[Figure 2] LNK file disguised as a Hangul file\n\n### Vulnerabilities\n\nAn attacker arbitrarily modifies the content of a document to execute malware via an abnormal behavior. Attack\nmethods exploiting this vulnerability are not easy to detect. Moreover, the compatibility of the files are greatly affected\nby the Hangul software version so sometimes the document takes a while to open or the document may not even\nbe able to be opened at all. Fortunately, no new vulnerabilities have been found in Hangul since the fall of 2016.\n\n### JavaScript\n\nHancom Office supports JavaScript and many malware are written in JavaScript. Normally, documents containing\nscripts ask for user confirmation before running the script. However, a vulnerability in which a script starts without\nuser notification was found in a 2007 version of Hangul.\n\n[Figure 3] Malicious Hangul files containing JavaScript\n\nThe file contains data corresponding to a Windows executable file in JavaScript and uses it to create Windows\nexecutable files.\n\n\n-----\n\nTargeted Attacks on South Korean Organizations\n\n[Figure 4] Malicious JavaScript\n\n### Encapsulated PostScript (EPS)\n\nEncapsulated PostScript (EPS) is a script that processes Adobe images. After the vulnerability exploiting EPS\n(CVE-2015-2545) was found in 2015, the first malicious Hangul files written in EPS appeared in September 2016\nand were found continuously until January 2018.\n\n[Figure 5] Examples of attacks using EPS scripts\n\nCurrently malicious scripts written in EPS cannot run in Hangul with the latest security update. However, attacks\nusing this vulnerability will continue until a new vulnerability is found. Therefore, users must apply the latest security\nupdates to avoid damage from EPS scripted attacks.\n\n### Embedded Objects\n\nObject embedding itself is not a vulnerability but it is a way to attach executable codes in a document and then\ninduce a user to click and execute it.\n\nIt can be used by attackers to disguise malware in the form of an annex within the document.\n\n\n-----\n\nTargeted Attacks on South Korean Organizations\n\nThere is also a type of document that uses an image of a notification window as seem in Figure 6. When the user\nclicks the \"OK\" button to close the window, the inserted malware is executes.\n\n[Figure 6] Malicious Hangul document disguised as a notification window\n\nAmong the embedded objects, the executable file asks the user whether to run it. You can see the path where the\nfile is saved through the notification window as in Figure 7.\n\n[Figure 7] A pop-up when running an executable file with an inserted object\n\n# Status of malicious Hangul document files\n\nA total of 135 malicious Hangul document files were collected over 16 months from September 2016 to December\n2017 by AhnLab. The monthly statistics for this data is as shown in [Table 1].\n\n\n-----\n\nTargeted Attacks on South Korean Organizations\n\n[Table 1] Number of malicious Hangul document files detected by month\n\nThe percentages of attacks by their various types were 75% EPS, 14% vulnerability exploitation, 7% object\nembedding, and scripts came in at 4%. EPS was the most used method.\n\n[Figure 8] Ratio of attack methods using malicious Hangul files\n\nAnd the collected information by category were 18% on general information (on products, security, announcements,\nand speech) ,17% on North Korea, 17% on virtual money, 14% on finance, and 8% on resumes.\n\n\n-----\n\nTargeted Attacks on South Korean Organizations\n\n[Figure 9] Ratio of content of malicious Hangul files\n\nIt seems like the attacker is targeting individuals working on things related to North Korea (North Korean defectors,\nNorth Korean human rights activists, North Korean researchers, journalists, etc.).\n\nAhnLab analyzed the content of malicious Hangul document files, attack techniques, and malware source codes to\nfind the following information. First, the attackers can be divided into three groups (A, B, and C) where Group A\n(26%) and Group B (48%) were responsible for 74% of the attacks, comprising most of the attacks. Other than the\nthree groups, 25% of the attacks are unclassified, meaning that there could be more attack groups revealed upon\nlater analysis.\n\n[Figure 13] Ratio to attack groups using malicious Hangul files\n\n\n-----\n\nTargeted Attacks on South Korean Organizations\n\n# Change in Malware Source Codes\n\nThe malware that exploits Hangul document files are generally 'downloaders' that download other malware and\n'backdoors' that allow remote control.\n\nThe most common form is the downloader. The downloader downloads malware from a specific address. If files\ncan be downloaded from a specific address, it is even possible to replace the old malware with new malware. It can\nalso include a backdoor that can remotely manipulate the contents of an infected computer.\n\nIn the past, it was common to create and run a backdoor on a user's computer using a vulnerability in Hangul.\nHowever, most malware found since September 2016 runs only in the computer’s memory. This seems to be a\ntechnique to bypass behavior-based diagnostics of security solutions which detect the pattern of malware in\ndocument files.\n\nWe have also found cases where files were created, but only executed when Hangul was running.\n\n# Attack groups\n\nIn 2017, there were at least three groups using Hangul files for attacks -note that classification of attack groups can\nbe divided or merged depending on the development of any new leads. Among them, the attack targets of the two\ngroups that actively used Hangul files for attack were clear.\n\n### Group A - Red Eyes\n\nGroup A is also known as Red Eyes, Group 123, ScarCurf, APT37, Reaper, and Ricochet Chollima. From the\nanalysis results, it was deemed that the main target of this group are individuals working in the fields related to North\nKorea, such as North Korean defectors, North Korean human rights activists, North Korean researchers, and\njournalists. In addition, documents related to the military were included in attack cases.\n\nThe names of the malicious Hangul file used in this attack group are as follows:\n\n\n-----\n\nTargeted Attacks on South Korean Organizations\n\n[Table 2] Malicious Hangul document file names used in attacks by Group A\n\nThis group created malware using the first EPS in September 2016.\n\nThe Hangul document, disguised as a North Korean New Year Address for January 2017, is in the form of an\nembedded object. Information about malware creators can be gained using the document. For example, looking at\nthe file path ‘C:\\Users\\pad-2\\AppData\\Local\\Temp\\Hwp (3).exe’ for object insertion, we can find that the name of the\nmalware creator is pad-2. In particular, looking at the strings such as\n‘\\\\192.168.100.22\\saggazi\\Happy\\Work\\2016.8~2016.8.10~’, we can find the Korean word 'saggazi,' indicating that\nthe creator may be Korean or someone familiar with Korean. We are tracking malware produced by the same group\nthrough related strings.\n\n[Figure 14] Malware maker information contained in a malicious Hangul document file\n\nIn late October 2017, the same group used Microsoft Word's Dynamic Data Exchange (DDE) document file for an\nattack.\n\nIn April 2017, this attack group released a Hangul file with a malware to destroy hard disks. When the malware is\nexecuted, it destroys the content of the hard disk, reboots, and displays only a message that reads 'Are you Happy?'.\n\n\n-----\n\nTargeted Attacks on South Korean Organizations\n\n[Figure 15] Booting screen after hard disk destruction\n\nMalware of this attack group contains a character string that is a typical program database (PDB) file format. Through this PDB-\nrelated string, we can guess the attacker's malware version and malware type.\n\n[Figure 16] PDB contents by version\n\nThis attack group was known for an attack using a zero-day flash file at the end of January 2018. They are a\nnew group in the center of attention since a report was published on the group in February 2018.\n\n### Group B \n\nGroup B is believed to be the group associated with the 2014 Sony Pictures hacking. Since 2014, this group has\nattacked defense industries and large corporations in Korea, and is focused on attacking virtual money exchanges\nand virtual currency-related laboratories in 2017. It impersonated a financial committee as well as an attorney\ngeneral, etc., and disguised important files as the preparatory documents of a tax investigation, transactions of\nsuspected corporate body, and other content relevant to an investigation.\n\n\n-----\n\nTargeted Attacks on South Korean Organizations\n\n[Table 3] Malicious document file names used in the attacks of Group B\n\nThis group mainly used EPS, but the scripting method is quite different compared to Group A.\n\n[Figure 17] Malicious EPS used by Group B\n\n### Group C\n\nIn Group C, only the Hangul file in an object embedded type was found in June of 2017. However, analysis of the\nembedded executable file shows that there are more than 40 variants and that they have been active since July\n2015.\n\nMalware is embedded as an object in the Hangul document file, and when the user clicks it, the downloader runs\nand downloads additional malware from http://endlesspaws.com/sitemap.tar.gz. At the same time, it downloads the\n\n\n-----\n\nTargeted Attacks on South Korean Organizations\n\nnormal Hangul file from http://endlesspaws.com/dump.sql and displays the contents of the \"annex.hwp\" file so that\nthe user does not know about the malware infection.\n\n[Figure 17] is the downloaded 'annex.hwp', which contains the content from a North Korean human rights civilian\norganization activity support project.\n\nAlso, the object embedded Hangul file shows that the user name of the malware maker is 'easy.’\n\n[Figure 18] Information of the maker in a malicious Hangul document file\n\nAfter the analysis of the downloader variants, the name of the Hangul file to download is shown in [Table 4].\n\n[Table 4] Names of download files used for attack by Group C\n\nApproximately 25 backdoor variants downloaded by the downloader have been identified and were first found\nin July 2015. The file names of the backdoors are shown in [Table 5].\n\n[Table 5] Names of backdoor file used for attack by Group C\n\nGroup C uses Mutex as a downloader and a backdoor as shown in [Table 6].\n\n\n-----\n\nTargeted Attacks on South Korean Organizations\n\n[Table 6] Mutex used in malware in Group C attacks\n\nThe target of the attack is identified as a North Korean human rights group for now. However, we cannot identify\nspecific attack targets as we could not check other Hangul files. Group C seems to be different from Group A\nso far, but if the main target of this group is North Korea related workers, association with Group A cannot be\nexcluded.\n\n### Other \n\nIn November 2017, a Hangul file contained Ursnif, a financial information hijacking malware, was also found.\n\nFor documents containing Ursnif variants, the username was the name of a famous Korean company, and the path\nto the object was C:\\Users\\User Name\\Desktop\\DuranDuran\\Sample\\patch39.exe.\n\n**[Figure 19] File path**\n\n\n-----\n\nTargeted Attacks on South Korean Organizations\n\n# Response and Prevention\n\nAhnLab’s world recognized anti-malware solution V3 diagnoses Hangul malware. The aliases identified by\nAhnLab V3 are as below:\n\nEPS/Cve-2015-2545 (2016.11.30.00)\nEPS/Dropper.Gen (2017.06.15.00)\nEPS/Exploit (2017.11.23.00)\nHWP/Cve-2015-2545 (2016.01.07.00)\nHWP/Dropper (2017.01.04.00)\nHWP/Exploit (2015.08.01.00)\nHWP/Exploit-PT.Gen (2010.09.29.00)\nHWP/Malinker (2017.06.10.00)\n\nIn the viewpoint of attackers targeting Korean users, Hangul files are truly appealing. Therefore, users should apply\nthe latest update in order to avoid damages. In addition, when opening a Hangul document, users should be careful\nabout the executable files that are embedded inside, such as links, images, movies, and documents. Attackers have\nbeen exploiting various methods of attack over the past decade. Fortunately, there is no new vulnerability to exploit\nand use to attack by modifying a Hangul document file. However, attacks aiming domestic users such as Hangul\nattacks will steadily continue.\n\n# Reference\n\n[1] Korean MalDoc Drops Evil New Years Presents (http://blog.talosintelligence.com/2017/02/korean-maldoc.html)\n\n[2] Introducing ROKRAT (http://blog.talosintelligence.com/2017/04/introducing-rokrat.html)\n\n[3] ROKRAT Reloaded (http://blog.talosintelligence.com/2017/11/ROKRAT-Reloaded.html)\n\n[4] Korea In The Crosshairs (http://blog.talosintelligence.com/2018/01/korea-in-crosshairs.html)\n\n[5] Flash 0-Day In The Wild: Group 123 At The Controls (http://blog.talosintelligence.com/2018/02/group-123-goes-\nwild.html)\n\n[6] APT37 (Reaper): The Overlooked North Korean Actor (https://www.fireeye.com/blog/threat-\nresearch/2018/02/apt37-overlooked-north-korean-actor.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.03.23.Targeted_Attacks_on_South_Korean_Organizations/Tech_Report_Malicious_Hancom.pdf"
    ],
    "report_names": [
        "Tech_Report_Malicious_Hancom"
    ],
    "threat_actors": [
        {
            "id": "bbe36874-34b7-4bfb-b38b-84a00b07042e",
            "created_at": "2022-10-25T15:50:23.375277Z",
            "updated_at": "2025-03-27T02:00:55.457787Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "APT37",
                "InkySquid",
                "ScarCruft",
                "Group123",
                "TEMP.Reaper",
                "Ricochet Chollima"
            ],
            "source_name": "MITRE:APT37",
            "tools": [
                "BLUELIGHT",
                "CORALDECK",
                "KARAE",
                "SLOWDRIFT",
                "ROKRAT",
                "SHUTTERSPEED",
                "POORAIM",
                "HAPPYWORK",
                "Final1stspy",
                "Cobalt Strike",
                "NavRAT",
                "DOGCALL",
                "WINERACK"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "552ff939-52c3-421b-b6c9-749cbc21a794",
            "created_at": "2023-01-06T13:46:38.742547Z",
            "updated_at": "2025-03-27T02:00:02.906537Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "ScarCruft",
                "Venus 121",
                "Moldy Pisces",
                "Group 123",
                "APT 37",
                "Group123",
                "Operation Daybreak",
                "Operation Erebus",
                "Red Eyes",
                "TA-RedAnt",
                "InkySquid",
                "Reaper Group",
                "Ricochet Chollima",
                "ATK4",
                "G0067"
            ],
            "source_name": "MISPGALAXY:APT37",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041797,
    "ts_creation_date": 1521824319,
    "ts_modification_date": 1521824319,
    "files": {
        "pdf": "https://archive.orkl.eu/5e759d952b6255cad781503243d2dc75cba479f9.pdf",
        "text": "https://archive.orkl.eu/5e759d952b6255cad781503243d2dc75cba479f9.txt",
        "img": "https://archive.orkl.eu/5e759d952b6255cad781503243d2dc75cba479f9.jpg"
    }
}