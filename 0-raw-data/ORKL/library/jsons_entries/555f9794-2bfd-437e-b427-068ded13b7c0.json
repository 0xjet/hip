{
    "id": "555f9794-2bfd-437e-b427-068ded13b7c0",
    "created_at": "2023-01-12T14:59:02.150714Z",
    "updated_at": "2025-03-27T02:13:46.786524Z",
    "deleted_at": null,
    "sha1_hash": "62b65ce8803f9d8003a577a10f664133b1c0b98e",
    "title": "2018-01-29 - VERMIN- Quasar RAT and Custom Malware Used In Ukraine",
    "authors": "",
    "file_creation_date": "2022-05-28T05:07:44Z",
    "file_modification_date": "2022-05-28T05:07:44Z",
    "file_size": 737750,
    "plain_text": "# VERMIN: Quasar RAT and Custom Malware Used In Ukraine\n\n**[researchcenter.paloaltonetworks.com/2018/01/unit42-vermin-quasar-rat-custom-malware-used-ukraine/](https://researchcenter.paloaltonetworks.com/2018/01/unit42-vermin-quasar-rat-custom-malware-used-ukraine/)**\n\nJuan Cortes, Tom Lancaster January 29, 2018\n\nBy [Juan Cortes and](https://unit42.paloaltonetworks.com/author/juan-cortes/) [Tom Lancaster](https://unit42.paloaltonetworks.com/author/tom-lancaster/)\n\nJanuary 29, 2018 at 5:00 AM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [AutoFocus,](https://unit42.paloaltonetworks.com/tag/autofocus/) [ConfuserEx,](https://unit42.paloaltonetworks.com/tag/confuserex/) [Espionage,](https://unit42.paloaltonetworks.com/tag/espionage/) [Quasar,](https://unit42.paloaltonetworks.com/tag/quasar/) [Quasar RAT,](https://unit42.paloaltonetworks.com/tag/quasar-rat/) [Ukraine,](https://unit42.paloaltonetworks.com/tag/ukraine/) [VERMIN](https://unit42.paloaltonetworks.com/tag/vermin/)\n\nSummary\n\nPalo Alto Networks Unit 42 has discovered a new malware family written using the Microsoft .NET Framework which the authors call\n\"VERMIN\"; an ironic term for a RAT (Remote Access Tool). Cursory investigation into the malware showed the attackers not only had flair for\nmalware naming, but also for choosing interesting targets for their malware: nearly all the targeting we were able to uncover related to activity\nin Ukraine.\n\nPivoting further on the initial samples we discovered, and their infrastructure, revealed a modestly sized campaign going back to late 2015\n[using both Quasar RAT and VERMIN.](https://github.com/quasar/QuasarRAT)\n\nThis blog shows the links between the activity observed, a walkthrough of the analysis of the VERMIN malware, and IOCs for all activity\ndiscovered.\n\nIt all began with a tweet\n\n[Our initial interest was piqued through a tweet from a fellow researcher who had identified some malware with an interesting theme relating to](https://twitter.com/blu3_team/status/917050823724732419)\nthe Ukrainian Ministry of Defense as a lure.\n\n_Figure 1 – The decoy document displayed to users when executing the initial malware sample_\n\n\n-----\n\nThe sample was an SFX exe which displayed a decoy document to users before continuing to execute the malware; the hash of the file is\ngiven below.\n\nSHA256 31a1419d9121f55859ecf2d01f07da38bd37bb11d0ed9544a35d5d69472c358e\n\n[The malware was notable for its rare use of HTTP encapsulated SOAP, an XML based protocol used for exchanging structured information, for](https://en.wikipedia.org/wiki/SOAP)\ncommand and control (C2), which is something not often seen in malware samples. Using AutoFocus, we were quickly able to find similar\nsamples, by pivoting on the artifacts the malware created during a sandbox run, resulting in 7 other samples as shown in Figure 2.\n\n_Figure 2 – Pivoting in AutoFocus makes it easy to find similar malware samples._\n\nUsing the [Maltego for AutoFocus transforms, we were then able to take the newly discovered samples and look at the C2 infrastructure in an](https://live.paloaltonetworks.com/t5/Maltego-for-AutoFocus/ct-p/AutoFocus_Maltego)\nattempt to see if we could link the samples together and in turn see if these C2’s were contacted by malware. We quickly built up a picture of a\ncampaign spanning just over 2 years with a modest C2 infrastructure:\n\n_Figure 3 – Further analysis using AutoFocus & other data sources allows us to link up the activity discovered so far._\n\nThe malware samples we discovered fell largely into two buckets: Quasar Rat and VERMIN. Quasar RAT is an open-source malware family\n[which has been used in several other attack campaigns including criminal and](https://community.rsa.com/community/products/netwitness/blog/2017/10/02/malspam-delivers-rat-spyware-quasar-9-27-2017) [espionage motivated attacks. But a reasonable number of the](https://blog.paloaltonetworks.com/2017/01/unit42-downeks-and-quasar-rat-used-in-recent-targeted-attacks-against-governments/)\nsamples were the new malware family, VERMIN. Looking at the samples in our cluster we could see the themes of the dropper files were\nsimilar to our first sample. Notably, most of the other files we discovered did not come bundled with a decoy document and instead were simply\nthe malware and dropper compiled with icons matching popular document viewing tools, such as Microsoft Word. Names of some of the other\ndropper binaries observed are given below, with the original Ukrainian on the left and the translated English (via Google) on the right:\n\n**Original Name (Ukrainian)** **Translated Name (if applicable)**\n\nВаш_ сертиф_кати для отримання безоплатно_ вторинно_ допомоги.exe Your certificate for free_receive help.exe\n\n\n-----\n\nдоповідь2.exe report2.exe\n\nдоповідь забезпечення паливом 08.06.17.exe fuel supply report 08.06.17.exe\n\n\nlg_svet_smeta2016-2017cod.exe.\n\nlugansk_2273_21.04.2017.exe\n\n\nN/A\n\nN/A\n\n\nОтчет-районы_2кв-л-2016.exe Report-areas_2kv-l-2016.exe\n\nGiven the interesting targeting themes and the discovery of a new malware family, we decided to take a peek at what “VERMIN” was capable\nof and document it here.\n\nDissecting VERMIN\n\nFor this walkthrough, we’ll be going through the analysis of the following sample:\n\nSHA256 98073a58101dda103ea03bbd4b3554491d227f52ec01c245c3782e63c0fdbc07\n\nCompile Timestamp 2017-07-04 12:46:43 UTC\n\nAnalyzing the malware dynamically quickly gave us a name for the malware, based on the PDB string present in the memory of the sample:\n\nZ:\\Projects\\Vermin\\TaskScheduler\\obj\\Release\\Licenser.pdb\n\nAs is the case with many of the samples from the threat actors behind VERMIN, our sample is packed initially with the popular .NET\n[obfuscation tool ConfuserEx. Using a combination of tools, we were able to unpack and deobfuscate the malware.](https://yck1509.github.io/ConfuserEx/)\n\n[Following initial execution, the malware first checks if the installed input language in the system is equal to any of the following:](https://technet.microsoft.com/en-us/library/cc766191(v=ws.10).aspx)\n\nru - Russian\nuk - Ukrainian\nru-ru - Russian\nuk-ua - Ukrainian\n\n[If none of the languages above is found the malware calls “Application.Exit()”, however despite its name, this API call doesn’t actually](https://msdn.microsoft.com/en-us/library/ms157894(v=vs.110).aspx)\nsuccessfully terminate the application, and instead the malware will continue to run. It’s likely the author intended to terminate the application,\nin which case a call like “System.Environment.Exit()” would have been a better choice. The fact that this functionality does not work as\nintended suggests that if author tested the malware before deployment, they were likely to be doing so on systems where the language\nmatches the list above, since otherwise they would notice that the function is not working as expected.\n\nAfter passing the installed language check the malware proceeds to decrypt an embedded resource using the following logic:\n\nIt retrieves the final four bytes of the encrypted resource.\nThese four bytes are a CRC32 sum, and the malware then proceeds to brute force what 6-byte values will give this CRC32 sum.\nOnce it finds this array of 6 bytes it performs an MD5 hash sum on the bytes, this value is used as the key.\nThe first 16bytes of the encrypted resource are then used as the IV for decryption\nFinally, using AES it decrypts the embedded resource.\n\nA script mirroring this routine can be found in appendix C.\n\nAfter decrypting the embedded resource, the malware passes several hardcoded arguments to the newly decrypted binary and performs a\nsimple setup routine before continuing execution. The embedded resource contains all the main code for communications and functionality the\nRAT contains.\n\nFirst the malware attempts to decrypt all of the strings passed as parameters. If no arguments were supplied the malware attempts to read a\nconfiguration file from a pre-defined location expecting it to be base64-encoded and encrypted with 3-DES using a hardcoded key\n\"KJGJH&^$f564jHFZ\":\nC:\\Users\\Admin\\AppData\\Roaming\\Microsoft\\AddIns\\settings.dat\n\nIf arguments were supplied, they are saved and encrypted to the same location as above.\n\nParameters supplied are given below. Note that these are the actual variable names used by the malware author:\n\nserverIpList\nmypath\nkeyloggerPath\nmutex\nusername\npassword\nkeyloggerTaskName\nmyTaskName\n\n\n-----\n\ny ocess a e\nkeyLoggerProcessName\nmyTaskDecription\nmyTaskAuthor\nkeyLoggerTaskDecription\nkeyLoggerTaskAuthor\n\nThe decrypted resource is set to be run as a scheduled task every 30 minutes, indefinitely.\nAfter this, the malware is ready to start operations, and does so by collecting various information about the infected machine, examples of\ncollected information includes but is not limited to:\n\nMachine name\nUsername\nOS name via WMI query\nArchitecture: x64 vs x86 (64 vs. 32 bit)\nLocal IP Address\nChecks Anti-Virus installed via WMI query\n\nIf the Anti-Virus (AV) query determines any AV is installed the malware does not install the keylogger. The keylogger is embedded as a\nresource named ‘AdobePrintFr’. This binary is only packed with Confuser-Ex and is not further obfuscated.\nThe malware then sends its initial beacon using a SOAP envelope to establish a secure connection. The author uses the WSHttpBinding() API\n\n- which allows the author to use WS-Addressing and purposely sets the WSMessageEncoding.Mtom to encode the SOAP messages. The\nauthor also sets up for using ‘Username’ authentication for communicating with its C2, presumably allowing the author easier control over the\nvarious infected hosts. A defanged exemplar request/response is given below:\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nPOST /CS HTTP/1.1\nMIME-Version: 1.0\nContent-Type: multipart/related; type=\"application/xop+xml\";start=\"<http://tempuri.org/0>\";boundary=\"uuid:ae621187-99b2-4b50-8a74-a33e8\nHost: akamainet024[.]info\nContent-Length: 1408\nExpect: 100-continue\nAccept-Encoding: gzip, deflate\nConnection: Keep-Alive\n--uuid:ae621187-99b2-4b50-8a74-a33e8c7c0990+id=3\nContent-ID: <http://tempuri.org/0>\nContent-Transfer-Encoding: 8bit\nContent-Type: application/xop+xml;charset=utf-8;type=\"application/soap+xml\"\n<s:Envelope xmlns:s=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:a=\"http://www.w3.org/2005/08/addressing\"><s:Header><a:Action\ns:mustUnderstand=\"1\">http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue</a:Action><a:MessageID>urn:uuid:159e7656-a3ea-4099-aa\n<a:Address>http://www.w3.org/2005/08/addressing/anonymous</a:Address></a:ReplyTo><a:To s:mustUnderstand=\"1\">http://akamainet024\n<t:RequestSecurityToken Context=\"uuid-9a01748a-8acf-449e-9a3d-febcff2f2406-3\" xmlns:t=\"http://schemas.xmlsoap.org/ws/2005/02/trust\">\n<t:TokenType>http://schemas.xmlsoap.org/ws/2005/02/sc/sct</t:TokenType><t:RequestType>http://schemas.xmlsoap.org/ws/2005/02/trust/Is\n<t:BinaryExchange ValueType=\" http://schemas.xmlsoap.org/ws/2005/02/trust/tlsnego\" EncodingType=\"http://docs.oasis-open.org/wss/2004/\n1.0#Base64Binary\">FgMBAFoBAABWAwFaCdyfpYsLZDbnCizlWg3iw2M80KiaWb+oIgzhJ1BvugAAGAAvADUABQAKwBPAFMAJwAoAMgA\n</t:BinaryExchange></t:RequestSecurityToken></s:Body></s:Envelope>\n--uuid:ae621187-99b2-4b50-8a74-a33e8c7c0990+id=3-\n\nVERMIN collects all keystrokes and clipboard data and encrypts the data before storing it in the following folder:\n%appdata%\\Microsoft\\Proof\\Settings.{ED7BA470-8E54-465E-825C-99712043E01C}\\Profiles\\.\nEach file is saved with the following format: \"{0:dd-MM-yyyy}.txt\". The data is encrypted using the same method and 3-DES key, used to\nencrypt the configuration file.\nVermin supports the following commands:\n\nArchiveAndSplit\nCancelDownloadFile\nCancelUploadFile\nCheckIfProcessIsRunning\nCheckIfTaskIsRunning\nCreateFolder\nDeleteFiles\nDeleteFolder\nDownloadFile\nGetMonitors\nGetProcesses\nKillProcess\nReadDirectory\nRenameFile\nRenameFolder\nRunKeyLogger\n\n\n-----\n\nSet c o u e\nShellExec\nStartAudioCapture\nStartCaptureScreen\nStopAudioCapture\nStopCaptureScreen\nUpdateBot\nUploadFile\n\nFor most of these commands, the malware requires “hands-on-keyboard” style one-to-one interactions.\nOften remote access tools written in .NET borrow and steal code from other tools due to the plethora of code available through open source;\nhowever, it appears that whilst some small segments of code may have been lifted from other tools, this RAT is not a fork of a well-known\nmalware family: it’s mostly original code.\nWe have linked all the samples we have been able to identify to the same cluster of activity: this strongly suggests the VERMIN malware is\nused exclusively by this threat actor and this threat actor alone.\n\nConcluding thoughts\nWe were unable to definitively determine the aims of the attackers or the data stolen. However, given the limited number of samples, the\ntargeting themes observed, and the “hands-on-keyboard” requirement for most of the malwares’ operations (except for keylogging), it seems\nlikely that the malware is used in targeted attacks in Ukraine.\n[Ukraine remains a ripe target for attacks, even gaining its own dedicated Wikipedia page for attacks observed in 2017. In addition to the high-](https://en.wikipedia.org/wiki/2017_cyberattacks_on_Ukraine)\nprofile attacks such as the [Petya/NotPetya and](https://www.theregister.co.uk/2017/06/28/petya_notpetya_ransomware/) [BadRabbit, which have been widely reported, there are likely many smaller campaigns like the](https://www.crowdstrike.com/blog/badrabbit-ms17-010-exploitation-part-one-leak-and-control/)\none described in this blog aimed to steal data to gain an information advantage for the attackers’ sponsors.\nPalo Alto Networks defends our customers against the samples discussed in this blog in the following ways:\n\nWildfire identifies all samples mentioned in this article as malicious.\nTraps identifies all samples mentioned in this article as malicious.\nC2 domains used in this campaign are blocked via Threat Prevention.\n\nAutoFocus customers can track samples related to this blog via the following tags:\n\n[VERMIN](https://autofocus.paloaltonetworks.com/#/tag/Unit42.VERMIN%20https://autofocus.paloaltonetworks.com/#/tag/Unit42.VERMINCampaign%20https://autofocus.paloaltonetworks.com/#/tag/Unit42.VERMIN)\n[VERMINKeylogger](https://autofocus.paloaltonetworks.com/#/tag/Unit42.VERMIN%20https://autofocus.paloaltonetworks.com/#/tag/Unit42.VERMINCampaign%20https://autofocus.paloaltonetworks.com/#/tag/Unit42.VERMINKeyLogger)\n[VERMINCampaign](https://autofocus.paloaltonetworks.com/#/tag/Unit42.VERMIN%20https://autofocus.paloaltonetworks.com/#/tag/Unit42.VERMINCampaign%20https://autofocus.paloaltonetworks.com/#/tag/Unit42.VERMINCampaign)\n\n**Appendix A – C2 Addresses**\nakamaicdn[.]ru\ncdnakamai[.]ru\nwww.akamaicdn[.]ru\nwww.akamainet066[.]info\nwww.akamainet023[.]info\nwww.akamainet021[.]info\nakamainet023[.]info\nakamainet022[.]info\nakamainet021[.]info\nwww.akamainet022[.]info\nakamainet066[.]info\nakamainet024[.]info\nwww.cdnakamai[.]ru\nnotifymail[.]ru\nwww.notifymail[.]ru\nmailukr[.]net\ntech-adobe.dyndns[.]biz\nwww.mailukr[.]net\n185.158.153[.]222\n94.158.47[.]228\n195.78.105[.]23\n94.158.46[.]251\n188.227.75[.]189\n212.116.121[.]46\n185.125.46[.]24\n5.200.53[.]181\n\n**Appendix B – Malware Samples**\n\n\n-----\n\n**sha256** **Family**\n\n0157b43eb3c20928b77f8700ad8eb279a0aa348921df074cd22ebaff01edaae6 Quasar\n\n154ef5037e5de49a6e3c48ea7221a02a5df33c34420a586cbff6a46dc5026a91 Quasar\n\n24956d8edcf2a1fd26805ec58cfd1ee7498e1a59af8cc2f4b832a7ab34948c18 Quasar\n\n250cf8b44fc3ae86b467dd3a1c261a6c3d1645a8a21addfe7f2e2241ff8b79fc Quasar\n\n4c5e019e0e55a3fe378aa339d52c235c06ecc5053625a5d54d65c4ae38c6e3da Quasar\n\n92295b38daa4e44b9d257e56c5b271bbbf6a620312dc58e48e56473427170aa1 Quasar\n\n9ea00514c4ae9519a8938924b02826cfafeb75fc70f16c422aeadb8317a146c1 Quasar\n\na3c84c5f8d981653a2a391d29f32c8127fba8f0ab7da8815330a228205c99ba6 Quasar\n\n7b08b0d4d68ebf5238eaa8a40f815b83de372e345eb22cc3d50a4bb1869db78e Quasar\n\nf75861216f5716b0227733e6a093776f693361626efebe37618935b9c6e1bdfd Quasar\n\n51b0bb172c6e5eaa8e333fbf2451ae27094991b6330025374b9082ae8cd879cf Quasar\n\n46ae101a8dc8bf434d2c599aaabfb72a0843d21e2150a6c745c0c4a771c09da3 Quasar\n\n488db27f3d619b3067d95515a356997ea8e840c65daa2799bdd473dce93362f2 Quasar\n\n5a05d2171e6aeb5edd9d39c7f46cd3bf0e2ee3ee803431a58a9945a56ce935f6 Quasar\n\n6f4e20e421451c3d8490067f8424d7efbcc5edeb82f80bb5562c76d4adfb0181 Quasar\n\n9a81cffe79057d8d307910143efd1455f956f2de2c7cc8fb07a7c17000913d59 Quasar\n\nc84afdd28fa0923a09f6dd3af1e3821cdb07862b2796fa004cd3229bc6129cbe Quasar\n\n6cf63ae829984a47aca93f8a1261afe5a06930f04fab6f86f6f7f9631fde59ec Quasar\n\naa982fe7d28bbf55865047b16334efbe3fcb6bae06e5ed9cab544f1c8d307317 Quasar\n\n2963c5eacaad13ace807edd634a4a5896cb5536f961f43afcf8c1f25c08a5eef VERMIN\n\n677edb1a0a86c8bd0df150f2d9c5c3bc1d20d255b6f7944c4adcff3c45df4851 VERMIN\n\n74ba162eef84bf13d1d79cb26192a4692c09fed57f321230ddb7668a88e3935d VERMIN\n\ne1d917769267302d58a2fd00bc49d4aee5a472227a75f9366b46ce243e9cbef7 VERMIN\n\neb48a31f8f81635d24f343a09247284149884bd713d3bc1c0b9c936bca8bafd7 VERMIN\n\n15c52b01d2b9294e2dd4d9711cde99e10f11cd188e0d1e4fa9db78f9805626c3 VERMIN\n\n31a1419d9121f55859ecf2d01f07da38bd37bb11d0ed9544a35d5d69472c358e VERMIN\n\n5586fb423aff39a02cddf5e456a83a8301afe9ed78ecbc8de2cd852bc0cd498f VERMIN\n\n5ee12dd028f5f8c2c0eb76f28c2ce273423998b36f3fc20c9e291f39825601f9 VERMIN\n\neb48a31f8f81635d24f343a09247284149884bd713d3bc1c0b9c936bca8bafd7 VERMIN\n\n98073a58101dda103ea03bbd4b3554491d227f52ec01c245c3782e63c0fdbc07 VERMIN\n\nc5647603337a4e9bfbb2259c0aec7fa9868c87ded2ab74e9d233bdb2a3bb163e VERMIN\n\neb46b8978619a72f4b0d3ea8961dde527f8e27e89701ccd6e5643c33b103d901 VERMIN\n\nabd05a20b8aa21d58ee01a02ae804a0546fbf6811d71559423b6b5afdfbe7e64 VERMIN\n\nAppendix\n\n**Appendix C – Python script to decode VERMIN resources**\n\n\n1\n2\n3\n4\n5\n\n\n#!/usr/local/bin/python\n__author__ = \"Juan C Cortes\"\n__version__ = \"1.0\"\n__email__ = \"jcortes@paloaltonetworks.com\"\nfrom random import randint\n\n\n-----\n\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n\n\np\nimport binascii\nimport sys\nimport logging\nimport hashlib\nimport argparse\nimport os\nimport struct\nfrom tabulate import tabulate\nfrom Crypto import Random\nfrom Crypto.Cipher import AES\ndef parse_arguments():\n\"\"\"Argument Parser\"\"\"\nparser = argparse.ArgumentParser(\nusage=\"Decrypt strings for VerminRAT\")\nparser.add_argument(\n\"-v\",\n\"--verbosity\",\naction=\"store_true\",\ndest=\"vverbose\",\nhelp=\"Print debugging information\")\nparser.add_argument(\n\"-o\",\n\"--output\",\ndest=\"output_file\",\ntype=str,\nhelp=\"Output results file\")\nparser.add_argument(\n\"input\",\ntype=str,\naction='store',\nhelp=\"Input file of newline separated strings or single string\")\nparser.add_argument(\n\"-b\",\n\"--blob\",\naction='store_true',\nhelp=\"Param use for decrypting blobs of data instead of strings. Blob is autosave to 'blob.out'\")\nreturn parser\ndef write_out(output_list, headers, output_file=False):\n\"\"\"\nPretty outputs list\n:param output_list: List to output\n\"\"\"\nprint tabulate(output_list, headers, tablefmt=\"simple\")\nprint \"\"\nif output_file:\nwith open(output_file, \"ab\") as file:\nfile.write(tabulate(output_list, headers, tablefmt=\"simple\"))\nfile.write(\"\\n\\n\")\ndef generateArray():\nabyte = bytearray(6)\nfor i in range(0,6):\nabyte[i] = randint(0, 0x7FFFFFFF) % 7\nreturn abyte;\ndef parseEncrypteStr(encryptStr):\ntry:\ndecoded = encryptStr.decode('base64')\nhardcoded_crc32 = decoded[-4:]\nparsedEncrypted = decoded[16:-4]\niv = decoded[:16]\nreturn hardcoded_crc32,parsedEncrypted,iv\nexcept Exception as e:\nprint e\ndef bruteForceCRC32Value(valuecrc32):\nwhile (True):\narry = generateArray()\ncrc32 = binascii.crc32(arry)\ncrc32 = crc32 % (1 << 32)\nif crc32 == valuecrc32:\nreturn(arry)\ndef decryptStr(str,key,iv):\naes = AES.new(key, AES.MODE_CBC, iv)\nblob = aes.decrypt(str)\nreturn blob\ndef parsePlainText(str):\nchar = \"\"\nfor i in str:\nif 0x20 <= ord(i) <= 0x127:\n\n\n-----\n\n85\n86\n87\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n99\n100\n101\n102\n103\n104\n105\n106\n107\n108\n109\n110\n111\n112\n113\n114\n115\n116\n117\n118\n119\n120\n121\n122\n123\n124\n125\n126\n127\n128\n129\n130\n131\n132\n133\n134\n135\n136\n137\n138\n\n\nelse:\ncontinue\nreturn char\ndef parseUnicde(str):\ntry:\nuni = \"\"\nfor i in range(0,len(str)/2):\nuni += str[i]\nreturn uni.decode('utf16')\nexcept Exception as e:\nprint e\ndef main():\n\"\"\"Main Method\"\"\"\nargs = parse_arguments().parse_args()\nstrs = []\nif args.vverbose:\nlogging.basicConfig(\nlevel=logging.DEBUG,\nformat=' %(asctime)s - %(levelname)s - %(message)s')\nif args.blob and os.path.exists(args.input) != True:\nb = args.input\ncrc32Hardcode, encryptedStr, iv = parseEncrypteStr(b)\ncrc32Hardcode = bytearray(crc32Hardcode)\ncrc32Hardcode = struct.unpack('<I', crc32Hardcode)[0]\nbruteArray = bruteForceCRC32Value(crc32Hardcode)\nm = hashlib.md5()\nm.update(bruteArray)\nkey = m.digest()\nplain = decryptStr(encryptedStr, key, iv)\nwith open('blob.out', \"wb\") as file:\nfile.write(plain)\nif os.path.exists(args.input) != True:\nstrs.append(args.input)\nelse:\nwith open(args.input, \"rb\") as open_file:\nfor line in open_file:\nhash = line.rstrip()\nstrs.append(hash)\nfor s in strs:\ncrc32Hardcode,encryptedStr,iv = parseEncrypteStr(s)\ncrc32Hardcode = bytearray(crc32Hardcode)\ncrc32Hardcode = struct.unpack('<I', crc32Hardcode)[0]\nbruteArray = bruteForceCRC32Value(crc32Hardcode)\nm = hashlib.md5()\nm.update(bruteArray)\nkey = m.digest()\nplain = decryptStr(encryptedStr,key,iv)\nparsestr = parsePlainText(plain)\nunistr = parseUnicde(plain)\nheaders = [\"ASCII\",\"UNICODE\"]\noutputlist = [[parsestr,unistr]]\nwrite_out(outputlist, headers, args.output_file)\nif __name__ == '__main__':\nmain()\n\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-01-29 - VERMIN- Quasar RAT and Custom Malware Used In Ukraine.pdf"
    ],
    "report_names": [
        "2018-01-29 - VERMIN- Quasar RAT and Custom Malware Used In Ukraine.pdf"
    ],
    "threat_actors": [
        {
            "id": "31da1b1f-743b-40ef-bd17-1e07c5500392",
            "created_at": "2024-06-19T02:00:04.382822Z",
            "updated_at": "2025-03-27T02:00:03.385309Z",
            "deleted_at": null,
            "main_name": "UAC-0020",
            "aliases": [
                "Vermin",
                "SickSync"
            ],
            "source_name": "MISPGALAXY:UAC-0020",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535542,
    "ts_updated_at": 1743041626,
    "ts_creation_date": 1653714464,
    "ts_modification_date": 1653714464,
    "files": {
        "pdf": "https://archive.orkl.eu/62b65ce8803f9d8003a577a10f664133b1c0b98e.pdf",
        "text": "https://archive.orkl.eu/62b65ce8803f9d8003a577a10f664133b1c0b98e.txt",
        "img": "https://archive.orkl.eu/62b65ce8803f9d8003a577a10f664133b1c0b98e.jpg"
    }
}