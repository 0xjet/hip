{
    "id": "16ee67cc-ddf5-4ca5-a8d2-c14224ec9e62",
    "created_at": "2022-10-25T16:48:10.372495Z",
    "updated_at": "2025-03-27T02:08:41.324441Z",
    "deleted_at": null,
    "sha1_hash": "9b66a35bea35d963d1ff07cab2a3914b38e24257",
    "title": "The Monju Incident",
    "authors": "Context",
    "file_creation_date": "2014-02-17T11:40:46Z",
    "file_modification_date": "2014-05-12T17:46:56Z",
    "file_size": 429503,
    "plain_text": "#### TLP: WHITE\n\n# Context Threat Intelligence\n\n## Threat Advisory\n\n The Monju Incident\n\n**Context Ref.** TA10009\n\n**Author** Context Threat Intelligence (CTI)\n\n**Date** 27/01/2014\n\n**Tel** +44 (0) 20 7537 7515\n\n**Fax** +44 (0) 20 7537 1071\n\n**Email** [threat@contextis.co.uk](mailto:technical@contextis.co.uk)\n\n© Context Information Security\n\n#### TLP: WHITE\n\n\n-----\n\n#### Contents\n\n**1 Distribution** **3**\n\n**2 Executive Summary** **4**\n\n**3 The Monju Incident** **5**\n\n3.1 Infection Vector 5\n\n3.2 Malware 6\n\n3.2.1 Overview 6\n\n3.2.2 Detection 8\n\n**4 Appendix A – File Metadata** **9**\n\n\n#### TLP: WHITE\n\n\nP 2 / 11\n\n\n-----\n\n#### 1 Distribution\n\nContext Information Security distribute Context Threat Intelligence (CTI) reporting under\nthe Traffic Light Protocol (TLP)[[1]], a method of classifying a document in order to promote\nthe distribution of sensitive information between individuals, organisations or\ncommunities in a controlled and trusted way, based on the originator’s wishes.\n\nThe various levels of the TLP are represented by the following colours:\n\n**RED - Personal; for named recipients only**\n\nSources may use TLP: RED when information cannot be effectively acted upon by\nadditional parties, and could lead to impacts on a party's privacy, reputation, or\noperations if misused.\n\nRecipients may not share TLP: RED information with any parties outside of the specific\nexchange, meeting, or conversation in which it is originally disclosed. TLP: RED\ninformation will be passed verbally or in person.\n\n**AMBER - Limited Distribution**\n\nSources may use TLP: AMBER when information requires support to be effectively acted\nupon, but carries risks to privacy, reputation, or operations if shared outside of the\norganisations involved.\n\nRecipients may only share TLP: AMBER information with members of their own\norganisation who need to know, and only as widely as necessary to act on that\ninformation.\n\n**GREEN – Community Wide**\n\nSources may use TLP: GREEN when information is useful for the awareness of all\nparticipating organisations as well as with peers within the broader community or sector.\n\nRecipients may share TLP: GREEN information with peers and partner organisations within\ntheir sector or community, but not via publicly accessible channels such as publication\nor posting publicly on the Internet. WHITEWHITE\n\n**- Unlimited Distribution**\n\nSources may use TLP: WHITE when information carries minimal or no foreseeable risk of\nmisuse, in accordance with applicable rules and procedures for public release.\n\nSubject to standard copyright rules, TLP: WHITE information may be distributed freely,\nwithout restriction.\n\n1 [http://www.oecd.org/dataoecd/25/10/40761118.pdf](http://www.oecd.org/dataoecd/25/10/40761118.pdf)\n\n\n#### TLP: WHITE\n\n\nP 3 / 11\n\n\n-----\n\n#### 2 Executive Summary\n\nOn 2[nd] January 2014 a Systems Administrator at the Monju fast breeder reactor facility in\nJapan noticed suspicious connections emanating from a machine in the control room,\ncoinciding with what was a seemingly routine software update to a free media player.\nAmong other items, staff training documents and more than 40,000 emails were stored\non the machine and thought to be harvested by the attacker. The Japanese Atomic\nEnergy Agency is investigating further.\n\nThe attack appears to have been the result of the attackers having compromised the\n‘GOM Player’ update server and having it act as a ‘watering hole’, meaning that\nmachines which access the site are delivered malware. Gom Player originates in South\nKorea and in some parts of Asia it is a popular alternative to Windows Media Player. It is\nunclear whether every machine trying to download an update received this malware or\nwhether only machines which fitted a certain profile were infected.\n\nTechnical analysis of the implant on the compromised machine has shown it to be a\nvariant of a Trojan which has been in the wild for some years now and continues to be\neffective. The ‘Gh0st RAT’ has been used extensively in attacks linked to the Chinese\nstate, though it is important to remember that the code is publicly available and can be\nmodified and used by anyone. The targeting of a Japanese nuclear facility however, is\nconsistent with Chinese state intelligence requirements. If this is the work of a Chinese\ngroup then we feel the targeting may go much further than the Civil Nuclear sector and\nthus be of interest to the wider Energy Sector and industry as a whole.\n\nIn order to inform the Energy Sector and beyond about this attack, we have compiled a\ntechnical summary of the attack and have provided a number of Indicators Of\nCompromise (IOCs) which can be used to aid detection. It is likely that the attackers\nwould redeploy their implant against other targets, albeit with a delivery mechanism\nmore tailored to the location of the intended victims.\n\n\n#### TLP: WHITE\n\n\nP 4 / 11\n\n\n-----\n\n#### 3 The Monju Incident\n\n##### 3.1 Infection Vector\n\nBased on open source reporting, it appears that the intrusion took place via the\ncompromise of the GOM Player update server (app.gomlab.com), where attackers\nmay have gained entry via a PHP-based webshell, hidden within an image, present on\nthe host since October 2011[[2]].\n\nThe observed malicious activity relates to the modification of a file that controls GOM\nPlayer updates, spanning the date range 27[th] December 2013 to 16[th] January 2014,\nduring which time these alterations are reported to have only manifested themselves for\nvisitors on certain IP ranges; evidence supporting this claim has not yet been made\npublic. If this was indeed the case, then the nature of this attack is certainly more\ntargeted than one that would cover the entire userbase of the GOM Player product,\nwith victims comprising of the Japanese Government in addition to those at the Monju\nnuclear facility.\n\nThe modified file redirected the GOM Player update process to another compromised\nserver (www.fudousankaitori.jp (203.189.101.35)), where a file containing both the\nlegitimate update and the malware was deliver to the victim.\n\nModified\nUpdate URL\n\napp.gomlab.com\n\n\nVictim\n\nKey\n\nCompromised Server\n\nAttacker Infrastructure\n\n\nwww.fudousankaitori.jp\n\ntestqweasd.tk\n\n\n**A diagram illustrating the modified flow of the GOM Player update process which led to the compromise**\n\n2 [http://hummingbird.tistory.com/5187](http://hummingbird.tistory.com/5187)\n\n\n#### TLP: WHITE\n\n\nP 5 / 11\n\n\n-----\n\n##### 3.2 Malware\n\n**3.2.1** **Overview**\n\nDeployed to the system via a compressed bundle containing the official GOM Player\nsetup binary and a self-extracting RAR archive containing the malicious files, the\nmalware consists of a number of individual pieces. Upon extraction from the RAR\narchive, the installer component (0ae82fd94836815a1e8d284ccb75109d) is\nautomatically launched alongside the GOM Player update, distracting victims from the\nmalicious activity taking place.\n\nThe installer component is referred to by the author as ‘miansha' which, according to an\nEast Asia Cyber Threat Intelligence Researcher, is likely Miǎnshā (免杀), a phrase\n\ncommonly used by People’s Republic of China (PRC) hackers to mean ‘anti Antivirus\ndetection’ or ‘Antivirus avoidance’; Symantec[[3]] have named the detection for this\ncode ‘Backdoor.Miancha’, where Miǎnchá (免查, likely shorthand for 免杀查) similarly\n\nmeans ‘Antivirus avoidance’. The installer is responsible for the malware persistence\nmechanism, adding entries to the registry in the following locations, depending on\nWindows Version:\n\n\n**Miancha Persistence Registry Keys**\n\n\n**Windows Vista and later** `HKEY_USERS\\.default\\Software\\Classes\\CLSID\\{ECD4FC4D-`\n```\n             5213-11D0-B792-00A0C90312E1}\\InProcServer32\\@ =\n             expand:\"C:\\WINDOWS\\temp\\install.ocx\"\n\n```\n**Prior to Windows Vista** `HKEY_USERS\\.default\\Software\\Classes\\CLSID\\{B12AE898-`\n```\n             D056-4378-A844-6D393FE37956}\\InProcServer32\\@ =\n             expand:\"C:\\WINDOWS\\temp\\install.ocx\"\n\n```\nThe installer will also determine the system architecture (32- or 64-bit) and then\ndeobfuscate the relevant loader DLL to the path ‘C:\\Windows\\temp\\install.ocx’,\nensuring the malware is launched on system start-up. Oddly, this file is padded with null\nbytes, resulting in a 25 megabyte file.\n\n**Repackaged Update**\nGoMPLAYERJPSETUP.EXE (a9225e059d9dace1b259bceec7f48dae)\n\n\n**Real GOM Player Installer**\nGOMPLAYERJPSETUP_JP.EXE (1ff3b3628e40f0215afacf482ba17782)\n\n**Obfuscated Malware Loaders**\ndll.tmp (d5548e1913950a42a04debcac4222bd2)\ndll64.tmp (01f7b465242237bd3d31d39767aa68e0)\n\n\n**Self-extracting RAR Archive containing Malware**\nGOMPLAYERBETASETUP_JP.exe (db79a93448acac8786581858f3edc36a)\n\n**Malicious Installer**\ninstall.exe (0ae82fd94836815a1e8d284ccb75109d)\n\n**Obfuscated Implant Code**\ninstructions.pdf (569071c45f47b7fb7a75f30bc07d5739)\ninstructions64.pdf (55474f8e26f2b6fc3b5d78ce9a77b0b0)\n\n\n**The deployment chain of the Miancha Gh0st variant**\n\n3 [http://www.symantec.com/security_response/writeup.jsp?docid=2014-012407-3922-99](http://www.symantec.com/security_response/writeup.jsp?docid=2014-012407-3922-99)\n\n\n#### TLP: WHITE\n\n\nP 6 / 11\n\n\n-----\n\nThe main implant code is stored in files named instructions.pdf and instructions64.pdf;\nnot PDF documents but instead DLLs obfuscated with a one-byte XOR with 0x14, similar\nto the malware loader DLLs. The loader, referred to by the malware author as 壳 (shell),\n\nreads and deobfuscates the main implant code which then communicates with the\nattacker-controlled server at testqweasd.tk (211.43.220.89) on TCP port 443. The main\nimplant code is referred to as 白加黑 (‘Black on White’), a term used in the PRC hacking\n\ncommunity to denote the act of Antivirus avoidance through the loading of malicious\n‘black’ code via non-malicious or trusted ‘white‘ code. This is a practice recently\nillustrated through the deployment of the PlugX trojan, utilising DLL load order hijacking\nalongside a signed (trusted) executable.\n\nAnalysis of this malware revealed it to be a variant of the Gh0st RAT, often used by\nChinese actors (including those who are state-motivated or directly state-sponsored).\nThis specific variant shows similarities to that used during the VOHO campaign[[4]], where\nGh0st RAT was spread via watering hole attacks utilising vulnerable websites belonging\nto financial services and technology companies. Specifically, the initial five bytes of the\ncommunications (often used to denote a campaign or victim) are ‘HTTPS’, amended\nfrom the original ‘Gh0st’; the same as the traffic produced by the VOHO Gh0st variant.\n\nIn addition to delivering system-specific details back to the attacker, Gh0st RAT provides\nthe capability to deploy additional malware, enabling the harvesting of sensitive data\nand enabling the further propagation throughout the infected network.\n\n4 [https://blogs.rsa.com/voho-apt-campaign-update/](https://blogs.rsa.com/voho-apt-campaign-update/)\n\n\n#### TLP: WHITE\n\n\nP 7 / 11\n\n\n-----\n\n**3.2.2** **Detection**\n\nTo enable rapid response, the following Snort signature can be deployed:\n```\nalert tcp $HOME_NET any -> $EXTERNAL_NET 53,80,443,1080 (msg:\"gh0st RAT 'HTTPS' variant\n(aka Backdoor.Miancha)\"; flow:established,to_server; content:\"HTTPS\"; depth:5; rawbytes;\nclasstype:trojan-activity; sid:xxx; rev:1;)\n\n```\nAdditionally, the following Yara signature should identify both encoded payloads and\nthe active implant in memory:\n```\nrule Trojan_W32_Gh0stMiancha_1_0_0\n{\n  strings:\n    $0x = { 57 5b 5a 5a 51 57 40 34 31 67 2e 31 70 34 5c 40 40 44 3b 25 3a 19 1e 5c 7b\n67 60 2e 34 31 67 2e 31 70 19 1e 55 77 77 71 64 60 2e 34 3e 3b 3e 19 1e 57 7b 7a 60 71 7a\n60 39 40 6d 64 71 2e 34 60 71 6c 60 3b 7c 60 79 78 19 1e 44 66 7b 6c 6d 39 57 7b 7a 7a 71\n77 60 7d 7b 7a 2e 34 5f 71 71 64 39 55 78 7d 62 71 19 1e 57 7b 7a 60 71 7a 60 39 78 71 7a\n73 60 7c 2e 34 24 19 1e 19 1e }\n    $1 = { 5c e7 99 bd e5 8a a0 e9 bb 91 5c }\n    $1x = { 48 f3 8d a9 f1 9e b4 fd af 85 48 }\n    $2 = \"DllCanLoadNow\"\n    $2x = { 50 78 78 57 75 7a 58 7b 75 70 5a 7b 63 }\n    $3x = { 5a 61 79 76 71 66 34 7b 72 34 67 61 76 7f 71 6d 67 2e 34 31 70 }\n    $4 = \"JXNcc2hlbGxcb3Blblxjb21tYW5k\"\n    $4x = { 5e 4c 5a 77 77 26 7c 78 76 53 6c 77 76 27 56 78 76 78 6c 7e 76 26 25 60 4d\n43 21 7f }\n    $5 = \"SEFSRFdBUkVcREVTQ1JJUFRJT05cU3lzdGVtXENlbnRyYWxQcm9jZXNzb3JcMA==\"\n    $5x = { 47 51 52 47 46 52 70 56 41 7f 42 77 46 51 42 40 45 25 5e 5e 41 52 46 5e 40\n24 21 77 41 27 78 6e 70 53 42 60 4c 51 5a 78 76 7a 46 6d 4d 43 6c 45 77 79 2d 7e 4e 4c 5a\n6e 76 27 5e 77 59 55 29 29 }\n    $6 = \"C:\\\\Users\\\\why\\\\\"\n    $6x = { 57 2e 48 41 67 71 66 67 48 63 7c 6d 48 }\n    $7 = \"g:\\\\ykcx\\\\\"\n    $7x = { 73 2E 48 6D 7F 77 6C 48 }\n    $8 = \"(miansha)\"\n    $8x = { 3C 79 7D 75 7A 67 7C 75 3D }\n    $9 = \"server(\\xE5\\xA3\\xB3)\"\n    $9x = { 7C 2E 48 26 24 25 27 3A 25 25 3A 26 21 48 67 71 66 62 71 66 3C F1 B7 A7 3D\n48 46 71 78 71 75 67 71 48 67 71 66 62 71 66 3A 64 70 76 }\n    $cfgDecode = { 8a ?? ?? 80 c2 7a 80 f2 19 88 ?? ?? 41 3b ce 7c ??}\n  condition:\n    any of them\n}\n\n```\n\n#### TLP: WHITE\n\n\nP 8 / 11\n\n\n-----\n\n#### 4 Appendix A – File Metadata\n\n\n**Gh0stMiancha Installer**\n\n\n**MD5** `0ae82fd94836815a1e8d284ccb75109d`\n\n**SHA1** `bcba2a4d55d860f0bca3b9f80a5deb2dd69f000c`\n\n**SHA256** `b2f9e2f7c07235a6ea03e90ba591f0a43d38d8ff8ee6583473b6fbb63831619d`\n\n**Size (bytes)** 13314\n\n**Compile Time** 2013-11-22 12:19:48 UTC\n\n**In-the-wild Filenames** install.exe\n\n**PDB String** g:\\ykcx\\install(miansha)\\Release\\install.pdb\n\n\n**Obfuscated TrojanLoader:W32/Gh0stMiancha**\n\n\n**MD5** `d5548e1913950a42a04debcac4222bd2`\n\n**SHA1** `ac48bc2deefd30dad762a23e85409a7eec48b723`\n\n**SHA256** `3d43f7fab3c8f574e2790c2d97f85fa87f0d53e412c995462e53348b4fc34b74`\n\n**Size (bytes)** 10299\n\n**Compile Time** N/A\n\n**In-the-wild Filenames** dll.tmp\n\n\n**TrojanLoader:W32/Gh0stMiancha**\n\n\n**MD5** `04e7361323b431f7c9f86388f316bbea`\n\n**SHA1** `e3c095c7ace563b41b3f4310f3de69e47c86fd03`\n\n**SHA256** `73ef70f1e80e32341eebcb3b1084cf896f6b1aa701b7a6c7abcb9293500d84ae`\n\n**Size (bytes)** 10299\n\n**Compile Time** 2013-11-26 09:34:10 UTC\n\n**In-the-wild Filenames** install.ocx\n\n**PDB String** h:\\2013.11.25\\server(壳)\\Release\\server.pdb\n\n\n**Obfuscated TrojanLoader:W64/Gh0stMiancha**\n\n\n**MD5** `01f7b465242237bd3d31d39767aa68e0`\n\n**SHA1** `db4ec59bf7f34a21f9dc7f2ded68c616f7c0fe47`\n\n**SHA256** `ed39c1d86ff8cfe18ef58e850d205a678d255150324b00661b91448173c94900`\n\n**Size (bytes)** 12347\n\n**Compile Time** N/A\n\n**In-the-wild Filenames** dll64.tmp\n\n\n**TrojanLoader:W64/Gh0stMiancha**\n\n\n**MD5** `008fbd0fde06edb31fc7eecdae1a3030`\n\n**SHA1** `b9ae0a079cd1dae96425ced4bb96ba0f71c87a7a`\n\n#### TLP: WHITE\n\n\nP 9 / 11\n\n\n-----\n\n**SHA256** `cc8d38d3cc214ff3ad10d6859a88e018b1f7e0ed6df7d04a6f4368bda851ba14`\n\n**Size (bytes)** 12347\n\n**Compile Time** 2013-11-26 11:47:39 UTC\n\n**In-the-wild Filenames** install.ocx\n\n**PDB String** C:\\Users\\why\\Desktop\\server(壳)\\x64\\Release\\server.pdb\n\n\n**Obfuscated Trojan:W32/Gh0stMiancha**\n\n\n**MD5** `569071c45f47b7fb7a75f30bc07d5739`\n\n**SHA1** `540bb9d2dee8f4e10e5ae0a5cc900b346a57a198`\n\n**SHA256** `8a00b2aefdcd0bb22013bbe9c7941fa16af8246e545e1522622006b9c88ca716`\n\n**Size (bytes)** 169019\n\n**Compile Time** N/A\n\n**In-the-wild Filenames** instructions.pdf\n\n\n**Trojan:W32/Gh0stMiancha**\n\n\n**MD5** `916b1a07efb145c450b4c13540be6c3e`\n\n**SHA1** `7984639beb4e9870301d3b44a68b4346f9a6b826`\n\n**SHA256** `f26c2e9bee680f8e4d7afd73e2984a6697263334d2f0049a40e050d75293035e`\n\n**Size (bytes)** 169019\n\n**Compile Time** 2013-12-06 08:08:28 UTC\n\n**In-the-wild Filenames** N/A\n\n**PDB String** h:\\2013.11.25\\白加黑\\server(update.dll)(instructions.pdf)\\Release\\server.pdb\n\n\n**Obfuscated Trojan:W64/Gh0stMiancha**\n\n\n**MD5** `55474f8e26f2b6fc3b5d78ce9a77b0b0`\n\n**SHA1** `3f714c33992e906e69df2d5d4971beaed336d9f4`\n\n**SHA256** `27e5670f68ff68acc80716c6870f4e5d06c471791f087d5b9b7613f8dc700037`\n\n**Size (bytes)** 233019\n\n**Compile Time** N/A\n\n**In-the-wild Filenames** instructions64.pdf\n\n\n**Trojan:W64/Gh0stMiancha**\n\n\n**MD5** `1d2c77f0f8a715de09ce6fae5fc800d4`\n\n**SHA1** `30784735763b060a39f76c29439a6aebbf6a4b9b`\n\n**SHA256** `2fdf454f6b1c82d757d054bea5f0438f5da1ecd9e5059610d3d4b74e75a7c8b0`\n\n**Size (bytes)** 233019\n\n**Compile Time** 2013-12-06 08:10:34 UTC\n\n**In-the-wild Filenames** N/A\n\n**PDB String** C:\\Users\\why\\Desktop\\server(update.dll)(instructions.pdf)x64\\x64\\Release\\server.pdb\n\n\n#### TLP: WHITE\n\n\nP 10 / 11\n\n\n-----\n\n**Context Information Security - Threat Intelligence - threat@contextis.co.uk**\n\n**London (HQ)** **Cheltenham** **Düsseldorf** **Melbourne**\n\n\n4th Floor\n\n30 Marsh Wall\n\nLondon E14 9TP\n\nUnited Kingdom\n\n\nCorinth House\n\n117 Bath Road\n\nCheltenham GL53 7LS\n\nUnited Kingdom\n\n#### TLP: WHITE\n\n\n1.OG\n\nAdersstr. 28\n\n40215 Düsseldorf\n\nGermany\n\n\n4th Floor\n\n155 Queen Street\n\nMelbourne VIC 3000\n\nAustralia\n\nP 11 / 11\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/l6n25enqom0uydgxogybp82294nkf4dt",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.02.19.Monju_Incident/The_Monju_Incident.pdf"
    ],
    "report_names": [
        "The_Monju_Incident"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716490,
    "ts_updated_at": 1743041321,
    "ts_creation_date": 1392637246,
    "ts_modification_date": 1399916816,
    "files": {
        "pdf": "https://archive.orkl.eu/9b66a35bea35d963d1ff07cab2a3914b38e24257.pdf",
        "text": "https://archive.orkl.eu/9b66a35bea35d963d1ff07cab2a3914b38e24257.txt",
        "img": "https://archive.orkl.eu/9b66a35bea35d963d1ff07cab2a3914b38e24257.jpg"
    }
}