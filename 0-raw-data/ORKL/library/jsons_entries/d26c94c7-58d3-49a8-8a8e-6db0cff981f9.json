{
    "id": "d26c94c7-58d3-49a8-8a8e-6db0cff981f9",
    "created_at": "2022-10-25T16:48:18.546422Z",
    "updated_at": "2025-03-27T02:05:55.863573Z",
    "deleted_at": null,
    "sha1_hash": "d1363387918708bae5643e77c42a77541b28ae46",
    "title": "",
    "authors": "",
    "file_creation_date": "2017-03-13T12:19:16Z",
    "file_modification_date": "2017-03-13T12:19:19Z",
    "file_size": 1840190,
    "plain_text": "# Behind a Malware Lifecycle and Infection Chain\n\n## Linking Asprox, Zemot, Rovix and Rerdom Malware Families\n\n\n-----\n\n## Table of Contents\n\n### Overview.................................................................................................................................................... 3\n\n Phase Two: Zemot.................................................................................................................................... 4\n\n The Monetization Mission: Web Click Fraud and Advertising Impression Fraud....................16\n\n\n-----\n\n## Overview\n\nMalware infection chains and lifecycles are often talked about in the advanced threat discussions in\na generic way, addressing droppers, payloads, command-and-control communications, and missions\nwithout any specific details of the different players in the lifecycle, their roles or the specific functions\nthey serve. While looking into the Rerdom malware, we had a unique opportunity to link different\nmalware families and an operator, following the infection chain back to its origin. In doing so, we’re able\nto illuminate the process, which we hope will inform others about the intricacies of advanced threats.\n\n### The Rerdom Malware\n\nWhile investigating some click-fraud activity, Damballa found that there is a connection between Asprox,\nZemot, Rovnix and Rerdom. Though this connection is complicated, we were able to decrypt sensitive\ncommand and control (C&C) data thus exposing one of the least understood aspects of this infection chain.\nNow that we have a good understanding of what the relationship looks like and how the process works\nwe decided it was time to share the information with the community. This leads us to the discussion of\nhow this infection chain ties in the different malware families listed; more importantly, this exposes the\nobfuscated operations of the last stage of the infection process involving Rerdom and the details behind\nits confounding circuit of click-fraud communications.\n\nTo start the infection process, we commonly see Asprox payloads downloading updates from the Asprox\nC&C servers. These same Asprox controlled servers also pass Zemot payloads with statically programmed\nZemot domains. The Zemot domains serve the Rovnix bootkit and then Rerdom, usually in that order. The\nZemot / Rerdom group is likely the same group of threat actors or multiple groups coordinating closely\ntogether. We will delve into that connection later in this post. With that brief description of a connection\nhierarchy, let’s go into the first phase of the infection chain (Asprox.)\n\n### Phase One: Asprox\n\nAsprox is generally spread via e-mail with malicious attachments that attempt to trick the user. These\nattachments usually contain icons that mask the true purpose of the file in order to fool the victim. In this\ncase we’ve seen the main Asprox infector using a Microsoft Word icon to mask the fact that it’s actually\na portable executable. If a windows user downloads this main infector binary and has the file extensions\nhidden it is difficult to tell that this is not truly a Microsoft Word document before they attempt to open\nthe file. Once the main infector is executed a Windows message box will appear in an attempt to make the\nuser believe the file did not correctly open.\n\n\n-----\n\nASPROX MESSAGE BOX\n\nAs the message box appears, the main infector spawns a background process in user space called svchost.\nSvchost.exe contains the Asprox binary that communicates with the command-and-control (C&C) servers.\n\nASPROX SVCHOST PROCESS\n\nNow that this version of the binary is running successfully in memory, it contacts the Asprox C&C servers to\nget an update of the current Asprox client. The initial client update can vary between the versions of Asprox\ndepending on how they are programmed. The update binary is passed to the victim inside encrypted\nnetwork traffic.\n\n## Phase Two: Zemot\n\nAt this point, the Zemot payload is also passed with the new Asprox update. The client needs to\ncommunicate with the C&C server using a formatted request / response. The text for the initial request is\nnormally a slight variation of the following string:\n\n“<knock><id>REDACTED</id><group>0110s</group><src>3</src><transport>0</transport><time>REDACTED</time><version>2049</version><status>0</status><debug>none none none</debug></\nknock>”\n\nWe’ve captured the decrypted response in memory (depicted in the screen shot below).\n\n\n-----\n\nASPROX DECRYPTED KNOCK DATA\n\nOnce the response comes from the C&C server, the Asprox client will update itself if needed and set up\npersistence using the “HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run” registry key.\n\nThe run registry key is set to execute the Asprox main infector on startup as well as any updated Asprox\nloaders that may have been downloaded during the C&C task request/response.\n\nASPROX STARTUP KEYS\n\nThe Asprox client contains several “maintenance commands” in order to give the botnet controllers the\nability to do things for the upkeep of their botnet. These built in Asprox commands consist of things like\nthe ability to update or sleep, the ability to install or remove modules along with the option of adding\npersistence to a new module through startup registry keys. The Asprox client commands usually consist of\nthree letter abbreviations for the task at hand.\n\n\n-----\n\nNotice we can see these commands in the memory displayed in the screen shot below:\n\nAsprox commands: idl, run, rem, ear, rdl, red and upd\n\nASPROX COMMANDS\n\nNext, Zemot is installed by the Asprox client which serves as a downloader for the Rovnix bootkit and then\nRerdom. Zemot executes and runs in user space under the explorer.exe process. The first network traffic\nZemot sends is a check-in to a statically programmed C&C server. This check-in was always noticeable in\nthe past because it contained the string /b/shoe in the GET request. Along with the GET request an integer is\npassed in the traffic which is written in the registry value “License” under HKCU\\Software\\<random string>.\nIt seems this value may indicate an affiliate/group ID\n\n\n-----\n\nB/SHOE REQUEST\n\nWe found during our analysis that the Zemot downloader usually has domains that resolve for anywhere\nfrom two days up to one week. Our passive DNS data shows that it is possible that some Zemot domains\nmight resolve longer than a week but none of the samples we analyzed would resolve after one week.\n\nIn our case a new Zemot binary had to be obtained by running the Asprox main infector again to get a fresh\nupdate from the Asprox C&C server.\n\nZEMOT CHECK-IN\n\n\n-----\n\nAs of October 14th 2014 the Zemot authors changed the traffic pattern associated with the check-in and the\nZemot downloader no longer uses /b/shoe. Based on our analysis the change now uses /catalog/ in place of\n/b/shoe. The passed value in the network traffic after /b/shoe remained the same.\n\n### Phase Three: Rovnix Bootkit and Rerdom Agent\n\nOnce the Zemot check-in occurs, Zemot proceeds to download the Rovnix bootkit from the Zemot\nC&C server. The part of the network path which often identifies Rovnix is being downloaded is “/mod_\nsmartslider2/”\n\nROVNIX DOWNLOAD\n\nAfter the bootkit is downloaded it will be saved to the local disk under temporary internet files as “exe[1].\nexe” Then it will be moved to\n\n“C:\\Documents and Settings\\user\\Local Settings\\Temp\\UpdateFlashPlayer_<random string>.exe” and the\ncomputer will be rebooted so the bootkit can install the kernel driver.\n\nROVNIX MD5 LOCATION #1\n\n\n-----\n\nNow from running within the explorer.exe process, Zemot will run the downloaded copy of Rovnix and the\ncomputer will reboot.\n\nROVNIX MD5 LOCATION #2\n\nImmediately after the computer is rebooted Zemot reaches out to the Zemot C&C servers to download and\ninstall Rerdom. The path will often include soft32.dll or soft64.dll in the actual network request. Using soft32\nor soft64 will be based on the architecture of the victim CPU.\n\nRERDOM ENCRYPTED DOWNLOAD SAMPLE 1\n\n\n-----\n\nThe exact path can vary depending on which C&C server the binary is using to download Rerdom.\n\nRERDOM ENCRYPTED DOWNLOAD SAMPLE 2\n\nAfter Rerdom runs it will also execute under explorer.exe however, it will execute its own child explorer.exe\nprocess:\n\nRERDOM EXPLORER.EXE PROCESS\n\nOnce Rerdom is executed it initializes by running a series of commands to establish a new list of Rerdom\nC&C servers, obtain a download url to install flash, and requests its click fraud tasking along with the\nsearch servers.\n\n\n-----\n\nRerdom has four main C&C communication stages:\n\n  - EVE: check-in to the Rerdom C&C server\n\n  - OPT   - request task configuration settings along with a url to download flash\n\n  - LETR - request updated list of Rerdom C&C servers\n\n  - REQ   - request search and click url addresses\n\nAfter Rerdom runs it will initiate an initial communication using EVE. The C&C server simply returns “hi!”\n\nEVE REQUEST / RESPONSE\n\nAfter Rerdom gets a response from the server it continues to go through the rest of the communication\nphases with the ultimate goal of executing the click fraud activities. The next request we observed Rerdom\nmaking is the OPT request to get the configuration settings and the flash url. Encrypted OPT data showing\nthe network traffic capture matching bytes in our debugger:\n\nENCRYPTED OPT DATA\n\n\n-----\n\nThe same data shown previously except now in the debugger the data is decrypted:\n\nDECRYPTED OPT DATA\n\nA text sample of the OPT data (pulled from memory):\n\n  - 01554CEC {“status”:”OK”,”data”:{“normal_delay”:20,”error_delay”:20,”soft_\n\n  - 01554D2C start”:18,”task_start”:18,”task_finish”:550,”task_request”:18,”t\n\n  - 01554D6C hread_count”:18,”flash_url”:”http://download.macromedia.com/pub/\n\n  - 01554DAC flashplayer/current/support/install_flash_player_ax.\n\nThe next step for Rerdom is to obtain a list of C&C servers using LETR. Shown in Encrypted LETR data are\nthe encrypted bytes being passed over the network and those same bytes are shown in our debugger. In the\ndecrypted LETR data screen shot we see that the bytes being passed over the network are now decrypted in\nmemory.\n\n\n-----\n\nENCRYPTED LETR DATA\n\nDECRYPTED LETR DATA\n\n\n-----\n\nText sample of LETR data (the malicious urls have been made “click proof”):\n\n  - hxxp://lowbalance[.]su/\n\n  - hxxp://oldfirefox[.]su/\n\n  - hxxp://irishjuice[.]su/\n\n  - hxxp://everydaypp[.]ru/\n\n  - hxxp://nitmurmansk[.]su/\n\n  - hxxp://brokenpiano[.]ru/\n\n  - hxxp://198[.]154[.]224[.]48:8080/\n\n  - hxxp://65[.]254[.]49[.]118:8080/\n\n  - hxxp://212[.]81[.]134[.]56:1080/\n\n  - hxxp://212[.]81[.]134[.]57:1080/\n\n  - hxxp://174[.]127[.]103[.]45:443/\n\n  - hxxp://198[.]58[.]102[.]172:8080/\n\n  - hxxp://74[.]117[.]158[.]3:443/\n\n  - hxxp://70[.]32[.]94[.]46:8080/\n\n  - hxxp://178[.]207[.]18[.]188:443/\n\n  - hxxp://173[.]255[.]241[.]19:8080/\n\n  - hxxp://194[.]38[.]104[.]218:443/\n\n  - hxxp://162[.]248[.]167[.]184:443/\n\n  - hxxp://65[.]254[.]49[.]116:8080/\n\n  - hxxp://178[.]18[.]18[.]30:443/\n\n  - hxxp://122[.]155[.]167[.]122:8080/\n\n  - hxxp://61[.]90[.]197[.]150:8080/\n\n  - hxxp://27[.]254[.]40[.]105:8080/\n\n  - hxxp://69[.]164[.]221[.]7:443/\n\n  - hxxp://209[.]160[.]65[.]96:8080/\n\n  - hxxp://166[.]78[.]145[.]146:443/\n\n  - hxxp://46[.]28[.]68[.]144:8080/\n\n  - hxxp://162[.]144[.]37[.]28:8080/\n\n  - hxxp://198[.]154[.]216[.]149:8080/\n\n  - hxxp://178[.]21[.]117[.]34:8080/\n\n  - hxxp://162[.]213[.]250[.]124:8080/\n\n  - hxxp://203[.]151[.]23[.]69:8080/\n\n  - hxxp://70[.]32[.]85[.]69:8080/\n\nNext, with the updated list of C&C servers in hand, Rerdom will start the requests for getting the click fraud\ntasking and search urls using the REQ request.\n\n\n-----\n\nDECRYPTED REQ DATA\n\n**Text sample of REQ data (pulled from memory):**\n\n  - 01554CEC {“status”:”OK”,”data”:{“tasks”:[{“clickurl”:”http://192.162.19.1\n\n  - 01554D2C 22/b/pkg/T5030REDACTED”,”searchurl”:”http://state-registration\n\n  - 01554D6C s.com/”},{“clickurl”:”http://192.162.19.122/b/pkg/T5030REDACTED\n\n  - 01554DAC “,”searchurl”:”http://declaration-customsunion.com/”},{“clickur\n\n  - 01554DEC l”:”http://192.162.19.122/b/pkg/T5030REDACTED”,”searchurl”:”ht\n\n  - 01554E2C tp://accreditations-shop.com/”},{“clickurl”:”http://192.162.19.1\n\n  - 01554E6C 22/b/pkg/T5030REDACTED”,”searchurl”:”http://new-certification.\n\n  - 01554EAC com/”},{“clickurl”:”http://192.162.19.122/b/pkg/T5030REDACTED”\n\n  - 01554EEC,”searchurl”:”http://operation-manual.com/”},{“clickurl”:”http:/\n\n  - 01554F2C /192.162.19.122/b/pkg/T5030REDACTED”,”searchurl”:”http://apple\n\n  - 01554F6C icon.com/”},{“clickurl”:”http://192.162.19.122/b/pkg/T5030REDACTED 01554FAC\n“,”searchurl”:”http://accreditation-laboratories.com/”}]}}.\n\n\n-----\n\n## The Monetization Mission: Web Click Fraud and Advertising Impression Fraud\n\nLet’s take a detailed look at the actual click-fraud and ad impression traffic in action.\n\nSTEP 1\n\nIn step 1 here we have the Rerdom infected host calling out to the Rerdom C&C server. The server returns\nencrypted data that when decrypted shows the click and search urls below. This tells the bot what actions\nto take to monetize the botnet.\n\n  - {“status”:”OK”,”data”:\n\n  - {“tasks”:[\n\n  - {“clickurl”:”http://46.161.41.219/b/pkg/T5030REDACTED”,”searchurl”:”http://catalog-equipment.com/”},\n\n  - {“clickurl”:”http://46.161.41.219/b/pkg/T5030REDACTED”,”searchurl”:”http://controller-best.com/”},\n\n  - {“clickurl”:”http://46.161.41.219/b/pkg/T5030REDACTED”,”searchurl”:”http://seo-pronew.com/”},\n\n  - {“clickurl”:”http://46.161.41.219/b/pkg/T5030REDACTED”,”searchurl”:”http://controller-best.com/”},\n\n  - {“clickurl”:”http://46.161.41.219/b/pkg/T5030REDACTED”,”searchurl”:”http://simple-connector.\ncom/”}]}}.\n\n\n-----\n\nSTEP 2\n\nHere you can see a GET request to contoller-best[.]com that was listed above in the decrypted C&C response.\nThe domain is listed as a searchurl and is used by the criminal group to facilitate click-fraud and ad\nimpression fraud. This is important because the searchurl domains are used as the referrer so that when\nthe bot finally lands on the final page, the media company in question that is displaying the ads to the bot\nknows who to pay.\n\nNotice here that the referrer is Google and that was inserted into the HTTP header by the bot.\n\nSTEP 3\n\n\n-----\n\nThis GET request is a check-in to the Clickurl server, 46[.]161[.]41[.]219, to get the appropriate 302 response\nthat will direct the bot to the next destination. The referrer is controller-best[.]com from step 2.\n\nSTEP 4\n\nHere we have another 302 redirect. The referrer once again is controller-best[.]com. The GET request is\ncoded so that the server knows to respond with an appropriate domain and url for the bot to go to for\nclick-fraud or ad impressions.\n\nSTEP 5\n\n\n-----\n\nHere is the final landing page where the criminal group behind this botnet make money. The referrer is\ncontroller-best[.]com from step 2 and is used to help the criminal group monetize their botnet.\n\nThe bot lands on the site techtickletv.com which is an advertising landing page without any original\ncontent. It contains 4-5 display ads and a video ad. With a single bot page visit, the criminals can get paid\nfor generating impressions for each of the 4-5 display ads as well as the video ad impression, which will\ntypically pay more. The site is owned by a company named Hutch Media LLC.\n\nHutch Media has been mentioned before on another blog that discusses click-fraud [1].\n\nIn this particular blog post the author uses the term impression laundering in regards to what the bot is\ndoing. Impression laundering is where an advertiser buys ads from a publisher to only have those ads\nactually displayed on websites that don’t have anything to do with the advertiser’s brand. The ads are in\nessence laundered through redirects and iframes so that the advertiser does not see the real sites where the\nad is displayed [2].\n\nYou can see in that blog post [1] that there are other sites that are being used to monetize this impression\nlaundering that are owned by Hutch Media LLC. These other sites are like techtickletv.com in that they don’t\nreally display any original content but are mostly ad landing pages.\n\nMost of the traffic that Damballa has observed from the Rerdom malware has been impression laundering,\nnot so much the traditional click-fraud. Damballa believes this is because of how advertising works and how\nit can be linked to legitimate traffic or not. With click-fraud there is a click-through of when a user clicks on\nthe ad, it is recognized, and the traffic is driven to the advertiser’s site. This gives the advertiser visibility into\nwhere their traffic is coming from and they can then determine the quality of the traffic as well as how it got\nthere.\n\nThere is less accountability in this form of ad-fraud and therefore there is also less risk taken on by the\ncriminal groups that choose to commit ad-fraud in this manner. Damballa believes that there will be more\ncriminal groups that choose to adopt this form of making money because there is less risk involved.\n\nOver the past two years we here at Damballa have seen an increase in the number of infected bots and\ngroups that are performing click-fraud and impression laundering. We expect this trend to continue.\n\nOur Zemot/Rerdom operator is RuthlessTreeMafia MD5 hashes:\n\nAsprox spam infector d38a9b4d0c17c954080b86bb79a25272 Zemot 54b5c261ecbd63118f1a135cb4f091d6\n\nRovnix 7166665cf5d69422fb710009161faf64 Rerdom 44994d7d75e6c6f215d239bba5d8f411\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.coresecurity.com/sites/default/files/resources/2017/03/Behind_Malware_Infection_Chain.pdf"
    ],
    "report_names": [
        "Behind_Malware_Infection_Chain.pdf"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041155,
    "ts_creation_date": 1489407556,
    "ts_modification_date": 1489407559,
    "files": {
        "pdf": "https://archive.orkl.eu/d1363387918708bae5643e77c42a77541b28ae46.pdf",
        "text": "https://archive.orkl.eu/d1363387918708bae5643e77c42a77541b28ae46.txt",
        "img": "https://archive.orkl.eu/d1363387918708bae5643e77c42a77541b28ae46.jpg"
    }
}