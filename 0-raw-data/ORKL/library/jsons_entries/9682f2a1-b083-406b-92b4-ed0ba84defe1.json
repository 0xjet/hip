{
    "id": "9682f2a1-b083-406b-92b4-ed0ba84defe1",
    "created_at": "2022-10-25T16:48:17.668715Z",
    "updated_at": "2025-03-27T02:17:01.245208Z",
    "deleted_at": null,
    "sha1_hash": "3734c84bc7f9cd852ec8a678d9717bd91a25c762",
    "title": "Dissecting PlugX to Extract Its Crown Jewels",
    "authors": "",
    "file_creation_date": "2022-09-12T12:33:10Z",
    "file_modification_date": "2022-09-12T12:33:10Z",
    "file_size": 563191,
    "plain_text": "# Dissecting PlugX to Extract Its Crown Jewels\n### In-depth analysis and free tools\n\nAuthor:\n\nFelipe Duarte\n\nDate:\n\nSeptember 14, 2022\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\n## Table of Contents\n\nExecutive Summary .................................................................................................................................. 3\n\nTechnical Details ...................................................................................................................................... 4\n\nDistribution ........................................................................................................................................... 4\n\nInfection ................................................................................................................................................. 4\n\nStage 1 – Loader DLL .................................................................................................................... 5\n\nStage 2 – Shellcode ........................................................................................................................ 7\n\nStage 3 – Core DLL ........................................................................................................................ 9\n\nDetection Opportunities ....................................................................................................................... 16\n\nConclusions ............................................................................................................................................. 16\n\nIndicators of Compromise .................................................................................................................... 17\n\nYARA Rules .............................................................................................................................................. 18\n\nMITRE ATT&CK Matrix ........................................................................................................................... 21\n\nReferences ............................................................................................................................................... 24\n\nThreat Intelligence & Incident Response Team\n2\n\n\n-----\n\n#### Executive Summary\n\nPlugX is a malware family first spotted in 2008. It is a Remote Access Trojan that has been\nused by several threat actors and provides them with full control over infected machines. It\nhas continually evolved over time, adding new features and functionalities with each\niteration. Hence, it is important to keep following and documenting its transformations.\n\nCurrently, it remains as one of the most popular tools in the Asian cybercrime community,\ngiven its flexibility and trajectory in the market; and it is still actively used by notorious\nthreat actors such as Mustang Panda, Winnti, Gallium, DragonOK[1] and Earth Berberoka[2].\n\nThis modular bot offers several customization options such as the communication protocol\nused to interact with C2 servers, which could be done via ICMP, TCP, UDP, HTTP and even\nHTTPS protocol. Also, it enables threat actors to extend its functionalities via additional\nplugins that could be hardcoded into the Core DLL or by automatically loading and\nexecuting additional PE files.\n\nThis threat has been widely documented by several companies. However, we saw the need\nto create an up-to-date analysis that could explain with more accuracy the current state of\nthis malicious tool. With that objective in mind, in this document we want to explain in\ngreat detail its main functionalities, and provide a deeper understanding about the new\nTactics, Techniques and Procedures implemented in the latest version of this attack, next\nto some ideas and resources that could help your security team to detect and respond to a\nPlugX infection.\n\nThe report in a nutshell:\n\n   - PlugX is still one of the most relevant malware families in Asia, being used by notorious\nthreat actors such as Earth Berberoka.\n\n   - PlugX keeps evolving, new features have been added to the 64bit variant.\n\n   - ICMLuaUtil Elevated COM interface is now being abused by PlugX to bypass the UAC.\n\n   - RDP is now used by PlugX as a channel to move laterally in a compromised network.\n\nFor more information about Security Joes incident response services, email:\nresponse@securityjoes.com\n\n1\nhttps://attack.mitre.org/software/S0013/\n2\nhttps://documents.trendmicro.com/assets/white_papers/wp-operation-earth-berberoka.pdf\n\nThreat Intelligence & Incident Response Team\n3\n\n\n-----\n\n#### Technical Details\n\n##### Distribution\n\nPlugX is a notorious malware family in the Chinese cybercrime market. It is an old Remote\nAccess Tool (RAT) that has been used by several threat actors within different espionage\ncampaigns for years.\n\nThe means used by attackers to spread this threat may vary, however, lately it has been\nactively distributed in China by the gang Earth Berberoka using modified or fake installers\nof chat applications such as Telegram and Mimi to deceive users into executing malicious\ncode.\n\nAn example of this technique can be seen in Figure 1, which contains a piece of code\nadded to a Mimi installer to validate the type of operating system used by the victim and\ndeploy a threat compatible with the environment. These applications are usually written in\nthe JavaScript Framework Electron.\n\n_Figure 1. Snippet of code of the Electron APP Mimi modified to launch the malicious code store in the folder “deps”. The code_\n\n_also checks the type of operating system to deploy a compatible threat._\n\n##### Infection\n\nThis threat can be found for both x86 and x64 architectures. The behavior of each of the\nOS variants is almost the same, however, the level of obfuscation and some features are\nconsiderably different between both versions.\n\nThe x64 variant could be described as the most complete and up-to-date threat currently\navailable. It implements a new strategy to bypass the UAC by abusing the ICMLuaUtil\nElevated COM interface and also contains two additional plugins (Clipboard stealer and an\nRDP spreader). We couldn’t find a public analysis report that details these features.\n\nThreat Intelligence & Incident Response Team\n4\n\n\n-----\n\nIn contrast, the x86 source code has been left untouched for years. The only relevant\nchange that was seen during the analysis of the samples in question is an additional layer\nof encryption to hide a shellcode.\n\nTo better understand the way an infection occurs when using PlugX, we’ve divided the flow\nof the tool into 3 different components. The Loader DLL, the Shellcode and the Core DLL\n(see Figure 2). Each of these components is executed in a different manner and\naccomplishes different objectives during the attack. However, it is obligatory to have all of\nthem together in order to successfully complete an infection.\n\n_Figure 2. Main flow of an infection with the Windows backdoor PlugX._\n\nThe analysis of each of the components mentioned above is presented with all the\nrequired details in the following sub-sections.\n\nStage 1 – Loader DLL\n\nThis first stage consistently relies on the DLL Side-Loading[3] technique to execute the\nspiteful code and evade detection – On a recorded YouTube video[4] we’ve created, you can\nsee a live example of this technique.\n\nIn contrast to several other threat actors who usually use the same vulnerable file for all\ntheir attacks, PlugX operators use a high variety of trusted binaries which are vulnerable to\nDLL Side-Loading, including numerous anti-virus executables. This has been proven to be\neffective while infecting victims.\n\nThe number of files used to accomplish a successful infection may vary depending on its\nsettings. There have been a few documented attacks that contained only three files, and\nothers which had four. The main difference between both infections is the location of the\nconfiguration file used by the trojan during an attack. This configuration could be either a\nsingle XOR-encrypted file stored on disk or could be appended to the Shellcode; reducing\nthe number of artifacts in the disk.\n\n3 https://attack.mitre.org/techniques/T1574/002/\n4 https://www.youtube.com/watch?v=E2_DTQJjDYc\n\nThreat Intelligence & Incident Response Team\n5\n\n\n-----\n\nAs an example, in Figure 3, we compare two different attacks using PlugX. At the top, the\nthreat was configured to work by only using three files and at the bottom, it is using four\nfiles. The files containing the Shellcode are in green; in purple are the trusted binaries that\nare abused via DLL Side-Loading to run the malicious code, and in red are the Loader\nDLLs responsible of launching the Shellcode. In addition to this, in blue is an encrypted\nconfiguration file. It is present on disk only in the bottom example, since for the one at the\ntop; it is embedded into the Shellcode file “USOPrivate.dat”.\n\nI\n_Figure 3. Comparison between two different attacks of PlugX. At the top an attack using the 3 files and at the bottom an attack_\n\n_using 4 files._\n\nOnce a trusted application has been tricked to run a malicious library via DLL SideLoading, the malicious code starts. The main logic of this first stage can be summarized as\nfollows:\n\n  - Loader DLL looks for the Shellcode file in the same directory. This file contains the\ncode that will be injected into memory and executed.\n\n  - Memory is then allocated for the Shellcode file.\n\n  - The Shellcode file is mapped into the previously allocated memory.\n\n  - Memory permissions are set to allow the execution of the Shellcode.\n\n  - Shellcode is launched.\n\nDuring the analysis, we found both x86 and x64 versions implementing this behavior.\nWhat captured our attention is that threat actors neither obfuscated the Shellcode nor the\nLoader DLL on the 64bit binaries. The Shellcode is simply mapped into memory and\nexecuted without any additional modification and the Loader DLL can be easily extracted\nand analyzed using a disassembler. Due to the lack of protection in binaries written for the\n64bit architecture, both the Loader DLL and the Shellcode could be easily detected using\nsignatures such as YARA.\n\nThreat Intelligence & Incident Response Team\n6\n\n\n-----\n\n_Figure 4. Snippet of code taken from an unprotected x64 Loader DLL, responsible of launching the Shellcode for 64 bits_\n\n_binaries._\n\nOn the other hand, some of the analyzed x86 samples do contain some protections. One\nexample is an additional XOR-based encryption layer protecting the main Shellcode, which\nmakes it a little bit harder to track and detect.\n\nStage 2 – Shellcode\n\nThis stage contains the code responsible for decrypting and loading the malicious Core\nDLL into memory. In this stage, XOR-based encryption and LZNT1 compression are usually\nused by threat actors to protect the final payload.\n\nThe complexity of the encryption algorithm changes between forks. Some of them use a\nsimple single-byte-key XOR encryption while others implement more complex strategies to\ngenerate the keystream, such as the algorithm described within the Python code below\n(see Code 1), which uses a set of shift operations and additions to update the values of the\nkey.\n\nThis algorithm has been previously described and documented in several public reports [4,\n5], and it is hardcoded into the Shellcode and the Core DLL for both architectures.\n\nThreat Intelligence & Incident Response Team\n7\n\n\n-----\n\n```\nimport struct\ndef xor_decrypt(data):\n  \"\"\"\n  Decrypt PlugX payload and config\n  :param data: Encrypted data buffer\n  :return:\n  \"\"\"\n  key = struct.unpack('<I', data[0:4])[0]\n  key_a, key_b, key_c = key, key, key\n  result = bytes([])\n  for char in data:\n    key = (key + (key >> 3) - 0x11111111) & 0xFFFFFFFF\n    key_a = (key_a + (key_a >> 5) - 0x22222222) & 0xFFFFFFFF\n    key_b = (key_b - (key_b << 7) + 0x33333333) & 0xFFFFFFFF\n    key_c = (key_c - (key_c << 9) + 0x44444444) & 0xFFFFFFFF\n    result += bytes([char ^ ((key + key_a + key_b + key_c) & 0x000000FF)])\n  return result\n\n```\n_Code 1. Python implementation of the algorithm used by the analyzed PlugX samples to encrypt sensitive data._\n\nOnce the Core DLL is decrypted in memory and decompressed using the\n[RtlDecompressBuffer API, the Shellcode starts resolving the required DLLs and functions](https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/ntifs/nf-ntifs-rtldecompressbuffer)\nfor the malware to run. Finally, it modifies the PE header, replacing the default values with\na custom structure that uses the magic string “PLUG” written in memory as a Little-Endian\nsequence (see Figure 5), before passing the execution to the DLL. This process is probably\ndone to avoid being detected by several memory scanners that look for injected PE files in\nmemory. In this case, because the PE header is not found, such applications could classify\nthis memory region as data rather than code. Also, the string “PLUG” is checked several\ntimes during the execution of the Core DLL to determine the method used to launch the\nbinary (via Shellcode or direct execution).\n\n_Figure 5. Custom PE header used PlugX. The string PLUG is written in memory as a Little-Endian sequence._\n\nTo protect the code of the Shellcode, some x86 samples implement an additional layer of\nencryption that only modifies the first section. This protection mechanism relies on three\nparameters to decrypt the data; these parameters seem to be dynamically resolved by the\nbuilder when the payload is generated and are obfuscated by adding a large number of\nuseless instructions. The Python implementation of the encryption is presented below.\n\nThreat Intelligence & Incident Response Team\n8\n\n\n-----\n\n```\ndef x86_clean_shellcode(sc, add_value, xor_value, sub_value):\n  \"\"\"\n  Decrypt x86 shellcode\n  :param sc: Encrypted Shellcode\n  :param add_value: \n  :param xor_value: \n  :param sub_value: \n  :return:\n  \"\"\"\n  result = bytearray([])\n  for char in sc[:0x5E8]:\n    result += bytes([((((char + add_value) & 0xFF) ^ xor_value) - sub_value) & 0xFF])\n  return result + sc[0x5E8:]\n\n```\n_Code 2. Python implementation of the additional encryption algorithm implemented by some 32 bits PlugX samples to protect the_\n_Shellcode. Values add_value, xor_value and sub_value are 8-bit unsigned integers that are dynamically set by the attack builder_\n\n_to make detection more challenging._\n\nStage 3 – Core DLL\n\nThe main logic of the DLL is defined by parameters that are passed in the command line\nwhen the binary is launched, and the method used to execute the malicious artifact. This\nbehavior is set in the configuration of the attack.\n\nRight after starting the execution of the malicious code, its configuration is resolved, and it\nis loaded from a location that depends on the method used to launch the payload. If the\npayload was loaded using the Shellcode, this mode of operation is identified by comparing\nits magic numbers with the string “PLUG”, the configuration is obtained from a buffer\npassed as a parameter to the DLL or by reading the contents of a file called “boot.cfg“. If\nthe DLL was not executed by the shellcode, it will instead use a hardcoded configuration.\n\n_Figure 6. PLUG header validation to identify the method used to execute the DLL. If the magic numbers match the string_\n\n_“PLUG” it means that the DLL was launched by the shellcode._\n\nThen the threat creates the mutex; “DoInst“, if it is the x64 variant or “DoInstPrepare“ in\nthe case of a an x86 binary; and proceeds to copy files (the vulnerable exe, the Shellcode\nand the Shellcode Loader DLL) to the final location defined in the configuration file.\nImmediately after, it executes itself again launching the previously created files with\nadditional parameters in the command line. Finally, deletes the original files and kills the\ncurrent process.\n\n_Figure 7. New process spawned by the malware after copying its files to the installation folder. Additional parameters are passed_\n\n_in the command line to update the control flow of the attack._\n\nThreat Intelligence & Incident Response Team\n9\n\n\n-----\n\nExecution continues within the new process, however this time the control flow is changed\nbased on the first parameter that is passed in the command line. The description of the\nactions implemented by the trojan for each of the possible values of this parameter are\nlisted below.\n\nParameter value Description\n\n100 Sets persistence and bypasses UAC\n\n200 Injects Shellcode into a new svchost process\n\n201 Executes the main loop\n\n202 Executes variant of the main loop\n\n209 Start plugin inter-process communication via Windows pipes\n\n300 Remove itself from the machine\n\nParameter 100 - Persistence and UAC Bypass\n\nThe first action instigated by the attack right after copying its files to the folder defined in\nthe configuration is to check the user’s privileges in the system; if the user is already an\nadministrator, persistence can be set either by creating a new service or by setting a new\nkey in the registry hive SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run. However, if the\nuser is not an administrator the attack will try to bypass the UAC. The technique used to\naccomplish these changes notably between x64 and x86 variants. x64 binaries exploit the\nICMLuaUtil Elevated COM interface[5] while x86 binaries rely on the traditional sysprep\ntechnique[6]. In both cases, all these operations are triggered by the parameter 100 in the\ncommand-line. Additional details related to both techniques are presented below:\n\nICMLuaUtil Elevated COM interface exploitation\n\nThe mechanism implemented in the x64 variants to bypass the UAC is by far one of the\nmost interesting parts of this stage, being it is a complete standalone DLL that is\ndecrypted and injected into a new process.\n\nThe code is protected using the same basic XOR algorithm described in the Shellcode, and\nit is embedded in the data section of the Core DLL. To accomplish the injection of this\nmalicious code, the attack writes two different chunks of data in a suspended svchost\nprocess. The first chunk contains a small shellcode with the logic to decrypt, decompress,\nresolve Windows APIs and execute the code; whereas the second chunk consists of the\nencrypted payload to be finally executed.\n\nOnce this new DLL has been launched the following actions will commence:\n\n5\nhttps://www.elastic.co/guide/en/security/current/uac-bypass-via-icmluautil-elevated-com-interface.html\n6 https://blogs.jpcert.or.jp/en/2015/02/a-new-uac-bypass-method-that-dridex-uses.html\n\nThreat Intelligence & Incident Response Team\n10\n\n|Parameter value|Description|\n|---|---|\n|100|Sets persistence and bypasses UAC|\n|200|Injects Shellcode into a new svchost process|\n|201|Executes the main loop|\n|202|Executes variant of the main loop|\n|209|Start plugin inter-process communication via Windows pipes|\n|300|Remove itself from the machine|\n\n\n-----\n\n1. Terminates some processes related to the Chinese Antivirus 360 Total Security if\n\nthey are found running in the victim’s machine. Among all the different analyzed\nsamples, the only processes that are terminated are 360tray.exe, and\nZhuDongFangYu.exe.\n2. Launches an instance of the malicious code with elevated privileges by abusing the\n\nICMLuaUtil Elevated COM Interface [3]. The code used to accomplish this highly\nreassembles the proof of concept shared in the following repository[7].\n\n_Figure 8. Snippet of code containing the main logic implemented in the DLL to bypass the UAC by abusing the ICMLuaUtil_\n\n_COM Interface._\n\nTraditional Sysprep Bypass\n\nIn contrast to the method used by x64 binaries which work on the latest versions of\nWindows, this technique was developed just for Windows 7 systems and has been proven\nto be effective at escalating to administrative privileges without displaying the UAC\nwarning.\n\nIts main logic can be summarized as follows:\n\n1. PlugX drops a DLL to disk. This DLL can be found encrypted in the data section of\n\nthe main DLL, using the same XOR-based algorithm presented in the Shellcode\nsection.\n2. PlugX injects code into explorer.exe to move the dropped file to\n```\n    C:\\Windows\\System32\\sysprep\\cryptbase.dll.\n\n```\n7\nhttps://github.com/0xlane/BypassUAC/blob/master/BypassUAC_Dll/dllmain.cpp\n\nThreat Intelligence & Incident Response Team\n11\n\n\n-----\n\n3. `C:\\Windows\\System32\\sysprep\\sysprep.exe is executed and automatically loads the`\n\nmalicious DLL stored in the C:\\Windows\\System32\\sysprep\\cryptbase.dll with\nadministrative privileges.\n4. `C:\\Windows\\System32\\sysprep\\cryptbase.dll launches a new instance of PlugX with`\n\nadministrative privileges.\n\nParameter 200 - Process Injection\n\nOnce the trojan has obtained administrative privileges, it proceeds to execute the\noperations defined in the command line parameter 200. In this case, it initiates a basic\nprocess injection to hide the malicious code inside the memory of a new svchost process.\nThe injection technique is identical and used by x64 binaries to execute the DLL to bypass\nthe UAC, however in this case the content to be decrypted is the Core DLL. This injection is\nperformed for both x86 and x64 variants.\n\n_Figure 9. Process tree of the malicious code after obtaining the administrative privileges. The child process svchost spawned by_\n\n_the trojan executes the main logic. The child msiexec process starts the plugin operation, both svchost and msiexec processes_\n\n_communicate with each other via Windows pipe._\n\nParameter 201 - Main loop\n\nNow that the malicious code is hidden in the svchost process, it continues to execute all\nactions defined within parameter 201, which groups the core functionalities of the attack.\n\nIf the reader desires to get additional details about the inner workings of this threat for 32\nbits systems, there are plenty of public reports that explain this, [4, 5]. We won’t dig\nfurther into this version. Instead, we are going to focus this analysis on the x64 binaries\nwhich are the ones that contain the new components that have not been described before\nin any other report.\n\nContinuing with the analysis of the 64 bits variant, this stage basically creates different\nthreads to handle new layers of process injection, initialize the plugin logic, start the\nnetwork communications, lateral movement, keylogging, and clipboard stealing routines.\nThese threads are identified by a custom hardcoded string. Below is the information of\neach of the threads and their identifiers.\n\nThreat Intelligence & Incident Response Team\n12\n\n\n-----\n\n|Thread Name|Description|\n|---|---|\n|SiProc|If the sample was loaded by the Shellcode, it attempts to inject its code into a new child process msiexec. Value 209 is passed as a parameter in the command line, instructing this new process to handle the plugin logic, commands and results are shared via Windows pipes.|\n|KLProc|Starts keylogging logic, sample accomplishes that via the Windows API RegisterRawInputDevices and SetWindowsHookExW.|\n|CLProc|Starts clipboard stealer via the Windows API SetClipboardViewer.|\n|RDPPRoc|Starts lateral movement, via RDP shared folder tsclient.|\n|PlugProc|Loads additional plugins. Plugins are stored in disk encrypted with the same algorithm, and their name matches the REGEX [0-127].plg.|\n\n\nPlugins\n\nTo simplify the process of expanding its functionalities, this attack provides operators with\nthe option to add additional plugins. Within the context of this threat, plugins are specific\npieces of code that will be executed to perform certain actions. In contrast to other\nmalware families with this capability, PlugX does not exclusively require a complete PE file\nto be loaded as plugin, instead, it relies on simple functions hardcoded in the main\nprogram and on external PE files stored in disk, which are decrypted and executed in runtime.\n\nPlugins are initialized right after the main loop is started. During this process, PlugX first\ninstantiates a set of objects referencing the hardcoded plugins. Then, it creates a thread\nthat attempts to load all plugins available on the disk.\n\n_Figure 10. Snippet of code responsible of initializing the plugins. Plugins are initialized as objects containing several attributes_\n\n_such as an index, a timestamp, the function that will be called and a name._\n\nThreat Intelligence & Incident Response Team\n13\n\n\n-----\n\nWhen comparing this sample to the ones described in previous publications only two\nadditions were found, the ClipLog and the RDP plugins. In this article we are going to\nexplain these two additional findings, however, if the reader wants to get additional details\nrelated to the other plugins, we highly recommend reading this article[8] published by the\nCIRCL in 2013.\n\nName Timestamp\n\nDisk 0x20120325\n\nProcess 0x20120204\n\nService 0x20120117\n\nRegEdit 0x20120315\n\nNetstat 0x20120215\n\nNethood 0x20120213\n\nOption 0x20120128\n\nPortMap 0x20120325\n\nScreen 0x20120220\n\nShell 0x20120305\n\nTelnet 0x20120225\n\nSQL 0x20120323\n\nKeyLog 0x20120324\n\nClipLog 0x20190417\n\nRDP 0x20190428\n\nClipLog\n\nAccording to its timestamp, this piece of code was added to PlugX in 2019. Although\nadded 3 years ago, the absence of any publicly available analysis of this capability\ncaptured our attention during this research.\n\nAs its name suggests, its main functionality is to allow the trojan to steal the contents of\nthe victim’s clipboard. This was achieved by creating a new clipboard viewer via the\nWindows API SetClipBoardViewer. All the results of this operation are written to the file\nlog.hlp, which can be found in the root folder of the attack.\n\n8\nhttps://www.circl.lu/assets/files/tr-12/tr-12-circl-plugx-analysis-v1.pdf\n\nThreat Intelligence & Incident Response Team\n14\n\n|Name|Timestamp|\n|---|---|\n|Disk|0x20120325|\n|Process|0x20120204|\n|Service|0x20120117|\n|RegEdit|0x20120315|\n|Netstat|0x20120215|\n|Nethood|0x20120213|\n|Option|0x20120128|\n|PortMap|0x20120325|\n|Screen|0x20120220|\n|Shell|0x20120305|\n|Telnet|0x20120225|\n|SQL|0x20120323|\n|KeyLog|0x20120324|\n|ClipLog|0x20190417|\n|RDP|0x20190428|\n\n\n-----\n\n_Figure 11. Snippet of code used by PlugX to add an additional window into the chain of clipboard viewers. This allows the_\n\n_malware to be notified every time the content of the clipboard is changed._\n\nRDP\n\nLooking at its timestamp, this plugin was the latest addition in the arsenal and just like the\nClipLog module, it was not documented in any previous public report.\n\nIt was designed to spread the trojan inside the victim’s network once a machine has been\ncompromised. This is done by enumerating each of the available RDP shared folders\n“tsclient”, copying the malicious files (vulnerable executable, Loader DLL and Shellcode) to\nthe “ProgramData” folder in each of the remote systems and setting persistence via a VBS\nscript created in the Startup folder\n```\n\\tsclient\\C\\Users\\%s\\AppData\\Roaming\\Microsoft\\Windows\\StartMenu\\Programs\\Startup\\ of\n\n```\neach of the targeted devices.\n\nOnce the operation has been concluded, it creates a new file in\n```\nC:\\Users\\Public\\Documents\\desktop .ini to mark its correct execution. It is significant to\n\n```\nmention that this new file pretends to be a common Windows file to the non-trained eye,\nhowever, it can be detected by the additional space added before the extension.\n\nThe script used to accomplish persistence is hardcoded in the content of the Core DLL\nwithout any additional protection/obfuscation. It oversees commencing the threat by\nexecuting the vulnerable application, then it waits for one second and deletes the Loader\nDLL and the Shellcode. The content of this script is shown below:\n\nThreat Intelligence & Incident Response Team\n15\n\n\n-----\n\n```\n\"Set fso =\nCreateObject(\\\"Scripting.FileSystemObject\\\"):if(fso.FileExists(\\\"C:\\\\ProgramData\\\\USO\nPrivate.exe\\\")) Then:Set ws = CreateObject(\\\"Wscript.Shell\\\") :ws.run \\\"cmd /c start\nC:\\\\ProgramData\\\\USOPrivate.exe\\\",vbhide:Wscript.Sleep\n1000:Else:if(fso.FileExists(\\\"C:\\\\ProgramData\\\\log.dll\\\"))\nThen:fso.DeleteFile(\\\"C:\\\\ProgramData\\\\log.dll\\\"):fso.DeleteFile(\\\"C:\\\\ProgramData\\\\U\nSOPrivate.dat\\\"):End IF End IF\"\n\n```\n_Code 3. Visual Basic Script used by the PlugX x64 variant to set persistence on remote systems via RDP._\n\n#### Detection Opportunities\n\nThe following are some ideas that could be used by your security team to hunt this threat\nin your environment.\n\nWhat to look for:\n\n  - Suspicious svchost.exe processes spawning msiexec.exe as a child process.\n\n  - Processes spawned by dllhost.exe with arguments \"/Processid:{3E5FC7F9-9A51```\n    4367-9063-A120244FBEC7}\" and \"/Processid:{D2E7041B-2927-42FB-8E9F    7CE93B6DC937}\", this is a common behaviour when bypassing the UAC via ICMLuaUtil\n\n```\nElevated COM Interface [3].\n\n  - Suspicious HTTP, UDP, TCP traffic to remote servers on port 53.\n\n  - New DLLs written in C:\\Windows\\System32\\sysprep\\cryptbase.dll.\n\n  - New files created in disk that attach a space after the filename to masquerade\nthemselves as trusted files[9].\n\n#### Conclusions\n\nThe RDP and the ClipLog plugins are two new additions to the PlugX arsenal, allowing this\nRAT to move laterally within compromised networks and to steal data directly from the\nclipboard. According to its timestamp, both functionalities were added in the year 2019.\n\nThose features and the exploitation of the ICMLuaUtil Elevated COM interface to bypass the\nUAC, a technique discovered and documented in 2020, are the latest relevant updates\ndiscovered in the analyzed PlugX samples. They are also a clear sign of the gradual\nevolution of this threat over time, to catch up with the current Windows ecosystem.\n\n9\nhttps://attack.mitre.org/techniques/T1036/006/\n\nThreat Intelligence & Incident Response Team\n16\n\n\n-----\n\n#### Indicators of Compromise\n\nThis section contains different indicators of compromise gathered during this investigation.\nThey were all extracted from several attack configurations belonging to the PlugX fork\nexposed in this document.\n\nDomain Ports\n\nfuckeryoumm[.]nmb[.]bet 53 and 443\n\ntcp[.]wy01[.]com 53, 443\n\ntools[.]daji8[.]me 53, 443\n\na2[.]fafafazq[.]com 80\n\ntho[.]pad62[.]com 443\n\ntank[.]hja63[.]com 53\n\nwps[.]daj8[.]me 53\n\nwpsup[.]daj8[.]me 443\n\ntools[.]googleupdateinfo[.]com 53, 443\n\nfly[.]pad62[.]com 443\n\ntho[.]hja63[.]com 53\n\nhelpdesk[.]lnip[.]org 443\n\nwww[.]trendmicro-update[.]org 80, 443\n\nfuckchina[.]govnb[.]com 53, 80, 443\n\nwmi[.]ns01[.]us 80\n\nservices[.]darkhero[.]org 443\n\nmicrosafes[.]no-ip[.]org 53, 80, 443\n\nwmi[.]ns01[.]us 12345\n\nkr[.]942m[.]com 53, 80\n\nwww[.]92al[.]com 53\n\n101[.]55[.]29[.]17 80\n\nThreat Intelligence & Incident Response Team\n17\n\n|Domain|Ports|\n|---|---|\n|fuckeryoumm[.]nmb[.]bet|53 and 443|\n|tcp[.]wy01[.]com|53, 443|\n|tools[.]daji8[.]me|53, 443|\n|a2[.]fafafazq[.]com|80|\n|tho[.]pad62[.]com|443|\n|tank[.]hja63[.]com|53|\n|wps[.]daj8[.]me|53|\n|wpsup[.]daj8[.]me|443|\n|tools[.]googleupdateinfo[.]com|53, 443|\n|fly[.]pad62[.]com|443|\n|tho[.]hja63[.]com|53|\n|helpdesk[.]lnip[.]org|443|\n|www[.]trendmicro-update[.]org|80, 443|\n|fuckchina[.]govnb[.]com|53, 80, 443|\n|wmi[.]ns01[.]us|80|\n|services[.]darkhero[.]org|443|\n|microsafes[.]no-ip[.]org|53, 80, 443|\n|wmi[.]ns01[.]us|12345|\n|kr[.]942m[.]com|53, 80|\n|www[.]92al[.]com|53|\n|101[.]55[.]29[.]17|80|\n\n\n-----\n\n#### YARA Rules\n\nUse the rules provided in this section to detect PlugX in your environment.\n```\nrule win_x86_backdoor_plug_x_shellcode_loader_dll {\n meta:\n  author = \"Felipe Duarte, Security Joes\"\n  description = \"Detects the PlugX Shellcode Loader DLL for 32 bits systems\"\n  sha256_reference = \"5304d00250196a8cd5e9a81e053a886d1a291e4615484e49ff537bebecc13976\"\n strings: \n  // Code to set memory protections and launch shellcode\n  $opcode1 = { 8d ?? ?? 5? 6a 20 68 00 00 10 00 5? ff 15 ?? ?? ?? ?? 85 ?? 75 ?? 6a 43 e8 ?? ?? ?? ?? 83\nc? ?? ff d? 3d ?? ?? ?? ?? 7d ?? 85 ?? 74 ?? 6a 4a e8 ?? ?? ?? ?? 83 c? ?? }\n  // Strings required to resolve depencies to load and execute the shellcode\n  $str1 = \"kernel32\" nocase\n  $str2 = \"GetModuleFileNameW\"\n  $str3 = \"CreateFileW\"\n  $str4 = \"VirtualAlloc\"\n  $str5 = \"ReadFile\"\n  $str6 = \"VirtualProtect\"\n condition:\n  all of them\n}\nrule win_x64_backdoor_plug_x_shellcode_loader_dll {\n meta:\n  author = \"Felipe Duarte, Security Joes\"\n  description = \"Detects the PlugX Shellcode Loader DLL for 64 bits systems\"\n  sha256_reference = \"6b8ae6f01ab31243a5176c9fd14c156e9d5c139d170115acb87e1bc65400d54f\"\n strings:\n  // Code to get file name of the current module and replaces the extension to .dat\n  $opcode1 = { 4? 8d 1d ?? ?? ?? ?? 41 b8 00 20 00 00 33 c9 4? 8b d3 ff d0 4? 8b cb 89 44 ?? ?? ff 15 ??\n?? ?? ?? b9 64 00 00 00 8d 50 fd 33 f6 66 89 0c ?? 8d 50 fe b9 61 00 00 00 66 89 0c ?? 8d 50 ff 8b c0 66\n89 34 ?? 4? 8b 05 ?? ?? ?? ?? b9 74 00 00 00 66 89 0c ?? 4? 85 c0 75 ?? 4? 8b 05 ?? ?? ?? ?? 4? 85 c0 75\n?? 4? 8d 0d ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 4? 89 05 ?? ?? ?? ?? }\n  // Code to set memory protections and launch shellcode\n  $opcode2 = { 4? 8d 4c ?? ?? ba 00 00 10 00 41 b8 40 00 00 00 4? 8b cb ff d0 85 c0 74 ?? ff d3 83 c9 ff\nff 15 ?? ?? ?? ?? }\n  // Strings required to resolve depencies to load and execute the shellcode\n  $str1 = \"kernel32\" nocase\n  $str2 = \"GetModuleFileNameW\"\n  $str3 = \"CreateFileW\"\n  $str4 = \"VirtualAlloc\"\n  $str5 = \"ReadFile\"\n  $str6 = \"VirtualProtect\"\n condition:\n  all of them\n}\n\n```\nThreat Intelligence & Incident Response Team\n18\n\n\n-----\n\n```\nrule win_x86_backdoor_plug_x_shellcode {\n meta:\n  author = \"Felipe Duarte, Security Joes\"\n  description = \"Detects the PlugX Shellcode for 32 bits systems\"\n  sha256_reference = \"07ed636049be7bc31fb404da9cf12cff6af01d920ec245b4e087049bd9b5488d\"\n strings:\n  // Code of the decryption rutine\n  $opcode1 = { 8b ?? c1 e? 03 8d ?? ?? ?? ?? ?? ?? 8b ?? c1 e? 05 8d ?? ?? ?? ?? ?? ?? 8b ?? ?? c1 e? 07\nb? 33 33 33 33 2b ?? 01 ?? ?? 8b ?? ?? c1 e? 09 b? 44 44 44 44 2b ?? 01 ?? ?? 8b ?? ?? 8d ?? ?? 02 ?? ??\n02 ?? ?? 32 ?? ?? 88 ?? 4? 4? 75 ?? }\n  // Stack strings for VirtualAlloc\n  $opcode2 = { c7 8? ?? ?? ?? ?? 56 69 72 74 c7 8? ?? ?? ?? ?? 75 61 6c 41 c7 8? ?? ?? ?? ?? 6c 6c 6f 63\n88 ?? ?? ?? ?? ?? ff d? }\n condition:\n  all of them\n}\nrule win_x64_backdoor_plug_x_shellcode {\n meta:\n  author = \"Felipe Duarte, Security Joes\"\n  description = \"Detects the PlugX Shellcode for 64 bits systems\"\n  sha256_reference = \"07ed636049be7bc31fb404da9cf12cff6af01d920ec245b4e087049bd9b5488d\"\n strings:\n  // Code of the decryption rutine\n  $opcode1 = { 41 8b ?? 41 8b ?? c1 e? 03 c1 e? 07 45 8d ?? ?? ?? ?? ?? ?? 41 8b ?? c1 e? 05 45 8d ?? ??\n?? ?? ?? ?? b? 33 33 33 33 2b ?? 41 8b ?? 44 03 ?? c1 e? 09 b? 44 44 44 44 2b ?? 44 03 ?? 43 8d ?? ?? 41\n02 ?? 41 02 ?? 32 ?? ?? 88 ?? 4? ff c? 4? ff c? }\n  // Stack strings for VirtualAlloc\n  $opcode2 = { c6 4? ?? 56 c6 4? ?? 69 c6 4? ?? 72 c6 4? ?? 74 c6 4? ?? 75 c6 4? ?? 61 c6 4? ?? 6c c6 4?\n?? 41 c6 4? ?? 6c c6 4? ?? 6c c6 4? ?? 6f c6 4? ?? 63 }\n condition:\n  all of them\n}\nrule win_x86_backdoor_plug_x_uac_bypass {\n meta:\n  author = \"Felipe Duarte, Security Joes\"\n  description = \"Detects the PlugX UAC Bypass DLL for 32 bits systems\"\n  sha256_reference = \"9d51427f4f5b9f34050a502df3fbcea77f87d4e8f0cef29b05b543db03276e06\"\n strings:\n  // Main loop\n  $opcode1 = { 0f b7 ?? ?? ?? ?? ?? ?? 4? 66 85 ?? 75 ?? 8d ?? ?? ?? ?? ?? ?? 66 83 3? 00 74 ?? 5? e8 ??\n?? ?? ?? 5? c3 }\n  $str1 = \"kernel32\" nocase\n  $str2 = \"GetCommandLineW\"\n  $str3 = \"CreateProcessW\"\n  $str4 = \"GetCurrentProcess\"\n  $str5 = \"TerminateProcess\"\n condition:\n  all of them\n}\n\n```\nThreat Intelligence & Incident Response Team\n19\n\n\n-----\n\n```\nrule win_x64_backdoor_plug_x_uac_bypass {\n meta:\n  author = \"Felipe Duarte, Security Joes\"\n  description = \"Detects the PlugX UAC Bypass DLL for 64 bits systems\"\n  sha256_reference = \"547b605673a2659fe2c8111c8f0c3005c532cab6b3ba638e2cdcd52fb62296d3\"\n strings:\n  // 360tray.exe stack strings \n  $opcode1 = { 4? 83 e? 48 b? 33 00 00 00 4? 8d ?? ?? ?? c7 44 ?? ?? 2e 00 65 00 66 89 ?? ?? ?? b? 36 00\n00 00 c7 44 ?? ?? 78 00 65 00 66 89 ?? ?? ?? b? 30 00 00 00 66 89 ?? ?? ?? b? 74 00 00 00 66 89 ?? ?? ??\nb? 72 00 00 00 66 89 ?? ?? ?? b? 61 00 00 00 66 89 ?? ?? ?? b? 79 00 00 00 66 89 ?? ?? ?? 33 ?? 66 89 ??\n?? ?? e8 ?? ?? ?? ?? }\n  $str1 = \"Elevation:Administrator!new:%s\" wide ascii\n  $str2 = \"{3E5FC7F9-9A51-4367-9063-A120244FBEC7}\" wide ascii\n  $str3 = \"{6EDD6D74-C007-4E75-B76A-E5740995E24C}\" wide ascii\n  $str4 = \"CLSIDFromString\"\n  $str5 = \"CoGetObject\"\n condition:\n  all of them\n}\nrule win_x86_backdoor_plug_x_core {\n meta:\n  author = \"Felipe Duarte, Security Joes\"\n  description = \"Detects the PlugX Core DLL for 32 bits systems\"\n  sha256_reference = \"fde1a930c6b12d7b00b6e95d52ce1b6536646a903713b1d3d37dc1936da2df88\"\n strings:\n  // Decryption routine \n  $opcode1 = { 8b ?? ?? 8b ?? c1 e? 03 8d ?? ?? ?? ?? ?? ?? 8b ?? c1 e? 05 8d ?? ?? ?? ?? ?? ?? 8b ?? c1\ne? 07 b? 33 33 33 33 2b ?? 8b ?? ?? 03 ?? c1 e? 09 b? 44 44 44 44 2b ?? 01 ?? ?? 8d ?? ?? 02 ?? 02 ?? ??\n89 ?? ?? 8b 5? ?? 32 ?? 32 4? ff 4? ?? 88 ?? ?? 75 ?? 5? }\n  $str1 = \"Mozilla/4.0 (compatible; MSIE \" wide ascii\n  $str2 = \"X-Session\" ascii\n  $str3 = \"Software\\\\CLASSES\\\\FAST\" wide ascii\n  $str4 = \"KLProc\"\n  $str5 = \"OlProcManager\"\n  $str6 = \"JoProcBroadcastRecv\"\n condition:\n  all of them\n}\n\n```\nThreat Intelligence & Incident Response Team\n20\n\n\n-----\n\n```\nrule win_x64_backdoor_plug_x_core {\n meta:\n  author = \"Felipe Duarte, Security Joes\"\n  description = \"Detects the PlugX Core DLL for 64 bits systems\"\n  sha256_reference = \"af9cb318c4c28d7030f62a62f561ff612a9efb839c6934ead0eb496d49f73e03\"\n strings:\n  // Decryption routine \n  $opcode1 = { 41 8b ?? 8b ?? 4? ff c? c1 e? 03 c1 e? 07 45 8d ?? ?? ?? ?? ?? ?? 41 8b ?? c1 e? 05 45 8d\n?? ?? ?? ?? ?? ?? b? 33 33 33 33 2b ?? 8b ?? 03 ?? c1 e? 09 b? 44 44 44 44 2b ?? 03 ?? 43 8d ?? ?? 02 ??\n40 02 ?? 43 32 ?? ?? ?? 4? ff c? 41 88 ?? ?? 75 ?? }\n  $str1 = \"Mozilla/4.0 (compatible; MSIE \" wide ascii\n  $str2 = \"X-Session\" wide ascii\n  $str3 = \"Software\\\\CLASSES\\\\FAST\" wide ascii\n  $str4 = \"KLProc\"\n  $str5 = \"OlProcManager\"\n  $str6 = \"JoProcBroadcastRecv\"\n condition:\n  all of them\n}\n\n#### MITRE ATT&CK Matrix\n\n```\nTactic Technique Sub-technique\n\nTA0001: Initial T1566.002: Spearphishing\nT1566: Phishing\nAccess Link\n\nT1059: Command and Scripting\nTA0002: Execution T1059.007: JavaScript\nInterpreter\n\nT1059: Command and Scripting\nTA0002: Execution T1059.005: Visual Basic\nInterpreter\n\nT1559: Inter-Process T1559.001: Component\nTA0002: Execution\nCommunication Object Model\n\nTA0002: Execution T1569: System Services T1569.002: Service Execution\n\nTA0002: Execution T1204: User Execution T1204.002: Malicious File\n\nT1547.001: Registry Run Keys\n\nTA0003: Persistence [T1547: Boot or Logon Autostart ]\n\nExecution / Startup Folder\n\nTA0003: Persistence [T1543: Create or Modify System ] T1543.003: Windows Service\n\nProcess\n\nTA0004: Privilege T1548: Abuse Elevation Control T1548.002: Bypass User\nEscalation Mechanism Account Control\n\nTA0004: Privilege T1543: Create or Modify System\n\nT1543.003: Windows Service\n\nEscalation Process\n\nTA0005: Defense T1140: Deobfuscate/Decode Files\nEvasion or Information\n\nThreat Intelligence & Incident Response Team\n21\n\n|Tactic|Technique|Sub-technique|\n|---|---|---|\n|TA0001: Initial Access|T1566: Phishing|T1566.002: Spearphishing Link|\n|TA0002: Execution|T1059: Command and Scripting Interpreter|T1059.007: JavaScript|\n|TA0002: Execution|T1059: Command and Scripting Interpreter|T1059.005: Visual Basic|\n|TA0002: Execution|T1559: Inter-Process Communication|T1559.001: Component Object Model|\n|TA0002: Execution|T1569: System Services|T1569.002: Service Execution|\n|TA0002: Execution|T1204: User Execution|T1204.002: Malicious File|\n|TA0003: Persistence|T1547: Boot or Logon Autostart Execution|T1547.001: Registry Run Keys / Startup Folder|\n|TA0003: Persistence|T1543: Create or Modify System Process|T1543.003: Windows Service|\n|TA0004: Privilege Escalation|T1548: Abuse Elevation Control Mechanism|T1548.002: Bypass User Account Control|\n|TA0004: Privilege Escalation|T1543: Create or Modify System Process|T1543.003: Windows Service|\n|TA0005: Defense Evasion|T1140: Deobfuscate/Decode Files or Information||\n\n\n-----\n\n|TA0005: Defense Evasion|T1564: Hide Artifacts|T1564.001: Hidden Files and Directories|\n|---|---|---|\n|TA0005: Defense Evasion|T1574: Hijack Execution Flow|T1574.002: DLL Side-Loading|\n|TA0005: Defense Evasion|T1562: Impair Defenses|T1562.001: Disable or Modify Tools|\n|TA0005: Defense Evasion|T1070: Indicator Removal on Host|T1070.004: File Deletion|\n|TA0005: Defense Evasion|T1036: Masquerading|T1036.004: Masquerade Task or Service|\n|TA0005: Defense Evasion|T1036: Masquerading|T1036.005: Match Legitimate Name or Location|\n|TA0005: Defense Evasion|T1112: Modify Registry||\n|TA0005: Defense Evasion|T1027: Obfuscated Files or Information|T1027.002: Software Packing|\n|TA0005: Defense Evasion|T1055: Process Injection|T1055.012: Process Hollowing|\n|TA0007: Discovery|T1046: Network Service Discovery||\n|TA0007: Discovery|T1135: Network Share Discovery||\n|TA0007: Discovery|T1057: Process Discovery||\n|TA0007: Discovery|T1012: Query Registry||\n|TA0007: Discovery|T1018: Remote System Discovery||\n|TA0007: Discovery|T1082: System Information Discovery||\n|TA0007: Discovery|T1016: System Network Configuration Discovery||\n|TA0007: Discovery|T1049: System Network Connections Discovery||\n|TA0007: Discovery|T1007: System Service Discovery||\n|TA0008: Lateral Movement|T1021: Remote Services|T1021.001: Remote Desktop Protocol|\n|TA0009: Collection|T1119: Automated Collection||\n|TA0009: Collection|T1115: Clipboard Data||\n\n\nThreat Intelligence & Incident Response Team\n22\n\n\n-----\n\n|TA0009: Collection|T1005: Data from Local System|Col3|\n|---|---|---|\n|TA0009: Collection|T1056: Input Capture|T1056.001: Keylogging|\n|TA0009: Collection|T1113: Screen Capture||\n|TA0011: Command and Control|T1132: Data Encoding|T1132.001: Standard Encoding|\n|TA0011: Command and Control|T1001: Data Obfuscation|T1001.003: Protocol Impersonation|\n|TA0011: Command and Control|T1573: Encrypted Channel|T1573.001: Symmetric Cryptography|\n|TA0011: Command and Control|T1105: Ingress Tool Transfer||\n|TA0011: Command and Control|T1095: Non-Application Layer Protocol||\n|TA0011: Command and Control|T1090: Proxy|T1090.002: External Proxy|\n|TA0010: Exfiltration|T1041: Exfiltration Over C2 Channel||\n\n\nThreat Intelligence & Incident Response Team\n23\n\n\n-----\n\n#### References\n\n\n\n[1] [https://malpedia.caad.fkie.fraunhofer.de/details/win.plugx](https://malpedia.caad.fkie.fraunhofer.de/details/win.plugx)\n\n\n\n[2] [https://www.elastic.co/guide/en/security/current/uac-bypass-via-icmluautil-elevated-](https://www.elastic.co/guide/en/security/current/uac-bypass-via-icmluautil-elevated-com-interface.html)\ncom-interface.html\n\n\n\n[3] https://vms.drweb.com/virus/?i=21512304\n\n\n\n[4] https://www.circl.lu/assets/files/tr-12/tr-12-circl-plugx-analysis-v1.pdf\n\n\n\n[5] [https://blogs.jpcert.or.jp/en/2015/02/a-new-uac-bypass-method-that-dridex-](https://blogs.jpcert.or.jp/en/2015/02/a-new-uac-bypass-method-that-dridex-uses.html)\nuses.html\n\n[[6] https://documents.trendmicro.com/assets/white_papers/wp-operation-earth-](https://documents.trendmicro.com/assets/white_papers/wp-operation-earth-berberoka.pdf)\nberberoka.pdf\n\nThreat Intelligence & Incident Response Team\n24\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://secjoes-reports.s3.eu-central-1.amazonaws.com/Dissecting+PlugX+to+Extract+Its+Crown+Jewels.pdf"
    ],
    "report_names": [
        "Dissecting+PlugX+to+Extract+Its+Crown+Jewels.pdf"
    ],
    "threat_actors": [
        {
            "id": "5ffe400c-6025-44c2-9aa1-7c34a7a192b0",
            "created_at": "2023-01-06T13:46:38.469688Z",
            "updated_at": "2025-03-27T02:00:02.84172Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "Moafee",
                "BRONZE OVERBROOK",
                "G0017",
                "G0002",
                "Shallow Taurus"
            ],
            "source_name": "MISPGALAXY:DragonOK",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7ebda3c6-1789-4d84-97cf-47fb18a0cb28",
            "created_at": "2022-10-25T15:50:23.78829Z",
            "updated_at": "2025-03-27T02:00:55.547275Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "DragonOK"
            ],
            "source_name": "MITRE:DragonOK",
            "tools": [
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "60d9c778-488b-459e-a2f6-9e48c607ba45",
            "created_at": "2022-10-25T16:47:55.606462Z",
            "updated_at": "2025-03-27T02:05:17.281676Z",
            "deleted_at": null,
            "main_name": "BRONZE OVERBROOK",
            "aliases": [
                "DragonOK ",
                "Samurai Panda ",
                "Temp.DragonOK ",
                "Danti "
            ],
            "source_name": "Secureworks:BRONZE OVERBROOK",
            "tools": [
                " DDKONG",
                " HelloBridge",
                " IsSpace",
                " NFLog Trojan",
                " PLAINTEE",
                " PlugX",
                " Rambo",
                "Aveo"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9faf32b7-0221-46ac-a716-c330c1f10c95",
            "created_at": "2022-10-25T16:07:23.652281Z",
            "updated_at": "2025-03-27T02:02:09.908624Z",
            "deleted_at": null,
            "main_name": "Gallium",
            "aliases": [
                "Alloy Taurus",
                "Granite Typhoon",
                "Phantom Panda"
            ],
            "source_name": "ETDA:Gallium",
            "tools": [
                "Agentemis",
                "BlackMould",
                "CHINACHOPPER",
                "China Chopper",
                "Chymine",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "Gh0stCringe RAT",
                "HTran",
                "HUC Packet Transmit Tool",
                "LaZagne",
                "Mimikatz",
                "NBTscan",
                "PingPull",
                "Plink",
                "Poison Ivy",
                "PsExec",
                "PuTTY Link",
                "QuarkBandit",
                "Quasar RAT",
                "QuasarRAT",
                "Reshell",
                "SPIVY",
                "SinoChopper",
                "SoftEther VPN",
                "Sword2033",
                "WCE",
                "WinRAR",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Yggdrasil",
                "cobeacon",
                "nbtscan",
                "netcat",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7bf3ffe5-09ba-4378-8ea4-a6d748a494fd",
            "created_at": "2022-10-25T15:50:23.264584Z",
            "updated_at": "2025-03-27T02:00:55.414817Z",
            "deleted_at": null,
            "main_name": "GALLIUM",
            "aliases": [
                "GALLIUM",
                "Granite Typhoon"
            ],
            "source_name": "MITRE:GALLIUM",
            "tools": [
                "ipconfig",
                "cmd",
                "China Chopper",
                "PoisonIvy",
                "at",
                "PlugX",
                "PingPull",
                "BlackMould",
                "Mimikatz",
                "PsExec",
                "HTRAN",
                "NBTscan",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c87ee2df-e528-4fa0-bed6-6ed29e390688",
            "created_at": "2023-01-06T13:46:39.150432Z",
            "updated_at": "2025-03-27T02:00:03.008665Z",
            "deleted_at": null,
            "main_name": "GALLIUM",
            "aliases": [
                "Red Dev 4",
                "Alloy Taurus",
                "Granite Typhoon"
            ],
            "source_name": "MISPGALAXY:GALLIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "452d2d74-e812-45d6-b0fe-b8a6cc4ebd01",
            "created_at": "2022-10-25T16:07:23.562676Z",
            "updated_at": "2025-03-27T02:02:09.865955Z",
            "deleted_at": null,
            "main_name": "Earth Berberoka",
            "aliases": [
                "GamblingPuppet"
            ],
            "source_name": "ETDA:Earth Berberoka",
            "tools": [
                "Agent.dhwf",
                "AngryRebel",
                "AsyncRAT",
                "CinaRAT",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "Kaba",
                "Korplug",
                "Moudour",
                "Mydoor",
                "PCRat",
                "PlugX",
                "PuppetLoader",
                "Quasar RAT",
                "QuasarRAT",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "Xamtrav",
                "Yggdrasil",
                "oRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1691c25f-1aa4-4168-8ce2-7aa8f23246e7",
            "created_at": "2024-06-04T02:03:07.724221Z",
            "updated_at": "2025-03-27T02:05:17.284601Z",
            "deleted_at": null,
            "main_name": "BRONZE PRESIDENT",
            "aliases": [
                "Mustang Panda ",
                "Red Lich ",
                "Temp.Hex ",
                "HoneyMyte "
            ],
            "source_name": "Secureworks:BRONZE PRESIDENT",
            "tools": [
                " Cobalt Strike",
                " ORat",
                " PlugX",
                " RCSession",
                "China Chopper"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b69037ec-2605-4de4-bb32-a20d780a8406",
            "created_at": "2023-01-06T13:46:38.790766Z",
            "updated_at": "2025-03-27T02:00:02.919758Z",
            "deleted_at": null,
            "main_name": "MUSTANG PANDA",
            "aliases": [
                "TEMP.HEX",
                "TA416",
                "TANTALUM",
                "Twill Typhoon",
                "Earth Preta",
                "Stately Taurus",
                "LuminousMoth",
                "Polaris",
                "BRONZE PRESIDENT",
                "HoneyMyte",
                "Red Lich"
            ],
            "source_name": "MISPGALAXY:MUSTANG PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9baa7519-772a-4862-b412-6f0463691b89",
            "created_at": "2022-10-25T15:50:23.354429Z",
            "updated_at": "2025-03-27T02:00:55.45162Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Mustang Panda",
                "TA416",
                "RedDelta",
                "BRONZE PRESIDENT"
            ],
            "source_name": "MITRE:Mustang Panda",
            "tools": [
                "Cobalt Strike",
                "RCSession",
                "NBTscan",
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "340d1673-0678-4e1f-8b75-30da2f65cc80",
            "created_at": "2022-10-25T16:07:23.552036Z",
            "updated_at": "2025-03-27T02:02:09.85925Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "Bronze Overbrook",
                "Shallow Taurus"
            ],
            "source_name": "ETDA:DragonOK",
            "tools": [
                "Agent.dhwf",
                "CT",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Gen:Trojan.Heur.PT",
                "HTran",
                "HUC Packet Transmit Tool",
                "HelloBridge",
                "IsSpace",
                "KHRAT",
                "Kaba",
                "Korplug",
                "Mongall",
                "NFlog",
                "NewCT",
                "NfLog RAT",
                "PlugX",
                "Poison Ivy",
                "Rambo",
                "RedDelta",
                "SPIVY",
                "Sogu",
                "SysGet",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TidePool",
                "Xamtrav",
                "brebsd",
                "ffrat",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2ee03999-5432-4a65-a850-c543b4fefc3d",
            "created_at": "2022-10-25T16:07:23.882813Z",
            "updated_at": "2025-03-27T02:02:10.0116Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Bronze President",
                "Camaro Dragon",
                "Earth Preta",
                "HoneyMyte",
                "Mustang Panda",
                "Operation SMUGX",
                "Operation SmugX",
                "PKPLUG",
                "Red Lich",
                "Stately Taurus",
                "TEMP.Hex"
            ],
            "source_name": "ETDA:Mustang Panda",
            "tools": [
                "9002 RAT",
                "AdFind",
                "Agent.dhwf",
                "Agentemis",
                "CHINACHOPPER",
                "China Chopper",
                "Chymine",
                "ClaimLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "DCSync",
                "DOPLUGS",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Farseer",
                "Gen:Trojan.Heur.PT",
                "HOMEUNIX",
                "Hdump",
                "HenBox",
                "HidraQ",
                "Hodur",
                "Homux",
                "HopperTick",
                "Hydraq",
                "Impacket",
                "Kaba",
                "Korplug",
                "LadonGo",
                "MQsTTang",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "NBTscan",
                "NetSess",
                "Netview",
                "Orat",
                "POISONPLUG.SHADOW",
                "PUBLOAD",
                "PVE Find AD Users",
                "PlugX",
                "Poison Ivy",
                "PowerView",
                "QMAGENT",
                "RCSession",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Sogu",
                "TIGERPLUG",
                "TONEINS",
                "TONESHELL",
                "TVT",
                "TeamViewer",
                "Thoper",
                "TinyNote",
                "WispRider",
                "WmiExec",
                "XShellGhost",
                "Xamtrav",
                "Zupdax",
                "cobeacon",
                "nbtscan",
                "nmap",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2664d6f5-f918-4978-87f8-f6afad7402c6",
            "created_at": "2023-01-06T13:46:39.393669Z",
            "updated_at": "2025-03-27T02:00:03.073942Z",
            "deleted_at": null,
            "main_name": "Earth Berberoka",
            "aliases": [
                "GamblingPuppet"
            ],
            "source_name": "MISPGALAXY:Earth Berberoka",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041821,
    "ts_creation_date": 1662985990,
    "ts_modification_date": 1662985990,
    "files": {
        "pdf": "https://archive.orkl.eu/3734c84bc7f9cd852ec8a678d9717bd91a25c762.pdf",
        "text": "https://archive.orkl.eu/3734c84bc7f9cd852ec8a678d9717bd91a25c762.txt",
        "img": "https://archive.orkl.eu/3734c84bc7f9cd852ec8a678d9717bd91a25c762.jpg"
    }
}