{
    "id": "095e161e-e65a-42b5-b69b-3ae629bc503c",
    "created_at": "2023-01-12T15:07:26.044091Z",
    "updated_at": "2025-03-27T02:06:09.568437Z",
    "deleted_at": null,
    "sha1_hash": "b3d7e0184572d7c4ac7d3da6c8ca7ad0085c1463",
    "title": "2019-05-09 - Strange Bits- HTML Smuggling and GitHub Hosted Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T01:26:43Z",
    "file_modification_date": "2022-05-28T01:26:43Z",
    "file_size": 928248,
    "plain_text": "# Strange Bits: HTML Smuggling and GitHub Hosted Malware\n\n**[gdatasoftware.com/blog/2019/05/31695-strange-bits-smuggling-malware-github](https://www.gdatasoftware.com/blog/2019/05/31695-strange-bits-smuggling-malware-github)**\n\n05/09/2019\n\nG DATA Blog\nSometimes we see odd stuff, like malware that employs a technique called \"HTML Smuggling\". Also, malware on GitHub\nseems to be a thing these days.\n\n## \"That's strange...\"\n\n_Many important discoveries do not start with a shouting of „Eureka” anymore, as they did in the days of old. Instead, the_\n_most intriguing bits of modern research will at some point contain the phrase “That’s strange…”, followed by more_\n_prodding and poking and – hopefully – a lightbulb moment. This series that we call \"Strange Bits\" contains many findings_\n_that struck our analysts as odd, either because they do not seem to make any sense at the time or because a malicious_\n_program exhibits behaviors that none of us have seen before. Maybe these findings will spark ideas in other fellow_\n_researchers – maybe those findings are just what it says on the tin: Strange…._\n\n### DanaBot loader uses HTML smuggling\n\nThis email has an unusual way to store contained malware. The email[1] displays polish text which prompts the user to\nclick on a download link. The translated text says \"This file can not be previewed. You can download the file.\"\n\n\nThe <a> tag for this link has a download attribute with the name of the dropped ZIP archive:\n**dokumentacja_28380.zip[2]. However, the referenced data in the href attribute is not downloaded from a URL but saved**\n[as a base64 string using the data URI scheme. This is also called HTML smuggling (thanks to](https://outflank.nl/blog/2018/08/14/html-smuggling-explained/) [Rich Warren who gave me](https://twitter.com/buffaloverflow)\na hint to the blog post).\n\n\n-----\n\nThe dropped ZIP archive contains a file named dokumentacja_28380.vbe[3]. Despite its file extension it is not encoded\nbut a plain VBScript. The obfuscated script retrieves a PowerShell command which downloads DanaBot[4] to the\n%TEMP% folder and executes it.\n\n### GitHub repositories host coinminer malware and settings as base64 strings\n\n\n-----\n\nThe GitHub user errorsysteme and their repositories were taken down after G DATA researchers discovered that they\nhosted malware. The repositories were discovered via a downloader sample[5].\n\nThe user has two repositories, both contain text files with base64 strings of PE binaries and configuration files. The\nrepository wask only contains a file named data_lssas[6]. This file is downloaded and executed intially and will in turn\nobtain and install files and settings from the base repository.\n\n\n-----\n\n\"base\" repository\n\n\nThe contents of the\n\nFile types for files in\n\n\nthe \"base\" repository after decoding the base64 strings\n[The PE files named WerFault64[7] and WerFault86[8] are modified versions of the Non-Sucking Service Manager](https://nssm.cc/)\n(NSSM). The file properties and icons have been changed to imitate Microsoft's actual WerFault.exe which is used for\nerror reporting. The modified NSSM is used to install malware as service on the system.\n\nA file named parameters contains the settings for the coinminer malware.\n\n\n-----\n\nThe actual coinminer is the files data_cash64[9] and data_cash86[10] in the base repository.\n\n### Referenced Samples\n\n**Description** **Filename** **SHA256**\n\n\n\n[1] DanaBot\nLoader\nEmail\n\n[2] DanaBot\nLoader ZIP\narchive\n\n[3] DanaBot\nLoader\nVBScript\n\n[4] DanaBot\nPayload\n\n[5] Initial\nGitHub\nmalware\ndownloader\n\n[6] GitHub\ndownloader\nin wask\nrepository\n\n[7] Modified\nNSSM 64\nbit version\n\n[8] Modified\nNSSM 32\nbit version\n\n[9]\nCoinminer\n64 bit\nversion\n\n\ndde37964ab9f749e1c48a88202ad6c5fd03bd2c82e67736e42fc02fe912be6ba\n\ndokumentacja_28380.zip f4d1a4ce0ad334b31aa444ab9ced0d9d1eb581f889f3dbcfc1050eea474ad3cf\n\ndokumentacja_28380.vbe 0222fecff6c56e7af6f1502328478283c46e7a243ef2edcac466c2acda5e3eb9\n\nDbBf bfce42e325a9b999d1630a7ccc27ac8260104fb47bfc768637e2a2a687b65855\n\n4b4c45569b1b7c3c114a633ec0a54864cd91fd99bea2645803d23e78f9fcd81c\n\ndata_lssas 0075b6e78cebc1ed63a495918620aa7220ddabf7c9e501bc840d724ce930d2d3\n\nWerFault64 3335ec57681b238846e0d19a3459dc739d11dfaf36722b7f19e609a96b97ad92\n\nWerFault86 2f979194413c1b40a9d11bc4031d1672cd445d64b60343f6d308e4df0d2bdc6b\n\ndata_cash64 c3d982038039828f201a93b323b2b76f8e0db20a81aee89334afa22a4c83f36f\n\n\n-----\n\n**Description** **Filename** **SHA256**\n\n\n\n[10]\nCoinminer\n32 bit\nversion\n\n**Karsten Hahn**\n\n\ndata_cash86 8521c866fd37499631e6e1b0902a21e555e565d609bb6e2402eb86dec8743fa9\n\n\nMalware Analyst\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-05-09 - Strange Bits- HTML Smuggling and GitHub Hosted Malware.pdf"
    ],
    "report_names": [
        "2019-05-09 - Strange Bits- HTML Smuggling and GitHub Hosted Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536046,
    "ts_updated_at": 1743041169,
    "ts_creation_date": 1653701203,
    "ts_modification_date": 1653701203,
    "files": {
        "pdf": "https://archive.orkl.eu/b3d7e0184572d7c4ac7d3da6c8ca7ad0085c1463.pdf",
        "text": "https://archive.orkl.eu/b3d7e0184572d7c4ac7d3da6c8ca7ad0085c1463.txt",
        "img": "https://archive.orkl.eu/b3d7e0184572d7c4ac7d3da6c8ca7ad0085c1463.jpg"
    }
}