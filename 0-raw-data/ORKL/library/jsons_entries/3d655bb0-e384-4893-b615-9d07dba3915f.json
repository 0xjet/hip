{
    "id": "3d655bb0-e384-4893-b615-9d07dba3915f",
    "created_at": "2023-01-12T15:04:30.358704Z",
    "updated_at": "2025-03-27T02:05:59.477054Z",
    "deleted_at": null,
    "sha1_hash": "e60a1ed6e6ffe993992a026045e170e5b4ea71a5",
    "title": "2017-07-25 - HawkEye Credential Theft Malware Distributed in Recent Phishing Campaign",
    "authors": "",
    "file_creation_date": "2022-05-28T15:19:14Z",
    "file_modification_date": "2022-05-28T15:19:14Z",
    "file_size": 263893,
    "plain_text": "# HawkEye Credential Theft Malware Distributed in Recent Phishing Campaign\n\n**[fireeye.com/blog/threat-research/2017/07/hawkeye-malware-distributed-in-phishing-campaign.html](https://www.fireeye.com/blog/threat-research/2017/07/hawkeye-malware-distributed-in-phishing-campaign.html)**\n\n## Threat Research Blog\n\nJuly 25, 2017 | by [Swapnil Patil,](https://www.fireeye.com/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/swapnil-patil) [Yogesh Londhe](https://www.fireeye.com/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/yogesh-londhe)\n[Malware](https://www.fireeye.com/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/malware)\n\n[Phishing](https://www.fireeye.com/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/phishing)\n\nA wide variety of threat actors began distributing HawkEye malware through high-volume\nemail campaigns after it became available for purchase via a public-facing website. The\nactors behind the phishing campaigns typically used email themes based on current events\nand media reports that would pique user interests, with the “Subject” line typically containing\nsomething about recent news. Although HawkEye malware has several different capabilities,\nit is most often associated with credential theft.\n\nIn the middle of June, we observed a phishing campaign involving the distribution HawkEye\nmalware. The threat actors behind this campaign are not targeting any specific group of\nindustries or any specific region.\n\n**Infection Vector & Execution**\n\n\n-----\n\nFigure 1 shows a sample phishing email used by HawkEye operators in this latest campaign.\nThe message is designed to entice recipients to open the attachment. In this most recent\ncampaign, the phishing email contained a DOCX attachment, and the attackers named the\ndocument appropriately so the recipient believed it involved a recent transaction or invoice.\n\nFigure 1: Sample phishing email\n\nAs seen in Figure 2, the deployment of the malware has several stages of execution,\nincluding the following:\n\n1. Phishing email containing a malicious DOCX file received by victim.\n2. DOCX file uses an OLE object, which contains an embedded Microsoft Intermediate\n\nLanguage (MSIL) executable. The MSIL file, or HawkEye malware, is dropped into the\n%temp% folder. The malware has an encrypted resource section, which contains\nadditional payloads such as a password extraction tool and a decoy PDF document.\n3. On execution, HawkEye drops copies itself to the %AppData% folder with a random file\n\nname.\n4. The decoy PDF file is launched from the %temp% location.\n5. An XML file is created in the %temp% folder with a random file name. This XML file\n\ncontains configuration details for scheduling a Windows task to execute during the user\nlogin process.\n6. For the sample analyzed, the malware is injected into VBC.exe (a Visual Basic\n\nCommand Line Compiler). The injected code has data stealing capabilities and is\ndesigned to extract passwords from email clients and web browsers.\n\n\n-----\n\nFigure 2: Infection Vector and Execution\n\n**Initial Payload: DOCX File**\n\nIn the observed campaign, the actors used an embedded OLE object to deliver the payload\nto the victim’s machine. The malicious payload, HawkEye, is embedded in the DOCX file and\ndropped in the %temp% folder after the victim double-clicks on the object (Figure 3).\n\n\n-----\n\nFigure 3: Embedded OLE Object\n\n**HawkEye Analysis**\n\nThe HawkEye malware is primarily used for credential theft and is often combined with\nadditional tools to extract passwords from email and web browser applications. These\nadditional tools are contained in an encrypted resource section of the binary.\n\nThe HawkEye malware is capable of the following:\n\n1. Email password stealing\n2. Web browser password stealing\n3. Keylogging and taking screenshots\n4. Bitcoin wallet theft\n5. USB propagation\n6. Internet download manager stealing\n7. JDownloader password stealing\n\n\n-----\n\n8. Anti-virus checking\n9. Firewall checking\n\nAfter initial checks and system enumeration, HawkEye sends the following data to the\ncommand and control (C2) server:\n\nServer Name\nKeylogger Enabled\nClipboard-Logger Enabled\nStealers Enabled\nLocal Date and Time\nInstalled Language\nOperating System\nInternal IP Address\nExternal IP Address\nInstalled Anti-Virus\nInstalled Firewall\n\n**USB Propagation and Bitcoin Wallet Theft**\n\nAlong with its ability to steal sensitive information, HawkEye is capable of spreading through\nUSB or removeable drives and can also steal Bitcoin wallets, as seen in Figure 4.\n\nFigure 4 : USB spreading and Bitcoin Stealing\n\n**Encrypted Resource Section**\n\nThe HawkEye malware in this campaign contained encrypted resources sections, which add\nfunctionality that enables the attackers to exfiltrate more data. FireEye observed the same\npattern in previous HawkEye campaigns. The encrypted data is decrypted at run time and\nthen injected in to the target process, vbc.exe. The encryption logic used is a custom\nalgorithm and varies with the campaign. Figure 5 shows an example of the custom\nencryption algorithm.\n\n\n-----\n\nFigure 5: Custom decryption routine\n\nAfter decrypting the resource section, the following files can be extracted:\n\n1. Decoy pdf file.\n2. <Random_Name>.XML\n\nContains configuration data for a Windows task creation\n3. CMemoryExecute.dll\n4. WebBrowserPassView.exe\n5. MailPV.exe\n\nFigure 6: Components of malware\n\n**Task Scheduler – Persistence Mechanism**\n\nThe payload uses the Windows task scheduling feature for its persistance mechanism on the\nvictim’s computer. It schedules a task to execute on user login. The configuration data shown\nin Figure 7 is used to schedule the task.\n\nFigure 7: Task Scheduler.xml\n\nCMemoryExecute.dll\n\n\n-----\n\nCMemoryExecute.dll is responsible for running a .NET executable capable of using the\nWindows Native API to inject MailPV.exe and WebBrowserPassView.dll into VBC.exe, which\nthe Visual Basic Command Line Compiler. MailPV and WebBrowserPassView are used in\norder to extract credentials from the list of email and web browser clients noted in the\nfollowing section.\n\n**WebBrowserPassView**\n\nWebBrowserPassView.dll, extracted from the resource section, is a password recovery tool\nthat extracts passwords stored in the following web browsers:\n\nInternet Explorer (Version 4.0 – 11.0)\nMozilla Firefox (All Versions)\nGoogle Chrome\nSafari\nOpera\n\nThe extracted passwords are stored in a created text file: “%temp%\\holderwb.txt”\n\n**MailPV**\n\nThe MailPV.exe file is password recovery tool that extracts password for following email\nclients:\n\nOutlook Express\nIncrediMail\nEudora\nGroup Mail Free\nMS Outlook\nMS Outlook 2002/2003/2007/2010\nGmail\nHotmail/MSN\nYahoo! Mail\nNetscape Mail\nThunderbird\nGoogle Desktop\nWindows Mail\nWindows Live Mail\nOutlook 2013\n\nThe extracted passwords are stored in a created text file: “%temp%\\holdermail.txt”\n\n**Command and Control Communications**\n\nThe first C2 traffic observed is the malware’s check to get the external IP address of the\ninfected machine Figure 8 shows an example of the external IP address query\n\n\n-----\n\nFigure 8 : External IP Address Query\n\nAs noted, the malware sends gathered system information and security program data to the\nC2 server after the external IP address is known. HawkEye can be configured to send this\ninformation through multiple methods, including via email or FTP.\n\nIn addition to the system data, the malware will upload any collected credentials from email\nand web browser applications. To do this, the malware will validate that holdermail.txt and\nholderweb.txt exist and send the data to the C2 server. After the data is exfiltrated, the TXT\nfiles are deleted from the victim’s machine.\n\nIn this campaign, the HawkEye payload was configured to upload the data via email. Once\nthe extracted data is received by the C2 server, the server sends emails to the threat actors\nbehind the campaign to notify them that new stolen information is available. Figure 9 shows\nsome of the email templates used in this campaign and Figure 10 shows the SMTP traffic on\nthe network.\n\nFigure 9: Email notification to HawkEye Customers\n\n\n-----\n\nFigure 10: SMTP Handshake\n\n**HawkEye User Base**\n\nHawkEye is a versatile Trojan used by diverse actors for multiple purposes. The malware\nhas been sold through a public-facing website, which has allowed many different operators\nto use it. As is often the case with commercial Trojans, HawkEye offers a variety of functions\nfor stealing stored data, grabbing form data, self-spreading, and performing other functions.\nConsequently, HawkEye may facilitate a number of different exploitative operations in\ncompromised environments, and can be used by actors with a wide range of motivations. We\nhave seen different HawkEye campaigns infecting organizations across many sectors\nglobally, and stealing user credentials for diverse online services. This particular campaign\nrepresents one segment of the numerous HawkEye activity sets.\n\nSome notable threat operations where we have previously reported HawkEye use include\nbusiness email compromise campaigns, phishing against Middle Eastern organizations, and\n[prolific spam operations (get an iSIGHT intelligence subscription to learn more about these](https://www.fireeye.com/products/isight-cyber-threat-intelligence-subscriptions/isight-intelligence-details.html)\ncampaigns).\n\n**Conclusion**\n\nBased on previous observations, the phishing and lure techniques used in these recent\nHawkEye campaigns have remained consistent, as have the HawkEye binaries and\nassociated payloads. However, the attackers have altered the initial delivery method to use\nan embedded OLE object, as opposed to past methods such as a macro embedded in a\nWord document. The threat landscape is continiously evolving, and we expect to see more\nnew tricks and tactics being used by the actors using this malware family.\n\nFireEye [Multi Vector Execution (MVX) engine is able to recognize and block this threat.](https://www.fireeye.com/)\n\n**Acknowledgement**\n\nSpecial thanks to John Miller and Nart Villeneuve for their contributions to this blog.\n\n\n-----\n\nPrevious Post\nNext Post\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-07-25 - HawkEye Credential Theft Malware Distributed in Recent Phishing Campaign.pdf"
    ],
    "report_names": [
        "2017-07-25 - HawkEye Credential Theft Malware Distributed in Recent Phishing Campaign.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535870,
    "ts_updated_at": 1743041159,
    "ts_creation_date": 1653751154,
    "ts_modification_date": 1653751154,
    "files": {
        "pdf": "https://archive.orkl.eu/e60a1ed6e6ffe993992a026045e170e5b4ea71a5.pdf",
        "text": "https://archive.orkl.eu/e60a1ed6e6ffe993992a026045e170e5b4ea71a5.txt",
        "img": "https://archive.orkl.eu/e60a1ed6e6ffe993992a026045e170e5b4ea71a5.jpg"
    }
}