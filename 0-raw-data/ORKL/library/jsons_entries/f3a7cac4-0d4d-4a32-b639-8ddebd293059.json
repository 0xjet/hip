{
    "id": "f3a7cac4-0d4d-4a32-b639-8ddebd293059",
    "created_at": "2023-01-12T15:07:32.204609Z",
    "updated_at": "2025-03-27T02:15:35.494225Z",
    "deleted_at": null,
    "sha1_hash": "aaa49dad5e52d0b26c041d322189eec36ac2325e",
    "title": "2021-08-05 - The clandestine Horus Eyes RAT- From the underground to criminals‚Äô arsenal",
    "authors": "",
    "file_creation_date": "2022-05-28T21:48:12Z",
    "file_modification_date": "2022-05-28T21:48:12Z",
    "file_size": 4465262,
    "plain_text": "# The clandestine Horus Eyes RAT: From the underground to criminals‚Äô arsenal\n\n**[seguranca-informatica.pt/the-clandestine-horus-eyes-rat-from-the-underground-to-criminals-arsenal/](https://seguranca-informatica.pt/the-clandestine-horus-eyes-rat-from-the-underground-to-criminals-arsenal/)**\n\nAugust 5, 2021\n\n**The clandestine Horus Eyes RAT: From the underground to criminals‚Äô arsenal.**\nNowadays, the volume of banking trojans have increased both in number and sophistication\nwith criminals bringing more and more potent cyberweapons from the underground as a way\nof equipping their malicious arsenal. This kind of phenomenon is precisely connected to the\ncriminals‚Äô mindset: cause less noise, keep threats in the wild for as long as possible,\n**and thereby impacting users on a large scale.**\n\n## Overview\n\nIn this article, we are writing about a newly discovered trojan banker called ‚Äúwarsaw‚Äù by its\ndevelopers from Latin America. Developed in .NET and using the recent and undercover\nHorusEyes RAT to fully compromise victims‚Äô machines, this is the first time a threat is using\nthis RAT during its operation.\n\nThe warsaw trojan banker built-in .NET uses the first stage to lure the victim to install the 2nd\nstage on their machine. Then, the second binary ‚Äì a customized version of the Horus\n**Eyes RAT ‚Äì creates persistence, collects some details about the infected machines such as**\ncomputer name, username, OS version, CPU/architecture, and Language, and uses a\nmechanism of capturing details from opened foreground windows matching its name with a\nspecific hardcoded string. Finally, all the data is sent to the criminals‚Äô side through a\nTelegram bot/channel.\n\nSince this malware is a custom development of Horus Eyes RAT, it inherits the entire RAT\nengine. In detail, criminals use a ngrok TCP tunnel hosted on AWS EC2 instance to establish\ncommunication with victims‚Äô machines.\n\nHorus Eyes RAT is the name of the recent upgrade of an old RAT called SpyBoxRat, which\ncomes from underground forums. It was released in the wild on GitHub by its developer in\n2021. The criminals behind the warsaw trojan banker are taking advantage of this RAT to\nallegedly control the victims‚Äô computers after the initial infection.\n\n\n-----\n\n**_Figure 1: High-level diagram of the usage of Horus Eyes RAT in the warsaw banking trojan_**\n_and its modus operandi._\n\n## Key findings\n\nWarsaw trojan banker tries to trick victims into proceeding with the infection chain\nusing an overlay window from a popular bank.\nThe loader (2nd stage) ‚Äì a customized version of the Horus Eyes RAT ‚Äì is\ndownloaded and it creates persistence via the Windows registry and scans the\nmachine for sensitive files, juicy data, running processes, Windows Certificate\nStore, and so on.\nForeground windows are captured and matched with substring ‚Äúsantander‚Äù.\nDetails are sent to a Telegram channel under criminals‚Äô control.\nHorus Eyes RAT is installed in the background during the banking trojan\nexecution, and it connects back to the criminals‚Äô side via a ngrok TCP URL also\nhardcoded inside the trojan binary.\n\n## Threat analysis in-depth\n\nIn this section, we are going through the details of this threat, analyzing step-by-step this\nbanking trojan, how it operates, what kind of data is exfiltrated, and later learn about the\nHorus Eyes RAT ‚Äì the cyber weapon used by warsaw developers to fully compromise the\nvictims‚Äô machines.\n\n## Warsaw trojan banker ‚Äì the 1st stage\n\n**Filename: SantanderModulo.exe / warsaw-19-07-2021.exe**\n\n**MD5: C396FCD76492FD9CC11E622B6C432412**\n\n**Creation date: 16-02-2021**\n\n\n-----\n\n[The first alert on this banking trojan was triggered by the 0xSI_f33d engine agents that](https://feed.seguranca-informatica.pt/)\nreported a new and suspicious domain. After interacting with the domain, a new PE file is\ndownloaded in a form of an EXE. During this investigation, we cannot understand how this\nthreat was operated, or even if it was spread by malware operators.\n\n**_Figure 2: Download of the trojan banker 1st stage from the Internet._**\n\nBy looking at the whois registry, we can learn the domain was created two days before the\n0xSI_f33d detection. At the first glance, criminals were preparing a new malware wave and\nusing that domain to downloaded additional malware stages.\n```\nmodoseguranca.]com\nCreation Date: 2021-07-29T18:03:43Z\nUpdated Date: 2021-07-29T18:03:47Z | 2021-07-29T20:03:50Z\n45.132.242.]60\n\n```\nThe URL is hardcoded inside the binary with the full path to the 2nd stage (loader.exe /\n_stub.exe). Also, the full path of the PDB file; an interesting artifact for tracking and learning_\nabout criminals‚Äô movements, telemetry, their activities, and how the threat is disseminated;\nwas found. Notice that, at the moment we analyzed the sample, only 2 AV engines classified\nthis 1st stage as malicious (details based on the VirusTotal).\n\n\n-----\n\n**_Figure 3: VirusTotal detection, hardcoded URL (2nd stage), and path of the PDB file._**\n\n### Going into the details\n\nAs present in Figure 4, we can observe the internal name of this trojan ‚Äúwarsaw‚Äù, and some\ndetails such as the Assembly version, Target framework, and the initial entry point.\n\n**_Figure 4: Details about the 1st stage of warsaw banking trojan._**\n\n\n-----\n\nBy analyzing the trojan source code, we can notice the interesting routine is inside button1.\nIn short, the 2nd stage is downloaded into the ‚ÄúAppData/Local/Temp‚Äù folder, executed in\nruntime, and a message is presented as a way of informing the victim that the process was\nsuccessfully completed.\n\n**_Figure 5: Download of the 2nd stage of the warsaw banking trojan into the_**\n_AppData/Local/Temp folder._\n\nThen, the malware obtains the ‚ÄúEnvironment.SpecialFolder.LocalApplicationData‚Äù folder\nfrom the victim‚Äôs machine and downloads the warsaw 2nd stage into it and executes it.\n\n\n-----\n\n**_Figure 6: 2nd stage download into the AppData/Local/Temp folder and executed._**\n\nThe GUI behind the process previously described is simple and presented by the following\n.NET bait window.\n\n\n-----\n\n**_Figure 7: GUI of the 1st stage of warsaw banking trojan in order to lure the victims to_**\n_execute the malware._\n\n## Warsan trojan banker ‚Äì the 2nd stage && RAT\n\n**Filename: Stub.exe / loader.exe**\n\n**MD5: 8DF8BD1A1062E051AD3092BF58E69400**\n\n**CPU: x64**\n\nThe 2nd stage of the warsaw banking trojan is an upgrade of the Horus Eyes RAT source\ncode. Since the RAT source code is now available on GitHub, criminals can get it and\nintroduce new functionalities and TTPs in order to improve their malicious arsenal.\n\nThe new features implemented in this customized version are:\n\nA registry key on CurrentVersion/Run entry in order to auto-exec the trojan at the\nOS startup.\nImplementation of a notification mechanism via Telegram to inform criminals\nwhen the victims‚Äô are accessing or navigating on a target bank portal.\nAfter that, criminals use the full capabilities of the RAT to gain full control over the\nvictims‚Äô machines.\n\nBy analyzing the binary, we understand that some resources were embedded and probably\nthey could be implanted in runtime during the trojan execution (Horus Eyes RAT binaries\nhardcoded in the left-side below). On the right side, all the available routines that come from\n\n\n-----\n\nthe original RAT with other ones developed by criminals.\n\n**_Figure 8: Big picture of the warsaw trojan based on the Horus Eyes RAT._**\n\nIn order to confirm the origin of the warsaw trojan, we found the moment the resource files\nwere loaded into the memory via Assembly Reflection. The name of the injected file is\n**[‚Äúoptions.dll‚Äù, part of modus operandi and](https://github.com/arsium/HorusEyesRat_Public/blob/master/Options/obj/Release/Options.dll)** **[dependencies of the Horus Eyes RAT.](https://github.com/arsium/HorusEyesRat_Public/blob/master/Options/obj/Release/Options.dll)**\n\n**https://github.com/arsium/HorusEyesRat_Public/blob/master/Options/obj/Release/Opti**\n**ons.dll**\n\n**_Figure 9: Hardcoded resource dumped from memory (Options.dll) during the trojan runtime._**\n\n\n-----\n\nBy comparing the extracted file named **r1.bin, and the original file** **Options.dll**\ndownloaded from the GitHub page, we can prove that we are facing an upgrade of the Horus\nEyes RAT; only the PDB path seems different between the files analyzed below. More, 131\nwell-formatted strings were detected in both files.\n\n**_Figure 10: Comparison between the extracted DLL and the original RAT DLL._**\n\n### Matching warsaw with the Horus Eyes RAT available on GitHub\n\nAs a way of matching the differences between the original RAT available on GitHub and this\nnewly improved version we downloaded the original version and compared both\n\n\n-----\n\n**_Figure 11: Horus Eyes RAT ‚Äì released on 26th Feb. 2021._**\n\nAs a start point, we compiled the RAT client and compared it with the warsaw version\ncustomized by the criminals. The next images present the similarities between the two\nversions, including the same sections, internal name, file version, and binary strings.\n\n\n-----\n\n-----\n\n**_Figure 12: Similarities between warsaw and the original RAT version._**\n\nDuring this analysis, it was possible to understand the resources are the same, and just\n**specific routines were added to basically introduce the Telegram feature and the**\n**creation of the registry key to maintain the trojan persistence.**\n\nIn short, the main changes introduced by criminals are:\n\n\n-----\n\nTelegram notification mechanism implemented on the **Check() and** **Main()**\nroutines; and\nCreation of the ‚ÄúdoSubmitHTTPRequest()‚Äù routine to perform the HTTP GET\nrequest to the Telegram API with the victims‚Äô data.\n\n**_Figure 13: Big picture of the loader.exe (warsaw) and the original RAT client (Stub.exe)._**\n\nAs described, the ‚ÄúMain()‚Äù routine introduces a block of code responsible for mantain\ncommunication with the Telegram API to inform criminals about a new infection. The\nimprovement can be observed below (left-side).\n\n\n-----\n\n**_Figure 14: Telegram feature added in order to inform criminals about new infections._**\n\nThe block of the code of the routine ‚ÄúdoSubmitHTTPRequest()‚Äù is responsible for sending\nthe details to the Telegram bot/channel also presented below.\n\n**_Figure 15: Block of code responsible for sending the victim‚Äôs details to the Telegram_**\n_bot/channel under the criminals‚Äô operation._\n\nIn detail, we can see that at the moment the ‚ÄúCheck()‚Äù function is executed, an entry is\nadded to the Windows registry in order to create the trojan persistence and the victim activity\nis then monitored in a loop. When the match with a hardcoded substring happens, some\ninformation is collected and sent to the Telegram bot/channel. This activity allows to generate\nan alert on the criminals‚Äô operation, and after that, they can use the full capabilities of the\nHorus Eyes RAT now installed on the victims‚Äô machines to fully compromise their banking\naccounts.\n\n\n-----\n\n**_Figure 16: The trojan adds a key on the Windows registry, monitoring the victim‚Äôs activity_**\n_and send data via Telegram API to criminals._\n\nThe trojan collects some information about the machine, including:\n\nComputer name\nWindows Version\nCurrent region + Language\nName of the target bank portal\nGet user privileges (normal user or administrator)\nCheck the system architecture (x86 or x64).\n\n\n-----\n\n**_Figure 17: Information collected during the trojan execution._**\n\nThe collected information is compiled in a string array and then sent to the Telegram channel\nthrough the doSubmitHTTPRequest() routine as observed below.\n\n\n-----\n\n**_Figure 18: Information sent to the Telegram channel in runtime._**\n\nTaking advantage of the Telegram API, we got some interesting details in order to potentially\ntrack the criminals behind this malicious schema. As noted, 349 messages were sent to the\nTelegram channel before, potentially representing 349 infections.\n\nAnother interesting detail is the username of the Telegram bot ‚ÄúBanking171Bot‚Äù.\n**Banking171 was the name used by criminals to create the telegram bot.**\n\n\n-----\n\n**_Figure 19: Details about the Telegram bot and channel used by criminals._**\n\n[Curiously in a past campaign detected in December 2020 and called ANUBIS network,](https://seguranca-informatica.pt/the-evolution-of-phishing-infrastructure-a-large-scale-campaign-called-anubis-that-targets-brazilian-and-portuguese-internet-users/#.YQroKI5KiUl)\nwe identified a big banking schema from Brazil using the number ‚Äú171‚Äù as suffix\n(Anubis171). We don‚Äôt know if this could potentially be an indicator related to the same\ngroup, but the two criminals groups are from the same geolocation: Brazil.\n\nThe name of the Telegram group is ‚ÄúKL ‚Äì LOGS‚Äú, and it is a way of notifying criminals about\nnew infections as presented below. After that, they can fully compromise the victims taking\nadvantage of the capabilities of the Horus Eyes RAT.\n\n\n-----\n\n**_Figure 20: Victims‚Äô details sent to the Telegram group._**\n\n### Remote access using RAT capabilities\n\nAfter receiving a notification about a new infection, criminals use the Horus Eyes RAT\ncapabilities to access remotely and get full control over the victims‚Äô machines. As observed\nin Figure 21, the IP address and port of the Horus Eyes RAT are hardcoded on the binary file\nand hosted on an AWS EC2 instance geolocated in Brazil.\n\n\n-----\n\n**_Figure 21: Identification of the IP address and port of the RAT server hosted on an AWS_**\n_EC2 instance._\n\nIn order to confirm if the server was online at the moment of the analysis, we communicate\nwith it and receive a very interesting response üòâ\n\n**_Figure 22: Checking connectivity with the RAT server._**\n\nThese were definitely good news üòÄ With some tricks in place and ‚Ä¶\n\n\n-----\n\nAs mentioned earlier, the RAT server is used to get control over the victims‚Äô machines,\ninstalling additional payloads, get passwords from popular web-browsers, accessing the file\nsystem, getting a remote desktop screen shoot, and so on. To do this, criminals only crossreference the data received by Telegram with the details present in the RAT server\ndashboard (the new infected clients).\n\n\n-----\n\n**_Figure 23: Dashboard of the Horus Eyes RAT server and remote control over the victim s_**\n_machine._\n\n### Web server ‚Äì telemetry details\n\nAccording to the VirusTotal service, a lot of domains have been hosted on the same server\nduring 2021, and many of them were also flagged as malicious. This is a clear sign this AWS\nEC2 instance have been used by criminals to distribute malware schemas in the wild around\nthe globe.\n\n\n-----\n\n**_Figure 24: Details about the DNS passive replication, communication files, and SSL_**\n_certificates provided by VirusTotal._\n\nIn addition, other threats were also disseminated and operated by this gangue such as\nVanillaRAT. Thanks to **[@JAMESWT_MHT who provided these samples from the Malware](https://twitter.com/JAMESWT_MHT)**\nbazaar.\n\n**[Vanilla sample |](https://bazaar.abuse.ch/sample/92d129825bda8b18723026a90fcc19bed5614c7ba17b1a50e1ed91518fc93752/)** **[Other sample](https://bazaar.abuse.ch/sample/ceb8f344d1cda9007bccb82a7d6c75dcd29e7d235cc64747707097bb28c8f317/)**\n\nh/t: [@JAMESWT_MHT](https://twitter.com/JAMESWT_MHT)\n\n## The storyline behind Horus Eyes RAT\n\nArsium is the author of the Horus Eyes RAT and others offensive software that he has been\ndeveloped and shared on the underground Internet forums. This piece of software was\nreleased on GitHub in early 2021 by its author, and now criminals are taking advantage of its\nfeatures and FUD (Fully Undetectable) capability to bypass security mechanisms such as\nEDR‚Äôs and antivirus and also circumvent network-based solutions.\n\n\n-----\n\n**_Figure 25: Source code of Horus Eyes RAT available on GitHub._**\n\nHowever, Horus Eyes RAT is not the first software Arsium has developed. This RAT is the\nsuccessor to the old SPYBOXRAT ‚Äì which Arsium released in the year 2020 in underground\nforums.\n\n**_Figure 26: SPYBOXRAT released in 2020 ‚Äì the Horus Eyes RAT predecessor._**\n\nBy making this offensive software open-souce, Arsium gained enormous and valuable input\nfrom the underground community, which allowed it to continue to develop and implement\nnew features thus making it a potent silent weapon.\n\n\n-----\n\nSometime around December 2020, Arsium seems to have decided to create a new release\ncalled Horus Eyes RAT. This new software has been equipped with the basic engine of its\npredecessor and now with all the new features that have been implemented as a result of\ncommunity feedback.\n\n**_Figure 27: SpyBoxRat announced as an outdated version ‚Äì the turning point._**\n\nAt the end of December 2020, we found the first official publication from Arsium, where the\nfirst Horus Eyes RAT update was announced. At the time, the software was not open source\nand the community had to pay some credits to get it.\n\n\n-----\n\n**_Figure 28: First update of the Horus Eyes RAT aka HE-RAT by its developer._**\n\nAs stated by Arsium, ‚Äúfor those who have forked starred the project, I‚Äôve destroyed previous\n_github and made a new repository (I got some problems with the old‚Äù ‚Äì and this is the clear_\nsign this tool has had a huge contribution from the underground community during its\ndevelopment. Figure 29 below presents one of the contributions/new ideas we found.\n\n**_Figure 29: New ideas and improvements from the underground community to the_**\n_development of the Horus Eyes RAT._\n\nFrom that point forward, Horus Eyes RAT was carefully tracked by criminal groups, due to\nthe set of capabilities the software provided, and the ability to bypass security mechanisms\nmaking it very stealthy and FUD.\n\nLater, on 26th February 2021, the RAT was open-source and then released on GitHub. The\npublication date on GitHub coincides with the third update of the offensive tool that its author\nannounced on the same day on the underground forums.\n\n\n-----\n\n**_Figure 30: Third updated of Horus Eyes RAT and its release on GitHub._**\n\nWe believe this was the moment criminals start looking at this RAT as a potential candidate\nfor upgrading their cyber arsenal. The RAT came up with an amazing set of features that\nwould fit neatly into the malicious goals of most cyber gangs. Some of the features\nannounced by the RAT creator are:\n\n\n-----\n\nSupports DNS (No-IP for example)\nMulti-Threaded\nAsynchronous\nPackets Serialization\nMulti Ports Listener\nAutomation Tasks when client is connected\nSave Settings for automation tasks\nBlur ScreenLocker\nMonitor Rotation (0, 90, 180, 270 degrees)\nHide & Show Taskbar\nHide & Show Desktop Icons\nHide & Show Cursor\nSwap & Normal State Mouse Buttons\nLock & Unlock Keyboard\nEmpty Bin\nNative Injection : You can inject an unmanaged DLL (C++, C, D‚Ä¶)\n32 & 64 bit stubs\nMass Tasks: Passwords Recovery, History Recovery, Wifi Passwords Recovery\nTasks Manager : Kill, Resume, Pause\nPasswords Recovery (+35 web browsers based on chromium)\nHistory Recovery (+35 web browsers based on chromium)\nWifi Passwords Recovery\nPower : Log out, Reboot, Shutdown, Hibernate, Suspend\nBSOD\nIncrease Volume\nDecrease Volume\nMute | Unmute Volume\nSave all passwords | history recovered\nExport History | Passwords as .csv file\nInstallation : Set a task in TaskScheduler | Hidden from startup + copy file in local\nuser path hidden\nAbility to change your client priority\nAbility to ask for privileges\nCheck UAC at different levels (if enable or not)\nFile Manager : Create Directory, Open File, Delete File, Move File To Bin,\nDownload File\n\nAlthough Arsium, the creator of this offensive software, made it clear on Youtube that the\npurpose of this type of software is only for educational purposes, the RAT now appears\nassociated with a new banking trojan.\n\n\n-----\n\n**_Figure 31: Security disclaimer on Youtube by the Horus Eyes RAT author._**\n\n## Final Thoughts\n\nNowadays, we are facing a growing of Brazilian trojans at a very high speed. Each one of\nthem with its peculiarities, TTPs, etc. The technique of embedding other binaries in the initial\nstage is not new, however, the use of this new RAT called Horus Eyes RAT was the main\nobject of analysis of this article.\n\nWith this kind of mindset and bringing content and tools from underground forums, criminal\ngangues achieve one of their main goals: to avoid detection and impact a large number of\nusers.\n\nAlthough the author of the RAT had just educational intentions, the source code of the RAT\nleft now into the criminals‚Äô tentacles. It was the first time it was found, at least, being\ndisseminated along with a malicious threat like this new trojan impacting only users of a\nsingular international bank.\n\nTherefore, monitoring these types of IoCs is a crucial point now, as it is expected that in the\ncoming weeks or months new variants based on this new RAT can appear.\n\n### Thank you to all who have contributed:\n\n**[@JAMESWT_MHT](https://twitter.com/JAMESWT_MHT)**\n\n## Mitre Att&ck Matrix\n\n\n-----\n\n## Indicators of Compromise (IOCs)\n```\n---- Online server with warsaw stages -------hxxps://modoseguranca.c]om/loader.exe\nhxxps://modoseguranca.]com/warsaw-19-07-2021.exe\n45.132.242.]60\n8DF8BD1A1062E051AD3092BF58E69400\nC396FCD76492FD9CC11E622B6C432412\n----- AWS EC2 Instance RAT server -----ec2-54-94-248-37.sa-east-1.compute.amazonaws.]com\n54.94.248.]37\n1.tcp.sa.ngrok.]io\n------ Artifacts -------------C:\\Users\\xxx\\AppData\\Local\\Temp\\warsaw-19-07-2021.exe\nschtasks /create /sc minute /mo 1 /tn \"||\" /tr \"\ncostura.packetlib.pdb.compressed\ncostura.packetlib.dll.compressed\ncostura.options.dll.compressed\n======= Nova vitima ========\n------ PDB paths -----------C:\\Users\\ada\\Desktop\\HorusEyesRat_Public-master\\Options\\obj\\Debug\\Options.pdb\nC:\\Users\\ada\\Desktop\\definitivo\\bb\\Client\\obj\\x64\\Debug\\Stub.pdb\nC:\\Users\\ada\\source\\repos\\SantanderModulo\\SantanderModulo\\obj\\Debug\\SantanderModulo.pd\n\n Online Sandbox URLs\n\n```\n[https://cuckoo.cert.ee/analysis/2343055/summary/](https://cuckoo.cert.ee/analysis/2343055/summary/)\n\n[https://www.joesandbox.com/analysis/458211/0/html](https://www.joesandbox.com/analysis/458211/0/html)\n\n[https://app.any.run/tasks/462fa847-4694-4a59-9d1c-6f43854b10b1](https://app.any.run/tasks/462fa847-4694-4a59-9d1c-6f43854b10b1)\n\n[https://analyze.intezer.com/analyses/f5bd885b-5d26-4ed4-914e-93d04729783a](https://analyze.intezer.com/analyses/f5bd885b-5d26-4ed4-914e-93d04729783a)\n\n[https://analyze.intezer.com/analyses/12140b0a-47d5-4d52-a659-a826b2aedb26](https://analyze.intezer.com/analyses/12140b0a-47d5-4d52-a659-a826b2aedb26)\n\n\n-----\n\n**Samples**\n[https://bazaar.abuse.ch/browse/tag/SantanderModulo/](https://bazaar.abuse.ch/browse/tag/SantanderModulo/)\n\n## Yara Rule\n```\nimport \"pe\"\nrule warsaw_downloader_august_2021 {\nmeta:\n  description = \"Yara rule for warsaw trojan banker (loader) - August version\"\n  author = \"SI-LAB - https://seguranca-informatica.pt\"\n  last_updated = \"2021-08-05\"\n  tlp = \"white\"\n  category = \"informational\"\n  strings:\n  $s_a = {53 61 6E 74 61 6E 64 65 72 4D 6F 64 75 6C 6F 2E 77 61 72 73 61 77}\n  $s_b = {53 61 6E 74 61 6E 64 65 72 4D 6F 64 75 6C 6F 5C 53 61 6E 74 61 6E 64 65\n72 4D 6F 64 75 6C 6F 5C 6F 62 6A 5C 44 65 62 75 67 5C 53 61 6E 74 61 6E 64 65 72 4D\n6F 64 75 6C 6F 2E 70 64 62}\n  condition:\n    filesize < 1000KB\n    and all of ($s_*)\n}\nrule warsaw_2nd_stage_horus_eyes_rat_august_2021 {\nmeta:\n  description = \"Yara rule for warsaw 2nd stage aka Horus Eyes RAT - August\nversion\"\n  author = \"SI-LAB - https://seguranca-informatica.pt\"\n  last_updated = \"2021-08-05\"\n  tlp = \"white\"\n  category = \"informational\"\n  strings:\n  $s_a = {63 6F 73 74 75 72 61 2E 64 6C 6C 2E 63 6F 6D 70 72 65 73 73 65 64}\n  $s_b = {63 6F 73 74 75 72 61 2E 6F 70 74 69 6F 6E 73 2E 64 6C 6C 2E 63 6F 6D 70\n72 65 73 73 65 64}\n  $s_c = {53 00 61 00 6E 00 74 00 61 00 6E 00 64 00 65 00 72}\n  $s_d = {2D 00 35 00 30 00 37 00 30 00 37 00 35 00 33 00 35 00 33 00}\n  condition:\n    filesize < 1000KB\n    and all of ($s_*)\n}\n\n```\n[The Yara rules are also available on GitHub.](https://raw.githubusercontent.com/sirpedrotavares/SI-LAB-Yara_rules/master/warsaw%20trojan%20and%20Horus%20Eyes%20RAT)\n\n\n-----\n\n[Pedro Tavares](https://seguranca-informatica.pt/author/pipocaz/)\n**[Pedro Tavares is a professional in the field of information security working as an Ethical](https://www.linkedin.com/in/sirpedrotavares/)**\nHacker/Pentester, Malware Researcher and also a Security Evangelist. He is also a founding\nmember at CSIRT.UBI and Editor-in-Chief of the security computer blog segurancainformatica.pt.\n\nIn recent years he has invested in the field of information security, exploring and analyzing a\nwide range of topics, such as pentesting (Kali Linux), malware, exploitation, hacking, IoT and\nsecurity in Active Directory networks. He is also Freelance Writer (Infosec. Resources\n[Institute and Cyber Defense Magazine) and developer of the 0xSI_f33d ‚Äì a feed that](https://feed.seguranca-informatica.pt/)\ncompiles phishing and malware campaigns targeting Portuguese citizens.\n\n[Read more here.](https://seguranca-informatica.pt/contacto/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-05 - The clandestine Horus Eyes RAT- From the underground to criminals‚Äô arsenal.pdf"
    ],
    "report_names": [
        "2021-08-05 - The clandestine Horus Eyes RAT- From the underground to criminals‚Äô arsenal.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536052,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1653774492,
    "ts_modification_date": 1653774492,
    "files": {
        "pdf": "https://archive.orkl.eu/aaa49dad5e52d0b26c041d322189eec36ac2325e.pdf",
        "text": "https://archive.orkl.eu/aaa49dad5e52d0b26c041d322189eec36ac2325e.txt",
        "img": "https://archive.orkl.eu/aaa49dad5e52d0b26c041d322189eec36ac2325e.jpg"
    }
}