{
    "id": "8821f0e1-1cc3-435d-8259-ace7412a060d",
    "created_at": "2023-01-12T15:02:50.620273Z",
    "updated_at": "2025-03-27T02:05:35.73322Z",
    "deleted_at": null,
    "sha1_hash": "2cef73e02f709a85f63ccedfe777cea4357a0a00",
    "title": "2022-02-17 - FreeCryptoScam - A New Cryptocurrency Scam That Leads to Installation of Backdoors and Stealers",
    "authors": "",
    "file_creation_date": "2022-05-27T22:32:42Z",
    "file_modification_date": "2022-05-27T22:32:42Z",
    "file_size": 3126992,
    "plain_text": "# FreeCryptoScam - A New Cryptocurrency Scam That Leads to Installation of Backdoors and Stealers\n\n**[zscaler.com/blogs/security-research/freecryptoscam-new-cryptocurrency-scam-leads-installation-backdoors-and](https://www.zscaler.com/blogs/security-research/freecryptoscam-new-cryptocurrency-scam-leads-installation-backdoors-and)**\n\n## Introduction\n\nIn January 2022, the ThreatLabz research team identified a crypto scam, which we've\ndubbed \"FreeCryptoScam.\" In this scam, the threat actor targets crypto users by luring\nthem with an offer of free cryptocurrency. When the victim downloads the payload, it leads\nto installation of multiple malware payloads on the victim's system, allowing the threat actor\nto establish backdoors and/or steal user information. In this campaign, we see the Dark\nCrystal RAT (\"DCRat\") being downloaded which further leads to Redline and TVRat being\ndownloaded and executed onto the victim’s system.\n\nThis blog aims to explain various aspects of the campaign that the ThreatLabz team has\nuncovered during the investigation and technical analysis of the dropped payloads.\n\n## Website Analysis\n\nIn this campaign, threat actors host their malicious payload on either a new (Figure 1) or an\nold compromised web domain (Figure 2 & Figure 3). They use the below mechanisms to\nsuccessfully drop the payload to the victim machine:\n\n1. As soon as the user visits the website, the below javascript under a “script” tag gets\n\nexecuted to drop a payload:\n\n“setTimeout(document.location.href=<link of the payload>, <milliseconds>)”\n2. As soon as the user clicks on the button, the “href” property is used to drop the\n\npayload that consists of the payload link.\n\n\n-----\n\n_Figure 1: Newly spun up website hosting malicious payloads_\n\n_Figure 2: Old compromised websites used for hosting malicious payload_\n\nIt should be noted that:\n\nThe threat actor uses social engineering to drive successful payload execution, luring\nvictims to install the dropped payload by using a message offering free\ncryptocurrency.\n\n\n-----\n\nThe attack works across browsers, with the mechanism running the same way in\nChrome, Internet Explorer, and Firefox. Depending on the browser settings, the\npayload will be automatically downloaded, or a pop-up window will ask the user to\nsave the application on the system.\nFrom the whois record, it is clear that the second domain (shown in Figure 2) is an old\ndomain that has likely been compromised.\n\n_Figure 3: Whois report of the second domain [Credit: DomainTools]_\n\n## Attack Chain\n\nThe figure below depicts the attack chain of two scenarios:\n\n\n-----\n\n_Figure 4: Attack chain_\n\n## Technical Analysis\n\nAs shown in the above figure, we found two types of payload:\n\n1. In Scenario 1, the payload was a downloader that connected to another malicious\n\ndomain hosting second stage payloads—backdoors and stealers. In most cases, the\ndownloaded files were DCRat, Redline, and TVRat.\n2. In Scenario 2, the payload served the DCRat malware directly.\n\n**[+] Scenario 1: Downloader DCRatLoader**\n\nFor the purposes of analysis, we will look at the payload with MD5 hash:\nD3EF4EC10EE42994B313428D13B1B0BD which was protected by a well-known packer\nnamed Asprotect and given a fake certificate (as shown in the figure below).\n\n\n-----\n\n_Figure 5: Version information and digital certificate_\n\nAfter unpacking the file, we get a 48KB .NET executable file (MD5 =\n469240D5A3B57C61F5F9F2B90F405999). This is a downloader consisting of base64\nencoded urls and file paths (as shown in the figure below ).\n\n_Figure 6: Code of Unpacked file_\n\nThese base64 encoded strings represent the URL paths for downloading stage 2 payloads\nas well as the file paths where these payloads will be dropped on the victim system.\n\n\n-----\n\n_Figure 7: URLs and File paths_\n\n**Scenario 2: DCRat**\n\nThe second scenario involved direct download of the DCRat payload which was also\nprotected by Asprotect. Upon unpacking, we get a 664KB .NET executable file (MD5=\n37F433E1843602B29EC641B406D14AFA) which is the DCRat malware (shown in the\nfigure below).\n\n_Figure 8: Strings found in memory_\n\nNetwork Traffic:\n\n_Figure 9: Network traffic observed_\n\n\n-----\n\n_Figure 10: Get request sent to C&C_\n\nIn addition to the DCRat code, we also found stealer code inside the unpacked binary. This\npart of the code exhibited stealer characteristics, which are often used to exfiltrate sensitive\nuser information. Not only did it steal the information from the infected system, but also\ndisabled the antivirus protection (if found enabled). The code in the figure below showcases\nthe type of data being exfiltrated:\n\n\n-----\n\n_Figure 11: Stealer code_\n\n_Figure 12: Checks for antiviruses installed and disable them._\n\nWe saw the sample created a mutex, named,\n\"\\Sessions\\1\\BaseNamedObjects\\865218dd0bef38bd584e8c4ea44a4b7e295cb6f3\" where\n**865218dd0bef38bd584e8c4ea44a4b7e295cb6f3 is the SHA1(hash value) of the string**\n\"DCR_MUTEX-BZrxW3QvqgtvhEFCpLSr\" and “DCR_MUTEX” is symbolic of DCRat\nmalware.\n\n\n-----\n\n_Figure 13: Configuration of the DCRat_\n\n## Zscaler Sandbox Detection\n\n**Downloader Payload**\n\n**DCRat payload**\n\n\n-----\n\nIn addition to sandbox detections, Zscaler’s multilayered cloud security platform detects\nindicators related to the campaign at various levels with the following threat names:\n\nWin32.Downloader.DCRat\nWin32.Downloader.Redline\nWin32.Downloader.TVrat\nWin32.Backdoor.Dcrat\nWin32.Backdoor.Redline\nWin32.Backdoor.Tvrat\n\nWe haven't categorized this campaign in association with any particular family because it's\na generic downloader that downloads other backdoors or stealers.\n\n## MITRE ATT&CK AND TTP Mapping\n\n**ID** **Tactic** **Technique**\n\n\nT1189 Drive-by\nCompromise\n\nT1140 Deobfuscate/Decode\nFiles or Information\n\nT1082 System Information\nDiscovery\n\n\nAdversaries may gain access to a system through a user\nvisiting a website over the normal course of browsing.\n\nStrings and other data are obfuscated in the payload\n\nSends processor architecture and computer name\n\n\n-----\n\nT1083 File and Directory\nDiscovery\n\nT1005 Data from Local\nSystem\n\nT1222 File Directory\nPermissions\nModification\n\nT1555 Credentials from\npassword store\n\n\nUpload file from the victim machine\n\nAdversaries may search local system sources, such as\nfile systems or local databases, to find files of interest\nand sensitive data prior to Exfiltration.\n\nChange directory permission to hide its file\n\nSteal stored password\n\n\nT1056 Keylogging Keylog of infected machine\n\nT1055 Process Injection Inject code into other processes\n\n## Indicators of Compromise\n\n**[+] MD5 Hashes**\n\nd3ef4ec10ee42994b313428d13b1b0bd\n\n469240d5a3b57c61f5f9f2b90f405999\n\n6bc6b19a38122b926c4e3a5872283c56\n\n3da7cbb5e16c1f02522ff5e49ffc39e7\n\nfdec732050d0b59d37e81453b746a5f3\n\nd27dba475f35ee9983de3541d4a48bda\n\n67364aac61276a7a4abb7b339733e72c\n\n2e30e741aaa4047f0c114d22cb5f6494\n\n22c4c7c383f1021c80f55ced63ed465c\n\n1c5cf95587171cc0950a6e1be576fedc\n\n37f433e1843602b29ec641b406d14afa\n\n\n-----\n\nA6718d7cecc4ec8aeef273918d18aa19\n\nfa80b7635babe8d75115ebcc3247ffff\n\ne6d174dd2482042a0f24be7866f71b8d\n\n53be54c4311238bae8cf2e95898e4b12\n\n**[+] Network Indicators:**\n\nwetranszfer[.]com\n\ndogelab[.]net\n\nverio-tx[.]net\n\nbenbest[.]org\n\ngorillaboardwj[.]com\n\ndogelab[.]net\n\nd0me[.]net\n\npshzbnb[.]com\n\nghurnibd[.]com\n\ntheagencymg[.]com\n\ngettingtoaha[.]com\n\nsquidgame[.]to\n\n178[.]20[.]44[.]131:8842\n\n92[.]38[.]241[.]101:36778\n\nmirtonewbacker[.]com\n\n94[.]103[.]81[.]146/php/Cpu4pythonserver/37Game/Video74Local/processtraffic.php?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-17 - FreeCryptoScam - A New Cryptocurrency Scam That Leads to Installation of Backdoors and Stealers.pdf"
    ],
    "report_names": [
        "2022-02-17 - FreeCryptoScam - A New Cryptocurrency Scam That Leads to Installation of Backdoors and Stealers.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535770,
    "ts_updated_at": 1743041135,
    "ts_creation_date": 1653690762,
    "ts_modification_date": 1653690762,
    "files": {
        "pdf": "https://archive.orkl.eu/2cef73e02f709a85f63ccedfe777cea4357a0a00.pdf",
        "text": "https://archive.orkl.eu/2cef73e02f709a85f63ccedfe777cea4357a0a00.txt",
        "img": "https://archive.orkl.eu/2cef73e02f709a85f63ccedfe777cea4357a0a00.jpg"
    }
}