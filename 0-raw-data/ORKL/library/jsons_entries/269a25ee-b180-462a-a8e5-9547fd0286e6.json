{
    "id": "269a25ee-b180-462a-a8e5-9547fd0286e6",
    "created_at": "2023-01-12T15:05:24.589841Z",
    "updated_at": "2025-03-27T02:14:39.194414Z",
    "deleted_at": null,
    "sha1_hash": "3d8b3b887d5757a052a8294e66a306320803ae04",
    "title": "2018-10-17 - The Emergence of the New Azorult 3.3",
    "authors": "",
    "file_creation_date": "2022-05-28T02:15:05Z",
    "file_modification_date": "2022-05-28T02:15:05Z",
    "file_size": 549012,
    "plain_text": "# The Emergence of the New Azorult 3.3\n\n**[research.checkpoint.com/the-emergence-of-the-new-azorult-3-3/](https://research.checkpoint.com/the-emergence-of-the-new-azorult-3-3/)**\n\nOctober 17, 2018\n**Research by: Israel Gubi**\n\n\nOctober 17, 2018\n\n\nDuring the past week, Check Point Research spotted a new version of Azorult in the wild\nbeing delivered through the RIG exploit kit, as well as other sources. Azorult is a long known\ninformation stealer and malware downloader, with this particular version being advertised in\nan underground forum since October 4. The version number given to it by its authors is 3.3.\n\nThere are quite a few changes in this newly witnessed variant, the most prominent ones\nbeing a new encryption method of the embedded C&C domain string, a new connection\nmethod to the C&C and improvement of the Crypto currency wallets stealer and loader.\n\nThe timing of this update to the malware is not surprising, mainly in light of major leaks for\nprevious versions 3.1 and 3.2, in which panel source code and binary builders were released\n[for the public to use for free. Check Point shared those leaks to the research community for](https://twitter.com/_CPResearch_/status/1041687670567694336)\n[further investigation last month. Moreover, we have witnessed and written about another](https://research.checkpoint.com/the-gazorp-dark-web-azorult-builder/)\nproject related to Azorult, dubbed ‘Gazorp’ – a dark web binary builder that allows anyone to\ncraft the malware’s binaries for free. Having this in minds, it is plausible that the Azorult’s\nauthor would like to introduce new features to the malware and make it worthy as a product\nin the underground market.\n\n**The Forum Advertisement**\n\nOn October 4, the following update to Azorult was advertised on the exploit.in underground\nforum by the user CrydBrox. The updated version number 3.3 is shown below.\n\n\n-----\n\n**Figure 1: Advertisement of Azorult v3.3**\n\nThe above states the following improvements and features:\n\n[+] Added support for stealing the following wallet credentials: BitcoinGold, electrumG,\nbtcprivate (electrum-btcp), bitcore, Exodus Eden\n\n[+] Cryptocurrency wallet’s stealer component has been improved.\n\n[+] The loader component was fixed and improved, allowing bat files to be loaded and\nexecuted with no errors\n\n[+] Lowered AV detection rate, increased successful installation rate\n\n[+] Slight improvement in admin panel’s performance\n\n**Comparison to previous versions**\n\nIn version 3.2, the C&C domain name was xored with a hardcoded key and then\nencoded with base64. The current version 3.3 shows a new encryption method to\nobfuscate the domain name. The script for decryption of the domain’s string can be\nfound in the Appendix below.\nEvery version of Azorult has a unique xor key for its connection method to the C&C. In\nversion 3.3 the connection key is: [0x3, 0x55, 0xae]. Moreover, every version\nconnection message contains a prefix (‘getcfg=’ in version 3.1 and ‘G’ in version 3.2)\nprepended to the id hash before xoring with the connection key. The prefix in version\n3.3 is the connection key, which makes the connection message sent to C&C starts\nwith 3 zero bytes.\n\n**Figure 2: adding connection key as prefix.**\n\nAzorult’s C&C server response is divided into 3 parts separated by tags:\n\n\n-----\n\n<c></c> – the configuration part, encoded with base64\n\n<n></n> – DLLs that Azorult copies to a new directory it creates under the %TEMP% folder.\nThe name of the new directory is unique for every version of Azorult (‘1M0’ in version 3.1 and\n‘2fda’ in version 3.2). In the new version, the name of the directory is generated based on the\nid hash of the victim’s computer. Therefore, the name of the directory will be different for\nevery victim.\n\nThe algorithm for generating the directory name is as follows:\n\n_Id_hash=hash_func(guid)-hash_func(product_name)-hash_func(user_name)-_\n_hash_func(computer_name)-hash_func(guid+product_name+user_name+computer_name)_\n\n_Directory_name = hash_func(hash_func(Id_hash))_\n\nThe particular implementation of the hash_func method is outlined in a script, which appears\nin the Appendix below.\n\n<d></d> – names of application paths that Azorult harvests data from. In version 3.3,\n\nThe following application names are added:\n\n_%appdata%\\ElectrumG\\wallets\\_\n\n_\\ElectrumG_\n\n_%appdata%\\Electrum-btcp\\wallets\\_\n\n_\\Electrum-btcp_\n\n_BitcoinGold\\BitcoinGold-Qt_\n\n_BitCore\\BitCore-Qt_\n\n_BitcoinABC\\BitcoinABC-Qt_\n\n_%APPDATA%\\Exodus Eden\\_\n\nThe authors of Azorult fixed a bug in the loader functionality that didn’t allow the malware to\nload bat files and execute them successfully. The bug was caused by wrongfully comparing\nthe extension of the loaded file, causing the launch of all files with CreateProcessW API as\nexecutables instead of ShellExecuteExW. In the new version, the authors fixed the\ncomparison method to avoid this bug.\n\n\n-----\n\n**Figure 3: loader extension comparison in versions 3.2 and 3.3. The former introduces a bug.**\n\n**Appendix**\n\nC&C domain name decryption Python code:\n\n_def decrypt_domain_method_v3_3(encrypted_domain):_\n\n_decrypted_domain_array = []_\n\n_key_buffer = [0x1e, 0x15, 0x34, 0x49, 0x5e, 0x37, 0x24, 0x2f, 0x58, 0x27, 0x6e, 0xd3,_\n_0xd4, 0x71, 0xd6, 0x73, 0xd8]_\n\n_index = 0_\n\n_sum = 0_\n\n\n-----\n\n_while index < len(encrypted_domain):_\n\n_cur_byte = encrypted_domain[index]_\n\n_if cur_byte == key_buffer[0]:_\n\n_sum += 0x64_\n\n_elif cur_byte == key_buffer[1]:_\n\n_sum += 0x5a_\n\n_elif cur_byte == key_buffer[2]:_\n\n_sum += 0x50_\n\n_elif cur_byte == key_buffer[3]:_\n\n_sum += 0x46_\n\n_elif cur_byte == key_buffer[4]:_\n\n_sum += 0x3c_\n\n_elif cur_byte == key_buffer[5]:_\n\n_sum += 0x32_\n\n_elif cur_byte == key_buffer[6]:_\n\n_sum += 0x28_\n\n_elif cur_byte == key_buffe[7]:_\n\n_sum += 0x1e_\n\n_elif cur_byte == key_buffer[8]:_\n\n_sum += 0x14_\n\n_elif cur_byte == key_buffer[9]:_\n\n_sum += 0x0a_\n\n_elif cur_byte == key_buffer[10]:_\n\n_sum += 0x8_\n\n_elif cur_byte == key_buffer[11]:_\n\n\n-----\n\n_sum += 0x6_\n\n_elif cur_byte == key_buffer[12]:_\n\n_sum += 0x5_\n\n_elif cur_byte == key_buffer[13]:_\n\n_sum += 0x4_\n\n_elif cur_byte == key_buffer[14]:_\n\n_sum += 0x2_\n\n_elif cur_byte == key_buffer[15]:_\n\n_sum += 0x1_\n\n_elif cur_byte == key_buffer[16]:_\n\n_decrypted_domain_array.append(chr(sum))_\n\n_sum = 0_\n\n_elif cur_byte == 0:_\n\n_break_\n\n_index += 1_\n\n_decrypted_domain = ”.join(decrypted_domain_array)_\n\n_return decrypted_domain_\n\nhash_func method for calculating the generated directory name.\n\n_def hash_func(value):_\n\n_xor_key = 0x6521458a_\n\n_hash_output = 0_\n\n_for index in range(len(value)):_\n\n_cur_byte = ord(value[index])_\n\n_xor_value = cur_byte ^ xor_key_\n\n_hash_output = (hash_output + xor_value) % (2**32)_\n\n\n-----\n\n_right_value = (hash_output << 0xd) % (2 32)_\n\n_left_value = (hash_output >> 0x13) % (2**32)_\n\n_diff_value = right_value | left_value % (2**32)_\n\n_hash_output = (hash_output – diff_value) % (2**32)_\n\n_hash_string = hex(hash_output)[2:-1]_\n\n_if len(hash_string) < 8:_\n\n_diff = 8 – len(hash_string)_\n\n_output_string = (‘0’ * diff) + hash_string_\n\n_else:_\n\n_output_string = hash_string_\n\n_output_string = output_string.upper()_\n\n_return output_string_\n\n**IOCs**\n\nMd5:\n\n11147fd9ac12eec66d35b4d483aae71f\n\nd893d8347ecad1a3d85064d2f5bded4f\n\na8d3e403995132f9af33e4557be301a0\n\nC&C:\n\n[https://infolocalip.com/index.php](https://infolocalip.com/index.php)\n\n[https://tohertgopening.com/index.php](https://tohertgopening.com/index.php)\n\n[https://certipin.top/index.php](https://certipin.top/index.php)\n\nTE signature: InfoStealer.Win.AZORult.C\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-10-17 - The Emergence of the New Azorult 3.3.pdf"
    ],
    "report_names": [
        "2018-10-17 - The Emergence of the New Azorult 3.3.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535924,
    "ts_updated_at": 1743041679,
    "ts_creation_date": 1653704105,
    "ts_modification_date": 1653704105,
    "files": {
        "pdf": "https://archive.orkl.eu/3d8b3b887d5757a052a8294e66a306320803ae04.pdf",
        "text": "https://archive.orkl.eu/3d8b3b887d5757a052a8294e66a306320803ae04.txt",
        "img": "https://archive.orkl.eu/3d8b3b887d5757a052a8294e66a306320803ae04.jpg"
    }
}