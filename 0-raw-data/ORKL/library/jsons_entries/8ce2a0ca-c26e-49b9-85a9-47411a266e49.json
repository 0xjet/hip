{
    "id": "8ce2a0ca-c26e-49b9-85a9-47411a266e49",
    "created_at": "2023-05-06T02:09:49.698284Z",
    "updated_at": "2025-03-27T02:17:24.677234Z",
    "deleted_at": null,
    "sha1_hash": "6496e6ce2d27f9d07eed314ff3b270c000683217",
    "title": "2021-12-16 - Winnti is Coming - Evolution after Prosecution",
    "authors": "",
    "file_creation_date": "2023-05-05T02:08:29Z",
    "file_modification_date": "2023-05-05T02:08:29Z",
    "file_size": 694846,
    "plain_text": "# Winnti is Coming - Evolution after Prosecution@HITCON2021\n\n**[speakerdeck.com/aragorntseng/winnti-is-coming-evolution-after-prosecution-at-hitcon2021](https://speakerdeck.com/aragorntseng/winnti-is-coming-evolution-after-prosecution-at-hitcon2021)**\n\n**AragornTseng**\n\nDecember 16, 2021\n\n**[Research](https://speakerdeck.com/c/research)**\n\n**[0](https://speakerdeck.com/signin?return_to=%2Faragorntseng%2Fwinnti-is-coming-evolution-after-prosecution-at-hitcon2021)**\n\n**1.2k**\n\n## Winnti is Coming - Evolution after [email protected]\n\n\n-----\n\nSince APT41 was sued by the FBI last year, the group has not disappeared. Instead, they\nhave used more innovative and less well noticed techniques to evade detection by security\nproducts, such as:\n\n- Avoiding memory detection through dll hollowing technique\n\n- Using DPAPI to encrypt the real payload to make forensics more difficult.\n\n- Abusing the certificate to hide the payload in a signed PE file.\n\n- Using domain fronting techniques to hide the real IP address.\n\n- Using legitimate tools like InstallUtil to execute code and bypass application whitelisting.\n\nIn addition to malware that is known to be used by APT41, we also found some newly\ndeveloped malware. There are two new pieces of listening port malware.We also found a\nshellcode-based backdoor, Natwalk.\n\nThe group is also more careful in their usage of C2. They use DNS tunnelling extensively as\nwell as Cloudflare Worker to hide their real C2 IP.\n\nWe have observed that APT41 targeted telecommunications companies, key medical\ninstitutions, governments, and major infrastructures in various countries in 2021.\n\nThe prosecution did not deter them, but instead prompted them to evolve their attack\ntechniques, and make it harder for researchers to track and detect.\n\nIn this talk we will provide more details about the campaigns of APT41, including its\ninnovative TTPs, newly developed malware, lateral movement techniques, and the strategies\nthey used for C2 after they were sued by the FBI.\n\nWe also research the relation of the subgroups under APT41, like fishmaster and GroupCC.\n\n## Transcript\n\n1. Winnti is Coming - Evolution after Prosecution\n\nTeamT5\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_0.jpg)\n\n\n-----\n\n2. 2\n\nSecurity Engineer\n\nUCCU\n\nPeter Syu\n\n001\n\nPresident of \"Twice Promotion\n\nAgency“\n\nSecurity Engineer\n\nTom Lai\n\n456\n\nMalware Researcher\n\nAragorn Tseng\n\nChief Analyst\n\nCharles Li\n\nWho we are\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_1.jpg)\n\n3. AGENDA\n\n01\n\n02\n\n03\n\n04\n\n05\n\nInitial Access\n\nCobalt Strike Loader\n\nAPT41’s Backdoor\n\nC2 Hiding Technique\n\nRelation to other operations\n\n06 Takeaway\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_2.jpg)\n\n4. Who is Winnti?\n\n4\n\nhttps://twitter.com/jfslowik/status/1420924040047337474\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_3.jpg)\n\n\n-----\n\n5. Winnti? APT41?\n\n5\n\nMinistry of State Security of\n\nthe People's Republic of\n\nChina(MSS)\n\n - Winnti = APT41 ?\n\n - APT41 = Chengdu404 ?\n\n - Under APT41, it can be\n\ndivided into several\n\ngroups via different\n\ntechniques and targets\n\n  - The targets are very wide.\n\nIt is suspected that MSS\n\nhas integrated the\n\nresources, attack\n\ntechniques, and tools to\n\nmake this group looks\n\nbigger.\n\nAPT41\n\nAPT10 APT17 APT…\n\nIntegration?\n\nFishmaster\n\n/TAG-22\n\nGroupCC\n\nAmoeba Unknown\n\nGroup …\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_4.jpg)\n\n6. Target Country Talk in last section\n\n6\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_5.jpg)\n\n\n-----\n\n7. Target Industry\n\nHigh-tech\n\nHealthcare Airlines\n\nFinancial Research\n\nGovernment\n\nMedia\n\nGaming\n\nTelecom\n\nEnergy\n\nEducation\n\nManufacturing\n\n7\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_6.jpg)\n\n8. Compromise\n\nWinnti is Coming - Evolution after Prosecution\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_7.jpg)\n\n9. Initial Access\n\n \nCVE-2021-34527(printnightmare)\n\n \nCVE-2021-26855(proxylogon)\n\n \nSQL vulnerabilities\n\n \nphpmyadmin vulnerabilities\n\n \nWeb vulnerabilities\n\n \nFlash installer\n\n \nFake Decoy Icon\n\n9\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_8.jpg)\n\n10. Webshell Access\n\n10\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_9.jpg)\n\n\n-----\n\n11. Probe plugin\n\n11\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_10.jpg)\n\n12. Webshell Upload\n\n12\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_11.jpg)\n\n13. Catalina Log\n\n13\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_12.jpg)\n\n14. [View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_13.jpg)\n\n15. Scan by Shodan\n\nUnused Probe\n\n套件, 12, 67%\n\nUsing Probe\n\n套件, 6, 33%\n\n15\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_14.jpg)\n\n16. Post-Compromise\n\nWinnti is Coming - Evolution after Prosecution\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_15.jpg)\n\n\n-----\n\n17. New TTPs\n\n \nCertificate bypass\n\n \nDll hollowing technique\n\n \nInstallUtil\n\n \nEarly bird code injection\n\n \nCDN service and Cloudflare worker\n\n \nSome new backdoor\n\n17\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_16.jpg)\n\n\n-----\n\n18. Timeline for disseminating the Cobalt Strike\n\n2020.7\n\n2020.11\n\n2021.1\n\n2021.3\n\n2021.4\n\nChacha20\n\nshellcode or\n\nloader(Chatloader)\n\nappeared to\n\nextract Cobalt\n\nstrike Beacon\n\nUse CDN service in\n\nCobalt Strike,\n\nespecially DNS\n\nbeacon\n\nUse Cloudflare\n\nworker to hide real\n\nC2 IP\n\nUse certificate\n\nbypass and dll\n\nhollowing\n\ntechnique in\n\nChatloader\n\nUse multiple .NET\n\nloaders and\n\nmisuse InstallUtil\n\nto load Cobalt\n\nStrike 2021.6\n\nUse funnyswitch to\n\nload Cobalt Strike\n\nand use early bird\n\ncode injection\n\ntechnique\n\n18\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_17.jpg)\n\n\n-----\n\n19. Certificate bypass(MS13-098)\n\nセワシ\n\nValid\n\ncertificate\n\nValid\n\ncertificate\n\nセワシ\n\nShell\n\ncode\n\n19\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_18.jpg)\n\n20. Chatloader\n\n \nUses chacha20 algorithm to decrypt the payload\n\n \nMost of the payload is Cobalt Strike, but we have also seen another backdoor\n\n \nETW bypass\n\n \nDll hollowing\n\noffset length data\n\n0x0:0xB 0xC config nonce\n\n0xC:0xF 0x4 config crc32\n\n0x10:0x13 0x4 config_enc_length\n\n0x14:0x14+config_enc\n\n_length\n\nconfig_enc_length ciphertext\n\n0x100:0x120 0x20 config key\n\n20\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_19.jpg)\n\n\n-----\n\n21. length data\n\n0x4 Header\n\n0x4 Check User is SYSTEM\n\n0x4 Mutex trigger\n\n0x4 Delete Loader trigger\n\n0x4 Patch EtwEventWrite trigger\n\n0x4 Process Hollowing trigger\n\n0x4 Injected Process Name Length(x2)\n\nInjectedProcess\n\nName\n\nLength(x2)\n\nInjectedProcess Name\n\n0x4 Payload in Loader\n\n0x4 Payload Name Length(x2)\n\nPayload Name\n\nLength(x2)\n\nPayload Name\n\n0x4 Payload Size\n\n0x4 Payload FilePointor\n\n0x4 Payload crc32\n\n0xC Payload Nonce\n\nlength data\n\n0x4 Header\n\n0x4 Check User is SYSTEM\n\n0x4 Mutex trigger\n\n0x4 Delete Loader trigger\n\n0x4 Patch EtwEventWrite trigger\n\n0x4 Payload in Loader\n\n0x4 Payload Name Length(x2)\n\nPayload Name\n\nLength(x2)\n\nPayload Name\n\n0x4 Payload Size\n\n0x4 Payload FilePointor\n\n0x4 Payload crc32\n\n0xC Payload Nonce\n\nHeader:CB2F29AD\n\nHeader:8BD6488B\n\n21\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_20.jpg)\n\n\n-----\n\n22. Chatloader config example\n\n====== Decrypt Config ======\n\nConfig Nonce (12 bytes) = 0xb5 0x5e 0x14 0x8d 0x46 0xe1 0x2e 0x97 0x5d 0x3d 0x75\n0xf1\n\nConfig Nonce (base64) = tV4UjUbhLpddPXXx\n\nConfig CRC32 = 0xe 0xdc 0xac 0xad\n\nConfig CRC32 (base64) = DtysrQ==\n\nCiphertext length = 48\n\nConfig Key = 0xa2 0x42 0x99 0x5 0x5f 0x1f 0xc 0x14 0xcb 0xdd 0xb 0x1 0xdf 0xa6\n0x4c 0x34 0xf5 0xfd 0x3 0x3c 0xa7 0xf1 0xaf 0x30 0xa0 0xc7 0x5c 0x57 0x35 0x9d\n0x41 0xe0\n\nConfig Key (base64) = okKZBV8fDBTL3QsB36ZMNPX9Azyn8a8woMdcVzWdQeA=\n\n====== Config ======\n\nHead = 0xad 0x29 0x2f 0xcb\n\nCheck User is SYSTEM = 0\n\nMutex trigger = 0\n\nDelete Loader trigger = 0\n\nPatch EtwEventWrite trigger = 1\n\nPayload in Loader = 0\n\nPayload Name Length = 14\n\nPayload Name = Despxs.dll\n\nPayload Size = 3f800\n\nPayload FilePointor = 0\n\nPayload CRC32 = 0x40 0xf6 0x8f 0xa7\n\nPayload Nonce (12 bytes) = 0x93 0x49 0x68 0x79 0x6a 0xda 0xb5 0xcf 0xf0 0xf1 0xb3\n0x4f\n\n22\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_21.jpg)\n\n\n-----\n\n23. Dll Hollowing\n\nSigned file\n\nDll hijack\n\nlibEGL.dll\n\nwlbsctrl.dll\n\nFind target dll in\n\nSystem32\n\nKernel32.dll\n\nUser32.dll\n\naaclient.dll\n\nDLL Hollowing: Inject\n\nmalware payload in\n\naaclinet.dll’s .text section\n\nSynchost.exe\n\nCreate\n\nProcess\n\nSynchost.exe’s\n\nModule\n\nRead File\n\nLoad module\n\nlauncher\n\npayload\n\nChoose\n\naaclient.dll\n\ndll hollowing\n\n23\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_22.jpg)\n\n24. Dll Hollowing (cont.)\n\nhttps://github.com/forrest-orr/phantom-dll-hollower-poc 24\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_23.jpg)\n\n\n-----\n\n25. .NET loader\n\nInstallUtil.exe KBDHE475.dll\n\nkstvmutil.ax\n\npayload\n\n1.\nSystem.Configur\n\nation.Install.Inst\n\naller\n\n3.Inject\n\npayload via\n\nProcess\n\nHollowing\n\n2.Read File\n\nand decrypt\n\nwith AES\n\nsdiagnhost.exe\n\nPayload:\n\ncobalt strike or\n\nother backdoor:\n\nex: Natwalk\n\nUse InstallUtil to bypass application\n\nallowlist restrictions.\n\n.NET\n\nloader(obfuscation by\n\nConfuserEx)\n\n25\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_24.jpg)\n\n\n-----\n\n26. .NET loader structure\n\noffset data\n\noffset 38(h) –\n\n47\n\nmd5 hash of offset 48 until end\n\noffset 48-53 Sha256 as AES key\n\noffset 54-67 MD5 as AES IV\n\noffset 68 - end Encrypted payload with AES(ECB)\n\noffset data\n\noffset 0-3 must be 1F A4 3A AC\n\noffset 4-7 the length of the payload\n\noffset 8 - end malware payload\n\nVersion 2.63\n\noffset Data\n\noffset 84(h) -93 md5 hash of offset 48 until end\n\noffset 94-9f Sha256 as AES key\n\noffset a0-ab MD5 as AES IV\n\noffset ac - end Encrypted payload with AES(ECB)\n\noffset data\n\noffset 0-3 must be 0C C0 73 95\n\noffset 4-7 the length of the payload\n\noffset 8 - end malware payload\n\nVersion 17.102\n\nAfter decryption\n\n26\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_25.jpg)\n\n\n-----\n\n27. Funnyswitch loader\n\n \nName from ptsecurity*, which will inject .NET backdoor funny.dll in memory\n\n \nWe found new version loader(mcvsocfg.dll) which may target McAfee user\n\n \nE:\\VS2019_Project\\while_dll_ms\\whilte\\x64\\Release\\macoffe.pdb\n\n \nAnother :\n\nE:\\\\VS2019_Project\\\\prewhiltedll\\\\x64\\\\Release\\\\prewhiltedll.pdb\n\n \nWe found the new loader inject Cobalt Strike and funny.dll\n\n*https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winntiapt-41\nbackdoors-old-and-new/\n\nCobaltstrike funnydll 27\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_26.jpg)\n\n28. Charlotte loader\n\nSimple\n\n.Net loader\n\nCharlotte\n\nloader\n\nload inject\n\nCobaltstrike\n\ncheck.dll\n\n(MD5:8c5a174bbcd93e988bcb8681b542708f)\n\n28\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_27.jpg)\n\n\n-----\n\n29. Early bird code injection Loader\n\n \nUsing open source Alaris loader* to use\n\nsyscalls to run cobalt strike\n\n \nLoad PNG resource as payload and decrypt\n\nwith RC4\n\n \nUsing Detour to hook the Freelibrary API of\n\nthe launcher\n\n \nUsing early bird code injection technique\n\n \nNtTestAlert\n\n \nKiUserApcDispatcher\n\n*https://github.com/cribdragg3r/Alaris\n29\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_28.jpg)\n\n30. New version loader 30\n\nmsdtc.exe oci.dll\n\nGet\n\nComputername\n\n(sha1) as rc4 key to\n\ndecrypt payload\n\ncobalt strike\n\n(bind TCP)\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_29.jpg)\n\n\n-----\n\n31. Fishmaster loader\n\n \nPDB : C:\\Users\\test\\Desktop\\fishmaster\\x64\\Release\\fishmaster.pdb\n\n \nSome have “Bidenhappyhappyhappy” in strings\n\n \nTwo ways to decrypt payload\n\n \nXor with hardcode key, ex:” Bsiq_gsus” or “miat_mg”\n\n \nUse UUIDShellcode and callback function\n\n31\n\nFishmaster operation – TAG-22\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_30.jpg)\n\n32. loader used by GroupCC 32\n\nSigned file\n\nTemp.tmp\n\nwinprint.exe\n\nrundll32.exe\n\n2.Create\n\nrundll32.exe\n\nProcess\n\n1.Read File binary\n\nStage_1.shellcode\n\n4.Read File\n\n5.decode\n\ncobaltstrike\n\n3.Inject\n\nshellcode in\n\nrundll32\n\n  - winprint.exe first reads a piece of shellcode from the payload\n\nfile and then opens rundll32.exe, calls RtlCreateUserThread to\n\nrun the first stage shellcode in rundll32.exe\n\n  - The first stage shellcode will read the payload file again, use\n\nVirtualAlloc to allocate memory in rundll32.exe, and inject the\n\npayload and decrypt it, finally, it will call EtwpCreateEtwThread\n\nto move the thread to the starting point of the cobalt strike.\n\nGroupCC\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_31.jpg)\n\n\n-----\n\n33. Backdoor\n\nWinnti is Coming - Evolution after Prosecution\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_32.jpg)\n\n34. APT41’s Backdoor during 2020-2021\n\nNatwalk\n\nAPT41\n\nHIGHNOON\n\nFunnydll\n\nShadowpad\n\nCobalt strike\n\nPlugX\n\nSpyder\n\nWinnti\n\nLinux RAT\n\n34\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_33.jpg)\n\n35. Funnydll*\n\nconfig\n\nPassword=\"test\" StartTime=\"0\" EndTime=\"24\"\n\nWeekDays=\"0,1,2,3,4,5,6\"> address=\"4iiiessb.wikimedia.vip\" port=\"443\" interval=\"3060\"/>\n\nmcvsocfg.dll Stage_1.shellcode Funny.dll\n\nBase64+AES\n\ndecrypt\n\nJs module\n\n35\n\n*https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winntiapt-41\nbackdoors-old-and-new/\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_34.jpg)\n\n\n-----\n\n36. Funnydll\n\n \nIn 2020, the config of funnydll is plaintext, in 2021, the config will decrypt by\n\nfunny.core.run which using AES and base64\n\n \nCommand, protocol, and js module are same as 2020*\n\n36\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_35.jpg)\n\n37. Shadowpad\n\n \nAPT41 used the new builder of shadowpad in 2021, which was mentioned in\n\nPtsecurity’s report* which used new obfuscation method and decryption\n\nmethod for configuration\n\n \nWe think this builder was a shared Tool, because we have also seen Naikon\n\nTeam use this builder\n\n \nMd5 of the loader:3520e591065d3174999cc254e6f3dbf5\n\n37\n\ndef decrypt_string(src):\n\nkey = struct.unpack(\"data_len = struct.unpack(\"data = src[4:4+data_len]\n\nresult = \"\"\n\ni=0\n\nwhile(i < data_len):\n\ntmp = key\n\ntmp += tmp\n\nkey = key + (( tmp * 8 ) & 0xFFFFFFFF) + 0x107E666D\n\nresult += chr(((HIBYTE(key) + BYTE2(key) + BYTE1(key) + LOBYTE(key)) ^\nord(data[i])) & 0xFF)\n\ni+=1\n\nreturn result\n\n*https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winntiapt-41\nbackdoors-old-and-new/\n\nThe method to decrypt the\n\nstring of the configuration\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_36.jpg)\n\n\n-----\n\n38. Shadowpad config example\n\n38\n\nid = 6/18/2021 11:26:19 AM\n\nMessenger = TEST\n\nBinary Path = %ALLUSERSPROFILE%\\Microsoft\\WinLSAM\\\n\nBinary Name = LSAM.exe\n\nLoader Name = log.dll\n\nPayload Name = log.dll.dat\n\nService Name = SystemAssociationManager\n\nService Display Name = System Association Manager\n\nService Description = This service provides support for the device association\n\nsoftware. If this service is disabled, devices may be configured with outdated\n\nsoftware, and may not work correctly.\n\nRegistry Key Install = SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\nRegistry Value Name = LocalSystemAssociationManager\n\nInject Target 1 = %windir%\\system32\\svchost.exe\n\nInject Target 2 = %windir%\\system32\\wininit.exe\n\nInject Target 3 =\n\nInject Target 4 =\n\nSupposed to have 4 server\n\nServer1 = TCP://1dfpi2d8kx.wikimedia.vip:443\n\nServer2 =\n\nServer3 =\n\nServer4 =\n\nSocket 1 = SOCKS4\n\nSocket 2 = SOCKS4\n\nSocket 3 = SOCKS5\n\nSocket 4 = SOCKS5\n\nDNS 1 = 8.8.8.8\n\nDNS 2 = 8.8.8.8\n\nDNS 3 = 8.8.8.8\n\nDNS 4 = 8.8.8.8\n\nconfig offset:0x96\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_37.jpg)\n\n39. Shadowpad Decryption Routine\n\n39\n\nOld Version\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_38.jpg)\n\n\n-----\n\n40. Shadowpad Decryption Routine\n\nNew Version\n\n40\n\nShadowpad\n\nDecrypt_A\n\nModule\n\nShadowpad\n\nDecrypt_B\n\nTCP Packet\n\nQuicklz\n\nDecompress\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_39.jpg)\n\n41. Natwalk\n\n \nDropped by chatloader\n\n \nFirst seen in the wild in 2021/3, and first seen on VT in 2020/9\n\n \nShellcode based backdoor\n\n \nIt uses register + offset to call the Windows api (also used by crosswalk)\n\n \nThe name is from the unique file path it will look up :\n\n“%AllUserProfile%\\UTXP\\nat\\”\n\nrbx = 7FEF1431534\n\n41\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_40.jpg)\n\n\n-----\n\n42. Natwalk(cont.)\n\n \nTransport protocol\n\n \nRaw TCP socket\n\n \nHTTPS:Post requests to C2 server\n\n \ngtsid : generated by CryptGenRamdom\n\n \ngtuvid : generated by CryptGenRamdom and md5 operation\n\n \nUses chacha20 md5 to encrypt/decrypt the message to/from C2 server\n\n42\n\nthe post request of Natwalk\n\nraw TCP\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_41.jpg)\n\n43. Natwalk(cont.)\n\n \nCrosswalk also uses register + offset to call the Windows api in shellcode\n\n \nFirst command code are both 0x64\n\n \nBut commands are different\n\n43\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_42.jpg)\n\n\n-----\n\n44. Natwalk(cont.)\n\ncommand description\n\n0x64 Close sessions\n\n0x5C Update the ChaCha20 key for\n\nC2 communication\n\n0x66 Change the current status\n\n0x74 Terminate all threads\n\n0x78 kill process\n\n0x7c Run plug-in\n\n0x82 Enumerate user info\n\n0x8c Send config to C2\n\n0x8E Load additional config\n\n44\n\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Intern\n\net Settings\n\nProxyServer\n\ntexplorer.exe\n\n%AllUsersProfile%\\UTXP\\nat\\\n\n%02X\n\nPOST\n\nMozilla/5.0 Chrome/72.0.3626.109 Safari/537.36\n\ngtsid:\n\ngtuvid:\n\nhttps://msdn.microsoft.com\n\nhttps://www.google.com\n\nhttps://www.twitter.com\n\nhttps://www.facebook.com\n\nUnique string in the bottom of Natwalk\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_43.jpg)\n\n\n-----\n\n45. HIGHNOON(Botdll64)\n\nwbemcomn.dll sdhasjk.dll\n\nWmiApSrv.exe\n\nDll hijack IAT modify\n\nDecrypt\n\npayload with\n\nDPIAPI/AES\n\nBotdll64.dll\n\nPacked with\n\nUPX in\n\nmemory\n\nHIGHNOON\n\nWindivert.dll\n\nWindivert.sys\n\nUser mode\n\nKernel\n\nmode\n\nReflective\n\ninjection\n\n(1) packet\n\n(2a)\n\nMatching\n\npacket\n\n(2b) non-matching packet\n\n(3) re\ninjected\n\npacket\n\n45\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_44.jpg)\n\n46. HIGHNOON Loader\n\nDPAPI version\n\nAES version\n\nchoose the driver determined by the dwMinorVersion 46\n\n“F:\\2019\\RedEye\\Door\\Bin\\Middle64.pdb”\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_45.jpg)\n\n\n-----\n\n47. HIGHNOON command\n\n \nCommand is same as the HIGHNOON mentioned by Macnica* in 2018\n\ncommand description\n\n0 Bind Network Socket\n\n1 Check IP address change and\n\nReceive Packet, Console Output\n\n3 Console Output\n\n4 Read //DEV//NULL and Console\n\nOutput\n\n5 Check IP address change and\n\nReceive Packet, Console Output\n\n*https://hitcon.org/2018/pacific/downloads/1214-R2/1330-1400.pdf\n\n47\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_46.jpg)\n\n48. C2 Hiding (Domain Fronting)\n\nWinnti is Coming - Evolution after Prosecution\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_47.jpg)\n\n49. CDN service\n\n \nHttps beacon : direct use CDN service to hide real C2 IP\n\n \nEx: microgoogle[.]ml\n\n \nDNS beacon\n\nReal C2 IP\n\n49\n\nns1.hkserch.com\n\nNo resolution\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_48.jpg)\n\n50. parks their DNS\n\nbeacon C2 domain on\n\nsome specific IP, ex:\n\n8.8.8.251, 4.2.2.2\n\nSome C2 domain in this slide are used by other group\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_49.jpg)\n\n\n-----\n\n51. Cloudflare Worker\n\n \nuse Cloudflare Workers as redirector to hide the real C2 domain and IP\n\nReal C2\n\nproxy\n\nVictim\n\nCloudfare worker\n\ncdn.cdnfree.workers.dev\n\n51\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_50.jpg)\n\n\n-----\n\n52. Fastly (GroupCC)\n\n52\n\nBeaconType - HTTPS\n\nPort - 443\n\nSleepTime - 1000\n\nMaxGetSize - 1398119\n\nJitter - 10\n\nMaxDNS - Not Found\n\nPublicKey_MD5 - 9ee3e0425ade426af0cb07094aa29ebc\n\nC2Server - pypi.python.org,/latest/pip-check\n\nUserAgent - Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36\n\n(KHTML, like Gecko) Chrome/84.0.4147.125 Safari/537.36\n\nHttpPostUri - /latest/check\n\n…\n\nPipeName - Not Found\n\nDNS_Idle - Not Found\n\nDNS_Sleep - Not Found\n\nSSH_Host - Not Found\n\nSSH_Port - Not Found\n\nSSH_Username - Not Found\n\nSSH_Password_Plaintext - Not Found\n\nSSH_Password_Pubkey - Not Found\n\nSSH_Banner - Host: pypi2-python.org\n\n…\n\nWatermark - 426352781\n\n…\n\nProcInject_AllocationMethod - VirtualAllocEx\n\nbUsesCookies - True\n\nHostHeader - Host: pypi2-python.org\n\n…\n\npypi2-python.org.global.prod.fastly.net\n\npypi2-python.org\n\nReal C2 IP\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_51.jpg)\n\n53. Relation to other operations\n\nWinnti is Coming - Evolution after Prosecution\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_52.jpg)\n\n\n-----\n\n54. Cobalt strike\n\npayload\n\nSame Xor key:\n\n0x3A\n\nFunnyswitch\n\ndropper which\n\ninjected\n\ncobalt strike\n\nITW Url\n\nFishmaster operation – TAG-22*\n\nFunnyswitch\n\ndropper which\n\ninjected funnydll\n\nConnection of\n\nAPT41 and\n\nfishmaster operation\n\nNew builder\n\nof Shadowpad\n\nIR case\n\nSame PDB string\n\n  - https://www.recordedfuture.com/chinese-group\ntag-22-targets-nepal-philippines-taiwan/\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_53.jpg)\n\n\n-----\n\n55. Fishmaster v.s GroupCC\n\nFishmaster operation – BIOPASS RAT*\n\nOnline.txt\n\nc1222.txt\n\nSilverlight_ins.exe\n\nHtop6K4c.txt\n\nBrowserPlugin.exe\n\n[Emergency] Work\nover Well 105CTC\n01 - PVD 03 Rig on\n\n28 July 2021.com\n\nGroupCC\n\nBIOPASS RAT Python Script (local online server)\n*https://www.trendmicro.com/en_us/research/21/g\n\n/biopass-rat-new-malware-sniffs-victims-via-live\nstreaming.html\n\n(C1222 module)\n\n55\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_54.jpg)\n\n56. GroupCC\n\nFishmaster\n\nBIOPASS RAT Python Script (local online server)\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_55.jpg)\n\n57. GroupCC\n\nFishmaster\n\nBIOPASS RAT Python Script (C1222 module)\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_56.jpg)\n\n\n-----\n\n58. Fishmaster Used(stolen) certificate\n\n \nHappytuk Co.,Ltd.\n\n \nSerial Number : 0E D4 DF 10 33 39 3F F2 AF 41 C5 71 A6 AA 19 D7\n\n \nRhaon Entertainment Inc\n\n \nSerial Number : 06 80 8C 59 34 DA 03 6A 12 97 A9 36 D7 2E 93 D4\n\n58\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_57.jpg)\n\n59. GroupCC Used(stolen) certificate\n\n \nQuickteck.com\n\n \nSerial Number : 70 D8 96 11 7E 15 30 2C 7E EF EC B2 89 B3 BF E0\n\n \n주식회사 엘리시온랩(Elysion Lab Co., Ltd.)\n\n \nSerial Number : 03 D4 33 FD C2 46 9E 9F D8 78 C8 0B C0 54 51 47\n\n \nARGOS LABS\n\n \nSerial Number : 00 F7 B7 5C 60 5B 00 83 95 73 8A AC 06 AB E3 B4 70\n\n \n1.A Connect GmbH\n\n \nSerial Number : 00 A7 E4 DE D4 BF 94 9D 15 AA 42 01 84 3F 1A B6 4D\n\n59\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_58.jpg)\n\n\n-----\n\n60. Fishmaster v.s GroupCC 60\n\n \nShared Tool – Biopass RAT\n\n \nSimilar TTPs\n\n \nUses some stolen or revoked certificare\n\n \nUses Legitimate installer (like Flash, Silverlight, BrowserPlugin)\n\n \nUse aliyun as payload sites\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_59.jpg)\n\n\n-----\n\n61. Amoeba v.s Fishmaster v.s GroupCC 61\n\n \nAmoeba v.s. Fishmaster\n\n \nTwo possibilities\n\n \nShared C2\n\n \n163.138.137.235\n\n \n93.180.156.77\n\n \nShared customized CoboltStrike\n\n \nXor key : 0x3A\n\n \nFishmaster v.s. GroupCC\n\n \nShared Tool : Biopass RAT\n\n \nSimilar TTPs\n\n \nUses some stolen or revoked certificate\n\n \nUses Legitimate installer\n\n \nUse aliyun as payload sites\n\nAmoeba Fishmaster GroupCC\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_60.jpg)\n\n\n-----\n\n62. Other operation\n\ncobaltstrike\n\ncobaltstrike\n\nIR case\n\nIR case\n\n#Goblin\n\npanda\n\n*RedFoxtrot\n\nDrop PCshare\n\n# https://community.riskiq.com/article/56fa1b2f\n\n  - https://go.recordedfuture.com/hubfs/reports/cta-2021-0616.pdf\n\nsecurity_audit_template_final.doc\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_61.jpg)\n\n63. # https://community.riskiq.com/article/56fa1b2f\n\n  - https://go.recordedfuture.com/hubfs/reports/cta-2021-0616.pdf\n\nsecurity_audit_template_final.doc\n\n#Goblin panda\n\n*RedFoxtrot\n\nDrop PCshare\n\nConnection to\n\nGobling Panda or\n\nOther Chinese APT\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_62.jpg)\n\n64. HW operation(護網行動)\n\n \nTo detect the security issues of key national infrastructure, and to test their\n\nevent monitoring and ability to quickly coordinate with emergency incident\n\n \nThe target involves many industries, including government, finance, electricity,\n\nand business key enterprises in China.\n\n \nFrom OSINT, the operation started from 4/8 in 2021\n\n64\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_63.jpg)\n\n65. 南京木百文化传媒有限公司.exe\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_64.jpg)\n\n\n-----\n\n66. Maybe link to HW operation\n\n66\n\nCobalt strike loader in IR case\n\nwhich use alaris loader with\n\nresource png payload\n\nSame loader\n\n南京木百文化传媒有限公司.exe\n\nFunnyswitch\n\nSame unique\n\nshellcode in\n\ncaculating\n\napi hash\n\n调整中移在线服务有限公司\n\n职工五险一金缴纳比例的通\n\n知.exe\n\nCobalt strike loader in IR case\n\nwhich used early bird code injection\n\nVPN统一身份证认证\n\nID.exe\n\n运维安全管理与审计系统\n\n单点登录插件.exe\n\nSame Cobalt\n\nstrike payload\n\nheader\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_65.jpg)\n\n67. Takeaway\n\n \nVarious kind of cobalt strike loader and some new attack techniques\n\n \nNew backdoor ex: Natwalk\n\n \nC2 hiding techniques\n\n \nRelation to other operations\n\n67\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_66.jpg)\n\n\n-----\n\n68. IOC\n\n68\n\n \nChatloader\n\n7ee9b79f4b5e19547707cbd960d4292f\n\nF5158addf976243ffc19449e74c4bbad\n\n1015fa861318acbbfd405e54620aa5e3\n\na1d972a6aa398d0230e577227b28e499\n\n \n.NET loader\n\nbd2d24f0ffa3d38cb5415b0de2f58bb3\n\n \nFunnyswitch loader\n\ne0a9d82b959222d9665c0b4e57594a75\n\n07a61e3985b22ec859e09fa16fd28b85\n\nd720ac7a6d054f87dbafb03e83bcb97c\n\nF85d1c2189e261d8d3f0199bbdda3849\n\n5b2a9a12d0c5d44537637cf04d93bec5\n\n \nEarly bird code injection loader\n\n4598c75007b3cd766216086415cc4335\n\nFd6ae1b8713746e3620386a5e6454a8d\n\nb028b4f8421361f2485948ca7018a2b0\n\n \nNatwalk\n\n1d36404f85d94bea6c976044cb342f24\n\n7c6e75e70d29e77f78ea708e01e19c36\n\n \nHIGHNOON loader\n\n407b5200c061123c9bd32e7eea21a57b\n\n5b99fa01c72cebc53a76cc72e9581189\n\n \nFunnydll\n\ne0a9d82b959222d9665c0b4e57594a75\n\n \nSpyder\n\nfba77006e8f8f3db6aac86211fa047fb\n\n \nShadowpad\n\naf7cef9e0e6601cae068b73787e3ae81\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_67.jpg)\n\n\n-----\n\n69. IOC\n\n69\n\nsymantecupd.com\n\nmicrosoftonlineupdate.dynamic\ndns.net\n\nwww.sinnb.com\n\npip.pythoncdn.com\n\nimg.hmmvm.com\n\nreg.pythoncdn.com\n\nbbwebt.com\n\nns1.tkti.me\n\ntest.tkti.me\nns1.microsofts.freeddns.com\n\napi.aws3.workers.dev\n\nns1.hkserch.com\n\ngodaddy1.txwl.pw\n\ngodaddy2.txwl.pw\n\nns.cdn06.tk\n\nupdate.facebookdocs.com\n\nns1.dns-dropbox.com\n\nns.cloud20.tk\n\nns.cloud01.tk\n\nns1.token.dns05.com\n\nsculpture.ns01.info\n\nwork.cloud20.tk\n\nwork.cloud01.tk\n\nhelp01.softether.net\n\ncloud.api-json.workers.dev\n\nupdate.microsoft-api.workers.dev\n\nup.linux-headers.com\n\np.samkdd.com\n\nns1.microsoftskype.ml\n\nns1.hongk.cf\n\nns1.163qq.cf\n\n163qq.cf\n\ndepth.ddns.info\n\nyjij4bpade.nslookup.club\nooliviaa.ddns.info\n\nmootoorheaad.ns01.info\n\ntoken.dns04.com\n\nns1.watson.misecure.com\n\nvt.livehost.live\n\n\n-----\n\nsociomanagement.com\nns1.hash-prime.com\n\nwntc.livehost.live\n\nsmtp.biti.ph\n\nperfeito.my\n\ncdn.cdnfree.workers.dev\n\nwww.microsofthelp.dns1.us\n\nns1.mssetting.com\n\nwww.corpsolution.net\n\nwww.mircoupdate.https443.net\n\npublicca.twhinet.workers.dev\n\nmicrogoogle.ml\n\nwww.google-dev.tk\n\napi.gov-tw.workers.dev\n\n103.255.179.54\n\nwww.omgod.org\n\n154.223.175.70\n\n687eb876e047.kasprsky.info\n\nzk4c9u55.wikimedia.vip\n\n193.38.54.110\n\napi.aws3.workers.dev\n\n4iiiessb.wikimedia.vip\n\n45.32.123.1\n\n158.247.215.150\n\nntp.windows-time.com\n\ntrulwkg5c.tg9f6zwkx.icu\n\nwindowsupdate.microsoft.365filtering.com\n\nwustat.windows.365filtering.com\n\nti0wddsnv.wikimedia.vip\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_68.jpg)\n\n\n-----\n\n70. Reference\n\n \n[1] https://hello.global.ntt/-/media/ntt/global/insights/white-papers/the-operations-ofwinnti\ngroup.pdf\n\n \n[2] https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-orwinnti-apt-41\nbackdoors-old-and-new/\n\n \n[3] https://www.lac.co.jp/lacwatch/report/20210521_002618.html\n\n \n[4] https://www.recordedfuture.com/chinese-group-tag-22-targets-nepal-philippinestaiwan/\n\n \n[5] https://decoded.avast.io/luigicamastra/backdoored-client-from-mongolian-camonpass/\n\n \n[6] https://hitcon.org/2018/pacific/downloads/1214-R2/1330-1400.pdf\n\n \n[7] https://www.trendmicro.com/en_us/research/21/g/biopass-rat-new-malware-sniffsvictims-via-live\nstreaming.html\n\n70\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_69.jpg)\n\n71. [[email protected]@gmail.com](https://speakerdeck.com/cdn-cgi/l/email-protection)\n\nTHANK YOU!\n\n[View Slide](https://files.speakerdeck.com/presentations/3be0beef157243fa93f5adc27675d3f4/slide_70.jpg)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-16 - Winnti is Coming - Evolution after Prosecution.pdf"
    ],
    "report_names": [
        "2021-12-16 - Winnti is Coming - Evolution after Prosecution.pdf"
    ],
    "threat_actors": [
        {
            "id": "2150d1ac-edf0-46d4-a78a-a8899e45b2b5",
            "created_at": "2022-10-25T15:50:23.269339Z",
            "updated_at": "2025-03-27T02:00:55.416524Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "APT17",
                "Deputy Dog"
            ],
            "source_name": "MITRE:APT17",
            "tools": [
                "BLACKCOFFEE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1aead86d-0c57-4e3b-b464-a69f6de20cde",
            "created_at": "2023-01-06T13:46:38.318176Z",
            "updated_at": "2025-03-27T02:00:02.803684Z",
            "deleted_at": null,
            "main_name": "DAGGER PANDA",
            "aliases": [
                "IceFog",
                "RedFoxtrot",
                "Red Wendigo",
                "PLA Unit 69010"
            ],
            "source_name": "MISPGALAXY:DAGGER PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "873919c0-bc6a-4c19-b18d-c107e4aa3d20",
            "created_at": "2023-01-06T13:46:39.138138Z",
            "updated_at": "2025-03-27T02:00:03.005534Z",
            "deleted_at": null,
            "main_name": "Higaisa",
            "aliases": [],
            "source_name": "MISPGALAXY:Higaisa",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6a0effeb-3ee2-4a67-9a9f-ef5c330b1c3a",
            "created_at": "2023-09-07T02:02:47.827633Z",
            "updated_at": "2025-03-27T02:02:10.114881Z",
            "deleted_at": null,
            "main_name": "RedHotel",
            "aliases": [
                "RedHotel",
                "TAG-22"
            ],
            "source_name": "ETDA:RedHotel",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Brute Ratel",
                "Brute Ratel C4",
                "Cobalt Strike",
                "CobaltStrike",
                "FunnySwitch",
                "POISONPLUG.SHADOW",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "ShadowPad Winnti",
                "Spyder",
                "Winnti",
                "XShellGhost",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ad154227-6fcf-43c5-a540-0c09534e040f",
            "created_at": "2024-05-01T02:03:07.952927Z",
            "updated_at": "2025-03-27T02:05:17.267077Z",
            "deleted_at": null,
            "main_name": "BRONZE GENEVA",
            "aliases": [
                "BRONZE STERLING ",
                "CTG-5326 ",
                "Naikon ",
                "Override Panda ",
                "APT30 "
            ],
            "source_name": "Secureworks:BRONZE GENEVA",
            "tools": [
                " ShadowPad",
                "Lecna"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2912fc0-c34e-4e4b-82e9-665416c8fe32",
            "created_at": "2023-04-20T02:01:50.979595Z",
            "updated_at": "2025-03-27T02:00:02.79494Z",
            "deleted_at": null,
            "main_name": "Naikon",
            "aliases": [
                "BRONZE GENEVA",
                "G0019",
                "Naikon",
                "BRONZE STERLING",
                "G0013",
                "PLA Unit 78020",
                "OVERRIDE PANDA",
                "Camerashy"
            ],
            "source_name": "MISPGALAXY:Naikon",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "30c9c492-afc6-4aa1-8fe6-cecffed946e0",
            "created_at": "2022-10-25T15:50:23.400822Z",
            "updated_at": "2025-03-27T02:00:55.461334Z",
            "deleted_at": null,
            "main_name": "Higaisa",
            "aliases": [
                "Higaisa"
            ],
            "source_name": "MITRE:Higaisa",
            "tools": [
                "PlugX",
                "certutil",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9f1ce7e3-77cd-4af0-bedb-1643f55c9baf",
            "created_at": "2022-10-25T15:50:23.31611Z",
            "updated_at": "2025-03-27T02:00:55.439974Z",
            "deleted_at": null,
            "main_name": "Naikon",
            "aliases": [
                "Naikon"
            ],
            "source_name": "MITRE:Naikon",
            "tools": [
                "ftp",
                "netsh",
                "WinMM",
                "Systeminfo",
                "RainyDay",
                "RARSTONE",
                "HDoor",
                "Sys10",
                "SslMM",
                "PsExec",
                "Tasklist",
                "Aria-body"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bbb1ee4e-bbe9-44de-8f46-8e7fec09f695",
            "created_at": "2022-10-25T16:07:24.120424Z",
            "updated_at": "2025-03-27T02:02:10.112981Z",
            "deleted_at": null,
            "main_name": "RedFoxtrot",
            "aliases": [
                "Moshen Dragon",
                "Nomad Panda",
                "TEMP.Trident"
            ],
            "source_name": "ETDA:RedFoxtrot",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Fucobha",
                "GUNTERS",
                "Gen:Trojan.Heur.PT",
                "Icefog",
                "Impacket",
                "Kaba",
                "Korplug",
                "PCShare",
                "POISONPLUG.SHADOW",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "XShellGhost",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1edcac0b-efd9-47b1-9aca-33827d5bd085",
            "created_at": "2024-05-01T02:03:07.964773Z",
            "updated_at": "2025-03-27T02:05:17.273595Z",
            "deleted_at": null,
            "main_name": "BRONZE KEYSTONE",
            "aliases": [
                "Aurora Panda ",
                "DeputyDog ",
                "Group 72 ",
                "Hidden Lynx ",
                "Shell Crew",
                "TG-8153 ",
                "Tailgater Team",
                "APT17 "
            ],
            "source_name": "Secureworks:BRONZE KEYSTONE",
            "tools": [
                " BlackCoffee",
                " DeputyDog",
                " Derusbi",
                " Gh0stHTTPSDropper",
                " HiKit",
                " InternalCMD",
                " PlugX",
                " PoisonIvy",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c7ecb0e-337c-478f-95d4-7dbe9ba44c39",
            "created_at": "2022-10-25T16:07:23.690871Z",
            "updated_at": "2025-03-27T02:02:09.921431Z",
            "deleted_at": null,
            "main_name": "Goblin Panda",
            "aliases": [
                "1937CN",
                "Conimes",
                "Cycldek",
                "Goblin Panda"
            ],
            "source_name": "ETDA:Goblin Panda",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "BackDoor-FBZT!52D84425CDF2",
                "BlueCore",
                "BrowsingHistoryView",
                "ChromePass",
                "CoreLoader",
                "Custom HDoor",
                "Destroy RAT",
                "DestroyRAT",
                "DropPhone",
                "FoundCore",
                "HDoor",
                "HTTPTunnel",
                "JsonCookies",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "NBTscan",
                "NewCore RAT",
                "PlugX",
                "ProcDump",
                "PsExec",
                "QCRat",
                "RainyDay",
                "RedCore",
                "RedDelta",
                "RoyalRoad",
                "Sisfader",
                "Sisfader RAT",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trojan.Win32.Staser.ytq",
                "USBCulprit",
                "Win32/Zegost.BW",
                "Xamtrav",
                "ZeGhost",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7d553b83-a7b2-431f-9bc9-08da59f3c4ea",
            "created_at": "2023-01-06T13:46:39.444946Z",
            "updated_at": "2025-03-27T02:00:03.093712Z",
            "deleted_at": null,
            "main_name": "GOBLIN PANDA",
            "aliases": [
                "Conimes",
                "Cycldek"
            ],
            "source_name": "MISPGALAXY:GOBLIN PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b69484be-98d1-49e6-aed1-a28dbf65176a",
            "created_at": "2022-10-25T16:07:23.886782Z",
            "updated_at": "2025-03-27T02:02:10.014032Z",
            "deleted_at": null,
            "main_name": "Naikon",
            "aliases": [
                "Hellsing",
                "ITG06",
                "Lotus Panda",
                "Naikon",
                "Operation CameraShy"
            ],
            "source_name": "ETDA:Naikon",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "AR",
                "ARL",
                "Agent.dhwf",
                "Aria-body",
                "Aria-body loader",
                "Asset Reconnaissance Lighthouse",
                "BackBend",
                "Creamsicle",
                "Custom HDoor",
                "Destroy RAT",
                "DestroyRAT",
                "Flashflood",
                "FoundCore",
                "Gemcutter",
                "HDoor",
                "JadeRAT",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "LadonGo",
                "Lecna",
                "Living off the Land",
                "NBTscan",
                "Naikon",
                "NetEagle",
                "Neteagle_Scout",
                "NewCore RAT",
                "Orangeade",
                "PlugX",
                "Quarks PwDump",
                "RARSTONE",
                "RainyDay",
                "RedDelta",
                "RoyalRoad",
                "Sacto",
                "Sandboxie",
                "ScoutEagle",
                "Shipshape",
                "Sisfader",
                "Sisfader RAT",
                "Sogu",
                "SslMM",
                "Sys10",
                "TIGERPLUG",
                "TVT",
                "TeamViewer",
                "Thoper",
                "WinMM",
                "Xamtrav",
                "XsFunction",
                "ZRLnk",
                "nbtscan",
                "nokian",
                "norton",
                "xsControl",
                "xsPlus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1683338989,
    "ts_updated_at": 1743041844,
    "ts_creation_date": 1683252509,
    "ts_modification_date": 1683252509,
    "files": {
        "pdf": "https://archive.orkl.eu/6496e6ce2d27f9d07eed314ff3b270c000683217.pdf",
        "text": "https://archive.orkl.eu/6496e6ce2d27f9d07eed314ff3b270c000683217.txt",
        "img": "https://archive.orkl.eu/6496e6ce2d27f9d07eed314ff3b270c000683217.jpg"
    }
}