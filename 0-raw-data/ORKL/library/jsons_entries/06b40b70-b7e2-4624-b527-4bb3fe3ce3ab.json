{
    "id": "06b40b70-b7e2-4624-b527-4bb3fe3ce3ab",
    "created_at": "2022-10-25T16:48:19.824949Z",
    "updated_at": "2025-03-27T02:13:19.617881Z",
    "deleted_at": null,
    "sha1_hash": "fc1d350810c19c94b1f3642fa08f50bf914ab821",
    "title": "Plugx Goes To The Registry (And India)",
    "authors": "Sophos",
    "file_creation_date": "2015-02-25T11:35:37Z",
    "file_modification_date": "2015-02-25T06:43:04Z",
    "file_size": 3458573,
    "plain_text": "# PlugX goes to the registry\n (and India)\n\n### By Gabor Szappanos, Principal Researcher\n\n\n-----\n\n## Contents\n\n##### Overview 2\n\n PlugX in registry 3\n\n Peeled Tomato 4\n\n Multi-staged installer shellcode 17\n\n\n-----\n\n#### Overview\n[Recently we published a paper about the capabilities of APT groups [https://nakedsecurity.](https://nakedsecurity.sophos.com/2015/02/03/exploit-this-evaluating-the-exploit-skills-of-malware-gr)\n[sophos.com/2015/02/03/exploit-this-evaluating-the-exploit-skills-of-malware-groups/].](https://nakedsecurity.sophos.com/2015/02/03/exploit-this-evaluating-the-exploit-skills-of-malware-gr)\n\nOne of the conclusions of the paper was that the authors behind the targeted attack campaigns\nusually have little knowledge about the actual exploit they are using to distribute their malware.\nBut at the same time, we warned our readers never to underestimate them, because otherwise\nthey are skilled, and quite capable of developing sophisticated backdoors.\n\nOne of the worst performances in our comparison of exploit development belonged to the\ninfamous PlugX malware group(s). However, they recently came out with a couple of significant\ndevelopments in the backdoor component, demonstrating the point above.\n\nOne of the improvements was the introduction of a peer-to-peer communication channel to other\n[infected hosts [http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html]. Variants using this](http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html)\n[technology have previously been spotted in the Rotten Tomato campaign [http://blogs.sophos.](http://blogs.sophos.com/2014/10/30/the-rotten-tomato-campaign-new-sophoslabs-research-on-apts/)\n[com/2014/10/30/the-rotten-tomato-campaign-new-sophoslabs-research-on-apts/].](http://blogs.sophos.com/2014/10/30/the-rotten-tomato-campaign-new-sophoslabs-research-on-apts/)\n\nNow additional samples have shown up from this generation. But in addition to the new\ncommunication method, some of them were showing another new characteristic: the payload\nwas not stored as separate files, or embedded within the loader DLL, but instead was saved to\nthe registry.\n\nMalware hiding components in registry is not a revolutionary idea; we have seen that before.\n[Most notably the recent Poweliks Trojan [https://blog.gdatasoftware.com/blog/article/poweliks-](https://blog.gdatasoftware.com/blog/article/poweliks-the-persistent-malware-without-a-file.html)\n[the-persistent-malware-without-a-file.html] stored the active script component in the registry.](https://blog.gdatasoftware.com/blog/article/poweliks-the-persistent-malware-without-a-file.html)\nEven some of the APT malware families, like Poison or Frethog, occasionally used the registry as\nstorage for the main payload.\n\nThere were precursors even within the criminal groups distributing PlugX: they used this method\nback in 2013 in a couple of cases for storing the Omdork (a.k.a. Sybin) payload. So it was only a\nquestion of when the same would happen to the main PlugX backdoor. And that time arrived this\nJanuary.\n\n\n-----\n\n#### PlugX in registry\nThe new variants were distributed using two distinguishable classes of exploited carrier\ndocuments – though in both cases the CVE-2012-0158 exploit was used.\n\nFor the first type the distribution was part of a longer campaign, targeting India. This campaign\nspanned several months, from September 2014 to February 2015. During this time span\ndifferent variants of the PlugX backdoor were observed as the final payload. Apparently, this was\nan ongoing operation, where the actors behind it used the latest available versions, as they came\nout of the factory. Additionally, a few affiliated malware families were distributed to the targets.\n\nThe samples of the second type showed up the first week of February. At this point we don’t have\nconclusive information about the scope and target of the campaign that used these samples.\n\nThe payload is stored in encrypted form in the registry. It is loaded, decrypted and executed\nby the malware loader component. That loader is very similar to the usual PlugX loader DLLs,\nexcept that it loads the payload from a registry key instead of a separate file.\n\nPlugX payload in the registry\n\nThe stored payload is the new P2P PlugX backdoor, with internal function names not seen in\nearlier PlugX v2 versions: ZX, ZXWT, JP1, JP2, JP3, JP4, JP5, JAP0, JAP1.\n\nPlugX backdoors use a specific date parameter at specific places in the code. This constant\ncould be used as a major version identifier: when the backdoor code was only slightly modified,\nthe constant did not change. When the constant was updated, that usually meant a significant\nchange in the code.\n\nIn earlier versions this constant was a meaningful date in hexadecimal representation (e.g.\n_0x20130810 in most of the next generation PlugX samples). In the P2P PlugX version it changed,_\nnow being a meaningful date in decimal representation (e.g. 0x13352AF = 20140719 in the case\nof the Rotten Tomato samples).\n\nIn the case of registry stored PlugX variants, this constant was stepped further to 20150108,\nwhich indicates a new development from the factory. Less than a month later these new variants\nwere already spotted in targeted campaigns in India.\n\n\nThe payload is stored in encrypted form in the registry. It is loaded, decrypted and executed\nby the malware loader component. That loader is very similar to the usual PlugX loader DLLs,\nexcept that it loads the payload from a registry key instead of a separate file.\n\n\n-----\n\n#### Peeled Tomato\nThe first campaign we labelled as Peeled Tomato, in reference to the earlier Rotten Tomato case,\nbecause they were clearly derived from those samples.\n\nAs a reminder, the original structure of the Rotten Tomato samples was the following:\n\nEncrypted Zbot\n\nCVE-2012-0158 exploit\n\nand shellcode\n\nCVE-2014-1761 exploit\nand first stage shellcode\n\nMemory marker and\nCVE-2014-1761 second\n\nstage shellcode\n\nEncrypted PlugX\n\nThe RTF documents started with an encrypted Zbot Trojan (remainder of the original template\nused for creating the samples), then a block using the CVE-2012-0158 exploit and the\ncorresponding shellcode. After that, there was a block using the CVE-2014-1761 exploit and the\ncorresponding first stage shellcode, followed by the second stage shellcode from the CVE-20141761 exploit, and finally the encrypted PlugX backdoor.\n\nThe first stage of the CVE-2014-1761 shellcode used a bad offset for the second stage code,\nthus this exploit never worked.\n\n|Col1|Encrypted Zbot|Col3|\n|---|---|---|\n||CVE-2012-0158 exploit and shellcode||\n||CVE-2014-1761 exploit and first stage shellcode||\n||Memory marker and CVE-2014-1761 second stage shellcode||\n||Encrypted PlugX||\n\n\n-----\n\nHaving realized the failure of the attempt, the malware authors removed the CVE-2014-1761\nexploit block. But even that was not done completely. As a result, they ended up with documents\nshowing the following structure:\n\nEncrypted Zbot\n\nCVE-2012-0158 exploit\n\nand shellcode\n\nMemory marker and\nCVE-2014-1761 second\n\nstage shellcode\n\nEncrypted PlugX\n\n#### Samples\nNot surprisingly, just like with several other campaigns, in this case it was observed that different\nmalware families were distributed using similar carrier documents; only the encrypted payload\nwas replaced at the end of the file. The shellcode used in the carrier was very convenient for\nthis purpose: the length and location of the final payload was stored at the end of the file. It was\npossible to swap the payload without needing to modify the exploit condition and the shellcode\nitself. And this is exactly what the malware authors did.\n\n|Col1|Encrypted Zbot|\n|---|---|\n||CVE-2012-0158 exploit and shellcode|\n|||\n||Memory marker and CVE-2014-1761 second stage shellcode|\n||Encrypted PlugX|\n\n\n-----\n\n9blog\n[This malware family was described in this blog: [http://www.fireeye.com/blog/technical/](http://www.fireeye.com/blog/technical/malware-research/2013/08/the-curious-case-of-encoded-vb-script)\n[malware-research/2013/08/the-curious-case-of-encoded-vb-scripts-apt-nineblog.html]](http://www.fireeye.com/blog/technical/malware-research/2013/08/the-curious-case-of-encoded-vb-script)\n\n_19e9dfabdb9b10a90b62c12f205ff0d1eeef3f14_\n\nOriginal name:\nghozaresh amniyati.doc\n\nSystem activity:\nDropped to %PROFILE%\\Application Data\\Erease.vbe\n\nSAV detection:\nTroj/DocDrop-CH, VBS/9Blog-A\n\nC&C servers:\nwww.freetimes.dns05.com\n_Free Dynamic DNS provider_\n\n\n-----\n\n#### Smoaler\n[This malware family was described in this blog: [https://nakedsecurity.sophos.com/2013/07/15/](https://nakedsecurity.sophos.com/2013/07/15/the-plugx-malware-factory-revisited-introducing-smoaler/)\n[the-PlugX-malware-factory-revisited-introducing-smoaler/], and traditionally has strong ties](https://nakedsecurity.sophos.com/2013/07/15/the-plugx-malware-factory-revisited-introducing-smoaler/)\nwith PlugX, sharing dropper code and C&C infrastructure.\n\nThe samples were observed during the period between November 2014 and January 2015 in\nRussia.\n\nOriginal name:\n\nПроекты.doc\n\nSystem activity:\nDropped to C:\\Documents and Settings\\All Users\\Application Data\\Microsoft\\Windows\\Burn\\\n_{COMPUTERNAME}.dll and C:\\Documents and Settings\\All Users\\Application Data\\Microsoft\\_\n_Windows\\LiveUpdata_Mem\\CrtRunTime.log; registered for startup in HKCU\\Software\\Microsoft\\_\n_Windows\\CurrentVersion\\Policies\\Explorer\\run → {COMPUTERNAME}_\n\nHere {COMPUTERNAME} is the name of the computer, as set in Windows preferences.\n\nSAV detection:\nExp/20120158-A, Troj/Smoaler-F\n\nC&C servers:\nlucas1.dnset.com\n_d746ca9b74fb04782e0e783980f7702a9356f1c7_\n\n\n-----\n\nOriginal name:\nтелефонная книга и почтовый адрес(2014.10).doc\n\nThe decoy document is the same as in the case of the Nineblog sample.\n\nSystem activity:\nDropped to C:\\Documents and Settings\\All Users\\Application Data\\Microsoft\\Windows\\Burn\\\n_{COMPUTERNAME}.dll and C:\\Documents and Settings\\All Users\\Application Data\\Microsoft\\_\n_Windows\\LiveUpdata_Mem\\CrtRunTime.log; registered for startup in HKCU\\Software\\Microsoft\\_\n_Windows\\CurrentVersion\\Policies\\Explorer\\run → {COMPUTERNAME}_\n\nHere {COMPUTERNAME} is the name of the computer, as set in Windows preferences.\n\nSAV detection:\nExp/20120158-A, Troj/Smoaler-F\n\n\n-----\n\n#### PlugX v2\nThese samples were distributed in September and October 2014, in India.\n_6f845ef154a0b456afcf8b562a0387dabf4f5f85_\n\nOriginal name:\nIndian Cooking Recipe.doc\n\nSystem activity:\nDropped to C:\\Documents and Settings\\All Users\\RasTls\\RasTls.exe (digitally signed clean\n_loader by Symantec), C:\\Documents and Settings\\All Users\\RasTls\\RasTls.dll (loader) and_\n_C:\\Documents and Settings\\All Users\\RasTls\\RasTls.dll.msc (payload); registered in HKLM\\_\n_SYSTEM\\CurrentControlSet\\Services\\RasTls → ImagePath_\n\n[The payload is next generation PlugX [https://nakedsecurity.sophos.com/2014/06/30/from-the-](https://nakedsecurity.sophos.com/2014/06/30/from-the-labs-plugx-the-next-generation/)\n[labs-PlugX-the-next-generation/], date constant is 0x20130524](https://nakedsecurity.sophos.com/2014/06/30/from-the-labs-plugx-the-next-generation/)\n\nSAV detection:\nTroj/DocDrop-CH, Troj/PlugX-AP\n\nC&C servers:\nsupercat.strangled.net\n_Free dynamic DNS provider_\n\n_a97827aef54e7969b9cbbec64d9ee81a835f2240_\n\n\n-----\n\nOriginal name:\nCalling Off India-Pak Talks.doc\n\nSystem activity:\nDropped to C:\\Documents and Settings\\All Users\\RasTls\\RasTls.exe (digitally signed clean\nloader by Symantec), C:\\Documents and Settings\\All Users\\RasTls\\RasTls.dll (loader) and\n_C:\\Documents and Settings\\All Users\\RasTls\\RasTls.dll.msc (payload); registered in HKLM\\_\n_SYSTEM\\CurrentControlSet\\Services\\RasTls → ImagePath_\n\n[The payload is next generation PlugX [https://nakedsecurity.sophos.com/2014/06/30/from-the-](https://nakedsecurity.sophos.com/2014/06/30/from-the-labs-plugx-the-next-generation/)\n[labs-PlugX-the-next-generation/], date constant is 0x20130524](https://nakedsecurity.sophos.com/2014/06/30/from-the-labs-plugx-the-next-generation/)\n\nSAV detection:\nTroj/DocDrop-CH, Troj/PlugX-AP\n\nC&C servers:\nnusteachers.no-ip.org\n_Free dynamic DNS provider_\n\n_e8a29bb90422fa6116563073725fa54169998325_\n\n\n-----\n\nOriginal name:\nHuman Rights Violations of Tibet.doc\n\nSystem activity:\nDropped to C:\\Documents and Settings\\All Users\\RasTls\\RasTls.exe (digitally signed clean\nloader by Symantec), C:\\Documents and Settings\\All Users\\RasTls\\RasTls.dll (loader) and\n_C:\\Documents and Settings\\All Users\\RasTls\\RasTls.dll.msc (payload); registered in HKLM\\_\n_SYSTEM\\CurrentControlSet\\Services\\RasTls → ImagePath_\n\n[The payload is next generation PlugX [https://nakedsecurity.sophos.com/2014/06/30/from-the-](https://nakedsecurity.sophos.com/2014/06/30/from-the-labs-plugx-the-next-generation/)\n[labs-PlugX-the-next-generation/], date constant is 0x20130524](https://nakedsecurity.sophos.com/2014/06/30/from-the-labs-plugx-the-next-generation/)\n\nSAV detection:\nTroj/DocDrop-CH, Troj/PlugX-AP\n\nC&C servers:\nruchi.mysq1.net\n_Dynamic DNS provider_\n\n_a7e52cb429ac22cc20be77158f97d6f9dd887e1f_\n\nThis sample is an outlier, as it was distributed in January 2015, and in Russia. The decoy\ndocument is also unconvential, of minimalistic design.\n\nBut the carrier document and the C&C server name shows correlation with the rest of the\ncampaign.\n\n\n-----\n\nOriginal name:\nCalling Off India-Pak Talks.doc\n\nSystem activity:\nDropped to C:\\Documents and Settings\\All Users\\DRM\\usta\\usha.exe (digitally signed clean\nloader by Kaspersky) and C:\\Documents and Settings\\All Users\\DRM\\usta\\ushata.dll (malware\nloader) and C:\\Documents and Settings\\All Users\\DRM\\usta\\ushata.dll.avp (payload).\n\nRegistered for startup in HKLM\\SYSTEM\\CurrentControlSet\\Services\\usta → ImagePath\n\n[The payload is next generation PlugX [https://nakedsecurity.sophos.com/2014/06/30/from-the-](https://nakedsecurity.sophos.com/2014/06/30/from-the-labs-plugx-the-next-generation/)\n[labs-PlugX-the-next-generation/], date constant is 0x20130810](https://nakedsecurity.sophos.com/2014/06/30/from-the-labs-plugx-the-next-generation/)\n\nSAV detection:\nExp/20120158-A, Troj/PlugX-AP\n\nC&C servers:\nlucas1.freetcp.com\n_Free dynamic DNS provider_\n\nP2P PlugX\nThese samples were distributed in January 2015, in India.\n\n_147fbdfeed9f0825026b3b3ce558c3ad00410b11_\n\n\n-----\n\nOriginal name:\nMinutes of meeting.doc\n\nSystem activity:\nDropped to C:\\Documents and Settings\\All Users\\DRM\\rEjtQOtPhIi\\fsguidll.exe (digitally signed\nclean loader by F-Secure), C:\\Documents and Settings\\All Users\\DRM\\rEjtQOtPhIi\\fslapi.dll\n(loader) and C:\\Documents and Settings\\All Users\\DRM\\rEjtQOtPhIi\\fslapi.dll.gui (payload),\n\nRegistered for startup in HKLM\\SYSTEM\\CurrentControlSet\\Services\\gzQkNtWeabrwf →\n_ImagePath_\n\n[The payload is next generation P2P PlugX [http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.](http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html)\n[html], date constant is decimal 20141028.](http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html)\n\nSAV detection:\nTroj/DocDrop-CH, Troj/PlugX-AP\n\nC&C servers:\nunisers.com\n_Registrant Name: wang cheng_\n_Registrant Organization: wang cheng_\n_Registrant Street: BeijingDaguoROAD136_\n_Registrant City: Beijing_\n_Registrant State/Province: Beijing_\n_Registrant Postal Code: 100001_\n_Registrant Country: CN_\n_Registrant Phone : +86.01085452454_\n_Registrant Phone Ext:_\n_Registrant Fax: +86.01085452454_\n_Registrant Fax Ext:_\n_Registrant Email:bitumberls@163.com_\n\n_8ee8ab984cb01762dfc6d341278b87a7c83906cf_\n\n\n-----\n\nOriginal name:\nU.S.,_India_to_formulate_smart_city_action_plans_in_three_months.doc\n\nSystem activity:\nDropped to C:\\Documents and Settings\\All Users\\DRM\\inbjUkRVq\\fsguidll.exe (digitally signed\nclean loader by F-Secure), C:\\Documents and Settings\\All Users\\DRM\\inbjUkRVq\\fslapi.dll\n(loader) and C:\\Documents and Settings\\All Users\\DRM\\inbjUkRVq\\fslapi.dll.gui (payload),\n\nRegistered for startup in HKLM\\SYSTEM\\CurrentControlSet\\Services\\brwTRsulGqjj →\n_ImagePath_\n\n[The payload is next generation P2P PlugX [http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.](http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html)\n[html], date constant is decimal 20141028.](http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html)\n\nSAV detection:\nTroj/DocDrop-CH, Troj/PlugX-AP\n\nC&C servers:\nunisers.com\n_Registrant Name: wang cheng_\n_Registrant Organization: wang cheng_\n_Registrant Street: BeijingDaguoROAD136_\n_Registrant City: Beijing_\n_Registrant State/Province: Beijing_\n_Registrant Postal Code: 100001_\n_Registrant Country: CN_\n_Registrant Phone : +86.01085452454_\n_Registrant Phone Ext:_\n_Registrant Fax: +86.01085452454_\n_Registrant Fax Ext:_\n_Registrant Email:bitumberls@163.com_\n\n\n-----\n\n#### Registry PlugX\nThese samples were typically distributed in January-February 2015, in India.\n\n_a4602a357360b0ed8e9b0814b1322146156fb7f6_\n\nOriginal name:\nCHINA NEWS BRIEF 09 of 2015.doc\n\nSystem activity:\nDropped to C:\\Documents and Settings\\All Users\\DRM\\sock5proxy\\SX.EXE (digitally signed clean\nloader by Microsoft) and C:\\Documents and Settings\\All Users\\DRM\\sock5proxy\\SXLOC.DLL;\nregistered in HKLM\\SYSTEM\\CurrentControlSet\\Services\\sock5proxy → ImagePath; payload\nstored in the registry in HKCU\\Software\\BINARY → SXLOC.ZAP\n\n[The payload is next generation P2P PlugX [http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.](http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html)\n[html], date constant is decimal 20150108.](http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html)\n\nSAV detection:\nExp/20120158-A, Troj/PlugX-AP\n\nC&C servers:\nfreemoney.ignorelist.com\n_Free dynamic DNS provider_\n\n_03b2a660d68004444a5189173e3b8001f4a7cd0b_\n\n\n-----\n\nOriginal name:\nDraft contract CMS Trg System.doc\n\nSystem activity:\nDropped to C:\\Documents and Settings\\All Users\\DRM\\sock5proxy\\SX.EXE (digitally signed clean\nloader by Microsoft) and C:\\Documents and Settings\\All Users\\DRM\\sock5proxy\\SXLOC.DLL;\nregistered in HKLM\\SYSTEM\\CurrentControlSet\\Services\\sock5proxy → ImagePath; payload\nstored in the registry in HKCU\\Software\\BINARY → SXLOC.ZAP\n\n[The payload is next generation P2P PlugX [http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.](http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html)\n[html], date constant is decimal 20150108.](http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html)\n\nSAV detection:\nExp/20120158-A, Troj/PlugX-AP\n\nC&C servers:\nfreemoney.ignorelist.com\n_Free dynamic DNS provider_\n\n\n-----\n\n#### Multi-staged installer shellcode\nThis second batch of exploited documents had a different structure. All start with a heading RTF\ncontent (which is exactly the same in all of the documents), followed by the block that exploits\nthe CVE-2012-0158 vulnerability, along with the first stage shellcode, followed by the second\nand third stage shellcodes, and finally the encrypted payload executable.\n\nRTF heading of exploited documents\n\nThe shellcode itself is encrypted with a 4 byte XOR algorithm, with a lot of inserted junk\ninstructions:\n\nfprem1\nadd edi, ebx\njz short loc_13B\nnop\nfnclex\nfldl2e\nnop\nand ebx, ebx\ntest eax, eax\nfsin\n**xor** **[edi], esi**\njp short loc_14B\nf2xm1\nmov edx, edx\nnop\ncld\nfst st(1)\npop edi\njle short loc_157\nfldpi\nfprem1\ncmp edi, esi\nfdivrp st(1), st\n\nIn the above code sample, only the XOR [EDI], ESI instruction is meaningful, performing the\ndecryption of the one dword; the rest are only polymorphic junk.\n\n\n-----\n\nThe underlying shellcode is multi-stage andhas already been observed in an earlier sample\ndropping a PlugX v2 variant (SHA1: 9b90d6608ba6167619b5991fd70319dfcd1fa881, date\nconstant 0x20140613), but in that case without the top level cryptor.\n\nAfter the initial bootstrap code is decrypted, it identifies the carrier by looking for ‘DCBA’ at file\noffset 0x4e28. If it is found there, it allocates a memory area and decrypts (using one byte XOR\nalgorithm) the next stage starting from right after the ID string.\n\nThe second stage code decrypts and drops two files: the self-extracting installer archive M.B\nand the first stage installer M.T into the %TEMP% folder, then allocates another memory region,\ndecrypts, copies and executes the third stage shellcode there.\n\nThe third stage shellcode copies the first stage installer (which is a DLL library) M.T into\n_%WINDOWS%\\Tasks\\n.dll, then executes by calling LoadLibrary to load it. The Windows loader_\nupon loading the DLL will execute its entry code. This entry code runs the self-extracting\ninstaller archive M.B which will do the final malware installation in the system. This final piece of\ninstallation process is malware family dependent.\n\nFirst stage shellcode\n\nExploited\ndocument\n\nSecond stage shellcode\n\nThird stage shellcode\n\nM.T\n\n%WINDOWS%\\Tasks\\n.dll\n\nM.B\n\nMalware installer\n\nThis new shellcode also indicates some heavy development in the PlugX factory. Both this kind\nof multi-stage shellcode and the external cryptor indicate that although the group is not top\nclass in exploit development, in conventional malware development they show serious skills,\nwhich makes them dangerous.\n\n_dea6525b696df4643b10eb91381d95eec51479d7_\n\n|malware family dependent.|Col2|\n|---|---|\n|First stage shellcode||\n|||\n\n\n-----\n\nOriginal name:\nparis_declaration january_final.doc\n\nThe dropped decoy document is corrupted. On opening it, Word will show a conversion dialog as\na result of the incomprehensible content.\n\nSystem activity:\nDropped to C:\\Documents and Settings\\All Users\\DRM\\emproxy\\SX.EXE (digitally signed clean\nloader by Microsoft) and C:\\Documents and Settings\\All Users\\DRM\\emproxy\\SXLOC.DLL and\n_%WINDOWS%\\Tasks\\n.dll_\n\nRegistered for startup in HKLM\\SYSTEM\\CurrentControlSet\\Services\\sock5proxy → ImagePath\nand by dropping n.dll into the Windows Tasks directory.\n\nThe n.dll file is a first stage installer, loads M.B, which is dropped into the %TEMP% directory.\nThis installer is a self-extracting WinRAR that contains RasTls.exe and a config file. After the\ninstallation, this RAR SFX file is removed from the system.\n\nPayload is stored in the registry in HKCU\\Software\\BINARY → SXLOC.ZAP\n\n[The payload is next generation P2P PlugX [http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.](http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html)\n[html], date constant is decimal 20150108.](http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html)\n\nSAV detection:\nTroj/DocDrop-CD, Troj/Omdork-E, Troj/PlugX-AP\n\nC&C servers:\nsumy2012.jkub.com\n_Free dynamic DNS provider_\n\n_6340a7916db67c1b6dc1731014bb440435578c66_\n\n\n-----\n\nOriginal name:\nObama against IS.doc\n\nThe dropped decoy document is corrupted just like in the previous case.\n\nSystem activity:\nDropped to C:\\Documents and Settings\\All Users\\DRM\\emproxy\\SX.EXE (digitally signed clean\nloader by Microsoft) and C:\\Documents and Settings\\All Users\\DRM\\emproxy\\SXLOC.DLL and\n_%WINDOWS%\\Tasks\\n.dll_\n\nRegistered for startup in HKLM\\SYSTEM\\CurrentControlSet\\Services\\sock5proxy → ImagePath\nand by dropping n.dll into the Windows Tasks directory.\n\nThe n.dll file is a first stage installer, loads M.B, which is dropped into the %TEMP% directory.\nThis installer is a self-extracting WinRAR that contains RasTls.exe and a config file. After the\ninstallation, this RAR SFX file is removed from the system.\n\nPayload is stored in the registry in HKCU\\Software\\BINARY → SXLOC.ZAP\n\n[The payload is next generation P2P PlugX [http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.](http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html)\n[html], date constant is decimal 20150108.](http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html)\n\nSAV detection:\nTroj/DocDrop-CD, Troj/Omdork-E, Troj/PlugX-AP\n\nC&C servers:\ndheeraj_gaurav.mooo.com\n_Free dynamic DNS provider_\n\n_739405cad3650ed0447a475f50f814f7c9787ff4_\n\n\n-----\n\nOriginal name:\nN/A\n\nOn execution this dropper displays a blank decoy document.\n\nSystem activity:\nDropped to C:\\Documents and Settings\\All Users\\DRM\\RdeGL\\fsguidll.exe (digitally signed clean\nloader by F-Secure) and C:\\Documents and Settings\\All Users\\DRM\\RdeGL\\fslapi.dll (malware\nloader) and C:\\Documents and Settings\\All Users\\DRM\\RdeGL\\fslapi.dll.gui (payload) and\n_%WINDOWS%\\Tasks\\n.dll_\n\nRegistered for startup in HKLM\\SYSTEM\\CurrentControlSet\\Services\\dUuNvGfDQkAll →\n_ImagePath and by placing n.dll in the Windows Tasks directory._\n\n[The payload is next generation P2P PlugX [http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.](http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html)\n[html], date constant is decimal 20141028.](http://blog.jpcert.or.jp/2015/01/analysis-of-a-r-ff05.html)\n\nThe n.dll file executes a backup installer, M.B, which is dropped into the %TEMP% directory. The\nonly problem is that this file is never created.\n\nSAV detection:\nTroj/DocDrop-CD, Troj/Omdork-E, Troj/PlugX-AP\n\nC&C servers:\nwww.notebookhk.net\n_Registrant Name: lee stan_\n_Registrant Organization: lee stan_\n_Registrant Street: xianggangdiqu_\n_Registrant City: xianggangdiqu_\n_Registrant State/Province: xianggang_\n_Registrant Postal Code: 796373_\n_Registrant Country: HK_\n_Registrant Phone : +0.04375094543_\n_Registrant Phone Ext:_\n_Registrant Fax: +0.04375094543_\n_Registrant Fax Ext:_\n_Registrant Email:stanlee@gmail.com_\n\n_56b3f0f03ae12b56c000df67c1153d518c8a66fc_\n\nThis sample is an outlier. It does not distribute PlugX, but uses a strikingly similar persistence\nmethod, with exactly the same file names that are used with PlugX installations. Only the final\npayload is a different backdoor, Omdork, which has earlier been observed in PlugX related\ndistribution channels.\n\n\n-----\n\nOriginal name:\nUnited Nations Security Council Committee Pursuant to Resolutions1267.doc\n\nSystem activity:\nDropped to C:\\Documents and Settings\\All Users\\FlashUpdate\\RasTls.exe and C:\\Documents\n_and Settings\\All Users\\FlashUpdate\\msi.dll.mov (encrypted payload) and %WINDOWS%\\Tasks\\n._\n_dll._\n\nThe persistence is achieved by two methods: RasTls.exe is registered in HKCU\\Software\\\n_Microsoft\\Windows\\CurrentVersion\\Run → msusr, and the n.dll is dropped to the Windows Tasks_\ndirectory for automatic execution.\n\nWhile the file names are the same as in the case of many PlugX deployments, the files\nthemselves are very different.\n\nRasTls.exe is not digitally signed, it is the loader Trojan, that loads the encrypted payload from\na resource. This payload itself contains a loader code, and an embedded executable, that is the\nfinal payload.\n\nThe n.dll file executes a backup installer, M.B, which is dropped into the %TEMP% directory. This\ninstaller is a self-extracting WinRAR that contains RasTls.exe and a config file.\n\nThere are still reasons to believe that this malware is strongly connected to the PlugX group:\n\nÌ It uses the same filenames as some of the PlugX deploymentsÌ\n\nÌ It uses the same carrier document as the other PlugX variants Ì\n\nin this campaign, including the unique shellcode\n\nÌ The same n.dll is used in both the Omdork and PlugX deploymentsÌ\n\n\n-----\n\nSAV detection:\nTroj/DocDrop-CD, Troj/Omdork-E\n\nC&C servers:\nwww.togolaga.com\n_Registrant Name: wang feng_\n_Registrant Organization: wang feng_\n_Registrant Street: beijingshi_\n_Registrant City: beijingshi_\n_Registrant State/Province: beijing_\n_Registrant Postal Code: 100000_\n_Registrant Country: CN_\n_Registrant Phone : +86.01090888962_\n_Registrant Phone Ext:_\n_Registrant Fax: +86.01090888962_\n_Registrant Fax Ext:_\n_Registrant Email:battuya_2002@yahoo.com_\n\n_More than 100 million users in 150 countries rely on Sophos as the best protection against complex threats and data loss. Sophos is committed to_\n_providing complete security solutions that are simple to deploy, manage, and use that deliver the industry’s lowest total cost of ownership. Sophos_\n_offers award winning encryption, endpoint security, web, email, mobile, server and network security backed by SophosLabs—a global network of_\n_[threat intelligence centers. Read more at www.sophos.com/products.](http://www.sophos.com/products)_\n\n\nAustralia and New Zealand Sales\nTel: +61 2 9409 9100\nEmail: sales@sophos.com.au\n\n\nAsia Sales\nTel: +65 62244168\nEmail: salesasia@sophos.com\n\n\nUnited Kingdom and Worldwide Sales\nTel: +44 (0)8447 671131\nEmail: sales@sophos.com\n\n\nNorth American Sales\nToll Free: 1-866-866-2802\nEmail: nasales@sophos.com\n\n\nOxford, UK | Boston, USA\n© Copyright 2014. Sophos Ltd. All rights reserved.\nRegistered in England and Wales No. 2096520, The Pentagon, Abingdon Science Park, Abingdon, OX14 3YP, UK\nSophos is the registered trademark of Sophos Ltd. All other product and company names mentioned are\ntrademarks or registered trademarks of their respective owners.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/jfuf6eo3az72qrvh6ueke42ft9f23ztz",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.02.25.PlugX_to_registry/plugx-goes-to-the-registry-and-india.pdf"
    ],
    "report_names": [
        "plugx-goes-to-the-registry-and-india"
    ],
    "threat_actors": [
        {
            "id": "b3cfe392-a8df-42bc-bc9a-3233ec5d6d5f",
            "created_at": "2022-10-25T16:07:23.90923Z",
            "updated_at": "2025-03-27T02:02:10.023782Z",
            "deleted_at": null,
            "main_name": "NineBlog",
            "aliases": [],
            "source_name": "ETDA:NineBlog",
            "tools": [
                "NineBlog"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5afe7b81-e99a-4c24-8fcc-250fb0cf40a3",
            "created_at": "2023-01-06T13:46:38.324616Z",
            "updated_at": "2025-03-27T02:00:02.805194Z",
            "deleted_at": null,
            "main_name": "Roaming Tiger",
            "aliases": [
                "BRONZE WOODLAND",
                "Rotten Tomato"
            ],
            "source_name": "MISPGALAXY:Roaming Tiger",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "866c0c21-8de3-4ad5-9887-cecd44feb788",
            "created_at": "2022-10-25T16:07:24.130298Z",
            "updated_at": "2025-03-27T02:02:10.117603Z",
            "deleted_at": null,
            "main_name": "Roaming Tiger",
            "aliases": [
                "Bronze Woodland",
                "CTG-7273",
                "Rotten Tomato"
            ],
            "source_name": "ETDA:Roaming Tiger",
            "tools": [
                "Agent.dhwf",
                "AngryRebel",
                "BBSRAT",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "Kaba",
                "Korplug",
                "Moudour",
                "Mydoor",
                "PCRat",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Xamtrav"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9bf42584-ca17-47de-a902-3dd63d90b2f8",
            "created_at": "2024-05-01T02:03:08.005172Z",
            "updated_at": "2025-03-27T02:05:17.300423Z",
            "deleted_at": null,
            "main_name": "BRONZE WOODLAND",
            "aliases": [
                "Roaming Tiger ",
                "Rotten Tomato ",
                "CTG-7273 "
            ],
            "source_name": "Secureworks:BRONZE WOODLAND",
            "tools": [
                " PlugX",
                " Zbot",
                "Appat"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041599,
    "ts_creation_date": 1424864137,
    "ts_modification_date": 1424846584,
    "files": {
        "pdf": "https://archive.orkl.eu/fc1d350810c19c94b1f3642fa08f50bf914ab821.pdf",
        "text": "https://archive.orkl.eu/fc1d350810c19c94b1f3642fa08f50bf914ab821.txt",
        "img": "https://archive.orkl.eu/fc1d350810c19c94b1f3642fa08f50bf914ab821.jpg"
    }
}