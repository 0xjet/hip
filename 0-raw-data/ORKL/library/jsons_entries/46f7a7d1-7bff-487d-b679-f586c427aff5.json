{
    "id": "46f7a7d1-7bff-487d-b679-f586c427aff5",
    "created_at": "2022-10-25T16:48:24.57565Z",
    "updated_at": "2025-03-27T02:10:17.264827Z",
    "deleted_at": null,
    "sha1_hash": "d611ca60c87498c89b450dda0f06a3cffebe53ae",
    "title": "IXESHE Derivative IHEATE Targets Users in America",
    "authors": "Trend Micro",
    "file_creation_date": "2016-06-11T00:17:57Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 219891,
    "plain_text": "# S e a e a ge s Use s e ca\n\n**blog.trendmicro.com** [/trendlabs-security-intelligence/ixeshe-derivative-iheate-targets-users-america/](http://blog.trendmicro.com/trendlabs-security-intelligence/ixeshe-derivative-iheate-targets-users-america/)\n\n**_by Razor Huang and CH Lei_**\n\nSince 2012, we’ve been keeping an eye on the [IXESHE targeted attack campaign. Since its inception in 2009, the](http://blog.trendmicro.com/trendlabs-security-intelligence/taking-a-bite-out-of-ixeshe/)\ncampaign has primarily targeted governments and companies in East Asia and Germany. However, the campaign\nappears to have shifted tactics and is once again targeting users in the United States.\n\nWe also noticed that there were some changes to the underlying behavior of the malware used. While there were\nsome incremental improvements in the observed behavior of the new sample, the underlying pattern of behavior is\nsimilar to what we observed earlier from IXESHE.\n\nThese attacks targeting users in the United States used a variant of IXESHE which has been seen in Taiwan since\n2009 named IHEATE. These showed some differences from known IXESHE variants: they had a different\ncommand-and-control (C&C) communication model and encryption methods.\n\nOne IHEATE sample we found contains the string “EMC112” as part of the C&C traffic. Such strings are frequently\nused to identify different campaigns. In this particular case, the 112 part of the string matched the malware sample’s\ncompilation date of January 12.\n\nThe sample we acquired connects to a C&C server whose domain was first registered in 2004, but whose\ninformation was modified in December 2015. This suggests that threat actors were able to pose as the original\nregistrant and modify the information for their own needs.\n\n**_Technical Analysis_**\n\nIXESHE is a well-known targeted attack campaign which has mainly targeted East Asian governments, electronics\nmanufacturers, and a telecommunications company in Germany. Other targets include G20 government officials as\nwell as the New York Times. The campaign is known for targeting users with fake documents using exploits and\nright-to-left override (RTLO) techniques.\n\nThe particular sample we found has a SHA1 hash of 3de8ef34fb98ce5d5d0ec0f46ff92319a5976e63. We detect it as\nBKDR_IHEATE. Unlike common IXESHE variants which usually communicate with C&C servers via HTTP and\na customized Base64-ecoded payload, IHEATE communicates with C&C servers in the TCP layer. (HEATE is a\ncommand that is sent by some members of this family to servers that acts as a notice that it’s still online; we derived\nthe name IHEATE from this command and its ties to the IXESHE family.)\n\nWe have learned from IXESHE variants that even though the encryption routine changed in different variants but the\ndecrypted messages are almost similar.\n\n**_Information gathering_**\n\nOnce the backdoor is installed, it collects information on the victim’s system and sends it to C&C server with the\nfollowing format :\n\n_| [Computer name] | [User name] | [IP] | [OS version] | [Process ID or Tag]_\n\nN t ll l i l d t i th i Thi t ld b ID i ti i f ti th d t h\n\n\n-----\n\nmalware was compiled, as its compile date/time is 2016/01/12 03:22:27.\n\nThe threat actors behind IHEATE could use these tags to manage victims. The traffic back to their C&C servers\ncould easily be sorted using these tags.\n\nSometime they slightly change the feedback format, such as\n\nRemoving spaces:“[Computer name]|[User name]|[IP]|[OS version]|[Tag]”\n\nChanging the delimiter:“* [Computer name] * [User name] * [IP] * [OS version] * [Tag]”\n\n**_Backdoor instructions_**\n\nIHEATE provides a similar set of commands as most IXESHE variants. Note that the following list is case\ninsensitive:\n\n/WINCMD %s – Launch command and get the output\n\n/GETCMD %s – copy cmd.exe and rename\n\n/DISK – List all disks\n\n/CD – get current directory\n\n/CD %s – change directory\n\n/DIR %s – browse directory\n\n/DEL %s – delete file\n\n/GETFILE %s – upload file\n\n/PUTFILE %s – download file\n\n/TASKLIST – list running processes\n\n/TASKKILL %s – kill a running process\n\n/SHUTDOWN – shut down the malware\n\n/SLEEP %s – sleep for specific period\n\n**_Encryption_**\n\nWhile IXESHE variants have fairly similar phone-home and backdoor routines, they have a wide variety of\nencryption routines. IHEATE is no different, and has its own unique behavior.\n\nThe traffic below simulates the traffic between a IHEATE-affected machine and its C&C server. Traffic from the client\nto the server is in red; traffic from the server to the client is in blue. The C&C server has sent a /DISK command to\nthe machine.\n\n_Figure 1. Captured IHEATE network traffic_\n\nThe first part of the network traffic is from the client to the\nC&C server. It is as follows:\n\n1. The first six bytes make up the hardcoded portion of the\n\nencryption key. In this case, it is “36 59 6d 56 7c 22”. We\nhave seen different encryption keys in other IHEATE\n\n\n-----\n\n44 a4 55 85 c7”. In some samples, this portion is ten bytes long.\n\n3. The next two bytes say how long the encrypted data is, here it is “61 8a”. The contents are encrypted with\n\nRC4, using the randomly generated encryption key.\n\n4. Last is the data itself. This is also encrypted using RC4, with the hardcoded and randomly generated portions\n\nof the encryption key concatenated together.\n\nThe second part is the response of the server to the client. It is described as follows:\n\n1. The encryption procedure is identical to that used by the client to talk to the server.\n\n2. The six-bit hardcoded portion of the encryption key _must be identical to the one used by the client earlier._\n\nOtherwise, if the keys do not match, the connection is dropped.\n\nHowever, some newer IHEATE samples use yet another technique. These use asymmetric encryption:\n\n1. Before communicating with C&C server, the malware client generates a random session key.\n\n2. The client encrypts the session key using RSA-1024, using a public key hardcoded inside of malware.\n\n3. The client encrypts the data to be sent using a custom encryption routine.\n\n4. On top of this, the data sent to the C&C server is encrypted with RC4, using the previously generated session\n\nkey,\n\n_Figure 2. Asymmetric encryption as used by IHEATE_\n\n**_File properties_**\n\nThe IHEATE sample with the “EMC112” identifier passes itself off as legitimate Media Player-related .DLL file, as\ncan be seen below:\n\n\n-----\n\n_Figure 3. IHEATE pretending to be a Media Player .DLL file_\n\n**_C&C Servers_**\n\nIXESHE was known for using compromised hosts for its C&C servers, and IHEATE behaves similarly.\n\nThe IHEATE sample with the “EMC112” identifier used the subdomain cknew[.]{abused domain}[.]com as the\nlocation of its C&C server. This domain appears to contain the personal blog of the original registrant, who has been\nusing it since the domain was registered in 2004. We do not believe that the registrant is tied to IHEATE; instead we\nbelieve that his credentials were compromised so that threat actors could set up subdomains. This site was active\nbriefly in the middle of 2015, but came back online at the start of 2016.\n\nOther IHEATE samples showed interesting behavior as well. In one case, the attackers planted a fake C&C server\naddress in the code:\n\n\n-----\n\n_Figure 4. Fake C&C server in code_\n\nThe address here is not an actual C&C address; instead it is used to calculate the port that the client will use (in this\ncase, 443: (24*18)+11.) Other attacks are known to have used similar tactics as well.\n\nOther domains used by IHEATE also overlapped with servers used by IXESHE. Two domains\n(ipv6pro[.]root[.]sx and gimeover[.]psp-moscow[.]com) were used by IHEATE and resolved to the IP address\n_200[.]93[.]193[.]163. At approximately the same time, IXESHE also used the same server – except it did so by_\naccessing the domain skype[.]silksky[.]com.\n\n**_Conclusions_**\n\nIXESHE and associated threats like IHEATE have not gone away, and they continue to evolve and change with the\ntimes. We will continue to monitor this threat and apprise our readers of any future developments.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/8glps1qnq0glc2c2b2wsmeb4019f9wpd"
    ],
    "report_names": [
        "TrendMicro_IXESHE_IHEATE(05-27-2016)"
    ],
    "threat_actors": [
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d18fe42c-8407-4f96-aee0-a04e6dce219a",
            "created_at": "2023-01-06T13:46:38.275292Z",
            "updated_at": "2025-03-27T02:00:02.79092Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "Calc Team",
                "IXESHE",
                "BRONZE GLOBE",
                "BeeBus",
                "DynCalc",
                "DNSCalc",
                "Crimson Iron",
                "NUMBERED PANDA",
                "TG-2754",
                "Group 22"
            ],
            "source_name": "MISPGALAXY:APT12",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6a660ea2-1118-404a-9f8f-f0d6a1e9f184",
            "created_at": "2022-10-25T15:50:23.685924Z",
            "updated_at": "2025-03-27T02:00:55.52357Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "APT12",
                "IXESHE",
                "DynCalc",
                "Numbered Panda",
                "DNSCALC"
            ],
            "source_name": "MITRE:APT12",
            "tools": [
                "Ixeshe",
                "RIPTIDE",
                "HTRAN"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041417,
    "ts_creation_date": 1465604277,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/d611ca60c87498c89b450dda0f06a3cffebe53ae.pdf",
        "text": "https://archive.orkl.eu/d611ca60c87498c89b450dda0f06a3cffebe53ae.txt",
        "img": "https://archive.orkl.eu/d611ca60c87498c89b450dda0f06a3cffebe53ae.jpg"
    }
}