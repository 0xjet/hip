{
    "id": "8f0cb5cb-62c8-4e4c-b6c8-207212f610ce",
    "created_at": "2022-10-25T16:48:11.508179Z",
    "updated_at": "2025-03-27T02:16:42.960577Z",
    "deleted_at": null,
    "sha1_hash": "5ba6ec70bf70a31f8d61d408be83d3a999d9beee",
    "title": "Turbo Twist: Two 64-bit Derusbi Strains Converge",
    "authors": "Fidelis",
    "file_creation_date": "2016-05-14T21:03:36Z",
    "file_modification_date": "2016-05-14T21:03:36Z",
    "file_size": 470110,
    "plain_text": "## threatgeek.com\n\n# Turbo Twist: Two 64-bit Derusbi Strains Converge\n\n## by Threatgeek • May 2, 2016 • 4 min read • original\n\n### To follow up on the March report on the discovery of a 64-bit Linux\n\n variant of Derusbi used in the Turbo campaign, this post covers our\n\n analysis of two unique Windows variants of the Derusbi PGV_PVID\n\n malware. Derusbi has been widely covered and associated with\n\n numerous Chinese cyber espionage actors, including the group known\n\n as C0d0s0 Team (aka Sunshop Group) and its watering-hole attacks\n\n using Forbes[.]com in 2014.\n\n What made these two variants of interest is that, as of April 28, 2016,\n\n there are zero (0) antivirus detections of these variants at VirusTotal.\n\n On April 29, our team also scanned these variants with two different\n\n local antivirus tools running the latest virus signatures and the APT\n\n malware was still undetected. Based on compile times in the variants\n\n analyzed, it appears that this variant has been around since at least\n\n 2013.\n\n Some of the strings in these variants have also been observed in\n\n variants of the Bergard APT malware. The Derusbi variants were\n\n identified and named by Proofpoint earlier this year\n\n\n-----\n\n### variants with zero antivirus detections also detected two other\n\n variants that are detected by AVs as “Derusbi”. One of the Derusbi\n\n PGV_PVID samples that we analyzed shares its command-and-control\n\n server with a Rekaf sample identified by Proofpoint, furthering the\n\n connection between these families that they established in their\n\n post.\n\n Interestingly, at least one of the domains used here is currently\n\n registered with the China-based domain broker we identified in the\n\n Turbo campaign report. After doing some pivots involving the IP\n\n addresses observed in our analysis, we have a trove of very interesting\n\n domains, all listed at the bottom of this report. These domains include\n\n ones that might purport to represent prominent U.S. defense\n\n contractors, media outlets, etc. It has to be noted that we have not\n\n identified malware or a campaign that uses these domains, but in our\n\n observation, the purpose of registering these domains would be to\n\n launch a targeted campaign against the named organization or others\n\n that trust them, such as partners and customers. These techniques\n\n were widely observed in 2015, in events involving U.S. OPM, Anthem\n\n Healthcare, etc.\n\n These domain pivots have also shown us further connections between\n\n these PGV_PVID, Rekaf and Bergard variants of Derusbi. The specific\n\n indicators are provided later in this post, but the relationship is\n\n illustrated with these tables. The dates on these records is worth\n\n noting, since it could potentially indicate campaign periods.\n\n Passive DNS relationship\n\n\n-----\n\n**Record Type**\n\n\n**Time** first seen 04-09-2016\nlast seen 04-19-2016\n\n### * Source DomainTools/Farsight DNSDB\n\n\nfirst seen 04-25-2016\nlast seen 04-29-2016\n\n\n### Passive DNS relationship from 121.54.168[.]216\n\n\n-----\n\n**dash[.]com** **cache[.]com**\n\n\n**Record Type**\n\n\n**Time** first seen 01-142016\nlast seen 04-022016\n\n\nfirst seen 01-29-2016\nlast seen 02-02-2016\n\n\nfirst seen 01-032016\nlast seen 01-232016\n\n\n### * Source DomainTools/Farsight DNSDB\n\n In this vein, there's a clear preponderance of popular online\n\n services and technologies – variants of Google, Office 365,\n\n Virtualbox and VMtools feature in this domain set. It has to be\n\n noted that these are technologies that are very popular across a\n\n broad set of enterprises and offer a very broad set of\n\n opportunities.\n\n## Malware Analysis\n\n### All four variants perform an HTTP request that is almost identical,\n\n with the exception of the Command & Control server and a small\n\n variant in one of the “Referrer” values. Even a 16-digit value in the URL\n\n and Cookie was the same. This beacon format and 16-digit value was\n\n also observed in the PGV_PVID variants analyzed earlier this year by\n\n Proofpoint.\n\n Three of the samples contained the following string of interest:\n\n “payload_service_x64.dll”.\n\n These PGV_PVID variants were observed encoding some of its\n\n configuration, APIs and other strings with a single-byte XOR key.\n\n Some of the keys used are: 0x90, 0xEB and 0x57.\n\n\n-----\n\n### disguise themselves during entrenchment as valid services in the\n\n system to try to confuse incident responders, computer forensics\n\n investigators and network administrators. The following screenshots\n\n show the Microsoft service management console with the legit and\n\n malicious service (malicious service highlighted):\n\n The following is a list of the malware samples analyzed:\n\n\n-----\n\ndetections Date\n\n3e4fbb9190227848af32dacb17e9fd17 google-dash[dot]com 0 12/4/14\n\nb93197e2aa147fe6b70695ae7bb298b0 office365e[dot]com 0 12/4/14\n\n4979e819d3ffbea81c7111fb515c1c7 web01.kruul[dot]com 22 4/11/13\n\n791295ef196cf8c20913b3cce76af29a google-dash[dot]com 16 12/4/14\n\n### Two samples of the network traffic format associated with this threat:\n\n 1. b93197e2aa147fe6b70695ae7bb298b0\n\n\n-----\n\nReferer: http://www.microsoft.com/\nAccept: */*\nAccept-Language: en-us\nAccept-Encoding: gzip, deflate\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Win32)\nHost: office365e[dot]com:80\nCache-Control: no-cache\nConnection: Keep-Alive\nCookie: pgv_pvid=0220372661170240\n\n\n### 2. 3e4fbb9190227848af32dacb17e9fd17\n\n\n-----\n\nReferer: http://www.google.com/\nAccept: */*\nAccept-Language: en-us\nAccept-Encoding: gzip, deflate\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Win32)\nHost: www.google-dash[dot]com:80\nCache-Control: no-cache\nConnection: Keep-Alive\nCookie: pgv_pvid=0220372661170240\n\n\n### Antivirus detection for two of the samples:\n\n 1. 3e4fbb9190227848af32dacb17e9fd17\n\n 2. b93197e2aa147fe6b70695ae7bb298b0\n\n## Indicators of Compromise\n\n### Registry Entrenchment\n\n HKLM\\System\\CurrentControlSet\\services\\hkmservice\\Paramet\n\n [CWD]\\64 dll\n\n\n-----\n\n### swprvsvc\\Parameters\\ServiceDll=[CWD]\\swprv64.dll\n\n HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed\n\n Components\\{BD5A117E-658C-4b8c-AED3\n 3D177B36F0A8}\\stubpath=C:\\Windows\\system32\\regsvr32.exe\n\n /s [CWD]\\MSChartCtrl.ocx\n\n Service Information\n\n Display Name 1: Health Key and Certificate Management Service\n\n Service Name 1: hkmservice\n\n Display Name 2: Microsoft office products Shadow Copy Provider\n\n Service Name 2: swprvsvc\n\n Mutex\n\n 2-7-26-96EFFFFD-6666-706b-6506-3B6BC6486663-0-7-2\n\n 1-5-19-85EDC10D-6745-404b-A50D-4BCBC6480873-1-5-19\n\n Command & Control Servers\n\n google-dash[dot]com\n\n office365e[dot]com\n\n kruul[dot]com\n\n nsa.org[dot]cn\n\n URLs\n\n /projects/security/pki/nss/index.htm?[16 digits]\n\n /developers/menu.php?[16 digits]\n\n /pki/nss/init?[16 digits]\n\n /solutions/company-size/smb/index.htm?[16 digits]\n\n /selfservice/microsites/search.php?[16 digits]\n\n /store/category_groups?[16 digits]\n\n\n-----\n\n### The following Yara rule was created to detect these samples:\n\n\n-----\n\nmeta:\ncopyright = “Fidelis Cybersecurity”\nstrings:\n$ = \"Accept:\"\n$ = \"User-Agent: %s\"\n$ = \"Host: %s:%d\"\n$ = \"Cache-Control: no-cache\"\n$ = \"Connection: Keep-Alive\"\n$ = \"Cookie: pgv_pvid=\"\n$ = \"Content-Type: application/x-octet-stream\"\n$ = \"User-Agent: %s\"\n$ = \"Host: %s:%d\"\n$ = \"Pragma: no-cache\"\n$ = \"Connection: Keep-Alive\"\n$ = \"HTTP/1.0\"\ncondition:\n(uint16(0) == 0x5A4D) and (all of them)\n\n\n## Domains identified from pDNS pivots\n\n### asixgroupincmeer[.]biz\n\n attrcorp[.]com\n\n smtp.attrcorp[.]com\n\n office365e[.]com\n\n office365e[.]com\n\n usapappers[.]com\n\n e.usapappers[.]com\n\n bee.usapappers[.]com\n\n ftp.usapappers[.]com\n\n [ ]\n\n\n-----\n\n### shot.usapappers[.]com\n\n email.usapappers[.]com\n\n dijlacultus[.]com\n\n bbs.dijlacultus[.]com\n\n fok.dijlacultus[.]com\n\n back.dijlacultus[.]com\n\n info.dijlacultus[.]com\n\n live.dijlacultus[.]com\n\n mail.dijlacultus[.]com\n\n news.dijlacultus[.]com\n\n serv.dijlacultus[.]com\n\n tele.dijlacultus[.]com\n\n thec.dijlacultus[.]com\n\n zero.dijlacultus[.]com\n\n swiss.dijlacultus[.]com\n\n living.dijlacultus[.]com\n\n\n-----\n\n### google-dash[.]com\n\n virtualboxs[.]com\n\n steletracker[.]com\n\n vmtools[.]net\n\n pwc.vmtools[.]net\n\n win.winlogon[.]net\n\n asia.winlogon[.]net\n\n winner.winlogon[.]net\n\n hawkthorn[.]net\n\n strightspunddeals[.]net\n\n northropgruman[.]org\n\n owa.northropgruman[.]org\n\n vpn.northropgruman[.]org\n\n soft.northropgruman[.]org\n\n update.northropgruman[.]org\n\n software.northropgruman[.]org\n\n\n-----\n\n### eimqqakugeccgwak[.]org\n\n uogwoigiuweyccsw[.]org\n\n soyy[.]info\n\n haha[.]school\n\n ns1.krimeware[.]com\n\n ns2.krimeware[.]com\n\n tianzhen[.]co\n\n www[.]tianzhen[.]co\n\n monsterlegendsvn[.]biz\n\n www[.]monsterlegendsvn[.]biz\n\n nickytoh[.]com\n\n www[.]nickytoh[.]com\n\n seratjati[.]com\n\n aiselamodefactory[.]com\n\n tasty-and-healthy[.]com\n\n nickytoh[.]net\n\n\n-----\n\n### animationmyth[.]net\n\n www[.]animationmyth[.]net\n\n petersenstore[.]org\n\n www[.]petersenstore[.]org\n\n forum.haha[.]school\n\n musicis[.]science\n\n## References\n\n### -- The Fidelis Threat Research Team\n\n**Original URL:**\n\nhttp://www.threatgeek.com/2016/05/turbo-twist-two-64-bit-derusbi-strains\nconverge.html\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/ex6wh2qsg1c29sob6f70x1q6eoe3v64w"
    ],
    "report_names": [
        "Fidelis_Turbo-Twist-Two-64-bit-Derusbi-Strains-Converge(May-2-16)"
    ],
    "threat_actors": [
        {
            "id": "1f3cf3d1-4764-4158-a216-dd6352e671bb",
            "created_at": "2022-10-25T15:50:23.837615Z",
            "updated_at": "2025-03-27T02:00:55.556414Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "APT19",
                "Codoso",
                "C0d0so0",
                "Codoso Team",
                "Sunshop Group"
            ],
            "source_name": "MITRE:APT19",
            "tools": [
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7a9a7873-8e41-40ae-9d06-b27c92bb54e4",
            "created_at": "2022-10-25T16:47:55.568362Z",
            "updated_at": "2025-03-27T02:05:17.264615Z",
            "deleted_at": null,
            "main_name": "BRONZE FIRESTONE",
            "aliases": [
                "C0d0s0",
                "Deep Panda ",
                "Pupa ",
                "TG-3551 ",
                "APT19 "
            ],
            "source_name": "Secureworks:BRONZE FIRESTONE",
            "tools": [
                " Alice's Rabbit Hole",
                " Briba",
                " Cobalt Strike",
                " Derusbi",
                " PlugX",
                " PoisonIvy",
                " Powershell Empire",
                " Zuguo",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "46a151bd-e4c2-46f9-aee9-ee6942b01098",
            "created_at": "2023-01-06T13:46:38.288168Z",
            "updated_at": "2025-03-27T02:00:02.794118Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "Black Vine",
                "TEMP.Avengers",
                "PinkPanther",
                "G0073",
                "KungFu Kittens",
                "Group 13",
                "Shell Crew",
                "BRONZE FIRESTONE",
                "G0009",
                "Sunshop Group",
                "DEEP PANDA",
                "Codoso"
            ],
            "source_name": "MISPGALAXY:APT19",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0639667a-fb3f-43d9-a38c-6c123fd19c7f",
            "created_at": "2022-10-25T16:07:23.335869Z",
            "updated_at": "2025-03-27T02:02:09.743237Z",
            "deleted_at": null,
            "main_name": "APT 19",
            "aliases": [
                "APT 19",
                "Bronze Firestone",
                "C0d0so0",
                "Codoso",
                "Deep Panda",
                "Operation Kingslayer",
                "Red Pegasus",
                "Sunshop Group",
                "TG-3551"
            ],
            "source_name": "ETDA:APT 19",
            "tools": [
                "Agentemis",
                "C0d0so0",
                "Cobalt Strike",
                "CobaltStrike",
                "Derusbi",
                "EmPyre",
                "EmpireProject",
                "Fire Chili",
                "PowerShell Empire",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041802,
    "ts_creation_date": 1463259816,
    "ts_modification_date": 1463259816,
    "files": {
        "pdf": "https://archive.orkl.eu/5ba6ec70bf70a31f8d61d408be83d3a999d9beee.pdf",
        "text": "https://archive.orkl.eu/5ba6ec70bf70a31f8d61d408be83d3a999d9beee.txt",
        "img": "https://archive.orkl.eu/5ba6ec70bf70a31f8d61d408be83d3a999d9beee.jpg"
    }
}