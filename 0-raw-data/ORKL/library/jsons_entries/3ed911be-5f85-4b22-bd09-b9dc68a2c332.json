{
    "id": "3ed911be-5f85-4b22-bd09-b9dc68a2c332",
    "created_at": "2023-01-12T15:10:19.926669Z",
    "updated_at": "2025-03-27T02:08:36.179014Z",
    "deleted_at": null,
    "sha1_hash": "687dbba95dd81c80f15f469f994a40d5669e7a6e",
    "title": "2021-03-26 - Threat Assessment Matrix Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-25T14:27:03Z",
    "file_modification_date": "2022-05-25T14:27:03Z",
    "file_size": 1207299,
    "plain_text": "# Threat Assessment: Matrix Ransomware\n\n**unit42.paloaltonetworks.com/matrix-ransomware**\n\nBy [Unit 42](https://unit42.paloaltonetworks.com/author/unit42/)\n\nMarch 26, 2021 at 1:30 PM\n\n[Category: Ransomware,](https://unit42.paloaltonetworks.com/category/ransomware/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [Matrix,](https://unit42.paloaltonetworks.com/tag/matrix/) [ransomware threat report,](https://unit42.paloaltonetworks.com/tag/ransomware-threat-report/) [threat assessment](https://unit42.paloaltonetworks.com/tag/threat-assessment/)\n\n[This post is also available in: 日本語 (Japanese)](https://unit42.paloaltonetworks.jp/matrix-ransomware/)\n\n## Executive Summary\n\n\nMarch 26, 2021\n\n\n[Matrix is a ransomware family that was first identified publicly in December 2016. Over the](https://www.bleepingcomputer.com/news/security/matrix-ransomware-spreads-to-other-pcs-using-malicious-shortcuts/)\nyears since its inception, it has primarily targeted small- to medium-sized organizations. As\nof 2019, it [had been observed across geographic locations such as the U.S., Belgium, Taiwan,](https://www.zdnet.com/article/matrix-has-slowly-evolved-into-a-swiss-army-knife-of-the-ransomware-world/)\nSingapore, Germany, Brazil, Chile, South Africa, Canada and the UK. While initially\nleveraging tactics such as spam email campaigns, propagation via Windows shortcuts and the\nRIG exploit kit for distribution, the primary attack vector for the Matrix ransomware family\nshifted in 2018 to brute forcing weak Remote Desktop Protocol (RDP) credentials. The shift\nto this attack methodology appears to be a recurring trend in similar targeted ransomware\n[families such as Dharma,](https://unit42.paloaltonetworks.com/ransomware-threat-assessments/6/) [Ryuk and BitPaymer.](https://unit42.paloaltonetworks.com/ryuk-ransomware/)\n\n## Matrix Ransomware Overview\n\n\n-----\n\n-----\n\nFigure 1. Screenshot of Matrix ransom note\n\nWhen executed, Matrix encrypts user files and network shares, as well as deleting volume\nshadow copies and disabling recovery options on the affected device. Like with many other\nransomware variants, the ransom note delivered by Matrix demands payment in Bitcoin.\nInstead of spreading through an organization, past Matrix infections appear to have been\nmore [targeted in nature.](https://www.sentinelone.com/blog/matrix-ransomware-changes-rules-much-worth/)\n\nMatrix is unique in that instead of delivering a more conventional ransom note that demands\na fixed ransom amount, the threat actors behind it ask victims to contact them directly and\nsubmit a small sample of about three to five files for decryption. This is done so the threat\n\n\n-----\n\nactors can determine a variable ransom based on factors such as the predicted value of the\nvictim’s files or the current dollar value of Bitcoin.\n\nAs of 2020, Matrix ransomware has been seen appending the following file extensions on\nfiles:\n.MTXLOCK, .CORE, .ANN, .FOX, .KOK8, .KOK08, .NEWRAR, .FASTBOB, .FASTB, .EMAN,\n.THDA, .RAD, .EMAN50, .GMPF, .ATOM, .NOBAD, .TRU8, .FASTA, .JNSS, .FBK, .ITLOCK,\n.SPCT, .PRCP, .CHRB, .AL8G, .DEUS, .FG69, .JB88, .J91D, .S996, .\n\n[barboza40@yahoo.com], .[Linersmik@naver.com][Jinnyg@tutanota.com], .\n\n[poluz@tutanota.com], .[Yourencrypt@tutanota.com], .[Files4463@tuta.io], .\n\n[RestorFile@tutanota.com], .[RestoreFile@qq.com], .[oken@tutanota.com], .\n\n[Vfemacry@mail-on.us], .[d3336666@tutanota.com], and .[Bitmine8@tutanota.com]\n\nIn addition, Matrix has other variants, including one dubbed “Fox Ransomware,” which adds\nthe “.FOX” extension to encrypted files.\n\nMore information on prominent ransomware families can be found in the 2021 Unit 42\nRansomware Threat Report.\n\n## Courses of Action\n\nThis section documents relevant tactics, techniques and procedures (TTPs) used with Matrix\nand maps them directly to Palo Alto Networks product(s) and service(s). It also further\ninstructs customers on how to ensure their devices are configured correctly.\n\n\n**Product /**\n**Service**\n\n\n**Course of Action**\n\n\n**Initial Access, Persistence, Lateral Movement**\n\nThe below courses of action mitigate the following techniques:\n\n**Spearphishing Attachment [T1566.001], Valid Accounts [T1078], Replication**\n**Through Removable Media [T1091], Remote Desktop Protocol [T1021.001]**\n\nNGFW Set up File Blocking\n\nEnsure that security policies restrict User-ID Agent traffic from crossing into\nuntrusted zones\n\nEnsure application security policies exist when allowing traffic from an\nuntrusted zone to a more trusted zone\n\nEnsure 'Service setting of ANY' in a security policy allowing traffic does not\nexist\n\n\n-----\n\nThreat\nPrevention†\n\n\nEnsure 'Security Policy' denying any/all traffic to/from IP addresses on\nTrusted Threat Intelligence Sources Exists\n\nEnsure that User-ID is only enabled for internal trusted interfaces\n\nEnsure that 'Include/Exclude Networks' is used if User-ID is enabled\n\nEnsure that the User-ID Agent has minimal permissions if User-ID is\nenabled\n\nEnsure that the User-ID service account does not have interactive logon\nrights\n\nEnsure remote access capabilities for the User-ID service account are\nforbidden\n\nEnsure that antivirus profiles are set to block on all decoders except 'imap'\nand 'pop3'\n\nEnsure a secure antivirus profile is applied to all relevant security policies\n\nEnsure that all zones have Zone Protection Profiles with all Reconnaissance\nProtection settings enabled, tuned and set to appropriate actions\n\n\nWildFire† Ensure that WildFire file size upload limits are maximized\n\nEnsure forwarding is enabled for all applications and file types in WildFire\nfile blocking profiles\n\nEnsure a WildFire Analysis profile is enabled for all security policies\n\nEnsure forwarding of decrypted content to WildFire is enabled\n\nEnsure all WildFire session information settings are enabled\n\nEnsure alerts are enabled for malicious files detected by WildFire\n\nEnsure 'WildFire Update Schedule' is set to download and install updates\nevery minute\n\nCortex XDR Configure Host Firewall Profile\n\nConfigure Malware Security Profile\n\nEnable Device Control\n\n\nCortex\nXSOAR\n\n\nDeploy XSOAR Playbook - Block Account Generic\n\nDeploy XSOAR Playbook - Access Investigation Playbook\n\nDeploy XSOAR Playbook - Impossible Traveler\n\n\n-----\n\nDeploy XSOAR Playbook - Phishing Investigation - Generic V2\n\nDeploy XSOAR Playbook - Endpoint Malware Investigation\n\n**Credential Access**\n\nThe below courses of action mitigate the following techniques:\n\n**Brute Force [T1110]**\n\nNGFW Customize the Action and Trigger Conditions for a Brute Force Signature\n\n\nCortex\nXSOAR\n\n\nDeploy XSOAR Playbook - Brute Force Investigation Playbook\n\n\n**Execution, Defense Evasion, Persistence, Privilege Escalation, Impact**\n\nThe below courses of action mitigate the following techniques:\n\n**Windows Command Shell [T1059.003], Match Legitimate Name or Location**\n\n**[T1036.005], Services File Permissions Weakness [T1574.010], Disable or Modify**\n**Tools [T1562.001], Service Stop [T1489], Modify Registry [T1112], Data Encrypted for**\n**Impact [T1486], Inhibit System Recovery [T1490]**\n\nCortex XDR Enable Anti-Exploit Protection\n\nEnable Anti-Malware Protection\n\nConfigure Restrictions Security Profile\n\nConfigure Behavioral Threat Protection under the Malware Security Profile\n\n\nCortex\nXSOAR\n\n\nDeploy XSOAR Playbook - Ransomware Manual for incident response.\n\nDeploy XSOAR Playbook - Palo Alto Networks Endpoint Malware\nInvestigation\n\n\n_Table 1. Courses of Action for Matrix ransomware.†These capabilities are part of the NGFW security subscriptions service._\n\n## Conclusion\n\nWhile targeted ransomware attacks are not new, Matrix is a prime example of how threat\nactors can enter into the pool of existing ransomware and cash out quickly by targeting lowhanging fruit. The ransom negotiation tactics used by the Matrix threat actors further\namplifyies the dangerous impact that such an attack can have on its victims, especially given\nthe volatile state of cryptocurrency value today. Furthermore, this malware family’s shift in\ntactics to RDP exploitation, following a similar shift seen in other ransomware groups, serves\nto emphasize the need for businesses to stay vigilant on current ransomware trends.\n\nPalo Alto Networks detects and prevents Matrix in the following ways:\n\n[WildFire: All known samples are identified as malware.](https://www.paloaltonetworks.com/products/secure-the-network/wildfire)\n\n\n-----\n\n[Cortex XDR with:](https://www.paloaltonetworks.com/cortex/cortex-xdr)\n\nIindicators for Matrix.\nAnti-Ransomware Module to detect Matrix encryption behaviors.\nLocal Analysis detection to detect Matrix binaries.\n[Next-Generation Firewalls: DNS Signatures detect the known command and control](https://www.paloaltonetworks.com/network-security/next-generation-firewall)\n[(C2) domains, which are also categorized as malware in URL Filtering.](https://www.paloaltonetworks.com/products/threat-detection-and-prevention/web-security)\n[AutoFocus: Tracking related activity using the MatrixRansomware tag.](https://www.paloaltonetworks.com/cortex/autofocus)\n\nAdditionally, Indicators of Compromise (IoCs) associated with Matrix are available on\n[GitHub here, and have been published to the Unit 42 TAXII feed.](https://github.com/pan-unit42/iocs)\n\n## Additional Resources\n\n**Get updates from Palo Alto Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-26 - Threat Assessment Matrix Ransomware.pdf"
    ],
    "report_names": [
        "2021-03-26 - Threat Assessment Matrix Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536219,
    "ts_updated_at": 1743041316,
    "ts_creation_date": 1653488823,
    "ts_modification_date": 1653488823,
    "files": {
        "pdf": "https://archive.orkl.eu/687dbba95dd81c80f15f469f994a40d5669e7a6e.pdf",
        "text": "https://archive.orkl.eu/687dbba95dd81c80f15f469f994a40d5669e7a6e.txt",
        "img": "https://archive.orkl.eu/687dbba95dd81c80f15f469f994a40d5669e7a6e.jpg"
    }
}