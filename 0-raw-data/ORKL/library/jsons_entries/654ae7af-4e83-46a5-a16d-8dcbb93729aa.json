{
    "id": "654ae7af-4e83-46a5-a16d-8dcbb93729aa",
    "created_at": "2023-01-12T15:04:35.222627Z",
    "updated_at": "2025-03-27T02:09:30.404349Z",
    "deleted_at": null,
    "sha1_hash": "45bd28d8ea2763b03e853a5f5faee9783ce03656",
    "title": "2021-09-23 - Financially motivated actor breaks certificate parsing to avoid detection",
    "authors": "",
    "file_creation_date": "2022-05-28T15:52:41Z",
    "file_modification_date": "2022-05-28T15:52:41Z",
    "file_size": 101864,
    "plain_text": "# Financially motivated actor breaks certificate parsing to avoid detection\n\n**[blog.google/threat-analysis-group/financially-motivated-actor-breaks-certificate-parsing-avoid-detection/](https://blog.google/threat-analysis-group/financially-motivated-actor-breaks-certificate-parsing-avoid-detection/)**\n\nNeel Mehta September 23, 2021\n\n[Threat Analysis Group](https://blog.google/threat-analysis-group/)\n\n## Introduction\n\nGoogle’s Threat Analysis Group tracks actors involved in disinformation campaigns, government backed hacking, and\nfinancially motivated abuse. Understanding the techniques used by attackers helps us counter these threats\neffectively. This blog post is intended to highlight a new evasion technique we identified, which is currently being used\nby a financially motivated threat actor to avoid detection.\n\nAttackers often rely on varying behaviors between different systems to gain access. For instance, attacker’s may\nbypass filtering by convincing a mail gateway that a document is benign so the computer treats it as an executable\nprogram. In the case of the attack outlined below, we see that attackers created malformed code signatures that are\ntreated as valid by Windows but are not able to be decoded or checked by OpenSSL code — which is used in a\nnumber of security scanning products. We believe this is a technique the attacker is using to evade detection rules.\n\n## Technical Details\n\nCode signatures on Windows executables provide guarantees about the integrity of a signed executable, as well as\ninformation about the identity of the signer. Attackers who are able to obscure their identity in signatures without\naffecting the integrity of the signature can avoid detection longer and extend the lifetime of their code-signing\ncertificates to infect more systems.\n\n[OpenSUpdater, a known family of unwanted software which violates our policies and is harmful to the user experience,](https://www.google.com/about/unwanted-software-policy.html)\nis used to download and install other suspicious programs.The actor behind OpenSUpdater tries to infect as many\nusers as possible and while they do not have specific targeting, most targets appear to be within the United States and\nprone to downloading game cracks and grey-area software.\n\nGroups of OpenSUpdater samples are often signed with the same code-signing certificate, obtained from a legitimate\ncertificate authority. Since mid-August, OpenSUpdater samples have carried an invalid signature, and further\ninvestigation showed this was a deliberate attempt to evade detection. In these new samples, the signature was edited\n\n\n-----\n\nsuch that an End of Content (EOC) marker replaced a NULL tag for the parameters element of the\n[SignatureAlgorithm signing the leaf X.509 certificate.](https://datatracker.ietf.org/doc/html/rfc3280#section-4.1.1.2)\n\nEOC markers terminate indefinite-length encodings, but in this case an EOC is used within a definite-length encoding\n(l= 13).\n\nBytes: 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 00 00\n\nDecodes to the following elements:\n\n**SEQUENCE (2 elem)**\n\n**OBJECT IDENTIFIER 1.2.840.113549.1.1.11 sha256WithRSAEncryption (PKCS #1)**\n\n**EOC**\n\nSecurity products using OpenSSL to extract signature information will reject this encoding as invalid. However, to a\nparser that permits these encodings, the digital signature of the binary will otherwise appear legitimate and valid. This\nis the first time TAG has observed actors using this technique to evade detection while preserving a valid digital\nsignature on PE files.\n\nAs shown in the following screenshot, the signature is considered to be valid by the Windows operating system. This\nissue has been reported to Microsoft.\n\nSince first discovering this activity, OpenSUpdater's authors have tried other variations on invalid encodings to further\nevade detection.\n\n**The following are samples using this evasion:**\n\nhttps://www.virustotal.com/gui/file/5094028a0afb4d4a3d8fa82b613c0e59d31450d6c75ed96ded02be1e9db8104f/detection\n\n**New variant:**\n\n\n-----\n\nhttps://www.virustotal.com/gui/file/5c0ff7b23457078c9d0cbe186f1d05bfd573eb555baa1bf4a45e1b79c8c575db/detection\n\n[Our team is working in collaboration with Google Safe Browsing to protect users from downloading and executing this](https://safebrowsing.google.com/)\nfamily of unwanted software. Users are encouraged to only download and install software from reputable and\ntrustworthy sources.\n\nPOSTED IN:\n\n[Threat Analysis Group](https://blog.google/threat-analysis-group/%20)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-23 - Financially motivated actor breaks certificate parsing to avoid detection.pdf"
    ],
    "report_names": [
        "2021-09-23 - Financially motivated actor breaks certificate parsing to avoid detection.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535875,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653753161,
    "ts_modification_date": 1653753161,
    "files": {
        "pdf": "https://archive.orkl.eu/45bd28d8ea2763b03e853a5f5faee9783ce03656.pdf",
        "text": "https://archive.orkl.eu/45bd28d8ea2763b03e853a5f5faee9783ce03656.txt",
        "img": "https://archive.orkl.eu/45bd28d8ea2763b03e853a5f5faee9783ce03656.jpg"
    }
}