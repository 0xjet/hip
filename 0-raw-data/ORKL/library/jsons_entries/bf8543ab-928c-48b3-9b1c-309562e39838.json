{
    "id": "bf8543ab-928c-48b3-9b1c-309562e39838",
    "created_at": "2023-01-12T15:00:15.980957Z",
    "updated_at": "2025-03-27T02:05:29.624907Z",
    "deleted_at": null,
    "sha1_hash": "f29b853f5bbacda2bc157b6949d3278c14b86cca",
    "title": "2016-02-29 - New Malware ‘Rover’ Targets Indian Ambassador to Afghanistan",
    "authors": "",
    "file_creation_date": "2022-05-28T17:56:25Z",
    "file_modification_date": "2022-05-28T17:56:25Z",
    "file_size": 1275862,
    "plain_text": "# New Malware 'Rover' Targets Indian Ambassador to Afghanistan\n\n**[researchcenter.paloaltonetworks.com/2016/02/new-malware-rover-targets-indian-ambassador-to-afghanistan/](http://researchcenter.paloaltonetworks.com/2016/02/new-malware-rover-targets-indian-ambassador-to-afghanistan/)**\n\nVicky Ray, Kaoru Hayashi February 29, 2016\n\nBy [Vicky Ray and](https://unit42.paloaltonetworks.com/author/vicky-khan/) [Kaoru Hayashi](https://unit42.paloaltonetworks.com/author/khayashi/)\n\nFebruary 29, 2016 at 5:00 PM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Threat Prevention,](https://unit42.paloaltonetworks.com/category/threat-prevention-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [OpenAL,](https://unit42.paloaltonetworks.com/tag/openal/) [OpenCV,](https://unit42.paloaltonetworks.com/tag/opencv/) [Rover,](https://unit42.paloaltonetworks.com/tag/rover/) [Trojan,](https://unit42.paloaltonetworks.com/tag/trojan/) [VirusTotal](https://unit42.paloaltonetworks.com/tag/virustotal/)\n\nOn December 24, 2015, Unit 42 identified a targeted attack, delivered via email, on a high profile Indian diplomat, an\nAmbassador to Afghanistan. The body and content of the email suggest that it was crafted and spoofed to look like it was sent\nby the current Defence Minister of India, Mr. Manohar Parrikar, commending the Ambassador on his contributions and\nsuccess.\n\nIndia has been a key nation in building and funding Afghanistan’s infrastructure and economic development, which includes\nsetting up iron ore mines, steel plants, power plants and transportation systems, helping reconstruct the Salma Dam and\n[constructing a new Parliament Complex for the Afghan Government.](https://en.wikipedia.org/wiki/Afghanistan%E2%80%93India_relations)\n\nGiven [India’s significant contributions to the development of Afghanistan, it is likely that there may be groups or nations who](https://en.wikipedia.org/wiki/Afghanistan%E2%80%93India_relations)\nwould be interested in tracking and spying on key individuals who officially represent India in Afghanistan.\n\n## Overview of Rover infection\n\nFigure 1 gives an overview of the exploitation, infection and C2 communications of the 'Rover' Trojan campaign targeting a\nvictim running Windows XP.\n\nFigure 1: Overview of the infection flow and C2 communications\n\nRover Trojan Infection Steps:\n\n1. RTF file exploits CVE-2010-3333 and downloads an executable from newsumbrella[.]net.\n\n1. The executable file downloaded from newsumbrella[.]net is executed on the victim machine.\n\n1. The executable 'file.exe' is a downloader which is used to call out to a server with the IP '46.166.165.254' and download\n\nthe main Rover malware along with plugins used by the Rover malware.\n\n1 Rover malware and plugins are downloaded and installed on the victim machine\n\n\n-----\n\n1. Data exfiltrated from the victim machine.\n\n## Targeting and Infection\n\nFigure 2 shows an email which was sent to the Ambassador of India, appearing to commend the contributions the Ambassador\nhas made in the development and success of projects on national interest, and attaching a letter of appreciation with a file\nname, “Appreciation_letter.doc”.\n\nThe attachment is an RTF file which exploits a specific vulnerability in Microsoft Word, CVE-2010-3333.\n\nFigure 2: Spear phishing email sent to the Ambassador of Afghanistan\n\nIf the recipient of the e-mail opened the attachment in a vulnerable version of Word, the exploit code would download and\nexecute a file from the domain newsumbrella[.]net as shown in Figure 3 below.\n\nFigure 3: Hexdump showing the domain and the executable downloaded\n\n## Malware Analysis\n\nDuring the time of analysis the executable file systemupdateAPI.exe was no longer being hosted on the newsumbrealla[.]net\ndomain. However, we have noticed the same domain hosting another executable in the past within the same parent directory\nand having a similar naming for the folders as shown below\n\n_newsumbrella[.]net/ne3s/lat3st/w0rld/systemupdateAPI[.]exe_\n\n\n-----\n\n_newsumbrella[.]net/ne3s/file[.]exe hosted earlier_\n\nWe believe that the executables hosted under the parent directory ‘ne3s’ are variants of the same downloader Trojan, which\nwas used to download the Rover Trojan. The file, file.exe, contains the following debug information that indicates the file was\noriginally named systemupdateAPI.exe.\n\nFigure 4: Debug information of downloader program\n\nBy analyzing file.exe, we can see that it is a downloader, which creates ‘c:\\system’ directory and depending on the OS version\nused, downloads the main Rover payload along with multiple DLL modules from 46.166.165.254.\n\nFigure 5: Code snippet showing the OS version check and the subsequent download from 46.166.165.254\n\nIf the infected system is running an OS version prior to Windows Vista, it would download the following files from\n46.166.165.254:\n\nWindowsSecurityService2.exe ('Rover' main module)\nOpenal32.dll\nCxcore210.dll (OpenCV)\nHighgui210.dll (OpenCV)\nlibsndfile-1.dll\n\n\n-----\n\nIf the OS version is Windows Vista or later, it would download the following files from 46.166.165.254 :\n\nWindowsSecurityService3.exe ('Rover' main module)\nOpenAL32.dll\nopencv_world300.dll\nmsvcp100.dll\nmsvcp110.dll\nmsvcp120.dll\nmsvcr100.dll\nmsvcr110.dll\nmsvcr120.dll\n\nAfter retrieving these files, the downloader Trojan executes the main module. Even though the main modules use different\nlibrary versions, the functionality of the backdoors are identical.\n\nBy analyzing the files downloaded to the victim machine, we can see that the executable WindowsSecurityService2.exe\nimports the four DLL files that were downloaded to the same directory. The four DDLs are cxcore210.dll, highgui210.dll,\n_OpenAL32.dll and libsndfile-1.dll as shown in Figure 6_\n\nFigure 6: Executable and DLLs downloaded to the victim machine\n\nAttributes of the Rover variant\n\n##############################################\n\n_File: WindowsSecurityService2.exe_\n\n##############################################\n\n_Meta-data_\n\n===============================================\n\nSize     : 337920 bytes\nType     : PE32 executable (console) Intel 80386, for MS Windows\nArchitecture : 32 Bits binary\nMD5      : 76429f8515768f9f5def697e71071f51\nSHA1     : d04ce934561934f758d77dfa944bd6743dd82cff\nSHA256: 7757517ae6b4d513a57826f9ab65bd070d99d25ac526cfae3e9955c3c7cd457assdeep       :\n6144:JabBRNUKgZ9SN0jzoFBB9hcrpXwg9xXYOGl93XO2rQLfbTpLuO7bIWjRO5gjPNq:JarSKu6yzoF8rpAqXYv3XOgQLfnpLuOu\nimphash        : b5aa366f452feb9f4dff3c72157ca1f9\nDate     : 0x5637227B [Mon Nov 2 08:44:43 2015 UTC]\nLanguage   : ENGLISH\nCRC:  (Claimed) : 0x59736, (Actual): 0x59736\nEntry Point  : 0x43e3c8 .text 0/5\n\n\n-----\n\nImports\n\n===============================================\n\n[1] ADVAPI32.dll\n\n[2] WS2_32.dll\n\n[3] WLDAP32.dll\n\n**[4] cxcore210.dll (OpenCV module)**\n\n**[5] highgui210.dll (OpenCV module)**\n\n**[6] OpenAL32.dll**\n\n**[7] libsndfile-1.dll**\n\n[8] GDI32.dll\n\n[9] KERNEL32.dll\n\n[10] USER32.dll\n\n[11] MSVCP90.dll\n\n[12] RPCRT4.dll\n\n[13] MSVCR90.dll\n\nThe author of 'Rover' used the following open source projects to implement the main functionalities of this custom malware.\n\nOpenCV – Taking photos from the web cam\nOpenAL – Recording Audio\nLibsndfile – C library used for reading and writing audio files\nLibCurl – For all network communications\n\n## OpenCV and OpenAL\n\n[Both versions of Rover use OpenCV and](http://opencv.org/) [OpenAL for some of the main functions.](https://www.openal.org/)\n\n[OpenCV is a library of functions written primarily for building real time computer vision applications, image processing and also](http://docs.opencv.org/master/d1/dfb/intro.html#gsc.tab=0)\nmachine learning. It has seen wide acceptance in security systems, medical image analysis, unmanned vehicles, visual\nsurveillance, object tracking, Artificial Intelligence and many other applications.\n\n[OpenAL is a cross-platform audio API for rendering multichannel three-dimensional positional audio (i.e., It is a means to](https://en.wikipedia.org/wiki/OpenAL)\ngenerate audio in a three-dimensional space.) Earlier versions of OpenAL were opensource but later versions (since v1.1)\nhave been proprietary.\n\nOnce executed, Rover creates following registry entry to execute itself when the computer reboots.\n\n_HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\"System Application\" =_\n_c:\\system\\WindowsSecurityService[2 or 3].exe_\n\nThe malware then creates six threads, each with a different job:\n\nHeartbeat\nScreenshot\nStealing Files from HDD\nKeylogger\nSearch files on USB\nBackdoor\n\n\n-----\n\nFigure 7: Threads created by the malware\n\n1. Heartbeat:\n\nThis sends heartbeat signal on HTTP to the C2 server at 46.166.165.254 every five seconds and checks whether the C2\nserver is running.\n\n2. ScreenShot:\n\nThis saves screenshots as c:\\system\\screenshot.bmp and sends it to the C2 server at 46.166.165.254 every 60 minutes.\n\nFigure 8: Screenshots sent to C2 server at 46.166.165.254\n\n3. Finding specific file types on Removable Drive:\n\nThis thread searches for for files with the following extensions on removable drives and copies them to ‘c:\\system’ every 5\nseconds.\n\npdf\ndoc\ndocx\nppt\npptx\nxls\nxlsx\n\n4 Keylogger:\n\n\n-----\n\nThis logs key strokes at _c:\\system\\log.txt and sends captured data to the C2 every 10 seconds_\n\n5. Stealing specific file types from Hard Drive:\n\nThis thread searches for for files with the following extensions on fixed drives and sends them to C2 every 60 minutes.\n\npdf\ndoc\ndocx\nppt\npptx\nxls\nxlsx\n\nFigure 9: Document file being sent to C2\n\n6. Backdoor:\n\nThis thread obtains backdoor commands from C2 every 10 seconds and executes them. Backdoor commands are listed\nbelow:\n\n**Command** **Description**\n\nCAMERA Take photos using system webcam and store them as c:\\system\\camera.jpg before sending to the C2.\n\nAUDIO Record audio from default audio input as c:\\system\\audio.ogg and sending it to the C2.\n\nSCREEN Take a screenshot and save it as c:\\system\\screenshot.bmp then send it to the C2.\n\nKILL Remove persistence registry entry and terminate itself.\n\nThough 'Rover' is unsophisticated and lacks many modern features common to advanced malware, detection rate of the\n'Rover' is extremely low. At the time of this writing, two out of three samples on VirusTotal were not detected by any Antivirus\nproduct\n\n\n-----\n\nFigure 10: No detection by any AV product on Virustotal\n\nFigure 11: Low detection rate\n\n## Summary\n\nOpenCV has been extensively used by organizations, government bodies, and research groups for real time capture, image\nmanipulation, object detection and many other uses in new forms of Human-Computer interaction, security systems, driver-less\n[cars among many others. OpenCV was also used by the Mars Rovers to send captured data back to Earth.](https://ti.arc.nasa.gov/m/pub-archive/422h/0422%20(Pedersen).pdf)\n\nIt is interesting to see the very code used in such significant projects also being used to track and spy on individuals being\ntargeted and which can remain undetected by traditional security systems. Though 'Rover' is an unsophisticated malware\nlacking modern malware features, it seems to be successful in bypassing traditional security systems and fulfilling the\nobjectives of the threat actor behind the campaign in exfiltrating information from the targeted victim. It is important to\nunderstand the techniques and tools being used by such threat actors to better defend and protect organizations from such\nthreats.\n\n[Palo Alto Networks AutoFocus users can identify this threat using the Rover tag.](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Rover)\n\n## IOCs:\n\n_C2:_\n\n_46.166.165.254_\n\n_Downloader hosting links:_\n\n_newsumbrella[.]net/ne3s/lat3st/w0rld/systemupdateAPI[.]exe_\n\n_newsumbrella[.]net/ne3s/file[.]exe_\n\n_newsumbrella[.]net/bla3k/extra7/systemupdateAPI[.]exe_\n\n**Filename** **File Type** **SHA 256**\n\n\n-----\n\n**Appreciation_letter.doc** RTF 6c9862a65741b56b849928300\n\naff310d60b815ee5f5f9f133469\n\ne3b035e7e936\n\n**Questionnaire.doc** RTF 5f656cf07a1d5e7c439aad4023\n\n5dc78e47bac719c62e03728cc\n\n40267383880bd\n\n**Terrorism.doc;India &amp** RTF 6096ff941af95638944f2fcdf4a5\n\n046aa028b803b010b1a2d000\n\n028b1a4967bc\n\n\n**Appreciation_**\n\n**letter.doc**\n\n**WindowsSecurity**\n\n**Service3.exe**\n\n\nRTF 7bf3a425be41ad9cc713e4821\n\n6e061c788f36e2727de5d0b6b\n\n6ac4f435fe1c06\n\nRTF 06b12649dba7f61cb581f97797\n\nbdfba3a7f057a36b448d4c91a3\n\na7d89fff8d54\n\nPE 61a2935fcb0a385f9e67855ef6f\n\n95bda5f09fdb7c1435f215ce18\n\nb7b61993daa\n\n\n**file.exe** PE a5e5571cda838e97a6beb1a65\n\nacdfbaaf80027f60417aadb0d3\n\n4292f19c0f3b3\n\n\n**WindowsSecurity**\n\n**Service2.exe**\n\n**WindowsSecurity**\n\n**Service3.exe**\n\n## References\n\n\nPE 7757517ae6b4d513a57826f9ab\n\n65bd070d99d25ac526cfae3e99\n\n55c3c7cd457a\n\nPE 3dc709a3bcaa82220d6a76ea47\n\n374bd864c37817c7041c7e9f4e\n\ne8ba42847f34\n\n\n[https://en.wikipedia.org/wiki/Afghanistan%E2%80%93India_relations](https://en.wikipedia.org/wiki/Afghanistan%E2%80%93India_relations)\n\n[http://docs.opencv.org/3.1.0/#gsc.tab=0](http://docs.opencv.org/3.1.0/#gsc.tab=0)\n\n[http://docs.opencv.org/2.4/modules/highgui/doc/highgui.html](http://docs.opencv.org/2.4/modules/highgui/doc/highgui.html)\n\n[https://en.wikipedia.org/wiki/OpenAL](https://en.wikipedia.org/wiki/OpenAL)\n\n[http://www.cs.uml.edu/~holly/teaching/91450/spring2013/bschroeder_vision_robotics1.pdf](http://www.cs.uml.edu/~holly/teaching/91450/spring2013/bschroeder_vision_robotics1.pdf)\n\n[https://ti.arc.nasa.gov/m/pub-archive/422h/0422%20(Pedersen).pdf](https://ti.arc.nasa.gov/m/pub-archive/422h/0422%20(Pedersen).pdf)\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-02-29 - New Malware ‘Rover’ Targets Indian Ambassador to Afghanistan.pdf"
    ],
    "report_names": [
        "2016-02-29 - New Malware ‘Rover’ Targets Indian Ambassador to Afghanistan.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535615,
    "ts_updated_at": 1743041129,
    "ts_creation_date": 1653760585,
    "ts_modification_date": 1653760585,
    "files": {
        "pdf": "https://archive.orkl.eu/f29b853f5bbacda2bc157b6949d3278c14b86cca.pdf",
        "text": "https://archive.orkl.eu/f29b853f5bbacda2bc157b6949d3278c14b86cca.txt",
        "img": "https://archive.orkl.eu/f29b853f5bbacda2bc157b6949d3278c14b86cca.jpg"
    }
}