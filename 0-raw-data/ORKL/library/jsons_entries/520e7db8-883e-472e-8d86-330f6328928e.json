{
    "id": "520e7db8-883e-472e-8d86-330f6328928e",
    "created_at": "2023-01-12T14:59:04.981131Z",
    "updated_at": "2025-03-27T02:16:41.14324Z",
    "deleted_at": null,
    "sha1_hash": "e1fe9b4b7d41cc9da7d10674c05c1f536f4c5a51",
    "title": "2021-02-11 - Visibility, Monitoring, and Critical Infrastructure Security",
    "authors": "",
    "file_creation_date": "2022-05-28T19:40:18Z",
    "file_modification_date": "2022-05-28T19:40:18Z",
    "file_size": 121773,
    "plain_text": "# Visibility, Monitoring, and Critical Infrastructure Security\n\n**[domaintools.com/resources/blog/visibility-monitoring-and-critical-infrastructure-security](https://www.domaintools.com/resources/blog/visibility-monitoring-and-critical-infrastructure-security)**\n\n## Introduction\n\n[On 08 February 2021, officials from Pinellas County, Florida announced an unknown entity](https://www.tampabay.com/news/pinellas/2021/02/08/someone-tried-to-poison-oldsmars-water-supply-during-hack-sheriff-says/)\n[accessed water treatment operations for the city of Oldsmar. In addition to technical](https://www.wired.com/story/oldsmar-florida-water-utility-hack/)\n[analysis based upon limited details, multiple media outlets responded to the incident with](https://pylos.co/2021/02/09/water-water-everywhere-but-nary-a-hacker-to-blame/)\nimmediate reporting lacking significant additional details. At this time, while the general\nnature of this incident is somewhat known, many questions remain, especially concerning\nwhat entity was responsible for the incident and what their precise intentions were in\nattempting to modify water treatment operations.\n\nWhile further investigation is warranted, available details allow us to reach some preliminary\nconclusions on the incident itself and its likely implications. Furthermore, based on what we\nknow with respect to this event and past Industrial Control System (ICS) intrusions, we can\nformulate an understanding of this incident’s maturity. Finally, the event in Oldsmar provides\nsufficient information to provide defensive guidance to detect, mitigate, or prevent similar\nscenarios in the future.\n\n## Overview of the Oldsmar Incident\n\n\n-----\n\nOn 05 February 2021, operators at the municipal water treatment facility serving the small\ncity of Oldsmar, Florida noticed strange activity on the systems used to monitor and control\n[operations at the plant. Initial reporting from Reuters indicated the facility used TeamViewer](https://twitter.com/Bing_Chris/status/1358899999183163393)\nremote access software for remote monitoring and management, which was subsequently\n[confirmed in follow-on reporting and interviews conducted by Wired. While plant operators](https://www.wired.com/story/oldsmar-florida-water-utility-hack/)\nhave since removed the software, at the time an unknown entity identified the TeamViewer\ninstance and managed to authenticate to the system.\n\nIdentification of critical infrastructure systems exposed to the internet is hardly a new\n[phenomenon. As previously documented by Kim Zetter in several](https://www.wired.com/2012/01/10000-control-systems-online/) [articles from the early](https://www.wired.com/2013/11/internet-exposed/)\n2010s, various tools exist that enable researchers (or less scrupulous entities) to search for\nand identify ICS devices or similar equipment. Prior to the Oldsmar incident, researchers\nidentified several instances of likely malicious entities remotely accessing control system\nequipment in the water sector, with the following standing out as most interesting:\n\n**2013: Intruders, assessed to be linked to Iranian entities, accessed control systems**\nfor the small Bowman Avenue Dam. Although a relatively minor structure and resulting\nin no disruptive consequences, analysts theorize the intruders may have intended to\ntarget the much larger Arthur R. Bowman Dam in Oregon, instead.\n**[2016: In its annual data breach report, Verizon reported several water utilities—](https://www.securityweek.com/attackers-alter-water-treatment-systems-utility-hack-report)**\ncombined into the single, pseudonymous organization “Kemuri Water”— experienced\nbreaches of varying severity. In a few instances, the unknown intruders appear to\nhave manipulated water treatment controls in a haphazard way, causing operational\ndisruption but no harm or destruction.\n**[2018: An unknown entity utilized VPNFilter malware to attempt an unspecified attack](https://blog.talosintelligence.com/2018/05/VPNFilter.html)**\non a chlorine production plant in Ukraine. Although not directly targeting water\ntreatment operations, the incident would have significantly impacted the sector had a\ndisruption occurred at the targeted site.\n**2020: Unknown entities, although tentatively linked to Iranian interests, accessed and**\nperformed minor modifications to multiple water pumping and treatment devices in\n[Israel in April and](https://www.timesofisrael.com/6-facilities-said-hit-in-irans-cyberattack-on-israels-water-system-in-april/) [July 2020. Based on analysis of available information, affected](https://www.timesofisrael.com/cyber-attacks-again-hit-israels-water-system-shutting-agricultural-pumps/)\ndevices were externally accessible with minimal or no authentication preventing the\n[intruder from accessing control systems. While there is some speculation that this](https://twitter.com/AmichaiStein1/status/1359394604039237636)\nevent may be linked to the Oldsmar incident, no evidence exists connecting the two\nand all similarities appear circumstantial.\n\nIn all of the above cases, external access to control systems resulted in either no or very\nlimited disruption to physical operations. While the same is roughly true of the Oldsmar\nincident in terms of ultimate impact, the unknown intruder’s actions in the environment are\nconcerning. Specifically, the entity utilized remote access to ICS equipment to manipulate\nsodium hydroxide levels in the treatment plant. While normal operations run at 100 Parts\nPer Million (PPM) of [sodium hydroxide in the treatment environment, the unknown intruder](https://www.chemicalsafetyfacts.org/sodium-hydroxide/#:~:text=Sodium%20Hydroxide%20in%20Water%20Treatment,sodium%20hypochlorite%2C%20a%20water%20disinfectant.)\nattempted to increase the amount to 11,100 PPM.\n\n\n-----\n\nWhile attempting to make the above alteration, personnel monitoring the equipment, likely a\n[Human Machine Interface (HMI) in the plant environment, noticed the action and reversed](https://csrc.nist.gov/glossary/term/Human_Machine_Interface)\nit. Had the action not been caught in progress during standard working hours, officials\nindicate it would take 24-36 hours for the change to be reflected downstream among the\npopulation served by the district, and that automated testing and similar safeguards would\nhave detected the physical process change.\n\n[Based on all available evidence and statements from local authorities, the intrusion and](https://www.youtube.com/watch?v=MkXDSOgLQ6M&ab_channel=PinellasSheriff)\nmanipulations to the ICS environment were prevented through operator attentiveness and\ninteraction, with further engineering controls providing additional layers of safety. Although\nthe incident resulted in neither significant disruption nor outright damage, the simple fact\nthat some unknown entity attempted the above action is deeply concerning—reflecting\neither callousness given the potential harm, or ignorance as to what the attempted change\nmight have produced in the serviced population.\n\n## Process Visibility and Intruder Maturity\n\n[Although deeply concerning, the intrusion (if not “attack”) scenario described above shows](https://pylos.co/2019/12/07/what-does-attack-mean/)\nmultiple immaturities. Particularly:\n\n1. Events took place during normal operational hours where personnel were on-hand\n\nand available to quickly respond.\n2. The intruder did not attempt to hide or mask their activity through interaction with or\n\noverwrite of HMI systems or spoofing of sensor data.\n3. The modification to sodium hydroxide levels was so extreme as to almost certainly\n\ntrigger engineering or other non-ICS controls or alarms within the environment.\n\nThese three factors, taken together, indicate an attack that was either immature, rushed, or\npotentially unintentional following access to the controlling HMI. To better understand how\n[these items function, especially in light of a potential integrity-targeting ICS incident, a quick](https://www.dragos.com/wp-content/uploads/Past-and-Future-of-Integrity-Based-ICS-Attacks.pdf)\nreview of historical ICS incidents is helpful.\n\n### Stuxnet Incident\n\nAlthough well-documented, especially through resources such as Kim Zetter’s Countdown\nto Zero Day and Symantec’s [Stuxnet Dossier, certain elements of Stuxnet are frequently](https://www.wired.com/images_blogs/threatlevel/2010/11/w32_stuxnet_dossier.pdf)\n[misunderstood or overlooked in general discussion. While reviewed in other sources in](https://www.dragos.com/wp-content/uploads/Past-and-Future-of-Integrity-Based-ICS-Attacks.pdf)\ndepth, the critical item enabling Stuxnet’s success was the malware’s ability to induce a\n[general loss or](https://collaborate.mitre.org/attackics/index.php/Technique/T0829) [denial of view condition in the victim environment. In this specific case, the](https://collaborate.mitre.org/attackics/index.php/Technique/T0815)\nmalware recorded “normal” plant operations then played these recordings back to\nmonitoring systems during physical attack sequences to mask events from plant operators.\nAbsent this critical step, operators would have been able to detect anomalous operations in\nthe plant environment enabling intervention and process diagnosis.\n\n\n-----\n\n### 2015 Ukraine Power Event\n\nIn 2015, entities linked to Russian military intelligence (GRU) penetrated multiple electric\n[distribution centers in Ukraine. In a coordinated operation in late December of that year, the](https://ics.sans.org/media/E-ISAC_SANS_Ukraine_DUC_5.pdf)\nattackers disrupted distribution operations inducing blackout conditions through a\ncombination of rogue control devices and logging on to user workstations to disconnect\nequipment.\n\nYet for such operations to succeed, personnel had to be locked out of their workstations to\nprevent operator intervention during the initial phases of the attack. Subsequent activity in\nthe victim environment resulted in the use of wiper malware to remove remote operational\ncontrol, followed by a malicious firmware update to serial-to-ethernet converters which\nmade communication to equipment impossible. Overall, these steps amount to a\n[coordinated effort to induce a loss or](https://collaborate.mitre.org/attackics/index.php/Technique/T0827) [denial of control condition that enabled a sustained,](https://collaborate.mitre.org/attackics/index.php/Technique/T0813)\nwidespread impact to Ukrainian electric utility operations.\n\n### 2016 Ukraine Industroyer/CRASHOVERRIDE Incident\n\nIn 2016, Ukraine again witnessed an electric power incident in December linked to Russia’s\nintelligence services, this time targeting a single transmission substation. Referred to as the\n[Industroyer or](https://www.welivesecurity.com/wp-content/uploads/2017/06/Win32_Industroyer.pdf) [CRASHOVERRIDE event, the incident again wiped control systems to](https://www.dragos.com/resource/crashoverride-analyzing-the-malware-that-attacks-power-grids/)\ninduce loss of control—but also likely aimed at a loss of view condition as well to enable a\n[potentially destructive (if failed) physical damage scenario. In this particular case, removing](https://www.dragos.com/wp-content/uploads/CRASHOVERRIDE.pdf)\noperator logical control (to force manual operations) combined with loss of logical view into\nthe health and status of the system was used in sequence to enable a process protectionfocused attack scenario. Absent these conditions, it would be highly unlikely for the\nsequence of events required to restore operations in an unprotected, unsafe state (enabling\npossible destruction) would materialize.\n\n### 2017 TRITON/TRISIS Event\n\nIn 2017, a petrochemical plant in Saudi Arabia experienced multiple unexpected plant\nshutdowns due to the plant’s [Safety Instrumented Systems (SIS) tripping for then-unknown](https://realpars.com/safety-instrumented-system/)\n[reasons. Subsequent investigation identified a purpose-built malware variant, referred to as](https://www.youtube.com/watch?v=XwSJ8hloGvY)\n[TRITON or](https://www.fireeye.com/blog/threat-research/2017/12/attackers-deploy-new-ics-attack-framework-triton.html) [TRISIS, as responsible for the disruption. Further investigation and analysis](https://www.dragos.com/wp-content/uploads/TRISIS-01.pdf)\nindicated that rather than a direct attack on plant safety equipment, the malware’s purpose\nwas to enable undetected, arbitrary modification of SIS parameters. Combined with access\nelsewhere in the plant environment, an attacker could remove or alter safety controls to\ninduce physical damage. Yet to succeed, the attacker needed to ensure not only access to\nmodify safety parameters, but also the ability to alter such parameters without operators\nknowing such changes took place.\n\n### Implications for Oldsmar\n\n\n-----\n\nOverall, these four examples of high-profile, technically complex ICS attack scenarios\nemphasize a critical barrier to adversary success: the ability to evade, influence, or outright\ndeny operator visibility into and control over ICS environments. In all four examples, the\nattacks required some mechanism to hide from operators or deny their ability to correct or\nmitigate changes made to operating parameters.\n\nIn the case of the Oldsmar treatment plant incident, the intruder failed to attempt any such\naction based on information currently available. Had the unknown entity spoofed or\notherwise interfered with HMI display parameters or sensor data, the operator on duty\nwould be less likely to notice the incident as it took place, resulting in an attack moving on\nto engineering and process controls for potential mitigation or detection. Not only did the\nintruder fail to limit or manipulate process view in the environment, they executed the event\nduring primary working hours on a weekday, almost ensuring that such activity would be\nquickly noticed (and mitigated).\n\nBased on these observations and in light of past ICS incidents, we can therefore make a\nreasonably confident claim with available evidence that this was not an especially complex\nor savvy “attack”. As described in multiple sources, the intruder appears to have merely\ntaken advantage of weakly secured, accessible remote access mechanisms to connect to\nplant equipment controls, followed by either deliberate or potentially inadvertent\nmanipulation of the environment. That such an attempt occurred at all is certainly\nconcerning, but the overwhelming evidence given event timing and execution indicate that\nthere were only slight possibilities for this event to produce significant damage or harm.\n\n## Defensive Countermeasures and Attack Surface Reduction\n\nWhile this particular incident did not result in any damage or even notable operational\ndisruption, events at the Oldsmar water treatment facility highlight the real risks and\ndangers associated with remote access to critical infrastructure systems. While the kneejerk answer to such issues would be to remove or curtail access to such systems as much\nas possible, this is unrealistic and inactionable in modern operational environments. For\nreasons ranging from centralized control over geographically distant control systems to\nvendor requirements to system access for telemetry and maintenance purposes to the\nlimitations placed on personnel by COVID-19 restrictions, remote accessibility cannot\nsimply be removed or shut off. However, the ways in which such connectivity are\nimplemented can ensure that such operations are done in a securable, defensible fashion.\n\nFirst and foremost, while precise details on the system in question are not available,\navailable evidence indicates that if the HMI controlling sodium hydroxide levels was not\ndirectly accessible via the TeamViewer instance at the facility, then access to such a system\nwas easily gained from that initial access point. While such direct access may be\nconvenient, it is insecure and undesirable. Instead, having a purpose-built bastion or\n“jumphost” can provide a single, hardened point for remote access and monitoring. By using\n\n\n-----\n\ndifferent sets of credentials for the bastion host to internal network and system\nauthentication, security can be increased further as password brute forcing or credential\ncapture for the bastion will not enable immediate follow-on access to other systems in the\nnetwork.\n\nNetwork segmentation, access controls, and sound network engineering can work in\nconcert to reduce the overall attack surface to a limited number of defensible nodes (such\nas the bastion), while also facilitating monitoring of activity to a smaller set of devices.\nWhen applied with even more robust security controls, such as the implementation of robust\n[Multi-Factor Authentication (MFA) schema for remote login activity, exposed attack surface](https://www.nist.gov/itl/applied-cybersecurity/tig/back-basics-multi-factor-authentication)\ncan be reduced even further.\n\nWhile certain controls such as complex passwords or hardware token MFA may be\nundesirable in certain ICS environments due to operational overhead and similar\nconsiderations, applying such defensive measures and similar controls to external facing\nnetwork access points is critical. The profusion of scanning and indexing tools for remotely\naccessible services combined with the ability of adversaries to either brute force or\npotentially capture user credentials mean these accessible systems must be hardened.\n\n## Remote Access Monitoring and Indicator Enrichment\n\nOnce networks are appropriately hardened and segmented, network operators and\ndefenders can then proceed to Network Security Monitoring (NSM) and traffic analysis. In\nwell-designed environments with only a few externally-communicating or -accessible\nbastions, NSM operations are simplified and manageable, allowing for potentially powerful\nsecurity analysis and response.\n\nWith proper monitoring, defenders can begin asking a number of questions or formulating\nhunting hypotheses relative to their network posture. Particularly, operators can utilize near\nreal-time enrichment of network observables such as IP addresses and domain names to\nbuild an intelligence picture of traffic flows and communications.\n\nAt the most basic level, this may constitute little more than geographic enrichment of IP\naddresses to identify odd or anomalous connections. This methodology can certainly\n[produce errors—such as the case of an Illinois water pump station where a worker on](https://www.wired.com/2011/11/water-pump-hack-mystery-solved/)\nvacation remotely accessed a device prompting calls of Russian critical infrastructure\nhacking. Typically, observing remote authentication attempts from non-local address space\nfor a municipal utility network can form a good starting point for follow-on investigation.\n\nIn more advanced use-cases, enrichment of external infrastructure using third-party\nintelligence sources can enable complex, higher-confidence queries for suspicious or\nknown malicious activity. Examples would include being able to correlate source\ninfrastructure for connection attempts to anonymizing infrastructure such as TOR, or\n\n\n-----\n\nidentifying connections from Internet Service Providers (ISPs) or Autonomous System\nNumbers (ASNs) either highly correlated with known-malicious activity, or never previously\nassociated with any known-good, legitimate operation.\n\nAs documented in previous items from DomainTools researchers, identifying indicators in\ngeneral, and [network indicators in particular, as composite objects yields a number of](https://www.domaintools.com/resources/blog/analyzing-network-infrastructure-as-composite-objects)\npossibilities for enrichment and analysis. In this particular case, defenders and network\noperators can leverage enrichment of network data to identify suspicious remote access\nactivity or other signs of initial intrusion, potentially enabling operator response and\nmitigation actions before such intrusions proceed to the manipulation of controls in a critical\ninfrastructure environment. From the opposite view, and as previously documented in the\n[context of the SUNBURST campaign, near real-time enrichment of outbound traffic can](https://www.domaintools.com/resources/blog/change-in-perspective-on-the-utility-of-sunburst-related-network-indicators)\npotentially identify stealthy, otherwise difficult to detect intrusion scenarios by flagging items\nrelated to Command and Control (C2) activity.\n\n## Conclusion\n\nThe Oldsmar water treatment plant intrusion raises many concerns: first, that such an\nintrusion even happened in the first place indicates a certain maliciousness or lack of\ncaution by the entity in question; second, while this specific instance appears relatively\nsimplistic and immature, the same initial access vectors used in this event could be\nleveraged by more operationally savvy entities to produce a disruptive or dangerous impact.\nYet while the incident is concerning, network operators and defenders have many options\navailable to fight back against such events. Through a combination of network hardening,\nattack surface reduction, network segmentation, and NSM with indicator enrichment,\ndefenders can dramatically reduce the likelihood of such events, significantly reduce their\nefficacy, or increase the likelihood of identifying such activity at relatively early stages.\n\nOf course, for many smaller organizations, such as municipal water treatment entities,\nsome of the security suggestions offered above may remain out of reach for budgetary or\ntechnical reasons. While a “100% solution” may not be feasible for such entities, certain\npreliminary steps such as attack surface analysis and reduction remain within reach.\nIrrespective of maturity and capability, given that various entities are actively probing and\nattempting to interact with connected critical infrastructure systems, all organizations\nresponsible for operating such equipment must take all available steps within reason to\nsecure these networks as best as possible.\n\nOverall, and as documented by various entities, malicious activity against critical\ninfrastructure networks in general and ICS networks in particular appear to be increasing.\nThrough a combination of proactive defensive hardening and enhanced visibility or network\nmonitoring, asset owners, operators, and defenders can better position themselves against\n\n\n-----\n\nsuch intrusions. Failure to apply these lessons now mean potential adversaries at varying\nlevels of complexity and capability will continue to find vital networks unprepared for future\nintrusion scenarios.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-11 - Visibility, Monitoring, and Critical Infrastructure Security.pdf"
    ],
    "report_names": [
        "2021-02-11 - Visibility, Monitoring, and Critical Infrastructure Security.pdf"
    ],
    "threat_actors": [
        {
            "id": "d4ac28d1-66eb-4f2d-9f9b-a72394349fd0",
            "created_at": "2023-01-06T13:46:38.667954Z",
            "updated_at": "2025-03-27T02:00:02.887442Z",
            "deleted_at": null,
            "main_name": "APT4",
            "aliases": [
                "PLA Navy",
                "MAVERICK PANDA",
                "BRONZE EDISON",
                "SODIUM",
                "Salmon Typhoon"
            ],
            "source_name": "MISPGALAXY:APT4",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6fbff48b-7a3e-4e54-ac22-b10f11e32337",
            "created_at": "2022-10-25T16:07:23.318008Z",
            "updated_at": "2025-03-27T02:02:09.734465Z",
            "deleted_at": null,
            "main_name": "APT 4",
            "aliases": [
                "APT 4",
                "Bronze Edison",
                "Maverick Panda",
                "Salmon Typhoo",
                "Sodium",
                "Sykipot",
                "TG-0623",
                "Wisp Team"
            ],
            "source_name": "ETDA:APT 4",
            "tools": [
                "Getkys",
                "Sykipot",
                "Wkysol",
                "XMRig"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535544,
    "ts_updated_at": 1743041801,
    "ts_creation_date": 1653766818,
    "ts_modification_date": 1653766818,
    "files": {
        "pdf": "https://archive.orkl.eu/e1fe9b4b7d41cc9da7d10674c05c1f536f4c5a51.pdf",
        "text": "https://archive.orkl.eu/e1fe9b4b7d41cc9da7d10674c05c1f536f4c5a51.txt",
        "img": "https://archive.orkl.eu/e1fe9b4b7d41cc9da7d10674c05c1f536f4c5a51.jpg"
    }
}