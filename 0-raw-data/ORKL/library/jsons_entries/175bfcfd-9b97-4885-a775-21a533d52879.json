{
    "id": "175bfcfd-9b97-4885-a775-21a533d52879",
    "created_at": "2023-01-12T15:01:39.010589Z",
    "updated_at": "2025-03-27T02:14:34.95516Z",
    "deleted_at": null,
    "sha1_hash": "519ffdd9e2f2029f9ee063b2ca95a22529be77e4",
    "title": "2020-09-20 - Rampant Kitten – An Iranian Espionage Campaign",
    "authors": "",
    "file_creation_date": "2022-05-28T18:09:39Z",
    "file_modification_date": "2022-05-28T18:09:39Z",
    "file_size": 3633932,
    "plain_text": "# Rampant Kitten – An Iranian Espionage Campaign\n\n**[research.checkpoint.com/2020/rampant-kitten-an-iranian-espionage-campaign/](https://research.checkpoint.com/2020/rampant-kitten-an-iranian-espionage-campaign/)**\n\nSeptember 18, 2020\n\nSeptember 18, 2020\n\n## Introduction\n\nCheck Point Research unraveled an ongoing surveillance operation by Iranian entities that\nhas been targeting Iranian expats and dissidents for years. While some individual sightings\nof this attack were previously reported by other researchers and journalists, our investigation\nallowed us to connect the different campaigns and attribute them to the same attackers.\n\n**Among the different attack vectors we found were:**\n\nFour variants of Windows infostealers intended to steal the victim’s personal\ndocuments as well as access to their Telegram Desktop and KeePass account\ninformation\nAndroid backdoor that extracts two-factor authentication codes from SMS messages,\nrecords the phone’s voice surroundings and more\nTelegram phishing pages, distributed using fake Telegram service accounts\n\n**The above tools and methods appear to be mainly used against Iranian minorities,**\n**anti-regime organizations and resistance movements such as:**\n\n\n-----\n\nAssociation of Families of Camp Ashraf and Liberty Residents (AFALR)\nAzerbaijan National Resistance Organization\nBalochistan people\n\n## Table of Contents\n\nTechnical Appendix\n\n## Initial Infection\n\nWe first encountered a document with the name `ﺷﻮرﺷﯽ_ﺎیﮐﺎﻧﻮ_ﮔﺴﱰش_از_رژﱘ_وﺣﺸﺖ.docx,`\nwhich roughly translates to `The Regime Fears the Spread of the Revolutionary`\n```\nCannons.docx . The title of the document was in fact referring to the ongoing struggle\n\n```\nbetween the Iranian regime and the Revolutionary Cannons, a Mujahedin-e Khalq\nmovement.\n\nMujahedin-e Khalq, or The People’s Mujahedin of Iran, is an anti-regime organization whose\naim is to free Iran from its current leadership. In 1986, Mujahedin-e Khalq (MEK) started\nbuilding their new headquarters, which later became known as Camp Ashraf, near the Iraqi\ntown of Khalis. However, years of political tension in Iraq eventually led to the transfer of the\ncamp’s residents to a new, remote, and unlikely destination: Albania.\n\nThe above document leverages the external template technique, allowing it to load a\ndocument template from a remote server, which in this case was `afalr-`\n```\nsharepoint[.]com .\n\n```\nFigure 1: Remote template\n\nCurious by this website, we set out to discover more about it. At first, we found a handful of\ntweets from accounts opposing the Iranian regime mentioning a very similar SharePoint site,\nwhich the website in the document was likely impersonating:\n\n\n-----\n\nFigure 2: Tweets mentioning similar website\n\nFigure 3: AFALR’s official website\n\n## Infection Chain\n\nAfter the victim opens the document and the remote template is downloaded, the malicious\nmacro code in the template executes a batch script which tries to download and execute the\nnext stage payload from `afalr-sharepoint[.]com :`\n\n\n-----\n\nFigure 4: Infection chain\n\nThe payload then checks if Telegram is installed on the infected machine, and if so it\nproceeds to extract three additional executables from its resources:\n\n**BOBC3953C59DA7870 – Loader, executed by** `RunDLL, injects the main payload into`\n```\n   explorer.exe\n\n```\n**CO9D5A739B85C37C1 – Infostealer payload**\n**Updater.exe – Modified Telegram updater**\n\n## Payload Analysis\n\nThe main features of the malware include:\n\n**Information Stealer**\n\nUploads relevant Telegram files from victim’s computer. These files allow the\nattackers to make full usage of the victim’s Telegram account\nSteals information from KeePass application\nUploads any file it could find which ends with pre-defined extensions\nLogs clipboard data and takes desktop screenshots\n\n**Module Downloader**\n\nDownloads and installs several additional modules.\n\n**Unique Persistence**\n\nImplements a persistence mechanism based on Telegram’s internal update\nprocedure\n\n\n-----\n\n### Telegram structure basics\n\nFirst, let us review how Telegram Desktop organizes its files. The following is an ordinary\nTelegram file structure which can normally be found at %APPDATA%\\Roaming\\Telegram\n```\nDesktop .\n\n```\nFigure 5: Telegram Desktop directory structure\n\nAs explained above, several files are dropped to the Telegram working directory during the\ninfection chain. The dropped files are in a directory named `03A4B68E98C17164s, which`\nlooks like a file at first glance because of a custom `Desktop.ini file, but it is actually a`\ndirectory.\n\nFigure 6: Infected Telegram Desktop directory\n\n### Configuration\n\nOne of payload’s resources contains encoded configuration data.\n\nThe encoding scheme uses the regular Base64 algorithm but with a custom index table:\n```\neBaEFGHOQRS789TUYZdCfPbDIJ+/KLMNwxyzquv0op123VWXghijmnkl45rst6Ac .\n\n```\nDecoding that resource gives us the following configuration:\n\n\n-----\n\n**Key** **Value**\n\n\n**AES**\n**encryption**\n**key**\n\n\n\n[[email protected]@5!!](https://research.checkpoint.com/cdn-cgi/l/email-protection)\n\n\n**File suffixes** .txt;.csv;.kdbx;.xls;.xlsx;.ppt;.pptx;\n\n\n**SOAP**\n**username**\n\n**SOAP**\n**password**\n\n\n9BEF4B32-0D40-4A92-9E35-6094B8AA8B58\n\nD5F69342-A3CC-438F-B3B6-5E7BF6B6E327\n\n\n**Main C&C** hxxps://www.afalr-sharepoint[.]com/B6D9E741-DFE3-4470-9174C95FB2B958AD/TelBService.asmx\n\n**Backup C&C** hxxps://www.afalr-onedrive[.]com/B6D9E741-DFE3-4470-9174C95FB2B958AD/TelBService.asmx\n\n### C&C Communication\n\nThe malware uses SOAP for its communication purposes. SOAP is a simple XML-based\ndata structure for web-service communication. The API in SOAP web-services is public and\ncan be observed by accessing the website from a browser:\n\n\n-----\n\nFigure 7: SOAP API in C&C website\n\nThe messages (commands) can be divided into the following categories:\n\n**Authentication:**\n```\n      HelloWorld – Authentication message\n\n```\n**Module Downloader:**\n```\n      DownloadFileSize – Checks whether a module should be downloaded\n      DownloadFile – Downloads a module from the remote server\n\n```\n**Data Exfiltration:**\n```\n      UploadFileExist – Checks whether a specific victim file has been uploaded\n      UploadFile – Uploads a specific victim file\n\n```\n**Authentication**\n\nThe first message for a valid communication tunnel should be `HelloWorld, which`\nimplements a simple Username/Password authentication. The credentials are hard-coded in\nthe sample, and the SOAP response for that message contains a session ID which must be\nused for the remainder of the session.\n\n**Module Downloader**\n\nThe program tries fetching updates for its current modules and also download several\nadditional modules.\n\nSome of the additional missing modules that could not be fetched:\n```\n   D07C9D5A79B85C331.dll\n   EO333A57C7C97CDF1\n   EO3A7C3397CDF57C1\n\n```\n**Data Exfiltration**\n\nThe core functionality of the malware is to steal as much information as it can from the target\ndevice. The payload targets two main applications: Telegram Desktop and KeePass, the\nfamous password manager.\n\nOnce the relevant Telegram Desktop and KeePass files have been uploaded, the malware\nenumerates any relevant file it can find on the victim’s computer which has one of the\nfollowing extensions: `.txt;.csv;.kdbx;.xls;.xlsx;.ppt;.pptx; . For each such file,`\nthe malware then uploads it after encoding the file to base64.\n\n### Persistence\n\nThe malware uses a unique persistence method which is tied to the Telegram update\n**procedure.**\n\n\n-----\n\nPeriodically, it copies the Telegram main executable into `Telegram Desktop\\tupdates,`\nwhich triggers an update procedure for the Telegram application once it starts. The hidden\ntrick of the malware’s persistence method is changing the default Telegram updater file –\n```\nTelegram Desktop\\Updater.exe, with one of its dropped payloads (more specifically –\nCO79B3A985C5C7D30 ). The most notable changed feature of that updater is running the\n\n```\npayload again:\n\nFigure 8: Telegram updater runs the main payload\n\n## Infrastructure and Connections\n\nAfter analyzing the payload we were able to find multiple variants that date back to 2014,\nindicating that this attack has been in the making for years.\n\nMalware variants developed by the same attackers often have minor differences between\nthem, especially if they are used around the same time frame. In this case however, we\nnoticed that while some of the variants were used simultaneously, they were written in\ndifferent programming languages, utilized multiple communication protocols and were not\nalways stealing the same kind of information.\n\nIn the table below, we list the variants we identified and highlight their unique characteristics.\nPlease refer to the Technical Appendix below, for a deep dive information regarding each\nvariant.\n\n\n**Name** **Artifacts** **Dates** **Malicious**\n**Activity**\n\n\n**TelB**\n**Variant**\n\n\nKeePassOnlineCreator.exe\nBOBC3953C59DA7870\nCO9D5A739B85C37C1\nCO79B3A985C5C7D30\nD07C9D5A79B85C331.dll\nEO333A57C7C97CDF1\nEO3A7C3397CDF57C1\n\n\nJune\n2020 –\nJuly 2020\n\n\nTelegramfocused\ninfostealer\n\n\n**Properties**\n\nSOAP.\nDelphi 64bit\npayload.\nPersistence\nthrough\nTelegram\nupdater.\n\n\n-----\n\n**TelAndExt**\n**Variant**\n\n**Python**\n**Info**\n**Stealer**\n\n**HookInjEx**\n\n**Variant**\n\n\nTelegramUpdater.exe\nTelegramUpdater2.exe\nTelegramUpdater3.exe\nTelegramUpdater.dll Updater.exe\n\nkeyboard-EN.exe\n\nspeaker-audio.exe\n\naudio-driver.exe\n\nDrvUpdt.exe / ehtmlh.exe\nDrvUpdtd.dll / dhtmlh.dll\nCapDev.exe / rregg.exe\nuflScan.exe\n\n\nMay 2019\n–\nFebruary\n2020\n\nFebruary\n2018 –\nJanuary\n2020\n\nDecember\n2014 –\nMay 2020\n\n\nTelegramfocused\ninfostealer\n\nFocused on\n– Telegram,\nChrome,\nFirefox,\nEdge,\nPaltalk NG\nData\nExfiltration\nvia FTP\n\nInfostealer\n(Browsers,\naudio,\nkeylogging\nand\nclipboard)\n\n\nFTP .\nDelphi 32bit\npayload.\nPersistence\nthrough\nTelegram\nupdater.\n\nFTP.\nPython\n(Pyinstaller)\n\nFTP. C++\n\n\nThe related samples also revealed more C&C servers, and looking up their passive DNS\ninformation and additional metadata led us to similar domains that were operated by the\nsame attackers. As it turns out, some of the domains appeared in malicious Android\napplications and phishing pages, exposing more layers of this operation:\n\nFigure 9: Maltego graph of the malicious infrastructure\n\n\n-----\n\n## Android Backdoor\n\nDuring our investigation we also uncovered a malicious Android application tied to the same\nthreat actors. The application masquerades as a service to help Persian speakers in Sweden\nget their driver’s license.\n\nWe have located two different variants of the same application, one which appears to be\ncompiled for testing purposes, and the other is the release version, to be deployed on a\ntarget’s device.\n\nFigure 10: Android application’s main interface\n\nThis Android backdoor contains the following features:\n\nSteal existing SMS messages\nForward two-factor authentication SMS messages to a phone number provided by the\nattacker-controlled C&C server\nRetrieve personal information like contacts and accounts details\nInitiate a voice recording of the phone’s surroundings\n\n\n-----\n\nPerform Google account phishing\nRetrieve device information such as installed applications and running processes\n\nFor a deep dive information regarding this application, please refer to the Technical Appendix\nbelow.\n\n## Telegram Phishing\n\nThe backdoors were not the only way in which the attackers tried to steal information about\nTelegram accounts. Some of the websites that were related to this malicious activity also\nhosted phishing pages impersonating Telegram:\n\nFigure 11: Telegram phishing page\n\n\n-----\n\nWhat was surprising is that several Iranian Telegram channels have actually sent out\nwarnings against those phishing websites, and claimed that the Iranian regime is behind\nthem.\n\nFigure 12: Translated message warning against phishing attempts\n\nAccording to the channels, the phishing messages were sent by a Telegram bot. The\nmessages warned their recipient that they were making an improper use of Telegram’s\nservices, and that their account will be blocked if they do not enter the phishing link.\n\nFigure 13: Phishing message content\n\n\n-----\n\nAnother Telegram channel provided screenshots of the phishing attempt showing that the\nattackers set up an account impersonating the official Telegram one. At first, the attackers\nsent a message about the features in a new Telegram update to appear legitimate. The\nphishing message was sent only five days later, and pointed to\n```\nhttps://telegramreport[.]me/active (same domain as in figure 11 above).\n\n```\nFigure 14: Phishing message sent from fake Telegram account\n\n## Payload Delivery\n\nAlthough in some cases we were unable to determine how the malicious files reached the\nvictims, we gathered some potential clues about the ways the attackers distributed their\nmalware. For example, accessing `mailgoogle[.]info shows that it impersonates`\n```\nozvdarozv[.]com and promotes a software to increase the number of members in\n\n```\nTelegram channels.\n\n\n-----\n\nFigure 15: `mailgoogle[.]info download page`\n\nBut after clicking on “Download”, a password-protected archive called `Ozvdarozv-`\n```\nWindows.rar is downloaded, containing one of the malware variants.\n\n### Possible Additional Delivery Vectors\n\n```\nA removed blog entry from 2018 accused a cyber-security expert of plagiarism when he was\ninterviewed by AlArabiya news channel to discuss Iranian cyber-attacks.\n\nWe believe this page was created as part of a targeted attack against this person or his\nassociates.\n\nThe blog included a link to download a password-protected archive containing evidence of\nthe plagiarism from `endupload[.]com .`\n```\nendupload[.]com is connected to both the PC and the Android operations mentioned\n\n```\nabove via several passive DNS hops, including a direct connection via historic DNS server\ninformation to the domain `mailgoogle[.]info we described above. Not only did we not`\nfind any instance of it being used in a legitimate context, we also found evidence of the\ndomain being registered by a Persian speaking hacker. (See “attribution” section below)\n\n\n-----\n\nFigure 16: Removed blog post with link to `endupload[.]com`\n\nA different blog entry from 2012 discusses a human rights violations report by HRANA, a\nnews agency affiliated with the Iranian Association of Human Rights Activists. Once again,\nthis blog refers to a document that can be downloaded from `endupload[.]com :`\n\n\n-----\n\nFigure 17: Blog post with link to endupload[.]com\n\nUnfortunately, we were unable to get our hands on the files both blog entries were referring\nto, and could not confirm that they were indeed malicious. However, it appears that\n```\nendupload[.]com has been controlled by the attackers for years, as some of the malicious\n\n```\nsamples related to this attack and dating back to 2014 communicated with this website.\n\n## Attribution\n\nAlthough we found many files and websites that were used over the years in this attack, they\nwere not attributed to a specific threat group or entity. Nevertheless, some of the fingerprints\nthat the threat actors left in the malicious artifacts allowed us to gain a better understanding\nof where the attack might be coming from.\n\n### Attack Origin\n\nTo begin with, the WHOIS information of some of the malicious websites revealed that they\nwere supposedly registered by Iranian individuals:\n\n\n-----\n\nFigure 18: WHOIS information of `endupload[.]com and` `picfile[.]net`\n\nThe WHOIS records for `endupload[.]com also mentioned an e-mail address,`\n```\n[email protected][.]com . Apparently, the website’s registrant was very active online,\n\n```\nbecause looking up the username “nobody.gu3st” led us to many posts in Iranian hacking\nforums:\n\nFigure 19: Translated post by nobody.gu3st\n\n### Political Targeting\n\nThe list of targets we observed reflects some of the internal struggles in Iran and the motives\nbehind this attack. The handpicked targets included supporters of Mujahedin-e Khalq and the\nAzerbaijan National Resistance Organization, two prominent resistance movements that\nadvocate the liberation of Iranian people and minorities within Iran.\n\n\n-----\n\nFigure 20: Mujahedin-e Khalq and Azerbaijan National Resistance Organization logos\n\nThe conflict of ideologies between those movements and the Iranian authorities makes them\na natural target for such an attack, as they align with the political targeting of the regime.\n\nIn addition, the backdoor’s functionality and the emphasis on stealing sensitive documents\nand accessing KeePass and Telegram accounts shows that the attackers were interested in\ncollecting intelligence about those victims, and learning more about their activities.\n\n## Conclusion\n\nFollowing the tracks of this attack revealed a large-scale operation that has largely managed\nto remain under the radar for at least six years. According to the evidence we gathered, the\nthreat actors, who appear to be operating from Iran, take advantage of multiple attack\nvectors to spy on their victims, attacking victims’ personal computers and mobile devices.\n\n[Since most of the targets we identified are Iranians, it appears that similarly to other attacks](https://research.checkpoint.com/2018/domestic-kitten-an-iranian-surveillance-operation/)\nattributed to the Islamic Republic, this might be yet another case in which Iranian threat\nactors are collecting intelligence on potential opponents to the regiment.\n\n[SandBlast Mobile provides real-time threat intelligence and visibility into mobile threats,](https://www.checkpoint.com/products/mobile-security/)\nprotecting from malware, phishing, Man-in-the-Middle attacks, OS exploits, and more.\n\nCheck Point’s [anti-phishing solutions include products that address all of the attack vectors](https://www.checkpoint.com/solutions/anti-phishing/)\nfrom which phishing attacks come – email, mobile, endpoint and network.\n\n## Technical Appendix\n\n### PC Backdoor Variants Analysis\n\n\n-----\n\n**TelB Variant**\n\n“TelB” is the latest variant we encountered, and its analysis shown above. We named it as\nsuch because of the next debug string:\n```\nD:\\Aslan\\Delphi\\TelB\\BMainWork\\SynCryptoEN.pas .\n\n```\n**TelAndExt Variant**\n\nThis variant is probably the older version of “TelB”, and has been active mostly during 2019\nand 2020. It shares the following properties and techniques with the newer versions:\n\nDeveloped in Delphi\nShares a great amount of code with the “TelB” variant\nFocuses on the Telegram Desktop application\nSimilar persistence and update methods\nUses FTP instead of SOAP for data exfiltration\n\nWe named this variant “TelAndExt” because of the next debug string:\n\n```\nD:\\Aslan\\Delphi\\TelAndExt\\TelegramUpdater\\SynCryptoEN.pas\n\n```\n\n**Python Info-stealer Variant Analysis**\n\nWe discovered several samples which use the following methods:\n\nTwo-layer SFX (self-extracted archive) which extract several .bat/.vbs/.nfs/.conf files.\nPersistence method by copying the executable (ends with `.nfs ) to`\n```\n   %appdata%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\audio   driver.exe\n\n```\nExecutable name is `speaker-audio.exe or` `keyboard-EN.exe, depending on the`\nsample.\nThe executable was created with Pyinstaller.\nDownloads a second-stage payload under the name of `net-update.exe`\nBefore being uploaded, the data is encrypted using library `pyAesCrypt with a hard-`\ncoded password.\n\n**Info stealing**\n\nAccording to our analysis, the script communicates with an FTP server using hard-coded\ncredentials, and steals the following data:\n\nTelegram Desktop application related files.\nPaltalk NG application related files.\nChrome, Firefox and Edge related data.\nAny file which ends with extensions listed in a given configuration. If no configuration is\ngiven, it searches for files with the following extensions:\n\n```\n.txt;.docx;.doc;.exe;.jpg;.html;.zip;.pdf\n\n```\n\n-----\n\n**Operation**\n\nDuring our investigation, we saw several Python info-stealers that communicate with the\nsame FTP server, but store the stolen information in different pages under different aliases.\n\nWe suspect this is how the malware authors operate:\n\nChoose a target, and create a designated folder in the FTP server for them.\nBuild a sample customized for the target, with a unique AES key and FTP credentials\nfor information uploading.\nDeliver the weaponized executable via one of the infection chain vectors.\n\n**Second-stage Payload – HookInjEx**\n\nOne of its core functionalities is fetching a second-stage payload. If the designated FTP\nfolder contains a file named `net-update.exe, then it downloads and executes it.`\n\nWe analyzed few of those `net-update.exe samples and found a complete overlap with`\nthe “HookInjEx” variant below, making it a targeted advanced payload.\n\n**HookInjEx Variant**\n\nThis variant has been in use since 2014, and has 32-bit and 64-bit versions. Over time, the\nvariant evolved and added some features while also changed the names of the different\ncomponents in its infection chain.\n\n**Infection Chain**\n\nWe found two main types of infection chains:\n\n1. SFX (self-extracting archive) which contains all the components. It drops all of them\n\ninto a folder and then executes the main loader – `DrvUpdt.exe ( ehtmlh.exe in`\nolder versions).\n2. Fake SCR file that is functioning as an executable. In order to look like a legitimate\n\nSCR file, the loader contains a decoy – a JPEG/PPTX/DOC file as a resource\n( Resource_1 ), which is loaded upon running.\n\nThe SCR file also drops other payloads as its resources, and runs the main loader with the\ncommand line:\n```\ncmd.exe /C choice /C Y /N /D Y /T 3 &\n\"%APPDATA%\\\\Microsoft\\\\Windows\\\\Device\\\\DrvUpdt.exe\" -pSDF32fsj8979_)$\n\n```\n\n-----\n\nFigure 21: Malicious SCR opens decoy JPG resource\n\n**Hooking and Injection**\n\nThe main loader uses the hooking and injection method called “HookInjEx”. That method\nmaps a DLL into `explorer.exe, where it subclasses the` `Start button. In our case, the`\nloaded DLL is `DrvUpdtd.dll ( dhtmlh.dll in older versions).`\n\nIn newer versions, the malware also hooks the `Start button in other languages as well.`\nThe existence of different languages probably shows that it has victims from countries all\naround the world. The different translations are:\n\n\n-----\n\n```\nStart English\nbaşlat - Turkish\n\n```\n開始 - Chinese\n```\nSākt - Latvian\nاﺑﺪأ - Arabic\nIniciar - Spanish\nKäynnistä - Finish\nהתחל - Hebrew\n\n```\nスタート - Japanese\n```\nŠtart - Slovakian\nPradėti - Lithuanian\nPokreni - Bosnian\n\n```\nเริ่ม - Thai\n```\nΈναρξη - Greece\nDémarrer - French\nСтарт - Bulgarian\nЗапустити - Ukrainian\n\n```\n시작 - Korean\n\n**Configuration**\n\nThe malware receives its configuration from a file named `Devinf.asd (in older versions it`\nwas named `file2.asd ). The configuration is decrypted and written into a new file named`\n```\nDrvcnf.asd (in older version it named file3.asd ). The encryption method is:\n\n```\n\n-----\n\n```\ndef decode(content):\n  dec_array = [0, 1, 2, 3, 4, 5, 6, 7, 8, 0xe, 0xf, 0x10, 0x11, 0x12, 0x13, 0x14,\n0x15, 0x16, 0x17, 0x18, 0x19, 0x1a,0x1b, 0x1c, 0x1d, 0x1e, 0x21, 0x22, 0x23, 0x24,\n0x25, 0x26, 0x27, 0x28, 0x29, 0x2a, 0x2b, 0x2c, 0x2d, 0x2e, 0x2f, 0x30, 0x31, 0x32,\n0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39,0x3a, 0x3b, 0x3c, 0x3d, 0x3e, 0x3f, 0x40,\n0x41, 0x42, 0x43, 0x44]\n  output_str = ''\n  known_values = [9, 10, 13, 32]\n  for j in range(len(content)):\n    int_cur_content = ord(content[j])\n    cur_byte = 0\n    for i in range(62):\n      if int_cur_content == dec_array[i]:\n        if i < 26:\n          cur_byte = i + 0x61\n        elif 26 <= i < 52:\n          cur_byte = i + 0x27\n        elif 52 <= i < 62:\n          cur_byte = i - 0x4\n        output_str += (chr(cur_byte))\n        break\n    if cur_byte == 0:\n      if int_cur_content in known_values:\n        cur_byte = int_cur_content\n      elif int_cur_content - 0x61 <= 0xe:\n        cur_byte = int_cur_content - 0x40\n      elif int_cur_content - 0x70 <= 0x6:\n        cur_byte = int_cur_content - 0x36\n      elif int_cur_content - 0x77 <= 0x5:\n        cur_byte = int_cur_content - 0x1c\n      elif int_cur_content - 0x53 <= 0x3:\n        cur_byte = int_cur_content + 0x28\n      output_str += (chr(cur_byte))\n  return output_str\n\n```\nAfter the configuration is decrypted, the malware parses the values and puts them in global\nvariables.\n\n\n-----\n\n```\n<Reg></Reg> Registry key for persistence\n<Pre></Pre> - pre value for info files to send\n<Pas></Pas> - extensions for info files to send\n<Path_Log></Path_Log> - log path direcory\n<L_s></L_s> - minimum size for file to send\n<S_n></S_n> - FTP domain\n<F_k></F_k> - FTP User value\n<F_R></F_R> - FTP Password value\n<Ver></Ver> - version\n<U_u2></U_u2> - Downloads updates URL\n<U_u1></U_u1> - Downloads updates URL\n<F_f></F_f> - Directory in ftp connection.\n<U_t></U_t> - timer_1\n<S_t></S_t> - timer_2\n<S_q></S_q> - timer_3\n<U_u3></U_u3> - Downloads updates URL\n<El></El> - value for encryption method to files\n<Ez></Ez> - value for encryption method to files\n<F_n></F_n> - Fake name\n<E_dt></E_dt>\n<E_dy></E_dy>\n<Snd_P></Snd_P> - Value to choose name template for info files to send.\n<Mlt></Mlt> - flag for exeucting again from different place.\n<Ws1></Ws1> - WHOIS first URL\n<Ws2></Ws2> - WHOIS second URL\n<Ws3></Ws3> - WHOIS third URL\n<S_li></S_li>\n<RTL></RTL>\n<SHttpR></SHttpR> - value to download using computer-name and username\n<OPP></OPP> - Opera gather data flag\n<FIP></FIP> - Firefox gather data flag\n<CHP></CHP> - Chrome gather data flag\n<WHP></WHP> - WHOIS flag\n<TRP></TRP> - tracert flag\n<FRC></FRC> - number of tries\n<Clipfp></Clipfp> - clipboard data flag of CF_HDROP (CLB-f.jpg)\n<Cliptp></Cliptp> - clipboard data flag of text, unicode, oemtext and locale (clbt.jpg)\n<Clipip></Clipip> - clipboard data flag of bitmap and dib (clb-p.jpg)\n\n```\n**Persistence**\n\nThe malware sets the registry key which is in the `<Reg> value of the configuration file`\n(which is almost always the key RunOnce) to the following values – it sets the name to\n```\nSunJavaHtml or DevNicJava and the value is DrvUpdt.exe 11 . That way the malware\n\n```\nknows it was already executed.\n\nIn older versions, the malware used to drop a file named either `rreegg.exe or`\n```\nCapdev.exe, which was added to RunOnce, and in turn executed DrvUpdt.exe 11\n\n```\n**Info stealing**\n\n\n-----\n\nMain feature of the malware is stealing information from the victim s computer and send it to\nthe C2 using FTP.\n\nThe malware steals different types of data:\n\nOpera/Chrome/Firefox login data.\nFirefox information: profiles, keys and db files.\nThe output of `tracert www.google.com`\nWHOIS information (based on the `<Ws1> value).`\nScreenshots and title of the foreground window.\nWaveform-audio recording for a minute.\nFiles from removable drivers. The types of files are based on the `<cpy> tags in the`\nfile `Devufl1.tmp ( winufl1.tmp in older versions). In some versions, that logic was`\nimplemented in a file named `uflscan.exe .`\nInterestingly, if driver’s name is one of the following: `A65RT52WE3F,` `09353536557 or`\n```\n   transcend20276, the malware ends the thread. We believe it to be a debug code\n\n```\n(Fig. X) that stayed and its purpose is to prevent the malware from gathering files from\nthe author’s computers.\nFiles from other drives based on the `<cpy> tags in the file` `Devufl2.tmp`\n( winufl2.tmp in older versions ).\nKeylogging and clipboard data from various formats – drag and drop/ `CF_HDROP,`\n```\n   CF_TEXT,  CF_TEXT, CF_UNICODETEXT, virtual key codes, CF_OEMTEXT,\n   CF_LOCALE, CF_BITMAP and CF_DIB .\n\n```\nCapture using webcam ( tcwin.exe in older versions).\nSince 2018 – Telegram Desktop data.\n\nFigure 22: Debug code with hardcoded removable drivers\n\n**C2 communication**\n\n\n-----\n\nThis variant uploads files to its C2 domain using the FTP protocol. The FTP domain is placed\nin the configuration file inside the `<S_n> tag.`\n\nThe connection starts with authentication using the password and username from the\nconfiguration file.\n\nThe malware then creates a directory according to the `<F_f> tag and a subdirectory inside`\nit with the user id it generated before. The user id is generated from the network adapter’s\ninfo that was written into the file `Mcdata.dat ( PAdata.dat In older versions).`\n\nAfter that, the connection continues with `TYPE I and` `PASV commands before storing the`\nfiles with the `STOR command.`\n\nThe variant also contacts other domains to update its different components. The domains are\nplaced in the configuration file inside `<U_U1>,` `<U_U2> and` `<U_U3> tags. The files are`\ndownloaded using `URLDownloadToFileW from the given URLs, the` `user_id is included in`\nthe URLs.\n\n**String Obfuscation**\n\nIn newer versions (since 2018), the strings are encrypted with the following script:\n```\nbuf_1 = 'qweyuip[];lkjhgdszcm,.><MNBVCXZ|ASDFGHJK:}{POIUYTREWQ123456789-=+_)\n(*&^%$#@!'\nbuf_2 = '!#$%&()*+,-.123456789:;\n<=>@ABCDEFGHIJKMNOPQRSTUVWXYZ[]^_cdeghijklmpqsuwyz{|}'\ninput_str = \"\" # The encrypted string\noutput_str = ''\nfor i in range(len(input_str)):\n   cur_byte = input_str[i]\n   place = buf_2.find(cur_byte)\n   if place == -1:\n      output_str += cur_byte\n      continue\n   new_byte = buf_1[place]\n   output_str += new_byte\nprint(output_str)\n\n### Android Backdoor Analysis\n\n```\nThe first activity is `MainActivity, which is responsible for presenting the user with the`\ndecoy content and requesting permissions to perform privileged activity. It also starts a\nbackground service called `MainService, and launches the second` `MainActivityFake`\n( GmailActivity ) when the server sends a command to do so.\n\n\n-----\n\nFigure 23: User is requested to allow a set of permissions\n\n**Data Collection**\n\nOnce the `GmailActivity launches the` `MainService, it in turn is responsible for the`\nfollowing tasks: Timer registration, configuration monitoring, showing fake notification\n(described below) and sensitive data collection.\n\nDuring this initial data collection process, the following information is read and prepared:\n\nInstalled applications list\nAccounts information\nSMS messages\nContacts information\n\n\n-----\n\nThe rest of the information is collected on demand, once a command is received from a C&C\nserver:\n\nVoice recording – A 30 seconds recording by default.\nGoogle credentials – The server triggers an authentication phishing attempt.\n\n**Google Credentials Theft**\n\nUpon receiving the proper command from the C&C server, a Google login page will be\ndisplayed to the victim, by activating the `MainActivityFake ( GmailActivity ).`\n\nFigure 24: Google login page\n\nAt this point the user is presented with a legitimate `accounts.google.com login page,`\ninside Android’s WebView. In order to steal the typed-in credentials, Android’s\nJavascriptInterface is used, alongside a timer which periodically retrieves the information\nfrom the username and password input fields.\n\nFigure 25: Periodic retrieval of Google account credentials\n\n\n-----\n\n**Google protect is enabled**\n\nAs we previously mentioned, one of its core functionalities is to turn on the microphone and\nrecord the surroundings. In order to achieve this goal in a real-time manner, the application\nneeds to have its service running in the background.\n\nAny Android application that wants to perform such action, is required to post an ongoing\nnotification to the user, which will alert the user of the uninitiated activity on the device. In\norder to circumvent this issue, the malware developers chose to display the user with a fake\nnotification of “Google protect is enabled“.\n\nFigure 26: Applications displays a fake notification\n\nThe result is an always-on decoy notification masquerading as “Google protect”.\n\nFigure 27: Fake Google Protect notification\n\n**C&C Communication**\n\nThe malware uses regular HTTP to communicate with the C&C servers. It sends the initial\nrequest to `alarabiye[.]net, and proceeds to communicate with`\n```\ngradleservice[.]info in order to get configuration, commands and status updates.\n\n```\n\n-----\n\nIn order to upload all the sensitive information, the malware uses FTPS with hard-coded\ncredentials.\n\nFigure 28: FTPS connection routine\n\nIn addition, the sensitive files are encrypted using the AES algorithm, with a pre-configured\npassphrase before being uploaded to the FTP server,\n\nFigure 29: AES encryption routine\n\n**Two Factor Exfiltration by SMS**\n\n\n-----\n\nOne of the unique functionalities in this malicious application is forwarding any SMS starting\nwith the prefix `G- (The prefix of Google two-factor authentication codes), to a phone`\nnumber that it receives from the C&C server.\n\nFurthermore, all incoming SMS messages from Telegram, and other social network apps, are\nalso automatically sent to the attackers phone number.\n\n**Work in Progress**\n\nDuring our analysis, it was often obvious that this malicious application was still being\nactively developed, with various assets and functions which were either leftovers of previous\noperations, or not yet utilized.\n\nOne of the unused phishing assets even contains a pre-entered username, possibly a target\nin a previous operation conducted by the attackers.\n\nFigure 30: Unused phishing HTML assets\n\n\n-----\n\nFigure 31: Unused location tracking code\n\n## Indicators of Compromise\n\n### Phishing\n```\n telegramreport[\n .]me\n telegramco[.]or\n g\n telegrambots[.]\n me\n mailgoogle.info\n\n Android\n\n```\nC&C servers\n\n\n-----\n\n```\n gradleservice[.\n ]info\n alarabiye[.]net\n\n```\nFiles\n\n**MD5**\n\n4ae3654b7ed172b0273e7c7448b0c23c\n\nca154dfd01b578b84c0ec59af059fb62\n\n**SHA-1**\n\nf3a4feedd4f62702c65b037a91bd8332d9518c08\n\n735f761462443deff23dde5b76746b7ab0ceaf71\n\n**SHA-256**\n\n24e5b2967437dbc1866df3ac1bf776a4960a5a56676b48bb9a143e62849a43d2\n\n881ab44385541ac7cd0f3279ba4fb8519df07d529456c9e34074787ebb33f658\n\nPC variants\n\n**TelB Variant**\n\nC&C servers\n```\n afalr sharepoint[.]com\n\n```\n\n-----\n\n```\n afalr onedrive[.]com\n\n```\nBackdoor\n\n**MD5**\n\n315e6338bf9c9bcbe3d5af0482f51dfd\n\n**SHA-1**\n\n8b00d62a5c03efa76dfca8bd8c95c969167f83ee\n\n**SHA-256**\n\na713a2749e9791243a89471a2603bf1f32ec11c9179771ca46fb5583b8412cb0\n\nArtifacts\n\n**MD5**\n\necb8c2cc5efe580d4ea8f212e39eb9b5\n\nc9a28ae2b52d13cc98cdaeaff6d72332\n\n77d9ebb41bf12a96284747cbeeeed889\n\na7675a6eee18746705c90a9290168b60\n\n01e4c30e374bd26a2e5e5cb8ef27b255\n\n5844fe7ffb3333c23d201d70c7419a6d\n\n\n-----\n\n1bd82146445e2dcb3cafacefe2e913ed\n\n975b81ecf54f67e8d091be053ae7fa99\n\n**SHA-1**\n\ne642c9898b8d18238ca525e74db22e6dfe431e2f\n\nee96340d3b0845fcaad0ee328c49095302cee6e9\n\n817835661f1e3be4ff13ed1762054475cc8e1223\n\nA6e1f60d5e3651d1e029293fba7da72749282ca1\n\nA778f565bbf851efe50a46476fe0e9f8b0e1c830\n\n5d09311a4b0c18572dede3bbf5620268baf39318\n\n0dc484e36b62cf4f2512e1b634dbfe60260c8447\n\na3b8eb53d595e3a272942e98eac24f3c38cfb2e4\n\n**SHA-256**\n\nb743c9b4968b65577d60d0f3a3c4ae6dd6beedf08a02625836d598f8600a1321\n\n409da7a4f191e37d3d3aa8f36e8c3789fc998b63241a5f05c6816e54ed7dcd3a\n\n41629c54b2f3dd68897c04a8ed10f7c78534ba67a048da75885a857f68b37624\n\nF9f4aaba897b15f8c77c46f2efb0672b044b7cb79dfd84eac4a41e2f1cee1344\n\nFdfcf1790faf4dc97ea7c5d84c76b7abbdb080ab931777a6259b09ae0166fcae\n\n\n-----\n\n233ee2ea02322d3da68217ab4b51722a4a3aa833667a45377dfd4742d5979c4c\n\n512e28afe8d32008cd8a9e95c938d2551689098ea93f75ba2a23c246248d7124\n\n4c0c33fff8d4929f7a0d742f1d251b61794b185538b8ceb4939283d1b3d73795\n\n**TelAndExt Variant**\n\nC&C servers\n```\n exemplifiable taps.000webhostapp[.]com\n telegramup[.]com\n 148.251.97[.]102\n\n```\nBackdoors\n\n**MD5**\n\n281908f5afa399f725a06df767486837\n\n5b813b679779a60947d4ed6e671394b0\n\nA763350f2a5b2fdde3216cd1ea2bec5d\n\n2e4e20bb01c9ca4ef5df2a75473c1aee\n\n0aa07a6bf12a2a87a66202e768146e49\n\n5666585faaf4fe77c8354ff76881f29b\n\n**SHA-1**\n\n\n-----\n\n67a328fc2362253fd7cc9163d7da6d8688d76d1f\n\nE541372d93e4e26fe75fb44eb8aa009e1fc48b38\n\n3275c02dbcb2b3467b55bb6927e2d80aeab43357\n\n107b5afd843a53715ca89dc9b180a0f761a87f90\n\nab6ccfe1c9a27c1225dbe94a85246656837ce38\n\nb7397af85faee45c3d9e0f2e7c0e1b248f064317\n\n**SHA-256**\n\ncec533ecd881f014efa7416867d6e3c6b4362741e97c1609860c6223935dec8d\n\n21118e91cc1537c849a382d87cb113568c5e6d6ce204e8f4592c26f74f713f79\n\nb65676321e2138affd5c38a1f2b882f19ac1ca9bf414b6f3d44e35c43c36ae78\n\n65a3dec040bddf615bd2ce8c9f08ff074442fb521ac97b869e51d35a417719e9\n\n2d161588e7314ed268144b14bf00ff02b4b875f140d5ff8ba51ed50318e4b603\n\ndc627b6419366cdf50eccfa3d1995c111b71112e5abb725b6096b9e0026af395\n\nArtifacts\n\n**MD5**\n\na330253626349a1f0a6f16255f05b5f7\n\na871124091acc7c865f34e9d4cc6b6ad\n\n72eb19c60056174b7d5722cabed90ef8\n\n\n-----\n\n99dab6b39475e1088a4dd33d4cad9896\n\nf6a1a831d77cc6f2a2c636f7c17fd499\n\nad33e3d934fef9ed58b1f1c8b0fa0091\n\n**SHA-1**\n\na208ecaa6ef313abedb3d07d168655af0de0287f\n\n1c1d7bc97c49b046c5040c9a74aa803111b8b487\n\n6a37014e9ff0df749f58c74f787608d66b039a43\n\nb1755edc051acc27c04ae9f05a07db47cb816f57\n\n86d5a8450b80627ddc900bc13d970a9917cf1586\n\n5a60267edb2021e30cbf3540226562701232e512\n\n**SHA-256**\n\ne9bf479de992e8a7cfff4d5d528ec85614e9ad0892feb5f588047dd78decf069\n\n4ea4671ef8678197dbc82a584832d0dd23d67b0427873ac610bb266d0678f305\n\nbaad0de1026a3a807c4e4170b9291548afa900614a1dfdc00cf4f63d1946d555\n\n1ffd162d377b84ddb91766f43c0a7a0ba92f358fa2146a33726ed1e08529a691\n\n509ab695001be527b6c32f2d200067f2d433169e86724336579e08ea44799dd6\n\nbaf779a4a3c9d901eff32a46a004bbb258551cac57d63f0a878d882d2ebbdcf3\n\n**Python Variant**\n\n\n-----\n\nC&C servers\n```\n tbackup.000webhostapp[\n .]com\n vareangold[.]de\n telegrambackups[.]com\n telegramdesktop[.]com\n picfile[.]net\n\n```\nBackdoors\n\n**MD5**\n\naac5bc1f94f32a69d7dcea33f305e6fc\n\n9238f7a1ec7cbeb3dbb9370f02fde040\n\n30973d4a637354cad945ab94205b0323\n\n**SHA-1**\n\n16335373c2b9438002fbe3a648a0709d8c111a6b\n\na9480fa19e90e46f9fd4a3c96e5ad08c11ef3822\n\n94f9ee0dbd13014b19f42c2fa125f3f9e73b98a3\n\n**SHA-256**\n\n\n-----\n\n3310c0b2fd8a8d96288eb241f6948cfa0f15b39d2e6ca6687aab45dc6fccf9fc\n\n13e924700a346234eaf2376c61ef0a36c86d94847b232a4ad772e35e0b9a6e87\n\nd52a5ece34828b4201df630a7bc07449289f0c15833ee13f93f105c510a8282e\n\nArtifacts\n\n**MD5**\n\n67f523757199203a5e4eae3e17ab00a4\n\n2f1120f5089af58315891fd316333161\n\nb9a888a23af000c6d1c846b9d0fd853c\n\nc7041a9de03af5c2c85ec70c3e8daefb\n\nfb063ebd13296eef1fd556ebb4d843a3\n\nb44428524ea196992358148ee3eeddb0\n\nb99abe396772819815eac7728580f41e\n\n5fcefebf48018774f278f5fa83c664b3\n\ncc95e164fc390fa3b75a2c49518edbb7\n\n854418d163b0e1269970338916ff6374\n\nca1e45cd176751931c87edbf25aa4469\n\n**SHA-1**\n\n4807035760bd758cfe05adf81da2618914928a62\n\n\n-----\n\nba4b04a8b20cff6ba27ccf7e79f4bcc8134e1c2c\n\n6537f6ea9f0a3edb5469c7235d70571e5a46c3e1\n\n1e6a569979dd3cac95d9d1c481ebf9bb1e0b1f12\n\nff4af69cdc3c24a7f10efa23c9b1431751c1f0f0\n\n767c02bbaf80745dfb0a6438c21927beb2123962\n\nb14804d46febfe811cf5634c8059666bf5c6fc55\n\n9ae405cbb9c6e959e4f680e2a73952e89c81ab4a\n\nb110923d4ec5cf737bfff3904b1527b041ecfe58\n\n295f01317d14e1548ecdfad1342cfae844f5dd8d\n\n5b15fb002162591bab0067a5c15c7e5c1726dc24\n\n**SHA-256**\n\nc004fa7111c5ea0d902a7f9863b525fb26a3be086926f39246f0dbcb7804f2b5\n\n30c71764ff80f82a190fc7d2212f0b7eebde4de46327f34e3326acbfd87f268d\n\n0da88a1645f39b41e8cdfe14eaee40b8845bf92b446ddc646fddc85389b78495\n\n4ffbf798a68aa5bcc5a52efd64456483172be892125085d2c82e2f351a48342a\n\nd8395183c234836b9138d0ade196b8ab60aae6add8c84e004df049a27afe5ffa\n\nfe15c79508885b5288c5cf93708d5b40eab05877cb9b1d954ab7e814a20c7978\n\nee295bd3669ddaebcd9be020debd1853c6eb7029c8017734e44c8cdce5e15241\n\n\n-----\n\n815a89091ed15779071bbd6d7ad207a0041a199a562f105595278258880f1e03\n\n3010d9eddb0b97b7f61025d05b543f572c7900170240b56bd9568efb79799f11\n\nb5e571eb492eaee853abdf8b6202f7e543f09d8343a85f467cd4806f8e19a14f\n\ne444a49b260e815c7d2f3e309f7c7b62226d4f0658fc756ec0aed5effb5226a8\n\n**HookInjEx Variant**\n\nC&C servers\n```\n tbackup.000webhostapp[\n .]com\n developerchrome[.]com\n firefox-addons[.]com\n picfile[.]net\n cpuconfig[.]com\n update-help[.]com\n winchecking[.]com\n endupload[.]com\n 176.31.4[.]14\n\n```\n\n-----\n\n```\n 148.251.224[.]29\n 144.76.177[.]244\n 137.74.153[.]98\n\n```\nBackdoor\n\n**MD5**\n\nca554a866389796b65f0b5eb1576e691\n\n3bcddbfd757de15ec350f1b4c9e92926\n\n74c3049ae9229675ccce544f0491e2f9\n\na05b6a10d7643a2ef059d7e296cb87a6\n\nc887fc425351a824a143a015d51ad0a7\n\n1d6a516c77aaf1bbab1ac4051f86475c\n\nf9b9b9e2c87f9f4b5fbb89e5a1ac05eb\n\n48873bf5f51ed996b237ce3495bf6219\n\nf4e7111f9a5cd4451d422bc009844ec5\n\n**SHA-1**\n\n7ba64923c79cb2742393ff1ad9cb9fd3f6660024\n\nb136739bf5c161684433a94a80ccaa9db029bac8\n\n\n-----\n\n142f7bd57d3623fd44f5d7406bc9dc8b0fba0bd8\n\n8a7f8d1dcbb9c5d4766f49e41ad17c00776bdb50\n\n4e4a8dce1192769ac447ffc41a39df543420e1dd\n\n96af18c2f4afbcde3854a53c1a3bbb964296b241\n\n31922929229c7b49c626ecdaf2e3927683fbe0cc\n\neea85b2b8fbb5724f58424c1878ac10fd343a155\n\nabb636cbab0bc591ba94203f41635fff009304b6\n\n**SHA-256**\n\n55c5a17976d253c7c4df1b59973c610336c5482d2063d511d54d512fe04ca\n\na4fcc308e9a364d29057cc76dbe6a8c32ce24a1dbae5c0b6306471f61cbefb29\n\n79baf679e84b02a660e03602ff7aa4c9c86a92e0885b1a298c672db842be258d\n\n58018aac8beb89271ef88d0fd4ada64079e1af09fad441e7b39a2463f95602f4\n\n3cedd91bb4c7a5874a3ad286addb0860c33931ceb09d2c18385b7d6cab6953e0\n\na60f5b41251d0bf126fc3c2b836de7d59aa608fd6d37726d71960dd408575512\n\n5a8f53f7c65af0cb3f269f8653405cd7bd98fae5c256e6264e5ebc5f75ea6c08\n\n08b61faed24b35224a505dd9cbf39cd59776627de7991161d376134a854c3227\n\n3ff1864e5fe1ebcce0a60c9594c9ac9f2eedd94367680dc3d77ca39a0b0e3d06\n\nArtifacts\n\n\n-----\n\n**MD5**\n\ncf4ed89d96dab84a455a4f52400388cd\n\n16706dff8db6fcc1fbd6f80cfb2baeb1\n\nd26a8b8d1c6f77dd9ecc02e0edeecbaa\n\n092b436347f80cffd74f4caffa75f4d5\n\n663f9b47a983c2ebe9f70df74956dcc9\n\n3ef7daf8cbce7a9aa68ee5c0baef8b28\n\nf78855f488ce965a6a4c60820df2e696\n\n62d8c20b64281b0d934358bf8d0fd2cf\n\n80c9fc38e7f6d96a09feaa99b7777e7d\n\n6f5a36fb82de3aecd847978846be312e\n\n1ac4f4f7c5217adb16d83f902e51624a\n\n661dee790ea438b14553e622052909a5\n\na68fcf5b97265d97c6bc5613ae82c093\n\ndd07291265098edef72d39b11c8a1e37\n\n87866ae8936ec3fc04af3e0783ec36bf\n\ndb4c95ea37fed6403546eadd9e691a1e\n\nccb6f24ff38770ab2efeb8f51de2a123\n\n\n-----\n\ne7c0e92855a1b7d9b81eeb06cce5ce60\n\n326843b42fca324e9fd023058a6c6b7a\n\n68b84d8057f6e6def9e191ed218da0ee\n\n87878f5404083c4c0ebf7a78e386a487\n\nf1598a2901388dc5244931226d300633\n\n2d64174dc0bed8222eea4494a49744a5\n\n20691b32c1839cb1e106f937dd101e4d\n\n86320eb8adb48106b899e21be5d5387d\n\ne20f58c1afb7d9262e5a15620b172bd4\n\ncb93aad2354aea2623a70abdd9ecc87b\n\n91be9e93c7602202963650103ff8ee50\n\ne130f1305948f0f7bd25f9d7101bd98a\n\n2c8a7d32667b7b7c410f3b3347087996\n\nf55277807457e2a3e9ad4b6de64b549f\n\n64bd09506365a0cf351a56edb2bb2bdc\n\n5c4b2cf2bed7db57b7335ec426fe776b\n\n470175c447f025f4057b4dbacb931e42\n\nf499cabf7c2ddacad965ed2a086b481b\n\n\n-----\n\n83cba14904fdbf0e21d251fc5ab00666\n\na314ff2714660be06f9eb49e6024c8c5\n\nbb186b0f3f2a1e0ef51d86d3494fd3be\n\n2e8e25f179172778f8efefac33f2dcb7\n\nb547b27751022900d9126a82d82a411f\n\na0c46b3f8370f2a2a6486d0ac686363c\n\n**SHA-1**\n\n7bbfb347a762da6be65484a2d721669269099af1\n\na9de74562a373fae1e02b6f290c3c4189f9f52c5\n\n4e4570200d81ab296f29dcbc56c8371484114077\n\n2c55956f5422a5fd08e11042d49e6fa478b9cc2e\n\n9d694ca2a311eafc409f128e1044162ddea5687c\n\ncb765cc4028a1c2e6930aca826567bc8253d8479\n\n4511d3627b2432e18c02271ac9ef67a373d2dc4a\n\na1c8b69ca2f6f8763e65bdb148c9f9422130fced\n\n7fae11c9f144912eef2557b21f44b112857f2bee\n\na0bffcd0d9ab5651476375b1e0edef18b81c2d90\n\nddb494f286c36c4216b3e325b8e8e4e61f1c7906\n\n\n-----\n\n8963a67f5001a3ee5459a8ebe1e8fa3059df786b\n\nc66b1ac78b55661cfbf14c330c2b9615d6c15125\n\nf42195c131e1bab859aa61f52edf37c587288eaf\n\n2747b43c07845feb832115f992c3ff08f2ac220b\n\n93b3a4d118131981fff5f65da2f8642947f2e43a\n\n87376e4522a673d5326a456dc6cc11e5c8349dbf\n\n1af2cb91b45f684d5fd30187643d9d2d51474be7\n\n8c59a117faed95777e15fefe0a2ed34d492e3205\n\nad0a4e312d21e513a3fec0bc7bf27afdde4bcde6\n\n694ddbd3d19ac153f29d52f350faccb257fec841\n\n31c85366409d5b5ae5f87da2b60f8f116b4bec99\n\nc8d2b9ff069c7e3977e988cebba273bd320abfcc\n\n2c13c0ef28485320634c235a097d62017bed36d6\n\na8548208fd950a8215e8ae0fac0d00db2592ccf0\n\n6e97334921c15cc27ccfb1e147a74d69f873ff64\n\n2d69897eccff1efe908c69c2d0af81f9fc7a57aa\n\ndbd60bf24dc0099a4b45b2610be91b5cd75be31a\n\nf5b3dc229f00e4c726a9e6e990ad4983ede0f073\n\n\n-----\n\ncc8f8ae46807c1b6b56a1877628d2140f0158b85\n\n3da61604ca8c6da190906ff122d56e1cb9836f4c\n\nb8738bbe9c35181ea4261b81b6c9fc58d8bb593d\n\ncbdf5c9ada304b73cebda7753bd14bcb5cedab2e\n\ndb88c16dc592d5b11445fa0f437016651706bfaf\n\n02fe03f6f2914551e7096b7938ff1b6d7dce17e1\n\nbbb38fa43bbb8c984cb70b155c230539f6ff6e51\n\n749a8aaf2f9f96a914e3dfff76ff9c9fa43c5bf2\n\n311a4fdb018baf924ff1301dd489b822b40f6c51\n\n22a3855c9c9c05e1789d45d40ba325d9406a1f3b\n\ne036dbf4b0e6b36526f8b4f180ac624cfdc8f756\n\nd7d58a818649eae5116ab26351993436fc1255ee\n\n**SHA-256**\n\n4415e6240b037f4ac693c7e4a88f5ab2567b68dddbaa8fbfb0b40d37748fa8ba\n\n2c4156bb1d1e3f0abafd5d03fad277f6aab705cb917bc07e05de3170fd80854f\n\n69cbda8c2ea92eace49d678cc660432d0ad0c44bd79c3a02dd841066f80bc51b\n\n525e99feb0a32a96aaf6e34be899e6a68c7abb6a8542f30e3822d07fe4e8d278\n\n54a20f35d302499c925e5855f782bacb6bdd0a345f57c9e80772ef29fb81f465\n\n\n-----\n\n083fe2c0feca89a6011ea2749123e216e0a53b573ebef2f25d856412cee7f99c\n\n51a9a7e764a509b979dd438719840369718a320acbba32abbf51d4926e7d3486\n\nb7730f9a05be8a0f25a3979b2f8d2fed791340a32385a9fd37d0e8b81119627d\n\n63a655fde88ea26c73cea1e1764305e44203db771f64155b3b3e3d805203f65a\n\n5eb4c94c9927e90426b6227754ae97fca06d468d5512d15773c48817ea082dbf\n\ndff78dc100c1efd116de1a1d9e0b9169380801a1e7e864d63dc81a263f8929e8\n\n845a0e5720a6288794a6452adb8d3e7c22f5e6e6b9d4f7481fbd30e3efba4f28\n\nb778ab921e7268334efdc8aa371909c4bbd0f1621e39ab9d7e37167fe448581e\n\n0e4a8eb2fe861c45071626da24147e922b167efb543e37ace7466c74c1e98be6\n\n0f7082926241659fbebd229cdc41abe358be49110a80729b9ee891f2f7dcdf16\n\n71085b661fea6cf040586b462b07ce8e0471fb9208c4f69cfd168e168beab6fe\n\n37f40214d2f150597c52cb868c1e2f723d9c2d3155ab18ab2f1279eaf09bdf71\n\nf211a92c2e215c2691006407bc919a892dd998120d83d333f2295059cd3c1c60\n\n1b8cd7c93dce63878dadae0cf77482ae367477841a4604c6a842158466790737\n\nd148562a49a09333b2b02d13e12b183d4c3fcf23fbb024d4e0b440631a3a3663\n\ne4e210aedf8120a4c765bd340bd78b4a84f7ee486314132a8364fd417f4fa128\n\n41d3378e99a410756170056e4941e86325826c45389ae18172114be535a73355\n\ne7782cedc67fe36d2fb9005c5bb165c75db9587f3de57b408acb20f6757c7f56\n\n\n-----\n\n09f953c4abfa799e2137887db5e90ddb993f76d20ce22a5ca290e43ae07074b7\n\n023151cf0fb47d758946fa85a952a2b6758fbbfb762083a01bb70c5a6d96c781\n\n2e656ea0b05ffa6cd945848176d1c9fb6174a6253b2a42891487d120358f0bec\n\n07247bb81cca445e0df110d73ea6bf7eb327cc99b614b99dfbcb5632025c99a0\n\n085a42cf3705bade9cd970f003f82158563aba06e9152e00928778bc0bd9585e\n\nb26b024fa7be56d2b2e3815d8e97434f95b30bf25cda4259d3e20c14a92bd8ec\n\nd3bb736d8a8b500c75ad853392afac37fd8cd519b274db4cba9451d2f1899059\n\n986a9bd00d5b22431ab949916828aa25542afae4875b5cee00f703424b5ffb34\n\nde339d3fe5acf83a0df5991bcce02574e1f2c4749b6d0e8f9edc563ef4f91d79\n\n0af51a0ffb5798fb90a14070809fa9909195068ad1b91c1cadf5633b521e5132\n\n75972d15f3b2e97d52b9f8a6f42ea85976ed5bb9d609c3bf93ee98d6f4f4a648\n\n35e3f08ae93a7b4cd3e77a6438e318cd3c3b41efa5def52e5ebd182347e94fd9\n\naf31cc534aa49f02e6c18a8cf3fd4c9cf366d462ee7caaf8c2a461405382073f\n\n013edd19a9e796d54b82dc34a400a0981c5e17fd65a235dd45231e7ef06ee53b\n\ne8f785efb62fbdf31a12012d38798301329e5262090991152e94342ef6dfa276\n\ne7eeb7781f521ddc5481626a2410ed8cc871809c36d8d8f74af9dd3f8c42505d\n\n9c75a6957a0294d929787b6e8217e4127b77cc2702c19ddb8e0b6319dc3b5127\n\nbfb2a7f8e7396f8edee131eca9715ab8b2fc957478b7cf0d58840a707b718e09\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-20 - Rampant Kitten – An Iranian Espionage Campaign.pdf"
    ],
    "report_names": [
        "2020-09-20 - Rampant Kitten – An Iranian Espionage Campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "30f6ddb3-f5aa-4b78-a1a5-e37c42b2c560",
            "created_at": "2022-10-25T16:07:23.544297Z",
            "updated_at": "2025-03-27T02:02:09.855532Z",
            "deleted_at": null,
            "main_name": "Domestic Kitten",
            "aliases": [
                "APT-C-50",
                "Bouncing Golf"
            ],
            "source_name": "ETDA:Domestic Kitten",
            "tools": [
                "FurBall",
                "GolfSpy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "44d5df14-6a25-41d6-a54c-7c7ebac358cf",
            "created_at": "2023-01-06T13:46:38.817312Z",
            "updated_at": "2025-03-27T02:00:02.926727Z",
            "deleted_at": null,
            "main_name": "Domestic Kitten",
            "aliases": [
                "Bouncing Golf",
                "APT-C-50"
            ],
            "source_name": "MISPGALAXY:Domestic Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e580dec5-1558-4c79-8eda-c968d1cd206f",
            "created_at": "2022-10-25T16:07:24.090829Z",
            "updated_at": "2025-03-27T02:02:10.104759Z",
            "deleted_at": null,
            "main_name": "Rampant Kitten",
            "aliases": [],
            "source_name": "ETDA:Rampant Kitten",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535699,
    "ts_updated_at": 1743041674,
    "ts_creation_date": 1653761379,
    "ts_modification_date": 1653761379,
    "files": {
        "pdf": "https://archive.orkl.eu/519ffdd9e2f2029f9ee063b2ca95a22529be77e4.pdf",
        "text": "https://archive.orkl.eu/519ffdd9e2f2029f9ee063b2ca95a22529be77e4.txt",
        "img": "https://archive.orkl.eu/519ffdd9e2f2029f9ee063b2ca95a22529be77e4.jpg"
    }
}