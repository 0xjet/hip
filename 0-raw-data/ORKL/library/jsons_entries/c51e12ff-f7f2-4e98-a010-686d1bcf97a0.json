{
    "id": "c51e12ff-f7f2-4e98-a010-686d1bcf97a0",
    "created_at": "2023-01-12T15:00:27.95766Z",
    "updated_at": "2025-03-27T02:06:02.439797Z",
    "deleted_at": null,
    "sha1_hash": "02f55fdfcd7fbb8e05c91f1e8a246a79d4b5665b",
    "title": "2017-09-20 - Progress on CCleaner Investigation",
    "authors": "",
    "file_creation_date": "2022-05-28T19:52:30Z",
    "file_modification_date": "2022-05-28T19:52:30Z",
    "file_size": 141010,
    "plain_text": "# Progress on CCleaner Investigation\n\n**blog.avast.com/progress-on-ccleaner-investigation**\n\n[Vince Steckler & Ondrej Vlcek 21 Sep 2017](https://blog.avast.com/author/vince-steckler-ondrej-vlcek)\n\nLarge technology and telecommunications companies were targeted\n\nFollowing the take-down of the CnC server and getting access to its data, the Avast Security\nThreat Labs team has been working around the clock to investigate the source and other\ndetails of the recent Piriform CCleaner attack. To recap, the attack affected a total of 2.27M\ncomputers between August 15, 2017 and September 15, 2017 and used the popular PC\ncleaning software CCleaner version 5.33.6162 as a distribution vehicle. Today, we would like\nto report on the progress so far.\n\nFirst of all, analysis of the data from the CnC server has proven that this was an APT\n(Advanced Persistent Threat) programmed to deliver the 2nd stage payload to select users.\nSpecifically, the server logs indicated 20 machines in a total of 8 organizations to which the\n2nd stage payload was sent, but given that the logs were only collected for little over three\ndays, the actual number of computers that received the 2nd stage payload was likely at least\nin the order of hundreds. This is a change from our previous statement, in which we said that\nto the best of our knowledge, the 2nd stage payload never delivered.\n\n\n-----\n\nAt the time the server was taken down, the attack was targeting select large technology and\ntelecommunication companies in Japan, Taiwan, UK, Germany and the US. Given that\nCCleaner is a consumer-oriented product, this was a typical watering hole attack where the\nvast majority of users were uninteresting for the attacker, but select ones were. For privacy\nreasons, we’re not disclosing the list of targeted companies publicly; instead, we have been\nreaching out individually to those companies who we know have been impacted, and\nproviding them with additional technical information to assist them.\n\nThe 2nd stage payload is a relatively complex piece of code that uses two components\n(DLLs). The first component contains the main business logic. As with the first payload, it is\nheavily obfuscated and uses a number of anti-debugging and anti-emulation tricks. Much of\nthe logic is related to the finding of, and connecting to, yet another CnC server, whose\naddress can be determined using three different mechanisms: 1) an account on GitHub, 2)\nan account on Wordpress, and 3) a DNS record of a domain get.adxxxxxx.net (name\nmodified here). Subsequently, the address of the CnC server can also be arbitrarily modified\nin the future by sending a special command, recognized by the code as a signal to use the\nDNS protocol (udp/53) to get the address of the new server. Together with law enforcement,\nwe’re continuing the analysis by getting access to the data from these additional CnC\nservers and tracing further to the attacker.\n\nThe second part of the payload is responsible for persistence. Here, a different mechanism is\nused on Windows 7+ than on Windows XP. On Windows 7+, the binary is dumped to a file\ncalled “C:\\Windows\\system32\\lTSMSISrv.dll” and automatic loading of the library is ensured\nby autorunning the NT service “SessionEnv” (the RDP service). On XP, the binary is saved\nas \"C:\\Windows\\system32\\spool\\prtprocs\\w32x86\\localspl.dll” and the code uses the\n“Spooler” service to load.\n\nStructurally, the DLLs are quite interesting because they piggyback on other vendors’ code\nby injecting the malicious functionality into legitimate DLLs. The 32-bit code is activated\nthrough a patched version of VirtCDRDrv32.dll (part of Corel’s WinZip package), while the\n64-bit uses EFACli64.dll – part of a Symantec product. Most of the malicious code is\ndelivered from registry (the binary code is saved directly in registry in keys\n“HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion\\WbemPerf\\00[1-4]”). Again, all of these techniques demonstrate the\nattacker’s high level of sophistication.\n\nIn parallel to the technical analysis, we have continued working with law enforcement units to\ntrace back the source of the attack. We are committed to getting to the bottom of who is\nbehind this attack. While providing routine periodic updates, our energies are focused on\ncatching the perpetrators. Our approach is to do all of this in the background, to increase our\nchances of identifying the perpetrator. We believe nothing is served by being too noisy, e.g.\nstating who was targeted and/or compromised and it is up to the target to choose when to\ndisclose.\n\n\n-----\n\nFinally, it is extremely important to us to resolve the issue on customer machines. For\nconsumers, we stand by the recommendation to upgrade CCleaner to the latest version (now\n5.35, after we have revoked the signing certificate used to sign the impacted version 5.33)\nand use a quality antivirus product, such as Avast Antivirus. For corporate users, the\ndecision may be different and will likely depend on corporate IT policies. At this stage, we\ncannot state that the corporate machines could not be compromised, even though the attack\nwas highly targeted.\n\nWe will provide additional updates as we progress.\n\nVince Steckler, CEO\nOndrej Vlcek, CTO and EVP Consumer Business\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-09-20 - Progress on CCleaner Investigation.pdf"
    ],
    "report_names": [
        "2017-09-20 - Progress on CCleaner Investigation.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535627,
    "ts_updated_at": 1743041162,
    "ts_creation_date": 1653767550,
    "ts_modification_date": 1653767550,
    "files": {
        "pdf": "https://archive.orkl.eu/02f55fdfcd7fbb8e05c91f1e8a246a79d4b5665b.pdf",
        "text": "https://archive.orkl.eu/02f55fdfcd7fbb8e05c91f1e8a246a79d4b5665b.txt",
        "img": "https://archive.orkl.eu/02f55fdfcd7fbb8e05c91f1e8a246a79d4b5665b.jpg"
    }
}