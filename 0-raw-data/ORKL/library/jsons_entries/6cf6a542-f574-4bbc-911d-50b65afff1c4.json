{
    "id": "6cf6a542-f574-4bbc-911d-50b65afff1c4",
    "created_at": "2023-01-12T15:06:20.907105Z",
    "updated_at": "2025-03-27T02:16:25.590082Z",
    "deleted_at": null,
    "sha1_hash": "2cbaf2eb395dc79cca9deecb3924da758c82a365",
    "title": "2021-11-23 - Android APT spyware, targeting Middle East victims, enhances evasiveness",
    "authors": "",
    "file_creation_date": "2022-05-28T04:02:32Z",
    "file_modification_date": "2022-05-28T04:02:32Z",
    "file_size": 2350788,
    "plain_text": "# Android APT spyware, targeting Middle East victims, enhances evasiveness\n\n**[news.sophos.com/en-us/2021/11/23/android-apt-spyware-targeting-middle-east-victims-improves-its-capabilities/](https://news.sophos.com/en-us/2021/11/23/android-apt-spyware-targeting-middle-east-victims-improves-its-capabilities/)**\n\nPankaj Kohli November 23, 2021\n\nNewly-discovered variants of an Android spyware that previously was attributed to an\nadvanced persistent threat actor group called C-23 (also known as GnatSpy, FrozenCell, or\nVAMP) have incorporated new features into their malicious apps that make them more\nresilient to actions by users, who might try to remove them manually, and to security and web\nhosting companies that attempt to block access to, or shut down, their command-and-control\nserver domains.\n\nThe C-23 threat actor has, in the past, targeted individuals based in the Middle East,\nparticularly in the Palestinian Territories. The group has been active since at least 2017.\n\n\n-----\n\nThe spyware app initially\n\ndisguises itself as something called “App Updates”\nThe new variants appear in the form of an app that purports to install updates on the target’s\nphone, with names that include App Updates, System Apps Updates, or Android Update\n**Intelligence. Sophos suspects that the apps are delivered to specific users by means of**\nSMS text messages linking to downloads. To the best of our knowledge, none of the apps\nhave been hosted on Google Play Store, though Sophos did reach out to the Android\nsecurity team and sent details about the apps to the company.\n\nOnce installed, the spyware sends unique, identifiable device parameters to its commandand-control server. One of the newer features of this variant is that it will, initially, use a\nhardcoded C2 address to communicate, but also contains code that allows the operators of\nthe spyware to push down a new address. This ability can keep the malware functional if one\nor more of the C2 server domains is taken down. The new variants did not conceal or\nobfuscate the C2 server address in any way.\n\n\n-----\n\nCode that\n\ncan modify the C2 domain on a running installation is a notable new feature\nMany of the new variants were found to have been digitally signed by a certificate (with serial\nnumber ece521e38c5e9cbea53503eaef1a6ddd204583fa) that Sophos has associated with\nmalware for years.\n\n## Changing disguises after installation\n\nThe first time the user opens the app, it requests that the user grant the app specific\npermissions to do the kinds of things you’d expect spyware to do: It requests permissions to\nrecord ambient audio, and to access all files stored on the device.\n\nBut\n\nthe apps also use a bit of social engineering to ask the user to grant advanced permissions:\nnotification access, device administrator, and the ability to observe the user’s actions while\ninteracting with apps.\n\nThe app’s requests appear to justify the need for the additional features, but they’re lies. For\ninstance, the request to “Enable Notifications” claims that the app needs this functionality or\nelse “you won’t receive notifications in real time.”\n\n\n-----\n\nBut that isn’t what Notification Access\n\npermissions do. When prompted to enable this feature, the app pushes the user to a system\npermissions window that accurately describes what the permission does. The threat actors\nmay assume that the target won’t carefully read, or understand, the consequences of clicking\nAllow on this screen.\n\n\n-----\n\nThis\n\npermission grants the spyware the ability to read the full-text messages and the names of\ncontacts, from any app, such as Facebook or WhatsApp, as well as dismissing notifications\nfrom other apps (such as a mobile anti-malware app’s warnings) or toggling the Do Not\nDisturb settings on the phone. The device administrator permission gives the operator of the\napp the ability to lock the phone, but according to our analysis, the spyware’s current version\nhas no capability to do this.\n\n\n-----\n\nThe app prompts the user to Enable the device admin permission or system won t secure\nyour internet connection.”\n\nIn reality, the feature the spyware wants the user\n\nto enable would let the spyware lock the phone.\n\nThe final prompt\n\nasks the user to change a setting with a vague warning about something being blocked as a\nresult of battery optimization.\n\n\n-----\n\nLike the other\n\nprompts, this is also bogus. This prompt redirects the user to enable a feature that permits\nthe spyware to identify what apps you use, when you’re using them. The spyware sends that\ninformation onward to its C2 server.\n\n\n-----\n\nOnce the target has granted all these permissions, the app disguises itself to evade any\nattempts at manual removal by the user. The method to attain stealth appears to be new to\nthis version: the spyware changes its icon (and name) to disguise itself using an icon of one\nof the four apps: or Botim (a VOIP calling app).\n\nOnce this happens, the next time the spyware app is opened, the spyware opens the real\napp whose disguise it wears, i.e., it opens Chrome if it disguises itself as Chrome, thereby\ngiving an illusion to the user that the app is legit.\n\n\n-----\n\nThe spyware app icon\n\n\nappears as “App Updates” before the change…\n\n\n-----\n\n…and afterward takes\n\non the icon of the Chrome browser, and launches that app when the user clicks the icon.\nThe apps contain a text string, in the Arabic language, that they send to the command and\ncontrol server when the icon has been changed. These strings are present in these new\nversions of the malware.\n\nﺗﻢ ﺗﻐﯿﯿﺮ اﻷﯾﻘﻮﻧﺔ\n\nWe also found that it tried to install its own version of Botim from the application’s assets – a\nfunctionality we believe was meant for future versions, as the samples did not contain (or try\nto download) any Botim APK file.\n\nEach functionality of the spyware has a command associated with it. The commands are\nreceived via Firebase messaging, and the spyware performs the corresponding function as\nand when instructed.\n\n\n-----\n\nThe live C2 servers posed as websites for Laravel – a web application framework.\n\n\n-----\n\nC2 website posed as website for Laravel (a web application framework)\nYet many of the functionalities of the spyware remain unchanged. The app does the following\nthings:\n\nCollects SMS, contacts, call logs\nCollects images and documents\nRecording audio, incoming and outgoing calls, including WhatsApp calls\nTaking screenshots and recording video of the screen\nTaking pictures using the camera\nHiding its own icon\nReading notifications from WhatsApp, Facebook, Facebook Messenger, Telegram,\nSkype, IMO Messenger, or Signal\nCanceling notifications from built-in security apps (such as Samsung\nSecurityLogAgent, Xiaomi MIUI SecurityCenter, Huawei SystemManager), as well as\nfrom Android system apps, package Installer, and its own notifications\n\nInternal logging shows the app writing out the contents of the contact list, call logs, and SMS\nmessages to a Zip archive it later uploads to its C2\n\n\n-----\n\n## Don t be a spyware victim\n\nTo avoid falling prey to such malicious apps, users should only install apps from trusted\nsources such as Google Play. Updating Android OS and applications should be done via\nAndroid Settings and Google Play respectively, instead of relying on a third-party app.\n\nUsers should be particularly wary of apps asking for sensitive permissions such as device\nadmin, notification access, or those requiring superuser/root access. Users can view the\napps currently having device admin and notification access permissions by browsing to\nSettings and searching for “Device admin apps” and “Notification access” respectively.\n\n## Detections and acknowledgments\n\nWe also advise users to consider installing an antivirus app on their mobile device such as\nSophos Intercept X for Mobile that defends their device and data from such threats.\n[SophosLabs has published indicators of compromise on its Github page. These samples are](https://github.com/sophoslabs/IoCs/blob/master/Android_C23-spyware.csv)\ndetected by Sophos Intercept X for Mobile as Andr/Spy-BFI.\n\n[SophosLabs would like to acknowledge that @malwrhunterteam initially alerted us to some](https://twitter.com/malwrhunterteam/status/1448726061789876227)\nof the samples in this post. Andrew Brandt conducted additional research for this article.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-23 - Android APT spyware, targeting Middle East victims, enhances evasiveness.pdf"
    ],
    "report_names": [
        "2021-11-23 - Android APT spyware, targeting Middle East victims, enhances evasiveness.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535980,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653710552,
    "ts_modification_date": 1653710552,
    "files": {
        "pdf": "https://archive.orkl.eu/2cbaf2eb395dc79cca9deecb3924da758c82a365.pdf",
        "text": "https://archive.orkl.eu/2cbaf2eb395dc79cca9deecb3924da758c82a365.txt",
        "img": "https://archive.orkl.eu/2cbaf2eb395dc79cca9deecb3924da758c82a365.jpg"
    }
}