{
    "id": "5a3914b6-5f6e-4d6f-9617-899f3b95ea7c",
    "created_at": "2023-01-12T15:08:55.715962Z",
    "updated_at": "2025-03-27T02:09:18.605547Z",
    "deleted_at": null,
    "sha1_hash": "ae2aebc3c8e7b7794bec7038a19363a9879a631c",
    "title": "2022-12-21 - Conti Team One Splinter Group Resurfaces as Royal Ransomware with Callback Phishing Attacks",
    "authors": "",
    "file_creation_date": "2022-12-29T00:39:34Z",
    "file_modification_date": "2022-12-29T00:39:34Z",
    "file_size": 1274154,
    "plain_text": "# Conti Team One Splinter Group Resurfaces as Royal Ransomware with Callback Phishing Attacks\n\n**[trendmicro.com/en_us/research/22/l/conti-team-one-splinter-group-resurfaces-as-royal-ransomware-wit.html](https://www.trendmicro.com/en_us/research/22/l/conti-team-one-splinter-group-resurfaces-as-royal-ransomware-wit.html)**\n\nDecember 21, 2022\n\nRansomware\n\nFrom September to December, we detected multiple attacks from the Royal ransomware group. In this blog entry, we discuss findings\nfrom our investigation of this ransomware and the tools that Royal ransomware actors used to carry out their attacks.\n\nBy: Ivan Nicole Chavez, Byron Gelera, Monte de Jesus, Don Ovid Ladores, Khristian Joseph Morales\nDecember 21, 2022\nRead time:\n( words)\n\nRoyal [ransomware may have been first observed by researchers around September 2022, but it has seasoned cybercriminals behind](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/ransomware)\nit: The threat actors running this ransomware — who used to be a part of Conti Team One, according to a mind map shared by Vitali\nKremez — initially dubbed it Zeon ransomware, until they rebranded it to Royal ransomware. From September to December this year,\nwe have detected multiple attacks from Royal ransomware, with the US and Brazil being the most targeted countries (Figure 1). This\nblog entry discusses in depth the findings from our investigation of samples of this new piece of ransomware, as well as the tools that\nRoyal ransomware actors used to carry out their attacks.\n\nFigure 1. Percentage of Royal ransomware attacks by country\n\n## Infection Routine\n\n[External reports mention that the Royal ransomware group uses callback phishing as a means of delivering their ransomware to](https://www.bleepingcomputer.com/news/security/new-royal-ransomware-emerges-in-multi-million-dollar-attacks/)\nvictims (Figure 2). These phishing attacks contain a number that leads to a service hired by the threat actors. When contacted, they\nwill use social engineering tactics to lure victims into installing remote access software.\n\n\n-----\n\nFigure 2. Royal ransomware’s attack flow\n\n## Installation\n\nOur investigation found that the ransomware actors used a compiled remote desktop malware, which was used to drop the tools they\nneeded to infiltrate the victim’s system: they used QakBot and Cobalt Strike for lateral movement, while NetScan was used to look for\nany remote systems connected to the network. Once they infiltrated the system, the ransomware actors used tools such as PCHunter,\nPowerTool, GMER, and Process Hacker to disable any security-related services running in the system. They then exfiltrate the\nvictim’s data via the RClone tool. We also observed an instance in which they used AdFind to look for active directories, then\nexecuted RDPEnable on the infected machine.\n\n## Payload\n\nOnce everything has been set up, the ransomware actors used PsEXEC to execute the malware. The PsEXEC commands contain\nthe ID of the victim, along with any argument that the actors applied to the ransomware. There were also instances of the malware\nactors using PsEXEC to enable the remote desktop protocol (RDP) of a target system before executing the ransomware.\n\n## Analysis\n\nIn part of our analysis, we used a ransomware sample with the detection name Ransom.Win64.YORAL.SMYXCJCT. As shown in\nTable 1, Figure 3, and Figure 4, Royal ransomware requires an argument of “-id {32-byte characters}” to execute on a victim’s\nmachine. It also accepts “-path” to specify a target file for encryption and “-ep {value}” to calculate the partial file encryption of large\nfiles.\n\nIn some earlier samples of the ransomware, the binary wouldn’t parse all the arguments due to a bug in the code. For example, “_path” won't be processed if provided after the \"-id\" argument; if provided before, there will be no \"-id\" argument, so it will not proceed._\n\n**Argument** **Description**\n\n\n-path {target\n_path}_\n\n-id {32-byte\n_characters}_\n\n\nIf provided, will only encrypt the contents of the target path\n\nWill be used as the victim’s ID, which will be appended on the TOR link found in the dropped ransom note. The\nprocess exists if not provided or if provided characters is not 32 bytes long\n\n\n-ep This argument is for the full or partial encryption of file routine\n\n\n-----\n\nTable 1. Arguments accepted by the Royal ransomware binary\n\nFigure 3. Arguments accepted by the ransomware binary\n\nFigure 4. Checking if length of provided “-id” is 32 bytes\n\nIt enumerates files and directories for encryption using FindFirstFileW, FindNextFileW, and FindClose APIs (Figure 5).\n\nFigure 5. File enumeration\n\nThe ransomware looks for available network shares for network encryption by listing accessible local IPs, then uses NetShareEnum\nand attempts to connect on ADMIN$ and IPC$ shares (Figure 6).\n\nFigure 6. Looking for accessible local IPs then trying to connect\n\nto ADMIN$ and IPC$\nIt checks for the number of processors in the infected system and uses it as a base for the concurrent running threads for file\nencryption, as shown in Figure 7. By doing so, Royal ransomware significantly increases the speed of its file encryption process.\n\nFigure 7. Checking the number of processors\n\nRoyal ransomware inhibits system recovery by deleting shadow copies (Figure 8) through the following command:\n\n\n-----\n\n_C:\\\\Windows\\\\System32\\\\vssadmin.exe delete shadows /all /quiet_\n\nFigure 8. Using vssadmin.exe to delete shadow copies\n\nThe ransomware encrypts files using OpenSSL’s Advanced Encryption Standard (AES). It will encrypt the AES key and IV with RSA\nencryption using the embedded RSA public key (Figure 9). The RSA-encrypted AES key and IV will be appended on each encrypted\nfile (Figure 10).\n\nFigure 9. An RSA public key\n\nFigure 10. Generation of AES Key and IV\n\n[The malicious actors behind Royal ransomware use a form of intermittent encryption tactic to speed their encryption process: the](https://www.bleepingcomputer.com/news/security/ransomware-gangs-switching-to-new-intermittent-encryption-tactic/)\nransomware first checks if the file size is divisible by 16, which is a requirement for AES (Figure 11). If not, it rounds up the total size\nuntil it is divisible by 16. For example, if the size is 18, it will append zero bytes to the file until it has a size of 32, which is now divisible\nby 16. Aside from appending the needed zero bytes, it also appends an extra 0x210 Zero bytes as a placeholder for the appended\nRSA encrypted key.\n\nFigure 11. Royal ransomware checking if file size is\n\ndivisible by 16\n\n\n-----\n\nFor a file size that has been rounded up, Royal ransomware will check if the size is less than or equal to 5,245,000 bytes or if the\nvalue is set to 100 (0x64), as shown in Figure 12. If the file size is within these limits, it will encrypt the entire file. For files greater than\n5,245,000 bytes, file encryption will take place per certain calculated blocks: for example, it will encrypt first N bytes, then skip the next\nN bytes, then encrypt the next N bytes, and so on.\n\nFigure 12. Encryption process and calculation\n\nIts calculation of N bytes is as follows:\n\nX / 10* (Original file size) & 0xFFFFFFF0\n\nwhere X is the value set before encryption\nX is either 0x32 (50) or 0x64 (100)\nThis value will also be used as indicator if full encryption or partial encryption will be performed on the file\n\nFor example, with a file with a file size equal to 5,245,000:\n\nN = 50/10 * (5245000 / 100) & 0xFFFFFFF0 = 0x40060 (262240)\n\nIf the calculated N is greater than 1,024,000, it will simply encrypt per 1,024,000 block instead (Figure 13).\n\nFigure 13. Condition if N is greater than 1,024,000\n\nThe encrypted file’s structure would then be as follows (Table 2):\n\n**Description** **Size**\n\nEncrypted File Contents Rounded-up file size divisible by 16\n\nRSA Encrypted Key 0x200 bytes\n\nSize of encrypted file / offset address of RSA Encrypted Key 8 bytes\n\nX value, 0x64 or provided value (usually 0x32), indicator if full or partial encryption 8 bytes\n\nTable 2. An encrypted file’s structure\n\nThe ransomware then renames the encrypted files by appending them with the “.royal” extension, as demonstrated in Figures 14 and\n15.\n\nFigure 14. Royal ransomware appending “.royal” to encrypted files\n\nFigure 15. Encrypted files appended with the “.royal” extension\n\n\n-----\n\nFor each directory it traverses, Royal ransomware drops a text file named README.TXT that contains the ransom note (Figure 16),\nas well as an advertisement for its “pentesting services” that the ransomware actors will allegedly provide once the ransom has been\npaid (Figure 17).\n\nFigure 16. Creation of the “README.TXT” file\n\nFigure 17. Contents of \"README.TXT\" with\n\nthe sample ID we used appended on the TOR link.\n\n## Security Recommendations\n\nOur investigation into Royal ransomware attacks shows how the group employs a mixture of both old and new techniques, which\nindicates that it is no newcomer to the ransomware scene. Their use of callback phishing to lure victims into installing remote desktop\nmalware allows them to infiltrate the victim’s machine with relative ease. Their intermittent encryption tactics also hasten their\nencryption of a victim’s files, with the added benefit of evading detection measures that focus on looking for heavy file IO operations.\nDespite their “late” entry to the scene in September, the group already has ransomed multiple companies, and we expect them to be\nmore active in the upcoming months. More details on Royal ransomware’s other capabilities can be found in Trend Micro’s Threat\nEncyclopedia.\n\nWe highly advise users and organizations to update their systems with the latest patches and apply multi-layered defense\nmechanisms. The emergence and success of the Royal ransomware gang underscore how ransomware actors are finding more\ninnovative ways to repurposing existing tools and tactics as a means of augmenting their attacks. End users and enterprises alike can\nmitigate the risk of infection from new threats like Royal ransomware by following these security best practices:\n\nEnable multifactor authentication (MFA) to prevent attackers from performing lateral movement inside a network.\n[Adhere to the 3-2-1 rule when backing up important files. This involves creating three backup copies on two different file formats,](https://www.trendmicro.com/vinfotmr/?/us/security/news/virtualization-and-cloud/best-practices-backing-up-data)\nwith one of the copies stored in a separate location.\n[Patch and update systems regularly. It’s important to keep operating systems and applications up to date and maintain patch](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/vulnerabilities-and-exploits/virtual-patching-patch-those-vulnerabilities-before-they-can-be-exploited)\nmanagement protocols that can deter malicious actors from exploiting any software vulnerabilities.\n\n[Companies can also benefit from the use of multilayered detection and response solutions such as Trend Micro Vision One™, which](https://www.trendmicro.com/en_us/business/products/detection-response.html)\nprovides powerful XDR capabilities that collect and automatically correlate data across multiple security layers — email, endpoints,\nservers, cloud workloads, and networks — to prevent attacks via automated protection, while also ensuring that no significant\n[incidents go unnoticed. Trend Micro Apex One™ also provides next-level automated threat detection and response to protect](https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\nendpoints against advanced issues, like human-operated ransomware.\n\n## Indicators of Compromise (IOCs)\n\n**SHA-256** **Detection** **Description**\n\n\n-----\n\nc0063d24f3de4e7b89abf9b690a3d264efc6ab7a626f73ad9f42d6bffe52bce7 Trojan.Win64.COBALT.BE CobaltStrike\n\nfef79160f0ce9aa9dec15c914f2c2b40b2ae1ec2b0e65e414545dbc994afd73d Trojan.Win64.COBALT.BE CobaltStrike\n\n3434271f2038afaddad4caad8000e390b3573b2b53e02841653a4ee0dfd73674 Trojan.Win64.COBALT.BE CobaltStrike\n\n0ac0b3758359855e96367b6c83b0aabdc6cfb59b4caa1cec48632defd21cdf3c Trojan.Win64.COBALT.BE CobaltStrike\n\n451cef0085dc5b474cc5c68af079d0367d7d2ec73ae2210788beb5297e1fbd6d Trojan.Win64.COBALT.BE CobaltStrike\n\ne710e902507ad63e1d2ce1220212b1a751b70504259457234103bb22845a9424 Trojan.Win32.QAKBOT.DRSV QakBot\n\n2718dcbb503b6334078daf4af61e17a547fb80c9b811c26cfc9d32f5ce63a826 Trojan.Win32.QAKBOT.DRTE QakBot\n\nabf937fb2f162d1dbbe76c7386c9892db5191e17de586f0a5c49819cd68b5e0f Trojan.Win32.DEYMA.AM Compiled\nRemote\nDesktop\nMalware\n\nbd2c2cf0631d881ed382817afcce2b093f4e412ffb170a719e2762f250abfea4 PUA.Win64.ProcHack.AC Process\nHacker\n\n572d88c419c6ae75aeb784ceab327d040cb589903d6285bbffa77338111af14b HackTool.Win32.NetScan.AG NetScan\n\n094d1476331d6f693f1d546b53f1c1a42863e6cde014e2ed655f3cbe63e5ecde HackTool.Win32.ToolPow.SM PowerTool\n\ne8a3e804a96c716a3e9b69195db6ffb0d33e2433af871e4d4e1eab3097237173 PUA.Win32.GMER.YABBI GMER\n\nd1aa0ceb01cca76a88f9ee0c5817d24e7a15ad40768430373ae3009a619e2691 PUA.Win64.PCHunter.B PCHunter\n\nbb48f5c915ab7bbbbbf092a20169aaf3ced46b492ed69550854a55254ce10572 Backdoor.Win32.SWRORT.YXCJ5Z Malware\nComponent\n\ne263b9d5467bf724000966da2acfe06520a464c566e4b3d9833213f850f3f1f2 HackTool.Win32.Adfind.THLOFBB AdFind\n\nac49c114ef137cc198786ad8daefa9cfcc01f0c0a827b0e2b927a7edd0fca8b0 HackTool.BAT.RDPEnable.A RDPEnable\n\n2598e8adb87976abe48f0eba4bbb9a7cb69439e0c133b21aee3845dfccf3fb8f Ransom.Win64.YORAL.SMYXCJCT Royal\nRansomware\nBinary\n\ncdd7814074872fc35d18740cdd4e8a5fefcfd6b457fde2920383fd5b11903fc5 Ransom_Royal.R06CC0DK222 Royal\nRansomware\nBinary\n\na61b71ee73ea8c0f332591e361adeda04705c65b5f4d549066677ec4e71212f7 Ransom.Win32.YORAL.YXCKB Royal\nRansomware\nBinary\n\n56e8bd8b0c5bfb87956f7915bc47a9ecf5d338b804cee1dccacf53400d602be3 Ransom.Win32.YORAL.YECJYT Royal\nRansomware\nBinary\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-12-21 - Conti Team One Splinter Group Resurfaces as Royal Ransomware with Callback Phishing Attacks.pdf"
    ],
    "report_names": [
        "2022-12-21 - Conti Team One Splinter Group Resurfaces as Royal Ransomware with Callback Phishing Attacks.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536135,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1672274374,
    "ts_modification_date": 1672274374,
    "files": {
        "pdf": "https://archive.orkl.eu/ae2aebc3c8e7b7794bec7038a19363a9879a631c.pdf",
        "text": "https://archive.orkl.eu/ae2aebc3c8e7b7794bec7038a19363a9879a631c.txt",
        "img": "https://archive.orkl.eu/ae2aebc3c8e7b7794bec7038a19363a9879a631c.jpg"
    }
}