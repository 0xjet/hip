{
    "id": "20a88d23-8094-46a4-9c62-c6bdf4cf0fbd",
    "created_at": "2023-01-12T14:59:22.971114Z",
    "updated_at": "2025-03-27T02:09:26.44082Z",
    "deleted_at": null,
    "sha1_hash": "aad9cccd2948439cc3c1d0b515e9bc9024d669a4",
    "title": "2014-01-14 - The Icefog APT Hits US Targets With Java Backdoor",
    "authors": "",
    "file_creation_date": "2022-05-28T03:41:42Z",
    "file_modification_date": "2022-05-28T03:41:42Z",
    "file_size": 370455,
    "plain_text": "# The Icefog APT Hits US Targets With Java Backdoor\n\n**[securelist.com/the-icefog-apt-hits-us-targets-with-java-backdoor/58209/](https://securelist.com/the-icefog-apt-hits-us-targets-with-java-backdoor/58209/)**\n\nAuthors\n\nVitaly Kamluk\n\nIgor Kuznetsov\n\n[Costin Raiu](https://securelist.com/author/costin/)\n\nIn September 2013, we published our extensive analysis of Icefog, an APT campaign that\nfocused on the supply chain – targeting government institutions, military contractors,\nmaritime and ship-building groups.\n\nIcefog, also known as the “Dagger Panda” by Crowdstrike’s naming convention, infected\ntargets mainly in South Korea and Japan. You can find our Icefog APT analysis and detailed\nreport here.\n\n\n-----\n\nSince the publication of our report, the Icefog attackers went completely dark, shutting down\nall known command-and-control servers. Nevertheless, we continued to monitor the\noperation by sinkholing domains and analysing victim connections. During this monitoring,\nwe observed an interesting type of connection which seemed to indicate a Java version of\nIcefog, further to be referenced as “Javafog”.\n\n## Meet “Lingdona”\n\nThe Icefog operation has been operational since at least 2011, with many different variants\nreleased during this time. For Microsoft Windows PCs, we identified at least 6 different\ngenerations:\n\nThe “old” 2011 Icefog – sends stolen data by e-mail; this version was used against the\nJapanese House of Representatives and the House of Councillors in 2011.\nType “1” “normal” Icefog – interacts with command-and-control servers via a set of\n“.aspx” scripts.\nType “2” Icefog – interacts with a script-based proxy server that redirects commands\nfrom the attackers to another machine.\nType “3” Icefog – a variant that uses a certain type of C&C server with scripts named\n“view.asp” and “update.asp”\nType “4” Icefog – a variant that uses a certain type of C&C server with scripts named\n“upfile.asp”\nIcefog-NG – communicates by direct TCP connection to port 5600\n\nIn addition to these, we also identified “Macfog”, a native Mac OS X implementation of Icefog\nthat infected several hundred victims worldwide.\n\nBy correlating registration information for the different domains used by the malware\nsamples, we were able to identify 72 different command-and-control servers, of which we\nmanaged to sinkhole 27.\n\nOne interesting domain in particular was “lingdona[dot]com”, which expired in September\n2013 and we took over in October 2013. Here’s what the original contact information looked\nlike:\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n\nDomain Name: LINGDONA.COM\n\nRegistrant Contact:\n\nlin ming hua\n\nlin ming kevistin@qq.com\n\ntelephone: +86.031185878412\n\nfax: +86.031185878412\n\nfuzhoushi Fuzhou Shi Fujian Sheng 412141\n\nCN\n\n\nThe domain was originally hosted in Hong Kong, at IP 206.161.216.214 and 103.20.195.140,\nand appeared suspicious because of the registration data, which seemed to match other\nknown Icefog domains. As soon as we sinkholed it, we observed a number of suspicious\nconnections, almost every 10 seconds:\n\n\n1\n\n2\n\n3\n\n4\n\n\n69.59.x.x www.lingdona.com - [26/Oct/2013:23:59:39 +0000] \"POST\n/news/latestnews.aspx?title=2.0_1593925273 HTTP/1.1\" 404 345 \"-\" \"Java/1.7.0_25\"\n\n69.59.x.x www.lingdona.com - [26/Oct/2013:23:59:45 +0000] \"POST\n/news/latestnews.aspx?title=2.0_1593925273 HTTP/1.1\" 404 345 \"-\" \"Java/1.7.0_25\"\n\n38.100.x.x www.lingdona.com - [26/Oct/2013:23:59:48 +0000] \"GET\n/news/latestnews.aspx?title=1.1_1254592001 HTTP/1.1\" 404 345 \"-\" \"Java/1.7.0_40\"\n\n38.100.x.x www.lingdona.com - [26/Oct/2013:23:59:58 +0000] \"GET\n/news/latestnews.aspx?title=1.1_1254592001 HTTP/1.1\" 404 345 \"-\" \"Java/1.7.0_40\"\n\n\nInterestingly, the User-Agent string indicated the client could be a Java application, however,\nthis was unusual because all other Icefog variants used regular IE User-Agent strings.\n\n## Finding the sample\n\nWhile we suspected there was a malware sample in the wild connecting to the domain\n“lingdona[dot]com”, we didn’t have a copy of that particular Icefog trojan.\n\nLuck seemed to strike when we came by a JSUNPACK submission that appeared quite\ninteresting.\n\n\n-----\n\nIn November 2012, someone submitted an interesting URL to the public JSUNPACK service\nwhich was hosted on the “sejonng[dot]org” server, a known Icefog domain. It also appeared\nto reference “starwars123[dot]net”, another known Icefog domain.\n\nMost interestingly, the HTML page references a Java applet “policyapplet.jar” with a long\nhexadecimal string parameter named “jar”. Unfortunately, we were not able to recover the\n“policyapplet.jar” file, which was most likely a Java exploit. Decoding the hexadecimal string,\nwe found another Java applet with the following information:\n\n\n1\n\n2\n\n\nSize: 8697 bytes\n\nMD5: d26af487534c1d575e747ff240ee6357\n\n\nLater, we discovered the extracted applet was also uploaded to a virus scanning service\naround the same time.\n\n## The Javafog\n\nThe “jar” applet caught our attention so we analysed to determine how it works.\n\nThe JAR format uses ZIP compression to store the data in compact form. The ZIP header\nuses timestamps to track when files were added to the archive. This helps understanding\nwhen the JAR file could have been created. Here is ZIP directory information from the applet:\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n\nDate Time Attr Size Compressed Name\n\n---------- --- ------ ------ -----------\n2012-10-30 16:47:50 ..... 129 115 META-INF/MANIFEST.MF\n\n2012-10-30 16:47:50 ..... 259 206 META-INF/B8228E45.SF\n\n2012-10-30 16:47:50 ..... 5365 3610 META-INF/B8228E45.RSA\n\n2010-10-29 22:44:06 ..... 7726 4226 JavaTool.class\n\n\nThis means that the JAR file was most likely created on 30th November 2012, while the main\nclass JavaTool.class was compiled two years before that, on 29th November 2010.\n\nUpon startup, it tries to register itself as a startup entry to achieve persistence. The module\nwrites a registry value to ensure it is automatically started by Windows:\n\n\n1\n\n2\n\n\n\n[HKEY_CURRENT_USERsoftwaremicrosoftwindowscurrentversionrun]\n\nJavaUpdate=%TEMP%update.jar\n\n\nIt is worth noting that the module does not copy itself to that location. It is possible that the\nmissing file “policyapplet.jar” contains the parts of the installation routine.\n\nNext, it enters a loop where it keeps calling its main C&C function, with a delay of 1000ms.\nThe main loop contacts the well known Icefog C&C server – “www.lingdona[dot]com/news”\nand interacts with it.\n\n\n-----\n\nFirst of all, it sends the full system information profile, which the attackers can use to\ndetermine if the victim is “interesting” or has any real value. Here’s a PCAP of the\nconversation:\n\n\n-----\n\nIn the screenshot above, title=2.0_1651809722 indicates a unique victim ID that is\ncomputed by hashing the hostname. This can be used by the operators to uniquely identify\nthe victim and send commands to it.\n\nAs a reply to the uploaded system information, the backdoor expects an “order”, which can\nhave different values:\n\nCommand Description:\n\n**upload_* – Upload a local file specified after the command to the C&C server by URL**\n“%C&C server URL%/uploads/%file name%”. Uploaded data is encrypted with a simple\nXOR operation with key 0x99.\n**cmd_UpdateDomain – Migrate to a new C&C server URL specified after the**\ncommand. The new URL is also written to the file “%TEMP%update.dat”\n**cmd_* – Execute the string specified after the command using “cmd.exe /c”. The**\nresults are uploaded to the C&C server by URL “%C&C server\nURL%/newsdetail.aspx?title=2.0_%host name%”.\nBesides the above, the backdoor doesn’t do much else. It allows the attackers to\ncontrol the infected system and download files from it. Simple, yet very effective.\n\n## Geography of victims\n\nOne might wonder what is the purpose of something like the Javafog backdoor. The truth is\nthat even at the time of writing, detection for Javafog is extremely poor (3/47 on VirusTotal).\nJava malware is definitively not as popular as Windows PE malware, and can be harder to\nspot.\n\nDuring the sinkholing operation for the “lingdona[dot]com” domain, we observed 8 IPs for\nthree unique victims of Javafog, all of them in the United States. Interestingly, during the\nobservation period, two of the victims updated the Java version from “Java/1.7.0_25” to\n“Java/1.7.0_45”.\n\nBased on the IP address, one of the victims was identified as a very large American\nindependent Oil and Gas corporation, with operations in many other countries.\n\nAs of today, all victims have been notified about the infections. Two of the victims have\nremoved it already.\n\n## Conclusions\n\nWith Javafog, we are turning yet another page in the Icefog story by discovering another\ngeneration of backdoors used by the attackers.\n\n\n-----\n\nIn one particular case, we observed the attack commencing by exploiting a Microsoft Office\nvulnerability, followed by the attackers attempting to deploy and run Javafog, with a different\nC&C. We can assume that based on their experience, the attackers found the Java backdoor\nto be more stealthy and harder to notice, making it more attractive for long term operations.\n(Most Icefog operations being very short – the “hit and run” type).\n\nThe focus on the US targets associated with the only known Javafog C&C could indicate a\nUS-specific operation run by the Icefog attackers; one that was planned to take longer than\nusual, such as, for instance, long term collection of intelligence on the target. This brings\nanother dimensions to the Icefog gang’s operations, which appear to be more diverse than\ninitially thought.\n\n[APT](https://securelist.com/tag/apt/)\n[Icefog](https://securelist.com/tag/icefog/)\n[Java](https://securelist.com/tag/java/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n[Vulnerabilities and exploits](https://securelist.com/tag/vulnerabilities-and-exploits/)\n\nAuthors\n\nVitaly Kamluk\n\nIgor Kuznetsov\n\n[Costin Raiu](https://securelist.com/author/costin/)\n\nThe Icefog APT Hits US Targets With Java Backdoor\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-01-14 - The Icefog APT Hits US Targets With Java Backdoor.pdf"
    ],
    "report_names": [
        "2014-01-14 - The Icefog APT Hits US Targets With Java Backdoor.pdf"
    ],
    "threat_actors": [
        {
            "id": "5d9dfc61-6138-497a-b9da-33885539f19c",
            "created_at": "2022-10-25T16:07:23.720008Z",
            "updated_at": "2025-03-27T02:02:09.944484Z",
            "deleted_at": null,
            "main_name": "Icefog",
            "aliases": [
                "ATK 23",
                "Dagger Panda",
                "Icefog",
                "Red Wendigo"
            ],
            "source_name": "ETDA:Icefog",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Dagger Three",
                "Fucobha",
                "Icefog",
                "Javafog",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1aead86d-0c57-4e3b-b464-a69f6de20cde",
            "created_at": "2023-01-06T13:46:38.318176Z",
            "updated_at": "2025-03-27T02:00:02.803684Z",
            "deleted_at": null,
            "main_name": "DAGGER PANDA",
            "aliases": [
                "IceFog",
                "RedFoxtrot",
                "Red Wendigo",
                "PLA Unit 69010"
            ],
            "source_name": "MISPGALAXY:DAGGER PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535562,
    "ts_updated_at": 1743041366,
    "ts_creation_date": 1653709302,
    "ts_modification_date": 1653709302,
    "files": {
        "pdf": "https://archive.orkl.eu/aad9cccd2948439cc3c1d0b515e9bc9024d669a4.pdf",
        "text": "https://archive.orkl.eu/aad9cccd2948439cc3c1d0b515e9bc9024d669a4.txt",
        "img": "https://archive.orkl.eu/aad9cccd2948439cc3c1d0b515e9bc9024d669a4.jpg"
    }
}