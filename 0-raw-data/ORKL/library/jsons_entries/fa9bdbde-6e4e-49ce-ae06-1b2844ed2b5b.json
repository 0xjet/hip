{
    "id": "fa9bdbde-6e4e-49ce-ae06-1b2844ed2b5b",
    "created_at": "2023-06-05T02:07:17.0711Z",
    "updated_at": "2025-03-27T02:13:50.55265Z",
    "deleted_at": null,
    "sha1_hash": "3af06bcda9859e310037ecfa3267c2d55880f118",
    "title": "2019-06-04 - Advisory- Windigo attacks",
    "authors": "",
    "file_creation_date": "2023-06-04T12:41:39Z",
    "file_modification_date": "2023-06-04T12:41:39Z",
    "file_size": 202677,
    "plain_text": "# CERN Computer Security Information\n\n**[security.web.cern.ch/security/advisories/windigo/windigo.shtml](https://security.web.cern.ch/security/advisories/windigo/windigo.shtml)**\n\n[Home](https://security.web.cern.ch/home/en/index.shtml)\n[Computing Rules](https://security.web.cern.ch/rules/en/index.shtml)\n[Recommendations](https://security.web.cern.ch/recommendations/en/index.shtml)\n[Training](https://security.web.cern.ch/training/en/index.shtml)\n[Services](https://security.web.cern.ch/services/en/index.shtml)\n[Reports & Presentations](https://security.web.cern.ch/reports/en/index.shtml)\n\n\n-----\n\n## 2019/06/04 Advisory: Windigo attacks\n\n**This page covers ongoing attacks and may be updated (latest: 2019-07-17).**\n\n### Introduction\n\nWindigo has been a long-standing adversary of the Research & Education community. The\nfirst known attack dates back to 2011, when the Ebury malware was discovered during the\n[Linux Foundation attack in 2011. A technical paper describing the attacks in-depth was](https://lwn.net/Articles/457142/)\npublished in 2014 by ESET: [\"Operation Windigo\". After the arrest and](https://www.welivesecurity.com/wp-content/uploads/2014/03/operation_windigo.pdf) [conviction of one of](https://www.justice.gov/opa/pr/russian-citizen-sentenced-46-months-prison-involvement-global-botnet-conspiracy)\nthe key attackers, our community observed a sharp drop in the number of infections.\nSporadic Ebury infections continued to be observed in other sectors and led to another\nupdate from ESET: [Windigo Still not Windigone: An Ebury Update. A lot could be learnt from](https://www.welivesecurity.com/2017/10/30/windigo-ebury-update-2/)\nthe attacks to better protect our community, for example to detect [OpenSSH backdoors.](https://www.zdnet.com/article/eset-discovers-21-new-linux-malware-families/)\n\nUnfortunately, dozens of Linux servers were discovered compromised again in the Research\n& Education community in May 2019, all running new and improved versions of Ebury.\n\n### Ebury malware\n\nThe Ebury malware samples detected in May 2019 appear to be evolutions of the malicious\ncode from 2014 and 2017. The technical documents referenced in the introduction remain\nlargely valid. In a nutshell, the Ebury malware replaces legitimate dynamic libraries (e.g.\nlibkeyutils.so) in the affected system to capture SSH passwords and SSH keys. When\nexecuted:\n\nThe infected dynamic library will load a secondary malicious dynamic library (e.g.\nlibstz.so), containing the actual malicious code;\nMalicious hooks and a specific OpenSSH server configuration are pushed within the\nrunning OpenSSH server binary to accomodate the capture of credentials and\nbackdoor functionality;\nA malicious process is forked and dedicated to the extraction of credentials;\nThe two malicious processes communicate via an abstract unix socket.\n\n### Ebury backdoor\n\nEbury uses a complex backdoor mechanism described in the technical documents\nreferenced in the introduction. In the samples collected in May 2019, the authentication part\nof the backdoor was updated and reinforced. Nevertheless, the attacker seem to continue to\nconnect daily to infected hosts and exfiltrate the credentials using known techniques.\n\n### Indicators of compromises\n\n\n-----\n\n**Network: Backdoor connections**\n\nThe attacker is known to use direct incoming SSH connections to the victims OpenSSH\nserver. The backdoor connection will be regular SSH connections, with two notable\nexceptions:\n\nThe SSH client string will be different: SSH-2.0-XXXXXXXXXXXXXXX, where\nXXXXXXXXXXXXXXX will either be a Hex number (Ebury < 1.7.0) or Base64 string\n(Ebury >= 1.7.0);\nThe string is an encrypted message for the backdoor. It can be decoded based on the\nincoming IP address used by the attacker;\nLogging all incoming SSH client versions using network monitoring tools is very helpful.\n\nExample malicious strings from incoming IP address 80.82.67.21: SSH-2.01f25412f1c4d340d173f003a35150d5734111a5562471c.\n\nBackdoor connections (incoming SSH) may be observed form the following IP addresses:\n\n94.140.120.163\n49.50.70.223\n80.82.67.21\n125.160.17.32\n\nIt is essential to monitor the SSH client version string.\n\n**Network: Password exfiltration**\n\nThe SSH client string is decrypted by the client to reveal the credentials exfiltration IP\naddress that needs to be used by the malware. Both the SSH client string and the\n**incoming IP address are needed to decrypt the malicious command and exfiltration IP**\n**address.**\n\nThe exfiltration IP address is used by the malware to exfiltrate captured credentials as a\noutgoing DNS request (UDP:53). The following IP address has been identified as the\nexfiltration (outgoing UDP:53) host: 91.236.116.62\n\nAdditional exfiltration methods are described in the technical documents referenced in the\nintroduction. In particular, the malware also relies on a DGA, and the attacker seems to have\nprepared the following domains:\n\nlarfj7g1vaz3y.net / 78.140.134.7.\nop3f1libgh.biz / 193.0.179.76.\n\nThese domains are actively maintained by the attacker. However, no known affected host\nhas been observed using this exfiltration path in the current attack.\n\n\n-----\n\n**Host-based indicators**\n\nThe easiest way to inspect the OpenSSH server for signs of infection is to verify the dynamic\nlibraries in use. In particular, libkeyutils.so.* will typically have a single link to libc.so. Note\nthat the malware uses different library filenames (e.g. libsbz.so, libstz.so, etc.). For example,\non an infected system:\n```\n# objdump -x /lib64/libkeyutils.so.1|grep NEEDED\nNEEDED libc.so.6\nNEEDED libstz.so\n\n```\nThis indicates that libkeyutils.so.1 has been infected and will call Ebury from libstz.so. This\ncontrasts with a clean system:\n```\n# objdump -x /lib64/libkeyutils.so.1 |grep NEEDED\nNEEDED libc.so.6\n\n```\nDue to code errors in the malware, it is also common to discover segfault messages in the\nkernel logs, for example:\n```\nJun 04 09:01:03 hostname kernel: sshd[12345]: segfault at 7fcf794b8000 ip\n00007fcf792a50b8 sp 00007fffb6b8e0e0 error =\n\n```\nThe malicious abstract unix socket may also be identified by running the following command:\n```\n# lsof |grep \"@/run\"\n\n```\nNote: as it is an abstract socket, it is not possible to find it on the filesystem.\n\n### Responding to the attack\n\nThe attack is relying on stolen SSH credentials in our highly interconnected community.\nTherefore the initial infection vector is often a valid SSH login from a valid user from a known\nlocation.\n\nAs a result, collaboration between the affected organizations is absolutely crucial.\nResponding to this attack extensively relies on victims reporting attacks and contributing new\nmalicious samples, and sharing back with the community. If you are affected by this attack,\nyou can:\n\n[Ask directly for advice or support to cert@cern.ch;](mailto:cert@cern.ch)\nShare with or without attribution malicious samples and indicators of compromise\nwith [cert@cern.ch.](mailto:cert@cern.ch)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-06-04 - Advisory- Windigo attacks.pdf"
    ],
    "report_names": [
        "2019-06-04 - Advisory- Windigo attacks.pdf"
    ],
    "threat_actors": [
        {
            "id": "3844202f-b24a-4e16-b7b9-dfe8c0a44d5d",
            "created_at": "2022-10-25T16:07:24.526179Z",
            "updated_at": "2025-03-27T02:02:10.27234Z",
            "deleted_at": null,
            "main_name": "Operation Windigo",
            "aliases": [],
            "source_name": "ETDA:Operation Windigo",
            "tools": [
                "CDorked",
                "CDorked.A",
                "Calfbot",
                "Ebury"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1934b371-2525-4615-a90a-772182bc4184",
            "created_at": "2022-10-25T15:50:23.396576Z",
            "updated_at": "2025-03-27T02:00:55.460522Z",
            "deleted_at": null,
            "main_name": "Windigo",
            "aliases": [
                "Windigo"
            ],
            "source_name": "MITRE:Windigo",
            "tools": [
                "Ebury"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1685930837,
    "ts_updated_at": 1743041630,
    "ts_creation_date": 1685882499,
    "ts_modification_date": 1685882499,
    "files": {
        "pdf": "https://archive.orkl.eu/3af06bcda9859e310037ecfa3267c2d55880f118.pdf",
        "text": "https://archive.orkl.eu/3af06bcda9859e310037ecfa3267c2d55880f118.txt",
        "img": "https://archive.orkl.eu/3af06bcda9859e310037ecfa3267c2d55880f118.jpg"
    }
}