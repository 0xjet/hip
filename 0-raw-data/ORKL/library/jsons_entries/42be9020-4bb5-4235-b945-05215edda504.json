{
    "id": "42be9020-4bb5-4235-b945-05215edda504",
    "created_at": "2023-01-12T15:00:02.309353Z",
    "updated_at": "2025-03-27T02:13:01.443539Z",
    "deleted_at": null,
    "sha1_hash": "cb1a637b23eeeb546f672ecf08c42d765d43a156",
    "title": "2019-02-01 - Information about lnkr5, malware distributed via Chrome extensions",
    "authors": "",
    "file_creation_date": "2022-05-27T22:04:23Z",
    "file_modification_date": "2022-05-27T22:04:23Z",
    "file_size": 206108,
    "plain_text": "# Zenexer/lnkr: Information about lnkr5, malware distributed via Chrome extensions\n\n**github.com/Zenexer/lnkr**\n\nZenexer\n\n## lnkr\n\nlnkr is a malware campaign that injects scripts into web pages via malicious browser\nextensions.\n\n[The campaign has been identified as belonging to Brocode, a shell company registered in](https://github.com/Zenexer/lnkr/blob/master/brcode.io)\n[Hong Kong via startupr.com.hk. The attackers are believed to be Eastern European, likely](https://startupr.com.hk/)\nUkrainian or Russian, but there's no indication that the effort is state-sponsored.\n\nThe attackers clone legitimate and semi-legitimate Chrome extensions. Scripts are added to\nthe clones that inject ads into every web page visited by the victim, in addition to potentially\nsending sensitive data to C2 servers. The C2 communications are disguised as analytics\nopt-out requests. The malicious code will falsely explain to the victim that the ads suppor the\ndevelopment of the extension, but almost all of the affected extensions aren't developed by\nthe attackers.\n\nThe extension that I analyzed, Flash Player + 1.2.0, ID fanagokoaogopceablgmpndejhedkjjb,\nwas a modified, likely unauthorized clone of an extension of the same name, ID\nfnipglnbhfacfmefbgiiodalehbcgcbm. The malicious clone has been removed from the Chrome\nWeb Store; the original remains.\n\n\n-----\n\nThe attackers make the attack difficult to block. Generic S3 bucket names are used, C2\ndomain names are frequently rotated, and C2 IP addresses are numerous and spread\nacross many hosting providers. C2 communications are disguised as opt-out requests.\n\nAffected extensions appear widespread and affect a significant percentage of Englishspeaking Chrome users. The extensions are often removed from the Chrome store before\nthey can be analyzed, which makes it difficult to assess the number of affected extensions.\nConcentrations appear to be in the United States and India.\n\nAt least one extension keeps a log of search keywords. It's not yet certain that this data is\nstored and transmitted by lnkr, but preliminary evidence points to that conclusion.\n\nThe name `lnkr appears to be the name used by the attackers. The boostrap scripts are`\nprefixed with `lnkr, and some of the server-side C2 source code is in a folder named`\n```\nlnkrApi . lnkr.us and lnkr.fr both appear to be controlled by the attackers.\n\n## Attack analysis\n\n```\nSee [an analysis of one of the extensions](https://github.com/Zenexer/lnkr/blob/master/recon/extensions/fanagokoaogopceablgmpndejhedkjjb/README.md)\n\n## IOCs\n\nThis should not be treated as an exhaustive list.\n\n## Domain names\n\nSee [domains.txt](https://github.com/Zenexer/lnkr/blob/master/domains.txt)\n\n## IP addresses\n\nSee [ips.txt](https://github.com/Zenexer/lnkr/blob/master/ips.txt)\n\n## URL prefixes\n\nScheme can be either `http: or` `https: .`\n```\n//s3.amazonaws.com/jscache/\n//s3.amazonaws.com/jscript-cdn/\n//s3.amazonaws.com/cashe-js/\n//s3.amazonaws.com/jsbooster/\n//adrs.me/get?key=6ae9f4bd1dc812dc713d61cba871d8e8&\n\n## URL contents\n\n```\n\n-----\n\n```\n/api/js get?sourceId \n/optout/get?jsonp=__twb_cb_\n/lnkr5.min.js\n/optout/set/lat?jsonp=\n/optout/set/lt?jsonp=\n/script/d.php?uid=\n/www/delivery/avw.php?\n/www/delivery/afr.php?\n/www/delivery/ck.php?\n\n## Arbitrary strings\nlnkr5.min.js\nlnkr30_nt.min.js\n1100b35355a4776ae9\n143e7cdebf193d2764\n16a168f0af2da0c3c2\n17c9c17dd4d2a394de\n1bbe2f4535e7dfb295\n1f7cbb02d08cf61dbb\nc822bb0d82ad01a5ae\n__ckp_srchydx_fired\n__ckp_srchmlr_fired\n\n Example script URLs\n\n```\nThis list is far from exhaustive.\n\nURLs may be requested over plain HTTP or HTTPS.\n```\nhttps://netcheckcdn.xyz/addons/lnkr5.min.js\nhttps://netcheckcdn.xyz/addons/lnkr30_nt.min.js\nhttps://s3.amazonaws.com/jscript-cdn/1f404c54c2b0e13e0f.js\nhttps://s3.amazonaws.com/cashe-js/143e7cdebf193d2764.js\nhttps://s3.amazonaws.com/jscache/17c9c17dd4d2a394de.js\nhttps://s3.amazonaws.com/jscache/16a168f0af2da0c3c2.js\n\n## Analytics IDs\n\n```\nThese IDs are seen interspersed with malicious code. They may or may not belong to the\nattackers or uniquely identify the attacks.\n\nMixpanel\n\n58410f8ab299e0eb2b736f6e233eda37\nGoogle Analytics\n\nUA-108823706-1\n\n## Abuse report correspondence\n\n\n-----\n\nI sent an abuse report to Amazon Web Services regarding the S3 buckets. Amazon didn t\nremove the malicious code. When I questioned why, they forwarded me this response from\nthe attackers. (Some of the text is quoted from my original report; they appear to be\naddressing the individual points I mentioned.)\n\nHello,\nthanks for reaching us out regarding this issue.\n\n1. Here is a Virustotal report for the object 'jscript-cdn/1f404c54c2b0e13e0f.js' :\n\nhttps://www.virustotal.com/#/url/5f4279d8097fd1fd1c234e992a0c028146e5d102b\n2a3636fe1a9db3b87240503/detection, as you can see only ESET alerts on this,\nbut from our latest case we figured out that it’s a false positive alert on the URL,\nnot for a script content, but haven’t got a reply from ESET so far. The same\nsituation is for 'jscript-cdn/1f65199417190d400c.js’.\n\nAnyway this scripts are not in use at this time.\n\n1. 'jscript-cdn/ is used to host scripts that are part of a malware campaign. The\n\nattacker creates malicious duplicates of legitimate extensions in the Chrome web\nstore and injects these scripts into them. The ‘jscript-cdn’ is used to host scripts\nfor:\n\n1. Monetization chrome extensions, firefox addons, websites and other web\n\napplications.\n2. Analytics scripts for browser extensions. If the script is used for\n\nmonetization, it’s completely MS and Google Compliance. Nor Monetization\nof extensions nor Injecting ads in a proper way is not prohibited. There are\nExtension’s Quality Quidlines and Single Purpose Policy. And of course\nthere is no malicious code inside, we check all scripts regularly and are\neager to keep them clean. If you find something suspicious in our scripts\nplease let us know and we’ll take the action immediately.\n2. The link is to an old article about the extension that had been using monetization\n\nscript with search enhanced results, but the integration has been made incorrect\nthat’s why some important features, such as Opt Out from ads hadn't been work.\nBut the extension has been dropped from the store not for monetization\nparticularly but for violating single purpose policy.\n\nUser installs the extension from official chrome store, if he doesn’t like that the\nextension is monetized with scripts he can easily remove the extension from his\nbrowser and install alternative from the store. Usually our clients aware users in the\ndescription of the extension that it contains the monetization scripts.\n\nBest wishes, Brocode Team\n\nUltimate response from AWS:\n\n\n-----\n\nHello,\nThank you for providing the additional information. We are unable to remove the\ncontent at this time as we have no evidence of the reported files are malicious. These\nfiles appear to be adware, not malware.\n\nIf you have conclusive evidence that the reported files cause harm, please forward the\ninformation.\n\nRegards,\n\nAWS Abuse Escalations\n\n## WHOIS\n\n lnkr.us\n\n\n-----\n\n```\nDomain Name: lnkr.us\nRegistry Domain ID: D43534441-US\nRegistrar WHOIS Server: whois.publicdomainregistry.com\nRegistrar URL: publicdomainregistry.com\nUpdated Date: 2018-12-22T16:06:01Z\nCreation Date: 2013-12-19T21:11:43Z\nRegistry Expiry Date: 2019-12-18T23:59:59Z\nRegistrar: PDR Ltd. d/b/a PublicDomainRegistry.com\nRegistrar IANA ID: 303\nRegistrar Abuse Contact Email: abuse-contact@publicdomainregistry.com\nRegistrar Abuse Contact Phone: +1.2013775952\nDomain Status: clientTransferProhibited\nhttps://icann.org/epp#clientTransferProhibited\nRegistry Registrant ID: C45976584-US\nRegistrant Name: Sergei Filov\nRegistrant Organization: N/A\nRegistrant Street: Svobody street 58\nRegistrant Street:\nRegistrant Street:\nRegistrant City: kiev\nRegistrant State/Province: Kiev\nRegistrant Postal Code: 01001\nRegistrant Country: UA\nRegistrant Phone: +003.80985512834\nRegistrant Phone Ext:\nRegistrant Fax:\nRegistrant Fax Ext:\nRegistrant Email: adverto@mail.com\nRegistrant Application Purpose: P1\nRegistrant Nexus Category: C31/UA\nRegistry Admin ID: C45976584-US\nAdmin Name: Sergei Filov\nAdmin Organization: N/A\nAdmin Street: Svobody street 58\nAdmin Street:\nAdmin Street:\nAdmin City: kiev\nAdmin State/Province: Kiev\nAdmin Postal Code: 01001\nAdmin Country: UA\nAdmin Phone: +003.80985512834\nAdmin Phone Ext:\nAdmin Fax:\nAdmin Fax Ext:\nAdmin Email: adverto@mail.com\nAdmin Application Purpose: P1\nAdmin Nexus Category: C31/UA\nRegistry Tech ID: C45976584-US\nTech Name: Sergei Filov\nTech Organization: N/A\nTech Street: Svobody street 58\nTech Street:\nTech Street:\nTech City: kiev\nTech State/Province: Kiev\n\n```\n\n-----\n\n```\nTech Postal Code: 01001\nTech Country: UA\nTech Phone: +003.80985512834\nTech Phone Ext:\nTech Fax:\nTech Fax Ext:\nTech Email: adverto@mail.com\nTech Application Purpose: P1\nTech Nexus Category: C31/UA\nName Server: vipvdscom.earth.orderbox-dns.com\nName Server: vipvdscom.mars.orderbox-dns.com\nName Server: vipvdscom.mercury.orderbox-dns.com\nName Server: vipvdscom.venus.orderbox-dns.com\n\n## thisadsfor.us\n\n```\n\n-----\n\n```\nDomain Name: thisadsfor.us\nRegistry Domain ID: D46227974-US\nRegistrar WHOIS Server:\nRegistrar URL: www.tldregistrarsolutions.com\nUpdated Date: 2018-05-16T11:14:01Z\nCreation Date: 2014-08-08T15:29:34Z\nRegistry Expiry Date: 2019-08-07T23:59:59Z\nRegistrar: TLD Registrar Solutions Ltd.\nRegistrar IANA ID: 1564\nRegistrar Abuse Contact Email:\nRegistrar Abuse Contact Phone:\nDomain Status: ok https://icann.org/epp#ok\nRegistry Registrant ID: C46227970-US\nRegistrant Name: frank medison\nRegistrant Organization:\nRegistrant Street: Govanny ave 123\nRegistrant Street:\nRegistrant Street:\nRegistrant City: Brazil\nRegistrant State/Province:\nRegistrant Postal Code: 41111\nRegistrant Country: BR\nRegistrant Phone: +55.4552132\nRegistrant Phone Ext:\nRegistrant Fax:\nRegistrant Fax Ext:\nRegistrant Email: frankomedison1020@gmail.com\nRegistrant Application Purpose: P3\nRegistrant Nexus Category: C11\nRegistry Admin ID: C46227972-US\nAdmin Name: frank medison\nAdmin Organization:\nAdmin Street: Govanny ave 123\nAdmin Street:\nAdmin Street:\nAdmin City: Brazil\nAdmin State/Province:\nAdmin Postal Code: 41111\nAdmin Country: BR\nAdmin Phone: +55.4552132\nAdmin Phone Ext:\nAdmin Fax:\nAdmin Fax Ext:\nAdmin Email: frankomedison1020@gmail.com\nRegistry Tech ID: C46227971-US\nTech Name: frank medison\nTech Organization:\nTech Street: Govanny ave 123\nTech Street:\nTech Street:\nTech City: Brazil\nTech State/Province:\nTech Postal Code: 41111\nTech Country: BR\nTech Phone: +55.4552132\n\n```\n\n-----\n\n```\nTech Phone Ext:\nTech Fax:\nTech Fax Ext:\nTech Email: frankomedison1020@gmail.com\nName Server: ns-usa.topdns.com\nName Server: ns-uk.topdns.com\nName Server: ns-canada.topdns.com\n\n## Related reports\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-02-01 - Information about lnkr5, malware distributed via Chrome extensions.pdf"
    ],
    "report_names": [
        "2019-02-01 - Information about lnkr5, malware distributed via Chrome extensions.pdf"
    ],
    "threat_actors": [
        {
            "id": "ce10c1bd-4467-45f9-af83-28fc88e35ca4",
            "created_at": "2022-10-25T15:50:23.458833Z",
            "updated_at": "2025-03-27T02:00:55.475188Z",
            "deleted_at": null,
            "main_name": "APT34",
            "aliases": null,
            "source_name": "MITRE:APT34",
            "tools": [
                "netstat",
                "Systeminfo",
                "PsExec",
                "SEASHARPEE",
                "Tasklist",
                "Mimikatz",
                "POWRUNER",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "31e69945-6c1e-40c3-ba8e-a77e81dd142a",
            "created_at": "2024-05-01T02:03:08.047377Z",
            "updated_at": "2025-03-27T02:05:17.326452Z",
            "deleted_at": null,
            "main_name": "COBALT ULSTER",
            "aliases": [
                "ENT-11 ",
                "ITG17 ",
                "MERCURY ",
                "Mango Sandstorm ",
                "MuddyWater ",
                "STAC 1171 ",
                "Seedworm ",
                "Static Kitten ",
                "TEMP.Zagros ",
                "UNC3313 ",
                "Yellow Nix ",
                "Earth Vetala "
            ],
            "source_name": "Secureworks:COBALT ULSTER",
            "tools": [
                " Canopy",
                " CrackMapExec",
                " CredNinja",
                " Empire",
                " FORELORD",
                " Koadic",
                " LaZagne",
                " Ligolo",
                " MKL64",
                " Metasploit",
                " Mimikatz",
                " MiniDump",
                " Mori",
                " MuddyC2Go",
                " MuddyC3",
                " PhonyC2",
                " Plink",
                " PowGoop",
                " PowerStats",
                " RemoteUtilities",
                " Revsocks",
                " ScreenConnect",
                " SimpleHelp",
                " Small Sieve",
                " Syncro",
                " Venom Proxy",
                " WMIExec",
                "AnyDesk"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535602,
    "ts_updated_at": 1743041581,
    "ts_creation_date": 1653689063,
    "ts_modification_date": 1653689063,
    "files": {
        "pdf": "https://archive.orkl.eu/cb1a637b23eeeb546f672ecf08c42d765d43a156.pdf",
        "text": "https://archive.orkl.eu/cb1a637b23eeeb546f672ecf08c42d765d43a156.txt",
        "img": "https://archive.orkl.eu/cb1a637b23eeeb546f672ecf08c42d765d43a156.jpg"
    }
}