{
    "id": "2c74fd47-65da-450c-817a-c73025bf9ace",
    "created_at": "2023-06-05T02:06:04.373932Z",
    "updated_at": "2025-03-27T02:06:07.484815Z",
    "deleted_at": null,
    "sha1_hash": "efe5c59286b8251b9ce6462f87429edcb732774f",
    "title": "2023-05-09 - Managed XDR Investigation of Ducktail in Trend Micro Vision One",
    "authors": "",
    "file_creation_date": "2023-06-04T12:41:33Z",
    "file_modification_date": "2023-06-04T12:41:33Z",
    "file_size": 357180,
    "plain_text": "# Managed XDR Investigation of Ducktail in Trend Micro Vision One\n\n**[trendmicro.com/en_us/research/23/e/managed-xdr-investigation-of-ducktail-in-trend-micro-vision-one.html](https://www.trendmicro.com/en_us/research/23/e/managed-xdr-investigation-of-ducktail-in-trend-micro-vision-one.html)**\n\nMay 9, 2023\n\nMalware\n\n## Managed XDR Investigation of Ducktail in Trend Vision One™\n\nThe Trend Micro Managed XDR team investigated several Ducktail-related web browser\ncredential dumping incidents involving different customers.\n\nBy: Khristian Joseph Morales, Gilbert Sison\nMay 09, 2023\nRead time: ( words)\n\n[In July 2022, security researchers discovered an operation called Ducktail, in which threat](https://labs.withsecure.com/publications/ducktail)\nactors used information-stealing malware to target, individuals and employees who might\nhave access to Facebook business accounts. The perpetrators launched a spear-phishing\ncampaign via LinkedIn direct messages that are aimed at marketing and HR professionals.\nThis scheme would allow the threat actor behind Ducktail to take over Facebook business\naccounts and abuse the ad function for malicious advertising deployments. Given its growth\nand popularity, [LinkedIn has increasingly become a preferred option for social engineering](https://www.trendmicro.com/vinfo/ph/security/news/cybercrime-and-digital-threats/a-growing-goldmine-your-linkedin-data-abused-for-cybercrime)\nschemes and cybercriminal operations.\n\n[In March 2023, the Trend Micro Managed XDR team investigated several Ducktail-related](https://www.trendmicro.com/en_us/business/services/managed-xdr.html)\nweb browser credential dumping incidents involving different customers. As a result, we\ndiscovered the involvement of a file that gathers user data, such as browser information, IP\naddress, and geolocation, while also connecting to Facebook and Telegram domains. In this\nblog entry, we present our findings and technical analysis based on these incidents.\n\n**Technical Analysis**\n\nThe file name of the sample file, which includes a reference to a job opening for a marketing\ndirector (Figure 1), is clearly aimed at marketing professionals. It is also likely that it mentions\na higher leadership position to lure them into accessing the archive. Note that we only had\naccess to the download link, so we can’t definitively say how these links were delivered to\nthe target; however, it’s possible that LinkedIn messages were used given Ducktail’s\nhistorical use of the platform.\n\n\n-----\n\nThrough the file name, we were able to gather the contents (Figure 2) as well as the source\n(Figure 3) of the archive. Upon checking the domain, we found that the malicious file was\nhosted on iCloud, Apple’s cloud file-hosting service. Note that the URL is already inactive at\nthe time of writing.\n\nFigure 1. The archive name with a reference to a marketing director job position\n\nFigure 2. The content of the archive\n\nFigure 3. The file download link\nWe looked into the created processes and observed three processes total. Two of these —\none was for Microsoft Edge (Figure 5) and one was for Google Chrome (Figure 6) — are\nused to gather the IP addresses and geolocation of the victims.\n\nThe following argument is used for these processes:\n\n_--headless --disable-gpu --disable-logging --dump-dom hxxps://getip[.]pro_\n\nThe last process (Figure 7) is used to open a PDF file containing the description for the fake\njob position.\n\n\n-----\n\nFigure 4.\n\nBrowser processes spawned by Ducktail to gather information and mask its activities\n\nFigure 5. The spawned “Msedge.exe”\n\nfile used to gather user IP addresses and geolocation\n\nFigure 6. The spawned “Chrome.exe”\n\nfile used to gather user IP addresses and geolocation\n\nFigure 7. Ducktail opens a PDF file to\n\nmasquerade itself.\n\n\n-----\n\nWhile victims are busy reading the spawned PDF file, the malware is already gathering\n[browser credentials and connecting to their Facebook domain to gather Facebook-related](https://labs.withsecure.com/publications/ducktail)\ninformation. Once the data is gathered, the malware stores it in a text file as %User.\n\n_Temp%\\temp_update_data_8.txt. It is then exfiltrated using Telegram. Our observation is that_\nthe malware updates and sends the data every 10 minutes.\n\nFigure 8. Login data being copied to a temp file\n\nFigure 9. Connection to the “facebook.com” and\n\n“telegram.org” domains\n\nFigure 10. The malware stored as a text file\n\n\n-----\n\nFigure 11. Connecting to Telegram every 10 minutes to exfiltrate data\n**Hunting for other affected machines**\n\nOnce the threat connected to Telegram, we decided to search for other affected machines.\nUsing the Telegram IP address, we searched for other possible infections in the environment\nusing the Search app function of Trend Vision One™. The search yielded the following\nprocesses on a couple of machines:\n\n_C:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\Windows\\Start_\n_Menu\\Programs\\Startup\\MS Excel.exe_\n_C:\\Users\\<user>\\AppData\\Local\\Temp\\onefile<random>\\MicrosofOffice.exe_\n\nWe verified that all files were similar to the first detected file. Notably, the name of the\nbinaries in this case made it seem like they were office applications.\n\n**Security recommendations and Trend solutions**\n\nGiven the heavy use of social engineering lures by today’s threat actors, individual users and\norganizations should take great care to avoid selecting links or downloading files from\nunknown sources, whether they are sent via social media websites such as LinkedIn and\nFacebook, or through emails. The following best practices can help users avoid being\nvictimized by [spear-phishing attacks:](https://www.trendmicro.com/vinfo/us/security/definition/spear-phishing)\n\n1. Users should be cautious of unexpected or unsolicited emails. Before responding to or\n\nopening any attachments or links, users should first verify the sender’s identity.\n2. Users should avoid selecting suspicious links, especially if they are from unknown or\n\nsuspicious sources. Hovering over the link to see the URL can help recipients check if\na link leads to a legitimate website.\n3. Organizations should ensure that their employees are educated on spear phishing and\n\nhow to recognize and avoid it. Conducting regular training sessions can help keep\neveryone informed and up to date.\n\n[Managed XDR uses expert analytics to analyze vast amounts of data collected from various](https://www.trendmicro.com/en_us/business/services/managed-xdr.html)\nTrend technologies. XDR employs advanced AI and expert security analytics to correlate\ndata from both customer environments and global threat intelligence, resulting in fewer but\n\n\n-----\n\nmore accurate alerts and leading to quicker detection. Additionally, Vision One provides a\nsingle console that has prioritized alerts and is supported with guided investigation, making it\neasier for organizations to understand the full scope of an attack and its impact.\n\nWith [Trend One™, businesses can enhance their resilience with round-the-clock premium](https://www.trendmicro.com/en_us/business/services/service-one.html)\nsupport, managed XDR, and incident response services. This service includes automated\nupdates and upgrades for solutions, on-demand training, access to best practice guides, and\nthe ability to consult with cybersecurity experts.\n\n[Trend Micro Apex One™ combines threat detection, response, and investigation in one](https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\nsolution. It automatically detects and responds to many types of threats, such as\nransomware and fileless attacks. Apex One has advanced tools to detect and respond to\nattacks and can integrate with security information and event management (SIEM) systems.\n\n[Trend Cloud One™ – Endpoint Security and Workload Security protect endpoints, servers,](https://www.trendmicro.com/en_us/business/products/user-protection/endpoint-security.html)\nand cloud workloads through unified visibility, management, and role-based access control.\nThese services provide specialized security optimized for your diverse endpoint and cloud\nenvironments, which eliminate the cost and complexity of multiple point solutions.\n[Meanwhile, the Trend Cloud One™ – Network Security solution goes beyond traditional](https://www.trendmicro.com/en_my/business/products/hybrid-cloud/cloud-one-network-security.html)\nintrusion prevention system (IPS) capabilities, and includes virtual patching and postcompromise detection and disruption as part of a powerful hybrid cloud security platform.\n\n**Indicators of Compromise (IOCs)**\n\n[The indicators of compromise for this entry can be found here.](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/23/d/managed-xdr-investigation-of-ducktail-in-trend-micro-vision-one/iocs-managed-xdr-investigation-of-ducktail-int-trend-micro-vision-one.txt)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-05-09 - Managed XDR Investigation of Ducktail in Trend Micro Vision One.pdf"
    ],
    "report_names": [
        "2023-05-09 - Managed XDR Investigation of Ducktail in Trend Micro Vision One.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1685930764,
    "ts_updated_at": 1743041167,
    "ts_creation_date": 1685882493,
    "ts_modification_date": 1685882493,
    "files": {
        "pdf": "https://archive.orkl.eu/efe5c59286b8251b9ce6462f87429edcb732774f.pdf",
        "text": "https://archive.orkl.eu/efe5c59286b8251b9ce6462f87429edcb732774f.txt",
        "img": "https://archive.orkl.eu/efe5c59286b8251b9ce6462f87429edcb732774f.jpg"
    }
}