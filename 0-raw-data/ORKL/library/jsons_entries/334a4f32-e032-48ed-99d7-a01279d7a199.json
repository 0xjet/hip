{
    "id": "334a4f32-e032-48ed-99d7-a01279d7a199",
    "created_at": "2022-10-25T16:48:19.178617Z",
    "updated_at": "2025-03-27T02:16:26.434284Z",
    "deleted_at": null,
    "sha1_hash": "2eaf12b4859972d4017f16086f98412e16da9c95",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-01-11T07:40:44Z",
    "file_modification_date": "2018-01-11T07:40:44Z",
    "file_size": 267707,
    "plain_text": "# Star of Malware Galaxy\n\n###### By GReAT on February 16, 2015. 6:55 pm\n\n[Download “Equation group: questions and answers” PDF](https://securelist.com/files/2015/02/Equation_group_questions_and_answers.pdf)\n\n## “Houston, we have a problem”\n\nOne sunny day in 2009, Grzegorz Brzęczyszczykiewicz embarked on a1\n\nflight to the burgeoning city of Houston to attend a prestigious\n\ninternational scientific conference. As a leading scientist in his field, such\n\ntrips were common for Grzegorz. Over the next couple of days, Mr\n\nBrzęczyszczykiewicz exchanged business cards with other researchers\n\nand talked about the kind of important issues such high level scientists\n\nwould discuss (which is another way of saying “who knows?”). But, all\n\ngood things must come to an end; the conference finished and Grzegorz\n\nBrzęczyszczykiewicz flew back home, carrying with him many highlights\n\nfrom a memorable event. Sometime later, as is customary for such events,\n\nthe organizers sent all the participants a CDROM carrying many beautiful\n\npictures from the conference. As Grzegorz put the CDROM in his\n\ncomputer and the slideshow opened, he little suspected he had just\n\nbecame the victim of an almost omnipotent cyberespionage organization\n\nthat had just infected his computer through the use of three exploits, two\n\nof them being zero-days.\n\n## A rendezvous with the “God” of cyberespionage\n\n\nIt is not known when the Equation group began their ascent. Some of2\n\nthe earliest malware samples we have seen were compiled in 2002;\n\nhowever, their C&C was registered in August 2001. Other C&Cs used by\n\nthe Equation group appear to have been registered as early as 1996,\n\nwhich could indicate this group has been active for almost two decades.\n\nFor many years they have interacted with other powerful groups, such as\n\nthe Stuxnet and Flame groups; always from a position of superiority, as\n\nthey had access to exploits earlier than the others.\n\n\n#### The #EquationAPT group is probably one of the most sophisticated cyber attack groups in the world #TheSAS2015\n\n\n[Tweet](https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Fequation-the-death-star-of-malware-galaxy%2F68750%2F&text=The+%23EquationAPT+group+is+probably+one+of+the+most+sophisticated+cyber+attack+groups+in+the+world+%23TheSAS2015)\n\n\n-----\n\nperhaps even tens of thousands of victims throughout the world, in the\n\nfollowing sectors:\n\nGovernment and diplomatic institutions\n\nTelecoms\n\nAerospace\n\nEnergy\n\nNuclear research\n\nOil and gas\n\nMilitary\n\nNanotechnology\n\nIslamic activists and scholars\n\nMass media\n\nTransportation\n\nFinancial institutions\n\nCompanies developing encryption technologies\n\nTo infect their victims, the Equation group uses a powerful arsenal of\n\n“implants” (as they call their Trojans), including the following we have\n\ncreated names for: EQUATIONLASER, EQUATIONDRUG,\n\n[DOUBLEFANTASY, TRIPLEFANTASY, FANNY and GRAYFISH. No doubt](https://securelist.com/blog/research/68787/a-fanny-equation-i-am-your-father-stuxnet/)\n\nother “implants” exist which we have yet to identify and name.\n\n#### The #EquationAPT group interacted with other\n\n[Tweet](https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Fequation-the-death-star-of-malware-galaxy%2F68750%2F&text=The+%23EquationAPT+group+interacted+with+other+powerful+groups%2C+such+as+the+%23Stuxnet+and+%23Flame+groups+%23TheSAS2015) powerful groups, such as\n\n#### the #Stuxnet and #Flame groups #TheSAS2015\n\nThe group itself has many codenames for their tools and implants,\n\nincluding SKYHOOKCHOW, UR, KS, SF, STEALTHFIGHTER, DRINKPARSLEY,\n\n_STRAITACID, LUTEUSOBSTOS, STRAITSHOOTER, DESERTWINTER and_\n\n_GROK. Incredible as it may seem for such an elite group, one of the_\n\ndevelopers made the unforgivable mistake of leaving his username:\n\n“RMGREE5“, in one of the malware samples as part of his working folder:\n\n“c:\\users\\rmgree5\\“.\n\nPerhaps the most powerful tool in the Equation group’s arsenal is a\n\nmysterious module known only by a cryptic name: “nls_933w.dll“. It\n\nallows them to reprogram the hard drive firmware of over a dozen\n\ndifferent hard drive brands, including Seagate, Western Digital, Toshiba,\n\nMaxtor and IBM. This is an astonishing technical accomplishment and is\n\ntestament to the group’s abilities.\n\n\n[Tweet](https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Fequation-the-death-star-of-malware-galaxy%2F68750%2F&text=The+%23EquationAPT+group+interacted+with+other+powerful+groups%2C+such+as+the+%23Stuxnet+and+%23Flame+groups+%23TheSAS2015)\n\n\n-----\n\nattacks. One stands out: the Fanny worm. Presumably compiled in July\n\n2008, it was first observed and blocked by our systems in December\n\n2008. Fanny used two zero-day exploits, which were later uncovered\n\nduring the discovery of Stuxnet. To spread, it used the Stuxnet LNK exploit\n\nand USB sticks. For escalation of privilege, Fanny used a vulnerability\n\npatched by the Microsoft bulletin MS09-025, which was also used in one\n\nof the early versions of Stuxnet from 2009.\n\n_LNK exploit as used by Fanny_\n\n[It’s important to point out that these two exploits were used in Fanny](https://securelist.com/blog/research/68787/a-fanny-equation-i-am-your-father-stuxnet/)\n\nbefore they were integrated into Stuxnet, indicating that the Equation\n\ngroup had access to these zero-days before the Stuxnet group. The main\n\npurpose of Fanny was the mapping of air-gapped networks. For this, it\n\nused a unique USB-based command and control mechanism which\n\nallowed the attackers to pass data back and forth from air-gapped\n\nnetworks.\n\n#### Two zero-day exploits were used by the #EquationAPT\n\n[Tweet](https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Fequation-the-death-star-of-malware-galaxy%2F68750%2F&text=Two+zero-day+exploits+were+used+by+the+%23EquationAPT+group+before+they+were+integrated+into+%23Stuxnet+%23TheSAS2015) group before they were\n\n#### integrated into #Stuxnet #TheSAS2015\n\nIn the coming days, we will publish more details about the Equation\n\ngroup malware and their attacks. The first document to be published will\n\nbe a general FAQ on the group together with indicators of compromise.\n\nBy publishing this information, we hope to bring it to the attention of the\n\nITSec community as well as independent researchers, who can extend the\n\nunderstanding of these attacks. The more we investigate such\n\ncyberespionage operations, we more we understand how little we\n\nactually know about them. Together, we can lift this veil and work\n\ntowards a more secure (cyber-)world.\n\n\n-----\n\n## Indicators of compromise (“one of each”):\n\nName EquationLaser\n\nMD5 752af597e6d9fd70396accc0b9013dbe\n\nType EquationLaser installer\n\nCompiled Mon Oct 18 15:24:05 2004\n\nDisk from Houston “autorun.exe” with EoP\nName\n\nexploits\n\nMD5 6fe6c03b938580ebf9b82f3b9cd4c4aa\n\nType EoP package and malware launcher\n\nCompiled Wed Dec 23 15:37:33 2009\n\nName DoubleFantasy\n\nMD5 2a12630ff976ba0994143ca93fecd17f\n\nType DoubleFantasy installer\n\nCompiled Fri Apr 30 01:03:53 2010\n\nName EquationDrug\n\nMD5 4556ce5eb007af1de5bd3b457f0b216d\n\nType EquationDrug installer (“LUTEUSOBSTOS”)\n\nCompiled Tue Dec 11 20:47:12 2007\n\nName GrayFish\n\nMD5 9b1ca66aab784dc5f1dfe635d8f8a904\n\nType GrayFish installer\n\n\nCompiled: Fri Feb 01 22:15:21 2008\nCompiled\n\n(installer)\n\nName Fanny\n\nMD5 0a209ac0de4ac033f31d6ba9191a8f7a\n\nType Fanny worm\n\nCompiled Mon Jul 28 11:11:35 2008\n\nName TripleFantasy\n\nMD5 9180d5affe1e5df0717d7385e7f54386 loader\n\n\n-----\n\nType ba39212c5b58b97bfc9f5bc431170827\n\nCompiled various, possibly fake\n\nName _SD_IP_CF.dll – unknown\n\n\n.DLL)\n\nencrypted\n\npayload\n\n(.DAT)\n\n\nMD5 03718676311de33dd0b8f4f18cffd488\n\nDoubleFantasy installer + LNK exploit\nType\n\npackage\n\nCompiled Fri Feb 13 10:50:23 2009\n\nName nls_933w.dll\n\nMD5 11fb08b9126cdb4668b3f5135cf7a6c5\n\nType HDD reprogramming module\n\nCompiled Tue Jun 15 20:23:37 2010\n\nName standalonegrok_2.1.1.1 / GROK\n\nMD5 24a6ec8ebf9c0867ed1c097f4a653b8d\n\nType GROK keylogger\n\nCompiled Tue Aug 09 03:26:22 2011\n\n## C&C servers (hostnames and IPs):\n\n### DoubleFantasy:\n\n\nadvancing-technology[.]com\n\navidnewssource[.]com\n\nbusinessdealsblog[.]com\n\nbusinessedgeadvance[.]com\n\ncharging-technology[.]com\n\ncomputertechanalysis[.]com\n\nconfig.getmyip[.]com – SINKHOLED BY KASPERSKY LAB\n\nglobalnetworkanalys[.]com\n\nmelding-technology[.]com\n\nmyhousetechnews[.]com – SINKHOLED BY KASPERSKY LAB\n\nnewsterminalvelocity[.]com – SINKHOLED BY KASPERSKY LAB\n\nselective-business[.]com\n\nslayinglance[.]com\n\n\n-----\n\ntechasiamusicsvr[.]com – SINKHOLED BY KASPERSKY LAB\n\ntechnicaldigitalreporting[.]com\n\ntimelywebsitehostesses[.]com\n\nwww.dt1blog[.]com\n\nwww.forboringbusinesses[.]com\n\n\n### EquationLaser:\n\n\nlsassoc[.]com – re-registered, not malicious at the moment\n\ngar-tech[.]com – SINKHOLED BY KASPERSKY LAB\n\n\n### Fanny:\n\n\nwebuysupplystore.mooo[.]com – SINKHOLED BY KASPERSKY LAB\n\n\n### EquationDrug:\n\nnewjunk4u[.]com\n\neasyadvertonline[.]com\n\nnewip427.changeip[.]net – SINKHOLED BY KASPERSKY LAB\n\nad-servicestats[.]net – SINKHOLED BY KASPERSKY LAB\n\nsubad-server[.]com – SINKHOLED BY KASPERSKY LAB\n\nad-noise[.]net\n\nad-void[.]com\n\naynachatsrv[.]com\n\ndamavandkuh[.]com\n\nfnlpic[.]com\n\nmonster-ads[.]net\n\nnowruzbakher[.]com\n\nsherkhundi[.]com\n\nquik-serv[.]com\n\nnickleplatedads[.]com\n\narabtechmessenger[.]net\n\namazinggreentechshop[.]com\n\nforoushi[.]net\n\ntechnicserv[.]com\n\ngoldadpremium[.]com\n\nhonarkhaneh[.]net\n\nparskabab[.]com\n\ntechnicupdate[.]com\n\ntechnicads[.]com\n\ncustomerscreensavers[.]com\n\ndarakht[.]com\n\n\n-----\n\n247adbiz[.]net – SINKHOLED BY KASPERSKY LAB\n\nwebbizwild[.]com\n\nroshanavar[.]com\n\nafkarehroshan[.]com\n\nthesuperdeliciousnews[.]com\n\nadsbizsimple[.]com\n\ngoodbizez[.]com\n\nmeevehdar[.]com\n\nxlivehost[.]com\n\ngar-tech[.]com – SINKHOLED BY KASPERSKY LAB\n\ndownloadmpplayer[.]com\n\nhonarkhabar[.]com\n\ntechsupportpwr[.]com\n\nwebbizwild[.]com\n\nzhalehziba[.]com\n\nserv-load[.]com\n\nwangluoruanjian[.]com\n\nislamicmarketing[.]net\n\nnoticiasftpsrv[.]com\n\ncoffeehausblog[.]com\n\nplatads[.]com\n\nhavakhosh[.]com\n\ntoofanshadid[.]com\n\nbazandegan[.]com\n\nsherkatkonandeh[.]com\n\nmashinkhabar[.]com\n\nquickupdateserv[.]com\n\nrapidlyserv[.]com\n\n### GrayFish:\n\n\nad-noise[.]net\n\nbusiness-made-fun[.]com\n\nbusinessdirectnessource[.]com\n\ncharmedno1[.]com\n\ncribdare2no[.]com\n\ndowelsobject[.]com\n\nfollowing-technology[.]com\n\nforgotten-deals[.]com\n\nfunctional-business[.]com\n\nhousedman[.]com\n\nindustry-deals[.]com\n\nlistennewsnetwork[.]com\n\nphoneysoap[.]com\n\nposed2shade[ ]com\n\n\n-----\n\nrehabretie[.]com\n\nspeedynewsclips[.]com\n\nteatac4bath[.]com\n\nunite3tubes[.]com\n\nunwashedsound[.]com\n\n\n### TripleFantasy:\n\n\narm2pie[.]com\n\nbrittlefilet[.]com\n\ncigape[.]net\n\ncrisptic01[.]net\n\nfliteilex[.]com\n\nitemagic[.]net\n\nmicraamber[.]net\n\nmimicrice[.]com\n\nrampagegramar[.]com\n\nrubi4edit[.]com\n\nrubiccrum[.]com\n\nrubriccrumb[.]com\n\nteam4heat[.]net\n\ntropiccritics[.]com\n\n\n### Equation group’s exploitation servers:\n\n\nstandardsandpraiserepurpose[.]com\n\nsuddenplot[.]com\n\ntechnicalconsumerreports[.]com\n\ntechnology-revealed[.]com\n\n\n### IPs hardcoded in malware configuration blocks:\n\n\n149.12.71.2\n\n190.242.96.212\n\n190.60.202.4\n\n195.128.235.227\n\n195.128.235.231\n\n195.128.235.233\n\n195.128.235.235\n\n195.81.34.67\n\n202.95.84.33\n\n203 150 231 49\n\n\n-----\n\n210.81.52.120\n\n212.61.54.239\n\n41.222.35.70\n\n62.216.152.67\n\n64.76.82.52\n\n80.77.4.3\n\n81.31.34.175\n\n81.31.36.174\n\n81.31.38.163\n\n81.31.38.166\n\n84.233.205.99\n\n85.112.1.83\n\n87.255.38.2\n\n89.18.177.3\n\n\n### Kaspersky products detection names:\n\nBackdoor.Win32.Laserv\n\nBackdoor.Win32.Laserv.b\n\nExploit.Java.CVE-2012-1723.ad\n\nHEUR:Exploit.Java.CVE-2012-1723.gen\n\nHEUR:Exploit.Java.Generic\n\nHEUR:Trojan.Java.Generic\n\nHEUR:Trojan.Win32.DoubleFantasy.gen\n\nHEUR:Trojan.Win32.EquationDrug.gen\n\nHEUR:Trojan.Win32.Generic\n\nHEUR:Trojan.Win32.GrayFish.gen\n\nHEUR:Trojan.Win32.TripleFantasy.gen\n\nRootkit.Boot.Grayfish.a\n\nTrojan-Downloader.Win32.Agent.bjqt\n\nTrojan.Boot.Grayfish.a\n\nTrojan.Win32.Agent.ajkoe\n\nTrojan.Win32.Agent.iedc\n\nTrojan.Win32.Agent2.jmk\n\nTrojan.Win32.Diple.fzbb\n\nTrojan.Win32.DoubleFantasy.a\n\nTrojan.Win32.DoubleFantasy.gen\n\nTrojan.Win32.EquationDrug.b\n\nTrojan.Win32.EquationDrug.c\n\nTrojan.Win32.EquationDrug.d\n\nTrojan.Win32.EquationDrug.e\n\nTrojan.Win32.EquationDrug.f\n\nTrojan.Win32.EquationDrug.g\n\nTrojan.Win32.EquationDrug.h\n\nTrojan.Win32.EquationDrug.i\n\n\n-----\n\nTrojan.Win32.EquationLaser.a\n\nTrojan.Win32.EquationLaser.c\n\nTrojan.Win32.EquationLaser.d\n\nTrojan.Win32.Genome.agegx\n\nTrojan.Win32.Genome.akyzh\n\nTrojan.Win32.Genome.ammqt\n\nTrojan.Win32.Genome.dyvi\n\nTrojan.Win32.Genome.ihcl\n\nTrojan.Win32.Patched.kc\n\nTrojan.Win64.EquationDrug.a\n\nTrojan.Win64.EquationDrug.b\n\nTrojan.Win64.Rozena.rpcs\n\nWorm.Win32.AutoRun.wzs\n\n### Yara rules:\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n$ 2 “ ”\n\n\nrule apt_equation_doublefantasy_genericresource {\n\nmeta:\n\ncopyright = “Kaspersky Lab”\ndescription = “Rule to detect DoubleFantasy encoded config\nversion = “1.0”\nlast_modified = “2015-02-16”\nreference = “https://securelist.com/blog/”\n\nstrings:\n\n$mz=“MZ”\n$a1={06 00 42 00 49 00 4E 00 52 00 45 00 53 00}\n\n\n-----\n\n20\n21\n22\n\n\ncondition:\n\n(($mz at 0) and all of ($a*)) and filesize &lt; 500000\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nrule apt_equation_equationlaser_runtimeclasses {\n\nmeta:\n\ncopyright = “Kaspersky Lab”\ndescription = “Rule to detect the EquationLaser malware”\nversion = “1.0”\nlast_modified = “2015-02-16”\nreference = “https://securelist.com/blog/”\n\nstrings:\n\n$a1=“?a73957838_2@@YAXXZ”\n$a2=“?a84884@@YAXXZ”\n$a3=“?b823838_9839@@YAXXZ”\n$a4=“?e747383_94@@YAXXZ”\n$a5=“?e83834@@YAXXZ”\n$a6=“?e929348_827@@YAXXZ”\n\ncondition:\n\nany of them\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nrule apt_equation_cryptotable {\n\nmeta:\n\ncopyright = “Kaspersky Lab”\ndescription = “Rule to detect the crypto library used in E\nversion = “1.0”\nlast_modified = “2015-02-16”\nreference = “https://securelist.com/blog/”\n\nstrings:\n\n$a={37 DF E8 B6 C7 9C 0B AE 91 EF F0 3B 90 C6 80 85 5D 19\n\ncondition:\n\n$a\n}\n\n\n1 pseudonym, to protect the original victim’s identity >>\n\n2 the name “Equation group” was given because of their preference for\n\n\nsophisticated encryption schemes >>\n\n\n-----\n\n[GAUSS](https://securelist.com/all?tag=193) [SPYWARE](https://securelist.com/all?tag=143) [STUXNET](https://securelist.com/all?tag=94) [TARGETED ATTACKS](https://securelist.com/all?tag=53)\n\n### Related Posts\n\n\n####   \n\n\n###### Happy IR in the New Year!\n\n\n###### Kaspersky Security Bulletin: Review of the Year 2017\n\n\n###### Android commercial spyware\n\n\n##### THERE ARE 28 COMMENTS\n\nlynx\n\nPosted on February 17, 2015. 4:58 am\n\nOk, reading through NSA files that Der Spiegel released i found this:\n\n[http://www.spiegel.de/media/media-35661.pdf](http://www.spiegel.de/media/media-35661.pdf)\n\nThis is a file that shows the job postings for NSA interns, you can\n\nfind a NSA wiki link in the last page. And this is very interesting:\n\n(TS//SI//REL) Create a covert storage product that is enabled from a\n\nhard drive firmware modification. The ideia would be to modify the\n\nfirmware of a particular hard drive so that it normally only\n\nrecognizes half of its available space. It would report this size back\n\nto the operating system and not provide any way to access the\n\nadditional space.\n\nThis is a 2006 document, it took 8 years to finish this product,\n\nwhich is what kaspersky found.\n\nSo maybe you guys would easily find the malware if you revert the\n\nfirmware to a state prior of this date.\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=374875#respond)\n\n\nBildos\n\nPosted on February 17, 2015. 6:43 am\n\nFirmware – definitely it’s something what AV should start to scan /\n\ncheck.\n\nYes it’s not easy task but absolutely needed to provide protection.\n\nWhat’s required to check? Firmware modifications- to verify if we\n\nhave version in 100% confirmed by vendor.\n\n\n-----\n\npj\n\nPosted on February 17, 2015. 9:13 am\n\nI’ve read that most hard drive firmware is write-only\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=375078#respond)\n\n\n[Nigel Tolley](http://www.safeplaces.co.uk/)\n\nPosted on February 17, 2015. 1:14 pm\n\nI think you may have got that backward. But\n\nit’s wrong either way.\n\nThe whole point of this is that they (NSA)\n\nhave worked out how to re-write the HDD\n\nfirmware, which is usually just about\n\nimpossible. Then it is read every time the\n\ndisk is used, if they want. Your AV can’t see it,\n\n& it wouldn’t shock me if they had figured\n\nout a secondary way to send the data out.\n\nIn fact, if they’ve secretly halved the disc\n\ncapacity they could just store the\n\nunencrypted data on the half you can’t\n\ndelete!\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=375271#respond)\n\n\nMegaByte\n\nPosted on September 24, 2016. 8:51\n\nam\n\nWe can use the whole HD. There\n\nis a percentage of the HD that is\n\nnot usable. Perhaps the NSA\n\nhides out (Or could hide out) in\n\nthat unusable space?\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=701675#respond)\n\n\nCostin Raiu\n\nPosted on February 19, 2015. 12:57 pm\n\nThe problem comes from the fact there’s a standardized\n\nAPI to write the firmware but no API to read it. This\n\nmeans we can’t easily check if a HDD has been\n\ncompromised. Several suggested solutions from our\n\nside include: firmware signing and checking on the disk\n\nside, firmware write-protect switch on the HDD and the\n\nability to read the firmware easily and check for\n\nalterations.\n\n\n-----\n\nRoger Jollie\n\nPosted on February 17, 2015. 3:42 pm\n\nI’m surprised someone like OnTrack or other companies that\n\nrecover hard drives have not found items on this “empty space”.\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=375357#respond)\n\n\nMike Smitheee\n\nPosted on February 17, 2015. 7:57 pm\n\nNot really surprising when you think about it. If the\n\nworld-wide infection rate is in the 10’s of thousands,\n\nthen lets assume that 10,000 of those are in the US,\n\nwhere data recovery is most prevalent. If that’s the case,\n\nthen there would still only be about a 0.004% chance of\n\na particular machine being infected. Now, if you take\n\nthat and extrapolate out the likelihood of the particular\n\ninfected machine requiring a DRS, which is extremely\n\nexpensive and would only be used in those cases where\n\ncritical data was unrecoverable, had not been backed up\n\nin some other fashion, and/or was not otherwise\n\nreplicate-able by the user.\n\nIf we roll that to oh say 1 in 100 which is EXTREMELY\n\nlow, then you’re now looking at a 0.00004% chance or\n\nabout a 1 in 2.5million, that a DRS service would even\n\nlay their hands on an infected device. Then… they have\n\nto actually notice it.\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=375520#respond)\n\n\nRyan\n\nPosted on February 17, 2015. 7:40 pm\n\nCan Kaspersky give a timeline of discoveries? Where you aided by\n\nthe discovery of BadUSB?\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=375503#respond)\n\n\nGSK\n\nPosted on February 17, 2015. 7:56 pm\n\nIf Kroll OnTrack ever did run across this, they probably wouldn’t\n\nreport it. They are a DoD cleared contractor and are used to recover\n\ndata from damaged classified hard drives.\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=375518#respond)\n\n\n-----\n\nPosted on February 17, 2015. 9:33 pm\n\nMaybe you never heard about Rakshasa malware:\n\nhttp://www.extremetech.com/computing/133773-rakshasa-the\nhardware-backdoor-that-china-could-embed-in-every-computer\n\nIt can hide himself also in your graphic card bios and, most\n\nimportant, it CANNOT BE REMOVED.\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=375587#respond)\n\n\ndave\n\nPosted on February 17, 2015. 10:32 pm\n\nI wonder what the situation on Linux is. Obviously the new firmware\n\nwill only be controlled by a windows only stack of exploits even in a\n\ndual boot situation, but is Kaspersky aware of any possible\n\ntampering of binary distributed packages in linux major\n\ndistributions, so that an equivalent infection can act on a linux\n\nsystem ? what is the probability of that ?\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=375613#respond)\n\n\nwondering\n\nPosted on March 4, 2015. 2:59 pm\n\nI’ve thought that perhaps Linux’s main backdoor now is\n\ncalled “systemd” – since it’s VERY odd to see such rapid\n\nadoption of an unknown package(s)\n\ncurated/written/compiled by only a few people whose\n\ngoals are not clear. And with only approx. 3 major Linux\n\nbases (Fedora, Debian, etc) the NSA etc only had to\n\nconvince one of them to get a back door(s) included as\n\na “dependency” and now, poof, you have the same\n\nproblem as Windows in loading components you can’t\n\ncompletely check, an enlarged attack surface, and\n\npartially closed code.\n\nPerhaps I am wrong, or slightly off as to where these\n\nbackdoors are in Linux, but if I were a betting man then\n\nsystemd is to me Linux’s downfall.\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=410271#respond)\n\n\nPaul Williams\n\nPosted on February 18, 2015. 1:07 am\n\nRoger, the kinds of targets tat Equation are aiming to infect (high\nvalue data) are probably not the sorts of targets who will happily\n\ngive up a hard drive containing high value data to companies such\n\nas OnTrack. With only a few tens of thousands of infected targets\n\n\n-----\n\nLow Value Target (but a target nonetheless)\n\nPosted on March 16, 2015. 5:53 pm\n\nPaul, I found out recently from a security professional –\n\na very reliable source, who has examined samples from\n\nmy systems directly on several occasions – that the\n\nmalware complex about which I have been fighting and\n\ncollecting forensic evidence (in my own amateurish but\n\ntenacious fashion) for the better part of a decade…it\n\nstrongly resembles this type of coordinated\n\n“omnipotent” attack.\n\nEveryone thought I was crazy until last month (which I\n\nam, but it has become clear from evidence and analysis\n\nof trusted advisers that my problems are not imagined)\n\n– everyone kept telling me it was physically impossible\n\nthat a boot/rootkit could and would flash firmware\n\n(definitely many HDD’s, definitely router firmware & a\n\ncustomized install of a new router microOS, definitely\n\nsome/all of a motherboard’s firemware, and – for\n\ncertain – at least one AIO printer’s firmware) and deny\n\nme access to my own BIOS’s with the use of fake\n\nbios’s… starting when I first started documenting my\n\ndigital woes back in 2009-2010 or so. Symptoms\n\nof`infection in my situation include infected image files,\n\ninfected .lnk’s/.ico’s (despite disabled autorun), ghost\n\ndrives, computers booting from ramdisks (when no\n\nstorage media was connected, or booting from ramdisk\n\nOS despite boot menu instructions to boot from a live\n\nrescue disk instead), HDD’s refusing to wipe (DBAN\n\nfailures, among other methods tried) and so on…\n\nI just wish I knew how to reach reputable/trustworthy\n\n(verifiably so) security researchers in the Pacific\n\nNorthwest, to give copies of all the hard (literally –\n\npaper printouts of camera images and dump files)\n\nevidence I have of my own situation, to maybe give\n\nmyself hope I will eventually be able to “pwn” MY OWN\n\nDEVICES back under my own control someday. I’m tired\n\nof running only zombies in this house. Or at least help\n\nothers avoid my own fate in the future. Who can\n\nsomeone turn to, when you can’t even trust a search\n\nengine, e-mail provider, cell phone service, or the postal\n\nservice anymore?\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=441410#respond)\n\n\nblackwater\n\n\n-----\n\nnsa isnt the only one capable of doing this sort of thing\n\nwhat im wondering is\n\nwhy you make claims that this malware would be so hard to remove\n\nwhen you can simply use publically accessible tools to re-flash\n\nclean working firmware to the hdd microcontroller, have you\n\nseriously not done research on this or are you just trying to spread\n\npropaganda by making users believe there is nothing that can be\n\ndone\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=375831#respond)\n\n\nCostin Raiu\n\nPosted on February 19, 2015. 1:02 pm\n\nThanks for your comment. Based on our experience, re\nflashing the firmware doesn’t seem to always help.\n\nThere are certain areas in the firmware which do not get\n\nupdated. In another case, the firmware update didn’t\n\nwork because it was “already the latest version”. Yet\n\nanother problem is that it’s not so healthy to keep\n\nreflashing the firmware every day and leave under a\n\nconstant fear that it has been infected since the last re\nflash. I think we need reliable means to check if the\n\nfirmware was compromised and better defense against\n\nsuch attacks instead of wearing down the ROM of your\n\nHDD.\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=376770#respond)\n\n\nMoritz Kroll\n\nPosted on February 18, 2015. 1:06 pm\n\nYou forgot moretimeads.com in the list of DoubleFantasy CnCs,\n\nalthough you sinkholed it yourself �\n\nSHA256:\n\na2a9e948fb829685d0a9161cac845fd0dfa943d023a6b2faab205fa8664b7c26\n\n\n�\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=376057#respond)\n\n\nJoey\n\nPosted on February 19, 2015. 3:59 am\n\nSo if it’s based on Israel and the US’s prior malware, and it’s not\n\ndirected against Israel but Islam, and nanotechnology, with all due\n\nrespect, this is another Israel/US joint. Who stands to gain? And who\n\ninvented it? Therefore who is ultimately responsible?\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=376489#respond)\n\n\n-----\n\nPosted on February 19, 2015. 5:40 pm\n\nGreat Job!\n\nWill the german people come back to the paper, pencil and rubber ?\n\nOnly time will tell !\n\nhalt\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=376945#respond)\n\n\nRussel Future\n\nPosted on February 19, 2015. 5:56 pm\n\nThx to K. Group for this research and result. Flashed HDD firmware\n\ncannot typically be read. Its a one-way action, so it is an obvious\n\ngood place to hide malware. I am interested in “Joey”‘s questions.\n\nWho invented this suite, and as my old legal friends say, cui bono? If\n\nthis is another USA-Israel joint venture, it would be useful and\n\nhelpful to have proof, or at least some direct evidence. We will be\n\nhaving an election soon in my country, and this sort of risk factor to\n\nour economy will be an election issue. Most folks don’t care about\n\nsecurity and spycraft issues until they are on the wrong side of a bad\n\nscenario. But for folks who do care, they care deeply. There is\n\nsuspicion by some folks that our financial markets have been\n\ncompromised by modern methods. Information about this exploit\n\nmakes it very clear that this concern is not idle fear.\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=376953#respond)\n\n\nShane\n\nPosted on March 16, 2015. 5:19 pm\n\nI am skeptical of the idea that this comes from any\n\ngovernment in particular.\n\nFor one, the coding is simply too smooth. DoD, CIA, and\n\nNSA cyber-anything has lagged behind the civilian world\n\nsince the 90s. The coding was almost certainly a private\n\nentity operating under contract or from a private group\n\nof benefactors (the targeting of Iran despite the fickle\n\nnature of DC politics suggests another principle is at\n\nplay).\n\nThe NSA also lacks the human intelligence resources to\n\nplant a virus on a commercial printing of CDs. I contend\n\nthat private entities have supplanted even the CIA in\n\ndeveloping human intelligence and operator networks.\n\nSuch networks would also be easily capable of\n\naccessing government archives of source code samples.\n\nThe government rarely understands the market value of\n\nthe things it so poorly secures after forcing them from\n\n\n-----\n\nby small private entities whose admins don t even need\n\nto know what it is for.\n\nThe data retrieved is valuable to many different private\n\nentities. Northrop would be interested. Boeing, Sukhoi,\n\nMikoyan-Greivich… any large defense contractor would\n\nbe willing to pay for information related to the\n\ntopography of a network or some of the data they are\n\nworking on.\n\nRemember when Lockheed suffered from the massive\n\ndata breech related to the F-35? Then the new super\nsized F-35 China started playing with?\n\nThe recent ruling by the FCC is typical government\n\nintrusion – but the sudden nature of it, I would argue, is\n\nan attempt to get a hold on the call-back servers for\n\nthese types of threats. Though it may not be effective –\n\nit is classic government logic that I would argue\n\nindicates they are -not- in control of these groups and\n\nhonestly have no idea how it is they are accomplishing\n\nwhat they are.\n\nFurther evidence can be supplied by a war-games trial\n\nrun between the Active Duty Navy ITs and the Reserve\nside ITs – who were civilian IT security, as well.\n\nThe Active duty didn’t even know what hit them – had\n\nno idea how they were compromised.\n\nObviously – it is mostly conjecture…\n\nBut if you look at the platform, it is a virtual “Sword of\n\nDamocles” – it can sit quietly on systems for years –\n\ngiving information that is marketable while also giving\n\nthe operator the ability to carry out “hits” for no\n\nadditional cost. If a customer is willing to pay to embed\n\na virus – or someone else has a virus they wish for you\n\nto embed – then you have the perfect delivery platform.\n\nA state tends to have a more results-driven approach –\n\nusing operators to physically infect a system with a\n\nsingle objective. Ten years is a -long- time in politics,\n\nand a project with a pay-off 8 years down the line gets\n\nthe seating official 3 terms behind yours the cookie.\n\nThe more I look at it – the more this looks to be a\n\nbusiness model.\n\n“But only in Iran?”\n\nIran has no choice but to turn to outside IT sources like\n\nKaspersky. Boeing could be rife with this thing and we\n\nwould never know it unless news of major data\n\n\n-----\n\nplay as the U.S. is – or as Blackwater/XE is regarding a\n\nplanned operation.\n\nThere is a lot more money to be made in cyber\nespionage than the government has to waste on it.\n\nNot to say that the government wouldn’t be interested\n\nin being a customer of such a business….\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=441338#respond)\n\n\nMarki\n\nPosted on February 19, 2015. 7:26 pm\n\nVery interesting thing to silently flash parts of a HDD firmware – I\n\nhad a short peek into the circulating samples of EquationDrug and\n\nGrayFish. I couldn’t find a place where stands “SAMSUNG” or “WDC”\n\nin any of these samples.\n\nTo be sure that I grabbed valid files I also looked for the string\n\n“GROK” in another sample and found it – so the collection seems\n\nvalid …\n\nSo – what part of what sample is shown in the report on page 17 ??\n\nappreciate any feedback\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=377008#respond)\n\n\nCostin Raiu\n\nPosted on March 4, 2015. 8:45 am\n\nHi Marki,\n\nThanks for your comment! Unlike the “GROK” string, the\n\nstrings from NLS_933W are encrypted, so you’d have to\n\ndecrypt them first. We provide an MD5 for NLS_933W in\n\nthe blog.\n\nGood luck!\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=409730#respond)\n\n\n[Theodis Butler](http://megalithtechnologies.com/)\n\nPosted on February 21, 2015. 5:51 am\n\nHoly Shit\n\nA. Nolen\n\nPosted on March 23, 2015. 4:04 pm\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=380875#respond)\n\n\n-----\n\nachievements Costin; congrats to you and the team at Kaspersky.\n\nHave you or Kaspersky Labs received any blowback from either the\n\nUS government, or any organization, for making these revelations?\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=458300#respond)\n\n\nArturo Spinoza\n\nPosted on March 23, 2015. 6:58 pm\n\n‘Holy Shit’ doesn’t begin to describe it. Kaspersky is right, we need\n\nto band together to fight this.\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=458592#respond)\n\n\nalexander\n\nPosted on April 12, 2015. 5:58 pm\n\nHaving read this and further articles about Equation group, I made a\n\nconclusion that the user computer security should be considered\n\ncomplexly from from the computer turning on to standard user\n\nactions in the operating system.\n\nThat is why I want to know answers on these 10 questions:\n\n1. Can usual antivirus check find all the harmful software of\n\nEquation Group family, if the check has tough options?\n\n2. Can Equation group software patch system drivers, hard drive\n\nfirmware and make other changes in OS booting when Secure boot\n\nis on and Kaspersky Internet Security with ELAM support is used?\n\n3. If they can, are these changes fixed under question 2 conditions?\n\n4. If the software acts successfully and no changes fixed by Secure\n\nboot or KIS, can TPM module fix them?\n\n5. Do the components of Equation Group interact in the Oeration\n\nsystem environment or within internal family structure (directly\n\nbetween each other)?\n\n6. Will new publications about the Grayfish and its main differences\n\nfrom the Equationdrug be?\n\n7. Please give the list of hard drives models with changed firmware.\n\n8. Can the core and components of the Equation Group mask\n\nthemselves and other components to become unvulnerable for\n\nproactive defence and behavioral analysis? This is about all the\n\ncomponents and any antivirus or antispyware. First of all I mean\n\nsoftware control function of Kis or HIPS in the Comodo Internet\n\nSecurity.\n\n9. What signs can be used to define the patching of the drive\n\nfirmware exactly or with high possibility? Can it be some files in the\n\nsystem or virtual file system?\n\n10. Can the such software as 7datarecovery or other like it find such\n\na virtual system?\n\n11. Does Kaspersky Laboratory know about the development and\n\n\n-----\n\npatching by hard drives producers?\n\n\n[REPLY](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/?replytocom=490254#respond)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.02.16.equation-the-death-star/blog_equation-the-death-star.pdf"
    ],
    "report_names": [
        "blog_equation-the-death-star"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c91e335e-42be-48d9-96b5-ba56749a723b",
            "created_at": "2022-10-25T16:07:23.458346Z",
            "updated_at": "2025-03-27T02:02:09.813395Z",
            "deleted_at": null,
            "main_name": "CIA",
            "aliases": [
                "Central Intelligence Agency"
            ],
            "source_name": "ETDA:CIA",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "08623296-52be-4977-8622-50efda44e9cc",
            "created_at": "2023-01-06T13:46:38.549387Z",
            "updated_at": "2025-03-27T02:00:02.859535Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "Tilded Team",
                "EQGRP",
                "G0020"
            ],
            "source_name": "MISPGALAXY:Equation Group",
            "tools": [
                "EquationLaser",
                "EquationDrug",
                "DoubleFantasy",
                "TripleFantasy",
                "GrayFish"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2d9fbbd7-e4c3-40e5-b751-27af27c8610b",
            "created_at": "2024-05-01T02:03:08.144214Z",
            "updated_at": "2025-03-27T02:05:17.419705Z",
            "deleted_at": null,
            "main_name": "PLATINUM COLONY",
            "aliases": [
                "Equation Group "
            ],
            "source_name": "Secureworks:PLATINUM COLONY",
            "tools": [
                " EquationDrug",
                " EquationLaser",
                " Fanny",
                " GrayFish",
                " TripleFantasy",
                "DoubleFantasy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e0fed6e6-a593-4041-80ef-694261825937",
            "created_at": "2022-10-25T16:07:23.593572Z",
            "updated_at": "2025-03-27T02:02:09.879892Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "APT-C-40",
                "Platinum Colony",
                "Tilded Team"
            ],
            "source_name": "ETDA:Equation Group",
            "tools": [
                "Bvp47",
                "DEMENTIAWHEEL",
                "DOUBLEFANTASY",
                "DanderSpritz",
                "DarkPulsar",
                "DoubleFantasy",
                "DoubleFeature",
                "DoublePulsar",
                "Duqu",
                "EQUATIONDRUG",
                "EQUATIONLASER",
                "EQUESTRE",
                "Flamer",
                "GRAYFISH",
                "GROK",
                "OddJob",
                "Plexor",
                "Prax",
                "Regin",
                "Skywiper",
                "TRIPLEFANTASY",
                "Tilded",
                "UNITEDRAKE",
                "WarriorPride",
                "sKyWIper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1515656444,
    "ts_modification_date": 1515656444,
    "files": {
        "pdf": "https://archive.orkl.eu/2eaf12b4859972d4017f16086f98412e16da9c95.pdf",
        "text": "https://archive.orkl.eu/2eaf12b4859972d4017f16086f98412e16da9c95.txt",
        "img": "https://archive.orkl.eu/2eaf12b4859972d4017f16086f98412e16da9c95.jpg"
    }
}