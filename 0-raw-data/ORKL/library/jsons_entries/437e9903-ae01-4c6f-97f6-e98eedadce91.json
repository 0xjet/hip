{
    "id": "437e9903-ae01-4c6f-97f6-e98eedadce91",
    "created_at": "2023-01-12T15:00:36.862848Z",
    "updated_at": "2025-03-27T02:11:50.504938Z",
    "deleted_at": null,
    "sha1_hash": "14403defb8b851a46096ed167dfd2aa8dbe5234a",
    "title": "2013-03-14 - New Uyghur and Tibetan Themed Attacks Using PDF Exploits",
    "authors": "",
    "file_creation_date": "2022-05-28T04:49:57Z",
    "file_modification_date": "2022-05-28T04:49:57Z",
    "file_size": 424330,
    "plain_text": "# New Uyghur and Tibetan Themed Attacks Using PDF Exploits\n\n**[securelist.com/new-uyghur-and-tibetan-themed-attacks-using-pdf-exploits/35465](https://securelist.com/new-uyghur-and-tibetan-themed-attacks-using-pdf-exploits/35465)**\n\nAuthors\n\nIgor Kuznetsov\n\n[On Feb 12th 2013, FireEye announced the discovery of an Adobe Reader 0-day exploit](https://www.fireeye.com/blog/threat-research/2013/02/in-turn-its-pdf-time.html)\nwhich is used to drop a previously unknown, advanced piece of malware. We called this new\nmalware “ItaDuke” because it reminded us of Duqu and because of the ancient Italian\ncomments in the shellcode copied from Dante Alighieri’s “Divine Comedy”.\n\nPreviously, we posted about another campaign hitting Governments and other institutions,\nnamed Miniduke, which was also using the same “Divine Comedy” PDF exploits.\n\nIn the meantime, we’ve come by other attacks which piggyback on the same high level\nexploit code, only this time the targets are different: Uyghur activists.\n\nTogether with our partner at AlienVault Labs, we analyzed these new exploits. For their blog,\n[which includes Yara rules and industry standard IOC’s, please read [here]. For our analysis,](https://www.alienvault.com/blogs/labs-research/latest-adobe-pdf-exploit-used-to-target-uyghur-and-tibetan-activists)\nplease read below.\n\n\n-----\n\n## The new attacks\n\nA few days ago, we observed several PDF files which carry the CVE-2013-0640/641\n(ItaDuke) exploits. Some of the MD5s and filenames include:\n\n7005e9ee9f673edad5130b3341bf5e5f 2013-Yilliq Noruz Bayram Merik isige Teklip.pdf\nd00e4ac94f1e4ff67e0e0dfcf900c1a8 .pdf (joint_letter.pdf)\nad668992e15806812dd9a1514cfc065b arp.pdf\n\nThe Kaspersky detection name for these exploits is Exploit.JS.Pdfka.gjc.\n\nIf the exploit is successful, the PDFs show a clean, “lure” document to the user:\n\n\n-----\n\nThe first document (2013-Yilliq Noruz Bayram Merik isige Teklip.pdf) refers to a New Years\nparty invitation. The second one, “arp.pdf”, is an authorization to request a reimbursement,\nfor a Tibetan activist group.\n\nThe Javascript exploit code has a large comment block prepended, which was probably\nincluded to avoid detection by certain anti-malware programs.\n\n\n-----\n\nThe comment block and the exploit is exactly the same among all analyzed PDF files.\nInterestingly, the “sHOGG” string obfuscation function from Itaduke has been removed. In\naddition, some of the obfuscation for variable initialization has been removed as well:\n\nAll documents drop the same malware, detected by Kaspersky as Trojan.Win32.Agent.hwoo\nand Trojan.Win32.Agent.hwop, which is interesting: this is one of the rare cases when the\nsame threat actor hits both Tibet and Uyghur activists at exactly the same time. It is possible\n\n\n-----\n\n[this was done in regards to a human rights conference which is taking place in Geneva](http://www.thetibetpost.com/en/news/international/3142-conference-examining-chinese-leadership-to-be-held-in-switzerland)\nbetween 11-13 March, 2013.\n\n## The backdoor\n\nThe PDF malware dropper creates a file named “C:Documents and\nSettingsAdministratorLocal SettingsTempAcroRd32.exe” and runs it. AcroRd32.exe has a PE\ncompilation timestamp of “Wed Jul 11 05:39:45 2012”.\n\n“AcroRd32.exe” contains an encrypted block with the final payload, an 8KB backdoor, which\nis dropped as “clbcatq.dll” and run via Windows Update. The block can be easily noticed\ninside the backdoor by a trained eye:\n\nThe block is encrypted with a simple xor + add algorithm. Here’s the decryption algorithm for\nthe final payload:\n\nchar key[]=”0l23kj@nboxu”;\na=key[i&7] + 6;\n\nbuf[i]=(buf[i]^a) + a;\n\nThe final backdoor (clbcatq.dll) is 9728 bytes in size. It was compiled on “Wed Jul 11\n05:39:39 2012”. The backdoor connects to its C&C server and requests further data using\nHTTP GET requests. The response from the server is expected to be a slightly encrypted\nDLL, which is then loaded and called by exports “InfectFile” and “GetWorkType”.\n\n\n-----\n\nFor all the servers, the malware makes a request to “/news/show.asp”, using a custom agent\nstring of “Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)”.\n\nAt the moment, all the domains point to the same IP address: 60.211.253.28. The server is\nlocated in China, in Shandong province:\n\nThe domains “micrsofts.com” and “hotmal1.com” appear to have been registered by the\nsame person, although with very small differences in the registration data:\n\nRegistrant Contact:\nGW SY\nli wen li wen (lcb_jn@sina.com)\nzq dj\njiningshi, shandongsheng, cn 272000\nP: +86.05372178000 F: +86.05372178000\nRegistrant Contact:\nGW SY\nli wen li wen (lcb_jn@sina.com)\nzq dj\nshixiaqu, beijingshi, cn 272000\nP: +86.02227238836601 F: +86.02227238836601\n\n## Stage 2\n\n\n-----\n\nThe command and control server will reply with a 300K backdoor, which is sent in encrypted\nform. Here’s how it looks as sent by server:\n\nThe encryption is a sub 0x11 followed by a xor 0x11. Once decrypted, we get the malware\ndropper, which was compiled on “Wed Jul 11 06:52:48 2012”. This “stage 2” malware\ndropper is heuristically detected by Kaspersky products as HEUR:Trojan.Win32.Generic.\n\nThe stage 2 dropper will install two files in system32wbem:\n\n4BA5E980.PBK – 204,932 bytes (MD5 varies)\nMSTD32.DLL – 31,880 bytes (MD5: 92f15c2b82e81e8ae47e361b3ecb5add)\n\nMSTD32.DLL is signed by “YNK JAPAN Inc”, with a certificate that was revoked by the\nissuer:\n\n\n-----\n\nThis technique reminds us of the method used by the malware from the Tilded platform\n(Duqu, Stuxnet) for starting up (small signed loader which reads and executes main body\nkept in encrypted form).\n\nOur colleagues from Norman have previously written (http://blogs.norman.com/2011/securityresearch/invisible-ynk-a-code-signing-conundrum) about this compromised certificate in\nrelation to Hupigon and other malware.\n\nThe final stage malware is known by our products as Trojan.Win32.Swisyn and has pretty\nextensive functionality for data stealing.\n\n## Conclusions\n\n[We have previously published blogs about targeted attacks against Tibetan and Uyghur](https://securelist.com/cyber-attacks-against-uyghur-mac-os-x-users-intensify/64259/)\nactivists.\n\nThe threat actors behind these attacks are very active and continuously use new methods\nand new exploits to attack their victims. We have previously seen the use of CVE-2013-0158\nor CVE-2010-3333, in addition to exploits for Mac OS X, taking advantage of CVE-20090563.\n\n\n-----\n\nThe PDF exploit originally discovered by FireEye is the first known exploit capable of\nbypassing the Adobe Reader X sandbox. Due to this advanced capability, it is extremely\nvaluable to any attacker. Although it was probably developed for (or by) use of a nation state\noriginally, we now see it being copied and reused by other threat actors. This is becoming a\ncommon procedure nowadays and we can expect more such piggybacking or exploit stealing\nin the future.\n\n[Adobe](https://securelist.com/tag/adobe/)\n[Adobe PDF](https://securelist.com/tag/adobe-pdf/)\n[Backdoor](https://securelist.com/tag/backdoor/)\n[JavaScript](https://securelist.com/tag/javascript/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n[Vulnerabilities and exploits](https://securelist.com/tag/vulnerabilities-and-exploits/)\n[Zero-day vulnerabilities](https://securelist.com/tag/zero-day-vulnerabilities/)\n\nAuthors\n\nIgor Kuznetsov\n\nNew Uyghur and Tibetan Themed Attacks Using PDF Exploits\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2013/2013-03-14 - New Uyghur and Tibetan Themed Attacks Using PDF Exploits.pdf"
    ],
    "report_names": [
        "2013-03-14 - New Uyghur and Tibetan Themed Attacks Using PDF Exploits.pdf"
    ],
    "threat_actors": [
        {
            "id": "9a58d7bb-dd32-41bc-804e-500ef7550cf8",
            "created_at": "2023-01-06T13:46:39.131811Z",
            "updated_at": "2025-03-27T02:00:03.004067Z",
            "deleted_at": null,
            "main_name": "ItaDuke",
            "aliases": [
                "DarkUniverse",
                "SIG27"
            ],
            "source_name": "MISPGALAXY:ItaDuke",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535636,
    "ts_updated_at": 1743041510,
    "ts_creation_date": 1653713397,
    "ts_modification_date": 1653713397,
    "files": {
        "pdf": "https://archive.orkl.eu/14403defb8b851a46096ed167dfd2aa8dbe5234a.pdf",
        "text": "https://archive.orkl.eu/14403defb8b851a46096ed167dfd2aa8dbe5234a.txt",
        "img": "https://archive.orkl.eu/14403defb8b851a46096ed167dfd2aa8dbe5234a.jpg"
    }
}