{
    "id": "cbc1481e-21f3-417e-b56d-5d40772697db",
    "created_at": "2023-01-12T15:00:21.282346Z",
    "updated_at": "2025-03-27T02:05:45.328602Z",
    "deleted_at": null,
    "sha1_hash": "a9bdef73d2646b143db9d10d6392a4d1def63ee5",
    "title": "2017-10-12 - Emotet beutet Outlook aus",
    "authors": "",
    "file_creation_date": "2022-05-27T23:13:39Z",
    "file_modification_date": "2022-05-27T23:13:39Z",
    "file_size": 234416,
    "plain_text": "# Emotet beutet Outlook aus\n\n**gdata.de/blog/2017/10/30110-emotet-beutet-outlook-aus**\n\n12.10.2017\n\nG DATA Blog\nEmotet ist seit mehreren Jahren eine bekannte Trojaner-Gruppe. Lag der Fokus zuvor auf\nInternetbanking, so hat sich Emotet heute zu einem modularen Downloader und Infostealer\nentwickelt.\n\n[Erste Berichte der neusten Emotet-Version wurden von CERT Polska im April 2017](https://www.cert.pl/en/news/single/analysis-of-emotet-v4/)\nveröffentlicht. Bereits zur dieser Zeit wurde Emotet über per E-Mail versandte Links, die auf\neinen Dropper verweisen, verteilt.\n\n[Kürzlich warnte CERT-Bund erneut vor Spam-Emails, über die Emotet verbreitet wird. Auch](https://twitter.com/certbund/status/909740525128908801)\nbei diesen Mails scheint der Absender dem Empfänger bekannt zu sein - dies stärkt das\nVetrauen in die E-Mail und erhöht die Wahrscheinlichkeit, dass der Empfänger eine\ngenauere Überprüfung von Anhängen oder enthaltenen Links vernachlässigt. Um solche\nBeziehungen zwischen Personen herstellen zu können, liefert Emotet ein spezielles Modul\naus, das alle E-Mails in den Outlook-Konten des aktuellen Benutzers analysiert und\nRelationen zwischen Sendern und Empfängern aufbaut.\n\n\n-----\n\nZur Extraktion der Informationen aus Outlook verwendet das Modul die standardisierte\nSchnittstelle [MAPI (im Bild oben wird der Ladevorgang der MAPI-DLL und das Auflösen der](https://msdn.microsoft.com/en-us/library/cc765775.aspx)\nvom Modul benötigten Funktionen dargestellt). Mit Hilfe dieser Schnittstelle iteriert das Modul\nüber alle ihm zugänglichen Outlook-Profile des Computers. Aus jedem Profil werden aus\nallen vorhandenen E-Mail-Konten Name und E-Mail-Adresse extrahiert. Im Anschluss wird\njeder Ordner des Profils rekursiv nach E-Mails durchsucht. Aus jeder gefundenen E-Mail\nwerden der Absender (angezeigter Name und E-Mail-Adresse) sowie alle Empfänger\n(angezeigter Name und E-Mail-Adresse) inklusive der Empfänger in den CC- und BCCFeldern extrahiert und in Relation zueinander gespeichert (im Bild unten sind die Felder zu\nsehen, welche aus den E-Mails extrahiert werden). Sollte in einem der extrahierten Felder\nein Verweis auf das Adressbuch enthalten sein, wird aus dem entsprechenden Eintrag des\nAdressbuches Name und die E-Mail-Adresse der Person extrahiert. Allerdings werden nur\ndie Header der E-Mail ausgewertet, der Inhalt wird nicht analysiert.\n\nNachdem alle Profile, Ordner und E-Mails durchsucht wurden, schreibt das Modul die\ngesammelten Daten in eine temporäre Datei im Verzeichnis %PROGRAMDATA%. Die EMail-Adressen werden zusätzlich noch nach der Häufigkeit ihres Vorkommens absteigend\nsortiert. Jede E-Mail wird um alle Kontakte erweitert, zu denen sie in Relation steht. Es\nwerden dabei jedoch zwei Fälle unterschieden:\n\nist der referenzierte Kontakt der Absender einer E-Mail, werden alle Empfänger dem\nKontakt zugeordnet\nist der referenzierte Kontakt ein Empfänger der E-Mail, wird nur der Absender dem\nKontakt zugeordnet.\n\n### Beispiel:\n\n\n-----\n\nPostfach von A:\n\nMail 1: A sendet an B und C\n\nMail 2: D sendet an A\n\nMail 3: C sendet an A, D und E\n\nA wird 3-mal referenziert und steht in der Liste ganz oben. A hat durch Mail 1 eine\nVerbindung zu B und C, diese werden also mit A verknüpft. Mail 2 zeigt eine Verbindung von\nD zu A, deshalb wird D ebenfalls mit A verknüpft. In Mail 3 ist eine Relation von C nach A\nvorhanden. Diese wird allerdings ignoriert, da sie bereits zu Beginn mit A→C erfasst wurde.\nIn Mail 3 gibt es allerdings noch die Relationen C↔D und C↔E. Da weder die Relation C↔D\nnoch C↔E in der Liste vorhanden sind, werden C die Kontakte D und E zugeordnet und\nebenfalls in die Liste aufgenommen.\n\nDie vollständige Liste, die dem Angreifer übermittelt wird, sieht nun wie folgt aus:\n\nA<A@mail.com>; B<B@mail.com>; C<C@mail.net>; D<D@mail.com>\n\nC<C@mail.net>; D<D@mail.com>; E<E@mail.com>\n\n\n-----\n\nAnschließend wird die Datei verschlüsselt, an den Server der Angreifer übermittelt und von\nder Festplatte des Computers gelöscht.\n\nDurch dieses Modul erhalten die Angreifer einen umfassenden Überblick, ob und in welcher\nRelation die Sender und Empfänger der Mails stehen. Unter Zuhilfenahme einer solchen\nListe ist es für einen Angreifer mit keinem großen Aufwand verbunden, die Beziehungen von\nPersonen zueinander zu erkennen und Spam-Mails mit passenden Absendern zu schicken.\nZusätzlich gewinnt ein Angreifer Informationen über Relationen von Personen, deren\nRechner nicht befallen sind.\n\nUm die Spam E-Mails später an die passenden Adressaten verteilen zu können, benötigen\ndie Angreifer E-Mail Accounts. Um dies zu erreichen, setzen sie ein zusätzliches Modul mit\nder Aufgabe, die Zugangsdaten aus E-Mail Programmen zu extrahieren und an die Angreifer\nzu übermitteln, ein. Das Modul greift dazu auf eine mitgeführte Kopie der Anwendung Mail\n_PassView der Firma NirSoft zurück. Diese extrahiert die Zugangsdaten aus allen geläufigen_\nE-Mail Programmen (Microsoft Outlook, Mozilla Thunderbird, Windows Mail, ...) und schreibt\ndiese ebenfalls in eine temporäre Datei. Diese Datei wird dann wieder verschlüsselt, an den\nServer der Angreifer übermittelt und anschließend gelöscht.\n\n## Update: Emotet nimmt Bankkunden ins Visier - vollständige Analysen verfügbar\n\n[Weitere Informationen finden Sie auch auf dem Blog der G DATA Advanced Analytics.](https://cyber.wtf/2017/11/27/emotet-drops-zeus-panda-targeting-german-and-austrian-online-banking-users/)\n(Quelle in englischer Sprache)\n\n[Malware](https://www.gdata.de/blog/malware)\n[CyberCrime](https://www.gdata.de/blog/cybercrime)\n[Mails](https://www.gdata.de/blog/mails)\n\n**Die besten Beiträge per Mail**\n\nAktuelle Beiträge\nJederzeit kündbar\n\n### Alle wichtigen IT-Security-News bequem per E-Mail\n\nSparen Sie sich jede Menge Zeit – wir behalten für Sie den Überblick über die ITSicherheitslage.\n\nDie mit * markierten Felder sind Pflichtfelder.\n\n## Vielen Dank für Ihr Interesse.\n\nSie erhalten in Kürze eine E-Mail. Bitte klicken Sie darin auf den Link, um Ihre Daten zu\n\n**bestätigen.**\n\n\n-----\n\nSollten Sie in Ihrem Posteingang keine E-Mail von uns vorfinden, kontrollieren Sie bitte auch\n\nIhren Spamordner.\n\nzurück zum Formular\n\n\n-----",
    "language": "DE",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-10-12 - Emotet beutet Outlook aus.pdf"
    ],
    "report_names": [
        "2017-10-12 - Emotet beutet Outlook aus.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535621,
    "ts_updated_at": 1743041145,
    "ts_creation_date": 1653693219,
    "ts_modification_date": 1653693219,
    "files": {
        "pdf": "https://archive.orkl.eu/a9bdef73d2646b143db9d10d6392a4d1def63ee5.pdf",
        "text": "https://archive.orkl.eu/a9bdef73d2646b143db9d10d6392a4d1def63ee5.txt",
        "img": "https://archive.orkl.eu/a9bdef73d2646b143db9d10d6392a4d1def63ee5.jpg"
    }
}