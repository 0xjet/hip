{
    "id": "9a0b37fb-6f3a-4654-bc11-805a5c170dde",
    "created_at": "2022-10-25T16:48:16.152997Z",
    "updated_at": "2025-03-27T02:16:26.008626Z",
    "deleted_at": null,
    "sha1_hash": "1932e05dd6ba26e752fb89960c24fee7afe7a42b",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-02-11T09:16:43Z",
    "file_modification_date": "2020-02-11T09:16:43Z",
    "file_size": 2454114,
    "plain_text": "[Trend Micro](https://www.trendmicro.com/)\n[About TrendLabs Security Intelligence Blog](https://blog.trendmicro.com/trendlabs-security-intelligence/about-us/)\n\nSearch:\n\nGo to…\n\n[Home](http://blog.trendmicro.com/trendlabs-security-intelligence/)\nCategories\n\n[Home  »  Malware  »  Magecart Skimming Attack Targets Mobile Users of Hotel Chain Booking Websites](https://blog.trendmicro.com/trendlabs-security-intelligence/)\n\n# Magecart Skimming Attack Targets Mobile Users of Hotel Chain Booking Websites\n\n[Posted on:September 18, 2019 at 4:52 am](https://blog.trendmicro.com/trendlabs-security-intelligence/2019/09/)\n[Posted in:Malware](https://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/)\nAuthor:\n[Joseph C Chen (Fraud Researcher)](https://blog.trendmicro.com/trendlabs-security-intelligence/author/josephcchen/)\n\n0\n\nWe discovered a series of incidents where the credit card skimming attack Magecart was used to hit the\nbooking websites of chain-brand hotels — the second time we’ve seen a Magecart threat actor directly hit\necommerce service providers instead of going for individual stores or third-party [supply chains. Back in May,](https://blog.trendmicro.com/trendlabs-security-intelligence/new-magecart-attack-delivered-through-compromised-advertising-supply-chain/)\n[we discovered a new Magecart-using group called “Mirrorthief,” which compromised an ecommerce service](https://blog.trendmicro.com/trendlabs-security-intelligence/mirrorthief-group-uses-magecart-skimming-attack-to-hit-hundreds-of-campus-online-stores-in-us-and-canada/)\nprovider used by American and Canadian universities.\n\nIn early September, we found two hotel websites (from different hotel chains) that were being injected with a\nJavaScript code to load a remote script on their payment page since August 9. When we first checked the\nscript’s link, it downloaded a normal JavaScript code. However, we found that the same link could also\ndownload a different script when we requested it from mobile devices like Android or iOS phones. The\n\n\nGo to…\n\n\n-----\n\nhotel booking page and send it to a remote server.\n\nWe found both of the affected hotel websites were developed by Roomleader, a company from Spain that\nhelps hotels build their online booking websites. The malicious code wasn’t injected directly into the website\nbut rather into the script of Roomleader’s module called “viewedHotels” that was provided to its clients and\nsubsequently used for two websites of two different hotel chains. Despite the seemingly small number of\naffected sites, we still consider the attack significant given that one of the brands has 107 hotels in 14\ncountries while the other has 73 hotels in 14 countries. Note that we have reached out to Roomleader\nregarding this issue.\n\n**The script injected into the hotel booking website**\n\nFigure 1. Infection chain of the Magecart skimming attack on the online hotel booking websites\n\nAs mentioned, the injection was done on a JavaScript library of Roomleader’s “viewedHotels” module\nlocated at hxxps://[hotel website]/modulos/viewedHotels/templates/public/js/history_setter[.]js. This library\nis used for saving the viewed hotel information in the visitor’s browser cookies. The attacker injected the\nmalicious code in the middle of the original script.\n\nThe injected code first checks if an HTML element containing the ID “customerBookingForm” is present on\nthe webpage to make sure it is running on the hotel’s booking page. If the injected code is found to not be\nrunning on the page, it will go to sleep for one second and check repeatedly thereafter. However, if the code\ndetects the booking page, it will check if the browser debugger is closed and then load another JavaScript\nfrom the URL hxxps://googletrackmanager[.]com/gtm[.]js — which is where the card skimmer code is\nactually located. It’s worth noting that the style of the URL is meant to emulate the legitimate URL used by\n[Google Tag Manager.](https://tagmanager.google.com/)\n\n\n-----\n\nFigure 2. The injected script (highlighted) in the JavaScript library used by hotel websites\n\n**Analysis of the credit card skimmer**\n\nWhen we first connected to the skimmer URL, it returned normal JavaScript code copied from the GitHub\nproject [detect-mobile-browser. However, we suspected it was not the real payload because the code isn’t](https://github.com/smali-kazmi/detect-mobile-browser/blob/master/detect-browser.js)\nactually used by the affected websites.\n\nUpon further testing of the URL, we found that it downloaded a different script when we made a request\nusing an HTTP User-Agent from a mobile device. This script turned out to be a credit card skimmer.\nAlthough we found the skimmer to work on both PC and mobile browsers, it seems the attacker only targeted\nmobile users. This is most likely because the threat actor behind it wants to avoid detection from PC-based\nsecurity software. The skimmer is not a new one — we’ve seen instances where it was used by other groups.\nMost likely, it is a general skimmer that is shared via underground forums.\n\nFigure 3. The different scripts downloaded from the skimmer URL for desktop and mobile\n\nThe credit card skimmer is designed to steal data from payment forms. The skimmer hooks its function to the\nJavaScript events “submit” and “click,” which are usually triggered when people submit a payment or a\nbooking. When the hooked event is triggered, the skimmer will check if the browser debugger is closed. Then\nit copies the name and value from any “input” or “select” HTML element on the booking page. In this case,\nthe gathered information includes names, email addresses, telephone numbers, hotel room preferences, and\ncredit card details.\n\nThe copied information is encrypted using RC4 with a hardcoded key: “F8C5Pe4Q”. Next, the skimmer will\ngenerate a random string to encode the encrypted data again using XOR. The data will then be sent via HTTP\nPOST to the remote URL “https://googletrackmanager[.]com/gtm.php?id=” that uses generated random string\nappended at the end. Upon receipt of the information, the attacker can then decrypt the data and collect the\ncredit card information.\n\n\n-----\n\n**Magecart replaces the original booking page with a fake one**\n\nAlthough the skimmer itself is not unique, we found that it removes the original credit card form on the\nbooking page and injects another one prepared by the threat actor. We theorize two possible reasons for this.\nThe first is that some hotels don’t ask customers to make online payments but instead ask them to pay at the\nhotel upon arrival. In cases like this, the booking form will ask for credit card information but without the\nCVC number. To ensure that all credit card information are captured, the attacker replaces the original form\nwith one that contains the CVC number column.\n\nThe second possible reason is that, sometimes, the booking page will host the credit card form in a different\ndomain using an HTML [iframe element to make it more secure. In this scenario, a regular JavaScript](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe)\nskimmer will not be able to copy the data inside the secure iframe. Therefore, the attacker removes the iframe\nof the secured credit card form and injects his own form so the skimmer can copy the information.\n\nFigure 5. The original credit card form (above) from the hotel website and the injected form (below) from the\n\nskimmer\n\n\n-----\n\nFigure 6. The skimmer script used to remove the original form from the booking page and replace it with the\n\nfake one\n\nTo make it seem more legitimate, the attacker also prepared credit card forms in eight languages: English,\nSpanish, Italian, French, German, Portuguese, Russian, and Dutch. These languages match the languages\nsupported by the targeted hotel websites. The skimmer will check which language the customer is using for\nthe website and inject the corresponding fake credit card form into the page.\n\nFigure 7. The eight languages of the fake credit card form inside the skimmer\n\nWe were unable to find any strong connections to previous Magecart groups based on the network\ninfrastructure or the malicious code used in this attack. However, it’s possible that the threat actor behind this\ncampaign was also involved in previous campaigns.\n\n**Conclusion**\n\n[Recent incidents involving credit card skimmers like Magecart emphasize the need for businesses to](https://www.trendmicro.com/vinfo/us/security/news/security-technology/security-by-design-devops-in-the-era-of-the-gdpr?_ga=2.167625470.1324830332.1567993238-94385647.1557215823) secure\ntheir websites from potential compromise by implementing security best practices, which include regularly\nupdating software to the latest versions and segregating networks to ensure that as little customer data as\npossible is exposed.\n\nFurthermore, users can consider using payment systems such as Apple Pay and Google Pay, which offer\nadditional authentication methods — minimizing the chance that attackers will be able to use the credit card\neven if they manage to collect the card’s details.\n\nThe following Trend Micro solutions protect users and businesses by blocking the scripts and preventing\naccess to the malicious domains:\n\n[Trend Micro™ Security](https://www.trendmicro.com/us/home/products/software/index.html)\n[Smart Protection Suites and](https://www.trendmicro.com.ph/ph/business/complete-user-protection/index.html) [Worry-Free™ Business Security](https://www.trendmicro.com/us/small-business/product-security/)\n[Trend Micro Network Defense](https://www.trendmicro.com/us/business/cyber-security/index.html)\n[Hybrid Cloud Security](https://www.trendmicro.com/us/business/cloud-data/index.html)\n\n**Indicators of Compromise (IoCs)**\n\n**File**\n**SHA-256 Hash/ URL** **Detection name**\n**Name [Details]**\n\n\n-----\n\ne9ef1e7b312 card\nskimmer\n\nMagecart\ngoogletrackmanager[.]com\nDomain\n\n\nART.B\n\n\n**With special thanks to our colleagues at** **[abuse.ch and The Shadowserver Foundation for helping to](https://abuse.ch/)**\n**take down the Magecart domain**\n\n## Related Posts:\n\n**[FIN6 Compromised E-commerce Platform via Magecart to Inject Credit Card Skimmers Into](https://blog.trendmicro.com/trendlabs-security-intelligence/fin6-compromised-e-commerce-platform-via-magecart-to-inject-credit-card-skimmers-into-thousands-of-online-shops/)**\n**Thousands of Online Shops**\n**[Mirrorthief Group Uses Magecart Skimming Attack to Hit Hundreds of Campus Online Stores](https://blog.trendmicro.com/trendlabs-security-intelligence/mirrorthief-group-uses-magecart-skimming-attack-to-hit-hundreds-of-campus-online-stores-in-us-and-canada/)**\n**in US and Canada**\n\n\nLearn how to protect Enterprises, Small Businesses, and Home Users from ransomware:\n\n[ENTERPRISE](http://www.trendmicro.com/us/security-intelligence/enterprise-ransomware/index.html) » [SMALL BUSINESS](http://www.trendmicro.com/us/security-intelligence/small-business-ransomware/index.html) » [HOME](http://www.trendmicro.com/us/home/consumer-ransomware/index.html) »\n\n\nTags: [MagecartSkimmer](https://blog.trendmicro.com/trendlabs-security-intelligence/tag/magecart/)\n\n### Security Predictions for 2020\n\nCybersecurity in 2020 will be viewed through many lenses — from differing attacker motivations and\ncybercriminal arsenal to technological developments and global threat intelligence — only so\ndefenders can keep up with the broad range of threats.\n[Read our security predictions for 2020.](https://www.trendmicro.com/vinfo/us/security/research-and-analysis/predictions/2020)\n\n### Business Process Compromise\n\nAttackers are starting to invest in long-term operations that target specific processes enterprises rely on.\nThey scout for vulnerable practices, susceptible systems and operational loopholes that they can\nleverage or abuse. To learn more, [read our Security 101: Business Process Compromise.](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/security-101-business-process-compromise)\n\n### Recent Posts\n\n[Outlaw Updates Kit to Kill Older Miner Versions, Targets More Systems](https://blog.trendmicro.com/trendlabs-security-intelligence/outlaw-updates-kit-to-kill-older-miner-versions-targets-more-systems/)\n\n\n-----\n\nMalware, Perform Mobile Ad Fraud\n[Security Analysis of Devices That Support SCPI and VISA Protocols](https://blog.trendmicro.com/trendlabs-security-intelligence/security-analysis-of-devices-that-support-scpi-and-visa-protocols/)\n[January Patch Tuesday: Update List Includes Fixes for Internet Explorer, Remote Desktop,](https://blog.trendmicro.com/trendlabs-security-intelligence/january-patch-tuesday-update-list-includes-fixes-for-internet-explorer-remote-desktop-cryptographic-bugs/)\nCryptographic Bugs\n[First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT](https://blog.trendmicro.com/trendlabs-security-intelligence/first-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/)\nGroup\n\n### Popular Posts\n\n[Security Analysis of Devices That Support SCPI and VISA Protocols](https://blog.trendmicro.com/trendlabs-security-intelligence/security-analysis-of-devices-that-support-scpi-and-visa-protocols/)\n\n[January Patch Tuesday: Update List Includes Fixes for Internet Explorer, Remote Desktop,](https://blog.trendmicro.com/trendlabs-security-intelligence/january-patch-tuesday-update-list-includes-fixes-for-internet-explorer-remote-desktop-cryptographic-bugs/)\nCryptographic Bugs\n\n[First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT](https://blog.trendmicro.com/trendlabs-security-intelligence/first-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/)\nGroup\n\n[Why Running a Privileged Container in Docker Is a Bad Idea](https://blog.trendmicro.com/trendlabs-security-intelligence/why-running-a-privileged-container-in-docker-is-a-bad-idea/)\n\n[Looking into Attacks and Techniques Used Against WordPress Sites](https://blog.trendmicro.com/trendlabs-security-intelligence/looking-into-attacks-and-techniques-used-against-wordpress-sites/)\n\n### Stay Updated\n\nEmail Subscription\n\n\nYour email here\n\n\n[Home and Home Office](http://www.trendmicro.com/us/home/index.html)\n|\n[For Business](http://www.trendmicro.com/us/business/index.html)\n|\n[Security Intelligence](http://www.trendmicro.com/us/security-intelligence/index.html)\n|\n[About Trend Micro](http://www.trendmicro.com/us/about-us/index.html)\n\n[Asia Pacific Region (APAC): Australia /](http://www.trendmicro.com.au/au/home/index.html) [New Zealand, 中国, ⽇本, 대한민국, 台灣](http://www.trendmicro.co.nz/nz/home/index.html)\nLatin America Region (LAR): [Brasil, México](http://br.trendmicro.com/br/home/index.html)\nNorth America Region (NABU): [United States, Canada](http://www.trendmicro.com/us/index.html)\nEurope, Middle East, & Africa Region (EMEA): [France, Deutschland / Österreich / Schweiz, Italia,](http://www.trendmicro.fr/)\n[Россия, España, United Kingdom / Ireland](http://www.trendmicro.com.ru/)\n\n[Privacy Statement](http://www.trendmicro.com/us/about-us/legal-policies/privacy-statement/index.html)\n[Legal Policies](http://www.trendmicro.com/us/about-us/legal-policies/index.html)\n\nCopyright © 2020 Trend Micro Incorporated. All rights reserved.\n\n\nYour email here\n\nSubscribe\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.09.18.Magecart_Hotel_Chain_Booking/Magecart%20Skimming%20Attack%20Targets%20Mobile%20Users%20of%20Hotel%20Chain%20Booking%20Websites.pdf"
    ],
    "report_names": [
        "Magecart Skimming Attack Targets Mobile Users of Hotel Chain Booking Websites"
    ],
    "threat_actors": [
        {
            "id": "6b9fc913-06c6-4432-8c58-86a3ac614564",
            "created_at": "2022-10-25T16:07:24.185236Z",
            "updated_at": "2025-03-27T02:02:10.135195Z",
            "deleted_at": null,
            "main_name": "SideWinder",
            "aliases": [
                "APT-C-17",
                "APT-Q-39",
                "BabyElephant",
                "GroupA21",
                "HN2",
                "Hardcore Nationalist",
                "Rattlesnake",
                "Razor Tiger",
                "SideWinder",
                "T-APT-04"
            ],
            "source_name": "ETDA:SideWinder",
            "tools": [
                "BroStealer",
                "Capriccio RAT",
                "callCam"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ee3363a4-e807-4f95-97d8-b603c31b9de1",
            "created_at": "2023-01-06T13:46:38.485884Z",
            "updated_at": "2025-03-27T02:00:02.845851Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "Camouflage Tempest",
                "MageCart Group 6",
                "G0037",
                "TA4557",
                "SKELETON SPIDER",
                "ITG08",
                "White Giant",
                "GOLD FRANKLIN",
                "ATK88"
            ],
            "source_name": "MISPGALAXY:FIN6",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "12517c87-040a-4627-a3df-86ca95e5c13f",
            "created_at": "2022-10-25T16:07:23.61665Z",
            "updated_at": "2025-03-27T02:02:09.889471Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "ATK 88",
                "Camouflage Tempest",
                "FIN6",
                "Gold Franklin",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "TAG-CR2",
                "White Giant"
            ],
            "source_name": "ETDA:FIN6",
            "tools": [
                "AbaddonPOS",
                "Agentemis",
                "AmmyyRAT",
                "Anchor_DNS",
                "BlackPOS",
                "CmdSQL",
                "Cobalt Strike",
                "CobaltStrike",
                "FlawedAmmyy",
                "FrameworkPOS",
                "Grateful POS",
                "JSPSPY",
                "Kaptoxa",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LockerGoga",
                "MMon",
                "Magecart",
                "Meterpreter",
                "Mimikatz",
                "More_eggs",
                "NeverQuest",
                "POSWDS",
                "Reedum",
                "Ryuk",
                "SCRAPMINT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Terra Loader",
                "TerraStealer",
                "Vawtrak",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "cobeacon",
                "grabnew"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b3acfb48-b04d-4d3d-88a8-836d7376fa2e",
            "created_at": "2024-06-19T02:03:08.052814Z",
            "updated_at": "2025-03-27T02:05:17.368029Z",
            "deleted_at": null,
            "main_name": "GOLD FRANKLIN",
            "aliases": [
                "ITG08 ",
                "MageCart Group 6 ",
                "Skeleton Spider ",
                "White Giant ",
                "FIN6 "
            ],
            "source_name": "Secureworks:GOLD FRANKLIN",
            "tools": [
                " Metasploit",
                " Meterpreter",
                " Mimikatz",
                " PowerSploit",
                " PowerUpSQL",
                " RemCom",
                "FrameWorkPOS"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "173f1641-36e3-4bce-9834-c5372468b4f7",
            "created_at": "2022-10-25T15:50:23.349637Z",
            "updated_at": "2025-03-27T02:00:55.450857Z",
            "deleted_at": null,
            "main_name": "Sidewinder",
            "aliases": [
                "Sidewinder",
                "T-APT-04"
            ],
            "source_name": "MITRE:Sidewinder",
            "tools": [
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d0c0a5ea-3066-42a5-846c-b13527f64a3e",
            "created_at": "2023-01-06T13:46:39.080551Z",
            "updated_at": "2025-03-27T02:00:02.992026Z",
            "deleted_at": null,
            "main_name": "RAZOR TIGER",
            "aliases": [
                "SideWinder",
                "APT-C-17",
                "T-APT-04"
            ],
            "source_name": "MISPGALAXY:RAZOR TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ea7bfe06-7c23-481d-b8ba-eafa6cda3bc9",
            "created_at": "2022-10-25T15:50:23.317961Z",
            "updated_at": "2025-03-27T02:00:55.440858Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "FIN6",
                "Magecart Group 6",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "Camouflage Tempest"
            ],
            "source_name": "MITRE:FIN6",
            "tools": [
                "FlawedAmmyy",
                "GrimAgent",
                "FrameworkPOS",
                "More_eggs",
                "Cobalt Strike",
                "Windows Credential Editor",
                "AdFind",
                "PsExec",
                "LockerGoga",
                "Ryuk",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1581412603,
    "ts_modification_date": 1581412603,
    "files": {
        "pdf": "https://archive.orkl.eu/1932e05dd6ba26e752fb89960c24fee7afe7a42b.pdf",
        "text": "https://archive.orkl.eu/1932e05dd6ba26e752fb89960c24fee7afe7a42b.txt",
        "img": "https://archive.orkl.eu/1932e05dd6ba26e752fb89960c24fee7afe7a42b.jpg"
    }
}