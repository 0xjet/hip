{
    "id": "4c1400dc-1661-4c36-8539-a1e4064bcbc1",
    "created_at": "2023-01-12T15:06:37.337309Z",
    "updated_at": "2025-03-27T02:05:24.267991Z",
    "deleted_at": null,
    "sha1_hash": "af8ad3a894ea63022934d5111186486674b5c873",
    "title": "2012-11-22 - W32.Narilam – Business Database Sabotage",
    "authors": "",
    "file_creation_date": "2022-05-28T18:18:54Z",
    "file_modification_date": "2022-05-28T18:18:54Z",
    "file_size": 85373,
    "plain_text": "# Endpoint Protection\n\n**[symantec.com/connect/blogs/w32narilam-business-database-sabotage](https://www.symantec.com/connect/blogs/w32narilam-business-database-sabotage)**\n\n[A L Johnson](https://community.broadcom.com/symantecenterprise/network/members/profile?UserKey=cbd453fd-3ce1-4c47-af77-d746256f9bc4)\n\n\nNov 22, 2012 05:39 AM\n\n\nIn the last couple of years, we have seen highly sophisticated malware used to sabotage\n[the business activities of chosen targets. We have seen malware such as W32.Stuxnet](http://www.symantec.com/security_response/writeup.jsp?docid=2010-071400-3123-99)\ndesigned to tamper with industrial automation systems and other destructive examples such\nas [W32.Disstrack and](http://www.symantec.com/security_response/writeup.jsp?docid=2012-081608-0202-99) [W32.Flamer, which can both wiped out data and files from hard](http://www.symantec.com/security_response/writeup.jsp?docid=2012-052811-0308-99)\ndisks. All of these threats can badly disrupt the activities of those affected.\n\nFollowing along that theme, we recently came across an interesting threat that has another\nmethod of causing chaos, this time, by targeting and modifying corporate databases. We\ndetect this threat as [W32.Narilam.](http://www.symantec.com/security_response/writeup.jsp?docid=2012-111516-3751-99)\n\nBased on the detections observed, W32.Narilam is active predominantly in the Middle East.\n\n**_Figure 1. Distribution of W32.Narilam_**\n\nJust like many other worms that we have seen in the past, the threat copies itself to the\ninfected machine, adds registry keys, and spreads through removable drives and network\nshares. It is even written using Delphi, which is a language that is used to create a lot of\nother malware threats. All these aspects of this threat are normal enough, what is unusual\nabout this threat is the fact that it has the functionality to update a Microsoft SQL database if\nit is accessible by OLEDB. The worm specifically targets SQL databases with three distinct\nnames: alim, maliran, and shahd.\n\nThe following are some of the object/table names that can be accessed by the threat:\n\nHesabjari (\"current account\" in Arabic/Persian).\nHoliday\nHoliday_1\nHoliday_2\nAsnad (“financial bond” in Arabic)\nA sellers\n\n\n-----\n\nA_TranSanj\nR_DetailFactoreForosh (\"forosh\" means \"sale\" in Persian)\nperson\npasandaz (\"savings\" in Persian)\nBankCheck\nEnd_Hesab (\"hesab\" means \"account\" in Persian)\nKalabuy\nKalasales\nREFcheck\nbuyername\nVamghest (“instalment loans” in Persian)\n\nThe threat replaces certain items in the database with random values. The following are\nsome of the items that are modified by the threat:\n\nAsnad.SanadNo (\"sanad\" means \"document\" in Persian)\nAsnad.LastNo\nAsnad.FirstNo\nA_TranSanj.Tranid\nPasandaz.Code (“pasandaz” means “savings” in Persian)\nn_dar_par.price\nbankcheck.state\nEnd_Hesab.Az\nKalabuy.Serial\nsath.lengths\nKalasales.Serial\nrefcheck.amount\nbuyername.Buyername\n\nThe threat also deletes tables including ones with the following names:\n\nA_Sellers\nperson\nKalamast\n\nBelow is a fraction of the temporal procedure that is specified in the threat code.\n\n**_Figure 2. Code snippet showing an extract of the temporal procedure_**\n\nFor example, in line 12 through 14, it sets a variable, @SanadNo, to a value that is\nrandomly chosen between zero and the maximal value in Koll.Koll records. Then it deletes\na record in Koll table where the Koll.Koll value is the same as the random value.\n\n\n-----\n\nThe malware does not have any functionality to steal information from the infected system\nand appears to be programmed specifically to damage the data held within the targeted\ndatabase. Given the types of objects that the threat searches for, the targeted databases\nseem to be related to ordering, accounting, or customer management systems belonging to\ncorporations.\n\nOur in-field telemetry indicates that the vast majority of users impacted by this threat are\ncorporate users. This fact is consistent with the functionality contained within the threat. The\ntypes of databases that this threat is looking for is unlikely to be found in the systems of\nhome users.\n\n**_Figure 3.Narilam infections broken down by user type_**\n\nUnless appropriate backups are in place, the affected database will be difficult to restore.\nThe affected organization will likely suffer significant disruption and even financial loss while\nrestoring the database. As the malware is aimed at sabotaging the affected database and\ndoes not make a copy of the original database first, those affected by this threat will have a\nlong road to recovery ahead of them.\n\n[Symantec users with the latest definitions are protected from W32.Narilam; however, we](http://www.symantec.com/security_response/writeup.jsp?docid=2012-111516-3751-99)\nstrongly recommend that important databases be backed up regularly.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2012/2012-11-22 - W32.Narilam – Business Database Sabotage.pdf"
    ],
    "report_names": [
        "2012-11-22 - W32.Narilam – Business Database Sabotage.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535997,
    "ts_updated_at": 1743041124,
    "ts_creation_date": 1653761934,
    "ts_modification_date": 1653761934,
    "files": {
        "pdf": "https://archive.orkl.eu/af8ad3a894ea63022934d5111186486674b5c873.pdf",
        "text": "https://archive.orkl.eu/af8ad3a894ea63022934d5111186486674b5c873.txt",
        "img": "https://archive.orkl.eu/af8ad3a894ea63022934d5111186486674b5c873.jpg"
    }
}