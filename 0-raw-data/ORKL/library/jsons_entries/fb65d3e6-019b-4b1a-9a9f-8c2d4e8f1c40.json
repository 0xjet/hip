{
    "id": "fb65d3e6-019b-4b1a-9a9f-8c2d4e8f1c40",
    "created_at": "2023-01-12T15:09:38.020168Z",
    "updated_at": "2025-03-27T02:12:36.911574Z",
    "deleted_at": null,
    "sha1_hash": "7be193e0025a257e11f3a8d3164d13c848bd1438",
    "title": "2017-06-07 - PLATINUM continues to evolve, find ways to maintain invisibility",
    "authors": "",
    "file_creation_date": "2022-05-28T21:54:17Z",
    "file_modification_date": "2022-05-28T21:54:17Z",
    "file_size": 437241,
    "plain_text": "# PLATINUM continues to evolve, find ways to maintain invisibility\n\n**[blogs.technet.microsoft.com/mmpc/2017/06/07/platinum-continues-to-evolve-find-ways-to-maintain-invisibility/](https://blogs.technet.microsoft.com/mmpc/2017/06/07/platinum-continues-to-evolve-find-ways-to-maintain-invisibility/)**\n\nJune 7, 2017\n\n[Back in April 2016, we released the paper PLATINUM: Targeted attacks in South and Southeast Asia, where we](http://download.microsoft.com/download/2/2/5/225BFE3E-E1DE-4F5B-A77B-71200928D209/Platinum%20feature%20article%20-%20Targeted%20attacks%20in%20South%20and%20Southeast%20Asia%20April%202016.pdf)\ndetailed the tactics, techniques, and procedures of the PLATINUM activity group.\n\n[We described a group that was well-resourced and quickly adopted advanced techniques, such as hot patching](https://blogs.technet.microsoft.com/mmpc/2016/04/26/digging-deep-for-platinum/)\nto silently inject code into processes. They used hot patching even when traditional injection techniques could\nhave been sufficient and less costly to develop.\n\nSince the 2016 publication, Microsoft has come across an evolution of PLATINUM’s file-transfer tool, one that\nuses the Intel® Active Management Technology (AMT) Serial-over-LAN (SOL) channel for communication. This\nchannel works independently of the operating system (OS), rendering any communication over it invisible to\nfirewall and network monitoring applications running on the host device. Until this incident, no malware had been\ndiscovered misusing the AMT SOL feature for communication.\n\nUpon discovery of this unique file-transfer tool, Microsoft shared information with Intel, and the two companies\ncollaborated to analyze and better understand the purpose and implementation of the tool. We confirmed that the\ntool did not expose vulnerabilities in the management technology itself, but rather misused AMT SOL within\ntarget networks that have already been compromised to keep communication stealthy and evade security\napplications.\n\nThe updated tool has only been seen in a handful of victim computers within organizational networks in\nSoutheast Asia—PLATINUM is known to customize tools based on the network architecture of targeted\norganizations. The diagram below represents the file-transfer tool’s updated channel and network flow.\n\n\n-----\n\n_Figure 1. PLATINUM file-transfer tool network flow_\n\nThe AMT SOL feature is not enabled by default and requires administrator privileges to provision for usage on\nworkstations. It is currently unknown if PLATINUM was able to provision workstations to use the feature or\npiggyback on a previously enabled workstation management feature. In either case, PLATINUM would need to\nhave gained administrative privileges on targeted systems prior to the feature’s misuse.\n\n## AMT Serial-over-LAN (SOL) communication channel\n\nActive Management Technology (AMT) enables remote management of devices and is provided as a feature of\nIntel® vPro™ processors and chipsets. AMT runs in the Intel Management Engine (ME), which runs its own\noperating system to execute on an embedded processor located in the chipset (Platform Controller Hub, PCH).\nAs this embedded processor is separate from the primary Intel processor, it can execute even when the main\nprocessor is powered off and is therefore able to provide out-of-band (OOB) remote administration capabilities\nsuch as remote power-cycling and keyboard, video, and mouse control (KVM).\n\nAMT has a Serial-over-LAN (SOL) feature that exposes a virtual serial device with a chipset-provided channel\nover TCP.\n\n\n-----\n\n_Figure 2. AMT SOL device_\n\nThis functionality works independently of the device host operating system networking stack—the ME makes use\nof its own networking stack and has access to the hardware network interface. This means that even if\nnetworking is disabled on the host, SOL will still function as long as the device is physically connected to the\nnetwork.\n\n_Figure 3. AMT SOL component stack_\n\nFurthermore, as the SOL traffic bypasses the host networking stack, it cannot be blocked by firewall applications\nrunning on the host device. To enable SOL functionality, the device AMT must be provisioned. Also,\nestablishment of a SOL session requires a username and password—usually selected during device\nprovisioning. The tool would therefore require the relevant credentials to establish such a session.\n\nOne possibility is that PLATINUM might have obtained compromised credentials from victim networks. Another\npossibility is that the targeted systems did not have AMT provisioned and PLATINUM, once they’ve obtained\nadministrative privileges on the system, proceeded to provision AMT.\n\nThere are several methods for provisioning AMT. The most straightforward is host-based provisioning _(HBP),_\nwhich can be done from within the host Windows OS itself and requires administrator permissions. During the\nprovisioning process, PLATINUM could select whichever username and password they wish. HBP enables\naccess to a subset of AMT functionality, which includes SOL but restricts access to other features such as KVM\nredirect.\n\n## How PLATINUM uses SOL\n\n\n-----\n\n[In the first version of the file transfer tool, which we described in the original paper, network communication is](http://download.microsoft.com/download/2/2/5/225BFE3E-E1DE-4F5B-A77B-71200928D209/Platinum%20feature%20article%20-%20Targeted%20attacks%20in%20South%20and%20Southeast%20Asia%20April%202016.pdf)\ndone over TCP/IP by utilizing the regular network APIs. The presentation layer protocol is straightforward: the\nbuffer is made up of a two-byte header—the indication length—and the Blowfish-encrypted payload data itself.\n\n_Figure 4. TCP protocol length header and payload_\n\nThe new SOL protocol within the PLATINUM file-transfer tool makes use of the AMT Technology SDK’s\nRedirection Library API (imrsdk.dll). Data transactions are performed by the calls\n_IMR_SOLSendText()/IMR_SOLReceiveText(), which are analogous to networking send() and recv() calls. The_\nSOL protocol used is identical to the TCP protocol other than the addition of a variable-length header on the data\nfor error detection. Also, the updated client sends an unencrypted packet with the content “007″� before\nauthentication.\n\n_Figure 5. AMT SOL protocol error-detection header, length header, and payload_\n\nThe new header has various fields to detect possible data corruption errors, including a CRC-16 and a binary\nindex of the bytes having the set of most significant bits (MSB).\n\n_Figure 6. Construction of error-detection header_\n\nThe following video demonstrates how the PLATINUM tool can be used to transfer malware to a computer with\nAMT provisioned:\n\nhttps://channel9.msdn.com/Shows/Windows-Security-Blog/PLATINUM-activity-group-file-transfer-method-usingIntel-AMT-SOL/player\n\n## Detecting unusual binaries that use AMT\n\nIf an attacker who has access to AMT credentials attempts to use the SOL communication channel on a\n[computer running Windows Defender ATP, behavior analytics coupled with machine learning can detect the](http://aka.ms/wdatp)\ntargeted attack activity. Windows Defender ATP displays an alert similar to the one shown below. Windows\nDefender ATP can differentiate between legitimate usage of AMT SOL and targeted attacks attempting to use it\nas a communication channel.\n\n\n-----\n\n_Figure 7. Windows Defender ATP detection of malicious AMT SOL channel activity_\n\nThe PLATINUM tool is, to our knowledge, the first malware sample observed to misuse chipset features in this\nway. While the technique used here by PLATINUM is OS independent, Windows Defender ATP can detect and\nnotify network administrators of attempts to leverage the AMT SOL communication channel for unauthorized\nactivity, specifically when used against a computer running Windows.\n\nAt Microsoft, we continuously monitor the threat landscape for novel techniques used for malicious purposes. We\nalso constantly build mechanisms that mitigate resulting risks and protect customers. The discovery of this new\nPLATINUM technique and the development of detection capabilities highlight the work the Windows Defender\nATP team does to provide customers greater visibility into suspicious activities transpiring on their networks.\n\nTo test how Windows Defender ATP can help your organization detect, investigate, and respond to advanced\nattacks, **[sign up for a free trial.](https://www.microsoft.com/en-us/windowsforbusiness/windows-atp?ocid=cx-blog-mmpc)**\n\n_Microsoft reiterates that the PLATINUM tool does not expose flaws in Intel® Active Management Technology_\n_(AMT), but uses the technology within an already compromised network to evade security monitoring tools._\n\n**David Kaplan, Stefan Sellmer, and Andrea Lelli**\n\n_Windows Defender ATP Research Team_\n\n\n-----\n\n**Talk to us**\n\n[Questions, concerns, or insights on this story? Join discussions at the Microsoft community and](https://answers.microsoft.com/en-us/protect) Windows\nDefender Security Intelligence.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-06-07 - PLATINUM continues to evolve, find ways to maintain invisibility.pdf"
    ],
    "report_names": [
        "2017-06-07 - PLATINUM continues to evolve, find ways to maintain invisibility.pdf"
    ],
    "threat_actors": [
        {
            "id": "33f527a5-a5da-496a-a48c-7807cc858c3e",
            "created_at": "2022-10-25T15:50:23.803657Z",
            "updated_at": "2025-03-27T02:00:55.550132Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "PLATINUM"
            ],
            "source_name": "MITRE:PLATINUM",
            "tools": [
                "JPIN",
                "Dipsind",
                "adbupd"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7d8ef10e-1d7b-49a0-ab6e-f1dae465a1a4",
            "created_at": "2023-01-06T13:46:38.595679Z",
            "updated_at": "2025-03-27T02:00:02.869216Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "TwoForOne",
                "G0068",
                "ATK33"
            ],
            "source_name": "MISPGALAXY:PLATINUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e61c46f7-88a1-421a-9fed-0cfe2eeb820a",
            "created_at": "2022-10-25T16:07:24.061767Z",
            "updated_at": "2025-03-27T02:02:10.094583Z",
            "deleted_at": null,
            "main_name": "Platinum",
            "aliases": [
                "ATK 33",
                "Operation EasternRoppels",
                "TwoForOne"
            ],
            "source_name": "ETDA:Platinum",
            "tools": [
                "AMTsol",
                "Adupib",
                "Adupihan",
                "Dipsind",
                "DvDupdate.dll",
                "JPIN",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "RedPepper",
                "RedSalt",
                "Titanium",
                "adbupd",
                "psinstrc.ps1"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536178,
    "ts_updated_at": 1743041556,
    "ts_creation_date": 1653774857,
    "ts_modification_date": 1653774857,
    "files": {
        "pdf": "https://archive.orkl.eu/7be193e0025a257e11f3a8d3164d13c848bd1438.pdf",
        "text": "https://archive.orkl.eu/7be193e0025a257e11f3a8d3164d13c848bd1438.txt",
        "img": "https://archive.orkl.eu/7be193e0025a257e11f3a8d3164d13c848bd1438.jpg"
    }
}