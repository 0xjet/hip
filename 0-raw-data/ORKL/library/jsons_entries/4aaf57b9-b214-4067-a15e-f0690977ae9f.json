{
    "id": "4aaf57b9-b214-4067-a15e-f0690977ae9f",
    "created_at": "2023-04-05T02:08:58.115482Z",
    "updated_at": "2025-03-27T02:12:11.151312Z",
    "deleted_at": null,
    "sha1_hash": "160140a742081ea0d42ae86eb69892fb9e04fd33",
    "title": "2021-03-18 - The “Kek Security” Network",
    "authors": "",
    "file_creation_date": "2023-04-03T08:29:06Z",
    "file_modification_date": "2023-04-03T08:29:06Z",
    "file_size": 1103196,
    "plain_text": "# The “Kek Security” Network\n\n**lacework.com/blog/the-kek-security-network/**\n\n**_Key takeaways:_**\n\n\nMarch 18, 2021\n\n\nKeksec has updated their tactics to include use of DGA and Tor C2, and proxies.\nBased on voluminous polymorphic specimens there is likely widespread infection\nattributable to the group.\nKeksec is actively exploiting Citrix NetScaler RCE – CVE-2019-19781 and Vmware\nvCenter Server – CVE-2021-21973\n[Tools and indicators are available here.](https://github.com/lacework/lacework-labs/tree/master/keksec)\n\n**Introduction**\n\n[Kek Security/Keksec is a prolific threat actor group that was recently detailed in Checkpoint](https://research.checkpoint.com/2021/freakout-leveraging-newest-vulnerabilities-for-creating-a-botnet/%22)\n(Freakout) and **[Netlab360 (Necro) reporting. Keksec exploits several vulnerabilities and targets](https://blog.netlab.360.com/necro-shi-yong-tor-dong-tai-yu-ming-dga-shuang-sha-windows-linux/)**\nmultiple architectures with polymorphic tools including Linux and Windows payloads, and\ncustom python malware. The group is actively constructing IRC botnets for the purposes of\nDDoS operations and cryptojacking campaigns using both Doge and Monero.\n\nThis blog details the new tools and tactics leveraged by Keksec and includes persona\ninformation on the actors. Analysis tools and indicators can be found in the Lacework Labs\n**[Github.](https://github.com/lacework/lacework-labs/tree/master/keksec)**\n\n**Kaiten Variants**\n\n\n-----\n\nBeginning as early as August 2020, Keksec started leveraging polymorphic variants of the\n**[Kaiten IRC DDoS bot. This was observed on VirusTotal with over 1800 uploads of the malware](https://github.com/Vexvain/IRC-DDoS/blob/a8698f5ce6d20ffe286f47a05261785cf8a01161/ddos.c)**\nat the time of this blog. The polymorphic nature of the malware renders hash-checks useless\nand requires a scan to properly identify. This means that the number of VirusTotal uploads for a\ngiven variant is a reflection of the malware’s footprint in the wild. Analysis of submission data\nshowed 46 unique submitter keys in 23 countries. The ownership of the submitter keys is not\ndisclosed in VirusTotal, so it’s unknown how many belong to AV vendors or unique victims.\n\nVariants of the Kaiten source are available on GitHub, however the exact source for the Keksec\nvariants are not.\n\n**[Some of the specimens were configured to exploit different vulnerabilities including the Citrix](https://www.virustotal.com/gui/file/c64e3449987c18db257c9f6a60f4556935eab81085306705319c6be8af5f9c39/detection)**\nNetScaler RCE – CVE-2019-19781 and other IoT exploits often seen in Mirai. Kaiten uses a\nsubstitute cipher to encode sensitive strings such as commands and c2 endpoints. Analysis of\nthe Keksec samples revealed the use of two custom ciphers, the second of which was\nconfigured in late February.\n\nKeksec’s Kaiten cipher Timeline\n\n\nxm@_;w,B-Z*j?\nnvE|sq1o$3″7zKC<F)utAr.p%=>4ihgfe6cba~&5Dk2d!8+9Uy:\n\n%q*KC)&F98fsr2to4b3yi_:wB>z=;!k?”EAZ7.Dmd<ex5U~h,j|$v6c1ga+p@un\n\n\nAugust 2020 – February\n2021\n\nFebruary 2021 – present\n\n\nThe following python code may be used to decode Kaiten strings, the inputs and the cipher\nvalue just needs to changed for the respective specimen:\n```\n encstring_ = \"?>K!tF>iorZ:ww_uBw3Bw\"\n\n cipher_ = {}\n\n encode = list('%q*KC)&F98fsr2to4b3yi_:wB>z=;!k?\"EAZ7.D md<ex5U~h,j|$v6c1ga+p@un')\n\n decode =\n list('0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ. ')\n\n temp = zip(encode,decode)\n\n for pairs in temp:\n\n   cipher_[pairs[0]] = pairs[1]\n\n decode_temp = []\n\n for s in encstring_:\n\n   try:\n\n     d = cipher_[s]\n\n     decode_temp.append(d)\n\n   except:\n\n     raise\n\n decoded = ''.join(decode_temp)\n\n print(decoded)\n\n```\n\n-----\n\nA significant tactic change employed with the latest Kaiten specimens, was the use of a Tor. This\nis achieved with an .onion domain vp3te7pkfczmnnl.onion, as opposed to hardcoded IPs seen\nin earlier specimens. The following table shows all observed c2s with the latest cipher\n(%q*KC)&F98fsr2to4b3yi_:wB>z=;!k?”EAZ7.D-md<ex5U~h,j|$v6c1ga+p@un).\n\nEncoded c2 Decoded count\n\n?>K!tF>iorZ:ww_uBw3Bw vp3te7pkfczmnnl.onion 126\n\nC)uqC)uq9)u9K 45.145.185.83 6\n\nC)uq)Ku*%Kuq*C 45.153.203.124 7\n\nSince February, there have been over 120 observed specimens using the .onion c2. These\nnewer binaries are being served off several IPs belonging to DediPath and ColoCrossing which\nare also two of the top sources of Mirai malware.\n\nMalware URL ASN\n\nhttp://45.153.203.242/bins/fagbinz.sh4 DediPath\n\nhttp://45.153.203.124/S1eJ3/lPxdChtp3zsh4 DediPath\n\nhttp://172.245.36.128/S1eJ3/lPxdChtp3zx86 ColoCrossing\n\nhttp://45.144.225.96/S1eJ3/IObeENwjm68k DediPath (irc.kek.org)\n\nhttp://45.145.185.83/S1eJ3/IObeENwjsh4 DediPath (irc.kek.org)\n\nhttp://45.144.225.65/S1eJ3/IObeENwjx86 DediPath\n\nTwo of the malware distribution IPs (45.144.225.96 & 45.145.185.83) are also part of Keksec’s\n**IRC infrastructure as shown with the irc.keksec.org banner in Shodan (Figure 1). Note:**\nkeksec.org is only the name for the IRC server is not a registered domain. On one of the\nendpoints an XMRig installation script was also captured by Shodan scanners.\n\n\n-----\n\nFigure 1 – Keksec Banners – Shodan\n\nSimilar to TeamTNT, Keksec has self-attributed their attacks in the past by using their name in\nthe malware and infrastructure. Despite this, the new Kaiten specimens were not given ‘keksec’\nnames, nor were there any Keksec static artifacts. The following table shows historic examples:\n\nType Examples\n\nfilenames ayylmao420kekuaintgettindesebinssh4\n\nkeksec.ppc\n\nkeksec.mips\n\nNetwork irc.kek.org\n\nkek.gay\n\nStrings keksec\n\nkeksec rox\n\nkeksec ROX\n\n**Necro**\n\nSimultaneously with the new Tor functionality in the Kaiten binaries, Keksec also started using\nTor proxies in the custom Necro payloads. Necro is the name for Keksec’s obfuscated python\n[IRC malware, with the latest version documented by Net360. Key features of note in latest](https://blog.netlab.360.com/necro-shi-yong-tor-dong-tai-yu-ming-dga-shuang-sha-windows-linux/)\nNecro variants:\n\nInstalls Tor, leverages hardcoded proxies\n\nA full list of proxies is provided in our indicator list\n\n\n-----\n\nTargets both Windows and Linux\n\nRootkit functionality for Windows\nExploits Laravel, Weblogic vulnerabilities\n\nCVE-2020-14882\nCVE-2021-3129\nEmploys new DGA with NO-IP.COM Dynamic domains\n\nNecro is characterized by its unique obfuscations which leverages a combination of zlib\n[compression and a multibyte XOR key. These samples can be decoded with a script provided](https://github.com/lacework/lacework-labs/blob/master/keksec/keksec_necro_decoder.py)\nby Lacework Labs.\n\nFigure 2 – Before and after example – ZLIB + XOR obfuscation\n\nFollowing deobfuscation, the proxy configurations and Tor installation commands are easily\nobservable. Similarly, the DGA algorithm is identifiable. The following python generates all\n[possible Necro DGA domains. To date, only domain ntxkg0la99w.zapto.org has been seen in](https://github.com/lacework/lacework-labs/blob/master/keksec/keksec_dga_domains.txt)\nthe wild.\n\n\n-----\n\n```\n import random\n\n counter_=0\n\n while 1:  \n\n   if counter_>=0xFF:\n\n     break    \n\n   counter_ +=1\n\n   random.seed(a=0x7774DEAD + counter_)\n\n   dgadomain_=\n (''.join(random.choice(\"abcdefghijklmnopqoasadihcouvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456\n 789\") for _ in range(random.randrange(10,19)))).lower()   \n\n dgadomain_+=\".\"+random.choice([\"ddns.net\",\"ddnsking.com\",\"3utilities.com\",\"bounceme.net\",\n\n \"freedynamicdns.net\",\"freedynamicdns.org\",\"gotdns.ch\",\"hopto.org\",\n\n \"myddns.me\",\"myftp.biz\",\"myftp.org\",\"myvnc.com\",\"onthewifi.com\",\n\n \"redirectme.net\",\"servebeer.com\",\"serveblog.net\",\"servecounterstrike.com\",\n\n \"serveftp.com\",\"servegame.com\",\"servehalflife.com\",\"servehttp.com\",\n\n \"serveirc.com\",\"serveminecraft.net\",\"servemp3.com\",\"servepics.com\",\n\n \"servequake.com\",\"sytes.net\",\"viewdns.net\",\"webhop.me\",\"zapto.org\"])\n\n   print(dgadomain_)\n\n\n```\n**Personas**\n\nKek Security is comprised of at least 4 individuals, the most renown of which goes by “Freak”.\nHandles for other members include “horsewithnoname”, “Tyrant”, and “Moony”. Freak is the\nauthor of the Necro malware which dates as far back as 2015. He also maintains a GitHub with\n[various repositories including those with an older Necro version, a Windows rootkit loader,](https://github.com/freakanonymous/freakout/blob/main/out.py)\n[darkIrc source code, and exploit code for the recently disclosed vulnerability affecting](https://securityboulevard.com/2021/02/attackers-collaborate-to-exploit-cve-2021-21972-and-cve-2021-21973/)\nVMware’s vCenter.\n\n\n-----\n\nFigure 3 -@freakanonymous\n\nWhile Keksec’s github was recently created in January 2021, they also administer a pastebin\nwith pastes starting in 2014. The Keksec pastebin has various custom tools including scanners,\nexploits and crypters. One of the pastes is the python code used for obfuscating earlier versions\nof Necro using zlib compression without the additional XOR encoding.\n\n\n-----\n\nFigure 4 -Necro Obfuscator\n\nLacework recently blogged about another group named TeamTNT who shares multiple\nsimilarities with regards to general tactics. For example, both are self-promoters with a social\nmedia presence. Also, both leverage the Kaiten source and self-attribute their code and\ninfrastructure. There is also evidence that the two groups are acquainted at some level as the\n[TeamTNT associated GitHub account, @jwne is only one of 5 followers of @freakanonymous.](https://github.com/jwne)\n\nFor more details on TeamTNT, refer to our **[blog.](https://www.lacework.com/teamtnt-builds-botnet-from-chinese-cloud-servers/)**\n\n**[Indicators and Tools for this activity are available on our GitHub. If you found this blog useful](https://github.com/lacework/lacework-labs/tree/master/keksec)**\n[then please share and follow us on Twitter!](https://twitter.com/laceworklabs)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-18 - The “Kek Security” Network.pdf"
    ],
    "report_names": [
        "2021-03-18 - The “Kek Security” Network.pdf"
    ],
    "threat_actors": [
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5a270f6c-2c13-4abf-861e-7d44dcfa5ceb",
            "created_at": "2023-11-03T02:00:07.794425Z",
            "updated_at": "2025-03-27T02:00:03.146871Z",
            "deleted_at": null,
            "main_name": "Keksec",
            "aliases": [],
            "source_name": "MISPGALAXY:Keksec",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1680660538,
    "ts_updated_at": 1743041531,
    "ts_creation_date": 1680510546,
    "ts_modification_date": 1680510546,
    "files": {
        "pdf": "https://archive.orkl.eu/160140a742081ea0d42ae86eb69892fb9e04fd33.pdf",
        "text": "https://archive.orkl.eu/160140a742081ea0d42ae86eb69892fb9e04fd33.txt",
        "img": "https://archive.orkl.eu/160140a742081ea0d42ae86eb69892fb9e04fd33.jpg"
    }
}