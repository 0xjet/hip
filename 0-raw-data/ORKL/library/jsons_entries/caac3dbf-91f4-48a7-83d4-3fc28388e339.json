{
    "id": "caac3dbf-91f4-48a7-83d4-3fc28388e339",
    "created_at": "2023-01-12T15:07:02.552641Z",
    "updated_at": "2025-03-27T02:05:39.491911Z",
    "deleted_at": null,
    "sha1_hash": "f31f9890c3ed75ca1bc93c46a2fbca71d0c0ae5a",
    "title": "2020-01-30 - TrickBot Uses a New Windows 10 UAC Bypass to Launch Quietly",
    "authors": "",
    "file_creation_date": "2022-05-27T01:59:36Z",
    "file_modification_date": "2022-05-27T01:59:36Z",
    "file_size": 302244,
    "plain_text": "# TrickBot Uses a New Windows 10 UAC Bypass to Launch Quietly\n\n**[bleepingcomputer.com/news/security/trickbot-uses-a-new-windows-10-uac-bypass-to-launch-quietly/](https://www.bleepingcomputer.com/news/security/trickbot-uses-a-new-windows-10-uac-bypass-to-launch-quietly/)**\n\nLawrence Abrams\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nJanuary 30, 2020\n03:54 PM\n1\n\nThe TrickBot Trojan has switched to a new Windows 10 UAC bypass to execute itself with\nelevated privileges without showing a User Account Control prompt.\n\nWindows uses a security mechanism called User Account Control (UAC) that will display a\nprompt every time a program is run with administrative privileges.\n\nWhen these prompts are shown, they will ask logged in user if they wish to allow the\nprogram to makes changes, and if the program is suspicious or unrecognized, allows the\nuser to prevent the program from running.\n\n\n-----\n\n**UAC Prompt**\n\nThese UAC bypasses are found in legitimate Microsoft Windows programs that are used by\nthe operating system to launch other programs. As they are not considered a high priority to\nMicrosoft, it could be a while before discovered bypasses are fixed, if at all.\n\nTo avoid being detected, malware developers sometimes use a UAC bypass so that the\nmalware runs with administrative privileges, but without displaying a UAC prompt and\nalerting the user.\n\n## Trickbot switches to the Wsreset.exe UAC bypass\n\nJust recently we reported that TrickBot had [begun using a Windows 10 UAC bypass that](https://www.bleepingcomputer.com/news/security/trickbot-now-uses-a-windows-10-uac-bypass-to-evade-detection/)\nutilizes the legitimate Microsoft fodhelper.exe program.\n\n[This week, ReaQta discovered that TrickBot has now switched to a different UAC bypass](https://twitter.com/ReaQta/status/1222548288731217921?s=20)\nthat [utilizes the Wsreset.exe program.](https://www.activecyber.us/activelabs/windows-uac-bypass)\n\nWsreset.exe is a legitimate Windows program used to reset the Windows Store cache.\n\nWhen executed, Wsreset.exe will read a command from the default value of the\nHKCU\\Software\\Classes\\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\\Shell\\open\\command\nkey and execute it.\n\nWhen executing the command it will not display a UAC prompt and users will have no idea\nthat a program has been executed.\n\nTrickBot is now exploiting this UAC bypass to launch itself with elevated privileges,\nbut without the logged in Windows user being notified by a UAC prompt.\n\n\n-----\n\n**Registry commands added by TrickBot**\n\nSource: [ReaQta](https://twitter.com/ReaQta)\nThis allows the trojan to run silently in the background while it harvests saved login\ncredentials, SSH keys, browser history, cookies, and more.\n\nTrickBot is particularly dangerous as it can propagate throughout the network and if it gains\nadmin access to a domain controller, it can [steal the Active Directory database to gain](https://www.bleepingcomputer.com/news/security/trickbot-now-steals-windows-active-directory-credentials/)\nfurther credentials on the network.\n\nEventually, TrickBot is known to open a reverse shell back to the Ryuk Ransomware actors\nso that they can encrypt the entire compromised network.\n\n**[Update 1/30/20: MorphiSec published analysis of TrickBot using the Wsreset.exe UAC](https://blog.morphisec.com/trickbot-uses-a-new-windows-10-uac-bypass)**\nbypass and it's great read for those who want a more technical nosedive.\n\n_H/T_ _[@gN3mes1s](https://twitter.com/gN3mes1s)_\n\n### Related Articles:\n\n[Ukraine warns of “chemical attack” phishing pushing stealer malware](https://www.bleepingcomputer.com/news/security/ukraine-warns-of-chemical-attack-phishing-pushing-stealer-malware/)\n\n[Pixiv, DeviantArt artists hit by NFT job offers pushing malware](https://www.bleepingcomputer.com/news/security/pixiv-deviantart-artists-hit-by-nft-job-offers-pushing-malware/)\n\n[Google exposes tactics of a Conti ransomware access broker](https://www.bleepingcomputer.com/news/security/google-exposes-tactics-of-a-conti-ransomware-access-broker/)\n\n[New powerful Prynt Stealer malware sells for just $100 per month](https://www.bleepingcomputer.com/news/security/new-powerful-prynt-stealer-malware-sells-for-just-100-per-month/)\n\n[New ZingoStealer infostealer drops more malware, cryptominers](https://www.bleepingcomputer.com/news/security/new-zingostealer-infostealer-drops-more-malware-cryptominers/)\n\n[Malware](https://www.bleepingcomputer.com/tag/malware/)\n[Password Stealing Trojan](https://www.bleepingcomputer.com/tag/password-stealing-trojan/)\n[TrickBot](https://www.bleepingcomputer.com/tag/trickbot/)\n[UAC Bypass](https://www.bleepingcomputer.com/tag/uac-bypass/)\n[Windows 10](https://www.bleepingcomputer.com/tag/windows-10/)\n\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\n\n\n-----\n\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/news/security/microsoft-launches-xbox-bounty-program-with-20k-maximum-payout/)\n[Next Article](https://www.bleepingcomputer.com/news/security/nec-defense-contracts-info-potentially-compromised-in-breach/)\n\n### Comments\n\n[RocketPak - 2 years ago](https://www.bleepingcomputer.com/forums/u/1132364/rocketpak/)\n\nSet UAC to always notify even when changing windows settings and you'll still get a\nUAC pop up if this happens.\n\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-30 - TrickBot Uses a New Windows 10 UAC Bypass to Launch Quietly.pdf"
    ],
    "report_names": [
        "2020-01-30 - TrickBot Uses a New Windows 10 UAC Bypass to Launch Quietly.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536022,
    "ts_updated_at": 1743041139,
    "ts_creation_date": 1653616776,
    "ts_modification_date": 1653616776,
    "files": {
        "pdf": "https://archive.orkl.eu/f31f9890c3ed75ca1bc93c46a2fbca71d0c0ae5a.pdf",
        "text": "https://archive.orkl.eu/f31f9890c3ed75ca1bc93c46a2fbca71d0c0ae5a.txt",
        "img": "https://archive.orkl.eu/f31f9890c3ed75ca1bc93c46a2fbca71d0c0ae5a.jpg"
    }
}