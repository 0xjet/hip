{
    "id": "33db5914-bb11-4676-aa6d-364d24f10548",
    "created_at": "2023-01-12T15:02:09.227488Z",
    "updated_at": "2025-03-27T02:05:33.84266Z",
    "deleted_at": null,
    "sha1_hash": "67a7598738f0c386c98626d43c19b10b2fa36da6",
    "title": "2018-08-08 - Export JRAT-Adwind Config with x32dbg",
    "authors": "",
    "file_creation_date": "2022-05-28T16:10:58Z",
    "file_modification_date": "2022-05-28T16:10:58Z",
    "file_size": 400454,
    "plain_text": "# Export JRAT/Adwind Config with x32dbg\n\n**[dissectingmalware.blogspot.com/2018/08/export-jratadwind-config-with-x32dbg.html](https://dissectingmalware.blogspot.com/2018/08/export-jratadwind-config-with-x32dbg.html)**\n\nMlwrDssctng\n\nIn this blog post I'll explain how you can export the config of JRAT/Adwind to gather further\ninsight into this kind of malware. The trick is, that you must be aware that JRAT/Adwind\ncreates a fake JAR and config at the beginning to confuse analysts.\n\nAfterwards, the real config and JAR are run.\n\n**Step 1:**\n\nStart x32dbg\n\n\n-----\n\n**Step 2:**\n\nOpen java.exe\n\n**Step 3:**\n\nUnder Debug, choose \"Change Command Line\"\n\n**Step 4:**\n\nPoint it to your suspected JRAT/Adwind JAR file\n\n**Step 5:**\n\n\n-----\n\nCreate a Breakpoint on \"CreateProcessInternalW\"\n\nHint: As mentioned earlier this Breakpoint will be hit multiple times since JRAT starts multiple\nprocesses (for example to detect AV solutions with the help of WMI etc.) so you should watch\nthe Stack Windows of x32dbg to find the \"real\" call.\n\n**Step 6:**\n\nSo after hitting the breakpoint multiple times you should see something like this:\n\nAdwind is about to start the real JAR and thus we can be sure that the real config must be\nsomewhere in memory.\n\n**Step 7:**\n\nSwitch to Memory Map and rightclick and click \"Find pattern\"\n\n\n-----\n\n**Step 8:**\n\nSince I've seen Adwind/JRAT configs multiple times, I know that the word \"DELAY_INSTALL\"\nis found somewhere in the config so let's search for this string since it's pretty unique. You\nwill find multiple matches:\n\n**Step 9:**\n\nDouble click on them to open the CPU View and look if it is the right config. Hint: If the\nDNS_SERVER in the config is pointing to 127.0.0.1 you are looking at the dummy config\nwhich is not what you are looking for so repeat step 8 until you catch the right one.\n\n**Step 10:**\n\nOnce you found the right config mark the text, right click on it, choose \"Binary\" and \"Save to\nfile\"\n\n**Congratulations! You exported your first Adwind/JRAT config!**\n\n## Installing Rudra to analyze PCAPs and PE files\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-08-08 - Export JRAT-Adwind Config with x32dbg.pdf"
    ],
    "report_names": [
        "2018-08-08 - Export JRAT-Adwind Config with x32dbg.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535729,
    "ts_updated_at": 1743041133,
    "ts_creation_date": 1653754258,
    "ts_modification_date": 1653754258,
    "files": {
        "pdf": "https://archive.orkl.eu/67a7598738f0c386c98626d43c19b10b2fa36da6.pdf",
        "text": "https://archive.orkl.eu/67a7598738f0c386c98626d43c19b10b2fa36da6.txt",
        "img": "https://archive.orkl.eu/67a7598738f0c386c98626d43c19b10b2fa36da6.jpg"
    }
}