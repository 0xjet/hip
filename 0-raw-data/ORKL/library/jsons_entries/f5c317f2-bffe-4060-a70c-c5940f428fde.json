{
    "id": "f5c317f2-bffe-4060-a70c-c5940f428fde",
    "created_at": "2023-01-12T14:59:27.922718Z",
    "updated_at": "2025-03-27T02:06:05.47459Z",
    "deleted_at": null,
    "sha1_hash": "3a9e756b2ffbf51e50b41efa9b92b3e8cf910cf4",
    "title": "2020-07-08 - “EvilQuest” Rolls Ransomware, Spyware & Data Theft Into One",
    "authors": "",
    "file_creation_date": "2022-05-28T19:55:50Z",
    "file_modification_date": "2022-05-28T19:55:50Z",
    "file_size": 2904926,
    "plain_text": "# “EvilQuest” Rolls Ransomware, Spyware & Data Theft Into One\n\n**[sentinelone.com/blog/evilquest-a-new-macos-malware-rolls-ransomware-spyware-and-data-theft-into-one/](https://www.sentinelone.com/blog/evilquest-a-new-macos-malware-rolls-ransomware-spyware-and-data-theft-into-one/)**\n\nJuly 8, 2020\n\n[There has, unsurprisingly, been a great deal of interest in the news that a new](https://labs.sentinelone.com/breaking-evilquest-reversing-a-custom-macos-ransomware-file-encryption-routine/) [macOS threat](https://sentinelone.com/blog/tag/macos-security-sentinelone/)\nwith [ransomware capabilities is on the loose. First brought to the macOS community’s](https://www.sentinelone.com/blog/ransomware-a-complex-attack-needs-a-sophisticated-defense/)\n[attention by malware researcher Dinesh Devadoss, this threat has been receiving intense](https://twitter.com/dineshdina04)\nscrutiny from security researchers, with some excellent work done by researchers Scott\nKnight, [Patrick Wardle and our own SentinelLabs team. As it turns out, this threat is much](https://objective-see.com/blog/blog_0x59.html)\nmore than just a novel piece of ransomware, is under active development, and is one of the\nmore complex threats to be seen so far targeting the Mac platform. In this post, we’ll cover\nwhat is known to date and bring you up-to-speed on the latest iterations.\n\n\n-----\n\n## The Many Names of EvilQuest, ThiefQuest, and MacRansom.K\n\nThe threat was initially labelled “EvilQuest” by researchers at Malwarebytes, who then renamed it a few days later as “ThiefQuest”. Aside from the two names they suggested, many\nengines on VT also flag it as MacRansom.K.\n\n\n-----\n\nThis has led to some confusion, unfortunately, both about the threat and its capabilities.\n\nWhile Mac.Ransom.K does conform to a recognized convention (platform/type/variant), it’s\nproblematic because the threat is not only, and perhaps not even primarily, a ransomware\nthreat. As malware authors on all platforms are increasingly reusing code to provide multiple\nfeatures, classifying by threat type may not be all that helpful.\n\n[A good malware naming convention would ideally group malware samples by common](https://www.gdatasoftware.com/blog/2019/08/35146-taming-the-mess-of-av-detection-names)\ncharacteristics. On that score, the most common characteristic in the samples seen so far is\nthe `__cstring literal “toidievitceffe”, which along with other strings like “rennur.c” (c.runner)`\nis clearly the reverse of otherwise recognizable English language words:\n```\necho 'toidievitceffe' | rev\neffectiveidiot\n\n```\nMoreover, we see the developers clearly used “toidievitceffe” as the name of their Xcode\nproject.\n\nOther interesting reversed strings here include “naughtycuckoo”, “keylogger” and\n“filewatcher”, which as we will explain further below may give a better insight into the threat\nactor’s true motivation.\n\nIn some samples, the reversed “effectiveidiot” string occurs over 60 times, which might\nsuggest the malware authors themselves were rather fond of the idea that security\n[researchers would hit on this for a name. Here we use the excellent floss tool to extract](https://github.com/fireeye/flare-floss)\n\n\n-----\n\nstrings as an alternative to the native `strings utility:`\n\nMoreover, string obfuscation in recent samples shows that the developers deliberately\nplanted the user name “drozdovsky” and the build name ‘toidievitceffe”, no doubt in an\nattempt to misdirect attribution.\n\nWhile it could be argued that malware naming conventions aren’t vitally important, they are\nnevertheless helpful, particularly for researchers and others tracking evolving public\ndiscussion and research. Despite there being a strong argument for calling this new threat\n“OSX.EffectiveIdiot”, we suspect that this naming muddle is probably a bed that cannot be\nunmade. “EvilQuest/ThiefQuest” will likely stick simply because of its widespread initial use\nin the media, and who doesn’t like a thief or a good bit of evil in a headline anyway?\n\n## Broken Crypto: Ransomware Capabilities, Just for Show?\n\nAs the initial excitement around “EvilQuest/ThiefQuest” stemmed from it being a novel\n[macOS ransomware threat, let’s look at that first. Ransomware has been pillaging the](https://labs.sentinelone.com/?s=ransomware)\nWindows world of late, but this is only the third known ‘in the wild’ ransomware targeting\nmacOS. That in itself is odd, since Macs are now widely used in enterprise environments,\n[particularly by C-Suite staff and by developers, both juicy targets for threat actors. Thus,](https://www.sentinelone.com/resources/threat-actor-basics-understanding-the-5-main-threat-types/)\nappearance of what looks like a Mac ransomware is both novel and, in a sense, not\nunexpected.\n\nHowever, as ransomware goes, “EvilQuest/ThiefQuest” fails pretty much on any measure of\nsuccess. First and foremost, if you’re going to extort money by encrypting people’s files, you\nare going to want to make your encryption unbreakable. Crypto is hard, and about the one\nthing everyone who is smart enough to do it will tell you is this: don’t try and roll your own,\nbecause you will inevitably do it wrong. Successful ransomware operators are smart enough\nto follow that advice and will use established encryption algorithms, typically with at least\nsome component being asymmetric; in other words, requiring access to a private key held\nonly by the attacker.\n\nOur “EffectiveIdiot” developers chose to forego that option, and opted for a symmetric key\nencryption, meaning the same key that encrypts a file is used to decrypt it. Even better, as\n[our research lead at SentinelLabs Jason Reaves discovered:](https://twitter.com/sysopfb)\n\n“…the clear text key used for encoding the file encryption key ends up being appended to the\nencoded file encryption key. Taking a look at a completely encrypted file shows that a block\nof data has been appended to it.”\n\n\n-----\n\n[This allowed Jason and the SentinelLabs team to create a public decryptor that can be used](https://labs.sentinelone.com/breaking-evilquest-reversing-a-custom-macos-ransomware-file-encryption-routine/)\n[by anyone unfortunate enough to have been a victim of this malware. This video shows how](https://assets.sentinelone.com/evilquest/436134590)\nto use it:\n\nWatch EvilQuest Ransomware Decryptor in Action\n[Watch Now](https://assets.sentinelone.com/evilquest/436134590)\nAside from making the crypto reasonably bulletproof, a ransomware operator will want a\ngood reward for their effort. Perhaps the first hint of something amiss with the\n“EvilQuest/ThiefQuest” malware was the ransom note itself.\n\nTwo things stand out: the incredibly low amount of ransom, and the fact that there is no email\nor other means of contact for the victim to communicate with the attacker. Again, using the\nmodel from the Windows world, ransomware operators have become very slick and efficient\nat pushing the right buttons to get people to pay. These include a mixture of threats and\nreassurance, and even levels of customer support. Not so here. The ransom note amounts\nto: ‘send us your money; we’ll be in touch”, only there’s no way for you to tell the threat\nactors that you paid; no request for your contact address; and no request for a sample\nencrypted file or any other identifying factor. The classic brush-off “Don’t call us, we’ll call\nyou” springs to mind here.\n\nUnsurprisingly, the threat actors have not been amassing a fortune. To date, the one known\n[BitCoin address common to all the samples has had exactly zero transactions.](https://www.blockchain.com/btc/address/13roGMpWd7Pb3ZoJyce8eoQpfegQvGHHK7)\n\n\n-----\n\n[Finally, on the ransomware component, SentinelLabs also noted that the decryption routine,](https://labs.sentinelone.com/)\n```\nuncarve_target, has no callers in the code, suggesting either that the functionality is\n\n```\nincomplete or that the authors decided that decryption wasn’t something they ever intended\nto offer (in which case, we could speculate that presence of the decryption routine in the\ncode is an artifact of earlier testing).\n\n## Who Shares? A Data Thief in the Shared Folder\n\nAs details such as the above have emerged, attention has turned to the malware’s other\ncapabilities, in particular the fact that it downloads and executes three Python scripts from\nthe /Users/Shared folder. These scripts are intended to search for and exfiltrate files with\nparticular extensions:\n\nThe scripts vary in name across samples, but initially the following short names were used:\n\n\n-----\n\n```\n/Users/Shared/.dr\n/Users/Shared/.p\n/Users/Shared/.gp\n\n```\nMoreover, there’s more to the malware’s data stealing capabilities locked inside the invisible\nMach-O binaries deposited in the user’s Library folder.\n\nNote the following encrypted strings:\n\n[We can use a tool developed by fellow macOS researcher Scott Knight to decrypt these,](https://github.com/carbonblack/tau-tools/blob/master/malware_specific/ThiefQuest/thiefquest_decrypt.py)\nwhich reveals the following in plain text:\n```\nbytearray(b'*id_rsa*/ix00')\nbytearray(b'*.pem/ix00')\nbytearray(b'*.ppk/ix00')\nbytearray(b'known_hosts/ix00')\nbytearray(b'*.ca-bundle/ix00')\n\n```\nIt would appear that the malware is seeking SSH keys and trusted certificates in order to\nfacilitate the ability to log in remotely and manipulate web browsers to trust sites without\nthrowing security warnings.\n\n[As other researchers have noted, there is also ample evidence of keylogging functionality](https://objective-see.com/blog/blog_0x59.html)\n[through the existence of API calls targeting low-level hardware events like key presses. Note](https://developer.apple.com/documentation/coregraphics/cgevent)\nthe first half of the function name, reversed, and with a possible typo for “file” as “klgr_flie”:\n\n\n-----\n\nIt s also worth noting that unlike wiper malware and other aggressive ransomware variants\non other platforms, the ransomware component doesn’t really interfere with the user’s\n[ongoing use of the device. A simple osascript-generated alert dialog informs the user of the](https://www.sentinelone.com/blog/how-offensive-actors-use-applescript-for-attacking-macos/)\nsituation:\n\nPressing “OK” dismisses the dialog and allows the user to continue using the machine, which\nis indeed handy for the spyware components!\n\n## New Variant Calls Out macOS Researcher\n\nA good deal of the early technical details were published by macOS researcher Patrick\n[Wardle, and rather than repeat all the details here we refer you to his excellent posts here on](https://objective-see.com/blog/blog_0x60.html)\nthe early “AppQuest” sample first spotted last week. Wardle suggests the malware has viral\ncapabilities and there are also other suggestions that the malware attempts to infect existing\nexecutables in the User’s home folder, although that behaviour was not seen in our tests.\n\nSince the earlier research, new variants have appeared with updated hardcoded strings and\npaths. In particular, there is a nod to Wardle’s research in the method “react_ping”, which\ncontains the encrypted string “Hello Patrick”.\n\n\n-----\n\nThe recent version also updates the hardcoded C2 address from the earlier\n```\n167.71.237.219 to 159.65.147.28 and includes Wardle’s “Knock Knock” reporting tool\n\n```\nin its list of software to check for:\n\nOther new changes include using “abtpd” for the executable label. There are suggestions in\nthe code that “.ab**d” may be a variant across different installs, but we have not confirmed\nthat at the time of writing. Instead of using the folder name “AppQuest”, the persistence\nagent now points to an attacker-created folder named “PrivateSync”.\n\n\n-----\n\nSimilarly, in the early samples, an invisible, plain text file containing a 43-byte string was\ndropped at `/var/root/ and` `/Users/User1/ with the name “.ncspot”. In the latest`\nsample we tested, the spot file dropped in the same locations but now with the name\n“.aespot”.\n\nBased on the rapid iteration so far, we would expect all these details to change within days, if\nnot hours.\n\n## Protecting Against EvilQuest/ThiefQuest macOS Malware\n\nThe [SentinelOne platform effectively protects your enterprise against EvilQuest/ThiefQuest.](https://www.sentinelone.com/platform/)\n\nHow SentinelOne Protects Against the EvilQuest macOS Ransomware\n[Watch Now](https://assets.sentinelone.com/evilquest/436127898)\nFor those not protected by SentinelOne, if you have fallen victim to this malware we\nrecommend a complete restore from a known-good backup. Also, due to the keylogging and\nother spyware functions, it would be advisable to change any passwords and reset SSH and\ncertificate trust credentials.\n\n[If you have files encrypted by EvilQuest, our public decryptor tool is available from here.](https://labs.sentinelone.com/breaking-evilquest-reversing-a-custom-macos-ransomware-file-encryption-routine/)\n\n## Conclusion\n\n\n-----\n\nCall it EffectiveIdiot, ThiefQuest or EvilQuest, the appearance of this combination\nransomware-data thief-spyware is a significant development. Not only did it catch a lot of\nsecurity tools unaware, it may have also wrong-footed victims into continuing to use their\ninfected machines and leak vital data while they sought a solution to the apparent problem of\nencrypted files. As ever, we urge macOS users to [heed the warning that malware is no](https://www.sentinelone.com/blog/macos-security-so-how-do-macs-get-infected-with-malware/)\nlonger the sole preserve of Windows environments and to ensure they have adequate\nsecurity.\n\n## Sample Hashes\n\n`06974e23a3bf303f75c754156f36f57b960f0df79a38407dfdef9a1c55bf8bff` **Mach-O**\n\n`d18daea336889f5d7c8bd16a4d6358ddb315766fa21751db7d41f0839081aee2` **Mach-O**\n\n`c5a77de3f55cacc3dc412e2325637ca7a2c36b1f4d75324be8833465fd1383d3` **Mach-O**\n\n## Indicators of Compromise\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-08 - “EvilQuest” Rolls Ransomware, Spyware & Data Theft Into One.pdf"
    ],
    "report_names": [
        "2020-07-08 - “EvilQuest” Rolls Ransomware, Spyware & Data Theft Into One.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535567,
    "ts_updated_at": 1743041165,
    "ts_creation_date": 1653767750,
    "ts_modification_date": 1653767750,
    "files": {
        "pdf": "https://archive.orkl.eu/3a9e756b2ffbf51e50b41efa9b92b3e8cf910cf4.pdf",
        "text": "https://archive.orkl.eu/3a9e756b2ffbf51e50b41efa9b92b3e8cf910cf4.txt",
        "img": "https://archive.orkl.eu/3a9e756b2ffbf51e50b41efa9b92b3e8cf910cf4.jpg"
    }
}