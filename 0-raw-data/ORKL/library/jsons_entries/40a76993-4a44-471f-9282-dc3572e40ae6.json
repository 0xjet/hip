{
    "id": "40a76993-4a44-471f-9282-dc3572e40ae6",
    "created_at": "2023-01-12T15:09:42.250544Z",
    "updated_at": "2025-03-27T02:10:19.88784Z",
    "deleted_at": null,
    "sha1_hash": "7c71a0360726a0b7a281e33fc2b2713c017613f1",
    "title": "2022-02-17 - Detecting Karakurt – an extortion focused threat actor",
    "authors": "",
    "file_creation_date": "2022-05-27T21:35:29Z",
    "file_modification_date": "2022-05-27T21:35:29Z",
    "file_size": 139319,
    "plain_text": "# Detecting Karakurt – an extortion focused threat actor\n\n**[research.nccgroup.com/2022/02/17/detecting-karakurt-an-extortion-focused-threat-actor/](https://research.nccgroup.com/2022/02/17/detecting-karakurt-an-extortion-focused-threat-actor/)**\n\nFebruary 17, 2022\n\nAuthored by: Simon Biggs, Richard Footman and Michael Mullen\n\n## tl;dr\n\nNCC Group’s Cyber Incident Response Team (CIRT) have responded to several extortion\ncases recently involving the threat actor Karakurt.\n\nDuring these investigations NCC Group CIRT have identified some key indicators that the\nthreat actor has breached an environment and we are sharing this intelligence to assist the\ncyber defense security community.\n\n\n-----\n\nIt is thought that there may be a small window to respond to an undetected Karakurt breach\nprior to data exfiltration taking place and we strongly urge any organisations that use single\nfactor Fortinet VPN access to use the information from the detection section of this blog to\nidentify if they may have been breached.\n\n## Initial Access \n\nIn all cases investigated, Karakurt have targeted single factor Fortigate Virtual Private\nNetwork (VPN) servers.\n\nIt was observed that access was made using legitimate Active Directory credentials for the\nvictim environment.\n\nThe typical Dwell time (Time from threat actor access to detection) has been in the region of\njust over a month, in part due to the fact the group do not encrypt their victims and use “living\noff the land” techniques to remain undetected by not utilising anything recognised as\nmalware.\n\nIt is not clear how these credentials have been obtained at this stage with the VPN servers in\nquestion not being vulnerable to the high profile Fortigate vulnerabilities that have had\nattention over the past couple of years.\n\nNCC Group strongly recommends that any organisation utilising single factor authentication\non a Fortigate VPN to search for the indicators of compromise detailed at the conclusion of\nthis blog.\n\n## Privilege Escalation \n\nKarakurt have obtained access to domain administrator level privileges in all of the\ninvestigated cases, but the privilege escalation method has not yet been accurately\ndetermined.\n\n[In one case, attempts to exploit CVE-2020-1472, also known as Zerologon, were detected by](https://nvd.nist.gov/vuln/detail/cve-2020-1472)\nsecurity software. The actual environment was not vulnerable to Zerologon however\nindicating Karakurt may be attempting to exploit a number of vulnerabilities as part of their\noperation.\n\n## Lateral Movement \n\nKarakurt have then been seen to move laterally onto the primary domain controller of their\nvictim’s using the Sysinternals tool PsExec which provides a multitude of remote\nfunctionality.\n\nKarakurt have also utilised Remote Desktop Protocol (RDP) to move around victim\nenvironments\n\n\n-----\n\n## Discovery \n\nOnce Karakurt obtain access to the primary domain controller they conduct a number of\ndiscovery actions, enumerating information about the domain controller itself as well as the\nwider domain.\n\nOne particular technique involves creating a DNS Zone export via an Encoded PowerShell\ncommand.\n\nThis command leaves a series of indicators in the Microsoft-Windows-DNS-Server-Service\nEvent Log in the form of Event ID 3150, DNS_EVENT_ZONE_WRITE_COMPLETED.\n\nThis log is interesting as an indicator as it was present in all Karakurt engagements\ninvestigated by NCC Group CIRT and in all cases the only occurrence of these events were\ncaused when Karakurt performed the zone exports. This was conducted very early in the\nbreach just after initial access and prior to data exfiltration occurring, which was typically two\nweeks from initial access.\n\nThis action is also accompanied by extraction of the NTDS.dit file, believed to be utilised by\nKarakurt to obtain further credentials as a means of persistence in the environment should\nthe account they initially gained access with be disabled.\n\nThis is evident through the presence of logs showing the volume shadow service being\nutilised.\n\nNCC Group CIRT strongly recommends that any organisation using single factor Fortinet\nVPN access checks their domain controllers Microsoft-Windows-DNS-Server logs for\nevidence of Event ID 3150. If this is present at any point since December then it may well be\nan indicator of a breach by Karakurt.\n\n## Data Staging \n\nOnce the discovery actions have been completed Karakurt appeared to leave the\nenvironment before re-entering and identifying servers with access to sensitive victim data\non file shares. Once such a server is identified a secondary persistence mechanism was\nutilised in the form of the remote desktop software AnyDesk allowing Karakurt access even if\nthe VPN access was removed.\n\nOn the same server that AnyDesk is installed Karakurt have been identified browsing folders\nlocal to the server and on file shares.\n\n7-Zip archives have then been created on the server.\n\n\n-----\n\nIn the cases investigated there were no firewall logs or other evidence to confirm the data\nwas then exfiltrated but based on the claims from Karakurt along with the file tree text file\nprovided as proof, it is strongly believed that the data was exfiltrated in all cases\ninvestigated.\n\nIt is suspected that Karakurt are utilising Rclone to exfiltrate data to cloud data hosting\nproviders. This technique was discussed in a previous NCC Group blog, Detecting Rclone –\nAn Effective Tool for Exfiltration\n\n## Mitigations \n\nTo remove the threat immediately multi-factor authentication should be implemented for\nVPN access using a Fortinet VPN.\nEnsure all Domain Controllers are fully patched and patch for critical vulnerabilities\ngenerally.\n\n## Detection \n\nLook for evidence of the hosts authenticating from the VPN pool with the naming\nconvention used as default for Windows hosts, for example DESKTOP-XXXXXX.\nCheck for event log 3150 in the Microsoft-Windows-DNS-Server-Service Event Log.\nCheck for unauthorised use of AnyDesk or PsExec in the environment.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-17 - Detecting Karakurt – an extortion focused threat actor.pdf"
    ],
    "report_names": [
        "2022-02-17 - Detecting Karakurt – an extortion focused threat actor.pdf"
    ],
    "threat_actors": [
        {
            "id": "6ad410c7-e291-4327-a54b-281c23f0d4fa",
            "created_at": "2022-10-25T16:07:24.501468Z",
            "updated_at": "2025-03-27T02:02:10.26052Z",
            "deleted_at": null,
            "main_name": "Karakurt",
            "aliases": [],
            "source_name": "ETDA:Karakurt",
            "tools": [
                "7-Zip",
                "Agentemis",
                "AnyDesk",
                "Cobalt Strike",
                "CobaltStrike",
                "FileZilla",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "WinZip",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2af9bea3-b43e-4a6d-8dc6-46dad6e3ff24",
            "created_at": "2022-10-25T16:47:55.853415Z",
            "updated_at": "2025-03-27T02:05:17.401138Z",
            "deleted_at": null,
            "main_name": "GOLD TOMAHAWK",
            "aliases": [
                "Karakurt Lair",
                "Karakurt Team",
                "Karakurt"
            ],
            "source_name": "Secureworks:GOLD TOMAHAWK",
            "tools": [
                " AnyDesk",
                " MEGA",
                " QuickPacket",
                " Rclone",
                " SendGB",
                "7-ZIP"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "079e3d6e-24ef-42b0-b555-75c288f9efd8",
            "created_at": "2023-03-04T02:01:54.105946Z",
            "updated_at": "2025-03-27T02:00:03.122936Z",
            "deleted_at": null,
            "main_name": "Karakurt",
            "aliases": [
                "Karakurt Lair"
            ],
            "source_name": "MISPGALAXY:Karakurt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536182,
    "ts_updated_at": 1743041419,
    "ts_creation_date": 1653687329,
    "ts_modification_date": 1653687329,
    "files": {
        "pdf": "https://archive.orkl.eu/7c71a0360726a0b7a281e33fc2b2713c017613f1.pdf",
        "text": "https://archive.orkl.eu/7c71a0360726a0b7a281e33fc2b2713c017613f1.txt",
        "img": "https://archive.orkl.eu/7c71a0360726a0b7a281e33fc2b2713c017613f1.jpg"
    }
}