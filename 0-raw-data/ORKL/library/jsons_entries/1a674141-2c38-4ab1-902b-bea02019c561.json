{
    "id": "1a674141-2c38-4ab1-902b-bea02019c561",
    "created_at": "2022-10-25T16:48:24.989312Z",
    "updated_at": "2025-03-27T02:13:09.640839Z",
    "deleted_at": null,
    "sha1_hash": "24908852ae8e0ddf8bd67d2357d3666c12a5cf65",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-08-16T01:36:02Z",
    "file_modification_date": "2019-08-16T01:36:02Z",
    "file_size": 409419,
    "plain_text": "# Recent Cloud Atlas activity\n\n**securelist.com/recent-cloud-atlas-activity/92016**\n\nBy GReAT\n\nAlso known as Inception, Cloud Atlas is an actor that has a long history of cyber-espionage\n[operations targeting industries and governmental entities. We first reported Cloud Atlas in 2014](https://securelist.com/cloud-atlas-redoctober-apt-is-back-in-style/68083/)\nand we’ve been following its activities ever since.\n\nFrom the beginning of 2019 until July, we have been able to identify different spear-phishing\ncampaigns related to this threat actor mostly focused on Russia, Central Asia and regions of\nUkraine with ongoing military conflicts.\n\n\n**Countries targeted by Cloud Atlas recently**\n\n\nCloud Atlas hasn’t changed its TTPs (Tactic Tools and Procedures) since 2018 and is still relying\non its effective existing tactics and malware in order to compromise high value targets.\n\nThe Windows branch of the Cloud Atlas intrusion set still uses spear-phishing emails to target\nhigh profile victims. These emails are crafted with Office documents that use malicious remote\ntemplates – whitelisted per victims – hosted on remote servers. We described one of the\ntechniques used by Cloud Atlas in 2017 and our colleagues at Palo Alto Networks also wrote\nabout it in November 2018.\n\nPreviously, Cloud Atlas dropped its “validator” implant named “PowerShower” directly, after\nexploiting the Microsoft Equation vulnerability (CVE-2017-11882) mixed with CVE-2018-0802.\nDuring recent months, we have seen a new infection chain, involving a polymorphic HTA, a new\nand polymorphic VBS implant aimed at executing PowerShower, and the Cloud Atlas second\n[stage modular backdoor that we disclosed five years ago in our first blogpost about them and](https://securelist.com/cloud-atlas-redoctober-apt-is-back-in-style/68083/)\nwhich remains unchanged.\n\n## Let’s meet PowerShower\n\n\n-----\n\nPowerShower, named and previously disclosed by Palo Alto Networks in their blogspot (see\nabove), is a malicious piece of PowerShell designed to receive PowerShell and VBS modules to\nexecute on the local computer. This malware has been used since October 2018 by Cloud Atlas\nas a validator and now as a second stage. The differences in the two versions reside mostly in\nanti-forensics features for the validator version of PowerShower.\n\nThe PowerShower backdoor – even in its later developments – takes three commands:\n\n\n**Com‐**\n**mand**\n\n0x80\n(Ascii\n“P”)\n\n0x79\n(Ascii\n“O”)\n\nDe‐\nfault\n\n\n**Description**\n\nIt is the first byte of the magic PK. The implant will save the received content as a ZIP ar‐\nchive under %TEMP%\\PG.zip.\n\nIt is the first byte of “On resume error”. The implant saves the received content as a VBS\nscript under “%APPDATA%\\Microsoft\\Word\\[A-Za-z]{4}.vbs” and executes it by using\nWscript.exe\n\nIf the first byte doesn’t match 0x80 or 0x79, the content is saved as an XML file under\n“%TEMP%\\temp.xml”. After that, the script loads the content of the file, parses the XML to\nget the PowerShell commands to execute, decodes them from Base64 and invokes IEX.\nAfter executing the commands, the script deletes “%TEMP%\\temp.xml” and sends the\ncontent of “%TEMP%\\pass.txt” to the C2 via an HTTP POST request.\n\n\nA few modules deployed by PowerShower have been seen in the wild, such as:\n\nA PowerShell document stealer module which uses 7zip (present in the received PG.zip) to\npack and exfiltrate *.txt, *.pdf, *.xls or *.doc documents smaller than 5MB modified during\nthe last two days;\nA reconnaissance module which retrieves a list of the active processes, the current user\nand the current Windows domain. Interestingly, this feature is present in PowerShower but\nthe condition leading to the execution of that feature is never met in the recent versions of\nPowerShower;\nA password stealer module which uses the opensource tool LaZagne to retrieve passwords\nfrom the infected system.\n\nWe haven’t yet seen a VBS module dropped by this implant, but we think that one of the VBS\nscripts dropped by PowerShower is a dropper of the group’s second stage backdoor documented\n[in our article back in 2014.](https://securelist.com/cloud-atlas-redoctober-apt-is-back-in-style/68083/)\n\n\n-----\n\nDuring its recent campaigns, Cloud Atlas used a new polymorphic infection chain relying no\nmore on PowerShower directly after infection, but executing a polymorphic HTA hosted on a\nremote server, which is used to drop three different files on the local system.\n\nA backdoor that we name VBShower which is polymorphic and replaces PowerShower as\na validator;\nA tiny launcher for VBShower ;\nA file computed by the HTA which contains contextual data such as the current user,\ndomain, computer name and a list of active processes.\n\nThis “polymorphic” infection chain allows the attacker to try to prevent IoC-based defence, as\neach code is unique by victim so it can’t be searched via file hash on the host.\n\nThe VBShower backdoor has the same philosophy of the validator version of PowerShower. Its\naim is to complicate forensic analysis by trying to delete all the files contained in\n“%APPDATA%\\..\\Local\\Temporary Internet Files\\Content.Word” and “%APPDATA%\\..\\Local\nSettings\\Temporary Internet Files\\Content.Word\\”.\n\nOnce these files have been deleted and its persistence is achieved in the registry, VBShower\nsends the context file computed by the HTA to the remote server and tries to get via HTTP a VBS\nscript to execute from the remote server every hour.\n\nAt the time of writing, two VBS files have been seen pushed to the target computer by VBShower.\nThe first one is an installer for PowerShower and the second one is an installer for the Cloud\nAtlas second stage modular backdoor which communicates to a cloud storage service via\nWebdav.\n\n\n-----\n\nCloud Atlas remains very prolific in Eastern Europe and Central Asia. The actor s massive spearphishing campaigns continue to use its simple but effective methods in order to compromise its\ntargets.\n\nUnlike many other intrusion sets, Cloud Atlas hasn’t chosen to use open source implants during\nits recent campaigns, in order to be less discriminating. More interestingly, this intrusion set hasn’t\n[changed its modular backdoor, even five years after its discovery.](https://securelist.com/cloud-atlas-redoctober-apt-is-back-in-style/68083/)\n\n## IoCs\n\n### Some emails used by the attackers\n\ninfocentre.gov@mail.ru\nmiddleeasteye@asia.com\nsimbf2019@mail.ru\nworld_overview@politician.com\ninfocentre.gov@bk.ru\n\n### VBShower registry persistence\n\nKey : HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\[a-f0-9A-F]{8}\nValue : wscript //B “%APPDATA%\\[A-Za-z]{5}.vbs”\n\n### VBShower paths\n\n%APPDATA%\\[A-Za-z]{5}.vbs.dat\n%APPDATA%\\[A-Za-z]{5}.vbs\n%APPDATA%\\[A-Za-z]{5}.mds\n\n### VBShower C2s\n\n176.31.59.232\n144.217.174.57\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.08.12.Cloud_Atlas_activity/Recent%20Cloud%20Atlas%20activity%20_%20Securelist.pdf"
    ],
    "report_names": [
        "Recent Cloud Atlas activity _ Securelist"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "02c9f3f6-5d10-456b-9e63-750286048149",
            "created_at": "2022-10-25T16:07:23.722884Z",
            "updated_at": "2025-03-27T02:02:09.945869Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK 116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "Inception Framework",
                "Operation Cloud Atlas",
                "Operation RedOctober",
                "The Rocra"
            ],
            "source_name": "ETDA:Inception Framework",
            "tools": [
                "Lastacloud",
                "PowerShower",
                "VBShower"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "04a7ebaa-ebb1-4971-b513-a0c86886d932",
            "created_at": "2023-01-06T13:46:38.784965Z",
            "updated_at": "2025-03-27T02:00:02.91817Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "G0100"
            ],
            "source_name": "MISPGALAXY:Inception Framework",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041589,
    "ts_creation_date": 1565919362,
    "ts_modification_date": 1565919362,
    "files": {
        "pdf": "https://archive.orkl.eu/24908852ae8e0ddf8bd67d2357d3666c12a5cf65.pdf",
        "text": "https://archive.orkl.eu/24908852ae8e0ddf8bd67d2357d3666c12a5cf65.txt",
        "img": "https://archive.orkl.eu/24908852ae8e0ddf8bd67d2357d3666c12a5cf65.jpg"
    }
}