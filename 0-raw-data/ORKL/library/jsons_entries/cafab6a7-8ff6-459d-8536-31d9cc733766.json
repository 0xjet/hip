{
    "id": "cafab6a7-8ff6-459d-8536-31d9cc733766",
    "created_at": "2022-10-25T16:48:17.980736Z",
    "updated_at": "2025-03-27T02:16:25.70752Z",
    "deleted_at": null,
    "sha1_hash": "814556f1a03e93364f4dc54555cb27549288e061",
    "title": "Evil Bunny: Suspect #4",
    "authors": "Marion Marschalek",
    "file_creation_date": "2014-11-20T16:41:48Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 628753,
    "plain_text": "**page | 1**\n\n\n-----\n\n# EVIL BUNNY: SUSPECT #4\n\n\n### SAMPLE DETAILS\n\n**Dropper**\n\nMD5 c40e3ee23cf95d992b7cd0b7c01b8599\nSHA-1 1e8b4c374db03dcca026c5feba0a5c117f740233\nFile Size 943.5 KB (966144 bytes)\nCompile Time 2011-10-25 19:28:00\n\n**Suspect #4**\n\nMD5 3bbb59afdf9bda4ffdc644d9d51c53e7\nSHA-1 1798985f4cc2398a482f2232e72e5817562530de\nFile Size 773.5 KB (792064 bytes)\nCompile Time 2011-10-25 19:28:39\n\n**Marion Marschalek (marion@0x1338.at), 16[th] of October 2014**\n\nBCC0 7607 2FFA BCA8 9048 D648 D169 73AF F372 F2CA\n\nThe EvilBunny attacks have been presented at Hack.lu Conference 2014 in Luxembourg\n\n(http://2014.hack.lu/index.php)\n\nThis work is licensed under a\nCreative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.\n\n\n**page | 2**\n\n\n-----\n\n## CONTENTS\n\n#### 1. THE BUNNY DROPPER..............................................................................4\n\n 2. SUSPECT #4...............................................................................................7\n\n 2.1 MALWARE ANTI-ANALYSIS..................................................................7\n\n 2.1.1 ENUMERATION OF FIREWALL AND ANTIVIRUS PRODUCTS....9\n\n 2.2 SYSTEM INFILTRATION......................................................................10\n\n 2.3 CONFIGURATION AND COMMAND & CONTROL SETTINGS...........10\n\n 2.4 THE MULTI-THREADING MODEL.......................................................12\n\n 2.4.1 PERFORMANCE MONITORING...................................................13\n\n 2.4.2 THE BACKFILE LAUNCHING THREAD........................................14\n\n 2.4.3 THE HEARER THREADS..............................................................14\n\n 2.5 C&C COMMAND PARSING.................................................................15\n\n 2.6 LUA ENGINE INTEGRATION...............................................................17\n\n 3. EVIL BUNNY IN THE SPOTLIGHT............................................................20\n\n 4. ACKNOWLEDGEMENTS..........................................................................22\n\n 5. RESOURCES............................................................................................23\n\n 6. APPENDICES............................................................................................24\n\n**page | 3**\n\n\n-----\n\n## 1. THE BUNNY DROPPER\n\n\nSuspect #4 is the fourth out of a row of malware samples, which are believed to stem from\nthe same malicious actor. Insights on the campaign were first presented at Hack.lu\nConference 2014 in Luxembourg [8]. The name 'EvilBunny' is derived from a link to debug\ninformation embedded in the dropper binary of suspect #4. The path to the associated\n.pdb-file contains the name of the project and sub project, namely 'bunny 2.3.2' and\n'Transporter2'.\n\n\n**Illustration 1: IDA Pro's request for the associated .pdb-file**\n\n\nEvilBunny has been seen spreading through a malicious PDF document, exploiting CVE2011-4369 on 20[th] of December 2011 [1]. The exploit would download the bunny dropper\nand install suspect #4 on the infected system. Both, dropper and payload were compiled\non 25[th] of October 2011, while CVE-2011-4369 was released only on 16[th] of December. It\nis unclear as of when the attacks started; although, clearly, either the attackers adopted\nthe vulnerability within 4 days or the attacks were performed using an AdobeReader 0-day.\n\nThe functionality of the dropper can be summarized in the following steps:\n\n  - Sandbox check and anti virus product enumeration\n\n  - Dropping payload 'netmgr.exe'\n\n  - Creating a registry key for persistence\n\n  - Creating a registry key for deletion of the dropper\n\nSearching for a sandbox environment, the malware takes a number of simple steps to\nverify. It tests the module file name to see if it is less than 5 characters long or if it contains\neither of the four strings 'klavme', 'myapp', 'TESTAPP' or 'afyjevmv.exe'. Also, it verifies if\nless than 15 processes are running in the environment, using the API call EnumProcesses.\n\n**page | 4**\n\n\n-----\n\nIn case any of the conditions is met execution will abort. Up to the time of writing it remains\nunclear which environment the mentioned strings aim to identify, if any.\n\nAccessing the systems WMI\n(Windows Management\nInterface) the malware queries\nthe installed AntiVirus software\nby issuing 'SELECT * FROM\nAntiVirusProduct'. More\nspecifically, the malware is\ninterested in the data fields\n'productUptoDate',\n'VersionNumber', 'DisplayName'\nand 'productState'. The **Illustration 2: The process count as environment check**\ninformation about AntiVirus provided by WMI differs between Windows versions, so the\nrequests address different namespaces, 'ROOT\\SecurityCenter' for WindowsXP and\n'ROOT\\SecurityCenter2' for Windows Vista and newer versions.\n\n\nNames of AntiVirus products are represented as hard coded SHA-256 hashes, namely the\nfollowing:\n\nd4634c9d57c06983e1d2d6dc92e74e6103c132a97f8dc3e7158fa89420647ec3\n4db3801a45802041baa44334303e0498c2640cd5dfd6892545487bf7c8c9219f\nbfe74ca464620a62f11b8c47a3778bb132d84fecd90ce7c75817970f2eeeca51 Antivirus\n443b6fb65fa57d57ee3113e48e9b4ed1db2921d5352e27fa85064cd60553c3ff BitDefender\ne1625a7f2f6947ea8e9328e66562a8b255bc4d5721d427f943002bb2b9fc5645\n588730213eb6ace35caadcb651217bfbde3f615d94a9cca41a31ee9fa09b186c\nf1761a5e3856dceb3e14d4555af92d3d1ac47604841f69fc72328b53ab45ca56 Kaspersky\n\nOnly three of the seven hashes were identified. If any of the indicated products is installed\nand active on the machine execution will abort.\n\nThe dropper comes with its payload attached in the resource section. The resource\nRCData contains the entire netmgr.exe binary; alleged suspect #4. The binary is dropped\nas netmgr.exe, either located in %APPDATA%\\Perf Manager\\ or %WINDIR%\\msapps\\.\nThe final directory location depends whether the dropper is running with administrative\nprivileges or not.\n\nInterestingly, the dropper also changes the creation time stamp of the newly created binary\nto time stamp of the system executable explorer.exe. This serves to avoid raising\nsuspicion of a forensic analysts or tools.\n\nAs a means of persistence the dropper creates an entry under [HKLM|\nHKCU]\\...\\CurrentVersion\\Run which points to the dropped netmgr.exe binary. This\n\n**page | 5**\n\n\n-----\n\nensures that netmgr.exe will be executed every time the system boots. Furthermore, the\ndropper generates another entry in the Windows registry, under [HKLM|\nHKCU]\\Software\\Microsoft\\IPSec. This entry is named 'isakmpAutoNegociate' and points\nto the dropper binary. This key will be requested by netmgr.exe later to locate the dropper\nbinary and delete it.\n\nThe naming of the key for cleanup of the dropper is chosen to confuse analysts, although\nthe name is clearly misspelled.\n\nAnother interesting side fact is that the dropper does not start the dropped malware,\nneither does it contain code which could even do so. This implies, the final infection stage\ndoes not start unless the infected machine is rebooted. Also, the dropper binary will not be\ndeleted in the meanwhile.\n\n**page | 6**\n\n\n-----\n\n## 2. SUSPECT #4\n\n\nSuspect #4 was the fourth discovered sample in a row of malware related to the EvilBunny\nattacks; even before its dropper. Yet, it is by far the most interesting one. It is a multithreaded bot with an integrated scripting engine. It incorporates a Lua engine and\ndownloads and executes Lua scripts to reach a certain level of polymorphism. The Lua\nscripts can call back into the C++ code to alter the malware behavior at runtime.\n\nThe malware seeks to keep a low profile on the infected machine, while executing the\nbotmaster's commands and Lua scripts. In total Suspect #4 exhibits three different\nmethods for receiving C&C input and executing commands; directly via HTTP, through a\ndownloaded database file or as a scheduled task. Also, the malware will generate\nnumerous files to help its execution and frequently reply back to the C&C with status\nmessages.\n\nThe initial purpose of the malware seems to be sharing execution load among infected\nhost machines. However, due to the lack of the original Lua scripts and the extensive\nfunctionality of the embedded Lua engine the original intentions of the attackers remain\nunknown.\n\n#### 2.1 MALWARE ANTI-ANALYSIS\n\nSuspect #4 is written in C++, and just like its dropper, it is not protected by any runtime\npacker or crypter. It is, however, compiled with a performance optimization option which\ncauses a lot of code in-lining and duplicate code in the binary. Duplication also applies to\nstring constants, as every string is present once per function, if the given function uses it.\nThis might accelerate execution speed of the bot at runtime, but implicitly or even on\npurpose hinders static analysis of the binary code. Cross referencing of strings or helper\nfunctions is ineffective due to the duplications.\n\nOnly few anti-analysis measures can be found in the binary. One function exists, which\nresembles the sandbox check of its dropper with minor extensions. This sandbox detection\nconsists of three parts:\n\n  - The module path name should be more than 5 characters long and contain either\n'msapps\\' or 'Perf Manager\\', which is the case if the sample was legitimately\ndropped by its dropper.\n\n  - The module file name should not contain either of the following strings: 'klavme',\n'myapp', 'TESTAPP' or 'afyjevmv.exe'.\n\n**page | 7**\n\n\n-----\n\n- The function performs a hook detection on time retrieval APIs. These are\nNtQuerySystemTime, GetSystemTimeAsFileTime and GetTickCount. Every API is\ncalled twice to calculate a delta, while performing a sleep(1000) operation between\niteration one and iteration two. The final condition is, if any of the three deltas is\nbelow 998 milliseconds execution will abort. This can only be the case if any of the\nthree API's return values is modified by a system monitoring solution, like a\nsandbox.\n\n\n**Illustration 3: Hook detection on time retrieval functions**\n\n\nAnother evasion trick implemented by the malware is the partial obfuscation of API names.\nFor no obvious reason though, the obfuscation algorithm is only applied to a small subset\nof APIs used in the code. The algorithm uses the fixed value AB34CD77h and a\ncombination of XOR and ROL\ninstructions to calculate hashes\nfrom the export names of\nkernel32.dll, advapi32.dll and\npsapi.dll. It is important to note that\nthis obfuscation trick and the\naccording hash function remain\nconsistent through out all related\nsamples. **Illustration 4: The API name hashing function**\n\n**page | 8**\n\n\n-----\n\n**2.1.1 ENUMERATION OF FIREWALL AND ANTIVIRUS PRODUCTS**\n\nSimilar to its dropper, suspect #4 enumerates the system's installed AntiVirus product and\nchecks firewall settings. For AntiVirus detection it utilizes WMI and issues 'SELECT *\nFROM AntiVirusProduct'. Identification of installed products is achieved by comparing the\nhashed product name to a set of SHA-256 hashes; although, a different and much bigger\nset than used by its dropper. With the help of hash tables from perturb.org and\nmd5decoder.org it is possible to revert some of the hashes to their original text form:\n\na48be88bed64eff941be52590c07045b896bc3e87e7cf62985651bbc8484f945  MAfee\n1ba035db418ad6acc8e0c173a49d124f3fcc89d0637496954a70e28ec6983ad7\na7f9b61169b52926bb364e557a52c07b34c9fbdcd692f249cd27de5f4169e700\n2bc42b202817bdab7d49506d291e3d9624ae0069087a8949c8fcb583c73772b1  Norton\nf7d9ea7f3980635237d6ea58048057c33a218f2670e0ff45af5f4f670e9aa6f4  Panda\n522e5549af01c747329d923110c058b7bb7e112816de64bd7919d7b9194fba5b  Rising\n4db3801a45802041baa44334303e0498c2640cd5dfd6892545487bf7c8c9219f\nd4634c9d57c06983e1d2d6dc92e74e6103c132a97f8dc3e7158fa89420647ec3\n9e217716c4e03eee7a7e44590344d37252b0ae75966a7f8c34531cd7bed1aca7  Trend\ne1625a7f2f6947ea8e9328e66562a8b255bc4d5721d427f943002bb2b9fc5645\n588730213eb6ace35caadcb651217bfbde3f615d94a9cca41a31ee9fa09b186c\nab6ed3db3c243254294cfe431a8aeada28e5741dfa3b9c8aeb54291fddc4f8c3\nb3fe0e3a3e3befa152c4237b0f3a96ffaa44a2d7e1aa6d379d3a1ab4659e1676  AntiVir\n0d21bd52022ca7f7e97109d28d327da1e68cc0bedd9713b2dc2b49d3aa104392\nc0ffcaf63c2ca2974f44138b0956fed657073fde0adeb0b1c940b5c45e8a5cab  avast\n249a90b07ed10bd0cd2bcc9819827267428261fb08e181f43e90807c63c65e80  AVG\nb39be67ae54b99c5b05fa82a9313606c75bfc8b5c64f29c6037a32bf900926dd\n4b650e5c4785025dee7bd65e3c5c527356717d7a1c0bfef5b4ada8ca1e9cbe17  CA\nc8e8248940830e9f1dc600c189640e91c40f95caae4f3187fb04427980cdc479\n97010f4c9ec0c01b8048dbad5f0c382a9269e22080ccd6f3f1d07e4909fac1a5\naa0ad154f949a518cc2be8a588d5e3523488c20c23b8eb8fafb7d8c34fa87145\n333e0a1e27815d0ceee55c473fe3dc93d56c63e3bee2b3b4aee8eed6d70191a3  G\n977781971f7998ff4dbe47f3e1d679f1941b3237d0ba0fdca90178a15aec1f52  Jiangmin\nf1761a5e3856dceb3e14d4555af92d3d1ac47604841f69fc72328b53ab45ca56  Kaspersky\n\nThe malware retrieves the attributes 'productState', 'DisplayName' and on WindowsXP\nalso 'productUptoDate'. It is noteworthy though, that for netmgr.exe the existence of any of\nthe indicated AntiVirus products does not pose a reason to end execution. In fact, these\nhashes are the only measure for obfuscating strings in the binary.\n\nFirewall detection works equally via querying WMI through \"SELECT * FROM\nFirewallProduct\", while this time the malware searches for the attributes 'enabled',\n'VersionNumber' and 'DisplayName'.\n\nAntiVirus and firewall information is stored in objects in a linked list at runtime. It will later\neither be exfiltrated to a C&C server directly or dumped to a local file on disk. Either way,\nthe results of this check do not influence the flow of execution.\n\n**page | 9**\n\n\n-----\n\n#### 2.2 SYSTEM INFILTRATION\n\nAfter start-up the malware aims to inject itself to an svchost.exe process. For stealthiness\nthe malware can either inject itself as a remote thread to a running svchost.exe process or\nperform the same procedure on a newly created one.\n\nAs a singular means of persistence the malware relies on the auto-start registry key\ncreated by its dropper under [HKLM|HKCU]\\...\\CurrentVersion\\Run, which will start\nnetmgr.exe on every system boot.\n\nAlso, the payload retrieves the dropper's path from 'isakmpAutoNegociate' under [HKLM|\nHKCU]\\Software\\Microsoft\\IPSec, then deletes the binary and the 'isakmpAutoNegociate'\nregistry key.\n\n#### 2.3 CONFIGURATION AND COMMAND & CONTROL SETTINGS\n\nAt start-up netmgr.exe decrypts a configuration file stored in its resource section, revealing\nthree URLs, among timeout settings and encryption keys:\n\n  - http://le-progres.net/images/php/test.php?rec=11206-01\n\n  - http://ghatreh.com/skins/php/test.php?rec=11206-01\n\n  - http://www.usthb-dz.org/includes/php/test.php?rec=11206-01\n\nAll three of these URLs served as C&C contacts when the attack was still ongoing,\nsending commands or Lua scripts to the infected host. Interesting is that two of the\ndomains are actual fake domains resembling legitimate websites while one is a legitimate\ndomain nowadays. Le-progres.net could be easily confused with leprogres.fr, the official\nwebsite of the Lyon news paper Le Progres. Usthb-dz.org is remarkably similar to\nusthb.dz, the website of the University of Sciences and Technology Houari Boumediene in\nAlgiers, Algeria.\n\nThe third domain though, ghatreh.com, is the legitimate address of an Iranian news\nwebsite. According to domaintools.com, this domain has been created in November 2004\nwhile the last change happened in September 2012. Also, domaintools.com reveals 14\nunique IP addresses and 4 different registrars. It is assumed that the domain has been\ndropped by the attackers in 2012 and picked up by legitimate operators.\n\n**page | 10**\n\n\n-----\n\n**Illustration 5: The website of ghatreh.com today**\n\nThe IP addresses of the domains in 2011, at a time when dropper, payload and C&Cs\nwere still active, were 69.90.160.65, 70.38.107.13 and 70.38.12.10. All three IPs are\nlocated in Canada, two relate to Montréal, one to Oakville. The complete passive DNS\nhistory can be reviewed in appendix A.\n\nThe binary also contains the URL 'http://1.9.32.11/bunny/test.php?rec=nvista', but the\npurpose of it remains unclear. This IP address is never contacted by the malware.\n\nFind the entire decrypted configuration below:\n\n**<COMMAND_KEY>wqNbo8DSbWZiq1QZ4NnmTcibYRJIFxmlSBQh1zdF8IlDKin2zkNOVtKvlx92Q0QOQnA**\nNt1NCbDItwVQWY0HBQ2GKYPecpfuQ6JPZG0dQRarhCy7nTT3ukET9YzQEPN81</COMMAND_KEY>\n**<STORAGE_KEY>lbuLmdAouhUkSsMXckMUevjNf87S4ATWYwLYGLM44O1ortQEE2vr34QGzjPhrWeosFB**\nYQpT6dRwDuPPuP13zzqZhW3PeCQA7OUEghovMwEGYx1annboIwRxKbhUOIMsf</STORAGE_KEY>\n**<RESPONSE_KEY>8kMQOWondQc2ZgYgirg9NHg0QUiIIBdPe0YtIVfvxa9rvJ9wtFGx8ko4oFY34PrSkW**\n9cKzEFZYDnM54qeWcvSMIi9sBAkcD5ggFDmQOGdO42ef344I7s9wAKoAXKeq1s</RESPONSE_KEY>\n**<COMMAND_FILE_PATH_AND_PREFIX>%SELFDIR%\\net.cap</COMMAND_FILE_PATH_AND_PREFIX>**\n**<URL1>http://le-progres.net/images/php/test.php?rec=11206-01</URL1>**\n**<URL2>http://ghatreh.com/skins/php/test.php?rec=11206-01</URL2>**\n**<URL3>http://www.usthb-dz.org/includes/php/test.php?rec=11206-01</URL3>**\n**<INJECTED>0</INJECTED>**\n**<STARTDELAY>0</STARTDELAY>**\n**<DIEDELAY>120</DIEDELAY>**\n\nThe configuration provides three keys for encryption and decryption of data. The\n_command_key is used to decrypt commands received from the C&C server, the_\n_storage_key is used to encrypt and decrypt data being stored to files on disk and the_\n_response_key will encrypt callbacks to the C&C server. All data exchanged with any of the_\nC&C servers as well as data stored to a file on disk is encrypted with the according key.\n\n_Diedelay and startdelay are timeout settings, the exact use of the parameter injected is_\n\n**page | 11**\n\n\n-----\n\nunclear up to the time of writing. Command_file_path_and_prefix defines the name of the\nfile which will holds C&C commands and Lua scripts at runtime. The malware performs\nC&C command parsing and Lua script execution with dedicated threads, of which every\nthread creates its own net.cap file, extending the name by a fixed digit namely 0, 1, 3 or 4.\n\nAt runtime the malware adds additional configuration parameters, which are not assigned\nan obvious name like those retrieved from the resource section. The synonyms for all\nencrypted configuration values as they are stored in Windows registry are:\n\n– ipsecFilterData\n\n– ClassID\n\n– ipsecID\n\n– ipsecISAKMP\n\n– ipsecData\n\n– ipsecDSA\n\n– ipsecSA\n\n– ike\n\n– ikeID\n\n– isakmpID\n\n– isakmpKey\n\n– HMACSHA1\n\n– isakmpData\n\nAfter the configuration is retrieved from the resource section the malware will create a\nsubkey for every parameter under [HKLM|HKCU]\\Software\\Microsoft\\IPSec. This key has\ninitially been created by the dropper. The attributes are encrypted before being written to\nregistry, and will be decrypted on the fly every time the malware requests a specific\nparameter.\n\n#### 2.4 THE MULTI-THREADING MODEL\n\nSuspect #4 comes with a solid multi-threading model, which seeks to assure fail-safe and\nhigh-performance execution. The malware runs a main thread, which manages four worker\nthreads and performs C&C command parsing and Lua script execution. The worker\nthreads are dedicated to receive commands and scripts through different ways. Next to\nthat, the main thread also runs sub threads to maintain log files the malware creates at\nduring execution and to keep track of the overall system load the malware creates.\n\nThe threads are coordinated via named events, global flag variables, in some cases also\n\n**page | 12**\n\n\n-----\n\nmutexes or semaphores are used. The main action of the malware is carried out in the\nmain thread, which parses commands and executes Lua scripts, provided by the worker\nthreads via command files.\n\nThe threading model is summarized in the following graphic.\n\n**Illustration 6: Summary of the thread model**\n\n\n**2.4.1 PERFORMANCE MONITORING**\n\nA dedicated thread is present for monitoring the CPU load the malware itself generates.\nTherefor the thread enumerates all threads from the current process and calculates their\nexecution time.\n\nThe user- and kernel land execution time is measured for every thread using the kernel32!\nGetThreadTimes API; then aggregated, so the final value holds the overall CPU usage\ntime of the malware process. The thread keeps track of the time passing between\nexecutions. If the malware's active execution time in percentage of this delta exceeds a\nconfigured threshold, the malware will suspend all threads of its process for at least 5s.\nThe threshold is retrieved from configuration in Windows registry, and can be controlled by\nthe botmaster via the C&C command setcpulimit (see section 2.5).\n\nThis clearly is an attempt to keeping a low profile on the infected machine. By maintaining\nits own execution load the bot's compromised svchost.exe process will not catch attention\non the process list.\n\n**page | 13**\n\n\n-----\n\n**2.4.2 THE BACKFILE LAUNCHING THREAD**\n\nThe backfile launching thread got its name from the named event 'backfilelaunching' which\nis set to indicate that the dedicated thread has started. Also in a 1s-frequency the malware\nruns the backfile thread to push dump files to one of its remote servers.\n\nThe files are named Perflib_Perfdat_dmpbX.dat, where X is an index number starting with\n0. The data written to the file are status messages including a time stamp, which are\nreturned by command and Lua script execution. The data is encrypted using the\n_response_key from the configuration._\n\n**2.4.3 THE HEARER THREADS**\n\nThe term 'hearer' can be found plenty of times in the binary, it is assumed that it is\nequivalent to 'listener' of some sort. All together suspect #4 manages 4 hearer threads\nincluding one command file per thread. The command file is named net.capX, where X is\nthe index of the thread; 0, 1, 3 or 4.\n\nThe hearer thread's purpose is to receive instructions from the remote servers and provide\nthem to the main thread. Such instructions are commands and/or one or more Lua scripts.\nEach hearer has a dedicated method to receive instructions which is either separately via\nHTTP from the server, aggregated through a downloaded data file or as tasks to be\nconfigured as scheduled tasks. The hearer threads dump the received instructions to their\nnet.cap-files, from where the main thread's command parsing routine fetches and\nexecutes them. The data is encrypted with the storage_key before written to disk.\n\n**HEARER 0**\n\nGeneric hearer thread. Started, but not involved in command fetching and parsing.\n\n**HEARER 1**\n\nHearer 1 receives commands and Lua scripts directly via HTTP from one of the C&C\nservers. These are encrypted with the storage_key and stored to net.cap1 in the malware's\nworking directory. Interestingly, the malware handles successful downloads with the HTTP\nstatus code 418. This code is not part of the original HTTP standard, but was introduced in\nRFC2324, 1998's traditional IETF April Fool's joke. The textual representation of status\n418 is “I'm a teapot.”.\n\n**HEARER 2**\n\nHearer 2 is responsible for managing the scheduled tasks, titled 'crontasks' by the\nmalware. The tasks are stored in a file named perf.tmp, and when due for execution are\ncopied to the according net.cap-file, net.cap2 in this case. From there the main thread can\n\n**page | 14**\n\n\n-----\n\nfetch and execute them in its command parsing loop. Hearer 2 also creates a swap file\nnamed perf.tmp2, which helps in selectively editing the initial task file and in managing the\ntask list.\n\n**HEARER 3**\n\nHearer 3 searches for a file named netdump.db in its local working directory. If found, the\nthread will read its content in chunks representing different commands and paste these to\nnet.cap3. Again, the data is encrypted with the storage_key. No functionality could be\nfound in the malware code to write to netdump.db, which leaves the conclusion that this\nfile will be downloaded from a C&C server.\n\n#### 2.5 C&C COMMAND PARSING\n\nAfter initializing and starting all four hearer threads the main thread enters a command\nparsing loop. For every hearer the main thread\ninvokes the command and script execution function.\nTherefor data is read from the encrypted net.capXfile, where X indicates the index of the hearer; 0, 1,\n3 or 4. Once decrypted, this data is parsed to find\nvalid C&C commands and / or valid Lua scripts to\nexecute. More details on command and script\nexecution can be found in section 2.6.\n\nNotable is that the command parsing and execution\nhappens in a serial fashion, while Lua script\nexecution is handed over to dedicated threads. Also,\nno direct relation between C&C commands and Lua\nscript execution could be identified.\n\nThe most notable actions of the bot can be\nsummarized as follows:\n\n  - Downloads and executes Lua scripts to\ninstrument its own code\n\n  - Can install managed tasks (named 'crontask')\nfor its integrated engine\n\n\n\n- Can maintain FTP connections\n\n- Can send and receive files via HTTP\n\n- Writes runtime information to local files\n\n\n**Illustration 7: Linear command execution**\n\n\n**page | 15**\n\n\n-----\n\n  - Encryption for local data and network communication\n\nHowever, suspect #4 does accept a list of hard coded commands to be sent by the C&C\nserver. These mainly serve the purpose of controlling operation of the bot on the infected\nmachine, such as restarting threads or setting configuration parameters. The full list of\nC&C commands can be found below:\n\n**mainfrequency – Set a new timeout value for the command parsing loop.**\n\n**getconfig – Get configuration from registry and push it to C&C.**\n\n**ftpput – Push a file to an FTP server.**\n\n**ftpget – Download and store a file from an FTP server.**\n\n**sendfile – Send a local file to one of the C&Cs.**\n\n**getfile – Download and store a file from one of the C&Cs.**\n\n**uninstall – Set runtime flags to instruct main thread to terminate and delete related files.**\n\n**restarthearer – Restart one of the hearer threads, clean its runtime files.**\n\n**restart – Set runtime flag to instruct main thread to restart all threads.**\n\n**cleanhearer – Clear all files related to an indicated hearer thread.**\n\n**timeout – Configure a timeout value for HTTP connections.**\n\n**waitfor – Set a timeout value for hearer 1.**\n\n**updatedietime – Update the dietime value in registry.**\n\n**crontaska – Add new task to perf.tmp for hearer 2 to execute.**\n\n**crontaskr – Remove an entry in perf.tmp.**\n\n**crontaskl – List tasks from perf.tmp, write to perf.tmp2 and send to C&C.**\n\n**maxpostdata – Set a limit for data size to be sent to C&C via registry to limit data traffic.**\n\n**seturl – Add an additional C&C server URL to configuration in registry.**\n\n**stop – Set runtime flag to instruct main thread to shut down.**\n\n**setcpulimit – Configure a limit in percent for CPU usage, stored in registry.**\n\nEvery command execution function returns a status line, such as for example \"ftp\n\n**page | 16**\n\n\n-----\n\ncommand succeeded for: %s!\\n\". The initial command, the status line and a current time\nstamp are encrypted and sent back to the C&C server. Additionally, the same data is\nwritten to the Perflib_Perfdat_dmpbX.dat file which is regularly pushed to the C&C by the\nbackfile thread.\n\nFor hearer 1 and 3 the command parsing routine will additionally manage two continuous\nlog files which are named Perflib_Perfdata41X.dat and Perflib_Perfdata_42X.dat, where X\nis the respective hearer thread's index. More specifically, command parsing will increment\na global variable holding the total amount of executed commands and scripts. This 4-byte\nvalue is appended to Perflib_Perfdata41X.dat before and Perlfib_Perfdata42X.dat after\ncommand execution. These files survive restart or cleanup, so every time the malware\nboots it reads the current status from these logs and continues from the latest value. This\nmechanism helps the botmaster to keep track of the bots activity on an infected host and\ncould also be helpful in trouble shooting.\n\n#### 2.6 LUA ENGINE INTEGRATION\n\nSuspect #4 incorporates an interpreter for Lua 5.1, LuaSocket 2.0.2 and C/Invoke Lua\nbindings. Lua is a lightweight programming language designed as a scripting language\nwhich can be embedded into applications, providing a C API for doing so. C bindings are\nprovided through C/Invoke and enable Lua scripts to perform callbacks to C/C++ code.\nThis constellation can be found in many video game engines to provide polymorphic\nbehavior in games. Engine and game play features are injected through Lua scripts, which\ninstrument the game engine code.\n\nThe Lua interpreter is very small, compiled roughly 180kB, thus can easily be integrated in\nan application. The C/Invoke bindings enable Lua to be completely independent from the\nC/C++ application, so injected scripts can be pure Lua code.\n\n**page | 17**\n\n\n-----\n\n**Illustration 8: A small portion of Lua callback functions**\n\n\nA script, if delivered to one of the hearer threads, will be provided through the\ncorresponding net.cap-file of the hearer along with a C&C command. If a script is included\nin the data read from the net.cap-file, this is indicated by the start sentinel '<$'. Likewise,\nthe end of a script is indicated by '$>'.\n\n\n**Illustration 9: Command and script execution go hand in hand**\n\n\nCommand execution goes hand in hand with Lua script execution, thus is dependent of the\nfour hearer threads. The work flow for each hearer per execution loop in the main thread is\nas follows:\n\n  - Read and decrypt content from according net.cap-file\n\n  - See if an entry of the C&C command list can be found in the decrypted data\n\n**page | 18**\n\n\n-----\n\n- If so, execute the command\n\n- Hand the data over to the Lua\ninterpreter thread\n\n- See if a Lua script can be located,\nsearching for start and end\nsentinel\n\n- If so, start Lua thread and execute\nscript\n\n- If more than one script can be\nfound start more Lua threads\nrecursively\n\n\n**Illustration 10: Command and script execution in detail**\n\n\nAfter starting the Lua thread requests a value from Windows registry named 'EnableLua'\nunder SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System. This key name\nstands for enable limited user account. When set to zero this key effectively disables UAC\n(User Account Control). The malware only requests the key value but does not change it.\nThe value is later used by a callback function named 'popenWin' to decide on a way how a\nsub process should be started. Options are via WMIC using wmic.exe, Microsoft CScript\nengine using cscript.exe or directly via spawning a command line through cmd.exe.\n\nHowever, spawning sub processes is not the only feature which comes with Lua. The Lua\ninterpreter is a powerful code base which enables suspect #4 to change functionality on\nthe fly, as different scripts are downloaded and executed. The scripts define the\nfunctionality as they perform callbacks to the C/C++ code in the malware binary. The\npotential of the Lua interpreter can be investigated on the project homepage [4].\n\nLike command execution, Lua script execution also returns a status message which is\nextended by a time stamp and forwarded to one of the C&C servers, as well as written to\nthe backfile log in Perflib_Perfdat_dmpbX.dat. Likewise, the Lua threads log their activity\nto Perflib_Perfdata_41X.dat/42X.dat.\n\nDue to the absence of C&C servers which hold the Lua scripts for the bot's Lua interpreter\nthe true nature of this feature remains unclear.\n\n**page | 19**\n\n\n-----\n\n## 3. EVIL BUNNY IN THE SPOTLIGHT\n\n\nThroughout analysis and due to the help of Paul Rascagniéres a number of binaries which\nrelate to EvilBunny were identified [7]:\n\n2a64d331964dbdec8141f16585f392ba\n40E0F0681C79D70AC0329E68A94294CB\n8132ee00f64856cf10930fd72505cebe\ne8a333a726481a72b267ec6109939b0d\n3bbb59afdf9bda4ffdc644d9d51c53e7\nc40e3ee23cf95d992b7cd0b7c01b8599\n330dc1a7f3930a2234e505ba11da0eea\n83b7c532663f11bf994a1b518880557d\nb8ac16701c3c15b103e61b5a317692bc\nbbf4b1961ff0ce19db748616754da76e\n\nThe binaries share parts of source code, most notably is the identical API name\nobfuscation algorithm and respective key AB34CD77h.\n\nThe indicators of a relation among all samples or a subset of samples are the following:\n\n  - Same API name obfuscation algorithm and key\n\n  - Equal infection routines / source code\n\n  - Equal AntiVirus product enumeration technique\n\n  - Shared C&C domain names and equal C&C commands\n\n  - Equal proxy bypass technique / source code\n\nMentioned set of malware also shows parallels in coding style and structure. However, it\nhas to be pointed out that suspect #4 without doubt sticks out in terms of complexity and\nfunctionality. It is assumed that suspect #4 was created by the same authors, but this\ncannot be proved.\n\nFour of the set of identified samples are identical in functionality and capability. They\npossess respectable flooding capabilities and also provide remote access. However, they\ndo not support data stealing or any spying functionality [8]. Two more C&C domains were\nidentified for this group:\n\nhttp://callientefever.info/img/new/n.php\nhttp://fullapple.net/pictures/bkp/n.php\n\nRegarding the nature of the attack or the actor behind EvilBunny only vague conclusions\n\n**page | 20**\n\n\n-----\n\ncan be drawn. There has been public contemplation that the actor might be french and that\nthe malware might be related to samples analyzed by the Canadian CSEC [9]. However,\nthere hasn't been any hard evidence which links the attack to a group or a geographical\nlocation. Attribution is a tricky task and assumptions must not be drawn easily.\n\n**page | 21**\n\n\n-----\n\n## 4. ACKNOWLEDGEMENTS\n\n\nFor providing technical insights, support and if I remember right even water, coffee or\noccationally rum, I want to express my deepest gratitude to Morgan Marquis-Boire,\nSebastien Larinier, Paul Rascagniéres, Nicolas Brulez, Michael Shalyt and Inbar Raz.\n\nFurther I want to thank Fred Arbogast, Alexandre Dulaunoy, Raphael Vinot and the\nremaining organizing team of Hack.lu for their advice and effort, even in situations of\nwidespread insomnia.\n\nAll of you – such wow, very awesome; rock on!\n\n**page | 22**\n\n\n-----\n\n## 5. RESOURCES\n\n\n\n[1] An Analysis Of CVE-2011-4369\n[http://blog.9bplus.com/analyzing-cve-2011-4369-part-one/](http://blog.9bplus.com/analyzing-cve-2011-4369-part-one/)\n\n[2] ThreatExpert Report on c40e3ee23cf95d992b7cd0b7c01b8599\n[http://www.threatexpert.com/report.aspx?md5=c40e3ee23cf95d992b7cd0b7c01b8599](http://www.threatexpert.com/report.aspx?md5=c40e3ee23cf95d992b7cd0b7c01b8599)\n\n[3] How to disable UAC\n[https://social.technet.microsoft.com/Forums/windowsserver/en-US/0aeac9d8-3591-4294-](https://social.technet.microsoft.com/Forums/windowsserver/en-US/0aeac9d8-3591-4294-b13e-825705b27730/how-to-disable-uac)\n[b13e-825705b27730/how-to-disable-uac](https://social.technet.microsoft.com/Forums/windowsserver/en-US/0aeac9d8-3591-4294-b13e-825705b27730/how-to-disable-uac)\n\n[4] The Lua Project\n[http://www.lua.org/](http://www.lua.org/)\n\n[5] The C/Invoke Project\n[http://www.nongnu.org/cinvoke/](http://www.nongnu.org/cinvoke/)\n\n[6] Lua scriptable game engines (Wikipedia)\n[http://en.wikipedia.org/wiki/Category:Lua-scriptable_game_engines](http://en.wikipedia.org/wiki/Category:Lua-scriptable_game_engines)\n\n[7] All file hashes related to the EvilBunny malware\n[http://pastebin.com/7iedeFF5](http://pastebin.com/7iedeFF5)\n\n[8] Hack.lu 2014 Keynote on TS/NOFORN\n[http://www.slideshare.net/pinkflawd/tsnoforn](http://www.slideshare.net/pinkflawd/tsnoforn)\n\n[9] Quand les Canadiens partent en chasse de « Babar »\n[http://www.lemonde.fr/international/article/2014/03/21/quand-les-canadiens-partent-en-](http://www.lemonde.fr/international/article/2014/03/21/quand-les-canadiens-partent-en-chasse-de-babar_4387233_3210.html)\n[chasse-de-babar_4387233_3210.html](http://www.lemonde.fr/international/article/2014/03/21/quand-les-canadiens-partent-en-chasse-de-babar_4387233_3210.html)\n\n**page | 23**\n\n\n-----\n\n## 6. APPENDICES\n\n\n**APPENDIX A – PASSIVE DNS RECORDS**\n\nMarked in Grey is the data of sinkholes for the mentioned domains, currently operated by\nKaspersky.\n\n**Domain usthb-dz.org**\n\n**Resolve** **Location Network** **First** **Last**\n\n95.211.172.143 NL 95.211.0.0/16 14.12.2013 00:00 30.12.2013 00:00\n\n184.168.221.41 US 184.168.220.0/22 20.09.2012 00:00 14.12.2013 00:00\n\n8.5.1.34 US 8.5.1.0/24 10.04.2011 00:00 20.09.2012 00:00\n\n70.38.12.10 CA 70.38.0.0/17 10.03.2010 00:00 10.04.2011 00:00\n\n216.108.239.153 US 216.108.239.0/24 01.06.2009 00:00 10.03.2010 00:00\n\n213.186.33.19 FR 213.186.32.0/19 20.04.2009 00:00 01.06.2009 00:00\n\n91.121.142.185 FR 91.121.0.0/16 12.01.2009 00:00 20.04.2009 00:00\n\n91.121.137.201 FR 91.121.0.0/16 19.09.2007 00:00 12.01.2009 00:00\n\n64.15.136.137 CA 64.15.128.0/19 19.09.2007 00:00 19.09.2007 00:00\n\n**Domain le-progres.net**\n\n**Resolve** **Location Network** **First** **Last**\n\n95.211.172.143 NL 95.211.0.0/16 20.06.2014 00:00 09.11.2014 09:24\n\n208.73.210.155 US 208.73.208.0/21 10.04.2011 00:00 27.07.2014 00:21\n\n69.90.160.65 CA 69.90.160.0/22 02.11.2009 00:00 17.06.2014 07:16\n\n74.54.82.222 US 74.52.0.0/14 13.04.2009 00:00 02.11.2009 00:00\n\n74.54.82.228 US 74.52.0.0/14 16.03.2009 00:00 13.04.2009 00:00\n\n208.87.149.250 US 208.87.148.0/22 08.12.2008 00:00 16.03.2009 00:00\n\n216.36.248.134 US 216.36.192.0/18 02.11.2008 00:00 08.12.2008 00:00\n\n216.36.248.128 US 216.36.192.0/18 25.09.2008 00:00 02.11.2008 00:00\n\n216.36.248.134 US 216.36.192.0/18 06.12.2007 00:00 25.09.2008 00:00\n\n209.62.20.175 US 209.62.0.0/17 04.11.2007 00:00 06.12.2007 00:00\n\n69.46.226.168 N/A 69.46.224.0/20 01.11.2007 00:00 04.11.2007 00:00\n\n**page | 24**\n\n\n-----\n\n**Domain ghatreh.com**\n\n**Resolve** **Location Network** **First** **Last**\n\n184.107.60.97 CA 184.107.0.0/16 07.09.2012 00:00 09.11.2014 09:45\n\n70.38.107.13 CA 70.38.0.0/17 04.09.2012 00:00 01.04.2013 00:00\n\n204.93.167.100 US 204.93.167.0/24 07.04.2012 00:00 04.09.2012 00:00\n\n70.38.107.13 CA 70.38.0.0/17 14.03.2012 00:00 07.04.2012 00:00\n\n70.38.107.12 CA 70.38.0.0/17 10.04.2011 00:00 14.03.2012 00:00\n\n70.38.107.13 CA 70.38.0.0/17 23.03.2008 00:00 10.04.2011 00:00\n\n67.19.84.46 US 67.18.0.0/15 16.10.2006 00:00 23.03.2008 00:00\n\n67.18.209.222 US 67.18.0.0/15 07.10.2006 00:00 16.10.2006 00:00\n\n204.13.160.25 US 204.13.160.0/22 30.09.2006 00:00 07.10.2006 00:00\n\n64.20.43.107 US 64.20.32.0/19 23.09.2006 00:00 30.09.2006 00:00\n\n204.13.160.25 US 204.13.160.0/22 01.07.2006 00:00 23.09.2006 00:00\n\n69.25.212.153 US 69.25.208.0/20 29.04.2006 00:00 01.07.2006 00:00\n\n66.45.225.11 US 66.45.224.0/19 14.02.2005 00:00 29.04.2006 00:00\n\n67.19.22.234 US 67.18.0.0/15 12.02.2005 00:00 14.02.2005 00:00\n\n204.157.11.208 US 204.157.0.0/16 22.11.2004 00:00 12.02.2005 00:00\n\n**Domain callientefever.info**\n\n**Resolve** **Location Network** **First** **Last**\n\n95.211.172.143 NL 95.211.0.0/16 25.10.2010 00:00 07.10.2014 06:26\n\n68.178.232.99 US 68.178.232.0/22 24.10.2009 00:00 25.10.2010 00:00\n\n**Domain fullapple.net**\n\n**Resolve** **Location Network** **First** **Last**\n\n95.211.172.143 NL 95.211.0.0/16 09.12.2010 00:00 09.04.2014 10:48\n\n68.178.232.99 US 68.178.232.0/22 23.01.2010 00:00 09.12.2010 00:00\n\n209.51.136.27 US 209.51.128.0/19 13.12.2009 00:00 23.01.2010 00:00\n\n72.9.244.162 US 72.9.240.0/20 02.12.2009 00:00 13.12.2009 00:00\n\n**page | 25**\n\n\n-----\n\n**APPENDIX B – LIST OF RUNTIME FILES SUSPECT #4**\n\nnet.capX (where X is the index of the hearer thread; 0, 1, 3 or 4)\n\nperf.tmp\n\nperf.tmp2\n\nnetdump.db\n\nPerflib_Perfdat_dmpbX.dat (where X is an incremental index)\n\nPerfLib_Perfdata_41X.dat (where X is the index of the hearer; 1 or 3)\n\nPerfLib_Perfdata_42X.dat (where X is the index of the hearer; 1 or 3)\n\n\n**page | 26**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/xvilsesi5qd2gh6so2g3tnric51ndv57",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.11.20.EvilBunny/EvilBunny_Suspect4_v1.0.pdf"
    ],
    "report_names": [
        "EvilBunny_Suspect4_v1.0"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1416501708,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/814556f1a03e93364f4dc54555cb27549288e061.pdf",
        "text": "https://archive.orkl.eu/814556f1a03e93364f4dc54555cb27549288e061.txt",
        "img": "https://archive.orkl.eu/814556f1a03e93364f4dc54555cb27549288e061.jpg"
    }
}