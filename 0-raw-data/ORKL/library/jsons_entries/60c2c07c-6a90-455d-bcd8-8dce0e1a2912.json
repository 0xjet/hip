{
    "id": "60c2c07c-6a90-455d-bcd8-8dce0e1a2912",
    "created_at": "2023-01-12T15:04:25.472234Z",
    "updated_at": "2025-03-27T02:05:49.354882Z",
    "deleted_at": null,
    "sha1_hash": "7fe11ee7cc69b831b5e36105afbac0afa9c3f22f",
    "title": "2018-07-05 - A Look At Recent Tinba Banking Trojan Variant",
    "authors": "",
    "file_creation_date": "2022-05-27T23:19:11Z",
    "file_modification_date": "2022-05-27T23:19:11Z",
    "file_size": 960194,
    "plain_text": "# A Look At Recent Tinba Banking Trojan Variant\n\n**[zscaler.com/blogs/research/look-recent-tinba-banking-trojan-variant](https://www.zscaler.com/blogs/research/look-recent-tinba-banking-trojan-variant)**\n\n**Introduction**\n\nTinba is information stealing Trojan. The main purpose of the malware is to steal information\nthat could be browsing data, login credentials, or even banking information. This is achieved\nthrough code injection into system process (Winver.exe and Explorer.exe) and installing\nhooks into various browsers like IExplorer, Chrome, Firefox and Opera.\n\nTinba has been known to arrive via spammed e-mail attachments and drive-by downloads.\nRecently, Angler Exploit Kit instances were also found to be serving Tinba banking Trojan.\n\n**Detailed Analysis of Tinba**\n\nTinba is packed with a custom packer and uses well known anti-debugging technique using\nthe WinAPI function “IsDebuggerPresent” to hinder reverse engineering of the binary\nimage. The execution flow of the infection cycle for Tinba is shown below.\n\n\n-----\n\nExecution flow of Tinba\n\nThe image below shows the custom packer code being used by the Tinba sample we were\nlooking at.\n\nTinba unpacking Routine\n\nThe unpacked binary image is shown below which upon execution will perform code\ninjection into system processes like Winver.exe and Explorer.exe.\n\nUnpacked Binary\n\nIt generates Mutex name using root volume information of the victim’s machine as shown\nbelow.\n\n\n-----\n\nMutex name generation\n\n**Remote Thread in System Process**\n\nA remote thread is created inside Explorer process that is responsible for creating a copy of\nTinba Binary in %APPDATA% & auto start registry entry in Registry hive.\n\nExplorer remote thread\n\nThe Tinba binary is stored in a hidden folder which is created under %APPDATA%\ndirectory:\n\n_C:\\Documents and setting \\username \\Application Data\\mutexname\\bin.exe_\n\nIt also creates an auto-run registry entry to execute Tinba binary during every windows\nstart-up as shown below:\n\n\n-----\n\nAuto start registry entry\n\nAnother thread is also created in Explorer process which is responsible for generating DGA\n(Domain Generation Algorithm) domains and injecting code into browsers like IExplorer,\nChrome, Firefox and Opera.\n\nExplorer local thread\n\n**Domain Generation Algorithm**\n\nThe following is the Domain Generation Algorithm (DGA) used by Tinba variant where every\nsample uses a hardcoded domain and seed to generate the DGA domains.\n\nDGA routine\n\n\n-----\n\nHardcoded Domain and seed\n\nThese DGA domains are fast flux domains where single domain is frequently switched to\ndifferent IPs by registering it as part of the DNS A record list for a single domain.\n\n\n-----\n\n**_targetHost_** **_targetIP_**\n\neudvwwwrmyqi.in 89.111.166.60\n\neudvwwwrmyqi.in 95.163.121.94\n\njrhijuuwgopx.com 176.31.62.78\n\njrhijuuwgopx.com 176.31.62.77\n\nnorubjjpsvfg.ru 210.1.226.15\n\nnorubjjpsvfg.ru 104.223.122.20\n\nnorubjjpsvfg.ru 104.223.15.16\n\nscpxsbsjjqje.ru 5.178.64.90\n\nscpxsbsjjqje.ru 192.198.90.228\n\nscpxsbsjjqje.ru 5.178.64.90\n\nwgwnmffclqvu.ru 192.198.90.228\n\nwgwnmffclqvu.ru 192.3.95.140\n\n**Remote Thread in browsers The Explorer thread searches for browser process either by**\nchecking path of the browser executable or by loaded application specific DLL (e.g.\nNSS3.dll for firefox.exe). If the targeted browser process is found, then the secondary\nthread is created in the process.\n\n\n-----\n\nBrowser thread\n\nThis thread is responsible to get updated Bot configuration details like Target URL list and\nstrings (BOTUID ) from a remote C&C server. If there is no updated list of target URLs from\nC&C server, then it uses default targeted list of URLs which is stored in the injected code.\nThe list of default target URLs after decryption is shown below.\n\nDefault Targeted URL list\n\nThe collected information form webmail, social media and the banking sites are stored in\n\"log.dat\" file.\n\nLog file path\n\n**C&C communication & Cryptography:**\n\nThe POST request to C&C server contains encrypted system information like system\n\n\n-----\n\nvolume & version information. The cryptography routine is a simple byte XOR with an 8 bit\n'ROR' of the key after each write.\n\nSend Data Encryption\n\nA sample Tinba POST request to DGA domains with 157 bytes of encrypted data is shown\nbelow.\n\nC&C POST Request\n\nGeo distribution of C&C call back attempts that we blocked in past one month:\n\nGeo Location\n\nWe have seen following C&C server IP addresses: Conclusion:\n\n\n-----\n\nTinba also known as small banking Trojan continues to be prevalent in the wild. The arrival\nmethod varies from e-mail spam, drive-by downloads and most recently Exploit Kit infection\ncycle. Zscaler ThreatlabZ is actively monitoring this malware family and ensuring coverage\nfor our customers.\n\n## Stay up to date with the latest digital transformation tips and news.\n\n[By submitting the form, you are agreeing to our privacy policy.](https://www.zscaler.com/privacy-compliance/privacy-policy)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-07-05 - A Look At Recent Tinba Banking Trojan Variant.pdf"
    ],
    "report_names": [
        "2018-07-05 - A Look At Recent Tinba Banking Trojan Variant.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535865,
    "ts_updated_at": 1743041149,
    "ts_creation_date": 1653693551,
    "ts_modification_date": 1653693551,
    "files": {
        "pdf": "https://archive.orkl.eu/7fe11ee7cc69b831b5e36105afbac0afa9c3f22f.pdf",
        "text": "https://archive.orkl.eu/7fe11ee7cc69b831b5e36105afbac0afa9c3f22f.txt",
        "img": "https://archive.orkl.eu/7fe11ee7cc69b831b5e36105afbac0afa9c3f22f.jpg"
    }
}