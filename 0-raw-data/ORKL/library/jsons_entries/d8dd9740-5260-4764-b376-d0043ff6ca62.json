{
    "id": "d8dd9740-5260-4764-b376-d0043ff6ca62",
    "created_at": "2023-01-12T15:10:28.898756Z",
    "updated_at": "2025-03-27T02:16:25.492742Z",
    "deleted_at": null,
    "sha1_hash": "315fccc1755579c079273c6d58701783f31f492a",
    "title": "2017-10-31 - ONI Ransomware Used in Month-Long Attacks Against Japanese Companies",
    "authors": "",
    "file_creation_date": "2022-05-26T01:17:51Z",
    "file_modification_date": "2022-05-26T01:17:51Z",
    "file_size": 396062,
    "plain_text": "# ONI Ransomware Used in Month-Long Attacks Against Japanese Companies\n\n**[bleepingcomputer.com/news/security/oni-ransomware-used-in-month-long-attacks-against-japanese-companies](https://www.bleepingcomputer.com/news/security/oni-ransomware-used-in-month-long-attacks-against-japanese-companies/)**\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nOctober 31, 2017\n09:26 AM\n2\n\nAs more and more ransomware outbreaks are discovered, the line has become blurred in\nwhether they are being utilized as a wiper or an actual ransomware. Such is the case with a\nnew ransomware attack called ONI that has been used in targeted month long attacks against\nJapanese companies.\n\n### ONI goes phishing\n\nIt all started when security firm Cybereason analyzed some computers that were infected\n[with a ransomware called ONI. This ransomware has been analyzed before, but it was not](https://www.cylance.com/ja_jp/blog/jp-oni-ransomware-globeimposter.html)\nunderstood how the ONI victims were being infected. After analysis by Cybereason\nresearchers, it was discovered that the infected computers had also been previously targeted\nby a spear phishing campaign that installs a RAT, or Remote Access Trojan, on the victim's\ncomputer.\n\nThese phishing emails pretend to be receipts that contain a zip attachment with a malicious\nWord document inside it. When a user opens the document and enables macros, a VBScript\nscript will be launched that downloads and install a copy of the Ammyy Admin RAT onto the\ninfected computer.\n\n\n-----\n\n**Spear Phishing Email**\n\n**Source: Cybereason**\n\nWhile Ammyy Admin is a legitimate remote administration tool, in this case it is being used\n[by the attackers to gain full access to the system. According to Cybereason, they have found](https://www.cybereason.com/blog/night-of-the-devil-ransomware-or-wiper-a-look-into-targeted-attacks-in-japan)\ninstances of this RAT being installed as far back as December 2016 and as recently as\nSeptember 2017.\n\nCybereason has told BleepingComputer that all of the targets were medium-large companies\nand there have not been any reports of government related incidents.\n\n### Covering their tracks\n\nOnce the attackers were able to gain access to a network, they further worked on gaining\naccess to the domain administrator account and servers. Unfortunately, at this point it\nbecomes a bit fuzzy as to what the attackers were doing during their three to nine month\naccess to the hacked network.\n\nCybereason has told BleepingComputer that \"it's safe to assume that sensitive data was\nexfiltrated during those months of active hacking operation\".\n\nWhen the attackers were finished with their hacking operation, ONI Ransomware would\ncome into play. As the attackers had access to the domain servers, they would utilize Group\nPolicy Scripts to execute a batch file that cleaned up over 460 different event logs in order to\ncover their activities.\n\n\n-----\n\n**Clearing Event Logs**\n**Source: Cybereason**\n\nThis same script would also deploy the ONI ransomware on computers in order to encrypt\nfiles and to possibly further obfuscate the activities of the attackers.\n\n### ONI Ransomware: A Ransomware or a Wiper?\n\nAn interesting aspect of this attack was that the attackers used two different versions of the\nONI Ransomware. One version, which was used to mostly target non-critical computers, is a\nGlobeImposter variant that acts as a user mode encryptor.\n\nWhen installed, ONI Ransomware would encrypt the computer's files and append the .oni\nextension to encrypted files as shown below.\n\n\n-----\n\n**Encrypted Folder**\n\nWhen done, victims would then find a ransom note named !!!README!!!!.html located in\nfolders where files were encrypted. These ransom notes contain basic information on what\nhappened to the victim's files and an email that can be used to contact the attackers for\npayment instructions.\n\n\n-----\n\n**ONI Ransom Note**\n\nThis is all standard procedure for GlobeImposter ransomware variants.\n\nIt gets more interesting, though, when Cybereason discovered that the attackers were also\nusing another ransomware on certain computers. This ransomware is being called MBR-ONI\nbecause it encrypts the actual as it encrypts the actual file system and then replaces the MBR,\nor Master Boot Record, with a password protected lock screen that is displayed before\nWindows boots.\n\n[It does this by utilizing the legitimate DiskCryptor program, which was recently used by the](https://diskcryptor.net/wiki/Main_Page)\n[Bad Rabbit Ransomware attack, to encrypt the file system and requires a password to make it](https://www.bleepingcomputer.com/news/security/bad-rabbit-ransomware-outbreak-also-used-nsa-exploit/)\naccessible again.\n\n**MBR-ONI Lock Screen**\n\n**Source: Cybereason**\n\n\n-----\n\nAccording to Cybereason, MBR-ONI was only deployed on active directory servers or critical\nassets\".\n\n[Unlike the NotPetya attack which would not allow decryption of the file system, ONI and](https://www.bleepingcomputer.com/news/security/wannacry-d-j-vu-petya-ransomware-outbreak-wreaking-havoc-across-the-globe/)\nMBR-ONI are legitimate ransomware infections that can be decrypted if the victim acquires\nthe decryption key. While Cybereason has told BleepingComputer that there have been no\nreports of victim's paying the ransom or even contacting the attackers, the way these\nransomware were used is not commonly done.\n\nThe question remains as to whether the attackers were using ONI to earn some extra money\nafter they finished their attack, to make computers and files inaccessible to cover their traces,\nor maybe even both. Only time will tell.\n\n### Related Articles:\n\n[New ‘Cheers’ Linux ransomware targets VMware ESXi servers](https://www.bleepingcomputer.com/news/security/new-cheers-linux-ransomware-targets-vmware-esxi-servers/)\n\n[SpiceJet airline passengers stranded after ransomware attack](https://www.bleepingcomputer.com/news/security/spicejet-airline-passengers-stranded-after-ransomware-attack/)\n\n[US Senate: Govt’s ransomware fight hindered by limited reporting](https://www.bleepingcomputer.com/news/security/us-senate-govt-s-ransomware-fight-hindered-by-limited-reporting/)\n\n[New RansomHouse group sets up extortion market, adds first victims](https://www.bleepingcomputer.com/news/security/new-ransomhouse-group-sets-up-extortion-market-adds-first-victims/)\n\n[Ransomware attack exposes data of 500,000 Chicago students](https://www.bleepingcomputer.com/news/security/ransomware-attack-exposes-data-of-500-000-chicago-students/)\n\n## IOCs\n\n### Hashes:\n```\nSHA256: 9bba34947b9b2f9d52aeb45b342637ce93d6683bbf8e352da53dae053da37ae6\n(GlobeImposter Variant)\n\n Files associated with ONI:\n!!!README!!!.html\n\n ONI Ransom Note (Japanese):\n\n```\n\n-----\n\n重要な情報!\n\nすべてのファイルは、RSA-2048およびAES-256暗号で暗号化されています。\n心配しないで、すべてのファイルを元に戻すことができます。\nすべてのファイルを素早く安全に復元できることを保証します。\nファイルを回復する手順については、お問い合わせ。\n信頼性を証明するために、2ファイルを無料で解読できます。ファイルと個人IDを私たちにお送りください。\n```\n(ファイルサイズ10MB未満、機密情報なし)\n\n```\n連絡先\n```\nhyakunoonigayoru@yahoo.co.jp\n\n### ONI Ransom Note (English Translation):\nImportant information!\nAll files are encrypted with RSA - 2048 and AES - 256 ciphers.\nDo not worry, you can restore all the files.\nWe guarantee that all files can be safely restored quickly and safely.\nFor instructions on recovering files, contact us.\nTo prove reliability, you can decipher two files for free. Please send us the file\nand personal ID.\n(File size less than 10 MB, no confidential information)\ncontact information\nhyakunoonigayoru@yahoo.co.jp\n\n```\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/news/security/facebook-phishing-campaign-targets-android-and-ios-users/)\n[Next Article](https://www.bleepingcomputer.com/news/technology/new-vibwrite-system-uses-finger-vibrations-to-authenticate-users/)\n\n### Comments\n\n\n-----\n\n[Amigo-A - 4 years ago](https://www.bleepingcomputer.com/forums/u/998576/amigo-a/)\n\n'''''Ammyy Admin is a legitimate remote administration tool'''''\nIt should be noted that the utility Ammyy Admin and sites of the company \"Ammyy\"\nLtd. were many, many times compromised, hacked, infected.\n\nhttps://www.esetnod32.ru/company/press/center/eset-avtory-buhtrap-osvoili-aptataki/\nhttps://securelist.ru/blog/issledovaniya/28900/lurk-a-danger-where-you-leastexpect-it/\nhttp://news.softpedia.com/news/ammyy-admin-website-compromised-to-spreadcerber-3-ransomware-508330.shtml\n\n[Amigo-A - 4 years ago](https://www.bleepingcomputer.com/forums/u/998576/amigo-a/)\n\nCylance assert that file %Temp%\\qfjgmfgmkj.tmp - special file that prohibits the reinstallation of this encryptor. So it can be used for protection.\n\n[Post a Comment Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-10-31 - ONI Ransomware Used in Month-Long Attacks Against Japanese Companies.pdf"
    ],
    "report_names": [
        "2017-10-31 - ONI Ransomware Used in Month-Long Attacks Against Japanese Companies.pdf"
    ],
    "threat_actors": [
        {
            "id": "3b046db2-f60e-49ae-8e16-0cf82a4be6fb",
            "created_at": "2022-10-25T16:07:23.427162Z",
            "updated_at": "2025-03-27T02:02:09.79482Z",
            "deleted_at": null,
            "main_name": "Buhtrap",
            "aliases": [
                "Buhtrap",
                "Operation TwoBee",
                "Ratopak Spider",
                "UAC-0008"
            ],
            "source_name": "ETDA:Buhtrap",
            "tools": [
                "AmmyyRAT",
                "Buhtrap",
                "CottonCastle",
                "FlawedAmmyy",
                "NSIS",
                "Niteris EK",
                "Nullsoft Scriptable Install System",
                "Ratopak"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dcba8e2b-93e0-4d6e-a15f-5c44faebc3b1",
            "created_at": "2022-10-25T16:07:23.816991Z",
            "updated_at": "2025-03-27T02:02:09.991944Z",
            "deleted_at": null,
            "main_name": "Lurk",
            "aliases": [],
            "source_name": "ETDA:Lurk",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "01d569b1-f089-4a8f-8396-85078b93da26",
            "created_at": "2023-01-06T13:46:38.411615Z",
            "updated_at": "2025-03-27T02:00:02.826863Z",
            "deleted_at": null,
            "main_name": "BuhTrap",
            "aliases": [],
            "source_name": "MISPGALAXY:BuhTrap",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "921cea27-4410-42e4-8c11-7d40ba313225",
            "created_at": "2023-01-06T13:46:39.375789Z",
            "updated_at": "2025-03-27T02:00:03.067286Z",
            "deleted_at": null,
            "main_name": "RansomHouse",
            "aliases": [],
            "source_name": "MISPGALAXY:RansomHouse",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536228,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653527871,
    "ts_modification_date": 1653527871,
    "files": {
        "pdf": "https://archive.orkl.eu/315fccc1755579c079273c6d58701783f31f492a.pdf",
        "text": "https://archive.orkl.eu/315fccc1755579c079273c6d58701783f31f492a.txt",
        "img": "https://archive.orkl.eu/315fccc1755579c079273c6d58701783f31f492a.jpg"
    }
}