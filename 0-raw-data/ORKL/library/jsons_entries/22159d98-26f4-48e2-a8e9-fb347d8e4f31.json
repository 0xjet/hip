{
    "id": "22159d98-26f4-48e2-a8e9-fb347d8e4f31",
    "created_at": "2022-10-25T16:48:23.991033Z",
    "updated_at": "2025-03-27T02:16:08.470807Z",
    "deleted_at": null,
    "sha1_hash": "b2431a336059c7dca596d6f2195b08f084129dc6",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-07-10T03:25:55Z",
    "file_modification_date": "2020-07-10T03:25:55Z",
    "file_size": 752367,
    "plain_text": "# More evil: A deep look at Evilnum and its toolset\n\n**[welivesecurity.com/2020/07/09/more-evil-deep-look-evilnum-toolset](https://www.welivesecurity.com/2020/07/09/more-evil-deep-look-evilnum-toolset/)**\n\nMatías Porolli July 9, 2020\n\nESET has analyzed the operations of Evilnum, the APT group behind the Evilnum\nmalware previously seen in attacks against financial technology companies. While said\nmalware has been seen in the wild since at least 2018 and documented previously, little\nhas been published about the group behind it and how it operates.\n\nIn this article we connect the dots and disclose a detailed picture of Evilnum’s activities.\nThe group’s targets remain fintech companies, but its toolset and infrastructure have\nevolved and now consist of a mix of custom, homemade malware combined with tools\npurchased from Golden Chickens, a Malware-as-a-Service (MaaS) provider whose\ninfamous customers include FIN6 and Cobalt Group.\n\n## Targets\n\nAccording to ESET’s telemetry, the targets are financial technology companies – for\nexample, companies that offer platforms and tools for online trading. Although most of\nthe targets are located in EU countries and the UK, we have also seen attacks in countries\nsuch as Australia and Canada. Typically, the targeted companies have offices in several\nlocations, which probably explains the geographical diversity of the attacks.\n\nThe main goal of the Evilnum group is to spy on its targets and obtain financial\ninformation from both the targeted companies and their customers. Some examples of\nthe information this group steals include:\n\nSpreadsheets and documents with customer lists, investments and trading\noperations\nInternal presentations\nSoftware licenses and credentials for trading software/platforms\nCookies and session information from browsers\nEmail credentials\nCustomer credit card information and proof of address/identity documents\n\nAccording to what we have seen during our investigation, the group has also gained\naccess to IT-related information such as VPN configurations.\n\n## Overview of the attack\n\nTargets are approached with spearphishing emails that contain a link to a ZIP file hosted\non Google Drive. That archive contains several LNK (aka shortcut) files that extract and\nexecute a malicious JavaScript component, while displaying a decoy document. These\n\n\n-----\n\nshortcut files have “double extensions” to try to trick the user into opening them, thinking\nthey are benign documents or pictures (in Windows, file extensions for known file types\nare hidden by default). The contents of one of the ZIP files are shown in Figure 1.\n\n_Figure 1. Malicious LNK files_\n\nOnce a shortcut file is opened (it doesn’t matter which one, as they all do the same thing),\nit looks in the contents of its own file for lines with a specific marker and writes them to a\n.js file. Then this malicious JavaScript file is executed and it writes and opens a decoy file\nwith the same name as the shortcut, but with the correct extension. It also deletes the\nshortcut file. The documents used as decoys are mostly photos of credit cards, identity\ndocuments, or bills with proof of address, as many financial institutions require these\ndocuments from their customers when they join, according to regulations (this is known\nas “Know Your Customer”). One such decoy is shown in Figure 2 (blurred for privacy).\n\n\n-----\n\n_Figure 2. Photo of the back of an ID card, used as a decoy_\n\nThese decoy documents seem genuine, and we assume that they have been collected by\nthis group during years of operation. Documents are collected actively in the group’s\ncurrent operations, as it targets technical support representatives and account managers,\nwho regularly receive these kinds of documents from their customers. The group reuses\nthe documents on different targets, unless the targets are from different regions.\n\nThe JavaScript component is the first stage of the attack and can deploy other malware\n[such as a C# spy component, Golden Chickens components or several Python-based tools.](https://quointelligence.eu/2020/01/the-chicken-keeps-laying-new-eggs-uncovering-new-gc-maas-tools-used-by-top-tier-threat-actors/)\nThe name Evilnum was given to the C# component by other researchers in the past, but\nthe JS component also has been referred to as Evilnum. We have named the group\nEvilnum as that is the name of their flagship malware, and we’ll refer to the various\nmalware pieces as components. An overview of these is shown in Figure 3.\n\n\n-----\n\n_Figure 3. Evilnum components_\n\nEach of the various components has its own C&C server, and each component operates\nindependently. The operators of the malware manually send commands to install\nadditional components and use post-compromise scripts and tools if they consider them\nnecessary.\n\nMost servers used by the malware are referenced by IP addresses; domain names have\nnot been used. The only exceptions are the C&C servers used by the Golden Chickens\ncomponents; malware purchased from a MaaS provider, as we describe later.\n\nThose referenced by an IP address can be split into two groups, based on the hosting\nprovider. The majority of them are hosted with FreeHost, a Ukrainian provider. The rest\nare hosted in the Netherlands, with Dotsi.\n\n## JS Component: First compromise\n\nThis component communicates with a C&C server and acts as a backdoor without the\nneed for any additional program. However, in most attacks that we have seen, the\nattackers deployed additional components as they saw fit and used the JS malware only\nas a first stage.\n\n\n-----\n\nThe first known mention of this JavaScript malware was in May 2018 in this pwncode\narticle. The malware has changed since then and we illustrate these changes in Figure 4.\n\n_Figure 4. Timeline of changes in JS component_\n\nDifferences between version 1.3 and the others are noteworthy, as the server-side code for\nthe C&C was changed and commands are different. In that early version it was not\npossible to upload files to the C&C, only to download files to the victim’s computer. Also,\nas new versions appeared, the malware was extended with some Python scripts (see the\n_[Post-compromise toolset section) and external tools such as ChromeCookiesView.](https://www.nirsoft.net/utils/chrome_cookies_view.html)_\n\nDespite the differences, the core functionalities remain the same in all versions, including\nthe retrieval of the C&C server’s address from GitHub, GitLab or Reddit pages created\nspecifically for that purpose. Figure 5 shows an example of a Reddit page that is parsed by\nthe malware to retrieve a C&C address.\n\n\n-----\n\n_Figure 5. Reddit page with the C&C server for the JS component_\n\nThis component achieves persistence through the Run registry key and has full backdoor\ncapabilities: it can download and execute binaries, run arbitrary commands or upload\nfiles from the victim computer to the C&C server. We will not go into details about the\ntechnical aspects of this component, as a good analysis of the latest version was published\nrecently by Prevailion.\n\n## C# Component: Evil, not so evil\n\n[In March 2019, Palo Alto Networks described malware with very similar functionality to](https://unit42.paloaltonetworks.com/cardinal-rat-sins-again-targets-israeli-fin-tech-firms/)\nthe JS component, but coded in C#. That version (2.5) obtained the address of its C&C by\ndividing a number by 666, and was therefore named Evilnum by Palo Alto Networks\nresearchers. Since then there have been new versions of the C# malware, the latest of\nthem being version 4.0, which we first saw in April 2020. The number 666 is not used\nanymore and the PDB paths of the executables show that the developers call their\nmalware “Marvel”. However, we will continue to name the malware Evilnum to avoid\ncreating confusion.\n\nThe latest version comes bundled in an MSI file (Windows Installer) and runs\nindependent of the JS component. Furthermore, it has different C&Cs than the JS\ncomponent. However, in all cases that we have seen, the C# component was downloaded\nand executed after the JavaScript malware gained initial access. The structure of this\ncomponent is shown in Figure 6.\n\n\n-----\n\n_Figure 6. Parts of the C# component_\n\nWhen the MSI file is executed, three malicious components, along with some .NET\nFramework library files, are written to disk in %LOCALAPPDATA%\\Microsoft\\Mediia.\nThe file copier is the first to be executed and its only purpose is to move the files to\nanother location in %LOCALAPPDATA% (see the Indicators of Compromise section for\nthe folder names). The loader is then executed and it loads and decrypts the contents of\nthe file System.Memmory.dll, which is the actual malicious payload (DLL Agent) for the\nC# component. AES encryption is used for the DLL and for obfuscation of the strings in\nthe payload. The same key and initialization vector are used to encrypt the strings in all of\nthe different versions.\n\nThe IP address of the C&C server is hardcoded and in plain text. A GET request is sent for\n/Validate/valsrv and if the response body contains the text youwillnotfindthisanywhare,\nthen the server is accepted. Otherwise, a GitLab page is parsed to get the IP address of a\nsecond server.\n\nThe following capabilities are present in version 4.0:\n\nTake screenshots if the mouse has been moved in a period of time, and send them to\nthe C&C, base64 encoded. The image is stored in a file called SC4.P7D\nRun commands\nRun other binaries via cmd.exe\nSend information such as computer name, username and antivirus installed\nPersist in a compromised system by creating registry keys\n\n### Commands\n\n\n-----\n\nThe commands that can be sent to the malware are:\n\nkillme: stops the malware and removes persistence\nmouse: moves the mouse. With this action a screenshot will be taken\ncookies: sends Chrome cookies to the C&C\npasswords: sends Chrome saved passwords. We believe they focus on Chrome not\nbased on market share (after all, these are targeted attacks), but because of the ease\nof processing cookies and retrieving stored passwords\nOther commands to be run directly with cmd.exe\n\nVersion 2.5 was the first documented version of the C# component (first seen by ESET in\nDecember 2018). Then we saw v2.7.1 (November 2019), v3 (December 2019) and v4.0\n(April 2020). The most important differences between the latest version of the malware\nand previous ones are:\n\nThe main payload is a 32-bit DLL. Previously, it was a 64-bit EXE file.\nHTTPS communication in the latest version\nThere is no “reverse” command anymore. It was used in previous versions to open a\nreverse shell. This is now done with other scripts\n\nThe JS and C# components are connected to each other: the latter takes screenshots\nwhereas the former doesn’t, but it has code that looks for screenshot files and sends them\nto its C&C server. The C# component also deletes all files with the .lnk extension in the\n%LOCALAPPDATA%\\Temp folder, cleaning leftovers from the initial compromise by the\nJS component. So even if the C# component has limited functionalities (it can’t download\nor upload files), it provides redundancy with a different C&C server and extra persistence\nin case the JS component is detected or removed from the victim’s computer.\n\n## Golden Chickens components: TerraLoader family\n\nIn a small number of cases, the Evilnum group has also deployed some tools purchased\nfrom a Malware-as-a-Service provider. This term is used to describe malware authors\nwho offer not only their malicious binaries, but also any necessary infrastructure (such as\nthe C&C servers) and even technical support to their criminal customers.\n\nIn this case the MaaS provider is known as Golden Chickens and has other customers\n[(apart from this group), such as FIN6 and Cobalt Group. Older versions of all the](https://attack.mitre.org/groups/G0037/)\ncomponents that we describe in the following sections were seen previously, in an attack\nagainst eCommerce merchants that Visa attributed to FIN6 in February 2019. We believe\nthat FIN6, Cobalt Group and Evilnum group are not the same, despite the overlaps in\ntheir toolsets. They just happen to share the same MaaS provider.\n\nThe Golden Chickens tools come as ActiveX components (OCX files) and all of them\ncontain TerraLoader code, which serves as a common loader for the various payloads\navailable to Golden Chickens’ customers. These tools are used by Evilnum as follows:\n\n\n-----\n\nThe attackers manually send a command to the JS or C# component to drop and\nexecute a batch file from one of their servers.\nThat batch file writes a malicious INF file and supplies it as a parameter to the\nMicrosoft utility cmstp.exe, which executes a remote scriptlet specified in the INF\nfile. This technique has been documented in the MITRE ATT&CK knowledge base\n[as CMSTP; an example of how this technique is used may be found here. This](https://attack.mitre.org/techniques/T1191/)\n[technique has been used in the past by Cobalt, another financially motivated group.](https://attack.mitre.org/groups/G0080/)\nThe remote scriptlet contains obfuscated JS code that drops an OCX file and\nexecutes it via regsvr32.exe.\n\nThe TerraLoader code performs several integrity checks before dropping the payload.\nThese checks implement anti-debugging techniques and try to identify anomalies to\nprevent execution in sandboxed environments. Some of these techniques range from\ndetecting incorrect parameters, filenames and extensions, to detecting hardware\nbreakpoints or identifying specific modules loaded into the subject process. Should these\nchecks all pass, the actual payload is decrypted and executed.\n\nWe have seen Evilnum deploy the following Golden Chickens payloads in their attacks:\n\nMore_eggs\nA Meterpreter payload that we will call TerraPreter\nTerraStealer\nTerraTV\n\nResearchers from Positive Technologies recently analyzed some tools used by the Cobalt\ngroup, including More_eggs version 6.6, which is one of the versions used by Evilnum\n[group. They have a very good analysis of TerraLoader, so we suggest checking their report](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/cobalt_upd_ttps/)\n(section 4).\n\n### More_eggs\n\n[More_eggs is a JavaScript backdoor that communicates with a C&C server and accepts](https://attack.mitre.org/software/S0284/)\ncommands. It has been used in the past by other groups targeting financial companies.\nEvilnum uses it in conjunction with its homemade backdoors in order to provide\nredundancy and additional persistence on victim networks.\n\nWe have seen Evilnum use 32-bit ActiveX components with TerraLoader code that runs\nMore_eggs versions 6.5, 6.6 and 6.6b – the latest available versions. They do so by\ndropping msxsl.exe (a command line transformation utility that is a legitimate Microsoft\nexecutable) and having it execute the JavaScript code, very similar to what was described\n[in this article by IRIS.](https://securityintelligence.com/posts/more_eggs-anyone-threat-actor-itg08-strikes-again/)\n\nThe dropped JavaScript code is generated on the fly by the ActiveX component, and there\nare some considerations during analysis:\n\nThe initial JS code that executes exe has a hardcoded absolute path, so executing it\nfrom another location or with another user will fail\n\n\n-----\n\nThe final More_eggs payload is encrypted with a key that has the hostname and\nprocessor family information appended at the end. An example key is:\n\ncvyLMmtGSKmPMfzJjGyg552DESKTOP-FQAT01XIntel64 Family 6 Model 94 Stepping\n3, GenuineIntel\n\nThe core functionalities are the same as described in the article linked above, although\nthere is a new command, more_time, not mentioned there. This command is similar to\nthe documented command via_c, which executes its parameter with cmd.exe /v /c\n<parameter>. The difference is that it additionally sends the output back to the C&C\n(via_c only sends whether or not the command succeeded).\n\n### TerraPreter\n\nEvilnum group also uses 64-bit executables that decrypt and run a Meterpreter instance\nin memory. The use of Meterpreter gives them flexibility and the ability to run various\npayloads in a stealthy and extensible way.\n\nThe structure of these components and the integrity checks implemented were identified\nas TerraLoader code. That’s why we refer to these components as TerraPreter.\nDecompiled code of the main malicious routine is shown in Figure 7.\n\n\n-----\n\n_Figure 7. Decompiled code for Meterpreter Loader components_\n\nThe routine labeled Dummy calls a series of APIs that don’t do anything. The RC4\nfunction initialization brute-forces the key to use by taking a base string and appending a\nnumber to it that is incremented in each iteration. It then decrypts a 16-byte buffer with\nthe candidate key using RC4. If the decrypted buffer matches a hardcoded string, then\nthat candidate key will be the chosen RC4 key for later use. We believe this may be a timewasting countermeasure against emulators.\n\nAfter the embedded buffer with the payload is decrypted, the malware will finally set a\ncallback to the GrayStringW API function, pointing to the decrypted buffer. After going\nthrough many layers of decoding, Meterpreter’s metsrv.dll is loaded in memory. From\n\n\n-----\n\nthis point on, what we see is regular Meterpreter behavior that has not been modified.\nHowever, we will continue to describe how communications are performed.\n\nTerraPreter communicates with a C&C server using HTTPS and retrieves a series of\ncommands. C&Cs we have seen contacted are cdn.lvsys[.]com and faxing-mon[.]best. The\nfirst one was redirected to d2nz6secq3489l.cloudfront[.]net. Every time a C&C receives a\nrequest, it sends different binary data XORed with a random 4-byte key. The malware\nreads the key to be used for decryption from the first 4 bytes of a 32-byte header that\nprefixes the encrypted data. Figure 8 shows an example.\n\n_Figure 8. Data sent by the C&C_\n\nThe first command sent by the C&C is core_patch_url, which changes the last part of the\nURL for subsequent requests. Then core_negotiate_tlv_encryption is sent by the C&C,\nalong with its public key. From this point on, messages will be encrypted before they are\nXORed.\n\n### TerraStealer and TerraTV\n\nTerraStealer is also known as SONE or Stealer One. It scans for many browsers, email,\nFTP and file transfer applications, to steal cookies and credentials. One of the binaries we\nanalyzed had logging activated. Part of one such log is shown in Figure 9.\n\n\n-----\n\n_Figure 9. TerraStealer log_\n\nAnother component used by this group is a variant of TerraTV. It runs a legitimate\nTeamViewer application but hides its user interface elements, so that the operators of the\nmalware can connect to the compromised computer undetected.\n\nWhen executed, TerraTV drops several signed TeamViewer components into\nC:\\Users\\Public\\Public Documents\\57494E2D3850535046373333503532\\. The\ndropped files are shown in Figure 10.\n\nACTIVEDS.dll is not signed and it is where the malicious code resides. There is a\nWindows DLL with that same name in the system folder, but since the malicious DLL is\nin the same directory as the TeamViewer executable, it is found first, and therefore is\n[loaded instead of the Windows DLL. This is known as DLL search order hijacking. This](https://attack.mitre.org/techniques/T1038/)\n\n\n-----\n\nACTIVEDS.dll hooks several API calls in the\nTeamViewer executable to hide the\napplication’s tray icon and to capture login\ncredentials. The part of the code where the\nhooks are set is shown in Figure 11.\n\n\n_Figure 10. TeamViewer files dropped by_\n\n_TerraTV_\n\n\n-----\n\n_Figure 11. Hooks set for TeamViewer_\n\nThe Windows API call DefWindowProcW (called several times by the TeamViewer\nexecutable to process messages directed to its main window) is hooked with a routine that\nwrites TeamViewer’s ID and password to the file %APPDATA%\\log_CZ72kGqTdU.txt.\nWith these credentials, and TeamViewer running with no visible tray icon or window, the\noperators of the malware can remotely control the computer, via its GUI, at any time.\n\n## Post-compromise toolset\n\n\n-----\n\nThe malicious components previously mentioned are frequently extended with several\nadditional tools in the Evilnum group’s arsenal. In most of the compromises we have\nseen, the attackers utilized publicly available tools, but have also developed some custom\nscripts. Usually they keep their tools in password-protected archives on their servers and\ndecompress them on a victim’s PC as needed.\n\n### Python-based tools\n\nReverse shell over SSL script: A very short script that takes the server and port as\ncommand line arguments.\n[SSL proxy that uses PythonProxy, junction, plink and stunnel. It can also connect to](https://code.google.com/archive/p/python-proxy/source/default/source)\n[an FTP server or use pysoxy. We have seen the script being used with the “proxy”](https://github.com/MisterDaneel/pysoxy)\nsetting and 185.62.189[.]210 as the server.\n[LaZagne to retrieve stored passwords](https://github.com/AlessandroZ/LaZagne/blob/master/Linux/laZagne.py)\n[IronPython along with libraries for taking screenshots, keylogging and recording](https://github.com/IronLanguages/ironpython2)\nDirectSound audio\n\n### Other publicly available tools\n\n[PowerShell scripts: for example, Bypass-UAC](https://github.com/FuzzySecurity/PowerShell-Suite/blob/master/Bypass-UAC/Bypass-UAC.ps1)\n[Several NirSoft utilities; for example, Mail PassView, to retrieve passwords from](https://www.nirsoft.net/utils/mailpv.html)\n[email clients, and ProduKey, to get Microsoft Office and Windows Licenses](https://www.nirsoft.net/utils/product_cd_key_viewer.html)\n\n## Conclusion\n\nThe Evilnum group has been operating for at least two years and was active at the time of\nthis writing. It has an infrastructure for its operations with several different servers: one\nfor communications with the JS component, another for the C# component, a different\none for storing its tools and exfiltrated data, proxy server, and so on. This group targets\nfintech companies that provide trading and investment platforms for their customers. The\ntargets are very specific and not numerous. This, and the group’s use of legitimate tools in\nits attack chain, have kept its activities largely under the radar. Thanks to our telemetry\ndata we were able to join the dots and discover how the group operates, uncovering some\noverlaps with other known APT groups. We think this and other groups share the same\nMaaS provider, and the Evilnum group cannot yet be associated with any previous attacks\nby any other APT group.\n\nA comprehensive list of Indicators of Compromise (IoCs) and samples can be found in\n[our GitHub repository.](https://github.com/eset/malware-ioc/tree/master/evilnum)\n\n_For any inquiries, or to make sample submissions related to the subject, contact us at_\n_threatintel@eset.com._\n\n_[Special thanks to Ignacio Sanmillan for his help with the analysis of the Golden Chickens](https://www.welivesecurity.com/author/isanmillan/)_\n_components._\n\n\n-----\n\n## MITRE ATT&CK techniques\n\n**Tac-**\n**tic** **ID** **Name** **Description**\n\n\nInitial\nAccess\n\nExecution\n\n\n[T1192](https://attack.mitre.org/techniques/T1192/) Spearphishing Link\n\n\n[T1191](https://attack.mitre.org/techniques/T1191/) CMSTP cmstp.exe is used to execute a remotely hosted scriptlet\nthat drops a malicious ActiveX file.\n\n\nEmails contain a link to download a compressed file\nfrom an external server.\n\n\n[T1059](https://attack.mitre.org/techniques/T1059/) CommandLine\nInterface\n\n[T1129](https://attack.mitre.org/techniques/T1129/) Execution\nthrough\nModule\nLoad\n\n[T1061](https://attack.mitre.org/techniques/T1061/) Graphical\nUser\nInterface\n\n\ncmd.exe is used to execute commands and scripts.\n\nThe malicious payload for the version 4.0 C# component is loaded from a DLL. TerraTV loads a malicious\nDLL to enable silent use of TeamViewer.\n\nTerraTV malware allows remote control using\nTeamViewer.\n\n\n[T1086](https://attack.mitre.org/techniques/T1086/) PowerShell Evilnum group executes LaZagne and other PowerShell scripts after their JS component has compromised a target.\n\n[T1117](https://attack.mitre.org/techniques/T1117/) Regsvr32 Evilnum group uses regsvr32.exe to execute their\nGolden Chickens tools.\n\n[T1064](https://attack.mitre.org/techniques/T1064/) Scripting Initial compromise and post-compromise use several\nJavaScript, Python and PowerShell scripts.\n\n\n[T1218](https://attack.mitre.org/techniques/T1218/) Signed Binary Proxy\nExecution\n\n[T1204](https://attack.mitre.org/techniques/T1204/) User\nExecution\n\n[T1047](https://attack.mitre.org/techniques/T1047/) Windows\nManagement\nInstrumentation\n\n[T1220](https://attack.mitre.org/techniques/T1220/) XSL Script\nProcessing\n\n\nmsiexec.exe is used to install the malicious C#\ncomponent.\n\nVictims are lured to open LNK files that will install a\nmalicious JS component.\n\nWMI is used by the JS component to obtain information such as which antivirus product is installed.\n\nMore_eggs malware uses msxsl.exe to invoke JS code\nfrom an XSL file.\n\n\n-----\n\n**Tac-**\n**tic** **ID** **Name** **Description**\n\n\nPersistence\n\nDefense\nEvasion\n\n\n[T1060](https://attack.mitre.org/techniques/T1060/) Registry\nRun Keys /\nStartup\nFolder\n\n[T1108](https://attack.mitre.org/techniques/T1108/) Redundant\nAccess\n\n\n[T1038](https://attack.mitre.org/techniques/T1038/) DLL Search\nOrder\nHijacking\n\n[T1088](https://attack.mitre.org/techniques/T1088/) Bypass User\nAccess\nControl\n\n[T1116](https://attack.mitre.org/techniques/T1116/) Code\nSigning\n\n[T1090](https://attack.mitre.org/techniques/T1090/) Connection\nProxy\n\n[T1140](https://attack.mitre.org/techniques/T1140/) Deobfuscate/Decode Files\nor\nInformation\n\n[T1107](https://attack.mitre.org/techniques/T1107/) File\nDeletion\n\n[T1143](https://attack.mitre.org/techniques/T1143/) Hidden\nWindow\n\n[T1036](https://attack.mitre.org/techniques/T1036/) Masquerading\n\n[T1112](https://attack.mitre.org/techniques/T1112/) Modify\nRegistry\n\n\nRegistry Run keys are created in order to persist by the\nJS and C# components, as well as More_eggs\n\nEvilnum components are independent and provide redundancy in case one of them is detected and removed.\n\n\n[T1179](https://attack.mitre.org/techniques/T1179/) Hooking TerraTV malware hooks several API calls in\nTeamViewer.\n\n\nTerraTV malware has TeamViewer load a malicious\nDLL placed in the TeamViewer directory, instead of\nthe original Windows DLL located in a system folder.\n\nA PowerShell script is used to bypass UAC.\n\nSome of the Golden Chickens components are malicious signed executables. Also, Evilnum group uses legitimate (signed) applications such as cmstp.exe or\nmsxsl.exe as a defense evasion mechanism.\n\nConnection to a proxy server is set up with post-compromise scripts.\n\nEncryption, encoding and obfuscation are used in\nmany Evilnum malware components.\n\nBoth JS and C# components delete temporary files and\nfolders created during the initial compromise.\n\nTerraTV runs TeamViewer with its window and tray\nicon hidden.\n\nThe C# component has its payload in system.memmory.dll, which masquerades as a benign .NET\nFramework DLL.\n\nEvilnum modifies the registry for different purposes,\nmainly to persist in a compromised system (for example, by using a registry's Run key).\n\n\n-----\n\n**Tac-**\n**tic** **ID** **Name** **Description**\n\n\nEncryption, encoding and obfuscation is used in many\nEvilnum malware components.\n\nThe Golden Chickens components implement several\nintegrity checks and evasion techniques.\n\nScripts and tools such as LaZagne are used to retrieve\nstored credentials.\n\nThe C# component retrieves stored passwords from\nChrome.\n\nCustom Python scripts have been used for keylogging.\n\nEvilnum malware steals cookies from Chrome.\n\nMore_eggs queries the registry to know if the user has\nadmin privileges.\n\nBoth the JS and C# components search for installed\nantivirus software.\n\nTerraStealer malware looks for specific applications.\n\nInformation about the system is sent to the C&C\nservers.\n\n\nCredential\nAccess\n\nDiscovery\n\nCollection\n\n\n[T1027](https://attack.mitre.org/techniques/T1027/) Obfuscated\nFiles or\nInformation\n\n[T1497](https://attack.mitre.org/techniques/T1497/) Virtualization/Sandbox Evasion\n\n[T1003](https://attack.mitre.org/techniques/T1003/) Credential\nDumping\n\n[T1503](https://attack.mitre.org/techniques/T1503/) Credentials\nfrom Web\nBrowsers\n\n[T1056](https://attack.mitre.org/techniques/T1056/) Input\nCapture\n\n[T1539](https://attack.mitre.org/techniques/T1539/) Steal Web\nSession\nCookie\n\n[T1012](https://attack.mitre.org/techniques/T1012/) Query\nRegistry\n\n[T1063](https://attack.mitre.org/techniques/T1063/) Security\nSoftware\nDiscovery\n\n[T1518](https://attack.mitre.org/techniques/T1518/) Software\nDiscovery\n\n[T1082](https://attack.mitre.org/techniques/T1082/) System Information\nDiscovery\n\n\n[T1074](https://attack.mitre.org/techniques/T1074/) Data Staged Data is stored in a temporary location before it is sent\nto the C&C.\n\n\n[T1005](https://attack.mitre.org/techniques/T1005/) Data from\nLocal\nSystem\n\n[T1114](https://attack.mitre.org/techniques/T1114/) Email\nCollection\n\n[T1056](https://attack.mitre.org/techniques/T1056/) Input\nCapture\n\n\nThe JS component (v2.1) has code to exfiltrate Excel\nfiles from the local system.\n\nTerraStealer malware targets email applications.\n\nKeystrokes are logged with a Python script.\n\n\n-----\n\n**Tac-**\n**tic** **ID** **Name** **Description**\n\n\nScreenshots are taken by some Evilnum malware\ncomponents.\n\nHTTP and HTTPS are used for C&C communication.\n\nSome of the data sent to the C&C is base64-encoded.\n\nThe JS and C# components can obtain a new C&C by\nparsing third-party webpages if the original C&C is\ndown.\n\nEvilnum malware uses independent C&C servers for its\nvarious components.\n\nTerraTV malware uses TeamViewer to give control of\nthe compromised computer to the attackers.\n\nFiles are uploaded to/downloaded from a C&C server.\n\nHTTP and HTTPS are used for C&C.\n\nMore_eggs malware uses RC4 to encrypt data to be\nsent to the C&C.\n\nGitHub, GitLab, Reddit and other websites are used to\nstore C&C server information.\n\nSome Evilnum components encrypt data before sending it to the C&C.\n\nScripts are manually deployed by the malware operators to send data to an FTP server.\n\nData is exfiltrated over the same channel used for C&C.\n\n\nCommand\nand\nControl\n\nExfiltration\n\n\n[T1113](https://attack.mitre.org/techniques/T1113/) Screen\nCapture\n\n[T1043](https://attack.mitre.org/techniques/T1043/) Commonly\nUsed Port\n\n[T1132](https://attack.mitre.org/techniques/T1132/) Data\nEncoding\n\n[T1008](https://attack.mitre.org/techniques/T1008/) Fallback\nChannels\n\n[T1104](https://attack.mitre.org/techniques/T1104/) Multi-Stage\nChannels\n\n[T1219](https://attack.mitre.org/techniques/T1219/) Remote Access Tools\n\n[T1105](https://attack.mitre.org/techniques/T1105/) Remote File\nCopy\n\n[T1071](https://attack.mitre.org/techniques/T1071/) Standard\nApplication\nLayer\nProtocol\n\n[T1032](https://attack.mitre.org/techniques/T1032/) Standard\nCryptographic\nProtocol\n\n[T1102](https://attack.mitre.org/techniques/T1102) Web\nService\n\n[T1022](https://attack.mitre.org/techniques/T1022/) Data\nEncrypted\n\n[T1048](https://attack.mitre.org/techniques/T1048/) Exfiltration\nOver Alternative\nProtocol\n\n[T1041](https://attack.mitre.org/techniques/T1041/) Exfiltration\nOver Command and\nControl\nChannel\n\n\n-----\n\n[Matías Porolli 9 Jul 2020 - 11:30AM](https://www.welivesecurity.com/author/mporolli/)\n\n### Newsletter\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.07.09_Evilnum_Toolset/More%20evil_%20A%20deep%20look%20at%20Evilnum%20and%20its%20toolset%20_%20WeLiveSecurity.pdf"
    ],
    "report_names": [
        "More evil_ A deep look at Evilnum and its toolset _ WeLiveSecurity"
    ],
    "threat_actors": [
        {
            "id": "059b16f8-d4e0-4399-9add-18101a2fd298",
            "created_at": "2022-10-25T15:50:23.29434Z",
            "updated_at": "2025-03-27T02:00:55.431907Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Evilnum"
            ],
            "source_name": "MITRE:Evilnum",
            "tools": [
                "More_eggs",
                "EVILNUM",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "39ea99fb-1704-445d-b5cd-81e7c99d6012",
            "created_at": "2022-10-25T16:07:23.601894Z",
            "updated_at": "2025-03-27T02:02:09.882982Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Jointworm",
                "Operation Phantom in the [Command] Shell",
                "TA4563"
            ],
            "source_name": "ETDA:Evilnum",
            "tools": [
                "Bypass-UAC",
                "Cardinal RAT",
                "ChromeCookiesView",
                "EVILNUM",
                "Evilnum",
                "IronPython",
                "LaZagne",
                "MailPassView",
                "More_eggs",
                "ProduKey",
                "PyVil",
                "PyVil RAT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Taurus Loader TeamViewer Module",
                "Terra Loader",
                "TerraPreter",
                "TerraStealer",
                "TerraTV"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7a257844-df90-4bd4-b0f1-77d00ff82802",
            "created_at": "2022-10-25T16:07:24.376356Z",
            "updated_at": "2025-03-27T02:02:10.199451Z",
            "deleted_at": null,
            "main_name": "Venom Spider",
            "aliases": [
                "Golden Chickens",
                "Venom Spider"
            ],
            "source_name": "ETDA:Venom Spider",
            "tools": [
                "More_eggs",
                "PureLocker",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Builder",
                "Taurus Builder Kit",
                "Taurus Loader",
                "Taurus Loader Reconnaissance Module",
                "Taurus Loader Stealer Module",
                "Taurus Loader TeamViewer Module",
                "Terra Loader",
                "TerraCrypt",
                "TerraPreter",
                "TerraRecon",
                "TerraStealer",
                "TerraTV",
                "TerraWiper",
                "ThreatKit",
                "VenomKit",
                "VenomLNK",
                "lite_more_eggs"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "88802a4b-5b3d-42ee-99e6-8a4f5fd231f6",
            "created_at": "2023-01-06T13:46:38.851345Z",
            "updated_at": "2025-03-27T02:00:02.935087Z",
            "deleted_at": null,
            "main_name": "GC01",
            "aliases": [
                "Golden Chickens",
                "Golden Chickens01",
                "Golden Chickens 01"
            ],
            "source_name": "MISPGALAXY:GC01",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2dfaa730-7079-494c-b2f0-3ff8f3598a51",
            "created_at": "2022-10-25T16:07:23.474746Z",
            "updated_at": "2025-03-27T02:02:09.822683Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "ATK 67",
                "Cobalt Gang",
                "Cobalt Spider",
                "Gold Kingswood",
                "Mule Libra",
                "TAG-CR3"
            ],
            "source_name": "ETDA:Cobalt Group",
            "tools": [
                "ATMRipper",
                "ATMSpitter",
                "Agentemis",
                "AmmyyRAT",
                "AtNow",
                "COOLPANTS",
                "CobInt",
                "Cobalt Strike",
                "CobaltStrike",
                "Cyst Downloader",
                "Fareit",
                "FlawedAmmyy",
                "Formbook",
                "Little Pig",
                "Metasploit Stager",
                "Mimikatz",
                "More_eggs",
                "NSIS",
                "Nullsoft Scriptable Install System",
                "Pony Loader",
                "Ripper ATM",
                "SDelete",
                "Siplog",
                "SoftPerfect Network Scanner",
                "SpicyOmelette",
                "Taurus Builder",
                "Taurus Builder Kit",
                "Taurus Loader",
                "Terra Loader",
                "ThreatKit",
                "VenomKit",
                "cobeacon",
                "win.xloader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ee3363a4-e807-4f95-97d8-b603c31b9de1",
            "created_at": "2023-01-06T13:46:38.485884Z",
            "updated_at": "2025-03-27T02:00:02.845851Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "Camouflage Tempest",
                "MageCart Group 6",
                "G0037",
                "TA4557",
                "SKELETON SPIDER",
                "ITG08",
                "White Giant",
                "GOLD FRANKLIN",
                "ATK88"
            ],
            "source_name": "MISPGALAXY:FIN6",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f5c90ccc-0f18-4e07-a246-b62101ab2f6f",
            "created_at": "2023-01-06T13:46:38.854407Z",
            "updated_at": "2025-03-27T02:00:02.935908Z",
            "deleted_at": null,
            "main_name": "GC02",
            "aliases": [
                "Golden Chickens",
                "Golden Chickens02",
                "Golden Chickens 02"
            ],
            "source_name": "MISPGALAXY:GC02",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "12517c87-040a-4627-a3df-86ca95e5c13f",
            "created_at": "2022-10-25T16:07:23.61665Z",
            "updated_at": "2025-03-27T02:02:09.889471Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "ATK 88",
                "Camouflage Tempest",
                "FIN6",
                "Gold Franklin",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "TAG-CR2",
                "White Giant"
            ],
            "source_name": "ETDA:FIN6",
            "tools": [
                "AbaddonPOS",
                "Agentemis",
                "AmmyyRAT",
                "Anchor_DNS",
                "BlackPOS",
                "CmdSQL",
                "Cobalt Strike",
                "CobaltStrike",
                "FlawedAmmyy",
                "FrameworkPOS",
                "Grateful POS",
                "JSPSPY",
                "Kaptoxa",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LockerGoga",
                "MMon",
                "Magecart",
                "Meterpreter",
                "Mimikatz",
                "More_eggs",
                "NeverQuest",
                "POSWDS",
                "Reedum",
                "Ryuk",
                "SCRAPMINT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Terra Loader",
                "TerraStealer",
                "Vawtrak",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "cobeacon",
                "grabnew"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8ce861d7-7fbd-4d9c-a211-367c118bfdbd",
            "created_at": "2023-01-06T13:46:39.153487Z",
            "updated_at": "2025-03-27T02:00:03.009422Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "TA4563",
                "EvilNum",
                "Jointworm",
                "KNOCKOUT SPIDER",
                "DeathStalker"
            ],
            "source_name": "MISPGALAXY:Evilnum",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b3acfb48-b04d-4d3d-88a8-836d7376fa2e",
            "created_at": "2024-06-19T02:03:08.052814Z",
            "updated_at": "2025-03-27T02:05:17.368029Z",
            "deleted_at": null,
            "main_name": "GOLD FRANKLIN",
            "aliases": [
                "ITG08 ",
                "MageCart Group 6 ",
                "Skeleton Spider ",
                "White Giant ",
                "FIN6 "
            ],
            "source_name": "Secureworks:GOLD FRANKLIN",
            "tools": [
                " Metasploit",
                " Meterpreter",
                " Mimikatz",
                " PowerSploit",
                " PowerUpSQL",
                " RemCom",
                "FrameWorkPOS"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ea7bfe06-7c23-481d-b8ba-eafa6cda3bc9",
            "created_at": "2022-10-25T15:50:23.317961Z",
            "updated_at": "2025-03-27T02:00:55.440858Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "FIN6",
                "Magecart Group 6",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "Camouflage Tempest"
            ],
            "source_name": "MITRE:FIN6",
            "tools": [
                "FlawedAmmyy",
                "GrimAgent",
                "FrameworkPOS",
                "More_eggs",
                "Cobalt Strike",
                "Windows Credential Editor",
                "AdFind",
                "PsExec",
                "LockerGoga",
                "Ryuk",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c11abba0-f5e8-4017-a4ee-acb1a7c8c242",
            "created_at": "2022-10-25T15:50:23.744036Z",
            "updated_at": "2025-03-27T02:00:55.537114Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "Cobalt Group",
                "GOLD KINGSWOOD",
                "Cobalt Gang",
                "Cobalt Spider"
            ],
            "source_name": "MITRE:Cobalt Group",
            "tools": [
                "Mimikatz",
                "More_eggs",
                "SpicyOmelette",
                "SDelete",
                "Cobalt Strike",
                "PsExec"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041768,
    "ts_creation_date": 1594351555,
    "ts_modification_date": 1594351555,
    "files": {
        "pdf": "https://archive.orkl.eu/b2431a336059c7dca596d6f2195b08f084129dc6.pdf",
        "text": "https://archive.orkl.eu/b2431a336059c7dca596d6f2195b08f084129dc6.txt",
        "img": "https://archive.orkl.eu/b2431a336059c7dca596d6f2195b08f084129dc6.jpg"
    }
}