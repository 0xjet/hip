{
    "id": "ac730ef4-0317-48ac-ac8a-ebe697c87ad6",
    "created_at": "2023-01-12T15:05:43.409377Z",
    "updated_at": "2025-03-27T02:16:26.248297Z",
    "deleted_at": null,
    "sha1_hash": "550fdf5cb49ec2322621ac07b29e42d4665e1ca0",
    "title": "2022-08-02 - Fake Atomic Wallet Website Distributing Mars Stealer",
    "authors": "",
    "file_creation_date": "2022-08-18T03:55:22Z",
    "file_modification_date": "2022-08-18T03:55:22Z",
    "file_size": 1499591,
    "plain_text": "# Fake Atomic Wallet Website Distributing Mars Stealer\n\n**[blog.cyble.com/2022/08/02/fake-atomic-wallet-website-distributing-mars-stealer/](https://blog.cyble.com/2022/08/02/fake-atomic-wallet-website-distributing-mars-stealer/)**\n\n## Info Stealer Targeting Browsers and Crypto Wallets\n\n\nAugust 2, 2022\n\n\nThe popularity of Cryptocurrency has increased exponentially over the recent years as dealing with\ncrypto has become relatively hassle-free and more accessible. The financial returns of crypto\ninvestments have attracted many investors to invest in crypto markets.\n\nAs the demand for crypto investment has increased over the years, we can also see a corresponding rise\nin the number of crypto wallets. Some popular crypto wallets such as Binance, Atomic, Exodus,\nCoinbase, Metamask, and Trust are the most commonly used platforms to manage and transact\nCryptocurrency.\n\nDespite gaining popularity worldwide, Cryptocurrency also has its downsides. It opens the door for\nvarious malicious activities like phishing, scams, hacking, delivering malware, etc.\n\n\n-----\n\nCyble Research Labs has constantly been tracking malicious activities targeting Cryptocurrency wallets.\n[During a routine threat-hunting exercise, we came across a Twitter post where a researcher mentioned a](https://twitter.com/ViriBack/status/1554137490872799233?t=T8KXijmWIb3omyiPlJyQYg&s=19)\nfake Atomic wallet site distributing Mars Stealer.\n\nThe phishing site “hxxp://atomic-wallet[.]net” uses the icon and name of the Atomic wallet. Additionally,\nthe Threat Actor is trying to copy the UI of a genuine website to trick the user, as shown in the below\nimage.\n\n_Figure 1 – Phishing site impersonating Atomic Wallet website_\nUpon investigating the phishing site, we observed that the TA has invested time in developing a welldesigned phishing site to trick victims into downloading the malware.\n\nThe phishing site appears to be genuine as the TA provided some attractive content such as Trusted\nReviews, Cashback, FAQ, Partners, Contact Us page, Support, and Update History.\n\n_Figure 2 – Content on Phishing site to appear legitimate_\nWhen the user interacts with the “Download” button, the phishing site redirects to the download options\npage, where the user can download Atomic wallet for Windows, iOS, and Android, as shown in the below\nimage\n\n\n-----\n\n_Figure 3 – Download options for the user_\nThe App Store button is inactive while, the Google Play button redirects the user to the genuine Atomic\nWallet Play Store link.\n\nWhen the user clicks on the “Download for Windows” button, it connects to shortened URL\n“hxxps://bit[.]ly/3PRDyH8” and downloads a Zip file named “Atomic Wallet.zip“.\n\nAfter a detailed investigation, the downloaded file was identified as a Mars Stealer sample. Mars Stealer\nwas discovered in June 2021 and was available for sale on a few underground cybercrime forums. Mars\nstealer primarily targets browser extensions, crypto extensions and wallets, and 2FA plugins.\n\n## Technical Analysis\n\nThe downloaded Zip file contains the “AtomicWallet-Setup.bat” file containing malicious code, as shown\nin the below image.\n\n_Figure 4 – Downloaded Zip file content_\nUpon execution, the .bat file invokes the Powershell command, enabling the administrative elevation for\nits execution.\n\n\n-----\n\n_Figure 5 – Executing PowerShell command for admin privileges_\nThe .bat file then copies powershell.exe into the current directory, renames it as\n_AtomicWallet_Setup.bat.exe, and then hides it using the attrib command._\n\n_Figure 6 – Hiding the .exe file using the attrib command_\nThen, the .bat file executes PowerShell content using AtomicWallet_Setup.bat.exe, which further\ndecodes the base64-encoded content and decrypts it using an AES algorithm that stores a Gzip\nCompressed stream in the memory.\n\nThe below figure shows the code used by the malware to perform AES decryption and GZip\nDecompression.\n\n_Figure 7 – Code for AES Decryption and GZip Decompression_\nFinally, the malware decompresses the GZip content and loads the final PowerShell code that downloads\nMars Stealer from the Discord server to the victim’s %LOCALAPPDATA% location.\n\n_Figure 8 – Downloading Mars Stealer from the Discord server_\nThe below figure shows the infection chain of Mars Stealer. After downloading Mars stealer, the .bat file\ndeletes the “AtomicWallet_Setup.bat.exe” from the victim’s machine.\n\n\n-----\n\n_Figure 9 – Infection chain_\n\nAfter successful installation, Mars Stealer steals sensitive information from the victim’s device and\nexfiltrates the stolen data to the C&C server.\n\n_Figure 10 – Malware sending stolen data to the C&C server_\n\n## Conclusion\n\nAccording to our research, the TAs behind Mars stealer are adopting sophisticated phishing attacks to\ndistribute Mars Stealer and gather user credentials, system information, and other sensitive data.\n\nThe criminals may use compromised credentials to carry out attacks to stay under the radar and avoid\ntripping any security monitoring rules, thus alerting any victims to the attempted compromise.\n\n## Our Recommendations\n\nAvoid downloading pirated software from unverified sites.\nUse strong passwords and enforce multi-factor authentication wherever possible.\nKeep updating your passwords after certain intervals.\nUse a reputed anti-virus and internet security software package on your connected devices,\nincluding PC, laptop, and mobile.\nRefrain from opening untrusted links and email attachments without first verifying their authenticity.\nBlock URLs that could be used to spread the malware, e.g., Torrent/Warez.\nMonitor the beacon on the network level to block data exfiltration by malware or TAs.\n\n\n-----\n\nEnable Data Loss Prevention (DLP) Solutions on employees systems.\n\n## MITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\n**Initial Access** [T1566](https://attack.mitre.org/techniques/T1566/) Phishing\n\n**Execution** [T1204](https://attack.mitre.org/techniques/T1204/) User Execution\n\n**Defense Evasion** [T1564](https://attack.mitre.org/techniques/T1564/001/) Hidden Files and Directory\n\n**Defense Evasion** [T1027](https://attack.mitre.org/techniques/T1027) Obfuscated Files or Information\n\n\n**Credential Access** [T1555](https://attack.mitre.org/techniques/T1555/)\n\n[T1539](https://attack.mitre.org/techniques/T1539/)\n\n[T1552](https://attack.mitre.org/techniques/T1552/)\n\n[T1528](https://attack.mitre.org/techniques/T1528/)\n\n\nCredentials from Password Stores\n\nSteal Web Session Cookies\n\nUnsecured Credentials\n\nSteal Application Access Token\n\n\n**Discovery** [T1082](https://attack.mitre.org/techniques/T1082/) System Information Discovery\n\n**Exfiltration** [T1041](https://attack.mitre.org/techniques/T1041/) Exfiltration Over C&C Channel\n\n## Indicators Of Compromise (IOCs)\n\n**Indicators** **Indicator**\n**Type**\n\n\n**Description**\n\n\n**33d0d9fe89f0dba2b89347a0e2e6deb22542476d98676187f8c1eb529cb3997f** SHA256 Hash of the\nanalyzed\nbat file\n\n**dfdbb09661ee90ad4e88e7b0510653c93485a4b2** SHA1 Hash of the\nanalyzed\nbat file\n\n**3004914cdfa67357410e6f0c9a091655** MD5 Hash of the\nanalyzed\nbat file\n\n**10afe233525aaf99064e4e444f11a8fc01f8b9f508e4f123fd76b314a6d360f9** SHA256 Hash of the\nanalyzed\nMars\nStealer exe\nfile\n\n**0f6e3442c67d6688fae5f51b4f60b78cd05f30df** SHA1 Hash of the\nanalyzed\nMars\nStealer exe\nfile\n\n\n-----\n\n**10f0d3a64949a6e15a9c389059a8f379** MD5 Hash of the\nanalyzed\nMars\nStealer exe\nfile\n\n**hxxps://atomic-wallet[.]net** URL Malware\ndistribution\nsite/C&C\nserver\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-02 - Fake Atomic Wallet Website Distributing Mars Stealer.pdf"
    ],
    "report_names": [
        "2022-08-02 - Fake Atomic Wallet Website Distributing Mars Stealer.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535943,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1660794922,
    "ts_modification_date": 1660794922,
    "files": {
        "pdf": "https://archive.orkl.eu/550fdf5cb49ec2322621ac07b29e42d4665e1ca0.pdf",
        "text": "https://archive.orkl.eu/550fdf5cb49ec2322621ac07b29e42d4665e1ca0.txt",
        "img": "https://archive.orkl.eu/550fdf5cb49ec2322621ac07b29e42d4665e1ca0.jpg"
    }
}