{
    "id": "e71a4df5-baf5-4661-89c5-645d2d0b8e76",
    "created_at": "2023-01-12T15:08:04.039168Z",
    "updated_at": "2025-03-27T02:09:58.272539Z",
    "deleted_at": null,
    "sha1_hash": "76f995f7ca300b4fedf919fc5302377bd86da569",
    "title": "2018-09-05 - Windows Task Scheduler Zero Day Exploited by Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T03:08:43Z",
    "file_modification_date": "2022-05-28T03:08:43Z",
    "file_size": 904009,
    "plain_text": "# Windows Task Scheduler Zero Day Exploited by Malware\n\n**[bleepingcomputer.com/news/security/windows-task-scheduler-zero-day-exploited-by-malware/](https://www.bleepingcomputer.com/news/security/windows-task-scheduler-zero-day-exploited-by-malware/)**\n\nIonut Ilascu\n\nBy\n[Ionut Ilascu](https://www.bleepingcomputer.com/author/ionut-ilascu/)\n\nSeptember 5, 2018\n11:45 AM\n4\n\nMalware developers have started to use the zero-day exploit for Task Scheduler component\nin Windows, two days after proof-of-concept code for the vulnerability appeared online.\n\nA security researcher who uses the online name SandboxEscaper on August 27\n[released the source code for exploiting a security bug in the Advanced Local Procedure Call](http://webcache.googleusercontent.com/search?q=cache%3Ahttps%3A%2F%2Ftwitter.com%2FSandboxEscaper%2Fstatus%2F1034125195148255235&ie=utf-8&oe=utf-8&client=firefox-b-ab)\n(ALPC) interface used by Windows Task Scheduler.\n\nMore specifically, the problem is with the SchRpcSetSecurity API function, which fails to\nproperly check user's permissions, allowing write privileges on files in C:\\Windows\\Task.\n\nThe vulnerability affects Windows versions 7 through 10 and can be used by an attacker to\nescalate their privileges to all-access SYSTEM account level.\n\nA couple of days after the exploit code became available (source and binary), malware\nresearchers at ESET noticed its use in active malicious campaigns from a threat actor they\ncall PowerPool, because of their tendency to use tools mostly written in PowerShell for\n\n\n-----\n\nlateral movement.\n\n## PowerPool targets GoogleUpdate.exe\n\nThe group appears to have a small number of victims in the following countries: Chile,\nGermany, India, the Philippines, Poland, Russia, the United Kingdom, the United States, and\nUkraine.\n\nThe researchers say that PowerPool developers did not use the binary version of the exploit,\ndeciding instead to make some subtle changes to the source code before recompiling it.\n\n\"PowerPool’s developers chose to change the content of the file C:\\Program Files\n(x86)\\Google\\Update\\GoogleUpdate.exe. This is the legitimate updater for Google\napplications and is regularly run under administrative privileges by a Microsoft Windows\ntask,\" ESET [notes.](https://www.welivesecurity.com/2018/09/05/powerpool-malware-exploits-zero-day-vulnerability/)\n\nThreat actor changes permissions of the Google Updater executable\nThis allows PowerPool to overwrite the Google updater executable with a copy of a backdoor\nthey typically use in the second stages of their attacks. The next time the updater is called,\nthe backdoor launches with SYSTEM privileges.\n\nAccording to the researchers, PowerPool malware operators likely use the second-stage\nbackdoor only on victims of interest, following a reconnaissance step.\n\nMicrosoft did not patch the ALPC bug to this day, but it is expected to release a fix in its\nmonthly security updates, on September 11.\n\nSome mitigation is possible without Microsoft's help, though the company did not approve it.\nA solution provided by Karsten Nilsen blocks the exploit and allows scheduled tasks to run,\nbut it may break things created by the legacy Task Scheduler interface.\n\nShort term solution on VU#906424:\n\nicacls c:\\windows\\tasks /remove:g \"Authenticated Users\"\n\nicacls c:\\windows\\tasks /deny system:(OI)(CI)(WD,WDAC)\n\nTested and blocks 0day, changing these rights may result in unexpected behavior in\n[scheduled tasks.@USCERT_gov](https://twitter.com/USCERT_gov?ref_src=twsrc%5Etfw)\n\n[— Karsten Nilsen (@karsten nilsen) August 28 2018](https://twitter.com/karsten_nilsen/status/1034406706879578112?ref_src=twsrc%5Etfw)\n\n\n-----\n\nUsers of 64-bit Windows 10, version 1803, can mitigate the problem by applying a\n[micropatch. The fix is temporary and requires the installation of the 0patch Agent from Acros](https://www.bleepingcomputer.com/news/security/temporary-patch-available-for-recent-windows-task-scheduler-alpc-zero-day/)\nSecurity.\n\nThe company makes the source code for the micropatch available in the tweet below:\n\nBlog post is in the making but for the impatient, here's the source code of our\nmicropatch. Three patchlets, one calling RpcImpersonateClient, one removing a\npremature call to RpcRevertToSelf, and one adding a RpcRevertToSelf call where it\n[should be. Just 4 instructions. pic.twitter.com/PtgsPJiiSO](https://t.co/PtgsPJiiSO)\n\n[— 0patch (@0patch) August 30, 2018](https://twitter.com/0patch/status/1035147485801603072?ref_src=twsrc%5Etfw)\n\n### Related Articles:\n\n[Critical Windows RPC CVE-2022-26809 flaw raises concerns — Patch now](https://www.bleepingcomputer.com/news/microsoft/critical-windows-rpc-cve-2022-26809-flaw-raises-concerns-patch-now/)\n\n[Exploit released for critical VMware auth bypass bug, patch now](https://www.bleepingcomputer.com/news/security/exploit-released-for-critical-vmware-auth-bypass-bug-patch-now/)\n\n[Microsoft shares mitigation for Windows KrbRelayUp LPE attacks](https://www.bleepingcomputer.com/news/security/microsoft-shares-mitigation-for-windows-krbrelayup-lpe-attacks/)\n\n[Microsoft adds support for WSL2 distros on Windows Server 2022](https://www.bleepingcomputer.com/news/microsoft/microsoft-adds-support-for-wsl2-distros-on-windows-server-2022/)\n\n[Microsoft adds Office subscriptions to Windows 11 account settings](https://www.bleepingcomputer.com/news/microsoft/microsoft-adds-office-subscriptions-to-windows-11-account-settings/)\n\n[Ionut Ilascu](https://www.bleepingcomputer.com/author/ionut-ilascu/)\n\nIonut Ilascu is a technology writer with a focus on all things cybersecurity. The topics he\nwrites about include malware, vulnerabilities, exploits and security defenses, as well as\nresearch and innovation in information security. His work has been published by Bitdefender,\nNetgear, The Security Ledger and Softpedia.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-09-05 - Windows Task Scheduler Zero Day Exploited by Malware.pdf"
    ],
    "report_names": [
        "2018-09-05 - Windows Task Scheduler Zero Day Exploited by Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "62985c5c-6938-4365-8432-29573e99ecf4",
            "created_at": "2022-10-25T16:07:24.075092Z",
            "updated_at": "2025-03-27T02:02:10.099951Z",
            "deleted_at": null,
            "main_name": "PowerPool",
            "aliases": [],
            "source_name": "ETDA:PowerPool",
            "tools": [
                "ALPC Local PrivEsc",
                "FireMaster",
                "PowerDump",
                "PowerSploit",
                "Quarks PwDump",
                "SMBExec"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "adee5dfb-98d1-488f-969d-48eed28cd7e4",
            "created_at": "2023-01-06T13:46:38.799427Z",
            "updated_at": "2025-03-27T02:00:02.9221Z",
            "deleted_at": null,
            "main_name": "PowerPool",
            "aliases": [
                "IAmTheKing"
            ],
            "source_name": "MISPGALAXY:PowerPool",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536084,
    "ts_updated_at": 1743041398,
    "ts_creation_date": 1653707323,
    "ts_modification_date": 1653707323,
    "files": {
        "pdf": "https://archive.orkl.eu/76f995f7ca300b4fedf919fc5302377bd86da569.pdf",
        "text": "https://archive.orkl.eu/76f995f7ca300b4fedf919fc5302377bd86da569.txt",
        "img": "https://archive.orkl.eu/76f995f7ca300b4fedf919fc5302377bd86da569.jpg"
    }
}