{
    "id": "05287c61-764f-4a58-8e0c-87251751e9c6",
    "created_at": "2023-01-12T14:58:55.749377Z",
    "updated_at": "2025-03-27T02:06:01.160796Z",
    "deleted_at": null,
    "sha1_hash": "3744085b06cf03c89e6a340a24240cf2a3e340c9",
    "title": "2022-11-11 - Magniber Ransomware Attempts to Bypass MOTW (Mark of the Web)",
    "authors": "",
    "file_creation_date": "2022-11-28T19:04:30Z",
    "file_modification_date": "2022-11-28T19:04:30Z",
    "file_size": 1841602,
    "plain_text": "# Magniber Ransomware Attempts to Bypass MOTW (Mark of the Web)\n\n**asec.ahnlab.com/en/41889/**\n\nNovember 11, 2022\n\nThe ASEC analysis team uploaded a post on October 25th to inform the users of the changes that have\nbeen made to the Magniber ransomware. Magniber, which is still actively being distributed, has\nundergone many changes to evade the detection of anti-malware software. Out of these changes, this\nblog will cover the script format found from September 8th to September 29th, 2022, which bypassed\nMark of the Web (MOTW), a feature offered by Microsoft that identifies the source of files.\n\n\n**Date** **Extension** **Execution**\n\n**Process**\n\n\n**Encryption**\n\n**Process**\n\n\n**Recovery**\n**Environment**\n\n**Deactivation**\n\n**Process**\n\n\n**Recovery Environment**\n**Deactivation**\n\n**(UAC Bypassing)**\n\n\n2022-0507\n\n\nmsi msiexec.exe msiexec.exe regsvr32.exe Modifies reference registry upon\nexecution of fodhelper.exe\n\n(HKCU:\\Software\\Classes\\ms**settings\\shell\\open\\command)**\n\n\n6/14/2022 msi msiexec.exe Running\n\nProcess\n\n\nregsvr32.exe Modifies reference registry upon\nexecution of fodhelper.exe\n\n(HKCU:\\Software\\Classes\\(custom\n**progID)\\shell\\open\\command)**\n\n\n7/20/2022 cpl rundll32.exe rundll32.exe X X\n\n\n-----\n\n**Date** **Extension** **Execution**\n**Process**\n\n\n**Encryption**\n**Process**\n\n\n**Recovery**\n**Environment**\n**Deactivation**\n**Process**\n\n\n**Recovery Environment**\n**Deactivation**\n**(UAC Bypassing)**\n\n\n8/8/2022 cpl rundll32.exe Running\n\nProcess\n\n9/8/2022 jse wscript.exe Running\n\nProcess\n\n9/16/2022 js wscript.exe Running\n\nProcess\n\n9/28/2022 wsf wscript.exe Running\n\nProcess\n\n9/30/2022 msi msiexec.exe Running\n\nProcess\n\n\nwscript.exe Modifies reference registry upon\nexecution of fodhelper.exe\n\n(HKCU:\\Software\\Classes\\(custom\n**progID)\\shell\\open\\command)**\n\nwscript.exe Modifies reference registry upon\nexecution of fodhelper.exe\n\n(HKCU:\\Software\\Classes\\(custom\n**progID)\\shell\\open\\command)**\n\nwscript.exe Modifies reference registry upon\nexecution of fodhelper.exe\n\n(HKCU:\\Software\\Classes\\(custom\n**progID)\\shell\\open\\command)**\n\nwscript.exe Modifies reference registry upon\nexecution of fodhelper.exe\n\n(HKCU:\\Software\\Classes\\(custom\n**progID)\\shell\\open\\command)**\n\nwscript.exe Modifies reference registry upon\nexecution of fodhelper.exe\n\n(HKCU:\\Software\\Classes\\(custom\n**progID)\\shell\\open\\command)**\n\n\n[Table 1. Major characteristics of Magniber ransomware by date (https://asec.ahnlab.com/en/40422/)](https://asec.ahnlab.com/en/40422/)\n[Table 1 shows the content of the ASEC blog post which covers the evolution of the Magniber](https://asec.ahnlab.com/en/40422/)\nransomware. Among these changes, the threat operator used scripts as the distribution method during\nthe period from September 8th to September 29th, 2022. Magniber was downloaded through the\ntyposquatting method, which exploits typos made by the user when accessing domains (See Figure 1).\n\nFigure 1. Typosquatting distribution method of Magniber\nThe downloaded file is identified to be from an external source by the Windows Mark of the Web (MOTW)\nfeature.[2] MOTW operates on New Technology File System (NTFS). The download URL is recorded in a\nstream in Windows of NTFS.[3] The stream where the URL is saved is created in the file path in the format\nof “File Name:Zone.Identifier:$DATA” and can be easily viewed with Notepad. When the downloaded files\nidentified by MOTW are executed, a warning message is displayed.\n\n\n-----\n\nFigure 2. File recorded by MOTW\nIn order to bypass such execution blocks by MOTW, Magniber used a digital signature at the end of the\nscript during the period between September 8th and September 29th, 2022. Through signing after the\nscript is compiled, a digital signature on the script[4] guarantees that the script has not been modified, and\nprovides a way to identify the author of the script. According to a post published on Bleeping Computer,[1]\nthe digital signature at the end of the Magniber ransomware script is added to bypass MOTW.\n\nFigure 3. Magniber distribution script (wsf, js, jse)\nCurrently, Magniber is being distributed with an MSI file extension instead of a script format. However,\nuser vigilance is still required as it goes through frequent changes in its technique to bypass detection.\nAdditionally, users must be careful when executing files downloaded from untrusted websites.\n\nCurrently, AhnLab is responding to the Magniber ransomware with not only file detection but also with\nvarious detection methods. Thus, it is recommended that users activate the Process Memory Scan and\nthe Malicious Script Detection (AMSI) options in [V3 Preferences] – [PC Scan Settings].\n\n**[IOC]**\n\nb8e94ffbfc560d56e28c10073b911d50\n\nba7a32f15227c5d30b648ba407e73c80\n\n2da51943a0ea7699b01436eaa01f7a59\n\n\n-----\n\n**Script File Detection**\nRansomware/JS.Magniber (2022.09.08.02)\n\nRansomware/WSF.Magniber (2022.09.28.02)\n\n**Process Memory Detection**\n\nRansomware/Win.Magniber.XM153 (2022.09.15.03)\n**AMSI Detection (.NET DLL)**\n\nRansomware/Win.Magniber.R519329 (2022.09.15.02)\n\nReference\n\n[[1]Exploited Windows zero-day lets JavaScript files bypass security warnings](https://www.bleepingcomputer.com/news/security/exploited-windows-zero-day-lets-javascript-files-bypass-security-warnings/?fbclid=IwAR1FllaImb6LVG2wUavW8qVZlUGx8_g4VeVvdUD5gOXr75exw5SAeMLvj6I)\n\n\n\n[[2]Macros from the internet will be blocked by default in Office](https://learn.microsoft.com/en-us/deployoffice/security/internet-macros-blocked)\n\n[[3]5.1 NTFS Streams](https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/c54dec26-1551-4d3a-a0ea-4fa40f848eb3)\n\n\n\n[[4]Digitally Signing Scripts](https://learn.microsoft.com/en-us/previous-versions/tn-archive/ee176795(v=technet.10))\n\n**Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to check related**\n**IOC and detailed analysis information.**\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information-en/)\n\n[Tagged as:malware,](https://asec.ahnlab.com/en/tag/malware-en/) [Ransomware](https://asec.ahnlab.com/en/tag/ransomware-en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-11-11 - Magniber Ransomware Attempts to Bypass MOTW (Mark of the Web).pdf"
    ],
    "report_names": [
        "2022-11-11 - Magniber Ransomware Attempts to Bypass MOTW (Mark of the Web).pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535535,
    "ts_updated_at": 1743041161,
    "ts_creation_date": 1669662270,
    "ts_modification_date": 1669662270,
    "files": {
        "pdf": "https://archive.orkl.eu/3744085b06cf03c89e6a340a24240cf2a3e340c9.pdf",
        "text": "https://archive.orkl.eu/3744085b06cf03c89e6a340a24240cf2a3e340c9.txt",
        "img": "https://archive.orkl.eu/3744085b06cf03c89e6a340a24240cf2a3e340c9.jpg"
    }
}