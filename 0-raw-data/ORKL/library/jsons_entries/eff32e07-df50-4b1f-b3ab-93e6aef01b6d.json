{
    "id": "eff32e07-df50-4b1f-b3ab-93e6aef01b6d",
    "created_at": "2023-01-12T15:10:55.202018Z",
    "updated_at": "2025-03-27T02:11:43.585348Z",
    "deleted_at": null,
    "sha1_hash": "58941938a97c5eb10d67e78059327d1c82e05316",
    "title": "2020-09-02 - Chinese APT TA413 Resumes Targeting of Tibet Following COVID-19 Themed Economic Espionage Campaign Delivering Sepulcher Malware Targeting Europe",
    "authors": "",
    "file_creation_date": "2022-05-28T17:45:51Z",
    "file_modification_date": "2022-05-28T17:45:51Z",
    "file_size": 1959936,
    "plain_text": "# Chinese APT TA413 Resumes Targeting of Tibet Following COVID-19 Themed Economic Espionage Campaign Delivering Sepulcher Malware Targeting Europe\n\n**[proofpoint.com/us/blog/threat-insight/chinese-apt-ta413-resumes-targeting-tibet-following-covid-19-themed-economic](https://www.proofpoint.com/us/blog/threat-insight/chinese-apt-ta413-resumes-targeting-tibet-following-covid-19-themed-economic)**\n\nAugust 31, 2020\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nChinese APT TA413 Resumes Targeting of Tibet Following COVID-19 Themed Economic Espionage Campaign\nDelivering Sepulcher Malware Targeting Europe\n\n\n-----\n\nSeptember 01, 2020 Michael Raggi and the Proofpoint Threat Research Team\n\n**Executive Summary**\n\nBeginning in the first half of 2020, the rapid international spread of the COVID-19 virus introduced a shift within the\nthreat landscape towards pandemic-themed social engineering lures. Public research has noted several Chinese APT\ngroups adopting COVID-19 phishing lures in recent months to carry out espionage campaigns against established and\nexpanding target sets. In March 2020, Proofpoint researchers observed a phishing campaign impersonating the World\nHealth Organization’s (WHO) guidance on COVID-19 critical preparedness to deliver a new malware family that\nresearchers have dubbed “Sepulcher”. This campaign targeted European diplomatic and legislative bodies, non-profit\npolicy research organizations, and global organizations dealing with economic affairs. Additionally, a sender email\nidentified in this campaign has been linked to historic Chinese APT targeting of the international Tibetan community\nusing payloads linked to LuckyCat malware. Subsequently, a phishing campaign from July 2020 targeting Tibetan\ndissidents was identified delivering the same strain of Sepulcher malware. Operator email accounts identified in this\ncampaign have been publicly linked to historic Chinese APT campaigns targeting the Tibetan community delivering\nExileRAT malware. Based on the use of publicly known sender addresses associated with Tibetan dissident targeting\nand the delivery of Sepulcher malware payloads, Proofpoint researchers have attributed both campaigns to the APT\nactor TA413, which has previously been documented in association with ExileRAT. The usage of publicly known\nTibetan-themed sender accounts to deliver Sepulcher malware demonstrates a short-term realignment of TA413’s\ntargets of interest. While best known for their campaigns against the Tibetan diaspora, this APT group associated with\nthe Chinese state interest prioritized intelligence collection around Western economies reeling from COVID-19 in March\n2020 before resuming more conventional targeting later this year.\n\n**Delivery and Exploitation**\n\nIn the latter half of March 2020, researchers identified a malicious email sent to numerous entities involved with\neconomic policy and forecasting within Europe. The emails contained a weaponized RTF attachment that impersonated\nthe WHO’s “Critical preparedness, readiness and response actions for COVID-19, Interim guidance” document. This\nguidance was initially published on March 7, 2020, while the weaponized attachment was delivered by threat actors on\nMarch 16, 2020. When the malicious RTF attachment named “Covdi.rtf” is executed, it exploits a Microsoft Equation\nEditor vulnerability and installs an embedded malicious RTF object in the form of a Windows meta-file (WMF) to the file\ndirectory %\\AppData\\Local\\Temp\\wd4sx.wmf. This method is used by a known variant of the Royal Road RTF\nweaponizer which is shared among numerous Chinese APT actors. The execution of the WMF file ultimately results in\nthe delivery and installation of the previously unidentified Sepulcher malware.\n\n\n-----\n\n_Figure 1: Malicious Email from March 2020 “Country & Technical Guidance – Coronavirus disease...”_\n\n_Figure 2: Lure Document impersonating WHO guidance on COVID-19._\n\nThe emails in this campaign originated from the Yahoo free-mail sender address tseringkanyaq@yahoo[.]com. This\n[sender account was first written about in a joint report by Citizen Lab, the Munk School of Global Affairs, and the](https://targetedthreats.net/media/2-Extended%20Analysis-Full.pdf)\nUniversity of Toronto in 2013, which described Chinese APT activity. The report indicated this email address had been\nused in phishing campaigns from May 2012 through June 2013 to target Tibetan members of civil society. Specifically,\nthe sender address is thought to impersonate Kanyag Tsering, a Tibetan monk and activist that held a high profile in the\nmedia during the historic campaign time period. The email address delivered malicious attachments that installed\nShadowNet, Duojeen, and PubSab (OS X) malware. The report goes on to note that these malware payloads were\n[found to share infrastructure with LuckyCat malware that was identified by TrendMicro also being deployed against](https://www.trendmicro.de/cloud-content/us/pdfs/security-intelligence/white-papers/wp_luckycat_redux.pdf)\nTibetan targets in 2012. LuckyCat malware was more recently linked to Chinese APT malware targeting the\n[international Tibetan community via an APK variant reported by Talos Intelligence in January 2019. The LuckyCat](https://blog.talosintelligence.com/2019/02/exilerat-shares-c2-with-luckycat.html)\nAndroid RAT utilized in early 2019 used the same infrastructure as ExileRAT payloads to target members of a Central\nTibetan Administration mailing list.\n\nFollowing the Sepulcher malware campaign in March 2020, a subsequent malicious email campaign delivering this\nmalware was identified on July 27, 2020. The email included a malicious PowerPoint (PPSX) attachment conspicuously\nnamed “TIBETANS BEING HIT BY DEADLY VIRUS THAT CARRIES A GUN AND SPEAKS CHINESE.ppsx”. The\nSMTP header From field impersonated the “Women's Association Tibetan,\" while the attachment, once opened,\n\n\n-----\n\nreferenced Tibet, Activism and Information . When the PowerPoint attachment is executed, it calls out to the IP\n118.99.13[.]4 to download a Sepulcher malware payload named “file.dll”. Additionally, the distinct C2 request\nhxxp://118.99.13[.]4:1234/qqqzqa that occurs at that time has been seen previously in association with TA413 malware\ncampaigns. Upon the delivery of the payload “file.dll” it is saved as “credential.dll” and executed resulting in a C2\ncommunication with the domain Dalailamatrustindia.ddns[.]net. The attachment title, decoy content, impersonated\nsender, and [Dalai Lama Trust in India-themed C2 affirms this campaign’s focus on individuals associated with the](http://dalailamatrustindia.org/about-us/)\nTibetan Leadership in Exile.\n\n_Figure 3: Lure Document TIBETANS BEING HIT BY DEADLY VIRUS THAT CARRIES A GUN AND SPEAKS_\nCHINESE.ppsx.\n\nThis Sepulcher malware campaign is highly reminiscent of the January 2019 campaign that utilized PPSX attachments\n[to deliver ExileRAT malware, previously documented by Talos Intelligence. The foremost commonality between these](https://blog.talosintelligence.com/2019/02/exilerat-shares-c2-with-luckycat.html)\ncampaigns, apart from the attachment type and content of the PowerPoint, is the sender email\n“mediabureauin@gmail[.]com\" which was shared in both the historic ExileRat campaign and the recent Sepulcher\nmalware campaign from 2020. The intermittent use of a single email address in multiple APT campaigns spanning\nnearly eight years is uncommon in cyber threat research. While it is not impossible for multiple APT groups to utilize a\nsingle operator account (sender address) against distinct targets in different campaigns, it is unlikely. It is further\nunlikely that this sender reuse after several years would occur twice in a four-month period between March and July,\nwith both instances delivering the same Sepulcher malware family. The sharing of delivery/hosting infrastructure,\nmalware payloads, or post-exploitation tools have been observed across Chinese APT groups and can be considered\nmore common. However, the use of operator accounts spanning multiple APT campaigns is much less common. It is\nless advantageous to share operator accounts as the creation of new free-mail accounts for phishing delivery is trivial\nand does not represent a cost barrier to operation. Additionally, it increases the likelihood of detection by targeted\n\n\n-----\n\norganizations. Although the re emergence of two publicly known sender accounts after multiple years is unusual, the\nuse of a known sender account to target a new group of recipients in this case may represent an opsec failure resulting\nfrom a broader re-tasking of existing APT threat actors in response to an unprecedented global crisis.\n\n**Sepulcher Malware**\n\nThe Sepulcher malware payload (SHA256:\n4a4a959aef64ea48e2b831468119180d0af4b5b685c35170f5db3f001b9cc319) observed in the March 2020 campaign\ntargeting European economic targets was analyzed for this publication. The file “wd4sx.wmf” is installed by the initial\nRTF attachment upon execution and contains the final Sepulcher malware payload and a payload dropper. Sepulcher\nis a basic RAT payload that can gather intelligence on the resources of the infected system, spawn a reverse CMD\nshell, and read from and write to file.\n\nInitially, the WMF file installs a temporary file named “OSEB979.tmp” to the Windows temporary directory that serves\nas a payload dropper. It installs the final Sepulcher payload “credential.dll” to the directory\n%AppData%\\Roaming\\Identities\\Credential.dll. It then creates a scheduled task named “lemp” which uses rundll32.exe\nto run the Sepulcher payload and call the export function “GetObjectCount” on an hourly basis. This scheduled task\nserves as a persistence mechanism for Sepulcher malware.\n\n**schtasks /create /tr \"rundll32.exe %APPDATA%\\Identities\\Credential.dll,GetObjectCount\" /tn \"lemp\" /sc**\n**HOURLY**\n\n_Figure 4: Scheduled task and persistence mechanism for executing Sepulcher payload._\n\nThe Sepulcher configuration is stored in the registry under the Registry Key\nHKEY_CURRENT_USER\\Software\\Microsoft\\WAB\\Resources. It contains four distinct keys named “DefaultString”,\n“Credentials”, “Security”, and “Property”. The “DefaultString” is randomly generated by CoCreatGuid() with the initial\nformatting done by the multibyte _sprintf_(). This is then stored in the registry by RegSetValueExW() which uses the\nwide character type. This results in a broken encoding that renders as Chinese characters. This should not be\ninterpreted as an indication that the threat actor is using Chinese characters in the malware configuration, despite\nbroader attribution pointing to Chinese state associated actors. The remaining three keys “Credentials”, “Security”, and\n“Property” represent the three C2 servers in encrypted format that are utilized by the malware. The below algorithm is\nused to decrypt the C2 servers which, in this sample, are revealed to be the IP address 107.151.194[.]197 utilizing\nports 80, 443, and 8080. Notably, this IP address hosted a single domain welfaretibet[.]tk as of April 5, 2020. This\nsuggests that threat actors did not establish standalone network infrastructure for targeting European economic entities\nand intended to utilize this IP to persist in targeting entities related to Tibetan matters in the future.\n\nDecrypted C2 IP Addresses:\n\n107.151.194[.]197:80\n107.151.194[.]197:443\n107.151.194[.]197:8080\n\n_Figure 5: Sepulcher malware configuration._\n\n\n-----\n\n_Figure 6: Sepulcher malware C2 decryption algorithm._\n\nSepulcher malware has seven work modes that include conducting reconnaissance on an infected host, spawning a\nreverse command shell, reading from file, and writing to file. More granularly, additional commands exist within the\nintelligence gathering/reconnaissance work modes (1002, 1003, 1004) which carry out reconnaissance functionality\nwithin the infected host. These commands include obtaining information about the drives, file information, directory\nstatistics, directory paths, directory content, running processes, and services. Additionally, it is capable of more active\nfunctionalities like deleting directories and files, creating directories, moving file source to destination, spawning a shell\nto execute commands, terminating a process, restarting a service, changing a service start type, and deleting a service.\n\n**Mode** **Functionality**\n\n1005 Reverse command shell\n\n1006 Read from File\n\n1009 Do nothing /PONG\n\n1919 Write to File\n\n\n1002\n\n1003\n\n1004\n\n\nSystem intelligence gathering/reconnaissance functionalities\n\n\n_Figure 7: Sepulcher malware work modes (commands)._\n\n**Command** **COMMAND_DATA.data** **Functionality**\n\n6001 Drive letter Get drive information: sizes, type, path, etc.\n\n6002 File path Get file information in a WIN32_FILE_ATTRIBUTE_DATA structure.\n\n\n-----\n\n6003 Directory path Get directory statistics: number of files, sub directories and total size.\n\n6004 Directory path Get directory content information: WIN32_FILE_ATTRIBUTE_DATA and\ndir/file name.\n\n6005 N/A Delete directory / file and empty the recycle bin.\n\n6006 Directory name Create directory.\n\n\n6007 Src file path, Dst file\npath\n\n\nMove file Source to Destination.\n\n\n6008 N/A Get all drives information: sizes, types, path, etc.\n\n6009 Command string Shell execute command.\n\n6010 PID string Terminate process.\n\n6017 N/A Get directory content detailed information: WIN32_FILE_ATTRIBUTE_DATA\nand dir/file name for each dir/file inside\n\n6018 N/A Get list of running processes.\n\n6019 N/A Get list of services.\n\n6020 N/A Restart service.\n\n6021 N/A Change service start type.\n\n6023 N/A Delete service.\n\n_Figure 8: Sepulcher intelligence gathering/reconnaissance commands._\n\n**Command and Control**\n\nThe malware receives commands including various mode commands and sub-commands via the C2 addresses\ndecrypted from the malware’s configuration. The initial communication is initiated by the client via a single byte XOR\nencrypted handshake packet and completed via a server-to-client packet that is not encrypted. The communication\nthen continues with a single byte XOR encrypted client-to-server PACKET_HELLO that specifies the malware\ncommand mode. In the case of modes 1002, 1003, and 1004, which are the commands that initialize the intelligence\ngathering/reconnaissance capabilities of the malware, the server replays the PACKET_HELLO with mode commands in\nthe initial PACKET_HANDSHAKE via a PACKET_COMMAND. The same method of C2 communication was observed\nfor Sepulcher sub-commands, however, the format of observed sub-commands delivered via the “COMMAND_DATA”\nfield varied depending on content of the PACKET_COMMAND. Once a PACKET_COMMAND is received, the result is\nstored in a %TEMP% file on the host. Finally, that result is exfiltrated to the C2 server using the above described\nPACKET_COMMAND method.\n\n\n-----\n\n_Figure 9: Sepulcher C2 PACKET_HELLO delivering malware mode command._\n\n_Figure 10: Sepulcher C2 PACKET_COMMAND to replay initial packet with mode command._\n\n**Conclusion**\n\nThe adoption of COVID-19 lures by Chinese APT groups in espionage campaigns was a growing trend in the threat\nlandscape during the first half of 2020. This was thought to be effective decoy fodder by threat actors as was observed\nin the WHO content that was coopted as part of the TA413 March 2020 campaign targeting European economic\nentities. However, following an initial urgency in intelligence collection around the health of western global economies in\nresponse to the COVID-19 pandemic, a return to normalcy was observed in both the targets and decoy content of\nTA413 campaigns. While the new Sepulcher malware is far from groundbreaking, its combination with timely social\nengineering lures masquerading as critical guidance from the WHO leveraged an urgent global crisis to entice victims.\nThis campaign’s specific focus on European economic, diplomatic, and legislative entities belies a possible momentary\nrealignment for Chinese cyber espionage groups to collect information on global economies cast into upheaval as a\nresult of COVID-19. However, in the case of TA413 that shift may have been short lived. The re-emergence of wellknown Tibetan themed sender addresses and graphically didactic PowerPoint attachments in later July again tie TA413\nto its emblematic targeting of the Tibetan community. Despite the recurring use of publicly disclosed email addresses, a\npedestrian RAT, and the recycling of delivery methods observed over a year ago, the targeting shift between these two\ncampaigns paint a conspicuously contemporary portrait of a rapidly evolving cyber threat landscape in 2020.\n\n**Indicators of Compromise (IOCs)**\n\n\n**IOC** **IOC**\n**Type**\n\n\n**Description**\n\n\n4a4a959aef64ea48e2b831468119180d0af4b5b685c35170f5db3f001b9cc319 SHA256 Credential.dll\n\nSepulcher Malware\n\nMarch 2020\n\nf6f9224c389ee46b28fe04847de4afb1e33ca03763c9e5c41bc61a29eab7f669 SHA256 OSEC234.tmp\n\nSepulcher Malware Dropper\n\nMarch 2020\n\n\n-----\n\ntseringkanyaq@yahoo[.]com Email\nAddress\n\n\nSender Address First\nObserved 2013\n\n\n107.151.194[.]197 IP Command & Control IP\n\nwelfaretibet[.]tk Domain Domain Related by IP\n\nMarch 2020\n\n\nmediabureauin@gmail[.]com Email\nAddress\n\n\nSender Address First\nObserved 2019\n\n\nff301b3295959a3ac5f3d0a5ea0d9f0aedcd8da7c4207b18f4bbb6ddaa0cdf22 SHA256 PowerPoint Attachment\n\nTIBETANS BEING HIT BY\nDEADLY VIRUS THAT\nCARRIES A GUN AND\nSPEAKS CHINESE.ppsx\n\n118.99.13[.]4 IP Malware Delivery IP\n\nhxxp://118.99.13[.]4:1234/qqqzqa URL URL\n\nC2 Communication\n\nhxxp://118.99.13[.]4:8099/file.dll URL URL Delivery Resource\n\nSepulcher Malware\n\ne89614e3b0430d706bef2d1f13b30b43e5c53db9a477e2ff60ef5464e1e9add4 SHA256 File.dll | Credential.dll\n\nSepulcher Malware\n\nJuly 2020\n\nDalailamatrustindia.ddns[.]net Domain Command & Control Domain\n\n115.126.6[.]16 IP Hosting IP\nDalailamatrustindia.ddns[.]net\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-02 - Chinese APT TA413 Resumes Targeting of Tibet Following COVID-19 Themed Economic Espionage Campaign Delivering Sepulcher Malware Targeting Europe.pdf"
    ],
    "report_names": [
        "2020-09-02 - Chinese APT TA413 Resumes Targeting of Tibet Following COVID-19 Themed Economic Espionage Campaign Delivering Sepulcher Malware Targeting Europe.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a651080-cb2f-49bb-87cb-b9c6f6f99ce9",
            "created_at": "2022-10-25T16:07:23.809467Z",
            "updated_at": "2025-03-27T02:02:09.988548Z",
            "deleted_at": null,
            "main_name": "Lucky Cat",
            "aliases": [],
            "source_name": "ETDA:Lucky Cat",
            "tools": [
                "Comfoo",
                "Comfoo RAT",
                "Lucky Cat",
                "LuckyCat",
                "Sojax",
                "Syndicasec",
                "WMI Ghost",
                "Wimmie"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9792e41f-4165-474b-99fa-e74ec332bd87",
            "created_at": "2023-01-06T13:46:38.986789Z",
            "updated_at": "2025-03-27T02:00:02.970288Z",
            "deleted_at": null,
            "main_name": "Lucky Cat",
            "aliases": [
                "White Dev 9",
                "TA413"
            ],
            "source_name": "MISPGALAXY:Lucky Cat",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3b1367ff-99dc-41f0-986f-4a1dcb41bbbf",
            "created_at": "2022-10-25T16:07:24.273478Z",
            "updated_at": "2025-03-27T02:02:10.157226Z",
            "deleted_at": null,
            "main_name": "TA413",
            "aliases": [
                "White Dev 9"
            ],
            "source_name": "ETDA:TA413",
            "tools": [
                "Exile RAT",
                "ExileRAT",
                "Sepulcher"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536255,
    "ts_updated_at": 1743041503,
    "ts_creation_date": 1653759951,
    "ts_modification_date": 1653759951,
    "files": {
        "pdf": "https://archive.orkl.eu/58941938a97c5eb10d67e78059327d1c82e05316.pdf",
        "text": "https://archive.orkl.eu/58941938a97c5eb10d67e78059327d1c82e05316.txt",
        "img": "https://archive.orkl.eu/58941938a97c5eb10d67e78059327d1c82e05316.jpg"
    }
}