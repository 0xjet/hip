{
    "id": "3d22cd8b-bcd7-4559-96c9-a0e30aa0db6f",
    "created_at": "2022-10-25T16:48:22.241542Z",
    "updated_at": "2025-03-27T02:16:26.458611Z",
    "deleted_at": null,
    "sha1_hash": "37c744a782d653d4d2e72e9a979925569dfbd38d",
    "title": "Microsoft Word - eu-20-Clarke-Its-Not-FINished-The-Evolving-Maturity-In-Ransomware-Operations-wp.docx",
    "authors": "",
    "file_creation_date": "2020-11-30T22:11:30Z",
    "file_modification_date": "2020-11-30T22:11:30Z",
    "file_size": 389494,
    "plain_text": "# The Evolving Maturity in  Ransomware Operations\n\n### A Black Hat Europe 2020 Whitepaper\n\n December 2020\n\n Mitchell Clarke and Tom Hall\n\n\n-----\n\n## ABSTRACT\n\nRansom demands are becoming larger, attackers smarter, and intrusions longer. Ransomware threat actors\nare hitting European and global companies hard with more effective ransomware deployment resulting in\ndevastating impacts to victim organisations. When they strike, their ransomware deployments are more\ncomplete, more effective, and they are crippling many organisations to the point where there is often no clear\npath back to business.\n\nThis whitepaper outlines different operating models in use by ransomware threat groups during 2020,\nspecifically ransomware as a service and partnership models. Ransomware as a service involves multiple\nthreat actors that make use of a central shared platform to automate and streamline repetitive processes\nencountered during ransomware operations.\n\nPartnership models involve handover between threat actors, often separating initial intrusion and privilege\nescalation from mass deployment of ransomware extortion of victims. This allows threat actors to specialise in\nspecific stages of an intrusion lifecycle, enabling them to operate with increased efficiency and effectiveness.\n\nThis whitepaper reviews tradecraft that ransomware threat actors have employed across Europe in 2020. This\nincludes how ransomware crews leverage high-profile critical vulnerabilities to gain footholds in multiple\nvictims’ networks and return weeks or even months later to leverage those footholds into full-scale\nransomware deployments.\n\n## INTRODUCTION\n\nThe ransomware industry has continued to evolve during 2020. Ransomware threat actors are increasingly\nconducting full-scale network intrusions similar to those seen in nation-state Advance Persistence Threat\n(APT) or financially motivated criminal intrusions. Full-scale network intrusions allow threat actors to deploy\nransomware across the entirety of victim organisations, often with devastating consequences.\n\nHistorically, ransomware has often been deployed opportunistically or in a non-targeted manner where a\nhandful of systems or small network segments were infected. Several global high-profile, high-impact\nransomware infections in the past, such as WannaCry or NotPetya, were non-targeted events and were selfsustaining with no interaction with attackers after initial malware deployment.\n\nSince the days of WannaCry and NotPetya, the ransomware industry has evolved as threat actors chase\never-increasing ransom pay-outs. Threat actors have matured from opportunistic ransomware deployment to\nbecome co-ordinated professional organisations with a focus on sustained traditional network intrusions in\norder to be best placed to deploy ransomware as widely as possible across victim environments. This\napproach to sustained intrusion and comprehensive ransomware deployment can take days, weeks, or\nmonths.\n\nBy deploying ransomware to the entirety of a victim network, threat actors are applying maximum pressure on\nvictim organisations to pay the demands set by the attackers. Mass ransomware deployments responded to\nby Mandiant are increasingly threatening business continuity and leaving victims with a decision between\npaying ransoms and being unable to continue to trade or operate.\n\nAdditionally, ransomware threat actors are also increasingly stealing victim data and threatening to publicly\nrelease stolen data thereby adding extra pressure to victim organisations.\n\nWith this continued evolution, ransomware attackers have become more effective and increasingly efficient.\nMandiant sees this play out in two different ransomware models:\n\n1. Ransomware as a Service – which features automation and scale. This paper profiles REvil, a threat\n\ngroup made up of individual affiliates using a common ransomware platform.\n\n2. Partnership Models – where threat actors focus on different parts of an intrusion, such as traditional\n\nnetwork compromise, while others focus on ransomware deployment, data theft and extortion. This\npaper profiles QAKBOT and DOPPELPAYMER groups, who perform different stages of the intrusion\nand handoff victims between them.\n\n\n-----\n\n## REVIL AND SODINOKIBI\n\n### Overview\n\nREvil refers to a collection of threat actors who use a common ransomware as a service platform created by a\nthreat actor that goes by the name of UNKN or Unknown. UNKN began advertising for affiliates to join the\nplatform in mid-2019 and since then, many threat actors have joined REvil, gaining access to the automation\nand process benefits that the platform provides.\n\nUNKN advertises that affiliates can retain 60 to 70 percent of ransoms in exchange for use of the platform.\nAffiliates that perform well and obtain large and/or regular ransom payments will receive higher pay-outs while\npoorly performing affiliates will receive less and can potentially be removed from the platform.\n\nThis type of ransomware operation is known as an affiliate model. While each threat actor within the program\ngains access to the SODINOKIBI ransomware used by the group, each affiliate operates independently.\n\nThis leads to REvil intrusions and SODINOKIBI ransomware deployments to vary widely in terms of tradecraft\nand targeting as each threat actor operates in isolation.\n\nREvil tradecraft described in this whitepaper is an amalgamation of multiple individual affiliates.\n\n### Ransomware as a Service Model\n\nRansomware as a service involves use of a central platform which automates and streamlines business\nprocesses that are common to most ransomware intrusions. Threat actors have created these platforms to\nreduce operator-effort required for repetitive and common tasks to increase both scale and pace of operations\nwhile also improving the effectiveness of processes.\n\nREvil's ransomware as a service platform provides affiliate threat actors with the following services:\n\n  - Malware provision and generation, enabling threat actors to generate new and unique malware\nsamples per victim or operation\n\n  - Ransom demands, enabling threat actors to centrally set and manage a ransom amount for the\ntargeted victim organisation\n\n  - Payment information, removing the burden of communicating and managing cryptocurrency wallet\ndetails for each ransom operation\n\n  - Victim communications, allowing the attacker to negotiate the ransom amount and to share stolen\nfiles to prove to victims that threat actors have successfully exfiltrated data from victim networks\n\n  - Cryptocurrency laundering, which reduces the attribution of cryptocurrency profits paid to affiliate\nthreat actors\n\nThe REvil ransomware platform provides automation, efficiency, and increased effectiveness during\nransomware operations.\n\nDevelopment of ransomware as a service platforms can be compared to the scale-out and scale-up of\nlegitimate businesses facing rapid growth opportunities.\n\n### Tradecraft\n\nWhether an intrusion is performed by a nation-state sponsored APT group, a criminal group, or a ransomware\ngroup, threat actors must step through common phases of an intrusion lifecycle, shown in Figure 1, to be able\nto achieve their objectives.\n\n\n-----\n\n_Figure 1: An example targeted attack lifecycle for a full-scale network intrusion_\n\nREvil tradecraft varies between individual threat actors. Broadly, however, REvil threat actors have performed\nAPT-like intrusions during 2020 which are full-scale network intrusions that can span days, weeks, or even\nmonths. REvil threat actors are employing tradecraft similar to that of APT or financial crime groups to gain\nthe highest level of privilege within victim organisations. This privilege, combined with effective organisationwide network reconnaissance and lateral movement, allows REvil attacker to launch devastating SODINOKIBI\nransomware deployments often impacting the entirety of a victim network.\n\nThese prolonged intrusions with APT-like tradecraft can have devastating consequences for victim\norganisations when ransomware is deployed, often leaving them without the ability to perform basic day-today business operations.\n\n#### Initial Compromise\n\nREvil threat actors are leveraging high-profile and high-impact vulnerabilities of internet-facing edge devices\nto mass-exploit many victims simultaneously.\n\nVulnerabilities in edge-devices are attractive for REvil threat actors as they are exposed to the internet by\ndesign and provide a method of initial access to the victim corporate networks.\n\nBy conducting mass-exploitation of vulnerable edge devices, REvil attackers are able to gain access to\nmultiple victim organisations. REvil threat actors then likely triage these accesses to prioritise organisations\nthe actors believe will be more likely to pay ransoms.\n\nDuring 2019, many vulnerabilities were discovered in internet-facing edge devices. REvil exploitation of these\nwell-known vulnerabilities often occurred months after vulnerability disclosure and patch release.\nVulnerabilities exploited in edge-devices by the REvil threat actors include:\n\n  - VPN devices\n\n  - Web services\n\n  - Remote desktop appliances\n\n  - Internet-facing remote desktop services\n\n#### Establish Foothold\n\nDue to the high number of vulnerable devices exposed to the internet, REvil threat actors who conduct massexploitation will often have a backlog of victims to triage and prioritise. Some of these threat actors will\nprogress intrusions from initial access to a surer setting by establishing additional remote access mechanisms\nto victim environments. These methods may include:\n\n  - Use of Cobalt Strike BEACON malware\n\n\n-----\n\n  - VPN abuse\n\n  - Installation of web shells on internet-facing victim web servers\n\n#### Escalate Privileges\n\nAfter establishing a foothold to victim organisations, REvil threat actors will use a multitude of privilege\nescalation techniques in order to gain administrative access to victim environments that are similar to those\nused during APT, financial crime, or red team intrusions. These include but are not limited to:\n\n  - Mimikatz and other password dumping utilities\n\n  - ProcDump to obtain process memory of the Windows Local Security and Authorisation Sub-system\n(LSASS)\n\n  - Passwords for privileged local administrator or domain accounts stored as cpassword objects within\nlegacy group policy preferences\n\n  - Credentials stored within domain shares, for example, hard-coded credentials within corporate\nPowerShell scripts\n\n  - Credentials stored in user profiles, such as text files or Excel spreadsheets\n\n#### Internal Reconnaissance\n\nREvil threat actors are performing comprehensive internal network reconnaissance in an attempt to fully\nunderstand victim networks and maximise the effectiveness of ransomware deployments. REvil threat actors\nare using network scanning and domain enumeration tools to discover:\n\n  - Additional corporate networks\n\n  - Additional Active Directory domains\n\nTools employed by REvil attackers include:\n\n  - Advanced IP Scanner\n\n  - SoftPerfect Network Scanner\n\n  - Bloodhound, an open-source domain enumeration tool\n\n  - Built-in Windows commands to gather Active Directory information\n\n#### Move Laterally\n\nOnce REvil threat actors discover and gain familiarity with victim networks, they will move laterally to network\nsegments and systems of interest using stolen administrative credentials and using multiple tools and\ntechniques, such as:\n\n  - WMIExec (remote execution tool)\n\n  - SMBExec (remote execution tool)\n\n  - CrackMapExec (remote execution tool)\n\n  - PsExec (remote execution tool)\n\n  - RDP (legitimate Microsoft remote desktop service)\n\n\n-----\n\n#### Maintain Presence\n\nIn order to retain access to additional network segments or environments within victim organisations, REvil\nthreat actors will often establish additional persistent backdoors or abuse legitimate remote access solutions\nin preparation for organisation wide SODINOKIBI ransomware deployment.\n\nThis provides the attackers with independent remote access to each targeted network segment.\n\nMethods of persistence vary between individual REvil affiliates, however Mandiant has observed repeated use\nof the following persistence methods:\n\n  - Installation of commercial/freemium internet remote desktop software\n\n  - Cobalt Strike BEACON\n\n  - Web shells installed on internet-facing victim web servers\n\n  - Continued VPN abuse using compromised credentials\n\n  - Continued abuse of remote desktop appliances using compromised credentials\n\n#### Data Theft\n\nPrior to deploying SODINOKIBI ransomware, REvil threat actors will often steal data from victim\norganisations.\n\nData theft is conducted prior to ransomware deployment to increase pressure on victim organisations to pay\nransom demands. The REvil threat actors will threaten to publicly release stolen data, extorting victims and\nincreasing pressure.\n\nMethods of data theft used by REvil include:\n\n  - Compression and exfiltration of targeted data using malware deployed within victim organisations\n\n  - Installation of commercial cloud data synchronisation platform software to upload targeted data. Once\ninstalled, the commercial synchronisation software will upload targeted data to the cloud platform. The\nthreat actors are then able to access victim data via the commercial cloud platform.\n\n#### Ransomware Deployment\n\nAfter gaining administrative access to domains and networks within victim organisations, the REvil attackers\nwill prepare and deploy SODINOKIBI ransomware as widely as possible.\n\nPrior to deploying ransomware, REvil attackers have been observed attempting to increase the likelihood of\nsuccessful SODINOKIBI execution by disabling antivirus software across victim environments, usually by\neither:\n\n  - Accessing central corporate antivirus consoles using administrative credentials to disable antivirus\nacross the entire victim estate\n\n  - Mass-deploying open-source administrative scripts that disable antivirus to individual systems within\nthe victim estate.\n\nAfter disabling antivirus software across victim environments, the most common method of SODINOKIBI\nransomware deployment is the abuse of corporate Group Policy and unrestricted file shares:\n\n1. The attacker will create file shares on victim domain controllers accessible to all users and systems\n\nwithin the targeted domain. The file shares are used to store SODINOKIBI ransomware binaries.\n\n2. The attacker then creates a Group Policy Object in the default domain policy for all computers to\n\ncreate and execute a scheduled task. The scheduled task downloads and executes SODINOKIBI\nransomware binaries from the open file shares created on targeted domain controllers.\n\n\n-----\n\n3. When the computers within the targeted domain next update Group Policy, they create and execute\n\nthe attacker-created scheduled task which in turn downloads and executes the SODINOKIBI\nransomware.\n\nAfter creating malicious group policy to deploy SODINOKIBI ransomware across a targeted domain, the REvil\nattackers will often use remote execution tools to deploy the SODINOKIBI ransomware to systems that have\nnot updated Group Policy objects or have otherwise not been infected with ransomware. This action\nmaximises the number of victim computers ransomed by the attacker and increases the impact to victim\norganisations.\n\nOnce executed, SODINOKIBI will encrypt files on infected computers and create ransom messages that guide\nvictims to the REvil ransomware as a service platform for ransom negotiation and payment.\n\n## QAKBOT AND DOPPELPAYMER\n\n### Partnership Model\n\nDuring 2020, Mandiant responded to DOPPELPAYMER ransomware deployments across Europe and\nglobally where initial access was achieved through widespread use of QAKBOT malware.\n\nIn contrast to REvil’s affiliate model where individual threat actors are responsible for end-to-end intrusions\nfrom initial access to ransomware deployment, QAKBOT and DOPPELPAYMER employ a partnership model\nwhere one threat actor is responsible for initial access, privilege escalation, and lateral movement which is\nthen passed to another threat actor for DOPPELPAYMER ransomware deployment.\n\n### QAKBOT Modules\n\nQAKBOT is often delivered to victims via unsophisticated, yet effective, spear phishing campaigns. QAKBOT\nis a modular backdoor originally used as a banking trojan and has since been leveraged as a precursor to\nDOPPELPAYMER ransomware deployment.\n\nQAKBOT is a modular backdoor that allows for individual capabilities to be deployed to infected systems. Key\nmodules include:\n\n  - **Email Staging Module: A standalone module independent from other QAKBOT modules that steals**\nemail from a local Outlook instance using MAPI connections. Email data is compressed, base 64\nencoded, and sent to a hardcoded command and control server.\n\n  - **Cobalt Strike Module: Loaded using one of two methods:**\n\n`o` By executing a file dropped using the malware\n\n`o` Via a pre-configured DLL as a QAKBOT module\n\n  - **Web Inject Module: Traditional banking trojan functionality that targets JavaScript loaded in Northern**\nAmerican banking organisation websites.\n\nAfter infecting organisations with QAKBOT malware and gaining privilege within targeted environments, threat\nactors will hand access to QAKBOT backdoors to other threat actors using DOPPELPAYMER to mass-deploy\nransomware across victim networks.\n\n### DOPPELPAYMER Deployment and Execution\n\nAfter obtaining access to victim networks using existing QAKBOT infections, threat actors will deploy\nDOPPELPAYMER ransomware using techniques similar to other ransomware operators:\n\n  - PsExec\n\n\n-----\n\n  - Background Intelligent Transfer Service (BITS) Jobs\n\n  - Scheduled Tasks\n\nOnce executed, DOPPELPAYMER ransomware performs the following actions:\n\n  - Enumerate all local users of a system and change the password for each user. This prevents victims\nfrom logging into infected systems. The password is generated by combining a pre-configured string\nwith an MD5 hash of the system name, for example:\n\n`o` Preconfigured string: TtXtE9n3\n\n`o` Computer name hash: 384DFCCEE8DB9F89ED2859E3F32F6AF5\n\n`o` Full password: TtXtE9n3&384DFCCEE8DB9F89ED2859E3F32F6AF5\n\n  - The ransomware will then copy legitimate services and replace them with a copy of itself in order to\nestablish persistence:\n\n`o` **File: <random>.exe**\n\n§ Path: %APPDATA%\\<random>.exe\n\n§ Note: Copy of DOPPELPAYMER binary\n\n`o` **Service: <random_service>**\n\n§ Path: %WINDIR%\\system32\\<random_service>.exe\n\n§ Note: Ransomware Service\n\n`o` **Service: <random_service>-1**\n\n§ Path: %WINDIR%\\system32\\<random_service>.exe-1\n\n§ Note: Backup of Service\n\n  - The ransomware will then modify the boot configuration database of the infected system in order to\ndisable start up repair and to execute the ransomware during safe boot.\n\n  - The ransomware will also modify group policy to display a ransom message prior to logon which\ndirects victims to the threat actor’s TOR website for ransom negotiation and payment.\n\n  - Finally, after rebooting the system, the DOPPELPAYMER ransomware will begin encrypting files on\nthe affected system and will create ransom notes to direct victims to the threat actor’s TOR website.\n\n## CONCLUSION AND OUTLOOK\n\nWith increased impact and visibility, the threat of ransomware has widely become a boardroom issue, now\nplacing highly on corporate risk registers. Enterprise-wide ransomware infections are becoming businesshalting events, with many organisations facing loss of revenue and critical impact to business continuity.\n\nRansomware continues to be a growing problem beyond 2020, both in Europe and globally. During 2020, the\nfollowing key metrics for ransomware intrusions have increased:\n\n  - Ransom amounts\n\n  - Number of victim organisations\n\n  - Damage incurred by increasingly effective organisation-wide ransomware deployments\n\n  - Extortion for stolen data\n\nWith ransom profits assumedly being at an all-time high, ransomware threat actors have continued incentive\nto automate operations, gain additional operators, partners, and/or affiliates, as well as to scale platforms to\nallow attackers to infect more organisations with increasing efficiency and devastation.\n\nIncreased impact to business continuity may increase or better focus information security spending and\nencourage organisations to secure environments and improve security baselines. While this may protect\norganisations from tradecraft currently employed by ransomware threat actors, it is likely that attackers will\nimprove tradecraft in a continuous manner as seen in APT and financial crime threat actors.\n\n\n-----\n\nWhile ransomware intrusions have been highly effective during 2020, organisations can protect themselves\nand prevent these intrusions by focusing information security budgets on improving security programs and\nbaselines including:\n\n  - Vulnerability management programs, ensuring critical vulnerabilities for internet facing infrastructure\nas well as critical internal privilege escalation vulnerabilities are patched as soon as possible\n\n  - Ensuring networks are actively and effectively monitored at scale for intrusions\n\n  - Implementing robust privilege access management solutions\n\n  - Ensuring critical or sensitive data is access controlled and cannot be easily exfiltrated\n\n  - Ensuring that robust backup solutions are in place and regularly tested to ensure that organisations\nare able to rapidly recover during a ransom event\n\n\n-----\n\n**FireEye, Inc.**\n\n601 McCarthy Blvd. Milpitas, CA 95035\n408.321.6300/877.FIREEYE (347.3393)\ninfo@FireEye.com\n\n©2020 FireEye, Inc. All rights reserved. FireEye and\n\n\n**About Mandiant Solutions**\n\nMandiant Solutions brings together the\nworld’s leading threat intelligence and\nfrontline expertise with continuous security\nvalidation to arm organizations with the\ntools needed to increase security\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://i.blackhat.com/eu-20/Wednesday/eu-20-Clarke-Its-Not-FINished-The-Evolving-Maturity-In-Ransomware-Operations-wp.pdf"
    ],
    "report_names": [
        "eu-20-Clarke-Its-Not-FINished-The-Evolving-Maturity-In-Ransomware-Operations-wp.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1606774290,
    "ts_modification_date": 1606774290,
    "files": {
        "pdf": "https://archive.orkl.eu/37c744a782d653d4d2e72e9a979925569dfbd38d.pdf",
        "text": "https://archive.orkl.eu/37c744a782d653d4d2e72e9a979925569dfbd38d.txt",
        "img": "https://archive.orkl.eu/37c744a782d653d4d2e72e9a979925569dfbd38d.jpg"
    }
}