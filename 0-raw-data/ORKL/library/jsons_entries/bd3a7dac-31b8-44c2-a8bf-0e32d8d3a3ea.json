{
    "id": "bd3a7dac-31b8-44c2-a8bf-0e32d8d3a3ea",
    "created_at": "2022-10-25T16:48:24.889757Z",
    "updated_at": "2025-03-27T02:13:04.362779Z",
    "deleted_at": null,
    "sha1_hash": "51bb16ba51be3c144ac9e09a68732cbe0bb785d5",
    "title": "Illuminating The Etumbot Apt Backdoor",
    "authors": "Arbor Networks",
    "file_creation_date": "2014-06-06T22:30:20Z",
    "file_modification_date": "2014-06-06T22:30:20Z",
    "file_size": 3582581,
    "plain_text": "Arbor Threat Intelligence Brief 2014-07\n\n# ASERT Threat Intelligence Brief 2014-07\n\n## Illuminating the Etumbot APT Backdoor\n\n**_ASERT Threat Intelligence, June 2014_**\n\n### Etumbot is a backdoor used in targeted attacks since at least March 2011. Although previous research has covered a related family, IXESHE, little has been discussed regarding Etumbot’s capabilities. ASERT has observed several Etumbot samples using decoy documents involving Taiwanese and Japanese topics of interest, indicating the malware is used in ongoing, targeted campaigns. This report will provide information on the capabilities of Etumbot and associated campaign activity.\n\n## Etumbot Capabilities and Techniques\n\nEtumbot is a backdoor malware that has been associated with a Chinese threat actor group alternatively\nknown as “Numbered Panda”, APT12, DYNCALC/CALC Team, and IXESHE. Targeted campaigns\nattributed to this group include attacks on media, technology companies, and governments.\nIXESHE/Numbered Panda is known for using screen saver files (.scr), a technique repeated with the\nEtumbot malware. [1] A previous campaign using IXESHE malware was highlighted in 2012; the group\nused targeted emails with malicious PDF attachments to compromise East Asian governments,\nTaiwanese electronics manufacturers, and a telecommunications company. The group has reportedly\nbeen active since at least July 2009. [2] Etumbot has also been referred to as Exploz [3] and Specfix.\n\nThe variety of names for this malware could lead to some confusion about the actual threat. ASERT has\nassociated Etumbot with IXESHE, and therefore Numbered Panda, based on similar system and network\nartifacts that are common between the malware families. For example, both malware families have been\nseen using the same ka4281x3.log and kb71271.log files, both families have been observed calling back\nto the same Command & Control servers and have been used to target similar victim populations with\nsimilar attack methodologies.\n\nEtumbot has two primary components. The first is a dropper which contains the backdoor binary (the\nsecond component) and the distraction file. Stage one is likely delivered via spear phish using an archive\nfile extension such as .7z to deliver executable content. Stage one has been seen to leverage the\nUnicode Right to Left Override trick combined with convincing icons for various types of PDFs or\nMicrosoft Office documents to convince the user to click and therefore execute the malware, which then\n\n\n-----\n\nruns the backdoor and displays the distraction file. As with the IXESHE malware, Etumbot has been\nobserved dropping documents of interest to a Taiwanese and Japanese target population.\n\n### Stage 1: Installer/Dropper\n\nTo profile the techniques and capabilities of Etumbot, we will analyze an Etumbot dropper with MD5\nff5a7a610746ab5492cc6ab284138852 and a compile date of March 4, 2014.\n\nWhen executed, the dropper loads up a resource named \"BINARY\" from the resource section then\ncreates the directory C:\\Documents and Settings\\User\\Application Data\\JAVA, then creates a temporary\nfile C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\ka4281x3.log then creates C:\\Documents and\nSettings\\User\\Application Data\\JAVA\\JavaSvc.exe from the aforementioned BINARY resource. This file,\nJavaSvc.exe, is the backdoor component (MD5 82d4850a02375a7447d2d0381b642a72). JavaSvc.exe is\nexecuted with CreateProcessInternalW. The backdoor component of the malware (named here as\nJavaSvc.exe) is now running. It is interesting to note that versions of the IXESHE malware also used\nJavaSvc.exe as a filename.\n\nMost Etumbot samples observed by ASERT drop decoy documents (PDFs, Word Documents, and Excel\nSpreadsheets) written in Traditional Chinese and usually pertaining to Cross-Strait or Taiwanese\nGovernment interests. Several decoy files contain details on upcoming conferences in Taiwan.\n\n**Spear Phishing**\n\nEtumbot appears to be sent to targets via spear phishing emails as an archive; ASERT has observed .7z\nand .rar formats being used to presumably deliver the Etumbot installer. The archive filename will have a\ntopic most likely of interest to the victim.\n\nAt least one identified malware sample (75193fc10145931ec0788d7c88fc8832, compiled in March 2014)\nuses a password-protected .7z to deliver the Etumbot installer. It is most likely that the spear phish email\ncontained the password.\n\nWith the correct password, the victim has access to the dropper inside the archive. This archive most\nlikely included the installer d444be30d2773b23de38ead1f2c6d117, as the filenames match (1030522 新\n\n\n-----\n\n機關籌備小組清單.7z and 1030522 新機關籌備小組清單 rcs.DOC). 1030522 is a date (May 22, 2014)\nfrom the Minguo calendar, which is unique to Taiwan. The calendar is based on the establishment of the\nRepublic of China in 1911. 2014 is therefore the “103[rd]” year of the ROC. The installer is a .scr binary\nposing as a Word Document. This dropper drops a decoy document and the backdoor, named\nsysupdate.exe in this instance.\n\n**Right-to-Left Override**\n\nAfter the files are extracted from the archive, the filenames of Etumbot installers make use\nof the right-to-left override (RTLO) trick in an attempt to trick users into clicking on the\ninstaller. The RTLO technique is a simple way for malware writers to disguise names of\nmalicious files. A hidden Unicode character in the filename will reverse the order of the\ncharacters that follow it, so that a .scr binary file appears to be a .xls document, for\nexample. Threat actors using this trick have been well documented since at least 2009. [45] One way to avoid this trick in Windows is to set the “Change your view” level to “Content”.\n\n[6]\n\nBelow are some of the names of Etumbot installers using RTLO successfully:\n\n**File name** **Md5**\n\n招標規範 Finarcs.doc b3830791b0a397bea2ad943d151f856b\n1030522 新機關籌備小組清單 rcs.DOC d444be30d2773b23de38ead1f2c6d117\n報價單 Finarcs.xls 5340fcfb3d2fa263c280e9659d13ba93\n10342 委會-­‐審�金融法規修正草案報告 rcs.xls beb16ac99642f5c9382686fd8ee73e00\n國發會 1030324 第 1 次委員會重要議題通報 finalrcs.xls 4c703a8cfeded7f889872a86fb7c70cf\nAPO EPIF 邀請函 rcs.xls 1ce47f76fca26b94b0b1d74610a734a4\n\n### Stage 2: Persistence, Distraction, HTTP Beacon and Crypto Functionality\n\nAs the backdoor executes from our previous example, C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\\nkb71271.log is created and contains the following registry file to make the malware persistent:\n\n[HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run] \"JavaSvc\"=\"C:\\\\Documents\nand Settings\\\\User\\\\Application Data\\\\JAVA\\\\JavaSvc.exe\"\n\nThe dropper then calls regedit with kb71271.log as a parameter to modify the registry. kb71271.log is\nthen deleted. These temp files appear to be static and used across multiple samples of Etumbot and\nIXESHE. Various other samples were found using this same naming scheme.\n\nNext, C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\ka4281x3.log is created, filled with contents of the\nbait/distraction file, and then copied to C:\\DOCUME~1\\User\\LOCALS~1\\Temp\\~t3fcj1.doc, which is then\nopened. If Word isn't installed, then notepad will open the file instead. The ka4281x3.log file is then\ndeleted.\n\nReturning to the first sample, once the dropper (ff5a7a610746ab5492cc6ab284138852) installs the\nEtumbot backdoor (82d4850a02375a7447d2d0381b642a72), an initial HTTP beacon is sent to the\nCommand & Control server that requests an RC4 encryption key. The beacon takes the form of a GET\nrequest to /home/index.asp?typeid=N where N is a randomly selected odd number between 1 and 13. If\nthe C&C is online, the decoded response payload will contain the RC4 key that is used to encrypt\nsubsequent communication.\n\nIf the C&C does not send a valid response, the bot will re-send the initial request every 45 seconds.\n\n|File name|Md5|\n|---|---|\n|招標規範Finarcs.doc|b3830791b0a397bea2ad943d151f856b|\n|1030522 新機關籌備小組清單rcs.DOC|d444be30d2773b23de38ead1f2c6d117|\n|報價單Finarcs.xls|5340fcfb3d2fa263c280e9659d13ba93|\n|10342 委會-­‐審�金融法規修正草案報告rcs.xls|beb16ac99642f5c9382686fd8ee73e00|\n|國發會1030324 第1 次委員會重要議題通報finalrcs.xls|4c703a8cfeded7f889872a86fb7c70cf|\n|APO EPIF 邀請函rcs.xls|1ce47f76fca26b94b0b1d74610a734a4|\n\n\n-----\n\nWhile the user-agent may appear to be legitimate, it only occurred 39 times in a corpus of over 61 million\nHTTP requests. Due to the possibility of this User-Agent appearing in legitimate traffic, other indicators –\nsuch as the additional fake Referer value of http://www.google.com should be present before compromise\nis assumed. All of the headers in the HTTP request are hard-coded in both order and value, so they may\nbe used to provide additional indicators of compromise.\n\nIf the C&C is online and responds to the beacon, then the RC4 key is delivered to the bot in a string of\nbase64 encoded characters. Etumbot uses a url-safe base64 alphabet, i.e., any characters that would\nrequire URL-encoding are replaced. Usage of base64 is a technique consistent with previous analysis\ndone on IXESHE malware. [2,7] In the case of Base64, the “/” and “=” characters are replaced with “_”\nand “-“ respectively. The payload from the C&C contains an 8-byte command code in little-endian format,\nfollowed by a null-terminated string argument if the command requires it. In the case of the initial beacon\nresponse, the RC4 key is located after the command code and has been observed to be e65wb24n5 for\nall live C&C’s that ASERT has analyzed.\n\nAn example of this initial beacon and delivery of RC4 key is as follows.\n\n\n-----\n\nThe RC4 key can be obtained from the C&C response with the following python:\n\nimport base64\nc2_response=\"\"\"AQAAAAAAAABlNjV3YjI0bjUAAAAAAAAAAAAAAG5FAVBvIz8hYk08ITI4BA0lMTBvBRx0NB18\nBndMcFMKQhR5PxxkQ3VnFEALeXA6C3RPBmJLHBBccHQINEl9I3kMUk0lOT4wCFgqD3khTjl5IEAqGzU_DmtU\neEJBYSQHEiwRADteMEFjTw5oXgtjGkUxL14JPlwyYQQXPkVaQiAyUBEaJWlkOQEmZRoXZ10EN3RndH0kbEEre\nw0NUklhFRlpNDJofS1hPQMCeWUvHSQPA2ZAPHEcCRkLPURbCC8bdTgIXXcIBhBbVlhjdB8iL2Y_TCNldTNjZkE\nvB0M5BWtaOkBALj4KIA5UBjhVPxhhSk1fAwdKKi8zdhl6TkthRUZAOQdICRgFEgY0dwpQNjtlQgR8DzM9N3NQ\nBhteHgdwaVtycDZvS1Q3CTYhARI1GBMrWh1FQxcdQhV7MSx+NQxqFHgVKHRAdBIBIzNFP14gLHErBAYeWH\n1jGCMAdlx5MWAuFk5TW3M+UxFMclIsclEAbzgzB2NSOX0iYBBucmthDyYaZR8tBBMbJjMoCXleMkM+YjdfCHc\nxIUBHbic+RiEeNwAvWD40W2p0diUyCTJHFEU+KRc+ZFVJTA0zHgxwAiJva306KXkIL3ZnRwAIKCh4M3sgFgZ\nZGU9lFXg4ancZFSAlNl1RaRQ8b3drCWofbWB+fkIyKEJ8AnJlaUAxEglWZSM+TWFEAE4aCnFpe1JpB1xTBSgfE\nUwVUh1UDE5UVC1qanIcXXlfcmRzdWkPK2doDlBhVmx4dm8zUkFgMWJHdRhzRSdrKwk_KWAadyAqMEg2MlE\nYNVl9Wl84bQtVcRYpFHAXGg8kQiI6E1xiBApHV3ZDLBY+G2sADmJXUC9OCixmBEYUNGBXATh0QVxUNTwyQ\nnhbXRxNTHlCEAlYBXhyTWdyQRcNBxskBRlRBn42HlhNbEtnJCk4QkIoDzRbEChGLi10ERpgZTpNNCJjKEUNOhh\nlcRR1Dkw+ITMAYAleCDQdTVpTHGQbXwktTmROQiooaEtLLHcILTo4an08I1p9H2IPeBseLiUScQp3Xg-\"\"\".replace('_','/').replace('-','=')\nc2_response=base64.b64decode(c2_response)\nrc4_key = c2_response[8:8+c2_response[8:].find('\\x00')]\nprint rc4_key\ne65wb24n5\n\nWhile a payload of 1080 bytes is sent back, the majority appears to be random padding.\n\nOnce the bot has received the encryption key, the bot sends a registration callback to the C&C\n/image/<encrypted data>.jpg containing the encrypted values of system information to include the\nNetBIOS name of the system, user name, IP address, if the system is using a proxy (Yes/No), and a\nnumeric value which may be some type of campaign code. IXESHE malware has also been observed\nusing a unique campaign code that is delivered back to the C&C. [7]\n\n\n-----\n\nEtumbot discovers the proxy settings of the local machine. If a proxy is defined, communications to the\nC&C bypass the proxy and go directly to the Internet. Environments with system-defined proxies won’t get\nthis activity in proxy logs, however transparent proxies may see this activity.\n\nA contrived example of this registration string generated by the Etumbot backdoor prior to encryption is as\nfollows:\n\nWINXPBOX|johnsmith|10.0.1.15|No Proxy|05147|\n\nA bot registration call to /image\n\nOnce the bot has registered with the C&C, it will send periodic pings to ask for new commands to\nexecute. The URI for the ping requests is /history/<encrypted NetBIOS name>.asp, where encrypted\nNetBIOS name is the url-safe base64 encoding of the rc4-encrypted NetBIOS name.\n\n\n-----\n\n**Etumbot Command Structure**\n\nThe first eight bytes of C&C responses to the bot include the command, and the second eight bytes\ncontain an ASCII string that is parsed. In the event of a file download, file upload, or command execution,\nthe second eight bytes contain the filename or command to be executed. The parsing function inside the\nbinary reveals at least five commands:\n\n**Etumbot \r function** **Command \r name** **Internal \r code**\n\nExecute \r arbitrary \r command ETUM_CMD_EXEC 3\n\nDownload \r file \r from \r C&C ETUM_CMD_PUTFILE 4\n\nUpload \r file \r from \r bot \r to \r C&C ETUM_CMD_READFILE 5\n\nPause \r execution ETUM_CMD_SLEEP 7\n\nDelete \r backdoor \r binary \r and ETUM_CMD_UNINSTALL 8\nterminate \r program\n\nPing \r the \r C&C ETUM_CMD_PING 9\n\nETUM_CMD_EXEC provides the capability for the attacker to run any command on the compromised\nhosts. Both stdout and stderr from the command are redirected to a pipe and are then relayed back to the\nC&C using a separate thread that spawned during initialization. In the event of a process creation or hang\nerror, an HTTP transaction to /tech/s.asp/m=<message> is sent to the C&C, where <message> contains\n\n|Etumbot function|Command name|Internal code|\n|---|---|---|\n|Execute arbitrary command|ETUM_CMD_EXEC|3|\n|Download file from C&C|ETUM_CMD_PUTFILE|4|\n|Upload file from bot to C&C|ETUM_CMD_READFILE|5|\n|Pause execution|ETUM_CMD_SLEEP|7|\n|Delete backdoor binary and terminate program|ETUM_CMD_UNINSTALL|8|\n|Ping the C&C|ETUM_CMD_PING|9|\n\n\n-----\n\na create process error statement “CreateProcess Error: %d” or a message that states “Process Do not\nexit in 10 second, so i Kill it!”. Some samples of droppers have been observed using the string “Process\nDo not cunzai in 10 second, so i Kill it!”. The word \"cunzai” is likely the pinyin (romanization) for the\nMandarin word 'exist'.\n\nETUM_CMD_PUTFILE provides the capability for files to be placed on local system from the C&C. The\nfile upload is accomplished by sending a request to /docs/name=<data> and the C&C is expected to\nrespond with the full contents of the file as the response payload.\n\nA success or failure status message is relayed via a call to /tech/s.asp?m=<encrypted status message>\nwith various reasons for failure potentially being relayed.\n\nETUM_CMD_READFILE allows any file from the compromised system to be uploaded to the C&C. When\na READFILE command is received from the C&C, the bot makes an initial call to\n/manage/asp/item.asp?id=<encrypted computer name>&&mux=<encrypted total file size> and checks for\nthe presence of “I’m Ready” in the response from the C&C. Data from the file is read in 2000 byte chunks,\nRC4 encrypted and then url-safe base64 encoded. The data is sent back to the C&C via the URI\n/article/30441/Review.asp?id=<encoded computer name>&&date=<file chunk data>. The bot expects a\nmessage of “OK” from the C&C after each response is sent and will terminate the upload and send an\nerror message to the C&C in the case it is not seen. A success or failure message is sent via the\n/tech/s.asp?m=<encrypted status message> to complete or terminate the upload.\n\nETUM_CMD_SLEEP puts the bot into a dormant state for a period of time. When a bot receives the sleep\ncommand, it will relay the message, “I will sleep %d minutes!” via a call to /tech/s.asp?m=<encrypted\nmessage>.\n\nETUM_CMD_UNINSTALL deletes the binary and terminates the process with no additional\ncommunication to the C&C.\n\n### Use of Byte Strings Technique (aka “String Stacking”)\n\nEtumbot uses a technique to load strings into memory that has been called “byte strings” and also “string\nstacking” whereby character values are loaded into a specific memory location one byte at a time.\nAssuming the string values do not change frequently, these byte strings can make for meaningful\ndetection capabilities, such as discovering an unusual combination of characters (to include typos, unique\nor odd syntax) being loaded into memory that creates a unique fingerprint for the malware activity that\ncan be used as part of a yara rule or other detection mechanism. The byte string technique has been\nobserved in various Chinese APT malware, including Gh0st RAT, IXESHE malware, Etumbot and others.\n\nASERT has provided an IDApython script that will provide for cleaner analysis of such strings as well as a\ncorresponding blog entry that describes the obfuscation technique and code. [8-9]\n\nThe output of running find_byte_strings.py on an Etumbot backdoor shows the string “I’m Ready” which is\ninvolved in file transfer routines. The first screenshot shows the default hex byte values that are MOVed\ninto offsets from EBP, and the second screenshot shows those same characters after translation to string\nvalues.\n\n\n-----\n\n-----\n\nTwo additional screenshots provide insight into all of the strings discovered.\n\nThe byte string technique has also been observed in other malware, so its presence alone does not\nspecifically indicate the activities of Chinese threat actors.\n\nAn interesting artifact occasionally observed during analysis is the presence of a numeric value just after\nan IP address used as a C&C. The placement of this number after a colon suggests the use of a port\nvalue, however such a port value is too high to be valid. An example of this taken from an Etumbot\nsample performing an initial beacon is as follows:\n\n\n-----\n\n**Etumbot Backdoor Related File System Artifacts of Interest**\n\n|Filename|Purpose|Notes|\n|---|---|---|\n|ka4281x3.log|Temporary file for data exchange from C&C|Observed in various IXESHE malware variants as well as Etumbot. File is stored in C:\\Windows\\system32\\, \\Documents and Settings\\<username> or elsewhere|\n|ka4a8213.log|Temporary file for data exchange from C&C|Similar in format to the prior filename, this has only been observed in Etumbot samples.|\n|kb71271.log|Temporary file for data exchange from C&C, to include registry file|Observed in various IXESHE malware variants as well as Etumbot|\n|~DA5E74.doc ~DS5D64.doc ~t3fcjl.doc ~g4h710.doc ~gh4710.pdf ~trfai3.doc ~tresd2.xls ~taste3.doc ~tasyd3.xls ~tkfad1.xls|Distraction documents|Contains a variety of document content, often obtained from other sources that will be of interest to the target|\n|ntprint.exe conime.exe JavaSvc.exe serverupdate.exe wscnsvr.exe spoolvs.exe winlogdate.exe|Backdoor binary|The Etumbot backdoor binary itself which is added to the registry for persistent execution|\n|tst1.tmp tst2.tmp tst3.tmp||Observed in IXESHE malware and Etumbot samples as well as in other malware. The file tst3.tmp is more popular than the other two file names and is used in a wider variety of malware|\n|Locations JAVA|Directory created|Created in \\Documents and Settings\\<username>\\Application Data\\ and also in root of C:\\ directory|\n\n\n-----\n\n**Etumbot Command and Control Indicators**\n\nMost instances of Etumbot that were analyzed connect directly to an IP address with the IP address\nhardcoded in the binary. These C&C’s were obtained from analyzing malware samples compiled over a\nperiod of several years.\n\n**IP \r Address** **Domain \r Name** **Country**\n\nA number of these C&C IP addresses are also used by\n\n200.27.173.58 CL IXESHE-related malware, which seems to indicate that\n\nEtumbot is often used in tandem with IXESHE. The\n\n200.42.69.140 AR\n\ndomain finance[.]yesplusno[.]com and IP address\n\n92.54.232.142 GE 211[.]53.164.152 was also used by a variety of\n\n133.87.242.63[1] JP IXESHE samples, for instance. The registrant for the\n\ndomain yesplusno[.]com is listed as “alice yoker” with\n\n98.188.111.244 intro.sunnyschool.com.tw US\n\nthe email address “chuni_fan@sina.com”. Other\n\n143.89.145.156[2] HK domains registered in this name have also been used\n\n198.209.212.82[3] US as C&C for IXESHE:\n\n143.89.47.132[2] HK securezone[.]yesplusno[.]com [10]\n\n196.1.99.15[4] wwap.publiclol.com SN prishmobile[.]googlesale[.]net\n\nyahoopush[.]googlesale[.]net\n\n59.0.249.11 KR\n\n190.16.246.129 AR The IP address 98.188.111.244 has also been used as\n\na C&C for multiple IXESHE samples, beginning in at\n\n211.53.164.152 finance.yesplusno.com KR\n\nleast March 2013 and observed as recently as March\n2014 with an Etumbot sample. This is the IP address for what appears to be a legitimate website for a\nschool in Taiwan: intro.sunnyschool.com.tw. Note that if HTran or other connection bouncer is used, the\nC&C may be a legitimate site that was simply compromised and used to direct traffic elsewhere.\n\n**Miscellaneous Network Artifacts: Use of Htran Connection Bouncer**\n\nIndicators suggest that HTran, a connection bouncer, is being used in some cases such as on the C&C\ncontacted by malware sample MD5: 1ce47f76fca26b94b0b1d74610a734a4 (compilation date March 12,\n2014). The presence of HTran is based on the following response string\n\n[SERVER]connection to ss:dd error\n\n1 IP address allocated to Hokkaido University\n\n22 IPs allocated to Hong Kong University of Science and Technology IPs allocated to Hong Kong University of Science and Technology\n\n3 IP allocated to the University of Missouri\n\n|IP Address|Domain Name|Country|\n|---|---|---|\n|200.27.173.58||CL|\n|200.42.69.140||AR|\n|92.54.232.142||GE|\n|133.87.242.631||JP|\n|98.188.111.244|intro.sunnyschool.com.tw|US|\n|143.89.145.1562||HK|\n|198.209.212.823||US|\n|143.89.47.1322||HK|\n|196.1.99.154|wwap.publiclol.com|SN|\n|59.0.249.11||KR|\n|190.16.246.129||AR|\n|211.53.164.152|finance.yesplusno.com|KR|\n\n\n4 IP allocated to the University Saint-Louis of Senegal\n\n\n-----\n\nHTran is also called \"HUC Packet Transmit Tool\", developed by a member of the Honker Union of China,\na hacker group; the source code for the program is available online. [11] HTran is designed to redirect\nTCP traffic intended for one host to another, and has been used by IXESHE malware previously. [2]\n\nResearchers at SecureWorks determined some years back that HTran would deliver the IP address of\nthe final destination server if the final server were down or unreachable. The code in use here has been\nmodified to not reveal such information. Organizations properly positioned with netflow or other traffic\nanalysis capabilities may be able to locate upstream servers from HTran nodes that operate as the initial\ntier of C&C.\n\nHtran activity can be detected with the following signature:\n\nET CURRENT_EVENTS HTran/SensLiceld.A response to infected host\n\nThe import hash for the sample observed connecting to an Htran bouncer is\na9059c354e5025dfe4f1c0b8b57e4f62 which links to other Etumbot samples compiled with Microsoft\nVisual C++ 5.0 in a similar March 2014 timeframe:\n\n  - 4c703a8cfeded7f889872a86fb7c70cf  2014-03-24\n\n  - ff5a7a610746ab5492cc6ab284138852 2014-03-04\n\n## Etumbot Campaign Timeline\n\nThe following samples have been identified by ASERT as Etumbot malware. The first identified sample\nhas a compilation date of March 2011, while the most recent was compiled in May 2014. Many\ndroppers/installers contain Etumbot or, alternatively, IXESHE-related backdoors.\n\nMost of the documents dropped with Etumbot are written in traditional Chinese. Traditional Chinese\n(versus simplified Chinese used in mainland China) is most widely used in Taiwan. While other areas do\nmake use of traditional Chinese (Hong Kong, Macau), the topics of the decoy documents strongly\nsuggest that Taiwanese entities are the targets for many Etumbot samples.\n\nA recent increase in Etumbot samples with configuration dates of 2014 seems to indicate that the\nNumbered Panda/IXESHE group has increased activity lately or has begun using Etumbot more widely in\ntargeted campaigns.\n\n### 2011\n\n**ac22aa007081caeb8970aefba7eddfcf**\n**Compilation Date: 2011-03-09 14:10:34**\n**C&C: N/A**\n**Filename: Help statement from western U.S ?cod.scr**\n**Archive: HelpXstatementXfromXwesternXU.SX.rar (c2d667b8072aa2eaa670d4459dd7c90d)**\n**Dropped Files: ~$workp.doc (7ec4ece7358f9f67a4d583777dc1fb59), ka4281x3.log, kb71271.log, WINCHAT.EXE**\n(70424b91dc905e4ca5e4aeb1c62ed91f)\n\n\n-----\n\n**~$workp.doc: News article on recent Chilean earthquake (English)**\n\n**cd33c5467d425f662f57672531701d89**\n**Compilation Date: 2011-03-14 02:49:22**\n**C&C: N/A**\n**Filename: N/A**\n**Dropped Files: ~$workp.doc (731f288ebd8ff05b3a32377d9d7f4751),** WINCHAT.exe\n(e62453f41af9d87b4f6d4e8223926024)\n\n**~$workp.doc: Notice from TEPCO (Tokyo Electric Power Company) dated March 14 about**\n\n**emergency shortage and blackouts. (Japanese)**\n\n**04908c6853cb5c9d7dccaf15fb5fd3bb**\n**Compilation Date: 2011-03-24 03:24:42**\n**C&C: 32.114.251.129 (US), 217.119.240.118 (RS), 202.106.195.30 (CN) larry[.]yumiya[.]com**\n\n\n-----\n\n**Filename: N/A**\n**Dropped Files: ~$workp.doc (4d47f52c675db16ab1e1df5ac050d3b8), ka4281x3.log, kb71271.log,** WINCHAT.exe\n(47ee9a497a12272b50bb5e197935f13f)\n\n**~$workp.doc: “Investigation Results” of several cases/laws involving the Ministry of National**\n\n**Defence (Traditional Chinese)**\n\n### 2012\n\n**232b659e28c5e06ad5466c01aec35cb6**\n**Compilation Date: 2012-09-19 08:53:14**\n**C&C: 200.27.173.58 (CL)**\n**Filename: N/A**\n**Dropped Files: ka3157j.log, W3svc.exe (1e838fd06bcc64c54e75c527df164d91)**\n\n**7a698acebcf19b55170f05388a2f7fe0**\n**Compilation Date: 2012-10-12 01:21:11**\n**C&C: N/A**\n**Filename: N/A**\n**Dropped Files: ka3158jl.log, iexplore.exe (ac7f77cc55c964e400b8926f21bed7d2)**\n\n**1e8fba674761371cb9e88962dcb851c0**\n**Compilation Date: 2012-11-20 00:11:02**\n**C&C: 211.53.164.152 (KR), finance[.]yesplusno[.]com**\n**Filename: N/A**\n**Dropped Files: ~PG7953.doc (adc0ffd684d9a986d65cb4efba39c3fe), ka3157jl.log, kb71271.log, iexplore.exe**\n(37648553f4ee6c5cb712cca446340a9a)\n\n\n-----\n\n**~PG7953.doc: “qqqqqq”**\n\n**88653dde22f723934ea9806e76a1f546**\n**Compilation Date: 2012-12-05 01:30:07**\n**C&C: 190.193.44.138 (AR), cht[.]strangled[.]net**\n**Filename: N/A**\n**Dropped Files: N/A (this sample is a dropped backdoor)**\n\n**2b3a8734a57604e98e6c996f94776086**\n**Compilation Date: 2012-12-05 02:13:27**\n**C&C: 92.54.232.142 (GE)**\n**Filename: 補捐助案件結餘款處理調查表.doc .exe**\n**Dropped Files: ~DS5D64.doc (2454c4af0b839eb993dd1cbb92b2c10d), ka4281x3.log, conime.exe**\n(3214bf22eb28e494b8e23d8ffc5ac4a9)\n\n**~DS5D64.doc: Form pertaining to unspecified investigation/case (Traditional Chinese)**\n\n\n-----\n\n**1498c9761fc819d496171c71604c2128**\n**Compilation Date: 2012-12-11 02:26:18**\n**C&C: N/A**\n**Filename: 部會文宣聯繫名單** cod.scr\n**Dropped Files: ~DS5D64.doc (e8b92d20a9c4718b4f90d27cd8cba4b3), conime.exe**\n(0bfb9f2080aeee22d3b4ca6fbfd25980)\n\n**~DS5D64.doc: Application to apply as a member of the “Taiwan National Alliance” (Traditional Chinese)**\n\n**063b6076c69ce3ba4f116d1ad51da2b5**\n**Compilation Date: 2012-12-12 01:26:54**\n**C&C: N/A**\n**Filename: N/A**\n**Dropped Files: ~PG7953.doc (c4af36f64d515569816263ca48f61899), ka3157jl.log, iexplore.exe**\n(5b15664fb744c3f3cf7ec7b5515d2be5)\n\n**~PG7953.doc: Foreign Ministry: Security Operation Center Plan (Traditional Chinese)**\n\n\n-----\n\n### 2013\n\n**ca838b98ca0f516858a8a523dcd1338d**\n**Compilation Date: 2013-07-25 07:48:29**\n**C&C: 143.89.145.156 (HK)**\n**Filename: N/A**\n**Dropped Files: ~g4h710.doc (729353afd095ca07940490dbb786ee33), ka4281x3.log, kb71271.log, JavaSvc.exe**\n(36b42162c818cf6c2fb22937012af290)\n\n**~g4h710.doc: “The 2013 Turning Point: Blazing a Trail for Taiwan's Economy” Conference at the Taipei**\n\n**International Convention Center 2013-07-30 (Traditional Chinese)**\n\n**986937eb4052562cdd3960dd8fffc481**\n**Compilation Date: 2013-07-30 08:22:06**\n**C&C: 200.42.69.140 (AR)**\n**Filename: N/A**\n**Dropped Files: ~g4h710.pdf (7cd7db8ff8071d590567c68ea0219f23), ka4281x3.log, kb71271.log, JavaSvc.exe**\n(ee8ba3bef6a607af79405e75fb0f0d6f)\n\n\n-----\n\n**~g4h710.pdf: the Industrial Technology Research Institute (Taiwan), 2013 Cross Strait Communication**\n\n**Industry Cooperation and Exchange Meeting (2013-07-15) (Traditional Chinese)**\n\n**5ef508d0ca7759ecf602192521fff287**\n**Compilation Date: 2013-08-01 00:47:08**\n**C&C: 200.42.69.140 (AR)**\n**Filename: N/A**\n**Dropped Files: ~t4hhk0.pdf (6b7cbcabd963ee4823dd2cd9daa5fcc7), ka4281x3.log, kb71271.log, JavaSvc.exe**\n(ee8ba3bef6a607af79405e75fb0f0d6f)\n\n**~t4hhk0.pdf: Cross Straits Strategic Emerging Industry Cooperation and Development Forum (2013-08-14)**\n\n**(Traditional Chinese)**\n\n\n-----\n\n### 2014\n\n**ff5a7a610746ab5492cc6ab284138852**\n**Compilation Date: 2014-03-04 00:19:59**\n**C&C: 98.188.111.244 (US)**\n**Filename: WTO^X[ͧ ]Piii20140303 _slx.scr**\n**Dropped Files: ~t3fcj1.doc (361a6752766c154c6e31a4d9cc3a3fdc), kb71271.log, ka4281x3.log, JavaSvc.exe**\n(82d4850a02375a7447d2d0381b642a72)\n\n**~t3fcj1.doc**\n\n**1ce47f76fca26b94b0b1d74610a734a4**\n**Compilation Date: 2014-03-12 01:38:44**\n**C&C: 133.87.242.63 (JP)**\n**Filename: APO EPIF 邀請函** rcs.xls\n**Dropped Files: ~tresd2.xls (2e073d35934bb3920fe9907ccb7bc5f8), ka4281x3.log, kb71271.log, wscnsvr.exe**\n(deeec10be746ecf9bf46a30bf58bc784)\n\n\n-----\n\n**~tresd2.xls: International Green Fair (EPIF), held in Taiwan March 13-16, 2014 (Traditional Chinese)**\n\n**4c703a8cfeded7f889872a86fb7c70cf**\n**Compilation Date: 2014-03-24 00:53:57**\n**C&C: 133.87.242.63 (JP)**\n**Filename: 國發會** 1030324 第 1 次委員會重要議題通報 finalrcs.xls\n**Archive: .rar (9b42968e9a7646feb7db318713271718)**\n**Dropped Files: ~t3fcj1.xls (18dc518810892d89430a1efe2c71797e), ka4a8213.log, kb71271.log, serverupdate.exe**\n(fed7ce0d20e78b5814475d8f9d062c80)\n\n**~t3fcj1.xls: Filename (Traditional Chinese) pertains to a Taiwan National Development Council meeting,**\n\n**document is unreadable**\n\n\n-----\n\n**beb16ac99642f5c9382686fd8ee73e00**\n**Compilation Date: 2014-03-31 07:34:00**\n**C&C: 143.89.47.132 (HK)**\n**Filename: 10342 委會-審查金融法規修正草案報告** rcs.xls\n**Dropped Files: ~tkfad1.xls (eef5f9b46676b31a791216b42360c8bb), ka4a8213.log, kb71271.log, Googleupdate.exe**\n(e7d960060d602deb53c7d49d2002c4a4)\n\n**~tkfad1.xls: Filename (Traditional Chinese) pertains to April 2 meeting of unnamed Commission about**\n\n**financial regulation amendments. Document format is unreadable**\n\n**5340fcfb3d2fa263c280e9659d13ba93**\n**Compilation Date: 2014-04-23 01:23:41**\n**C&C: 196.1.99.15 (SN), wwap[.]publiclol[.]com**\n**Filename: 報價單** Finarcs.xls\n**Dropped Files: ~tasyd3.xls (c5118ba47b7aa12d6524f648f1623cc1), ka4a8213.log, kb71271.log, winlogdate.exe**\n(ba4f88fe44d02a299dbeab18c37f74f3)\n\n**~tasyd3.xls: Filename “price list” (Traditional Chinese). Document format is unreadable.**\n\n\n-----\n\n**a6b4b679a51627ce279d5107c20dd078**\n**Compilation Date: 2014-04-29 03:44:19**\n**C&C: 59.0.249.11 (KR)**\n**Filename: spoolv.exe**\n**Dropped Files: N/A (this sample is a dropped backdoor)**\n\n**d444be30d2773b23de38ead1f2c6d117**\n**Compilation Date: 2014-05-14 13:34:46**\n**C&C: 198.209.212.82 (US)**\n**Filename: 1030522 新機關籌備小組清單** rcs.DOC\n**Archive: 1030522 新機關籌備小組清單.7z (75193fc10145931ec0788d7c88fc8832)**\n**Dropped Files: ~trfai3.doc (196ae8d6a5d19737ae6975d047ab1d59),** ka4a8213.log, kb71271.log, sysupdate.exe\n(86ef188537f5e4637df24336c9b21cb0)\n\n**~trfai3.doc: List of Convener, Deputy Convener, and Executive Secretary names for various government**\n\n**departments (Traditional Chinese)**\n\n**b3830791b0a397bea2ad943d151f856b**\n**Compilation Date: 2014-05-14 08:16:41**\n**C&C: 198.209.212.82 (US)**\n**Filename: 招標規範** Finarcs.doc\n**Archive: 招標規範.rar (8629b95f9e0898793e0881a8f79ee0cf)**\n**Dropped Files: ~taste3.doc (aeaf1e78c2082644b122bf32803acb1f), ka4a8213.log, kb71271.log, spoolvs.exe**\n(5eba8ced8656da865f91d5fc87e8dc74)\n\n\n-----\n\n**~taste3.doc: Sun Yat-Sen University (Taiwan) purchase list, items include Cisco3045E/K9 or equivalent**\n\n**(Traditional Chinese)**\n\n### List of Identified Etumbot MD5s\n\n\nca838b98ca0f516858a8a523dcd1338d\n986937eb4052562cdd3960dd8fffc481\n5ef508d0ca7759ecf602192521fff287\nd08c54ed480c9cd8b35eab2f278e7a28\n82d4850a02375a7447d2d0381b642a72\n4c703a8cfeded7f889872a86fb7c70cf\n063b6076c69ce3ba4f116d1ad51da2b5\n232b659e28c5e06ad5466c01aec35cb6\n1e8fba674761371cb9e88962dcb851c0\n7a698acebcf19b55170f05388a2f7fe0\nff5a7a610746ab5492cc6ab284138852\ncd33c5467d425f662f57672531701d89\n1ce47f76fca26b94b0b1d74610a734a4\n\n\nac22aa007081caeb8970aefba7eddfcf\n1498c9761fc819d496171c71604c2128\n2b3a8734a57604e98e6c996f94776086\n9b42968e9a7646feb7db318713271718\n04908c6853cb5c9d7dccaf15fb5fd3bb\nd444be30d2773b23de38ead1f2c6d117\n86ef188537f5e4637df24336c9b21cb0\ne7d960060d602deb53c7d49d2002c4a4\n5340fcfb3d2fa263c280e9659d13ba93\na6b4b679a51627ce279d5107c20dd078\n88653dde22f723934ea9806e76a1f546\nb3830791b0a397bea2ad943d151f856b\nbeb16ac99642f5c9382686fd8ee73e00\n\n\n-----\n\n## References\n\n[1] http://www.crowdstrike.com/blog/whois-numbered-panda/\n\n[2] http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp_ixeshe.pdf\n\n[3] http://www.symantec.com/security_response/writeup.jsp?docid=2013-080921-5219-99&tabid=2\n\n[4] https://blog.commtouch.com/cafe/malware/exe-read-backwards-spells-malware/\n\n[5] http://threatpost.com/sirefef-malware-found-using-unicode-right-to-left-override-technique/102033\n\n[6] http://blog.malwarebytes.org/online-security/2014/01/the-rtlo-method/\n\n[7] http://www.fireeye.com/blog/technical/2013/08/survival-of-the-fittest-new-york-times-attackers-evolvequickly.html\n\n[8] https://github.com/arbor/reversing/blob/master/find_byte_strings.py\n\n[9] http://www.arbornetworks.com/asert/2013/07/asert-mindshare-finding-byte-strings-using-idapython/\n\n[10] https://www.symantec.com/security_response/writeup.jsp?docid=2014-011500-2419-99&tabid=2\n\n[11] http://read.pudn.com/downloads199/sourcecode/windows/935255/htran.cpp__.htm\n\n## About ASERT\n\nThe Arbor Security Engineering & Response Team (ASERT) at Arbor Networks delivers world-class\nnetwork security research and analysis for the benefit of today's enterprise and network operators.\nASERT engineers and researchers are part of an elite group of institutions that are referred to as “super\nremediators,” and represent the best in information security. This is a reflection of having both visibility\nand remediation capabilities at a majority of service provider networks globally.\n\nASERT shares operationally viable intelligence with hundreds of international Computer Emergency\nResponse Teams (CERTs) and with thousands of network operators via intelligence briefs and security\ncontent feeds. ASERT also operates the world¹s largest distributed honeynet, actively monitoring Internet\nthreats around the clock and around the globe via ATLAS®, Arbor's global network of sensors:\nhttp://atlas.arbor.net. This mission and the associated resources that Arbor Networks brings to bear to\nthe problem of global Internet security is an impetus for innovation and research.\n\nTo view the latest research, news, and trends from Arbor, ASERT and the information security community\nat large, visit our Threat Portal at http://www.arbornetworks.com/threats/.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/h8c0ds5etxke111s38r7rs3ltmpf2mot",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.06.06.Etumbot_APT_Backdoor/ASERT-Threat-Intelligence-Brief-2014-07-Illuminating-Etumbot-APT.pdf"
    ],
    "report_names": [
        "ASERT-Threat-Intelligence-Brief-2014-07-Illuminating-Etumbot-APT"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d18fe42c-8407-4f96-aee0-a04e6dce219a",
            "created_at": "2023-01-06T13:46:38.275292Z",
            "updated_at": "2025-03-27T02:00:02.79092Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "Calc Team",
                "IXESHE",
                "BRONZE GLOBE",
                "BeeBus",
                "DynCalc",
                "DNSCalc",
                "Crimson Iron",
                "NUMBERED PANDA",
                "TG-2754",
                "Group 22"
            ],
            "source_name": "MISPGALAXY:APT12",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6a660ea2-1118-404a-9f8f-f0d6a1e9f184",
            "created_at": "2022-10-25T15:50:23.685924Z",
            "updated_at": "2025-03-27T02:00:55.52357Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "APT12",
                "IXESHE",
                "DynCalc",
                "Numbered Panda",
                "DNSCALC"
            ],
            "source_name": "MITRE:APT12",
            "tools": [
                "Ixeshe",
                "RIPTIDE",
                "HTRAN"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c5f79f58-db78-4cd7-88cf-c029a2199360",
            "created_at": "2022-10-25T16:07:23.325227Z",
            "updated_at": "2025-03-27T02:02:09.738383Z",
            "deleted_at": null,
            "main_name": "APT 12",
            "aliases": [
                "APT 12",
                "BeeBus",
                "Bronze Globe",
                "CTG-8223",
                "Calc Team",
                "Crimson Iron",
                "DNSCalc",
                "DynCALC",
                "Group 22",
                "Numbered Panda"
            ],
            "source_name": "ETDA:APT 12",
            "tools": [
                "AUMLIB",
                "ETUMBOT",
                "Exploz",
                "Graftor",
                "HIGHTIDE",
                "IHEATE",
                "IXESHE",
                "RIPTIDE",
                "RapidStealer",
                "Specfix",
                "THREEBYTE",
                "bbsinfo",
                "mswab",
                "yayih"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e6e26922-3f4f-4243-9af5-cf9bea8b93bd",
            "created_at": "2022-10-25T16:47:55.577163Z",
            "updated_at": "2025-03-27T02:05:17.26824Z",
            "deleted_at": null,
            "main_name": "BRONZE GLOBE",
            "aliases": [
                "CTG-8223 ",
                "DNSCalc",
                "DyncCalc",
                "Numbered Panda ",
                "APT12 "
            ],
            "source_name": "Secureworks:BRONZE GLOBE",
            "tools": [
                " BeepService",
                " Etumbot",
                " Gh0st RAT",
                " Ixeshe",
                " Mswab",
                " RAdmin",
                " Seatran",
                " SvcInstaller",
                " Ziyang",
                "Badpuck"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041584,
    "ts_creation_date": 1402093820,
    "ts_modification_date": 1402093820,
    "files": {
        "pdf": "https://archive.orkl.eu/51bb16ba51be3c144ac9e09a68732cbe0bb785d5.pdf",
        "text": "https://archive.orkl.eu/51bb16ba51be3c144ac9e09a68732cbe0bb785d5.txt",
        "img": "https://archive.orkl.eu/51bb16ba51be3c144ac9e09a68732cbe0bb785d5.jpg"
    }
}