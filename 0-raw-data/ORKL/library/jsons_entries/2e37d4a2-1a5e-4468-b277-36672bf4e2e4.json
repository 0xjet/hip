{
    "id": "2e37d4a2-1a5e-4468-b277-36672bf4e2e4",
    "created_at": "2022-10-25T16:48:19.134528Z",
    "updated_at": "2025-03-27T02:17:05.861103Z",
    "deleted_at": null,
    "sha1_hash": "b753e38856e8d51ab8b6833481038af247fc52ce",
    "title": "",
    "authors": "",
    "file_creation_date": "2016-12-28T08:56:33Z",
    "file_modification_date": "2016-12-28T08:56:33Z",
    "file_size": 3110773,
    "plain_text": "## FROM EQUATION TO EQUATIONS\n\n#### Revealing the multi-platform operational capability of Equation Group\n\n### Antiy CERT\n\n\n**Draft: Jan. 15, 2014 16:43 (UTC+8)**\n\n**Published: Nov. 4, 2016 10:00 (UTC+8)**\n\n**Updated: Nov. 4, 2016 13:00 (UTC+8)**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n# Contents\n\n**1** **BACKGROUND ...................................................................................................................................... 3**\n\n**2** **THE MULTI - PLATFORM OPERATIONAL CAPABILITY OF EQUATION ....................................................... 4**\n\n**3** **ANALYSIS OF PARTIAL LOAD FOR LINUX LINUX(X86) ............................................................................. 6**\n\n3.1 PRECEDING MODULE——DOUBLEFANTASY .......................................................................................................... 6\n\n**4** **ATTACK PAYLOAD FOR SOLARIS SPARC ................................................................................................. 16**\n\n4.1 SOLARIS AND SPARC ...................................................................................................................................... 16\n\n4.2 HIDDEN ROOTKITS .......................................................................................................................................... 16\n\n4.3 DOUBLEFANTASY MODULES FOR SPARC ............................................................................................................. 24\n\n**5** **SUMMARY ........................................................................................................................................... 31**\n\n5.1 IMPROVEMENT BASED ON REAL THREATS ............................................................................................................. 31\n\n5.2 ANTIY’S EFFORTS ............................................................................................................................................ 32\n\n5.3 FUTURE WORK ............................................................................................................................................... 33\n\n**APPENDIX 1: REFERENCES ............................................................................................................................................ 34**\n\n**APPENDIX 2：ABOUT ANTIY........................................................................................................................................ 35**\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**2**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n### 1 Background\n\nFrom February 2015, Antiy has published two reports about Equation Group, both of\n\nwhich analyzed the code components for Windows platform, the persistent ability in disks\n\nand the use of encryption algorithms. In this report, Antiy will publish the analysis of\n\nEquation components for Solaris and Linux platforms for the first time. We can also be proud\n\nto say that this is the first report to prove the existence of these kinds of “Evils”. We actually\n\nfinished the analysis several years ago, and Antiy has concerned with the Great Attack Group\n\nsince 2012, and trying to analyze its operational in all invasion and persistence scenarios,\n\nwhere the core targets are the server operating systems, such as Linux, Solaris and FreeBSD.\n\nThese loads are not usual script Trojans, but are **binary components with an** **encrypted**\n\n**communication. These components act as** **Rootkits, and have strict encryption**\n\n**anti-analysis technique and trick. Therefore, Antiy has named attacks performed by**\n\nsuper-attack organizations as A[2]PT, and make the capabilities to attack all platforms\n\nindicators.\n\nBased on long-term experience in tracking and analyzing capability of advanced threats\n\nand malicious code, Antiy’s product PTD (Persistent Threat Detection System) can help users\n\ncapture the payload delivery and lateral movement; IEP (Intelligent Endpoint Protection\n\nSystem) provide protection for traditional Windows hosts and Chinese Operating system, and\n\nassists PTA (Persistent Threat Analysis System) to analyze malware for various platforms.\n\nThe deployment of these products also enables customers to support Antiy to get more threat\n\nindicators. Meanwhile, we have been paying attention on open-source intelligence and public\n\ninformation, also the information and development trends of relevant organizations.\n\nAfter Kaspersky and Antiy released reports about Equation (called the Group for short)\n\nlast year, the Group still launched a series of attacks. In August 2016, the malware used by\n\nEquation was disclosed in Equation Group Cyber Weapons Auction – Invitation [[1]], and this\n\ngroup was connected with attack weapon system named ANT for the first time. Based on this,\n\nwe can also find its ability to inject and persist in products of Cisco, Juniper, Fortinet and\n\nother firewalls. On October 31, 2016, an article called Shadow Brokers reveals list of servers\n\n_Hacked by the NSA_ [[2]] was published in The Hacker News, which contained more documents\n\nrevealed by Shadow Brokers, including some of the foreign server list compromised by the\n\nGroup. The related documents claimed that most of the infected servers are running Solaris,\n\nOracle-owned Unix operating system, and some are running FreeBSD or Linux. With the\n\nmutual prove of public information and Antiy’s analysis conclusion of the samples, we can\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**3**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\nclearly figure out the powerful full-platforms attacking capability of this organization.\n\nOur analysis work is continuously validated by ongoing information. During the past\n\nyears, the analysis of this attack was sophisticated and challenging; whose analysis is more\n\ndifficult than Stuxnet or Flame. The malware with this kind of highly complex and hidden\n\ncapability is a huge challenge for both victims and analysts. Especially when the scope of its\n\ncombat coverage of almost All computer architecture and operating systems, the traditional\n\nsecurity team relatively good at analyzing the malware for Windows, Linux and Android and\n\nother mainstream operating system platform will feel much more pressure and challenges. If\n\nyou use the name of Equation to do a parable about the difficulty of analysis, what we need\n\n**to conquer is not an “Equation” but more complex“Equations”.**\n\nAntiy Labs released the Chinese version of this report on November 4th, 2016. Due to\n\nthe lack of translation ability and experience, the English version was not released\n\nsynchronously. Many colleagues in international cybersecurity field may read this report with\n\nthe help of Google Translator. This version got finished until November 8th, and we welcome\n\nyour advices and suggestions.\n\n### 2 The multi - platform operational capability of Equation\n\nEquation employs industrial-grade standard arm arsenal attack weapons arsenals,\n\nincluding six components: EquationLaser, EquationDrug, DoubleFantasy, TripleFantasy,\n\nFanny and GrayFish. Antiy has found samples of EquationDrug and DoubleFantasy attacking\n\non other platforms. The arsenal information is shown in the following table:\n\n**Component** **Platform** **Description** **Period**\n\n**Equation-** **Not** An early implant from the EQUATION group, used 2001-2003\n\n**Laser** **found** around 2001-2003. Compatible with Windows 95/98.\n\n**Equation-** **Some** A very complex attacking platform used by Equation. It 2003-2013\n\n**Drug** **plugins** supports a module plugin system, which can be\n\n**found** dynamically uploaded and unloaded by attackers. May\n\nbe the upgraded version of EquationLaser.\n\n**Double-** **Proved** A validator-style Trojan, which is designed to confirm 2004-2012\n\n**Fantasy** the target, is the intended one. If the target is confirmed,\n\nthey get upgraded to a more sophisticated platform such\n\nas EQUATIONDRUG or GRAYFISH.\n\n**Triple-** **Maybe** A full-featured backdoor sometimes used in tandem with 2012-now\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**4**\n\n|Component Platform Description Period|Col2|Col3|Col4|\n|---|---|---|---|\n|Equation- Laser|Not found|An early implant from the EQUATION group, used around 2001-2003. Compatible with Windows 95/98.|2001-2003|\n|Equation- Drug|Some plugins found|A very complex attacking platform used by Equation. It supports a module plugin system, which can be dynamically uploaded and unloaded by attackers. May be the upgraded version of EquationLaser.|2003-2013|\n|Double- Fantasy|Proved|A validator-style Trojan, which is designed to confirm the target, is the intended one. If the target is confirmed, they get upgraded to a more sophisticated platform such as EQUATIONDRUG or GRAYFISH.|2004-2012|\n|Triple-|Maybe|A full-featured backdoor sometimes used in tandem with|2012-now|\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**Fantasy** **existing** GRAYFISH. It looks like an upgrade of\n\nDOUBLEFANTASY, and is possibly a more recent\n\nvalidator-style plugin.\n\n**Fanny** **Not found** A computer worm created in 2008 and used to collect 2008-2011\n\ninformation about targets in the Middle East and Asia.\n\nSome victims appear to have been upgraded first to\n\nDoubleFantasy, and then to EQUATIONDRUG. Fanny\n\nused exploits for two 0day vulnerabilities which were\n\nlater discovered with Stuxnet.\n\n**GrayFish** **Not found** The most sophisticated attack platform from Equation. It 2008-now\n\ncompletely resides in the registry, relying on a Bootkit to\n\ngain execution at OS startup.\n\nBased on the following table, readers can put together jigsaw puzzles of Equation attack.\n\n**Information** **Windows** **Linux** **Solaris** **Oracle-** **FreeBSD**\n\n**owned Unix**\n\nAntiy The Trojan modifying Analysis of sample\n\nfirmware Exploration in attack load and hard disk\n\ncomponents of Equation Group[[3]] persistence\n\nAntiy Analysis of encryption skills Encryption\n\nused in Equation Group attack algorithm analysis\n\ncomponents[[4]]\n\nAntiy Revealing the multi-platform Found Analysis\n\nloading capability of Equation Analysis of of related\n\nGroup（this report） related loads\n\nloads\n\nThe Hacker News：Shadow Brokers Existed Existed Existed\n\nreveals list of Servers Hacked by\n\nthe NSA\n\nKaspersky Equation: The Death Revealing Equation\n\nStar of Malware Galaxy[[5]]\n\nKaspersky A Fanny Equation: \"I am Fanny analysis\n\nyour father, Stuxnet\"[[6]]\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**5**\n\n|Fantasy|existing|GRAYFISH. It looks like an upgrade of DOUBLEFANTASY, and is possibly a more recent validator-style plugin.|Col4|\n|---|---|---|---|\n|Fanny|Not found|A computer worm created in 2008 and used to collect information about targets in the Middle East and Asia. Some victims appear to have been upgraded first to DoubleFantasy, and then to EQUATIONDRUG. Fanny used exploits for two 0day vulnerabilities which were later discovered with Stuxnet.|2008-2011|\n|GrayFish|Not found|The most sophisticated attack platform from Equation. It completely resides in the registry, relying on a Bootkit to gain execution at OS startup.|2008-now|\n\n|Information|Windows|Linux|Solaris|Oracle- owned Unix|FreeBSD|Mac OS|\n|---|---|---|---|---|---|---|\n|Antiy The Trojan modifying firmware Exploration in attack components of Equation Group[3]|Analysis of sample load and hard disk persistence||||||\n|Antiy Analysis of encryption skills used in Equation Group attack components[4]|Encryption algorithm analysis||||||\n|Antiy Revealing the multi-platform loading capability of Equation Group（this report）||Found Analysis of related loads|Analysis of related loads||||\n|The Hacker News：Shadow Brokers reveals list of Servers Hacked by the NSA|||Existed|Existed|Existed||\n|Kaspersky Equation: The Death Star of Malware Galaxy[5]|Revealing Equation||||||\n|Kaspersky A Fanny Equation: \"I am your father, Stuxnet\"[6]|Fanny analysis||||||\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\nKaspersky Equation Group: from Doublefantasy\n\nHouston with love[[[7]] analysis\n\nKaspersky EQUATION GROUP: Equation Group\n\nQUESTIONS AND ANSWERS[[8]] Questions and\n\nAnswers\n\n**Note: Antiy has found User Agent with Solaris logo during the analysis of samples, and**\n\nKaspersky released a series of reports, revealing the Equation Group; one named as\n\n\"Equation Group Questions and Answers\"[[8]] publishes the capture information of the Mac OS\n\nX Agent. So far, both Antiy and Kaspersky have not yet found Mac OS X samples, but the\n\npayload for Mac OS X does exist.\n\n### 3 Analysis of Partial Load for Linux Linux(x86)\n\nWe have captured the samples on Linux platform and confirmed that the sample is\n\nDoubleFantasy component after analyzing. The component is used to perform incipient\n\ndetection on targets with Linux platform. It is a sample of the Linux platform, so it has\n\ndifferent features with others.\n\n#### 3.1 Preceding Module——DoubleFantasy\n\n**3.1.1** **File Tag**\n\n**Name** **Trojan/Linux.DoubleFantasy**\n\n**Original File Name** ████████\n\n**MD5** ████████████████\n\n**Processor Architecture** X86（32-bit）\n\n**Size** ████████\n\n**Format** BinExecute/ELF\n\n**Timestamp** N/A\n\n**Signature** None\n\n**Shell** None\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**6**\n\n|Kaspersky Equation Group: from Houston with love[[7]|Doublefantasy analysis|Col3|Col4|Col5|Col6|Col7|\n|---|---|---|---|---|---|---|\n|Kaspersky EQUATION GROUP: QUESTIONS AND ANSWERS[8]|Equation Group Questions and Answers|||||Speculation based on network features|\n\n|Name Trojan/Linux.DoubleFantasy|Col2|\n|---|---|\n|Original File Name|████████|\n|MD5|████████████████|\n|Processor Architecture|X86（32-bit）|\n|Size|████████|\n|Format|BinExecute/ELF|\n|Timestamp|N/A|\n|Signature|None|\n|Shell|None|\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**Compiler language** C\n\n**3.1.2** **Running Process**\n\nOn Linux platform, samples execution is divided into two cases, with parameters or no\n\nparameters. If the parameter '-c' engages in, only system information can be obtained and it\n\ncan be regarded as scene detection. The process can be shown by the following flow chart:\n\n**Figure 1 Running process with parameter–c**\n\nIn the case without parameter '-c', the process can be shown as:\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**7**\n\n|Compiler language|C|\n|---|---|\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**Figure 2 Running process without parameter–c**\n\n**3.1.3** **Basic functions**\n\n Traversing system files, clearing / var / log / lastlog records, obtaining system\n\naccount password information.\n\n Connecting Google to determine network connectivity.\n\n Connecting remote sever and making different operations based on remote control\n\ninstructions.\n\n Many encryption algorithms used in communication and information.\n\n Starting itself with a linked file, and the proc /% d / exe file pointing to the files of\n\nthe sample.\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**8**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n Opening three PID threads (two of them are consecutive) after running.\n\n Collecting information about infected computers, including system directory, file\n\nextension, and other information. As shown below:\n\n**Figure 3 Collecting basic system information**\n\n The malware starts process fork() and determine the PID number of its child\n\nprocess. If the execution succeeds, then the main function will exit and cannot debug.\n\nDebugging process is shown as below:\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**9**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**Figure 4 Child-process judgment**\n\n Decrypting various strings, obtaining user’s information including the system\n\nversion\n\n Obtaining user’s login information getpwnam\n\n Viewing file /bin/fast /sbin/login /usr/sbin/nologin\n\n Getting user’s login password getpwuid\n\n Read user’s log var/log /lastlog\n\n**3.1.4** **Dynamic Loading of Function and Data**\n\nThe function and data called by this sample is dynamically loaded and debugged,\n\ndynamic debugging is wanted in the analysis. We explain the calling addresses through\n\ndynamic analysis decryption, and the details are shown as bellows:\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**10**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**Figure 5 Function call address**\n\n**3.1.5** **Decryption and Analysis of String**\n\nIn the sample, a self-defined encryption algorithm is used to encrypt the internal string\n\ninformation. The algorithm is called 115 times. The encryption algorithm is as follows:\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**11**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**Figure 6 String encryption algorithm used in Linux samples**\n\n**3.1.6** **Network Communication Encryption**\n\nDuring the period of network communication performed by Linux samples, the 16-bit\n\nkey hardcoded in the sample is the same as the 16-bit key in the Windows platform\n\nDoubleFantasy sample that encrypts the registry:\n\n66 39 71 3c 0f 85 99 81 20 19 35 43 fe 9a 84 11\n\nThe calculated subkeys are:\n\nE9 BE CD E0 A8 9F 4D DB C3 42 AC 2B 24 77 AB CB 5A C1 52 F8 5B 3E F0 78 CB 01 0A 69 29 8F 85 8C\n\n03 9C 7C EF 5E 36 0E 8B C0 40 76 28 9C 9C F2 24 81 9D 02 72 4F 6A BB B5 5B 42 73 14 88 F2 73 75\n\n8B F9 37 98 3B 9F 64 2B A3 C4 FF C7 8A 40 67 C1 25 9F 65 54 45 36 48 FF E2 86 05 1A F4 94 AC 2B\n\n08 D5 E5 83 BE 2C AD EE D0 A6 98 CB 8D 35 ED EE C4 F0 8C F2 CD BA 87 03 54 27 3D 13 A7 9B 6A 05\n\nC7 02 30 21 05 67 58 3B E6 A1 44 0A 37 16 3C 86 E9 BC 8B 20 1A 98 7E 28 E6 7F F7 CA F7 9E 38 31\n\n7F F0 2F 93 11 2B 28 F0 FF 11 B7 FC 1C 63 86 CB\n\nThe custom algorithm for Linux samples is the same as for Windows, and there is only\n\none encryption key to use (Because the Linux system does not have a registry, there is no\n\nregistry encryption function). It uses the Windows platform Key for encryption and\n\ndecryption, and we can see that both platforms use the same secondary key transformation\n\nalgorithm (Specific details can be seen in the Windows encryption algorithm analysis part).\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**12**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**Figure 7 Secondary key transformation algorithm**\n\n**3.1.7** **Network control instruction**\n\nInstruction branch of Linux sample is basically the same as Windows. There are a total\n\nof nine instruction branches, and the function is also roughly the same. The instruction codes\n\nare: 0x4A, 0x4B, 0x60, 0x70, 0x75, 0x76, 0x78, 0x79, 0x80.\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**13**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**Figure 8 Instruction branch code for Linux samples**\n\nThe function of instructions for Linux system is the same as the Windows sample\n\nfunction, only with the difference between obtaining system information. The following\n\nshows Linux sample accessing to information format:\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**14**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**Figure 9 Linux sample accessing to information format**\n\nThe description of obtaining information format:\n\n**NO.** **Description** **NO.** **Description** **NO.** **Description**\n\n**000** MAC **033** Platform type（i386\\i686） **042** OS（ubuntu）\n\n**001** IP **034** System kernel version **043** Regional language\n\n（zh_cn.utf8）\n\n**002** Version **035** OS type time **044** Unknown\n\n**003** Clsid **036** Unknown **045** System uptime\n\n**004** Settings **037** Unknown **046** Unknown\n\ninformation of proxy\n\n**005** Unknown **038** PST **047** Unknown\n\n**030** Username **039** Unknown **048** Sample name\n\n**031** Password **040** Time\n\n**032** OS type( eg. Linux) **041** Time\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**15**\n\n|NO. Description NO. Description NO. Description|Col2|Col3|Col4|Col5|Col6|\n|---|---|---|---|---|---|\n|000|MAC|033|Platform type（i386\\i686）|042|OS（ubuntu）|\n|001|IP|034|System kernel version|043|Regional language （zh_cn.utf8）|\n|002|Version|035|OS type time|044|Unknown|\n|003|Clsid|036|Unknown|045|System uptime|\n|004|Settings information of proxy|037|Unknown|046|Unknown|\n|005|Unknown|038|PST|047|Unknown|\n|030|Username|039|Unknown|048|Sample name|\n|031|Password|040|Time|||\n|032|OS type( eg. Linux)|041|Time|||\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n### 4 Attack Payload for Solaris SPARC\n\nEquation may have created the first malware with Rootkit features in SPARC\n\narchitecture, and provide cover for DoubleFantasy targeting Solaris.\n\n#### 4.1 Solaris and SPARC \n\nSolaris is the computer operating system which is developed by Sun Microsystems. It adopts\n\nSPARC or X86, and is mainly used for workstations, servers, operating systems. The malicious\n\ncode on Solaris platform is rare. From Antiy’s statistic, there are no more than 60 kinds of\n\nmalicious code variants which are binary compiled form even in the period of SUN OS. They are\n\nalmost based on X86 platform.\n\nThe full name of SPARC is Scalable Processor Architecture, one of microprocessor\n\narchitecture. Its instruction set is significantly differ from X86 and has its own unique window,\n\ndelay slot, the process call features.\n\nThe computer which has SPARC is generally used for industrial, space-related areas. It is\n\nseldom used in similar IDC and general IT scenario.\n\n#### 4.2 Hidden Rootkits\n\nThis is a rootkit program on the Solaris platform of the SPARC architecture. It is\n\nprimarily responsible for hiding the main function sample files like other rootkit programs, as\n\nwell as the associated derived files and itself, including process, file, and service information.\n\nIt runs on the target computer firstly, investigates system environment, configuration\n\ninformation, network status of the target computer, and hides the specified files and\n\nprocesses.\n\n**4.2.1** **File Tags**\n\n**Name** Trojan[Rootkit]/Solaris. Equation\n\n**Original file name** ████████\n\n**MD5** ████████████████\n\n**Processor** SPARC-32\n\n**architecture**\n\n**Size** ████████\n\n**Format** BinExecute/ELF\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**16**\n\n|Name|Trojan[Rootkit]/Solaris. Equation|\n|---|---|\n|Original file name|████████|\n|MD5|████████████████|\n|Processor architecture|SPARC-32|\n|Size|████████|\n|Format|BinExecute/ELF|\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**Timestamp** n/a\n\n**Signature** None\n\n**Shell** None\n\n**Language** Linux C\n\n**4.2.2** **Main function**\n\nThe samples have 249 functions, as shown in the sample main function flow. Some of\n\nthe functions are relatively complex. There are a variety of encrypted data in the samples.\n\n**Figure 10 Main functions of the samples**\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**17**\n\n|Timestamp|n/a|\n|---|---|\n|Signature|None|\n|Shell|None|\n|Language|Linux C|\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**4.2.3** **Derived file name and path**\n\nAfter running, it can combine two sets of strings which are according to the internal\n\nconfiguration to generate file name as its own new file name, and copy itself to the / sbin /\n\ndirectory.\n\n**String 1** **String 2**\n\naudit admr\n\nboot agent\n\ncache conf\n\ncore client\n\ncron info\n\ninit mgr\n\ninet statd\n\nfilesys serv\n\nWe can find that these words are highly frequency words or suffix used in system files\n\nand system command. Thus, the file name of the sample is carefully structured and confusing.\n\nThe general administrator is also difficult to detect abnormal situation in the system files.\n\n**4.2.4** **Starting script**\n\nThe script realizes the startup by using the service. It creates the script in the etc / rc.d /\n\ndirectory (S85s%). This script will run with the start parameter as the service which is\n\nexecuted when open the computer.\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**18**\n\n|String 1 String 2|Col2|\n|---|---|\n|audit|admr|\n|boot|agent|\n|cache|conf|\n|core|client|\n|cron|info|\n|init|mgr|\n|inet|statd|\n|filesys|serv|\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**Figure 11 Service script**\n\nThe content of S85s% document is encrypted. After running, it can call its own function\n\nto decrypt, and modify the variable of the file name. Then it can write into /etc/rc.d/ directory\n\n(It will be modified to the path of the sample in figure below % E).\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**19**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**Figure 12 The content of the script after decryption**\n\n**4.2.5** **Hidden directory and files**\n\nThe sample will generate MD5 based on HOSTID of the target computer, then calculate\n\nclass base64 algorithm, take the first six bits finally. It can splice .tmp with the first six bits\n\ninto a folder name and create the folder.\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**20**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**Figure 13 Folder name created by samples**\n\nThe sample will also copy other files to execute according to the running parameters. It\n\nis responsible for hiding all the files in this folder.\n\n**4.2.6** **Version judgement**\n\nThe sample can determine that the system is not sun4m, sun4d version through the\n\nuname function. And it can determine the system architecture by reading / dev / ksyms files:\n\ni386, ia64, sparc, sparcv9. To make sure the SPARC architecture and the release version is\n\n5.1.\n\n**Figure 10 Version judgement**\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**21**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**4.2.7** **Encrypting the configuration data**\n\nThere are multiple encryption algorithms inside the sample. One of the encryption\n\nalgorithms was called multiple times. We analyzed and decrypted the data.\n\n**Figure 15 Encryption algorithm**\n\nDecrypting encrypted data as follows：\n\n**Offset** **Plaintext** **Offset** **Plaintext**\n\n0x10cd0 /platform/%s/kernel/sparcv9/ 0x11830 mgr\n\nunix\n\n0x10cf8 /var/sadm/i 0x11838 statd\n\n0x10d28 SUNW 0x11840 serv\n\n0x10d30 /var/sadm/patch/%s/READM 0x11848 svcd\n\nE.%s\n\n0x10d50 var/sadm/pkg/%s/pkginfo 0x11851 \\\n\n0x10d70 PATCHLIST 0x11855 \\W\n\n0x10d80 /var/sadm/pkg/%s/pkginfo 0x11859 \\O\n\n0x10da0 PATCH_INFO 0x1185d \\G\n\n0x10db8 Requires: 0x11861 \\w\n\n0x10dc8 Ob 0x11865 \\o\n\n0x10dcc !8I 秨; 0x11869 \\g\n\n0x10dd8 Incompatibles: 0x1186d \\\n\n0x10df0 module_main 0x11871 \\\n\n0x10e10 %s/%s 0x11878 audit\n\n0x10e18 date 0x11880 boot\n\n0x10e20 /etc/mnttab 0x11888 cache\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**22**\n\n|Offset Plaintext Offset Plaintext|Col2|Col3|Col4|\n|---|---|---|---|\n|0x10cd0|/platform/%s/kernel/sparcv9/ unix|0x11830|mgr|\n|0x10cf8|/var/sadm/i|0x11838|statd|\n|0x10d28|SUNW|0x11840|serv|\n|0x10d30|/var/sadm/patch/%s/READM E.%s|0x11848|svcd|\n|0x10d50|var/sadm/pkg/%s/pkginfo|0x11851|\\|\n|0x10d70|PATCHLIST|0x11855|\\W|\n|0x10d80|/var/sadm/pkg/%s/pkginfo|0x11859|\\O|\n|0x10da0|PATCH_INFO|0x1185d|\\G|\n|0x10db8|Requires:|0x11861|\\w|\n|0x10dc8|Ob|0x11865|\\o|\n|0x10dcc|!8I 秨;|0x11869|\\g|\n|0x10dd8|Incompatibles:|0x1186d|\\|\n|0x10df0|module_main|0x11871|\\|\n|0x10e10|%s/%s|0x11878|audit|\n|0x10e18|date|0x11880|boot|\n|0x10e20|/etc/mnttab|0x11888|cache|\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n0x10e38 swap 0x11890 core\n\n0x10e40 tmpfs 0x11898 cron\n\n0x10e48 ro 0x118a0 init\n\n0x10e50 noexec 0x118a8 inet\n\n0x10e60 D 0x118b0 filesys\n\n0x10e68 sun4m 0x118c0 key\n\n0x10e70 sun4d 0x118c8 ntp\n\n0x10e78 sparc 0x118d0 root\n\n0x10e80 /dev/ksyms 0x118d8 sys\n\n0x10e98 sparc 0x118e0 rpcd\n\n0x10ea0 i386 0x118e8 vol\n\n0x10ea8 sparcv 0x11940 /\n\n0x10eb8 ia64 0x11948 /usr/bin/\n\n0x10ec0 sparc 0x11958 /bin/\n\n0x10ec8 SunOS 0x11960 /sbin/\n\n0x10ed0 Generic 0x11970 var/tmp/faipprep001\n\n0x10ee0 boothowto 0x11990 init\n\n0x10ef8 /dev/ksyms 0x11998 fini\n\n0x10f08 /dev/kmem 0x119a0 minit\n\n0x116d0 /var/tmp/ 0x119a8 fini\n\n0x116e0 /lib/ 0x119b0 mdata\n\n0x116e8 /dev/ 0x119b8 priocntlsys\n\n0x116f0 /etc/ 0x119c8 /dev/ksyms\n\n0x116f8 / 0x119d8 init\n\n0x11700 %s.tmp%6s 0x119e0 /dev/kmem\n\n0x11710 #!/sbin/sh 0x119f0 /dev/mem\n\n0x11800 admr 0x11a00 /proc/self\n\n0x1180a NCk 0x11a10 .got\n\n0x11810 conf 0x11a18 .got\n\n0x11818 client 0x11a28 .got\n\n0x11828 info 0x11a30 GLOBAL_OFFSET_TAB\n\nLE_\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**23**\n\n|0x10e38|swap|0x11890|core|\n|---|---|---|---|\n|0x10e40|tmpfs|0x11898|cron|\n|0x10e48|ro|0x118a0|init|\n|0x10e50|noexec|0x118a8|inet|\n|0x10e60|D|0x118b0|filesys|\n|0x10e68|sun4m|0x118c0|key|\n|0x10e70|sun4d|0x118c8|ntp|\n|0x10e78|sparc|0x118d0|root|\n|0x10e80|/dev/ksyms|0x118d8|sys|\n|0x10e98|sparc|0x118e0|rpcd|\n|0x10ea0|i386|0x118e8|vol|\n|0x10ea8|sparcv|0x11940|/|\n|0x10eb8|ia64|0x11948|/usr/bin/|\n|0x10ec0|sparc|0x11958|/bin/|\n|0x10ec8|SunOS|0x11960|/sbin/|\n|0x10ed0|Generic|0x11970|var/tmp/faipprep001|\n|0x10ee0|boothowto|0x11990|init|\n|0x10ef8|/dev/ksyms|0x11998|fini|\n|0x10f08|/dev/kmem|0x119a0|minit|\n|0x116d0|/var/tmp/|0x119a8|fini|\n|0x116e0|/lib/|0x119b0|mdata|\n|0x116e8|/dev/|0x119b8|priocntlsys|\n|0x116f0|/etc/|0x119c8|/dev/ksyms|\n|0x116f8|/|0x119d8|init|\n|0x11700|%s.tmp%6s|0x119e0|/dev/kmem|\n|0x11710|#!/sbin/sh|0x119f0|/dev/mem|\n|0x11800|admr|0x11a00|/proc/self|\n|0x1180a|NCk|0x11a10|.got|\n|0x11810|conf|0x11a18|.got|\n|0x11818|client|0x11a28|.got|\n|0x11828|info|0x11a30|GLOBAL_OFFSET_TAB LE_|\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**4.2.8** **Decrypting and executing other codes / samples**\n\nThe sample adds the encrypted data at the end of the file. After running, it can decide the\n\nsize of the encrypted data through the end data, parse and read the data through the defined\n\nformat. It may load and execute after decrypting the data.\n\n#### 4.3 DoubleFantasy modules for SPARC \n\nThe function of the sample is the same with the one on Windows and Linux platform.\n\nThe main differences are CPU architecture, assembly instructions, storage location of the\n\nconfiguration information and obtained system information.\n\n**4.3.1** **File Tags**\n\n**Name** Trojan/Solaris.DoubleFantasy\n\n**Original File Name** ████████\n\n**MD5** ████████████████\n\n**Processor Architecture** SPARC-32\n\n**Size** ████████\n\n**Format** BinExecute/ELF\n\n**Timestamp** n/a\n\n**Signature** None\n\n**Shell** None\n\n**Language** Linux C\n\n**4.3.2** **Basic functions**\n\n Initializing the string, dynamic array, decrypt the internal configuration information.\n\n Connecting Google or Yahoo URL to determine network connectivity.\n\n Connecting remote URL address. Its remote C & C server address is xxxech.com. The\n\ncorresponding IP is xxx.xxx.235.237 (One IP of Windows:xxx.xxx.235.235.\n\nxxx.xxx.235.235. It belongs to the same network segment. It’s basically determined as\n\nthe same attack source). It will collect the host information, back to the above address,\n\nand wait for the remote host to send instructions.\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**24**\n\n|Name|Trojan/Solaris.DoubleFantasy|\n|---|---|\n|Original File Name|████████|\n|MD5|████████████████|\n|Processor Architecture|SPARC-32|\n|Size|████████|\n|Format|BinExecute/ELF|\n|Timestamp|n/a|\n|Signature|None|\n|Shell|None|\n|Language|Linux C|\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n Reading the system account password file, retrieve user information and password.\n\n Run with the daemon mode in the sample, achieve the ability of self-protection.\n\n Use a variety of encryption algorithms to encrypt string information.\n\n Collecting detailed system information and sending back to the server (such as computer\n\nname, IP address, process information, account information, etc., the details can be seen\n\nin detailed analysis later in this chapter).\n\n Have 7 network instructions, same functions with Windows version, execute the\n\ncorresponding instruction operation. The detailed functions of the corresponding\n\ncommand can be seen in detailed analysis later in this chapter.\n\n**4.3.3** **Configuring Information Encryption**\n\nDue to Solaris system does not have the Windows registry, the configuration data will be\n\ndirectly used after decryption. We can see one of the decryption algorithms as follows. The\n\ndecryption function is called for 63 times.\n\n**Figure 16 Strings decryption**\n\nDecrypted string information can be seen in the table below:\n\n**Offset** **Plaintext** **Offset** **Plaintext**\n\n0x1346c ' 200 Connection established' 0x13560 'Content-Length:'\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**25**\n\n|Offset Plaintext Offset Plaintext|Col2|Col3|Col4|\n|---|---|---|---|\n|0x1346c|' 200 Connection established'|0x13560|'Content-Length:'|\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n0x13470 ' 200 OK' 0x13458 'Content-Length: %d'\n\n0x133fc ' days ' 0x13460 'Content-length: %d'\n\n0x13400 ' hrs ' 0x13488 'Cookie: %s'\n\n0x13540 ' HTTP/1.1\\r\\n' 0x13554 'GET '\n\n0x1340c ' logged in' 0x13544 'Host: '\n\n0x13404 ' mins ' 0x13474 'HTTP/'\n\n0x13408 ' total' 0x13478 'HTTP/1.0 200 OK'\n\n0x133f4 ' yrs ' 0x13534 'http://'\n\n0x133d8 '\"' 0x13384 'I_MASK'\n\n0x13584 '%02x-%02x-%02x-%02x-%02x-%02x 0x133ec 'LANG'\n\n0x13594 '%u.%u.%u.%u' 0x133f0 'LANGUAGE'\n\n0x134dc '/.mozilla/' 0x133c0 'LD_PRELOAD='\n\n0x134e0 '/.mozilla/firefox/' 0x13418 'M_MASK'\n\n0x134c4 '/.netscape' 0x133e4 'MACHTYPE'\n\n0x13438 '/bin/false' 0x134b4 'network.proxy.http'\n\n0x13520 '/bin/false' 0x134b8 'network.proxy.http_port'\n\n0x1338c '/dev/null' 0x134bc 'network.proxy.ssl'\n\n0x133b0 '/dev/null' 0x134c0 'network.proxy.ssl_port'\n\n0x134c8 '/preferences.js' 0x1348c 'p'\n\n0x134cc '/prefs.js' 0x133b8 'PATH'\n\n0x13428 '/proc' 0x133bc 'PATH='\n\n0x1343c '/sbin/nologin' 0x1355c 'POST '\n\n0x13524 '/sbin/nologin' 0x13410 'process info: '\n\n0x13390 '/tmp/' 0x1354c 'Proxy-Connection: close\\r\\n'\n\n0x133b4 '/tmp/' 0x134d8 'S'\n\n0x135a0 '@C\\xe3\\xc0' 0x1353c 'S'\n\n0x13558 '\\r\\n' 0x133c4 'sendmail'\n\n0x13464 '\\r\\n\\r\\n' 0x13484 'SESSID=\"0%x%s%x:eac:\n\n%lu:%lu\"\\r\\n'\n\n0x13588 '0x%02x%02x%02x%02x%02x% 0x1349c 'user_pref(\"'\n\n02x'\n\n0x1341c '0xA857' 0x134a0 'user_pref(\"%s\"\n\n0x13388 '0xAA%llu' 0x134a8 'user_pref(\"%s%s'\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**26**\n\n|0x13470|' 200 OK'|0x13458|'Content-Length: %d'|\n|---|---|---|---|\n|0x133fc|' days '|0x13460|'Content-length: %d'|\n|0x13400|' hrs '|0x13488|'Cookie: %s'|\n|0x13540|' HTTP/1.1\\r\\n'|0x13554|'GET '|\n|0x1340c|' logged in'|0x13544|'Host: '|\n|0x13404|' mins '|0x13474|'HTTP/'|\n|0x13408|' total'|0x13478|'HTTP/1.0 200 OK'|\n|0x133f4|' yrs '|0x13534|'http://'|\n|0x133d8|'\"'|0x13384|'I_MASK'|\n|0x13584|'%02x-%02x-%02x-%02x-%02x-%02x|0x133ec|'LANG'|\n|0x13594|'%u.%u.%u.%u'|0x133f0|'LANGUAGE'|\n|0x134dc|'/.mozilla/'|0x133c0|'LD_PRELOAD='|\n|0x134e0|'/.mozilla/firefox/'|0x13418|'M_MASK'|\n|0x134c4|'/.netscape'|0x133e4|'MACHTYPE'|\n|0x13438|'/bin/false'|0x134b4|'network.proxy.http'|\n|0x13520|'/bin/false'|0x134b8|'network.proxy.http_port'|\n|0x1338c|'/dev/null'|0x134bc|'network.proxy.ssl'|\n|0x133b0|'/dev/null'|0x134c0|'network.proxy.ssl_port'|\n|0x134c8|'/preferences.js'|0x1348c|'p'|\n|0x134cc|'/prefs.js'|0x133b8|'PATH'|\n|0x13428|'/proc'|0x133bc|'PATH='|\n|0x1343c|'/sbin/nologin'|0x1355c|'POST '|\n|0x13524|'/sbin/nologin'|0x13410|'process info: '|\n|0x13390|'/tmp/'|0x1354c|'Proxy-Connection: close\\r\\n'|\n|0x133b4|'/tmp/'|0x134d8|'S'|\n|0x135a0|'@C\\xe3\\xc0'|0x1353c|'S'|\n|0x13558|'\\r\\n'|0x133c4|'sendmail'|\n|0x13464|'\\r\\n\\r\\n'|0x13484|'SESSID=\"0%x%s%x:eac: %lu:%lu\"\\r\\n'|\n|0x13588|'0x%02x%02x%02x%02x%02x% 02x'|0x1349c|'user_pref(\"'|\n|0x1341c|'0xA857'|0x134a0|'user_pref(\"%s\"|\n|0x13388|'0xAA%llu'|0x134a8|'user_pref(\"%s%s'|\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n0x13568 'CONNECT ' 0x134f8 'v'\n\n0x13550 'Connection: close\\r\\n' 0x13548 'y\"'\n\n0x13454 'Content-Length:' 0x1347c 'y\"y\"'\n\n0x1345c 'Content-length:'\n\nAnother encrypted string algorithm is as the required configuration information when\n\nencrypted sample is running. The decryption algorithm is as follows:\n\n**Figure 17 Another decryption algorithm**\n\nThe content of decryption is shown in the table below:\n\n**Offset** **Plaintext** **Offset** **Plaintext**\n\n0x13c12 'www.google.com' 0x1439b 'ntp'\n\n0x13d11 'www.yahoo.com' 0x143ac 'mail'\n\n0x13e32 '\\x91 xxx atech.com' 0x143bd 'mysql'\n\n0x14034 '\\\\X' 0x143cd 'named'\n\n0x1406c '\\\\' 0x143db 'sys'\n\n0x140e7 '\\x91puX;\\xc7;\\xc7Xupp\\x8dTq\\x01{User-Agent: 0x143ec 'smtp'\n\nMozilla/5.0 (X11; U; Solaris; en-US; rv:1.7.5)\n\nGecko/20041111 Firefox/1.0\\r\\n'\n\n0x1419d 'Accept: image/png 0x143fe 'nobody'\n\n0x14314 '\"' 0x1440c 'auth'\n\n0x1437e 'daemon' 0x1441a 'LP'\n\n0x1438b 'adm' 0x1442c 'UUCP'\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**27**\n\n|0x13568|'CONNECT '|0x134f8|'v'|\n|---|---|---|---|\n|0x13550|'Connection: close\\r\\n'|0x13548|'y\"'|\n|0x13454|'Content-Length:'|0x1347c|'y\"y\"'|\n|0x1345c|'Content-length:'|||\n\n|Offset Plaintext Offset Plaintext|Col2|Col3|Col4|\n|---|---|---|---|\n|0x13c12|'www.google.com'|0x1439b|'ntp'|\n|0x13d11|'www.yahoo.com'|0x143ac|'mail'|\n|0x13e32|'\\x91 xxx atech.com'|0x143bd|'mysql'|\n|0x14034|'\\\\X'|0x143cd|'named'|\n|0x1406c|'\\\\'|0x143db|'sys'|\n|0x140e7|'\\x91puX;\\xc7;\\xc7Xupp\\x8dTq\\x01{User-Agent: Mozilla/5.0 (X11; U; Solaris; en-US; rv:1.7.5) Gecko/20041111 Firefox/1.0\\r\\n'|0x143ec|'smtp'|\n|0x1419d|'Accept: image/png|0x143fe|'nobody'|\n|0x14314|'\"'|0x1440c|'auth'|\n|0x1437e|'daemon'|0x1441a|'LP'|\n|0x1438b|'adm'|0x1442c|'UUCP'|\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**4.3.4** **Network communication encryption**\n\nThe custom algorithm for the Solaris samples is the same as the one on Windows. There\n\nis only one encrypted key (Solaris system does not have a registry. There is no registry\n\nencryption function). The key is the same as the one of registry encryption data on Windows\n\nplatform. The custom encryption algorithms of the two platforms are the same (the specific\n\nalgorithm can participate in 3.1.6 encryption algorithm analysis).\n\nAfter analysis, the original 16-bit key of samples on Solaris is :\n\n66 39 71 3c 0f 85 99 81 20 19 35 43 fe 9a 84 11\n\nAddress of the original 16-bit key in file is the same length as the original 16-bit key of\n\nWindows.\n\nDue to that Solaris and Windows samples generate the same algorithm of network\n\ncommunication sub-key, it can generate a sub key:\n\nE9 BE CD E0 A8 9F 4D DB C3 42 AC 2B 24 77 AB CB 5A C1 52 F8 5B 3E F0 78 CB 01 0A 69 29 8F 85 8C\n\n03 9C 7C EF 5E 36 0E 8B C0 40 76 28 9C 9C F2 24 81 9D 02 72 4F 6A BB B5 5B 42 73 14 88 F2 73 75\n\n8B F9 37 98 3B 9F 64 2B A3 C4 FF C7 8A 40 67 C1 25 9F 65 54 45 36 48 FF E2 86 05 1A F4 94 AC 2B\n\n08 D5 E5 83 BE 2C AD EE D0 A6 98 CB 8D 35 ED EE C4 F0 8C F2 CD BA 87 03 54 27 3D 13 A7 9B 6A 05\n\nC7 02 30 21 05 67 58 3B E6 A1 44 0A 37 16 3C 86 E9 BC 8B 20 1A 98 7E 28 E6 7F F7 CA F7 9E 38 31\n\n7F F0 2F 93 11 2B 28 F0 FF 11 B7 FC 1C 63 86 CB\n\nThis sub key is used for encrypting and decrypting to send and receive data.\n\n**4.3.5** **Network control instruction**\n\nIn the analysis of Solaris samples, we found its function is less than Windows sample\n\norders. There are only seven instructions on Solaris whose function is roughly the same as\n\nWindows. Here is the comparison of IDA on two platforms. It can be seen that the\n\ninstructions of the samples on Solaris is much less and easier than that on Windows.\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**28**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**Figure 18 Comparison of network instruction on Windows and Solaris**\n\nAfter analysis, we found that the Solaris sample instruction function is not implemented\n\nabove. At first, we thought that the instruction function of Solaris sample has not yet been\n\ncompleted, but after further analysis, we found that Solaris samples use a special kind of\n\ndynamic calculation to jump to a different branch instruction code, the red part below is the\n\njump instruction after dynamic calculation.\n\n**Figure 19 Solaris Branch instruction function**\n\nThe functions of Solaris instructions are described as below, which is generally the same\n\nas Windows instructions:\n\n**Hexadecimal** **Command function**\n**instruction code**\n\n0x42 Clear traces of infection, delete itself\n\n0x4A Create a file\n\n0x44 Written in file\n\n0x56 Execute file\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**29**\n\n|Hexadecimal instruction code|Command function|\n|---|---|\n|0x42|Clear traces of infection, delete itself|\n|0x4A|Create a file|\n|0x44|Written in file|\n|0x56|Execute file|\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n0x4B Return read file\n\n0x60 Collect various information and return (specific format see chart below)\n\n0x70 Update sample configuration information\n\n0x75 Update sample SLEEP time and collect information and return\n\n0x76 Update C&C server address\n\nThe download executable samples are the same as Windows, use the same instruction\n\ntag through three steps (create, write, execute) to complete the download and execution\n\nfunction, which is different only in code structure. Solaris integrates three instructions to a\n\nfunction.\n\nWhen executing file, escalate privilege of file first, then use the excele function with\n\nparameter executable files,\n\nParameter 1:file B path\n\nParameter 2:file B or \"sendmail\"(relates to mails suspected)\n\nParameter 3:0\n\nParameter 4:PATH=%PATH% (environment variable)\n\nFor instance: execle(\"/usr/bin/sample\",\"sample\", NULL, %envp%);\n\n**Figure 20 Executable file parameter**\n\nThe instruction function and packet format of Solaris samples is the same as Windows\n\nsamples, the full explanation of instruction function and packet format are in section 3.5.6:\n\nanalysis of instructions of Windows samples.\n\nThe collected system information of Solaris samples is slightly different from that of\n\nWindows, as follows:\n\nComputer name HostID MAC address IP address User name Typically user's\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**30**\n\n|0x4B|Return read file|\n|---|---|\n|0x60|Collect various information and return (specific format see chart below)|\n|0x70|Update sample configuration information|\n|0x75|Update sample SLEEP time and collect information and return|\n|0x76|Update C&C server address|\n\n|Computer name|HostID|MAC address|IP address|User name|Typically user's|\n|---|---|---|---|---|---|\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\nfull name\n\nUser UID/GID System hardware System Default Current System process\n\nstructure detailed time Language types running path information\n\ninformation\n\n### 5 Summary\n\n#### 5.1 Improvement based on real threats\n\nOur disclosures of great attack organizations' capabilities that cover all functional\n\nplatforms proved to be a real threat not fictitious.\n\nThe complicated techniques of attack load, precise design depth and comprehensive\n\nenvironment covering platform have shown the technical capabilities of Equation attacks.\n\nThe persistent attacks targeting at various certain goals also embody the attackers’ firmly\n\nattacking intention. In previous studies, Antiy defined the organizations that equipped with\n\nthis kind of ability as A[2]PT and summarized many characteristics of similar attacks from\n\nmalware payload perspective. These standards are conforming to the behavior and ability of\n\nEquations.\n\n**A[2]PT characteristic by Antiy** **Equations implementation and working**\n**characteristic**\n\nSufficient 0day reserve Fanny exploits LNK 0day, MS09-025\n\nHighly complex and modular load Highly complex, modular EquationDrug and\n\nGragFish attack component\n\nLocal encryption block analysis, Configuration data resources encryption,\n\nstrictly encrypt communication and Registry, network communication encryption\n\ncamouflage\n\nMultiple implant ways Network intrusion\n\nLogistics hijack (maybe)\n\nPersonnel on-site implant(maybe)\n\nBasically complete the carrier Bootkit start\n\ntechnology Without file and memory Registry stores samples, Segmented decryption\n\nsegment block analysis\n\nPersist to expand depth (firmware), Hard drive firmware changes\n\nbreadth (firewall, mail gateway, Firewall and other network security devices implant\n\nlateral movement in Lan) Persistence targeted at mail server\n\nCompletely cover all operating Windows, Linux, Solaris and OS X samples\n\nsystem platforms (including mobile)\n\nAs we have previously outlined, the related attack organizations own \" organic network\n\n**attack teams and huge supporting engineering system and structured attack arsenal,**\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**31**\n\n|Col1|Col2|Col3|Col4|Col5|full name|\n|---|---|---|---|---|---|\n|User UID/GID|System hardware structure information|System detailed time|Default Language types|Current running path|System process information|\n\n|A2PT characteristic by Antiy|Equations implementation and working characteristic|\n|---|---|\n|Sufficient 0day reserve|Fanny exploits LNK 0day, MS09-025|\n|Highly complex and modular load|Highly complex, modular EquationDrug and GragFish attack component|\n|Local encryption block analysis, strictly encrypt communication and camouflage|Configuration data resources encryption, Registry, network communication encryption|\n|Multiple implant ways|Network intrusion Logistics hijack (maybe) Personnel on-site implant(maybe)|\n|Basically complete the carrier technology Without file and memory segment block analysis|Bootkit start Registry stores samples, Segmented decryption|\n|Persist to expand depth (firmware), breadth (firewall, mail gateway, lateral movement in Lan)|Hard drive firmware changes Firewall and other network security devices implant Persistence targeted at mail server|\n|Completely cover all operating system platforms (including mobile)|Windows, Linux, Solaris and OS X samples|\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n**powerful vulnerability collection and analysis and exploration capacity, and associated**\n\n**resources reserves, as well as systematic operation procedures and manuals, with**\n\n**features as equipment system covering the whole situation, exploitation tools and**\n\n**malicious code that covers the whole platform, persistent ability covering the whole link.**\n\nIn face of such systematic, industrial-strength and highly targeted attacks, perpetual motion\n\nmust be stop and silver bullet misfiring. Only a clear strategy, full cost investment, defense\n\nagainst systematic **[[11]] attacks, through long-term, solid hard work and ability construction**\n\ncan gradually achieve the initiative.\n\nIn some domestic reports about Equation, they read the persistent implant targeting at\n\nfirmware in high-value targets as that all the current hard disk owns backdoor, which is a\n\nmisunderstanding. However, when an organization’s ability is big enough and only can be\n\nspeculated and imaged, it can cause panic, which results in the query of \"abuse of supply\n\nchain and information chain advantage\".\n\n#### 5.2 Antiy’s efforts\n\nStarting from 2010, Antiy successively analyzed the advanced attacks or attack organizations\n\nas \" Stuxnet\", \"Duqu\", \"Flame\", \"APT - TOCS (Lotus) \", \"White Elephant\", \" Ukraine Power\n\nOutage\", etc., and release hundreds of pages analysis reports accumulatively. There is no doubt\n\nthat the ability of advanced threat detection products is relying on solid and effective analysis with\n\ncontinuously improvement. Antiy released product systems for advanced threat detection and\n\nsituational awareness: **PTD** (Persistent Threat Detection System) can help users capture the\n\nnetwork load and lateral movement; IEP (Intelligent Endpoint Protection System) provide multiple\n\ndefense strategies including “Whitelist + Security baseline”, PTA (Persistent Threat Analysis\n\nSystem) provides the ability to deeply analyze threat payload through dynamic and static methods.\n\nAntiy also plays an important role in situational awareness and early warning platforms of\n\nmultiple industries and departments with overall design support, development and key detection\n\nability.\n\nAntiy focuses on the next generation threat detection engine, highly customized in-depth\n\n**analysis, interactive visual analysis and knowledge and intelligence support targeted at**\n\n**assets and threats.**\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**32**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n#### 5.3 Future work\n\nThe great attack organizations’ coverage ability has triggered a concern of security that “All\n\ncannot be trusted” for all global users. Last year, some domestic reports on Equation interpreted\n\nthe actions that attackers inject and achieve persistence in hard drive firmware of high-value target,\n\nand concluded hard drive with backdoors is the current mainstream. It is of course a\n\nmisunderstanding, but we must say that when the ability of a super attack organization is o strong\n\nthat we can only imagine and speculate it. This situation must lead to the mass panic. Therefore,\n\nthe question on superpower to “abuse of supply chain and information flow advantage” comes out.\n\nThe recent leakage of Equations code and exposure of ANT equipped system enable us to\n\nbelieve that relevant reserves of exploits and attack mentality have flowed into network crime, and\n\neven terrorist organizations. Due to the low reproduction cost of existing network attack\n\ntechnology, there exist more serious cyber arms proliferation risks. Therefore, if superpowers can\n\nreasonably control their arms development speed and scale of network and effectively prevent and\n\ncontrol network arms proliferation that caused by lack of responsibility are the key factors to reach\n\na more secure network.\n\nWe are looking forward to a more secure network world!\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**33**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n### Appendix 1: References\n\n[1] Equation Group Cyber Weapons Auction - Invitation\n\n[https://github.com/theshadowbrokers/EQGRP-AUCTION](https://github.com/theshadowbrokers/EQGRP-AUCTION)\n\n[2] Shadow Brokers reveals list of Servers Hacked by the NSA\n\nhttp://thehackernews.com/2016/10/nsa-shadow-brokers-hacking.html\n\n[3] Antiy The Trojan modifying firmware Exploration in attack components of Equation Group\n\n[http://www.antiy.com/response/EQUATION_ANTIY_REPORT.html](http://www.antiy.com/response/EQUATION_ANTIY_REPORT.html)\n\n[4] Antiy Analysis of encryption skills used in Equation Group attack components\n\n[http://www.antiy.com/response/Equation_part_of_the_component_analysis_of_cryptographic_t](http://www.antiy.com/response/Equation_part_of_the_component_analysis_of_cryptographic_techniques.html)\n\n[echniques.html](http://www.antiy.com/response/Equation_part_of_the_component_analysis_of_cryptographic_techniques.html)\n\n[5] Kaspersky：Equation: The Death Star of Malware Galaxy\n\n[http://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/](http://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/)\n\n[6] Kaspersky：A Fanny Equation: \"I am your father, Stuxnet\"\n\n[http://securelist.com/blog/research/68787/a-fanny-equation-i-am-your-father-stuxnet/](http://securelist.com/blog/research/68787/a-fanny-equation-i-am-your-father-stuxnet/)\n\n[7] Kaspersky：Equation Group: from Houston with love\n\n[http://securelist.com/blog/research/68877/equation-group-from-houston-with-love/](http://securelist.com/blog/research/68877/equation-group-from-houston-with-love/)\n\n[8] Kaspersky：Equation group questions and answers\n\n[https://securelist.com/files/2015/02/Equation_group_questions_and_answers.pdf](https://securelist.com/files/2015/02/Equation_group_questions_and_answers.pdf)\n\n[9] The SPARC Architecture\n\n[https://en.wikipedia.org/wiki/SPARC](https://en.wikipedia.org/wiki/SPARC)\n\n[10] The Solaris System\n\n[https://en.wikipedia.org/wiki/Solaris_(operating_system)](https://en.wikipedia.org/wiki/Solaris_(operating_system))\n\n[11] Huang Sheng: Thoughts on Network Defense in Depth\n\n[http://www.antiy.com/wtc/2015/02_Joe.pdf](http://www.antiy.com/wtc/2015/02_Joe.pdf)\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**34**\n\n\n-----\n\n**Revealing the multi platform operational capability of Equation Group**\n\n### Appendix 2：About Antiy\n\nStarting from antivirus engine research and development team, Antiy now has developed\n\ninto a group level security enterprise with Antiy Labs as headquarters and both enterprise\n\nsecurity company and mobile security company as two wings. Antiy always adheres to the\n\nbelief of securing and protecting user value and advocates independent research and\n\ninnovation, forming the layout of the capacity of the whole chain in the following aspects:\n\nsecurity detection engine, mobile security, network protocol reduction analysis, dynamic\n\nanalysis, terminal protection, and virtualization security and so on. Antiy has fostered\n\nnationwide detection and monitoring capability with our products and services covering\n\nmultiple countries. With effective combination of techniques and products of both big data\n\nanalysis and security visualization, Antiy expands the group work competence of engineers\n\nand shortens the product response cycle by massive automation sample analysis platform.\n\nWith years’ continual accumulation of massive security threat knowledge library, Antiy\n\npromotes the solution of situational awareness and monitoring and early warning that targets\n\nagainst APT and at scale network and critical infrastructure, combining with the experience\n\nof integrated application of big data analysis and security visualization.\n\nMore than 30 famous security vendors and IT vendors select Antiy as their partner of\n\ndetection capability. The antivirus engine of Antiy has provided security protection for nearly\n\na hundred thousand network devices and security devices and nearly two hundred million\n\nmobile phones. The mobile detection engine of Antiy was the first Chinses product that won\n\nAV-TEST reward in the world. The technical strength of Antiy has been recognized by\n\nindustry management organizations, customers and partners. Antiy has consecutively been\n\nawarded the qualification of national security emergency support unit four times and one of\n\nthe six of CNNVD first-level support units. Antiy is the significant enterprise node of China\n\nemergency response system, which has provided alarms, in-depth analysis or systematic\n\nsolution in a few severe security incidents, such as Code Red, Dvldr, Stuxnet, Bash Shellcode,\n\nSandworm, and Equation and so on.\n\n_More information about Antiy Labs:_ _[http://www.antiy.com（Chinese）](http://www.antiy.com/)_\n\n_[http://www.antiy.net](http://www.antiy.net/)_ （English）\n\n_More information about enterprise security company:_ _[http://www.antiy.cn](http://www.antiy.cn/)_\n\n_More information about Antiy AVL TEAM:_ _[http://www.avlsec.com](http://www.avlsec.com/)_\n\n**© Antiy Labs.** **All rights reserved, welcome to non-destructive reprint.**\n\n**35**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.antiy.com/response/FROM_EQUATION_TO_EQUATIONS.pdf"
    ],
    "report_names": [
        "FROM_EQUATION_TO_EQUATIONS.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4f7cf97-9c98-409c-8b95-b80d14c576a5",
            "created_at": "2022-10-25T16:07:24.561104Z",
            "updated_at": "2025-03-27T02:02:10.281202Z",
            "deleted_at": null,
            "main_name": "Shadow Brokers",
            "aliases": [],
            "source_name": "ETDA:Shadow Brokers",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08623296-52be-4977-8622-50efda44e9cc",
            "created_at": "2023-01-06T13:46:38.549387Z",
            "updated_at": "2025-03-27T02:00:02.859535Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "Tilded Team",
                "EQGRP",
                "G0020"
            ],
            "source_name": "MISPGALAXY:Equation Group",
            "tools": [
                "EquationLaser",
                "EquationDrug",
                "DoubleFantasy",
                "TripleFantasy",
                "GrayFish"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "171b85f2-8f6f-46c0-92e0-c591f61ea167",
            "created_at": "2023-01-06T13:46:38.830188Z",
            "updated_at": "2025-03-27T02:00:02.929729Z",
            "deleted_at": null,
            "main_name": "The Shadow Brokers",
            "aliases": [
                "Shadow Brokers",
                "ShadowBrokers",
                "The ShadowBrokers",
                "TSB"
            ],
            "source_name": "MISPGALAXY:The Shadow Brokers",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2d9fbbd7-e4c3-40e5-b751-27af27c8610b",
            "created_at": "2024-05-01T02:03:08.144214Z",
            "updated_at": "2025-03-27T02:05:17.419705Z",
            "deleted_at": null,
            "main_name": "PLATINUM COLONY",
            "aliases": [
                "Equation Group "
            ],
            "source_name": "Secureworks:PLATINUM COLONY",
            "tools": [
                " EquationDrug",
                " EquationLaser",
                " Fanny",
                " GrayFish",
                " TripleFantasy",
                "DoubleFantasy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e0fed6e6-a593-4041-80ef-694261825937",
            "created_at": "2022-10-25T16:07:23.593572Z",
            "updated_at": "2025-03-27T02:02:09.879892Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "APT-C-40",
                "Platinum Colony",
                "Tilded Team"
            ],
            "source_name": "ETDA:Equation Group",
            "tools": [
                "Bvp47",
                "DEMENTIAWHEEL",
                "DOUBLEFANTASY",
                "DanderSpritz",
                "DarkPulsar",
                "DoubleFantasy",
                "DoubleFeature",
                "DoublePulsar",
                "Duqu",
                "EQUATIONDRUG",
                "EQUATIONLASER",
                "EQUESTRE",
                "Flamer",
                "GRAYFISH",
                "GROK",
                "OddJob",
                "Plexor",
                "Prax",
                "Regin",
                "Skywiper",
                "TRIPLEFANTASY",
                "Tilded",
                "UNITEDRAKE",
                "WarriorPride",
                "sKyWIper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1482915393,
    "ts_modification_date": 1482915393,
    "files": {
        "pdf": "https://archive.orkl.eu/b753e38856e8d51ab8b6833481038af247fc52ce.pdf",
        "text": "https://archive.orkl.eu/b753e38856e8d51ab8b6833481038af247fc52ce.txt",
        "img": "https://archive.orkl.eu/b753e38856e8d51ab8b6833481038af247fc52ce.jpg"
    }
}