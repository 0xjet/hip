{
    "id": "02cfe96a-afcf-428c-a495-12a268c9935d",
    "created_at": "2023-01-12T15:05:30.447135Z",
    "updated_at": "2025-03-27T02:05:37.942177Z",
    "deleted_at": null,
    "sha1_hash": "4ba49b849da09bbe10da13500f458dbb0ce8b9ed",
    "title": "2021-09-10 - Rendering Threats- A Network Perspective",
    "authors": "",
    "file_creation_date": "2022-05-28T19:41:15Z",
    "file_modification_date": "2022-05-28T19:41:15Z",
    "file_size": 657551,
    "plain_text": "# Rendering Threats: A Network Perspective\n\n**[blog.gigamon.com/2021/09/10/rendering-threats-a-network-perspective/](https://blog.gigamon.com/2021/09/10/rendering-threats-a-network-perspective/)**\n\n[Home »](https://blog.gigamon.com/) [Threat Research » Rendering Threats: A Network Perspective](https://blog.gigamon.com/category/threat-research/)\n\n[Threat Research / September 10, 2021](https://blog.gigamon.com/category/threat-research/)\n\n[Joe Slowik &nbsp](https://blog.gigamon.com/author/joeslowik/)\n\n## Background\n\n\nSeptember 10, 2021\n\n\nOn September 7, 2021, following a long holiday weekend in the U.S., Microsoft disclosed a\nremote code execution vulnerability, [CVE-2021-40444. Discovered by researchers from](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444)\nseveral organizations, the vulnerability leverages flaws in the MSHTML application, present\nin all Microsoft Windows installations, to achieve code execution. At the time of this writing,\nsecurity researchers from several organizations identified active exploitation of this\nvulnerability, potentially as early as mid-August 2021, via a chain of events started through\nspecially crafted Microsoft Office documents.\n\n## Identified Behaviors\n\nMultiple researchers identified what appears to be a single campaign from mid-August 2021\nthrough early September 2021 leveraging CVE-2021-40444 against multiple victims. While\nprecise victimology is unknown, limited evidence indicates potential use against entities in\nNorth America, Europe, and Asia. Intrusion operations begin through the delivery of a\nphishing document — exactly how the document is delivered is unknown at present — such\nas the following item:\n\n\n-----\n\nWhile the document loads, Microsoft Office attempts to retrieve a remote object referenced in\na component of the document file, such as the following:\n\nThe HTML object retrieved contains obfuscated JavaScript code that the MSHTML engine\nrenders as though it were a webpage. Although helpful in evading detections and defenses,\nthe obfuscation is unnecessary as the MSHTML application will render the underlying code\n\n\n-----\n\nirrespective of hardening. The following shows a portion of the malicious code:\n\nWhen executed, the scripting content retrieves another file with an .inf extension that is\nactually a malicious DLL file. The extension–file type mismatch is likely used to evade\ndefensive checks for downloading portable executable file types. Once executed, the DLL\nestablishes command and control (C2) communication, allowing the unknown adversary to\naccess the exploited victim.\n\nThe above represents only preliminary analysis of a campaign that appears to still be in\nprogress. While additional details on this activity will almost certainly emerge over the\ncoming days and weeks, sufficient information exists to analyze this exploit for defensive\npurposes.\n\n## Network Detection Opportunities\n\nAt first glance, the above operations appear heavily weighted toward host-based detection\nmethodologies and possibly phishing or malicious email defenses. While these assessments\nare valid and will likely receive significant attention as the security community further\nexamines the vulnerability and the resulting campaign, there are defensive alternatives. As\n[previously discussed with respect to ransomware operations, information security](https://blog.gigamon.com/2021/05/17/tracking-darkside-and-ransomware-the-network-view/)\n\n\n-----\n\npractitioners must aim to identify and defeat malicious behavior across host and network\nperspectives, fusing insights from each into a complete picture, to compete against modern\nthreat actors.\n\nWhile much remains unknown concerning both who is responsible and for what purpose, the\ncurrent campaign underscores the need to take this blended defensive approach. This\nbegins at the very first moments of malicious action on a victim’s machine: the retrieval of a\n[remote object via Microsoft Office. Similar to template injection behaviors, the malicious](https://attack.mitre.org/techniques/T1221/)\ndocument can only serve its desired function and purpose if it can retrieve and render the\nremotely hosted scripting object. This critical dependency provides defenders with their first\nopportunity for detection, if not outright mitigation.\n\nWhen retrieving a remote object via a Microsoft Office program, default Windows behavior\nemploys a User Agent string value reflecting the application. In the case of this activity, initial\nretrieval results in traffic similar to the following two observations:\n\nSearching for instances of Office-based User Agents engaging in anomalous or suspicious\nactivity can serve as a powerful detection for initial actions on target. Observations that can\nbe joined with this for higher confidence include:\n\nTraffic to new, previously unobserved network locations\nEnriching network location activity (such as the domain) to identify suspicious hosting\nor other patterns\nAnalysis of traffic and response to identify the obfuscated JavaScript code returned,\nespecially since the traffic in this instance is unencrypted\n\nThe above observations can be combined with host-based detections to further refine\nmatters, identifying such aspects as where files are written and follow-on program execution\nby looking at child processes from Microsoft Office.\n\n\n-----\n\nFollowing script execution, the adversary designed the script to retrieve and launch a DLL\nwith a mismatched file extension. This again presents an opportunity for detection and\nwarning, seeing the difference between the content retrieved (a portable executable file type)\nand the content as labeled (using the .inf extension). Again, paired with host observations,\neven more powerful conclusions can be reached, aligning the simple masquerade in the\npayload retrieval with follow-on execution as a DLL on the victim machine.\n\nFinally, C2 behaviors after DLL execution can identify an intrusion in progress. One of the\nmost direct, and network-specific, ways of doing so is through identifying a new, not\npreviously seen domain in network traffic. This observation can be further enriched by\n[treating the domain as a composite object and identifying suspicious characteristics in terms](https://www.domaintools.com/resources/blog/analyzing-network-infrastructure-as-composite-objects)\nof domain registrar, network hosting, and relative domain recency (registered in late August\n2021, for example), as seen in the following information from DomainTools:\n\nBy examining precisely how this intrusion unfolds, defenders can identify multiple possible\ndetection points for this campaign. Yet, while that is desirable, such actions can seem\nconsistently backward looking, as they chase known, analyzed behaviors as opposed to\nnewly observed activity. Such concerns are magnified in the case of zero-day actions, where\nadversary tradecraft predates defender awareness.\n\n## Enabling Defense Against Unknown Threat Vectors\n\n\n-----\n\nCloser examination of the defensive strategies in the previous section identifies something\ninteresting: While the root cause of exploitation and intrusion activity remains a “net new”\nbehavior, all surrounding observations and adversary techniques either align with known\ntradecraft or display sufficient anomalous characteristics to allow for detection. As previously\n[discussed, when evaluating anomalies in network defense, fundamental understanding of](https://blog.gigamon.com/2021/07/27/ghosts-on-the-wire-expanding-conceptions-of-network-anomalies/)\nnetworks, their expected or typical behavior, and useful diversions from these norms for\nadversary activities opens space for powerful defensive possibilities.\n\nIn the case of the MSHTML exploitation activity above, our specific defensive guidance\neasily translates into more general security advice:\n\nLeverage identification of applications in network traffic to flag strange or risky\nbehaviors relevant to the originating application\nUse content analysis and similar methodologies to determine when potentially\nmalicious objects are retrieved while employing some degree of obfuscation or\nevasion, whether at the content level (such as obfuscated JavaScript) or metadata\n(such as file type-to-extension mismatches)\nAggressively question newly observed network infrastructure communicating with the\ndefended network and place such communications in context to identify potential\nmalicious activity\n\nBy adopting these mechanisms, among a host of other behavior-centric strategies,\ndefenders can place themselves ahead of potential intrusions through identification of\nadversary dependencies or commonalities. Even when a threat actor deploys a new,\npreviously unobserved technique (such as the MSHTML exploit in this campaign),\nunderstanding linked dependencies, delivery mechanisms, and C2 requirements allows for\ndetection even under the most difficult circumstances.\n\n## Conclusion\n\nThe recently disclosed campaign leveraging a then-zero-day exploit in MSHTML retains a\nnumber of unknowns. The community of network defenders still does not know what entity is\nresponsible for this activity, for what purpose the campaign was conducted, and (perhaps\nmost significantly) if other threat actors have leveraged the same vulnerability for additional\ncampaigns. While these all are worrying thoughts, a thorough examination of defensive\npossibilities identifies various potential avenues for detection and defensive response.\n\nBy understanding how specific adversary tradecraft relates to the broader “kill chain” of the\nintrusion lifecycle, defenders can layer detections in such a fashion that even novel\ntechniques are revealed through their relationship with more mundane behaviors. Defenders\nmust continuously adapt detections and alarms across all phases of adversary operations to\nensure that this latent defensive advantage is claimed and utilized, severely limiting would-be\nintruders from achieving their objectives. As such, adopting a detection and defense\n\n\n-----\n\nmethodology that embraces all phases of visibility and operation — including network-centric\nidentification and analysis — is a necessary prerequisite to meeting the challenge of modern,\nagile adversaries.\n\n## Indicators of Compromise\n\n**Identified Malicious Domains**\n\npawevi[.]com\n\ndodefoh[.]com\n\nhidusi[.]com\n\nmacuwuf[.]com\n\njoxinu[.]com\n\n**Identified Malicious IP Addresses**\n\n45.153.241[.]127\n\n45.153.240[.]220\n\n45.147.229[.]242\n\n23.106.160[.]25\n\n108.62.118[.]69\n\n**Identified Malicious Documents**\n\n199b9e9a7533431731fbb08ff19d437de1de6533f3ebbffc1e13eeffaa4fd455\n\n5b85dbe49b8bc1e65e01414a0508329dc41dc13c92c08a4f14c71e3044b06185\n\n938545f7bbe40738908a95da8cdeabb2a11ce2ca36b0f6a74deda9378d380a52\n\na5f55361eff96ff070818640d417d2c822f9ae1cdd7e8fa0db943f37f6494db9\n\n3bddb2e1a85a9e06b9f9021ad301fdcde33e197225ae1676b8c6d0b416193ecf\n\n**Identified DLLs**\n\n3834f6a04b0a9cca41653967e46934932089adaa4de23ff5cfeecdd0e9258e72\n\n6eedf45cb91f6762de4e35e36bcb03e5ad60ce9ac5a08caeb7eda035cd74762b\n\nbd4b9f4b79f8a9eedc12abe3919cecb041c61022485b87b3a5cdfd1891e30670\n\n\n-----\n\ncb091dbfd10645ba4ebf06d272e98cd98a2359bc0a0e115bf1ae6ad0073461e0\n\n**Featured Webinars**\n\n[Hear from our experts on the latest trends and best practices to optimize your network](https://www.gigamon.com/resources/resource-library/webinar-hub.html?intcid=blog)\nvisibility and analysis.\n\nCONTINUE THE DISCUSSION\n\nPeople are talking about this in the Gigamon Community’s [Security group.](https://community.gigamon.com/gigamoncp/s/group/0F91O0000009cNHSAY/security)\n\n**Share your thoughts today**\n\n[NDR Resource](https://blog.gigamon.com/tag/ndr-resource/)\n\n## RELATED CONTENT\n\nREPORT\n\n2022 Ransomware Defense Report\n\nGET YOUR COPY\n\nWEBINAR\n\nThreatINSIGHT: Eliminating Adversaries’ Dwell Time Advantage\n\nWATCH ON DEMAND\n\nWEBINAR\n\nDeep Dive INSIGHTS: Fighting Ransomware and Shifting Security Priorities\n\nWATCH ON DEMAND\n\n\n-----\n\nREPORT\n\nGigamon ThreatINSIGHT Guided-SaaS Network Detection and Response\n\nGET YOUR COPY\n\nOLDER ARTICLE\n\nHow SOCs Are Working Alone, Distracted, and in the Dark — and What to Do About It: A\nThree-Part Webinar Series\nNEWER ARTICLE\n\nPartner Spotlight: Gigamon and ICM Cyber Help Customers Secure Their Data and\nNetworks\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-10 - Rendering Threats- A Network Perspective.pdf"
    ],
    "report_names": [
        "2021-09-10 - Rendering Threats- A Network Perspective.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535930,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1653766875,
    "ts_modification_date": 1653766875,
    "files": {
        "pdf": "https://archive.orkl.eu/4ba49b849da09bbe10da13500f458dbb0ce8b9ed.pdf",
        "text": "https://archive.orkl.eu/4ba49b849da09bbe10da13500f458dbb0ce8b9ed.txt",
        "img": "https://archive.orkl.eu/4ba49b849da09bbe10da13500f458dbb0ce8b9ed.jpg"
    }
}