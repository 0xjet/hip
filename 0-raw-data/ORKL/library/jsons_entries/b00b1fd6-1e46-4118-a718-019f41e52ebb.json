{
    "id": "b00b1fd6-1e46-4118-a718-019f41e52ebb",
    "created_at": "2023-01-12T15:06:45.428134Z",
    "updated_at": "2025-03-27T02:14:34.125544Z",
    "deleted_at": null,
    "sha1_hash": "95a2ee0a4baf36ff475e3c2eaa58b6d603474cae",
    "title": "2020-06-19 - The eagle eye is back- old and new backdoors from APT30",
    "authors": "",
    "file_creation_date": "2022-05-29T01:17:08Z",
    "file_modification_date": "2022-05-29T01:17:08Z",
    "file_size": 1518675,
    "plain_text": "# The eagle eye is back: old and new backdoors from APT30\n\n**[ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/eagle-eye-is-back-apt30/](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/eagle-eye-is-back-apt30/)**\n\nPositive Technologies\n\n\n-----\n\nOn April 8, 2020, our pros at the PT Expert Security Center detected signs of life from a wellknown cybercriminal group. Network signatures for dynamic malware analysis on a popular\nsite lit up for APT30—a group that had not been on radar screens for some time. This\ninspired us to start looking.\n\nNetwork\n\nsignatures indicated APT30 activity\n[APT30 has been in the public eye since a report by our colleagues at FireEye back in 2015.](https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf)\nThe group primarily attacks government targets in South and Southeast Asia (including India,\nThailand, and Malaysia) for cyberespionage purposes. Their toolkit has been in development\nsince at least 2005. We find it interesting that we see both old and well-known tools dating\nback over a decade, as well as continuity in network resources.\n\nIn this article, we will look at new versions of already known Trojans, the features of the\ngroup's recently detected malware, and network infrastructure.\n\n## BACKSPACE and NETEAGLE backdoors\n\n\n-----\n\n[A file named AGENDA.scr from Malaysia was uploaded to VirusTotal on August 25, 2019](https://www.virustotal.com/gui/file/9f58d4e7170b0fe3df1d332b37e4cf9a114da8ef42b19a300f15868b0583d0de/detection)\n(MD5: f4f8f64fd66a62fc456da00dd25def0d). This is an executable PE file for x86 packed\nwith UPX. The icon of the sample matches that of a Microsoft Office document (in order to\nfool users, of course). The resources contain another two encrypted objects.\n\nPE file icon and resource objects\n\nBoth objects are decrypted as follows:\n```\nfor i, c in enumerate(buffer):\n  d = c - (i & 0xFF)\n  d ^= 0xEF\n  d &= 0xFF\n  buffer[i] = ((d >> 6) | (d << 2)) & 0xFF\n\n```\nThe first file (MD5: 634e79070ba21e1e8f08aba995c98112) is written to the Microsoft Office\ntemplates folder (%APPDATA%\\Microsoft\\Windows\\Templates\\AGENDA.docx) and then\nrun. This Office document, with the agenda for a Malaysian government meeting, is intended\nto attract the user's interest, of course.\n\n\n-----\n\nContents of the decoy document\nThe document was created on August 2, 2019 by the user Norehan Binti Nordin.\n\nProperties of the\n\ndecoy document\n\n\n-----\n\nThe second file (MD5: 56725556d1ac8a58525ae91b6b02cf2c) is placed in the startup folder\n**%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\WINWORD.EXE. The**\nfile is not run at the time of creation (instead, the attackers arrange for it to run at another\ntime that will be less suspicious, such as after a restart). This is a NETEAGLE backdoor,\nmodifications of which have been detailed in FireEye reporting. Note that the string\n**NetEagle, which was found in in 2015 files and gave its name to the whole malware family,**\nhas now been replaced with JokerPlay.\n\n\"NetEagle\" string in a 2015 sample\n\n\"JokerPlay\" string in a 2019 sample\nWe will not rehash here the FireEye report on the workings of NETEAGLE. In the following\ntable, we have listed strings encrypted with a Caesar cipher having shift –4.\n\nDecrypted strings and their offsets in the NETEAGLE backdoor\n\n**Offset** **String**\n\n0x40b02c msmsgr.exe\n\n0x40b038 msmsgr\n\n0x40b040 pic4.bmp\n\n0x40b04c pic2.bmp\n\n0x40b058 pic1.bmp\n\n0x40b064 http://www.gordeneyes.com/photo/\n\n0x40b1ac SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\n\nBased on these indicators, we uncovered another two backdoors (MD5:\nd9c42dacfae73996ccdab58e429548c0 and MD5: 101bda268bf8277d84b79fe52e25fee4).\nAccording to the compilation date, they were created on October 21, 2019; one of them was\n\n\n-----\n\n[also uploaded to VirusTotal from Malaysia only in May 2020. This malware belongs to the](https://www.virustotal.com/gui/file/a0d3450eebbe0021aaa109fe1bcf3d8f1786c112caf26d2e344a5701e314497a/detection)\nBACKSPACE family, modifications of which have also been described by FireEye. Here we\nwill give decrypted strings for each sample together with the relevant algorithm.\n\nString decryption algorithm in the backdoor with MD5 hash\nd9c42dacfae73996ccdab58e429548c0:\n```\nfor i, c in enumerate(buffer):\n  d = c - i - 7\n  buffer[i] = d & 0xFF\n\n```\nDecrypted strings and their offsets in the BACKSPACE backdoor (MD5:\nd9c42dacfae73996ccdab58e429548c0)\n\n**Offset** **String**\n\n0x40c048 *lecnaC*\n\n0x40c054 Software\\Microsoft\\\\PnpSetup\n\n0x40c070 Mutex_lnkword_little\n\n0x40c088 /b.ini\n\n0x40c090 /a.ini\n\n0x40c098 /a1.ini\n\n0x40c0a0 /l.ini\n\n0x40c0a8 \\WordPlug.exe\n\n0x40c0cc /z.ini\n\n0x40c0d4 \\WINWORD.EXE\n\n0x40c0b8 \\WordForVista.exe\n\n0x40c0e4 /d.jpg\n\n0x40c0ec /l.jpg\n\n0x40c0f4 www.kabadefender.com\n\n0x40c10c www.gordeneyes.com\n\n0x40c120 /LGroup1\n\n\n-----\n\nString decryption algorithm in the backdoor with MD5 hash\n101bda268bf8277d84b79fe52e25fee4:\n```\nfor i, c in enumerate(buffer):\n  d = c ^ 0x37\n  d -= i + 27\n  buffer[i] = d & 0xFF\n\n```\nDecrypted strings and their offsets in the BACKSPACE backdoor (MD5:\n101bda268bf8277d84b79fe52e25fee4)\n\n**Offset** **String**\n\n0x41104c Compumter\n\n0x411058 *lecnaC*\n\n0x411064 Software\\Microsoft\\Core\n\n0x41107c Mutex_lnkch\n\n0x411088 Event__lnkch__end\n\n0x41109c Event__lnkch__ended\n\n0x4110b0 EventAck__lnkch\n\n0x4110c0 /b.ini\n\n0x4110c8 /c.ini\n\n0x4110d0 /a.ini\n\n0x4110d8 /a1.ini\n\n0x4110e0 /l.ini\n\n0x4110e8 /k.txt\n\n0x4110f0 /l1.ini\n\n0x4110f8 /b1.ini\n\n0x411100 /c1.ini\n\n0x41110f www.gordeneyes.com\n\n0x41118f www.kabadefender.com\n\n\n-----\n\n**Offset** **String**\n\n0x41120f chrome.exe\n\n0x41128f /group1\n\n0x41130f /d.jpg\n\n0x41138f /l.jpg\n\n0x411408 System Idle Process\n\n0x41141c \\t.ini\n\n0x411424 \\t.exe\n\n0x41142c \\ue.exe\n\n0x411434 \\ue1.exe\n\n0x411440 Chrome\\BIN\n\n0x41144c chrome.lnk\n\n0x411458 Google Chrome\n\n0x411490 /n09230945.asp\n\n0x4114a0 automation.whatismyip.c\\xffm\n\n0x4114c8 hideipexcept=\n\n0x4114d8 hideip=\n\n0x4114e0 hidehostexcept=\n\n0x4114f0 hidehost=\n\n0x4114fc hidedirexcept=\n\n0x41150c hidedir=\n\n0x411518 hidewebexcept=\n\n0x411528 hideweb=\n\n0x411534 hideall=1\n\n0x411540 killpath=\n\n0x41154c /some/edih.txt\n\n0x41155c www.appsecnic.com\n\n\n-----\n\n**Offset** **String**\n\n0x411570 www.km153.com\n\n0x411580 www.newpresses.com\n\n0x41159c runipexcept=\n\n0x4115bc runhostexcept=\n\n0x4115cc runhost=\n\n0x4115d8 rundirexcept=\n\n0x4115e8 runwebexcept=\n\n0x4115f8 runall=1\n\n0x411604 /http/nur.txt\n\nSome of the strings in the backdoor with MD5 hash 101bda268bf8277d84b79fe52e25fee4\nare encrypted with the same algorithm as the resources in the NETEAGLE dropper. Only the\nvalues of constants have been changed.\n\nBesides tools belonging to already known malware families, we also detected several novel\nsamples. We will go into these in more detail.\n\n## RHttpCtrl backdoor\n\nMD5: ed09b0dba74bf68ec381031e2faf4448\n\nThis is an x86 executable PE file with valid compilation date:\n\nCompilation\n\ndate of the RHttpCtrl sample\nThere is a nugget of debugging information inside, in the project path:\n\n\n-----\n\n```\nD:\\WorkSources\\RHttpCtrl\\Server\\Release\\svchost.pdb\n\n```\nIt appears that the substring \"RHttpCtrl\" is the name given to the tool by the attackers\nthemselves.\n\nThe malware starts off by trying to extract the value of the random key of the registry branch\n**HKCU\\Software\\HttpDiv. If that doesn't work, the WinAPI function**\n**GetSystemTimeAsFileTime provides the system time, which is then used as the seed for**\nrandom number generation. The random number is saved in the registry and used later. A\nseparate thread, which will contain the actions described next, is created.\n\nGetSystemTimeAsFileTime API call\nA GET request to hxxp://www.kabadefender.com/plugins/r.exe gives the malware the\nlegitimate unpacker WinRAR (or at least its CLI component, MD5:\n4fdfe014bed72317fa40e4a425350288). After saving WinRAR, the malware takes a\nfingerprint of the system based on the computer's name, IP address, and operating system\nversion. This information is sent by POST request to\n**hxxp://www.kabadefender.com/clntsignin.php.**\n\nSending of the system fingerprint\nSome of the values of the other fields are interesting. The \"1\" in the version field suggests\nthe start of development of this malware family. Practically all calls are logged.\n\n\n-----\n\nLogging\nThe id field remains empty. random contains the random number described already. Note\nthat the User-Agent value specified here is Mozilla/5.0 (Windows NT 6.1; WOW64; rv:34.0)\n**Gecko/20100101 Firefox/34.0.**\n\nIncoming commands are handled by the KernelManager class. Thanks to RTTI, we can\nguess the malware's actions based on the names of the objects.\n\nRTTI object names\n\nThe backdoor's capabilities are narrow:\n\nRHttpCtrl commands and descriptions\n\n\n-----\n\n**Command** **Type** **Description**\n\n0 shell Run command with cmd.exe\n\n3 download Download file from C2 server\n\n4 snap Take and send screenshot\n\n5 upload Upload file to C2 server\n\nHandling for commands 1 and 2 is not present. The REP marker, which is expected for all\ncommands, acts as delimiter between the command number and arguments. The results of\ncommand execution are sent to hxxp://www.kabadefender.com/clntcmd.php with the type\nvalue matching the command in question.\n\n### Command 0: shell\n\nThis command is handled by ShellManager, which creates the process cmd.exe with\ninteraction by means of placing input commands and getting the output. Results are read in\nportions, to which the number of read bytes is added; this is then sent as the value of\n**output.**\n\nCreation of input + output pipes and launch of cmd.exe\n\nWriting of\n\n\n-----\n\ncommands to the input pipe\n\nReading the command output\n\n### Command 3: download\n\nThis command type is handled by the Download component. By means of\n**URLDownloadToFileA, it downloads the additional component at the indicated address from**\nthe command and control (C2) server and writes it to file.\n\nDownloading file from C2 server\n\n### Command 4: snap\n\nThis command type is handled by the Download component. With the help of gdiplus.dll\nAPIs, it takes a screenshot, writes it to file, and sends it to the C2 server.\n\n\n-----\n\nSaving screenshot\n\nto file\n\nSending screenshot to the C2 server\n\n### Command 5: upload\n\nThe Upload component is responsible for handling this command type. With the already\ndownloaded WinRAR utility Rar.exe, the component packs the specified file in an archive\nand sends it to the C2 server.\n\nArchiving a file prior to sending\n\n## RCtrl backdoor\n\n\n-----\n\nMD5: 95fde34187552a2b0b7e3888bfbff802\n\nThis executable PE file for x86 was developed with the MFC library and packed with UPX.\nThe compilation date is plausible:\n\nCompilation\n\ndate of RCtrl sample\nA bit of debugging information is found inside, in the form of the project path:\n```\nD:\\WorkSources\\MyProjects\\RCtrl\\Release\\Server.pdb\n\n```\nAs with RHttpCtrl, we took the backdoor's name from the project name assigned by the\nmalware developers themselves.\n\nFirst, a data buffer of around 200 bytes is created. This buffer acts as configuration file. The\nbuffer is filled in portions, out of sequence, in a way that leaves many fields unused.\n\n\n-----\n\nPartial structure of the configuration file (fields whose\n\nnames start with \"field_\" are not used)\nThe malware performs a single-byte XOR with 0x23 to decrypt the address of the attacker's\nmain C2 server: 103.233.10\\.152. The connection with the server (on TCP port 4433) is\nchecked. If the connection is unsuccessful, the malware uses additional data to obtain a\nworking server address.\n\nThe additional data in question is the addresses hxxp://www.gordeneyes.com/infos/p and\nhxxp://www.techmicrost.com/infos/p, which have been encrypted by means of a single-byte\nXOR with 0x25. Once the two addresses are decoded, the malware attempts to connect to\neach of the two in sequence with a GET request. It expects an 8-byte response from the\nserver, containing the server IP address and port. In following figure, these are\n**172.247.197\\.189 and 443.**\n\n\n-----\n\nGetting\n\nthe C2 address: ‘0xAC 0xF7 0xC5 0xBD’ → ‘172 247 197 189’, ‘0xBB 0x01 0x00 0x00’ →\n0x1BB → 443\nThe attempt to obtain a C2 address by means of these secondary addresses is recorded in\nthe registry under the branch HKCU\\Software\\PickMill by saving the current date in the Y,\nM, and D keys.\n\nRecording the current date in the\n\nregistry\nAfter obtaining a working C2 IP address, the malware re-connects to the server and waits for\nthe string Jo*Po*Hello. This string is encrypted in the body of the malware (single-byte XOR\nwith 0x24). Interestingly, the Trojans tend to initiate data exchange themselves.\n\nWhen a string has been received, the malware creates a system fingerprint based on the OS\nversion, IP address, CPU manufacturer and clock rate, and disk size. This data is encrypted\nwith a unique algorithm based on circular shifts and XOR (more specifically: leftward circular\nshift by 4 + 3 = 7 bits and XOR with 0x23) and sent to the C2 server.\n\n\n-----\n\nEncryption algorithm\n\nThen a separate thread is created to send the same data buffer to the server every 30\nseconds. The buffer is structured as follows:\n\n4100 bytes of memory are allocated.\nThe first byte takes the value 0x25.\nThe remaining bytes are zeros.\nThe result is encrypted with the same algorithm as described already\n\nTherefore, only the first byte will undergo any big changes; the other bytes will equal 0x23,\nso any circular shifts will not affect the zero bytes.\n\nThen control passes to the command handling function, which decrypts the input (using the\ninverse steps to the encryption algorithm) and extracts the command number.\n\nDecryption algorithm\n\nRCtrl commands and descriptions\n\n**Command** **Description**\n\n3 Get disk information\n\n4 Get folder listing\n\n5 Read file\n\n6 Open file for read/write\n\n7 Write to file\n\n8 Run file\n\n\n-----\n\n**Command** **Description**\n\n9 Same as 4\n\n16 Create folder\n\n17 Delete folder contents\n\n18 Delete configuration file\n\n19 Copy file\n\n20 Move file\n\n21 Get file information\n\n22 Read pipe\n\n23 Log result\n\n25 Get process list\n\n32 End process\n\n33 Take screenshot\n\n36 Shut down computer\n\n39 Read clipboard\n\n40 Write to registry\n\n41 Copy file to startup folder\n\nWe will not delve into the implementation of each command, since the techniques used for\neach are atomic and unremarkable. We do note that handling is absent for a variety of\ncommand numbers (1–2, 10–15, 24, 26–31, 34–35, 37–38). Command output is encrypted\n(in the same way) and sent to the C2 server.\n\n## Network infrastructure\n\nThe decrypted strings of one of the fresh BACKSPACE backdoors contain several domains\n(newpresses\\.com, appsecnic\\.com, km153\\.com) used by the group more than 10 years\nago. Highlights of the WHOIS data are given in following table.\n\nWHOIS lookups for newpresses\\.com, appsecnic\\.com, and km153\\.com\n\n**WHOIS field** **newpresses\\.com** **appsecnic\\.com** **km153\\.com**\n\n\n-----\n\n**Name** yuefen che heng cai Zhong yong\n\n**Organization** cheyuefen Trade Client Ministry of\nKunming Telecom,Yunnan\n\n**City** kunming Kun ming\n\n**State** yunnan Yunnan\n\n**Street** SongMingrenmingroad panlongqubeichengzhonglu Yunnan Wenshan\nWenBi lu 241 hao\n\n**Country** CN\n\nWHOIS lookup for\n\nnewpresses\\.com\nA few patterns are obvious: namely, yunnan, kunming, and cheyuefen in different forms.\n\nThe newer domains (gordeneyes\\.com, kabadefender\\.com, techmicrost\\.com) have identical\nfields:\n\n\n-----\n\nRegistrar: Alibaba Cloud Computing (Beijing) Co., Ltd.,\nState: yun nan,\nCountry: CN.\n\nThe value yun nan, of course, is reminiscent of the domains.\n\nASNs for the hosting providers preferred by the group are as follows:\n\nCNSERVERS LLC (40065),\nABCDE GROUP COMPANY LIMITED (133201),\nZenlayer Inc (21859).\n\n## Conclusion\n\nBoth new and modernized tools from APT30 have caught our attention. The group stays true\nto its habits and tools, selectively adding new ones as it pursues its targets. One would be\nhard pressed to call the group's malware extremely well written or skilled at stealth and\nevasion. On the other hand, the targets may not be changing either, so such relatively crude\ntools may still get the job done. We notice that the toolkit is still in progress. Perhaps the\ngroup is testing fresh malware in the field to identify any gaps. We expect to see improved\nversions of RHttpCtrl and RCtrl in the future, likely with added stealth and anti-analysis\ntechniques.\n\n**Author: Alexey Vishnyakov, Positive Technologies**\n\n## IOCs\n\nf4f8f64fd66a62fc456da00dd25def0d [NETEAGLE dropper]\n634e79070ba21e1e8f08aba995c98112 [AGENDA.docx]\n56725556d1ac8a58525ae91b6b02cf2c [NETEAGLE]\nhxxp://www.gordeneyes.com/photo/\nd9c42dacfae73996ccdab58e429548c0 [BACKSPACE]\n101bda268bf8277d84b79fe52e25fee4 [BACKSPACE]\ned09b0dba74bf68ec381031e2faf4448 [RHttpCtrl]\nhxxp://www.kabadefender.com/plugins/r.exe\n4fdfe014bed72317fa40e4a425350288 [WinRAR, Rar.exe]\nhxxp://www.kabadefender.com/clntsignin.php\nkabadefender\\.com\n95fde34187552a2b0b7e3888bfbff802 — [RCtrl]\n103.233.10\\.152:4433\nhxxp://www.gordeneyes.com/infos/p\nhxxp://www.techmicrost.com/infos/p\n172.247.197\\.189:443\ngordeneyes\\.com\n\n\n-----\n\ntechmicrost\\.com\n9cb8a0cb778906c046734fbe67778c61\nc9b1c8b51234265983cf8427592b0a68\nnewpresses\\.com\nkm153\\.com\nappsecnic\\.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-19 - The eagle eye is back- old and new backdoors from APT30.pdf"
    ],
    "report_names": [
        "2020-06-19 - The eagle eye is back- old and new backdoors from APT30.pdf"
    ],
    "threat_actors": [
        {
            "id": "a9ee8219-1882-4b1b-bac8-641b1603787d",
            "created_at": "2022-10-25T15:50:23.78263Z",
            "updated_at": "2025-03-27T02:00:55.545647Z",
            "deleted_at": null,
            "main_name": "APT30",
            "aliases": [
                "APT30"
            ],
            "source_name": "MITRE:APT30",
            "tools": [
                "SHIPSHAPE",
                "FLASHFLOOD",
                "NETEAGLE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "30ed778d-15b3-484e-a90b-e1e05b36a42f",
            "created_at": "2023-01-06T13:46:38.290626Z",
            "updated_at": "2025-03-27T02:00:02.795711Z",
            "deleted_at": null,
            "main_name": "APT30",
            "aliases": [
                "G0013"
            ],
            "source_name": "MISPGALAXY:APT30",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ad154227-6fcf-43c5-a540-0c09534e040f",
            "created_at": "2024-05-01T02:03:07.952927Z",
            "updated_at": "2025-03-27T02:05:17.267077Z",
            "deleted_at": null,
            "main_name": "BRONZE GENEVA",
            "aliases": [
                "BRONZE STERLING ",
                "CTG-5326 ",
                "Naikon ",
                "Override Panda ",
                "APT30 "
            ],
            "source_name": "Secureworks:BRONZE GENEVA",
            "tools": [
                " ShadowPad",
                "Lecna"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536005,
    "ts_updated_at": 1743041674,
    "ts_creation_date": 1653787028,
    "ts_modification_date": 1653787028,
    "files": {
        "pdf": "https://archive.orkl.eu/95a2ee0a4baf36ff475e3c2eaa58b6d603474cae.pdf",
        "text": "https://archive.orkl.eu/95a2ee0a4baf36ff475e3c2eaa58b6d603474cae.txt",
        "img": "https://archive.orkl.eu/95a2ee0a4baf36ff475e3c2eaa58b6d603474cae.jpg"
    }
}