{
    "id": "3c2bce97-de54-4809-9317-08c06bc34947",
    "created_at": "2023-01-12T15:03:01.824651Z",
    "updated_at": "2025-03-27T02:14:13.675299Z",
    "deleted_at": null,
    "sha1_hash": "e751bfb4375e4fc2c448ebf132daffe2564598d8",
    "title": "2022-08-25 - Detecting the Unknown- Revealing Uncategorized Ransomware Using Darktrace",
    "authors": "",
    "file_creation_date": "2022-09-01T10:26:59Z",
    "file_modification_date": "2022-09-01T10:26:59Z",
    "file_size": 887910,
    "plain_text": "# Detecting the Unknown: Revealing Uncategorized Ransomware Using Darktrace\n\n**[de.darktrace.com/blog/detecting-the-unknown-revealing-uncategorised-ransomware-using-darktrace](https://de.darktrace.com/blog/detecting-the-unknown-revealing-uncategorised-ransomware-using-darktrace)**\n\n25\n\nAug 2022\n\n25\n\nAug 2022\n\nUncategorized attacks happen frequently, with new threat groups and malware continually\ncoming to light. Novel and known threat groups alike are changing their C2 domains, file\nhashes and other threat infrastructure, allowing them to avoid detection through traditional\nsignature and rule-based techniques. Zero-day exploitation has also become increasingly\napparent – a recent Mandiant report revealed that the number of identified zero-days in 2021\nhad dramatically increased from 2020 (80 vs 32). More specifically, the number of zero-days\nexploited by ransomware groups was, and continues to be, on an upward trend [1]. This\ntrend appears to have continued into 2022. Given the unknown nature of these attacks, it is\nchallenging to defend against them using traditional signature and rule-based approaches.\nOnly those anomaly-based solutions functioning via deviations from normal behavior in a\nnetwork, will effectively detect these threats.\n\nIt is particularly important that businesses can quickly identify threats like ransomware before\nthe end-goal of encryption is reached. As the variety of ransomware strains increases, so do\nthe number which are uncategorized. Whilst zero-days have recently been explored in\nanother [Darktrace blog, this blog looks at an example of a sophisticated novel ransomware](https://de.darktrace.com/blog/using-self-learning-ai-to-defend-against-zero-day-and-n-day-attacks)\nattack that took place during Summer 2021 which Darktrace DETECT/Network detected\nahead of it being categorized or found on popular OSINT. This occurred within the network of\nan East African financial organization.\n\n\n-----\n\n-----\n\nFigure 1- Timeline of (then-uncategorized) Blackbyte ransom attack\nOn the 6 of July 2021, multiple user accounts were brute-forced on an external-facing VPNth\nserver via NTLM. Notably this included attempted logins with the generic account\n‘Administrator’. Darktrace alerted to this initial bruteforcing activity, however as similar\nattempts had been made against the server before, it was not treated as a high-priority\nthreat.\n\nFollowing successful bruteforcing on the VPN, the malicious actor created a new user\naccount which was then added to an administrative group on an Active Directory server. This\nnew user account was subsequently used in an RDP session to an internal Domain\nController. Cyber AI Analyst picked up on the unusual nature of these administrative\nconnections in comparison to normal activity for these devices and alerted on it (Figure 2).\n\n\n-----\n\nFigure 2: AI Analyst detected the suspicious nature of the initial lateral movement. RDP,\nDCE-RPC, and SMB connections were seen from the VPN server to the domain controller\nusing the newly created account. Note: this screenshot is from DETECT/Network v.5\nLess than 20 minutes later, significant reconnaissance began on the domain controller with\nthe new credential. This involved SMB enumeration with various file shares accessed\nincluding sensitive files such as the Security Account Manager (samr). This was followed by\na two-day period of downtime where the threat actor laid low.\n\nOn the 8 of July, suspicious network behavior resumed – the default Administratorth\ncredential seen previously was also used on a second internal domain controller.\nConnections to a rare external IP were made by this device a few hours later. OSINT at the\ntime suggested these connections may have been related to the use of penetration testing\ntools, in particular the tool Process Hacker [2].\n\nOver the next two days reconnaissance and lateral movement activities occurred on a wider\nscale, originating from multiple network devices. A wide variety of techniques were used\nduring this period:\n\n-   Exploitation of legitimate administrative services such as PsExec for remote command\nexecution.\n\n-   Taking advantage of legacy protocols still in use on the network like SMB version 1.\n\n-   Bruteforcing login attempts via Kerberos.\n\n-   The use of other penetration testing tools including Metasploit and Nmap. These were\nintended to probe for vulnerabilities.\n\n\nOn the 10 of July, ransomware was deployed. File encryption occurred, with the extensionth\n‘.blackbyte’ being appended to multiple files. At the time there were no OSINT references to\nthis file extension or ransomware type, therefore any signature-based solution would have\nstruggled to detect it. It is now apparent that BlackByte ransomware had only appeared a few\n\n\n-----\n\nweeks earlier and, since then, the Ransomware-as-a-Service group has been attacking\nbusinesses and critical infrastructure worldwide [3]. A year later they still pose an active\nthreat.\n\nThe use of living-off-the-land techniques, popular penetration testing tools, and a novel strain\nof ransomware meant the attackers were able to move through the environment without\ngiving away their presence through known malware-signatures. Although a traditional\nsecurity solution would identify some of these actions, it would struggle to link these separate\nactivities. The lack of attribution, however, had no bearing on Darktrace’s ability to detect the\nunusual behavior with its anomaly-based methods.\n\nWhile this customer had RESPOND enabled at the time of this attack, its manual\nconfiguration meant that it was unable to act on the devices engaging in encryption.\nNevertheless, a wide range of high-scoring Darktrace DETECT/Network models breached\nwhich were easily visible within the customer’s threat tray. This included multiple Enhanced\nMonitoring models that would have led to Proactive Threat Notifications (PTN) being alerted\nhad the customer subscribed to the service. Whilst the attack was not prevented in this case,\nDarktrace analysts were able to give support to the customer via Ask the Expert (ATE),\nproviding in-depth analysis of the compromise including a list of likely compromised devices\nand credentials. This helped the customer to work on post-compromise recovery effectively\nand ensured the ransomware had reduced impact within their environment.\n\n## Schlussfolgerung\n\nWhile traditional security solutions may be able to deal well with ransomware that uses\nknown signatures, AI is needed to spot new or unknown types of attack – a reliance on\nsignatures will lead to these types of attack being missed.\n\nRemediation can also be far more difficult if a victim doesn’t know how to identify the\ncompromised devices or credentials because there are no known IOCs. Darktrace model\nbreaches will highlight suspicious activity in each part of the cyber kill chain, whether\ninvolving a known IOC or not, helping the customer to efficiently identify areas of\ncompromise and effectively remediate (Figure 3).\n\n\n-----\n\nFigure 3: An example of the various stages of the attack on one of the compromise servers\nbeing identified by Cyber AI Analyst. Note: this screenshot is from DETECT/Network v.5\nAs long as threat actors continue to develop new methods of attack, the ability to detect\nuncategorized threats is required. As demonstrated above, Darktrace’s anomaly-based\napproach lends itself perfectly to detecting these novel or uncategorized threats.\n\n_Thanks to Max Heinemeyer for his contributions to this blog._\n\n## Appendices\n\n**Model Breaches**\n\n-   Anomalous Connection / SMB Enumeration\n\n-   Anomalous Connection / Suspicious Activity On High Risk Device\n\n-   Anomalous Server Activity / Anomalous External Activity from Critical Network Device\n\n-   Compliance / Default Credential Usage\n\n-   Device / SMB Session Bruteforce\n\n-   Anomalous Connection / Sustained MIME Type Conversion\n\n-   Anomalous Connection / Unusual SMB Version 1 Connectivity\n\n-   Anomalous File / Internal / Additional Extension Appended to SMB File\n\n-   Compliance / Possible Unencrypted Password File on Server\n\n-   Compliance / SMB Drive Write\n\n-   Compliance / Weak Active Directory Ticket Encryption\n\n\n-----\n\n-   Compromise / Ransomware / Possible Ransom Note Write\n\n-   Compromise / Ransomware / Ransom or Offensive Words Written to SMB\n\n-   Compromise / Ransomware / SMB Reads then Writes with Additional Extensions\n\n-   Compromise / Ransomware / Suspicious SMB Activity\n\n-   Device / Attack and Recon Tools in SMB\n\n-   Device / Multiple Lateral Movement Model Breaches\n\n-   Device / New or Unusual Remote Command Execution\n\n-   Device / SMB Lateral Movement\n\n-   Device / Suspicious File Writes to Multiple Hidden SMB Shares\n\n-   Device / Suspicious Network Scan Activity\n\n-   Unusual Activity / Anomalous SMB Read & Write\n\n-   Unusual Activity / Anomalous SMB to Server\n\n-   User / Kerberos Password Bruteforce\n\n\n-----\n\n**References**\n\n[1] [https://www.mandiant.com/resources/zero-days-exploited-2021](https://www.mandiant.com/resources/zero-days-exploited-2021)\n\n[2] [https://www.virustotal.com/gui/ip-address/162.243.25.33/relations](https://www.virustotal.com/gui/ip-address/162.243.25.33/relations)\n\n[3] https://www.zscaler.com/blogs/security-research/analysis-blackbyte-ransomwares-gobased-variants\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-25 - Detecting the Unknown- Revealing Uncategorized Ransomware Using Darktrace.pdf"
    ],
    "report_names": [
        "2022-08-25 - Detecting the Unknown- Revealing Uncategorized Ransomware Using Darktrace.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4e453d66-9ecd-47d9-b63a-32fa5450f071",
            "created_at": "2024-06-19T02:03:08.077075Z",
            "updated_at": "2025-03-27T02:05:17.381141Z",
            "deleted_at": null,
            "main_name": "GOLD LOTUS",
            "aliases": [
                "Hecamede ",
                "BlackByte"
            ],
            "source_name": "Secureworks:GOLD LOTUS",
            "tools": [
                " Cobalt Strike",
                " ExByte",
                " MEGA",
                " RDP",
                " SoftPerfect Network Scanner",
                "BlackByte"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535781,
    "ts_updated_at": 1743041653,
    "ts_creation_date": 1662028019,
    "ts_modification_date": 1662028019,
    "files": {
        "pdf": "https://archive.orkl.eu/e751bfb4375e4fc2c448ebf132daffe2564598d8.pdf",
        "text": "https://archive.orkl.eu/e751bfb4375e4fc2c448ebf132daffe2564598d8.txt",
        "img": "https://archive.orkl.eu/e751bfb4375e4fc2c448ebf132daffe2564598d8.jpg"
    }
}