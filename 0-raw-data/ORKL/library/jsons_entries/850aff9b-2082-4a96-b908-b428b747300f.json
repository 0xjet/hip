{
    "id": "850aff9b-2082-4a96-b908-b428b747300f",
    "created_at": "2023-01-12T15:06:32.83072Z",
    "updated_at": "2025-03-27T02:05:30.930692Z",
    "deleted_at": null,
    "sha1_hash": "eed16ec17e81ca87ae0d7ed950486a94f11d1a5b",
    "title": "2016-04-11 - Manamecrypt – a ransomware that takes a different route",
    "authors": "",
    "file_creation_date": "2022-05-27T23:13:23Z",
    "file_modification_date": "2022-05-27T23:13:23Z",
    "file_size": 275795,
    "plain_text": "# Manamecrypt – a ransomware that takes a different route\n\n**[gdatasoftware.com/blog/2016/04/28234-manamecrypt-a-ransomware-that-takes-a-different-route](https://www.gdatasoftware.com/blog/2016/04/28234-manamecrypt-a-ransomware-that-takes-a-different-route)**\n\nHardly a week passes these days without a new family of ransomware making the headlines.\nThis week our analysts are taking apart Manamecrypt, also referred to as CryptoHost.\nBasically, Manamecrypt is a ransomware Trojan horse, but it differs from other ransomware\nfamilies in a number of aspects. For instance, it not only encrypts files, but also prevents\ncertain applications from running which have a specific pattern in their process name. Also, it\nuses an unconventional way of spreading which so far was not considered typical of\nransomware. The good news for victims is: the encryption of its current iteration can be\ncracked!\n\n## Infection vector: the classic Trojan horse\n\nThe main aspect in which Manamecrypt is fundamentally different from other file-encrypting\ntypes of malware we heard of in the past weeks is: the analyzed sample does not spread vial\nemail attachment or via an exploit kit. Instead, it bundles with legitimate software and can\ntherefore be classified as a classic Trojan horse. The bundle consists of the genuine, working\nand properly signed µTorrent client with the malware component bundled “on top”.\n\nBundle: c71c26bf894feb5dbedb2cf2477258f3edf3133a3c22c68ab378ba65ecf251d3\n\nG DATA detection: Gen:Variant.MSIL.Lynx.13\n\nDropped µTorrent Client:\nb7579ad8dfa57512a56e6ff62ae001560c00a4ebb9faa55086a67d30fbb1eea6\n\nG DATA detection: Win32.Application.OpenCandy.G\n\nDropped Ransomware:\n4486a1aaa49d8671826ff4d0d5c543892e1a3f0019e7f041032531ff69839bc9\n\nG DATA detection: Trojan.GenericKD.3048538\n\nInteresting fact: due to a coding error the µTorrent Client is saved as\nuTorrent.exeuTorrent.exe instead of its original name, uTorrent.exe. The client is also\ndetected by G DATA’s solutions as Win32.Application.OpenCandy.G.\n\n[Win32.Application.OpenCandy.G is a Potentially Unwanted Program (PUP). It is installed](https://www.gdatasoftware.com/securitylabs/statistics)\nalongside legitimate freeware such as PDF readers, archive programs, media players and\nother applications which are bundled with the software. The software which is detected as\nWin32.Application.OpenCandy.G is developed by SweetLabs, a company based out of San\nDiego, CA, USA. This PUP changes the browser’s behavior by modifying its home page as\n\n\n-----\n\nwell as search engine settings. Users are then redirected to potentially unwanted websites\nand it displays pop-up notifications. The reason for those changes is the generation of profit\nthrough displaying advertisements.\n\n## What Manamecrypt does on an infected PC\n\nThe malware has several functions: it encrypts the user’s files and it blocks certain programs\non the PC. This type of behavior has been unheard of so far.\n\nThe encryption is also fundamentally different from the likes of [Locky,](https://www.gdatasoftware.com/blog/2016/02/25209-encryption-trojan-locky-what-you-need-to-know-about-the-ransomware) [Petya or](https://www.gdatasoftware.com/blog/2016/03/28213-ransomware-petya-encrypts-hard-drives) [Teslacrypt](https://www.gdatasoftware.com/blog/2015/12/25211-invoices-that-might-double-in-size)\nwhich made the rounds for the past few weeks. Manamecrypt takes the data it wants to\nencrypt and copies it to a .RAR file (a type of archive file, similar to .ZIP), and encrypts this\narchive with a password. The original files are then deleted. The following file types are\nencrypted:\n```\n*.3g2 *.3gp *.7z *.asf *.avi *.doc *.docx *.flv *.gif *.jpeg *.jpg *.m4v *.mov *.mp4\n*.mpeg *.mpg *.pdf\n*.png *.ppd *.pps *.ppt *.pptx *.psd *.qt *.rm *.tiff *.txt *.wmv *.wpd *.wps *.xlr\n*.xls *.xlsl *.zip\n\n```\nManamecrypt shows its demands\nBesides encrypting the files, Manamecrypt prevents certain applications from running if they\nhave certain strings in their process name. For instance, a frequently used analysis tool was\nshut down very quickly by the malware:\n\n\n-----\n\nThe word \"monitor\" in the\n\nprocess name triggers the malware's action\nIf the ransomware comes across a window which contains the following strings, it terminates\nthe corresponding process immediately:\n\nad-aware facebook registry editor\n\namazon game rune\n\nanti virus instagram shop\n\nanti-virus internet security sophos\n\nantivirus kaspersky steam\n\navg lol system configuration\n\navira mcafee system restore\n\nbitdefender meetme task manager\n\nbullguard monitor trend micro\n\ncomodo netflix tumblr\n\ndebugger norton twitter\n\ndr.web obfuscator vimeo\n\nebay origin vipre\n\nf-secure registry\n\n## Technical details\n\nWhen executed, a new entry called „software“ is added to the registry at\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run. This enables the malware to run at\nboot-up.\n\nFurthermore, the following files are created:\n\n\n-----\n\n%APPDATA%\\cryptohost.exe (The actual ransomware binary, a copy of the sample)\n%APPDATA%\\processor.exe (WinRAR command line tools)\n%APPDATA%\\files (a list of file names with encrypted files)\n%APPDATA%\\[Encrpted_RAR_with_generic_name]\n\nIn addition, the following key is written to the registry: „HKCU\\Software\\VB and VBA\nProgram Settings\\software\\setting\\“ - The amout of Bitcoin to be paid as well as the\nremaining time are stored in here.\n\nTo decrypt, processor.exe is called as follows: „processor X -o+ pEncryptedRarArchiveNameUserName EnryptedRarArchiveName.rar\nC:\\Users\\UserName\\Desktop“.\n\n## It is possible to get your data back!\n\nIn its current implementation, the ransomware is actually susceptible to attacks. Victims can\nrestore their data. The password for the RAR file consists of the following components:\n\nSHA1Hash(Win32_processor.processorID + VolumeSerialNumber_Volume_C +\nWin32_BaseBoard.SerialNumber) + username\n\nResearcher at PCRisk.com reported that the password for RAR files created by their sample\nof Manamecrypt consists of “the name of the .RAR file + computer name.” According to our\nresults, it is a combination of the .RAR file’s name and the user name instead of the\ncomputer name.\n\nThe SHA1 is the name of the .RAR file. The user name can be determined as follows: press\nthe Windows key + R; then enter cmd and press Enter. In the newly opened command line\nwindow, enter echo %username% and press Enter again. The displayed string is the user\nname.\n\nExample: The .RAR file is called 123456789ABCDE and the Username is JDoe. The\npassword therefore is 123456789ABCDEJDoe\n\nIn case the password\n\nis entered correctly, Manamecrypt releases the date\n\n\n-----\n\n## Summary\n\nRansomware remains one of the most obvious threats within the past weeks.\nManamecrypt/Cryptohost differs on some aspects from malware which was observed before.\nThe mode of propagation, encryption method and blocking of programs are the most\nprominent differences. Also, experts were able to provide a way of decrypting files in a very\nshort time. Still, prevention is the method of choice in the battle against file-encrypting\nmalware. The following tips are a good foundation for an effective defense.\n\n## How to protect yourself – prevention is the key\n\nInfection with such an encryption Trojan is fatal for the afflicted users and companies and, in\nmany cases, decrypting the data without the appropriate key is extremely resource-intensive,\neven impossible. Looking at Manamecrypt/CryptoHost, it is possible to decrypt the files of the\ncurrent attacks.\n\nPaying the ransom is no guarantee that the data will be decrypted again by the attackers. An\nextortioner can suddenly demand more money to release the data, or encrypt the data once\nagain at a later date via a backdoor in the system and demand money again – even when it\nat first appears that he has kept his promise and released the data.\n\nIn the investigations to date, Manamecrypt is not conspicuously using such a backdoor, as\nother malware families do.\n\nThe payment demanded is generally made via e-Payment systems that provide anonymised\naccounts and payment methods - in the current case: Bitcoin. Hence, if the extortioner fails\nto do anything about the decryption despite the payment being made, the money cannot be\nreclaimed or tracked. So making a payment implies risk in all sorts of ways.\n\nConsequently it is particularly important that preventive steps are taken against this type of\nmalware, and that a comprehensive security concept is in place.\n\n### Use a comprehensive security solution\n\nGet a comprehensive solution that includes not just a virus scanner but also proactive\ntechnologies for fending off previously unknown threats. Obviously the protective software\nshould also monitor the email inbox. Always keep the security solution installed on the\ncomputer fully up-to-date.\n\n### Download software from the producer's website\n\nIn this current case, the ransomware component was bundled with a legitimate program - a\nclassic Trojan horse. Our advice: download needed/wanted software from the producer's\nwebsite only or from trusted download portals. Where possible, do not download it from thirdparty-sites.\n\n\n-----\n\n### Create backups\n\nRegular backups ensure that you are less dependent on the data on the computer. This is\nnot only advantageous in the event of a malware infection, but also if the system suffers a\ntechnical failure. Store the backups offline, i.e. separate from the computer being used.\nSome ransomware tracks down and encrypts data stored on network drives, attached USB\nsticks, connected external hard drives and in the Cloud.\n\n### Carry out updates\n\nSoftware programs contain both small and major bugs that are found and removed over\ntime. Once the developers have improved (\"patched\") the program, they expect end users to\nupdate the product. Malware – including ransomware – can be smuggled onto computers via\nunclosed vulnerabilities.\n\nEnd users should regularly look out for updates or patches and, where available, install them\nimmediately. Software and operating systems frequently offer automated availability checks\nfor updates, making it easier for the user to stay up to date. In the business world, one refers\nto [Patch Management. The list of software to be updated includes both installed programs](https://www.gdatasoftware.com/patchmanagement)\nand the operating system and, above all, the browser and all available plug-ins used in\nconjunction with the browser.\n\n### Check email attachments before opening them\n\nAs is seen with e.g. Locky or Teslacrypt, emails act as a gateway for this type of malware.\nTherefore attachments from unknown sources should never be opened without thinking –\nespecially not if they are executable files. These days, many email services will block the\nsending and receipt of executable files; therefore the attackers use indirect means, by\nmaking the addressees click on a link or by packing the files into archives, as in this case.\n\nBy all accounts resist the urge to satisfy your curiosity, even if you appear to have received\nan overdue notice or indeed a copy of the salary scale. Regard attachments from internal\nstaff with a critical eye as well. Senders' names can be faked.\n\nIf you know the sender or at least have contact details for him/her, use a second channel\n(e.g. telephone) to ask if the email has actually come from that person before opening the\nattachment.\n\n### Disable the automatic execution of macros\n\nThe execution of macros is disabled by default in modern Microsoft Office products, for\nsecurity reasons. Check the current settings for the product you are using and adjust them in\ncase necessary. [Microsoft also advises to disable macros.](https://support.office.com/en-us/article/Enable-or-disable-macros-in-Office-documents-7b4fdd2e-174f-47e2-9611-9efe4f860b12?ui=en-US&rs=en-US&ad=US)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-04-11 - Manamecrypt – a ransomware that takes a different route.pdf"
    ],
    "report_names": [
        "2016-04-11 - Manamecrypt – a ransomware that takes a different route.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535992,
    "ts_updated_at": 1743041130,
    "ts_creation_date": 1653693203,
    "ts_modification_date": 1653693203,
    "files": {
        "pdf": "https://archive.orkl.eu/eed16ec17e81ca87ae0d7ed950486a94f11d1a5b.pdf",
        "text": "https://archive.orkl.eu/eed16ec17e81ca87ae0d7ed950486a94f11d1a5b.txt",
        "img": "https://archive.orkl.eu/eed16ec17e81ca87ae0d7ed950486a94f11d1a5b.jpg"
    }
}