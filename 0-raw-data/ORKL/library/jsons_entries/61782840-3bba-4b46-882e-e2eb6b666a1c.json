{
    "id": "61782840-3bba-4b46-882e-e2eb6b666a1c",
    "created_at": "2022-10-25T16:48:14.254458Z",
    "updated_at": "2025-03-27T02:05:50.956387Z",
    "deleted_at": null,
    "sha1_hash": "dc09a375b27f274082f24eff7547f6f5a333e9aa",
    "title": "Exploiting Android - Draft v1.pptx",
    "authors": "",
    "file_creation_date": "2011-10-12T06:29:03Z",
    "file_modification_date": "2011-10-12T06:29:03Z",
    "file_size": 9377063,
    "plain_text": "-----\n\n######  The App market is like the wild, wild, west.\n\n#### Open, accessible, unrestricted.\n\n######  No need to coerce a user to download your\n\n#### app and install it from a remote website. \n\n######  Permission based security model is new and\n\n#### puts the average consumer in charge of the critical security decision making process.\n\n## Why are we so interested in Android?\n\n\n-----\n\n######  Apps are not adequately reviewed before\n\n### being placed on the market for public consumption. \n\n\n-----\n\n## Android Marketplace\n###### (The biggest W@r3Z site in the world)\n (Besides third party markets…)\n\n\n-----\n\n######  Users are prompted with a permission list\n\n### that is at best vaguely described, even in SDK documentation.\n\n“READ_PHONE_STATE - Allows read only access to phone\n###### state.”\n Might be better to say: “…is a permission that grants the application to read your unique cell phone serial, phone number, SIM card serial number, and much more!”\n\n# Permission Model\n\n\n-----\n\n######  Apps vendors are not validated.\n\n  Malicious developers can publish apps\n\n### that masquerade as legitimate products.\n\n######  Jon Oberheide provided an entertaining\n\n### example. (RootStrap - Twilight)\n\n# Impersonation\n\n\n-----\n\n# Risks to Android Users\n\n\n-----\n\n######  Malware\n  Autorun\n  WiFi\n  Phishing\n  Rootkits\n  Botnet Node\n  Network Traversal\n  Jailbreaking\n\n\n-----\n\n######  Don’t believe everything you read. In the\n\n### press. It’s not that bad. At least for the Android Market…\n\n######  Android malware is advancing in\n\n### sophistication much faster that on previous computing platforms.\n\n######  Introducing “Trend Trojans”.\n\n# Malware\n\n\n-----\n\n######  Things to look for when selecting apps for\n\n### your mobile device:\n\n##### ◦ Has the app been on the market for more than\n 90 days?\n\n ◦ Does the app have decent ratings?\n\n ◦ Developers a well known and respected?\n\n ◦ What permissions is the app asking for?\n\n# Malware - Protecting yourself\n\n\n-----\n\n######  Apps run without being “Clicked”.\n\n  Apps can be invoked from automated\n\n### system events.\n\n######  Since security apps typically scan post\n\n### install due to framework limitations this leaves a window open for attackers to exploit. \n\n# Autorun\n\n\n-----\n\n######  Many apps do not encrypt your data beforing\n\n#### rifling them to backend servers.\n\n######  Most public access WiFi AP(s) are not\n\n#### encrypted.\n\n######  Even the phone is not in use many apps\n\n#### auto-sync in the background. \n\n######  Hackers can hijack your app accounts!\n ◦ See FaceSniff\n\n# WiFi Hazards\n\n\n-----\n\n######  Uncheck connect when within range\n\n### features.\n\n######  Disable any other auto connect\n\n### functionality.\n\n## WiFi Hazards – Protecting Yourself\n\n\n-----\n\n######  Rogue apps can masquerade as legitimate\n\n#### apps you trust.\n\n######  App waits for activity (UI Element) of interest\n\n#### to spawn.\n\n######  Phishing app will then overlay it’s own\n\n#### interface, tricking the user into entering sensitive information into the phishing app. \n\n Think “clickjacking” for Droid\n\n# App Phishing\n\n\n-----\n\n# App Phishing - Demo\n\n\n-----\n\n######  Exercise caution when granting apps\n\n### these permissions:\n\n##### ◦ READ_LOGS ◦ GET_TASKS\n\n######  Phish apps will usually be unable to\n\n### populate the fake login screen with *saved* credentials.\n\n## App Phising – Protecting Yourself\n\n\n-----\n\n######  Proof-of-Concepts have been around for a\n\n#### while, see:\n\n###### ◦ DEFCON 18 Spiderlabs Android Rootkit\n\n  None currently reported in the markets. At\n\n#### the moment we’ve only seen them coupled with 0day for targeted attacks.\n\n######  Apps can utilize jail break exploits to gain\n\n#### root privileges and install them.\n\n# Rootkits\n\n\n-----\n\n######  No recommendations at this time.\n\n  Rootkit on your mobile == you SOL \n\n# Rookits –Protecting Yourself\n\n\n-----\n\n######  A few proof of concepts frameworks have\n\n### circulated in the last several months.\n\n######  Imagine an army of mobile phones\n\n### configured to listen to background noise, translate to text and target keywords, perform voiceprints, all why tracking an individuals every move with a live video feed.\n\n Enter Mobile Echelon.\n\n# Botnet\n\n\n-----\n\n######  Usually deployed from malware.\n\n  Exercise caution when installing apps (as\n\n### discussed in prior malware section).\n\n# Botnet – Protecting Yourself\n\n\n-----\n\n######  Interesting attack variation supplied by\n\n### mobile computing platforms.\n\n######  Compromised mobiles can be used to\n\n### attack each network that the mobile gains access to.\n\n# Traversal Physical Boundaries\n\n\n-----\n\n######  Disable “connect when within range” features\n\n  Exercise caution when installing apps.\n\n  Consider installing a firewall app. Hackers fail\n\n#### to plan for security products.\n\n######  Checkout Anti app from Itz. Metasploit for\n\n#### Android ;) \n\n## Traversal Physical Boundaries – Protecting Yourself\n\n\n-----\n\n######  Su apps default to implicitly allow current and\n\n#### future process attempts for root escalation. \n\n######  Majority of jailbreak users trust shell (bin/\n\n#### sh).\n\n######  Malicious apps can simply invoke the shell\n\n#### from their app and “su” to root without prompting user.\n\n# Jailbreaking\n\n\n-----\n\n######  Don’t jailbreak your phone until a better\n\n### escalation solution is available.\n\n######  When asked to approval an app for\n\n### escalation uncheck the “remember” checkbox.\n\n## Jailbreaking – Protecting yourself\n\n\n-----\n\n-----\n\n######  DEX2JAR – Convert compiled DEX object\n\n##### code to a JAR that can be decompiled with JAD. \n\n######  APKTOOL – Disassembler and binary xml\n\n##### translator built in. Produces Jasmin like syntax that can be reviewed by your favorite editor. Also supports apk rebuilding. \n\n######  DED (http://siis.cse.psu.edu/ded/) –\n\n##### Decompiler for Android DEX that while requires a little more setup but provides much more reliable results than other decompilers.\n\n# Your Toolkit\n\n\n-----\n\n######  Source Insight – Industry favorite code\n\n### analyzer. You can create custom SMALI/ JASMIN parsers to visually render your code as your desire.\n\n######  010 Editor – Fantastic hex editor. Also\n\n### supports templates. \n\n######  IDA – The only tool for examining\n\n### machine code. Cough up the cash, you need it ;)\n\n# Your Toolkit - cont\n\n\n-----\n\n######  Ubuntu 64bit Install\n\n##### ◦ You’ll need this to build your own source so you\n can hack with symbols.\n\n######  Android Prebuilt binaries\n\n##### ◦ gdbserver ◦ tcpdump ◦ strace ◦ Busybox ◦ bash ◦ valgrind\n\n# Your Toolkit - cont\n\n\n-----\n\n######  Android Permissions\n  Activity Reuse\n  SQL Injection\n  XML Injection\n  Package Name Trust\n  Traversing Webviews\n  Info Leaks\n\n# Things to look for…\n\n\n-----\n\n######  Requested permissions offer us a valuable\n\n#### first stab at an attack surface area assessment, e.g.:\n\n###### ◦ READ_LOGS – What happens when malicious log\n entries are injected into the system logs?\n\n ◦ INTERNET – MITM/Leak Potential\n\n ◦ RECEIVE_SMS  Can they app be exploited with a\n text message?\n\n# Android Permissions\n\n\n-----\n\n######  Feature allows “buddy” to remotely lock, locate,\n\n##### and wipe your phone in case of theft. Requires origin phone number and password.\n\n######  SMS Message Syntax: cmd password, e.g. \n ◦ “lock SecretPassword” ◦ “locate SecretPassword” ◦ …\n\n  SMS origin is easily spoofed (if buddy system\n\n##### worked as intended).\n\n# Norton Security 2.2.0.305\n\n\n-----\n\n######  Buddy verification is broken, anyone can issue\n\n##### remote commands.\n\n######  No password strength guideline and phone.\n\n  Limit for failed SMS authorization failures is not\n\n##### in place.\n\n######  User is not warned of failed attempts.\n\n# Norton Security - Cont\n\n\n-----\n\n######  Exported app Activities can be invoked by\n\n### external app:\n\n##### ◦ Activity exported by declaring the\n “android:export” attribute on the Activity\n\n ◦ Activity applied an Intent filter (“intent-filter”). \n\n ◦ Activities that do not utilize either of these are\n traditionally considered private and are not accessible.\n\n# Activity Reuse\n\n\n-----\n\n### Privateer Labs performed a review of 618 apps that contained a total of 3592 Activities. \n\n\n-----\n\n###### Exported Activities Requiring Permissions\n\nTotal Activities\n\nUnprotected Activities\n\n###### This yielded 2176 Activities that do not enforce permissions and are publicly accessible. \n\n## Activities Survey\n\n\n-----\n\n######  Reported earlier this year.\n\n# Activity Reuse in Skype\n\n\n-----\n\n## We can make phone calls without the needed permission!\n\n\n-----\n\n######  Android developers are recommended to\n\n### use the parameterized query options to mitigate the risk of SQL Injection.\n\n######  …Although many developers build string\n\n### queries via the execSQL() method. \n\n# SQL Injection\n\n\n-----\n\n######  Preferred by new developers (vs SQLite)\n\n  App developers rarely sanitize XML input.\n\n  Began researching potential for XML\n\n### injection when I found an example in one of my apps… We all make mistakes ;)\n\n# XML Injection\n\n\n-----\n\n######  Input sources typically user supplied and\n\n### therefor should not be trusted.\n\n######  Android SharedPrefs properly encode\n\n### problem characters \n\n# XML Injection - Cont\n\n\n-----\n\n######  Test values were pushed to app. \n  App was installed onto the Android phone.\n  Then pulled and examined to verify the\n\n### lack of secondary encoding on special values\n\n# Validation\n\n\n-----\n\n###### Multiple key fields in the app manifest do not filter special characters:\n <?xml version=\"1.0\" encoding=\"UTF-8\"?> <manifest android:versionCode=\"1\" android:versionName=\"1.0 OR \\'); | >) ;\\'s\" package=\"com.privateer.vs\"  xmlns:android=\"http://schemas.android.com/apk/res/android\">   <uses-sdk android:minSdkVersion=\"8\" />   <application android:label=\"1.0 OR \\'); |> ) ;\\'s\" android:icon=\"@drawable/icon\" android:debuggable=\"true\">     <activity android:label=\"@string/app_name\" android:name=\".VerizonSyncActivity\">       <intent-filter>         <action android:name=\"android.intent.action.MAIN\" />         <category android:name=\"android.intent.category.LAUNCHER\" />       </intent-filter>     </activity>   </application> </manifest>\n\n# XML Injection\n\n\n-----\n\n######  Reported to Android Security team.\n\n  Since reporting a new SDK has been\n\n### published that does not allow characters used in XML injection, e.g. ‘>’ to be supplied in ApplicationManifest fields. \n\n######  Attackers can still add these fields using\n\n### other means… \n\n# XML Validation – Android SDK\n\n\n-----\n\n######  Two package names cannot exist on the\n\n#### market at the same time.\n\n######  Don’t assume that package names can be\n\n#### trusted.\n\n######  Packages are sometimes deployed by vendor\n\n#### and not placed on the market.\n\n######  Packages name may be available on another\n\n#### (third party) market.\n\n# Package Name Trust\n\n\n-----\n\n######  HeroLED \n\n##### ◦ https://market.android.com/details?\n id=com.mclaughlin.HeroLED&rdid=com.mclaug hlin.HeroLED&rdot=1&pli=1\n\n######  Advanced Task Killer has a feature to\n\n### ignore “trusted” packages when displaying the task list to the user.\n\n# Package Name Trust\n\n\n-----\n\n######  If we were evil we would have published\n\n### names of every possible app we could think off so we could “squat” them.\n\n######  Android package squatting… to be\n\n### continued.\n\n# Package Name Trust\n\n\n-----\n\n######  Rich content apps relying on web views.\n\n  Separate store than the browser.\n\n  Prevents browser based XSS, CSRF, etc…\n\n  These remote app web views can be\n\n### accessed.\n\n# Traversing Webviews\n\n\n-----\n\n######  BROWSABLE\n\n     <activity android:name=\"com.target.app.schemehandler\">\n <intent-filter>         <action android:name=\"android.intent.action.VIEW\" />         <category android:name=\"android.intent.category.DEFAULT\" />         <category android:name=\"android.intent.category.BROWSABLE\" />         <data android:scheme=“httpx\" />       </intent-filter>     </activity>\n\n# Traversing Webviews\n\n\n-----\n\n######  In this scenario “schemehandler” is an\n\n### activity that receives the browse intent and acts on it. Often this is simply a Web View request containing data supplied by the user. \n\n E.g.:\n httpx://user?add=<script here>\n\n# Traversing Webviews - Cont\n\n\n-----\n\n######  Apps frequently fail to encrypt sensitive\n\n### network communications.\n\n######  Setup MITM so you can review the\n\n### network data delivery of your target apps.\n\n######  Worked for me: \n\n##### ◦ Android -> Ubuntu 10.x PPTPD -> iptables port\n redirects -> Burp Proxy\n\n# Info Leaks\n\n\n-----\n\n######  Android Browser\n\n##### ◦ Codecs/Plugins are compiled with NDK ;)\n\n ◦ Lots of bugs here so far… instant code\n execution on the phone if exploited (root with jailbreak payload)\n\n# Browser Attack Surface\n\n\n-----\n\n######  Examine your target app’s code for calls to\n\n#### isLoggeable(). Grab the tag name supplied and set the loglevel to enable verbose logging.\n E.g. Enabling web debugging:\n\n###### setprop log.tag.HttpOperation VERBOSE setprop log.tag.httpclient.wire.header VERBOSE setprop log.tag.httpclient.wire.header VERBOSE setprop log.tag.httpclient.wire.content VERBOSE setprop log.tag.httpclient.wire.content VERBOSE\n#### …\n\n# Tricks of the Trade\n\n\n-----\n\n######  Decompile an app.\n\n  Insert your own classes to exposed extra\n\n### debugging information, auto-validate all certs, etc…\n\n######  Very important when auditing apps.\n\n# Instrumentation\n\n\n-----\n\n# Android OS Vulnerabilities\n\n\n-----\n\n######  Very Buggy…\n\n  Log devices are world writeable (/dev/log/\n\n### *).\n\n######  Arbitrary log writing possible.\n\n  Logcat uses liblog.\n\n# Liblog\n\n\n-----\n\n######  Logcat instances can be exploited to disable log monitoring\n functionality in many apps.\n\n  Code execution may be possible due to nature of\n vulnerabilities (heap corruption).\n\n  Proof of Concept to be released following HITB.\n\n  Possibility exists of exploiting the logging vulnerabilities\n remotely due to nature of vulnerabilities.\n\n  Similar bugs found in library previously.\n\n# Liblog - Cont\n\n\n-----\n\n######  Android developer friendly version of a\n\n### core dump.\n\n######  Located in /data/tombstones\n\n# Logcat - Tombstones\n\n\n-----\n\n```\nBuild fingerprint: 'verizon/\nshadow_vzw/cdma_shadow:\n2.3.3/4.5.1_57_DX5-3/110323:user/\nrelease-keys'pid: 6367, tid: 6367 \n>>> ./logcat <<<signal 11 (SIGSEGV),\ncode 1 (SEGV_MAPERR), fault addr\ndeadbaad r0 00000027 r1 deadbaad r2\n00000000 r3 00000000 r4 00000000 r5 \n…\n\n```\n```\n Build fingerprint: 'verizon/\n shadow_vzw/cdma_shadow:\n 2.3.3/4.5.1_57_DX5-3/110323:user/\n release-keys'pid: 6367, tid: 6367 \n >>> ./logcat <<<signal 11 (SIGSEGV),\n code 1 (SEGV_MAPERR), fault addr\n deadbaad r0 00000027 r1 deadbaad r2\n 00000000 r3 00000000 r4 00000000 r5 \n …\n\n# Logcat - Tombstone\n\n```\n\n-----\n\n######  SQLQueryBuilder uses string\n\n### concatenation internally to build queries. \n\n######  Sanitize input before passing into WHERE\n\n### and ORDERBY clauses of query() or managedQuery() as they are built by query builder.\n\n# SQL Injection in Framework\n\n\n-----\n\n# Mobile Vendor Vulnerabilities\n\n\n-----\n\n######  Justin Case and Travis Eckhart recently\n\n### disclosed that demonstrate HTC propagates sensitive data into it’s own store that is accessible by hackers.\n\n# HTC\n\n\n-----\n\n######  Motorola Blur exposes OAUTH tokens\n\n### during update checks!\n\n# Motorolla!\n\n\n-----\n\n######  Run a network capture on your Android\n\n### and see what else vendors sending ;)\n\n## Many apps leak sensitive information…\n\n\n-----\n\n## Remote Application Install (RAI)\n\n\n-----\n\n# Google Account Linking\n\n\n-----\n\n######  Luckily there has never been a cross-\n\n### scripting in any google services… ;)\n\n# Google Account Linking \n\n\n-----\n\n######  Google is pretty good about hardening\n\n### their services.\n\n######  Cookies are usually set HTTP ONLY and\n\n### SECURE (not accessible through script or exposed over HTTP)\n\n# I know what your’re thinking…\n\n\n-----\n\n######  [Insert new certicom bug here]\n  You could be one null byte away from\n\n### having your Android phone rootkited ;)\n\n# Certificate Validation\n\n\n-----\n\n######  Thanks to certificate validation we don’t\n\n### have to worry about MITM.\n\n######  Along the way to KUL…\n\n# MITM\n\n\n-----\n\n-----\n\n# Meanwhile in gate (??)…\n\n\n-----\n\n-----\n\n-----\n\n######  Exercise caution when installing apps.\n\n  Avoid free WiFi use on your mobile until\n\n### the privacy leaks are plugged.\n\n######  Consider installing a mobile security app.\n\n### There are many great security apps that offer decent protection for free.\n\n# Conclusion\n\n\n-----\n\n######  App developers typically do not have the\n\n### budget to hire professionals to perform security audits of their apps.\n\n######  Marketplace operators do not currently\n\n### perform vulnerability scans of apps. \n\n# Conclusion\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://conference.hitb.org/hitbsecconf2011kul/materials/D1T1%20-%20Riley%20Hassell%20-%20Exploiting%20Androids%20for%20Fun%20and%20Profit.pdf"
    ],
    "report_names": [
        "D1T1%20-%20Riley%20Hassell%20-%20Exploiting%20Androids%20for%20Fun%20and%20Profit.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041150,
    "ts_creation_date": 1318400943,
    "ts_modification_date": 1318400943,
    "files": {
        "pdf": "https://archive.orkl.eu/dc09a375b27f274082f24eff7547f6f5a333e9aa.pdf",
        "text": "https://archive.orkl.eu/dc09a375b27f274082f24eff7547f6f5a333e9aa.txt",
        "img": "https://archive.orkl.eu/dc09a375b27f274082f24eff7547f6f5a333e9aa.jpg"
    }
}