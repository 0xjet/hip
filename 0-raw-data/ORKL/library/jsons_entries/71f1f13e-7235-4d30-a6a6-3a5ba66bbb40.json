{
    "id": "71f1f13e-7235-4d30-a6a6-3a5ba66bbb40",
    "created_at": "2023-01-12T15:06:34.319662Z",
    "updated_at": "2025-03-27T02:05:22.508081Z",
    "deleted_at": null,
    "sha1_hash": "dc1a2fea967d4fe9906cc26668ce980fb94df01b",
    "title": "2021-10-21 - Multi-Staged JSOutProx RAT Targets Indian Co-operative Banks and Finance Companies",
    "authors": "",
    "file_creation_date": "2022-05-28T17:30:15Z",
    "file_modification_date": "2022-05-28T17:30:15Z",
    "file_size": 199559,
    "plain_text": "# Multi-Staged JSOutProx RAT Targets Indian Co-operative Banks and Finance Companies\n\n**[blogs.quickheal.com/multi-staged-jsoutprox-rat-targets-indian-cooperative-banks-and-finance-companies/](https://blogs.quickheal.com/multi-staged-jsoutprox-rat-targets-indian-cooperative-banks-and-finance-companies/)**\n\nOctober 21, 2021\n\nQuick Heal Security Labs has been monitoring various attack campaigns using JSOutProx\nRAT against different SMBs in the BFSI sector since January 2021. We have found multiple\npayloads being dropped at different stages of its operations. Although the RAT campaigns\nhave also been previously reported on other countries, those targeting Indian companies\nare operated through separate C2 domains. Let’s dig deeper into the working of this\ntargeted attack.\n\nJSOutProx is a modular JScript-based RAT delivered to the user as a .hta file and first\nexecuted by the mshta.exe process. The initial attack vector is a spear-phishing email with\na compressed attachment having a “.hta” file with a file name related to a financial\ntransaction. The attachments have a double-extension-like format, for example “_pdf.zip”,\n“_xlsx.7z”, “_xls.zip”, “_docx.zip”, “_eml.zip”, “_jpeg.zip”, “_txt.zip” etc.\n\n### Stages\n\nThe RAT is delivered in 2 stages. In the first stage, a minimal version is provided with some\nfunctionalities stripped. In the second stage, a bigger version of the sample is delivered,\nwhich, apart from the existing functionalities of the first stage rat, has support for additional\nfunctions and plugins as well.\n\n\n-----\n\n### Initial Infection Vector\n\nSpear Phishing emails are sent to targeted individuals who are employees of small finance\nbanks from India. We believe the threat actor adds more targets to his list by stealing the\nemail contacts of its victims. We have observed multiple campaigns from Jan 2021 to June\n2021 where emails were sent to hundreds of targets in a single day. Sometimes, various\nemails with different attachment names are sent to a single target to increase the chances\nof the user downloading and opening the attachment file.\n\n### Obfuscation\n\nThe RAT was first observed two years ago, in 2019. Since then, the RAT has upgraded with\nnew commands, more functionality, and increased obfuscation. The recent JScript files\nconsist of more than one MB of obfuscated code, a vast array of base64-like strings,\nmalware’s configuration data, and an rc4 string decryption function. The obfuscation pattern\nremains the same as the older samples and is the same for both stages of RAT samples.\n\n### RAT Configuration Data\n\nOnce the configuration data is decrypted, we get a glimpse of the malware’s capabilities.\nThe “BaseUrl” field points to the C2 domain and port number it communicates using the\nHTTP protocol. “Password” field is used while downloading plugins and assemblies from\nC2. ”Tag” field contains campaign ID. The first samples, which were reported two years\nback, had the tag name “JSOutProx,” and hence it was named as such. Below is a list of\ninitial fields present in the decrypted configuration data of one RAT sample.\n\nFig 1: RAT configuration fields\n\n\n-----\n\nFew new fields like ViewOnly were seen in the recent samples, which allows the controller\nto monitor the victim to gather victim info and not write or execute anything on the machine.\nThis ensures the malware is not creating any noisy events until the attacker decides to\ninitiate the attack. Most of the initial fields are common in both stages.\n\n### First Stage RAT\n\nThe first stage RAT is a .hta file and executed by the mshta.exe process. It can create\nentries in registry and startup, create or terminate a process, perform file operations,\ndownload plugins, etc. It can also generate some mouse and keyboard operations using\nPowerShell scripts in the target machine through “ScreenPShell” commands, as mentioned\nin the below screenshot.\n\nFig 2: Few RAT functions for screen operations and shellcode execution\n\nFollowing are the essential plugins supported and their functionalities:\n\n**InfoPlugin -> Collects and sends victim machine info to C2.**\n**File plugin -> Perform all file system operations.**\n**ProcessPlugin -> Collects process information, creates or terminates a process.**\n**ScreenPShellPlugin -> Perform mouse and keyboard operations using PowerShell**\nscripts.\n\n\n-----\n\n**ShellPlugin -> In this, the ShellExecute option uses the ShellExecute method**\npresent in the object of Shell. Application. If the user has admin privileges, do call to\nShellExecute method. If the command fails, then it tries to disable AntiSPyware of\nWindows Defender from Registry. If the user is non-Admin, it tries ShellExecute with\nelevated permissions using the ‘runas’ flag. The “get output” option uses the Run\nmethod present in the object of WScript.Shell. It saves the output in a local file. It also\nfetches the keyboard language/codepage of the user to format the output correctly.\n\nOnce the malware is executed, it communicates with C2, which first responds with a\nPowerShell script to capture the screenshot and save it in the temp directory. There are\nprevious reports of the same PowerShell script being used in attacks against banks in the\nUK. Following is the PowerShell script:\n\nFig 3: PowerShell Script fetched from C2\n\n### Second Stage RAT\n\nThe second stage RAT is dropped as a “.js” file in a startup or as a “.tmp” file in the\n%temp% folder and is executed using wscript.exe. It also has a different C2 than the first\nstage sample. The size of these samples is around three MB and has additional plugins\nsupport. The inclusion of DotUtil functions enables it to download and execute .NET\nassemblies in memory. Following are some of the DotUtil functions:\n\n\n-----\n\nFig 4: DotUtil functions to perform various .NET based tasks\n\nFollowing are the additional plugins supported in the second stage:\n\n**ActivityPlugin -> Enables the RAT to be in an Online or Offline state. When the state**\nis online, it creates a adodb.stream object to save downloaded/collected data on disk.\n**CensorMiniPlugin -> Enables/disables proxy settings on user machine by modifying**\nregistry key “Software\\Microsoft\\Windows\\CurrentVersion\\Internet\nSettings\\ProxyEnable”\n**AdminConsolePlugin**\n**CensorPlugin**\n**ClipboardPlugin -> It is used to copy the clipboard data and send it to C2. It can also**\nmodify clipboard data.\n**DnsPlugin -> Used to set DNS path. Add or modify new path in**\nC:\\Windows\\System32\\drivers\\etc\\hosts.\n**LibraryPlugin -> Sends list of dotnet versions installed on the machine to C2.**\n**OutlookPlugin -> It accesses the outlook account details and contacts list.**\n\n\n-----\n\n**PriviledgePlugin -> In this, the option UAC allows to write in registry location**\n“SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\” by setting value 0\nfor keys EnableLUA and ConsentPromptBehaviorAdmin. The option “elevateScript”\nexecutes the script using wscript.exe with the batch mode option. The option\n“elevateCommand” executes the command using Wsh with ‘runas’ flag. It also has\noptions for using UAC bypass techniques like fodhelper.exe, Slui File Handler\nHijacking, CompMgmtLauncher, EventViewer.exe etc.\n**PromptPlugin**\n**ProxyPlugin -> Sets DNS path. Add or modify new path in**\nC:\\Windows\\System32\\drivers\\etc\\hosts.\n**ShortcutPlugin -> Create a shortcut file for a given executable. Execute the shortcut**\nfile. Get the target of a shortcut file or dump the content of the file.\n**RecoveryPlugin**\n**TokensPlugin -> Steal OTP received from SymantecVIP application.**\n\nIn the second stage, RAT finally drops a C++-based Netwire RAT with again a different C2\naddress. Last year we published our research about Java-based Adwind RAT\n(https://www.seqrite.com/blog/java-rat-campaign-targets-co-operative-banks-in-india/) in\nwhich jar file was the main component. It also targeted co-operative banks of India with\nCovid themed attachment names having a similar double-extension-like format. The various\ncommands, configuration fields, and user-agent strings are identical in JSOutProx and\nAdwind RATs. We believe the same threat actor might be linked with JSOutProx RAT, where\nnow they look to have changed their tactic to drop similar jar files as end payload, rather\nthan as initial infection vector, to evade detections.\n\nWith multiple stages of payloads dropped by the threat actor, he can execute remote\ncommands through any of the available stages, whichever can be seen as an attempt to\nevade antivirus detections.\n\nWe tracked the connections to the C2 domains to confirm if the exact fields are used in\nJSOutProx campaigns in other countries. But it turned out that only Indian IPs had\nconnected to the C2 locations mentioned in the collected samples, confirming our\nassumption that it’s a targeted attack on Indian BFSI companies only.\n\nWith JavaScript, Jscript, or java-based malware, attackers keep inventing new ways to\nbypass static detections using different obfuscation techniques. But the behaviour-based\ndetections are a suitable defence mechanism against such attacks. We continue to monitor\nsuch threats to protect our customers and mitigate the attacks at different levels. At the\nsame time, people working in the finance sector are advised to stay alert from such attack\ncampaigns as we expect more such attacks in the future as well.\n\n## IOCs\n\n\n-----\n\n**JSOutProx Stage 1**\n\n3c9f664193958e16c9c89423aefcb6c8\n\n48adcbbc3ec003101b4a2bb0aa5a7e01\n\n5D16911FE4BCC7D6A82C79B88E049AF2\n\n0B9B2BF97CE805CA5930966FB4DA967A\n\n5B2B4F989F684E265B03F8334576A20C\n\nBEC6094A74E102A8D18630EE0EB053E3\n\n988D384C68C95D28E67D6B8EDAF2EBE5\n\n5111740D2EB8A8201231CB0E312DB88A\n\n**JSOutProx Stage 2**\n\n06396c2f1ac27f7a453d9461ad1af8a6\n\n4876d3cc7b3b5990331a018c0b83ed03\n\n**Netwire**\n\n98fdee365893782b0639878c502fcfef\n\n**C2 Locations:**\n\nmarcelbosgath.zapto.org:9790\n\nruppamoda.zapto.org:9099\n\napatee40rm.gotdns.ch:9897\n\nmathepqo.serveftp.com:9059\n\nprotogoo.ddnsking.com:9081\n\nriyaipopa.ddns.net:9098\n\ndirrcharlirastrup.gotdns.ch:8037\n\nuloibdrupain.hopto.org:8909\n\ngensamogh.myq-see.com:9059\n\ncccicpatooluma.hopto.org:5090\n\nfeednet.myftp.biz:6093\n\n**List of Filenames used in email attachments:**\n\nCBS_applcation_details_xlsx.hta\n\nANNEXURE_III_Exceeding_MDP_xlsx.hta\n\nNodal_Police_Stations_furnished_MHA_GOI_New_Delhi_xlsx.hta\n\nLetter_dated_28_01_2021_jpg.hta\n\nrtgs-credited-wrong_account_pdf__ 4.hta\n\nTransaction report for_0127012021_docx.hta\n\nSlip_RTGS_IDBI_To_HDFC_pdf.hta\n\nFirewall_cRF_Login_access_details_pdf.hta\n\nComm_Bank_CLWS_Issues_&_Solutions_PDF.hta\n\nInspection Compliance pdf.hta\n\n\n-----\n\nformat-dist-wise-Cd_Ratio-pdf.hta\nformat_signatory_updation_PDO_138_docx__.hta\nInformation_regarding_CBS_details_update_xlsx.hta\nLate_Return_docx.hta\nIntegrated_approach_brochure_pdf.hta\n2685-Vishwambharlal_Kanahiyalal_Bhoot_Attachment_Order_pdf.hta\nPmay_infoletter_copy_of_houses-xlsx.hta\nAnnexure_Telangana_xlsx.hta\nCompliances_Inspections_2020-pdf.hta\nCircular-044_Introduction_Penalty_Charges_pdf.hta\nNPCI_Compliance_Form_pdf.hta\nRaise_chargeback_POS_txn-Reg_docx.hta\nKarnataka_Vikas_Grameena_Bank_xlsx.hta\nNFS_OC_No_354_RRN_format_pdf.hta\nExchange_information_details_pdf.hta\nNeft_amount_credited_twice_dtd_09_03_2021_pdf.hta\nKYC_Circular_from_AO__03_March_2021_pdf.hta\nState_wise_ATM_Count_xls.hta\nPayment_confirmation_details_acc_00190_pdf.hta\nSR698684494_Transaction_Status_PDF.hta\nSCAN1000000049A_JPEG.hta\nBridger_Sheet_OCSI_2_pdf.hta\nRewarding_SLBCs_for_APY_Performance_Pdf.hta\n1_Format_EDU_LOAN_Annex_SLBC_April_March_2021_xlsx.hta\nImportance_RBI_advisory_pdf.hta\nTransaction_Amount_215000_pdf.hta\nSubmission_Returns_Ext_time_pdf.hta\nPMJJBY_and_PMSBY_pdf.hta\n3162_200727190525_001_pdf.hta\nISSUER_TRANSACTION_DT_17062021_docx.hta\nWrong_creditation_details_202101706_pdf.hta\nMIS_080914_27804790_txt.hta\nICICBANK_Transaction_06172021_009122021_pdf.hta\nNEFT_FORMAT_docx.hta\nISSUER_TRANSACTION_DT_17062021.XML.hta\nTransaction_0578976746474754656866_pdf.hta\nRTGS_FORM_AUTHORITY_LETTER_PDF.hta\nCRF_NEFT_pdf.hta\nSTATUS_ENQUIRY_M0813100421890_docx.hta\nDouble_Neft_transactionS_Part_1_2_3_eml.hta\n\n\n-----\n\nREF_NO_N0092010323095704_PDF.hta\nSCAN_202024110816_122827484_pdf.hta\nAnnex_pdf.hta\n\n**Sameer Patil**\n\n[Follow @](https://twitter.com/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-21 - Multi-Staged JSOutProx RAT Targets Indian Co-operative Banks and Finance Companies.pdf"
    ],
    "report_names": [
        "2021-10-21 - Multi-Staged JSOutProx RAT Targets Indian Co-operative Banks and Finance Companies.pdf"
    ],
    "threat_actors": [
        {
            "id": "1699fb41-b83f-42ff-a6ec-984ae4a1031f",
            "created_at": "2022-10-25T16:07:23.83826Z",
            "updated_at": "2025-03-27T02:02:09.995863Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "APT 35",
                "Ballistic Bobcat",
                "Charming Kitten",
                "CharmingCypress",
                "Cobalt Illusion",
                "Cobalt Mirage",
                "Educated Manticore",
                "Magic Hound",
                "Mint Sandstorm",
                "Operation BadBlood",
                "Operation Sponsoring Access",
                "Operation SpoofedScholars",
                "Operation Thamar Reservoir",
                "Phosphorus",
                "TA453",
                "TEMP.Beanie",
                "Tarh Andishan",
                "Timberworm",
                "TunnelVision",
                "UNC788",
                "Yellow Garuda"
            ],
            "source_name": "ETDA:Magic Hound",
            "tools": [
                "7-Zip",
                "AnvilEcho",
                "BASICSTAR",
                "CORRUPT KITTEN",
                "CWoolger",
                "CharmPower",
                "ChromeHistoryView",
                "CommandCam",
                "DistTrack",
                "DownPaper",
                "FRP",
                "Fast Reverse Proxy",
                "FireMalv",
                "Ghambar",
                "GoProxy",
                "GorjolEcho",
                "HYPERSCRAPE",
                "Havij",
                "MPK",
                "MPKBot",
                "Matryoshka",
                "Matryoshka RAT",
                "MediaPl",
                "Mimikatz",
                "MischiefTut",
                "NETWoolger",
                "NOKNOK",
                "PINEFLOWER",
                "POWERSTAR",
                "PowerLess Backdoor",
                "PsList",
                "Pupy",
                "PupyRAT",
                "SNAILPROXY",
                "Shamoon",
                "TDTESS",
                "WinRAR",
                "WoolenLogger",
                "Woolger",
                "pupy",
                "sqlmap"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535994,
    "ts_updated_at": 1743041122,
    "ts_creation_date": 1653759015,
    "ts_modification_date": 1653759015,
    "files": {
        "pdf": "https://archive.orkl.eu/dc1a2fea967d4fe9906cc26668ce980fb94df01b.pdf",
        "text": "https://archive.orkl.eu/dc1a2fea967d4fe9906cc26668ce980fb94df01b.txt",
        "img": "https://archive.orkl.eu/dc1a2fea967d4fe9906cc26668ce980fb94df01b.jpg"
    }
}