{
    "id": "a2a88fe3-e4a0-4522-a35f-1299e401923d",
    "created_at": "2023-01-12T15:05:33.780308Z",
    "updated_at": "2025-03-27T02:16:25.767721Z",
    "deleted_at": null,
    "sha1_hash": "44b7f8d56d95fad87cdb1e41378e6145b71633bb",
    "title": "2019-07-29 - Android ransomware is back",
    "authors": "",
    "file_creation_date": "2022-05-28T23:29:35Z",
    "file_modification_date": "2022-05-28T23:29:35Z",
    "file_size": 1891855,
    "plain_text": "# Android ransomware is back\n\n**[welivesecurity.com/2019/07/29/android-ransomware-back/](https://www.welivesecurity.com/2019/07/29/android-ransomware-back/)**\n\nJuly 29, 2019\n\nESET researchers discover a new Android ransomware family that attempts to spread to\nvictims’ contacts and deploys some unusual tricks\n\n[Lukas Stefanko](https://www.welivesecurity.com/author/lstefanko/)\n29 Jul 2019 - 04:35PM\n\n\n-----\n\nESET researchers discover a new Android ransomware family that attempts to spread to\nvictims’ contacts and deploys some unusual tricks\n\n_UPDATE (July 30th, 2019): Due to rushing with the publication of this research – in order to_\n_warn about this threat as soon as possible – we erroneously stated that “because of the_\n_hardcoded key value that is used to encrypt the private key, it would be possible to decrypt_\n_files without paying the ransom by changing the encryption algorithm to a decryption_\n_algorithm”. However, this “hardcoded key” is an RSA-1024 public key, which can’t be easily_\n_broken, hence creating a decryptor for this particular ransomware is close to impossible._\n_Hat tip goes to Alexey Vishnyakov from Positive Technologies who drew our attention to this_\n_inaccuracy._\n\nAfter two years of decline in Android ransomware, a new family has emerged. We have\nseen the ransomware, detected by ESET Mobile Security as Android/Filecoder.C,\ndistributed via various online forums. Using victims’ contact lists, it spreads further via SMS\nwith malicious links. Due to narrow targeting and flaws in execution of the campaign, the\nimpact of this new ransomware is limited. However, if the operators start targeting broader\ngroups of users, the Android/Filecoder.C ransomware could become a serious threat.\n\nAndroid/Filecoder.C has been active since at least July 12, 2019. Within the campaign weth\ndiscovered, Android/Filecoder.C has been distributed via malicious posts on Reddit and the\n“XDA Developers” forum, a forum for Android developers. We reported the malicious activity\nto XDA Developers and Reddit. The posts on the XDA Developers forum were removed\nswiftly; the malicious Reddit profile was still up at the time of publication.\n\nAndroid/Filecoder.C spreads further via SMS with malicious links, which are sent to all\ncontacts in the victim’s contact list.\n\nAfter the ransomware sends out this batch of malicious SMSes, it encrypts most user files\non the device and requests a ransom.\n\nUsers with ESET Mobile Security receive a warning about the malicious link; should they\nignore the warning and download the app, the security solution will block it.\n\n## Distribution\n\nThe campaign we discovered is based on two domains (see the IoCs section below),\ncontrolled by the attackers, that contain malicious Android files for download. The attackers\nlure potential victims to these domains via posting or commenting on Reddit (Figure 1) or\nXDA Developers (Figure 2).\n\nMostly, the topics of the posts were porn-related; alternatively, we’ve seen also technical\ntopics used as a lure. In all comments or posts, the attackers included links or QR codes\npointing to the malicious apps.\n\n\n-----\n\n-----\n\n_Figure 1. The attacker’s Reddit profile with malicious posts and comments_\n\n_Figure 2. Some of the attackers’ malicious posts on the XDA Developers forum_\n\nIn one link that was shared on Reddit, the attackers used the URL shortener bit.ly. This bit.ly\nURL was created on Jun 11, 2019 and as seen in Figure 3 its statistics show that, at the\ntime of writing, it had reached 59 clicks from different sources and countries.\n\n\n-----\n\n_Figure 3. Statistics for the bit.ly link shared on Reddit during the ransomware campaign_\n\n## Spreading\n\nAs previously mentioned, the Android/Filecoder.C ransomware spreads links to itself via\nSMS messages to all the entries in the victim’s contact list.\n\nThese messages include links to the ransomware; to increase the potential victims’ interest,\nthe link is presented as a link to an app that supposedly uses the potential victim’s photos,\nas seen in Figure 4.\n\nTo maximize its reach, the ransomware has the 42 language versions of the message\ntemplate seen in Figure 5. Before sending the messages, it chooses the version that fits the\nvictim device’s language setting. To personalize these messages, the malware prepends\nthe contact’s name to them.\n\n\n-----\n\n_Figure 4. An SMS with a link to the ransomware; this language variant is sent if the sending device_\n\n_has the language set to English_\n\n\n-----\n\n_Figure 5. A total of 42 language versions that are hardcoded in the ransomware_\n\n## Functionality\n\nOnce potential victims receive an SMS message with the link to the malicious application,\nthey need to install it manually. After the app is launched, it displays whatever is promised in\nthe posts distributing it – most often, it’s a sex simulator online game. However, its main\n\n\n-----\n\npurposes are C&C communication, spreading malicious messages and implementing the\nencryption/decryption mechanism.\n\nAs for C&C communication, the malware contains hardcoded C&C and Bitcoin addresses in\nits source code. However, it can also dynamically retrieve them: they can be changed any\ntime by the attacker, using the free Pastebin service.\n\n_Figure 6. An example of a set of addresses for the ransomware to retrieve C&C addresses_\n\nThe ransomware has the ability to send text messages, due to having access to the user’s\ncontact list. Before it encrypts files, it sends a message to each of the victim’s contacts\nusing the technique described in the “Spreading” section above.\n\nNext, the ransomware goes through files on accessible storage – meaning all the device’s\nstorage except where system files reside – and encrypts most of them (see the “File\nencryption mechanism” section below). After the files are encrypted, the ransomware\ndisplays its ransom note (in English) as seen in Figure 7.\n\n\n-----\n\n_Figure 7. A ransom note displayed by Android/Filecoder.C_\n\nIt is true that if the victim removes the app, the ransomware will not be able to decrypt the\nfiles, as stated in the ransom note. Also, according to our analysis, there is nothing in the\nransomware’s code to support the claim that the affected data will be lost after 72 hours.\n\nAs seen in Figure 8, the requested ransom is partially dynamic. The first part of what will be\nthe amount of bitcoins to be requested is hardcoded – the value is 0.01 – while the\nremaining six digits are the user ID generated by the malware.\n\nThis unique practice may serve the purpose of identifying the incoming payments. (In\nAndroid ransomware, this is typically achieved by generating a separate Bitcoin wallet for\neach encrypted device.) Based on the recent exchange rate of approximately US$9,400 per\nbitcoin, the derived ransoms will fall in the range US$94-188 (assuming that the unique ID\nis generated randomly).\n\n\n-----\n\n_Figure 8. How the malware calculates the ransom_\n\nUnlike typical Android ransomware, Android/Filecoder.C doesn’t prevent use of the device\nby locking the screen.\n\nAs seen in Figure 9, at the time of writing, the mentioned Bitcoin address, which can be\ndynamically changed but was the same in all cases we’ve seen, has recorded no\ntransactions.\n\n_Figure 9. The Bitcoin address used by the attackers_\n\n## File encryption mechanism\n\nThe ransomware uses asymmetric and symmetric encryption. First, it generates a public\nand private key pair. This private key is encrypted using the RSA algorithm with a\nhardcoded public key stored in the code and sent to the attacker’s server. The attacker can\ndecrypt that private key and, after the victim pays the ransom, send that private key to the\nvictim to decrypt their files.\n\nWhen encrypting files, the ransomware generates a new AES key for each file that will be\nencrypted. This AES key is then encrypted using the public key and prepended to each\nencrypted file, resulting in the following pattern: ( (AES)public_key + (File)AES ).seven\n\nThe file structure is seen in Figure 10.\n\n\n-----\n\n_Figure 10. Overview of encrypted file structure_\n\nThe ransomware encrypts the following filetypes, by going through accessible storage\ndirectories:\n\n“.doc”, “.docx”, “.xls”, “.xlsx”, “.ppt”, “.pptx”, “.pst”, “.ost”, “.msg”, “.eml”, “.vsd”, “.vsdx”, “.txt”,\n“.csv”, “.rtf”, “.123”, “.wks”, “.wk1”, “.pdf”, “.dwg”, “.onetoc2”, “.snt”, “.jpeg”, “.jpg”, “.docb”,\n“.docm”, “.dot”, “.dotm”, “.dotx”, “.xlsm”, “.xlsb”, “.xlw”, “.xlt”, “.xlm”, “.xlc”, “.xltx”, “.xltm”,\n“.pptm”, “.pot”, “.pps”, “.ppsm”, “.ppsx”, “.ppam”, “.potx”, “.potm”, “.edb”, “.hwp”, “.602”, “.sxi”,\n“.sti”, “.sldx”, “.sldm”, “.sldm”, “.vdi”, “.vmdk”, “.vmx”, “.gpg”, “.aes”, “.ARC”, “.PAQ”, “.bz2”,\n“.tbk”, “.bak”, “.tar”, “.tgz”, “.gz”, “.7z”, “.rar”, “.zip”, “.backup”, “.iso”, “.vcd”, “.bmp”, “.png”,\n“.gif”, “.raw”, “.cgm”, “.tif”, “.tiff”, “.nef”, “.psd”, “.ai”, “.svg”, “.djvu”, “.m4u”, “.m3u”, “.mid”,\n“.wma”, “.flv”, “.3g2”, “.mkv”, “.3gp”, “.mp4”, “.mov”, “.avi”, “.asf”, “.mpeg”, “.vob”, “.mpg”,\n“.wmv”, “.fla”, “.swf”, “.wav”, “.mp3”, “.sh”, “.class”, “.jar”, “.java”, “.rb”, “.asp”, “.php”, “.jsp”,\n“.brd”, “.sch”, “.dch”, “.dip”, “.pl”, “.vb”, “.vbs”, “.ps1”, “.bat”, “.cmd”, “.js”, “.asm”, “.h”, “.pas”,\n“.cpp”, “.c”, “.cs”, “.suo”, “.sln”, “.ldf”, “.mdf”, “.ibd”, “.myi”, “.myd”, “.frm”, “.odb”, “.dbf”, “.db”,\n“.mdb”, “.accdb”, “.sql”, “.sqlitedb”, “.sqlite3”, “.asc”, “.lay6”, “.lay”, “.mml”, “.sxm”, “.otg”,\n“.odg”, “.uop”, “.std”, “.sxd”, “.otp”, “.odp”, “.wb2”, “.slk”, “.dif”, “.stc”, “.sxc”, “.ots”, “.ods”,\n“.3dm”, “.max”, “.3ds”, “.uot”, “.stw”, “.sxw”, “.ott”, “.odt”, “.pem”, “.p12”, “.csr”, “.crt”, “.key”,\n“.pfx”, “.der”\n\nHowever, it doesn’t encrypt files in directories that contain the strings “.cache”, “tmp”, or\n“temp”.\n\nThe ransomware also leaves files unencrypted if the file extension is “.zip” or “.rar” and the\nfile size is over 51,200 KB/50 MB, and “.jpeg”, “.jpg” and “.png” files with a file size less than\n150 KB.\n\nThe list of filetypes contains some entries unrelated to Android and at the same time lacks\nsome typical Android extensions such as .apk, .dex, .so. Apparently, the list has been\ncopied from the notorious WannaCryptor aka WannaCry ransomware.\n\n\n-----\n\nOnce the files are encrypted, the file extension .seven is appended to the original\nfilename, as seen in Figure 11.\n\n\n-----\n\n_Figure 11. Encrypted files with the extension “.seven”_\n\n## Decryption mechanism\n\nCode to decrypt encrypted files is present in the ransomware. If the victim pays the ransom,\nthe ransomware operator can verify that via the website seen in Figure 12 and send the\nprivate key to decrypt the files.\n\n_Figure 12. Ransom payment verification web page_\n\n## How to stay safe\n\nFirst of all, keep your devices up to date, ideally set them to patch and update\nautomatically, so that you stay protected even if you’re not among the most security\nsavvy users.\nIf possible, stick with Google Play or other reputable app stores. These markets might\nnot be completely free from malicious apps, but you have a fair chance of avoiding\nthem.\nPrior to installing any app, check its ratings and reviews. Focus on the negative ones,\nas they often come from legitimate users, while positive feedback is often crafted by\nthe attackers.\nFocus on the permissions requested by the app. If they seem inadequate for the app’s\nfunctions, avoid downloading the app.\nUse a reputable mobile security solution to protect your device.\n\n## Indicators of Compromise (IoCs)\n\n**Hash** **ESET detection name**\n\nB502874681A709E48F3D1DDFA6AE398499F4BD23 Android/Filecoder.C\n\n\n-----\n\n**Hash** **ESET detection name**\n\nD5EF600AA1C01FA200ED46140C8308637F09DFCD Android/Filecoder.C\n\nB502874681A709E48F3D1DDFA6AE398499F4BD23 Android/Filecoder.C\n\nF31C67CCC0D1867DB1FBC43762FCF83746A408C2 Android/Filecoder.C\n\n**Bitcoin address**\n\n16KQjht4ePZxxGPr3es24VQyMYgR9UEkFy\n\n**Servers**\n\nhttp://rich7[.]xyz\n\nhttp://wevx[.]xyz\n\nhttps://pastebin[.]com/raw/LQwGQ0RQ\n\n**Contact e-mail address**\n\nh3athledger@yandex[.]ru\n\n**Affected Android versions**\n\nAndroid 5.1 and above\n\n29 Jul 2019 - 04:35PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-07-29 - Android ransomware is back.pdf"
    ],
    "report_names": [
        "2019-07-29 - Android ransomware is back.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535933,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653780575,
    "ts_modification_date": 1653780575,
    "files": {
        "pdf": "https://archive.orkl.eu/44b7f8d56d95fad87cdb1e41378e6145b71633bb.pdf",
        "text": "https://archive.orkl.eu/44b7f8d56d95fad87cdb1e41378e6145b71633bb.txt",
        "img": "https://archive.orkl.eu/44b7f8d56d95fad87cdb1e41378e6145b71633bb.jpg"
    }
}