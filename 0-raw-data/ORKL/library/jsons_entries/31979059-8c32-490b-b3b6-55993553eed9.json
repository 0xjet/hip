{
    "id": "31979059-8c32-490b-b3b6-55993553eed9",
    "created_at": "2022-10-25T16:48:19.74133Z",
    "updated_at": "2025-03-27T02:06:06.937225Z",
    "deleted_at": null,
    "sha1_hash": "f05008438263f72d69a2ad48ef831832f1bf0072",
    "title": "ViperRAT: The mobile APT targeting the Israeli Defense Force that should be on your radar",
    "authors": "Lookout",
    "file_creation_date": "2017-03-07T02:45:54Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 394181,
    "plain_text": "# that should be on your radar\n\n**blog.lookout.com/blog/2017/02/16/viperrat-mobile-apt/**\n\nFebruary 16, 2017\n\nBy Michael Flossman, Security Researcher\n\nViperRAT is an active, advanced persistent threat (APT) that sophisticated threat actors are actively using to target\nand spy on the Israeli Defense Force.\n\nThe threat actors behind the ViperRAT surveillanceware collect a significant amount of sensitive information off of\nthe device, and seem most interested in exfiltrating images and audio content. The attackers are also hijacking the\ndevice camera to take pictures.\n\nUsing data collected from the Lookout\nglobal sensor network, the Lookout\nresearch team was able to gain unique\n**visibility into the ViperRAT malware,**\n**including 11 new, unreported**\n**applications. We also discovered and**\nanalyzed live, misconfigured malicious\ncommand and control servers (C2), from\nwhich we were able to identify how the attacker gets new, infected apps to secretly install and the types of activities\nthey are monitoring. In addition, we uncovered the IMEIs of the targeted individuals (IMEIs will not be shared publicly\nfor the privacy and safety of the victims) as well as the types of exfiltrated content.\n\n**In aggregate, the type of information stolen could let an attacker know where a person is, with whom they**\n**are associated (including contacts’ profile photos), the messages they are sending, the websites they visit**\n**and search history, screenshots that reveal data from other apps on the device, the conversations they**\n**have in the presence of the device, and a myriad of images including anything at which device’s camera is**\n**pointed.**\n\nLookout has determined ViperRAT is a very sophisticated threat that adds to the mounting evidence that targeted\nmobile attacks against governments and business is a real problem.\n\nLookout researchers have been tracking this threat for the last month. Given that this is an active threat, we’ve been\nworking behind-the-scenes with our customers to ensure both personal and enterprise customers are protected from\nthis threat and only decided to come forward with this information after the research team at Kaspersky released a\nreport earlier today.\n\nAdditionally, we have determined that though original reports of this story attribute this surveillanceware tool to\nHamas, this may not be the case, as we demonstrate below.\n\n## The increasing sophistication of surveillanceware\n\nThe structure of the surveillanceware indicates it is very sophisticated. Analysis indicates there are currently two\ndistinct variants of ViperRAT. The first variant is a “first stage application,” that performs basic profiling of a device,\n\n\n-----\n\nThe first variant involves social engineering the target into downloading a trojanized app. Previous reports alleged\nthis surveillanceware tool was deployed using ‘honey traps’ where the actor behind it would reach out to targets via\nfake social media profiles of young women. After building an initial rapport with targets, the actors behind these\nsocial media accounts would instruct victims to install an additional app for easier communication. Specifically,\nLookout determined these were trojanized versions of the apps SR Chat and YeeCall Pro. We also uncovered\nViperRAT in a billiards game, an Israeli Love Songs player, and a Move To iOS app.\n\n\n-----\n\n## The second stage\n\nThe second stage apps contain the surveillanceware capabilities. Lookout uncovered nine secondary payload\napplications:\n\n\n-----\n\n_* These apps have not been previously reported and were discovered using data from the Lookout global sensor_\n_network, which collects app and device information from over 100 million sensors to provide researchers and_\n_customers with a holistic look at the mobile threat ecosystem today._\n\nNaming additional payload applications as system updates is a clever technique used by malware authors to trick\nvictims into believing a threat isn’t present on their device. ViperRAT takes this one step further by using its dropper\napp to identify an appropriate second stage ‘update’ that may go unnoticed. For example, if a victim has Viber on\ntheir device, it will choose to retrieve the Viber Update second stage. If he doesn’t have Viber, the generically-named\nSystem Updates app gets downloaded and installed instead.\n\n## What was taken\n\nThe actors behind ViperRAT seem to be particularly interested in image data. We were able to identify that 8,929\nfiles had been exfiltrated from compromised devices and that the overwhelming majority of these, 97 percent, were\nhighly likely encrypted images taken using the device camera. We also observed automatically generated files on\nthe C2, indicating the actor behind this campaign also issues commands to search for and exfiltrate PDF and Office\ndocuments. This should be highly alarming to any government agency or enterprise.\n\n\n-----\n\nWe observed legitimate exfiltrated files of the following types of data:\n\nContact information\n\nCompressed recorded audio in the Adaptive Multi-Rate (amr) file format\n\nImages captured from the device camera\n\nImages stored on both internal device and SDCard storage that are listed in the MediaStore\n\nDevice geolocation information\n\nSMS content\n\nChrome browser search history and bookmarks\n\nCall log information\n\nCell tower information\n\nDevice network metadata; such as phone number, device software version, network country, network\noperator, SIM country, SIM operator, SIM serial, IMSI, voice mail number, phone type, network type, data\nstate, data activity, call state, SIM state, whether device is roaming, and if SMS is supported.\n\nStandard browser search history\n\nStandard browser bookmarks\n\nDevice handset metadata; such as brand, display, hardware, manufacturer, product, serial, radio version, and\nSDK.\n\n## Command and control API calls\n\nViperRAT samples are capable of communicating to C2 servers through an exposed API as well as websockets\n\n\n-----\n\n## On attribution\n\nM di ti Vi RAT th f tt ib t thi ill t l t H I li di bli h d th fi t\n\n\n-----\n\norganizations that later reported on ViperRAT performed their own independent research or simply based their\ncontent on the original Israeli report. Hamas is not widely known for having a sophisticated mobile capability, which\nmakes it unlikely they are directly responsible for ViperRAT.\n\nViperRAT has been operational for quite some time, with what appears to be a test application that surfaced in late\n2015. Many of the default strings in this application are in Arabic, including the name. It is unclear whether this\nmeans early samples were targeting Arabic speakers or if the developers behind it are fluent in Arabic.\n\nThis leads us to believe this is another actor.\n\n## What this means for you\n\nAll Lookout customers are protected from this threat. However, the existence of threats like ViperRAT and Pegasus,\n[the most sophisticated piece of mobile surveillanceware we’ve seen to date, are evidence that attackers are](https://blog.lookout.com/blog/2016/08/25/trident-pegasus/)\ntargeting mobile devices.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/n2ruyugtbigi6yyvg6u2xmt32eyqn8gx"
    ],
    "report_names": [
        "Lookout_ViperRAT-IDF(02-16-2017)"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041166,
    "ts_creation_date": 1488854754,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/f05008438263f72d69a2ad48ef831832f1bf0072.pdf",
        "text": "https://archive.orkl.eu/f05008438263f72d69a2ad48ef831832f1bf0072.txt",
        "img": "https://archive.orkl.eu/f05008438263f72d69a2ad48ef831832f1bf0072.jpg"
    }
}