{
    "id": "c15da8e9-665a-47af-ba17-7ddfdeb2e4f6",
    "created_at": "2023-01-12T15:02:33.270677Z",
    "updated_at": "2025-03-27T02:06:09.036282Z",
    "deleted_at": null,
    "sha1_hash": "7cab8aa589fc964f90103f54e864ed57409e92a4",
    "title": "2017-10-24 - NotPetya Returns as Bad Rabbit",
    "authors": "",
    "file_creation_date": "2022-05-28T18:28:23Z",
    "file_modification_date": "2022-05-28T18:28:23Z",
    "file_size": 5795167,
    "plain_text": "# NotPetya Returns as Bad Rabbit\n\n**intezer.com/notpetya-returns-bad-rabbit/**\n\nWritten by Jay Rosenberg - 24 October 2017\n\n## Get Free Account\n\nJoin Now\n\n\nOctober 24, 2017\n\n\nLarge scale cyber attacks seem to be happening once a month these days. Originally\ndiscovered by ESET (https://www.welivesecurity.com/2017/10/24/kiev-metro-hit-newvariant-infamous-diskcoder-ransomware/), Ukrainian and Russian organizations have been\nhit with the latest ransomware attack named Bad Rabbit. At the time of writing this post, the\nransomware has believed to have originated from compromised webpages with a fake\npopup for updating Adobe Flash Player. It has been reported that much of the behavior of\n[Bad Rabbit has been similar to a previous ransomware known as NotPetya.](https://www.intezer.com//wp-content/uploads/2017/07/Intezer-NotPetya.pdf)\n\n\n-----\n\n(screenshot from ESET report, after ransomware has infected a computer)\n\nUsing [Intezer Analyze™, we have found code reuse from NotPetya throughout different](https://www.intezer.com//intezer-analyze/)\nbinaries of Bad Rabbit.\n\nThe Bad Rabbit loader, with the original name (install_flash_player.exe) and metadata\n(Adobe Systems Incorporated as the company and Adobe Flash Player\nInstaller/Uninstaller), was made to look like the Adobe Flash Player installer. You can see in\nthe screenshot below that according to our analysis, the binary did not contain any code\nfrom any Adobe product but does contain code from NotPetya. In fact, we find that 27% of\nthe code in the loader has been seen in only NotPetya samples. Find the public report here\n[(https://analyze.intezer.com/#/analyses/6ba279af-8ce2-46c6-8b86-5fa65a5ed42a)](https://analyze.intezer.com/#/analyses/6ba279af-8ce2-46c6-8b86-5fa65a5ed42a)\n\n\n-----\n\nBelow is a direct comparison of function (0x1000C244) of NotPetya\n(027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745) and function\n(0x4033B4) of the Bad Rabbit loader\n(630325cac09ac3fab908f903e3b00d0dadd5fdaa0875ed8496fcbb97a558d0da).\n\nAnother example of code reuse in the loader from a function that seems to initialize some\ntype of struct.\n\n\n-----\n\n[#BadRabbit](https://twitter.com/hashtag/BadRabbit?src=hash&ref_src=twsrc%5Etfw) [(#NotPetya v2) unpacked DLL: infpub.dat : https://t.co/Ey5Yffsn74](https://twitter.com/hashtag/NotPetya?src=hash&ref_src=twsrc%5Etfw)\n\n[— hasherezade (@hasherezade) October 24, 2017](https://twitter.com/hasherezade/status/922867095997681664?ref_src=twsrc%5Etfw)\n\nThe final module that gets loaded and is responsible for encrypting the files on disk\n(579fd8a0385482fb4c789561a30b09f25671e86422f40ef5cca2036b28f99648) also has a\ncode connection with NotPetya samples. According to our technology, we can see that 13%\nof the code has been reused. You can find the public report here.\n[(https://analyze.intezer.com/#/analyses/d41e8a98-a106-4b4f-9b7c-fd9e2c80ca7d)](https://analyze.intezer.com/#/analyses/d41e8a98-a106-4b4f-9b7c-fd9e2c80ca7d)\n\n[#badrabbit found to have 13% code reuse of #notpetya](https://twitter.com/hashtag/badrabbit?src=hash&ref_src=twsrc%5Etfw) [#petya](https://twitter.com/hashtag/petya?src=hash&ref_src=twsrc%5Etfw)\n\n[here's a public report with the unpacked sample: https://t.co/NOIul4yLVT](https://t.co/NOIul4yLVT)\n\n[— Jay Rosenberg (@jaytezer) October 24, 2017](https://twitter.com/jaytezer/status/922875751174758400?ref_src=twsrc%5Etfw)\n\n\n-----\n\nBelow is a screenshot comparing a function (0x1000777B) of NotPetya\n(027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745) and a\nfunction (0x1000733C) of the encryptor module of Bad Rabbit\n(579fd8a0385482fb4c789561a30b09f25671e86422f40ef5cca2036b28f99648).\n\n\n-----\n\nThe next screenshot is of another matching function between the two samples.\n\n\n-----\n\nAs you can see in this attack, and in many other cases, malware authors constantly reuse\ntheir code. By recognizing code reuse, you force malware authors to rewrite code and come\nup with new techniques to avoid detection. This changes the playing field and makes it far\nless cost effective for malware authors and cyber crime organizations.\n\nIOCs:\n\n630325cac09ac3fab908f903e3b00d0dadd5fdaa0875ed8496fcbb97a558d0da\n\n8ebc97e05c8e1073bda2efb6f4d00ad7e789260afa2c276f0c72740b838a0a93\n\n579fd8a0385482fb4c789561a30b09f25671e86422f40ef5cca2036b28f99648\n\n\n-----\n\n**Jay Rosenberg**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-10-24 - NotPetya Returns as Bad Rabbit.pdf"
    ],
    "report_names": [
        "2017-10-24 - NotPetya Returns as Bad Rabbit.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535753,
    "ts_updated_at": 1743041169,
    "ts_creation_date": 1653762503,
    "ts_modification_date": 1653762503,
    "files": {
        "pdf": "https://archive.orkl.eu/7cab8aa589fc964f90103f54e864ed57409e92a4.pdf",
        "text": "https://archive.orkl.eu/7cab8aa589fc964f90103f54e864ed57409e92a4.txt",
        "img": "https://archive.orkl.eu/7cab8aa589fc964f90103f54e864ed57409e92a4.jpg"
    }
}