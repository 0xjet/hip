{
    "id": "5c912cb6-04b2-42c4-bf9a-3b82300e4733",
    "created_at": "2023-01-12T15:08:21.701071Z",
    "updated_at": "2025-03-27T02:17:23.391709Z",
    "deleted_at": null,
    "sha1_hash": "7e2095c55adc0ee32df2538204a7612e6d528e36",
    "title": "2022-10-04 - Deliver a Strike by Reversing a Badger- Brute Ratel Detection and Analysis",
    "authors": "",
    "file_creation_date": "2022-10-23T13:00:46Z",
    "file_modification_date": "2022-10-23T13:00:46Z",
    "file_size": 4516972,
    "plain_text": "# Deliver a Strike by Reversing a Badger: Brute Ratel Detection and Analysis\n\n**[splunk.com/en_us/blog/security/deliver-a-strike-by-reversing-a-badger-brute-ratel-detection-and-analysis.html](https://www.splunk.com/en_us/blog/security/deliver-a-strike-by-reversing-a-badger-brute-ratel-detection-and-analysis.html)**\n\nOctober 4, 2022\n\nSECURITY\n\nBy [Splunk Threat Research Team October 04, 2022](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)\n\nA new adversary simulation tool is steadily growing in the ranks of popularity among red\nteamers and most recently adversaries. Brute Ratel states on its website that it \"is the most\nadvanced Red Team & Adversary Simulation Software in the current C2 Market.\" Many of\nthese products are marketed to assist blue teams in validating detection, prevention, and\ngaps of coverage. Brute Ratel goes a level further in receiving consistent updates to evade\nmodern host-based security controls — a cat and mouse game. Adversaries pick up on\n[these products quickly, as noted in a recent blog post by Team Cymru; Brute Ratel C4](https://www.team-cymru.com/post/mythic-case-study-assessing-common-offensive-security-tools)\n(BRC4) servers are limited on the internet compared to other offensive security tools like\nCobalt Strike and Metasploit, but its popularity is growing.\n\nAs enterprise defenders who may or may not have access to these products, we have to be\nable to understand the operation of the tool and its procedures and behaviors.\n\nIn this blog, the Splunk Threat Research Team (STRT) will highlight how we utilized other\npublic research to capture Brute Ratel Badgers (agents) and create a Yara rule to help\nidentify more on VirusTotal. Additionally, we reversed a sample to better understand its\nfunctions. STRT simulated a badger’s functionality using a newly released defender-driven\nC2 utility. Lastly, STRT describes analytics to help defenders identify behaviors related to\nBrute Ratel.\n\n## Analysis\n\n\n-----\n\n### Hunting for a Badger\n\nBrute Ratel is a commercial C2 framework available only to paying customers; yet, STRT\nneeded a way to acquire a sample for analysis. Fortunately for us, security researchers like\n[Spookysec.net,](https://blog.spookysec.net/analyzing-brc4-badgers/) [Unit42 and](https://unit42.paloaltonetworks.com/brute-ratel-c4-tool/) [Mdsec have already found samples and blogged about their](https://www.mdsec.co.uk/2022/08/part-3-how-i-met-your-beacon-brute-ratel/)\n[analysis. STRT leveraged the sample found on the Analyzing a Brute Ratel Badger blog](https://www.virustotal.com/gui/file/3ad53495851bafc48caf6d2227a434ca2e0bef9ab3bd40abfe4ea8f318d37bbe)\npost and created an experimental generic Yara rule that can be used on VirusTotal to hunt\nfor other potential uploaded samples.\n```\nrule possible_badger\n\n{\n\n strings:\n\n    //mov eax, 0x00\n\n    // push eax\n\n    //mov eax, 0x00\n\n    // push eax\n\n    //mov eax, 0x00\n\n    // push eax\n\n    //mov eax, 0x00\n\n    // push eax\n\n    //mov eax, 0x00\n\n    // push eax\n\n    //mov eax, 0x00\n\n    // push eax\n\n    $code = { B8 00 00 00 00 50 B8 00 00 00 00 50 B8 00 00 00 00 50 B8 00 00 00\n00 50 B8 00 00 00 00 50 B8 00 00 00 00 50}\n\n condition:\n\n   all of them\n\n}\n\n\n```\nThe Yara rule above hunts for a series of move zero bytes instructions to the EAX register\nwhich are then pushed to the stack. These instructions were identified as part of the initial\nshellcode that sets up the BRC4 agent DLL module on the stack.\n\nThe figure below shows one of the files flagged by the Yara rule, an ISO file named\nfotos.iso.\n\n[The first submission of this file in VT was on July 20, 2022, from Poland.](https://www.virustotal.com/gui/file/b5378730c64f68d64aa1b15cb79088c9c6cb7373fcb7106812ffee4f8a7c1df7)\n\nThe figure below shows the VirusTotal detection list of the ISO fotos.iso at the time of\nwriting.\n\n\n-----\n\nUsing the Yara rule we were able to identify 31 similar samples and graph them using\nVirusTotal Graphs.\n\n[The full VirusTotal graph may be found here.](https://www.virustotal.com/graph/embed/gd4852a68f5874935be109467fc0f85095590ff8e2c2648b1baa7285a35ff9895)\n\n### Malicious ISO File\n\nISO containers are a common way to deliver malware among threat actors. It enables them\n[to archive malicious files and even bypass security features such as the Mark-of-the-Web.](https://outflank.nl/blog/2020/03/30/mark-of-the-web-from-a-red-teams-perspective/)\nThe found sample contains the legitimate Microsoft signed OneDrive binary renamed as\nonedrive_fotos.exe as well as two hidden DLLs: version.dll and versions.dll files. The latter\nis also a Microsoft-signed legitimate DLL while the first one is a malicious library that will\nexecute the BRC4 agent.\n\n\n-----\n\n[This initial access vector leverages the DLL Side-Loading technique (T1574.002) to obtain](https://attack.mitre.org/techniques/T1574/002/)\ncode execution on the victim host. Side-loading takes advantage of the DLL search order\nused by the loader by positioning both the victim application and malicious payload\nalongside each other. When the victim mounts the ISO and executes the\nonedrive_fotos.exe binary, it will load the maliciously crafted version.dll.\n\nThe figure below shows the VirusTotal detection list of the version.dll library at the time of\nwriting.\n\n[The ISO file we analyzed is similar to the sample analyzed by Palo Alto’s Unit42 in their](https://www.virustotal.com/gui/file/1fc7b0e1054d54ce8f1de0cc95976081c7a85c7926c03172a3ddaa672690042c)\n[blog post covering Brute Ratel with a few notable differences:](https://unit42.paloaltonetworks.com/brute-ratel-c4-tool/)\n\nThis ISO does not contain a shortcut LNK file and relies on the victim double clicking\nthe onedrive_fotos.exe binary to load the malicious DLL.\nThe initial shellcode is embedded in the hidden DLL and not present as another file in\nthe ISO archive.\n\nThe following image provides a high level overview of the initial access attack vector.\n\n\n-----\n\nFigure 2.1 and Figure 2.2 show the .ISO component files before and after enabling the\n“Show Hidden Files” setting.\n\n### Initial Shellcode Execution\n\nThe malicious version.dll file has an embedded unencrypted shellcode in its .data section\nthat will be copied to an allocated memory address space with the\nPAGE_EXECUTE_READ protection to then be executed using the callback function of the\n[EnumChildWindows Windows API. This shellcode execution technique was first seen being](https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-enumchildwindows)\n[used by the Lazarus group.](https://research.nccgroup.com/2021/01/23/rift-analysing-a-lazarus-shellcode-execution-method/)\n\nFigure 3 shows the code snippet of the EnumChildWindows callback function used to\nexecute the shellcode.\n\nThe shellcode will set up the Brute Ratel C4 DLL agent in the memory stack using several\npush mnemonics. Afterward, the shellcode will allocate an executable memory page space\nwhere it will move the DLL agent from the stack byte per byte. Lastly, It will execute it using\n\n\n-----\n\nthe undocumented API NtCreateThreadEx.\n\nFigure 4 is the code showing the last push command executed by the shellcode to finalize\ncopying the BRC4 DLL agent to the stack.\n\nOnce the DLL agent is placed in the executable memory page, we can export it to disk to\nperform static analysis. We used the [Detect It Easy tool to perform high level analysis of the](https://github.com/horsicq/Detect-It-Easy)\nextracted BRC4 DLL and obtain information such as the exported functions (Figure 4.1), the\nentropy of the file and each section (Figure 4.2), etc.\n\nFigure 4.1\n\n\n-----\n\nFigure 4.2\n\nFigure 5 shows the code that runs a syscall function to execute the NtCreateThreadEx\nWindows API with the startAddress argument pointing to the “bruteloader” export function of\nthe BRC4 DLL agent loaded in memory. This thread also has an argument that points to the\nencoded and encrypted initial configuration that will be used for its C2 communication and\nbeaconing.\n\nFigure 5\n\n[The DLL module we extracted from memory was submitted to VT in this link and can be](https://www.virustotal.com/gui/file/392768ecec932cd22511a11cdbe04d181df749feccd4cb40b90a74a7fdf1e152?nocache=1)\nseen in Figure 5.1.\n\n\n-----\n\n### BRC4 DLL Agent Module\n\n**Initial Configuration**\n\nThe configuration data is encoded with base64 and encrypted with RC4 with the\npassphrase key “bYXJm/3#M?:XyMBF”. Figure 6 is the decrypted version of this\nconfiguration data that contains the command and control servers, port (HTTPS), user\nagent, cookie, and many more details.\n\nFigure 6\n\nThe Brute Ratel DLL agent used by this malicious version.dll is composed of techniques to\nevade detection from endpoint detection and response (EDR), antivirus products, and even\nobfuscation and encryption to thwart static code analysis.\n\n\n-----\n\nThe following section describes some of the capabilities the STRT found during our analysis\nof the BRC4 DLL module embedded in version.dll which include: gaining elevated\nprivileges, collecting sensitive information, evading detections, and dumping processes,\namong others.\n\n**BRc4 Agent Capabilities**\n\n**Windows API Abuse**\n\nThe BRC4 agent employs several techniques to invoke and abuse native Windows APIs. To\nattempt to bypass security solutions that rely on hooking common APIs, BRCc4 makes use\nof [direct system calls. The BRC4 agent can also dynamically resolve functions memory](https://outflank.nl/blog/2019/06/19/red-team-tactics-combining-direct-system-calls-and-srdi-to-bypass-av-edr/)\naddresses using pre-computed hardcoded hashes. Figure 6.1 shows the code snippet of its\nhashing algorithm it uses in parsing its needed API upon traversing the export table of its\nneeded DLL modules.\n\nFigure 6.1\n\nCommon functionality implemented by C2 implants is the ability to verify the connectivity\nwith another host using the ICMP protocol. The BRC4 DLL agent implements this by using\nthe native Windows API IcmpCreateFile and IcmpSendEcho.\n\nFigure 7 shows the code with the resolved API hash value on how to implement a PING to\na target host using those Windows APIs.\n\n\n-----\n\nFigure 7\n\n**SeDebugPrivilege**\n\nBy default, users can debug only the processes that they own. In order to debug other\nprocesses or processes owned by other users, a process needs to have a\nSeDebugPrivilege privilege token. This privilege token is abused by adversaries to elevate\nprocess access to inject malicious code or dump processes. Figure 8 shows how BRC4\nadjusts the token privilege of its process to gain debug privileges.\n\nFigure 8\n\n**Parse Clipboard Data**\n\n\n-----\n\nFigure 9 shows the code snippet BRC4 uses to parse or copy the clipboard data on the\ntargeted host using the Windows API functions OpenClipboard and GetClipboardData.\n\nFigure 9\n\n**Retrieve DNS CACHE RECORD**\n\nFigure 10 shows the code snippet implemented by BRC4 to parse the DNS cache record of\n[the infected host using the undocumented DnsGetcacheDataTable Windows API.](https://doxygen.reactos.org/d3/dae/ipconfig_8c_source.html)\n\nFigure 10\n\n\n-----\n\n**Duplicate Token**\n\nToken manipulation is a technique used to create a new process with a token “taken” or\n“duplicated” from another process. This is a common technique leveraged by adversaries,\nred teamers, and malware families to elevate the privileges of their processes.\n\nFigure 11 shows the code function that duplicates the token of “winlogon.exe” or\n“logonui.exe” and uses that token to a new process using CreateProcessWithTokenW API.\n\nFigure 11\n\n**Patch ETWEventWrite API**\n\nAnother interesting feature of the BRC4 DLL agent is that it can evade Event Tracing for\nWindows (ETW) and AMSI Windows mechanisms by patching known API responsible for\ngenerating or tracing system events.\n\nFigure 12 shows the code of this DLL agent that patches “EtwEventWrite” API with “0xC3”\nopcode which is a “return instruction” to evade the ETW event trace logging.\n\n\n-----\n\nFigure 12\n\n**Parent Process ID Spoofing**\n\nBRC4 is also capable of spoofing the parent process (PPID) for its newly created process to\nevade detections that are based on parent/child process relationships.\n\nThe code below in Figure 13 is the function that initializes the process attributes and thread\ncreation for the parent process spoofing technique.\n\n\n-----\n\nFigure 13\n\n**Retrieves IPV4 to Physical Address Mapping Table**\n\nFigure 14 shows the code snippet of the function that enumerates Address Resolution\nProtocol (ARP) entries or physical address map table for IPV4 on the local system using the\nGetIpNetTable Windows API.\n\n\n-----\n\nFigure 14\n\nBelow is the list of other capabilities we found in the BRC4 DLL module loaded by this\nmalicious version.dll file:\n\nCheck the active and idle session of the user in the target host\nTCP bind connection\n\n\n-----\n\nCreate, copy, move and delete File\nCreate, delete, move directory\nGet and set current working directory\nGet domain information\nEnumerate Drivers with their file information\nCreate, start, modify, enumerate and delete services\nGet environment variable list\nChange workstation wallpaper\nGet host by name\nEnumerate logical drives\nGet process information\nGet process token privileges\nRetrieve global information for all users and groups in security databases like SAM\nList files in a directory\nWorkstation lock screen\nProcess minidump\nRetrieve NET BIOS information\nProcess Injection (QAPC, CreateRemoteThread, and CreateSection Techniques)\nEnumerate Registries\nGet system information\nTerminate a process\nTaking windows desktop screenshot\nExecute shell command (“RUNAS”)\nRetrieves the time of the last input event\nList installed software applications in the targeted host\nRetrieves the active processes on a specified RDP session\n\n## Brute Ratel Simulation\n\nDetections written by the Splunk Threat Research Team need to pass the automated\ndetection testing pipeline before they can be released. Building detections for some of the\ninteresting TTPs we identified by analyzing BRC4 was no different; we needed a way to\nsimulate these techniques in a lab environment in order to generate the datasets used for\n[testing and stored in the Attack Data Github repository.](https://github.com/splunk/attack_data)\n\nThis presented two key challenges:\n\n1. The C2 server of the BRC4 agent we analyzed was inaccessible or already offline\n\nduring our analysis. Furthermore, even if it was online, we would have not been able\nto instruct the agent to execute the specific tasks we wanted to run.\n2. The Brute Ratel server-side application is a commercial product and the creator was\n\nunavailable for us to write detections against the product.\n\n\n-----\n\n### Introducing Atomic-C2\n\nTo approach these challenges, we decided to write our own minimal Command & Control\nframework using C++ for the implant and Python for the server: Atomic-C2. This tool will\nnever be meant to be used as part of offensive engagements but rather to be used by blue\nteams to learn about how C2s work and be able simulate techniques when commercial or\ncriminal toolsets are not available.\n\nFor this initial and Proof-Of-Concept version of Atomic-C2, we took some of the techniques\nwe learned by reverse engineering the BRC4 agent and re-wrote (simulate) them in C++\nwith a server side component to trigger them. Two examples are shown below.\n\nFigure 14.1 shows how we simulate the previously shown capability to harvest or parse the\nclipboard data.\n\n\n-----\n\nFigure 14.2 shows how we simulate the capability responsible for parent process ID\nspoofing.\n\n\n-----\n\nAs another example, Figure 15 shows the screenshot of how we simulate the technique of\nlocking the screen of the targeted workstation. The C2 server operator runs the “lock”\ncommand to instruct the agent running in the victim host to execute the simulated\nworkstation lock screen code.\n\n\n-----\n\nFigure 16 shows a screenshot of the simulated QUEUE APC process code injection\ntechnique. The simulated code will look for a cmd.exe process and inject shellcode that will\nexecute a calc.exe.\n\n\n-----\n\nAtomic-C2 helped us simulate Brute Ratel techniques to obtain the datasets we needed to\ncreate detections and to pass the automated testing process. At the moment, Atomic-C2 is\nan internal project, but we hope to release it in the upcoming months.\n\n## Brute Ratel C4 Analytic Story\n\nArmed with the knowledge gained from reversing the Brute Ratel sample and the datasets\ngenerated with Atomic-C2, the Splunk Threat Research Team developed a new analytic\nstory to help security operations center (SOC) analysts detect adversaries leveraging the\nBrute Ratel Command & Control framework. Specifically, the new Analytic Story introduces\n17 detection analytics across 10 MITRE ATT&CK techniques.\n\n\n-----\n\nThere can be multiple approaches that rely on different data sources to hunt for Brute Ratel\nbehavior. For this release, we wanted to focus on what we consider to be the most relevant\ndata source: endpoint telemetry. Thus, we focused on the following data sources:\n\nProcess Execution & Command Line Logging\n[Windows Security Event Id 4688,](https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4688) [Sysmon, or any Common Information Model](https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon)\ncompliant EDR technology.\nWindows Security Event Log\nWindows System Event Log\n\nThe next table describes the data models and the Splunk Technical Add-Ons we used to\ndevelop the detection analytics.\n\n**Sourcetype** **CIM Datamodel** **Technical Add-On**\n\n[Sysmon](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon) [Endpoint](https://docs.splunk.com/Documentation/CIM/5.0.1/User/Endpoint) [Splunk Add-on for Sysmon](https://splunkbase.splunk.com/app/5709/)\n\n[Windows Security Events](https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/view-the-security-event-log) [Endpoint](https://docs.splunk.com/Documentation/CIM/5.0.1/User/Endpoint) [Splunk Add-on for Microsoft Windows](https://splunkbase.splunk.com/app/742/)\n\nWindows System Events [Endpoint](https://docs.splunk.com/Documentation/CIM/5.0.1/User/Endpoint) [Splunk Add-on for Microsoft Windows](https://splunkbase.splunk.com/app/742/)\n\n**IOCs:**\n\nName: fotos.iso\n\nSize: 3299328 bytes (3222 KiB)\n\n[SHA256: b5378730c64f68d64aa1b15cb79088c9c6cb7373fcb7106812ffee4f8a7c1df7](https://www.virustotal.com/gui/file/b5378730c64f68d64aa1b15cb79088c9c6cb7373fcb7106812ffee4f8a7c1df7)\n\nName: version.dll\n\nSize: 580608 bytes (567 KiB)\n\n[SHA256: cab0da87966e3c0994f4e46f30fe73624528d69f8a1c3b8a1857962e231a082b](https://www.virustotal.com/gui/file/cab0da87966e3c0994f4e46f30fe73624528d69f8a1c3b8a1857962e231a082b)\n\nFile: brute-dll-agent.bin (in-memory)\n\nSize: 216064 bytes (211.00 KB)\n\nSha256: [392768ecec932cd22511a11cdbe04d181df749feccd4cb40b90a74a7fdf1e152](https://www.virustotal.com/gui/file/392768ecec932cd22511a11cdbe04d181df749feccd4cb40b90a74a7fdf1e152)\n\nFile: versions.dll\n\nSize: 31496 bytes (30.76 KB)\n\nSha256: [e549d528fee40208df2dd911c2d96b29d02df7bef9b30c93285f4a2f3e1ad5b0](https://www.virustotal.com/gui/file/e549d528fee40208df2dd911c2d96b29d02df7bef9b30c93285f4a2f3e1ad5b0/details)\n\n\n-----\n\nFile: ONEDRIVE.EXE\n\nSize: 2632088 bytes (2.51 MB)\n\nSha256: [a8f50e28989e21695d76f0b9ac23e14e1f8ae875ed42d98eaa427b14a7f87cd6](https://www.virustotal.com/gui/file/a8f50e28989e21695d76f0b9ac23e14e1f8ae875ed42d98eaa427b14a7f87cd6)\n\n## Automate with SOAR Playbooks\n\nAll of the previously listed detections create entries in the risk index by default, and can be\n[used seamlessly with risk notables and the Risk Notable Playbook Pack. The community](https://docs.splunk.com/Documentation/ESSOC/3.46.0/user/Useplaybookpack)\nSplunk SOAR playbooks below can be used in conjunction with some of the previously\ndescribed analytics:\n\n**Playbook** **Description**\n\n\nDelete\n[Detected](https://research.splunk.com/playbooks/delete_detected_files/)\nFiles\n\nInternal\nHost\nWinRM\nInvestigate\n\nBlock\nIndicators\n\n\nThis playbook acts upon events where a file has been determined to be\nmalicious (ie webshells being dropped on an end host). Before deleting the\nfile, we run a “more” command on the file in question to extract its contents.\nWe then run a delete on the file in question.\n\nThis playbook performs a general investigation on key aspects of a windows\ndevice using windows remote management. Important files related to the\nendpoint are generated, bundled into a zip, and copied to the container\nvault.\n\nThis playbook retrieves IP addresses, domains, and file hashes, blocks\nthem on various services, and adds them to specific blocklists as custom\nlists\n\n\n## Why Should You Care?\n\nWith this article we enabled security analysts, blue teamers and splunk customers to\nidentify the TTP’s used by threat actors abusing BRC4 DLL agents.\n\nBy understanding its behaviors, we were able to generate telemetry and datasets to\ndevelop and test splunk detections designed to defend and respond against this type of\nthreats.\n\n## Learn More\n\n[You can find the latest content about security analytic stories on GitHub and in Splunkbase.](https://github.com/splunk/security-content/releases/tag/v3.12.0)\n[Splunk Security Essentials also has all these detections available via push update.](https://splunkbase.splunk.com/app/3435/)\n\nFor a full list of security content, check out the [release notes on](https://docs.splunk.com/Documentation/ESSOC/3.21.0/RN/Enhancements) [Splunk Docs.](https://docs.splunk.com/Documentation/ESSOC)\n\n\n-----\n\n## Feedback\n\nAny feedback or requests? Feel free to put in an issue on GitHub and we’ll follow up.\nAlternatively, join us on the [Slack channel #security-research. Follow these instructions if](https://splunk-usergroups.slack.com/)\nyou need an invitation to our Splunk user groups on Slack.\n\n## Contributors\n\nWe would like to thank the following for their contributions to this post:\n\nPosted by\n\n**[Splunk Threat Research Team](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)**\n\nThe Splunk Threat Research Team is an active part of a customer’s overall defense\nstrategy by enhancing Splunk security offerings with verified research and security content\nsuch as use cases, detection searches, and playbooks. We help security teams around the\nglobe strengthen operations by providing tactical guidance and insights to detect,\ninvestigate and respond against the latest threats. The Splunk Threat Research Team\nfocuses on understanding how threats, actors, and vulnerabilities work, and the team\n[replicates attacks which are stored as datasets in the Attack Data repository.](https://github.com/splunk/attack_data/)\n\nOur goal is to provide security teams with research they can leverage in their day to day\noperations and to become the industry standard for SIEM detections. We are a team of\nindustry-recognized experts who are encouraged to improve the security industry by\nsharing our work with the community via conference talks, open-sourcing projects, and\nwriting white papers or blogs. You will also find us presenting our research at conferences\nsuch as Defcon, Blackhat, RSA, and many more.\n\n[Read more Splunk Security Content.](https://github.com/splunk/security_content)\n\nTAGS\n[Cybersecurity](https://www.splunk.com/en_us/blog/tag/cybersecurity.html)\nShow All Tags\n\n\n-----\n\nShow Less Tags\n\n**Related Posts**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-10-04 - Deliver a Strike by Reversing a Badger- Brute Ratel Detection and Analysis.pdf"
    ],
    "report_names": [
        "2022-10-04 - Deliver a Strike by Reversing a Badger- Brute Ratel Detection and Analysis.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536101,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1666530046,
    "ts_modification_date": 1666530046,
    "files": {
        "pdf": "https://archive.orkl.eu/7e2095c55adc0ee32df2538204a7612e6d528e36.pdf",
        "text": "https://archive.orkl.eu/7e2095c55adc0ee32df2538204a7612e6d528e36.txt",
        "img": "https://archive.orkl.eu/7e2095c55adc0ee32df2538204a7612e6d528e36.jpg"
    }
}