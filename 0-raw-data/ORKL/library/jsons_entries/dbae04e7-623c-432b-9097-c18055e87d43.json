{
    "id": "dbae04e7-623c-432b-9097-c18055e87d43",
    "created_at": "2023-01-12T15:03:45.792518Z",
    "updated_at": "2025-03-27T02:16:16.961917Z",
    "deleted_at": null,
    "sha1_hash": "04454e08f147ea03f4cdafe2645dfb81520e1455",
    "title": "2020-04-02 - Catching APT41 exploiting a zero-day vulnerability",
    "authors": "",
    "file_creation_date": "2022-05-28T02:35:05Z",
    "file_modification_date": "2022-05-28T02:35:05Z",
    "file_size": 172586,
    "plain_text": "# Catching APT41 exploiting a zero-day vulnerability\n\n**[darktrace.com/en/blog/catching-apt-41-exploiting-a-zero-day-vulnerability/](https://www.darktrace.com/en/blog/catching-apt-41-exploiting-a-zero-day-vulnerability/)**\n\nMax Heinemeyer, Director of Threat Hunting\n\n### Executive summary\n\nDarktrace detected several highly targeted attacks in early March, well before any\nassociated signatures had become available. Two weeks later, the attacks were\nattributed to Chinese threat-actor APT41.\n\nAPT41 exploited the Zoho ManageEngine zero-day vulnerability CVE-2020-10189.\nDarktrace automatically detected and reported on the attack in its earliest stages,\nenabling customers to contain the threat before it could make an impact.\n\nThe intrusions described here were part of a wider campaign by APT41 aiming to gain\ninitial access to as many companies as possible during the window of opportunity\npresented by CVE-2020-10189.\n\nThe reports generated by Darktrace highlighted and delineated every aspect of the\nincident in the form of a meaningful security narrative. Even a junior responder could\nhave reviewed this output and acted on this zero-day APT attack in under 5 minutes.\n\n### Fighting APT41’s global attack\n\n\n-----\n\nIn early March, Darktrace detected several advanced attacks targeting customers in the US\nand Europe. A majority of these customers are in the legal sector. The attacks shared the\nsame Techniques, Tools & Procedures (TTPs), targeting public-facing servers and exploiting\n[recent high-impact vulnerabilities. Last week, FireEye attributed this suspicious activity to the](https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html)\nChinese cyber espionage group APT41.\n\nThis campaign used the Zoho ManageEngine zero-day vulnerability CVE-2020-10189 to get\naccess to various companies, but little to no follow-up was detected after initial intrusion. This\nactivity indicates a broad-brush campaign to get initial access to as many target companies\nas possible during the zero-day window of opportunity.\n\nThe malicious activity observed by Darktrace took place late on Sunday March 8, 2020 and\nin the morning of March 9, 2020 (UTC), broadly in line with office hours previously attributed\nto the Chinese cyber espionage group APT41.\n\nThe graphic below shows an exemplary timeline from one of the customers targeted by\nAPT41. The attacks observed in other customer environments are identical.\n\nFigure 1: A timeline of the attack\n\n### Technical analysis\n\nThe attack described here centered around the Zoho ManageEngine zero-day vulnerability\nCVE-2020-10189. Most of the attack appears to have been automated.\n\nWe observed the initial intrusion, several follow-up payload downloads, and command and\ncontrol (C2) traffic. In all cases, the activity was contained before any later steps in the attack\nlifecycle, such as lateral movement or data exfiltration, were identified.\n\nThe below screenshot shows an overview of the key AI Analyst detections reported. Not only\ndid it report on the SSL and HTTP C2 traffic, but it also reported on the payload downloads:\n\nFigure 2: SSL C2 detection by Cyber AI Analyst\n\nFigure 3: Payload detection by Cyber AI Analyst\n\n**Initial compromise**\n\nThe initial compromise began with the successful exploitation of the Zoho ManageEngine\nzero-day vulnerability CVE-2020-10189. Following the initial intrusion, the Microsoft\nBITSAdmin command line tool was used to fetch and install a malicious Batch file, described\nbelow:\n\n\n-----\n\ninstall.bat (MD5: 7966c2c546b71e800397a67f942858d0) from infrastructure 66.42.98[.]220\non port 12345.\n\nSource: 10.60.50.XX\nDestination: 66.42.98[.]220\nDestination Port: 12345\nContent Type: application/x-msdownload\nProtocol: HTTP\nHost: 66.42.98[.]220\nURI: /test/install.bat\nMethod: GET\nStatus Code: 200\n\nFigure 4: Outbound connection fetching batch file\n\nShortly after the initial compromise, the first stage Cobalt Strike Beacon LOADER was\ndownloaded.\n\nFigure 5: Detection of the Cobalt Strike Beacon LOADER\n\n**Command and Control traffic**\n\nInterestingly, TeamViewer activity and the download of Notepad++ was taking place at the\nsame time as the C2 traffic was starting in some of the customer attacks. This indicates\nAPT41 trying to use familiar tools instead of completely ‘Living off the Land’.\n\nStoresyncsvc.dll was a Cobalt Strike Beacon implant (trial-version) which connected to\nexchange.dumb1[.]com. A successful DNS resolution to 74.82.201[.]8 was identified, which\nDarktrace discerned as a successful SSL connection to a hostname with Dynamic DNS\nproperties.\n\nMultiple connections to exchange.dumb1[.]com were identified as beaconing to a C2 center.\nThis C2 traffic to the initial Cobalt Strike Beacon was leveraged to download a second stage\npayload.\n\nInterestingly, TeamViewer activity and the download of Notepad++ was taking place at the\nsame time as the C2 traffic was starting in some of the customer attacks. This indicates\nAPT41 trying to use familiar tools instead of completely ‘Living off the Land’. There is at least\nhigh certainty that the use of these two tools can be attributed to this intrusion instead of\nregular business activity. Notepad++ was not normally used in the target customers’\nenvironments, nor was TeamViewer – in fact, the use of both applications was 100% unusual\nfor the targeted organizations.\n\n**Attack tools download**\n\n\n-----\n\nCertUtil.exe, a command line program installed as part of Certificate Services, was then\nleveraged to connect externally and download the second stage payload.\n\nFigure 6: Darktrace detecting the usage of CertUtil\n\nA few hours after this executable download, the infected device made an outbound HTTP\nconnection requesting the URI /TzGG, which was identified as Meterpreter downloading\nfurther shellcode for the Cobalt Strike Beacon.\n\nFigure 7: Detection associated with Meterpreter activity\n\nNo lateral movement or significant data exfiltration was observed.\n\n## How Cyber AI Analyst reported on the zero-day exploit\n\nDarktrace not only detected this zero-day attack campaign, but Cyber AI Analyst also saved\nsecurity teams valuable time by investigating disparate security events and generating a\nreport that immediately put them in a position to take action.\n\nThe below screenshot shows the AI Analyst incidents reported in one infected environment,\nover the eight days covering the intrusion period. The first incident on the left represents the\nAPT activity described here. The other five incidents are independent of the APT activity and\nnot as severe.\n\nFigure 8: The security incidents surfaced by AI Analyst\n\nAI Analyst reported on six incidents in total over the eight-day period. Each AI Analyst\nincident includes a detailed timeline and summary of the incident, in a concise format that\ntakes an average of two minutes to review. This means that with Cyber AI Analyst, even a\nnon-technical person could have actioned a response to this sophisticated, zero-day incident\nin less than five minutes.\n\n### Conclusion\n\nWhile very sophisticated in nature, APT41 sacrificed stealth for speed by targeting many\ncompanies at the same time. APT41 wanted to utilize the limited window of opportunity that\nthe Zoho zero-day provided before IT staff starts patching.\n\nWithout public Indicators of Compromise (IoCs) or any open-source intelligence available,\ntargeted attacks are incredibly difficult to detect. Moreover, even the best detections are\nuseless if they cannot be actioned by a security analyst at an early stage. Too often this\noccurs because of an overwhelming volume of alerts, or simply because the skills barrier to\ntriage and investigation is too high.\n\n\n-----\n\nThis appears to be a broad campaign by APT41 to gain initial access to many different\ncompanies and sectors. While very sophisticated in nature, APT41 sacrificed stealth for\nspeed by targeting many companies at the same time. APT41 wanted to utilize the limited\nwindow of opportunity that the Zoho zero-day provided before IT staff starts patching.\n\nDarktrace’s Cyber AI is specifically designed to detect the subtle signs of targeted, unknown\nattacks at an early stage, without relying on prior knowledge or IoCs. It achieves this by\ncontinuously learning the normal patterns of behavior for every user, device, and associated\npeer group from scratch, and ‘on the job’.\n\nIn the face of APT41’s recent zero-day attack campaign, the AI’s ability to (a) detect\nunknown threats with self-learning AI and (b) augment strained responders with AI-driven\ninvestigations and reporting proved crucial. Indeed, it ensured that the attacks were swiftly\ncontained before escalating to the later stages of the attack lifecycle.\n\n### Indicators of Compromise\n\nSelection of Darktrace model breaches:\n\nAnomalous File / Script from Rare External\nAnomalous File / EXE from Rare External Location\nCompromise / SSL to DynDNS\nCompliance / CertUtil External Connection\nAnomalous Connection / CertUtil Requesting Non Certificate\nAnomalous Connection / CertUtil to Rare Destination\nAnomalous Connection / New User-Agent to IP Without Hostname\nDevice / Initial Breach Chain Compromise\nCompromise / Slow Beaconing Activity To External Rare\nCompromise / Beaconing Activity To External Rare\nAnomalous File / Numeric Exe Download\nDevice / Large Number of Model Breaches\nAnomalous Server Activity / Rare External from Server\nCompromise / Sustained TCP Beaconing Activity To Rare Endpoint\nCompliance / Remote Management Tool On Server\n\nThe below screenshot shows Darktrace model breaches occurring together during the\ncompromise of one customer:\n\nFigure 9: Darktrace model breaches occurring together\n\nNetwork IoCs:\n\nIoC Comment\n\n\n-----\n\n66.42.98[.]220 Initial compromise and payload downloads\n\n74.82.201[.]8 DNS resolution for C2 domain\n\nexchange.dumb1[.]com Main C2 domain\n\n91.208.184[.]78 Secondary Cobalt Strike C2\n\nHost IoCs:\n\nIoC Comment\n\nFilename MD5 Hash\n\ninstall.bat 7966c2c546b71e800397a67f942858d0\n\nstoresyncsvc.dll 5909983db4d9023e4098e56361c96a6f\n\n2.exe 3e856162c36b532925c8226b4ed3481c\n\nTzGG 659bd19b562059f3f0cc978e15624fd9\n\n### MITRE ATT&CK techniques observed\n\nInitial Access T1190 – Exploit Public-Facing Application\n\nT1133 – External Remote Services\n\nExecution T1064 — Scripting\n\nPersistence T1050 – New Service\n\nT1197 – BITS Jobs\n\nPrivilege Escalation T1068 — Exploitation for Privilege Escalation\n\nDefense Evasion T1055 – Process Injection\n\nT1197 – BITS Jobs\n\nDiscovery\n\nExfiltration\n\nCommand and Control T1043 – Commonly Used Ports\n\nT1071 – Standard Application Layer Protocol\n\nT1132 – Data Encoding\n\nT1008 – Fallback Channels\n\n### Max Heinemeyer\n\n\n-----\n\nMax is a cyber security expert with over a decade of experience in the field, specializing in a\nwide range of areas such as Penetration Testing, Red-Teaming, SIEM and SOC consulting\nand hunting Advanced Persistent Threat (APT) groups. At Darktrace, Max oversees global\nthreat hunting efforts, working with strategic customers to investigate and respond to cyberthreats. He works closely with the R&D team at Darktrace’s Cambridge UK headquarters,\nleading research into new AI innovations and their various defensive and offensive\napplications. Max’s insights are regularly featured in international media outlets such as the\nBBC, Forbes and WIRED. When living in Germany, he was an active member of the Chaos\nComputer Club. Max holds an MSc from the University of Duisburg-Essen and a BSc from\nthe Cooperative State University Stuttgart in International Business Information Systems.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-04-02 - Catching APT41 exploiting a zero-day vulnerability.pdf"
    ],
    "report_names": [
        "2020-04-02 - Catching APT41 exploiting a zero-day vulnerability.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535825,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1653705305,
    "ts_modification_date": 1653705305,
    "files": {
        "pdf": "https://archive.orkl.eu/04454e08f147ea03f4cdafe2645dfb81520e1455.pdf",
        "text": "https://archive.orkl.eu/04454e08f147ea03f4cdafe2645dfb81520e1455.txt",
        "img": "https://archive.orkl.eu/04454e08f147ea03f4cdafe2645dfb81520e1455.jpg"
    }
}