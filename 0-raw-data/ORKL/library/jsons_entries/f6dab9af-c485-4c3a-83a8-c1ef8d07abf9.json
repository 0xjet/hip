{
    "id": "f6dab9af-c485-4c3a-83a8-c1ef8d07abf9",
    "created_at": "2023-05-06T02:09:51.800788Z",
    "updated_at": "2025-03-27T02:15:26.104318Z",
    "deleted_at": null,
    "sha1_hash": "6ff62bfc13012bf5c78b7385487d40100544f217",
    "title": "2023-04-03 - ALPHV Ransomware Affiliate Targets Vulnerable Backup Installations to Gain Initial Access",
    "authors": "",
    "file_creation_date": "2023-05-05T02:00:20Z",
    "file_modification_date": "2023-05-05T02:00:20Z",
    "file_size": 909265,
    "plain_text": "# ALPHV Ransomware Affiliate Targets Vulnerable Backup Installations to Gain Initial Access\n\n**mandiant.com/resources/blog/alphv-ransomware-backup**\n\nMandiant has observed a new ALPHV (aka BlackCat ransomware) ransomware affiliate,\ntracked as UNC4466, target publicly exposed Veritas Backup Exec installations, vulnerable\nto CVE-2021-27876, CVE-2021-27877 and CVE-2021-27878, for initial access to victim\nenvironments. A commercial Internet scanning service identified over 8,500 installations of\nVeritas Backup Exec instances that are currently exposed to the internet, some of which may\nstill be unpatched and vulnerable. Previous ALPHV intrusions investigated by Mandiant\nprimarily originated from stolen credentials suggesting a shift to opportunistic targeting of\nknown vulnerabilities. This blog post covers the UNC4466 attack lifecycle, indicators, and\ndetection opportunities.\n\n\n-----\n\nALPHV emerged in November 2021 as a ransomware-as-a-service that some researchers\n[have claimed is the successor to BLACKMATTER and DARKSIDE ransomware. While some](https://www.bleepingcomputer.com/news/security/blackcat-alphv-ransomware-linked-to-blackmatter-darkside-gangs/)\nransomware operators enacted rules to avoid impacting critical infrastructure and health\nentities, ALPHV has [continued to target these](https://www.bleepingcomputer.com/news/security/blackcat-ransomware-claims-attack-on-european-gas-pipeline/) [sensitive industries.](https://therecord.media/sun-pharma-india-ransomware-attack)\n\n## Timeline\n\n[In March 2021, Veritas published an advisory reporting three critical vulnerabilities in](https://www.veritas.com/support/en_US/security/VTS21-001)\nVeritas Backup Exec 16.x, 20.x and 21.x.\nOn September 23, 2022, a METASPLOIT module was released which exploits these\nvulnerabilities and creates a session which the threat actor can use to interact with the\nvictim system.\nOn October 22, 2022, Mandiant first observed exploitation of the Veritas vulnerabilities\nin the wild.\n\n## Attack Phases\n\n### Initial Compromise and Establish Foothold\n\nIn late 2022, UNC4466 gained access to an internet-exposed Windows server, running\nVeritas Backup Exec version 21.0 using the Metasploit module\n`exploit/multi/veritas/beagent_sha_auth_rce`. Shortly after, the Metasploit persistence\nmodule was invoked to maintain persistent access to the system for the remainder of this\nintrusion.\n\n### Internal Reconnaissance\n\nAfter gaining access to the Veritas Backup Exec server, UNC4466 used Internet Explorer,\nthe browser installed by default on older Windows systems, to download Famatech’s\nAdvanced IP Scanner from its website, hxxps://download.advanced-ip-scanner[.]com. This\ntool is capable of scanning individual IP addresses or IP address ranges for open ports, and\nreturns hostnames, operating system and hardware manufacturer information.\n\n[UNC4466 also made use of ADRecon to gather network, account, and host information in](https://github.com/adrecon/ADRecon)\nthe victim’s environment. When executed by a privileged domain account, ADRecon\ngenerates several reports about the Active Directory environment, including the Trusts, Sites,\nSubnets, password policies, user and computer account listings. These reports can be\ngenerated in a variety of formats, including CSV, XML, JSON, and HTML.\n\n### Ingress Tool Transfer\n\n\n-----\n\nUNC4466 made heavy use of the Background Intelligent Transfer Service (BITS) to\ndownload additional tools such as LAZAGNE, LIGOLO, WINSW, RCLONE, and finally the\nALPHV ransomware encryptor.\n\n### Command and Control\n\nUNC4466 leveraged SOCKS5 tunneling to communicate with compromised systems in the\nvictim network. This technique is typically used to evade network defenses or other\npreventative network controls. Two separate tools were deployed to execute this technique,\n[LIGOLO and](https://github.com/sysdream/ligolo) [REVSOCKS.](https://github.com/kost/revsocks)\n\n### Escalate Privileges\n\nThe threat actor utilized multiple credential access tools, including Mimikatz, LaZagne and\nNanodump to gather clear-text credentials and credential material.\n\nIn November 2022, UNC4466 utilized the MIMIKATZ Security Support Provider injection\nmodule (`MISC::MemSSP`). This module collects credentials in clear text as they are used,\nby manipulating the Local Security Authority Server Service (LSASS) on victim systems. This\nmodule creates a file named `C:\\Windows\\System32\\mimilsa.log`.\n\n[[Nanodump] was also used to dump LSASS memory. Like the examples shown on](https://github.com/helpsystems/nanodump)\nHelpsystems' GitHub page, the output file specified was a file in the `C:\\Windows\\Temp`\ndirectory.\n\n### Defense Evasion\n\nDuring operations, UNC4466 takes steps to evade detection. Apart from clearing event logs,\nUNC4466 also used the built in Set-MpPrefernce cmdlet to disable Microsoft Defender’s realtime monitoring capability.\n\n\n-----\n\n```\n powershell.exe Set-MpPreference -DisableRealtimeMonitoring 1 -ErrorAction\n SilentlyContinue\n\n### Command and Control\n\n```\nUNC4466 made use of BITS transfers (using the Start-BitsTransfer PowerShell cmdlet) to\ndownload various resources to the staging directory `c:\\ProgramData`. Using this technique,\nSOCKS5 tunneling tools, REVSOCKS and LIGOLO were downloaded from their official\nGitHub repositories.\n\n### Complete Mission\n\nUNC4466 deploys the Rust-based ALPHV ransomware. In Late 2022, UNC4466 added\nimmediate tasks to the default domain policy. These tasks were configured to perform\nactions which disabled security software, downloaded the ALPHV encryptor, then execute it.\n\n## Exposure\n\nAs of this blog post's date, one commercial Internet scanning service reported over 8500 IP\naddresses which advertise the \"Symantec/Veritas Backup Exec ndmp\" service on the default\nport 10000, as well as port 9000 and port 10001. While this search result does not directly\nidentify vulnerable systems, as the application versions were not identifiable, it demonstrates\nthe prevalence of Internet exposed instances that could potentially be probed by attackers.\n\n## Detection Opportunities\n\nDefenders should place priority on monitoring internet-exposed Veritas Backup Exec\nWindows installations, for versions before 21.2. Mandiant observed the exploitation of Veritas\nBackup Exec can leave a noticeable imprint on the Backup Exec log files. Where feasible,\nthese log files should be forwarded to a SIEM or similar technology which enables detection\nand alerting when certain events are recorded.\n\nIn addition to any available network connection logging, Veritas Backup Exec logs will record\nevidence of connections to remote systems.\n\n\n-----\n\n```\n [nnnn] YYYY-mm-ddTHH:MM:SS.sss [ndmp\\ndmpsrvr]   + ndmpd.cpp (nnn):\n [nnnn] YYYY-mm-ddTHH:MM:SS.sss [ndmp\\ndmpsrvr]   | Session 1 started\n [nnnn] YYYY-mm-ddTHH:MM:SS.sss [ndmp\\ndmpsrvr]   - sslOpen() : Opening\n SSL for: 0x00000\n [nnnn] YYYY-mm-ddTHH:MM:SS.sss [ndmp\\ndmpsrvr]   - sslOpen(): certinfo =\n 0x00000; sslConn = 0x00000\n [nnnn] YYYY-mm-ddTHH:MM:SS.sss [ndmp\\ndmpcomm]   - ndmpRun: Control\n connection accepted : connection established between end-points [Server\n IP]:10000 and [Remote IP]:[remote port]\n\n```\nThese connections should be triaged for any unknown IP addresses. Additionally, these logs\ncan also record the execution of suspicious pre and post backup job commands.\n```\n [nnnn] YYYY-mm-ddTHH:MM:SS.sss [ndmp\\ndmpsrvr]    SetPreCommandEnvironment: Could not obtain the BE Job ID to pass to the\n command C:\\Windows\\System32\\cmd.exe /c \"C:\\Windows\\Temp\\[random chars].exe\"\n [nnnn] YYYY-mm-ddTHH:MM:SS.sss [ndmp\\ndmpsrvr]   - Could not obtain the\n BE Job Name to pass to the command C:\\Windows\\System32\\cmd.exe /c\n \"C:\\Windows\\Temp\\[random chars].exe\"\n [nnnn] YYYY-mm-ddTHH:MM:SS.sss [ndmp\\ndmpsrvr]   - At least one of the\n Pre / Post Command environment variables could not be set\n [nnnn] YYYY-mm-ddTHH:MM:SS.sss [ndmp\\ndmpcomm]   - ndmp_readit: Caught\n message on closed connection. Socket 0x8e0 len 0x0\n\n```\nUNC4466\n\nDS0015 - Application log\n\nBackup Exec logs\n\nConnections to unknown IP addresses\nSuspicious pre or post job commands being set\n(SetPreCommandEnvironment/ SetPostCommandEnvironment). E.g:\nC:\\Windows\\System32\\cmd.exe /c\n\"C:\\Windows\\Temp\\UNKNOWN_EXEC.exe”\nWindows Event Logs\n\nSuspicious BITS transfers with the source argument targeting unknown\nhosts and GitHub repositories.\nPre-ransomware activity: deletion of volume shadow copies\nDS0017 – Command\n\nDisabling AMSI: use of Set-MpPreference PowerShell cmdlet\nIngress tool transfer: Use of Start-BitsTransfer PowerShell cmdlet\n\n\n-----\n\nDS0022 – File\n\nNew Executables created in staging directories: C:\\ProgramData,\nC:\\Windows\\Temp, C:\\Windows\\Tasks\nDS0024 – Windows Registry\n\nModification of Registry run keys\n\n## Outlook\n\nMandiant recommends implementing secure access controls, segmenting networks,\nenabling multi-factor authentication, and regularly testing and evaluating backup strategies to\nlimit the impact of a ransomware attack. Additionally, organizations should inventory\n[externally facing services and reduce the attack surface available to attackers.](https://www.mandiant.com/advantage/attack-surface-management)\n\n## Acknowledgements\n\nWith special thanks to Nick Richard for technical review.\n\n## MITRE ATT&CK\n\nMandiant has observed UNC4466 use the following techniques:\n\n\n**ATT&CK Tactic**\n**Category**\n\n**Impact**\n\n**Execution**\n\n\n**Techniques**\n\n[T1486:](https://attack.mitre.org/techniques/T1486/) Data Encrypted for Impact\n\n[T1489:](https://attack.mitre.org/techniques/T1489/) Service Stop\n\n[T1490:](https://attack.mitre.org/techniques/T1490/) Inhibit System Recovery\n\n[T1529:](https://attack.mitre.org/techniques/T1529/) System Shutdown/Reboot\n\n[T1047:](https://attack.mitre.org/techniques/T1047/) Windows Management Instrumentation\n\n[T1053:](https://attack.mitre.org/techniques/T1053/) Scheduled Task/Job\n\n\n-----\n\n**Defense Evasion**\n\n\n[T1053.005:](https://attack.mitre.org/techniques/T1053/005/) Scheduled Task\n\n[T1059.001:](https://attack.mitre.org/techniques/T1059/001/) PowerShell\n\n[T1059.006:](https://attack.mitre.org/techniques/T1059/006/) Python\n\n[T1569.002:](https://attack.mitre.org/techniques/T1569/002/) Service Execution\n\n[T1027:](https://attack.mitre.org/techniques/T1027/) Obfuscated Files or Information\n\n[T1027.002:](https://attack.mitre.org/techniques/T1027/002/) Software Packing\n\n[T1027.009:](https://attack.mitre.org/techniques/T1027/009/) Embedded Payloads\n\n[T1055:](https://attack.mitre.org/techniques/T1055/) Process Injection\n\n[T1070.001:](https://attack.mitre.org/techniques/T1070/001/) Clear Windows Event Logs\n\n[T1070.004:](https://attack.mitre.org/techniques/T1070/004/) File Deletion\n\n[T1112:](https://attack.mitre.org/techniques/T1112/) Modify Registry\n\n[T1134:](https://attack.mitre.org/techniques/T1134/) Access Token Manipulation\n\n[T1134.001:](https://attack.mitre.org/techniques/T1134/001/) Token Impersonation/Theft\n\n[T1222:](https://attack.mitre.org/techniques/T1222/) File and Directory Permissions Modification\n\n[T1497:](https://attack.mitre.org/techniques/T1497/) Virtualization/Sandbox Evasion\n\n[T1497.001:](https://attack.mitre.org/techniques/T1497/001/) System Checks\n\n[T1548.002:](https://attack.mitre.org/techniques/T1548/002/) Bypass User Account Control\n\n\n-----\n\n**Discovery**\n\n**Persistence**\n\n\n[T1562.001:](https://attack.mitre.org/techniques/T1562/001/) Disable or Modify Tools\n\n[T1564.010:](https://attack.mitre.org/techniques/T1564/010/) Process Argument Spoofing\n\n[T1574.011:](https://attack.mitre.org/techniques/T1574/011/) Services Registry Permissions Weakness\n\n[T1620:](https://attack.mitre.org/techniques/T1620/) Reflective Code Loading\n\n[T1622:](https://attack.mitre.org/techniques/T1622/) Debugger Evasion\n\n[T1484.001](https://attack.mitre.org/techniques/T1484/001/) Domain Policy Modification: Group Policy\nModification\n\n[T1007:](https://attack.mitre.org/techniques/T1007/) System Service Discovery\n\n[T1012:](https://attack.mitre.org/techniques/T1012/) Query Registry\n\n[T1016:](https://attack.mitre.org/techniques/T1016/) System Network Configuration Discovery\n\n[T1033:](https://attack.mitre.org/techniques/T1033/) System Owner/User Discovery\n\n[T1057:](https://attack.mitre.org/techniques/T1057/) Process Discovery\n\n[T1082:](https://attack.mitre.org/techniques/T1082/) System Information Discovery\n\n[T1083:](https://attack.mitre.org/techniques/T1083/) File and Directory Discovery\n\n[T1087:](https://attack.mitre.org/techniques/T1087/) Account Discovery\n\n[T1135:](https://attack.mitre.org/techniques/T1135/) Network Share Discovery\n\n[T1543:](https://attack.mitre.org/techniques/T1543/) Create or Modify System Process\n\n\n-----\n\n**Command and**\n**Control**\n\n**Lateral Movement**\n\n**Collection**\n\n**Resource**\n**Development**\n\n\n[T1543.003:](https://attack.mitre.org/techniques/T1543/003/) Windows Service\n\n[T1547.001](https://attack.mitre.org/techniques/T1547/001/) Boot or Logon Autostart Execution: Registry Run\nKeys / Startup Folder\n\n[T1095:](https://attack.mitre.org/techniques/T1095/) Non-Application Layer Protocol\n\n[T1105:](https://attack.mitre.org/techniques/T1105/) Ingress Tool Transfer\n\n[T1021.001:](https://attack.mitre.org/techniques/T1021/001/) Remote Desktop Protocol\n\n[T1213:](https://attack.mitre.org/techniques/T1213/) Data from Information Repositories\n\n[T1583.003:](https://attack.mitre.org/techniques/T1583/003/) Virtual Private Server\n\n\n## Indicators of Compromise\n\nda202cc4b3679fdb47003d603a93c90d MIMIKATZ\n\n5fe66b2835511f9d4d3703b6c639b866 NANODUMP\n\n1f437347917f0a4ced71fb7df53b1a05 LIGOLO\n\nb41dc7bef82ef384bc884973f3d0e8ca REVSOCKS\n\nc590a84b8c72cf18f35ae166f815c9df Sysinternals PSEXEC\n\n\n-----\n\n24b0f58f014bd259b57f346fb5aed2ea WINSW\n\ne31270e4a6f215f45abad65916da9db4 REVSOCKS\n\n4fdabe571b66ceec3448939bfb3ffcd1 Advanced Port Scanner\n\n68d3bf2c363144ec6874ab360fdda00a LAZAGNE\n\nee6e0cb1b3b7601696e9a05ce66e7f37 ALPHV\n\nf66e1d717b54b95cf32154b770e10ba4 METASPLOIT\n\n17424a22f01b7b996810ba1274f7b8e9 METASPLOIT\n\n\n45[.]61[.]138[.]109\n\n\n185[.]141[.]62[.]123\n\n\n5[.]199[.]169[.]209\n\n\n45[.]61[.]138[.]109:45815\n\n\n45[.]61[.]138[.]109:43937\n\n\n45[.]61[.]138[.]109:36931\n\n\n5[.]199[.]169[.]209:31600\n\n\n45[.]61[.]138[.]109:41703\n\n\n185[.]99[.]135[.]115:39839\n\n\n185[.]99[.]135[.]115:41773\n\n\n45[.]61[.]138[.]109:33971\n\n\n-----\n\n185[.]141[.]62[.]123:50810\n\n\n185[.]99[.]135[.]115:49196\n\n\nhxxp://185[.]141[.]62[.]123:10228/update[.]exe\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-04-03 - ALPHV Ransomware Affiliate Targets Vulnerable Backup Installations to Gain Initial Access.pdf"
    ],
    "report_names": [
        "2023-04-03 - ALPHV Ransomware Affiliate Targets Vulnerable Backup Installations to Gain Initial Access.pdf"
    ],
    "threat_actors": [
        {
            "id": "6e23ce43-e1ab-46e3-9f80-76fccf77682b",
            "created_at": "2022-10-25T16:07:23.303713Z",
            "updated_at": "2025-03-27T02:02:09.727245Z",
            "deleted_at": null,
            "main_name": "ALPHV",
            "aliases": [
                "ALPHV",
                "ALPHVM",
                "BlackCat Gang",
                "UNC4466"
            ],
            "source_name": "ETDA:ALPHV",
            "tools": [
                "ALPHV",
                "ALPHVM",
                "BlackCat",
                "GO Simple Tunnel",
                "GOST",
                "Impacket",
                "LaZagne",
                "MEGAsync",
                "Mimikatz",
                "Munchkin",
                "Noberus",
                "PsExec",
                "Remcom",
                "RemoteCommandExecution",
                "WebBrowserPassView"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1683338991,
    "ts_updated_at": 1743041726,
    "ts_creation_date": 1683252020,
    "ts_modification_date": 1683252020,
    "files": {
        "pdf": "https://archive.orkl.eu/6ff62bfc13012bf5c78b7385487d40100544f217.pdf",
        "text": "https://archive.orkl.eu/6ff62bfc13012bf5c78b7385487d40100544f217.txt",
        "img": "https://archive.orkl.eu/6ff62bfc13012bf5c78b7385487d40100544f217.jpg"
    }
}