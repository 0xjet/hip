{
    "id": "3fc45779-9e44-4683-a200-a046008f0893",
    "created_at": "2023-01-12T15:06:39.122554Z",
    "updated_at": "2025-03-27T02:05:25.448831Z",
    "deleted_at": null,
    "sha1_hash": "a7ef490c0f2e4c1db5bec2482ee6577446a5e83e",
    "title": "2021-07-19 - Signed, Sealed, and Delivered – Signed XLL File Delivers Buer Loader",
    "authors": "",
    "file_creation_date": "2022-05-28T19:01:10Z",
    "file_modification_date": "2022-05-28T19:01:10Z",
    "file_size": 607221,
    "plain_text": "# Signed, Sealed, and Delivered – Signed XLL File Delivers Buer Loader\n\n**[fortinet.com/blog/threat-research/signed-sealed-and-delivered-signed-xll-file-delivers-buer-loader](https://www.fortinet.com/blog/threat-research/signed-sealed-and-delivered-signed-xll-file-delivers-buer-loader)**\n\nJuly 19, 2021\n\n**[FortiGuard Labs Threat Research Report](https://www.fortinet.com/fortiguard/labs)**\n\n**Affected Platforms: Windows**\n\n**Impacted Users:   Any organization or individual**\n\n**Impact:           Remote attackers gain control of the vulnerable systems**\n\n**Severity Level:    Moderate**\n\n## Introduction - Signed XLL File Delivers Buer Loader\n\nFortiGuard Labs has discovered a malicious spam campaign that uses the names of two\nwell-known corporate entities as a social engineering lure to trick a target into opening a\nmaliciously crafted Microsoft Excel document. When opened, the document contacts a\n\n\n-----\n\nremote server that downloads a malicious payload from a predefined website. What makes\nthis campaign different from similar malicious spam campaigns is the use of a signed\nMicrosoft Excel file with an .XLL file extension, rather than the standard .XLS file extension.\n\nIn this blog, we will examine details of this attack as well as the infrastructure they used. The\nreader will see the multi-step process used to ensure that the target would be infected,\nincluding evasive steps to bypass detection technologies via the .XLL file extension and the\nuse of a valid signed digital certificate.\n\n## What Exactly is an XLL File Extension?\n\nAn XLL file extension is used by Excel Add-in files to allow third party applications to add\nextra functionality to Excel. XLL files are similar in structure to DLL files. They allow for calls\nof specific Excel commands, worksheet functions from Visual Basic (VBA), registered XLL\ncommands, and from functions referenced in Excel. The use of XLL files is not as common\nas a maliciously crafted XLS file that contain macros or exploits, so it is a rarely observed\nevasion tactic used by threat actors to bypass endpoint detection.\n\nComplicating things even further, the malicious XLL file used in this campaign (at the time of\n[analysis) is signed with a valid digital signature and chained accordingly. Signed malware](https://www.fortinet.com/resources/cyberglossary/malware?utm_source=blog&utm_campaign=malware)\ncontaining valid digital certificates are used by threat actors to evade detection as they are\ntrusted by antivirus and other endpoint security software. Because a company or\norganization is vetted by a certificate authority (CA) before the issuance of a digital\ncertificate, operating systems and anti-virus software treat files signed with these certificates\nas clean, which ultimately allows the signed file to operate with impunity.\n\nAnd finally, when run, the maliciously crafted Excel file connects to a predetermined server to\ndownload the payload, which in this case is Buer Loader.\n\n## Campaign Details\n\nThe modus operandi of these attackers is spam email. Based on our observations, these\nattacks do not appear to be targeted, but instead appear to be blanketed campaigns looking\nfor low hanging fruit—i.e., anyone willing to open the malicious attachment.\n\nThe email in the example below is a variant of the classic shipment courier status email, with\nthis variation using DHL and Amazon trademarks as the lure. This specific example was sent\nto an individual and not to an organization, further reinforcing the idea that these campaigns\nare not targeted.\n\nThis malicious spam appears to be rushed or the product of non-native English speakers as\nthere are grammatical issues—“We sincerely sorry due to inconvenience...”—which makes it\nless than convincing, even to the untrained observer.\n\n\n-----\n\nFigure 1. Email sent to recipient with malicious attachment\n\n(Incidentally, the recipient of this particular email has had their email username and\npassword posted online previously. And according to haveibeenpwned[.]com, this email\naddress has also been exposed in four separate breaches.)\n\nContained within the email is an attachment with the file name “Detailed Invoice.xll.” Looking\nat the attachment we can see that it is digitally signed and chains appropriately. The digital\nsignature is assigned to HORUM, with a reference email address of admin[@]khorum[.]ru:\n\nFigure 2. Digital Signature Details\n\nThe certificate appears to be valid until 3/24/2022:\n\nFigure 3. Certificate Details\n\nVisiting the website directly offers no further details as to what entity is behind this campaign:\n\nFigure 4. Khorum.ru showing empty directory\n\nSame with the WHOIS information:\n\nFigure 5. Korum.ru WHOIS details\n\n### The Infection Chain\n\nWhen the user opens the XLL file, the Excel file triggers on xlAutoOpen in a similar fashion\nto a macro. The following image shows the export name is the same.\n\nFigure 6. Export name same as Excel command\n\nThe export attempts to contact the following URL:\n\nhxxp://dmequest[.]com/dme/images/portfolio/products/1/csrsc.exe hosted on 68[.]67.75.66.\n\nAnalysis reveals that the IP address serving the executable file belongs to a webhosting\nreseller in Florida in the United States. Further analysis shows that this is most likely a\ncompromised server and, based on experience, it is probably controlled by affiliates of the\nbad actors or the bad actors themselves.\n\nTaking a deeper inspection of the server we see that it contains an open directory that is\npublic. In the folder where csrsc.exe resides, a directory timestamp appears to have been\nchanged to look like it is one of the original files from 2016. However, analysis revealed that\nthe csrsc.exe file was actually compiled in 2021.\n\nFigure 7. Readable directory\n\n\n-----\n\nThe directory also contains several other files from June 2021 that may be from a different\ncampaign. We have also observed older campaigns over the past several years being\ndownloaded from this same IP address. Some of these campaigns involve serving fake data\nrecovery software as well as PayPal themed phishing sites. However, it is difficult to\ndetermine if these attackers are all related, or if this is simply a leased server used by\nmultiple threat actors.\n\nA passive DNS entry of domains that resolved to this IP address highlights a variety of\nbusinesses entities, but overall, they appear to be a random collection of websites of\ncustomers belonging to the webhosting reseller.\n\nOnce the XLL file finishes downloading csrsc.exe, the downloaded file is saved as:\n\n%PUBLIC%\\srtherhaeth[.]eXe\n\n### Further Insight into srtherhaeth.exe\n\nThe downloaded file is Buer Loader. First discovered in 2019, Buer Loader is Malware-as-aService that was first used by threat actors to deliver banking Trojans and various other\nmalware. As it gained popularity it was later adopted by Ryuk threat actors to help establish\nan initial foothold on targeted networks. Once this foothold was established, the infamous\nRyuk ransomware was then deployed. Buer Loader has evolved since then and the following\nprovides further insight into this latest version.\n\nAnalysis of srtherhaeth.exe reveals what is likely an invalid or expired signature, and\nbecause of this it did not chain appropriately and could not be verified as a legitimate\ncertificate.\n\nFigure 8. Invalid Digital Signature\n\nFigure 9. Invalid Certificate\n\nFurther examination of the file revealed the following:\n\n_File Version Information_\n\nCopyright Cistae\n\nDescription Weenong\n\nOriginal Name Detrition\n\nInternal Name Phytoflagellata\n\nFile Version 0, 1, 3, 1\n\nComments Nonrival\n\n\n-----\n\nDate signed 2010-09-08 00:04:00\n\n### RUST Crates and Toolchains\n\nsrtherhaeth.eXe is almost 2 MB. In the world of malware, files in this size range are not\ncommon. This is a newer variant of Buer loader that has been completely rewritten, as first\n[pointed out by ProofPoint in May of 2021. A deeper dive reveals that it was written in RUST](https://www.proofpoint.com/us/blog/threat-insight/new-variant-buer-loader-written-rust)\nand uses RUST crates/libraries, which explains the file size anomaly versus traditional\nmalware.\n\nConsistent with the latest version of Buer Loader, this version was observed incorporating\n[the whoami (https://github.com/libcala/whoami) RUST crate, which allows for details such as](https://github.com/libcala/whoami)\ncurrent user info including username, full name, preferred language, OS name/version, and\nenvironment it is located in. The version used is whoami-1.1.1, which was released on 2021[03-13 (https://github.com/libcala/whoami/blob/main/CHANGELOG.md)](https://github.com/libcala/whoami/blob/main/CHANGELOG.md)\n\nOne interesting component of RUST are toolchains. In layman’s terms, RUST toolchains are\ncollections of programs along with multiple dependencies needed to compile a RUST\napplication.\n\nRUST toolchains observed used so far by Buer were:\n\nureq 2.0.2\n\nA minimal HTTP request library\n\nminreq\n\nA simple, minimal-dependency HTTP client with less features than ureq.\nA user-agent string of “something/1.0.0”\n\nRing\n\nAccording to the official site, Ring is a safe, fast, small crypto focused on generalpurpose cryptography. It uses RUST with BoringSSL's cryptography primitives.\n\nFinally, the file receives additional instructions from its command and control (C2) server:\n\nhxxps://shipmentofficedepot[.]com (195[.]123.234.11).\n\n**Insight into C2 shipmentofficedepot[.]com. (195[.]123.234.11)**\n\nDetailed analysis over a 30-day period revealed a large majority of connections from USbased victims (66%), followed, interestingly enough, by Mozambique (22%), Singapore (5%),\nand other countries at (1% or less).\n\nFigure 10. All traffic to 195[.]123.234.11 over a 30-day period\n\n\n-----\n\nA cursory review of our telemetry indicates that over 1/3 of the traffic occurred over port 22\n(SSH/SFTP). Almost all of these port 22 connections originate from a reportedly\ncompromised server. Since this is a shared server hosting multiple websites, this information\nindicates that the provider may not mind hosting malicious websites.\n\n## Conclusion\n\nWhile the use of malicious XLL files is not new, it is rarely used. But couple that with the fact\nthat a valid digital signature was used (at the time of the attack) and the level of\nsophistication and resourcefulness of these attackers increases in the minds of threat\nresearchers. Even though the email lure used was basic, this may only indicate that the\ngroup behind this campaign was simply testing the effectiveness of their techniques.\n\nHowever, the techniques used in this campaign are harder to spot than the average attack.\nThe examples in this blog highlight a carefully thought-out campaign by the attacker, who\ntook the needed time and steps to ensure that their work would not be detected before\ninfection. Thankfully, Fortinet customers running the latest definition sets are already\nprotected against this campaign.\n\n## Fortinet Protections\n\nFortiGuard Labs has AV coverage for the samples mentioned in this blog as:\n\nW32/Agent.ADBL!tr\nW32/Buerak.TO!tr.dldr\nW32/Kryptik.HLHY!tr\nW32/PossibleThreat\n\n[All known network IOCs are blocked by the WebFiltering client.](https://www.fortinet.com/support-and-training/support-services/fortiguard-security-subscriptions/web-filtering.html?utm_source=blog&utm_campaign=web-filtering)\n\n[All known IOCs are blocked by FortiEDR’s advanced real-time protection and have already](https://www.fortinet.com/products/endpoint-security/fortiedr.html?utm_source=blog&utm_campaign=fortiedr)\nbeen added to our cloud intelligence to prevent further execution on customer systems.\n\n**[FortiMail, powered by threat intelligence from FortiGuard Labs, can detect and block](https://www.fortinet.com/products/email-security/fortimail.html?utm_source=blog&utm_campaign=fortimail-main-page)**\nphishing attacks and remove or neutralize malicious attachments\n\n[Fortinet’s Phishing Simulation Service, FortiPhish, can also be used to proactively test the](https://www.fortinet.com/resources/cyberglossary/phishing?utm_source=blog&utm_campaign=phishing)\nsusceptibility of your organization to these kinds of phishing attacks.\n\nWe also suggest that our readers go through Fortinet’s free **[NSE Training: NSE 1—](https://training.fortinet.com/?utm_source=blog&utm_campaign=nse-institute)**\nInformation Security Awareness, which has a module on Internet threats designed to help\nend users learn how to identify and protect themselves from phishing attacks.\n\n## IOCs\n\n\n-----\n\n_Detailed Invoice.xll_\n\n6F9D943F88F715FF8A122D7B88AF986C1A9F38F4484E48CDE768CF22A5935EFE\n\n_srtherhaeth.eXe (Buer Loader)_\n\nC28ABAAAD1B7B2C7A37F28E974E8214F07C88FEFFEF986E0A60A44AB0FA575AA\n\n_Payload Download URI_\n\nhxxp://dmequest[.]com/dme/images/portfolio/products/1/csrsc.exe\n\n_C2_\n\n195[.]123.234.11\n\n_Additional Buer Loader (contacts 195[.]123.234.11)_\n\nbd734170160b363e70602626baab37a1eb93cfb2d254cf17b6ff1b5e7313b568\n\n9d1be741e3b09057cdaffb6e87d602afff496dee364767b161dfaab7e639866d\n\n## MITRE ATT&CK\n\nInitial Access\n\nT1566.001 – Spearphishing Attachment\n\nExecution\n\nT1204.002 – Malicious File\n\nPersistence\n\nT1547.001 – Registry Run Keys / Startup Folder\n\nDefense Evasion\n\nT1218 – Signed Binary Proxy Execution\n\nT1480.001 – Environmental Keying\n\nT1497.001 – System Checks\n\nT1553.002 – Code Signing\n\nDiscovery\n\nT1082 – System Information Discovery\n\n\n-----\n\nT1497.001 – System Checks\n\nCollection\n\nT1005 – Data from Local System\n\nCommand and Control\n\nT1071.001 – Web Protocols\n\nT1105 – Ingress Tool Transfer\n\nExfiltration\n\nT1041 – Exfiltration Over C2 channel\n\n_Learn more about Fortinet’s_ _[FortiGuard Labs threat research and intelligence organization](https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguard-labs)_\n_[and the FortiGuard Security Subscriptions and Services portfolio.](https://www.fortinet.com/fortiguard/labs?tab=security-bundles&utm_source=blog&utm_campaign=security-bundles)_\n\n_Learn more about Fortinet’s_ _[free cybersecurity training, an initiative of Fortinet’s Training](https://www.fortinet.com/training/cybersecurity-professionals?utm_source=blog&utm_medium=campaign&utm_campaign=Freetraininginitiative)_\n_Advancement Agenda (TAA), or about the_ _Fortinet Network Security Expert_\n_[program, Security Academy program, and](https://training.fortinet.com/local/staticpage/view.php?page=fnsa&utm_source=pr&utm_campaign=fnsa)_ _[Veterans program. Learn more about FortiGuard](https://www.fortinet.com/corporate/careers/vets.html?utm_source=blog&utm_campaign=fortivet)_\n_Labs global threat intelligence and research and the FortiGuard Security Subscriptions and_\n_Services portfolio._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-19 - Signed, Sealed, and Delivered – Signed XLL File Delivers Buer Loader.pdf"
    ],
    "report_names": [
        "2021-07-19 - Signed, Sealed, and Delivered – Signed XLL File Delivers Buer Loader.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535999,
    "ts_updated_at": 1743041125,
    "ts_creation_date": 1653764470,
    "ts_modification_date": 1653764470,
    "files": {
        "pdf": "https://archive.orkl.eu/a7ef490c0f2e4c1db5bec2482ee6577446a5e83e.pdf",
        "text": "https://archive.orkl.eu/a7ef490c0f2e4c1db5bec2482ee6577446a5e83e.txt",
        "img": "https://archive.orkl.eu/a7ef490c0f2e4c1db5bec2482ee6577446a5e83e.jpg"
    }
}