{
    "id": "5c243431-b8cb-4423-a1c8-288bf4ce4e25",
    "created_at": "2023-01-12T15:04:05.421633Z",
    "updated_at": "2025-03-27T02:05:55.00619Z",
    "deleted_at": null,
    "sha1_hash": "9b2c47e324600c1f720db7832958919350a4ec2d",
    "title": "2020-08-12 - IcedID Campaign Strikes Back",
    "authors": "",
    "file_creation_date": "2022-05-28T03:54:45Z",
    "file_modification_date": "2022-05-28T03:54:45Z",
    "file_size": 1263200,
    "plain_text": "# IcedID Campaign Strikes Back\n\n**[blogs.juniper.net/en-us/threat-research/iceid-campaign-strikes-back](https://blogs.juniper.net/en-us/threat-research/iceid-campaign-strikes-back)**\n\nAugust 12, 2020\n\n[In our previous blog about IcedID, we explored some of the changes in the malware and](https://blogs.juniper.net/en-us/threat-research/covid-19-and-fmla-campaigns-used-to-install-new-icedid-banking-malware)\nhow it tries to evade detection. We also detailed how threat actors took advantage of the\nCOVID-19 pandemic to phish their target victims. Recently, we discovered an evolution in\ntheir phishing methods, particularly how they attempt to evade detection by implementing a\npassword protected attachment, keyword obfuscation and minimalist macro code in their\ntrojanized documents. This time, they also use a DLL for the second stage downloader,\nwhich shows a new maturity level of this threat actor.\n\n## Phishing Victims\n\nIn the current campaign discovered in July 2020, an email phishing campaign is performed\nusing compromised business accounts where the recipients are customers of the same\nbusinesses. This makes the phish that much more likely to succeed, given the sender and\nthe recipient have an established business relationship. One example we are going to\nhighlight is from a compromise of PrepNow.com, a private, nationwide student tutoring\ncompany with business presence in many states.\n\n\n-----\n\nThe phishing emails are sent to potential victims from the accounting department and\npurported to include an invoice. The attachment is a password protected zip file named\nrequest.zip. The password protection is to prevent anti-malware analysis solutions from\ndecrypting and inspecting the attachment. The password is included in the email message\nbody, in the hopes that the victim would read the email, locate the password and use it to\nopen the attached file.\n\nAn interesting characteristic of these messages is the word “attached” is obfuscated in\nmultiple ways. This may be an attempt for this phish to bypass spam filters or phishing\ndetection systems that could be looking for such keywords. However, this is useless because\nthere is no need for any security solution to rely on the word “attached” to figure out there is\nan attachment. If anything, we expected the obfuscation to obfuscate the word “password”\nbecause that’s a tell-tale sign of something phishy going on. Then again, modifying the body\nof the email ever so slightly may change some fuzzy hashes email security solutions\ncalculate to identify bulk email campaigns.\n\nAdditionally, the campaign has rotated the file name used for the attachment inside the zip\nfile. Again, this seems futile, since the password protection should prevent most security\nsolutions from opening and inspecting the content.\n\nNonetheless, this technique proved successful against Google’s Gmail security, which did\nnot block this email.\n\nSample\n\nemail containing the password protected Request.zip sha256:\n\n\n-----\n\n2beadfb91e794860aad159dcca1c94855a99b9bc908d03d10cea005dad652422 MS Word\nDocument inside zip file: legal paper_07.23.2020.doc: Sha 256:\n9b0ff58ddedd7a78e3b8f28c9c5a4934ea9f4dc530d57cc7715bdca6687590fc\n\nAnother example showing a slightly different obfuscation of the word “attached” Request.zip\n(sha256): d80dc6c07eedf0cbccedf9427accef8bcb067b9dc1eaf4f81b9ee968854eb176 legal\nagreement.07.20.doc (inside request.zip)\ndc6452b6b0683223c0d87970c600ebbda3ed6c4dab14649beff12be59842f59c\n\nYet another sample email with a third way of obfuscating the word attached Request.zip\n(sha256):\n\n\n-----\n\n78fd08878d1f5025ecf7dcf1f0460a4d00f7c50ea281b35c190cd3f8aecf61af\nQuestion_07.20.doc (inside request.zip)\n469fc41ba6d15f2af6bcf369e39c5c06b8bb5d991c008efadbfd409d096e911b\nLet’s take a look at the malicious documents in the attachments.\n\n## First Stage: MS Office Documents Macro Downloader\n\nIn short, once the zip file is expanded, the user finds a Microsoft Word document that\ncontains a macro that executes upon opening the document. There is the usual social\nengineering attempt to get victims to enable macros, which claims the document was created\nwith a previous version of MS Word, in this case. Once macros are enabled, the VB script\nwill download a DLL, save it as a PDF and install it as a service using regsvr32 to guarantee\npersistence.\n\nThe authors have resorted to being “minimalist” in this recent campaign. The “macro” code is\nvery simple and straightforward but they managed to add a few tricks to evade detection. For\ninstance, all strings and function calls in the macro are obfuscated.\n\n\n-----\n\nThere are also instances where the URL is saved as an XML file inside the document.\n\n\n-----\n\nTo some extent, these few tricks worked. Virustotal hits were low at first submission on the\nsamples from July 20.\n\nSha256: 469fc41ba6d15f2af6bcf369e39c5c06b8bb5d991c008efadbfd409d096e911b\n\nSource: virustotal.com\n\nSha256: dc6452b6b0683223c0d87970c600ebbda3ed6c4dab14649beff12be59842f59c\n\n## Second Stage: DLL Trojan\n\nIn our observation, the second stage payload consists of a DLL that is downloaded from\n3wuk8wv[.]com or 185.43.4[.]241, which is hosted on a\n\nhosting provider in Russian Siberia [https://ispserver.com/](https://ispserver.com/)\n\nOnce downloaded, the malicious DLL is saved as a pdf file, then the macro executes it via a\ncall to regsvr32.exe.\n\n\n-----\n\nPcap capture of downloading of DLL\nOur sample has very few detection on Virustotal, upon initial submission.\n\n## Third Stage: Malicious Payload Downloader\n\nOnce launched, the DLL will download the next stage from the domain loadhnichar[.]co as a\nPNG file and decrypt it. Similar to the second stage loader we analyzed in our previous blog,\nthis loader blends its traffic with requests to benign domains, such as apple.com, twitter.com,\nmicrosoft.com, etc. to look more benign to sandboxes trying to analyze it.\n\n\n-----\n\nUnfortunately, at the time of our testing, the download domain, loadhnichar[.]co for the next\nstage is already down.\n\nUsing a similar sample from malware-traffic analysis, https://malware-trafficanalysis.net/2020/07/20/index.html, we analyzed the next stages.\n\nWe have not found any changes from this stage, compared to our previous analysis. The\nsecond stage will download the third stage as a PNG file, decrypt it and run it. It will be saved\nas {random}.exe and will create a scheduled task for persistence. The third stage will\ndownload the IcedID main module as a PNG file, spawn a msiexec.exe process and inject\nthe IcedID main module into it.\n\nJuniper Advanced Threat Prevention (ATP) detects this file as malware.\n\n\n-----\n\n## Indicators of Compromise\n\n**sha256** **Notes**\n\n2beadfb91e794860aad159dcca1c94855a99b9bc908d03d10cea005dad652422 request.zip\n\nd80dc6c07eedf0cbccedf9427accef8bcb067b9dc1eaf4f81b9ee968854eb176 request.zip\n\n78fd08878d1f5025ecf7dcf1f0460a4d00f7c50ea281b35c190cd3f8aecf61af request.zip\n\n9b0ff58ddedd7a78e3b8f28c9c5a4934ea9f4dc530d57cc7715bdca6687590fc doc\n\ndc6452b6b0683223c0d87970c600ebbda3ed6c4dab14649beff12be59842f59c doc\n\n469fc41ba6d15f2af6bcf369e39c5c06b8bb5d991c008efadbfd409d096e911b doc\n\n3wuk8wv[.]com 2nd stage\n\n185.43.4[.]241 2nd stage\n\n_Special thanks to Alexander Burt and Mounir Hahad from Juniper Threat Labs for_\n_participating in the analysis and writing of this blog._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-08-12 - IcedID Campaign Strikes Back.pdf"
    ],
    "report_names": [
        "2020-08-12 - IcedID Campaign Strikes Back.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535845,
    "ts_updated_at": 1743041155,
    "ts_creation_date": 1653710085,
    "ts_modification_date": 1653710085,
    "files": {
        "pdf": "https://archive.orkl.eu/9b2c47e324600c1f720db7832958919350a4ec2d.pdf",
        "text": "https://archive.orkl.eu/9b2c47e324600c1f720db7832958919350a4ec2d.txt",
        "img": "https://archive.orkl.eu/9b2c47e324600c1f720db7832958919350a4ec2d.jpg"
    }
}