{
    "id": "9105569c-d9fd-4950-9016-568a0ff63acf",
    "created_at": "2023-01-12T15:05:07.882181Z",
    "updated_at": "2025-03-27T02:15:45.399631Z",
    "deleted_at": null,
    "sha1_hash": "2473f7c5617b24ce32301544491bbfa5b4cc4395",
    "title": "2019-07-22 - The Lazarus Injector",
    "authors": "",
    "file_creation_date": "2022-05-28T17:33:11Z",
    "file_modification_date": "2022-05-28T17:33:11Z",
    "file_size": 455731,
    "plain_text": "# The Lazarus Injector\n\n**norfolkinfosec.com/the-lazarus-injector/**\n\nnorfolk July 22, 2019\n\nIn May and June, two files were submitted to VirusTotal that were signed with the same\ndigital certificate and were connected to the SWIFT-heist wing of the DPRK. One file is re[themed version of the fake resume creating tool used in the Redbanc and Pakistan attacks.](https://norfolkinfosec.com/recent-lazarus-tools/)\nThe second file is a tool used to inject and run payloads inside of explorer.exe.\n\nThis brief post documents the capabilities of this second tool.\n\nMD5: b9ad0cc2a2e0f513ce716cdf037da907\n\nSHA1: 1a50a7ea5ca105df504c33af1c0329d36f03715b\n\nSAH256: db0f102af2d350aa1a63772e6ee9b211d78aa962a34f75c8702e71ccd261243e\n\nParameter Check\n\nThe malware expects at least one parameter: a file path (pointing towards the injected\npayload) to be passed to it during execution.\n\nThe majority of the injector’s workflow takes place within two functions. In the first function,\nthe injector checks for any arguments set during execution (coincidentally, similar to a\n[previous post on this blog). If this number is less than 3, the malware will jump to a “create](https://norfolkinfosec.com/emissary-panda-dll-backdoor/)\nfile check,” to be discussed shortly:\n\n\n-----\n\n**Checking for the number of passed**\n\n**paramters**\nIf, however, this number is great than or equal to 3, the malware will begin checking for\nexecution parameters. These can be seen in clear-text during debugging. Accepted\nparameters include -S, -E, and -D. Of these, only -S has an immediately discernible purpose:\nit causes the malware to sleep. These parameters (and the sleep function) are shown below:\n\n\n-----\n\n**Argument checks and sleep function**\n\nPayload Checks\n\nAfter checking for these parameters, the malware performs an additional check: it uses the\npassed filepath and attempts to open a handle at this location with CreateFile. If this is\nunsuccessful, the malware will exit this workflow and terminate. In addition, the malware\nmakes two additional checks: one to GetFileSize and one to ReadFile. Each is followed by a\n“test EAX EAX” instruction. In practical terms, this ensures that the file in question has a size\ngreater than zero (i.e. isn’t empty) and can be read by the malware.\n\n\n-----\n\n**File access and**\n\n**filesize checks**\nNext, the malware calls WTSEnumerateProcessesA to list the running processes. It cycles\nthrough these until it identifies the process for Explorer.exe, and which point it enters the\nsubroutine boxed below:\n\n\n-----\n\n**Process**\n\n**Enumeration**\n\nInjection Routine\n\nThis routine is the parent function for decoding and dynamically resolving several API calls\nrelated to process resolution.\n\n\n-----\n\n**Moving values that are then passed through**\n\n**a decoding and API resolution routine.**\nThe file then allocates a section of memory to Explorer and writes the payload to this\nmemory section (using the resolved APIs). It resolves the NTCreateThreadEx API and then\ncreates and executes a thread at this location:\n\n\n-----\n\n**CreateThread resolution**\n\n**and execution**\n\nCleaning Up\n\nAt this point, the malware returns to the original loop that was used to identify Explorer.exe\nas a running process. Curiously, the malware actually continues to run in this loop rather\nthan breaking the loop once it is found.\n\n\n-----\n\nOnce this loop completes, the malware will exit this function and the loader will terminate. If\nthe -D or -S parameters were specified, the malware will overwrite the original contents of\nthe loaded payload and then delete this file from disk. If -E is specified, the malware will\nactually skip this step.\n\n**Code for deleting the payload**\n\n**from disk**\nAt this stage, the payload is expected to be run in memory and the “loading” is complete.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-07-22 - The Lazarus Injector.pdf"
    ],
    "report_names": [
        "2019-07-22 - The Lazarus Injector.pdf"
    ],
    "threat_actors": [
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c980ea7-04c4-4193-8535-52f87e66a96e",
            "created_at": "2024-05-01T02:03:07.994126Z",
            "updated_at": "2025-03-27T02:05:17.293799Z",
            "deleted_at": null,
            "main_name": "BRONZE UNION",
            "aliases": [
                "Budworm ",
                "Emissary Panda ",
                "Iron Tiger ",
                "Lucky Mouse ",
                "TG-3390 ",
                "Temp.Hippo ",
                "APT27 "
            ],
            "source_name": "Secureworks:BRONZE UNION",
            "tools": [
                " ASPXSpy",
                " China Chopper",
                " Enfal",
                " Gh0st RAT",
                " HttpBrowser",
                " Hunter",
                " HyperBro",
                " OwaAuth",
                " PlugX",
                " PoisonIvy",
                " Sysupdate",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535907,
    "ts_updated_at": 1743041745,
    "ts_creation_date": 1653759191,
    "ts_modification_date": 1653759191,
    "files": {
        "pdf": "https://archive.orkl.eu/2473f7c5617b24ce32301544491bbfa5b4cc4395.pdf",
        "text": "https://archive.orkl.eu/2473f7c5617b24ce32301544491bbfa5b4cc4395.txt",
        "img": "https://archive.orkl.eu/2473f7c5617b24ce32301544491bbfa5b4cc4395.jpg"
    }
}