{
    "id": "a68a5468-db30-4817-828b-81ef0cc778b0",
    "created_at": "2023-01-12T15:04:27.96871Z",
    "updated_at": "2025-03-27T02:05:59.272908Z",
    "deleted_at": null,
    "sha1_hash": "418d04c158d8f37b32735d9772bf0d00ae08d325",
    "title": "2021-07-21 - -Le- is not tired of this, IE is really naughty",
    "authors": "",
    "file_creation_date": "2022-05-28T23:43:32Z",
    "file_modification_date": "2022-05-28T23:43:32Z",
    "file_size": 3083717,
    "plain_text": "# 「勒」此不疲，IE 真調皮\n\n**[teamt5.org/tw/posts/internet-explorer-the-vulnerability-ridden-browser/](https://teamt5.org/tw/posts/internet-explorer-the-vulnerability-ridden-browser/)**\n\nGSS & IR Team\n\n7.21.2021GSS & IR Team\n\nShare:\nBy Tom, Peter & Jason3e7\n\n近期全球籠罩在勒索軟體的威脅下，大到法人企業、小至個人用戶，無一倖免。從針對式的\nAPT 攻擊（Advanced Persistent Threat，進階持續性攻擊）到各式網路犯罪組織，使用的勒\n索手法越發精湛與多樣化，並發展出 Ransomware as a Service（RaaS）商業模式，實現了\n「一時勒索一時爽，一直勒索一直爽」的勒索大業。\n\n本次分析的案例，攻擊手法屬於較被動的方式，透過微軟瀏覽器 IE （Internet Explorer）的弱\n點來進行勒索，而非從企業的脆弱點進行攻擊，進而入侵到核心系統大量散布勒索軟體。這種\n「願者上鉤」的攻擊方式，攻擊者等待受害單位使用 IE 瀏覽器造訪惡意網站，再發動攻擊、\n達成目的。\n\n## 技術分析\n\n\n-----\n\ntenki[.]tw 早期是用來提供氣象資訊的網站，根據我們的研究，推測可能遭攻擊者註冊，當使\n用者造訪該網站時，將進行兩次轉址，經過兩個廣告公司網站後，最終轉至惡意網站，流程如\n下圖。\n\n其中 {random}.doetax.site 包含以下已經過程式碼混淆（Obfuscation）的 JavaScript：\n\n經過解碼還原後，可以確定攻擊 payload 會使用 URL 進行 XOR，再使用 execScript 來執行\n編碼過的 JavaScript，如下圖：\n\n\n-----\n\n該編碼過的 JavaScript 使用的是 CVE-2020-0968 來針對 IE 瀏覽器進行攻擊。\n\n執行惡意程式碼後，攻擊者會再依據取得的權限不同，將使用者連線到不同的網址，如下圖：\n\n若取得是高權限，則會直接到 hxxp://1fbw726f22j65y.doetax.site/ 取得勒索軟體，否則會先到\nhxxp://2oct37evecvdw72y0b.doetax.site/ 下載惡意程式，提權後連線到\nhxxp://1fbw726f22j65y.doetax.site/ 取得勒索軟體，如下圖所示。\n\n\n-----\n\n經分析後確定勒索軟體為 Magniber，該惡意程式使用 AES CBC mode 加密檔案（key, IV:\n128），加密完成後，會使用 RSA 演算法加密 key 與 IV，加密後的 blob 會放在加密檔案的最\n後面（長度：100h）。\n\n另外我們也發現，除了使用 CVE-2020-0968 來攻擊外，也有使用 CVE-2021-26411 進行勒索\n攻擊的情境。\n\n\n-----\n\n我們進一步探討網站轉址狀況可以發現，攻擊者會利用免費資源網站來吸引使用者瀏覽，同時\n利用一透明框架覆蓋於網站上，讓使用者點擊，進而達成轉址目的。\n\n轉跳後的網站如下圖：\n\n\n-----\n\n雖然該網站並不會植入勒索軟體，但會使用 CVE-2019-1367 弱點來植入其他的後門，另外，\n雖然在 IE11、IE10 和 IE9 使用 Jscript9.dll，並不受 CVE-2019-1367 漏洞的影響，但可以強\n制 IE 使用 IE8 兼容模式，來達成漏洞的觸發。\n\n\n-----\n\n## 結論\n\n上述案例皆為採證 IE 的連線紀錄後所發現，攻擊者透過 IE 瀏覽器的漏洞來達到攻擊目的，包\n含勒索或者植入其他後門程式。攻擊者透過這些弱點進行記憶體操作的攻擊，可以有效實踐無\n檔案式（Fileless）攻擊，以利規避一些資安產品偵測的可能性。\n\n微軟官方也預計於 2022 年 6 月 25 日，徹底終止支援 IE 瀏覽器，接下來我們也可以預期，若\nIE 將來仍被發現存在重大弱點時，攻擊者可能會依循類似手法，大量進行攻擊、勒索，以達\n到其商業利益。\n\n## 建議\n\n建議將系統安全性更新至最新版本\n\n建議評估汰換已停止更新的作業系統與軟體\n\n非必要不使用 IE 瀏覽器\n\n## 參考資料\n\n\n-----\n\n[1] [https://asec.ahnlab.com/en/19273/](https://asec.ahnlab.com/en/19273/)\n\n[2] [https://asec.ahnlab.com/en/21189/](https://asec.ahnlab.com/en/21189/)\n\n[*圖片來源：Pixabay](https://pixabay.com/illustrations/browser-web-www-computer-773273/)\nShare:\n\n### Related Post\n\nTechnical Analysis\n\n4.19.2021\n\n刻在你我心底的痛！可怕的加密勒索攻擊\n\n加密勒索, 針對型勒索, Target Ransom, anti ransomware, 防勒索軟體, 勒索軟體解決方案, 勒\n索病毒掃描, 勒索病毒預防, 威脅情資, 資安情資\n\n\n-----",
    "language": "ZH",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-21 - -Le- is not tired of this, IE is really naughty.pdf"
    ],
    "report_names": [
        "2021-07-21 - -Le- is not tired of this, IE is really naughty.pdf"
    ],
    "threat_actors": [
        {
            "id": "d555c5da-abe4-42aa-a8cf-77b68905891a",
            "created_at": "2022-10-25T16:07:23.548385Z",
            "updated_at": "2025-03-27T02:02:09.857957Z",
            "deleted_at": null,
            "main_name": "Doppel Spider",
            "aliases": [
                "Gold Heron",
                "Grief Group"
            ],
            "source_name": "ETDA:Doppel Spider",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "DoppelPaymer",
                "Pay OR Grief",
                "Pay or Grief",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a0d0e1ef-3562-40a8-a021-321db92644d9",
            "created_at": "2023-01-06T13:46:39.104046Z",
            "updated_at": "2025-03-27T02:00:02.997473Z",
            "deleted_at": null,
            "main_name": "DOPPEL SPIDER",
            "aliases": [
                "GOLD HERON"
            ],
            "source_name": "MISPGALAXY:DOPPEL SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535867,
    "ts_updated_at": 1743041159,
    "ts_creation_date": 1653781412,
    "ts_modification_date": 1653781412,
    "files": {
        "pdf": "https://archive.orkl.eu/418d04c158d8f37b32735d9772bf0d00ae08d325.pdf",
        "text": "https://archive.orkl.eu/418d04c158d8f37b32735d9772bf0d00ae08d325.txt",
        "img": "https://archive.orkl.eu/418d04c158d8f37b32735d9772bf0d00ae08d325.jpg"
    }
}