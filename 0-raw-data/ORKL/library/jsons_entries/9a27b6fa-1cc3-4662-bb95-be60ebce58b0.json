{
    "id": "9a27b6fa-1cc3-4662-bb95-be60ebce58b0",
    "created_at": "2023-01-12T15:02:07.636098Z",
    "updated_at": "2025-03-27T02:05:53.381348Z",
    "deleted_at": null,
    "sha1_hash": "8daea080cb06e517f95461d2bd4a339e924108a6",
    "title": "2021-09-21 - Capturing and Detecting AndroidTester Remote Access Trojan with the Emergency VPN",
    "authors": "",
    "file_creation_date": "2022-05-27T22:51:28Z",
    "file_modification_date": "2022-05-27T22:51:28Z",
    "file_size": 1289977,
    "plain_text": "# Capturing and Detecting AndroidTester Remote Access Trojan with the Emergency VPN\n\n**civilsphereproject.org/blog/2021/9/21/capturing-and-detecting-androidtester-remote-access-trojan-with-the-**\nemergency-vpn\n\nStratosphere IPS September 21, 2021\n\nMobile remote access trojans, or RATs, are malicious programs that allow attackers to fully\ncontrol a mobile device. What does this mean in reality? The person controlling the malware\nwill be able to access information on the phone, including SMS, pictures and messaging\napplications, and also be able to steal or implant files on the phone. RATs are precision\ntools used to track and gather information about a person.\n\nIn this blog post, we show how the Emergency VPN can help identify RAT infections on\nAndroid phones. The images and network traffic included in this blog post are part of the\noriginal research by Civilsphere researcher Kamila Babayeva on the Android Mischief\nDataset [1].\n\n### Android Tester Remote Access Trojan\n\nAndroidTester is a RAT for Android that has been around since approximately 2020, and it\nis believed to be a variation of another RAT known as SpyNote. Among its functionalities,\nthe RAT can access files, SMS messages, calls, contacts, locations, accounts, applications,\nand allows access to the shell, microphone, camera, keylogs, settings, and other\nfunctionalities. This functionality is shown in Figure 1 and 2.\n\nOnce the phone is infected with the RAT, the attacker has complete access to the phone.\nAs we can see in the screenshots below, the RAT can list all the files and all the installed\napplications, among other things.\n\n\n-----\n\nFigure 1 - AndroidTester can list the entire content of the phone SD card, including\ndownloads, applications, movies, configurations, and pictures [4].\n\n\n-----\n\nFigure 2 - AndroidTester can list the applications installed on the device [5].\n\n### Capturing the Android Tester RAT with the Emergency VPN\n\nThe Emergency VPN is a service that provides a free security assessment of a phoneâ€™s\nnetwork traffic to determine if the device is infected, under attack, or compromised. The\nEmergency VPN works like any other VPN, with the addition that once you connect to the\nEmergency VPN, our team will capture the network traffic generated by the device in order\nto analyse it and find potential security threats. The high level workflow of the Emergency\nVPN is shown in Figure 3.\n\n\n-----\n\nFigure 3 - The Emergency VPN allows users to safely browse the Internet while providing a\nsecurity assessment of the network traffic to identify potential threats.\n\nTo capture the behavior of the AndroidTester RAT, we connected a Nokia Phone with\nAndroid 10 to our Emergency VPN and then infected the device with AndroidTester v.6.4.6.\nThe Nokia Phone was remotely controlled like a real attacker would do, stealing\ninformation, adding and deleting contacts, and locating the device.\n\nDuring all this time, the Emergency VPN was active and the network connections through\nthe VPN were captured and then analysed by our analysts to identify if there were malicious\nconnections identified or not.\n\n## Detecting the AndroidTester RAT with the Emergency VPN\n\nThe Emergency VPN captures and stores the network traffic in a PCAP file. This file\ncontains all the network connections the device did using the VPN and it is the primary\nsource for analysis that our researchers use to find malware infections.\n\nIn this session, the Emergency VPN was used for 1.2 hours resulting in 80MB of network\ntraffic captured. With this data, we proceed to perform our analysis.\n\nIn this investigation, we focused on three things to detect the malware infection:\n\n1. Unusual data upload: is the device uploading (a lot of) data to unusual services?\n\n2. Periodic connections: are there network connections that appear not to be human?\n\n3. Data leaks: is there any personal information being leaked on the network?\n\n\n-----\n\nThe first thing we usually look at are usual data uploads. Most users are data consumers,\ngenerally downloading more data than they send. This quick analysis highlighted one\nsuspicious connection to a server not associated with any well-known service, where the\ndevice uploaded 43MB as it can be seen below:\n\nThis connection is suspicious because the service is not known, the device uploads 43MB\nof data, but also, because compared to the other activities in the device this is an outlier.\nHowever suspicious, this alone is not enough to classify this connection as malicious and\nwe investigate further.\n\nNow that we have a connection that we consider suspicious, we analyse it to determine if\nthis connection may have been generated by a human or a program. When humans browse\nthe internet or use applications, we rarely do it in a periodic and automated fashion.\nComputers on the other hand, they do.\n\nThe Stratosphere Linux IPS is a network analysis tool that allows to quickly analyse if a\nconnection is periodic. As shown below, the connection to this server is periodic, does not\nhave an associated DNS name, and the data transfer occurs over a non-standard port\n(1337).\n\nAll of these individual findings show us that this connection appears more and more\nsuspicious. We can examine the content of the connection and, if the traffic is not\nencrypted, we can see if there is anything else pointing out if this connection is malicious.\n\nUpon examination, we find the attacker command and the device response sending the\nmobile phone number and name over the network:\n\n\n-----\n\nWith all the information gathered, our researchers will use existing Threat intelligence and\ntheir advanced knowledge on traffic analysis to try to associate the traffic with a specific\nmalware family whenever possible to facilitate the risk assessment and remediation steps\ntaken by users.\n\n[The Emergency VPN report for this device is available here. A technical in-depth analysis of](http://10.10.0.46/s/Emergency-VPN-Report-RAT01_AndroidTester.pdf)\nAndroidTester network traffic is available in the Stratosphere Blog [6].\n\n## How to Avoid Getting Infected by RATs\n\nThese are our recommendations to stay safe:\n\nInstall new apps only from the Google Play Store and trusted developers.\n\nThe Google Play Protect is enabled by default, keep it enabled at all times.\n\nClick only on links sent by people you know and trust. When in doubt, do not click.\n\nDownload and open attachments sent only by known and trusted contacts. When in\ndoubt, do not download and do not open.\n\nKeep only the essential applications installed on the phone for maximum safety.\n\nNever leave your phone unattended or unlocked, even in trusted spaces.\n\nNever share your phone PIN or Pattern, even with loved ones.\n\nRemember that you can use the service ShouldIClick to check links before clicking, and see\nits content without visiting the site directly on your phone. Get started using the Emergency\nVPN.\n\n[Should I Click?](https://www.shouldiclick.org/)\n\n[Emergency VPN](http://10.10.0.46/get-started-emergency-vpn)\n\n### References\n\n[1] Execution, Analysis and Detection of Android RATs traffic, Civilsphere,\nhttps://www.civilsphereproject.org/research/execution-analysis-and-detection-of-androidrats-traffic Accessed on 07/15/2021\n\n\n-----\n\n[2] A Study of Remote Access Trojans: This repository contains a curated list of papers,\narticles and other sources related to remote access trojans, GitHub,\n[https://github.com/stratosphereips/a-study-of-remote-access-trojans. Accessed on](https://github.com/stratosphereips/a-study-of-remote-access-trojans)\n07/15/2021.\n\n[3] ANDROID TESTER V6.4.6 (RAT) Cracked + Source, BlackHatRussia Web Archive,\nhttps://web.archive.org/web/20210705135241/https://www.blackhatrussia.com/1424android-tester-v646-rat-cracked-source.html. Accessed on 07/15/2021.\n\n[4] Screenshot from 2020-08-07 11-04-04.png, RAT01_AndroidTester,\nAndroidMischiefDataset_v2, https://mcfp.felk.cvut.cz/publicDatasets/Android-Mischief[Dataset/AndroidMischiefDataset_v2/RAT01_AndroidTester/RAT01_AndroidTester_screensh](https://mcfp.felk.cvut.cz/publicDatasets/Android-Mischief-Dataset/AndroidMischiefDataset_v2/RAT01_AndroidTester/RAT01_AndroidTester_screenshots/Screenshot%20from%202020-08-07%2011-04-04.png)\nots/Screenshot%20from%202020-08-07%2011-04-04.png. Accessed on 07/15/2021.\n\n[5] Screenshot from 2020-08-07 11-10-13.png, RAT01_AndroidTester,\nAndroidMischiefDataset_v2, https://mcfp.felk.cvut.cz/publicDatasets/Android-Mischief[Dataset/AndroidMischiefDataset_v2/RAT01_AndroidTester/RAT01_AndroidTester_screensh](https://mcfp.felk.cvut.cz/publicDatasets/Android-Mischief-Dataset/AndroidMischiefDataset_v2/RAT01_AndroidTester/RAT01_AndroidTester_screenshots/Screenshot%20from%202020-08-07%2011-10-13.png)\nots/Screenshot%20from%202020-08-07%2011-10-13.png. Accessed on 07/15/2021.\n\n[6] Dissecting a RAT. Android Tester Trojan Analysis and Decoding, Stratosphere IPS,\n[https://www.stratosphereips.org/blog/2020/12/14/ngwqj0h060yv40w1afp51fg7wo9ijy-pzlhk.](https://www.stratosphereips.org/blog/2020/12/14/ngwqj0h060yv40w1afp51fg7wo9ijy-pzlhk)\nAccessed on 07/15/2021.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-21 - Capturing and Detecting AndroidTester Remote Access Trojan with the Emergency VPN.pdf"
    ],
    "report_names": [
        "2021-09-21 - Capturing and Detecting AndroidTester Remote Access Trojan with the Emergency VPN.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535727,
    "ts_updated_at": 1743041153,
    "ts_creation_date": 1653691888,
    "ts_modification_date": 1653691888,
    "files": {
        "pdf": "https://archive.orkl.eu/8daea080cb06e517f95461d2bd4a339e924108a6.pdf",
        "text": "https://archive.orkl.eu/8daea080cb06e517f95461d2bd4a339e924108a6.txt",
        "img": "https://archive.orkl.eu/8daea080cb06e517f95461d2bd4a339e924108a6.jpg"
    }
}