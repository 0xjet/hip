{
    "id": "07fee0a6-db11-43b2-8a9c-332a76ae0af8",
    "created_at": "2023-01-12T15:04:34.526602Z",
    "updated_at": "2025-03-27T02:16:26.482049Z",
    "deleted_at": null,
    "sha1_hash": "7ae7fdfe55d077b2a226e858928019bde173375f",
    "title": "2021-10-28 - Rooting Malware Makes a Comeback- Lookout Discovers Global Campaign",
    "authors": "",
    "file_creation_date": "2022-05-27T21:11:11Z",
    "file_modification_date": "2022-05-27T21:11:11Z",
    "file_size": 993878,
    "plain_text": "# Rooting Malware Makes a Comeback: Lookout Discovers Global Campaign\n\n**[blog.lookout.com/lookout-discovers-global-rooting-malware-campaign](https://blog.lookout.com/lookout-discovers-global-rooting-malware-campaign)**\n\n[Security researchers at the Lookout Threat Lab have identified a new rooting malware](https://lookout.com/resources/threat-lab?utm_source=BL&utm_medium=WB&utm_campaign=WW-MU-EN-MU-THI---AbstractEmu_Blog.MU&utm_content=)\ndistributed on Google Play and prominent third-party stores such as the Amazon Appstore\nand the Samsung Galaxy Store.\n\nWe named the malware “AbstractEmu” after its use of code abstraction and anti-emulation\nchecks to avoid running while under analysis. A total of 19 related applications were\nuncovered, seven of which contain rooting functionality, including one on Play that had more\nthan 10,000 downloads. To protect Android users, Google promptly removed the app as\nsoon as we notified them of the malware.\n\nThis is a significant discovery because widely-distributed malware with root capabilities have\nbecome rare over the past five years. As the Android ecosystem matures there are fewer\nexploits that affect a large number of devices, making them less useful for threat actors.\n\nWhile rare, rooting malware is very dangerous. By using the rooting process to gain\nprivileged access to the Android operating system, the threat actor can silently grant\nthemselves dangerous permissions or install additional malware — steps that would normally\nrequire user interaction. Elevated privileges also give the malware access to other apps’\nsensitive data, something not possible under normal circumstances.\n\n\n-----\n\n_“Lite Launcher,” an app launcher replacement, is one of the AbstractEmu apps that appeared_\n_on Google Play. It had more than 10,000 downloads._\n\n## Who is the threat actor and what do they want?\n\nWhile we don’t know exactly who is behind AbstractEmu, we think the actors are a wellresourced group with financial motivation. Their code-base and evasion techniques — such\nas the use of burner emails, names, phone numbers and pseudonyms — are quite\nsophisticated. We also found parallels between the malware and banking trojans, such as\nthe untargeted distribution of their apps and the permissions they seek.\n\n_AbstractEmu disguised itself as a number of different apps: including utility apps, such as_\n_password managers, and system tools like app launchers or data savers. From left to right:_\n_Anti-ads Browser, Data Saver, Lite Launcher, My Phone, Night Light, All Passwords, Phone_\n_Plus._\n\n### Indiscriminate targeting\n\nOne of the major clues as to the threat actors behind AbstractEmu is based on the\nwidespread, untargeted distribution of the apps. Of the 19 apps we found related to the\nmalware, most of them were disguised as utility apps such as password or money managers,\nand system tools like file managers and app launchers. All of them appeared to be functional\nto the users. This includes “Lite Launcher” which had more than 10,000 downloads before it\nwas taken off Play.\n\nThe types of vulnerabilities AbstractEmu takes advantage of also point to a goal of targeting\nas many users as possible, as very contemporary vulnerabilities from 2019 and 2020 are\nleveraged. One of the exploits used CVE-2020-0041, a vulnerability not previously seen\nexploited in the wild by Android apps. Another exploit targeted CVE-2020-0069, a\nvulnerability found in MediaTek chips used by dozens of smartphone manufacturers that\nhave collectively sold millions of devices. As a hint to the threat actor’s technical abilities,\nthey also modified publicly available exploit code for CVE-2019-2215 and CVE-2020-0041 in\norder to add support for more targets.\n\n\n-----\n\nThe way the AbstractEmu threat actor distributes these apps is also indiscriminate. In\naddition to Google Play, Amazon Appstore and Samsung Galaxy Store, we found them on\nAptoide, APKPure and other lesser known app stores and marketplaces. In terms of\npromotions, we uncovered advertisements on social media and Android-related forums.\nWhile most were written in English, we did find one instance where the malware was\npromoted in Vietnamese. Though our telemetry showed that people in the United States\nwere the most impacted, people from a total of 17 countries were victimized by AbstractEmu.\n\n### Parallels to banking trojans\n\nIn addition to the untargeted distribution of the app, the extensive permissions granted\nthrough root access align with other financially motivated threats we have observed before.\nThis includes common permissions banking trojans request that provide them the ability to\nreceive any two-factor authentication codes sent via SMS, or run in the background and\nlaunch phishing attacks. There are also permissions that allow for remote interactions with\nthe device, such as capturing content on the screen and accessing accessibility services,\nwhich enables threat actors to interact with other apps on the device, including finance apps.\nBoth of these are similar to the permissions requested by the Anatsa and Vultur malware\nfamilies.\n\nBeyond these, Mandrake was another financially motivated threat which had extensive\nspyware capabilities similar to those seen with AbstractEmu. By having complete insight into\nthe device and its activity, the actors can tailor their attacks to the specific target and\nincrease the likelihood of success.\n\n## Multilayer malicious flow\n\nThe threat actor behind AbstractEmu takes great lengths to ensure they evade detection —\nfrom the initial infection to the third stage of the infection. Each of the techniques aren’t\nunique on their own, but when deployed as part of a campaign they indicate just how wellresourced the threat actor is.\n\nAbstractEmu does not have any sophisticated zero-click remote exploit functionality used in\nadvanced APT-style threats, it is activated simply by the user having opened the app. As the\nmalware is disguised as functional apps, most users will likely interact with them shortly after\ndownloading.\n\n### Initial infection: anti-emulation and device inspection\n\nBeyond the legitimate functionalities of the trojanized apps lies a series of steps taken to\nensure AbstractEmu isn’t detected, which are activated as soon as the user opens the app.\nThe first step is to check whether the infected device is a real device or is emulated. Similar\n[to checks seen in an open source library EmulatorDetector, the malware will look at the](https://github.com/mofneko/EmulatorDetector)\ndevice's system properties, list of installed applications and filesystem.\n\n\n-----\n\nOnce the device passes that initial analysis, the app will begin communicating with its\ncommand and control (C2) server via HTTP, expecting to receive a series of JSON\ncommands to execute. Each app contains hard-coded commands that it supports. To decide\nwhich command to execute, the app will send a large amount of data to the C2 server,\nincluding both the commands it has support for, and device data such as the device’s\nmanufacturer, model, version and serial number, telephone number and IP address.\n\n_To decide on what further actions to take, AbstractEmu apps send a large amount of data to_\n_the C2 server._\n\nOther information AbstractEmu’s C2 server checks include whether the app has root access,\nwhich app was used to install the malicious app and whether the requested permissions and\ncapabilities have been granted.\n\nIn total we found four supported commands embedded within these apps, though not all of\nthe apps offer the same capabilities.\n\n\n-----\n\n_We saw a total of four different types of JSON commands sent from AbstractEmu s C2_\n_server, which are listed above._\n\n### The rooting process: the heart of the malicious flow\n\nAt the center of AbstractEmu’s infection flow is getting root access to the Android device. By\nrooting the device, the malware is able to silently modify the device in ways that would\notherwise require user interaction and access data of other apps on the device.\n\nTo ensure the process goes smoothly, the apps are embedded with hidden, encoded files\nused during and after the rooting process — including exploit binaries targeting different\nvulnerabilities. By default, these binaries are executed in a specific order, although the C2\nserver can change that order based on how the device is configured.\n\n_By default, AbstractEmu malware attempts to execute these exploits in the order they are_\n_shown in this table. The C2 server can change that order based on the device’s_\n_configuration._\n\nIn addition to these binaries, the apps also contain three encoded shell scripts and two\nencoded binaries copied from Magisk that are used during and after the rooting process.\nMagisk is a tool that allows Android users to acquire root access on their devices.\n\nTwo of the shell scripts are used to execute the exploit binary, gain root and then use\nelevated privileges to install the Magisk components for further root access. The newly\ninstalled Magisk components are used to execute the final shell script which first extracts an\nAPK embedded in a binary to the device.\n\n\n-----\n\nThen the package manager is used to silently install a new app and grant it a number of\nintrusive permissions, such as access to contacts, call logs, SMS messages, location,\ncamera and microphone. In addition, the app will modify settings to grant itself risky\ncapabilities or reduce the device’s security. With these capabilities the app can be used to\nconduct phishing attacks and provide the actor with all the information needed for illicit\naccess to user accounts.\n\n_The malware changes the device’s settings and grants itself risky permissions, both of which_\n_make the device easier to target._\n\n### The “Settings Storage” App\n\nThe silently installed app is disguised as “Settings Storage” on the Android device. If the user\ntries to run the app, it will exit and open the legitimate settings app. The app itself does not\ncontain any malicious functionality, which makes it harder to detect. Instead, it depends\nentirely on the files that its C2 server provides during execution.\n\nAt the time of discovery, the threat actor behind AbstractEmu had already disabled the\nendpoints necessary to retrieve this additional payload from C2, which has prevented us\nfrom learning the ultimate aim of the attackers.\n\n## Rare or not, always keep your OS up to date\n\nWhile we weren’t able to discover the purpose of AbstractEmu, we gained valuable insights\ninto a modern, mass distributed rooting malware campaign, which has become rare as the\nAndroid platform matures.\n\nRooting Android or jailbreaking iOS devices are still the most invasive ways to fully\ncompromise a mobile device. What we need to keep in mind — whether you’re an IT\nprofessional or a consumer — is that mobile devices are perfect tools for cyber criminals to\nexploit, as they have countless functionalities and hold an immense amount of sensitive\ndata.\n\n\n-----\n\nTo ensure you or your organization stay secure, we recommend diligently keeping your\noperating system up to date. Additionally, we recommend downloading apps from official\nstores only, as malware taken down from these stores may still be available elsewhere.\nRegardless of which store you use, always exercise caution when installing unknown apps.\n\nOf course, you should also have dedicated mobile security software to secure against all\nmobile threats, including phishing, OS and app vulnerabilities, malware and network threats.\n\n## Indicator of compromise\n\n### AbstractEmu APKs\n\n[(Download CSV file here)](https://www.lookout.com/Uploads/csv/App_IOCs.csv)\n\n\n-----\n\n### File hashes - Exploit Files\n\n[(Download CSV file here)](https://www.lookout.com/Uploads/csv/ExploitFiles_IOCs.csv)\n\n\n-----\n\n### File hashes - Rooting Tools\n\n[(Download CSV file here)](https://www.lookout.com/Uploads/csv/RootingTools_IOCs.csv)\n\n### Network IOCs\n\n[(Download CSV file here)](https://www.lookout.com/Uploads/csv/Network_IOCs.csv)\n\n\n-----\n\n[Security researchers at the Lookout Threat Lab have identified a new rooting malware](https://lookout.com/resources/threat-lab?utm_source=BL&utm_medium=WB&utm_campaign=WW-MU-EN-MU-THI---AbstractEmu_Blog.MU&utm_content=)\ndistributed on Google Play and prominent third-party stores such as the Amazon Appstore\nand the Samsung Galaxy Store.\n\nWe named the malware “AbstractEmu” after its use of code abstraction and anti-emulation\nchecks to avoid running while under analysis. A total of 19 related applications were\nuncovered, seven of which contain rooting functionality, including one on Play that had more\nthan 10,000 downloads. To protect Android users, Google promptly removed the app as\nsoon as we notified them of the malware.\n\nThis is a significant discovery because widely-distributed malware with root capabilities have\nbecome rare over the past five years. As the Android ecosystem matures there are fewer\nexploits that affect a large number of devices, making them less useful for threat actors.\n\nWhile rare, rooting malware is very dangerous. By using the rooting process to gain\nprivileged access to the Android operating system, the threat actor can silently grant\nthemselves dangerous permissions or install additional malware — steps that would normally\nrequire user interaction. Elevated privileges also give the malware access to other apps’\nsensitive data, something not possible under normal circumstances.\n\n\n-----\n\n_Lite Launcher, an app launcher replacement, is one of the AbstractEmu apps that appeared_\n_on Google Play. It had more than 10,000 downloads._\n\n## Who is the threat actor and what do they want?\n\nWhile we don’t know exactly who is behind AbstractEmu, we think the actors are a wellresourced group with financial motivation. Their code-base and evasion techniques — such\nas the use of burner emails, names, phone numbers and pseudonyms — are quite\nsophisticated. We also found parallels between the malware and banking trojans, such as\nthe untargeted distribution of their apps and the permissions they seek.\n\n_AbstractEmu disguised itself as a number of different apps: including utility apps, such as_\n_password managers, and system tools like app launchers or data savers. From left to right:_\n_Anti-ads Browser, Data Saver, Lite Launcher, My Phone, Night Light, All Passwords, Phone_\n_Plus._\n\n### Indiscriminate targeting\n\nOne of the major clues as to the threat actors behind AbstractEmu is based on the\nwidespread, untargeted distribution of the apps. Of the 19 apps we found related to the\nmalware, most of them were disguised as utility apps such as password or money managers,\nand system tools like file managers and app launchers. All of them appeared to be functional\nto the users. This includes “Lite Launcher” which had more than 10,000 downloads before it\nwas taken off Play.\n\nThe types of vulnerabilities AbstractEmu takes advantage of also point to a goal of targeting\nas many users as possible, as very contemporary vulnerabilities from 2019 and 2020 are\nleveraged. One of the exploits used CVE-2020-0041, a vulnerability not previously seen\nexploited in the wild by Android apps. Another exploit targeted CVE-2020-0069, a\nvulnerability found in MediaTek chips used by dozens of smartphone manufacturers that\nhave collectively sold millions of devices. As a hint to the threat actor’s technical abilities,\nthey also modified publicly available exploit code for CVE-2019-2215 and CVE-2020-0041 in\norder to add support for more targets.\n\nThe way the AbstractEmu threat actor distributes these apps is also indiscriminate. In\naddition to Google Play, Amazon Appstore and Samsung Galaxy Store, we found them on\nAptoide, APKPure and other lesser known app stores and marketplaces. In terms of\npromotions, we uncovered advertisements on social media and Android-related forums.\n\n\n-----\n\nWhile most were written in English, we did find one instance where the malware was\npromoted in Vietnamese. Though our telemetry showed that people in the United States\nwere the most impacted, people from a total of 17 countries were victimized by AbstractEmu.\n\n### Parallels to banking trojans\n\nIn addition to the untargeted distribution of the app, the extensive permissions granted\nthrough root access align with other financially motivated threats we have observed before.\nThis includes common permissions banking trojans request that provide them the ability to\nreceive any two-factor authentication codes sent via SMS, or run in the background and\nlaunch phishing attacks. There are also permissions that allow for remote interactions with\nthe device, such as capturing content on the screen and accessing accessibility services,\nwhich enables threat actors to interact with other apps on the device, including finance apps.\nBoth of these are similar to the permissions requested by the Anatsa and Vultur malware\nfamilies.\n\nBeyond these, Mandrake was another financially motivated threat which had extensive\nspyware capabilities similar to those seen with AbstractEmu. By having complete insight into\nthe device and its activity, the actors can tailor their attacks to the specific target and\nincrease the likelihood of success.\n\n## Multilayer malicious flow\n\nThe threat actor behind AbstractEmu takes great lengths to ensure they evade detection —\nfrom the initial infection to the third stage of the infection. Each of the techniques aren’t\nunique on their own, but when deployed as part of a campaign they indicate just how wellresourced the threat actor is.\n\nAbstractEmu does not have any sophisticated zero-click remote exploit functionality used in\nadvanced APT-style threats, it is activated simply by the user having opened the app. As the\nmalware is disguised as functional apps, most users will likely interact with them shortly after\ndownloading.\n\n### Initial infection: anti-emulation and device inspection\n\nBeyond the legitimate functionalities of the trojanized apps lies a series of steps taken to\nensure AbstractEmu isn’t detected, which are activated as soon as the user opens the app.\nThe first step is to check whether the infected device is a real device or is emulated. Similar\n[to checks seen in an open source library EmulatorDetector, the malware will look at the](https://github.com/mofneko/EmulatorDetector)\ndevice's system properties, list of installed applications and filesystem.\n\nOnce the device passes that initial analysis, the app will begin communicating with its\ncommand and control (C2) server via HTTP, expecting to receive a series of JSON\ncommands to execute. Each app contains hard-coded commands that it supports. To decide\n\n\n-----\n\nwhich command to execute, the app will send a large amount of data to the C2 server,\nincluding both the commands it has support for, and device data such as the device’s\nmanufacturer, model, version and serial number, telephone number and IP address.\n\n_To decide on what further actions to take, AbstractEmu apps send a large amount of data to_\n_the C2 server._\n\nOther information AbstractEmu’s C2 server checks include whether the app has root access,\nwhich app was used to install the malicious app and whether the requested permissions and\ncapabilities have been granted.\n\nIn total we found four supported commands embedded within these apps, though not all of\nthe apps offer the same capabilities.\n\n_We saw a total of four different types of JSON commands sent from AbstractEmu’s C2_\n_server, which are listed above._\n\n### The rooting process: the heart of the malicious flow\n\n\n-----\n\nAt the center of AbstractEmu s infection flow is getting root access to the Android device. By\nrooting the device, the malware is able to silently modify the device in ways that would\notherwise require user interaction and access data of other apps on the device.\n\nTo ensure the process goes smoothly, the apps are embedded with hidden, encoded files\nused during and after the rooting process — including exploit binaries targeting different\nvulnerabilities. By default, these binaries are executed in a specific order, although the C2\nserver can change that order based on how the device is configured.\n\n_By default, AbstractEmu malware attempts to execute these exploits in the order they are_\n_shown in this table. The C2 server can change that order based on the device’s_\n_configuration._\n\nIn addition to these binaries, the apps also contain three encoded shell scripts and two\nencoded binaries copied from Magisk that are used during and after the rooting process.\nMagisk is a tool that allows Android users to acquire root access on their devices.\n\nTwo of the shell scripts are used to execute the exploit binary, gain root and then use\nelevated privileges to install the Magisk components for further root access. The newly\ninstalled Magisk components are used to execute the final shell script which first extracts an\nAPK embedded in a binary to the device.\n\nThen the package manager is used to silently install a new app and grant it a number of\nintrusive permissions, such as access to contacts, call logs, SMS messages, location,\ncamera and microphone. In addition, the app will modify settings to grant itself risky\ncapabilities or reduce the device’s security. With these capabilities the app can be used to\nconduct phishing attacks and provide the actor with all the information needed for illicit\naccess to user accounts.\n\n\n-----\n\n_The malware changes the device’s settings and grants itself risky permissions, both of which_\n_make the device easier to target._\n\n### The “Settings Storage” App\n\nThe silently installed app is disguised as “Settings Storage” on the Android device. If the user\ntries to run the app, it will exit and open the legitimate settings app. The app itself does not\ncontain any malicious functionality, which makes it harder to detect. Instead, it depends\nentirely on the files that its C2 server provides during execution.\n\nAt the time of discovery, the threat actor behind AbstractEmu had already disabled the\nendpoints necessary to retrieve this additional payload from C2, which has prevented us\nfrom learning the ultimate aim of the attackers.\n\n## Rare or not, always keep your OS up to date\n\nWhile we weren’t able to discover the purpose of AbstractEmu, we gained valuable insights\ninto a modern, mass distributed rooting malware campaign, which has become rare as the\nAndroid platform matures.\n\nRooting Android or jailbreaking iOS devices are still the most invasive ways to fully\ncompromise a mobile device. What we need to keep in mind — whether you’re an IT\nprofessional or a consumer — is that mobile devices are perfect tools for cyber criminals to\nexploit, as they have countless functionalities and hold an immense amount of sensitive\ndata.\n\nTo ensure you or your organization stay secure, we recommend diligently keeping your\noperating system up to date. Additionally, we recommend downloading apps from official\nstores only, as malware taken down from these stores may still be available elsewhere.\nRegardless of which store you use, always exercise caution when installing unknown apps.\n\n\n-----\n\nOf course, you should also have dedicated mobile security software to secure against all\nmobile threats, including phishing, OS and app vulnerabilities, malware and network threats.\n\n## Indicator of compromise\n\n### AbstractEmu APKs\n\n[(Download CSV file here)](https://www.lookout.com/Uploads/csv/App_IOCs.csv)\n\n### File hashes - Exploit Files\n\n\n-----\n\n[(Download CSV file here)](https://www.lookout.com/Uploads/csv/ExploitFiles_IOCs.csv)\n\n### File hashes - Rooting Tools\n\n[(Download CSV file here)](https://www.lookout.com/Uploads/csv/RootingTools_IOCs.csv)\n\n### Network IOCs\n\n[(Download CSV file here)](https://www.lookout.com/Uploads/csv/Network_IOCs.csv)\n\n\n-----\n\nOctober 28, 2021\n\nDownload Case Study\n**{{consumer=\"/components/cta/consumer\"}}**\n\nTAGS:\n\n|\n\n[Threat Intelligence](https://blog.lookout.com/tag/threat-intelligence)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-28 - Rooting Malware Makes a Comeback- Lookout Discovers Global Campaign.pdf"
    ],
    "report_names": [
        "2021-10-28 - Rooting Malware Makes a Comeback- Lookout Discovers Global Campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535874,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653685871,
    "ts_modification_date": 1653685871,
    "files": {
        "pdf": "https://archive.orkl.eu/7ae7fdfe55d077b2a226e858928019bde173375f.pdf",
        "text": "https://archive.orkl.eu/7ae7fdfe55d077b2a226e858928019bde173375f.txt",
        "img": "https://archive.orkl.eu/7ae7fdfe55d077b2a226e858928019bde173375f.jpg"
    }
}