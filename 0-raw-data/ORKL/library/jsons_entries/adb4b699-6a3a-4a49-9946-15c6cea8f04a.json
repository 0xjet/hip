{
    "id": "adb4b699-6a3a-4a49-9946-15c6cea8f04a",
    "created_at": "2023-01-12T15:05:59.344589Z",
    "updated_at": "2025-03-27T02:16:26.476661Z",
    "deleted_at": null,
    "sha1_hash": "b2a02366aba93ba6f462cc3d573da1ef51e3dd52",
    "title": "2017-02-23 - Released Android malware source code used to run a banking botnet",
    "authors": "",
    "file_creation_date": "2022-05-28T23:27:43Z",
    "file_modification_date": "2022-05-28T23:27:43Z",
    "file_size": 182907,
    "plain_text": "# Released Android malware source code used to run a banking botnet\n\n**[welivesecurity.com/2017/02/23/released-android-malware-source-code-used-run-banking-botnet/](http://www.welivesecurity.com/2017/02/23/released-android-malware-source-code-used-run-banking-botnet/)**\n\nFebruary 23, 2017\n\nESET researchers have discovered a new variant of botnet-forming Android banking malware based on source code made public a couple of\nmonths ago.\n\n[Lukas Stefanko](https://www.welivesecurity.com/author/lstefanko/)\n23 Feb 2017 - 02:00PM\n\nESET researchers have discovered a new variant of botnet-forming Android banking malware based on source code made public a couple of\nmonths ago.\n\n_Update (February 23rd): Following ESET’s notice, the hosting company took the C&C server down._\n\nThe [new Android banking malware ESET recently discovered on Google Play was spotted in the wild again, targeting more banks. Further](http://www.welivesecurity.com/2017/02/22/sunny-chance-stolen-credentials-malicious-weather-app-found-google-play/)\ninvestigation of this resurfacing threat has uncovered its code was built using source code that was made public a couple of months ago.\n\nThe previous version was detected by ESET as Trojan.Android/Spy.Banker.HU (version 1.1 – as marked by its author in the source code) and\nreported on February 6 . The malware was distributed via Google Play as a trojanized version of a legitimate weather forecast applicationth\n[Good Weather. The trojan targeted 22 Turkish mobile banking apps, attempting to harvest credentials using phony login forms. Moreover, it](https://play.google.com/store/apps/details?id=org.asdtm.goodweather)\ncould lock and unlock infected devices remotely, as well as intercept text messages.\n\nLast Sunday, we discovered a new version of the trojan on Google Play, masquerading as yet another legitimate weather app, this time World\nWeather. The trojan, detected by ESET as Trojan.Android/Spy.Banker.HW (version 1.2), was available in the Google Play store from\nFebruary 14 until being reported by ESET and pulled from the store on February 20 .th th\n\n## Connecting the dots\n\nThe second discovery led to another round of investigation, which delivered some interesting revelations.\n\nAs it turns out, both of these Android trojans are based on a free source code that was made public online. Allegedly written from scratch, the\n“template” code of the Android malware, along with the code of the C&C server – including a web control panel – have been available on a\nRussian forum since December 19, 2016.th\n\n\n-----\n\n-----\n\nFigure 1 – Source code of the Android malware and of the C&C made public on a Russian forum\n\n[Subsequent investigation brought findings of Dr. Web to our attention, who analyzed one of the earlier variants of the malware (detected by](https://news.drweb.com/show/?i=11104&lng=en)\nour systems since December 26, 2016 as Android/Spy.Banker.HH).th\n\nHowever, this variant is not directly connected to those we found on Google Play, even though we detected it under the same detection name\nas version 1.0. We were able to confirm this after getting access to the control panel of the botnet’s C&C server, which was up and running at\nthe time of our investigation. Through the control panel, we were able to collect information about malware versions of all of the 2800+\ninfected bots.\n\n\n-----\n\nFigure 2 – C&C web control panel listing victims of the malware\n\nBelow is an overview of user groups affected by the malware, based on the botnet data listed in the C&C control panel:\n\n\n-----\n\n-----\n\nInterestingly enough, the C&C server itself, active since February 2, 2017, has been left accessible to whomever has the URL, without\nrequiring any credentials.\n\n\n-----\n\nFigure 3 – Investigation timeline\n\n## How does it operate?\n\nThe newly detected version has essentially the same functionalities as its predecessor. On top of the weather forecast functionalities it\nadopted from the original legitimate application, Trojan.Android/Spy.Banker.HW is able to lock and unlock infected devices remotely by setting\nthe lock screen password and intercept text messages.\n\nThe only difference between the two appears to be a wider target group – the malware now affects users of 69 British, Austrian, German and\nTurkish banking apps – and a more advanced obfuscation technique.\n\n\n-----\n\n-----\n\nFigure 4 – The malicious app on Google Play\n\nFigure 5 – Green – legitimate World Weather icon; Red – malicious version\n\nThe trojan also has an inbuilt notification functionality, the purpose of which could only be verified after having accessed the C&C server. As it\nturns out, the malware is able to display fake notifications on infected devices, prompting the user to launch one of the targeted banking apps\non behalf of an “important message” from the respective bank. By doing so, malicious activity in the form of a fake login screen is triggered.\n\n\n-----\n\nFigure 6 – C&C sending fake notification message to infected device\n\n\n-----\n\nFigure 7 – fake banking app notification sent from C&C\n\n## Has my device been infected? How do I clean it?\n\nIf you have recently installed a weather app from the Play Store, you might want to check if you haven’t been one of the victims of this\nbanking trojan.\n\nIn case you think you might have downloaded an app named Weather, look for it under Settings -> Application Manger. If you see the app\ndepicted in Fig. 8, and also find “System update” under Settings -> Security -> Device administrators (Fig. 9), your device has been infected.\n\nTo clean your device, we recommend that you turn to a mobile security solution, or you can remove the malware manually.\n\nTo manually uninstall the trojan, it is first necessary to deactivate its device administrator rights found under Settings -> Security -> System\nupdate. With that done, you can uninstall the malicious app in Settings -> Application Manger -> Weather.\n\nFigure 8: The trojan in Application Manager\n\n\n-----\n\ng g y p\n\n## How to stay safe\n\nWhile the particular group of attackers behind this botnet chose to spread the malware through trojanized weather apps and target the banks\nlisted at the bottom of this article, there is no guarantee the code isn’t or won’t be used elsewhere.\n\nWith that in mind, it’s good to stick to some basic principles to stay protected from mobile malware.\n\nAlthough not flawless, Google Play does employ advanced security mechanisms to keep malware out. As this may not be the case with\nalternative app stores or other unknown sources, opt for the official Google Play store whenever possible.\n\nWhile downloading from the Play store, make sure to get to know the app permissions before installing or updating. Instead of automatically\ngiving an app the permissions it demands, consider what they mean for the app as well as your device. If anything seems out of line, read\nwhat other users write in their reviews and rethink downloading accordingly.\n\nAfter running anything you’ve installed on your mobile device, keep paying attention to what permissions and rights it requests. An app that\nwon’t run without advanced permissions that aren’t connected to its intended function might be an app you don’t want installed on your\nphone.\n\nLast but not least, even if all else fails, a reputable mobile security solution will protect your device from active threats.\n\n[If you’d like to find out more about Android-based malware, look into our latest research on the topic.](http://www.welivesecurity.com/category/android-2/)\n\nYou’re also welcome to stop by ESET’s stand at this year’s [Mobile World Congress.](https://www.mobileworldcongress.com/)\n\n## Samples\n\n**Package Name** **Hash** **Detection**\n\ngoodish.weather CA2250A787FAC7C6EEF6158EF48A3B6D52C6BC4B Android/Spy.Banker.HH\n\ngoodish.weather A69C9BAD3DB04D106D92FD82EF4503EA012D0DA9 Android/Spy.Banker.HU\n\nfollon.weather F533761A3A67C95DC6733B92B838380695ED1E92 Android/Spy.Banker.HW\n\n## Targeted applications\n\n**Android/Spy.Banker.HH and Android/Spy.Banker.HU:**\n\ncom.garanti.cepsubesi\n\ncom.garanti.cepbank\n\ncom.pozitron.iscep\n\ncom.softtech.isbankasi\n\ncom.teb\n\ncom.akbank.android.apps.akbank_direkt\n\ncom.akbank.softotp\n\ncom.akbank.android.apps.akbank_direkt_tablet\n\ncom.ykb.androidtablet\n\ncom.ykb.android.mobilonay\n\ncom.finansbank.mobile.cepsube\n\nfinansbank.enpara\n\ncom.tmobtech.halkbank\n\nbiz.mobinex.android.apps.cep_sifrematik\n\ncom.vakifbank.mobile\n\ncom.ingbanktr.ingmobil\n\ncom.tmob.denizbank\n\ntr.com.sekerbilisim.mbank\n\ncom.ziraat.ziraatmobil\n\ncom.intertech.mobilemoneytransfer.activity\ncom.kuveytturk.mobil\n\ncom.magiclick.odeabank\n\n**Android/Spy.Banker.HW:**\n\ncom.garanti.cepsubesi\n\ncom.garanti.cepbank\n\ncom pozitron iscep\n\n\n-----\n\nco so ttec sba as\ncom.teb\ncom.akbank.android.apps.akbank_direkt\ncom.akbank.softotp\ncom.akbank.android.apps.akbank_direkt_tablet\ncom.ykb.android\ncom.ykb.androidtablet\ncom.ykb.android.mobilonay\ncom.finansbank.mobile.cepsube\nfinansbank.enpara\ncom.tmobtech.halkbank\nbiz.mobinex.android.apps.cep_sifrematik\ncom.vakifbank.mobile\ncom.ingbanktr.ingmobil\ncom.tmob.denizbank\ntr.com.sekerbilisim.mbank\ncom.ziraat.ziraatmobil\ncom.intertech.mobilemoneytransfer.activity\ncom.kuveytturk.mobil\ncom.magiclick.odeabank\ncom.isis_papyrus.raiffeisen_pay_eyewdg\nat.spardat.netbanking\nat.bawag.mbanking\nat.volksbank.volksbankmobile\ncom.bankaustria.android.olb\nat.easybank.mbanking\ncom.starfinanz.smob.android.sfinanzstatus\ncom.starfinanz.smob.android.sbanking\nde.fiducia.smartphone.android.banking.vr\ncom.db.mm.deutschebank\nde.postbank.finanzassistent\nde.commerzbanking.mobil\ncom.ing.diba.mbbr2\nde.ing_diba.kontostand\nde.dkb.portalapp\ncom.starfinanz.mobile.android.dkbpushtan\nde.consorsbank\nde.comdirect.android\nmobile.santander.de\nde.adesso.mobile.android.gad\ncom.grppl.android.shell.BOS\nuk.co.bankofscotland.businessbank\ncom.barclays.android.barclaysmobilebanking\ncom.barclays.bca\ncom.ie.capitalone.uk\ncom.monitise.client.android.clydesdale\ncom.monitise.coop\nuk.co.northernbank.android.tribank\ncom.firstdirect.bankingonthego\ncom.grppl.android.shell.halifax\ncom.htsu.hsbcpersonalbanking\ncom.hsbc.hsbcukcmb\ncom.grppl.android.shell.CMBlloydsTSB73\ncom.lloydsbank.businessmobile\nuk.co.metrobankonline.personal.mobile\nco.uk.Nationwide.Mobile\ncom.rbs.mobile.android.natwest\ncom.rbs.mobile.android.natwestbandc\ncom.rbs.mobile.android.rbsm\ncom.rbs.mobile.android.rbsbandc\nuk.co.santander.santanderUK\nuk.co.santander.businessUK.bb\ncom.tescobank.mobile\n\n\n-----\n\nu co tsb ob eba\ncom.rbs.mobile.android.ubn\ncom.monitise.client.android.yorkshire\n\n23 Feb 2017 - 02:00PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-02-23 - Released Android malware source code used to run a banking botnet.pdf"
    ],
    "report_names": [
        "2017-02-23 - Released Android malware source code used to run a banking botnet.pdf"
    ],
    "threat_actors": [
        {
            "id": "4fe925e8-95e5-4a63-9f96-4d0f9bedac08",
            "created_at": "2022-10-25T15:50:23.469077Z",
            "updated_at": "2025-03-27T02:00:55.478056Z",
            "deleted_at": null,
            "main_name": "DarkHydrus",
            "aliases": [
                "DarkHydrus"
            ],
            "source_name": "MITRE:DarkHydrus",
            "tools": [
                "Mimikatz",
                "RogueRobin",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6efb28db-4d91-46cb-8ab7-fe9e8449ccfc",
            "created_at": "2023-01-06T13:46:38.772861Z",
            "updated_at": "2025-03-27T02:00:02.914846Z",
            "deleted_at": null,
            "main_name": "DarkHydrus",
            "aliases": [
                "Obscure Serpens",
                "LazyMeerkat",
                "G0079"
            ],
            "source_name": "MISPGALAXY:DarkHydrus",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5b04780e-7b64-4e62-b776-c6749ff7dec8",
            "created_at": "2022-10-25T16:07:23.531741Z",
            "updated_at": "2025-03-27T02:02:09.84903Z",
            "deleted_at": null,
            "main_name": "DarkHydrus",
            "aliases": [
                "ATK 77",
                "DarkHydrus",
                "LazyMeerkat",
                "Obscure Serpens"
            ],
            "source_name": "ETDA:DarkHydrus",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Mimikatz",
                "Phishery",
                "RogueRobin",
                "RogueRobinNET",
                "Trojan.Phisherly",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535959,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653780463,
    "ts_modification_date": 1653780463,
    "files": {
        "pdf": "https://archive.orkl.eu/b2a02366aba93ba6f462cc3d573da1ef51e3dd52.pdf",
        "text": "https://archive.orkl.eu/b2a02366aba93ba6f462cc3d573da1ef51e3dd52.txt",
        "img": "https://archive.orkl.eu/b2a02366aba93ba6f462cc3d573da1ef51e3dd52.jpg"
    }
}