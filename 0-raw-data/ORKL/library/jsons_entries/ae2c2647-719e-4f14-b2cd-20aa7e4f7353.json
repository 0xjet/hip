{
    "id": "ae2c2647-719e-4f14-b2cd-20aa7e4f7353",
    "created_at": "2023-01-12T15:02:19.941045Z",
    "updated_at": "2025-03-27T02:15:38.141872Z",
    "deleted_at": null,
    "sha1_hash": "a5393270325aeb84673c0580d36452c819a8b1ab",
    "title": "2019-07-02 - TA505 begins summer campaigns with a new pet malware downloader, AndroMut, in the UAE, South Korea, Singapore, and the United States",
    "authors": "",
    "file_creation_date": "2022-05-28T15:58:44Z",
    "file_modification_date": "2022-05-28T15:58:44Z",
    "file_size": 1932283,
    "plain_text": "# TA505 begins summer campaigns with a new pet malware downloader, AndroMut, in the UAE, South Korea, Singapore, and the United States\n\n**[proofpoint.com/us/threat-insight/post/ta505-begins-summer-campaigns-new-pet-malware-downloader-andromut-uae-south](https://www.proofpoint.com/us/threat-insight/post/ta505-begins-summer-campaigns-new-pet-malware-downloader-andromut-uae-south)**\n\nJuly 2, 2019\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nTA505 begins summer campaigns with a new pet malware downloader, AndroMut, in the UAE, South\nKorea, Singapore, and the United States\n\n\n-----\n\nJuly 02, 2019 Matthew Mesa and Dennis Schwarz with the Proofpoint Threat Insight Team\n\n## Overview\n\nThroughout 2018, Proofpoint researchers observed threat actors increasingly distributing downloaders,\nbackdoors, information stealers, remote access trojans (RATs), and more as they abandoned ransomware\n[as their primary payload. In November 2018, TA505, a prolific actor that has been at the forefront of this](https://www.proofpoint.com/us/threat-insight/post/ta505-shifts-times)\n[trend, began distributing a new backdoor we named “ServHelper”. ServHelper has two variants: one](https://www.proofpoint.com/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505)\nfocused on remote desktop functions and a second that primarily functioned as a downloader.\n\nIn June 2019, TA505 appears to have introduced yet another new downloader malware, AndroMut, which\nhas some similarities in code and behavior to Andromeda, a long-established malware family. Proofpoint\nresearch has observed AndroMut download malware referred to as “FlawedAmmyy.” FlawedAmmyy is a\nfull-featured RAT that was first observed in early 2016 and is based on the leaked source code of a\nlegitimate shareware tool, Ammyy.\n\nAlso Read: [Leaked Ammyy Admin Source Code Turned into Malware](https://www.proofpoint.com/us/threat-insight/post/leaked-ammyy-admin-source-code-turned-malware)\nAlso Read: [Andromeda Under the Microscope (Avast)](https://blog.avast.com/andromeda-under-the-microscope)\n\n## Campaign Analysis\n\nProofpoint researchers observed two distinct campaigns by TA505 that used AndroMut to download\nFlawedAmmyy.\n\nThe first campaign used the following message details to target recipients in South Korea:\n\nSender Name:\n\n백승기\n\nSubject:\n\n쌍용 인보이스 1234\n\nURLs\n\nSee IOCs\n\n\n-----\n\nSender Name:\n\n최성은\n\nSubject:\n\n송금증 $123.12\n\nAttachment Names:\n\n20.06.2019 송금증 123.12.doc\n20.06.2019 송금증 123.12.xls\n20.06.2019 송금증 123.12.htm\n20.06.2019 송금증 123.12.html\n\nSender Name:\n\n\"Kim, DongHoon (Dongtan_Con)\"\n\nSubject:\n\n견적서\n\nAttachment Names:\n\nCml-123456-1.xls\n\nThe HTM or HTML attachments contained links to the download of an Office file. Depending on the specific\ncase, the delivered Word or Excel file used macros to execute a Msiexec command that would download\nand execute either the FlawedAmmyy loader or AndroMut. In the cases that involved AndroMut, Proofpoint\nresearchers observed it downloading FlawedAmmyy.\n\n\n-----\n\n_Figure 1: Example TA505 email used to deliver AndroMut_\n\n\n-----\n\n_Figure 2: Example TA505 document used to deliver AndroMut_\n\nThe second campaign targeted recipients at financial institutions in Singapore, UAE, and the USA. The\nmessage lures used the following details:\n\nSender:\n\nMir Imran Medhi\n\nSubject:\n\nInvoice & DOs\n\nAttachments Names:\n\ninvoice-5601.doc\ninvoice.xls\n\nSender Name:\n\nOng Kai Chin\n\nSubject:\n\nProfoma Invoice_1234\n\nAttachments Names:\n\n\n-----\n\ninvoice-1234.doc\n\nSender Name:\n\nRejeesh Aj\n\nSubject:\n\nrequest for holding cheque\n\nAttachments Names:\n\nrequest.doc\nRq20061901.doc\n\nAgain, depending on the specific case, the delivered Word or Excel file used macros to execute a Msiexec\ncommand that would download and execute either the FlawedAmmyy loader or AndroMut. In the cases\nthat involved AndroMut, we observed it downloading FlawedAmmyy.\n\n_Figure 3: Example TA505 email with attachments used to deliver AndroMut_\n\n## AndroMut Malware Analysis\n\nAndroMut is a new downloader malware written in C++ that Proofpoint researchers began observing in the\nwild in June 2019. The “Andro” part of the name comes from some of the pieces which bear resemblance\nto another downloader malware known as Andromeda [1] and “Mut” is based off a mutex that the analyzed\nsample creates: “mutshellmy777”.\n\n## Windows API Calls\n\nThe malware resolves most of its Windows API calls at runtime by hash. The hashing algorithm is called\n“ror13AddHash32Dll” by FireEye [2] and it rotates right (ROR) each character of the DLL and API name by\n13 then adds them together Some example API hashes are:\n\n\n-----\n\nlstrcpyW - 0xE33D73B4\nCreateMutexW - 0x95898DFF\nsocket - 0xED83E9BA\n\n## String Decryption\n\nAndroMut decrypts strings in one of two ways:\n\nThe encrypted string is base64-decoded then decrypted with AES-256 in ECB mode. Each string has\nits own key and they look like 32-byte hex strings (Figure 4).\n\n_Figure 4: Example of Type 1 Encrypted Strings_\n\nThe encrypted string is stored as a stack string. Each string decrypts by performing a unique math\nproblem -- we were unable to observe any compelling patterns in the mathematics. Figure 5 shows\nan example of the string “cmd /C” being decrypted. An equivalent Python snippet of the code is\navailable on Github [3].\n\n_Figure 5: Example of Type 2 Encrypted String_\n\n## Anti-Analysis\n\nIn addition to Windows API hashing and string encryption, AndroMut uses the following anti-analysis\ntechniques:\n\nChecks for sandboxing by looking for the following process names:\n\ncmdvirth.exe (COMODO)\nSbieSvc.exe (Sandboxie)\nVMSrvc.exe (Virtual PC)\nxenservice.exe (Xen)\nChecks for mouse movement\n\n\n-----\n\nChecks for the Wine emulator by looking for the HKEY_CURRENT_USER\\SOFTWARE\\Wine\nsubkey in the Registry\nChecks for debuggers by looking for debugging flags set in the NtGlobalFlag field of its Process\nEnvironment Block (PEB)\nChecks for debuggers by setting a “Puleg” mutex, setting the\nHANDLE_FLAG_PROTECT_FROM_CLOSE flag on the mutex handle, then trying to close the\nhandle\nExplicitly zeroing memory after using important data\n\n## Persistence\n\nDepending on user privileges the malware creates persistence by either scheduling a task that executes a\ncreated LNK file in the Recycle Bin or via the “Registry run” method.\n\n## Configuration\n\nAndroMut contains five configuration pieces and stores them as type 1 encrypted strings:\n\nCommand and control (C&C) host\nC&C port\nC&C URI\nEncryption key used in C&C\nJSON key used in C&C\n\n## Command and Control\n\nThe URL is constructed from the configuration and C&C communication is established using HTTP POST\nrequests. An example response to such a request is depicted in Figure 6:\n\n_Figure 6: Example C&C response_\n\nRequest and response data are both JSON objects that contain the configured JSON key (in the analyzed\nsample, the key was “w”). The key values can be decrypted by hex-decoding and decrypting with AES-256\nin ECB using the configured C&C key (in the analyzed sample, the key was\n“736769476A5162373558736B71703962”).\n\nAn example plaintext request looks like:\n\n{\n\n\"data\": {\n\n\n-----\n\narch : true,\n\n\"cmd\": 1,\n\n\"os\": \"Win7\",\n\n\"rights\": true,\n\n\"tid\": \"<16 uppercase hex digits>\"\n\n}\n\n}\n\nIt is a JSON object that contains a data key which contains the following keys:\n\ntid - Bot ID\nos - Windows version\narch - “true” indicates x64\nrights - “true” indicates admin privileges\ncmd - Command response code\n\nAn example plaintext response looks like:\n\n{\n\n\"status\": \"200\",\n\n\"wmjf\": \"rtjlafogqsebkxuy\"\n\n}\n\nThe “status” key maps to different commands. The rest of the keys are command-specific arguments.\nAndroMut is able to execute the following commands:\n\n100 - Remove self and exit\n200 - Initial beacon response. Argument is not used and appears to be random padding\n300 - Base64 decodes the “data” value, saves it the %TEMP% directory using the “name” value, then\nexecutes it with the CreateProcessW Windows API. See below for an example:\n\n{\n\n\"data\": \"TVqQAAMA...\",\n\n\"name\": \"okbrjzxp.tmp\",\n\n\"size\": \"797048\",\n\n\"status\": \"300\",\n\n\"type\": \"application/x-msdownload\"\n\n}\n\nOther \"status\" codes include:\n\n\n-----\n\n301 - Similar to 300 command, but executes the file using cmd[.]exe [/]C\n302 - Similar to “300” command, but executes the file using the LoadLibraryEx Windows API\n303 - Update self\n\n## Payloads\n\nAt the time of publication Proofpoint researchers have only seen AndroMut deliver the FlawedAmmyy\nRemote Access Trojan (RAT) [4] in the above TA505 campaigns.\n\n## Similarity to Other Malware\n\nWhile Proofpoint researchers believe that AndroMut is a new malware family, it is worth mentioning in\npassing that some of its analysis felt familiar. Proofpoint has observed some low-confidence overlaps\nbetween it and two other malware downloaders: Andromeda [1] and QtLoader [5] [6]. The research into the\nlatter malware also noted some similarities to Andromeda.\n\n## Conclusion\n\nTA505 has helped shape the threat landscape for years, largely because of the massive volumes\nassociated with their campaigns through the end of 2017 and into 2018. Over the last two years, Proofpoint\nresearchers have observed TA505 and a number of other actors focus on downloaders, RATs, information\nstealers, and banking Trojans. With this new June 2019 push, commercial banking verticals in the United\nStates, UAE, and Singapore appear to be the primary targets as part of TA505’s usual “follow the money”\nbehavioral pattern. The new AndroMut downloader, when combined with the FlawedAmmy RAT as its\npayload appears to be TA505’s new pet for the summer of 2019.\n\n## References\n\n[1] [https://malpedia.caad.fkie.fraunhofer.de/details/win.andromeda](https://malpedia.caad.fkie.fraunhofer.de/details/win.andromeda)\n\n[2] [https://github.com/fireeye/flare-ida/tree/master/shellcode_hashes](https://github.com/fireeye/flare-ida/tree/master/shellcode_hashes)\n\n[3] [https://github.com/EmergingThreats/threatresearch/tree/master/andromut](https://github.com/EmergingThreats/threatresearch/tree/master/andromut)\n\n[4] [https://www.proofpoint.com/us/threat-insight/post/leaked-ammyy-admin-source-code-turned-malware](https://www.proofpoint.com/us/threat-insight/post/leaked-ammyy-admin-source-code-turned-malware)\n\n[5] [https://malpedia.caad.fkie.fraunhofer.de/details/win.qtbot](https://malpedia.caad.fkie.fraunhofer.de/details/win.qtbot)\n\n[6] [https://twitter.com/sysopfb/status/921396006431969280](https://twitter.com/sysopfb/status/921396006431969280)\n\n## Indicators of Compromise (IOCs)\n\n\n**IOC** **IOC**\n**Type**\n\n\n**Description**\n\n\nhxxp://greenthumbsup[.]jp/20.06.2019_746.38.doc URL TA505\nDocument\n\n\n-----\n\nhxxp://fakers[.]co[.]jp/20.06.2019_130.22.doc URL TA505\nDocument\n\nhxxp://nagomi-753[.]jp/20.06.2019_800.77.doc URL TA505\nDocument\n\nhxxp://nanepashemet[.]com/20.06.2019_781.37.xls URL TA505 Excel\nFile\n\n52f0aaff3654110e82586d21b07c8a3de23dc9efb3f4001daf412286282315c0 SHA256 TA505\nDocument\n\nd0aaf465a2569abbdcbafc049be1c1a643572f4ca185058833310435bfa53358 SHA256 TA505\nDocument\n\neb3792fc83cd65823bc466e7253caf12064826b058230666d2ed51542ac59275 SHA256 TA505 Excel\nFile\n\nf21039af47e7660bf8ef002dfcdb0c0f779210482ee1778ab7e7f51e8233e35c SHA256 TA505\nDocument\n\n3e3eb26211459eb2d8b52a2429a52e7e12d2145d7733823d7415663537a0b6ca SHA256 TA505 HTML\n\n8621fa54946096ed38aee5cbcc068c0620416a05c17328a527673e808847850d SHA256 TA505 Excel\nFile\n\nc4963dcf6b32459740f6a3d3b4d06d9dc06f15087ca01775956df36206543301 SHA256 TA505\nDocument\n\na905838db6e6617edd9d25baaaaee9c209381d456e809081977e27c3e0b15793 SHA256 TA505\nDocument\n\n59af9102a921130fd1d120f6cee7fc7cdfc28292a7a4a8c24233126604aa9443 SHA256 TA505\nDocument\n\n98b584b31457b21d0d48fcc78093439638e15dd1705e54182d9aa4ffad014c3a SHA256 TA505 Excel\nFile\n\nbb5054f0ec4e6980f65fb9329a0b5acec1ed936053c3ef0938b5fa02a9daf7ee SHA256 AndroMut\n\nhxxp://kreewalk[.com:80/viewforum.php URL C&C\n\n5eddc55c0c445baf2752d56229fa384b7e3f1c7e76b22f43e389c6a711aa713a SHA256 FlawedAmmyy\n\n\n-----\n\n## ET and ETPRO Suricata/Snort Signatures\n\n2836975     ETPRO TROJAN AndroMut Checkin\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-07-02 - TA505 begins summer campaigns with a new pet malware downloader, AndroMut, in the UAE, South Korea, Singapore, and the United States.pdf"
    ],
    "report_names": [
        "2019-07-02 - TA505 begins summer campaigns with a new pet malware downloader, AndroMut, in the UAE, South Korea, Singapore, and the United States.pdf"
    ],
    "threat_actors": [
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535739,
    "ts_updated_at": 1743041738,
    "ts_creation_date": 1653753524,
    "ts_modification_date": 1653753524,
    "files": {
        "pdf": "https://archive.orkl.eu/a5393270325aeb84673c0580d36452c819a8b1ab.pdf",
        "text": "https://archive.orkl.eu/a5393270325aeb84673c0580d36452c819a8b1ab.txt",
        "img": "https://archive.orkl.eu/a5393270325aeb84673c0580d36452c819a8b1ab.jpg"
    }
}