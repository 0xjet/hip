{
    "id": "5ca78cef-d02f-43b9-93f5-501c4ee64ce1",
    "created_at": "2023-01-12T15:00:28.028442Z",
    "updated_at": "2025-03-27T02:14:35.357228Z",
    "deleted_at": null,
    "sha1_hash": "86bbc11c205f7724eed564ad7b0be5e50fa5281e",
    "title": "2019-07-22 - BrushaLoader still sweeping up victims one year later",
    "authors": "",
    "file_creation_date": "2022-05-28T03:40:53Z",
    "file_modification_date": "2022-05-28T03:40:53Z",
    "file_size": 2155724,
    "plain_text": "# BrushaLoader still sweeping up victims one year later\n\n**[proofpoint.com/us/threat-insight/post/brushaloader-still-sweeping-victims-one-year-later](https://www.proofpoint.com/us/threat-insight/post/brushaloader-still-sweeping-victims-one-year-later)**\n\n\nJuly 22, 2019\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nBrushaLoader still sweeping up victims one year later\n\n\n-----\n\nJuly 22, 2019 Kafeine and the Proofpoint Threat Insight Team\n\n**Overview**\n\nBrushaLoader is one of a growing group of downloaders frequently employed by threat actors to profile infected\nPCs and then load more robust payloads on devices of interest. Malware like BrushaLoader contributes to the\nongoing trend of “quality over quantity” infections and enables threat actors to better stay under the radar than they\ncan with highly disruptive infections like ransomware or when distributing massive malicious spam campaigns with\nhigh-profile malware as their primary payload. At the same time, these loaders can also deliver those same\ndisruptive infections if threat actors choose to load ransomware as secondary payloads, a scenario we have\nobserved on multiple occasions recently.\n\nBrushaLoader itself first appeared in June 2018 [1]. Now, just over a year later, we have observed the loader in a\nnumber of campaigns by prominent threat actors. We derived the name for this VisualBasic/JavaScript/PowerShell\nloader from the “Rusha” author of the command and control (C&C) panel.\n\n_Figure 1: BrushaLoader C&C panel: \"Copyright\" section_\n\n**Analysis**\n\nImmediately after executing, BrushaLoader receives a PowerShell script called \"PowerEnum\" [5] (Figure 2).\n\n_Figure 2: HTTP portion of BrushaLoader delivery and post-infection activity (PowerEnum activity is not illustrated_\n_here); captured February 7, 2019_\n\n\n-----\n\nPowerEnum performs extensive fingerprinting on infected devices and sends the data back to the C&C. This\ncommunication occurs over a raw TCP \"parallel\" channel to BrushaLoader. PowerEnum is also used to send\ntasks, which were originally stored on Dropbox [2][3], and more recently were hosted on Google Drive\n\n[4].PowerEnum is integral to BrushaLoader and shares the same C&C infrastructure. Interestingly, we also\nobserved PowerEnum as a Fallout EK payload delivering Danabot Affid \"4\" (Figure 3)\n\n_Figure 3: Fallout EK dropping PowerEnum, which has been observed instructing the download of Danabot Affid 4_\n_and a BackConnect Socks.dll_\n\n**Payloads**\n\n[BrushaLoader is strongly connected to the Danabot banking Trojan Affid \"3\". However, this connection is not](https://www.proofpoint.com/us/threat-insight/post/danabot-new-banking-trojan-surfaces-down-under-0)\nexclusive as we have observed it in conjunction with other malware as well (Figure 4).\n\n\n-----\n\n_Figure 4: A selection of documented campaigns involving BrushaLoader over the last year_\n\nFigure 4 illustrates a number of noteworthy events:\n\nUnusual Payload:\n\nUrsnif in Italy\nGootkit in Canada\nNymaim in Poland\nUnusual Spreading:\n\nTA544 [6], also known as Narwhal Spider [7] on May 14, 2019, in a T-Mobile-themed campaign\n\n**The C&C panel**\n\nEarly in its distribution, we observed the BrushaLoader C&C panel and were surprised by the success of a “basic”\ncampaign using compressed-VBS attachments. Despite requiring several user interactions, the actors were able to\nensnare more than 4,000 computers in 36 hours (Figures 5 and 6).\n\n\n-----\n\n_Figure 5: BrushaLoader C&C panel - Victims a few hours after the beginning of a July 5, 2018 malicious spam_\n_campaign_\n\n\n-----\n\n_Figure 6: BrushaLoader C&C panel - Victims approximately 24 hours after the beginning of a July 5, 2018_\n_campaign (captured July 6, 2018)_\n\n\n-----\n\n_Figure 7: BrushaLoader C&C panel - Victims approximately 36 hours after the beginning of a July 5, 2018_\n_campaign (captured July 9, 2018)_\n\n_Figure 8: BrushaLoader C&C panel - Commands/Tasks_\n\n\n-----\n\n_Figure 9: BrushaLoader C&C panel - Home_\n\n_Figure 10: BrushaLoader C&C panel - The Google Drive link is the payload sent via raw TCP after PowerEnum_\n_fingerprinting_\n\n\n-----\n\n_Figure 11: BrushaLoader C&C panel - jSloader configuration_\n\n**Conclusion**\n\nThough one of many downloaders in regular use, BrushaLoader has emerged in connection with numerous\nsecondary payloads such as DanaBot and prolific actors including TA544. We have observed it in multiple\ngeographies and a variety of campaigns. Moreover, insights from the command and control panel suggest high\ninfection success rates for the loader, enabling deployment of a range of payloads by actors using the malware.\nWhile loaders fail to garner headlines like high-profile ransomware attacks, they have emerged as a key element\nof many threat actors’ toolkits. We will continue to monitor trends around this malware family and BrushaLoader in\nparticular.\n\n**Acknowledgement**\n\n[We would like to thank @Racco42 for his multiple inputs in our tracking in the past year.](https://twitter.com/racco42)\n\n**References**\n\n[1] [https://4programmers.net/Forum/Off-Topic/310825-vbs_wirus_analiza?p=1490086](https://4programmers.net/Forum/Off-Topic/310825-vbs_wirus_analiza?p=1490086)\n\n\n-----\n\n[2] [https://urlhaus.abuse.ch/url/85687/](https://urlhaus.abuse.ch/url/85687/)\n\n[3] [https://urlhaus.abuse.ch/url/74920/](https://urlhaus.abuse.ch/url/74920/)\n\n[4] [https://urlhaus.abuse.ch/url/154856/](https://urlhaus.abuse.ch/url/154856/)\n\n[5] [https://urlhaus.abuse.ch/browse.php?search=chkesosod](https://urlhaus.abuse.ch/browse.php?search=chkesosod)\n\n[6] https://www.proofpoint.com/us/threat-insight/post/urlzone-top-malware-japan-while-emotet-and-line-phishinground-out-landscape-0\n\n[7] [https://www.crowdstrike.com/blog/cutwail-spam-campaign-uses-steganography-to-distribute-urlzone/](https://www.crowdstrike.com/blog/cutwail-spam-campaign-uses-steganography-to-distribute-urlzone/)\n\n[8] [https://blog.talosintelligence.com/2019/02/combing-through-brushaloader.html](https://blog.talosintelligence.com/2019/02/combing-through-brushaloader.html)\n\n**Indicators of Compromise (IOCs)**\n\n**IOC** **IOC Type** **Description** **Date**\n\n\neb12ece1bb8ebaf888282db3c6c852f3e21397d60b45a694c424690b2d6fe838 sha256 Ursnif\ndropped by\nBrushaLoader\n\nbf70c2a22bfb0cc952b29689394e623b632f1c3371f2a6864fd26514639393aa sha256 Canada\nfocused\nGootkit\ndropped by\nBrushaLoader\n\n\n201808-21\n\n201808-02\n\n\na3f00f3b77faed13f24c8d572fe59ac38a2467449a60a1b9dc1c64baeb145b0a sha256 PowerEnum 201903-08\n\n04869bef3007a33e8bf9b14bd650e2b872daa6d2bb2b5ea35d4cb271f35d49e2 sha256 PowerEnum 201906-19\n\n\nd994f65735bb53dda95f7ab097e59bbd2043f8091d246bc4e21ba55ba6bda764 sha256 Poland\nfocused\nNymaim\ndropped by\nBrushaLoader\n\na1a6886f86ac1080d2fc3d645a8a1223209bfb1e91918d90a99b06d559ccb010 sha256 aced-VBS\nspread by\nTA544\n\nfees.tetofevent[.]online|210.16.101[.]169 domain|IP GidensTDS\nleading after\nfiltering to\nBrushaLoader\ndownload\n\nanaliticap[.]info|185.203.117.63 domain|IP PowerEnum\n(dropped by\nFallout) C&C\n\n\n201812-27\n\n201905-14\n\n201902-07\n\n201906-06\n\n\n-----\n\nhttps[:]//drive.google[.]com:443/uc?id=14ok5q46YDL8wL1HLmQyuWi0nxRgtHxq&export=download\n\n**ET and ETPRO Suricata/Snort Signatures**\n\n\nURL PowerEnum\nTask\n(Danabot\nAffid 4)\n\n\n201906-06\n\n\n2832054 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (OSVersion.Version)\n\n2832055 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (GetCurrent User)\n\n2832053 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (Win32 Get-WmiObject)\n\n2833475 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (Win32_ComputerSystem)\n\n2833477 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (System Language)\n\n2833476 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (OS Install Date)\n\n2833475 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (Win32_ComputerSystem)\n\n2833477 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (System Language)\n\n2833476 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (OS Install Date)\n\n2833478 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (Win32_VideoController)\n\n2832054 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (OSVersion.Version)\n\n2832055 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (GetCurrent User)\n\n2832053 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (Win32 Get-WmiObject)\n\n2833475 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (Win32_ComputerSystem)\n\n2833477 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (System Language)\n\n2833476 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (OS Install Date)\n\n2833478 || ETPRO INFO Possible System Enumeration via PowerShell over TCP (Win32_VideoController)\n\n2833472 || ETPRO CURRENT_EVENTS PowerShell Downloader Saving Payload to AppData Inbound Over Raw\nTCP\n\n2834482 || ETPRO TROJAN PowerEnum Sending Base64 Payload Part 1\n\n2834483 || ETPRO TROJAN PowerEnum Sending Base64 Payload Part 2\n\n2833473 || ETPRO CURRENT_EVENTS PowerShell Loader with Wide Base64 Encoded Stage 2 Inbound Over\nRaw TCP\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-07-22 - BrushaLoader still sweeping up victims one year later.pdf"
    ],
    "report_names": [
        "2019-07-22 - BrushaLoader still sweeping up victims one year later.pdf"
    ],
    "threat_actors": [
        {
            "id": "cc045f52-bbdb-4fcc-8fbf-a0d8a7c5e64f",
            "created_at": "2022-10-25T16:07:24.519535Z",
            "updated_at": "2025-03-27T02:02:10.2689Z",
            "deleted_at": null,
            "main_name": "Narwhal Spider",
            "aliases": [
                "Gold Essex"
            ],
            "source_name": "ETDA:Narwhal Spider",
            "tools": [
                "Cutwail",
                "Pushdo"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c91f7778-69aa-45fa-be0e-4ee33daf8fbd",
            "created_at": "2023-01-06T13:46:39.110148Z",
            "updated_at": "2025-03-27T02:00:02.998873Z",
            "deleted_at": null,
            "main_name": "NARWHAL SPIDER",
            "aliases": [
                "GOLD ESSEX",
                "TA544"
            ],
            "source_name": "MISPGALAXY:NARWHAL SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1f679d2e-c5c9-49e9-b854-2eca06a870e4",
            "created_at": "2022-10-25T16:07:24.453427Z",
            "updated_at": "2025-03-27T02:02:10.237233Z",
            "deleted_at": null,
            "main_name": "Bamboo Spider",
            "aliases": [
                "Bamboo Spider",
                "TA544"
            ],
            "source_name": "ETDA:Bamboo Spider",
            "tools": [
                "AndroKINS",
                "Bebloh",
                "Chthonic",
                "DELoader",
                "Dofoil",
                "GozNym",
                "Gozi ISFB",
                "ISFB",
                "Nymaim",
                "PandaBanker",
                "Pandemyia",
                "Sharik",
                "Shiotob",
                "Smoke Loader",
                "SmokeLoader",
                "Terdot",
                "URLZone",
                "XSphinx",
                "ZLoader",
                "Zeus OpenSSL",
                "Zeus Panda",
                "Zeus Sphinx",
                "ZeusPanda",
                "nymain"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "43ba91b1-fefc-493b-a75c-6af4b34e5819",
            "created_at": "2022-10-25T16:47:55.737812Z",
            "updated_at": "2025-03-27T02:05:17.357092Z",
            "deleted_at": null,
            "main_name": "GOLD ESSEX",
            "aliases": [
                "Narwhal Spider "
            ],
            "source_name": "Secureworks:GOLD ESSEX",
            "tools": [
                " Pony",
                " Pushdo",
                "Cutwail"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535628,
    "ts_updated_at": 1743041675,
    "ts_creation_date": 1653709253,
    "ts_modification_date": 1653709253,
    "files": {
        "pdf": "https://archive.orkl.eu/86bbc11c205f7724eed564ad7b0be5e50fa5281e.pdf",
        "text": "https://archive.orkl.eu/86bbc11c205f7724eed564ad7b0be5e50fa5281e.txt",
        "img": "https://archive.orkl.eu/86bbc11c205f7724eed564ad7b0be5e50fa5281e.jpg"
    }
}