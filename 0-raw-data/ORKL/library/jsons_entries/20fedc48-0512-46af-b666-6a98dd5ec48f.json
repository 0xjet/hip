{
    "id": "20fedc48-0512-46af-b666-6a98dd5ec48f",
    "created_at": "2023-01-12T15:00:37.635445Z",
    "updated_at": "2025-03-27T02:06:00.77513Z",
    "deleted_at": null,
    "sha1_hash": "1442aafd400d851b429be806cc495976c4a7c654",
    "title": "2021-07-13 - Prometheus Ransomware Decryptor",
    "authors": "",
    "file_creation_date": "2022-05-27T22:59:04Z",
    "file_modification_date": "2022-05-27T22:59:04Z",
    "file_size": 1401001,
    "plain_text": "# Prometheus Ransomware Decryptor\n\n**[medium.com/cycraft/prometheus-decryptor-6933e7bac1ea](https://medium.com/cycraft/prometheus-decryptor-6933e7bac1ea)**\n\nCyCraft Technology Corp September 16, 2021\n\n[CyCraft Technology Corp](https://medium.com/@cycrafttechnology?source=post_page-----6933e7bac1ea--------------------------------)\n\nJul 13, 2021\n\n\n8 min read\n\nThis year, CyCraft has been involved in several cases of Prometheus attacks. Naturally, we\nattempted to reverse-engineer Prometheus to gain a better understanding of the attack itself,\nthe malware, and the attacker. We discovered that it was possible to recover our customers’\nencrypted files to some degree. We are sharing this internally developed tool to help other\nvictims recover.\n\n**Visit Our GitHub |** [https://github.com/cycraft-corp/Prometheus-Decryptor](https://github.com/cycraft-corp/Prometheus-Decryptor)\n\n**Direct Download |** https://github.com/cycraft-corp/PrometheusDecryptor/releases/download/1.2/prometheus_decryptor.zip\n\n## Quick How-to Guide\n\n\n-----\n\nWe provided a GUI version for windows users. All features are supported in the GUI version.\nIf your programming skills aren’t developed to a mature level, please follow the steps below\nto decrypt your files:\n\n1. Choose a file or folder to decrypt.\n2. Choose the output file name or output folder.\n3. Select “Use thread” and fill in 2–4 for PC. (Threads usually make the decryption routine\n\nfaster, but it actually depends on the number of your CPU cores)\n4. Click decrypt.\n5. There is a counter, which shows the current guessing tickcount.\n6. The decrypting result will show in the text block below. (There may be multiple possible\n\nkeys, so the decryption routine will continue to decrypt to find more possible keys. You\ncan press “Next one” to skip the current file.)\n\n## Brief History on Prometheus\n\nThe emerging ransomware group Prometheus made headlines last month with Unit42’s\nreport. According to the report, which had observed Prometheus for 4 months, victims of the\nemerging ransomware group total more than 30 in multiple different countries, including the\n\n\n-----\n\nUnited States, the UK, and a dozen more countries in Asia, Europe, the Middle East, and\nSouth America.\n\nOrganizations targeted for attack by Prometheus included government agencies, financial\nservices, manufacturing, logistics, agriculture, healthcare services, insurance agencies,\nenergy, consulting, law firms, and more.\n\nAlthough Prometheus claimed to be affiliated with REvil (the Russia-based ransomware\ngroup attributed to the attack on global meat supplier JBS that succeeded in acquiring an 11\nmillion USD ransom, Prometheus’s code and behavior are more similar to Thanos.\n\n## Brief History on Thanos — The Possible Predecessor of Prometheus\n\nFirst observed in 2020, Thanos gained notoriety for its 43 different configuration options as\nwell as being the first ransomware to utilize the evasion technique know as RIPlace.\n\nRIPlace was introduced via a POC exploit in November 2019. Initially, RIPlace could bypass\nseveral ransomware defense mechanisms, including AV and certain EDR solutions. It wasn’t\nuntil a few months later that RIPlace was seen in the wild.\n\nLike other ransomware on the ransomware-as-a-service (RaaS) market, Thanos\nransomware does appear to have code overlaps with other ransomware, notably Hakbit;\nhowever, just like other ransomware, Thanos does come with customization options and\nappears to still be under active development.\n\n## Usage\n\n Build\n```\nmake win32  # windows 32 bitsmake win64  # windows 64 bitsmake linux  #\nlinuxmake win32GUI # windows 32 bits GUI (built on windows)make win64GUI # windows 64\nbits GUI (build on windows)\n\n Command Arguments\nUsage of ./bin/prometheus_decrypt: -b string    Custom search with byte value.\n(i.e. \\xde\\xad\\xbe\\xef -> deadbeef)    Please use ?? to match any byte (i.e. de??\nbeef) -c  Use current tickcount. (only support in Windows) -e string    \nSearch file extension. -f int    Found candidate. (default 1) -i string    \nInput encrypted file. -k string    Decrypt with this key. -m int    Move\nbackward m minutes from the current decrypted seed when guessing the next sample.\n(default 30) -o string    Output decrypted file. -p int    Use n thread.\n(default 1) -r  Reversed tickcount. -s string    Custom search with regular\nexpression. -t int    Start tickcount.\n\n Brute Force Random Seed\n\n```\n\n-----\n\nBrute force the random seed of a png image from tickcount 0.\n```\n./prometheus_decrypt -i ./sample/CyCraft.png.PROM\\[prometheushelp@mail.ch\\] -o\n./output/CyCraft.png -e png -p 16\n\n```\nIn this command, there are 4 arguments:\n\ni: input encrypted file\no: output file\ne: search file format\np: thread count\n\n## Reversed Tickcount\n\nBrute force the random seed of a png image from tickcount 100000 in reversed order.\n```\n./prometheus_decrypt -i ./sample/CyCraft.png.PROM\\[prometheushelp@mail.ch\\] -o\n./output/CyCraft.png -e png -p 16 -t 100000 -r\n\n```\nThere are 2 additional arguments:\n\nt: start from 100000\nr: reversed order (100000…0)\n\n## Brute force from current tickcount (only for Windows)\n\nBrute force the random seed of a png image from the current tickcount in reversed order.\nThis feature is usually used in reversed order.\n```\n./prometheus_decrypt -i ./sample/CyCraft.png.PROM\\[prometheushelp@mail.ch\\] -o\n./output/CyCraft.png -e png -p 16 -c -r\n\n```\nThere is an additional argument:\n\nc: start from the current tickcount\n\n## Decrypt (Encrypt) with a key\n\nDecrypt (Encrypt) a file with a provided key.\n```\n./prometheus_decrypt -i ./sample/CyCraft.png.PROM\\[prometheushelp@mail.ch\\] -o\n./output/CyCraft.png -k \"+@[%T-mZSh+E[^^i{W:dpwnhdL4<b8D4}]]\"\n\n```\nThere is an additional argument:\n\nk: provided key\n\n\n-----\n\n## Brute force random seed with custom format (regular expression)\n\nBrute force the random seed of a text file with a known string “we had another great”.\n```\n./prometheus_decrypt -i ./sample/test.txt.enc -o ./output/test.txt -p 16 -s \"we had\nanother great\"\n\n```\nThere is an additional argument:\n\ns: regular expression to match the decrypted file\n\n## Brute force the random seed with custom format (bytes pattern)\n\nBrute force the random seed of a png file with its header in hex.\n```\n./prometheus_decrypt -i ./sample/test.txt.enc -o ./output/test.txt -p 16 -b '89??4e??\n0d??1a0a??00'\n\n```\nThere is an additional argument:\n\nb: PNG header in hex format.\nThe full bytes are “8950 4e47 0d0a 1a0a 0000”.\nWe can use ?? to match any byte.\n\nCustom search with bytes pattern is much more convenient than regular expression since\nthere are lots of file format that it can’t be performed by visible characters.\n\n## Brute force the random seed for a directory\n\nBrute force the random seed of a png file with its header in hex.\n```\n./prometheus_decrypt -i ./sample -o ./output -p 16 -m 1 -f 2\n\n```\nThere are two additional arguments:\n\nm: Move backward m minutes from the current decrypted seed when guessing the next\nsample. (default 30) Use `seed-m*60*1000 as the start tickcount.`\nf: Found candidate. (default 1)Limit the candidates found. There may be several\ncandidates to a file, limit its candidates can save time.\n\nSince there are lots of files to decrypt, you can press `Ctrl-c to skip the current guessing`\nfile.\n\n## Output\n\n\n-----\n\nSince we match the file with magic number, it might be matched even if a wrong key is\nprovided. Therefore, we keep the decryption process continued to guess. You can terminate\nit anytime if you find the correct decrypted file.\n```\n% ./prometheus_decrypt -i ./sample/test.txt.enc -o ./output/test.txt -p 16 -s \"we had\nanother great\" Decrypt file with seed 615750, key: +@[%T-mZSh+E[^^i{W:dpwnhdL4<b8D4,\npath: ./output/615750_test.txt 2795306...\n\n## Supported File Format\n\n```\n[We match the magic number with https://github.com/h2non/filetype. Here is the file type we](https://github.com/h2non/filetype)\ncurrently support:\n\n## Image\n\njpg — `image/jpeg`\npng — `image/png`\ngif — `image/gif`\nwebp — `image/webp`\ncr2 — `image/x-canon-cr2`\ntif — `image/tiff`\nbmp — `image/bmp`\nheif — `image/heif`\njxr — `image/vnd.ms-photo`\npsd — `image/vnd.adobe.photoshop`\nico — `image/vnd.microsoft.icon`\ndwg — `image/vnd.dwg`\n\n## Video\n\nmp4 — `video/mp4`\nm4v — `video/x-m4v`\nmkv — `video/x-matroska`\nwebm — `video/webm`\nmov — `video/quicktime`\navi — `video/x-msvideo`\nwmv — `video/x-ms-wmv`\nmpg — `video/mpeg`\nflv — `video/x-flv`\n3gp — `video/3gpp`\n\n## Audio\n\nmid — `audio/midi`\n\n\n-----\n\nmp3 — `audio/mpeg`\nm4a — `audio/m4a`\nogg — `audio/ogg`\nflac — `audio/x-flac`\nwav — `audio/x-wav`\namr — `audio/amr`\naac — `audio/aac`\n\n## Archive\n\nepub — `application/epub+zip`\nzip — `application/zip`\ntar — `application/x-tar`\nrar — `application/vnd.rar`\ngz — `application/gzip`\nbz2 — `application/x-bzip2`\n7z — `application/x-7z-compressed`\nxz — `application/x-xz`\nzstd — `application/zstd`\npdf — `application/pdf`\nexe — `application/vnd.microsoft.portable-executable`\nswf — `application/x-shockwave-flash`\nrtf — `application/rtf`\niso — `application/x-iso9660-image`\neot — `application/octet-stream`\nps — `application/postscript`\nsqlite — `application/vnd.sqlite3`\nnes — `application/x-nintendo-nes-rom`\ncrx — `application/x-google-chrome-extension`\ncab — `application/vnd.ms-cab-compressed`\ndeb — `application/vnd.debian.binary-package`\nar — `application/x-unix-archive`\nZ — `application/x-compress`\nlz — `application/x-lzip`\nrpm — `application/x-rpm`\nelf — `application/x-executable`\ndcm — `application/dicom`\n\n## Documents\n\ndoc — `application/msword`\ndocx — `application/vnd.openxmlformats-`\n\n```\nofficedocument.wordprocessingml.document\n\n```\n\n-----\n\nxls — `application/vnd.ms-excel`\nxlsx — `application/vnd.openxmlformats-`\n```\nofficedocument.spreadsheetml.sheet\n\n```\nppt — `application/vnd.ms-powerpoint`\npptx — `application/vnd.openxmlformats-`\n\n```\nofficedocument.presentationml.presentation\n\n```\n\n## Font\n\nwoff — `application/font-woff`\nwoff2 — `application/font-woff`\nttf — `application/font-sfnt`\notf — `application/font-sfnt`\n\n## Application\n\nwasm — `application/wasm`\ndex — `application/vnd.android.dex`\ndey — `application/vnd.android.dey`\n\n## How it Works\n\nPrometheus ransomware uses salsa20 with a tickcount-based random password for\nencryption. The size of the random password is 32 bytes, and every character is a visible\ncharacter. Since the password uses tickcount as the key, we can guess it brutally.\n\n**Visit Our GitHub |** [https://github.com/cycraft-corp/Prometheus-Decryptor](https://github.com/cycraft-corp/Prometheus-Decryptor)\n\n**Direct Download |** https://github.com/cycraft-corp/PrometheusDecryptor/releases/download/1.2/prometheus_decryptor.zip\n\n## Everything Starts From Security\n\nPrevent cyber intrusions from escalating into business-altering incidents. From endpoint to\nnetwork, from investigation to blocking, from in-house to cloud, CyCraft AIR covers all\naspects required to provide small, medium, and large organizations with the proactive,\nintelligent, and adaptable security solutions needed to defend from all manner of modern\nsecurity threats with real-time protection and visibility across the organization.\n\n## Engage with CyCraft\n\n\n-----\n\nCyCraft secures government agencies, police and defense organizations, Fortune Global\n500 firms, top banks and financial institutions, critical infrastructure, airlines,\ntelecommunications, hi-tech firms, SMEs, and more by being Fast / Accurate / Simple /\n**Thorough.**\n\nCyCraft powers SOCs using innovative AI-driven technology to automate information\nsecurity protection with built-in advanced managed detection and response (MDR), global\ncyber threat intelligence (CTI), smart threat intelligence gateway (TIG) and network detection\nand response (NDR), security operations center (SOC) operations software, auto-generated\nincident response (IR) reports, enterprise-wide Health Check (Compromise Assessment,\nCA), and Secure From Home services. Everything Starts From Security.\n\n**Meet your cyber defense needs in the 2020s by engaging with CyCraft at**\n**engage@cycraft.com**\n\n## Additional Resources\n\nRead our latest white paper to learn, their motivations & how Taiwan organizations\nretain resilience against some of the most sophisticated and aggressive cyber attacks\nin the world.\nIs your SOC prepared for the next decade of cyber attacks? Read our latest report on,\nthe challenges to overcome, and the stressors to avoid — includes research from\nGartner, Inc. on why Midsize enterprises are embracing MDR providers.\nNew to the MITRE Engenuity ATT&CK Evaluations? for a fast, accurate, simple,\nthorough introductory guide to understanding the results.\nOur CyCraft AIR security platform achieved with zero configuration changes and zero\ndelayed detections straight out-of-the-box.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-13 - Prometheus Ransomware Decryptor.pdf"
    ],
    "report_names": [
        "2021-07-13 - Prometheus Ransomware Decryptor.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535637,
    "ts_updated_at": 1743041160,
    "ts_creation_date": 1653692344,
    "ts_modification_date": 1653692344,
    "files": {
        "pdf": "https://archive.orkl.eu/1442aafd400d851b429be806cc495976c4a7c654.pdf",
        "text": "https://archive.orkl.eu/1442aafd400d851b429be806cc495976c4a7c654.txt",
        "img": "https://archive.orkl.eu/1442aafd400d851b429be806cc495976c4a7c654.jpg"
    }
}