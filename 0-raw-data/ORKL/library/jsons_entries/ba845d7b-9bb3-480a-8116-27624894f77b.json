{
    "id": "ba845d7b-9bb3-480a-8116-27624894f77b",
    "created_at": "2023-01-12T15:03:02.089579Z",
    "updated_at": "2025-03-27T02:05:35.057176Z",
    "deleted_at": null,
    "sha1_hash": "15c965b36b8208e4b9aceef01ebf72c67bebe6aa",
    "title": "2021-02-16 - Cybereason vs. NetWalker Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T00:32:16Z",
    "file_modification_date": "2022-05-28T00:32:16Z",
    "file_size": 1366911,
    "plain_text": "# Cybereason vs. NetWalker Ransomware\n\n**[cybereason.com/blog/cybereason-vs.-netwalker-ransomware](https://www.cybereason.com/blog/cybereason-vs.-netwalker-ransomware)**\n\nWritten By\nCybereason Nocturnus\n\nFebruary 16, 2021 | 4 minute read\n\n\n-----\n\nThe [NetWalker ransomware has been one of the most notorious ransomware families over the](https://malpedia.caad.fkie.fraunhofer.de/details/win.mailto)\ncourse of the past year, targeting organizations in the US and Europe including several\n[healthcare organizations, despite several known threat actors publicly claiming to abstain from](https://www.bleepingcomputer.com/news/security/ransomware-gangs-to-stop-attacking-health-orgs-during-pandemic/)\ntargeting such organizations due to COVID-19.\n\n## Key Findings\n\n**Worldwide Threat: NetWalker was employed in attacks across a variety of industries around**\nthe world, which caused great damage to many organizations.\n\n**Encrypting Mapped Drives: NetWalker encrypts shared network drives of adjacent machines**\non the network.\n\n**Double Extortion Operations: The threat actor behind NetWalker threatens to publicly reveal**\nstolen data if payments are not made.\n\n**High Severity: The Cybereason Nocturnus Team assesses the threat level as HIGH given the**\ndestructive potential of the attacks.\n\n**Detected and Prevented:** [The Cybereason Defense Platform fully detects and prevents the](https://www.cybereason.com/platform)\nNetWalker ransomware.\n\n_Cybereason Blocks NetWalker Ransomware_\n\n[NetWalker ransomware first surfaced in August of 2019 (first dubbed Mailto). The group behind](https://www.mcafee.com/enterprise/en-us/threat-center/threat-landscape-dashboard/ransomware-details.mailto-ransomware.html#:~:text=The%20ransomware%2C%20also%20known%20as,all%20Microsoft%20Windows%20systems%20found.&text=The%20ransomware%20appends%20a%20random,files%20and%20uses%20Salsa20%20encryption.)\nNetWalker operates a Ransomware-as-a-Service (RaaS) business model, which means they\nprovide their infrastructure, tools and support in exchange for affiliate payment.\n\nNetWalker operators have adopted the recent popular trend among ransomware\n[purveyors:double extortion. In addition to demanding a ransom for the encrypted files, the group](https://www.bbc.com/news/technology-53214783)\nbehind NetWalker steals sensitive data and files from its victims. The group extorts the victims\nby threatening to leak the stolen data unless ransom is paid. This technique renders the practice\nof data backups all but moot in combating the impact from ransomware attacks. Other known\n[ransomware groups that leverage the double extortion paradigm are Maze,](https://malpedia.caad.fkie.fraunhofer.de/details/win.maze) [REvil, and](https://malpedia.caad.fkie.fraunhofer.de/details/win.revil)\n[DoppelPaymer.](https://malpedia.caad.fkie.fraunhofer.de/details/win.doppelpaymer)\n\nThe group behind NetWalker also maintains a blog on the Darknet where the group publishes\ninformation about its new victims alongside a countdown to the deadline for the ransom to be\npaid. If the time limit has expired and no ransom has been paid, the stolen data is published to\nthis blog:\n\n\n-----\n\n_Netwalker Blog_\n\nThe targets of NetWalker belong to various sectors, among them educational facilities, local\ngovernment, healthcare providers, and private companies. In June of 2020, three US\nuniversities were targeted with the ransomware: the University of California San Francisco,\nMichigan State University, and Columbia College of Chicago.\n\nDifferent government facilities were victims of NetWalker in [Austria and Argentina in the past](https://cointelegraph.com/news/ransomware-attack-kidnaps-austrian-city)\nyear as well. The attackers behind NetWalker do not pass on healthcare facilities as well - it has\n[been reported that NetWalker has attacked Wilmington Surgical Associates and 13GB of data](https://www.hipaajournal.com/more-than-114000-patients-affected-by-wilmington-surgical-associates-ransomware-attack/)\n[was stolen. Other healthcare facilities have been targeted as well, among them Crozer-](https://siliconangle.com/2020/03/16/ransomware-targets-hospitals-medical-providers-coronavirus-pandemic/)\nKeystone Health System.\n\nOther companies that fell victim include NameSouth, a US-based auto parts distributor, K[Electric, an electricity provider in Pakistan, and Toll Group Deliveries, an Australian](https://www.bleepingcomputer.com/news/security/new-ransomware-strain-halts-toll-group-deliveries/)\ntransportation and logistics company.\n\n## Infection\n\nThe NetWalker ransomware has operators have been observed to using several different\nmethods to infect an organization, these including the abuse of COVID-19 topics for phishing\nmails, weak credentials for Remote Desktop Protocol (RDP), exposed web applications and\n[unpatched VPNs. According to a Federal Bureau of Investigation (FBI) Flash Alert, “two of the](https://www.aha.org/system/files/media/file/2020/08/FLASH-MI-000130-MW.pdf)\nmost common vulnerabilities exploited by actors using NetWalker are Pulse Secure VPN (CVE[2019-11510) and Telerik UI (CVE-2019-18935).”](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18935)\n\nFor example, Cybereason observed an attack that started with a VBS file was attached to a\nphishing email with a COVID-19 lure content:\n\n\n-----\n\n_CORONAVIRUS_COVID-19.vbs script_\n\nUpon execution, the script will drop the ransomware to “%temp%” and execute NetWalker:\n\n_CORONAVIRUS_COVID-19.vbs script deploys NetWalker as seen in Cybereason_\n\nIn other cases, the ransomware was deployed following an interactive hacking operation using a\nported-version of the ransomware payload that was injected to explorer.exe by a PowerShell\nscript:\n\n_PowerShell payload injects NetWalker as seen in Cybereason_\n\n## Ransomware Analysis\n\n\n-----\n\nAs a means of evasion, NetWalker does not directly declare its Windows API imported function\nin the import table. Instead, the ransomware dynamically resolves all of its API as a technique\nused to make static analysis harder. NetWalker compares a CRC32 hashed value of an API\nname to the exports of specific modules, then it builds a struct that holds the address of\nNetWalker’s API:\n\n_NetWalker dynamically loads API_\n\nAfter resolving the needed API, NetWalker loads the ransomware configuration. The\nconfiguration is saved in the ransomware resources and is RC4 encrypted:\n\n\n-----\n\n_NetWalker configuration file_\n\nThe configuration file holds the following information:\n\n**Parameter** **Description**\n\nmpk Public key\n\n\n-----\n\nmode Encryption mode\n\nspsz Encryption chunk size\n\nthr Threading limit\n\nnamesz Length of generated named of persistence executable\n\nidsz Length of generated id\n\nlfile Template for the ransom file name\n\nonion TOR site\n\nlend Base64 encoded template of the ransom note\n\nwhite Whitelist of directories, files, and extensions\n\nkill Processes and Services to terminate, as well as a task to do after encryption.\n\nnet Flags for network resources encryption\n\nunlocker Exclusion during encryption\n\n_NetWalker Configuration Data_\n\n[Before encrypting the victim's files, NetWalker deletes the Windows' Shadow Copies using the](https://en.wikipedia.org/wiki/Shadow_Copy)\n_vssadmin.exe delete shadows /all /quiet command. On some variants, the command is spawned_\nby the executable of the ransomware; on others, it is spawned by the PowerShell script which\nexecutes NetWalker:\n\n_NetWalker deleted shadow copies_\n\n\n-----\n\nNext, the ransomware will start the encryption stage. NetWalker ransomware checks for valid\n[drives in the system using GetLogicalDriveStringsW. For network drives, the ransomware uses](https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-getlogicaldrivestringsw)\n_[ImpersonateLoggedOnUser in an attempt to impersonate the context of the current user in order](https://docs.microsoft.com/en-us/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateloggedonuser)_\nto access the remote drive. NetWalker then encrypts the files on the network and local drive\nusing Salsa20 encryption. After the files are encrypted, the ransom note is placed.\n\nOn some variants, NetWalker also creates persistence via the run registry key and drops a copy\nof the ransomware to C:\\Program\n_Files\\random_generated_name\\random_generated_name.exe’ or ‘C:\\Program Files_\n_(x86)\\random_generated_name\\random_generated_name.exe’._\n\n_NetWalker ransom note_\n\n## CYBEREASON DETECTION AND PREVENTION\n\nThe [Cybereason Defense Platform is able to prevent the execution of NetWalker Ransomware](https://www.cybereason.com/platform#graphic)\nusing multi-layer prevention that detects and blocks malware with threat intelligence, machine\nlearning, and Next-Gen AV (NGAV) capabilities. Additionally, when the Anti-Ransomware feature\nis enabled, behavioral detection techniques in the platform are able to detect and prevent any\n[attempt to encrypt files and generates a MalopTM:](https://www.cybereason.com/platform#malop)\n\n_Malop triggered due to the malicious activity_\n\n\n-----\n\nAdditionally, using Cybereason s PowerShell protection feature, Cybereason is able to detect\nand prevent the initial PowerShell infection stage of NetWalker:\n\n_PowerShell protection blocks script which injects NetWalker_\n\n## MITRE ATT&CK TECHNIQUES\n\n\n**Initial**\n**Access**\n\n\n**Execution** **Persistence** **Privilege**\n**Escalation**\n\n\n**Lateral**\n**Movement**\n\nTaint\n[Shared](https://attack.mitre.org/techniques/T1080/)\nContent\n\n\n**Impact**\n\nData\n[Encrypted](https://attack.mitre.org/techniques/T1486/)\nfor Impact\n\n\n[Phishing](https://attack.mitre.org/techniques/T1566/) [PowerShell](https://attack.mitre.org/techniques/T1059/001/) Registry\nRun Keys /\nStartup\nFolder\n\n[JavaScript/JScript](https://attack.mitre.org/techniques/T1059/007/)\n\n**Tom Fakterman**\n\n\nAccess\nToken\nManipulation\n\n\n**Defense**\n**Evasion**\n\nDynamiclink\nLibrary\nInjection\n\n\nTom Fakterman, Cyber Security Analyst with the Cybereason Nocturnus Research Team,\nspecializes in protecting critical networks and incident response. Tom has experience in\nresearching malware, computer forensics and developing scripts and tools for automated cyber\ninvestigations.\n\n## Netwalker Ransomware | Indicator's of Compromise\n\n### VBS | SHA-256\n\n9f9027b5db5c408ee43ef2a7c7dd1aecbdb244ef6b16d9aafb599e8c40368967\n\nad8d379a4431cabd079a1c34add903451e11f06652fe28d3f3edb6c469c43893\n\n### SHA-1\n\n\n-----\n\nc880daabaca11dde198b6340e4430401d0bfef10\n\nf26323676b7ed39590ddfedd344b0cf605393598\n\n### PowerShell | SHA-256\n\n2357e1db66083920745ec85382c3bfc7d3e0a5ef6a7abd43e600c73705cb7198\n\nf17974630cf05792a15a194a29ddae5aab8f88537cb4d12677498c21ad176cf4\n\n7aa142995da4f813829d3cf46a0b359e26c60372abd44b15256a604543c4ca22\n\nd481ca6cd079ff703d09fc4677c1e2c12dc2f4c4af51efc9ca43db873e0acd12\n\nb1b7bf1bb54b3da1b1febbf1aab3878a28e4c5b4fc73532559771ee09541a18f\n\n3053e044114b498d58a2cd2becb25d4efc1c701b6bf82658f1198f5dd03dd5c1\n\n063aef7b4bb6479e9e7e8db36ae08d1b85f9b3502d8312e61dae6c3a80f6c88e\neaa0557cc769e333db8ae06ec97f19fa93082ae8f2964094794d7135b67b1e0b\n\n7c3050a411edb10aaa9fd0c4e7ea793cfca85dc11c1aba3180e5c965f140725f\n\n7e1f41c8fa1077d5f56ef070275d206aea7f05921a5bb866375eb752a22d2eb1\n\n2bdd9326568cec881a39d11a6aef4be6a2d1d08573ba8d865eaa8a9621151259\n\n9737bbe8af662f8d1e3956f2f7e31c0df3835994f52dbc7d6347151323c6de6f\n\nfbadda96e8b96c78f38b76b883b65b83de7c27aa2fc12032b878f379c61b3544\n\n1a387a66d0ae9f0aabeb33f46856fcd8d7621d210d87494f696b831f94537f1b\n\nc98c0a52b328e834ea331f3d674d138c317443a2a0db2d13e15efd451cb1ad5c\n\nd48e2f32bfc0fe23f8543fba5c5cd75ac59261c973e0f9596ae2c0881f9c5b48\n\n### SHA-1\n\n0d75e9a2fbed9cdb31c4e46184d3a8dfcf2a6735\n1b2d111cbfcdb1c42be9c704d4ae9a10a5af6f7e\n01399a2d09aee2a0cadccd3d470bf0046d222bd8\nb0e65b8376ac99c9af4b4817a15a8f7ac9af28e1\n651d443a187bb38a5a552dff1f0e0a87ff7972f4\nd02559afe68776836f3792a9d3becc7f3e92a88d\nf3f08144aa146c38bd80acef687404cbe73a9511\n681146f3b1e84f56e6e6c7516cd210784ceca8f1\na0d0b0f0ccd09e5b83c8ed7df9222366b819d4b9\neebf51b7b4e4c3108d455289de8db416bb185be4\n53c52a1111fec1fa829f88ca081c0f3d682a33d5\n75aa6ecf7694c73aed2d2670957e39e2703740c7\n8bd97ba2060a90b7e08c8f1631c7eea92a807cca\nc440ab6e70fc6d2dff7f7b3478b03a99672d062f\n64176f72b05cf96e3a3dad206b488bdd82c5ef69\n6f88450f9eaa8710497477ec36f9d8b65f5cdb99\n\n### SHA-256\n\n\n-----\n\n57cf4470348e3b5da0fa3152be84a81a5e2ce5d794976387be290f528fa419fd\n7a19f45ab150fd544872941be5c4a2919252e3af7ede1c3981ab35a1f92bee92\n853fa18adc3f9263a0f98a9a257dd70d7e1aee0545ab47a114f44506482bd188\n8639825230d5504fd8126ed55b2d7aeb72944ffe17e762801aab8d4f8f880160\nb6456d9f3af3bda0223cf7aafed13026e7c2e8f0c5a0b540b095d900ffbcddaa\nd1d31e72a617a54648142bacc987ad860fce9b60f9813842877f2295e3a95ef4\nb7dc59261a6a5a94c6a2350be1507ffabc8737c990ac0cac84c8b2ba001add21\nbd3fdf1b50911d537a97cb93db13f2b4026f109ed23a393f262621faed81dae1\n0ec55df6c5dd2f6e5b8ce35f546e6789a61bd8906952873e174d51ee3484f6de\n1635be7dcf50c126665eaaf8737d279b4f4039123bbdb64f1e928722052e0fb5\n48924e3a42973944c65ce56842397bfce50189a9eb90cba08d23fba17d385e91\n28f3d14de7356631cc6526b9df9f1539c71f6e3d7fcb1a5382f50bd1aecb0faf\n4d38e23d5847465b21de7e99bd209ba113b47d5370f8118297d641d33db3cfc2\n72174353e04e2544f88b3b23aa228c088470e568066afabcdc5aac40bfe3ad1e\n6764c4f08019a120e1636891e05481cd226b7baa29c9b00c839161e443814d7e\nc21cc94e3b9f3999b183f12a075ab662dd12662b11dd4f9274152979bf68d4db\ne825159d11f047e54150d9e5819c6302acf151ccc9cec9e2f5fb01e030e82bf2\n8e0589b59866389754b78dd818f7b6727f532ef8834d99c0636cb7e0a5b3bdf5\ndb664e01160a2a353a2f2387b3ff03e8e5e3c29166939860cd2efb888ca479aa\nde04d2402154f676f757cf1380671f396f3fc9f7dbb683d9461edd2718c4e09d\nc414bbb789af8e3fb93b33344b31f1991582ec0f06558b29a3178d2b02465c72\n4c9a1e6a8114e2482efb00398dc2817bb5fa1a0d52328be2ce7e16e215f8fee0\n946a922d8693249525f60ddafaf3d982e32d3ed10cea73438eb353c97ab7d6bc\n58e923ff158fb5aecd293b7a0e0d305296110b83c6e270786edcc4fea1c8404c\nc6f4e1f9aa954cfd4d2e36c9b2d3e46ea0f8ad963860831211d5d3984fb6467d\n\n### SHA-1\n\n3a233709f22db2e63f41c9f095bc1bc3e1e6932d\n\n789d07687e27e9dc245fb0c754dbc48d482df7f8\n\n8e7a5500007c1552e1231bd1157433f7ef638672\n\na3bc2a30318f9bd2b51cb57e2022996e7f15c69e\n\n1156df56a6659457129a33543f46a278a49fd701\n\n51a413a1ebf50357c5377c3a3ed49a5f80977758\n\nc3acd818beaf88f75fbc3cbf44708b58aa7aced8\n\n03023d7e3a54d915cca82429dfeedb1bebd5c182\n\naced3880b62721cd2cd1d8d425086394a4e39fbc\n\ndf062e7482c73a19c69288970e90628e9dd57111\n\nccd52c78ee9843bb40df148c04b98fb63b564a76\n\n05d6978485745fe73ef3b624e39219bbcfa8c4c8\n\n3d094461dcdbb3d5c50ff368e36c73e94f702334\n\n3a34b13bd0545231aa68344412130d296e17835a\n\n156fc33f237c6d92aa56386e1f72360a46b6331a\n\nb6e43e43f3ea5d008e08126d4d172a0e2a437a08\n\n\n-----\n\n5d67c7b45c4c0f7ee324caa369404079803dea1b\n89dbeae64eaf6e9ed6bde9b7cb927b58962dde59\n63d72bc6c5b43959b25ecd091ccd20fb4edd2955\n6fd314af34409e945504e166eb8cd88127c1070e\n3abeddbbbd29310290955cc7c1a895550c92ab96\nbc0ff76bce27a22ab41038e057fd5687bf2eff1d\nD4c2fc3f782d4d2e3d64e17d6ca3ed8e6495cd01\ne393a9ecf0d0a8babaa5efcc34f10577aff1cad1\n43493ae4e94f9db1335d1e1395634d7768c7732c\n\nAbout the Author\n\n**Cybereason Nocturnus**\n\nThe Cybereason Nocturnus Team has brought the world’s brightest minds from the military,\ngovernment intelligence, and enterprise security to uncover emerging threats across the globe.\nThey specialize in analyzing new attack methodologies, reverse-engineering malware, and\nexposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to\nrelease a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.\n\n[All Posts by Cybereason Nocturnus](https://www.cybereason.com/blog/authors/cybereason-nocturnus)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-16 - Cybereason vs. NetWalker Ransomware.pdf"
    ],
    "report_names": [
        "2021-02-16 - Cybereason vs. NetWalker Ransomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535782,
    "ts_updated_at": 1743041135,
    "ts_creation_date": 1653697936,
    "ts_modification_date": 1653697936,
    "files": {
        "pdf": "https://archive.orkl.eu/15c965b36b8208e4b9aceef01ebf72c67bebe6aa.pdf",
        "text": "https://archive.orkl.eu/15c965b36b8208e4b9aceef01ebf72c67bebe6aa.txt",
        "img": "https://archive.orkl.eu/15c965b36b8208e4b9aceef01ebf72c67bebe6aa.jpg"
    }
}