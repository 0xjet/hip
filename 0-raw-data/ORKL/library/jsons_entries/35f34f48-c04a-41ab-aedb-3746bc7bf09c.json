{
    "id": "35f34f48-c04a-41ab-aedb-3746bc7bf09c",
    "created_at": "2023-01-12T14:59:35.22858Z",
    "updated_at": "2025-03-27T02:05:27.227727Z",
    "deleted_at": null,
    "sha1_hash": "b64818adcdf90958007414e1eb0dab61b33e4153",
    "title": "2020-10-22 - On the trail of the XMRig miner",
    "authors": "",
    "file_creation_date": "2022-05-28T04:49:43Z",
    "file_modification_date": "2022-05-28T04:49:43Z",
    "file_size": 394290,
    "plain_text": "# On the trail of the XMRig miner\n\n**securelist.com/miner-xmrig/99151/**\n\nAuthors\n\n[Anton Kuzmenko](https://securelist.com/author/antonkuzmenko/)\n\nAs protection methods improve, the developers of miners have had to enhance their own\ncreations, often turning to non-trivial solutions. Several such solutions (previously unseen by\nus) were detected during our analysis of the open source miner XMRig.\n\n## How it all began: ransominer\n\nAlongside well-known groups that make money from data theft and ransomware (for\nexample, Maze, which is suspected of the recent attacks on SK Hynix and LG Electronics),\nmany would-be attackers are attracted by the high-profile successes of cybercrime. In terms\nof technical capabilities, such amateurs lag far behind organized groups and therefore use\npublicly available ransomware, targeting ordinary users instead of the corporate sector.\n\n\n-----\n\nThe outlays on such attacks are often quite small, so the miscreants have to resort to various\nstratagems to maximize the payout from each infected machine. For example, in August of\nthis year, we noticed a rather curious infection method: on the victim’s machine, a Trojan (a\ncommon one detected by our solutions as Trojan.Win32.Generic) was run, which installed\nadministration programs, added a new user, and opened RDP access to the computer. Next,\nthe ransomware Trojan-Ransom.Win32.Crusis started on the same machine, followed by the\nloader of the XMRig miner, which then set about mining Monero cryptocurrency.\n\nAs a result, the computer would already start earning money for the cybercriminals just as\nthe user saw the ransom note. In addition, RDP access allowed the attackers to manually\nstudy the victim’s network and, if desired, spread the ransomware to other nodes.\n\nDetails about Trojan files:\n\nMssql — PC Hunter x64 (f6a3d38aa0ae08c3294d6ed26266693f)\nmssql2 — PC Hunter x86 (f7d94750703f0c1ddd1edd36f6d0371d)\nexe — nmap-like network scanner (597de376b1f80c06d501415dd973dcec)\nbat — removes shadow copy\nbat — creates a new user, adds it to the administrators group, opens the port for RDP\naccess, and starts the Telnet server\nexe — IOBIT Unlocker (5840aa36b70b7c03c25e5e1266c5835b)\nEVER\\SearchHost.exe — Everything software (8add121fa398ebf83e8b5db8f17b45e0)\nEVER\\1saas\\1saas.exe — ransomware Trojan-Ransom.Win32.Crusis\n(0880430c257ce49d7490099d2a8dd01a)\nEVER\\1saas \\LogDelete — miner loader (6ca170ece252721ed6cc3cfa3302d6f0,\nHEUR:Trojan-Downloader.Win32.Generic)\n\n**_Batch script systembackup.bat adds a user and opens access via RDP_**\n\nWe decided to use KSN to examine how often XMRig and its modifications get bundled with\nmalware. It emerged that in August 2020 there were more than 5,000 attempts to install it on\nusers’ computers. The parties responsible for its distribution turned out to be the Prometei\nmalware family and a new family called Cliptomaner\n\n\n-----\n\n## Prometei backdoor\n\nThe Prometei family has been known since 2016, but spotted together with XMRig for the\nfirst time in February 2020. What’s more, the backdoor was distributed in an unusual way:\nwhereas during ordinary attacks the cybercriminals gain server access through various\n[exploits, this time they used brute-force attacks. Having thus obtained usernames and](https://encyclopedia.kaspersky.com/glossary/brute-force/?utm_source=securelist&utm_medium=blog&utm_campaign=termin-explanation)\npasswords for computers with MS SQL installed, the attackers used the T-SQL function\n_xp_cmdshell to run several PowerShell scripts and elevated the privileges of the current user_\nby exploiting the CVE-2016-0099 vulnerability. After that, Purple Fox Trojan and Prometei\nitself were installed on the victim’s machine. The whole attack, starting with the brute-forcing\nof credentials to connect to the SQL server and ending with the installation of Prometei, was\ncarried out in fully automatic mode.\n\nThe installation process is of interest: the .NET executable file, packed into an ELF file using\nstandard .NET Core tools (Apphost), sends information about the infected machine to the\nC&C server, and then downloads the cryptocurrency miner and its configuration. The\nversions of the loaders for Windows and Linux differ only slightly: the .NET build for different\nplatforms saved the attackers from having to create a separate loader for Linux and allowed\ncryptocurrency mining on powerful Windows and Linux servers.\n\n## Cliptomaner miner\n\nDetected in September 2020, Cliptomaner is very similar to its fellows: like them, it not only\nmines cryptocurrency, but can also substitute cryptowallet addresses in the clipboard. The\nminer version is selected according to the computer configuration and downloaded from\nC&C. The malware is distributed under the guise of software for Realtek audio equipment.\nOn the whole, we saw no new techniques, but interestingly Cliptomaner is written entirely in\nthe AutoIT scripting language. Most of the time, families with similar behavior are written in\ncompiled languages, such as C# or C, but in this case the authors opted for a more creative\napproach, and wrote a lengthy script that selects the required version of the miner and\nreceives cryptowallet addresses from C&C for substitution.\n\n\n-----\n\n**_Substituting cryptowallets in the clipboard_**\n\nKaspersky security solutions detect the above malicious programs with the following verdicts:\nHEUR:Trojan.MSIL.Prometei.gen, HEUR:Trojan.Script.Cliptomaner.gen, HEUR:TrojanDownloader.Win32.Generic, Trojan-Ransom.Win32.Crusis, Trojan.Win64.Agentb, not-avirus:RiskTool.Win64.XMRigMiner\n\n## Indicators of compromise (IoC)\n\n### Domains\n\n[taskhostw[.]com](https://opentip.kaspersky.com/taskhostw.com/)\n\n[svchost[.]xyz](https://opentip.kaspersky.com/svchost.xyz/)\n\n[sihost[.]xyz](https://opentip.kaspersky.com/sihost.xyz/)\n\n[srhost[.]xyz](https://opentip.kaspersky.com/srhost.xyz/)\n\n[2fsdfsdgvsdvzxcwwef-defender[.]xyz](https://opentip.kaspersky.com/2fsdfsdgvsdvzxcwwef-defender.xyz/)\n\n### Cryptowallets used for substitution\n\n\n-----\n\nLTC: LPor3PrQHcQv4obYKEZpnbqQEr8LMZoUuX\n\nBTC: 33yPjjSMGHPp8zj1ZXySNJzSUfVSbpXEuL\n\nETH: 0x795957d9753e854b62C64cF880Ae22c8Ab14991b\n\nZEC: t1ZbJBqHQyytNYtCpDWFQzqPQ5xKftePPt8\n\nDODGE: DEUjj7mi5N67b6LYZPApyoV8Ek8hdNL1Vy\n\n### MD5\n\n[1273d0062a9c0a87e2b53e841b261976](https://opentip.kaspersky.com/1273d0062a9c0a87e2b53e841b261976/)\n\n[16b9c67bc36957062c17c0eff03b48f3](https://opentip.kaspersky.com/16b9c67bc36957062c17c0eff03b48f3/)\n\n[d202d4a3f832a08cb8122d0154712dd1](https://opentip.kaspersky.com/d202d4a3f832a08cb8122d0154712dd1/)\n\n[6ca170ece252721ed6cc3cfa3302d6f0](https://opentip.kaspersky.com/6ca170ece252721ed6cc3cfa3302d6f0/)\n[1357b42546dc1d202aa9712f7b29aa0d](https://opentip.kaspersky.com/1357b42546dc1d202aa9712f7b29aa0d/)\n\n[78f5094fa66a9aa4dc10470d5c3e3155](https://opentip.kaspersky.com/78f5094fa66a9aa4dc10470d5c3e3155/)\n\n[Cryptocurrencies](https://securelist.com/tag/cryptocurrencies/)\n[Financial malware](https://securelist.com/tag/financial-malware/)\n[Miner](https://securelist.com/tag/miner/)\n[Trojan](https://securelist.com/tag/trojan/)\n\nAuthors\n\n[Anton Kuzmenko](https://securelist.com/author/antonkuzmenko/)\n\nOn the trail of the XMRig miner\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-22 - On the trail of the XMRig miner.pdf"
    ],
    "report_names": [
        "2020-10-22 - On the trail of the XMRig miner.pdf"
    ],
    "threat_actors": [
        {
            "id": "529c1ae9-4579-4245-86a6-20f4563a695d",
            "created_at": "2022-10-25T16:07:23.702006Z",
            "updated_at": "2025-03-27T02:02:09.93109Z",
            "deleted_at": null,
            "main_name": "Hafnium",
            "aliases": [
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "ETDA:Hafnium",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7c969685-459b-4c93-a788-74108eab6f47",
            "created_at": "2023-01-06T13:46:39.189751Z",
            "updated_at": "2025-03-27T02:00:03.017103Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "ATK233",
                "G0125",
                "Operation Exchange Marauder",
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "MISPGALAXY:HAFNIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2704d770-43b4-4bc4-8a5a-05df87416848",
            "created_at": "2022-10-25T15:50:23.306305Z",
            "updated_at": "2025-03-27T02:00:55.43633Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "HAFNIUM",
                "Operation Exchange Marauder",
                "Silk Typhoon"
            ],
            "source_name": "MITRE:HAFNIUM",
            "tools": [
                "Tarrask",
                "ASPXSpy",
                "Impacket",
                "PsExec",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535575,
    "ts_updated_at": 1743041127,
    "ts_creation_date": 1653713383,
    "ts_modification_date": 1653713383,
    "files": {
        "pdf": "https://archive.orkl.eu/b64818adcdf90958007414e1eb0dab61b33e4153.pdf",
        "text": "https://archive.orkl.eu/b64818adcdf90958007414e1eb0dab61b33e4153.txt",
        "img": "https://archive.orkl.eu/b64818adcdf90958007414e1eb0dab61b33e4153.jpg"
    }
}