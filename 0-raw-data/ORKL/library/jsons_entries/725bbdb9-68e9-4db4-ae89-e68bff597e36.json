{
    "id": "725bbdb9-68e9-4db4-ae89-e68bff597e36",
    "created_at": "2024-12-14T02:04:50.598318Z",
    "updated_at": "2025-03-27T02:16:26.250599Z",
    "deleted_at": null,
    "sha1_hash": "af3aa2d0e436bb55fdc32603321c006096596d04",
    "title": "Let's go door with KCP",
    "authors": "",
    "file_creation_date": "2023-09-24T18:01:33Z",
    "file_modification_date": "2023-09-25T12:22:33Z",
    "file_size": 5925841,
    "plain_text": "# 2023\n### LONDON\n\n###### 4 - 6 October, 2023 / London, United Kingdom\n\n## LET’S GO DOOR WITH KCP\n\n#### Yoshihiro Ishikawa & Takuma Matsumoto\n\n##### LAC Cyber Emergency Center, Japan\n\n###### yoshihiro.ishikawa@lac.co.jp takuma.matsumoto@lac.co.jp\n\n www virusbulletin com\n\n\n-----\n\n**ABSTRACT**\n\nIn 2022 we observed the use of new APT malware by an unknown China-based APT actor across several incidents in\nJapan. The malware uses KCP protocol for backdoor communication and was coded in Golang on multiple platform\noperating systems – we named it ‘gokcpdoor’.\n\nThis backdoor has 20 commands and connects with C2 servers via KCP over UDP. KCP is a communication protocol that\nmaximizes bandwidth for reliable, low-latency communication. The protocol was designed by ‘skywind3000’, and its\nsource code is publicly available [1]. KCP is commonly implemented in proxy software, streaming services, and online\ngames. Most of the information about KCP is written in Chinese, so we think this protocol is relatively common among\nChinese speakers.\n\nRecently, it has been reported that China-based APT actors are using KCP protocol in some APT malware. However, there\nare few reports of this protocol being used in actual attack activity, and it is not in common use. Therefore, we think that\ngokcpdoor is an interesting piece of malware since it uses KCP protocol for C2 communication.\n\nIn this paper we describe the analysis results of gokcpdoor and related threats to help prevent similar attacks in the future.\n\n**A STUDY OF KCP**\n\nIn this section we introduce the KCP protocol and kcp-go library [2], used by gokcpdoor.\n\n**KCP protocol**\n\nKCP is a fast and reliable automatic repeat-request (ARQ) protocol which provides low-latency communications. This\nprotocol was devised by skywind3000 in 2011 and the code, written in C, was published on GitHub [1].\n\nKCP protocol requires a transmission mode for sending and receiving the underlying data packets. Many implementations\nmeet the requirement by utilizing UDP protocol as the transmission mode. According to KCP’s GitHub page, the\ntransmission speed of KCP over UDP is 30% to 40% faster than TCP, but wastes 10% to 20% of bandwidth. Therefore, the\nimplementation is used in software or services that require real-time performance, such as proxy software, online games,\nand streaming services.\n\n**KCP message segment**\n\nThe message segment exchanged in KCP communication consists of a 24-byte header and variable length data, as shown in\nFigure 1 and Table 1. The command in the header is an essential field to identify transmission, acknowledgement, and\nretransmission, like the TCP control flag. As shown in Table 2, there are four types of commands, and IKCP_CMD_PUSH\nand IKCP_CMD_ACK are used most frequently.\n\n_Figure 1: KCP message segment._\n\n**Field** **Size** **Description**\n\nconv 4 bytes Session number\n\ncmd 1 byte Commands\n\nfrg 1 byte Number of fragments\n\nwnd 2 bytes Window size\n\nts 4 bytes Timestamp\n\nsn 4 bytes Serial number\n\nuna 4 bytes Number of KCP message segments received\n\nlen 4 bytes Length of the data segment\n\ndata variable Data segment\n\n_Table 1: List of parameters in KCP message segment._\n\n|Field|Size|Description|\n|---|---|---|\n|conv|4 bytes|Session number|\n|cmd|1 byte|Commands|\n|frg|1 byte|Number of fragments|\n|wnd|2 bytes|Window size|\n|ts|4 bytes|Timestamp|\n|sn|4 bytes|Serial number|\n|una|4 bytes|Number of KCP message segments received|\n|len|4 bytes|Length of the data segment|\n|data|variable|Data segment|\n\n\n-----\n\n|Command|Value|Description|\n|---|---|---|\n|IKCP_CMD_PUSH|81 (0x51 ‘Q’)|Data message|\n|IKCP_CMD_ACK|82 (0x52 ‘R’)|Acknowledgement message|\n|IKCP_WASK|83 (0x53 ‘S’)|Window probe message|\n|IKCP_CMD_WINS|84 (0x54 ‘T’)|Window receive message|\n\n\n_Table 2: List of commands._\n\n**KCP communication flow**\n\nAs illustrated in Figure 2, a sender sends the data message with IKCP_CMD_PUSH and receives IKCP_CMD_ACK as an\nacknowledgement. Moreover, the sender can send KCP messages without waiting for an acknowledgement, because the\nKCP message has window size (wnd) defined. If the receiver cannot send back immediately, the sender consumes all the\nwindow and eventually stops sending. In this case, in order to prevent deadlock, the sender sends a window probe on a\nregular basis and check the receiver’s window size.\n\n_Figure 2: KCP one-way communication flow._\n\n**Kcp-go library**\n\nKcp-go is a Reliable-UDP (RUDP) library for Golang with extensions based on KCP protocol. This library supports Forward\nError Correction (FEC) with Reed-Solomon coding and packet-level encryption with AES, Blowfish, Salsa20, and so on. In\naddition, kcp-go uses CFB mode as a block cipher mode of operation; an initialization vector is hard-coded into the library.\n\nFigure 3 and Table 3 demonstrate the structure of a kcp-go message. The structure consists of a 28-byte header and variable\nlength body, and the KCP message is assigned to this body. In the header, kcp-go adds a Nonce, which is a random value,\nso that encrypting the same plaintext yields different results each time.\n\n_Figure 3: Structure of a kcp-go message._\n\n**Field** **Size** **Description**\n\nNonce 16 bytes Random value\n\nCRC32 4 bytes Checksum\n\nFEC SEQ ID 4 bytes Sequence ID for FEC\n\nFEC Type 2 bytes FEC type\n\nSize 2 bytes Length of data\n\nData 4 bytes KCP message or parity shard for FEC\n\n_Table3: List of parameters in a kcp-go message._\n\n|Field|Size|Description|\n|---|---|---|\n|Nonce|16 bytes|Random value|\n|CRC32|4 bytes|Checksum|\n|FEC SEQ ID|4 bytes|Sequence ID for FEC|\n|FEC Type|2 bytes|FEC type|\n|Size|2 bytes|Length of data|\n|Data|4 bytes|KCP message or parity shard for FEC|\n\n\n-----\n\n**APT MALWARE USING KCP PROTOCOL**\n\nIn this section we discuss some APT malware that uses KCP for C2 communication.\n\nFigure 4 shows a timeline of malware families using KCP protocol. We confirmed implementation of the KCP protocol\ncode for the first time in the Crosswalk malware in April 2020. Much of the malware implementing the KCP protocol is\nrelated to China-based threat group APT41. There are few reports of this protocol being used in actual attack activity, and it\nis not in common use. In addition, we have not yet confirmed the implementation of KCP for PseudoManuscrypt. However,\nthe newly confirmed (March 2022) gokcpdoor malware is different. This malware utilizes the kcp-go library to actually\nperform C2 communication with the KCP protocol. In the following, we will introduce the KCP implementation of each\nmalware family.\n\n_Figure 4: Timeline of malware families using KCP protocol._\n\n**Crosswalk, KeyPlug and Pangolin8RAT with KCP**\n\nWe start with a comparison of Crosswalk, KeyPlug and Pangolin8RAT, developed in C language (Figure 5). The left-hand\nside is the original KCP source code in open source and on the right is the IDA decompiled code for each piece of malware.\nYou can see that the same code is partially implemented.\n\n_Figure 5: Comparison of Crosswalk, KeyPlug and Pangolin8RAT with KCP._\n\n**FunnySwitch with KCP**\n\nNext is a comparison of FunnySwitch, developed in C# language (Figure 6). The left-hand side is the kcp-dotnet source\ncode in open source and the right side is the decompiled code of FunnySwitch. This is also the same code.\n\n\n-----\n\n_Figure 6: Comparison of FunnySwitch with KCP._\n\n**Gokcpdoor with KCP**\n\nFinally we look at gokcpdoor, which is developed in Golang (Figure 7). The left-hand side is the kcp-go source code and\non the right side is the decompiled code of gokcpdoor. The identical code implementation shows that gokcpdoor uses the\ncode from kcp.go.\n\n_Figure 7: Comparison of gokcpdoor with KCP._\n\n**DEEP DIVE INTO GOKCPDOOR**\n\nIn the core of this paper, we look at the gokcpdoor malware samples in more detail, including the differences between them\nand the implemented functions.\n\nGokcpdoor is a piece of malware with backdoor functionality, coded in Golang and cross-compiled for Linux (ELF) and\n_Windows (PE). There are minor differences, but both versions have the same functionality. Both gokcpdoor samples we_\nhave confirmed are built with go1.17.5 (Figure 8). Also, this malware uses multiple OSS libraries. For more information on\nOSS libraries, please see Appendix 1.\n\n_Figure 8: Embedded Go build version._\n\n\n-----\n\nWe also named this backdoor malware ‘gokcpdoor’ because its compile path contained the string ‘gokcpdoor’, as shown in\nFigure 9.\n\n_Figure 9: Compile path containing gokcpdoor strings._\n\n**Comparison of Linux and Windows gokcpdoor functions**\n\nFigure 10 shows specific functions implemented by gokcpdoor in Linux and Windows. Malware functionality is almost\nidentical on Linux and Windows, but the Windows version has one characteristic function named ‘main_WinExec’. The\nfunction literally executes the specified command by calling the WinExec API.\n\n_Figure 10: Gokcpdoor functions (left: Linux versions, right: Windows versions)._\n\n**Backdoor function**\n\nGokcpdoor starts opening a port with a hard-coded port number using the net_ResolveUDPAddr functions and net_\nListenUDP functions of Golang (Figure 11). Figure 12 is the result of executing the ‘ss’ command, which can display\ninformation about the socket. In this sample, we can see that 10054/udp is open. In addition, the backdoor port number\ndiffers depending on the sample.\n\n_Figure 11: Opening 10054/udp using net package functions._\n\n\n-----\n\n_Figure 12: All open UDP ports listed by the ‘ss’ command._\n\nFigure 13 shows part of a function that decodes the port number opened by gokcpdoor. The backdoor port number has been\nencoded by XOR and Base64. In this case, there is the encrypted binary data at offset ‘0x7AEFD0’ in the blue-line frame.\nDecoding with the hard-coded XOR key and Base64, you can get the port number and the string ‘nId2jUd3Ld1Fxe’. This\nis a fixed string sent when starting the backdoor C2 operation. By sending it once, multiple commands can be executed\nuntil the backdoor session expires.\n\n_Figure 13: Port number and the identifier decoding._\n\n**C2 commands**\n\nTable 4 (on the following page) shows a list of C2 commands for gokcpdoor. The malware has 20 commands, for\nexecution, uploading and downloading files, file manipulation, port forwarding, and so on. In particular, the exec, shell,\nupload and download commands play an important role in controlling the victim host.\n\n**Communication data format**\n\nGokcpdoor sends and receives data in Base64-encoded strings and a newline code format. For example, the C2 commands\nto execute the Windows calculator (calc.exe) are Base64-encoded ‘exec’ and ‘calc.exe’. Each command/result is sent\nseparately with a trailing line feed (LF) from the C2 server to gokcpdoor as UDP data after it has been encapsulated and\nencrypted by the kcp-go library, as illustrated in Figure 14.\n\n**Encryption method**\n\nFigure 15 shows the code for gokcpdoor’s encryption method. It uses PBKDF2, Key Derivation Function, with\nHMAC‑SHA-1 and AES 256 bit. We can see password, salt, iterations, and derived key length on this code.\n\nThe derived key is shown in the area highlighted in Figure 15 in grey. C2 commands and executions results are encrypted\nwith AES using this key and a hard-corded initialization vector into the kcp-go library.\n\n\n-----\n\n|Command|Description|\n|---|---|\n|exec|Execute a program|\n|shell|Start reverse shell session|\n|wget|Download a file from URL on infected host|\n|upload|Upload a file from C2 server to infected host|\n|download|Download a file from infected host to C2 server|\n|dir / ls|List the contents of the specified directory|\n|mkdir|Create a directory|\n|rm|Remove the specified directory or file|\n|cd|Change current directory|\n|pwd|Get current directory path|\n|whoami / id|Get username by executing ‘whoami’ or ‘id’ command|\n|getos|Get OS information by executing ‘wmic os get name’ or ‘uname -a’ command|\n|ps|List all running processes|\n|Ifconfig / ipconfig|List all network interfaces|\n|netstat|Get network statistics about all active connections|\n|portfoward|list: List all port forwarding settings add: Add port forwarding setting which TCP or UDP can be selected delete: Delete port forwarding setting|\n|socks5|list: List all SOCKS5 settings add: Add SOCKS5 setting delete: Delete SOCKS5 setting|\n|charset|Change character set (gokcpdoor only supports UTF-8)|\n|back|End C2 command operation|\n|exitprocess|Terminate own process|\n\n\n_Table 4: List of C2 commands._\n\n_Figure 14: Encapsulation of transmitted data._\n\n_Figure 15: Gokcpdoor encryption method._\n\n\n-----\n\n**ATTRIBUTION**\n\nIn this section we predict the attributes of the APT actors that use gokcpdoor.\n\n**Infection chain for gokcpdoor**\n\nFigure 16 shows an example of the gokcpdoor malware infection chain in 2021 to 2022. APT actors use stolen credentials\nto break into the victim’s network and install malware using lateral movement. Gokcpdoor and the ABK downloader [8]\nwere found on multiple servers and PCs. ABK has been used by Chinese APT actor Tick since 2019.\n\n_Figure 16: Example of a gokcpdoor infection flow._\n\nFigure 17 illustrates the ABK downloader infection process. ABK is embedded as an encrypted payload in the OAED loader\nmalware [9] (the payload is included after the yellow-line frame of Figure 18). The string ‘v|xI?1bW’ in the yellow-line frame\nis a marker to locate the payload. The OAED loader executes using the DLL side-loading technique and decrypts the payload\nwith XOR. Then, the loader executes ABK via process hollowing into legitimate processes such as svchost.exe.\n\n_Figure 17: ABK downloader infection process._\n\n_Figure 18: Decryption and process injection of the payload (ABK downloader)._\n\n\n-----\n\nThe ABK downloader has four main characteristics:\n\n - It detects some anti-virus products (Figure 19).\n\n - It collects MAC address, system information and anti-virus product information and sends the details to C2 servers\nusing no space User-Agent (Figure 20).\n\n - It executes only during working hours (08:00 to 18:00) using the GetLocalTime API.\n\n - It uses legitimate websites as C2 servers and downloads the next malware.\n\n_Figure 19: Detection of specific anti-virus products._\n\n_Figure 20: Specific User-Agent and C2 server._\n\n**Relationship between APT actors and malware**\n\nFigure 21 shows the relationship between various APT actors and pieces of malware. As mentioned earlier, most malware\nthat uses the KCP protocol is associated with APT41, and gokcpdoor is also suspected to be associated with this group.\nHowever, as described in the last section, we have found gokcpdoor along with malware used by the Tick actor, and for this\nreason we believe it is related to Tick. (For a summary of attribution, see Appendix 2.)\n\n\n-----\n\n_Figure 21: Overview of attribution (APT actors and malware)._\n\n**COUNTERMEASURES**\n\nIn this section we discuss measures that could be used to prevent and detect gokcpdoor and similar threats.\n\n**KCP traffic detection**\n\nKCP traffic can be difficult to identify. For this reason, it is important for network security products to check unknown\nUDP traffic. KCP traffic also has some characteristics that can be found using a Splunk query, as shown in Figure 22.\n(Please refer to Appendix 3 for Splunk Steam settings.) In addition, it is possible to analyse suspicious UDP traffic using\nKCP dissector [10], as shown in Figure 23.\n\n_Figure 22: Searching for KCP traffic on Splunk._\n\n\n-----\n\n_Figure 23: Example of using cfadmin-cn/kcp_dissector [10] for Wireshark to analyse suspicious UDP traffic._\n\n**Detection of gokcpdoor**\n\nGokcpdoor can be detected and prevented using the following methods:\n\n - Using a YARA rule (see Figure 24)\n\n - Using Autoruns to check suspicious AutoStart Extensibility Points (ASEPs)[1]\n\n - Using Sysmon to check the recording of Create Process and Network Connect events (Figure 25)\n\n - Using EDR products to check execution of shell commands can be traced by process tree (Figure 26)\n\n_Figure 24: Example YARA rule of gokcpdoor malware._\n\n1 In the case we analysed the APT actor had registered gokcpdoor as a service to implement persistence mechanisms.\n\n\n-----\n\n_Figure 25: Example logs (Network Connect) of Sysmon Linux after gokcpdoor has been executed._\n\n_Figure 26: Example of CrowdStrike Falcon graphs process tree._\n\n**CONCLUSION**\n\nGokcpdoor is a backdoor malware coded in Golang using KCP protocol for C2 communication. Attack vectors using the\nKCP protocol are on the rise and may be used more and more in the future.\n\nWe have shared some detection and prevention methods to protect against this and similar threats.\n\nWe have also suggested a possible relationship with the China-based APT actors Tick or APT41, but attribution is difficult.\n\nWe plan to continue to investigate APT actors using gokcpdoor and provide updated information that will help security\nresearchers and defenders.\n\n**REFERENCES**\n\n[1] [KCP. https://github.com/skywind3000/kcp.](https://github.com/skywind3000/kcp)\n\n[2] [Kcp go. https://pkg.go.dev/github.com/xtaci/kcp-go.](https://pkg.go.dev/github.com/xtaci/kcp-go)\n\n[3] Positive Technologies. Higaisa or Winnti? APT41 backdoors, old and new. 14 January 2021.\n[https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/)\n[and-new/.](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/)\n\n[4] Yeh, S.; Chang, L. The next-gen PlugX/ShadowPad? A dive into the emerging China-nexus modular trojan,\n[Pangolin8RAT. Black Hat Asia 2022. https://i.blackhat.com/Asia-22/Thursday-Materials/AS-22-LeonSilvia-](https://i.blackhat.com/Asia-22/Thursday-Materials/AS-22-LeonSilvia-NextGenPlugXShadowPad.pdf)\n[NextGenPlugXShadowPad.pdf.](https://i.blackhat.com/Asia-22/Thursday-Materials/AS-22-LeonSilvia-NextGenPlugXShadowPad.pdf)\n\n[5] Kaspersky. PseudoManuscrypt: a mass-scale spyware attack campaign. 16 December 2021.\n[https://ics-cert.kaspersky.com/publications/reports/2021/12/16/pseudomanuscrypt-a-mass-scale-spyware-attack-](https://ics-cert.kaspersky.com/publications/reports/2021/12/16/pseudomanuscrypt-a-mass-scale-spyware)\n[campaign/.](https://ics-cert.kaspersky.com/publications/reports/2021/12/16/pseudomanuscrypt-a-mass-scale-spyware)\n\n[6] Brown, R.; Ta, V.; Bienstock, D.; Ackerman, G.; Wolfram, J. Does This Look Infected? A Summary of APT41\n[Targeting U.S. State Governments. Mandiant. 8 March 2022. https://www.mandiant.com/resources/blog/apt41-us-](https://www.mandiant.com/resources/blog/apt41-us-state-governments)\n[state-governments.](https://www.mandiant.com/resources/blog/apt41-us-state-governments)\n\n\n-----\n\n[7] [KCP.cs. https://github.com/qchencc/kcp-dotnet/blob/master/Source/Network/KCP.cs.](https://github.com/qchencc/kcp-dotnet/blob/master/Source/Network/KCP.cs)\n\n[8] [nao_sec. An Overhead View of the Royal Road. 29 January 2020. https://nao-sec.org/2020/01/an-overhead-view-](https://nao-sec.org/2020/01/an-overhead-view-of-the-royal-road.html)\n[of-the-royal-road.html.](https://nao-sec.org/2020/01/an-overhead-view-of-the-royal-road.html)\n\n[9] [Macnica Networks and TeamT5. APT Threat Landscape in Japan 2020. 21 May 2021. https://www.macnica.co.jp/](https://www.macnica.co.jp/business/security/manufacturers/files/mpressioncss_ta_report_2020_5_en.pdf)\n[business/security/manufacturers/files/mpressioncss_ta_report_2020_5_en.pdf.](https://www.macnica.co.jp/business/security/manufacturers/files/mpressioncss_ta_report_2020_5_en.pdf)\n\n[10] [KCP dissector. https://github.com/cfadmin-cn/kcp_dissector.](https://github.com/cfadmin-cn/kcp_dissector)\n\n**APPENDIX 1: OSS LIBRARY LISTS**\n\nTable 5 lists the Golang OSS libraries used by gokcpdoor.\n\n**OSS Libraries (GitHub)** **Description**\n\nklauspost/Reedsolomon Provides Reed-Solomon Erasure Coding\n\nklauspost/cpuid Gets information about related CPU\n\ntemplexxx/cpu Gets information about related CPU\n\ntemplexxx/xorsimd Provides XOR code engine\n\npkg/errors Provides simple error handling primitives\n\ntjfoc/gmsm Provides Chinese cryptographic algorithm\n\ntxthinking/x Provides some network utilities function\n\ntxthinking/runnergroup Ends concurrency reliably\n\npatrickmn/go-cache Provides in-memory cache function\n\nxtaci/kcp-go Provides KCP connection\n\nProvides KCP session implemented by UDP\n\ntxthinking/socks5 Provides SOCKS5 implemented for client\n\nProvides UDP support for SOCKS5\n\nBishopFox/Sliver Provides API for finding and listing processes\n\nProvides ‘netstat’ command function\n\ndigibib/tcpforward Provides forward TCP traffic\n\n1lann/udp-forward Provides forward UDP traffic\n\n_Table 5: List of OSS libraries._\n\n**APPENDIX 2: DIAMOND MODEL**\n\nFigure 27 shows the Diamond Model for the gokcpdoor campaign.\n\n_Figure 27: Diamond Model of this campaign._\n\n|OSS Libraries (GitHub)|Description|\n|---|---|\n|klauspost/Reedsolomon|Provides Reed-Solomon Erasure Coding|\n|klauspost/cpuid|Gets information about related CPU|\n|templexxx/cpu|Gets information about related CPU|\n|templexxx/xorsimd|Provides XOR code engine|\n|pkg/errors|Provides simple error handling primitives|\n|tjfoc/gmsm|Provides Chinese cryptographic algorithm|\n|txthinking/x|Provides some network utilities function|\n|txthinking/runnergroup|Ends concurrency reliably|\n|patrickmn/go-cache|Provides in-memory cache function|\n|xtaci/kcp-go|Provides KCP connection|\n||Provides KCP session implemented by UDP|\n|txthinking/socks5|Provides SOCKS5 implemented for client|\n||Provides UDP support for SOCKS5|\n|BishopFox/Sliver|Provides API for finding and listing processes|\n||Provides ‘netstat’ command function|\n|digibib/tcpforward|Provides forward TCP traffic|\n|1lann/udp-forward|Provides forward UDP traffic|\n\n\n-----\n\n**APPENDIX 3: SPLUNK STREAM SETTINGS**\n\nTo search KCP traffic within Splunk, you need to enable UDP traffic capture and content recording in the Splunk Stream\napp, as shown in Figure 26. We recommend estimating the amount of logs before setting these up in production.\n\n_Figure 26: Splunk Stream settings._\n\n**APPENDIX 4: INDICATORS OF COMPROMISE (IOCs)**\n\nThe following files were analysed for this paper.\n\n**Indicator** **Type** **Context**\n\n86f02e9f344a8e8009e59ecae934a780 MD5 ABK Downloader\n\nd85c9b3d49b1af482c384a4253c16e28ae65a0f5 SHA1\n\n61eb25a6e6457087232de7ce7cd7b6cd9926e10674487c9e55b9a3fa54748b4c SHA256\n\nMozilla/4.0(compatible;MSIE8.0;WindowsNT6.0;Trident/4.0) User-Agent\n\na6f4a5ec66b7c5f275e793be02885543 MD5 gokcpdoor for Linux\n\nbdb3db1013b16cb64b3f8156eae621054fa334bf SHA1\n\n2dd8ab1493a97e0a4416e077d6ce1c35c7b2d8749592b319a7e2a8f4cd1cc008 SHA256\n\n_Table 6: Samples related to this campaign._\n\n|Indicator|Type|Context|\n|---|---|---|\n|86f02e9f344a8e8009e59ecae934a780|MD5|ABK Downloader|\n|d85c9b3d49b1af482c384a4253c16e28ae65a0f5|SHA1||\n|61eb25a6e6457087232de7ce7cd7b6cd9926e10674487c9e55b9a3fa54748b4c|SHA256||\n|Mozilla/4.0(compatible;MSIE8.0;WindowsNT6.0;Trident/4.0)|User-Agent||\n|a6f4a5ec66b7c5f275e793be02885543|MD5|gokcpdoor for Linux|\n|bdb3db1013b16cb64b3f8156eae621054fa334bf|SHA1||\n|2dd8ab1493a97e0a4416e077d6ce1c35c7b2d8749592b319a7e2a8f4cd1cc008|SHA256||\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.virusbulletin.com/uploads/pdf/conference/vb2023/papers/Lets-go-door-with-KCP.pdf"
    ],
    "report_names": [
        "Lets-go-door-with-KCP.pdf"
    ],
    "threat_actors": [
        {
            "id": "873919c0-bc6a-4c19-b18d-c107e4aa3d20",
            "created_at": "2023-01-06T13:46:39.138138Z",
            "updated_at": "2025-03-27T02:00:03.005534Z",
            "deleted_at": null,
            "main_name": "Higaisa",
            "aliases": [],
            "source_name": "MISPGALAXY:Higaisa",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "30c9c492-afc6-4aa1-8fe6-cecffed946e0",
            "created_at": "2022-10-25T15:50:23.400822Z",
            "updated_at": "2025-03-27T02:00:55.461334Z",
            "deleted_at": null,
            "main_name": "Higaisa",
            "aliases": [
                "Higaisa"
            ],
            "source_name": "MITRE:Higaisa",
            "tools": [
                "PlugX",
                "certutil",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1734141890,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1695578493,
    "ts_modification_date": 1695644553,
    "files": {
        "pdf": "https://archive.orkl.eu/af3aa2d0e436bb55fdc32603321c006096596d04.pdf",
        "text": "https://archive.orkl.eu/af3aa2d0e436bb55fdc32603321c006096596d04.txt",
        "img": "https://archive.orkl.eu/af3aa2d0e436bb55fdc32603321c006096596d04.jpg"
    }
}