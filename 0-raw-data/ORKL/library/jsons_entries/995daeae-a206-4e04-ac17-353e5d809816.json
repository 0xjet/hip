{
    "id": "995daeae-a206-4e04-ac17-353e5d809816",
    "created_at": "2023-01-12T15:03:36.242684Z",
    "updated_at": "2025-03-27T02:17:01.078167Z",
    "deleted_at": null,
    "sha1_hash": "00e4140ee83e4a98fd9cf2f4df2a4ee1082fadb7",
    "title": "2022-12-12 - Linux Cryptocurrency Mining Attacks Enhanced via CHAOS RAT",
    "authors": "",
    "file_creation_date": "2022-12-29T00:29:01Z",
    "file_modification_date": "2022-12-29T00:29:01Z",
    "file_size": 1042818,
    "plain_text": "# Linux Cryptocurrency Mining Attacks Enhanced via CHAOS RAT\n\n**[trendmicro.com/en_us/research/22/l/linux-cryptomining-enhanced-via-chaos-rat-.html](https://www.trendmicro.com/en_us/research/22/l/linux-cryptomining-enhanced-via-chaos-rat-.html)**\n\nDecember 12, 2022\n\nContent added to Folio\n\nCloud\n\nWe intercepted a cryptocurrency mining attack that incorporated an advanced remote access trojan (RAT)\nnamed the CHAOS Remote Administrative Tool.\n\nBy: David Fiser, Alfredo Oliveira\nDecember 12, 2022\nRead time: ( words)\n\n[We’ve previously written about](https://www.trendmicro.com/en_us/research/20/i/war-of-linux-cryptocurrency-miners-a-battle-for-resources.html) [cryptojacking scenarios involving Linux machines and specific cloud](https://www.trendmicro.com/vinfo/dk/security/news/cybercrime-and-digital-threats/cryptocurrency-mining-malware-targets-linux-systems-uses-rootkit-for-stealth)\n[computing instances being targeted by threat actors active in this space such as](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/teamtnt-activities-probed) [TeamTNT. We found that](https://www.trendmicro.com/en_us/research/22/j/teamtnt-returns-or-does-it.html)\nthe routines and chain of events were fairly similar even if it involved different threat actors: the initial phase\nsaw attackers trying to kill off competing malware, security products, and other cloud middleware. This was\nfollowed by routines for persistence and payload execution, which in most cases is a Monero (XMR)\ncryptocurrency miner. For more sophisticated threats, we also observed capabilities that allowed it to spread\nto more devices.\n\nIn November 2022, we intercepted a threat that had a slightly different routine and incorporated an\nadvanced remote access trojan (RAT) named the [CHAOS Remote Administrative Tool](https://github.com/tiagorlampert/CHAOS)\n(Trojan.Linux.CHAOSRAT), which is based on an open source project.\n\n[Note that the original flow involving the termination of competing malware such as Kinsing and the killing of](https://www.trendmicro.com/en_ph/research/20/k/analysis-of-kinsing-malwares-use-of-rootkit.html)\nresources that influence cryptocurrency mining performance remained unchanged.\n\n\n-----\n\nFigure 1. The original\n\ncryptojacking workflow\nThe malware achieves its persistence by altering /etc/crontab file, a UNIX task scheduler that, in this case,\ndownloads itself every 10 minutes from Pastebin.\n\nFigure 2. Achieving\n\npersistence using cron and downloaded shell scripts from Pastebin\nThis is followed by downloading additional payloads: an XMRig miner, its configuration file, a shell script\nlooping “competition killer,” and most importantly, the RAT itself.\n\nFigure 3. Additional\n\npayload download\n\nFigure 4. Infinite loop\n\nof competing process kill\nThe main downloader script and further payloads are hosted in different locations to ensure that the\ncampaign remains active and constantly spreading. The scripts show that the main server, which is also\nused for downloading payloads, appears to be located in Russia, with historical whois data showing that it\n\n\n-----\n\n[also used for cloud bulletproof hosting (a modus operandi that was previously employed by hacking teams](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/inside-the-bulletproof-hosting-business-cybercrime-methods-opsec)\n— using open source tools — that focused their attacks on cloud infrastructure, containers, and Linux\nenvironments).\n\nThis command-and-control (C&C) server is used only for providing payloads — Chaos RAT connects to\nanother C&C server, likely located in Hong Kong (which we determined through IP geolocation). When\nrunning, the RAT client connects to the C&C server via its address, and default port, using a JSON Web\nToken (JTW) for authorization.\n\nUpon connection and successful authorization, the client sends detailed information on the infected machine\nto the C&C server using the command /device.\n\nThe RAT is a Go-compiled binary with the following functions:\n\nPerform reverse shell\nDownload files\nUpload files\nDelete files\nTake screenshots\nAccess file explorer\nGather operating system information\nRestart the PC\nShutdown the PC\nOpen a URL\n\nFigure 5. Some implemented functions that\n\ncan be sent to communicated machine via the C&C server\n\n\n-----\n\nFigure 6. Strings linking the binary to CHAOS RAT\n\nFigure 7. GitHub page for CHAOS RAT showing some of its\n\nfunctions\nAn interesting trait of the malware family we intercepted is that the address and access token are passed as\ncompilation flags and hardcoded inside the RAT client, replacing any data inside variables from the main\ncode.\n\n\n-----\n\nFigure 8. The address and access token being passed\n\nas compilation flags and hardcoded inside the RAT client\n\n## Conclusion\n\nOn the surface, the incorporation of a RAT into the infection routine of a cryptocurrency mining malware\nmight seem relatively minor. However, given the tool’s array of functions and the fact that this evolution\nshows that cloud-based threat actors are still evolving their campaigns, it is important that both\norganizations and individuals stay extra vigilant when it comes to security. In our research on cloud-based\ncryptocurrency mining groups, we provided several concrete measures and best practices that enterprises\ncan implement to help strengthen their defensive posture.\n\nOrganizations can also consider powerful cloud security technologies such as Trend Micro Cloud One™ –\nWorkload Security, which helps defend systems against vulnerability exploits, malware, and unauthorized\nchange. Using techniques such as machine learning (ML) and virtual patching, it can automatically secure\nnew and existing workloads both against known and unknown threats.\n\n## Indicators of Compromise\n\n[The indicators of compromise for this entry can be found here.](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/22/l/linux-cryptocurrency-mining-attacks-enhanced-via-chaos-rat-/iocs-linux-cryptocurrency-mining-attacks-enhanced-via-chaos-rat.txt)\n\n## MITRE ATT&CK\n\n\nInitial\nAccess\n\nExternal\n[Remote](https://attack.mitre.org/techniques/T1133)\nServices\n\n\n[Discovery](https://attack.mitre.org/tactics/TA0007/) [Execution](https://attack.mitre.org/tactics/TA0002) [Persistence](https://attack.mitre.org/tactics/TA0003) [Collection](https://attack.mitre.org/tactics/TA0009) Command\nand\nControl\n\n\nNetwork\n[Service](https://attack.mitre.org/techniques/T1046/)\nScanning\n\n\n[Exfiltration](https://attack.mitre.org/tactics/TA0010) [Impact](https://attack.mitre.org/tactics/TA0040)\n\n\nCommand\nand\nScripting\nInterpreter\n\n\nScheduled\nTask/Job\n\n\nScreen\nCapture\n\n\nRemote\n[Access](https://attack.mitre.org/techniques/T1219)\nSoftware\n\n\nExfiltration\n[Over C2](https://attack.mitre.org/techniques/T1041)\nChannel\n\n\nResource\nHijacking\n\n\n-----\n\nExploit\nPublicFacing\nApplication\n\n\nAccount\nDiscovery\n\n\nCommonly\nUsed Port\n\nStandard\nApplication\nLayer\nProtocol\n\n\nSystem\nShutdown/Reboot\n\nEndpoint Denial\nof Service\n\nData\nManipulation\n\n\nsXpIBdPeKzI9PC2p0SWMpUSM2NSxWzPyXTMLlbXmYa0R20xk\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-12-12 - Linux Cryptocurrency Mining Attacks Enhanced via CHAOS RAT.pdf"
    ],
    "report_names": [
        "2022-12-12 - Linux Cryptocurrency Mining Attacks Enhanced via CHAOS RAT.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a6c351ea-01f1-4c9b-af75-cfbb3b269ed3",
            "created_at": "2023-01-06T13:46:39.390649Z",
            "updated_at": "2025-03-27T02:00:03.072899Z",
            "deleted_at": null,
            "main_name": "Kinsing",
            "aliases": [
                "Money Libra"
            ],
            "source_name": "MISPGALAXY:Kinsing",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535816,
    "ts_updated_at": 1743041821,
    "ts_creation_date": 1672273741,
    "ts_modification_date": 1672273741,
    "files": {
        "pdf": "https://archive.orkl.eu/00e4140ee83e4a98fd9cf2f4df2a4ee1082fadb7.pdf",
        "text": "https://archive.orkl.eu/00e4140ee83e4a98fd9cf2f4df2a4ee1082fadb7.txt",
        "img": "https://archive.orkl.eu/00e4140ee83e4a98fd9cf2f4df2a4ee1082fadb7.jpg"
    }
}