{
    "id": "e0136f99-a8c7-475c-b742-4021a8037aaf",
    "created_at": "2022-10-25T16:48:16.877987Z",
    "updated_at": "2025-03-27T02:13:58.877587Z",
    "deleted_at": null,
    "sha1_hash": "61251cc065cb364dbba4585d1d97b0d81062cfc1",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-05-07T14:45:04Z",
    "file_modification_date": "2020-05-07T14:45:04Z",
    "file_size": 1987374,
    "plain_text": "# 標的型攻撃の新たな⼿⼝判明。診断ツール「PoshC2」を悪 ⽤する攻撃の流れを解説\n\n**lac.co.jp/lacwatch/people/20200424_002177.html**\n\nサイバー救急センターの⽯川です。\n2019年2⽉にLAC WATCHで、ペネトレーションテストツール「PoshC2」を悪⽤した標的型攻撃\nの⼿⼝を紹介しました。\n\n[LAC WATCH：オープンソースのツール「PoshC2」を悪⽤した新たな標的型攻撃を確認](https://www.lac.co.jp/lacwatch/people/20190213_001770.html)\n\n2020年に⼊ってからも、私の所属する脅威分析チームでは同種の攻撃を引き続き観測しており、\n今まで確認できなかった詳細な攻撃の流れが⾒えてきました。攻撃者グループが⽤いる攻撃の⼿\n⼝やC2インフラに変化が現れていることも確認しています。\n\n今回は、新たに⾒えてきた詳細な攻撃の⼿⼝と、背後に潜む攻撃者グループについて紹介しま\nす。\n\n## PoshC2を悪⽤した標的型攻撃の詳細な⼿⼝\n\n図1は、PoshC2を悪⽤する攻撃の流れを示したもので、⼤きく3つの⼿⼝に分類されます。この\n[うち、攻撃⼿⼝2については前述の2019年2⽉に公開したLAC WATCH記事で取り上げているた](https://www.lac.co.jp/lacwatch/people/20190213_001770.html)\nめ、ここでは攻撃⼿⼝1と攻撃⼿⼝3の詳細と、攻撃の中で使われたC2インフラの変化について\n説明します。\n\n\n-----\n\n図1 PoshC2を悪⽤する3つの攻撃⼿⼝の概要\n\n### 攻撃⼿⼝1（CVE-2019-9489およびDLLハイジャックの悪⽤）\n\nこれは、ウイルスバスターCorp.の脆弱性（CVE-2019-9489）およびDLLハイジャック（DLL\nSearch Order Hijacking）を悪⽤した攻撃⼿⼝です。2019年のLAC WATCH記事では、DLLハイジ\nャックの悪⽤からPoshC2スクリプトの実⾏までを解説しましたが、今回は、被害者PCへの不正\nなDLLファイルの配信⼿法とDLLハイジャックの悪⽤についてです。攻撃の多くは、今年1⽉に開\n催されたJapan Security Analyst Conference 2020でのJPCERTコーディネーションセンターの発\n表でも紹介された※1、CVE-2019-9489の脆弱性の悪⽤から始まります。図2は、CVE-2019-9489\nおよびDLLハイジャックを悪⽤した⼿⼝の概要です。\n\n※1 Japan Security Analyst Conference 2020 (オープニングトーク) 2019年のインシデントを振り\n返る\n\n\n-----\n\n図2 CVE-2019-9489およびDLLハイジャックを悪⽤した⼿⼝の概要\n\n攻撃の流れは次の通りです。\n\n1. 攻撃者は、スピアフィッシングメールや脆弱性の悪⽤等によって侵害したPCを踏み台とし\n\nて、CVE-2019-9489の脆弱性を悪⽤し、ウイルスバスターCorp.サーバの特定のディレク\nトリに管理者権限を持つ認証トークンファイルを作成\n2. 攻撃者は、このトークンを利⽤してウイルスバスターCorp.サーバの管理画⾯の認証を回避\n\nし、管理者権限でアクセス。その後、パターンファイルの配信元を、攻撃者が管理する偽\nのアップデートサーバへ設定変更\n3. 偽のアップデートサーバから、不正な「dbghelp.dll」ファイルを含む偽のパターンファイ\n\nルが被害者PCに配信される。この際、ウイルスバスターCorp.クラインアントがパターン\nファイルの内容を適切に検証しない※2ため、DLLファイルが被害者PCの特定のディレクト\nリに展開される\n4. ウイルスバスターCorp.クラインアントのプログラムが実⾏される際に、\n\n\n「%SystemRoot%¥System32」にある正規の「dbghelp.dll※3」ではなく、同じディレクト\nリに展開された不正な「dbghelp.dll」を意図せず読み込んでしまい、DLLファイルに含ま\nれたいくつかの攻撃コード※4がBATファイルを通じて実⾏される\n\n攻撃の中で特徴ある項⽬についてピックアップしてみていきます。\n\n\n-----\n\n※2 この問題については、ウイルスバスターCorp. XG SP1の場合、CVE-2019-9489の脆弱性を解\n消するパッチ（Critical Patch 5338）の1つ前にリリースされたCritical Patch 5294で解消されて\nいることを確認しています。\n\n※3 Microsoftのデバックエンジンを提供するDLLファイルの1つです。\n\n※4 PoshC2スクリプト、リモートデスクトップのネットワークレベル認証（NLA）の無効化、ロ\nグイン画⾯の拡⼤鏡（magify.exe）を「cmd.exe」に置き換えたバックドアの作成や管理者権限\nを有するユーザを作成するコマンドなどの攻撃コード。\n\n#### CVE-2019-9489の脆弱性\n\nCVE-2019-9489はディレクトリトラバーサルが可能な脆弱性です。ウイルスバスターCorp.クラ\nイアントから隔離ファイルを受信するプログラム「cgiRecvFile.exe」が、特定の関数において⼊\n⼒されたファイルパスを適切にチェックしないことに起因しています。攻撃者はこの脆弱性を悪\n⽤することによって、ウイルスバスターCorp.サーバまたはウイルスバスタービジネスセキュリ\nティサーバで任意のファイルを作成・変更することができます。\n\n図3は、この脆弱性が修正されたウイルスバスタービジネスセキュリティ 9.5 Critical Patch（ビ\nルド1487）のReadme※5の内容の⼀部抜粋です。⾚枠で示すように、「cgiRecvFile.exe」で脆弱\n性が修正されていることが確認できます。その他のウイルスバスターCorp.の修正プログラムに\nついては、トレンドマイクロ社のサポート情報※6をご参照ください。\n\n\n図3 ウイルスバスタービジネスセキュリティ 9.5 Critical Patch（ビルド1487）⼀部抜粋\n\n※5\nhttp://files.trendmicro.com/jp/ucmodule/vbbiz/95/patch/cp1487/readme_biz95_win_CriticalPatch_\nB1487.txt\n\n※6 サポート情報 : トレンドマイクロ 【注意喚起】弊社製品の脆弱性(CVE-2019-9489)を悪⽤し\nた攻撃を複数確認したことによる最新修正プログラム適⽤のお願い\n\n#### 拡⼤鏡を悪⽤したバックドアと、リモートデスクトップのネットワークレベ ル認証の無効化\n\n\n-----\n\n「dbghelp.dll」に含まれるBATファイルには、図4のようなレジストリを変更するコマンドが含ま\nれています。これらのコマンドは、拡⼤鏡（magnify.exe）を悪⽤した「cmd.exe」によるバック\nドアを設定するものと、リモートデスクトップのネットワークレベル認証（NLA）を無効化する\nものです。また、図5は、ログイン画⾯から拡⼤鏡を悪⽤したバックドアを実⾏したものです。\n⾚枠で示すようにSYSTEM権限で「cmd.exe」が起動していることが確認できます。\n\n図4 拡⼤鏡を変更するコマンド（上）／リモートデスクトップのネットワークレベル認証の無効化するコマン\n\nド（下）\n\n図5 ログイン画⾯から拡⼤鏡の実⾏\n\n#### DLLハイジャック\n\nDLLハイジャックは、DLLファイルを読み込む際の検索パスの処理に起因して、同⼀ディレクト\nリに存在する特定のDLLファイルを読み込んでしまう問題です。攻撃の流れで説明したように、\n攻撃者は、ウイルスバスターCorp.サーバのアップデート配信機能を悪⽤し、被害者PCのウイル\n\n\n-----\n\nスバスターCorp.クライアントの特定のディレクトリに攻撃コードを含む「dbghelp.dll」を展開\nさせます。ウイルスバスターCorp.クライアントのプログラムが動作した際に、\n「%SystemRoot%¥System32」にある正規の「dbghelp.dll」ではなく、特定のディレクトリに展\n開された不正なDLLファイルが読み込まれて攻撃コードが実⾏されます。表1は、このアップデ\nート配信機能を悪⽤した攻撃で悪⽤可能なウイルスバスターCorp.クライアントのプログラムの\n⼀例で、いずれもPC起動時に⾃動実⾏されます\n\n表1 DLLハイジャック可能なプログラム\n\n\n##### プログラ ム名\n\n PccNT‐ Mon.exe\n\n NTRt‐ Scan.exe\n\n TmLis‐ ten.exe\n\n\n##### 確認バージ ョン※7 説明\n\n 13.0.0.1361 ウイルスバスターCorp.クライアントモニターのプロセ ス\n\n 13.0.0.1361 リアルタイムスキャンのプロセス\n\n 13.0.0.1361 ウイルスバスターCorp.クライアントがウイルスバスタ ーCorp.サーバと通信するためのプロセス\n\n\n※7 ウイルスバスターCorp. XG SP1の場合、Critical Patch 5294以降のパッチを適⽤したバージョ\nンを利⽤することで、この攻撃による影響を緩和することが可能です。\n\n図6は、「PccNTMon.exe」によって読み込まれたファイルをProcess Monitorで確認したもので\nす。「dbghelp.dll」がシステムディレクトリ（%SystemRoot%¥system32）ではなく、トレンド\nマイクロ社製品のディレクトリ（C:¥Program Files¥Trend Micro¥OfficeScan Client）から読み込\nまれてしまっていることが確認できます。\n\n図6 「PccNTMon.exe」による読み込まれたファイル抜粋（Process Monitor）\n\n図7は、「PccNTMon.exe」によって読み込まれたDLLファイルをProcess Explorerで確認したも\nのです。こちらでも、「dbghelp.dll」が「C:¥Program Files¥Trend Micro¥OfficeScan Client」か\nら読み込まれていることが確認できます。また、⾚枠で示すように、「dbghelp.dll」に含まれた\n「firefox.exe」（PowerShell）がPoshC2スクリプトを実⾏していることも確認できます。\n\n\n-----\n\n図7 「PccNTMon.exe」による読み込まれたDLLファイル抜粋（Process Explore）\n\n#### カスタムPoshC2\n\n攻撃者は、公開されているPoshC2の「Core Dropper」のコード※8にセキュリティ制限を回避す\nるコードをいくつか加え、攻撃に利⽤しています。ここでは、加えられた3つのコードについて\n紹介します。\n\n[※8 Core Dropper -- PoshC2 Framework documentation](https://poshc2.readthedocs.io/en/stable/execution/core.html)\n\n\n1つ⽬は、Antimalware Scan Interface（AMSI）※9を回避するコードです（図8）。これは実⾏す\nる環境がWindows 10の場合に動作します。AMSIは、Windows 10から標準で搭載されているマ\nルウェア対策⽤のインターフェースで、悪意のあるスクリプトを検出する仕組みを提供します。\nしかし、Windows 10 バージョン1903では、Windows Defenderによってブロックされているこ\nとが確認できます（図9）。\n\n[※9 Antimalware Scan Interface (AMSI) - Win32 apps | Microsoft Docs](https://docs.microsoft.com/en-us/windows/win32/amsi/antimalware-scan-interface-portal)\n\n図8 AMSIを回避するコード\n\n\n-----\n\n図9 Windows DefenderによるAMSI回避コードを実⾏時のブロック状況（Windows 10 バージョン1903）\n\n2つ⽬は、PowerShellスクリプトブロックのログ記録を無効にするコードです（図10）。こちら\nも実⾏する環境がWindows 10の場合に動作します。Windows 10などPowerShell v5.0がインスト\nールされた環境では、実⾏されたPowerShellスクリプトがデフォルトでイベントログに記録され\nますが、攻撃者はこの制限を回避し、攻撃の痕跡を記録させない⼿⼝を⽤いています。\n\n図10 PowerShellスクリプトブロックのログ記録を無効にするコード\n\n最後の3つ⽬のコードは、PoshC2の実⾏時間を指定するコード（図11）で、OSのバージョンに\n関わらず実⾏されます。実⾏時間はスクリプトによっても異なりますが、平均的な勤め⼈の勤務\n時間を⽬安とした8:00から21:00ごろまで動くように設定されています。\n\n図11 実⾏時間を制限するコード\n\n### 攻撃⼿⼝3（MSBuildの悪⽤）\n\n\n-----\n\nこれはMicrosoft Build Engine（MSBuild）※10を悪⽤した攻撃⼿⼝です。.NET Frameworkライン\nタイムに標準で含まれるMSBuildは、Visual Studioや.NET Frameworkのビルドエンジンであり、\n独⾃のXMLフォーマットファイル（プロジェクトファイル）を利⽤して.NETアプリケーション\nを作成できます。PoshC2は、EXE、DLL、BAT、JSなど様々なフォーマット※11でペイロードを\n作成でき、そのうちの1つにこのMSBuildで利⽤可能なXMLファイルがあります。\n\n[※10 MSBuild - Visual Studio | Microsoft Docs](https://docs.microsoft.com/ja-jp/visualstudio/msbuild/msbuild?view%253Dvs-2019=&view=vs-2019)\n\n[※11 PoshC2/resources/payload-templates at master · nettitude/PoshC2 · GitHub](https://github.com/nettitude/PoshC2/tree/master/resources/payload-templates)\n\n図12は、PoshC2によって作成されたXMLファイルの⼀部コードです。⾚枠で囲んだ部分が攻撃\nコードであり、sc32が32bit環境⽤で、sc64が64bit環境⽤です。この攻撃コードには、シェルコ\nード、PoshC2スクリプトを含むDLLファイル（PowershellDLL.dll）と.NETアプリケーション\n（Microsoft.dll）の3つが含まれています。図13は、攻撃コードをBase64デコードしたものであ\nり、先頭から0x364バイトまでがシェルコード（⻘枠）に該当し、その後に「MZ」ヘッダが消さ\nれたDLLファイルが含まれていることが確認できます。\n\n図12 PoshC2で作成した攻撃コードを含むMSBuild⽤のプロジェクトファイル（⼀部抜粋）\n\n\n-----\n\n図13 Base64デコード後の32ビット⽤の攻撃コード（⼀部抜粋）\n\n「MZ」ヘッダが消されたDLLファイルには、Base64とgzipでエンコードおよび圧縮された\nPoshC2スクリプトが含まれています（図14）。このPoshC2スクリプトは、攻撃コードの3つ⽬\nに含まれる.NETアプリケーションによってメモリ上で実⾏され、「MSBuild.exe」プロセスにイ\nンジェクションして動作します。.NETアプリケーションは「PowerShellRunner」※12をカスタマ\nイズしたものであり、PowerShellの機能を提供する「System.Management.Automation.dll」を利\n⽤することで、「powershell.exe」を呼び出さず、PowerShellスクリプトを実⾏します（図\n15）。\n\n※12 UnmanagedPowerShell/PowerShellRunner at master ·\nleechristensen/UnmanagedPowerShell · GitHub\n\n図14 DLLファイルに含まれたBase64でエンコードされたPoshC2コード（⼀部抜粋）\n\n\n-----\n\n図15 PowerShellRunnerのPowerShellスクリプト実⾏コード（⼀部抜粋）\n\n### C2インフラを定期的に変更\n\n攻撃者は、2019年前半までは、GCP（Google Cloud Platform）やMicrosoft Azureといったクラ\nウドサービスを主要なC2サーバとして悪⽤していました。2019年後半からは、⾹港でVPSサー\nビスを提供するShenzhen Katherine Heng Technology Information（AS135357）やCloudie\nLimited（AS55933）が悪⽤されています。攻撃者は、C2インフラを再利⽤せず、定期的に変更\nして攻撃活動を⾏なっています。\n\n## 背後に潜む攻撃者グループ\n\n私たちはPoshC2を悪⽤した⼀連の攻撃について調べる中で、⽇本や台湾を主な標的とする攻撃\n者グループTaidoor※13やBlackTechが、この⼀連の攻撃に関与している可能性があることを示す痕\n跡を確認しています。\n\n※13 攻撃キャンペーン名として使われている場合もあります。\n\n#### Taidoor\n\n\nトレンドマイクロ社のブログ※14、NTT Security社のレポート※15やTaidoorが利⽤するマルウェア\n（SERKDES）の解析レポート※16で報告されている攻撃の⼿⼝と以下の点が類似します。\n\n2018年〜2019年における⽇本への標的型攻撃での「PoshC2」の悪⽤\nRemote Access Auto Connection Manager（RasAuto）サービスを悪⽤した⾃動起動設定\n（図16）\nオンラインストレージサービスである「Dropbox」の利⽤\n\n※14\nこの⼤型連休前後に法⼈で注意すべき標的型攻撃の特徴を解説 | トレンドマイクロ セキュリティ\nブログ\n標的型攻撃キャンペーン「Taidoor」の活動が⽇本で活発化 | トレンドマイクロ セキュリティブ\nログ\n\n[※15 taidoorを⽤いた標的型攻撃解析レポート_v1](https://www.nttsecurity.com/docs/librariesprovider3/resources/taidoor%E3%82%92%E7%94%A8%E3%81%84%E3%81%9F%E6%A8%99%E7%9A%84%E5%9E%8B%E6%94%BB%E6%92%83%E8%A7%A3%E6%9E%90%E3%83%AC%E3%83%9D%E3%83%BC%E3%83%88_v1)\n\n[※16 BKDR_SERKDES.A - 脅威データベース](https://www.trendmicro.com/vinfo/jp/threat-encyclopedia/malware/BKDR_SERKDES.A)\n\n\n-----\n\n図16 RasAutoサービスを悪⽤したPoweShellの⾃動実⾏登録例\n\n\n#### BlackTech\n\nPoshC2を悪⽤する⼀連の攻撃の中で、BlackTechが利⽤するTSCookieやTSCookie Loader※17を\n確認しています。図17に示すように、TSCookie Loaderが読み込むファイルは、「*%c???.*」に\nマッチするファイル名です。今回のケースでは、\"%c\"には、「A」が⼊るため、ファイル名が\n「*A??.*」となっています。また、メモリ上にロードされるDLLファイル名は、正規のDLLファ\nイル名と同じ「gdiplus.dll」となっています（図18）。\n\n\n※17 攻撃グループBlackTechが侵⼊後に使⽤するマルウエア - JPCERT/CC Eyes | JPCERTコーデ\nィネーションセンター公式ブログ\n\n図17 TSCookie Loaderが読み込むファイル名\n\nこれらの2つの攻撃者グループの痕跡は同⼀組織の侵害事例の中で⾒つかっています。被害者PC\nに残されたマルウェア、イベントログや通信ログなどの痕跡を確認すると、同⼀期間に作成され\nたものではなく、いずれかの攻撃が⾏われた後、数ヶ⽉から半年ほど経ってから、新たに作成さ\nれたものでした。このことから、2つの攻撃者グループは、「標的組織の情報」を共有し、連携\nしながら攻撃活動を⾏っている、または1つの⼤きな攻撃者グループとして攻撃活動を⾏なって\nいる可能性が考えられます。\n\n\n-----\n\n今回は、2020年においてもPoshC2を\n悪⽤した攻撃を引き続き確認している\nため、この⼀連の攻撃について改めて\n紹介しました。昨今、Taidoorや\nBlackTechは、絶えず攻撃を仕掛けて\nきており、今後も新しい攻撃の⼿⼝や\n攻撃ツールを変化させ、継続的に攻撃\nを仕掛けてくることが考えられます。\n\n\n図18 メモリ上にロードされるDLLファイル名\n\n\n今回の攻撃では、⽇本の多くの企業が導⼊しているセキュリティ対策製品の脆弱性が悪⽤されて\nおり、⽇本の組織を標的としていることがわかります。標的型攻撃の起点は、添付ファイルや本\n⽂にリンクを含むスピアフィッシングメールが多いですが、SSL VPN製品やルータ・ゲートウェ\nイ製品の脆弱性を悪⽤するケースも多く、これらの製品の脆弱性を悪⽤されないためにも、⽇々\nの脆弱性情報の管理と修正パッチの適⽤や緩和策の適⽤などの早急な対応が求められます。\n\n[オープンソースのポート転送／トンネリングツールを悪⽤する標的型攻撃に注意](https://www.lac.co.jp/lacwatch/people/20200212_002127.html)\nまた、これらの攻撃グループは、「frp」や「plink」といったポート転送／トンネリングツールを\n悪⽤してリモートデスクトップ（RDP）接続を⾏う攻撃を⾏うことも確認しています。ポート転\n送／トンネリングツールを悪⽤したRDPを利⽤した攻撃の詳細については「オープンソースのポ\nート転送／トンネリングツールを悪⽤する標的型攻撃に注意」のLAC WATCHをご参照くださ\nい。\n\nラックの脅威分析チームでは、今後もこの攻撃者グループについて継続的に調査し、広く情報を\n提供していきますので、ご活⽤いただければ幸いです。\n\n## MITRE ATT&CK Techniques\n\n以下に、PoshC2を悪⽤した標的型攻撃で⽤いられる攻撃の⼿⼝をまとめます。これらの⼿⼝\nは、MITRE ATT＆CKフレームワークに基づいて作成しています。Tacticの「Lateral\nMovement」、「Collection」、「Command and Control」、「Exfiltration」の項⽬については、\n多くがMitre社のPoshC2で紹介※18されるテクニックが利⽤されています。\n\n[※18 PoshC2, Software S0378 | MITRE ATT&CK®](https://attack.mitre.org/software/S0378/)\n\n\n-----\n\n表2 MITRE ATT&CK Techniques\n\n##### Tactic ID Name 概要\n\n\n##### Initial Access\n\n Execu‐ tion\n\n Persis‐ tence\n\n De‐ fense Eva‐ sion\n\n\n##### T1195 Supply Chain Compromise\n\n T1059 Command-Line Interface\n\n\n##### T1060 Registry Run Keys / Startup Folder\n\n T1015 Accessibility Features\n\n T1038 DLL Search Or‐ der Hijacking\n\n T1089 Disabling Securi‐ ty Tools\n\n T1140 Deobfuscate/De‐ code Files or Information\n\n\n##### セキュリティ対策製品の脆弱性を悪⽤偽の アップデートファイル配信\n\n regコマンドを利⽤したRDP設定 変更やバ ッチファイルの実⾏\n\n\n##### ⾃動起動のレジストリ追加\n\n 拡⼤鏡機能を悪⽤したcmd.exeによるバッ クドア\n\n 正規の実⾏ファイルが使うDLLファイルと 同じ名前の悪性ファイルを同⼀ディレクト リに設置\n\n PowerShellスクリプトブロックのログ記録 を無効、AMSIの回避\n\n マルウェア内またはペイロードに含まれる ⽂字列を難読化\n\n\n##### T1086 PowerShell PoshC2スクリプトの実⾏\n\n\n##### T1035 Service Execution\n\n\n##### RasAutoサービスを利⽤したPoshC2スク リプトの実⾏\n\n\n##### T1047 Scheduled Task スケジュールタスクを利⽤したPoshC2ス クリプトの実⾏\n\n\n##### T1127 Trusted Develop‐ er Utilities\n\n T1031 Modify Existing Service\n\n\n##### MSBuild悪⽤\n\n RasAutoサービスの変更\n\n\n##### T1050 New Service サービスの登録\n\n\n##### T1107 File Deletion 使⽤したファイルの削除\n\n T1055 Process Injection 正規プログラム（msbuild.exe, notepad.exeなど）にインジェクション\n\n\n-----\n\n##### Tactic ID Name 概要\n\n\n##### Cre‐ dential Access\n\n Discov‐ ery\n\n Lateral Move‐ ment\n\n\n##### T1003 Credential Dumping\n\n T1135 Network Share Discovery\n\n T1082 System Informa‐ tion Discovery\n\n T1049 System Network Connection Discovery\n\n T1057 Process Discovery\n\n T1076 Remote Desktop Protocol\n\n\n##### Poweshellを利⽤したMimikatzの実⾏\n\n netコマンドを利⽤したネットワークの探 索\n\n dirコマンドによるファイル検索\n\n netstatコマンドによる通信しているIPアド レス・ポート番号や解放ポートを表示\n\n tasklistコマンドによるプロセス⼀覧情報を 取得\n\n frpや攻撃者独⾃のトンネリングツールを利 ⽤した外部からのRDP接続\n\n\n##### T1021 Remote Services Plinkを利⽤した外部からのRDP接続\n\n\n##### T1021 Remote File Copy\n\n\n##### PoshC2を利⽤したファイルのアップロー ドまたはダウンロード\n\n\n### IOC（Indicator Of Compromised）\n\n#### ハッシュ値\n\n7658d4c74b519187b2829359a921e374\nf0fdb786ca994342a8a91adb5ba6987f\n\n#### 通信先\n\naccount[.]azure-microsoft[.]top\n13[.]78[.]10[.]244\n\n\n-----",
    "language": "JA",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.04.24_PoshC2_APT/PoshC2_APT_jp.pdf"
    ],
    "report_names": [
        "PoshC2_APT_jp"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71b19e59-b5f7-4bc6-816d-194be0f02af0",
            "created_at": "2022-10-25T16:07:24.301036Z",
            "updated_at": "2025-03-27T02:02:10.165121Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "Budminer",
                "Earth Aughisky"
            ],
            "source_name": "ETDA:Taidoor",
            "tools": [
                "Dripion",
                "Masson",
                "Taidoor",
                "simbot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "50bd4a6c-7542-4bdd-8b37-ab468fc428ef",
            "created_at": "2023-01-06T13:46:38.998658Z",
            "updated_at": "2025-03-27T02:00:02.973354Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "G0015",
                "Earth Aughisky"
            ],
            "source_name": "MISPGALAXY:Taidoor",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "478e9b27-39b9-49e4-a3c5-81569a767275",
            "created_at": "2022-10-25T15:50:23.417339Z",
            "updated_at": "2025-03-27T02:00:55.464624Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "Taidoor"
            ],
            "source_name": "MITRE:Taidoor",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041638,
    "ts_creation_date": 1588862704,
    "ts_modification_date": 1588862704,
    "files": {
        "pdf": "https://archive.orkl.eu/61251cc065cb364dbba4585d1d97b0d81062cfc1.pdf",
        "text": "https://archive.orkl.eu/61251cc065cb364dbba4585d1d97b0d81062cfc1.txt",
        "img": "https://archive.orkl.eu/61251cc065cb364dbba4585d1d97b0d81062cfc1.jpg"
    }
}