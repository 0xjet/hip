{
    "id": "1296d4a2-7e8c-48bb-9ba2-2eb59264b7b5",
    "created_at": "2023-01-12T15:01:21.295672Z",
    "updated_at": "2025-03-27T02:14:34.253077Z",
    "deleted_at": null,
    "sha1_hash": "74ceb7d799c1e4c77986ee45ef586eef9660f603",
    "title": "2020-04-26 - The DGA of Zloader",
    "authors": "",
    "file_creation_date": "2022-05-27T21:08:38Z",
    "file_modification_date": "2022-05-27T21:08:38Z",
    "file_size": 1489939,
    "plain_text": "# The DGA of Zloader\n\n**johannesbader.ch/blog/the-dga-of-zloader/**\n\nZloader — also known as Terdot, DELoader or Zeus Sphinx 1 — is a malware from May 2016\nthat has resurged in the last few weeks 2 3 4 5 6  . The last two references 5 6 are posts by Brad\nDuncan that mention and list random domain names:\n\n\n\n[…] then it started generating DNS queries for random 20-character alphabetic strings\nwith .com as the top level domain (TLD). I’ve included some examples below.\n```\njgqhigsjkulmsvvhshmk.com\nwapjdxlstholqwakofgi.com\naiavxvlshmkweccksfky.com\nliswrfujohqsnbnohetn.com\nhciqylualwcnyvajdkqq.com\npdtlshacpbacpnhcndpd.com\nkdacggcctwcavdgvpbmk.com\nwapwtpwciertrhkdaxrp.com\nshyjgiyhyegxeqqpdtya.com\ngccggcctwcerlshacpba.com\ncpnhcndpdkylibtlbeco.com\nbxhwpdkqdakbplfvfqwn.com\nbioonshmwrbecckfcavh.com\n\n```\nSimilar 20-character domains had also been referenced by Twitter User [TomasP, who](https://twitter.com/0xE9FBFFFFFF/status/1250052864363450369)\napparently also reverse engineered the domain generation algorithm (DGA) 7, yet did not\n[publish it. Twitter User DynamicAnalysis subsequently published DGA domains on Pastebin](https://twitter.com/DynamicAnalysis)\n\n\n-----\n\n— for example — but only for one particular seed.\n\nThis blog post shows how to reverse engineer the algorithm and presents as a result a\nreimplementation in Python. The post is based on the following sample, but I also looked at\nother samples to find additional seeds.\n\n**MD5**\nafdf2fbc0756ed304d1a33083a5f2b0f\n\n**SHA1**\nf3a25627f925390097a64a84ef34c952fe8af036\n\n**SHA256**\na947c216ea52ce23457b3babb1e1eb6275cabe2150d3995553e4de4b8c3d97f4\n\n**Size**\n323 KB (330752 Bytes)\n\n**Compile Timestamp**\n2019-05-27 07:19:22 UTC\n\n**Links**\n[MalwareBazaar,](https://bazaar.abuse.ch/sample/a947c216ea52ce23457b3babb1e1eb6275cabe2150d3995553e4de4b8c3d97f4/) [URLHaus,](https://urlhaus.abuse.ch/url/347737/) [Twitter,](https://twitter.com/p5yb34m/status/1252648679543934976) [VirusTotal](https://www.virustotal.com/gui/file/a947c216ea52ce23457b3babb1e1eb6275cabe2150d3995553e4de4b8c3d97f4)\n\n**Filenames**\nantiamsi.bin (MalwareBazaar), antiamsi.bin (VirusTotal)\n\n**Detections**\n**MalwareBazaar: ZLoader, Virustotal: 52/74 as of 2020-04-25 03:46:18 -**\nTrojanSpy:Win32/Glupteba.ef0afc48 (Alibaba), Trojan:Win32/Glupteba.RRS!MTB (Microsoft),\nWin32.Trojan-spy.Zbot.Lscl (Tencent), Trojan-Spy.Win32.Zbot.zzac (ZoneAlarm)\n\nThe sample is — as is customary — packed. Unpacking it leads to this sample:\n\n**MD5**\nc844efe1b7e76cbdea36ce62ff788de9\n\n**SHA1**\nd8143cf09bff7b0ca2a0c777912746a5922104ee\n\n**SHA256**\n835048e00ba3babf6f920c9a4c2863865a5dcf8e0b6ede4f57c63aeb9cb5c147\n\n**Size**\n184 KB (188416 Bytes)\n\n**Compile Timestamp**\n2020-04-08 18:19:58 UTC\n\n**Links**\n[MalwareBazaar,](https://bazaar.abuse.ch/sample/835048e00ba3babf6f920c9a4c2863865a5dcf8e0b6ede4f57c63aeb9cb5c147/) [Malpedia,](https://malpedia.caad.fkie.fraunhofer.de/details/win.zloader) [Dropped_by_md5,](https://johannesbader.ch/blog/the-dga-of-zloader/afdf2fbc0756ed304d1a33083a5f2b0f) [VirusTotal](https://www.virustotal.com/gui/file/835048e00ba3babf6f920c9a4c2863865a5dcf8e0b6ede4f57c63aeb9cb5c147)\n\n\n-----\n\n**Detections**\n**Virustotal: 30/74 as of 2020-04-25 20:55:07 - a variant of Win32/Spy.Zbot.ADI (ESET-**\nNOD32), W32/Zbot.ADI!tr (Fortinet), HEUR:Backdoor.Win32.Dridex.vho (Kaspersky),\nBehavesLike.Win32.Adopshel.ch (McAfee-GW-Edition), HEUR:Backdoor.Win32.Dridex.vho\n(ZoneAlarm)\n\nThis sample creates a new Windows installer process `msiexec.exe in suspended state. It`\nthen writes an encrypted copy of itself into `msiexec.exe, as well as a decryption stub. The`\nthread context is set to the stub and execution of the thread is resumed. The decryption stub\ndecrypts the injected binary and jumps to the first subroutine at offset 0x1C90. I dumped the\nsample with entry point set to this starting point. It should be “runnable” if loaded with image\nbase `0x03090000 :`\n\n**MD5**\n5c76c41f9d0cc939240b3101541b5475\n\n**SHA1**\nda361ec6976d3d9225ce40951b26d1d8ecdb7fd1\n\n**SHA256**\n4029f9fcba1c53d86f2c59f07d5657930bd5ee64cca4c5929cbd3142484e815a\n\n**Size**\n208 KB (212992 Bytes)\n\n**Compile Timestamp**\n2020-04-08 18:19:58 UTC\n\n**Links**\n[MalwareBazaar,](https://bazaar.abuse.ch/sample/4029f9fcba1c53d86f2c59f07d5657930bd5ee64cca4c5929cbd3142484e815a/) [Malpedia,](https://malpedia.caad.fkie.fraunhofer.de/details/win.zloader) [Dropped_by_md5,](https://johannesbader.ch/blog/the-dga-of-zloader/c844efe1b7e76cbdea36ce62ff788de9) [VirusTotal](https://www.virustotal.com/gui/file/4029f9fcba1c53d86f2c59f07d5657930bd5ee64cca4c5929cbd3142484e815a)\n\n**Detections**\n**Virustotal: 22/74 as of 2020-04-25 20:55:24 - Win32/Spy.Zbot.ADI (ESET-NOD32),**\nBScope.Trojan-Spy.Zbot (VBA32)\n\nThe following analysis is based on this last sample (f3f2393a838d417ff8f823a235bd83f2)\nloaded at image base 0x03091CD2.\n\n## Reverse Engineering\n\nThe analysis of the sample is complicated mainly by three techniques:\n\n[1. The strings are encrypted. I chose the Appcall functionality of IDA Pro to decrypt them](https://www.hex-rays.com/wp-content/uploads/2019/12/debugging_appcall.pdf)\n\ndynamically.\n2. API calls are hidden by dynamically resolving them using function hashes. Again,\n\nAppcalls to evaluate the routine that resolves the API reveal most API names.\n\n\n-----\n\n3. Constant unfolding, dead code insertion and artithmetic substitution via indentities. The\n\nfirst two are mostly removed by the Hex Rays decompiler, and the arithemetic identities\ncan be easily simplified with basic logical equivalences. I’ll show an example of this\nwhen analysing the DGA\n\nDecryption of strings takes one function argument - the offset to the ciphertext:\n```\n.text:03091CDB 68 B4 CA 0B 03     push  offset dword_30BCAB4\n.text:03091CE0 E8 1B 17 01 00     call  decrypt_string ; BOT-INFO\n\n```\nThe comment next to the `decrypt_string function call with the plaintext was found by`\nrunning the following IDA script:\n\n\n-----\n\n```\nfrom idc import \nfrom idautils import *\nimport idaapi\nimport sys\nimport string\nimport re\nRESOLVER_TYPE_DEC = \"char *__cdecl decrypt_string(char *a1, char *a2);\"\nm = re.search(\"\\s([^ (@]+)[(@]\", RESOLVER_TYPE_DEC)\nRESOLVER_NAME = m.group(1)\nresolver_addr = get_name_ea_simple(RESOLVER_NAME)\nif resolver_addr == idaapi.BADADDR:\n  print(RESOLVER_NAME + \" not defined\")\n  sys.exit()\nresolver = idaapi.Appcall.typedobj(RESOLVER_TYPE_DEC)\nresolver.ea = resolver_addr\ndef previous_heads(ea):\n  \"\"\" iterator to get previous instructions of an address (no including itself) \"\"\"\n  if not idc.is_head(idc.get_full_flags(ea)):\n    ea = idaapi.next_head(ea, ea+1000)\n  ea = idaapi.prev_head(ea,0)\n  while ea != idaapi.BADADDR:\n    yield ea\n    ea = idaapi.prev_head(ea, 0)\ndef do():\n  \"\"\" count the nr of references to the resolver function \"\"\"\n  xrefs = list(CodeRefsTo(resolver_addr,1))\n  \"\"\" iterate over all references \"\"\"\n  for i, xr in enumerate(xrefs):\n    print(\"[-] tackling {:08X}\".format(xr))\n    args = []\n    for x in previous_heads(xr):\n      args.append(get_operand_value(x, 0))\n      if len(args) >= 1:\n        break\n    empty = Appcall.buffer(\" \", 1000)\n    args.append(empty)\n    try:\n      r = resolver(*args)\n    except Exception as e:\n      print(\"FAILED: appcall failed: {}\".format(e))\n      continue\n    try:\n      name = empty.value\n    except:\n      print(\"FAILED: to read back buffer)\n      continue\n    print(\"OK: found {}\".format(name))\n    set_cmt(xr, name, True)\n\n```\n\n-----\n\n```\ndo()\n\n```\nWindows API functions such as InternetConnectA are dynamically resolved and then called:\n```\n.text:030917DC 68 E1 75 E7 0A     push  0AE775E1h\n.text:030917E1 6A 13          push  13h\n.text:030917E3 E8 88 19 01 00     call  resolve_api   ;\nwininet_InternetConnectA\n.text:030917E8 83 C4 08        add   esp, 8\n.text:030917EB 0F B7 4D 10       movzx  ecx, [ebp+arg_8]\n.text:030917EF 6A 00          push  0\n.text:030917F1 6A 00          push  0\n.text:030917F3 6A 03          push  3\n.text:030917F5 6A 00          push  0\n.text:030917F7 6A 00          push  0\n.text:030917F9 51           push  ecx\n.text:030917FA 53           push  ebx\n.text:030917FB 56           push  esi\n.text:030917FC FF D0          call  eax\n\n```\nA similar IDA Pro script as the one to decrypt the strings was used to find the API names and\ncomment the disassembly.\n\nListing all references to the string decryption routine, we see one producing the plaintext\n“.com”:\n\n\n-----\n\nBecause the strings are deciphered immediatly before they are used, the decryption call for\n_.com leads to the_ [DGA routine. IDA Pro does a very good job of decompiling the routine. I](https://johannesbader.ch/blog/the-dga-of-zloader/assets/dga_large.png)\nrenamed a few variables and subroutines to get to this C code:\n\n\n-----\n\n```\nint __cdecl the_dga(int dwSeed, int nNumberOfDomains, int pArrayOfDomains)\n{\n int result; // eax\n unsigned int r; // esi\n int i; // edi\n unsigned int offset; // ebx\n char the_letter; // al\n unsigned int dwSeedXored_1; // ebx\n char *szTLD_1; // eax\n int i_1; // [esp-10h] [ebp-48h]\n char szTLD[19]; // [esp+1h] [ebp-37h]\n _DWORD the_domain_object[3]; // [esp+14h] [ebp-24h]\n unsigned int dwSeedXored; // [esp+20h] [ebp-18h]\n int iDomainNr; // [esp+24h] [ebp-14h]\n char szDomain[13]; // [esp+2Bh] [ebp-Dh]\n if ( nNumberOfDomains )\n {\n  r = dwSeed;\n  result = 0;\n  dwSeedXored = dwSeed ^ 0x81716ECC;\n  do\n  {\n   iDomainNr = result;\n   initialize(the_domain_object);\n   i = 0;\n   do\n   {\n    offset = r % get_nr_25();\n    the_letter = offset + get_nr_97();\n    dwSeedXored_1 = dwSeedXored;\n    szDomain[0] = the_letter;\n    update_domain_object(szDomain);\n    r = dwSeedXored_1 ^ or(~(r + szDomain[0]) & 0x81716ECC, (r + szDomain[0]) &\n0x7E8E9133, 0);\n    i_1 = i++;\n    plus(i_1, 1, 0, 0);\n   }\n   while ( i != get_nr_20() );\n   szTLD_1 = decrypt_string(szTLDCiphertext, szTLD);\n   concatenate(szTLD_1);\n   save_in_array((_DWORD *)pArrayOfDomains, (int)the_domain_object);\n   reset(the_domain_object);\n   result = plus_0(iDomainNr + 0x6A6E645D, 1u, 0) - 0x6A6E645D;\n  }\n  while ( result != nNumberOfDomains );\n }\n return result;\n}\n\n```\nThe code is already pretty readable. The only non obvious part is the random number\ncalculation — variable r — which requires some basic logical computation. Let the seed\n```\ndwSeed be s, and szDomain[0] be l, then the next number is determined as follows\n\n```\n($\\cdot$, $\\oplus$, and $+$ stand for logical and, xor and or respectively):\n\n\n-----\n\n$$ \\begin{align } r &= (s \\oplus \\text{0x81716ECC}) \\oplus (\\sim (r + l) \\cdot\n\\text{0x81716ECC} ) + ((r + l)\\cdot \\text{0x7E8E9133}) \\end{align*} $$\n\nThe two constants have the following relationship:\n\n$$ 0x81716ECC = \\sim 0x7E8E9133 \\text{ mod } 2^{32} $$\n\nFuthermore\n\n$$ a \\oplus b = (\\sim a \\cdot b) + (a \\cdot \\sim b) $$\n\nSo by setting k= 0x81716ECC we get:\n\n$$ \\begin{align*} r &= (s \\oplus k) \\oplus (\\sim (r + l) \\cdot k ) + ((r + l)\\cdot \\sim k) \\\\ &= s\n\\oplus k \\oplus ( (r+l) \\oplus k) \\\\ &= s \\oplus (r + l) \\end{align*} $$\n\nThis leads to the following Python code for the DGA:\n```\ndef dga(seed, nr_of_domains):\n  domains = []\n  r = seed;\n  for i in range(nr_of_domains):\n    domain = \"\"\n    for j in range(20):\n      letter = ord('a') + (r % 25)\n      domain += chr(letter)\n      r = seed ^ ( (r + letter) & 0xFFFFFFFF)\n    domain += \".com\"\n    print(domain)\n\n```\nLooking at the caller of the domain generation routine, we see how the seed is calculated:\n\n\n-----\n\n```\n.text:03095540 push  ebp\n.text:03095541 mov   ebp, esp\n.text:03095543 push  ebx\n.text:03095544 push  edi\n.text:03095545 push  esi\n.text:03095546 sub   esp, 16Ch\n.text:0309554C lea   edi, [ebp+pS]\n.text:03095552 mov   [ebp+var_1C], ecx\n.text:03095555 push  edi\n.text:03095556 call  decrypt_config_rc4\n.text:0309555B add   esp, 4\n.text:0309555E lea   esi, [ebp+pArrayOfDomains]\n.text:03095561 mov   ecx, esi\n.text:03095563 call  sub_30BA8E0\n.text:03095568 call  get_today_at_0UTC\n.text:0309556D mov   [ebp+dwSeed], eax\n.text:03095570 call  sub_30A5260\n.text:03095575 lea   ecx, [ebp+dwSeed]\n.text:03095578 push  edi\n.text:03095579 push  eax\n.text:0309557A push  ecx\n.text:0309557B call  rc4_encrypt\n.text:03095580 add   esp, 0Ch\n.text:03095583 mov   edi, [ebp+dwSeed]\n.text:03095586 call  get_nr_of_domains\n.text:0309558B push  esi\n.text:0309558C push  eax\n.text:0309558D push  edi\n.text:0309558E call  the_dga\n\n```\nFirst, the config of Zloader is decrypted with RC4. The RC4 key `djluflczrgefphtiwegc is`\nhardcoded in the sample. The config contains the hardcoded domains which are contacted\nbefore the DGA domains are used — if at all. At the end of the config, there is a new RC4\nkey `q23Cud3xsNf3 which is used for seeding the DGA:`\n```\ns\nTelegramCrypt\nAntiAMSIdoc\nhttp://wmwifbajxxbcxmucxmlc.com/post.php\nhttp://pwkqhdgytsshkoibaake.com/post.php\nhttp://snnmnkxdhflwgthqismb.com/post.php\nhttp://iawfqecrwohcxnhwtofa.com/post.php\nhttp://nlbmfsyplohyaicmxhum.com/post.php\nhttp://fvqlkgedqjiqgapudkgq.com/post.php\nhttp://cmmxhurildiigqghlryq.com/post.php\nhttp://nmqsmbiabjdnuushksas.com/post.php\nhttp://fyratyubvflktyyjiqgq.com/post.php\nq23Cud3xsNf3\n\n```\nThe seed is based on the unix timestamp for the current date at time 00:00 UTC. This 32bit\nvalue is representated in little endian order, and the four bytes are RC4 encrypted with the\nkey from the config, i.e., `q23Cud3xsNf3 . The result is then interpreted as the little endian`\nrepresentation of the seed. The following Python snippet shows the seeding procedure.\n\n\n-----\n\n```\nkey q23Cud3xsNf3 \nrc4 = RC4(key)\nd = d.replace(hour=0, minute=0, second=0)\ntimestamp = int((d - datetime(1970, 1, 1)).total_seconds())\np = struct.pack(\"<I\", timestamp)\nc = rc4.encrypt(p)\nseed = struct.unpack(\"<I\", c)[0]\n\n```\nWith the seeding procedure and the DGA finished, we can now give a complete\nreimplementation of the DGA.\n\n## Reimplementation in Python\n\nThe following Python code can be used to generate the Zloader domains for any date and\nRC4 seed value. For example, to generate the domains for April 25, 2020 and seed\n```\nq23Cud3xsNf3 do dga.py -d 2020-04-25 --rc4 q23Cud3xsNf3 . You also find the\n\n```\n[algorithm in my domain generation GitHub repository.](https://github.com/baderj/domain_generation_algorithms/tree/master/zloader)\n\n\n-----\n\n```\nfrom datetime import datetime\nimport struct\nimport argparse\nclass RC4:\n  def __init__(self, key_s):\n    key = [ord(k) for k in key_s]\n    S = 256*[0]\n    for i in range(256):\n      S[i] = i\n    j = 0\n    for i in range(256):\n      j = (j + S[i] + key[i % len(key)]) % 256\n      S[i], S[j] = S[j], S[i]\n    self.S = S\n    self.i = 0\n    self.j = 0\n  def prng(self):\n    self.i = (self.i + 1) % 256\n    self.j = (self.j + self.S[self.i]) % 256\n    self.S[self.i], self.S[self.j] = self.S[self.j], self.S[self.i]\n    K = self.S[(self.S[self.i] + self.S[self.j]) % 256]\n    return K\n  def encrypt(self, data):\n    res = bytearray()\n    for d in data:\n      c = d ^ self.prng()\n      res.append(c)\n    return res\n  def __str__(self):\n    r = \"\"\n    for i, s in enumerate(self.S):\n      r += f\"{i}: {hex(s)}\\n\"\n    return r\ndef seeding(d, key):\n  rc4 = RC4(key)\n  d = d.replace(hour=0, minute=0, second=0)\n  timestamp = int((d - datetime(1970, 1, 1)).total_seconds())\n  p = struct.pack(\"<I\", timestamp)\n  c = rc4.encrypt(p)\n  seed = struct.unpack(\"<I\", c)[0]\n  return seed\ndef dga(seed, nr_of_domains):\n\n```\n\n-----\n\n```\n  r seed\n  for i in range(nr_of_domains):\n    domain = \"\"\n    for j in range(20):\n      letter = ord('a') + (r % 25)\n      domain += chr(letter)\n      r = seed ^ ((r + letter) & 0xFFFFFFFF)\n    domain += \".com\"\n    print(domain)\nif __name__ == \"__main__\":\n  parser = argparse.ArgumentParser()\n  parser.add_argument(\"-d\", \"--date\", help=\"date when domains are generated\")\n  parser.add_argument(\"-r\", \"--rc4\",\n      help=\"rc4 key from config\",\n      choices=[\"q23Cud3xsNf3\",\"41997b4a729e1a0175208305170752dd\",\n\"kZieCw23gffpe43Sd\"],\n      default=\"q23Cud3xsNf3\")\n  args = parser.parse_args()\n  if args.date:\n    d = datetime.strptime(args.date, \"%Y-%m-%d\")\n  else:\n    d = datetime.now()\n  seed = seeding(d, args.rc4)\n  dga(seed, 32)\n\n## Other Samples - Other Seeds\n\n```\nFor reference, this section lists three more samples that I have analyzed and which have\nresulted in two additional seeds. You find precalculated lists of the DGA domains for all three\nseeds in my domain generation GitHub repository 10.\n\n\n**md5** **seed**\n\n\n**list of**\n**domains**\n\n\nafdf2fbc0756ed304d1a33083a5f2b0f q23Cud3xsNf3 [list](https://github.com/baderj/domain_generation_algorithms/blob/master/zloader/domains_q23Cud3xsNf3.txt)\n\n2169e871d4ca668d1872722d1a0695dc q23Cud3xsNf3 [list](https://github.com/baderj/domain_generation_algorithms/blob/master/zloader/domains_q23Cud3xsNf3.txt)\n\nfa9b3dfdb4b97dfe0db5991472f89399 41997b4a729e1a0175208305170752dd [list](https://github.com/baderj/domain_generation_algorithms/blob/master/zloader/domains_41997b4a729e1a0175208305170752dd.txt)\n\n306212efebc6ac92000687393e56a5cb kZieCw23gffpe43Sd [list](https://github.com/baderj/domain_generation_algorithms/blob/master/zloader/domains_kZieCw23gffpe43Sd.txt)\n\n### 2169e871d4ca668d1872722d1a0695dc\n\n**MD5**\n2169e871d4ca668d1872722d1a0695dc\n\n**SHA1**\n\n\n-----\n\nadd2bbbac042c328ed71c9fd2efcb9cbce5a89f7\n\n**SHA256**\ncc87e6581ca91f941f65332b2de0e681d58491b54aff9d0b30afae828a5f5790\n\n**Size**\n539 KB (552448 Bytes)\n\n**Compile Timestamp**\n2020-04-14 11:20:46 UTC\n\n**Links**\n[MalwareBazaar,](https://bazaar.abuse.ch/sample/cc87e6581ca91f941f65332b2de0e681d58491b54aff9d0b30afae828a5f5790/) [URLhaus,](https://urlhaus.abuse.ch/url/340197/) [VirusTotal](https://www.virustotal.com/gui/file/cc87e6581ca91f941f65332b2de0e681d58491b54aff9d0b30afae828a5f5790)\n\n**Filenames**\nSecuriteInfo.com.Win32.GenKryptik.EILT.4491 (MalwareBazaar), output.155861665.txt,\nThusput, Thusput.DLL, znvmzdd.dll, ZnVmZdD.dll, april14.dll (VirusTotal)\n\n**Detections**\n**Virustotal: 42/75 as of 2020-04-18 16:11:27**\n\nunpacks to\n\n**MD5**\n6a900d6f8af3a1a0e31ca5bb63637d03\n\n**SHA1**\n221ab3d8ab16a0a7790026aab9b26904be6db436\n\n**SHA256**\ne4d0a79d2463c5d3a71874e3389fa753f480b96639ad32baf1997baf8e5f714a\n\n**Size**\n187 KB (191488 Bytes)\n\n**Compile Timestamp**\n2020-04-08 18:20:42 UTC\n\n**Links**\n[MalwareBazaar,](https://bazaar.abuse.ch/sample/e4d0a79d2463c5d3a71874e3389fa753f480b96639ad32baf1997baf8e5f714a/) [Malpedia,](https://malpedia.cad.fkie.fraunhofer.de/details/win.zloader) [Dropped_by_md5,](https://johannesbader.ch/blog/the-dga-of-zloader/2169e871d4ca668d1872722d1a0695dc) [VirusTotal](https://www.virustotal.com/gui/file/e4d0a79d2463c5d3a71874e3389fa753f480b96639ad32baf1997baf8e5f714a)\n\n**Detections**\n**Virustotal: 29/75 as of 2020-04-25 20:58:26**\n\nThe config is encrypted with RC4 key `edykepkrqahpyxabcwgm . These are the hardcoded`\ndomains:\n\n\n-----\n\n```\nhttp://wmwifbajxxbcxmucxmlc.com/post.php\nhttp://ojnxjgfjlftfkkuxxiqd.com/post.php\nhttp://pwkqhdgytsshkoibaake.com/post.php\nhttp://snnmnkxdhflwgthqismb.com/post.php\nhttp://iawfqecrwohcxnhwtofa.com/post.php\nhttp://nlbmfsyplohyaicmxhum.com/post.php\nhttp://fvqlkgedqjiqgapudkgq.com/post.php\nhttp://cmmxhurildiigqghlryq.com/post.php\nhttp://nmqsmbiabjdnuushksas.com/post.php\nhttp://fyratyubvflktyyjiqgq.com/post.php\n\n```\nThe RC4 key for the DGA seed is `q23Cud3xsNf3 .`\n\n### fa9b3dfdb4b97dfe0db5991472f89399\n\n**MD5**\nfa9b3dfdb4b97dfe0db5991472f89399\n\n**SHA1**\n5677f26e926c8c8d7f7bf7eb085a9e48549a268b\n\n**SHA256**\n3648fe001994cb9c0a6b510213c268a6bd4761a3a99f3abb2738bf84f06d11cf\n\n**Size**\n512 KB (524288 Bytes)\n\n**Compile Timestamp**\n2020-04-20 10:48:16 UTC\n\n**Links**\n[MalwareBazaar,](https://bazaar.abuse.ch/sample/3648fe001994cb9c0a6b510213c268a6bd4761a3a99f3abb2738bf84f06d11cf/) [URLHaus,](https://urlhaus.abuse.ch/url/346908/) [Twitter,](https://twitter.com/DynamicAnalysis/status/1252259631042301957) [VirusTotal](https://www.virustotal.com/gui/file/3648fe001994cb9c0a6b510213c268a6bd4761a3a99f3abb2738bf84f06d11cf)\n\n**Filenames**\nf.dll (MalwareBazaar), Letter ease, Letter ease.DLL, f.dll (VirusTotal)\n\n**Detections**\n**MalwareBazaar: ZLoader, Virustotal: 50/75 as of 2020-04-24 02:51:48**\n\nunpacks to\n\n**MD5**\n133b1861b3590bf00308509227f82872\n\n**SHA1**\neb6f12759da7aa84077143e3e2694b6fda3d5631\n\n**SHA256**\ndd11381223ab1902db2963df4cbe3299e42064a5857545560f913647c1f70c5a\n\n**Size**\n187 KB (191488 Bytes)\n\n\n-----\n\n**Compile Timestamp**\n2020-04-08 18:20:42 UTC\n\n**Links**\n[MalwareBazaar,](https://bazaar.abuse.ch/sample/dd11381223ab1902db2963df4cbe3299e42064a5857545560f913647c1f70c5a/) [Malpedia,](https://malpedia.caad.fkie.fraunhofer.de/details/win.zloader) [Dropped_by_md5,](https://johannesbader.ch/blog/the-dga-of-zloader/fa9b3dfdb4b97dfe0db5991472f89399) [VirusTotal](https://www.virustotal.com/gui/file/dd11381223ab1902db2963df4cbe3299e42064a5857545560f913647c1f70c5a)\n\n**Detections**\n**Virustotal: 29/74 as of 2020-04-25 21:00:11**\n\nThe config is encrypted with RC4 key `dqhfltvppmucpvebkqtn . These are the hardcoded`\ndomains:\n```\nhttps://dcaiqjgnbt.icu/wp-config.php\nhttps://nmttxggtb.press/wp-config.php\n\n```\nThe RC4 key for the DGA seed is `41997b4a729e1a0175208305170752dd .`\n\n### 306212efebc6ac92000687393e56a5cb\n\n**MD5**\n306212efebc6ac92000687393e56a5cb\n\n**SHA1**\ndc0b678e9ad7cadd5de907bf80fa351d5d3347cc\n\n**SHA256**\n8d5a770975e52ce1048534372207336f6cc657b43887daa49994e63e8d7f6ce1\n\n**Size**\n856 KB (877056 Bytes)\n\n**Compile Timestamp**\n2020-04-05 16:19:02 UTC\n\n**Links**\n[MalwareBazaar,](https://bazaar.abuse.ch/sample/8d5a770975e52ce1048534372207336f6cc657b43887daa49994e63e8d7f6ce1/) [VirusTotal](https://www.virustotal.com/gui/file/8d5a770975e52ce1048534372207336f6cc657b43887daa49994e63e8d7f6ce1)\n\n**Filenames**\nJtVhjtbGMAbrWft.dll (MalwareBazaar), FfIYXQPKpCQymHQ.exe, PkRWAytIAsEHwhy.exe,\nqKMCMByhJjQpfmZ.exe, FmgJjYLZmscJaur.exe, gGwBVwnpxkyFNlc.exe,\nZhbIdJYZzrkPQGs.exe, eIGmAdVpMFJxmrk.exe, VUCJyZshHrMGvdT.exe,\nWHFQhvaOzqkkTFk.exe, dFVlQGPNqrdhrCE.exe, tnXoUCMnjELKOYm.exe,\ndTEAUJnMdnADEVG.exe, omih.dll, ikhaapd.dll, 2020-04-07-ZLoader-DLL-binary.bin,\netidwuv.dll, ekydn.dll, upiqwoq.dll, ryubn.dll, JtVhjtbGMAbrWft.exe, icobyg.dll,\nGnbjtDwFOsvocUW.exe, CbxfejTbfqXuuIT.exe, JtVhjtbGMAbrWft.bin (VirusTotal)\n\n**Detections**\n**Virustotal: 58/75 as of 2020-04-20 00:40:47**\n\nunpacks to\n\n\n-----\n\n**MD5**\n4a74e2d34230bbc705f39e6943c859d3\n\n**SHA1**\n410c1c03a52dbd56e78b0487ec532e68eb1c64e4\n\n**SHA256**\n60544c6694620488b69e568b15c96b33971dd7343ba63da31f993332852871c2\n\n**Size**\n172 KB (176640 Bytes)\n\n**Compile Timestamp**\n2020-03-30 18:35:43 UTC\n\n**Links**\n[MalwareBazaar,](https://bazaar.abuse.ch/sample/60544c6694620488b69e568b15c96b33971dd7343ba63da31f993332852871c2/) [Malpedia,](https://malpedia.caad.fkie.fraunhofer.de/details/win.zloader) [Dropped_by_md5,](https://johannesbader.ch/blog/the-dga-of-zloader/306212efebc6ac92000687393e56a5cb) [VirusTotal](https://www.virustotal.com/gui/file/60544c6694620488b69e568b15c96b33971dd7343ba63da31f993332852871c2)\n\n**Detections**\n**Virustotal: 34/75 as of 2020-04-25 20:59:59**\n\nThe config is encrypted with RC4 key `cbstobypqnbsnnpehdtb . These are the hardcoded`\ndomains:\n```\nhttps://knalc.com/sound.php\nhttps://namilh.com/sound.php\nhttps://ronswank.com/sound.php\nhttps://stagolk.com/sound.php\nhttps://mioniough.com/sound.php\nhttps://ergensu.com/sound.php\n\n```\nThe RC4 key for the DGA seed is `kZieCw23gffpe43Sd .`\n\n[1. Zloader on Malpedia](https://malpedia.caad.fkie.fraunhofer.de/details/win.zloader) ↩\n\n[2. Zloader downloads on URLHaus](https://urlhaus.abuse.ch/browse/tag/zloader/) ↩\n\n[3. Threatpost - Zeus Sphinx Banking Trojan Arises Amid COVID-19](https://threatpost.com/zeus-sphinx-banking-trojan-covid-19/154274/) ↩\n\n4. Security Intelligence - Zeus Sphinx Trojan Awakens Amidst Coronavirus Spam\n\nFrenzy ↩\n\n5. Malware-Traffic-Analysis.net - A2020-04-07 - PCAP AND MALWARE FOR AN ISC\n\nDIARY (ZLOADER) ↩ ↩\n\n[6. SANS ISC Diary - German malspam pushes ZLoader malware](https://isc.sans.edu/forums/diary/German+malspam+pushes+ZLoader+malware/25996/) ↩ ↩\n\n[7. Tweet by TomasP mentioning the DGA](https://twitter.com/0xE9FBFFFFFF/status/1250052864363450369) ↩\n\n[8. Zloader domains of seed 41997b4a729e1a0175208305170752dd for 2020-04-20](https://pastebin.com/iRHL4GWi) ↩\n\n\n-----\n\n[9. Zloader domains of seed 41997b4a729e1a0175208305170752dd for 2020-04-14](https://pastebin.com/FMEMAUbb) ↩\n\n[10. Github repository](https://github.com/baderj/domain_generation_algorithms) ↩\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-04-26 - The DGA of Zloader.pdf"
    ],
    "report_names": [
        "2020-04-26 - The DGA of Zloader.pdf"
    ],
    "threat_actors": [
        {
            "id": "e90ec9cb-9959-455d-b558-4bafef64d645",
            "created_at": "2022-10-25T16:07:24.222081Z",
            "updated_at": "2025-03-27T02:02:10.14365Z",
            "deleted_at": null,
            "main_name": "Sphinx",
            "aliases": [
                "APT-C-15"
            ],
            "source_name": "ETDA:Sphinx",
            "tools": [
                "AnubisSpy",
                "Backdoor.Oldrea",
                "Bladabindi",
                "Fertger",
                "Havex",
                "Havex RAT",
                "Jorik",
                "Oldrea",
                "PEACEPIPE",
                "njRAT",
                "yellowalbatross"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ece64b74-f887-4d58-9004-2d1406d37337",
            "created_at": "2022-10-25T16:07:23.794442Z",
            "updated_at": "2025-03-27T02:02:09.981874Z",
            "deleted_at": null,
            "main_name": "LightBasin",
            "aliases": [
                "DecisiveArchitect",
                "Luminal Panda",
                "TH-239",
                "UNC1945"
            ],
            "source_name": "ETDA:LightBasin",
            "tools": [
                "CordScan",
                "EVILSUN",
                "FRP",
                "Fast Reverse Proxy",
                "Impacket",
                "LEMONSTICK",
                "LOGBLEACH",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "OKSOLO",
                "OPENSHACKLE",
                "ProxyChains",
                "Pupy",
                "PupyRAT",
                "SIGTRANslator",
                "SLAPSTICK",
                "SMBExec",
                "STEELCORGI",
                "Tiny SHell",
                "pupy",
                "tsh"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535681,
    "ts_updated_at": 1743041674,
    "ts_creation_date": 1653685718,
    "ts_modification_date": 1653685718,
    "files": {
        "pdf": "https://archive.orkl.eu/74ceb7d799c1e4c77986ee45ef586eef9660f603.pdf",
        "text": "https://archive.orkl.eu/74ceb7d799c1e4c77986ee45ef586eef9660f603.txt",
        "img": "https://archive.orkl.eu/74ceb7d799c1e4c77986ee45ef586eef9660f603.jpg"
    }
}