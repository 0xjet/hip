{
    "id": "34f9688a-3f7f-40ce-ac30-6caac51870be",
    "created_at": "2022-10-25T16:48:17.292673Z",
    "updated_at": "2025-03-27T02:05:51.858449Z",
    "deleted_at": null,
    "sha1_hash": "1cc6d8e2ad98b3b816c39ef19da2c0eeb561050a",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-10-08T09:10:09Z",
    "file_modification_date": "2020-10-08T09:10:09Z",
    "file_size": 354237,
    "plain_text": "[Trend Micro](https://www.trendmicro.com/)\n[About TrendLabs Security Intelligence Blog](https://blog.trendmicro.com/trendlabs-security-intelligence/about-us/)\n\n[Home  »  Malware  »  Shadow Force Uses DLL Hijacking, Targets South Korean Company](https://blog.trendmicro.com/trendlabs-security-intelligence/)\n\n# Shadow Force Uses DLL Hijacking, Targets South Korean Company\n\n[Posted on:September 9, 2015 at 1:00 am](https://blog.trendmicro.com/trendlabs-security-intelligence/2015/09/)\n[Posted in:Malware, Targeted Attacks](https://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/)\nAuthor:\n[Dove Chiu (Threat Researcher)](https://blog.trendmicro.com/trendlabs-security-intelligence/author/dovechiu/)\n\n0\n\nWhat sort of interest would a businessman have in a news agency?\n\nThat was the question that arose from our recent investigation on an attack that appears to target a\nmedia agency in South Korea. Shadow Force is a new backdoor that replaces a DLL called by a particular\nWindows service. Once that backdoor is open, the attacker can use one or more tools to open up further\nholes or cause damage. This type of backdoor attack has been previously documented by Trend Micro in a\n[blog post in May.](http://blog.trendmicro.com/trendlabs-security-intelligence/attack-gains-foothold-against-east-asian-government-through-auto-start/)\n\n**_Beginnings of an attack_**\n\nThe attack begins when the Windows OS starts the Microsoft Distributed Transaction Coordinator (MSDTC)\nservice, which coordinates transactions that span multiple resource managers, such as databases, message\nqueues, and file systems. When the target computer joins a domain, once the MSDTC service starts, it will\nsearch the registry.\n\n_Figure 1. MSDTC service DLL plugins_\n\nSpecifically, the MTxOCI component in MSDTC service searches for three DLLs: oci.dll, SQLLib80.dll, and\n_xa80.dll. oci.dll isn’t normally found on the computer, but in this case, the hacker has created a backdoor_\ncomponent, renamed it to oci.dll, and placed it in %SystemRoot%\\system32\\. Once the oci.dll is in place, the\nhacker uses a remote job command to kill the MSDTC service (taskkill /im msdtc.exe /f), causing MSDTC to\nreload itself. This time, however, it looks for and finds the oci.dll. Calling this DLL opens up Shadow Force.\n\n\n-----\n\n_Figure 2. The kill command kills the MSDTC service, causing it to restart_\n\nThis simple technique bypasses forensics tools such as autorun.exe, and makes live detection and remediation\nmore difficult.\n\n**_Analysis of Shadow Force_**\n\nShadow Force has several different variations, both in DLL and EXE formats and in a 32-bit or 64-bit\nimplementations. The type of variation will rely on installe.exe, the file that downloads and installs Shadow\nForce on the computer. If install.exe runs in 32-bit mode, it will download SuperBot.exe. If it runs in 64-bit\nmode, it will download SuperBotx64.exe.\n\n_Figure 3. Strings in the Shadow Force install.exe downloader_\n\n\n-----\n\n(irc[.]itembuy[.]org) like a normal IRC bot.\n\n_Figure 4. The version string inside the Shadow Force 32-bit EXE version_\n\nThe DLL version of Shadow Force uses another type of attack. Rather than connect to a C&C server, it uses a\n[port-reuse technique by downloading and installing the file npf.sys. The npf.sys file (downloaded by Shadow](http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-backdoor-use-in-targeted-attacks.pdf)\nForce as a part of its function) comes from famous open source project [Wireshark, a well-known network](https://www.wireshark.org/)\nprotocol analyzer. Therefore, the npf.sys has a valid signature and can be loaded in Windows, to be used in\ncapturing network packets. Connecting to Shadow Force requires a specific password in the correct format.\n\n_Figure 5. With port-reuse, the attacker is able to get in through an open port in the firewall and the client, just_\n\n_as legitimate users would_\n\nOnce an attacker has gained access to a client system on an otherwise protected network, there are a number\nof tools that are available to exploit systems, networks, and beyond. These include fileh.exe, latinfect.exe,\nand aio.exe. More information about these tools, along with information about the presumed attacker can be\nfound in the [technical brief.](http://documents.trendmicro.com/assets/pdf/shadow-force-technical-brief.pdf)\n\n[Trend Micro Custom Defense solutions can protect organizations from this type of backdoor attack. These](http://www.trendmicro.com/us/business/cyber-security/)\nsolutions provide in-depth contextual analysis and insight that help IT administrators properly identify\nsuspicious behavior on individual computers and on the network, such as the access to computers and servers.\n\nTags: [APTbackdoorshadow forceSouth Korea](https://blog.trendmicro.com/trendlabs-security-intelligence/tag/apt/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.09.09.Shadow_Force/Shadow%20Force%20Uses%20DLL%20Hijacking%2C%20Targets%20South%20Korean%20Company.pdf"
    ],
    "report_names": [
        "Shadow Force Uses DLL Hijacking, Targets South Korean Company"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041151,
    "ts_creation_date": 1602148209,
    "ts_modification_date": 1602148209,
    "files": {
        "pdf": "https://archive.orkl.eu/1cc6d8e2ad98b3b816c39ef19da2c0eeb561050a.pdf",
        "text": "https://archive.orkl.eu/1cc6d8e2ad98b3b816c39ef19da2c0eeb561050a.txt",
        "img": "https://archive.orkl.eu/1cc6d8e2ad98b3b816c39ef19da2c0eeb561050a.jpg"
    }
}