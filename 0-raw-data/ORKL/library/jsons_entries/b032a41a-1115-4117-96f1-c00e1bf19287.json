{
    "id": "b032a41a-1115-4117-96f1-c00e1bf19287",
    "created_at": "2023-01-12T14:59:56.120706Z",
    "updated_at": "2025-03-27T02:05:22.325933Z",
    "deleted_at": null,
    "sha1_hash": "c2f41fafaee30c1f50947055f96965edd2868397",
    "title": "2022-05-17 - In hot pursuit of cryware Defending hot wallets from attacks",
    "authors": "",
    "file_creation_date": "2022-05-25T20:38:43Z",
    "file_modification_date": "2022-05-25T20:38:43Z",
    "file_size": 2953023,
    "plain_text": "# In hot pursuit of ‘cryware’: Defending hot wallets from attacks\n\n**[microsoft.com/security/blog/2022/05/17/in-hot-pursuit-of-cryware-defending-hot-wallets-from-attacks](https://www.microsoft.com/security/blog/2022/05/17/in-hot-pursuit-of-cryware-defending-hot-wallets-from-attacks/)**\n\nMay 17, 2022\n\n[The steep rise in cryptocurrency market capitalization, not surprisingly, mirrors a marked](https://coinmarketcap.com/charts/)\nincrease in threats and attacks that target or leverage cryptocurrencies. But Microsoft\nresearchers are observing an even more interesting trend: the evolution of related malware\nand their techniques, and the emergence of a threat type we’re referring to as cryware.\n\nCryware are information stealers that collect and exfiltrate data directly from non-custodial\n[cryptocurrency wallets, also known as hot wallets. Because hot wallets, unlike custodial](https://www.investopedia.com/terms/h/hot-wallet.asp)\nwallets, are stored locally on a device and provide easier access to cryptographic keys needed\nto perform transactions, more and more threats are targeting them.\n\nCryware signifies a shift in the use of cryptocurrencies in attacks: no longer as a means to an\nend but the end itself. Before cryware, the role of cryptocurrencies in an attack or the attack\nstage where they figured varied depending on the attacker’s overall intent. For example,\nsome ransomware campaigns prefer cryptocurrency as a ransom payment. However, that\nrequires the target user to manually do the transfer. Meanwhile, cryptojackers—one of the\nprevalent cryptocurrency-related malware—do try to mine cryptocurrencies on their own, but\nsuch a technique is heavily dependent on the target device’s resources and capabilities.\n\nWith cryware, attackers who gain access to hot wallet data can use it to quickly transfer the\ntarget’s cryptocurrencies to their own wallets. Unfortunately for the users, such theft is\nirreversible: blockchain transactions are final even if they were made without a user’s\nconsent or knowledge. In addition, unlike credit cards and other financial transactions, there\nare currently no available mechanisms that could help reverse fraudulent cryptocurrency\ntransactions or protect users from such.\n\nTo find hot wallet data such as private keys, seed phrases, and wallet addresses, attackers\ncould use regular expressions (regexes), given how these typically follow a pattern of words\nor characters. These patterns are then implemented in cryware, thus automating the process.\nThe attack types and techniques that attempt to steal these wallet data include clipping and\nswitching, memory dumping, phishing, and scams.\n\nAs cryptocurrency investing continues to trickle to wider audiences, users should be aware of\nthe different ways attackers attempt to compromise hot wallets. They also need to protect\n[these wallets and their devices using security solutions like Microsoft Defender Antivirus,](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/microsoft-defender-antivirus-windows?view=o365-worldwide)\nwhich detects and blocks cryware and other malicious files, and Microsoft Defender\nSmartScreen, which blocks access to cryware-related websites. For organizations, data and\n[signals from these solutions also feed into Microsoft 365 Defender, which provides](https://www.microsoft.com/security/business/threat-protection/microsoft-365-defender)\n\n\n-----\n\ncomprehensive and coordinated defense against threats—including those that could be\nintroduced into their networks through user-owned devices or non-work-related\napplications.\n\nIn this blog, we provide details of the different attack surfaces targeting hot wallets. We also\noffer best practice recommendations that help secure cryptocurrency transactions.\n\n## From cryptojackers to cryware: The growth and evolution of cryptocurrency-related malware\n\nThe emergence and boom of cryptocurrency allowed existing threats to evolve their\ntechniques to target or abuse cryptocurrency tokens. The threats that currently leverage\ncryptocurrency include:\n\n**Cryptojackers. One of the threat types that surfaced and thrived since the**\n[introduction of cryptocurrency, cryptojackers are mining malware that hijacks and](https://docs.microsoft.com/microsoft-365/security/intelligence/coinminer-malware?view=o365-worldwide)\nconsumes a target’s device resources for the former’s gain and without the latter’s\nknowledge or consent. Based on our threat data, we saw millions of cryptojacker\nencounters in the last year.\n**Ransomware. Some threat actors prefer cryptocurrency for ransom payments**\nbecause it provides transaction anonymity, thus reducing the chances of being\ndiscovered.\n**Password and info stealers. Apart from sign-in credentials, system information,**\nand keystrokes, many info stealers are now adding hot wallet data to the list of\ninformation they search for and exfiltrate.\n**ClipBanker trojans. Another type of info stealer, this malware checks the user’s**\nclipboard and steals banking information or other sensitive data a user copies.\nClipBanker trojans are also now expanding their monitoring to include cryptocurrency\naddresses.\n\nThe increasing popularity of cryptocurrency has also led to the emergence of cryware like\nMars Stealer and RedLine Stealer. These threats aim to steal cryptocurrencies through wallet\ndata theft, clipboard manipulation, phishing and scams, or even misleading smart contracts.\nFor example, RedLine has even been used as a component in larger threat campaigns. The\ngraph below illustrates the increasing trend in unique cryware file encounters Microsoft\nDefender for Endpoint has detected in the last year alone.\n\n\n-----\n\nFigure 1. Microsoft Defender for Endpoint cryware encounters for 2021\n\nCryware could cause severe financial impact because transactions can’t be changed once\nthey’re added to the blockchain. As mentioned earlier, there also are currently no support\nsystems that could help recover stolen cryptocurrency funds.\n\nFor example, in 2021, a user [posted about how they lost USD78,000 worth of Ethereum](https://www.reddit.com/r/EtherMining/comments/n243fd/my_eth_was_stolen_out_of_my_metamask_and/)\nbecause they stored their wallet seed phrase in an insecure location. An attacker likely gained\naccess to the target’s device and installed cryware that discovered the sensitive data. Once\nthis data was compromised, the attacker would’ve been able to empty the targeted wallet.\n\nWith the growing popularity of cryptocurrency, the impact of cryware threats have become\nmore significant. We’ve already observed campaigns that previously deployed ransomware\nnow using cryware to steal cryptocurrency funds directly from a targeted device. While not all\ndevices have hot wallets installed on them—especially in enterprise networks—we expect this\nto change as more companies transition or move part of their assets to the cryptocurrency\nspace. Users and organizations must therefore learn how to protect their hot wallets to\nensure their cryptocurrencies don’t end up in someone else’s pockets.\n\n## Hot wallet attack surfaces\n\nTo better protect their hot wallets, users must first understand the different attack surfaces\nthat cryware and related threats commonly take advantage of.\n\n### Hot wallet data\n\n\n-----\n\nDuring the creation of a new hot wallet, the user is given the following wallet data:\n\n**Private key. The key that’s required to access the hot wallet, sign or authorize**\ntransactions, and send cryptocurrencies to other wallet addresses.\n**Seed phrase. A mnemonic phrase is a human-readable representation of the private**\nkey. It’s another form of a private key that’s easier to remember. Bitcoin Improvement\nProposal: 39 (BIP39) is currently the most common standard used to generate seed\nphrases consisting of 12-14 words (from a predefined list of 2,048).\n**Public key. The public address of the wallet that users must enter as the destination**\naddress when sending funds to other wallets.\n**Wallet password** **(optional). A standard user account password that some wallet**\napplications offer as an additional protection layer.\n\nFigure 2. Sample wallet creation in a popular wallet app\n\nAttackers try to identify and exfiltrate sensitive wallet data from a target device because once\nthey have located the private key or seed phrase, they could create a new transaction and\nsend the funds from inside the target’s wallet to an address they own. This transaction is then\npublished to the blockchain of the cryptocurrency of the funds contained in the wallet. Once\nthis action is completed, the target won’t be able to retrieve their funds as blockchains are\nimmutable (unchangeable) by definition.\n\n\n-----\n\nTo locate and identify sensitive wallet data, attackers could use regexes, which are strings of\ncharacters and symbols that can be written to match certain text patterns. The following table\ndemonstrates how regexes can be used to match wallet string patterns:\n\n\n**Wallet**\n**target**\n\nPrivate\nkey\n\nSeed\nphrase\n\nWallet\naddress\n\n\n**String**\n**description**\n\nIdentify a string of\ncharacters that\ncomprise an\nexample private\nkey. This key\nwould consist of\nexactly 256 bits\n(32 characters) in\nan unspaced,\ncapitalized,\nhexadecimal\nstring located on\none line.\n\nIdentify a string of\ncharacters that\ncomprise a seed\nphrase consisting\nof 12 words\nseparated by a\nsingle space\nlocated on one\nline.\n\nIdentify a string of\ncharacters that\ncomprise an\nexample public\nwallet address.\nThis address\nwould consist of\nexactly 24\ncharacters in an\nunspaced,\nhexadecimal\nstring preceded\nby the literal\nletters “LB”.\n\n\n**String example** **Regular**\n**expression**\n\nA6FDF18E86000542388064492B58CBF ^[A-F0-9]\n{32}$\n\n\nLB32b787573F5186C696b8ed61 ^LB[a-fAF0-9]{24}$\n\n\nthis is a long string of text consisting of\ntwelve random words\n\n\n^(\\w+\\s)\n{11}\\w+$\n\n\nTable 1. Regular expressions to detect example wallet data\n\n### Cryware attack scenarios and examples\n\n\n-----\n\nOnce sensitive wallet data has been identified, attackers could use various techniques to\nobtain them or use them to their advantage. Below are some examples of the different\ncryware attack scenarios we’ve observed.\n\n**Clipping and switching**\n\nFigure 3. Clipping and switching overview\n\nIn clipping and switching, a cryware monitors the contents of a user’s clipboard and uses\nstring search patterns to look for and identify a string resembling a hot wallet address. If the\ntarget user pastes or uses CTRL + V into an application window, the cryware replaces the\nobject in the clipboard with the attacker’s address.\n\nFigure 4, which is a code based on an actual clipper malware we’ve seen in the wild,\ndemonstrates the simplest form of this attack. This code uses regexes to monitor for copied\nwallet addresses and then swaps the value to be pasted.\n\n\n-----\n\nFigure 4. Example code to replace the clipboard using regular expressions to identify wallet’s address\n\npattern\n\nWhile this technique is not new and has been used in the past by info stealers, we’ve observed\nits increasing prevalence. The technique’s stealthy nature, combined with the length and\ncomplexity of wallet addresses, makes it highly possible for users to overlook that the address\nthey pasted does not match the one they originally copied.\n\n**Memory dumping**\n\nAnother technique is memory dumping, which takes advantage of the fact that some user\ninteractions with their hot wallet could display the private keys in plaintext. This critical\ninformation might remain in the memory of a browser process performing these actions, thus\ncompromising the wallet’s integrity. Such a scenario also allows an attacker to dump the\nbrowser process and obtain the private key.\n\nThe screenshot below illustrates such an example. When a private key was exported through\na web wallet application, the private key remained available in plaintext inside the process\nmemory while the browser remained running.\n\n\n-----\n\nFigure 5. A hot wallet private key visible inside the browser process memory\n\n**Wallet file theft**\n\nWhile more sophisticated cryware threats use regular expressions, clipboard tampering, and\nprocess dumping, a simple but effective way to steal hot wallet data is to target the wallet\napplication’s storage files. In this scenario, an attacker traverses the target user’s filesystem,\ndetermines which wallet apps are installed, and then exfiltrates a predefined list of wallet\nfiles.\n\nTarget files and information include the following:\n\n**Web wallet files. Some hot wallets are installed as browser extensions with a unique**\nnamespace identifier to name the extension storage folder. A web wallet’s local vault\ncontains the encrypted private key of a user’s wallet and can be found inside this\n[browser app storage folder. Attackers target this vault as it can be brute-forced by many](https://en.wikipedia.org/wiki/Brute-force_attack)\npopular tools, such as Hashcat.\n\nExample targeted MetaMask vault folder in some web browsers: “Local Extension\nSettings\\nkbihfbeogaeaoehlefnkodbefgpgknn”\n**Desktop wallet files. Other hot wallets are installed on a user’s desktop device. The**\nprivate keys are encrypted and stored locally in application storage files specific to each\nwallet. Attackers could determine which desktop wallet is installed on a target device\nwhen stealing information from it. As with the web wallet vaults, wallet storage files\ncontaining encrypted private keys provide an excellent opportunity for brute-force\nattacks.\n\nExample targeted Exodus storage files: “Exodus\\passphrase.json”,\n“Exodus\\seed.seco”\n\n\n-----\n\n**Wallet passwords. Some wallet applications require passwords as an additional**\nauthentication factor when signing into a wallet. Some users store these passwords and\nseed phrases or private keys inside password manager applications or even as autofill\ndata in browsers. Attackers could traverse an affected device to discover any password\nmanagers installed locally or exfiltrate any browser data that could potentially contain\nstored passwords.\n\nExample targeted browser data: “\\Cookies\\”, “\\Autofill\\”\n\nMars Stealer is a notable cryware that steals data from web wallets, desktop wallets,\npassword managers, and browser files. The snippet below was taken from a section of Mars\nStealer code aimed to locate wallets installed on a system and steal their sensitive files:\n\nFigure 6. Mars Stealer code snippet that locates sensitive hot wallet data\n\nMars Stealer is available for sale on hacking forums, as seen in an example post below. The\npost describes the cryware’s capabilities of stealing sensitive data from multiple wallets and\napp storage files from an affected device. Mars Stealer then bundles the stolen data and\nexfiltrates it to an attacker-controlled command-and-control (C2) server via HTTP POST.\n\nFigure 7. An ad for Mars Stealer for sale in an underground forum\n\n**Keylogging**\n\n\n-----\n\nKeylogging is another popular technique used by cryware. Like other information-stealing\nmalware that use this technique, keylogging cryware typically runs in the background of an\naffected device and logs keystrokes entered by the user. It then sends the data it collects to an\nattacker controlled C2 server.\n\nFor attackers, keyloggers have the following advantages:\n\n**No need for brute forcing. Private keys, seed phrases, and other sensitive typed**\ndata can be stolen in plaintext.\n**Difficult to detect. Keyloggers can run undetected in the background of an affected**\ndevice, as they generally leave few indicators apart from their processes.\n**Stolen data can live in memory. Attackers don’t have to write stolen user data to**\ndisk. Instead, they can store the data in process memory before uploading it to the\nserver.\n\nEven users who store their private keys on pieces of paper are vulnerable to keyloggers.\nCopying and pasting sensitive data also don’t solve this problem, as some keyloggers also\ninclude screen capturing capabilities.\n\n**Phishing sites and fake applications**\n\nTo fool users into entering their private keys, attackers create malicious applications that\nspoof legitimate hot wallets. Unfortunately, determining which app is malicious or legitimate\ncan be challenging because importing an existing wallet does require the input of a private\nkey.\n\nSince a user needs to go to a hot wallet website to download the wallet app installer, attackers\ncould use one of the two kinds of methods to trick users into downloading malicious apps or\ngiving up their private keys:\n\n**Typosquatting: Attackers purchase domains that contain commonly mistyped**\ncharacters.\n**Soundsquatting: Attackers purchase domains with names that sound like legitimate**\nwebsites.\n\nThe screenshot below shows a spoofed MetaMask website. While the domain contains the\nword “MetaMask,” it has an additional one (“suspend”) at the beginning that users might not\nnotice. This could easily trick a user into entering their private keys to supposedly import\ntheir existing wallet, leading to the theft of their funds instead.\n\n\n-----\n\nFigure 8. Screenshot of a MetaMask phishing website\n\nPhishing websites may even land at the top of search engine results as sponsored ads. In\nFebruary 2022, we observed such ads for spoofed websites of the cryptocurrency platform\nStrongBlock. The topmost fake website’s domain appeared as “strongsblock” (with an\nadditional “s”) and had been related to phishing scams attempting to steal private keys. Note\nthat these ads no longer appear in the search results as of this writing. It’s common practice\nfor internet search engines (such as Google and Edge) to regularly review and remove ad\nresults that are found to be possible phishing attempts.\n\n\n-----\n\nFigure 9. Sponsored ads for phishing websites (highlighted in red boxes from a screenshot taken on\nFebruary 11, 2022) being pushed on top of browser search results, which can trick users into clicking them\n\nSome spoofed wallet websites also host fake wallet apps that trick users into installing them.\nFigure 10 shows an example of a fake wallet app that even mimics the icon of the legitimate\none. Like phishing websites, the fake apps’ goal is to trick users into providing sensitive\nwallet data.\n\n\n-----\n\nFigure 10. Fake wallet application installed on an Android device. While its icon has the same color of the\nbrand mascot as the legitimate app (left), its loading page displays a different mascot color instead (right).\n\nApart from credential-based phishing tactics in websites and apps, Microsoft security\nresearchers also noted a technique called “ice phishing,” which doesn’t involve stealing keys.\nRather, it attempts to trick users into signing a transaction that delegates approval of the\ntarget user’s tokens to an attacker. More information about ice phishing can be found in this\nblog.\n\n**Scams and other social engineering tactics**\n\nCryptocurrency-related scams typically attempt to lure victims into sending funds of their\nown volition. One such scam we’ve seen uses prominent social media personalities who\nseemingly endorse a particular platform. The scammers promise to “donate” funds to\nparticipants who send coins to a listed wallet address. Unfortunately, these promises are\nnever fulfilled.\n\n\n-----\n\nFigure 11. Prominent social media personalities inserted in scam-related promotional videos\n\nSocial media content creators are also becoming the targets of scam emails. The email\nmessages attempt to trick targets into downloading and executing cryware on their devices by\npurporting promotional offers and partnership contracts.\n\n\n-----\n\nFigure 12. Legitimate looking scam email prompting the user to download and execute a malicious file\n\nIn such cases, the downloaded or attached cryware masquerades as a document or a video\nfile using a double extension (for example, .txt.exe) and a spoofed icon. Thus, target users\nwho might be distracted by the message content might also forget to check if the downloaded\nfile is malicious or not.\n\n\n-----\n\nFigure 13. Executable screensaver (.scr) file masquerading as a Word document (.doc) file\n\n## Defending against cryware\n\n[Cryptocurrency crime has been reported to have reached an all-time high in 2021, with over](https://www.reuters.com/markets/us/cryptocurrency-crime-2021-hits-all-time-high-value-chainalysis-2022-01-06/)\nUSD10 billion worth of cryptocurrencies stored in wallets associated with ransomware and\ncryptocurrency theft. This shows that just as large cryptocurrency-related entities get\nattacked, individual consumers and investors are not spared.\n\nCryptocurrency trading can be an exciting and beneficial practice, but given the various\nattack surfaces cryware threats leverage, users and organizations must note the multiple\nways they can protect themselves and their wallets. They should have a security solution that\nprovides multiple layers of dynamic protection technologies—including machine learningbased protection.\n\n[Microsoft Defender Antivirus offers such protection. Its endpoint protection capabilities](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/microsoft-defender-antivirus-windows?view=o365-worldwide)\ndetect and block many cryware, cryptojackers, and other cryptocurrency-related threats.\n[Meanwhile, Microsoft Defender SmartScreen in Microsoft Edge and other web browsers that](https://docs.microsoft.com/deployedge/microsoft-edge-security-smartscreen)\nsupport it blocks phishing sites and prevents downloading of fake apps and other malware.\nSignals from these solutions, along with threat data from other domains, feed into Microsoft\n365 Defender, which provides organizations with comprehensive and coordinated threat\ndefense and is backed by a global network of security experts who monitor the continuously\nevolving threat landscape for new and emerging attacker tools and techniques.\n\nUsers and organizations can also take the following steps to defend against cryware and other\nhot wallet attacks:\n\n**Lock hot wallets when not actively trading. This feature in most wallet**\napplications can prevent attackers from creating transactions without the user’s\nknowledge.\n\n\n-----\n\n**Disconnect sites connected to the wallet. When a user isn t actively doing a**\ntransaction on a decentralized finance (DeFi) platform, a hot wallet’s disconnect feature\nensures that the website or app won’t interact with the user’s wallet without their\nknowledge.\n\nFigure 14. Some wallet apps allow users to disconnect from sites that they interacted with\n\n\n-----\n\n**Refrain from storing private keys in plaintext. Never store seed phrases on the**\ndevice or cloud storage services. Instead, write them down on paper (or something\nequivalent) and properly secure them.\n**Be attentive when copying and pasting information. When copying a wallet**\naddress for a transaction, double-check if the value of the address is indeed the one\nindicated on the wallet.\n**Ensure that browser sessions are terminated after every transaction. To**\nminimize the risk of cryware process dumpers, properly close or restart the browser’s\nprocessesafterimporting keys. This ensures that the private key doesn’t remain in the\nbrowser process’s memory.\n**Consider using wallets that implement multifactor authentication (MFA).**\nThis prevents attackers from logging into wallet applications without another layer of\nauthentication.\n**Be wary of links to wallet websites and applications. Phishing websites often**\nmake substantial efforts to appear legitimate, so users must be careful when clicking\nlinks in emails and messaging apps. Consider manually typing or searching for the\nwebsite instead and ensure that their domains are typed correctly to avoid phishing\nsites that leverage typosquatting and soundsquatting.\n**Double-check hot wallet transactions and approvals. Ensure that the contract**\nthat needs approval is indeed the one initiated.\n**Never share private keys or seed phrases. Under no circumstances will a third**\nparty or even the wallet app developers need these types of sensitive information.\n**Use a hardware wallet unless it needs to be actively connected to a device.**\nHardware wallets store private keys offline.\n**Reveal file extensions of downloaded and saved files. On Windows,turn on**\n**File Name Extensions under View on file explorer to see the actual extensions of**\nthe files on a device.\n\nLearn how you can stop attacks through automated, cross-domain security with Microsoft\n365 Defender.\n\n**_Berman Enconado and Laurie Kirk_**\n_Microsoft 365 Defender Research Team_\n\n## Appendix\n\n### Microsoft 365 Defender detections\n\n**Microsoft Defender Antivirus**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-17 - In hot pursuit of cryware Defending hot wallets from attacks.pdf"
    ],
    "report_names": [
        "2022-05-17 - In hot pursuit of cryware Defending hot wallets from attacks.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535596,
    "ts_updated_at": 1743041122,
    "ts_creation_date": 1653511123,
    "ts_modification_date": 1653511123,
    "files": {
        "pdf": "https://archive.orkl.eu/c2f41fafaee30c1f50947055f96965edd2868397.pdf",
        "text": "https://archive.orkl.eu/c2f41fafaee30c1f50947055f96965edd2868397.txt",
        "img": "https://archive.orkl.eu/c2f41fafaee30c1f50947055f96965edd2868397.jpg"
    }
}