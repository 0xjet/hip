{
    "id": "fc8c850f-7ddd-4557-8f66-d99b89f8c4bf",
    "created_at": "2023-01-12T15:02:40.898478Z",
    "updated_at": "2025-03-27T02:05:52.060003Z",
    "deleted_at": null,
    "sha1_hash": "7c6b5ea7d89bbb018af2356f3903a23f15df20bd",
    "title": "2022-01-13 - Unpacking Remcos malware",
    "authors": "",
    "file_creation_date": "2022-05-27T18:58:15Z",
    "file_modification_date": "2022-05-27T18:58:15Z",
    "file_size": 1363222,
    "plain_text": "# Unpacking Remcos malware\n\n**muha2xmad.github.io/unpacking/remcos/**\n\n### Muhammad Hasan Ali\n\nMalware Analysis learner\n\n1 minute read\n\n**As-salamu Alaykum**\n\n## Introducton\n\n\nJanuary 13, 2022\n\n\nRemcos is a RAT type malware that attackers use to perform actions on infected machines\nremotely. This malware is extremely actively caped up to date with updates coming out\n[almost every single month. 1](https://any.run/malware-trends/remcos)\n\nMD5: 5E9770C2B22B03E5726285900AFAB954\n\n## Static\n\nOpen the sample in `DiE we see that’s a` `.NET executable. It’s high` `Entropy then it’s`\npacked.\n\n## Unpacking process\n\n\n-----\n\nDrag the sample into `x32dbg and set BPs at` `VirtualAlloc,` `VirtualProtect,`\n```\nCreateProcessInternalW, IsDebuggerPresent . Then press F9 we to hit the first BP\n\n```\nwhich is `IsDebuggerPresent then` `Execute till return and change` `EAX to` `0 . Then`\nrun `F9 we hit` `VirtualAlloc and` `Execute tille return and dump` `EAX then check`\nthe dump. After many times hitting `VirtualAlloc BP we notice that it’s useless so disable`\n**this BP.**\n\nFigure(1):\n\nThen run `F9 to hit` `VirtualProtect BP Which is the same as` `VirtualAlloc` **Disable it**\n**too. Then press** `F9 to run and hit` `IsDebuggerPresent then` `Execute till return and`\nchange `EAX to` `0 . Then press` `F9 we get` `exception error ignore it and press` `F9 to`\nkeep going. We hit `CreateProcessInternalW BP. Because it’s injecting code into an`\nexisted or new process. In this case, it will inject a new child process.\n\nFigure(2):\n\n\n-----\n\nThen we set `WriteProcessMemory, and` `NtResumeThread BPs. Beacuase after injecting`\nthe process then resume the process from the suspended state. We will unpack it before\nresuming the process So we don’t need the last BP. Press `F9 to hit` `WriteProcessMemory`\nBP. We see the suspended process from `Process Hacker tool.`\n\nFigure(3):\n\nFrom the documantation of `WriteProcessMemory the 3rd parameter is` `buffer which`\nholds our unpacked file.\n\nFigure(4):\n\nThen we select from `MZ to the end of the dump section then` `right click =>` `Binary`\n=> `Save to a File . This our unpacked file.`\n\n## Article quote\n\nﻋﻠﻰ اﻟﻄﺮﯾﻖأﺿﺊ ﻣﺼﺒﺎﺣﻚ ﻟﺮُﺑﻤﺎ دل[ﱠ]\n\n## REF\n\n1- [https://any.run/malware-trends/remcos](https://any.run/malware-trends/remcos)\n\n2- [https://www.youtube.com/watch?v=DIH4SvKuktM&t=2s&ab_channel=OALabs](https://www.youtube.com/watch?v=DIH4SvKuktM&t=2s&ab_channel=OALabs)\n\n3- [WriteProcessMemory](https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-13 - Unpacking Remcos malware.pdf"
    ],
    "report_names": [
        "2022-01-13 - Unpacking Remcos malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535760,
    "ts_updated_at": 1743041152,
    "ts_creation_date": 1653677895,
    "ts_modification_date": 1653677895,
    "files": {
        "pdf": "https://archive.orkl.eu/7c6b5ea7d89bbb018af2356f3903a23f15df20bd.pdf",
        "text": "https://archive.orkl.eu/7c6b5ea7d89bbb018af2356f3903a23f15df20bd.txt",
        "img": "https://archive.orkl.eu/7c6b5ea7d89bbb018af2356f3903a23f15df20bd.jpg"
    }
}