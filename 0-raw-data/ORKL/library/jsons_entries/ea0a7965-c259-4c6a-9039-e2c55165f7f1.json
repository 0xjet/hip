{
    "id": "ea0a7965-c259-4c6a-9039-e2c55165f7f1",
    "created_at": "2023-01-12T15:03:02.674301Z",
    "updated_at": "2025-03-27T02:16:01.037256Z",
    "deleted_at": null,
    "sha1_hash": "c5170aa79f409844688f5898c91ef1950ba325b4",
    "title": "2021-06-24 - Crackonosh- A New Malware Distributed in Cracked Software",
    "authors": "",
    "file_creation_date": "2022-05-27T21:28:41Z",
    "file_modification_date": "2022-05-27T21:28:41Z",
    "file_size": 1308176,
    "plain_text": "# Crackonosh: A New Malware Distributed in Cracked Software\n\n**[decoded.avast.io/danielbenes/crackonosh-a-new-malware-distributed-in-cracked-software/](https://decoded.avast.io/danielbenes/crackonosh-a-new-malware-distributed-in-cracked-software/)**\n\nJune 24, 2021\n\nby [Daniel BenešJune 24, 202115 min read](https://decoded.avast.io/author/danielbenes/)\n\nWe recently became aware of customer reports advising that Avast antivirus was missing from their\n[systems – like the following example from Reddit.](https://www.reddit.com/r/Malware/comments/izwety/avast_folder_suddenly_empty/)\n\nFrom Reddit\nWe looked into this report and others like it and have found a new malware we’re calling\n[“Crackonosh” in part because of some possible indications that the malware author may be Czech.](https://en.wikipedia.org/wiki/R%C3%BCbezahl)\nCrackonosh is distributed along with illegal, cracked copies of popular software and searches for\nand disables many popular antivirus programs as part of its anti-detection and anti-forensics tactics.\n\nIn this posting we analyze Crackonosh. We look first at how Crackonosh is installed. In our analysis\nwe found that it drops three key files `winrmsrv.exe, winscomrssrv.dll` and winlogui.exe\nwhich we analyze below. We also include information on the steps it takes to disable Windows\n\n\n-----\n\nDefender and Windows Update as well as anti-detection and anti-forensics actions. We include\ninformation on how to remove Crackonosh. Finally, we include indicators of compromise for\nCrackonosh.\n\nNumber of hits since December 2020. In total over 222,000 unique devices.\n\nNumber of users infected by Crackonosh since December 2020. In May it is still about a thousand\nhits every day.\nThe main target of Crackonosh was the installation of the coinminer XMRig, from all the wallets we\nfound, there was one where we were able to find statistics. The pool sites showed payments of\n```\n9000 XMR in total, that is with today prices over $2,000,000 USD .\n\n```\n\n-----\n\nStatistics from xmrpool.eu\n\nStatistics from MoneroHash\n\n## Installation of Crackonosh\n\nThe diagram below depicts the entire Crackonosh installation process.\n\nDiagram of installation\n\n1. First, the victim runs the installer for the cracked software.\n2. The installer runs `maintenance.vbs`\n3. `Maintenance.vbs then starts the installation using` `serviceinstaller.msi`\n\n\n-----\n\n4. `Serviceinstaller.msi registers and runs` `serviceinstaller.exe, the main malware`\n\nexecutable.\n5. `Serviceintaller.exe drops` `StartupCheckLibrary.DLL .`\n6. `StartupCheckLibrary.DLL downloads and runs` `wksprtcli.dll .`\n7. `Wksprtcli.dll extracts newer` `winlogui.exe and drops` `winscomrssrv.dll and`\n```\n   winrmsrv.exe which it contains, decrypts and places in the folder.\n\n```\nFrom the original compilation date of Crackonosh we identified 30 different versions\nof `serviceinstaller.exe, the main malware executable, from 31.1.2018 up to 23.11.2020. It is`\neasy to find out that `serviceinstaller.exe is started from a registry key created by`\n```\nMaintenance.vbs .\n\n```\nThe only clue to what happened before the `Maintenance.vbs creates this registry key and how`\nthe files appear on the computer of the victim is the removal of `InstallWinSAT task in`\n```\nmaintenance.vbs . Hunting led us to uncover uninstallation logs containing Crackonosh\n\n```\nunpacking details when installed with cracked software.\n\nThe following strings were found in uninstallation logs:\n\n```\no{localappdata}\\Programs\\Common\n\n```\n```\n   /Create /SC ONLOGON /TN \"Microsoft\\Windows\\Maintenance\\InstallWinSAT\" /TR\n   Maintenance.vbs /RL HIGHEST /F\n   /Create /SC ONLOGON /TN \"Microsoft\\Windows\\Application\n   Experience\\StartupCheckLibrary\" /TR StartupCheck.vbs /RL HIGHEST /F\n\n```\nThis shows us that Crackonosh was packed in a password protected archive and unpacked in the\nprocess of installation. Here are infected installers we found:\n\n\n**Name of**\n**infected**\n**installer**\n\n**NBA**\n**2K19**\n\n**Grand**\n**Theft**\n**Auto V**\n\n\n**SHA256**\n\nE497EE189E16CAEF7C881C1C311D994AE75695C5087D09051BE59B0F0051A6CF\n\n65F39206FE7B706DED5D7A2DB74E900D4FAE539421C3167233139B5B5E125B8A\n\n\n**Far Cry 5** 4B01A9C1C7F0AF74AA1DA11F8BB3FC8ECC3719C2C6F4AD820B31108923AC7B71\n\n\n**The Sims**\n**4**\n**Seasons**\n\n\n7F836B445D979870172FA108A47BA953B0C02D2076CAC22A5953EB05A683EDD4\n\n\n-----\n\n**Euro**\n**Truck**\n**Simulator**\n**2**\n\n**The Sims**\n**4**\n\n**Jurassic**\n**World**\n**Evolution**\n\n**Fallout 4**\n**GOTY**\n\n**Call of**\n**Cthulhu**\n\n**Pro**\n**Evolution**\n**Soccer**\n**2018**\n\n**We**\n**Happy**\n**Few**\n\n\n93A3B50069C463B1158A9BB3A8E3EDF9767E8F412C1140903B9FE674D81E32F0\n\n9EC3DE9BB9462821B5D034D43A9A5DE0715FF741E0C171ADFD7697134B936FA3\n\nD8C092DE1BF9B355E9799105B146BAAB8C77C4449EAD2BDC4A5875769BB3FB8A\n\n6A3C8A3CA0376E295A2A9005DFBA0EB55D37D5B7BF8FCF108F4FFF7778F47584\n\nD7A9BF98ACA2913699B234219FF8FDAA0F635E5DD3754B23D03D5C3441D94BFB\n\n8C52E5CC07710BF7F8B51B075D9F25CD2ECE58FD11D2944C6AB9BF62B7FBFA05\n\nC6817D6AFECDB89485887C0EE2B7AC84E4180323284E53994EF70B89C77768E1\n\n\nInfected installers\n[The installer Inno Setup executes the following script. If it finds it’s “safe” to run malware, then](https://jrsoftware.org/isinfo.php)\ninstalls the Crackonosh malware to `%SystemRoot%\\system32\\ and one configuration file to`\n```\n%localappdata%\\Programs\\Common and creates in the Windows Task scheduler the tasks\nInstallWinSAT to start maintenance.vbs and StartupCheckLibrary to start\nStartupcheckLibrary.vbs . Otherwise it does nothing at all.\n\n## Reconstructed Crackonosh Inno Setup installer script\n\n```\n\n-----\n\nInstallation script\n\n\n-----\n\n## Analysis of Maintenance.vbs\n\nAs noted before, the Crackonosh installer registerers the `maintenance.vbs script with the`\nWindows Task Manager and sets it to run on system startup. The `Maintenance.vbs creates a`\ncounter, that counts system startups until it reaches the 7th or 10th system start, depending on the\nversion. After that the `Maintenance.vbs runs` `serviceinstaller.msi, disables hibernation`\nmode on the infected system and sets the system to boot to safe mode on the next restart. To cover\nits tracks it also deletes `serviceinstaller.msi and` `maintenance.vbs .`\n\nBelow is the `maintenance.vbs script:`\n\nMaintenance.vbs\n```\nServiceinstaller.msi does not manipulate any files on the system, it only modifies the registry\n\n```\nto register `serviceinstaller.exe, the main malware executable, as a service and allows it to`\nrun in safe mode. Below you can see the registry entries `serviceinstaller.msi makes.`\n\nMSI Viewer screenshot of serviceinstaller.msi\n\n\n-----\n\n## Using Safe Mode to Disable Windows Defender and Antivirus\n\nWhile the Windows system is in safe mode antivirus software doesn’t work. This can enable the\nmalicious `Serviceinstaller.exe to easily disable and delete Windows Defender. It also uses`\nWQL to query all antivirus software installed `SELECT * FROM AntiVirusProduct . If it finds any of`\nthe following antivirus products it deletes them with `rd <AV directory> /s /q command where`\n<AV directory> is the default directory name the specific antivirus product uses.\n\nAdaware\nBitdefender\nEscan\nF-secure\nKaspersky\nMcafee (scanner only)\nNorton\nPanda\n\nIt has names of folders, where they are installed and finally it deletes `%PUBLIC%\\Desktop\\ .`\n\nOlder versions of `serviceinstaller.exe used` `pathToSignedProductExe to obtain the`\ncontaining folder. This folder was then deleted. This way Crackonosh could delete older versions of\nAvast or current versions with Self-Defense turned off.\n\nIt also drops `StartupCheckLibrary.dll and` `winlogui.exe to` `%SystemRoot%\\system32\\`\nfolder.\n\nIn older versions of `serviceinstaller.exe it drops` `windfn.exe which is responsible for`\ndropping and executing `winlogui.exe .` `Winlogui.exe contains coinminer XMRig and in newer`\nversions the serviceinstaller drops winlogui and creates the following registry entry:\n\nThis connects the infected PC to the mining pool on every start.\n\n## Disabling Windows Defender and Windows Update\n\nIt deletes following registry entries to stop Windows Defender and turn off automatic updates.\n\n\n-----\n\ncommands executed by serviceinstaller.exe\nIn the place of Windows Defender it installs its own `MSASCuiL.exe which puts the icon of`\nWindows Security to the system tray.\n\nIt has the right icon\n\nDeleted Defender\n\n## Searching for Configuration Files\n\nLooking at `winrmsrv.exe`\n( aaf2770f78a3d3ec237ca14e0cb20f4a05273ead04169342ddb989431c537e83 ) behavior showed\nsomething interesting in its API calls. There were over a thousand calls of `FindFirstFileExW and`\n```\nFindNextFileExW . We looked at what file it was looking for, unfortunately the author of malware\n\n```\nhid the name of the file behind an SHA256 hash as shown below.\n\n\n-----\n\nIn this image, you see the function\n\n\n-----\n\nsearching for a file by hash of file name from winrmsrv.exe. Some nodes are grouped for better\nreadability.\nThis technique was used in other parts of Crackonosh, sometimes with SHA1.\n\nHere is a list of searched hashes and corresponding names and paths. In the case of\n```\nUserAccountControlSettingsDevice.dat the search is also done recursively in all subfolders.\n\n```\nin `CSIDL_SYSTEM`\n\nFile `7B296FC0-376B-497d-B013-58F4D9633A22-5P-1.B5841A4C-A289-439d-8115-`\n```\n      50AB69CD450\n\n```\nSHA1: `F3764EC8078B4524428A8FC8119946F8E8D99A27`\nSHA256:\n```\n         86CC68FBF440D4C61EEC18B08E817BB2C0C52B307E673AE3FFB91ED6E129B273\n\n```\nFile `7B296FC0-376B-497d-B013-58F4D9633A22-5P-1.B5841A4C-A289-439d-8115-`\n```\n      50AB69CD450B\n\n```\nSHA1: `1063489F4BDD043F72F1BED6FA03086AD1D1DE20`\nSHA256:\n```\n         1A57A37EB4CD23813A25C131F3C6872ED175ABB6F1525F2FE15CFF4C077D5DF7\n\n```\nSearched in `CSIDL_Profile and actual location is` `%localappdata%\\Programs\\Common`\n\nFile `UserAccountControlSettingsDevice.dat`\n\nSHA1: `B53B0887B5FD97E3247D7D88D4369BFC449585C5`\nSHA256:\n\n```\n7BB5328FB53B5CD59046580C3756F736688CD298FE8846169F3C75F3526D3DA5\n\n```\n\nThese files contain configuration information encrypted with xor cipher with the keys in\nexecutables.\n\nAfter decryption we found names of other parts of malware, some URLs, RSA public keys,\ncommunication keys for `winrmsrv.exe and commands for XMRig. RSA keys are 8192 and 8912`\nbits long. These keys are used to verify every file downloaded by Crackonosh (via\n```\nStartupCheckLibrary.dll, winrmsrv.exe, winscomrssrv.dll ).\n\n```\nHere we found the first remark of `wksprtcli.dll .`\n\n## StartupCheckLibrary.dll and Download of wksprtcli.dll\n```\nStartupCheckLibrary.dll is the way how the author of Crackonosh can download updates of\n\n```\nCrackonosh on infected machines. `Startupchecklibrary.dll queries TXT DNS records for`\ndomains `first[.]universalwebsolutions[.]info and`\n```\nsecond[.]universalwebsolutions[.]info (or other TLDs like\ngetnewupdatesdownload[.]net and webpublicservices[.]org ). There are TXT DNS\n\n```\nrecords like `ajdbficadbbfC@@@FEpHw7Hn33 . From the first twelve letters it computes the IP`\naddress as shown on image. Next five characters are the digits of the port encrypted by adding 16.\nThis gives us a socket, where to download wksprtcli.dll. The last eight characters are the version.\nDownloaded data is validated against one of the Public keys stored in the config file.\n\n\n-----\n\nDecryption of IP address, screenshot from Ida\n```\nWksprtcli.dll (exports DllGetClassObjectMain ) is updating older versions of Crackonosh.\n\n```\nThe oldest version of `wksprtcli.dll that we found checks only the nonexistence of`\n```\nwinlogui.exe . Then it deletes diskdriver.exe (previous coinminer) and autostart registry\n\n```\nentry. The newest version has a time frame when it runs. It deletes older versions of\n```\nwinlogui.exe or diskdriver.exe and drops new version of winlogui.exe . It drops new\n\n```\nconfig files and installs `winrmsrv.exe and` `winscomrssrv.dll . It also changed the way of`\nstarting `winlogui.exe from registry`\n```\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run to a task scheduled on user login.\n\n```\nTasks created in Windows task scheduler by wksprtcli.dll\nIn the end it disallows hibernation and Windows Defender.\n```\nWksprtcli.dll also checks computer time. The reason may be not to overwrite newer versions\n\n```\nand to make dynamic analysis harder. It also has written date after which it to stop winlogui task to\nbe able to replace files.\n\n\n**File**\n\n**(time of**\n**compilation)**\n\n**5C8B… (2020-11-**\n**20)**\n\n**D9EE… (2019-11-**\n**24)**\n\n\n**Timestamp 1**\n\n**(after this it kills winlogui task, so it can update**\n**it)**\n\n\n**Timestamp 2**\n\n**(before this it**\n**runs)**\n\n\n2019-12-01 2023-12-30\n\n2019-12-01 2020-12-06\n\n\n**194A… (2019-11-24)** 2019-03-09 –\n\n**FA87… (2019-03-22)** Uses winlogui size instead 2019-11-02\n\n**C234… (2019-02-24)** 2019-03-09 2019-11-02\n\n\n**A2D0… (2018-12-**\n**27)**\n\n**D3DD… (2018-10-**\n**13)**\n\n\n– –\n\n– –\n\n\n[Hardcoded timestamps, full file hashes are in IoCs](https://github.com/avast/ioc/tree/master/Crackonosh#wksprtclidll)\n\n## Analysis of Winrmsrv.exe\n\n\n-----\n\n```\nWinrmsrv.exe is responsible for P2P connection of infected machines. It exchanges version info\n\n```\nand it is able to download newer versions of Crackonosh. We didn’t find any evidence of versions\nhigher than 0 and therefore we don’t know what files are transferred.\n```\nWinrmsrv.exe searches for internet connection. If it succeeds it derives three different ports in the\n\n```\nfollowing ways.\n\nFirst, in the config file, there is offset (49863) and range (33575) defined. For every port there is\n[computed SHA-256 from date (days from Unix Epoch time) and 10 B from config file. Every port is](https://en.wikipedia.org/wiki/Unix_time)\nthen set as offset plus the first word of SHA moduled by range (offset + (2 B of SHA % range)).\n\nFirst two ports are used for incoming TCP connections. The last one is used to listen to an incoming\nUDP.\n\n\n-----\n\nObtain ports, screenshot from IDA\nNext, `winrmsrv.exe starts sending UDP packets containing version and timestamp to random IP`\naddresses to the third port (approximately 10 IP’s per second). Packet is prolonged with random\nbytes (to random length) and encrypted with a Vigenère cipher.\n\n\n-----\n\nUDP packet\nFinally, if `winrmsrv.exe finds an IP address infected with Crackonosh, it stores the IP, control`\nversion and starts updating the older one with the newer one. The update data is signed with the\nprivate key. On the next start winrmsrv.exe connects all stored IP’s to check the version before\ntrying new ones. It blocks all IP addresses after the communication. It blocks them for 4 hours\nunless they didn’t follow the protocol, then the block is permanent (until restart).\n\nWe have modified masscan to check this protocol. It showed about 370 infected IP addresses over\nthe internet (IPv4).\n\n\nA UDP\nHello\n\n\nB\n\n\nSends UDP Packet from random port to port\n3\n\n\n-> decrypt, check timestamp (in last 15 s)\nand if the version match ban IP\naddress for next 4 hr\n\n\n-----\n\ndecrypt, check timestampsame version: do\nnothingB has lower version: TCP send B has\nhigher version: TCP receive\n\n\n<- Sends UDP Crackonosh Hello Packet\nto port of A\n\n\nA TCP\nSend\n\n\nB\n\n\nConnect to port 2 -> Search if the communication from A is\nexpected (Successful UDP Hello in last\n5 seconds with different versions)\n\nsend encrypted packet -> decode data, validate, save\n\n\nA TCP\nReceive\n\n\nB\n\n\nConnect to port 1 -> Search if the communication from A is\nexpected (Successful UDP Hello in last\n5 seconds with different versions)\n\ndecode data, validate, save <- send encrypted packet\n\nCommunication diagram\n\nEncryption scheme of the UDP Packet\n\n\n-----\n\nEncryption scheme of the TCP Packet\nIt’s notable that here is a mistake in TCP encryption/decryption implementation shown above.\nInstead of the red arrow there is computed one more SHA256, that should be used in the xor with\nthe initialization vector. But then there is the source of the SHA used instead of the result.\n\n## Analysis of winscomrssrv.dll\n\nIt is preparation for the next phase. It uses the TXT DNS records the same way as\n```\nStratupCheckLibrary.dll . It tries to decode txt records on URL’s:\n\n```\n\n-----\n\n```\nlef[.]loadtubevideos[.]com\n\n```\n\nIt seems, that these files are not yet in the wild, but we know what the names of files should be\n```\nC:\\WINDOWS\\System32\\wrsrvrcomd0.dll, C:\\WINDOWS\\System32\\winupdtemp_0.dat and\nC:\\WINDOWS\\System32\\winuptddm0 .\n\n## Anti-Detection and Anti-Forensics\n\n```\nAs noted before, Crackonosh takes specific actions to evade security software and analysis.\n\nSpecific actions it takes to evade and disable security software includes:\n\nDeleting antivirus software in safe mode\nStopping Windows Update\n\n\n-----\n\nReplacing Windows Security with green tick system tray icon\nUsing libraries that don’t use the usual `DllMain that is used when running library as the`\nmain executable (by `rundll32.exe ) but instead are started with some other exported`\nfunctions.\nServiceinstaller tests if it is running in Safe mode\n\nTo protect against analysis, it takes the following actions to test to determine if it’s running in a VM:\n\nChecks registry keys:\n```\n      SOFTWARE\\VMware, Inc\n      SOFTWARE\\Microsoft\\Virtual Machine\\Guest\\Parameters\n      SOFTWARE\\Oracle\\VirtualBox Guest Additions\n\n```\nTest if computer time is in some reasonable interval e.g. after creation of malware and before\n2023 ( wksprtcli.dll )\n\nAlso, as noted it delays running to better hide itself. We found the specific installers used hard\ncoded dates and times for its delay as shown below.\n\n**SHA of installer** **Installer**\n**doesn’t**\n**run**\n**before**\n\n9EC3DE9BB9462821B5D034D43A9A5DE0715FF741E0C171ADFD7697134B936FA3 201806-10\n13:08:20\n\n8C52E5CC07710BF7F8B51B075D9F25CD2ECE58FD11D2944C6AB9BF62B7FBFA05 201806-19\n14:06:37\n\n93A3B50069C463B1158A9BB3A8E3EDF9767E8F412C1140903B9FE674D81E32F0 201807-04\n17:33:20\n\n6A3C8A3CA0376E295A2A9005DFBA0EB55D37D5B7BF8FCF108F4FFF7778F47584 201807-10\n15:35:57\n\n4B01A9C1C7F0AF74AA1DA11F8BB3FC8ECC3719C2C6F4AD820B31108923AC7B71 201807-25\n13:56:35\n\n65F39206FE7B706DED5D7A2DB74E900D4FAE539421C3167233139B5B5E125B8A 201808-03\n15:50:40\n\nC6817D6AFECDB89485887C0EE2B7AC84E4180323284E53994EF70B89C77768E1 201808-14\n12:36:30\n\n\n-----\n\n7F836B445D979870172FA108A47BA953B0C02D2076CAC22A5953EB05A683EDD4 201809-13\n12:29:50\n\nD8C092DE1BF9B355E9799105B146BAAB8C77C4449EAD2BDC4A5875769BB3FB8A 201810-01\n13:52:22\n\nE497EE189E16CAEF7C881C1C311D994AE75695C5087D09051BE59B0F0051A6CF 201810-19\n14:15:35\n\nD7A9BF98ACA2913699B234219FF8FDAA0F635E5DD3754B23D03D5C3441D94BFB 2018-1107\n12:47:30\n\nHardcoded timestamps in installers\nWe also found a version, `Winrmsrv.exe`\n( 5B85CEB558BAADED794E4DB8B8279E2AC42405896B143A63F8A334E6C6BBA3FB ), that instead\ndecrypts time that is hard-coded in config file (for example in\n```\n5AB27EAB926755620C948E7F7A1FDC957C657AEB285F449A4A32EF8B1ADD92AC ) is 2020-02-03. If\n\n```\ncurrent system time is lower than the extracted value, `winrmsrv.exe doesn’t run.`\n\nIt also takes specific actions to hide itself from possible power users who use tools that could\ndisclose its presence.\n\nIt uses Windows-like names and descriptions such as `winlogui.exe which is the Windows Logon`\nGUI Application.\n\nIt also checks running processes and compares it to the blocklist below. If it finds process with\nspecified name `winrmsrv.exe and` `winlogui.exe terminate itself and wait until the next start of`\nPC.\n\n\n-----\n\nBlocklist:\n\ndumpcap.exe\nfiddler.exe\nfrst.exe\nfrst64.exe\nfse2.exe\nmbar.exe\nmessageanalyzer.exe\nnetmon.exe\nnetworkminer.exe\nollydbg.exe\nprocdump.exe\nprocdump64.exe\nprocexp.exe\nprocexp64.exe\nprocmon.exe\nprocmon64.exe\nrawshark.exe\nrootkitremover.exe\nsdscan.exe\nsdwelcome.exe\nsplunk.exe\nsplunkd.exe\nspyhunter4.exe\ntaskmgr.exe\ntshark.exe\nwindbg.exe\nwireshark-gtk.exe\nwireshark.exe\nx32dbg.exe\nx64dbg.exe\nX96dbg.exe\n\n## Additional files\n\nAs well as previously discussed, our research found additional files:\n```\n   Startupcheck.vbs : a one time script to create a Windows Task Scheduler task for\n   StartUpCheckLibrary.dll .\n   Winlogui.dat, wslogon???.dat : temporary files to be moved as new winlogui.exe .\n   Perfdish001.dat : a list of infected IP addresses winrmsrv.exe found.\n   Install.msi and Install.vbs : these are in some versions a step between\n   maintenance.vbs and serviceinstaller.msi, containing commands that are otherwise\n\n```\nin `maintenance.vbs .`\n\n## Removal of Crackonosh\n\n\n-----\n\nBased on our analysis, the following steps are required to fully remove Crackonosh.\n\nDelete the following Scheduled Tasks (Task Schedulers)\n```\n   Microsoft\\Windows\\Maintenance\\InstallWinSAT\n   Microsoft\\Windows\\Application Experience\\StartupCheckLibrary\n   Microsoft\\Windows\\WDI\\SrvHost\\\n   Microsoft\\Windows\\Wininet\\Winlogui\\\n   Microsoft\\Windows\\Windows Error Reporting\\winrmsrv\\\n\n```\nDelete the following files from `c:\\Windows\\system32\\`\n\n```\n7B296FC0-376B-497d-B013-58F4D9633A22-5P-1.B5841A4C-A289-439d-8115\n```\n```\n50AB69CD450\n\n```\n```\n7B296FC0-376B-497d-B013-58F4D9633A22-5P-1.B5841A4C-A289-439d-8115\n```\n```\n50AB69CD450B\n\n```\n\nDelete the following file from `C:\\Documents and Settings\\All Users\\Local`\n```\nSettings\\Application Data\\Programs\\Common ( %localappdata%\\Programs\\Common )\n\n```\n```\nUserAccountControlSettingsDevice.dat\n\n```\n\nDelete the following file from `C:\\Program Files\\Windows Defender\\`\n\n```\nMSASCuiL.exe\n\n```\n\nDelete the following Windows registry keys (using `regedit.exe )`\n```\n   HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender value DisableAntiSpyware\n   HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection value\n   DisableBehaviorMonitoring\n   HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection value\n   DisableOnAccessProtection\n   HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection value\n   DisableScanOnRealtimeEnable\n   HKLM\\SOFTWARE\\Microsoft\\Security Center value AntiVirusDisableNotify\n   HKLM\\SOFTWARE\\Microsoft\\Security Center value FirewallDisableNotify\n   HKLM\\SOFTWARE\\Microsoft\\Security Center value UpdatesDisableNotify\n\n```\n\n-----\n\n```\n   HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer value\n   HideSCAHealth\n   HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Reporting value\n   DisableEnhancedNotifications\n   HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run value winlogui\n\n```\nRestore the following default Windows services (Note: depends on your OS version – see\n[https://www.tenforums.com/tutorials/57567-restore-default-services-windows-10-a.html)](https://www.tenforums.com/tutorials/57567-restore-default-services-windows-10-a.html)\n\nwuauserv\nSecurityHealthService\nWinDefend\nSense\nMsMpSvc\n\nReinstall Windows Defender and any third-party security software, if any was installed.\n\n## Error messages\n\nOn infected machines, sometimes the following error messages about the file `Maintenance.vbs`\ncan appear.\n\nType Mismatch: ‘CInt’, Code: 800A000D\n\nCan not find script file\n\nBoth of these are bugs in the Crackonosh installation.\n\n[Although there are some guides on the internet on how to resolve these errors,](https://www.google.com/search?q=%22maintenance.vbs%22+fix) `instead` we\nrecommend following the steps in the previous chapter to be sure you fully remove all traces of\nCrackonosh.\n\n## Conclusion\n\nCrackonosh installs itself by replacing critical Windows system files and abusing the Windows Safe\nmode to impair system defenses.\n\n\n-----\n\nThis malware further protects itself by disabling security software, operating system updates and\nemploys other anti-analysis techniques to prevent discovery, making it very difficult to detect and\nremove.\n\nIn summary, Crackonosh shows the risks in downloading cracked software and demonstrates that it\nis highly profitable for attackers. Crackonosh has been circulating since at least `June 2018 and`\nhas yielded over `$2,000,000 USD for its authors in Monero from over` `222,000 infected`\n```\nsystems worldwide.\n\n```\nAs long as people continue to download cracked software, attacks like these will continue to be\nprofitable for attackers. The key take-away from this is that you really can’t get something for\nnothing and when you try to steal software, odds are someone is trying to steal from you.\n\n## Indicators of Compromise (IoCs)\n\nThe full list of IoCs: [Avast IoC repository](https://github.com/avast/ioc/tree/master/Crackonosh)\n[The list of URLs obtaining TXT DNS records: network.txt](https://github.com/avast/ioc/blob/master/Crackonosh/network.txt)\nThe list of common file names: [filenames.txt](https://github.com/avast/ioc/blob/master/Crackonosh/filenames.txt)\n\n## Public keys\n\n—–BEGIN PUBLIC KEY—–\nMIIEIjANBgkqhkiG9w0BAQEFAAOCBA8AMIIECgKCBAEA0m9mblXlLhgH/d5WgDw0\n2nzOynQvKdkobluX5zFK6ewVkX+3W6Vv2v4CqJ473ti9798Jt9jkDpfEL1yMUDfp\nLp1p4XGVSrTrD16J0Guxx0yzIjyReAzJ8Kazej1z/XGGOtAMZCoLI+TrE4me3SjL\n+EXk3pXqyupAgKFiNrlXRj7hbb5vXkeB0MpbV3yJ0ha1OJdAIAwGzQTUsvDWDw00\n4sxLfso6CLzR1CKJEH2wT6RVfalnGg6IBwb/fvGewGYECAfnPtEt8TwvzuLsw6NY\nBD+tDNcFQk0ZRIAZ+zO5mY4cuWTTBZbAjEFFo5UX4ognHDElltgh+76rXDvtXmeZ\nivDOgJSBXr2+TkQ9dMfYMYLxKHoe8WRBYlI6Wkl59+HQQdQFgSGK6tFtY0T3TVwR\nZxQE1LYwe+0lF1Cop8U/jqRotudKcS+Hyiu0yoSv34C3QwW4ELQktCX5313gcNF/\nRA98knE1tl9F3Pl6vnvm1ILb6cxihYy5F0rdLteRNezrjcXOKGA9BV4QTebxH/mi\nmm6z4BtTBPNKvrtqo25qx5Oa0fOnVvHAaVtXNjzCNapZwucHH/V8jJzIwcv2ZUP4\nHx9Hkpm5u/3payfDPkWHFwxh3qfDDr2jzgwDjRSOgO1GHGuL1HoIxSgxWFOf6F2z\ncaOwDrcycDbWiIMeZedJQI1XTrCPoFL4YoyPY2at9tAYW+6Z3gvnvbhen803N2/k\n0TWEUU1hUfhOn45IC5r3pCC8Ouy7FIblz1wGm8Qfa8uSD3hxPhaev1G2JJpN4ZVN\nUEfeVH6rVcsbQmKoB0xgmcn5Qnq4WoRGtTd1Z4bbC2Zl2q4jqDAutxWdtmEahmcN\nOZoTpAjfN96eQReDYLHYkY9SmdjmclnXGo6SP2VHdlm+Xf5DU7E+0c1WNNb2fGN8\n+XY29XLuesCppPyeCejMEgIIfIm6A0ltRtwdRHzqgLaY3o6Q6KTvMCQY2zEwKvx8\nh1u5CLNpJ0yajbvaO41g4uKBtAPL+N9knsfnIqwG1r7emocrUbj3Nou9mPvtTVHr\nr6ZRCmXbdhXTFL6ztLEGYt4wYwvJfKXlgk+3LFECffw0LpjUXEJVtzb//eI4rEyq\nJ99exvMzQJ5ELLwpRT/Ehq4D7ngc5V/LGQvGNG5MUnzjDF5Ja5W56HcYRVCj8+CV\njHzOUMx1Ojzeb9L87dS+neATWLr+26kMBALr7lEi37483oLQcD5W4bKspQmMdOJb\nED8MEVTd1V6/lTfcBRiHmEdHazV6OnxZsriXQ6MQtnS5WYKjaCwnv2QfUAtfspeO\ntGeIalZIdY/MpABHnmhOQZc5rRXrsEU028zmD52OXTXVfnklhhZjHm9QOX6D4fM3\nkQIDAQAB\n—–END PUBLIC KEY—–\n—–BEGIN PUBLIC KEY—–\n\n\n-----\n\nMIIEfDANBgkqhkiG9w0BAQEFAAOCBGkAMIIEZAKCBFsAuwkH5cn5zS75ZQpdViD/\nL5gUpjnJXJL1rWB0toEICF58mkjpR8DGR+Nl3IXgyjSdKprFUU7pVhO5kmlgiId/\nVqbBQZdwKaLxi4oeg4zzVQ7ACwanU1eYqOCNoAsrdcuWkytnPUcLRC3VtE5POp1n\nskiPiKNt4aWvzXw61+o+ROEQhKcsYaB3Xu34X1HPxI1HSFhPLxuj20Gfiu3Aol3r\nmGdxLWa/sVbkYzyinocrVRl09+Tys0JYq1hc+q6ZR3fN1wOqOQm7dlksmPLDAhIi\n9AFyKPrdiLc30kpMP3dpZT/IilkRebcrlufiDgXpAij2t6zzHC5cjn4eCOV80kzJ\nqgw8oMAww0K2jvhwTWlRkvvAWtkbHUL9VRX69NFAJOuAPsHNv7ScWiy4EW4KxlFd\nzR0B6hzsOc/bo0ns5ffrtOFPao1yW7h4BqE8AYpENwKmygQCh+e211Gd0ABD4131\nnNYuZokyYXLLEuzwEjzJlw0bKbwn6suVPA8WAa53iy43/5LWQFfWB3AK8qolJ6ck\nvyNLJiMtMa1Q+K3pcRndfQpLMsI19ZZyz67Rh0T+QqDt2XQ5gT4gnmPlc2wB3Y7X\n2XoZHQZ8FRgYxhS2Szurmn/70NeZEq6p4Zr+yj0FqEjNvR1ooUz5pwJ6iJSmXRtN\nifaBHKhmc4l5ZIUOUkhtsQ1bmsII092gtLPrLkU7hC1hG9vSzUEh6myLs/pqIKTj\nx+s+tHqF34XuvNMJOAcv7dXIiQ0QqfG1bFFP6WItwNyeRRGVIkik6GZuAe3lXV5d\nbcKr+ID6pZBeI+yN6y+ugX900WZHKZCfSWvAEQDDZW7TCe0sBQpq083B1GVQOg9t\n3MM43PqdYrVgH0fRYa6YJ0SrvhFEIjaevszmOYo+eE5P3GHuL4ty45LrkE91qTWk\nfYexEQ0QhCsmBFCu+oX/EI6NpAm636zoc9qPZScZBgIAStYCJJt6pIzDr3tq0BFR\noA3CklsFrKloDgx3rBZgNJk4lpWd9kihNRq7EzI8Y/YbAA0SlgkfXj6/4s0B0ODi\n2xirUJzhzQnJuvXFdirwoRpHglMtIOhmfy0fMnvorDbmxGyMVM4n44nGLLrqaZj1\n+8QWi9PixPNWgznPBeQaT7q78IPooWn9H/efJ2Rb602iW8H9NSbp/Mt2+Qa4O2Cg\nATymvrRG6oyCgNF5L1fUpGQNQpD3PzSyrTdyjEIabjPpPD+doXPq3y+sEYvWVwDc\n96SwVSB7oZ3Bj4/tW7IJ4FhPzXcrBl0RsdURHHhJsHPHSQH6QRtebKcc+3TemhN5\nCcXjHmETcB0a0FJ6DXNm4iQZx+t/q8F0ZYnBGhR7aAYu5wl5ofJxGFTQkc5KisYh\nB6XogfPM7GT5Zw2B7omiXiGHKALXerzQP831+gL8Zso6ZIWGM3F+PJqQarfn0wnT\nxQ264rjtnSKnSkfaDRGxpBYyMDF3CxMPHYsmv7K5lF4be5ASK64VexloUQIDAQAB\n—–END PUBLIC KEY—–\n\n[Tagged asbackdoor,](https://decoded.avast.io/tag/backdoor/) [cryptomining,](https://decoded.avast.io/tag/cryptomining/) [malware](https://decoded.avast.io/tag/malware/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-24 - Crackonosh- A New Malware Distributed in Cracked Software.pdf"
    ],
    "report_names": [
        "2021-06-24 - Crackonosh- A New Malware Distributed in Cracked Software.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535782,
    "ts_updated_at": 1743041761,
    "ts_creation_date": 1653686921,
    "ts_modification_date": 1653686921,
    "files": {
        "pdf": "https://archive.orkl.eu/c5170aa79f409844688f5898c91ef1950ba325b4.pdf",
        "text": "https://archive.orkl.eu/c5170aa79f409844688f5898c91ef1950ba325b4.txt",
        "img": "https://archive.orkl.eu/c5170aa79f409844688f5898c91ef1950ba325b4.jpg"
    }
}