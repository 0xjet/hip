{
    "id": "db83dae5-a7c1-4d5a-87cb-17e56c64dded",
    "created_at": "2022-10-25T16:48:24.372706Z",
    "updated_at": "2025-03-27T02:17:23.180396Z",
    "deleted_at": null,
    "sha1_hash": "cf1750865234a5840d529a498a5fa1107d79fe64",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-11-21T01:48:51Z",
    "file_modification_date": "2019-11-21T01:48:51Z",
    "file_size": 916458,
    "plain_text": "[Trend Micro](https://www.trendmicro.com/)\n[About TrendLabs Security Intelligence Blog](https://blog.trendmicro.com/trendlabs-security-intelligence/about-us/)\n\n# Mac Backdoor Linked to Lazarus Targets Korean Users\n\n[Posted on:November 20, 2019 at 4:41 am](https://blog.trendmicro.com/trendlabs-security-intelligence/2019/11/)\n[Posted in:Malware, Targeted Attacks](https://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/)\nAuthor:\n[Trend Micro](https://blog.trendmicro.com/trendlabs-security-intelligence/author/trend-micro/)\n\n0\n\n**_By Gabrielle Joyce Mabutas_**\n\nCriminal interest in MacOS continues to grow, with malware authors churning out [more threats that target](https://blog.trendmicro.com/trendlabs-security-intelligence/mac-malware-that-spoofs-trading-app-steals-user-information-uploads-it-to-website/)\nusers of the popular OS. Case in point: A new variant of a Mac backdoor (detected by Trend Micro as\nBackdoor.MacOS.NUKESPED.A) attributed to the cybercriminal group Lazarus, which was observed\ntargeting Korean users with a macro-embedded Microsoft Excel spreadsheet.\n\n**Similarities to an earlier Lazarus iteration**\n\nWe analyzed a malicious sample first [discovered by Twitter user cyberwar_15, and found that it used an](https://twitter.com/cyberwar_15/status/1186612111717191680)\nExcel document with an embedded macro, which is similar to a [previous attack by the Lazarus group.](https://www.sentinelone.com/blog/lazarus-apt-targets-mac-users-poisoned-word-document/)\n\nFigure 1. The spreadsheet displays a fairly known psychological test (similar to one found [here); clicking on](http://webcache.googleusercontent.com/search?q=cache:http://m.blog.naver.com/wonderwallsoft/220795786443)\n\nthe smiley image on the top left shows a different response depending on the user’s answer.\n\n\n-----\n\nrunning on, the macro in this file will just run a PowerShell script that connects to three C&C servers set up\nby the group:\n\nFigure 2. The macro file connects to hxxps[:]//crabbedly[.]club/board[.]php,\nhxxps[:]//craypot[.]live/board[.]php, and hxxps[:]//indagator[.]club/board[.]php.\n\nFigure 3. Comparison of [SentinelOne’s code snippet of the malicious macro used in the abovementioned](https://www.sentinelone.com/blog/lazarus-apt-targets-mac-users-poisoned-word-document/)\nprevious attack (left) and the code snippet of the recently discovered one (right). The latter shows that it no\nlonger performs any specific action if it runs on a Mac platform. The “#If Mac Then” MacOS-specific attack\n\ndoes not start with malicious macros this time.\n\n**Mac app bundle contains malicious and legitimate Flash Players**\n\nApart from the analyzed sample, @cyberwar_15, as well as [Qianxin Technology, were also able to source an](https://twitter.com/RedDrip7/status/1186562944311517184)\nin-the-wild Mac app bundle suspected to be involved in the attack since it shares similar C&C servers with\nthe malicious spreadsheets.\n\n\n-----\n\nFigure 4. Mac app bundle inside a sample found in the wild\n\nHowever, this is only a decoy since the actual Adobe Flash Player is contained as a hidden Mach-O file. The\nbundle contains two Flash Player files: a legitimate version and a malicious version\n(Trojan.MacOS.NUKESPED.B). The app will run the smaller-sized Flash Player as its main executable,\nwhich is the malicious version that only poses as a “Flash Player” by name. It also runs the legitimate Flash\nPlayer to hide its actual malicious routine.\n\nFigure 5. The bundle contains two Flash Player files — one legitimate version and one malicious version.\n\n\n-----\n\nFigure 6. A closer look at the bundle revealed that this Flash Player app was developed by someone named\n\nOleg Krasilnikov, who has no relation to Adobe Inc.\n\nWhen running the Mac app, the malicious Flash Player will run the legitimate one to play a decoy SWF\nvideo.\n\nFigure 7. The SWF video, which plays a Korean song in the background, shows a collection of pictures.\n\nOur own analysis of the sample revealed that while the video is playing, the malicious Flash Player creates\nanother hidden file (Backdoor.MacOS.NUKESPED.A) in the following path: ~/.FlashUpdateCheck.\n\n\n-----\n\nFigure 8. The malicious Flash Player creates a hidden file at ~/.FlashUpdateCheck while the legitimate Flash\n\nPlayer plays a video. Note: The symbol (~) is equivalent to the path of the current user.\n\nSubsequently, a persistence mechanism for this hidden file is installed through dropped PLIST file\n_~/Library/Launchagents/com.adobe.macromedia.plist._\n\nFigure 9. Code snippet of ~/Library/Launchagents/com.adobe.macromedia.plist being dropped. The hidden\n\nfile ~/.FlashUpdateCheck is set as its autorun target.\n\nFurther inspection shows that the hidden file ~/.FlashUpdateCheck acts as the dropped Powershell scriptequivalent of the Macro-embedded document. We have identified functions related to its C&C\ncommunication with the following servers:\n\nFigure 10. Listed C&C servers located in the _DATA segment of the hidden file\n\n**The variant’s backdoor functions**\n\nTo trigger the backdoor functions of Backdoor.MacOS.NUKESPED.A, it must first try to establish a\nconnection with the abovementioned servers, craypot[.]live being the first in order. Upon successful\nconnection, it would continue to its actual backdoor routine.\n\n\n-----\n\nFigure 11. In this routine, the file would evaluate the server’s response and perform specific functions based\n\non the received command number.\n\nFigure 12. Disassembled pseudocode for backdoor functions 11, 12, and 14\n\n\n-----\n\nFigure 13. Disassembled pseudocode for backdoor functions 18, 19, 20, 21, 24, and 25\n\n**Switch case backdoor**\n**Function**\n**command**\n\n2 Set Sleep\n\n3 Terminate Process\n\n11 Get Host Information\n\nCheck Current Backdoor\n12, 14\nConfiguration\n\nUpdate C2 and Backdoor\n15\nConfiguration\n\n18, 19 Execute Shell command\n\n20 Upload File\n\n21 Download File\n\n24, 25 Execute Response Directly\n\nTable 1. The complete backdoor functions of Backdoor.MacOS.NUKESPED.A\n\n\n-----\n\nFigure 14. The MacOS hidden file has backdoor functions that are similar to those of the executed hidden\nPowerShell script in the Excel spreadsheet sample (for example, the command 11 for both is the GetHostInfo\n\nfunction).\n\n**Conclusion**\n\nUnlike Lazarus’ earlier method, which used macros to download a backdoor Mac file, the samples we\nanalyzed reveal that this attack type uses an app with a decoy while running the malicious routine to separate\nthe entire Mac attack chain.\n\nCybercriminal groups such as Lazarus are expanding their scope of attack through different platforms. The\nLazarus group’s shift from using a single cross-platform method for starting an attack chain to a more OSspecific crafted variant is something to take note of — and something we should expect on future related\ncases.\n\n**Security recommendations**\n\nTo avoid attacks involving Backdoor.MacOS.NUKESPED.A, users should only download apps from official\nsources. This simple practice minimizes the chances of downloading a malicious app. Users can also benefit\nfrom security solutions such as [Trend Micro Home Security for Mac, which provides comprehensive security](https://www.trendmicro.com/en_ca/forHome/products/maximum-security.html)\nand multi-device protection against cyberthreats.\n\nEnterprises, for their part, should take advantage of Trend Micro’s [Smart Protection Suites with XGen™](https://www.trendmicro.com/en_us/business/products/user-protection/sps.html)\nsecurity, which infuses high-fidelity [machine learning into a blend of threat protection techniques to eliminate](https://www.trendmicro.com/vinfo/us/security/definition/machine-learning)\nsecurity gaps across any user activity or endpoint.\n\n**Indicators of Compromise (IoCs)**\n\nFiles SHA256s Detection Names\n\n\nd91c233b2f1177357387c29d92bd3f29fab7b90760e59a893a0f4\nAlbum.app\n47ef2cb4715\n\n735365ef9aa6cca946cfef9a4b85f68e7f9f03011da0cf5f5ab517a\nFlash Player\n381e40d02\n\n\nTrojan.MacOS.NUKESPE\nD.B\n\nTrojan.MacOS.NUKESPE\nD B\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.11.20.Mac_Lazarus/Mac%20Backdoor%20Linked%20to%20Lazarus%20Targets%20Korean%20Users.pdf"
    ],
    "report_names": [
        "Mac Backdoor Linked to Lazarus Targets Korean Users"
    ],
    "threat_actors": [
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1574300931,
    "ts_modification_date": 1574300931,
    "files": {
        "pdf": "https://archive.orkl.eu/cf1750865234a5840d529a498a5fa1107d79fe64.pdf",
        "text": "https://archive.orkl.eu/cf1750865234a5840d529a498a5fa1107d79fe64.txt",
        "img": "https://archive.orkl.eu/cf1750865234a5840d529a498a5fa1107d79fe64.jpg"
    }
}