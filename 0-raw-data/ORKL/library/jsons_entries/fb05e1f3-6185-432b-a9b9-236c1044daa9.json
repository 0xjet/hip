{
    "id": "fb05e1f3-6185-432b-a9b9-236c1044daa9",
    "created_at": "2023-01-12T15:01:40.29396Z",
    "updated_at": "2025-03-27T02:13:34.338198Z",
    "deleted_at": null,
    "sha1_hash": "063c8c1d3942b6714dd4854fbe8675608d37fe1f",
    "title": "2018-04-26 - Necurs Evolves to Evade Spam Detection via Internet Shortcut File",
    "authors": "",
    "file_creation_date": "2022-05-27T19:08:46Z",
    "file_modification_date": "2022-05-27T19:08:46Z",
    "file_size": 305886,
    "plain_text": "# Necurs Evades Detection via Internet Shortcut File\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/necurs-evolves-to-evade-spam-detection-via-internet-shortcut-file/](https://blog.trendmicro.com/trendlabs-security-intelligence/necurs-evolves-to-evade-spam-detection-via-internet-shortcut-file/)**\n\nApril 26, 2018\n\nNecurs, a botnet malware that’s been around since 2012, has been improved with the hopes of\nbetter defeating cybersecurity measures — it was seen to evolve its second layer of infection\nusing a .URL file (with remote script downloaders detected by Trend Micro as MAL_CERBERJS03D, MAL_NEMUCOD-JS21B, VBS_SCARAB.SMJS02, and MAL_SCARAB-VBS30.\n\nNecurs, a modular malware with variants that are capable of spam distribution, information theft,\nand disabling security services and elements, has been around since 2012, propagating in the\nwild via the Necurs botnet. In 2017, it pushed Locky — a ransomware family with one variant that\n[was notable for being distributed via 23 million emails in just 24 hours —](https://www.trendmicro.com/vinfo/ph/security/news/cybercrime-and-digital-threats/new-locky-variant-lukitus-distributed-in-23-million-emails) via a URL-only spam\nemail campaign. Last year, we also saw how Necurs pushed double-zipped attachments that\neither contained JavaScript, Visual Basic scripts, or macro files with the capability to download its\nfinal payload. In an attempt to evade spam detection through its attachments, Necurs used\narchives that included .ZIP files to disguise the script downloader, which was later enclosed in\nanother .ZIP to hide itself.\n\n**The Necurs Transformation: The .URL File Layer**\n\nNecurs is indeed constantly evolving to find other effective measures of tricking victims while\ndefeating countermeasures waged against it. And since it has a highly effective botnet\ncomponent that may also be sold as a service, malicious actors will continue to find ways to\ncircumvent detection and improve how they trick the weakest link in cybersecurity — the user. As\n\n\n-----\n\nsecurity vendors are wise to Necurs s traditional infection chain (a script, a macro, or archives\ncontaining certain file formats), the malware has started using an internet shortcut or .URL file to\nbypass detection.\n\nFigure 1. A diagram of a previous version of the Necurs malware\n\nFigure 2. A diagram of the evolved Necurs malware\n\nInternet shortcuts, or .URLs, take the form of clickable icons and are objects used to access\ninternet sites or web documents faster. Internet shortcuts have contents that are in the INI file\nformat, which allows the changing of icons. Necurs malware uses this to its advantage by\nchanging the folder icon to trick the victim into thinking that it’s a different file type, as it is less\nsuspicious than clicking on a script. The .URL will then access the remote resource that\ndownloads another downloader. The second downloader remotely executes the payload.\n\n[Figure 3. A .URL file disguised as a .ZIP file of a voicemail message](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2018/04/Figure_3_URL_file.jpg)\n\nFigure 3. A .URL file disguised as a .ZIP file of a voicemail message\n\nNotice that aside from the icons disguised as folders, the filenames were also crafted to resemble\ntypical folder names such as IMG-20180404-9AC4DD, SCN-20180404-268CC1, and PIC20180404-ADEEEE shown in Figure 2, to name a few.\n\nFigure 4. A screen capture of an internet shortcut’s extracted files\n\nFurthermore, the actual attachment archive does not contain the script downloader Necurs uses\nto download its payload. The .URL file accesses the remote server, which then executes through\nthe Server Message Block (SMB) protocol — a tactic that may be successful in evading certain\nspam filters.\n\n[Figure 5. A screen capture of a remote file being accessed through the SMB protocol](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2018/04/Figure_5_screen_capture_remote_file.jpg)\n\nFigure 5. A screen capture of a remote file being accessed through the SMB protocol\n\nThe malware doesn’t stop at disguising .URL files. The latest Necurs variant no longer has the\nactual script downloader in its attachment. It only contains the internet shortcut to the remote site\nthat contains the script that is then executed remotely. This means that it does not “download” the\nactual script on the victim’s machine. This is the closest it gets to its previous malicious spam\nruns: Attaching a URL in the email and tricking a victim into clicking on the link to download a\nmalicious file.\n\nFigure 6. A look at Necurs’s attachment\n\n\n-----\n\nInterestingly, Necurs does not infect computers using Russian as a language.\n\n**Further Evolution: Using QUANTLOADER**\n\nPreviously, Necurs’s JavaScript downloader downloads the final payload. But in its latest iteration,\nthe remote script downloads QUANTLOADER (detected by Trend Micro as TROJ_QUANT) – a\ndifferent downloader – which then downloads the final payload. This is another layer added to\nNecurs’s infection chain. The use of QUANTLOADER may be twofold: First, it adds another\ndownload stage before it downloads the final payload, possibly to mix things up and evade\nbehavioral detections. Secondly, QUANTLOADER is persistent in nature — it drops a copy of\nitself and creates an autorun registry so that it executes at startup.\n\n**_Indicators of Compromise_**\n\n**SHA-256s** **Detection**\n**Names**\n\n03c770882e87585fea0272a8e6a7b7e37085e193475884b1316e14fb193e992d TROJ_QUANT.K\n\nb0c173e0fc28e0f1bc8debfe49de01f306d372a0516d88201b87e441f3de303e TROJ_QUANT.J\n\nb87e0dd9b0e032c6d2d5f0bf46f00243a2a866bf1d3d22f8b72737b4aa1148eb TROJ_QUANT.L\n\n00ca7e9e61a3ceaa4b9250866aface8af63e5ae71435d4fd6c770a8c9a167f22 TROJ_QUANT.K\n\n**Trend Micro Solutions**\n\nTo protect against Necurs and other continuously evolving spammed threats, businesses can\n[take advantage of Trend Micro™ endpoint solutions such as Trend Micro](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) Smart Protection\nSuites and [Worry-Free™ Business Security. Both solutions can protect users and businesses](https://blog.trendmicro.com/en_us/small-business/worry-free.html)\nfrom threats by detecting malicious files, and spammed messages as well as blocking all related\n[malicious URLs. Trend Micro Deep Discovery™ has an email inspection layer that can protect](https://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection/deep-discovery-threat-intelligence-network-analytics.html)\nenterprises by detecting malicious attachment and URLs. Deep Discovery is able to detect the\nremote script despite it not being downloaded in the physical endpoint.\n\n[Trend Micro™ Email Security is a no-maintenance cloud solution that delivers continuously](https://blog.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/email-security.html)\nupdated protection to stop spam, malware, spear phishing, ransomware, and advanced targeted\n[attacks before they reach the network. It protects Microsoft Exchange, Microsoft Office 365,](https://blog.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/cloud-app-security.html)\nGoogle Apps, and other hosted and on-premises email solutions. The spam mail used by this\nthreat is detected on arrival by Trend Micro™ Email Reputation Services™, while our spam\nengine can detect Necurs’s technique: an archive containing internet shortcut.\n\n[Trend Micro™ OfficeScan™ with XGen™ endpoint security infuses high-fidelity machine learning](https://www.trendmicro.com/vinfo/ph/security/definition/machine-learning)\nwith other detection technologies and global threat intelligence for comprehensive protection\nagainst advanced malware.\n\n[A list of all the hashes (SHA-256) is in this appendix.](https://documents.trendmicro.com/assets/appendix-necurs-evolves-to-evade-spam-detection-via-internet-shortcut-file.pdf)\n\n\n-----\n\nMalware\n\nNecurs, a botnet malware that’s been around since 2012, has been improved with the hopes of\nbetter defeating cybersecurity measures — it was seen to evolve its second layer of infection\nusing a .URL file.\n\nBy: Miguel Carlo Ang April 26, 2018 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-04-26 - Necurs Evolves to Evade Spam Detection via Internet Shortcut File.pdf"
    ],
    "report_names": [
        "2018-04-26 - Necurs Evolves to Evade Spam Detection via Internet Shortcut File.pdf"
    ],
    "threat_actors": [
        {
            "id": "e7d03ac8-7d6f-4ea0-83a9-10dff2ea1486",
            "created_at": "2022-10-25T16:07:24.158325Z",
            "updated_at": "2025-03-27T02:02:10.127249Z",
            "deleted_at": null,
            "main_name": "Scarab",
            "aliases": [
                "UAC-0026"
            ],
            "source_name": "ETDA:Scarab",
            "tools": [
                "Scieron"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9099912b-a00a-4afb-8294-c6d35af421a1",
            "created_at": "2023-01-06T13:46:39.338108Z",
            "updated_at": "2025-03-27T02:00:03.054726Z",
            "deleted_at": null,
            "main_name": "Scarab",
            "aliases": [],
            "source_name": "MISPGALAXY:Scarab",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535700,
    "ts_updated_at": 1743041614,
    "ts_creation_date": 1653678526,
    "ts_modification_date": 1653678526,
    "files": {
        "pdf": "https://archive.orkl.eu/063c8c1d3942b6714dd4854fbe8675608d37fe1f.pdf",
        "text": "https://archive.orkl.eu/063c8c1d3942b6714dd4854fbe8675608d37fe1f.txt",
        "img": "https://archive.orkl.eu/063c8c1d3942b6714dd4854fbe8675608d37fe1f.jpg"
    }
}