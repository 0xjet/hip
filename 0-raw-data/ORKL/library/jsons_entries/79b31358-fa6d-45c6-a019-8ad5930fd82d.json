{
    "id": "79b31358-fa6d-45c6-a019-8ad5930fd82d",
    "created_at": "2023-01-12T15:10:04.828483Z",
    "updated_at": "2025-03-27T02:09:38.794298Z",
    "deleted_at": null,
    "sha1_hash": "ab8f800d00790b6ae84509fe6532fa470b1df415",
    "title": "2014-06-23 - Havex Hunts For ICS-SCADA Systems",
    "authors": "",
    "file_creation_date": "2022-05-27T23:09:39Z",
    "file_modification_date": "2022-05-27T23:09:39Z",
    "file_size": 139439,
    "plain_text": "# January 2004 to September 2015\n\n**f-secure.com/weblog/archives/00002718.html**\n\n[<<<](https://www.f-secure.com/weblog/archives/00002717.html) NEWS FROM THE LAB - Monday, June 23, 2014 [>>>](https://www.f-secure.com/weblog/archives/00002719.html)\n\n**[ARCHIVES |](https://www.f-secure.com/weblog/archives/)** **[SEARCH](https://www.bing.com/search?q=site:f-secure.com/weblog)**\n\n**[Havex Hunts For ICS/SCADA Systems](https://www.f-secure.com/weblog/archives/00002718.html)** Posted by Daavid @ 14:46 GMT\n\nSpam email\n\nExploit kits\n\nTrojanized installers planted on compromised vendor sites\n\nThe spam and exploit kit channels are fairly straightforward distribution mechanisms and\nwe won't analyze them in more detail here.\n\nOf more interest is the third channel, which could be considered a form of \"watering-hole\nattack\", as the attackers chose to compromise an intermediary target - the ICS vendor\nsite - in order to gain access to the actual targets.\n\nIt appears the attackers abuse vulnerabilities in the software used to run the websites to\nbreak in and replace legitimate software installers available for download to customers.\n\nOur research uncovered three software vendor sites that were compromised in this\nmanner. The software installers available on the sites were trojanized to include the\nHavex RAT. We suspect more similar cases exist but have not been identified yet.\n\nBased on the content of their websites, all three companies are involved in development\nof applications and appliances for use in industrial applications. These organizations are\nbased in Germany, Switzerland and Belgium. Two of them are suppliers of remote\nmanagement software for ICS systems and the third develops high-precision industrial\ncameras and related software.\n\nAs an example, we can see the partial results of dynamic analysis for one of the\ntrojanized installers:\n\n\n-----\n\nThe normal, clean installer does not include a file called \"mbcheck.dll\". This file is\nactually the Havex malware. The trojanized software installer will drop and execute this\nfile as a part of the normal installation. The user is left with a working system, but the\nattacker now has a backdoor to access and control the computer.\n\n**Target Organizations**\n\nWe were able to locate some of the infected systems and identify the organization\naffected by the samples analyzed in this report by tracing the IP addresses\ncommunicating to the C&C servers used by the Havex RAT.\n\nAll of these entities are associated in some way with the development or use of\nindustrial applications or machines. The majority of the victims are located in Europe,\nthough at the time of writing at least one company in California was also observed\nsending data to the C&C servers. Of the European-based organizations, two are major\neducational institutions in France that are known for technology-related research; two\nare German industrial application or machine producers; one is a French industrial\nmachine producer; and one is a Russian construction company that appears to\nspecialize in structural engineering.\n\n**ICS/SCADA Sniffer**\n\nOur analysis of Havex sample codes also uncovered its \"ICS/SCADA sniffing\" behavior.\nThe C&C server will instruct infected computers to download and execute further\ncomponents, and one of these components appeared very interesting. While analyzing\nthis component, we noticed that it enumerates the local area network and looks for\nconnected resources and servers:\n\nWe then noticed that it uses Microsoft Component Object Model (COM) interfaces\n(CoInitializeEx, CoCreateInstanceEx) to connect to specific services:\n\n\n-----\n\nTo identify which services the sample is interested in, we can simply search for the\nidentifiers seen above, which tell us what kind of interfaces are being used. A bit of\ngoogling gives us these names:\n\n**9DD0B56C-AD9E-43EE-8305-487F3188BF7A = IID_IOPCServerList2**\n\n**13486D51-4821-11D2-A494-3CB306C10000 = CLSID_OPCServerList**\n\nNote the mention of \"OPCServer\" in the names. There are more hints pointing in the\nsame direction -- the strings found in the executable also make several references to\nOPC� :�\n\nIt turns out that OPC stands for [OLE for Process Control, and it's a standard way for](http://en.wikipedia.org/wiki/OLE_for_Process_Control)\nWindows applications to interact with process control hardware. Using OPC, the\nmalware component gathers any details about connected devices and sends them back\nto the C&C for the attackers to analyze. It appears that this component is used as a tool\nfor intelligence gathering. So far, we have not seen any payloads that attempt to control\nthe connected hardware.\n\n**Summary**\n\nThe attackers behind Havex are conducting industrial espionage using a clever method.\nTrojanizing ICS/SCADA software installers is an effective method in gaining access to\ntarget systems, potentially even including critical infrastructure.\n\nThe method of using compromised servers as C&C's is typical for this group. The group\ndoesn't always manage the C&C's in a professional manner, revealing lack of\nexperience in operations. We managed to monitor infected computers connecting to the\nservers and identify victims from several industry sectors.\n\nThe additional payload used to gather details about ICS/SCADA hardware connected to\ninfected devices shows the attackers have direct interest in controlling such\nenvironments. This is a pattern that is not commonly observed today.\n\nSHA-1 hashes of the samples discussed:\n\n\n-----\n\n7f249736efc0c31c44e96fb72c1efcc028857ac7\n1c90ecf995a70af8f1d15e9c355b075b4800b4de\ndb8ed2922ba5f81a4d25edb7331ea8c0f0f349ae\nefe9462bfa3564fe031b5ff0f2e4f8db8ef22882\n\nF-Secure detects this threat as Backdoor:W32/Havex.A.\n\nPost by — [Daavid and](https://twitter.com/daavidhentunen) [Antti](https://twitter.com/anttitikkanen)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-06-23 - Havex Hunts For ICS-SCADA Systems.pdf"
    ],
    "report_names": [
        "2014-06-23 - Havex Hunts For ICS-SCADA Systems.pdf"
    ],
    "threat_actors": [
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536204,
    "ts_updated_at": 1743041378,
    "ts_creation_date": 1653692979,
    "ts_modification_date": 1653692979,
    "files": {
        "pdf": "https://archive.orkl.eu/ab8f800d00790b6ae84509fe6532fa470b1df415.pdf",
        "text": "https://archive.orkl.eu/ab8f800d00790b6ae84509fe6532fa470b1df415.txt",
        "img": "https://archive.orkl.eu/ab8f800d00790b6ae84509fe6532fa470b1df415.jpg"
    }
}