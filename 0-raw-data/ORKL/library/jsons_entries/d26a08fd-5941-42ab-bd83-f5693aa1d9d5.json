{
    "id": "d26a08fd-5941-42ab-bd83-f5693aa1d9d5",
    "created_at": "2023-01-12T15:02:42.23566Z",
    "updated_at": "2025-03-27T02:05:49.113495Z",
    "deleted_at": null,
    "sha1_hash": "d3ab1b2914c33f7eb016d38cf6cb0bcb3216aabf",
    "title": "2022-06-24 - IcedID Banking Trojan returns with new TTPS – Detection & Response",
    "authors": "",
    "file_creation_date": "2022-07-02T23:15:45Z",
    "file_modification_date": "2022-07-02T23:15:45Z",
    "file_size": 309397,
    "plain_text": "# IcedID Banking Trojan returns with new TTPS – Detection & Response\n\n**[socinvestigation.com/icedid-banking-trojan-returns-with-new-ttps-detection-response/](https://www.socinvestigation.com/icedid-banking-trojan-returns-with-new-ttps-detection-response/)**\n\n#### IOC\n\n By\n\n BalaGanesh \n June 24, 2022 0\n\n\nJune 24, 2022\n\n\n#### Malware researchers have noticed that the ever-evolving banking trojan IcedID is back again with a phishing campaign. In this campaign, malware abuses Google cloud and Google firebase to deliver phishing links.\n\n Security researcher ankit_anubhav has observed the malware sample. Phishing email with an email body containing “Please find document links” and the researcher says Pressing the “download” button loads another google link (firebase) to download the actual zip, which contains an iso to launch payload.\n\n\n-----\n\n#### Source: https://twitter.com/ankit_anubhav\n\n Source: https://twitter.com/ankit_anubhav The use of ISO files allows the threat actor to bypass the Mark-of-the-Web controls, resulting in the execution of the malware without warning to the user.\n\n Once zip files are executed, Malware creates a new shell “C:\\Windows\\system32\\cmd.exe” and executes the command cmd /c \"C:\\Users\\Admin\\AppData\\Local\\Temp\\document 2.iso\" . Windows default disc burner “isoburn.exe” is utilized “C:\\Windows\\System32\\isoburn.exe” “C:\\Users\\Admin\\AppData\\Local\\Temp\\document 2.iso” to execute these ISO files.\n\n The infected machine downloads a new file in the directory\n```\n“C:\\Users\\Admin\\Downloads\\PowerISO8.exe” and some DLLs are installed using Regsvr32 utility.\n\n```\n\n-----\n\n#### But the attacker has already executed the ISO with windows default disk burner, this PowerIS08.exe download activity looks something suspicious like threat actors want a backup of alternate ISO software to execute malicious files.\n\n Infected machines connect with C2 bredofenction[.]com and use a man-in-the-browser attack to steal financial information, including login credentials for online banking sessions.\n\n## Indicator of compromise:\n\n#### File: https://www.virustotal.com/gui/file/7354552c28ad25c6c83e84f1ef7da0a8a53dc9ba8177416c1f4be229130505b5\n\n Stage 1 html https://storage.googleapis[.]com/rj66f513.appspot.com/o/Bx9PomC.htm#\n\n Stag 2 link https[:]//firebasestorage.googleapis[.]com/v0/b/causal-tracker- 354112.appspot.com/o/q4DLC3Kw3k%2Fdocument.zip?alt=media&token=70ade0dd-fc8b-4044-bf3b- f9912d9c9bfe\n\n C2s\n\n bredofenction[.]com\n\n aniogarphianeo[.]com\n\n carbrownleger[.]com\n\n Intel source: ankit_anubhav / Mikhail Kasimov\n\n Detection & Response:\n\n Qradar:\n\n\n-----\n\n```\n       (p y ) ( yp ) y\nEvent Log' and ((\"Process CommandLine\" ilike '%cmd /c%' and \"Process CommandLine\" ilike\n'%\\AppData\\Local\\%' and \"Process CommandLine\" ilike '%.iso%' and \"Process CommandLine\" ilike\n'%C:\\Users\\%' and ((\"Image\" ilike '%\\cmd.exe') or \"Image\" ilike '%\\isoburn.exe')) or (\"Image\" ilike\n'%\\regsvr32.exe' and \"Process CommandLine\" ilike '%/s%' and \"Process CommandLine\" ilike '%C:\\Program\nFiles%' and \"Process CommandLine\" ilike '%PowerISO%') or \"Image\" ilike '%PowerISO8.exe')\n\nSplunk:\n((CommandLine=\"*cmd /c*\" AND CommandLine=\"*\\\\AppData\\\\Local\\\\*\" AND CommandLine=\"*.iso*\" AND\nCommandLine=\"*C:\\\\Users\\\\*\" AND ((Image=\"*\\\\cmd.exe\") OR Image=\"*\\\\isoburn.exe\")) OR\n(Image=\"*\\\\regsvr32.exe\" AND CommandLine=\"*/s*\" AND CommandLine=\"*C:\\\\Program Files*\" AND\nCommandLine=\"*PowerISO*\") OR Image=\"*PowerISO8.exe\") AND source=\"WinEventLog:*\"\n\nElasticQuery:\n((process.command_line:*cmd\\ \\/c* AND process.command_line:*\\\\AppData\\\\Local\\\\* AND\nprocess.command_line:*.iso* AND process.command_line:*C\\:\\\\Users\\\\* AND\n(process.executable:*\\\\cmd.exe OR process.executable:*\\\\isoburn.exe)) OR\n(process.executable:*\\\\regsvr32.exe AND process.command_line:*\\/s* AND\nprocess.command_line:*C\\:\\\\Program\\ Files* AND process.command_line:*PowerISO*) OR\nprocess.executable:*PowerISO8.exe)\n\nCrowstike:\n((((ImageFileName=\"*\\\\cmd.exe\") AND (CommandLine=\"*cmd /c*\" OR CommandHistory=\"*cmd /c*\") AND\n(CommandLine=\"*\\\\AppData\\\\Local\\\\*\" OR CommandHistory=\"*\\\\AppData\\\\Local\\\\*\") AND\n(CommandLine=\"*.iso*\" OR CommandHistory=\"*.iso*\") AND (CommandLine=\"*C:\\\\Users\\\\*\" OR\nCommandHistory=\"*C:\\\\Users\\\\*\")) OR (ImageFileName=\"*\\\\isoburn.exe\" AND (CommandLine=\"*cmd /c*\" OR\nCommandHistory=\"*cmd /c*\") AND (CommandLine=\"*\\\\AppData\\\\Local\\\\*\" OR\nCommandHistory=\"*\\\\AppData\\\\Local\\\\*\") AND (CommandLine=\"*.iso*\" OR CommandHistory=\"*.iso*\") AND\n(CommandLine=\"*C:\\\\Users\\\\*\" OR CommandHistory=\"*C:\\\\Users\\\\*\"))) OR\n(ImageFileName=\"*\\\\regsvr32.exe\" AND (CommandLine=\"*/s*\" OR CommandHistory=\"*/s*\") AND\n(CommandLine=\"*C:\\\\Program Files*\" OR CommandHistory=\"*C:\\\\Program Files*\") AND\n(CommandLine=\"*PowerISO*\" OR CommandHistory=\"*PowerISO*\")) OR ImageFileName=\"*PowerISO8.exe\")\n\nFireEye:\n(metaclass:`windows` ((args:`cmd /c` args:`\\AppData\\Local\\\\` args:`.iso` args:`C:\\Users\\\\`\n(process:`*\\cmd.exe` OR process:`*\\isoburn.exe`)) OR (process:`*\\regsvr32.exe` args:`/s`\nargs:`C:\\Program Files` args:`PowerISO`) OR process:`*PowerISO8.exe`))\n\nGrayLog:\n((CommandLine.keyword:*cmd\\ \\/c* AND CommandLine.keyword:*\\\\AppData\\\\Local\\\\* AND\nCommandLine.keyword:*.iso* AND CommandLine.keyword:*C\\:\\\\Users\\\\* AND (Image.keyword:*\\\\cmd.exe OR\nImage.keyword:*\\\\isoburn.exe)) OR (Image.keyword:*\\\\regsvr32.exe AND CommandLine.keyword:*\\/s* AND\nCommandLine.keyword:*C\\:\\\\Program\\ Files* AND CommandLine.keyword:*PowerISO*) OR\nImage.keyword:*PowerISO8.exe)\n\nLogpoint:\n((CommandLine=\"*cmd /c*\" CommandLine=\"*\\\\AppData\\\\Local\\\\*\" CommandLine=\"*.iso*\"\nCommandLine=\"*C:\\\\Users\\\\*\" (Image IN \"*\\\\cmd.exe\" OR Image=\"*\\\\isoburn.exe\")) OR\n(Image=\"*\\\\regsvr32.exe\" CommandLine=\"*/s*\" CommandLine=\"*C:\\\\Program Files*\"\nCommandLine=\"*PowerISO*\") OR Image=\"*PowerISO8.exe\")\n\n\n```\n\n-----\n\n```\nDeviceProcessEvents | where ((ProcessCommandLine contains \"cmd /c\" and ProcessCommandLine contains\n@\"\\AppData\\Local\\\" and ProcessCommandLine contains \".iso\" and ProcessCommandLine contains\n@\"C:\\Users\\\" and ((FolderPath endswith @\"\\cmd.exe\") or FolderPath endswith @\"\\isoburn.exe\")) or\n(FolderPath endswith @\"\\regsvr32.exe\" and ProcessCommandLine contains \"/s\" and ProcessCommandLine\ncontains @\"C:\\Program Files\" and ProcessCommandLine contains \"PowerISO\") or FolderPath endswith\n\"PowerISO8.exe\")\n\nMicrosoft Sentinel:\nSecurityEvent | where EventID == 4688 | where ((CommandLine contains 'cmd /c' and CommandLine\ncontains @'\\AppData\\Local\\' and CommandLine contains '.iso' and CommandLine contains @'C:\\Users\\'\nand ((NewProcessName endswith @'\\cmd.exe') or NewProcessName endswith @'\\isoburn.exe')) or\n(NewProcessName endswith @'\\regsvr32.exe' and CommandLine contains '/s' and CommandLine contains\n@'C:\\Program Files' and CommandLine contains 'PowerISO') or NewProcessName endswith 'PowerISO8.exe')\n\nGoogle Chronicle:\n((target.process.command_line = /.*cmd \\/c.*/ and target.process.command_line =\n/.*\\\\AppData\\\\Local.*/ and target.process.command_line = /.*\\.iso.*/ and target.process.command_line\n= /.*C:\\\\Users.*/ and (target.process.file.full_path = /.*\\\\cmd\\.exe/ or\ntarget.process.file.full_path = /.*\\\\isoburn\\.exe/)) or (target.process.file.full_path =\n/.*\\\\regsvr32\\.exe/ and target.process.command_line = /.*\\/s.*/ and target.process.command_line =\n/.*C:\\\\Program Files.*/ and target.process.command_line = /.*PowerISO.*/) or\ntarget.process.file.full_path = /.*PowerISO8\\.exe/)\n\nRSA Netwitness:\n(((CommandLine contains 'cmd /c') && (CommandLine contains 'AppData\\Local\\\\') && (CommandLine\ncontains '.iso') && (CommandLine contains 'C:\\Users\\\\') && ((Image contains '\\cmd\\.exe') || (Image\ncontains 'isoburn.exe'))) || ((Image contains 'regsvr32.exe') && (CommandLine contains '/s') &&\n(CommandLine contains 'C:\\Program Files') && (CommandLine contains 'PowerISO')) || (Image contains\n'PowerISO8.exe'))\n\nSumologic:\n(_sourceCategory=*windows* AND (((CommandLine=\"*cmd /c*\" AND CommandLine=\"*\\AppData\\Local\\\\*\" AND\nCommandLine=\"*.iso*\" AND CommandLine=\"*C:\\Users\\\\*\" AND (((Image = \"*\\cmd.exe\") OR\nImage=\"*\\isoburn.exe\"))) OR (Image=\"*\\regsvr32.exe\" AND CommandLine=\"*/s*\" AND\nCommandLine=\"*C:\\Program Files*\" AND CommandLine=\"*PowerISO*\") OR Image=\"*PowerISO8.exe\")))\n\nCarbonBlack:\n((process_cmdline:*cmd\\ \\/c* AND process_cmdline:*\\\\AppData\\\\Local\\\\* AND process_cmdline:*.iso* AND\nprocess_cmdline:*C\\:\\\\Users\\\\* AND (process_name:*\\\\cmd.exe OR process_name:*\\\\isoburn.exe)) OR\n(process_name:*\\\\regsvr32.exe AND process_cmdline:*\\/s* AND process_cmdline:*C\\:\\\\Program\\ Files*\nAND process_cmdline:*PowerISO*) OR process_name:*PowerISO8.exe)\n\nAws Opensearch:\n((process.command_line:*cmd\\ \\/c* AND process.command_line:*\\\\AppData\\\\Local\\\\* AND\nprocess.command_line:*.iso* AND process.command_line:*C\\:\\\\Users\\\\* AND\n\n```\n\n-----\n\n```\n(p p ))\n(process.executable:*\\\\regsvr32.exe AND process.command_line:*\\/s* AND\nprocess.command_line:*C\\:\\\\Program\\ Files* AND process.command_line:*PowerISO*) OR\nprocess.executable:*PowerISO8.exe)\n\nArcsight:\n(((((((deviceProcessName CONTAINS \"*\\\\cmd.exe\" OR destinationProcessName CONTAINS \"*\\\\cmd.exe\" OR\nsourceProcessName CONTAINS \"*\\\\cmd.exe\")) AND (((deviceCustomString1 CONTAINS \"*cmd /c*\" OR\ndestinationServiceName CONTAINS \"*cmd /c*\")) AND ((deviceCustomString1 CONTAINS\n\"*\\\\AppData\\\\Local\\\\\\\\*\" OR destinationServiceName CONTAINS \"*\\\\AppData\\\\Local\\\\\\\\*\")) AND\n((deviceCustomString1 CONTAINS \"*.iso*\" OR destinationServiceName CONTAINS \"*.iso*\")) AND\n((deviceCustomString1 CONTAINS \"*C:\\\\Users\\\\\\\\*\" OR destinationServiceName CONTAINS\n\"*C:\\\\Users\\\\\\\\*\")))) OR (((deviceProcessName ENDSWITH \"*\\\\isoburn.exe\" OR destinationProcessName\nENDSWITH \"*\\\\isoburn.exe\" OR sourceProcessName ENDSWITH \"*\\\\isoburn.exe\")) AND\n(((deviceCustomString1 CONTAINS \"*cmd /c*\" OR destinationServiceName CONTAINS \"*cmd /c*\")) AND\n((deviceCustomString1 CONTAINS \"*\\\\AppData\\\\Local\\\\\\\\*\" OR destinationServiceName CONTAINS\n\"*\\\\AppData\\\\Local\\\\\\\\*\")) AND ((deviceCustomString1 CONTAINS \"*.iso*\" OR destinationServiceName\nCONTAINS \"*.iso*\")) AND ((deviceCustomString1 CONTAINS \"*C:\\\\Users\\\\\\\\*\" OR destinationServiceName\nCONTAINS \"*C:\\\\Users\\\\\\\\*\")))))) OR (((deviceProcessName ENDSWITH \"*\\\\regsvr32.exe\" OR\ndestinationProcessName ENDSWITH \"*\\\\regsvr32.exe\" OR sourceProcessName ENDSWITH \"*\\\\regsvr32.exe\"))\nAND (((deviceCustomString1 CONTAINS \"*/s*\" OR destinationServiceName CONTAINS \"*/s*\")) AND\n((deviceCustomString1 CONTAINS \"*C:\\\\Program Files*\" OR destinationServiceName CONTAINS\n\"*C:\\\\Program Files*\")) AND ((deviceCustomString1 CONTAINS \"*PowerISO*\" OR destinationServiceName\nCONTAINS \"*PowerISO*\")))) OR deviceProcessName ENDSWITH \"*PowerISO8.exe\" OR destinationProcessName\nENDSWITH \"*PowerISO8.exe\" OR sourceProcessName ENDSWITH \"*PowerISO8.exe\"))\n\n\n### LEAVE A REPLY\n\n#### Please enter your comment!\n\n Please enter your name here\n\n You have entered an incorrect email address!\n\n Please enter your email address here\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-24 - IcedID Banking Trojan returns with new TTPS – Detection & Response.pdf"
    ],
    "report_names": [
        "2022-06-24 - IcedID Banking Trojan returns with new TTPS – Detection & Response.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535762,
    "ts_updated_at": 1743041149,
    "ts_creation_date": 1656803745,
    "ts_modification_date": 1656803745,
    "files": {
        "pdf": "https://archive.orkl.eu/d3ab1b2914c33f7eb016d38cf6cb0bcb3216aabf.pdf",
        "text": "https://archive.orkl.eu/d3ab1b2914c33f7eb016d38cf6cb0bcb3216aabf.txt",
        "img": "https://archive.orkl.eu/d3ab1b2914c33f7eb016d38cf6cb0bcb3216aabf.jpg"
    }
}