{
    "id": "7e81ce32-ed62-4f46-86f9-7d065accd318",
    "created_at": "2023-01-12T15:00:00.284897Z",
    "updated_at": "2025-03-27T02:06:13.533695Z",
    "deleted_at": null,
    "sha1_hash": "9a3e3f18639fb15a9b35e79e999a37fcd42375e1",
    "title": "2021-04-16 - Ransomware micro-criminals are still out here (and growing)",
    "authors": "",
    "file_creation_date": "2022-05-29T10:49:04Z",
    "file_modification_date": "2022-05-29T10:49:04Z",
    "file_size": 3633000,
    "plain_text": "# Ransomware micro-criminals are still out here (and growing)\n\n**[yoroi.company/research/ransomware-micro-criminals-are-still-out-here-and-growing/](https://yoroi.company/research/ransomware-micro-criminals-are-still-out-here-and-growing/)**\n\n04/16/2021\n\n## Introduction\n\n\nApril 16, 2021\n\n\nRansomware confirms to be one of the most pervasive threats of the last years. We saw during these last\nyears the infamous phenomenon of Double Extorsion, where well-organized cyber-criminal groups perform\nhighly sophisticated red team operations to achieve the highest level of privileges inside the perimeter of\nvictim networks and, before releasing the ransomware, they steal all the sensitive data to extort the target the\npayment of ransom.\n\nThe diffusion of this trend, however, did not implied classic ransomware operation have been deprecated. In\nfact, the \"old-style\" ransomware operation model is still very active: victims keep receiving e-mails with\nmalicious attachments that, once opened, automatically execute the ransomware payload on the unlucky\nmachine.\n\nThis malicious operational model is still enabling many micro-criminals to profit on users and the production\nof entry-level ransomware tools is growing and evolving. For instance, JobCrypter ransomware\nhas been recently spread over the Italian cyber-landscape In this article we decided to dissect\n\n\n-----\n\nand observe the latest updates of this 3 years old ransomware family weaponizing many cyber-criminals all\naround the world.\n\n## Technical Analysis \n\nThe infection chain starts with a malicious JavaScript delivered to the victim with the\nfollowing static information:\n\nHash 682ab3a13d3b8f303e7947bcc03a36fa4977d82ae546f1b07e1f5684d2caff6d\n\nThreat JobCrypter\n\nBrief Description JobCrypter Javascrpt Loader\n\nSsdeep 24576:0L8v7nz42QE24Kkt0w68zbfaIEGNS8znoATmIVXXZn9VGIJ/I+CA8GlBk+Na+NT6:i\n\nTable 1. Sample information\n\nThe script code is quite simple to understand it is composed by\nan obfuscated hex string, which is immediately deobfuscated by a unique main function. The structure of the\ncode is the following:\n```\nvar _0xc6c2=[OBFUSCATED PAYLOAD]; \nfunction nnt(_0x7883x2) // Deobfuscation routine \n{\n[..] \nreturn _0x7883x7 \n}\nvar rrn=(_0xc6c2[6]); \nvar myObject; \nefiiiiooollll= new ActiveXObject(_0xc6c2[7]);erfvgttyyytbgg= efiiiiooollll.GetSpecialFolder(2)+\n_0xc6c2[8];var rouuurtoliii=nnt(rrn); \nvar foularouuuuuuu= new ActiveXObject(_0xc6c2[9]); \nfoularouuuuuuu[_0xc6c2[10]]= 2;foularouuuuuuu[_0xc6c2[11]]=\n_0xc6c2[12];foularouuuuuuu.Open();foularouuuuuuu.WriteText(rouuurtoliii);foularouuuuuuu.SaveToFile(er\n new ActiveXObject(_0xc6c2[13]);efiiiiooollll.Run(erfvgttyyytbgg)\n\n```\nCode Snippet 1\n\nThe script stores the decrypted executable inside\nthe classic temporary Path: \"C:\\Users\\%USER%\\AppData\\Local\\Temp\". The dropped payload is a .NET\nframework executable having the following static information:\n\nHash 150e8ef3f1b0d5b5b2af2ffc8d540cb0e36ecdcaf5001bab2f318e36a3c25302\n\nThreat JobCrypter\n\nBrief Description JobCrypter .NET Framework Core\n\n\n-----\n\nSsdeep 6144:+yNu/ItUREJ/KKNbS8wf7wmphBgl3gMT6nRx1ASqm:+WlJC6Csm5gRT\n\nTable 1. Sample information\n\nThis sample adopts many self-defense techniques, starting from a complex .NET packer, arriving to ant\ndebug checks, making the analysis harder for the analyst. The first thing to notice is the considerable\nnumber of functions, and the presence of encrypted resources, decrypted at runtime:\n\n## The Packer\n\nFigure 1: Partial example of the functions\n\nSo, one of the first checks is the presence of the debugger, like the following screen:\n\n\n-----\n\nFigure 2: Antidebug Check\n\nAfter this check is bypassed, the main decryption stub starts its work\nof decrypting the most important routines and information as array strings, like the following way:\n\nFigure 3: Example of decoding the interesing routines\n\nWhen this information is retrieved, the malware extracts another array\nfrom a very long method which has been protected through the usage of xor operations:\n\nFigure 4: Decrypting Pieces of code\n\nThis array manipulation continues also with the support of more basic operations, like the conversion from\nbyte to integer and similar, like the following way:\n\n\n-----\n\nFigure 5: Conversion byte to char\n\nIn the end of that custom decryption routine, we obtain the configuration file of the ransomware.\n\n\n-----\n\nFigure 6: Piece of the configuration file\n\nAfter those decoding operations, the malware immediately guarantees itself the persistence by copying itself\nin the \"%ROAMING%\" path with the name \"ERFFREEED.exe\" and creates a simple javascript file inside the\npath \"C:\\Users\\%USER%\\AppData\\Roaming\\Microsoft\\Windows Start Menu\\Programs\\Startup\\REZZZS.js\",\nwhich has the purpose to launch the malicious executable.\n\n## The Encryption Key Exchange\n\nThrough this configuration file we obtain the first interesting information about the sample. It uses the SMTP\nclient as medium to communicate to the C2 the key to decrypt the files. This routine can be confirmed by the\nSMTP client retrieved inside the malicious code:\n\nFigure 7: Initialization of the SMTP Client\n\nOne of the two email addresses is a compromised one used as sender of the mail with identificatory of the\nvictim (retrieved by using the volume serial of the victim machine) and the key of the infection:\n\n\n-----\n\nFigure 8: Evidence of the Volume Serial Number\n\nThat value will be used as subject of the mail sent to the c2, as shown in the intercepted traffic. With this email message, the malware also sends to the cyber-criminal a long string composed by 96 digits: the\nencryption key.\n\nFigure 9: C2 communication\n\n### The File Encryption Algorithm\n\nAs shown in the above figure, the malware sends to the C2 a long string composed by 96 digits.\nIt actually is the key adopted to encrypt the data. In fact, the next operation of the malware is to create that\nstring by using a random generation algorithm provided by the .NET environment.\n\nFigure 10: Evidence of CreateRandomPassword\n\nThat string is hashed with the MD5 algorithm and it now prepared to be used as encryption key. The\nencryption algorithm used to encrypt the victim’s data is Triple DES algorithm, the same used for the infection\n[of about 2 years ago shown by TrendMicro:](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/jobcrypter-ransomware-with-new-routines-for-encryption-desktop-screenshots)\n\n\n-----\n\nFigure 11: Encryption algorithm\n\nAt this point, the question is: It is possible to restore the data? The answer could be\nyes, with a security monitoring appliance such as a Genku Probe able to intercept the mail sent to the C2. In\nthis case, the advantage is so evident, because there is no encrypted channel, and the key is sent in\ncleartext.\n\n\n-----\n\nFigure 12: Example of decrypting data\n\n## Conclusion\n\nRansomware is still a big problem for many companies and users. Such kind of classic ransomware attacks\nrun by micro-criminals could be lethal for SMB businesses and very harassing for Enterprises because, even\nif the decryption could be possible and the impact could be only local, this kind of attacks are becoming even\nmore frequent nowadays and the costs of being continuously overwhelmed by user machine restoring\noperation is pose a relevant threat to IT departments.\n\nInvestments in EDR solutions such as Yoroi’s Kanwa endpoint agent and SOC monitoring services such as\nthe Yoroi’s Cyber Security Defence Services are valuable pieces in\nthe sustainable Information Security strategy enabling IT resources to be free to focus on the business.\n\n## Indicators of Compromise\n\nC2 (email addresses)\n\n[[email protected][.fr (Compromised Email sender)](https://yoroi.company/cdn-cgi/l/email-protection)\n\n[[email protected][.ch](https://yoroi.company/cdn-cgi/l/email-protection)\n\n[[email protected]]com](https://yoroi.company/cdn-cgi/l/email-protection)\n\n[[email protected][.com](https://yoroi.company/cdn-cgi/l/email-protection)\n\nHash\n\n682ab3a13d3b8f303e7947bcc03a36fa4977d82ae546f1b07e1f5684d2caff6d\n150e8ef3f1b0d5b5b2af2ffc8d540cb0e36ecdcaf5001bab2f318e36a3c25302\nd7533dffcfe5215db5a1f06eb6f5096c8d22fa264379c763316ce6434db47421\n\nPersistence\n\nC:\\Users\\%USER%\\AppData\\Roaming\\Microsoft\\Windows Start Menu\\Programs\\Startup\\REZZZS.js\nC:\\Users\\%USER%\\AppData\\Roaming\\ERFFREEED.exe\n\n## Yara Rules\n\n\n-----\n\n```\n      yp _ {\n  meta: \n   description = \"Yara Rule for JobCrypter Ransomware - End of March 2021 \" \n   author = \"Yoroi Malware ZLab\" \n   last_updated = \"2021-04-13\" \n   tlp = \"white\" \n   category = \"informational\" \n  strings: \n          $a1 = { 3B C2 8D A0 ?? 00  } \n $a2 = { 2A 28 C5 00 00 06 20 03 } \n $a3 = { 20 BC 01 00 00 FE 0E 04 00 38 } \n $a4 = { AB 39 00 00 83 54 00 00 8C } \n $a5 = { 69 44 F4 E8 B7 78 50 EF } \n $a6 = { 0E 03 6F 4F 02 00 06 } \n $a7 = { 71 70 F4 48 B9 68 18 65 } \n  condition: \nuint16(0) == 0x5A4D and 4 of them \n}\n\n### Ransom Note\n\n```\n\n-----\n\n```\n          g j, g p, j\nfamilies, \nWe encrypted all your files using a powerful algorithm. \nWe ask you to pay a ransom of 500 euros to decrypt and restore your files. \nWe guarantee your files will be fully opened \nContact us by email to communicate the payment method : \n[email protected]\n[email protected]\n***** What guarantee you? **** \nYou can send one of your encrypted files on your computer and we decrypt it for free \nBut we can only decrypt one file for free. The file must not contain valuable information. \nWrite this ID ######## in the title of your message \nYou have 7 days to purchase your key from this date: \nIf you exceed the deadline it will increase by $ 100 per day, so we advise you to respect the above\nmentioned deadlines\n\n```\n_This blog post was authored by Luigi Martire and Luca Mella of Yoroi Malware ZLAB_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-16 - Ransomware micro-criminals are still out here (and growing).pdf"
    ],
    "report_names": [
        "2021-04-16 - Ransomware micro-criminals are still out here (and growing).pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535600,
    "ts_updated_at": 1743041173,
    "ts_creation_date": 1653821344,
    "ts_modification_date": 1653821344,
    "files": {
        "pdf": "https://archive.orkl.eu/9a3e3f18639fb15a9b35e79e999a37fcd42375e1.pdf",
        "text": "https://archive.orkl.eu/9a3e3f18639fb15a9b35e79e999a37fcd42375e1.txt",
        "img": "https://archive.orkl.eu/9a3e3f18639fb15a9b35e79e999a37fcd42375e1.jpg"
    }
}