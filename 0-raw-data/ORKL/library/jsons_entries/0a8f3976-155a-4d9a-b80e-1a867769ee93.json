{
    "id": "0a8f3976-155a-4d9a-b80e-1a867769ee93",
    "created_at": "2023-06-05T02:06:56.663317Z",
    "updated_at": "2025-03-27T02:06:01.962011Z",
    "deleted_at": null,
    "sha1_hash": "d7012b26e33b1bf8dd11d5e6705c12d801fcea7c",
    "title": "2023-05-10 - spynote",
    "authors": "",
    "file_creation_date": "2023-06-04T12:51:26Z",
    "file_modification_date": "2023-06-04T12:51:26Z",
    "file_size": 1667418,
    "plain_text": "# SpyNote targets IRCTC users\n\n**[labs.k7computing.com/index.php/spynote-targets-irctc-users/](https://labs.k7computing.com/index.php/spynote-targets-irctc-users/)**\n\nBy Baran S May 10, 2023\n\nWe at K7 Labs, recently came across an email message as shown in Figure 1, from Indian\nRailway Catering and Tourism Corporation (IRCTC) about SpyNote, an Android RAT\ntargeting IRCTC users. This spyware is not only used to steal users’ sensitive information\nbut can also spy on a user’s location or remotely control the victims’ device.\n\nFigure 1: Email\n\n\n-----\n\nNotification from IRCTC\nLet’s now get into the details of how this SpyNote works.\n\nThis RAT is propagated via WhatsApp with the malicious link\n_https://irctc[.]creditmobile[.]site/irctcconnect[.]apk_\n\nOnce the user falls prey to this RAT and installs this malicious “irctcconnect.apk”, this app\npretends to be the genuine IRCTC icon in the device app drawer as shown in Figure 2.\n\n\n-----\n\nFigure 2: Fake\n\nIRCTC icon\nOnce this RAT is installed on the device, it frequently brings up the Accessibility Service\nsetting option on the device, as shown in Figure 3, until the user eventually allows this app\nto have the Accessibility Service enabled.\n\n\n-----\n\nFigure 3: Request for Accessibility Service\n\n## Technical Analysis\n\nWith the necessary permissions as shown in Figure 3, this APK acts as a Trojan with\nKeylogger capabilities. It creates a directory “Config/sys/apps/log“, in the devices’ external\nstorage and the logs are saved to the file “log-yyyy-mm-dd.log” in the created directory,\nwhere yyyy-mm-dd is the date of when the keystrokes were captured as shown in Figure\n4.\n\n\n-----\n\nFigure 4: Creating Log files\nThis malware collects location information like altitude, latitude, longitude, precision and\neven the speed at which the device is moving as shown in Figure 5.\n\nFigure 5: Collects the device location information\nSpyNote then proceeds to combine all the aforementioned data and compresses (using\n_gZIPOutputStream API) them before forwarding it to the C2 server as shown in Figure 6._\n\n\n-----\n\nFigure 6: DATA compression using gZIPOutputStream\n\n### C2 Communication\n\nThis RAT contacts the C2 server online[.]spaxdriod[.]studio at IP 154.61.76[.]99, which is\nhardcoded in Figure 7.\n\nFigure 7:\n\nHardcoded C2 URL\nFigure 8 shows the connection established with the C2.\n\nFigure 8: TCP connection with the C2 server\n\n\n-----\n\nAfter the connection is established, the malware sends the gzip compressed data to the\nC2 as evident from the network packet’s header in Figure 9.\n\nFigure 9: gzip data sent by the device after establishing the connection with the C2 Server\nThe decompressed gzip content of the data is shown below in Figure 10.\n\nFigure 10: Decompressed gzip data showing IP address\n\n### Decoding packets from the C2\n\nThe C2 responds by sending a series of compressed data, which when decompressed, is\nrevealed to be system commands and the related APK payload as shown in Figure 11. In\nour case, the APK was extracted using Cyberchef.\n\nFigure 11: Getting commands and APK file from C&C server\n\n\n-----\n\nWe analyzed the C&C command info and the associated APK. This command collects the\nclipboard data and verifies the victims’ device for the presence of a hardcoded list of\nmobile security products, may be with the aim of disabling them or forwarding the info to\nthe C2.\n\nFigure 12: Collects the clipboard information\n\n\n-----\n\nFigure 13: Checks for the presence of security related products\nThe structure of the commands sent from the C2 to victims’ device is as follows:\n\n\n-----\n\nFigure 14: Commands sent by C2\n\nAt K7, we protect all our customers from such threats. Do ensure that you protect your\nmobile devices with a reputable security product like K7 Mobile Security and also regularly\nupdate and scan your devices with it. Also keep your devices updated and patched against\nthe latest vulnerabilities.\n\n## Indicators of Compromise (IoCs)\n\n**Package Name** **Hash** **Detection Name**\n\ncom.appser.verapp 45c154af52c65087161b8d87e212435a Spyware ( 0056a7b31 )\n\n### URL\n\nhttps://irctc[.]creditmobile[.]site/irctcconnect[.]apk\n\n### C2\n\n154.61.76[.]99\n\nonline[.]spaxdriod[.]studio\n\n### MITRE ATT&CK\n\n**Tactics** **Techniques**\n\n\n-----\n\nDefense Evasion Application Discovery Obfuscated Files or Information,\nVirtualization/Sandbox Evasion\n\nDiscovery Security Software Discovery, System Information Discovery\n\nCollection Email Collection, Data from Local System\n\n\nCommand and\nControl\n\n\nEncrypted Channel, NonStandard Port\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-05-10 - spynote.pdf"
    ],
    "report_names": [
        "2023-05-10 - spynote.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1685930816,
    "ts_updated_at": 1743041161,
    "ts_creation_date": 1685883086,
    "ts_modification_date": 1685883086,
    "files": {
        "pdf": "https://archive.orkl.eu/d7012b26e33b1bf8dd11d5e6705c12d801fcea7c.pdf",
        "text": "https://archive.orkl.eu/d7012b26e33b1bf8dd11d5e6705c12d801fcea7c.txt",
        "img": "https://archive.orkl.eu/d7012b26e33b1bf8dd11d5e6705c12d801fcea7c.jpg"
    }
}