{
    "id": "a81c66db-88fb-43f8-a98d-5b62a8f1ffbc",
    "created_at": "2022-12-10T18:58:36.104198Z",
    "updated_at": "2025-03-27T02:06:11.110026Z",
    "deleted_at": null,
    "sha1_hash": "343a14f47d24c76d1a830b1670d6b22c1e349157",
    "title": "VISA BEST PRACTICES",
    "authors": "",
    "file_creation_date": "2015-03-30T11:51:42Z",
    "file_modification_date": "2015-03-30T11:51:42Z",
    "file_size": 330721,
    "plain_text": "# VISA SECURITY ALERT      March 2015\n\n “RAWPOS” MALWARE TARGETING LODGING MERCHANTS\n\n**Distribution: Merchants, Acquirers**\n\n**Summary**\n\nThe “rawpos” malware is a memory scraper infecting global lodging merchants at an alarming rate.\nVariants date as far back as 2008, and it is one of the first known memory scrapers to target Point of\nSale (POS) systems. Typically clustered in three files, there is no standard infection method for this\nmalware. Of particular note with recent samples is a logic bomb that does not function outside the\ntiming parameters. Adherence to PCI-DSS 3.0 should mitigate this malware.\n\n**Distribution and Installation**\n\nOnce a vulnerable POS system is identified, various components of the malware are used to discover\ntrack data by only targeting the “memdump” portion of a Windows system. A memory dump can be\nthe contents of memory on a system and where cardholder data temporarily resides during a payment\ntransaction. This particular malware piece can be compiled with Perl2Exe. Perl2Exe is a program that\ntakes codes scripted in the Perl language and bundles it into a Windows executable, which hides the\nPerl code. Numerous directories and file extensions are ignored. Any files not containing the ignored\ndirectories and file extensions are searched for track data using a regular expression similar to the\nformat listed below:\n\n((B(([0-9]{13,16})|([0-9]|\\\\s){13,25})\\\\^[A-Z\\\\s0-9]{0,30}\\\\/[A-Z\\\\s0-9]{0,30}\\\\^(0[7-9]|1[09])((0[1-9])|(1[0-2]))([0-9]|\\\\s){3,50}[0- 9]{1})|([0-9]{15,16}([A-Z]|=)(0[7-9]|1[0-9])((0[1-9])|(1[02]))[0-9]{8,30})|(<Field name=\\\"CardNumber\\\">[0-9]{15,19}</Field>)|(~CCM[0-9]{15,19}D[09]{4}~))\n\nDiscovered track data is encrypted with an XOR key, such as 'anonymousgroup'. This data is delimited\nwith the '$$$' character combination. Encrypted data can be written to a separate file, sometimes\nnamed “dxdiag32.dll”. Data is also dumped in clear-text to .dmp files on the victim system in the\n“memdump” directory. For example:\n\nmemdump\\\\<process_name>_<pid>.dmp\n\nA second file is also installed as a service by providing the '-install' or '/install' parameter. This creates a\npersistence mechanism which allows the scraper to continually run so long as the service is running.\nThe sample is installed with the following attributes:\n\nService Name: xxx XXXManager\nDisplay Name: xxx XXXManager\n\n\n-----\n\nExecutable Path:\nC:\\PROGRA~1\\xxx\\SECURE~1\\v1.2.0.3\\XXXPrimaryManager\\Bin\\XXXManagerService.exe\nStartup Type: Automatic\n\nAlternatively, the malware removes this service if the '-remove' or '/remove' argument is supplied. In\nthe event the '-debug' or '/debug' argument is provided, the malware will run in standalone mode. By\ndefault, the malware will attempt to start the service. When executed, the sample is responsible for\nexecuting the following commands on the victim host:\n\npushd\nC:\\\\PROGRA~1\\\\xxx\\\\Secure~1\\\\v1.2.0.3\\\\XXXPrimaryManager\\\\Bin&start /min\nxxxprimarymanager.exe&start /min xxxsecondarymanager.exe\n\nThe executable can also install itself in the System32 folder.\n\nAdditional files and hashes often coupled with “rawpos” include:\n\nmmc.exe\n\nvsssvc.exe\n\nvisaudp.exe\n\npsex.exe (aka “psexec”)\n\nsdelete.exe\n\nse.exe\n\nframepkg.exe\n\nspoolsv.chm\n\nWhile there is no common method of exfiltration associated with this malware family, infected\nmerchants observed payment card data sitting on non-POS systems, suggesting attackers stage the\nstolen data elsewhere on the network prior to exfiltration.\n\n**Best Practices**\n\nVisa requires participants in the payment ecosystem to comply with all [PCI-DSS requirements and](https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf)\nrecommends participants implement the following best practices:\n\n  - **Control the Windows Administrator account.** Make it more difficult for malware to gain\n\nAdministrative privileges.\n\n     - Assign a strong password for all accounts on the POS system.\n\n     - Create a unique local Administrator password for each and every POS system.\n\n     - Do not allow users to be local Administrators on a POS system.\n\n     - Change passwords frequently, across the enterprise (at least every 90 days).\n\n\n-----\n\n**y** **g** **p** **p**\nsoftware infections, disallow all applications and services (i.e. Internet browsers, email clients)\nthat are not directly required as part of the POS’s core functionality in processing payments.\n\n  - **Keep operating system patch levels up to date. For Windows, this means ensuring Windows**\n\nUpdate is functioning and automatically applying monthly security patches. For non-supported\noperating systems like Windows XP, there should be a plan to migrate to a current operating\nsystem.\n\n  - **Restrict permissions on Windows file sharing or disable file sharing altogether.** Unless\n\nabsolutely necessary, Visa recommends disabling file sharing on POS systems. Microsoft has\npublished instructions on how to [disable simple file sharing and set permissions on shared](http://support.microsoft.com/kb/307874)\nfolders.\n\n  - **Restrict remote access services use. Unless necessary, disable remote access services, ports**\n\nand accounts. If remote access services are needed, enable only when needed.\n\n  - **Promote security awareness. Design anti-phishing programs, defense in depth strategies, and**\n\npromote shared responsibility in security awareness.\n\n**Indicators**\n**MD5 Hash** **Function**\nbfb0eb8aacbf380cba9beb635557178a RAM scraper\n63b7cad5307a1927e16d7cd096b81831 RAM scraper\n52fd283903f0e44e3da3233f7ad894a9 Aggregates and encrypts track data\n0a06948f0eb5866216759ec69b315ced Persistence\n20c9388f45ff2d31754812a457ffbb0c Memory dumper\n\n**The following MD5 hashes are also linked to the indicators above:**\n\n  - 65375c1eb4683cbd2a868f99ac983b03\n\n  - 3f66583c8f67e7c255598d9d68394059\n\n  - ba9b109d929a643c831867cbc7459c4d\n\n  - 0c67494a4019264bceca488253610ef0\n\n  - 27d5c5f6f7b921c89ffb860d7e170b29\n\n  - 3ba5dafea1c447a2379811996f986006\n\n  - 4183e7fc2d9741c6039ba6eb357f57c3\n\n  - 5fa64cfcab7f4e95d6a55c2185a0515d\n\n  - ce0c7282e9116e1c46ee535c976e676e\n\n  - bd6c56097e107d12102c0df1136a96d1\n\n  - a3c0c081c4410b8ee1b68f0010ac3e45\n\n  - 7b61acc924ba4e5afa32e76afefe1e86\n\n  - 6c6de1c1e8e15574cb7e40cc7cc54536\n\n  - 65375c1eb4683cbd2a868f99ac983b03\n\n  - 19623ea25524a22c70a9b78059eba701\n\n  - 0b4b25c328af1fa348b8288043c704b7\n\n  - 3d0a57c178977781848533cb3038a087\n\n  - 65c44501369650db625043da125a4f0e\n\n|Indicators|Col2|\n|---|---|\n|MD5 Hash|Function|\n|bfb0eb8aacbf380cba9beb635557178a|RAM scraper|\n|63b7cad5307a1927e16d7cd096b81831|RAM scraper|\n|52fd283903f0e44e3da3233f7ad894a9|Aggregates and encrypts track data|\n|0a06948f0eb5866216759ec69b315ced|Persistence|\n|20c9388f45ff2d31754812a457ffbb0c|Memory dumper|\n\n\n\n- 91c40ca8c3aefa23e12755836220dfad\n\n\n-----\n\n- b075edd7288880e846414736a1f6b124\n\n\n\n- 281591ef0fa2ce3536621327d020d23f\n\n- 3004ce6cb7c44605cdf971b74db3a079\n\n- bf27e87187c045e402731cdaa8a62861\n\n- d770adbee04d14d6aa2f188247af16d0\n\n\n\n- a63d6203d1d7568868ebe7521406b057\n\n\n\n- fb9f8f1bee8b3fb47d7d84bb2286801d\n\n\n**Additional Resources**\nMicrosoft’s support for Windows XP ended in April 2014and will end in January 2016 for Windows XP\n[Embedded (XPe). Risk for POS applications built on these platforms will increase. See Microsoft](http://www.microsoft.com/en-us/windows/enterprise/endofsupport.aspx)\n[Windows XP Support lifecycle timeline for more details.](http://www.microsoft.com/en-us/windows/enterprise/endofsupport.aspx)\n\n**To report a data breach, contact Visa Fraud Control:**\n\n  - [Asia Pacific Region, Central Europe/Middle East/Africa Region: VIFraudControl@visa.com](mailto:VIFraudControl@visa.com)\n\n  - [Canada Region, Latin America Region, United States: USFraudControl@visa.com](mailto:USFraudControl@visa.com)\n\nFor other questions, please contact Visa Risk Management: cisp@visa.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        }
    ],
    "references": [
        "https://usa.visa.com/dam/VCOM/download/merchants/alert-rawpos.pdf"
    ],
    "report_names": [
        "alert-rawpos.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1670698716,
    "ts_updated_at": 1743041171,
    "ts_creation_date": 1427716302,
    "ts_modification_date": 1427716302,
    "files": {
        "pdf": "https://archive.orkl.eu/343a14f47d24c76d1a830b1670d6b22c1e349157.pdf",
        "text": "https://archive.orkl.eu/343a14f47d24c76d1a830b1670d6b22c1e349157.txt",
        "img": "https://archive.orkl.eu/343a14f47d24c76d1a830b1670d6b22c1e349157.jpg"
    }
}