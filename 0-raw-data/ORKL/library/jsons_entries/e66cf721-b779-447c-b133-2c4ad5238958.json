{
    "id": "e66cf721-b779-447c-b133-2c4ad5238958",
    "created_at": "2022-10-25T16:48:15.859541Z",
    "updated_at": "2025-03-27T02:16:13.967738Z",
    "deleted_at": null,
    "sha1_hash": "90e00bfc5d1611fcc42b7bdd4c840087ff84b8ce",
    "title": "PowerPoint Presentation",
    "authors": "",
    "file_creation_date": "2019-10-01T18:33:30Z",
    "file_modification_date": "2019-10-01T18:33:30Z",
    "file_size": 2911898,
    "plain_text": "# Abusing third-party cloud services in targeted attacks\n\n###### Daniel Lunghi (@thehellu), Jaromir Horejsi (@JaromirHorejsi)\n\n\n-----\n\n## Outline\n\n### • Introduction\n • General comparison of two malware infrastructures\n\n#### • Custom\n • Cloud based\n\n### • Selected APT cases\n\n#### • Presentation of the malware operation\n • Advantages and disadvantages from an attacker perspective\n\n### • Conclusion\n\n\n-----\n\n## Introduction\n\n### • Cloud services abuse is not something new\n\n#### • “C&C-as-a-Service” presentation at VB in 2015\n\n### • This talk focuses on cloud abuse in the context of targeted\n attacks that we investigated\n • Goals:\n\n#### • Show different real implementations of cloud abuse\n • Find how, as defenders, we can leverage this setup to our advantage\n\n\n-----\n\n## Custom malware infrastructure\n\n### • Developed and maintained by threat actor\n • Costly\n\n#### • Domain name(s), server(s) hosting, data storage, bandwidth …\n\n### • Time consuming\n\n#### • Design, implementation and testing of the communication protocol\n • Installation and maintenance of the C&C server(s)\n\n\n-----\n\n## Custom malware infrastructure\n\n### • Disadvantages\n\n#### • Easier to monitor/block/sinkhole/seize\n • Higher probability of flaws in the communication protocol\n • Difficult to assess the reliability in real conditions\n\n### • Advantage\n\n#### • You choose to implement whatever funny idea you like\n\n\n-----\n\n## Cloud malware infrastructure\n\n### • Advantages\n\n#### • Developed, maintained and operated by knowledgeable third party\n • Cheaper (often free)\n • API\n • Higher reliability\n • Harder to block/monitor/seize\n\n### • Disadvantage\n\n#### • Constrained by the features the cloud services provide\n\n\n-----\n\n# Selected APT cases\n\n\n-----\n\n## Patchwork\n\n\n##### Known targeted countries\n\n\n-----\n\n## Patchwork Badnews\n\n### • “Badnews” backdoor\n\n#### • A mix of both alternatives\n\n###### 3. Connect to C&C\n\n\n-----\n\n## Patchwork Badnews\n\n### • Hardcoded and encoded (sub 0x01) URL addresses\n\n\n-----\n\n## Patchwork Badnews\n\n### • Examples of encoded configuration\n\n\n-----\n\n## Patchwork Badnews\n\n### • Encryption uses XOR & ROL\n\n • Versions after November 2017 added a layer of blowfish\n\n encryption\n\n • C&C is usually a PHP script hosted in a web server without\n\n domain name\n\n\n-----\n\n## Patchwork Badnews\n\n\n#### 185.29.11.59\n\n 185.29.11.59\n\n rp3f.strangled.net\n\n\n-----\n\n## Patchwork Badnews\n\n\n-----\n\n## Confucius\n\n\n##### Known targeted countries\n\n\n-----\n\n## Confucius Swissknife\n\n### • “Swissknife” stealer\n\n#### • Uses Dropbox API to upload documents with selected extensions\n\n (.pdf, .doc, .docx, .ppt, .pptx, .xls, and .xlsx)\n\n\n-----\n\n## Confucius Swissknife\n\n### • API key in decompiled code\n\n\n-----\n\n## Confucius Swissknife\n\n### • File downloader in Python using Dropbox API\n\n\n-----\n\n## Confucius Swissknife\n\n### • Enumerating the deleted files\n\n\n-----\n\n## Confucius Swissknife\n\n### • Enumerating the deleted folders\n\n\n-----\n\n## Confucius pCloud\n\n### • “pCloud” stealer\n\n#### • Uses pCloud API to upload documents with selected extensions (.pdf,\n\n .doc, .docx, .ppt, .pptx, .xls, and .xlsx)\n\n\n-----\n\n## Confucius pCloud\n\n### • Using pCloud API to list files\n\n\n-----\n\n## Confucius pCloud\n\n\n-----\n\n## Confucius pCloud\n\n\n-----\n\n## Confucius pCloud\n\n### • Content from attacker’s machine\n\n\n-----\n\n## Confucius pCloud\n\n\n-----\n\n## Confucius TweetyChat\n\n### • “TweetyChat”, backdoored Android chat application\n\n###### 1. Register to C&C\n\n 3. Upload stolen files 2. Send commands\n\n awsAccessKey/awsSecretKey Update AWS credentials\n\n 3. Upload SMS, contacts, call logs\n\n\n-----\n\n## Confucius TweetyChat\n\n### • awsAccessKey and awsSecretKey are not hardcoded\n • AWS keys are updated through Google Cloud Messaging\n platform (Firebase Cloud Messaging in newer versions)\n\n\n-----\n\n## Confucius TweetyChat\n\n### • Google Cloud/ Firebase message receiver\n\n • Calling PutObjectRequest to “upload a new object to the\n specified Amazon S3 bucket”\n\n\n-----\n\n## Confucius TweetyChat\n\n\n-----\n\n## Confucius TweetyChat\n\n### • As usual, operators test the malware on their own devices…\n\n\n-----\n\n## MuddyWater\n\n\n##### Known targeted countries\n\n\n-----\n\n## MuddyWater CloudSTATS\n\n### • “CloudSTATS” backdoor\n\n###### 1. Register\n\n Put “.reg” file\n 2. Send command\n\n 3. Read command Put “.cmd” file\n\n 4. Send command results\n\n Put encoded “.res” file\n\n\n-----\n\n## MuddyWater CloudSTATS\n\n### • “CloudSTATS” backdoor\n\n\n-----\n\n## MuddyWater CloudSTATS\n\n### • “CloudSTATS” backdoor\n\n\n-----\n\n## MuddyWater CloudSTATS\n\n### • Hardcoded API keys\n\n#### • Check existing folder/victim\n\n\n-----\n\n## MuddyWater CloudSTATS\n\n### • Asynchronous C&C communication\n • Files with extensions (cmd, reg, prc, res)\n\n\n-----\n\n## MuddyWater CloudSTATS\n\n### • .reg file\n\n • .res file\n\n\n-----\n\n## MuddyWater Telegram\n\n### • Android mobile app, Telegram exfiltration\n\n###### 1. Register to C&C\n\n 3. Upload stolen information\n\n 2. Send commands BotID & ChatID\n\n\n-----\n\n## MuddyWater Telegram\n\n\n-----\n\n## MuddyWater Telegram\n\n### • .com.telegram.readto.client.ProcessCommand\n\n\n-----\n\n## MuddyWater Telegram\n\n### • Timer sending all data once a day\n\n • Code for exfiltration all system information\n\n\n-----\n\n## MuddyWater Telegram\n\n### • Metadata of the Telegram account\n\n\n-----\n\n## SLUB\n\n\n##### Country of interest\n\n\n-----\n\n## SLUB v1\n\n\n###### HTTPS request Send stolen files\n\n\n-----\n\n## SLUB v1\n\n### • Malware delivered via waterholing of websites related to\n North Korea\n • Read gist snippet for commands to execute\n • ^ and $ encapsulate active commands\n\n\n-----\n\n## SLUB v1/v2\n\n### • Hardcoded Slack token\n\n • Slack token’s o-auth scopes\n\n\n-----\n\n## SLUB v1/v2\n\n### • Exfiltration via file.io, link sent to Slack\n\n\n-----\n\n## SLUB v2\n\n### • Newer version from July 2019\n\n#### • GitHub is not used anymore\n • Operator creates a Slack workspace\n • A separate channel named <user_name>-<pc_name> is created in\n the workspace for each infected machine\n • Commands to execute sent via messages pinned to a victim-specific\n channel\n • Victim machine reads pinned messages from its dedicated channel,\n parses the message, and executes the requested command\n\n\n-----\n\n## SLUB v2\n\n\n###### HTTP request Check for new Slack token\n\n\n-----\n\n## SLUB v2\n\n### • Configuration update\n • New token between HELLO^, WHAT^ and !!! tokens\n\n\n-----\n\n## SLUB v1\n\n### • Gist revisions show activation of specific commands\n\n\n-----\n\n## SLUB v1/v2\n\n### • Using Slack API in Python\n\n\n-----\n\n## SLUB v2\n\n### • File & exec operations\n\n\n-----\n\n## SLUB v1/v2\n\n### • Screenshot upload\n\n • Screenshot download (using API key and path to the file)\n\n\n-----\n\n## SLUB v1\n\n\n-----\n\n# Conclusion\n\n\n-----\n\n## Conclusion\n\n### • Abusing cloud service providers is a worldwide trend\n\n • Such services can be used for different purposes:\n\n#### • To store a reference used by the malware (C&C …)\n\n • To store the stolen data\n\n • To store all the commands and data\n\n### • This behavior brings benefits not only to the attackers, but\n\n also to the defenders, and without the need to “hack back”\n \n\n\n### \n\n\n-----\n\n## References\n\n###### • Patchwork: https://blog.trendmicro.com/trendlabs-security-intelligence/untangling-the\n patchwork-cyberespionage-group/\n\n • Confucius: https://blog.trendmicro.com/trendlabs-security-intelligence/deciphering\n confucius-cyberespionage-operations/\n\n • MuddyWater: https://blog.trendmicro.com/trendlabs-security-intelligence/new\n powershell-based-backdoor-found-in-turkey-strikingly-similar-to-muddywater-tools/\n\n • https://blog.trendmicro.com/trendlabs-security-intelligence/muddywater-resurfaces-uses\n multi-stage-backdoor-powerstats-v3-and-new-post-exploitation-tools/\n\n • Slub v1: https://blog.trendmicro.com/trendlabs-security-intelligence/new-slub-backdoor\n uses-github-communicates-via-slack/\n\n\n\n###### • Slub v2: https://blog.trendmicro.com/trendlabs-security-intelligence/slub-gets-rid-of-\n\n\n-----\n\nThreats detected and blocked globally by\nTrend Micro in 2018. Created with real data\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.virusbulletin.com/uploads/pdf/conference_slides/2019/VB2019-LunghiHorejsi.pdf"
    ],
    "report_names": [
        "VB2019-LunghiHorejsi.pdf"
    ],
    "threat_actors": [
        {
            "id": "caf95a6f-2705-4293-9ee1-6b7ed9d9eb4c",
            "created_at": "2022-10-25T15:50:23.472432Z",
            "updated_at": "2025-03-27T02:00:55.479021Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [
                "Confucius",
                "Confucius APT"
            ],
            "source_name": "MITRE:Confucius",
            "tools": [
                "WarzoneRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2ed8d590-defa-4873-b2de-b75c9b30931e",
            "created_at": "2023-01-06T13:46:38.730137Z",
            "updated_at": "2025-03-27T02:00:02.903261Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "Boggy Serpens",
                "Mango Sandstorm",
                "TEMP.Zagros",
                "Static Kitten",
                "G0069",
                "TA450",
                "Earth Vetala",
                "Seedworm",
                "COBALT ULSTER",
                "ATK51"
            ],
            "source_name": "MISPGALAXY:MuddyWater",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7a8dbc5e-51a8-437a-8540-7dcb1cc110b8",
            "created_at": "2022-10-25T16:07:23.482856Z",
            "updated_at": "2025-03-27T02:02:09.827887Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [],
            "source_name": "ETDA:Confucius",
            "tools": [
                "ApacheStealer",
                "ByeByeShell",
                "ChatSpy",
                "Confucius",
                "MY24",
                "Sneepy",
                "remote-access-c3",
                "sctrls",
                "sip_telephone",
                "swissknife2"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "31e69945-6c1e-40c3-ba8e-a77e81dd142a",
            "created_at": "2024-05-01T02:03:08.047377Z",
            "updated_at": "2025-03-27T02:05:17.326452Z",
            "deleted_at": null,
            "main_name": "COBALT ULSTER",
            "aliases": [
                "ENT-11 ",
                "ITG17 ",
                "MERCURY ",
                "Mango Sandstorm ",
                "MuddyWater ",
                "STAC 1171 ",
                "Seedworm ",
                "Static Kitten ",
                "TEMP.Zagros ",
                "UNC3313 ",
                "Yellow Nix ",
                "Earth Vetala "
            ],
            "source_name": "Secureworks:COBALT ULSTER",
            "tools": [
                " Canopy",
                " CrackMapExec",
                " CredNinja",
                " Empire",
                " FORELORD",
                " Koadic",
                " LaZagne",
                " Ligolo",
                " MKL64",
                " Metasploit",
                " Mimikatz",
                " MiniDump",
                " Mori",
                " MuddyC2Go",
                " MuddyC3",
                " PhonyC2",
                " Plink",
                " PowGoop",
                " PowerStats",
                " RemoteUtilities",
                " Revsocks",
                " ScreenConnect",
                " SimpleHelp",
                " Small Sieve",
                " Syncro",
                " Venom Proxy",
                " WMIExec",
                "AnyDesk"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "02e1c2df-8abd-49b1-91d1-61bc733cf96b",
            "created_at": "2022-10-25T15:50:23.308924Z",
            "updated_at": "2025-03-27T02:00:55.437268Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "MuddyWater",
                "Earth Vetala",
                "Static Kitten",
                "Seedworm",
                "TEMP.Zagros",
                "Mango Sandstorm",
                "TA450"
            ],
            "source_name": "MITRE:MuddyWater",
            "tools": [
                "STARWHALE",
                "POWERSTATS",
                "Out1",
                "PowerSploit",
                "Small Sieve",
                "Mori",
                "Mimikatz",
                "LaZagne",
                "PowGoop",
                "CrackMapExec",
                "ConnectWise",
                "SHARPSTATS",
                "RemoteUtilities",
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3c430d71-ab2b-4588-820a-42dd6cfc39fb",
            "created_at": "2022-10-25T16:07:23.880522Z",
            "updated_at": "2025-03-27T02:02:10.010443Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "ATK 51",
                "Boggy Serpens",
                "Cobalt Ulster",
                "ITG17",
                "Mango Sandstorm",
                "MuddyWater",
                "Operation BlackWater",
                "Operation Earth Vetala",
                "Operation Quicksand",
                "Seedworm",
                "Static Kitten",
                "T-APT-14",
                "TA450",
                "TEMP.Zagros",
                "Yellow Nix"
            ],
            "source_name": "ETDA:MuddyWater",
            "tools": [
                "Agentemis",
                "BugSleep",
                "CLOUDSTATS",
                "ChromeCookiesView",
                "Cobalt Strike",
                "CobaltStrike",
                "CrackMapExec",
                "DELPHSTATS",
                "EmPyre",
                "EmpireProject",
                "FruityC2",
                "Koadic",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "MZCookiesView",
                "Meterpreter",
                "Mimikatz",
                "MuddyC2Go",
                "MuddyRot",
                "Mudwater",
                "POWERSTATS",
                "PRB-Backdoor",
                "PhonyC2",
                "PowGoop",
                "PowerShell Empire",
                "PowerSploit",
                "Powermud",
                "QUADAGENT",
                "SHARPSTATS",
                "SSF",
                "Secure Socket Funneling",
                "Shootback",
                "Smbmap",
                "Valyria",
                "chrome-passwords",
                "cobeacon",
                "prb_backdoor"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041773,
    "ts_creation_date": 1569954810,
    "ts_modification_date": 1569954810,
    "files": {
        "pdf": "https://archive.orkl.eu/90e00bfc5d1611fcc42b7bdd4c840087ff84b8ce.pdf",
        "text": "https://archive.orkl.eu/90e00bfc5d1611fcc42b7bdd4c840087ff84b8ce.txt",
        "img": "https://archive.orkl.eu/90e00bfc5d1611fcc42b7bdd4c840087ff84b8ce.jpg"
    }
}