{
    "id": "0c09d90a-99c6-4abb-9393-0a1bae2ba142",
    "created_at": "2023-01-12T15:07:02.914262Z",
    "updated_at": "2025-03-27T02:16:16.840911Z",
    "deleted_at": null,
    "sha1_hash": "57dd95f7b537da839076f1c93c34733493ee9cb5",
    "title": "2018-08-13 - KeyPass ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T15:37:23Z",
    "file_modification_date": "2022-05-28T15:37:23Z",
    "file_size": 1203890,
    "plain_text": "# KeyPass ransomware\n\n**securelist.com/keypass-ransomware/87412/**\n\n[Incidents](https://securelist.com/category/incidents/)\n\n[Incidents](https://securelist.com/category/incidents/)\n\n13 Aug 2018\n\nminute read\n\n\n-----\n\nAuthors\n\n[Orkhan Mamedov](https://securelist.com/author/orkhanmamedov/)\n\nFedor Sinitsyn\n\nIn the last few days, [our anti-ransomware module has been detecting a new variant of](https://www.kaspersky.com/enterprise-security/wiki-section/products/ransomware-protection)\nmalware – KeyPass ransomware. Others in the security community have also noticed that\nthis ransomware began to actively spread in August:\n\n_Notification from MalwareHunterTeam_\n\n## Distribution model\n\nAccording to our information, the malware is propagated by means of fake installers that\ndownload the ransomware module.\n\n## Description\n\nThe Trojan sample is written in C++ and compiled in MS Visual Studio. It was developed\nusing the libraries MFC, Boost and Crypto++. The PE header contains a recent compilation\ndate.\n\n\n-----\n\n_PE header with compilation date_\n\nWhen started on the victim’s computer, the Trojan copies its executable to %LocalAppData%\nand launches it. It then deletes itself from the original location.\n\nFollowing that, it spawns several copies of its own process, passing the encryption key and\nvictim ID as command line arguments.\n\n_Command line arguments_\n\nKeyPass enumerates local drives and network shares accessible from the infected machine\nand searches for all files, regardless of their extension. It skips files located in a number of\ndirectories, the paths to which are hardcoded into the sample.\n\n\n-----\n\n_The list of excluded paths_\n\nEvery encrypted file gets an additional extension: “.KEYPASS” and ransom notes named\n“”!!!KEYPASS_DECRYPTION_INFO!!!.txt”” are saved in each processed directory.\n\n\n-----\n\n_The ransom note_\n\n## Encryption scheme\n\nThe developers of this Trojan implemented a very simplistic scheme. The malware uses the\nsymmetric algorithm AES-256 in CFB mode with zero IV and the same 32-byte key for all\nfiles. The Trojan encrypts a maximum of 0x500000 bytes (~5 MB) of data at the beginning of\neach file.\n\n\n-----\n\n_Part of the procedure that implements data encryption_\n\nSoon after launch, KeyPass connects to its command and control (C&C) server and receives\nthe encryption key and the infection ID for the current victim. The data is transferred over\nplain HTTP in the form of JSON.\n\n\n-----\n\nIf the C&C is inaccessible (e.g. if the infected machine is not connected to the internet or the\nserver is down), the Trojan uses a hardcoded key and ID, which means that in the case of\noffline encryption the decryption of the victim’s files will be trivial.\n\n## GUI\n\nFrom our point of view, the most interesting feature of the KeyPass Trojan is the ability to\ntake ‘manual control’. The Trojan contains a form that is hidden by default, but which can be\nshown after pressing a special button on the keyboard. This capability might be an indication\nthat the criminals behind the Trojan intend to use it in manual attacks.\n\n\n-----\n\n_GUI of the trojan_\n\nThis form allows the attacker to customize the encryption process by changing such\nparameters as:\n\nencryption key\nname of ransom note\ntext of ransom note\nvictim ID\nextension of the encrypted files\nlist of paths to be excluded from the encryption\n\n\n-----\n\n_Paths excluded from encryption by default_\n\n_Pseudocode of the procedure that shows the GUI by a keypress_\n\n\n## Geography\n\n\n-----\n\n## IOC\n\n901d893f665c6f9741aa940e5f275952 – Trojan-Ransom.Win32.Encoder.n\n\nhxxp://cosonar.mcdir.ru/get.php\n\n[Encryption](https://securelist.com/tag/encryption/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Ransomware](https://securelist.com/tag/ransomware/)\n\nAuthors\n\n[Orkhan Mamedov](https://securelist.com/author/orkhanmamedov/)\n\nFedor Sinitsyn\n\nKeyPass ransomware\n\nYour email address will not be published. Required fields are marked *\n\nGReAT webinars\n\n\n-----\n\n13 May 2021, 1:00pm\n\n### GReAT Ideas. Balalaika Edition\n\n26 Feb 2021, 12:00pm\n17 Jun 2020, 1:00pm\n26 Aug 2020, 2:00pm\n22 Jul 2020, 2:00pm\nFrom the same authors\n\n### Evolution of JSWorm ransomware\n\n\n-----\n\n### RansomEXX Trojan attacks Linux systems\n\n Life of Maze ransomware\n\n\n-----\n\n### WastedLocker: technical analysis\n\n Sodin ransomware exploits Windows vulnerability and processor architecture\n\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----\n\nReports\n\n### APT trends report Q1 2022\n\nThis is our latest summary of advanced persistent threat (APT) activity, focusing on events\nthat we observed during Q1 2022.\n\n### Lazarus Trojanized DeFi app for delivering malware\n\nWe recently discovered a Trojanized DeFi application that was compiled in November 2021.\nThis application contains a legitimate program called DeFi Wallet that saves and manages a\ncryptocurrency wallet, but also implants a full-featured backdoor.\n\n### MoonBounce: the dark side of UEFI firmware\n\n\n-----\n\nAt the end of 2021, we inspected UEFI firmware that was tampered with to embed a\nmalicious code we dub MoonBounce. In this report we describe how the MoonBounce\nimplant works and how it is connected to APT41.\n\n### The BlueNoroff cryptocurrency hunt is still on\n\nIt appears that BlueNoroff shifted focus from hitting banks and SWIFT-connected servers to\nsolely cryptocurrency businesses as the main source of the group’s illegal income.\n\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-08-13 - KeyPass ransomware.pdf"
    ],
    "report_names": [
        "2018-08-13 - KeyPass ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "1bdb91cf-f1a6-4bed-8cfa-c7ea1b635ebd",
            "created_at": "2022-10-25T16:07:23.766784Z",
            "updated_at": "2025-03-27T02:02:09.971636Z",
            "deleted_at": null,
            "main_name": "Bluenoroff",
            "aliases": [
                "APT 38",
                "ATK 117",
                "Alluring Pisces",
                "Black Alicanto",
                "Bluenoroff",
                "CTG-6459",
                "Copernicium",
                "Nickel Gladstone",
                "Sapphire Sleet",
                "Selective Pisces",
                "Stardust Chollima",
                "T-APT-15",
                "TA444",
                "TAG-71",
                "TEMP.Hermit"
            ],
            "source_name": "ETDA:Bluenoroff",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bfae615f-cb9c-479c-b97d-ba282c322db3",
            "created_at": "2022-10-25T16:07:24.123308Z",
            "updated_at": "2025-03-27T02:02:10.115804Z",
            "deleted_at": null,
            "main_name": "RevengeHotels",
            "aliases": [],
            "source_name": "ETDA:RevengeHotels",
            "tools": [
                "888 RAT",
                "Atros2.CKPN",
                "Bladabindi",
                "Jorik",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "Revenge RAT",
                "RevengeRAT",
                "Revetrat",
                "Zurten",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f426f0a0-faef-4c0e-bcf8-88974116c9d0",
            "created_at": "2022-10-25T15:50:23.240383Z",
            "updated_at": "2025-03-27T02:00:55.404232Z",
            "deleted_at": null,
            "main_name": "APT38",
            "aliases": [
                "APT38",
                "NICKEL GLADSTONE",
                "BeagleBoyz",
                "Bluenoroff",
                "Stardust Chollima",
                "Sapphire Sleet",
                "COPERNICIUM"
            ],
            "source_name": "MITRE:APT38",
            "tools": [
                "ECCENTRICBANDWAGON",
                "HOPLIGHT",
                "Mimikatz",
                "KillDisk",
                "DarkComet"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536022,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1653752243,
    "ts_modification_date": 1653752243,
    "files": {
        "pdf": "https://archive.orkl.eu/57dd95f7b537da839076f1c93c34733493ee9cb5.pdf",
        "text": "https://archive.orkl.eu/57dd95f7b537da839076f1c93c34733493ee9cb5.txt",
        "img": "https://archive.orkl.eu/57dd95f7b537da839076f1c93c34733493ee9cb5.jpg"
    }
}