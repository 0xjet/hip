{
    "id": "bf53cba2-3837-4ec1-8419-11b3a9c2405b",
    "created_at": "2023-01-12T15:03:00.498598Z",
    "updated_at": "2025-03-27T02:16:39.912752Z",
    "deleted_at": null,
    "sha1_hash": "cd2746f0441708c761375dabff21927db15ce29d",
    "title": "2020-08-19 - Responder-MultiRelay",
    "authors": "",
    "file_creation_date": "2022-05-28T01:21:46Z",
    "file_modification_date": "2022-05-28T01:21:46Z",
    "file_size": 149899,
    "plain_text": "# Responder/MultiRelay\n\n**github.com/lgandx/Responder**\n\nlgandx\n\nThis branch is 249 commits ahead, 2 commits behind SpiderLabs/Responder:master.\n\n[#199](https://github.com/lgandx/Responder/pull/199)\n\nIPv6/IPv4 LLMNR/NBT-NS/mDNS Poisoner and NTLMv1/2 Relay.\n\n[Author: Laurent Gaffie <laurent.gaffie@gmail.com >](http://10.10.0.46/mailto:laurent.gaffie@gmail.com) https://glaurent.blogspot.com\n\n## Intro\n\nResponder is an LLMNR, NBT-NS and MDNS poisoner.\n\n## Features\n\nDual IPv6/IPv4 stack.\n\nBuilt-in SMB Auth server.\n\nSupports NTLMv1, NTLMv2 hashes with Extended Security NTLMSSP by\ndefault. Successfully tested from Windows 95 to Server 2022, Samba and Mac\nOSX Lion. Clear text password is supported for NT4, and LM hashing\n\n\n-----\n\ndowngrade when the --lm option is set. If --disable-ess is set, extended session\nsecurity will be disabled for NTLMv1 authentication. SMBv2 has also been\nimplemented and is supported by default.\n\nBuilt-in MSSQL Auth server.\n\nThis server supports NTLMv1, LMv2 hashes. This functionality was\nsuccessfully tested on Windows SQL Server 2005, 2008, 2012, 2019.\n\nBuilt-in HTTP Auth server.\n\nThis server supports NTLMv1, NTLMv2 hashes and Basic Authentication. This\nserver was successfully tested on IE 6 to IE 11, Edge, Firefox, Chrome, Safari.\n\nNote: This module also works for WebDav NTLM authentication issued from\nWindows WebDav clients (WebClient). You can now send your custom files to\na victim.\n\nBuilt-in HTTPS Auth server.\n\nSame as above. The folder certs/ contains 2 default keys, including a\ndummy private key. This is intentional, the purpose is to have Responder\nworking out of the box. A script was added in case you need to generate your\nown self signed key pair.\n\nBuilt-in LDAP Auth server.\n\nThis server supports NTLMSSP hashes and Simple Authentication (clear text\nauthentication). This server was successfully tested on Windows Support tool\n\"ldp\" and LdapAdmin.\n\nBuilt-in DCE-RPC Auth server.\n\nThis server supports NTLMSSP hashes. This server was successfully tested\non Windows XP to Server 2019.\n\nBuilt-in FTP, POP3, IMAP, SMTP Auth servers.\n\nThis modules will collect clear text credentials.\n\nBuilt-in DNS server.\n\nThis server will answer type SRV and A queries. This is really handy when it's\ncombined with ARP spoofing.\n\nBuilt-in WPAD Proxy Server.\n\n\n-----\n\nThis module will capture all HTTP requests from anyone launching Internet\nExplorer on the network if they have \"Auto-detect settings\" enabled. This\nmodule is highly effective. You can configure your custom PAC script in\nResponder.conf and inject HTML into the server's responses. See\nResponder.conf.\n\nBrowser Listener\n\nThis module allows to find the PDC in stealth mode.\n\nIcmp Redirect\n\npython tools/Icmp-Redirect.py\n\nFor MITM on Windows XP/2003 and earlier Domain members. This attack\ncombined with the DNS module is pretty effective.\n\nRogue DHCP\n\npython tools/DHCP.py\n\nDHCP Inform Spoofing. Allows you to let the real DHCP Server issue IP\naddresses, and then send a DHCP Inform answer to set your IP address as a\nprimary DNS server, and your own WPAD URL. To inject a DNS server,\ndomain, route on all Windows version and any linux box, use -R\n\nAnalyze mode.\n\nThis module allows you to see NBT-NS, BROWSER, LLMNR, DNS requests\non the network without poisoning any responses. Also, you can map domains,\nMSSQL servers, workstations passively, see if ICMP Redirects attacks are\nplausible on your subnet.\n\n## Hashes\n\nAll hashes are printed to stdout and dumped in a unique John Jumbo compliant\nfile, using this format:\n```\n(MODULE_NAME)-(HASH_TYPE)-(CLIENT_IP).txt\n\n```\nLog files are located in the \"logs/\" folder. Hashes will be logged and printed\nonly once per user per hash type, unless you are using the Verbose mode (-v).\n\nResponder will log all its activity to Responder-Session.log\nAnalyze mode will be logged to Analyzer-Session.log\nPoisoning will be logged to Poisoners-Session.log\n\n\n-----\n\nAdditionally, all captured hashed are logged into an SQLite database which you\ncan configure in Responder.conf\n\n## Considerations\n\nThis tool listens on several ports: UDP 137, UDP 138, UDP 53, UDP/TCP\n389,TCP 1433, UDP 1434, TCP 80, TCP 135, TCP 139, TCP 445, TCP\n21, TCP 3141,TCP 25, TCP 110, TCP 587, TCP 3128, Multicast UDP\n5355 and 5353.\n\nIf you run Samba on your system, stop smbd and nmbd and all other\nservices listening on these ports.\n\nFor Ubuntu users:\n\nEdit this file /etc/NetworkManager/NetworkManager.conf and comment the line:\n```\ndns=dnsmasq . Then kill dnsmasq with this command (as root): killall\ndnsmasq -9\n\n```\nAny rogue server can be turned off in Responder.conf.\n\nThis tool is not meant to work on Windows.\n\nFor OSX, please note: Responder must be launched with an IP address\nfor the -i flag (e.g. -i YOUR_IP_ADDR). There is no native support in OSX\nfor custom interface binding. Using -i en1 will not work. Also to run\nResponder with the best experience, run the following as root:\n\nlaunchctl unload\n/System/Library/LaunchDaemons/com.apple.Kerberos.kdc.plist\n\nlaunchctl unload\n/System/Library/LaunchDaemons/com.apple.mDNSResponder.plist\n\nlaunchctl unload /System/Library/LaunchDaemons/com.apple.smbd.plist\n\nlaunchctl unload\n/System/Library/LaunchDaemons/com.apple.netbiosd.plist\n\n## Usage\n\nFirst of all, please take a look at Responder.conf and tweak it for your needs.\n\nRunning the tool:\n```\n./Responder.py [options]\n\n```\n\n-----\n\nTypical Usage Example:\n```\n./Responder.py -I eth0 -Pv\n\n```\nOptions:\n```\n--version       show program's version number and exit\n-h, --help      show this help message and exit\n-A, --analyze     Analyze mode. This option allows you to see NBT-NS,\n          BROWSER, LLMNR requests without responding.\n-I eth0, --interface=eth0\n          Network interface to use, you can use 'ALL' as a\n          wildcard for all interfaces\n-i 10.0.0.21, --ip=10.0.0.21\n          Local IP to use (only for OSX)\n-6 2002:c0a8:f7:1:3ba8:aceb:b1a9:81ed, -externalip6=2002:c0a8:f7:1:3ba8:aceb:b1a9:81ed\n          Poison all requests with another IPv6 address than\n          Responder's one.\n-e 10.0.0.22, --externalip=10.0.0.22\n          Poison all requests with another IP address than\n          Responder's one.\n-b, --basic      Return a Basic HTTP authentication. Default: NTLM\n-d, --DHCP      Enable answers for DHCP broadcast requests. This\n          option will inject a WPAD server in the DHCP\nresponse.\n          Default: False\n-D, --DHCP-DNS    This option will inject a DNS server in the DHCP\n          response, otherwise a WPAD server will be added.\n          Default: False\n-w, --wpad      Start the WPAD rogue proxy server. Default value is\n          False\n-u UPSTREAM_PROXY, --upstream-proxy=UPSTREAM_PROXY\n          Upstream HTTP proxy used by the rogue WPAD Proxy for\n          outgoing requests (format: host:port)\n-F, --ForceWpadAuth  Force NTLM/Basic authentication on wpad.dat file\n          retrieval. This may cause a login prompt. Default:\n          False\n-P, --ProxyAuth    Force NTLM (transparently)/Basic (prompt)\n          authentication for the proxy. WPAD doesn't need to be\n          ON. Default: False\n--lm         Force LM hashing downgrade for Windows XP/2003 and\n          earlier. Default: False\n--disable-ess     Force ESS downgrade. Default: False\n-v, --verbose     Increase verbosity.\n\n## Donation\n\n```\nYou can contribute to this project by donating to the following $XLM (Stellar\nLumens) address:\n\n\"GCGBMO772FRLU6V4NDUKIEXEFNVSP774H2TVYQ3WWHK4TEKYUUTLUKUH\"\n\n\n-----\n\nPaypal:\n\n[https://paypal.me/PythonResponder](https://paypal.me/PythonResponder)\n\nPatreon:\n\n[https://www.patreon.com/PythonResponder](https://www.patreon.com/PythonResponder)\n\n## Acknowledgments\n\nLate Responder development has been possible because of the donations\nreceived from individuals and companies.\n\nWe would like to thanks those major sponsors:\n\nSecureWorks: [https://www.secureworks.com/](https://www.secureworks.com/)\n\nSynacktiv: [https://www.synacktiv.com/](https://www.synacktiv.com/)\n\n[Black Hills Information Security: http://www.blackhillsinfosec.com/](http://www.blackhillsinfosec.com/)\n\n[TrustedSec: https://www.trustedsec.com/](https://www.trustedsec.com/)\n\n[Red Siege Information Security: https://www.redsiege.com/](https://www.redsiege.com/)\n\nOpen-Sec: [http://www.open-sec.com/](http://www.open-sec.com/)\n\nAnd all, ALL the pentesters around the world who donated to this project.\n\nThank you.\n\n## Copyright\n\nNBT-NS/LLMNR Responder\n\nResponder, a network take-over set of tools created and maintained by Laurent\nGaffie.\n\n[email: laurent.gaffie@gmail.com](http://10.10.0.46/mailto:laurent.gaffie@gmail.com)\n\nThis program is free software: you can redistribute it and/or modify it under the\nterms of the GNU General Public License as published by the Free Software\nFoundation, either version 3 of the License, or (at your option) any later\nversion.\n\n\n-----\n\nThis program is distributed in the hope that it will be useful, but WITHOUT ANY\nWARRANTY; without even the implied warranty of MERCHANTABILITY or\nFITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public\nLicense for more details.\n\nYou should have received a copy of the GNU General Public License along\nwith this program. If not, see [http://www.gnu.org/licenses/.](http://www.gnu.org/licenses/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-08-19 - Responder-MultiRelay.pdf"
    ],
    "report_names": [
        "2020-08-19 - Responder-MultiRelay.pdf"
    ],
    "threat_actors": [
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535780,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1653700906,
    "ts_modification_date": 1653700906,
    "files": {
        "pdf": "https://archive.orkl.eu/cd2746f0441708c761375dabff21927db15ce29d.pdf",
        "text": "https://archive.orkl.eu/cd2746f0441708c761375dabff21927db15ce29d.txt",
        "img": "https://archive.orkl.eu/cd2746f0441708c761375dabff21927db15ce29d.jpg"
    }
}