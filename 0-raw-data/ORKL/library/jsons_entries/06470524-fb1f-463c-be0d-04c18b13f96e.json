{
    "id": "06470524-fb1f-463c-be0d-04c18b13f96e",
    "created_at": "2023-01-12T15:02:35.607473Z",
    "updated_at": "2025-03-27T02:08:40.209713Z",
    "deleted_at": null,
    "sha1_hash": "7fd19afc2ac99be1a2ab583c2f456a2ad2e4a2f8",
    "title": "2016-09-22 - Book of Eli- African targeted attacks",
    "authors": "",
    "file_creation_date": "2022-05-27T22:35:27Z",
    "file_modification_date": "2022-05-27T22:35:27Z",
    "file_size": 351733,
    "plain_text": "# Book of Eli: African targeted attacks\n\n**welivesecurity.com/2016/09/22/libya-malware-analysis/**\n\nSeptember 22, 2016\n\nESET's latest research analyzes a piece of malware active since 2012, but which has\ntargeted one specific country – Libya.\n\n[Anton Cherepanov](https://www.welivesecurity.com/author/acherepanov/)\n22 Sep 2016 - 02:06PM\n\nESET’s latest research analyzes a piece of malware active since 2012, but which has\ntargeted one specific country – Libya.\n\n\n-----\n\nThis blog post describes details that we discovered during our analysis of malware that\nfocuses on a specific country — Libya. The malware has existed since at least 2012,\nwith threat actors using it for mass-spreading malware campaigns and for ongoing targeted\nattacks.\n\nDespite the lack of sophistication of the technical details of the malware and its\nmechanisms for spreading, the threat actors have demonstrated ability to compromise\ngovernmental websites successfully. This, combined with its focus on a specific region,\nmakes this threat interesting from the malware researchers’ perspective.\n\n## Spreading mechanism\n\nDuring our research we observed that for mass-spreading malware campaigns, these\nattackers tend to compromise profiles in social networks such as Facebook or Twitter and\npost links there that lead to malware downloads. Figure 1 demonstrates an example of a\nFacebook post from 2013. The post is written in Libyan Arabic and says that the Prime\nMinister has been captured twice, this time in a library. This short text message is followed\nby a link to a compromised governmental website that served malware at that time.\n\nFigure 1. Facebook post with malware download link\n\nFigure 2 illustrates an example of a post with a malicious link by a Twitter user’s profile,\n[which impersonates Saif Gaddafi‘s account.](https://en.wikipedia.org/wiki/Saif_al-Islam_Gaddafi)\n\n\n-----\n\nFigure 2. Twitter post with malware download link\n\nIn addition to mass-spreading campaigns, attackers are conducting targeted attacks by\nsending spear phishing emails with malicious attachments. In order to convince the\nintended victim to execute a malicious binary, standard social engineering tricks are\nimplemented, such as MS Word and PDF icons of executables and double file extensions\nsuch as .pdf.exe in the filename. In some cases the malware may display a decoy\ndocument.\n\nTo help attackers to identify specific infections or attempts at infection, the malware contains\na special text string that we name Campaign ID. Here is list of Campaign IDs that we\nidentified during our research:\n\nbook of eli – اﺧﺘﺮاق ﻛﻠﻤﺎت ﺳﺮ ﻣﻮزﯾﻼ\nOP_SYSTEM_\nOP_NEW_WORLD\nOP_TRAV_L\nahmed\nop_travel\nop_ ahha\nop_russia\nop_russia_new\nop_russia_old\nkarama\n\n## Technical details\n\n\n-----\n\nThe malware is written using the .NET Framework; the source code is not obfuscated.\nSome samples of the malware contain PDB-paths that reveal the original name of the\nmalware used by its authors and possible targets.\n\nFigure 3. The PDB-path discovered inside the malware\n\nThe malware is a classic information stealer Trojan that attempts to collect various\ninformation. It can be deployed in various configurations. The full-featured version of the\nmalware can log keystrokes, collect profile files of Mozilla Firefox and Google Chrome\nbrowsers, record sound from the microphone, grab desktop screenshots, capture photo\nfrom the webcam, and collect information about the version of the operation system and\ninstalled anti-virus software. In some cases the malware can download and execute thirdparty password recovery tools in order to try to collect saved passwords from installed\napplications.\n\nMost of the analyzed samples of the malware use the SMTP protocol to exfiltrate data to\nspecific email addresses. Figure 4 shows the decompiled function make_email_mozela,\nwhich is used by the malware to collect and send Mozilla Firefox profile files.\n\nFigure 4. Decompiled malware code that contains SMTP credentials\n\nSince the code in the majority of the samples contains the same destination address, this\nsuggests that the malware is used exclusively by one individual or group of people.\n\nAlternatively, the malware can upload stolen information directly to its C&C server using\nHTTP communication.\n\n\n-----\n\nFigure 5. Decompiled malware code that is used to upload stolen data\n\nAs is evident in Figure 5, the malware connects to the worldconnection[.]ly server and\nuploads data using a PHP script. The domain name was registered in June 2016; the server\nused by the malware is located in Libya.\n\n## Conclusion\n\nWe analyzed a piece of malware that was active since at least 2012 in a specific region.\nThe cyberthreat actors behind the malware used it for mass-spreading in the past and it\nshould be noted that it is still being used in spearphishing attacks.\n\n## Indicators of Compromise (IoC)\n\n**ESET detection names:**\n\nMSIL/Spy.Agent.GZ trojan\n\nMSIL/Spy.Agent.HF trojan\n\nMSIL/PSW.Agent.OMN trojan\n\nMSIL/PSW.Agent.PRH trojan\n\nMSIL/Spy.Agent.APJ trojan\n\n**SHA-1 hashes:**\n\n3888DCE3D1CA295B76248DBA3609955D7375D749\n\nD62BF2D5E6683046396E94479B0321E319577F69\n\n2F1618B710856AF3D0AC6C899393ACEED8B9942D\n\n7AF0EC7B2F0B6F298CDA5BD22DEAB704D1DB2009\n\n685E7408BEA30F73840542474F96F48AD0DD1EFC\n\n1595C89C561F90ADFF6ED2E6F0402D14A31F2DFA\n\n6357DA647E21478AF836E9051F5E54E0357A9A87\n\nE1D1B3AD6A2987AFFCA57FDC170BF9DDB54A1D2F\n\n5AF6CF0D8BBEC98818E12880CE9B98F184ED7C66\n\nAEF20AB97D1B4B3C12B4B1F866916722C68ED138\n\n3E512302FF688FB89D4973D60BEB93FF642CD83C\n\n924A1E1B355BEA6575231B22BBFF2D5F749BD7D3\n\n6BA47F0D09BB202B4CC3FB5FEC54022C3F2319B4\n\n\n-----\n\n9B235EF9F2722EE26892E4287AF28FD98F4A6E4C\n970EA2AF3F6CB49B5D964107887EE48A24FC7912\n437A5ED4F2C2E55F4CFA2C55C32ADF084FF634B4\n554958EECDFF4E9AC2325169EF8E3F23D4AD851F\n9016597DE1917D78441A3FF72DB5A3848FA7A771\n59092A314A87370BAF0A06F679771E7D8477104A\nE4E86A2F3542591CFBF1FD340B78710370085163\n9846604F0DD2DD97646B348F2F0A2DD0D40E4B8A\n51C784B037DC69A4465A26573D23AEBC274969BC\n309A9FB5FBDD30142F42994F95E7453F8834BDC1\n87B458153445BD93482F15C28CA2ED2194FB92BF\n39AC510C9E2BB8F0AE4C9F2F653E66B58C975868\n95D38E48C5427E10707747585A3B852F1F7DE08D\n19F34B7A444998836A1C99CDA3C9853502CF5212\n666766B1745232FE9B76AAB3F7ABFA222DD2AA0F\nE93F6BB3A56A5384F79BEBA1F4642E1B1C1C21A2\n1F8105D947203D405A7DD76BA32B20FCD8E20BF4\nDDB9D2219876D59DFD3A207E54DB8956D6864A52\n447AD86417769AA19C8B07AFB2B113039316814F\n11507252AC4BF28B57A538BFA85F9F7574256E6C\nEFD07AF61B16C6FD55F64FCB785522C049A935CD\nE855F9428813E59D52BFB79E6F779452A77CBCBE\n999D51F3455B86E673586F77A19E5871BBAA1236\n4A0DC693E87613D869332EB890E0F533AF404D25\n9CB3DC18E0033A381691FDBE798516FB2B857B01\n9E595794C8C413C83EF075B7895D0F0EFB72A39F\n\n**C2 servers:**\n\nhxxp://mndooma.com/book_of_eli.php\nhxxp://worldconnection.ly/book_of_eli.php\n\n**SMTP servers:**\n\nmail.sooq-libya.com\nmail.worldconnection.ly\n\n22 Sep 2016 - 02:06PM\n\n## Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n\n-----\n\n## Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-09-22 - Book of Eli- African targeted attacks.pdf"
    ],
    "report_names": [
        "2016-09-22 - Book of Eli- African targeted attacks.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535755,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653690927,
    "ts_modification_date": 1653690927,
    "files": {
        "pdf": "https://archive.orkl.eu/7fd19afc2ac99be1a2ab583c2f456a2ad2e4a2f8.pdf",
        "text": "https://archive.orkl.eu/7fd19afc2ac99be1a2ab583c2f456a2ad2e4a2f8.txt",
        "img": "https://archive.orkl.eu/7fd19afc2ac99be1a2ab583c2f456a2ad2e4a2f8.jpg"
    }
}