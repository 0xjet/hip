{
    "id": "3a88d09d-5153-4091-b2ec-ee25a71752b1",
    "created_at": "2023-01-12T15:04:53.297177Z",
    "updated_at": "2025-03-27T02:15:27.709615Z",
    "deleted_at": null,
    "sha1_hash": "889149e62073cc03110336f3802304a7c79c0eb7",
    "title": "2022-01-28 - Malware Headliners- LokiBot",
    "authors": "",
    "file_creation_date": "2022-05-29T10:35:53Z",
    "file_modification_date": "2022-05-29T10:35:53Z",
    "file_size": 1205438,
    "plain_text": "# Malware Headliners: LokiBot\n\n**atomicmatryoshka.com/post/malware-headliners-lokibot**\n\nz3r0day_504 January 28, 2022\n\nLokiBot, or Loki, is a password stealing malware and was considered the 8th most prevalent\nmalware family in 2021 according to MalwareBazaar. Available for sale on underground\nforums, its within reach of anyone willing to pay the right price. As far as its use by organized\nactors, [MITRE has linked its usage to the SilverTerrier threat group, known for having](https://attack.mitre.org/groups/G0083/)\nfinancial cybercrime motives.\n\nIn this blog post we'll conduct some static and dynamic analysis on a LokiBot sample to\nextract IOCs and characterize its behavior.\n\n## STATIC ANALYSIS WITH PESTUDIO 9.27\n\nUsing the latest version of PeStudio, we start to build a picture of what the specimen is\ncapable of. Taking a look at the imports/functions category, we see the following:\n\n\n-----\n\nBased on the imports, this sample shows potentially:\n\nAnti-debugging capabilities (EmptyClipboard, GetTickCount)\n\nParsing through files and folders (FindFirstFileA, FindNextFileA, SearchPath,\nCreateFileA)\n\nEvasive behaviors/artifact destruction (DeleteFile, RemoveDirectory)\n\nFile writing (CreateFileA, WriteFile, MoveFile)\n\nRegistry interactions (RegCreateKey, RegDeleteKey, RegEnumKey, RegOpenKey,\nRegSetValue, RegQueryValue)\n\nLooking at the strings tab, we see a lot of the same references to the API calls, especially if\nsorting for blacklist items to show first:\n\n\n-----\n\nOutside of those, nothing is proving to be too conclusive here.\n\nI pushed the file over to REMnux to give a stab at it with capa. Capa gave the following\noutput:\n\nIn order to analyze further with capa, I'll need to dump the actual malware executable once it\nstarts running during the dynamic analysis stage and rebuild it. I'll have those details after the\ndynamic analysis section.\n\n## DYNAMIC ANALYSIS\n\n\n-----\n\nPrior to detonating the sample, I had Process Hacker, Process Monitor, and WireShark\nrunning to capture any events. I was able to capture the following data:\n\nThe memory strings in Process Hacker offered some IOCs. We see a domain\n(s442136.smrtp[.]ru) as well as some registry interactions.\n\nProcess Monitor offered the following:\n\n\n-----\n\nWe see a ton of \"CreateFile\" operations with browser file paths. It would be easy to be misled\nby the fact that the operation title is \"CreateFile\" and believe that the executable is\nattempting to generate files on the victim system. Reading Microsoft documentation offers\nsome more context:\n\nNot only does this function allow for the creation of files, but also opening them. On the right\nside of the Process Monitor screenshot we see the value \"path not found,\" meaning that the\nmalware tried to open or access the browser file paths and they did not exist. Being that the\nmalware is a password stealer, it is likely checking these file paths for saved credentials.\n\nSeeing the WireShark output, we see information that corroborates earlier findings:\n\n\n-----\n\n## REBUILDING WITH SCYLLA\n\nSo like I mentioned early on, the initial file is an installer and not the actual child process that\nwe've analyzed in the dynamic stage. I'll demonstrate how one could actually get a \"tangible\"\nversion of the malware that's executing to then analyze it with tools like capa. The tool we'll\n[be using is Scylla, and imports reconstructor developed by NtQuery and available on GitHub.](https://github.com/NtQuery/Scylla)\n\nFirst, make sure the malware is already running. Next open Scylla x86 and attach it to the\nactive process. Click \"IAT autosearch,\" and then \"get imports,\" followed by \"dump.\" Name it\nsomething intuitive, and voila. This will reconstruct the executable.\n\n\n-----\n\nI pushed this version back over to the REMnux box for analysis, and it worked fine with capa:\n\n\n-----\n\nWe can also feed this new executable back into PEStudio for its new assessment:\n\nAn interesting catch that I didn't catch before is the reference in strings to SQLite. A lot of\nbrowsers saved passwords in SQLite databases which, if we didn't know what this was\nahead of time, we could safely lean towards it being a browser password stealer.\n\n## IOCs\n\n**File Hashes:**\n\nInstaller:\n\nc27e339893d3e5fc1e61e73ffafac8a7bcf76813a92f91ecfa38535210d6c7a7\n\n\n-----\n\nDropped executable:\n71e155ee000c0d1cbba18b92f0d512217afe195ba40f9326c60523cdfd3fa742\n\n**Domains:**\n\ns442136.smrtp[.]ru\n\nREFERENCES:\n\n[LokiBot Malware (CISA)](https://www.cisa.gov/uscert/ncas/alerts/aa20-266a)\n\n[New Campaign Sees LokiBot Delivered Via Multiple Methods (TrendMicro)](https://www.trendmicro.com/en_us/research/21/h/new-campaign-sees-lokibot-delivered-via-multiple-methods.html)\n\nScylla\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-28 - Malware Headliners- LokiBot.pdf"
    ],
    "report_names": [
        "2022-01-28 - Malware Headliners- LokiBot.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa57c036-b3e5-4bc4-83b8-cac8498b6c24",
            "created_at": "2023-01-06T13:46:38.589041Z",
            "updated_at": "2025-03-27T02:00:02.867594Z",
            "deleted_at": null,
            "main_name": "SilverTerrier",
            "aliases": [],
            "source_name": "MISPGALAXY:SilverTerrier",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ecff5c60-4f8b-4d7c-9784-f279eb056518",
            "created_at": "2022-10-25T15:50:23.49538Z",
            "updated_at": "2025-03-27T02:00:55.485485Z",
            "deleted_at": null,
            "main_name": "SilverTerrier",
            "aliases": [
                "SilverTerrier"
            ],
            "source_name": "MITRE:SilverTerrier",
            "tools": [
                "NanoCore",
                "Agent Tesla",
                "NETWIRE",
                "DarkComet",
                "Lokibot"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535893,
    "ts_updated_at": 1743041727,
    "ts_creation_date": 1653820553,
    "ts_modification_date": 1653820553,
    "files": {
        "pdf": "https://archive.orkl.eu/889149e62073cc03110336f3802304a7c79c0eb7.pdf",
        "text": "https://archive.orkl.eu/889149e62073cc03110336f3802304a7c79c0eb7.txt",
        "img": "https://archive.orkl.eu/889149e62073cc03110336f3802304a7c79c0eb7.jpg"
    }
}