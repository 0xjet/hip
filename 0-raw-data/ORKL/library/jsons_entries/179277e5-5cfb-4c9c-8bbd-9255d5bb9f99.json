{
    "id": "179277e5-5cfb-4c9c-8bbd-9255d5bb9f99",
    "created_at": "2023-01-12T15:00:08.731353Z",
    "updated_at": "2025-03-27T02:16:26.384483Z",
    "deleted_at": null,
    "sha1_hash": "12eac78b37163ada943c6f0cd20b4b480458145d",
    "title": "2022-11-04 - The Android Malware’s Journey- From Google Play to banking fraud",
    "authors": "",
    "file_creation_date": "2022-11-28T19:00:18Z",
    "file_modification_date": "2022-11-28T19:00:18Z",
    "file_size": 2633062,
    "plain_text": "# The Android Malware’s Journey: From Google Play to banking fraud\n\n**[cleafy.com/cleafy-labs/the-android-malwares-journey-from-google-play-to-banking-fraud](https://www.cleafy.com/cleafy-labs/the-android-malwares-journey-from-google-play-to-banking-fraud)**\n\nFrancesco Iubatti, Alessandro Strino\n\n## Download your PDF guide to TeaBot \n\nGet your free copy to your inbox now\n\nDownload PDF Version\n\n## Background and Key points\n\nIn the last two months, we observed, through our telemetries, an increase in the\nnumber of Vultur infections among our customers.\nAt the beginning of October 2022, the Cleafy Threat Intelligence Team discovered and\nreported to Google a dropper of Vultur, a known Android banking trojan, on the official\n**Play Store with 100.000+ downloads. Recently, other researchers publicly disclosed**\nthe same malicious dropper application.\nThis dropper hides behind a fake utility application. Since its relatively small amount of\npermissions and small footprint, it appeared as a legitimate app and was able to\nelude the antivirus solutions and the Google Play analysis.\nAfter the installation phase, the dropper uses advanced evasion techniques, such as\n**steganography, file deletion, and code** **obfuscation, in addition with multiple checks**\nbefore the malware download\n\n\n-----\n\nOnce the banking trojan (Vultur) has been downloaded and installed through a fake\nupdate, Threat Actors (TAs) can observe everything that happens on the infected\ndevices and carry out bank fraud through ATO (Account Takeover) attacks.\n\nFigure 1 - Malicious dropper on Google Play Store\n\n## Analysis of the malicious dropper\n\nDuring the last years, the number of Android banking trojans has increased, and new\ntechniques to perform banking fraud have been developed. Although most of the banking\ntrojans are distributed via *ishing campaigns, TAs also use official app stores to deliver their\nmalware using dropper **applications, namely an application designed to download malware**\ninto the target device.\n\nOne of the main reasons behind this choice is the possibility of reaching a more significant\nnumber of potential victims and, thus, a greater likelihood of completing fraud. Furthermore,\nsince these droppers hide behind utility apps and come from a trusted source, they can\nmislead even “experienced” users.\n\nThe application, discovered in October by the Cleafy TIR team on the Google Play Store,\nappears like a legitimate recovery tool with a relatively small amount of permissions and a\nsmall footprint.\n\n\n-----\n\nFigure 2 - Snippet of AndroidManifest file\nThe combination of these elements, plus the use of multiple evasion techniques, makes the\napplication very difficult to detect with automatic sandboxes or machine learning\nmethodology. It goes, then, undetected by antivirus solutions and Google Protects.\n\nThis explains why, even though an overview of this dropper was already described in the last\narticle of Threat Fabric, we decided to publish this report and analyze in detail how this\napplication ended up in the Play Store and attempted to commit bank fraud.\n\n[The application found on the Play Store belongs to the Brunhilda dropper service since it](https://www.prodaft.com/m/reports/BrunHilda_DaaS.pdf)\nshares multiple behaviors with the same past related samples, such as:\n\nThe request of Android 8.0 or above versions;\nSome code similarities;\nThe information sent to the C2 server and his configuration.\n\nFigure 3 - Antivirus detection of the Vultur’s dropper application\nThe application code has changed compared to previous variants and a piece of interesting\nevidence is the use of multiple evasion techniques, used to stay undetectable and slow down\nthe analysis. Some techniques are listed below:\n\n\n-----\n\n**Steganography (a technique used to hide secret data within an ordinary file to avoid**\ndetection): as shown in Figure 4, inside the application asset directory, there is a PNG\nfile that hides an encrypted payload that, once decrypted, becomes a zip file that\ncontains a dex file. The following dex file contains the code used to communicate with\nthe C2 server and download the “real” malware on the user devices (currently, the\nAndroid banking trojan called Vultur).\n\nFigure 4 - Extraction of encrypted payload from PNG image\n\n**File** **Deletion: After the payload is decrypted and uncompressed, both the zip and dex**\nfiles are removed from their directories, as shown in Figure 5.\n**Code obfuscation and Anti-emulation: All the code is obfuscated, and the strings are**\nencrypted with the AES algorithm. Moreover, the dropper performs multiple checks to\ncontrol if it is running on an emulator/sandbox device or a legitimate one to stop the\nattack or proceed.\n\nFigure 5 - Deletion of zip and dex files from memory\nOnce the victim downloads and installs the application from the Google Play Store to\ncomplete the attack chain, the dropper displays to the user a persistent update request to\ndownload a new application (Figure 6) that represents the actual malware, namely the\nAndroid banking trojan belonging to the Vultur family.\n\nAlthough in that way, the user has to accept the Android permission to download and install\nthe application from a different source than the official Google Store, this technique allows\nTAs to not upload the malicious application directly to the official store, making the dropper\napplication undetectable.\n\n\n-----\n\nFigure 6 - Fake update requested to download the banking trojan\n\nFigure 7 - Configuration file of the malicious dropper\n\n## Overview of Vultur\n\nWhen the user installs the application requested in the fake update, a new popup appears to\nthe user (Figure 8). Notably, the malware needs the “notorious” Accessibility Services to\ncontrol the user’s device.\n\n\n-----\n\nAt this point, Vultur uses multiple techniques to try to remain unsuspected in the eyes of the\nuser, in particular:\n\nA fake alert is displayed to the user, saying, “This update is incompatible with the\ncurrent version of the Play Store and will be removed,” followed by a toast (a small\nAndroid popup) saying that the application has been removed;\nThe icon of the downloaded application is not displayed on the phone;\nWith the accessibilities services, the malware does not allow the infected user to open\nthe settings app to see which applications are installed on their device\n\nFurthermore, if an analyst tries to install Vultur directly on a device, to analyze it, the malware\ndoes not start, and it does not communicate with the C2 server. The malware must be\ninstalled and launched through the dropper application.\n\nFigure 8 - Installation phases of Vultur\nUsing keylogging and screen recording capabilities, TAs can obtain all the information they\nneed to carry out their fraudulent activities. During our investigations, we noticed that the\nusual modus operandi of Vultur’s TAs is to try to carry out bank fraud during the night hours.\n\nFigure 9 - Vultur infection during the months on our customers\n\n## Final Considerations\n\nThis research aims to show how TAs are constantly improving their techniques to stay\nundetected using advanced evasion techniques such as steganography, file deletion, and\ncode obfuscation. And at the same time, the use of official app stores to deliver banking\n\n\n-----\n\ntrojans to reach a more significant number of potential victims is a new trend that is gaining\nstrength.\n\nAccording to our findings, we expect to see new sophisticated banking droppers campaigns\non the official stores in the next months.\n\n‍\n\n**Appendix 1:IOCs**\n\n**IoC** **Description**\n\ncom.umac.recoverallfilepro Package name of the dropper on Google Play\nStore (currently removed)\n\n89a5ebab2b9458e0d31dca80c2cd3e02 MD5 of the dropper\n\nfrappucinos[.]shop C2 of the dropper\n\n95c8f5879f6d83d7c98a8d737cf2783e MD5 of Vultur\n\nflipstageparty[.]club C2 of Vultur\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-11-04 - The Android Malware’s Journey- From Google Play to banking fraud.pdf"
    ],
    "report_names": [
        "2022-11-04 - The Android Malware’s Journey- From Google Play to banking fraud.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535608,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1669662018,
    "ts_modification_date": 1669662018,
    "files": {
        "pdf": "https://archive.orkl.eu/12eac78b37163ada943c6f0cd20b4b480458145d.pdf",
        "text": "https://archive.orkl.eu/12eac78b37163ada943c6f0cd20b4b480458145d.txt",
        "img": "https://archive.orkl.eu/12eac78b37163ada943c6f0cd20b4b480458145d.jpg"
    }
}