{
    "id": "2d01280c-4c03-424d-b8a5-5ef8e551239d",
    "created_at": "2022-10-25T16:48:11.17022Z",
    "updated_at": "2025-03-27T02:16:20.954481Z",
    "deleted_at": null,
    "sha1_hash": "781aed2c402da73f0a776f7c84c86f6e2bd5d602",
    "title": "",
    "authors": "",
    "file_creation_date": "2017-04-03T16:12:55Z",
    "file_modification_date": "2017-04-03T16:12:55Z",
    "file_size": 729990,
    "plain_text": "# Appendix B:  Moonlight Maze Technical Report\n\n## Tools, Exploits, and Scripts\n\nWhat follows is a comprehensive breakdown of the artifacts leveraged throughout a window of\nMoonlight Maze attacks from 1998-1999 that employed the ‘HRTest’ relay. The operators would\npull down TAR archives with different tools, scripts, and exploits to test out on victim systems.\nMany archives were deployed through this relay but most contained some combination of the\nartefacts herein described. The total count is 45 binaries, comprised of 28 SunOS SPARC\n_binaries and 17 IRIX MIPS binaries. These include both custom tools as well as repurposed_\npublicly available source code for tools and exploits, and in some cases combinations of the\ntwo. Where redundancies and modifications were obvious, these were noted. Where the source\ncode was identified, a link is provided. Additionally, there are 9 scripts that the operators would\nexecute on victim machines. These include two exploits and several custom scripts meant to\nefficiently orchestrate malware already operating on a victim system. Since the operators’\nmodus operandi required them to connect to victim networks to issue commands and\nexfiltration, many binaries were developed to check tasking files under specific names located in\nthe </var/tmp/> directory. The scripts often place these tasks onto these specific files. They\nwould also efficiently prepare data for exfiltration or prune logs for IPs and hostnames that\nwould list further targets on an intranet or interrelated network.\n\nNote that the identified exploits were largely shared on forums designed to improve security\nawareness and to enable system administrators to get in front of emerging threats that may not\nbe patched by the manufacturers in a timely fashion. Where exploit authors are identified, this is\ndone without assignation of malice and merely as recognition of their skills and contributions to\nthe security community of their time, regardless of their misuse by the attackers.\n\nThe binaries, exploits, and scripts have been intermingled into sets as were seen deployed inthe-wild. This allow for an easier understanding of how these sets operated together. Where\nredundancies occurred, these are noted in the set overviews.\n\n\n-----\n\n## ETAR1 – SPARC Tool and Exploit Set\n\n### Overview\n\nETAR1 is by far one of the most complete tool sets leveraged by the Moonlight Maze\noperators. It is also less specific and includes redundancies, such as standalone binaries\nwhose functionality is also folded into other binaries also present within the same archive. It\nfeatures a wide spread of functionalities including multiple log cleaners, kernel patchers, a\ntunnel redirector, system information stealer, multiple covert channel backdoors, a sniffer,\nand an xserver keylogger. The archive also includes a wide swath of exploits largely aimed at\nprivilege escalation.\n\n### Tools\n\n|Filename|cle|\n|---|---|\n|MD5|647d7b711f7b4434145ea30d0ef207b0|\n|Size|9.3KB|\n|File Type|SunOS SPARC Binary|\n|Notes|Usage: ./cle filename template_file Custom log cleaner that takes two parameters, a log filename and a template file. It uses the template file to create a list in memory of any strings within the that match the template and then proceeds to purge those that contain a given string. It serves as a log cleaner when provided with a username to wipe from system logs.|\n\n|Filename|de|\n|---|---|\n|MD5|4bc7ed168fb78f0dc688ee2be20c9703|\n|Size|7.8KB|\n|File Type|SunOS SPARC Binary|\n|Notes|A tunnel redirector mean to stay resident in memory. It opens a socket and loops through packet blocks of size 1460|\n\n\n-----\n\n|Col1|(or 0x5b4) in order to redirect them elsewhere. Interesting observations: ● The fork of the fork is referred to as ‘Vnuk’, a transliteration of the Russian for ‘grandchild’. ● Similar tools are used by modern Turla to build bridges deeper within partially segmented networks.|\n|---|---|\n\n|Filename|dt25|\n|---|---|\n|MD5|e32f9c0dac812bc7418685fa5dda6329|\n|Size|7.3KB|\n|File Type|SunOS SPARC Binary|\n|Notes|A Kernel Patcher meant to kernel memory dependent on command-line parameters. The filename suggests that this version targets SunOS version 2.5. Interestingly, the program uses an unusual convention of error code responses unconventional for the attackers. This implies the source code was likely taken from elsewhere but has yet to be identified: ● “*1100” -> Not enough arguments ● “*1350” -> Can’t open device for reading ● “*1300” -> fseek error ● “*1301” -> fread error ● “*1200” -> Address error ● “*1551” -> Successful patch|\n\n|Filename|dt26|\n|---|---|\n|MD5|7dc4f81ed408ff5a369cca737dff064c|\n|Size|10KB|\n|File Type|SunOS SPARC Binary|\n\n\n-----\n\n|Notes|Another kernel memory patcher likely targeting SunOS version 2.6 based on the filename. Similar codebase to <dt25> described above including the error message convention.|\n|---|---|\n\n|Filename|gr (2)|Col3|Col4|Col5|\n|---|---|---|---|---|\n|MD5|534a1a3212894cf44d8071bdd96ba738||||\n|Size|261 bytes||||\n|File Type|Script||||\n|Notes|A reconnaissance script to collect system configuration files such as host files including remote authentication databases (/etc/hosts, /etc/hosts.equiv, /.rhosts), a list of servers configured for the management of internet services (/etc/inetd.conf), and, of course, user accounts and passwords (/etc/passwd, /etc/shadow). These are copied to the to the folder where the script is executed. It then creates a series of files with the output of the following commands: Command Output df -kb Disk space in kilobytes dmesg System diagnostic messages /usr/bin/ifconfig -a Current configuration for all network interfaces netstat -r Display network routing tables pkginfo Software packages installed on the system uname -a Name and basic system information ps -eaf List detailed active process information||||\n|||Command|Output||\n|||df -kb|Disk space in kilobytes||\n|||dmesg|System diagnostic messages||\n|||/usr/bin/ifconfig -a|Current configuration for all network interfaces||\n|||netstat -r|Display network routing tables||\n|||pkginfo|Software packages installed on the system||\n|||uname -a|Name and basic system information||\n|||ps -eaf|List detailed active process information||\n||||||\n\n|Filename|lo|\n|---|---|\n|MD5|a3164d2bbc45fb1eef5fde7eb8b245ea|\n\n\n-----\n\n|Original|Replaced|\n|---|---|\n|\"/stat\" /* Stat the client */|!stat|\n|\"/swapt\" /* Swap protocols */|!swapt|\n|\"/quit\" /* Quit the client */|!quit|\n|\"/quit all\" /* Kill all clients and server */|!quit all|\n\n|Size|18KB|\n|---|---|\n|File Type|SunOS SPARC Binary|\n|Source|http://phrack.org/issues/51/6.html|\n|Notes|Implementation of the Loki 2 ICMP information-tunneling backdoor source code published in Phrack 1996-1997. Though the bulk of the codebase appears to come from the published source code, minor alterations suggest attempts to hide the nature of the backdoor. This particular version no longer features obvious references to ‘[lokid]’ and additionally has strings shortened to remove certain vowels: Original: “lokid: client <%d> requested an all kill” Modified: “clnt <%d> rqstd n ll kll” Command-line options have been slightly modified to start with a bang: Original Replaced \"/stat\" /* Stat the !stat client */ \"/swapt\" /* Swap !swapt protocols */ \"/quit\" /* Quit !quit the client */ \"/quit all\" !quit all /* Kill all clients and server */|\n\n\n-----\n\n|Filename|lopg|\n|---|---|\n|MD5|9ab532cd3c16b66d98e0e738ddbe05a1|\n|Size|40KB|\n|File Type|SunOS SPARC Binary|\n|Source|http://phrack.org/issues/51/6.html|\n|Notes|As the name suggests, <lopg> is a combination of the LOKI2 backdoor with put/get functionality. It has also been merged with the functionality of <slok>, a strange tool described that watches for commands and interacts with the pine mail client. Just as <lo> described above, it no longer features overt references to [lokid] and has many original strings shortened to remove vowels. The put/get functionality has the following usage: Usage: @<get/put> <IP> <PORT> <file> By allowing for direct placement and retrieval/exfiltration of files, the attackers can build a parallel network between infected machines no longer reliant on protocols like FTP and telnet that are likely to be monitored in an ongoing investigation. Constant spelling mistakes and clunky use of the English language suggest the get/put functionality was developed by the operators themselves: ● \"ERROR: Can not open socket....\" ● \"open file for read\" ● \"open file for write\" ● \"receving message\" ● \"Error in parametrs:\" ● \"ERROR: Not connect...\" ● \"Connect successful....\"|\n\n\n-----\n\n|Filename|slok|\n|---|---|\n|MD5|d0f208486c90384117172796dc07f256|\n|Size|8.4KB|\n|File Type|SunOS SPARC Binary|\n|Notes|Custom tool that goes resident when executed and watches ‘/var/tmp/task’ for commands. Depending on the commands received via the task file, it spawns the pine mail reader in an xterm window. Its purpose is unclear.|\n\n|Filename|snc (2)|\n|---|---|\n|MD5|99a4a154ddecffdab5f0bf91f8bfabb8|\n|Size|5.1KB|\n|File Type|SunOS SPARC Binary|\n|Notes|A tool to run a root shell ( /bin/sh ) by forcing setuid 0 and setgid 0 or setuid to a user defined value. This is useful if you can get a root user to mark the binary as suid, then you can store it in a hidden place on the machine as an easy way to escalate privileges.|\n\n|Filename|spl|\n|---|---|\n|MD5|b4755c24e6a84e447c96b29ca6ed8633|\n|Size|6.1KB|\n|File Type|SunOS SPARC Binary|\n|Notes|Tool that extracts the first and last 1KB from a filename given as argument. The data is written in two files with their names composed as the original filename to which “.head” and “.tail” are appended.|\n\n\n-----\n\n|Filename|tdn|\n|---|---|\n|MD5|927426b558888ad680829bd34b0ad0e7|\n|Size|91KB|\n|File Type|SunOS SPARC Binary|\n|Notes|Tool is build from tcpdump and libpcap sources. Attackers used tcpdump v 1.118 and compiled the tool in 1996. The tool takes the parameters from an external file named “/var/tmp/task”. The parameters are standard libpcap filter expressions, such as “(port 21) or (port 23) or (port 513)”. The attackers deployed these rules by writing them from shell scripts to “/var/tmp/task”. Accompanying configuration script is described below.|\n\n|Filename|ts (2)|\n|---|---|\n|MD5|7a0d6b2fdc43b1b2a96b6409d4eed6e4|\n|Size|74 bytes|\n|File Type|Script|\n|Content|echo \"(port 21) or (port 23) or (port 513) or (port 110)\" > /var/tmp/task|\n|Notes|Configuration script for the <tdn> sniffer, meant to place ports into a tasking file checked by <tdn> on startup.|\n\n|Filename|u|\n|---|---|\n|MD5|d98796dcda1443a37b124dbdc041fe3b|\n|Size|9KB|\n\n\n-----\n\n|File Type|SunOS SPARC Binary|\n|---|---|\n|Source|Based on publicly available tool “utclean.c”: http://cd.textfiles.com/cuteskunk/Unix-Hacking- Exploits/utclean.c|\n|Notes|usage: %s <username> <fixthings> [hostname] Tool used to clean various system logs such as: /var/adm/wtmp /var/adm/utmp /var/adm/lastlog /var/adm/wtmpx /var/adm/utmpx At the end, it will execute the following commands: ls -la /var/adm/wtmp* ; /bin/cp ./wtmp.tmp /var/adm/wtmp ; rm ./wtmp.tmp /bin/cp ./wtmpx.tmp /var/adm/wtmpx ; rm ./wtmpx.tmp ls -la /var/adm/wtmp* It finishes by printing the following two messages: ● “fixthings: done.” ● “Hiding complit...n” Attackers changed the string “...that's it. peace man :)” to “Hiding complit...n”.|\n\n|Filename|xk|\n|---|---|\n|MD5|4065d2a24240426f6e9912a22bbfbab5|\n|Source|http://web.mit.edu/jhawk/src/xkey.c|\n\n\n-----\n\n|Notes|Keylogger for XServer, partially based on the keylogger source code above but modified to write the logs into a log file. It is also made configurable by use of files in ‘/var/tmp’ as is the operators’ convention. It forks to remain resident, then opens ‘/var/tmp/task’ and proceeds to run a series of checks on additional files like ‘/var/tmp/taskhost’, ‘/var/tmp/tasklog’, ‘/var/tmp/taskpid’, and ‘/var/tmp/taskgid/’. If these are empty, it procures the information and forks. The log starts at the following routine: The logs are XORed with 0x4D and the output is saved into: ‘/var/tmp/.Xtmp01’. However, these logs are found stored in the archives under names like “RES.xk”, “A”, “B”, “ABC” followed by a number, suggesting further manipulation down the line. Decrypted logs show victim communications. Interestingly, <xk> shares the same log string convention as the <ora> sniffer in the STDN set.|\n|---|---|\n\n\n-----\n\n### Exploits\n\n|Filename|p9|\n|---|---|\n|MD5|2213867345a51ecf09d3a747046af78c|\n|Size|6.2KB|\n|File Type|SunOS SPARC Binary|\n|Source|http://borax.polux- hosting.com/madchat/reseau/advisoriez/sun/sunos/5.6/ping.c|\n|Notes|Exploits a buffer overflow in the SunOS ping program used to privilege escalation as root.|\n\n|Filename|rdi|\n|---|---|\n|MD5|34c3ea4d6cc814a174579d295bdd028d|\n|Size|25KB|\n|File Type|SunOS SPARC Binary|\n|Source|http://www.securiteam.com/exploits/3V5QFQ0N5S.html|\n|Notes|Exploit against SunOS rdist program for privilege escalation as root.|\n\n|Filename|ufsr|\n|---|---|\n|MD5|07f070302f42219d37419d23ff9df091|\n|Size|5.9KB|\n|File Type|SunOS SPARC Binary|\n\n\n-----\n\n|Source|http://seclists.org/bugtraq/1998/Jun/73|\n|---|---|\n|Notes|‘ufsrestore’ exploit (Released 1998)|\n\n|Filename|ux|\n|---|---|\n|MD5|b831cbffa1aee70252bb0f6862265cc9|\n|Size|7.4KB|\n|File Type|SunOS SPARC Binary|\n|Source|http://borax.polux- hosting.com/madchat/reseau/advisoriez/sun/sparc/2.4/holeut mp.c|\n|Notes|Removes a user from utmp logs.|\n\n\n-----\n\n## SPTAR – Improved SPARC Attack Set\n\n### Overview\n\nSPTAR appears to be an improved toolkit, similar in composition to ETAR1. Many of the\nbinaries are the same. Interesting divergences appear to be modified binaries that include\nnew or improved functionality. In some cases, the operators decided to fold in standalone\ntools into combined binaries. They’ve also included a new log cleaner.\n\n### Tools\n\n|Filename|deg|\n|---|---|\n|MD5|8b56e8552a74133da4bc5939b5f74243|\n|Size|8.5KB|\n|File Type|SunOS SPARC Binary|\n|Notes|This is an improved tunnel redirector with functionality similar to <de> in the ETAR1 set. The major modification appears to be an attempt to hide in memory.|\n\n|Filename|lopg (2)|\n|---|---|\n|MD5|1980958afffb6a9d5a6c73fc1e2795c2|\n|Size|45KB|\n|File Type|SunOS SPARC Binary|\n|Source|http://phrack.org/issues/51/6.html http://seclists.org/bugtraq/1995/May/171|\n|Notes|Yet another LOKI2 variant, built on top of the improved <lopg> described in the ETAR1 set but with additional functionality. The attackers have folded in ‘utmprm’, a utmp log cleaning exploit included as a standalone binary in ETAR1 and other sets.|\n\n\n-----\n\n|Filename|wp|\n|---|---|\n|MD5|e69efc504934551c6a77b525d5343241|\n|Size|11KB|\n|File Type|SunOS SPARC Binary|\n|Source|http://www.afn.org/~afn28925/wipe.c|\n|Notes|USAGE: wipe [ u|w|l|a ] ...options... Partially based on source Wipe 1.00 by The Crawler System access log cleaner tool, most likely not written by the attackers. It cleans activity logs in the following system files: ● /var/adm/utmp ● /var/adm/utmpx ● /var/adm/wtmp ● /var/adm/wtmpx ● /var/adm/lastlog|\n\n\n### Exploits\n\n|Filename|eje|\n|---|---|\n|MD5|7bc9d8da363091ad57456f8bd5027ab0|\n|Size|4.1KB|\n|File Type|SunOS SPARC Binary|\n|Source|http://insecure.org/sploits/solaris.eject.html|\n|Notes|‘/bin/eject’ buffer overflow for privilege escalation as root.|\n\n\n-----\n\n|Filename|ffb|\n|---|---|\n|MD5|26143b006710455888e01df9b58e1913|\n|Size|5.8KB|\n|File Type|SunOS SPARC Binary|\n|Source|https://www.exploit-db.com/exploits/19159/|\n|Notes|FFB buffer overflow that allows user to gain root access, discovered by Cristian Schipor|\n\n|Filename|sc|\n|---|---|\n|MD5|f684ecccd69cca88ba8508711f140240|\n|Size|3.4KB|\n|File Type|SunOS SPARC Binary|\n|Notes|A tool to run a root shell (/bin/sh) by forcing setuid 0 and setgid 0 in an attempt to escalate privileges.|\n\n\n-----\n\n## LUTAR – An Early Covert Communications Set\n\n### Overview\n\nThe LUTAR set appears to have a particular focus on stealth and is comprised of an largely\nunmodified LOKI2 backdoor, a custom ICMP redirector client meant to interact with it, a\nsimple setuid/getuid attempt to get root shell described in SPTAR, and a utmp access log\ncleaner. Given the lack of modification to the LOKI2 backdoor, this set is likely an early\nattempt that came before ETAR1 and SPTAR.\n\n### Tools\n\n|Filename|cli|\n|---|---|\n|MD5|f106ab64b0dc773167a82da7635dfe27|\n|Size|10KB|\n|File Type|SunOS SPARC Binary|\n|Notes|<cli> is a custom ICMP redirector client likely meant to interact with LOKI2 samples. Upon execution it requests the following: ● Enter listen port: ● Enter dst port: ● Enter dst redirect address: ● Enter src addr (in packet): ● Enter dst addr (in packet): It appears that some strings were exchanged back and forth during development as a specific string is shared with the <los> and <lopg (2)> LOKI2 samples: ● \"ERROR: Can not open socket....\" Interestingly, the file contains more than the operators’ adorably broken English. This binary includes a compilation bath that reveals the development name as ‘spy_cli.c’ and the user profile ‘iron’: “/disk3/volume_2/users/iron/myprg/|\n\n\n-----\n\n|Col1|redirect/solaris/icmp_redirect; //opt/SUNWspro/bin/../SC4.2/bin/cc -O -lsocket -lnsl -c spy_cli.c - W0,-xp”|\n|---|---|\n\n|Filename|lc|\n|---|---|\n|MD5|14cce7e641d308c3a177a8abb5457019|\n|Size|14KB|\n|File Type|SunOS SPARC Binary|\n|Source|http://phrack.org/issues/51/6.html|\n|Notes|<lc> is a relatively straightforward compilation of the LOKI2 source code with some modifications such as the inclusion of a log file called ‘loki.log’, bang replacements for commands (as seen in <lo> and <lopg>), and connection strings: ● ----- Connected to: %s at %s ● ----- Disconnected from: %s at %s This is likely an earlier attempt than those witnessed in the ETAR1 and SPTAR sets as the original LOKI2 strings are largely intact.|\n\n\n-----\n\n## IMI – IRIX Tool and Exploit Set\n\n### Overview\n\nThe IMI toolkit is an IRIX focused toolkit comprised of ported tools seen in the ETAR1 archive\nlike <slok> (now <ilok>) and the <lo> variant of LOKI2 (now <loi>). Additionally, a wealth of\ndifferent exploits are included focused on providing privilege escalation.\n\n### Tools\n\n|Filename|ilok|\n|---|---|\n|MD5|155d251e6e0dabce21ab26bd03487066|\n|Size|18KB|\n|File Type|IRIX MIPS Binary|\n|Notes|IRIX version of <slok> tool described in the ETAR1 set.|\n\n|Filename|loi|\n|---|---|\n|MD5|dabee9a7ea0ddaf900ef1e3e166ffe8a|\n|Size|29KB|\n|File Type|IRIX MIPS Binary|\n|Source|http://phrack.org/issues/51/6.html|\n|Notes|IRIX version of the <lo> variant of the LOKI2 backdoor described in ETAR1.|\n\n|Filename|snc|\n|---|---|\n|MD5|c73bf945587aff7bc7761b16fc85b5d7|\n\n\n-----\n\n|Size|12KB|\n|---|---|\n|File Type|IRIX MIPS Binary|\n|Notes|A tool to run a root shell (/bin/sh) by forcing setuid 0 and setgid 0 or setuid to a user defined value. This is useful if you can get a root user to mark the binary as suid, then you can store it in a hidden place on the machine as an easy way to escalate privileges.|\n\n\n### Exploits\n\n|Filename|daynotify.sh|\n|---|---|\n|MD5|10096abc73b7b7540b607c0ac1a27b49|\n|Size|1.3KB|\n|File Type|Script|\n|Source|http://insecure.org/sploits/IRIX.day5notifier.html|\n|Notes|Copy of a shell executable script written by Mike Neuman in August, 1996 to showcase an exploitable vulnerability in the ‘day5notifier’ program in IRIX 6.2. The attackers copied Neuman’s exact script which allows command execution as root.|\n\n|Filename|io|\n|---|---|\n|MD5|25bcfc394d44d717f20d416354d2126e|\n|Size|176 bytes|\n|File Type|Script|\n|Source|https://www.exploit-db.com/exploits/19163/|\n|Notes|Exploits a vulnerability in the IRIX 6.4 ioconfig binary to allow the execution of arbitrary programs as root Reported by Loneguard and classified as CVE-1999-0314 Exact PoC code shown here with a few comment lines removed|\n\n\n-----\n\n|Filename|eject|\n|---|---|\n|MD5|864e1d74e610a48c885ac719b5564eb1|\n|Size|17KB|\n|File Type|IRIX MIPS Binary|\n|Source|https://www.exploit-db.com/exploits/19277/|\n|Notes|Irix exploit by Last Stage of Delirium: “A vulnerability exists in the eject program shipped with Irix 6.2 from Silicon Graphics. By supplying a long argument to the eject program, it is possible to overwrite the return address on the stack, and execute arbitrary code as root. Eject is normally used to eject removeable [sic] media from the system, and as such is setuid root to allow for any user at the console to perform eject operations.”|\n\n|Filename|log|\n|---|---|\n|MD5|a26bad2b79075f454c83203fa00ed50c|\n|Size|12KB|\n|File Type|IRIX MIPS Binary|\n|Source|http://insecure.org/sploits/IRIX.login.overflow.html|\n|Notes|IRIX v5 and v6 ‘/bin/login’ exploit, originally found by David Hedley <hedley@CS.BRIS.AC.UK> and posted on Bugtraq on 26 May 1997. Shellcode highlighted below:|\n\n\n-----\n\n|Col1|Tool was compiled by user “max”. User “max” also compiled the “tdn” tool for IRIX.|\n|---|---|\n\n|Filename|pset|\n|---|---|\n|MD5|86499f8e6cfc90770a65dc30f1c9939b|\n|Size|17KB|\n|File Type|IRIX MIPS Binary|\n|Source|https://www.exploit-db.com/exploits/19347/|\n|Notes|‘/sbin/pset’ exploit for IRIX: “The pset utility, as shipped by SGI with Irix 5.x and 6.x through 6.3, contains a buffer overflow, which can allow any user on the system to execute arbitrary code on the machine as root. Pset is used to configure and administer processor groups in multiprocessor systems. By supplying a well crafted, long buffer as an argument, the return address on the stack is overwritten, allowing an attacker to execute code other than that which was intended.”|\n\n\n-----\n\n|Filename|xconsole|\n|---|---|\n|MD5|f67fc6e90f05ba13f207c7fdaa8c2cab|\n|Size|13KB|\n|File Type|IRIX MIPS Binary|\n|Source|http://insecure.org/sploits/IRIX.xconsole.cdplayer.xwsh.monpan el.html|\n|Notes|‘/usr/bin/X11/xconsole’ buffer overflow exploit for IRIX by David Hedley.|\n\n|Filename|xlock|\n|---|---|\n|MD5|5937db3896cdd8b0beb3df44e509e136|\n|Size|16KB|\n|File Type|IRIX MIPS Binary|\n|Source|ftp://ftp.ntua.gr/mirror/technotronic/unix/irix- exploits/6.2/xlock.c|\n|Notes|IRIX 6.2 xlock exploit for arbitrary code execution as root.|\n\n|Filename|xterm|\n|---|---|\n|MD5|f4ed5170dcea7e5ba62537d84392b280|\n|Size|13KB|\n|File Type|IRIX MIPS Binary|\n|Source|https://cliplab.org/~alopez/bugs/bugtraq/0307.html|\n|Notes|IRIX exploit for ‘/usr/bin/X11/xterm’ by David Hedley|\n\n\n-----\n\n## IMTAR – IRIX Tool and Exploit Set\n\n### Overview\n\nImproved IRIX toolkit including the LOKI2 variants with added functionality, additional privilege\nescalation exploits, and log cleaners.\n\n### Tools\n\n|Filename|ig|\n|---|---|\n|MD5|4110c87e966d4ce6a03c5375353969af|\n|Size|77KB|\n|File Type|IRIX MIPS Binary|\n|Notes|Gzip tool compiled for IRIX, renamed to “ig”|\n\n|Filename|lo (2)|\n|---|---|\n|MD5|f8df359c909ae12f313d9444a6d958d2|\n|Size|41KB|\n|File Type|IRIX MIPS Binary|\n|Source|http://phrack.org/issues/51/6.html|\n|Notes|IRIX port of the <lo> variant of LOKI2, minor differences from <loi>.|\n\n|Filename|los|\n|---|---|\n|MD5|e59f92aadb6505f29a9f368ab803082e|\n\n\n-----\n\n|Size|37KB|\n|---|---|\n|File Type|IRIX MIPS Binary|\n|Source|http://phrack.org/issues/51/6.html|\n|Notes|IRIX port of the more advanced <lopg> variant of LOKI2 that includes the custom put/get functionality and as well as <slok>/<ilok>.|\n\n|Filename|ua (or UCL2)|\n|---|---|\n|MD5|73a518f0a73ab77033121d4191172820|\n|Size|17KB|\n|File Type|IRIX MIPS Binary|\n|Notes|IRIX log cleaner. English proficiency suggests it was not written by the operators. Strings were ported back to <u> with misspellings.|\n\n\n### Exploits\n\n|Filename|df3|\n|---|---|\n|MD5|008ea82f31f585622353bd47fa1d84be|\n|Size|12KB|\n|File Type|IRIX MIPS Binary|\n|Source|https://www.exploit-db.com/exploits/19274/|\n|Notes|‘/bin/df’ buffer overflow Irix exploit by David Hedley released in 1997.|\n\n\n-----\n\n|Filename|sc (2)|\n|---|---|\n|MD5|59198b97f29fcf6e17f8653a99732a74|\n|Size|12KB|\n|File Type|IRIX MIPS Binary|\n|Notes|A tool to run a root shell (/bin/sh) by forcing setuid 0 and setgid 0 in an attempt to escalate privileges.|\n\n|Filename|ux (2)|\n|---|---|\n|MD5|dc9d91e8b2a90df6d25663778a312014|\n|Size|17KB|\n|File Type|IRIX MIPS Binary|\n|Notes|IRIX port of utmprm, which removes a user from utmp logs.|\n\n\n-----\n\n## ITDN – IRIX Sniffer Set\n\n### Overview\n\nSmall set consisting of an IRIX sniffer and its configuration file. The script places the ports to\ncapture onto a file stored at ‘/var/tmp/task’ and checked by <tdni> at startup.\n\n### Tools\n\n|Filename|tdni|\n|---|---|\n|MD5|74af85d293ceb1cfd1a47c0d794e44d5|\n|Size|277KB|\n|File Type|IRIX MIPS Binary|\n|Notes|IRIX port of the <tdn> sniffer tool described in the ETAR1 set. It uses ‘/var/tmp/task’ to read the libpcap rules that will be applied to the network traffic. Configuration script is described below. When compiled, the tool source was located in the following path: irix:/usr/people/max/mytdn- nsl/tcpdump-3.3/./tcpdump.c|\n\n|Filename|ts|\n|---|---|\n|MD5|84218bfec08af6a329a277cad9e0044a|\n|Size|60 bytes|\n|File Type|Script|\n|Notes|Script to configure the tdn sniffer to capture telnet, ftp and rlogin packets by port number.|\n\n\n-----\n\n## STDN – SPARC Sniffer Set\n\n### Overview\n\nSmall Solaris sniffer set. Interestingly, this includes both a malfunctioning sniffer (<ora>) and a\nworking version already seen in ETAR1. It’s possible that this set came before ETAR1 and\nwas used during a testing phase. Interestingly, despite the issues with <ora>, the developers\nreturn to ‘solsniffer’ to develop <td_tr>, their most improved sniffer.\n\n### Tools\n```\nFilename ora\nMD5 7b86f40e861705d59f5206c482e1f2a5\nSource http://read.pudn.com/downloads/sourcecode/hack/sniffer/951\n         /solsniffer.c__.htm\n         Merged with:\n         http://www.mit.edu/afs.new/athena/astaff/source/src         9.3/third/sysinfo/lib/std/dlpi.c\nFile Type SunOS SPARC Binary\nNotes Tool is based on solsniffer, from 1994, created by Michael\n         R. Widner (atreus, J.Galt). It was merged with Neal\n         Nuckolls's (Sun Internet Engineering) DLPI \"test\" kit. It\n         has built in support to filter out smtp, ftp, rlogin and\n         telnet connections. The main purpose would be the\n         interception of usernames and passwords leaked by the\n         insecure authentication methods from these protocols.\n         It checks for the presence of “/var/tmp/gogo” and will\n         exit without displaying any errors if the file is missing. \n\n```\n|Filename|ora|\n|---|---|\n|MD5|7b86f40e861705d59f5206c482e1f2a5|\n|Source|http://read.pudn.com/downloads/sourcecode/hack/sniffer/951 /solsniffer.c__.htm Merged with: http://www.mit.edu/afs.new/athena/astaff/source/src- 9.3/third/sysinfo/lib/std/dlpi.c|\n|File Type|SunOS SPARC Binary|\n|Notes|Tool is based on solsniffer, from 1994, created by Michael R. Widner (atreus, J.Galt). It was merged with Neal Nuckolls's (Sun Internet Engineering) DLPI \"test\" kit. It has built in support to filter out smtp, ftp, rlogin and telnet connections. The main purpose would be the interception of usernames and passwords leaked by the insecure authentication methods from these protocols. It checks for the presence of “/var/tmp/gogo” and will exit without displaying any errors if the file is missing.|\n\n|Filename|tdn|\n|---|---|\n|MD5|927426b558888ad680829bd34b0ad0e7|\n|Size|91KB|\n\n\n-----\n\n|File Type|SunOS SPARC Binary|\n|---|---|\n|Notes|Sniffer described in detail in the ETAR1 Set where it is leveraged with a different configuration script <ts (2)> Known shell scripts that write to ‘/var/tmp/task’ are <ts>, <ts (2)> and <tsa>.|\n\n|Filename|tsa|\n|---|---|\n|MD5|58e4aa80f14c16e9292bd8f4535fb0cd|\n|Size|74 bytes|\n|File Type|Script|\n|Notes|Script to configure the tdn sniffer to capture telnet, ftp, pop3 and rlogin packets by port number.|\n\n\n-----\n\n## STR – Improved SPARC Sniffer Set\n\n### Overview\n\nThis set is comprised of a vastly improved Solaris sniffer and tools for post-processing the\ninformation captured with it. These include scripts to cut out IPs from logs, a utility to resolve\nthose IPs to hostnames, and a script and a gzip binary to prepare files for exfiltration.\n\n### Tools\n\n|Filename|g|\n|---|---|\n|MD5|338f20250b99d8dc064ba7ce8a9f48e1|\n|Source|68KB|\n|File Type|SunOS SPARC Binary|\n|Notes|Compiled version of gzip, renamed to “g”.|\n\n|Filename|get|\n|---|---|\n|MD5|7c930162a676c46ac590342c91402dca|\n|Size|9.5KB|\n|File Type|SunOS SPARC Binary|\n|Notes|Tool which uses gethostbyaddr to get the internet host names for all the IPs specified in an input file. It writes the resolved hostnames into an output file and logs errors to “error.log”.|\n\n|Filename|gr|\n|---|---|\n|MD5|d8347b2e32086bd25d41530849472b8d|\n|Size|342 bytes|\n\n\n-----\n\n|File Type|Script|\n|---|---|\n|Notes|Shell script to extract all unique source and destination IP addresses from td_tr “RES.u” and “RES.s” logs into the output file “list”.|\n\n```\nNotes One of the main sniffer tools used by the attackers. A\n        combination of “ora” and “tdn”, it is compiled from the\n        improved 951 version of <Solsniffer.c>, released in 1994,\n        tcpdump, and libpcap.\n        It captures packets for commonly used insecure\n        authentication protocols (such as ftp, telnet, pop3) and\n        logs these sessions into a text file with the hardcoded name \n        “RES.u”. The tool contains another filename “RES.s” which is\n        not used in the current versions.\n        Text files contain entries such as:\n\n```\n|Filename|td_tr|\n|---|---|\n|MD5|66c8fa9569d6b5446eb865544ed67312|\n|Size|187KB|\n|File Type|SunOS SPARC Binary|\n|Source|http://read.pudn.com/downloads/sourcecode/hack/sniffer/951/s olsniffer.c__.htm Tcpdump version 1.18|\n|Notes|One of the main sniffer tools used by the attackers. A combination of “ora” and “tdn”, it is compiled from the improved 951 version of <Solsniffer.c>, released in 1994, tcpdump, and libpcap. It captures packets for commonly used insecure authentication protocols (such as ftp, telnet, pop3) and logs these sessions into a text file with the hardcoded name “RES.u”. The tool contains another filename “RES.s” which is not used in the current versions. Text files contain entries such as:|\n\n\n-----\n\n|Col1|Due to the proliferation of this sniffer, the hackers essentially created their own archeological trail, by sniffing their own activities as they proxied through infected systems and then proceeding to exfiltrate these records along with what they were actually interested in removing.|\n|---|---|\n\n|Filename|tr|\n|---|---|\n|MD5|35f87672e8b7cc4641f01fb4f2efe8c3|\n|File Type|Script|\n|Size|177 bytes|\n|Notes|Shell script which automates several tasks: ● Capture network packets using td_tr ● Extract all unique source and destination IPs using “gr” ● Get corresponding internet host names for all IPs into a filename called “RES” ● Add “RES” to “res.tar” ● Gzip the “res.tar” using compression level -9|\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://securelist.com/files/2017/04/Penquins_Moonlit_Maze_AppendixB.pdf"
    ],
    "report_names": [
        "Penquins_Moonlit_Maze_AppendixB.pdf"
    ],
    "threat_actors": [
        {
            "id": "cfdd35af-bd12-4c03-8737-08fca638346d",
            "created_at": "2022-10-25T16:07:24.165595Z",
            "updated_at": "2025-03-27T02:02:10.128957Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "Cosmic Wolf",
                "Marbled Dust",
                "Silicon",
                "Teal Kurma",
                "UNC1326"
            ],
            "source_name": "ETDA:Sea Turtle",
            "tools": [
                "Drupalgeddon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "33ae2a40-02cd-4dba-8461-d0a50e75578b",
            "created_at": "2023-01-06T13:46:38.947314Z",
            "updated_at": "2025-03-27T02:00:02.959421Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "SILICON",
                "Teal Kurma",
                "UNC1326",
                "COSMIC WOLF",
                "Marbled Dust"
            ],
            "source_name": "MISPGALAXY:Sea Turtle",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1491235975,
    "ts_modification_date": 1491235975,
    "files": {
        "pdf": "https://archive.orkl.eu/781aed2c402da73f0a776f7c84c86f6e2bd5d602.pdf",
        "text": "https://archive.orkl.eu/781aed2c402da73f0a776f7c84c86f6e2bd5d602.txt",
        "img": "https://archive.orkl.eu/781aed2c402da73f0a776f7c84c86f6e2bd5d602.jpg"
    }
}