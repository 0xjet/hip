{
    "id": "a5026e4b-cba3-4c52-8587-11f16b8f96e2",
    "created_at": "2023-01-12T15:05:10.100577Z",
    "updated_at": "2025-03-27T02:05:29.908895Z",
    "deleted_at": null,
    "sha1_hash": "3f22c68af0ebf4cc382c4cd7c03b4ab1e15ce046",
    "title": "2017-11-13 - IcedID Banking Trojan Shares Code with Pony 2.0 Trojan",
    "authors": "",
    "file_creation_date": "2022-05-28T18:28:37Z",
    "file_modification_date": "2022-05-28T18:28:37Z",
    "file_size": 1829599,
    "plain_text": "# IcedID Banking Trojan Shares Code with Pony 2.0 Trojan\n\n**[intezer.com/icedid-banking-trojan-shares-code-pony-2-0-trojan/](http://www.intezer.com/icedid-banking-trojan-shares-code-pony-2-0-trojan/)**\n\nNovember 13, 2017\n\nWritten by Jay Rosenberg - 13 November 2017\n\n## Get Free Account\n\nJoin Now\n\n[IBM X-Force recently released an excellent report on a new banking trojan named IcedID](https://securityintelligence.com/new-banking-trojan-icedid-discovered-by-ibm-x-force-research/)\nthat is being distributed using computers already infected with Emotet. We took the MD5 of\none of the droppers from the IBM report and extracted the payload. After extracting the\n[payload from one of the droppers listed in the report, using Intezer Analyze™, we have](https://www.intezer.com//intezer-analyze/)\nfound code reuse from another malware named Pony, written about in a [report by](https://www.proofpoint.com/us/threat-insight/post/hancitor-ruckguv-reappear)\nProofpoint.\n\n[#IcedID banking trojan payload – code overlap with #pony more details](https://twitter.com/hashtag/IcedID?src=hash&ref_src=twsrc%5Etfw)\n[soonhttps://t.co/baS1fciJHX@malwrhunterteam](https://t.co/baS1fciJHX) [@campuscodi](https://twitter.com/campuscodi?ref_src=twsrc%5Etfw)\n\n[— Jay Rosenberg (@jaytezer) November 13, 2017](https://twitter.com/jaytezer/status/930054725290078213?ref_src=twsrc%5Etfw)\n\n\n-----\n\nPony is a trojan that was being distributed via the Hancitor downloader, distributed through\nMicrosoft Word documents. The version of Pony used in the reports is believed to be the\nsame threat actor as Vawtrak. It was also sold via underground forums until the source code\nwas leaked online.\n\n[(Intezer Analyze ™ report)](https://analyze.intezer.com/#/analyses/00fd4dde-21b9-4661-8878-ee67b187362e)\n\nUsing the dive-in feature with the related Pony samples, we can see the following:\n\n[(Dive-in feature of Intezer Analyze™)](https://www.intezer.com//intezer-analyze/)\n\nWith this information alone, it will be hard to attribute this sample to a certain threat actor\ndue to the public availability of the source code of Pony.\n\n\n-----\n\nLet s take a look at some of the matching functions.\n\nAs we can see here, the function in these two samples is a 1:1 match. The function above\nis called GrabOutlook in the Pony source code and is responsible for stealing passwords\nfrom Outlook. (You may notice a difference because the strings appear decrypted in the\nsample on the left as it looks like Proofpoint dumped the sample with the strings already\ndecrypted before uploading to VirusTotal.)\n\n\n-----\n\n(GrabOutlook function from Pony 2.0 source code)\n\nMore specifically, we can tell the threat actor used code from version 2.0 of Pony because\nin the Pony 1.9 source code, we do not see calls to DecipherList which is responsible for\ndecrypting the strings.\n\n(GrabOutlook function from Pony 1.9 source code)\n\nOther shared functions from Pony:\n\n\n-----\n\nOutlookExport\nOutlookReadPSItemValue\nOutlookScanPasswords\nOutlookScanProfiles\nPocomailScanReg\nIncrediMailScanReg\nCRC32Update\nCommonCryptUnprotectData\nMapFile\nPonyStrCat\nPonyStrCatFreeArg1\nDecipherList\nUnicodeToAnsiLen\nFileExists\nStreamUpdateModuleLen\nStreamWriteModuleHeader\n\nThere may be other functions from Pony, but we can see that the shared code is mostly\nrelated to stealing e-mail credentials.\n\nTime and time again, we see threat actors reusing the same code. If we look at reused\ncode, it makes it easier to detect malware. Such small code reuse makes it very difficult to\nget these kinds of conclusions by manually reverse engineering a file. The ability to\nautomate the finding of code reuse makes our job as malware analysts easier.\n\nReport Samples:\n\nIcedID Dropper:\n29f7469f8dc88820f72a9bdcb02badc1a40aa41b3f4b7f8caaa30409b3842aea\nIcedID Payload:\na6531184ea84bb5388d7c76557ff618d59f951c393a797950b2eb3e1d6307013\nPony: b19ec186f59b1f72c768ed2fcd8344d75821e527870b71e8123db96f683f1b68\n\n**Jay Rosenberg**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-11-13 - IcedID Banking Trojan Shares Code with Pony 2.0 Trojan.pdf"
    ],
    "report_names": [
        "2017-11-13 - IcedID Banking Trojan Shares Code with Pony 2.0 Trojan.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535910,
    "ts_updated_at": 1743041129,
    "ts_creation_date": 1653762517,
    "ts_modification_date": 1653762517,
    "files": {
        "pdf": "https://archive.orkl.eu/3f22c68af0ebf4cc382c4cd7c03b4ab1e15ce046.pdf",
        "text": "https://archive.orkl.eu/3f22c68af0ebf4cc382c4cd7c03b4ab1e15ce046.txt",
        "img": "https://archive.orkl.eu/3f22c68af0ebf4cc382c4cd7c03b4ab1e15ce046.jpg"
    }
}