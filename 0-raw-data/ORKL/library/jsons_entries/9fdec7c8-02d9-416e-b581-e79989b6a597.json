{
    "id": "9fdec7c8-02d9-416e-b581-e79989b6a597",
    "created_at": "2023-01-12T15:04:18.6722Z",
    "updated_at": "2025-03-27T02:16:25.645174Z",
    "deleted_at": null,
    "sha1_hash": "abbf2628b7ab017cedaafe067ddb14e555467b85",
    "title": "2021-06-23 - Ursnif Leverages Cerberus to Automate Fraudulent Bank Transfers in Italy",
    "authors": "",
    "file_creation_date": "2022-05-27T22:36:58Z",
    "file_modification_date": "2022-05-27T22:36:58Z",
    "file_size": 2889152,
    "plain_text": "# Ursnif Leverages Cerberus Android Malware to Automate Fraudulent Bank Transfers in Italy\n\n**[securityintelligence.com/posts/ursnif-cerberus-android-malware-bank-transfers-italy/](https://securityintelligence.com/posts/ursnif-cerberus-android-malware-bank-transfers-italy/)**\n\n[Home&nbsp/](https://securityintelligence.com/) [Advanced Threats](https://securityintelligence.com/category/x-force/threats/)\nUrsnif Leverages Cerberus to Automate Fraudulent Bank Transfers in Italy\n\n[Advanced Threats June 23, 2021](https://securityintelligence.com/category/x-force/threats/)\n\n\n-----\n\nBy [Itzik Chimino co-authored by Limor Kessem 9 min read](https://securityintelligence.com/author/itzik-chimino/)\n_Contributed to this research: Segev Fogel, Amir Gendler and Nethanella Messer._\n\nIBM Trusteer researchers continually monitor the evolution and attack tactics in the banking\nsector. In a recent analysis, our team found that an Ursnif (aka Gozi) banking Trojan variant\nis being used in the wild to target online banking users in Italy with mobile malware. Aside\nfrom the Ursnif infection on the victim’s desktop, the malware tricks victims into fetching a\nmobile app from a fake Google Play page and infects their mobile device with the Cerberus\nAndroid malware.\n\nThe Cerberus malware component of the attack is used by Ursnif’s operators to receive twofactor authentication codes sent by banks to their users when account updates and money\ntransfer transactions are being confirmed in real-time. Cerberus also possesses other\nfeatures and can enable the attacker to obtain the lock-screen code and remotely control the\ndevice.\n\nCerberus is an overlay-type mobile malware that emerged in mid-2019 but initially lacked\nadvanced capabilities. It has evolved over time to eventually feature the ability to hijack SMS\n[content and control devices remotely, alongside other sophisticated data theft features.](https://www.kaspersky.com/about/press-releases/2020_the-rise-of-cerberus)\nCerberus was peddled in the underground as commodity malware until the summer of 2020,\ntaking over the market share of Anubis, a previous pay-per-use malware.\n\nIn September 2020, Cerberus’ development team decided to disband, spurring an auction\nattempt that aimed to sell off the source code to the highest bidder, [starting at $100,000. The](https://www.zdnet.com/article/cerberus-banking-trojan-source-code-released-for-free-to-cyberattackers/)\ncode did not sell but was instead shared with the malware’s customer base, which meant it\nwas publicly leaked. That intentional release of the source code gave rise to numerous\nmalware campaigns involving Cerberus and likely also led to this combined attack with the\nUrsnif banking Trojan.\n\n## A Combination Attack From Desktop to Smartphone\n\nUrsnif is a very long-standing staple in the cybercrime arena, possibly the oldest banking\nTrojan that’s still active today. [Recent campaigns featuring this malware have been most](https://www.difesaesicurezza.com/areariservatacat/cybercrime-ursnif-gozi-sfrutta-di-nuovo-brt-per-una-campagna-in-italia/)\nnotable in Italy, where it is typically delivered to business email recipients in attachments that\npurport to carry invoices, delivery notices or other business correspondence. The infection\nchain commonly involves poisoned macros, getting past email controls by featuring\nproductivity files most organizations use. In some campaigns, the attackers keep access to\nthe infection zone limited to Italian-based IP addresses only.\n\nOnce infected by the Ursnif malware and upon attempting to access their online banking\naccount, victims are advised, via web injection, that they won’t be able to continue to use\ntheir bank’s services without downloading a security app. To obtain that app, they are shown\na QR code and instructed to scan it with their phone’s camera.\n\n\n-----\n\n_Figure 1: Web injection instructing infected users to download a mobile app_\n\nLooking into the QR code provided through the injection, we found a Base64 encoded string\nwith the details.\n\n_Figure 2: Malicious QR code’s content is a Base64-encoded string_\n\nIf users scan the QR code, they will open a web page on their smartphone and be sent to a\nfake Google Play page featuring a corresponding banking app logo of the banking brand the\nvictim originally attempted to access. The campaign, in this case, included a number of\ndomains that were most likely registered for that purpose and reported in other malicious\nactivity in the past, such as hxxps://play.google.servlce.store/store/apps/details.php?id=it.\n\n[BANK BRAND].\n\nEach of the domains hosting the fake Google Play pages used similar words or typosquatting to appear legitimate. Some examples are:\n\ngoogle.servlce.store\ngooogle.services\ngoooogle.services\nplay.google.servlce.store\nplay gooogle services\n\n\n-----\n\nplay.goooogle.services.\n\nThese malicious domains have been flagged on VirusTotal for a few months, with more\nreports accumulating over time. Reports on the malicious Android Packages (APKs) that\nconceal the Cerberus malware spread in this campaign have been flagging it since at least\nlate-2020.\n\nIn cases of users who do not successfully scan the QR code, they are asked to provide their\ntelephone number and subsequently receive an SMS message with a download link to fetch\nthe malicious application, which warns users about a potential service interruption if they fail\nto obtain the app.\n\n_Figure 3: Web injection instructing infected users to provide their phone number_\n\nIn the background, the injection’s code couples the phone number inserted by the victim with\nthe bot ID the Ursnif malware assigned to that infected desktop, the bank’s name the victim\nuses and their login credentials as grabbed by Ursnif.\n\nNotice the use of the word ‘Jambo’ in parts of the code. It is most likely that Ursnif’s\noperators wrote a jQuery library to simplify HTML Document Object Model tree traversal and\nmanipulation, using it to orchestrate their injections. Fraudsters can use the library to define\nthe amounts to transfer from accounts and other parameters of the fraudulent transaction.\n\n_Figure 4: Injection code sending Cerberus infection URL to Ursnif-infected victims_\n\n\n-----\n\nIf the victims submit their phone number on the web injection, the remote server will send\nback a download URL for them to unknowingly download the Cerberus malware. This\ninjection also keeps the victims’ device identifiers linked to their bot ID and account\ncredentials.\n\n_Figure 5: Injection code sending Cerberus infection URL to Ursnif-infected victims, additional_\n_view_\n\n## Cerberus in Action\n\n[Cerberus campaigns have already been detected spreading through the official Google Play](https://cyware.com/news/cerberus-hounding-google-play-1185f151)\nstore in the past, but this distribution attempts to land on victim devices through a third-party\nsource — the attacker’s domains. The option to sideload APKs is not enabled by default on\nAndroid devices, and the choice to deliver the malware from a non-official source may have\nlimited the spread of the campaign to a larger number of devices.\n\nWhen Cerberus is downloaded to a new device, it takes into account the original bank name\nthe victim attempted to access when the infection process was initiated. A JavaScript\nfunction includes those details and ensures the victim continues to see a consistent\nmessage.\n\nHere too, the ‘Jambo’ word repeats throughout the function, calling into action the jQuery\nlibrary that orchestrates the malware’s script-based activity.\n\n\n-----\n\n_Figure 6: JavaScript function fetches Cerberus malware_\n\nCerberus is being used here only as the component that allows the attackers to bypass the\nbank’s SMS-code verification challenge. The fraudulent transaction itself takes place on the\nvictims’ infected desktops (Windows-based devices). While most fraud is in-session using\nGozi SOCK proxy capability, some access to the victim’s account came from other devices.\n\n## Ursnif’s C2 Communications\n\nThe basics of Ursnif’s command and control (C2) communications are also carried out\nthrough the same channels. Jambo.getScript sends information to srv_dom, which is the\nmalware’s injection server in this case, used to manage the man-in-the-browser activity.\n\n_Figure 7: Injection server communications_\n\nThe core commands botmasters can launch come in where string ‘step=’ appears. Some of\nthe available bot actions are:\n\nCommand Description\n\nADD_INFO Send data to C2: token, SMS content, telephone, download an application.\n\nASK Send communication to the C2.\n\nGET_DROP Check account balance on the victim’s bank account.\n\nGOOD_TRF Attempt to initiate a money transfer transaction.\n\nLOGIN Send victim’s login information to attacker’s C2 server.\n\nPING Check if the infected machine is currently online.\n\n## IBAN Swapping Back in Style\n\nOn the infected desktop, we are back to seeing familiar activity from the Ursnif Trojan. Since\nit hooks the internet browser, it takes different steps to manipulate what victims see on their\nscreens and have them click on elements that launch the Trojan’s resources into action.\n\nOne of the actions Ursnif wishes to take here is to automate transactions that start on the\ndesktop’s browser. To do that, it is designed to swap the international bank account number\n(IBAN) and bank identifier code (BIC) numbers from legitimate transactions for an IBAN of an\naccount the fraudster controls.\n\n\n-----\n\nTo launch its fraudulent transaction flow, Ursnif needs to start a function that would be clicked\nby the infected victim. It, therefore, attempts to replace a login button from the original bank’s\nwebpage and plant its own button that the victim will click. The function launched is named\n‘hookPay()’:\n\n_Figure 8: hookPay() function – Ursnif replaces IBAN number in legitimate transactions_\n\nThe function being used to swap the IBAN and plan the transaction parameters is called\n‘makeTrf()’. The amount being transferred is set to move forward if the account’s balance is\nhigher than €3,000.\n\n_Figure 9: makeTrf() function – Ursnif sets up the fraudulent transaction’s parameters_\n\n## Injections Adapt to Security Challenge\n\nThe configuration file in this campaign targeted the customers of banking institutions in Italy,\nspecifically business banking services. On top of that, the attackers were after e-wallet and\ne-commerce credentials.\n\n\n-----\n\nWeb injections were adapted to each target s security challenge; for example, an injection\ninstructing victims to provide numbers from a hard token.\n\n_[Figure 10: Adapting web injection social engineering to security challenge](https://securityintelligence.com/news/social-engineering-bitcoin-wallet-recovery/)_\n\nVictims are asked to enter the code they received into the web injection and are given a 90second time-lapse to do that, likely also adapted to the time allotted by the targeted bank or\nservice provider:\n\n_Figure 11: Adapting web injection social engineering to security challenge, additional view_\n\nAfter receiving the data from the victim, the malware sends data to the C2 server, including\nauthorization token, SMS content, telephone number and account login information. It then\nshows a .gif file that makes it appear as if the web browser is loading something. After a\ncouple of seconds, the .gif file is hidden, and the malware continues the login process in the\nbackground.\n\n\n-----\n\nTo prevent victims from accessing the account and discovering the fraudulent activity before\nit is finalized, Ursnif presents a maintenance notice on the account. This notice can\neffectively prevent the victim from accessing the account from the infected device.\n\n_Figure 12: Victims are denied access to their bank account to hide fraudulent activity_\n\n## Something Old, Something New — The Ursnif-Cerberus Combo\n\nBanking Trojan operators have always been fans of fraud they can automate. The rollout of\ntwo-factor authentication and strong transaction authorization schemes by online banking\nservices across the globe have caused this entire threat actor class to rethink their tactics,\ntechniques and procedures. Over time, the incorporation of mobile malware into the overall\nscheme of banking Trojan fraud has become a must, since it is the only way to complete\ntransactions. The hindrance remains that malware operators have to continue to find ways to\ninfect more mobile devices, especially when getting into official app stores has been getting\nharder. Also, activating the victim for the initial setup of the automation process is another\nplace where the criminal can fail. Fortunately, these are also the places where defenders can\nhelp prevent fraud.\n\nSeeing Ursnif using Cerberus as its mobile malware component is new, but it is not\nsurprising in the banking Trojan arena. Banking Trojan operators are constantly shifting\ntactics, but the strategy remains the same — they have to gain access to victims’\nsmartphones if they hope to get through security controls applied to banking and other\nservices consumed online. Using Cerberus is also expected since the code was leaked and\ngave the option to any malware operator to make use of it against unsuspecting victims.\n\nIBM Security Trusteer helps organizations detect fraud, authenticate users and establish\nidentity trust across the omnichannel customer journey. Through cloud-based intelligence,\nbacked by artificial intelligence and patented machine learning, Trusteer provides a holistic\napproach to identifying new and existing customers, while improving the user experience.\nMore than 500 leading organizations rely on Trusteer to help secure their customers’ digital\njourney and support business growth. To learn more visit:\n[https://www.ibm.com/security/fraud-protection/trusteer](https://www.ibm.com/security/fraud-protection/trusteer)\n\nTo keep malware off your mobile devices, follow some security hygiene basics:\n\n\n-----\n\nDon t jailbreak a smartphone\n[Only download apps from Google Play’s official store](https://securityintelligence.com/news/joker-malware-hits-google-play-with-17-variants/)\nIf you download from a URL, get your bank’s application via your bank’s website\nDon’t enable sideloading; your bank or service provider will not ask you to load\napplications from unofficial sources\nCheck who is the developer of the app you are downloading; if it does not look right,\nabort the download\nBe wary of excessive app permissions: Only allow apps to use your device for the\npurpose you require and not for unrelated activities\nIf it looks like there’s a new security requirement from your bank, close the browser\nwindow and call your bank with the number on the back of your card to verify what’s\nneeded\nIf a transaction you attempted to carry out is stopped by an apparent ‘maintenance’\nissue, attempt to access the account from a different device or call your bank.\n\n## IOCs\n\n### C2 Servers\n\n*/statppaa/*\n\nhxxp://sanpoloanalytics[.]org/pp_am/\n\n*/statmoflsa/*\n\nhxxp://sanpoloanalytics[.]org/lancher/\n\nMD5 Gozi: b6921ce0f1b94a938acb6896cc8daeba\n\nMD5 Cerberus + APK:\n\n40b8a8fd2f4743534ad184be95299a8e17d029a7ce5bc9eaeb28c5401152460d\n\n**Phishing domains and C&C servers:**\n\n**C&C:**\n\n[hxxps://ecertificateboly.us/lancher/](http://10.10.0.46/hxxps://ecertificateboly.us/lancher/)\n\n[hxxp://sanpoloanalytics.org/lancher/](http://10.10.0.46/hxxp://sanpoloanalytics.org/lancher/)\n\n**Phishing:**\n\n[hxxps://play.google.servlce.store/store/apps/details.php?id=it.phoenixspa.inbank](http://10.10.0.46/hxxps://play.google.servlce.store/store/apps/details.php?id=it.phoenixspa.inbank)\n\n[hxxps://play.gooogle.services/store/apps/details.php?id=com.paypal.android.p2pmobile](http://10.10.0.46/hxxps://play.gooogle.services/store/apps/details.php?id=com.paypal.android.p2pmobile)\n\n[hxxps://google.servlce.store](http://10.10.0.46/hxxps://google.servlce.store)\n\n[hxxps://gooogle.services](http://10.10.0.46/hxxps://gooogle.services)\n\n[hxxps://goooogle.services](http://10.10.0.46/hxxps://goooogle.services)\n\n\n-----\n\n[hxxps://play.google.servlce.store](http://10.10.0.46/hxxps://play.google.servlce.store)\n[hxxps://play.gooogle.services](http://10.10.0.46/hxxps://play.gooogle.services)\n[hxxps://play.goooogle.services](http://10.10.0.46/hxxps://play.goooogle.services)\n\n**IP addresses:**\n\nSOCKS Proxy:\n37.120.222.138:9955\n\nVNC:\n194.76.225.91\n\n[Itzik Chimino](https://securityintelligence.com/author/itzik-chimino/)\nSecurity Web Researcher in Security Intelligence\n\nItzik Chimino is a Security Web Researcher in Security Intelligence, and is experienced in\nmalware analysis. Prior to this role, Itzik worked at \"F5 Networks...\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-23 - Ursnif Leverages Cerberus to Automate Fraudulent Bank Transfers in Italy.pdf"
    ],
    "report_names": [
        "2021-06-23 - Ursnif Leverages Cerberus to Automate Fraudulent Bank Transfers in Italy.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535858,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653691018,
    "ts_modification_date": 1653691018,
    "files": {
        "pdf": "https://archive.orkl.eu/abbf2628b7ab017cedaafe067ddb14e555467b85.pdf",
        "text": "https://archive.orkl.eu/abbf2628b7ab017cedaafe067ddb14e555467b85.txt",
        "img": "https://archive.orkl.eu/abbf2628b7ab017cedaafe067ddb14e555467b85.jpg"
    }
}