{
    "id": "2a5d8dee-d3ed-450a-9635-19cba07395f6",
    "created_at": "2023-01-12T14:59:55.337783Z",
    "updated_at": "2025-03-27T02:14:43.623945Z",
    "deleted_at": null,
    "sha1_hash": "43521e66ff7ab8ad2054281e75c3e84a69ff853d",
    "title": "2017-12-18 - New GnatSpy Mobile Malware Family Discovered",
    "authors": "",
    "file_creation_date": "2022-05-29T01:34:58Z",
    "file_modification_date": "2022-05-29T01:34:58Z",
    "file_size": 398413,
    "plain_text": "# New GnatSpy Mobile Malware Family Discovered\n\n**[trendmicro.com/en_us/research/17/l/new-gnatspy-mobile-malware-family-discovered.html](https://www.trendmicro.com/en_us/research/17/l/new-gnatspy-mobile-malware-family-discovered.html)**\n\nCyber Threats\n\n\nDecember 18, 2017\n\n\nWe came across a new mobile malware family which we have called GnatSpy. We believe that this is a new variant\nof VAMP, indicating that the threat actors behind APT-C-23 are still active.\n\nBy: Ecular Xu, Grey Guo December 18, 2017 Read time: ( words)\n\n[Earlier this year researchers first disclosed a targeted attack campaign targeting various sectors in the Middle East.](https://ti.360.net/blog/uploads/2017/09/22/f41a337e10e992f17986af386a62c7ad.pdf)\n[This threat actor was called Two-tailed Scorpion/APT-C-23. Later on, a mobile component called VAMP was found,](https://researchcenter.paloaltonetworks.com/2017/04/unit42-targeted-attacks-middle-east-using-kasperagent-micropsia/)\n[with a new variant (dubbed FrozenCell) discovered in October. (We detect these malicious apps as](https://blog.lookout.com/frozencell-mobile-threat)\nANDROIDOS_STEALERC32).\n\nVAMP targeted various types of data from the phones of victims: images, text messages, contacts, and call history,\namong others. Dozens of command-and-control (C&C) domains and samples were found, which were soon\ndisabled or detected.\n\nRecently, Trend Micro researchers came across a new mobile malware family which we have called GnatSpy. We\nbelieve that this is a new variant of VAMP, indicating that the threat actors behind APT-C-23 are still active and\ncontinuously improving their product. Some C&C domains from VAMP were reused in newer GnatSpy variants,\nindicating that these attacks are connected. We detect this new family as ANDROIDOS_GNATSPY.\n\nWe do not know for sure how these files were distributed to users. It is possible that threat actors sent them directly\nfor users to download and install on their devices. They had names like “Android Setting” or “Facebook Update” to\nmake users believe they were legitimate. We have not detected significant numbers of these apps in the wild,\nindicating their use is probably limited to specific targeted groups or individuals.\n\nNew capabilities of GnatSpy\n\nThe capabilities of GnatSpy are similar to early versions of VAMP. However, there have been some changes in its\nbehavior that highlight the increasing sophistication of this particular threat actor.\n\n\n-----\n\n**_App structure organization expanded and improved_**\n\nThe structure of the new GnatSpy variants is very different from previous variants. More receivers and services\nhave been added, making this malware more capable and modular. We believe this indicates that GnatSpy was\ndesigned by someone with more knowledge in good software design practices compared to previous authors.\n\n_Figures 1 and 2. Old and new receivers and services_\n\nThe new code also makes much more use of Java annotations and reflection methods. We believe that this was\ndone to evade attempts to detect these apps as malicious.\n\n\n-----\n\n_Figures 3 and 4. Java annotations and reflection methods_\n\n**_C&C servers_**\n\nEarlier versions of VAMP contained the C&C server used in simple plain text, making detection by static analysis\ntools an almost trivial affair.\n\n_Figure 5. C&C server in plaintext_\n\nGnatSpy has changed this. The server is still hardcoded in the malicious app’s code, but is now encoded to evade\neasy detection:\n\n_Figures 6 and 7. Obfuscated C&C server_\n\nA function call is in the code to obtain the actual C&C URL:\n\n_Figures 8 and 9. Function call to obtain C&C server URL_\n\nThe URL hardcoded in the malware is not the final C&C server, however. Accessing the above URL merely sends\nback the location of the actual C&C server:\n\n\n-----\n\n_Figures 10 and 11. Request and response pair for C&C server_\n\nThe WHOIS information of the C&C domains used now uses domain privacy to conceal the registrant's contact\ninformation.\n\n_Figure 12. WHOIS information_\n\nIt’s also worth noting that some of these C&C domains are newly registered, highlighting that these attackers are\nstill active even though their activities have been reported:\n\n_Figure 13. Newly registered C&C domain_\n\nThe domain names used are also curiously named. They used names of persons, but while some names appear to\nbe those of real persons (or plausibly real names), others appear to have been directly taken from various\ntelevision shows. The rationale for using these names remains unclear.\n\nThe version of Apache used has also been updated, from 2.4.7 to 2.4.18. All domains now forbid directory\nindexing; in at least one earlier C&C domain this was left enabled.\n\n_Figure 14. Directory indexing disabled_\n\nWe note here that two of the C&C domains we encountered - specifically, cecilia-gilbert[.]com and lagertha_lothbrok[.]info - were also reported to be connected to VAMP and FrozenCell, respectively. This indicates that the_\nthreat actors behind GnatSpy are likely to be connected to these previous attacks, as well.\n\n\n-----\n\n**_Increased compatibility and stolen information_**\n\nEarlier samples called the System Manager on Huawei devices to grant permissions to itself:\n\n_Figure 15. Code calling app on Huawei devices_\n\nA similar line was added for Xiaomi devices:\n\n_Figure 16. Code calling app on Xiaomi devices_\n\nGnatSpy also includes several function calls targeting newer Android versions (Marshmallow and Nougat):\n\n_Figures 17 and 18. Code for Marshmallow and Nougat Android versions_\n\nMore information about the device is stolen as well, including information about the battery, memory and storage\nusage, and SIM card status. Curiously, while previous samples collected information about the user’s location via\nOpenCellID, this is no longer done by GnatSpy.\n\n**Conclusion**\n\nThreat actors can be remarkably persistent even if their activities have been exposed and documented by\nresearchers. This appears to be the case here. The threat actors behind GnatSpy are not only continuing their illicit\nactivities, but they are also improving the technical capabilities of their malware.\n\n[Trend Micro™ Mobile Security for Android™ detects these malicious apps. End users and enterprises can also](https://www.trendmicro.com/en_us/forHome/products/mobile-security.html)\nbenefit from its multilayered security capabilities that secure the device’s data and privacy, and safeguard them\nfrom ransomware, fraudulent websites, and identity theft.\n\n[For organizations, Trend Micro™ Mobile Security for Enterprise provides device, compliance and application](https://www.trendmicro.com/en_us/forHome/products/mobile-security.html)\nmanagement, data protection, and configuration provisioning, as well as protects devices from attacks that\nleverage vulnerabilities, preventing unauthorized access to apps, as well as detecting and blocking malware and\nfraudulent websites.\n\nTrend Micro’s [Mobile App Reputation Service (MARS) covers Android and iOS threats using leading sandbox and](https://mars.trendmicro.com/)\nmachine learning technologies. It can protect users against malware, zero-day and known exploits, privacy leaks,\nand application vulnerability.\n\nIndicators of Compromise\n\nApps/files with the following hashes are connected to GnatSpy:\n\n\n-----\n\n**SHA256** **Package Name** **Label**\n\n14c846939641eb575f78fc8f1ecb2dc76979a5e08366e1809be24fad240f6ad6 com.app.voice Voice\n\n1b1bff4127c9f868f14bc8f2526358cfc9ff1259b7069ab116e7c52e43f2c669 com.messenger.hike Android\nSetting\n\n1c0e3895f264ac51e185045aa2bf38102da5b340eb3c3c3f6aacb7476c294d62 com.app.updates Messenger\nUpdate\n\n22078e0d00d6a0f0441b3777e6a418170e3a9e4cce8141f0da8af044fdc1e266 com.myapps.update Facebook\nUpdate\n\n232807513c2d3e97bfcc64372d360bd9f7b6b782bd4083e91f09f2882818c0c5 com.myapps.update WhatsApp\nUpdate\n\n313ae27ec66e533f7224d99c1a0c254272818d031456359d3dc85f02f21fd992 com.app.go Android\nSetting\n\n377716c6a2b73c94d3307e9f2ea1a5b3774fa42df452c0867e7384eb45422e4f com.apps.voice Android\nSetting\n\n3c604f5150ea1af994e7411e2816c277ff4f8a02b94d50b6cf4cc951430414bf com.appdev.update Android\nSystem\n\n4842cff6fc7a7a413ceed132f735eee3121ffb03f98453dae966f900e341dd52 com.updates.voice VoiceChat\n\n4e681d242bebf64bbba3f0da91ad109dd14f26e97cd62f306e9fca1603a0009e com.app.lets Android\nSetting\n\n544a1c303ef021f0d54e62a6147c7ae9cd0c84265e302f6da5ed08b616e45b78 com.myapps.update Facebook\nUpdate\n\n566385bff532d1eb26b49363b8d91ed6881f860ffa4b5ddb2bb5fe068bb6c87e com.app.lets Android\nSetting\n\n58ddd057ec7f2420ce94cf3fc52794d0f62603ca7eaf8c5911f55b8b100ac493 com.chatts.me Chat Me\n\n5de5b948aeca6e0811f9625dec48601133913c24e419ce99f75596cb04503141 com.fakebook App\nSystem\nInstaller\n\n6b0325b7020f203d38664be732145c5f9f95fda875c81d136b031618900210a4 com.myapps.update Messenger\nUpdate\n\n6befd9dac5286f72516bba531371dc7769d9efecf56c8a44ce0c8de164662c6b com.app.go Android\nSetting\n\n76962d334b894349a512d8e533c8373b71389f1d20fd814cd8e7ecc89ed8530a com.messenger.hike Android\nSetting\n\n8da31d3102524d6a2906d1ffa1118edf39cf54d72456937bfbae5546e09a3c32 com.app.go Android\nSetting\n\n91b3eeb8ba6853cab5f2669267cf9bccdba389149cc8b2c32656af62bd016b04 com.facebookupdate Facebook\nUpdate\n\n93da08ced346b9958e34bda4fe41062572253472c762a3a837e0dd368fffec8b com.fakebook Android\nSettings\n\na841b71431e19df7e925d10a6e43a965fc68ccbb6523b447de82c516cfba93a8 com.app.lets Android\nSetting\n\naf65aac4f3cf13c88422675b5261acc6c7b5d0af75323a516989a75b0374eddd com.app.chat Chat\n\n\n-----\n\nb6326e17ec8307edf63e731c635fbfa8469d9264cb414592e2d2a5c71093d809 com.apps.voice Android\nSetting\n\nb7007d2039abaf8b8b0db77241d400a8c4d3b48c6fece5d80dc69905d4d272c3 com.apps.voice Android\nSetting\n\nc20438ba8c9e008c1e2eb4343f177757fc260437aeac52df61b156671b07ac14 com.myapps.update Facebook\nUpdate\n\nca8d892a616feaf240bd9e05a250db8ed4d56b7db6348bbaa415dec1e0c626f3 com.app.voice VoiceChat\n\nce4190030372465eceec60ec1687023c99f95a11b9a558f5431074de20747b81 com.app.update WhatsApp\nUpdate\n\nd17308fb06760de1b06d03448a01f3762f2712c1a66b50c8d5f4ac061d6deb27 com.apps.lets Android\nSetting\n\ne2cb9140c47492e7931e0b6629caf5c03cbc4e7a28c7976a28e3158b5d1c67fb com.app.chatous Android\nSetting\n\nebc338f3988e96e9fab53854428ea91dbabd3ee9875464008eafd52c687c3625 com.chat.bestchat Best Chat\n\nec1ed9b064ffbd237e1808d4e156d011b8b77402042b7a6fee92923b69ba65d4 com.app.lets Android\nSetting\n\nefc4a2014f73996fb5d90406a55aa14ac89407fd03cfc89d18ee3251d9fd1af8 com.chat.bestchat Best Chat\n\nf890ba41f6d7d2f2fb4da477adc975be7a3b8068686ff5e863d1a53e56acdfac com.facebook.update Facebook\nUpdate\n\nThe following domains were used by various C&C servers:\n\naryastark[.]info\ncecilia-gilbert[.]com\ncerseilannister[.]info\nclaire-browne[.]info\ndaario-naharis[.]info\nharvey-ross[.]info\njorah-mormont[.]info\nkaniel-outis[.]info\nkristy-milligan[.]website\nlagertha-lothbrok[.]info\nmax-eleanor[.]info\nolivia-hartman[.]info\nragnar-lothbrok[.]info\nrose-sturat[.]info\nsaratancredi[.]info\nuseraccount[.]website\nvictor-stewart[.]info\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-12-18 - New GnatSpy Mobile Malware Family Discovered.pdf"
    ],
    "report_names": [
        "2017-12-18 - New GnatSpy Mobile Malware Family Discovered.pdf"
    ],
    "threat_actors": [
        {
            "id": "b753c6a8-a83d-47bc-829d-45e56136eb7d",
            "created_at": "2023-01-06T13:46:38.97802Z",
            "updated_at": "2025-03-27T02:00:02.967861Z",
            "deleted_at": null,
            "main_name": "GozNym",
            "aliases": [],
            "source_name": "MISPGALAXY:GozNym",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9ff60d4d-153b-4ed5-a2f7-18a21d2fa05d",
            "created_at": "2022-10-25T16:07:23.539852Z",
            "updated_at": "2025-03-27T02:02:09.853285Z",
            "deleted_at": null,
            "main_name": "Desert Falcons",
            "aliases": [
                "APT-C-23",
                "ATK 66",
                "Arid Viper",
                "Operation Arid Viper",
                "Operation Bearded Barbie",
                "Operation Rebound",
                "TAG-63",
                "TAG-CT1",
                "Two-tailed Scorpion"
            ],
            "source_name": "ETDA:Desert Falcons",
            "tools": [
                "AridSpy",
                "Barb(ie) Downloader",
                "BarbWire",
                "Desert Scorpion",
                "FrozenCell",
                "GlanceLove",
                "GnatSpy",
                "KasperAgent",
                "Micropsia",
                "PyMICROPSIA",
                "SpyC23",
                "Viper RAT",
                "ViperRAT",
                "VolatileVenom",
                "WinkChat",
                "android.micropsia"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b1979c55-037a-415f-b0a3-cab7933f5cd4",
            "created_at": "2024-04-24T02:00:49.561432Z",
            "updated_at": "2025-03-27T02:00:55.493381Z",
            "deleted_at": null,
            "main_name": "APT-C-23",
            "aliases": [
                "APT-C-23",
                "Arid Viper",
                "Desert Falcon",
                "TAG-63",
                "Grey Karkadann",
                "Big Bang APT",
                "Two-tailed Scorpion"
            ],
            "source_name": "MITRE:APT-C-23",
            "tools": [
                "Micropsia"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "77c08a4a-b3f9-43ee-9d84-04ba572b7564",
            "created_at": "2024-05-01T02:03:07.927023Z",
            "updated_at": "2025-03-27T02:05:17.248836Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SHADYSIDE",
            "aliases": [
                "Arid Viper ",
                "Desert Falcon ",
                "APT-C-23 "
            ],
            "source_name": "Secureworks:ALUMINUM SHADYSIDE",
            "tools": [
                " SpyC23",
                "Micropsia"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "efe6ff9a-822d-41a6-90c3-45265cac696b",
            "created_at": "2024-05-01T02:03:07.920302Z",
            "updated_at": "2025-03-27T02:05:17.246342Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SARATOGA",
            "aliases": [
                "Arid Viper",
                "Desert Falcon",
                "Extreme Jackal ",
                "Gaza CyberGang",
                "Gaza CyberGang",
                "Molerats ",
                "Operation DustySky ",
                "TA402",
                "APT-C-23"
            ],
            "source_name": "Secureworks:ALUMINUM SARATOGA",
            "tools": [
                " BrittleBush",
                " DarkComet",
                " LastConn",
                " Micropsia",
                " NimbleMamba",
                " PoisonIvy",
                " QuasarRAT",
                " XtremeRat",
                "BlackShades"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "929d794b-0e1d-4d10-93a6-29408a527cc2",
            "created_at": "2023-01-06T13:46:38.70844Z",
            "updated_at": "2025-03-27T02:00:02.897573Z",
            "deleted_at": null,
            "main_name": "AridViper",
            "aliases": [
                "Arid Viper",
                "APT-C-23",
                "Bearded Barbie",
                "Desert Falcon"
            ],
            "source_name": "MISPGALAXY:AridViper",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535595,
    "ts_updated_at": 1743041683,
    "ts_creation_date": 1653788098,
    "ts_modification_date": 1653788098,
    "files": {
        "pdf": "https://archive.orkl.eu/43521e66ff7ab8ad2054281e75c3e84a69ff853d.pdf",
        "text": "https://archive.orkl.eu/43521e66ff7ab8ad2054281e75c3e84a69ff853d.txt",
        "img": "https://archive.orkl.eu/43521e66ff7ab8ad2054281e75c3e84a69ff853d.jpg"
    }
}