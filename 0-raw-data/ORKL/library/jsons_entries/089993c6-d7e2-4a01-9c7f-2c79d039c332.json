{
    "id": "089993c6-d7e2-4a01-9c7f-2c79d039c332",
    "created_at": "2023-01-12T15:00:18.113468Z",
    "updated_at": "2025-03-27T02:16:28.886182Z",
    "deleted_at": null,
    "sha1_hash": "30797a31636c766a6f2c2cb9da8f8a3718c9eee2",
    "title": "2021-05-06 - RotaJakiro, the Linux version of the OceanLotus",
    "authors": "",
    "file_creation_date": "2022-05-29T00:56:35Z",
    "file_modification_date": "2022-05-29T00:56:35Z",
    "file_size": 725844,
    "plain_text": "# RotaJakiro, the Linux version of the OceanLotus\n\n**[blog.netlab.360.com/rotajakiro_linux_version_of_oceanlotus/](https://blog.netlab.360.com/rotajakiro_linux_version_of_oceanlotus/)**\n\nAlex.Turing May 6, 2021\n\n6 May 2021 / [Botnet](https://blog.netlab.360.com/tag/botnet/)\n[On Apr 28, we published our RotaJakiro backdoor blog, at that time, we didnâ€™t have the](https://blog.netlab.360.com/stealth_rotajakiro_backdoor_en/)\nanswer for a very important question, what is this backdoor exactly for? We asked the\ncommunity for clues and two days ago we got a hint, `PE (Thanks!) wrote the following`\ncomment on our blog post.\n\nThe [sample mentioned in the message is a zip packing file, which has appeared in 2016.](https://www.virustotal.com/gui/file/b33370167853330704945684c50ce0af6eb27838e1e3f88ea457d2c88a223d8b/detection)\nThe zip contains multiple files, the Mach-O format executable file named `Noi dung chi`\n```\ntiet (translated to detailed information ) is the OceanLotus sample. When we\n\n```\ncompare the this file with the RotaJakiro sample, we noticed there are multiple similarities\nand it is `VERY likely that this is the Linux version of the OceanLotus.`\n\n## Similarity 1: Function for C2 session creation\n\nThe common domain name resolution function for Linux is `gethostbyname(), but`\nRotaJakiro uses the relatively niche `getaddrinfo() function. C2 domain name resolution`\nand session establishment are performed in one function, this is also used by the the\nOceanLotus sample. The comparison of the 2 functions is as follows.\n\nIt can be seen that they not only have the same function, but also use `sprintf() and`\n```\ngetaddrinfo() in almost exactly the same way. In addition, both RotaJakiro and\n\n```\n\n-----\n\nOceanLotus use separate data structures to hold C2 session information, such as `socket`\n```\nfd, whether active, timeout, etc., and their data structures are also very similar.\n\n## Similarity 2: registration packet construction method\n\n```\nThe network packets of both RotaJakiro and OceanLotus are composed of Head, Key, and\n```\nPayload, of which Head is mandatory and has a length of 82 bytes, while Key and Payload\n\n```\nare optional.\n\nOffset 1, type DWORD, which holds a magic.\nOffset 9, type DWORD, holding the length of the Payload.\nOffset 13, type WORD, holding the Key length.\nOffset 15, type DWORD, holds the message code.\n\n\n-----\n\nThe RotaJakiro initializes the Head of the registration packets with a separate function.\n\nThis function first calls the malloc() function to dynamically allocate memory for the\nregistrationpacket, then calls the time()/srand()/rand() function in turn to generate a random\ncharacter and then assign it to the first field of the registration packet, and the remaining\nlarge swath of code is to assign values to the remaining fields one by one with multiple\nconstants, so the most obvious feature of this function is to `initialize the`\n```\nregistration packet with multiple constants .\n\n```\nThere is also a function in the OceanLotus sample that is dedicated to initializing the Head of\nthe registration packets.\n\n\n-----\n\nThis function has no code for memory allocation and random character generation, and the\nwhole function uses multiple constants to assign values to specific fields of the registration\npacket one by one, `exactly like the RotaJakiro . In addition, OceanLotus shares the`\nsame field values with RotaJakiro at offsets 1, 24 and 75, especially the magic at offset 1 is\n```\n0x3B91011, which is hard to describe as a coincidence, so it greatly increases the\n\n```\nprobability that these two pieces of code are the same origin. In addition, both the RotaJakiro\nand the OceanLotus have assigned message codes to the registration packets, and both are\n```\n0x2170272 :\n\n```\n\n-----\n\nThe resulting registration packets is also very similar, and the RotaJakiro registration packets\nis as follows.\n\n[The following is the OceanLotus registration packets analyzed by PAN in 2017.](https://unit42.paloaltonetworks.com/unit42-new-improved-macos-backdoor-oceanlotus/)\n\nThe decrypted registration packets for the RotaJakiro is shown below.\n\n[The following is the OceanLotus plaintext registration packets from PAN's analysis.](https://unit42.paloaltonetworks.com/unit42-new-improved-macos-backdoor-oceanlotus/)\n\nYou can see that they have the same plaintext structure and basically the same key field\nvalues.\n\n## Similarity 3: rotate function\n\n\n-----\n\nBoth RotaJakiro and OceanLotus have a function we called `rotate() for`\nencryption/decryption, the rotate function of RotaJakiro is as follows.\n\n\n-----\n\nFor OceanLotus\n\nIt is easy to see the commonalities between them.\n\n1. Both accept 3 parameters.\n2. The prototype is the same, where the first parameter is the actual rotate object, the\n\nsecond parameter is the length field, and the third parameter plays a control role.\n\nIn actual use, for example, in the process of encrypting the registration packets, you can see\nthat the RotaJakiro and the OceanLotus `use the same parameters .`\n\n## Similarity 4: Same instruction code\n\nBoth RotaJakiro and OceanLotus use DWORD type instruction codes to specify the function\nof the message, and share several semantically identical instruction codes, some of which\nare featured as shown in the following table.\n\n**Cmd** **Function**\n\n\n-----\n\n**Cmd** **Function**\n\n0x18320e0 Upload device Info\n\n0x2170272 Register\n\n0x1B25503 execute function from a plugin(a aynamic library)\n\n0x1532e65 execute function from a plugin(a aynamic library)\n\n0x25D5082 execute function from a plugin(a aynamic library)\n\nThis similarity obviously cannot be explained by coincidence, it is an extremely strong\n**evidence of their code homology.**\n\n## Summary\n\nAlthough the RotaJakiro and the Mac version of the OceanLotus are implemented in different\nlanguages, their similarity in function and message format design, and their similarity in\nspecific implementation, can no longer be explained by coincidence. It is highly likely that\n**RotaJakiro is a Linux version of the OceanLotus.**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-06 - RotaJakiro, the Linux version of the OceanLotus.pdf"
    ],
    "report_names": [
        "2021-05-06 - RotaJakiro, the Linux version of the OceanLotus.pdf"
    ],
    "threat_actors": [
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535618,
    "ts_updated_at": 1743041788,
    "ts_creation_date": 1653785795,
    "ts_modification_date": 1653785795,
    "files": {
        "pdf": "https://archive.orkl.eu/30797a31636c766a6f2c2cb9da8f8a3718c9eee2.pdf",
        "text": "https://archive.orkl.eu/30797a31636c766a6f2c2cb9da8f8a3718c9eee2.txt",
        "img": "https://archive.orkl.eu/30797a31636c766a6f2c2cb9da8f8a3718c9eee2.jpg"
    }
}