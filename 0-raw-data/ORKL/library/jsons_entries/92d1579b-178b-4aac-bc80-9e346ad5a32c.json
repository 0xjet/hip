{
    "id": "92d1579b-178b-4aac-bc80-9e346ad5a32c",
    "created_at": "2023-01-12T14:59:50.344823Z",
    "updated_at": "2025-03-27T02:16:59.245075Z",
    "deleted_at": null,
    "sha1_hash": "b49aca216d29f471e8a70f8bf236337d0c463ee8",
    "title": "2012-02-15 - Merchant of Fraud Returns- Shylock Polymorphic Financial Malware Infections on the Rise",
    "authors": "",
    "file_creation_date": "2022-05-28T03:58:18Z",
    "file_modification_date": "2022-05-28T03:58:18Z",
    "file_size": 1145212,
    "plain_text": "# Shylock Polymorphic Financial Malware Infections on the Rise\n\n**[securityintelligence.com/merchant-of-fraud-returns-shylock-polymorphic-financial-malware-infections-on-the-rise/](https://securityintelligence.com/merchant-of-fraud-returns-shylock-polymorphic-financial-malware-infections-on-the-rise/)**\n\nFebruary 15, 2012\n\n[Home&nbsp/](https://securityintelligence.com/) [Banking & Finance](https://securityintelligence.com/category/topics/banking-financial-services-industry/)\nMerchant of Fraud Returns: Shylock Polymorphic Financial Malware Infections on the Rise\n\n\n-----\n\n[Banking & Finance February 15, 2012](https://securityintelligence.com/category/topics/banking-financial-services-industry/)\nBy [Amit Klein 2 min read](https://securityintelligence.com/author/amit-klein/)\nLast September, we blogged about a new polymorphic financial malware variant we had\ndiscovered. We code-named it “Shylock” because every new build bundles random excerpts\nfrom William Shakespeare’s “The Merchant of Venice” in its binary. These are designed to\nchange the malware’s file signature to avoid detection by antivirus programs and security\nsoftware.\n\nIn recent weeks, we have seen a significant increase in the number of end-user machines\ninfected with Shylock. One of this malware’s distinguishing characteristics is its ability to\nalmost completely avoid detection by antivirus scanners after installation. Shylock uses a\nunique three-step process to evade scanners:\n\n## Step 1: Financial Malware Hides in Memory\n\n\n-----\n\n[Shylock injects itself into all running processes (applications) in memory. Every time a new](https://securityintelligence.com/back-basics-malware-authors-downgrade-tactics-stay-radar)\napplication is initialized, Shylock suspends the application from running in memory, injects\nitself into the application process and then allows the application to proceed with its normal\nexecution. Once installed, Shylock code doesn’t run as a separate process; rather, it embeds\nitself within every genuine application running on a machine. This makes it very hard to\ndetect. Moreover, even if Shylock is detected, the fact that it is embedded in multiple running\napplications makes it almost impossible to stop and remove from memory.\n\n## Step 2: Watchdog Senses Scans\n\nShylock looks for and intercepts operations related to directory browsing and enumeration of\nregistry keys, which indicate an antivirus scanning operation is underway. Once it detects\n“scanning” activity, Shylock deletes its own files and registry entries, making it undetectable.\nIt remains active only in memory.\n\n## Step 3: Hijacks Windows’ Shutdown\n\nEntries in the operating system registry allow malware (like any application or process) to\nexecute its files as part of the start-up processes. Once Shylock has removed its files and\nregistry entries to avoid being detected by an antivirus scan, it cannot survive a system\nshutdown/reboot. Any of these actions would remove it from memory and eliminate the\ninfection. To ensure its survival, Shylock hooks into the Windows shutdown procedure and\nreinstates the files and registry keys (previously removed in Step 2) just before the system is\n[completely shut down and after all applications are closed, including antivirus applications.](https://securityintelligence.com/are-you-digging-deep-when-antivirus-is-not-enough)\n\nWe have found that physically unplugging the machine’s power source (assuming it does not\nhave an internal battery) after Shylock has deleted its files and registry entries to evade\ndetection will clean the memory and also the Shylock infection. Needless to say, we do not\nrecommend this as a malware-removal practice.\n\n[Antivirus |](https://securityintelligence.com/tag/antivirus/) [Financial Malware |](https://securityintelligence.com/tag/financial-malware/) [Malware |](https://securityintelligence.com/tag/malware/) [Malware Injection |](https://securityintelligence.com/tag/malware-injection/) Operating System\n(OS) | [Shylock |](https://securityintelligence.com/tag/shylock/) [Threat Detection |](https://securityintelligence.com/tag/threat-detection/) [Windows](https://securityintelligence.com/tag/windows/)\n[Amit Klein](https://securityintelligence.com/author/amit-klein/)\nCTO, Trusteer, an IBM company\n\nAs Trusteer’s CTO, Amit Klein is responsible for researching and introducing game changing\ntechnologies into Trusteer’s products, with particular focus o...\n\n\n-----\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2012/2012-02-15 - Merchant of Fraud Returns- Shylock Polymorphic Financial Malware Infections on the Rise.pdf"
    ],
    "report_names": [
        "2012-02-15 - Merchant of Fraud Returns- Shylock Polymorphic Financial Malware Infections on the Rise.pdf"
    ],
    "threat_actors": [
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535590,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653710298,
    "ts_modification_date": 1653710298,
    "files": {
        "pdf": "https://archive.orkl.eu/b49aca216d29f471e8a70f8bf236337d0c463ee8.pdf",
        "text": "https://archive.orkl.eu/b49aca216d29f471e8a70f8bf236337d0c463ee8.txt",
        "img": "https://archive.orkl.eu/b49aca216d29f471e8a70f8bf236337d0c463ee8.jpg"
    }
}