{
    "id": "c5fe6bdf-bc35-4add-b81f-0f07cd59899b",
    "created_at": "2023-01-12T15:10:05.754396Z",
    "updated_at": "2025-03-27T02:17:27.759558Z",
    "deleted_at": null,
    "sha1_hash": "79b797c7dee1ec0109603419c369524009253a31",
    "title": "2022-05-11 - Please Confirm You Received Our APT",
    "authors": "",
    "file_creation_date": "2022-05-28T02:16:55Z",
    "file_modification_date": "2022-05-28T02:16:55Z",
    "file_size": 676799,
    "plain_text": "# Please Confirm You Received Our APT\n\n**fortinet.com/blog/threat-research/please-confirm-you-received-our-apt**\n\nMay 11, 2022\n\nBecause we are constantly monitoring the threat landscape, FortiGuard Labs has the opportunity to see many unique and\nnovel attacks. Recently, one of our sample collectors was able to find one such incident. It began with a spearphishing email to\na diplomat in Jordan. Like many of these attacks, the email contained a malicious attachment. However, the attached threat\nwas not a garden-variety malware. Instead, it had the capabilities and techniques usually associated with advanced persistent\n[threats (APTs). Based on the techniques used in this attack, it appears to be another campaign launched by APT34. The rest](https://www.fortinet.com/resources/cyberglossary/advanced-persistent-threat?utm_source=blog&utm_medium=+&utm_campaign=apt)\nof this blog will analyze the attack chain associated with this email and the traits that set it apart from average malware, such\nas DNS tunneling and stateful programming.\n\n**Affected Platforms: Microsoft Windows**\n\n**Impacted Users: Targeted Windows users**\n\n**Impact: Collects sensitive information from the compromised machine**\n\n**Severity Level: Medium**\n\n## Spearphishing Email\n\nThis spearphishing attack targeted a Jordanian diplomat, with the sender pretending to be a colleague from the IT department\nof the same governmental organization.\n\nFigure 1. Spearphishing email\n\n\n-----\n\nLooking at the headers of the email, we can determine that the email originated from outside the organization. But while it\ncame from an external email address, it used the first and last name of an employee in the IT department. The alert diplomat\ndecided to forward this to the real employee. This may have been done to verify the authenticity of the original email or, more\nlikely, for further analysis within the IT department. As suggested in the email body, the attached Excel file contained a\nconfirmation form for the targeted diplomat to fill out.\n\n[For those technically inclined, the next few sections break down the “how” and “what happened” of this malware. Other](https://www.fortinet.com/resources/cyberglossary/malware?utm_source=blog&utm_campaign=malware)\nreaders should feel free to skip to the “C2 Servers” section for details on how to protect your organization.\n\n## Malicious Excel File\n\nThe attached Excel file contains a malicious VBA (Visual Basic Application) macro as opposed to the Excel MacroSheets that\nother malware such as Emotet and QBot typically use. In many cases, a malicious macro may install some sort of stager, such\nas those deployed by Cobalt Strike or Metasploit. In other cases, the macro may use living-off-the-land techniques to\ndownload and execute a second-stage binary. Another option a macro may use is to simply drop and run a malicious binary. In\nthis attack, the macro uses the latter option. This, however, was where similarities to other phishing attacks end.\n\nFigure 2. Macro opening\n\nOne of the unique techniques seen in this macro is the toggling of sheet visibility. In most attacks involving Excel, no hidden\nsheets are used. And in those cases where hidden sheets are used, the hidden sheet typically holds the malicious code. In\nthis attack, however, the visibility of two sheets is quickly switched as soon as the workbook is opened. One possible reason\nfor this may be as an anti-emulation technique. Emulators (such as the freely available ViperMonkey) may or may not support\nall Excel functionality, such as the hiding of sheets.\n\nIncidentally, lines 16 and 17 are commented out. Perhaps these lines were used for testing purposes or were part of a different\nlure, one in which TeamViewer (remote access and control software used for device maintenance) was used.\n\nThe astute observer may have also noticed line 25 in the previous image. Line 25 calls a function that contacts the C2 server.\n\nFigure 3. C2 contact\n\nUnlike most malicious macros, this one uses WMI (Windows Management Instrumentation) to ping the C2 server instead of a\nmore commonly used tool, such as PowerShell or CMD. Furthermore, this function is called multiple times during macro\nexecution. It basically works as a state monitor to keep track of what’s happening during the attack. The tMsg variable\nchanged during different stages of the attack, allowing the attackers to view their network logs to see the state of their macro.\nThe rds variable is a random four-digit number, with the same four digits used consistently throughout the macro state check-in\nprocess.\n\n**C2** **Macro State**\n\nqwzbabz[four-digits].joexpediagroup[.]com Macro start\n\nqwzbbbz[four-digits].joexpediagroup[.]com Connected successfully to task scheduler\n\nqwzbaez[four-digits].joexpediagroup[.]com Successfully created malicious PE file\n\nqwzbbez[four-digits].joexpediagroup[.]com Successfully created XML config file\n\nqwzbcez[four-digits].joexpediagroup[.]com Successfully created signed Microsoft PE file\n\nqwzbdez[four-digits].joexpediagroup[.]com Double-check malicious PE file was created\n\nqwzbeez[four-digits].joexpediagroup[.]com Successful manual execution of malicious PE file\n\n\n-----\n\nqwzafzz[four-digits].joexpediagroup[.]com Begin task scheduler configuration for persistence\n\nqwzbbfz[four-digits].joexpediagroup[.]com Successfully created scheduled task\n\nFigure 4. Table of states\n\nAs alluded to in the table above, the macro has the capability to create three files. A malicious PE file was created\nas %LocalAppData%\\MicrosoftUpdate\\update.exe. A configuration file was created\nas %LocalAppData%\\MicrosoftUpdate\\update.exe.config. And the third\nfile, %LocalAppData%\\MicrosoftUpdate\\Microsoft.Exchange.WebServices.dll, was signed and clean.\n\nWhile the malware authors decided to store these three files inside the Excel file, they again chose to do so in a way that is not\ncommonly seen.\n\nFigure 5. Form caption\n\nThree user forms are stored inside the Excel file. Each user form has a label, and each label has a caption. As seen in the\nimage above, the caption contains base64 encoded data. Form1 contains the malicious update.exe file. Form2 contains the\nconfiguration file. And Form3 contains the clean Microsoft file. We will explore these files further later in this blog.\n\nThe malware authors also used the Excel macro to create a persistence method for their update.exe file. They accomplished\nthis by setting a scheduled task.\n\nFigure 6. Scheduled task\n\nThe task is named MicrosoftUpdate and repeats every 4 hours. The macro also uses deprecated IdleSettings properties, such\nas Duration (which starts the task only if the computer has been idle for ten minutes) and WaitTimeout (which determines how\nlong to wait for an idle condition). This task was set to allow 20 days to complete. Taking into account the date of the email and\nassuming the task ran immediately, the task would run until at least May 16, 2022.\n\nIn addition to the visibility switch technique described earlier, a second technique was also seen in this macro to possibly avoid\nautomated analysis. This macro does this by checking for the existence of a mouse. If a mouse is not connected, the macro\ndoes not create any of the three files. There are a couple of instances where a mouse would not be attached to a computer.\nFirst, a mouse is not necessarily needed if the computer is controlled remotely. The only mouse needed would be installed on\nthe controlling computer. And second, a mouse is not needed if an analysis machine is simply processing and emulating Office\nfiles. A script can be created to automatically perform all the actions necessary without a mouse.\n\nAs far as malicious macros go, this one contains several techniques not normally seen in most attacks. This suggests that\nmore time and care have been given to developing this portion of the attack. In the next section, we will look at the files that\nwere created by this macro.\n\n## Dropped Files\n\nAs explained earlier, this malicious Excel macro includes the ability to create three files. In this section, we will look at them\nindividually, starting with the two benign files.\n\nA signed file was embedded inside the Excel file and dropped to the following\nlocation: %LocalAppData%\\MicrosoftUpdate\\Microsoft.Exchange.WebServices.dll. Another innocuous file was dropped\nas %LocalAppData%\\MicrosoftUpdate\\update.exe.config. Its contents are to be used as configuration data. Here are the\ncontents after decoding:\n\nFigure 7. Config data\n\nThe third file is the actual malware. It was created in the same location as the two previously dropped files,\nas %LocalAppData%\\MicrosoftUpdate\\update.exe. It was a .NET binary and contained the main payload.\n\nThis malware binary was certainly developed by the same group that created the Excel macro, as there are similarities\nbetween the two. One similarity deals with the idea of states and the tracking of what was happening at any given point in time\nwithin the execution flow. Since .NET is a more robust programming language than the scripting nature of VBA, the malware\n\n\n-----\n\nbinary has a much easier way of keeping state.\n\nFigure 8. Dictionary of states\n\nThe figure above shows a partial state dictionary defined by the malware. Depending on the execution flow and what state the\nmalware lands in, certain delays are introduced.\n\nFigure 9. Delay times in milliseconds\n\nThese delays are executed by calling the Sleep() function. In .NET, Sleep() accepts values in milliseconds. In certain cases, for\nexample, from DelayMinAlive to DelayMaxAlive, the malware can sleep anywhere from 6 to 8 hours!\n\nWhile this malware sleeps in certain program states, other program states require it to contact the C2 server. Like the Excel\nmacro, it contacts seemingly random subdomains. However, in actuality, it uses a [domain generation algorithm (DGA) to](https://en.wikipedia.org/wiki/Domain_generation_algorithm)\ncalculate a subdomain.\n\nFigure 10. DGA\n\nThe malware constructs the DGA by first randomly assigning a value to _AgentID. This value is then fed as a seed into\nthe RandomMersenneTwister function, highlighted above. It then performs further calculations using the haruto string as well\nas the strings found in the CharsDomain and CharsCounter variables. Once a subdomain string is generated, the malware\nrandomly chooses one of three domains to concatenate with (joexpediagroup[.]com, asiaworldremit[.]com, or uber-asia[.]com).\n\nOnce the URL is generated, the next step the malware takes is to check for the C2 server’s DNS data.\n\nFigure 11. DNS\n\nWhen DNS is queried for a domain, a DNS server returns an IP address that points to the requested domain. The malware\nthen checks the first octet of the IP address to ensure the value is at least 128 to be considered valid. Perhaps this is a way for\nthe malware to avoid internal IP addresses, such as the 127[.]0[.]0[.]1 local loopback address or the 10[.]0[.]0[.]0 internal\nsubnet. Lines 260-261 are used to define the byte array DnsClass._ReceiveData with a size defined by the remaining octets.\nFor example, a DNS test server is set up to return the IP address 192[.]5[.]4[.]3 for any DNS requests. That means the byte\narray has a size of 0x050403. Later in the malware’s execution flow, this data from the DNS request is used to\ndefine TaskClass properties.\n\nFigure 12. DNS tunneling\n\nSpecifically on line 245, TaskClass.ListData is set to the received data from the DNS request. In the end, this basically means\nthat this malware is receiving tasks inside a DNS response. Apparently, this malware uses DNS tunneling to communicate with\nits C2. APT34 has historically used DNS for communications as well.\n\nSeveral types of tasks are defined for this malware.\n\nFigure 13. Task types\n\nThis malware has the ability to take a DNS response and create an arbitrary file on the infected machine if that was the task\nthe malware authors wanted to perform. File and CompressedFile are task types used to create a file. The remaining task\ntypes are used to send backdoor commands to the malware. These backdoor commands are meant to be executed through\nPowerShell or through the Windows CMD interpreter. The following table lists supported commands.\n\n**Command** **Interpreter** **Payload**\n\n1 PS Get-NetIPAddress -AddressFamily IPv4 | Select-Object IPAddress\n\n2 PS Get-NetNeighbor -AddressFamily IPv4 | Select-Object \"IPADDress\"\n\n3 CMD whoami\n\n4 PS [System.Environment]::OSVersion.VersionString\n\n\n-----\n\n5 CMD net user\n\n7 PS Get-ChildItem -Path \"C:\\Program Files\" | Select-Object Name\n\n8 PS Get-ChildItem -Path 'C:\\Program Files (x86)' | Select-Object Name\n\n9 PS Get-ChildItem -Path 'C:' | Select-Object Name\n\n10 CMD hostname\n\n11 PS Get-NetTCPConnection | Where-Object {$_.State -eq \"Established\"} | Select-Object\n\"LocalAddress\", \"LocalPort\", \"RemoteAddress\", \"RemotePort\"\n\n12 PS $(ping -n 1 10.65.4.50 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.4.51 | findstr /i ttl) -eq $null;$(ping\n-n 1 10.65.65.65 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.53.53 | findstr /i ttl) -eq $null;$(ping -n 1\n10.65.21.200 | findstr /i ttl) -eq $null\n\n13 PS nslookup ise-posture.mofagov.gover.local | findstr /i Address;nslookup webmail.gov.jo | findstr /i\nAddress\n\n14 PS $(ping -n 1 10.10.21.201 | findstr /i ttl) -eq $null;$(ping -n 1 10.10.19.201 | findstr /i ttl) -eq\n$null;$(ping -n 1 10.10.19.202 | findstr /i ttl) -eq $null;$(ping -n 1 10.10.24.200 | findstr /i ttl) -eq\n$null\n\n15 PS $(ping -n 1 10.10.10.4 | findstr /i ttl) -eq $null;$(ping -n 1 10.10.50.10 | findstr /i ttl) -eq\n$null;$(ping -n 1 10.10.22.50 | findstr /i ttl) -eq $null;$(ping -n 1 10.10.45.19 | findstr /i ttl) -eq\n$null\n\n16 PS $(ping -n 1 10.65.51.11 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.6.1 | findstr /i ttl) -eq $null;$(ping\n-n 1 10.65.52.200 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.6.3 | findstr /i ttl) -eq $null\n\n17 PS $(ping -n 1 10.65.45.18 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.28.41 | findstr /i ttl) -eq\n$null;$(ping -n 1 10.65.36.13 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.51.10 | findstr /i ttl) -eq\n$null\n\n18 PS $(ping -n 1 10.10.22.42 | findstr /i ttl) -eq $null;$(ping -n 1 10.10.23.200 | findstr /i ttl) -eq\n$null;$(ping -n 1 10.10.45.19 | findstr /i ttl) -eq $null;$(ping -n 1 10.10.19.50 | findstr /i ttl) -eq\n$null\n\n19 PS $(ping -n 1 10.65.45.3 | findstr /i ttl) -eq $null;$(ping -n 1 10.65.4.52 | findstr /i ttl) -eq $null;$(ping\n-n 1 10.65.31.155 | findstr /i ttl) -eq $null;$(ping -n 1 ise-posture.mofagov.gover.local | findstr /i ttl)\n-eq $null\n\n20 PS Get-NetIPConfiguration | Foreach IPv4DefaultGateway | Select-Object NextHop\n\n21 PS Get-DnsClientServerAddress -AddressFamily IPv4 | Select-Object SERVERAddresses\n\n22 CMD systeminfo | findstr /i \\\"Domain\\\"\n\nFigure 14. Table of backdoor commands\n\nThe 6 command is actually missing from this malware. Whether a file is uploaded or a backdoor command is executed, there\nis some sort of output. This output is then formatted and compressed using .NET’s compression mode. After the result is\nencoded with base32 this new result is then incorporated into the DGA Base32 is also the same encoding scheme that\n\n\n-----\n\nAPT34 has used.\n\nFigure 15. DNS exfiltration\n\nThis is how the malware exfiltrated the data. It may look like a simple DNS request in a network log, but the exfiltrated data is\nactually built into the DNS request.\n\nWith the amount of work put into developing this malware, it does not appear to be the type to execute once and then delete\nitself, like other stealthy infostealers. Perhaps to avoid triggering any behavioral detections, this malware also does not create\nany persistence methods. Instead, it relies on the Excel macro to create persistence by way of a scheduled task. Since Excel\nis a signed binary, maintaining persistence in this way may be missed by some behavioral detection engines. The problem\nwith using a scheduled task as a persistence mechanism, however, is that it runs the risk of having multiple copies of itself\nrunning concurrently. To avoid this problem, the malware creates a mutex. A [mutex (mutual exclusion object) is a program](https://en.wikipedia.org/wiki/Lock_(computer_science))\nobject that is created so multiple program threads can take turns sharing the same resource. In its most basic definition, it is\nsimply a locking mechanism. If a mutex with a value of 726a06ad-475b-4bc6-8466-f08960595f1e already exists on the\nsystem, it means there is already a previous instance of the malware running on the infected computer. As a result, if a\nscheduled task starts another copy of the malware, the malware detects the mutex, and it is terminated immediately.\n\n## C2 Servers\n\nThis malware has the ability to contact three domains (joexpediagroup[.]com, asiaworldremit[.]com, uber-asia[.]com). Similarly,\nthe Excel macro is able to contact the joexpediagroup[.]com domain.\n\n### Uber-asia[.]com\n\nThis domain, which may be imitating Uber rideshare for Asia, was registered slightly more than two months ago, on February\n27, 2022. According to passive DNS records, this domain resolves to 127[.]0[.]0[.]1. Interestingly enough, VirusTotal was able\nto record a DNS entry.\n\nFigure 16. Virustotal DNS results\n\nThis certainly fits the format used by the malware. The subdomain appears to be a DGA. The first octet of the IP address is\ngreater than 128, and the remaining octets define the size of the command to be executed. Unfortunately, the rest of the DNS\ndata is not available. This suggests that the malware operators are closely monitoring this C2 server and only activate it when\nnecessary.\n\n### Joexpediagroup[.]com\n\nThis domain, which may be imitating Expedia travel for Jordan, was created earlier this year, on January 20, 2022. Sometime\nafter April 20, 2022, this domain also started resolving to 127[.]0[.]0[.]1, most likely for the same reason as above. Prior to that,\nhowever, the domain resolved to 45[.]11[.]19[.]47. The server also had SSH port 22 open. Our own Fortinet telemetry detected\nsomeone connecting to this IP address from the country of Jordan.\n\n### Asiaworldremit[.]com\n\nThis domain, which may be imitating WorldRemit for Asia, was created on the same day as the first C2 server, on February 27,\n2022. Around April 19, 2022, this domain also resolved to 127[.]0[.]0[.]1. Prior to that, however, it resolved to\n193[.]239[.]84[.]207. In the past, this IP address has been used by the NSO group with their Pegasus spyware. According to\nour telemetry, this IP address has also been used by APT34/OilRig/Helix Kitten and GoziIFSB. It has also been used as a VPN\naddress. Passive DNS records indicate the IP address is currently hosting several suspiciously-named domains, some of\nwhich are listed below.\n\n**Registered Domain** **Attempting to masquerade as**\n\nastrazeneeca[.]com AstraZeneca\n\nastrazencea[.]com AstraZeneca\n\n\n-----\n\nhsbcbkcn[.]com HSBC Bank China\n\nvaltronics-ae[.]com Valtronics AE\n\nntu-sg-edu[.]com Nanyang Technological University Singapore\n\ntheworldbank[.]uk World Bank Group\n\ncoinbasedeutschland[.]com Coinbase for Germany\n\ncisco0[.]com Cisco\n\nFigure 17. Fake domains\n\nThe three C2 domains used by this malware seem to have a similar naming convention as the other domains found on this IP\naddress.\n\n## Conclusion\n\nThe amount of effort put into developing this attack is much higher than the average run-of-the-mill phishing/spam campaign,\nputting it on the level of an APT attack. From the start, the attackers posed as a valid user and kept the email short without any\ngrammatical errors. They then proceeded to use an Excel macro with advanced techniques, including possible anti-analysis\ntechniques with the mouse check and the sheet visibility switch.\n\nFurthermore, while state programming is rarely used in malware, in this attack, both the Excel macro and the malware make\nuse of it. After checking in, the malware sleeps for 6-8 hours. One likely reason might be that the threat actors expected the\ndiplomat to open the spearphishing email in the morning and then leave at the end of the day. At that point, the attackers\nwould be free to operate.\n\nWhile using DNS tunneling for C2 communications is nothing new, it is rarely seen in practice. Their backdoor also supports a\nlong list of very specific commands. From the looks of things, the threat actors did their homework since their backdoor\ncommands clearly demonstrate they already had prior knowledge of their target’s internal network infrastructure. This indicates\nthat the threat actors most likely gained limited access somewhere else before this spearphishing attempt was made.\n\nLooking at their C2 servers, two out of the three seem to be tightly controlled. They were only brought up at specific times. The\nthird C2 server has been lumped in with various other domains to further complicate proper attribution. Given all the\nbreadcrumbs, this campaign looks to be another one launched by APT34. They have demonstrated they possess the\nresources necessary to infiltrate a government network and are no strangers to using more advanced techniques.\n\n### Fortinet Protections\n\nFortinet customers are protected from this malware by FortiGuard’s [Web Filtering, AntiVirus,](https://www.fortinet.com/support-and-training/support-services/fortiguard-security-subscriptions/web-filtering.html?utm_source=blog&utm_campaign=web-filtering) [FortiMail,](https://www.fortinet.com/products/email-security/fortimail.html?utm_source=blog&utm_campaign=fortimail-main-page) [FortiClient,](https://www.fortinet.com/products/endpoint-security/forticlient.html?utm_source=blog&utm_campaign=endpoint-web-page) [FortiEDR,](https://www.fortinet.com/products/endpoint-security/fortiedr.html?utm_source=blog&utm_campaign=fortiedr)\nand CDR (content disarm and reconstruction) services:\n\nThe FortiGuard Antivirus service detects and blocks the malicious Excel file as MSExcel/Agent.7CCA!tr and the malware\nbinary as MSIL/Agent.A52D!tr.\n\nThe malicious macros inside the Excel sample can be disarmed by the FortiGuard CDR (content disarm and reconstruction)\nservice.\n\n[FortiEDR detects the Excel file and the malware binary as malicious based on their behavior.](https://www.fortinet.com/products/endpoint-security/fortiedr.html?utm_source=blog&utm_campaign=fortiedr)\n\nFortinet customers are protected from this malicious Excel file and malware binary by FortiGuard AntiVirus, which is included\nin [FortiMail. It detects all malicious macro file types, including Excel 4.0 Macro samples.](https://www.fortinet.com/products/email-security/fortimail.html?utm_source=blog&utm_campaign=fortimail-main-page)\n\nAll relevant URLs have been rated as \"Malicious Websites\" by the FortiGuard Web Filtering service.\n\n**IOCs**\n\n\n-----\n\nFiles\n\n**Indicator** **SHA256**\n\nConfirmation Receive Document.xls 82A0F2B93C5BCCF3EF920BAE425DD768371248CDA9948D5A8E70F3C34E9F7CCA\n\nMicrosoft.Exchange.WebServices.dll 7EBBEB2A25DA1B09A98E1A373C78486ED2C5A7F2A16EEC63E576C99EFE0C7A49\n\nupdate.exe.config C744DA99FE19917E09CD1ECC48B563F9525DAD3916E1902F61B79BDA35298D87\n\nupdate.exe E0872958B8D3824089E5E1CFAB03D9D98D22B9BCB294463818D721380075A52D\n\nOther\n\n**Indicator** **Value**\n\nMutex 726a06ad-475b-4bc6-8466-f08960595f1e\n\nC2 domain joexpediagroup[.]com\n\nC2 domain asiaworldremit[.]com\n\nC2 domain uber-asia[.]com\n\nMitre TTPs\n\n**Initial Access**\n\nT1566.001 Spearphishing\n\nExecution\n\nT1059.001 PowerShell\n\nT1059.003 Windows Command Shell\n\nT1053.005 Scheduled Task\n\nT1204.002 Malicious File\n\nT1047 Windows Management Instrumentation\n\n**Persistence**\n\nT1053.005 Scheduled Task\n\n**Defense Evasion**\n\n\n-----\n\nT1480 Execution Guardrails\n\n**Discovery**\n\nT1087.001 Local Account\n\nT1083 File and Directory Discovery\n\nT1049 System Network Connections Discovery\n\n**Command and Control**\n\nT1071.004 DNS\n\nT1132.002 Non-Standard Encoding\n\nT1568.002 Domain Generation Algorithms\n\n**Exfiltration**\n\nT1041 Exfiltration Over C2 Channel\n\n_Learn more about Fortinet’s_ _[FortiGuard Labs threat research and intelligence organization and the FortiGuard Security](https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguard-labs)_\n_[Subscriptions and Services portfolio.](https://www.fortinet.com/fortiguard/labs?tab=security-bundles&utm_source=blog&utm_campaign=security-bundles)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-11 - Please Confirm You Received Our APT.pdf"
    ],
    "report_names": [
        "2022-05-11 - Please Confirm You Received Our APT.pdf"
    ],
    "threat_actors": [
        {
            "id": "ce10c1bd-4467-45f9-af83-28fc88e35ca4",
            "created_at": "2022-10-25T15:50:23.458833Z",
            "updated_at": "2025-03-27T02:00:55.475188Z",
            "deleted_at": null,
            "main_name": "APT34",
            "aliases": null,
            "source_name": "MITRE:APT34",
            "tools": [
                "netstat",
                "Systeminfo",
                "PsExec",
                "SEASHARPEE",
                "Tasklist",
                "Mimikatz",
                "POWRUNER",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3eebdb3f-f4e3-42e5-bb4d-f02a13328316",
            "created_at": "2024-05-01T02:03:08.014303Z",
            "updated_at": "2025-03-27T02:05:17.306592Z",
            "deleted_at": null,
            "main_name": "COBALT EDGEWATER",
            "aliases": [
                "Cold River ",
                "DNSpionage ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT EDGEWATER",
            "tools": [
                " DNSpionage",
                " Karkoff",
                " MailDropper",
                " SideTwist",
                " TWOTONE",
                "AgentDrable"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536205,
    "ts_updated_at": 1743041847,
    "ts_creation_date": 1653704215,
    "ts_modification_date": 1653704215,
    "files": {
        "pdf": "https://archive.orkl.eu/79b797c7dee1ec0109603419c369524009253a31.pdf",
        "text": "https://archive.orkl.eu/79b797c7dee1ec0109603419c369524009253a31.txt",
        "img": "https://archive.orkl.eu/79b797c7dee1ec0109603419c369524009253a31.jpg"
    }
}