{
    "id": "32fe2bbb-d697-41f6-87e7-9f950ed6aa4d",
    "created_at": "2023-01-12T14:58:50.793636Z",
    "updated_at": "2025-03-27T02:13:08.207776Z",
    "deleted_at": null,
    "sha1_hash": "adbbf8328289ca1402ea640389c5bee5e41bc212",
    "title": "2021-05-10 - Overview of Campo, a new attack campaign targeting Japan",
    "authors": "",
    "file_creation_date": "2022-05-28T15:28:04Z",
    "file_modification_date": "2022-05-28T15:28:04Z",
    "file_size": 2483795,
    "plain_text": "# 日本を狙う新たな攻撃キャンペーン Campo の全体像\n\n**[mal-eats.net/2021/05/10/campo_new_attack_campaign_targeting_japan/](https://mal-eats.net/2021/05/10/campo_new_attack_campaign_targeting_japan/)**\n\n@mal_eats 2021年5月10日\n\n最終更新日:2021年5月11日\n2021年3月頃より、campo/Openfieldと呼ばれるインフラを利用した日本への攻撃が複数回\n確認されています。この攻撃キャンペーンは、感染組織によっては後続のマルウェアが配信\nされる可能性があり、その中には最終的にランサムウェアが使用されるケースが海外で観測\nされています。\n\n我々は、現在この攻撃キャンペーンを継続調査しており、認識している限り、少なくとも\n2020年10月頃には観測され始めています。今後も攻撃者による継続的な活動は予測され、\n最悪の場合、ランサムウェアによる暗号化をはじめとした様々な被害に発展してしまう可能\n性があることを危惧しています。そこで、このような脅威に備えて、現時点で判明している\n日本向けキャンペーンの特徴とマルウェアの実行痕跡の確認方法等について本稿で共有しま\nす。\n\n## 更新履歴\n\n本稿の更新による変更点は次の通りです。\n\n日付 内容\n\n2021年5月10日 本稿を公開しました。\n\n2021年5月11日 一部誤字を修正しました。\n\n## 日本向けのキャンペーンの報告状況\n\n\n-----\n\n日本におけるメールの報告は、SNS上で行われています。以下に報告を時系列順に示しま\nす。\n2020年10月14日\n[https://twitter.com/bomccss/status/1316163808319041536](https://twitter.com/bomccss/status/1316163808319041536)\n2021年3月10日\n[https://twitter.com/bomccss/status/1369612781209591813](https://twitter.com/bomccss/status/1369612781209591813)\n2021年3月24日\n[https://twitter.com/bomccss/status/1374526482890944515](https://twitter.com/bomccss/status/1374526482890944515)\n2021年3月31日\n[https://twitter.com/bomccss/status/1377280535710494729](https://twitter.com/bomccss/status/1377280535710494729)\n2021年4月6日\n[https://twitter.com/bomccss/status/1379240664362143744](https://twitter.com/bomccss/status/1379240664362143744)\n2021年4月7日\n[https://twitter.com/bomccss/status/1379602541495738371](https://twitter.com/bomccss/status/1379602541495738371)\n2021年4月8日\n[https://twitter.com/bomccss/status/1379970130642235392](https://twitter.com/bomccss/status/1379970130642235392)\n2021年4月9日\n[https://twitter.com/bomccss/status/1380327966765314050](https://twitter.com/bomccss/status/1380327966765314050)\n\n## 攻撃の全体像\n\n攻撃の全体像は、図1の通りです。攻撃は日本語メールの接到から始まります。メール本文\nにはURLリンクとパスワードが記載されており、ユーザがURLリンクにアクセスするとパス\nワード付きZIPファイルをダウンロードすることができます。このZIPファイルを展開し、文\n書ファイルを開いてコンテンツを有効にすると、Campo Loaderと呼ばれるダウンローダが\nドロップ・実行され、通信が発生します。そして、別のダウンローダであるDFDownloader\nに感染し、サーバと通信することで追加のペイロードをダウンロード・実行できる状態とな\nります。\n\n図\n\n1 攻撃の全体像\n\n\n-----\n\nなお、URLリンクの通信先とCampo Loaderの通信先は「BlackTDS」と呼ばれるアンチボッ\nトサービスを利用している可能性が高く、通信時にリサーチャの調査活動が妨害され正規サ\nイトへリダイレクトされることがあります。このサービスの動作の詳細は後述します。\n\n今回の日本向け攻撃キャンペーンで使用されているDFDownloaderは、追加のマルウェアを\nダウンロードして実行する機能があるものの、現時点で我々は後続のペイロードの観測に至\nっていません。DFDownloaderに関しては、海外の文献においても報告されていない状況で\nす。このため、DFDownloaderを経由して最終的に感染するマルウェアは不明です。\n\nその一方で、海外ではCampo Loaderから下記のマルウェアに感染する類似事例が報告され\nています。\n\nTrickbot\nUrsnif\nBazarLoader→CobaltStrike, AnchorDNS\nPhobos Ransomware\n\nまた、同攻撃者グループによると思われる日本での過去事例では、Zloaderに感染させよう\nとする事例も確認されています。\nこれらの内容に関しては、我々の考察を含め、本稿の最後に記載しています。\n\n## メールの特徴\n\nメールの例を下図に示します。日本向けの攻撃キャンペーンでは、図2の通りメール本文に\n日本語が使用されており、実在する企業の担当者を騙り、請求書の形式でリンク先のパスワ\nード付きZIPファイルのダウンロードに誘導します。\n\n送信元は多数の企業を騙っており、正規の企業メールアドレスとは異なります。メール本文\nに記載されているリンク先ファイルのパスワードは、現在観測している限り、すべて同一で\nあることを確認しています。さらに、メールヘッダの情報から攻撃者はオープンソースの\nWebメールである「Roundcube Webmail」を使用して配信していると推定しています。\n\n\n-----\n\n図\n\n2 日本向け攻撃メールの例\n\n## リンク先のサーバの特徴\n\nリンク先サーバへのアクセスは、HTTPSで行われることが確認されています。また、接続\n先ドメイン名に紐づいているIPアドレスが共通であることが多いという特徴があります。\n\n調査の結果、このサーバは「BlackTDS」と呼ばれるアンチボットサービスを利用している\n可能性があることがわかりました。このサービスは、公式サイトによると”トラフィックの\nクリーニングとボットの保護に最適なソリューション”（図3）とされていますが、実際は\nDrive-by as a serviceとして攻撃者が悪用しているとProofpoint社によって報告されています\n\n[1]。\n\n\n-----\n\n図\n\n3 BlackTDS\n\n[1]「Drive-by as a service: BlackTDS」, Proofpoint, 2018/3/13\n[https://www.proofpoint.com/us/threat-insight/post/drive-service-blacktds](https://www.proofpoint.com/us/threat-insight/post/drive-service-blacktds)\n\n今回の日本向けキャンペーンでは、このサービスが提供すると言われている以下のフィルタ\nリングが利用されている可能性があります。\n\nIPv6に完全対応したIPアドレスによるフィルタリング\nISPによるフィルタリング\nリファラーによるフィルタリング\nハードウェアIDによるフィルタリング、\n44万以上のIPアンチウイルス、モデレーター、検索エンジン、チェッカーボットが登\n録されているアンチボットデータベースによるフィルタリング\n\nそのため、BlackTDSによりセキュリティリサーチャやサンドボックスによるファイルの取\n得が難しく調査の難易度が高くなってしまいます。\n\n## 文書ファイルの特徴\n\n主に日本向けのキャンペーンでは、メールのリンク先からダウンロードされたパスワード付\nきZIPファイルを展開し文書ファイルを開くと、図4のように日本語が使用された画像が表示\nされます。\n\n\n-----\n\n図\n\n4 日本向けの攻撃で確認された文書ファイルの例\n表示される画像は、他の攻撃においても共通のものが使用されることもあるため、見た目だ\nけで本攻撃に関連するものであるかを判断することは困難な場合があります。また、画像が\n変更される場合もあるため、図4のデザインに限らない点にご注意ください。\n\n以降では、動作の概要と、執筆時点（2021年4月）における最新の文書ファイルの動作につ\nいて解説します。\n\n### 動作の概要\n\nOffice製品がデフォルト設定の場合、ユーザが文書ファイルを開いて「コンテンツの有効\n化」をクリックすると、Excel 4.0 マクロ（以降、マクロと記載）が実行され、文書ファイ\nルに埋め込まれている文字列がファイルとしてドロップされます。\n\n一連の攻撃で確認している文書ファイルでは、マクロが設定されているシートが非表示状態\nとなっており、シート内にはマクロを実行するために必要な文字列が細分化されて記述され\nています。\n\nまた、文書ファイルのブックに「Auto_Open」が設定されていることで、文書ファイルを開\nくと悪意あるマクロが自動的に実行されます。自動的に実行されるマクロの一部を図5、6に\n示します。\n\n\n-----\n\n5 2021年4月9日に観測した文書ファイルから実行される一部のマクロ関数\n\n\n図\n\n図\n\n\n6 2021年4月9日に観測した文書ファイルから実行される一部のマクロ関数\nSAVE.AS関数で保存された文字列はcertutil.exeを用いてデコードされ、別のファイル名で保\n存されます。その後、CALL関数などでrundll32.exeを用いて、デコードされたCampo\nLoaderが実行されます（図7）。\n\n図\n\n7 2021年4月9日に観測した文書ファイルから実行されるマクロ関数\nこれら一連の挙動は、マクロに加えWindowsに標準で搭載されているモジュール群（DLL）\nの関数を直接呼び出すことで実装されています。\n\n### 4月9日の攻撃で使用された文書ファイル\n\n以下に4月9日の攻撃で確認された文書ファイルからCampo Loaderが実行されるまでのフロ\nーを示します（図8、9）。\n\n\n-----\n\n8 文書ファイルを開いた際のフロー\n\n9 文書ファイルを開いた際のプロセスツリー\n動作の流れは以下の通りです。\n\n\n図\n\n図\n\n\n1. 文書ファイルを開きコンテンツが有効化されると、悪意あるマクロが動作します。\n2. 文書ファイルのシート内に埋め込まれている文字列がC:\\Users\\Public\\14118.doyとし\n\nて保存されます（※1）。\n3. 文書ファイルのシート内に埋め込まれている文字列がC:\\Users\\Public\\14118.xlsbとし\n\nて保存されます（※2）。\n4. cmd.exe経由でcertutil.exeが呼び出され、%PUBLIC%\\14118.doyの中身がBASE64デコ\n\nードされて、結果が%PUBLIC%\\14118.biyとして保存されます。\n5. ここで偽の入力フォームが表示されます（図10）。\n6. rundll32.exeでCampo Loader（%PUBLIC%\\14118.biy）が実行されます。このとき、\n\n引数としてDF1が指定されておりDF1関数が呼び出されます。\n\n※1 ファイル名（例えば、14118.doy）に含まれている数値は、疑似乱数を生成する関数で\n9999 ~ 19999まで値が生成されますが、実際には攻撃者が保存した際の数値がそのまま保存\nされており、固定値になっています。\n※2 当該ファイルは作成されるだけで、実際には攻撃を成立させるためには不要なファイル\nであると考えられます。\n\n\n-----\n\n図\n\n10 偽の入力フォーム\n\n## Campo Loader マルウェアの特徴\n\nCampo Loader（別名：NLoader）は、文書ファイルからドロップされた後に実行されるマ\nルウェアです。このマルウェアの役割はダウンローダであり、HTTP通信を行って追加のペ\nイロードを取得・実行する機能を有しています。通信時に「/campo/」を含むパスにアクセ\nスすることから、Orange Cyberdefense社が「Campo Loader」という名称を使用し[2]、\nSNS上で定着しました。\n\nCampo Loaderは、3月上旬に変更が加えられ、HTTP通信の特徴が変化しました。本稿では\n執筆時点（2021年4月）で最新のものを解説します。\n\n[2] 「In the eye of our CyberSOC: Campo Loader, analysis and detection\nperspectives」, Orange Cyberdefense, 2021/03/23\n\nhttps://orangecyberdefense.com/global/blog/cybersoc/in-the-eye-of-our-cybersoccampo-loader-analysis-and-detection-perspectives/\n\nCampo Loaderが実行されると、まずはディレクトリを作成します。下図に示す通り、作成\nするディレクトリ名はハードコーディングされています。\n\n\n-----\n\n図\n\n11 ディレクトリの作成\n続いて、POSTメソッドで文字列”ping”をサーバへ送信します（図12）。このときに通信す\nるサーバを以降では「Openfieldサーバ」と呼びます。\n\n図\n\n12 Campo Loaderが発生させるリクエストの例\nこの段階の通信では、OpenfieldサーバはレスポンスとしてURLを返します（詳細は後\n述）。このため、Campo Loaderはレスポンスが「h」で始まるかをチェックし、「h」で始\nまらない場合はプロセスを終了します（図13）。\n\n図\n\n13 ‘h’のチェック\n「h」である場合は、そのURLに対して、POSTメソッドで2回目の”ping”メッセージを送信\nします。これにより、追加のペイロードがダウンロードされ、ファイルとして保存されま\nす。保存されるファイルの名前に関してもハードコーディングされています（図14）。\n\n\n-----\n\n図14\n\nハードコーディングされている保存ファイル名の例\nその後、rundll32.exeを使用して、ダウンロードしたDLLファイルの関数を呼び出します。\n呼び出す関数名は通常「DF」関数です（※）。この呼び出し引数もハードコーディングさ\nれています。\n\nなお、Campo Loaderにはexeファイルをダウンロードして実行するタイプも存在します。\n日本における過去の事例では、Campo LoaderがUrsnifやZloaderなどのマルウェアを直接実\n行したことがあります。ただし、最近の日本向けのキャンペーンではDLL版が多く、後述の\nDFDownloaderへのダウンロード・実行に移行している傾向にあります。\n\n※ Campo Loaderはエクスポート関数として「DF」や「DF1」などの関数名が使用されてい\nますが、後述のマルウェアであるDFDownloaderも同名の「DF」が関数名として使用されて\nいるため、この部分でCampo LoaderとDFDownloaderを混同しないようご注意ください。\n\n## Openfieldの特徴\n\nOpenfieldサーバは、Campo Loaderが取得するペイロードがホストされたサーバです。ペイ\nロード取得時の通信先URLとして「/campo/」を含む特徴があります。ここでは、レスポン\nスの内容とサーバの調査結果について解説します。\n\n### サーバのレスポンス\n\nPOSTメソッドを用いてHTTPボディに “ping “を指定し「/campo/」配下に接続すると、URL\nが返却されます（下図）。過去事例として、リダイレクトを示すレスポンスが行われるケー\nスも確認していますが、最近のものはレスポンスにURLが含む形式が一般的です。\n\n図\n\n15 レスポンスの例1\n\n\n-----\n\n図\n\n16 レスポンスの例2\nなお、Openfieldサーバに関しても「5 リンク先のサーバの特徴」と同様にBlackTDSを用い\nたアンチボットが設定されている可能性があります。このため、BlackTDSサービスによっ\nてリサーチャの調査活動が妨害され、YahooやGNU等の正規のサイトへリダイレクトが行わ\nれる可能性があります。\n\nレスポンスとしてCampo Loaderに通知するURLは、以下の2種類のケースがあります。\n\n同サーバの別ディレクトリ（/uploads/files/配下など）を示すURL\n他のOpenfieldサーバのURL\n\nなお、過去の日本向けのキャンペーンや海外向けのキャンペーンでは、侵害済みの正規サー\nバにマルウェアを配置したと考えられる事例も確認しています。\n\n### IPアドレスとドメイン名の特徴\n\n通信先のURLには、IPアドレスとドメイン名が使用されたことがありますが、最近はドメイ\nン名を使用する傾向があります。ドメイン名は、Namecheap社のサービスで登録されてお\nり、「単語＋数字＋xyzドメイン」という規則性があります。また、ドメイン名に紐づくIP\nアドレスのレンジは、176.111.174.0/24であることも調査より判明しています（表1）。\n\n表1 Openfieldに使用されたドメイン名とIPアドレスの例\n\n対象 ドメイン名 **IPアドレス**\n\n海外 bfdnews[.]xyz 176.111.174[.]72\n\n海外 groupeu[.]xyz 176.111.174[.]72\n\n海外 allcafe[.]xyz 176.111.174[.]72\n\n海外 gainme[.]xyz 176.111.174[.]53\n\n\n-----\n\n日本 ship4[.]xyz 176.111.174[.]53\n\n日本 gopigs[.]xyz 176.111.174[.]53\n\n海外 beauty1[.]xyz 176.111.174[.]53\n\n海外 about2[.]xyz 176.111.174[.]57\n\n日本 board3[.]xyz 176.111.174[.]57\n\n日本 cake3[.]xyz 176.111.174[.]58\n\n日本 dance4[.]xyz 176.111.174[.]61\n\n海外 hall4[.]xyz 176.111.174[.]62\n\n海外 keep2[.]xyz 176.111.174[.]62\n\n海外 lie3[.]xyz 176.111.174[.]59\n\n海外 out2[.]xyz 176.111.174[.]60\n\n海外 noise1[.]xyz 176.111.174[.]60\n\n### Openfieldサーバの由来と機能\n\n「Openfield」は、このサーバを識別するために、海外のセキュリティリサーチャチーム\nCryptolaemus Team（@Cryptolaemus1）が名付けた名称です。\n\n[#Trickbot gtag mon88](https://twitter.com/hashtag/Trickbot?src=hash&ref_src=twsrc%5Etfw) [https://t.co/D3U5S10zJQ](https://t.co/D3U5S10zJQ)\n\nThis /campo/x/x actor is some sort of distro as a service group that loves to do these 1\nor 2 letter subdirectories like that. We have started to call them [#openfield or](https://twitter.com/hashtag/openfield?src=hash&ref_src=twsrc%5Etfw)\n[#campoloader because they always have the same structure.](https://twitter.com/hashtag/campoloader?src=hash&ref_src=twsrc%5Etfw)\n\n[— Cryptolaemus (@Cryptolaemus1) 2021年2月27日](https://twitter.com/Cryptolaemus1/status/1365494339883958272?ref_src=twsrc%5Etfw)\n\nWebサーバのディレクトリリスティング機能が有効になっており、コンテンツの一覧を見る\nことができる状態（一般的に”open directory”と呼ばれる）であったことが由来と考えられま\nす。我々の調査でも、Openfieldサーバのコンテンツの一覧を見られる状態であったことを\n確認しています。ただし、この設定は現在は修正されています。\n\n\n-----\n\n図\n\n17 Openfieldサーバ（当時）のディレクトリリスト\nまた、Openfieldサーバには、ログインパネルも存在しています。図17（左）に示す通り、\nディレクトリに「smtp」「mails」といった名称が使用されていることから、Openfieldサー\nバはメールの送信に関連した機能を持つ可能性があります。\n\n図\n\n18 Openfieldサーバのログインパネル\n\n## DFDownloader マルウェアの特徴\n\nDFDownloaderは、Campo Loaderによってダウンロード・実行される、2段階目のマルウェ\nアです。このマルウェアはダウンローダであり、次の段階のマルウェアをダウンロードして\n実行する役割を担っています。ダウンロード・実行のほかにも永続化や自身を更新する機能\nなどを備えており、Campo Loaderよりも機能が豊富です。また、DFDownloaderには、バ\n\n\n-----\n\nージョン情報が埋め込まれており、頻繁にバージョンアップが行われていることから、今後\nも継続して使用されるものと予想されます。以降では、DFDownloaderの動作について解説\nします。\n\n後述しますが、海外の事例ではDFDownloaderを使用しないケースも確認されています。\n\n### アンチサンドボックス機能\n\nDFDownloaderには、アンチサンドボックス機能があります。DFDownloaderは最初にシス\nテムのメモリ総量をチェックし、4GiBに満たない場合はプロセスを終了します。また、\nsleep関数が複数存在しており、これら妨害機能によって、サンドボックス環境での実行で\n正確な結果を得られない可能性があります。\n\n図\n\n19 メモリチェック\n\n### 文字列の暗号化\n\n下図の通り、DFDownloaderは使用する文字列をXORで暗号化した状態で保持しています。\nこの文字列には、通信先情報や使用する関数の情報などが含まれています。また、これらの\n文字列を復号するXORのルーチンは、サーバからのレスポンスを復号する際にも使用されま\nす。\n\n\n-----\n\n図\n\n20 XOR文字列の例\n\n### 通信の流れ\n\nDFDownloaderによる通信の流れは下図の通りです。通信先として、通常は4種類のドメイ\nン名を保持しています。DFDownloaderがサーバと通信する際に使用するデータフォーマッ\nトは4種類存在します。\n\n\n-----\n\n図\n\n21 DFDownloaderの通信の流れ\n\n①SYS識別子の通信\n\nDFDownloaderは最初に感染したホストで収集した情報をPOSTメソッドで送信します（下\n図）。このとき送信される情報はBase64でエンコードされており、識別子などを含んでい\nることがわかります。\n\n図\n\n22 最初の通信例（SYS識別子）\nサーバへ送信される情報の詳細は下表の通りです。これらのリクエストに対し、サーバは通\n常、HTTPステータスコード「200 OK」のレスポンスを返します。\n\n表2 送信データの詳細\n\n値の例 意味\n\nSYS 識別子\n\n10 OSのメジャーバージョン番号\n\n17763 OSのビルド番号\n\n\nDESKTOPAABSVH71760622929\n\n\nコンピュータ名とボリュームシリアル番号から生成し\nた値\n\n\n-----\n\ntest ユーザ名\n\n64 OSのビット数\n\n1.28r DFDownloaderのバージョン\n\n0 0 または 1\n\n7545391 不明\n\n②BIN識別子の通信\n\n2番目にBIN識別子を使用した通信が発生します（下図）。\n\n図\n\n23 2番目の通信例（BIN識別子）\nここで、サーバからレスポンスがあった場合、DFDownloaderはレスポンスをXORで復号\nし、先頭バイトが「MZ」（PEファイルのマジックナンバー）で始まるかチェックします。\nPEファイルである場合、受信したデータをファイルとして保存します。\n\nその後、作成したファイルのパスを使用して、レジストリに値を登録します（下図）。この\nレジストリへの登録によって、ユーザが端末にログオンした際にDFDownloaderが実行され\nるようになります（感染の永続化）。\n\n\n-----\n\n図\n\n24 レジストリに登録される値の例\nなお、我々は当該通信によってDFDownloaderの更新が行われる動作を確認しました。更新\nが行われる際は、新しくファイルを保存し、レジストリの値を書き換え、古いファイルとデ\nィレクトリを削除します。\n\n③PNG識別子の通信\n\n3番目にPNG識別子を使用した通信が発生します。\n\n図\n\n25 3番目の通信例（PNG識別子）\nこの通信でサーバから受け取った値に応じて、以降の処理が下表の通り分岐します。分岐処\n理には実装途中と考えられる部分があり、今後のバージョンアップによって機能が追加され\nると予想されます。\n\n表3 コマンド\n\n値 説明\n\n0x31 後続の通信で取得するファイル（DLLまたはEXE）を保存して実行する。DLLの場\n合は関数名を指定することができる。\n\n0x32 後続の通信で取得するファイル（DLL）を保存して実行する。この場合、実行後に\nDFDownloaderのプロセスは終了する。\n\n\n-----\n\n0x33 未実装。\n\n0x34 未実装。\n\n④BN識別子の通信\n\n最後にBN識別子を使用した通信が発生します（下図）。この通信では、③PNG識別子を使\n用した通信でサーバから返ってきた値に合わせて、それぞれの分岐で実行するペイロードを\nサーバから取得します。前述の通り、取得するペイロードはDLLファイルまたはEXEファイ\nルです。\n\n図\n\n26 4番目の通信例（BN識別子）\nそして、CreateProcessA関数を使用して新しいプロセスを生成します。EXEファイルの場\n合はそのまま実行し、DLLファイルの場合はrundll32.exeを使用します。\n\nなお、ループ処理があるため、サーバから期待されるレスポンスがない場合でも、③と④の\n通信が何度も発生します。ただし、通信の間隔は一定ではありません。\n\n## その後のペイロードの考察\n\n執筆時点（2021年4月）では、後続のペイロードを確認できていません。しかし、海外では\n類似事例が報告されており、日本においても今後これらの事例のように感染が進行する可能\n性があると考えます。また、以前から同攻撃者グループによると考えられる攻撃キャンペー\nンも確認されており、その内容からも狙いの傾向を推測することが可能です。そこで、ここ\nでは海外事例と過去事例をもとに、最終的に感染すると考えられるマルウェアを考察しま\nす。\n\nこれまでの類似事例から、その後感染する可能性のあるマルウェアは次の図の通りです。\nCampo Loaderから、下図の青枠に示すマルウェアに感染する事例があり、DFDownloader\nからも同様に感染が進行する可能性があります。\n\n\n-----\n\n図\n\n27 感染フローの考察\nこのように情報窃取やリモートアクセス、ランサムウェアなど様々な被害が想定されます。\nあくまで推測であり、上記以外のマルウェアに感染することもあり得る点にご注意くださ\nい。\n\n### 日本における類似事例\n\n日本においては、以前にOpenfieldサーバやCampo Loaderを利用してUrsnifやZloaderへの感\n染を狙う事例[3]が確認されています。この事例では、メールに添付された悪性の文書ファイ\nルからドロップされたCampo Loaderが、UrsnifやZloaderをダウンロードして実行するとい\nう流れでした。そのため、DFDownloaderからUrsnifやZloaderに感染する可能性も考えられ\nます。\n\n[3] 「2020/10/14(火) 添付ファイル付不審メール「【お振込口座変更のご連絡】」\n（ZLoader）の調査」, bomb_blog, 2020/10/28\n\n[https://bomccss.hatenablog.jp/entry/2020/10/28/125630](https://bomccss.hatenablog.jp/entry/2020/10/28/125630)\n\n### 海外における類似事例\n\n海外においても、OpenfieldサーバとCampo Loaderを使用する事例が複数報告されていま\nす。これらの事例も、Campo Loaderが他のマルウェアをダウンロードして実行するケース\nです。\n\n海外の活発なキャンペーンのひとつに「BazarCall」と呼ばれる攻撃キャンペーンがありま\nす。このキャンペーンでは、ユーザがメールに記載の連絡先に電話することで文書ファイル\nのリンク先に誘導され、実行することで感染に至ります[4]。\n\nこのキャンペーンでもCampo Loaderが使用されており、本攻撃キャンペーンと同様に文書\nファイルからドロップされたCampo Loaderが実行されOpenfieldサーバへアクセスし、\nBazarLoaderをダウンロードして実行します（図28）。\n\n\n-----\n\n図\n\n28 BazarCall キャンペーンにおけるのBazarLoaderを取得する通信の例\n（出典：https://www.malware-traffic-analysis.net/2021/04/16/index2.html）\n\n[4] 「BazarCall malware uses malicious call centers to infect victims」, Bleeping\nComputer, 2021/3/31\nhttps://www.bleepingcomputer.com/news/security/bazarcall-malware-uses-maliciouscall-centers-to-infect-victims/\n\nまた、他の事例として、古いタイプのCampo LoaderからTrickbotやPhobos Ransomwareに\n感染した事例の報告があります。2020年9月～10月頃の事例ですが、現在も活動を続けるマ\nルウェアですので注意が必要です。\n\n[5]「Deep Analysis – The EKING Variant of Phobos Ransomware」, Fortinet,\n2020/10/13\nhttps://www.fortinet.com/blog/threat-research/deep-analysis-the-eking-variant-ofphobos-ransomware\n\n[6] 「TRICKBOT AND EMOTET DELIVERY THROUGH WORD MACRO」,\nMorphisec, 2020/9/16\n[https://blog.morphisec.com/trickbot-emotet-delivery-through-word-macro](https://blog.morphisec.com/trickbot-emotet-delivery-through-word-macro)\n\n## 他のキャンペーンとの関連性\n\n調査の過程で判明した他のキャンペーンとの関連性について解説します。\n\n### BazarCallとの関連性\n\n4月9日の日本向けの攻撃に使用された文書ファイルを開いた際に表示される偽の入力フォー\nムが、4月15日にSophos社が公開したレポート[7]にて言及されている偽の入力フォームと\nほぼ一致しています（図29、図30）。\n\n[7]「BazarLoader deploys a pair of novel spam vectors」, Sophos, 2021/04/15\n\n[https://news.sophos.com/en-us/2021/04/15/bazarloader/](https://news.sophos.com/en-us/2021/04/15/bazarloader/)\n\n\n-----\n\n図\n\n\n29 4月9日の日本向け攻撃キャンペーンで表示される偽の入力フォーム\n\n\n-----\n\n図\n\n30 Sophos社のレポートで言及されている偽の入力フォーム\n（出典 : https://news.sophos.com/en-us/2021/04/15/bazarloader/）\nまた、同様に日本向けの一連の攻撃で使用された文書ファイルの挙動についてもほぼ一致し\nています（図31、図32）。\n\n図\n\n31 4月9日の日本向け攻撃キャンペーンで使用された文書ファイルのプロセスツリー\n\n\n-----\n\n図\n\n32 Sophos社のレポートで言及されているプロセスツリー\n（出典 : https://news.sophos.com/en-us/2021/04/15/bazarloader/）\n\n### パッカーの類似性\n\nCampo LoaderとDFDownloaderに使用されているパッカーには複数のバリエーションがあ\nりますが、一部のパッカーがTrickbotやBazarLoaderで使用されていたものと類似していま\nす。\n\n下図は、Campo LoaderとDFDownloader（1.28r）で使用されているパッカーのコードの一\n部です。このパッカーは、CryptoAPIを使用してマルウェア本体を暗号化しており、\nCryptImportKey関数によるRSA2キーのインポートと、CryptEncryptを使用してRC4暗号で\nデータを処理する動きが特徴的です。\n\n図\n\n33 Campo Loaderのパッカーの例\n\n\n-----\n\n図\n\n34 DFDownloaderのパッカーの例\nこれらのコードは、Cybereason社のブログ[8]で紹介されているBazarLoaderのパッカーや\nVIPRE Labsのブログ[9]で紹介されているTrickbotが使用しているパッカーにも同様の特徴が\n見られます。このような類似点からも、TrickbotとBazarLoaderが本攻撃キャンペーンに関\n連する可能性があることがわかります。\n\n[8] 「A Bazar of Tricks: Following Team9’s Development Cycles」, Cybereason,\n2020/7/16\nhttps://www.cybereason.com/blog/a-bazar-of-tricks-following-team9s-developmentcycles\n\n[9] 「Trickbot’s Tricks」, VIPRE Labs, 2018/12/5\n[https://labs.vipre.com/trickbots-tricks/](https://labs.vipre.com/trickbots-tricks/)\n\n## 実行痕跡の確認方法\n\n実行痕跡の確認方法を以下に示します。\n\n### 端末の自動起動設定の確認\n\nレジストリ\n\nDFDownloaderは、永続化のためにレジストリにDLLファイルを登録します。\nユーザが端末にログオンした際にDFDownloaderが実行されるようになります。\n\n\n-----\n\n表4 レジストリに登録される値の例\n\n項目 値\n\nレジストリキー HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\n\n値 Shell\n\nデータ型 REG_SZ\n\nデータ （例）explorer.exe, regsvr32.exe C:\\ProgramData\\nmvhg\\nmvhg.dll\n\n35 レジストリに登録される値の例\n\n### ネットワークトラフィックやプロキシログの確認\n\n\n図\n\n\n感染時のネットワークトラフィックやプロキシログが残っている場合は、次に示す通信が記\n録されていないかをご確認ください。\n\n**Campo Loaderの通信**\n\nPOSTメソッドを使用します。このときHTTPヘッダにはUser-Agentがありません。\n通信先のドメイン名は、xyzドメインを使用する傾向があります。\nURLは正規表現で「\\/campo\\/([a-z0-9]{1,2})\\/([a-z0-9]{1,3})」と表現できます。\n\n\n-----\n\n図\n\n36 Campo Loaderの通信例\n\n**DFDownloaderの通信**\n\nPOSTメソッドを使用します。このときHTTPヘッダにはUser-Agentがありません。\n通信先のドメイン名は、xyzドメインを使用する傾向があります。\nリクエストのContent-Lengthは、40～100バイト程度です。\nサーバレスポンスは、XORで暗号化されています。XORキーは感染した端末ごとに異\nなる値です。\n\n例：「DESKTOP-AABSVH71760622929」\n\n図\n\n37 DFDownloaderの通信例1\n\n図\n\n38 DFDownloaderの通信例2\n\n### 生成ファイルの確認\n\n以下に示すようなファイルが生成されていないかをご確認ください。\n\nファイルの名前や保存先などは攻撃者が容易に変更できる部分であるため、未掲載のものが\n存在する可能性がある点にご注意ください。\n\n文書ファイル\n\n保存先のフォルダパスは一貫して「C:\\Users\\Public\\」が使用されており、攻撃キャン\nペーンによってファイル名が変化します。\n文書ファイルの生成ファイルの例は下表の通りです。\n\n\n-----\n\n表5 文書ファイルによる生成ファイル例\n\nファイル 説明\n\nC:\\Users\\Public\\14118.doy 文書ファイルがドロップしたファイル。\n2021年4月9日の日本向けキャンペーンで使用。\n\nC:\\Users\\Public\\14118.xlsb 文書ファイルがドロップしたファイル。\n2021年4月9日の日本向けキャンペーンで使用。\n\nC:\\Users\\Public\\14118.biy 「C:\\Users\\Public\\14118.doy」の中身をBase64デコードして\n生成されたファイル（Campo Loader）。\n2021年4月9日の日本向けキャンペーンで使用。\n\n**Campo Loader**\n\n保存先のパス、ファイル名は、文書ファイルからドロップされるCampo Loaderにハー\nドコーディングされています。\n「C:\\ProgramData\\」配下を使用する傾向にあります。\nCampo Loaderの生成ファイルは下表の通りです。\n\n表6 Campo Loaderによる生成ファイル例\n\nファイル 説明\n\nC:\\ProgramData\\jyqwkf\\jyqwkf.dll Campo LoaderがダウンロードしたDLLファイル。\n2021年4月9日の日本向けキャンペーンで使用。\n\nC:\\ProgramData\\yosgu\\yosgu.dll Campo LoaderがダウンロードしたDLLファイル。\n2021年4月8日、2日の日本向けキャンペーンで使用。\n\n**DFDownloader**\n\nDFDownloaderの保存先のパス、ファイル名は、ランダムに生成されます。\n「C:\\ProgramData\\」配下を使用する傾向にあります。\n通信の状況によっては、フォルダとファイルを削除することもあります。\nDFDownloaderの生成ファイルは下表の通りです。\n\n表7 DFDownloaderによる生成ファイル例\n\nファイル 説明\n\n\n-----\n\nC:\\ProgramData\\＜ランダム＞\\＜ランダム\n＞.dll\n例：「C:\\ProgramData\\nmvhg\\nmvhg.dll」\n\nC:\\ProgramData\\＜ランダム＞\\＜ランダム\n＞.exe\n例：\n「C:\\ProgramData\\nmvhg\\nmvhg.exe」\n\n\nDFDownloaderがダウンロードしたDLLファ\nイル。\n\nDFDownloaderがダウンロードしたEXEファ\nイル。\n\n\n## 感染の判断が難しい場合・専門企業による調査が必要な場合\n\n下記リンクにて、セキュリティインシデント発生時に緊急対応を請け負ってくれる企業の一\n覧があります。初期相談が無料の企業もあります。\n\nJNSA サイバーインシデント緊急対応企業一覧\n\n[https://www.jnsa.org/emergency_response/](https://www.jnsa.org/emergency_response/)\n\n## 謝辞\n\n本稿の執筆にあたり、下記のセキュリティリサーチャ（順不同）による情報共有を活用させ\nていただきました。お礼を申し上げます。\n\nCryptolaemus Team (@Cryptolaemus1)\nExecuteMalware (@executemalware)\nbom (@bomccss)\nわが (@waga_tw)\nmoto_sato (@58_158_177_102)\nMalware Traffic Analysis\n\n[https://www.malware-traffic-analysis.net/](https://www.malware-traffic-analysis.net/)\n\n## IoC（5月10日時点）\n\n### 文書ファイルのハッシュ\n\n7d1ff39fc6daab153ad6477554415336578256257aa81fd796a48b89c7a8b2e8\n\n### Campo Loaderのハッシュ\n\nb8212f866c5cdf1a823031e24fe10444aab103d8fb55a25821e1c7c7366e580f\n\n### DFDownloaderのハッシュ\n\n8589e2d840c3ed5adbdc160724bdb3c2e703adeec1ec1e29983960c9c00c4469\n\n\n-----\n\n### Campo Loaderの通信先\n\nOpenfieldサーバは、Campo Loader以外のマルウェアでも使用されるため、下記には\nBazarCall等で使用される通信先が含まれる可能性があります。\n\n[また、他のOpenfieldのURL情報は、URLhausにも登録されています。](https://urlhaus.abuse.ch/browse/tag/openfield/)\n\nhxxp://nightsalmon[.]xyz/campo/b/b\n\nhxxp://foreverbold[.]xyz/campo/b/b\n\nhxxp://superstartart[.]xyz/campo/b/b\n\nhxxp://steeltits[.]xyz/campo/z/z\n\nhxxp://steeltits[.]xyz/campo/LHq/cD\n\nhxxp://139.162.150[.]121/campo/b/j\n\nhxxp://185.14.31[.]147/campo/j1/j2\n\nhxxp://ship4[.]xyz/campo/i/i\n\nhxxp://gopigs[.]xyz/campo/k/k\n\nhxxp://board3[.]xyz/campo/h/h2\nhxxp://cake3[.]xyz/campo/c4/c4\n\nhxxp://dance4[.]xyz/campo/c5/c5\n\nhxxp://cake3[.]xyz/uploads/files/120.dll\n\nhxxp://chance5[.]xyz/uploads/files/1.dll\n\nhxxp://dance4[.]xyz/uploads/files/120-cr.dll\n\n### DFDownloaderの通信先\n\nshowstoreonline[.]com\n\nmoviesmenia[.]com\n\navydabiz[.]com\n\nkingdomcoffee[.]com\n\ndomaindnsresolver[.]xyz\n\ndomainutility[.]xyz\n\ndomainservicing[.]xyz\n\ndomainsupply[.]xyz\n\n\n-----",
    "language": "JA",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-10 - Overview of Campo, a new attack campaign targeting Japan.pdf"
    ],
    "report_names": [
        "2021-05-10 - Overview of Campo, a new attack campaign targeting Japan.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d1f8bd4e-bcd4-4101-9158-6158f1806b38",
            "created_at": "2023-01-06T13:46:39.487358Z",
            "updated_at": "2025-03-27T02:00:03.107568Z",
            "deleted_at": null,
            "main_name": "BazarCall",
            "aliases": [
                "BazaCall",
                "BazzarCall"
            ],
            "source_name": "MISPGALAXY:BazarCall",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535530,
    "ts_updated_at": 1743041588,
    "ts_creation_date": 1653751684,
    "ts_modification_date": 1653751684,
    "files": {
        "pdf": "https://archive.orkl.eu/adbbf8328289ca1402ea640389c5bee5e41bc212.pdf",
        "text": "https://archive.orkl.eu/adbbf8328289ca1402ea640389c5bee5e41bc212.txt",
        "img": "https://archive.orkl.eu/adbbf8328289ca1402ea640389c5bee5e41bc212.jpg"
    }
}