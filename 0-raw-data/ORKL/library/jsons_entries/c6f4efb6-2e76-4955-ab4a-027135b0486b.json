{
    "id": "c6f4efb6-2e76-4955-ab4a-027135b0486b",
    "created_at": "2023-01-12T15:08:31.632366Z",
    "updated_at": "2025-03-27T02:05:41.593555Z",
    "deleted_at": null,
    "sha1_hash": "281b50c56fe8debeacba0520d7902c58a9af3df5",
    "title": "2022-08-01 - Technical Analysis of Industrial Spy Ransomware",
    "authors": "",
    "file_creation_date": "2022-08-18T03:51:43Z",
    "file_modification_date": "2022-08-18T03:51:43Z",
    "file_size": 1610532,
    "plain_text": "# Technical Analysis of Industrial Spy Ransomware\n\n**[zscaler.com/blogs/security-research/technical-analysis-industrial-spy-ransomware](https://www.zscaler.com/blogs/security-research/technical-analysis-industrial-spy-ransomware)**\n\n[Industrial Spy is a relatively new ransomware group that emerged in April 2022. In some](https://www.zscaler.com/resources/security-terms-glossary/what-is-ransomware)\ninstances, the threat group appears to only exfiltrate and ransom data, while in other cases\nthey encrypt, exfiltrate and ransom data. Industrial Spy started as a data extortion marketplace\nwhere criminals could buy large companies' internal data; they promoted this marketplace\nusing README.txt files that were downloaded using malware downloaders disguised as cracks\nand adware. After these initial promotional campaigns, the threat group introduced their own\nransomware to create double extortion attacks that combine data theft with file encryption. The\n[threat group appears to have also seemingly tried Cuba ransomware briefly before developing](https://www.bleepingcomputer.com/news/security/industrial-spy-data-extortion-market-gets-into-the-ransomware-game/)\ntheir own ransomware in May 2022.\n\n### Key points\n\nIndustrial Spy is a relatively new group that emerged in April 2022 that started by\nransoming stolen data and more recently has combined these attacks with ransomware.\n\nThe threat group exfiltrates and sells data on their dark web marketplace, but does not\nalways encrypt a victim’s files.\n\nThe ransomware utilizes a combination of RSA and 3DES to encrypt files.\n\nIndustrial Spy lacks many common features present in modern ransomware families like\nanti-analysis and obfuscation.\n\nThe threat group is consistently adding roughly two to three victims per month on their\ndata leak portal.\n\n## Industrial Spy Market Promoter\n\n\n-----\n\nThere are two primary executables associated with Industrial Spy. The first binary does not\nimplement any destructive functionality, while the second performs file encryption. The former\nhas been mainly distributed using cracks, adware and other malware loaders. Zscaler\nThreatLabz has observed this binary being distributed in-the-wild with other loaders and\nstealers involving SmokeLoader, GuLoader and Redline Stealer. The sole purpose of this\nmalware is to promote their dark web marketplace; it does not inflict any actual damage to the\ntargeted system.\n\n## Technical Details\n\nThis malware is very basic and performs the following actions before deleting itself:\n\nDisplay a text-based note promoting the Industrial Spy data leak site (as shown in Figure\n1).\n\n_Figure 1: Industrial Spy data leak marketplace promotion note_\n\nEnumerate paths under the registry key SOFTWARE\\Microsoft\\Windows\n_NT\\CurrentVersion\\ProfileList and drop the file readme.txt recursively under all paths with_\nthe same note content.\nChange the wallpaper (shown in Figure 2) to advertise the Industrial Spy data leak\nmarketplace.\n\n\n-----\n\n_Figure 2: Desktop wallpaper set by the Industrial Spy marketplace promotion binary_\n\n## Industrial Spy Ransomware\n\nThe Industrial Spy threat group introduced their own ransomware in May 2022. The Industrial\nSpy ransomware family is relatively basic and parts of the code appear to be in development.\nIndustrial Spy utilizes very few obfuscation methods other than building strings on the stack at\nruntime. The ransomware also lacks many of the features commonly seen in modern\nransomware families (such as anti-debug, anti-sandbox, etc.), although this may change in the\nfuture.\n\nCurrently, there are not many Industrial Spy ransomware samples that have been observed inthe-wild. However, the group is consistently adding roughly two new victims per month on their\ndata leak portal.\n\n## Technical Details\n\nThe Industrial Spy ransomware encryption and decryption both are handled by the same\nbinary. Simplified steps taken by the ransomware are as follows:\n\nParse command-line arguments\nDelete shadow copies\nStart an encryption thread to encrypt all drives or given paths\nSelf-delete\n\n### Delete Shadow copies\n\n\n-----\n\nSimilar to other ransomware families, Industrial Spy deletes Windows shadow copies to make\nfile recovery more difficult as shown in Figure 3.\n\n_Figure 3: Industrial Spy pseudocode to delete Windows shadow copies_\n\n### Mode of Operation\n\nOn execution, Industrial Spy checks whether an RSA public or RSA private key is embedded in\nthe binary. Depending on the type of key, the ransomware will encrypt or decrypt files as shown\nbelow:\n\nif ( mw_ptr_key_encryption_public == 0x1F ){\n\nif ( mw_ptr_key_decryption_private != (char)0xF1 ) {\n\n// decrypt files\n\n}\n\n} else {\n\n// encrypt files\n\n}\n\nInterestingly, it will always delete shadow copies irrespective of the mode.\n\nIf command-line arguments are provided, Industrial Spy will start a thread to recursively encrypt\nfiles for each path argument that is provided. If no arguments are given, Industrial Spy will\nenumerate all drives and start one thread per volume (if it is not read-only). Each thread will\nrecursively enumerate and encrypt files. All files for which the extension and path does not fall\nunder the exclusion list will be encrypted. Paths containing the following strings are excluded:\n\n_\\microsoft\\_\n_\\google\\chrome_\n_\\mozilla\\firefox_\n_\\opera\\_\n\n\n-----\n\nThe following file extensions are also excluded:\n\n. .mst .inf1 .shs .dll .scr .cmd .ps1 .jse\n\n.bat .paf .ins .u3p .exe .sct .com .reg .vbscript\n\n.bin .pif .inx .vb .gadget .shb .cpl .rgs .msi\n\n.job .vbs .isu .vbe .lnk .ws .msc .wsf .wsh\n\nDuring encryption, if the targeted file is locked by another process, Industrial Spy will attempt to\nterminate the process that holds the corresponding file handle, using the Restart Manager API.\n\n**File Encryption**\n\nIndustrial Spy encrypts each file’s content with the Triple DES (3DES) algorithm. Each 3DES\nkey and initialization vector (IV) are then encrypted with a hardcoded RSA public key. The\nresult is appended with a footer to the encrypted file data. Industrial Spy will encrypt up to the\nfirst 100MB of data. Since 3DES is a block cipher, each block is padded accordingly with NULL\n(0x00) bytes to form a multiple of 24 bytes.\n\nAfter encryption, the original file content is overwritten with the following data shown in Figure\n4.\n\n_Figure 4: Industrial Spy encrypted file structure_\n\nThe encrypted file data structure is as follows:\n\nstruct encrypted_file {\n\nbyte 3des_encrypted_file_content[encrypted_size];\n\nbyte rsa_encrypted_key_blob[128];\n\n\n-----\n\nqword original_file_size;\ndword end_of_encrypted_file_marker; // 0xFEEDBEEF\n\n};\n\nThe encryption parameters data structure is the following:\n\nstruct rsa_encrypted_key_blob {\n\nword block_type; // 0x200 (used to validate RSA decryption result)\n\nbyte random_bytes[77]; // random byte padding\n\nbyte null; // 0x00\n\nbyte 3des_key[24]; // used for file data encryption\n\nbyte iv[24];  // only the first 8 bytes are used\n\n};\n\nUnlike nearly all ransomware families, Industrial Spy does not change the file extension after\nencryption. Therefore, the filename itself cannot be used to determine the files that have been\nencrypted. Instead, Industrial Spy appends a file footer that can be used to identify encrypted\nfiles using the last four bytes: 0xFEEDBEEF.\n\n**RSA Key**\n\n[The RSA code used by Industrial Spy is very similar to the ISFB trojan’s source code. This](https://github.com/gbrindisi/malware/tree/667b44f64edcd1c5e8c42489b8e767813a589158/windows/gozi-isfb)\nRSA library was also used by the ransomware known as WastedLocker. Each Industrial Spy\nransomware sample contains a hardcoded 1,024-bit RSA key that is unique to each victim in\nthe following format:\n\n_Figure 5: Embedded Industrial Spy RSA public key_\n\nThe first dword (4-bytes) in blue is the size of the RSA key in bits (0x400), which is 1,024 bits.\nThe RSA key size is then followed by the modulus highlighted above in turquoise. The modulus\ncontains a number of NULL bytes for padding, finally followed by the RSA public exponent (in\norange) along with additional padding.\n\n**Key Generation**\n\nIndustrial Spy generates a per file 3DES key and IV using the RSA library’s random function\n_R_GenerateBytes(). This function takes a random structure as an argument to generate these_\nvalues. The random structure itself is seeded by calling the x86/x64 CPU instruction rdtsc,\n\n\n-----\n\nwhich returns the processor s timestamp. The CPU processor timestamp records the number\nof CPU clock cycles since the last reset. The result of rdtsc is passed to the RSA random\nfunction R_RandomUpdate().\n\nThe R_GenerateBytes() function is called twice to generate two 24-byte pseudorandom\nbuffers. The first buffer is used as a 3DES key for encrypting the file’s data, and the first 8 bytes\nfrom the second buffer are used as the IV.\n\nA Python-based proof-of-concept Industrial Spy ransomware decryptor can be found in the\n[Zscaler ThreatLabz GitHub tools repository.](https://github.com/threatlabz/tools/blob/main/industrialspy/decryptor_poc.py)\n\n## Ransom Note\n\nA file with the name readme.html is dropped in each directory that contains a ransom note as\nshown in Figure 6.\n\n_Figure 6: Example Industry Spy ransom note_\n\nA copy of the Industrial Spy ransom note can be found in the ThreatLabz GitHub ransom note\nrepository [here.](https://github.com/threatlabz/ransomware_notes)\n\n### Victim ID\n\nThe Victim ID referred to as the personal id in the ransom note is just the MD5 hash of the\nmodulus component of the embedded RSA public key.\n\n## Dark Web Market\n\nThe Industrial Spy leak portal is protected with a username and password as shown below in\nFigure 7.\n\n\n-----\n\n_Figure 7: Industrial Spy market login page_\n\nAfter authentication, the Industrial Spy home page is displayed as shown in Figure 8.\n\n\n-----\n\n_Figure 8: Industrial Spy market home page_\n\nThe first victim on the leak site was listed on 03/15/2022. The total victim count as of 25 July\n2022 was 37, and are broken down into the following categories:\n\n24 Free\n13 General\n0 Premium\n\nIndustrial Spy is mostly selling individual files (in the General category) instead of file bundles\nin the price range from $1 to tens of thousands of dollars. The group likely reviews the files\nbefore deciding whether to put a high price tag on sensitive files, and dumps the rest of the files\nwith a $1 to $2 price tag. ThreatLabz has observed operating system files that have limited\nvalue like desktop.ini, thumbs.db listed for $2 as shown in Figure 9.\n\n_Figure 9: Operating system files (e.g., desktop.ini) listed by Industrial Spy for $2_\n\n## Conclusion\n\nIndustrial Spy is a new entrant in the ransomware ecosystem. The malware is not currently\nvery sophisticated, but the file encryption is functional making it a dangerous threat.\nFurthermore, Industrial Spy is consistently adding new victims, proving that the threat group\nhas the capabilities to breach new organizations. Many players come and go in the\nransomware market and it is difficult to determine the groups that will stay for the long term.\nHowever, this threat group is likely to stay at least in the near future with more ransomware\nupdates and features to follow. ThreatLabz continues to monitor all kinds of threats and provide\ncoverage to our customers.\n\n## Cloud Sandbox Detection\n\n\n-----\n\n_Figure 10: Zscaler Cloud Sandbox Report_\n\nIn addition to sandbox detections, Zscaler’s multilayered cloud security platform detects\nindicators related to the campaign at various levels with the following threat names:\n\n[Win32.Ransom.IndustrialSpy](https://threatlibrary.zscaler.com/?threatname=win32.ransom.industrialspy)\n\n## Indicators of Compromise (IOCs)\n\nSHA256 Description\n\n8a5c7fff7a7a52dca5b48afc77810142b003b9dae1c0d6b522984319d44d135a Industrial\nSpy\nransomware\n(debug\nbuild)\n\ndfd6fa5eea999907c49f6be122fd9a078412eeb84f1696418903f2b369bec4e0 Industrial\nSpy\nransomware\n\n5ed4ffbd9a1a1acd44f4859c39a49639babe515434ca34bec603598b50211bab Industrial\nSpy market\npromoter\ntrojan\n\n\n-----\n\n62051ec55c990d2ff21f36a90115986e4ac0eada18306f39687e209f49f2c6ec Industrial\nSpy market\npromoter\ntrojan\n\n911153af684ef3460bdf568d18a4356b84efdb638e3e581609eb5cd5223f0010 Industrial\nSpy market\npromoter\ntrojan\n\n85ea71c910ebb00ba8cae266bf18400a15b08bd341e37e12083ab9a79ff6c943 Industrial\nSpy market\npromoter\ntrojan\n\nc96b098cab47c0a33d0b6d8f14b24e7c9ba897b0c59a2ac1f3dc608ca7a2ed7e Industrial\nSpy market\npromoter\ntrojan\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-01 - Technical Analysis of Industrial Spy Ransomware.pdf"
    ],
    "report_names": [
        "2022-08-01 - Technical Analysis of Industrial Spy Ransomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536111,
    "ts_updated_at": 1743041141,
    "ts_creation_date": 1660794703,
    "ts_modification_date": 1660794703,
    "files": {
        "pdf": "https://archive.orkl.eu/281b50c56fe8debeacba0520d7902c58a9af3df5.pdf",
        "text": "https://archive.orkl.eu/281b50c56fe8debeacba0520d7902c58a9af3df5.txt",
        "img": "https://archive.orkl.eu/281b50c56fe8debeacba0520d7902c58a9af3df5.jpg"
    }
}