{
    "id": "7a8db7a7-3595-4f24-948f-a949107b9920",
    "created_at": "2023-01-12T15:10:28.105772Z",
    "updated_at": "2025-03-27T02:14:42.020363Z",
    "deleted_at": null,
    "sha1_hash": "99d39852a28c464a1cf00c8a9096dd3d39726512",
    "title": "2021-11-01 - BlackMatter- New Data Exfiltration Tool Used in Attacks",
    "authors": "",
    "file_creation_date": "2022-10-02T12:19:22Z",
    "file_modification_date": "2022-10-02T12:19:22Z",
    "file_size": 459349,
    "plain_text": "# BlackMatter: New Data Exfiltration Tool Used in Attacks\n\n**[symantec-enterprise-blogs.security.com/blogs/threat-intelligence/blackmatter-data-exfiltration](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/blackmatter-data-exfiltration)**\n\nAt least one affiliate of the BlackMatter ransomware operation has begun using a custom\ndata exfiltration tool in its attacks. Exmatter, which was discovered by Symantec’s Threat\nHunter Team, is designed to steal specific file types from a number of selected directories\nand upload them to an attacker-controlled server prior to deployment of the ransomware\nitself on the victim’s network.\n\nThis is the third time a custom data exfiltration tool appears to have been developed by\nransomware operators, following the earlier discovery of the Ryuk Stealer tool and StealBit,\nwhich is linked to the LockBit ransomware operation.\n\n## Exmatter in action\n\nExmatter is compiled as a .NET executable and obfuscated. When run, it checks its\ncommand line arguments for the following strings: \"nownd\" and \"-nownd\". If either is found, it\nattempts to hide its own window by calling the \"ShowWindow\" API as follows:\n\nShowWindow(Process.GetCurrentProcess().MainWindowHandle, 0);\n\nIn order to identify files for exfiltration, it will retrieve the drive names of all logical drives on\nthe infected computer and collect all file path names, disregarding anything under the\nfollowing directories:\n\n\n-----\n\nC:\\Documents and Settings\nC:\\PerfLogs\nC:\\Program Files\\Windows Defender Advanced Threat\nProtection\\Classification\\Configuration\nC:\\Program Files\\WindowsApps\nC:\\ProgramData\\Application Data\nC:\\ProgramData\\Desktop\nC:\\ProgramData\\Documents\nC:\\ProgramData\\Microsoft\nC:\\ProgramData\\Packages\nC:\\ProgramData\\Start Menu\nC:\\ProgramData\\Templates\nC:\\ProgramData\\WindowsHolographicDevices\nC:\\Recovery\nC:\\System Volume Information\nC:\\Users\\All Users\nC:\\Users\\Default\nC:\\Users\\Public\\Documents\nC:\\Windows\n\nIt will also exclude files of less than 1,024 bytes in size and files with the following attributes:\n\nFileAttributes.System\nFileAttributes.Temporary\nFileAttributes.Directory\n\nIt will only exfiltrate files with the following extensions:\n\n.doc\n.docx\n.xls\n.xlsx\n.pdf\n.msg\n.png\n.ppt\n.pptx\n.sda\n.sdm\n.sdw\n.csv\n\nIt attempts to prioritize files for exfiltration by using LastWriteTime.\n\n\n-----\n\nFiles that match the criteria are then uploaded to a remote SFTP server using the following\nparameters:\n\nHost: 165.22.84.147\nPort: 22\n\nExmatter also includes SOCKS5 configuration, but this is not used:\n\nHost: 10.26.16.181\nPort: 1080\n\nWhen it has finished exfiltrating data, Exmatter starts the following process to remove any\ntrace of itself:\n\nFilename: \"powershell.exe\"\nArguments:\n\n-WindowStyle Hidden -C $path =\n'[FILEPATH_OF_THE_EXECUTING_SAMPLE]';Get-Process | Where-Object\n{$_.Path -like $path} | Stop-Process -Force;[byte[]]$arr = new-object byte[]\n65536;Set-Content -Path $path -Value $arr;Remove-Item -Path $path;\n\nThis will attempt to overwrite an initial chunk of the file before deleting it.\n\n## Newer variants\n\nMultiple variants of Exmatter have been found, suggesting that the attackers have continued\nto refine the tool in order to expedite exfiltration of a sufficient volume of high value data in as\nshort a time as possible.\n\nIn a second variant, the directory “C:\\Program Files\\Windows Defender Advanced Threat\nProtection\\Classification\\Configuration” has been replaced with “C:\\Program Files\\Windows\nDefender Advanced Threat Protection\" on the exclusion list. The file types “.xlsm”, and “.zip”\nwere added to the inclusion list.\n\nA third version of note added a WebDav client. The code structure suggests that SFTP\nremains the first choice protocol, with WebDav acting as a backup. The WebDav client uses\nthe following URL:\n\nhttps://157.230.28.192/data/\n\nThe following file types were also added to the inclusion list:\n\n.json\n.config\n.ts\n\n\n-----\n\n.cs\n.js\n.aspx\n.pst\n\nIn addition to this, Exmatter is configured to skip exfiltration for files with names containing\nany of the following strings:\n\nOneDriveMedTile\nlocaleSmallLogo\nVisualElements\nadobe_sign\nAdobe Sign\ncore_icons\n\nA fourth variant contained updated SFTP server details:\n\nHost: 159.89.128.13\nPort: 22\n\nThe WebDav client used the following updated URL:\n\nhttps://159.89.128.13/data/\n\nFinally, the list of files for inclusion was updated by removing “.png”.\n\n## Veteran ransomware operators\n\nBlackMatter is linked to the Coreid cyber crime group, which was previously responsible for\nthe Darkside ransomware. For the past 12 months, it has been one of the most prolific\ntargeted ransomware operators and its tools have been used in a number of ambitious\nattacks, most notably the May 2021 Darkside attack on Colonial Pipeline that disrupted fuel\nsupplies to the East Coast of the U.S.\n\nCoreid operates under a RaaS model, working with affiliates to conduct ransomware attacks\nand then taking a share of the profits. Like most ransomware actors, attacks linked to Coreid\nsteal victims’ data and the group then threatens to publish it to further pressure victims into\npaying the ransom demand. Whether Exmatter is the creation of Coreid itself or one of its\naffiliates remains to be seen, but its development suggests that data theft and extortion\ncontinues to be a core focus of the group.\n\n## Protection/Mitigation\n\n\n-----\n\n[For the latest protection updates, please visit the Symantec Protection Bulletin.](https://www.broadcom.com/support/security-center/protection-bulletin)\n\n## Indicators of Compromise\n\n325ecd90ce19dd8d184ffe7dfb01b0dd02a77e9eabcb587f3738bcfbd3f832a1\n\n5e355f90b398cbb54829038c6e5d68e8c578405d142bdcc2386cf6161c8d7014\n\n8eded48c166f50be5ac33be4b010b09f911ffc155a3ab76821e4febd369d17ef\n\nb6bc126526e27c98a94aab16989864161db1b3a75f18bd5c72bacbdfccad7bd7\n\nfcaed9faa026a26d00731068e956be39235487f63e0555b71019d16a59ea7e6b\n\n157.230.28.192\n\n159.89.128.13\n\n165.22.84.147\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-01 - BlackMatter- New Data Exfiltration Tool Used in Attacks.pdf"
    ],
    "report_names": [
        "2021-11-01 - BlackMatter- New Data Exfiltration Tool Used in Attacks.pdf"
    ],
    "threat_actors": [
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536228,
    "ts_updated_at": 1743041682,
    "ts_creation_date": 1664713162,
    "ts_modification_date": 1664713162,
    "files": {
        "pdf": "https://archive.orkl.eu/99d39852a28c464a1cf00c8a9096dd3d39726512.pdf",
        "text": "https://archive.orkl.eu/99d39852a28c464a1cf00c8a9096dd3d39726512.txt",
        "img": "https://archive.orkl.eu/99d39852a28c464a1cf00c8a9096dd3d39726512.jpg"
    }
}