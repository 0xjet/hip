{
    "id": "09ac5895-a863-4e79-a02c-051439412643",
    "created_at": "2023-01-12T15:01:38.440582Z",
    "updated_at": "2025-03-27T02:05:35.614342Z",
    "deleted_at": null,
    "sha1_hash": "87da387898a05985764f6477b612a4f1fa67a1f8",
    "title": "2022-10-20 - Mirai, RAR1Ransom, and GuardMiner – Multiple Malware Campaigns Target VMware Vulnerability",
    "authors": "",
    "file_creation_date": "2022-11-28T19:08:45Z",
    "file_modification_date": "2022-11-28T19:08:45Z",
    "file_size": 340023,
    "plain_text": "# Mirai, RAR1Ransom, and GuardMiner – Multiple Malware Campaigns Target VMware Vulnerability\n\n**[fortinet.com/blog/threat-research/multiple-malware-campaigns-target-vmware-vulnerability](https://www.fortinet.com/blog/threat-research/multiple-malware-campaigns-target-vmware-vulnerability)**\n\nOctober 20, 2022\n\n[In April, VMware patched a vulnerability CVE-2022-22954. It causes server-side template injection because of the lack of](https://www.vmware.com/security/advisories/VMSA-2022-0011.html)\nsanitization on parameters “deviceUdid” and “devicetype”. It allows attackers to inject a payload and achieve remote code\n[execution on VMware Workspace ONE Access and Identity Manager. FortiGuard Labs published Threat Signal Report about it](https://www.fortiguard.com/threat-signal-report/4496/newly-patched-vmware-vulnerability-cve-2022-22954-being-exploited-in-the-wild)\nand also developed IPS signature in April.\n\nWe observed attacks in the wild since then. Most of the payloads focus on probing a victim’s sensitive data, for example,\npasswords, hosts file, etc. But in August, there were a few particular payloads, which got our interest. They had the intention of\ndeploying Mirai targeting exposed networking devices running Linux, RAR1ransom that leverages legitimate WinRaR to deploy\nencryption, and GuardMiner that is a variant of xmrig used to “mine” Monero.\n\nIn this blog, we will elaborate on how these malware leveraged the VMware vulnerability and the behavior after exploitation in\nmore detail.\n\n**Affected platforms: VMware Workspace ONE Access and Identity Manager**\n\n**Impacted parties: VMware users**\n\n**Impact: Attacker can exploit the vulnerability to launch a command injection attack by sending some messages with malicious**\ncommands\n\n**Severity level: Critical**\n\nFigure 1 CVE-2022-22954 Activity\n\n\n-----\n\n## Mirai Variant\n\nThe complete payload from Mirai is shown in Figure 2, it enters temp directory and downloads Mirai variant from\nhttp[:]//107[.]189[.]8[.]21/pedalcheta/cutie[.]x86_64, then executes with parameter “VMware”.\n\nFigure 2 Attacking traffic capture\n\nFigure 3 Decoded command\n\nLike most Mirai botnets, this variant’s main jobs include deploying DoS and launching a brute force attack. We can decode part of\nthe configuration after we XOR the data with 0x54 and get C2 server is “cnc[.]goodpackets[.]cc”. Following is the decoded strings:\n\nFigure 4 Decoded configuration string\n\nWe also identify the brute force function with encoded account and password strings:\n\nFigure 5 Functions for brute force attack\n\nThe decoded passwords are listed below, they are commonly used passwords and also some default credentials for well-known\nIoT devices:\n\nhikvision 1234 win1dows S2fGqNFs\n\nroot tsgoingon newsheen 12345\n\ndefault solokey neworange88888888 guest\n\nbin user neworang system\n\n059AnkJ telnetadmin tlJwpbo6 iwkb\n\n141388 123456 20150602 00000000\n\nadaptec 20080826 vstarcam2015 v2mprt\n\nAdministrator 1001chin vhd1206 support\n\nNULL xc3511 QwestM0dem 7ujMko0admin\n\nbbsd-client vizxv fidel123 dvr2580222\n\npar0t hg2x0 samsung t0talc0ntr0l4!\n\ncablecom hunt5759 epicrouter zlxx\n\npointofsale nflection admin@mimifi xmhdipc\n\nicatch99 password daemon netopia\n\n3com DOCSIS_APP hagpolm1 klv123\n\nOxhlwSG8\n\n\n-----\n\nAfter being executed, the variant shows hardcoded string InfectedNight did its job, and sends heartbeat along with parameter\n“VMware”, then it will wait for further commands from C2 server. Below is the traffic session from heartbeat and brute force\nattack.\n\nFigure 6 Heartbeat traffic capture\n\nFigure 7 Brute force attack session\n\n## Initialization Script for RAR1Ransom and GuardMiner\n\nAnother noticeable payload is from 67[.]205[.]145[.]142. It contains two sessions, each has different commands depending on the\nvictim’s operation system. One leveraged PowerShell to download “init.ps1”, the other uses curl, wget, and urlopen in Python\nlibrary to download “init.sh”.\n\nFigure 8 Attack traffic capture for Windows\n\nFigure 9 Attack traffic capture for Linux\n\nFrom the PowerShell script file “init.ps1”, it includes a few links to cloudflare-ipfs[.]com for further attack and each file has its own\nbackup link to crustwebsites[.]net.\n\nFigure 10 Download links in init.ps1\n\nThere are 7 files for initialization:\n\nphpupdate.exe: Xmrig Monero mining software\nconfig.json: Configuration file for mining pools\nnetworkmanager.exe: Executable used to scan and spread infection\nphpguard.exe: Executable used for guardian Xmrig miner to keep running\ninit.ps1: Script file itself to sustain persistance via creating scheduled task\nclean.bat: Script file to remove other cryptominers on the compromised host\nencrypt.exe: RAR1 ransomware\n\nFigure 11 \"start encrypt\" section in init.ps1\n\nIn the “start encrypt” section shown in Figure 11, it first checks “flag_encrypt.flag” before launching RAR1ransom, if the flag file\nexisted and the “encrypt.exe” was also download before, it will delete “encrypt.exe” and go to the next stage. Otherwise, it checks\nthe file size to determine if the file path should be updated or not. Finally, it executes the ransomware after checking process. The\ndetail of RAR1 ransomware will be elaborated in the next section.\n\nThen, the script starts the GuardMiner attack. GuardMiner is a cross-platform mining Trojan, which has been active since 2020.\n[And FortiGuard Labs has a detailed report covering it. In this version, it also drops the script file “init.sh” for Linux system.](https://www.fortinet.com/content/dam/fortinet/assets/analyst-reports/report-guardminer-operation-disclosed.pdf)\n\nFigure 12 “init.sh” for Linux\n\nWe also noticed that GuardMiner updates “networkmanager.exe” with the more recently vulnerability. From the name of each\n[exploit module, it might collect the exploit list from Chaitin Tech Github which is for security testing purposes.](https://github.com/chaitin/xray/releases)\n\nFigure 13 rdata section contains vulnerability list in networkmanager.exe\n\nWe extract the complete vulnerability list below:\n\neyou-email-system-rce maccms-rce\n\nthinkphp5-controller-rce seacms-rce\n\nterramaster-tos-rce-cve-2020-28188 spon-ip-intercom-ping-rce\n\nthinkphp5023-method-rce yonyou-grp-u8-sqli-to-rce\n\n\n-----\n\nyccms-rce gitlist-rce-cve-2018-1000533\n\nphpunit-cve-2017-9841-rce pandorafms-cve-2019-20224-rce\n\nyonyou-nc-bsh-servlet-bshservlet-rce CVE-2022-22947-spring-clond-Gateway-RCE\n\nCVE-2022-22954-VMware-RCE amtt-hiboss-server-ping-rce\n\ninspur-tscev4-cve-2020-21224-rce dlink-dsl-2888a-rce\n\nphpstudy-backdoor-rce Confluence-CVE-2022-26134\n\nseacms-before-v992-rce apache-flink-upload-rce\n\ndedecms-cve-2018-7700-rce solr-velocity-template-rce\n\nwebmin-cve-2019-15107-rce jumpserver-unauth-rce\n\nHotel-Internet-Manage-RCE drupal-cve-2018-7600-rce\n\nseacms-v654-rce S2-045-rce\n\ntamronos-iptv-rce ecshop-rce\n\nsatellian-cve-2020-7980-rce opentsdb-cve-2020-35476-rce\n\nzeroshell-cve-2019-12725-rce struts2-062-cve-2021-31805-rce\n\ndlink-cve-2019-16920-rce h3c-imc-rce\n\n## RAR1Ransom\n\nRAR1ransom drops “rar.exe” in C:/Windows/Temp folder which is legitimate WinRaR software to compress a victim’s files with a\npassword. It uses several default options in WinRaR to complete the encryption for efficiency, we can locate these processes from\nProcess Explorer in Figure 14.\n\nFigure 14 Processes while RAR1Ransom encrypted files\n\nThe whole command is below, options “df” and “m0” mean delete files after adding files to archive without compression, “mt10”\nmeans it will use ten threads, and “ep” means exclude path from name. The “hp” is to encrypt both file data and headers with\npassword.\n\n_C:/Windows/Temp/rar.exe a -df -m0 -mt10 -ep -_\n_hpVbDsLHSfbomQiQ6YuP7m1ZaNP0LQqYpzrkjwvuNSjsnQlicOxNPi0iKzKeQO1Besbpbx1iKWNeOfFQDEw8qaoAGmN1Nx9i0vbUcr_\n_\"C:/Python27/Lib/json/MVXGG33EMVZC44DZ.rar1\" \"C:/Python27/Lib/json/MVXGG33EMVZC44DZ\"_\n\nRAR1Ransom targets a compromised victim’s file with particular extensions as in Figure 15.\n\nFigure 15 Target file extension\n\nAll the encrypted files will have an unique filename and “.rar1” extension, and it drops a text file “READ_TO_DECRYPT.txt” in the\nsame folder with message in Figure 17.\n\nFigure 16 Encrypted files\n\n\n-----\n\nFigure 17 Ransom note\n\nFrom the wallet string in the ransom note, which is identical with the one in the miner’s configuration shown in Figure 17. We can\ntell the attacker intends to utilize a victim’s resources as much as possible, not only to install RAR1Ransom for extortion, but also\nto spread GuardMiner to collect cryptocurrency.\n\nFigure 18 Configuration”config.json” for GuardMiner\n\n## Conclusion\n\nAlthough the critical vulnerability CVE-2022-22954 is already patched in April, there are still multiple malware campaigns trying to\nexploit it. Users should always keep systems updated and patched and be aware of any suspicious process in environment.\nThese Mirai variants, RAR1Ransom, and GuardMiner are not extremely complicated samples, but their methods are always\nchanging and evolving. FortiGuard Labs will continue to monitor and provide the latest updates.\n\n## Fortinet Protections\n\n[Fortinet released IPS signature VMware.Workspace.ONE.Access.Catalog.Remote.Code.Execution for CVE-2022-22954 to](https://www.fortinet.com/products/ips)\nproactively protect our customers. The signature is officially released in IPS definition version 20.297.\n\nThe scripts and malwares are detected and blocked by FortiGuard Antivirus, and FortiEDR services:\n\nAdware/Miner\n\nW32/PossibleThreat\n\nRiskware/Agent\n\nBASH/CoinMiner.RZ!tr\n\nPowerShell/CoinMiner.BW!tr\n\nELF/GuardMiner.A!tr\n\nW64/GuardMiner.A!tr\n\nBAT/Cleaner.CC41!tr\n\n## IOCs\n\n### SHA256:\n\n66db83136c463441ea56fb1b5901c505bcd1ed52a73e23d7298f7055db2108d1\n\n4761e5d9bd3ebe647fbd7840b7d2d9c1334bde63d5f6b05a4ed89af7aa3a6eab\n\n9c00823295f393358762542418bb767b44cfe285c4ab33e7e57902c6e1c2dacb\n\n23270d23f8485e3060f6ea8c9879177781098b1ed1b5117579d2f4d309aeffd2\n\n4b3578ee9e81f356a89ff2e1aff6bbee8441472869b0c6c4792fc9fd486a0df5\n\n0212b447c25e9db55f7270e1e2a45846e2261445474845997a314cb1ddeea4f7\n\na372e07a691f8759e482615fd7624bfca2a2bc2cd8652a47ff9951ff035759a5\n\nf2a6827ea5f60cefc2f6528269b2d1557a7cc1e68f84edca4029e819dd0509cb\n\n4b4c0d3cb708612b1fdb0394e029e507e4c0f6136fc44e415200694624ed5b68\n\n7fc7c242ad1fa439e515725561a9e304b3d94e40ba91f61df77471a4c2ff2b39\n\n_Learn more about Fortinet’s_ _[FortiGuard Labs threat research and global intelligence organization and Fortinet’s FortiGuard AI-](https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_medium=blog&utm_campaign=fortiguard-labs)_\n_[powered Security Services portfolio.](https://www.fortinet.com/solutions/enterprise-midsize-business/security-as-a-service/fortiguard-subscriptions?utm_source=blog&utm_medium=blog&utm_campaign=fortiguard-subscriptions)_ _[Sign up to receive our threat research blogs.](https://www.fortinet.com/blog/threat-research?utm_source=blog&utm_medium=blog&utm_campaign=threat-research)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-10-20 - Mirai, RAR1Ransom, and GuardMiner – Multiple Malware Campaigns Target VMware Vulnerability.pdf"
    ],
    "report_names": [
        "2022-10-20 - Mirai, RAR1Ransom, and GuardMiner – Multiple Malware Campaigns Target VMware Vulnerability.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535698,
    "ts_updated_at": 1743041135,
    "ts_creation_date": 1669662525,
    "ts_modification_date": 1669662525,
    "files": {
        "pdf": "https://archive.orkl.eu/87da387898a05985764f6477b612a4f1fa67a1f8.pdf",
        "text": "https://archive.orkl.eu/87da387898a05985764f6477b612a4f1fa67a1f8.txt",
        "img": "https://archive.orkl.eu/87da387898a05985764f6477b612a4f1fa67a1f8.jpg"
    }
}