{
    "id": "2d18ec01-4b54-4492-bdf8-9bd6b97e2d66",
    "created_at": "2023-01-12T14:59:31.774783Z",
    "updated_at": "2025-03-27T02:16:20.991855Z",
    "deleted_at": null,
    "sha1_hash": "ab305577e8b4013b7ecaa248dd6634fd603ca1e2",
    "title": "2014-12-08 - The ‘Penquin’ Turla",
    "authors": "",
    "file_creation_date": "2022-05-27T21:17:45Z",
    "file_modification_date": "2022-05-27T21:17:45Z",
    "file_size": 558664,
    "plain_text": "# The ‘Penquin’ Turla\n\n**securelist.com/blog/research/67962/the-penquin-turla-2/**\n\nAuthors\n\n[Kurt Baumgartner](https://securelist.com/author/kurtb/)\n\n[Costin Raiu](https://securelist.com/author/costin/)\n\n## A Turla/Snake/Uroburos Malware for Linux\n\nRecently, an interesting malicious sample was uploaded to a multi-scanner service. This\nimmediately triggered our interest because it appears to represent a previously unknown\npiece of a larger puzzle. That puzzle is “Turla”, one of the most complex APTs in the world.\n\n[We have written previously about the Turla APT with posts about their Epic Turla operations](https://securelist.com/the-epic-turla-operation/65545/)\n[and Agent.btz inspiration.](https://securelist.com/agent-btz-a-source-of-inspiration/58551/)\n\n\n-----\n\nSo far, every single Turla sample we’ve encountered was designed for the Microsoft\nWindows family, 32 and 64 bit operating systems. The newly discovered Turla sample is\nunusual in the fact that it’s the first Turla sample targeting the Linux operating system\nthat we have discovered.\n\nThis newly found Turla component supports Linux for broader system support at victim sites.\n[The attack tool takes us further into the set alongside the Snake rootkit and components first](http://www.baesystems.com/what-we-do-rai/the-snake-campaign)\nassociated with this actor a couple years ago. We suspect that this component was running\nfor years at a victim site, but do not have concrete data to support that statement just yet.\n\n\n-----\n\nThe Linux Turla module is a C/C++ executable statically linked against multiple libraries,\ngreatly increasing its file size. It was stripped of symbol information, more likely intended to\nincrease analysis effort than to decrease file size. Its functionality includes hidden network\ncommunications, arbitrary remote command execution, and remote management. Much of\nits code is based on public sources.\n\n**Md5** **Size** **Verdict Name**\n\n0994d9deb50352e76b0322f48ee576c6 627.2 kb N/A (broken file)\n\n14ecd5e6fc8e501037b54ca263896a11 637.6 kb HEUR:Backdoor.Linux.Turla.gen\n\nGeneral executable characteristics:\n\nELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, for GNU/Linux\n2.2.5, stripped\n\nStatically linked libraries:\n\nglibc2.3.2 – the GNU C library\nopenssl v0.9.6 – an older OpenSSL library\nlibpcap – tcpdump’s network capture library\n\nHardcoded C&C, known Turla activity: news-bbc.podzone[.]org\nThe domain has the following pDNS IP: 80.248.65.183\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n\n80.248.65.183\n\naut-num:    AS30982\n\nannouncement:  80.248.65.0/24\n\nas-name:    CAFENET\n\ndescr:     CAFE Informatique et telecommunications\n\nadmin-c:    YN2-AFRINIC\n\ntech-c:     AN39-AFRINIC\n\norg:      ORG-CIet1-AFRINIC\n\nmnt-by:     AFRINIC-HM-MNT\n\nmnt-lower:   CAFENET-NOC\n\nsource:     AFRINIC # Filtered\n\n\n-----\n\nNote: the C&C domain is currently sinkholed by Kaspersky Lab.\n\n## Functional description\n\n[The sample is a stealth backdoor based on the cd00r sources.](http://www.phenoelit.org/stuff/cd00r.c)\n\nThis Turla cd00r-based malware maintains stealth without requiring elevated privileges while\nrunning arbitrary remote commands. It can’t be discovered via netstat, a commonly used\nadministrative tool. It uses techniques that don’t require root access, which allows it to be\nmore freely run on more victim hosts. Even if a regular user with limited privileges launches\nit, it can continue to intercept incoming packets and run incoming commands on the system.\n\n### Startup and Execution\n\nTo start execution, the process requires two parameters: ID (a numeric value used as a part\nof the “magic packet for authentication”) and an existing network interface name. The\nparameters can be inputted two different ways: from STDIN, or from dropper a launching the\nsample. This is NOT a command-line parameter, it’s a real prompt asking the attacker user to\nprovide the input parameters. After the ID and interface name are entered and the process\nlaunched, the backdoor’s process PID is returned. Here is a screenshot of this simple\ninterface:\n\nWhile there is no initial network callback, a section of code maintains a hardcoded c2 string\n“news-bbc.podzone[.]org”. This fully qualified domain name was first set up in 2010,\nsuggesting that this binary is fairly recent in the string of Turla campaigns. Also, while we\nhaven’t seen additional file download activity from this server by this tool, it likely participated\nas a file server of sorts.\n\n### Magic Packets for Remote Command Execution\n\nThe module statically links PCAP libraries, and uses this code to get a raw socket, applies a\nfilter on it, and captures packets, checking for a specific condition (the *original cd00r first\nused this method, based on ports and SYN-packets). This condition is expressed here (it is\nbased on the ID value input at startup by the attacker):\n\nID = 123 Filter = (tcp[8:4] & 0xe007ffff = 0xe003bebe) or (udp[12:4] & 0xe007ffff =\n0xe003bebe) ID = 321 Filter = (tcp[8:4] & 0xe007ffff = 0x1bebe) or (udp[12:4] & 0xe007ffff =\n0x1bebe)\n\n\n-----\n\nIn simple terms, it checks for an ACK number in the TCP header, or the second byte from the\nUDP packet body.\n\nIf such a packet is received and the condition check is successful, execution jumps to the\npacket payload contents, and it creates a regular socket. The backdoor handles this socket\nas a file with read/write operations. It’s not the typical recv/send used in this code. It uses this\nnew socket to connect to the source address of the “magic packets”. Then it reports its own\nPID and IP to the remote address, and starts an endless loop for receiving remote\ncommands. When a command arrives, it is executed with a “/bin/sh -c ” script.\n\nFurther analysis of the sample’s functionality will be updated here.\n\n## Conclusions\n\nAlthough Linux variants from the Turla framework were known to exist, we haven’t seen any\nin the wild yet.\n\nThis specific module appears to have been put together from public sources with some\nadded functionality from the attackers. Some of the malicious code appears to be inactive,\nperhaps leftovers from older versions of the implant. Perhaps the most interesting part here\nis the unusual command and control mechanism based on TCP/UDP packets, as well as the\nC&C hostname which fits previously known Turla activity.\n\nThe discovery of this Turla module rises one big question: how many other unknown Turla\nvariants exist?\n\n**Update: Since the publishing of this blogpost, we have discovered another Linux Turla**\nmodule, which apparently represents a different malware generation than the previously\nknown samples:\n\n\n-----\n\nThe new sample was heuristically detected by our product due to similarities with the\npreviously discovered samples.\n\n**Md5** **Size** **Verdict Name**\n\n19fbd8cbfb12482e8020a887d6427315 801,561 bytes HEUR:Backdoor.Linux.Turla.gen\n\n## Related research:\n\n[BAE Systems – The Snake Campaign](http://www.baesystems.com/what-we-do-rai/the-snake-campaign)\n[Kaspersky Lab – The Epic Turla Operation](https://securelist.com/the-epic-turla-operation/65545/)\n[“TR-25 Analysis – Turla / Pfinet / Snake/ Uroburos” by CIRCL.LU](https://www.circl.lu/pub/tr-25/)\n[“Uroburos: the snake rootkit”, technical analysis by deresz and tecamac](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2014/12/20082137/uroburos.pdf)\n[Agent.BTZ – A Source of Inspiration?](https://securelist.com/agent-btz-a-source-of-inspiration/58551/)\n\n[APT](https://securelist.com/tag/apt/)\n[Backdoor](https://securelist.com/tag/backdoor/)\n[Linux](https://securelist.com/tag/linux/)\n[Turla](https://securelist.com/tag/turla/)\n\nAuthors\n\n\n-----\n\n[Kurt Baumgartner](https://securelist.com/author/kurtb/)\n\n[Costin Raiu](https://securelist.com/author/costin/)\n\nThe ‘Penquin’ Turla\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-12-08 - The ‘Penquin’ Turla.pdf"
    ],
    "report_names": [
        "2014-12-08 - The ‘Penquin’ Turla.pdf"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535571,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1653686265,
    "ts_modification_date": 1653686265,
    "files": {
        "pdf": "https://archive.orkl.eu/ab305577e8b4013b7ecaa248dd6634fd603ca1e2.pdf",
        "text": "https://archive.orkl.eu/ab305577e8b4013b7ecaa248dd6634fd603ca1e2.txt",
        "img": "https://archive.orkl.eu/ab305577e8b4013b7ecaa248dd6634fd603ca1e2.jpg"
    }
}