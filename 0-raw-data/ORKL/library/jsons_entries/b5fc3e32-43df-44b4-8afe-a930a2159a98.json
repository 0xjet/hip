{
    "id": "b5fc3e32-43df-44b4-8afe-a930a2159a98",
    "created_at": "2023-01-12T15:07:24.263167Z",
    "updated_at": "2025-03-27T02:05:33.715369Z",
    "deleted_at": null,
    "sha1_hash": "7a357426eea34cf22e28987a1dfb2ebe53989c30",
    "title": "2019-04-18 - Predator the Thief- New Routes of Delivery",
    "authors": "",
    "file_creation_date": "2022-05-27T22:34:14Z",
    "file_modification_date": "2022-05-27T22:34:14Z",
    "file_size": 535094,
    "plain_text": "# Predator the Thief: New Routes of Delivery\n\n**[fortinet.com/blog/threat-research/predator-the-thief-new-routes-delivery.html](https://www.fortinet.com/blog/threat-research/predator-the-thief-new-routes-delivery.html)**\n\n## A FortiGuard Labs Threat Analysis Paper\n\n### Introduction\n\n\nApril 18, 2019\n\n\nIn March 2019, FortiGuard Labs discovered a running campaign against Russian-speakers\nusing a new version of “Predator the Thief” stealer malware. The same actor was using one\nset of dummy files to deliver the stealer via different forms of phishing, including Zipped files,\nfake documents, fake pdfs, and the WinRAR exploit described in CVE-2018-20250.\n\nIn this article, we observe the way the author sells this malware on hacking and game\ncheating forums, as well as how it is maintained and updated. After that, we look at the\nmalware code and examine the traps it contains. Finally, we show how a malware customer\nobfuscates and delivers the malware, along with other samples he experimented with.\n\n### Predator the Thief\n\n\n-----\n\n_Predator the Thief was first observed by us in July of 2018, and it is one of the various_\nstealer malware variants sold on hacking forums. The malware contains a C2 control panel\nand the malware executable builder.\n\nIts functionality is quite normal for a stealer. It can gather information about an infected host,\nsteal passwords from browsers, replace cryptocurrency wallets in the buffer, take photos\nfrom the web-camera, and many other configurable options. The interesting thing is that\nunlike many other stealers written in C#, this malware is fully written in C/C++.\n\nAs the core of the malware has not changed much since the latest posts on this topic, you\n[can check out more details in the analysis report of version 2.3.5 by](https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/) [Fumik0_.](https://twitter.com/fumik0_)\n\nIn that analysis, we learned that the initial malware was written by “Alexuiop1337”. Checking\nthe advertisement published on one of the hacking and game cheating forums, we can see\nthat the promotion of Predator continues to be very active, and that the malware author is\nnow calling himself “Kongress_nlt”.\n\n_Figure 1. Advertisement for the malware_\n\nFollowing the link on the forum, we observed a telegram profile of “sett9”, whose chats are\nstill being frequently updated. It seems like the chat “@sett9blog” is used less, and\n“@PredatorSoftwareChannel” is used just as a private blog for reverse engineering and\nPredator update news.\n\n_Figure 2. User sett9 in Telegram and his public chats_\n\nWith the information provided in @PredatorSoftwareChannel we can see the malware’s\nupdate timeline. The malware version v3.0.8 was released on 04.03.2019, and another new\nversion v3.1.0 was released on 21.03.2019. The latest release notes from the malware\nauthor are available on the Telegram channel. The translated version is shown in the\nfollowing figure:\n\n_Figure 3. Release notes for Predator v3.0.8 and v3.1.0_\n\n### Another Release: v3.2.0\n\nAnd now, the author has just announced another release – v3.2.0. This release also affects\nthe price of the malware, raising the price from $35 to $80 USD.\n\n_Figure 4. Translated release notes for the 3.2.0 version of malware_\n\nThere is also a new, interesting feature mentioned by the malware author – the malware has\nbeen fully rewritten to make it fileless. This means that the malware will not leave any files or\ndirectories in the system, enabling it to run much stealthier on a victim’s machine.\nUnfortunately, as of the date this article was written, we haven’t found samples of v3.1.0 or\n\n\n-----\n\nv3.2.0 in the wild. For this research blog, we have analyzed the older version of Predator the\n_Thief —v3.0.8 — used in the campaign possibly started by the author himself or one of his_\ncustomers.\n\n### Trap for Analysis\n\nThe Predator version used by those unknown actors has not changed much from its previous\nversion.\n\nOnce we started our analysis, we obtained the version information in a text file after its\nexecution.\n\n_Figure 5. Predator version information in information.txt_\n\nThe code of the malware is obfuscated to try and slow down any analysis. We found that\nevery string in Predator is dynamically produced, with some of them being hardcoded in the\nfile or its assembly with simple byte operations like “xor”, “not” or “sub” encoding.\n\nInterestingly, it includes traps to perform fake character-decoder-like function pairs. It inputs\nthe correct character byte-by-byte into the function pairs, and then outputs the same\ncharacter. In Figure 6, the red square shows how the string “cmdvrt64.dll” is input into the\ntrap functions.\n\n_Figure 6. Confusing string generation and trap function for normal string input_\n\n### C2 Connection\n\nIn this campaign, all the samples use the following domain as their C2 server.\n\nhxxp://sonsobakq1.mcdir[.]ru/\n\n“mcdir[.]ru” is a Web Hosting service in Russia, where anyone can register his subdomain for\nfree. We also found the following connection patterns with this C2 server.\n\nhxxp://sonsobakq1.mcdir[.]ru/api/conf.get\n\nhxxp://sonsobakq1.mcdir[.]ru/api/info.get\n\nhxxp://sonsobakq1.mcdir[.]ru/api/gate.get?p1=[x]&p2=[x]&p3=[x]&p4=[x]&p5=\n\n[x]&p6=[x]&p7=[x]\n\nhxxp://sonsobakq1.mcdir[.]ru/api/download.get\n\n[Only “conf.get” was not mentioned in the previous analysis report by](https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/) [Fumik0_, as it was](https://twitter.com/fumik0_)\nprobably added in the newer versions of the malware. So we will dig in to provide more\ninformation here.\n\n\n-----\n\nThere are seven items in the response data. However, only five of those items are processed\nby the configuration processing function. We find that those items are simply used as flags in\nthe main routine of Predator the Thief to enable/disable specific functionalities.\n\n_Figure 7. Data in configuration respond_\n\nThe meanings for different items are shown below.\n\np1: Web camera video capture\np2: Anti-debug/Anti-sandbox\np3: Firefox password stealer configuration flag for collecting logins.json and\nsignons.sqlite\np4: Steam data stealer\np5: Screenshot capture\n\nThe flags “p7” and “p8” are not used in the current version. There is a setting for grabber to\nchange target file extensions. However, that setting is not enabled either.\n\nFigure 7 above shows the configuration with screenshot capturer and the Firefox\nconfiguration flag enabled (0 is enabled for the Firefox configuration).\n\n### Delivery Tricks Used in this Predator Campaign\n\nWe found Predator samples packed with AutoIt in this campaign, and all of them use fabric\nmaterials price-list or same-cloth pictures to attract victims to execute the AutoIt-packed\nmalware.\n\n### Phishing with Archive and Fake Document\n\nOne of the samples observed in this campaign is placed in a zip file and faked as a\ndocument among a set of pictures.\n\nIn Figure 8, we can see what the old trick is: it uses a document-like icon to fake the\ndocument with an executable file. The name of the zip file in English is the name of a\ncompany that specializes in the design and sale of personal protective equipment and\nuniforms. The fake document name translates to mean “Tailoring Order for”, and it then\nnames one of the territorial divisions of a federal city in Russia, which is a very targeted\nname for a document.\n\nAfter executing the executable, a dummy document is then shown (Figure 9) as if it were\nlegit. However, the malware is also executed at the same time in the background.\n\n_Figure 8. Phishing zip with fake document and dummy image_\n\n_Figure 9. Dummy document used by the malware_\n\n\n-----\n\n### Phishing with WinRAR Exploit\n\nAnother sample exploits a vulnerability in the UNACEV2.dll library of WinRAR software\n[previously identified in CVE-2018-20250.](https://nvd.nist.gov/vuln/detail/CVE-2018-20250)\n\nThere are two figures for introducing this trick-triggering exploit.\n\nFigure 10 shows how this exploit is used. When the victim decompresses the malicious “.rar”\nfile, three dummy “.png” images are shown. However, in the background, the exploit is\ntriggered and a malicious file called “hi.exe” is placed in Windows Startup folder.\n\nFigure 11 shows the hidden decompression path for triggering the exploit and placing the\nmalware in the Windows Startup folder so that the next time the user logs into the system the\ndecompressed file will be executed.\n\n_Figure 10. Malware dropped to Startup folder via WinRAR exploit CVE-2018-20250_\n\n_Figure 11. Hidden decompression path for exploiting CVE-2018-20250_\n\nBesides the zip archive and WinRAR exploits, the actor uses additional “containers” for its\nmalware. Those include:\n\nA fake PDF file with the same document name as the one dropped from zip;\nAnother fake document dropping Predator malware that uses the same C2 server.\n\n### Analysis of Decompiled AutoIt Script\n\nAll the samples we investigated were packed with the “CypherIT Crypter” that utilizes AutoIT\nscripting language for hiding the payload.\n\nThe fake document contained in the phishing zip, for example, is packed by AutoIt twice. The\nactor packed Predator malware with CypherIT, and then packed the output again in order to\nadd a dummy document to the executable. The following figure shows the first-stage AutoIt\nscript.\n\n_Figure 12. First-stage AutoIt script for installing malware and dummy document_\n\nWe found that the script is more obfuscated in the malicious payload that was placed in the\nstartup folder via the WinRAR exploit. In Figure 13, the main part of the script is shown. It is\nused for calling the function to decode and execute the Predator the Thief stealer.\n\n_Figure 13. De-obfuscated AutoIt script_\n\nAs the de-obfuscated script shows, it reads and decodes the resource, then it loads the\nshellcode for injecting the decoded payload — which is Predator the Thief malware.\n\n_Figure 14. Decoded executable from resource section in original executable file_\n\n\n-----\n\n### Common Shellcode for Hollow Process Injection\n\nWhen AutoIt script calls the shellcode, it creates a suspended process for “dllhost.exe”, and\nthen uses this hollow process to inject the Predator payload.\n\n_Figure 15. Shellcode for injecting Predator payload into hollow process_\n\n### Unused Functions in the Malicious AutoIt Script\n\n1. Removable device file replacement\n\nIt creates files with a “*.pif” extension, copies the names from the original files, and then\nremoves the original files. It replaces all the files on removable devices with the malware and\ntries to deceive its victims into executing the malware.\n\n2. UAC bypass\n\nIt uses two methods to implement fileless UAC bypass. One uses Event Viewer through\nregistry hijacking, and the other one uses “fodhelper.exe”\n\n3. Downloader for executing the next stage of the malware\n\n### Looking for the Artifacts\n\nIf we recheck the AutoIt script created by the actor, we find something interesting in its path.\nThe script author has left behind install paths from his system.\n\n_Figure 16. Install paths in first stage AutoIt script_\n\nWe found interesting strings within these paths. “Рабочий стол”, found in one string, stands\nfor “Desktop” in the Russian version of Windows. In addition, the C2 server —\nhxxp://sonsobakq1.mcdir[.]ru — can be also interpreted from Russian as “Son of a dog”, or\n“Dream of a dog”. Combined with a document name written in Russian, we can be fairly\ncertain sure that the actor behind this campaign is a Russian-speaker.\n\nFurthermore, we decided to look for any other information linked to the “nrjat” username\nwritten in a malicious script file. The username itself looks like a mistype of the “njRAT”\nmalware widely used by different actors. So when we searched for the “C:\\Users\\nrjat\\” string\nused in malware, we found samples possibly related to this actor. First, we found an AutoIt\nscript sample which is almost the same as the one we analyzed in the previous section:\n\n_Figure 17. AutoIt script sample related to the nrjat_\n\nIn addition, the actor has a habit of compiling malware in debug mode of Visual Studio. The\nfollowing figure shows the list of the samples developed or compiled by the “nrjat”.\n\n_Figure 18. Samples developed or compiled by the actor_\n\n\n-----\n\nUsing these artifacts, what s left in the malware samples makes it easier for us to observe his\nactivities. In June of 2018, he compile the XMR miner. And since October 2018, he has\nstarted compiling and using “Arkei stealer” malware. After researching his previous activity,\nwe found several samples to be buggy – their decryption component was broken and the\nmalware was not able to properly unpack itself. We also discovered that he tried to obfuscate\nthe Arkei stealer with a “self-morphing-csharp-binary” packer, the source of which we were\nable to find on GitHub.\n\nIn general, all of the samples we examined contain debug information of “nrjat”, and we also\nobserved the consistent use of specific obfuscation tools like CypherIT Crypter used in the\ncurrent campaign.\n\n### Conclusion\n\nFortiGuard Labs tracked the Predator the Thief campaign targeting Russian speakers.\n\nWe found out that the campaign actor has been active since last June, 2018. The actor\npossibly collected his malware from one of the hacking forums or chats and prepared at least\none template for his phishing campaign. He also uses simple but effective phishing\ntechniques to make victims execute the malware.\n\n_Predator the Stealer in this campaign has not change much from previous versions, but we_\nhave found several new tricks the actor uses for spreading this malware. He uses fake zips\nand documents. Sometimes very specifically targeted to a victim, and even uses the\nWinRAR exploit to spread the malware. The payload was packed using a third-party packing\ntool that utilizes the AutoIT scripting language. Checking the path hardcoded in the script\nrevealed that this “nrjat” actor is experimenting with different malware and stealers.\n\nFortiGuard Labs will continue to monitor this malware author’s activity along with any\n_Predator the Thief malware campaigns._\n\n-= FortiGuard Lion Team =\n### Solution\n\nFortinet users are protected from mentioned malicious threats with the following solutions:\n\nFiles are detected by FortiGuard Antivirus\nMalicious URLs are blocked by our FortiGuard Web Filtering Service\n\n### IOCs\n\nWinRAR exploit Sample:\n\n0387349a884258b521ab239aa8d66832f61998276f07d928cddd6bcbc1cf6235 AutoIt/Injector.DVD!tr\n\n\n-----\n\nPhishing zip sample:\n52fecde66e386cc9b8affe3ff9a0a3ca7d1183ff64e22e9538d0da710bb0818d AutoIt/Injector.DTS!tr\n\nAutoIt packed Predator:\n976246e1663a6a4281ded0fecf4623f046f3d469afce3606987cdf95853ec72b AutoIt/Injector.DVD!tr\n1f6be31a365b27db0b241c2cca082f3125c9b1614a333131d094d803e663d30d AutoIt/Injector.DUS!tr\n63ac7687506b4fe7538bc21c349c3eb913b334e2e6536ff1e5beb05f34587ce5 AutoIt/Injector.DUS!tr\n924c3d33537b72f7f499c982757e630a3e6fe673ee1293ea2e669a14d18155b5 AutoIt/Injector.DUS!tr\n\nUnpacked Predator:\n6651bd04b08e6ac98189750348c32c8c78f35cb800f87a4c654c28451242eb50 W32/Agent.PPZ!tr.spy\n\nAutoIt Script from CypherIT:\ne627dd82ff3bfed8fcac4f297e41af46856109c333640d14af3027e9ec576707 VBS/Nymeria.6707!tr.dldr\n\nCoinminer:\na501dbeb6190252dee719099a7df2857c4dba4a0c196ac3ca9200c23bc348597 Riskware/CoinMiner\nb3e0e892968f12a0511014cde572f04ef03d1719e98d9f63eca0eb766e6049e7 MSIL/Kryptik.EOJ!tr\n818c1ea41f995580fa01a46f1ffd38f58d0633bba6a21e4cede525fd2c289dbf MSIL/Kryptik.EOJ!tr\nd8f8811b49dcda80908e3c8fe98d5b9ac45344c2fbbe3ba3ab0533ea897ffd5e\n\n- MSIL/GenKryptik.BYPV!tr\na3a30b0521eb8fd3d2f13c2c934d12c44db80a4e81642b800549009de4cf40ec W32/Kryptik.OIC!tr\n83ef12cddbc4b68357b79d167dacefc4e94b3cf49fde2f8412f08b8a50cf7a23 MSIL/Kryptik.OJC!tr\n126e43dbcd5851341ac2b5dcf3729d06b6ee4c858984effff8150f36990a56ce W32/Generic_PUA_MP!tr\nd4c1d131ff1d5df5ec8584a3bf0364c94cafea4fd107a081c413cba8c7384f20 W32/Kryptik.OIO!tr\nd42876d4c096fdc9b6fd3b1ef94088c0605b06ff288c4658c39c304dc65bd6e3 W64/CoinMiner!tr\n\n\n-----\n\nself-morphing-csharp-binary:\n85f5c093609938bdd0eede165e9c225e64bd3af1020f38e86bfb20ad708cf694 MSIL/Agent.DMA!tr\n\nArkei Stealer:\n98a951540c810b9b20ba319eb2ec43656cd5e02a9644292f8682752f1697aa1c MSIL/Agent.DMA!tr\n7390a16aa246b30faac296c8ce50eda601943b032497b950c8c47c41c02ac588 MSIL/Agent.DMA!tr\n7b5d2783d41e962b590f5727c07619997c060068c4e864d9c605777dc161f506MSIL/GenKryptik.CLXD!tr\ndab4ce6249544b0bf0f8e6ae8a7cea826e0c21225e8aaf9beacf6a6eb800169d MSIL/GenKryptik.CLXD!tr\n0c77942d137bf7e6ecf279e1adc98b04641c510eebc2ed826391aef57b086f50 MSIL/Agent.DMA!tr\n7bb0f3485812173fec7e4e1ffda148631de33438cc9ece5bfb6f3ea0dc912a16 MSIL/GenKryptik.CLXD!tr\n1e0a23c53f8aad24446a6ad9404b0251687d402547ab8bb3f949ab9e2e89d9c3MSIL/GenKryptik.CLXD!tr\n\nC2 URLs:\nhxxp://sonsobakq1.mcdir[.]ru/ - Malicious\nhxxp://sonsobakq1.mcdir[.]ru/api/conf.get - Malicious\nhxxp://sonsobakq1.mcdir[.]ru/api/info.get - Malicious\nhxxp://sonsobakq1.mcdir[.]ru/api/gate.get - Malicious\nhxxp://sonsobakq1.mcdir[.]ru/api/download.get - Malicious\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-04-18 - Predator the Thief- New Routes of Delivery.pdf"
    ],
    "report_names": [
        "2019-04-18 - Predator the Thief- New Routes of Delivery.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536044,
    "ts_updated_at": 1743041133,
    "ts_creation_date": 1653690854,
    "ts_modification_date": 1653690854,
    "files": {
        "pdf": "https://archive.orkl.eu/7a357426eea34cf22e28987a1dfb2ebe53989c30.pdf",
        "text": "https://archive.orkl.eu/7a357426eea34cf22e28987a1dfb2ebe53989c30.txt",
        "img": "https://archive.orkl.eu/7a357426eea34cf22e28987a1dfb2ebe53989c30.jpg"
    }
}