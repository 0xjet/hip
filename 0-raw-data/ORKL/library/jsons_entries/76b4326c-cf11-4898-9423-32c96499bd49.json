{
    "id": "76b4326c-cf11-4898-9423-32c96499bd49",
    "created_at": "2023-01-12T14:59:25.980688Z",
    "updated_at": "2025-03-27T02:06:05.306011Z",
    "deleted_at": null,
    "sha1_hash": "047acfcdfb2b865d3dfb0c3cd0720c02c7c6813a",
    "title": "2016-11-07 - Little Trickbot Growing Up- New Campaign",
    "authors": "",
    "file_creation_date": "2022-05-28T03:42:21Z",
    "file_modification_date": "2022-05-28T03:42:21Z",
    "file_size": 1433075,
    "plain_text": "# Little Trickbot Growing Up: New Campaign\n\n**[f5.com/labs/articles/threat-intelligence/malware/little-trickbot-growing-up-new-campaign-24412](https://f5.com/labs/articles/threat-intelligence/malware/little-trickbot-growing-up-new-campaign-24412)**\n\nbyline December 28, 2017\n\nRecently there have been several reports of a financial malware named TrickBot1. The\nmalware’s code looked similar to Dyre’s code but was lacking in functionality in comparison\nto the old Dyre samples. It also had a fairly basic module configuration, including:\n\na system information collecting module\na browser injection module\n\nThe malware had no VNC, SOCKS, and form grabber modules. The samples that were\nobserved in the field had a persistency mechanism, browser function hooks (also known as\nman-in-the-browser) and a short list of Australian targets that were fetched from the\ncommand and control (C&C) server.\n\nThis week our research team came across a new campaign of TrickBot malware. The\nprevious webinjects configuration was partial and looked like a part of a testing version of the\nTrickBot malware. After analyzing this campaign, we noticed a change in the webinjects\nconfiguration.\n\nMany new targets, including Germany and the UK, were added to the previous targets of\nCanada, Australia, and New Zealand.\n\n\n-----\n\nFigure 1: TrickBot target evolution\n\n_Figure 1: TrickBot target evolution_\n\n**Dynamic Injects**\n\nTrickBot has server-side webinjects, meaning, when the user connects to the targeted bank’s\nsite, a replication of the target’s response source is sent to the C&C, where Javascript\ninjections are inserted.\n\nAfter the targeted source has been injected with malicious code, it is returned to the user as\nif it actually came from the bank.\n\nIn the following illustrations, one can see the fields that were added. These are intended to\nfilter out certain file types as they can be fetched from the real bank site.\n\n\n-----\n\nFigure 2: TrickBot’s old configuration\n\n_Figure 2: TrickBot’s old configuration_\n\n\n-----\n\nFigure 3: TrickBot's new configuration\n\n_Figure 3: TrickBot's new configuration_\n\n**Static Injections**\n\nStatic injections, also known as “redirects,” are now fully functional in TrickBot. When the\nuser tries to connect to a targeted site, the malware redirects the request to a malicious C&C\nserver and returns a fake page that looks exactly like the bank’s original page.\n\n\n-----\n\nFigure 4: TrickBot's new configuration\n\n_Figure 4: TrickBot's new configuration_\n\nInside the browser function hook, the request page is forwarded to the fake domain\ncontaining Bot ID inside the “ClientInfo” header.\n\nFigure 5: A redirected request to a malicious domain\n\n_Figure 5: A redirected request to a malicious domain_\n\n**Ping Request**\n\nA ping request, which is sent from every page in the site, is launched by a “start_ping”\nfunction on a “document.ready” event in an endless loop every two seconds (like Dyre).\n\nThese requests are also redirected to the malware’s server inside the browser network hook.\n\n\n-----\n\nFigure 6: A ping is sent by the malicious code in the page\n\n_Figure 6: A ping is sent by the malicious code in the page_\n\n**Hello Dyre, My Old Friend**\n\nSimilar to Dyre, TrickBot uses pipes for its inter-process communication.\n\nOnce a browser is launched, a malicious module (“core-dll.dll”) is injected into its memory by\nthe main TrickBot module in svchost.exe.\n\nFigure 7: TrickBot’s module in Firefox’s address space\n\n_Figure 7: TrickBot’s module in Firefox’s address space_\n\nThe browser module waits for incoming pipe connections. The main module connects to the\nbrowser module using a named pipe “\\Device\\NamedPipe\\ <PID >lacesomepipe” where PID\nis the process ID number of the browser.\n\nFigure 8: The pipe in the infected svchost.exe process\n\n_Figure 8: The pipe in the infected svchost.exe process_\n\nThe commands are one byte long. Each command is a letter that signifies the data to\ntransfer.\n\n\n-----\n\nFigure 9: Handling pipe commands\n\n_Figure 9: Handling pipe commands_\n\nAdditional commands include:\n\n“i” – get client_id, e.g.: ADMIN-PC_W617601.A9B4C7FF18D0126F481CA1758B0A0FEF\n\n“a” – get self ip, e.g.: 8.8.8.8\n\n“g” – get group_id, e.g.: lindoc3\n\n“q” – quit and disconnect the pipe\n\nThe browser module asks the main module for every one of these data pieces and if one of\nthe data pieces is not received, the malcious thread will terminate and the browser will not be\npatched by the malware.\n\nA security improvement from Dyre’s pipe is implemented by closing the pipe right after all the\ncommands are sent. Meaning that if a researcher is inspecting the malware, connecting to\nthe pipe in order to get the configuration is not as trivial as it was in Dyre.\n\nSampled MD5: 104923556ace17b4f1e52a50be7a8ea0\n\n**Conclusion**\n\nIt seems that the creators of this malware are rolling it out to the field gradually, testing its\nspreading capabilities and adding targets as they go along. It is highly likely that we will\nwitness its functionality expand and its target list will continue to grow.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-11-07 - Little Trickbot Growing Up- New Campaign.pdf"
    ],
    "report_names": [
        "2016-11-07 - Little Trickbot Growing Up- New Campaign.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535565,
    "ts_updated_at": 1743041165,
    "ts_creation_date": 1653709341,
    "ts_modification_date": 1653709341,
    "files": {
        "pdf": "https://archive.orkl.eu/047acfcdfb2b865d3dfb0c3cd0720c02c7c6813a.pdf",
        "text": "https://archive.orkl.eu/047acfcdfb2b865d3dfb0c3cd0720c02c7c6813a.txt",
        "img": "https://archive.orkl.eu/047acfcdfb2b865d3dfb0c3cd0720c02c7c6813a.jpg"
    }
}