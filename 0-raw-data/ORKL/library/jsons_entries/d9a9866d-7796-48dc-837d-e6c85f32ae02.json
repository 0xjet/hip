{
    "id": "d9a9866d-7796-48dc-837d-e6c85f32ae02",
    "created_at": "2023-01-12T15:05:30.560668Z",
    "updated_at": "2025-03-27T02:05:28.15898Z",
    "deleted_at": null,
    "sha1_hash": "fc18bcc81a7ae5361326bb8e510805c8f9527a6b",
    "title": "2014-12-19 - The unrelenting evolution of Vawtrak",
    "authors": "",
    "file_creation_date": "2022-05-28T03:29:46Z",
    "file_modification_date": "2022-05-28T03:29:46Z",
    "file_size": 1950705,
    "plain_text": "# Related Insights\n\n**[info.phishlabs.com/blog/the-unrelenting-evolution-of-vawtrak](https://info.phishlabs.com/blog/the-unrelenting-evolution-of-vawtrak)**\n\n### Get The Latest Insights\n\n## By The PhishLabs Team | December 19, 2014\n\n\nDecember 20, 2014\n\n\n[In a recent blog post, we wrote about Vawtrak expanding targets and gaining momentum.](http://blog.phishlabs.com/vawtrak-gains-momentum-and-expands-targets)\nFast forward a few months and the threat is anything but diminishing. Sophos just released a\n[technical report on Vawtrak which discusses the significance of the threat and its Crimeware-](http://www.sophos.com/en-us/medialibrary/PDFs/technical%20papers/sophos-vawtrak-international-crimeware-as-a-service-tpna.pdf)\nas-a-Service model. In December 2014, Vawtrak version 0x38 was released including\nsignificant code and configuration changes that indicate momentum and an intense focus on\ndevelopment of the crimeware kit. To better understand the complexity of the threat, this post\nis a historical review bringing you all the way up to the most recent enhancements observed\nin December.\n\nFirst, a few key points about Vawtrak and its capabilities:\n\nSophisticated, modern banking Trojan\nSmall, efficient client written in MS Visual C\nSophisticated botnet management back-end\nPolymorphic\nAll standard spyware functions (keylogging, etc.)\nAdvanced Man in the Middle webinjects capabilities\nDownloadable configuration\nDevelopment controlled by capable and experienced cybercriminals\n\n## Roots in, you guessed it…Russia\n\nIn the early to mid-2000’s, Nikita Kuzmin, a 25-year-old Russian national (the admitted\ninventor of Gozi) worked on coding spyware and Remote Access Trojans (RATs). He\nborrowed source code from existing families popular at the time, proxy functionality common\nin a couple of kits, spyware functionality from the codebase of UrSnif (developed by Alexey\nIvanov, “subbsta”), and botnet C2/management functions and backend code from Nuclear\nGrabber (based on A311 Death/Haxdoor maintained by Corpse).\n\nKuzmin worked closely with the VXer (computer Virus eXperts) superstars of those days:\n[Corpse, Vladislav Horohorin (BadB), the Vasiliy Gorshkov and Alexey Ivanov team (Suidroot,](http://www.csoonline.com/article/2118241/malware-cybercrime/alexey-ivanov-and-vasiliy-gorshkov--russian-hacker-roulette.html)\n[Eliga, XTZ, Skylack, Kotenok). He had known some of them since the ShadowCrew days.](http://www.securityweek.com/shadowcrew-cybercrime-forum-vendor-sentenced-prison)\nHe was younger than most of his peers, at the time posting that he was looking forward to\n\n\n-----\n\ngetting his A водительские права (Russian motorcycle/class A driver license) and hoping\nto soon be making enough money for a brand-new, “real” motorcycle, so he could finally\nretire the decrepit Мопед Карпаты scooter he picked up on the scene after someone had\ncrashed or ditched it. Despite his young age, he was trusted, respected for his practical\ntechnical skills and coding talent, and also known for his enthusiasm for the idea that Internet\nfraud, especially against Western targets, was a legitimate profession with better pay and\nperks than working for local computer and software retail outlets, university labs, and ISPs.\n\n## Cybercrime-as-a-Service emerges\n\nThrough his VXer contacts, Kuzmin had access to the source code for several crimeware kits\nwith overlapping state-of-the-art capabilities, each kit doing something exceptionally clever in\none key area compared to the others. With the help of a close affiliate of the HangUP Team,\nthey created a repository under version control for a crimeware kit codebase incorporating all\nof these best features – this is what became known as Gozi. The HangUP team was a\nnationalistic group with a common following of “cyberfacism,” shared Russian and Nazi\nimagery, and an overarching theme to wage financial warfare on Western interests through\nthe use of the Internet to commit fraud.\n\nKuzmin and his partners launched their first major operation, 76service, in a beta phase in\n2006 and opened it up as “cybercrime-as-a-service” (CaaS) or “criminal-to-criminal” (“C2C”)\nservices operation to customers from the Internet fraud underground scene in early 2007.\nKuzmin’s partners, in the then brilliantly innovative Gozi/76Service, were Aleksandr Kalinin,\nalso known as Grig (who also used the handles “tempo” and, for the purposes of marketing\nthe service, “76”) and the systems administrator, a Latino man (known as Exoric) in North\nAmerica who spoke Spanish and maintained the relationship with their incubator project’s\nbulletproof hoster in Panama. To this day, Kalinin is still at large in Russia and is implicated\nas part of the [ring involved in breaches at TJX, Heartland, and NASDAQ.](http://krebsonsecurity.com/tag/aleksandr-kalinin/)\n\n## Gozi Exposed\n\nThe first samples from Kuzmin’s production-ready Gozi kit were collected and analyzed in\n2007, subsequently exposing 76service and bringing to an end the period in which the\noperation could thrive without disruption by cybercrime fighters.\n\n\n-----\n\nFigure 1. Analysis of early Gozi code in 2007. [Source: Dell SecureWorks]\n\n## Competition heats up – Gozi 2.0\n\nLooking to compete with kits like Zeus, Kuzmin worked with other partners from the HangUP\nTeam between 2007 and 2009 to refactor a lot of the code and incorporate some of the latest\ntactics from more current codebases. To fund this, thinking the new version in the works\nwould make Gozi 1.0 obsolete, Kuzmin sold the source code for a reported $50,000 plus a\nprofit-sharing arrangement. His buyer was another hacker and old contact, a seasoned\ncyberfraudster using the handles NSD and 01NSD (from a transliterated abbreviation of\n“несанкционированный доступ”, translated as “unauthorized access”) with a reputation\ngoing back at least to HangUP Team days in 2005.\n\nFrustrated with new development efforts, Kuzmin hired Deniss Čalovskis (from Latvia, using\nthe handle “Miami”) in September 2010 to replace Corpse’s formgrabber code with fullfeatured webinjects capability that could not only read but write/modify (man-in-the-middle)\nweb sessions like Zeus and Torpig/Anserin/Mebroot. This was to become the Gozi 2.0\nversion.\n\n## Gozi 1.0 source code leaked\n\nOn September 20, 2010, Kuzmin sent Čalovskis a RAR file of the “Gozi 1.0″ source code so\nČalovskis could work on webinjects. The Gozi kit’s actual name is “CRM” and the RAR file\nincluded CRM version “5557” with a build date of 2010-09-16. It was the latest known\nversion, capable of using a pre-computed list of domain names for C2, which used a\ncombination words from the US Constitution based on the bot group ID and a date in the\nformat MM/YYYY. Negligent to password protect the file, the code was discovered and\nleaked; anyone interested could download the unencrypted, password-less source code, too.\n\n\n-----\n\nFigure 2. Gozi v1.0 source code leak.\n\n## Gozi 2.0 goes live\n\nBeginning in late 2010, Kuzmin worked with “Daniel” Mihai Ionut Paunescu (using the handle\n“Virus”) at PowerHost in Bucharest, Romania, to setup and host multiple botnets using this\nwebinjects-capable Gozi 2.0 against banks in Europe, the UK and the US.\n\n## Kuzmin detained and charged\n\nAfter webinjects were incorporated and “Gozi 2.0” went gold/GA, Kuzmin was arrested in\nCalifornia, pleading guilty six months later and leaving NSD with v1.0 and Čalovskis with\nv2.0 to carry on ad hoc cybercrime operations using Gozi botnets.\n\n## Public attacks against U.S. banks\n\n\n-----\n\nIn 2012, someone, most likely Čalovskis, made the new code available to Oleg\nVsevolodovich Tolstykh (a.k.a. “Sergey”, “Serega”, and “vor v zakone” translated as “thief-inlaw”, and the related handles “vorVzakone” and “vorVzakon”) and Kuzmin’s old friend, NSD.\n[The three launched a very public campaign known as Project Blitzkrieg – a series of attacks](http://krebsonsecurity.com/2012/10/project-blitzkrieg-promises-more-aggressive-cyberheists-against-u-s-banks/)\non U.S. banks specifically, using rejuvenated Gozi 2.0 code with a new backconnect SOCKS\nproxy feature. This version was designed not just to run on 64-bit systems, but it was the first\n[known crimeware kit to actually use webinjects in a 64-bit browser.](https://blog.gdatasoftware.com/blog/article/gozi-goes-64-bit.html)\n\n## Gozi operations in full swing after arrests\n\nWith Kuzmin detained in the U.S., reportedly cooperating with authorities, and vorVzakone\nrunning the show in Russia as NSD took over the code, it made almost no impact on day-today Vawtrak/Gozi 2.0 operations when Kuzmin’s former compatriots in crime were finally\narrested in November (Čalovskis arrested in Latvia) and December (Paunescu arrested in an\nFBI-directed raid of PowerHost in Romania) of 2012.\n\nFigure 3. PowerHost raided and Mihai Paunescu arrested in Romania, December 2012\n\n[Images source: Central European News]\n\nWith a little help and possibly inspiration from the power vacuum created by these arrests,\nthis capable vorVzakone+NSD partnership aspired to be the founder of a cyberfraud\nsyndicate. They provided a builder kit with a manual (but not the source code) and bootcamp style training for wannabe botmasters in exchange for “educational fees” and a share\n[of profits in what vorVzakone described as a “freemium” software business model. Being a](http://krebsonsecurity.com/wp-content/uploads/2012/10/VorVzakonePostxlated.txt)\nconsummate marketer, vorVzakone dropped the old “CRM” name and adopted the Gozi\nname by which it was known worldwide, calling it “Gozi Prinimalka” (the latter word from the\nRussian meaning “to receive”).\n\n\n-----\n\nIn vorVzakone s playbook, his crew would setup and use a bank of cheap computer running\nSkype to [flood the account the holder’s phone line while their account is being raided, to](https://www.youtube.com/watch?v=FRswkzFQtxc#action=share)\nprevent them from receiving confirmation calls or SMS alerts from their banks.\n\nBy Spring 2013, vorVkazone and NSD had found some partners whose capabilities and\nallegiances were vetted through participation in their program. Collectively, they became\nknown as the Neverquest crew.\n\n## Neverquest Crew\n\nNeverquest operations have ditched blocking victims phone lines with Skype, since voice\nand SMS OoBV is used more often than ever to verify the types of transactions used to raid\naccounts. They have since begun using iBanking spyware for Android to intercept both\n[phone calls and SMS, injecting QR codes into pop-ups on the banking site that link to this](http://malware.dontneedcoffee.com/2013/12/nitmo-no-just-ibanking-used-by-the.html)\ntool used by Neverquest to subvert OoBV.\n\nConfused by the code’s genetics and the association with the payload, the malware family is\nstill referred to variously by the AV industry as “Ursniff”/”Snifula,” “Rovenix,” “Vawtrak,”\n“Reveton” (ransomware payload), “Neverquest,” “Tepfer,” and “Dapato,” sometimes different\nnames from the same AV engine for the same exact variant downloaded from a different\ndomain name (same packer, same IP address). Gozi 2.0 and later versions were most\ncommonly referred to as “Vawtrak” but the core Trojans are basically the same thing and are\nall examples of 64-bit Gozi 2.0 “Prinimalka”.\n\nThe main body of the (Russian) Neverquest Vawtrak crew is still overseen by vorVzakone.\nThey have a client-provider relationship but the Neverquest operations are directed at a high\nlevel by him and his partners. In 2014, as part of a post-Project Blitzkrieg operations\nrevitalization effort, that crew added a “bizdev” (business development) section to the\ntargeting configuration in order to steal data that can be mined by back-end processes to\nidentify potential new targets and compromise accounts on other services that might be\nuseful monetizing their efforts.\n\n## Targets\n\nOne of the early non-financial targets to come out the bizdev concept is StubHub, the eBayowned event tickets marketplace. Losses to fraud against StubHub totaled USD $1.6 million.\nVawtrak was the tool used to compromise the 1600 accounts used to commit that fraud. U.S.\nand foreign law enforcement launched a coordinated response which resulted in the arrests\nof seven people across the globe, most of whom had direct business ties with the Russian\nVawtrak crew.\n\nSince June 2014, we’ve seen some slightly out of date, but still full-featured, Vawtrak\nversions attacking a very small number of banks in Japan on a fairly small scale, perhaps in\nwhat are precisely targeted attacks. This is believed to be an Asian crew that graduated from\n\n\n-----\n\nProject Blitzkrieg. However, with new webinjects and code changes commissioned by a\nrelatively new client of Vawtrak’s Russian masters, attacks on Australian banks have grown,\nand banks in New Zealand have been added to the targeting configuration.\n\nThe largest increase is by far the number of North American targets, especially large U.S.\nfinancial institutions. It is clear that Vawtrak is a threat quickly growing in size, scale, and\nsophistication and it is now back on the radar of security researchers, analysts, investigators,\nand law enforcement after being largely discounted and dismissed for nearly a couple of\nyears.\n\n## New version of Vawtrak observed\n\nIn December 2014, Vawtrak version 0x38 was released. There were many significant code\nand configuration changes that indicate momentum and an intense focus on development of\nthe crimeware kit and the service business built on top of the infrastructure provided by\nVawtrak botnets. Other observed changes include:\n\nSignificant changes to how the configuration data (with sensitive communications and\ntargeting information) is protected.\nMany more targets and enhanced webinjects.\nCommunications template and syntax has changed significantly.\nThe bot collects and reports new and more data about the infected system, such as the\nNetBIOS workgroup or domain name.\n\nWe’ve also seen them respond to the attention they are getting from malware analysts and\ninvestigators by finally resorting to the adoption of modern anti-analysis tactics such as\nvirtual machine detection and anti-debugging methods designed to defeat, or at least hinder,\nforensics and both static and dynamic/behavioral analysis.\n\nThat brings us up to the present. Unfortunately, the Vawtrak story is not finished yet, given\nthe following:\n\nHigh scoring results of recent threat modeling exercises applied to Vawtrak and other\ntop threats.\nThe trend of significant increase in the activity associated with spambots, exploit kits,\nand loaders directly tied to Vawtrak distribution.\nSignificant changes in the very latest iterations/versions of the malware.\n\nIt is predicted that we are headed toward a new and dangerous chapter in the Vawtrak story.\nFollow our blog as we continue to closely track this threat and others.\n\n\n-----\n\n## Vishing Attacks Are at an All-Time High, Report Finds\n\nVishing attacks have increased almost 550 percent over the last twelve months, according\nto Agari and PhishLabs’ Quarterly Threat Trends & Intelligence Report.\n\n## Qbot Payloads Dominate Q1\n\n\n-----\n\nQbot payloads targeting enterprises contributed to almost three quarters of all email-based\nmalware since the beginning of 2022.\n\n## Social Media Attacks Double in 2021 According to Latest PhishLabs Report\n\nSocial Media attacks targeting organizations increased 103% in 2021, according to\nPhishLabs’ Threat Trends & Intelligence Report.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-12-19 - The unrelenting evolution of Vawtrak.pdf"
    ],
    "report_names": [
        "2014-12-19 - The unrelenting evolution of Vawtrak.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535930,
    "ts_updated_at": 1743041128,
    "ts_creation_date": 1653708586,
    "ts_modification_date": 1653708586,
    "files": {
        "pdf": "https://archive.orkl.eu/fc18bcc81a7ae5361326bb8e510805c8f9527a6b.pdf",
        "text": "https://archive.orkl.eu/fc18bcc81a7ae5361326bb8e510805c8f9527a6b.txt",
        "img": "https://archive.orkl.eu/fc18bcc81a7ae5361326bb8e510805c8f9527a6b.jpg"
    }
}