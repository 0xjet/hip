{
    "id": "5ed4d81d-440a-4499-8636-5f1875b4ec8b",
    "created_at": "2023-01-12T14:59:15.366701Z",
    "updated_at": "2025-03-27T02:16:35.031811Z",
    "deleted_at": null,
    "sha1_hash": "339ab160338390b53eaf292bc4598740364aab18",
    "title": "2022-01-06 - NOBELIUM’s EnvyScout infection chain goes in the registry, targeting embassies",
    "authors": "",
    "file_creation_date": "2022-05-28T19:23:24Z",
    "file_modification_date": "2022-05-28T19:23:24Z",
    "file_size": 1285424,
    "plain_text": "# NOBELIUM’s EnvyScout infection chain goes in the registry, targeting embassies\n\n**[sekoia.io/en/nobeliums-envyscout-infection-chain-goes-in-the-registry-targeting-embassies/](https://www.sekoia.io/en/nobeliums-envyscout-infection-chain-goes-in-the-registry-targeting-embassies/)**\n\nJanuary 6, 2022\n\n#### NOBELIUM is another name for the APT29 intrusion set¹, operated by a threat actor allegedly linked to the SVR (the Foreign Intelligence Service of the Russian Federation)². NOBELIUM has historically targeted government organizations, non-governmental organizations, think tanks, military, IT service providers, health technology and research, and telecommunications providers.\n\n Despite the low sophistication level of its phishing campaigns targeting Windows, NOBELIUM is well known for its agility once inside the victim’s network. Its operators are careful, patient and masterize cutting edge intrusion techniques against the latest Microsoft technologies and services such as AzureAD. For example, NOBELIUM used a home made passive implant dubbed FoggyWeb to exfiltrate authentication tokens from ADFS servers in a stealthy way³.\n\n\n-----\n\n#### NOBELIUM made the headlines a little over a year ago, following the discovery of a sophisticated supply chain attack against the Solarwinds software, compromising thousands with a validator dubbed “SunBurst”⁴. Beyond its impact and its sophistication, the attack – as disclosed by Kaspersky – had an interesting overlap with a backdoor used by TURLA⁴, an intrusion set that has been active for years and known to be allegedly linked to the Russian FSB. Joint operation between two Russian threat actors or NOBELIUM had access to the same code base? The question remains unanswered today but it is not the first time that overlaps between these two intrusion sets emerge⁵.\n\n Throughout 2021 and following the SolarWinds attack, NOBELIUM engaged in spear phishing campaigns by using mails and social media messaging. These campaigns didn’t use any exploit to compromise Windows endpoints. They simply relied on malicious HTML attachments – called EnvyScout by Microsoft⁶– with a pinch of social engineering. By opening the attachment, the HTML file extracts from itself an ISO file by using a technique dubbed HTML Smuggling. The ISO is then downloaded by the victim and automatically mounted on the victim’s workstation, leading at the end of the exploitation chain to execution of a CobaltStrike beacon.\n\n## New EnvyScout infection chain analysis.\n\n#### On October 21st, 2021, a new EnvyScout HTML file related to the NOBELIUM intrusion set (3d18bc4bfe1ec7b6b73a3fb39d490b64) matched one of our YARA rule on VirusTotal with a detection ratio of 1 on 56.\n\n The rule was done on the possible obfuscated variants of a JavaScript loop used in the EnvyScout initial file disclosed by Microsoft (32e0940e1715392280d4bdb514d9cf11)⁶.\n\n Table 1. Comparison of the two loops\n\n It is worth noting that’s not the only resemblance between the two files, both also have the same headers, with the same MOTW comment⁷, such as:\n\n\n-----\n\n#### Extract 1. Headers in 32e0940e and 3d18bc4b  files\n\n As seen during other phishing campaigns reported in open-source, this file uses the “HTML Smuggling” technique to extract a malicious ISO file. By looking at its content, this file seems to have targeted at least one Iranian embassy, as shown below:\n\n Figure 1. Message shown to the user by the HTML file 3d18bc4bfe1ec7b6b73a3fb39d490b64.\n\n Following this first discovery, another similar HTML file came out in early December (b87073c34a910f20a83c04c8efbd4f43) but this time with no text except the title “Covid information”. The content may have been deleted by the submitters in order to prevent victim identification. However, the next infection chain stage revealed that it targeted at least one Turkey Embassy. It is worth noting that these EnvyScout files don’t contain any SMB trap, web bug, telemetry script or redirection to some 0day exploit targeting iOS as previously seen by Google TAG⁸.\n\n If we take a look at the ISO files metadata, the ISO volume name is the HTA file title and there are some interesting timestamps such as the “Root Directory Create Date” or the “Volume Create Date”. In the first sample, 3d18bc4bfe1ec7b6b73a3fb39d490b64, the timestamps values are 2021:10:20 11:27:18-07:00 (UTC time). Whereas in the second sample, which was uploaded a bit later on VirusTotal, the timestamps values are 2021:11:12 09:28:40-08:00 (UTC time).\n\n These dates indicate the last time that the volume was mounted. This is quite interesting as the ISO files were actually simply extracted and decoded from the HTML files. It seems therefore likely that NOBELIUM built the payloads (or tested its whole attack chain) at these dates. If that is indeed the case, it would mean that the first sample 3d18bc4bfe1ec7b6b73a3fb39d490b64 was created a day before it was uploaded to VirusTotal.\n\n\n-----\n\n#### Unlike the previously described NOBELIUM spear-phishing attacks disclosed by Microsoft, the downloaded ISO files no longer contained a malicious DLL and a shortcut aimed to launch that DLL. In both cases, the ISO simply embeds a malicious HTML Application (HTA) file, executing the rest of the exploitation chain. For the HTA file corresponding to the first HTML file (3d18bc4bfe1ec7b6b73a3fb39d490b64), the HTA file contains the same message as the HTML file. For the second HTML file (b87073c34a910f20a83c04c8efbd4f43), the HTA file contains a message similar to the first file but this time mentions an “Embassy of the Republic of Turkey”:\n\n Figure 2. The HTA b84c00ae9e7f9684b36d75a1a09f8210 message.\n\n Note the slight typos they made in this message at “transfered” (just like in the first HTML file) and “thes”.\n\n In both cases, the HTA file contains hidden HTML elements embedding the content of two different registry values. The first registry value carries a shellcode loader written in PowerShell dedicated to decode and load a shellcode, contained in the second registry value. Once the values are saved in the registry, the HTA launches a Powershell command line which will load and execute the content of the first registry key, as shown below:\n\n Extract 2. Extract of the HTA b84c00ae9e7f9684b36d75a1a09f8210.\n\n\n-----\n\n#### It is worth noting that prior to loading the shellcode, the registry keys containing the malicious payloads are deleted, a nice try to prevent forensic analysis. Furthermore, the registry key names differ in the two samples (Javasoft and MSOffice). In the two cases, the shellcode loads and executes in memory a DLL embedded in it. Both DLLs contain dozens of dead exports, are heavily obfuscated in the same manner with a lot of junk code and fake calls to the Windows API. They are used to decrypt and load an encrypted CS beacon splitted in seven different parts inside the DLL. To resume, they seem to act as the loader dubbed NativeZone (variant 1) as described by Microsoft in their blogpost⁶. To summarize, you can see below the full infection chain used in these recent spear phishing attacks:\n\n Figure 3. Infection chain of 3d18bc4bfe1ec7b6b73a3fb39d490b64.\n\n Both CobaltStrike configurations were extracted easily and can be found in the Appendix. It is interesting to note that the public keys and the user-agent are the same. Furthermore, the user-agent should not be used often in real corporate environments as it is associated with\n\n\n-----\n\n#### Windows 8 and you could therefore look for that on your networks for hunting purposes.\n\n Two different C2s have been extracted, midcitylanews[.]com for the sample targeting Iran and dom-news[.]com for the sample targeting Turkey.\n\n## Infrastructure analysis\n\n#### The domains midcitylanews[.]com and dom-news[.]com retrieved from the CobaltStrike beacons have been registered more than a year prior to their use by the threat actor which could indicate that NOBELIUM tried to prevent malicious domains detection based on their creation date.\n\n These domains resolved VPS IP addresses having their 80 and 443 ports open. They seem to have been configured by using an Nginx forwarder configuration for CobaltStrike C2 dubbed “cs2nginx” and available for anyone on Github⁹.\n\n However, even if the domains were registered a year ago, the associated C2 servers were set up around the end of september, 2021. Therefore, this time delta, the use of cs2nginx and the pattern of the typosquatting domains (e.g. the use on “news” keyword for many of them) can lead to some infrastructure illumination. Here is the infrastructure which can be grabbed by using this heuristic.\n\n Table 3. Infrastructure discovered possibly linked to NOBELIUM\n\n It is interesting to note that like the infrastructure disclosed by the CERT-FR in December, 2021¹⁰, this cluster is distributed between several autonomous systems, which seems also to be one characteristic of NOBELIUM.\n\n\n-----\n\n#### During this investigation, we found other C2s servers using the same technique and potentially linked to other threat actors or red teams. We decided to publish this list in the appendix for threat hunting purposes in your network.\n\n## Conclusion\n\n#### The infection chain and the indicators shown above suggest that NOBELIUM is associated with this attack campaign. After having burned EnvyScout against occidental targets, NOBELIUM seems to reuse this infection chain against other countries. However, due to the low complexity of the infection chain and the previous blog posts covering EnvyScout, it could be, although we write this with very low confidence, just another threat actor copycatting NOBELIUM.\n\n## External references\n\n#### ¹ Alert (AA21-148A) Sophisticated Spearphishing Campaign Targets Government Organizations, IGOs, and NGOs, CISA, May 28, 2021\n\n ² Further TTPs associated with SVR cyber actors, NCSC, May 7, 2021\n\n ³ FoggyWeb: Targeted NOBELIUM malware leads to persistent backdoor, Microsoft, September 27, 2021\n\n ⁴ SUNBURST Additional Technical Details, Mandian, December 24, 2020\n\n ⁵ Sunburst backdoor – code overlaps with Kazuar, Kaspersky, January 11, 2021\n\n ⁶ Breaking down NOBELIUM’s latest early-stage toolset, Microsoft, May 28, 2021\n\n ⁷ Mark of the Web, Microsoft, May 11, 2015\n\n ⁸ How we protect users from 0-day attacks, Google TAG, July 12, 2021\n\n ⁹ Cs2modrewrite’s source code on Github\n\n ¹⁰ Phishing campaigns by the Nobelium intrusion set, CERT-FR, December 6, 2021\n\n### Tactics, Techniques and Procedures (TTPs)\n\n#### T1583.001 – Acquire Infrastructure: Domains\n T1583.003 – Acquire Infrastructure: Virtual Private Server\n T1566.001 – Phishing: Spearphishing Attachment\n T1566.003 – Phishing: Spearphishing via Service\n T1059.001 – Command and Scripting Interpreter: PowerShell\n\n\n-----\n\n#### T1204.002 – User Execution: Malicious File T1027.006 – Obfuscated Files or Information: HTML Smuggling T1071.001 – Application Layer Protocol: Web Protocols\n\n### Related IOCs\n\n#### The IOCs are provided “as is”. All the IOCs can be downloaded in JSON STIX2.1 and CSV formats on the SEKOIA.IO Github: https://www.github.com/SEKOIA- IO/Community/tree/main/IOCs\n\n Domains\n```\ncrochetnews[.]com\ndom-news[.]com\nreadnewshot[.]com\npharaosjournal[.]com\nbfilmnews[.]com\ntheanalyticsnews[.]com\ngalatinonews[.]com\nmidcitylanews[.]com\nmuslimnewsdaily[.]com\n\n IP Addresses\n31.42.177[.]78\n158.255.211[.]40\n45.14.70[.]186\n46.102.152[.]118\n139.99.178[.]56\n95.183.51[.]161\n195.144.21[.]159\n103.232.53[.]230\n194.62.42[.]109\n\n Other domains suspected to use cs2nginx\n\n These domains are suspected to use cs2nginx. We haven’t been able to link them to NOBELIUM and they could be related to other threats. They are provided “as is”, only for hunting purposes in your own network.\n\n```\n\n-----\n\n```\nupdates.uk[.]com\nonlinebusinessadviceuk[.]com\nassets.completehealthcareuk[.]net\nd2rwiki[.]net\ntaiwancht[.]com\nherosofthestorms[.]com\nnote.legendsec[.]net\nfaststartbusiness[.]com\nmsdnsvc[.]com\nassets.bettendorfhealthcare[.]com\neblogpro[.]com\ngetdsoft[.]com\nthemobilecard[.]com\nc***solutions[.]support\nv*****managernent[.]com\ne*****x[.]me\nimg.microsoftupdate.cc \nwindows.msgetupdate.com \nfwd.splunk.eu.com \nfile.updateswindows.com\n\n#### Files MD5 hashes\n054940ba8908b9e11f57ee081d1140cb\nb84c00ae9e7f9684b36d75a1a09f8210\n3d18bc4bfe1ec7b6b73a3fb39d490b64\nb87073c34a910f20a83c04c8efbd4f43\nd4fdf63d88da2d59569bb621b18bf5e4\n41dd8cee47c036e7e9e92c395c5d1feb\nb7ca8c46dc1bfc1d9cb9ce04a4928153\ncc08a6df151b8879a4969b2e99086b48\n4365057ef0c5a9518d95d53eab5995a8\n\n### Yara rules\n\n```\n\n-----\n\n```\nrule apt_nobelium_powsershell_reg_loader_decoded {\n  meta:\n    id = “c8ee9c40-fa28-4b9a-98e8-88ccc4a16091“\n    description = “Matches the decoded version of the Powershell loader stored in\nthe registry“\n    version = “1.0“\n    creation_date = “2021-12-07“\n    modification_date = “2021-12-07“\n    classification = “TLP:WHITE“\n    source=“SEKOIA“\n  strings:\n    $x = “FromBase64String((gp HKCU:\\\\\\\\SOFTWARE\\\\\\\\“\n    $y = “Remove-ItemProperty HKCU:\\\\\\\\SOFTWARE\\\\\\\\“\n    $z = “Invoke([IntPtr]::Zero)“\n  condition:\n    filesize < 3KB and\n    $x and #y == 2 and\n    $z at (filesize-22)\n}\nrule apt_nobelium_hta_reg_dropper {\n  meta:\n    id = “9f6a2154-c33a-4c38-9667-7479bf49c310“\n    description = “Matches HTA dropper file used by NOBELIUM and ISO files\ncontaining it“\n    hash = “054940ba8908b9e11f57ee081d1140cb“\n    hash = “b7ca8c46dc1bfc1d9cb9ce04a4928153“\n    version = “1.0“\n    creation_date = “2021-12-07” \n    modification_date = “2021-12-07“\n    classification = “TLP:WHITE“\n    source=“SEKOIA“\n  strings:\n    $w = “RegWrite(“ nocase\n    $x = { 2b 3d 20 64 6f 63 75 6d\n          65 6e 74 2e 67 65 74 45\n          6c 65 6d 65 6e 74 42 79\n          49 64 28 22 [0-4] 22 29\n          2e 69 6e 6e 65 72 48 54\n          4d 4c }\n    $y = “<body onload=“ nocase\n    $z = “hidden“ nocase\n  condition:\n    $y and\n    (3 < #z) and\n    (3 < #x) and\n    (1 < #w)\n}\nrule apt_nobelium_hta_in_iso {\n   meta:\n     id = “874ab41b-5c60-4303-8776-e1c10313a401“\n    description = “Matches ISO file embedding HTA“\n\n```\n\n-----\n\n```\n    hash d4fdf63d88da2d59569bb621b18bf5e4 \n    hash = “cc08a6df151b8879a4969b2e99086b48“\n    version = “1.0“\n    creation_date = “2021-12-02” \n    modification_date = “2021-12-02“\n    classification = “TLP:WHITE“\n    source=“SEKOIA“\n  strings:\n    $ = “ImgBurn v2“\n    $ = “<hta:application“\n  condition:\n    all of them and\n    filesize > 1MB and\n    filesize < 3MB \n}\nrule apt_nobelium_html_smuggling_iso {\n  meta:\n    id = “9bd5b626-8ea3-4607-a858-58deff18396c“\n    version = “1.0“\n    description = “Detect HTML smuggling with ISO“\n    hash = “b87073c34a910f20a83c04c8efbd4f43” \n    hash = “3d18bc4bfe1ec7b6b73a3fb39d490b64“\n    source = “SEKOIA“\n    creation_date = “2022-01-02” \n    modification_date = “2022-01-02“\n    classification = “TLP:WHITE“\n  strings:\n    $ = “new Blob“\n    $ = “.click();“\n    $ = { 28 [1-20] 2c 22 [1-20]\n         2e 69 73 6f 22 2c 22 61\n         70 70 6c 69 63 61 74 69\n         6f 6e 2f 78 2d 63 64 2d\n         69 6d 61 67 65 22 29 }\n  condition:\n    filesize > 1MB and filesize < 2MB and all of them\n}\nrule apt_nobelium_b64_to_Uint8Array {\n  meta:\n    id = “66c9b00b-f021-4115-b9ec-d1e1f491ce72“\n    description = “Detect Base64 decode to Uint8Array used in NOBELIUM HTML\nfiles“\n    hash = “3d18bc4bfe1ec7b6b73a3fb39d490b64“\n    version = “1.0“\n    creation_date = “2021-12-02” \n    modification_date = “2021-12-02“\n    classification = “TLP:WHITE“\n    source=“SEKOIA“\n  strings:\n    $a1 = “atob(“\n    $l0 = { 20 3c 20 [2-10] 2e 6c 65 6e 67 74 68 3b 20 69 2b 2b 29 7b }\n\n```\n\n-----\n\n```\n    $l1 { 5b 69 5d 20 3d 20 [2 10] 2e 63 68 61 72 43 6f 64 65 41 74 28 69 29 3b\n}\n    $a2 = “new Uint8Array“\n  condition:\n    $l0 in (@a1..@a2) and\n    $l1 in (@a1..@a2) and\n    filesize > 1MB and filesize < 3MB \n}\nimport “pe“\nrule apt_nobelium_cs_loader_obfuscation {\n  meta:\n    id = “5f21b031-3dc1-4dad-b775-6099bfcb0472“\n    version = “1.0“\n    description = “Detect obfuscated CobaltStrike loaders used by NOBELIUM”  \n    hash = “41dd8cee47c036e7e9e92c395c5d1feb“\n    hash = “4365057ef0c5a9518d95d53eab5995a8“\n    source = “SEKOIA“\n    creation_date = “2022-01-04“\n    modification_date = “2022-01-04“\n    classification = “TLP:WHITE“\n  strings:\n    $j1 = { DD 05 ?? ?? ?? ?? DD 9D }\n    $j2 = { C7 85 ?? ?? ?? ?? ?? ?? ?? ?? C7 85 }\n    $c1 = { 81 7D ?? FF 00 00 00 0F 8E ?? ?? FF FF }\n  condition:\n    pe.characteristics & pe.DLL and\n    pe.number_of_exports > 20 and\n    filesize > 300KB and filesize < 400KB and\n    #j1 > 50 and #j2 > 50 and #c1 == 2\n }\n\n### Sigma rule\n\n```\n\n-----\n\n```\nid: d9114938 6877 48d8 a785 bc07cb7220ff\ntitle: PowerShell invoking in the command line a registry value to execute.\ndescription: Detects a d9114938 execution which grabs a value in the windows registry\nto execute it.\nreferences:\n  – MD5 hash: b84c00ae9e7f9684b36d75a1a09f8210\n  – MD5 hash: 054940ba8908b9e11f57ee081d1140cb\nstatus: experimental\nauthor: ‘SEKOIA.IO’\ndate: 2022/01/03\ntags:\n  – attack.T1059.001\nlogsource:\n  category: process_creation\n  product: windows\ndetection:\n  selection:\n    Image|contains: ‘powershell’\n    CommandLine|contains: ‘HKCU’\n  selection2\n    CommandLine|contains:\n      – ‘invoke-expression’\n      – ‘iex’\n    CommandLine|contains:\n      – ‘gp’\n      – ‘Get-ItemProperty’\n  condition: selection and selection2\nlevel: medium\n\n### Registry Keys\nHKCU\\SOFTWARE\\MSOffice\\Version\nHKCU\\SOFTWARE\\MSOffice\\path\nHKCU\\SOFTWARE\\JavaSoft\\Ver\nHKCU\\SOFTWARE\\JavaSoft\\Ver2\n\n CobaltStrike configurations\n\n```\n\n-----\n\n```\nConfiguration of the CobaltStrike beacon launched from the Iranian decoy (from\n1768.py, Didier Stevens’ tool):\nConfig found: xorkey b’.’ 0x00000000 0x000041f0\n0x0001 payload type           0x0001 0x0002 8 windows-beacon_httpsreverse_https\n0x0002 port               0x0001 0x0002 443\n0x0003 sleeptime            0x0002 0x0004 60000\n0x0004 maxgetsize            0x0002 0x0004 1398104\n0x0005 jitter              0x0001 0x0002 30\n0x0007 publickey            0x0003 0x0100\n30819f300d06092a864886f70d010101050003818d0030818902818100a6be0ed930ab8ecb86facd6419bb\n0x0008 server,get-uri          0x0003 0x0100\n‘midcitylanews.com,/news/update/aaa’\n0x000e SpawnTo             0x0003 0x0010 (NULL …)\n0x001d spawnto_x86           0x0003 0x0040\n‘%windir%\\\\syswow64\\\\dllhost.exe’\n0x001e spawnto_x64           0x0003 0x0040\n‘%windir%\\\\sysnative\\\\dllhost.exe’\n0x001f CryptoScheme           0x0001 0x0002 0\n0x001a get-verb             0x0003 0x0010 ‘GET’\n0x001b post-verb            0x0003 0x0010 ‘POST’\n0x001c HttpPostChunk          0x0002 0x0004 0\n0x0025 license-id            0x0002 0x0004 1359593325\n0x0026 bStageCleanup          0x0001 0x0002 0\n0x0027 bCFGCaution           0x0001 0x0002 0\n0x0009 useragent            0x0003 0x0100 ‘Mozilla/5.0 (Windows NT 6.2)\nAppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.85 Safari/537.36’\n0x000a post-uri             0x0003 0x0040 ‘/form/sent/ppw’\n0x000b Malleable_C2_Instructions    0x0003 0x0100\n‘\\x00\\x00\\x00\\x04\\x00\\x00\\x00\\x03’\n0x000c http_get_header         0x0003 0x0200\n  Content-Type: text/html\n  Cache-Control: no-cache\n  v1.5472\n0x000d http_post_header         0x0003 0x0200\n  !Content-Type: multipart/form-data\n  Cache-Control: no-cache\n  /.jpg\n0x0036 HostHeader            0x0003 0x0080 (NULL …)\n0x0032 UsesCookies           0x0001 0x0002 0\n0x0023 proxy_type            0x0001 0x0002 2 IE settings\n0x003a                 0x0003 0x0080 ‘\\x00\\x05\\x90’\n0x0039                 0x0003 0x0080 ‘\\x00\\x05p’\n0x0037                 0x0001 0x0002 0\n0x0028 killdate             0x0002 0x0004 0\n0x0029 textSectionEnd          0x0002 0x0004 0\n0x002b process-inject-start-rwx     0x0001 0x0002 4 PAGE_READWRITE\n0x002c process-inject-use-rwx      0x0001 0x0002 32 PAGE_EXECUTE_READ\n0x002d process-inject-min_alloc     0x0002 0x0004 17500\n0x002e process-inject-transform-x86   0x0003 0x0100 ‘\\x00\\x00\\x00\\x02\\x90\\x90’\n0x002f process-inject-transform-x64   0x0003 0x0100 ‘\\x00\\x00\\x00\\x02\\x90\\x90’\n0x0035 process-inject-stub       0x0003 0x0010 ‘\\x0câõTDäy5\\x16µ¯ég¾\\x92U’\n0x0033 process-inject-execute      0x0003 0x0080\n\n```\n\n-----\n\n```\n \\x06\\x00&\\x00\\x00\\x00\\x06ntdll\\x00\\x00\\x00\\x00\\x13RtlUserThreadStart\\x00\\x01\\x08\\x07\\\n0x0034 process-inject-allocation-method 0x0001 0x0002 1\n0x0000\nGuessing Cobalt Strike version: 4.1+ (max 0x003a)\n Configuration of the CobaltStrike beacon launched from the Turkish decoy (from\n1768.py, Didier Stevens’ tool):\n Config found: xorkey b’.’ 0x00000000 0x0000bff0\n0x0001 payload type         0x0001 0x0002 8 windows-beacon_httpsreverse_https\n0x0002 port             0x0001 0x0002 443\n0x0003 sleeptime          0x0002 0x0004 60000\n0x0004 maxgetsize          0x0002 0x0004 1398104\n0x0005 jitter            0x0001 0x0002 30\n0x0007 publickey          0x0003 0x0100\n30819f300d06092a864886f70d010101050003818d0030818902818100a6be0ed930ab8ecb86facd6419bb\n0x0008 server,get-uri        0x0003 0x0100 ‘dom-news.com,/info/www/robot’\n0x000e SpawnTo           0x0003 0x0010 (NULL …)\n0x001d spawnto_x86         0x0003 0x0040 ‘%windir%\\\\syswow64\\\\dllhost.exe’\n0x001e spawnto_x64         0x0003 0x0040 ‘%windir%\\\\sysnative\\\\dllhost.exe’\n0x001f CryptoScheme         0x0001 0x0002 0\n0x001a get-verb           0x0003 0x0010 ‘GET’\n0x001b post-verb          0x0003 0x0010 ‘POST’\n0x001c HttpPostChunk        0x0002 0x0004 0\n0x0025 license-id          0x0002 0x0004 1359593325\n0x0026 bStageCleanup        0x0001 0x0002 0\n0x0027 bCFGCaution         0x0001 0x0002 0\n0x0009 useragent          0x0003 0x0100 ‘Mozilla/5.0 (Windows NT 6.2)\nAppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.85 Safari/537.36’\n0x000a post-uri           0x0003 0x0040 ‘/assets/image/awd’\n0x000b Malleable_C2_Instructions  0x0003 0x0100 ‘\\x00\\x00\\x00\\x04\\x00\\x00\\x00\\x03’\n0x000c http_get_header       0x0003 0x0200\n  Content-Type: text/html\n  Cache-Control: no-cache\n  .html\n  Cookie\n0x000d http_post_header       0x0003 0x0200\n  Content-Type: image/jpeg\n  Accept-Encoding: gzip, deflate\n  Cache-Control: no-cache\n  /.png\n0x0036 HostHeader          0x0003 0x0080 (NULL …)\n0x0032 UsesCookies         0x0001 0x0002 1\n0x0023 proxy_type          0x0001 0x0002 2 IE settings\n0x003a               0x0003 0x0080 ‘\\x00\\x05\\x90’\n0x0039               0x0003 0x0080 ‘\\x00\\x05p’\n0x0037               0x0001 0x0002 0\n0x0028 killdate           0x0002 0x0004 0\n0x0029 textSectionEnd        0x0002 0x0004 0\n0x002b process-inject-start-rwx   0x0001 0x0002 4 PAGE_READWRITE\n0x002c process-inject-use-rwx    0x0001 0x0002 32 PAGE_EXECUTE_READ\n0x002d process-inject-min_alloc   0x0002 0x0004 17500\n\n```\n\n-----\n\n```\n0x002e process inject transform x86 0x0003 0x0100 \\x00\\x00\\x00\\x02\\x90\\x90 \n0x002f process-inject-transform-x64 0x0003 0x0100 ‘\\x00\\x00\\x00\\x02\\x90\\x90’\n0x0035 process-inject-stub     0x0003 0x0010 ‘\\x0câõTDäy5\\x16µ¯ég¾\\x92U’\n0x0033 process-inject-execute    0x0003 0x0080\n‘\\x06\\x00&\\x00\\x00\\x00\\x06ntdll\\x00\\x00\\x00\\x00\\x13RtlUserThreadStart\\x00\\x01\\x08\\x07\\\n0x0034 process-inject-allocation-method 0x0001 0x0002 1\n0x0000\nGuessing Cobalt Strike version: 4.1+ (max 0x003a)\n\n## Chat with our team!\n\n#### Would you like to know more about our solutions? Do you want to discover our XDR and CTI products? Do you have a cybersecurity project in your organization? Make an appointment and meet us!\n\n Contact us\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-06 - NOBELIUM’s EnvyScout infection chain goes in the registry, targeting embassies.pdf"
    ],
    "report_names": [
        "2022-01-06 - NOBELIUM’s EnvyScout infection chain goes in the registry, targeting embassies.pdf"
    ],
    "threat_actors": [
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535555,
    "ts_updated_at": 1743041795,
    "ts_creation_date": 1653765804,
    "ts_modification_date": 1653765804,
    "files": {
        "pdf": "https://archive.orkl.eu/339ab160338390b53eaf292bc4598740364aab18.pdf",
        "text": "https://archive.orkl.eu/339ab160338390b53eaf292bc4598740364aab18.txt",
        "img": "https://archive.orkl.eu/339ab160338390b53eaf292bc4598740364aab18.jpg"
    }
}