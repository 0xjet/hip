{
    "id": "b3ff11c9-e825-4b15-95c0-c47c564c1326",
    "created_at": "2023-01-12T15:05:49.038422Z",
    "updated_at": "2025-03-27T02:05:20.395147Z",
    "deleted_at": null,
    "sha1_hash": "ca71aece26ccf55e3e1040316ba0ccff0863c8c2",
    "title": "2017-09-07 - EMOTET Returns, Starts Spreading via Spam Botnet",
    "authors": "",
    "file_creation_date": "2022-05-28T05:03:02Z",
    "file_modification_date": "2022-05-28T05:03:02Z",
    "file_size": 219609,
    "plain_text": "# EMOTET Returns, Starts Spreading via Spam Botnet\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/emotet-returns-starts-spreading-via-spam-botnet/](http://blog.trendmicro.com/trendlabs-security-intelligence/emotet-returns-starts-spreading-via-spam-botnet/)**\n\nSeptember 7, 2017\n\nMalware\n\nEMOTET is making a comeback with increased activity from new variants that have the\npotential to unleash different types of payloads in the affected system.\n\nBy: Don Ovid Ladores September 07, 2017 Read time: ( words)\n\n[We first detected the banking malware EMOTET back in 2014, we looked into the banking](http://blog.trendmicro.com/trendlabs-security-intelligence/new-banking-malware-uses-network-sniffing-for-data-theft/)\nmalware’s routines and behaviors and took note of its information stealing abilities via\nnetwork sniffing. In August, we found increased activity coming from new variants (Detected\n[by Trend Micro as TSPY_EMOTET.AUSJLA,](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/TSPY_EMOTET.AUSJLA) [TSPY_EMOTET.SMD3,](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/TSPY_EMOTET.SMD3)\n[TSPY_EMOTET.AUSJKW,](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/TSPY_EMOTET.AUSJKW) [TSPY_EMOTET.AUSJKV) that have the potential to unleash](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/TSPY_EMOTET.AUSJKV)\ndifferent types of payloads in the affected system.\n\n**_A Resurgent Malware_**\n\nWhile the motivation behind EMOTET—information theft—remain the same, the reason as to\n_why the malware resurfaced could be mainly attributed to two main possible reasons._\n\nFirst, the authors behind this attack may be targeting new regions and industries.\n\n\n-----\n\nWhile the earlier variants of EMOTET primarily targeted the banking sector, our Smart\nProtection Network (SPN) data reveals that this time, the malware isn’t being picky about the\nindustries it chooses to attack. The affected companies come from different industries,\nincluding manufacturing, food and beverage, and healthcare. Again, it is possible that due to\nthe nature of its distribution, EMOTET now has a wider scope.\n\nThe United States, United Kingdom, and Canada made up the bulk of the target regions, with\nthe US taking up 58% of all our detected infections, while Great Britain and Canada were at\n12% and 8% respectively.\n\n_Figure 1: Regional Distribution of the EMOTET attacks from June 6 to September 6, 2017_\n\nSecond, these new variants use multiple ways to spread. Its primary propagation method\ninvolves the use of a spam botnet, which results in its rapid distribution via email. EMOTET\ncan also spread via a network propagation module that brute forces its way into an account\ndomain using a dictionary attack. EMOTET’s use of compromised URLs as C&C servers\nlikely helped it spread as well.\n\nThe element of surprise could also have played a role in its effectiveness: due to its recent\ninactivity, EMOTET’s resurgence managed to catch its targets off-guard, making the attacks,\nnew capabilities, and distribution more effective.\n\nFor a malware with email-spamming and lateral-movement capabilities, infecting business\nsystems and acquiring corporate e-mails translates to larger and more effective spam\ntargeting and a higher chance of gaining information.\n\n_Figure 2: EMOTET Infection Diagram for the recent wave of attacks_\n\n**_Arrival and Installation_**\n\nThe new EMOTET variants initially arrive as spam claiming to be an invoice or payment\nnotification to trick its victims into believing that this is a legitimate email from a supplier.\n\n_Figure 3: Sample spam email_\n\nIn the body of this email is a malicious URL that will download a document containing a\nmalicious macro when a user clicks on it. This macro will then execute a PowerShell\ncommand line that is responsible for downloading EMOTET.\n\nHere are some of the sample URLs we discovered:\n\n\n-----\n\n_hxxp://abbeykurtz[.]com/VZZQNZJIZD9113942_\n_hxxp://aplacetogrowtherapy[.]com/CNNKIAPGEP3572621_\n_hxxp://vanguardatlantic[.]com/Invoice-number-7121315833-issue/_\n_hxxp://charly-bass[.]de/Copy-Invoice-0954/_\n\nOnce downloaded, EMOTET drops and executes copies of itself into the following folders:\n\nIf EMOTET has no admin privileges, it will drop the copies into\n_%AppDataLocal%\\Microsoft\\Windows\\{string 1}{string 2}.exe_\nIf EMOTET contains admin privileges, it will instead drop the copies into System%\\\n_{string 1}{string 2}.exe_\n\nThe malware will attempt to ease its entry into the system by deleting the Zone Identifier\nAlternate Data Stream (ADS), which is a string of information that describes the Internet\nExplorer Trust Settings of the file's download source. This is one way for the system to find\nout if a downloaded file is from a high-risk source, blocking the download if it is detected as\nsuch.\n\nEMOTET will then register itself as a system service and adds registry entries to ensure that\nit is automatically executed at every system startup. The typical windows service acts as a\n“controller” for most hardware-based applications, while others are used to control other\napplications. The EMOTET malware, on the other hand, uses it for both Elevation of\nPrivilege, and as an autostart mechanism.\n\n**_Routines_**\n\nEMOTET will list the system’s currently running processes and then proceed to gather\ninformation on both the system itself and the operating system used.\n\nIt will then connect to the Command & Control (C&C) servers to update to its latest version,\nas well as to determine the type of payload that it will deliver. One of the possible payloads is\n[the persistent banking trojan known as DRIDEX, which attempts to harvest banking account](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/3147/dealing-with-the-mess-of-dridex)\ninformation via browser monitoring routines. Furthermore, the malware can also turn the\ninfected system into part of a botnet that sends spam emails intended to spread the malware\neven further. This allows the trojan to spread quickly, as the more systems it can potentially\ninfect, the faster it will propagate. The malware is also capable of harvesting email\ninformation and stealing username and password information found in installed browsers.\n\nWe discovered that in addition to the above payloads, the C&C server is responsible for\nsending modules that will perform the following routines, which includes:\n\nSPAMMING Module\nNetwork Worm Module\nMail Password Viewer\nWeb Browser Password Viewer\n\n\n-----\n\nFrom our recent samples of EMOTET malware, we have observed that it has become a\nLoader Trojan that decrypts and loads any binary coming from its Command & Control (C&C)\nserver.\n\n**_Trend Micro Solutions_**\n\nAddressing threats such as EMOTET need a multilayered and proactive approach to security\n—from the [gateway,](http://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) [endpoints,](http://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) [networks, and](http://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection.html) [servers. Trend Micro endpoint solutions such](http://blog.trendmicro.com/en_us/business/products/hybrid-cloud.html)\nas [Trend Micro™ Smart Protection Suites and](http://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) [Worry-Free™ Business Security can protect](http://blog.trendmicro.com/en_us/small-business/worry-free-services-suites.html)\nusers and businesses from these threats by detecting malicious files, and spammed\n[messages as well as blocking all related malicious URLs. Trend Micro Deep Discovery™ has](http://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection.html)\nan email inspection layer that can protect enterprises by detecting malicious attachment and\nURLs.\n\n[Trend Micro™ Hosted Email Security is a no-maintenance cloud solution that delivers](http://blog.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/email-security.html)\ncontinuously updated protection to stop spam, malware, spear phishing, ransomware, and\nadvanced targeted attacks before they reach the network. It protects Microsoft\nExchange, [Microsoft Office 365, Google Apps, and other hosted and on-premises email](http://blog.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/cloud-app-security.html)\nsolutions.\n\n[Trend Micro™ OfficeScan™ with](http://blog.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html) [XGen™ endpoint security infuses high-fidelity machine](http://www.trendmicro.com/us/business/xgen/index.html)\nlearning with other detection technologies and global threat intelligence for comprehensive\nprotection against advanced malware.\n\nThe list of SHA256 is in this [appendix.](https://documents.trendmicro.com/assets/Appendix_EMOTET-Returns-Starts-Spreading-via-Spam-Botnet.pdf)\n\nTags\n\n[Malware |](http://blog.trendmicro.com/en_us/research.html?category=trend-micro-research:threats/malware) [Endpoints |](http://blog.trendmicro.com/en_us/research.html?category=trend-micro-research:environments/endpoints) [Research](http://blog.trendmicro.com/en_us/research.html?category=trend-micro-research:article-type/research)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-09-07 - EMOTET Returns, Starts Spreading via Spam Botnet.pdf"
    ],
    "report_names": [
        "2017-09-07 - EMOTET Returns, Starts Spreading via Spam Botnet.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535949,
    "ts_updated_at": 1743041120,
    "ts_creation_date": 1653714182,
    "ts_modification_date": 1653714182,
    "files": {
        "pdf": "https://archive.orkl.eu/ca71aece26ccf55e3e1040316ba0ccff0863c8c2.pdf",
        "text": "https://archive.orkl.eu/ca71aece26ccf55e3e1040316ba0ccff0863c8c2.txt",
        "img": "https://archive.orkl.eu/ca71aece26ccf55e3e1040316ba0ccff0863c8c2.jpg"
    }
}