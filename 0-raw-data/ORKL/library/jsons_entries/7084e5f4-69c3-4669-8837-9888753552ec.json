{
    "id": "7084e5f4-69c3-4669-8837-9888753552ec",
    "created_at": "2023-01-12T15:10:45.805761Z",
    "updated_at": "2025-03-27T02:15:35.778867Z",
    "deleted_at": null,
    "sha1_hash": "d0b23b34a8315a14c6b89bfd23156dc371a871d5",
    "title": "2020-08-14 - PurpleWave - A New Infostealer from Russia",
    "authors": "",
    "file_creation_date": "2022-05-28T19:00:50Z",
    "file_modification_date": "2022-05-28T19:00:50Z",
    "file_size": 3168729,
    "plain_text": "# PurpleWave—A New Infostealer from Russia\n\n**[zscaler.com/blogs/research/purplewave-new-infostealer-russia](https://www.zscaler.com/blogs/research/purplewave-new-infostealer-russia)**\n\nInfostealer is one of the most profitable tools for cybercriminals, as information gathered\nfrom systems infected with this malware could be sold in the cybercrime underground or\nused for credential stuffing attacks. The Zscaler ThreatLabZ team came across a new\nInfostealer called PurpleWave, which is written in C++ and silently installs itself onto a\nuser’s system. It connects to a command and control (C&C) server to send system\ninformation and installs new malware onto the infected system.\n\nThe author of this malware is advertising and selling PurpleWave stealer on Russian\ncybercrime forums for 5,000 RUB (US$68) with lifetime updates and 4,000 RUB (US$54)\nwith only two updates.\n\n\n-----\n\n_Figure 1: A PurpleWave selling post on a Russian forum._\n\nThe author selling PurpleWave claims that this stealer is capable of stealing passwords,\ncookies, cards, and autofill forms of Chromium and Mozilla browsers. This stealer also\ncollects files from the specified path, takes screenshots, and installs additional modules.\n\nThe capabilities of the PurpleWave stealer include:\n\nStealing passwords, cookies, cards, autofill(s) data, browser history from Chromium\nand Mozilla.\nCollecting files from the specified path\nCapturing the screen\nStealing system information\nStealing Telegram session files\nStealing Steam application data\nStealing Electrum wallet data\nLoading and executing additional module/malware\n\n\n-----\n\n_Figure 2: The PurpleWave login panel._\n\nThe author also built a dashboard where the attacker can keep an eye on the infection\ncounts according to dates, access the stolen logs of infected machines, and change the\nmalware configuration settings.\n\n_Figure 3: The PurpleWave infection dashboard._\n\nThe dashboard also provides the attacker with the ability to customize the configuration of\nthe PurpleWave stealer.\n\n\n-----\n\n_Figure 4: The dashboard for customizing the PurpleWave configuration._\n\n**Technical analysis**\n\nUpon execution of the PurpleWave binary, it gives a fake error message in the Russian\nlanguage that can be customized by the attacker in their panel. But in the background, it\nperforms all of its malicious activities.\n\n_Figure 5: The fake error message in Russian. (It translates to: Memory control blocks_\n_damaged.)_\n\nThe name of the stealer (PurpleWave) and the version (1.0) are hardcoded and encrypted\nin the binary. Most of the strings in the binary are encrypted, but they get decrypted on\nruntime with the help of the decryption loop present in the binary (shown in Figure 6).\n\n\n-----\n\n_Figure 6: The common decryption function for the encrypted strings in the binary._\n\nThe PurpleWave binary creates a mutex with the name “MutexCantRepeatThis” to avoid\nmultiple executions of malware instances. After that, it sends the HTTP POST request with\nthe custom header and body to the C&C URL to get the configuration data.\n\n_Figure 7: Sending request to the C&C server to get the config data._\n\nIt creates an HTTP request header with content type as “form-data”. The boundary is\nassigned with “boundaryaswell” to act as a marker and user agent is set with “app”. It\ncreates a request body with a form name as “id” and the value assigned to it is 1.\n\n\n-----\n\n_Figure 8: The configuration request with the custom header and body._\n\nThe received data contains the customized configuration, which may change per the binary.\nWe have observed three different configurations and different hosts of the PurpleWave\nbinaries.\n\n_Figure 9: The configuration from different PurpleWave binaries._\n\ndirs - It consists of directory information from which files to be collected.\n\nfake - It has the fake alert message to be shown to the user on execution.\n\nloaders - It consists of an additional module name to be installed on the infected system.\n\nFor Config-2, PurpleWave will traverse path “%userprofile%/Desktop” and collect the files\nhaving extensions txt, doc and docx. In Config-3, it will not collect any files but it has a\nmodule named “Kv2TDW4O” in the loaders, which will get downloaded and executed on the\nsystem.\n\n\n-----\n\n**Installing additional modules**\n\nFor installing additional modules mentioned in the received configuration (Config-3),\nPurpleWave again creates an HTTP POST request with the same headers mentioned in the\nprevious request to the C&C host followed by “/loader/module_name”.\n\n_Figure 10: The request to download an additional module._\n\nPurpleWave enumerates the loaders list from a JSON configuration, downloads the module\nname from the C&C server and stores it in %appdata% directory, then executes it.\n\n\n-----\n\n_Figure 11: Downloading and executing additional modules._\n\nThe downloaded module that we observed in some PurpleWave binary is the Electrum\nwallet stealer, which is written in .NET and capable of stealing Electrum wallet data from the\ninfected system.\n\n\n-----\n\n_Figure 12: Collecting Electrum wallet data._\n\n**Data stealing**\n\nPurpleWave is capable of stealing credentials, autofills data, card data, cookies, and\nbrowser history from Chromium and Mozilla.\n\nFor Chromium browsers, it fetches the login credentials from “\\%AppData%\\Local\\\n{Browser}\\User Data\\Default\\Login Data”, cookies from “\\%AppData%\\Local\\{Browser}\\User\nData\\Default\\Cookies”, and other information, such as autofills data, card data, and browser\nhistory, from “\\%AppData%\\Local\\{Browser}\\User Data\\Default\\Web Data”.\n\n\n-----\n\n_Figure 13: Stealing browser data._\n\nThe stolen browser info is collected in the form of a form-data field with the names shown\nbelow followed by their value.\n\nUsername - browser[BrowserName][passwords][index][login]\n\n\n-----\n\nPassword - browser[BrowserName][passwords][index][password]\n\n_Figure 14: Stolen browser information._\n\nAlong with the browser’s data, the stealer captures the current screen and appends it to the\nbrowser's stolen data in the form-data with the filename as “screenshot.png”.\n\n\n-----\n\n_Figure 15: A captured screenshot._\n\nAfter that, it collects all the information about infected systems, such as operating system,\nCPU info, GPU info, machine GUID, username, machine name, and more.\n\n\n-----\n\n_Figure 16: The system information collected by PurpleWave._\n\nThe stealer also collects the SSFN files from the Steam application. The Steam application\nis used for playing, discussing, and creating games. The SSFN file exists to verify the users\neach time they login to their Steam account. It fetches the Steam path from the registry\n“Software\\\\Valve\\\\Steam” and reads all the SSFN files stored into the config directory.\n\nPurpleWave also steals session-related files from the Telegram application. It reads the\nvalue of the default key in the system registry branch\n“HKCU\\Software\\Classes\\tdesktop.tg\\DefaultIcon” to obtain a path of Telegram and collects\nall the files starts with “map” in the “D877F783D5D3EF8C” directory.\n\n\n-----\n\n_Figure 17: Collecting Steam and Telegram data._\n\nPurpleWave merges all the collected file data, browser data, screenshots, Steam data,\nTelegram data, and system info, then sends it to a C&C server using an HTTP POST\nrequest.\n\n_Figure 18: Sending stolen data to C&C server_\n\n**Coverage**\n\nThe observed indicators in this attack were successfully blocked by the Zscaler Cloud\nSandbox.\n\n\n-----\n\n_Figure 19: The Zscaler Cloud Sandbox report for PurpleWave._\n\nIn addition to sandbox detections, Zscaler’s multilayered cloud security platform detects\nindicators at various levels. The following advanced threat protection signatures have been\nreleased for detecting the malware:\n\n[Win32.PWS.PurpleWave](https://threatlibrary.zscaler.com/?keyword=Win32.PWS.PurpleWave)\n\n**Conclusion**\n\nZscaler believes that PurpleWave represents an active and ongoing threat, as\nthe C&C servers are still alive and responding as of this writing. The malware also still\nappears to be available for purchase on the black market. PurpleWave has incredible\npotential to steal sensitive information. The malware is in the early stages of development,\nwith the author likely to enhance its stealing capabilities and add more features. We will\ncontinue to keep track of this threat to ensure coverage.\n\n**[MITRE ATT&CK™ tactic and technique mapping](https://attack.mitre.org/)**\n\n**Tactic** **Technique**\n\nT1083          File and directory discovery\n\nT1082          System information discovery\n\nT1033          System user discovery\n\nT1124          System time discovery\n\nT1016          System network configuration discovery\n\nT1020          Automated exfiltration\n\nT1041          Exfiltration over C&C channel\n\nT1071          Uses web protocols\n\n\n-----\n\nT1105          Downloads additional files\nT1555          Credentials from web browsers\nT1539          Steal web session cookies\nT1005          Data from local system\nT1113          Screen capture\n\n**Indicators of Compromise (IOCs)**\n\n**Hashes**\nB18BCB300AE480B16A0E0B9110E1C06C\nD8A36DCE73E91780B52B6F387C5CFD78\n9E4D3F4439ED39C01F3346FBDB7488AE\n657C3DDAFF433067C7F74F3453C7EB37\nE770544551F94296B9A867E42435206F\nE23DED17CDF532790F708E8A550969EB\nBC693652D5F57E792551C3A62049BA0B\nB5FB35BE12C66F16F55AF2C2ABC77E55\nAD24A6614C528DE81283FE4A618682C7\nAC17A56355914E231B2AD52E45D6F779\n7A728F42940F5BCB50AC9A5C57C1D361\n53BC8E68A9028C58941B78E4AD867B83\n394298EED78D455416E1E4CF0DEB4802\n30898909FD4BF93FE23C62E6962BED11\n02350FFA6B82CD2079797ED4BA1DD240\n0212EB9562992DA05AB28EFFB9D64D8A\n01C8D886BD213F983D0FD5AD35D78A9A\n\n**URLs**\nsh1213709[.]a[.]had[.]su/config\nsh1213709[.]a[.]had[.]su/gate\nsh1213709[.]a[.]had[.]su/loader/Kv2TDW4O\nsh1213709[.]a[.]had[.]su/loader/9ZNzBRpT\nsh1213709[.]a[.]had[.]su/loader/Ds5UabYT\nsh1213709[.]a[.]had[.]su/loader/MTIQK8lV\nmanget6z[.]beget[.]tech/config\nmanget6z[.]beget[.]tech/gate\nec2-3-134-252-78[.]us-east-2[.]compute[.]amazonaws[.]com/config\nec2-3-134-252-78[.]us-east-2[.]compute[.]amazonaws[.]com/gate\nbibaiboba[.]beget[.]tech/config\nbibaiboba[.]beget[.]tech/gate\nsumakokl[.]beget[.]tech/config\nsumakokl[.]beget[.]tech/gate\nikaschyn[.]beget[.]tech/config\n\n\n-----\n\nikaschyn[.]beget[.]tech/gate\nh98801x4[.]beget[.]tech/config\nh98801x4[.]beget[.]tech/gate\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-08-14 - PurpleWave - A New Infostealer from Russia.pdf"
    ],
    "report_names": [
        "2020-08-14 - PurpleWave - A New Infostealer from Russia.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536245,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1653764450,
    "ts_modification_date": 1653764450,
    "files": {
        "pdf": "https://archive.orkl.eu/d0b23b34a8315a14c6b89bfd23156dc371a871d5.pdf",
        "text": "https://archive.orkl.eu/d0b23b34a8315a14c6b89bfd23156dc371a871d5.txt",
        "img": "https://archive.orkl.eu/d0b23b34a8315a14c6b89bfd23156dc371a871d5.jpg"
    }
}