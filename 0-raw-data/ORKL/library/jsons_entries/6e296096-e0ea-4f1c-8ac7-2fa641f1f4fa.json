{
    "id": "6e296096-e0ea-4f1c-8ac7-2fa641f1f4fa",
    "created_at": "2023-01-12T15:05:23.36915Z",
    "updated_at": "2025-03-27T02:05:20.423365Z",
    "deleted_at": null,
    "sha1_hash": "1a0ee405cf5cdd8caaf6f8160e72039edd327444",
    "title": "2011-04-28 - Un observateur d’événements aveugle…",
    "authors": "",
    "file_creation_date": "2022-05-28T03:58:06Z",
    "file_modification_date": "2022-05-28T03:58:06Z",
    "file_size": 177051,
    "plain_text": "# Un observateur d’événements aveugle…\n\n**[blog.gentilkiwi.com/securite/un-observateur-evenements-aveugle](http://blog.gentilkiwi.com/securite/un-observateur-evenements-aveugle)**\n\ngentilkiwi 28/04/2011\n\nL’observateur d’événements de Windows est un service permettant au système et\nprogrammes de centraliser leurs remontées d’informations.\n\nPar exemple, l’audit de sécurité du poste y est ainsi consigné pour la plus grande joie des\nadministrateurs :\n\n## Un rapporteur\n\n\n-----\n\nCe service est aussi un rapporteur, il n hésitera pas à vous trahir lorsque vous voudrez faire\ndisparaitre vos traces…\n\nIl est ainsi difficile d’avoir un journal de sécurité vide.\n\n## Le code\n\nQue ce soit par un callback RPC ou lors de l’effacement d’un journal, une fonction traître est\nappelée…\n\nEn NT 5\n```\n.text:756F2F8D ; __stdcall PerformWriteRequest(x)\n.text:756F2F8D _PerformWriteRequest@4 proc near    ; CODE XREF:\nElfPerformRequest(x)+48p\n.text:756F2F8D                     ; WriteQueuedEvents()+70p\n\n```\nEn NT 6\n```\n.text:715D2841 ; private: void __thiscall Channel::ActualProcessEvent(class\nBinXmlReader &)\n.text:715D2841 ?ActualProcessEvent@Channel@@AAEXAAVBinXmlReader@@@Z proc near\n.text:715D2841                     ; CODE XREF:\nChannel::ProcessEvent(BinXmlReader &)+52p\n.text:715D2841                     ;\nChannel::FireEventIntoLog(Buffer &,_EVENT_DESCRIPTOR const &,void *)+15Cp\n.text:715D2841                     ;\nChannel::ProcessLogFull(BinXmlReader &)+1A2p\n.text:715D2841\n\n```\n\n-----\n\nSous NT 6, la fonction doit être interceptée à moins bas niveau que NT 5 afin d éviter au\nmaximum les programmes et tâches pouvant êtres liés à l’écriture de l’événement.\nL’événement n’ayant pas été réellement créé, cela peut vexer notre service…\n\n## Aidons l’observateur à moins observer\n\nEt voilà un journal d’événements beaucoup moins bavard :), même lors de son arrêt… le\npremier événement au reboot sera donc : `Windows démarre.`\n\n_…comme toujours, ça sera dans_ `mimikatz 1.0 …`\n\n\n-----",
    "language": "FR",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2011/2011-04-28 - Un observateur d’événements aveugle….pdf"
    ],
    "report_names": [
        "2011-04-28 - Un observateur d’événements aveugle….pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535923,
    "ts_updated_at": 1743041120,
    "ts_creation_date": 1653710286,
    "ts_modification_date": 1653710286,
    "files": {
        "pdf": "https://archive.orkl.eu/1a0ee405cf5cdd8caaf6f8160e72039edd327444.pdf",
        "text": "https://archive.orkl.eu/1a0ee405cf5cdd8caaf6f8160e72039edd327444.txt",
        "img": "https://archive.orkl.eu/1a0ee405cf5cdd8caaf6f8160e72039edd327444.jpg"
    }
}