{
    "id": "731c1af8-ed41-40f3-9582-c43be1eb8c0e",
    "created_at": "2022-10-25T16:48:10.928336Z",
    "updated_at": "2025-03-27T02:16:53.102033Z",
    "deleted_at": null,
    "sha1_hash": "1bf64f3fe87c916e250e3c9058d7de553e1cbbd2",
    "title": "‘Operation Oceansalt’ Attacks South Korea, U.S., and Canada With Source Code From Chinese Hacker Group",
    "authors": "McAfee",
    "file_creation_date": "2018-10-15T12:49:41Z",
    "file_modification_date": "2018-10-15T12:49:52Z",
    "file_size": 5048278,
    "plain_text": "# ‘Operation Oceansalt’ Attacks South Korea, U.S., and Canada With Source Code From Chinese Hacker Group\n\n\n#### October 18, 2018\n\n\n-----\n\n## ‘Operation Oceansalt’ Attacks South Korea, U.S., and Canada With Source Code From Chinese Hacker Group\n\n#### Introduction\n\n McAfee[®] Advanced Threat Research and Anti-Malware Operations teams have discovered another unknown data reconnaissance implant targeting Korean-speaking users. We have named this threat Operation Oceansalt based on its similarity to the earlier malware Seasalt, which is related to earlier Chinese hacking operations. Oceansalt reuses a portion of code from the Seasalt implant (circa 2010) that is linked to the Chinese hacking group Comment Crew. Oceansalt appears to have been part of an operation targeting South Korea, United States, and Canada in a well-focused attack. A variation of this malware has been distributed from two compromised sites in South Korea. (They are currently offline.) Oceansalt appears to be the first stage of an advanced persistent threat. The malware can send system data to a control server and execute commands on infected machines, but we do not yet know its ultimate purpose. The Advanced Threat Research team has not previously described this implant in any of our analyses.\n\n\n**Authors**\n\nThis report was researched\nand written by:\n\n**Ryan Sherstobitoff**\n\n**Asheer Malhotra**\n\nConnect With Us\n\n\n##### Comment Crew or Another Actor?\n\nThe actions of Comment Crew, also known as APT1,\nwere exposed in 2013 in a ground-breaking report on\nChinese cyber espionage against the United States. This\nreport detailed the inner workings of Comment Crew\nand its cyber offensive capabilities. The consequences\nof releasing this public report forced the group to either\nmake changes to their techniques or cease their activity\naltogether Until this analysis we had observed no\n\n\nnew activity related to Comment Crew since they were\nexposed, but now we find portions of their implant code\nappearing in new operations targeting South Korea.\n\nAs we investigated this code overlap, we found no\nevidence that the source code from Comment Crew\nwas ever made public, nor did we find it being sold in\nunderground markets we examined. Has Comment\nCrew returned? We think it is unlikely. Due to the lack of\ni di ti th t thi i C t C i it\n\n\n-----\n\nraises the question of who is responsible. Based on our\nresearch, we offer a few potential scenarios that could\nexplain the existence of Comment Crew’s code in the\ncurrent actor’s malware targeting South Koreans.\n\n- This is a code-sharing arrangement between two\nactors\n\n- An actor has privately gained access to the source\ncode from someone involved in the original Comment\nCrew operations\n\n- This is a “false flag” operation using Comment Crew’s\ncode to make it appear that China and North Korea\nhave collaborated on this cyberattack\n\n##### Does the Actor Speak Korean?\n\nThe contents of the malicious documents were written in\nKorean and contained subjects specifically relating to the\nfinances of projects in South Korea. These documents\nappear to be unique, not found on open-source\nchannels. We were not able to determine the source of\nthese documents, suggesting they were created by the\nactor.\n\nThe metadata in the malicious Microsoft Office\ndocuments used in the attacks contains a Koreanlanguage code page. This data indicates the document\ncontained the Korean-language pack, most likely to\nensure the victims could read it. We also see a consistent\nauthor, which is typical of the techniques of previous\ncampaigns we have analyzed that involved malicious\ndocuments targeting South Koreans.\n\n\nFigure 1. Metadata from a code page in a malicious .xls document.\n\nThe Advanced Threat Research team concludes that we\nhave found a new implant family created by an actor\ntargeting Korean-speaking users and using components\nfrom Comment Crew’s source code. Furthermore it is\nlikely that the actor has a good working knowledge of the\nKorean language.\n\n##### Targets\n\nDuring our research we discovered the initial attack\nvector was spear phishing, with two malicious Koreanlanguage Microsoft Excel documents acting as\ndownloaders of this implant. According to our document\nanalysis, the targets likely had knowledge of South\nKorean public infrastructure projects and related\nfinancials—a clear indication that the actor focused\ninitially on infrastructure.\n\nA second round of malicious documents, this time in\nMicrosoft Word, carried the same metadata and author\nas the Excel documents. The content was related to the\nfinancials of the Inter-Korean Cooperation Fund. The\n\n\n-----\n\nmalicious activity first appeared on May 31, 2018, in\nSouth Korea. Further telemetry indicates organizations\noutside of Korea have fallen victim to this attack; as of\nAugust 14, the attack had reached multiple industries in\nCanada and the United States.\n\nThe date of the attack’s first appearance in North\nAmerica is unknown. We did not find Office documents\naffecting targets in Canada and the United States, but\nour telemetry indicates the threat has also affected\nsystems in North America. It is possible the attack\non North American companies is part of a separate\ncampaign from the one targeting Koreans, especially\nbecause we discovered only a handful of malicious\ndocuments and they distributed only one variant of the\nimplant out of several we found. Based on our telemetry,\nthe team learned these organizations were in the\ninvestment, banking, and agriculture industries.\n\n##### Objectives and Impact\n\nOur research suggests the targets were those who\nwould read documents related to South Korea’s public\nconstruction expenses, Inter-Korean Cooperation fund,\nor other global financial data. One possible motive for\nthe campaign is financial theft. These attacks might\nbe a precursor to a much larger attack that could be\ndevastating given the control the attackers have over\ntheir infected victims. The impact of these operations\ncould be huge: Oceansalt gives the attackers full control\nof any system they manage to compromise and the\nnetwork it is connected to. A bank’s network would be\nan especially lucrative target.\n\n\nFurther, the code overlaps with that from a previously\nreported advanced state-sponsored group. The overlap\nsuggests a close collaboration between members of\na state-sponsored group and the current actors in\nconducting cyber operations.\n\n##### Campaign Analysis\n\nThe campaign to target and compromise victims across\nthe world began in Korea and expanded globally in\nstages. The distribution URLs for the implants were fairly\nconsistent for the malicious documents; it appears the\nactor hacked a number of South Korean websites to\nhost the implant code.\n\n##### Wave One: South Korean higher education\n\nThe first wave of attacks began with a malicious\ndocument created May 18, with a last saved date of May\n28. The author of this Korean-language document was\nLion, whom we will continue to see throughout later\ndocuments.\n\nFigure 2. Metadata from a first-wave malicious document.\n\n\n-----\n\nIn the first wave the malicious Excel file contains a list of\nKorean names, physical addresses, and email addresses.\nMany of the names belong to those involved in higher\neducation in South Korea or who attend various\ninstitutes. However, the list is random and looks like a\ncopy of a database of personal information from a South\nKorean government authority.\n\nThis document contains macro code to download the\nimplant from www.[redacted].kr/admin/data/member/1/\nlog.php and execute it as V3UI.exe, the name of a\nsecurity product in South Korea.\n\n##### Wave Two: South Korean public infrastructure\n\nThe Advanced Threat Research team discovered that the\nimplant was hosted at a legitimate site in South Korea\nbelonging to a music teachers organization that has\nno relationship to the malicious document. The actor\nhosted a PHP page that triggered the download of the\nimplant from a malicious VBA script embedded in two\nExcel documents, which contained Visual Basic macros\nto communicate, download, and install an implant on\nthe victim’s system once the document was opened and\nviewed. The documents were submitted to us by a South\nKorean organization during the first wave of attacks.\n\n\n**hxxp://[redacted].kr/admin/data/member/1/log.php**\n\nFigure 3. The download URL for the second wave of attacks, against\npublic infrastructure.\n\nThis Excel document was created May 31 by the author\nLion, a day before the implant was compiled and hosted\non the distribution site. The documents appear to be\nrelated to South Korean public infrastructure projects\nand their expenses. Based on our analysis of the\ndocuments, it is clear that this attack is targeted toward\nSouth Korean individuals in this field.\n\nFigure 4. Metadata from a second-wave malicious document.\n\n\n-----\n\nFigure 5. Malicious document 1: investment trends in public infrastructure projects.\n\n\n-----\n\nFigure 6. Malicious document 2: expenses in public infrastructure\nprojects.\n\n\nFigure 7. Malicious document 3: a public projects expense report.\n\nThe last document in this wave was created by Lion\non June 4 with the filename 0.온나라_상용_SW_2018년\n대상_list_(20180411)_지역업체.xls. This document was\nobserved downloading the implant from the distribution\nserver. It references Onnara, a government agency\nresponsible for land and development in South Korea.\n\n\n-----\n\n##### Wave Three: Inter-Korean Cooperation\n\nThe third wave included a Word document with\nthe same type of macro code as the Excel files. The\ndocument contained fake information related to the\nfinancials of the Inter-Korean Cooperation Fund. The\ndocument was created at the same time as the attacks\non South Korean public infrastructure officials. Lion\nauthored both Excel and Word documents. This Word\ndocument used a different South Korean compromised\nwebsite to distribute the implant. In this wave, an\nadditional Excel document appeared with telephone\nnumbers and contact information connected to the\ncontent of the Word document.\n\n**hxxp://[redacted].kr/gbbs/bbs/admin/log.php**\n\nFigure 8. The distribution URL for the implant for Wave Three.\n\n\nFigure 9. Fake statistics statement monthly report from the Inter-Korean Corporation Fund.\n\n\n-----\n\nFigure 10. Fake statistics statement monthly report from the Inter-Korean Corporation Fund.\n\n\n-----\n\nFigure 11. Fake product and partner information.\n\n\n-----\n\n##### Wave Four: Targets outside of South Korea\n\nWe identified a small number of targets outside of\nSouth Korea, as the attacks expanding their scope. We\nhave yet to identify the malicious documents involved\nin delivering this implant to the victims. Because Waves\nOne and Two contained different distribution servers\nfor the implant, we expect this wave had its own as well.\nAccording to McAfee telemetry data between August 10\nand 14, these North American targets fall within several\nindustries:\n\n**Industry** **Country**\n\nFinancial United States\n\nHealth Care United States\n\nHealth Care United States\n\nTelecommunications Canada\n\nFinancial United States\n\nAgriculture and Industrial United States\n\nFinancial United States\n\nTelecommunications Canada\n\nFinancial Canada\n\nFinancial Technology United States\n\nGovernment United States\n\nFigure 12. Victims in Wave Four of the campaign.\n\n\n##### Wave Five: South Korea and United States\n\nThe Oceansalt implant was not limited to just one\nsample. We discovered additional variants using\ndifferent control servers. As we continued to investigate,\nwe found more samples, though obfuscated to\navoid detection. The samples were all identical to\nthe initial Oceansalt implant. The fifth-wave samples\nwere compiled between June 13 and July 17 and were\nsubmitted to us by organizations in South Korea and the\nUnited States.\n\n**Hash** **Compile Date** **Control Server**\n\n38216571e9a9364b509e52ec19fae61b 6/13/2018 172.81.132.62\n\n531dee019792a089a4589c2cce3dac95 6/14/2018 211.104.160.196\n\n0355C116C02B02C05D6E90A0B3DC107C 7/16/2018 27.102.112.179\n\n74A50A5705E2AF736095B6B186D38DDF 7/16/2018 27.102.112.179\n\n45C362F17C5DC8496E97D475562BEC4D 7/17/2018 27.102.112.179\n\nC1773E9CF8265693F37DF1A39E0CBBE2 7/17/2018 27.102.112.179\n\nD14DD769C7F53ACEC482347F539EFDF4 7/17/2018 27.102.112.179\n\nB2F6D9A62C63F61A6B33DC6520BFCCCD 7/17/2018 27.102.112.179\n\n76C8DA4147B08E902809D1E80D96FBB4 7/17/2018 27.102.112.179\n\n\n-----\n\n##### Technical Analysis\n\n Download and execution capabilities\n\n- Once the .xls/.doc files are opened in Office,\nembedded malicious macros contact a download\nserver and write the Oceansalt implant to disk\n\n- These malicious macros execute the Oceansalt implant\non the infected endpoint\n\nThe indicators of compromise from the malicious .xls\ndownloaders:\n\n**IOC Description** **IOC Value**\n\nDownload servers contacted [redacted].kr\n\n[redacted].kr\n\nOceansalt location on the /admin/data/member/1/log[.]php\ndownload server /gbbs/bbs/admin/log[.]php\n\nOceansalt location on the %temp%\\SynTPHelper[.]exe\ninfected endpoint %temp%\\LMworker[.]exe\n\n\nFigure 13. A portion of the malicious macro code used to download the implant.\n\n\n-----\n\n##### Control Server\n\nThe campaign employed multiple control servers. We\nobserved the following IP addresses in implants dating\nfrom June to July.\n\n- 172.81.132.62\n\n- 211.104.160.196\n\n- 27.102.112.179\n\n- 158.69.131.78\n\nOur telemetry shows this campaign is operational in\nseveral countries. Address 211.104.160.196 indicates\ninfections in Costa Rica, the United States, and the\nPhilippines. Address 158.69.131.78 reveals additional\ninfections in the United States and Canada.\n\nThese machines resided in numerous countries\nfrom August 18–21. Because this operation involves\nmultifunction implants, these machines are likely to be\npart of a larger covert listener network. The Advanced\nThreat Research team has observed this kind of\ntargeting in similar operations that compromise victims\nas control server relays.\n\n##### Implant Origins\n\nOur initial investigation into earlier similar samples led\nus to a variant—bf4f5b4ff7ed9c7275496c07f9836028,\ncompiled in 2010. Oceansalt uses portions of code from\nthis sample; their overall similarity is 21%. The reused\ncode is unique, is not considered a common library or\ncommon code, and serves reconnaissance and control.\n\n\nThe misclassified sample used a Comment\nCrew domain. Further investigation revealed\nthe misclassified sample is 99% like Seasalt\n[(5e0df5b28a349d46ac8cc7d9e5e61a96), a Comment](https://github.com/oasis-open/cti-stix-elevator/blob/master/idioms-json/Appendix_G_IOCs_Full.json)\nCrew implant reported to have been used in their\noperations around 2010. Thus the Oceansalt actor is\nreusing portions of code from Seasalt to form a new\nimplant. Based on the overall techniques, Oceansalt is\nunlikely to signal a rebirth of Comment Crew, raising the\nquestion of how the actor obtained the Seasalt code.\nWas it provided to this or another actor, or was it leaked\nand discovered by this actor? We have been unable to\nfind any evidence in underground or public forums that\nsuggest the source code of Seasalt has been leaked or\nmade available.\n\nWe discovered another batch of samples compiled\non July 16–17 that are obfuscated and essentially the\nsame implant, with minor changes such as the control\nservers. Some of the samples are missing reverse-shell\nfunctionality, indicating that this actor has access to\nSeasalt source code and can compile implants from\nthe original source. This could demonstrate is a level of\ncollaboration between two nation-states on their cyber\noffensive programs.\n\n##### Code Similarities with Seasalt\n\nOceansalt contains the following strings that are part of\nSeasalt:\n\n- Upfileer\n\n- Upfileok\n\n\n-----\n\nFigure 14. Seasalt strings appearing in Oceansalt.\n\nFigure 15. Seasalt strings appearing in Oceansalt.\n\nBoth implants have a high degree of similarity in code\nsharing and functions. A few of their commonalities\nfollow.\n\n##### Command handler and index table similarities\n\nThe command handler for both implants uses similar\nsemantics and command codes to execute the same\nfunctionalities. Even the mechanism for calculating the\ncommand code is similar. Seasalt code is represented on\nthe left and Oceansalt appears on the right:\n\n\nFigure 16. Command handler similarity between Seasalt, at left, and Oceansalt.\n\nFigure 17. Command index table similarity between Seasalt, at left, and Oceansalt.\n\n##### Command and capability similarities\n\nBoth implants execute their capabilities in the same\nway, which indicates they were both developed from\nthe same code base. The response codes used by\nboth implants to indicate the success or failure of the\ncommands executed on the endpoint are also an exact\nmatch. Some of these similarities:\n\n- Drive reconnaissance capability: Similar code\nsignatures. Both implants use the same codes to\nindicate the drive type to the control server\n\n\n-----\n\n-----\n\n- File reconnaissance capability: Similar API and code\nusage to get file information. The response codes sent\nto the control server to indicate whether a file was\nfound is an exact match.\n\nFigure 19. Similarity in the command execution capability. Seasalt is at left.\n\n\n-----\n\n- Reverse-shell creation capability: Both implants use\nsimilar code signatures to create a reverse shell on the\ninfected endpoint. Both reverse shells are based on\ncmd.exe.\n\nFigure 20 Reverse shell creation capability similarities Seasalt is at left\n\n\n-----\n\n##### Code Differences from Seasalt\n\nThere are a few differences between the two implants\nin implementation; these demonstrate that Oceansalt\nis not simply a recompilation of Seasalt source code.\nHowever, these differences also provide evidence that\nOceansalt is an evolution of Seasalt.\n\n- **Encoding: The Oceansalt implant uses an encoding**\nand decoding mechanism before any data is sent to\nthe control server. The Seasalt implant does not use\nthis encoding and sends unencrypted data to the\ncontrol server.\n\n- **Control server address: Oceansalt uses a hardcoded**\ncontrol server address to establish communication.\nSeasalt parses the control address from its binary by\ndecoding data.\n\n- **Persistence: Oceansalt has no persistence**\nmechanisms to ensure continued infection over\nendpoint reboots. Seasalt, on the other hand, copies\nitself to C:\\DOCUMEN~1\\<userid>\\java.exe and creates\na registry entry to ensure infection after reboot:\n\n−−HKLM\\Software\\Microsoft\\Windows\\currentVersion\\\nRun | sysinfo\n\nBased on the executable header information, Seasalt\nwas compiled on March 30, 2010. Oceansalt was\ncompiled on June 1, 2018. Highlighting the compilation\ntimestamps is important because, as our preceding\nanalysis demonstrates, the samples have a high degree\nof code sharing:\n\n\n\n- Multiple code matches and similarities\n\n- Multiple functional similarities\n\n- Identical command capabilities\n\n- Same command and response codes issued by and\nsent to the control server\n\nThe code used to create the reverse shell in Oceansalt\nis an exact match with that of Comment Crew’s Seasalt\nimplant. The mechanism for creating the reverse shell\n(pipe-based inter-process communication for standard\nI/O handles) is also seen in Comment Crew implants\nsuch as WebC2-CSON and WebC2-GREENCAT.\n\nThese matches lead us to believe that Oceansalt is\nbased on Seasalt, because it reuses much of the code\nbase developed 10 years ago. Seasalt’s public disclosure\nin the Comment Crew report does not seem to have\ndiscouraged Oceansalt’s developer.\n\n##### Obfuscated Oceansalt Comparison with Seasalt\n\nWe offer a comparative analysis of the following partially\nobfuscated implants against the initial Oceansalt sample\nand the Seasalt implant from Comment Crew.\n\n**SHA-1** **Compile Date** **Role**\n\nfc121db04067cffbed04d7403c1d222d376fa7ba 7/16/2018 Partially obfuscated Oceansalt\n\n281a13ecb674de42f2e8fdaea5e6f46a5436c685 7/17/2018 Partially obfuscated Oceansalt\n\n1f70715e86a2fcc1437926ecfaeadc53ddce41c9 7/17/2018 Partially obfuscated Oceansalt\n\nec9a9d431fd69e23a5b770bf03fe0fb5a21c0c36 7/16/2018 Partially obfuscated Oceansalt\n\n12a9faa96ba1be8a73e73be72ef1072096d964fb 7/17/2018 Partially obfuscated Oceansalt\n\nbe4fbb5a4b32db20a914cad5701f5c7ba51571b7 7/17/2018 Partially obfuscated Oceansalt\n\n0ae167204c841bdfd3600dddf2c9c185b17ac6d4 7/17/2018 Partially obfuscated Oceansalt\n\n\n-----\n\nAll the partially obfuscated Oceansalt implants have the\nfollowing characteristics:\n\n- All implants were compiled during a three-day period:\nJuly 16–18\n\n- All implants contain debug statements (print logs)\nwritten to the log file: C:\\Users\\Public\\Videos\\temp.log\n\n- These debug statements begin with the timestamp\nand consist of the following keywords at the beginning\nof the debug message:\n\n−−[WinMain]\n\n−−[FraudProc]\n\n- All implants connected to the same control server IP\naddress: 27.102.112.179\n\n- Although none of the partially obfuscated implants\ncontain any additional capabilities (as compared with\nthe initial Oceansalt or Seasalt), some of the partially\nobfuscated implants are missing the reverse-shell\ncapabilities:\n\n**Reverse-Shell**\n**Partially Obfuscated Oceansalt Hash** **Capability?**\n\nC1773E9CF8265693F37DF1A39E0CBBE2 No\n\n0355C116C02B02C05D6E90A0B3DC107C Yes\n\n74A50A5705E2AF736095B6B186D38DDF Yes\n\n45C362F17C5DC8496E97D475562BEC4D No\n\nD14DD769C7F53ACEC482347F539EFDF4 No\n\nB2F6D9A62C63F61A6B33DC6520BFCCCD Yes\n\n76C8DA4147B08E902809D1E80D96FBB4 Yes\n\n\n##### Evidence of Source-Code Sharing\n\nWe present evidence of source-code sharing between\nthe Oceansalt authors and Comment Crew, based on\nour comparative analysis of the three sets of samples:\nOceansalt, partially obfuscated Oceansalt, and Seasalt.\n\n- There is no possibility the attackers could have reinstrumented Seasalt by simply modifying the control\nserver IP addresses:\n\n−−The mechanism for obtaining the address in Seasalt\nis different from Oceansalt’s. Seasalt looks for\nencoded data at the end of the binary, decodes this\ndata into tokens separated by the marker “$,” and\nobtains the control server information.\n\n−−Oceansalt implants have the control server IP\naddresses and port numbers hardcoded as plaintext strings in the binaries\n\n- Some of the partially obfuscated Oceansalt implants\nare missing the reverse-shell capability. All other\ncapabilities (code signatures, response codes, etc.)\nand command codes are similar. (Command codes are\neither the same or off by 1.) Modifying capabilities in\nthis fashion is possible only with access to the source\ncode of Seasalt.\n\n\n-----\n\n- The presence of debug strings tracing the code flow of\nthe Oceansalt implants indicates they were compiled\nafter adding debug information to the source code of\nSeasalt:\n\n−−[WinMain]after recv cmd=%d 0Dh 0Ah\n\n−−[WinMain]before recv 0Dh 0Ah\n\n−−[FraudProc]Engine is still active! 0Dh 0Ah\n\n−−[FraudPRoc]Process Restart! 0Dh 0Ah\n\n- The presence of these debug strings also indicates\nthat the authors who modified the source code may\nhave used these samples to perform their initial\ntesting before obfuscating and releasing the implants\nto their victims, without scrubbing the debug strings\n\n- The Oceansalt implant\n531dee019792a089a4589c2cce3dac95 (compiled June\n1) contains a few key features that indicate compilation\nfrom the source code of Seasalt:\n\n−−Does not contain the reverse-shell capability\n\n−−Does not contain the drive recon capability\n\n−−Loads API SHGetFileInfoA() dynamically without\nstatically importing it. This also suggests that\nSeasalt’s source code was modified before\ncompilation.\n\n\nFigure 21. Dynamic API loading in an Oceansalt implant.\n\n\n-----\n\n##### Oceansalt Capabilities\n\nOceansalt is 76KB, a minimal on-disk footprint that is\nharder to detect than larger malware. The implant has a\nvariety of capabilities for capturing data from the victim’s\nmachine using a structured command system. From\nour research we have determined that this implant is a\nfirst-stage component. Further stages are downloaded\nthrough its commands. Oceansalt also supports\ncommands enabling the attacker to take various actions\non the victim’s system.\n\n##### Initial reconnaissance\n\nOceansalt starts by trying to connect to its control server\nat 158.69.131.78:8080. Once connected, the implant\nsends the following information about the endpoint:\n\n- IP address\n\n- Computer name\n\n- File path of the implant\n\nAll data sent to the control server is encoded with a NOT\noperation on each byte.\nFigure 23. Control server connection functionality for Oceansalt.\n\n\n-----\n\n##### Command handler functions\n\nOceansalt can execute 12 commands. Each command\nreceived from the control server is represented by a\ncommand code ranging from 0x0 to 0xB (0 to 11).\n\nFigure 24. Command index table showing Oceansalt’s capabilities.\n\n\n-----\n\nFigure 25. Oceansalt’s command execution functionality.\n\n\n-----\n\n##### 0x0: Drive recon\n\nThe control server sends this command code to\nOceansalt to extract drive information from the\nendpoint. The format of the drive information:\n```\n#<Drive _ letter>:<Drive _ type><Drive _\nletter>:<Drive _ type>...#\n\n```\n**Legend** **Description**\n\n<Drive_letter> A,B,C,D,E, etc., representing all logical drives on\nthe system\n\n<Drive_type> 0 = DRIVE_REMOVABLE\n1 = DRIVE_FIXED\n2 = DRIVE_CDROM\n3 = DRIVE_REMOTE\n\n\nFigure 26 Oceansalt gathering drive information\n\n\n-----\n\n##### 0x1: File recon\n\nSends the following information about a specific file (or\nfile pattern) specified by the control server:\n\n- Filename\n\n- Type of file on disk, for example, file or folder\n\n- “OK” if file was found on the location\n\n- File creation time in format <YYYY-mm-DD HH:MM:SS>\n\n##### 0x2: Command execute\n\nExecutes a command line using WinExec(). The\ncommand line is provided by the control server along\nwith the command number. For example:\n```\n<DWORD representing command\nnumber><command line to be executed>\n02 00 00 00 C:\\Windows\\system32\\calc.exe\n\n```\nThe command line is executed with a hidden window\n(using the SW_HIDE option for WinExec()).\n\n\n##### 0x3: File delete\n\n- Deletes a file specified by the control server from the\ndisk\n\n- Once an operation is completed, the implant sends\na “0” (in ASCII) to the control server to indicate the\nsuccessful execution of the command\n\n- If the operation fails, Oceansalt sends a “1” (in ASCII) to\nindicate failure\n\n##### 0x4: File write\n\n- Creates a file specified by a file path provided by the\ncontrol server, which also provides the content to be\nwritten to the file path\n\n- If the file write is successful, Oceansalt sends the\nkeyword “upfileok” indicating success\n\n- If the file write fails, the implant sends the keyword\n“upfileer” indicating failure\n\n\n-----\n\nFigure 28 Oceansalt’s file writing capability\n\n\n##### 0x6: Process recon\n\n- Sends the name and ID for every process running on\nthe system to the control server\n\n- Process data is sent via individual packets, that is, one\npacket per process\n\nFigure 29 Oceansalt’s process listing via its recon capability\n\n\n-----\n\n##### 0x7: Process terminate\n\n- Terminates a process whose ID has been specified by\nthe control server\n\n##### 0x8: Reverse shell create\n\n- Opens a reverse shell from the infected endpoint to\nthe control server using Windows pipes\n\n- This reverse shell is based on cmd.exe. It can carry out\nfurther recon and make changes to the endpoint.\n\n\n-----\n\n##### 0x9: Reverse shell operate\n\n- Operates the reverse shell established using the\nprevious command code\n\n- Contains the commands sent by the control server to\nthe reverse shell that will be executed by cmd.exe on\nthe infected endpoint\n\n- Once the command has been executed, the output is\nread from cmd.exe via a pipe and sent to the control\nserver\n\n##### 0XA: Reverse shell terminate\n\n- Closes the reverse shell by closing handles to the pipes\ncreated for the shell’s inter-process communication\n\n##### 0XB: Connection test\n\n- Tests receive and send capabilities of the implant by\nreceiving data (0x7 bytes) from the control server and\nsending it back\n\n- Persistence\n\n- Oceansalt has no persistence capabilities to remain on\nthe endpoint after the system reboots\n\n- This lack suggests other components in the infection\nchain may ensure persistence and carry out other\nmalicious activities\n\n\n##### Conclusion\n\nBased on our analysis, the McAfee Advanced Threat\nResearch team has named this global threat Operation\nOceansalt. This operation has focused on targets in\nSouth Korea and other countries with new malware that\nhas roots in Comment Crew activity from 2010.\n\nOur research shows that Comment Crew’s malware in\npart lives on in different forms employed by another\nadvanced persistent threat group operating primarily\nagainst South Korea. This research represents how\nthreat actors including nation-states might collaborate\non their campaigns. McAfee continues to monitor the\nthreat landscape in Asia and around the world to track\nthe evolution of known groups and changes to their\ntechniques.\n\n\n-----\n\n##### McAfee Coverage\n\n- Generic.dx!tjz\n\n- RDN/Generic.grp\n\n- RDN/Generic.ole\n\n- RDN/Generic.grp (trojan)\n\n- RDN/Trojan-FQBD\n\n- RDN/Generic.RP\n\n##### Indicators of Compromise\n\n MITRE ATT&CK™ Techniques\n\n- Scripting\n\n- Spear phishing attachment\n\n- Automated collection\n\n- Command-line interface\n\n- Network share discovery\n\n- Process discovery\n\n- File and directory discovery\n\n- Data from local system\n\n- Data from removable media\n\n- Data from network shared drive\n\n- Exfiltration over control server channel\n\n\n##### IP addresses\n\n- 158.69.131.78\n\n- 172.81.132.62\n\n- 27.102.112.179\n\n- 211.104.160.196\n\n##### Hashes\n\n- fc121db04067cffbed04d7403c1d222d376fa7ba\n\n- 832d5e6ebd9808279ee3e59ba4b5b0e884b859a5\n\n- be4fbb5a4b32db20a914cad5701f5c7ba51571b7\n\n- 1f70715e86a2fcc1437926ecfaeadc53ddce41c9\n\n- dd3fb2750da3e8fc889cd1611117b02d49cf17f7\n\n- 583879cfaf735fa446be5bfcbcc9e580bf542c8c\n\n- ec9a9d431fd69e23a5b770bf03fe0fb5a21c0c36\n\n- d72bc671583801c3c65ac1a96bb75c6026e06a73\n\n- e5c6229825f11d5a5749d3f2fe7acbe074cba77c\n\n- 9fe4bfdd258ecedb676b9de4e23b86b1695c4e1e\n\n- 281a13ecb674de42f2e8fdaea5e6f46a5436c685\n\n- 42192bb852d696d55da25b9178536de6365f0e68\n\n- 12a9faa96ba1be8a73e73be72ef1072096d964fb\n\n- 0ae167204c841bdfd3600dddf2c9c185b17ac6d4\n\n\n-----\n\n##### About McAfee\n\nMcAfee is the device-to-cloud cybersecurity company.\nInspired by the power of working together, McAfee\ncreates business and consumer solutions that make\nour world a safer place. By building solutions that\nwork with other companies’ products, McAfee helps\nbusinesses orchestrate cyber environments that are\ntruly integrated, where protection, detection, and\ncorrection of threats happen simultaneously and\ncollaboratively. By protecting consumers across all\ntheir devices, McAfee secures their digital lifestyle\nat home and away. By working with other security\nplayers, McAfee is leading the effort to unite against\ncybercriminals for the benefit of all.\n\n**[www.mcafee.com.](http://www.mcafee.com)**\n\n2821 Mission College Blvd.\nSanta Clara, CA 95054\n888.847.8766\n[www mcafee com](http://www.mcafee.com)\n\n\n##### About McAfee Labs and Advanced Threat Research\n\nMcAfee Labs, led by McAfee Advanced Threat\nResearch, is one of the world’s leading sources for\nthreat research, threat intelligence, and cybersecurity\nthought leadership. With data from millions of sensors\nacross key threats vectors—file, web, message, and\nnetwork— McAfee Labs and McAfee Advanced Threat\nResearch deliver real-time threat intelligence, critical\nanalysis, and expert thinking to improve protection and\nreduce risks.\n\n**[www.mcafee.com/us/mcafee-labs.aspx.](http://www.mcafee.com/us/mcafee-labs.aspx)**\n\nMcAfee and the McAfee logo are trademarks or registered trademarks of McAfee, LLC or its subsidiaries in the US and other countries.\nOther marks and brands may be claimed as the property of others. Copyright © 2017 McAfee, LLC. 4149_1018\nOCTOBER 2018\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://www.mcafee.com/enterprise/en-us/assets/reports/rp-operation-oceansalt.pdf",
        "https://app.box.com/s/ltu4qau4bolnol75znojizgczf1xsh2x",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.10.18.Operation_Oceansalt/rp-operation-oceansalt.pdf"
    ],
    "report_names": [
        "rp-operation-oceansalt.pdf",
        "McAfee_rp-operation-oceansalt(10-17-2018)",
        "rp-operation-oceansalt"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dabb6779-f72e-40ca-90b7-1810ef08654d",
            "created_at": "2022-10-25T15:50:23.463113Z",
            "updated_at": "2025-03-27T02:00:55.47619Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "APT1",
                "Comment Crew",
                "Comment Group",
                "Comment Panda"
            ],
            "source_name": "MITRE:APT1",
            "tools": [
                "Seasalt",
                "ipconfig",
                "Cachedump",
                "PsExec",
                "GLOOXMAIL",
                "Lslsass",
                "PoisonIvy",
                "WEBC2",
                "Mimikatz",
                "gsecdump",
                "Pass-The-Hash Toolkit",
                "Tasklist",
                "xCmd",
                "pwdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716490,
    "ts_updated_at": 1743041813,
    "ts_creation_date": 1539607781,
    "ts_modification_date": 1539607792,
    "files": {
        "pdf": "https://archive.orkl.eu/1bf64f3fe87c916e250e3c9058d7de553e1cbbd2.pdf",
        "text": "https://archive.orkl.eu/1bf64f3fe87c916e250e3c9058d7de553e1cbbd2.txt",
        "img": "https://archive.orkl.eu/1bf64f3fe87c916e250e3c9058d7de553e1cbbd2.jpg"
    }
}