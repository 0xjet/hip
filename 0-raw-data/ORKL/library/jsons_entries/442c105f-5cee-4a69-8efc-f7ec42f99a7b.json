{
    "id": "442c105f-5cee-4a69-8efc-f7ec42f99a7b",
    "created_at": "2023-01-12T15:05:10.697159Z",
    "updated_at": "2025-03-27T02:06:11.215709Z",
    "deleted_at": null,
    "sha1_hash": "857fb949b46a479c3a5d2108a3edc0fe48501239",
    "title": "2022-07-27 - QBOT Configuration Extractor",
    "authors": "",
    "file_creation_date": "2022-08-18T03:52:52Z",
    "file_modification_date": "2022-08-18T03:52:52Z",
    "file_size": 237994,
    "plain_text": "# QBOT Configuration Extractor\n\n**elastic.co/security-labs/qbot-configuration-extractor**\n\n_Configuration extraction tool for QBOT malware_\n\nBy\n\nElastic Security Labs\n\n27 juillet 2022\n\nPython script to extract the configuration from QBOT samples.\n\n[Download qbot-config-extractor.tar.gz](https://assets.contentstack.io/v3/assets/bltefdd0b53724fa2ce/blta4523f3b586ba6ac/62e16e26d2f5267009ac073a/qbot-config-extractor.tar.gz)\n\n## Getting Started\n\nThis tool provides a Python module and command line tool that will extract configurations\nfrom the QBOT malware samples and dump the results to screen.\n\nThe QBOT Attack Pattern\n\nFor information on the QBOT attack pattern, check out our blog posts detailing this:\n\n\n-----\n\n[Exploring the QBOT Attack Pattern](https://www.elastic.co/security-labs/exploring-the-qbot-attack-pattern)\n\n### Docker\n\nWe can easily run the extractor with Docker, first we need to build the image:\n```\ndocker build . -t qbot-config-extractor\n\n```\nThen we run the container with the -v flag to map a host directory to the docker container\ndirectory:\n```\ndocker run -ti --rm -v \\\n\n\"$(pwd)/data\":/data qbot-config-extractor:latest -d /data/\n\n```\nWe can either specify a single sample with -f option or a directory of samples with -d.\n```\n$ docker run -ti --rm -v $(pwd)/data:/data qbot-config-extractor:latest -f\ndata/c2ba065654f13612ae63bca7f972ea91c6fe97291caeaaa3a28a180fb1912b3a\n\n=== Strings ===\n\n# Blob address: 0x100840a0\n\n# Key address: 0x10084040\n\n[0x0]: ProgramData\n\n[0xc]: /t4\n\n[0x10]: EBBA\n\n[0x15]: netstat -nao\n\n[0x22]: jHxastDcds)oMc=jvh7wdUhxcsdt2\n\n[0x40]: schtasks.exe /Create /RU \"NT AUTHORITY\\SYSTEM\" /SC ONSTART /TN %u /TR \"%s\"\n/NP /F\n\n...truncated...\n\n=== RESOURCE 1 ===\n\nKey: b'\\\\System32\\\\WindowsPowerShel1\\\\v1.0\\\\powershel1.exe'\n\nType: DataType.DOMAINS\n\n41.228.22.180:443\n\n47.23.89.62:995\n\n176.67.56.94:443\n\n103.107.113.120:443\n\n148.64.96.100:443\n\n47.180.172.159:443\n\n181.118.183.98:443\n\n...truncated...Read more\n\n### Running it Locally\n\n```\nAs mentioned above, Docker is the recommended approach to running this project,\nhowever you can also run this locally. This project uses [Poetry to manage dependencies,](https://python-poetry.org/)\ntesting, and metadata. If you have Poetry installed already, from this directory, you can\n\n\n-----\n\nsimply run the following commands to run the tool. This will setup a virtual environment,\ninstall the dependencies, activate the virtual environment, and run the console script.\n```\npoetry lock\n\npoetry install\n\npoetry shell\n\nqbot-config-extractor -h\n\n```\nOnce that works, you can do the same sort of things as mentioned in the Docker\ninstructions above.\n\n## Related content\n\nSee all top stories\n\n### Exploring the QBOT Attack Pattern\n\nIn this research publication, we'll explore our analysis of the QBOT attack pattern â€” a fullfeatured and prolific malware family.\n\n\n-----\n\n### BLISTER Configuration Extractor\n\nPython script to extract the configuration and payload from BLISTER samples.\n\n### BLISTER Loader\n\n\n-----\n\nThe BLISTER loader continues to be actively used to load a variety of malware.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-27 - QBOT Configuration Extractor.pdf"
    ],
    "report_names": [
        "2022-07-27 - QBOT Configuration Extractor.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535910,
    "ts_updated_at": 1743041171,
    "ts_creation_date": 1660794772,
    "ts_modification_date": 1660794772,
    "files": {
        "pdf": "https://archive.orkl.eu/857fb949b46a479c3a5d2108a3edc0fe48501239.pdf",
        "text": "https://archive.orkl.eu/857fb949b46a479c3a5d2108a3edc0fe48501239.txt",
        "img": "https://archive.orkl.eu/857fb949b46a479c3a5d2108a3edc0fe48501239.jpg"
    }
}