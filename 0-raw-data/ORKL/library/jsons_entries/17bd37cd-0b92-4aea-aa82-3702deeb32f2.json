{
    "id": "17bd37cd-0b92-4aea-aa82-3702deeb32f2",
    "created_at": "2023-01-12T15:00:05.056047Z",
    "updated_at": "2025-03-27T02:08:41.359751Z",
    "deleted_at": null,
    "sha1_hash": "848c3553ddd041d11de8ae4c343f979d7cc86743",
    "title": "2018-12-18 - URSNIF, EMOTET, DRIDEX and BitPaymer Gangs Linked by a Similar Loader",
    "authors": "",
    "file_creation_date": "2022-05-28T23:51:29Z",
    "file_modification_date": "2022-05-28T23:51:29Z",
    "file_size": 120913,
    "plain_text": "# URSNIF, EMOTET, DRIDEX and BitPaymer Linked by Loader\n\n**blog.trendmicro.com/trendlabs-security-intelligence/ursnif-emotet-dridex-and-bitpaymer-gangs-linked-by-a-similar-**\nloader/\n\nDecember 18, 2018\n\nMalware\n\nWe analyzed samples of EMOTET, URSNIF, DRIDEX and BitPaymer and found similar\npayload loaders and internal data structures, possibly implying that these different groups\nare familiar with and are working closely together.\n\nBy: Trend Micro Research December 18, 2018 Read time: ( words)\n\n[As ransomware and banking trojans captured the interest – and profits – of the world with](https://blog.trendmicro.com/trendlabs-security-intelligence/windows-security-feature-abused-blocks-security-software/)\n[their destructive routines, cybersecurity practitioners have repeatedly published](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/evolution-of-cybercrime) [online and](https://www.recordedfuture.com/russian-chinese-hacking-communities/)\n[offline how](https://industryofanonymity.com/) [cybercriminals have compartmentalized their schemes through exchange of](https://blog.trendmicro.com/cybercriminal-undergrounds-social-and-economic-philosophies/)\ninformation and banded professional organizations. As a more concrete proof of the way\nthese symbiotic relationships and work flows intersect, we discovered a connection between\n[EMOTET,](https://blog.trendmicro.com/trendlabs-security-intelligence/exploring-emotet-examining-emotets-activities-infrastructure/) [URSNIF,](https://blog.trendmicro.com/trendlabs-security-intelligence/ursnif-the-multifaceted-malware/) [DRIDEX and](https://blog.trendmicro.com/trendlabs-security-intelligence/curious-case-dridexs-prevalence/) [BitPaymer from open source information and the loaders](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/ransom_bitpaymer.a)\nof the samples we had, functioning as if tasks were divided among different developers and\noperators.\n\n\n-----\n\n_Figure 1. Connections of EMOTET, DRIDEX, URSNIF and BitPaymer._\n\n**Background and details**\n\nIn order to have a better understanding of the significance of these connections, here’s a\nsummarized background of each malware family:\n\nURSNIF / [GOZI-ISFB](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/gozi)\n\nStill considered as one of the global top threats, this banking trojan’s source code was\n[among those repeatedly leaked because of its evolution and notoriety for adaptive behaviors.](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/online-banking-trojan-brief-history-of-notable-online-banking-trojans)\nThis spyware monitors traffic, features a keylogger, and steals credentials stored in browsers\nand applications. The malware creators of GOZI admitted to its creation and distribution, and\nwas [sentenced in 2015 and 2016.](https://www.justice.gov/usao-sdny/pr/nikita-kuzmin-creator-gozi-virus-sentenced-manhattan-federal-court)\n\nDRIDEX\n\n[Another banking trojan that targets banking and financial institutions, the cybercriminals](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/web-attack/3147/dealing-with-the-mess-of-dridex)\nbehind it use various methods and techniques to steal personal information and credentials\n[through malicious attachments and HTML injections. DRIDEX evolved from CRIDEX,](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/cridex)\n[GameOver Zeus and](https://blog.trendmicro.com/trendlabs-security-intelligence/gameover-zeus-with-p2p-functionality-disrupted/) [ZBOT, and](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/web-attack/16/the-zeus-zbot-and-kneber-connection) [proved to be resilient even after it was momentarily taken](https://blog.trendmicro.com/hello-old-friend-dridex-at-it-again/)\n[down in 2015 through a partnership with the FBI.](https://blog.trendmicro.com/trendlabs-security-intelligence/us-law-enforcement-takedown-dridex-botnet/)\n\nEMOTET\n\n[Discovered by Trend Micro in 2014, this malware acts as a loader for payloads such as](https://blog.trendmicro.com/trendlabs-security-intelligence/new-banking-malware-uses-network-sniffing-for-data-theft/)\n[Gootkit,](https://blog.trendmicro.com/trendlabs-security-intelligence/fake-judicial-spam-leads-to-backdoor-with-fake-certificate-authority/) [ZeusPanda,](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ZEUS) [IcedID,](https://blog.trendmicro.com/trendlabs-security-intelligence/exploring-emotet-examining-emotets-activities-infrastructure/) [TrickBot, and DRIDEX for critical attacks. Other publications](https://blog.trendmicro.com/trendlabs-security-intelligence/trickbots-bigger-bag-of-tricks/)\n[have also mentioned observing obfuscation techniques between EMOTET and](https://www.hurricanelabs.com/blog/the-emotet-trojan-a-tale-of-two-malware-samples)\nURSNIF/GOZI-ISFB.\n\nBitPaymer\n\n[This ransomware was used to target medical institutions via remote desktop protocol and](https://www.bleepingcomputer.com/news/security/bit-paymer-ransomware-hits-scottish-hospitals/)\nother email-related techniques, momentarily shutting down routine services for a high\n[ransom. Security researchers later published evidence that not only was DRIDEX dropping](https://mauronz.github.io/deobf-bitpaymer/)\nBitPaymer, but that it also came from the [same cybercriminal group.](https://www.welivesecurity.com/2018/01/26/friedex-bitpaymer-ransomware-work-dridex-authors/)\n\nDuring our analysis, we found evidence that the malware families identified had shared\nloaders: the overview of the payload decryption procedure, and the loaders’ internal data\nstructure. While the first figure of the disassembled PE packers had small differences in their\narithmetic operations’ instructions, we found that the four payload decryption procedures\nwere identical in data structures’ overview on the way they decrypted the actual PE\npayloads.\n\n\n-----\n\n_Figure 2. Overview of identical structures of payloads loader decryption procedures._\n\nFurther analysis also revealed that the internal data structure of the four malware families\nwere the same. We compared the disassembled codes from the samples we had and\nnoticed the encrypted payload address and size placed into the decryption procedure located\nat offset 0x34 and 0x38.\n\n_Figure 3. Identical data structures show similar payload addresses and sizes._\n\n_Figure 4. Data structure used by the shared loader._\n\nAs cybercrime organizational structures in some countries tend to compartmentalize work,\nwe suspect that the four malware families’ gangs might be in contact with the same weapon\nproviders for PE loaders. In addition, it’s also possible that these four cybercrime groups may\nestablish some attributional – working or otherwise – relationships and have exchanged or\ncontinue to exchange resources.\n\nIn our history of monitoring botnets and the underground organizations who make and/or use\nthem, the cybercriminals behind EMOTET may be sharing to collaborate with trusted, highlyskilled cybercriminal groups, and may be a sign of these four groups’ ongoing and intriguing\nrelationship.\n\nAlliances like these could lead to more destructive malware deployments in the future. More\nthan ever, it is important for organizations to heighten cybersecurity preventive measures,\nsuch as establishing policies and procedures for handling security threats. Regular education\nawareness sessions and reminders for employees can help protect the enterprise from\nattacks and intrusions from malicious emails and URLs. Installing and updating a multilayered protection and solution in preventing online banking threats can go a long way in\nsecuring businesses.\n\n**Trend Micro Solutions**\n\n[Trend Micro endpoint solutions such as the Smart Protection Suites and](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) Worry-Free\nBusiness Security solutions can protect users and businesses from threats by detecting\nmalicious files and messages as well as blocking all related malicious URLs. Trend Micro™\nDeep Discovery™ has an email inspection layer that can protect enterprises by detecting\nmalicious attachments and URLs.\n\nTrend Micro XGen™ security provides a cross-generational blend of threat defense\ntechniques to protect systems from all types of threats, including ransomware and\ncryptocurrency-mining malware. It features high-fidelity machine\nlearning on gateways and endpoints, and protects physical, virtual, and cloud workloads.\n\n\n-----\n\nWith capabilities like web/URL filtering, behavioral analysis, and custom sandboxing, XGen\nsecurity can secure systems against modern threats that bypass traditional controls; exploit\nknown, unknown, or undisclosed vulnerabilities; either steal or encrypt personally identifiable\ndata; or conduct malicious cryptocurrency mining. Smart, optimized, and connected, XGen\nsecurity powers Trend Micro’s suite.\n\n**Indicators of Compromise**\n\n**Malware** **SHA256**\n\nURSNIF 9d38a0220b2dfb353fc34d03079f2ba2c7de1d4a234f6a2b06365bfc1870cd89\n\nDRIDEX cbd130b4b714c9bb0a62e45b2e07f3ab20a6db3abd1899aa3ec21f402d25779e\n\nEMOTET 0a47f5b274e803754ce84ebd66599eb35795fb851f55062ff042e73e2b9d5763\n\nBitPaymer d693c33dd550529f3634e3c7e53d82df70c9d4fbd0c339dbc1849ada9e539ea2\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-12-18 - URSNIF, EMOTET, DRIDEX and BitPaymer Gangs Linked by a Similar Loader.pdf"
    ],
    "report_names": [
        "2018-12-18 - URSNIF, EMOTET, DRIDEX and BitPaymer Gangs Linked by a Similar Loader.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535605,
    "ts_updated_at": 1743041321,
    "ts_creation_date": 1653781889,
    "ts_modification_date": 1653781889,
    "files": {
        "pdf": "https://archive.orkl.eu/848c3553ddd041d11de8ae4c343f979d7cc86743.pdf",
        "text": "https://archive.orkl.eu/848c3553ddd041d11de8ae4c343f979d7cc86743.txt",
        "img": "https://archive.orkl.eu/848c3553ddd041d11de8ae4c343f979d7cc86743.jpg"
    }
}