{
    "id": "6d09fa0a-f7a1-4234-96c8-4804a37a23c4",
    "created_at": "2023-01-12T15:07:16.25795Z",
    "updated_at": "2025-03-27T02:06:00.319788Z",
    "deleted_at": null,
    "sha1_hash": "49310614a1bfa458ba8d6b74c23cb82da3ce36d6",
    "title": "2021-06-23 - Deep analysis of REvil Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T18:59:18Z",
    "file_modification_date": "2022-05-28T18:59:18Z",
    "file_size": 462406,
    "plain_text": "# Deep analysis of REvil Ransomware | Written in Korean\n\n**[medium.com/s2wlab/deep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317](https://medium.com/s2wlab/deep-analysis-of-revil-ransomware-written-in-korean-d1899c0e9317)**\n\nS2W June 25, 2021\n\nS2\nW\n\n\n[S2W](https://medium.com/@s2w?source=post_page-----d1899c0e9317--------------------------------)\n\nJun 23, 2021\n\n\n32 min read\n\n**[Author: Sojun Ryu (hypen) @ S2WLAB Talon](https://medium.com/u/c109a5c416ae?source=post_page-----d1899c0e9317--------------------------------)**\n\nWe are working on the English version. Coming soon!\n\n\n-----\n\nPhoto by on\n\n## Executive Summary\n\n μΉ¨ν¬κ³Όμ •\n\n2019λ…„ 4μ›”μ— μ²μ λ“±μ¥ν• REvil λμ„¬μ›¨μ–΄λ” μ΄κΈ° μ¤λΌν΄ μ›Ήλ΅μ§ μ·¨μ•½μ  (CVE-2019β€“\n2725)μ„ μ΄μ©ν•μ—¬ λ‹¤μ–‘ν• ν™κ²½μ— μµμ΄ μΉ¨ν¬λ¥Ό μ‹λ„\nμ΄ν›„ Pulse Secure VPN μ·¨μ•½μ  (CVE-2019β€“11510), FortiOS VPN μ·¨μ•½μ  (CVE-2018β€“\n13379) λ° RDP μ·¨μ•½μ  λ“± μ λ΅λ°μ΄ μ·¨μ•½μ μ΄ μ•„λ‹, ν¨μΉκ°€ μ μ©λκΈ° μ „μ N-day μ·¨μ•½μ μ„\nν†µν•΄ κΈ°μ—… ν™κ²½μ— μΉ¨ν¬λ¥Ό μ‹λ„ν•μ—¬ λ§¤μ° λ§μ€ κΈ°μ—…μ„ κ°μ—Όμ‹ν‚΄\n\n\n-----\n\nμµκ·Όμ—λ” λ‹¤ν¬μ›Ήμ—μ„ μ΄λ―Έ μ λ…ν• μ•…μ„±μ½”λ“μΈ Gootkit, QBot, IcedIdμ™€ κ°™μ€ λ‹¤μ΄λ΅λ“ λ° λ΅\nλ“μ— νΉν™”λ μ•…μ„±μ½”λ“μ— μν•΄ μ‹¤ν–‰λ¨\n\n## μ£Όμ” νΉμ§•\n\nμ•”νΈν™” ν‚¤ κµν™ μ‹, λμ„¬μ›¨μ–΄ μ•…μ„±μ½”λ“λ“¤μ΄ μ£Όλ΅ μ‚¬μ©ν•λ” RSAλ¥Ό μ‚¬μ©ν•μ§€ μ•κ³  νƒ€μ› κ³΅μ„ \nκΈ°λ° μ•”νΈ(Elliptic Curve Cryptography)λ¥Ό μ‚¬μ©ν•λ©°, νμΌ μ•”νΈν™”μ—λ” Salsa20 μ•κ³ λ¦¬μ¦μ„\nμ΄μ©ν•μ—¬ νμΌμ„ μ•”νΈν™”\nλ΅μ»¬ λ“λΌμ΄λΈ λ‚΄ νμΌ λΏλ§ μ•„λ‹λΌ μ›κ²© λ“λΌμ΄λΈ λ° κ³µμ  λ“λΌμ΄λΈ λ‚΄ νμΌλ„ μ•”νΈν™”ν•\nλ©°, IOCPκΈ°λ²•μ„ μ‚¬μ©ν• λΉ„λ™κΈ° I/Oλ°©μ‹μΌλ΅ μ•”νΈν™” μ†λ„λ¥Ό λ†’μ„\n2019λ…„ 12μ›”λ¶€ν„° μμ²΄ Leak μ‚¬μ΄νΈλ¥Ό μ΄μν•μ—¬ ν”Όν•΄ κΈ°μ—…μΌλ΅λ¶€ν„° νƒμ·¨ν• λ°μ΄ν„°λ¥Ό κ²μ‹\nν•λ©°, ν‘μƒμ— μ‘ν•μ§€ μ•μ„ μ‹ λ°μ΄ν„°λ¥Ό κ³µκ°ν•λ” μ΄μ¤‘ κ°μ·¨ μ „λµμ„ μ‚¬μ©.\nλΉ„νΈμ½”μΈμ„ ν†µν•΄ λΈκ°’μ„ μ§€λ¶λ°›λ‹¤κ°€ 2020λ…„ 4μ›”λ¶€ν„° λ¨λ„¤λ΅λ΅ λ³€κ²½ν•¨. ν•μ§€λ§ μµκ·Όμ—λ” ν”Ό\nν•΄μκ°€ λΉ„νΈμ½”μΈμΌλ΅ μ§€λ¶μ„ μ›ν•  μ‹, 10% μ¶”κ°€ κΈμ•΅μ„ λ‚Ό κ²½μ° λΉ„νΈμ½”μΈμΌλ΅λ„ μ§€λ¶λ°›μ\n2021λ…„ 2μ›”λ¶€ν„°λ” κΈ°μ΅΄ Leak μ‚¬μ΄νΈλ¥Ό ν†µν• μ΄μ¤‘ κ°μ·¨ μ „λµμ—μ„ ν™νμ΄μ§€ DDoS κ³µκ²© λ°\nν”Όν•΄ κΈ°μ—…μ λΉ„μ¦λ‹μ¤ ννΈλ„μ—κ² VoIPλ΅ μ—°λ½ν•λ” ν‘λ°• λ°©μ‹μ„ μ¶”κ°€ν•κ² λ‹¤κ³  μ–ΈκΈ‰\n\n## μµκ·Ό μ΄μ\n\nμµκ·Ό Darksideμ Colonial Pipeline κ³µκ²©, REvil λμ„¬μ›¨μ–΄μ JBS κ³µκ²© μ΄ν›„λ΅ λ―Έκµ­μ΄ λμ„¬μ›¨\nμ–΄ κ³µκ²©μ— κ°•λ ¥ν•κ² λ€μ²ν•κ² λ‹¤λ” λ°ν‘ ν›„, REvilμ€ μ¤νλ ¤ λ―Έκµ­μ— λ€ν• κ³µκ²©μ„ λ©μ¶”μ§€ μ•\nκ³ , λ”μ± λ” κ°•ν™”ν•κ² λ‹¤κ³  μ–ΈκΈ‰ν•¨\nν„μ¬κΉμ§€ REvil λμ„¬μ›¨μ–΄ μ΅°μ§μ€ Darkside λμ„¬μ›¨μ–΄ μ΅°μ§, LV λμ„¬μ›¨μ–΄ μ΅°μ§κ³Ό\nPrometheus μ΅°μ§κΉμ§€ μµμ† 3κ°μ λμ„¬μ›¨μ–΄ μ΅°μ§κ³Ό μ—°κ΄€λμ–΄μμ\n\n\n-----\n\nOverall flow of REvil Ransomware\n\n## Malware Information\n```\n : 2075566e7855679d66705741dabe82b4 : 136443e2746558b403ae6fc9d9b40bfa92b23420 :\n12d8bfa1aeb557c146b98f069f3456cc8392863a2f4ad938722cd7ca1a773b39: 2021β€“03β€“21 21:46:43 :\nWin32 EXE file\n\n Detailed Analysis\n\n 1. RC4 μ•κ³ λ¦¬μ¦μ„ μ΄μ©ν•μ—¬ λ°μ΄ν„° λ³µνΈν™”\n\n```\n\n-----\n\nREvil λμ„¬μ›¨μ–΄λ” RC4μ•κ³ λ¦¬μ¦μ„ μ΄μ©ν•μ—¬ μ•…μ„±μ½”λ“ λ‚΄λ¶€μ— ν¬ν•¨λ Win32 APIν•¨μ μ£Όμ†, μ„¤μ •\nμ •λ³΄ λ° λ¬Έμμ—΄μ„ λ³µνΈν™”ν•κ³  μ•…μ„± ν–‰μ„μ— μ‚¬μ©ν•λ‹¤. μ•…μ„±μ½”λ“λ§λ‹¤ μ‚¬μ©λλ” keyλ” μƒμ΄ν•λ‹¤.\n\n```\nRC4 key : 9UAo1qQ8ce4w13Jv36xcPgMz6NCykVjs\n\n```\n\n## 2. μƒμ„Έ μµμ…μ„ ν†µν•΄ μ„Έλ¶€ κΈ°λ¥ μ„¤μ •\n\nλ³µνΈν™”λ μ •λ³΄ μ¤‘ μ•…μ„± ν–‰μ„μ— ν•„μ”ν• 19κ°μ μƒμ„Έ μµμ…μ΄ JSON ν•νƒλ΅ ν‘ν„λμ–΄ μλ‹¤. λ¶„μ„ν•\nμƒν”μΈ 2.05 λ²„μ „μ κ° μµμ…λ³„ κΈ°λ¥μ€ μ•„λμ™€ κ°™λ‹¤.\n\nTable 1. μƒμ„Έ μµμ…ν‘\n\n## 3. μ•”νΈν™” μ‚¬μ „ μ‘μ—…\n\n\n-----\n\nREvil λμ„¬μ›¨μ–΄λ” κΈ°μ΅΄ λμ„¬μ›¨μ–΄ κ·Έλ£Ήλ“¤μ΄ μ£Όλ΅ μ‚¬μ©ν•λ” RSAμ™€ AES μ•κ³ λ¦¬μ¦ μ΅°ν•©μ„ μ‚¬μ©ν•\nμ§€ μ•κ³ , ECC Diffie hellman ν‚¤ κµν™κ³Ό AES-256μ΄ κ²°ν•©λ ECIES κ³µκ°ν‚¤ μ•κ³ λ¦¬μ¦κ³Ό Salsa20\nλΉ„λ°€ν‚¤ μ•κ³ λ¦¬μ¦μΌλ΅ νμΌ λ° λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•λ‹¤. μ΄λ¥Ό μ„ν•΄ μ•…μ„±μ½”λ“ λ‚΄μ— ν•λ“μ½”λ”© λ keyλ¥Ό\nμ΄μ©ν•μ—¬ μ•”νΈν™”μ— ν•„μ”ν• κµ¬μ΅°μ²΄ λ°μ΄ν„°λ¥Ό μ‚¬μ „μ— μƒμ„±ν•λ©°, μ΄λ¥Ό λ μ§€μ¤νΈλ¦¬μ— μ €μ¥ν•μ—¬ μ¬μ‹¤\nν–‰λμ–΄λ„ κΈ°μ΅΄μ— μƒμ„±λ keyλ¥Ό μ‚¬μ©ν•¨μΌλ΅μ¨ ν•΄λ‹Ή κ°’μ΄ λ°”λ€μ§€ μ•λ„λ΅ ν•λ‹¤. μ‚¬μ©λλ” λ μ§€μ¤νΈ\nλ¦¬λ” REvil λμ„¬μ›¨μ–΄ λ²„μ „λ³„λ΅ μƒμ΄ν•λ‹¤.\n\nEcryption Flow\n1) λ μ§€μ¤νΈλ¦¬ path : HKLM\\SOFTWARE\\BlackLivesMatter\n\n`key : 54k => value : κ³µκ²©μ` κ³µκ°ν‚¤ (pk)key : aOwO => value : νμΌ μ•”νΈν™” keyμƒμ„±μ— μ‚¬μ©λ κ³µκ°\nν‚¤ (pk_key)key : Krdfp => value : κ³µκ²©μ κ³µκ°ν‚¤λ΅ μ•”νΈν™”λ λΉ„λ°€ν‚¤ κµ¬μ΅°μ²΄ (sk_key struct)key :\n`hq0G6x => value : μ μ‘μ` λ§μ¤ν„°ν‚¤λ΅ μ•”νΈν™”λ λΉ„λ°€ν‚¤ κµ¬μ΅°μ²΄ (0_key struct)\n\n\n-----\n\n2) HKLM κ²½λ΅μ— λ“±λ΅ μ‹¤ν¨ μ‹ HKCUλ΅ λ³€κ²½ν•μ—¬ λ“±λ΅ μ‹λ„\n\n## 4. κ°μ—ΌκΈ°κΈ° μ •λ³΄ μμ§‘\n\nμ΄ν›„ κ°μ—Όλ κΈ°κΈ°μ μ •λ³΄λ¥Ό μμ§‘ν•λ‹¤. μμ§‘ λ©λ΅μ€ μ•„λμ™€ κ°™λ‹¤.\n\n1) κ°μ—ΌκΈ°κΈ° μ‹λ³„ κ°’ (UID)\n\nν„μ¬ λ””μ¤ν¬μ VolumeSerialκ³Ό ν”„λ΅μ„Έμ„ μ΄λ¦„μ„ μμ§‘\nκ°κ°μ CRC32 μ²΄ν¬μ„¬ κ°’μ„ μ΅°ν•©ν• 16κΈ€μ λ¬Έμμ—΄\nμμ‹ : 3EE1CF8D0ECB68EF\n\n2) μ•”νΈν™” ν™•μ¥μ (Extension)\n\n5~10κ°μ λλ¤ λ¬Έμ μ΅°ν•© λ¬Έμμ—΄ (κΈ°μ΅΄ ν™”μ΄νΈλ¦¬μ¤νΈμ— ν¬ν•¨λμ§€ μ•μ€)\nμμ‹ : 670o6j8nm\nμ΄ν›„ λ μ§€μ¤νΈλ¦¬μ— μƒμ„±ν• λλ¤ ν™•μ¥μ μ €μ¥\nPath : HKLM\\ SOFTWARE\\\\BlackLivesMatter\nKey : x4WHjRs β†’ value : [λλ¤ ν™•μ¥μ]\nHKLM κ²½λ΅μ— λ“±λ΅ μ‹¤ν¨ μ‹ HKCUλ΅ κ²½λ΅ λ³€κ²½\n\n3) μ μ €λ…\n\n4) μ»΄ν“¨ν„°λ…\n\n5) ν„μ¬ κΈ°κΈ°μ λ„λ©”μΈλ… λ„λ©”μΈμ΄ μ—†μ„ κ²½μ° WORKGROUPμΌλ΅ μ§€μ •\n\n6) ν„μ¬ μ§€μ—­ λ° μ‚¬μ© μ–Έμ–΄\n\n7) ν„μ¬ μ μ €μ μ‚¬μ© μ–Έμ–΄, μ‹μ¤ν…μ κΈ°λ³Έ μ–Έμ–΄, ν‚¤λ³΄λ“ layoutμ„ μμ§‘ ν›„ CIS κµ­κ°€ μ—¬λ¶€ ν™•μΈ\n\n8) μ΄μμ²΄μ  λ²„μ „\n\n9) λ””μ¤ν¬ λ³„ μ „μ²΄ μ©λ‰ λ° μ‚¬μ© κ°€λ¥ν• μ©λ‰\n\n10) μ»΄ν“¨ν„° x86, x64 μ—¬λ¶€\n\n## 5. CISκµ­κ°€ μ—¬λ¶€ ν™•μΈ\n\nμƒμ„Έ μµμ… μ¤‘ dbgμµμ…μ΄ FalseμΌ κ²½μ°, μ•„λμ™€ κ°™μ΄ μ μ € λ° μ‹μ¤ν… μ–Έμ–΄, ν‚¤λ³΄λ“ layoutμ„ ν™•μΈν•\nμ—¬ CIS(λ…λ¦½κµ­κ°€μ—°ν•©) μ§€μ—­μ κΈ°κΈ°μΌ κ²½μ° μ•…μ„± ν–‰μ„λ¥Ό μν–‰ν•μ§€ μ•λ”λ‹¤. λ°λ©΄ dbg μµμ…μ΄ True\nμΌ κ²½μ° κ³µκ²©μλ“¤μ λ””λ²„κΉ…μ©μΌλ΅ μ‹¤ν–‰λλ©° μ–Έμ–΄ λ° layoutμ„ ν™•μΈν•μ§€ μ•λ”λ‹¤.\n\n\n-----\n\nTable 2. μ μ €/μ‹μ¤ν… μ–Έμ–΄μ™€ ν‚¤λ³΄λ“ λ μ΄μ•„μ›ƒ\n\n## 6. νλΌλ―Έν„°λ¥Ό ν†µν• μ‹¤ν–‰ λ¨λ“ μ§€μ •\n\n\n-----\n\nTable 3. νλΌλ―Έν„° λ©λ΅\n\n`-nolan: λ„¤νΈμ›ν¬` κ³µμ λ“λΌμ΄λΈλ” κ°μ—Ό λ€μƒμ—μ„ μ μ™Έ\n\n1) νλΌλ―Έν„°λ΅ μ£Όμ–΄μ§€μ§€ μ•μ€ κ²½μ°, λ„¤νΈμ›ν¬ λ“λΌμ΄λΈ μ•”νΈν™” μ‹λ„\n\n2) μ›κ²© λ“λΌμ΄λΈ μ•”νΈν™”: A~Zλ“λΌμ΄λΈ μ¤‘ μ›κ²© λ“λΌμ΄λΈ λ‚΄ νμΌ μ•”νΈν™”\n\n3) κ³µμ  λ“λΌμ΄λΈ\n\nν„μ¬ μ—°κ²°λ λ¨λ“  κ³µμ  λ¦¬μ†μ¤ λ‚΄ νμΌ μ•”νΈν™”\nλ„¤νΈμ›ν¬ μ»¨ν…μ¤νΈ λ‚΄ λ¨λ“  κ³µμ  λ¦¬μ†μ¤ λ‚΄ νμΌ μ•”νΈν™”\nλ„¤νΈμ›ν¬μ λ¨λ“  κ³µμ  λ¦¬μ†μ¤ λ‚΄ νμΌ μ•”νΈν™”\nμκµ¬μ μΌλ΅ μ—°κ²°λ λ¨λ“  κ³µμ  λ¦¬μ†μ¤ λ‚΄ νμΌ μ•”νΈν™”\n\n\n-----\n\nμµκ·Ό μ—°κ²°λ λ¨λ“  κ³µμ  λ¦¬ μ†μ¤ λ‚΄ νμΌ μ•”νΈν™”\n\n`-nolocal:` λ΅μ»¬ λ“λΌμ΄λΈλ” κ°μ—Ό λ€μƒμ—μ„ μ μ™Έ\n\n1) νλΌλ―Έν„°λ΅ μ£Όμ–΄μ§€μ§€ μ•μ€ κ²½μ°, λ΅μ»¬ λ“λΌμ΄λΈ μ•”νΈν™” μ‹λ„\n\n2) λ΅μ»¬ λ“λΌμ΄λΈ μ•”νΈν™”: A~Zλ“λΌμ΄λΈ μ¤‘, μ΄λ™μ‹ λ° μΌλ° λ“λΌμ΄λΈ λ‚΄ νμΌ μ•”νΈν™”\n\n`-smode:` μλ„μ° κ³„μ • λΉ„λ°€λ²νΈ λ³€κ²½ λ° μ•μ „λ¨λ“λ΅ μ¬λ¶€ν…\n\n1) μ•μ „λ¨λ“ λ¶€ν…μ΄ μ•„λ‹, μ •μƒ λ¨λ“λ΅ λ¶€ν…λμ—μ„ κ²½μ°μ—λ§ λ™μ‘\n\n2) μ•μ „λ¨λ“μ—μ„ μ•”νΈν™”λ¥Ό ν•  κ²½μ°, λ°±μ‹  νƒμ§€λ¥Ό μ°νν•κ³  νμΌ μ•”νΈν™”μ μ„±κ³µλ¥ μ΄ λ†’μ•„μ§ μ μ\nμ\n\n3) ν„μ¬ κ³„μ •μ λΉ„λ°€λ²νΈλ¥Ό β€DTrump4everβ€λ΅ λ³€κ²½\n\n4) λ μ§€μ¤νΈλ¦¬λ¥Ό λ³€κ²½ν•μ—¬ λ³€κ²½λ λΉ„λ°€λ²νΈλ΅ μλ™ λ΅κ·ΈμΈλλ„λ΅ μ„¤μ •\n\nPath : HKLM\\ SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\nKey : AutoAdminLogon β†’ value : 1\nKey : DefaultUserName β†’ value : ν„μ¬ μ μ € λ…\nKey : DefaultPassword β†’ value : DTrump4ver\n\n5) λ μ§€μ¤νΈλ¦¬ λ³€κ²½ ν›„ μ¬λ¶€ν… μ™„λ£μ‹ μ•…μ„±μ½”λ“ μ¬μ‹¤ν–‰ λ° λ¶€ν… λ¨λ“ μ •μƒ λ¨λ“λ΅ λ³µκµ¬\n\nPath : HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\nKey : *AstraZeneca β†’ value : μ•…μ„±μ½”λ“ νμΌ λ…\n(Vista μ΄μ „) Key : *MarineLePen β†’ value : bootcfg /raw /fastdetect /id 1\n(Vista μ΄ν›„) Key : *MarineLePen β†’ value : bcdedit /deletevalue {current} safeboot\n\n6) μ„¤μ • ν›„, λ¶€ν… λ¨λ“λ¥Ό λ„¤νΈμ›ν¬ κ°€λ¥ν• μ•μ „λ¨λ“λ΅ λ³€κ²½ν•λ” λ…λ Ήμ–΄ μ‹¤ν–‰\n\n(Vista μ΄μ „) λ…λ Ήμ–΄ : bootcfg /raw /a /safeboot:network /id 1\n(Vista μ΄ν›„) λ…λ Ήμ–΄ : bcdedit /set {current} safeboot network\n\n7) μ„¤μ • μ™„λ£ ν›„ κ°μ—ΌκΈ°κΈ° μ¬λ¶€ν…\n\nλ…λ Ήμ–΄ : SHUTDOWN -r -f -t 02\n2μ΄ ν›„ μ‹μ¤ν…μ„ κ°•μ λ΅ μ¬λ¶€ν…\n\n`-silent:` νΉμ • μ„λΉ„μ¤, ν”„λ΅μ„Έμ¤ μΆ…λ£ λ° λ³Όλ¥¨ μ„€λ„μ° μΉ΄ν”Ό μ‚­μ  μν–‰ν•μ§€ μ•μ\n\n1) νλΌλ―Έν„°λ΅ μ£Όμ–΄μ§€μ§€ μ•μ€ κ²½μ°, νΉμ • μ„λΉ„μ¤μ™€ ν”„λ΅μ„Έμ¤ μΆ…λ£ λ° λ³Όλ¥¨ μ„€λ„μ° μΉ΄ν”Ό μ‚­μ \n\n2) Win32 APIλ¥Ό μ΄μ©ν•μ—¬ ν„μ¬ μ‹¤ν–‰ μ¤‘μΈ νΉμ • ν”„λ΅μ„Έμ¤ μΆ…λ£\n\n3) WMIλ΅ μ‹ κ· ν”„λ΅μ„Έμ¤ μƒμ„± Eventλ¥Ό λ¨λ‹ν„°λ§ν•μ—¬ νΉμ • ν”„λ΅μ„Έμ¤ μƒμ„± μ‹ μΆ…λ£\n\n\n-----\n\n4) νΉμ • ν”„λ΅μ„Έμ¤ λ©λ΅\n\n5) Win32 APIλ¥Ό μ΄μ©ν•μ—¬ ν„μ¬ μ‹¤ν–‰ μ¤‘μΈ νΉμ • μ„λΉ„μ¤ μΆ…λ£\n\n6) WMIλ΅ μ„λΉ„μ¤ λ³€λ™μ‚¬ν•­ Eventλ¥Ό λ¨λ‹ν„°λ§ν•μ—¬ νΉμ • μ„λΉ„μ¤ μ‹¤ν–‰ μ‹ μ¤‘μ§€\n\n7) νΉμ • μ„λΉ„μ¤ λ©λ΅\n\n\n-----\n\n8) WQL(SQL for WMI) μΏΌλ¦¬λ¥Ό μ΄μ©ν•μ—¬ κ°μ—Όλ κΈ°κΈ°μ Volume Shadow Copyλ¥Ό λ¨λ‘ μ‚­μ \n\nWQL Query : SELECT * FROM Win32_ShadowCopy\nμ΄ν›„ Win32_ShadowCopy.ID=[μ΅°νν• ID]μ— λ€ν•μ—¬ DeleteInstance μ‘μ—… μν–‰\n\n`-path:` νΉμ • κ²½λ΅μ— λ€ν•΄μ„λ§ μ•”νΈν™” μ§„ν–‰\n\n1) μ£Όμ–΄μ§„ κ²½λ΅μ— λ€ν•΄μ„λ§ νμΌ μ•”νΈν™” μ§„ν–‰\n\n2) λ„¤νΈμ›ν¬ λ° λ΅μ»¬ κ²½λ΅ μ—¬λ¶€ ν™•μΈν•μ—¬ μ§„ν–‰\n\n3) μ „μ²΄ νμΌ μ•”νΈν™” μ „μ— κ³µκ²©μκ°€ ν…μ¤νΈ μ©λ„λ΅ μ‚¬μ©ν•λ” κΈ°λ¥\n\n\n-----\n\n-pathλ΅ μ‹¤ν–‰λ  κ²½μ° κ¶ν• μƒμΉ, μ •λ³΄μ μ¶, λ°”νƒ•ν™”λ©΄ λ³€κ²½ λ“±μ„ μν–‰ν•μ§€ μ•μ\n\n`-fast:` λΉ λ¥Έ μ•”νΈν™” λ¨λ“\n\n1) -pathμ™€ ν•¨κ» μ‚¬μ©λλ©°, νμΌ μ•”νΈν™” μ‹ μƒμ„ 0x100000λ§ μ•”νΈν™”λ¥Ό μν–‰\n\n2) μƒμ„Έ μµμ… μ¤‘ etκ°€ 1μΌ λ•μ™€ λ™μΌ\n\n`-full:` μ „μ²΄ μ•”νΈν™” λ¨λ“\n\n1) -pathμ™€ ν•¨κ» μ‚¬μ©λλ©°, νμΌ μ•”νΈν™” μ‹ νμΌ μ „μ²΄μ— λ€ν•΄μ„ μ•”νΈν™”λ¥Ό μν–‰\n\n2) μƒμ„Έ μµμ… μ¤‘ etκ°€ 0μΌ λ•μ™€ λ™μΌ\n\n## 7. λ™μ‘ κ³Όμ •\n\n**1) λ®¤ν…μ¤** μƒμ„±\n\nμ•…μ„±μ½”λ“μ μ¤‘λ³µ μ‹¤ν–‰ λ°©μ§€λ¥Ό μ„ν•΄ νΉμ • λ¬Έμμ—΄μ„ μ΄μ©ν•μ—¬ λ®¤ν…μ¤ μƒμ„±\n\nλ®¤ν…μ¤ λ… : Global\\\\F69C27FF-AB15-CCAA-A2D6β€“7F7ADA90E7E3\nλ¬Έμμ—΄μ€ μ•…μ„±μ½”λ“λ§λ‹¤ λ‹¤λ¥Έ κ°’μ„ μ‚¬μ©\nμ¤‘λ³µ μ‹¤ν–‰ μ‹ ν„μ¬ ν”„λ΅μ„Έμ¤λ¥Ό μΆ…λ£\n\n**2) μƒμ„Έ** μµμ… `exp (Table 1. μƒμ„Έ` μµμ…ν‘ μ°Έκ³ )μ— λ”°λ¥Έ ν–‰μ„ μν–‰\n\nμ μ €κ°€ κ΄€λ¦¬μ κ¶ν•μ„ κ°–κ³  μμ§€λ§, ν”„λ΅μ„Έμ¤κ°€ κ΄€λ¦¬μ κ¶ν•μ„ κ°–μ§€ μ•μ€ κ²½μ° ν”„λ΅μ„Έμ¤ μ¬\nμ‹¤ν–‰\nμ μ €κ°€ μΉλ‚™ν•  λ•κΉμ§€ κ΄€λ¦¬μ κ¶ν•μΌλ΅ μ‹¤ν–‰μ„ μ”κµ¬ν•λ” UAC μλ½ μ”μ²­ μ°½μ„ ν™”λ©΄ μƒμ— κ³„\nμ† ν‘μ¶\n\n**3) μ•”νΈν™”** μ‘μ—… μ „ κΈ°νƒ€ ν–‰μ„\n\nκ°•μ λ΅ ν΄μ§€ν†µ λΉ„μ°κΈ°\nν”„λ΅μ„Έμ¤μ CPU μ¤μΌ€μ¤„λ§ μ°μ„ μμ„λ¥Ό μΌλ° ν”„λ΅μ„Έμ¤λ³΄λ‹¤ ν• λ‹¨κ³„ μƒμΉμ‹μΌ λ¦¬μ†μ¤ μ‚¬μ©\nν”„λ΅μ„Έμ¤κ°€ μ‹¤ν–‰λλ” λ„μ¤‘ μ μ „ λ¨λ“ μ „ν™ λ° λ””μ¤ν”λ μ΄ κΊΌμ§ λ°©μ§€\nSeDebugPrivilege κ¶ν•μ„ ν• λ‹Ήν•μ—¬ νƒ€ ν”„λ΅μ„Έμ¤μ— μ ‘κ·Ό κ°€λ¥ν•λ„λ΅ κ¶ν• μ„¤μ •\n\n**4) μƒμ„Έ** μµμ… `arn (Table 1. μƒμ„Έ` μµμ…ν‘ μ°Έκ³ ) μ— λ”°λ¥Έ ν–‰μ„ μν–‰\n\nλ μ§€μ¤νΈλ¦¬λ¥Ό λ³€κ²½ν•μ—¬ κΈ°κΈ°λ¥Ό μ¬λ¶€ν…ν•λ”λΌλ„ μ•…μ„±μ½”λ“κ°€ μ‹¤ν–‰λλ„λ΅ μ„¤μ •\n\nPath : HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nKey : 3\"qZhotTgfr3 β†’ value : μ•…μ„±μ½”λ“ νμΌ λ…\nHKLM κ²½λ΅μ— λ“±λ΅ μ‹¤ν¨ μ‹ HKCUλ΅ λ³€κ²½\n\n**5) λ°”νƒ•ν™”λ©΄** λ³€κ²½\n\n\n-----\n\n1. λ°”νƒ•ν™”λ©΄μ„ νλ€μƒ‰ λ°°κ²½μ— μμ‹ λ“¤μ λ©”μ‹μ§€κ°€ λ‹΄κΈ΄ μ΄λ―Έμ§€λ΅ λ³€κ²½\n\nμ›λ³Έ μ΄λ―Έμ§€ νμΌ κ²½λ΅ : %temp%\\[λλ¤ 3~13κ°μ λ¬Έμμ—΄].bmp\nμ•„λλ” μƒμ„Έ μµμ… imgμ— λ…μ‹λ ν‘λ°• λ©”μ‹μ§€μ΄λ©°, ν‘λ°• λ©”μ‹μ§€ μƒμ— instuctions μ€\ninstructionμ μ¤νƒ€μ„\n```\nAll of Your fiels are encrypted!Find [Random Extension]-readme.txt and follow\ninstuctions\n\n```\nμ‹¤μ  λ³€κ²½λ λ°”νƒ•ν™”λ©΄\n\nCompromised Background\n**6) μƒμ„Έ** μµμ… `net` μ— λ”°λ¥Έ ν–‰μ„ μν–‰\n\n\n-----\n\n1. JSON ν•νƒλ΅ κ°μ—ΌκΈ°κΈ° μ •λ³΄ λ° μ•”νΈν™”μ— μ‚¬μ©λ μ •λ³΄ μμ§‘\n\n`{  \"ver\": [REvil λμ„¬μ›¨μ–΄` λ²„μ „],  \"pid\": [μ•…μ„±μ½”λ“ μ‹λ³„μ], (μƒμ„Έμµμ…μ— λ…μ‹λ¨)  \"sub\":\n\n`[μ•…μ„±μ½”λ“` μ‹λ³„μ], (μƒμ„Έμµμ…μ— λ…μ‹λ¨)  \"pk\": [μ•”νΈν™”μ— μ‚¬μ©λ κ³µκ°ν‚¤ μ •λ³΄], (μƒμ„Έμµμ…μ— λ…μ‹λ¨)\n`\"uid\": [Victim ID],  \"sk\": [sk_key struct(λΉ„λ°€ν‚¤` κµ¬μ΅°μ²΄)],  \"unm\": [μ μ € λ…],  \"net\":\n\n`[μ»΄ν“¨ν„°` λ…],  \"grp\": [λ„λ©”μΈ λ…],  \"lng\": [μ§€μ—­ λ° μ‚¬μ©μ–Έμ–΄],  \"bro\": [CIS κµ­κ°€ μ—¬λ¶€],\n`\"os\": [μ΄μμ²΄μ ` λ²„μ „],  \"bit\": [32bit λλ” 64bit μ—¬λ¶€],  \"dsk\": [λ””μ¤ν¬ λ³„ μ „μ²΄ μ©λ‰ λ° μ‚¬\nμ© κ°€λ¥ν• μ©λ‰ μ •λ³΄],  \"ext\": [μ•”νΈν™” ν™•μ¥μ]\"}\n\n2. λ¨λ“  μ •λ³΄λ¥Ό μ·¨ν•©ν• λ’¤, νμΌκ³Ό λ™μΌν• λ°©μ‹μΌλ΅ λ°μ΄ν„°λ¥Ό μ•”νΈν™”\n\nλ°μ΄ν„° μ•”νΈν™”μ—λ” μ•…μ„±μ½”λ“ λ‚΄μ— λ³„λ„λ΅ ν•λ“μ½”λ”©λ κ³µκ° key μ‚¬μ©\n\n3. μ•”νΈν™”ν• λ°μ΄ν„°λ¥Ό λ μ§€μ¤νΈλ¦¬μ— μ €μ¥\n\nPath : HKLM\\SOFTWARE\\BlackLivesMatter\nKey : XFx41h1r β†’ value : [μ•”νΈν™” λ κ°μ—ΌκΈ°κΈ° μ •λ³΄ λ° μ•”νΈν™”μ— μ‚¬μ©λ μ •λ³΄]\nHKLM κ²½λ΅μ— λ“±λ΅ μ‹¤ν¨ μ‹ HKCUλ΅ λ³€κ²½\n\n4. μƒμ„Έ μµμ… μ¤‘ `dmn μ—` μ €μ¥λμ–΄ μλ” λ„λ©”μΈ λ³„λ΅ μ•„λ κ·Έλ¦Όκ³Ό κ°™μ΄ νΉμ • λ¬Έμμ—΄μ„ μ΅°ν•©ν•μ—¬\nλλ¤ URL μ£Όμ† μƒμ„±ν•μ—¬ μ ‘μ† μ‹λ„\n\n\n-----\n\nURL μ£Όμ† μƒμ„± λ°©μ‹\n5. λ„λ©”μΈλ³„λ΅ μƒμ„±λ URLμ£Όμ†λ΅ μμ§‘ν• κ°μ—ΌκΈ°κΈ° μ •λ³΄ λ©λ΅ μ „μ†΅\n\nUser-agent : Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,\nlike Gecko) Chrome/84.0.4147.125 Safari/537.36\nMethod : POST\nHeader : Content-Type: application/octet-stream\nHeader : Connection: close\n\n**7) λ©”λ¨λ¦¬** μ •λ¦¬\n\n1. κ°μ—Όμ •λ³΄ μ „μ†΅κ³Ό λ¨λ“  νμΌ μ•”νΈν™”λ¥Ό λ§μΉ λ’¤ κ΄€λ ¨ λ°μ΄ν„°λ¥Ό λ¨λ‘ μ •λ¦¬\n\n\n-----\n\n2. μƒμ„Έ μµμ… λ° μ•”νΈν™”μ— μ‚¬μ©λ ν‚¤ μ •λ³΄, κ°μ—ΌκΈ°κΈ° μ •λ³΄κ°€ ν• λ‹Ήλ λ©”λ¨λ¦¬λ¥Ό λ¨λ‘ ν•΄μ ν•¨\n\n**8) νμΌ** μ‚­μ \n\n1. μ¬λ¶€ν…λ  κ²½μ° μ•…μ„±μ½”λ“κ°€ μ‚­μ λλ„λ΅ μ„¤μ •\n\n## 8. νμΌ μ•”νΈν™” Thread\n\n**1) Input/output completion port (IOCP)λ¥Ό** μ΄μ©ν• μ•”νΈν™” μ‘μ—… μν–‰\n\nREvil λμ„¬μ›¨μ–΄λ” IOCPλ¥Ό μ΄μ©ν• λΉ„λ™κΈ° μ…μ¶λ ¥ λ°©μ‹μΌλ΅ λΉ λ¥Έ μ•”νΈν™”λ¥Ό μν–‰ν•¨\nκ°μ—Ό κΈ°κΈ°μ ν”„λ΅μ„Έμ„ κ°―μ * 2κ°μ μ•”νΈν™” μ „λ‹΄ Thread μƒμ„±\n\n**2) ECIES()λ¥Ό** μ΄μ©ν• νμΌ μ•”νΈν™”\n\nREvil λμ„¬μ›¨μ–΄λ” ECC Diffie Hellman ν‚¤ κµν™ λ°©μ‹μ„ μ‚¬μ©ν•μ—¬ ν‚¤ κµν™μ„ μ‹λ„ν•¨\nν‚¤ μƒμ„±μ—λ” Curve25519λ¥Ό μ‚¬μ©ν•λ”λ°, μ΄λ” κ°€μ¥ λΉ λ¥Έ κ³΅μ„  μ¤‘ ν•λ‚λ΅ μ•λ ¤μ§\nλμ„¬μ›¨μ–΄ λ°”μ΄λ„λ¦¬ λ‚΄μ— λ―Έλ¦¬ ν¬ν•¨λμ–΄ μλ” pk (Attacker Key)λ¥Ό μ΄μ©ν•μ—¬ μ‹¤μ  νμΌ μ•”νΈ\nν™”μ— μ‚¬μ©λλ” dk_keyμ— λ€ν• μ•”νΈν™” μ§„ν–‰\npk μ™Έμ— Master Keyκ°€ μ΅΄μ¬ν•λ”λ°, μ΄λ” REvil λμ„¬μ›¨μ–΄μ λ©”μ΄μ € λ²„μ „λ§λ‹¤ λ™μΌν• κ°’μ„ κ°€\nμ§€λ©°, REvil λμ„¬μ›¨μ–΄ μ μ‘μκ°€ μ–Έμ λ“ μ§€ νμΌμ„ λ³µνΈν™”ν•  μ μλ” μ©λ„λ΅ μ‚¬μ©λ¨\n\n\n-----\n\nMaster keyμ™€ Attacke keyλ¥Ό μ΄μ©ν• dk_key κ°λ³„ μ•”νΈν™”\n**3) μ•”νΈν™”** λ€μƒμ—μ„ νΉμ • νμΌ, ν΄λ” λ° ν™•μ¥μ μ μ™Έ\n\nμ΄μμ²΄μ μ™€ κ΄€λ ¨λκ±°λ‚ μ¤‘μ”λ„κ°€ λ‚®μ€ ν΄λ”λ¥Ό μ•”νΈν™” λ€μƒμ—μ„ μ μ™Έ\n\n\n-----\n\nλ¶€ν… λλ” μ΄μμ²΄μ  κ΄€λ ¨ νμΌμ„ μ•”νΈν™” λ€μƒμ—μ„ μ μ™Έ\n\n\n-----\n\nμ‹¤ν–‰ ν”„λ΅κ·Έλ¨ λλ” μ¤ν¬λ¦½νΈλ“±κ³Ό κ°™μ€ λ¶ν•„μ”ν• ν™•μ¥μλ¥Ό κ°μ—Ό λ€μƒμ—μ„ μ μ™Έ\n\n\n-----\n\nνƒ€κ² νμΌμ— μ ‘κ·Ό μ¤‘μΈ μ„λΉ„μ¤ λ° ν”„λ΅μ„Έμ¤ μ¤‘ μ•„λ ν”„λ΅μ„Έμ¤λ¥Ό μ μ™Έν• μ„λΉ„μ¤μ™€ ν”„λ΅μ„Έμ¤\nλ¥Ό λ¨λ‘ μΆ…λ£\n\n\n-----\n\nνμΌμ λ§μ§€λ§‰ 176byteμ„μΉμ 32byteλ¥Ό μ½μ€ λ’¤ CRC32 checksumμ΄ λ§μ§€λ§‰ 216byteμ„μΉ\nμ 4byteκ°’κ³Ό λ™μΌν• κ²½μ°, μ΄λ―Έ μ•”νΈν™”κ°€ λ νμΌλ΅ νλ‹¨ν•μ—¬ μ•”νΈν™” λ€μƒμ—μ„ μ μ™Έ\n\n**4) νμΌ** μ•”νΈν™”\n\nμƒμ„Έ μµμ… μ¤‘ `et μ—` λ”°λΌ μ•”νΈν™” λ¨λ“κ°€ κµ¬λ¶„λλ©°, κΈ°λ³Έμ μΌλ΅ 0x100000(1MB) ν¬κΈ° λ‹¨μ„λ΅ ν\nμΌ μ•”νΈν™”κ°€ μ΄λ£¨μ–΄μ§€κ³  μ•„λμ™€ κ°™μ€ μµμ…μ— λ”°λΌ μ¶”κ°€ μ•”νΈν™” ν¬κΈ°κ°€ μ •ν•΄μ§\n\n, νμΌ μ „μ²΄ μ•”νΈν™”\n, νμΌμ μƒμ„ 0x100000λ§ μ•”νΈν™”\n, νμΌμ μƒμ„ 0x100000μ•”νΈν™”. μ΄ν›„, spize μµμ…μ— λ…μ‹λ ν¬κΈ°λ§νΌ κ°„κ²©μ„ λ‘μ–΄\n0x100000μ”© μ¶”κ°€λ΅ νμΌ μ•”νΈν™” (spsizeμ— μ£Όμ–΄μ§„ ν¬κΈ°λ” MBλ‹¨μ„)\n\n\n-----\n\nFile Encryption Modes\nνμΌ λ³„λ΅ 4x4 key matrixλ¥Ό μƒμ„±ν•μ—¬ Salsa20 μ•κ³ λ¦¬μ¦μΌλ΅ νμΌμ„ μ•”νΈν™”ν•λ©°, Salsa20μ—μ„\nμ‚¬μ©λλ” key matrix κµ¬μ΅°λ” μ•„λμ™€ κ°™μ. REvil λμ„¬μ›¨μ–΄λ” μ•„λ Keyμμ—­μ—λ” μƒμ„±ν• Shared\nKeyμ SHA-3 ν•΄μ‹ κ°’μ„ μ‚¬μ©ν•κ³ , Nonceλ” λλ¤μΌλ΅ μƒμ„±ν• 8byte, Posλ” 0μΌλ΅ μ„¤μ •\n\n\n-----\n\n`et μ—` λ”°λΌ νμΌ μ•”νΈν™”λ¥Ό λ§μΉ λ’¤, μ•”νΈν™”μ— μ‚¬μ©λ 232byteμ λ©”νƒ€λ°μ΄ν„°λ¥Ό νμΌμ— μ¶”κ°€\n\nsk_key struct : κ³µκ²©μ κ³µκ°ν‚¤λ΅ μ•”νΈν™”λ λΉ„λ°€ν‚¤ κµ¬μ΅°μ²΄\n0_key struct : μ μ‘μ λ§μ¤ν„°ν‚¤λ΅ μ•”νΈν™”λ λΉ„λ°€ν‚¤ κµ¬μ΅°μ²΄\nMeta data struct : κ³µκ°ν‚¤, μ•”νΈν™” λ¨λ“ λ“±μ΄ ν¬ν•¨λ μ•”νΈν™”μ— μ‚¬μ©λ μ •λ³΄ κµ¬μ΅°μ²΄\n\n\n-----\n\nKey struct and Meta data struct\n**4) μ•”νΈν™”** ν›„ νμΌ ν™•μ¥μ λ³€κ²½\n\nνμΌμ μ•”νΈν™”κ°€ μ™„λ£λλ©΄ μ›λ³Έ νμΌμ ν™•μ¥μλ¥Ό κΈ°μ΅΄μ— μƒμ„±ν• λλ¤ λ¬Έμμ—΄λ΅ λ³€κ²½\n\n**5) λμ„¬λ…ΈνΈ** μƒμ„±\n\n1. μƒμ„Έ μµμ… λ° κΈ°μ΅΄μ— μƒμ„±ν• λλ¤ ν™•μ¥μλ¥Ό μ΄μ©ν•μ—¬ ν΄λ”λ§λ‹¤ λμ„¬λ…ΈνΈ μƒμ„±\n\n2. `nbody` μµμ… : λμ„¬λ…ΈνΈ νμΌλ… ν¬λ§· β†’ [λλ¤ ν™•μ¥μ]-readme.txt\n\n3. `nname` μµμ… : λμ„¬λ…ΈνΈ λ‚΄μ© ν¬λ§·\n\n\n-----\n\n: κ°μ—Ό κΈ°κΈ° μ‹λ³„ κ°’\n: μ •λ³΄μ μ¶μ§€λ΅ μ „μ†΅ν• μμ§‘λ μ •λ³΄μ base64 encoding ν•νƒ\n: λλ¤ ν™•μ¥μ\n\n4. λμ„¬λ…ΈνΈ μμ‹\n\n5. μ•”νΈν™” μ „μ²΄ κ³Όμ •\n\n\n-----\n\n**6) λ³µνΈν™”** μμ‹\n\n1. κ³µκ²©μλ” μ•”νΈν™”λ νμΌλ΅λ¶€ν„° sk_key structμ— μλ” pk_new μ¶”μ¶\n\n2. κ³µκ²©μκ°€ κ°€μ§€κ³  μλ” dkμ™€ pk_newλ¥Ό μ΄μ©ν•μ—¬ shared key μƒμ„±\n\nμ΄λ” μ•…μ„±μ½”λ“κ°€ pkμ™€ dk_newλ¥Ό μ΄μ©ν•μ—¬ μƒμ„±ν• shared keyμ™€ λ™μΌν•¨\nECDH (Elliiptic Curve Diffie-Hellman)μƒ μ•„λ μμ‹μ΄ μ„±λ¦½ν•κΈ° λ•λ¬Έ\n\n\n-----\n\nπ‘‘π΄: κ³µκ²©μμ private key (dk)\nQπ΄: κ³µκ²©μμ public key (pk)\nπ‘‘B: μ•…μ„±μ½”λ“μ private key (dk_key)\nQB: μ•…μ„±μ½”λ“μ public key (pk_key)\n\n3. μƒμ„±ν• shared keyμ™€ sk_key structμ— μλ” AES IVλ΅ λ³µνΈν™”ν•μ—¬ dk_key μ¶”μ¶\n\n4. 2μ™€ λ™μΌν• λ°©μ‹μΌλ΅ dk_keyμ™€ Meta data structμ— μλ” pk_new_fileλ΅ shared key μƒμ„±\n\n5. μƒμ„±ν• shared keyμ™€ Meta data structμ— μλ” Salsa nonceλ¥Ό μ΄μ©ν•μ—¬ Matrix μƒμ„± ν›„, Salsa\nIVμ™€ ν•¨κ» μ•”νΈν™”λ νμΌ λ°μ΄ν„° λ³µνΈν™”\n\n\n-----\n\n## κ³µκ²© ATT&CK\n\nμ¶μ² : Referenceμ— λ…μ‹λ λ¶„μ„ λΈ”λ΅κ·Έ λ‚΄ IoC μ·¨ν•©\n\n## Initial Access\n\n1. μ·¨μ•½μ μ„ ν†µν•΄ μ›κ²© λ…λ Ήμ–΄ μ‹¤ν–‰ λ° μ ‘μ† μ‹λ„\n\nμ¤λΌν΄ WebLogic μ·¨μ•½μ  (CVE-2019β€“2725)\nMicrosoft Exchange μ„λ²„ μ·¨μ•½μ  (μ •ν™•ν• CVEλ” λ°ν€μ§€μ§€ μ•μ)\nSharepoint μ·¨μ•½μ  (μ •ν™•ν• CVEλ” λ°ν€μ§€μ§€ μ•μ)\n\n\n-----\n\n2. VPN μ·¨μ•½μ μ„ ν†µν• λ‚΄λ¶€ νμΌ νƒμ·¨ μ‹λ„\n\nPulse Secure SSL VPN (CVE-2019β€“11510)\nFortiOS SSL VPN (CVE-2018β€“13379)\n\n3. RDPλ¥Ό ν†µν• μΉ¨ν¬\n\nμ·¨μ•½ν• RDP ν¨μ¤μ›λ“λ¥Ό νƒ€κ²ν•λ” bruteforce κ³µκ²© μ‹λ„\nμ›κ²© μ½”λ“ μ‹¤ν–‰μ΄ κ°€λ¥ν• RDP Bluegate μ·¨μ•½μ  (CVE-2020β€“0609, CVE-2020β€“0610)\n\n4. μ·¨μ•½ν• Citrix κ³„μ •μ„ ν†µν• μΉ¨ν¬\n\n5. μ¤νΈ λ©”μΌμ„ ν†µν•΄ λ‹¤μ΄λ΅λ“ κΈ°λ¥μ μ•…μ„± λ§¤ν¬λ΅κ°€ ν¬ν•¨λ XLSM νμΌ μ ν¬\n\nμ™μ† μμ•½ μ‚¬μ΄νΈ (booking.com)λ¥Ό μ„μ¥ν• ν”Όμ‹± λ©”μΌ\nν•΄μ™Έ λ°°μ† μ—…μ²΄ (DHL)λ΅ μ„μ¥ν• ν”Όμ‹± λ©”μΌ\nDocuSign μ „μ μ„λ… λ©”μΌλ΅ μ„μ¥ν• ν”Όμ‹± λ©”μΌ\n\n6. Supply chain\n\nμ΄νƒλ¦¬μ•„μ WinRAR μ„¤μΉ ν”„λ΅κ·Έλ¨ κ³µμ‹ μ‚¬μ΄νΈ(winrar.it)λ¥Ό ν†µν•΄ λ°°ν¬\n\n7. RIG Exploit kitμ„ ν†µν•΄ λ°°ν¬\n\nRIG Exploit kitμ„ ν™μ©ν• Malvertising κ³µκ²©μΌλ΅ κ°μ—Ό μ‹λ„\n\n8. MSSP λλ” MSP μ—…μ²΄λ¥Ό μ¥μ•… ν›„, κ²½μ ν•μ—¬ μΉ¨ν¬ μ‹λ„\n\n9. SEO-Poisoning λ΅ μΈν•΄ κ²€μƒ‰μ—”μ§„ μƒλ‹¨μ— λ…Έμ¶λλ” μ›Ή μ‚¬μ΄νΈλ΅λ¶€ν„° μ•…μ„± νμΌ λ‹¤μ΄λ΅λ“\n\n**Execution**\n\n1. Powershell (.ps1) μ¤ν¬λ¦½νΈλ¥Ό μ΄μ©ν•μ—¬ λ…λ Ήμ–΄ μ‹¤ν–‰\n\nDownloadFile λ…λ Ήμ–΄λ¥Ό ν†µν•΄ μ•…μ„±μ½”λ“ λ‹¤μ΄λ΅λ“ λ° μ‹¤ν–‰\n\n2. μ•…μ„± μ½”λ“λ¥Ό λ“λ λ° μ‹¤ν–‰ν•λ” Javascript (.js) μ¤ν¬λ¦½νΈ\n\nλ‚λ…ν™” λ javascript μ¤ν¬λ¦½νΈλ¥Ό μ‹¤ν–‰μ‹μΌ μ¶”κ°€ μ•…μ„±μ½”λ“ λ‹¤μ΄λ΅λ“\n\n3. WMI (Windows Management Instrumentation) μΏΌλ¦¬λ¥Ό μ΄μ©ν•μ—¬ λ…λ Ήμ–΄ μ‹¤ν–‰\n\n4. λ°°μΉ μ¤ν¬λ¦½νΈλ¥Ό μ΄μ©ν•μ—¬ λ‹¤μμ λ…λ Ήμ–΄λ¥Ό λ™μ‹μ— μ‹¤ν–‰\n\n## Persistence\n\n1. ν΄λΌμ°λ“ μ›κ²© λ°μ¤ν¬ν†± μ†ν”„νΈμ›¨μ–΄ κ³„μ •μ„ ν†µν• μ§€μ†μ„± μ μ§€\n\nConnectWise Control (κµ¬ ScreenConnect)μ„ μ„¤μΉ ν›„ μ§€μ†μ„± μ μ§€\n\n\n-----\n\n2. Cobalt Strike λΉ„μ½μ„ ν†µν• μ§€μ†μ„± μ μ§€\n\n3. VPN μ·¨μ•½μ μΌλ΅ μ§€μ†μ„± μ μ§€\n\n4. On-premise virtual desktop appliancesλ¥Ό ν†µν• μ§€μ†μ„± μ μ§€\n\n5. Scheduled Taskλ¥Ό μ΄μ©ν•μ—¬ μ£ΌκΈ°μ μΌλ΅ μ•…μ„±μ½”λ“ μ‹¤ν–‰\n\n6. μµμ΄ μΉ¨ν¬ ν›„ μ›Ήμ‰μ„ μ‚½μ…ν•μ—¬ μ§€μ†μ„± μ μ§€\n\n7. REvil λμ„¬μ›¨μ–΄λ” μµμ…μ— λ”°λΌ λ¶€ν… μ‹ μλ™μ‹¤ν–‰ λλ„λ΅ λ μ§€μ¤νΈλ¦¬μ— λ“±λ΅\n\n## Privilege Escalation\n\n1. CVE-2018β€“8453 μ·¨μ•½μ μ„ μ΄μ©ν•μ—¬ λ΅μ»¬ κ¶ν• μƒμΉ μ‹λ„\n\n2. GPO(Group Policy Preferences)λ‚΄μ— ν¬ν•¨λ ν¨μ¤μ›λ“λ΅ λ΅κ·ΈμΈν•μ—¬ κ¶ν• μƒμΉ\n\n3. λ‚΄λ¶€ λ§μ—μ„ μμ§‘ν• κ³„μ •μ •λ³΄λ¥Ό ν†µν•΄ κ¶ν• μƒμΉ μ‹λ„\n\n4. Metasploitμ [UAC-TokenMagic νμ›μ‰](https://github.com/FuzzySecurity/PowerShell-Suite/blob/master/UAC-TokenMagic.ps1) μ¤ν¬λ¦½νΈλ΅ UAC μ°ν\n\n5. Invoke-SluiBypass νμ›μ‰ μ¤ν¬λ¦½νΈλ΅ UAC μ°ν\n\n6. REvil λμ„¬μ›¨μ–΄λ” SeDebugPrivilege κ¶ν•μ„ ν• λ‹Ήν•μ—¬ νƒ€ ν”„λ΅μ„Έμ¤μ— μ ‘κ·Ό μ‹λ„\n\n## Defense Evasion\n\n1. rundll32.exe λΌλ” μ •μƒ ν”„λ΅μ„Έμ¤λ¥Ό μ΄μ©ν•μ—¬ μ•…μ„± DLL νμΌ μ‹¤ν–‰\n\n2. BITSAdmin μ΄λΌλ” μ •μƒ λ„κµ¬λ¥Ό μ΄μ©ν•μ—¬ λ‚΄λ¶€μ— λμ„¬μ›¨μ–΄ λ°°ν¬\n\n3. REvil λμ„¬μ›¨μ–΄λ” μµμ…μ— λ”°λΌ μ•μ „λ¨λ“λ΅ μ¬λ¶€ν…ν•μ—¬ νμΌ μ•”νΈν™”\n\n4. GPO(Group Policy Preferences)λ¥Ό ν†µν•΄ Windows Defender λ° λ°±μ‹  λΉ„ν™μ„±ν™”\n\nλ°°μΉ μ¤ν¬λ¦½νΈ μ‚¬μ©\n\n## Credential Access\n\n1. Mimikatzλ¥Ό μ΄μ©ν•μ—¬ ν¬λ¦¬λ΄μ… μμ§‘\n\n2. ProcDumpλ¥Ό μ΄μ©ν•μ—¬ lsass ν”„λ΅μ„Έμ¤ dumpλ¥Ό ν†µν•΄ ν¬λ¦¬λ΄μ… μμ§‘\n\n## Discovery\n\n1. μλ„μ° κΈ°λ³Έ μ κ³µ λ…λ Ήμ–΄λ¥Ό ν†µν•΄ μ •λ³΄ νƒμƒ‰\n\nnet : λ„¤νΈμ›ν¬ κ³µμ  λ° μ›ν¬μ¤ν…μ΄μ… μ •λ³΄ μμ§‘\n\n\n-----\n\nnltest : λ„λ©”μΈ μ»¨νΈλ΅¤λ¬ λ° μ‹ λΆ°ν•  μ μλ” λ„λ©”μΈ λ©λ΅ μμ§‘\nipconfig : κ°μ—ΌκΈ°κΈ° μ „μ²΄ IP μ •λ³΄ μμ§‘\nsysteminfo : κ°μ—ΌκΈ°κΈ° μ „μ²΄ μ‹μ¤ν… μ •λ³΄ μμ§‘\nping : icmp λ¥Ό ν†µν• ν¬νΈμ¤μΊ” μν–‰\n\n2. Advanced Port Scanner λ„κµ¬λ΅ ν¬νΈ μ¤μΊλ‹ μν–‰\n\n3. ADReconμ„ μ΄μ©ν•μ—¬ Active Directory μ •λ³΄ μμ§‘\n\n4. Everythingμ„ μ΄μ©ν•μ—¬ μ‹μ¤ν… λ‚΄ μ£Όμ” νμΌ μ •λ³΄ μμ§‘\n\n5. PoS Software μ„¤μΉ μ—¬λ¶€ ν™•μΈ\n\n6. SoftPerfect Network Scanner λ„κµ¬λ΅ λ‚΄λ¶€ λ„¤νΈμ›ν¬ μ¤μΊ”\n\n7. Bloodhoundλ„κµ¬λ΅ LDAP μΏΌλ¦¬λ¥Ό μ΄μ©ν•μ—¬ Active Directoryμ •λ³΄ μμ§‘\n\n8. ADfind λ„κµ¬λ΅ Active Directory μ •λ³΄ μμ§‘\n\n## Lateral Movement\n\n1. Scheduled Task: μμ•½λ μ‘μ—…μ„ ν†µν•΄ μΈ΅λ©΄ μ΄λ™ μν–‰\n\n2. PsExec: λ‚΄λ¶€ λ€μ—­μ— μ•…μ„±μ½”λ“ λ³µμ‚¬ ν›„ μ›κ²©μΌλ΅ μ‹¤ν–‰\n\n3. Admin share: λ„¤νΈμ›ν¬ κ³µμ  κΈ°λ¥μΌλ΅ νμΌ λ³µμ‚¬ ν›„ μ‹¤ν–‰\n\n5. WMIExec: WMI λ…λ Ήμ–΄λ¥Ό ν†µν•΄ λ‚΄λ¶€ λ€μ—­μ— μ•…μ„±μ½”λ“ λ³µμ‚¬ ν›„ μ‹¤ν–‰\n\n6. CrackMapExec λ„κµ¬λ΅ μΈ΅λ©΄ μ΄λ™ μν–‰\n\n7. RDP κ³„μ •μ„ μμ§‘ν•μ—¬ μΈ΅λ©΄ μ΄λ™ μν–‰\n\n8. Cobalt Strike κΈ°λ¥μΌλ΅ SMBλ¥Ό ν†µν• μ›κ²© μ„λΉ„μ¤λ¥Ό μƒμ„±ν•μ—¬ μΈ΅λ©΄ μ΄λ™ μν–‰\n\n## Command and Control\n\n1. Cobalt Strike λΉ„μ½μ„ ν†µν• κ°μ—ΌκΈ°κΈ° μ›κ²©μ μ–΄ μν–‰\n\n2. Gootkit, Qbot, IcedId μ™€ κ°™μ€ μ λ…ν• μ•…μ„±μ½”λ“λ¥Ό ν†µν•΄ μ›κ²©μ μ–΄ λ…λ Ή λ° λμ„¬μ›¨μ–΄ λ‹¤μ΄λ΅λ“\n\n3. Wgetμ„ ν†µν•΄ μ¶”κ°€ μ•…μ„±μ½”λ“ λ‹¤μ΄λ΅λ“\n\n4. νμ›μ‰ μ¤ν¬λ¦½νΈλ΅ pastebinμ νΉμ • νμΌμ„ μ½μ–΄μ™€ λ””μ½”λ”© ν›„ μ‹¤ν–‰\n\n## Exfiltration\n\n1. Rcloneλ„κµ¬λ¥Ό μ΄μ©ν•μ—¬ κ³µκ²©μμ μ›κ²© μ„λ²„λ΅ νμΌ λ³µμ‚¬\n\n\n-----\n\n2. Mega ν΄λΌμ°λ“λ¥Ό μ΄μ©ν•μ—¬ νƒμ·¨ν• λ°μ΄ν„° μ €μ¥\n\n## Impacts\n\n1. μ£Όμ” νμΌ μ•”νΈν™”\n\n2. μ£Όμ” λ°±μ—… λ° μ•ν‹° λ°”μ΄λ¬μ¤ μ„λΉ„μ¤ μ¤‘μ§€\n\n3. Volume Shadow Copy μ‚­μ \n\n4. VM Snapshot μ‚­μ \n\n5. File backup μ‚­μ \n\n6. μ¤‘μ”ν• λ¬Έμ„ μ‚­μ \n\n## Conclusion\n\nREvil λμ„¬μ›¨μ–΄λ” 2019λ…„ 4μ›”μ— μµμ΄ λ“±μ¥ν• μ΄ν›„, μ•½ 2λ…„μ΄ λ„λ” μ‹κ°„ λ™μ• λ‹¤ν¬μ›Ή λ‚΄\nRaaS(Ransomware as a Service) μ‹μ¥μ—μ„ μµμ •μƒμ μλ¦¬λ¥Ό μ§€ν‚¤κ³  μλ‹¤. μ§€μ†μ μΈ λ²„μ „ μ—…λ°μ΄\nνΈ, λ‹¤μ–‘ν• κΈ°λ¥ λ° μƒμ„Έ μµμ…μ„ ν†µν• μ‰¬μ΄ μ»¤μ¤ν„°λ§μ΄μ§•μ΄ κ°€λ¥ν•κΈ° λ•λ¬Έμ΄λ‹¤. λ‹¤μμ κµ¬λ§¤μλ“¤\n(λλ” Operator)μ— μν•΄ κ°μΈλ¶€ν„° JBSμ™€ κ°™μ€ λ€ν• κΈ°μ—… κ³µκ²©μ—κΉμ§€ REvil λμ„¬μ›¨μ–΄λ¥Ό μ΄μ©ν• κ΄‘\nλ²”μ„ν• κ³µκ²©μ΄ μ΄λ£¨μ–΄μ§€κ³  μλ‹¤.\n\nREvilλ΅λ¶€ν„° νμƒλ μ΅°μ§λ“¤μ΄ κ³„μ† μƒκ²¨λ‚κ³ , μΈν„°λ·°λ¥Ό ν†µν•΄ μ•μΌλ΅ λ”μ± λ” μ κ·Ήμ μΌλ΅ κ³µκ²©ν• \nκ²ƒμ„μ„ λ°νκΈ°λ„ ν–λ‹¤. REvilμ€ λΈκ°’μ„ λ°›μ•„λ‚΄κΈ° μ„ν•΄ κΈ°μ—… μ •λ³΄ μ μ¶, DDoS, ννΈλ„μ‚¬ ν‘λ°• λ“±\nκ³Ό κ°™μ€ μ „λµμ„ μ·¨ν•κ³  μκΈ° λ•λ¬Έμ— μ‹¤μ λ΅ κ°μ—Όλ  κ²½μ°, κΈ°μ—… λ‚΄ ν° νƒ€κ²©μ„ μ…μ„ μ μλ‹¤.\n\nλμ„¬μ›¨μ–΄μ μ½”λ“λ” 2λ…„ λ™μ• ν¬κ² λ°”λ€μ§€ μ•μ•μ§€λ§, μ΄λ¥Ό μ‚¬μ©ν•λ” κ³µκ²©μλ“¤μ΄ λ§μ€ λ§νΌ λ§¤μ°\nλ‹¤μ–‘ν• μµμ΄ μΉ¨ν¬ κ²½λ΅, κ³µκ²© λ„κµ¬λ΅ λ°°ν¬λκ³  μλ‹¤. κ·Έλ ‡κΈ° λ•λ¬Έμ— λμ„¬μ›¨μ–΄ μμ²΄μ— λ€ν•΄μ„λ§ λ€\nμ‘ν•λ” κ²ƒμ΄ μ•„λ‹, μ „μ²΄μ μΈ κ³µκ²© μ‹λ‚λ¦¬μ¤λ¥Ό μ΄ν•΄ν•κ³  μμ‹  λλ” κΈ°μ—…μ μ·¨μ•½ν• λ¶€λ¶„μ„ ν™•μΈν•\nμ—¬ μ κ²€ λ° λ³΄μ™„ν•  μ μμ–΄μ•Ό ν•λ‹¤.\n\n## Reference\n\n1. [https://blog.talosintelligence.com/2019/04/sodinokibi-ransomware-exploits-weblogic.html](https://blog.talosintelligence.com/2019/04/sodinokibi-ransomware-exploits-weblogic.html)\n\n2. https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/sodinokibiransomware-cobalt-strike-pos\n\n3. [https://blog.amossys.fr/sodinokibi-malware-analysis.html](https://blog.amossys.fr/sodinokibi-malware-analysis.html)\n\n4. [https://www.tgsoft.it/immagini/news/20190705Sodinokibi/Sodinokibi_eng.pdf](https://www.tgsoft.it/immagini/news/20190705Sodinokibi/Sodinokibi_eng.pdf)\n\n5. https://i.blackhat.com/eu-20/Wednesday/eu-20-Clarke-Its-Not-FINished-The-EvolvingMaturity-In-Ransomware-Operations.pdf\n\n\n-----\n\n6. https://blog.malwarebytes.com/threat-analysis/2020/11/german-users-targeted-with-gootkitbanker-or-revil-ransomware/\n\n7. [https://asec.ahnlab.com/ko/19640/](https://asec.ahnlab.com/ko/19640/)\n\n8. [https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/](https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/)\n\n## Appendix\n\n Appendix #1 : REvil λμ„¬μ›¨μ–΄ νƒμ§€ μ•ΌλΌ λ£°\n```\nrule REvil_Ransomware_V2_5{  meta:    description = \"REvil ransomware v2.05\ndetection rule\"    author = \"S2WLAB TALON\"    date = \"2021-06-23\"    version\n= \"1.0\"  strings:    $pattern1 = \"ERR0R D0UBLE RUN!\" ascii wide nocase    \n$pattern2 = \"vmcompute.exe\" ascii wide nocase    $pattern3 = \"vmms.exe\" ascii wide\nnocase    $pattern4 = \"vmwp.exe\" ascii wide nocase    $pattern5 = \"svchost.exe\"\nascii wide nocase    $pattern6 = \"DTrump4ever\" ascii wide nocase    $pattern7 =\n\"expand 32-byte k\" ascii wide nocase    $pattern8 = \"expand 16-byte k\" ascii wide\nnocase    $pattern9 = \"__ProviderArchitecture\" ascii wide nocase    $code1 = {83\nEC 10 B9 5B 04 00 00 53 56 8B 75 08 [0-8] C1 E6 10 33 75 08 81 F6 ?? ?? ?? ?? 8B C6 C1\nE8 15 57}    $code2 = {8B 55 08 40 0F B6 C8 8B 45 08 89 4D 10 8B 5D 10 8A 0C 01 0F\nB6 C1 03 C6 0F B6 F0 8B 45 08 8A 04 06 88 04 13 8B C2 8B D3 8B 5D 14 88 0C 06 0F B6 04\n02 8B 55 0C 0F B6 C9 03 C8 0F B6 C1 8B 4D 08 8A 04 08 32 04 1A 88 03 43 8B 45 10 89 5D\n14 83 EF 01 75} // rc4  condition:    ( 8 of ($pattern*) and $code1 ) or    (\n8 of ($pattern*) and $code2 )}rule REvil_Ransomware_V1_6{  meta:    description =\n\"REvil ransomware v1.06 detection rule\"    author = \"S2WLAB TALON hypen\"    date\n= \"2021-06-23\"    version = \"1.0\"  strings:    $pattern1 = \"ServicesActive\"\nascii wide nocase    $pattern2 = \"expand 32-byte k\" ascii wide nocase    \n$pattern3 = \"expand 16-byte k\" ascii wide nocase    $code1 = {11 f8 90 45 3a 1d d0\n11 89 1f 00 aa 00 4b 2e 24 28 20 bd 49 23 15 d1 11 ad 79 00 c0 4f d8 fd ff 87 a6 12 dc\n7f 73 cf 11 88 4d 00 aa 00   4b 2e   24} // rscid    $code2 = {8B 55 08 40 0F B6\nC8 8B 45 08 89 4D 10 8B 5D 10 8A 0C 01 0F B6 C1 03 C6 0F B6 F0 8B 45 08 8A 04 06 88 04\n13 8B C2 8B D3 8B 5D 14 88 0C 06 0F   B6 04 02 8B 55 0C 0F B6 C9 03 C8 0F B6 C1 8B 4D\n08 8A 04 08 32 04 1A 88 03 43 8B 45 10 89 5D 14 83 EF 01 75} // rc4  condition:    \nall of them}\n\n Appendix #2 : Sigma rule\n\n```\nμ¶μ² : [https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/](https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/)\n\nhttps://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_pow\nershell_enc_cmd.yml\n\nhttps://github.com/Neo23x0/sigma/blob/084cd39505861188d9d8f2d5c0f2835e4f750a3f/rules/wi\nndows/process_creation/win_malware_trickbot_recon_activity.yml\n\nhttps://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_com\nmands_recon_activity.yml\n\n\n-----\n\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/sysmon_ru\nndll32_net_connections.yml\n\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_process_c\nreation_bitsadmin_download.yml\n\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_adfi\nnd.yml\n\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_wmi\n_execution.yml\n\nhttps://github.com/SigmaHQ/sigma/blob/a08571be9107d1c0e216400ffbb89c394fcd2570/rules/\nwindows/process_creation/win_office_shell.yml\n\n## Appendix #3 : IoC\n\nClick the below image then redirect to google spreadsheet\n\nμ¶μ² : Referenceμ— λ…μ‹λ λ¶„μ„ λΈ”λ΅κ·Έ λ‚΄ IoC μ·¨ν•©\n\n\n-----\n\n## Appendix #4 : REvil ν‘μƒ μ‚¬μ΄νΈ νμ΄μ§€ (μµμ΄ Key μ…λ ¥ λ° μΊ΅μ°¨ μ λ„)\n\n\n-----\n\n-----\n\n## Appendix #5 : v2.05μ™€ v2.07 λΉ„κµ\n\nν„μ¬κΉμ§€ λ°κ²¬λ REvil λμ„¬μ›¨μ–΄μ κ°€μ¥ μµμ‹  λ²„μ „μ€ 2.07λ΅ ν™•μΈλ¨\n\n1. λ΅μ»¬ λ“λΌμ΄λΈ μ•”νΈν™”\n\n2.07 λ²„μ „μ—μ„λ” λ΅μ»¬ λ“λΌμ΄λΈ μ•”νΈν™” μ‹, λ“λΌμ΄λΈ νƒ€μ…μ΄ DRIVE_FIXED(μΌλ° λ””μ¤ν¬)\nμΌ κ²½μ°, NetShareAdd ν•¨μλ΅ λ΅μ»¬ κ³µμ  μ‹μ‘\nNetShareAdd ν•¨μλ¥Ό μ΄μ©ν• κ°μ—Ό λ‹¨λ§ λ¦¬μ†μ¤ κ³µμ μ‹ μ‚¬μ©λλ” comment\n(SHARE_INFO_2 κµ¬μ΅°μ²΄ λ‚΄ shi2_remark λ©¤λ²„ λ³€μ) λ¬Έμμ—΄ : β€Share added by Rβ€\n\n\n-----\n\n2. λ„¤νΈμ›ν¬ λ“λΌμ΄λΈ μ•”νΈν™”\n\n2.07 λ²„μ „μ—μ„λ” λ„¤νΈμ›ν¬ λ“λΌμ΄λΈ μ•”νΈν™” ν•¨μλ¥Ό Threadλ΅ μƒμ„±ν•μ§€ μ•μ\nκΈ°μ΅΄μ—λ” explorer.exeμ ν† ν°μ„ impersonateν•μ—¬ λ„¤νΈμ›ν¬ κ³µμ  νƒμƒ‰ κ¶ν•μ„ νλ“ν•μ€λ”\nλ°, 2.07 λ²„μ „μ—μ„λ” μ΄μ— λ”ν•΄ ν„μ¬ Threadλ¥Ό μ μ™Έν• ν„μ¬ ν”„λ΅μ„Έμ¤ λ‚΄ λ¨λ“  Threadμ— λ™\nμΌν• ν† ν° μ μ©\nμ΄ν›„ λ³µμ λ ν† ν°μΌλ΅ λ„¤νΈμ›ν¬ λ“λΌμ΄λΈ μ•”νΈν™”λ¥Ό μ‹λ„ν•κ³ , RevertToSelfλ΅ impersonate\nμΆ…λ£ ν›„μ— ν•λ² λ” λ„¤νΈμ›ν¬ λ“λΌμ΄λΈ μ•”νΈν™”λ¥Ό μ‹λ„ν•¨\n\n\n-----",
    "language": "KO",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-23 - Deep analysis of REvil Ransomware.pdf"
    ],
    "report_names": [
        "2021-06-23 - Deep analysis of REvil Ransomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536036,
    "ts_updated_at": 1743041160,
    "ts_creation_date": 1653764358,
    "ts_modification_date": 1653764358,
    "files": {
        "pdf": "https://archive.orkl.eu/49310614a1bfa458ba8d6b74c23cb82da3ce36d6.pdf",
        "text": "https://archive.orkl.eu/49310614a1bfa458ba8d6b74c23cb82da3ce36d6.txt",
        "img": "https://archive.orkl.eu/49310614a1bfa458ba8d6b74c23cb82da3ce36d6.jpg"
    }
}