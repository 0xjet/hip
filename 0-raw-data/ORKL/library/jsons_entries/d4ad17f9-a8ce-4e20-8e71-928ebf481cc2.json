{
    "id": "d4ad17f9-a8ce-4e20-8e71-928ebf481cc2",
    "created_at": "2023-01-12T15:01:52.063207Z",
    "updated_at": "2025-03-27T02:05:53.595006Z",
    "deleted_at": null,
    "sha1_hash": "136142d10f8e62877243594c41b0cbfc12ac48da",
    "title": "2019-10-24 - FTdecryptor- a simple password-based FTCODE decryptor",
    "authors": "",
    "file_creation_date": "2022-05-28T17:38:54Z",
    "file_modification_date": "2022-05-28T17:38:54Z",
    "file_size": 202703,
    "plain_text": "# FTdecryptor: a simple password-based FTCODE decryptor\n\n**[certego.net/en/news/ftdecryptor-a-simple-password-based-ftcode-decryptor/](https://www.certego.net/en/news/ftdecryptor-a-simple-password-based-ftcode-decryptor/)**\n\n**Date:**\n24 October 2019\n\n**Tag:**\n[ftcode,](https://www.certego.net/en/news/index/type:Tag/slug:ftcode/) [decryptor](https://www.certego.net/en/news/index/type:Tag/slug:decryptor/)\n\nHi there, this is Gabriele Pippi, from the Certego Purple Team.\n\nI want to share this simple password-based FTCODE decryptor.\n\n**Note #1: this must be considered a beta version of the script; the author assumes no**\n**responsibility for any damage caused by running it.**\n\n**Note #2: currently the malware sends the password both as plain and cypher text; we**\n**believe the behavior may change soon as the malware is updated, and the plain text**\n**form may not be available anymore.**\n\n**Note #3: decrypting files with an incorrect password may make them unrecoverable;**\n**so we recommend taking a backup of the files before running the script**\n\n\n-----\n\n**Why should a password-based decryptor be useful?**\n\n[Since the first observed campaigns, documented in this article, we have noticed that](https://www.certego.net/en/news/malware-tales-ftcode/)\nFTCODE was sending the password in plaintext within the body of an HTTP post request to\nthe C&C.\n\nOnce implemented the relevant Suricata signatures, I decided to develop this tool internally,\nin order to make the decryption operation feasible.\n\nIn all of the cases we had the opportunity to put hands on, we were able to recover the\nencrypted files up to version 1018.1.\n\n**Network Traffic**\n\nIn order to be able to decrypt the files successfully, it is necessary to intercept the contents of\nthe POST request that the malware sends to the C&C at infection time; an example of such\nrequest follows:\n\n**ext = extension of encrypted files**\n\n**ek = password in plain text**\n\n**r1 = Base64 chunk containing the encrypted password**\n\nIn order to intercept the POST request, we developed the following Suricata signature, and\ndeployed it to our network monitoring system:\n```\nalert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"CERTEGO TROJAN FTCODE\nRegistration Request (m.bompani)\"; flow:to_server; content:\"POST\"; http_method;\ncontent:\"ext=\"; http_client_body; content:\"guid=\"; http_client_body; content:\"ek=\";\nhttp_client_body; classtype:trojan-activity; sid:9000931; rev:1;)\n\n```\n**What does the tool do?**\n\n\n-----\n\nGiven the extension and the password, the tool is able to recursively decrypt the encrypted\nfiles in all the mounted disks or in a given path.\n\nIt offers the following features.\n\nIn-memory fileless utilization: it is possible by wrapping the script in a function,\n[leveraging the built-in PowerShell cmdlet Invoke-Expression](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-expression?view=powershell-6)\nLogger: it traces the activities carried out, leveraging two cmdlets described at\n[Start/Stop Transcript](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.host/?view=powershell-6)\nBackup: it backs up all the files that the tool will try to decrypt.\nSome options were added to the script for possible future uses.\n\n**Additional Details**\n\nFor further technical details and demonstrations, please refer to the official github project\n[FTdecryptor](https://github.com/certego/ransomware_decryptors/blob/master/FTdecryptor/README.md)\n\n[For further FTCODE details, please refer to this article FTCODE article](https://www.certego.net/it/news/malware-tales-ftcode/)\n\n**About the author**\n\n**Gabriele** **[Pippi, Purple Team (LinkedIn)](https://www.linkedin.com/in/gabriele-pippi-380b70160/)**\n\n## Potrebbe interessarti anche...\n\n1. Malware Tales: FTCODE\n\n**Date:**\n2 October 2019\n\n## Aggiungi un Commento\n\nIl simbolo * indica che devi compilare il campo.\n\n[Terms of Service](https://www.certego.net/en/terms-of-service/)\n[Privacy](https://www.certego.net/en/privacy/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-10-24 - FTdecryptor- a simple password-based FTCODE decryptor.pdf"
    ],
    "report_names": [
        "2019-10-24 - FTdecryptor- a simple password-based FTCODE decryptor.pdf"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535712,
    "ts_updated_at": 1743041153,
    "ts_creation_date": 1653759534,
    "ts_modification_date": 1653759534,
    "files": {
        "pdf": "https://archive.orkl.eu/136142d10f8e62877243594c41b0cbfc12ac48da.pdf",
        "text": "https://archive.orkl.eu/136142d10f8e62877243594c41b0cbfc12ac48da.txt",
        "img": "https://archive.orkl.eu/136142d10f8e62877243594c41b0cbfc12ac48da.jpg"
    }
}