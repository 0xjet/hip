{
    "id": "b194c91d-2cde-4320-8b4c-852243143bf8",
    "created_at": "2023-01-12T15:09:51.115314Z",
    "updated_at": "2025-03-27T02:05:57.528154Z",
    "deleted_at": null,
    "sha1_hash": "ce8fef5b51cc9af5acd7d54f87fcd3609ce7f1e1",
    "title": "2022-01-18 - Info-Stealing Tool Posing As Naver OTP",
    "authors": "",
    "file_creation_date": "2022-07-02T23:16:53Z",
    "file_modification_date": "2022-07-02T23:16:53Z",
    "file_size": 858304,
    "plain_text": "# Info-Stealing Tool Posing As Naver OTP\n\n**[cyberandramen.net/2022/01/18/info-stealing-tool-posing-as-naver-otp/](https://cyberandramen.net/2022/01/18/info-stealing-tool-posing-as-naver-otp/)**\n\n## Summary\n\n\nJanuary 18, 2022\n\n\nSHA256: 3275f42c85c9e2fcb80d1f8c1c6227c2bcde9c0e719905ddbd2ca7373c6a8ec6\nFilename: UpHelpers.exe\nSize: 3.41MB\nExtension: EXE\nCompilation Timestamp: 2022-01-05 23:41:20\n[Sandbox analysis: https://tria.ge/220118-emrgjsgfb7](https://tria.ge/220118-emrgjsgfb7)\n\nUpHelpers.exe is an information-stealing/reconnaissance tool disguised as a Naver One Time\nPassword, (OTP) generator app. Naver is a South Korean web portal that first debuted in 1999 and\noffers a number of services.\n\n\n-----\n\nThe tool collects drive and directory information on the victim system through PowerShell, as well as\ngathering system information using systeminfo.exe. The stolen system information is uploaded to a\nC&C server.\n\n## High-Level Overview\n\nFigure 1: Malware Flow\nUpon execution, UpHelpers.exe drops three executables as seen in Figure 1. The\nOTPGenerator.exe file is dropped into ~\\AppData\\Local\\Temp. AWastUI.exe and rdpclipe.exe are\ndropped into the created folder ~\\AppData\\Local\\MICROS~1\\Outlooka. Shortcut files of the previous\ntwo files are dropped into the Startup folder to maintain persistence.\n\nThe computer name, username, and local IP are written to a file named nlashine.ini. Figure 2\nprovides an example of collected information after running the sample in a sandbox.\n\nUpon execution, rdpclipe.exe ensures nlashine.ini is on the system, and if not, creates it.\nAdditionally, the file contains the ability to log keystrokes and write what was captured to\nCOMMA1UP_RKey.txt. The contents of the text file are written to a .dat file, and retrieved by the C2.\n\n\n-----\n\nFigure 2:\n\nnlashine.ini\nAWastUI.exe is responsible for collecting system data and communicating with the C2. After running\nthe systeminfo command, the output is saved in a PDF file titled SysInfo_UP_day_hour_min.\n\nNext, a hardcoded PowerShell command enumerates the drives of the victim system. This\ninformation is also written in the PDF file mentioned above.\n```\npowershell $dir = 'C:\\Users\\Admin\\AppData\\Local\\MICROS~1\\Outlooka\\';$gps =\n@('A','B','C','D','E','F','G','H','I','H','K','L','M','N','O','P','Q','R','S','T','U','V','W\n ($gp in $gps){$drv = $gp + ':\\';if([System.IO.Directory]::Exists($drv)){$path = $dir +\n'\\UP' + $gp;tree /f \"$drv\" | Out-File -Encoding default -FilePath $path -Width 5000;} }\n\n```\nAs can be seen in the above code block, the tree command is used to collect the directory structure\nand folders within the C drive.\n\n## Network Indicators\n\nThe attacker infrastructure may have been taken down by the time I stumbled upon this sample as\nno useful network information was found.\n\nRunning a strings tool of your choice does however provide a window into the threat actors’\ninfrastructure as well as URL paths to your blocklist.\n\nThe following network information was found throughout all the associated files:\n\n/ESOK/up2.php\n/ESOK/post2.php\n/ESOK/dwn.php?downfname=\n/ESOK/del2.php?delfname=\nHost: 66.94.98[.]48\nMozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko)\nChrome/31.0.1650.57 Safari/537.36\nContent-Disposition: form-data; name=”userfile”; filename=”%s”\n\nThe above IP address belongs ASN AS40021 – CONTABO, Contabo Inc., and has ports 80, 443,\nand 3389 open. Figure 3 lists the most recent domain resolutions identified by RiskIQ:\n\nFigure 3\n\n## Interesting Strings\n\n\n-----\n\nE:\\Coding_Smart\\Smart_Attack_Code\\Oracle_Spy\\src\\Release\\UpHelpers.pdb\n%sSysInfo_UP_%02d_%02d_%02d.pdf\nnlashine.ini\n/ESOK/up2.php\n/ESOK/post2.php\ndwn.dat\npc.dat\nwanda_alpago613\nXJOIUUQ/EMM (possible obfuscated call to WINHTTPDLL)\nLFSOFM43/EMM (possible obfuscated call to KERNEL32DLL)\nOFUBQJ43/EMM (possible obfuscated call to NETAPI32DLL)\n\n## Indicators\n\nSHA256 Hashes:\n\nAWastUI.exe::94306c7b1f1f1770e2ac2ba91bfd5f0d6e20b8878e6ad07253b50abccdd08c1d\nnlashine.ini::547e05c7cbf123aee2f7bd080719a1f8751faffc3e187b1ca72d1b9ce3301574\nrdpclipe.exe::7c82652f7f9f10c9541140a10d4fecc847907bb43374c7f29f37f9a3a956ac3b\nOTPGenerator.exe::2b082c52b754a984efa39036aaa711d23ae2bdf830f0005b19568e97a73bf918\n\n## Conclusion\n\nAlthough Naver is widely used in South Korea, the group’s brand has grown to a global audience.\nThe threat actor(s) is targeting data from specific individuals who would use this app. Possible\ngroups targeted could range from customer data to individuals affiliated with the\ngovernment/military.\n\nIt is likely the threat actor would decide his/her next move based on the information collected and\nsent to the C2. I am unable to make a guess as to what follow-on infections there may be at this\ntime.\n\n## References\n\nResearch by AhnLab ASEC:\n\n[Infostealer Disguised as Well-Known Korean Web Portal File](https://asec.ahnlab.com/en/30637/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-18 - Info-Stealing Tool Posing As Naver OTP.pdf"
    ],
    "report_names": [
        "2022-01-18 - Info-Stealing Tool Posing As Naver OTP.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536191,
    "ts_updated_at": 1743041157,
    "ts_creation_date": 1656803813,
    "ts_modification_date": 1656803813,
    "files": {
        "pdf": "https://archive.orkl.eu/ce8fef5b51cc9af5acd7d54f87fcd3609ce7f1e1.pdf",
        "text": "https://archive.orkl.eu/ce8fef5b51cc9af5acd7d54f87fcd3609ce7f1e1.txt",
        "img": "https://archive.orkl.eu/ce8fef5b51cc9af5acd7d54f87fcd3609ce7f1e1.jpg"
    }
}