{
    "id": "fbad5fd8-aaa2-42c5-9778-abc9db617871",
    "created_at": "2023-01-12T15:03:41.103921Z",
    "updated_at": "2025-03-27T02:05:41.495644Z",
    "deleted_at": null,
    "sha1_hash": "15f188d41e9b29b5ff5cab79909519af52f76bdc",
    "title": "2020-09-16 - Malware Leveraging XML-RPC Vulnerability to Exploit WordPress Sites",
    "authors": "",
    "file_creation_date": "2022-05-28T04:47:59Z",
    "file_modification_date": "2022-05-28T04:47:59Z",
    "file_size": 2057594,
    "plain_text": "# Malware Leveraging XML-RPC Vulnerability to Exploit WordPress Sites\n\n**[zscaler.com/blogs/security-research/malware-leveraging-xml-rpc-vulnerability-exploit-wordpress-sites](https://www.zscaler.com/blogs/security-research/malware-leveraging-xml-rpc-vulnerability-exploit-wordpress-sites)**\n\n[We have written a number of blogs about vulnerabilities within and](https://www.zscaler.com/blogs/research/cybercriminals-targeting-multiple-vulnerabilities-wordpress-plugins) [attacks on sites built with](https://www.zscaler.com/blogs/research/compromised-wordpress-sites-used-distribute-adwind-rat)\n[WordPress. And, when you consider that 34 percent of all websites in the world are built with](https://hostingtribunal.com/blog/wordpress-statistics/)\nWordPress, it’s understandable that cybercriminals will continue to focus their attention on\nthis popular platform.\n\nOne of the most common attack vectors employed by these bad actors is to launch an XMLRPC attack. XML-RPC on WordPress, which is enabled by default, is actually an API that\nprovides third-party applications and services the ability to interact with WordPress sites,\nrather than through a browser. Attackers use this channel to establish a remote connection to\na WordPress site and make modifications without being directly logged in to your WordPress\nsystem. However, if a WordPress site didn’t disable XML-RPC, there is no limit to the number\nof login attempts that can be made by a hacker, meaning it is just a matter of time before a\ncybercriminal can gain access.\n\nRecently, the Zscaler ThreatLabZ team came across a scheme to attack WordPress sites\nwhere a malicious program gets a list of WordPress sites from a C&C server which then are\nattacked leveraging the XML-RPC pingback method to fingerprint the existing vulnerabilities\non the listed WordPress sites.\n\nEven though we saw a payload used in this attack in our Zscaler cloud and also found a\n[campaign of similar files on VirusTotal, we haven’t found any specific spam templates used](https://www.virustotal.com/graph/g4f708a8a274f4ef1a8727d0c6e00d5a5f5d879652067434797084e53f5d37bef)\nfor this campaign. Additionally, the payloads appear to be new and had no specific\nattribution, so we have given a new name to this program based on its activity—\nWin32.Backdoor.WPbrutebot.\n\n\n-----\n\n**Technical analysis**\n\nIn our research, we found several samples pertaining to this campaign but we analyzed one\nsample here for brevity and as an example.\n\nIn the sample set we worked on, we found that almost all samples used Microsoft-version\ninformation, but all of them lack a legitimate Windows Digital Signature and left the company\nname as TODO, which implies that these files are being generated through a script and this\nsection is still a work in progress.\n\n_Figure 1: The common metadata used in most files in this campaign._\n\nAnother feature we found was that InternalName was always a sequence of 2s.\nUnfortunately, we weren’t able to conclude if this was intentional or not.\n\nThe initial layer of the malware is for decoding the URIs used to make initial contact with the\nC&C server.\n\nThe first section is unpacked as shown in Figure 2:\n\n\n-----\n\n_Figure 2: The decryption loop of this program._\n\nThis decryption loop is a simple XOR decryption that sequentially runs from B5 to C7, which\ngives us /lk4238fh317/update.php.\n\nFigure 3 shows the debugger dump.\n\n_Figure 3: The decrypted string of this program._\n\nNext, the domain is generated using another XOR-based decryption where the key goes\nfrom B5 to C0.\n\n_Figure 4: The decryption loop for this program._\n\nThe domain generated is k6239847[.]lib. This URL is then used with blockchain DNS.\n\n_Figure 5: The DNS query._\n\nThe blockchain DNS URI is decrypted using a similar XOR loop as shown in Figure 6. The\nvalue compared depends on the size of the blockchain DNS URI.\n\n\n-----\n\n_Figure 6: The decryption loop._\n\nThese are first assembled in heap using RtlAllocateHeap.\n\n_Figure 7: The decrypted strings._\n\nThe code shown in Figure 8 is called several times to allocate heap to save decrypted strings\nthat are used later to perform network activity or for creating files.\n\n_Figure 8: The API call details._\n\nThis same code is reused to assemble user-agent strings, which are later used for making\ninternet connections.\n\n\n-----\n\n_Figure 9: The user-agents employed in this attack._\n\nThis is then used to create a DNS request for the blockchain DNS server.\n\n_Figure 10: The concatenated URL._\n\nThe DNS request generated produces a C&C IP of 217.8.117[.]48, which can be confirmed\nonline at explorer.emercoin[.]com/nvs/dns.\n\n\n-----\n\n_Figure 11: The domains found at emercoin.com._\n\nThe segment of a URL created during the first decryption loop (as shown above) is then\nused with the IP address to contact the C&C. The URL created is\n217.8.117[.]48/lk4238fh317/update.\n\nThe C&C then replies back with 217.8.117[.]48/j537djjlhg763/svchst.exe, which is the\ndownloaded payload. The payload is downloaded at C:\\Users\\UserName\\AppData\\Roaming\\svchst.exe.\n\n_Figure 12: The program downloading an updated version of itself._\n\nThe downloaded sample (MD5:86374F27C1A915D970BE3103D22512B9) is an updated\nversion of the parent sample, which downloads itself to ensure that the latest version of the\nmalicious program is running on the system. This sample also performs a DNS query on\nk6239847[.]lib. The string is obfuscated by breaking the string in two parts—k623 and\n9847.lib, which are concatenated in memory.\n\nThis time, a command is run using cmd.exe /C ping 1.1.1.1 -n 1 -w., where -n means the\nnumber of echo requests to send and -w is the timeout in milliseconds to wait for each reply.\n1 1 1 1 is popular DNS service by Cloudflare\n\n\n-----\n\nThe full command is cmd.exe /C ping 1.1.1.1 -n 1 -w -n 1 -w3000 > Nul & Del /f /q \\ %s.\n\nThe program then enumerates system information including information such as user name,\nprocessor architecture, and more.\n\n_Figure 13: The algorithm to initiate the /xmlrpc.php attack._\n\n\n-----\n\n_Figure 14: The attack vectors found in the file._\n\nHere, the malicious program is using <methodName>wp.getUsersBlogs</methodName>\nto execute a brute force attack via the “wp.getUsersBlogs” method of xmlrpc.php where an\nattacker is actually doing a reverse IP lookup for the IPs fetched from the C&C and is looking\nfor all the available methods on the corresponding DNS. Once found, it attempts to gain the\nlogin via cookie-based authentication by logging into WordPress using cURL, authenticating\nthe server (which ran the cURL script) and providing the username/password to the login\npage of the desired WordPress site.\n\nHere is a redacted list of a few WordPress sites the attacker is trying to attack leveraging this\nmalware payload:\n\n_Figure 15: The list of WordPress sites targeted for a brute force attack._\n\nWe then went on hunting for similar samples. We were able to unearth more samples\nconnecting to the same domains (k6239847.lib) and IP address (217.8.117.48). The samples\nwe found had similar activity but used a .space TLD domain as one of its C&C.\n\n**Cloud Sandbox detection**\n\nThe malware payload was successfully detected and blocked by the Zscaler Cloud Sandbox\nas seen in the Figure 16.\n\n\n-----\n\n_Figure 16: The Zscaler Cloud Sandbox successfully detected the malware._\n\nAdvanced Threat Signature name:\n\n[Win32.Backdoor.Wpbrutebot](https://threatlibrary.zscaler.com/?keyword=wpbrutebot)\n\n**Conclusion**\n\nDue to its popularity, WordPress is a common target for cyberattacks. As such, WordPress\nadmins need to be on alert to reports of newly found vulnerabilities and attacks. In addition,\nWordPress admin should keep the XML-RPC option disabled and refrain from using logins\nfrom third-party applications.\n\nZscaler continues to protect our customers from such attacks and detects these malicious\nprograms in our Cloud Sandbox in real time.\n\n**MITRE ATT&CK TTP Mapping**\n\n**T1212** **Credential Access**\n\n**T1110** **Brute Force**\n\n**T1556** **Modify Authentication Process**\n\n**T1497** **Sandbox Evasion**\n\n\n-----\n\n**T1055** **Process Injection**\n\n**T1003** **OS Credential Dumping**\n\n**T1491** **Defacement**\n\n**IOCs**\n\nHashes:\n\n2ed7662ec8e2022d9cebec3a8ebaf838\n\nc09cf4312167fa9683d8e8733004b7e6\n\n86374f27c1a915d970be3103d22512b9\n\nd88a7fca98e89aaf593163b787165766\n\n03caf1cf96f95b82536fc8b7d94c5a61\n74f5107acd2e51dc407253f15d718be3\n\na54fa899a524f0cd34ae90f9820b41e0\n\nIPs:\n\n207.148.83[.]241\n\n5.132.191[.]104\n\n66.70.228[.]164\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-16 - Malware Leveraging XML-RPC Vulnerability to Exploit WordPress Sites.pdf"
    ],
    "report_names": [
        "2020-09-16 - Malware Leveraging XML-RPC Vulnerability to Exploit WordPress Sites.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535821,
    "ts_updated_at": 1743041141,
    "ts_creation_date": 1653713279,
    "ts_modification_date": 1653713279,
    "files": {
        "pdf": "https://archive.orkl.eu/15f188d41e9b29b5ff5cab79909519af52f76bdc.pdf",
        "text": "https://archive.orkl.eu/15f188d41e9b29b5ff5cab79909519af52f76bdc.txt",
        "img": "https://archive.orkl.eu/15f188d41e9b29b5ff5cab79909519af52f76bdc.jpg"
    }
}