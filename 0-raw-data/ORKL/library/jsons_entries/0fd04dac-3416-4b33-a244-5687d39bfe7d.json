{
    "id": "0fd04dac-3416-4b33-a244-5687d39bfe7d",
    "created_at": "2023-01-12T15:10:38.951591Z",
    "updated_at": "2025-03-27T02:06:12.478048Z",
    "deleted_at": null,
    "sha1_hash": "5f9d77dc8a8e63eb0a2b7e372b13eb0a1b215a52",
    "title": "2021-06-21 - DJVU Malware of STOP Ransomware Family Back with New Variant",
    "authors": "",
    "file_creation_date": "2022-05-27T23:07:52Z",
    "file_modification_date": "2022-05-27T23:07:52Z",
    "file_size": 957217,
    "plain_text": "# DJVU Malware of STOP Ransomware Family Back with New Variant\n\n**[cybleinc.com/2021/06/21/djvu-malware-of-stop-ransomware-family-back-with-new-variant/](https://cybleinc.com/2021/06/21/djvu-malware-of-stop-ransomware-family-back-with-new-variant/)**\n\nJune 21, 2021\n\nIn the course of our routine darkweb monitoring, the Cyble research team\ndiscovered a new variant of the DJVU malware that belongs to the STOP ransomware\nfamily. This new variant has become one of the most widespread file-encrypting viruses of\n2021.\n\nDJVU was first identified in December 2018. In addition to attacks in the United States, most\nof its victims are from Europe, Asia, South American, and\nAfrica. The DJVU malware uses Advanced Encryption Standard (AES) or RSA\ncryptography algorithms for encrypting files in the victim machine.\n\nThe Cyble research team found a sample of the DJVU malware and performed the technical\nanalysis. We have identified that the malware enters the systems\nof users when they download and execute malicious files masquerading as software cracks\nor keygens that allow users to use paid software for free by downloading from torrent.\n\n**Technical analysis**\n\nThe payload which we have picked for analysis has a hash\nvalue of c6c76994fa516093b3bb1250efa5e5427ff5e7f9aea044692f2b080b0084d21c\n\nThe text section of the malware sample has a high entropy\nvalue, indicating that it is packed/encrypted. The malware has\nbeen developed using the C/C++ language, and its static information is shown in figure 1.\n\n\n-----\n\nFigure 1 Static Information of the Sample\n\nThe screenshot below showcases a schematic representation of\nthe processes (Process Tree) of the malware.\n\nFigure 2 Output of the Malware Process Tree\n\nThe screenshot below shows the API list, along with the anti-debugging APIs.\n\n\n-----\n\nFigure 3 Windows API List Used in the Malware\n\nThe malware payload uses customized AES or RSA encryption\nalgorithms for encrypting files and adding various extensions. In most cases, the infection by\nthe DJVU ransomware can be instantly identified by victims because the files are added\nwith an extension that specifies the name of the virus. The image below clearly shows\nthat in the case of the malware sample we analysed, after encryption the\nfiles are appended with the extension “.QSCX”.\n\nFigure 4 Encrypted Files in the Victim Machine\n\n**Command & Control Communication**\n\nOnce the malware enters the victim machine, it performs an infection sequence in several\nsteps. These involve modifying the system files, changing Windows registry\nentries, and deleting shadow volume copies to avoid file recovery. Next, the parent\n\n\n-----\n\n[executable gets installed into the LocalAppData[5] and then downloads several child files:](https://www.2-spyware.com/remove-djvu-ransomware.html#ref-5)\nupdatewin1.exe, updatewin2.exe, and 1.exe.\n\nThe image below showcases the process in which the malware tries to download and\nexecute malicious payload files.\n\nFigure 5 Payload Delivery and Execution\n\nThe image below shows the ransomware trying to download multiple stagers from various\nURLs.\n\nFigure 6 Malware Downloading Stagers from Various URLs\n\n**Payload download URL: “hxxp://asvb.top/files/penelop/updatewin2[.]exe”**\n\nHere are the evasion techniques used by the malicious dropped files.\n\nUsing a PowerShell script, the malware disables the functionalities of the Windows\nDefender Anti-virus, such as real-time protection.\nThe malware also prevents users from requesting security assistance from various\nsecurity provider websites by changing the victim’s Windows host files.\n\nOnce the encryption process is complete, the malware calls the C2 server with the unique ID\nbased on the victims’ MAC address. As showcased in the image below, the C2 server\nthen responds by providing a personal ID. The malware then generates a scheduled task\ncalled the Time Trigger Task that regularly encrypts newly added files.\n\n\n-----\n\nFigure 7 Personal ID of the Victim Machine Generated by the C2 Server\n\nThe following Wireshark image depicts the post-infection communication between the victim\nmachine and the C2 server.\n\nFigure 8 Communication Traffic Between the Malware and the C2 Server\n\nThe image below illustrates the domain name with which the malware tries to communicate.\n\n\n-----\n\nFigure 9 Domain with which the Malware is Communicating\n\nThe image below showcases the public key hardcoded in the payload source code.\n\nFigure 10 Public Key Hardcoded Within the Malware\n\n**Ransom Note**\n\nThe malware drops a ransom note named _readme.txt in the C drive, asking for a ransom of\n$980/$490 in Bitcoins for the file recovery tool. The ransom note obtained from our technical\nanalysis is shown in figure 11.\n\nFigure 11 Ransom Note\n\n\n-----\n\n**Security Recommendations:**\n\nFollowing are some of the security recommendations that may help avoid the attack from the\nDJVU ransomware variant when successfully implemented.\n\nUse the shared IoCs to monitor and block the malware infection.\nTurn on the automatic software update feature on your computer, mobile, and other\nconnected devices wherever possible and pragmatic.\nUse a reputed anti-virus and Internet security software package on your connected\ndevices, including PC, laptop, and mobile.\nConducting regular backup practices and keeping backups offline or in separated\nnetworks.\n\n**MITRE ATT&CK® Techniques**\n\nTactic Technique ID Technique Name\n\nDefense Evasion [T1027](https://attack.mitre.org/techniques/T1027/) [T1202](https://attack.mitre.org/techniques/T1202/) [T1562.001](https://attack.mitre.org/techniques/T1562/001/) 1. Obfuscated Files or Information 2.\nIndirect Command Execution 3.\nImpair Defences: Disable or Modify\nTools\n\nInitial access [T1078](https://attack.mitre.org/techniques/T1078/) 1. Valid Accounts\n\nDiscovery [T1120](https://attack.mitre.org/techniques/T1120/) [T1082](https://attack.mitre.org/techniques/T1082/) 1. Peripheral Device Discovery 2.\nSystem Information Discovery\n\nImpact [T1486](https://attack.mitre.org/techniques/T1486/) [T1490](https://attack.mitre.org/techniques/T1490/) 1. Data Encrypted for Impact 2. Inhibit\nSystem Recovery\n\n**Indicators of Compromise (IoCs):**\n\n**SHA256**\n\n955d3a37079121cee3f5455349c3edebe843668dfe1a0bd20602d3a6e15b3c20\n\n480558a688a4f9a32e95a98fbb5db32fb18ab77917a20b97c15052cda1e76658\n\n92a8da9880227a443742464a076cbb19668149454b5ef986ff0fdc3c436af245\n\n1c50afaba4d40f2ee163cbdfeebea0e4cc07751c54b7660524b9b9530866af19\n\n9e5717bedcd46ccdadfc0796834f62ca0769b86b26ee58a8eda27e4a2cfbb20f\n\nfd2f84ccf7fd45fb3cd369617e269649735e5b9c0332ff729dd4fd4862af4466\n\na8f64b8c29d1f5aca8548a8767c90e58887dce397702ec1f9cf678b3f13a0b5e\n\n\n-----\n\ncbc8c53b7e19241457a0d54139406edbe7e778f59c079d7d7cc39e44b83131e9\n\nc6c76994fa516093b3bb1250efa5e5427ff5e7f9aea044692f2b080b0084d21c\n\nf32903a5171c64d7cb930258df364dd7c16b7417736b7bd4c12285938b6324ea\n\nf3e15a3d8bca4900653cec63446dc1b831622514479494cf3fea110b76e1e03b\n\n69642c0265410313e3199502bb7766ee8a4369a3747b2a823a896f6cf2ed8cb9\n\n0fbc5d24e63e23fb5ca4d84b8219f51e78a8e02084b454e9c4712d9e7364fc3a\n\n0ce120e71b9776c6057577f2e491dbd785759439350c159e18a05260567e3dcf\n\nf05349da03923bfcfe2c8411429c5f2b022dc7ca40960ad66c1527818039ce74\n\n406852258a93af650ebe04ae214e1bf533527dcf0b2d4127e3ebc0342bfac86b\n\na8179df80d8b09d292559366fa3883b27b9ab84181292a065a869a93b7d1cb92\n\na1296c1e2296049eb3a3dc3fcf174fe91471e0ec0a0c1a753d6103e7a070429f\n\n849a3e76731c918716b6014d8a8d4863996d45eddc5b13b16420ebb106b3cd28\n\nf399f62a06d015a0d54c4692e86e93fe0787d67f8de30b2dc09c30fc4f172e2b\n\nf3135a9b5ffcd2f7abe4d9ad51a3deb7a4c7493e6a9e24a54820894c8b7ed500\n\n5f518816a424635601a46f3fb10db422b12cbd30e2884b62303514267929e799\n\n**URLs**\n\nhxxp://asvb.top/files/penelop/5.exe\n\nhxxp://asvb.top/nddddhsspen6/get.php?pid=657CFB2A6AB1CE9ADA6298A3725A7C1E\n\nhxxp://asvb.top/files/penelop/updatewin.exe\n\nhxxp://asvb.top/nddddhsspen6/get.php?\npid=76C22FD2EA11F0E9961EF5C6D4B2240F&first=true\n\nhxxp://asvb.top/files/penelop/updatewin2.exe\n\nhxxp://asvb.top/files/penelop/3.exe\n\nhxxp://asvb.top/nddddhsspen6/get.php?\npid=F7E0EF544C5C35BFCBAE00FDCB4667E1&first=true\n\nhxxps://api.2ip.ua/geo.json\n\nhxxp://asvb.top/files/penelop/updatewin1.exe\n\n\n-----\n\nhxxps://api.2ip.ua:80/geo.json\n\nhxxp://asvb.top/files/penelop/4.exe\n\n**About Cyble**\n\nCyble is a global threat intelligence SaaS provider that helps enterprises protect themselves\nfrom cybercrimes and exposure in the darkweb. Cyble’s prime focus is to provide\norganizations with real-time visibility into their digital risk footprint. Backed by Y Combinator\nas part of the 2021 winter cohort, Cyble has also been recognized by Forbes as one of the\ntop 20 Best Cybersecurity Startups To Watch In 2020. Headquartered in Alpharetta, Georgia,\nand with offices in Australia, Singapore, and India, Cyble has a global presence. To learn\nmore about Cyble, visit www.cyble.com.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-21 - DJVU Malware of STOP Ransomware Family Back with New Variant.pdf"
    ],
    "report_names": [
        "2021-06-21 - DJVU Malware of STOP Ransomware Family Back with New Variant.pdf"
    ],
    "threat_actors": [
        {
            "id": "bef06c82-0f51-44ba-8451-049cd4ad8a52",
            "created_at": "2023-01-06T13:46:39.325635Z",
            "updated_at": "2025-03-27T02:00:03.05159Z",
            "deleted_at": null,
            "main_name": "MosesStaff",
            "aliases": [
                "Moses Staff",
                "Marigold Sandstorm",
                "DEV-0500"
            ],
            "source_name": "MISPGALAXY:MosesStaff",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536238,
    "ts_updated_at": 1743041172,
    "ts_creation_date": 1653692872,
    "ts_modification_date": 1653692872,
    "files": {
        "pdf": "https://archive.orkl.eu/5f9d77dc8a8e63eb0a2b7e372b13eb0a1b215a52.pdf",
        "text": "https://archive.orkl.eu/5f9d77dc8a8e63eb0a2b7e372b13eb0a1b215a52.txt",
        "img": "https://archive.orkl.eu/5f9d77dc8a8e63eb0a2b7e372b13eb0a1b215a52.jpg"
    }
}