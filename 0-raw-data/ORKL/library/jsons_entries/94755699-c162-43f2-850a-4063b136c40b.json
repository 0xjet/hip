{
    "id": "94755699-c162-43f2-850a-4063b136c40b",
    "created_at": "2022-10-25T16:48:20.294981Z",
    "updated_at": "2025-03-27T02:13:09.661461Z",
    "deleted_at": null,
    "sha1_hash": "975c44773b456562f9ab5f9986c2102a21b618bd",
    "title": "The Inception Framework: Cloud-Hosted Apt",
    "authors": "Bluecoat",
    "file_creation_date": "2014-12-09T15:04:58Z",
    "file_modification_date": "2014-12-09T15:05:25Z",
    "file_size": 2513704,
    "plain_text": "# Whitepaper:  The Inception Framework: Cloud-hosted APT\n\n**By Snorre Fagerland and Waylon Grange**\n**Blue Coat Systems, Inc**\n\n\n## 1\n\n\n-----\n\n**Executive summary**\n\nBlue Coat researchers have uncovered a previously-undocumented, highly\nautomated, and extremely sophisticated framework for performing targeted\nattacks. The framework is notable for a number of reasons, including (but not\nlimited to) its use of a cloud-based infrastructure for command-and-control and its\nuse of the WebDAV protocol to send instructions and receive exfiltrated\ninformation from compromised systems.\n\nInitial malware components were embedded in Rich Text Format (RTF) files.\nExploitation of vulnerabilities in this file format is leveraged to gain remote access\nto victim’s computers.\n\nThe framework, thus far, has been using the services of a cloud service provider\nbased in Sweden, CloudMe.com, for its main command-and-control\ninfrastructure. Malware payloads designed for a wide array of potential devices,\nincluding home routers and mobile devices running iOS, BlackBerryOS or\nAndroid, were also recovered during the course of our research.\n\nThe framework is designed in such a way that all post-infection communication\n(i.e. target surveying, configuration updates, malware updates, and data\nexfiltration) can be performed via the cloud service. The malware components of\nthis framework follow a plugin model, where new malware rely on other,\npreviously delivered malware components to interact with the framework.\n\nInitial attacks were largely focused on Russia and a few other Eastern European\ncountries. However, we have later seen that attackers are interested in targets all\nover the globe.\n\nThe framework is itself target-agnostic, and seems highly automated.\n\nThe operational security exhibited by the attackers is very good - among the best\nwe have seen. Most interaction between attackers and their infrastructure is\nperformed via a convoluted network of router proxies and rented hosts.\n\nAlthough the attackers have left a few clues, we have been unable to provide\nattribution with any degree of accuracy.\n\n## 2\n\n\n-----\n\n**Introduction**\n\nThe use of software vulnerabilities in order to execute malicious software on\nunsuspecting users’ computers is an important parameter to monitor. This\nmethod of attack is not only known to have a considerable success rate, it is also\noften deployed by resourceful attackers and, as such, marks a threat worth\npaying attention to.\n\nThe use of exploits in document formats like PDF, DOC and RTF is in some\nways especially noteworthy. Documents are commonly exchanged via mail,\nwhich make them perfect for email-borne targeted attacks; what is otherwise\nknown as spear phishing.\n\nIn March, 2014, Microsoft published information about a new vulnerability in Rich\nText Format (RTF). This vulnerability, named CVE-2014-1761 (Microsoft Word\nRTF Object Confusion), had already been used effectively by attackers at the\ntime of the announcement. Two previous vulnerabilities in the RTF file format,\nknown as CVE-2010-3333 and CVE-2012-0158, had become, by that time,\nmainstays of targeted attacks, so we tracked how attackers implemented this\nnew exploit with keen interest.\n\nBy late August, we identified a malware espionage operation that used both the\nCVE-2014-1761 and CVE-2012-0158 vulnerabilities to trigger execution of the\nmalicious payload, and which leveraged a single cloud service as the backbone\nof its entire visible infrastructure.\n\nWhen we examined the suspicious documents, it was discovered that they were\nsomewhat anomalous compared to the run-of-the-mill material. They turned out\nto belong to a highly advanced and professional targeted attack framework,\nwhich utilized a complex series of techniques to survey potential targets.\n\nDue to the many levels of obfuscation and indirection, we named this the\n_Inception framework; but there ends all similarity with the movie by the same_\nname. Leonardo DiCaprio is not associated with this investigation.\n\n## 3\n\n\n-----\n\n# PART I: \n\n CloudMe\n\n\n## 4\n\n\n-----\n\n**Use of trojanized documents**\n\nWe initially knew little about who the actual targets were; apart from one. In that\nparticular case we had the actual phishing email, so we knew the apparent\nrecipient – the CEO of a large Russian bank. The email was apparently sent from\n“Mrs. World”; note the Mrs., and not Miss - World.\n\nThe weaponized Microsoft Word document attached to the email message\n(“photo.doc”) contained two separate exploits: one targeting the vulnerability\ndetailed in CVE-2012-0158 (MSCOMCTL ActiveX Buffer Overflow); the other\ntargeting the aforementioned CVE-2014-1761.\n\n## 5\n\n\n-----\n\n_Above: “Mrs. World”. Text and picture apparently taken from the news site mk.ru_\n\nWe soon discovered that our malware repository contained several other, similar\ndocuments, but these had come from other sources which did not include the\nemail message, or any identifiable information about the targets. However, the\ntext of the documents covered a variety of topics mostly revolving around\nRussian issues relating to a variety of business sectors. The following pages\nhighlight a representative selection of these documents.\n\n## 6\n\n\n-----\n\n_An article cribbed verbatim from the_\n_Novye Izvestiya news Web site_\n_about the Russian financial situation_\n_in light of the Ukrainian crisis._\n\n_An application form to participate in_\n_a seminar supposedly organized by_\n_Russia’s Federal Service for_\n_Defense Contracts (“Федеральная_\n_служба по оборонному заказу”)_\n_scheduled for Sept 24/25 2014._\n\n_An article, in English, about the_\n_Ukraine situation taken from the_\n_Financial Times (UK) newspaper._\n\n_An “advertisement” from a supplier_\n_of diesel engines and related_\n_mechanical services. The letter lists_\n_the Russian navy and the Border_\n_Guard department of the FSB_\n_among their customers._\n\n## 7\n\n\n-----\n\n_“Organigrama Gobierno Rusia.doc”_\n_– a summary profile of several high-_\n_level Russian government officials –_\n_originally submitted to VirusTotal_\n_from an IP address in Spain._\n\n_An advertisement of a used car for_\n_sale that purportedly originated from_\n_an employee at the German_\n_Embassy in Moscow._\n\n_Invitation to Russian Art Week_\n\n## 8\n\n\n-----\n\n**Document metadata**\n\nAll documents that we have found so far have been rather standard Word\ndocuments, of the old 97-2003 compatible format based on OLE2.\n\nSuch documents can, and typically do, contain quite a bit of metadata: The name\nof the document creator; the user who edited it most recently; the name of the\ncompany whose copy of Word was used to create the document, et al. Users can\noptionally configure Word to remove this metadata when a document is saved,\nand that’s exactly what the creator of these documents did, stripping out this\npotential source of attribution data.\n\nHowever, Word documents in this format contain additional information, if you\nknow where to look.\n\nAll Word documents of this format contain what’s known as a File Information\nBlock (FIB). The FIB contains information about the file’s internal structure, and\nalso – to some extent – data on the program used to create the file. In the case\nof the samples we analyzed, all of the documents were saved using the same\nbuild of Microsoft Word from Office14 (better known as Office 2010).\n\nIn addition, documents can contain slack space in which old data remains. For\nexample, the decoy that came with the attack named “Organigrama Gobierno\n_Rusia.doc” contains Visual Basic leftovers indicating that it originally was created_\non a computer that was configured to be used by a native Spanish speaker,\napparently by an advisor at the Spanish Embassy in Moscow. This document\nwas presumably obtained by the attackers and repurposed for the attack.\n\n## 9\n\n\n-----\n\n**Targeted verticals**\n\nDespite the limited information at our disposal about the targets of these attacks,\ntheir content reveals some context about who the possible targets may have\nbeen.\n\nFirst of all, we have the decoy documents which indicate an interest in:\n\n   - Embassies\n\n   - Politics\n\n   - Finance\n\n   - Military\n\n   - Engineering\n\nWe also have a set of phishing mails, which were targeted at:\n\n   - The finance sector in Russia\n\n   - The oil and energy industry in Romania, Venezuela, and Mozambique\n\n   - Embassies and diplomats from various countries\n\n## 10\n\n\n-----\n\n**Shellcode**\n\nThe shellcode used is a pretty standard variant previously used by a number of\ncampaigns typically operating out of China, but with some minor changes. The\nmalicious content is stored inside the document in encoded form, and the\nshellcode decodes and writes this to disk.\n\n_Above: The decoding loop_\n\nUpon successful execution this code drops a Word document and a Visual Basic\nscript. The Word document is displayed to the user to avoid arousing any\nsuspicion while the script is executed in the background.\n\nUnusual for many exploit campaigns, the names of the dropped files vary; for\nexample HyHa9AJ.vbs, ew_Rg.vbs, 0_QHdN.vbs, etc. – clearly randomized in\norder to avoid detection by name.\n\n## 11\n\n\n-----\n\n**Visual Basic Script dropper**\n\nThe VBScript dropper code is also a little unusual. It declares a Windows\nManagement Instrumentation (WMI) object in order to reach components like the\nregistry and file system. This seems adapted from Microsoft example code, like\nthe one found at [http://msdn.microsoft.com/en-us/library/aa387236(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/aa387236(v=vs.85).aspx)\n\nWhen the VBSript is run it drops two files to disk. One is a polymorphed dll file\nand the other a binary data file with no obvious internal structure. This data file\nturns out to be encrypted using AES-256.\n\n## 12\n\n\n-----\n\nThe files will be installed in several locations:\n\n_%WinDir%,_ _ex. “C:\\Windows”._\n_%APPDATA%,_ _ex. “C:\\Users\\USERNAME\\AppData\\Roaming”_\n_%ALLUSERSPROFILE%, ex. “C:\\ProgramData”_\n_%CommonProgramFiles%, ex. “C:\\Program Files\\Common Files”_\n_%USERPROFILE%,_ _ex. “C:\\Users\\USERNAME”_\n\nThese locations will vary some between operating system versions.\n\nThe VBScript then sets a startup key in the\n“HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run” registry path to\nexecute the DLLs at boot time.\n\nRegardless of whether the registry launches the DLL or when another malware\nexecutable starts the DLL directly, the DLL is launched using regsrv32.exe with\nthe /s (silent) option.\n\nThe names of these dropped files change from attack to attack. The one above\ndrops ctfmonrc.dll. Other names observed were:\n\nctfmonm.dll\nctfmonrn.dll\nwmiprvse.dll\nalg.dll\ndwm.dll\n\nThe encrypted data files are named using random words apparently taken from a\ndictionary – “acholias”, “arzner”, “bicorporate”, “crockrell”, “damnatorily” etc.\n\n## 13\n\n\n-----\n\n**DLL payload**\n\nLooking at one of the dropped dlls we can see the authors originally called it\n_95Num3P3gm.dll.polymorphed.dll. When executed it will rebuild the original dll_\n(95Num3p3gm.dll, presumably), load it from memory and pass over execution.\n\n_In the early stages of our research, most other payloads followed the same_\n_naming convention, eg., fvK3J15B5d.DLL.polymorphed.DLL;_\n_LvwU9gnFO.DLL.polymorphed.DLL; NR5vaFTe9R.DLL.polymorphed.DLL;_\n_hs78lg7x5F.DLL.polymorphed.DLL, etc. More recently collected samples no_\n_longer contain the “polymorphed” string._\n\nIt is hard to describe the polymorphed dlls with any real depth, as there is little\nconsistency between them. When two nearly identical dlls are encoded using the\npolymorphic scheme there is very little code in common. The call graphs are\ndifferent and key functions have varying number of arguments. The polymorphing\nmechanism also generates, and inserts, unique functions all of which make calls\nto different floating-point operations – all done just to obfuscate the actual\ndecoding process. The sizes of buffers allocated are also randomized to mask\ntheir intent.\n\n## 14\n\n\n-----\n\n_A portion of one of the dynamically generated functions._\n\nWhat is common is that somewhere along the execution cycle is one extremely\nlarge function (over 200 kb in length) where early in a large allocation is made\nwhere the un-obfuscated binary will be placed. The binary is then built from deobfuscating segments of it that have been dispersed through the ‘.rdata’ section.\nThe order, size, and locations of these segments vary from build to build but\nsomewhere near the end of the large function there will be a call to a subfunction\nthat loads the PE image into memory, followed by a call to free the PE image\nallocation from memory. Simply halting execution before this function call permits\na researcher to extract the reconstructed DLL from memory.\n\n## 15\n\n\n-----\n\nHere, pausing execution before the call to ‘load_pe_from_memory’ reveals the\nextracted PE at the memory address pointed to by edx.\n\nThis reconstructed DLL, once loaded, will decode a configuration structure from\nits ‘.data’ section which contains three important details: the name of the\nencrypted data file dropped by the VBScript; the AES key used to decrypt the file;\nand the name of a unique global mutex to hold while running to prevent multiple\ninstances.\n\nThis configuration information is used to load the encrypted file into memory and\ndecrypt it. This turns out to be yet another dll. The first ordinal exported by this dll\nis located and then called, passing in the configuration and the name of the\nencrypted file on disk as parameters.\n\n## 16\n\n\n-----\n\nThis last dll is the heart of the threat (originally called q5Byo.dll in this instance.\nThis file contains the true intent of this campaign. It is designed as a survey tool.\nThe PE file gathers system information including OS version, computer name,\nuser name, user group membership, the process it is running in, locale ID’s, as\nwell as system drive and volume information. All of this is encrypted and then\nsent to cloud storage via WebDAV.\n\n## 17\n\n\n-----\n\n_The malware installation chain_\n\n\n## 18\n\n\n-----\n\n**WebDAV cloud usage**\n\nWebDAV is a communication standard that allows file management over HTTP\nor HTTPS. Windows allows WebDAV sessions to be mapped as network\nresources.\n\nThe use of WebDAV as the communication channel is atypical for most malware\nsamples we see. By using a network resource, the actual web traffic originates\nfrom the system itself, and not from the process in which the malware resides.\nAdditionally, once the resource is established, the malware can transfer files to\nand from the command and control servers using standard file IO commands.\n\nAll the authentication information for the WebDAV session including the URL,\nfolders, path, user name, and password is stored within this last DLL in another\nAES-encrypted configuration structure in the binary.\n\nA unique path, username, and password were used for each malware instance\nwe’ve seen in the wild. This allows the attackers to uniquely identify every\ntargeted attack and track how successful each phishing campaign is.\n\nAlso contained within the configuration structure is information on how to name\nthe survey data on the remote file server. The binary reads from its configuration\na string on how to generate the remote filename, and a list of extensions to use.\nAn example would be “_1-7d_0-8s”, [“TIF”, “TAR”, “SIT”] which instructs the\nbinary to generate a filename with 1 to 7 numeric digit characters followed by 0 to\n8 ASCII letters with one of the three listed extensions such as “664gher.TAR”.\nThe survey is then uploaded to the server in a specified folder with the generated\nname.\n\nFiles are compressed using a modified LZMA-compression and encrypted using\nAES cipher-block-chaining (CBC) before being uploaded to the cloud server.\n\nThe binary also checks a separate folder on the cloud service designated to\ncontain new configuration information. If such a file is present on the server, the\nmalware downloads the new configuration file then deletes it from the server.\n\n## 19\n\n\n-----\n\nThe cloud storage provider in every case we have seen was the Swedish\ncompany CloudMe.com, which offers free and paid WebDAV cloud storage.\n\nThe URI model used by the malware is\nhttp://webdav.cloudme.com/%username%/CloudDrive/ which is a direct\nreference to file storage.\n\n_It must be noted that the CloudMe service is not actively spreading the malicious_\n_content; the attackers are only using it for storing their files._\n\nWe notified CloudMe.com about the abuse of their services. Their CEO, Mr.\nDaniel Arthursson, was none too happy about this, and was very helpful in our\nfurther research. CloudMe has shared a great deal of log information related to\nthis attack. These indicate that there are many other accounts (over 100) likely\nrelated to this attack system. We have no way of verifying this with absolute\ncertainty, but this is what we regard as a high confidence assumption.\n\n## 20\n\n\n-----\n\n_Distribution of logged victim connections towards CloudMe._\n\nThe cloud accounts are not used for one-way communication only. The malware\nalso checks configured subfolders for updates; and if these are found they will be\ndownloaded, decrypted and used as appropriate.\n\nOne such case is the franko7046 account, used against the previously\nmentioned bank CEO. In this account there was hidden another encrypted\nconfiguration file which the malware downloaded and decrypted.\n\n_Above: The configuration file of the depp3353 account. Password is redacted._\n\n## 21\n\n\n-----\n\nThis is how we found the depp3353 account. In this new account there was\nanother surprise waiting for us – a download folder with two new encrypted files,\n921.bin and 922.bin. Once decrypted, these turned out to be PE executables.\n\n**Downloaded plugins: Cloud persistence**\n\nThe two new executables are plugins - quite similar to each other and obviously\ncompiled on the same setup. They are lightweight and intended to pull specific\nsurvey information from their target. Of interest, both of the DLLs originally had\nthe same internal name (78wO13YrJ0cB.dll). Presumably the same PE\nsanitization script and parameters were used on both.\n\nNone of these plugins contain any means of CnC communication. Instead, when\nthey are executed they are passed a pointer to a function to use for sending data\nback home. Neither are they ever written to disk. They are executed in memory\nonly, and once they have completed the memory is freed. This makes these\nmodules extremely stealthy, flexible and compatible with multiple toolsets\nindependent of what CnC method is being used.\n\n921.bin retrieves several datapoints about the infected machine: Domain info; a\nlist of running processes with all loaded modules in each; the list of installed\nsoftware; and a complete hardware profile of the target machine. 922.bin\ncompiles a dirwalk – a complete listing of every file path – of each fixed drive. All\nof this information is exfiltrated back via the same WebDAV connection.\n\nThis model makes it possible to do the intrusion in steps, with verification stages\nin between; and the files will not be easily found on affected computers.\n\nBased on the information gathered from these modules, the attackers appear to\nmove to the next stage of their attack by placing more new components on the\nWebDAV shares. Information about these uploads is limited by the fact that we\ndo not have the AES keys to decrypt much of the uploaded data, but we have\nbeen able to see some upload patterns.\n\nWhat we assume to be third-stage plugins appear on the shares as *.bin files of\nroughly 72kb. As with other plugins, these are downloaded and deleted from the\nshare in one go. However, the next day, another *.bin file of the same size will be\nuploaded to the share. This is a pattern that repeats itself over all live accounts. It\nseems that because the plugins exist in memory only, they are injected daily to\nensure persistence on victim computers. Our theory is that this malware is a\nmore typical datastealer, and we have observed that after this type of file is\nplanted on the account, encrypted data uploads from compromised users\nincrease.\n\n## 22\n\n\n-----\n\n**The Sheep and the Wolves**\n\nVictims of this attack will connect using the Windows WebDAV redirector, and\nthe HTTP request user-agent string will reflect this. For Windows XP this will\ntypically be “Microsoft-WebDAV-MiniRedir/5.1.2600”, and for Windows 7 a\ncommon user-agent is “Microsoft-WebDAV-MiniRedir/6.1.7601”.\n\nSecurity researchers – and there are a few of them - connect in a variety of ways;\nfirst of all, we see a number of connections that are indistinguishable from the\nway victims connect. This happens when researchers use lab machines with live\ninternet access to run the malware. The only way we can tell these are\nresearchers is because they connect from IP address ranges that are unlikely to\nbe victims; and they also tend to consist of short-lived sessions.\n\nSome researchers set up scheduled tasks to scan the shares for new updates\nand malware. We see a few variations of these – one typical configuration is\nwhere the requests contain a Python-related user-agent string.\n\nAttackers, on the other hand, don’t appear to use Windows.\nCommon across multiple accounts, multiple IP’s, and over time, is that the\nprobable attackers have used a HTTP user-agent of “davfs2/1.4.6 neon/0.29.6”.\n\nWe know these are not researchers, because we can see malware files being\nuploaded by them:\n```\n[17/Sep/2014:09:42:38 +0200] \"PUT\n/white3946/CloudDrive/QxM9C/st/V1oINDJtnqy/1768.bin\nHTTP/1.0\" 201 0 \"-\" \"davfs2/1.4.6 neon/0.29.6\"\n\n```\n_Above: Log entry for the account white3946. We have been unable to locate the_\n_malware that uses this account._\n\nWe have a log fragment in which the attackers uploaded a sequential series of\nupdates (from 1746.bin to 1774.bin) within 1.5 hours on Sept 17[th], spread over\n27 different accounts and using 27 different IP addresses in the process.\n\nThe user-agent string shows that attackers likely have used a client based on the\nopen source davfs2 file system for Linux to mount the WebDAV shares.\n\n## 23\n\n\n-----\n\nThis client is used when uploading new malware, but also when the attackers\nscan their shares for new victim updates, in which case the shares are\nenumerated by requests in a scheduled manner.\n\n_An attacker scans the tem5842 account for updates._\n\n_At intervals, scans hop to new IP addresses._\n\nThe attackers have used a large number of IP addresses to access the shares.\nAs mentioned above, there is a rotation scheme in place in which a new IP\naddress will be used after a few minutes of access against CloudMe accounts.\n\nThese IP’s are distributed widely over geographical locations and service\nproviders, with a heavy bias towards South Korean ranges.\n\n## 24\n\n\n-----\n\nS. Korea 85 Australia 1\nChina 7 Austria 1\nUnited States 7 Bulgaria 1\nBrazil 5 Canada 1\nSweden 3 Denmark 1\nCzech Republic 2 France 1\nNorway 2 Germany 1\nRomania 2 Kuwait 1\nRussia 2 Latvia 1\nSpain 2 Ukraine 1\n\n_Distribution of attacker IP addresses_\n\nAt first we thought these IP’s belonged to some commercial proxy service,\nparticularly since several such proxy services also offer IP rotation. However, this\nturned out to be a wrong assumption.\n\n## 25\n\n|S. Korea|85|Australia|1|\n|---|---|---|---|\n|China|7|Austria|1|\n|United States|7|Bulgaria|1|\n|Brazil|5|Canada|1|\n|Sweden|3|Denmark|1|\n|Czech Republic|2|France|1|\n|Norway|2|Germany|1|\n|Romania|2|Kuwait|1|\n|Russia|2|Latvia|1|\n|Spain|2|Ukraine|1|\n\n\n-----\n\n# PART II: \n\n Support infrastructure\n\n\n## 26\n\n\n-----\n\n**An embedded device proxy network**\n\nA superficial examination of the proxy IP addresses that connected to CloudMe\nshowed them to be internet-connected devices of various kinds. Many were\nKorean Tera-EP home routers; but there were several other products\nrepresented.\n\nIt is believed that the attackers were able to compromise these devices based on\npoor configurations or default credentials.\n\nWe were able to do some forensic work on a compromised Tera-EP TE-800\ndevice and discovered another dimension of the attacker’s infrastructure.\n\n## 27\n\n\n-----\n\n**Router malware**\n\nUnder the ramfs mounted partition we found a stripped and statically linked\nMIPS-el binary named tail-. Instances of this were also found under the running\nprocess list.\n\n**_tail- serves as a SOCKS proxy for the attackers. Each sample of the binary we_**\nwere able to acquire was configured with a unique 32byte blowfish key and a\nsmall, encrypted section appended to the end of the binary.\n\nUpon execution the binary uses its hardcoded key to decrypt the configuration\nsection and retrieve the listening port to use for incoming connections. This acts\nas a management interface. From here the attackers can request a specific port\nto be opened as one of the following types: SOCKET, SOCKSS, SOCKAT,\nSOCKS5, or STATUSPORT.\n\nTo prevent anyone else from accessing this service all communication on the\nmanagement interface is encrypted using the same blowfish key. This means\nthat the attackers must maintain a list of where each of these implants are\ninstalled, as well as what port and key each is configured to use.\n\nThis setup makes it difficult to identify embedded devices compromised with this\nmalware by scanning open ports.\n\nIn the wild we witnessed the attackers connect to the management port and\nrequest SOCKSS connections. This would open the specified port and wait for\nconfiguration data, which consists of a domain name (webdav.cloudme.com), the\ndestination port, and a variable length RC4 key, all of which encrypted using the\nblowfish key.  Once received the malware would attempt to connect to the\ndomain name on the specified port and would start tunneling all traffic received\nfrom the SOCKSS port to the destination and vise-versa. The communication\nbetween the attacker and the SOCKSS is encoded using the RC4 key. The\ngraphic below illustrates a typical session.\n\n## 28\n\n\n-----\n\n**Additional servers**\n\nThe router proxy network provides another layer of indirection masking the\nattackers’ infrastructure. However, because we captured traffic through one of\nthese embedded devices we could identify other parts of their operation.\n\nWe identified four IP addresses that connected to the proxy malware:\n\nCloud enumerator:\n_Apparently a rented server at AS34224 NETERRA-AS, Bulgaria_\n\nThis host belongs to a Bulgarian VPS service and would use the router proxy to\nconnect to webdav.cloudme.com. This host does all scanning of webdav shares\nfor stolen user data, and also uploads new malware components.\n\nHealth checker:\n_Apparently a rented server at AS5577 ROOT root SA, Luxembourg._\n\nThis IP would make connections hourly and poll the status of the router proxy\nmalware. This machine is most likely used to track which compromised routers\nare currently available for use.\n\nUnlocker:\n_Apparently a rented server at AS52048 DATACLUB DataClub S.A. Latvia._\n\nTraffic from this IP had a very specific purpose: It unlocked routers for proxying in\nconnection with the sending of phishing emails.\n\nIn the wild we observed this IP connect to our router on the malware\nmanagement port and specify a SOCKSS proxy port to be opened. Immediately\nafter, the newly opened port would be connected to by another IP and used to\nsend phishing emails with malicious attachments.\n\nHowever, later we observed that the Email sender IP at VOLIA vanished and the\nUnlocker server taking over its role as well.\n\nEmail sender:\n_An IP at AS25229 VOLIA-AS, Ukraine. Possibly a compromised host._\n\nAfter a router SOCKSS port was opened by Unlocker, this IP would connect to\nthe opened port and tunnel its email traffic through the router.\n\nEach of these connections used the correct encryption key, so we know that\nthese accesses came from the attackers and not some opportunistic third party.\n\n## 29\n\n\n-----\n\nMail proxies:\n\nThrough our router monitoring we identified two mail proxies used by the\nattackers. We were later notified by Symantec (thanks, guys!) about a third.\nThese servers were hosted on domains that were registered by the attackers,\nusing domain names clearly meant to look legitimate. This is the only time we\nhave seen attackers register domains in this investigation.\n\nThe mail proxies were:\n\n_haarmannsi.cz_ : Spoof of the legitimate domain haarmannsi.com\n_sanygroup.co.uk_ : Spoof of the legitimate domain sanygroup.com\n_ecolines.es_ : Spoof of the legitimate domain ecolines.net\n\nRegistrant WHOIS information seems forged:\n\n**haarmannsi.cz**\n```\nname: Sanyi TERRAS\naddress: R. FREI CANECA 1120 \n      SAO PAULO\n      01307-003\n      BR\ne-mail: sanyi_terras@outlook.com\ncreated: 12.06.2014\nNS:  ns*.frankdomains.com\n\n```\n**sanygroup.co.uk:**\n```\nname:  Alan\naddress: Uddmansgatan 13\n      Pitea\n      Norrbottenalän\n      94471\n      SE\ncreated: 06.05.2014\nNS:  ns*.domains4bitcoins.com\n\n```\n**ecolines.es:**\n```\nname:  Lyisa Almeida\naddress: N/A\ncreated: 04.06.2014\nNS:  ns*.frankdomains.com\n\n```\n.\n\n## 30\n\n\n-----\n\n**Observed phishing emails**\n\nThe connections made from the Ukrainian host to the router were interesting.\nAfter being proxied though the router, each of these would authenticate with one\nof the dedicated mail proxies and send out phishing attacks.\n\nFrom captured traffic it appears that the mail proxies have SOCKSv5 services\nrunning on obscure high ports. We have documented that the attackers log in to\nthese using apparently randomly generated usernames and passwords, a unique\npair for each server. The mail proxy would then relay the spearphishing mail as\nseen below.\n\n_Above: Captured SMTP session, sending the malicious attachment MQ1474.doc_\n\nThis way the attack can be mistaken to come from legitimate businesses and\ntrusted organizations. In some cases the organization from which the phishing\nemail originates would appear to be a known associate to the target.\n\n## 31\n\n\n-----\n\nThe email shown above was one of a number of messages sent to targets in the\noil industry. Investigating the target email addresses, we saw several of these\nwere found in this public document from the World Petroleum Council, including\nsome addresses that are, at the present time, no longer valid.\n\nAnd then, the ground shifted again.\n\n## 32\n\n\n-----\n\n# PART III: \n\n Attacks on mobile devices\n\n\n## 33\n\n\n-----\n\nOne of the spearphishing mails we observed coming through the router network\nwas this one, sent to an address under the gov.py (Government of Paraguay)\ndomain.\n\n_Get WhatsApp now for your iPhone, Android, BlackBerry or Windows Phone_\n\nThere was no executable attachment in this mail, but instead a link shortened by\nthe URL shortener service bit.ly, with the underlying link pointing to an IP address\non a Dutch hosting service. Clicking that link from a Windows PC only yielded a\nredirection to the BBC homepages, and using other devices did not give more\ndata.\n\nThe bit.ly service does however provide information on the user creating the\nshortened link, and other links associated with this account. In this case, the user\nwas named nicolatesla53.\n\n## 34\n\n\n-----\n\n_The nicolatesla53 bit.ly profile page_\n\nThe nicolatesla53 account was created in July 2014. From Oct 24[th] to Nov 21[st]\nthis user created nearly 10000 shortened links – we harvested 9990 unique\nones. Three IP addresses were used for these links:\n\n82.221.100.55\n82.221.100.60\n94.102.50.60\n\nThe links themselves were on this format:\n\nhttp://server_ip/page/index?id=target_identifier&type2=action_code\n\nAs far as we were able to tell, there were three main types of action_code:\n\n743 : Serve malware disguised as WhatsApp updates\n1024 : Serve malware disguised as Viber updates\nother : Serve MMS phishing content. The code identifies mobile operator and\ndetermines which logo will be displayed when the user follows the link.\n\n## 35\n\n\n-----\n\n**MMS Phishing**\n\nWe have no sample of the actual MMS phishing messages apparently being\nsent, but we can see the page served when a user clicks a spammed link. This is\njust a dialogue box asking for the password presumably included in the initial\nmessage, and the next stage likely involves download of malicious content.\n\n_The password screen for action code 16611 (TELE2)_\n\nWe were in the middle of harvesting the servers for data on the various action\ncodes when they all were abruptly taken offline; so our data on which mobile\noperators are targeted is not complete. We managed to get 66 of a total of 190.\nThe ones we know of are shown below. A full breakdown of mobile operators\nand related links is included in the appendix.\n\n## 36\n\n\n-----\n\nThe composition of links created for the various mobile operators is quite\ninteresting, as one can speculate that they represent amount of actual or planned\nattacks in different countries. With the top three operators being Vodafone, TMobile and Proximus (Belgacom) it seems these apparent phishing attacks are\nless focused on the Russian sphere than the previously discussed malware.\n\nThis map is not complete, though. It represents only about 35% (66/190) of all\nmobile operators targeted and 66% (3152/4781) of all phishing links we managed\nto harvest. In addition, some operators like Vodafone are global actors, so the\nmap might show an unfair intensity in their HQ locations.\n\n_MMS phishing heat map_\n\nThe rest of the bit.ly links used the action codes 743 or 1024. And now things\nreally get interesting. By using mobile device HTTP User-Agents we were able to\ntrigger downloads of malware components from some of these links.\n\n## 37\n\n\n-----\n\n**Mobile malware: Android**\n\nAccessing the link from an Android User-Agent initiated a download of an\nAndroid installer package named WhatsAppUpdate.apk. The package we\nanalyzed was 1.2MB in size.\n\nThe apparent main purpose of this malware is to record phone call audio.\nRecordings are stored as *.mp4 files, and uploaded to the attackers periodically.\n\nThe malware is able to collect a lot of other information, not all of which is\nactually used:\n\n  - Account data\n\n  - Location\n\n  - Contacts\n\n  - External and Internal Storage (files written)\n\n  - Audio (microphone)\n\n  - Outgoing calls\n\n  - Incoming calls\n\n  - Call log\n\n  - Calendar\n\n  - Browser bookmarks\n\n  - Incoming SMS\n\nThrough the encrypted C&C protocol, the attackers can issue commands and\nbinary updates to the malware.\n\nIt uses a custom DAO/Database scheme which uses accounts belonging to the\nvirtual community Live Journal (livejournal.com) as data stores. Three such\naccounts were found hardcoded in the package:\n\nThe accounts all state that they belong to Iranian users. This is very likely false.\n\n## 38\n\n\n-----\n\nThe text in these posts starts first out in cleartext, but quickly turns into\nunreadable gibberish. The HTML source code reveals that the encoded portion is\nencapsulated in blog-index tags:\n\nThe three accounts contain different configuration blocks pointing to C&C servers\napparently located in Poland, Germany and Russia, respectively. Based on\nregistration data and folder configuration we believe these are legitimate but\ncompromised Joomla servers.\n\nAnd then an unexpected oddity shows up in the Java source:\n\n_The sign in front of SizeRandomStr is “Truti” - a Hindi word meaning “Error”._\n\n## 39\n\n\n-----\n\nWe were also able to download a similar malware sample (BrowserUpdate.apk)\nfrom one of the C&C servers. This sample used different online accounts for its\nDAO/database functionality, but is otherwise quite similar to the first.\n\n## 40\n\n\n-----\n\n**Mobile malware: Apple IOS**\n\nUsing an IOS User-Agent triggered the download of a Debian installer package,\nWhatsAppUpdate.deb, also 1.2Mb in size.\n\nThis application impersonates a Cydia installer, and can only be installed on a\njailbroken phone.\n\nOnce installed, it may collect\n\n  - Device platform, name, model, system name, system version\n\n  - ICCID\n\n  - User’s address book\n\n  - Roaming status\n\n  - Phone number\n\n  - Carrierbundlename\n\n  - Iso country name\n\n  - Carrier name\n\n  - Wifi status\n\n  - MAC address\n\n  - Device battery level\n\n  - Free and total space\n\n  - Cpu frequency and count\n\n  - Total and user memory\n\n  - Maxsocketbuffersize\n\n  - Language local identifier and language display name\n\n  - Default and local time zone\n\n  - Account data: AccountAvailableServiceTypes, AccountKind,\nAccountSocialEnabled, etc\n\n  - AppleID\n\n  - CreditDisplayString\n\n  - DSPersonID\n\n  - IOS specific data; ex LastBackupComputerName,\nLastBackupComputerType, iTunes.store-UserName, iTunes.storedownloaded-apps etc.\n\n## 41\n\n\n-----\n\nThese data are encrypted and uploaded to an FTP account which is taken from\nan encrypted configuration file named /usr/bin/cores.\n\nIn this particular case, the FTP account is located on a legitimate (if struggling)\nhosting service in the UK.\n\nIn this case, there’s another clue:\n\n_The project path in the package contains the name JohnClerk._\n\nThe WhatsAppUpdate project seems derived from an earlier template named\nSkypeUpdate.\n\n## 42\n\n\n-----\n\n**Mobile malware: Blackberry**\n\nBy now, it came as no surprise when we triggered a download with a BlackBerry\nUser-Agent. The initial download was a Java Applications Descriptor, a text file\ndesigned for Over-The-Air installation of Java-based applications. This JAD file\ncontained the locations of the two Blackberry *.COD binaries which we then\ncould download directly.\n\nThe application impersonates a settings utility. This collects:\n\n  - deviceName, manufacturerName\n\n  - platformVersion, softwareVersion\n\n  - brandVendorId, brandVersion\n\n  - total and free flash size of the device\n\n  - amount of memory/storage already allocated\n\n  - ownerName, ownerInformation\n\n  - Phone mumber\n\n  - PIN\n\n  - IMSI\n\n  - IMEI\n\n  - mcc and mnc (Mobile Carrier ID)\n\n  - cellID\n\n  - Location area code\n\n  - isPasswordEnabled\n\n  - Battery data (level, temperature, voltage, etc)\n\n  - Installed applications\n\n  - Address book\n\n  - APChannel\n\n  - Connected Network Type\n\n  - BSSID\n\n  - DataRate\n\n  - Profile Name\n\n  - RadioBand\n\n  - SecurityCategory\n\n  - SignalLevel\n\n  - SSID\n\nCollected data will be uploaded to a DynDNS domain currently hosted on a US\nwebhosting service.\n\n## 43\n\n\n-----\n\n_“God_Save_The_Queen” is used as a reference in one of the Blackberry_\n_binaries._\n\nSince these COD files are also compiled Java code, they are possible to\ndecompile to original source code. In a similar fashion to the Android version, we\nfind interesting strings there. This time they are in Arabic:\n\n_“Reading files” in Arabic_\n\n## 44\n\n\n-----\n\n# PART IV: \n\n Attribution\n\n\n## 45\n\n\n-----\n\n**Timelines and activity patterns**\n\nThe earliest sample of Inception-related malware we have been able to obtain,\nwas submitted to us in June 2014. However, decoy document metadata shows\nthat it was created late May. The related cloud account was created just before\nthat. An examination of the other documents associated with the attacks show\nthat they have been created at a steady pace all through summer and autumn\n2014 and attacks are still ongoing.\n\nOf interest is also the attackers’ activity patterns over the 24h cycle. The main\nupload of new components to shares seems to be divided over two high–activity\nperiods: 6:00 -10:00 UTC and 17:00 - 21:00 UTC. No uploads were seen\nbetween 23:00 and 05:00 UTC.\n\nIt is however doubtful how indicative these timeframes are. To illustrate, we\nlooked into another and more obscure timing factor: The timing of the AES\nInitVector random seeds. A random seed is the initial value passed into a\npseudo-randomizer function. The malware uses the random output to create\nwhat is known as an InitVector - a starting point for the AES\nencryption/decryption function.\n\nThe code used in some of the DLLs indicate that the attackers tend to use the C\ntime() function to generate random seeds. This function returns values of\ngranularity down to seconds. Thus random seeds, and ultimately the InitVectors,\nare functions of these quite coarse units of time.\n\nThe encrypted files uploaded to the WebDAV shares come with their InitVectors\nstored at the end of the file. Since we know the time window to be within a few\ndays of the upload time we were able to brute force the time values that would\ngenerate the corresponding InitVectors. Thus, we were able to say to the second\nwhen the file was created – and most times were identified to be in the range\n1500 - 2200 GMT.\n\nUnfortunately, we had to reject these data. The file creation times turned out to\nbe hours after the files themselves were uploaded to the WebDAV share. Either\nthe attackers’ system clock is wrong or a fixed offset is added to the random\nseed. Either way, the data can’t be trusted; and shows that nothing can be taken\nat face value.\n\n## 46\n\n\n-----\n\n**The Chinese connection**\n\nOn at least two occasions during our surveillance of the Inception framework, the\nmalware downloaded something unexpected and wholly different from what we\nhave discussed until now.\n\nThese files were downloaded as encrypted *.bin files from the accounts\n_carter0648 and frogs6352. When decrypted, these turned out to be dropper_\npackages containing one dropper executable clearly created for the Inception\nframework, and one other, very different executable.\n\nThis executable, (sccm.exe, md5 dd8790455109497d49c2fa2442cf16f7) is a\nclassical Chinese APT implant. It is a downloader and remote shell program,\ndesigned to connect to a C&C server to interact with the attacker and/or\ndownload more malware.\n\nThe C&C server in this case is ict32.msname.org.\n\nWhen connecting to this server, sccm.exe issues the following request:\n\n_POST /check.jsp HTTP/1.1_\n_Accept: */*..Accept-Language:en-us_\n_Content-Type: application/octet-stream_\n_Accept-Encoding: gzip, deflate_\n_User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)_\n_Host: www.antivir.com_\n_Content-Length: 8_\n_Connection: Keep-Alive_\n_Cache-Control: no-cache_\n\nThis C&C domain is used by many other malwares related to sccm.exe; some of\nwhich share obvious connections to the Quarian malware family, a known APT\nintrusion tool.\n\nThis development was unexpected for several reasons. First of all, it apparently\nbreaks the strict, obfuscatory operational security built into the Inception\nframework. Inception has the capacity to perform all steps needed for scouting\nout and exfiltrating data without resorting to traditional hosted command &\ncontrol. By using a well-understood APT tool and a known malicious C&C\ndomain name, the attackers permit much clearer attribution.\n\n## 47\n\n\n-----\n\nAnother factor which is out of character is the coding style. All Inception-related\nmalware is written using Visual Studio 2010. The downloaded sccm.exe is written\nusing Visual C++ 6; and has a PE header compile date of October 2010.\nThis date can be forged, and indeed, all Inception-related malware has some\nlevel of forgery in the compile dates. However, the sccm.exe compile date\nmatches the Quarian developer toolset and coding style to a better degree than\nthe other files distributed through Inception.\n\nThen there is the C&C domain used. According to DomainTools.com the\n_msname.org domain registration timed out September 27[th] 2014. It was left_\ninactive and was not renewed until Nov 12[th]. This means that the attackers\ndistributed malware that would be out of action for a long time (last distribution of\nsccm.exe was September 26th).\n\nBecause of all this we consider sccm.exe as an unreliable indicator. It is likely to\nbe a red herring purposefully placed on shares where the attackers have seen\nsigns of access by security researchers.\n\n**An odd indicator**\n\nAt one instance the attackers seem to have slipped up. Instead of using their\nscheduled task, they apparently did something manually on a WebDAV share.\nThis is visible because the request came from an apparent attacker IP, but used\nyet another User-Agent: “gvfs/1.12.3”.\n\nGvfs is the virtual filesystem for Gnome desktop. The action on the account was\nabnormal as well; an apparent file upload:\n```\n83.53.147.144 - - [02/Sep/2014:09:53:56 +0200] \"PUT\n/tem5842/Documento%20sin%20t%C3%ADtulo HTTP/1.1\" 408 0 \"-\"\n\"gvfs/1.12.3\"\n\n```\n“Documento sin título” means “Untitled document” in Spanish.\n\nWhen WebDAV shares are mapped up as drives by the operating system, any\naction taken by the attacker follows the same pattern as on the attacker’s local\ndrive. In the case above, it seems the attacker attempted to edit a new\ndocument, which by default is given the name “Untitled document” in Gnome.\n\nThis might indicate that the attacker’s operating system language is Spanish.\nOf course, Spanish is one of the world’s most widespread languages, so one\ncannot infer much from this. There is even a small possibility that the\nphenomenon is a pure artifact; for example that a Spanish-speaking researcher\nconnected to the same account using the same Linux-based setup as the\nattackers.\n\n## 48\n\n\n-----\n\n**Similarities with Red October**\n\nThis attack system shares a number of properties that are somewhat similar with\nthe Red October campaigns detailed by Kaspersky Labs in 2013.\nFor more information about this see:\n\n[The \"Red October\" Campaign - An Advanced Cyber Espionage Network](https://securelist.com/blog/incidents/57647/the-red-october-campaign/)\n[Targeting Diplomatic and Government Agencies](https://securelist.com/blog/incidents/57647/the-red-october-campaign/)\n\n     - Target countries and verticals overlap to some extent\n\n     - The topics of some decoy documents are the same (eg. “Diplomatic\nCar for sale”)\n\n     - Similar overall loading architecture, with dropping of encrypted binaries\nthat are later decrypted and loaded\n\n     - Exploited documents contain certain similarities (i.e. the magic string\n“PT@T” used as a marker to locate the shellcode)\n\nHowever, there are also clear differences. The code is fully rewritten; there\nappears to be little code overlap, at least in the initial stage malware. The coding\nstyle is different, with different solutions to programmatic problems, different use\nof exception handling, and different use of C++ classes. It’s hard to believe that\nthe same programmers are responsible for the two code bases.\n\nThe Red October malware contained linguistic markers that pointed towards\nRussian speaking attackers. No such clues have been found in the Inceptionrelated malware; there is a marked difference in the attention to detail and\ninformation leakage.\n\nIt is certainly possible that the same people have organized both Inception and\nRed October, but there are no clear indications to this effect.\n\n## 49\n\n\n-----\n\n**Strings in malware**\n\nThe Windows-based malware in this paper generally contains very few\nnoticeable strings apart from what is commonly found in software, and clearly\nrandomized strings. What exists – like the word “polymorphed” in the early DLL\nversions - is standard English with few discerning features.\n\nThis changes a bit when we look at the mobile malware. In the Android malware\nwe find Hindi comments in the Java source code. In the Iphone malware we find\nproject paths referencing one “JohnClerk”, and a few typos like “conutry”. In one\nof the Blackberry binaries we find the string “God_Save_The_Queen”, a rather\nblunt hint towards Britain, as well as Arabic log strings.\n\nThese and other indicators have led us to conclude that the Inception attackers\nare setting a new standard for deliberate disinformation and red herrings in a\nmalware espionage operation. Some clues might have been added by accident,\nbut none of these indicators can be trusted in any way. Thus we are not going to\nassume anything about who might be behind these attacks.\n\n## 50\n\n\n-----\n\n**Conclusion**\n\nThe whole Inception setup shows signs of automation and seasoned\nprogramming. The amount of layers used in this scheme to protect the payload\nof their attack seems excessively paranoid. Not only is the initial DLL apparently\npolymorphed using some backend tool – the compile time stamps in the PE\nheader are clearly forged, resources are removed so as not to give away any\nlocation information, and import tables are shuffled around, rendering import\nhashes (aka imphashes) useless.\n\nThe names of the files both when dropped and their original names along with\nthe callback directories, paths and mutexes used all seem to be dynamically\ngenerated.\n\nThe attackers utilize compromised embedded devices – typically routers- on the\nInternet as well as multiple dedicated hosting providers and VPN services to\nmask their identity from the cloud storage provider and others. The same router\nbotnet is used as a spreading and management platform for attacks on mobile\ndevices as well.\n\nThis suggests that this a large campaign and we’ve only seeing the beginning of\nit. Initially many of the targets were located in Russia or related to Russian\ninterests, but as the campaign has evolved we have verified targets in countries\nall over the world.\n\nIt is clear that this infrastructure model does not need to be applied solely against\na few targets, or even need to be hosted at CloudMe. The framework is generic,\nand will work as an attack platform for a multitude of purposes with very little\nmodification.\n\nThe attribution indicators point in different directions and can’t be given much\nweight. These attacks can in theory be the creation of nation states or\nresourceful private entities - we consider it very unlikely that they are performed\nby one or just a few individuals.\n\n© 2014 Blue Coat Systems, Inc. All rights reserved. Blue Coat, the Blue Coat logos, ProxySG, PacketShaper, CacheFlow, IntelligenceCenter, CacheEOS, CachePulse, Crossbeam,\nK9, the K9 logo, DRTR, Mach5, Packetwise, Policycenter, ProxyAV, ProxyClient, SGOs, WebPulse, Solera Networks, the Solera Networks logos, DeepSee, “See Everything. Know\nEverything.”, “Security Empowers Business”, and BlueTouch are registered trademarks or trademarks of Blue Coat Systems, Inc. or its affiliates in the U.S. and certain other\ncountries. This list may not be complete, and the absence of a trademark from this list does not mean it is not a trademark of Blue Coat or that Blue Coat has stopped using the\ntrademark. All other trademarks mentioned in this document owned by third parties are the property of their respective owners. This document is for informational purposes\nonly. Blue Coat makes no warranties, express, implied, or statutory, as to the information in this document.\n\n## 51\n\n\n© 2014 Blue Coat Systems, Inc. All rights reserved. Blue Coat, the Blue Coat logos, ProxySG, PacketShaper, CacheFlow, IntelligenceCenter, CacheEOS, CachePulse, Crossbeam,\nK9, the K9 logo, DRTR, Mach5, Packetwise, Policycenter, ProxyAV, ProxyClient, SGOs, WebPulse, Solera Networks, the Solera Networks logos, DeepSee, “See Everything. Know\nEverything.”, “Security Empowers Business”, and BlueTouch are registered trademarks or trademarks of Blue Coat Systems, Inc. or its affiliates in the U.S. and certain other\ncountries. This list may not be complete, and the absence of a trademark from this list does not mean it is not a trademark of Blue Coat or that Blue Coat has stopped using the\ntrademark. All other trademarks mentioned in this document owned by third parties are the property of their respective owners. This document is for informational purposes\nonly. Blue Coat makes no warranties, express, implied, or statutory, as to the information in this document.\n\n\n-----\n\n**APPENDIX:**\n\n**Exploited RTF sample md5’s:**\n```\n0a0f5a4556c2a536ae7b81c14917ec98\n19ad782b0c58037b60351780b0f43e43\n20c2a4db77aabec46750878499c15354\n23d6fabda409d7fc570c2238c5487a90\n3ff9c9e3228b630b8a68a05d6c3e396d\n4624da84cae0f8b689169e24be8f7410\n4a4874fa5217a8523bf4d1954efb26ef\n4dcdc1110d87e91cda19801755d0bcf2\n516a514bf744efb5e74839ddaf02a540\n5e3ecfd7928822f67fbb3cd9c83be841\n685d9341228f18b0fd7373b7088e56a7\n822d842704596a2cf918863ea2116633\n8488303c2a0065d9ac8b5fecf1cb4fc9\n8997d23b3d1bd96b596baee810333897\n8cd5974a49a9d6c49294312bf09f64ed\n9738faf227bcd12bcab577a0fb58744d\nbc196dc8a14484e700169e1a78cf879e\nb453ec7fd92bee23846ff36bf903ddc0\n2fcbea8a344137421a86b046a6840265\n\n```\n**Dropped first-stage DLL’s**\n```\n0bd0fd3cbbcfddc4048228ce08ca26c2\n0bda50e05d575446de55d50c631afb53\n0f12614fa7a9bf7bcc951eec7b78658d\n2f9ca7680ec0945455988d91d9b325f8\n352da994d867eb68a178bb7f2fb672bc\n3a4a9d26c9c3c8d0fd697b036216319e\n43587e5fcf6770259026ec2ca6f41aa6\n4628082e11c75b078ff0465523598040\n554d4c4da2e3603282b097b0e68ad11a\n670ac2e315088d22b2cb92acffc3e997\n71bdd14cbc96badb79dfb0f23c52a9ee\n72f020b564bc9771e7efe203881f5ef9\n80a7883c33a60b4c0178c9c8fb7d1440\n84fa976d9ed693668b3f97d991da0e97\n89d851cbd2dc1988bb053235414f8928\na5aeda357ba30d87c1187b644baad8a0\nc3f2fb7840228924e5af17787e163e07\nd007616dd3b2d52c30c0ebb0937e21b4\nd171db37ef28f42740644f4028bcf727\nd3886495935438f4a130d217d84ae8cb\nea0d80db2075f789fc88c3fdf6e3d93e\n\n```\n\n## 52\n\n\n-----\n\n```\nf2840be535fbaf8b15470d61967d527b\n90c93c9b80bbf31dce8434a565a0ec7b\n\n```\n\n## 53\n\n\n-----\n\n**Downloaded second-stage plugins:**\n```\n5c3de5b2762f4c5f91affaa6bcadd21b\n86b2372297619b1a9d8ad5acdf1a6467\n43112e09240caebb3c72855c9f6fc9e5\n\n```\n**Downloaded Chinese malware, sccm.exe:**\n```\ndd8790455109497d49c2fa2442cf16f7\n\n```\n**Router proxy malware:**\n```\na6b2ce1cc02c902ba6374210faf786a3 \n83b383884405190683d748f4a95f48d4\n62fc46151cfe1e57a8fa00065bde57b0\n036fbc5bffd664bc369b467f9874fac4\n488e54526aa45a47f7974b4c84c1469a\n24a9bbb0d4418d97d9050a3dd085a188\nb0c2466feb24519c133ee04748ff293f\n62dc87d1d6b99ae2818a34932877c0a4\n7c6727b173086df15aa1ca15f1572b3f\n80528b1c4485eb1f4a306cff768151c5\ne1d51aa28159c25121476ffe5f2fc692\n\n```\n**Android malware:**\n```\n046a3e7c376ba4b6eb21846db9fc02df\nb0d1e42d342e56bc0d20627a7ef1f612\n\n```\n**IOS malware (WhatsAppUpdate.deb):**\n```\n4e037e1e945e9ad4772430272512831c\n\n```\n**Blackberry malware:**\n```\n0fb60461d67cd4008e55feceeda0ee71\n60dac48e555d139e29edaec41c85e2b4\n\n```\n\n## 54\n\n\n-----\n\n**Verified malicious CloudMe accounts (based on malware):**\n\ngarristone frogs6352 droll5587\nfranko7046 daw0996 samantha2064\nsanmorinostar chak2488 chloe7400\ntem5842 corn6814 browner8674935\nbimm4276 james9611 parker2339915\ncarter0648 lisa.walker young0498814\ndepp3353 billder1405 hurris4124867\n\n**Likely malicious CloudMe accounts (based on access patterns):**\n\nadams2350 frog0722 norbinov\nadison8845 gabriel.gonzalez nul7782\nallan1252 garsia7871 parker0519\naltbrot gray7631 poulokoel\namandarizweit great2697 pourater\nanderson9357 green3287 red6039\nastanaforse helen.scott red6247\nbaker6737 helenarix reed6865\nbear9126 hill5289 roges2913\nbell0314 jackson4996 roi5991\nbetty.swon james9521 ronald.campbell\nbrown7169 john.thompson rosse2681\nbrown7356 kalo3113 samantares\nbutton8437 kas2114 scott5008\ncarter0648 kenneth.wilson sebastianturne\ncarter3361 king7460 swon5826\nclark6821 kol8184 taylor9297\ncollins2980 klauseroi tem5842\ncook2677 ksjdkljeijd thirt1353\ncooper2999 lariopas thomas9521\ncooper7271 lopez9524 thomson3474\ncox7457 lorrens6997 turner3027\ncruz3540 martinez4502 vasabilas\ndavid.miller miller8350 visteproi\ndepp3353 minesota1459 voldemarton\ndiaz1365 moore6562 wer8012\ndin8864 moore7529 white3946\nevans0198 morris9351 william.moore\nfarrel0829 morris9461 wilson2821\nferrary2507 murphy5975 wilson2905\nferre7053 nedola7067 wonder7165\nflores5975 nelson0000 wrong8717\nfox0485 ninazer\n\n## 55\n\n\n-----\n\n**Bit.ly-shortened MMS phishing links:**\n\n**Action Code** **Operator** **HQ location** **Links created**\n95501 Vodafone UK 270\n81825 T-Mobile Germany 213\n66968 Proximus Belgium 197\n67840 China Mobile China 173\n98491 Zain Saudi Arabia 126\n58129 Mobilkom (A1 Telekom) Austria 124\n12081 Orange France 124\n24806 Hamrah-e-Avval Iran 111\n41967 Mobilnil Egypt 105\n46736 TeliaSonera Sweden 100\n13911 Mobistar Belgium 78\n65842 O2 UK, Germany 78\n70887 Telcomsel Indonesia 74\n98455 Kcell Kazakhstan 74\n94382 Mobilink Pakistan 72\n12988 Airtel India 65\n52378 Vodacom South Africa 63\n99578 Maxis Malaysia 59\n90298 Swisscom Switzerland 59\n86791 Wind Mobile Canada 56\n21522 MTN South Africa 56\n26059 MTS Russia 55\n67838 Alfa Lebanon 51\n96735 Kyivstar Ukraine 51\n99753 T-Mobile Germany 50\n24906 Omnitel Lithuania 48\n17150 MtcTouch Lebanon 43\n53272 Ooredoo Qatar 36\n77008 BASE Belgium 33\n31756 Djezzy Algeria 29\n14269 Beeline Russia 29\n76587 Omantel Oman 28\n44974 Velcom Belarus 27\n77849 E-plus Germany 26\n76102 Celcom Malaysia 26\n31021 Azercell Azerbaijan 24\n16611 TELE2 Sweden 24\n18675 Mobifone Vietnam 22\n65942 T-Mobile Germany 20\n85993 Sudatel Sudan 20\n65090 Diallog Belarus 19\n61384 Ufone Pakistan 19\n11426 TMCell Turkmenistan 19\n58043 Globe Philippines 18\n70102 SingTel Singapore 18\n90374 Avea Turkey 18\n57464 DiGi Malaysia 16\n77995 Megacom Kyrgyzstan 15\n27964 Warid Pakistan 11\n\n## 56\n\n\n-----\n\n15029 DSTCom Brunei 10\n70959 Smart Cambodia 10\n83722 Asiacell Iraq 10\n97143 Maroc Telecom Morocco 9\n25786 Magti Georgia 6\n34659 Geocell Georgia 6\n56167 Bakcell Azerbaijan 5\n42397 Dhiraagu Maldives 5\n54375 Telfort Netherlands 5\n43142 Banglalink Bangladesh 2\n90128 EMT Estonia 2\n24709 MTNL India 2\n92444 Safaricom Kenya 2\n60354 Plus Poland 2\n84899 Sabafon Yemen 2\n14115 Sri Lanka Telecom Sri Lanka 1\n42758 Lycamobile UK 1\n\n## 57\n\n\n-----\n\n**Undetermined MMS phishing action codes (code, number of links):**\n\n13975 320 54780 12 14659 3 19343 1\n51557 119 92529 11 16814 3 20732 1\n37020 88 61135 10 20247 3 25938 1\n11111 71 89838 10 24037 3 26346 1\n61925 64 44638 9 27307 3 26842 1\n91130 63 60007 9 31785 3 27758 1\n91200 58 67648 9 37629 3 30053 1\n79711 47 72371 9 49284 3 36962 1\n43312 42 96565 9 54512 3 37477 1\n75687 37 99094 9 68798 3 37686 1\n81544 37 24483 8 79286 3 38686 1\n51949 29 46127 8 85076 3 40606 1\n23562 28 55223 8 94046 3 42067 1\n96780 25 99061 7 11468 2 50935 1\n72026 24 20470 6 20460 2 52833 1\n78098 23 22798 6 25559 2 55991 1\n96878 20 32331 6 41075 2 59635 1\n18986 19 40772 6 45834 2 65025 1\n21782 19 52741 6 57403 2 65414 1\n57673 18 63095 6 65855 2 66185 1\n62088 18 70610 6 71103 2 67120 1\n37267 16 92826 6 71633 2 74336 1\n40019 16 25387 5 75778 2 74800 1\n46681 15 69153 5 77776 2 75906 1\n47390 15 72564 5 80209 2 89027 1\n22775 14 24122 4 91062 2 89675 1\n80998 14 47240 4 91212 2 90962 1\n98758 14 76002 4 91869 2 91774 1\n36942 13 82852 4 13335 1 94776 1\n93620 13 83478 4 15318 1 98886 1\n97276 13 97561 4 16155 1\n\n\n## 58\n\n\n-----\n\n**Attacker-owned domains:**\n\nhaarmannsi.cz\nsanygroup.co.uk\necolines.es\nblackberry-support.herokuapp.com (DynDNS)\n\n\n## 59\n\n\n-----\n\n**YARA detection rules:**\n```\nrule InceptionDLL \n{\n    meta:\n       author = \"Blue Coat Systems, Inc\"\n       info = \"Used by unknown APT actors: Inception\"\n    strings:\n       $a = \"dll.polymorphed.dll\"\n       $b = {83 7d 08 00 0f 84 cf 00 00 00 83 7d 0c 00 0f 84 c5 00\n       00 00 83 7d 10 00 0f 84 bb 00 00 00 83 7d 14 08 0f 82 b1 00\n       00 00 c7 45 fc 00 00 00 00 8b 45 10 89 45 dc 68 00 00}\n       $c = {FF 15 ?? ?? ?? ?? 8B 4D 08 8B 11 C7 42 14 00 00 00 00\n       8B 45 08 8B 08 8B 55 14 89 51 18 8B 45 08 8B 08 8B 55 0C 89\n       51 1C 8B 45 08 8B 08 8B 55 10 89 51 20 8B 45 08 8B 08}\n       $d = {68 10 27 00 00 FF 15 ?? ?? ?? ?? 83 7D CC 0A 0F 8D 47\n       01 00 00 83 7D D0 00 0F 85 3D 01 00 00 6A 20 6A 00 8D 4D D4\n       51 E8 ?? ?? ?? ?? 83 C4 0C 8B 55 08 89 55 E8 C7 45 D8} \n       $e = {55 8B EC 8B 45 08 8B 88 AC 23 03 00 51 8B 55 0C 52 8B\n       45 0C 8B 48 04 FF D1 83 C4 08 8B 55 08 8B 82 14 BB 03 00 50\n       8B 4D 0C 51 8B 55 0C 8B 42 04}\n    condition:\n       any of them\n}\nrule InceptionRTF {\n    meta:\n       author = \"Blue Coat Systems, Inc\"\n       info = \"Used by unknown APT actors: Inception\"\n    strings:\n       $a = \"}}PT@T\"\n       $b = \"XMLVERSION \\\"3.1.11.5604.5606\"\n       $c = \"objclass Word.Document.12}\\\\objw9355\"\n    condition:\n       all of them\n}\nrule InceptionMips {\n    meta:\n       author = \"Blue Coat Systems, Inc\"\n       info = \"Used by unknown APT actors: Inception\"\n    strings:\n       $a = \"start_sockat\" ascii wide\n       $b = \"start_sockss\" ascii wide\n       $c = \"13CStatusServer\" ascii wide\n    condition:\n       all of them\n}\n\n## 60\n\n```\n\n-----\n\n```\nrule InceptionVBS {\n    meta:\n       author = \"Blue Coat Systems, Inc\"\n       info = \"Used by unknown APT actors: Inception\"\n    strings:\n       $a = \"c = Crypt(c,k)\"\n       $b = \"fso.BuildPath( WshShell.ExpandEnvironmentStrings(a),\n       nn)\"\n    condition:\n       all of them\n}\nrule InceptionBlackberry {\n    meta:\n       author = \"Blue Coat Systems, Inc\"\n       info = \"Used by unknown APT actors: Inception\"\n    strings:\n       $a1 = \"POSTALCODE:\"\n       $a2 = \"SecurityCategory:\"\n       $a3 = \"amount of free flash:\"\n       $a4 = \"$Ø71|'1'|:\"\n       $b1 = \"God_Save_The_Queen\"\n       $b2 = \"UrlBlog\"\n    condition:\n       all of ($a*) or all of ($b*)\n}\nrule InceptionAndroid {\n    meta:\n       author = \"Blue Coat Systems, Inc\"\n       info = \"Used by unknown APT actors: Inception\"\n    strings:\n       $a1 = \"BLOGS AVAILABLE=\"\n       $a2 = \"blog-index\"\n       $a3 = \"Cant create dex=\"\n    condition:\n       all of them\n}\nrule InceptionIOS {\n    meta:\n       author = \"Blue Coat Systems, Inc\"\n       info = \"Used by unknown APT actors: Inception\"\n    strings:\n       $a1 = \"Developer/iOS/JohnClerk/\"\n       $b1 = \"SkypeUpdate\"\n       $b2 = \"/Syscat/\"\n       $b3 = \"WhatsAppUpdate\"\n    condition:\n   $a1 and any of ($b*)\n}\n\n## 61\n\n```\n\n-----\n\n**Acknowledgements**\n\nThe following entities have helped in big and small ways. Big thanks to all.\n\nCIRCL.LU\nCrowdstrike\nF-Secure Corporation\niSight Partners\nKaspersky Labs\nSymantec Corporation\n\nWe also owe a big debt of gratitude to Ryan W. Smith of Blue Coat who helped\nus tremendously with the analysis of the mobile malware.\n\n## 62\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/vny8b4ubmxo421amxtk8tvk4b9x1vz52",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.12.09_The_Inception_Framework/bcs_wp_InceptionReport_EN_v12914.pdf",
        "https://paper.seebug.org/papers/APT/APT_CyberCriminal_Campagin/2014/bcs_wp_InceptionReport_EN_v12914.pdf"
    ],
    "report_names": [
        "bcs_wp_InceptionReport_EN_v12914",
        "bcs_wp_InceptionReport_EN_v12914.pdf"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "02c9f3f6-5d10-456b-9e63-750286048149",
            "created_at": "2022-10-25T16:07:23.722884Z",
            "updated_at": "2025-03-27T02:02:09.945869Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK 116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "Inception Framework",
                "Operation Cloud Atlas",
                "Operation RedOctober",
                "The Rocra"
            ],
            "source_name": "ETDA:Inception Framework",
            "tools": [
                "Lastacloud",
                "PowerShower",
                "VBShower"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3b56d733-88da-4394-b150-d87680ce67e4",
            "created_at": "2023-01-06T13:46:39.287189Z",
            "updated_at": "2025-03-27T02:00:03.040775Z",
            "deleted_at": null,
            "main_name": "BackdoorDiplomacy",
            "aliases": [
                "BackDip",
                "CloudComputating",
                "Quarian"
            ],
            "source_name": "MISPGALAXY:BackdoorDiplomacy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "88854a9f-641a-4412-89db-449b4d5cbc51",
            "created_at": "2022-10-25T16:07:23.963599Z",
            "updated_at": "2025-03-27T02:02:10.051548Z",
            "deleted_at": null,
            "main_name": "Operation HangOver",
            "aliases": [
                "Monsoon",
                "Operation HangOver",
                "Viceroy Tiger"
            ],
            "source_name": "ETDA:Operation HangOver",
            "tools": [
                "AutoIt backdoor",
                "BADNEWS",
                "BackConfig",
                "JakyllHyde",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "04a7ebaa-ebb1-4971-b513-a0c86886d932",
            "created_at": "2023-01-06T13:46:38.784965Z",
            "updated_at": "2025-03-27T02:00:02.91817Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "G0100"
            ],
            "source_name": "MISPGALAXY:Inception Framework",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041589,
    "ts_creation_date": 1418137498,
    "ts_modification_date": 1418137525,
    "files": {
        "pdf": "https://archive.orkl.eu/975c44773b456562f9ab5f9986c2102a21b618bd.pdf",
        "text": "https://archive.orkl.eu/975c44773b456562f9ab5f9986c2102a21b618bd.txt",
        "img": "https://archive.orkl.eu/975c44773b456562f9ab5f9986c2102a21b618bd.jpg"
    }
}