{
    "id": "aada91e6-a389-4423-9ca2-f04388525019",
    "created_at": "2023-01-12T15:02:35.561947Z",
    "updated_at": "2025-03-27T02:05:46.790836Z",
    "deleted_at": null,
    "sha1_hash": "f02c4ad76bc759f2fe7ffe819b9b63b3afd220e6",
    "title": "2021-11-10 - The Newest Malicious Actor- “Squirrelwaffle” Malicious Doc.",
    "authors": "",
    "file_creation_date": "2022-05-28T17:53:54Z",
    "file_modification_date": "2022-05-28T17:53:54Z",
    "file_size": 1686952,
    "plain_text": "# The Newest Malicious Actor: “Squirrelwaffle” Malicious Doc.\n\n**[mcafee.com/blogs/other-blogs/mcafee-labs/the-newest-malicious-actor-squirrelwaffle-malicious-doc/](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/the-newest-malicious-actor-squirrelwaffle-malicious-doc/)**\n\n[McAfee Labs](https://www.mcafee.com/blogs/author/mcafee-labs/)\nNov 10, 2021\n\n4 MIN READ\n\nAuthored By Kiran Raj\n\n\nNovember 10, 2021\n\n\nDue to their widespread use, Office Documents are commonly used by Malicious actors as a way to distribute their malware.\nMcAfee Labs have observed a new threat “Squirrelwaffle” which is one such emerging malware that was observed using office\ndocuments in mid-September that infects systems with CobaltStrike.\n\nIn this Blog, we will have a quick look at the SquirrelWaffle malicious doc and understand the Initial infection vector.\n\nGeolocation based stats of Squirrelwaffle malicious doc observed by McAfee from September 2021\n\n\n-----\n\nFigure1- Geo-based\n\nstats of SquirrelWaffle Malicious Doc\n\n## Infection Chain\n\n1. The initial attack vector is a phishing email with a malicious link hosting malicious docs\n2. On clicking the URL, a ZIP archived malicious doc is downloaded\n3. The malicious doc is weaponized with AutoOpen VBA function. Upon opening the malicious doc, it drops a VBS file\n\ncontaining obfuscated powershell\n4. The dropped VBS script is invoked via exe to download malicious DLLs\n5. Thedownloaded DLLs are executed via exe with an argument of export function “ldr”\n\n\n-----\n\nFigure\n2: Infection Chain\n\n## Malicious Doc Analysis\n\nHere is how the face of the document looks when we open the document (figure 3). Normally, the macros are disabled to run by\ndefault by Microsoft Office. The malware authors are aware of this and hence present a lure image to trick the victims guiding them\ninto enabling the macros.\n\nFigure-3: Image of Word Document Face\n\n## UserForms and VBA\n\nThe VBA Userform Label components present in the Word document (Figure-4) is used to store all the content required for the\nVBS file. In Figure-3, we can see the userform’s Labelbox “t2” has VBS code in its caption.\n\nSub routine “eFile()” retrieves the LabelBox captions and writes it to a C:\\Programdata\\Pin.vbs and executes it using cscript.exe\n\nCmd line: cmd /c cscript.exe C:\\Programdata\\Pin.vbs\n\n\n-----\n\nFigure-4: Image of\n\nUserforms and VBA\n\n## VBS Script Analysis\n\nThe dropped VBS Script is obfuscated (Figure-5) and contains 5 URLs that host payloads. The script runs in a loop to download\npayloads using powershell and writes to C:\\Programdata location in the format /www-[1-5].dll/. Once the payloads are\ndownloaded, it is executed using rundll32.exe with export function name as parameter “ldr”\n\nFigure-5:\n\nObfuscated VBS script\n**_De-obfuscated VBS script_**\n\nVBS script after de-obfuscating (Figure-6)\n\nFigure-6: De\nobfuscated VBS script\n\n## MITRE ATT&CK\n\nDifferent techniques & tactics are used by the malware and we mapped these with the MITRE ATT&CK platform.\n\n\n-----\n\n_Command and Scripting Interpreter (T 1059)_\n\nMalicious doc VBA drops and invokes VBS script.\n\nCMD: cscript.exe C:\\ProgramData\\pin.vbs\n\n_Signed Binary Proxy Execution (T1218)_\n\nRundll32.exe is used to execute the dropped payload\n\nCMD: rundll32.exe C:\\ProgramData\\www1.dll,ldr\n\n## IOC\n\n**Type** **Value** **Scanner** **Detection Name**\n\n\nMain Word\nDocument\n\nDownloaded\nDLL\n\nURLs to\ndownload\nDLL\n\n\n195eba46828b9dfde47ffecdf61d9672db1a8bf13cd9ff03b71074db458b6cdf ENS,\nWSS\n\n85d0b72fe822fd6c22827b4da1917d2c1f2d9faa838e003e78e533384ea80939 ENS,\nWSS\n\n\n\n-   priyacareers.com\n\n-   bussiness-z.ml\n\n-   cablingpoint.com\n\n-   bonus.corporatebusinessmachines.co.in\n\n-   perfectdemos.com\n\n\nW97M/Downloader.dsl\n\nRDN/Squirrelwaffle\n\n\nWebAdvisor Blocked\n\n\n[McAfee Labs Threat Research Team](https://www.mcafee.com/blogs/author/mcafee-labs/)\nMcAfee Labs is one of the leading sources for threat research, threat intelligence, and cybersecurity thought leadership. See our\nblog posts below for more information.\n\n### More from McAfee Labs\n\n[Crypto Scammers Exploit: Elon Musk Speaks on Cryptocurrency](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/crypto-scammers-exploit-talk-on-cryptocurrency/%20)\n\nBy Oliver Devane Update: In the past 24 hours (from time of publication) McAfee has identified 15...\n\nMay 05, 2022 |  4 MIN READ\n\n[Instagram Credentials Stealer: Disguised as Mod App](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/instagram-credentials-stealer-disguised-as-mod-app/%20)\n\nAuthored by Dexter Shin McAfee’s Mobile Research Team introduced a new Android malware targeting Instagram users who...\n\nMay 03, 2022 |  4 MIN READ\n\n[Instagram Credentials Stealers: Free Followers or Free Likes](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/instagram-credentials-stealers-free-followers-or-free-likes/%20)\n\nAuthored by Dexter Shin Instagram has become a platform with over a billion monthly active users. Many...\n\nMay 03, 2022 |  6 MIN READ\n\n[Scammers are Exploiting Ukraine Donations](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/scammers-are-exploiting-ukraine-donations/%20)\n\nAuthored by Vallabh Chole and Oliver Devane Scammers are very quick at reacting to current events so\n\n\n-----\n\nApr 01, 2022 |  7 MIN READ\n\n[Imposter Netflix Chrome Extension Dupes 100k Users](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/imposter-netflix-chrome-extension-dupes-100k-users/%20)\n\nAuthored by Oliver Devane, Vallabh Chole, and Aayush Tyagi McAfee has recently observed several malicious Chrome\nExtensions...\n\nMar 10, 2022 |  8 MIN READ\n\n[Why Am I Getting All These Notifications on my Phone?](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/why-am-i-getting-all-these-notifications-on-my-phone/%20)\n\nAuthored by Oliver Devane and Vallabh Chole  Notifications on Chrome and Edge, both desktop browsers, are commonplace,...\n\nFeb 25, 2022 |  5 MIN READ\n\n[Emotet’s Uncommon Approach of Masking IP Addresses](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/emotets-uncommon-approach-of-masking-ip-addresses/%20)\n\nIn a recent campaign of Emotet, McAfee Researchers observed a change in techniques. The Emotet maldoc was...\n\nFeb 04, 2022 |  4 MIN READ\n\n[HANCITOR DOC drops via CLIPBOARD](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/hancitor-doc-drops-via-clipboard/%20)\n\nHancitor, a loader that provides Malware as a Service, has been observed distributing malware such as FickerStealer,...\n\nDec 13, 2021 |  6 MIN READ\n\n\n-----\n\n[‘Tis the Season for Scams](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/tis-the-season-for-scams/%20)\n\n‘Tis the Season for Scams\n\nNov 29, 2021 |  18 MIN READ\n\n[Social Network Account Stealers Hidden in Android Gaming Hacking Tool](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/social-networks-account-stealer-hidden-in-android-gaming-hacking-tool/%20)\n\nAuthored by: Wenfeng Yu McAfee Mobile Research team recently discovered a new piece of malware that specifically...\n\nOct 19, 2021 |  6 MIN READ\n\n[Malicious PowerPoint Documents on the Rise](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/malicious-powerpoint-documents-on-the-rise/%20)\n\nAuthored by Anuradha M McAfee Labs have observed a new phishing campaign that utilizes macro capabilities available...\n\nSep 21, 2021 |  6 MIN READ\n\n[Android malware distributed in Mexico uses Covid-19 to steal financial credentials](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/android-malware-distributed-in-mexico-uses-covid-19-to-steal-financial-credentials/%20)\n\nAuthored by Fernando Ruiz McAfee Mobile Malware Research Team has identified malware targeting Mexico. It poses as a\nsecurity banking tool or...\n\nSep 13, 2021 |  7 MIN READ\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-10 - The Newest Malicious Actor- “Squirrelwaffle” Malicious Doc..pdf"
    ],
    "report_names": [
        "2021-11-10 - The Newest Malicious Actor- “Squirrelwaffle” Malicious Doc..pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535755,
    "ts_updated_at": 1743041146,
    "ts_creation_date": 1653760434,
    "ts_modification_date": 1653760434,
    "files": {
        "pdf": "https://archive.orkl.eu/f02c4ad76bc759f2fe7ffe819b9b63b3afd220e6.pdf",
        "text": "https://archive.orkl.eu/f02c4ad76bc759f2fe7ffe819b9b63b3afd220e6.txt",
        "img": "https://archive.orkl.eu/f02c4ad76bc759f2fe7ffe819b9b63b3afd220e6.jpg"
    }
}