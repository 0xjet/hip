{
    "id": "891b201c-1510-4ad6-8b3f-292a748b9bd3",
    "created_at": "2022-10-25T16:48:20.155207Z",
    "updated_at": "2025-03-27T02:11:47.787387Z",
    "deleted_at": null,
    "sha1_hash": "8ffce0fd5ec946cbb5da03a5a0f2796525aa600a",
    "title": "",
    "authors": "",
    "file_creation_date": "2017-03-01T09:58:21Z",
    "file_modification_date": "2017-03-01T09:58:21Z",
    "file_size": 498067,
    "plain_text": "MENU\n\n\nO C T O B E R 2 7, 2 0 1 6 B Y [T A L L I B E R M A N](http://blog.ensilo.com/author/tal-liberman)\n\n## AtomBombing: A Code Injection that Bypasses Current\n\n Security Solutions\n\n[Tweet](https://twitter.com/intent/tweet?original_referer=http%3A%2F%2Fblog.ensilo.com%2Fatombombing-a-code-injection-that-bypasses-current-security-solutions&ref_src=twsrc%5Etfw&text=AtomBombing%3A%20A%20Code%20Injection%20that%20Bypasses%20Current%20Security%20Solutions&tw_p=tweetbutton&url=http%3A%2F%2Fblog.ensilo.com%2Fatombombing-a-code-injection-that-bypasses-current-security-solutions) **[Share](javascript:void(0);)** **517** **Like** **Share** 525 45\n\nOur research team has uncovered new way to leverage mechanisms of the underlying Windows operating\n\nsystem in order to inject malicious code. Threat actors can use this technique, which exists by design of the\n\noperating system, to bypass current security solutions that attempt to prevent infection. We named this\n\ntechnique AtomBombing based on the name of the underlying mechanism that this technique exploits.\n\nAtomBombing a�ects all Windows version. In particular, we tested this against Windows 10.\n\nUnfortunately, this issue cannot be patched since it doesn’t rely on broken or �awed code – rather on how\n\nthese operating system mechanisms are designed.\n\n# Code Injection 101\n\nThe issue we revealed presents a way for threat actors to inject code. Attackers use code injection to add\n\nmalicious code into legitimate processes, making it easier to bypass security products, hide from the user,\n\nand extract sensitive information that would otherwise be unattainable.\n\nFor example, let’s say an attacker was able to persuade a user to run a malicious executable, evil.exe. Any kind\n\nof decent application level �rewall installed on the computer would block that executable’s communication.\n\nTo overcome this issue, evil.exe would have to �nd a way to manipulate a legitimate program, such as a web\n\nbrowser, so that the legitimate program would carry out communication on behalf of evil.exe.\n\nThis manipulation technique is known as code injection.\n\n# Code Injection: An Important Tool in the\n\n Attacker’s Toolbox\n\nThere are quite a few reasons why code injection is useful. An attacker may use code injection, for example,\n\nto:\n\n1. Bypass process level restrictions: Many security products employ a white list of trusted processes. If the\n\ntt k i bl t i j t li i d i t f th t t d th it d t\n\n\n-----\n\n2. Access to context-speci�c data. Some data is only accessible to certain processes, while inaccessible to\n\nothers. For example:\n\na. Taking screenshots. A process that takes a screenshot of the user's screen, must run within the context\n\nof the user's desktop. However, more often than not malware will be loaded into the services desktop,\n\nnot the user’s, preventing the malware from taking a screenshot of the user's desktop. Using code\n\ninjection, a malware can inject code into a process that’s already running in the user's desktop, take a\n\npicture and send it back to the malware in the services desktop.\n\nb. Performing Man in the Browser (MitB) attacks. By injecting code into a web browser an attacker can\n\nmodify the content shown to the user. For example, in a banking transaction process, the customer will\n\nalways be shown the exact payment information as the customer intended via con�rmation screens.\n\nHowever, the attacker modi�es the data so that the bank receives false transaction information in favor\n\nof the attacker, i.e. a di�erent destination account number and possibly amount. In a MitB attack, the\n\ncustomers are unaware of the money being funneled out of their account until it’s too late.\n\nc. Accessing encrypted passwords. Google Chrome encrypts the user's stored passwords by using\n\nWindows Data Protection API (DPAPI). This API uses data derived from the current user to\n\nencrypt/decrypt the data and access the passwords. In this scenario, a malware that is not running in\n\nthe context of the user will not be able to access the passwords. However, if the malware injects code\n\ninto a process that's already running in the context of the current user, the plain-text passwords can be\n\neasily accessed.\n\n# Behind the Scenes of AtomBombing\n\nThe underlying Windows mechanism which AtomBombing exploits is called atom tables. These tables are\n\nprovided by the operating system to allow applications to store and access data. These atom tables can also\n\nbe used to share data between applications.\n\nWhat we found is that a threat actor can write malicious code into an atom table and force a legitimate\n\nprogram to retrieve the malicious code from the table. We also found that the legitimate program, now\n\ncontaining the malicious code, can be manipulated to execute that code.\n\nFor the technology deep dive, please the researcher’s post here: https://breakingmalware.com/injection\ntechniques/atombombing-brand-new-code-injection-for-windows/\n\n# Code Injections in the Past\n\nCurrently there are just a handful of known code injection techniques. A list of several of these can be found\n\n[here: http://resources.infosecinstitute.com/code-injection-techniques/](http://resources.infosecinstitute.com/code-injection-techniques/)\n\n[Additionally, last summer our research team found a new code injection technique called PowerLoaderEx.](https://breakingmalware.com/injection-techniques/code-less-code-injections-and-0-day-techniques/)\n\nPowerLoaderEx enables an attacker to inject code without needing to actually write code or data to the\n\ninjected process.\n\nOnce a code injection technique is well-known, security products focused on preventing attackers from\n\ncompromising the endpoints (such as anti-virus and host intrusion prevention systems), typically update their\n\nsignatures accordingly. So once the injection is known, it can be detected and mitigated by the security\n\nproducts.\n\nBeing a new code injection technique, AtomBombing bypasses AV, NGAV and other endpoint in�ltration\n\nprevention solutions.\n\n# Mitigation\n\nAtomBombing is performed just by using the underlying Windows mechanisms There is no need to exploit\n\n\n-----\n\nwould be to tech-dive into the API calls and monitor those for malicious activity.\n\nIt’s important though at this point to take a step back. AtomBombing is one more technique in the attacker’s\n\ntoolbox. Threat actors will continuously take out a tool – used or new - to ensure that they bypass anti\nin�ltration technologies (such as AV, NGAV, HIPS, etc).\n\nObviously we need to �nd a di�erent way to deal with threat actors. Under the assumption that threat actors\n\nwill always exploit known and unknown techniques, we need to build our defenses in a way that prevents the\n\nconsequences of the attack once the threat actor has already compromised the environment.\n\n## Learn how attackers appear legitimate in face of security\n\n tools by exploiting design vulnerabilities\n\n\n#### Download Now\n\n\nHEALTHCARE - A CYBERATTACK TARGET\nTHAT’S ONLY GETTING BIGGER\n\n\nR E A D N E X T\n\n[THE ZERO-DOWNTIME ORGANIZATION](https://pages.ensilo.com/the-zero-downtime-organization?utm_source=trendemon&utm_medium=content&utm_campaign=flow) Cyber-Security in 120 S\nBrokers Free-for-All Loo\n\n\nPOST TAGS [RESEARCH](http://blog.ensilo.com/topic/research)\n\n\n**Comments for this thread are now closed.** **×**\n\n\n###### 18 Comments Ensilo Blog 1 Login\n\n\n **Recommend** **4**\n\n\n##### ⤤ Share Sort by Best\n\n\n**[MonkeyBoy](https://disqus.com/by/disqus_uJfgxgq7L2/)** - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2973477116)\n\n###### Got here from: http://thehackernews.com/2016/...\n\n A lot of hype from that site. #1 you say \"For example, let’s say an attacker was able to persuade a user to run a malicious executable, evil.exe\"\n\n Yea! Hello? If you get any \"evil.exe\" run on your system you're in trouble. Not by this technique alone, as the executable can install a number of components (rootkits) in userland and/or kernel space.\n\n That page goes on to hype it up more talking about \"encryption\" key hijacking, etc., which is not\n\n\n-----\n\n**[Tal_Liberman](https://disqus.com/by/Tal_Liberman/)** [> MonkeyBoy](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2973477116) - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2973576890)\n\n###### This technique can be used post infection to inject code from one process to another. For example, on a computer protected by modern security software a malicious executable such as evil.exe will not be able to communicate because it would be blocked by a firewall. It would need to inject code into a browser in order to communicate which will also be blocked by any standard AV. By using AtomBombing evil.exe can inject code into a web browser undetected by said AV and then have the web browser communicate on its behalf undetected by said firewall.\n\n\n1 △ \n\n\n \n\nShare ›\n\n\n**[Sebastian Cato](https://disqus.com/by/sebastiancato/)** [> Tal_Liberman](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2973576890) - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2976227335)\n\n###### Why not just use CreateRemoteThread or NtQueueApcThread calling something like LoadLibrary? Using atom tables just sounds like it would achieve the same goal with added hassle, and you wouldn't gain anything, since it still requires NtQueueApcThread, which AFAIK most AV hooks at runtime. It's been used for a while now, see e.g., [1]\n\n [1]: http://www.codeproject.com/Art...\n\n\n\n###### △ ▽\n\n\n\n \n\nShare ›\n\n\n**[Tal_Liberman](https://disqus.com/by/Tal_Liberman/)** [> Sebastian Cato](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2976227335) - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2976424240)\n\n###### Use CreateRemoteThread or NtQueueApcThread to call LoadLibrary and any AV will catch you. Use AtomBombing and you'll bypass most AV products.\n\n Some AVs do hook NtQueueApcThread but they'll only flag your malicious behavior if you use NtQueueApcThread to call LoadLibrary or some code that was allocated dynamically with VirtualAllocEx. Also if you use NtQueueApcThread to call LoadLibrary you must place a DLL file on the disk, which will be picked up by the AV and sent to its cloud service for reputation analysis. AtomBombing allows you to inject shellcode without having to touch the disk.\n\n\n2 △         \n**Hacked_OFF** - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2973215768)\n\n\n\n\n\nShare ›\n\n\n###### This explains how we have been able to be hacked for the last 18 months no matter what we do in terms of security features in Windows 10. This is actually a design feature inserted by Microsoft as a back door for the security services, as we have discovered. We strongly suspected this and now it have been proven. Bloody Hell !!!!, Microsoft software update policy is also designed to allow the security services to compromise updates... so watch out !!!\n\n\n1 △ \n\n\n \n\nShare ›\n\n\n**level1** [> Hacked_OFF](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2973215768) - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2976670907)\n\n###### Get the tin hats out...\n\n\n\n###### △ ▽\n\n\n\n\n\nShare ›\n\n\n**[ExoticWaves](https://disqus.com/by/ExoticWaves/)** - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2974834461)\n\n###### Is Mac OSX susceptible to this attack vector, \"Atom bombing\"???\n\n\n\n###### △ ▽\n\n\n\n \n\nShare ›\n\n\n**[Tal_Liberman](https://disqus.com/by/Tal_Liberman/)** [> ExoticWaves](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2974834461) - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2975814531)\n\n###### No, AtomBombing only affects Windows.\n\n\n\n###### △ ▽\n\n\n\n\n\nShare ›\n\n\n-----\n\n**[Dylan Taylor](https://disqus.com/by/aliendude5300/)** - [ﻧﺯﺍﺭ](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2973990224) ﺃﺑﻭ - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2974124462)\n\n###### Linux is not affected by this, no.\n\n\n\n###### △ ▽\n\n\n\n\n\nShare ›\n\n\n**[Cees Timmerman](https://disqus.com/by/CeesTimmerman/)** - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2973356097)\n\n###### Threat signatures are always outdated. Use signed hashes to ensure the integrity of your system's authorized software.\n\n\n\n###### △ ▽\n\n\n\n \n\nShare ›\n\n\n**Robert** - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2973255719)\n\n###### Have you spoken to anyone at Microsoft about this (i.e. MSRC)?\n\n\n\n###### △ ▽\n\n\n\n \n\nShare ›\n\n\n**[Tal_Liberman](https://disqus.com/by/Tal_Liberman/)** [> Robert](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2973255719) - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2973394667)\n\n###### This code injection technique is not dependent on a vulnerability in Microsoft. Rather it leverages legitimate building blocks of Windows.\n\n\n1 △    \n**bro** - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2972902514)\n\n\n\n \n\nShare ›\n\n\n###### So, how to apply this? AtomTable allows only Strings and Integers (based on MS documentation). So, only affected applications are apps that uses GlobalAtomTable in such a way that allows bypass some security principles (like storing code in form of string, or path to dll in form of string etc.). Still it sounds like a problem with applications not with Windows API. Apps should consider data coming from GlobalAtomTable as untrusted source. Can you name application that is vulnerable to this flow?\n\n\n\n###### △ ▽\n\n\n\n \n\nShare ›\n\n\n**[Tal_Liberman](https://disqus.com/by/Tal_Liberman/)** [> bro](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2972902514) - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2973057532)\n\n###### I suggest you read the detailed write-up on our technical blog: http://breakingmalware.com/inj...\n\n\n\n###### △ ▽\n\n\n\n\n\nShare ›\n\n\n**[Mitja Kolsek](https://disqus.com/by/mitjakolsek/)** - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2972850030)\n\n###### Sounds like a very Interesting research, thank you for sharing it.\n\n I was hoping for more technical details but I guess you have reasons not to reveal them at this point. Nevertheless, I'm puzzled by your claim that \"... the legitimate program, now containing  the malicious code, can be manipulated to execute that code\" in conjunction with \"the issue cannot be fixed\". Does this mean that telling an application to accept code from an atom table and execute it is a by-design documented feature? If so, it sounds like a gaping hole that Microsoft will have to close, but if not, then it sounds like you have found a way to trick it to do so (which also implies a need for a patch). I'll appreciate more information - thanks!\n\n\n\n###### △ ▽\n\n\n\n \n\nShare ›\n\n\n**[Tal_Liberman](https://disqus.com/by/Tal_Liberman/)** [> Mitja Kolsek](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2972850030)          - [4 months ago](http://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions#comment-2973060369)\n\n###### Hi Mitja, I believe the detailed write-up on our technical blog should answer all of your questions: http://breakingmalware.com/inj...\n\n### Subscribe to enSilo's Blog and Stay on Top of the Latest Security\n\n Research and Industry News\n\n\n-----\n\nSUBSCRIBE\n\n\n### Recent Posts\n\n[RSA in 120 Secs: In Case You Missed Us at the Show...](http://blog.ensilo.com/in-case-you-missed-us-at-the-show)\n\n[Cyber-Security in 120 Secs: UPDATE - Cost of a Data Breach](http://blog.ensilo.com/cyber-security-in-120-secs-the-cost-of-a-breach)\n\n[Customer Advisory Warning: The Comeback of the Hancitor Campaign](http://blog.ensilo.com/customer-advisory-warning-the-comeback-of-the-hancitor-campaign)\n\n[Cyber-Security in 120 Secs: The Data Breach E�ect and The Cost](http://blog.ensilo.com/cyber-security-in-120-secs-the-data-breach-effect-and-the-cost)\n\n[Cyber-Security in 120 Secs: Cyber-Attacks on Banks](http://blog.ensilo.com/cyber-security-in-120-secs-cyber-attacks)\n\n[Cyber-Security in 120 Secs: Drafting a Cyber Security Executive Order](http://blog.ensilo.com/cyber-security-in-120-secs-drafting-cyber-security-executive-order)\n\n[Cyber-Security in 120 Secs: Compromise is Inevitable](http://blog.ensilo.com/cyber-security-in-120-secs-compromise-is-inevitable-0)\n\n[Cyber-Security in 120 Secs: The Shadow Brokers Free-for-All Loot](http://blog.ensilo.com/cyber-security-in-120-secs-the-shadow-brokers-free-for-all-loot)\n\n[WhatsApp With That: One Says Backdoor, the Other Says Feature](http://blog.ensilo.com/whatsapp-with-that-one-says-backdoor-the-other-says-feature)\n\n[Cyber-Security in 120 Secs: 'Mungous Ransomware on MongoDB](http://blog.ensilo.com/cyber-security-in-120-secs-mungous-ransomware-on-mongodb)\n\n### Posts by Topic\n\n[Weekly Security News (68)](http://blog.ensilo.com/topic/weekly-security-news)\n\n[Industry (19)](http://blog.ensilo.com/topic/industry)\n\n[Research (16)](http://blog.ensilo.com/topic/research)\n\n[Business (9)](http://blog.ensilo.com/topic/business)\n\n### Archive by Month\n\n[May 2016 (9)](http://blog.ensilo.com/archive/2016/05)\n\n[December 2016 (9)](http://blog.ensilo.com/archive/2016/12)\n\n[October 2015 (7)](http://blog.ensilo.com/archive/2015/10)\n\n[February 2016 (7)](http://blog.ensilo.com/archive/2016/02)\n\n[July 2016 (7)](http://blog.ensilo.com/archive/2016/07)\n\n[November 2016 (7)](http://blog.ensilo.com/archive/2016/11)\n\n[December 2015 (6)](http://blog.ensilo.com/archive/2015/12)\n\n[January 2016 (6)](http://blog.ensilo.com/archive/2016/01)\n\n[September 2016 (6)](http://blog.ensilo.com/archive/2016/09)\n\n[February 2017 (6)](http://blog.ensilo.com/archive/2017/02)\n\n[November 2015 (5)](http://blog.ensilo.com/archive/2015/11)\n\n[August 2016 (5)](http://blog.ensilo.com/archive/2016/08)\n\nsee all\n\n\n### Prevent threat actors from ex�ltrating your data.\n\n Schedule a demo\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2017/2017.02.28.dridexs-cold-war-enter-atombombing/AtomBombing_%20A%20Code%20Injection%20that%20Bypasses%20Current%20Security%20Solutions.pdf"
    ],
    "report_names": [
        "AtomBombing_ A Code Injection that Bypasses Current Security Solutions"
    ],
    "threat_actors": [
        {
            "id": "d4f7cf97-9c98-409c-8b95-b80d14c576a5",
            "created_at": "2022-10-25T16:07:24.561104Z",
            "updated_at": "2025-03-27T02:02:10.281202Z",
            "deleted_at": null,
            "main_name": "Shadow Brokers",
            "aliases": [],
            "source_name": "ETDA:Shadow Brokers",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "171b85f2-8f6f-46c0-92e0-c591f61ea167",
            "created_at": "2023-01-06T13:46:38.830188Z",
            "updated_at": "2025-03-27T02:00:02.929729Z",
            "deleted_at": null,
            "main_name": "The Shadow Brokers",
            "aliases": [
                "Shadow Brokers",
                "ShadowBrokers",
                "The ShadowBrokers",
                "TSB"
            ],
            "source_name": "MISPGALAXY:The Shadow Brokers",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041507,
    "ts_creation_date": 1488362301,
    "ts_modification_date": 1488362301,
    "files": {
        "pdf": "https://archive.orkl.eu/8ffce0fd5ec946cbb5da03a5a0f2796525aa600a.pdf",
        "text": "https://archive.orkl.eu/8ffce0fd5ec946cbb5da03a5a0f2796525aa600a.txt",
        "img": "https://archive.orkl.eu/8ffce0fd5ec946cbb5da03a5a0f2796525aa600a.jpg"
    }
}