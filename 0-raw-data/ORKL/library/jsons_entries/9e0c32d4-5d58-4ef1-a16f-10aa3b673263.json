{
    "id": "9e0c32d4-5d58-4ef1-a16f-10aa3b673263",
    "created_at": "2023-01-12T15:06:37.9026Z",
    "updated_at": "2025-03-27T02:16:59.982659Z",
    "deleted_at": null,
    "sha1_hash": "86f90cc34d9b1737028c16dd9e886849caac9c87",
    "title": "2020-01-29 - An Overhead View of the Royal Road",
    "authors": "",
    "file_creation_date": "2022-05-28T16:50:49Z",
    "file_modification_date": "2022-05-28T16:50:49Z",
    "file_size": 829040,
    "plain_text": "# An Overhead View of the Royal Road\n\n**[nao-sec.org/2020/01/an-overhead-view-of-the-royal-road.html](https://nao-sec.org/2020/01/an-overhead-view-of-the-royal-road.html)**\n\n2020-01-29\n\n## Abstract\n\nSeveral targeted attack groups share the tools used in the attack and are reported to be\ndoing similar attacks. Attack tools are also shared in attacks targeting Japanese\norganizations, for example, Tick. Tick may use a tool called Royal Road RTF Weaponizer.\n\n\n-----\n\nAnd Royal Road is used by targeted attack groups such as Goblin Panda and Temp.Trident\nthat is suspected of being involved in China.\n\nIn this blog, we will focus on the Royal Road, and introduce the features of the tool, such as\nthe outline of the tool, its behavior, and the exploited vulnerability. Next, the targeted attack\ngroups that use the Royal Road are listed, and each attack case is shown in detail. We have\ncollected over 100 malicious documents from 2018 and investigated malware that is\ndeployed and downloaded from there. Even in groups using the same Royal Road, we\nattributed them based on the target country/organization, the technique used for the attack,\nthe malware executed, etc.\n\nThere are a wide variety of countries/organizations targeted for attack, mainly in Asia. Such\ninformation has been published by researchers all over the world, but it’s not widely known\nthat Royal Road is used in Tick attacks targeting Japanese organizations. Attacks using\nRoyal Road are still active in 2019. Share analysis results of malicious documents and\nmalware based on the cases we observed. Other targeted attack groups may be related to\nRoyal Road. We introduce the attack cases of these attack groups and show their relevance.\n\nFinally, we show the hunting technique using the characteristics of RTF files using Royal\nRoad and the techniques that are preferred by targeted attack groups that use them. This\nblog will help researchers who are researching and analyzing targeted attacks and\nCSIRT/SOC members to understand the attacks and take countermeasures.\n\n## Summary\n\n### Royal Road\n\nRoyal Road is RTF weaponizer that named by Anomali. Sometimes called “8.t RTF exploit\nbuilder”. This tool is not OSS, However it’s shared between multiple actors.\n\nWe define the RTFs generated by RoyalRoad is supposed to satisfy the following two\nconditions:\n\n1. Exploit the vulnerability in the Equation Editor\n2. Have an object named 8.t in the RTF\n\nRoyal Road behaves as follows.\n\n1. RTF create a file (8.t) using ActiveX Control “Package” when opening a document\n\n2. All Vulnerabilities used by exploit coed are based on Equation Editor.\n\nCVE-2017-11882\nCVE-2018-0798\nCVE-2018-0802\n3 It decode 8 t execute malware dll-sideloading etc\n\n\n-----\n\nClassification v1-v5 defined by Proofpoint and Anomali published at VB2019. We are doing\nmore research about RTF Object. RTF analysis showed that there was a special byte\nsequence immediately before the shellcode. We called that an object pattern. 8.t encoding is\nnot distinguished by version. It’s considered an actor distinction rather than a tool distinction.\n\nAbout v3, RTF including 8.t could not be found in our survey, so we define this\nas RoyalRoad-related, not RoyalRoad.\n\nNew version definitions for v6 and later. The object string has changed a little since v5, but it\nis basically the same. v7 has a very different object string. v7 object pattern is same as v4v6, but part ofobject data exists randomly.\n\n\n-----\n\n### For attribution\n\nTime\n\nsubmission to public service\nRTF creation\nTarget country\n\ndecoy file language\nRTF characteristics\n\nObject strings\nObject patterns\nPackage patterns\nObject name, Path\nPayload encoding patterns\nDropped file name\nMalware execution techniques\n\nT1137 (Office Application Startup)\nT1073 (DLL Side-Loading)\nFinal payload (malware family)\n\n### Actors\n\nHere are the actors that have been confirmed to use RoyalRoad. It is considered that\nChina’s involvement is suspected.\n\n\n-----\n\nThese are tables summarizing each actor’s characteristics. We categorize these actors into\nthree groups.\n\n\n-----\n\n### Group\n\nGroup-A is Conimes, Periscope and Rancor.\nGroup-B is Trident, Tick, TA428 and Tonto.\nGroup-C is something else we don’t know.\n\nGroup-A is targeting Southeast Asia. Periscope and Conimes ware active at the same time\nand share the same techniques. Conimes and Rancor ware also active at the same time and\nshare some techniques. We believe these groups are close and may share tools and\ninsights.\n\n\n-----\n\nGroup-B is including Trident, Tick, TA428 and Tonto. These are actors targeting East Asia,\nespecially Russia, Korea and Japan. Tick, TA428 and Tonto may use the same technique.\nEspecially Tick and Tonto are very similar. We believe that Group-B actors are very close\nand share techniques and insights.\n\n### Wrap-up\n\nThe RTF file created using the Royal Road exploits a vulnerability in the equation editor. The\nRTF file has a various of characteristics that help with attribution. There are many actors who\nuse Royal Road. We can divide them into three groups and suppose connections between\nactors.\n\n### Appendix\n\n**Appendix-1: IOC**\n\n\n-----\n\n[https://nao-sec.org/jsac2020_ioc.html](https://nao-sec.org/jsac2020_ioc.html)\n\n**Appendix-2: Tool**\n\n[rr_decoder](https://github.com/nao-sec/rr_decoder)\n[Yara Rules](https://github.com/nao-sec/yara_rules)\n\nFull report is here: [[PDF (EN)]](https://github.com/nao-sec/materials/raw/master/JSAC%2BCPRCon2020/An_Overhead_View_of_the_Royal_Road.pdf)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-29 - An Overhead View of the Royal Road.pdf"
    ],
    "report_names": [
        "2020-01-29 - An Overhead View of the Royal Road.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a4aca3ca-9e04-42d1-b037-f7fb3fbab0b1",
            "created_at": "2023-01-06T13:46:39.042499Z",
            "updated_at": "2025-03-27T02:00:02.984002Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Colourful Panda",
                "BRONZE DUDLEY"
            ],
            "source_name": "MISPGALAXY:TA428",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "416f8374-2b06-47e4-ba91-929b3f85d9bf",
            "created_at": "2022-10-25T16:07:24.093951Z",
            "updated_at": "2025-03-27T02:02:10.105752Z",
            "deleted_at": null,
            "main_name": "Rancor",
            "aliases": [
                "Rancor Group",
                "Rancor Taurus"
            ],
            "source_name": "ETDA:Rancor",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "DDKONG",
                "Derusbi",
                "Dudell",
                "ExDudell",
                "KHRAT",
                "PLAINTEE",
                "RoyalRoad",
                "certutil",
                "certutil.exe",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e8aee970-e31e-489f-81c2-c23cd52e255c",
            "created_at": "2023-01-06T13:46:38.763687Z",
            "updated_at": "2025-03-27T02:00:02.91243Z",
            "deleted_at": null,
            "main_name": "RANCOR",
            "aliases": [
                "Rancor",
                "Rancor Group",
                "G0075",
                "Rancor Taurus",
                "Rancor group"
            ],
            "source_name": "MISPGALAXY:RANCOR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c416260c-7ff6-4a74-a5ba-a15f40d3543f",
            "created_at": "2024-05-01T02:03:07.939268Z",
            "updated_at": "2025-03-27T02:05:17.25652Z",
            "deleted_at": null,
            "main_name": "BRONZE DUDLEY",
            "aliases": [
                "Temp.Hex ",
                "Vicious Panda ",
                "TA428 "
            ],
            "source_name": "Secureworks:BRONZE DUDLEY",
            "tools": [
                "PoisonIvy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "6d11e45c-4e31-4997-88f5-295b2564cfc6",
            "created_at": "2022-10-25T15:50:23.794721Z",
            "updated_at": "2025-03-27T02:00:55.548806Z",
            "deleted_at": null,
            "main_name": "Rancor",
            "aliases": [
                "Rancor"
            ],
            "source_name": "MITRE:Rancor",
            "tools": [
                "DDKONG",
                "PLAINTEE",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bbb1ee4e-bbe9-44de-8f46-8e7fec09f695",
            "created_at": "2022-10-25T16:07:24.120424Z",
            "updated_at": "2025-03-27T02:02:10.112981Z",
            "deleted_at": null,
            "main_name": "RedFoxtrot",
            "aliases": [
                "Moshen Dragon",
                "Nomad Panda",
                "TEMP.Trident"
            ],
            "source_name": "ETDA:RedFoxtrot",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Fucobha",
                "GUNTERS",
                "Gen:Trojan.Heur.PT",
                "Icefog",
                "Impacket",
                "Kaba",
                "Korplug",
                "PCShare",
                "POISONPLUG.SHADOW",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "XShellGhost",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2c7ecb0e-337c-478f-95d4-7dbe9ba44c39",
            "created_at": "2022-10-25T16:07:23.690871Z",
            "updated_at": "2025-03-27T02:02:09.921431Z",
            "deleted_at": null,
            "main_name": "Goblin Panda",
            "aliases": [
                "1937CN",
                "Conimes",
                "Cycldek",
                "Goblin Panda"
            ],
            "source_name": "ETDA:Goblin Panda",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "BackDoor-FBZT!52D84425CDF2",
                "BlueCore",
                "BrowsingHistoryView",
                "ChromePass",
                "CoreLoader",
                "Custom HDoor",
                "Destroy RAT",
                "DestroyRAT",
                "DropPhone",
                "FoundCore",
                "HDoor",
                "HTTPTunnel",
                "JsonCookies",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "NBTscan",
                "NewCore RAT",
                "PlugX",
                "ProcDump",
                "PsExec",
                "QCRat",
                "RainyDay",
                "RedCore",
                "RedDelta",
                "RoyalRoad",
                "Sisfader",
                "Sisfader RAT",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trojan.Win32.Staser.ytq",
                "USBCulprit",
                "Win32/Zegost.BW",
                "Xamtrav",
                "ZeGhost",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7d553b83-a7b2-431f-9bc9-08da59f3c4ea",
            "created_at": "2023-01-06T13:46:39.444946Z",
            "updated_at": "2025-03-27T02:00:03.093712Z",
            "deleted_at": null,
            "main_name": "GOBLIN PANDA",
            "aliases": [
                "Conimes",
                "Cycldek"
            ],
            "source_name": "MISPGALAXY:GOBLIN PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535997,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653756649,
    "ts_modification_date": 1653756649,
    "files": {
        "pdf": "https://archive.orkl.eu/86f90cc34d9b1737028c16dd9e886849caac9c87.pdf",
        "text": "https://archive.orkl.eu/86f90cc34d9b1737028c16dd9e886849caac9c87.txt",
        "img": "https://archive.orkl.eu/86f90cc34d9b1737028c16dd9e886849caac9c87.jpg"
    }
}