{
    "id": "169858ca-4018-4af2-bfd9-29daa770dea3",
    "created_at": "2023-01-12T15:05:48.25766Z",
    "updated_at": "2025-03-27T02:16:34.587027Z",
    "deleted_at": null,
    "sha1_hash": "3e5a8e36429cccbda301d72e9651f8ba06d072c4",
    "title": "2022-07-05 - When Pentest Tools Go Brutal- Red-Teaming Tool Being Abused by Malicious Actors",
    "authors": "",
    "file_creation_date": "2022-07-18T18:21:49Z",
    "file_modification_date": "2022-07-18T18:21:49Z",
    "file_size": 2706110,
    "plain_text": "# When Pentest Tools Go Brutal: Red-Teaming Tool Being Abused by Malicious Actors\n\n**unit42.paloaltonetworks.com/brute-ratel-c4-tool/**\n\nMike Harbison, Peter Renals July 5, 2022\n\nBy [Mike Harbison and](https://unit42.paloaltonetworks.com/author/mike-harbison/) [Peter Renals](https://unit42.paloaltonetworks.com/author/peter-renals/)\n\nJuly 5, 2022 at 6:00 AM\n\n[Category: Threat Advisory/Analysis](https://unit42.paloaltonetworks.com/category/threat-briefs-assessments/threat-advisory-analysis/)\n\nTags: [APT 29,](https://unit42.paloaltonetworks.com/tag/apt-29/) [brute ratel c4,](https://unit42.paloaltonetworks.com/tag/brute-ratel-c4/) [pentest tool,](https://unit42.paloaltonetworks.com/tag/pentest-tool/) [red teaming tool](https://unit42.paloaltonetworks.com/tag/red-teaming-tool/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/brute-ratel-c4-tool/)\n\n## Executive Summary\n\nUnit 42 continuously hunts for new and unique malware samples that match known\nadvanced persistent threat (APT) patterns and tactics. On May 19, one such sample was\nuploaded to VirusTotal, where it received a benign verdict from all 56 vendors that evaluated\nit. Beyond the obvious detection concerns, we believe this sample is also significant in terms\nof its malicious payload, command and control (C2), and packaging.\n\n[The sample contained a malicious payload associated with Brute Ratel C4 (BRc4), the](https://bruteratel.com/)\nnewest red-teaming and adversarial attack simulation tool to hit the market. While this\ncapability has managed to stay out of the spotlight and remains less commonly known than\n[its Cobalt Strike brethren it is no less sophisticated Instead this tool is uniquely dangerous](https://unit42.paloaltonetworks.com/tag/cobalt-strike/)\n\n\n-----\n\nin that it was specifically designed to avoid detection by endpoint detection and response\n(EDR) and antivirus (AV) capabilities. Its effectiveness at doing so can clearly be witnessed\nby the aforementioned lack of detection across vendors on VirusTotal.\n\nIn terms of C2, we found that the sample called home to an Amazon Web Services (AWS) IP\naddress located in the United States over port 443. Further, the X.509 certificate on the\nlistening port was configured to impersonate Microsoft with an organization name of\n“Microsoft” and organization unit of “Security.” Additionally, pivoting on the certificate and\nother artifacts, we identified a total of 41 malicious IP addresses, nine BRc4 samples, and an\nadditional three organizations across North and South America who have been impacted by\nthis tool so far.\n\n[This unique sample was packaged in a manner consistent with known APT29 techniques](https://attack.mitre.org/groups/G0016/)\nand their recent campaigns, which leveraged well-known cloud storage and online\ncollaboration applications. Specifically, this sample was packaged as a self-contained ISO.\nIncluded in the ISO was a Windows shortcut (LNK) file, a malicious payload DLL and a\nlegitimate copy of Microsoft OneDrive Updater. Attempts to execute the benign application\nfrom the ISO-mounted folder resulted in the loading of the malicious payload as a\ndependency through a technique known as DLL search order hijacking. However, while\npackaging techniques alone are not enough to definitively attribute this sample to APT29,\nthese techniques demonstrate that users of the tool are now applying nation-state tradecraft\nto deploy BRc4.\n\nOverall, we believe this research is significant in that it identifies not only a new red team\ncapability that is largely undetectable by most cybersecurity vendors, but more importantly, a\ncapability with a growing user base that we assess is now leveraging nation-state\ndeployment techniques. This blog provides an overview of BRc4, a detailed analysis of the\nmalicious sample, a comparison between the packaging of this sample and a recent APT29\nsample, and a list of indicators of compromise (IoCs) that can be used to hunt for this activity.\n\nWe encourage all security vendors to create protections to detect activity from this tool and\nall organizations to be on alert for activity from this tool.\n\nPalo Alto Networks customers receive protections from the threats described in this blog\nthrough Threat Prevention, Cortex XDR and WildFire malware analysis.\n\nFull visualization of the techniques observed, relevant courses of action and indicators of\n[compromise (IoCs) related to this report can be found in the Unit 42 ATOM viewer.](https://unit42.paloaltonetworks.com/atoms/brute-ratel)\n\nRelated Unit 42 Topics [APT29,](https://unit42.paloaltonetworks.com/tag/apt-29/) [Cobalt Strike](https://unit42.paloaltonetworks.com/tag/cobalt-strike/)\n\n## Table of Contents\n\n\n-----\n\nBrute Ratel C4 Overview\nFrom Click to Brute\n\nPackaging of Roshan_CV.iso\n\nModification of Version.dll\n\nx64 Shellcode – Decrypted OneDrive.Update\n\nTarget Network Infrastructure\n\nIdentifying OneDrive.Update\n\nBadger_x64.exe Employment\n\nOther Samples and Infrastructure\n\nProtections and Mitigations\n\nConclusion\n\nIndicators of Compromise\n\nAdditional Resources\n\n## Brute Ratel C4 Overview\n\nBrute Ratel C4 made its initial debut as a penetration testing tool in December 2020. At the\ntime, its development was a part-time effort by a security engineer named Chetan Nayak\n[(aka Paranoid Ninja) living in India. According to his website (Dark Vortex), Nayak amassed](https://0xdarkvortex.dev/about/)\nseveral years of experience working in senior red team roles across western cybersecurity\nvendors. Over the past 2.5 years, Nayak introduced incremental improvements to the\npentest tool in terms of features, capabilities, support and training.\n\nIn January 2022, Nayak left his day job in order to pursue full-time development and training\n[workshops. That same month, he released Brute Ratel v0.9.0 (Checkmate), which is](https://bruteratel.com/release/2022/01/24/Release-Checkmate/)\ndescribed as the “biggest release for Brute Ratel till date.”\n\nFigure 1. Checkmate release notes.\nHowever, of greater concern, the release description also specifically noted that “this release\nwas built after reverse engineering several top tier EDR and Antivirus DLLs.”\n\nOur analysis highlights the ongoing and relevant debate within the cybersecurity industry\nsurrounding the ethics relating to the development and use of penetration testing tools that\ncan be exploited for offensive purposes.\n\nBRc4 currently advertises itself as “A Customized Command and Control Center for Red\nTeam and Adversary Simulation.” On May 16, Nayak announced that the tool had gained\n480 users across 350 customers\n\n\n-----\n\nFigure 2. BRC4 customer announcement. Source:\nhttps://twitter.com/NinjaParanoid/status/1526110403356282880\nThe latest version, Brute Ratel v1.0 (Sicilian Defense) was released a day later on May 17,\nand is currently offered for sale at a price of $2,500 per user and $2,250 per renewal. With\nthis price point and customer base, BRc4 is positioned to take in more than $1 million dollars\nin sales over the next year.\n\n\n-----\n\nFigure 3. BRc4 licensing and cost.In terms of features, BRc4 advertises the following\ncapabilities:\n\nSMB and TCP payloads provide functionality to write custom external C2 channels\nover legitimate websites such as Slack, Discord, Microsoft Teams and more.\nBuilt-in debugger To detect EDR userland hooks.\nAbility to keep memory artifacts hidden from EDRs and AV.\nDirect Windows SYS calls on the fly.\nEgress over HTTP, HTTPS, DNS Over HTTPS, SMB and TCP.\nLDAP Sentinel provides a rich GUI interface to query various LDAP queries to the\ndomain or a forest.\nMultiple command and control channels – multiple pivot options such as SMB, TCP,\nWMI, WinRM and managing remote services over RPC.\nTake screenshots.\nx64 shellcode loader.\nReflective and object file loader.\nDecoding KRB5 ticket and converting it to hashcat.\nPatching Event Tracing for Windows (ETW).\nPatching Anti Malware Scan Interface (AMSI).\nCreate Windows system services.\nUpload and download files.\nCreate files via CreateFileTransacted.\nPort scan.\n\n## From Click to Brute\n\n\n-----\n\nFigure 4. VirusTotal verdicts for sample as of June 27, 2022.\nThe file in VirusTotal named Roshan_CV.iso (SHA256:\n1FC7B0E1054D54CE8F1DE0CC95976081C7A85C7926C03172A3DDAA672690042C)\nappears to be a curriculum vitae (similar to a resume) of an individual named Roshan. It was\nuploaded to VirusTotal on May 19, 2022, from Sri Lanka. The ISO file extension refers to an\noptical disc image file, derived from the International Organization for Standardization’s ISO\n9960 file system, which is typically used to back up files for CD/DVD. The ISO file is not\nmalicious and requires a user to double-click, which mounts the ISO as a Windows drive.\nFinally, the archived files of the ISO are displayed to the user. In this case, when the ISO is\ndouble-clicked, a user is presented with the following:\n\nFigure 5. Viewing ISO image.\nAs depicted in Figure 5, the user would see a file named Roshan-Bandara_CV_Dialog,\nwhich has a fake icon image of Microsoft Word, purporting to be an individual's CV, and\nwritten in Microsoft Word. From the window dialog box it can be ascertained that the ISO was\nassembled on May 17, 2022, which coincidentally is the same day the new BRc4 was\nreleased.\n\nIf the user were to double-click on the file, it would then install Brute Ratel C4 on the user's\nmachine\n\n\n-----\n\nBy default, on Windows operating systems, hidden files are not displayed to the user. In\nFigure 6, there are four hidden files concealed from view. If the display of hidden files is\nenabled, the user sees the following:\n\nFigure 6. Viewing ISO image with “show hidden files” enabled.\nThe lure file, the one visible to the user, is a Windows shortcut file (LNK) with the following\nproperties:\n\n\n-----\n\nFigure 7. Roshan-Bandara_CV_Dialog properties.\nMicrosoft shortcut files, those with a .lnk file extension, contain enriched metadata that can\nbe used to provide artifacts about the file. Some key artifacts of this file are:\n\nLink CLSID: 20D04FE0-3AEA-1069-A2D8-08002B30309D\n\nThe CLSID used here isn’t the normal CLSID for LNK files, as this CLSID is\nassociated with the Control Panel (always Icons view).\nCommand line arguments: %windir%/system32/cmd.exe /c start OneDriveUpdater.exe\nIcon location: C:\\Program Files\\Microsoft Office\\root\\Office16\\WINWORD.EXE\n\nWhen Roshan-Bandara_CV_Dialog is double-clicked, the following actions occur:\n\n\n-----\n\n1. cmd.exe is launched with the parameters of:\n\n1. /c start OneDriveUpdater.exe. The /c parameter instructs cmd.exe to launch\n\nOneDriveUpdater.exe via Windows start command from the current working\ndirectory and exit.\n2. OneDriveUpdater.exe is a digitally signed binary by Microsoft that is used to\n\nsynchronize data from a local machine to the cloud. It is not malicious and is being\nabused to load the actor’s DLL. Once OneDriveUpdater.exe is executed, the following\nactions occur:\n\n1. Since Version.dll is a dependency DLL of OneDriveUpdater.exe and exists in the\n\nsame directory as OneDriveUpdater.exe, it will be loaded.\n2. Version.dll has been modified by the actors to load an encrypted payload file,\n\nOneDrive.update. The modification decrypts the file and in-memory loads the first\nstage of shellcode. To maintain code capabilities, the actors use DLL API\nproxying to forward requests to the legitimate version.dll named vresion.dll.\nVresion.dll is a dependency file of the actor’s version.dll and will be loaded with\nthe actor’s version.dll.\n3. The in-memory code, that is Brute Ratel C4, executes as a Windows thread in the\n\nRuntimeBroker.exe process space and begins to communicate with IP\n174.129.157[.]251 on TCP port 443.\n\nFigure 8 below gives an overview of how this process would look.\n\n\n-----\n\nFigure 8. Execution flow when double-clicking Roshan-Bandara_CV_Dialog\n\n## Packaging of Roshan_CV.ISO\n\nThe composition of the ISO file, Roshan_CV.ISO, closely resembles that of other nation-state\nAPT tradecraft. The following table shows a side-by-side comparison of Roshan_CV.ISO and\nthat of a previously identified APT29 sample (Decret.ISO).\n\n\n-----\n\nTable 1. Package deployment comparison to known APT29 sample.\nThe following images show how Roshan_CV.ISO and Decret.ISO would look to a user when\ndouble-clicked. Figure 9 is a screenshot of the default Windows File Explorer; “show hidden\nfiles” is not checked. In both images, the user is presented with a shortcut file (LNK file) that\nstarts the malicious activity when double-clicked.\n\nFigure 9. Side-by-Side comparison of mounted ISO images. \"Show hidden files\" is not\nenabled.\nFigure 10 shows how the ISOs would appear when show hidden files” is enabled for viewing.\n\nFigure 10. Side-by-Side comparison of mounted ISO images. \"Show hidden files\" is enabled.\nThe flow of execution is the following:\n\n\n-----\n\nRoshan_CV.ISO→RoshanBandar_CV_Dialog.LNK→cmd.exe→OneDriveUpdater.exe→version.dll→OneDrive.Update\n\nDecret.ISO→Decret.LNK→cmd.exe→HPScan.exe→version.dll→HPScanApi.dll\n\nThe delivery of packaged ISO files is typically sent via spear phishing email campaigns or\ndownloaded to the victim by a second-stage downloader.\n\nWhile we lack insight into how this particular payload was delivered to a target environment,\nwe observed connection attempts to the C2 server originating from three Sri Lankan IP\naddresses between May 19-20.\n\n## Modification of Version.dll\n\nVersion.dll is a modified version of a legitimate Microsoft file written in C++. The implanted\ncode is used to load and decrypt an encrypted payload file. The decrypted payload is that of\nshellcode (x64 assembly) that is further used to execute Brute Ratel C4 on the host.\n\nIn order for Version.dll to maintain its code capabilities for OneDriveUpdater.exe, the actors\ninclude the legitimate digitally signed Microsoft version.dll and named it vresion.dll. Any time\nOneDriveUpdater.exe makes a call into the actor’s Version.dll, the call is proxied to\nvresion.dll. Because of this, the actor’s version.dll will load vresion.dll as a dependency file.\n\nThe implanted code begins when the DLL is loaded via DLL_PROCESS_ATTACH and\nperforms the following at the DLLMain subroutine:\n\n1. Enumerate all processes and locate the process ID (PID) for Runtimebroker.exe.\n2. Read the payload file OneDrive.Update from the current working directory.\n3. Call the Windows API ntdll ZwOpenProcess using the process ID from step 1. The\n\nprocess is opened with full control access.\n4. Decrypt the payload file using the XOR encryption algorithm with a 28-byte key of:\n\njikoewarfkmzsdlhfnuiwaejrpaw\n5. Call the Windows API NtCreateSection, which creates a block of memory that can be\n\nshared between processes. This API is used to share memory with Runtimebroker.exe\nand Version.dll.\n6. Two calls into the Windows API NtMapViewOfSection. The first call maps the contents\n\nof the decrypted payload into the current process memory space, and the second call\nmaps the contents into the Runtimebroker.exe memory space.\n7. Calls the Windows API NtDelayExecution and sleeps (pauses execution) for ~4.27\n\nseconds.\n8. Call the Windows API NtCreateThreadEx. This API starts a new thread with the start\n\naddress of the memory copied to Runtimebroker.exe.\n9. Calls the Windows API NtDelayExecution and sleeps (pauses execution) for ~4.27\n\nseconds\n\n\n-----\n\n10. Finished.\n\nThe technique outlined above uses process injection via undocumented Windows NTAPI\ncalls. The decrypted payload is now running within the runtimebroker.exe memory space.\nThe following is a snippet of code from version.dll that starts the execution of the in-memory\ndecrypted payload.\n\nFigure 11. Version.dll calling NtCreateThreadEx.\n\n## X64 Shellcode – Decrypted OneDrive.Update\n\nThe decrypted payload file is x64 shellcode (assembly instructions) that involves a series of\nexecutions to unpack itself. The assembly instructions involve multiple push and mov\ninstructions. The purpose of this is to copy the Brute Ratel C4 code (x64 assembly) onto the\nstack eight bytes at a time and eventually reassemble it into a memory space for execution –\na DLL with a stripped MZ header. Using a series of push and mov instructions evades inmemory scanning as the shellcode is assembled in blocks versus the entire code base being\nexposed for scanning. The entry point of the decrypted payload is the following:\n\n\n-----\n\nFigure 12. Version.dll entry point of decrypted payload.\nThe unpacking involves 25,772 push and 25,769 mov instructions. When finished, the code\nperforms the following.\n\n1. Using API hashing (ROR13 – rotate right 13) looks up the hash for\n\nNtAllocateVirtualMemory. All API calls are made via API hash lookups.\n2. Resolves the system call index from the System Service Dispatch Table (SSDT) for\n\nNtAllocateVirtualMemory. All Windows API functions are made via syscalls, which is a\n[feature of Brute Ratel C4 (Syscall Everything).](https://bruteratel.com/)\n3. Calls the Windows API NtAllocateVirtualMemory, allocating 0x3000 bytes of memory.\n4. Makes a second Windows API call into NtAllocateVirtualMemory, which allocates\n\nmemory for the configuration file used by Brute Ratel C4.\n5. Copies the shellcode that was pushed onto the stack in the previous steps to the newly\n\nallocated memory segment.\n6. Changes the protection of the newly allocated memory block using Windows API call\n\nNtProtectVirtualMemory.\n7. Calls NtCreateThreadEx with the start address of the newly allocated memory and\n\npasses the configuration data as a parameter.\n8. Finished.\n\nThe following is a snippet of the code that calls NtCreateThreadEx and starts the execution\nof the second-stage shellcode.\n\n\n-----\n\nFigure 13. Calling second layer of shellcode.\nThe configuration data is passed as a parameter to the start address of the new thread. This\ndata includes the encrypted configuration settings for Brute Ratel C4. The encrypted\ncontents are the following:\n\nFigure 14. BRc4 encrypted configuration.\nThe data is base64-encoded and RC4-encrypted. The 16-byte RC4 decryption key is:\nbYXJm/3#M?:XyMBF\n\nThe decrypted configuration file is:\n\n\n-----\n\nEach parameter is delineated with a pipe | character, and one of the values is the IP seen\nearlier of 174.129.157[.]251 and port of 443.\n\n## Target Network Infrastructure\n\nThe IP 174.129.157[.]251 is hosted on Amazon AWS, and Palo Alto Networks Cortex\nXpanse history shows the IP had TCP port 443 open from April 29, 2022, until May 23, 2022,\nwith a self-signed SSL certificate impersonating Microsoft Security:\n\nsubjectFullName: C=US,ST=California,O=Microsoft,OU=Security,CN=localhost\nSerial Number: 476862511373535319627199034793753459614889484917\nsha256_fingerprint:\nd597d6572c5616573170275d0b5d5e3ab0c06d4a9104bbdbe952c4bcb52118c9\n\nOnce the SSL handshake to IP 174.129.157[.]251 is complete, the following data is sent via\nHTTP POST to the Brute Ratel C4 listener port.\n\nFigure 15. BRc4 HTTP POST.\n\n## Identifying OneDrive.Update\n\nTo identify the decrypted in-memory payload as being associated with Brute Ratel C4, we\nconducted hunting based on the unique in-memory assembly instructions, push and mov.\nThese instructions are used to build the second layer of shellcode. Searching across\nVirusTotal, we found a second sample with the same push and mov instructions:\n\nFile name: badger_x64.exe\nSHA256:\n3AD53495851BAFC48CAF6D2227A434CA2E0BEF9AB3BD40ABFE4EA8F318D37BBE\nFile Type: Windows Executable (x64)\n\n\n-----\n\nInitially, what stood out to us was the filename containing the word badger. According to the\n[Brute Ratel C4 website, the word “badger” represents payloads used for remote access.](https://bruteratel.com/tabs/badger/badgers/)\nWhen uploaded to VirusTotal, only two out of 66 vendors considered the sample malicious.\nCurrently, 12 vendors identify the sample as malicious with eight classifying this sample as\n“Brutel,” further supporting that our in-memory code is somehow associated with that of\nBrute Ratel C4.\n\nSide-by-side comparison of the entry point of badger_x64.exe and our decrypted\nOneDrive.Update sample:\n\nFigure 16. Comparison of OneDrive.Update and badger_x64.exe\nWhen badger_x64.exe is finished with the push and mov instructions, it makes the same\nWindows API calls as OneDrive.Update using API hashing, but does not use direct syscall (a\nuser configuration feature of Brute Ratel C4). Example of badger_x64.exe:\n\n\n-----\n\nFigure 17. badger_x64.exe calling shellcode.\nLike the OneDrive.Update sample, the parameter passed to the calling thread is the\nconfiguration data for Brute Ratel C4. In this sample, the data is not base64-encoded or\nRC4-encrypted, and is passed in the clear. The following is the configuration used for this\nsample:\n\nIn this case, the sample is configured to communicate with IP 159.65.186[.]50 on TCP port\n443.\n\nBased on the following, we can conclude that OneDrive.Update is indeed associated with\nBrute Ratel C4.\n\nThe configuration file structure is the same and uses pipes to delineate fields.\nSame Windows calling pattern used to run the second-stage shellcode via\nNtCreateThreadEx/CreateThread.\nFunction instruction match for copying shellcode to memory allocation.\n\n\n-----\n\nBoth samples of second-stage shellcode have the following strings referencing the\nword “badger.” Note: The OneDrive.Update sample RC4 encrypts these strings.\n\nimp_Badger\nBadgerDispatch\nBadgerDispatchW\nBadgerStrlen\nBadgerWcslen\nBadgerMemcpy\nBadgerMemset\nBadgerStrcmp\nBadgerWcscmp\nBadgerAtoi\n[The Badger* names match the export names listed on the BRc4 GitHub website.](https://github.com/paranoidninja/Brute-Ratel-C4-Community-Kit/blob/main/bof_samples/badger_exports.h)\n\nThe file badger_x64.exe is a standalone x64 executable that runs Brute Ratel C4 (badger\npayload) while the decrypted OneDrive.Update file is the in-memory component of Brute\nRatel C4 that is executed using the actor's modified DLL, version.dll.\n\n## Badger_x64.exe Employment\n\nAfter validating that badger_x64.exe and OneDrive.Update were both BRc4 payloads, we set\nto work analyzing the employment of this second sample.\n\nVirusTotal records revealed that the sample was uploaded by a web user in Ukraine on May\n20, 2022. Coincidentally, this happens to be one day after the ​​Roshan_CV.ISO file was\nuploaded.\n\nAs noted above, the sample was configured to call home to 159.65.186[.]50 on port 443.\nPalo Alto Networks Cortex Xpanse history shows that this port was open from May 21-June\n18, 2022, with the same “Microsoft Security” self-signed SSL certificate seen above. Given\nthis timeline, it's worth noting that the sample was actually uploaded to VirusTotal prior to the\nC2 infrastructure being configured to listen for the callbacks.\n\nEvaluating netflow connections for 159.65.186[.]50 during this time window revealed several\nconnections to ports 22, 443 and 8060 originating from a Ukrainian IP (213.200.56[.]105).\nWe assess this Ukrainian address is likely a residential user IP that was leveraged to\nadminister the C2 infrastructure. A deeper look at connections in and out of 213.200.56[.]105\nfurther revealed several flows over UDP port 33445. This port is commonly used by Tox, a\nsecure peer-to-peer chat and video application that offers end-to-end encryption.\n\nExamining additional connections to port 443 on 159.65.186[.]50, we identified several\nsuspected victims including an Argentinian organization, an IP television provider providing\nNorth and South American content, and a major textile manufacturer in Mexico.\n\n\n-----\n\nCoincidentally, recent attempts to browse the textile manufacturer s website result in a 500\ninternal server error message.\n\nGiven the geographic dispersion of these victims, the upstream connection to a Ukrainian IP\nand several other factors, we believe it is highly unlikely that BRc4 was deployed in support\nof legitimate and sanctioned penetration testing activities.\n\n## Other Samples and Infrastructure\n\nOver the past year, the fake Microsoft Security X.509 certificate has been linked to 41 IP\naddresses. These addresses follow a global geographic dispersion and are predominantly\nowned by large virtual private server (VPS) hosting providers. Expanding our research\nbeyond the two samples discussed above, we have also identified an additional seven\nsamples of BRc4 dating back to February 2021.\n\n## Protections and Mitigations\n\nFor Palo Alto Networks customers, our products and services provide the following coverage\nassociated with this group:\n\n[Threat Prevention provides protection against Brute Ratel C4. The \"Brute Ratel C4 Tool](https://threatvault.paloaltonetworks.com/?query=86647)\nCommand and Control Traffic Detections\" signature is threat ID 86647.\n\n[Cortex XDR detects and protects endpoints from the Brute Ratel C4 tool.](https://www.paloaltonetworks.com/cortex/cortex-xdr)\n\n[WildFire cloud-based threat analysis service accurately identifies Brute Ratel C4 samples as](https://www.paloaltonetworks.com/products/secure-the-network/wildfire)\nmalware.\n\n## Conclusion\n\nThe emergence of a new penetration testing and adversary emulation capability is\nsignificant. Yet more alarming is the effectiveness of BRc4 at defeating modern defensive\nEDR and AV detection capabilities.\n\nOver the past 2.5 years this tool has evolved from a part-time hobby to a full-time\ndevelopment project with a growing customer base. As this customer base has expanded\ninto the hundreds, the tool has gained increased attention across the cybersecurity domain\nfrom both legitimate penetration testers as well as malicious cyber actors.\n\nThe analysis of the two samples described in this blog, as well as the advanced tradecraft\nused to package these payloads, make it clear that malicious cyber actors have begun to\nadopt this capability. We believe it is imperative that all security vendors create protections to\ndetect BRc4 and that all organizations take proactive measures to defend against this tool.\n\n\n-----\n\nPalo Alto Networks has shared these findings, including file samples and indicators of\ncompromise, with our fellow Cyber Threat Alliance members. CTA members use this\nintelligence to rapidly deploy protections to their customers and to systematically disrupt\n[malicious cyber actors. Learn more about the Cyber Threat Alliance.](http://www.cyberthreatalliance.org/)\n\nNote that the Microsoft name and logo shown are an attempt to impersonate a legitimate\norganization and do not represent an actual affiliation with Microsoft. This impersonation\ndoes not imply a vulnerability in Microsoft’s products or services.\n\n## Indicators of Compromise\n\nBrute Ratel C4 ISO Samples:\n\n1FC7B0E1054D54CE8F1DE0CC95976081C7A85C7926C03172A3DDAA672690042C\n\nX64 Brute Ratel C4 Windows Kernel Module:\n\n31ACF37D180AB9AFBCF6A4EC5D29C3E19C947641A2D9CE3CE56D71C1F576C069\n\nAPT29 ISO Samples:\n\nF58AE9193802E9BAF17E6B59E3FDBE3E9319C5D27726D60802E3E82D30D14D46\n\nX64 Brute Ratel C4 Samples:\n\n3ED21A4BFCF9838E06AD3058D13D5C28026C17DC996953A22A00F0609B0DF3B9\n\n3AD53495851BAFC48CAF6D2227A434CA2E0BEF9AB3BD40ABFE4EA8F318D37BBE\n\n973F573CAB683636D9A70B8891263F59E2F02201FFB4DD2E9D7ECBB1521DA03E\n\nDD8652E2DCFE3F1A72631B3A9585736FBE77FFABEE4098F6B3C48E1469BF27AA\n\nE1A9B35CF1378FDA12310F0920C5C53AD461858B3CB575697EA125DFEE829611\n\nEF9B60AA0E4179C16A9AC441E0A21DC3A1C3DC04B100EE487EABF5C5B1F571A6\n\nD71DC7BA8523947E08C6EEC43A726FE75AED248DFD3A7C4F6537224E9ED05F6F\n\n5887C4646E032E015AA186C5970E8F07D3ED1DE8DBFA298BA4522C89E547419B\n\nMalicious DLLs:\n\nEA2876E9175410B6F6719F80EE44B9553960758C7D0F7BED73C0FE9A78D8E669\n\nMalicious Encrypted Payloads:\n\nB5D1D3C1AEC2F2EF06E7D0B7996BC45DF4744934BD66266A6EBB02D70E35236E\n\nX.509 Cert SHA1s:\n\n55684a30a47476fce5b42cbd59add4b0fbc776a3\n\n66aab897e33b3e4d940c51eba8d07f5605d5b275\n\n\n-----\n\nInfrastructure linked to X.509 Certs or Samples:\n\n104.6.92[.]229\n\n137.184.199[.]17\n\n138.68.50[.]218\n\n138.68.58[.]43\n\n139.162.195[.]169\n\n139.180.187[.]179\n\n147.182.247[.]103\n\n149.154.100[.]151\n\n15.206.84[.]52\n\n159.223.49[.]16\n\n159.65.186[.]50\n\n162.216.240[.]61\n\n172.105.102[.]247\n\n172.81.62[.]82\n\n174.129.157[.]251\n\n178.79.143[.]149\n\n178.79.168[.]110\n\n178.79.172[.]35\n\n18.133.26[.]247\n\n18.130.233[.]249\n\n18.217.179[.]8\n\n18.236.92[.]31\n\n185.138.164[.]112\n\n194.29.186[.]67\n\n194.87.70[.]14\n\n213.168.249[.]232\n\n3.110.56[.]219\n\n3.133.7[.]69\n\n31.184.198[.]83\n\n34.195.122[.]225\n\n34.243.172[.]90\n\n35.170.243[.]216\n\n45.144.225[.]3\n\n45.76.155[.]71\n\n45.79.36[.]192\n\n52.48.51[.]67\n\n52.90.228[.]203\n\n54.229.102[.]30\n\n54.90.137[.]213\n\n89.100.107[.]65\n\n\n-----\n\n92.255.85[.]173\n92.255.85[.]44\n\n94.130.130[.]43\n\nds.windowsupdate.eu[.]org\n\n## Additional Resources\n\n[Hunting for APT29 Spear Phishing Using XDR - Palo Alto Networks Blog](https://www.paloaltonetworks.com/blog/security-operations/hunting-for-apt29-spear-phishing-using-xdr/#!)\n\nCozy Smuggled Into The Box: APT29 Abusing Legitimate Software For Targeted Operations\nIn Europe\n\n[Trello From the Other Side: Tracking APT29 Phishing Campaigns](https://www.mandiant.com/resources/tracking-apt29-phishing-campaigns)\n\n[New sophisticated email-based attack from NOBELIUM](https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/)\n\n_Updated July 6, 2022, at 9:30 a.m. PT._\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-05 - When Pentest Tools Go Brutal- Red-Teaming Tool Being Abused by Malicious Actors.pdf"
    ],
    "report_names": [
        "2022-07-05 - When Pentest Tools Go Brutal- Red-Teaming Tool Being Abused by Malicious Actors.pdf"
    ],
    "threat_actors": [
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535948,
    "ts_updated_at": 1743041794,
    "ts_creation_date": 1658168509,
    "ts_modification_date": 1658168509,
    "files": {
        "pdf": "https://archive.orkl.eu/3e5a8e36429cccbda301d72e9651f8ba06d072c4.pdf",
        "text": "https://archive.orkl.eu/3e5a8e36429cccbda301d72e9651f8ba06d072c4.txt",
        "img": "https://archive.orkl.eu/3e5a8e36429cccbda301d72e9651f8ba06d072c4.jpg"
    }
}