{
    "id": "b28e8f86-be07-4c7d-9b92-5c6a23611950",
    "created_at": "2022-10-25T16:48:15.827558Z",
    "updated_at": "2025-03-27T02:17:05.8174Z",
    "deleted_at": null,
    "sha1_hash": "6a6ad533b71fd64fc9dd4948e920a0992f637302",
    "title": "When The Lights Went Out: Ukraine Cybersecurity Threat Briefing",
    "authors": "Booz Allen",
    "file_creation_date": "2016-11-03T13:22:50Z",
    "file_modification_date": "2016-11-03T13:23:16Z",
    "file_size": 5273495,
    "plain_text": "# WHEN THE\n LIGHTS\n WENT OUT\n\n###### A COMPREHENSIVE REVIEW OF THE 2015 AT TACKS\n\n ON UKRAINIAN CRITICAL INFRASTRUC TURE\n\n\n-----\n\n### CONTENTS\n\n\n###### Executive Summary................................................................................................. 1\n\n Introduction............................................................................................................. 3\n\n A Regional Campaign.............................................................................................. 5\n\n Attack Walk Through...............................................................................................11\n\n Top 10 Takeaways: What to Consider When Protecting Your OT Environment..... 23\n\n Conclusion ............................................................................................................. 25\n\n Appendix A: Detailed Textual Description of Attack Walk Through......................29\n\n Appendix B: Malware Samples............................................................................... 38\n\n Appendix C: BlackEnergy Plugins........................................................................... 59\n\n Appendix D: Alternate Remote Access Trojans...................................................... 61\n\n Appendix E: Sources............................................................................................... 63\n\n\n-----\n\nOn December 23, 2015, unknown cyber actors\ndisrupted energy-grid operations for the first\ntime ever,[a] causing blackouts for over 225,000\ncustomers in Ukraine.[1] Among the most striking\nfeatures of this attack were the complexity of\norganization and planning, the discipline in\nexecution, and capability in many of the discrete\ntasks exhibited by the threat actors. Over the\ncourse of nearly a year prior to the attack, these\nunknown actors clandestinely established\npersistent access to multiple industrial networks,\nidentified targets, and ultimately carried out a\ncomplex set of actions, which not only disrupted\nelectricity distribution in Ukraine, but also\ndestroyed IT systems, flooded call centers, sowed\nconfusion, and inhibited incident response. The\nattackers used a malware tool, BlackEnergy 3,\ndesigned to enable unauthorized network access,\nthen used valid user credentials to move laterally\nacross internal systems, and ultimately shut\ndown electricity distribution using the utilities’\nnative control systems.\n\nThis report details the step-by-step process the\nactors took and seeks to highlight the opportuni­\nties for detection and prevention across the\nvarious steps of the attack. Combining opensource intelligence analysis of the attack and\nmalware analysis of the tools used by the threat\nactors in their operation, we break down the\nintegration of both human interaction and\nmalware-executed processes as components of\nthe December 2015 events.\n\n\n## EXECUTIVE SUMMARY\n\nThis Booz Allen report expands on previous\nincident analysis published in spring 2016, going\nbeyond by including additional detail about the\nattack chain based on malware execution, a more\ndetailed mapping of targeted and affected\ninfrastructure, and a much wider view on\nsimilar and potentially related Black Energy (BE)\ncampaigns against Ukrainian infrastructure.\nThis report provides a highly accessible and\nfactual account of the incident. By providing this\ncomprehensive view of the events, this report\nprovides operators, plant managers, chief\ninformation security officers, and key industrial\nsecurity decision makers a view of how an attack\ncould be conducted against their networks and\ninfrastructure, and—more importantly—some\nadvice on how to mitigate attacks such as these\nin the future.\n\nThis attack was exceptionally well organized and\nexecuted, but the tools necessary to mitigate and\nminimize the impact of an attack such as this are\nnot difficult to implement. By implementing a\nwell-designed defense-in-depth protection\nstrategy, industrial network and ICS/SCADA\ndefenders can effectively address the threats\nfacing their organizations. This report highlights\nthe important components this strategy ought\nto include, based on the methods used in the\nUkraine attack.\n\n\n_a._ _Despite early reporting indicating that disruptions in Brazil’s electrical grid in 2007 were the result of a cyberattack, further_\n_investigation ultimately attributed the blackouts to inadequate maintenance._\n\n\nwww.boozallen.com/ICS     1\n\n\n-----\n\n-----\n\nShortly before sunset on December 23, 2015,\nhackers remotely logged into workstations at a\npower distribution company in western Ukraine,\nclicked through commands in the operators control\nsystem interface, and opened breakers across the\nelectrical grid one by one. Before they were finished,\nthey struck two more energy distribution compa­\nnies, in rapid succession, plunging thousands of\nbusinesses and households into the cold and\ngrowing darkness for the next six hours.[2] These\nattacks were not isolated incidents, but the\nculmination of a yearlong campaign against a wide\nrange of Ukrainian critical infrastructure operations.\nIn addition to three energy distribution companies,\nPrykarpattyaoblenergo,[3] Kyivoblenergo, [4] and\nChernivtsioblenergo,[5] threat actors had also\npreviously targeted several other critical infrastruc­\nture sectors, including government, broadcast\nmedia, railway, and mining operators.\n\nThe attacks in Ukraine were a watershed moment\nfor cybersecurity; for the first time, malicious\ncyber threat actors had successfully and publicly\ndisrupted energy-grid operations, causing\nblackouts across multiple cities. The power\noutage was also one of the few known cyberattacks against a supervisory control and data\nacquisition (SCADA) system, a type of system\ncritical to automation in many sectors, including\ntransportation, manufacturing, heavy industry,\nand oil and gas.\n\nThis report details the actions threat actors took in\neach step of the attack, including an analysis of\nassociated malware and other identified indicators\nof compromise (IoC). This report also includes, as\nan appendix, detailed technical analysis of the\nassociated malware’s function and use. By tracing\nthis attack from early exploration and target\nidentification to turning the lights out on Ukrainian\ncities, this report serves as an aid to the security\nprofessionals charged with securing industrial\n\n\n## INTRODUCTION\n\ncontrol systems (ICS) and is equally relevant across\na range of other critical infrastructure sectors.\n\n\nBy understanding the current tactics, techniques,\nand procedures (TTP) that the threat actors used\nin this attack, and those that are most likely to be\nused against ICS systems in the future, security\nprofessionals can use this case study to plan for\nfuture threats against their own systems. Though\nthis attack targeted operators in the electricity\ndistribution sector, the TTPs illustrated in this\nattack are applicable to nearly all ICS sectors\nincluding oil and gas, manufacturing, and\ntransportation. A reconnaissance campaign\nagainst US ICS operators in 2011–2014 using the\nsame malware family deployed across Ukraine’s\ncritical infrastructure raises the urgency of\nunderstanding this disruptive Ukrainian attack.\n\n**ADDRESSING THE THREAT**\nIn a series of unique, discrete steps, the threat\nactors deployed malware; gained access to targeted\ncorporate networks; stole valid credentials; moved\ninto the operators’ control environment; identified\nspecific targets; and remotely disrupted the power\nsupply. Each task was a missed opportunity for\ndefenders to block, frustrate, or discover the\nattackers’ operations before they reached their\nfinal objectives.\n\nThe Ukraine incident also demonstrates that no\nsingle mitigation can prevent an attack’s success.\nThe attackers followed multiple avenues to\neventually overcome challenges and move onto\nthe attack sequence’s next components. The most\neffective strategy for repelling complex attacks,\ntherefore, is defense in depth. Layering defenses\ncan raise the adversary’s cost of conducting\nattacks, increase the likelihood of detection by a\nnetwork defender, and prevent a single point of\nfailure. All mitigation techniques, from\n\n\n###### INDUSTRIAL SECURITY THREAT BRIEFING\n\nThis attack on Ukraine’s electric grid\nis the most damaging of the increas­\ningly common attacks against ICS\nsystems. ICS operators reported\nmore security incidents in 2015 than\nin any other year. Complementing\nthe detailed, procedural analysis\nprovided in this report, Booz Allen’s\nIndustrial Security Threat Briefing\nprovides a broader perspective\non the cyber threat landscape\nICS operators face. The Industrial\nSecurity Threat Briefing includes\nan overview of the emerging tactics\nand active threat actors observed\nin 2015 and 2016, as well as the\nthreats most likely to affect ICS\noperators in the coming years.\nThe report is available at\n[http://www.boozallen.com/](http://www.boozallen.com/insights/2016/06/industrial-cybersecurity-threat-briefing/)\n[insights/2016/06/industrial-](http://www.boozallen.com/insights/2016/06/industrial-cybersecurity-threat-briefing/)\n[cybersecurity-threat-briefing.](http://www.boozallen.com/insights/2016/06/industrial-cybersecurity-threat-briefing/)\n\nwww.boozallen.com/ICS     3\n\n\n-----\n\nto identify related incidents, then analyze and\nintegrate their findings with this attack.\n\nAnalysis of public reporting was complemented\nwith a thorough technical analysis of recovered\nmalware samples used in the December 2015\nattacks against the electrical distributors, as well\nas samples from related attacks. Our technical\nanalysis was used to verify, corroborate, and expand\non existing reports detailing threat actor activity\nleading up to and during the incident. Experienced\nreverse engineers used disassembler and debugger\nsoftware to navigate through the malware code to\nidentify its capabilities and unique characteristics.\nReverse engineers used both static and dynamic\nanalysis, allowing them to see how the malware\nbehaves on a system with the freedom to run in\na debugger in order to force or bypass certain\nconditions, thereby allowing the malware to take\nmultiple paths. By recording system changes made\nby the malware, the reverse engineers were able to\ngather key data needed to identify further system\ninfections, as well as potential mitigations. This\ninvestigation also emphasized analyzing the\nrecovered samples within the context of their\nbroader malware family. Using YARA, a tool to\nidentify binary or textual signatures within malware,\nanalysts pivoted to new samples in an effort to\nidentify new capabilities and different variants of\nthe malware. This comprehensive report completes\nthe view of the attack sequence for this incident.\n\n\n###### Acknowledgments\n\nSeveral in-depth reports have been\nreleased, each covering a different\nfacet of the December 2015 attacks\nin Ukraine. The SANS Institute, in\npartnership with the Electricity\nInformation Sharing and Analysis\nCenter (E-ISAC),[6] as well as the US\nDepartment of Homeland Security’s\nNational Cybersecurity and Communi­\ncations Integration Center (NCCIC)[7],\nhave both produced detailed reports\ncovering the incident. Security\nresearchers at F-Secure[8] and ESET[9]\nhave conducted extensive analysis of\nthe BlackEnergy malware, and\nreporting produced by Cys-Centrum[10]\nand Trend Micro[11] have sought to lay\nout the common ties across the string\nof similar, and likely related, cyber\nattacks against Ukrainian critical\ninfrastructure. Each of these accounts\nprovides a different piece of the larger\npicture, which this report lays out.\n\n4 Booz Allen Hamilton\n\n\narchitectural segmentation and network moni­\ntoring, to access control and threat intelligence,\nshould be complementary efforts in a widereaching process and network defense strategy\nthat aims to protect the environment, making it\nso difficult, expensive, or time consuming that it\nultimately deters the attacker.\n\n**OUR RESEARCH METHODOLOGY**\nThough the attacks against Ukraine’s electrical\ngrid in December 2015 have been discussed widely\nin public reporting, this report seeks to build upon\nthe analysis to provide a more comprehensive\naccount. By analyzing the malware tools used in\nthe attack and using open-source intelligence\ngathering, this report seeks to tie together the\nwide body of existing information on this event\nand fill the gaps in other reports.\n\nThis report leverages an extensive analysis of publicly\nreported data on the attack, as well as our own\ndeep-dive technical analysis of recovered malware\nsamples used in the attack. Public reporting on the\nincident and related attack data was collected\nmanually or through automated searches on publicly\naccessible internet sites. The sources included, but\nwere not limited to, English and foreign language\nmedia, advisories and alerts from US and foreign\ngovernment cybersecurity organizations, and\nanalysis by independent security researchers.\nReferences to IoCs and other attack data were used\n\n\n-----\n\nOur research and analysis of the December 2015\nblackout showed that the attack against Ukraine’s\nelectricity grid was not an isolated incident, but in\nfact a continuation of a theme of a steady,\ndeliberate attacks against Ukraine’s critical\ninfrastructure. This long-running campaign likely\nreflects a significant, concerted effort by a single\nthreat actor with a well-organized capability and\ninterest in using cyberattacks to undermine\n\n\n## A REGIONAL CAMPAIGN\n\nUkraine’s socio-political fabric. Each of the attacks\nused a common set of TTPs that had been used in\nearlier incidents in the previous months, detailed\nin Exhibit 1. To put the December 2015 attack in\ncontext, our research uncovered an additional 10\nrelated attacks, the last of which occurred in\nJanuary 2016. Exhibit 1 shows the timing, tech­\nniques and target sectors in this 18-month\ncampaign.\n\n\nwww.boozallen.com/ICS     5\n\n\n-----\n\n###### EXHIBIT 1. CYBER THREAT LANDSCAPE IN UKRAINE\n\n\n##### Electricity Sector\n\n Railway Sector\n\n|1|Col2|\n|---|---|\n\n|4|Col2|\n|---|---|\n\n|2|Col2|\n|---|---|\n\n\n##### Television Sector\n\n Mining Sector\n\n|5|Col2|\n|---|---|\n\n|Col1|7|\n|---|---|\n\n\n##### Regional Government/ Public\n 3 6\n Archives\n\n Attack Tools\n 1 2 3 4 5 6 7 8 9 10\n\n Phishing MS Office Malicious VBA Other Weaponization BlackEnergy Other RAT KillDisk\n\n Gained Access Data Destruction Physical Impact Undisclosed\n\n|Col1|3|\n|---|---|\n\n|6|Col2|\n|---|---|\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|November December|Col21|January|Col23|Col24|Col25|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|||||||||||4|||||||||1|0|1|1|||\n||||||||||||||||||||8||||||\n|||||||||||5||||||||7|||||||\n||||||||||||||||||||9||||||\n||||||||||||||||||||||||||\n\n\n6 Booz Allen Hamilton\n\n\n-----\n\n1. May 2014 (Electricity) On May 12, 2014, threat\nactors targeted Ukrainian electricity distributor\nPrykarpattyaoblenergo in a phishing campaign using\nweaponized Microsoft (MS) Word documents.[12]\nThe threat actors forged the sender addresses and\nmodified the weaponized MS Word attachments\nwith a malicious PE-executable file inserted into the\nicon image associated with file.[13]\n2. May 2014 (Railway) On May 12, 2014, threat actors\n\ntargeted all six of Ukraine’s state railway transporta­\ntion system operators in a phishing campaign using\nweaponized MS Word documents.[14] The threat\nactors forged the sender addresses and modified\nthe weaponized MS Word attachments with a\nmalicious PE-executable file inserted into the icon\nimage associated with file.[15]\n\n3. August 2014 (Ukrainian Regional Government,\n\nArchives) In August 2014, threat actors began a\nwide-reaching phishing campaign using weaponized\nMS Power Point files. The weaponized files exploited\na zero-day vulnerability (CVE-2014-4114) to deliver\nBlackEnergy Malware to targeted systems.[16,17]\nTargets included five Ukrainian regional govern­\nments, and the state archive of Chernivtsi Oblast,\none of the three oblasts targeted in the December\n2015 Electricity distributor attacks.[18,19]\n\n4. March 2015 (Media) In early March 2015, threat\n\nactors conducted a phishing campaign against\nUkrainian television broadcasters, using weaponized\nMS Excel and MS PowerPoint documents\n(Додаток1.xls and Додаток2.pps).[20] The weapon­\nized documents contained malicious Visual Basic\nApplication (VBA) and JAR files designed to drop\nBlackEnergy malware on targeted systems.[21]\n5. March 2015 (Electricity) In late March 2015, threat\n\nactors conducted a phishing campaign targeting\nelectricity operators in western Ukraine using the\nweaponized MS Excel file (Додаток1.xls) used earlier\nthat month against broadcast media targets. As with\nthe earlier attack, the file included a malicious macro\ndesigned to install BlackEnergy.[22]\n\n6. March 2015 (State Archives) Also in late March\n\n2015, threat actors targeted Ukrainian state archives\nin phishing attacks using the same weaponized MS\nExcel file (Додаток1.xls), malicious macro, and\nBlackEnergy malware.[23]\n\n\n7. October 2015 (Television Broadcast) On October 24\n\nand October 25, 2015, Ukrainian election day, threat\nactors used KillDisk malware to destroy video data\nand server hardware, and render employee\nworkstations inoperable at multiple Ukrainian\ntelevision broadcasters.[24,25] Targeted systems were\nfound to be infected with the same BlackEnergy and\nKillDisk samples observed in attacks against a railway\n\noperator, mining company, and electricity distributors\nin November and December 2015. Investigation of\nthe incident indicated access to the network was\nestablished May 2015.[26]\n\n8. November–December (Railway) In November–\n\nDecember 2015, an undisclosed Ukrainian Railway\nfirm, operating under the Ukrainian State\nAdministration of Railway Transport, was targeted in\na cyberattack using BlackEnergy and KillDisk\nmalware.[27] The method for establishing initial access\nto targeted networks was not disclosed.\n9. November–December 2015 (Mining) In\n\nNovember–December 2015, an undisclosed\nUkrainian Mining firm was targeted in a cyberattack\nusing BlackEnergy and KillDisk malware.[28] The\nmethod for establishing initial access to targeted\nnetworks was not disclosed.\n10. December 2015 (Electricity) On December 23, 2015,\n\nthreat actors opened breakers and disrupted\nelectricity distribution at three Ukrainian firms:\nPrykarpattyaoblenergo, Kyivoblenergo, and\nChernivtsioblenergo. Full details of this attack are\nincluded in the Attack Walk Through section of\nthis report.\n11. January 2016 (Electricity) On January 19 and 20,\n\n2016, threat actors targeted approximately 100\norganizations, including many Ukrainian energy\nfirms,[29] in a phishing campaign.[30] The malicious\nemails were designed to look as though they were\nsent by Ukrainian energy distributor NEC Ukrenergo.[31]\nThe emails included a weaponized MS Excel\ndocument, which prompted users to enable macros;\nonce enabled, a malicious VBA script installed GCat,\nan open-source, python-based trojan which disguises\ncommunications with the command-and-control\n(CC) server as Gmail email traffic.[32]\n\n\n###### BLACKENERGY MALWARE\n\nBlackEnergy is a remote-access trojan\ndesigned to provide unauthorized\naccess to targeted networks via an\nHTTP connection with an external\nserver. Its modular design allows it\nto accept additional plugins to carry\nout specific functions, such as\nstealing credentials or conducting\nnetwork reconnaissance.\n\nwww.boozallen.com/ICS     7\n\n\n-----\n\n**ATTRIBUTION**\nThough the Security Service of Ukraine (SBU)\nimmediately implicated Russia in the attack,[33]\nthere is no smoking gun which irrefutably\nconnects the December 2015 attacks in Ukraine to\na specific threat actor. The limited technical\nattribution data, such as the attackers using a\nRussia-based Internet provider and launching the\ntelephony denial-of-service (TDoS) flood traffic\nfrom inside Russia,[34] point to Russian threat\nactors, though this evidence is not conclusive unto\nitself. Some inferences can be made based on the\nhistory of the tools used, how the attack was\ncarried out, and the outcomes that were achieved.\n\nCybercriminal organizations and state-backed\ngroups are often the most wellresourced, organized, and technically advanced\ncyber threat actors. BlackEnergy first emerged as a\nDDoS tool in 2007[35] and has a history of use by\ncriminal organizations. The most notable criminal\noperation was a series of attacks in 2011 against\nRussian and Ukrainian banks, in which criminals\nused BlackEnergy 2 to steal online credentials and\nobfuscate the attacks with distributed deni­\nal-of-service (DDoS) floods.[36]\n\nDespite these criminal roots, BlackEnergy often\nrears its head in attacks with particular political\nsignificance, typically targeting organizations and\ncountries with adversarial relations with Russia. In\n2008, during Russia’s conflict with Georgia,\nGeorgian networks were bombarded with a DDoS\nattack by a botnet constructed with the first\niteration of BlackEnergy, and controlled by CC\n\n\nservers hosted on Russian state-owned compa­\nnies.[37,38] BlackEnergy was also used in June 2014,\ntargeting a French telecommunications firm, by a\ngroup known to conduct cyberattacks against\nNATO, Western European governments, and\nseveral regional Ukrainian governments.[39,40,b] In\naddition, the KillDisk malware, used in conjunction\nwith BlackEnergy, was first observed in a data\ndestruction attack against servers operated by\nseveral Ukrainian news outlets on October 24–25,\n2015, Ukraine’s election day.[41]\n\nAs security researchers have pointed out, the\noverlap in usage of the malware by multiple\ngroups, including criminal organizations, would be\nconvenient for a state-backed group as this\nprovides a degree of plausible deniability.[42] As\nnoted above though, the targets selected in\nprevious campaigns using BlackEnergy often align\nto Russian political interests. Furthermore, the\nactivity associated with the December 2015 attack\ndoes not appear to align to a criminal organiza­\ntion’s likely goal of financial gain. Threat actors\ninvested significant resources in establishing,\nmaintaining, and expanding persistent access on\ntargeted networks for nearly a year. They\nconducted extensive network reconnaissance,\nlikely developed malicious firmware, familiarized\nthemselves with the native control environment,\nand then ultimately revealed their presence in a\ndestructive attack. The extensive resources\ninvested, and no apparent financial return, indicate\nthe attackers’ likely objective was to use the attack\nto send a message.\n\n\n_b._ _Reporting did not specify whether if used BlackEnergy malware was used in the attacks against NATO or other European govern­_\n_ment targets._\n8 Booz Allen Hamilton\n\n\n-----\n\n**INTENT**\nSeveral plausible theories that have been\nproposed may explain the threat actor’s motiva­\ntions for conducting the attacks, as well as its\ntiming, target, and impact. It is possible that the\nadversary was motivated by several of the posited\ntheories, though the attack was probably designed\nto send a message to the Ukrainian government,\nrather than gain a lasting benefit.\n\n**CONVEY DISPLEASURE WITH**\n**PLANS TO NATIONALIZE**\n**RUSSIAN-OWNED ASSETS**\nOne theory that has circulated in cybersecurity\ncircles is that the attackers may have intended to\nconvey displeasure with a Ukrainian proposal[43,44]\nto nationalize assets owned by Russia and its\ncitizens.[45] The policy would have harmed\ninfluential Russian oligarchs with investments in\nUkraine’s energy sector. For example, Alexander\nBabakov—a senior member of Russia’s national\nlegislature and a current target of EU sanc­\ntions[46]—is a main shareholder in VS Energy. It is\none of the largest electricity distributors in the\nUkrainian market, with ownership stakes in nine\nof the 27 oblenergos and a 19-percent electricitydistribution market share, as of 2010.[47]\n\nBased on available evidence, however, we find the\ntheory unconvincing. The timing of the attack and\nthe particular target made it an unlikely symbolic\ntarget for expressing a position on nationalization.\nDiscussions about nationalizing Russian assets\nhad not been a headline issue since the spring of\n2015, more than six months before the disruption;\nthe lack of temporal proximity between the two\nevents blurred or watered down the symbolic\nvalue of the attack vis-à-vis nationalization.\n\n\n**POLITICAL DESTABILIZATION; CULTIVATE**\n**GENERAL FEAR AND DISCONTENT**\nAnother possible objective was to destabilize\nUkraine politically. As indicated above, a wide\nswath of Ukrainian organizations were caught in\nthe attacker’s larger collection of networks\ncompromised with BlackEnergy, including targets\nin the railway, mining, broadcast media and\ngovernment sectors.[48] This trend indicates the\nobjective may have been to disrupt a critical\nservice provider or critical industry, rather than an\nenergy company specifically. By disrupting\noperations in critical infrastructure, the threat\nactors may have sought to reduce confidence in\nthe Ukrainian government. This strategy would be\nconsistent with Russia’s information warfare\ndoctrine, which seeks to sow discontent in a target\ncountry or region in order to induce political and\neconomic collapse.[49]\n\n\nboozallen.com/ics     9\n\n\n-----\n\n**IN-KIND RETALIATION**\nAnother possible objective may have been in-kind\nretaliation for perceived Ukrainian disruptions of\nelectricity to Crimea. On November 21–22, 2015,\nCrimea lost power for more than six hours due to\nphysical attacks on four pylons carrying transmis­\nsion wires.[50] The identity of the saboteurs has not\nbeen publicly determined, but they are rumored to\nbe Ukrainian nationalists.[51] Crimea is reliant on\nUkraine, as the country supplies about 70 percent\nof Crimea’s power.[52] Russia intends to obviate this\nrisky reliance by constructing a new energy bridge\nbetween Crimea and Russia, which will be able to\nsupply 70–80 percent of Crimea’s power needs.[53]\nIf this was the objective in the attack, it would\nindicate that Russia may actively seek to gain\nfootholds in critical services providers with the\nintention to execute attacks at strategically useful\ntimes. This would be consistent with similar\nattacks against critical infrastructure in other\nadversarial nations in Western Europe[54] and the\nUS[55] that have been attributed to Russia.\n\n\n**OUTLOOK**\nWhile politically motivated cyberattacks are not a\nnovel foreign policy tool, the industries and\norganizations that serve as potential targets are\nexpanding. Cyberattacks present a powerful\npolitical tool, particularly those against critical\ninfrastructure providers. Industrial control\nsystems operators are not above the fray in\ngeopolitical rows, and may in fact be the new\nprimary target.\n\n\n10 Booz Allen Hamilton\n\n\n-----\n\nThe attack walk through provided in this report is\ninformed by analytical frameworks published by\ncybersecurity industry organizations,[56,57] as well\nas proprietary methods for conducting opensource intelligence analysis and technical\nmalware analysis. To provide as complete a\npicture as possible for this report, as with other\nreporting on this incident, some inferences on\nthe threat actors’ most likely method were\nrequired, as there does not exist a complete\naccounting of all actions the threat actors took in\ntheir campaign. Wherever possible, inferences\nwere based on confirmed technical evidence,\nsuch as identified malware capabilities and\nknown hardware and software vulnerabilities.\n\nThis section provides the step-by-step walk\nthrough of threat actor activity during the attack.\nEach step includes a high-level description, as well\nas a feature summary of the step with eight\ndescriptors. The eight descriptors are as follows:\n\nLocation: This describes the network on which the\nactivity occurred, including preparatory activity\nconducted outside of the targeted networks (listed\nas “external infrastructure”), as well as the logically\nor physically separated “corporate network” or “ICS\nnetwork” operated by the electricity distributors.\n\nAction: The December 2015 attacks were achieved\nusing a combination of direct threat actor manipu­\nlation of systems deployed by the electricity\ndistributors, as well as malware-executed tasks.\n“Active threat actor activity” highlights tasks that\ninvolved hands-on-keyboard interactions with\nsystems deployed on the electricity distributor\nnetwork. “Malware execution” highlights tasks\ncompleted by functions built into the malware tools\nused by threat actors.[c]\n\n\n## AT TACK WALK THROUGH\n\nTimeline: This section provides the timeframe in\nwhich the step most likely occurred. This includes\nspecific, known dates, as well as ranges of time\ndefined by known threat actor activities.\n\nDevice/application: This section lists the device or\napplication targeted or exploited by threat actors in\nthe step. Wherever possible, specific model\ninformation is provided; in instances in which the\nmodel or application details were not found in open\nsources, analysts made assessments based on\navailable evidence, such as operating system (OS)\nor application-specific services targeted by the\nreported malware. For the steps detailing prepara­\ntory tasks conducted external to the electricity\ndistributors’ networks, “activity conducted external\nto network” is listed rather than the targeted device\nor application.\n\nRole in infrastructure: This section details the\nfunction of the targeted device or application\nwithin the electricity distributors’ network.\n“Activity conducted external to network” is\nlisted for preparatory activities conducted on\nexternal infrastructure.\n\nExploitation method: This section includes a\nsummary of the method used by threat actors to\ncomplete the step.\n\nImpact: This section includes a brief summary of\nthe capability achieved by threat actors, or any\ndisruption or destruction of systems operated by\nthe targeted operator, upon completion of the step.\n\nBooz Allen’s recommended mitigations: This\nsection provides the technical or procedural\nsecurity measures that would help prevent or limit\nthe impact of the activities associated with the step.\n\n\n_c._ _One step required employees to actively grant permissions that enabled the malware to execute. Another step manipulated a_\n_task scheduling service available on the targeted network._\n\n\nboozallen.com/ics     11\n\n\n-----\n\n###### EXHIBIT 2. WALK THROUGH OF THREAT ACTOR ACTIVITY, STEPS 1 THROUGH 9\n\n External 1 Corporate Network Infrastructure\n Data Center\n Network UPS Share\n Workstation Workstation\n Attack Package 2 4\n\nBlackEnergy 7\nRAT\n\n3 6\n\nMalware Plugin 5 UPS TelephoneServer\n\nPhishing Email, 8\nWeaponized File\n\n###### Domain VPN Server Controller or Gateway Server Call Center\n\n CC Servers\n\n ICS Network\n\n Control Center\n HMI Workstation\n\n DMS\n Valid 9 Server Credential VPN Server\n or Gateway\n DMS Client Application\n\n Networked Substation\n\n RTU RTU RTU\n\n Converters Converters Converters\n\n Breakers Breakers Breakers\n\n_d._ _In this step, the threat actors are not passing through the Domain Controller server in their lateral movements across_\n_the network, as they would, for example, a VPN gateway. In accessing the Domain Controller they are retrieving,_\n_or making, valid user credentials to enable expansive access across the corporate network and pivoting into the ICS_\n_network. The actual movement and network exploration would follow this compromise, would be conducted using the_\n_stolen credentials, and would occur on many machines across the network._\n\n12 Booz Allen Hamilton\n\n\n###### Steps 1–9\n\nStep 1: Reconnaissance and Intelligence\nGathering. Prior to the attack, threat actors likely\nbegin open-source intelligence gathering and\nreconnaissance on potential targets.\nStep 2: Malware Development and\nWeaponization. Threat actors acquire or\nindependently develop the malware to be used in the\nattack, as well as the weaponized documents to deliver\nthe malicious files.\nStep 3: Deliver Remote Access Trojan\n(RAT). Threat actors initiate phishing campaign\nagainst electricity distributors.\nStep 4: Install RAT. Threat actors successfully\ninstall BlackEnergy 3 on each of the three targeted\nelectricity distributors after employees open the\nweaponized MS Office email attachments and enable\nmacros.\nStep 5: Establish Command-and-Control\n(CC) Connection. Malware establishes\nconnection from malicious implant on targeted\nnetwork to attacker-controlled command-and-control\n(CC) server.\nStep 6: Deliver Malware Plugins\nFollowing installation of BlackEnergy 3 implant, threat\nactors likely import plugins to enable credential\nharvesting and internal network reconnaissance.\nStep 7: Harvest Credentials. Delivered BE3\nmalware plugins conduct credential harvesting and\nnetwork discovery functions.\nStep 8: Lateral Movement and Target\nIdentification on Corporate Network. Threat\nactors conduct internal reconnaissance on corporate\nnetwork to discover potential targets and expand\naccess.[d]\nStep 9: Lateral Movement and Target\nIdentification on ICS network. Threat actors\nuse stolen credentials to access the control\nenvironment and conduct reconnaissance on deployed\nsystems.\n\n|DMS 9 Server DMS Client Application|Col2|Col3|\n|---|---|---|\n||||\n\n\n-----\n\nIn addition to the high-level summary of each step\nprovided in this section, each step has a corre­\nsponding textual summary provided in Appendix A.\nThis textual summary provides the detailed\noverview of the evidence relating to each step,\nincluding citations for all referenced material and\nexplanations of analyst assessments.\n\n**RECONNAISSANCE**\n\n###### STEP 1: RECONNAISSANCE AND INTELLIGENCE GATHERING\nPrior to the attack, threat actors likely begin\nopen-source intelligence gathering and reconnais­\nsance on potential targets.\n\nLocation: External infrastructure\n\nAction: Active threat actor activity\n\nTimeline: May 2014 or earlier\n\nDevice/application: Activity conducted external\nto network\n\nRole in infrastructure: Activity conducted external\nto network\n\nExploitation method: Threat actors likely gather\npublicly available information on deployed\nsystems and network architecture, and may also\nuse active discovery methods such as scanning\nof perimeter devices.\n\nImpact: Threat actors gather targeting data on\npersonnel and network infrastructure for use in\nfuture attacks.\n\nBooz Allen’s recommended mitigations:\n\n- Implement information classification program\n\nto categorize critical system information that\ncould be used by a threat actor. Sensitive\ninformation such as this should have restricted\ndistribution and not be publicly available.\n\n- Utilize open-source intelligence gathering to\n\nidentify publicly accessible information on the\norganization or personnel that could be used\nby threat actors in social engineering attacks.\n\n\n\n- Utilize open-source tools, such as Shodan, to\n\nmonitor your organization’s external IP address\nrange for unexpected Internet-facing devices.\nPay special attention to identified devices with\ncommon ICS ports, such as Modbus (502) or\nEtherNet/IP (44818).\n\n- Maintain a detailed inventory of all assets and\n\ncommunication paths to develop an under­\nstanding of potential external attack vectors.\nAsset inventories should cover both equipment\nand applications, and should include such\ndetails as MAC ID, IP address, and firmware\nversion, to prevent rogue network connections\nor modifications to network devices.\n\n- Actively monitor perimeter network security\n\ndevices to identify active reconnaissance\ntechniques, such as port scanning.\n\n**WEAPONIZATION**\n\n###### STEP 2: MALWARE DEVELOPMENT\n AND WEAPONIZATION\nThreat actors acquire or independently develop\nthe malware to be used in the attack, as well as\nthe weaponized documents to deliver the\nmalicious files.\n\nLocation: External infrastructure\n\nAction: Active threat actor activity\n\nTimeline: May 2014 or earlier\n\nDevice/application: Activity conducted external\nto network\n\nRole in infrastructure: Activity conducted external\nto network\n\nExploitation method: Threat actors acquire\nBlackEnergy remote access trojan (RAT), and\nweaponize Microsoft (MS) Word and Excel files\nwith VBA scripts to drop the BlackEnergy RAT.\n\nImpact: Combined with targeting data gathered\nduring the reconnaissance phase, threat actors are\nable to develop tailored attack packages. At the\ncompletion of this step, threat actors have all the\nnecessary tools to begin their attack.\n\n\nboozallen.com/ics     13\n\n\n-----\n\nBooz Allen’s recommended mitigation:\n\n- Implement application whitelisting to prevent\n\nunknown files from being executed and apply\nsandboxing to non-critical applications in order\nto reduce unintended modifications.\n\n**DELIVERY**\n\n###### STEP 3: DELIVER RAT\nThreat actors initiate phishing campaign against\nelectricity distributors.\n\nLocation: Corporate network\n\nAction: Active threat actor activity\n\nTimeline: May 2014–June 2015[e]\n\nDevice/application: Employee workstations, likely\nusing MS Windows OS and provisioned with MS\nInternet Explorer web browser\n\nRole in infrastructure: Support email communica­\ntions and other IT services used in business\noperations.\n\nExploitation method: Threat actors send innocu­\nous-looking emails containing the\nmodified MS Office files as attachments to\nusers on targeted networks. This tactic is\nknown as phishing.\n\nImpact: RAT is delivered to targeted network, but\nnot installed. Installation requires employees to\nactively grant permission to the embedded VBA\nscripts to execute.\n\nBooz Allen’s recommended mitigations:\n\n- Implement a position-specific cyber\nsecurity awareness training program to ensure\nemployees understand the organizational risks\nassociated with cyberattacks and how to\nidentify social engineering techniques such\nas phishing.\n\n- Establish a Computer Incident Response Team\n\n(CIRT) and ensure all employees are aware that\nsuspicious emails or attachments should be\nforwarded here for investigation. The CIRT\n\n\nshould review any reports, perform malware\nanalysis, and extract an indicator of compro­\nmise (IOC) to identify any infections on the\norganization’s network.\n\n- Use a network-based antivirus solution to\n\ndetect and prevent known malware from\nentering the organization’s network.\n\n- Install and configure an anti-spam solution to\n\nscreen incoming emails for suspicious content\nor abnormal senders.\n\n- Subscribe to and monitor threat intelligence\n\nsources to be aware of ongoing campaigns.\nThis information can be used to focus defense\nefforts and search for IOCs.\n\n**EXPLOITATION AND INSTALLATION**\n\n###### STEP 4: INSTALL RAT\nThreat actors successfully install BlackEnergy 3 on\neach of the three targeted electricity distributors\nafter employees open the weaponized MS Office\nemail attachments and enable macros.\n\nLocation: Corporate network\n\nAction: Employee-enabled malware execution\n\nTimeline: May 2014–June 2015\n\nDevice/application: Employee workstations, likely\nusing MS Windows OS and provisioned with MS\nInternet Explorer web browser\n\nRole in infrastructure: Support email communica­\ntions and other services used in business\noperations.\n\nExploitation method: In a social engineering\nattack, employees are prompted to enable\nmacros when opening the file attached to\nphishing email. Once macros are enabled, the\nVBA script places multiple malicious files on\nthe workstation, unbeknown to the employee.\n\nImpact: Files placed on workstations within the\ncorporate network can begin the communication\nprocess with external CC servers.\n\n\n_e._ _Ukrainian Deputy Energy Minister noted access was gained at least six months prior to the final attack. Earliest observed_\n_phishing attack matching TTP against electricity distributor was May 2014._\n14 Booz Allen Hamilton\n\n\n-----\n\nBooz Allen’s recommended mitigations:\n\n- Implement application whitelisting to prevent\n\nunknown files from being executed.\n\n- Use host-based antivirus software to detect\n\nand prevent known malware from infecting\norganization systems.\n\n- Set script execution policy to allow only signed\n\nVBA scripts and macros to be run.\n\n**COMMAND AND CONTROL**\n\n###### STEP 5: ESTABLISH CC CONNECTION\nMalware establishes connection from malicious\nimplant on targeted network to attacker-controlled\nCC server.\n\nLocation: Corporate network\n\nAction: Malware execution\n\nTimeline: May 2014–June 2015\n\nDevice/application: Employee workstations, likely\nusing MS Windows OS and provisioned with MS\nInternet Explorer web browser\n\nRole in infrastructure: Support email communica­\ntions and other services used in business\noperations.\n\nExploitation method: The external connection\nis established as part of the execution routine\nfollowing installation of the malicious files.\nOnce permissions to execute macros are granted\nby employees, the malicious VBA script installs\nthe malware implant, and the implant attempts\nto communicate with an external server via\nHTTP requests.\n\nImpact: Threat actors gain unauthorized access to\ntargeted networks, including the ability to deliver\nadditional BlackEnergy plugins to enable internal\nnetwork reconnaissance and credential harvesting.\n\n\nBooz Allen’s recommended mitigations:\n\n- Configure firewall ingress and egress traffic\n\nfiltering to block anomalous incoming and\noutgoing network communications.\n\n- Blacklist known malicious IP addresses and\n\nmonitor for any form of network communica­\ntions to these addresses.\n\n**ACTION ON OBJECTIVES:**\n**INTERNAL RECONNAISSANCE AND**\n**LATERAL MOVEMENT**\n\n###### STEP 6: DELIVER MALWARE PLUGINS\nFollowing installation of BlackEnergy 3 implant,\nthreat actors likely import plugins to enable\ncredential harvesting and internal network\nreconnaissance.\n\nLocation: Corporate network\n\nAction: Active threat actor activity\n\nTimeline: June 2015–December 2015\n\nDevice/application: Employee workstations,\nlikely using MS Windows OS and provisioned\nwith MS Internet Explorer web browser\n\nRole in infrastructure: Support email\ncommunications and other services used\nin business operations\n\nExploitation method: The BlackEnergy 3 implant\ndelivered in the initial attack functions as a\nreceiver for additional malware plugins. After\nestablishing a remote connection with delivered\nfiles via HTTPS, the threat likely delivers the\nadditional malware components.\n\nImpact: The delivered plugins enable additional\nBlackEnergy functionality, including harvesting\nuser credentials, keylogging, and network\nreconnaissance.\n\n\nboozallen.com/ics     15\n\n\n-----\n\nBooz Allen’s recommended mitigations:\n\n- Implement application whitelisting to prevent\n\nunknown files from being executed.\n\n- Configure firewall ingress and egress traffic\n\nfiltering to block anomalous incoming and\noutgoing network communications.\n\n- Blacklist known malicious IP addresses and\n\nmonitor for any form of network communica­\ntions to these addresses.\n\n- Use host-based antivirus software to detect\n\nand prevent known malware from infecting\norganization systems.\n\n###### STEP 7: HARVEST CREDENTIALS\nDelivered BlackEnergy 3 malware plugins conduct\ncredential harvesting and network discovery\nfunctions.\n\nLocation: Corporate network\n\nAction: Active threat actor activity, malware\nexecution\n\nTimeline: June 2015–December 2015\n\nDevice/application: Windows OS workstations,\nWindows domain controllers, virtual private\nnetwork (VPN) service deployed in control\nenvironment\n\nRole in infrastructure: These systems support\nbusiness operations, manage permissions and\ndomain access, and provide remote network\naccess respectively.\n\nExploitation method: Threat actors use delivered\nBlackEnergy 3 plugins to gather stored credentials\nor log keystrokes. After gathering valid credentials\nfor user with administrator privileges, threat actors\nuse the stolen administrator credentials to access\nthe domain controller, recover additional creden­\ntials, and create new privileged accounts.\n\nImpact: Threat actors obtain valid credentials\nenabling them to expand access across the\ncorporate network and into the control environment,\nensure persistent access, and blend into regular\nnetwork traffic.\n\n\nBooz Allen’s recommended mitigations:\n\n- Implement centralized logging and monitor\n\naudit logs for unusual logins or use of adminis­\ntrative privileges (e.g., abnormal hours,\nunsuccessful login attempts).\n\n- Establish a baseline of user domain and local\n\naccounts and monitor for any account\nadditions or privilege escalations outside of the\norganization’s approved workflow.\n\n- Implement least privilege policies across all\n\nsystems to ensure administrative accounts are\nproperly restricted and assigned to only those\nwho require them.\n\n###### STEP 8: LATERAL MOVEMENT\n AND TARGET IDENTIFICATION ON CORPORATE NETWORK\nThreat actors conduct internal reconnaissance on\nthe corporate network to discover potential targets\nand expand access.\n\nLocation: Corporate network\n\nAction: Active threat actor activity, malware\nexecution\n\nTimeline: June 2015–December 2015\n\nDevice/application: Discovered systems, including\nnetworked uninterruptable power\nsupply (UPS) devices, data center servers,\na telephone communications server, and\nemployee workstations\n\nRole in infrastructure: Internal reconnaissance\nefforts could potentially include all deployed\ndevices on the corporate network.\n\nExploitation method: Threat actors likely use a\ncombination of valid user credentials and\nBlackEnergy 3 plugins developed to conduct\nnetwork discovery. VS.dll plugin is likely used to\nleverage MS Sysinternals PsExec to establish\nremote connections to workstations and servers.\n\nImpact: Threat actors are able to enumerate the\nsystems deployed across the network, identify\ntargets, and begin preparations for final attack.\n\n\n16 Booz Allen Hamilton\n\n\n-----\n\nBooz Allen’s recommended mitigations:\n\n- Implement active network security monitoring\n\nto identify anomalous network behavior.\n\n- Ensure network is appropriately segregated to\n\ninhibit lateral movement.\n\n- Monitor audit logs for unusual logins or use of\n\nadministrative privileges (e.g., abnormal hours,\nunsuccessful login attempts).\n\n- Establish production honeypots spread\n\nthroughout the network to alert on any\nattempts to login or access files. These\nhoneypot systems have no intentional purpose,\nand any attempt to access them is a notable\nsecurity alert.\n\n###### STEP 9: LATERAL MOVEMENT\n AND TARGET IDENTIFICATION ON\n ICS NETWORK\nThreat actors use stolen credentials to access the\ncontrol environment and conduct reconnaissance\non deployed systems.\n\nLocation: ICS network\n\nAction: Active threat actor activity\n\nTimeline: June 2015–December 2015\n\nDevice/application: Discovered systems, including\nhuman machine interface (HMI) workstations,\ndistributed management system (DMS) servers,\nUPS devices,[58] serial-to-Ethernet converters (Moxa\nUC 7408-LX-Plus,[59] IRZRUH2 3G[60]), remote\nterminal unit (RTU) devices (ABB RTU560\nCMU-02), and the substation breakers\n\nRole in infrastructure: HMI workstations provide\na graphical user interface for operators to remotely\nmonitor and control devices within the control\nenvironment. DMS applications enable centralized\nmonitoring and issuing of commands within a\ncontrol environment. UPS devices condition\nincoming power to downstream devices and\nprovide temporary battery backup power.\nSerial-to-Ethernet converters convert serial data\nfrom field devices to digital packets, enabling\n\n\ncommunications with the control center. RTU\ndevices function as a communication processor or\na data concentrator in a substation, enabling\ncommunications and data transfer between field\ndevices in the substations and the control center.\nSubstation breakers are devices designed to\nphysically interrupt current flows through an\nelectrical circuit.\n\nExploitation method: Threat actors use valid\ncredentials to interact directly with the client\napplication for the DMS server via a VPN, and\nnative remote access services to access employee\nworkstations hosting HMI applications. This\naccess likely enables threat actors to enumerate all\nnetworked devices within the control environment.\n\nImpact: Threat actors gain access to critical\nsystems, enabling them to begin target selection\nand preparations for final attack.\n\nBooz Allen’s recommended mitigations:\n\n- Install and configure a stateful firewall or data\n\ndiode device between the corporate network\nand ICS network.\n\n- Configure an ICS network demilitarized zone\n\n(DMZ) and prohibit any direct traffic between\nthe corporate and ICS networks. All traffic\nbetween these domains should be heavily\ncontrolled through the use of proxies and be\nactively monitored.\n\n- Any access to systems within the control\n\nsystem DMZ should require the use of\ntwo-factor authentication.\n\n- Implement network segregation of control\n\nsystem components within the ICS network\nusing zone and conduit techniques. Use\nindustrial firewalls between these network\nsegments whereby only specified traffic can\nenter and exit. All traffic outside of what is\nexplicitly allowed should trigger an alert.\n\n- Take advantage of the predictability in control\n\nsystem traffic by establishing a baseline of\nnormal ICS network communications and\nconduct active monitoring for anomalies.\n\n\nboozallen.com/ics     17\n\n\n-----\n\nEXHIBIT 3. WALK THROUGH OF THREAT ACTOR ACTIVITY, STEPS 10 THROUGH 17\n\nExternal 10 Corporate Network\nInfrastructure\n\nData Center\n\nNetwork\nShare 16\n\nWorkstation Workstation\n\nAttack Package\n\nMalicious\nFirmware 11 12\n\nKillDisk Telephone\n\nDomain Server\n\nUPS Controller 16\nDisruption VPN Server Server Automated\n\nor Gateway 17\n\nTDoS\nSystem\n\nCall Center\n\n15\n\nValid\nCredential\n\nCC Servers\n\nICS Network\n\nControl Center\n\nHMI Workstation\n\nDMS\n\nValid Server\nCredential VPN Server\n\nor Gateway\n\nDMS Client\nApplication\n\nNetworked\nSubstation\n\n17\n\nRTU RTU RTU\n\n14\n\nConverters Converters Converters\n\n13\n\nBreakers Breakers Breakers\n\n18 Booz Allen Hamilton\n\n\n###### Steps 10–17\n\nStep 10: Develop Malicious Firmware. Threat\nactors develop malicious firmware update for identified\nserial-to-Ethernet converters.\nStep 11: Deliver Data Destruction Malware.\nThreat actors likely deliver KillDisk malware to\nnetwork share and set policy on domain controller to\nretrieve malware and execute upon system reboot.\nStep 12: Schedule Uninterruptable Power\nSupply (UPS) Disruption. Threat actors\nschedule unauthorized outage of UPS for telephone\ncommunication server and data center servers.\nStep 13: Trip Breakers. Threat actors use native\nremote access services and valid credentials to open\nbreakers and disrupt power distribution to over\n225,000 customers within three distribution areas.\nStep 14: Sever Connection to Field\nDevices. After opening the breakers, threat actors\ndeliver malicious firmware update to serial-to-Ethernet\ncommunications devices. The malicious updates\nrender the converters inoperable, and sever\nconnections between the control center and the\nsubstations.\nStep 15: Telephony Denial-of-Service\nAttack. Threat actors initiate DoS attack on\ntelephone call center at one of the targeted\ndistributors.\nStep 16: Disable Critical Systems via UPS\nOutage. Previously scheduled UPS outage cuts power\nto targeted telephone communications server and data\ncenter servers.\nStep 17: Destroy Critical System Data.\nScheduled execution of KillDisk malware erases the\nmaster boot records and deletes system log data on\ntargeted machines across the victims’ corporate and\nICS network.\n\n\n-----\n\n**ACTION ON OBJECTIVES:**\n**ATTACK PREPARATION**\n\n###### STEP 10: DEVELOP MALICIOUS FIRMWARE\nThreat actors develop malicious firmware update\nfor identified serial-to-Ethernet converters.\n\nLocation: External infrastructure\n\nAction: Active threat actor activity\n\nTimeline: June 2015–December 2015\n\nDevice/application: Activity conducted external\nto network\n\nRole in infrastructure: Activity conducted external\nto network\n\nExploitation method: After identifying deployed\nconverts, threat actors begin a malware develop­\nment and testing effort on infrastructure outside\nof the targeted network.\n\nImpact: Upon completion of this step, threat\nactors would have target-specific malware\ndesigned to disrupt communications with field\ndevices by disabling deployed converters.\n\nBooz Allen’s recommended mitigations:\n\n- Implement information classification program\n\nto categorize critical system information that\ncould be used by a threat actor. Sensitive\ninformation such as this should have restricted\ndistribution and not be publicly available.\n\n- Review publicly available information, including\n\njob announcements and new supplier agree­\nments, to ensure they do not provide inadver­\ntent information to a threat actor on deployed\ndevices.\n\n###### STEP 11: DELIVER DATA DESTRUCTION MALWARE\nThreat actors likely deliver KillDisk malware\nto network share and set policy on domain\ncontroller to retrieve malware and execute\nupon system reboot.\n\n\nLocation: Corporate and ICS network\n\nAction: Active threat actor activity\n\nTimeline: December 2015, directly preceding\nattack\n\nDevice/application: Network share and Windows\ndomain controller server\n\nRole in infrastructure: The network share\nprovides access to shared digital resources, and\nthe Windows domain controller manages access\ncontrol throughout the network.\n\nExploitation method: Threat actors likely use\nstolen credentials to place KillDisk malware on a\nnetwork share, then set the retrieval and execution\nof the malicious files by implementing a policy on\nthe compromised domain controller server.[f]\n\nImpact: Prescheduling execution of malware\nenables coordination of multiple attack compo­\nnents, such that data destruction coincides with\nor shortly follows attacks against breakers.\n\nBooz Allen’s recommended mitigations:\n\n- Utilize network- and host-based antivirus\n\nsoftware to detect and prevent known malware\nfrom infecting organization systems.\n\n- Regularly scan organizational machine images\n\nwith YARA rules to detect malware prior to\nexecution.\n\n- Restrict and monitor network share access\n\npermissions.\n\n###### STEP 12: SCHEDULE UPS DISRUPTION\nThreat actors schedule unauthorized outage of\nUPS for telephone communication server and data\ncenter servers.\n\nLocation: Corporate and ICS network\n\nAction: Active threat actor activity\n\nTimeline: Directly preceding December 2015 attack\n\nDevice/application: Networked UPS devices with\nremote management interface\n\n\n_f._ _This tactic was observed in attacks against the Ukrainian television broadcaster in October 2015. Domain controllers and_\n_KillDisk execution upon reboot, observed in the December 2015 attacks, both indicate this tactic may have been repeated against_\n_the electricity distributors._\nboozallen.com/ics     19\n\n\n-----\n\nRole in infrastructure: Prevent power outages\nfrom disrupting continuous operation of critical\nsystems.\n\nExploitation method: Threat actors likely use valid\ncredentials to access privileged employee\naccounts, then use this access to remotely\nschedule unauthorized power outages.\n\nImpact: Prescheduling outages enables\ncoordination of multiple attack components,\nsuch that critical systems also go down as a\nresult of the power outages, stifling potential\nrestoration efforts.\n\nBooz Allen’s recommended mitigations:\n\n- Isolate UPS systems, and other facility\n\nmanagement systems, from both the ICS and\ncorporate networks.\n\n- Disable remote management services for UPS\n\ndevices wherever possible.\n\n**ACTION ON OBJECTIVES:**\n**EXECUTE ATTACK**\n\n###### STEP 13: TRIP BREAKERS\nThreat actors use native remote access services\nand valid credentials to open breakers and disrupt\npower distribution to more than 225,000\ncustomers within three distribution areas.\n\nLocation: ICS network\n\nAction: Active threat actor activity\n\nTimeline: December 23, 2015, during\n\nDevice/application: HMI workstations, DMS\nservers, RTU, and the substation breakers\n\nRole in infrastructure: HMI workstations provide\na graphical user interface for operators to remotely\nmonitor and control devices within the control\nenvironment. DMS applications enable centralized\nmonitoring and issuing of commands within a\ncontrol environment. Substation breakers are\n\n\ndevices designed to physically interrupt current\nflows through an electrical circuit.\n\nExploitation method: Threat actors use valid\ncredentials to seize control of operator worksta­\ntions, access DMS client application via VPN,\nand issue unauthorized commands to breakers\nat substations.\n\nImpact: Opening of breakers results in disruption\nof electricity service to customers.\n\nBooz Allen’s recommended mitigations:\n\n- Disable remote access into an organization’s\n\nICS network wherever possible.\n\n- Require direct operator action to allow a\n\nremote user connectivity into the ICS VPN.\n\n- Restrict user accounts with remote access\n\nprivileges to the minimum necessary and\nrequire two-factor authentication for all VPN\nconnections.\n\n- Restrict functions of users who remotely access\n\nthe control system environment wherever\npossible (e.g., read-only privileges).\n\n- Develop and practice incident response\n\nscenarios to understand how to disrupt remote\nconnectivity and manually operate ICS equip­\nment to bring operations back to a safe state.\n\n###### STEP 14: SEVER CONNECTION TO FIELD DEVICES\nAfter opening the breakers, threat actors deliver\nmalicious firmware update to serial-to-Ethernet\ncommunications devices. The malicious updates\nrender the converters inoperable and sever\nconnections between the control center and the\nsubstations.\n\nLocation: ICS network\n\nAction: Active threat actor activity\n\nTimeline: December 23, 2015, during attack\n\nDevice/application: Serial-to-Ethernet converters\n(Moxa UC 7408-LX-Plus,[61] IRZRUH2 3G[62])\n\n\n20 Booz Allen Hamilton\n\n\n-----\n\nRole in infrastructure: Convert serial data from\nfield devices to digital packets to be transmitted to\nremote monitoring and administration systems\nwithin the control network.\n\nExploitation method: Threat actors use network\naccess to push the malicious update over the\nnetwork to targeted devices.\n\nImpact: Operators are unable to remotely close\nthe breakers, requiring workers to manually close\nbreakers at each substation. Forcing this manual\nresponse draws out recovery time.\n\nBooz Allen’s recommended mitigations:\n\n- Actively monitor ICS network for spikes in\n\ntraffic or anomalous communications associ­\nated with firmware updates or reprogramming.\n\n- Use physical means to restrict remote\n\nreprogramming and firmware updates of field\ndevices (e.g., jumper settings, remote/run/prog\nswitches).\n\n- Implement a patch and vulnerability manage­\n\nment plan for all computer systems, field\ndevices, and network infrastructure equipment.\n\n- Maintain offline spares of common ICS devices\n\nwithin an organization to aid in the restoration\nof compromised devices.\n\n###### STEP 15: TELEPHONy DENIAL-OF-SERVICE ATTACK\nThreat actors initiate DoS attack on telephone call\ncenter at one of the targeted distributors.\n\nLocation: Corporate network[g]\n\nAction: Likely automated process\n\nTimeline: Dec 23, 2015, during attack\n\nDevice/application: Operator telephone call\ncenter\n\nRole in infrastructure: Receive external telephone\ncommunications from customers.\n\n\nExploitation method: Threat actors likely use\nautomated IP-based call generators to flood the\ntargeted call center.\n\nImpact: Automated calls overwhelm resources at\ncall center, blocking legitimate communications\nfrom customers.\n\nBooz Allen’s recommended mitigations:\n\n- Establish a relationship with the\n\ntelecommunications provider to aid\nin filtering out malicious calls during response\nactivities.\n\n\n_g._ _Public reporting did not indicate whether the call center deployed an automated system to receive calls or whether calls were_\n_answered manually by call center personnel._\nboozallen.com/ics     21\n\n\n-----\n\n###### STEP 16: DISABLE CRITICAL SYSTEMS\n VIA UPS OUTAGE\nPreviously scheduled UPS outage suspends\ntemporary battery backup power to targeted\ntelephone communications server and data\ncenter servers.\n\nLocation: Corporate and ICS network\n\nAction: Execution of prescheduled process\n\nTimeline: December 23, 2015, during attack\n\nDevice/application: Networked UPS devices with\nremote management interface, telephone\ncommunications server, and data center servers\n\nRole in infrastructure: Prevent power outages\nfrom disrupting continuous operation of critical\nsystems.\n\nExploitation method: Threat actors use network\naccess to schedule the temporary backup power to\nbe offline at the time of the power outages.\n\nImpact: Power loss to telephone server disrupts\ncommunications across remote sites, and disrup­\ntions at control centers inhibit ability to monitor\nand respond to attack against breakers. The\ndisruption at the data center and associated system\nreboot trigger execution of KillDisk malware.\n\nBooz Allen’s recommended mitigations:\n\n- Isolate UPS systems, and other facility\n\nmanagement systems, from both the\nICS and corporate networks.\n\n- Disable remote management services for UPS\n\ndevices wherever possible.\n\n\n###### STEP 17: DESTROY CRITICAL\n SYSTEM DATA\nScheduled execution of KillDisk malware erases\nthe master boot records and deletes system log\ndata on targeted machines across the victims’\ncorporate and ICS network.\n\nLocation: Corporate network and ICS network\n\nAction: Malware execution\n\nTimeline: December 23, 2015, during attack\n\nDevice/application: RTU device (ABB RTU560\nCMU-02),[63] servers and workstations used by\nmanagement, human resources (HR), and\nfinance staff\n\nRole in infrastructure: The RTU functions as a\ncommunication processor or data concentrator in\na substation, enabling communications and data\ntransfer between field devices in the substations\nand the control center.[64] Servers and workstations\nare used by management, HR, and finance staff to\nconduct business administration operations.\n\nExploitation method: Malware is retrieved from\nthe network share and executed on networked\ndevices according direction received via domain\ncontroller policy or local Windows Task Scheduler.\n\nImpact: Targeted systems are rendered inoperable,\nand critical data is destroyed.\n\nBooz Allen’s recommended mitigations:\n\n- Utilize network- and host-based antivirus\n\nsoftware to detect and prevent known malware\nfrom infecting organization systems.\n\n- Regularly scan organizational machine images\n\nwith YARA rules to detect malware prior to\nexecution.\n\n- Develop and practice contingency plans that\n\ninclude backup and restoration of critical data.\n\n\n22 Booz Allen Hamilton\n\n\n-----\n\n1. Know your environment. Identifying risk\nstarts with the need to understand your\noperational environment, including the\ntopology, network and wireless connection\npoints, and connected devices and assets.\nStarting with a thorough understanding of\nthe people, processes, and technology that\ncomprise an operational environment\nprovides the foundation to identifying what\nyou need to defend.\n\n2. Identify the key OT processes and data that\nneed to be protected. All processes and data\nare not created equal, and cybersecurity\nprofessionals often do not understand the\ncore operations of an ICS environment.\nCybersecurity professionals need to partner\nwith plant operators to identify and under­\nstand the essential operational processes\nthat, when disrupted, can cause significant\nimpact on operations. By assessing and\nprioritizing these key processes, focused\nmitigation strategies can be developed to\nboth defend and recover from cyberattacks.\n\n3. Understand the threats. Threats against ICS\nenvironments continue to increase, and\ncybercriminals see this as an opportunity to\nquickly monetize their trade through ransom­\nware and other attacks. Stay informed about\nwhat’s happening across the broader threat\nlandscape, both within your industry vertical\nand beyond. Understand how malicious actors\nmay compromise your environment, whether\nit’s launching phishing attacks against\noperators in your plant or injecting malicious\ncode in ICS devices at some point in the\nsupply chain. Engage in an active dialog with\nyour security team to ensure they are on the\nlookout for these types of events, and be\nprepared to quickly respond.\n\n\n## TOP 10 TAKE AWAYS\n\n#### What to Consider When Protecting Your OT Environment\n\n4. Segment your OT and IT environments.\nLike the Ukraine incident, many OT attacks\noriginate in the enterprise environment. It is\nimportant that you understand your network\nboundaries and connection points. We\nrecommend implementing network segmen­\ntation between your environment using\nVLANs and firewalls. Also, when necessary\nfor ultimate protection, consider data diodes\nor other unidirectional technologies for\none-way data transfer from sensitive\nenvironments to authorized systems.\n\n5. Focus on the Cyber security basics. Often,\nwe are making it easy on cybercriminals by\nforgetting about the basics. Treat your OT\nenvironment like you treat the enterprise.\nRemember to focus on basic cyber hygiene\nsuch as (a) strong passwords (or even a\npassword if not already protected);\n(b) multifactor authentication for remote\naccess, third parties, and maintenance\nproviders; (c) access control to protect key\nprocesses and data; and (d) the principle of\nleast privilege for user and admin accounts.\n\n6. Maintain your OT security posture. We often\nfind HMI and other connected devices in the\nOT environment to be outdated from a\npatching perspective—remember, keep your\npatches up to date if possible. We recognize\nthere are cases where vendors will not support\ntheir product when new patches are applied.\nIn these cases, get creative because you’re still\nat risk. Consider alternative controls, such as\nwhitelisting or network-based security\nappliances that block access based on known\nvulnerabilities.\n\nboozallen.com/ics     23\n\n\n-----\n\n7. Focus on proactive monitoring and\ndetection, not just compliance. A wise\nperson once said, “Compliance solves\nyesterday’s problem today.” In today’s\ncybersecurity landscape, new vulnerabilities\nand threats emerge daily. We recommend\ninstrumenting your environment with both\ntraditional network and end-point security\nsolutions, along with emerging real-time OT\ndata collection sensors. We also recommend\nimplementing an OT monitoring environ­\nment, such as Splunk, that captures and\ncorrelates events. For security operators, we\nrecommend watching critical processes and\ndata for firmware and configuration changes\noutside the proper change control process.\n\n8. Train your operators. Remember, people are\nusually the weakest link in a cybersecurity\nattack. Educate your team about the cyber\nand technology risks facing OT and ICS—and\nbuild awareness of the impacts these threats\ncan have on your OT environment. Cyber\ncriminals are actively looking to exploit ICS\noperations; educate staff to watch out for\nphishing emails and immediately report them\nto your cyber response team.\n\n\n9. Develop an OT incident response (IR) plan.\nEveryone is vulnerable to a cyberattack; it’s\nimportant to be prepared. We recommend\ncreating an OT IR plan that addresses safety\nand plant operations stability as its primary\ngoal. The IR plan should include key stake­\nholders, such Health and Safety, Legal,\nCompliance, and Environmental. Once\ndeveloped, it’s important that you socialize\nand prepare to execute your plan. We\nrecommend using scenario-driven exercises\nfor operators to understand threats and how\nto react to a cyber incident. Practice and drill\nusing the IR plan—and do it regularly!\n\n10. “Red Team” your environment.\n\nCybercriminals think differently from\ntraditional network defenders. They are crafty\nand financially motivated. It’s important to\nview your environment from the eyes of your\nadversary. We recommend engaging a\nprofessional team to assess your environ­\nment from an “attacker’s view.” While\nconventional red team practices may not\nwork in an OT environment, a skilled team\nthat understands the delicacies of operating\nin this space can use offline environments\nand built-in redundancy to conduct these\nactivities without affecting your operations.\nOnce completed, you can develop a mitiga­\ntion plan based on findings and periodically\nre-engage the red team!\n\n\n24 Booz Allen Hamilton\n\n\n-----\n\nThe attack against Ukraine’s electricity distributors\nwas unparalleled in its impact and demonstrated\ndisciplined, professional execution. It is highly\nlikely that this attack was politically motivated and\nconducted by a state-backed group.[h] As such,\nthese threat actors were among the most wellresourced and well-organized adversaries an\norganization can face. ICS operators are capable\nof meeting these adversaries head-on, and the\ntools needed to mitigate and minimize the impact\nof an attack such as this are readily available.\n\n**WHAT COULD HAVE PREVENTED THE**\n**ATTACK FOR UKRAINE?**\nAt the time of the attack, though the Ukrainian\nelectrical distributors had exploitable holes in their\nsecurity posture, they were not without defense.\nThe Ukrainian operators had implemented\nfirewalls between their internal networks and had\nsegmented their ICS environment from their\ncorporate network.[65] This segmentation should\nhave forced attackers to search for vulnerabilities\non the deployed systems, had they not already\nstolen valid credentials. The Ukrainian firms were\nalso fairly well positioned to respond to the\nattacks; their extensive experience in manual\noperation of their infrastructure enabled them to\nget impacted systems up and running within\nhours of the attack, despite lacking a prepared\nsystem failure contingency plan.[66] Likewise, the\nfirms were well prepared to investigate the\nincident, as they had extensive logging capability\nimplemented across their systems and firewalls.[67]\nDespite these precautions, the attackers were\nultimately successful. The biggest point of failure\nin the operator’s security posture, which allowed\nattackers to interfere with the physical systems,\nwas the enablement of remote access for their\n\n\n## CONCLUSION\n\ncontrol environment and the lack of two-factor\nauthentication.[68]\n\n**WHAT ABOUT THE UNITED STATES?**\nThe risks demonstrated in the attacks in Ukraine\nare significant for the US for several reasons.\nVariants of BlackEnergy malware have been\nidentified on multiple critical infrastructure\nnetworks in the US over the past several years.[69]\nAdditionally, disruptions on the US grids would\nlikely have a greater financial and social impact\nthan in Ukraine. Given the right grid operating\nconditions and timing of a cyberattack, another\nNortheast Blackout or greater could occur.\nRestoration from such a blackout could be even\nlonger if utilities were unable to remotely coordi­\nnate and operate key portions of their system.\n\nThough a destructive attack like the Ukrainian\nevent has not occurred in the US energy sector,\nvarious actors conduct reconnaissance and\ntechnical collection on the sector. In fiscal year\n2015, members of the US energy sector reported\n46 cybersecurity incidents[i] to ICS-CERT.[70]\nICS-CERT does not publish a breakdown of the\ntypes of incidents by sector, but it revealed that 31\npercent of total incidents reported across all\nsectors involved successful intrusion into\noperators’ assets, a third of which included\naccessing control systems.[71] A few disclosed\nexamples of reconnaissance targeting the US\nenergy sector exist, the most relevant of which is a\nBlackEnergy campaign active from at least 2011 to\n2014,[72] which the US government reportedly\nsuspected to be Russian-government orches­\ntrated.[73] In this case, the attackers who gained\naccess to systems did not attempt to “damage,\nmodify, or otherwise disrupt…processes.”[74]\n\n\n_h._ _An in-depth analysis of the weaponized file samples and recovered VBA scripts recovered for this report are provided in Appendix B._\n\n_i._ _ICS-CERT defines an incident as “the act of violating an explicit or implied security policy.” Examples of such incidents include_\n\n_h_ _i_ _f_ _hi hi_ _il_ _i_ _h_ _i_ _d_ _d h_ _i_ _f_ _l_ _i_\n\n\nboozallen.com/ics     25\n\n\n-----\n\nIn the near future, the likelihood of an attack against\nUS electrical infrastructure on the scale of the\nUkraine attack is very low. Based on previous\nresearch, we conclude that several nation states\nhave the capability to conduct similar time-con­\nsuming, strategically complex attacks, but, based\ntheir current relations with the United States, these\ncountries lack the intent to carry out such a brazen,\ndestructive attack against US critical infrastructure.\n\nIn recent years, we have seen several government\nregulations and industry initiatives that have\nreduced the risk of such attacks. These efforts are\ndesigned and implemented to mitigate cyber risk\nand ultimately to protect the reliability and\navailability of the electrical grid.\n\n\nThat said, operators must remain vigilant as many\nthreats do exist. Cybercriminals and other\nnonstate actors could use similar techniques and\ntactics to those in the Ukraine incident to deliver\nransomware or other create other equally\ndisruptive scenarios without attacking the grid\ndirectly. Additionally, global relations are in\nconstant flux and a significant deterioration in\nrelations with any of several countries could\ninduce them to conduct a Ukraine-style attack in\nthe US.\n\n\n26 Booz Allen Hamilton\n\n\n-----\n\n**BOOZ ALLEN SERVICE OFFERINGS**\nBooz Allen operates at the intersection of\nrisk and technology to deliver engineering,\nprocess, and domain-focused solutions for\nmanaging process and cybersecurity challenges\nin a sustainable manner. We bring the capability\nto work across the entire organization, from the\nC-Suite with business and regulatory perspectives\nto the plant manager and the realities of the\nindustrial environment, to ensure business and\nprocess integrity. We have developed cuttingedge solutions to help you identify, understand,\nenumerate, and manage the risks in your\nindustrial control systems (ICS) environment.\n\n+ CyberM+ [3]™ for ICS. Booz Allen’s unique\n\nassessment methodology for performing\nrisk-based reviews of your operational\ntechnology (OT) environment. We use it to\nunderstand the key risk areas in your security\nposture. We focus on (1) identification and\nprioritization of your key industrial processes,\ntelemetry, and data (2) identification and\nanalysis of key industrial and plant systems, (3)\nrisk assessment of plant, facility, and field\noperations, and (4) discovery to create a\ncomprehensive view of digital systems in your\nOT environment. The output of CyberM[3] is a\npicture of your current OT security maturity\nwith a roadmap and actionable mitigation\nplans to improve your OT security posture.\n\n+ Dark Labs Blacklight™ Assessment.+ Our\n\nsecurity engineers employ decades of expertise\nshielding the world’s most critical information\nto provide a red team assessment of your\ncritical infrastructure and OT environment.\nOur Dark Labs team develops strategies to\nassess your systems by deploying the same\ntechcraft malicious hackers apply to exploit\nthem. Through binary reverse engineering,\n\n\nembedded security, network analysis and\noperations, and data science, we assess your\nICS environment across a range of industries,\nmanufacturers, and vendors to identify critical\nweaknesses—providing insights to preemp­\ntively secure your devices, infrastructure, and\nICS systems before they’re attacked.\n\n+ Supply Chain Vendor Risk Analysis.+ Booz\n\nAllen provides risk-based and continuous\nmonitoring of all aspects of the supply chain.\nWe can work with you to define security\nrequirements for your key technology,\nhardware, and software deployments; evaluate\nyour suppliers; and embed security into your\nprocurement process, maintenance proce­\ndures, and other aspects of your supply chain\ninteractions to ensure that your ICS environ­\nment is not at risk.\n\n+ ICS Security Architecture, Design, Review, +\n\nand Analysis Capabilities. Booz Allen\nrecognizes that the best way to secure your OT\nand ICS environment is to ensure security is\nembedded into the system’s architecture. We\nprovide technical leadership to architect and\nsecure the control environment from the risks\nassociated with cyber threats. We look at data\nflows, process interactions, different plant\nsystems, and remote access and third-party\naccess needs to create an architecture to\nsupport operational needs and protect critical\nassets. Our team of process and industrial\nsystems engineers, using industry require­\nments and operational characteristics, will\norganize system components into a series of\nprotective levels to allow secure exchange of\ninformation between systems that need it\nwhile at the same time protecting core\nindustrial processes.\n\n\nboozallen.com/ics     27\n\n\n-----\n\n+ Security Programs, Training, and Awareness.+\n\nWe can provide the expertise to establish\ncomprehensive training and awareness\nprograms and to implement an overall security\nmanagement framework. We provide leader­\nship in creating and implementing end-to-end\nsecurity management programs covering risk\nassessment, architecture and threat mitigation,\nand ongoing compliance and monitoring\nprograms. As part of our training and aware­\nness programs, we can create a training\ncurriculum and communications plan targeted\nat education OT, ICS risk, and overall impact.\n\nBooz Allen’s solutions are not driven by “cyber\nfor cyber’s sake” but are focused on protecting\nyour core operational functions; improving safety,\nreliability, and process integrity; and supporting\nregulatory compliance. Our differentiated\nposition allows you to become safer and more\nsecure—and able to compete in a challenging\nbusiness and operational landscape.\n\n\n###### For More Information\n\nBRAD MEDAIRY\nSenior Vice President\n[medairy_brad@bah.com](mailto:medairy_brad%40bah.com%20?subject=)\n+1-703-902-5948\n\nSCOTT STABLES\nChief Cyber Technologist\n[stables_scott@bah.com](mailto:stables_scott@bah.com )\n+1-630-776-7701\n\nMATT THURSTON\nLead Associate\nthurston_matthew@bah.com\n+1-703-216-5259\n\n28 Booz Allen Hamilton\n\n\n+ ICS Monitoring (Powered by Splunk).+\n\nLeveraging our intelligence community work\nand our commercial Cyber Fusion Center\noffering, we help clients implement an\nend-to-end ICS monitoring solution that\n(1) instruments critical processes and data,\n(2) presents an operational dashboard that\nprovides situational awareness of security and\nICS-related events, (3) actively hunts for\nadversary and malicious activity across the\nOT network. Our solution can be deployed not\nonly to detect, flag, and manage OT incidents,\nbut also provides insights into the plant’s\nsecurity, safety, reliability, and performance\nusing advanced analytics.\n\n++ Industrial Incident Response (IR). We work\n\nwith clients to determine whether their OT IR\nstrategy is sufficient to navigate a breach,\ndeveloping a customized plan so you are ready\nto respond when a breach occurs. It covers the\nentire OT environment—from plant manager,\nchief information security officer, and operators\nto legal, HR, and communications—to clarify\nand test roles and procedures. If you think\nyou’ve been breached, our incident response\nteam can be on the ground within 12 hours,\nbringing the experience, technical expertise, and\nequipment to eradicate bad actors from your\ncritical operations network and shield your\norganization’s most valuable assets.\n\n\n-----\n\nThis section is included to provide a more detailed\ntextual summary of each of the steps outlined in\nthe Attack Walk Through section of the report.\nThis includes citations for all referenced sources\nand discussion of the analyst assessments behind\neach step.\n\n**RECONNAISSANCE**\n\n###### STEP 1: RECONNAISSANCE AND INTELLIGENCE GATHERING\nIt is currently unknown why the particular three\npower distribution companies were targeted,\nthough reconnaissance and intelligence\ngathering were likely used by threat actors to\nidentify targets. Threat actors may select\nseveral potential targets based on their strategic\nobjectives, then use initial reconnaissance on\nthese targets to narrow their focus and build\ntheir plan of attack. Reconnaissance can be\nconducted actively or passively. Active\nreconnaissance includes direct interactions with\nthe targeted network, such as port scanning,\nwhereas passive reconnaissance includes\nactivities such as open-source intelligence\ngathering. Open-source intelligence gathering\ncan also provide key situational information\nabout the types of technologies deployed by\npotential targets, associated vulnerabilities, and\npossible attack vectors available to threat actors.\nValuable targeting data, such as information on\nthe type and kilo-voltage of hardware deployed\nat substations, specific model information on\ndevices used in operator’s control environ­\nment,[75,76,77,78] and likely types of operating\nsystems used at workstations in the control\nenvironment,[79] is available on publicly\naccessible websites.\n\n\n## APPENDIX A:\n\n#### Detailed Textual Description of Attack Walk Through\n\n**WEAPONIZATION**\n\n###### STEP 2: MALWARE DEVELOPMENT\n AND WEAPONIZATION\nTo gain unauthorized network access, attackers\nmay target vulnerabilities in web-facing infra­\nstructure, or develop weaponized files to deliver\nto users on the network. In taking a weaponiza­\ntion approach, attackers modify common file\ntypes, such as .pdf or .doc files, to exploit\nvulnerabilities in the programs used to view\nand edit the specific file type. Alternatively, the\nattackers may use social engineering tactics to\nencourage targeted users to enable content\nsuch as Visual Basic (VB) macro scripts. These\nweaponized files can be delivered to specific\nindividuals in an organization or sent to large\nnumbers of users, depending the level of\ntargeting conducted by the threat actor.\nUltimately, both techniques result in installation\nof malware, which can be used as a means to\nenable remote access.[80]\n\nIn the Ukraine attacks, threat actors gained access\nto targeted networks using weaponized Microsoft\n(MS) Office files, specifically Word and Excel,[81,82]\nby embedding BlackEnergy (BE) 3 malware in VB\nscripts.[j] The BE malware embedded in the\nweaponized files was also specifically modified for\nthe attacks. Public reporting on BE3 samples\ngathered in 2015 indicates the attackers had added\nfunctionality to the malware to support specific,\ninternal proxy servers in establishing command-andcontrol (CC) connections.[83,84] This indicates the\nattackers had already gathered network infrastruc­\nture details prior to delivery of the updated\nmalware[85] and modified the malware packages\nbased on infrastructure at their targets.\n\n\n_j._ _An in-depth analysis of the weaponized file samples and recovered VBA scripts recovered for this report are provided in Appendix B._\n\n\nboozallen.com/ics     29\n\n\n-----\n\n**DELIVERY**\n\n###### STEP 3: DELIVER REMOTE ACCESS TROJAN (RAT)\nPublic reporting consistently indicates that\nphishing was the initial delivery method, though\nthe exact timeframe in which initial access was\nestablished is not confirmed. Ukraine’s Deputy\nEnergy Minister stated threat actors had access no\nless than six months prior to the attack.[86] Other\nreporting indicates the phishing campaign began\non or around March 2015 and continued through\nJanuary 20, 2016.[87] This March 2015 campaign\nused weaponized MS Office files to deliver\nmalware via phishing attacks to many Ukrainian\norganizations, including the three distributors hit\nin the December 2015 attacks.[88] The earliest\nphishing attacks using weaponized MS Office\ndocuments to deliver BE malware against\nPrykarpattyaoblenergo were observed in May 12,\n2014,[89] a year and a half before the grid disrup­\ntions in December 2015. This attack also targeted\na range of Ukrainian businesses,[90] including all six\nof Ukraine’s railway operators managed by\n“Ukrzaliznytsya,” the State Administration of\nRailway Transport of Ukraine.[91] Each of these\nphishing attacks may have been part of a broad\nreconnaissance and intelligence gathering effort,\nand the ultimate objective of causing a destructive\nindustrial control systems (ICS) attack may have\ndeveloped later on.[92] In addition, while BE was the\nprimary malware delivered to targeted networks,\nother RATs, including GCat,[93] Dropbear,[94] and\nKryptik[95] were recovered in the investigation\nfollowing the grid disruption in December 2015.[96,k]\n\n\n**EXPLOITATION AND INSTALLATION**\n\n###### STEP 4: INSTALL RAT\nBE3 malware was embedded in malicious MS\nOffice files, which were sent to operators in a\nwide-reaching phishing campaign. Upon delivery,\nwhen recipients opened the weaponized docu­\nments, they were presented with an onscreen\nprompt to enable the macro function for the\nweaponized files to execute.[97] No exploit code was\nused to initially deliver BE onto targeted\nnetworks.[98] Using permissions granted by the user\nwhen macros were enabled, the VBA script\ndropped the persistent malware files on disk at\nworkstations of targeted employees.[l]\n\n**COMMAND AND CONTROL**\n\n###### STEP 5: ESTABLISH CC CONNECTION\nThe primary function of BE3 malware is to\nestablish a hook into targeted networks, enable\npersistent, unauthorized access, and use this\naccess to gather intelligence on the targeted\nsystems. The first step in this process is estab­\nlishing a connection with an external CC server.\nAfter installation, the BE implant modifies\nin-registry Internet settings and MS Internet\nExplorer security settings, then uses HTTP POST\nrequests to contact an external CC server.[m]\n\n\n_k._ _Additional discussion of the alternate RATs observed on the electricity distributor networks is provided in Appendix D._\n\n_l._ _By analyzing the weaponized files, the step-by-step process the BE malware executed to insert itself into targeted networks is_\n_revealed. A detailed summary of the infection routine for recovered malware samples used in the Ukraine attacks in included in_\n_Appendix B._\n30 Booz Allen Hamilton\n\n\n-----\n\n**ACTION ON OBJECTIVES: INTERNAL**\n**RECONNAISSANCE AND LATERAL**\n**MOVEMENT**\n\n###### STEP 6: DELIVER MALWARE PLUGINS\nAfter establishing connections to the delivered BE\nimplant, attackers used this access to acquire\nemployee credentials, allowing them to use\nexisting remote access services to maintain a\npresence on the network.[99] Specific details on how\nthe credentials were harvested are not publicly\nreported, though analysis of the BE malware\nprovides some insight into the methods threat\nactors may have leveraged.\n\nOne of the key features of BE is its modular nature\nand ability to download plugins designed for many\ndifferent tasks.[100,n] Once loaded onto a targeted\nsystem, and having established connections with\nthe CC server, BE3 is capable of receiving a range\nof commands, including uninstall, load or unload\nplugin, update DLL, download and execute\nexecutable, download and execute a binary, or\nupdate configuration data.[101] After loading any\nplugins, the BE3 implant communicates with them\ninternally using remote procedure calls (RPC) over\nnamed pipes.[102] The threat actors likely down­\nloaded several plugins onto the targeted networks,\nfollowing the initial infection, and used these\nplugins in several stages of the attack, including\nthe harvest of user credentials.\n\n\n###### STEP 7: HARVEST CREDENTIALS\nCredential harvesting was likely an iterative process\nbeginning with malware exfiltration then shifting to\ndirect interaction with deployed systems by the\nattackers. Credentials can be stolen using a wide\nrange of the methods, such as social engineering,\nkeylogging, or targeting of specific applications,\nsuch as password managers. In the Ukraine attacks,\ncredentials were likely collected using associated BE\nplugins specifically designed for this task. The\nplugins likely used to harvest credentials in the\nUkraine attack are the PS.dll plugin, designed to\nharvest stored user credentials,[103] SI.dll plugin,\nwhich gathers system data and stored passwords\nfrom a range of applications,[104] and the KI.dll plugin,\nwhich logs keystrokes.[105,o] In at least one instance,\nattackers used their access to create additional,\nunauthorized domain accounts.[106 ]Other reporting\n\n\n_n._ _An in-depth discussion of BE capabilities for receiving and communicating with plugins, as well as the capabilities and functions_\n_of identified plugins are detailed in Appendix B and Appendix C._\n\n_o._ _Additional detail on these plugins is provided in Appendix C._ boozallen.com/ics     31\n\n\n-----\n\nindicates the attackers eventually gained access to\nWindows domain controllers, where they gathered\ncredentials for the virtual private network (VPN)\nused by grid operators to access the control network\nremotely.[107] In the attack against the Ukrainian\nmedia outlets,[p] attackers used VPN to access an\nadministrator account then used remote desktop\nprotocol (RDP) service from the administrators’\naccount to access the domain controller.[108] It is\nplausible that threat actors repeated this tactic\nagainst the electricity distributors.\n\nOnce the attackers had valid credentials, the\nattackers likely shifted away from this initial hook\ninto the network provided by the BE implant in\nfavor of native remote access services such as\nVPN.[109] The benefit of shifting away from the\nnetwork access provided by the malware, and\nestablishing multiple lines of communication, is\nthat it supports persistent access and minimizes\nvisibility of malicious activity.[110] If any one\nconnection is discovered and removed, threat\nactors have redundant connections, and, by using\ntrusted communications, threat actor activity\nblends in with normal traffic of authorized users.[111]\n\n###### STEP 8: LATERAL MOVEMENT AND TARGET IDENTIFICATION ON CORPORATE NETWORK\nLittle information is publicly available on the lateral\nmovement and internal reconnaissance efforts,\nthough the list of targets in the final attack indicate\nextensive network discovery. Targeted systems\ninclude networked uninterruptable power supply\n(UPS) devices, data center servers, a telephone\ncommunications server, and employee worksta­\ntions.[112] This movement likely involved a range of\nactivities over a lengthy period, including gathering\n\n\nof credentials, and identification of potential targets\nand services to be leveraged in the attack.[113] As with\nthe initial credential harvesting, network discovery\nwas likely aided with dedicated BE plugins,\nspecifically the VS.dll plugin. VS.dll scans for\nconnected network resources, attempts to retrieve\nremote desktop credentials, and establishes\nconnections to remote systems using the MS\nSysinternals PsExec tool.[114] In the attack against\nUkrainian media outlets,[q] anomalous use of PsExec\nto enumerate and establish remote access to\nnetworked systems was logged on administrator\nworkstations.[115] Threat actors may have used this\nsame tactic two months later against the three\nelectricity distributors.\n\n###### STEP 9: LATERAL MOVEMENT AND TARGET IDENTIFICATION ON ICS NETWORK\nUltimately, after gaining initial access to the\ncorporate network and harvesting valid user\ncredentials, the threat actors were able to navigate\nsuccessfully from the corporate IT network into\nthe control environment, hosting the human\nmachine interface (HMI) workstations, distributed\nmanagement system (DMS) servers, and\nnetworked field devices. Threat actors used valid\ncredentials to establish at least two pathways into\nthe control environment; these included remote\nadministration tools to access operator worksta­\ntions and VPN services to interact directly with the\nclient application for the DMS server.[116] As noted\nabove, public reporting indicates VPN credentials\nfor the control environment may have been\nrecovered from Windows domain controllers.[117]\nAccess to the HMI workstations and DMS\napplication was likely sufficient for threat actors to\n\n\n32 Booz Allen Hamilton _p._ _The original source did not explicitly mention the target in their summary of the investigation, though the blog indicated the_\n_tt_ _k_ _d_ _t d_ _O t b_ _i_ _t_ _Uk_ _i i_ _t_ _t_ _d_ _d BE_ _d KillDi k_\n\n\n-----\n\nenumerate all of the networked devices. Unlike\ncorporate networks, ICS networks often follow a\nhub-and-spoke orientation, with a single, central­\nized control point. It is unlikely the threat actors\nused the associated BE network discovery plugins\nreferenced above; using active discovery methods,\nsuch as scanning, may interfere with necessary\ncommunications or cause communication cards\nto fail.[118] Systems identified during this reconnais­\nsance phase, and targeted in the final attack,\ninclude HMI workstations, DMS servers, control\ncenter UPS,[119] serial-to-Ethernet converters, and\nthe substation breakers.[120]\n\nThough this attack was conducted remotely\nusing valid credentials, tampering with the\nphysical network connections to field devices,\nsuch as RJ45 or Fiber cabling, can provide\nanother method to gain network access. A\nmitigation strategy to prevent malicious code or\na laptop from entering the network could be\nsomething as simple as a “sticky MAC” program,\nwhereby the network switch port is configured to\nwhitelist the unique MAC address of a specific\nintelligent controller, and becomes disabled in\nthe event the field device gets disconnected.\nSimilarly, if the network includes wireless\ntelemetry, this could also provide an entry-point\nfor attackers. This risk can be mitigated using\nFIPS 140-2 or similar encryption technology.\n\nDuring their target selection process, threat actors\nlikely used their network access to familiarize\nthemselves with ICS configuration, interfaces,\ncommand processes, and other operational\ndetails of systems at each organization. Even if\nthreat actors are familiar with the deployed devices\nand applications, often system configurations will\nbe customized at individual facilities based on\n\n\noperator needs or preferences. Prior to the final\nattack, the attackers learned how to direct the\nDMS at each of the three companies, using the\nexisting controls and HMI displays.[121] Because this\nactivity was likely executed on the operator\nnetwork, little forensic information on this process\nwas generated.[122]\n\n**ACTION ON OBJECTIVES:**\n**ATTACK PREPARATION**\n\n###### STEP 10: DEVELOP MALICIOUS FIRMWARE\nThis incident was the first instance where threat\nactors developed malicious firmware update for a\nspecific attack.[123] In conducting a firmware attack,\nthreat actors will push an update that will either\npatch or completely replace the old firmware. This\nis often done in an unauthenticated manner\nwithout any verification that the new or updated\nfirmware is valid. Alternatively, in some attacks\nthreat actors have compromised vendor websites\nand hosted weaponized firmware to be down­\nloaded and installed by operators.[124]\n\nTypically, the system running the firmware will be\nrebooted for the new firmware to be fully installed\nand operational. At this point, anything malicious\nthat has been added to the firmware will have a\nchance to execute, depending on how the code is\ndesigned; this could be immediately upon reboot,\nor may be based on some trigger. Samples of the\nmalicious firmware used in the Ukraine attacks\nwere not recovered, and specific detail on the\nexecution process could not be derived.\n\nWell-resourced and highly organized groups may\nalso conduct testing of malware or exploit code\nintended for use on targeted systems.[125] Threat\nactors may obtain specific ICS hardware or\n\n\nboozallen.com/ics     33\n\n\n-----\n\nsoftware, and configure them to match the\noperator environment.[126] Investigators assessed\nthat it is unlikely the threat actors executed the\nattacks in Ukraine without some level of prior\ncapability testing, particularly the malicious\nfirmware updates.[127] Given the apparent resources\nand professionalism of the group, outside\nobservers assessed the threat actors may have\nused systems of their own to confirm the\neffectiveness of the modified firmware used in the\nfinal stages of the attack.[128]\n\n###### STEP 11: DELIVER DATA DESTRUCTION MALWARE\nIn addition to opening breakers, the threat actors\nalso used a data destruction malware, known as\nKillDisk, at all three distributors to wreak havoc\non networked machines. Threat actors have used\nboth KillDisk and BE3 malware together in\n\n\nmultiple attacks,[129] but analysis of recovered\nsamples of BE3 does not indicate any technical\nlink between the two malware applications.\nKillDisk is a separate, standalone executable\n(.exe) file used in conjunction with BE3 during\nthe attack. The malware was likely loaded onto\ntargeted networks as one of the final prepara­\ntions directly prior to attackers opening the\nbreakers. Public reporting indicates that the\nKillDisk malware may have been set as a logic\nbomb when placed on targeted machines, with a\nspecific time delay before the destructive\nfunctions of the malware executed.[130] This would\nensure data destruction would coincide with, or\nshortly follow, the attacks against breakers.\n\nThe use of an internal scheduling function is\nunlikely; BE has an associated data destruction\nplugin, DSTR.dll, which includes an execution\ntime in its configuration data, but recovered\nKillDisk samples did not include any such\ncapability. In the attack against Ukrainian media\noutlets,[r] attackers placed KillDisk malware on a\nnetwork share and used a compromised adminis­\ntrator account to access domain controller\nservers.[131] On the domain controller servers, they\nscheduled a policy for every workstation to retrieve\nand execute the file following reboot.[132] Public\nreporting indicates that, in the attack against\nelectricity distributors, credentials were retrieved\nfrom compromised domain controllers[133] and that\nUPS disruptions triggered KillDisk execution on\ndata center servers.[134] Both of these claims\nsupport the assessment that the tactic used in the\nmedia attack was also used against the electricity\ndistributors. Attackers may have also used\nadministrator access to remotely schedule retrieval\nand execution of the malware using Windows Task\nScheduler on high-priority target machines.[135] This\nmethod was also used in the Ukrainian media\n\n\n_r._ _The original source did not explicitly mention the target in their summary of the investigation, though the blog indicated the_\n_attack was conducted on October 25, 2015, against a Ukrainian target, and used BE3 and Killdisk._\n34 Booz Allen Hamilton\n\n\n-----\n\nattack as a contingency measure to ensure the\ndata destruction attack would be successful\nshould the domain controller server crash.[136]\n\n###### STEP 12: SCHEDULE UPS DISRUPTION\nAttacks against operators’ UPS systems were\nconducted against at least two of the three affected\npower distributors.[137] UPS outages were scheduled\nusing remote management interfaces,[138] and\naffected devices included an internal telephony\ncommunications server at one firm and the main\ndata center at a second operator.[139] Public reporting\nalso indicates the UPS outages affected two of the\ncontrol centers, disabling the ability of operators to\nmonitor the control network.[140] In disrupting the\ntelephony server, the attackers severed internal\ncommunications across the firm and with workers\nat remote sites. In the attack against the data\ncenter, the scheduled outage was entered directly\npreceding the malicious interactions with the firms’\nsubstation breakers, and was set to execute several\nhours following the attack.[141] In this attack, public\nreporting indicates that the server reboot caused by\nthe power disruption also triggered the disk-wiping\nfunction of the KillDisk malware, which had been\nloaded onto the systems.[142]\n\nSome UPS network management cards support\nremote monitoring and control via web browser,\ncommand line interface, or SNMP, enabling\nreboot and scheduling of shutdowns.[143] Details\non the specific UPS devices deployed by each of\nthe distributors was not found in public\nreporting, so the remote access services used to\naccess the devices cannot be confirmed. In\naddition, while the threat actors likely used valid\ncredentials in this attack, vulnerabilities such as\ncross-site scripting have been identified in some\nUPS management devices.[144]\n\n\nThis component of the attack is not technically\ncomplex, but it serves as an effective illustration of\nthe level of organization exhibited in this multifac­\neted attack. Two of the reported UPS disruptions\nwere essentially direct threat actor interactions\nwith two systems, using remote access, to cause\nsecond-order effects (i.e., server backup power\nloss), which triggered malware execution upon\nreboot for one target, and mirrored the communi­\ncation disruption (i.e., telephony denial of service\n\n[TDoS]) of a nearly simultaneous attack against\nanother target. The attacks also highlight the\ndependencies of computer network components\non peripheral systems, such as power supply,\nHVAC, or even physical security. Vulnerabilities in\nthese systems may be used by threat actors as\nadditional means of accessing or interfering with\nnetwork devices.\n\n**ACTION ON OBJECTIVES:**\n**EXECUTE ATTACK**\n\n###### STEP 13: TRIP BREAKERS\nAfter months of clandestine access, reconnais­\nsance, and preparation, the threat actors executed\nthe final step in their attack: disrupting operation\nof the electrical grid itself. Using existing remote\naccess tools similar to RDP and Radmin,[145] threat\nactors took control of employee workstations\nhosting the HMI and actively issued commands to\nopen individual breakers across the managed\nsubstations. During the attack, users sitting at the\nworkstation could observe the commands being\nissued but were unable to use their mouse and\nkeyboard to interfere with the attack.[146] In some\ninstances, the attacks also used an existing DMS\nclient application to send commands to open\nbreakers directly to the DMS server using their\nVPN access.[147] The direct interactions with DMS\n\n\nboozallen.com/ics     35\n\n\n-----\n\nand employee workstations were conducted by\nmultiple threat actors, and were all conducted\nwithin a 30-minute window[148] at some point\nbetween 15:30 and 16:30 local time.[149]\nInvestigators noted that, prior to execution of the\nfinal attack, the threat actors modified passwords\nfor some users to lock them out of the system\nduring recovery.[150]\n\nIn all, the attackers opened breakers in at least 57\nsubstations. Though complete details on the\nextent of the attack are not publicly available, one\nof the three operators, Prykarpattyaoblenergo,\nindicated that 27 of its substations were taken\noffline, resulting in complete blackouts across\n103 cities and partial blackouts in an additional 186\ncities.[151] Kyivoblenergo indicated that seven of its\n110kV substations and 23 of its 35kV substations\nwere taken offline, disconnecting power for\n80,000 customers.[152] Impacts on the infrastruc­\nture of Chernivtsioblenergo were not found in\npublic reporting.\n\n###### STEP 14: SEVER CONNECTION TO FIELD DEVICES\nPublic reporting indicates that the updates were\npushed to each of the devices within a short\nperiod, and the firmware itself was uniform across\nthe targeted converters.[153] With the communica­\ntions between the control center and field devices\nsevered, even after control of the network was\nrestored, the breakers could not be closed\nremotely and technicians had to manually close\nthem at each substation.[154] Manually resetting the\nbreakers, the technicians were able to restore\npower to customers within three to six hours.[155]\n\n\nUltimately, neither the operator nor the manufac­\nturer was able to restore the devices following the\nmalicious update, which forced operators to\nreplace all targeted devices.[156] At least 16 substa­\ntions were disconnected from the control network\nusing the malicious firmware updates.[157]\n\nThe two converters targeted in the attack were the\nMoxa UC 7408-LX-Plus and the IRZRUH2 3G.[158]\nWhile both of these devices support firmware\nupdates by authorized users, indicating the\nattackers may have used the credentials harvested\nearlier in the attack to push the malicious\nupdates,[159] they are also both susceptible to known\nvulnerabilities.\n\nThe Moxa device includes an extensive number of\nvulnerabilities, and the source code itself is\npublicly available; access to the source code is of\nparticular concern, as it would allow threat actors\nto directly examine the code for vulnerabilities.\nThe identified Moxa firmware vulnerabilities\nincluded arbitrary code execution[160] and multiple\nremote denial-of-service (DoS) vulnerabilities;[161,162]\nin addition, several of the fixes for the device were\nincomplete, leading to follow-on vulnerabili­\nties.[163,164] Though the iRZ-RUH2 was relatively\nmore secure and source code for the firmware did\nnot appear to be publicly available, the device still\nincluded a least one vulnerability that would allow\nan authorized user to remotely update the\nfirmware with an unvalidated patch.[165]\n\n###### STEP 15: TDOS ATTACK\nIn an apparent attempt to block incoming\ncommunications, threat actors also conducted a\n\n\n36 Booz Allen Hamilton\n\n\n-----\n\nTDoS attack against at least one operator. TDoS\nattacks are similar to DoS attacks against\nwebservers or other data network systems; a flood\nof communication traffic is used to block legiti­\nmate communications by overwhelming infra­\nstructure bandwidth or call-center staff.[166 ]\n\nPublic reporting indicates that directly prior to\nopening breakers, one of the operators began\nreceiving thousands of calls at its call centers\nthat appeared to be coming from Moscow.[167,168]\nBy preventing operators from receiving outage\nreports, threat actors may have intended to\nmask the impact of the outage and possibly\ndraw out recovery time. Alternatively, investiga­\ntors also noted the TDoS attacks may have been\nfocused on blocking callers from receiving\ninformation, in order to create greater confusion\nand frustration toward the operators among their\ncustomer base.[169]\n\nIt is highly likely the TDoS attack in Ukraine was\nconducted using automated tools, though specific\ndetails regarding how the TDoS attack was\nconducted are not documented in public sources.\nWhile not as common as DoS attacks against data\nnetworks, there are existing tools to automate the\nprocess. Free software, including Asterisk IP PBX\nand SIP call generator, can be used by attackers to\nsend floods of robocalls at targeted systems.[170]\nSimilar to DoS attacks, TDoS floods can be\namplified using distributed botnets, and paid\nservices to launch TDoS attacks have also been\nobserved in criminal forums.[171] Previously, TDoS\nattacks have been used to target firms in the\nfinancial sector and emergency responder call\n\n\ncenters in the US.[172] The attacks against emer­\ngency responders were principally conducted by\ncriminal groups as part of extortion operations.[173]\n\n###### STEP 16: DISABLE CRITICAL SYSTEMS VIA UPS OUTAGE\nAs noted above, the UPS disruptions were likely\nscheduled in advance of the final attack on the\nsubstation breakers. The targeted systems\nincluded a telephone communication server and\ndata center servers.[174] Public reporting also\nindicated the disruption impacted control center\nsystems, though specific details on targeted\ndevices were not provided.[175]\n\n###### STEP 17: DESTROY CRITICAL SYSTEM DATA\nKillDisk was retrieved and executed on networked\ndevices at all three distributors.[176] The malware\noverwrote the master boot record (MBR), and in\nsome instances continued to overwrite additional\ndata on disk. Several variants of KillDisk malware\nwere used in the attack; execution routine and\nextent of data destruction varied.[s] Affected\nmachines were rendered completely inoperable,\nadding an additional burden on incident\nresponders and ultimately driving up recovery\ncosts to replace targeted devices.\n\nDisk-wiping attacks were not executed against all\nnetwork devices. Targets were primarily on\noperators’ enterprise networks, particularly servers\nand hosts used by management, human resources,\nand finance staff, though the attackers also\ndestroyed at least one remote terminal unit (RTU)\nwith an embedded windows HMI card.[177]\n\n\n_s._ _An in depth analysis of each of the recovered Killdisk samples is provided in Appendix B, including assessments of key variations_\n_between execution routines._\nboozallen.com/ics     37\n\n\n-----\n\n## APPENDIX B:\n\n#### Malware Samples\n\nThe malware samples analyzed for this report can\nbe categorized into four distinct groups. These\ngroups include:\n\n                     - Weaponized files used to deliver malware to\n\ntargeted systems\n\n                    - Malicious scripts embedded in the weaponized\n\nfiles used to install a persistent implant\n\n                     - Persistent implants used to provide remote\n\naccess onto the network\n\n                      - Additional destructive malware, specifically the\n\nKillDisk malware, used to overwrite data during\nthe final stages of the attack.\n\nSamples from each of these categories are\ndetailed in the following sections. Though\npredominantly BlackEnergy (BE) samples, a\nweaponized version of Dropbear server, and an\nassociated Visual Basic (VB) dropper are also\ndetailed. Multiple samples of the KillDisk malware\nwere analyzed for this report. Samples analyzed\nfor this report were gathered using the Virus Total\nIntelligence (VTI) service. The “First Upload,”\n“Final Modification,” “Language Settings,” and\n“File Name” data in the malware analysis tables\nwere gathered from the VTI summary for the\nreported sample.\n\n\n**DELIVERY MALWARE**\nMost public reporting on the December 2015\nattacks indicate that the malware was initially\ndelivered to targeted networks using weaponized\nMicrosoft (MS) Office documents. Several\nrecovered samples indicate attackers had some\nvariation in their delivery method. Recovered\nsamples included both a weaponized MS Excel[t]\nfile and a weaponized MS Word document.[u]\nSamples of BE2 recovered following an attack on\na Ukrainian news outlet in October 2015[178]\nindicate the threat actors may have also\nembedded malware in a compromised Cyberlink\nPowerDVD 10 binary[v] (a movie/media player) or a\nfile designed to look like Cyberlink PowerDVD 10\nvia string analysis. This particular sample file\nfunctioned as an installer, delivering a BE2\nimplant[w] and encrypted configuration[x] file to the\ntargeted system. Though not definitively\nconducted by the same group behind the attacks\nagainst the electricity distributors, the attack on\nthe Ukrainian media outlet, which was conducted\non Ukraine’s election day, shared the common\ntactics, techniques, and procedures (TTP) of\nusing a combination of BE malware and KillDisk\nmalware to destroy critical data.[179]\n\n\n_t._ _Appendix B.1: Weaponized MS Excel (Додаток1.xls) (MD5: 97b7577d13cf5e3bf39cbe6d3f0a7732)_\n\n_u._ _Appendix B.2: Weaponized MS Word ($RR143TB.doc) (MD5: e15b36c2e394d599a8ab352159089dd2)_\n\n_v._ _Appendix B.5: BE2 Installer (Undisclosed) (MD5: 1d6d926f9287b4e4cb5bfc271a164f51)_\n\n38 Booz Allen Hamilton\n_w_ _Appendix B 11: Implant (adpu160m sys) (MD5: e60854c96fab23f2c857dd6eb745961c)_\n\n\n-----\n\nAPPENDIX B.1:\nWEAPONIZED MS EXCEL (ДОДАТОК1.XLS) [y]\n\nSHA1: aa67ca4fb712374f5301d1d2bab0ac66107a4df1\n\nSHA-256: 052ebc9a518e5ae02bbd1bd3a5a86c3560aefc9313c18d81f6670c3430f1d4d4\n\nMD5: 97b7577d13cf5e3bf39cbe6d3f0a7732\n\nType: Microsoft Office Excel[180] First Upload: 2015-08-03 10:37:19\n\nCompile Timestamp: Final Modification Timestamp:\n2015-02-04 07:35:08[182] 2015-03-18 07:41:04[183]\n\nFile Size: 734720 bytes[184] Language Settings:\n\nFile Names: Додаток1.xls[186]\n\nTechnical Notes:\nThis is a weaponized MS Excel file used to deliver BE3 malware.[187]\nprompted to enable macros. The spreadsheet includes an embedded VBA macro that executes\nwhen users enable the macro functionality. The associated VBA macro is a BE3 installer.\n\nRelated Samples:\n\n1. Appendix B.4: BE3 Installer (VBA_macro.exe, Sample 2)\n(MD5: abeab18ebae2c3e445699d256d5f5fb1)\n\n2. Appendix B.6: Dropbear Installer (DropbearRun.vbs)\n(MD5: 0af5b1e8eaf5ee4bd05227bf53050770)[189 ]\n\nAPPENDIX B.2:\nWEAPONIZED MS WORD ($RR143TB.DOC) [z]\n\nSHA1: 28719979d7ac8038f24ee0c15114c4a463be85fb\n\nSHA-256: 39d04828ab0bba42a0e4cdd53fe1c04e4eef6d7b26d0008bd0d88b06cc316a81\n\nMD5: e15b36c2e394d599a8ab352159089dd2\n\nType: Microsoft Office Word[190] First Upload: 2016-01-20 08:03:52 UTC\n\nCompile Timestamp: Final Modification Timestamp:\n2015-07-27 10:21:00[192] 2015-07-27 10:21:00[193]\n\nFile Size: 1194496 bytes Language Settings:\n\nFile Names: $RR143TB.doc[195]\n\nTechnical Notes:\nThis is a weaponized MS Word file, with an embedded BE3 installer.[196]\nare prompted to enable macros, allowing the execution of the BE3 installer.[197]\nthe infection routine are provided in Appendix B.6: BE3 Installer (VBA_macro.exe, Sample 1).\n\nRelated Samples:\n\n1. Appendix B.6: BE3 Installer (VBA_macro.exe, Sample 1)\n(MD5: ac2d7f21c826ce0c449481f79138aebd)\n\n_y._ _A sample of this file was not recovered. The technical notes provided are based on the cited reporting._\n\n_z._ _A sample of this file was not recovered. The technical notes provided are based on the cited reporting._\n\n|APPENDIX B.1:  WEAPONIZED MS EXCEL (ДОДАТОК1.XLS)y|Col2|\n|---|---|\n|SHA1: aa67ca4fb712374f5301d1d2bab0ac66107a4df1||\n|SHA-256: 052ebc9a518e5ae02bbd1bd3a5a86c3560aefc9313c18d81f6670c3430f1d4d4||\n|MD5: 97b7577d13cf5e3bf39cbe6d3f0a7732||\n|Type: Microsoft Office Excel180|First Upload: 2015-08-03 10:37:19181|\n|Compile Timestamp: 2015-02-04 07:35:08182|Final Modification Timestamp: 2015-03-18 07:41:04183|\n|File Size: 734720 bytes184|Language Settings: Code_page is Cyrillic185|\n|File Names: Додаток1.xls186||\n|Technical Notes: This is a weaponized MS Excel file used to deliver BE3 malware.187 Upon opening the file, users are prompted to enable macros. The spreadsheet includes an embedded VBA macro that executes when users enable the macro functionality. The associated VBA macro is a BE3 installer.188||\n|Related Samples: 1. Appendix B.4: BE3 Installer (VBA_macro.exe, Sample 2) (MD5: abeab18ebae2c3e445699d256d5f5fb1) 2. Appendix B.6: Dropbear Installer (DropbearRun.vbs) (MD5: 0af5b1e8eaf5ee4bd05227bf53050770)189||\n\n|APPENDIX B.2:  WEAPONIZED MS WORD ($RR143TB.DOC)z|Col2|\n|---|---|\n|SHA1: 28719979d7ac8038f24ee0c15114c4a463be85fb||\n|SHA-256: 39d04828ab0bba42a0e4cdd53fe1c04e4eef6d7b26d0008bd0d88b06cc316a81||\n|MD5: e15b36c2e394d599a8ab352159089dd2||\n|Type: Microsoft Office Word190|First Upload: 2016-01-20 08:03:52 UTC191|\n|Compile Timestamp: 2015-07-27 10:21:00192|Final Modification Timestamp: 2015-07-27 10:21:00193|\n|File Size: 1194496 bytes|Language Settings: Code_page is Cyrillic194|\n|File Names: $RR143TB.doc195||\n|Technical Notes: This is a weaponized MS Word file, with an embedded BE3 installer.196 Upon opening the file, users are prompted to enable macros, allowing the execution of the BE3 installer.197 Additional details on the infection routine are provided in Appendix B.6: BE3 Installer (VBA_macro.exe, Sample 1).||\n|Related Samples: 1. Appendix B.6: BE3 Installer (VBA_macro.exe, Sample 1) (MD5: ac2d7f21c826ce0c449481f79138aebd)||\n\n\nboozallen.com/ics     39\n\n\n-----\n\n**MALWARE INSTALLERS**\nIn an analysis of a weaponized MS Excel file[aa] first\nobserved in August 2015 and most recently\nreported in January 2015, BE3 malware was found\nembedded in VB code attached as a macro title:\n“M 609230 ‘_VBA_PROJECT_CUR/VBA/\nWorkbook________”.[198] By using weaponized\nmacros as the attack vector, the threat actors were\nreliant on users actively enabling macros before\nthey could execute. Samples of the malicious VBA\nscripts recovered are detailed in Appendix B.3 and\nAppendix B.4.\n\n_aa._ _Analysis details for this sample provided in Appendix B.1._\n\n\nFollowing delivery, users enabled macros in the\nweaponized document, allowing the embedded\nmacros to execute. The executable calls\nENVIRON(‘TMP’) and saves the file, vba_macro.\nexe in the Widows TMP directory.[199] Once saved to\ndisk, the file drops FONTCACHE.DAT (which is a\ndynamic-link library file), rundll32.exe (which is the\nstandard utility for running .dll files on machines\nwith Windows operating system [OS]), NTUSER.\nLOG (which is an empty file) and desktop.ini, the\ndefault file used to determine folder displays on\nwindows machines.[200]\n\nFONTCACHE.DAT serves as the primary BE3\nimplant, and as noted above, some observed\nsamples have been packed with the tElock packer.\nFONTCACHE.DAT is dropped into the local\napplication data folder, and a .lnk file is created in\nthe startup folder, which functions as a shortcut to\nexecute using rundll32.exe.[201] The .lnk file name is\ngenerated off the volume serial number.[ab,202,203]\nFollowing delivery of FONTCACHE.DAT, and the\nassociated .lnk file, the original executable,\nvba_macro.exe, is deleted.[204]\n\n\n_ab._ _An example path for the .lnk file would be: C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\_\n40 Booz Allen Hamilton _Startup\\{9980061D-64BB-46BC-8AC6-D9AC3DB67577}.lnk_\n\n\n-----\n\nAPPENDIX B.3:\n\n###### BE3 INSTALLER (VBA_MACRO.EXE, SAMPLE 1)\n\n|BE3 INSTALLER (VBA_MACRO.EXE, SAMPLE 1)|Col2|\n|---|---|\n|SHA1: 4184888c26778f5596d6e8d83624512ed2f045dd||\n|SHA-256: ca7a8180996a98e718f427837f9d52453b78d0a307e06e1866db4d4ce969d525||\n|MD5: ac2d7f21c826ce0c449481f79138aebd||\n|Type: Win32 Executable205|First Upload: 2016-01-29 01:59:28 UTC206|\n|Compile Timestamp: 1979-01-28 00:25:53207|Final Modification Timestamp: Undisclosed|\n|File Size: 110592 bytes208|Language Settings: Japanese209|\n|File Names:210 CPLEXE.EXE (original name) MS-IME (Internal Name) virus_04.exe vba_macro.exe||\n|Technical Notes: At execution: 1. The installer drops a .dll file at C:\\Documents and Settings\\useradm\\Local Settings\\ Application Data\\FONTCACHE.DAT (size 56,832) 2. And installs persistence: a. C:\\Documents and Settings\\useradm\\Start Menu\\Programs\\Startup\\{C323A392-5BB0- 47D5-9518-E60202A85B5C}.lnk (size 1,682) 3. Weakens Internet settings in registry to lower Internet security: a. HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ ProxyBypass (sets to 1) b. HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ IntranetName (sets to 1) c. HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ UNCAsIntranet (sets to 1) 4. It launches (in this case PID: 936) Command line: “C:\\WINDOWS\\system32\\rundll32.exe” “C:\\Documents and Settings\\useradm\\Local Settings\\Application Data\\FONTCACHE. DAT”,#1 a. Further weakening Internet Explorer settings: i. HKCU\\Software\\Microsoft\\Internet Explorer\\PhishingFilter\\Enabled (sets to 0) ii. HKCU\\Software\\Microsoft\\Internet Explorer\\Recovery\\NoReopenLastSession (sets to 1) iii. HKCU\\Software\\Microsoft\\Internet Explorer\\Main\\NoProtectedModeBanner (sets to 1) iv. [Amongst some other I.E. settings] b. And loads BE into “svchost.exe -DcomLaunch”||\n\n\nboozallen.com/ics     41\n\n\n-----\n\nAPPENDIX B.4:\nBE3 INSTALLER (VBA_MACRO.EXE, SAMPLE 2)\n\n|APPENDIX B.4:  BE3 INSTALLER (VBA_MACRO.EXE, SAMPLE 2)|Col2|\n|---|---|\n|SHA1: 4c424d5c8cfedf8d2164b9f833f7c631f94c5a4c||\n|SHA-256: 07e726b21e27eefb2b2887945aa8bdec116b09dbd4e1a54e1c137ae8c7693660||\n|MD5: abeab18ebae2c3e445699d256d5f5fb1||\n|Type: Win32 Executable211|First Upload: 2015-08-03 10:37:19212|\n|Compile Timestamp: 1979-01-28 00:25:53213|Final Modification Timestamp: Undisclosed|\n|File Size: 98304 bytes214|Language Settings: Japanese215|\n|File Names:216 vba_macro MS-IME icshextobin.exe BlackEnergy.exe vba_macro.exe CPLEXE.EXE 1.exe||\n\n\n42 Booz Allen Hamilton\n\n\n-----\n\nboozallen.com/ics     43\n\n\n-----\n\nAPPENDIX B.5:\n\n###### BE2 INSTALLER (UNDISCLOSED)\n\n|BE2 INSTALLER (UNDISCLOSED)|Col2|\n|---|---|\n|SHA1: 896fcacff6310bbe5335677e99e4c3d370f73d96||\n|SHA-256: 07a76c1d09a9792c348bb56572692fcc4ea5c96a77a2cddf23c0117d03a0dfad||\n|MD5: 1d6d926f9287b4e4cb5bfc271a164f51||\n|Type: Win32 Executable217|First Upload: 2015-10-11 04:17:36 UTC218|\n|Compile Timestamp: 0000:00:00 00:00:00219|Final Modification Timestamp: Undisclosed|\n|File Size: 155648 bytes220|Language Settings: English221|\n|File Names: Undisclosed||\n|Technical Notes: This is a BE2 dropper, installer, and RAT bundle. It is either a modified Cyberlink PowerDVD 10 binary or is designed to look like one during string analysis. The installer appears to be packed, possibly with tElock. The associated implant is packed with tElock 0.99. This bundle includes an encrypted file, which is likely the configuration file stored on disk. Infection Routine: 1. Installer 1d6d926f9287b4e4cb5bfc271a164f51.exe (in this case PID 596) executes 2. Installer creates file c:\\windows\\adpu160ms then pings localhost “-n 2” (effectively a 2 second sleep) 3. Installer pings localhost “-n 3” (effectively a 3 second sleep) 4. Installer launches a cmd.exe (in this case PID 880) with the following command line: a. PID: 880, Command line: /c “ping localhost –n 8 & move /Y “C:\\WINDOWS\\adpu160ms” “C:\\WINDOWS\\system32\\drivers\\adpu160m.sys” & ping localhost –n 3 & net start adpu160m” 5. Services.exe (in this case PID 768) writes the registry keys for apdu160m and loads adpu160m.sys into “svchost.exe –DcomLaunch” (in this case PID 988)||\n\n\n44 Booz Allen Hamilton\n\n\n-----\n\nAPPENDIX B.6:\nDROPBEAR INSTALLER (DROPBEARRUN.VBS) [ac]\n\nSHA1: 72d0b326410e1d0705281fde83cb7c33c67bc8ca\n\nSHA-256: b90f268b5e7f70af1687d9825c09df15908ad3a6978b328dc88f96143a64af0f\n\nMD5: 0af5b1e8eaf5ee4bd05227bf53050770\n\nType: ASCII text[222] First Upload: 2015-10-13 10:51:25 UTC\n\nCompile Timestamp: Final Modification Timestamp:\nUndisclosed 2015-03-17 06:41:04 UTC+0[224]\n\nFile Size: 165 bytes[225] Language Settings: Undisclosed\n\nFile Names:\nDropbearRun.vbs[226]\nVBS/Agent.AD trojan[227]\n\nTechnical Notes:\nThis script launches the Dropbear SSH server from directory C:\\\\WINDOWS\\TEMP\\DROPBEAR\\,\nand sets the server to listen on port 6789.[228]\n\nThe modified version of the Dropbear server includes two backdoors, a hardcoded public key\nauthentication process, and a hardcoded username and password.[229 ]\n\nRelated Samples:\n\n1. Appendix B.4: BE3 Installer (VBA_macro.exe, Sample 2)\n(MD5: abeab18ebae2c3e445699d256d5f5fb1)\n\n2. Appendix B.13: Dropbear Implant (Dropbear.exe)\n(fffeaba10fd83c59c28f025c99d063f8)\n\n_ac._ _A sample of this file was not recovered. The technical notes provided are based on the cited reporting._\n\n|APPENDIX B.6:  DROPBEAR INSTALLER (DROPBEARRUN.VBS)ac|Col2|\n|---|---|\n|SHA1: 72d0b326410e1d0705281fde83cb7c33c67bc8ca||\n|SHA-256: b90f268b5e7f70af1687d9825c09df15908ad3a6978b328dc88f96143a64af0f||\n|MD5: 0af5b1e8eaf5ee4bd05227bf53050770||\n|Type: ASCII text222|First Upload: 2015-10-13 10:51:25 UTC223|\n|Compile Timestamp: Undisclosed|Final Modification Timestamp: 2015-03-17 06:41:04 UTC+0224|\n|File Size: 165 bytes225|Language Settings: Undisclosed|\n|File Names: DropbearRun.vbs226 VBS/Agent.AD trojan227||\n|Technical Notes: This script launches the Dropbear SSH server from directory C:\\\\WINDOWS\\TEMP\\DROPBEAR\\, and sets the server to listen on port 6789.228 The modified version of the Dropbear server includes two backdoors, a hardcoded public key authentication process, and a hardcoded username and password.229||\n|Related Samples: 1. Appendix B.4: BE3 Installer (VBA_macro.exe, Sample 2) (MD5: abeab18ebae2c3e445699d256d5f5fb1) 2. Appendix B.13: Dropbear Implant (Dropbear.exe) (fffeaba10fd83c59c28f025c99d063f8)||\n\n\nboozallen.com/ics     45\n\n\n-----\n\n**PERSISTENT MALWARE IMPLANTS**\nAfter dropping FONTCACHE.DAT into the\napplication data directory and inserting the\nassociated .lnk file in the startup directory, the\ninstaller takes steps to modify the Internet security\nsetting and initiate the process of connecting to\nthe command-and-control (CC) server. The\ninstaller first modifies in-registry Internet settings\nto lower the Internet security, then uses rundll32.\nexe to launch FONTCACHE.DAT, which in turn\nfurther weakens Internet security settings,\nspecifically targeting MS Internet Explorer.\nFONTCACHE.DAT is then loaded into svchost.exe,\nthe standard process used for hosting services\nrunning off .dll files, which then launches\niexploerer.exe and attempts to use Internet\nExplorer to establish an HTTP connection with an\nexternal host.[ad] In the analyzed sample, the\nimplant attempted to connect to IP address\n5.149.254.114.[ae] This IP address was identified as a\npotential CC server in other BE3 analysis\nreporting.[230]\n\n\nCommunications between the infected host and\nthe CC server are conducted using HTTP POST\nrequests.[231] During the initiation of the connec­\ntion, BE3 requests will contain fields such as a\nSHA1 hash of the bot_id, domain security\nidentifier (SID), host name and serial number, as\nwell as build_id from the samples configuration\ndata, and a series of hardcoded values repre­\nsenting the associated version number.[232] The CC\nserver then sends a decrypted response as a\nseries of 509_ASN encoded values.[233]\n\nIn the initial POST request sent to the CC server,\nthe hashed build_id is a unique text string\nassociated with each individual infection.[234,235]\nThese build_ids, as well as a list of the CC servers,\nare stored in the embedded configuration data\nwithin the binary of the .dll implant.[236] Publicly\nreported analysis of the BE3 samples indicate that\nat least 12 build_ids had been identified in 2015,\nand the strings included in the build_ids are likely\nsignificant.[237] The 12 build_ids recovered in 2015\nincluded strings such as “kiev_o” and\n“2015telsmi,” and the authors of the report\nspeculate “SMI” is an acronym representing\nSredstva Massovoj Informacii.[238] Sredstva\nMassovoj Informacii (Срéдства массовой\nинформации) is the Russian term for mass\nmedia, which may be referring to the attack on the\nUkrainian media outlet in October 2015.\n\n\n_ad._ _This summary is based on the infection routine observed in VBA_macro.exe, Sample 1. Additional details on specific setting_\n_modifications can be found the full infection routine summary in Appendix B.4: BE3 Installer (VBA_macro.exe, Sample 1)._\n\n_ae._ _This summary is based on the infection routine observed in VBA_macro.exe, Sample 1. Additional details on specific setting_\n_modifications can be found the full infection routine summary in Appendix B.4: BE3 Installer (VBA_macro.exe, Sample 1)._\n46 Booz Allen Hamilton\n\n\n-----\n\nAPPENDIX B.7:\nBE3 IMPLANT (FONTCACHE.DAT, SAMPLE 1)\n\n|APPENDIX B.7:  BE3 IMPLANT (FONTCACHE.DAT, SAMPLE 1)|Col2|\n|---|---|\n|SHA1: 899baab61f32c68cde98db9d980cd4fe39edd572||\n|SHA-256: ef380e33a854ef9d9052c93fc68d133cfeaae3493683547c2f081dc220beb1b3||\n|MD5: 3fa9130c9ec44e36e52142f3688313ff||\n|Type: Win32 Dynamic Link Library239|First Upload: 2015-10-13 10:51:25 UTC240|\n|Compile Timestamp: 1979-01-28 00:25:53241|Final Modification Timestamp: 1979:01:28 01:25:53+01:00242|\n|File Size: 56832 bytes243|Language Settings:244 Neutral English US|\n|File Names:245 FONTCACHE.DLL FONTCACHE.DAT.174093.DROPPED FONTCACHE.DAT packet.dll||\n|Technical Notes: This is the implant file associated with Appendix B.3: BE3 Installer (VBA_macro.exe, Sample 1). Full infection routine details are provided in Appendix B.3: BE3 Installer (VBA_macro.exe, Sample 1).||\n|Related Samples: 1. Appendix B.3: BE3 Installer (VBA_macro.exe, Sample 1) (MD5: ac2d7f21c826ce0c449481f79138aebd)||\n\n\nboozallen.com/ics     47\n\n\n-----\n\nAPPENDIX B.8:\nBE3 IMPLANT (FONTCACHE.DAT, SAMPLE 2)\n\nSHA1: 315863c696603ac442b2600e9ecc1819b7ed1b54\n\nSHA-256: f5785842682bc49a69b2cbc3fded56b8b4a73c8fd93e35860ecd1b9a88b9d3d8\n\nMD5: cdfb4cda9144d01fb26b5449f9d189ff\n\nType: Win32 Dynamic Link Library[246] First Upload: 2015-07-27 13:17:32[247]\n\nCompile Timestamp: Final Modification Timestamp:\n1979-01-28 00:25:53[248] 1979-01-28 00:25:53[249]\n\nFile Size: 55808 bytes[250] Language Settings:[251\n]\n\nNeutral\nEnglish US\n\nFile Names:[252]\nFONTCACHE.DAT\n63.dll\npacket.dll\n\nTechnical Notes:\nThis is the implant file associated with Appendix B.4: BE3 Installer\n(VBA_macro.exe, Sample 2).\n\nFull infection routine details are provided in Appendix B.4: BE3 Installer\n(VBA_macro.exe, Sample 2).\n\nRelated Samples:\n\n1. Appendix B.4: BE3 Installer (VBA_macro.exe, Sample 2)\n(MD5: abeab18ebae2c3e445699d256d5f5fb1\n\n2. Appendix B.10: BE3 Implant (.LNK Persistence Mechanism, Sample 2)\n(MD5: bffd06a38a46c1fe2bde0317176f04b8)\n\nAPPENDIX B.9:\nBE3 IMPLANT (.LNK PERSISTENCE MECHANISM, SAMPLE 1) [af]\n\nSHA1: f89ce5ba8e7b8587457848182ff1108b1255b87f\n\nSHA-256: 2872473b7144c2fb6910ebf48786c49f9d4f46117b9d2aaa517450fce940d0da\n\nMD5: 40c74556c36fa14664d9059ad05ca9d3\n\nType: Microsoft Windows LiNK First Upload: Not Submitted\n\nCompile Timestamp: Final Modification Timestamp:\nNot Submitted Not Submitted\n\nFile Size: 1682 bytes Language Settings: Not Submitted\n\nFile Names: Not Submitted\n\n_af._ _This is an embedded file dropped during malware execution. This file was not publicly reported as an independent malware_\n_sample. “Not Submitted” is listed in fields that would otherwise have been populated with data from public sources._\n\n|APPENDIX B.8:  BE3 IMPLANT (FONTCACHE.DAT, SAMPLE 2)|Col2|\n|---|---|\n|SHA1: 315863c696603ac442b2600e9ecc1819b7ed1b54||\n|SHA-256: f5785842682bc49a69b2cbc3fded56b8b4a73c8fd93e35860ecd1b9a88b9d3d8||\n|MD5: cdfb4cda9144d01fb26b5449f9d189ff||\n|Type: Win32 Dynamic Link Library246|First Upload: 2015-07-27 13:17:32247|\n|Compile Timestamp: 1979-01-28 00:25:53248|Final Modification Timestamp: 1979-01-28 00:25:53249|\n|File Size: 55808 bytes250|Language Settings:251 Neutral English US|\n|File Names:252 FONTCACHE.DAT 63.dll packet.dll||\n|Technical Notes: This is the implant file associated with Appendix B.4: BE3 Installer (VBA_macro.exe, Sample 2). Full infection routine details are provided in Appendix B.4: BE3 Installer (VBA_macro.exe, Sample 2).||\n|Related Samples: 1. Appendix B.4: BE3 Installer (VBA_macro.exe, Sample 2) (MD5: abeab18ebae2c3e445699d256d5f5fb1 2. Appendix B.10: BE3 Implant (.LNK Persistence Mechanism, Sample 2) (MD5: bffd06a38a46c1fe2bde0317176f04b8)||\n\n|APPENDIX B.9:  BE3 IMPLANT (.LNK PERSISTENCE MECHANISM, SAMPLE 1)af|Col2|\n|---|---|\n|SHA1: f89ce5ba8e7b8587457848182ff1108b1255b87f||\n|SHA-256: 2872473b7144c2fb6910ebf48786c49f9d4f46117b9d2aaa517450fce940d0da||\n|MD5: 40c74556c36fa14664d9059ad05ca9d3||\n|Type: Microsoft Windows LiNK|First Upload: Not Submitted|\n|Compile Timestamp: Not Submitted|Final Modification Timestamp: Not Submitted|\n|File Size: 1682 bytes|Language Settings: Not Submitted|\n|File Names: Not Submitted||\n\n\n48 Booz Allen Hamilton\n\n\n-----\n\nAPPENDIX B.10:\nBE3 IMPLANT (.LNK PERSISTENCE MECHANISM, SAMPLE 2) [ag]\n\nSHA1: 3feb426ac934f60eee4e08160d9c8bbe926c917e\n\nSHA-256: 22735ffeb3472572f608e9a2625ec91735482d9423ea7a43ed32f8a39308eda8\n\nMD5: bffd06a38a46c1fe2bde0317176f04b8\n\nType: Microsoft Windows LiNK First Upload: Not Submitted\n\nCompile Timestamp: Final Modification Timestamp:\nNot Submitted Not Submitted\n\nFile Size: 1682 bytes Language Settings: Not Submitted\n\nFile Names: Not Submitted\n\nTechnical Notes:\nThis is the shortcut file inserted in the startup folder and used to launch the FONTCACHE.DAT\nimplant.\n\nFull infection routine details associated with this file are provided in Appendix B.4: BE3 Installer\n(VBA_macro.exe, Sample 2).\n\nRelated Samples:\n\n1. Appendix B.4: BE3 Installer (VBA_macro.exe, Sample 2)\n(MD5: abeab18ebae2c3e445699d256d5f5fb1)\n\n2. Appendix B.9: BE3 Implant (FONTCACHE.DAT, Sample 2)\n(MD5:cdfb4cda9144d01fb26b5449f9d189ff)\n\n_ag._ _This is an embedded file dropped during malware execution. This file was not publicly reported as an independent malware_\n_sample. “Not Submitted” is listed in fields that would otherwise have been populated with data from public sources._\n\n|APPENDIX B.10:  BE3 IMPLANT (.LNK PERSISTENCE MECHANISM, SAMPLE 2)ag|Col2|\n|---|---|\n|SHA1: 3feb426ac934f60eee4e08160d9c8bbe926c917e||\n|SHA-256: 22735ffeb3472572f608e9a2625ec91735482d9423ea7a43ed32f8a39308eda8||\n|MD5: bffd06a38a46c1fe2bde0317176f04b8||\n|Type: Microsoft Windows LiNK|First Upload: Not Submitted|\n|Compile Timestamp: Not Submitted|Final Modification Timestamp: Not Submitted|\n|File Size: 1682 bytes|Language Settings: Not Submitted|\n|File Names: Not Submitted||\n|Technical Notes: This is the shortcut file inserted in the startup folder and used to launch the FONTCACHE.DAT implant. Full infection routine details associated with this file are provided in Appendix B.4: BE3 Installer (VBA_macro.exe, Sample 2).||\n|Related Samples: 1. Appendix B.4: BE3 Installer (VBA_macro.exe, Sample 2) (MD5: abeab18ebae2c3e445699d256d5f5fb1) 2. Appendix B.9: BE3 Implant (FONTCACHE.DAT, Sample 2) (MD5:cdfb4cda9144d01fb26b5449f9d189ff)||\n\n\nboozallen.com/ics     49\n\n\n-----\n\nAPPENDIX B.11:\nBE2 IMPLANT (ADPU160M.SYS)\n\nSHA1: 4bc2bbd1809c8b66eecd7c28ac319b948577de7b\n\nSHA-256: 244dd8018177ea5a92c70a7be94334fa457c1aab8a1c1ea51580d7da500c3ad5\n\nMD5: e60854c96fab23f2c857dd6eb745961c\n\nType: Win32 Executable[253] First Upload: 2015-10-09 16:26:08 UTC[254]\n\nCompile Timestamp: Final Modification Timestamp:\nNot Submitted 0000:00:00 00:00:00[255]\n\nFile Size: 60928 bytes[256] Language Settings: English[257]\n\nFile Names:[258]\nFILE_208\nacpipmi.sys\naliides.sys\n\nTechnical Notes:\nThis is the implant file associated with Appendix B.5: BE2 Installer (Undisclosed). The name is listed\nhere (adpu160m.sys) is taken from a legitimate, unused driver on the system, and will potentially\nvary between executions.\n\nFull infection routine details are provided in Appendix B.5: BE2 Installer (Undisclosed).\n\nRelated Samples:\n\n3. Appendix B.5: BE2 Installer (Undisclosed)\n(MD5: 1d6d926f9287b4e4cb5bfc271a164f51)\n\n4. Appendix B.12: Encrypted Configuration/On-disk-store (ieapflrt.dat)\n(MD5: 01215f813d3e93ed7e3fc3fe369a6cd5)\n\nAPPENDIX B.12:\nBE3 ENCRYPTED CONFIGURATION/ON-DISK-STORE (IEAPFLRT.DAT) [ah]\n\nSHA1: 63bf25190139bd307290c301304597bdeffa4351\n\nSHA-256: ad2e333141e4e7a800d725f06e25a58a683b42467645d65ba5a1cf377b4adcbe\n\nMD5: 01215f813d3e93ed7e3fc3fe369a6cd5\n\nType: Not Submitted First Upload: Not Submitted\n\nCompile Timestamp: Not Submitted Final Modification Timestamp: Not Submitted\n\nFile Size: Not Submitted Language Settings: Not Submitted\n\nFile Names: Not Submitted\n\nTechnical Notes:\nThis is the encrypted configuration and on-disk-store file associated with Appendix B.5: BE2 Installer\n(Undisclosed).\n\nFull infection routine details are provided in Appendix B.5: BE2 Installer (Undisclosed).\n\n_ah._ _This is an embedded file dropped during malware execution. This file was not publicly reported as an independent malware_\n50 Booz Allen Hamilton _sample. “Not Submitted” is listed in fields that would otherwise have been populated with data from public sources._\n\n|APPENDIX B.11:  BE2 IMPLANT (ADPU160M.SYS)|Col2|\n|---|---|\n|SHA1: 4bc2bbd1809c8b66eecd7c28ac319b948577de7b||\n|SHA-256: 244dd8018177ea5a92c70a7be94334fa457c1aab8a1c1ea51580d7da500c3ad5||\n|MD5: e60854c96fab23f2c857dd6eb745961c||\n|Type: Win32 Executable253|First Upload: 2015-10-09 16:26:08 UTC254|\n|Compile Timestamp: Not Submitted|Final Modification Timestamp: 0000:00:00 00:00:00255|\n|File Size: 60928 bytes256|Language Settings: English257|\n|File Names:258 FILE_208 acpipmi.sys aliides.sys||\n|Technical Notes: This is the implant file associated with Appendix B.5: BE2 Installer (Undisclosed). The name is listed here (adpu160m.sys) is taken from a legitimate, unused driver on the system, and will potentially vary between executions. Full infection routine details are provided in Appendix B.5: BE2 Installer (Undisclosed).||\n|Related Samples: 3. Appendix B.5: BE2 Installer (Undisclosed) (MD5: 1d6d926f9287b4e4cb5bfc271a164f51) 4. Appendix B.12: Encrypted Configuration/On-disk-store (ieapflrt.dat) (MD5: 01215f813d3e93ed7e3fc3fe369a6cd5)||\n\n|APPENDIX B.12:  BE3 ENCRYPTED CONFIGURATION/ON-DISK-STORE (IEAPFLRT.DAT)ah|Col2|\n|---|---|\n|SHA1: 63bf25190139bd307290c301304597bdeffa4351||\n|SHA-256: ad2e333141e4e7a800d725f06e25a58a683b42467645d65ba5a1cf377b4adcbe||\n|MD5: 01215f813d3e93ed7e3fc3fe369a6cd5||\n|Type: Not Submitted|First Upload: Not Submitted|\n|Compile Timestamp: Not Submitted|Final Modification Timestamp: Not Submitted|\n|File Size: Not Submitted|Language Settings: Not Submitted|\n|File Names: Not Submitted||\n|Technical Notes: This is the encrypted configuration and on-disk-store file associated with Appendix B.5: BE2 Installer (Undisclosed). Full infection routine details are provided in Appendix B.5: BE2 Installer (Undisclosed).||\n\n\n-----\n\nAPPENDIX B.13:\nMODIFIED DROPBEAR SERVER IMPLANT (DROPBEAR.EXE) [ai]\n\nSHA1: 166d71c63d0eb609c4f77499112965db7d9a51bb\n\nSHA-256: 0969daac4adc84ab7b50d4f9ffb16c4e1a07c6dbfc968bd6649497c794a161cd\n\nMD5: fffeaba10fd83c59c28f025c99d063f8\n\nType: Win32 Executable[259] First Upload: 2015-06-25 09:16:03[260]\n\nCompile Timestamp: Final Modification Timestamp:\n2013-12-10 06:08:44[261] 2013:12:10 07:08:44+01:00[262]\n\nFile Size: 303152 bytes Language Settings: Undisclosed\n\nFile Names:\ndropbear.exe[263]\nWin32/SSHBearDoor.A trojan[264]\n\nTechnical Notes:\nThis file is the Dropbear server program. Analysis identified that this Dropbear binary code was\nmodified from its source code to include a backdoor and authentication processes.[265] The first\nauthentication process uses a hardcoded credential set of “user” and “passDs5Bu9Te7” and the\nsecond process uses a RSA public key.[266]\n\nRelated Samples:\n\n1. Appendix B.1: Weaponized MS Excel (Додаток1.xls)\n(MD5: 97b7577d13cf5e3bf39cbe6d3f0a7732)\n\n2. Appendix B.6: Dropbear Installer (DropbearRun.vbs)\n(MD5: 0af5b1e8eaf5ee4bd05227bf53050770)\n\n_ai._ _A sample of this file was not recovered. The technical notes provided are based on the cited reporting._\nboozallen.com/ics     51\n\n|APPENDIX B.13:  MODIFIED DROPBEAR SERVER IMPLANT (DROPBEAR.EXE)ai|Col2|\n|---|---|\n|SHA1: 166d71c63d0eb609c4f77499112965db7d9a51bb||\n|SHA-256: 0969daac4adc84ab7b50d4f9ffb16c4e1a07c6dbfc968bd6649497c794a161cd||\n|MD5: fffeaba10fd83c59c28f025c99d063f8||\n|Type: Win32 Executable259|First Upload: 2015-06-25 09:16:03260|\n|Compile Timestamp: 2013-12-10 06:08:44261|Final Modification Timestamp: 2013:12:10 07:08:44+01:00262|\n|File Size: 303152 bytes|Language Settings: Undisclosed|\n|File Names: dropbear.exe263 Win32/SSHBearDoor.A trojan264||\n|Technical Notes: This file is the Dropbear server program. Analysis identified that this Dropbear binary code was modified from its source code to include a backdoor and authentication processes.265 The first authentication process uses a hardcoded credential set of “user” and “passDs5Bu9Te7” and the second process uses a RSA public key.266||\n|Related Samples: 1. Appendix B.1: Weaponized MS Excel (Додаток1.xls) (MD5: 97b7577d13cf5e3bf39cbe6d3f0a7732) 2. Appendix B.6: Dropbear Installer (DropbearRun.vbs) (MD5: 0af5b1e8eaf5ee4bd05227bf53050770)||\n\n\n-----\n\n**KILLDISK SAMPLES**\nFive KillDisk samples were recovered\nand analyzed for this report. Two of the samples[a­]\n\nj,ak drop a file “C:\\windows\\svchost.exe” and create\na process “C:\\WINDOWS\\svchost.exe –service,”\nwhich runs as a child of services.exe. The process\noverwrites the first 131072 bytes of\n\\Device\\Harddisk0\\DR0 with zeros, effectively\nrendering the OS unusable upon reboot. The\ninfected machine then sustains a critical error,\ndisplays a blue screen of death, and reboots with\nthe message “Operating System not found.” A\nthird observed sample[al] executes nearly identically,\nthough the sample runs as its own process as\nopposed to dropping an embedded file onto the\ntargeted system to overwrite the data.\n\nA key point of variance between recovered\nsamples is the level of additional data destruction\n\n\nbeyond overwriting the master boot record.\nThough all samples ultimately rendered the\nmachines inoperable, in the samples[am,an]\ndescribed above, a critical system error and forced\nreboot occurred without overwriting any additional\ndata on disk. This indicates that valuable data\nstored on the device may be recoverable, even if\nthe machine itself is inoperable.\n\nTwo other analyzed samples[ao,ap] included\nadditional data destruction beyond the MBR. The\nfirst[aq] runs as its own process and overwrites the\nfirst 131072 bytes of\n\\Device\\Harddisk0\\DR0 with spaces, rendering\nthe OS unusable upon reboot. The sample then\ncontinues to overwrite thousands of files while the\nsystem remains powered on but unusable. The\nother sample follows a nearly identical execution,\nthough it runs as a child process to services.exe\n\n\n_aj._ _Appendix B.14: KillDisk (Sample 1) (MD5: 108fedcb6aa1e79eb0d2e2ef9bc60e7a)_\n\n_ak._ _Appendix B.14: KillDisk (Sample 2) (MD5: 72bd40cd60769baffd412b84acc03372)_\n\n_al._ _Appendix B.16: KillDisk (Sample 3) (MD5: 7361b64ddca90a1a1de43185bd509b64)_\n\n_am.  Appendix B.14: KillDisk (Sample 1) (MD5: 108fedcb6aa1e79eb0d2e2ef9bc60e7a)_\n\n52 Booz Allen Hamilton\n_A_ _di B_ _KillDi k (S_ _l_ _) (MD_ _d_ _88 f_ _f b8bb6 f d f_ _ddf )_\n\n\n-----\n\nand also drops hundreds of 5-byte .tmp files in C:\\\nwindows\\temp\\ with incrementing numeric file\nnames.\n\nPublic reporting indicates that some observed\nKillDisk samples would not execute properly in\nmalware sandboxes, requiring analysts to conduct\nstatic analysis.[267] This could possibly indicate\nfunctionality to identify the use of malware\nsandboxes, a feature that would be included to\nhinder forensic analysis. In initial analysis of one of\nthe recovered samples,[ar] analysts found it would\nnot run in a Windows XP virtual machine, though\npatching with Ollydbg corrected this issue. This\nmay have been the same issue discussed by other\nanalysts encountered.\n\nAt least one machine destroyed by KillDisk was\nfunctioning as a remote terminal unit (RTU), and\nsome public reporting indicated that a process\n\n\nexecuted by the malware (sec_service.exe) may\nhave been a standard process in several applica­\ntions used in control environments.[268] Despite\nthis, specific targeting of industrial control\nsystems (ICS) devices was not a behavior\nobserved in any of the KillDisk samples analyzed.\nThe samples observed did not include inherent\nfeatures to discover ICS components, and the\nreported disk destruction against the RTU was\nlikely accomplished by the threat actors, actively\ndelivering the malware to the targeted system.\n\nIn addition to targeting the electricity distributors\nin December 2015, several of the KillDisk samples\nanalyzed for this report were also reported in\nattacks against a Ukrainian railway operator[as] and\nUkrainian mining company[at,au] in November and\nDecember 2015.[269]\n\n\n_ao._ _Appendix B.18: KillDisk (Sample 5) (MD5: 66676deaa9dfe98f8497392064aefbab)_\n\n_ap._ _Appendix B.16: KillDisk (Sample 3) (MD5: 7361b64ddca90a1a1de43185bd509b64)_\n\n_aq._ _Appendix B.18: KillDisk (Sample 5) (MD5: 66676deaa9dfe98f8497392064aefbab)_\n\n_ar._ _Appendix B.16: KillDisk (Sample 3) (MD5: 7361b64ddca90a1a1de43185bd509b64)_\n\n_as._ _Ibid_\n\n_at._ _Appendix B.15: KillDisk (Sample 2) (MD5: 72bd40cd60769baffd412b84acc03372)_\n\n_d_ _ll_ _k_ _l_ _d_ _f_ _f b bb_ _f d f_ _ddf_\n\n\nboozallen.com/ics     53\n\n\n-----\n\nAPPENDIX B.14:\nKILLDISK (SAMPLE 1)\n\nSHA1:\n\nSHA-256:\n\nMD5: 108fedcb6aa1e79eb0d2e2ef9bc60e7a\n\nType: Win32 Executable[270]\n\nCompile Timestamp:\n2015-10-24 18:19:30[272]\n\nFile Size: 110592 bytes[274]\n\nFile Names:\n1.1[276]\n\nTechnical Notes:\n\nbe recoverable.\n\nExecution Routine:\n\n“msDefenderSvc”.\n\nDropped files include:\nc:\\windows\\svchost.exe\n\nRelated Samples:\n\nN/A\n\nAPPENDIX B.15:\nKILLDISK (SAMPLE 2)\n\n|APPENDIX B.14:  KILLDISK (SAMPLE 1)|Col2|\n|---|---|\n|SHA1: aa0aaa7002bdfe261ced99342a6ee77e0afa2719||\n|SHA-256: 30862ab7aaa6755b8fab0922ea819fb48487c063bea4a84174afbbd65ce26b86||\n|MD5: 108fedcb6aa1e79eb0d2e2ef9bc60e7a||\n|Type: Win32 Executable270|First Upload: 2016-03-22 11:54:29 UTC271|\n|Compile Timestamp: 2015-10-24 18:19:30272|Final Modification Timestamp: 2015:10:24 19:19:30+01:00273|\n|File Size: 110592 bytes274|Language Settings: English US275|\n|File Names: 1.1276||\n|Technical Notes: This KillDisk sample executes a destructive disk overwrite function. Following execution, data may be recoverable. Execution Routine: 1. Shortly after running, the executable creates a process “C:\\WINDOWS\\svchost.exe -service” that runs as a child of services.exe; it runs in such fashion because it is installed as service “msDefenderSvc”. 2. The executable then overwrites (with zeros) the first 131072 bytes of \\Device\\Harddisk0\\DR0, effectively rendering the OS unusable upon reboot. 3. While running, the machine sustains a critical error, and upon reboot displays “Operating system not found.” The machine sustains this critical system error before additional files are overwritten, indicating some data may be recoverable. Dropped files include: c:\\windows\\svchost.exe||\n|Related Samples: N/A||\n\n|APPENDIX B.15:  KILLDISK (SAMPLE 2)|Col2|\n|---|---|\n|SHA1: 8ad6f88c5813c2b4cd7abab1d6c056d95d6ac569||\n|SHA-256: f52869474834be5a6b5df7f8f0c46cbc7e9b22fa5cb30bee0f363ec6eb056b95||\n|MD5: 72bd40cd60769baffd412b84acc03372||\n|Type: Win32 Executable277|First Upload: 2015-11-10 09:31:41278|\n|Compile Timestamp: 2015-10-24 18:19:30279|Final Modification Timestamp: 2015:10:24 19:19:30+01:00280|\n\n\n54 Booz Allen Hamilton\n\n\n-----\n\n|File Size: 110592 bytes281|Language Settings: English US282|\n|---|---|\n|File Names: svchost.exe283||\n|Technical Notes: The execution process for this sample is identical to the process detailed in Appendix B.14: KillDisk (Sample 1).||\n|Related Samples: 1. Appendix B.14: KillDisk (Sample 1) (MD5:108fedcb6aa1e79eb0d2e2ef9bc60e7a)||\n\n\nAPPENDIX B.16:\nKILLDISK (SAMPLE 3)\n\n|APPENDIX B.16:  KILLDISK (SAMPLE 3)|Col2|\n|---|---|\n|SHA1: f3e41eb94c4d72a98cd743bbb02d248f510ad925||\n|SHA-256: c7536ab90621311b526aefd56003ef8e1166168f038307ae960346ce8f75203d||\n|MD5: 7361b64ddca90a1a1de43185bd509b64||\n|Type: Win32 Executable284|First Upload: 2015-12-23 22:34:19285|\n|Compile Timestamp: 1999:01:06 23:02:00+01:00286|Final Modification Timestamp: 1999:01:06 23:02:00+01:00287|\n|File Size: 98304 bytes288|Language Settings: English US289|\n|File Names:290 tsk.exe danger Ukranian.bin.exe||\n|Technical Notes: This KillDisk sample executes a destructive disk overwrite function. In addition to destroying critical OS data, the sample also overwrites thousands of additional files, including log files.291 Following execution, data is not likely recoverable. In initial analysis, the executable would not run from cmdline on Win5.1. The file was patched using Ollydbg, allowing it to run as a child of services.exe as “<Binary_Name> -LocalService”. Execution Routine: 1. The executable overwrites (with blanks/spaces) first 131072 bytes of \\Device\\Harddisk0\\DR0, effectively rendering the OS unusable upon reboot. 2. After overwriting OS data, the executable continues to overwrite thousands of files, causing the system to remain powered but unusable. Data destruction takes long time and does not immediately trigger a critical system error. 3. Following reboot, the system displays reboot error: “Operating system not found.” The executable also drops hundreds of 5-byte files in C:\\windows\\temp\\==00####=.tmp, where “####” is an incrementing numeric.||\n|Related Samples: N/A||\n\n\nboozallen.com/ics     55\n\n\n-----\n\nAPPENDIX B.17:\nKILLDISK (SAMPLE 4)\n\n|APPENDIX B.17:  KILLDISK (SAMPLE 4)|Col2|\n|---|---|\n|SHA1: 16f44fac7e8bc94eccd7ad9692e6665ef540eec4||\n|SHA-256: 5d2b1abc7c35de73375dd54a4ec5f0b060ca80a1831dac46ad411b4fe4eac4c6||\n|MD5: cd1aa880f30f9b8bb6cf4d4f9e41ddf4||\n|Type: Win32 Executable|First Upload: 2015-10-25 01:31:24292|\n|Compile Timestamp: 2015:10:24 14:23:02293 +01:00|Final Modification Timestamp: 2015:10:24 14:23:02+01:00294|\n|File Size: 90112 bytes295|Language Settings: English US296|\n|File Names:297 crab.exe ololo 2.exe ololo.exe||\n|Technical Notes: This KillDisk sample executes a destructive disk overwrite function. Following execution, data may be recoverable. Execution Routine: 1. The executable runs as own process rather than running an embedded file as a child process, as was observed in other samples. 2. Upon execution, the first 131072 bytes of \\Device\\Harddisk0\\DR0 are overwritten with zeros, effectively rendering the OS unusable upon reboot. 3. While running, the machine sustains a critical error, and upon reboot displays “Operating system not found.” The machine sustains the critical system error before additional files are overwritten, indicating some data may be recoverable.||\n|Related Samples: N/A||\n\n\n56 Booz Allen Hamilton\n\n\n-----\n\nAPPENDIX B.18:\nKILLDISK (SAMPLE 5)\n\n|APPENDIX B.18:  KILLDISK (SAMPLE 5)|Col2|\n|---|---|\n|SHA1: 6d6ba221da5b1ae1e910bbeaa07bd44aff26a7c0||\n|SHA-256: 11b7b8a7965b52ebb213b023b6772dd2c76c66893fc96a18a9a33c8cf125af80||\n|MD5: 66676deaa9dfe98f8497392064aefbab||\n|Type: Win32 Executable298|First Upload: 2015-10-25 23:07:26299|\n|Compile Timestamp: 2015-10-24 13:49:03300|Final Modification Timestamp: 2015:10:24 14:49:03+01:00301|\n|File Size: 126976 bytes302|Language Settings: English US303|\n|File Names:304 trololo.exe 123.txt ololo.exe ololo.txt virus_ololo.dat||\n|Technical Notes: This KKillDisk sample executes a destructive disk overwrite function. In addition to destroying critical OS data, the sample also overwrites thousands of additional files, including log files.305 Following execution, data is not likely recoverable. Execution Routine: 1. The executable runs as own process rather than running an embedded file as a child process, as was observed in other samples. 2. The executable overwrites (with blanks/spaces) the first 131072 bytes of \\Device\\Harddisk0\\ DR0, effectively rendering the OS unusable upon reboot. 3. After overwriting OS data, the executable continues to overwrite thousands of files, causing the system to remain powered but unusable. Data destruction takes long time and does not immediately trigger a critical system error. 4. Following reboot, the system displays reboot error: “Operating system not found.”||\n|Related Samples: N/A||\n\n\nboozallen.com/ics     57\n\n\n-----\n\n-----\n\nBlackEnergy (BE) was first observed in 2007 and\nhas since been used by a wide range of threat\nactors, predominantly criminal groups, to\nconduct a diverse collection of malicious\ncampaigns.[306] BE has been observed as an\nenabling tool in distributed denial-of-service\n(DDoS) attacks, theft of banking credentials,\nwidespread reconnaissance and cyberespio­\nnage,[307] and ultimately disruptive industrial\ncontrol systems (ICS) attacks in Ukraine. The BE\nplugins identified reflect the diverse use of this\nmalware, and the significant overlap in function­\nality across different plugins indicates that\nseveral distinct groups are actively using the tool.\nAt least 14 BE plugins have been identified in\npublic reporting, including:[308,309]\n\n- FS.dll: Functions as a data exfiltration tool;\n\ngathers documents and private keys by search\nfor specific file extensions\n\n- SI.dll: Searches infected machines for specific\n\nconfiguration and operational data\n\n- JN.dll: Functions as a parasitic infector; fixes\n\nchecksum values in PE headers, fixes CRC32\nNullsoft value, and deletes digital signatures\nto avoid invalidation\n\n- KI.dll: Records user key strokes on infected\n\nmachines\n\n- PS.dll: Searches infected machines for user\n\ncredentials\n\n- SS.dll: Captures screenshots on infected\n\nmachines\n\n- VS.dll: Functions as a network discovery and\n\nremote execution tool. Scans the infected\nnetwork to identify connected network\nresources, retrieves remote desktop\n\n\n## APPENDIX C:\n\n#### BlackEnergy Plugins\n\ncredentials, and attempts to establish\nconnections. Uses PsExec, which is embedded\nin the plugin, to gather system information\nand launch executables on remote machines\n\n- TV.dll: Searches for TeamViewer versions 6–8.\n\nIf the targeted application is identified, the\nplugin sets an additional password, creating\nan additional backdoor into the compromised\nsystem\n\n- RD.dll: Functions as a pseudo “remote\n\ndesktop” server\n\n- UP.dll: Used to update the hosted malware\n\n- DC.dll: Identifies Windows accounts on the\n\ninfected system\n\n- BS.dll: Conducts system profiling through\n\nqueries of system hardware, BIOS, and\nWindows information\n\n- DSTR.dll: Functions as a logic bomb. At a\n\nspecified time, the plugin rewrites files with\nspecific extensions with random data, deletes\nitself, and deletes the first 11 sectors of system\ndrive, then rewrites all remaining data\n\n- SCAN.dll: Functions as a network scanner on\n\ninfected systems.\n\nOf particular interest in the attacks against\nUkrainian electricity distributors are the SI and\nPS plugins. As plugins designed specifically to\nsearch for credential data, SI or PS are the likely\nplugins used following the initial infection. Data\ndestruction was also a component of the final\nstages of the attack, and though BE has a\ndedicated data destruction plugin, DSTR.dll,\npublic reporting indicates that the disk-wiping\ncomponent of the attack was achieved using the\nKillDisk malware.\n\n\nboozallen.com/ics     59\n\n\n-----\n\nThe SI plugin gathers a wide range of systems\ndata. Using the systeminfo.exe utility, SI gathers\nconfiguration information, including OS version,\nprivileges, current time, up time, idle time, and\nproxy.[310] SI also identifies:[311]\n\n- Installed applications, using the uninstall\n\nprogram registry\n\n- Process list, using the tasklist.exe utility\n\n- IP configurations, using the ipconfig.exe utility\n\n- Network connections, using the\n\nnetstat.exe utility\n\n- Routing tables, using the route.exe utility\n\n- Traceroute and Ping information to Google,\n\nusing tracert.exe and ping.exe\n\n- Mail, browser, and instant messaging clients.\n\nOf particular interest is its targeting of password\nmanagers and stored user credentials.[312] SI is\ndesigned to pull credentials from The Bat! email\nclient, Mozilla password manager, Google\nChrome password manager, Outlook and\nOutlook Express, Internet Explorer, and Windows\nCredential Store, including credentials for\nWindows Live messenger services, Remote\nDesktop, and WinINET.[313] If any of these\n\n\napplications or services were deployed on the\ntargeted systems, they would present a viable\navenue for gathering the valid user credentials\nthat the threat actors ultimately obtained in their\nattack. The PS.dll plugin is also specifically\ndesigned to search and exfiltrate credentials,[314]\nand may have been used in the attack. Similarly,\nthe KI.dll may have been used to record and\ntransfer keystrokes during user authentication,\nas some public reporting speculates.[315] Detail\non the specific function of these two plugins\nwas not listed in public sources, and samples\nof the .dll files were not located for analysis.\n\nOf the 15 plugins mentioned in this report, most\nwere initially developed for BE2, though they\ncould be recompiled for use with BE3.[316]\nAccording to reporting in September 2015, SI was\nthe only plugin analyzed by security researchers\nthat had been updated for use with BE3 at that\ntime;[317] this indicates SI may have been the tool\nused in the December 2015 attacks. Later\nreporting, in January 2015, indicated that all\n14 of the plugins had been modified for\ncompatibility with BE3.[318]\n\n\n60 Booz Allen Hamilton\n\n\n-----\n\nThough the primary tool in the Ukraine attacks\nwas BlackEnergy (BE) 3, as noted above, several\nother remote access trojans (RAT) were observed\nin the phishing campaign leading up to the\nattacks.[319] Several reports discussed\nthe use of a modified version of Dropbear,[320,321,322]\nan open-source SSH server and client executable\ndesigned as a lightweight server primarily for\nLinux-based embedded systems.[323] As with BE3,\nthe modified Dropbear was launched using a\nVisual Basic (VB) script[av] delivered via a weapon­\nized Microsoft (MS) Excel document.[324] At\nlaunch, the server is set to listen at port 6789.[325]\nThe modified version of the Dropbear server\ncontained two backdoors, a hardcoded public key\nauthentication process, and a hardcoded\nusername and password, allowing threat actors\nto authenticate into the targeted system.[326] One\nof the benefits, from an attacker’s perspective, of\nusing a RAT such as the modified Dropbear\nserver, is that it is not inherently malicious, and\nunlike other RATs, it may not be recognized by\n\n\n## APPENDIX D:\n\n#### Alternate Remote Access Trojans\n\nautomated scanners designed to recognize\npotentially malicious files.[327] Using an opensource SSH client like Dropbear in the initial\ninfection would also limit the risk of exposing a\nmore complex and valuable piece of malware,\nsuch as BE3; if the malware is discovered, it\nwould not represent a significant loss from the\nattacker’s perspective.\n\nDuring analysis of BE3 malware samples,\nanalysts did not find any technical link between\nBE3 and the other referenced RATs: GCat,\nDropbear, and Kryptik. It is possible, as some\npublic reporting indicates, that these additional\ntrojans were used by the same threat actors that\nconducted the attack on the electrical grid; in\nthe attack the threat actors used at least two\nseparate malware applications, BE3 and KillDisk.\nThere is no technical evidence to confirm these\nadditional trojans were used by the same group\nthough, and it is possible they had been\ndelivered to the targeted systems as part of\nseparate, unrelated attacks.\n\n\n_av._ _Appendix B.6: Dropbear Installer (DropbearRun.vbs) (MD5: 0af5b1e8eaf5ee4bd05227bf53050770)_\n\n\nboozallen.com/ics     61\n\n\n-----\n\n-----\n\n## APPENDIX E:\n\n#### Sources\n\n_1._ _“IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_2._ _“ИЗ-ЗА ХАКЕРСКОЙ АТАКИ ОБЕСТОЧИЛО ПОЛОВИНУ ИВАНО-ФРАНКОВСКОЙ ОБЛАСТИ,” TSN, December_\n_24, 2015, accessed April 13, 2016, http://ru.tsn.ua/ukrayina/iz-za-hakerskoy-ataki-obestochilo-polovinu-ivano-fran­_\n_kovskoy-oblasti-550406.html._\n\n_3._ _“Енергетики ліквідовують наслідки масштабної аварії на Прикарпатті,” Прикарпаттяобленерго, December 23,_\n_2015, accessed July 12, 2016, hxxp://www.oe.if.ua/showarticle.php?id=3413._\n\n_4._ _“Киберугроза BlackEnergy2/3. История атак на критическую ИТ инфраструктуру Украины,” Cys Centrum, June 1,_\n_2016, accessed July 12, 2016, hxxps://cys-centrum.com/ru/news/black_energy_2_3._\n\n_5._ _Blake Sobczak and Peter Behr, “Inside the diabolical Ukrainian hack that put the U.S. grid on high alert,” Environment &_\n_Energy Publishing, July 18, 2016, accessed July 21, 2016, hxxp://archive.is/lnnBf._\n\n_6._ _Robert M. Lee, Michael J. Assante, and Tim Conway, “Analysis of the Cyber Attack on the Ukrainian Power Grid Defense_\n_Use Case,” SANS Institute and Electricity Information Sharing and Analysis Center, March 18, 2016, accessed July 12, 2016,_\n_hxxps://ics.sans.org/media/E-ISAC_SANS_Ukraine_DUC_5.pdf._\n\n_7._ _“IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical infrastructure,” US Department of Homeland Security_\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_8._ _“Blackenergy & Quedagh: The convergence of crimeware and APT attacks,” F-Secure Labs Security Response, accessed July 12,_\n_2016, hxxps://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf._\n\n_9._ _Robert Lipovsky and Anton Cherapanov, “Last-minute paper: Back in BlackEnergy: 2014 targeted attacks in the Ukraine_\n_and Poland,” Virus Bulletin, September 25, 2015, accessed July 12, 2016, hxxps://www.virusbulletin.com/conference/vb2014/_\n_abstracts/back-blackenergy-2014-targeted-attacks-ukraine-and-poland._\n\n_10._ _“Киберугроза BlackEnergy2/3. История атак на критическую ИТ инфраструктуру Украины,” Cys-Centrum, June 1,_\n_2016, accessed August 15, 2016, hxxp://cys-centrum.com/ru/news/black_energy_2_3._\n\n_11._ _Kyle Wilhoit, “KillDisk and BlackEnergy Are Not Just Energy Sector Threats,” Trend Micro, February 11, 2016, accessed July 20,_\n_2016, hxxp://blog.trendmicro.com/trendlabs-security-intelligence/killdisk-and-blackenergy-are-not-just-energy-sector-threats/._\n\n_12._ _“Киберугроза BlackEnergy2/3. История атак на критическую ИТ инфраструктуру Украины,” Cys-Centrum, June 1,_\n_2016, accessed August 15, 2016, hxxp://cys-centrum.com/ru/news/black_energy_2_3._\n\n_13._ _Ibid._\n\n_14._ _Ibid._\n\n_15._ _Ibid._\n\n_16._ _Ibid._\n\n_17._ _Stephen Ward, “iSIGHT discovers zero-day vulnerability CVE-2014-4114 used in Russian cyber-espionage campaign,” iSight­_\n_Partners, October 14, 2014, accessed August 15, 2016, hxxps://www.isightpartners.com/2014/10/cve-2014-4114/._\n\n_18._ _“Киберугроза BlackEnergy2/3. История атак на критическую ИТ инфраструктуру Украины,” Cys-Centrum, June 1,_\n_2016, accessed August 15, 2016, hxxp://cys-centrum.com/ru/news/black_energy_2_3._\n\n_19._ _Stephen Ward, “iSIGHT discovers zero-day vulnerability CVE-2014-4114 used in Russian cyber-espionage campaign,” iSight­_\n_Partners, October 14, 2014, accessed August 15, 2016, hxxps://www.isightpartners.com/2014/10/cve-2014-4114/._\n\n_20._ _“Киберугроза BlackEnergy2/3. История атак на критическую ИТ инфраструктуру Украины,” Cys-Centrum, June 1,_\n_2016, accessed August 15, 2016, hxxp://cys-centrum.com/ru/news/black_energy_2_3._\n\n_21._ _Ibid._\n\n\nboozallen.com/ics     63\n\n\n-----\n\n_22._ _Ibid._\n\n_23._ _Ibid._\n\n_24._ _Ibid._\n\n_25._ _“Українські ЗМІ атакують за допомогою Black Energy,” CERT-UA, September 11, 2012, accessed July 19, 2016, hxxp://cert._\n_gov.ua/?p=2370._\n\n_26._ _Aleksey Yasinskiy, “DISMANTLING BLACKENERGY, PART 3 – ALL ABOARD!” SOCPrime, March 29, 2016, accessed August_\n_19, 2016, hxxps://socprime.com/en/blog/dismantling-blackenergy-part-3-all-aboard/._\n\n_27._ _Kyle Wilhoit, “KillDisk and BlackEnergy Are Not Just Energy Sector Threats,” Trend Micro, February 11, 2016, accessed July 20,_\n_2016, hxxp://blog.trendmicro.com/trendlabs-security-intelligence/killdisk-and-blackenergy-are-not-just-energy-sector-threats/._\n\n_28._ _Ibid._\n\n_29._ _“Атака на энергетические объекты 19-20 января 2016 года. Постфактум,” Cys-Centrum, January 29, 2016, accessed_\n_August 22, 2016, hxxps://cys-centrum.com/ru/news/attack_on_energy_facilities_jan_ps._\n\n_30._ _Robert Lipovsky, “New wave of cyberattacks against Ukrainian power industry,” We Live Security, January 20, 2016, accessed_\n_August 22, 2016, hxxp://www.welivesecurity.com/2016/01/20/new-wave-attacks-ukrainian-power-industry/._\n\n_31._ _“Атака на энергетические объекты 19-20 января 2016 года. Постфактум,” Cys-Centrum, January 29, 2016, accessed_\n_August 22, 2016, hxxps://cys-centrum.com/ru/news/attack_on_energy_facilities_jan_ps._\n\n_32._ _Ibid._\n\n_33._ _“Russian Hackers plan energy subersion in Ukraine,” Ukrinform, December 28, 2015, accessed July 19, 2016,_\n_hxxp://www.ukrinform.net/rubric-crime/1937899-russian-hackers-plan-energy-subversion-in-ukraine.html._\n\n_34._ _Pavel Polityuk, “Ukraine sees Russian hand in cyber attacks on power grid,” Reuters, February 12, 2016, accessed August 22,_\n_2016, hxxp://www.reuters.com/article/us-ukraine-cybersecurity-idUSKCN0VL18E._\n\n_35._ _Jose Nazario, “BlackEnergy DDoS Bot – Analysis Available,” Arbor Networks, October 12, 2007, accessed July 14, 2016,_\n_hxxps://www.arbornetworks.com/blog/asert/blackenergy-ddos-bot-analysis-available/._\n\n_36._ _Kelly Jackson Higgins, “New BlackEnergy Trojan Targeting Russian, Ukrainian Banks,” DarkReading, March 4, 2010, accessed_\n_July 14, 2016, hxxp://www.darkreading.com/vulnerabilities---threats/new-blackenergy-trojan-targeting-russian-ukrainian-ban_\n_ks/d/d-id/1133120._\n\n_37._ _Brian Prince, “Russian Banking Trojan BlackEnergy 2 Unmasked at RSA,” eWeek, March 4, 2010, accessed July 14, 2016,_\n_hxxp://www.eweek.com/c/a/Security/Russian-Banking-Trojan-BlackEnergy-2-Unmasked-at-RSA-883053._\n\n_38._ _Brian Prince, “Security Researcher Asserts Russian Role in Georgia Cyber-attacks,” eWeek, August 13, 2008, accessed July 14,_\n_2016, hxxp://www.eweek.com/c/a/Security/Security-Researcher-Asserts-Russian-Role-in-Georgia-Cyber-Attacks._\n\n_39._ _John Hultquist, “Sandworm Team – Targeting SCADA Systems,” iSight Partners, October 21, 2014, accessed July 14, 2016,_\n_hxxps://www.isightpartners.com/tag/blackenergy-malware/._\n\n_40._ _Jim Finkle, “Russian hackers target NATO, Ukraine and others: iSight,” Reuters, October 14, 2014, accessed July 14, 2016,_\n_hxxp://www.reuters.com/article/us-russia-hackers-idUSKCN0I308F20141014._\n\n_41._ _“Українські ЗМІ атакують за допомогою Black Energy,” CERT-UA, September 11, 2015, accessed July 13, 2016, hxxp://cert._\n_gov.ua/?p=2370._\n\n_42._ _“Blackenergy & Quedagh: The convergence of crimeware and APT attacks,” F-Secure Labs Security Response, accessed July 12,_\n_2016, hxxps://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf._\n\n_43._ _“Ukrainian Lawmakers Introduce a Bill on Nationalizing Russia’s Assets,” Russia Insider, April 23, 2015, accessed July 14, 2016,_\n_hxxp://russia-insider.com/en/ukrainian-lawmakers-introduce-bill-nationalizing-russias-assets/5993._\n\n\n64 Booz Allen Hamilton\n\n\n-----\n\n_44._ _“Ukrainian MPs propose to nationalize Russian assets,” People Investigator, April 4, 2015, accessed July 14, 2016, hxxp://_\n_peopleinvestigator.us/politics/308-ukrainian-mps-propose-to-nationalize-russian-assets.html._\n\n_45._ _Kim Zetter, “Inside the Cunning Unprecedented Hack of Ukraine’s Power Grid,” Wired, March 3, 2016, accessed July 13, 2016,_\n_hxxps://www.wired.com/2016/03/inside-cunning-unprecedented-hack-ukraines-power-grid/._\n\n_46._ _“List of persons and entities under EU restrictive measures over the territorial integrity of Ukraine,” Council of the European_\n_Union, September 15, 2015, accessed July 14, 2016, hxxp://www.consilium.europa.eu/en/press/press-releases/2015/09/_\n_pdf/150915-sanctions-table---persons--and-entities_pdf/._\n\n_47._ _Brad Well, “Corporte Governance in Ukraine: Passing Go,” Concorde Capital, October 2011, accessed July 14, 2016, hxxp://_\n_concorde.ua/en/getfile/129/3/._\n\n_48._ _Pierluigi Paganini, “BlackEnergy infected also Ukrainian Mining and Railway Systems,” Security Affairs, February 13, 2016,_\n_accessed July 14, 2016, hxxp://securityaffairs.co/wordpress/44452/hacking/blackenergy-mining-and-railway-systems.html._\n\n_49._ _Maria Snegovaya, “Putin’s information Warfare in Ukraine: Soviet Origins of Russia’s Hybrid Warfare,” Institute for the Study_\n_of War, September 2015, accessed July 14, 2016, hxxp://understandingwar.org/sites/default/files/Russian%20Report%201%20_\n_Putin’s%20Information%20Warfare%20in%20Ukraine-%20Soviet%20Origins%20of%20Russias%20Hybrid%20Warfare.pdf._\n\n_50._ _Anna Shamanska, “Explainer: Why Ukraine Supplies Electricity To Crimea, And Why It Stopped,” Radio Free Europe, Radio_\n_Liberty, July 14, 2016, accessed July 14, 2016, hxxp://www.rferl.org/content/ukraine-crimea-power-supply-electricity-ex­_\n_plainer/27384812.html._\n\n_51._ _Neil MacFarquhar, “Crimea in Dark After Power Lines Are Blown Up,” New York Times, November 22, 2015, accessed July_\n_14, 2016, hxxp://www.nytimes.com/2015/11/23/world/europe/power-lines-to-crimea-are-blown-up-cutting-off-electricity._\n_html?_r=0._\n\n_52._ _“Crimea hit by power blackout and Ukraine trade boycott,” BBC News, November 23, 2015, accessed July 14, 2016, hxxp://_\n_www.bbc.com/news/world-europe-34899491._\n\n_53._ _Anna Shamanska, “Explainer: Why Ukraine Supplies Electricity To Crimea, And Why It Stopped,” Radio Free Europe, Radio_\n_Liberty, July 14, 2016, accessed July 14, 2016, hxxp://www.rferl.org/content/ukraine-crimea-power-supply-electricity-ex­_\n_plainer/27384812.html._\n\n_54._ _“Dragonfly: Cyberespionage Attacks Against Energy Suppliers,” Symantec, July 7, 2014, accessed July 19, 2016, hxxps://www._\n_symantec.com/content/en/us/enterprise/media/security_response/whitepapers/Dragonfly_Threat_Against_Western_Energy__\n_Suppliers.pdf._\n\n_55._ _“Alert (ICS-ALERT-14-281-01E),” US Department of Homeland Security Industrial Control System Computer Emergency_\n_Response Team, December 10, 2014, modified March 2, 2016, accessed July 12, 2016, hxxps://ics-cert.us-cert.gov/alerts/_\n_ICS-ALERT-14-281-01B._\n\n_56._ _Michael J. Assante and Robert M. Lee,” The Industrial Control System Cyber Kill Chain,” SANS Institute, October 2015,_\n_accessed July 12, 2016, hxxps://www.sans.org/reading-room/whitepapers/ICS/industrial-control-system-cyber-kill-chain-36297._\n\n_57._ _Eric M. Hutchins, Michael J. Clopperty, and Rohan M. Amin, ”Intelligence-Driven Computer Network Defense Informed by_\n_Analysis of Adversary Campaigns and Intrusion Kill Chains,” Lockheed martin Corporation, 2011, accessed September 12,_\n_2016, hxxp://www.lockheedmartin.com/content/dam/lockheed/data/corporate/documents/LM-White-Paper-Intel-Driven-_\n_Defense.pdf._\n\n_58._ _Kim Zetter, “Inside the Cunning Unprecedented Hack of Ukraine’s Power Grid,” Wired, March 3, 2016, accessed July 13, 2016,_\n_hxxps://www.wired.com/2016/03/inside-cunning-unprecedented-hack-ukraines-power-grid/._\n\n_59._ _“IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_60._ _Ibid._\n\n\nboozallen.com/ics     65\n\n\n-----\n\n_61._ _Ibid._\n\n_62._ _Ibid._\n\n_63._ _“IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_64._ _“Remote Terminal Unit RTU560 System Description Release 6.2,” ABB Utilities GmbH, May 2003, accessed August 22, 2016,_\n_vfservis.cz/files/000290_RTU560_SD_R6.pdf._\n\n_65._ _Kim Zetter, “Inside the Cunning Unprecedented Hack of Ukraine’s Power Grid,” Wired, March 3, 2016, accessed July 13, 2016,_\n_hxxps://www.wired.com/2016/03/inside-cunning-unprecedented-hack-ukraines-power-grid/._\n\n_66._ _“IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_67._ _Kim Zetter, “Inside the Cunning Unprecedented Hack of Ukraine’s Power Grid,” Wired, March 3, 2016, accessed July 13, 2016,_\n_hxxps://www.wired.com/2016/03/inside-cunning-unprecedented-hack-ukraines-power-grid/._\n\n_68._ _Peter Behr and Blake Sobczak, “Grid hack exposes troubling security gaps for local utilities,” Environment and Energy_\n_Publishing, July 20, 2016, accessed August 22, 2016, hxxp://www.eenews.net/stories/1060040519._\n\n_69._ _Ibid._\n\n_70._ _“ICS-CERT Monitor,” ICS-CERT, November/December 2015, accessed October 26, 2016, hxxps://ics-cert.us-cert.gov/sites/_\n_default/files/Monitors/ICS-CERT_Monitor_Nov-Dec2015_S508C.pdf._\n\n_71._ _Ibid._\n\n_72._ _“Ongoing Sophisticated Malware Campaign Compromising ICS (Update B),” ICS-CERT, last updated November 17,_\n_2015, accessed October 26, 2016, hxxps://web.archive.org/web/20151117164746/https://ics-cert.us-cert.gov/alerts/_\n_ICS-ALERT-14-281-01B._\n\n_73._ _Bill Gertz, “Moscow Suspected in Hack of U.S. Industrial Control Systems,” Washington Free_\n_Beacon, October 31, 2014, accessed October 26, 2016, hxxp://freebeacon.com/national-security/_\n_moscow-suspected-in-hack-of-u-s-industrial-control-systems/._\n\n_74._ _“Ongoing Sophisticated Malware Campaign Compromising ICS (Update B),” ICS-CERT, last updated November 17,_\n_2015, accessed October 26, 2016, hxxps://web.archive.org/web/20151117164746/https://ics-cert.us-cert.gov/alerts/_\n_ICS-ALERT-14-281-01B._\n\n_75._ _“Інформація щодо трансформаторних підстанцій 35-110 кВ,” PJSC Kyivoblenergo, January 2, 2016, accessed August 22,_\n_2016, hxxp://www.koe.vsei.ua/koe/documents/Zvedena_forma_I_2016(14-03-16).pdf._\n\n_76._ _“Компанія сьогодні,” PJSC EK Chernivtsioblenergo, accessed August 22, 2016, hxxp://www.oblenergo.cv.ua/about.php._\n\n_77._ _“Company Overview of Public Joint Stock Company Prykarpattyaoblenergo,” Bloomberg, accessed August 22, 2016, hxxp://_\n_www.bloomberg.com/Research/stocks/private/snapshot.asp?privcapid=2559975._\n\n_78._ _“ОАО Прикарпатьеоблэнерго,” Galician Computer Company, accessed August 22, 2016, htxxtp://galcomcomp.com/index._\n_php/ru/nashi-proekty._\n\n_79._ _“Comprehensive Analysis Report on Ukraine Power System Attacks,” Antiy Labs, March 16, 2016, accessed July 12, 2016,_\n_hxxp://www.antiy.net/p/comprehensive-analysis-report-on-ukraine-power-system-attacks/._\n\n_80._ _Michael J. Assante and Robert M. Lee,” The Industrial Control System Cyber Kill Chain,” SANS Institute, October 2015,_\n_accessed July 12, 2016, hxxps://www.sans.org/reading-room/whitepapers/ICS/industrial-control-system-cyber-kill-chain-36297._\n\n\n66 Booz Allen Hamilton\n\n\n-----\n\n_81._ _GReAT, “BlackEnergy APT Attacks in Ukraine employ spearphishing with Word documents,”_\n_SecureList, January 28, 2016, accessed July 12, 2016, hxxps://securelist.com/blog/research/73440/_\n_blackenergy-apt-attacks-in-ukraine-employ-spearphishing-with-word-documents/._\n\n_82._ _Udi Shamir, “Analyzing a New Variant of BlackEnergy 3 Likely Insider-Based Execution,” SentinelOne, 2016, accessed July 12,_\n_2016, hxxps://www.sentinelone.com/wp-content/uploads/2016/01/BlackEnergy3_WP_012716_1c.pdf._\n\n_83._ _Robert Lipovsky and Anton Cherapanov, “Last-minute paper: Back in BlackEnergy: 2014 targeted attacks in the Ukraine_\n_and Poland,” Virus Bulletin, September 25, 2015, accessed July 12, 2016, hxxps://www.virusbulletin.com/conference/vb2014/_\n_abstracts/back-blackenergy-2014-targeted-attacks-ukraine-and-poland._\n\n_84._ _“Blackenergy & Quedagh: The convergence of crimeware and APT attacks,” F-Secure Labs Security Response, accessed July 12,_\n_2016, hxxps://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf._\n\n_85._ _Ibid._\n\n_86._ _Pavel Polityuk, “Ukraine sees Russian hand in cyber attacks on power grid,” Reuters, February 12, 2016, accessed August 22,_\n_2016, hxxp://www.reuters.com/article/us-ukraine-cybersecurity-idUSKCN0VL18E._\n\n_87._ _“IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_88._ _Robert M. Lee, Michael J. Assante, and Tim Conway, “Analysis of the Cyber Attack on the Ukrainian Power Grid Defense_\n_Use Case,” SANS Institute and Electricity Information Sharing and Analysis Center, March 18, 2016, accessed July 12, 2016,_\n_hxxps://ics.sans.org/media/E-ISAC_SANS_Ukraine_DUC_5.pdf._\n\n_89._ _“Киберугроза BlackEnergy2/3. История атак на критическую ИТ инфраструктуру Украины,” Cys Centrum, June 1,_\n_2016, accessed July 12, 2016, hxxps://cys-centrum.com/ru/news/black_energy_2_3._\n\n_90._ _Ibid._\n\n_91._ _Ibid._\n\n_92._ _“IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_93._ _byt3bl33d3r, “Gcat,” GitHub, June 9, 2016, accessed July 14, 2016, hxxps://github.com/byt3bl33d3r/gcat/blob/master/_\n_README.md._\n\n_94._ _Matt Johnston, “Dropbear SSH,” University of Western Australia University Computer Club, accessed July 12, 2016, hxxps://_\n_matt.ucc.asn.au/dropbear/dropbear.html._\n\n_95._ _Dianne Lagrimas, “TROJ_KRYPTIK,” Trend Micro, October 9, 2012, accessed July 14, 2016, hxxp://www.trendmicro.com/vinfo/_\n_us/threat-encyclopedia/malware/TROJ_KRYPTIK._\n\n_96._ _“IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_97._ _“Конференция UISGCON11. Итоги по киберугрозам в Украине в 2015 году,” Cys-Centrum, June 12, 2015, accessed_\n_August 22, 2016, hxxps://cys-centrum.com/ru/news/uisgcon11_2015#pic-5._\n\n_98._ _Robert M. Lee, Michael J. Assante, and Tim Conway, “Analysis of the Cyber Attack on the Ukrainian Power Grid Defense_\n_Use Case,” SANS Institute and Electricity Information Sharing and Analysis Center, March 18, 2016, accessed July 12, 2016,_\n_hxxps://ics.sans.org/media/E-ISAC_SANS_Ukraine_DUC_5.pdf._\n\n\nboozallen.com/ics     67\n\n\n-----\n\n_99._ _“IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_100. Robert Lipovsky and Anton Cherapanov, “Back in BlackEnergy: 2014 targeted attacks in the Ukraine and Poland,” Virus_\n\n_Bulletin, October 14, 2014, accessed July 12, 2016, hxxps://www.youtube.com/watch?v=I77CGqQvPE4._\n\n_101. “Blackenergy & Quedagh: The convergence of crimeware and APT attacks,” F-Secure Labs Security Response, accessed July 12,_\n\n_2016, hxxps://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf._\n\n_102. Ibid._\n\n_103. Robert Lipovsky and Anton Cherapanov, “Last-minute paper: Back in BlackEnergy: 2014 targeted attacks in the Ukraine_\n\n_and Poland,” Virus Bulletin, September 25, 2015, accessed July 12, 2016, hxxps://www.virusbulletin.com/conference/vb2014/_\n_abstracts/back-blackenergy-2014-targeted-attacks-ukraine-and-poland._\n\n_104. “Blackenergy & Quedagh: The convergence of crimeware and APT attacks,” F-Secure Labs Security Response, accessed July 12,_\n\n_2016, hxxps://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf._\n\n_105. Robert Lipovsky and Anton Cherapanov, “Last-minute paper: Back in BlackEnergy: 2014 targeted attacks in the Ukraine_\n\n_and Poland,” Virus Bulletin, September 25, 2015, accessed July 12, 2016, hxxps://www.virusbulletin.com/conference/vb2014/_\n_abstracts/back-blackenergy-2014-targeted-attacks-ukraine-and-poland._\n\n_106. “IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_107. Kim Zetter, “Inside the Cunning Unprecedented Hack of Ukraine’s Power Grid,” Wired, March 3, 2016, accessed July 13, 2016,_\n\n_hxxps://www.wired.com/2016/03/inside-cunning-unprecedented-hack-ukraines-power-grid/._\n\n_108. Aleksey Yasinskiy, “DISMANTLING BLACKENERGY, PART 3 – ALL ABOARD!” SOCPrime, March 29, 2016, accessed August_\n\n_19, 2016, hxxps://socprime.com/wp-content/uploads/2016/03/blackenergy-p3_16-1.jpg._\n\n_109. Robert M. Lee, Michael J. Assante, and Tim Conway, “Analysis of the Cyber Attack on the Ukrainian Power Grid Defense_\n\n_Use Case,” SANS Institute and Electricity Information Sharing and Analysis Center, March 18, 2016, accessed July 12, 2016,_\n_hxxps://ics.sans.org/media/E-ISAC_SANS_Ukraine_DUC_5.pdf._\n\n_110. Michael J. Assante and Robert M. Lee,” The Industrial Control System Cyber Kill Chain,” SANS Institute, October 2015,_\n\n_accessed July 12, 2016, hxxps://www.sans.org/reading-room/whitepapers/ICS/industrial-control-system-cyber-kill-chain-36297._\n\n_111._ _Robert M. Lee, Michael J. Assante, and Tim Conway, “Analysis of the Cyber Attack on the Ukrainian Power Grid Defense_\n_Use Case,” SANS Institute and Electricity Information Sharing and Analysis Center, March 18, 2016, accessed July 12, 2016,_\n_hxxps://ics.sans.org/media/E-ISAC_SANS_Ukraine_DUC_5.pdf._\n\n_112._ _“IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_113._ _Michael J. Assante and Robert M. Lee,” The Industrial Control System Cyber Kill Chain,” SANS Institute, October 2015,_\n_accessed July 12, 2016, hxxps://www.sans.org/reading-room/whitepapers/ICS/industrial-control-system-cyber-kill-chain-36297._\n\n_114._ _Robert Lipovsky and Anton Cherapanov, “Last-minute paper: Back in BlackEnergy: 2014 targeted attacks in the Ukraine_\n_and Poland,” Virus Bulletin, September 25, 2015, accessed July 12, 2016, hxxps://www.virusbulletin.com/conference/vb2014/_\n_abstracts/back-blackenergy-2014-targeted-attacks-ukraine-and-poland._\n\n_115._ _Aleksey Yasinskiy, “DISMANTLING BLACKENERGY, PART 3 – ALL ABOARD!” SOCPrime, March 29, 2016, accessed August_\n_19, 2016, hxxps://socprime.com/en/blog/dismantling-blackenergy-part-3-all-aboard/._\n\n\n68 Booz Allen Hamilton\n\n\n-----\n\n_116. Robert M. Lee, Michael J. Assante, and Tim Conway, “Analysis of the Cyber Attack on the Ukrainian Power Grid Defense_\n\n_Use Case,” SANS Institute and Electricity Information Sharing and Analysis Center, March 18, 2016, accessed July 12, 2016,_\n_hxxps://ics.sans.org/media/E-ISAC_SANS_Ukraine_DUC_5.pdf._\n\n_117._ _Kim Zetter, “Inside the Cunning Unprecedented Hack of Ukraine’s Power Grid,” Wired, March 3, 2016, accessed July 13, 2016,_\n_hxxps://www.wired.com/2016/03/inside-cunning-unprecedented-hack-ukraines-power-grid/._\n\n_118. Michael J. Assante and Robert M. Lee,” The Industrial Control System Cyber Kill Chain,” SANS Institute, October 2015,_\n\n_accessed July 12, 2016, hxxps://www.sans.org/reading-room/whitepapers/ICS/industrial-control-system-cyber-kill-chain-36297._\n\n_119. Kim Zetter, “Inside the Cunning Unprecedented Hack of Ukraine’s Power Grid,” Wired, March 3, 2016, accessed July 13, 2016,_\n\n_hxxps://www.wired.com/2016/03/inside-cunning-unprecedented-hack-ukraines-power-grid/._\n\n_120. “IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_121._ _Robert M. Lee, Michael J. Assante, and Tim Conway, “Analysis of the Cyber Attack on the Ukrainian Power Grid Defense_\n_Use Case,” SANS Institute and Electricity Information Sharing and Analysis Center, March 18, 2016, accessed July 12, 2016,_\n_hxxps://ics.sans.org/media/E-ISAC_SANS_Ukraine_DUC_5.pdf._\n\n_122._ _Ibid._\n\n_123._ _Kim Zetter, “Inside the Cunning Unprecedented Hack of Ukraine’s Power Grid,” Wired, March 3, 2016, accessed July 13, 2016,_\n_hxxps://www.wired.com/2016/03/inside-cunning-unprecedented-hack-ukraines-power-grid/._\n\n_124. “Dragonfly: Western Energy Companies Under Sabotage Threat,” Symantec, June 30, 2014, accessed July 14, 2016, hxxp://_\n\n_www.symantec.com/connect/blogs/dragonfly-western-energy-companies-under-sabotage-threat._\n\n_125._ _Michael J. Assante and Robert M. Lee,” The Industrial Control System Cyber Kill Chain,” SANS Institute, October 2015,_\n_accessed July 12, 2016, hxxps://www.sans.org/reading-room/whitepapers/ICS/industrial-control-system-cyber-kill-chain-36297._\n\n_126. Ibid._\n\n_127._ _Robert M. Lee, Michael J. Assante, and Tim Conway, “Analysis of the Cyber Attack on the Ukrainian Power Grid Defense_\n_Use Case,” SANS Institute and Electricity Information Sharing and Analysis Center, March 18, 2016, accessed July 12, 2016,_\n_hxxps://ics.sans.org/media/E-ISAC_SANS_Ukraine_DUC_5.pdf._\n\n_128. Ibid._\n\n_129. “Українські ЗМІ атакують за допомогою Black Energy,” CERT-UA, September 11, 2015, accessed July 13, 2016, hxxp://_\n\n_cert.gov.ua/?p=2370._\n\n_130. Robert Lipovsky and Anton Cherepanov, “BlackEnergy trojan strikes again: Attacks Ukrainian electric power_\n\n_industry,” welivesecurity, January 4, 2016, accessed July 12, 2016, hxxp://www.welivesecurity.com/2016/01/04/_\n_blackenergy-trojan-strikes-again-attacks-ukrainian-electric-power-industry/._\n\n_131._ _Aleksey Yasinskiy, “DISMANTLING BLACKENERGY, PART 3 – ALL ABOARD!” SOCPrime, March 29, 2016, accessed August_\n_19, 2016, hxxps://socprime.com/en/blog/dismantling-blackenergy-part-3-all-aboard/._\n\n_132._ _Ibid._\n\n_133._ _Kim Zetter, “Inside the Cunning Unprecedented Hack of Ukraine’s Power Grid,” Wired, March 3, 2016, accessed July 13, 2016,_\n_hxxps://www.wired.com/2016/03/inside-cunning-unprecedented-hack-ukraines-power-grid/._\n\n_134. “IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n\n69\n\n\n-----\n\n_135._ _Aleksey Yasinskiy, “DISMANTLING BLACKENERGY, PART 3 – ALL ABOARD!” SOCPrime, March 29, 2016, accessed August_\n_19, 2016, hxxps://socprime.com/en/blog/dismantling-blackenergy-part-3-all-aboard/._\n\n_136. Ibid._\n\n_137._ _“IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_138. Ibid._\n\n_139. Ibid._\n\n_140. Kim Zetter, “Inside the Cunning Unprecedented Hack of Ukraine’s Power Grid,” Wired, March 3, 2016, accessed July 13, 2016,_\n\n_hxxps://www.wired.com/2016/03/inside-cunning-unprecedented-hack-ukraines-power-grid/._\n\n_141._ _“IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_142. Ibid._\n\n_143. “UPS Network Management Cards,” Schneider Electric, accessed July 13, 2016, hxxp://www.schneider-electric.com/en/_\n\n_product-range/61936-ups-network-management-cards/._\n\n_144. “Vulnerability Note VU#166739APC Network Management Card web interface vulnerable to cross-site scripting and cross-site_\n\n_request forgery,” Carnegie Mellon University Computer Emergency Response Team, February 24, 2010, modified April 29,_\n_2010, accessed July 13, 2016, hxxps://www.kb.cert.org/vuls/id/166739._\n\n_145. “IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_146. Kim Zetter, “Inside the Cunning Unprecedented Hack of Ukraine’s Power Grid,” Wired, March 3, 2016, accessed July 13, 2016,_\n\n_hxxps://www.wired.com/2016/03/inside-cunning-unprecedented-hack-ukraines-power-grid/._\n\n_147._ _“IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_148. Ibid._\n\n_149. Robert M Lee, “Confirmation of a Coordinated Attack on the Ukrainian Power Grid,” SANS, January 9, 2016 hxxps://ics.sans._\n\n_org/blog/2016/01/09/confirmation-of-a-coordinated-attack-on-the-ukrainian-power-grid._\n\n_150. “IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_151._ _Jose Pagliery, “Scary questions in Ukraine energy grid hack,” CNN Money, January 18, 2016, accessed July 13, 2016, hxxp://_\n_money.cnn.com/2016/01/18/technology/ukraine-hack-russia/._\n\n_152._ _Robert M Lee, “Confirmation of a Coordinated Attack on the Ukrainian Power Grid,” SANS, January 9, 2016 hxxps://ics.sans._\n_org/blog/2016/01/09/confirmation-of-a-coordinated-attack-on-the-ukrainian-power-grid._\n\n_153._ _Robert M. Lee, Michael J. Assante, and Tim Conway, “Analysis of the Cyber Attack on the Ukrainian Power Grid Defense_\n_Use Case,” SANS Institute and Electricity Information Sharing and Analysis Center, March 18, 2016, accessed July 12, 2016,_\n_hxxps://ics.sans.org/media/E-ISAC_SANS_Ukraine_DUC_5.pdf._\n\n\n70 Booz Allen Hamilton\n\n\n-----\n\n_154. Rich Heidorn, “How a ‘Phantom Mouse’ and Weaponized Excel Files Brought Down Ukraine’s Grid,” March 28, 2016, hxxp://_\n\n_www.rtoinsider.com/nerc-phantom-mouse-cyberattack-24232/._\n\n_155._ _Ellen Nakashima, “Russian hackers suspected in attack that blacked out parts of Ukraine,” Washington Post, January 5, 2016,_\n_accessed July 14, 2016, hxxps://www.washingtonpost.com/world/national-security/russian-hackers-suspected-in-attack-that-_\n_blacked-out-parts-of-ukraine/2016/01/05/4056a4dc-b3de-11e5-a842-0feb51d1d124_story.html._\n\n_156. “IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_157._ _Kim Zetter, “Inside the Cunning Unprecedented Hack of Ukraine’s Power Grid,” Wired, March 3, 2016, accessed July 13, 2016,_\n_hxxps://www.wired.com/2016/03/inside-cunning-unprecedented-hack-ukraines-power-grid/._\n\n_158. “IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_159. Ibid._\n\n_160. “Vulnerability Summary for CVE-2014-6271,” National Vulnerability Database, September 24, 2014, modified June 28, 2016,_\n\n_accessed July 14, 2016, hxxps://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6271._\n\n_161. Vulnerability Summary for CVE-2014-7186,” National Vulnerability Database, September 28, 2014, modified October 9, 2015,_\n\n_accessed July 14, 2016, hxxps://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-7186._\n\n_162. “Vulnerability Summary for CVE-2014-7187,” National Vulnerability Database, September 28, 2014, modified October 9, 2015,_\n\n_accessed July 14, 2016, hxxps://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-7187._\n\n_163. “Vulnerability Summary for CVE-2014-6277,” National Vulnerability Database, September 28, 2014, modified October 9, 2015,_\n\n_accessed July 14, 2016, hxxps://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6277._\n\n_164. “Vulnerability Summary for CVE-2014-6278,” National Vulnerability Database, September 30, 2014, modified June 14, 2016,_\n\n_accessed July 14, 2016, hxxps://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6278._\n\n_165. “Advisory (ICSA-16-138-01) IRZ RUH2 3G Firmware Overwrite Vulnerability,” US Department of Homeland Security_\n\n_Industrial computer Emergency Response Team, May 17, 2016, accessed July 14, 2016, hxxps://ics-cert.us-cert.gov/advisories/_\n_ICSA-16-138-01._\n\n_166. “IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_167. Kim Zetter, “Inside the Cunning Unprecedented Hack of Ukraine’s Power Grid,” Wired, March 3, 2016, accessed July 13, 2016,_\n\n_hxxps://www.wired.com/2016/03/inside-cunning-unprecedented-hack-ukraines-power-grid/._\n\n_168. “The Surging Threat of Telephony Denial of Service Attacks,” SecureLogix, Ocotber 21, 2014, accessed July 13, 2016, hxxp://_\n\n_www.cisco.com/c/dam/en/us/products/collateral/unified-communications/unified-border-element/tdos_brochure.pdf._\n\n_169. “IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_170. Kim Zetter, “Inside the Cunning Unprecedented Hack of Ukraine’s Power Grid,” Wired, March 3, 2016, accessed July 13, 2016,_\n\n_hxxps://www.wired.com/2016/03/inside-cunning-unprecedented-hack-ukraines-power-grid/._\n\n_171._ _Robert M. Lee, Michael J. Assante, and Tim Conway, “Analysis of the Cyber Attack on the Ukrainian Power Grid Defense_\n_Use Case,” SANS Institute and Electricity Information Sharing and Analysis Center, March 18, 2016, accessed July 12, 2016,_\n_hxxps://ics.sans.org/media/E-ISAC_SANS_Ukraine_DUC_5.pdf._\n\n\nboozallen.com/ics     71\n\n\n-----\n\n_172._ _“The Surging Threat of Telephony Denial of Service Attacks,” SecureLogix, Ocotber 21, 2014, accessed July 13, 2016, hxxp://_\n_www.cisco.com/c/dam/en/us/products/collateral/unified-communications/unified-border-element/tdos_brochure.pdf._\n\n_173._ _Ibid._\n\n_174. “TDoS Attacks on Public Safety Communications,” Cook County Department of Homeland Security Emergency_\n\n_Management, March 16, 2013, accessed July 13, 2016, hxxp://krebsonsecurity.com/wp-content/uploads/2013/04/DHSEM-16-_\n_SAU-01-LEO.pdf._\n\n_175._ _Ibid._\n\n_176. “IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_177._ _Ibid._\n\n_178. “Українські ЗМІ атакують за допомогою Black Energy,” CERT-UA, September 11, 2015, accessed July 19, 2016, hxxp://_\n\n_cert.gov.ua/?p=2370._\n\n_179. Ibid._\n\n_180. “052ebc9a518e5ae02bbd1bd3a5a86c3560aefc9313c18d81f6670c3430f1d4d4,” Virus Total, July 6, 2016, accessed July 15, 2016,_\n\n_hxxps://www.virustotal.com/en/file/052ebc9a518e5ae02bbd1bd3a5a86c3560aefc9313c18d81f6670c3430f1d4d4/analysis/._\n\n_181._ _Ibid._\n\n_182. Ibid._\n\n_183. Ibid._\n\n_184. “Analysis Report,” joeSandboxCloud, accessed July 12, 2016, hxxps://www.document-analyzer.net/analysis/4073/16856/0/_\n\n_html._\n\n_185. “052ebc9a518e5ae02bbd1bd3a5a86c3560aefc9313c18d81f6670c3430f1d4d4,” Virus Total, July 6, 2016, accessed July 15, 2016,_\n\n_hxxps://www.virustotal.com/en/file/052ebc9a518e5ae02bbd1bd3a5a86c3560aefc9313c18d81f6670c3430f1d4d4/analysis/._\n\n_186. Ibid._\n\n_187. Robert M Lee, “Potential Sample of Malware from the Ukrainian Cyber Attack Uncovered,”_\n\n_SANS Institute, January 1, 2016, accessed July 15, 2016, hxxps://ics.sans.org/blog/2016/01/01/_\n_potential-sample-of-malware-from-the-ukrainian-cyber-attack-uncovered._\n\n_188. Udi Shamir, “Analyzing a New Variant of BlackEnergy 3 Likely Insider-Based Execution,” SentinelOne, 2016, accessed July 12,_\n\n_2016, hxxps://www.sentinelone.com/wp-content/uploads/2016/01/BlackEnergy3_WP_012716_1c.pdf._\n\n_189. “Malicious Code Analysis on Ukraine’s Power Grid Incident,” Beijing Knownsec Information Technology Co., Ltd., January 10,_\n\n_2016, accessed July 12, 2016, hxxp://blog.knownsec.com/wp-content/uploads/2016/01/Malicious-Code-Analysis-on-Ukraines-_\n_Power-Grid-Incident-L150113.pdf._\n\n_190. “39d04828ab0bba42a0e4cdd53fe1c04e4eef6d7b26d0008bd0d88b06cc316a81,” Virus Total, June 21, 2016, accessed July 15,_\n\n_2016, hxxps://www.virustotal.com/en/file/39d04828ab0bba42a0e4cdd53fe1c04e4eef6d7b26d0008bd0d88b06cc316a81/_\n_analysis/._\n\n_191. GReAT, “BlackEnergy APT Attacks in Ukraine employ spearphishing with Word documents,”_\n\n_SecureList, January 28, 2016, accessed July 12, 2016, hxxps://securelist.com/blog/research/73440/_\n_blackenergy-apt-attacks-in-ukraine-employ-spearphishing-with-word-documents/._\n\n_192. “39d04828ab0bba42a0e4cdd53fe1c04e4eef6d7b26d0008bd0d88b06cc316a81,” Virus Total, June 21, 2016, accessed July 15,_\n\n_2016, hxxps://www.virustotal.com/en/file/39d04828ab0bba42a0e4cdd53fe1c04e4eef6d7b26d0008bd0d88b06cc316a81/_\n_analysis/._\n\n\n72 Booz Allen Hamilton\n\n\n-----\n\n_193. Ibid._\n\n_194. Ibid._\n\n_195. Ibid._\n\n_196. GReAT, “BlackEnergy APT Attacks in Ukraine employ spearphishing with Word documents,”_\n\n_SecureList, January 28, 2016, accessed July 12, 2016, hxxps://securelist.com/blog/research/73440/_\n_blackenergy-apt-attacks-in-ukraine-employ-spearphishing-with-word-documents/._\n\n_197. Ibid._\n\n_198. Udi Shamir, “Analyzing a New Variant of BlackEnergy 3 Likely Insider-Based Execution,” SentinelOne, 2016, accessed July 12,_\n\n_2016, hxxps://www.sentinelone.com/wp-content/uploads/2016/01/BlackEnergy3_WP_012716_1c.pdf._\n\n_199. Ibid._\n\n_200. Ibid._\n\n_201. “Blackenergy & Quedagh: The convergence of crimeware and APT attacks,” F-Secure Labs Security Response, accessed July 12,_\n\n_2016, hxxps://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf._\n\n_202. Ibid._\n\n_203. “Analysis Report,” joeSandboxCloud, accessed July 12, 2016, hxxps://www.document-analyzer.net/analysis/4073/16856/0/_\n\n_html._\n\n_204. Udi Shamir, “Analyzing a New Variant of BlackEnergy 3 Likely Insider-Based Execution,” SentinelOne, 2016, accessed July 12,_\n\n_2016, hxxps://www.sentinelone.com/wp-content/uploads/2016/01/BlackEnergy3_WP_012716_1c.pdf._\n\n_205. “ca7a8180996a98e718f427837f9d52453b78d0a307e06e1866db4d4ce969d525,” Virus Total, June 21, 2016, accessed July 15,_\n\n_2016, hxxps://www.virustotal.com/en/file/ca7a8180996a98e718f427837f9d52453b78d0a307e06e1866db4d4ce969d525/_\n_analysis/._\n\n_206. Ibid._\n\n_207. Ibid._\n\n_208. Ibid._\n\n_209. Ibid._\n\n_210. Ibid._\n\n_211._ _“07e726b21e27eefb2b2887945aa8bdec116b09dbd4e1a54e1c137ae8c7693660,” Virus Total, June 21, 2016, accessed July 15, 2016,_\n_hxxps://www.virustotal.com/en/file/07e726b21e27eefb2b2887945aa8bdec116b09dbd4e1a54e1c137ae8c7693660/analysis/._\n\n_212._ _Ibid._\n\n_213._ _Ibid._\n\n_214. Ibid._\n\n_215._ _Ibid._\n\n_216. Ibid._\n\n_217._ _“07a76c1d09a9792c348bb56572692fcc4ea5c96a77a2cddf23c0117d03a0dfad,” Virus Total, June 21, 2016, accessed July 15, 2016,_\n_hxxps://www.virustotal.com/en/file/07a76c1d09a9792c348bb56572692fcc4ea5c96a77a2cddf23c0117d03a0dfad/analysis/._\n\n_218. Ibid._\n\n\nboozallen.com/ics     73\n\n\n-----\n\n_219. Ibid._\n\n_220. Ibid._\n\n_221. Ibid._\n\n_222. “b90f268b5e7f70af1687d9825c09df15908ad3a6978b328dc88f96143a64af0f,” Virus Total, February 12, 2016, accessed July 15,_\n\n_2016, hxxps://www.virustotal.com/en/file/b90f268b5e7f70af1687d9825c09df15908ad3a6978b328dc88f96143a64af0f/analysis/._\n\n_223. Ibid._\n\n_224. “Malicious Code Analysis on Ukraine’s Power Grid Incident,” Beijing Knownsec Information Technology Co., Ltd., January 10,_\n\n_2016, accessed July 12, 2016, hxxp://blog.knownsec.com/wp-content/uploads/2016/01/Malicious-Code-Analysis-on-Ukraines-_\n_Power-Grid-Incident-L150113.pdf._\n\n_225. “b90f268b5e7f70af1687d9825c09df15908ad3a6978b328dc88f96143a64af0f,” Virus Total, February 12, 2016, accessed July 15,_\n\n_2016, hxxps://www.virustotal.com/en/file/b90f268b5e7f70af1687d9825c09df15908ad3a6978b328dc88f96143a64af0f/._\n\n_226. Ibid._\n\n_227. Anton Cherepanov, “BlackEnergy by the SSHBearDoor: attacks against Ukrainian news media and electric_\n\n_industry,” welivesecurity, January 3, 2016, accessed July 15, 2016, hxxp://www.welivesecurity.com/2016/01/03/_\n_blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/._\n\n_228. “Malicious Code Analysis on Ukraine’s Power Grid Incident,” Beijing Knownsec Information Technology Co., Ltd., January 10,_\n\n_2016, accessed July 12, 2016, hxxp://blog.knownsec.com/wp-content/uploads/2016/01/Malicious-Code-Analysis-on-Ukraines-_\n_Power-Grid-Incident-L150113.pdf._\n\n_229. Ibid._\n\n_230. Udi Shamir, “Analyzing a New Variant of BlackEnergy 3 Likely Insider-Based Execution,” SentinelOne, 2016, accessed July 12,_\n\n_2016, hxxps://www.sentinelone.com/wp-content/uploads/2016/01/BlackEnergy3_WP_012716_1c.pdf._\n\n_231._ _“Blackenergy & Quedagh: The convergence of crimeware and APT attacks,” F-Secure Labs Security Response, accessed July 12,_\n_2016, hxxps://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf._\n\n_232. Ibid._\n\n_233. Ibid._\n\n_234. Anton Cherepanov, “BlackEnergy by the SSHBearDoor: attacks against Ukrainian news media and electric_\n\n_industry,” welivesecurity, January 3, 2016, accessed July 15, 2016, hxxp://www.welivesecurity.com/2016/01/03/_\n_blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/._\n\n_235. Chintan Shah, “Evolving DDoS Botnets: 1. BlackEnergy,” McAfee Labs Blog, February 28, 2011, accessed July 19, 2016,_\n\n_hxxps://blogs.mcafee.com/business/security-connected/evolving-ddos-botnets-1-blackenergy/._\n\n_236. Anton Cherepanov, “BlackEnergy by the SSHBearDoor: attacks against Ukrainian news media and electric_\n\n_industry,” welivesecurity, January 3, 2016, accessed July 15, 2016, hxxp://www.welivesecurity.com/2016/01/03/_\n_blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/._\n\n_237. Ibid._\n\n_238. Ibid._\n\n_239. “ef380e33a854ef9d9052c93fc68d133cfeaae3493683547c2f081dc220beb1b3,” Virus Total, June 21, 2016, accessed July 15, 2016,_\n\n_hxxps://www.virustotal.com/en/file/ef380e33a854ef9d9052c93fc68d133cfeaae3493683547c2f081dc220beb1b3/analysis/._\n\n_240. Ibid._\n\n_241. Ibid._\n\n\n74 Booz Allen Hamilton\n\n\n-----\n\n_242. Ibid._\n\n_243. Ibid._\n\n_244. Ibid._\n\n_245. Ibid._\n\n_246. “f5785842682bc49a69b2cbc3fded56b8b4a73c8fd93e35860ecd1b9a88b9d3d8,” Virus Total, July 11, 2016, accessed July 15, 2016,_\n\n_hxxps://www.virustotal.com/en/file/f5785842682bc49a69b2cbc3fded56b8b4a73c8fd93e35860ecd1b9a88b9d3d8/analysis/._\n\n_247. Ibid._\n\n_248. Ibid._\n\n_249. Ibid._\n\n_250. Ibid._\n\n_251._ _Ibid._\n\n_252. Ibid._\n\n_253. “244dd8018177ea5a92c70a7be94334fa457c1aab8a1c1ea51580d7da500c3ad5,” Virus Total, June 21, 2016, accessed July 15, 2016._\n\n_hxxps://www.virustotal.com/en/file/244dd8018177ea5a92c70a7be94334fa457c1aab8a1c1ea51580d7da500c3ad5/analysis/._\n\n_254. Ibid._\n\n_255. Ibid._\n\n_256. Ibid._\n\n_257. Ibid._\n\n_258. Ibid._\n\n_259. “0969daac4adc84ab7b50d4f9ffb16c4e1a07c6dbfc968bd6649497c794a161cd,” Virus Total, June 21, 2016, accessed July 15,_\n\n_2016, hxxps://www.virustotal.com/en/file/0969daac4adc84ab7b50d4f9ffb16c4e1a07c6dbfc968bd6649497c794a161cd/_\n_analysis/._\n\n_260. Ibid._\n\n_261. Ibid._\n\n_262. Ibid._\n\n_263. Ibid._\n\n_264. Anton Cherepanov, “BlackEnergy by the SSHBearDoor: attacks against Ukrainian news media and electric_\n\n_industry,” welivesecurity, January 3, 2016, accessed July 15, 2016, hxxp://www.welivesecurity.com/2016/01/03/_\n_blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/._\n\n_265. Anton Cherepanov, “BlackEnergy by the SSHBearDoor: attacks against Ukrainian news media and electric_\n\n_industry,” welivesecurity, January 3, 2016, accessed July 15, 2016, hxxp://www.welivesecurity.com/2016/01/03/_\n_blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/._\n\n_266. “Malicious Code Analysis on Ukraine’s Power Grid Incident,” Beijing Knownsec Information Technology Co., Ltd., January 10,_\n\n_2016, accessed July 12, 2016, hxxp://blog.knownsec.com/wp-content/uploads/2016/01/Malicious-Code-Analysis-on-Ukraines-_\n_Power-Grid-Incident-L150113.pdf._\n\n\nboozallen.com/ics     75\n\n\n-----\n\n_267. Robert M. Lee, Michael J. Assante, and Tim Conway, “Analysis of the Cyber Attack on the Ukrainian Power Grid Defense_\n\n_Use Case,” SANS Institute and Electricity Information Sharing and Analysis Center, March 18, 2016, accessed July 12, 2016,_\n_hxxps://ics.sans.org/media/E-ISAC_SANS_Ukraine_DUC_5.pdf._\n\n_268. Robert Lipovsky and Anton Cherepanov, “BlackEnergy trojan strikes again: Attacks Ukrainian electric power_\n\n_industry,” welivesecurity, January 4, 2016, accessed July 12, 2016, hxxp://www.welivesecurity.com/2016/01/04/_\n_blackenergy-trojan-strikes-again-attacks-ukrainian-electric-power-industry/._\n\n_269. Kyle Wilhoit, “KillDisk and BlackEnergy Are Not Just Energy Sector Threats,” Trend Micro, February 11, 2016, accessed July 20,_\n\n_2016, hxxp://blog.trendmicro.com/trendlabs-security-intelligence/killdisk-and-blackenergy-are-not-just-energy-sector-threats/._\n\n_270. “30862ab7aaa6755b8fab0922ea819fb48487c063bea4a84174afbbd65ce26b86,” Virus Total, March 22, 2016, accessed July_\n\n_15, 2016, hxxps://www.virustotal.com/en/file/30862ab7aaa6755b8fab0922ea819fb48487c063bea4a84174afbbd65ce26b86/_\n_analysis/._\n\n_271. Ibid._\n\n_272. Ibid._\n\n_273. Ibid._\n\n_274. Ibid._\n\n_275. Ibid._\n\n_276. Ibid._\n\n_277. “f52869474834be5a6b5df7f8f0c46cbc7e9b22fa5cb30bee0f363ec6eb056b95,” Virus Total, June 21, 2016, accessed July 15, 2016,_\n\n_hxxps://www.virustotal.com/en/file/f52869474834be5a6b5df7f8f0c46cbc7e9b22fa5cb30bee0f363ec6eb056b95/analysis/._\n\n_278. Ibid._\n\n_279. Ibid._\n\n_280. Ibid._\n\n_281. Ibid._\n\n_282. Ibid._\n\n_283. Ibid._\n\n_284. “c7536ab90621311b526aefd56003ef8e1166168f038307ae960346ce8f75203d,” Virus Total, June 21, 2016, accessed July 15, 2016,_\n\n_hxxps://www.virustotal.com/en/file/c7536ab90621311b526aefd56003ef8e1166168f038307ae960346ce8f75203d/analysis/._\n\n_285. Ibid._\n\n_286. Ibid._\n\n_287. Ibid._\n\n_288. Ibid._\n\n_289. Ibid._\n\n_290. Ibid._\n\n_291. “Malicious Code Analysis on Ukraine’s Power Grid Incident,” Beijing Knownsec Information Technology Co., Ltd., January 10,_\n\n_2016, accessed July 12, 2016, hxxp://blog.knownsec.com/wp-content/uploads/2016/01/Malicious-Code-Analysis-on-Ukraines-_\n_Power-Grid-Incident-L150113.pdf._\n\n\n76 Booz Allen Hamilton\n\n\n-----\n\n_292. “5d2b1abc7c35de73375dd54a4ec5f0b060ca80a1831dac46ad411b4fe4eac4c6,” Virus Total, July 15, 2016, accessed July 15, 2016,_\n\n_hxxps://www.virustotal.com/en/file/5d2b1abc7c35de73375dd54a4ec5f0b060ca80a1831dac46ad411b4fe4eac4c6/analysis/._\n\n_293. Ibid._\n\n_294. Ibid._\n\n_295. Ibid._\n\n_296. Ibid._\n\n_297. Ibid._\n\n_298. “11b7b8a7965b52ebb213b023b6772dd2c76c66893fc96a18a9a33c8cf125af80,” Virus Total, June 21, 2016, accessed July 15, 2016,_\n\n_hxxps://www.virustotal.com/en/file/11b7b8a7965b52ebb213b023b6772dd2c76c66893fc96a18a9a33c8cf125af80/analysis/._\n\n_299. Ibid._\n\n_300. Ibid._\n\n_301. Ibid._\n\n_302. Ibid._\n\n_303. Ibid._\n\n_304. Ibid._\n\n_305. “Malicious Code Analysis on Ukraine’s Power Grid Incident,” Beijing Knownsec Information Technology Co., Ltd., January 10,_\n\n_2016, accessed July 12, 2016, hxxp://blog.knownsec.com/wp-content/uploads/2016/01/Malicious-Code-Analysis-on-Ukraines-_\n_Power-Grid-Incident-L150113.pdf._\n\n_306. “Blackenergy & Quedagh: The convergence of crimeware and APT attacks,” F-Secure Labs Security Response, accessed July 12,_\n\n_2016, hxxps://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf._\n\n_307. Ibid._\n\n_308. Raj Samani and Christiaan Beek, “Updated BlackEnergy Trojan Grows More Powerful,”McAfee Labs, January 14, 2016,_\n\n_accessed July 13, 2016, hxxps://blogs.mcafee.com/mcafee-labs/updated-blackenergy-trojan-grows-more-powerful/._\n\n_309. Robert Lipovsky and Anton Cherapanov, “Last-minute paper: Back in BlackEnergy: 2014 targeted attacks in the Ukraine_\n\n_and Poland,” Virus Bulletin, September 25, 2015, accessed July 12, 2016, hxxps://www.virusbulletin.com/conference/vb2014/_\n_abstracts/back-blackenergy-2014-targeted-attacks-ukraine-and-poland._\n\n_310. “Blackenergy & Quedagh: The convergence of crimeware and APT attacks,” F-Secure Labs Security Response, accessed July 12,_\n\n_2016, hxxps://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf._\n\n_311._ _Ibid._\n\n_312._ _Ibid._\n\n_313._ _Ibid._\n\n_314. Raj Samani and Christiaan Beek, “Updated BlackEnergy Trojan Grows More Powerful,”McAfee Labs, January 14, 2016,_\n\n_accessed July 13, 2016, hxxps://blogs.mcafee.com/mcafee-labs/updated-blackenergy-trojan-grows-more-powerful/._\n\n_315._ _Robert M. Lee, Michael J. Assante, and Tim Conway, “Analysis of the Cyber Attack on the Ukrainian Power Grid Defense_\n_Use Case,” SANS Institute and Electricity Information Sharing and Analysis Center, March 18, 2016, accessed July 12, 2016,_\n_hxxps://ics.sans.org/media/E-ISAC_SANS_Ukraine_DUC_5.pdf._\n\n\nboozallen.com/ics     77\n\n\n-----\n\n_316. Robert Lipovsky and Anton Cherapanov, “Last-minute paper: Back in BlackEnergy: 2014 targeted attacks in the Ukraine_\n\n_and Poland,” Virus Bulletin, September 25, 2015, accessed July 12, 2016, hxxps://www.virusbulletin.com/conference/vb2014/_\n_abstracts/back-blackenergy-2014-targeted-attacks-ukraine-and-poland._\n\n_317._ _Ibid._\n\n_318. Raj Samani and Christiaan Beek, “Updated BlackEnergy Trojan Grows More Powerful,”McAfee Labs, January 14, 2016,_\n\n_accessed July 13, 2016, hxxps://blogs.mcafee.com/mcafee-labs/updated-blackenergy-trojan-grows-more-powerful/._\n\n_319. “IR-ALERT-H-16-043-01AP Cyber-Attack Against Ukrainian Critical Infrastructure,” US Department of Homeland Security_\n\n_Industrial Control System Computer Emergency Response Team, March 7, 2016, accessed July 12, 2016, hxxps://info.publicin­_\n_telligence.net/NCCIC-UkrainianPowerAttack.pdf._\n\n_320. Paul Ducklin, “Ukraine power outages blamed on “hackers and malware” – the lessons to learn,” nakedse­_\n\n_curity by Sophos, January 6, 2016, accessed July 12, 2016, hxxps://nakedsecurity.sophos.com/2016/01/06/_\n_ukraine-power-outages-blamed-on-hackers-and-malware/._\n\n_321._ _Eduard Kovacs, “BlackEnergy Malware Used in Ukraine Power Grid Attacks,” SecurityWeek, January 4, 2016, accessed July 12,_\n_2016, hxxp://www.securityweek.com/blackenergy-group-uses-destructive-plugin-ukraine-attacks._\n\n_322. “Malicious Code Analysis on Ukraine’s Power Grid Incident,” Beijing Knownsec Information Technology Co., Ltd., January 10,_\n\n_2016, accessed July 12, 2016, hxxp://blog.knownsec.com/wp-content/uploads/2016/01/Malicious-Code-Analysis-on-Ukraines-_\n_Power-Grid-Incident-L150113.pdf._\n\n_323. Matt Johnston, “Dropbear SSH,” University of Western Australia University Computer Club, accessed July 12, 2016, hxxps://_\n\n_matt.ucc.asn.au/dropbear/dropbear.html._\n\n_324. “Malicious Code Analysis on Ukraine’s Power Grid Incident,” Beijing Knownsec Information Technology Co., Ltd., January 10,_\n\n_2016, accessed July 12, 2016, hxxp://blog.knownsec.com/wp-content/uploads/2016/01/Malicious-Code-Analysis-on-Ukraines-_\n_Power-Grid-Incident-L150113.pdf._\n\n_325. Ibid._\n\n_326. Ibid._\n\n_327. “BlackEnergy and the Ukraine: Signals vs. Noise,” Cylance, January 12, 2016, accessed July 12, 2016, hxxps://blog.cylance.com/_\n\n_blackenergy-and-the-ukraine-signals-vs.-noise._\n\n\n78 Booz Allen Hamilton\n\n\n-----\n\n### AUTHORS\n\n**JAKE STYCZYNSKI** **SCOTT STABLES**\nJake Styczynski is an associate at Booz Allen Scott Stables is a chief technologist in Booz\nHamilton specializing in cyber threat research. Allen’s Strategic Innovation Group leading the\nHe has conducted cyber threat landscape and firm’s Next-Generation Industrial Security\norganizational risk assessments for commercial initiative. In this role, he manages a team of\nand government clients. Jake has led project engineers and developers working together\nteams in open-source research efforts evaluating develop solutions that address the cybersecurity\nthreats to space-based systems, maritime challenges associated with industrial systems\nnavigation and communication systems, and and industrial IoT security. Scott has almost 20\nindustrial control systems. Jake earned an M.I.A. years of technology experience, primarily in the\nin international security policy from Columbia systems integration, communications, and\nUniversity and a B.A. in political science from cybersecurity areas, and has worked for a range\nUniversity of Massachusetts at Amherst. of commercial customers across the globe\n\nfocused on a range of diverse initiatives. Scott\nhas an M.S. in information systems from Robert\n\n**NATE BEACH-WESTMORELAND**\n\nGordon University, and a LL.B (Hons) in\n\nNate Beach-Westmoreland (@NateBeachW) is a\n\nbusiness law from London Guildhall University.\n\nlead associate at Booz Allen Hamilton with nearly\na decade of experience in cyber intelligence,\nopen-source research, and geopolitical analysis.\nNate leads a team of multidisciplinary analysts in\nproducing strategic cyber threat intelligence for\ncommercial and government clients. He has\nhelped mature or establish several Booz Allen\nopen-source intelligence teams, including the\nfirm’s first commercial cyber threat intelligence\noffering in 2011. He earned an M.A. in\ninternational relations from Yale University and a\nB.A. in history from Cornell University.\n\n\n-----\n\n###### About Booz Allen\n\n Booz Allen Hamilton has been at the forefront\n of strategy and technology for more than 100 years. Today, the firm provides management and technology consulting and engineering services to leading Fortune 500 corporations, govern­ ments, and not-for-profits across the globe.\n Booz Allen partners with public and private sector clients to solve their most difficult challenges through a combination of consulting, analytics, mission operations, technology, systems delivery, cybersecurity, engineering,\n and innovation expertise.\n\n With international headquarters in McLean, Virginia, the firm employs more than 22,600 people globally and had revenue of $5.41 billion for the 12 months ended March 31, 2016. To learn more, visit BoozAllen.com. (NYSE: BAH)\n\n For More Information\n\nBRAD MEDAIRY\nSenior Vice President\n[medairy_brad@bah.com](mailto:medairy_brad%40bah.com%20?subject=)\n+1-703-902-5948\n\nSCOTT STABLES\nChief Cyber Technologist\n[stables_scott@bah.com](mailto:stables_scott@bah.com )\n+1-630-776-7701\n\nMATT THURSTON\nLead Associate\nthurston_matthew@bah.com\n+1-703-216-5259\n\nboozallen.com/ics\n\n\n###### Authors\n\nJAKE STYCZYNSKI\nLead Author\n\nNATE BEACH-WESTMORELAND\nAuthor\n\nSCOTT STABLES\nAuthor\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/pbj4aeiapdbblzs19gzymgsk73sxbe56",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.11.03.Ukraine_Cybersecurity_Threat_Briefing/ukraine-report-when-the-lights-went-out.pdf"
    ],
    "report_names": [
        "BoozAllen_ukraine-report-when-the-lights-went-out(11-3-2016)",
        "ukraine-report-when-the-lights-went-out"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dfee8b2e-d6b9-4143-a0d9-ca39396dd3bf",
            "created_at": "2022-10-25T16:07:24.467088Z",
            "updated_at": "2025-03-27T02:02:10.241387Z",
            "deleted_at": null,
            "main_name": "Circles",
            "aliases": [],
            "source_name": "ETDA:Circles",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "649b5b3e-b16e-44db-91bc-ae80b825050e",
            "created_at": "2022-10-25T15:50:23.290412Z",
            "updated_at": "2025-03-27T02:00:55.431037Z",
            "deleted_at": null,
            "main_name": "Dragonfly",
            "aliases": [
                "TEMP.Isotope",
                "DYMALLOY",
                "Berserk Bear",
                "TG-4192",
                "Crouching Yeti",
                "IRON LIBERTY",
                "Energetic Bear",
                "Ghost Blizzard"
            ],
            "source_name": "MITRE:Dragonfly",
            "tools": [
                "MCMD",
                "Impacket",
                "CrackMapExec",
                "Backdoor.Oldrea",
                "Mimikatz",
                "PsExec",
                "Trojan.Karagany",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1478179370,
    "ts_modification_date": 1478179396,
    "files": {
        "pdf": "https://archive.orkl.eu/6a6ad533b71fd64fc9dd4948e920a0992f637302.pdf",
        "text": "https://archive.orkl.eu/6a6ad533b71fd64fc9dd4948e920a0992f637302.txt",
        "img": "https://archive.orkl.eu/6a6ad533b71fd64fc9dd4948e920a0992f637302.jpg"
    }
}