{
    "id": "7f883057-e5d8-46e7-a625-c19db40bdd01",
    "created_at": "2023-01-12T15:03:45.172427Z",
    "updated_at": "2025-03-27T02:11:51.908775Z",
    "deleted_at": null,
    "sha1_hash": "b776f096525f1e7c05124819dac09d7d20e88adb",
    "title": "2021-09-16 - APT Actors Exploiting Newly Identified Vulnerability in ManageEngine ADSelfService Plus",
    "authors": "",
    "file_creation_date": "2022-05-29T01:07:15Z",
    "file_modification_date": "2022-05-29T01:07:15Z",
    "file_size": 146970,
    "plain_text": "# APT Actors Exploiting Newly Identified Vulnerability in ManageEngine ADSelfService Plus\n\n**us-cert.cisa.gov/ncas/alerts/aa21-259a**\n\n## Summary\n\n_This Joint Cybersecurity Advisory uses the MITRE Adversarial Tactics, Techniques, and_\n_Common Knowledge (ATT&CK®) framework, Version 8. See the_ _[ATT&CK for Enterprise for](https://attack.mitre.org/versions/v9/techniques/enterprise/)_\n_referenced threat actor tactics and for techniques._\n\nThis joint advisory is the result of analytic efforts between the Federal Bureau of Investigation\n(FBI), United States Coast Guard Cyber Command (CGCYBER), and the Cybersecurity and\nInfrastructure Security Agency (CISA) to highlight the cyber threat associated with active\nexploitation of a newly identified vulnerability (CVE-2021-40539) in ManageEngine\nADSelfService Plus—a self-service password management and single sign-on solution.\n\nCVE-2021-40539, rated critical by the Common Vulnerability Scoring System (CVSS), is an\nauthentication bypass vulnerability affecting representational state transfer (REST)\napplication programming interface (API) URLs that could enable remote code execution. The\nFBI, CISA, and CGCYBER assess that advanced persistent threat (APT) cyber actors are\nlikely among those exploiting the vulnerability. The exploitation of ManageEngine\nADSelfService Plus poses a serious risk to critical infrastructure companies, U.S.-cleared\ndefense contractors, academic institutions, and other entities that use the software.\nSuccessful exploitation of the vulnerability allows an attacker to place webshells, which\nenable the adversary to conduct post-exploitation activities, such as compromising\nadministrator credentials, conducting lateral movement, and exfiltrating registry hives and\nActive Directory files.\n\n[Zoho ManageEngine ADSelfService Plus build 6114, which Zoho released on September 6,](https://pitstop.manageengine.com/portal/en/community/topic/adselfservice-plus-6114-security-fix-release)\n2021, fixes CVE-2021-40539. FBI, CISA, and CGCYBER strongly urge users and\nadministrators to update to ADSelfService Plus build 6114. Additionally, FBI, CISA, and\nCGCYBER strongly urge organizations ensure ADSelfService Plus is not directly accessible\nfrom the internet.\n\nThe FBI, CISA, and CGCYBER have reports of malicious cyber actors using exploits against\n[CVE-2021-40539 to gain access [T1190] to ManageEngine ADSelfService Plus, as early as](https://attack.mitre.org/techniques/T1190/)\nAugust 2021. The actors have been observed using various tactics, techniques, and\nprocedures (TTPs), including:\n\n[Frequently writing webshells [T1505.003] to disk for initial persistence](https://attack.mitre.org/techniques/T1505/003/)\n[Obfuscating and Deobfuscating/Decoding Files or Information [T1027 and](https://attack.mitre.org/techniques/T1027/) [T1140]](https://attack.mitre.org/techniques/T1140/)\n[Conducting further operations to dump user credentials [T1003]](https://attack.mitre.org/techniques/T1003/)\n\n\n-----\n\n[Living off the land by only using signed Windows binaries for follow-on actions [T1218]](https://attack.mitre.org/techniques/T1218/)\n[Adding/deleting user accounts as needed [T1136]](https://attack.mitre.org/techniques/T1136/)\n[Stealing copies of the Active Directory database ( NTDS.dit ) [T1003.003] or registry](https://attack.mitre.org/techniques/T1003/003/)\nhives\n[Using Windows Management Instrumentation (WMI) for remote execution [T1047]](https://attack.mitre.org/techniques/T1047)\n[Deleting files to remove indicators from the host [T1070.004]](https://attack.mitre.org/techniques/T1070/004/)\nDiscovering domain accounts with the `net Windows command [1087.002]`\n[Using Windows utilities to collect and archive files for exfiltration [T1560.001]](https://attack.mitre.org/techniques/T1560/001/)\n[Using custom symmetric encryption for command and control (C2) [T1573.001]](https://attack.mitre.org/techniques/T1573/001/)\n\nThe FBI, CISA, and CGCYBER are proactively investigating and responding to this malicious\ncyber activity.\n\nFBI is leveraging specially trained cyber squads in each of its 56 field offices and\nCyWatch, the FBI’s 24/7 operations center and watch floor, which provides around-theclock support to track incidents and communicate with field offices across the country\nand partner agencies.\n[CISA offers a range of no-cost cyber hygiene services to help organizations assess,](https://www.cisa.gov/cyber-hygiene-services)\nidentify, and reduce their exposure to threats. By requesting these services,\norganizations of any size could find ways to reduce their risk and mitigate attack\nvectors.\nCGCYBER has deployable elements that provide cyber capability to marine\ntransportation system critical infrastructure in proactive defense or response to\nincidents.\n\nSharing technical and/or qualitative information with the FBI, CISA, and CGCYBER helps\nempower and amplify our capabilities as federal partners to collect and share intelligence\nand engage with victims while working to unmask and hold accountable, those conducting\nmalicious cyber activities. See the Contact section below for details.\n\n[Click here for a PDF version of this report.](https://us-cert.cisa.gov/sites/default/files/publications/AA21-259A-APT_Actors_Exploiting_Newly_Identified_Vulnerability_in_ManageEngine_ADSelfService_Plus.pdf)\n\n[Click here for indicators of compromise (IOCs) in STIX format.](https://us-cert.cisa.gov/sites/default/files/publications/AA21-259A%20APT%20Actors%20Exploiting%20Newly%20Identified%20Vulnerability%20in%20ManageEngine%20ADSelfService%20Plus.stix.xml)\n\n## Technical Details\n\nSuccessful compromise of ManageEngine ADSelfService Plus, via exploitation of CVE-202140539, allows the attacker to upload a `.zip file containing a JavaServer Pages (JSP)`\nwebshell masquerading as an x509 certificate: `service.cer . Subsequent requests are`\nthen made to different API endpoints to further exploit the victim's system.\n\nAfter the initial exploitation, the JSP webshell is accessible at `/help/admin-`\n```\nguide/Reports/ReportGenerate.jsp . The attacker then attempts to move laterally using\n\n```\nWindows Management Instrumentation (WMI), gain access to a domain controller, dump\n\n\n-----\n\n```\nNTDS.dit and SECURITY/SYSTEM registry hives, and then, from there, continues the\n\n```\ncompromised access.\n\nConfirming a successful compromise of ManageEngine ADSelfService Plus may be difficult\n—the attackers run clean-up scripts designed to remove traces of the initial point of\ncompromise and hide any relationship between exploitation of the vulnerability and the\nwebshell.\n\n(Updated November 19, 2021): APT actors are using the following suite of tools to enable\nthis campaign:\n\nDropper – a dropper trojan that drops Godzilla webshell on a system.\nGodzilla – a Chinese language webshell.\nNGLite – a backdoor trojan written in Go.\nKdcSponge – a credential-stealing tool that targets undocumented APIs in Microsoft’s\nimplementation of Kerberos.\n\nThe FBI, CISA, and CGCYBER cannot confirm the CVE-2021-40539 is the only vulnerability\nAPT actors are leveraging as part of this activity, so it is key that network defenders focus on\ndetecting the tools listed above in addition to initial access vector. For more information, see:\n\nPalo Alto Networks blog post: KdcSponge, NGLite, Godzilla Webshell Used in Targeted\nAttack Campaign.\nMicrosoft Security blog post: Threat actor DEV-0322 exploiting ZOHO ManageEngine\nADSelfService Plus.\nIBM Security Intelligence blog post: Call to Patch: Zero Day Discovered in Enterprise\nHelp Desk Platform.\n\n**Note: The FBI, CISA, and CGCYBER do not endorse any commercial product or service,**\nincluding any subjects of analysis. Any reference to specific commercial products,\nprocesses, or services by service mark, trademark, manufacturer, or otherwise, does not\nconstitute or imply their endorsement, recommendation, or favoring by the FBI, CISA, and\nCGCYBER. This document does not change any legal requirements or impose new\nrequirements on the public.\n\n**Targeted Sectors**\n\nAPT cyber actors have targeted entities across the 16 critical infrastructure sectors,\nincluding academic institutions, defense contractors as well as transportation, information\ntechnology, manufacturing, communications, and finance. Illicitly obtained access and\ninformation may disrupt company operations/logistics and subvert U.S. research across\ncritical infrastructure sectors.\n\n**Indicators of Compromise**\n\n\n-----\n\n**_Hashes:_**\n```\n068d1b3813489e41116867729504c40019ff2b1fe32aab4716d429780e666324\n49a6f77d380512b274baff4f78783f54cb962e2a8a5e238a453058a351fcfbba\n\n```\n**_File paths:_**\n```\nC:\\ManageEngine\\ADSelfService Plus\\webapps\\adssp\\help\\adminguide\\reports\\ReportGenerate.jsp\nC:\\ManageEngine\\ADSelfService Plus\\webapps\\adssp\\html\\promotion\\adap.jsp\nC:\\ManageEngine\\ADSelfService\nPlus\\work\\Catalina\\localhost\\ROOT\\org\\apache\\jsp\\help\nC:\\ManageEngine\\ADSelfService Plus\\jre\\bin\\SelfSe~1.key (filename varies\nwith an epoch timestamp of creation, extension may vary as well)\nC:\\ManageEngine\\ADSelfService\nPlus\\webapps\\adssp\\Certificates\\SelfService.csr\nC:\\ManageEngine\\ADSelfService Plus\\bin\\service.cer\nC:\\Users\\Public\\custom.txt\nC:\\Users\\Public\\custom.bat\nC:\\ManageEngine\\ADSelfService\nPlus\\work\\Catalina\\localhost\\ROOT\\org\\apache\\jsp\\help (including\nsubdirectories and contained files)\n\n```\n**_Webshell URL Paths:_**\n\n```\n/help/admin-guide/Reports/ReportGenerate.jsp\n\n```\n```\n/html/promotion/adap.jsp\n\n```\n\nCheck log files located at `C:\\ManageEngine\\ADSelfService Plus\\logs for evidence of`\nsuccessful exploitation of the ADSelfService Plus vulnerability:\n\nIn access* logs:\n```\n      /help/admin-guide/Reports/ReportGenerate.jsp\n      /ServletApi/../RestApi/LogonCustomization\n      /ServletApi/../RestAPI/Connection\n\n```\nIn serverOut_* logs:\n```\n      Keystore will be created for \"admin\"\n      The status of keystore creation is Upload!\n\n```\nIn adslog* logs:\n```\n      Java traceback errors that include references to\n      NullPointerException in addSmartCardConfig or getSmartCardConfig\n\n```\n**_TTPs:_**\n\nWMI for lateral movement and remote code execution ( wmic.exe )\nUsing plaintext credentials acquired from compromised ADSelfService Plus host\n\n\n-----\n\nUsing `pg_dump.exe to dump ManageEngine databases`\nDumping `NTDS.dit and SECURITY/SYSTEM/NTUSER` registry hives\nExfiltration through webshells\nPost-exploitation activity conducted with compromised U.S. infrastructure\nDeleting specific, filtered log lines\n\n**_Yara Rules:_**\n\nrule ReportGenerate_jsp {\nstrings:\n$s1 = \"decrypt(fpath)\"\n$s2 = \"decrypt(fcontext)\"\n$s3 = \"decrypt(commandEnc)\"\n$s4 = \"upload failed!\"\n$s5 = \"sevck\"\n$s6 = \"newid\"\ncondition:\nfilesize < 15KB and 4 of them\n}\n\nrule EncryptJSP {\nstrings:\n$s1 = \"AEScrypt\"\n$s2 = \"AES/CBC/PKCS5Padding\"\n$s3 = \"SecretKeySpec\"\n$s4 = \"FileOutputStream\"\n$s5 = \"getParameter\"\n$s6 = \"new ProcessBuilder\"\n$s7 = \"new BufferedReader\"\n$s8 = \"readLine()\"\ncondition:\nfilesize < 15KB and 6 of them\n}\n\n## Mitigations\n\nOrganizations that identify any activity related to ManageEngine ADSelfService Plus\nindicators of compromise within their networks should take action immediately.\n\n[Zoho ManageEngine ADSelfService Plus build 6114, which Zoho released on September 6,](https://pitstop.manageengine.com/portal/en/community/topic/adselfservice-plus-6114-security-fix-release)\n2021, fixes CVE-2021-40539. FBI, CISA, and CGCYBER strongly urge users and\nadministrators to update to ADSelfService Plus build 6114. Additionally, FBI, CISA, and\nCGCYBER strongly urge organizations ensure ADSelfService Plus is not directly accessible\nfrom the internet.\n\n\n-----\n\nAdditionally, FBI, CISA, and CGCYBER strongly recommend domain-wide password resets\nand double Kerberos Ticket Granting Ticket (TGT) password resets if any indication is found\nthat the NTDS.dit file was compromised.\n\n**Actions for Affected Organizations**\n\n[Immediately report as an incident to CISA or the](https://us-cert.cisa.gov/report) [FBI (refer to Contact Information section](http://10.10.0.46/mailto:CyWatch@fbi.gov)\nbelow) the existence of any of the following:\n\nIdentification of indicators of compromise as outlined above.\nPresence of webshell code on compromised ManageEngine ADSelfService Plus\nservers.\nUnauthorized access to or use of accounts.\nEvidence of lateral movement by malicious actors with access to compromised\nsystems.\nOther indicators of unauthorized access or compromise.\n\n## Contact Information\n\nRecipients of this report are encouraged to contribute any additional information that they\nmay have related to this threat.\n\nFor any questions related to this report or to report an intrusion and request resources for\nincident response or technical assistance, please contact:\n\nTo report suspicious or criminal activity related to information found in this Joint\nCybersecurity Advisory, contact your local FBI field office at https://www.fbi.gov/contactus/field-offices, or the FBI’s 24/7 Cyber Watch (CyWatch) at (855) 292-3937 or by email at [CyWatch@fbi.gov. When available, please include the following information](http://10.10.0.46/mailto:CyWatch@fbi.gov)\nregarding the incident: date, time, and location of the incident; type of activity; number\nof people affected; type of equipment used for the activity; the name of the submitting\ncompany or organization; and a designated point of contact.\nTo request incident response resources or technical assistance related to these threats,\ncontact CISA at [Central@cisa.gov.](http://10.10.0.46/mailto:Central@cisa.gov)\nTo report cyber incidents to the Coast Guard pursuant to 33 CFR Subchapter H, Part\n101.305 please contact the USCG National Response Center (NRC) Phone: 1-800[424-8802, email: NRC@uscg.mil.](http://10.10.0.46/mailto:NRC@uscg.mil)\n\n## Revisions\n\nSeptember 16, 2021: Initial Version\n\nNovember 19, 2021: Updated to include tools used to enable attack campaign\n\nNovember 22, 2021: Updated Palo Alto reference to Palo Alto Networks\n\n\n-----\n\n[This product is provided subject to this Notification and this](https://us-cert.cisa.gov/privacy/notification) [Privacy & Use policy.](https://www.dhs.gov/privacy-policy)\n\n**Please share your thoughts.**\n\n[We recently updated our anonymous product survey; we'd welcome your feedback.](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://us-cert.cisa.gov/ncas/alerts/aa21-259a)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-16 - APT Actors Exploiting Newly Identified Vulnerability in ManageEngine ADSelfService Plus.pdf"
    ],
    "report_names": [
        "2021-09-16 - APT Actors Exploiting Newly Identified Vulnerability in ManageEngine ADSelfService Plus.pdf"
    ],
    "threat_actors": [
        {
            "id": "0a80df4d-5ab7-4ca3-809d-8ef7b5a54f1f",
            "created_at": "2023-11-21T02:00:07.386886Z",
            "updated_at": "2025-03-27T02:00:03.248375Z",
            "deleted_at": null,
            "main_name": "TiltedTemple",
            "aliases": [
                "DEV-0322",
                "Circle Typhoon"
            ],
            "source_name": "MISPGALAXY:TiltedTemple",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535825,
    "ts_updated_at": 1743041511,
    "ts_creation_date": 1653786435,
    "ts_modification_date": 1653786435,
    "files": {
        "pdf": "https://archive.orkl.eu/b776f096525f1e7c05124819dac09d7d20e88adb.pdf",
        "text": "https://archive.orkl.eu/b776f096525f1e7c05124819dac09d7d20e88adb.txt",
        "img": "https://archive.orkl.eu/b776f096525f1e7c05124819dac09d7d20e88adb.jpg"
    }
}