{
    "id": "95b89e92-987a-4b98-9f57-9d78adef1e70",
    "created_at": "2023-01-12T15:03:55.777989Z",
    "updated_at": "2025-03-27T02:06:04.376967Z",
    "deleted_at": null,
    "sha1_hash": "c4d89d27faa805862260bff84710aff33fa139fc",
    "title": "2022-01-24 - Scammers are creating new fraudulent Crypto Tokens and misconfiguring smart contract’s to steal funds",
    "authors": "",
    "file_creation_date": "2022-05-27T21:14:12Z",
    "file_modification_date": "2022-05-27T21:14:12Z",
    "file_size": 1367178,
    "plain_text": "# Scammers are creating new fraudulent Crypto Tokens and misconfiguring smart contract’s to steal funds\n\n**research.checkpoint.com/2022/scammers-are-creating-new-fraudulent-crypto-tokens-and-misconfiguring-smart-**\ncontracts-to-steal-funds/\n\nJanuary 24, 2022\n\nJanuary 24, 2022\n[Research by Dikla Barda](https://www.linkedin.com/in/diklabarda/) [Roman Zaikin &](https://www.linkedin.com/in/romanzaikin/) [Oded Vanunu](https://www.linkedin.com/in/oded-vanunu-a131283/)\n\n**Highlights**\n\n**_Check Point Research (CPR) detects hackers creating new fraudulent tokens to_**\n**_lure victims into buying the tokens, and then ‘rug pulling’ all the money from the_**\n**_smart contracts_**\n**_Hackers use misconfiguration in smart contract’s functions to steal funds_**\n**_Crypto wallet holders are advised to use only known exchanges, buy publically_**\n**_acknowledged tokens and pay attention to marketplace URL’s_**\n\n**Background**\n\n2021 saw an all-time high in crypto-related crimes, with scammers getting ahold of $14\n[billion in cryptocurrency. The rise in fraud and scams correlates to the immense growth of](https://www.nbcnews.com/tech/security/crypto-scammers-took-record-14-billion-2021-rcna11192)\nactivity within cryptocurrencies worldwide.\n\n\n-----\n\nRecent company announcements and developments show an increased interest in\ncryptocurrencies. For example, PayPal is considering a launch of its own cryptocurrency,\nFacebook has rebranded to Meta, and MasterCard announced that partners on its network\ncan enable their consumers to buy, sell and hold cryptocurrency using a digital wallet.\n\nIn addition, Disney wants to build a metaverse, Nike bought an NFT company, Starbucks\ncustomers can now use the new Bakkt app to pay for drinks and goods at the chain’s coffee\nshops with converted Bitcoin. Furthermore, Microsoft is building its Metaverse, Visa\nconfirmed conducting a pilot with Crypto.com to accept cryptocurrency for settling\ntransactions on its payment network. Adidas joined the metaverse via NFT, and Grayscale\nannounced Metaverse is a $1T industry. Funds are flowing towards crypto, and thus it’s no\nwonder hackers are targeting cryptocurrencies.\n\n[Back in November, Check Point Research (CPR) alerted crypto wallet users of a massive](https://research.checkpoint.com/2021/cpr-alerts-crypto-wallet-users-of-massive-search-engine-phishing-campaign-that-has-resulted-in-at-least-half-a-million-dollars-being-stolen/)\nsearch engine phishing campaign that resulted in at least half a million dollars being taken in\na matter of days. In this article Check Point Research (CPR) will demonstrate how hackers\nare creating new tokens, luring people to buy these tokens, and then ‘rug pulling’ all the\nmoney from a smart contract. In addition, CPR detected that the coin usually isn’t made to\nscam people, but a misconfiguration within smart contract functions helps hackers steal\nmoney.\n\nMost recently, [BBC news reported that a token named SQUID stole $3.38 million from crypto](https://www.bbc.com/news/business-59129466)\ninvestors in a large-scale scam. A crypto token is a currency similar to Bitcoin and Ethereum,\nbut some of the projects are created to innovate and build new technologies, while others are\nthere for fraudulent purposes.\nThis research investigates how hackers built tokens to scam consumers and provides tips on\nhow to identify these scam. For example:\n\nSome tokens contain a 99% buy fee which will steal all your money at the buying\nphase.\nSome of the tokens don’t allow the buyer to resell (SQUID Token) and only the owner\nmay sell.\nSome tokens contain a 99% sell fee which will steal all your money at the selling\nphase.\nSome allow the owner to create more coins in his wallet and sell them.\nAnd some others are not malicious but got security vulnerabilities in the contract source\ncode and lose their funds to hackers that exploit the vulnerabilities.\n\nDeep Dive\n\nTo identify the legitimacy of a token, Check Point researchers looked at its Smart contract on\nthe blockchain network. Smart contracts are programs stored on a blockchain that run when\ncertain conditions are met. The programing language in a smart contract is Solidity. Solidity is\nan object-oriented programming language for writing smart contracts on various blockchain\n\n\n-----\n\nplatforms, most notably, Ethereum. The benefit of smart contract over a regular programs is\nthe source code is fully open source and immutable (can’t be changed), but you can still see\nthe source code.\n\nFor instance if someone wants to execute a function in a smart contract, they can see\nexactly what will happen in the code as opposed to executing a function in a web server on\nthe internet which is completely hidden in the backend of the platform.\n\nThe code in the smart contract ecosystem is executed by the EVM (Ethereum Virtual\nMachine) and the code is run by miners/nodes.\n\nIt is easy to assume that smart contract code will be executed exactly as a lambda function\nthat runs on a random server in the cloud. However, in a smart contract you can see the\ncode that will be executed and every function executed will cost a monetary fee. The fee will\nbe paid by the person who executes the functions and not the code owner. For example, if\nyou execute a buy function to purchase a coin/token, you will pay the fee for that function\nexecution on the blockchain.\n\nNow let’s see some examples of how hackers are building scam coins to fool you into buying\nthem and then steal all your money, for example, M3\n(0x8ed9c7e4d8dfe480584cc7ef45742ac302ba27d7)\n\n[You can see the code of the contract here.](https://bscscan.com/address/0x8ed9c7e4d8dfe480584cc7ef45742ac302ba27d7#code)\n\nWe can see that we have a _transfer function, which is a standard function according to\nsmart contract standard, but this function will take some “fee” from your “totalSUPERHERE”\nwhich is the amount of the token you have:\n\nThis “fee” variable is set via the “_setTaxFee” function\n\n\n-----\n\nHere the function **approve, which is a hidden function in the contract, tries to impersonate**\nthe legitimate function “approve”\n\nIf we will look at the contract transaction created at:\n\n[https://bscscan.com/txs?a=0x8ed9c7e4d8dfe480584cc7ef45742ac302ba27d7](https://bscscan.com/txs?a=0x8ed9c7e4d8dfe480584cc7ef45742ac302ba27d7)\n\nThis “aprove” function was executed twice:\n\nAfter uploading the contract to the blockchain, with the parameter “8” as a fee:\n\nAfter the contract was scanned by some blockchain tools, the scammers changed the fee\nagain to 99:\n\n\n-----\n\nThis technique is common as hackers implement a hidden fee and change it later.\n\nA legitimate token will not charge fees or will charge hardcoded values that can’t be adjusted\nby the developer.\n\nFor example, the contract of the token ValkToken can be found at the following URL:\n\n[https://bscscan.com/address/0x405cFf4cE041d3235E8b1f7AaA4E458998A47363#code](https://bscscan.com/address/0x405cFf4cE041d3235E8b1f7AaA4E458998A47363#code)\n\nThe ValkToken implemented a hardcoded Fee that can’t be changed:\n\nBuy and sell fees are not the only scam. There are other types like hidden mint capabilities\nthat allow developers to create more coins, or even control who is allowed to sell. An\nexample is the contract “MINI BASKETBALL” which has over 3,500 buyers and over 14,000\ntransactions.\n\n[https://bscscan.com/address/0x31d9bb2d2e971f0f2832b32f942828e1f5d82bf9](https://bscscan.com/address/0x31d9bb2d2e971f0f2832b32f942828e1f5d82bf9)\n\n\n-----\n\nExamining the source code showed that this scam doesn’t allow us to sell the tokens.\n\nThis can be seen by looking into the “_transfer” function:\n\nTo be eligible to sell, the address has to be in “_balances1” list and “balances1” needs to\nbe set to “true”, otherwise the error “ERC20: transfer to zero address” will be shown. By\nlooking at the functions that are set for those values, we can see that:\n\nRenounce – set the variable balances1\nPrize_fund – set the value of the address that wants to sell to “true”\nReflections – set the value of the address that wants to sell to “false”\n\nBy looking at our code we can see in the transactions the following function call:\n```\n[+] Function Name: Renounce dict_values([\n\n```\n\n-----\n\n**False**\n```\n])\n[+] Function Name: Prize_Fund\ndict_values(['0xf86c3bd6a8Ef0e16CbAC211dcCc6A22B893eb85e'])\n[+] Function Name: Prize_Fund\ndict_values(['0x6b8C3B6bf42d0FFcbd92287aBcE878e4236CE98e'])\n[+] Function Name: Renounce dict_values([\n\n```\n**True**\n```\n])\n\n```\nWhich shows that at beginning no one would be able to sell, and then only these 2\naddresses.\n\n**Levyathan is a legitimate contract that got hacked. It used a MasterChef contract as its**\nowner and transfers to this contract the ownership as can be seen in the transactions:\n\n[https://bscscan.com/address/0x304c62b5b030176f8d328d3a01feab632fc929ba](https://bscscan.com/address/0x304c62b5b030176f8d328d3a01feab632fc929ba)\n\nThis contract is the only one that can manage and mint (create) more tokens:\n\n\n-----\n\nIn this situation, one of the developers of the contract uploaded mistakenly the MasterChef\ncontract private key to the GitHub repo of the project. The hacker got access to the key and\nminted millions of tokens.\n\nThey later withdrew all the funds from Levyathan contract, but that was not the only bug in\nthe contract. CPR found that this contract had the function “Emergency Withdraw” which was\nused multiple times to withdraw the funds without the extra credit for the staking:\n\n\n-----\n\nBut the developers mistakenly put the parameter rewardDebt instead of user.amount\ncontains all the funds + the extra credit:\n\nHackers used this function to steal funds from the contract. By looking over the transaction\nstatistics, there are more than the 57 calls made to emergencyWithdraw to steal funds from\nthe contract.\n\nIn the example of THE ZENON NETWORK, there was a mistake of not limiting an important\nfunction from unauthorized access which led to a disaster, allowing the hackers to steal\n$814,570.\n\n\n-----\n\nFunctions in Solidity have visibility specifiers which dictate how functions are allowed to be\ncalled. The visibility determines whether a function can be called externally by users, by\nother derived contracts, only internally or only externally.\nThe Zenon Network hack was made possible by an unprotected burn function within the\nsmart contract.\n\nThe burn function was set as an external function that means they can be called from other\ncontracts and via transactions.\n\nThe burn function can destroy tokens in the pool, which can cause the value of the tokens to\nincrease. Access to burn functions should be restricted, but the Zenon Network was\nunintentionally labeled as external, making it publicly callable.\n\n\n-----\n\nAs you can see in the transaction, the attacker added $0.42 worth of WBNB to the liquidity\npool in return he got 0.01354 coins of wrapped znn.\n\nThen they used the burn function to destroy 26,468 coins by sending them to burn address\n0x0000000000000000000000000000000000000000, causing the price of the wZNN to\nincrease dramatically. As a result, when they wanted to redeem his WBNB the pool believed\nthat they were owed a massive number of WBNB tokens, enabling them to drain the pool,\nand in return get $814,570.\n\nThe attacker used the burn function to manipulate the znn price, knowing the contract\nperforms their calculations of the value of their token completely internally, causing the pool\nto believe they owed more money to the attacker.\n\n**Check Point Research (CPR) warns that there are various ways scammers can create**\n**scam tokens and hack contracts. It is important for consumers to be careful with the**\n**tokens they buy.**\n\n**Conclusions and recommendations for crypto users:**\n\nIt’s hard to ignore the appeal of crypto. It’s a shiny new thing that promises to change the\nworld, and if prices continue on their upward trajectory, people have an opportunity to win a\nsignificant amount of money. However, cryptocurrency is a volatile market. Scammers will\nalways find new ways to steal your money using cryptocurrency. New forms of crypto are\nconstantly being minted.\n\n[According to the Federal Trade Commission (FTC), US consumers lost more than $80](https://www.ftc.gov/news-events/press-releases/2021/05/ftc-data-shows-huge-spike-cryptocurrency-investment-scams)\nmillion to cryptocurrency scams between October to March 2020.\n\n\n-----\n\nIf you ve incorporated crypto into your investment portfolio or are interested in investing\nin crypto in the future, you should make sure to use only known exchanges and buy from a\nknown token with several transactions behind it.\n\n**Beware of malicious marketplaces:**\n\nCryptocurrencies are not regulated in many countries around the world leaving consumer\nwallets exposed as an attractive target for cybercriminals. Special care must be taken with all\nphishing attempts aimed at the theft of these bitcoin marketplaces and impersonation of their\nwebsites that attempt to get a user to enter their login details for the sole purpose of theft. It\nis important to pay attention to the URLs of the Marketplaces that consumers use to avoid\nany kind of manipulation by cybercriminals.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-24 - Scammers are creating new fraudulent Crypto Tokens and misconfiguring smart contract’s to steal funds.pdf"
    ],
    "report_names": [
        "2022-01-24 - Scammers are creating new fraudulent Crypto Tokens and misconfiguring smart contract’s to steal funds.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535835,
    "ts_updated_at": 1743041164,
    "ts_creation_date": 1653686052,
    "ts_modification_date": 1653686052,
    "files": {
        "pdf": "https://archive.orkl.eu/c4d89d27faa805862260bff84710aff33fa139fc.pdf",
        "text": "https://archive.orkl.eu/c4d89d27faa805862260bff84710aff33fa139fc.txt",
        "img": "https://archive.orkl.eu/c4d89d27faa805862260bff84710aff33fa139fc.jpg"
    }
}