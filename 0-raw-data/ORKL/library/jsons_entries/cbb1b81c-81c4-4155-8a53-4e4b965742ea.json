{
    "id": "cbb1b81c-81c4-4155-8a53-4e4b965742ea",
    "created_at": "2023-01-12T15:08:28.937822Z",
    "updated_at": "2025-03-27T02:05:48.84398Z",
    "deleted_at": null,
    "sha1_hash": "54071f34365622bd59f5df1bedaf7ae07838199f",
    "title": "2022-03-21 - Python script to check a Cyclops Blink C&C",
    "authors": "",
    "file_creation_date": "2022-05-28T18:15:36Z",
    "file_modification_date": "2022-05-28T18:15:36Z",
    "file_size": 83216,
    "plain_text": "# research/check.py at main · trendmicro/research · GitHub\n\n**[github.com/trendmicro/research/blob/main/cyclops_blink/c2-scripts/check.py](https://github.com/trendmicro/research/blob/main/cyclops_blink/c2-scripts/check.py)**\n\ntrendmicro\n\n#!/usr/bin/env python3\n\nimport socket\n\nimport ssl\n\nimport sys\n\nimport requests\n\nfrom pathlib import Path\n\ndef usage():\n\nprint(\"Usage:\\n\\t{0} HOST[:]PORT\\n\\nExamples:\\n\\t{0} 8.8.8.8 443\\n\\t{0}\n9.9.9.9:666\\n\".format(Path(__file__).name))\n\nsys.exit(1)\n\ndef myip():\n\nr = requests.get('https://api.ipify.org?format=json')\n\n\n-----\n\nreturn r.json()['ip']\n\ndef check_cyclops_blink_c2(hostname, port, extaddr):\n\nctx = ssl.create_default_context()\n\nctx.check_hostname = False # Disables hostname checking\n\nctx.verify_mode = ssl.CERT_NONE # Do not verify the certificate\n\nveredict = 'NOT DETECTED'\n\nresponse = ''\n\ntry:\n\nwith socket.create_connection((hostname, port), timeout=5) as sock:\n\nwith ctx.wrap_socket(sock, server_hostname=hostname) as ssock:\n\nssock.settimeout(10)\n\nssock.send(b'\\x00\\x00\\x00\\x08')\n\nresponse = ssock.read(2048)\n\nif len(response) == 4:\n\nveredict = 'POSSIBLE'\n\nif socket.inet_ntoa(response) == extaddr:\n\nveredict = 'ACTIVE'\n\nssock.close()\n\nexcept:\n\nveredict = 'UNREACHABLE'\n\nprint(hostname,\n\nport,\n\nlen(response),\n\nresponse,\n\nveredict)\n\n\n-----\n\ndef main(argv):\n\nif len(argv) < 2:\n\nusage()\n\n# Accepts both host:port or host<space>port\n\npos = sys.argv[1].find(':')\n\nif pos != -1:\n\nhostname = sys.argv[1][:pos]\n\nport = sys.argv[1][pos+1:]\n\nelse:\n\nif len(argv) < 3:\n\nusage()\n\nhostname = sys.argv[1]\n\nport = sys.argv[2]\n\ncheck_cyclops_blink_c2(hostname, port, myip())\n\nif __name__ == \"__main__\":\n\nmain(sys.argv)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-21 - Python script to check a Cyclops Blink C&C.pdf"
    ],
    "report_names": [
        "2022-03-21 - Python script to check a Cyclops Blink C&C.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536108,
    "ts_updated_at": 1743041148,
    "ts_creation_date": 1653761736,
    "ts_modification_date": 1653761736,
    "files": {
        "pdf": "https://archive.orkl.eu/54071f34365622bd59f5df1bedaf7ae07838199f.pdf",
        "text": "https://archive.orkl.eu/54071f34365622bd59f5df1bedaf7ae07838199f.txt",
        "img": "https://archive.orkl.eu/54071f34365622bd59f5df1bedaf7ae07838199f.jpg"
    }
}