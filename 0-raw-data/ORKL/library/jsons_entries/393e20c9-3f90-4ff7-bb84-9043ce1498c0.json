{
    "id": "393e20c9-3f90-4ff7-bb84-9043ce1498c0",
    "created_at": "2023-01-12T15:02:30.354119Z",
    "updated_at": "2025-03-27T02:06:08.508395Z",
    "deleted_at": null,
    "sha1_hash": "fceadab8ec3a4748cc2dcdeedfee86f94a2b017f",
    "title": "2022-01-25 - New Threat Campaign Identified- AsyncRAT Introduces a New Delivery Technique",
    "authors": "",
    "file_creation_date": "2022-05-27T23:17:39Z",
    "file_modification_date": "2022-05-27T23:17:39Z",
    "file_size": 2473287,
    "plain_text": "# New Threat Campaign Identified: AsyncRAT Introduces a New Delivery Technique\n\n**[blog.morphisec.com/asyncrat-new-delivery-technique-new-threat-campaign](https://blog.morphisec.com/asyncrat-new-delivery-technique-new-threat-campaign)**\n\nPosted by [Michael Dereviashkin on January 25, 2022](https://blog.morphisec.com/author/michael-dereviashkin)\n\n[Tweet](https://twitter.com/share)\n\n[Morphisec, through its breach prevention with Moving Target Defense technology, has identified a](https://blog.morphisec.com/gartner-report-moving-target-defense-recognized-emerging-technology-application-security)\nnew, sophisticated campaign delivery which has been successfully evading the radar of many security\nvendors. Through a simple email phishing tactic with an html attachment, threat attackers are\n\n\n-----\n\ndelivering AsyncRAT (a remote access trojan) designed to remotely monitor and control its infected\ncomputers through a secure, encrypted connection. This campaign has been in effect for a period of 4\nto 5 months, with the lowest detection rates as presented through VirusTotal.\n\nMorphisec backtraced the campaign to September 12, 2021. This campaign continued its evolution\nwhile delivering formally known crypter as a service, such as HCrypt and Alosh. This blog post\nexplains the campaign delivery vector in detail.\n\n[RCE in Unifi Network Application using #log4j/#log4shell. (CVE-2021-44228) Going to be](https://twitter.com/hashtag/log4j?src=hash&ref_src=twsrc%5Etfw)\n[automating this and writing a blog article soon. pic.twitter.com/cPXjK1Agpw](https://t.co/cPXjK1Agpw)\n\n[— ed (@sprocket_ed) December 21, 2021](https://twitter.com/sprocket_ed/status/1473301038832701441?ref_src=twsrc%5Etfw)\n\n## Technical Introduction\n\nIn many cases, victims received an email message with an html attachment in the form of a receipt:\nReceipt-<digits>.html.\n\nBelow is an example of such an email message:\n\nFigure 1: Fake receipt\n\nWhen the victim decides to open the receipt, they see the following webpage that requests them to\nsave a downloaded ISO file. They believe it's a regular file download that will go through all the\nchannels of gateway and network security scanners. Surprisingly, that's not the case.\n\nIn fact, the ISO download is generated within the victim’s browser by the JavaScript code that is\nembedded inside the HTML receipt file, and it is not downloaded from a remote server. In the next\nsection, we will describe how this code successfully generates the file.\n\n\n-----\n\nFigure 2: Decoy receipt download\n\nFigure 3: Low detection rate by AV solutions\n\n## Stage 1: HTML and Javascript Loader\n\nAs mentioned earlier, the ISO file is not being delivered as a file blob object over the network, but\ninstead it is being delivered as a base64 string. This base64toblob function gets a Base64 encoded\nstring as an input and is responsible for the decoding to ASCII by a window.atob. Next, the result is\nconverted to a byte array from which a new blob is created. The blob type is set according to a given\nmime type (in this case, application/octet-stream).\n\nWe found that the earlier variants weren't obfuscated:\n\nFigure 4: Generation of the iso file\n\nIn the below snapshot, it's clearly demonstrated how the blob is injected as part of the URL object\nwhile mimicking the download of the ISO file as if it had been delivered remotely.\n\n\n-----\n\nFigure 5: Assignment of blob to url\n\nOnce the user opens the generated ISO, it is automatically mounted as a DVD Drive (under windows\n10). The mount contains either a .bat or a .vbs file inside.\n\nFigure 6: Auto-Mount for ISO files\n\nThe .bat/.vbs file that is included in the auto-mounted drive is responsible for downloading and\nexecuting the next stage as part of a powershell process execution:\n\nDeobfuscated:\n\n## Stage 2: Reflective .NET Injection\n\nThe PowerShell file code that's executed is responsible for:\n\n\n-----\n\nCreating persistancy through Schedule Task\nExecuting a dropped .vbs file, usually at %ProgramData%\nUnpacking an Base64 encoded and deflate compressed .NET module\nInjecting the .NET module payload in-memory(dropper)\n\nFigure 7: Persistency\n\n## Stage 3: The dropper\n\nThe injected .NET module's main purpose is to fill the role of a dropper while its working path is\nprimarily at %ProgramData%.\n\n\n-----\n\nFigure 8: .NET Module Dropper\n\nAbove, we can see that the Visual Basic file is written to the ProgramData\\internet folder. Immediately\nafter the execution, there is an attempt to delete traces.\n\nThe dropper creates three files:\n\nNet.vbs - obfuscated invocation of Net.bat\nNet.bat - invocation of Net.ps1\nNet.ps1 - next stage injection\n\nDeobfuscated Net.vbs content:\n\nNet.bat:\n\nNet.ps1:\n\n\n-----\n\nFigure 9: Antivirus Check\n\nThe check for AV solutions present on the machine is designed to skip features such as:\n\n**If user is in the built-in administrator group then perform:\n\nUAC bypass using Disk Cleanup\n\nDisable of action center notifications\nSet of windows defender exclusion\n\n\n-----\n\nFigure 10: UAC bypass + Windows Defender exclusion\n\nFigure 11: Disable of action center notifications\n\n\n-----\n\nFigure 12: Reflective load and process hollowing\n\nIn most cases, attackers have delivered AsyncRAT as the final payload that was hiding within the\nlegitimate .NET aspnet_compiler.exe process.\n\n### Indicators of Compromise (IOCs)\n\n\n-----\n\nHTML Fa5f4847181550f1332f943882bc89ab48302a3d6d6efc1a364b2af7dec119b2\n\n50d308118008908832fe9c7fa78169ef8aaa960450c788a2c41af0eb5e0a62db\n\nF3b17523ef01ccf96faa276ec78f774831d9747f1e8effac902c04ec51408cc5\n\nA0989ec9ad1b74c5e8dedca4a02dcbb06abdd86ec05d1712bfc560bf209e3b39\n\nA4565fbb5570c30085fb77c674b4f1b7d069bdd2350747304efc911c905c3e31\n\n43b0cf93776bbdd72d582b9ed5a95d015ca682ca2d642e9509d374c79cca098e\n\n159ef0dcef607e1ce0996c565a5f3e82a501dcf1b6063c03ee8d30137e77d743\n\nC24a0a1bf44d6b4c59ba752df79cef3c42c84f574072336320deba29b1b9100c\n\n1a3c935784376edd36d7d486307df5f628841ee49189dbaf643d21d00a84cef3\n\n8a67bb1e9eb625935b02c504dd4fced1d12f0b4b7784eeaf0bd94e1c741ee99a\n\n3730660dd06fdae513b757199be9846d1e022d5d70c1f246a583c55f19b87242\n\n75b4ab33e788181c36cfde764254e9e7c4d1a981b7832bbc60009fcdec7f586c\n\nE4ad32aa6d0f839342fc22b71530f04a4ab756e15f35707654828360fbd0aeef\n\nA02aa1c7d3e066a9e45266e4279ec2b433003bc570406e6770bd4ff22a91902e\n\n6f7f33619daa8226b9d17bcf4972b77ac448b8b11e394b9633cd4177434cf24f\n\nD25f66ed468c20472354ee60c4c1d0ecbe0c0e5f6515263e4f7146224b72f0a2\n\nb3b17bd9b11b502ec01308952bf74cf80618b4c75269c7d833fc381d75635a43\n\nAfef7b47f0cb7ab0ff30d2cc887381e1745c7536a123098633a4e31ebbcc60cb\n\n55f4d7297800a4a4142be065e1674229cb1b120e8ade7b4ff7938affcfdb85c6\n\nB545bcc50adce9c788034f230c48a3c1a528874399226d12ca2d5395f6af00c1\n\n\n-----\n\nAsyncRAT 58BEE75D7A00CA8D8C0E9FBBC8ADA035B82DE90CBACF63F1AC7E1DB0E771AA28\n\nB49F3B8AAE24C6AE2026E86A1D12F2487DD768C1326BFC7E3BB610DB7A0E857B\n\n39FEF91CA4778FA05C5A4081F772B47E5728B61D37358707DF5F45717D0B2A8C\n\nAD506EAE3573368A97ECE57F9FB38AF83E16AD4D0273633CA57FBAE991A90C0A\n\nE8BF9507841E5873D248EBDD303D499762D10B59F90BE56441E068FBA28AB6D9\n206159F87A621F278D884539B21E1EBABCF7C250E94935D5BA72F5B25D3EB777\n\nBC59B8C66B46AE091A1A81FA88172C8736F83B75904FFE8A21D098D3F4AAD244\n\nD445D834E59E52B133C15B6E77F0633B32B2932282D66AB93777FEFED07342D4\n\n2E8BC122CD796D2D9D12C30245E5DF506902E5600449274690246287F03FABED\n\n907BF4192509BA05DE03D98005053E7E46C884A3A5C7FE4CC002CF87F67359B3\n\nF0CFA28585CA50CD64E6A618F5629EB39391BA0697D0604989C7DAC00946A599\n\n57EE165285FBB3FE294D7155B033F32AB8D343055BA7BA8D90C810E143E53AD9\n\nc2 Pop11.ddns[.]net:6666\n\nWthcv.sytes[.]net:7400\n\n2pop.ddns[.]net:6666\n\n11l19secondpop.ddns[.]net:6666\n\nNewsa.ddns[.]net:6606\n\nElliotgateway.ddns[.]net:5555\n\nPython.myvnc[.]com:7707\n\nNewopt.servehttp[.]com:7707\n\nNomako.ddns[.]net:6606\n\nPython.blogsyte[.com:6606\n\nEmails 1241b9486d3d7c74c0bb1f2a7bdd81ff9597b2c92f2af8a5b3819b296c400336\n\nD67bd08e03a5e2054aae8458b0c549cec2f988a9e703d3ed755626d840990a0e\n\n845c7c30fb7c1ca0de473f7e9d41c2b1a337d5e4919854461da6002e1fbc8fa3\n\n### We Are Here to Help\n\nThis new attack campaign is bad news, especially since most NGAV and EDR vendors’ solutions are\nfailing to detect and stop this threat; however, the good news for Morphisec customers is that our\nMoving Target Defense technology is stopping these attacks. Leading analysts are calling Moving\n\n\n-----\n\nTarget Defense a game changer as it can uniquely detect and stop ransomware, zero-day and other\nadvanced attacks that often bypass NGAV, EDR, and other defenses. Learn more about Moving\nTarget Defense and why Gartner cited this technology in its Emerging Trends and Technologies\nImpact Radar for Security.\n\n[Contact SalesInquire via Azure](http://10.10.0.46/mailto:sales@morphisec.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-25 - New Threat Campaign Identified- AsyncRAT Introduces a New Delivery Technique.pdf"
    ],
    "report_names": [
        "2022-01-25 - New Threat Campaign Identified- AsyncRAT Introduces a New Delivery Technique.pdf"
    ],
    "threat_actors": [
        {
            "id": "e8e18067-f64b-4e54-9493-6d450b7d40df",
            "created_at": "2022-10-25T16:07:24.515213Z",
            "updated_at": "2025-03-27T02:02:10.267637Z",
            "deleted_at": null,
            "main_name": "Mummy Spider",
            "aliases": [
                "ATK 104",
                "Gold Crestwood",
                "Mummy Spider",
                "TA542"
            ],
            "source_name": "ETDA:Mummy Spider",
            "tools": [
                "Emotet",
                "Geodo",
                "Heodo"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "506404b2-82fb-4b7e-b40d-57c2e9b59f40",
            "created_at": "2023-01-06T13:46:38.870883Z",
            "updated_at": "2025-03-27T02:00:02.939775Z",
            "deleted_at": null,
            "main_name": "MUMMY SPIDER",
            "aliases": [
                "TA542",
                "GOLD CRESTWOOD"
            ],
            "source_name": "MISPGALAXY:MUMMY SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535750,
    "ts_updated_at": 1743041168,
    "ts_creation_date": 1653693459,
    "ts_modification_date": 1653693459,
    "files": {
        "pdf": "https://archive.orkl.eu/fceadab8ec3a4748cc2dcdeedfee86f94a2b017f.pdf",
        "text": "https://archive.orkl.eu/fceadab8ec3a4748cc2dcdeedfee86f94a2b017f.txt",
        "img": "https://archive.orkl.eu/fceadab8ec3a4748cc2dcdeedfee86f94a2b017f.jpg"
    }
}