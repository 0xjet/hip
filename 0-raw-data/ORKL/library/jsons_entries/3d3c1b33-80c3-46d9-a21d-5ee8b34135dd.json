{
    "id": "3d3c1b33-80c3-46d9-a21d-5ee8b34135dd",
    "created_at": "2023-01-12T15:02:52.59612Z",
    "updated_at": "2025-03-27T02:05:33.319321Z",
    "deleted_at": null,
    "sha1_hash": "96ffa7ceb167731a1a59937001a637ff16f11405",
    "title": "2022-08-25 - AppLocker Rules as Defense Evasion- Complete Analysis",
    "authors": "",
    "file_creation_date": "2022-09-01T10:28:36Z",
    "file_modification_date": "2022-09-01T10:28:36Z",
    "file_size": 5512701,
    "plain_text": "# AppLocker Rules as Defense Evasion: Complete Analysis\n\n**[splunk.com/en_us/blog/security/-applocker-rules-as-defense-evasion-complete-analysis.html](https://www.splunk.com/en_us/blog/security/-applocker-rules-as-defense-evasion-complete-analysis.html)**\n\nBy [Splunk Threat Research Team August 25, 2022](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)\n\n\nAugust 25, 2022\n\n\nMicrosoft continues to develop, update and improve features to monitor and prevent the execution of\n[malicious code on the Windows opearting system. One of these features is AppLocker. This feature advances](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/applocker/applocker-overview)\nthe functionality of software restriction policies and enables administrators to create rules to allow or deny\napplications from running based on their unique identities (e.g., files) and to specify which users or groups\ncan run those applications.\n\n\n-----\n\nAppLocker has the ability to control the execution of executables ( .exe and .com ), scripts ( .js, ps1,\n“vbs”, “.cmd” and “.bat”), windows installer (“.msi, “.mst”, “.msp”), dll modules, packaged apps, and app\ninstaller.\n\nThis software restriction policy may be abused by adversaries, like the “Azorult loader,” a payload that imports\nits own AppLocker policy to deny the execution of several antivirus components as part of its defense\nevasion.\n\nIn this blog, the Splunk Threat Research Team will do a deep dive analysis on “Azorult loader” and its several\ncomponents to understand tactics and techniques that may help SOC analysts and blue teamers defend\nagainst these types of threats.\n\n_[(For a larger resolution of this diagram visit this link)](https://imgur.com/a/a3Hhd2O)_\n\n## Azorult Loader\n\nAzorult loader is a classic “Trojan Horse” that contains several components including the Azorult malware\n[itself and additional embedded files to enable remote access and data collection. This loader is an autoit](https://en.wikipedia.org/wiki/AutoIt)\ncompiled executable that contains a self-extracting stream in its resource sections along with several files.\n\n### Defense Evasion\n\nAzorult implements a hardcoded sandbox evasion checklist: It looks for specific usernames, files on the\ndesktop, hostnames and processes running on the targeted host. If identified, it will exit. It will also terminate\nits execution if the OS version of the compromised host is “winxp”.\n\n**Username** **Computername** **Files in Desktop** **Processes**\n\n\n-----\n\nPeter Wilson\n\nAcme\n\nBOBSPC\n\nJohnson\n\nJohn\n\nJohn Doe\n\nRivest\n\nmw\n\nme\n\nsys\n\nApiary\n\nSTRAZNJICA.GRUBUTT\n\nPhil\n\nCustomer\n\nshimamu\n\n\nRALPHS-PC\n\nABC-WIN7\n\nman-PC\n\nluser-PC\n\nKlone-PC\n\ntpt-PC\n\nBOBSPC\n\nWillCarter-PC\n\nPETER-PC\n\nDavid-PC\n\nART-PC\n\nTOM-PC\n\n\n@DesktopDir +\\secret.txt\n\n@DesktopDir + \\my.txt\n\n@DesktopDir +\\report.odt\n\n@DesktopDir +\\report.rtf\n\n@DesktopDir +\n\\Incidents.pptx\n\n\nJoeboxcontrol.exe\n\nJoeboxserver.exe\n\nFrida-winjector-helper32.exe\n\nanalyzer.exe\n\n\nIf the “msseces.exe” process is running, it will try to uninstall the “Microsoft Security Client” by using the\nwmic.exe command shown below.\n```\nC:\\Windows\\System32\\wbem\\wmic.exe product where name=\"Microsoft Security Client\" call uninstall\n/nointeractive\n\n\n```\nIt will also disable several registry keys related to the Windows Defender application feature and other AV\nproducts to evade their detections. Figures 1.1 and 1.2 shows screenshots of the autoit script code that\nmodifies those registry values.\n\n_Figure 1.1_\n\n\n-----\n\n_Figure 1.2_\n\nIt will also try to stop, delete and even modify the configuration of some services as part of its execution and\ndisable antivirus products. Figure 2 shows the code list of those services.\n\n_Figure 2_\n\nIt will attempt to block SMB ports (445, 139 and update the firewall configuration to allow its dropped\nmalicious files to perform network connections. Figure 3 shows the netsh command that modifies firewall\nrules.\n\n_Figure 3_\n\nUsing the attrib and icacls Windows binaries, it will set the hidden attribute and a deny permission access on\nseveral AV product installation root folders like what we see in Figures 4 and 5.\n\n\n-----\n\n_Figure 4_\n\n_Figure 5_\n\n### First Stage Drop Files\n\nThe loader will drop files as seen in Figure 6. The “temp.bat” is a cleanup batch file that will delete some of\nthe dropped files and add a hidden attribute on the created directory C:\\Programdata\\Windows. The\n“clean.bat” is responsible for killing malwarebytes “mbamservice.exe” process, stopping or deleting more\nservices related to AV products and coin miners like “MinerGate”.\n\n_Figure 6_\n\n\n-----\n\nThe H.bat is responsible for blocking AV, coin miner and some GitHub websites by redirecting it to the local\nhost IP address of the compromised host by adding an entry to the\n“%SystemRoot%\\System32\\drivers\\etc\\hosts”. Figure 7 shows some of the url links it tries to block and how it\nadds the entry to the hosts file.\n\n_Figure 7_\n\nThe file “5.xml” is one of the most interesting parts of this malware. It contains AppLocker rules designed for\ndefense evasion. This paper will explore the topic further specifically when we break down the components\nthat try to import this rule. The “ink.exe” is the actual Azorult malware. Figure 8.1 shows the strings command\nused to parse the browser database to collect sensitive information like credentials.\n\n_Figure 8.1_\n\nFigure 8.2 shows how it parses and steals the telegram, skype, and bitcoin wallet information stored on the\ntarget host and sends it to its C2 server.\n\n\n-----\n\n_Figure 8.2_\n\n### Drop file - Wini.exe\n\nOne of the executables dropped is named wini.exe. This is a self extracting archive (sfx). An archive that has\nbeen combined with an executable module, allowing Windows users to extract the archive's files without a\ndecompression program. Threat actors take advantage of this file type because it protects their malware with\na password, which helps it evade sandboxes or emulation without it.\n\nFigure 9 shows how the password prompt when executed without the password.\n\n\n-----\n\n_Figure 9_\n\nDigging into the loader autoit script, the code below is the actual command line and password that execute\nthis sfx file.\n```\nRun(\"C:\\ProgramData\\Microsoft\\Intel\\wini.exe -pnaxui\")\n\n\n```\nWini.exe will drop the RMS radmin tool name as “rfusclient.exe” and “rutserv.exe”. Then, to install this tool, it\nwill also drop “install.vbs'' that will execute another drop file “install.bat” that will disable Windows Defender\napplication, set the registries of the “Remote Manipulator System” (RMS) tool (“reg1.reg” and “reg2.reg”),\nexecute the RMS server rutserver.exe and configure its services.\n\nFigure 10 shows the registry written in reg1.reg files related to the RMS tool and Figure 11 which is the code\nof install.bat.\n\n\n-----\n\n_Figure 10_\n\n_Figure 11_\n\nIt will also drop another executable named “winit.exe”. This is an autoit compiled binary responsible for\ngathering information on the compromised host like what AV was installed, OS version, video adapter and\nmuch more. After collecting the data, it will try to send it via SMTP or via email to a specific email and body\nformat. It will also execute “del.bat” which will delete itself.\n\nFigures 12.1 and 12.2 show the code of this executable and how it builds the body of its email that will be sent\nto a specific email address.\n\n\n-----\n\n_Figure 12.1_\n\n_Figure 12.2 Drop file - Cheat.exe_\n\n\n-----\n\nBoth cheat.exe and wini.exe are sfx files that are password protected with the password naxui . One of its\ndrop files is the “P.exe” that will drop and execute “1.exe” which is a copy of WebBrowserPassView.exe tool.\nWebBrowserPassView.exe is a Nirsoft tool for parsing credentials like passwords in browsers. The other drop\nfile of cheat.exe is the “taskhost.exe” which will execute the “P.exe”, “R8.exe” and the “taskhostw.exe”. It will\nalso install the “OpenCL.dll” component of Khronos OpenCl ICD loader that allows users to build applications\nagainst specific OpenCL implementations.\n\nThe taskhost.exe will also create a scheduled task as a persistence mechanism for its drop file\n“taskhostw.exe” and “winlogon.exe”. taskhost.exe will also download files from a specific FTP server\n(109.248.203.81), save them as c:\\programdata\\windowstask\\temp.exe, decrypt them and execute it.\nUnfortunately, the FTP server is inaccessible as of writing.\n\nFigure 13 shows how it sets up the connection to the FTP client and tries to parse the credentials in several\nURL links.\n\n_Figure 13_\n\nThe “winlogon.exe” is another autoit compiled file that looks for scheduled tasks containing “KMSAutoNet”,\n“KMS” and “KMSAuto”. Figure 14 shows how to list all the scheduled tasks using the “/query list” command\nand look for it using regex.\n\n\n-----\n\n_Figure 14_\n\nCheat.exe also drops another executable called “winlog.exe,” which then subsequently drops “winlogon.exe”\nin C:\\ProgramData\\Microsoft\\Intel. C:\\ProgramData\\Microsoft\\Intel\\winlogon.exe is a PowerShell script\nconverted to an executable file that will execute a PowerShell command to import the AppLocker policy drop\nby the actual loader name as “5.xml”.\n\nFigure 15 shows the code snippet of the AppLocker rule policy that applies to deny actions on several\nantivirus products.\n\n_Figure 15_\n\nBelow is the powershell command it uses to import this AppLocker policy.\n```\n“Import-Module applocker\" ; \"Set-AppLockerPolicy -XMLPolicy C:\\ProgramData\\microsoft\\Temp\\5.xml”\n\n```\n\n-----\n\nThe XML is well formatted and as soon as we import it to the AppLocker rule set, as seen in Figure 16, the\nantivirus products that try to have a deny action policy are seen clearly.\n\n_Figure 16_\n\n[As mentioned by Grzegorz Tworek, Applocker cannot block nor log processes with NT](https://twitter.com/0gtweet)\nAUTHORITY\\SERVICE present in the token which most AV engines use for their prevention component.\nHowever, AV engines also include components that run with less privileges focused on alerting and notifying\nusers about events identified by the engine. Azorult would only prevent these components from running using\nits dropped Applocker policy.\n\nFinally, the last droped file is “R8.exe”, another SFX file, which will decompress “db.rar” that contains\n“install.vbs”, that will execute ”bat.bat” to create a hidden special user account name as “John”, enable RDP\nconnections, execute “RDPWinst.exe” that enables Remote Desktop Host support and concurrent RDP\nsessions on reduced functionality systems, create local group user, set non-expiring password using “net\naccounts /maxpwage:unlimited”, set hidden attribute and delete itself.\n\nFigure 17 shows the code snippet of bat.bat file.\n\n\n-----\n\n_Figure 17_\n\n## Detections\n\nBelow are the existing and new (STRT) detections developed to detect tactics and techniques of this\nmalware.\n\n### Windows Applications Layer Protocol RMS Radmin Tool Namedpipe\n\nThis analytic identifies the use of default or publicly known named pipes used with RMX remote admin tool:\n```\n`sysmon` EventCode IN (17, 18) EventType IN ( \"CreatePipe\", \"ConnectPipe\") PipeName IN\n(\"\\\\RManFUSServerNotify32\", \"\\\\RManFUSCallbackNotify32\", \"\\\\RMSPrint*\")\n\n | stats min(_time) as firstTime max(_time) as lastTime count by Image EventType ProcessId PipeName\nComputer UserID\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_application_layer_protocol_rms_radmin_tool_namedpipe_filter`\n\n```\n\n-----\n\n### Windows Gather Victim Network Info Through IP Check Web Services\n\nThis analytic identifies a process that tries to connect to known IP web services:\n```\n`sysmon` EventCode=22 QueryName IN (\"*wtfismyip.com\", \"*checkip.amazonaws.com\", \"*ipecho.net\",\n\"*ipinfo.io\", \"*api.ipify.org\",\n\n \"*icanhazip.com\", \"*ip.anysrc.com\",\"*api.ip.sb\", \"ident.me\", \"www.myexternalip.com\",\n\"*zen.spamhaus.org\", \"*cbl.abuseat.org\", \"*b.barracudacentral.org\",\n\n \"*dnsbl-1.uceprotect.net\", \"*spam.dnsbl.sorbs.net\", \"*iplogger.org*\", \"*ip-api.com*\")\n\n | stats min(_time) as firstTime max(_time) as lastTime count by Image ProcessId QueryName\nQueryStatus QueryResults Computer EventCode\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_gather_victim_network_info_through_ip_check_web_services_filter`\n\n\n### Windows Impair Defense Add XML AppLocker Rules\n\n```\nThis analytic identifies a process that imports AppLocker XML rules using PowerShell commandlet:\n```\n| tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as\nfirstTime max(_time) as lastTime from datamodel=Endpoint.Processes\n\n where (Processes.process_name=pwsh.exe OR Processes.process_name=sqlps.exe OR\nProcesses.process_name=sqltoolsps.exe OR Processes.process_name=powershell.exe OR\nProcesses.process_name=powershell_ise.exe OR Processes.original_file_name=pwsh.dll OR\nProcesses.original_file_name=PowerShell.EXE OR Processes.original_file_name=powershell_ise.EXE) AND\nProcesses.process=\"*Import-Module Applocker*\" AND Processes.process=\"*Set-AppLockerPolicy *\" AND\nProcesses.process=\"* -XMLPolicy *\"\n\n by Processes.dest Processes.user Processes.parent_process Processes.process_name\nProcesses.original_file_name Processes.process Processes.process_id Processes.parent_process_id\n\n | `drop_dm_object_name(Processes)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_impair_defense_add_xml_applocker_rules_filter`\n\n```\n\n-----\n\n### Windows Impair Defense Deny Security Software With AppLocker\n\nThis analytic identifies a modification in the Windows registry by the AppLocker application that contains\ndetails or registry data values related to denying the execution of several Security products:\n```\n| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM\ndatamodel=Endpoint.Registry\n\n where (Registry.registry_path= \"*\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Group Policy\nObjects\\\\*\" AND Registry.registry_path= \"*}Machine\\\\Software\\\\Policies\\\\Microsoft\\\\Windows\\\\SrpV2*\")\n\n OR Registry.registry_path=\"*\\\\Software\\\\Policies\\\\Microsoft\\\\Windows\\\\SrpV2*\"\n\n AND Registry.registry_value_data = \"*Action\\=\\\"Deny\\\"*\"\n\n AND Registry.registry_value_data IN(\"*O=SYMANTEC*\",\"*O=MCAFEE*\",\"*O=KASPERSKY*\",\"*O=BLEEPING\nCOMPUTER*\", \"*O=PANDA SECURITY*\",\"*O=SYSTWEAK SOFTWARE*\", \"*O=TREND MICRO*\", \"*O=AVAST*\",\n\"*O=GRIDINSOFT*\", \"*O=MICROSOFT*\", \"*O=NANO SECURITY*\", \"*O=SUPERANTISPYWARE.COM*\", \"*O=DOCTOR WEB*\",\n\"*O=MALWAREBYTES*\", \"*O=ESET*\", \"*O=AVIRA*\", \"*O=WEBROOT*\")\n\n by Registry.user Registry.registry_path Registry.registry_value_data Registry.action\nRegistry.registry_key_name Registry.dest\n\n | `drop_dm_object_name(Registry)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_impair_defense_deny_security_software_with_applocker_filter`\n\n\n### Windows Powershell Import AppLocker Policy\n\n```\nThis analytic identifies a process that imports AppLocker XML rules using powershell commandlet:\n```\n`powershell` EventCode=4104 ScriptBlockText=\"*Import-Module Applocker*\" ScriptBlockText=\"*SetAppLockerPolicy *\" ScriptBlockText=\"* -XMLPolicy *\"\n\n | stats count min(_time) as firstTime max(_time) as lastTime by EventCode ScriptBlockText Computer\nuser_id\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_powershell_import_applocker_policy_filter`\n\n```\n\n-----\n\n### Windows Remote Access Software RMS Registry\n\nThis analytic identifies a modification or creation of Windows registry related to Remote Manipulator System\n(RMS) Remote Admin tool:\n```\n| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM\ndatamodel=Endpoint.Registry\n\n where Registry.registry_path= \"*\\\\SYSTEM\\\\Remote Manipulator System*\"\n\n by Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_data\nRegistry.action Registry.dest\n\n | `drop_dm_object_name(Registry)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_remote_access_software_rms_registry_filter`\n\n```\n\n-----\n\n### Windows Valid Account With Never Expires Password\n\nThis analytic identifies processes that update user account policies for password requirements with nonexpiring password:\n```\n| tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as\nfirstTime max(_time) as lastTime from datamodel=Endpoint.Processes\n\n where (Processes.process_name=\"net.exe\" OR Processes.original_file_name=\"net.exe\" OR\nProcesses.process_name=\"net1.exe\" OR Processes.original_file_name=\"net1.exe\")\n\n AND Processes.process=\"* accounts *\" AND Processes.process=\"* /maxpwage:unlimited\"\n\n by Processes.dest Processes.user Processes.parent_process Processes.process_name\nProcesses.original_file_name Processes.process Processes.process_id Processes.parent_process_id\n\n | `drop_dm_object_name(Processes)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_valid_account_with_never_expires_password_filter`\n\n\n### Windows Modify Registry Disable Toast Notifications\n\n```\nThis analytic detects a modification in the Windows registry to disable toast notifications:\n```\n| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM\ndatamodel=Endpoint.Registry\n\n where Registry.registry_path=\n\"*\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\PushNotifications\\\\ToastEnabled*\"\nRegistry.registry_value_data=\"0x00000000\"\n\n by Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_data\nRegistry.action Registry.dest\n\n | `drop_dm_object_name(Registry)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_modify_registry_disable_toast_notifications_filter`\n\n```\n\n-----\n\n### Windows Modify Registry Disable Windows Security Center Notif\n\nThis analytic detects a modification in the Windows registry to disable Windows center notifications:\n```\n| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM\ndatamodel=Endpoint.Registry\n\n where Registry.registry_path=\n\"*\\\\Windows\\\\CurrentVersion\\\\ImmersiveShell\\\\UseActionCenterExperience*\"\nRegistry.registry_value_data=\"0x00000000\"\n\n by Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_data\nRegistry.action Registry.dest\n\n | `drop_dm_object_name(Registry)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_modify_registry_disable_windows_security_center_notif_filter`\n\n\n### Windows Modify Registry Suppress Win Defender Notif\n\n```\nThis analytic detects a modification in the Windows registry to suppress Windows Defender notification:\n```\n| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM\ndatamodel=Endpoint.Registry\n\n where Registry.registry_path= \"*\\\\Windows Defender\\\\UX Configuration\\\\Notification_Suppress*\"\nRegistry.registry_value_data=\"0x00000001\"\n\n by Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_data\nRegistry.action Registry.dest\n\n | `drop_dm_object_name(Registry)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows modify registry suppress win defender notif filter`\n\n```\n\n-----\n\n### Windows Remote Services Allow RDP in Firewall\n\nThis analytic detects a modification in the Windows firewall to enable remote desktop protocol on a targeted\nmachine:\n```\n| tstats `security_content_summariesonly` values(Processes.process) as cmdline\n\n values(Processes.parent_process_name) as parent_process values(Processes.process_name)\n\n count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes\n\n where (Processes.process_name = \"netsh.exe\" OR Processes.original_file_name= \"netsh.exe\") AND\nProcesses.process = \"*firewall*\" AND Processes.process = \"*add*\" AND Processes.process =\n\"*protocol=TCP*\"\n\n AND Processes.process = \"*localport=3389*\" AND Processes.process = \"*action=allow*\"\n\n by Processes.dest Processes.user Processes.parent_process Processes.process_name\n\n Processes.process Processes.process_id Processes.parent_process_id |\n`drop_dm_object_name(Processes)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_remote_services_allow_rdp_in_firewall_filter`\n\n\n### Windows Remote Services Allow Remote Assistance\n\n```\nThis analytic identifies a modification in the Windows registry to enable remote desktop assistance on a\ntargeted machine:\n\n\n-----\n\n```\n| y_ _ y (_ ) (_ )\ndatamodel=Endpoint.Registry\n\n where Registry.registry_path= \"*\\\\Control\\\\Terminal Server\\\\fAllowToGetHelp*\"\nRegistry.registry_value_data=\"0x00000001\"\n\n by Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_data\nRegistry.action Registry.dest\n\n | `drop_dm_object_name(Registry)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_remote_services_allow_remote_assistance_filter`\n\n### Windows Remote Services RDP Enable\n\n```\nThis analytic detects a modification in the Windows registry to enable remote desktop protocol on a targeted\nmachine:\n```\n| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM\ndatamodel=Endpoint.Registry\n\n where Registry.registry_path= \"*\\\\Control\\\\Terminal Server\\\\fDenyTSConnections*\"\nRegistry.registry_value_data=\"0x00000000\"\n\n by Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_data\nRegistry.action Registry.dest\n\n | `drop_dm_object_name(Registry)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_remote_services_rdp_enable_filter`\n\n```\n\n-----\n\n### Windows Service Stop by Deletion\n\nThis analytic identifies Windows Service Control, `sc.exe`, attempting to delete a service:\n```\n| tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as\nfirstTime max(_time) as lastTime from datamodel=Endpoint.Processes\n\n where (Processes.process_name = sc.exe OR Processes.original_file_name = sc.exe)\nProcesses.process=\"* delete *\" by Processes.dest Processes.user Processes.parent_process\nProcesses.process_name\n\n Processes.original_file_name Processes.process Processes.process_id Processes.parent_process_id\n\n | `drop_dm_object_name(Processes)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_service_stop_by_deletion_filter`\n\n\n### Windows Modify Registry Disable Win Defender Raw Write Notif\n\n```\nThis analytic detects a modification in the Windows registry to disable Windows Defender raw write\nnotification feature:\n```\n| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM\ndatamodel=Endpoint.Registry\n\n where Registry.registry_path= \"*\\\\Windows Defender\\\\Real-Time\nProtection\\\\DisableRawWriteNotification*\" Registry.registry_value_data=\"0x00000001\"\n\n by Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_data\nRegistry.action Registry.dest\n\n | `drop_dm_object_name(Registry)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_modify_registry_disable_win_defender_raw_write_notif_filter`\n\n```\n\n-----\n\n### Windows Modify Registry Disabling WER Settings\n\nThis analytic identifies a modification in the Windows registry to disable Windows error reporting settings:\n```\n| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM\ndatamodel=Endpoint.Registry\n\n where Registry.registry_path= \"*\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\\\\disable*\"\nRegistry.registry_value_data=\"0x00000001\"\n\n by Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_data\nRegistry.action Registry.dest\n\n | `drop_dm_object_name(Registry)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_modify_registry_disabling_wer_settings_filter`\n\n\n### Windows Modify Registry DisAllow Windows App\n\n```\nThis analytic detects a modification in the Windows registry to prevent users running specific computer\nprograms that could aid them in manually removing malware or detecting it using security products:\n```\n| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM\ndatamodel=Endpoint.Registry\n\n where Registry.registry_path=\n\"*\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\DisallowRun*\"\nRegistry.registry_value_data=\"0x00000001\"\n\n by Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_data\nRegistry.action Registry.dest\n\n | `drop_dm_object_name(Registry)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_modify_registry_disallow_windows_app_filter`\n\n```\n\n-----\n\n### Windows Modify Registry Regedit Silent Reg Import\n\nThis analytic identifies possible modifications of Windows registry using regedit.exe application with silent\nmode parameter:\n```\n| tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as\nfirstTime max(_time) as lastTime from datamodel=Endpoint.Processes\n\n where (Processes.process_name=\"regedit.exe\" OR Processes.original_file_name=\"regedit.exe\")\n\n AND Processes.process=\"* /s *\" AND Processes.process=\"*.reg*\"\n\n by Processes.dest Processes.user Processes.parent_process Processes.process_name\nProcesses.original_file_name Processes.process Processes.process_id Processes.parent_process_id\n\n | `drop_dm_object_name(Processes)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_modify_registry_regedit_silent_reg_import_filter`\n\n\n### Windows Remote Service RDPWinst Tool Execution\n\n```\nThis analytic identifies the process of \"RDPWInst.exe\" tool which is a RDP wrapper library tool designed to\nenable remote desktop host support and concurrent RDP session on reduced functionality:\n\n\n-----\n\n```\n| y_ _ y ( p ) p (_ )\nfirstTime max(_time) as lastTime from datamodel=Endpoint.Processes\n\n where (Processes.process_name=\"RDPWInst.exe\" OR Processes.original_file_name=\"RDPWInst.exe\")\n\n AND Processes.process IN (\"* -i*\", \"* -s*\", \"* -o*\", \"* -w*\", \"* -r*\")\n\n by Processes.dest Processes.user Processes.parent_process Processes.process_name\nProcesses.original_file_name Processes.process Processes.process_id Processes.parent_process_id\n\n | `drop_dm_object_name(Processes)`\n\n | `security_content_ctime(firstTime)`\n\n | `security_content_ctime(lastTime)`\n\n | `windows_remote_service_rdpwinst_tool_execution_filter`\n\n```\n\n**Type** **Name**\n\n\n**Technique**\n**ID** **Tactic** **Description**\n\n\nTTP [Attempt To Stop Security Service](https://research.splunk.com/endpoint/attempt_to_stop_security_service/) [T1562.001](https://attack.mitre.org/techniques/T1562/001/) Defense\nEvasion\n\n\nThis search looks\nfor attempts to stop\nsecurity-related\nservices on the\nendpoint.\n\n\nTTP [CHCP Command Execution](https://research.splunk.com/endpoint/chcp_command_execution/) [T1059](https://attack.mitre.org/techniques/T1059/) [Execution](https://attack.mitre.org/tactics/TA0002) This search is to\ndetect the execution\nof chcp.exe\napplication\n\nHunting [cmd_carry_out_string_command_parameter](https://research.splunk.com/endpoint/cmd_carry_out_string_command_parameter/) [T1059.003](https://attack.mitre.org/techniques/T1059/003/) [Execution](https://attack.mitre.org/tactics/TA0002) This analytic\nidentifies commandline arguments\nwhere cmd.exe /c is\nused to execute a\nprogram.\n\nTTP [Create local admin accounts using net exe](https://research.splunk.com/endpoint/create_local_admin_accounts_using_net_exe/) [T1136.001](https://attack.mitre.org/techniques/T1136/001/) Persistence This search looks\nfor the creation of\nlocal administrator\naccounts using\nnet.exe\n\n\n-----\n\nTTP Detect Use of cmd exe to Launch Script\nInterpreters\n\n\n[T1059.003](https://attack.mitre.org/techniques/T1059/003/) [Execution](https://attack.mitre.org/tactics/TA0002) This search looks\nfor the execution of\nthe cscript.exe or\nwscript.exe\nprocesses, with a\nparent of cmd.exe.\n\n\nAnomaly [Excessive Attempt To Disable Services](https://research.splunk.com/endpoint/excessive_attempt_to_disable_services/) [T1489](https://attack.mitre.org/techniques/T1489/) [Impact](https://attack.mitre.org/tactics/TA0040) This analytic will\nidentify suspicious\nseries of commandline to disable\nseveral services.\n\n\nAnomaly [Excessive Usage Of Cacls App](https://research.splunk.com/endpoint/excessive_usage_of_cacls_app/) [T1222](https://attack.mitre.org/techniques/T1222/) Defense\nEvasion\n\n\nThis analytic\nidentifies excessive\nusage of cacls.exe,\nxcacls.exe, or\nicacls.exe\napplications to\nchange file or folder\npermission.\n\n\nAnomaly [Excessive Usage Of Net App](https://research.splunk.com/endpoint/excessive_usage_of_net_app/) [T1531](https://attack.mitre.org/techniques/T1531/) [Impact](https://attack.mitre.org/tactics/TA0040) This analytic\nidentifies excessive\nusage of net.exe or\nnet1.exe\n\nAnomaly [Excessive Usage Of SC Service Utility](https://research.splunk.com/endpoint/excessive_usage_of_sc_service_utility/) [T1569.002](https://attack.mitre.org/techniques/T1569/002/) [Execution](https://attack.mitre.org/tactics/TA0002) This search is to\ndetect a suspicious\nexcessive usage of\nsc.exe in a host\nmachine.\n\n\nAnomaly [Excessive Usage Of Taskkill](https://research.splunk.com/endpoint/excessive_usage_of_taskkill/) [T1562.001](https://attack.mitre.org/techniques/T1562/001/) Defense\nEvasion\n\n\nTTP Executables Or Script Creation In\nSuspicious Path\n\n\n[T1036](https://attack.mitre.org/techniques/T1036/) Defense\nEvasion\n\n\nThis analytic\nidentifies excessive\nusage of\ntaskkill.exe\napplication.\n\nThis analytic will\nidentify suspicious\nexecutables or\nscripts (known file\nextensions) in a list\nof suspicious file\npaths in Windows.\n\n\n-----\n\nAnomaly [Firewall Allowed Program Enable](https://research.splunk.com/endpoint/firewall_allowed_program_enable/) [T1562.004](https://attack.mitre.org/techniques/T1562/004/) Defense\nEvasion\n\nTTP [Hide User Account From Sign-In Screen](https://research.splunk.com/endpoint/hide_user_account_from_sign-in_screen/) [T1562.001](https://attack.mitre.org/techniques/T1562/001/) Defense\nEvasion\n\nTTP [Hiding Files And Directories With Attrib exe](https://research.splunk.com/endpoint/hiding_files_and_directories_with_attrib_exe/) [T1222.001](https://attack.mitre.org/techniques/T1222/001/) Defense\nEvasion\n\nTTP [Icacls Deny Command](https://research.splunk.com/endpoint/icacls_deny_command/) [T1222](https://attack.mitre.org/techniques/T1222/) Defense\nEvasion\n\n\nThis analytic\ndetects a potential\nsuspicious\nmodification of\nfirewall rule allowing\nto execution of\nspecific\napplications.\n\nThis analytic\nidentifies a\nsuspicious registry\nmodification to hide\na user account on\nthe Windows Login\nscreen.\n\nAttackers leverage\nan existing\nWindows binary,\nattrib.exe, to mark\nspecific as hidden\nby using specific\nflags so that the\nvictim does not see\nthe file.\n\nThis analytic\nidentifies a potential\nadversary that\nchanges the\nsecurity permission\nof a specific file or\ndirectory.\n\n\nHunting [Net Localgroup Discovery](https://research.splunk.com/endpoint/net_localgroup_discovery/) [T1069.001](https://attack.mitre.org/techniques/T1069/001/) [Discovery](https://attack.mitre.org/tactics/TA0007) This hunting\nanalytic will identify\nthe use of\nlocalgroup\ndiscovery using net\nlocalgroup\n\nHunting [Network Connection Discovery With Net](https://research.splunk.com/endpoint/network_connection_discovery_with_net/) [T1049](https://attack.mitre.org/techniques/T1049/) [Discovery](https://attack.mitre.org/tactics/TA0007) This analytic looks\nfor the execution of\nnet.exe with\ncommand-line\narguments utilized\nto get a listing of\nnetwork\nconnections on a\ncompromised\nsystem.\n\n\n-----\n\nTTP [Processes launching netsh](https://research.splunk.com/endpoint/processes_launching_netsh/) [T1562.004](https://attack.mitre.org/techniques/T1562/004/) Defense\nEvasion\n\nTTP [Sc exe Manipulating Windows Services](https://research.splunk.com/endpoint/sc_exe_manipulating_windows_services/) [T1543.003](https://attack.mitre.org/techniques/T1543/003/) Privilege\nEscalation\n\n\nTTP Scheduled Task Deleted Or Created via\nCMD\n\nAnomaly Suspicious Scheduled Task from Public\nDirectory\n\n\n[T1053.005](https://attack.mitre.org/techniques/T1053/005/) Execution,\nPersistence,\nPrivilege\nEscalation\n\n[T1053.005](https://attack.mitre.org/techniques/T1053/005/) Execution,\nPersistence,\nPrivilege\nEscalation\n\n\nThis search looks\nfor processes\nlaunching\nnetsh.exe.\n\nThis search looks\nfor arguments to\nsc.exe indicating\nthe creation or\nmodification of a\nWindows service.\n\nThis analytic\nidentifies the\ncreation or deletion\nof a scheduled task\nusing schtasks.exe\nwith flags - create\nor delete being\npassed on the\ncommand-line.\n\nThis detection\nidentifies Scheduled\nTasks registering\n(creating a new\ntask) a binary or\nscript to run from a\npublic directory\nwhich includes\nusers\\public,\n\\programdata\\ and\n\\windows\\temp\n\nThis registry\nmodification is\ndesigned to allow\nthe Consent Admin\nto perform an\noperation that\nrequires elevation\nwithout consent or\ncredentials.\n\nThis analytic is to\ndetect a suspicious\nmodification of the\nregistry to disable\nWindows Defender\nfeature.\n\n\nTTP [Allow Operation with Consent Admin](https://research.splunk.com/endpoint/allow_operation_with_consent_admin/) [T1548](https://attack.mitre.org/techniques/T1548/) Execution,\nPersistence,\nPrivilege\nEscalation\n\n\nTTP Disable Defender Submit Samples Consent\nFeature\n\n\n[T1562.001](https://attack.mitre.org/techniques/T1562/001/) Defense\nEvasion\n\n\n-----\n\nTTP [Disabling Remote User Account Control](https://research.splunk.com/endpoint/disabling_remote_user_account_control/) [T1548.002](https://attack.mitre.org/techniques/T1548/002/) Defense\nEvasion,\nPrivilege\nEscalation\n\nTTP [Windows DisableAntiSpyware Registry](https://research.splunk.com/endpoint/windows_disableantispyware_registry/) [T1562.001](https://attack.mitre.org/techniques/T1562/001/) Defense\nEvasion\n\n\nTTP [Disable Show Hidden Files](https://research.splunk.com/endpoint/disable_show_hidden_files/) [T1564.001](https://attack.mitre.org/techniques/T1564/001/)\n\n[T1562.001](https://attack.mitre.org/techniques/T1562/001/)\n\n\nDefense\nEvasion\n\n\nAnomaly Non Firefox Process Access Firefox Profile\nDir\n\n\n[T1555.003](https://attack.mitre.org/techniques/T1555/003/) Credential\nAccess\n\n\nTTP [Registry Keys Used For Persistence](https://research.splunk.com/endpoint/registry_keys_used_for_persistence/) [T1547.001](https://attack.mitre.org/techniques/T1547/001/) Persistence,\nPrivilege\nEscalation\n\nTTP [Windows Defender Exclusion Registry Entry](https://research.splunk.com/endpoint/windows_defender_exclusion_registry_entry/) [T1562.001](https://attack.mitre.org/techniques/T1562/001/) Defense\nEvasion\n\n\nThe search looks\nfor modifications to\nregistry keys that\ncontrol the\nenforcement of\nWindows User\nAccount Control\n(UAC).\n\nThe search looks\nfor the Registry Key\nDisableAntiSpyware\nset to disable. This\nis consistent with\nRyuk infections\nacross a fleet of\nendpoints.\n\nThis analytic\nidentifies a\nmodification in the\nWindows registry to\nprevent users from\nseeing all the files\nwith hidden\nattributes.\n\nThis search is to\ndetect an anomaly\nevent of a nonfirefox process\naccessing the files\nin the profile folder.\n\nThe search looks\nfor modifications to\nregistry keys that\ncan be used to\nlaunch an\napplication or\nservice at system\nstartup.\n\nThis analytic will\ndetect a suspicious\nprocess that\nmodifies a registry\nrelated to Windows\nDefender exclusion\nfeature.\n\n\n-----\n\nTTP [Disable Defender BlockAtFirstSeen Feature](https://research.splunk.com/endpoint/disable_defender_blockatfirstseen_feature/) [T1562.001](https://attack.mitre.org/techniques/T1562/001/) Defense\nEvasion\n\nTTP [Disable Defender Enhanced Notification](https://research.splunk.com/endpoint/disable_defender_enhanced_notification/) [T1562.001](https://attack.mitre.org/techniques/T1562/001/) Defense\nEvasion\n\nTTP [Disable Defender Spynet Reporting](https://research.splunk.com/endpoint/disable_defender_spynet_reporting/) [T1562.001](https://attack.mitre.org/techniques/T1562/001/) Defense\nEvasion\n\n\nAnomaly Windows Modify Registry Disable Toast\nNotifications (New)\n\nAnomaly Windows Modify Registry Disable Windows\nSecurity Center Notif (new)\n\nAnomaly Windows Modify Registry Suppress Win\nDefender Notif (New)\n\n\n[T1112](https://attack.mitre.org/techniques/T1112/) Defense\nEvasion\n\n[T1112](https://attack.mitre.org/techniques/T1112/) Defense\nEvasion\n\n[T1112](https://attack.mitre.org/techniques/T1112/) Defense\nEvasion\n\n\nThis analytic is to\ndetect a suspicious\nmodification of the\nregistry to disable\nWindows Defender\nfeature.\n\nThis technique is to\nbypass or evade\ndetection from\nWindows Defender\nAV product specially\nthe Enhanced\nNotification feature\nwhere user or\nadmin set to show\nor display alerts.\n\nThis technique is to\nbypass or evade\ndetection from\nWindows Defender\nAV products,\nespecially the\nspynet reporting for\nits telemetry.\n\nThis analytic is to\nidentify a\nmodification in the\nWindows registry\n\nto disable toast\nnotifications.\n\nThis analytic\nidentifies a\nmodification in the\nWindows registry\n\nto disable\nWindows center\nnotifications.\n\nThis analytic\nidentifies a\nmodification in the\nWindows registry\n\nto suppress\nWindows Defender\nnotification.\n\n\n-----\n\nAnomaly Windows Remote Services Allow Rdp In\nFirewall (New)\n\nAnomaly Windows Remote Services Allow Remote\nAssistance (new)\n\n\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/) Lateral\nMovement\n\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/) Lateral\nMovement\n\n\nThis analytic\ndetects a\nmodification in the\nWindows firewall\n\nto enable remote\ndesktop protocol on\na targeted machine.\n\nThis analytic\nidentifies\nmodifications in the\nWindows registry\n\nto enable remote\ndesktop assistance\non a targeted\nmachine.\n\n\nTTP [Windows Service Stop By Deletion(New)](https://research.splunk.com/endpoint/196ff536-58d9-4d1b-9686-b176b04e430b/) [T1489](https://attack.mitre.org/techniques/T1489/) [Impact](https://attack.mitre.org/tactics/TA0040) This analytic\nidentifies Windows\nService Control,\n`sc.exe`,\n\nattempting to\ndelete a service.\n\n\nTTP [Windows Remote Services RDP Enable](https://research.splunk.com/endpoint/8fbd2e88-4ea5-40b9-9217-fd0855e08cc0/)\n(new)\n\nTTP Windows Application Layer Protocol RMS\nRadmin Tool Namedpipe(New)\n\nTTP Allow Inbound Traffic By Firewall Rule\nRegistry(Modiffied)\n\n\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/) Lateral\nMovement\n\n[T1071](https://attack.mitre.org/techniques/T1071/) Command and\nControl\n\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/) Lateral\nMovement\n\n\nThis analytic\ndetects\nmodifications in the\nWindows registry\n\nto enable remote\ndesktop protocol on\na targeted machine.\n\nThis analytic\nidentifies the use of\ndefault or publicly\nknown named pipes\nused with RMX\nremote admin tool.\n\nThis analytic\ndetects a potential\nsuspicious\nmodification of\nfirewall\n\nrule registry\nallowing inbound\ntraffic in specific\nports with a public\nprofile.\n\n\n-----\n\nHunting Windows Gather Victim Network Info\nThrough Ip Check Web Services (new)\n\nHunting Windows Impair Defense Add Xml\nAppLocker Rules(New)\n\nTTP Windows Impair Defense Deny Security\nSoftware With AppLocker(New)\n\nTTP Windows Powershell Import AppLocker\nPolicy(New)\n\nTTP Windows Remote Access Software RMS\nRegistry(New)\n\n\n[T1590.005](https://attack.mitre.org/techniques/T1590/005/) [Reconnaissance](https://attack.mitre.org/tactics/TA0043) This analytic\nidentifies a process\nthat tries to\nconnect to known\nIP web services.\n\n\n[T1562.001](https://attack.mitre.org/techniques/T1562/001/) Defense\nEvasion\n\n[T1562.001](https://attack.mitre.org/techniques/T1562/001/) Defense\nEvasion\n\n[T1562.001](https://attack.mitre.org/techniques/T1562/001/) Defense\nEvasion\n\n[T1219](https://attack.mitre.org/techniques/T1219/) Command and\nControl\n\n\nThis analytic\nidentifies a process\nthat imports\nAppLocker xml\nrules using\npowershell\ncommandlet.\n\nThis analytic\nidentifies a\nmodification in the\nWindows registry\n\nby the AppLocker\napplication that\ncontains details or\nregistry data values\nrelated to denying\nthe execution of\nseveral Security\nproducts.\n\nThis analytic\ndetects a process\nthat imports\nAppLocker xml\nrules using\npowershell\ncommandlet.\n\nThis analytic\nidentifies\nmodification or\ncreation of\nWindows registry\n\nrelated to the\nRemote\nManipulator System\n(RMS) Remote\nAdmin tool.\n\n\n-----\n\nTTP Windows Valid Account With Never Expires\nPassword(New)\n\nAnomaly Windows Modify Registry Disable Win\nDefender Raw Write Notif(New)\n\nTTP Windows Modify Registry Disabling WER\nSettings(New)\n\nWindows Modify Registry DisAllow Windows\nApp(New)\n\nTTP Windows Modify Registry Regedit Silent\nReg Import(New)\n\n\n[T1489](https://attack.mitre.org/techniques/T1489/) [Impact](https://attack.mitre.org/tactics/TA0040) This analytic\nidentifies processes\nthat update user\naccount policies for\npassword\nrequirements with a\nnon-expiring\npassword.\n\n\n[T1112](https://attack.mitre.org/techniques/T1112/) Defense\nEvasion\n\n[T1112](https://attack.mitre.org/techniques/T1112/) Defense\nEvasion\n\n[T1112](https://attack.mitre.org/techniques/T1112/) Defense\nEvasion\n\n[T1112](https://attack.mitre.org/techniques/T1112/) Defense\nEvasion\n\n\nThis analytic\nidentifies a\nmodification in the\nWindows registry\n\nto disable\nWindows Defender\nraw write\nnotification feature.\n\nThis analytic\ndetects a\nmodification in the\nWindows registry\n\nto disable\nWindows error\nreporting settings.\n\nThis analytic looks\nfor a modification in\nthe Windows\nregistry\n\nto prevent users\nfrom running\nspecific computer\nprograms that could\naid them in\nmanually removing\nmalware or\ndetecting it  using\nsecurity products.\n\nThis analytic looks\nfor possible\nmodification of\nWindows registry\n\nusing regedit.exe\napplication with\nsilent mode\nparameter.\n\n\n-----\n\nTTP Windows Remote Service RDPWinst Tool\nExecution(new)\n\n### IOC\n\nfilename: 5.xml\n\n\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/) Lateral\nMovement\n\n\nThis analytic\nidentifies process of\n\"RDPWInst.exe\"\ntool which is a rdp\nwrapper library tool\ndesigned to enable\nremote\n\ndesktop host\nsupport and\nconcurrent rdp\nsession on reduced\nfunctionality\nsystem.\n\n\nsha256: 9a8efbd09c9cc1ee7e8ff76ea60846b5cd5a47cdaae8e92331f3b7b6a5db4be5\n\nfilename: cheat.exe\n\nsha256: b80857cd30e6ec64e470480aae3c90f513115163c74bb584fa27adf434075ab2\n\nfilename: clean.bat\n\nsha256: 1134b862f4d0ce10466742beb334c06c2386e85acad72725ddb1cecb1871b312\n\nfilename: db.rar\n\nsha256: 534e0430f7e8883b352e7cba4fa666d2f574170915caa8601352d5285eee5432\n\nfilename: h.bat\n\nsha256: a33af2b70ad8fea8900b6bd31ac7b0aab8a2b8b79e3e27adafbd34bdfcb67549\n\nfilename: ink.exe\n\nsha256: 136590cb329a56375d6336b12878e18035412abf44c60bebdaa6c37840840040\n\nfilename: Install cheat 1_7.bin\n\nsha256: dd396a3f66ad728660023cb116235f3cb1c35d679a155b08ec6a9ccaf966c360\n\nfilename: P.exe\n\nsha256: 8215e35c9ce15a7b7373871b27100577d3e609856eac71080ac13972a6a6748b\n\nfilename: R8.exe\n\nsha256: 40d4931bbb3234a2e399e2e3e0dcfe4b7b05362c58d549569f2888d5b210ebbd\n\n\n-----\n\nfilename: taskhost.exe\n\nsha256: 892e0afefca9c88d43bdd1beea0f09faadef618af0226e7cd1acdb47e871a0db\n\nfilename: temp.bat\n\nsha256: ccf47d036ccfe0c8d0fe2854d14ca21d99be5fa11d0fbb16edcc1d6c10de3512\n\nfilename: wini.exe\n\nsha256: 9276d1bb2cd48fdf46161deaf7ad4b0dbcef9655d462584e104bd3f2a8c944ce\n\nfilename: winlog.exe\n\nsha256: 54eda5cc37afb3b725fa2078941b3b93b6aec7b8c61cd83b9b2580263ce54724\n\nfilename: cheat_exe\\P\\1.exe\n\nsha256: 7f11dabe46bf0af8973ce849194a587bd0ba1452e165faf028983f85b2b624c2\n\nfilename: cheat_exe\\R8\\db.rar\n\nsha256: 534e0430f7e8883b352e7cba4fa666d2f574170915caa8601352d5285eee5432\n\nfilename: cheat_exe\\R8\\pause.bat\n\nsha256: 46565c0588b170ae02573fde80ba9c0a2bfe3c6501237404d9bd105a2af01cba\n\nfilename: cheat_exe\\R8\\Rar.exe\n\nsha256: 2356220cfa9159b463d762e2833f647a04fa58b4c627fcb4fb1773d199656ab8\n\nfilename: cheat_exe\\R8\\run.vbs\n\nsha256: c7758bb2fdf207306a5b83c9916bfffcc5e85efe14c8f00d18e2b6639b9780fe\n\nfilename: cheat_exe\\taskhost\\opencl.dll\n\nsha256: 7cc0d32b00f4596bf0a193f9929e6c628bc1b9354678327f59db0bd516a0dd6b\n\nfilename: cheat_exe\\taskhost\\taskhostw.exe\n\nsha256: 00cb457c1bf203fdb75da2cb0ba517d177ea5decc071f27f6a5ba3ee7d30da93\n\nfilename: cheat_exe\\taskhost\\taskhostw\\winlogon.exe\n\nsha256: 870ff02d42814457290c354229b78232458f282eb2ac999b90c7fcea98d16375\n\nfilename: cheat_exe\\winlog\\winlogon.exe\n\nsha256: dc6d63798444d1f614d4a1ff8784ad63b557f4d937d90a3ad9973c51367079de\n\n\n-----\n\nfilename: wini_exe\\install.bat\n\nsha256: e3db831cdb021d6221be26a36800844e9af13811bac9e4961ac21671dff9207a\n\nfilename: wini_exe\\install.vbs\n\nsha256: cd8df8b0c43c36aabb0a960e4444b000a04eb513f0b34e12dbfd098944e40931\n\nfilename: wini_exe\\reg1.reg\n\nsha256: 7ae7e4c0155f559f3c31be25d9e129672a88b445af5847746fe0a9aab3e79544\n\nfilename: wini_exe\\reg2.reg\n\nsha256: 4ae04a85412ec3daa0fb33f21ed4eb3c4864c3668b95712be9ec36ef7658422a\n\nfilename: wini_exe\\rfusclient.exe\n\nsha256: dc9d875e659421a51addd8e8a362c926369e84320ab0c5d8bbb1e4d12d372fc9\n\nfilename: wini_exe\\rutserv.exe\n\nsha256: 1699b9b4fc1724f9b0918b57ca58c453829a3935efd89bd4e9fa66b5e9f2b8a6\n\nfilename: wini_exe\\vp8decoder.dll\n\nsha256: 4c04d7968a9fe9d9258968d3a722263334bbf5f8af972f206a71f17fa293aa74\n\nfilename: wini_exe\\vp8encoder.dll\n\nsha256: 81af82019d9f45a697a8ca1788f2c5c0205af9892efd94879dedf4bc06db4172\n\nfilename: wini_exe\\winit.exe\n\nsha256: e95fc3e7ed9ec61ba7214cc3fe5d869e2ee22abbeac3052501813bb2b6dde210\n\nfilename: wini_exe\\winit\\del.bat\n\nsha256: e376f2a9dda89354311b1064ea4559e720739d526ef7da0518ebfd413cd19fc1\n\n## Learn More\n\n[You can find the latest content about security analytic stories on GitHub and in Splunkbase.](https://github.com/splunk/security-content/releases/tag/v3.12.0) Splunk Security\nEssentials also has all these detections available via push update.\n\nFor a full list of security content, check out the [release notes on](https://docs.splunk.com/Documentation/ESSOC/3.21.0/RN/Enhancements) [Splunk Docs.](https://docs.splunk.com/Documentation/ESSOC)\n\nAny feedback or requests? Feel free to put in an issue on Github and we’ll follow up. Alternatively, join us on\nthe [Slack channel #security-research. Follow these instructions If you need an invitation to our Splunk user](https://splunk-usergroups.slack.com/)\ngroups on Slack.\n\n\n-----\n\n_Credit to author Teoderick Contreras and collaborators Rod Soto, Jose Hernandez, Patrick Bareiss, Lou_\n_Stella, Bhavin Patel, Michael Haag, Mauricio Velazco and Eric McGinnis._\n\nPosted by\n\n**[Splunk Threat Research Team](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)**\n\nThe Splunk Threat Research Team is an active part of a customer’s overall defense strategy by enhancing\nSplunk security offerings with verified research and security content such as use cases, detection searches,\nand playbooks. We help security teams around the globe strengthen operations by providing tactical guidance\nand insights to detect, investigate and respond against the latest threats. The Splunk Threat Research Team\nfocuses on understanding how threats, actors, and vulnerabilities work, and the team replicates attacks which\n[are stored as datasets in the Attack Data repository.](https://github.com/splunk/attack_data/)\n\nOur goal is to provide security teams with research they can leverage in their day to day operations and to\nbecome the industry standard for SIEM detections. We are a team of industry-recognized experts who are\nencouraged to improve the security industry by sharing our work with the community via conference talks,\nopen-sourcing projects, and writing white papers or blogs. You will also find us presenting our research at\nconferences such as Defcon, Blackhat, RSA, and many more.\n\n[Read more Splunk Security Content.](https://github.com/splunk/security_content)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-25 - AppLocker Rules as Defense Evasion- Complete Analysis.pdf"
    ],
    "report_names": [
        "2022-08-25 - AppLocker Rules as Defense Evasion- Complete Analysis.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535772,
    "ts_updated_at": 1743041133,
    "ts_creation_date": 1662028116,
    "ts_modification_date": 1662028116,
    "files": {
        "pdf": "https://archive.orkl.eu/96ffa7ceb167731a1a59937001a637ff16f11405.pdf",
        "text": "https://archive.orkl.eu/96ffa7ceb167731a1a59937001a637ff16f11405.txt",
        "img": "https://archive.orkl.eu/96ffa7ceb167731a1a59937001a637ff16f11405.jpg"
    }
}