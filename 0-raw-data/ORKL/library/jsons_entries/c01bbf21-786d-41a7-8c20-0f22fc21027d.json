{
    "id": "c01bbf21-786d-41a7-8c20-0f22fc21027d",
    "created_at": "2023-01-12T15:09:40.855494Z",
    "updated_at": "2025-03-27T02:05:56.655686Z",
    "deleted_at": null,
    "sha1_hash": "c8010679a7781f0d7d88ec5a732381ed3a4006e1",
    "title": "2022-03-29 - Exclusive Threat Research- Mars (Stealer) Attacks!",
    "authors": "",
    "file_creation_date": "2022-05-28T17:09:51Z",
    "file_modification_date": "2022-05-28T17:09:51Z",
    "file_size": 4850366,
    "plain_text": "# Exclusive Threat Research: Mars (Stealer) Attacks!\n\n**blog.morphisec.com/threat-research-mars-stealer**\n\n[Tweet](https://twitter.com/share)\n\n[The Morphisec Labs team has conducted research on the new Mars infostealer. Mars is based on the older Oski Stealer and was first](https://www.cyberark.com/resources/threat-research-blog/meet-oski-stealer-an-in-depth-analysis-of-the-popular-credential-stealer)\ndiscovered in June 2021. The new Mars is available for sale on several underground forums and is reported to be under constant\ndevelopment. The Mars Stealer pilfers user credentials stored in various browsers, as well as many different cryptocurrency wallets. Mars\nStealer is being distributed via social engineering techniques, malspam campaigns, malicious software cracks, and keygens. (For more about\n[infostealers, read Morphisec’s coverage of the Jupyter infostealer.)](https://blog.morphisec.com/jupyter-infostealer-backdoor-introduction)\n\n\n-----\n\nFigure 1: Mars stealer post on hacking forums.\n\nNot long after the Mars Stealer’s release, a cracked version was released with an instruction document. This guide has some flaws. One flaw\ninstructs users to set up full access (777) to the whole project, including the victims’ logs directory.\n\nFigure 2: Cracked Mars Stealer instruction guide.\n\nWhoever released the cracked Mars Stealer without official support has led threat actors to improperly configure their environment, exposing\ncritical assets to the world.\n\n## Infostealers Ecosystem\n\nAs [Sophos explains, information stealers are used for a wide variety of identity theft. They enable attackers to harvest personally identifiable](https://news.sophos.com/en-us/2021/08/03/trash-panda-as-a-service-raccoon-stealer-steals-cookies-cryptocoins-and-more/)\ninformation (PII), including login data such as stored credentials and browser cookies that control access to web-based services. These\ncredentials are then sold on criminal marketplaces.\n\n\n-----\n\nostea e s o e a access b e e t y po t to c a act ty o e a p e, o y $ 60 gets you a et e subsc pt o to a s Stea e ou ca\npurchase infostealers on Dark Web forums without any vetting, unlike more sophisticated tools such as ransomware, which require you to\nhave a reputation amongst other cybercriminals. Infostealers empower novice cybercriminals to build a reputation they can leverage to acquire\nmore powerful malware from more sophisticated actors.\n\n## Mars Stealer Statistics\n\nWith cryptocurrency use rising, more people will likely possess hot wallets in an unsecured environment. The crypto wallet MetaMask is the\nplugin most stolen using Mars Stealer.\n\nFigure 3: Top 5 stolen plugins\n\nThe Morphisec Labs Team compiled the below statistics while evaluating a single actor’s campaign last month. It includes targets by country,\ntotal stolen passwords, and so on. In addition, we found more than infected 50 domain users, compromising companies' domain passwords.\nThe vast majority of victims are students, faculty members, and content makers looking for legitimate applications who end up with malicious\nones instead. Aside from the listed credential types, Morphisec identified credentials which led to the full compromise of a leading healthcare\ninfrastructure provider in Canada, and a number of high profile Canadian service companies. We have contacted and notified the companies\nand the authorities.\n\nFigure 4: Mars admin panel\n\n## Operation Mars\n\nSpam email is the most common distribution method for Mars Stealer, as a compressed executable, download link, or document payload.\nCreating a malicious website masquerading as pirated software is another common method for spreading this infostealer.\n\n### Initial access vector\n\nIn this campaign, the actor distributed Mars Stealer via cloned websites offering well-known software. They used the Google Ads advertising\nplatform to trick victims searching for the original software into visiting a malicious site instead. The actor is paying for these Google Ads\ncampaigns using stolen information (see figure 15). The example below is one of many demonstrating how the actor targets Canadians by\nusing geographically targeted Google Ads.\n\n\n-----\n\nFigure 5: ‘OpenOffice’ Google search yields an actor's malicious website.\n\n[Below is a fully cloned website masquerading as the official openoffice.org website to lure victims to download the Mars Stealer.](https://www.openoffice.org/)\n\nFigure 6: Cloned OpenOffice website leads to the Mars stealer.\n\n[The downloaded payload is an executable file, with a corresponding icon and name, packed with the Babadeda crypter or Autoit loader. We](https://blog.morphisec.com/the-babadeda-crypter-targeting-crypto-nft-defi-communities)\n[won’t cover the Mars Stealer’s technical details, which were thoroughly covered by 3xp0rt. During our investigation and research, we identified](https://3xp0rt.com/posts/mars-stealer)\na C2—tommytshop[.]com—where the Mars admin panel is stored, which was still up and running at the time of publication.\n\n\n-----\n\nFigure 7: C2 open directory\n\nAs mentioned earlier, surprisingly, the stolen information directory was improperly configured and left open. We immediately identified that the\nvast majority of compromised victims are from Canada (files that start with CA_).\n\nFigure 8: Stolen Information\n\nBelow is an example of stolen information extracted from one of the folders. It’s quite self-explanatory:\n\n**Autofill - Stores browser autofill data**\n\n\n-----\n\n**CC** Sto es c ed t ca d o at o\n**Plugins - Stores browser extension data: Metamask, Coinbase wallet, Binance, etc.**\n**System.txt - Stores infected system information such as IP, country code, timezone, etc.**\n\n\nStolen information content\n\n\nFigure 9: Stolen information content\n\n## Mapping the Attack Infrastructure\n\nFortunately, the actor compromised his own computer with the Mars Stealer while debugging. This allowed us a rare peek into an operation by\nlooking at his own stolen information—screenshots, passwords, history, system information, etc. Below is an image we generated to\nsummarize the actor’s most relevant activity details.\n\n\n-----\n\nFigure 10: Recon diagram\n\nWe looked at the actor’s screenshots and discovered they were debugging their Mars Stealer builds using HTTP Analyzer. This revealed their\nsecond Mars Stealer C2 - http://5.45.84[.]214 which was improperly configured, similar to the first C2.\n\nFigure 11: Actor’s screenshot revealing additional C2\n\nAn additional screenshot led us to the actor’s GitLab account, which was continuously updated with the latest Mars Stealer builds under the\nname of “Tony Mont,” which has been active since late November 2021. We are assuming they do this for automation purposes.\n\n\n-----\n\nFigure 12: Actor’s GitLab account\n\nAnother interesting screenshot revealed this actor stores their passwords in a plain text document for almost every service they’re using.\n\n\n-----\n\ngu e 3 cto s p a te t pass o ds\n\n[The actor is also using Keitaro, a universal tracker for affiliate marketing. And the images below show the actor is a Russian speaker.](https://keitaro.io/en/)\n\nFigure 14: Keitaro panel\n\nThe actor’s Google Ads platform page, paid for with stolen credentials.\n\n\n-----\n\nFigure 15: Actor’s Google Ads campaign\n\n### Attribution\n\nWe can safely attribute this actor as a Russian national by looking at the screenshots and keyboard details from the extracted system.txt.\n\n## Protect Yourself From Infostealers like Mars Stealer\n\nMorphisec Labs will keep monitoring the Mars Stealer and provide updates when appropriate. Infostealers are used by a wide variety of\ncybercriminals, from novices to state-sponsored actors. They’re easy to acquire—and they work. Mars is currently being promoted in over 47\ndifferent underground forums, Darknet onion sites, and Telegram channels, and even has an official Telegram channel for purchasing through.\n\nMorphisec protects against advanced attack chains such as those used in the Mars stealer. We do this with our patented Moving Target\nDefense (MTD) technology, which blocks advanced and zero-day attacks. MTD uses system polymorphism to hide application assets,\noperating system assets, and other critical assets from adversaries. This leads to unpredictable and dramatically reduced attack surfaces.\n\nGartner analysts call Moving Target Defense a “game-changer.” Learn more about Moving Target Defense and why Gartner cited this\n[technology in its report: Emerging Trends and Technologies Impact Radar for Security.](https://engage.morphisec.com/gartner-emerging-technologies-trends-security-moving-target-defense)\n\n### Indicators of Compromise (IOCs)\n\n**Services**\n\n\n-----\n\n**IP/URL** **Service**\n\n91.92.128[.]35 Keitaro panel\n\nhttps://gitlab.com/corpsoft GitLab account\n\nserver315.web-hosting.com:2083 cPanel file manager\n\n**Mars C2**\n\ntommytshop[.]com\n\n5.45.84[.]214\n\n193.56.146[.]66\n\n185.212.130[.]47\n\ntonyshop312[.]com\n\n66.29.142[.]232\n\ntelemeetrydata[.]cn\n\n**Samples (SHA256)**\n\nc48e5a61fd89ac5e950a37e1d81d2f733c16983d369dbedbb3a0c3e8c97f7b14\n\n38807bc99d0f9a78480d3b12cfc96cdbfdb83bc277758595e77808b9b22ac087\n\nbb48381955c8676b866760129db84ffce2e0b9c1fdd6a0179ab022dbf6fea708\n\ncf1d4bf6b4a831d9664bbf0f40a609152a699f8d535c21e41ada406c47f63bfa\n\n10731eea825c6bbcd5c543b2c98f4de384b36279cabba22fa247cda865c59093\n\naf023cd8d2dcbeccfaf197094721768593154fc35019534a399563b011862a91\n\nc26e405d1f07a9090e83454a7a978d5a89ef4764b00e7b354e6b2bb653e49378\n\n9ed18a0b5e15bd4ecb73c5428e208b5d1b162274cfb0d6c62f7b5c3a04ec4d56\n\nab7e7d8594befb5a7137ec323db87a4aacfa64260327d61eee30626a760c3d5b\n\nd5ee3a86821e452c33f178dc080aff7ca5054518a719ef74320909cbb55bb6c5\n\n36613d674b4737da2b2986d9a49b48d06f1233cc7ea6aa7386bdb6d4bec90301\nb15cb7537c9da026144ce35c70b21f72f81c8855b537c6ae987e785447e90f42\n\nc3c1549bdd5613e9dbc3f09963cd1bd0f303b6f33bb4df62d9260590869cadec\n\n8f925aa659cdab2466d2860dfc06d14d1c384c7a449683813db8d9219ed333c9\n\n6929dae4d2bf6d2086bca0389e967f2c43bfb940da09b175b39df5fa1684a027\n\n\n-----\n\n[Contact SalesInquire via Azure](http://10.10.0.46/mailto:sales@morphisec.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-29 - Exclusive Threat Research- Mars (Stealer) Attacks!.pdf"
    ],
    "report_names": [
        "2022-03-29 - Exclusive Threat Research- Mars (Stealer) Attacks!.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536180,
    "ts_updated_at": 1743041156,
    "ts_creation_date": 1653757791,
    "ts_modification_date": 1653757791,
    "files": {
        "pdf": "https://archive.orkl.eu/c8010679a7781f0d7d88ec5a732381ed3a4006e1.pdf",
        "text": "https://archive.orkl.eu/c8010679a7781f0d7d88ec5a732381ed3a4006e1.txt",
        "img": "https://archive.orkl.eu/c8010679a7781f0d7d88ec5a732381ed3a4006e1.jpg"
    }
}