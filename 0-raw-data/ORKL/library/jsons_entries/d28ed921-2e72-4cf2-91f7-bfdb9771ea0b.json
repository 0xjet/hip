{
    "id": "d28ed921-2e72-4cf2-91f7-bfdb9771ea0b",
    "created_at": "2023-01-12T15:02:59.262335Z",
    "updated_at": "2025-03-27T02:05:20.81914Z",
    "deleted_at": null,
    "sha1_hash": "32f38579b478da1f99e67e2b520d754e15a4f7f6",
    "title": "2021-04-22 - AR21-112A- CISA Identifies SUPERNOVA Malware During Incident Response",
    "authors": "",
    "file_creation_date": "2022-05-29T01:06:50Z",
    "file_modification_date": "2022-05-29T01:06:50Z",
    "file_size": 133810,
    "plain_text": "# CISA Identifies SUPERNOVA Malware During Incident Response\n\n**us-cert.cisa.gov/ncas/analysis-reports/ar21-112a**\n\n## Summary\n\n_This Alert uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge_\n_(ATT&CK®) framework. See the_ _[ATT&CK for Enterprise framework for all referenced threat](https://attack.mitre.org/versions/v7/matrices/enterprise/)_\n_actor techniques._\n\nThe Cybersecurity and Infrastructure Security Agency (CISA) recently responded to an\nadvanced persistent threat (APT) actor’s long-term compromise of an entity’s enterprise\nnetwork, which began in at least March 2020. The threat actor connected to the entity’s\nnetwork via a Pulse Secure virtual private network (VPN) appliance, moved laterally to its\nSolarWinds Orion server, installed malware referred to by security researchers as\nSUPERNOVA (a .NET webshell), and collected credentials. (Updated April 29, 2021) **Note:**\nat this time CISA cannot link this activity to exploitation of CVE-2021-22893 as addressed in\n[AA21-110A. The entity has run the Ivanti Pulse Secure Connect Integrity Tool and found](https://us-cert.cisa.gov/ncas/alerts/aa21-110a)\nactivity consistent with mismatched files. CISA is still investigating the root cause for the\nmismatched files.\n\nSUPERNOVA is a malicious webshell backdoor that allows a remote operator to dynamically\ninject C# source code into a web portal to subsequently inject code. APT actors use\nSUPERNOVA to perform reconnaissance, conduct domain mapping, and steal sensitive\ninformation and credentials. (Note: for more information on SUPERNOVA, refer to Malware\n[Analysis Report MAR-10319053-1.v1 - SUPERNOVA.) According to a SolarWinds advisory,](https://us-cert.cisa.gov/ncas/analysis-reports/ar21-027a)\nSUPERNOVA is not embedded within the Orion platform as a supply chain attack; rather, an\nattacker places it directly on a system that hosts SolarWinds Orion, and it is designed to\n[appear as part of the SolarWinds product.[1] CISA assesses this is a separate actor than the](https://www.solarwinds.com/sa-overview/securityadvisory#anchor2)\nAPT actor responsible for the SolarWinds supply chain compromise described in Alert AA20[352A: Advanced Persistent Threat Compromise of Government Agencies, Critical](https://us-cert.cisa.gov/ncas/alerts/aa20-352a)\nInfrastructure, and Private Sector Organizations. Organizations that find SUPERNOVA on\ntheir SolarWinds installations should treat this incident as a separate attack.\n\nThis report provides tactics, techniques, and procedures (TTPs) CISA observed during an\nincident response engagement. (Note: this threat actor targeted multiple entities in the same\nperiod; some information in this Analysis Report is informed by other related incident\nresponse engagements and CISA’s public and private sector partners.) This APT actor has\nused opportunistic tradecraft, and much is still unknown about its TTPs.\n\nFor a downloadable copy of indicators of compromise (IOCs) associated with this malware,\n[see AR21-112A stix and Malware Analysis Report MAR-10319053-1 v1 stix](https://us-cert.cisa.gov/sites/default/files/publications/AR21_112A.stix.xml)\n\n\n-----\n\n## Description\n\nFrom at least March 2020 through February 2021, the threat actor connected to the entity via\n[the entity’s Pulse Secure VPN appliance (External Remote Services [T1133]). The threat](https://attack.mitre.org/versions/v8/techniques/T1133/)\nactor connected via the U.S.-based residential IP addresses listed below, which allowed\nthem to masquerade as teleworking employees. (Note: these IP addresses belong to routers\nthat are all similar models; based on this activity, CISA suspects that these routers were\nlikely exploited by the threat actor.)\n```\n   207.89.9[.]153\n   24.140.28[.]90\n   24.117.18[.]111\n\n```\nThe threat actor authenticated to the VPN appliance through several user accounts (Valid\n_Accounts_ [[T1078]), none of which had multi-factor authentication (MFA) enabled. (CISA does](https://attack.mitre.org/versions/v8/techniques/T1078/)\nnot know how the threat actor initially obtained these credentials.) Once authenticated to the\nVPN appliance, the threat actor initiated a VPN connection to the environment (External\n_Remote Services_ [[T1133]). The media access control (MAC) address of the threat actor’s](https://attack.mitre.org/versions/v8/techniques/T1133/)\nmachine as recorded in the VPN appliance logs indicates use of a virtual machine. The\nthreat actor then moved laterally to the entity’s SolarWinds Orion appliance (Lateral\n_Movement_ [[TA0008]) and established Persistence [TA0003] by using a PowerShell script](https://attack.mitre.org/versions/v8/tactics/TA0008/)\n(Command and Scripting Interpreter: PowerShell [[T1059.001]) to decode](https://attack.mitre.org/techniques/T1059/001/)\n(Deobfuscate/Decode Files or Information [[T1140]) and install SUPERNOVA (Ingress Tool](https://attack.mitre.org/versions/v8/techniques/T1140/)\n_Transfer_ [[T1105], Server Software Component: Web Shell](https://attack.mitre.org/versions/v8/techniques/T1105/) [[T1505.003]). The SUPERNOVA](https://attack.mitre.org/techniques/T1505/003/)\nwebshell allows a remote operator to dynamically inject C# source code into a web portal\nprovided via the SolarWinds software suite. The injected code is compiled and directly\nexecuted in memory. For more information on SUPERNOVA, refer to MAR-10319053-1.v1 SUPERNOVA.\n\nThe threat actor was able to dump credentials from the SolarWinds appliance via two\n[methods (Credential Access [TA0006]).](https://attack.mitre.org/versions/v8/tactics/TA0006/)\n\nThe threat actor used `Export-PfxCertificate to gather cached credentials used by`\nthe SolarWinds appliance server and network monitoring (Unsecured Credentials:\n_Private Keys_ [[T1552.004]). The private key certificate must have been marked as](https://attack.mitre.org/versions/v8/techniques/T1552/004/)\nexportable; either the threat actor was able to change or bypass that property prior, or\nthe affected entity mistakenly marked the certificate exportable.\n\n\n-----\n\nThe threat actor placed a copy of `procdump.exe` [(Ingress Tool Transfer [T1105])—](https://attack.mitre.org/versions/v8/techniques/T1105/)\ndisguised as the entity’s logging infrastructure, `splunklogger.exe` (Masquerading:\n_Rename System Utilities_ [[T1036.003])—on the SolarWinds Orion server. The threat](https://attack.mitre.org/versions/v8/techniques/T1036/003/)\nactor used this tool and the system-level access to dump Local Security Authority\nSubsystem Service (LSASS) memory to obtain additional credentials (OS Credential\n_Dumping: LSASS Memory_ [[T1003.001]). Once the credentials were dumped, the threat](https://attack.mitre.org/versions/v8/techniques/T1003/001/)\nactor placed them in the `c:\\inetpub\\SolarWinds\\ja\\license.txt directory (Data`\n_[Staged: Local Data Staging [T1074.001]), and the threat actor made a](https://attack.mitre.org/versions/v8/techniques/T1074/001/)_ `GET request to`\nthe entity’s internet information services (IIS) server to Exfiltrate [[TA0010] the file](https://attack.mitre.org/versions/v8/tactics/TA0010/)\n(Exfiltration Over C2 Channel [[T1041]). The threat actor deleted the IIS logs for the](https://attack.mitre.org/versions/v8/techniques/T1041/)\ndate in question (Indicator Removal on Host: Clear Windows Event Logs [[T1070.001]).](https://attack.mitre.org/versions/v8/techniques/T1070/001/)\n\nCISA believes the logs would have likely revealed the threat actor exploited CVE-202010148, an authentication bypass vulnerability in SolarWinds Orion Application Programming\n[Interface (API) that allows a remote attacker to execute API commands.[2] CISA believes the](https://kb.cert.org/vuls/id/843464)\nthreat actor leveraged CVE-2020-10148 to bypass the authentication to the SolarWinds\nappliance and then used SolarWinds Orion API `ExecuteExternalProgram() to run`\ncommands with the same privileges the SolarWinds appliance was running (in this case\n```\nSYSTEM ). CISA had not observed the threat actor using privileged accounts prior to the\n\n```\ncredential dumps, and the acc ount being used to connect to the SolarWinds appliance (via\nVPN) did not have sufficient privilege to access it. The PowerShell process that initiated the\ncredential harvesting and installation of SUPERNOVA was a child process of the\n```\nsolarwindsbusinesslayer.exe process. Two GET requests were logged in the following\n\n```\nday’s log, with the internal Dynamic Host Configuration Protocol (DHCP) address given to\nthe threat actor’s machine by the VPN appliance minutes after the exploitation, suggesting\nthe threat actor was interacting with the SolarWinds web application. (Note: although the\nthreat actor likely exploited CVE-2020-10148, it could have also exploited another API\nauthentication bypass or remote code execution (RCE) vulnerability.)\n\nSeveral weeks later, the threat actor connected again via the VPN appliance and attempted\nto use credentials gained from the SolarWinds appliance. The threat actor connected to one\nmachine via Server Message Block (SMB) (Transmission Control Protocol [TCP] port 445)\nand then attempted to login to an additional workstation (Remote Services: SMB/Windows\n_Admin Shares_ [[T1021.002]). No additional activity was observed during this session.](https://attack.mitre.org/versions/v8/techniques/T1021/002/)\n\nOn another occasion, the threat actor connected to the environment via the VPN and used\nWindows Management Instrumentation (WMI) (Windows Management Instrumentation\n\n[[T1047]) to remotely launch a tasklist to determine the process ID for the LSASS process](https://attack.mitre.org/versions/v8/techniques/T1047/)\n(Process Discovery [[T1057]). Then the threat actor, via WMI (Windows Management](https://attack.mitre.org/versions/v8/techniques/T1057/)\n_Instrumentation_ [[T1047]), launched](https://attack.mitre.org/versions/v8/techniques/T1047/) `procdump.exe, which was disguised as` `wininit.exe`\n(Masquerading: Match Legitimate Name or Location [[T1036.005]). After this, the threat actor](https://attack.mitre.org/versions/v8/techniques/T1036/005/)\nplaced and ran `winrar, which was also disguised as` `wininit.exe (Masquerading:`\n_Match Legitimate Name or Location_ [[T1036.005]), to archive credentials (Archive Collected](https://attack.mitre.org/versions/v8/techniques/T1036/005/)\n\n\n-----\n\n_Data: Archive via Utility_ [[T1560.001]) before Exfiltration](https://attack.mitre.org/versions/v8/techniques/T1560/001/) [[TA0010]. CISA observed the](https://attack.mitre.org/versions/v8/tactics/TA0010/)\ndisguised `wininit.exe commands on two separate machines—one server and one`\nworkstation. The commands executed were:\n\n```\ncmd.exe c:\\windows\\temp\\wininit.exe -accepteula -ma 992\n\n```\n```\n      c:\\windows\\temp\\TS_9D3C.tmp\n   winrar.exe :\n      c:\\windows\\temp\\wininit.exe a c:\\windows\\temp\\googleupdate.tmp       hpJimJameJump c:\\windows\\temp\\TS_9D3C.tmp.dmp\n\n```\nUpon discovery of the incident, the affected entity performed incident response in\naccordance with its incident response plan, and CISA’s engagement is ongoing. CISA\nencourages organizations to apply the recommendations provided in the\nRecommendations section. Organizations observing related activity should to enact their\nincident response plan.\n\n## Recommendations\n\nCISA recommends all organizations implement the following practices to strengthen the\nsecurity posture of their organization's systems.\n\nCheck for instances of common executables executing with the hash of another\nprocess (e.g., `splunklogger.exe with the hash of` `procdump ).`\nImplement MFA, especially for privileged accounts.\nUse separate administrative accounts on separate administration workstations.\nImplement Local Administrator Password Solution (LAPS).\nImplement the principle of least privilege on data access.\nSecure Remote Desktop Protocol (RDP) and other remote access solutions using MFA\nand “jump boxes” for access.\nDeploy and maintain endpoint defense tools on all endpoints.\nEnsure all software is up to date.\n\nIf your organization has ever used SolarWinds Orion versions 2019.4 through\n[2020.2.1 HF1, refer to CISA’s Emergency Directive ED 21-01, associated](https://cyber.dhs.gov/ed/21-01/)\nsupplemental guidance, and CISA’s Activity Alert [AA20-352A for additional](https://us-cert.cisa.gov/ncas/alerts/aa20-352a)\nguidance prior to applying patches. Although ED 21-01 and associated guidance\nonly apply to Federal Civilian Executive Branch agencies, CISA encourages non[federal entities to review them for recommendations on operating the SolarWinds](https://cyber.dhs.gov/ed/21-01/#supplemental-guidance-v3)\nOrion platform.\nMaintain up-to-date antivirus signatures and engines.\nRestrict users' ability (permissions) to install and run unwanted software applications.\nDo not add users to the local administrators' group unless required.\nEnforce a strong password policy and implement regular password changes.\n\n\n-----\n\nEnable a personal firewall on organization workstations that is configured to deny\nunsolicited connection requests.\nDisable unnecessary services on organization workstations and servers.\n\n## References\n\n Revisions\n\nApril 22, 2021: Initial Version\n\nApril 29, 2021: Added New Note in Summary\n\n[This product is provided subject to this Notification and this](https://us-cert.cisa.gov/privacy/notification) [Privacy & Use policy.](https://www.dhs.gov/privacy-policy)\n\n**Please share your thoughts.**\n\n[We recently updated our anonymous product survey; we'd welcome your feedback.](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://us-cert.cisa.gov/ncas/analysis-reports/ar21-112a)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-22 - AR21-112A- CISA Identifies SUPERNOVA Malware During Incident Response.pdf"
    ],
    "report_names": [
        "2021-04-22 - AR21-112A- CISA Identifies SUPERNOVA Malware During Incident Response.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535779,
    "ts_updated_at": 1743041120,
    "ts_creation_date": 1653786410,
    "ts_modification_date": 1653786410,
    "files": {
        "pdf": "https://archive.orkl.eu/32f38579b478da1f99e67e2b520d754e15a4f7f6.pdf",
        "text": "https://archive.orkl.eu/32f38579b478da1f99e67e2b520d754e15a4f7f6.txt",
        "img": "https://archive.orkl.eu/32f38579b478da1f99e67e2b520d754e15a4f7f6.jpg"
    }
}