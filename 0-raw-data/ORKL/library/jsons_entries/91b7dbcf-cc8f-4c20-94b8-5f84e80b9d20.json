{
    "id": "91b7dbcf-cc8f-4c20-94b8-5f84e80b9d20",
    "created_at": "2022-10-25T16:48:17.837009Z",
    "updated_at": "2025-03-27T02:16:25.908905Z",
    "deleted_at": null,
    "sha1_hash": "1614224bb566bb4c8e82501440d26fb707108757",
    "title": "The Urpage Connection to Bahamut, Confucius and Patchwork",
    "authors": "",
    "file_creation_date": "2018-12-06T03:25:37Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 366000,
    "plain_text": "# The Urpage Connection to Bahamut, Confucius and Patchwork\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/the-urpage-connection-to-bahamut-confucius-and-patchwork/](https://blog.trendmicro.com/trendlabs-security-intelligence/the-urpage-connection-to-bahamut-confucius-and-patchwork/)**\n\nTrend Micro August 29, 2018\n\n[Home  »  Mobile  »  The Urpage Connection to Bahamut, Confucius and Patchwork](https://blog.trendmicro.com/trendlabs-security-intelligence/)\n\n[0](https://blog.trendmicro.com/trendlabs-security-intelligence/the-urpage-connection-to-bahamut-confucius-and-patchwork/#respond)\n**_By Daniel Lunghi and Ecular Xu_**\n\nIn the process of monitoring changes in the threat\nlandscape, we get a clearer insight into the way threat\nactors work behind the schemes. In this case we dig\ndeeper into the possible connection between\ncyberattacks by focusing on the similarities an unnamed\n[threat actor shares with Confucius, Patchwork, and](https://blog.trendmicro.com/trendlabs-security-intelligence/deciphering-confucius-cyberespionage-operations/)\n[another threat actor called Bahamut. For the sake of this](https://www.bellingcat.com/resources/case-studies/2017/10/27/bahamut-revisited-cyber-espionage-middle-east-south-asia/)\nreport, we will call this unnamed threat actor “Urpage.”\n\nWhat sets Urpage attacks apart is its targeting of InPage,\na word processor for Urdu and Arabic languages. However, its Delphi backdoor component,\nwhich it has in common with Confucius and Patchwork, and its apparent use of Bahamutlike malware, is what makes it more intriguing as it connects Urpage to these other known\n[threats. In our previous entry, we already covered the Delphi component in the context of](https://blog.trendmicro.com/trendlabs-security-intelligence/confucius-update-new-tools-and-techniques-further-connections-with-patchwork/)\nthe Confucius and Patchwork connection. We mentioned Urpage as a third unnamed threat\nactor connected to the two. This time, we look into Urpage to gain a deeper insight into the\nway several threat actors’ actions intersect.\n\n**_The Bahamut Link_**\n\nFake websites\n\nThe link between Bahamut and Urpage can be best discussed by way of the multiple\nmalicious Android samples that matched Bahamut’s code and had C&C belonging to the\nUrpage infrastructure. Some of these C&C websites also act as phishing sites that lure\nusers into downloading these very applications. The threat actor sets up these fake\nwebsites describing the application and linking to the Google Play Store to download it, like\nin the case of the malicious website, pikrpro[.]eu, seen below\n\n\n-----\n\nAnother sample website involved the use of a closely copied version of an existing website,\nwith slight changes in the logo and options above the page. The download links were also\nreplaced to download the malicious Android application instead.\n\n_Figure 1. Original (top) and modified (bottom) website_\n\nUpon writing this entry, we’ve coordinated with Google to ensure that the malicious\napplications these C&C sites advertise are no longer available for download on the Google\nPlay Store. It is important to note however, that not all C&C websites for Urpage advertise\nmalicious applications. Some simply contain a random template with empty categories,\n\n\n-----\n\nAndroid targeting\nAs with Bahamut applications, once downloaded and executed, it showed multiple\nmalicious features that deal with stealing information. Some of these features are listed\nbelow.\n\nRetrieves basic information like network information and MAC address from an\ninfected phone\nSMS stealing\nContacts stealing\nAudio recording\nGPS location retrieval\nSteals files with the specific extensions, although not all samples target these\nextensions.\n\nFile type File extensions\n\nDocument files .txt, .csv, .doc, .docx, .xls, .xlsx,\n.pdf\n\nWhatsApp databases .db.crypt5 to .db.crypt12\n\n\nGeolocation related file\ns\n\n\n.kml, .kmz, .gmx, .aqm\n\n\nAudio files .mp3, .opus\n\nVideos .mp4, .amr, .wmv, .3gp,\n\nPictures .jpeg, .jpg\n\nOf note is one specific application that had a different purpose from the others. This\napplication has the same encryption routine as other Urpage applications. Instead of\nstealing documents or images, it works on top of a modified version of the legitimate\nThreema, an end-to-end encrypted messaging application, to steal screenshots of\nmessages.\n\nThis application has the same icon and label as the legitimate Threema. Once launched, it\ndrops a modified APK version of Threema and prompts the user to install the application.\nThe malicious application then hides its icon on the device but still runs in the background,\nwhile the modified Threema works like normal. Unknown to the user, the code in the\nmodified Threema allows it to take screenshots of itself every 10 seconds. These images\nare stored in the location/sdcard/Android/data/ch.threema.app/DataData directory, while\nthe “dropper” or the malicious application working in the background uploads the images to\nthe C&C for the threat actor to access.\n\n\n-----\n\n_Figure 2. Comparison of legitimate Threema code (left) to the modified version (right) with_\n_the inserted code_\n\nOther activities\n\nAside from acting as a C&C and distributing Bahamut-like malware, some of these\nwebsites also serve as the host for other malicious documents. These other activities\nfurther establish the link of Urpage — and consequently Bahamut — to other threat actors.\n\nTake, for example, the previously mentioned pikrpro[.]eu. This C&C website also acts as\nhost not only for the malicious Android application but also for two other malicious\ndocuments listed here.\n\nA malicious RTF file that exploits the CVE-2017-8750 and drops a malicious VB\nbackdoor with C&C appswonder[.]info\nA malicious InPage file that exploits CVE-2017-12824 and drops two files, one nonmalicious, and one malicious VB backdoor with C&C referfile[.]com\n\nTalos recently reported both C&C domain names with one type of campaign that targets\niOS and involves MDM, and another type using VB and Delphi backdoors. This leads us\nback to the Confucius and Patchwork link.\n\n**_The Confucius Link_**\n\n[In our previous entry, we already discussed how Confucius used the same Delphi file](https://blog.trendmicro.com/trendlabs-security-intelligence/confucius-update-new-tools-and-techniques-further-connections-with-patchwork/)\nstealer as Urpage. Digging into Urpage, we found another link—two malicious RTF files that\nexploit different vulnerabilities but download a similar script (detected as\nTROJ_POWLOAD.GAA) containing two base64-encoded URLs. One of the URLs is for the\ndecoy document, while the other one is for the payload.\n\nOne of the RTF files was found in a server related to Confucius\n(f1a54dca2fdfe59ec3f537148460364fb5d046c9b4e7db5fc819a9732ae0e063, detected as\nTROJ_CVE201711882.AG), while the other one\n(434d34c0502910c562f5c6840694737a2c82a8c44004fa58c7c457b08aac17bd,detected\nas Mal_CVE20170199-2) downloaded a VB Backdoor that pings back to twitck[.]com, a\ndomain name belonging to Urpage.\n\n**_The Patchwork Link_**\n\nPatchwork also uses the Delphi file stealer as a similarity with Urpage which suggests the\n\n\n-----\n\napplications we found whose code is like that of Bahamut, with the C&C matching the usual\nname registration pattern of Patchwork’s group, as well as an infrastructure close to an old\nPatchwork domain. Of note was how the C&C was not encrypted in the application code,\ndespite the fact that it contained the same encryption routines as other samples.\nPatchwork has also recently employed Android malware in its attacks, with its use of a\ncustomized version of AndroRAT.\n\n**_Summary_**\n\nThe many similarities and connections show that threat actors do not work in isolation, and\nthat attacks do not necessarily appear from out of nowhere. This may even suggest that a\n[single development team may be behind this attack — maybe a single paid group that has](https://ctt.ac/jQv59)\nsold its tools and services to other groups with different goals and targets.We’ve\nsummarized all the mentioned findings in the table below.\n\n**Urpage** **Bahamut** **Confucius** **Patchwork**\n\n“BioData” Delphi backdoor and file stealer X X X\n\nVB backdoor X\n\nAndroid “Bahamut-like” malware X X X\n\nCustom Android malware X\n\nAndroRAT Android malware X\n\nInPage malicious documents X X\n\nsimply obfuscated HTA downloaders X X\n\nIOS malware X\n\nConfucius malware X\n\nremote-access-c3 backdoor X\n\nSneepy/Byebye shell malware X\n\nPython cloud filestealers X\n\nAllaKore RAT X\n\nBadnews malware X\n\nQuasarRAT X\n\nNDiskMonitor malware X\n\n**_Targets_**\n\nWe did not find Urpage victims in our telemetry, likely because of the targeted nature of\nthese attacks. However, the domains used by Urpage provided hints about its target.\n\nFor one, there is the domain pikrpro[.]eu and its subdomains—the\nislamicfinderfeedback[.]pikrpro[.]eu and the memrifilesforinfo[.]pikpro[.]eu. The two pose as\nl iti t d b it th t id i t I l f ll d f th\n\n\n-----\n\nAdditionally, many of the files related to the Urpage domains are auto-extractable files that\ndrop Delphi or VB backdoor and open a decoy document. The decoy documents tell more\nabout Urpage’s possible targets, as it contains text from articles about the region of\nKashmir. The header for a sample document can be seen below.\n\nThe documents can also be image files with the same theme, as can be seen here.\n\nMultiple Android applications further drive this notion, as they provide services based on\nthe interests of users in that region. They have a malicious application that provides\nservices for religion, as well as popular sports in the region.\n\n\n-----\n\n_Figure 4. Malicious application for cricket news_\n\n**_Solutions and Mitigation_**\n\nTaking note of these similarities and connections can help organizations and users in their\ncontinued defense against Urpage, Bahamut, Confucius, and Patchwork. The connection of\nUrpage to the other three threat actors demonstrate that cyberattacks don’t exist in silos\nand that it hints at a circulation of knowledge and technologies that help in the continuing\nevolution of different malicious campaigns. Given this knowledge, organizations must be\nmore vigilant in monitoring threats, as changes in one may mean that changes in others\ncould follow.\n\nO i ti d l d f i t th i l i i t th f\n\n\n-----\n\nengineering campaign. Paying close attention to the domain name of a website before\nperforming any further action can also help mitigate threats, including threats like Urpage\nthat have targeted victims.\n\nAs an additional defense against the growing use of malicious mobile applications,\nenterprises and end users can benefit from multilayered mobile security solutions such\n[as Trend Micro™](https://www.trendmicro.com/en_us/forHome/products/mobile-security.html) [Mobile Security for Android™ which is also available on Google](https://www.trendmicro.com/en_us/forHome/products/mobile-security.html)\n[Play. Trend Micro’s Mobile App Reputation Service (MARS) covers Android and iOS threats](https://mars.trendmicro.com/)\nusing leading sandbox and machine learning technologies. It can protect users against\nmalware, zero-day and known exploits, privacy leaks, and application vulnerability.\n\n[For organizations, Trend Micro™ Mobile Security for Enterprise provides device, compliance](https://www.trendmicro.com/en_us/forHome/products/mobile-security.html)\nand application management, data protection, and configuration provisioning. It also\nprotects devices from attacks that leverage vulnerabilities, preventing unauthorized access\nto apps, as well as detecting and blocking malware and fraudulent websites.\n\n[The Trend Micro™ Deep Discovery](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/understanding-targeted-attacks-what-is-a-targeted-attack) ™ threat protection platform enables organizations to\ndetect, analyze, and respond to modern threats such as sophisticated malware, targeted\nattacks, and APTs.\n\n[Trend Micro™ Smart Protection for Endpoints with Maximum XGen™ security infuses high-](https://www.trendmicro.com/en_us/business/products/user-protection/sps.html?cm_mmc=VURL:www.trendmicro.com-_-VURL-_-/us/enterprise/network-security/interscan-web-security/index.html-_-1:1)\n[fidelity machine learning into a blend of threat protection techniques to eliminate security](https://www.trendmicro.com/vinfo/us/security/definition/machine-learning)\ngaps across user activity and any endpoint, offering the broadest possible protection\nagainst advanced attacks.\n\n[This appendix contains the latest Indicators of Compromise (IOCs) related to the different](https://documents.trendmicro.com/assets/Appendix-TheUrpageConnectiontoBahamutConfuciusandPatchwork.pdf)\ngroups.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.08.29.Bahamut_Confucius_Patchwork/The%20Urpage%20Connection%20to%20Bahamut%20Confucius%20and%20Patchwork.pdf"
    ],
    "report_names": [
        "The Urpage Connection to Bahamut Confucius and Patchwork"
    ],
    "threat_actors": [
        {
            "id": "caf95a6f-2705-4293-9ee1-6b7ed9d9eb4c",
            "created_at": "2022-10-25T15:50:23.472432Z",
            "updated_at": "2025-03-27T02:00:55.479021Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [
                "Confucius",
                "Confucius APT"
            ],
            "source_name": "MITRE:Confucius",
            "tools": [
                "WarzoneRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "732bfd4b-8c15-42a5-ac4b-14a9a4b902e9",
            "created_at": "2022-10-25T16:07:23.38079Z",
            "updated_at": "2025-03-27T02:02:09.771357Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "ETDA:Bahamut",
            "tools": [
                "Bahamut",
                "DownPaper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "37714790-40c0-4b6b-8e49-1c8f45a0463f",
            "created_at": "2022-10-25T16:07:24.37091Z",
            "updated_at": "2025-03-27T02:02:10.196909Z",
            "deleted_at": null,
            "main_name": "Urpage",
            "aliases": [],
            "source_name": "ETDA:Urpage",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f99641e0-2688-47b0-97bc-7410659d49a0",
            "created_at": "2023-01-06T13:46:38.802141Z",
            "updated_at": "2025-03-27T02:00:02.922907Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "MISPGALAXY:Bahamut",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ada9e5d3-1cb2-4b70-a3c8-96808c304ac8",
            "created_at": "2022-10-25T15:50:23.6515Z",
            "updated_at": "2025-03-27T02:00:55.513513Z",
            "deleted_at": null,
            "main_name": "Windshift",
            "aliases": [
                "Windshift",
                "Bahamut"
            ],
            "source_name": "MITRE:Windshift",
            "tools": [
                "WindTail"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7a8dbc5e-51a8-437a-8540-7dcb1cc110b8",
            "created_at": "2022-10-25T16:07:23.482856Z",
            "updated_at": "2025-03-27T02:02:09.827887Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [],
            "source_name": "ETDA:Confucius",
            "tools": [
                "ApacheStealer",
                "ByeByeShell",
                "ChatSpy",
                "Confucius",
                "MY24",
                "Sneepy",
                "remote-access-c3",
                "sctrls",
                "sip_telephone",
                "swissknife2"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8fddd571-37dc-4bb2-84b4-e41ac6fd11f5",
            "created_at": "2024-02-08T02:00:04.32487Z",
            "updated_at": "2025-03-27T02:00:03.329395Z",
            "deleted_at": null,
            "main_name": "Urpage",
            "aliases": [],
            "source_name": "MISPGALAXY:Urpage",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1544066737,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/1614224bb566bb4c8e82501440d26fb707108757.pdf",
        "text": "https://archive.orkl.eu/1614224bb566bb4c8e82501440d26fb707108757.txt",
        "img": "https://archive.orkl.eu/1614224bb566bb4c8e82501440d26fb707108757.jpg"
    }
}