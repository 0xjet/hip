{
    "id": "5e0912a9-24e9-425e-9a05-f143de4597d4",
    "created_at": "2023-03-03T02:07:02.687061Z",
    "updated_at": "2025-03-27T02:05:40.30944Z",
    "deleted_at": null,
    "sha1_hash": "06669137810edb9a216aa37f545a1ffa35ed6a12",
    "title": "2023-02-06 - Behind the Attack- Paradies Clipper Malware",
    "authors": "",
    "file_creation_date": "2023-03-01T09:13:28Z",
    "file_modification_date": "2023-03-01T09:13:28Z",
    "file_size": 3488367,
    "plain_text": "# Behind the Attack: Paradies Clipper Malware\n\n**[perception-point.io/blog/behind-the-attack-paradies-clipper-malware/](https://perception-point.io/blog/behind-the-attack-paradies-clipper-malware/)**\n\nFebruary 6, 2023\n\nClipper malware is a type of malware that specifically targets cryptocurrency wallets. It replaces\nwallet addresses with the attacker’s own address, effectively diverting funds to the attacker. The\ndanger of Clipper malware lies in its ability to intercept and manipulate sensitive information,\nsuch as wallet addresses, through various hooking techniques.\n\nIn this blog we review Paradies Clipper malware, which is uncommon in the wild due to its\ndeveloper’s low popularity, but still interesting from a cyber research perspective.\n\n## Threat Intel\n\n[Let’s start from the beginning, at the source of the malware: a sales thread in the nulled.to](https://www.nulled.to/topic/1405777-paradiescc-1-crypto-clipper-on-nulled-unique-fud-control-panel-native-c-bulletproof-server/)\n[forum. There, anyone can access the Clipper panel site, register, and buy a subscription.](http://paradies.cc/auth)\n\n\n-----\n\nFigure 1: The Clipper panel site\n\n## Static Info\n\n[To determine the basics about this malware, we opened a sample in DiE, a malware analysis](https://github.com/horsicq/Detect-It-Easy)\ntool. From there, we could see that the sample was written in C/C++ and that it is a PE32 file.\n\nFigure 2: Malware written in C/C++ as a PE32 file\n\n\n-----\n\nLooking at the strings of the sample, we noticed that the developer hasn t invested time in\nobfuscating the strings. This enabled us to find what could be the C2 (and the compilation path\non the developer’s computer):\n\nFigure 3: Possible C2 and compilation path\n\nWe could also understand a lot by looking at the imports, no dynamic API resolution necessary:\n\nFigure 4: The imports\n\n## Analysis\n\nOpening up the malware binary in IDA, a disassembler tool, we found a long main function. The\nfunction first checks for a mutex handle with the value: 7CmLQX. If it exists, the program will\nunderstand that it is already executed and will terminate itself.\n\nFigure 5: Mutex handle function\n\n## Persistence\n\nThe program then retrieves the path to the user’s AppDataLocal folder and combines it with\nthe persistence executable name: Update.exe.\n\n\n-----\n\nFrom there, the program compares the persistence path to the current path of the executable (it\nretrieves the path using GetModuleFileNameA). If the executable is not running from the\npersistence path (C:UsersuserAppDataLocalUpdate.exe), it will skip the main functionality\ncode and create persistence:\n\nFigure\n\n6: Creating persistence\n\nFigure 6: Creating persistence\n\nThe program creates a registry key with the name Update under the path\n**HKCUSOFTWAREMicrosoftWindowsCurrentVersionRun with the value pointing to the**\npersistence path.\n\nFigures\n\n7 & 8: Creating a registry path\n\nFigures 7 & 8: Creating a registry path\n\n\n-----\n\nNext, the binary concatenates a CMD command and executes it. The command copies the\nexecutable to the desired persistence path, deletes the executable, and executes it again from\nthe persistent path.\n\nFigure 9: Linking and executing the executable\n\nThe final concatenated command is as follows:\n\nThis command uses the attrib command with several flags:\n\n**+r – sets the file as read-only.**\n**+h – sets the file as hidden.**\n**+a – flags the file as available for archiving when using the BACKUP or XCOPY**\ncommands.\n\nThe command uses the icacls command with several flags:\n\n\n-----\n\n**/deny everyone – denies specified user access rights.**\n**WD – write data/add file.**\n– append data/add subdirectory.\n**WEA – write extended attributes.**\n**WA – write attributes.**\n\nFigures 10 & 11: Command features\n\nOnce the persistence is made and the binary restarts we can dive into the Clipper functionality.\n\n## Main Functionality\n\nThe program starts off by creating the Mutex that the program initially tried to retrieve. The\nprogram then sleeps for a minute.\n\nFigure 12: The program creates the Mutex and then sleeps\n\nBefore the Clipper begins the clipping function it creates the first connection to the Paradies\nserver.\n\nThe first POST request that the Clipper makes contains the following fields:\n\n**username – the computer username (by using the GetUserNameA).**\n**ip – the computer IP.**\n**country – the country associated with the computer IP.**\n**city – the city associated with the computer IP.**\n**date – the initial infection date (followed up with the format DD-MM-YYYY).**\n**time – the initial infection time.**\n**last date & last time – the last active ping received from the infected computer.**\n**mwv – Clipper version.**\n**assigned – the associated ID of the builder in the web panel.**\n**worker – affiliate ID.**\n\n\n-----\n\n-----\n\n-----\n\nFigures 13 & 14: The first POST request\n\nIn order to find the IP and the associated country/city, the program sends out three GET\nrequests:\n\n1. https://myexternalip.com/raw with the user agent: hitman\n2. https://ipapi.co/{IP}/country with the user agent: hitman69\n3. https://ipapi.co/{IP}/city with the user agent: hitman1337\n\nThe first request to myexternalip.com retrieves the IP of the computer. The second and third\nrequests to ipapi.co retrieve the country/city of the given IP.\n\nFigure 15: Requests to ipapi.co\n\nThe program then constantly sends out pings to the web panel, letting the attacker know that\nthe program is still alive. The POST request simply contains the following fields:\n\n**lastdate**\n\n\n-----\n\n**lasttime**\n**IP**\n\nFigure 16: The second POST request\n\nThe program then uses the next API calls to operate the clipboarding functionality:\n\n**OpenClipboard**\n**GetClipboardData**\n**CloseClipboard**\n**EmptyClipboard**\n**SetClipboardData**\n\nOnce the program retrieves the data from the clipboard (using GetClipboardData) it tries to\ncompare the data to crypto wallet regex patterns and, if the regex matches, the program\nreplaces the wallet in the clipboard with the attacker’s wallet (using SetClipboardData).\n\n\n-----\n\nFigure 17: Replacing the clipboard wallet\n\nAfter the clipboard is switched, the program sends a POST request to the Paradies server,\ninforming the attacker that the clipboard was changed. This includes the replaced wallet and to\nwhich wallet it was replaced. This request includes the below fields:\n\n**ip**\n**previous**\n**replaced**\n**mwv**\n**date**\n**time**\n**Assigned**\n\nFigure 18: Request to Paradies server\n\n## Summary\n\n\n-----\n\nParadies Clipper is a simple C++ malware with a dedicated mission. It aims to stay alive on the\nvictim’s computer and monitor the clipboard data, in order to carry out the simple task of making\nmoney at the expense of the victim.\n\n[For more information about how to prevent malware, check out this blog.](https://perception-point.io/blog/how-to-prevent-malware-attacks/)\n\n## IOCs\n\n**Sha256:**\n\nParadies Clipper –\n4df448d36e3409ecd712702ef66dba779d81961ae364243ccc0e2e5a6cb39334\n\n**Crypto wallets:**\n\n**Bitcoin – bc1qxudtrupckfmc204z70x8p9xu7409nsrgvekm0h**\n**Bitcoin – 1C7HpJnRNaUNY8F7inQXyxmJ9aQsczZAML**\n**Litecoin – ltc1q259z50fwemrpjvjmkn5rl2m4h8jckm32rlhvem**\n**Etherium – 0x301e8c4Dffaeb682b67bdfB5d340F36EFE2Cf877**\n**Dogecoin – DE4hgzmrtaXVhTWRuzLpnyhbgRGikjBVvg**\n**Ripple – rfvgDUeRUaDfGwPxnSj9aed4nroJgQcyDQ**\n**Dash – Xh1ff4HdtbUtC2DW8vk3Dhwa5VSJ2pxSMG**\n**Neo – LQ4Gwqr38zBR5JdyoxcUDu38r63T5mUi4Y**\n**Monero –**\n41oqjME2WP2C88P3BW4oEgUGjMaXQwGqgirYJWCDYwAQahMXWKYNLF4XVodVkNQnF\n\n### Yara rule\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-02-06 - Behind the Attack- Paradies Clipper Malware.pdf"
    ],
    "report_names": [
        "2023-02-06 - Behind the Attack- Paradies Clipper Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1677809222,
    "ts_updated_at": 1743041140,
    "ts_creation_date": 1677662008,
    "ts_modification_date": 1677662008,
    "files": {
        "pdf": "https://archive.orkl.eu/06669137810edb9a216aa37f545a1ffa35ed6a12.pdf",
        "text": "https://archive.orkl.eu/06669137810edb9a216aa37f545a1ffa35ed6a12.txt",
        "img": "https://archive.orkl.eu/06669137810edb9a216aa37f545a1ffa35ed6a12.jpg"
    }
}