{
    "id": "c1239b3b-0462-4f9b-8829-4495acacdfad",
    "created_at": "2023-01-12T15:02:20.60458Z",
    "updated_at": "2025-03-27T02:10:17.910345Z",
    "deleted_at": null,
    "sha1_hash": "887bc68d42e704d32bedfac0f0eaa6579e843a2b",
    "title": "2016-08-15 - Shakti Trojan- Document Thief",
    "authors": "",
    "file_creation_date": "2022-05-28T04:55:52Z",
    "file_modification_date": "2022-05-28T04:55:52Z",
    "file_size": 448977,
    "plain_text": "# Shakti Trojan: Document Thief\n\n**[blog.malwarebytes.com/threat-analysis/2016/08/shakti-trojan-stealing-documents/](https://blog.malwarebytes.com/threat-analysis/2016/08/shakti-trojan-stealing-documents/)**\n\nMalwarebytes Labs August 15, 2016\n\nWhile some ransomware (i.e. Chimera) give bogus threats about stealing and releasing\nprivate files, there are other malware families that in fact have made this possibility a reality.\n\n[Recently, Bleeping Computer published a short article about an unrecognized Trojan that](http://www.bleepingcomputer.com/news/security/new-information-stealing-trojan-steals-and-uploads-corporate-files/)\ngrabs documents from the attacked computer and uploads them into a malicious server.\nLooking at the characteristics of the tool, we suspect that it has been prepared for the\npurpose of corporate espionage. So far, no AV has given any meaningful identification to this\nmalware—it is detected under generic names. Since not much is known about its internals,\nwe decided to take a closer look.\n\nIn the unpacked core we found strings suggesting that the authors named the project\n_[Shakti, which means “power” in Hindi or may also be a reference to the Shakti goddess.](https://en.wikipedia.org/wiki/Shakti)_\nThat’s why we refer to this malware as Shakti Trojan.\n\nThis post is a part 1 of the research – giving a short glimpse at the malware’s abilities as well\nas describing it’s background and possible attribution. See also the part 2: Shakti Trojan:\nTechnical Analysis.\n\n## Analyzed samples\n\n\n-----\n\nRecent sample mentioned by Bleeping Computer (submitted to VirusTotal 1st August 2016):\n\n[b1380af637b4011e674644e0a1a53a64: main executable](https://www.virustotal.com/en/file/d6d64c61dada8b5ccfa970356057a6c2c7697f084922744c5a2e29aff079647b/analysis/1470314447/)\n\n[bc05977b3f543ac1388c821274cbd22e: Carrier.dll](https://www.virustotal.com/en/file/490974f9bbca168dbb3e2ca6552a2701e18cb09f29232b12ce4dfe0aa7ff342c/analysis/1471098701/)\n[7d0ebb99055e931e03f7981843fdb540: Payload.dll](https://www.virustotal.com/en/file/343630542a5c402c6b02482bcbcdc258385606e74f11ecb7ab9c545031383179/analysis/1471098641/)\nC&C: web4solution.net\n\nOther found samples:\n\n[8ea35293cbb0712a520c7b89059d5a2a: submitted to VirusTotal in 2013](https://www.virustotal.com/en/file/978bbaf56ad70b34f06531de0b4fc0ee1c419a0ea039ca5d6b5840f029b884de/analysis/)\n\nC&C: securedesignus.com\n[6992370821f8fbeea4a96f7be8015967: submitted to VirusTotal in 2014](https://www.virustotal.com/en/file/7aafb633f1081528726eb65925e56f712bbaf42f7463f108f8b7b38c281026f4/analysis/)\n\nC&C: securedesignuk.com\n[d9181d69c40fc95d7d27448f5ece1878: submitted to VirusTotal in 2015](https://www.virustotal.com/en/file/81cc4d4f04afd6409e5953a49c59e85a81b865d309dc698facf9c7b890089479/analysis/)\n\nCnC: web4solution.net\n\n## Behavioral analysis\n\nLike most malware, Shakti Trojan comes packed inside the loader executable with an icon\nadded:\n\nAfter being deployed, it runs silently.\n\nWe will not see it on the list of running processes because it uses the disguise of a browser.\nIt deploys a legitimate process and injects itself inside.\n\nBelow we can see the traffic generated by this malware, injected inside firefox.exe:\n\n\n-----\n\nThe Trojan achieves persistence either by installing itself as a service or, if it failed, by adding\na key to autorun:\n\nThe atypical feature is that it doesn’t try to hide the original file by moving it into a new\nlocation. Instead, it prevents users from accessing or removing it. To achieve this, it opens its\nown file for reading.\n\n## Network communication\n\nThe Trojan passes the data to its C&C server as a HTTP POST request (URL pattern:\n**_http://[ CnC address]/external/update). It also uses headers of_** [MSMQ protocol.](https://msdn.microsoft.com/en-us/library/ms711472%28v=vs.85%29.aspx)\n\nIt beacons to the server by sending basic info collected about the victim system. When it gets\na response, it uploads the list of all the installed programs:\n\nAfter passing this initial data, the main mission starts: uploading all the files with the desired\nextensions. Everything is transmitted as open text. First goes the file name, then its full\ncontent:\n\n\n-----\n\n## A look inside\n\nLooking at the code we can find more about the goals which authors wanted to achieve and\ntheir development environment.\n\nThe main executable is a loader responsible for unpacking and deploying the core malicious\nmodules: Carrier.dll and Payload.dll. (More details about them will be described in the next\npost.)\n\nBoth DLLs comes with paths to debug symbols. They reveal folders structure on the\ndevelopment machine:\n```\nE:\\Projects\\ComplexStatement\\Shakti\\Code\\Carrier\\Release\\Carrier.pdb\nE:\\Projects\\ComplexStatement\\Shakti\\Code\\Payload\\Release\\Payload.pdb\n\n```\nBoth modules are written in Visual C++ and clearly belong to the same project, named\n_Shakti._\n\n\n-----\n\n_Payload.dll comes with a hardcoded list of the extensions, for which the bot is looking:_\n\nClearly authors were interested in stealing documents. Majority of them are linked to MS\nOffice packet:\n```\ninp, sql, pdf, rtf, txt, xlsx, xls, pptx, ppt, docx, doc\n\n```\nMost of the malware fingerprints a victim system, but rarely are they as precise in\nrecognizing details as this Trojan is. It comes with a long list of Windows versions, including\nspecial editions: Cluster Server Edition, Datacenter Edition, Compute Cluster Edition,\nAdvanced Server, and more:\n\n\n-----\n\nThe lack of Windows 8 and 10 is notable on that hardcoded list. It may suggest that the\npayload is old, written before the release of those systems. Windows 8 was released in\nOctober 2012. Compilation timestamps of the main elements: Carrier.dll and Payload.dll\npoint to February 2012. We can never be sure if the compilation date is not spoofed, but\nsince those two facts match together, it is worth considering that this Trojan may have been\ncreated in 2012.\n\n## Tracing attribution\n\nThe domain used as a C&C, web4solution.net, is registered in India.\n\n_[Source of the record: http://www.enom.com/whois/web4solution-net.html](http://www.enom.com/whois/web4solution-net.html)_\n\n\n-----\n\nInterestingly, the same person was also an owner of the previously found C&Cs:\n\n**_securedesignuk.com from sample:_** [6992370821f8fbeea4a96f7be8015967](https://www.virustotal.com/en/file/7aafb633f1081528726eb65925e56f712bbaf42f7463f108f8b7b38c281026f4/analysis/)\n\n_[Source of the record: http://domainbigdata.com/name/ashraf%20ahmed](http://domainbigdata.com/name/ashraf%20ahmed)_\n```\nDomain Name      Create Date  Registrar\nsecuredesignuk.com   2011-12-20   netearthone.com\n\n```\n**_securedesignus.com from sample:_** [8ea35293cbb0712a520c7b89059d5a2a](https://www.virustotal.com/en/file/978bbaf56ad70b34f06531de0b4fc0ee1c419a0ea039ca5d6b5840f029b884de/analysis/)\n\n_[Source of the record: https://who.is/whois/securedesignus.com](https://who.is/whois/securedesignus.com)_\n\n\n-----\n\nIndian attribution is possible, matching the Indian name of the Trojan.\n\nAdditionally, two of the C&C domains: web4solution.net and securedesignuk.com have been\nfound using the same certificate – that confirms being owned by the same actor over years:\n\n## Conclusion\n\nShakti Trojan is very small and it seems to be written solely for the purpose of document\nstealing. So far we don’t have any information suggesting that this attack is widespread. The\napplication is not new, yet it escaped from the radar and hasn’t been described so far. Its\nsignature doesn’t match any known commodity malware. The only found trace points to the\nmalware were observed in 2014 by DrWeb and given a generic name,\nTrojan.DownLoader11.5634. However, the name doesn’t describe the real functionality:\nuploading rather than downloading.\n\nIt is possible that this tool was designed exclusively for small operations of corporate\nespionage.\n\n\n-----\n\n**_This trojan is detected by Malwarebytes Anti-Malware as Trojan.Shakti ._**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-08-15 - Shakti Trojan- Document Thief.pdf"
    ],
    "report_names": [
        "2016-08-15 - Shakti Trojan- Document Thief.pdf"
    ],
    "threat_actors": [
        {
            "id": "873a6c6f-a4d1-49b3-8142-4a147d4288ef",
            "created_at": "2022-10-25T16:07:23.455744Z",
            "updated_at": "2025-03-27T02:02:09.811933Z",
            "deleted_at": null,
            "main_name": "Chimera",
            "aliases": [
                "Operation Skeleton Key"
            ],
            "source_name": "ETDA:Chimera",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "SkeletonKeyInjector",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f88b16bc-df4b-48e7-ae35-f4117240ff24",
            "created_at": "2022-10-25T15:50:23.556699Z",
            "updated_at": "2025-03-27T02:00:55.499173Z",
            "deleted_at": null,
            "main_name": "Chimera",
            "aliases": [
                "Chimera"
            ],
            "source_name": "MITRE:Chimera",
            "tools": [
                "PsExec",
                "esentutl",
                "Mimikatz",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535740,
    "ts_updated_at": 1743041417,
    "ts_creation_date": 1653713752,
    "ts_modification_date": 1653713752,
    "files": {
        "pdf": "https://archive.orkl.eu/887bc68d42e704d32bedfac0f0eaa6579e843a2b.pdf",
        "text": "https://archive.orkl.eu/887bc68d42e704d32bedfac0f0eaa6579e843a2b.txt",
        "img": "https://archive.orkl.eu/887bc68d42e704d32bedfac0f0eaa6579e843a2b.jpg"
    }
}