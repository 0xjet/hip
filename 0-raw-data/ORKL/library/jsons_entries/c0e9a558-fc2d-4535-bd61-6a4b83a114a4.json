{
    "id": "c0e9a558-fc2d-4535-bd61-6a4b83a114a4",
    "created_at": "2023-01-12T15:00:06.30626Z",
    "updated_at": "2025-03-27T02:13:33.737285Z",
    "deleted_at": null,
    "sha1_hash": "c81fb30d64d64d5f4295f775cd85bd3841f305b2",
    "title": "2022-08-18 - Hardware-based threat defense against increasingly complex cryptojackers",
    "authors": "",
    "file_creation_date": "2022-09-01T10:10:38Z",
    "file_modification_date": "2022-09-01T10:10:38Z",
    "file_size": 1412037,
    "plain_text": "# Hardware-based threat defense against increasingly complex cryptojackers\n\n**[microsoft.com/security/blog/2022/08/18/hardware-based-threat-defense-against-increasingly-complex-cryptojackers](https://www.microsoft.com/security/blog/2022/08/18/hardware-based-threat-defense-against-increasingly-complex-cryptojackers)**\n\nAugust 18, 2022\n\nEven with the dip in the value of cryptocurrencies in the past few months, cryptojackers –\ntrojanized coin miners that attackers distribute to use compromised devices’ computing\npower for their objectives – continue to be widespread. In the past several months, Microsoft\nDefender Antivirus detected cryptojackers on hundreds of thousands of devices every\nmonth. These threats also continue to evolve: recent cryptojackers have become stealthier,\nleveraging living-off-the-land binaries (LOLBins) to evade detection.\n\n\n-----\n\n_Figure 1. Chart showing number of devices on which Microsoft Defender Antivirus detected_\n_cryptojackers from January to July 2022._\nTo provide advanced protection against these increasingly complex and evasive threats,\nMicrosoft Defender Antivirus uses various sensors and detection technologies, including its\n[integration with Intel® Threat Detection Technology (TDT), which applies machine learning to](https://www.microsoft.com/security/blog/2021/04/26/defending-against-cryptojacking-with-microsoft-defender-for-endpoint-and-intel-tdt/)\nlow-level CPU telemetry to detect threats even when the malware is obfuscated and can\nevade security tools.\n\nUsing this silicon-based threat detection, Defender analyzes signals from the CPU\nperformance monitoring unit (PMU) to detect malware code execution “fingerprint” at run\ntime and gain unique insights into malware at their final execution point, the CPU. The\ncombined actions of monitoring at the hardware level, analyzing patterns of CPU usage, and\nusing threat intelligence and machine learning at the software level enable the technology to\ndefend against cryptojacking effectively.\n\nIn this blog post, we share details from our monitoring and observation of cryptojackers and\nhow the integration of Intel TDT and Microsoft Defender Antivirus detects and blocks this\ncomplex threat.\n\n## Looking at the current cryptojacker landscape\n\nThere are many ways to force a device to mine cryptocurrency without a user’s knowledge or\nconsent. The three most common approaches used by cryptojackers are the following:\n\n\n-----\n\n**Executable: These are typically potentially unwanted applications (PUAs) or malicious**\nexecutable files placed on the devices and designed to use system resources to mine\ncryptocurrencies.\n**Browser-based: These miners are typically in the form of JavaScript (or similar**\ntechnology) and perform their function in a web browser, consuming resources for as\nlong as the browser remains open on the website where they are hosted. These miners\nare commonly injected into legitimate websites without the owner’s knowledge or\nconsent. In other cases, the miners are intentionally included in attacker-owned or less\nreputable websites that users might visit.\n**Fileless: These cryptojackers perform mining in a device’s memory and achieve**\npersistence by misusing legitimate tools and LOLBins.\n\nThe executable and browser-based approaches involve malicious code that’s present in\neither the filesystem or website that can be relatively easily detected and blocked. The\nfileless approach, on the other hand, misuses local system binaries or preinstalled tools to\nmine using the device’s memory. This approach allows attackers to achieve their goals\nwithout relying on specific code or files. Moreover, the fileless approach enables\ncryptojackers to be delivered silently and evade detection. These make the fileless approach\nmore attractive to attackers.\n\nWhile newer cryptojackers use the fileless approach, its engagement of the hardware, which\nit relies on for its mining algorithm, becomes one of the ways to detect cryptojacking\nactivities.\n\n## Misuse of LOLBins in recent cryptojacking campaigns\n\nThrough its various sensors and advanced detection methodologies, including its integration\nwith Intel TDT, Microsoft Defender Antivirus sees cryptojackers that take advantage of\nlegitimate system binaries on more than 200,000 devices daily.\n\n\n-----\n\n_Figure 2. Chart showing the number of devices targeted by cryptojackers that misuse_\n_legitimate system binaries observed July 25-31, 2022._\nAttackers heavily favor the misuse of notepad.exe among several legitimate system tools in\nobserved campaigns.\n\n_Figure 3. The chart shows that notepad.exe is the most abused tool based on the_\n_cryptojacking attacks observed from July 25-31 2022_\n\n\n-----\n\nWe analyzed an interesting cryptojacking campaign abusing notepad.exe and several other\nbinaries to carry out its routines. This campaign used an updated version of the cryptojacker\nknown as [Mehcrypt. This new version packs all of its routines into one script and connects to](https://decoded.avast.io/janrubin/complex-obfuscation-meh/)\na command-and-control (C2) server in the latter part of its attack chain, a significant update\nfrom the old version, which ran a script to access its C2 and download additional\ncomponents that then perform malicious actions.\n\nThe threat arrives as an archive file containing autoit.exe and a heavily obfuscated, randomly\nnamed .au3 script. Opening the archive file launches autoit.exe, whichdecodes the .au3\nscript in memory. Once running, the script further decodes several layers of obfuscation and\nloads additional decoded scripts in memory.\n\n_Figure 4. Infection chain of a new variant of Mehcrypt leveraging several binaries to launch_\n_its malicious routines._\n\n\n-----\n\nThe script then copies itself and autoit.exe in a randomly named folder in C:\\ProgramData.\nThe script creates a scheduled task to delete the original files and adds autostart registry\nentries to run the script every time the device starts.\n\n_Figure 5. The malware creates an autostart registry entry to maintain persistence._\nAfter adding persistence mechanisms, the script then loads malicious code into VBC.exe via\n[process hollowing and connects to a C2 server to listen for commands. Based on the C2](https://www.microsoft.com/security/blog/2017/07/12/detecting-stealthier-cross-process-injection-techniques-with-windows-defender-atp-process-hollowing-and-atom-bombing/)\nresponse, the script loads its cryptojacking code into notepad.exe, likewise via process\nhollowing.\n\nAt this point, as the threat starts its cryptojacking operation via malicious code injected into\n_notepad.exe, a huge jump in CPU usage can be observed:_\n\n_Figure 6. CPU usage shows a_\n\n_significant spike and continued maximum utilization as malicious activities are carried out._\nThis high CPU usage anomaly is analyzed in real-time by both Intel TDT and Microsoft\nDefender Antivirus. Based on Intel TDT’s machine learning-based correlation of CPU\ntelemetry and other suspicious activities like process injection into system binaries, Microsoft\n[Defender Antivirus blocks the process execution (Behavior:Win32/CoinMiner.CN!tdt), and](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Behavior:Win32/CoinMiner.CN!tdt&ThreatID=2147815089)\nMicrosoft Defender for Endpoint raises an alert.\n\n## Advanced threat detection technology helps stop cryptojacking activities\n\n\n-----\n\n[To detect evasive cryptojackers, Microsoft Defender Antivirus and](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/microsoft-defender-antivirus-windows) [Intel TDT](https://www.intel.com/content/www/us/en/architecture-and-technology/threat-detection-technology-brief.html) [work together to](https://www.microsoft.com/security/blog/2021/04/26/defending-against-cryptojacking-with-microsoft-defender-for-endpoint-and-intel-tdt/)\nmonitor and correlate hardware and software threat data. Intel TDT leverages signals from\nthe CPU, analyzing these signals to detect patterns modeled after cryptojacking activity\nusing machine learning. Microsoft Defender Antivirus then uses these signals and applies its\nthreat intelligence and machine learning techniques to identify and block the action at the\nsoftware level.\n\nIntel TDT has added several performance improvements and optimizations, such as\noffloading the machine learning inference to Intel’s integrated graphics processing unit (GPU)\nto enable continuous monitoring. This capability is available on Intel Core™ processors and\nIntel vPro® branded platforms from the 6 generation onwards. By design, Microsoftth\nDefender Antivirus leverages these offloading capabilities where applicable.\n\nIn addition to industry partnerships, Microsoft’s consistent monitoring of the threat landscape\npowers the threat intelligence that feeds into products like Microsoft Defender Antivirus and\nMicrosoft Defender for Endpoint, where knowledge is translated to customer protection in\nreal-time.\n\n**_Suriyaraj Natarajan, Andrea Lelli, Amitrajit Banerjee_**\n\n_Microsoft 365 Defender Research Team_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-18 - Hardware-based threat defense against increasingly complex cryptojackers.pdf"
    ],
    "report_names": [
        "2022-08-18 - Hardware-based threat defense against increasingly complex cryptojackers.pdf"
    ],
    "threat_actors": [
        {
            "id": "cfdd35af-bd12-4c03-8737-08fca638346d",
            "created_at": "2022-10-25T16:07:24.165595Z",
            "updated_at": "2025-03-27T02:02:10.128957Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "Cosmic Wolf",
                "Marbled Dust",
                "Silicon",
                "Teal Kurma",
                "UNC1326"
            ],
            "source_name": "ETDA:Sea Turtle",
            "tools": [
                "Drupalgeddon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "33ae2a40-02cd-4dba-8461-d0a50e75578b",
            "created_at": "2023-01-06T13:46:38.947314Z",
            "updated_at": "2025-03-27T02:00:02.959421Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "SILICON",
                "Teal Kurma",
                "UNC1326",
                "COSMIC WOLF",
                "Marbled Dust"
            ],
            "source_name": "MISPGALAXY:Sea Turtle",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535606,
    "ts_updated_at": 1743041613,
    "ts_creation_date": 1662027038,
    "ts_modification_date": 1662027038,
    "files": {
        "pdf": "https://archive.orkl.eu/c81fb30d64d64d5f4295f775cd85bd3841f305b2.pdf",
        "text": "https://archive.orkl.eu/c81fb30d64d64d5f4295f775cd85bd3841f305b2.txt",
        "img": "https://archive.orkl.eu/c81fb30d64d64d5f4295f775cd85bd3841f305b2.jpg"
    }
}