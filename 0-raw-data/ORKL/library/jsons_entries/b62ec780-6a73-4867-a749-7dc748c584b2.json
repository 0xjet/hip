{
    "id": "b62ec780-6a73-4867-a749-7dc748c584b2",
    "created_at": "2023-01-12T15:06:51.834433Z",
    "updated_at": "2025-03-27T02:06:13.310966Z",
    "deleted_at": null,
    "sha1_hash": "f0ae81732482d18cf3a08cf9108acda0e0f56d5c",
    "title": "2018-11-29 - How a SamSam-like attack happens, and what you can do about it",
    "authors": "",
    "file_creation_date": "2022-05-27T21:50:56Z",
    "file_modification_date": "2022-05-27T21:50:56Z",
    "file_size": 9919447,
    "plain_text": "# How a SamSam-like attack happens, and what you can do about it\n\n**[news.sophos.com/en-us/2018/11/29/how-a-samsam-like-attack-happens-and-what-you-can-do-about-it/](https://news.sophos.com/en-us/2018/11/29/how-a-samsam-like-attack-happens-and-what-you-can-do-about-it/)**\n\nAndrew Brandt November 29, 2018\n\n**By Andrew Brandt**\n\nThe threat actors behind the SamSam ransomware, now identified by the FBI in an\n[indictment (and very fancy Most Wanted poster), pioneered a very specific playbook in their](https://www.justice.gov/opa/press-release/file/1114746/download)\nattacks that has inspired a rash of copycats. In July, we published a report that goes into\ngreat detail about the SamSam TTP, so if this is of interest to you, maybe check it out. Here’s\na quick explainer of their TTP (tactics, techniques & procedures) and some easy\ncountermeasures you can enact today.\n\n\n-----\n\nSummary of the attack\n\nprocedures used by SamSam\nThe SamSam attackers started by conducting surveillance of the victims. They wanted to\nknow if the victims had sufficiently deep pockets to pay the ransom, which over time\naveraged out to the mid-$30,000 as Bitcoin exchange rates fluctuated.\n\nSamSam\n\ntarget acquisition\nIn fact, the surveillance may have used a number of freely available tools, but the primary\nmotives seem to be (1) whether the victims were based in the “Anglosphere” (Englishspeaking world, but primarily in the US) and (2) had money, and that’s it. Some ransomware\nattackers appear to have avoided attacking schools or hospitals, but not SamSam.\n\n\n-----\n\nTools\n\nemployed by SamSam during the intrusion phase of the attack\nThe attackers relied on “low-hanging fruit” to break in to networks. Most attacks begin with\nthe attackers brute-forcing passwords for Windows machines that have Remote Desktop\nProtocol (RDP) exposed through a hole in the firewall.\n\nIf you have ports open in your firewall to let RDP through from the internet, and it isn’t\nbehind a VPN, please close those ports now. It doesn’t matter how strong the\nWindows password is. It is not **worth the risk to keep it open.**\n\nSome early attacks began with exploits against vulnerabilities in a application service called\nJBOSS (now known as [Wildfly). The attackers use a publicly available grey-hat hacking tool](http://wildfly.org/)\n[called JexBoss. An IoC of this type of attack is the file jbossass.war (MD5:](https://github.com/joaomatosf/jexboss)\n[CBDEAF83F58A64B09DF58B94063E0146). This method quickly fell out of favor in lieu of](https://www.virustotal.com/#/file/905ba75b5b06cbb2ea75da302c94f6b5605327c59ebdb680c6feabdbc9e242d3/detection)\nusing RDP.\n\nSamSam use conventional systems administration and some grey-hat hacking tools\nOnce the SamSam attackers gained a foothold in the network, they used a variety of greyhat and systems administrator tools to escalate their own privileges. The goal: Obtain\nDomain Administrator credentials, usually by sniffing for them using Mimikatz.\n\nThe goal was to take control of the Domain Controller\n\n\n-----\n\nAs soon as they had the Domain Administrator password, the SamSam attackers took\ncontrol of the Domain Controller. They leveraged the DC to distribute the ransomware to\nevery machine on the network, but they didn’t do it right away. They did tests first, before\ndeployment, to make sure the DC has write privileges to the machines under its bailiwick.\n\nSamSam pushed an installation using the free Microsoft Sysinternals tool PsExec\nUsing Microsoft’s free tool PsExec, the attackers pushed ransomware to every machine they\ncould reach from the DC, all at once.\n\nThey waited until late at night, over weekends, or holidays to launch the attack, when the\nfewest people might notice before it was too late.\n\nIn cases where an endpoint security product was preventing the malware from running, they\ntaught themselves how to use the administrator consoles that enterprises use to manage\nsecurity products, and would selectively disable security products using (you guessed it)\nstolen admin credentials.\n\nAt the very least, administrator-level users must use two-factor authentication for\n**all sensitive services and accounts.**\n\nThe PsExec command launched a batch file and required a password, which makes analysis\nharder\nTo make it harder for security experts to analyze the malware, they built samples unique to\neach victim organization, and executed them using a batch file that decrypted the payload\nwith a password they changed for each attack. The malware always deleted its own installer\nany any other traces as a final step. Getting copies of the files associated with the attack has\nbeen a challenge since the earliest days, but it wasn’t impossible.\n\n\n-----\n\nThe SamSam attackers refined the encryption procedure many times over two years\nThe SamSam ransomware pushed the limits for efficiency, too. It encrypted the most\nimportant files first, and then everything else that wasn’t essential to keeping the machine\nrunning.\n\nThe consquences were more serious than with conventional ransomware. For instance, you\ncouldn’t just restore data files from backups to get back up and running, because all your\n**applications are also inaccessible. You need to reimage the disk first, and restore all the**\napplications, before you could restore the data files.\n\nIt was a purely evil act and virtually guaranteed that data was unrecoverable in a reasonable\namount of time at the scale of whole networks, all at once. If it took (just for example) 30\nminutes to reimage a disk on a single machine, and another 15 to bring back the data from\noffline backups, how long would it take to do the same on 100 machines? How about on\n1000 machines?\n\nCould you do this for a massive global organization quickly enough not to incur heavy\n[losses? What if you weren’t just a gaming network and](https://en.wikipedia.org/wiki/2011_PlayStation_Network_outage) lives literally were hanging in the\nbalance?\n\nFaced with a prospect of, perhaps, weeks of downtime and painstaking recovery, and the\nensuing lost productivity, it’s not surprising so many victims opted to pay the SamSam\nattackers. For many, it was a matter of organizational survival, though a costly lesson to\nlearn.\n\n\n-----\n\nSamSam only attacked a handful of organizations at a time, but had a high success rate\nEvery victim was provided with a unique .onion address on the dark web. At the other end,\nthere was a kind of chat system where the victim interacted directly with the SamSam\nattackers.\n\nSamSam’s attackers communicate with victims through a bespoke dark web chat page\n\n\n-----\n\nThese disappeared as soon as the victim paid. Only a few screenshots exist. This one was\nshared with us by a victim who worked with us to investigate the attack retrospectively.\n\nWe tracked Bitcoin payments to a small number of wallets. The cryptocurrency was then\n“tumbled” to obfuscate its origin and destination.\n\nThe attackers laundered their Bitcoin through “tumbler” services\nWe traced many of these back to their origins and found something quite interesting\n\n[While many victims, including the City of Atlanta, openly admitted they had been targeted by](https://www.wired.com/story/atlanta-spent-26m-recover-from-ransomware-scare/)\nSamSam, more than half of the paying victims never made any kind of public announcement\nat all.\n\n\n-----\n\nMore than half the SamSam victims never made a public announcement about the attack\nAll these “silent victims” were large businesses.\n\nIt’s also clear that the SamSam attackers had a single country primarily in their crosshairs,\nonce you correlate the victim organizations’ location.\n\nData from January 2016 to July 2018, including “silent victims”\nNow that we know who the attackers were, the motivation seems kind of obvious.\n\n\n-----\n\nThe news about the FBI identifying and indicting the SamSam threat actors makes us happy,\nbut it doesn’t mean the case is closed. Far from it, in fact.\n\nNobody’s been arrested, and there is still a lot of low-hanging fruit out there.\n\nWorse, several other threat groups have picked up on this modus operandi, and are\nmimicking the SamSam technique to spread ransomware. These white-glove, hand\ndelivered, targeted attacks are still going on.\n\nSo, we all have a lot of work to do. This fight is only entering the next phase. Close those\nRDP ports! Patch your old boxes! Segment the network so everything can’t be reached from\na single point. At the very least, pick your low hanging fruit and make some fruit salad!\n\nWe’ll be covering the rise of targeted ransomware and its aftermath, right here in our\nSophosLabs blog. Join us as we fight this scourge!\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-11-29 - How a SamSam-like attack happens, and what you can do about it.pdf"
    ],
    "report_names": [
        "2018-11-29 - How a SamSam-like attack happens, and what you can do about it.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536011,
    "ts_updated_at": 1743041173,
    "ts_creation_date": 1653688256,
    "ts_modification_date": 1653688256,
    "files": {
        "pdf": "https://archive.orkl.eu/f0ae81732482d18cf3a08cf9108acda0e0f56d5c.pdf",
        "text": "https://archive.orkl.eu/f0ae81732482d18cf3a08cf9108acda0e0f56d5c.txt",
        "img": "https://archive.orkl.eu/f0ae81732482d18cf3a08cf9108acda0e0f56d5c.jpg"
    }
}