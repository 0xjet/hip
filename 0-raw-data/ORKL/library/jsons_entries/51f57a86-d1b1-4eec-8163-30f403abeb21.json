{
    "id": "51f57a86-d1b1-4eec-8163-30f403abeb21",
    "created_at": "2023-01-12T15:07:57.266407Z",
    "updated_at": "2025-03-27T02:08:40.913313Z",
    "deleted_at": null,
    "sha1_hash": "b49249be82af3d729c7af13d2020eb9c8353ed3c",
    "title": "2013-02-04 - What do Win32-Redyms and TDL4 have in common-",
    "authors": "",
    "file_creation_date": "2022-05-28T15:45:36Z",
    "file_modification_date": "2022-05-28T15:45:36Z",
    "file_size": 409901,
    "plain_text": "# What do Win32/Redyms and TDL4 have in common?\n\n**[welivesecurity.com/2013/02/04/what-do-win32redyms-and-tdl4-have-in-common/](https://www.welivesecurity.com/2013/02/04/what-do-win32redyms-and-tdl4-have-in-common/)**\n\nFebruary 4, 2013\n\nAt the beginning of January 2013, we started tracking the interesting Win32/Redyms trojan\nfamily. Redyms is notable for changing search results from popular search engines on\ninfected machines.\n\n4 Feb 2013 - 07:24PM\n\nAt the beginning of January 2013, we started tracking the interesting Win32/Redyms trojan\nfamily. Redyms is notable for changing search results from popular search engines on\ninfected machines.\n\nAt the beginning of January 2013, we started tracking the interesting Win32/Redyms trojan\nfamily. Redyms is notable for changing search results from popular search engines on\ninfected machines. This Trojan family is mostly spreading in the United States and Canada.\n\n\n-----\n\nIt is in these regions that the cybercrime market pays the highest prices for redirection from\npopular search engines results to malicious ads/links. I’ve already published information\nabout PPI (Pay-Per-Install) programs which distribute malware for BlackHat SEO (Cycbot:\nReady to Ride).\n\nDeeper analysis shows that Win32/Redyms has similar code functions and work activity to\nWin32/Agent.TJO (also known as part of the Olmarik/TDL4 family). Win32/Agent.TJO is a\nuser-mode Trojan program, but based on clicker component functionality found in the TDL4\n[family (The Evolution of TDL: Conquering x64). TDL4, Win32/Agent.TJO and](http://go.eset.com/us/resources/white-papers/The_Evolution_of_TDL.pdf)\nWin32/Redyms use similar techniques for network traffic manipulation in the active internet\nbrowser. So as to intercept and alter the data exchanged over the network the bot hooks\nseveral functions from Microsoft Windows Socket Provider (mswsock.dll):\n\nAll three malware families use the same hooking technique and a communication protocol\nencrypted by RC4 stream cipher. The communication routine call graph in Win32/Redyms\nlooks like this:\n\nThe next interesting finding in Win32/Redyms is the DGA (Domain Generation Algorithm)\nused to generate C&C domain names. This DGA is based on simple alphabetical\npermutations and changes according to the init state constant. Reconstructed algorithms in\npython and decompiled assembly code are shown in the following figures:\n\n\n-----\n\n-----\n\n[decompiled assembly code]\n\nThe list of C&C domain names generated looks like this:\n\n\n-----\n\nThe first domain names from the list were registered in the middle of December 2012 or at\nthe beginning of January 2013. This indicates indirectly that Win32/Redyms was being\ndistributed at the end of December.\n\nWin32/Redyms injects malicious code into all active processes on the infected machine. If\nactivity from the most popular browsers was detected, a malicious thread was injected into\nthe browser process and functions from mswsock.dll were hooked.\n\n\n-----\n\nThe injected code intercepts network activity from the browser process and looks up search\nengines from the following list:\n\nIf search engine activity is detected, all search requests are redirected to the C&C and the\nURLs shown in the search results will be changed in accordance with the list received from\nthe C&C. The URL checking engine is based on hooking the WSPSend() routine, which\nuses Adelson-Velsky/Landis (AVL) trees as data structure in order to manage the data. For\noperating with the AVL trees data structure the malware utilizes the structure\n[RTL_GENERIC_TABLE from kernel32.dll. TDL4 uses the same ideas in the user-mode](http://msdn.microsoft.com/en-us/library/windows/hardware/ff553345(v=vs.85).aspx)\ncomponent cmd.dll.\n\n**Aleksandr Matrosov, Security Intelligence Team Lead**\n\nSHA1 hashes for analyzed samples:\n\n\n1\n\n2\n\n\nWin32/Redyms.AB: 07e73ac58bee7bdc26d289bb2697d2588a6b7e64\n\nWin32/Agent.TJO: 3777c3e98e5be549a7c73f6841c759a9f8a098c3\n\n\n4 Feb 2013 - 07:24PM\n\n## Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n\n-----\n\n## Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2013/2013-02-04 - What do Win32-Redyms and TDL4 have in common-.pdf"
    ],
    "report_names": [
        "2013-02-04 - What do Win32-Redyms and TDL4 have in common-.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536077,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653752736,
    "ts_modification_date": 1653752736,
    "files": {
        "pdf": "https://archive.orkl.eu/b49249be82af3d729c7af13d2020eb9c8353ed3c.pdf",
        "text": "https://archive.orkl.eu/b49249be82af3d729c7af13d2020eb9c8353ed3c.txt",
        "img": "https://archive.orkl.eu/b49249be82af3d729c7af13d2020eb9c8353ed3c.jpg"
    }
}