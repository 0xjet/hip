{
    "id": "d3145b1b-183d-4717-996b-0c479f5fa14e",
    "created_at": "2022-10-25T16:48:22.447946Z",
    "updated_at": "2025-03-27T02:11:24.53202Z",
    "deleted_at": null,
    "sha1_hash": "d71ad8ea9e4809433ec87615aafbc7e20e77b9a4",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-03-26T23:53:14Z",
    "file_modification_date": "2020-03-26T23:53:14Z",
    "file_size": 680901,
    "plain_text": "# WildPressure targets industrial-related entities in the Middle East\n\n**[securelist.com/wildpressure-targets-industrial-in-the-middle-east/96360](https://securelist.com/wildpressure-targets-industrial-in-the-middle-east/96360/)**\n\nBy Denis Legezo\n\nIn August 2019, Kaspersky discovered a malicious campaign distributing a fully fledged C++\nTrojan that we call Milum. All the victims we registered were organizations from the Middle East.\nAt least some of them are related to industrial sector. Our Kaspersky Threat Attribution Engine\n(KTAE) doesn’t show any code similarities with known campaigns. Nor have we seen any target\nintersections. In fact, we found just three almost unique samples, all in one country. So we\nconsider the attacks to be targeted and have currently named this operation WildPressure.\n\nThe compilation timestamps for all these files is the same – March 2019. This is consistent with\nthe fact that we registered no infections before May 31, 2019, so the compilation dates don’t\nseem to be spoofed. For their campaign infrastructure, the operators used rented OVH and\nNetzbetrieb virtual private servers (VPS) and a domain registered with the Domains by Proxy\nanonymization service.\n\nThe malware uses the JSON format for configuration data and as a C2 communication protocol\nover HTTP as well. Inside the encrypted communications within the HTTP POST requests, we\nfound several interesting fields. One of them shows the malware version – 1.0.1. A version\nnumber like this indicates an early stage of development. Other fields suggest the existence of, at\nthe very least, plans for non-C++ versions.\n\nThe only encryption implemented is the RC4 algorithm with different 64-byte keys for different\nvictims. Also, the developers were kind enough to leave RTTI data inside the files. Kaspersky\nproducts detect this malware as Backdoor.Win32.Agent. For more information, please contact:\n[intelreports@kaspersky.com](mailto:intelreports@kaspersky.com)\n\n\n-----\n\n## Why we call it Milum and why it’s of interest\n\nAll the aforementioned C++ Trojans are compiled as standalone PE files, originally named\nMilum46_Win32.exe. The word ‘milum’ is used in the C++ class names inside the malware, so we\nnamed the Trojan after it.\n\nAnother distinctive characteristic is that the malware exports lots of zlib compression functions,\nsuch as zlibVersion(), inflate() or deflate(). This compression is needed for C2 communication, but\nin reality there is no need to export them in the case of a standalone application.\n\nThe JSON configuration fields are not limited to just the version and programming language; the\ncampaign operators also use target IDs that are found in the samples. Among them, we found\nHatLandM30 and HatLandid3 – neither of which we are familiar with. The following table provides\nMilum samples that have similar PE header compilation timestamps but different target IDs:\n\n### Milum46_Win32.exe sample MD5 hash Timestamp (GMT) clientid\n\n 0C5B15D89FDA9BAF446B286C6F97F535 2019.03.09 06:17:19 839ttttttt\n\n 17B1A05FC367E52AADA7BDE07714666B 2019.03.09 06:17:19 HatLandid3\n\n A76991F15D6B4F43FBA419ECA1A8E741 2019.03.09 06:17:19 HatLandM30\n\nRather than describing all the configuration fields one by one, we have gathered them together in\nthe following table, with all the main characteristics for this malware family:\n\n\n### Pro‐ gram‐ ming lan‐ guage\n\n Con‐ figura‐ tion data\n\n Net‐ work proto‐ col\n\n Bea‐ con data\n\n Persis‐ tence\n\n\n### C++ with STL functions used mostly to parse JSON data and exception handling.\n\n Base64-encoded JSON data in PE resources. Includes timeouts, C2 URLs and keys for communication, including RC4 64-byte key.\n\n Trojan transmits compressed JSON data in HTTP POST requests with gzip, base64-encoded and RC4 encrypted.\n\n Encrypted JSON contains the malware version “1.0.1”, Epoch timestamp and client id. It also has specific fields such as “vt” and “ext” that correspond to programming language “c++” and file extension “exe”. If our hypothesis is cor‐ rect, this suggests that non-C++ Trojan versions may be planned, if not al‐ ready implemented.\n\n HKCU autorun system registry keys Run and RunOnce.\n\n\n-----\n\n### En‐ cryp‐ tion\n\n Com‐ pres‐ sion\n\n\n### The communication encryption used is RC4 with the 64-byte key stored in the configuration data.\n\n For compression the Trojan uses an embedded gzip code. For some reason gzip functions are exported from PE, although the samples are standalone executables, not DLLs.\n\n\n## Let’s dig a little deeper inside\n\nThe most popular sample in our telemetry was:\n\n### MD5 0c5b15d89fda9baf446b286c6f97f535\n\n Compiled 2019.03.09 06:17:19 (GMT)\n\n Size 520704\n\n Internal name Milum46_Win32.exe\n\nThis application exists as an invisible toolbar window. The main malicious functions are\nimplemented in a separate thread. Milum decodes its configuration data and, besides timeouts, it\ngets the parameters “clientid” and “encrypt_key” to use in RC4 encryption.\n\n**_Example of the decoded and beautified configuration data. The “clientid” field differs in_**\n**_every sample observed_**\n\nThe following table describes the different configuration parameters:\n\n\n-----\n\n### Config parameter Parameter features\n\n shortwait Pause in milliseconds between C2 communication working cycles\n\n clientid Unique ASCII target name\n\n encrypt_key RC4 encryption key for JSON-based C2 communications\n\n relays – url Full URL to send HTTP POST beacon and GET commands\n\n relays – key Unique ASCII key for each C2 to communicate with it\n\nThe operators can run the Trojan using the key (“b” or “B”) as the first argument and the file name\nas the second. In this case, Milum will delete the file sent as a parameter. Then the Trojan will\ncreate the C:\\ProgramData\\Micapp\\Windows\\ directory and parse its configuration data to form\nthe beacon to send to its C2.\n\nTo send the beacon, Milum uses the HTTP POST request with three parameters as enumerated\nin the table below.\n\n\n### Beacon parameter\n\n\n### Parameter values\n\n\n### md Clientid from config, with prefix 01011 and random five-character ASCII suffix\n\n nk Key from config to communicate with C2, differs for each server\n\n val Compressed, encrypted and encoded command JSON data\n\nThe first two parameters are taken from the configuration data. The third one is encrypted and\nafter decryption, decompression, decoding and beautifying, it looks like this:\n\n\n-----\n\n**_Decoded and beautified JSON beacon to C2. In this case, the connection to the first server_**\n**_was unsuccessful_**\n\nThere are several fields worth mentioning here. We referred above to different programming\nlanguages besides C++: “vt” seems to reference a programming language and “ext” a file\nextension. The only reason that we could think of for keeping these is if the attackers have\nseveral Trojans, written in different languages, to work with the same control server.\n\nRegarding the “command” field, the control servers were inaccessible at the time of the analysis,\nso we don’t have commands from them. However, we analyzed the command handlers in Milum’s\ncode as described below:\n\n\n### Code Mean‐ ing\n\n 1 Execu‐ tion\n\n 2 Server to client\n\n 3 Client to server\n\n\n### Features\n\n Silently execute received interpreter command and return result through pipe\n\n Decode received content in “data” JSON field and drop to file men‐ tioned in “path” field\n\n Encode file mentioned in received command “path” field to send it\n\n\n### 4 File info Get file attributes: hidden, read only, archive, system or executable\n\n 5 Cleanup Generate and run batch script to delete itself\n\n\n### 6 Com‐ mand result\n\n 7 System informa‐ tion\n\n 8 Directo‐ ry list\n\n\n### Get command execution status\n\n Validate target with Windows version, architecture (32- or 64-bit), host and user name, installed security products (with WQL request “Select From AntiVirusProduct WHERE displayName <>’Windows Defender'”)\n\n Get info about files in directory: hidden, read only, archive, system or executable\n\n\n### 9 Update Get the new version and remove the old one\n\n## Who was attacked?\n\nAccording to our telemetry, the Milum Trojan was exclusively used to attack targets in the Middle\nEast from at least the end of May 2019.\n\n\n-----\n\n**_Number of detections for one of the samples from September 2019_**\n\nWe were able to sinkhole one of the WildPressure C2 domains (upiserversys1212[.]com) in\nSeptember 2019. The vast majority of visitor IPs were also from the Middle East, and we believe\nthe rest were network scanners, TOR exit nodes or VPN connections.\n\n**_C2 domain sinkholing also shows active infections mostly from the Middle East_**\n\n## And who’s behind it?\n\nTo date we haven’t observed any strong code- or victim-based similarities with any known actor or\nset of activity. Their C++ code is quite common, regarding configuration data and communication\nprotocol malware uses base64-encoded JSON-formatted configuration data stored in the binary’s\n\n\n-----\n\nresource section and parses it with Standard Template Library (STL) functions. However, these\ncommonalities are not conclusive enough for attribution and our hypothesis is that they are\nmerely coincidence. We will continue to monitor this activity\n\n## To sum up\n\nTo date, we don’t have any data regarding Milum’s spreading mechanism. A campaign that is,\napparently, exclusively targeting entities in the Middle East (at least some of them are industrialrelated) is something that automatically attracts the attention of any analyst. Any similarities\nshould be considered weak in terms of attribution, and may simply be techniques copied from\nprevious well-known cases. Indeed, this “learning from more experienced attackers” cycle has\nbeen adopted by some interesting new actors in recent years.\n\nWe should also be cautious regarding the true targeting of this new set of activities, as it is\nprobably too soon to jump to conclusions. The targeted nature seems to be clear, but the\ntargeting itself might be limited by our own visibility. The malware is not exclusively designed\nagainst any kind of victim in particular and might be reused in other operations.\n\n## Indicators of compromise\n\n**Files MD5**\n0C5B15D89FDA9BAF446B286C6F97F535\n17B1A05FC367E52AADA7BDE07714666B\nA76991F15D6B4F43FBA419ECA1A8E741\nOriginal file names are Milum46_Win32.exe; on the target side they exist as system32.exe\n\n**URLs**\nupiserversys1212[.]com/rl.php\n37.59.87[.]172/page/view.php\n80.255.3[.]86/page/view.php\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.03.24_WildPressure/WildPressure%20targets%20industrial-related%20entities%20in%20the%20Middle%20East%20_%20Securelist.pdf"
    ],
    "report_names": [
        "WildPressure targets industrial-related entities in the Middle East _ Securelist"
    ],
    "threat_actors": [
        {
            "id": "3c652e4b-2f17-4e18-bd05-af12c27e76fb",
            "created_at": "2023-11-30T02:00:07.302263Z",
            "updated_at": "2025-03-27T02:00:03.258682Z",
            "deleted_at": null,
            "main_name": "WildPressure",
            "aliases": [],
            "source_name": "MISPGALAXY:WildPressure",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ef437d-e8fa-4250-9a99-89a403035ad2",
            "created_at": "2022-10-25T16:07:24.406019Z",
            "updated_at": "2025-03-27T02:02:10.210953Z",
            "deleted_at": null,
            "main_name": "WildPressure",
            "aliases": [
                "WilePressure"
            ],
            "source_name": "ETDA:WildPressure",
            "tools": [
                "Milum"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041484,
    "ts_creation_date": 1585266794,
    "ts_modification_date": 1585266794,
    "files": {
        "pdf": "https://archive.orkl.eu/d71ad8ea9e4809433ec87615aafbc7e20e77b9a4.pdf",
        "text": "https://archive.orkl.eu/d71ad8ea9e4809433ec87615aafbc7e20e77b9a4.txt",
        "img": "https://archive.orkl.eu/d71ad8ea9e4809433ec87615aafbc7e20e77b9a4.jpg"
    }
}