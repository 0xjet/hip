{
    "id": "c3ce9b2d-4103-4999-b4a2-62d051b9cecd",
    "created_at": "2023-01-12T15:07:56.506052Z",
    "updated_at": "2025-03-27T02:05:49.312781Z",
    "deleted_at": null,
    "sha1_hash": "2d8b7b12bed34c25ce497e7621f2016d4611d771",
    "title": "2021-09-17 - Numando- Count once, code twice",
    "authors": "",
    "file_creation_date": "2022-05-28T18:12:22Z",
    "file_modification_date": "2022-05-28T18:12:22Z",
    "file_size": 1090424,
    "plain_text": "# Numando: Count once, code twice\n\n**welivesecurity.com/2021/09/17/numando-latam-banking-trojan/**\n\nSeptember 17, 2021\n\nThe (probably) penultimate post in our occasional series demystifying Latin American banking trojans.\n\n[ESET Research](https://www.welivesecurity.com/author/esetresearch/)\n17 Sep 2021 - 11:30AM\n\nThe (probably) penultimate post in our occasional series demystifying Latin American banking trojans.\n\nBefore concluding our series, there is one more LATAM banking trojan that deserves a closer look –\nNumando. The threat actor behind this malware family has been active since at least 2018. Even though it is\nnot nearly as lively as Mekotio or Grandoreiro, it has been consistently used since we started tracking it,\nbringing interesting new techniques to the pool of Latin American banking trojans’ tricks, like using seemingly\nuseless ZIP archives or bundling payloads with decoy BMP images. Geographically, it focuses almost\nexclusively on Brazil with rare campaigns in Mexico and Spain.\n\n## Characteristics\n\n\n-----\n\nAs with all the other Latin American banking trojans described in this series, Numando is written in Delphi\nand utilizes fake overlay windows to lure sensitive information out of its victims. Some Numando variants\nstore these images in an encrypted ZIP archive inside their .rsrc sections, while others utilize a separate\nDelphi DLL just for this storage.\n\nBackdoor capabilities allow Numando to simulate mouse and keyboard actions, restart and shutdown the\nmachine, display overlay windows, take screenshots and kill browser processes. Unlike other Latin American\nbanking trojans, however, the commands are defined as numbers rather than strings (see Figure 1), which\ninspired our naming of this malware family.\n\nFigure 1. Numando command processing – part of command 9321795 processing (red)\n\nStrings are encrypted by the most common algorithm among Latin American banking trojans (shown in\n[Figure 5 of our Casbaneiro write-up) and are not organized into a string table. Numando collects the](https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/)\nvictimized machine’s Windows version and bitness.\n\nUnlike most of the other Latin American banking trojans covered in this series, Numando does not show\nsigns of continuous development. There are some minor changes from time to time, but overall the binaries\ndo not tend to change much.\n\n## Distribution and execution\n\nNumando is distributed almost exclusively by spam. Based on our telemetry, its campaigns affect several\nhundred victims at most, making it considerably less successful than the most prevalent LATAM banking\ntrojans such as Mekotio and Grandoreiro. Recent campaigns simply add a ZIP attachment containing an\nMSI installer to each spammed message. This installer contains a CAB archive with a legitimate application,\nan injector, and an encrypted Numando banking trojan DLL. If the potential victim executes the MSI, it\neventually runs the legitimate application as well, and that side-loads the injector. The injector locates the\npayload and then decrypts it using a simple XOR algorithm with a multi-byte key, as in the overview of this\nprocess illustrated in Figure 2.\n\n\n-----\n\nFigure 2. Numando MSI and its contents distributed in the latest campaigns\n\nFor Numando, the payload and injector are usually named identically – the injector with the .dll extension\nand the payload with no extension (see Figure 3) – making it is easy for the injector to locate the encrypted\npayload. Surprisingly, the injector is not written in Delphi – something very rare among Latin American\nbanking trojans. The IoCs at the end of this blogpost contain a list of legitimate applications we have\nobserved Numando abuse.\n\nFigure 3. Files used for executing Numando. Legitimate application (Cooperativa.exe), injector (Oleacc.dll), encrypted\n\npayload (Oleacc) and legitimate DLLs.\n\n### Decoy ZIP and BMP overlay\n\nThere is one interesting distribution chain from the recent past worth mentioning. This chain starts with a\nDelphi downloader downloading a decoy ZIP archive (see Figure 4). The downloader ignores the archive’s\ncontents and extracts a hex-encoded encrypted string from the ZIP file comment, an optional ZIP file\ncomponent stored at the end of the file. The downloader does not parse the ZIP structure, but rather looks\nfor the last { character (used as a marker) in the whole file. Decrypting the string results in a different URL\nthat leads to the actual payload archive.\n\n\n-----\n\nFigure 4. The decoy is a valid ZIP file (ZIP structures highlighted in green) with an encrypted URL included in a ZIP file\n\ncomment at the end of the archive (red)\n\nThe second ZIP archive contains a legitimate application, an injector and a suspiciously large BMP image.\nThe downloader extracts the contents of this archive and executes the legitimate application, which sideloads the injector that, in turn, extracts the Numando banking trojan from the BMP overlay and executes it.\nThe process is illustrated in Figure 5.\n\nFigure 5. Numando distribution chain using a decoy ZIP archive\n\nThis BMP file is a valid image and can be opened in a majority of image viewers and editors without issue,\nas the overlaly is simply ignored. Figure 6 shows some of the decoy images the Numando threat actor uses.\n\n\n-----\n\nFigure 6. Some BMP images Numando uses as decoys to carry its payload\n\n## Remote configuration\n\nLike many other Latin American banking trojans, Numando abuses public services to store its remote\nconfiguration – YouTube and Pastebin in this case. Figure 7 shows an example of the configuration stored\n[on YouTube – a technique similar to Casbaneiro, though much less sneaky. Google took the videos down](https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/)\npromptly based on ESET’s notification.\n\nFigure 7. Numando remote configuration on YouTube\n\nThe format is simple – three entries delimited by “:” between the DATA:{ and } markers. Each entry is\nencrypted separately the same way as other strings in Numando – with the key hardcoded in the binary. This\nmakes it difficult to decrypt the configuration without having the corresponding binary, however Numando\ndoes not change its decryption key very often, making decryption possible.\n\n## Conclusion\n\n\n-----\n\nNumando is a Latin American banking trojan written in Delphi. It targets mainly Brazil with rare campaigns in\nMexico and Spain. It is similar to the other families described in our series – it uses fake overlay windows,\ncontains backdoor functionality and utilizes MSI.\n\nWe have covered its most typical features, distribution methods and remote configuration. It is the only\nLATAM banking trojan written in Delphi that uses a non-Delphi injector and its remote configuration format is\nunique, making two reliable factors when identifying this malware family.\n\n_For any inquiries, contact us at threatintel@eset.com. Indicators of Compromise can also be found in our_\n_GitHub repository._\n\n## Indicators of Compromise (IoCs)\n\n### Hashes\n\n**SHA-1** **Description** **ESET detection name**\n\n\nE69E69FBF438F898729E0D99EF772814F7571728 MSI\ndownloader\nfor “decoy\nZIP”\n\n\nWin32/TrojanDownloader.Delf.CQR\n\n\n4A1C48064167FC4AD5D943A54A34785B3682DA92 MSI installer Win32/Spy.Numando.BA\n\n\nBB2BBCA6CA318AC0ABBA3CD53D097FA13DB85ED0 Numando\nbanking\ntrojan\n\nBFDA3EAAB63E23802EA226C6A8A50359FE379E75 Numando\nbanking\ntrojan\n\n9A7A192B67895F63F1AFDF5ADF7BA2D195A17D80 Numando\nbanking\ntrojan\n\n7789C57DCC3520D714EC7CA03D00FFE92A06001A DLL with\noverlay\nwindow\nimages\n\n### Abused legitimate applications\n\n\nWin32/Spy.Numando.E\n\nWin32/Spy.Numando.AL\n\nWin32/Spy.Numando.AO\n\nWin32/Spy.Numando.P\n\n\n**Example SHA-1** **EXE name** **DLL name**\n\nA852A99E2982DF75842CCFC274EA3F9C54D22859 nvsmartmaxapp.exe nvsmartmax.dll\n\nF804DB94139B2E1D1D6A3CD27A9E78634540F87C VBoxTray.exe mpr.dll\n\n65684B3D962FB3483766F9E4A9C047C0E27F055E Dumpsender.exe Oleacc.dll\n\n### C&C servers\n\n138.91.168[.]205:733\n20.195.196[.]231:733\n\n\n-----\n\n20.197.228[.]40:779\n\n### Delivery URLs\n\nhttps://enjoyds.s3.us-east-2.amazonaws[.]com/H97FJNGD86R.zip\nhttps://lksluthe.s3.us-east-2.amazonaws[.]com/B876DRFKEED.zip\nhttps://procjdcals.s3.us-east-2.amazonaws[.]com/HN97YTYDFH.zip\nhttps://rmber.s3.ap-southeast-2.amazonaws[.]com/B97TDKHJBS.zip\nhttps://sucessmaker.s3.us-east-2.amazonaws[.]com/JKGHFD9807Y.zip\nhttps://trbnjust.s3.us-east-2.amazonaws[.]com/B97T908ENLK.zip\nhttps://webstrage.s3.us-east-2.amazonaws[.]com/G497TG7UDF.zip\n\n## MITRE ATT&CK techniques\n\n[Note: This table was built using version 9 of the MITRE ATT&CK framework.](https://attack.mitre.org/resources/versions/)\n\n**Tactic** **ID** **Name** **Description**\n\n\nResource\nDevelopment\n\n[T1587.001](https://attack.mitre.org/techniques/T1587/001/)\n\n\n[T1583.001](https://attack.mitre.org/techniques/T1583/001/) Acquire\nInfrastructure:\nDomains\n\n\nDevelop\nCapabilities:\nMalware\n\n\nNumando is likely\ndeveloped by its\noperator.\n\n\nInitial Access [T1566](https://attack.mitre.org/techniques/T1566/001/) Phishing:\nSpearphishing\nAttachment\n\nExecution [T1204.002](https://attack.mitre.org/techniques/T1204/002/) User Execution:\nMalicious File\n\n\nDefense\nEvasion [T1140](https://attack.mitre.org/techniques/T1140/)\n\n[T1574.002](https://attack.mitre.org/techniques/T1574/002/) Hijack\nExecution\nFlow: DLL\nSide-Loading\n\n[T1027.002](https://attack.mitre.org/techniques/T1027/002/) Obfuscated\nFiles or\nInformation:\nSoftware\nPacking\n\n[T1218.007](https://attack.mitre.org/techniques/T1218/007/) Signed Binary\nProxy\nExecution:\nMsiexec\n\n\nDeobfuscate/Decode\nFiles or Information\n\nNumando is often\nexecuted by DLL\nside-loading.\n\nSome Numando\nbinaries are packed\nwith VMProtect or\nThemida.\n\nNumando uses the\nMSI format for\nexecution.\n\n\nNumando operators register domains to be used\nas C&C servers.\n\nNumando is distributed as a malicious email\nattachment.\n\nNumando relies on the victim to execute the\ndistributed MSI file.\n\nNumando encrypts its payload or hides it inside a\nBMP image file, and some variants encrypt and\nhex encode their main payload URLs in a\ncomment in decoy ZIP files.\n\nNumando monitors the foreground windows.\n\n\nDiscovery [T1010](https://attack.mitre.org/techniques/T1010/) Application Window\nDiscovery\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1082](https://attack.mitre.org/techniques/T1082/)\n\n\nSystem\nInformation\nDiscovery\n\n\nNumando collects\nthe Windows version\nand bitness.\n\n\nCollection [T1113](https://attack.mitre.org/techniques/T1113/) Screen Capture Numando can take screenshots.\n\n\nCommand\nand Control\n\n\n[T1132.002](https://attack.mitre.org/techniques/T1132/002/) Data Encoding: NonStandard Encoding\n\n\nNumando uses custom encryption.\n\nNumando exfiltrates data via a C&C server.\n\n\nExfiltration [T1041](https://attack.mitre.org/techniques/T1041/) Exfiltration Over C2\nChannel\n\n17 Sep 2021 - 11:30AM\n\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-17 - Numando- Count once, code twice.pdf"
    ],
    "report_names": [
        "2021-09-17 - Numando- Count once, code twice.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536076,
    "ts_updated_at": 1743041149,
    "ts_creation_date": 1653761542,
    "ts_modification_date": 1653761542,
    "files": {
        "pdf": "https://archive.orkl.eu/2d8b7b12bed34c25ce497e7621f2016d4611d771.pdf",
        "text": "https://archive.orkl.eu/2d8b7b12bed34c25ce497e7621f2016d4611d771.txt",
        "img": "https://archive.orkl.eu/2d8b7b12bed34c25ce497e7621f2016d4611d771.jpg"
    }
}