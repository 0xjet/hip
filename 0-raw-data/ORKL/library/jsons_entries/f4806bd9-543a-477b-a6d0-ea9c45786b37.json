{
    "id": "f4806bd9-543a-477b-a6d0-ea9c45786b37",
    "created_at": "2023-01-12T15:08:24.255763Z",
    "updated_at": "2025-03-27T02:16:57.927367Z",
    "deleted_at": null,
    "sha1_hash": "05007674b507cc151a5e9046325ae7322a5d7193",
    "title": "2022-03-24 - Malicious Microsoft Excel add-ins used to deliver RAT malware",
    "authors": "",
    "file_creation_date": "2022-05-28T23:46:42Z",
    "file_modification_date": "2022-05-28T23:46:42Z",
    "file_size": 792833,
    "plain_text": "# Malicious Microsoft Excel add-ins used to deliver RAT malware\n\n**[bleepingcomputer.com/news/security/malicious-microsoft-excel-add-ins-used-to-deliver-rat-malware/](https://www.bleepingcomputer.com/news/security/malicious-microsoft-excel-add-ins-used-to-deliver-rat-malware/)**\n\nBill Toulas\n\nBy\n[Bill Toulas](https://www.bleepingcomputer.com/author/bill-toulas/)\n\nMarch 24, 2022\n03:56 PM\n0\n\nResearchers report a new version of the JSSLoader remote access trojan being distributed\nvia malicious Microsoft Excel addins.\n\nThe particular RAT (remote access trojan) has been circulated in the wild since December\n2020, linked to the financially-motivated Russian hacking group FIN7, also known as\n[“Carbanak.”](https://www.bleepingcomputer.com/news/security/us-charges-three-members-of-fin7-carbanak-hacker-group/)\n\nJSSLoader is a small, lightweight RAT that can perform data exfiltration, establish\npersistence, fetch and load additional payloads, auto-update itself, and more.\n\n## Excel add-ins\n\n\n-----\n\nThe latest campaign involving a stealthier new version of JSSLoader was observed by threat\nanalysts at [Morphisec Labs, who say the delivery mechanism is currently phishing emails](https://blog.morphisec.com/new-jssloader-trojan-delivered-through-xll-files)\nwith XLL or XLM attachments.\n\n[Abuse of Excel XLL add-ins isn’t new, as they are commonly used for legitimate purposes,](https://www.bleepingcomputer.com/news/security/malicious-excel-xll-add-ins-push-redline-password-stealing-malware/)\nsuch as importing data into a worksheet or extending the functionality of Excel.\n\nIn the ongoing campaign, however, the threat actors use an unsigned file, so Excel will show\nthe victim a clear warning about the risks of executing it.\n\n**Security warning about**\n\n**unsigned XLL file**\n_(Morphisec)_\nWhen enabled, the XLL files use malicious code inside an xlAutoOpen function to load itself\ninto memory and then download the payload from a remote server and execute it as a new\nprocess via an API call.\n\n\n-----\n\n**Malware loading and execution flow** _(Morphisec)_\n\n## More sophisticated obfuscation\n\nThe threat actor regularly refreshes the User-Agent on the XLL files to evade EDRs that\nconsolidate detection information from the entire network.\n\n**Changing the User-Agent on each XLL sample** _(Morphisec)_\n\n\n-----\n\n[Compared to older versions, the new JSSLoader has the same execution flow, but it now](https://www.morphisec.com/hubfs/eBooks_and_Whitepapers/FIN7%20JSSLOADER%20FINAL%20WEB.pdf)\ncomes with a new layer of string obfuscation that includes renaming all functions and\nvariables.\n\n**String obfuscation added on the new JSSLoader** _(Morphisec)_\nTo evade detection from string-based YARA rules used by defenders, the new RAT has split\nthe strings into sub-strings and concatenates them at runtime.\n\n**Strings comparison between new and old versions** _(Morphisec)_\n\n\n-----\n\nFinally, the string decoding mechanism is simple so as to leave a minimal footprint and\nreduce the chances of being detected by static threat scanners.\n\nMorphisec reports that these new additions combined with the XLL file delivery are enough\nto prevent detection from next-generation antivirus (NGAV) and endpoint detection and\nresponse (EDR) solutions challenging or even implausible.\n\nThis enables FIN7 to move in the compromised network undeterred for several days or\nweeks before the defenders load matching signatures on tools that complement AI-based\ndetection solutions.\n\nFIN7 is a resourceful threat group that has previously delivered malware-laced USBs\n[alongside teddy bear gifts, attempted to](https://www.bleepingcomputer.com/news/security/fbi-hackers-sending-malicious-usb-drives-and-teddy-bears-via-usps/) [hire network penetration experts by posing as a](https://www.bleepingcomputer.com/news/security/hacking-gang-creates-fake-firm-to-hire-pentesters-for-ransomware-attacks/)\n[legitimate security firm, and sent ransomware-carrying USBs via post mail.](https://www.bleepingcomputer.com/news/security/fbi-hackers-use-badusb-to-target-defense-firms-with-ransomware/)\n\nThe new and stealthier version of JSSLoader is only one part of their arsenal, helping them\nhide in networks for longer without being detected and stopped.\n\n### Related Articles:\n\n[New stealthy Nerbian RAT malware spotted in ongoing attacks](https://www.bleepingcomputer.com/news/security/new-stealthy-nerbian-rat-malware-spotted-in-ongoing-attacks/)\n\n[New NetDooka malware spreads via poisoned search results](https://www.bleepingcomputer.com/news/security/new-netdooka-malware-spreads-via-poisoned-search-results/)\n\n[Hackers target Russian govt with fake Windows updates pushing RATs](https://www.bleepingcomputer.com/news/security/hackers-target-russian-govt-with-fake-windows-updates-pushing-rats/)\n\n[Ukraine supporters in Germany targeted with PowerShell RAT malware](https://www.bleepingcomputer.com/news/security/ukraine-supporters-in-germany-targeted-with-powershell-rat-malware/)\n\n[FIN7 hackers evolve toolset, work with multiple ransomware gangs](https://www.bleepingcomputer.com/news/security/fin7-hackers-evolve-toolset-work-with-multiple-ransomware-gangs/)\n\n[Bill Toulas](https://www.bleepingcomputer.com/author/bill-toulas/)\n\nBill Toulas is a technology writer and infosec news reporter with over a decade of experience\nworking on various online publications. An open source advocate and Linux enthusiast, is\ncurrently finding pleasure in following hacks, malware campaigns, and data breach incidents,\nas well as by exploring the intricate ways through which tech is swiftly transforming our lives.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-24 - Malicious Microsoft Excel add-ins used to deliver RAT malware.pdf"
    ],
    "report_names": [
        "2022-03-24 - Malicious Microsoft Excel add-ins used to deliver RAT malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8386d4af-5cca-40bb-91d7-aca5d1a0ec99",
            "created_at": "2022-10-25T16:07:23.414558Z",
            "updated_at": "2025-03-27T02:02:09.787347Z",
            "deleted_at": null,
            "main_name": "Bookworm",
            "aliases": [],
            "source_name": "ETDA:Bookworm",
            "tools": [
                "Agent.dhwf",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "SPIVY",
                "Scieron",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Xamtrav",
                "ffrat",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536104,
    "ts_updated_at": 1743041817,
    "ts_creation_date": 1653781602,
    "ts_modification_date": 1653781602,
    "files": {
        "pdf": "https://archive.orkl.eu/05007674b507cc151a5e9046325ae7322a5d7193.pdf",
        "text": "https://archive.orkl.eu/05007674b507cc151a5e9046325ae7322a5d7193.txt",
        "img": "https://archive.orkl.eu/05007674b507cc151a5e9046325ae7322a5d7193.jpg"
    }
}