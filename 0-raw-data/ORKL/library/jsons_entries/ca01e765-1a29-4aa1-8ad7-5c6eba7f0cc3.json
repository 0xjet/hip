{
    "id": "ca01e765-1a29-4aa1-8ad7-5c6eba7f0cc3",
    "created_at": "2023-01-12T15:07:12.509558Z",
    "updated_at": "2025-03-27T02:05:44.722873Z",
    "deleted_at": null,
    "sha1_hash": "e03593156f0a54ecdc47ee221433256894eab9b2",
    "title": "2007-12-04 - Inside the -Ron Paul- Spam Botnet",
    "authors": "",
    "file_creation_date": "2022-05-28T19:54:45Z",
    "file_modification_date": "2022-05-28T19:54:45Z",
    "file_size": 210476,
    "plain_text": "# Inside the \"Ron Paul\" Spam Botnet\n\n**secureworks.com/research/srizbi**\n\nJoe Stewart\n\nTuesday, December 4, 2007 By: Joe Stewart\n\n**Date: December 4, 2007**\n**Author: Joe Stewart**\n\nOn the weekend of October 27, 2007, the Internet was suddenly bombarded with a rash of\nspam emails promoting U.S. presidential candidate Ron Paul. The spam run continued until\nTuesday, October 30, when it stopped as suddenly as it began. At the same time, political\nblogs began to light up, accusing the campaign (or at least its ardent supporters) of running a\ncriminal botnet for political purposes. We decided to cut through the spin and take a closer\nlook at this botnet to determine its origins and shine some light on who might be responsible.\n\n## Tracking the Spam\n\nTracking specific spam back to a particular piece of botnet malware is somewhat\nchallenging, but given the right cooperation between researchers who hold different pieces of\nthe puzzle, it can be accomplished. To start, one must identify key characteristics of the\nspam that define a \"fingerprint\" of the email sent by the bot. Although senders, subjects and\nemail bodies will vary from spam to spam, often the email headers contain certain static\nelements which are unique to the mailer engine in the bot software.\n\nIn the case of the Ron Paul spam, we were able to identify these key elements:\n\nThe initial \"Received\" header is always of the format \"from [bot ip] by [nameserver of\nalleged sender domain]\"\nThe Message-ID always begins with three zeros and ends with a random string of\nlowercase letters\nThe dates in the headers are always shown in GMT time, regardless of the local time\nzone of the bot\nThe X-Mailer is always Microsoft Outlook Express 6.00.3790.2663\nThe X-MimeOLE version is always Microsoft MimeOLE V6.00.3790.2757\n\nBy looking for emails containing these hallmarks, we were able to quickly track several\nthousand IP addresses sending Ron Paul spam during the time period above. We were also\nable to see the other types of spam being sent by the botnet - quickly dismissing the idea\n\n\n-----\n\nthat this botnet was created for the purpose of political spam. Emails emanating from the\nbotnet pitched all of the usual spam products, from pharmaceuticals to fake watches.\n\n## Getting the Malware in Hand\n\nAt this point, armed with the IP addresses of current bots, it is possible to trace the command\nand control server of the botnet with cooperation from network administrators who have bots\non their network. By monitoring and correlating network flows, the command center was\nsoon tracked to a server at a co-location facility located in the U.S., one that is well known to\nmalware researchers as a frequent host of this type of activity.\n\nThese clues also led us to the name of the malware behind the botnet - Trojan.Srizbi. Based\non this we were able to locate several variants for testing, the earliest one having been\n[compiled on March 31, 2007. At the end of June, Symantec wrote a fairly detailed blog entry](http://www.symantec.com/enterprise/security_response/weblog/2007/06/spam_from_the_kernel_fullkerne.html)\nabout Srizbi. Information concerning technical details of Srizbi and its removal is available\nfrom various anti-virus firms, and will not be covered here.\n\n## How Srizbi is Spread\n\nAnalysis of recently compromised machines indicated that Srizbi is being spread by the n404\nweb exploit kit, through the malicious site msiesettings.com. This is a well-known \"iframe\naffiliate\" malware install site, where the site owner gets paid by different botnet owners for\nspreading their malware. A trojan is installed by the exploit kit which regularly requests a\nremote configuration file containing URLs of additional malware to download and install.\nPrevious reports have implicated the use of the MPack web exploit kit in spreading Srizbi as\nwell, so it seems this is the Srizbi author's preferred method of building the botnet.\n\nUnfortunately for Srizbi's author, this approach may have some drawbacks - one machine we\nanalyzed was infected with no less than nine other spambots, belonging to the malware\nfamilies Ascesso, Cutwail, Rustock, Spamthru, Wopla and Xorpix. While installing multiple\nspambots may increase profits for the web exploiter, it forces the different spam engines to\nshare resources and bandwidth. Some of these spambots utilize a great deal of CPU time\nand memory, which means not only is the system less efficient for the other spammers' use,\nbut may force the victim to seek technical help to fix their \"slow\" machine, leading to\npremature removal of the bots. It also is likely to land the IP address of the infected machine\nin DNS blocklists much faster, rendering the bot much less effective in bypassing spam\nfiltering.\n\n## The Reactor Core\n\nWith the help of Spamhaus, we were able to not only shut down the command and control\nserver, we were able to obtain the running software from the server, written in the Python\nlanguage. Examining these showed that the Srizbi botnet is actually a working component of\na piece of spamware known as \"Reactor Mailer\" Reactor Mailer has been around at least\n\n\n-----\n\nsince 2004, and is in its third major version. Versions 1 and 2 likely used proxy servers to\nrelay the spam; however, since this is not as efficient as template-based spambots, version 3\nwas created along with Srizbi, the bot that actually does the mailing.\n\nReactor Mailer is the brainchild of a spammer who goes by the pseudonym \"spm\". He calls\nhis company \"Elphisoft\", and has even been interviewed about his operation by the Russian\nhacker website xakep.ru. He claims to hire some of the best coders in the CIS\n(Commonwealth of Independent States, the post-Soviet confederation) to write the software.\nThis claim is probably true by examining details in the source code, we were able to identify\nat least one of the principal coders of Reactor 3/Srizbi, a Ukrainian who goes by the\nnickname \"vlaman\". Various postings by vlaman indicate he is proficient in C and assembler,\nand would certainly be capable of writing the Srizbi trojan.\n\nReactor Mailer operates with a software-as-a-service model. Spammers are given accounts\non a Reactor server, and use a web-based interface to manage their spam tasks. In the case\nof the Ron Paul spam, there was only one account on the server in addition to spm, which\nwas named \"nenastnyj\".\n\nWe loaded the Reactor Mailer software onto a test machine in order to recreate the interface\nas seen by the spammer:\n\nAlthough the spamit.com logo is displayed on the interface, there does not appear to be any\nassociation between the Reactor software and the real spamit.com website, which is a portal\nfor Canadian Pharmacy spam affiliates. However, customers of Reactor Mailer do sometimes\nsend spam for Canadian Pharmacy, as do most of the botnet spam mailers we've looked at.\nIt could be that spm was contracted to develop the Canadian Pharmacy portal, however,\n\n\n-----\n\nthere is also a personality on bulkerforum who goes by the name spamit and claims to be in\nthe pharmaceutical spam business, so we do not believe spamit.com and spm are the same\nentity. The real spamit.com affiliate portal is shown below:\n\n## The Ron Paul Job\n\nUpon logging into the Reactor Mailer interface, the spammer is presented with a list of saved\ntasks. In the screenshot below, we can clearly see a task called \"RonP_3\".\n\n\n-----\n\nClicking on this task link gives us confirmation that the spammer calling himself nenastnyj did\nindeed send the Ron Paul spam:\n\n\n-----\n\nThe list of email addresses assigned to the RonP_3 task is simply titled good . In the\nbackend Reactor files, this file is 3.4 gigabytes in size, and contains 162,211,647 email\naddresses. Although this is a substantial number of email addresses, many of these are\ncertainly outdated or invalid addresses. However, Reactor, like many modern spam botnets,\nhas a feedback mechanism to allow the controller to know when emails are rejected. It\ncannot tell however, when emails are accepted by the destination mailserver and then\nbounced later. As a result, organizations who do \"accept-then-bounce\" are likely to have a\nhigher email load, since they never manage to have outdated addresses purged from botnet\nspammer mailing lists, and they spend a lot of time and bandwidth bouncing emails back to\ndomains that were spoofed by the spammer.\n\nWhile the total count of Ron Paul spam messages that actually landed in peoples' inboxes\ncan't be known, it certainly was received by millions of recipients. All this was done using\naround 3000 bots this speaks to the efficiency of the template-based spam botnet model\nover the older proxy-based methods. The front-end also plays a part in the efficiency, by\nallowing the spammer to check the message's SpamAssassin score before hitting send,\nsimplifying the process of filter evasion and ensuring maximum delivery for the message.\n\n## Mapping the Reactor Operation\n\nSince the bot uses a specific TCP port to communicate with the controller, it is possible to\nlocate additional botnet controllers at the same co-lo facility. By checking nearby network\naddresses, we were able to map out 16 additional servers controlling different variants of the\nmalware. Communication with these servers showed that the botnet is segmented so that\neach sub-botnet is probably rented to different customers.\n\nThe servers we mapped showed the following activity:\n\n\n-----\n\nxxx.xx.168.107 - Inactive\nxxx.xx.168.134 - Penis pill spam\nxxx.xx.168.137 - Russian-language spam\nxxx.xx.168.143 - Inactive\nxxx.xx.168.144 - Inactive\nxxx.xx.168.250 - Previously used, down now\nxxx.xx.169.2 - Inactive\nxxx.xx.169.22 - Replica watch spam\nxxx.xx.169.25 - Russian-language spam\nxxx.xx.169.107 - MLM work-from-home spam\nxxx.xx.169.110 - OEM software spam\nxxx.xx.169.135 - Work-from-home spam\nxxx.xx.169.136 - Penis pill spam\nxxx.xx.169.147 - Penis enlarge patch spam\nxxx.xx.169.148 - Penis pill spam\nxxx.xx.169.153 - Replica watch spam\nxxx.xx.169.154 - Replica watch spam\n\n## Detection\n\nSrizbi can be detected in operation on a network by the following Snort signatures:\n```\n  alert udp any 1024: -> any 4099 \n(msg:\"Trojan.Srizbi registering with controller\"; \n     dsize:20; content:\"|2d|\"; offset:6;\ncontent:\"|2d|\"; distance:6; within:1; \n     classtype:trojan-activity; \nreference:url,www.secureworks.com/research/threats/srizbispam; sid:100000001; \n     rev:1;)\n  alert tcp any any -> any 4099 (msg:\"Trojan.Srizbi requesting template\"; \n     content:\"GET|20|/\"; depth:5; content:\"|0d0a|X-Flags|3a20|\"; within:200;\ncontent:\"|\n     0d0a|X-TM|3a20|\"; within:20; content:\"|0d0a|X-BI|3a20|\"; within:20; \n     reference:url.www.secureworks.com/research/threats/srizbispam; sid:100000002;\n     rev:1;)\n\n## Conclusions\n\n```\n\n-----\n\nWith the facts above, we are left asking the question, who paid to have the Ron Paul spam\nsent and how did they connect with the spammer, 'nenastnyj'?\" The evidence shows that\ndespite being capable of sending upwards of 200 million messages a day, nenastnyj is not\none of the major spammers of the world, and seems to focus on spamming as an affiliate for\nlarger \"kingpin\"operations. The Ron Paul spam was very much a 'one-off' job among the\nother tasks in the Reactor interface. It almost seems as though there may have been some\npre-established relationship between the sponsor of the spam and nenastnyj. However,\ngiven the current state of law enforcement activity concerning spam in the countries of the\nCIS, it is unlikely we will get an answer to these questions. However, it does give us an\nunprecedented look at both the front and back-end operation of a modern botnet spam\nsystem.\n\nSecureWorks would like to thank our colleagues at myNetWatchman, IronPort and\nSpamhaus for their invaluable assistance in the investigation of this botnet.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2003 - 2009/2007-12-04 - Inside the -Ron Paul- Spam Botnet.pdf"
    ],
    "report_names": [
        "2007-12-04 - Inside the -Ron Paul- Spam Botnet.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536032,
    "ts_updated_at": 1743041144,
    "ts_creation_date": 1653767685,
    "ts_modification_date": 1653767685,
    "files": {
        "pdf": "https://archive.orkl.eu/e03593156f0a54ecdc47ee221433256894eab9b2.pdf",
        "text": "https://archive.orkl.eu/e03593156f0a54ecdc47ee221433256894eab9b2.txt",
        "img": "https://archive.orkl.eu/e03593156f0a54ecdc47ee221433256894eab9b2.jpg"
    }
}