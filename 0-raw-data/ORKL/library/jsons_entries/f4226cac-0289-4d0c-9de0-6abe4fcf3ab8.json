{
    "id": "f4226cac-0289-4d0c-9de0-6abe4fcf3ab8",
    "created_at": "2023-01-12T15:08:11.754961Z",
    "updated_at": "2025-03-27T02:09:29.805259Z",
    "deleted_at": null,
    "sha1_hash": "37e64be7e68be4e3ec7b828e0a2ce5a334b94da9",
    "title": "2017-07-20 - Stantinko- A massive adware campaign operating covertly since 2012",
    "authors": "",
    "file_creation_date": "2022-05-29T01:07:55Z",
    "file_modification_date": "2022-05-29T01:07:55Z",
    "file_size": 2477286,
    "plain_text": "# Stantinko: A massive adware campaign operating covertly since 2012\n\n**[welivesecurity.com/2017/07/20/stantinko-massive-adware-campaign-operating-covertly-since-2012/](https://www.welivesecurity.com/2017/07/20/stantinko-massive-adware-campaign-operating-covertly-since-2012/)**\n\nJuly 20, 2017\n\nSince the beginning of 2017, ESET has been conducting an investigation into a complex\nthreat mainly targeting Russia and Ukraine. Stantinko has stood out.\n\n## Overview\n\nSince the beginning of 2017, ESET researchers have been conducting an investigation into\na complex threat mainly targeting Russia and Ukraine. Standing out because of its\nprevalence and its sophistication, Stantinko turned out to be quite a puzzle to solve. Slowly\nputting the pieces together, the global picture began to take shape, exposing a massive\nadware campaign affecting approximately half a million users.\n\nMaking heavy use of code encryption and rapidly adapting so as to avoid detection by antimalware, Stantinko’s operators managed to stay under the radar for at least the last five\nyears, attracting very little attention to their operations.\n\n\n-----\n\nTo infect a system, they trick users looking for pirated software into downloading executable\nfiles sometimes disguised as torrents. FileTour, Stantinko’s initial installation vector, then\nloudly installs a lot of software to distract the user while it covertly installs Stantinko’s first\nservice in the background. Video 1 shows a fictive user running the malicious executable.\n\n**Video 1. Video of a user downloading and running the malicious file**\n\nWatch Video At:\n\nhttps://youtu.be/OYncoW7X5wA\n\nStantinko’s operators control a huge botnet that they monetize mainly by installing malicious\nbrowser extensions that perform ad injection and click fraud. However, they don’t stop\nthere. The malicious Windows services they install enable them to execute anything on the\ninfected host. We’ve seen them being used to send a fully featured backdoor, a bot\nperforming massive searches on Google, and a tool performing brute-force attacks on\nJoomla and WordPress administrator panels in an attempt to compromise and potentially\nresell them.\n\nFigure 1 shows the full Stantinko threat from the infection vector to the final persistent\nservices and related plugins.\n\n\n-----\n\nFigure 1 – Full diagram of the Stantinko threat\n\n\n## Key features\n\n\n-----\n\nStantinko stands out in the way it circumvents antivirus detection and thwarts reverse\nengineering efforts to determine if it exhibits malicious behavior. To do so, its authors make\nsure multiple parts are needed to conduct a complete analysis. There are always two\ncomponents involved: a loader and an encrypted component. The malicious code is\nconcealed in the encrypted component that resides either on the disk or in the Windows\nRegistry. This code is loaded and decrypted by a benign-looking executable. The key to\ndecrypt this code is generated on a per-infection basis. Some components use the bot\nidentifier and others use the volume serial number from its victim PC’s hard drive. Making\nreliable detections based on the non-encrypted components is a very difficult task, since\nartifacts residing on the disk do not expose malicious behavior until they’re executed.\n\nMoreover, Stantinko has a powerful resilience mechanism. After a successful compromise,\nthe victim’s machine has two malicious Windows services installed, which are launched at\nsystem startup. Each service has the ability to reinstall the other in case one of them is\ndeleted from the system. Thus, to successfully uninstall this threat, both services must be\ndeleted at the same time. Otherwise, the C&C server can send a new version of the deleted\nservice that isn’t detected yet or that contains a new configuration.\n\nStantinko’s main functionality is to install malicious browser extensions named The Safe\n_Surfing and Teddy Protection. Both extensions were available on the Chrome Web Store_\nduring our analysis. At first sight, they look like legitimate browser extensions that block\nunwanted URLs. However, when installed by Stantinko, the extensions receive a different\nconfiguration containing rules to perform click fraud and ad injection. In Video 2, the The\n_Safe Surfing extension is installed. The user is redirected when clicking a link on the_\nRambler search engine.\n\n\n-----\n\nFigure 2 – Teddy Protection on the Chrome Web Store\n\n**Video 2. Search traffic redirection on Rambler website**\n\n\n-----\n\nWatch Video At:\n\nhttps://youtu.be/FirDn0O-PTY\n\nStantinko is a modular backdoor. Its components embed a loader allowing them to execute\nany Windows executable sent by the C&C server directly in memory. This feature is used as\na very flexible plugin system allowing the operators to execute anything on an infected\nsystem. Table 1 is a description of known Stantinko plugins.\n\n**Table 1. Known Stantinko Plugins**\n\n**Module**\n**Name** **Analysis**\n\nBrute-force Distributed dictionary-based attack on Joomla and WordPress\nadministrative panels.\n\n\nSearch\nParser\n\nRemote\nAdministrator\n\nFacebook\nBot\n\n\nPerforms massive distributed and anonymous searches on Google to find\nJoomla and WordPress websites. It uses compromised Joomla websites\nas C&C servers.\n\nBackdoor that implements a full-range of actions from reconnaissance to\ndata exfiltration.\n\nBot performing fraud on Facebook. Its capabilities include creating\naccounts, liking picture or pages, and adding friends.\n\n\n## Monetization\n\n\n-----\n\nAlthough the developers of Stantinko use methods that are most often seen in APT\ncampaigns, their final aim is to make money. Thus, they are present in one of the most\nprofitable cybercrime markets.\n\nFirst, these days click fraud is a major source of revenues in the cybercrime ecosystem.\n[Research conducted by the firm White Ops and the Association of National Advertisers](https://www.ana.net/content/show/id/botfraud-2017)\n(US) has estimated the global cost of click fraud in 2017 will be $6.5 billion.\n\nAs explained above, Stantinko installs two browser extensions, The Safe Surfing and Teddy\n_Protection, which inject advertisements or redirect the user. It allows the Stantinko_\noperators to be paid for the traffic they provide to advertisers. Figure 4 is a summary of the\nredirection process.\n\nFigure 4 – Click fraud redirection process\n\nOur study also shows that they are really close to the advertisers. In some cases, including\nthe example in Figure 4, the user will reach the advertiser’s website directly after the\nStantinko-owned ad network. On the other hand, traditional click-fraud malware relies on a\nseries of redirections between several ad networks to launder their malicious traffic. This\nshows that not only are the Stantinko operators able to develop highly stealthy malware, but\nthey are also able to abuse the traditional ad-serving economy without getting caught.\n\nSecond, they are also trying to gain fraudulent access to the administrative accounts of\nJoomla and WordPress websites. Their attack relies on a brute-force attack using a list of\ncredentials. The aim is to guess the password by trying tens of thousands of different\ncredentials. Once compromised, these accounts can be resold on the underground market.\nThen, they could be used to redirect site visitors to exploit kits elsewhere or to host\nmalicious content.\n\n\n-----\n\nThird, our study also shows how Stantinko perpetrates social network fraud. This type of\n[fraud has already been described by ESET researchers in the Dissecting Linux/Moose](https://www.welivesecurity.com/wp-content/uploads/2015/05/Dissecting-LinuxMoose.pdf)\nwhite paper. It is really profitable as, for instance, prices are around $15 per 1000 Facebook\nlikes even though they are actually generated by fake accounts controlled by a botnet.\n\nThe Stantinko operators developed a plugin that can interact with Facebook. It is able,\namong other things, to create accounts, ‘like’ a page or add a friend. To bypass Facebook’s\nCAPTCHA, it relies on an online anti-CAPTCHA service pictured in Figure 5. The size of the\nStantinko botnet is an advantage as it allows its operators to distribute the queries among\nall the bots. Thus, it is more difficult for Facebook to detect this type of fraud.\n\nFigure 5 – Anti-CAPTCHA service used by Stantinko\n\n## Conclusion\n\nStantinko is a botnet mostly dedicated to ad-related fraud. Using advanced techniques such\nas code encryption and storing code in the Windows Registry, its operators were able to\nstay under the radar for the past five years. This led to a botnet of approximately 500,000\ninfected machines.\n\nThey were also able to publish their two ad injection browser extensions on the Chrome\nWeb Store. One of them was first released on the Chrome Web Store in November, 2015.\n\nEven though it isn’t noticeable to the user, due to the absence of CPU intensive tasks,\nStantinko is a major threat, as it provides a large source of fraudulent revenue to\ncybercriminals. Moreover, the presence of a fully featured backdoor allows the operators to\nspy on all the victimized machines.\n\n_[For a comprehensive technical analysis of Stantinko, refer to our white paper. The](http://welivesecurity.com/wp-content/uploads/2017/07/Stantinko.pdf)_\n_[Indicators of Compromise are provided on our GitHub account. For any inquiries, or to](https://github.com/eset/malware-ioc/tree/master/stantinko)_\n_[make sample submissions related to the subject, contact us at: threatintel@eset.com.](http://10.10.0.46/mailto:threatintel@eset.com)_\n\n20 Jul 2017 - 03:00PM\n\n\n-----\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-07-20 - Stantinko- A massive adware campaign operating covertly since 2012.pdf"
    ],
    "report_names": [
        "2017-07-20 - Stantinko- A massive adware campaign operating covertly since 2012.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1b3a247f-6186-4482-8b92-c3fb2d767c7d",
            "created_at": "2023-01-06T13:46:38.883911Z",
            "updated_at": "2025-03-27T02:00:02.942724Z",
            "deleted_at": null,
            "main_name": "APT39",
            "aliases": [
                "COBALT HICKMAN",
                "G0087",
                "Radio Serpens",
                "TA454",
                "REMIX KITTEN"
            ],
            "source_name": "MISPGALAXY:APT39",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6b6155e4-94ec-4909-b908-550afe758ad6",
            "created_at": "2022-10-25T15:50:23.365074Z",
            "updated_at": "2025-03-27T02:00:55.455014Z",
            "deleted_at": null,
            "main_name": "APT39",
            "aliases": [
                "APT39",
                "ITG07",
                "Remix Kitten"
            ],
            "source_name": "MITRE:APT39",
            "tools": [
                "NBTscan",
                "MechaFlounder",
                "Remexi",
                "CrackMapExec",
                "pwdump",
                "Mimikatz",
                "Windows Credential Editor",
                "Cadelspy",
                "PsExec",
                "ASPXSpy",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536091,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653786475,
    "ts_modification_date": 1653786475,
    "files": {
        "pdf": "https://archive.orkl.eu/37e64be7e68be4e3ec7b828e0a2ce5a334b94da9.pdf",
        "text": "https://archive.orkl.eu/37e64be7e68be4e3ec7b828e0a2ce5a334b94da9.txt",
        "img": "https://archive.orkl.eu/37e64be7e68be4e3ec7b828e0a2ce5a334b94da9.jpg"
    }
}