{
    "id": "abccf607-02f4-48ac-81ee-7a453ddef79f",
    "created_at": "2023-01-12T15:03:34.98389Z",
    "updated_at": "2025-03-27T02:09:18.218266Z",
    "deleted_at": null,
    "sha1_hash": "44b42b2ed581d213aaf31d1ecef4f637296983ad",
    "title": "2022-05-09 - Cybereason vs. Quantum Locker Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T18:25:55Z",
    "file_modification_date": "2022-05-28T18:25:55Z",
    "file_size": 2479822,
    "plain_text": "# Cybereason vs. Quantum Locker Ransomware\n\n**cybereason.com/blog/cybereason-vs.-quantum-locker-ransomware**\n\nWritten By\nCybereason Nocturnus\n\nMay 9, 2022 | 5 minute read\n\n\n-----\n\nThe Quantum Locker is a ransomware strain that was first discovered in July 2021. Since then, the\nransomware was observed used in fast ransomware attacks, in some cases even Time-to-Ransom (TTR) of\nless than 4 hours, leaving defenders little time to react.\n\n## Key Details\n\n**Time-to-Ransom (TTR) of less than 4 hours: From initial infection to encryption takes even less than**\n4 hours, leaving a very short window for defenders to successfully defend against the threat.\n**High Severity: The** [Cybereason Nocturnus Team assesses the threat level as HIGH given the](https://www.cybereason.com/blog/authors/cybereason-nocturnus)\ndestructive potential of the attacks.\n**Human Operated Attack: Prior to the deployment of the ransomware, the attackers attempt to infiltrate**\n[and move laterally throughout the organization, carrying out a fully-developed RansomOps attack.](https://www.cybereason.com/blog/white-paper-inside-complex-ransomops-and-the-ransomware-economy)\n**Detected and Prevented: The** [AI-Driven Cybereason XDR Platform fully detects and prevents the](https://www.cybereason.com/platform)\nQuantum Locker.\n\n_Cybereason Blocks Quantum Locker_\n\n[The Quantum ransomware is another rebranding of the notorious MountLocker ransomware, which launched](https://malpedia.caad.fkie.fraunhofer.de/details/win.mount_locker)\nback in September 2020. Since then, the ransomware gang has rebranded its operation to various names,\n[including AstroLocker,](https://news.sophos.com/en-us/2021/03/31/sophos-mtr-in-real-time-what-is-astro-locker-team/) [XingLocker, and now in its current phase, the Quantum Locker:](https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/)\n\n_Rebranding of Mount Locker_\n\nSame with other ransomware that follow the double extortion trend, that became already a second nature to\nransomware, the Quantum Locker has its own data leak TOR website - “Quantum Blog”, and according to it\nthe gang has over 20 victims, with 7 of them being new as of April 2022:\n\n\n-----\n\n_Quantum Leaks website_\n\nThe ransom demands for the gang vary depending on the victim, with some attacks demanding $150,000 to\nreceive a decryptor, while others are multi-million dollar demands, as shown below:\n\n_Quantum support chat_\n\nThe victim only gets 72 hours to get back in touch with the gang, and if not - the stolen data is shared on the\nwebsite for free downloads for the public:\n\n\n-----\n\n_Stolen data_\n\n_shared on the Quantum Blog website_\n\n## Breaking Down the Attack\n\n### Initial Infection Vector - IcedID\n\n[The infamous malware, IcedID, that started as a banking trojan back in 2017, is observed being utilized as the](https://malpedia.caad.fkie.fraunhofer.de/details/win.icedid)\n[initial access by various ransomware gangs. Among those gangs are Conti,](https://www.techtarget.com/searchsecurity/news/252515561/Conti-ransomware-deployed-in-IcedID-banking-Trojan-attack) [REvil, and the former brand of](https://twitter.com/abuse_ch/status/1376570314348494850)\nQuantum - [the Xing Locker. As for now, the gang seems to continue with this method with the Quantum](https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/)\nLocker as well; “If it ain't broke don’t fix it.”\n\n[The campaign of IcedID observed ending in Quantum Locker execution starts with a phishing attack via](https://www.intezer.com/blog/research/conversation-hijacking-campaign-delivering-icedid/)\nemail. The email contained an .iso image file that contains the IcedID loader payload in the form of a DLL\n(dar.dll) and shortcut file - an .LNK file - that targets the IcedID payload and masquerades as a document.\n\nWhen mounting the .iso file, the end user only sees the shortcut file named “document”, and the DLL itself is\nhidden. After the user clicks on the shortcut, the IcedID DLL is executed:\n\n_Document.lnk_\n\n_properties_\n\nThe unpacked DLL is loaded into memory (loader_dll_64.dll) and it begins its communication with the C2:\n\n\n-----\n\n_The execution of the IcedID payload as shown in the Cybereason XDR platform_\n\n[As with most commodity malware, for example TrickBot, IcedID executes initial discovery commands and](https://www.cybereason.com/blog/research/triple-threat-emotet-deploys-trickbot-to-steal-data-spread-ryuk-ransomware)\nthen exfiltrates the results via the C2 channel. If threat actors find the organization to be of interest, they will\nlaunch the next phase:\n\nCmd.exe /c chcp >&2\n\nIpconfig /all\n\nSysteminfo\n\nNet config workstation\n\nNltest /domain_trusts /all_trusts\n\nNet view /all /domain\n\nNet view /all\n\nNet group Domain Admins /domain\n\n_IcedID reconnaissance commands_\n\n### Moving to an Interactive Attack\n\nThe next phase of the attack starts after IcedID sends the reconnaissance output back to the C2. In some\ncases, it started just two hours after the user clicks on the .lnk file. In this phase, the threat actor starts an\ninteractive attack in the breached network. To do so, they use the initial IcedID implant to download and\nexecute another implant. In most cases the gang used Cobalt Strike beacon to launch the interactive phase.\n\nFirst, the threat actor wants to perform additional and more in-depth reconnaissance activity. They execute a\nscript named adfind.bat that uses the tool [AdFind to collect information about the Active Directory. In addition,](https://www.joeware.net/freetools/tools/adfind/)\nthey also run a batch script named ns.bat which runs nslookup for each host in the domain.\n\nThe AdFind.bat script is dropped in the %temp% directory, along with the AdFind.exe binary and 7Zip binary\nnamed 7.exe. The output is saved into .txt files and sent to the C2. After that, the batch file removes tracks by\ndeleting the script, the AdFind binary, the .txt files and the 7Zip binary:\n\n\n-----\n\n_The execution of AdFind.bat, as shown in the Cybereason XDR Platform_\n\n### Lateral Movement\n\nTo move laterally in the environment, the threat actor first dumps the lsass process and gains credentials.\n\nThen, they start making RDP connections to other servers in the environment and remote WMI discovery\ntasks to test the gained credentials:\n\n_Evidence of_\n\n_credential dumping as shown in the Cybereason XDR Platform_\n\nAfter confirming that the credentials work, the threat actor continues to prepare for the deployment of the\nQuantum Locker. They start spreading in the network by copying the ransomware binary to the other\nmachine's c$\\windows\\temp\\ shared folder and then execute them remotely via WMI and PsExec.\n\n### Ransomware Execution\n\nUpon execution, the ransomware first checks for the presence of different services and processes related to\nsecurity software such as AVs, malware analysis tools, Microsoft Office, browsers and databases. If found,\nthe ransomware tries to kill the service / process:\n\n\n-----\n\nmsftesql.exe\n\nsqlbrowser.exe\n\nsqlwriter.exe\n\noracle.exe\n\nocssd.exe\n\ndbsnmp.exe\n\nsynctime.exe\n\nagntsvc.exe\n\nisqlplussvc.exe\n\nxfssvccon.exe\n\nsqlservr.exe\n\nencsvc.exe\n\nocautoupds.exe\n\nmydesktopservice.exe\n\nfirefoxconfig.exe\n\nfirefoxconfig.exe\n\nmydesktopqos.exe\n\n\nocomm.exe\n\nmysqld.exe\n\nsqlagent.exe\n\nmysqld-nt.exe\n\nmysqld-opt.exe\n\ndbeng50.exe\n\nsqbcoreservice.exe\n\nexcel.exe\n\ninfopath.exe\n\nmsaccess.exe\n\nmspub.exe\n\nonenote.exe\n\noutlook.exe\n\npowerpnt.exe\n\nsqlservr.exe\n\nvisio.exe\n\nwinword.exe\n\n\nwordpad.exe\n\nQBW32.exe\n\nQBW64.exe\n\nipython.exe\n\nwpython.exe\n\npython.exe\n\ndumpcap.exe\n\nprocmon.exe\n\nprocmon64.exe\n\nprocexp.exe\n\nprocexp64.exe\n\nthebat.exe\n\nsteam.exe\n\nthebat64.exe\n\nthunderbird.exe\n\n\n_List of processes to terminate_\n\nThen, the ransomware starts its encryption routine. It encrypts the files on the disc and appends the .quantum\nextension to it. It also leaves a ransom note named README_TO_DECRYPT.html:\n\n_Files encrypted by the Quantum Locker_\n\n\n-----\n\n_Quantum Locker ransom note_\n\nIn addition, the ransomware creates a log file for its execution named <ransom_binary>.exe.log. This log file\ncontains information about the machine, user, domain, killed processes and services, and each file's status - if\nit was encrypted or skipped.\n\n## Cybereason Detection and Prevention\n\nThe [AI-driven Cybereason XDR Platform is able to prevent the execution of the Quantum Locker using multi-](https://www.cybereason.com/platform)\nlayer protection that detects and blocks malware with threat intelligence, machine learning, and next-gen\nantivirus (NGAV) capabilities. Additionally, when the [Anti-Ransomware feature is enabled, behavioral](https://www.cybereason.com/platform/ransomware-protection)\ndetection techniques in the platform are able to detect and prevent any attempt to encrypt files and generates\na [MalOpTM for it:](https://www.cybereason.com/blog/the-cybereason-malop-achieving-operation-centric-security)\n\n_MalOp for Quantum Locker as shown in the Cybereason XDR Platform_\n\n\n-----\n\nUsing the Anti-Malware feature with the right configurations (listed in the recommendations below), the\n[Cybereason XDR Platform will also detect and prevent the execution of the ransomware and ensure that it](https://www.cybereason.com/fundamentals/what-is-ransomware)\ncannot encrypt targeted files. The prevention is based on machine learning, which blocks both known and\nunknown malware variants:\n\n_Cybereason user notification for preventing the_\n\n_execution of Quantum Locker_\n\n## Security Recommendations\n\n**Enable the Anti-Ransomware Feature on Cybereason NGAV: Set Cybereason Anti-Ransomware**\nprotection mode to Prevent - [more information for Cybereason customers can be found here](https://nest.cybereason.com/documentation/product-documentation/190/anti-ransomware-settings#set-protection-mode)\n**Enable Anti-Malware Feature on Cybereason NGAV: Set Cybereason Anti-Malware mode to Prevent**\nand set the detection mode to Moderate and above - more information for cybereason customers can be\nfound here\n**Keep Systems Fully Patched: Make sure your systems are patched in order to mitigate vulnerabilities**\n**Regularly Backup Files to a Remote Server: Restoring your files from a backup is the fastest way to**\nregain access to your data\n**Use Security Solutions: Protect your environment using organizational firewalls, proxies, web filtering,**\nand mail filtering\n\n## Indicators of Compromise\n\n**IOC** **Type** **Description**\n\n\nb63e94928da25e18caa1506305b9ca3dedc267e747dfa4710860e757d2cc8192\n\n1d64879bf7b1c7aea1d3c2c0171b31a329d026dc4e2f1c876d7ec7cae17bbc58\n\n511c1021fad76670d6d407139e5fef62b34ca9656fb735bd7d406728568fa280\n\nfaf49653a0f057ed09a75c4dfc01e4d8e6fef203d0102a5947a73db80be0db1d\n\n0f3bb820adf6d3bba54988ef40d8188ae48b34b757277e86728bdb8441d01ea2\n\n0789a9c0a0d4f3422cb4e9b8e64f1ba92f7b88e2edfd14b7b9a7f5eee5135a4f\n\n\nSHA256 Quantum\nbinaries\n\n\n-----\n\n8d30ab8260760e12a8990866eced1567ced257e0cb2fc9f7d2ea927806435208\n\n2c84b5162ef66c154c66fed1d14f348e5e0054dff486a63f0473165fdbee9b2e\n\n116e8c1d09627c0330987c36201100da2b93bf27560478be4043c1a834ad8913\n\n99a732c0512bc415668cc3a699128618f02bf154ff8641821c3207b999952533\n\nf72c47948a2cb2cd445135bc65c6bf5c0aaacc262ee9c04d1483781355cda976\n\nf8136eb39ee8638f9eb1acf49b1e10ce73e96583a885e4376d897ab255b39bd6\n\n79e25568a8aeec71d18adc07cdb87602bc2c6048e04daff1eb67e45f94887efc\n\nd44c065f04fe13bd51ba5469baa9077efb541d849ad298043739e08b7a90008f\n\n239d1c7cfd5b244b10c56abbf966f226e6a0cb91800e9c683ba427641e642f10\n\n7522b6de340a68881d11aa05e2c6770152e2d49ca5b830821ffce533fad948fd\n\n5bc00ad792d4ddac7d8568f98a717caff9d5ef389ed355a15b892cc10ab2887b\n\n138[.]68.42.130\n\n157[.]245.142.66\n\n188[.]166.154.118:80\n\ndilimoretast[.]com\n\nantnosience[.]com\n\noceriesfornot[.]top\n\narelyevennot[.]top\n\n## MITRE ATT&CK TECHNIQUES\n\n\nSHA256 IcedID .iso\nfiles\n\nIP IcedID C2\n\nDomain IcedID C2\n\n\n**Initial**\n**Access**\n\n\n**Lateral**\n**Movement**\n\n\n**Execution** **Defense**\n**Evasion**\n\n\n**Credential**\n**Access**\n\n\n**Discovery** **Collection** **Impact**\n\n\n[Phishing](https://attack.mitre.org/techniques/T1566/) Taint\n[Shared](https://attack.mitre.org/techniques/T1080/)\nContent\n\n\n[Masquerading](https://attack.mitre.org/techniques/T1036) Credentials\nfrom\nPassword\nStores\n\nProcess\nInjection\n\n\nAccount\nDiscovery\n\nSystem\n[Information](https://attack.mitre.org/techniques/T1082/)\nDiscovery\n\nFile and\n[Directory](https://attack.mitre.org/techniques/T1083/)\nDiscovery\n\n\nData from\n[Local](https://attack.mitre.org/techniques/T1005/)\nSystem\n\n\nData\n[Encrypted](https://attack.mitre.org/techniques/T1486/)\nfor Impact\n\nInhibit\n[System](https://attack.mitre.org/techniques/T1490/)\nRecovery\n\n\nValid\nAccounts\n\n\nRemote\nFile Copy\n\n\nCommand and\nScripting\nInterpreter:\nPowerShell\n\nScheduled\nTask/Job\n\nWindows\n[Management](https://attack.mitre.org/techniques/T1047/)\nInstrumentation\n\n\n-----\n\n[User Execution](https://attack.mitre.org/techniques/T1204/) System\n[Location](https://attack.mitre.org/techniques/T1614/001/)\nDiscovery\n\n## About the Researcher:\n\n**LIOR ROCHBERGER, SENIOR THREAT RESEARCHER AND THREAT HUNTER,**\n\n**CYBEREASON**\n\nAs part of the Nocturnus team at Cybereason, Lior has created procedures to lead threat hunting, reverse\nengineering and malware analysis teams. Lior has also been a contributing researcher to multiple threat and\nmalware blogs including Bitbucket, Valak, Ramnit, and Racoon stealer. Prior to Cybereason, Lior led SOC\noperations within the Israeli Air Force.\n\nAbout the Author\n\n**Cybereason Nocturnus**\n\nThe Cybereason Nocturnus Team has brought the world’s brightest minds from the military, government\nintelligence, and enterprise security to uncover emerging threats across the globe. They specialize in\nanalyzing new attack methodologies, reverse-engineering malware, and exposing unknown system\nvulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya\nand Bad Rabbit cyberattacks.\n\n[All Posts by Cybereason Nocturnus](https://www.cybereason.com/blog/authors/cybereason-nocturnus)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-09 - Cybereason vs. Quantum Locker Ransomware.pdf"
    ],
    "report_names": [
        "2022-05-09 - Cybereason vs. Quantum Locker Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535814,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653762355,
    "ts_modification_date": 1653762355,
    "files": {
        "pdf": "https://archive.orkl.eu/44b42b2ed581d213aaf31d1ecef4f637296983ad.pdf",
        "text": "https://archive.orkl.eu/44b42b2ed581d213aaf31d1ecef4f637296983ad.txt",
        "img": "https://archive.orkl.eu/44b42b2ed581d213aaf31d1ecef4f637296983ad.jpg"
    }
}