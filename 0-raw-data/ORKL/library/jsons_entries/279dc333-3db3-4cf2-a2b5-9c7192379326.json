{
    "id": "279dc333-3db3-4cf2-a2b5-9c7192379326",
    "created_at": "2023-01-12T15:03:05.336394Z",
    "updated_at": "2025-03-27T02:16:25.611075Z",
    "deleted_at": null,
    "sha1_hash": "61a8b2ba096763e7583e64acf888c547a4440908",
    "title": "2021-10-04 - Mobile Malware- TangleBot Untangled",
    "authors": "",
    "file_creation_date": "2022-05-28T16:52:37Z",
    "file_modification_date": "2022-05-28T16:52:37Z",
    "file_size": 1982283,
    "plain_text": "# Mobile Malware: TangleBot Untangled\n\n**[proofpoint.com/us/blog/threat-insight/mobile-malware-tanglebot-untangled](https://www.proofpoint.com/us/blog/threat-insight/mobile-malware-tanglebot-untangled)**\n\n\nOctober 1, 2021\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nMobile Malware: TangleBot Untangled\n\n\n-----\n\nOctober 04, 2021 Felipe Naves, Adam McNeil, and Andrew Conway\n\n## Key Takeaways \n\nTangleBot is leveraging COVID-19 and electricity-themed lures in its effort to convince\nusers to click on the malicious link and install the malware.\nThe SMS links are only malicious via Android mobile devices and are currently only\nbeing sent to US and Canadian users.\nTangleBot, while sharing some similarities with the Medusa malware, has some key\ndistinguishing features that make it particularly threatening, such as its advanced\nbehaviors and transmission abilities and its use of a string decryption routine as part of\nits obfuscation.\n\n## Overview \n\n[On the heels of a busy summer tracking the rapid spread of FluBot mobile malware across](https://www.proofpoint.com/us/blog/threat-insight/flubot-android-malware-spreading-rapidly-through-europe-may-hit-us-soon)\nEurope and Australia, Proofpoint researchers have observed yet another malware campaign,\ndubbed TangleBot, designed to steal mobile users’ sensitive information. TangleBot started\noff using ever popular Covid-themed lures to trick Android users in Canada and the United\nStates into installing malware on their devices. Proofpoint threat analysts recently covered a\n[high-level overview of TangleBot on the Cloudmark blog, warning mobile users of this threat.](https://www.cloudmark.com/en/blog/mobile/tanglebot-new-advanced-sms-malware-targets-mobile-users-across-us-and-canada-covid-19)\nIn this blog, researchers dive into the malware, detailing what makes it interesting and why it\nhas been coined TangleBot.\n\nProofpoint took notice of this malware prior to widespread distribution and worked with our\npartners at Google to ensure Google Play Protect adequately detects the software (Figure 1)\nhelping ensure protection for the greater global community.\n\n\n-----\n\n_Figure 1. Google Play Protect alert banner that the malicious software has been removed._\n\n## The SMS Lure\n\nProofpoint analysts first detected this attack in early September 2021. The initial lures came\nin the form of Covid-19 SMS messages masquerading as legitimate medical\nnotifications. The messages contained links to URLs pertaining to Covid-19 or vaccine\ninformation and appeared legitimate to unsuspecting users.\n\nA follow-up campaign has been detected using messaging related to a potential power\noutage and targeting users of hydroelectric plants across the United States and Canada.\n\n_Figure 2. Vaccine lure.                   Figure 3. Covid lure._\n_Figure 4. Electricity lure._\n\n\n-----\n\n## Installation \n\nIf users click the link contained within the text message, threat actors use the timetested method of advising users Adobe Flash Player needs an update to display the\ncontent. There is obviously no need to worry\n[that Adobe stopped supporting this product after December 31, 2020, or that Adobe](https://www.adobe.com/products/flashplayer/end-of-life.html)\n[Flash Player has not been supported on any mobile device since 2012. Threat actors play on](https://community.adobe.com/t5/flash-player-discussions/flash-player-for-android-phones/td-p/9954925)\nthis lack of understanding to help eliminate unsatisfactory targets who may uncover the ruse\ntoo quickly.\n\nUnsuspecting users are presented a series of dialogue boxes requesting acceptance of\nthe permissions and installation from unknown sources. Proofpoint analysts counted no less\nthan nine dialogue boxes that users must click prior to the full installation of the malware.\nWhile this may seem like a lot, the lesson learned from the FluBot outbreak over the summer\nis that users tend to disregard the multiple warnings and permissions and still download and\ninstall software from unknown sources. The following nine images highlight the experience of\na victim from APK download (the installer file for Android) through the completed installation\nof the software.\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n_Figures 5-13. TangleBot installation windows._\n\n## Permissions \n\nTangleBot requests access to many permissions allowing for eavesdropping and\nthe exfiltration of sensitive data. These permissions grant the ability for the malware\nto modify device configuration settings, record user activity and tracking location, and\ntransmit the stolen information back to systems controlled by the threat actor.\n\n_Figure 14. Permissions requested by TangleBot._\n\n## Behind the Scenes\n\nOutside of the observable malware behavior, there are several activities taking place,\nincluding the setup and configuration of the malware, and the capabilities of\nthe threat actor post-infection. Below we will look at a few of these capabilities.\n\n## Command and Control (C2) - Setup\n\nThe threat actor uses social media messaging to deliver covert C2 infrastructure information\nto infected devices. The messaging in the detected sample arrives via Telegram but could\neasily be replaced by another online service of the threat actor’s choice. The information is\ndisseminated within cryptic posts that would be unrecognizable without proper context. The\nmalware contacts defined patterns within the specified social media pages. Once located,\nthe malware can receive threat actor-supplied instructions.\n\n\n-----\n\n_Figure 15. Telegram page showing C2 information and network GET request_\n\n## Command and Control (C2) – Commands\n\nAfter establishing connectivity with the infected device, dozens of instructions are used to\ninteract with and exfiltrate data and other sensitive information.\n\nSpecific instructions allow for the control and monitoring of infected devices, manipulation of\nuser data and browser activity, and the theft of confidential information. The following is a\nshort list of a few available C2 commands:\n\nCall and SMS control Keylogging capability Display Play Protect Settings\n\nHTML injection USSD messaging Set screen brightness\n\nScreen capture Running apps Remove Admin\n\nCamera capture Track settings Current Window ghost\n\n\n-----\n\nMicrophone capture Autofill text boxes Ignore Battery Optimizations\n\nUnblock apps Copy Clipboard\n\n## Functionality \n\nTangleBot allows the threat actor full control over infected devices. The control afforded by\nthe malware allows for the monitoring and recording of all aspects of user activity, including\nwebsites visited, collection of typed passwords, audio and video from the\nmicrophone/camera, and can harvest data including SMS activity and stored content. This\nallows for a full range of surveillance and collection capabilities.\n\n## HTML Injection\n\nHTML injection is used to generate fake application overlay screens. These screens may\nperfectly resemble the login pages of financial institutions and are designed to compromise\nthe credentials of unsuspecting users. This type of overlay functionality\nis likely what caused widespread financial loss from the FluBot malware family. Below is an\nexample of the HTML injection.\n\n\n-----\n\n_Figure 16. TangleBot HTML injection._\n\n## GPS Location Services\n\nTangleBot also uses GPS location data that enables actors to identify the location of the\ndevice, which helps deliver relevant attack data based on geography, language, or\nother criteria chosen by the threat actor. This information may also be used for more\nnefarious purposes, including the tracking and identification of specific victims, and routine\npurposes such as helping to identify systems used by researchers and analysts.\n\n\n-----\n\n_Figure 17. TangleBot GPS tracking services._\n\n## Voice Recording\n\nWe have identified several components used for voice recording using the microphone.\nAudio is recorded at times determined by the threat actor and the collected content is\n[transmitted via RTSP to threat actor-controlled systems. RTSP, also known as Real Time](https://en.wikipedia.org/wiki/Real_Time_Streaming_Protocol)\nStreaming Protocol, offers advantages in compatibility and flexibility and allows data\ntransmissions via continuous streams rather than from a file on disk.\n\nThe purpose of voice recording is multifaceted and can introduce the risk of second order\neffects or impacts. Threat actors can use stolen voice information to impersonate voice\n[biometric identification patterns in use by major financial organizations. These voice](https://www.finextra.com/blogposting/20329/voice-biometrics-are-ready-for-prime-time-in-banking)\nbiometrics help companies verify the identity of the caller but could be used by crafty\n[attackers to impersonate the victim or used to create Deepfake voice technology resulting in](https://www.forbes.com/sites/forbestechcouncil/2021/05/10/analyzing-the-rise-of-deepfake-voice-technology/)\nadditional schemes or financial loss.\n\n\n-----\n\n_Figure 18. TangleBot RTSP functionality._\n\n## Make a Call\n\nAnother capability uncovered within the TangleBot functionality is the ability to place a call\nfrom the victim device. This capability could be used to dial premium services resulting\nin financial loss or use the device to initiate a call impersonating the victim. Combine this with\n\n\n-----\n\nvoice biometric identification and it is not difficult to understand the potential danger this\nfunctionality poses.\n\n_Figure 19. TangleBot call functionality._\n\n## A New Evolution in Familiar Malware\n\nTangleBot shares some similar behaviors with another piece of malware, Medusa, as\nnoted by other researchers, including recently by our peers at Cyble. Those researchers,\n[who have also looked into this same campaign, have produced a detailed write up containing](https://blog.cyble.com/2021/09/23/medusa-malware-spreading-via-fake-canadian-government-covid-19-portal/)\nadditional information not covered in this blog. That research attributes the malware to the\nMedusa campaign from 2020.\n\nWe distinguish between that campaign and this one because of interesting malware\ncharacteristics not previously seen in Medusa-related SMS campaigns. Characteristics\nrelating to keylogging functionality, overlay ability, and data exfiltration are routine behaviors\nin any malware arsenal. TangleBot, however, sets itself apart with advanced behaviors and\ntransmission capabilities, while showcasing the latest evolutions in malware attempting to\nthwart biometric voice-authentication security systems. One final component of TangleBot\nnot seen in the original Medusa is the advanced use of a string decryption routine helping to\nobfuscate and conceal the behavior of the malware. All those factors combined are what led\nProofpoint researchers to the updated nomenclature.\n\n\n-----\n\n_Figure 20. String decryption routine._\n\n## TangleBot Name \n\nProofpoint researchers chose the name TangleBot to represent this malware due to the\nmany obfuscation layers used to hide the purpose and functionality of the software. The\nmalware uses various obfuscating techniques including hidden .dex files, modular\nand functional design characteristics, minified code, and excessive unused code. Taken\ntogether, this is a tangled mess of code that is both difficult and timely to dissect.\n\n\n-----\n\n_Figure 21. Obfuscation using mathematical equations to encrypt strings._\n\n## Outlook\n\n\n-----\n\nIf the Android ecosystem has shown us anything this summer, it is that the Android\nlandscape is rife with clever social engineering, outright fraud, and malicious software all\ndesigned to deceive and steal mobile users’ money and other sensitive\ninformation. These schemes can appear quite convincing and may play on fears or emotions\nthat cause users to let down their guard.\n\n## EmergingThreats PRO Detection Rules\n\n2850020: Android TangleBot Activity\n\n2850021: Android TangleBot CnC Response\n\n## Indicators of Compromise\n\nFilename(s):  Flash_Player.apk\n\nMD5:   5E176F2514481137618DB5592FD84D13\n\n2F0693ADF07EB36220C04F1DE2385029\n\nPackage name: com.ltjkqj.erfycvar\n\ncom.ltrmht.nfzyqttg\n\nMainActivity pkg names: com.ltjkqj.erfycvar.MainActivity\n\nIcon: YouTube\n\nServer:   sock.godforgiveuss.live\n\nPort: 20027\n\n172.107.133.201:20027\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-04 - Mobile Malware- TangleBot Untangled.pdf"
    ],
    "report_names": [
        "2021-10-04 - Mobile Malware- TangleBot Untangled.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535785,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653756757,
    "ts_modification_date": 1653756757,
    "files": {
        "pdf": "https://archive.orkl.eu/61a8b2ba096763e7583e64acf888c547a4440908.pdf",
        "text": "https://archive.orkl.eu/61a8b2ba096763e7583e64acf888c547a4440908.txt",
        "img": "https://archive.orkl.eu/61a8b2ba096763e7583e64acf888c547a4440908.jpg"
    }
}