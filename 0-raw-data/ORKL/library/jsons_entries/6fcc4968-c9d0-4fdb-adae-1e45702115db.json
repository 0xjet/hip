{
    "id": "6fcc4968-c9d0-4fdb-adae-1e45702115db",
    "created_at": "2023-01-12T15:03:09.351357Z",
    "updated_at": "2025-03-27T02:16:49.054451Z",
    "deleted_at": null,
    "sha1_hash": "2fc5a9e06abd375153a04da4878ee2ad4b0a39f1",
    "title": "2017-08-25 - Operation RAT Cook- Chinese APT actors use fake Game of Thrones leaks as lures",
    "authors": "",
    "file_creation_date": "2022-05-28T02:49:26Z",
    "file_modification_date": "2022-05-28T02:49:26Z",
    "file_size": 2397339,
    "plain_text": "# Operation RAT Cook: Chinese APT actors use fake Game of Thrones leaks as lures\n\n**[proofpoint.com/us/threat-insight/post/operation-rat-cook-chinese-apt-actors-use-fake-game-thrones-leaks-lures](https://www.proofpoint.com/us/threat-insight/post/operation-rat-cook-chinese-apt-actors-use-fake-game-thrones-leaks-lures)**\n\nAugust 25, 2017\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nOperation RAT Cook: Chinese APT actors use fake Game of Thrones leaks as lures\n\nAugust 25, 2017 Darien Huss and Matthew Mesa\n\n\n-----\n\n**O e** **e**\n\n[Proofpoint recently observed a targeted email campaign attempting a spearphishing attack using a Game of Thrones lure. The malicious](https://www.proofpoint.com/us/threat-reference/spear-phishing)\nattachment, which offered salacious spoilers and video clips, attempted to install a “9002” remote access Trojan (RAT) historically used by\nstate-sponsored actors. Previous attacks involving the 9002 RAT include:\n\nOperation Aurora, an attack on companies such as Google, widely attributed to the Chinese government [1,2]\nOperation Ephemeral Hydra, a strategic website compromise utilizing an Internet Explorer zero-day [3], which FireEye attributed to an\n[APT actor without a country attribution](https://www.proofpoint.com/us/threat-reference/advanced-persistent-threat)\nAttacks on Asian countries described by Palo Alto [4]\n\nOnce installed, the 9002 RAT provides attackers with extensive data exfiltration capabilities.\n\n**Email Message**\n\nOn August 10 Proofpoint detected malicious email messages (Figure 1) purporting to contain unreleased Game of Thrones content. The email\nused the subject line \"Wanna see the Game of Thrones in advance?\" These lures are especially relevant since Season 7 of Game of Thrones\npremiered in July and concludes on Sunday, August 27, and the email claims to contain spoilers for the current season. It is worth noting that\nepisodes 4 and 6 were already leaked; it is unlikely that responding to the lure would actually net a recipient new, unreleased episodes,\nparticularly considering that the final episode airs this weekend.\n\n_Figure 1: Email message with the potential spoilers (redacted) containing a .docx attachment_\n\nThe email shown in Figure 1 contains a Microsoft Word attachment named \"game of thrones preview.docx” (Figure 2). Similar to the email, the\ndocument uses a lure listing potential spoilers and claims to contain a preview of the purported spoilers. In reality, the “preview” is an\nembedded .LNK (an OLE packager shell object) that, if run, executes a malicious PowerShell script leading to the installation of the diskless\n“9002” RAT.\n\n\n-----\n\n_Figure 2: .docx document attachment containing a malicious .LNK packager object_\n\n**Payload Analysis**\n\nWhen the embedded .LNK object is executed by the potential victim, it runs a PowerShell command using a modified Invoke-Shellcode [5]\nPowerShell script to download two files obfuscated using XOR and base64. The first downloaded file contains the 9002 RAT shellcode that is\ninjected into a legitimate Windows Mail binary wabmig.exe. (Fig. 3). The other downloaded file is a .LNK file that is used as a means to\nmaintain persistence on the infected machine. The HTTP requests to retrieve the encoded payloads are fairly basic and do not attempt to\nmasquerade as a legitimate browser request (Fig. 4). Interestingly, if the same URI is requested with any type of User-Agent then a legitimate\nJPG is returned (Fig. 5). The persistence .LNK is stored in the Startup directory as UpdateCheck.lnk and contains a PowerShell script that is\nalmost identical to the .LNK downloader. However, instead of downloading the shellcode, it opens, decodes, and injects the already\ndownloaded shellcode into a newly created wabmig.exe process.\n\n\n-----\n\n_Figure 3: Excerpt from PowerShell script found in the LNK package_\n\n_Figure 4: HTTP request to download encoded payload_\n\n_Figure 5: HTTP request with User-Agent receiving legitimate JPG instead of payload_\n\nThis variant of 9002 is capable of communicating over both HTTP and what appears to be fake SSL. The fake SSL component contains at\nleast two hardcoded packets: one for the Client_Hello and another for the Client_Key_Exchange. Most of the hardcoded values, such as the\n_Session ID (Fig. 6,7), stay the same. However, the Random fields are dynamically generated (GMT Unix Time and Random Bytes). Finally, the_\n_Client_Hello attempts to mimic SSL traffic to login.live[.]com by sending that domain in the SNI field (Fig. 8)._\n\n\n-----\n\n_Figure 6: Client_Hello hardcoded Session ID in 9002_\n\n_Figure 7: Client_Hello hardcoded Session ID appearing in network traffic_\n\n_Figure 8: Legitimate login.live[.]com domain in SNI field sent to the C&C_\n\nThe HTTP traffic and encoding that is utilized in this variant of 9002 has several distinguishing characteristics. Data sent to the command and\ncontrol (C&C) in the HTTP POST’s client body is transmitted in an encoded state using a custom algorithm followed by base64-encoding (Fig.\n9).\n\n_Figure 9: HTTP POST request sent to 9002 C&C_\n\nSeveral of the headers are hardcoded including the Accept and User-Agent headers:\n\n_Accept: text/html,application/xhtml+xml,application/xml,*/*_\n_User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)_\n\n\n-----\n\nadd t o, t e e a e t o d e e t a dcoded U s ( g 0)\n\n_/?FORM=Desktop&setmkt=en-us&setlang=en-us_\n_/config/signin_\n\nA dynamically generated URI could also be used in the following format: “/%x.htm?”.\n\n_Figure 10: HTTP Post request sent to 9002 showing another hardcoded URI_\n\nThe encoding algorithm used in this version is an iteration of the “4-byte XOR version of 9002” analyzed by FireEye [3]. Instead of the standard\ndynamic 4-byte XOR operation that is used in the older variant, a dynamic 4-byte XOR key is used along with a static 38-byte seed of\n“\\x3A\\x42\\x46\\x41\\x53\\x41\\x39\\x41\\x46\\x2D\\x44\\x38\\x37\\x32\\x6D\\xF1\\x51\\x4A\\xC0\\x2D\\x3A\\x43\\x31\\x30\\x2D\\x30\\x30\\x43\\x30\\x35\\x4A\\x4D\\x39\\x\nto generate a final 256-byte XOR key. To generate the final key, first the 38-byte seed is used with an iterative addition to generate a 256-byte\nvalue (Fig. 11).\n\n_Figure 11: 256-byte seed initialization using iterative addition and static 38-byte seed value_\n\nNext, the first 4-bytes of the encoded data are XOR’ed with the 256-byte value to generate the final 256-byte XOR key (Fig. 12). This key is\nthen XOR’ed with the rest of the encoded data. (Fig. 13)\n\n_Figure 12: Generation of final 256-byte XOR key_\n\n_Figure 13: XOR’ing data with final 256-byte XOR key_\n\n[Similar to previous versions of 9002, a value resembling a date (“\\x17\\x05\\x15\\x20”) is hardcoded in the malware and can be found at offset](https://www.proofpoint.com/us/threat-reference/malware)\n0x1C in beacons sent to its C&C (Fig. 14).\n\n_Figure 14: Decoded 9002 traffic sent to its C&C showing the hardcoded value_\n\n\n-----\n\ne a ue e y ep ese ts t e date ay, 0 5, but e a e ot a a e t s date as a y s g ca ce add t o a a ue, _0_ _0, s_\nhardcoded in this variant which likely refers to July 2017 (Fig. 15).\n\n_Figure 15: Hardcoded 201707 in 9002 variant_\n\nThis is the most likely explanation, given that the earliest use of the malicious LNK PowerShell downloader (sha256:\n9e49d214e2325597b6d648780cf8980f4cc16811b21f586308e3e9866f40d1cd) we have identified is a compressed file (sha256:\nbdd695363117ba9fb23a7cbcd484d79e7a469c11ab9a6e2ad9a50c678097f100) uploaded to a malicious file scanning service on July 6, 2017.\nThe modified timestamp for the files contained in the ZIP file is July 1, 2017. The ZIP package contains four copies of the same LNK that was\nused in the Game of Thrones attack as well as a legitimate JPG of what appears to be a stock picture of a “party.” We have also identified a\nthird possible campaign utilizing the same LNK in a DOCX document attachment named “need help.docx” (Fig. 16). In this instance, the lure is\nto double-click on a LNK masquerading as a video.\n\n_Figure 16: Malicious document utilizing same LNK as ZIP and Game of Thrones document_\n\n**Similar 2014 Campaigns**\n\nWhile searching for other potentially related campaigns we discovered a nexus of activity occurring at least as far back as April 2014. Several\nZIP compressed files containing a similar LNK downloader (Fig. 17) were uploaded to a malicious file scanning service.\n\n_Figure 17: Malicious LNK PowerShell downloader observed in archives from 2014_\n\nAll five of the archives contained a similar stock picture of a party as well as multiple copies of the malicious LNK with party picture-themed\nnames. The LNK PowerShell downloader uses similar paths to the recent attacks as well as the same “/x/” URI. Instead of using code injection\nhowever, a packed executable (PE) is embedded in the PowerShell script, saved as x.exe, and is used to execute the downloaded payload\nthat is saved as y.exe. An additional similarity is that the LNKs from the 2014 archives share the same Volume Serial Number as the LNK from\nthe recent attacks (0xCC9CE694). The volume serial number is metadata found in the LNK file; since they match, we know it is more likely that\nthey were created on the device or using the same builder. It is possible to fake these values however we do not believe that likely in this case.\n\nUnfortunately we do not know what payload was hosted at mn1[.]org. However, two of the ZIP archives contained a Java payload named\n_PhotoShow.jar that ultimately executes a diskless 9002 variant with a C&C of mx[.]i26[.]org. This variant has a hardcoded identifier of_\n“\\x28\\x02\\x13\\x20” (Fig. 18).\n\n\n-----\n\n_gu e_ _8 900_ _a dcoded de t e_\n\n**Attribution**\n\nBased on several shared identifiers, it is possible that the recent campaigns were conducted by the same actor that conducted the campaigns\nin early- to mid-2014. The malicious LNK files in both campaigns (2014 vs. 2017) have the same Volume Serial Number of 0xCC9CE694.\nFurthermore, the LNK filename used in one of the campaigns this year is almost identical to the campaigns in 2014: Party00[1-35].jpg.lnk\n(2017) vs. Party-00[1-5].jpg.lnk (2014). Finally, the theme of party pictures and stock-JPGs used in both the 2017 and 2014 campaigns are\nextremely similar.\n\nThe 2014 campaign resembles activity previously attributed to the Deputy Dog (aka APT17) actor. Additionally, the Deputy Dog actor has been\nobserved utilizing a similar 9002 RAT with an earlier iteration of the 4-byte XOR encoding algorithm in diskless mode [3]. Another possible\nsimilarity is the use of some of the code from the Java Reverse Metasploit-Stager [6] in the exploits previously analyzed by FireEye [7] as well\nas the PhotoShow.jar payload. Although we do not possess any definitive evidence linking this activity to Deputy Dog, there are enough\nsimilarities to support a possible connection.\n\n**Conclusion**\n\nBased on similarities in code, payload, file names, images, and themes, it is possible that this attack was carried out by a Chinese statesponsored actor known as Deputy Dog. The use of a Game of Thrones lure during the penultimate season of the series follows a common\nthreat actor technique of developing lures that are timely and relevant, and play on the human factor - the natural curiosity and desire to click\nthat leads to so many malware infections. While Proofpoint systems blocked this attack, the use of such lures, combined with sophisticated\ndelivery mechanisms and powerful tools like the latest version of the 9002 RAT can open wide doors into corporate data and systems for the\nactors behind these attacks.\n\n**References**\n\n[1] [https://community.saas.hpe.com/t5/Security-Research/9002-RAT-a-second-building-on-the-left/ba-p/228686#.WaBdzB9ifW8](https://community.saas.hpe.com/t5/Security-Research/9002-RAT-a-second-building-on-the-left/ba-p/228686#.WaBdzB9ifW8)\n\n[2] [http://www.washingtontimes.com/news/2010/mar/24/cyber-attack-on-us-firms-google-traced-to-chinese/](http://www.washingtontimes.com/news/2010/mar/24/cyber-attack-on-us-firms-google-traced-to-chinese/)\n\n[3] https://www.fireeye.com/blog/threat-research/2013/11/operation-ephemeral-hydra-ie-zero-day-linked-to-deputydog-uses-disklessmethod.html\n\n[4] [https://researchcenter.paloaltonetworks.com/2016/07/unit-42-attack-delivers-9002-trojan-through-google-drive/](https://researchcenter.paloaltonetworks.com/2016/07/unit-42-attack-delivers-9002-trojan-through-google-drive/)\n\n[5] [https://github.com/EmpireProject/Empire/blob/master/data/module_source/code_execution/Invoke-Shellcode.ps1](https://github.com/EmpireProject/Empire/blob/master/data/module_source/code_execution/Invoke-Shellcode.ps1)\n\n[6] [http://security-is-just-an-illusion.blogspot.nl/2013/02/45-x-antivirus-software-fail-again-java.html](http://security-is-just-an-illusion.blogspot.nl/2013/02/45-x-antivirus-software-fail-again-java.html)\n\n[7] [https://www.fireeye.com/blog/threat-research/2013/05/ready-for-summer-the-sunshop-campaign.html](https://www.fireeye.com/blog/threat-research/2013/05/ready-for-summer-the-sunshop-campaign.html)\n\n**Indicators of Compromise (IOCs)**\n\n**IOC** **IOC Type** **Description**\n\nhttp://27.255.83[.]3/x/ URL 9002 Shellcode\n\nhttp://27.255.83[.]3/y/ URL Persistence LNK\n\n27.255.83[.]3 IP 9002 C2\n\n9e49d214e2325597b6d648780cf8980f4cc16811b21f586308e3e9866f40d1cd SHA256 LNK Object\n\n5a678529aea9195b787be8c788ef4bb03e38e425ad6d0c9fafd44ed03aa46b65 SHA256 %APPDATA%\\y.jpg encoded 9002 shellcode\n\nefdb6351ac3902b18535fcd30432e98ffa2d8bc4224bdb3aba7f8ca0f44cec79 SHA256 game of thrones preview.docx\n\nbdd695363117ba9fb23a7cbcd484d79e7a469c11ab9a6e2ad9a50c678097f100 SHA256 Party_photos_201612.zip\n\n192e8925589fa9a7f64cba04817c180e6f26ad080bf0f966a63a3280766b066a SHA256 need help.docx\n\n**2014 IOCs**\n\n\n-----\n\n774acdc37157e7560eca4a167558780e1cc2f5dfd203cbcb795ec05373d46fe0 SHA256 Party-001.jpg.lnk\n\n56dda2ed3cd67cadc53f4b9e493c4601e45c5112772ade5b0c36b61858ab7852 SHA256 Photos20140214.zip\n\n83151fe6980a39eeda961c6a8f0baba13b6da853661ccbf5c7d9a97ec73d1b70 SHA256 Party-pics-201304.zip\n\nb54d547e33b0ea6ba161ac4ce06a50076f1e55a3bc592a0fb56bbc34dc96fd43 SHA256 Party_Photos_Packed.zip\n\ndb6b67704b77d271e40e0259a68ce2224504081545619d33b4909e6e6a385ec6 SHA256 Photos20140215.zip\n\nfb8eff8dcf41a4cfd0b5775327a607b76269b725f1b46dc5dd04b1f5e2433ee7 SHA256 PartyPics.7z\n\n559c0f2948d1d3179420eecd78b1e7c36c4960ec5d110c63bf6c853d30f1b308 SHA256 PhotoShow.jar\n\n0b7613e0f739eb63fd5ed9e99934d54a38e56c558ab8d1a4f586a7c88d37a428 SHA256 Upins_tmp.exe (dropped by PhotoShow.jar)\n\nmn1[.]org Domain Party-001.jpg.lnk C&C\n\nmx.i26[.]org Domain PhotoShow.jar C&C\n\n**ET and ETPRO Suricata/Snort Signatures**\n\n2827624 ETPRO TROJAN Possible APT.9002 Fileless Variant CnC Beacon 1\n\n2827625 ETPRO TROJAN Possible APT.9002 Fileless Variant CnC Beacon 2\n\n2827661 ETPRO TROJAN Possible APT.9002 Fake SSL CnC Beacon\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-08-25 - Operation RAT Cook- Chinese APT actors use fake Game of Thrones leaks as lures.pdf"
    ],
    "report_names": [
        "2017-08-25 - Operation RAT Cook- Chinese APT actors use fake Game of Thrones leaks as lures.pdf"
    ],
    "threat_actors": [
        {
            "id": "2150d1ac-edf0-46d4-a78a-a8899e45b2b5",
            "created_at": "2022-10-25T15:50:23.269339Z",
            "updated_at": "2025-03-27T02:00:55.416524Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "APT17",
                "Deputy Dog"
            ],
            "source_name": "MITRE:APT17",
            "tools": [
                "BLACKCOFFEE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1edcac0b-efd9-47b1-9aca-33827d5bd085",
            "created_at": "2024-05-01T02:03:07.964773Z",
            "updated_at": "2025-03-27T02:05:17.273595Z",
            "deleted_at": null,
            "main_name": "BRONZE KEYSTONE",
            "aliases": [
                "Aurora Panda ",
                "DeputyDog ",
                "Group 72 ",
                "Hidden Lynx ",
                "Shell Crew",
                "TG-8153 ",
                "Tailgater Team",
                "APT17 "
            ],
            "source_name": "Secureworks:BRONZE KEYSTONE",
            "tools": [
                " BlackCoffee",
                " DeputyDog",
                " Derusbi",
                " Gh0stHTTPSDropper",
                " HiKit",
                " InternalCMD",
                " PlugX",
                " PoisonIvy",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "86fd71d3-06dc-4b73-b038-cedea7b83bac",
            "created_at": "2022-10-25T16:07:23.330793Z",
            "updated_at": "2025-03-27T02:02:09.740703Z",
            "deleted_at": null,
            "main_name": "APT 17",
            "aliases": [
                "APT 17",
                "ATK 2",
                "Beijing Group",
                "Bronze Keystone",
                "Deputy Dog",
                "Elderwood",
                "Elderwood Gang",
                "Operation Aurora",
                "Operation DeputyDog",
                "Operation Ephemeral Hydra",
                "Operation RAT Cook",
                "SIG22",
                "Sneaky Panda",
                "TEMP.Avengers",
                "TG-8153",
                "Tailgater Team"
            ],
            "source_name": "ETDA:APT 17",
            "tools": [
                "9002 RAT",
                "AGENT.ABQMR",
                "AGENT.AQUP.DROPPER",
                "AGENT.BMZA",
                "AGENT.GUNZ",
                "Agent.dhwf",
                "AngryRebel",
                "BlackCoffee",
                "Briba",
                "Chymine",
                "Comfoo",
                "Comfoo RAT",
                "Darkmoon",
                "DeputyDog",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Fexel",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Gresim",
                "HOMEUNIX",
                "HiKit",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Jumpall",
                "Kaba",
                "Korplug",
                "Linfo",
                "MCRAT.A",
                "McRAT",
                "MdmBot",
                "Mdmbot.E",
                "Moudour",
                "Mydoor",
                "Naid",
                "Nerex",
                "PCRat",
                "PNGRAT",
                "Pasam",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trojan.Naid",
                "Vasport",
                "Wiarp",
                "Xamtrav",
                "Zox",
                "ZoxPNG",
                "ZoxRPC",
                "gresim",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535789,
    "ts_updated_at": 1743041809,
    "ts_creation_date": 1653706166,
    "ts_modification_date": 1653706166,
    "files": {
        "pdf": "https://archive.orkl.eu/2fc5a9e06abd375153a04da4878ee2ad4b0a39f1.pdf",
        "text": "https://archive.orkl.eu/2fc5a9e06abd375153a04da4878ee2ad4b0a39f1.txt",
        "img": "https://archive.orkl.eu/2fc5a9e06abd375153a04da4878ee2ad4b0a39f1.jpg"
    }
}