{
    "id": "e7367005-68a9-49e6-b622-bc72051fb736",
    "created_at": "2022-10-25T16:48:17.028348Z",
    "updated_at": "2025-03-27T02:17:11.665617Z",
    "deleted_at": null,
    "sha1_hash": "2cd04b3b878180782e8467c2cbe69d301a0d98ec",
    "title": "En Route with Sednit Part 3: A Mysterious Downloader",
    "authors": "ESET",
    "file_creation_date": "2016-10-14T15:12:00Z",
    "file_modification_date": "2016-10-14T15:12:05Z",
    "file_size": 1526325,
    "plain_text": "## En Route with\n\n#### Part 3: A Mysterious Downloader\n\n###### Version 1.0 • October 2016\n\n\n-----\n\n# En Route with Sednit\n\n#### Part 3: A Mysterious Downloader\n\n###### Version 1.0 • October 2016\n\n\n-----\n\n##### Table of Content\n\n**Executive Summary** **5**\n\n**Introduction** **6**\n\nThe Sednit Group 6\n\nThe Third Part of the Trilogy 7\n\nAttribution 8\n\nPublication Strategy 8\n\n**Downdelph** **9**\n\nIdentikit 9\n\nTimeline 10\n\nDeployment 11\n\nCore Behavior 12\n\nPersistence Mechanisms 15\n\n**Conclusion and Open Questions** **24**\n\n**Indicators of Compromise** **25**\n\nDowndelph 25\n\n**References** **26**\n\n\n-----\n\n##### List of Tables\n\nTable 1. Downdelph main configuration file extended.ini 14\n\nTable 2. Downdelph server configuration file pinlt.ini 15\n\n##### List of Figures\n\nFigure 1. Timeline of 0-day vulnerabilities exploited by the Sednit group in 2015. 6\n\nFigure 2. Main attack methods and malware used by the Sednit group since 2014,\nand how they are related 7\n\nFigure 3. Downdelph major events 10\n\nFigure 4. Downdelph deployments, with the purpose and name of each file 11\n\nFigure 5. Decoy document used in Case 7 (September 2015) 12\n\nFigure 6. Downdelph communication workflow 13\n\nFigure 7. Downdelph request to download main configuration file 14\n\nFigure 8. Beginning of infected hard drive layout 16\n\nFigure 9. MBR opening code, as seen in a decompiler 17\n\nFigure 10. Startup process of a Windows 7 machine infected by the bootkit 18\n\nFigure 11. Hook code in ACPI.sys resources section (.rsrc) 19\n\nFigure 12. User mode bootkit component attempts to set an exported Boolean variable\nin Downdelph, after having loaded it 20\n\nFigure 13. Hook code for ZwSetInformationFile to hide files 22\n\nFigure 14. Preoperation callback for IRP_MJ_CREATE\n(the creation or opening of files and directories) 23\n\nFigure 15. Kernel mode APC registration, FN_ApcNormalRoutine being the shellcode\naddress in the target process 23\n\n\n-----\n\n### En Route with Sednit\n\n\n##### Executive Summary\n\nThe Sednit group — also known as APT28, Fancy Bear and Sofacy — is a group of attackers\noperating since 2004 if not earlier and whose main objective is to steal confidential information\nfrom specific targets.\n\nThis is the third part of our whitepaper “En Route with Sednit”, which covers the Sednit group\nactivities since 2014. Here, we describe a special downloader named Downdelph.\n\nThe key points described in this third installment are the following:\n\n- Downdelph was used only seven times over the past two years, according to our telemetry\n\ndata: we believe this to be a deliberate strategy formulated in order to avoid attracting\nattention\n\n- Downdelph has been deployed on a few occasions with a never-previously-documented\n\nWindows bootkit, which shares some code with the infamous BlackEnergy malware\n\n- Downdelph has been deployed on a few occasions with a previously undocumented\n\nWindows rootkit\n\n[For any inquiries related to this whitepaper, contact us at: threatintel@eset.com](mailto:threatintel@eset.com)\n\n\n-----\n\n### En Route with Sednit\n\n\n##### Introduction\n\n_Readers who have already read the first parts of our Sednit trilogy might want to skip the following section_\n_and go directly to the specific introduction of this third part._\n\n###### The Sednit Group\n\nThe Sednit group — variously also known as APT28, Fancy Bear, Sofacy, Pawn Storm, STRONTIUM\nand Tsar Team — is a group of attackers operating since 2004 if not earlier, whose main objective\nis to steal confidential information from specific targets. Over the past two years, this group’s activity\nhas increased significantly, with numerous attacks against government departments and embassies\nall over the world.\n\nAmong their most notable presumed targets are the American Democratic National Committee [1],\nthe German parliament [2] and the French television network TV5Monde [3]. Moreover, the Sednit\ngroup has a special interest in Eastern Europe, where it regularly targets individuals and organizations\ninvolved in geopolitics.\n\nOne of the striking characteristics of the Sednit group is its ability to come up with brand-new 0-day [4]\nvulnerabilities regularly. In 2015, the group exploited no fewer than six 0-day vulnerabilities, as shown\nin Figure 1.\n\n\n**CVE-2015-3043**\nFlash\n\n**CVE-2015-1701**\nWindows LPE\n\n\n**CVE-2015-2590**\nJava\n\n**CVE-2015-4902**\nJava click-to-play bypass\n\n\n**CVE-2015-7645**\nFlash\n\n\n**APR** **MAY** **JUN** **JUL** **AUG** **SEP** **OCT**\n\n**CVE-2015-2424**\nOffice RCE\n\nFigure 1. Timeline of 0-day vulnerabilities exploited by the Sednit group in 2015.\n\nThis high number of 0-day exploits suggests significant resources available to the Sednit group,\neither because the group members have the skills and time to find and weaponize these vulnerabilities,\nor because they have the budget to purchase the exploits.\n\nAlso, over the years the Sednit group has developed a large software ecosystem to perform its espionage\nactivities. The diversity of this ecosystem is quite remarkable; it includes dozens of custom programs,\nwith many of them being technically advanced, like the Xagent and Sedreco modular backdoors\n(described in the second part of this whitepaper), or the Downdelph bootkit and rootkit (described\nin the third part of this whitepaper).\n\nWe present the results of ESET’s two-year pursuit of the Sednit group, during which we uncovered\nand analyzed many of their operations. We split our publication into three independent parts:\n\n1. _“Part 1: Approaching the Target” describes the kinds of targets the Sednit group is after, and the_\nmethods used to attack them. It also contains a detailed analysis of the group’s most-used\nreconnaissance malware.\n\n2. _“Part 2: Observing the Comings and Goings” describes the espionage toolkit deployed on some_\n\ntarget computers, plus a custom network tool used to pivot within the compromised\norganizations.\n\n\n-----\n\n### En Route with Sednit\n\n\n3. _“Part 3: A Mysterious Downloader” describes a surprising operation run by the Sednit group,_\n\nduring which a lightweight Delphi downloader was deployed with advanced persistence\nmethods, including both a bootkit and a rootkit.\n\nEach of these parts comes with the related indicators of compromise.\n\n###### The Third Part of the Trilogy\n\nFigure 2 shows the main components that the Sednit group has used over the last two years,\nwith their interrelationships. It should not be considered as a complete representation of their arsenal,\nwhich also includes numerous small, custom tools.\n\n**ATTACK** **FIRST-STAGE** **SECOND-STAGE** **PIVOT**\n**METHODS** **MALWARE** **MALWARE** **MALWARE**\n\n**Seduploader** **Seduploader** **Sedreco** **Sedreco**\n\n**Xtunnel**\n\ndropper payload dropper payload\n\nSedkit\n\n**Usbstealer**\n\nEmail\nattachments\n\n**Downdelph** **Xagent**\n\nFake webmail\nlogin panels\n\nEn Route En Route En Route\nwith Sednit with Sednit with Sednit\n**Part 1** **Part 3** **Part 2**\n\nFigure 2. Main attack methods and malware used by the Sednit group since 2014,\nand how they are related\n\nWe divide Sednit’s software into three categories: the first-stage software serves for reconnaissance\nof a newly compromised host, then comes the second-stage software intended to spy on machines\ndeemed interesting, while the pivot software finally allows the operators to reach other computers.\n\nIn this third part, we describe the first-stage software named Downdelph, outlined in Figure 2.\nThis software was deployed only seven times by the Sednit operators, according to our telemetry\ndata. Interestingly, some of these deployments were made with advanced persistence methods:\na Windows bootkit and a Windows rootkit.\n\nAll the components shown in Figure 2 are described in this whitepaper,\nwith the exception of Usbstealer, a tool to exfiltrate data from air-gapped\nmachines that we have already described at WeLiveSecurity [5]. Recent\nversions have been documented by Kaspersky Labs [6] as well.\n\n_Readers who have already read the first parts of our Sednit trilogy may skip the following sections_\n_and go directly to Downdelph’s analysis._\n\n|Col1|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n||||||\n||||||\n||||||\n||||||\n||||||\n\n|Seduploader Seduploader Sedreco Sedreco Xtunnel dropper payload dropper payload Sedkit Usbstealer Email attachments Downdelph Xagent Fake webmail login panels En Route En Route En Route with Sednit with Sednit with Sednit Part 1 Part 3 Part 2|Col2|\n|---|---|\n|||\n|||\n\n\n**SECOND-STAGE**\n**MALWARE**\n\n**Sedreco** **Sedreco**\ndropper payload\n\n**Xagent**\n\nEn Route\nwith Sednit\n**Part 2**\n\n\n**ATTACK**\n**METHODS**\n\nSedkit\n\nEmail\nattachments\n\nFake webmail\nlogin panels\n\n\n-----\n\n### En Route with Sednit\n\n\n###### Attribution\n\nOne might expect this reference whitepaper to add new information about attribution. A lot has\nbeen said to link the Sednit group to some Russian entities [7], and we do not intend to add anything\nto this discussion.\n\nPerforming attribution in a serious, scientific manner is a hard problem that is out of scope\nof ESET’s mission. As security researchers, what we call “the Sednit group” is merely a set of software\nand the related network infrastructure, which we can hardly correlate with any specific organization.\n\nNevertheless, our intensive investigation of the Sednit group has allowed us to collect numerous\nindicators of the language spoken by its developers and operators, as well as their areas of interest,\nas we will explain in this whitepaper.\n\n###### Publication Strategy\n\nBefore entering the core content of this whitepaper, we would like to discuss our publication\nstrategy. Indeed, as security researchers, two questions we always find difficult to answer when\nwe write about an espionage group are “when to publish?”, and “how to make our publication useful\n_to those tasked with defending against such attacks?”._\n\nThere were several detailed reports on the Sednit group published in 2014, like the Operation Pawn\nStorm report from Trend Micro [8] and the APT28 report from FireEye [9]. But since then the public\ninformation regarding this group has mainly came in the form of blog posts describing specific\ncomponents or attacks. In other words, no public attempts have been made to present\nthe big picture on the Sednit group since 2014.\n\nMeanwhile, the Sednit group’s activity has significantly increased, and its arsenal differs\nfrom those described in previous whitepapers.\n\nTherefore, our intention here is to provide a detailed picture of the Sednit group’s activities\nover the past two years. Of course, we have only partial visibility into those activities, but we believe\nthat we possess enough information to draw a representative picture, which should in particular\nhelp defenders to handle Sednit compromises.\n\nWe tried to follow a few principles in order to make our whitepaper useful to the various types\nof readers:\n\n- Keep it readable: while we provide detailed technical descriptions, we have tried to make\nthem readable, without sacrificing precision. For this reason we decided to split our whitepaper\ninto three independent parts, in order to make such a large amount of information easily\ndigestible. We also have refrained from mixing indicators of compromise with the text.\n\n- Help the defenders: we provide indicators of compromise (IOC) to help detect current Sednit\n\ninfections, and we group them in the IOC section and on ESET’s GitHub account [10]. Hence,\nthe reader interested only in these IOCs can go straight to them, and find more context\nin the whitepaper afterwards.\n\n- Reference previous work: a high profile group such as Sednit is tracked by numerous\n\nentities. As with any research work, our investigation stands on the shoulders of the previous\npublications. We have referenced them appropriately, to the best of our knowledge.\n\n- Document also what we do not understand: we still have numerous open questions\n\nregarding Sednit, and we highlight them in our text. We hope this will encourage fellow\nmalware researchers to help complete the puzzle.\n\nWe did our best to follow these principles, but there may be cases where we missed our aim.\n[We encourage readers to provide feedback at threatintel@eset.com, and we will update](mailto:threatintel@eset.com)\nthe whitepaper accordingly.\n\n\n-----\n\n### En Route with Sednit\n\n\n##### Downdelph\n\n\n-----\n\n### En Route with Sednit\n\n\n###### Timeline\n\nThe dates presented in this timeline refer to when we believe Downdelph was deployed with\na specific persistence method, possibly against several different targets, and are based on ESET’s\nLiveGrid® [12] telemetry data.\n\n\n##### 2013\n**November**\n\n\n##### 2014\n**February**\n\nThree Downdelph\ndeployments. Persistence is ensured by a\n\nkernel mode rootkitkernel mode rootkit\n\ninstalled as a Windows\nservice (Cases 2, 3 and 4).\n\n##### 2015\n**September**\n\nMost recently observed\nDowndelph deployment. Persistence is\nensured by registering\nan auto-start entry in\nthe Windows Registry\n(Case 7).\n\n\n##### 2014\n**March**\n\nDowndelph deployment. Persistence is\nensured by a bootkitbootkit\ninfecting the MBR\nof the hard drive (Case 5).\n\n##### 2014\n**May**\n\nDowndelph deployment. Persistence is\nensured by registering\nan auto-start entry in\nthe Windows Registry\n(Case 6).\n\n\nFigure 3. **Downdelph major events**\n\nAs shown in the timeline, Downdelph operators abandoned more complex\npersistence methods over time, probably due to new security features introduced in Windows.\n\n\n-----\n\n### En Route with Sednit\n\n\n###### Deployment\n\nAs mentioned in the timeline, we were able to find only seven deployments of Downdelph.\nSuch deployments start with a dropper, which contains Downdelph and some additional binaries,\nas depicted in Figure 4.\n\n**Bootkit-based**\n**persistence**\n\nHelper Helper\n(kb0004542.exe) (inst32.exe)\n\n**Case 5**\n\n\n**Case 1**\n\n**Dropper**\n(unknown name)\n\n**Rootkit-based**\n**persistence**\n\n**Case 2**\n\n**Dropper**\n(WinXP1.exe)\n\n**Case 4**\n\n**Dropper**\n(serviceinstall.exe)\n\nUAC bypass\n\n**Registry-based**\n**persistence**\n\n**Case 6**\n\n**Dropper**\n(fs6na.exe)\n\nUAC bypass\n\n\n**Dropper**\n(syscfg.exe)\n\nUAC bypass\n\n**Case 3**\n\n**Dropper**\n(serviceinstallx32.exe)\n\nUAC bypass\n\n**Case 7**\n\n**Dropper**\n(EU_Eastern_\nEurope_agenda_\nBA_3_Nov_2015.pif)\n\n\nFiles shown in\nthe same color\nserve the same\npurpose\n\n\nFigure 4. **Downdelph deployments, with the purpose and name of each file**\n\n\n-----\n\n### En Route with Sednit\n\n\nIn Cases 3 to 6, the deployed binaries used a User Account Control (UAC) bypass technique, as mentioned\nin Figure 4. Two different UAC bypass techniques were employed; the first one relying on a custom\n“RedirectEXE” shim database [13], while the second one is based on a DLL load order hijacking of the\nWindows executable sysprep.exe, which possesses the property to auto-elevate its privileges [14].\n\nIn Case 7, the dropper was deployed through a targeted phishing email. We do not have any evidence\nof this deployment method for the other cases. In this particular case, the dropper opens a decoy\ndocument when executed, to reinforce the illusion the email was legitimate. Figure 5 shows this\ndecoy document, an invitation to a conference organized by the Slovak Foreign Policy Association\nin November 2015 regarding Russia-Ukraine relations [15].\n\nFigure 5. Decoy document used in Case 7 (September 2015)\n\n###### Core Behavior\n\nDowndelph’s core logic is implemented in one Delphi class, named TMyDownloader by its developers,\nand remained the same in all samples we analyzed. Roughly summarized, Downdelph first downloads\na main configuration file, which allows extending the list of C&C servers, and then fetches a payload\nfrom each of these C&C servers.\n\n\n-----\n\n### En Route with Sednit\n\n\nThe whole process is pictured in Figure 6, and is detailed thereafter for the most recent Downdelph\nsample known (Case 7 in Figure 4).\n\nDowndelph Initial C&C server Additional Additional\ninfected computer C&C server 1 C&C server 2\n\nFetches main\nconfiguration file\n(extended.ini)\n\nDownload payload from\ninitial C&C server\n\nSends machine ID\n\nFetches server\nconfiguration file\n(pinlt.ini)\n\nDownloads payload\n\nDownload payload from\nadditional C&C server 1\n\nSends machine ID\n\nFetches server\nconfiguration file\n(pinlt.ini)\n\nDownloads payload\n\nDownload payload from\nadditional C&C server 2\n\nSends machine ID\n\nFetches server\nconfiguration file\n(pinlt.ini)\n\nDownloads payload\n\n**[...]**\n\nFigure 6. **Downdelph communication workflow**\n\n|Col1|Fetches main configuration file (extended.ini) Download payload from initial C&C server Sends machine ID Fetches server configuration file (pinlt.ini) Downloads payload Download payload from additional C&C server 1 Sends machine ID Fetches server configuration file (pinlt.ini) Downloads payload Download payload from additional C&C server 2 Sends machine ID Fetches server configuration file (pinlt.ini) Downloads payload [...]|Col3|Col4|Col5|\n|---|---|---|---|---|\n||||||\n||||||\n||||||\n||||||\n||||||\n||||||\n||||||\n||||||\n||||||\n||||||\n||||||\n||||||\n\n\n-----\n\n### En Route with Sednit\n\n\n###### Extend C&C servers List\n\nFirst, Downdelph downloads a main configuration file named extended.ini from the initial\nC&C server, whose address is hardcoded in the binary. The network request is an HTTP POST with\na URI containing the file name to fetch encoded with a custom algorithm, as pictured in Figure 7.\n\nFigure 7. **Downdelph request to download main configuration file**\n\nThe encoding algorithm was designed to make writing signatures on Downdelph network requests difficult. To do so, pseudo-randomly generated\ncharacters are inserted between each original character during the encoding,\nsuch that the same input text will be encoded differently each time.\n\nThe response from the server is an RC4-encrypted configuration file following the INI format [16],\nand composed of a single section named [options], which contains the key-value pairs described\nin Table 1.\n\n\nTable 1. **Downdelph main configuration file extended.ini**\n\n\nKey Value\n\n`Servers` Comma-separated list of additional C&C server addresses (can be NULL)\n\nDefines whether server configuration files — described below — will\n```\n Crypt\n```\nbe RC4-encrypted or not\n\n`Sleep` Time to wait before contacting C&C servers again\n\n`Key` Cryptographic key to replace the default key (can be NULL)\n\nIf the Servers key is not empty, Downdelph adds the C&C server addresses to its list of servers\nto contact to download payloads.\n\nThe RC4 algorithm uses by default a 50-byte hardcoded value, to which\nthe last two bytes of the input text are appended to form the key, before\ndecrypting. This 50-byte value is present in other Sednit components,\nsuch as Seduploader and Xagent.\n\n\n-----\n\n### En Route with Sednit\n\n\n###### Payload Download\n\nFor each known C&C server — the initial one and the additional ones possibly provided\nin extended.ini — Downdelph performs three steps leading to the download of a payload.\n\nFirst, it sends a machine ID, which was previously generated from the hard drive serial number.\n\nSecond, it downloads a configuration file named pinlt.ini describing the payload to fetch\nfrom this particular C&C server (if any). The network request follows a format similar to the one\nshown in Figure 7. The possible key-value pairs of the received file are described in Table 2.\n\n\nTable 2. **Downdelph server configuration file pinlt.ini**\n\n\nKey Value\n\nTime to wait before contacting C&C servers again (if present, overrides\n```\n Sleep\n```\nvalue provided in extended.ini)\n\n`Crypt` Defines whether or not the payload will be RC4-encrypted\n\nCryptographic key to replace the default key (if present, overrides value provided\n```\n Key\n```\nin extended.ini)\n\n`FileName` Name of the payload to fetch\n\nLocation in which to save the payload on the local machine, or alternatively\n```\n PathToSave\n              shell to indicate the payload is a shellcode to execute in memory\n\n```\n`Execute` Defines whether the payload will be executed, or simply dropped on the machine\n\n`RunApp` Command line to run the payload (for example rundll32.exe for a DLL payload)\n\n`Parameters` Parameters to pass to the payload\n\nDefines whether or not the payload will be deleted from the local machine\n```\n Delete\n```\nafter being executed\n\n`DelSec` Time to wait before trying to delete the file\n\nFinally, if the previous configuration file is non-empty, Downdelph downloads a payload from\nthis C&C server, and processes it according to the configuration.\n\nOnce all C&C servers have been contacted, Downdelph sleeps for a certain amount of time (defined\nby the Sleep key in its configuration), and then re-starts the whole workflow from the beginning,\nincluding downloading the main configuration file from the initial C&C server.\n\nWe do not have in-the-wild examples of Downdelph configuration files. Nevertheless, we know\nthat in a few cases this component eventually downloaded Sedreco and Xagent.\n\n###### Persistence Mechanisms\n\nIn most of the deployments we analyzed, Downdelph was dropped with a companion binary taking\ncharge of its persistence, as pictured in Figure 4. This section describes the two most interesting\npersistence methods employed, respectively with a bootkit and a rootkit, leaving aside the classic\nand more common Windows Registry modification methods.\n\n\n-----\n\n### En Route with Sednit\n\n\n###### Bootkit\n\nInterestingly, we observed Downdelph deployment with a bootkit on two occasions, Cases 1 and 5\nin Figure 4. As defined in ESET’s VirusRadar® [17], a bootkit is “A type of rootkit that infects the Master\n_Boot Record or Volume Boot Record (VBR) on a hard disk drive in order to ensure that its code will be run_\n_each time the computer boots. […​]”._\n\nIn recent years, bootkits have become popular as a way to load unsigned malicious Windows drivers,\nwhich is normally prevented by the OS in 64-bit versions of Windows. But in the present case the bootkit\nserves as a stealthy persistence method for the user-mode downloader Downdelph — although\nfor this purpose an unsigned driver will indeed be loaded, as we will describe later. Persistence through\na bootkit makes detection harder, as its code is executed before the operating system is fully loaded.\n\nThe bootkit in question has the ability to infect Microsoft Windows versions from Windows XP\nto Windows 7, on both 32-bit and 64-bit architectures. To the best of our knowledge the bootkit used\nby Downdelph has never been documented, even though it belongs to the well-known category\nof bootkits infecting the Master Boot Record (MBR) — first sector of the hard drive — to take control\nof the startup process.\n\nWe will now describe the various components installed on the machine during the infection\nby the bootkit, and then how those components cooperate during startup to eventually\nexecute Downdelph.\n\nInstallation Process\n\nThe bootkit installation process varies depending on the Windows version, and whether\nthe machine is 32-bit or 64-bit. In all cases the bootkit installer starts by overwriting the hard\ndrive’s first sectors — a sector being the basic hard drive storage unit, resulting in a new hard drive\nlayout as shown in Figure 8 and described in the following.\n\n\n**Sector 1**\n\n\n**Sector 2**\n\n\n**Sector 3**\n\n\nBootkit MBR\n\n\nOriginal MBR\n(XOR-encrypted)\n\n\nBootkit Code\n(XOR-encrypted)\n\n\nBootkit Driver\n(XOR-encrypted,\nRC4-encrypted)\n\n\nLegitimate\ndata\n\n\nFigure 8. Beginning of infected hard drive layout\n\nFirst things first: the MBR is overwritten with a custom version, while an encrypted copy\nof the original MBR code is stored in the second sector. Starting in the third sector comes the core\nbootkit code, encrypted with a simple XOR-based algorithm. This core code will be slightly different\ndepending on the operating system versions, as the hooks — described later — put in place at startup\nwill vary. Finally comes an RC4-encrypted Windows driver, which depending on the architecture will\nbe a 32-bit or 64-bit binary.\n\n\n-----\n\n### En Route with Sednit\n\n\nIn order to access the first sectors of the hard drive, the installer employs a technique previously\nseen in the infamous TDL4 bootkit [18], whose code is shown in Figure 9.\n\nFigure 9. MBR opening code, as seen in a decompiler\n\nOnce this device access is established, the installer simply calls the Windows API function WriteFile\nto overwrite the hard drive’s first sectors. It should be noted that this method requires administrative\nrights on the system.\n\nSecond, the installer stores a DLL in the newly created Windows Registry key HKLM\\SYSTEM\\\n```\nCurrentControlSet\\Control\\Lsa\\Core Packages. As we will explain later, this binary \n\n```\nis the user mode component of the bootkit. Additionally, Downdelph itself is stored in the same\nregistry path, but in the key named Impersonation Packages.\n\nThese two files are stored in Windows’ Registry following a custom-encrypted data format that\nis also used for the bootkit code initially contained in the installer. More precisely, the data are\naPLib-compressed [19], then RC4-encrypted, and begin with the following header:\n```\n   struct PackedChunkHeader\n   {\n           DWORD magic; // set to `0x203a3320` (` :3 ` in ASCII)\n           DWORD packed_size;\n           DWORD unpacked_size;\n           DWORD key_size;\n           BYTE rc4_key[16];\n   };\n\n```\nThe magic 4-byte value “ :3 “ is also written by the bootkit installer at offset\n```\n          0x19B of the MBR, as a marker to indicate that the hard drive has already\n\n```\nbeen infected in the event that the installer is re-executed.\n\n\n-----\n\n### En Route with Sednit\n\n\n###### Startup Process\n\nOnce installed, the bootkit takes control of the machine during the next system startup. The startup\nprocess is detailed in Figure 10 for Windows 7, where only the steps involving the bootkit are shown.\n\n\n**Bootkit MBR**\n\n\n**Original MBR**\n\n\n**CPU in real mode**\n\n**CPU in**\n**protected**\n**mode**\n\n\nLoads Downdelph in\n```\n    explorer.exe process\n\n```\nFigure 10. Startup process of a Windows 7 machine infected by the bootkit\n\nRoughly summarized, a bootkit’s objective is to “survive” Windows’ startup and eventually to execute\na payload once the operating system is fully running. Such survival is made difficult by the strong\nmodifications of the machine state at each step of the startup process (for example by reorganizing\nmemory or switching the CPU mode). Hence, starting from the initially infected MBR, the bootkit\nensures at each step that it will regain control at the next step, mainly by setting hooks.\n\nWhile the bootkit workflow described in Figure 10 bears some similarities with other known MBRinfected bootkits (see “Bootkits: Past, Present & Future” [20] for some examples), there are certain\nparticularities that we would like to point out:\n\n- The bootkit MBR decrypts the bootkit code and the bootkit driver initially stored from\n\nthe third sector (see Figure 8) into a memory buffer. On the system we used for analysis,\nthe buffer was located at physical memory address 0x97C00. This memory area therefore\ncontains the bulk of the bootkit code, and the hooks in bootmgr, winload.exe and ACPI.\n```\n sys re-route the execution flow to this buffer. It is more common for bootkits to copy \n\n```\ntheir code at each step into a new memory area, in order to survive memory re-organization\nduring startup.\n\n\n-----\n\n### En Route with Sednit\n\n\n\n- This is the first use of the genuine Windows driver ACPI.sys in a bootkit, to the best\nof our knowledge. More precisely, the entry-point of this driver is patched to redirect\nto a small snippet of code written in its resources section, as shown in Figure 11.\n\nFigure 11. Hook code in ACPI.sys resources section (.rsrc)\n\nThis code receives as an input parameter the memory address of the Windows kernel ntoskrnl.\n```\n exe, where the bootkit stores some crucial data in unused PE header fields. Using these data, \n\n```\nit first restores the first five bytes of the original ACPI.sys entry-point, and then redirects to bootkit\ncode stored at physical memory address 0x97C00, mapped in the virtual memory space using the\nWindows API MmMapIoSpace _[21]. This bootkit code will decrypt and execute the bootkit driver._\n\nThe modifications to the ACPI.sys driver bypass Windows’ bootloader\nintegrity checks, because those checks are done on the hard-drive version\nof the file, not on the in-memory version.\n\n\n-----\n\n### En Route with Sednit\n\n\n\n- The bootkit driver injects the bootkit user-mode component into the explorer.exe\nprocess by patching its entry-point before it is executed. The user mode component then\nloads Downdelph and, interestingly, it tries to set an exported global Boolean variable named\n```\n m_bLoadedByBootkit in Downdelph to TRUE, as shown in Figure 12.\n\n```\nFigure 12. User mode bootkit component attempts to set an exported Boolean variable\nin Downdelph, after having loaded it\n\nAs this global variable is absent in all Downdelph binaries, we speculate that the bootkit was\noriginally intended to be used with a different payload, and was repurposed by Sednit’s operators.\n\nMoreover, the user-mode component of the bootkit exports two functions named Entry and ep_data.\nThose two export names are also present in early samples of the infamous BlackEnergy malware [11].\nAlso, we found several cases of code sharing between the bootkit components and the same\nBlackEnergy samples. These hints lead us to speculate that the developers may be related.\n\n###### Kernel Mode Rootkit\n\nAnother interesting Downdelph persistence method we analyzed relies on a Windows driver,\nused during deployments in February 2014. Once loaded at startup as a Windows service, this driver\nexecutes and hides Downdelph, effectively acting as a rootkit [22]. We were able to dig up only four\nsamples of this rootkit: three 32-bit versions, corresponding to Cases 2, 3 and 4 in Figure 3,\nand an additional 64-bit version for which we do not have any context.\n\nRoughly summarized, the rootkit hides certain operating system artifacts (files, registry keys, folders)\nwhose location matches a rule in a set of so-called Hide rules. Those rules are set by the dropper\nand stored in the Windows Registry, making the rootkit a flexible tool able to hide any given artifacts.\n\nInterestingly, numerous debug messages were left by the developers in the rootkit, which allow\nthose Hide rules in particular to be clearly seen. For example, here are the rules used with\none sample, as output in debug logs during execution:\n\n```\nHIDEDRV: >>>>>>>>Hide rules>>>>>>>> rules\nHIDEDRV: File rules: \\Device\\HarddiskVolume1\\Windows\\system32\\mypathcom\\dnscli1.dll\nHIDEDRV: File rules: \\Device\\HarddiskVolume1\\Windows\\system32\\drivers\\FsFlt.sys\nHIDEDRV: Registry rules: \\REGISTRY\\MACHINE\\SYSTEM\\ControlSet002\\services\\FsFlt\nHIDEDRV: Registry rules: \\REGISTRY\\MACHINE\\SYSTEM\\ControlSet001\\services\\FsFlt\nHIDEDRV: Registry rules: \\REGISTRY\\MACHINE\\SYSTEM\\CurrentControlSet\\services\\FsFlt\nHIDEDRV: Inject dll: C:\\Windows\\system32\\mypathcom\\dnscli1.dll\nHIDEDRV: Folder rules: \\Device\\HarddiskVolume1\\Windows\\system32\\mypathcom\nHIDEDRV: <<<<<<<<XXXXX<<<<<<<< rules\nHIDEDRV: <<<<<<<<Hide rules<<<<<<<< rules\n\n```\n\n-----\n\n### En Route with Sednit\n\n\nWe can observe here the three types of artifacts possibly hidden by the rootkit:\n\n- Some specific files, whose paths are given in the File rules. In this case, two such rules\nare present and respectively serve to hide the Downdelph file ([…​]\\dnscli1.dll)\nand the rootkit itself ([…​]\\FsFlt.sys).\n\n- Some specific Windows Registry keys, whose paths are given in the Registry rules.\nIn this case, three such rules are present, to hide registry keys related to the rootkit’s Windows\nservice, and also to hide the configuration itself, which is stored in this particular place.\n\n- Some specific folders, whose paths are given in the Folder rules. In this case, one such\nrule is present, to hide the Downdelph folder ([…​]\\mypathcom).\n\nFinally, the Inject dll rule contains the path of a DLL that the rootkit will inject into\nthe explorer.exe process. In this case, it points to Downdelph.\n\nThe debug messages all start with HIDEDRV, which is apparently the name\nthe developers gave to this rootkit. The developers also forgot to remove\nsome program database (PDB) [23] file paths from the samples:\n\n```\nd:\\!work\\etc\\hi\\Bin\\Debug\\win7\\x86\\fsflt.pdb\nd:\\!work\\etc\\hideinstaller_kis2013\\Bin\\Debug\\win7\\x64\\fsflt.pdb\nd:\\new\\hideinstaller\\Bin\\Debug\\wxp\\x86\\fsflt.pdb\n\n```\n\nTo summarize, the rootkit is configured to hide Downdelph and itself from the user, and also\nto inject Downdelph into explorer.exe. We are now going to describe how those two operations\nare implemented.\n\nHiding Artifacts\n\nWe have identified two different implementations of the concealment mechanism, depending\non the samples. The first one installs hooks in the System Service Descriptor Table (SSDT) [24],\nwhile the second one relies on the Windows filter manager [25].\n\nSSDT Hooking\nThe SSDT is an internal Windows table containing addresses of core kernel routines, in such\na way that hooking them allows the interception of data received by user mode programs.\nThis rootkit hooks three SSDT entries, corresponding to the functions ZwSetInformationFile,\n```\nZwQueryDirectoryFile and ZwEnumerateKey.\n\n```\n\n-----\n\n### En Route with Sednit\n\n\nThese three functions are called by Windows processes to access files, directories and registry keys\nrespectively. The logic inserted by the rootkit is pretty simple: if the accessed artifact path matches\none of the Hide rules, then the function returns as if the artifact does not exist on the system.\nOn the other hand, if the accessed artifact path is not rootkit-protected, the original SSDT function\nis executed. For example, the hook code for ZwSetInformationFile to hide files is presented\nin Figure 13.\n\nFigure 13. Hook code for ZwSetInformationFile to hide files\n\nWith the arrival of 64-bit versions of Windows, the SSDT became protected by Kernel Patch\nProtection [26], preventing the insertion of hooks into this table. This probably explains why\na different implementation of the concealment functionality was introduced in the rootkit,\nas described below.\n\nMinifilter Driver\nThe Windows filter manager [25] allows registering a driver as a minifilter, so that its code will\nbe called on certain I/O operations. Such a minifilter driver can register a pre-operation callback\nor a post-operation callback on each I/O operation it registers to filter.\n\nMinifilter drivers are ordered based on a value called “altitude”: the filter manager executes driver\ncallbacks registered for an I/O operation in the descending order of altitude. This ordering allows,\nfor example, prioritizing anti-virus minifilters over data-processing minifilters, in order to detect\nmalicious files before opening them.\n\nIn our case, the rootkit driver registers itself as a minifilter of altitude 370030. This altitude\nis normally associated with a Windows legacy driver named passThrough.sys _[27], which_\nis an example of a minifilter open-sourced by Microsoft [28]. Thus, the rootkit takes the place\nof passThrough.sys in the minifilter stack, and provides callbacks for hiding.\n\n\n-----\n\n### En Route with Sednit\n\n\nThe concealment functionality is mainly implemented as a pre-operation callback on the IRP_MJ_\nCREATE [29] I/O operation, which corresponds to the creation or opening of files and directories.\nThe callback code is shown in Figure 14.\n\nFigure 14. Preoperation callback for IRP_MJ_CREATE\n(the creation or opening of files and directories)\n\nRegarding hiding registry keys, the developers simply re-used the code of another minifilter\nexample [30] released by Microsoft for that purpose.\n\nAs a final note on this rootkit’s concealment mechanisms, we would like to mention that we found\na 64-bit version of the minifilter-based rootkit made to run on Windows 7 (according to its PDB path\n\n[…​]win7\\x64\\fsflt.pdb). Loading such unsigned driver is normally prevented on this operating\nsystem, and we do not know if the attackers may have actually loaded it.\n\nDLL Injection\nOnce the hiding mechanisms have been put in place, the rootkit injects the DLL whose path is in the\n```\nInject dll rule (Downdelph in our case) into explorer.exe. To do so, it first copies a shellcode\n\n```\ninto explorer.exe, which simply calls Windows API LoadLibraryW on Downdelph path.\n\nTo execute the shellcode, the rootkit then queues a kernel asynchronous procedure call (APC) [31],\na little-known code injection technique. The code responsible for the injection is pictured in Figure 15.\n\nFigure 15. Kernel mode APC registration, FN_ApcNormalRoutine being the shellcode\naddress in the target process\n\n\n-----\n\n### En Route with Sednit\n\n\n##### Conclusion and Open Questions\n\nDeploying a component as simple as Downdelph with a bootkit or a rootkit may seem excessive.\nBut given the apparent rarity of Downdelph deployments over the last two years, we are inclined\nto speculate this is a deliberate strategy.\n\nBy rarely deploying it, Sednit operators apparently kept it out of the hands of malware researchers\nfor almost two years, which, combined with advanced persistence methods, ensured that they were\nable to maintain the monitoring of selected targets over the long term.\n\nStill, we are certainly missing parts of the picture concerning Downdelph, and we hope this report\nwill encourage other researchers to contribute further pieces to the puzzle.\n\n\n-----\n\n### En Route with Sednit\n\n\n##### Indicators of Compromise\n\n###### Downdelph\n\n ESET Detection Names\n```\n   Win32/Rootkit.Agent.OAW\n   Win32/Rootkit.Agent.OAY\n   Win32/Sednit.AZ\n   Win32/Sednit.BA\n   Win32/Sednit.BB\n   Win32/Sednit.K\n   Win64/Sednit.J\n\n Hashes\n   1cc2b6b208b7687763659aeb5dcb76c5c2fbbf26\n   49acba812894444c634b034962d46f986e0257cf\n   4c9c7c4fd83edaf7ec80687a7a957826de038dd7\n   4f92d364ce871c1aebbf3c5d2445c296ef535632\n   516ec3584073a1c05c0d909b8b6c15ecb10933f1\n   593d0eb95227e41d299659842395e76b55aa048d\n   5c132ae63e3b41f7b2385740b9109b473856a6a5\n   5fc4d555ca7e0536d18043977602d421a6fd65f9\n   669a02e330f5afc55a3775c4c6959b3f9e9965cf\n   6caa48cd9532da4cabd6994f62b8211ab9672d9e\n   7394ea20c3d510c938ef83a2d0195b767cd99ed7\n   9f3ab8779f2b81cae83f62245afb124266765939\n   e8aca4b0cfe509783a34ff908287f98cab968d9e\n   ee788901cd804965f1cd00a0afc713c8623430c4\n\n File Names\n   apivscd.dll\n   install_com_x32_LL_full.dll\n   shcore.dll\n   userinit.exe\n\n Registry Keys\n   HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\LastEnum\n   SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\policies\\system\\shell\n\n C&C server Domain Names\n   intelmeserver.com\n\n C&C server IP addresses\n   104.171.117.216\n   141.255.160.52\n\n PDB Paths\n   d:\\\\!work\\\\etc\\\\hideinstaller_kis2013\\\\Bin\\\\Debug\\\\win7\\\\x64\\\\fsflt.pdb\n   d:\\\\new\\\\hideinstaller\\\\Bin\\\\Debug\\\\wxp\\\\x86\\\\fsflt.pdb\n   d:\\\\!work\\\\etc\\\\hi\\\\Bin\\\\Debug\\\\win7\\\\x86\\\\fsflt.pdb\n\n```\n\n-----\n\n### En Route with Sednit\n\n\n##### References\n\n_1._ The Washington Post, Russian government hackers penetrated DNC, stole opposition research on Trump,\n\n[https://www.washingtonpost.com/world/national-security/russian-government-hackers-penetrated-dnc-](https://www.washingtonpost.com/world/national-security/russian-government-hackers-penetrated-dnc-stole-opposition-research-on-trump/2016/06/14/cf006cb4-316e-11e6-8ff7-7b6c1998b7a0_story.html)\n[stole-opposition-research-on-trump/2016/06/14/cf006cb4-316e-11e6-8ff7-7b6c1998b7a0_story.html, June 2016](https://www.washingtonpost.com/world/national-security/russian-government-hackers-penetrated-dnc-stole-opposition-research-on-trump/2016/06/14/cf006cb4-316e-11e6-8ff7-7b6c1998b7a0_story.html)\n\n_2._ [The Wall Street Journal, Germany Points Finger at Russia Over Parliament Hacking Attack, http://www.wsj.com/](http://www.wsj.com/articles/germany-points-finger-at-russia-over-parliament-hacking-attack-1463151250)\n[articles/germany-points-finger-at-russia-over-parliament-hacking-attack-1463151250, May 2016](http://www.wsj.com/articles/germany-points-finger-at-russia-over-parliament-hacking-attack-1463151250)\n\n_3._ [Reuters, France probes Russian lead in TV5Monde hacking: sources, http://www.reuters.com/article/us-france-](http://www.reuters.com/article/us-france-russia-cybercrime-idUSKBN0OQ2GG20150610)\n[russia-cybercrime-idUSKBN0OQ2GG20150610, June 2015](http://www.reuters.com/article/us-france-russia-cybercrime-idUSKBN0OQ2GG20150610)\n\n_4._ [ESET VirusRadar, Zero-day, http://www.virusradar.com/en/glossary/zero-day](http://www.virusradar.com/en/glossary/zero-day)\n\n_5._ [ESET, Sednit Espionage Group Attacking Air-Gapped Networks, http://www.welivesecurity.com/2014/11/11/sednit-](http://www.welivesecurity.com/2014/11/11/sednit-espionage-group-attacking-air-gapped-networks/)\n[espionage-group-attacking-air-gapped-networks/, November 2014](http://www.welivesecurity.com/2014/11/11/sednit-espionage-group-attacking-air-gapped-networks/)\n\n_6._ [Kaspersky, Sofacy APT hits high profile targets with updated toolset, https://securelist.com/blog/research/72924/](https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/)\n[sofacy-apt-hits-high-profile-targets-with-updated-toolset/, December 2015](https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/)\n\n_7._ CrowdStrike, Bears in the Midst: Intrusion into the Democratic National Committee,\n\n[https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/, June 2016](https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/)\n\n_8._ [Trend Micro, Pawn Storm Espionage Attacks Use Decoys, Deliver SEDNIT, https://www.trendmicro.com/vinfo/us/](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/pawn-storm-espionage-attacks-use-decoys-deliver-sednit)\n[security/news/cyber-attacks/pawn-storm-espionage-attacks-use-decoys-deliver-sednit, October 2014](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/pawn-storm-espionage-attacks-use-decoys-deliver-sednit)\n\n_9._ [FireEye, APT28: A Window into Russia’s Cyber Espionage Operations?, https://www.fireeye.com/blog/threat-](https://www.fireeye.com/blog/threat-research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html)\n[research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html](https://www.fireeye.com/blog/threat-research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html)\n\n_10._ [GitHub, ESET Indicators of Compromises, https://github.com/eset/malware-ioc/sednit](https://github.com/eset/malware-ioc/sednit)\n\n_11._ [ESET, Back in BlackEnergy *: 2014 Targeted Attacks in Ukraine and Poland, http://www.welivesecurity.](http://www.welivesecurity.com/2014/09/22/back-in-blackenergy-2014/)\n[com/2014/09/22/back-in-blackenergy-2014/, September 2014](http://www.welivesecurity.com/2014/09/22/back-in-blackenergy-2014/)\n\n_12._ [ESET, ESET LiveGrid®, https://www.eset.com/us/about/eset-advantage/](https://www.eset.com/us/about/eset-advantage/)\n\n_13._ [Digital Defense, Shimming Your Way Past UAC, https://www.digitaldefense.com/using-application-compatibility-](https://www.digitaldefense.com/using-application-compatibility-fixes-to-bypass-user-account-control/)\n[fixes-to-bypass-user-account-control/, May 2014](https://www.digitaldefense.com/using-application-compatibility-fixes-to-bypass-user-account-control/)\n\n_14._ GreyHatHacker, Bypassing Windows User Account Control (UAC) and mitigation,\n\n[https://www.greyhathacker.net/?p=796, December 2014](https://www.greyhathacker.net/?p=796)\n\n_15._ Slovak Foreign Policy Association, EU Eastern Policy: shaping relations with Russia and Ukraine,\n\n[http://www.sfpa.sk/event/eu-eastern-policy-shaping-relations-with-russia-and-ukraine/, November 2015](http://www.sfpa.sk/event/eu-eastern-policy-shaping-relations-with-russia-and-ukraine/)\n\n_16._ [Wikipedia, INI file, https://en.wikipedia.org/wiki/INI_file](https://en.wikipedia.org/wiki/INI_file)\n\n_17._ [Virus Radar, Bootkit, http://www.virusradar.com/en/glossary/bootkit](http://www.virusradar.com/en/glossary/bootkit)\n\n_18._ ESET, TDL4 Bootkit,\n\n[http://www.welivesecurity.com/media_files/white-papers/The_Evolution_of_TDL.pdf, March 2011](http://www.welivesecurity.com/media_files/white-papers/The_Evolution_of_TDL.pdf)\n\n_19._ [Ibsen Software, aPLib - Compression Library, http://ibsensoftware.com/products_aPLib.html](http://ibsensoftware.com/products_aPLib.html)\n\n_20._ ESET, Bootkits: Past, Present & Future,\n\n[https://www.virusbtn.com/pdf/conference/vb2014/VB2014-RodionovMatrosov.pdf, September 2014](https://www.virusbtn.com/pdf/conference/vb2014/VB2014-RodionovMatrosov.pdf)\n\n_21._ MSDN, MmMapIoSpace routine (Windows Drivers),\n\n[https://msdn.microsoft.com/en-us/library/windows/hardware/ff554618](https://msdn.microsoft.com/en-us/library/windows/hardware/ff554618)\n\n_22._ [Virus Radar, Rootkit, http://www.virusradar.com/en/glossary/rootkit](http://www.virusradar.com/en/glossary/rootkit)\n\n_23._ [PDB Files, https://github.com/Microsoft/microsoft-pdb#what-is-a-pdb](https://github.com/Microsoft/microsoft-pdb#what-is-a-pdb)\n\n_24._ [Wikipedia, System Service Descriptor Table, https://en.wikipedia.org/wiki/System_Service_Descriptor_Table](https://en.wikipedia.org/wiki/System_Service_Descriptor_Table)\n\n_25._ MSDN, Filter Manager Concepts,\n\n[https://msdn.microsoft.com/windows/hardware/drivers/ifs/filter-manager-concepts](https://msdn.microsoft.com/windows/hardware/drivers/ifs/filter-manager-concepts)\n\n_26._ Microsoft Technet, Kernel Patch Protection for x64 Based Operating Systems,\n\n[https://technet.microsoft.com/en-us/library/cc759759(v=ws.10).aspx](https://technet.microsoft.com/en-us/library/cc759759%28v=ws.10%29.aspx)\n\n\n-----\n\n### En Route with Sednit\n\n\n_27._ [MSDN, Allocated Altitudes, https://msdn.microsoft.com/windows/hardware/drivers/ifs/allocated-altitudes](https://msdn.microsoft.com/windows/hardware/drivers/ifs/allocated-altitudes)\n\n_28._ [Microsoft, Windows Driver Samples - passThrough, https://github.com/Microsoft/Windows-driver-samples/blob/](https://github.com/Microsoft/Windows-driver-samples/blob/master/filesys/miniFilter/passThrough/)\n[master/filesys/miniFilter/passThrough/](https://github.com/Microsoft/Windows-driver-samples/blob/master/filesys/miniFilter/passThrough/)\n\n_29._ [MSDN, IRP_MJ_CREATE, https://msdn.microsoft.com/en-us/library/windows/hardware/ff548630(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/hardware/ff548630%28v=vs.85%29.aspx)\n\n_30._ Microsoft, Windows Driver Samples - regfltr,\n\n[https://github.com/Microsoft/Windows-driver-samples/tree/master/general/registry/regfltr](https://github.com/Microsoft/Windows-driver-samples/tree/master/general/registry/regfltr)\n\n_31._ MSDN, Asynchronous Procedure Calls,\n\n[https://msdn.microsoft.com/en-us/library/windows/desktop/ms681951(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/ms681951%28v=vs.85%29.aspx)\n\nLast updated 2016-09-11 17:16:51 EDT\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "http://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-part3.pdf",
        "https://app.box.com/s/p4ywd9iqr5fr48nbz5o0nfwwgjkq5itk",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.10.27.En_Route_Part3/eset-sednit-part3.pdf",
        "https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-part3.pdf"
    ],
    "report_names": [
        "eset-sednit-part3.pdf",
        "eset-sednit-part3(10-27-2016)",
        "eset-sednit-part3"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1476457920,
    "ts_modification_date": 1476457925,
    "files": {
        "pdf": "https://archive.orkl.eu/2cd04b3b878180782e8467c2cbe69d301a0d98ec.pdf",
        "text": "https://archive.orkl.eu/2cd04b3b878180782e8467c2cbe69d301a0d98ec.txt",
        "img": "https://archive.orkl.eu/2cd04b3b878180782e8467c2cbe69d301a0d98ec.jpg"
    }
}