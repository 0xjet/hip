{
    "id": "4c0f0d41-637e-47d5-a026-1138921575ee",
    "created_at": "2023-01-12T15:10:12.055168Z",
    "updated_at": "2025-03-27T02:06:13.721122Z",
    "deleted_at": null,
    "sha1_hash": "ee318f15d114a627b70d0643f5c0b804da1803bd",
    "title": "2021-07-12 - Attack Exploiting XSS Vulnerability in E-commerce Websites",
    "authors": "",
    "file_creation_date": "2022-05-28T15:45:18Z",
    "file_modification_date": "2022-05-28T15:45:18Z",
    "file_size": 3323006,
    "plain_text": "# Attack Exploiting XSS Vulnerability in E-commerce Websites\n\n**blogs.jpcert.or.jp/en/2021/07/water_pamola.html**\n\n増渕 [維摩(Yuma Masubuchi)](https://blogs.jpcert.or.jp/en/masubuchi/)\n\nJuly 12, 2021\n\n[Email](http://10.10.0.46/mailto:?subject=Attack%20Exploiting%20XSS%20Vulnerability%20in%20E-commerce%20Websites&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2021%2F07%2Fwater_pamola.html)\n\nOn 28 April 2021, Trend Micro reported the details of attacks exploiting cross-site scripting\n(hereafter “XSS”) vulnerability on e-commerce websites [1]. JPCERT/CC has also confirmed\nsimilar cases, which originate in XSS vulnerability in websites developed with EC-CUBE\nproducts (an open source CMS for e-commerce websites). This attack does not target\nvulnerabilities which is specific to EC-CUBE products but affects any e-commerce websites\nwhich have XSS vulnerability on its administrator page. This attack campaign is still ongoing\nas of July 1, 2021. This article details the cases that JPCERT/CC has handled.\n\n### Attack Overview\n\nThe flow of the attack is described in Figure 1.\n\n\n-----\n\nFigure 1： Attack overview\nFiles embedded in e-commerce sites in the course of this attack are listed in Table 1.\n\nTable 1: List of embedded files\n\nEmbedded files Contents\n\n**WebShell** ・Multi-function WebShell (based in Chinese. Tool name\nunknown)\n\n**Database control tool** ・Adminer version 4.2.4\n\n\n**Information stealing**\n**JavaScript**\n\n**Information storing**\n**JavaScript**\n\n\n・Send credit card information etc. when clicked\n\n・Loaded on login/transaction page\n\n・Save information stolen by the above JavaScript\n\n・Save the data “information storage file”\n\n\n-----\n\n**Information storage**\n**file**\n\n\n・Store credit card number, expiry date, security code, email\naddress, password etc.\n\n\n**Simple WebShell** ・Execute PHP file uploaded\n\nAttackers perform purchase process by typing malicious script into an order form on a target\ne-commerce website (1. in Figure 1). If the process is vulnerable to XSS attack, the\nmalicious script is executed on the administrator’s page, which results in credential theft and\nSimple WebShell setup on the website (2 and 4). After that, attackers implement WebShell\nand JavaScript on the website to steal and save user information (5).It is assumed that the\nattackers access the stolen information by regularly checking the WebShell (6).\n\nIn the course of action, attackers embed Adminer [2] on the e-commerce website. This is a\ncommon tool to check database contents on a GUI environment, which is compatible with\nvarious types of database such as MySQL, PostgreSQL, SQLite, MS SQL, Oracle,\nSimpleDB, Elasticsearch, MongoDB. Attackers are likely to have stolen database information\nby using this tool.\n\n### Malicious purchase action exploiting XSS vulnerability\n\nAn XSS attack is performed as a part of purchase process with the following malicious script.\nAttackers send this script into multiple forms in order to increase the chance of success.\n\nFigure 2： Malicious script sent into multiple forms\nIf this XSS attack succeeds, the following JavaScript code (Figure 3) is executed on the\nadministrator’s PC. This code collects username and password and sends them to attackers’\nservers.\n\n\n-----\n\nFigure 3: Information stealing JavaScript code\n\n### Stealing credit card information\n\nFigure 4 describes the flow of attack stealing credit card information of the site visitor.\n\n\n-----\n\nFigure 4: Flow of attack\nThe embedded “information stealing JavaScript” hooks a user’s mouse clicks on the website\nduring their login and transaction, which as a result steals credit card information. The stolen\ninformation is sent to “information storing JavaScript” located on the same server, and then\nstored in the following relative path:\n```\n../../../ProductOption/img/env.jpg\n\n```\nIt is assumed that attackers retrieved the credit card information stored in the “information\nstorage file” via WebShell.\n\nDetails of the “information stealing JavaScript” is shown in Figure 5.\n\nFigure 5: Information stealing JavaScript code\n\n\n-----\n\nAttackers check the URL and hooks the user s mouse clicks to steal the information provided\nin each component. In the collected data, the path name related to credit card transaction\nservices of the e-commerce company is hard-coded. This indicates that the attackers\ncustomise code depending on the target e-commerce company.\n\nFigure 6: JavaScript code sending credit card information\nThis JavaScript combines each component of the stolen information and sends it to\n“information storing JavaScript”. Email information is temporarily stored in the Cookie of the\nuser’s browser, which is retrieved when sending the data. The data to send is specified as\nfollows:\n\nFigure 7: Format of data sent\n\n### WebShell that was likely used to steal information\n\nThe control page of the WebShell is displayed in Figure 8. It comes with various functions\nsuch as file download/upload and shell command execution. This WebShell is written in\nChinese language.\n\n\n-----\n\nFigure 8: WebShell control page\n\n### In closing\n\nWe have introduced the attack details stealing credentials from administrator’s page. Even if\nan e-commerce site itself has no security issues, this attack can be carried out if a plugin is\nvulnerable. Therefore, it is recommended to check for updates for plugins as well. Please\nrefer to JPCERT/CC’s security alerts [3], [4] and an advisory [5] regarding the vulnerabilities\nexploited.\n\nFor your information, IP address, domain names and file hash values identified in the attack\nare listed in Appendix A and B.\n\n- Yuma Masubuchi, Shusei Tomonaga\n\n(Translated by Yukako Uchida)\n\n### Reference\n\n[1] Water Pamola Attacked Online Shops Via Malicious Orders\n\nhttps://www.trendmicro.com/en_us/research/21/d/water-pamola-attacked-online-shops-viamalicious-orders.html\n\n[2] Adminer\n\nhttps://www.adminer.org/en/\n\n[3] Alert Regarding Cross Site Scripting Vulnerability (CVE-2021-20717) in EC-CUBE\n\nhttps://www.jpcert.or.jp/english/at/2021/at210022.html\n\n\n-----\n\n[4] Alert Regarding Cross Site Scripting Vulnerabilities in Multiple EC-CUBE 3.0 Series\nPlugins\nhttps://www.jpcert.or.jp/english/at/2021/at210028.html\n\n[5] Multiple cross-site scripting vulnerabilities in multiple EC-CUBE plugins provided by ECCUBE\nhttps://jvn.jp/en/jp/JVN57524494/index.html\n\n### Appendix A: Attackers’ IP address and domains\n\n98.126.218[.]141\nhttp[:]//77i[.]co\nhttp[:]//xf6[.]site/A\nhttp[:]//js4[.]io\n\n### Appendix B: SHA256 hash values of files used in the attack\n\nNote: These hash values include tools which may also be used in daily operation. Beware of\nfalse detection when using this as an indicator of compromise.\n\nDatabase control tool\n\n1e1813745f670c469a1c368c45d159ec55656f0a31ed966065a9ca6edd27acc1\n\nJavaScript to steal ID and password (executed in an XSS attack)\n\na1876a6af7e17246633e229c4366c0eb9e4b899a0e884253660c8ace5ed9b366\n\n[Email](http://10.10.0.46/mailto:?subject=Attack%20Exploiting%20XSS%20Vulnerability%20in%20E-commerce%20Websites&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2021%2F07%2Fwater_pamola.html)\n\nAuthor\n\n増渕 [維摩(Yuma Masubuchi)](https://blogs.jpcert.or.jp/en/masubuchi/)\n\nYuma has been engaged in malware analysis and coordination of cyber security incidents in\nJPCERT/CC Incident Response Group since November 2020.\n\nWas this page helpful?\n\n0 people found this content helpful.\n\nIf you wish to make comments or ask questions, please use this form.\n\n\n-----\n\nThis form is for comments and inquiries. For any questions regarding specific commercial\nproducts, please contact the vendor.\n\nplease change the setting of your browser to set JavaScript valid. Thank you!\n\n## Related articles\n\nTrends of Reported Phishing Sites and Compromised Domains in 2021\n\nPHP Malware Used in Lucky Visitor Scam\n\nAttacks Embedding XMRig on Compromised Servers\n\n\n-----\n\nLazarus Attack Activities Targeting Japan (VSingle/ValeforBeta)\n\nEmotet Disruption and Outreach to Affected Users\n\n\n[Back](https://blogs.jpcert.or.jp/en/2021/06/csirt-training-vn.html)\n[Top](https://blogs.jpcert.or.jp/en/)\n[Next](https://blogs.jpcert.or.jp/en/2021/09/volatility3_offline.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-12 - Attack Exploiting XSS Vulnerability in E-commerce Websites.pdf"
    ],
    "report_names": [
        "2021-07-12 - Attack Exploiting XSS Vulnerability in E-commerce Websites.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536212,
    "ts_updated_at": 1743041173,
    "ts_creation_date": 1653752718,
    "ts_modification_date": 1653752718,
    "files": {
        "pdf": "https://archive.orkl.eu/ee318f15d114a627b70d0643f5c0b804da1803bd.pdf",
        "text": "https://archive.orkl.eu/ee318f15d114a627b70d0643f5c0b804da1803bd.txt",
        "img": "https://archive.orkl.eu/ee318f15d114a627b70d0643f5c0b804da1803bd.jpg"
    }
}