{
    "id": "d9fc1e19-0ca6-4b5f-abf1-ac8a5d0aa546",
    "created_at": "2022-10-25T16:48:14.88273Z",
    "updated_at": "2025-03-27T02:05:26.776716Z",
    "deleted_at": null,
    "sha1_hash": "9d6dcfc9a673613fdafe7d967945a0a97308de19",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-12-08T09:27:55Z",
    "file_modification_date": "2020-12-08T09:27:55Z",
    "file_size": 2317975,
    "plain_text": "# Massive malicious campaign by FakeSecurity JS-sniffer\n\n**group-ib.com/blog/fakesecurity**\n\n08.11.2019\n\n**Victor Okorokov**\n\nThreat Intelligence Analyst at Group-IB\n\n\n-----\n\nIn March 2019, Group-IB published its report titled \"Crime without punishment: in-depth\nanalysis of JS-sniffers\", which analyzed 15 different families of JS-sniffers used to infect over\n2,000 e-commerce websites.\n\nIn December 2018, Group-IB specialists detected a new JS-sniffer family called\n**FakeSecurity. It was used by a cybercrime group targeting Magento-based websites. While**\nattacking websites, attackers injected a link to a malicious code into the website's source\ncode. Analysis showed that during a recent malicious campaign, the cybercrime group used\n**password-stealing malware and tried to infect online merchants in order to**\n**infect their websites with the JS-sniffer. All the infected websites have been notified by**\nGroup-IB's Computer Emergency Response Team about the presence of malicious injects.\n\n**Analysis**\n\nIn December 2018, Group-IB specialists detected a new JS-sniffer family called\n**FakeSecurity. It was used by one cybercrime group targeting Magento-based websites.**\nWhile attacking websites, attackers injected a malicious code into the website's source code.\nThe script runs every time that a victim browses an online shop. It steals user payment\ninformation during checkout and sends it to the attacker's server. During the first waves of\nattacks, the FakeSecurity sniffer used the domain name magento-security[.]org as a gate\nfor stolen credentials and to store the sniffer source code.\n\n\n-----\n\nThe same sniffer was later detected on other Magento-based websites, but attackers had\nchanged the domain names used for storing the JS-sniffer source code:\n\n**fiswedbesign.com**\n**alloaypparel.com**\n\nBoth these domain names were registered using the same email address,\n**greenstreethunter@india.com. Apart from these two domain names, attackers created a**\nthird domain name, firstofbanks.com, using the same email address.\n\n\n-----\n\nWhile analyzing the three domain names used by those behind the FakeSecurity JS-sniffer,\nit was established that some of them were used in a malicious campaign. As part of this\ncampaign, attackers had been spreading malware since March 2019. Attackers sent links to\nfake pages that informed victims about a missing plugin required to display the document\ncorrectly. If a user downloaded the plugin, their computer was infected with the passwordstealing malware.\n\n\n-----\n\nThere were 11 unique links to fake pages that urged user to install a malicious application:\n\n1. hxxps://www.etodoors[.]com/uploads/Statement00534521.html\n2. hxxps://www.healthcare4all[.]co.uk/manuals/Statement00534521.html\n3. hxxps://www.healthcare4all[.]co.uk/lib/Statement001845.html\n4. hxxps://www.healthcare4all[.]co.uk/doc/BankStatement001489232.html\n\n5. hxxp://verticalinsider[.]com/bookmarks/Bank_Statement0052890.html\n6. hxxp://thepinetree[.]net/n/docs/Statement00159701.html\n\n7. hxxps://www.readicut[.]co.uk/media/pdf/Bank_Statement00334891.html\n8. hxxp://www.e-cig[.]com/doc/pdf/eStmt.html\n9. hxxps://www.genstattu[.]com/doc/PoliceStatement001854.html\n10. hxxps://www.tokyoflash[.]com/pdf/statment001854.html\n\n11. hxxps://www.readicut[.]co.uk/media/pdf/statment00789.html\n\nPotential victims of this malicious campaign received spam email messages containing a link\nto a 1 -level fake page. Such pages contain only one small HTML document with anst\nembedded iframe element that loads content from a different 2nd-level page. Second-level\npages are landing pages with content that urges users to install an application. In the case of\nthis malicious campaign, attackers used a landing page that imitates an online PDF viewer\n\n\n-----\n\nand the page displays a message about a missing plugin for Adobe Reader, which is why the\n1 -level link imitated a link to a PDF file. Second-level pages contain links to EXE files,st\nwhich are installed on the victim's computer after they click on the \"Download plugin\"\nbutton.\n\nLet's examine an example of a malicious landing page. A potential victim receives a link to an\nHTML file via a spam email message, e.g.\nhxxps://www.healthcare4all[.]co[.]uk/manuals/Statement00534521.html. This HTML file\ncontains an iframe element with a link to the page's main content; in this case, all content\nwas stored by the link\nhxxps://alloaypparel[.]com/view/public/Statement00534521/PDF/Statement001854.pdf.\nAs we can see from this example, to store a fake page's main content, the attackers used not a\ncompromised website but a domain name created for malicious purposes. In the fake page's\ninterface, there is a button with the text \"Download plugin\". If the victim clicks on this\nbutton, they will download a malicious application through the URL address from the fake\npage's source code; in this case, the URL to the EXE file is\nhxxps://www.healthcare4all[.]co[.]uk/manuals/Adobe-Reader-PDF-Plugin-2.37.2.exe,\nwhich means that the malware was stored on a compromised website.\n\nAnalysis of the domain name alloaypparel.com helped experts establish that, to spread\nmalware, attackers used the phishing kit Mephistophilus, which makes it possible to\ncreate and deploy phishing landing pages designed for distributing malware. Mephistophilus\nuses several types of pages that urge users to install a missing plugin for the application to\nfunction correctly, but instead of a plugin users download a malicious payload by URL, set by\nthe operator in the admin panel of the Mephistophilus phishing kit.\n\n\"Mephistophilus\", a system for targeted phishing attacks, appeared for sale in August 2016.\nIt is based on the use of various phishing kits designed for malware distribution disguised as\nan installation of missing plugins (MS Word, MS Excel, PDF, YouTube) for viewing online\ndocuments or web pages. Mephistophilus was developed and released by an underground\nforum user with the nickname 'Kokain'. To successfully infect through a phishing kit,\nattackers must prompt users to click on the link leading to the page created by\nMephistophilus. Regardless of the phishing page theme, users will see a pop-up window with\na message that they need to install a missing plugin in order to view an online document or\nwatch a YouTube video. To this end, Mephistophilus has various types of phishing pages that\nimitate legitimate online services:\n\nOnline viewer for Microsoft Office365 Word or Excel documents\nOnline viewer for PDF files\nCloned YouTube page\n\n\n-----\n\nDuring this malicious campaign, the cybercrime group did not use only registered domain\nnames to achieve their goals; they also used compromised e-commerce websites to store\nmalware samples. Some of these websites were infected with the FakeSecurity JS-sniffer in\nprevious attacks conducted by this cybercrime group.\n\nIn total, there were 5 unique links to 5 unique malware samples; four of them were\nstored on compromised websites running on CMS Magento:\n\nhxxps://www.healthcare4all[.]co[.]uk/manuals/Adobe-Reader-PDF-Plugin-2.37.2.exe\nhxxps://www.genstattu[.]com/doc/Adobe-Reader-PDF-Plugin-2.31.4.exe\nhxxps://firstofbanks[.]com/file_d/Adobe-Reader-PDF-Plugin-2.35.8.exe\nhxxp://e-cig[.]com/doc/Adobe-Reader-PDF-Plugin-2.31.4.exe\nhxxp://thepinetree[.]net/docs/msw070619.exe\n\nThe malware samples distributed during this campaign were samples of the Vidar password\nstealer, designed to intercept passwords from user browsers and various applications.\n\nVidar is a password stealer that intercepts passwords saved in browsers and various\napplications and files from infected computers. Apart from stealing passwords, Vidar collects\nfiles from infected computers by masks defined by malware operators and then sends these\nfiles to the C2 server. This feature facilitates the process of searching for and stealing\n\n\n-----\n\ncryptocurrency wallet files. Vidar is classed as malware-as-a-service; all data collected from\ninfected computers is sent to the gate and then to a centralized administrative panel that\neach customer of the malware service can use to view collected data.\n\nThe Vidar stealer was developed and released in November 2018 by an underground forum\nuser with the nickname 'Loadbaks'. According to the developer's description, Vidar steals\npasswords from browsers, files by predefined paths and masks, bank card information, cold\ncryptocurrency wallet files, Skype and Telegram chat history, and browser history. The rental\nprice for this stealer ranges from $250 to $300 per month. The stealer's admin panel and\ndomain names, which are used as gates, are located on servers controlled by Vidar's authors,\nwhich decreases the costs of stealer infrastructure support for customers.\n\nIn case of the malicious file msw070619.exe, apart from delivery via Mephistophilus\nlanding pages, attackers also used a malicious DOC file with an embedded macro,\n**BankStatement0040918404.doc (MD5: 1b8a824074b414419ac10f5ded847ef1), which**\ndrops executable files after editing is enabled. This DOC file was sent as an attachment in a\nmalicious email message, which means that mass email sending was one of the aspects of the\nmalicious campaign conducted by the cybercrime group.\n\n\n-----\n\nThe detected message (MD5: 53554192ca888cccbb5747e71825facd) was sent to the contact\naddress of an e-commerce website running on the CMS Magento, which could mean that\nsome of the campaign's targets were online shop administrators. The end goal of infecting\nMagento website administrators was to gain access to the Magento admin panel and other ecommerce CMSs in order to install a JS-sniffer and steal customer information.\n\n\n-----\n\n**The full infection process was therefore made up of these steps:**\n\n1. Attackers deployed the admin panel of the Mephistophilus phishing kit on the website\n\nalloaypparel.com.\n2. Attackers used hacked websites and their own websites to store malicious payloads of\n\npassword-stealing malware.\n3. Using the phishing kit, attackers deployed multiple landing pages for malware\n\ndistribution; they also created malicious documents containing macros designed to\nmake victims download and install malicious payloads on infected computers.\n4. Attackers sent mass emails containing malicious files and links to landing pages for\n\nmalware installation. At least some of their targets were e-commerce website\nadministrators.\n5. If the website administrator's computer was successfully infected, attackers used the\n\nadministrator's credentials to obtain access to the admin panel of e-commerce CMS in\norder to install a JS-sniffer designed to steal information about bank cards used by the\ncustomers of the infected online store.\n\n**Links to other attacks**\n\n\n-----\n\nAttacker infrastructure was deployed on the server with IP address 200.63.40.2, which is\nowned by a dedicated server provider, Panamaserver.com. Before the FakeSecurity malicious\ncampaign, this server was used for phishing purposes and for deploying admin panels of\nvarious malware families in order to steal passwords.\n\nBased on the characteristics of the FakeSecurity campaign, it is possible that the admin\npanels of Lokibot and AZORUlt stealers, which were deployed on this server, were used in\nprevious attacks conducted by this group in January 2019. According to a blog post\n(https://myonlinesecurity.co.uk/lokibot-via-multiple-embedded-ole-objects-in-fake-invoicertf-word-docs/), on January 14th, 2019, unknown attackers sent mass emails containing\nmalicious DOC files that installed Lokibot malware on infected computers. On January 18th,\n2019, further mass emails were sent, this time containing malicious documents that installed\n[samples of AZORUlt malware (https://twitter.com/dvk01uk/status/1086131035472048128).](https://twitter.com/dvk01uk/status/1086131035472048128)\nDuring this malicious campaign, there were three admin panels detected on the server with\nIP address 200.63.40.2:\n\nhttp://chuxagama.com/web-obtain/Panel/five/PvqDq929BSx_A_D_M1n_a.php\n(Lokibot)\nhttp://umbra-diego.com/wp/Panel/five/PvqDq929BSx_A_D_M1n_a.php (Lokibot)\nhttp://chuxagama.com/web-obtain/Panel/five/index.php (AZORUlt)\n\nThe domain names chuxagama.com and umbra-diego.com were registered by the same user,\nusing the email address dicksonfletcher@gmail.com. This email address was also used to\ncreate the domain name worldcourrierservices.com in May 2016, which was later used as a\nwebsite for the fake company World Courier Service.\n\nBased on the fact that, during the FakeSecurity malware campaign, attackers used passwordstealing malware, sent mass emails for its distribution, and used the server with IP address\n200.63.40.2, we can suppose that both campaigns, including the campaign in January 2019,\nwere conducted by the same cybercrime group.\n\n**Indicators of compromise**\n\n**File name Adobe-Reader-PDF-Plugin-2.37.2.exe**\n\nMD5 3ec1ac0be981ce6d3f83f4a776e37622\nSHA-1 346d580ecb4ace858d71213808f4c75341a945c1\nSHA-256 6ec8b7ce6c9858755964f94acdf618773275589024e2b66583e3634127b7e32c\nSize 615984\n\n**File name Adobe-Reader-PDF-Plugin-2.31.4.exe**\n\nMD5 58476e1923de46cd4b8bee4cdeed0911\nSHA-1 aafa9885b8b686092b003ebbd9aaf8e604eea3a6\n\n\n-----\n\nSHA-256 15abc3f55703b89ff381880a10138591c6214dee7cc978b7040dd8b1e6f96297\nSize 578048\n\n**File name Adobe-Reader-PDF-Plugin-2.35.8.exe**\n\nMD5 286096c7e3452aad4acdc9baf897fd0c\nSHA-1 26d71553098b5c92b55e49db85c719f5bb366513\nSHA-256 af04334369878408898a223e63ec50e1434c512bc21d919769c97964492fee19\nSize 1069056\n\n**File name Adobe-Reader-PDF-Plugin-2.31.4.exe**\n\nMD5 fd0e11372a4931b262f0dd21cdc69c01\nSHA-1 54d34b6a6c4dc78e62ad03713041891b6e7eb90f\nSHA-256 4587da5dca2374fd824a15e434dae6630b24d6be6916418cee48589aa6145ef6\nSize 856576\n\n**File name msw070619.exe**\n\nMD5 772db176ff61e9addbffbb7e08d8b613\nSHA-1 6ee62834ab3aa4294eebe4a9aebb77922429cb45\nSHA-256 0660059f3e2fb2ab0349242b4dde6bf9e37305dacc2da870935f4bede78aed34\nSize 934448\n\n**fiswedbesign.com**\n**alloaypparel.com**\n**firstofbanks.com**\n**magento-security.org**\n**mage-security.org**\n\n**https://www.healthcare4all[.]co.uk/manuals/Adobe-Reader-PDF-Plugin-**\n**2.37.2.exe**\n**https://www.genstattu[.]com/doc/Adobe-Reader-PDF-Plugin-2.31.4.exe**\n**https://firstofbanks[.]com/file_d/Adobe-Reader-PDF-Plugin-2.35.8.exe**\n**http://e-cig[.]com/doc/Adobe-Reader-PDF-Plugin-2.31.4.exe**\n**http://thepinetree[.]net/docs/msw070619.exe**\n\nCrime without punishment: in-depth analysis of JS-sniffers\n\nJS-sniffers pose a growing threat by attacking online stores and stealing payment data and\ncredentials of their users. When a website is infected with JS-sniffer, everyone is a victim â€“\nonline shoppers, ecommerce websites, payment processing systems, and banks that issued\n\n\n-----\n\ncompromised cards. Group-IB experts have researched this type of malware and have\ndiscovered 38 families of JS-sniffers, whereas only 12 were known previously.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.11.08_FakeSecurity_JS-sniffer/Massive%20malicious%20campaign%20by%20FakeSecurity%20JS-sniffer.pdf"
    ],
    "report_names": [
        "Massive malicious campaign by FakeSecurity JS-sniffer"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041126,
    "ts_creation_date": 1607419675,
    "ts_modification_date": 1607419675,
    "files": {
        "pdf": "https://archive.orkl.eu/9d6dcfc9a673613fdafe7d967945a0a97308de19.pdf",
        "text": "https://archive.orkl.eu/9d6dcfc9a673613fdafe7d967945a0a97308de19.txt",
        "img": "https://archive.orkl.eu/9d6dcfc9a673613fdafe7d967945a0a97308de19.jpg"
    }
}