{
    "id": "e8b2fbc7-884f-4685-9478-3c6e57a234e3",
    "created_at": "2023-01-12T15:10:36.614485Z",
    "updated_at": "2025-03-27T02:06:04.539802Z",
    "deleted_at": null,
    "sha1_hash": "bbd70a91b25ebd0eaeb6f61658adb7d6065cf1d4",
    "title": "2017-12-28 - PandaZeuS’s Christmas Gift- Change in the Encryption scheme",
    "authors": "",
    "file_creation_date": "2022-05-28T04:57:02Z",
    "file_modification_date": "2022-05-28T04:57:02Z",
    "file_size": 136937,
    "plain_text": "# Change in the Encryption scheme\n\n**spamhaus.org/news/article/771/**\n\nSpamhaus Malware Labs - Spamhaus's malware research unit - recently observed a wave of\nnew PandaZeuS malware samples being distributed during the Christmas season.\nPandaZeuS, also known as Panda Banker, is an ebanking Trojan that evolved from the\nnotorious ZeuS trojan and is being used by different threat actors to compromise ebanking\ncredentials, used by cybercriminals to commit ebanking fraud.\n\nLooking into two recent PandaZeuS campaigns that have just been spread before Christmas\nrevealed that the most recent version of PandaZeuS comes with a few minor changes. An\nimportant one is the change in the encryption scheme of PandaZeuS’s Base Config. While\nPandaZeuS is still using the RC4 binary encryption scheme, it comes with some tiny\nmodifications. First of all, the versioning of PandaZeuS got updated to 2.6.1:\n\n_New version 2.6.1_\nIn the previous version, the base config was AES-265-CBC and RC4 encrypted . While this\nis still the case of the most recent version of PandaZeuS too, a slight modification in RC4\nhas been done:\n\n_PandaZeuS code snipped_\nThe screenshot above documented the changes made to by the developers of PandaZeuS\nto the code:\n\n\n-----\n\n1. Initial Key Stream Array is initialized\n2. The State Array is modified 4 * 30 times and the keystream value is omitted\n3. Reusing the previous indexes, State Array is modified and keystream values obtained\n\nis XORed with encrypted byte.\n\nThis can be represented in Python code as:\n```\nfor i in range(256):\n    j = (j + S[i] + ord(key[i % len(key)])) % 256\n    S[i], S[j] = S[j], S[i]\n  i = j = 0\n  for x in range(0, 30 * 4):\n    i = (i + 1) % 256\n    j = (j + S[i]) % 256\n    S[i], S[j] = S[j], S[i]\n  for p in data:\n    i = (i + 1) % 256\n    j = (j + S[i]) % 256\n    S[i], S[j] = S[j], S[i]\n\n```\nWhile we can only speculate about the reason of this minor change in the encryption scheme\nof PandaZeuS, we suspect the intent behind this code change is to break malware extractors\nused by malware researchers to extract botnet controllers from PandaZeuS malware\nsamples.\n\nLooking into sinkhole data of one of these PandaZeuS campaigns shows that the botnet is\nmainly targeting English-speaking internet users:\n\n\n-----\n\nIn addition, the associated botnet domain names are poorly detected:\n\n[262d65fc7f47.tk VT detection rate: 2/66](https://www.virustotal.com/#/url/0d2db3113c5695ade52a99b9091f60e418dadc272777ba9bea32a00b439cfe19/detection)\n[922b031aac47.tk VT detection rate: 3/66](https://www.virustotal.com/#/url/17bc05d7363460ead2cff54c6030232e8f70de1c1529ad71e8e4e25f7d55a1cc/detection)\n\n## Indicators of Compromise (IOC)\n\n**Campaign #1**\n\nPandaZeuS botnet controller URLs:\n```\nhxxps://922B031AAC47.tk/2egublocatolaubhaqiec.dat\nhxxps://262D65FC7F47.tk/3fefavyamzaosanocheyt.dat\nhxxps://262D65FC7F98.ml/4uryctexaesleikbosoil.dat\nhxxps://262D65FC7F10.ga/5texyiwkuoffokirefeub.dat\nhxxps://262D65FC7F98.cf/6huqefeaplefoucvyudow.dat\n\n```\n[PandaZeuS botnet controller domain names (blocked by Spamhaus RPZ):](https://www.spamhaus.org/news/article/669/spamhaus-dbl-as-a-response-policy-zone-rpz)\n\n```\n262D65FC7F10.ga\n\n```\n```\n262D65FC7F47.tk\n262D65FC7F98.cf\n262D65FC7F98.ml\n922B031AAC47.tk\n\n```\n[PandaZeuS botnet controllers (blocked by Spamhaus BCL):](https://www.spamhaus.org/bcl/)\n\n```\n89.18.27.155\n\n```\n```\n94.156.128.207\n\n```\n```\n155.94.67.27\n\n```\n\n-----\n\nRelated malware samples (MD5):\n```\n0d1150d89f94701b54c7feb81d83a8fd\n3e7632e36c96a5be6721f57828dbc7f5\n\n```\n**Campaign #2**\n\nPandaZeuS botnet controller URLs:\n```\nhxxps://gromnes.top/1iqrozoymydfykiabloyx.dat\nhxxps://aklexim.top/2pugyomxixiusqoxuvein.dat\nhxxps://kichamyn.top/3efqykyfeetraygyhytuz.dat\nhxxps://myrasno.top/4tieseqpaowosputoezyl.dat\nhxxps://brumnoka.top/5ybveogaqydriumytzaun.dat\nhxxps://bqwernod.top/6efudpigoreudtygoedco.dat\n\n```\nPandaZeuS botnet controller domain names (blocked by Spamhaus RPZ):\n```\naklexim.top\nbqwernod.top\nbrumnoka.top\ngromnes.top\nkichamyn.top\nmyrasno.top\n\n```\nPandaZeuS botnet controllers (blocked by Spamhaus BCL):\n```\n27.102.67.144\n5.8.88.133\n\n```\nRelated malware samples (MD5):\n```\n02ac00fe985091b78eaeb64ee697d57f\n9be7c5e014c560db231518a13b18dfea\na3a4ef76764c9e3e9c91698b7adbd795\nb42d194091de01d9645b323cd8ac425f\n48e4f66aeb6dcb991ae57ac8294d2911\n9ff828a80d8408a1e5533ecc304c7e9e\n\n## Related Spamhaus Products\n\n```\n[Spamhaus Response Policy Zone (RPZ)](https://www.spamhaustech.com/protecting-networks/security-solutions/dns-rpz/)\n[Spamhaus Botnet + Malware Domain List (BDL)](https://www.spamhaustech.com/protecting-networks/threat-intelligence-data/malware-domains/)\n[Spamhaus Botnet Controller List (BCL)](https://www.spamhaustech.com/protecting-networks/threat-intelligence-data/bcl/)\n\nSpamhaus Malware Labs is Spamhaus's malware research unit run in conjunction with\n[Deteque, a subsidiary of Spamhaus Technology Ltd.](https://deteque.com/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-12-28 - PandaZeuS’s Christmas Gift- Change in the Encryption scheme.pdf"
    ],
    "report_names": [
        "2017-12-28 - PandaZeuS’s Christmas Gift- Change in the Encryption scheme.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536236,
    "ts_updated_at": 1743041164,
    "ts_creation_date": 1653713822,
    "ts_modification_date": 1653713822,
    "files": {
        "pdf": "https://archive.orkl.eu/bbd70a91b25ebd0eaeb6f61658adb7d6065cf1d4.pdf",
        "text": "https://archive.orkl.eu/bbd70a91b25ebd0eaeb6f61658adb7d6065cf1d4.txt",
        "img": "https://archive.orkl.eu/bbd70a91b25ebd0eaeb6f61658adb7d6065cf1d4.jpg"
    }
}