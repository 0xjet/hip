{
    "id": "951fb369-5413-4177-893c-7bd4d0013e72",
    "created_at": "2023-01-12T15:08:44.222468Z",
    "updated_at": "2025-03-27T02:05:32.863275Z",
    "deleted_at": null,
    "sha1_hash": "d35aa0650183f20f948e3734ba11c87bffced9b7",
    "title": "2017-07-24 - Bye, bye Petya! Decryptor for old versions released.",
    "authors": "",
    "file_creation_date": "2022-05-28T04:56:42Z",
    "file_modification_date": "2022-05-28T04:56:42Z",
    "file_size": 327251,
    "plain_text": "# Bye, bye Petya! Decryptor for old versions released.\n\n**[blog.malwarebytes.com/malwarebytes-news/2017/07/bye-bye-petya-decryptor-old-versions-released/](https://blog.malwarebytes.com/malwarebytes-news/2017/07/bye-bye-petya-decryptor-old-versions-released/)**\n\nMalwarebytes Labs July 24, 2017\n\nFollowing the outbreak of the Petya-based malware in Ukraine, the author of the original\nversion, Janus, decided to release his master key, probably closing the project. You can read\nthe full story [here.](https://blog.malwarebytes.com/cybercrime/2017/07/the-key-to-the-old-petya-has-been-published-by-the-malware-author/)\n\nBased on the released key, we prepared a decryptor that is capable of unlocking all the\n[legitimate versions of Petya (read more about identifying Petyas):](https://blog.malwarebytes.com/cybercrime/2017/07/keeping-up-with-the-petyas-demystifying-the-malware-family/)\n\nRed Petya\nGreen Petya (both versions) + Mischa\nGoldeneye (bootlocker + files)\n\nIn case if you have a backup of Petya-encrypted disk, this is the time to take it out from the\nshelf and kiss your Petya goodbye ðŸ˜‰\n\nWARNING: During our tests we found that in some cases Petya may hang during decryption,\nor cause some other problems potentially damaging to your data. Thatâ€™s why, before any\ndecryption attempts, we recommend you to make an additional backup.\n\n_// Special thanks to_ _[@Th3PeKo,](https://twitter.com/Th3PeKo)_ _[@vallejocc and Michael Meyer for all the help in testing!](https://twitter.com/vallejocc)_\n\n\n-----\n\n## Variants of the attack\n\nAs we know, depending on version Petya may attack your data by two ways:\n\n1 â€“ at a low level, encrypting your Master File Table. For example:\n\n[2 â€“ at a high level, encrypting your files one by one (like a typical ransomware). For](https://www.malwarebytes.com/ransomware)\nexample:\n\nFortunately, the released key allows for recovery in both cases. However the process of\ndecryption will look a bit different.\n\n## Decryptors\n\nWe prepared two different builds of the recovery tool, to support the specific needs:\n\n1. a [Live CD](https://github.com/hasherezade/petya_key/releases/download/0.2/antipetya_ultimate.iso)\n2. a [Windows executable](https://github.com/hasherezade/petya_key/releases/download/0.2/petya_key_v0.2_win32.zip)\n\nIn both cases, the tool decrypts the individual key from the victim ID.\n\n\n-----\n\nAfter obtaining the key, you can use the original decryptors in order to recover your files. You\ncan find the links here:\n\nFor Mischa: [https://drive.google.com/open?id=0Bzb5kQFOXkiSWUZ6dndxZkN1YlE](https://drive.google.com/open?id=0Bzb5kQFOXkiSWUZ6dndxZkN1YlE)\nFor Goldeneye: [https://drive.google.com/open?id=0Bzb5kQFOXkiSdTZkUUYxZ0xEeDg](https://drive.google.com/open?id=0Bzb5kQFOXkiSdTZkUUYxZ0xEeDg)\n\n**DISCLAIMER: Those tools are provided as is and you are using them at your own risk.**\n**We are not responsible for any damage or lost data.**\n\n## Defeating the bootlocker\n\nIn both cases, you can obtain the key to your Petya by using a Windows Executable and\n[supplying it your victim ID. Detailed instructions has been given here and on the video below:](https://github.com/hasherezade/petya_key)\n\nWatch Video At:\n\nhttps://youtu.be/w9YkZ1X58V4\n\nHowever, victim IDs are very long, and retyping them may be painful and prone to mistakes.\nThatâ€™s why, we prepared an alternative: a LiveCD that will automatically read it from the\nencrypted disk. In order to use it, you need to download the ISO and boot from it your\ninfected machine. Then, follow the displayed instructions:\n\n\n-----\n\nWatch Video At:\n\nhttps://youtu.be/wwsQropG2JA\n\nAfter obtaining the key, you can use it to decrypt your Master File Table:\n\nWatch Video At:\n\nhttps://youtu.be/7VWNQasU1VQ\n\n## Decrypting files\n\nIn case if your files has been encrypted, i.e. by Goldeneye or Mischa, you can use the key\n[decryptor released in form of a Windows executable.](https://github.com/hasherezade/petya_key/releases/download/0.2/petya_key_v0.2_win32.zip)\n\n\n-----\n\n1. Find your victim ID ( personal decryption code ). It will be in your ransom note:\n\nIn case if you donâ€™t have the note, you can find the ID appended at the end of any of your\nencrypted files:\n\n2. Save the ID in a file:\n\n3. Use our tool to decrypt your key:\n\n\n-----\n\n3. Copy the obtained key. Download the original decryptor, appropriate for your version:\n\nFor Mischa: [https://drive.google.com/open?id=0Bzb5kQFOXkiSWUZ6dndxZkN1YlE](https://drive.google.com/open?id=0Bzb5kQFOXkiSWUZ6dndxZkN1YlE)\nFor Goldeneye: [https://drive.google.com/open?id=0Bzb5kQFOXkiSdTZkUUYxZ0xEeDg](https://drive.google.com/open?id=0Bzb5kQFOXkiSdTZkUUYxZ0xEeDg)\n\nChoose one of your encrypted files:\n\nSupply the key obtained from the key decoder:\n\n\n-----\n\nDecrypt the file and check if the output is valid. If everything is fine, you can use the same\nkey to decrypt rest of your files. Supply the extension to the decryptor, and it will find them\nautomatically:\n\n## Conclusion\n\n\n-----\n\nThe presented tools allow you to unlock all the legitimate versions of Petya that are released\nup to now by Janus Cybercrime Solutions. It cannot help the victims of pirated Petyas, like\nPetrWrap or EternalPetya (aka NotPetya). It matches the announcement made by Janus on\ntwitter:\n\nIs it the end of Petyaâ€™s story? Probably yes, however, the future will learn.\n\n_This was a guest post written by Hasherezade, an independent researcher and programmer_\n_with a strong interest in InfoSec. She loves going in details about malware and sharing threat_\n_[information with the community. Check her out on Twitter @hasherezade and her personal](https://twitter.com/hasherezade)_\n_[blog: https://hshrzd.wordpress.com.](https://hshrzd.wordpress.com/)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-07-24 - Bye, bye Petya! Decryptor for old versions released..pdf"
    ],
    "report_names": [
        "2017-07-24 - Bye, bye Petya! Decryptor for old versions released..pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536124,
    "ts_updated_at": 1743041132,
    "ts_creation_date": 1653713802,
    "ts_modification_date": 1653713802,
    "files": {
        "pdf": "https://archive.orkl.eu/d35aa0650183f20f948e3734ba11c87bffced9b7.pdf",
        "text": "https://archive.orkl.eu/d35aa0650183f20f948e3734ba11c87bffced9b7.txt",
        "img": "https://archive.orkl.eu/d35aa0650183f20f948e3734ba11c87bffced9b7.jpg"
    }
}