{
    "id": "a72611ef-8ca3-44be-8313-13bd32f42ac2",
    "created_at": "2023-01-12T15:06:21.831443Z",
    "updated_at": "2025-03-27T02:05:59.502693Z",
    "deleted_at": null,
    "sha1_hash": "420e0939118278e090f152facf24548b0f0ed039",
    "title": "2022-06-09 - Quick look into a new sample of Android-BianLian",
    "authors": "",
    "file_creation_date": "2022-08-18T04:01:18Z",
    "file_modification_date": "2022-08-18T04:01:18Z",
    "file_size": 342552,
    "plain_text": "# Quick look into a new sample of Android/BianLian\n\n**[cryptax.medium.com/quick-look-into-a-new-sample-of-android-bianlian-bc5619efa726](https://cryptax.medium.com/quick-look-into-a-new-sample-of-android-bianlian-bc5619efa726)**\n\n@cryptax June 9, 2022\n\n[@cryptax](https://cryptax.medium.com/?source=post_page-----bc5619efa726--------------------------------)\n\nJun 9\n\n\n2 min read\n\n[It‚Äôs Xmas time?! New BianLian samples to analyze thanks to @ni_fi_70 1 hour ago. Is that](https://twitter.com/ni_fi_70/status/1534795034695979008?s=20&t=eWVtLz953U1YdKf4cwPHxw)\nfresh enough? üòâ\n\nLet‚Äôs look into `doc_hy_0906_obf.apk, with SHA256:`\n```\n99e0053475ecd6a22b0e22b2441f0bf0a407b36be54e7d8220bb284c0bd494a8 .\n\n## Unpacking\n\n```\nIt is packed. Arg: my ‚ÄúJsonPacker‚Äù rule in APKiD doesn‚Äôt see it, I‚Äôll have to fix that!\n\nAPKiD should have detected ‚ÄúJsonPacker‚Äù. It did not. That‚Äôs a bug, and it‚Äôs ‚Ä¶ my fault!\nFortunately, students of mine wrote an unpacker that worked fine. Nice!\n\nStatic unpacking of the malware. Of course, you can unpack dynamically too if you prefer.\n\n## Getting the C2\n\nThis sample connects to a Tor onion website to retrieve the URL of the C2.\n\n\n-----\n\nThis first website is only there to distribute the URL of the C2\nToday, this website returns a base64 encoded string:\n```\neyJkb21haW5zIjpbImh0dHA6XC9cL3NlcnZzZXJ2ZnJlZXVwZGF0ZS50b3AiLCJodHRwOlwvXC93YXluZWNvbm\n\n```\nDecode it, and you get not 1 URL, but 3! That‚Äôs the first time I see that in BianLian, although\nthe support for multiple domains has been there for a long time.\n```\n{\"domains\":\n[\"http:\\/\\/servservfreeupdate.top\",\"http:\\/\\/wayneconnectingservice.hk\",\"http:\\/\\/allu\n\n```\nThe last one does not resolve (yet). The first 2 currently go to the same IP address\n```\n185.117.90.233 . The 3rd is down. It has registered 4 other domain names that we will\n\n```\n[probably see in the future: managerupgradecert[.]xyz,](https://community.riskiq.com/search/managerupgradecert.xyz) [wayneconnectingservice[.]com,](https://community.riskiq.com/search/wayneconnectingservice.com)\n[auw[.]swiftabout[.]co[.]uk and](https://community.riskiq.com/search/2auw.swiftabout.co.uk) [uayv.rotlain[.]com.](https://community.riskiq.com/search/uayv.rotlain.com)\n\n## Targets\n\nThis C2 currently targets 438 mobile apps. 80% of those apps are mobile banking apps,\n10% are for cryptocurrency, and the rest varies (mail applications, or just famous apps). The\ntargeted countries are the usual ones for the BianLian family. I can just highlight that it\ntargets some French banks (a recent addition first seen in May 2022), but does not target\nAustria, Australia or Singapore compared to other instances of BianLian.\n\n## Code ‚Äúnovelties‚Äù\n\nThere are no added functionality compared to prior BianLian samples I analyzed, but the\ncode‚Äôs organization has been improved with the addition of 3 new classes:\n\nBatteryOptimizationHandler. Handles doze mode. This existed before, but code was\nscattered in various locations.\nDeviceSecurityHandler. Turns off Huawei and Samsung security centers.\nXiaomiAutostartHandler. Sets auto start for the malware in MiUI‚Äôs security center. I\nbelieve this is referring to .\n\n\n-----\n\n‚Äî Cryptax\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-09 - Quick look into a new sample of Android-BianLian.pdf"
    ],
    "report_names": [
        "2022-06-09 - Quick look into a new sample of Android-BianLian.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535981,
    "ts_updated_at": 1743041159,
    "ts_creation_date": 1660795278,
    "ts_modification_date": 1660795278,
    "files": {
        "pdf": "https://archive.orkl.eu/420e0939118278e090f152facf24548b0f0ed039.pdf",
        "text": "https://archive.orkl.eu/420e0939118278e090f152facf24548b0f0ed039.txt",
        "img": "https://archive.orkl.eu/420e0939118278e090f152facf24548b0f0ed039.jpg"
    }
}