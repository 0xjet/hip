{
    "id": "e290204b-5962-4221-9abd-dd914bf00d1f",
    "created_at": "2023-01-12T15:06:26.688271Z",
    "updated_at": "2025-03-27T02:05:47.430896Z",
    "deleted_at": null,
    "sha1_hash": "bac34d4344e2d274b5f17c4d6e47c6884dd05822",
    "title": "2019-12-09 - Caution! Ryuk Ransomware decryptor damages larger files, even if you pay",
    "authors": "",
    "file_creation_date": "2022-05-28T04:51:12Z",
    "file_modification_date": "2022-05-28T04:51:12Z",
    "file_size": 572244,
    "plain_text": "# Caution! Ryuk Ransomware decryptor damages larger files, even if you pay\n\n**[blog.emsisoft.com/en/35023/bug-in-latest-ryuk-decryptor-may-cause-data-loss/](https://blog.emsisoft.com/en/35023/bug-in-latest-ryuk-decryptor-may-cause-data-loss/)**\n\nDecember 9, 2019\n\n[Ransomware](https://blog.emsisoft.com/en/category/malware-lab/ransomware/)\n\n[Emsisoft Malware Lab](https://blog.emsisoft.com/en/author/lab/)\nDecember 9, 2019\n3 min read\n\n\n-----\n\nRyuk has plagued the public and private sectors alike over the past years, generating\nhundreds of millions of ransom revenues for the criminals behind it. Usually deployed via an\nexisting malware infection within a target’s network, Ryuk wreaks havoc on any system that\ncan be accessed, encrypting data using a combination of RSA and AES.\n\nJust because Ryuk has been hugely successful, doesn’t mean its creators stopped evolving\nand improving it, however. So it comes to no surprise that we have seen multiple new\nfeatures added to Ryuk over the past year.\n\nOne of these features that isn’t well documented is its capability to partially encrypt files.\nEssentially, whenever Ryuk encounters a file that is larger than 57,000,000 bytes (or 54.4\nmegabytes) it will only encrypt certain parts of it in order to save time and allow it to work its\nway through the data as quickly as possible before anyone notices.\n\n\n-----\n\nThe code used by Ryuk to determine how much of a file to encrypt if the file exceeds a size limit of\n\n57,000,000 bytes\n\nFiles that are only partially encrypted will show a slightly different-than-normal footer at the\nend of the file, where Hermes usually stores the RSA-encrypted AES key that was used to\nencrypt the file’s content. In addition to the HERMES files marker used by Ryuk, you will also\nfind a clearly visible counter of how many 1,000,000 bytes blocks have been encrypted for\nthis file. If that indicator is missing, the whole file is considered to be encrypted.\n\n\n-----\n\nThe extended version of the Ryuk file footer highlighting the number of encrypted blocks for partially\n\nencrypted files\n\nIn one of the latest versions of Ryuk, changes were made to the way the length of the footer\nis calculated. As a result, the decryptor provided by the Ryuk authors will truncate files,\ncutting off one too many bytes in the process of decrypting the file. Depending on the exact\nfile type, this may or may not cause major issues. In the best-case scenario, the byte that\nwas cut off by the buggy decryptor was unused and just some slack space at the end\ncreated by aligning the file towards certain file size boundaries. However, a lot of virtual disk\ntype files like VHD/VHDX as well as a lot of database files like Oracle database files will\nstore important information in that last byte and files damaged this way will fail to load\nproperly after they are decrypted.\n\n_One of the services we provide at Emsisoft is to help ransomware victims who paid the_\n_ransom to recover their files even if the ransomware authors left them hanging by either_\n_being uncooperative or providing tools that do not do the job properly, both of which are_\n_increasingly common outcomes._\n\nSo if you are a Ryuk victim that was hit within the last two weeks and have files which will not\n[load, please contact us so we can provide you with a properly working decryptor. Please](https://blog.emsisoft.com/cdn-cgi/l/email-protection#cab8b3bfa1a2afa6ba8aafa7b9a3b9a5acbee4a9a5a7)\nunderstand that this will only work if you still have copies or backups of your encrypted data,\nas the Ryuk decryptor will usually delete files it thinks were decrypted properly. Similarly, if\nyou’ve paid for a decryptor but have yet to use it, either back up your files before running it or\nget in touch with us instead. Our tool will enable you to safely recover your data whereas the\ntool supplied by the bad actors will not.\n\nNote our decryption tool does not remove the need for ransoms to be paid; it is simply a\nreplacement for the criminal-supplied tool.\n\n## Download now: Emsisoft Anti-Malware free trial.\n\nAntivirus software from the world’s leading ransomware experts. Get your free trial today. Try\nIt Now\nA final word of advice: prior to running any ransomware decryptor – whether it was supplied\nby a bad actor or by a security company – be sure to back up the encrypted data first.\nShould the tool not work as expected, you’ll be able to try again.\n\n## Emsisoft Malware Lab\n\n\n-----\n\nThe Lab team is a group of cybersecurity researchers whose mission is to enhance\nprotection in Emsisoft products, help organizations respond to security incidents and create\nanalysis that helps decision-makers understand the threat landscape.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-12-09 - Caution! Ryuk Ransomware decryptor damages larger files, even if you pay.pdf"
    ],
    "report_names": [
        "2019-12-09 - Caution! Ryuk Ransomware decryptor damages larger files, even if you pay.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535986,
    "ts_updated_at": 1743041147,
    "ts_creation_date": 1653713472,
    "ts_modification_date": 1653713472,
    "files": {
        "pdf": "https://archive.orkl.eu/bac34d4344e2d274b5f17c4d6e47c6884dd05822.pdf",
        "text": "https://archive.orkl.eu/bac34d4344e2d274b5f17c4d6e47c6884dd05822.txt",
        "img": "https://archive.orkl.eu/bac34d4344e2d274b5f17c4d6e47c6884dd05822.jpg"
    }
}