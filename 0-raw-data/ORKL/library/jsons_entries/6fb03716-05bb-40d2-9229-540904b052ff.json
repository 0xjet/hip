{
    "id": "6fb03716-05bb-40d2-9229-540904b052ff",
    "created_at": "2023-01-12T15:00:15.156532Z",
    "updated_at": "2025-03-27T02:10:49.330253Z",
    "deleted_at": null,
    "sha1_hash": "ab7c5aed38bf67ce249bd52bf7fef8858d27d330",
    "title": "2020-01-25 - Olympic Ticket Reseller Magecart Infection",
    "authors": "",
    "file_creation_date": "2022-05-28T17:37:38Z",
    "file_modification_date": "2022-05-28T17:37:38Z",
    "file_size": 477528,
    "plain_text": "# Olympic Ticket Reseller Magecart Infection\n\n**goggleheadedhacker.com/blog/post/14**\n\nJacob Pimental January 25, 2020\n\n### 25 January 2020\n\nI have recently stumbled across a Magecart infection on an olympic ticket reseller site. This\narticle will contain a brief analysis on the Magecart infection as well as my experience\ndisclosing this information to the company. This is a joint analysis with Max Kersten, whose\n[blog you can find here.](https://maxkersten.nl/)\n\n## Initial Analysis\n\nThe initial infection can be found at https://olympictickets2020[.]com/dist/slippry.min.js. This\nappears to be the legitimate slippry.js library along with extra obfuscated javascript appended\nto the end of the file. The malicious code begins at the declaration of function bAQ.\n\n\n-----\n\nThe function itself appends data to the variable C46, which is then deobfuscated and append\nto the variable ih3. The easiest way to get the second stage payload would be to run the\ncode inside the function in your browser’s developer console and print out the value of ih3\nwith the toString function.\n\nFrom here the obfuscation is fairly simple. You can unminimize the JavaScript using a site\n[like https://beautifier.io. Then we can just insert values into our javascript console and](https://beautifier.io/)\nreplace the obfuscated data with the result. Max Kersten has a great analysis of how the\n[obfuscation works on his blog here. This script is not much different that the one in his](https://maxkersten.nl/binary-analysis-course/malware-analysis/magecart/)\narticle. After deobfuscation we can see that the script looks for the keywords:\n\nonepage\ncheckout\nstore\ncart\npay\npanier\nkasse\norder\nbilling\npurchase\nbasket\n\nIf it finds any of those keywords in the website, it will send the information in the credit card\nform to opendoorcdn[.]com.\n\n## Disclosure\n\n[Before going public about the infection, Max and I decided to tweet at the company urging](https://twitter.com/LibraAnalysis/status/1218315924127789056)\nthem to get in touch with us. We also sent an e-mail to their customer support with the same\ninformation. The following Monday, Max decided to use the chat feature on their site to try to\nget in contact with their security team, since we hadn’t heard anything back. At first they did\nnot find the malicious code and closed Max’s ticket.\n\n\n-----\n\nAfter the ticket was closed, I decided to give them a call. I provided more detail as to what\nthe infection was along with where they could find the malicious code. The support on the\nother line told me that they would pass along this information to their security team and they\nwould contact me with the result.\n\nAround noon on January 21st, Eastern Time, Max and I noticed that the malicious script was\ntaken down, meaning they listened to our suggestions and were able to remove the\nmalicious code from the site. The script now leads to a 404 page.\n\n## Extent\n\nDigging into the extent of the infection, Max and I found that the company’s other site,\neurotickets2020.com is also compromised with the same variant of Magecart. This can be\nfound by searching for the hash via UrlScan.\n\nThe furthest date back this was scanned was 2 months ago according to UrlScan, so it is\nunclear exactly how long the malicious code has been on their site. Max also took a look at\nthe URL using the Wayback Machine and found the skimmer indexed on December 3rd,\n[2019. The URL for the eurotickets site can be seen dated back to January 7th, 2020. This is](https://web.archive.org/web/20200107205951/https://www.eurotickets2020.com/dist/%20%20%20%20slippry.min.js)\ngives us a rough estimate that the code may have been on the site for 50 days, but it is\nalways possible that it was there longer.\n\n## Conclusion\n\nIf you have purchased tickets from olympictickets2020.com or eurotickets2020.com in the\nlast 50 days I would suggest you contact your bank as your credit card information may be\ncompromised. I would also like to thank Max Kersten for helping me with this analysis! If you\n[have any comments or questions about feel free to reach out to me on my Twitter or](https://twitter.com/Jacob_Pimental)\n[LinkedIn.](https://www.linkedin.com/in/JacobPimental/)\n\nThanks for reading and happy reversing!\n\n**Malware Analysis, Magecart, Skimmer, JavaScript**\n\n\n-----\n\n## More Content Like This:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-25 - Olympic Ticket Reseller Magecart Infection.pdf"
    ],
    "report_names": [
        "2020-01-25 - Olympic Ticket Reseller Magecart Infection.pdf"
    ],
    "threat_actors": [
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535615,
    "ts_updated_at": 1743041449,
    "ts_creation_date": 1653759458,
    "ts_modification_date": 1653759458,
    "files": {
        "pdf": "https://archive.orkl.eu/ab7c5aed38bf67ce249bd52bf7fef8858d27d330.pdf",
        "text": "https://archive.orkl.eu/ab7c5aed38bf67ce249bd52bf7fef8858d27d330.txt",
        "img": "https://archive.orkl.eu/ab7c5aed38bf67ce249bd52bf7fef8858d27d330.jpg"
    }
}