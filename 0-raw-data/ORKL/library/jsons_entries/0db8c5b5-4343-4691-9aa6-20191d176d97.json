{
    "id": "0db8c5b5-4343-4691-9aa6-20191d176d97",
    "created_at": "2023-01-12T15:02:41.002176Z",
    "updated_at": "2025-03-27T02:05:24.530766Z",
    "deleted_at": null,
    "sha1_hash": "4477713fc0b0d1225a12d759860fca1b920a35cd",
    "title": "2015-01-08 - Getmypass Point of Sale Malware Update",
    "authors": "",
    "file_creation_date": "2022-10-02T12:11:02Z",
    "file_modification_date": "2022-10-02T12:11:02Z",
    "file_size": 336399,
    "plain_text": "# securitykitten.github.io/_posts/2015-01-08-getmypass- point-of-sale-malware-update.md\n\n**github.com/malware-kitten/securitykitten.github.io/blob/master/_posts/2015-01-08-getmypass-point-of-sale-malware-**\nupdate.md\n\nmalware-kitten\n\n**layout** **title** **excerpt** **date**\n\n\ncategorypost\n\n\nGetmypass Point of\nSale Malware Update\n\n\nNow featuring small\nimprovements!\n\n\n2015-01-08\n11:38:48 -0500\n\n\n## Introduction\n\nI previously wrote about a new piece of malware called \"getmypass\" that was\nscoring 0/55 on Virustotal. The malware had an active digital signature and was\nable to successfully dump track data from a given process.\n\nAt CBTS, one thing that I frequently do is track malware families and try to\ntrace them back to their infancy. It was interesting to me that another copy of\nthis malware has now been uncovered and it has seen a small update. Not only\nis the author still writing code for getmypass, but it's now getting updated to\nenforce better opsec. Let's take a look.\n\n\n-----\n\n## Encryption by Default\n\nThe first change in the malware is evident in the start function. In the older\nversion of getmypass, it would look for the 1.ini file and check for the following\noptions:\n\ntime\nproc\ncryp\n\nA screenshot of the old function:\n\nIn the new function, there is no longer an option for cryp, and the malware is\nprogrammed to encrypt the results by default.\n\n\n-----\n\nThe RC4 password is still unchanged and remains \"getmypass\". The function\npassing the trackdata is seen below.\n\nThe resulting encrypted data is written to a file rep.bin.\n\nWith a simple ruby script we can validate this RC4 routine and decrypt the\ncontents.\n\n{% highlight ruby %}\n{% raw %}\n\n#!/usr/bin/ruby1.9.1\nrequire 'rc4'\nrequire \"base64\"\n\n\n-----\n\nf = File.new( rep.bin, rb )\ndecode = f.read()\nf.close\nkey = getmypass\ndec =\nRC4.new(key)\nputs dec.decrypt(decode)\n\n{% endraw %}\n{% endhighlight %}\n\nAnd the decode:\n\n{% highlight bash %}\n{% raw %}\n\n$ ./rc4_decode.rb\n%B4888603170607238^Head/Potato^050510100000000001203191805191000000?\n;4888603170607238=05051011203191805191?\n\n{% endraw %}\n{% endhighlight %}\n\n## Support for Multiple Exfil Files\n\nOlder copies of getmypass would write to rep.bin file. This was the only output\nfile and if there were multiple runs, the file would be overwritten.\n\nThe newer version now will move the file rep.bin to a backup file marked by the\nresulting value of GetTickCount.\n\nThe backed up file:\n\n## Conclusion\n\n\n-----\n\nEncryption by default will now also help this malware evade tools that scour\nhard drives looking for structures that resemble track data. The support for\nmultiple backup files will also enable the operators to move quickly. With the\nolder copy, the malware authors used to have to dump processes and then\nbackup the results file. Now they can edit the configuration file on the fly and\nthe results get stored into a secondary file. Less clicks, less movement.\n\nWhile these aren't groundbreaking changes, it's small changes like these that\nadd up to make the malware operators more efficient and successful.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-01-08 - Getmypass Point of Sale Malware Update.pdf"
    ],
    "report_names": [
        "2015-01-08 - Getmypass Point of Sale Malware Update.pdf"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535761,
    "ts_updated_at": 1743041124,
    "ts_creation_date": 1664712662,
    "ts_modification_date": 1664712662,
    "files": {
        "pdf": "https://archive.orkl.eu/4477713fc0b0d1225a12d759860fca1b920a35cd.pdf",
        "text": "https://archive.orkl.eu/4477713fc0b0d1225a12d759860fca1b920a35cd.txt",
        "img": "https://archive.orkl.eu/4477713fc0b0d1225a12d759860fca1b920a35cd.jpg"
    }
}