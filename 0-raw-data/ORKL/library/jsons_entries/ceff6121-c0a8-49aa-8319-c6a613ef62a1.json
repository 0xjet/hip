{
    "id": "ceff6121-c0a8-49aa-8319-c6a613ef62a1",
    "created_at": "2022-10-25T16:48:16.466018Z",
    "updated_at": "2025-03-27T02:16:14.169952Z",
    "deleted_at": null,
    "sha1_hash": "ae3f5f3ef2ca2f5e90c1909b47566255452291ed",
    "title": "New MuddyWater Activities Uncovered:",
    "authors": "",
    "file_creation_date": "2019-06-10T17:30:52Z",
    "file_modification_date": "2019-06-10T17:30:52Z",
    "file_size": 1132195,
    "plain_text": "New MuddyWater Activities Uncovered:Threat Actors Used Multi-Stage Backdoors, New Post-Exploitation Tools, Android Malware, and MoreDaniel Lunghi and Jaromir Horejsi\n\n\n-----\n\n## New findings on MuddyWater's old and recent activities \n\nWe came across new campaigns that seem to bear the markings of MuddyWater – a threat actor group\nwith a history of targeting organizations in Middle Eastern and Asian countries. The group used new tools\nand payloads in campaigns over the first half of 2019, pointing to the continued work the group has put in\n[since our last report on MuddyWater in November 2018.](https://blog.trendmicro.com/trendlabs-security-intelligence/new-powershell-based-backdoor-found-in-turkey-strikingly-similar-to-muddywater-tools/)\n\nApart from discovering new campaigns related to MuddyWater, we also uncovered crucial information\nrelated to the group’s old and recent activities. These include findings on the threat actor group’s\nconnection to some Android malware variants, its use of false flags to misattribute campaigns to certain\ncountries, its infrastructure, and its target countries and industries. We will also share our independent\nfindings regarding certain information about the threat actor group’s operations, which was leaked on\nTelegram in April 2019.\n\n1\n\n\n-----\n\n# Threat actors found using POWERSTATS V3 – a multi- stage backdoor\n\nIn one of the MuddyWater campaigns we spotted, we detected spear-phishing emails that the group sent\nto a university in Jordan and the Turkish government. In both cases, the threat actor group did not spoof\nthe said legitimate entities’ sender address to deceive email recipients, but instead used compromised\nlegitimate accounts to trick users into installing malware.\n\nFigure 1. Screenshot of a spear-phishing email spoofing a government office, dated April 8, 2019.\n\nFigure 2. Email headers showing the origin of the spear-phishing email\n\nThe legitimate owners of the compromised email accounts were from the same countries the target\nentities are based. As of this writing, it’s unclear how they were compromised, but it’s possible that the\ngroup had used the Gophish toolkit since they have already utilized it in an old campaign.\n\n2\n\n\n-----\n\nThe threat actor group deployed a new multi-stage PowerShell-based backdoor called POWERSTATS v3.\nThe spear-phishing email that contains a document embedded with a malicious macro will drop a VBE file\nencoded with Microsoft Script Encoder. The VBE file, which holds a base64-encoded block of data\ncontaining obfuscated PowerShell script, will then execute. This block of data will be decoded and saved\nto the %PUBLIC% directory under various names ending with image file extensions such as .jpeg\nand .png. The PowerShell code will then use custom string obfuscation and lots of useless blocks of code\nto make it difficult to analyze.\n\nFigure 3. Code snippet of obfuscated and useless code\n\nThe final backdoor code will be shown after the deobfuscation of all strings and removal of all\nunnecessary code. But first, the backdoor will acquire the operating system (OS) information and save\nthe result to a log file.\n\nFigure 4. Code snippet of OS information collection\n\nThis file will be uploaded later to the command and control (C&C) server. Each victim machine will\ngenerate a random GUID number, which will be used for machine identification. Later on, the malware\nvariant will start the endless loop, querying for the GUID-named file in a certain folder on the C&C server.\nIf the file is found, it will be downloaded and executed using the Powershell.exe process.\n\nThe threat actor group can then proceed to a second stage attack by sending commands to a specific\nvictim in an asynchronous way. In essence, they can download another backdoor payload from the C&C\nserver and install it on their targets' systems.\n\nFigure 5. The code in POWERSTATS v3 that downloads the second attack stage\n\n3\n\n\n-----\n\nWe were able to look into an instance where the group proceeded to launch a second stage attack. In this\nscenario, another backdoor was downloaded. The backdoor supports the following commands:\n\n#####  Take screenshots\n  Command execution via the cmd.exe binary\n  If there’s no keyword, the malware variant assumes that the input is PowerShell code and executes it via the “Invoke-Expression” cmdlet\n\nFigure 6. The code in POWERSTATS v3 (second stage) that handles the screenshot command\n\nThe C&C communication is done using PHP scripts with a hardcoded token and a set of backend\nfunctions, e.g., sc (screenshot), res (result of executed command), reg (register new victim), and uDel\n(self-delete after an error).\n\nFigure 7. In an endless loop, the malware variant queries a given path on C&C server, trying to download a\n\nGUID-named file with commands to execute.\n\n4\n\n\n-----\n\n# Other MuddyWater campaigns that used different payloads and tools\n\nSince 2018, the threat actors behind MuddyWater have been actively targeting victims using a variety of\nmethods and techniques, and they seem to keep on adding more as they move forward with new\ncampaigns.\n\nThe abovementioned campaign that used POWERSTATS v3 is not the only one we found using new\ntricks. We observed other campaigns with different delivery methods and dropped file types. Notably,\nthese campaigns have also changed payloads and publicly available post-exploitation tools.\n\n### Payload changes\n\n**Method for dropping** **Type of files**\n**Discovery date** **Final payload**\n\n##### malicious code dropped\n\n2018-03 Macros SCT, INF, base52 POWERSTATS\n\n##### encoded\n\n2018-11 Macros VBS, JS, base52 POWERSTATS\n\n##### encoded\n\n2018-11 Macros DLL, REG CLOUDSTATS\n\n2019-01 Macros EXE SHARPSTATS\n\n2019-01 Macros INF, EXE DELPHSTATS\n\n2019-03 Macros Base64 encoded, POWERSTATS v2\n\n##### BAT\n\n2019-04 Template injection Document with POWERSTATS v1 or v2\n\n##### macros\n\n2019-05 Macros VBE POWERSTATS v3\n\nTable 1. The evolution of MuddyWater’s delivery methods and payloads since 2018\n\n[One of the said custom tools was POWERSTATS,](https://unit42.paloaltonetworks.com/unit42-muddying-the-water-targeted-attacks-in-the-middle-east/) a PowerShell-based backdoor that the group first used\nin 2017. Another one is CLOUDSTATS, a PowerShell-based backdoor that uses a cloud file hosting\nprovider for its command and control (C&C) communication. We discussed the use of CLOUDSTATS in a\nprevious report.\n\nIn January 2019, we discovered that the campaign started using SHARPSTATS, a .NET-written backdoor\nthat supports DOWNLOAD, UPLOAD, and RUN functions. In the same month, DELPHSTATS emerged.\nThis backdoor is written in the Delphi programming language, and queries the C&C server for a .dat file\nbefore executing it via the Powershell.exe process. Similar to the SHARPSTATS backdoor,\nDELPHSTATS employs custom PowerShell script with code similarities to the one embedded into the\nSHARPSTATS backdoor. A campaign that dropped this variant was thoroughly discussed in this report.\n\n5\n\n|Discovery date|Method for dropping malicious code|Type of files dropped|Final payload|\n|---|---|---|---|\n|2018-03|Macros|SCT, INF, base52 encoded|POWERSTATS|\n|2018-11|Macros|VBS, JS, base52 encoded|POWERSTATS|\n|2018-11|Macros|DLL, REG|CLOUDSTATS|\n|2019-01|Macros|EXE|SHARPSTATS|\n|2019-01|Macros|INF, EXE|DELPHSTATS|\n|2019-03|Macros|Base64 encoded, BAT|POWERSTATS v2|\n|2019-04|Template injection|Document with macros|POWERSTATS v1 or v2|\n|2019-05|Macros|VBE|POWERSTATS v3|\n\n\n-----\n\nFigure 8. SHARPSTATS can be used to collect system information by dropping and executing a PowerShell\n\nscript.\n\nFigure 9. The code in DELPHSTATS that queries a certain directory on the C&C server. It’s where operators\n\nupload additional payload.\n\nIn mid-March 2019, we came across POWERSTATS v2, a heavily obfuscated backdoor. An earlier\nversion of this backdoor decodes the initial encoded/compressed blocks of code. An improved version\nappeared later on, and we saw that it heavily uses format strings and redundant backtick characters. In\nthe earlier version, function names were still somehow readable, but they were completely randomized in\nlater versions.\n\n6\n\n\n-----\n\nFigure 10. Obfuscated POWERSTATS v2\n\nAfter deobfuscation, the main backdoor loop queries different URLs for a “Hello server” message to\nobtain command and upload the result of the run command to the C&C server.\n\nFigure 11. Deobfuscated main loop of POWERSTATS v2\n\n7\n\n\n-----\n\n### Use of different post-exploitation tools\n\nSince the emergence of MuddyWater, we found that its operators used multiple open source postexploitation tools, which they deployed after successfully compromising a target.\n\n**Name of the post-exploitation** **tool** **Programming language/Interpreter**\n\n[CrackMapExec](https://github.com/byt3bl33d3r/CrackMapExec) Python, PyInstaller\n\n[ChromeCookiesView](https://www.nirsoft.net/utils/chrome_cookies_view.html) Executable file\n\n[chrome-passwords](https://github.com/adnan-alhomssi/chrome-passwords) Executable file\n\n[EmpireProject](https://github.com/EmpireProject) PowerShell, Python\n\n[FruityC2](https://github.com/xtr4nge/FruityC2) PowerShell\n\n[Koadic](https://github.com/zerosum0x0/koadic) JavaScript\n\n[LaZagne](https://github.com/AlessandroZ/LaZagne) Python, PyInstaller\n\n[Meterpreter](https://www.offensive-security.com/metasploit-unleashed/about-meterpreter/) [Reflective loader, executable file](https://github.com/stephenfewer/ReflectiveDLLInjection)\n\n[Mimikatz](https://github.com/gentilkiwi/mimikatz) Executable file\n\n[MZCookiesView](https://www.nirsoft.net/utils/mzcv.html) Executable file\n\n[PowerSploit](https://github.com/PowerShellMafia/PowerSploit) PowerShell\n\n[Shootback](https://github.com/aploium/shootback) Python, PyInstaller\n\n[Smbmap](https://github.com/ShawnDEvans/smbmap) Python, PyInstaller\n\nTable 2. Tools used by MuddyWater campaigns over the years\n\nOne of the campaigns we uncovered notably delivered the EmpireProject stager via a scheme that\n[involves the use of template injection and the abuse of the CVE-2017-11882 vulnerability. If the email](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11882)\nrecipient clicks on a malicious document, a remote template is downloaded, which will trigger the\nexploitation of CVE-2017-11882. This will then lead to the execution the EmpireProject stager.\n\nFigure 12. Clicking on the malicious document leads to the abuse of CVE-2017-11882, and then the execution of\n\nthe EmpireProject stager.\n\nWe also saw the LaZagne credential dumper being patched to drop and run POWERSTATS in the main\nfunction.\n\n8\n\n|Name of the post-exploitation tool|Programming language/Interpreter|\n|---|---|\n|CrackMapExec|Python, PyInstaller|\n|ChromeCookiesView|Executable file|\n|chrome-passwords|Executable file|\n|EmpireProject|PowerShell, Python|\n|FruityC2|PowerShell|\n|Koadic|JavaScript|\n|LaZagne|Python, PyInstaller|\n|Meterpreter|Reflective loader, executable file|\n|Mimikatz|Executable file|\n|MZCookiesView|Executable file|\n|PowerSploit|PowerShell|\n|Shootback|Python, PyInstaller|\n|Smbmap|Python, PyInstaller|\n\n\n-----\n\nFigure 13. LaZagne has been patched to drop and run POWERSTATS in the main function. See added\n\n_intimoddumpers() function. Note the typo in the function name (using INTI, not INIT)._\n\n\n9\n\n\n-----\n\n# Connections to Android malware variants\n\nIn addition to uncovering new campaigns, we were also able to find connections between MuddyWater\nand four Android malware variants that posed as legitimate applications. We were able to establish proof\nof connection through their shared infrastructure, e.g., IP addresses and C&C servers, and the code\nsimilarities between some of the malware families.\n\nWe first noticed the first Android malware variant (AndroidOS_Mudwater.HRX) when we discovered that\nits IP address and C&C server, 78[.]129[.]139[.]131, was used as the final C&C server of a MuddyWater\ncampaign. In the said campaign, we saw victims receiving commands for downloading a second stage\npayload from the abovementioned IP address.\n\nApart from custom stealing capabilities, AndroidOS_Mudwater.HRX has two other interesting features:\n\n  - Brute forces hardcoded IP addresses (with a list of usernames and passwords).\n\n  - Spreads malicious apps by sending all contacts an SMS (in Turkish) containing a link to the\nmalicious APK. The link points to an APK in the directory tree of a legitimate website belonging to\na non-profit research organization in Turkey. Most likely, the organization’s website was\ncompromised, which is not surprising as its website was hosted on WordPress, a platform\nMuddyWater is fond of targeting.\n\nFigure 14. List of commands supported by the newer version of the malicious app\n\nWe found a connection between AndroidOS_Mudwater.HRX and the second malware variant\n(AndroidOS_HiddenApp.SAB) based on similarities in their code structure. The figure below shows these\nsimilarities.\n\n10\n\n\n-----\n\nFigure 15. List of commands supported by the older version of the malicious app\n\nThe second malware variant is a custom stealer that implements features for stealing call logs, contacts,\nSMS messages, phone information, and screenshots. It posts all stolen data to a Telegram channel. Like\nthe previously mentioned variant, we found hints in the file that shows that it might be a test version.\n\nWe then discovered shared signed certificates that connect AndroidOS_HiddenApp.SAB and the third\nmalware variant (AndroidOS_Androrat.AXM). Its C&C server is a local IP address, which led us to think\nthat our detected sample is a test version.\n\nMeanwhile, we saw the connection of Droidjack RAT — the fourth malware variant\n(AndroidOS_Androrat.AXMA) — to MuddyWater in the domain name of the former’s C&C server\n(googleads[.]hopto[.]org), which shares C&C servers with some DELPHSTATS samples that we analyzed.\nA Droidjack RAT variant is a remote access trojan that [allows](https://blog.trendmicro.com/malware-gotta-catch-em-all/) attackers to take full control of an Android\ndevice when installed.\n\n### Potential targets\n\nWhile we can’t say for sure who or what entities the four Android malware variants were specifically\ntargeting, our analysis of the indicators of compromise (IoCs ) provided us with clues on the targets'\nlocations.\n\nIt likely targets users in Turkey, because the campaign used a malicious app that was hosted in a\ncompromised Turkish website. The campaign also spread an SMS written in the Turkish language to lure\nusers into downloading a malicious app.\n\nPakistan could be another target location: Some target IP addresses that were hardcoded in the brute\nforce functions of some samples were traced back to Pakistan.\n\nAfghanistan is another potential target location as the file name of one of the malicious applications we\nanalyzed was “AfghanistanElection.apk.”\n\n11\n\n\n-----\n\n# Use of false flag techniques\n\nSome of the tools used by MuddyWater campaigns contained false flags, which are messages that threat\nactors add into their programs to misattribute the campaign to a specific country. This technique was\ndiscussed recently by other researchers.\n\nHere are some false flags we spotted:\n\nFigure 16. Several older POWERSTATS backdoors contained simplified Chinese text like “无法连接到网址，请\n```\n       等待龙,” which translates to “Unable to connect to the URL, please wait for the dragon.“ \n\n```\nFigure 17. The dragon reference also manifested in this dragon variable.\n\nFigure 18. Some PowerSTATS backdoors were compiled with the PS2EXE tool to .EXE files. These contained\n\nfalse flags, which are famous quotes of well-known people in Israel.\n\nThe translation of the two sets of text above are as follows: ”$god = \"If the Arabs put down their weapons\ntoday, there will be no more violence ... If the Jews put down their arms today, there will be no more\nIsrael\" and “$SKey = \"he will raise the people and confirm that his word and law are standing\". Note that\nthese variables were not used in the rest of the code.\n\n12\n\n\n-----\n\nFigure 19. These false flags try to misattribute an attack to Russia or a country that uses the Cyrillic alphabet.\n\nRussian texts appeared in the metadata of some delivery documents and in a debug path of one DLL library.\n\n\n13\n\n\n-----\n\n# MuddyWater-related information leaked on Telegram\n\nIn April, details related to the alleged operations of the threat actor group behind MuddyWater were\n[leaked](https://medium.com/cyber-journal/iranian-cyber-espionage-operations-exposed-via-telegram-channels-and-dark-web-websites-d8d190ee5404) on Telegram. The leaks contained images of the group’s C&C backends, source code, and a list\nof past hacked victims.\n\nOur monitoring efforts uncovered evidence that communication transpired between some victims (that\nwere listed in the leak) and a C&C server known to be from MuddyWater.\n\nIndependently, we also spotted two versions of the server backend, which contains code similar to the\ndetails leaked on Telegram.\n\nThe code is a simple script written in Python, and encapsulated with PyInstaller. It will read a\nconfiguration file to find which IP address and port to listen to, and it will display some commands\navailable to the operator.\n\nThe script displays two different ASCII art for two versions.\n\nFigure 20. ASCII art for version 1.0.0, compiled on July 31, 2017\n\nFigure 21. ASCII art for version 1.0.1, compiled on September 4, 2018.\n\nBased on these findings, we speculate that the leaks were based on real data.\n\n14\n\n\n-----\n\nThe leak also included information regarding a certain individual. While we cannot confirm its veracity, we\nnoticed that a document with MuddyWater code has been posted to VirusTotal prior to the leak, and its\nfilename is similar to the name of the individual mentioned in the leak.\n\n15\n\n\n-----\n\n# Infrastructure and targets\n\nFor the most part, the threat actor group used direct IP addresses as C&C servers and a few domain\nnames (dynamic or not). In 2018, the group mostly used compromised WordPress websites as proxies to\nsend commands that were forwarded to the final C&C servers.\n\nFigure 22. Communication flow between the operator and the victim\n\nWe noticed that the said C&C servers were usually set up to listen to an uncommon port, and were shut\ndown a few hours later. The next time the servers were up, they usually listened on a different port.\n\nAs mentioned in our previous research, most targets were located in Middle Eastern and Asian countries.\nRecently, we saw the group aiming for new targets in Europe. The figure below shows the target\ncountries of MuddyWater campaigns. We included the United States, and some European countries,\nbased on verified information from the leaks.\n\nFigure 23. Countries that MuddyWater has targeted\n\nMost victims were government entities, with the majority in the finance, education, foreign affairs, interior,\ndefense, trade, and customs sectors. We also found many victims in the telecommunications industry\nsuch as telcos and web hosting providers.\n\n16\n\n\n-----\n\nFigure 24. Industries that MuddyWater has targeted\n\n\n17\n\n\n-----\n\n# Conclusion\n\nAside from the abovementioned findings, we also found Twitter and Github accounts that we believe are\n[linked to MuddyWater. Researchers have made similar findings](https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group) in the past. This discovery, as well as the\nexposure of their operations to the public due to the leak, shows that the threat actor group has poor\noperational security and lack diligence in covering their tracks.\n\nHowever, the group also appears to be agile. One week after we published our November 2018 report on\ntheir use of base52 encoding, we found out that they modified the alphabet from 52 characters to 40, 45,\nand 48. In our opinion, this action is a result of our disclosure of their activities.\n\nWhile MuddyWater appears to have no access to zero-days and advanced malware variants, it still\nmanaged to be successful in compromising its targets over the last two years. This can be attributed to\nthe continuous evolution of their schemes.\n\nNotably, the group’s use of email as an infection vector seems to have worked for their campaigns. In this\nregard, apart from using smart email security solutions, organizations should inform their employees of\nways to stay protected from email threats to remove any security holes that they can exploit.\n\n18\n\n\n-----\n\n#### Indicators of Compromise (IoCs)\n\n\nSHA-256s\n\n\n4d72dcd33379fe7a34f9618e692f659fa9d318ab623168cd351c18ca3a805af1\n\n7e7b6923f3e2ee919d1ea1c8f8d9a915c52392bd6f9ab515e4eb95fa42355991\n\n1dae45ea1f644c0a8e10c962d75fca1cedcfd39a88acef63869b7a5990c1c60b\n\n3deaa4072da43185d4213a38403383b7cefe92524b69ce4e7884a3ddc0903f6b\n\n36ccae4dffc70249c79cd3156de1cd238af8f7a3e47dc90a1c33476cf97a77b0\n\n9389cf41e89a51860f918f29b55e34b5643264c990fe54273ffbbf5336a35a45\n\ndab2cd3ddfe29a89b3d80830c6a4950952a44b6c97a664f1e9c182318ae5f4da\n\n200c3d027b2d348b0633f8debbbab9f3efc465617727df9e3fdfa6ceac7d191b\n\n98f0f2c42f703bfbb96de87367866c3cced76d5a8812c4cbc18a2be3da382c95\n\n20bf83bf516b12d991d38fdc014add8ad5db03907a55303f02d913db261393a9\n\nf5ef4a45e19da1b94c684a6c6d51b86aec622562c45d67cb5aab554f21eb9061\n\nff349c8bf770ba09d3f9830e22ab6306c022f4bc1beb193b3b2cfe044f9d617b\n\n95c650a540ed5385bd1caff45ba06ff90dc0773d744efc4c2e4b29dda102fcce\n\n6be18e3afeec482c79c9dea119d11d9c1598f59a260156ee54f12c4d914aed8f\n\n3c0c58d4b9eefea56e2f7be3f07cdb73e659b4db688bfbf9eacd96ba5ab2dfe5\n\n745b0e0793fc507d9e1ad7155beb7ac48f8a556e6ef06e43888cbefec3083f2f\n\n9580aaca2e0cd607eaf54c3eb933e41538dc10cd341d41e3daa9185b2a6341c4\n\n0ae4ce8c511a22da99c6edc4be86af1c5d3a7d2baf1e862925a503d8baae9fd7\n\nc19095433ac4884d3205a59e61c90752ecb4e4fa6a84e21f49ed82d9ec48aa3c\n\n264f2ea4a8fad97e66d5ad41a57517b4645fe4c4959d55370919379b844b0750\n\n36be54812428b4967c3d25aafdc703567b42ad4536c089aefaef673ce36a958f\n\n9112505ff574b43dd27efc8afcf029841e1ea5193db90424b8b8b6b0e53c3437\n\nd77d16c310cce09b872c91ca223b106f4b56572242ff5c4e756572070fac210f\n\nd5b7a5ae4156676b37543a3183df497367429ae2d01ef33ebc357c4bdd9864c3\n\nc63f1d364b9fa2c1023ce5a1b5fed12e1eba780c64276811c4b47743dfcbadbd\n\n0e7e3c2c7fe34afc02c6e672ae00bc4e432b300ec184dec08440fba91b664999\n\n88e02850c575504bb4476f0d519cec8e6a562b72d17ed50b9d465d8e0de50093\n\n67c3c5af27d19f25bc55c8e36ef19b57c03b211ce0637055721ae4b0e57011a7\n\n5194f84cc52093bb4978167a9f2d5c0903e9de0b81ca20f492e4fc78b6a77655\n\n3e6d39886d76ab3c08b26feae075e01e9fb3c90795fa52dd6c74e4ef8b590fe8\n\n525ba2c8d35f6972ac8fcec8081ae35f6fe8119500be20a4113900fe57d6a0de\n\n\n19\n\n\n-----\n\n5d3d5fa9c6ffa64b2af0c5ce357cb6a16085280d32eb321d679b57472ffb1019\n\n6ccb3882c516fafc54444e09f5c60738831292be0231939bec9168a0203e01bb\n\nc175b2e9f0d73db293ca061ce95cdd92a423348aa162b14c158d97e9e7c3ff10\n\n66733fe27591347f6b28bc7750ba1b47b2853f711adcdb1270951c6b92e795d6\n\nfbd63941a25253f5bafe69c9cc86c7effc6ff14b9adddd6f69e2f26ed39a77a4\n\nFigure 25. Malicious Word documents\n\n\nSHA-256s\n\n\n2ba871586176522fe75333e834c16025b01e1771e4c07bc13995adbfa77c45f5\n\n6a441b2303aeb38309bf2cb70f1c97213b0fa2cf7a0f0f8251fe6dc9965ada3b\n\nd698c1d492332f312487e027d0665970b0462aceeeba3c91e762cff8579e7f72\n\n99e9a816e6b3fe7868b9c535ed13028f41089e0275eba1ba46ae7a62a7e47668\n\n6a441b2303aeb38309bf2cb70f1c97213b0fa2cf7a0f0f8251fe6dc9965ada3b\n\nd698c1d492332f312487e027d0665970b0462aceeeba3c91e762cff8579e7f72\n\nFigure 26. Compressed weaponized documents\n\n\nSHA-256s\n\n\n##### df1bd693c11893c5259c591dceef707aa0480ef5626529f8a5b0ef826e5c0dec\n\n 4ba618c04cbdc47de2ab5f2c91f466bc42163fd541de80ab8b5e50f687bbb91c\n\n e241b152e3f672434636c527ae0ebbd08c777f488020c98efce8b324486335c5\n\n df1bd693c11893c5259c591dceef707aa0480ef5626529f8a5b0ef826e5c0dec\n\nFigure 27. POWERSTATS encoded with PS2EXE tool\n\n\nSHA-256s\n\n\n6b4d271a48d118843aee3dee4481fa2930732ed7075db3241a8991418f00d92b\n\n02f54da6c6f2f87ff7b713d46e058dedac1cedabd693643bb7f6dfe994b2105d\n\n9af8a93519d22ed04ffb9ccf6861c9df1b77dc5d22e0aeaff4a582dbf8660ba6\n\ndff2e39b2e008ea89a3d6b36dcd9b8c927fb501d60c1ad5a52ed1ffe225da2e2\n\n26de4265303491bed1424d85b263481ac153c2b3513f9ee48ffb42c12312ac43\n\n3bfec096c4837d1e6485fe0ae0ea6f1c0b44edc611d4f2204cc9cf73c985cbc2\n5dbf6e347164d580665208b2bc04756857529121fd1c7861e84f18e8a6027924\n\n\n20\n\n\n-----\n\ne9617764411603ddd4e7f39603a4bdaf602e20126608b3717b1f6fcae60981f2\n\nbe9fb556a3c7aef0329e768d7f903e7dd42a821abc663e11fb637ce33b007087\n\nde4a1622b498c1cc989be1a1480a23f4c4e9cd25e729a329cfadb7594c714358\n\nFigure 27. Android malware\n\n\nSHA-256s\n\n\nc2c2adecff2e517395571f4f9bee3b8cffed4521a8e1a3e3b363fd5e635f2eee\n\nb2242bc51ebe2c3abc5a8691546827070540db43843b8328bdb81f450cd1254b\n\na4f9509e865d0a387cb8f0367e35ffd259b193f5270aacb67cb99942071c60cc\n\nFigure 27. Executable files\n\n\nSHA-256s\n\n\n484f78eb4a3bb69d62491fdb84f2c81b7ae131ec8452a04d6018a634e961cd6a\n\na35406d9ef82a68fbabb3c1e19911c9ed41bed335ef44a15037d1580c2b9dd12\n\nefdec1ad0830359632141186917fd32809360894e8c0a28c28d3d0a71f48ec2f\n\nf1a69e2041ab8ab190d029d0e061f107ef1223b553e97c302e973a3b3c80f83e\n\n31cf13e8579f0589424631c6be659480f9a204a50a54073e7d7fe6c9c81fa0db\n\nFigure 27. Patched Lazagne\n\n\nSHA-256s\n\n\n6ee79815f71e2eb4094455993472c7fb185cde484c8b5326e4754adcb1faf78e\n\n81c7787040ed5ecf21b6f80dc84bc147cec518986bf25aa933dd44c414b5f498\n\n999e4753749228a60d4d20cc5c5e27ca4275fe63e6083053a5b01b5225c8d53a\n\n8501c4df5995fd283e733ab00492f35aecb6ea2315b44e85abb90b3f067ccb64\n\n4bd93e4a9826a65ade60117f6136cb4ed0e17beae8668a7c7981d15c0bed705a\n\nFigure 28. SHARPSTATS\n\n\nSHA-256s\n\n\n503b2b01bb58fc433774e41a539ae9b06004c7557ac60e7d8a6823f5da428eb8\n\n04acd5721ad37ac5aa84e7f7e20986de0a532fb625a8bc75302a0f38c171cee3\n\n8ea17ed2cb662118937ed6fe189582cc11b2b73bb27a223d0468881ac5fcc08e\n\ne2f82b074074955eeca3b0dd7b2831192bee49de329d5d4b36742c9721c8ad94\n\n\n21\n\n\n-----\n\n503b2b01bb58fc433774e41a539ae9b06004c7557ac60e7d8a6823f5da428eb8\n\nFigure 29. DELPHSTATS\n\n\nSHA-256s\n\n\n121adcf3a52cafd0204ca4d4a42a9a09d6c9f559bcb997e51dba79c6a5a04efd\n\nedde2eb39ed2f145c41e53e87d43add8de336d3e4d5c8d261f471d35edf3ed47\n\nFigure 30. Backend server\n\n\nSHA-256s\n\n\ne60c802b692a503f4f91e8809bb961b5423c602f6fb374de1af4d983415de3f1\n\nc84a61ba8c84ca1e879c4d8ac802ec260a8c426d89a09d8627a8c08ff6d88faf\n\n78da47f5a341909d1e6f50f8d39fdde8129ede86f04f3e88b2278e16c72e2461\n\n4e2cdfed691d6debab01c1733135b146817c94024177f9ef4b22726fac84322f\n\n3fee29fefe4aa9386a11a7a615dd052ff89e21d87eee0fff5d6f933d9384ede2\n\n3c75c2f7b299d9cc03a7ff91c568defaa39b4be02d58a75a85930ab23d2a2cff\n\n276a765a10f98cda1a38d3a31e7483585ca3722ecad19d784441293acf1b7beb\n\n818253f297fea7d8a2324ee1a233aabbaf3b0b4b9cdaa1ebd676fe00f2247388\n\nf6707b5f41192353be3311fc7f48ee30465038366386b909e6cefaade70c91bc\n\nde7b77f9c456d26e369263b6e1d001279b69e687b2d3029803ede21417d4f5fa\n\ncc685f30e2f6039d12b4cbc92e38f1d64ba75ac12cb86afce5261a11cf4931de\n\n0faa2bb90de44ef87c7ee11165f7c702211dd603bdaea94af09cfecc3f525138\n\ne6812fa0e12cc1913bfc7eb6dceb638429048e3cc59ce576c012a1d27fa20959\n\nfb773f7324fdca584fff7da490820c7243a10555c8ff717d21c039a5ba337a43\n\n11761d6cf365932540ccb95b6f20aa45379736cfde33742a004fc8ceccad7daf\n\nb9d4752b892759bb0cb166ab565f050f4b6385dd67f4288ff2231c69ab984a26\n\n604e09e01e2bfbc8f3680abd8005906e3fbcd2f4edaf24d80cd7105ec6f991b1\n\nf2b8d7ce968ed8d6c33116bcfb8aeed97d89ec1ebf4f505c891020dc79d0ddd3\n\n336237b1ed2c99c0fef4c954490bd8282d6e46941d2ac2b6c9294a1aa9a254ed\n\n28a0131a9fda9fe2f2272c5091c77dc750da93d4a070dbd817af38723ea18f02\n\nd320286e80d5785bbd14b10c00f5c9d38d9a781075d7d6ed4eb27c07d4788dbf\n\n24878dbde796c471a9d028f65421017afc087c958fb54c4b6c3cc7aeabbc1119\n\n57a9e2e6e715455827faefa982b4312b203189950fe285f1413174f5e812e408\n\n92bb4432cc9d2988ee4043e420a4df9c8caec4cd93ab258e07546781daa37086\n\n\n22\n\n\n-----\n\nFigure 31. Post-exploitation malware\n\n\nC&C Servers\n\n\n103[.]13[.]67[.]4\n\n80[.]80[.]163[.]182\n\n80[.]90[.]87[.]201\n\n91[.]187[.]114[.]210\n\n78[.]129[.]139[.]131\n\n103[.]13[.]67[.]4\n\n80[.]80[.]163[.]182\n\n80[.]90[.]87[.]201\n\n91[.]187[.]114[.]210\n\n78[.]129[.]139[.]131\n\n192[.]168[.]1[.]104:54863\n\n163[.]172[.]147[.]222:4555\n\nhxxp://78[.]129[.]139[.]148\n\nhxxp://31[.]171[.]154[.]67\n\nhxxp://79[.]106[.]224[.]203\n\nhxxp://185[.]34[.]16[.]82\n\nhxxp://104[.]237[.]233[.]17\n\nhxxp://46[.]99[.]148[.]96\n\nhxxp://134[.]19[.]215[.]3:443\n\nhxxp://gladiyator[.]tk\n\nhxxp://51[.]77[.]97[.]65\n\nhxxp://31[.]171[.]154[.]67\n\nhxxp://79[.]106[.]224[.]203\n\nhxxp://185[.]14[.]248[.]26\n\nhxxp://185[.]162[.]235[.]182\n\nhxxp://185[.]117[.]75[.]116/tmp[.]php\n\nhxxp://38[.]132[.]99[.]167/crf[.]txt\n\nhxxp://185[.]244[.]149[.]218/JpeGDownload/*[.]jpeg\n\nhxxp://185[.]185[.]25[.]175/ref45[.]php\n\nhxxp://185[.]185[.]25[.]175/sDownloads/*[.]jpeg\n\nhxxp://82[.]102[.]8[.]101/bcerrxy[.]php\n\n\n23\n\n\n-----\n\namazo0n[.]serveftp[.]com/Data\n\nzstoreshoping[.]ddns[.]net/Data/\n\nhxxp://zstoreshoping[.]ddns[.]net/users[.]php?tname=\n\nshopcloths[.]ddns[.]net\n\ngetgooogle[.]hopto[.]org\n\nhxxp://gladiyator[.]tk\n\ngoogleads[.]hopto[.]org\n\nhxxp://www[.]shareliverpoolfc[.]co[.]uk/js/main.php\n\nhxxp://valis-ti[.]cl/assets/main[.]php\n\nhxxp://www[.]latvia-usa[.]org/wp\nincludes/customize/main.php\n\nhxxp://www[.]shareliverpoolfc[.]co[.]uk/js/main[.]php\n\nhxxp://valis-ti[.]cl/assets/main[.]php\n\nhxxp://www[.]latvia-usa[.]org/wp\nincludes/customize/main[.]php\n\nhxxp://googleads[.]hopto[.]org/data/ce28e899a8d3d0\n\n0a.]dat\n\nhxxp://ciscoupdate2019[.]gotdns[.]ch/users[.]php?\n\nhxxps://www[.]jsonstore[.]io/4de4d6d84d17638b3cd0\n\neaf18857784aff27501be7d3dd89fad2b7ac2134f52e\n\n(abused)\n\nhxxps://www[.]jsonstore[.]io/ddf35a64bd5ad54f9de86\n8a84cdb21299a33d126e307ec3a868f65372402816a\n\n(abused)\n\nhxxps://104[.]237[.]233[.]38:8080/YIZDGrM_4mRn_m\n\nb8PdhL_QfL2h49-aAO0wfaxRxJAdq9pH2JeliMez10IwMk6PCnluziydTlV-/\n\nhxxps://104[.]237[.]255[.]212:443/GfaBcrPI14rArcGv\n\nmQT2g3sW3ZtmqL6IU0Vg5oy21aOK4gvmvYx_TCP_\n\nwhhSnyQH7/\n\nhxxps://104[.]237[.]233[.]38:1022/aeacrE65xE9SdVN\n\n3CJwS9gbtNM84GL_ajl_AD2EoEOHrmbpQ5qC9J7\nGcSSZQ0JNBDnOulnMWgNy3FV2kcHRuM0u5NMo\n\n5Jv9Ks4zS5-pLkiYs4me/\n\nhxxps://104[.]237[.]233[.]38:8080/nud2WCL9WzTiAO\nMCuFMboA18GWsmrc8k6VqGrXXfqVghYktellhTS7_\n\ntg-D64spqdv4sOJ/\n\nhxxps://88[.]99[.]17[.]148:443/3gg7DuFHLwC8gPwW3z9rgnS1Is8F83B-95PHYnVp\nk9219KbHn\n\n24\n\n\n-----\n\nIChwxSFR35a117i2Jz_OX9mUPAYRJw\n3NhMBxUVDp4iMOkzt/\n\nhxxps://104[.]237[.]233[.]40:8443/zi5w0iDM6aLEgcW\n\nDnumYywaHa33BIPzaylNUPUECcNCmfNNcxzv05flJoB3wvWqH6Uf01vI-1yKF96/\n\nhxxps://78[.]129[.]139[.]134:8864/lZkP68TtH_BpZGh\n\nmMwxNPwy0vjimgwDRfk01pV2Xu2FztbaevB6RzBUPRietWtBcuxru7tTsF3rZGFPbepd294BP2MG\n\nd/\n\nFigure 32. List of C&C servers\n\n\n25\n\n\n-----\n\n**TREND MICRO[TM] RESEARCH**\n\nTrend Micro, a global leader in cybersecurity, helps to make the world safe for exchanging digital information.\n\nTrend Micro Research is powered by experts who are passionate about discovering new threats, sharing key insights, and\nsupporting efforts to stop cybercriminals. Our global team helps identify millions of threats daily, leads the industry in\nvulnerability disclosures, and publishes innovative research on new threats techniques. We continually work to anticipate new\nthreats and deliver thought-provoking research.\n\n**www.trendmicro.com**\n\n\n26\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.06.10.MuddyWater_Resurfaces/wp_new_muddywater_findings_uncovered.pdf"
    ],
    "report_names": [
        "wp_new_muddywater_findings_uncovered"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2ed8d590-defa-4873-b2de-b75c9b30931e",
            "created_at": "2023-01-06T13:46:38.730137Z",
            "updated_at": "2025-03-27T02:00:02.903261Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "Boggy Serpens",
                "Mango Sandstorm",
                "TEMP.Zagros",
                "Static Kitten",
                "G0069",
                "TA450",
                "Earth Vetala",
                "Seedworm",
                "COBALT ULSTER",
                "ATK51"
            ],
            "source_name": "MISPGALAXY:MuddyWater",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "31e69945-6c1e-40c3-ba8e-a77e81dd142a",
            "created_at": "2024-05-01T02:03:08.047377Z",
            "updated_at": "2025-03-27T02:05:17.326452Z",
            "deleted_at": null,
            "main_name": "COBALT ULSTER",
            "aliases": [
                "ENT-11 ",
                "ITG17 ",
                "MERCURY ",
                "Mango Sandstorm ",
                "MuddyWater ",
                "STAC 1171 ",
                "Seedworm ",
                "Static Kitten ",
                "TEMP.Zagros ",
                "UNC3313 ",
                "Yellow Nix ",
                "Earth Vetala "
            ],
            "source_name": "Secureworks:COBALT ULSTER",
            "tools": [
                " Canopy",
                " CrackMapExec",
                " CredNinja",
                " Empire",
                " FORELORD",
                " Koadic",
                " LaZagne",
                " Ligolo",
                " MKL64",
                " Metasploit",
                " Mimikatz",
                " MiniDump",
                " Mori",
                " MuddyC2Go",
                " MuddyC3",
                " PhonyC2",
                " Plink",
                " PowGoop",
                " PowerStats",
                " RemoteUtilities",
                " Revsocks",
                " ScreenConnect",
                " SimpleHelp",
                " Small Sieve",
                " Syncro",
                " Venom Proxy",
                " WMIExec",
                "AnyDesk"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "02e1c2df-8abd-49b1-91d1-61bc733cf96b",
            "created_at": "2022-10-25T15:50:23.308924Z",
            "updated_at": "2025-03-27T02:00:55.437268Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "MuddyWater",
                "Earth Vetala",
                "Static Kitten",
                "Seedworm",
                "TEMP.Zagros",
                "Mango Sandstorm",
                "TA450"
            ],
            "source_name": "MITRE:MuddyWater",
            "tools": [
                "STARWHALE",
                "POWERSTATS",
                "Out1",
                "PowerSploit",
                "Small Sieve",
                "Mori",
                "Mimikatz",
                "LaZagne",
                "PowGoop",
                "CrackMapExec",
                "ConnectWise",
                "SHARPSTATS",
                "RemoteUtilities",
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3c430d71-ab2b-4588-820a-42dd6cfc39fb",
            "created_at": "2022-10-25T16:07:23.880522Z",
            "updated_at": "2025-03-27T02:02:10.010443Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "ATK 51",
                "Boggy Serpens",
                "Cobalt Ulster",
                "ITG17",
                "Mango Sandstorm",
                "MuddyWater",
                "Operation BlackWater",
                "Operation Earth Vetala",
                "Operation Quicksand",
                "Seedworm",
                "Static Kitten",
                "T-APT-14",
                "TA450",
                "TEMP.Zagros",
                "Yellow Nix"
            ],
            "source_name": "ETDA:MuddyWater",
            "tools": [
                "Agentemis",
                "BugSleep",
                "CLOUDSTATS",
                "ChromeCookiesView",
                "Cobalt Strike",
                "CobaltStrike",
                "CrackMapExec",
                "DELPHSTATS",
                "EmPyre",
                "EmpireProject",
                "FruityC2",
                "Koadic",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "MZCookiesView",
                "Meterpreter",
                "Mimikatz",
                "MuddyC2Go",
                "MuddyRot",
                "Mudwater",
                "POWERSTATS",
                "PRB-Backdoor",
                "PhonyC2",
                "PowGoop",
                "PowerShell Empire",
                "PowerSploit",
                "Powermud",
                "QUADAGENT",
                "SHARPSTATS",
                "SSF",
                "Secure Socket Funneling",
                "Shootback",
                "Smbmap",
                "Valyria",
                "chrome-passwords",
                "cobeacon",
                "prb_backdoor"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041774,
    "ts_creation_date": 1560187852,
    "ts_modification_date": 1560187852,
    "files": {
        "pdf": "https://archive.orkl.eu/ae3f5f3ef2ca2f5e90c1909b47566255452291ed.pdf",
        "text": "https://archive.orkl.eu/ae3f5f3ef2ca2f5e90c1909b47566255452291ed.txt",
        "img": "https://archive.orkl.eu/ae3f5f3ef2ca2f5e90c1909b47566255452291ed.jpg"
    }
}