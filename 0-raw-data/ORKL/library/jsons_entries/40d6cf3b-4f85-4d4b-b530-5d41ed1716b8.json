{
    "id": "40d6cf3b-4f85-4d4b-b530-5d41ed1716b8",
    "created_at": "2023-01-12T15:06:26.57153Z",
    "updated_at": "2025-03-27T02:05:43.616559Z",
    "deleted_at": null,
    "sha1_hash": "da1abedf1f68422e3fcf77bffe2131ef908339cf",
    "title": "2012-12-29 - Attack and IE 0day Informations Used Against Council on Foreign Relations",
    "authors": "",
    "file_creation_date": "2022-05-28T18:27:02Z",
    "file_modification_date": "2022-05-28T18:27:02Z",
    "file_size": 321330,
    "plain_text": "# Attack and IE 0day Informations Used Against Council on Foreign Relations\n\n**[eromang.zataz.com/2012/12/29/attack-and-ie-0day-informations-used-against-council-on-foreign-relations/](https://eromang.zataz.com/2012/12/29/attack-and-ie-0day-informations-used-against-council-on-foreign-relations/)**\n\nwow 29/12/2012\n\n**Council on Foreign Relations** [(CFR.org), a foreign policy web group, has been victim of a](http://www.cfr.org/)\ntargeted attack who seem to be linked to computer hackers traced to China.\n\n[Regarding information’s posted on the Washington Free Beacon, infected CFR.org website](http://freebeacon.com/chinese-hackers-suspected-in-cyber-attack-on-council-on-foreign-relations/)\nwas used to attack visitors in order to extract valuable information’s. The “drive-by” attack\nwas detected around 2:00 pm on Wednesday 26 December and CFR members who visited\nthe website between Wednesday and Thursday could have been infected and their data\ncompromised, the specialists said.\n\nThrough Washington Free Beacon news we know that only Internet Explorer 8 and higher\nversions have been targeted. A possible Internet Explorer 0day was used to infect visitors\ncomputers. We also know that the attack was limited to CFR members and website visitors\nwho used browsers configured for Chinese language characters.\n\nAs always, I was curious and tried to have more information’s regarding this attack and\npotential 0day.\n\n**urlQuery.net investigations**\n\nOn **[urlQuery.net, we can see that the first submission was done, the 20 December. More](https://www.urlquery.net/search.php?q=cfr.org&type=string&start=2012-11-01&end=2012-12-28&max=200)**\n[interesting is the submission of 21 December on URL “/js/js/news_123432476.html“. “/js/js/”](https://www.urlquery.net/report.php?id=465113)\ndirectory seem to be a strange behavior. We can see that a “deployJava.js” was involved by\nloading this page.\n\nOther URLs are interesting like “/js/js/robots.txt“, “/js/js/today.swf“, “/js/js/news_435435s.html”\nbut all these URLs have been submitted the 27 December and after, and the file are no more\navailable.\n\n**jsunpack investigations**\n\n[On jsunpack we can observe that the “deployJava.js” was submitted the 26 December. All](http://jsunpack.jeek.org/dec/go?report=fcf13971f648f6171ee669a2813a89749218d9be)\nother files have been submitted the 27 December and after, and the file are no more\navailable.\n\n**CLEAN MX realtime database investigations**\n\n[On CLEAN MX we can observe an analysis the 20 December.](http://support.clean-mx.de/clean-mx/viruses.php?id=8724375)\n\n\n-----\n\nWhy so many parallel submission ? Ok guys, the infection has started since minimum the 20\nDecember, so not since Wednesday 26 December. Now, if you have some skill in\nresearching information’s and if you are still curious, you will find part of the “drive-by” attack\nsource code. By doing some additional researches I found the source code of the “drive-by”\nattack, and I can confirm you that this attack has started since minimum the 7 December !\n\n**Let analyze this source code.**\n\nI can confirm that only visitors with Internet Explorer 8 and higher versions have been\ntargeted.\n\nBut, a fact who was not pointed is if the visitor don’t has Adobe Flash, he will not be part of\nthe party, Flash free Internet Explorer are not targeted.\n\nI can also confirm that visitors who used browsers configured for Chinese language\ncharacters were targeted, but also Taiwanese and American visitors…\n\nIf you load the malicious page for the first time, a “visit” named cookie is create with a lifetime\nof 7 days through the “DisplayInfo()” function. If you have already a cookie, you will no more\nbe exploited until the expiration of the cookie\n\n\n-----\n\nThen the page is loading the “download” Javascript function. This function is trying a XML\n[HTTP request to a “xsainfo.jpg” file. After some discussion with @binjo, it could be that](https://twitter.com/binjo)\n“xsainfo.jpg” maybe just a clean file, ajax trick to call the “callback” function.\n\n[“xsainfo.jpg” file is maybe “320e0729e1a50fd6a2aebf277cfcad66” found on VirScan and](http://r.virscan.org/7985b346f75a60148ace03b31f1a37fe)\n[VirusTotal. This file was submitted the 13 December.](https://www.virustotal.com/file/e4b7b8dd6a4f9dc93b14205ef7d41647ce5c6b18a1194bd88d3205deb7bf26fa/analysis/)\n\nThe “callback” function verifies if the “xsainfo.jpg” has been loaded and that a “200” HTTP\nstatus code has been returned.\n\nIf the visitor operating system is Windows 7 or Windows 2008 R2, an Office document is\nopened through the “SharePoint.OpenDocuments” ActiveX control. Depending the way the\ndocument is opened the “key” variable is initiated with funny values “boy” or “girl“. I’m not\nspecialist in this domain, maybe one of the blog post reader could provide some more\ninformation’s.\n\n\n-----\n\nDepending if you are “girl” or a “boy“, the “test” division of the HTML document will be\nmanipulated, a “today.swf” flash object will be loaded plus a “news.html” iframe.\n\nIf you are not a “girl” or a “boy“, you will need to have Java SE 6, but not JSE 7, in order to\nload the two same files as previously mentioned. If the visitor operating system is Windows\nXP, the “test” division of the HTML document will be also manipulated, and the two same files\nare loaded.\n\n[Unfortunately, actually I didn’t find these two files, but after more discussions with @binjo it](https://twitter.com/binjo)\ncould be that the swf is used to setup payload, “news.html” used to trigger the vulnerability.\n\nSo if 0day exist, this 0day is surely in “news.html” file, and it is also sure that this targeted\nattack has not begin on Wednesday, not only targeted visitors who used browsers configured\nfor Chinese language characters.\n\n\n-----\n\nI keep you in touch if I have additional information s regarding this potential new Internet\nExplorer 0day.\n\n**Update 1 – 12/29 2am:**\n\nFireEye has post some [additional information’s regarding the attack. It seem that “today.swf”](https://www.fireeye.com/blog/)\ntrigger a heap spray in Internet Explorer in order to complete the compromise. Once the\nbrowser is exploited, it appears to download “xsainfo.jpg,” which is the dropper encoded\nusing single-byte XOR (key: 0x83, ignoring null bytes).\n\nWhat is also new regarding FireEye blog post is that their version is targeting English (U.S.),\nChinese (China), Chinese (Taiwan), Japanese, Korean, or Russian. My version of 7\nDecember was only targeting English (U.S.), Chinese (China), Chinese (Taiwan), so the guys\nhad time to release new version of they’re code during this elapse of time. Also they didn’t\nmention the news.html file.\n\n**Update 2 – 12/29 11am:**\n\n[@binjo has release further information’s regarding “new IE 0day coming-](https://twitter.com/binjo)\n_mshtml!CDwnBindInfo object use after free vulnerability”._\n\nAlso, I can observe that a certain number of people have samples of the 0day, I could not\nimagine that an active exploit will not be out before the end of the year.\n\n**Update 3 – 12/29 6pm:**\n\n[AlienVault has publish more detailed information’s regarding the attack and the 0day.](http://labs.alienvault.com/labs/index.php/2012/just-another-water-hole-campaign-using-an-internet-explorer-0day/)\n\n**Update 4 – 12/29 10pm:**\n\n@_sinn3r is on the way to deliver a Metasploit module for the CFR.org 0day exploit.\n\n[#Metasploit exploit for IE CDwnBindInfo #0day on the way:](https://twitter.com/hashtag/Metasploit?src=hash) [http://t.co/BY6ypD1n](https://t.co/BY6ypD1n)\n\n[— sinn3r (@_sinn3r) December 29, 2012](https://twitter.com/_sinn3r/status/285125607950520320)\n\n**Update 5 – 12/30 00am:**\n\nMicrosoft has release MSA-2794220 and confirm the vulnerability targeting Internet Explorer\n6, Internet Explorer 7, and Internet Explorer 8. Internet Explorer 9 and Internet Explorer 10\nare not affected by the vulnerability. [CVE-2012-4792 has been assigned to this vulnerability.](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4792)\n\n**Update 6 – 12/30 2am:**\n\nMetasploit team has release the Microsoft Internet Explorer 0day.\n\nhttps://twitter.com/_juan_vazquez_/status/285186813637849088\n\n\n-----\n\n**Update 7 – 12/30 11am:**\n\n[Here under is the code version I found in Google cache as it appeared on 7 Dec 2012](https://pastebin.com/PuM8GMeb)\n14:12:28 GMT\n\nGot some more samples:\n\nHelps.html (a25c13d4edb207e6ce153469c1104223)\nnews.html (76d14311bae24a40816e3832b1421dee)\nrobots.txt (96b01d14892435ae031290cd58d85c2e)\nxsainfo.jpg (7c713c44e34fa8e63745744e3b7221db)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2012/2012-12-29 - Attack and IE 0day Informations Used Against Council on Foreign Relations.pdf"
    ],
    "report_names": [
        "2012-12-29 - Attack and IE 0day Informations Used Against Council on Foreign Relations.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535986,
    "ts_updated_at": 1743041143,
    "ts_creation_date": 1653762422,
    "ts_modification_date": 1653762422,
    "files": {
        "pdf": "https://archive.orkl.eu/da1abedf1f68422e3fcf77bffe2131ef908339cf.pdf",
        "text": "https://archive.orkl.eu/da1abedf1f68422e3fcf77bffe2131ef908339cf.txt",
        "img": "https://archive.orkl.eu/da1abedf1f68422e3fcf77bffe2131ef908339cf.jpg"
    }
}