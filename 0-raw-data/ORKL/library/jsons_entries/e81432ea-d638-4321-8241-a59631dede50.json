{
    "id": "e81432ea-d638-4321-8241-a59631dede50",
    "created_at": "2023-01-12T15:02:47.516714Z",
    "updated_at": "2025-03-27T02:06:10.557787Z",
    "deleted_at": null,
    "sha1_hash": "3e5ca01dab803b36d887e1f13e418e8657b5b365",
    "title": "2015-02-18 - Babar- Suspected Nation State Spyware In The Spotlight",
    "authors": "",
    "file_creation_date": "2022-05-28T15:42:07Z",
    "file_modification_date": "2022-05-28T15:42:07Z",
    "file_size": 831890,
    "plain_text": "# Babar: Suspected Nation State Spyware In The Spotlight\n\n**[web.archive.org/web/20150218192803/http://www.cyphort.com/babar-suspected-nation-state-spyware-spotlight/](https://web.archive.org/web/20150218192803/http://www.cyphort.com/babar-suspected-nation-state-spyware-spotlight/)**\n\nFebruary 18, 2015\n\n## Cyphort Labs\n\n Blog\n\n**Posted on February 18th, 2015 by Marion Marschalek**\n\n[Blog Home](https://web.archive.org/web/20150218192803/http://www.cyphort.com/labs/blog/)\n\nCyphort Labs has collected and analyzed a highly advanced piece of malware, which for all\nintents and purposes seems to be a full blown cyber espionage tool of the kind a nation state\nwould be behind. This malware invades Windows desktop machines and aims at exfiltrating\nalmost anything of value: it steals data from instant messengers, softphones, browsers and\noffice applications.\n\nThe analyzed malware consists of two pieces: a dropper and an implant. The implant is able\nto hook APIs of interest in dedicated remote processes to steal data on the fly.\n\nThe internal project name of the analyzed malware is ‘Babar64’, which rings a bell when\nthinking back of documents leaked through Der Spiegel back in January\n(http://www.spiegel.de/media/media-35683.pdf). There, a slide deck originating from\n\n\n-----\n\nCommunications Security Establishment Canada (CSEC) describes an alleged nation state\nmalware named Babar. The samples at hand fit well with what is described in the CSEC\ndocument; and, as CSEC states they are suspected to originate from French intelligence.\n\nAs it is with binary attribution, these allegations are impossible to prove without the shadow\nof a doubt. What we can say with certainty though is that Babar strikes the analyst with\nsophistication not typically seen in common malware. Furthermore, the binaries come with\nthe same handwriting as the malware dubbed ‘Bunny’ which we have blogged about before\n(http://www.cyphort.com/evilbunny-malware-instrumented-lua/). We assume the same author\nis behind both families.\n\nNote: I will be hosting a webinar on the topic of Evil Bunny malware next week. You can\n[register here to attend.](https://web.archive.org/web/20150218192803/http://info.cyphort.com/mmwfebruary)\n\n**DROPPER**\n\nMD5        9fff114f15b86896d8d4978c0ad2813d\nSHA-1       27a0a98053f3eed82a51cdefbdfec7bb948e1f36\nFile Size     693.4 KB (710075 bytes)\n\n**IMPLANT**\n\nMD5        4525141d9e6e7b5a7f4e8c3db3f0c24c\nSHA-1       efbe18eb8a66e4b6289a5c53f22254f76e3a29bd\nFile Size     585.4 KB (599438 bytes)\n\n**A BABAR(ian) BINARY**\n\nA target machine is infected possibly through a drive-by or malicious e-mail attachments.\nBabar is deployed through a malware dropper, which installs the malware.\n\nBabar essentially is an implant, a malicious Windows DLL. Babar’s implant is a 32-bit DLL\nwritten in C++, which upon start injects itself to running processes and invades desktop\napplications by applying a global Windows hook. The original filename of the sample at hand\nis ‘perf585.dll’. The implant is capable of logging keystrokes, capturing screen shots,\neavesdropping on installed softphones and spying on instant messengers in addition to a list\nof simpler espionage tricks. Babar is a full blown espionage tool, built to excessively spy on\nthe activity on an infected machine’s user.\n\nThe DLL dropped by Babar is placed into the application data folder, along with a directory\nnamed ‘MSI’ where the runtime data will be stored. Babar operates through multiple\ninstances, by injecting its DLL to a maximum of three desktop processes. This is achieved by\nloading the Babar DLL to remote processes through a mapped memory object.\n\n\n-----\n\nApart from that, Babar comes with a userland rootkit component which applies global\nWindows hooks to invade all processes on its desktop. This way Babar can install API hooks\nfor various APIs via Windows Detours technique to actively steal data from arbitrary\nprocesses.\n\nThe spying activities are performed either through the Babar instance locally or through\nprocesses invaded via hooking. Instance-local capabilities are basic spying on window\nnames or snooping on the clipboard data, while the global hooks manage to steal information\ndirectly from Windows API calls.\n\nA summary of the capabilities would be as follows:\n\nLogging keystrokes\nTaking screenshots\nCapture of audio streams from softphone applications\nStealing of clipboard data\nSystem and user default language, keyboard layout\nNames of desktop windows\n\nThe keylogger module is based on Windows RAWINPUT. The malware creates an invisible\nwindow, with no other purpose than to receive window messages. By processing the window\nmessage queue it filters out input events and dispatches them to a raw input device object.\nSaid object is configured to grab keyboard events through GetRawInputData.\n\n\n-----\n\nThe interest of Babar s process hooking module is focused on the following applications,\nparted in the categories internet communication, file processing and media:\n\nInternet communication\n_iexplore.exe,firefox.exe,opera.exe,chrome.exe,Safari.exe,msnmsgr.exe_\nFile processing\n_exe, winword.exe, powerpnt.exe, visio.exe, acrord32.exe, notepad.exe,_\n_wordpad.exe.txt_\nMedia\n_skype.exe, msnmsgr.exe, oovoo.exe, nimbuzz.exe, googletalk.exe,_\n_yahoomessenger.exe, x-lite.exe_\n\nThe malicious implant can steal input coming from the keyboard, information on which files\nare edited, it can intercept chat messages and record calls established by one of the listed\nsoftphones. The stolen information is encrypted and dumped to a file on disk, which will be\nlocated in the working directory under %APPDATA%\\MSI.\n\n**COMMAND AND CONTROL SERVERS**\n\nThe analyzed sample of Babar has two hard coded C&C server addresses which are\nincluded in its configuration data:\n\nhttp://www.horizons-tourisme.com/_vti_bin/_vti_msc/bb/index.php\nhttp://www.gezelimmi.com/wp-includes/misc/bb/index.php\n\nThe domain horizons-tourisme.com is a legitimate website, operated by an Algerian travel\nagency, located in Algiers, Algeria. The website is in French and still online today.\nGezelimmi.com is a Turkish domain, currently responding with an HTTP error message 403,\naccess not permitted. Both domains appear to be of legitimate use, but compromised and\nabused to host Babar’s server side infrastructure.\n\n\n-----\n\n« [Read Previous Post](https://web.archive.org/web/20150218192803/http://www.cyphort.com/rolling-stone-malware/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-02-18 - Babar- Suspected Nation State Spyware In The Spotlight.pdf"
    ],
    "report_names": [
        "2015-02-18 - Babar- Suspected Nation State Spyware In The Spotlight.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535767,
    "ts_updated_at": 1743041170,
    "ts_creation_date": 1653752527,
    "ts_modification_date": 1653752527,
    "files": {
        "pdf": "https://archive.orkl.eu/3e5ca01dab803b36d887e1f13e418e8657b5b365.pdf",
        "text": "https://archive.orkl.eu/3e5ca01dab803b36d887e1f13e418e8657b5b365.txt",
        "img": "https://archive.orkl.eu/3e5ca01dab803b36d887e1f13e418e8657b5b365.jpg"
    }
}