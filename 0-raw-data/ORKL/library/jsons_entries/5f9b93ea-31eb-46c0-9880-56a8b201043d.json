{
    "id": "5f9b93ea-31eb-46c0-9880-56a8b201043d",
    "created_at": "2022-10-25T16:48:21.374685Z",
    "updated_at": "2025-03-27T02:11:39.654439Z",
    "deleted_at": null,
    "sha1_hash": "2b98220caf158d1c4f6d72abbc379899e35edc4d",
    "title": "Sk Hack By An Advanced Persistent Threat",
    "authors": "Command Five Pty Ltd",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 380334,
    "plain_text": "# SK Hack by an Advanced Persistent Threat\n\nCommand Five Pty Ltd\nSeptember 2011\n\n**ABSTRACT**\n\nThis document summarises the July 2011 intrusion into SK\nCommunications which culminated in the theft of the personal\ninformation of up to 35 million people. It describes the use of a trojaned\nsoftware update to gain access to the target network, in effect turning a\nsecurity practice into a vulnerability. It also describes the use of a\nlegitimate company to host tools used in the intrusion. Links between\nthis intrusion and other malicious activity are identified and valuable\ninsights are provided for network defenders. Technical details of\nmalicious software and infrastructure are also provided.\n\n\n**WARNING**\n\nThis paper discusses malicious activity and\nidentifies Internet Protocol (IP) addresses, domain\nnames, and websites that may contain malicious\ncontent. For safety reasons these locations should\nnot be accessed, scanned, probed, or otherwise\ninteracted with unless their trustworthiness can be\nverified.\n\n**SK HACK**\n\nOn 28 July 2011 SK Communications announced it\nhad been the subject of a hack which resulted in the\ntheft of the personal details of up to 35 million of its\nusers. The compromised details were those of\nCyWorld and Nate users, as stored in SK\nCommunications’ user databases. CyWorld[1] is South\nKorea’s largest social networking site and Nate is a\npopular South Korean web portal. Both services are\nowned by SK Communications. (Sung­jin, 2011)\n\n1CyWorld has also expanded to China, Japan, the United States,\nTaiwan, Vietnam and Europe. (SK Communications)\n\n\nThe sophistication of the attack along with the\nperiod of time over which it was planned, and\nconducted, indicate that this attack was likely to\nhave been undertaken by an Advanced Persistent\nThreat[2].\n\nBetween 18 and 25 July 2011 the attackers[3]\n\ninfected over 60 SK Communications computers and\nused them to gain access to the user databases. The\nattackers infected these computers by first\ncompromising a server, belonging to a South Korean\nsoftware company, used to deliver software updates\nto customers (including SK Communications). The\nattackers modified the server so that the SK\nCommunications computers would receive a\ntrojaned[4] update file when they conducted their\nroutine checks for software updates. (Moon­young,\n2011) (ESTsoft, 2011)\n\n2 For a definition of the term ‘Advanced Persistent Threat’ refer to\nthe Command Five paper ‘Advanced Persistent Threats: A Decade\nin Review’ (Command Five Pty Ltd, 2011).\n3 The term ‘attackers’ is used in this paper to describe both the\nhackers and anyone to whom they were reporting.\n4 A trojan is a document or program which appears harmless but\nperforms malicious activity when opened or run.\n\n\nPAGE 1 OF 24\n\n\n-----\n\nSuch routine updates (commonly known as\n‘patches’) are a good security practice as they often\ninclude fixes for security weaknesses identified in\nthe software. Without software updates the SK\nCommunications computers would have been\nvulnerable to several other attacks including a\nsignificant one which was made public in June\n2011[5]. The security of software updates is usually\ntrusted implicitly and the exploitation of this trust\nrelationship could go undetected by many targets, as\nit did for some time by SK Communications.\n\nBetween 18 and 25 July the attackers conducted\ncommand and control and monitoring activities on\nthe infected computers. This involved the upload of\ntools, conveniently stored on the website of a\nTaiwanese publishing company the attackers had\nearlier hacked. Then on 26 July 2011, the attackers,\nhaving done the necessary groundwork, proceeded\nto hack the Nate and CyWorld user databases [6].\n(Birdman, 2011) (Moon­young, 2011)\n\nUsing ‘waypoints’[7] to obfuscate the source of\ntheir activities, the attackers successfully stole the\npersonal details of up to 35 million SK\nCommunications customers from the user databases.\nThese personal details included names, phone\nnumbers, home and email addresses, birth dates,\ngender details, user identifiers, passwords and, due\nto South Korea’s Real Name System[8] which was in\nplace at the time, also resident registration numbers.\nThe passwords and resident registration numbers\nwere reportedly encrypted but the other details\nwere not. (Birdman, 2011) (Hauri ­ Response Team,\n2011) (Moon­young, 2011) (Jin­woo Seo, 2011)\n\n**THE UPDATE SERVER**\n\nThe update server used by the attackers as a\nlaunchpad for their attack against SK\nCommunications was ESTsoft’s ALZip update server.\nESTsoft is a large South Korean software company\n\n5 A vulnerability exists in certain versions of a software program\nused by SK Communications (amongst other companies) which\ncould allow an attacker to gain control of computers if the\nprogram is used on them to open a maliciously crafted file.\n(Japanese IT Promotion Agency 2011)\n6 According to the Korean National Police Agency the hacker\ncollected information from the infected computers for up to a\nweek before hacking the databases. (Moon­young, 2011)\n7 A ‘waypoint’ is a computer used by attackers as an intermediary\npoint to obfuscate the source of their hacking activities.\n8 Under South Korea’s Real Name System, Koreans were required\nto submit their real names and resident registration numbers\nwhen creating accounts on any website attracting more than\n100,000 visitors per day. (TMCnews 2011)\n\n\nand ALZip is a file compression and archive tool\ndeveloped by the company. ALZip is part of a trusted\nsuite of tools known as ALTools which also includes\nthe antivirus software, ALYac. The antivirus\nsoftware is independent of the rest of the suite of\ntools. It uses a different update program and server\nto the other tools. The security of ALYac was not\ncompromised in the attack. (ESTsoft, 2011) (ESTsoft,\n2011)\n\nThe attackers, purportedly using Chinese IP\naddresses[9], gained access to the ALZip update server\nvia unknown means and uploaded instructions to it.\nThen, when SK Communications computers\nconducted their routine check for ALTools updates,\nthe attacker’s instructions on the update server\ndirected the computers to download a trojaned\nupdate from the attacker’s Content Delivery\nNetwork[10] (CDN) instead of the legitimate update\nfrom ESTsoft’s CDN. (ESTsoft, 2011)\n\nThe trojaned update exploits a software\nvulnerability [11] in the ALTools Common Module\nUpdate Application (ALCMUpdate.exe) ­ the\nprogram used to conduct the routine checks for\nALTools software updates. This vulnerability\nallowed a malicious Dynamic Link Library (DLL)[12]\n\nfile to be loaded instead of the legitimate DLL update\nfile (ALAd.dll), thereby enabling malicious code to be\nrun and malicious software (malware) to be\ninstalled on computers which requested the update.\nOver 60 SK Communications computers were\ncompromised via the trojaned update. (ESTsoft,\n2011) (EDaily, 2011) (ESTsoft, 2011)\n\nThe attackers are believed to have designated\ntargets for infection, so that the trojaned update was\nonly delivered to SK Communications computers\nand not to other computers requesting the same\n\n9 According to South Korean news outlets the attackers used\nChinese IP addresses. (Goodin, 2011)\n10 A CDN is comprised of multiple servers which are used to\ndistribute software downloads, thereby balancing the load and\npreventing outages due to individual servers becoming\noverloaded.\n11 A software vulnerability existed in the update program used by\nseveral tools in the ALTools suite. The vulnerability allowed\narbitrary code to be executed but could only be exploited from the\nactual update server or, if a computer could be directed to it (eg.\nby modifying the host file on the computer or via DNS hijacking),\na fake update server. A patch for the vulnerability was released on\n4 August 2011. (ESTsoft 2011) (ESTsoft, 2011)\n12 According to Microsoft, a DLL is a library that contains code and\ndata that can be used by more than one program at the same time.\n(Microsoft 2007)\n\n\nPAGE 2 OF 24\n\n\n-----\n\nsoftware update from the server[13]. The way the\nupdate server was used in the attack is depicted in\nFigure 1.\n\n**1.**\n\nAttacker\n\nALZip Update Server\n\n**2.**\n\nTargeted Non­targeted\nComputers Computers\n\n**3.**\n\nMalicious Legitimate\nCDN CDN\n\n**1.** Attacker modifies the ALZip update server.\n**2.** Computers check for ALZip software updates and are\nredirected to a Content Delivery Network (CDN).\n**3.** Non­targeted computers download a legitimate\nupdate from the ESTsoft CDN. Targeted computers\ndownload a trojaned update from the attacker’s\nmalicious CDN.\n\nFIGURE 1 ­ DEPICTION OF HOW THE ALZIP UPDATE\nSERVER WAS USED IN THE ATTACK\n\nThis specific targeting of SK Communications\nindicates the targeting wasn’t purely opportunistic.\nTo target the company in the manner they did, the\nattackers would have needed knowledge of SK\nCommunications and its use of ALZip, ahead of the\n\n13 The Korean National Police Agency presumes the hacker,\ninstead of targeting all ALZip users, singled out the intranet\ncomputers at SK Communications. (Moon­young, 2011)\n\n\nattack. This knowledge was likely gained during the\nreconnaissance[14] stage of the attack.\n\n**THE INFECTED COMPUTERS**\n\nAfter the ALZip update program (ALCMUpdate.exe)\ndownloaded the trojaned update onto the 60+ SK\nCommunications computers, the computers\nsubsequently became infected with malware known\nas ‘Backdoor.Agent.Hza’. The trojaned update file\n‘dropped’ the malware ‘Backdoor.Agent.Hza’ onto\nthe computers and, in so doing, gave the attacker a\n‘backdoor’ into them. The trojaned update is\ndetected as ‘Trojan.Dropper.Agent.Hza\nBackdoor.Agent.Hza’ and ‘V.DRP.Agent.Hza\nV.BKD.Agent.Hza’ by different versions of ESTsoft’s\nALYac antivirus software. (ESTsoft, 2011) (ESTsoft,\n2011)\n\nOnce infected, the computers communicated\nwith the command and control server located at\nSouth Korean IP address 116.127.121.41 on\nTransmission Control Protocol (TCP) port 8080[15]. It\nis possible the infected SK computers used the\ncallback domain ‘update.alyac.org’ (reportedly\nassociated with the hack[16]) to locate the command\nand control server. It is, however, unconfirmed\nwhether the domain ‘update.alyac.org’ resolved to\nthe South Korean IP address at the time of the\nattack. (ESTsoft, 2011) (Samsung IDC, 2011)\n(ETnews, 2011)\n\nBetween 18 July 2011 and 25 July 2011, the\nattackers used the infected computers to collect\nadditional internal access information and database\ncredentials. They presumably used a file named\n‘x.exe’[17] to acquire some of this information, after\ndownloading it onto infected computers from a\ntoolbox they had earlier set up. Based on the\nbehaviour of this file, the attackers likely used it to\nconduct network enumeration and to obtain\n\n14 For an explanation of the reconnaissance stage of an attack\nrefer to the Command Five Paper ‘Advanced Persistent Threats: A\nDecade in Review’ (Command Five Pty Ltd, 2011).\n15 According to Samsung IDC, the ALTools related command and\ncontrol server was using IP address 116.127.121.41.\n16 According to ETnews the domain ‘update.alyac.org’ was used in\nthe hack. ETnews does not state how the domain was involved\nbut, given the infected computers had ALTools installed on them,\nuse of ‘ALYac.org’ in the callback domain may have helped to\ndisguise the malicious communications. (ETnews 2011)\n17 The file named ‘x.exe’ is 51712 bytes and has a SHA1 hash of\n5A1B E6AD CB2C C40B 2E9D 6B6C 569F D4DA B273 E7AD.\n(JSUNPACK, 2011)\n\n\n**1.**\n\nAttacker\n\nALZip Update Server\n\n\n**2.**\n\nTargeted Non­targeted\nComputers Computers\n\n\nPAGE 3 OF 24\n\n\n**3.**\n\nMalicious Legitimate\nCDN CDN\n\n\n-----\n\ncredentials such as usernames and passwords [18].\n(Birdman, 2011) (Moon­young, 2011)\n\nThe attacker also installed the malware used to\naccess the user databases on at least one of the\ninfected computers. The malware was named\n‘nateon.exe’[19] and was also hosted on the same\ntoolbox, along with another file named ‘rar.exe’[20].\n(Birdman, 2011) (Hauri ­ Response Team, 2011)\n\nStatic analysis[21] of the file ‘rar.exe’ indicates it is\na modified version of the WinRar[22] command line\nprogram ­ also named ‘rar.exe’. The file may have\nbeen used in the attack to create or open archive\nfiles. The modifications made to the program\nremove the program properties from display,\npresumably to disguise the true nature of the file.\nThis is somewhat redundant in this instance though,\ngiven the file name indicates the nature of the\nprogram.\n\n**THE TOOLBOX**\n\nThe files downloaded onto the infected SK\nCommunications computers were reportedly hosted\nat ‘www.cph.com.tw/act’[23] – a website belonging to\nthe large Taiwanese publishing company, Cite Media\nHolding Group [24] . It is likely the company’s\nwebserver was compromised unbeknownst to its\nowner and used by the attacker as a toolbox from\nwhich to download malicious files and hacker tools\nonto targeted computers.\n\nThe website ‘cph.com.tw’ is assumed to have\nbeen running on an Internet Information Services\n(IIS) webserver at the time the server was hacked [25].\nIIS runs on the Microsoft Windows operating\nsystem, indicating the compromised server was\n\n18 Antivirus software detects the file as\n‘Heuristic.BehavesLike.Win32.PasswordStealer.H’ and\n‘HKTL_NETVIEW’. (Hispasec Sistemas, 2011)\n19 The file named ‘nateon.exe’ is 166912 bytes and has a SHA1\nhash of F84C D73D ABF1 8660 7F98 6DF9 8C54 02A5 7BB5\n8AD1. It is detected as ‘Backdoor.Sogu’ by Symantec antivirus\nsoftware. (JSUNPACK 2011). (Hispasec Sistemas, 2011)\n20 The file named ‘rar.exe’ is 337920 bytes and has a SHA1 hash of\nE87C 3ACB A599 5E01 7AD3 1B29 A5E2 FE36 3ED4 D9EB.\n(JSUNPACK 2011)\n21 Static analysis refers to analysis of a program’s code to\ndetermine its functionality, as opposed to dynamic analysis in\nwhich a program is executed to determine its behaviour.\n22 WinRAR is a popular archiving and compression tool.\n23 The files ‘nateon.exe’, ‘rar.exe’ and ‘x.exe’ were hosted at\n‘www.cph.com.tw/act’. (Birdman, 2011)\n24 Cite Media Holding Group publishes over 20 million magazine\nissues each year in Taiwan. (Novell 2011)\n25 An archived error page shows the ‘cph.com.tw’ website was\nrunning on an IIS server in late 2010. (The Internet Archive 2010)\n\n\nlikely running Microsoft Windows. There are a\nnumber of known vulnerabilities for both IIS and\nMicrosoft Windows which potentially could have\nbeen exploited and resulted in the compromise of\nthe webserver[26].\n\n**THE DATABASE ACCESS**\n\nAfter the week collecting information from the\ninfected computers the attackers were ready to\naccess the databases. On 26 July 2011, they used the\ninformation they had gathered, along with a\nmalicious program named ‘nateon.exe’, to access the\nNate and CyWorld databases. The theft of\ninformation continued into the following day ­ 27\nJuly 2011. (Birdman, 2011) (Moon­young, 2011)\n(Hauri ­ Response Team, 2011)\n\nThe personal information extracted from the\ndatabases was purportedly sent via a waypoint to a\nChinese IP address where the hacker received the\ninformation. The waypoint used purportedly\nbelonged to a company based in Seoul’s Nonhyeon\nneighbourhood. (Moon­young, 2011)\n\nThe South Korean waypoint may have been\nlocated by the malware using the callback domain\n‘ro.diggfunny.com’ which was reportedly associated\nwith the leak of information from the databases[27]. It\nhas not, however, been confirmed whether, at the\ntime of the attack, this callback domain pointed to an\nIP address belonging to a Nonhyeon­based company.\n\n26 Both the Microsoft Security TechCenter and the US National\nVulnerability Database make available a comprehensive list of\nMicrosoft Windows and IIS vulnerabilities. (Microsoft n.d.)\n(National Institute of Standards and Technology n.d.)\n27 According to Samsung IDC the IP address 116.127.121.109 was\nassociated with the leak of database files from Nate. (Samsung\nIDC 2011)\n\n\nPAGE 4 OF 24\n\n\n-----\n\n10026210/10070910: 31 9C 6C 4C B9 3A 10 00 E8 03 00 00 01 00 **50 00 1.lL.:..è.....P.**\n10026220/10070920: 6E 61 74 65 6F 6E 2E 64 75 61 6D 6C 69 76 65 2E **nateon.duamlive.**\n10026230/10070930: 63 6F 6D 00 00 00 00 00 00 00 00 00 00 00 00 00 **com.............**\n10026240/10070940: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................\n…\n100268A0/10070FA0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................\n100268B0/10070FB0: 00 00 00 00 00 00 00 00 00 00 00 00 77 69 6E 73 ............wins\n100268C0/10070FC0: 76 63 66 73 00 00 00 00 00 00 00 00 00 00 00 00 **vcfs............**\n100268D0/10070FD0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................\n…\n10026930/10071030: 00 00 00 00 00 00 00 00 00 00 00 00        ............\n\n\nFIGURE 2 ­ EXCERPTS FROM THE ‘NATEON.EXE’ CONFIGURATION BLOCK\n\n\n**THE DESTORY RAT**\n\n_Structure and Behaviour_\n\nThe malicious program named ‘nateon.exe’ installs a\nRemote Administration Tool (RAT) named\n‘winsvcfs.dll’. It modifies the system registry in such\na way that the RAT gets executed as a service by the\ntrusted process ‘svchost.exe’ [28] each time the\ncomputer is started. Once ‘winsvcfs.dll’ is installed,\n‘nateon.exe’ is deleted. Both ‘nateon.exe’ [29] and\n‘winsvcfs.dll’[30] are now detected by some antivirus\nsoftware.\n\nStatic analysis of the malware reveals a\nconfiguration block. This configuration block\ncontains the name of the DLL file which ‘nateon.exe’\nis to create. In this instance, the configured named\nwas ‘winsvcfs.dll’, as shown in Figure 2. Due to the\nname being configurable, the RAT will not always be\ncalled ‘winsvcfs.dll’. The configuration block also\ncontains a callback domain and port for the\nmalware’s command and control communications.\nThe callback domain is configured to be\n‘nateon.duamlive.com’ and the port is configured to\nbe 80 (50 in hexadecimal), also shown in Figure 2.\n\nIf no configuration is specified, the malware\nuses default values instead. The default callback\nlocation hardcoded into the malware is the private\nIP address, 192.168.0.200. This address is not\n\n28 The process ‘svchost.exe’ is a generic host process for services\nwhich run from DLLs. (Microsoft, A description of Svchost.exe in\nWindows XP Professional Edition 2007)\n29 On 29 July 2011, 23 of 43 antivirus products tested detected\n‘nateon.exe’ as malware, as of 19 August 2011 this number had\nincreased to 36 of the 43. (Hispasec Sistemas 2011) (Hispasec\nSistemas 2011)\n30 As of 6 September 2011, 34 of 44 antivirus products tested\ndetected ‘winsvcfs.dll’ as malware. (Hispasec Sistemas 2011)\n\n\nroutable on the Internet and suggests the attackers\nrely on the configuration instead of the hardcoded\ncallback address.\n\nAccording to information contained within\n‘nateon.exe’, the malware used in the SK\nCommunications hack was compiled from source\ncode on 27 September 2010 at 01:17.04 ­ over 6\nmonths before the attack. The configuration block\nwas likely inserted into the binary after this date as\nthe callback domain was not registered until May\n2011. This may indicate that the RAT has been used\nin other attacks but with different configurations. If\nthe previously identified ‘Backdoor.Sogu’ [31] is a\nversion of the malware, other callback domains\npreviously configured may include those known to\nbe used by ‘Backdoor.Sogu’. These domains include\n‘bbs.afbjz.com', ‘newhose.ntimobile.com', and\n‘www.adv138mail.com'[32].\n\nThe RAT has many different capabilities and\nruns on multiple versions of the Microsoft Windows\noperating system. The RAT's behaviour changes\nslightly depending on which version of the Windows\noperating system it is installed on and which\nmodules are installed. Modules used by the RAT\ndeployed to the SK Communications network\ninclude:\n\n31 Symantec antivirus software detects ‘nateon.exe’ as\n'Backdoor.Sogu'. The malware described by Symantec exhibits\nsimilar behaviour to 'nateon.exe' but is a smaller size. (Mullaney,\n2011)\n32 In addition to being used by ‘Backdoor.Sogu’, the callback\ndomain 'www.adv138mail.com' was used by a Poison Ivy RAT in a\nJuly 2011 socially engineered email campaign which targeted\nexperts on the relationship of the United States with Japan, China\nand Taiwan. (Parkour, 2011)\n\n\nPAGE 5 OF 24\n\n\n-----\n\n� advapi32.dll,\n� cryptbase.dll,\n� gdi32.dll,\n� iphlpapi.dll,\n� kernel32.dll,\n� mpr.dll,\n� msvcrt.dll,\n� ntdll.dll,\n� odbc32.dll,\n� ole32.dll,\n� psapi.dll,\n� sfc.dll,\n� shell32.dll,\n� shlwapi.dll,\n� user32.dll,\n� userenv.dll,\n� version.dll,\n� wininet.dll,\n� ws2_32.dll,\n� wtsapi32.dll.\n\nOf note, the module ‘odbc32.dll’ is used in the\naccess of databases. The RAT uses a number of\nStandard Query Language (SQL)[33] functions which\nare accessed (or more technically, dynamically\nimported) as the software runs. These include:\n\n� SQLAllocHandle,\n� SQLColAttributeW,\n� SQLDisconnect,\n� SQLDriverConnectW,\n� SQLExecDirectW,\n� SQLFetch,\n� SQLFreeHandle,\n� SQLGetData,\n� SQLGetDiagRecW,\n� SQLMoreResults,\n� SQLNumResultCols,\n� SQLSetEnvAttr.\n\nThese functions would have been utilised by the\nattacker to communicate with the Nate and CyWorld\nuser databases and thereby, to obtain the personal\ndetails.\n\nThe RAT can not only access and query\ndatabases but can also enumerate the networks to\nwhich the infected computer is connected, set up\nnetwork connections, modify the registry, lock the\nworkstation's screen, control processes and services\n\n33 SQL instructions are used to query certain types of databases\nand obtain information from them.\n\n\nrunning on the computer, download files, create\nfiles, take screenshots and shutdown, reboot or log\nout of the computer. The RAT has four different\noperating modes; SMI (Install), SMU (Uninstall),\nSMRAC (Run as Console) and SMRACU (Run as\nConsole User). (Hauri ­ Response Team, 2011)\n\nA complete list of strings obtained through static\nanalysis of the malware is provided in Annex A.\nThese strings give additional insight into the RAT\nand its behaviour. Of note, a unique string is present\nwhich may be used to associate ‘nateon.exe’ with\nother malware. This string is ‘CONFIG DESTORY!’\nand is contained within the malware in an\nobfuscated form. The string is displayed in a pop­up\nwindow if an integrity check the malware performs\non its configuration fails.\n\nThe RAT employs some basic obfuscation\ntechniques. All strings are obfuscated in memory\nand only decoded when they need to be used,\nthereby making static analysis more difficult. In\naddition, unnecessary operations are inserted at\nfrequent intervals throughout the code. The prolific\nuse of unnecessary operations is likely to make\nreverse engineering more difficult and potentially\nindicates that the malware is polymorphic[34]. The\nRAT, while in some ways sophisticated, still hides in\nplain sight – limiting its scope for obfuscation.\n\n_Communications_\n\nThe RAT attempts communications to a command\nand control server located using a callback domain.\nIt also creates a raw socket and binds it to the\ninfected computer’s local IP address (as assigned to\nthe computer’s network interface card). This is not,\nhowever, for the RAT to accept inbound connection\nrequests. The socket is configured by the RAT in\nsuch a way that it acts as a packet sniffer, whereby,\nthe RAT receives a copy of all inbound and outbound\nnetwork traffic on the bound interface. As well as\nenabling deep inspection of this network traffic, the\ncapability could allow the RAT to passively receive\ncommands on any port using any protocol.\n\nBefore attempting communications to the\ncommand and control server, the malware checks\nfor network connectivity. It does this by using the\n\n34 Polymorphic programs can be modified (or modify themselves)\nto have a different file hash and/or size while retaining the same\nfunctionality. This facilitates code reuse by making signature\nbased detection more difficult.\n\n\nPAGE 6 OF 24\n\n\n-----\n\nlegitimate Microsoft Windows domain\n‘download.windowsupdate.com’. This legitimate\ndomain is hardcoded into the malware but may be\noverridden by modifying the malware’s\nconfiguration.\n\nHaving determined there is network\nconnectivity, the malware establishes\ncommunications with the callback domain\n‘nateon.duamlive.com'[35] on TCP port 80 (configured\nas noted previously). Communications occur over\nthe HyperText Transfer Protocol (HTTP) protocol –\na protocol commonly used on TCP port 80 for\nwebsite browsing. The malware appears to be\nproxy­aware and capable of communicating via a\nweb proxy.\n\nThe following malformed user­agent[36] is present\nin the HTTP requests (spaces shown here as ‘·’):\n‘Mozilla/4.0·(compatible;·MSIE·6.0;·Windows·NT·5.\n1;SV1;’.\n\nThis user­agent is consistent with that which\nmay be expected from a user running version 6.0 of\nthe Microsoft Internet Explorer web browser on the\nMicrosoft Windows XP operating system, except that\nit is missing a closing bracket after the last\nsemicolon and a space after the second to last\nsemicolon. This malformed user­agent is hardcoded\nand can be used as a signature to detect HTTP\ncommunications produced by the malware.\n\nFour custom headers are also present in the\nHTTP requests: ‘X­Session’, ‘X­Status’, ‘X­Size’, and\n‘X­Sn’. The file path requested is\n‘/update?product=windows’. These custom headers\nand the file path may also be used to develop\nsignatures for detection of the RAT’s\ncommunications.\n\nOnce the malware successfully contacted the\ncommand and control server, the attacker would\nhave been able to give it instructions to access the\nNate and Cyworld databases and to send data from\nthem back to a location the attacker could access.\n\nThe name of the malware and the name of the\nselected callback domain were presumably chosen\n\n35 Multiple sources confirm the malware used in the hack called\nback to 'nateon.duamlive.com'. (Samsung IDC 2011) (Birdman,\n2011)\n36 User­agents are used in HTTP communications to tell\nwebservers which operating system and web browser their\nclients are using, so they can serve compatible webpages.\n\n\nby the attackers to disguise them as being associated\nwith NateOn ­ an Instant Messaging Service owned\nby SK Communications. Legitimate files developed\nby SK Communications are also known by the name\n‘nateon.exe'[37].\n\n**THE MALICIOUS INFRASTRUCTURE**\n\nCallback domains are translated to IP addresses\nusing the Domain Name System (DNS)[38] protocol.\nThis translates the domain into a unique address on\nthe Internet which infected computers can use to\nlocate and communicate with a command and\ncontrol server. Command and control servers are\ntypically more resource intensive to set up and\nmaintain than callback domains which may be used\nto direct communications to them. It is not\nuncommon for multiple domains to identify the\nsame command and control infrastructure.\n\nIn late July 2011, at the time of the attack, the\ncallback domain ‘nateon.duamlive.com’ pointed to\nthe South Korean IP address 121.78.237.135 but at\nthe time of writing points to local loopback IP\naddress 127.0.0.1[39]. Attackers quite commonly point\na callback domain to a local loopback IP address\nwhen they do not have any instructions for the\ninfected computers using that domain. This prevents\nthe computers from unnecessarily contacting the\nattacker’s command and control infrastructure.\nAttackers also quite commonly point a callback\ndomain to a local loopback IP address when they\nwant to protect their command and control\ninfrastructure from detection.\n\nAt the time of the attack, the callback domain\n‘ro.diggfunny.com’ pointed to the South Korean IP\naddress 116.127.121.109. This IP address is in the\nsame IP address range (116.127.0.0/16) [40] as the IP\naddress used by the ALTools related command and\ncontrol server (IP address 116.127.121.41). The IP\n\n37 Different versions of a legitimate file named 'nateon.exe' exist.\nThese files are associated with the NATEON Upgrader developed\nby SK Communications. (Mister Group n.d.)\n38 DNS is fundamental on the Internet. It is a form of directory\nassistance to help computers communicate with other computers.\nIts use is analogous to a person calling directory assistance to find\nout what phone number to dial to speak to a certain person.\n39 A local loopback IP address is an address which is not Internet\nor Intranet routable, ie. it can not be used by a computer to\ncommunicate with another computer. When a computer attempts\nto communicate with a local loopback IP address, it\ncommunicates with itself.\n40 The IP address range 116.127.0.0/16 is the Classless Inter­\nDomain Routing (CIDR) representation of IP addresses\n116.127.0.0 through 116.127.255.255.\n\n\nPAGE 7 OF 24\n\n\n-----\n\naddress range is allocated to the South Korean ISP\nHanaro Telecom.\n\nA portion of the IP address range appears to\nhave been assigned by Hanaro Telecom to a South\nKorean web hosting company. It is not known\nwhether the two IP addresses used by the attackers\nfall within the range used by the webhosting\ncompany. It is also unconfirmed whether that\ncompany is based in Nonhyeong ­ the geographic\nregion of the company that hosted the waypoint\nused in the attack.\n\nIf the IP addresses used by the attackers in the\nrange 116.127.121.0/24 were assigned to the web\nhosting company, it is possible the attackers\npurchased webhosting services through the\ncompany to host their command and control servers\ninstead of compromising legitimate servers. Other IP\naddresses in the range are also associated with\nmalware[41] but that malware may not be related in\nany way to the SK Communications hack or the\nattackers involved in the hack.\n\nIn late July 2011, at around the time of the\nattack, the callback domain ‘update.alyac.org’\npointed to the South Korean IP address\n202.30.224.240. As at the time of writing, the\ndomain now points to the legitimate Google IP\naddress 8.8.8.8. This is not an indication that the\nGoogle IP address is compromised, and the Google IP\naddress is unlikely to be compromised.\n\nThe Google IP address is likely only used to\nindicate that the attacker has no instructions for the\nmalware or to instruct the malware to continue with\npre­programmed behaviour. The malware likely has\nlogic built in which prevents it from communicating\nwith the Google IP address. Use of the Google IP\naddress would likely achieve the attacker’s desired\noutcome in a similar way to use of a local loopback\nIP address. It would, however, be less likely to flag\nthe activity to network defenders[42].\n\nIt is also possible the Google IP address is used\nto channel covert communications to the command\n\n41 The command and control servers of dozens of pieces of\nmalware have used IP addresses within the IP address range\n116.127.121.0/24. (Malc0de.com n.d.)\n42 Use of legitimate IP addresses in combination with\npreprogramed logic to prevent a communication with command\nand control infrastructure is a much less common indicator of\nmalicious activity than use of a local loopback IP address for the\nsame purpose.\n\n\nand control server over the DNS protocol[43], in effect,\nusing Google as a voluntary waypoint without\nactually compromising Google’s infrastructure.\n\nEach of the three callback domains has a Time­\nTo­Live (TTL) [44] of 30 minutes, allowing the\nattackers to rapidly change the command and\ncontrol server pointed to by the callback domain.\n\n_Registration Information_\n\nThe domain ‘duamlive.com’ was registered on 21\nMay 2011. It was registered by a ‘Guangming Wang’.\nThere is a large number of domain registrations\n(approximately 400) associated with ‘Guangming\nWang’, possibly indicating that the domains were\nregistered by an intermediary.\n\nThe domain ‘alyac.org’ was registered on 24\nSeptember 2010. The domain registration\ninformation is almost identical to that of the\nlegitimate ESTsoft domain ‘alyac.com’. The domain is\nnot, however, associated with the ALYac antivirus\nsoftware and does not appear to be associated with\nESTsoft at all. The title of the website previously\nhosted at ‘alyac.org’ was associated with finance,\ninsurance and cell phones and not antivirus\nsoftware[45].\n\nAt the time of writing, the malicious domain\n‘alyac.org’ points to the Google IP address 8.8.8.8 but\npreviously pointed to South Korean IP address\n222.122.20.241. Other probable malicious domains\nfollowing a similar pattern to ‘alyac.org’ (whereby\nthey disguise themselves as being associated with\nlegitimate software companies) have also pointed to\nthe same South Korean IP address. These include the\ndomains ‘trendmicros.net’, ‘nprotects.org’ and\n‘bomuls.com’.\n\nThe domain ‘trendmicros.net’ was purportedly\nregistered by Trend Micro Inc. The registration\ndetails are almost identical to that of the legitimate\ndomain ‘trendmicro.com’. The domain, however,\nappears to have nothing to do with the security\ncompany. The malicious domain ‘nprotects.org’ is\nsimilar to that of the legitimate security company\n\n43 The malware could use a similar technique to software such as\niodine. (Kryo, 2010)\n44 The TTL of a domain in a DNS record refers to the duration for\nwhich the DNS result can be cached.\n45 A webpage previously hosted at 'alyac.org' had a title of 'Cash\nAdvance | Debt Consolidation | Insurance | Free Credit Report |\nCell Phones at alyac.org’. (Domain Tools, LLC, 2011)\n\n\nPAGE 8 OF 24\n\n\n-----\n\nnProtect (‘nprotect.com’) but again, does not appear\nto be associated with the company. The domain has\npreviously been associated with malware known as\n‘Trojan.Win32.Generic’ [46] . Similarly the domain\n‘bomuls.com’ is not dissimilar to that of the\nlegitimate software company whose website resides\nat ‘bomul.com’. (ETnews, 2011)\n\nThe domains referenced above are summarised\nin Table 1.\n\nDOMAIN SUBDOMAIN IP ADDRESS(ES)\n\nDUAMLIVE.COM ­ 127.0.0.1*\n\nNATEON. 121.78.237.135 (KR)\n127.0.0.1*\n\nFR. 121.78.237.135 (KR)\n127.0.0.1*\n\nALYAC.ORG ­ 222.122.20.241 (KR)\n8.8.8.8 (US)*\n\nUPDATE. 202.30.224.240 (KR)\n8.8.8.8 (US)*\n\nPATH. 8.8.8.8 (US)*\n\nWWW. 8.8.8.8 (US)*\n\nNPROTECTS.ORG ­ 222.122.20.241 (KR)*\n\nFILE1. 222.122.20.241 (KR)*\n\nPC. 220.90.209.157 (KR)\n222.122.20.241 (KR)*\n\nTRENDMICROS.NET ­ 222.122.20.241 (KR)*\n\nDOWNLOAD. 222.122.20.241 (KR)*\n\nBBS. 222.122.20.241 (KR)*\n\nBOMULS.COM ­ 66.249.89.104 (US)\n222.122.20.241 (KR)\n98.126.8.230 (US)*\n\nDOWNLOAD. 222.122.20.241 (KR)*\n\nFORUM. 222.122.20.241 (KR)*\n\n        - Indicates IP address assigned at time of writing.\n\nTABLE 1 ­ SUMMARY OF REFERENCED DOMAINS\n\n46 Malware detected as ‘Trojan.Win32.Generic’ in May 2011 used\nthe callback domain ‘pc.nprotects.org’. (GFI SandBox, 2011)\n\n\nThe domain ‘diggfunny.com’ was registered on\n14 April 2011 by a ‘Lee Cooper’. The same registrant\ndetails were used to register several other domains.\nThese domains include ‘edsplan.com’, ‘ezxsoft.com‘,\n‘finalcover.com’, ‘mindplat.com’, ‘projectxz.com’, and\n‘soucesp.com’ ­ all of which were registered on 14\nApril 2011. The domains ‘daumfan.com’ and\n‘natefan.com’ were also registered by ‘Lee Cooper’,\nbut on 25 July 2011, the day before the hacking\noperation against the Nate and CyWorld user\ndatabases. The same registrant details were\npurportedly used to register an additional seven\ndomains. Each of these domains has a TTL of 30\nminutes. (Domain Tools, LLC, 2011)\n\nAt the time of writing none of the above\ndomains registered by ‘Lee Cooper’ point to a\nmalicious IP address. The domain ‘natefan.com’\npoints to the Google IP address 8.8.8.8,\n‘daumfan.com’ points to the Enom Inc[47] IP address\n8.5.1.42, ‘finalcover.com’ points to the private IP\naddress 192.168.10.132 and none of\n‘diggfunny.com’, ‘ezxsoft.com’, ‘edsplan.com’,\n‘mindplat.com’, ‘projectxz.com’ or ‘soucesp.com’\ncurrently point to an IP address. This suggests the\ndomains are not currently in use, however, at least\none subdomain appears to be in current use as\nshown in Table 2.\n\n47 Enom Inc is a legitimate domain name registrar used by the\nattackers to register domain names and also to host webpages.\n\n\nPAGE 9 OF 24\n\n\n-----\n\nDOMAIN SUBDOMAIN IP ADDRESS(ES)\n\nDAUMFAN.COM ­ 8.5.1.8 (US)\n8.5.1.42 (US)*\n\nWWW. 8.5.1.8 (US)\n8.5.1.42 (US)*\n\nDIGGFUNNY.COM ­ 8.8.8.8 (US)\n\nRO. 116.127.121.109 (KR)\n\nWWW. 8.8.8.8 (US)\n61.19.250.219(TH)\n\nEDSPLAN.COM ­ 64.74.223.10 (US)\n\nITT. 127.0.0.1*\n\nEZXSOFT.COM ­\n\nBBS. 202.30.224.240 (KR)\n8.8.8.8* (US)\n\nFINALCOVER.COM ­ 192.168.10.132*\n\nI. 69.197.132.132 (US)\n127.0.0.1*\n\nT. 218.213.229.69 (HK)\n218.213.229.68 (HK)*\n\nMINDPLAT.COM ­ 64.74.223.48 (US)\n\nCACHE. 8.8.8.8 (US)*\n\nNATEFAN.COM ­ 8.8.8.8 (US)*\n\nPROJECTXZ.COM ­ 8.5.1.11 (US)\n\nITT. 202.181.170.67 (HK)\n8.8.8.8 (US)*\n\nSOUCESP.COM ­ 61.82.71.30 (KR)\n127.0.0.1\n\n        - Indicates IP address assigned at time of writing.\n\nTABLE 2 ­ DOMAINS REGISTERED BY LEE COOPER\n\nSeveral of the domains registered by ‘Lee\nCooper’ previously pointed to webpages. The\ndomain ‘mindplat.com’ previously pointed to an\nEnom Inc. server which hosted its webpage. The title\nand meta description of the ‘mindplat.com’ website\nis almost identical to that of the ‘alyac.org’ website.\nBoth websites follow the template shown in Figure\n3. The same template has also been used for several\nother webpages and may merely be a template\nprovided by a service provider used by the\nregistrants.\n\nThe domains ‘natefan.com’ and ‘projectxz.com’\nalso previously pointed to webpages. The webpages\nwere similar to the ‘mindplat.com’ and ‘alyac.org’\nwebpages but with different text. Again, these\nwebpages use the same template as other webpages\nand may merely be provided by a service provider.\nThe presence of these webpages may indicate an\nattempt by the attackers to make the malicious\ndomains appear more legitimate.\n\n\n**Title**\n\nCash Advance | Debt Consolidation | Insurance | Free Credit\nReport | Cell Phones @ domain\n\n**Meta Description**\n\nFind Cash Advance, Debt Consolidation and more at domain. Get\nthe best of Insurance or Free Credit Report, browse our section\non Cell Phones or learn about Life Insurance. Domain is the site\n\nfor Cash Advance.\n\n\nFIGURE 3 ­ EXAMPLE OF WEBPAGE TEMPLATE USED\n\n**SIMILARITIES TO OTHER MALWARE**\n\nAs previously discussed, the domain\n‘ro.diggfunny.com’ is associated with malicious\nactivity. The domains ‘cache.mindplat.com’ and\n‘bbs.ezxsoft.com’ are also known to be associated\nwith malware. The first is listed as a malicious\ndomain[48] and the second was used as a callback\ndomain by malware known as\n‘Trojan.Win32.AgentBypass’ 49 . The domain\n‘bbs.ezxsoft.com’ also previously pointed to the\nsame South Korean IP address as ‘update.alyac.org’\n(IP address 202.30.224.240), further linking it to the\nattackers responsible for the hack into SK\nCommunications.\n\nEven if ignoring the connection they both have\nto the domain ‘alyac.org’, the two pieces of malware\nnamed ‘Trojan.Win32.Generic’ and\n‘Trojan.Win32.AgentBypass’ respectively (earlier\nreferenced) are still linked. Both pieces of malware\ncreate a uniquely named directory[50], as do at least\nthree other pieces of malware (summarised in\nAnnex B). This further links the domains\n‘nprotects.org’ and ‘ezxsoft.com’, and suggests this\nmalware, along with the callback domains, may be\npart of a broader, concerted effort by the same\nattackers.\n\n48 The domain 'cache.mindplat.com' is listed alongside\n'ro.diggfunny.com' in a list of malicious web addresses.\n(CEOinIRVINE 2011).\n49 Malware detected as 'Trojan.Win32.AgentBypass' in mid July\n2011 used the callback domain 'bbs.ezxsoft.com'. (GFI SandBox\n2011)\n50 Malware analysis reports indicate both pieces of malware\ncreate a directory named ‘03a075fb70d5d675f9dc26fc’ inside the\nsystem directory and a subdirectory named ‘update’. (GFI\nSandBox 2011) (GFI SandBox, 2011)\n\n\nPAGE 10 OF 24\n\n\n-----\n\n**TIMELINE** **INSIGHTS**\n\n� Attackers will conduct reconnaissance on\n\n**24 September 2010**\n\ntheir targets and consider all sorts of\n\nThe domain 'alyac.org' is registered.\n\ntargeting options (both direct and indirect).\n� Attackers may target a company in order to\nuse it as a ‘launchpad’ to gain access to\n\n**27 September 2010**\n\nother targets, as demonstrated by the\n\nThe Destory RAT is compiled.\n\ntargeting of ESTsoft's ALZip update server.\n� Attackers can conduct selective targeting ­\nchoosing which computers download\n\n**14 April 2011**\n\nmalicious content and which do not, as they\n\nThe domain 'diggfunny.com' is registered\n\nappear to have done with the ALZip update\n\nalong with other domains.\n\nserver.\n� Even though two computers may submit an\nidentical request for a file (or webpage),\n\n**21 May 2011** they may not get the same file (or webpage)\n\nback in response. This behaviour reduces\n\nThe domain 'duamlive.com' is registered.\n\nthe likelihood of malware unintentionally\ngoing viral. Unfortunately it also hampers\ninvestigations by network defenders who\n\n**18 July 2011**\n\nmay assess a file (or webpage) to be safe,\n\nOn or prior to this date attackers\n\nwhen it is not safe to all users.\n\ncompromise the ESTSoft ALZip update\n\n� Attackers may hack a computer for the sole\n\nserver.\n\npurpose of using it as a ‘waypoint’ or as an\nintermediary location from where they can\nstore and access their tools without\nsuspicion from their targets. This appears to\n\n**18­25 July 2011**\n\nhave been the case with the use of the Cite\n\nNumerous SK Communications computers\n\nMedia Holding Group webserver and the\n\nbecome infected during routine ALZip\n\nNonhyeong based waypoint, although it is\n\nsoftware updates. Attackers use their new\n\npossible they were initially hacked for\n\naccess to download tools and prepare for another reason.\n\ntargeting of the user database. � Attackers may use the same registration\n\ninformation to register multiple domain\nnames. Such appears to have been the case\nwith the domains registered by ‘Lee\nCooper’.\n\n**25 July 2011** � Attackers may register domains containing\nThe domains ‘daumfan.com’, and words that are expected to make them\n\n'natefan.com' are registered. appear less suspicious to targets. Such as\n\nwith the use of ‘nateon'and ‘alyac’ in the\ncallback domains used by infected SK\nCommunications computers.\n\n**26 ­ 28 July 2011** � Attackers may use seemingly legitimate\nThe attackers use ‘nateon.exe’ malware and registration information to register domain\nthe callback domains ‘nateon.duamlive.com’ names. Such appears to have been the case\n\nand ‘ro.diggfunny.com’ to access SK with the registration of ‘alyac.org’ and\nCommunications’ Nate and CyWorld user ‘trendmicros.net’.\ndatabases, stealing the personal details of � Users should be wary of domains which\n\nup to 35 million users. appear to be legitimate but are not. Such as\n\n‘alyac.org’ instead of ‘alyac.com’,\n\nPAGE 11 OF 24\n\n\n**26 ­ 28 July 2011**\nThe attackers use ‘nateon.exe’ malware and\nthe callback domains ‘nateon.duamlive.com’\n\nand ‘ro.diggfunny.com’ to access SK\nCommunications’ Nate and CyWorld user\ndatabases, stealing the personal details of\n\nup to 35 million users.\n\n\n**18 July 2011**\nOn or prior to this date attackers\ncompromise the ESTSoft ALZip update\n\nserver.\n\n\n**25 July 2011**\nThe domains ‘daumfan.com’, and\n\n'natefan.com' are registered.\n\n\n**27 September 2010**\nThe Destory RAT is compiled.\n\n\n-----\n\n‘trendmicros.net’ instead of\n‘trendmicro.com’, ‘nprotects.org’ instead of\n‘nprotect.com’ and ‘bomuls.com’ instead of\n‘bomul.com’.\n� Even though it is relatively easy to create\nnew infrastructure, attackers sometimes\nreuse infrastructure. For example, the\ndomains ‘bbs.ezxsoft.com’ and\n‘update.alyac.org’ both previously pointed\nto IP address 202.30.244.240, and\n‘alyac.org’, ‘trendmicros.net’, ‘nprotect.org’\nand ‘bomuls.com’ all pointed to IP address\n222.122.20.241.\n� The TTL of domains (in DNS records)\ncontrolled by attackers are often set to low\nvalues (such as 30 minutes) allowing the\nattackers to rapidly change the command\nand control server pointed to by a callback\ndomain. This facilitates relatively\nuninterrupted access to a target when\ncommand and control infrastructure\nbecomes blocked or is otherwise\nunavailable.\n� The use of legitimate domains for malicious\npurposes, familiar words in domain names\nand of non­malicious IP addresses in DNS\nrecords for malicious domains, can make\ndetection of malicious activity more difficult\nand cause network defenders to dismiss\nmalicious activity (in network/system logs\nor Intrusion Detection System alerts, in\nparticular) as legitimate.\n\n**DISCLAIMER**\n\n\n� Adding malicious IP addresses and domains\nto blacklists can help prevent malicious\nactivity, however, attackers can respond by\nmerely using alternate infrastructure\nand/or callback domains.\n� Domains and IP addresses may have\nlegitimate purposes too and blacklisting\nthem may also block legitimate business.\nBlacklists should be reviewed periodically\nto ensure they are not blocking legitimate\nbusiness unnecessarily.\n� Whitelists are generally much more\neffective than blacklists, however, even\nwhitelists can allow malicious activity to\noccur to legitimate sites that have been\ncompromised. For example, as a good\nsecurity practice, most system\nadministrators would have allowed access\nto the ALZip update server if they had ALZip\nsoftware installed on their network.\nSimilarly, if a whitelist were employed on\nthe targeted network but users had a\nlegitimate need to access the website of the\nTaiwanese publishing company, the\nattacker would likely still have been able to\naccess their toolbox.\n� Users and network administrators need to\ncontinually reassess who and what they\ntrust on the Internet given that trust\nrelationships can be, and increasingly are,\nexploited for malicious purposes.\n\n\nMachine translation software has been heavily relied on throughout the\ndevelopment of this paper. While data has been verified against\nmultiple sources, where possible, Command Five Pty Ltd does not\nguarantee the veracity of sources or the accuracy of translation and\ninterpretation. Command Five Pty Ltd reminds readers to exercise\ncaution when visiting untrusted websites and/or opening untrusted\ndigital documents. Command Five Pty Ltd does not warrant that the\nwebsites referenced in this paper are trustworthy.\n\nPAGE 12 OF 24\n\n\n-----\n\n**REFERENCES**\n\nBirdman. (2011, July 31). Xecure Lab Blog. Retrieved August 12, 2011, from http://blog.xecure­\nlab.com/2011/07/2500.html\n\nCEOinIRVINE. (2011, August 17). Information Security & US & Life & Love & Fashion & Hacking & Passion. Retrieved\nSeptember 13, 2011, from http://hack3r.tistory.com/tag/Malware\n\nCommand Five Pty Ltd. (2011, June). Advanced Persistent Threats: A Decade in Review. Retrieved September 24,\n2011, from Command Five Pty Ltd:\nhttp://www.commandfive.com/papers/C5_APT_ADecadeInReview.pdf\n\nDomain Tools, LLC. (2011). AlYAc.org ­ Al Y Ac ­ Screenshot History. Retrieved September 08, 2011, from\nDomainTools: http://www.domaintools.com/research/screenshot­history/alyac.org\n\nDomain Tools, LLC. (2011). Reverse Whois Lookup | Domain Ownership Search | Domain Tools. Retrieved\nSeptember 22, 2011, from Domain Tools: http://www.domaintools.com/research/reverse­\nwhois/?all[]=leecooper%40korea.com&none[]=\n\nEDaily. (2011, August 11). Nate hack related. Retrieved September 14, 2011, from EDaily Korean News:\nhttp://www.edaily.co.kr/news/NewsRead.edy?SCD=DC16&newsid=02056566596346336&DCD=A0140\n5&OutLnkChk=Y\n\nESTsoft. (2011, August 04). ESTsoft apology for ALTools security vulnerability. Retrieved September 14, 2011, from\nESTsoft Blog: http://blog.estsoft.co.kr/138\n\nESTsoft. (2011, August 05). ESTsoft news release with respect to ALTools security vulnerability. Retrieved\nSeptember 19, 2011, from ESTsoft Blog: http://blog.estsoft.co.kr/139\n\nESTsoft. (2011, August 11). Police release interim results on Nate hack. Retrieved September 14, 2011, from\nESTsoft Blog: http://blog.estsoft.co.kr/143\n\nESTsoft. (2011, August 04). Urgent security patches for public ALTools products. Retrieved September 20, 2011,\nfrom ALTools Announcements: http://www.altools.co.kr/Plaza/Notice_Contents.aspx?idx=828\n\nETnews. (2011, August 05). ETnews ­ Nate hack, planned since last year? Retrieved August 12, 2011, from\nhttp://www.etnews.com/news/print.html?id=201108050128\n\nGFI SandBox. (2011, May 30). GFI SandBox Malware Analysis Report: Backdoor.Win32.Generic. Retrieved\nSeptember 22, 2011, from GFI SandBox:\nhttp://xml.ssdsandbox.net/view/6c6adbd087276ae89f8262582798b708\n\nGFI SandBox. (2011, July 15). GFI SandBox Malware Analysis Report: Trojan.Win32.AgentBypass. Retrieved August\n25, 2011, from http://xml.ssdsandbox.net/view/fdf2c5c2b1874efe7fd335092df2d3bc\n\nGFI SandBox. (2011, May 29). GFI SandBox Malware Analysis Report: Trojan.Win32.Generic!SB\n_Trojan.Trojan.Win32.Generic. Retrieved September 2011, 2011, from_\nhttp://xml.ssdsandbox.net/view/bce1069dd099f15170c5fd05bae921b5\n\nGFI Software. (2011, February 08). CWSandbox Report By MD5 at Sunbelt Security. Retrieved September 22, 2011,\nfrom\nhttp://www.sunbeltsecurity.com/partnerresources/cwsandbox/md5.aspx?id=e8ee9373ee6c836042e8f\n48d8de2dda9\n\nGoodin, D. (2011, August 12). Software maker fingered in Korean hackocalypse. Retrieved September 06, 2011,\nfrom The Register: http://www.theregister.co.uk/2011/08/12/estsoft_korean_megahack/\n\nPAGE 13 OF 24\n\n\n-----\n\nHauri ­ Response Team. (2011, August 04). SK Communications detailed analysis report of nateon.exe malware.\nRetrieved August 12, 2011, from http://www.hauri.co.kr/updata/SK_detail_report.pdf\n\nHispasec Sistemas. (2011, September 06). VirusTotal. Retrieved September 22, 2011, from\nhttp://www.virustotal.com/file­\nscan/report.html?id=727c5a2c3db079351a79351a79367a1d9eada072a8e19bce0a02eb680088e8eae9b\nd67­1315308204\n\nHispasec Sistemas. (2011, August 03). VirusTotal ­ Free online Virus, Malware and URL Scanner. Retrieved August\n12, 2011, from http://www.virustotal.com/file­\nscan/report.html?id=74455d5e8f99272aec64bce106b1e8ff39a122a7d27d362a274af31ab5a4fb1e­\n1313643321\n\nHispasec Sistemas. (2011, August 19). VirusTotal ­ Free Online Virus, Malware and URL Scanner. Retrieved\nSeptember 22, 2011, from http://www.virustotal.com/file­\nscan/report.html?id=74455d5e8f99272aec64bce106b1e8ff39a122a7d27d362a274af31ab5a4fb1e­\n1313760695\n\nHispasec Sistemas. (2011, July 29). VirusTotal ­ Free Online Virus, Malware and URL Scanner. Retrieved September\n22, 2011, from http://www.virustotal.com/file­\nscan/report.html?id=74455d5e8f99272aec64bce106b1e8ff39a122a7d27d362a274af31ab5a4fb1e­\n1311902003\n\nHispasec Sistemas. (2011, August 07). VirusTotal ­ Free Online Virus, Malware and URL Scanner. Retrieved August\n18, 2011, from http://www.virustotal.com/file­\nscan/report.html?id=b6aecab3c07e915e27db4b4be4c32de1ffa613029818bbd1bb755653c10fbe38­\n1311920836\n\nJapanese IT Promotion Agency. (2011, June 29). IPA/ISEC: Vulnerabilities: Security Alert for Vulnerability in ALZip.\nRetrieved September 18, 2011, from Japanese IT Promotion Agency:\nhttp://www.ipa.go.jp/security/english/vuln/201106_alzip_en.html\n\nJin­woo Seo, J.­h. H. (2011, July 28). 35mn User Info Leaked in Cyber Attack against S. Korean Portals. Retrieved\nSeptember 19, 2011, from MK Business News:\nhttp://news.mk.co.kr/english/newsRead.php?sc=30800005&cm=General&year=2011&no=491540&selF\nlag=sc&relatedcode=&wonNo=&sID=308\n\nJSUNPACK. (2011, July 27). jsunpack ­ a generic JavaScript unpacker. Retrieved August 14, 2011, from\nhttp://jsunpack.jeek.org/dec/go?report=9f5addc7e0c7c57eab347ba10e9a81a032cf0daf\n\nJSUNPACK. (2011, July 27). jsunpack ­ a generic JavaScript unpacker. Retrieved August 08, 2011, from\nhttp://jsunpack.jeek.org/dec/go?report=f84cd73dabf186607f986df98c5402a57bb58ad1\n\nJSUNPACK. (2011, July 27). jsunpack ­ a generic JavaScript unpacker. Retrieved August 04, 2011, from\nhttp://jsunpack.jeek.org/dec/go?report=2c645b8dee2789a0d5d1c1e173ca3bb6b0d0528e\n\nKryo. (2010, February 6). kryo.se: iodine (IP­over­DNS, IPv4 over DNS tunnel). Retrieved September 18, 2011, from\nkryo.se: http://code.kryo.se/iodine\n\nMalc0de.com. (n.d.). 116.127.121 | Malc0de Database. Retrieved August 22, 2011, from Malc0de Database:\nhttp://malc0de.com/database/index.php?search=116.127.121&IP=on\n\nMicrosoft. (2007, December 10). A description of Svchost.exe in Windows XP Professional Edition. Retrieved\nSeptember 07, 2011, from Microsoft Support: http://support.microsoft.com/?kbid=314056\n\nPAGE 14 OF 24\n\n\n-----\n\nMicrosoft. (2007, December 04). What is a DLL? Retrieved September 18, 2011, from Microsoft Support:\nhttp://support.microsoft.com/kb/815065\n\nMicrosoft. (n.d.). Security Center ­ Bulletins Advisories Tools Guidance Resources. Retrieved September 09, 2011,\nfrom Microsoft Security TechCenter: http://technet.microsoft.com/en­us/security/default\n\nMister Group. (n.d.). nateon.exe ­ What is the nateon.exe? Retrieved September 06, 2011, from\nhttp://systemexplorer.net/db/nateon.exe.html\n\nMoon­young, L. (2011, August 12). Personal information hack traced to Chinese IP address. Retrieved September\n09, 2011, from The Hankyoreh Media Company:\nhttp://english.hani.co.kr/arti/english_edition/e_national/491514.html\n\nMullaney, C. (2011, July 30). Backdoor.Sogu Technical Details | Symantec. Retrieved August 18, 2011, from\nhttp://www.symantec.com/security_response/writeup.jsp?docid=2011­073003­5345­99\n\nNational Institute of Standards and Technology. (n.d.). National Vulnerability Database. Retrieved September 20,\n2011, from http://nvd.nist.gov/home.cfm\n\nNovell. (2011). Novell Customer: Cite Media Holding Group. Retrieved July 29, 2011, from\nhttp://www.novell.com/success/cite.html\n\nParkour, M. (2011, July 14). contagio: Jul 13 CVE­2010­2883 PDF Meeting Agenda with more Poison Ivy\n_www.adv138mail.com | 112.121.171.94. Retrieved September 22, 2011, from Contagiodump Blog:_\nhttp://contagiodump.blogspot.com/2011/07/jul­13­cve­2010­2883­pdf­meeting­agenda.html\n\nSamsung IDC. (2011, August 05). Samsung IDC Helpdesk Notice. Retrieved August 12, 2011, from\nhttp://www.samsungidc.com/helpdesk/notice_view.jsp?bpd_seq=0000001532\n\nSK Communications. (n.d.). SK Communications ­ About Us. Retrieved September 06, 2011, from\nhttp://corp.skcomms.co.kr/eng/global.htm\n\nSung­jin, Y. (2011, July 28). 35m Cyworld, Nate users' information hacked. Retrieved September 06, 2011, from\nKorea Herald: http://www.koreaherald.com/lifestyle/Detail.jsp?newsMLId=20110728000881\n\nThe Internet Archive. (2010, August 14). Error page. Retrieved September 18, 2011, from The Internet Archive\nWayback Machine:\nhttp://web.archive.org/web/20100814135834/http://www.cph.com.tw/1jebugldgJtOAjb1wnXe8A==\n\nThreatExpert. (2011, July 13). ThreatExpert Report: Trojan.Win32.Scar.dysk, Bat/sdel. Retrieved September 22,\n2011, from http://www.threatexpert.com/report.aspx?md5=16a31aa8e7ddf66a31551840573b6575\n\nThreatExpert. (2011, August 03). ThreatExpert Report: Trojan.Win32.Scar.dzoc. Retrieved September 22, 2011,\nfrom http://www.threatexpert.com/report.aspx?md5=bce1069dd099f15170c5fd05bae921b5\n\nThreatExpert. (2011, July 29). ThreatExpert Report: Virus.Win32.Virut. Retrieved September 22, 2011, from\nhttp://www.threatexpert.com/report.aspx?md5=aba9baea70825e6adf0723587f273dc4\n\nTMCnews. (2011, August 11). S. Korea plans to scrap online real­name system. Retrieved September 19, 2011, from\nTMCnews: http://www.tmcnet.com/usubmit/2011/08/11/5698912.htm\n\nPAGE 15 OF 24\n\n\n-----\n\n**ANNEX A**\n\n**LIST OF DEOBFUSCATED STRINGS FOUND WITHIN ‘NATEON.EXE’**\n\nStrings inside ‘nateon.exe’ are stored in an obfuscated form and only deobfuscated as, and while, they are needed.\nThis table contains a complete list of deobfuscated strings extracted during static binary analysis of the malicious\nfile. For each string, two addresses are provided – the ‘Code Address’ and the ‘Obfuscated Address’. The ‘Code\nAddress’ is the address, in code, from which the string deobfuscation is requested. This address can be used to\nefficiently identify wrapper functions that dynamically import system APIs (such as those used for network\ncommunications), as well as to locate interesting parts of the malware. The ‘Obfuscated Address’ is the address, in\ndata, where the obfuscated string is stored.\n\nFor readability, the strings presented in the ‘Deobfuscated String’ column have been converted from their\noriginal formats. Some of the strings are stored inside ‘nateon.exe’ as 8­bit character strings and some as 16­bit\nwide character strings. Non­printable characters have been escaped as hexadecimal values in the form ‘<\\xHH>’\nor ‘<\\uHHHH>’. Trailing null (‘<\\x00>’) characters are not shown. Standard escape sequences such as ‘\\n’\n(newline) and ‘\\r’ (carriage return) are also used to improve readability.\n\n\nCODE\nADDRESS\n\n\nOBFUSCATED\nADDRESS\n\n\nDEOBFUSCATED STRING\n\n\nCODE\nADDRESS\n\n\nOBFUSCATED\nADDRESS\n\n\nDEOBFUSCATED STRING\n\n\n10001022 100220C0 \"LocalFree\"\n\n10001071 100220CC \"GetOEMCP\"\n\n100010BB 100220D8 \"GetCommandLineW\"\n\n10001105 100220EC \"GetCurrentProcess\"\n\n1000114F 10022100 \"Sleep\"\n\n1000119E 10022108 \"ExitProcess\"\n\n100011EA 10022118 \"TerminateProcess\"\n\n1000123B 1002212C \"lstrcmpiW\"\n\n1000128D 10022138 \"WaitForSingleObject\"\n\n100012DF 10022160 \"SetEvent\"\n\n1000132E 1002216C \"GetLastError\"\n\n10001378 100221B0 \"CommandLineToArgvW\"\n\n100013F5 10022150 \"TlsSetValue\"\n\n10001761 100221C4 \"SeDebugPrivilege\"\n\n100017A2 100221E8 \"SeTcbPrivilege\"\n\n10001A97 1002217C \"SetServiceStatus\"\n\n**10001B6A** **10022208** **\"SMI\"[51]**\n\n**10001BD6** **10022214** **\"SMU\"**\n\n**10001C47** **10022220** **\"SMRAC\"**\n\n**10001C8A** **10022230** **\"SMRACU\"**\n\n10001DA0 10022190 \"RegisterServiceCtrlHandlerExW\"\n\n10003AD9 10022240 \"GetProcessHeap\"\n\n10003B23 1002225C \"HeapFree\"\n\n10003B8F 10022250 \"HeapAlloc\"\n\n10003C64 10022268 \"FreeLibrary\"\n\n**10003CCD** **10022278** **\"ntdll.dll[52]\"**\n\n**10003D03** **10022284** **\"kernel32.dll\"**\n\n51 SMI, SMU, SMRAC, SMRACU are the operating modes of\n‘nateon.exe’. (Hauri ­ Response Team, 2011)\n52 The strings with suffix ‘.dll’ identify modules loaded\ndynamically by the malware.\n\n\n**10003D46** **10022294** **\"user32.dll\"**\n\n**10003D8A** **100222A0** **\"advapi32.dll\"**\n\n**10003DC9** **100222B0** **\"gdi32.dll\"**\n\n**10003E09** **100222BC** **\"ws2_32.dll\"**\n\n**10003E4C** **100222C8** **\"shell32.dll\"**\n\n**10003E90** **100222D8** **\"shlwapi.dll\"**\n\n**10003ED2** **100222E8** **\"psapi.dll\"**\n\n**10003F12** **100222F4** **\"mpr.dll\"**\n\n**10003F52** **10022300** **\"wtsapi32.dll\"**\n\n**10003F88** **10022310** **\"version.dll\"**\n\n**10003FC8** **10022320** **\"msvcrt.dll\"**\n\n**10004008** **1002232C** **\"wininet.dll\"**\n\n**10004048** **1002233C** **\"sfc.dll\"**\n\n**10004089** **10022348** **\"odbc32.dll\"**\n\n**100040C8** **10022354** **\"ole32.dll\"**\n\n**10004101** **10022360** **\"iphlpapi.dll\"**\n\n10004151 10022370 \"wsprintfA\"\n\n10004192 1002237C \"wsprintfW\"\n\n100047B7 10022388 \"lstrlenA\"\n\n10004806 10022394 \"lstrlenW\"\n\n10004855 100223A0 \"MultiByteToWideChar\"\n\n100048B2 100223B8 \"WideCharToMultiByte\"\n\n10004913 100223D0 \"memcpy\"\n\n10004969 100223D8 \"memset\"\n\n10004FC9 100223E0 \"InitializeCriticalSection\"\n\n10005035 100223FC \"DeleteCriticalSection\"\n\n100050C5 10022414 \"SetErrorMode\"\n\n10005109 10022424 \"SeDebugPrivilege\"\n\n10005137 10022448 \"SeTcpPrivilege\"\n\n100054DE 1002285C \"EnumServicesStatusW\"\n\n\nPAGE 16 OF 24\n\n\n-----\n\nCODE\nADDRESS\n\n\nOBFUSCATED\nADDRESS\n\n\nDEOBFUSCATED STRING\n\n\nCODE\nADDRESS\n\n\nOBFUSCATED\nADDRESS\n\n\nDEOBFUSCATED STRING\n\n\n100056C8 100228A4 \"QueryServiceConfig2W\"\n\n10005854 10022C34 \"CompanyName\"\n\n1000589F 10022C50 \"*\"\n\n100058DC 10022C58 \"FileDescription\"\n\n10005927 10022C00 \"*\"\n\n1000596E 10022C7C \"FileVersion\"\n\n100059B9 10022C98 \"*\"\n\n100059F5 10022CA0 \"ProductName\"\n\n10005A40 10022774 \"*\"\n\n10005A8C 10022CBC \"ProductVersion\"\n\n10005AD7 10022CDC \"*\"\n\n10006021 10022468 \"CloseHandle\"\n\n10006070 1002249C \"GetDiskFreeSpaceExW\"\n\n100060C8 100224B4 \"GetVolumeInformationW\"\n\n1000612A 100224CC \"CreateDirectoryW\"\n\n1000617B 100224E0 \"CreateFileW\"\n\n100061DB 100224F0 \"GetFileSize\"\n\n1000622D 10022500 \"GetFileTime\"\n\n10006285 10022510 \"WriteFile\"\n\n100062E0 1002251C \"ReadFile\"\n\n1000633B 10022528 \"SetEndOfFile\"\n\n1000638A 10022538 \"SetFileTime\"\n\n100063E2 10022548 \"SetFilePointer\"\n\n1000643A 10022558 \"FindFirstFileW\"\n\n1000648C 10022568 \"FindNextFileW\"\n\n100064DE 10022578 \"FindClose\"\n\n1000652D 10022584 \"FlushFileBuffers\"\n\n1000657C 10022598 \"lstrcpyW\"\n\n100065D0 100225A4 \"CreateProcessW\"\n\n10006631 100225C8 \"memcmp\"\n\n10006766 10022478 \"QueryDosDeviceW\"\n\n100067B9 100225D0 \"\\Device\\Floppy<\\x00><\\uA4BC\n><\\u5CD1>\"\n\n100067D3 100225D0 \"\\Device\\Floppy<\\x00><\\uA4BC\n><\\u5CD1>\"\n\n10006862 1002248C \"GetDriveTypeW\"\n\n10006941 100225F0 \"%s\"\n\n10006990 100225F8 \"%s\"\n\n10006AC7 10022600 \"*.*\"\n\n100076E4 100225B4 \"SHFileOperationW\"\n\n10007ACC 1002263C \"WNetCloseEnum\"\n\n10007CD5 10022618 \"WNetOpenEnumW\"\n\n10007DE6 10022628 \"WNetEnumResourceW\"\n\n10007F65 10022650 \"%s\"\n\n10007FB7 10022658 \"%s\"\n\n10007FFC 10022660 \"%s\"\n\n1000804F 10022668 \"%s\"\n\n100081E5 10022670 \"GetVersionExW\"\n\n1000825D 10022718 \"SetTcpEntry\"\n\n\n100084B0 10022774 \"*\"\n\n10008503 1002277C \"*\"\n\n10008544 10022764 \"System\"\n\n1000856D 10022754 \"System\"\n\n10008596 10022728 \"System Idle Process\"\n\n1000875B 100226F8 \"GetTcpTable\"\n\n1000884E 10022680 \"AllocateAndGetTcpExTableFrom\nStack\"\n\n100088F8 100226C8 \"GetExtendedTcpTable\"\n\n10008B17 100227D0 \"*\"\n\n10008B5F 100227D8 \"*\"\n\n10008B99 100227C0 \"System\"\n\n10008BC2 100227B0 \"System\"\n\n10008BEB 10022784 \"System Idle Process\"\n\n10008DC4 10022708 \"GetUdpTable\"\n\n10008E9C 100226A4 \"AllocateAndGetUdpExTableFrom\nStack\"\n\n10008F46 100226E0 \"GetExtendedUdpTable\"\n\n10008FDE 100227E0 \"WaitForMultipleObjects\"\n\n100093DD 100227F8 \"GetIconInfo\"\n\n1000942F 10022808 \"DestroyIcon\"\n\n1000947E 10022818 \"OpenProcess\"\n\n100094D2 10022828 \"OpenSCManagerW\"\n\n10009525 10022838 \"OpenServiceW\"\n\n1000957A 10022848 \"CloseServiceHandle\"\n\n100095C9 10022874 \"QueryServiceConfigW\"\n\n10009623 1002288C \"ChangeServiceConfigW\"\n\n10009683 100228BC \"DeleteService\"\n\n100096D2 100228CC \"StartServiceW\"\n\n10009725 100228DC \"ControlService\"\n\n10009779 100228EC \"CreateDCW\"\n\n100097CE 100228F8 \"GetDIBits\"\n\n1000982C 10022904 \"DeleteDC\"\n\n1000987B 10022910 \"DeleteObject\"\n\n100098CA 10022920 \"ExtractIconExW\"\n\n10009923 10022930 \"EnumProcesses\"\n\n10009978 10022940 \"EnumProcessModules\"\n\n100099D0 10022954 \"GetModuleFileNameExW\"\n\n10009A28 10022984 \"SfcIsFileProtected\"\n\n10009D14 10022A24 \"*\"\n\n10009D42 10022A2C \"*\"\n\n10009D7E 100229F8 \"NT AUTHORITY\"\n\n10009DAD 10022A14 \"SYSTEM\"\n\n10009DD6 100229CC \"NT AUTHORITY\"\n\n10009E05 100229E8 \"SYSTEM\"\n\n10009E39 100229A0 \"NT AUTHORITY\"\n\n10009E6B 100229BC \"SYSTEM\"\n\n10009ECA 10022A80 \"*\"\n\n10009F13 10022A70 \"System\"\n\n\nPAGE 17 OF 24\n\n\n-----\n\nCODE\nADDRESS\n\n\nOBFUSCATED\nADDRESS\n\n\nDEOBFUSCATED STRING\n\n\nCODE\nADDRESS\n\n\nOBFUSCATED\nADDRESS\n\n\nDEOBFUSCATED STRING\n\n\n10009F42 10022A60 \"System\"\n\n10009F6E 10022A34 \"System Idle Process\"\n\n10009F9A 10022A88 \"CompanyName\"\n\n10009FDB 10022AA4 \"*\"\n\n1000A020 10022AAC \"FileDescription\"\n\n1000A064 10022A24 \"*\"\n\n1000A0A9 10022AD0 \"FileVersion\"\n\n1000A0ED 10022AEC \"*\"\n\n1000A131 10022AF4 \"ProductName\"\n\n1000A175 10022998 \"*\"\n\n1000A1AF 10022B10 \"ProductVersion\"\n\n1000A1F3 10022B30 \"*\"\n\n1000A730 1002296C \"GetModuleInformation\"\n\n1000A7CC 10022B38 \"*\"\n\n1000A805 10022B40 \"\\??\\<\\x00><\\uFC04><\\uF06C>\"\n\n1000A859 10022B4C \"\\SystemRoot\\<\\x00><\\u7C84><\n\\u98E4>\"\n\n1000A8AE 10022B68 \"\\<\\x00><\\uFFFD>\"\n\n1000A919 10022B70 \"CompanyName\"\n\n1000A95B 10022B8C \"*\"\n\n1000A999 10022B94 \"FileDescription\"\n\n1000A9D8 10022BB8 \"*\"\n\n1000AA13 10022BC0 \"FileVersion\"\n\n1000AA52 10022BDC \"*\"\n\n1000AA8E 10022BE4 \"ProductName\"\n\n1000AAD0 10022C00 \"*\"\n\n1000AB0E 10022C08 \"ProductVersion\"\n\n1000AB50 10022C28 \"*\"\n\n1000B445 10022CE4 \"DISPLAY\"\n\n1000B6A3 10022CF8 \"SYSTEM\\CurrentControlSet\\Serv\nices\\<\\x00><\\u90A0>ÜÐ\"\n\n1000B6DB 10022D40 \"\\Parameters<\\x00><\\u3858>\"\n\n1000B70E 10022D5C \"ServiceDll\"\n\n1000B77F 10022D74 \"RegOpenKeyExW\"\n\n1000B7DD 10022D84 \"RegCreateKeyExW\"\n\n1000B83D 10022D98 \"RegQueryValueExW\"\n\n1000B899 10022DAC \"RegSetValueExW\"\n\n1000B8F8 10022DBC \"RegEnumKeyExW\"\n\n1000B953 10022DCC \"RegCloseKey\"\n\n1000B9A2 10022DDC \"SHCopyKeyW\"\n\n1000B9F9 10022E08 \"SHDeleteKeyW\"\n\n1000BA4B 10022E18 \"SHDeleteValueW\"\n\n1000BAA0 10022E28 \"SHGetValueW\"\n\n1000BE37 10022DE8 \"SHEnumKeyExW\"\n\n1000C492 10022DF8 \"SHEnumValueW\"\n\n1000CAFB 10022E38 \"VirtualAlloc\"\n\n1000CB53 10022E48 \"VirtualFree\"\n\n1000CBA9 10022E58 \"GetProcessWindowStation\"\n\n1000CBF3 10022E88 \"SetProcessWindowStation\"\n\n\n1000CC42 10022EA4 \"CloseWindowStation\"\n\n1000CC91 10022EB8 \"OpenInputDesktop\"\n\n1000CCE4 10022ECC \"SetThreadDesktop\"\n\n1000CD33 10022EE0 \"GetThreadDesktop\"\n\n1000CD82 10022EF4 \"CloseDesktop\"\n\n1000CDD1 10022F04 \"SetCursorPos\"\n\n1000CE23 10022F44 \"GetCurrentThreadId\"\n\n1000CE6D 10022F58 \"CreateThread\"\n\n1000CEC8 10022F68 \"CreateCompatibleDC\"\n\n1000CF17 10022F7C \"CreateDIBSection\"\n\n1000CF72 10022F90 \"SetDIBColorTable\"\n\n1000CFC9 10022FA4 \"GdiFlush\"\n\n1000D013 10022FB0 \"GetDeviceCaps\"\n\n1000D067 10022FC0 \"BitBlt\"\n\n1000D0C9 10022FC8 \"SelectObject\"\n\n1000D136 10022FD8 \"DISPLAY\"\n\n1000DB81 10022FEC \"DISPLAY\"\n\n1000DE8A 10023000 \"DISPLAY\"\n\n1000E3BE 10023014 \"DISPLAY\"\n\n1000E9AB 10022F34 \"PostMessageA\"\n\n1000EA13 10022F24 \"keybd_event\"\n\n1000EA8B 10022F14 \"mouse_event\"\n\n1000EB1C 10023028 \"WinSta0\"\n\n1000EB3F 10022E74 \"OpenWindowStationW\"\n\n1000EC3C 1002303C \"GetTickCount\"\n\n1000EC86 1002304C \"ConnectNamedPipe\"\n\n1000ECD8 10023060 \"CreateNamedPipeW\"\n\n1000ED3F 10023074 \"GetOverlappedResult\"\n\n1000ED96 1002308C \"CreateEventW\"\n\n1000F0CF 1002309C \"\\\\.\\pipe\\a%d<\\x00><\\u3CC4><\n\\u3C18><\\u9C08><\\u3C8A>\"\n\n1000F2B1 100230B8 \"\\\\.\\pipe\\b%d<\\x00><\\u7080><\n\\u0C17><\\u4C49><\\uEC10>\"\n\n1000F38F 100230D4 \"CMD.EXE\"\n\n**1000FC7B** **100230E8** **\"SQLAllocHandle\"[53]**\n\n**1000FCD0** **100230F8** **\"SQLSetEnvAttr\"**\n\n**1000FD2A** **10023108** **\"SQLDriverConnectW\"**\n\n**1000FD88** **1002311C** **\"SQLDisconnect\"**\n\n**1000FDD7** **1002312C** **\"SQLFreeHandle\"**\n\n**1000FE29** **1002313C** **\"SQLExecDirectW\"**\n\n**1000FE7D** **1002315C** **\"SQLNumResultCols\"**\n\n**1000FECF** **1002319C** **\"SQLMoreResults\"**\n\n**10010339** **10023170** **\"SQLColAttributeW\"**\n\n**100104B5** **10023184** **\"SQLFetch\"**\n\n**1001052B** **10023190** **\"SQLGetData\"**\n\n1001057D 100231AC \"NULL\"\n\n**10010627** **1002314C** **\"SQLGetDiagRecW\"**\n\n53 The imported functions with an ‘SQL’ prefix were presumably\nused to access the SK Communications databases.\n\n\nPAGE 18 OF 24\n\n\n-----\n\nCODE\nADDRESS\n\n\nOBFUSCATED\nADDRESS\n\n\nDEOBFUSCATED STRING\n\n\nCODE\nADDRESS\n\n\nOBFUSCATED\nADDRESS\n\n\nDEOBFUSCATED STRING\n\n\n10010739 100231DC \"ExitWindowsEx\"\n\n1001078A 100231EC \"InitiateSystemShutdownA\"\n\n10010808 100231C8 \"LockWorkStation\"\n\n100108CC 10023208 \"SeShutdownPrivilege\"\n\n100109C8 10023234 \"SeShutdownPrivilege\"\n\n10010ACC 10023260 \"SeShutdownPrivilege\"\n\n10010D37 100231B8 \"MessageBoxW\"\n\n10010D95 100232F0 \"GetConsoleMode\"\n\n10010DE7 10023318 \"SetConsoleCtrlHandler\"\n\n10010E3B 1002337C \"SetConsoleScreenBufferSize\"\n\n10010EC2 10023330 \"WriteConsoleInputW\"\n\n10010F47 100232CC \"GetConsoleCP\"\n\n10010FC1 100232DC \"GetConsoleOutputCP\"\n\n10011044 10023300 \"GetConsoleDisplayMode\"\n\n10011096 100233AC \"GetConsoleCursorInfo\"\n\n1001110F 10023360 \"GetConsoleScreenBufferInfo\"\n\n1001134D 10023398 \"ReadConsoleOutputW\"\n\n10011617 100233D4 \"CMD\"\n\n10011643 100233E0 \" \"\n\n1001166F 100233E8 \"/Q\"\n\n100116A3 100232A8 \"AllocConsole\"\n\n100116F3 100232B8 \"GetConsoleWindow\"\n\n10011738 1002328C \"ShowWindow\"\n\n100117A2 10023298 \"GetStdHandle\"\n\n10011AE2 100233C4 \"FreeConsole\"\n\n10011CAA 100233F0 \"CONIN$\"\n\n10011D3A 10023344 \"GenerateConsoleCtrlEvent\"\n\n10011E6D 10023400 \"CONIN$\"\n\n10011EAD 10023410 \"CONOUT$\"\n\n10011F88 10023424 \"CreateWindowExW\"\n\n10011FE7 10023438 \"SetWindowLongW\"\n\n1001203D 10023448 \"DestroyWindow\"\n\n1001208C 10023458 \"TranslateMessage\"\n\n100120DB 1002347C \"SetTimer\"\n\n10012136 10023488 \"KillTimer\"\n\n10012188 100234A4 \"DispatchMessageW\"\n\n100121D7 100234F8 \"WTSUnRegisterSessionNotificati\non\"\n\n100122CB 10023494 \"PeekMessageW\"\n\n10012379 1002351C \"static\"\n\n1001255F 100234D8 \"WTSRegisterSessionNotification\"\n\n10012687 100234B8 \"MsgWaitForMultipleObjectsEx\"\n\n10012779 1002346C \"DefWindowProcW\"\n\n10012C0D 1002356C \"QueryPerformanceCounter\"\n\n10012C5C 1002359C \"GetFileAttributesW\"\n\n10012CAB 100235B0 \"ExpandEnvironmentStringsW\"\n\n10012D00 100235CC \"GetModuleFileNameW\"\n\n10012D55 100235E0 \"OpenProcessToken\"\n\n10012DAA 100235F4 \"GetLengthSid\"\n\n\n10012DF9 10023604 \"GetTokenInformation\"\n\n10012E54 10023630 \"LookupPrivilegeValueW\"\n\n10012EA8 10023648 \"AdjustTokenPrivileges\"\n\n10012F02 100236B4 \"GetFileVersionInfoW\"\n\n10012F59 100236CC \"VerQueryValueW\"\n\n100130F1 1002353C \"GetWindowsDirectoryW\"\n\n10013158 10023554 \"GetSystemDirectoryW\"\n\n100132AD 10023588 \"GetComputerNameW\"\n\n1001337D 10023660 \"GetUserNameW\"\n\n10013445 10023748 \"CLSID\"\n\n**10013465** **10023758** **\"SOFTWARE\\CLASSES\\SAFEGUI**\n**<\\x00><\\u40F0><\\u380B>\"[54]**\n\n100134D4 1002378C \"CLSID\"\n\n**100134EA** **10023758** **\"SOFTWARE\\CLASSES\\SAFEGUI**\n**<\\x00><\\u40F0><\\u380B>\"**\n\n1001357C 1002352C \"GetSystemTime\"\n\n100136DC 100237A0 \"%2.2X%2.2X%2.2X%2.2X%2.2X\n%2.2X%2.2X%2.2X\"\n\n10013749 100237F4 \"%ALLUSERSPROFILE%\"\n\n100137C6 10023820 \"\\Documents and Settings\\All\nUsers<\\x00><\\uC030><\\u0848>\n\"\n\n10013807 10023868 \"\\Documents and Settings\\All\nUsers<\\x00><\\u78D8><\\u6090>\n\"\n\n1001384C 100238B0 \"\\Documents and Settings\\All\nUsers<\\x00><\\u3818><\\u20D0>\n\"\n\n1001389A 100238F8 \"\\ProgramData<\\x00><\\uE8A8>\"\n\n100138D8 10023914 \"\\ProgramData<\\x00><\\uFFFD>\"\n\n10013907 10023930 \"\\<\\x00><\\uB898>\"\n\n10013B54 10023938 \"\\*.*<\\x00><\\u140C>\"\n\n10013E1F 10023944 \".EXE\"\n\n10013EFB 10023950 \".EXE\"\n\n1001404B 1002395C \"\\??\\<\\x00><\\u742C><\\uCC38>\"\n\n1001409E 10023968 \"\\SystemRoot\\<\\x00><\\u0808><\n\\u5834>\"\n\n100140F1 10023984 \"\\<\\x00><\\u18B8>\"\n\n10014219 1002361C \"LookupAccountSidW\"\n\n100143AE 10023670 \"WTSEnumerateProcessesW\"\n\n10014461 10023688 \"WTSFreeMemory\"\n\n100144FB 10023698 \"GetFileVersionInfoSizeW\"\n\n1001459E 1002398C \"\\VarFileInfo\\Translation<\\x00>\n<\\uEC54><\\u2C48>\"\n\n10014605 100239C0 \"\\StringFileInfo\\%4.4X%4.4X\\%s\n<\\x00><\\uF8D8><\\uE090><\\u2\n379>\"\n\n10014992 10023A00 \"IsWow64Process\"\n\n54 The unusual hardcoded registry key\n‘SOFTWARE\\CLASSES\\SAFEGUI’ can be used to link ‘nateon.exe’\nwith the malware that has the MD5 hash 6C6A DBD0 8727 6AE8\n9F82 6258 2798 B708 and calls back to the domain\n‘expre.dyndns.tv’ on TCP port 443. It may also be used as a\nsignature to identify other similar malware. (GFI SandBox, 2011)\n\n\nPAGE 19 OF 24\n\n\n-----\n\nCODE\nADDRESS\n\n\nOBFUSCATED\nADDRESS\n\n\nDEOBFUSCATED STRING\n\n\nCODE\nADDRESS\n\n\nOBFUSCATED\nADDRESS\n\n\nDEOBFUSCATED STRING\n\n\n100149F5 10023A10 \"GetCurrentProcessId\"\n\n10014A3F 10023A28 \"ProcessIdToSessionId\"\n\n10014A91 10023A40 \"DuplicateTokenEx\"\n\n10014AEE 10023A54 \"SetTokenInformation\"\n\n10014B46 10023A98 \"CreateProcessAsUserW\"\n\n100151CE 10023AB0 \".DLL\"\n\n10015202 10023ABC \"RUNDLL32.EXE \"\n\n1001522E 10023ADC \"\"<\\x00><\\u6010>\"\n\n10015268 10023AE4 \"\\<\\x00><\\u3080>\"\n\n100152A0 10023AEC \"\" <\\x00><\\u6868>\"\n\n100152CC 10023AF4 \"RqSkce\"\n\n100152F8 10023B04 \" \"\n\n10015324 10022220 \"SMRAC\"\n\n**100153FC** **10023B0C** **\"UserEnv.dll\"**\n\n1001542A 10023B1C \"CreateEnvironmentBlock\"\n\n10015456 10023B34 \"DestroyEnvironmentBlock\"\n\n100155C1 10023B50 \".DLL\"\n\n1001561B 10023B5C \"RUNDLL32.EXE \"\n\n10015656 10023B7C \"\"<\\x00><\\u843C>\"\n\n1001569E 10023B84 \"\\<\\x00><\\u68A8>\"\n\n100156EF 10023B8C \"\" <\\x00><\\uCCF4>\"\n\n10015722 10023AF4 \"RqSkce\"\n\n1001575D 10023B04 \" \"\n\n10015790 10022230 \"SMRACU\"\n\n100157E1 10023A6C \"ImpersonateLoggedOnUser\"\n\n1001586B 10023A88 \"RevertToSelf\"\n\n10015943 10023B94 \"WTSGetActiveConsoleSessionId\"\n\n10015C5E 10023BB4 \"NT AUTHORITY\"\n\n10015D15 10023BF0 \"MoveFileExW\"\n\n10015D68 10023C00 \"GetModuleHandleA\"\n\n**100160D5** **10023C28** **\"%SystemRoot%\\system32\\sv**\n**chost.exe ­k**\n**LocalService<\\x00><\\uBC64><**\n**\\uD4CC>\"[55]**\n\n10016108 10023C90 \"SYSTEM\\CurrentControlSet\\Serv\nices<\\x00><\\u54AC><\\u8C34>\"\n\n10016138 10023CD8 \"\\<\\x00><\\uC4FC>\"\n\n10016183 10023CE0 \"\\Parameters<\\x00><\\uA8A8>\"\n\n100161C2 10023CFC \"LocalService\"\n\n10016267 10023D18 \"ServiceDll\"\n\n100162B6 10023AF4 \"RqSkce\"\n\n100162C8 10023AF4 \"RqSkce\"\n\n100162E3 10023D30 \"ServiceMain\"\n\n10016389 10023D4C \"LocalService\"\n\n100163EF 10023D68 \".DLL\"\n\n1001642B 10023D74 \"\\<\\x00><\\u344C>\"\n\n1001649E 10023D7C \"RUNDLL32.EXE \"\n\n100164D0 10023D9C \"\"<\\x00><\\u8070>\"\n\n55 The ‘nateon.exe’ dropper configures ‘winsvcfs.dll’ to run inside\nthe trusted operating system process ‘svchost.exe’.\n\n\n10016519 10023DA4 \"\" <\\x00><\\u74AC>\"\n\n1001654C 10023AF4 \"RqSkce\"\n\n10016582 10023DAC \" \"\n\n100165BE 10022208 \"SMI\"\n\n100165FD 10023DB4 \" \"\n\n1001663B 10023DBC \"\"<\\x00><\\u14EC>\"\n\n10016691 10023DC4 \"\"<\\x00><\\u28E8>\"\n\n1001689E 10023BE0 \"DeleteFileW\"\n\n100169F3 10023C14 \"GetModuleFileNameA\"\n\n10016A4A 10023BD0 \"CreateFileA\"\n\n10016DAA 10023DEC \"QueryServiceStatusEx\"\n\n10016E03 10023E04 \"ChangeServiceConfig2W\"\n\n10016E59 10023E1C \"CreateServiceW\"\n\n1001779C 10023E30 \"SOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion\\SvcHost<\\x0\n0><\\uA8E8><\\uC40C><\\uFFFD>\n<\\u9050>\"\n\n1001791E 10023E9C \"\"\n\n10017956 10023E30 \"SOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion\\SvcHost<\\x0\n0><\\uA8E8><\\uC40C><\\uFFFD>\n<\\u9050>\"\n\n10017A37 10023E30 \"SOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion\\SvcHost<\\x0\n0><\\uA8E8><\\uC40C><\\uFFFD>\n<\\u9050>\"\n\n10017BE1 10023EA0 \"\"\n\n10017C10 10023E30 \"SOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion\\SvcHost<\\x0\n0><\\uA8E8><\\uC40C><\\uFFFD>\n<\\u9050>\"\n\n10017C5F 10023EA4 \"VirtualAllocEx\"\n\n10017CBC 10023EB4 \"VirtualFreeEx\"\n\n10017D15 10023EC4 \"WriteProcessMemory\"\n\n10017D74 10023EEC \"GetWindowThreadProcessId\"\n\n10017DC6 10023F18 \"GetExitCodeThread\"\n\n10017E18 10023F48 \"EqualSid\"\n\n10017E6A 10023F54 \"FreeSid\"\n\n10017EB9 10023F60 \"ShellExecuteExW\"\n\n10017F08 10023F74 \"SHCreateItemFromParsingName\n\"\n\n10017F61 10023FA4 \"CoCreateInstance\"\n\n10018226 10023F2C \"AllocateAndInitializeSid\"\n\n100184E2 10023FC8 \".DLL\"\n\n10018534 10023FD4 \"\"<\\x00><\\u7CA4>\"\n\n1001856E 10023FDC \"\\<\\x00><\\u9C04>\"\n\n100185A6 10023FE4 \"\" <\\x00><\\u1020>\"\n\n100185D2 10023AF4 \"RqSkce\"\n\n100185FE 10023FEC \" \"\n\n1001862A 10022208 \"SMI\"\n\n**100186F4** **1002401C** **\"\\SYSPREP<\\x00><\\uF8D8>\"**\n\n**10018720** **10024030** **\"\\SYSPREP.EXE<\\x00><\\u18B8**\n**>\"**\n\n\nPAGE 20 OF 24\n\n\n-----\n\nCODE\nADDRESS\n\n\nOBFUSCATED\nADDRESS\n\n\nDEOBFUSCATED STRING\n\n\nCODE\nADDRESS\n\n\nOBFUSCATED\nADDRESS\n\n\nDEOBFUSCATED STRING\n\n00><\\u70C0><\\u28FB><\\u38E4\n><\\u680B>\"\n\n\n1001881A 10024058 \"LoadLibraryW\"\n\n**10018836** **10024068** **\"kernel32.dll\"**\n\n10018879 10024078 \"FreeLibrary\"\n\n**10018890** **10024068** **\"kernel32.dll\"**\n\n10018B30 10022B68 \"\\<\\x00><\\uFFFD>\"\n\n10018B71 10024088 \"sysprep\"\n\n10018BE4 10023F94 \"CoInitializeEx\"\n\n**10018C88** **1002409C** **\"CRYPTBASE.DLL\"**\n\n10018D00 100240BC \"\\<\\x00><\\u5C44>\"\n\n10018D3A 100240C4 \"sysprep\"\n\n10018D7D 100240D8 \"\\<\\x00><\\u0888>\"\n\n**10018DBB** **100240E0** **\"CRYPTBASE.DLL\"**\n\n10018E1B 10024100 \"\\<\\x00><\\u1020>\"\n\n10018E46 100240C4 \"sysprep\"\n\n10018E75 10024108 \"\\<\\x00><\\u8070>\"\n\n10018EA7 10024110 \"sysprep.exe\"\n\n10018FB8 10023FB8 \"CoUninitialize\"\n\n**1001903E** **1002412C** **\"CRYPTBASE.DLL\"**\n\n100190B1 1002414C \".DLL\"\n\n10019112 10024158 \"RUNDLL32.EXE \"\n\n1001914B 10024178 \"\"<\\x00><\\uF858>\"\n\n10019197 10024180 \"\\<\\x00><\\u6010>\"\n\n100191E0 10024188 \"\" <\\x00><\\uF42C>\"\n\n10019219 10023AF4 \"RqSkce\"\n\n10019252 10024190 \" \"\n\n1001928B 10022208 \"SMI\"\n\n1001949A 10023ED8 \"CreateRemoteThread\"\n\n10019534 10024198 \"Shell_TrayWnd\"\n\n10019558 10023F08 \"FindWindowA\"\n\n100195E4 100241C8 \"GetCurrentThread\"\n\n1001962E 100241DC \"SetThreadPriority\"\n\n100197F3 10024204 \"GetSystemMetrics\"\n\n10019842 10024230 \"gethostbyname\"\n\n10019891 10024240 \"lstrcatW\"\n\n100198E3 1002424C \"ResumeThread\"\n\n10019939 1002425C \"QueueUserAPC\"\n\n1001A25C 100242C8 \"\\\\.\\PIPE\\RUN_AS_CONSOLE_USE\nR(%d)<\\x00><\\u0CB4><\\u40E5\n><\\u4033><\\uC0C0>\"\n\n**1001A419** **1002426C** **\"download.windowsupdate.co**\n**m\"[56]**\n\n1001A66A 10024288 \"\\\\.\\PIPE\\RUN_AS_CONSOLE(%d\n)<\\x00><\\u7000><\\u78D8><\\u6\n090><\\u2828>\"\n\n1001A914 100241F0 \"GlobalMemoryStatus\"\n\n1001AA61 100236DC \"~MHZ\"\n\n1001AA7F 100236E8 \"HARDWARE\\DESCRIPTION\\SYS\nTEM\\CENTRALPROCESSOR\\0<\\x\n\n56 The hardcoded domain name ‘download.windowsupdate.com’\nis used to detect internet connectivity. This domain name can be\noverridden in the malware’s configuration.\n\n\n1001AB05 10024218 \"GetSystemDefaultLCID\"\n\n1001AB81 1002430C \"%s\"\n\n1001ABC1 10022658 \"%s\"\n\n1001AC02 10024314 \"\"\n\n1001AC23 10024318 \"%s\"\n\n1001AC6B 10024320 \"%s\"\n\n1001ACA4 10022658 \"%s\"\n\n1001ACE1 10024328 \"\"\n\n1001ACFC 1002432C \"%s\"\n\n1001B0D7 10024334 \".DLL\"\n\n1001B11A 10024340 \"RUNDLL32.EXE \"\n\n1001B15A 10024360 \"\"<\\x00><\\u5878>\"\n\n1001B1B4 10023FDC \"\\<\\x00><\\u9C04>\"\n\n1001B1F4 10024368 \"\" <\\x00><\\u9CE4>\"\n\n1001B22C 10023AF4 \"RqSkce\"\n\n1001B266 10024370 \" \"\n\n1001B29B 10022214 \"SMU\"\n\n1001B54A 10024378 \"RtlNtStatusToDosError\"\n\n1001B599 100243B0 \"RtlDecompressBuffer\"\n\n1001B5F8 100243C8 \"RtlCompressBuffer\"\n\n1001B677 10024390 \"RtlGetCompressionWorkSpaceSi\nze\"\n\n1001BD1B 10024288 \"\\\\.\\PIPE\\RUN_AS_CONSOLE(%d\n)<\\x00><\\u7000><\\u78D8><\\u6\n090><\\u2828>\"\n\n1001BEDB 100243DC \"TerminateThread\"\n\n1001BF2F 10024418 \"SetUnhandledExceptionFilter\"\n\n1001BF7E 100243F0 \"TlsAlloc\"\n\n1001C028 1002440C \"TlsFree\"\n\n1001C0CB 100243FC \"TlsGetValue\"\n\n1001C139 10024438 \"ECount=%d,\"\n\n1001C180 10024450 \"EAddr=0x%p,\"\n\n1001C1CC 1002446C \"ECode=0x%x,\"\n\n1001C214 10024488 \"ESalF=%d\"\n\n1001C2D4 1002449C \"MessageBoxA\"\n\n1001C32C 100244AC \"lstrcpyA\"\n\n1001C380 100244B8 \"InternetOpenA\"\n\n1001C3D4 100244C8 \"InternetOpenUrlA\"\n\n1001C431 100244DC \"InternetReadFile\"\n\n1001C489 100244F0 \"InternetCloseHandle\"\n\n**1001C510** **10024508** **\"XXXXXXXX\"[57]**\n\n**1001C5E3** **10024514** **\"DEMO\"**\n\n**1001C618** **10024520** **\"TVT\"**\n\n**1001C658** **10024528** **\"TVT DEMO\"**\n\n**1001C6DA** **10024534** **\"192.168.0.200\"**\n\n57 This set of hardcoded strings, ‘XXXXXXXX’, ‘DEMO’, ‘TVT’, ‘TVT\nDEMO’, and ‘192.168.0.200’ are hardcoded values overridden by\nthe malware’s configuration.\n\n\nPAGE 21 OF 24\n\n\n-----\n\nCODE\nADDRESS\n\n\nOBFUSCATED\nADDRESS\n\n\nDEOBFUSCATED STRING\n\n\nCODE\nADDRESS\n\n\nOBFUSCATED\nADDRESS\n\n\nDEOBFUSCATED STRING\n\n\n**1001C717** **10024534** **\"192.168.0.200\"**\n\n1001C74F 10024548 \"\"\n\n**1001C7BF** **1002454C** **\"CONFIG­DESTORY!\"[58]**\n\n1001CC41 10024560 \"%2.2X\"\n\n**1001CCB2** **10024570** **\"Software\\SafeSvc<\\x00><\\uB**\n**4EC>\"[59]**\n\n1001CD54 10024594 \"%2.2X\"\n\n1001CD98 100245A4 \"Software\\SafeSvc<\\x00><\\u40F\n0>\"\n\n1001CDE7 100245C8 \"socket\"\n\n1001CE41 100245D0 \"bind\"\n\n1001CE94 100245E0 \"setsockopt\"\n\n1001CEEE 100245EC \"shutdown\"\n\n1001CF3F 100245F8 \"closesocket\"\n\n1001CF95 10024608 \"ioctlsocket\"\n\n1001CFEC 10024620 \"htons\"\n\n1001D03B 10024634 \"WSAGetLastError\"\n\n1001D085 10024648 \"lstrcpynA\"\n\n1001D45C 100245D8 \"recv\"\n\n1001D5C1 10024654 \"\"\n\n**1001D67C** **10024658** **\"Proxy­Authorization: Basic \"**\n\n**1001D6B5** **10024678** **\"GET \"**\n\n**1001D6E8** **10024680** **\"POST \"**\n\n**1001D71B** **10024688** **\"CONNECT \"**\n\n**1001D775** **10024658** **\"Proxy­Authorization: Basic \"**\n\n1001D886 10024694 \"\"\n\n1001DA8F 10024618 \"ntohs\"\n\n1001DB03 10024628 \"inet_ntoa\"\n\n1001E16D 100246C8 \"ResetEvent\"\n\n1001E1BE 100246D4 \"InternetConnectA\"\n\n1001E21A 100246E8 \"InternetWriteFile\"\n\n1001E272 10024710 \"HttpSendRequestExA\"\n\n1001E2CA 10024724 \"HttpEndRequestA\"\n\n1001E31F 10024748 \"InternetSetOptionA\"\n\n1001E376 1002475C \"HttpAddRequestHeadersA\"\n\n1001E3CF 10024698 \"EnterCriticalSection\"\n\n1001E420 100246B0 \"LeaveCriticalSection\"\n\n**1001EE91** **10024774** **\"Mozilla/4.0 (compatible; MSIE**\n**6.0; Windows NT 5.1;SV1;\"[60]**\n\n**1001EF9B** **100247B0** **\"/update?product=windows\"[61]**\n\n**1001EFB6** **100247CC** **\"POST\"**\n\n58 The string ‘CONFIG­DESTORY!’ is displayed in a message box\nwhen ‘nateon.exe’ detects corruption in its configuration. It can be\nused as a signature to identify similar malware.\n59 The unusual hardcoded registry key ‘Software\\SafeSvc’ can be\nused as a signature to identify similar malware.\n60 This is the user­agent included in HTTP requests made by the\nmalware to its configured command and control infrastructure.\nThis malformed user­agent string can be used as a signature to\ndetect malicious network traffic.\n61 This is the path included in HTTP requests made by ‘nateon.exe’\nto its configured command and control infrastructure. This string\ncan be used as a signature to detect malicious network activity.\n\n\n1001EFDD 100246FC \"HttpOpenRequestA\"\n\n1001F113 10024560 \"%2.2X\"\n\n1001F189 10024570 \"Software\\SafeSvc<\\x00><\\uB4E\nC>\"\n\n1001F278 100247D4 \":\"\n\n**1001F308** **100247D8** **\"Proxy­Authorization: Basic**\n**%s<\\r><\\n><\\x00>öL\"**\n\n**1001F39B** **100247FC** **\"X­Session\"[62]**\n\n1001F3BC 10024808 \"%s: %d\"\n\n**1001F41E** **10024810** **\"X­Status\"**\n\n1001F43F 1002481C \"%s: %d\"\n\n**1001F49B** **10024824** **\"X­Size\"**\n\n1001F4B9 1002482C \"%s: %d\"\n\n**1001F507** **10024834** **\"X­Sn\"**\n\n1001F525 1002483C \"%s: %d\"\n\n1001F776 10024844 \"\"\n\n1001F7BB 10024848 \"\"\n\n**1001F7FC** **100247FC** **\"X­Session\"**\n\n**1001F845** **10024810** **\"X­Status\"**\n\n**1001F889** **10024824** **\"X­Size\"**\n\n**1001F8CD** **10024834** **\"X­Sn\"**\n\n1001FC5C 1002484C \"%s\"\n\n1001FC90 10024738 \"HttpQueryInfoA\"\n\n10020324 10024850 \"connect\"\n\n10020378 1002486C \"getpeername\"\n\n100203CF 10024894 \"WSAIoctl\"\n\n10020430 100248A0 \"WSAGetOverlappedResult\"\n\n10020662 100248B8 \"WSAStartup\"\n\n100206C5 100248C4 \"WSACleanup\"\n\n**10020A04** **100248D0** **\"CONNECT %s:%d**\n**HTTP/1.1<\\r><\\n><\\x00>d$\"**\n\n**10020A46** **100248EC** **\"Content­length:**\n**0<\\r><\\n><\\x00>tl\"**\n\n**10020A7A** **10024904** **\"Content­Type:**\n**text/html<\\r><\\n><\\x00>|d\"**\n\n**10020AAE** **10024920** **\"Proxy­Connection: Keep­**\n**Alive<\\r><\\n><\\x00><\\u2584**\n**><\\u20A7>\"**\n\n10020B10 10024940 \":\"\n\n**10020B63** **10024944** **\"Proxy­Authorization: Basic**\n**%s<\\r><\\n><\\x00><\\u255D>\"**\n\n**10020C3E** **10024968** **\"HTTP/1.0 200 \"**\n\n**10020C79** **10024978** **\"HTTP/1.1 200 \"**\n\n1002124B 1002485C \"getsockname\"\n\n100212C1 1002487C \"WSASend\"\n\n1002134E 10024888 \"WSARecv\"\n\n10021438 10024998 \"static\"\n\n100214B6 10024988 \"GetMessageW\"\n\n62 The HTTP headers ‘X­Session’, ‘X­Status’, ‘X­Size’, and ‘X­Sn’ can\nbe used to develop stronger signatures for detection of network\nactivity generated by the malware.\n\n\nPAGE 22 OF 24\n\n\n-----\n\n**ANNEX B**\n\n**SUMMARY OF MALWARE KNOWN TO CREATE THE UNIQUELY NAMED DIRECTORY: ‘03A075FB70D5D675F9DC26FC’**\n\nMD5 HASH FILE SIZE (BYTES) DATE(S) ANALYSED FILES CREATED NETWORK CONNECTIVITY\n\n\n16A3 1AA8 E7DD F66A\n3155 1840 573B 6575\n\nABA9 BAEA 7082 5E6A\nDF07 2358 7F27 3DC4\n\nBCE1 069D D099 F151\n70C5 FD05 BAE9 21B5\n\nE8EE 9373 EE6C 8360\n42E8 F48D 8DE2 DDA9\n\nFDF2 C5C2 B187 4EFE\n7FD3 3509 2DF2 D3BC\n\n\n155648 13 July 2011\n(ThreatExpert, 2011)\n\n3514598 29 July 2011\n(ThreatExpert, 2011)\n\n133632 29 May 2011\n(GFI SandBox, 2011)\n03 August 2011\n(ThreatExpert, 2011)\n\nunknown 08 February 2011\n(GFI Software, 2011)\n\nunknown 15 July 2011\n(GFI SandBox, 2011)\n\nPAGE 23 OF 24\n\n\n$$$$$$$$mtx.bat\nwinscard2.exe\n\nzhenxiang.exe\nwinscard.exe\n\n106140_d.bat\ntcmoniter.exe\n\n$$$$$$$$fbl.bat\ntcomoniter.exe\n\n40984_d.bat\nwincard0.dll\nuxtheme.dll\n\n\nTCP port 1058 opened for inbound\nconnections\n\nTCP ports 1052 and 1053 opened for\ninbound connections\n\npc.nprotects.org on TCP port 80\n\npc.nprotects.org on TCP port 80\n\nbbs.ezxsoft.com on TCP port 80\n\n\n-----\n\n**COPYRIGHT NOTICE**\n\nCopyright © Command Five Pty Ltd. All rights reserved.\n\nThis document is provided by the copyright holders under the licence\nthat follows. By obtaining, using, and/or distributing this document you\nagree that you have read, understood, and agree to the terms and\nconditions that follow.\n\nThe names and trademarks of Command Five Pty Ltd may not be\nused in advertising or publicity relating to this document or its contents\nwithout specific, prior, written permission.\n\nNo permission is given for this document to be used for commercial\npurposes or as part of any commercial activity or undertaking,\nincluding, but not limited to, use in or relating to advertising or\npublicity, and/or use in support of, or as part of, any pre­sales or sales\nactivities.\n\nNo permission is given to create modified or derivative works. You\nmay distribute this document in its original form for non­commercial\npurposes in accordance with the other terms and conditions stated\nherein. Copyright title will at all times remain with the copyright\nholders.\n\nAll referenced trademarks remain the property of their respective\nowners.\n\nTHIS DOCUMENT IS PROVIDED ‘AS IS’ FOR INFORMATIONAL\nPURPOSES ONLY WITH NO REPRESENTATIONS OR WARRANTIES OF\nANY KIND, INCLUDING BUT NOT LIMITED TO ANY WARRANTY,\nEXPRESS OR IMPLIED, OF MERCHANTABILITY OR FITNESS FOR A\nPARTICULAR PURPOSE; WARRANTY OF NON­INFRINGEMENT, OR\nTITLE; NOR ANY WARRANTIES PERTAINING TO THE ACCURACY OR\nCOMPLETENESS OF CONTENT.\n\nANY OPINIONS EXPRESSED IN THIS DOCUMENT MAY CHANGE\nWITHOUT NOTICE AND ARE NOT NECESSARILY THE CONSIDERED\nOPINIONS OF COMMAND FIVE PTY LTD, ITS PARTNERS, EMPLOYEES,\nOR AFFILIATE ORGANISATIONS. ANY ADVICE OFFERED IN THIS\nDOCUMENT IS OFFERED WITHOUT WARRANTY OF ANY KIND.\n\nCommand Five Pty Ltd\nABN: 49 149 576 670\n\nhttp://www.commandfive.com\ninfo@commandfive.com\n\nPAGE 24 OF 24\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/c911g2eqxck6va9cdn9vync5628zrreb",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2011/2011.09.11.SK_Hack/C5_APT_SKHack.pdf"
    ],
    "report_names": [
        "C5_APT_SKHack"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716501,
    "ts_updated_at": 1743041499,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/2b98220caf158d1c4f6d72abbc379899e35edc4d.pdf",
        "text": "https://archive.orkl.eu/2b98220caf158d1c4f6d72abbc379899e35edc4d.txt",
        "img": "https://archive.orkl.eu/2b98220caf158d1c4f6d72abbc379899e35edc4d.jpg"
    }
}