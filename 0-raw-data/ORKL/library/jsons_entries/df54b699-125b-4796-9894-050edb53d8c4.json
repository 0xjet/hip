{
    "id": "df54b699-125b-4796-9894-050edb53d8c4",
    "created_at": "2023-01-12T15:04:19.867709Z",
    "updated_at": "2025-03-27T02:08:40.270228Z",
    "deleted_at": null,
    "sha1_hash": "95190baadaaa789f724a01601748fb2c02518b10",
    "title": "2019-10-26 - Earn-quick-BTC-with-Hiddentear.mp4 - About Open Source Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T01:27:59Z",
    "file_modification_date": "2022-05-28T01:27:59Z",
    "file_size": 2228300,
    "plain_text": "# Earn-quick-BTC-with-Hiddentear.mp4 / About Open Source Ransomware\n\n**[dissectingmalwa.re/earn-quick-btc-with-hiddentearmp4-about-open-source-ransomware.html](https://dissectingmalwa.re/earn-quick-btc-with-hiddentearmp4-about-open-source-ransomware.html)**\n\nSat 26 October 2019 in [Ransomware](https://dissectingmalwa.re/category/ransomware.html)\n\nNo, this will not be a skiddy Tutorial on how to earn quick crypto but rather an analysis of the\nOpen Source Ransomware \"Hiddentear\".\n\n**_A general disclaimer as always: downloading and running the samples linked below_**\n**_will lead to the encryption of your personal data, so be f$cking careful. Also check_**\n**_with your local laws as owning malware binaries/ sources might be illegal depending_**\n**_on where you live._**\n\n[\"Shade Ransomware creater is stupid fxxxxx.exe\" @ Any.Run -->](https://app.any.run/tasks/cea41d5c-84c5-43a7-93a3-b3881221d80d/) `sha256`\n```\nba978eee90be06b1ce303bbee33c680c2779fbbc5b90c83f0674d6989564a70a\n\n```\nBecause HiddenCrypt is Written in C# utilizing the .NET Framework 4 static analysis of the\n[Binary will happen in Progress Telerik JustDecompile and](https://www.telerik.com/products/decompiler.aspx) [dnspy. With over 370 Forks and](https://github.com/0xd4d/dnSpy)\nabout as many stars on Github at the time of writing this, Hiddentear is the arguably the most\npopular open source Windows Ransomware on the platform.\n\n\n-----\n\nThe original Ransomnote that is dropped to the Desktop by Hiddentear:\n\nIt uses the RijndaelManaged class implemented in System.Security.Cryptography for the file\nencryption routine (which is just a fancy way of saying, that victim data is encrypted with\nAES-256-CBC :D).\n\n\n-----\n\nBy default Hidden Tear will only spare Folders named Windows, Program Files and Program\n_Files (x86) and encrypt the contents of every Directory that doesn't match this condition._\n\n\n-----\n\n```\nif (!directories[j].Contains( Windows ) && !directories[j].Contains( Program Files )\n&& !directories[j].Contains(\"Program Files (x86)\"))\n{\n  this.encryptDirectory(directories[j], password);\n  this.messageCreator(directories[j]);\n}\n\n```\nAnother common mechanism to disrupt detection and analysis is a self deletion routine. After\na timeout to ensure a completed execution it will just remove itself via the Del argument.\n```\npublic void selfDestroy()\n{\n  ProcessStartInfo processStartInfo = new ProcessStartInfo()\n  {\n    Arguments = string.Concat(\"/C timeout 2 && Del /Q /F \",\nApplication.ExecutablePath),\n    WindowStyle = ProcessWindowStyle.Hidden,\n    CreateNoWindow = true,\n    FileName = \"cmd.exe\"\n    };\n  Process.Start(processStartInfo);\n}\n\n```\n[4shadow variant available @ Any.Run -->](https://app.any.run/tasks/82693192-3d98-41d8-bc0c-18e1fa214683/) `sha256`\n```\nfd5de1631c95041fde92042dd760e1fe27c7fe217d30e6568cc2e69eb812fb85\n\n```\nThis sample was found on the IIS Webhost of the Mineral Resources Authority of Papua New\nGuinea and tries to disguise as a Vodafone PDF Invoice.\n\nThrowing the dropped binary into Detect it Easy returns the notice that it pretends to be a\nWinRAR installer Version 5.x.\n\n\n-----\n\nExtracting the strings out of the mentioned executable (with a relatively new fancy tool by\n[fireeye called stringsifter) one can see that actually includes three references related to](https://github.com/fireeye/stringsifter)\nWinRAR, where the first is\n```\nD:\\Projects\\WinRAR\\sfx\\build\\sfxrar32\\Release\\sfxrar.pdb . As for a TIL: sfx\n\n```\nstands for \"self-extracting archive\" which is packaged with an executable to extract it so it's\n[(more or less) independent from the hostsystem. Wikipedia's got you hooked up.](https://en.wikipedia.org/wiki/Self-extracting_archive)\n\n[The full string dump can be had here. It also contains a number of messages in a foreign](https://dissectingmalwa.re/stuff/hiddentear-strings.txt)\nlanguage which are identified as turkish by Google Translate:\n\n\n-----\n\n-----\n\nLoading the binary into JustDecompileIt we notice that it was crypted by something called\nAika.\n\nThe Assembly Information also gives away that ConfuserEx is involved as well. The payload\nsection confirms that hint as we have an encrypted payload that will be fetched in runtime\nand then executed via RunPE.\n\nBelow you can see a screenshot of the Aika Crypter. As I already mentioned it is based on\nConfuserEx and includes the other run of the mill evasion techniques and Injections (RunPE\nor self).\n\n\n-----\n\nThis sample also features an anti-debugging check via IsDebuggerPresent. Nothing we\n�[�]�[�]�\nhaven't seen before either. (▀Ĺ�▀ )̿\n\n\n-----\n\n## Open Source Ransomware (Malware)?\n\nThe main reason why projects like Hidden Tear exist is to use it as a training model and PoC\nto handle \"real\" ransomware more efficiently. Critics say that OSS Malware will never match\nreal threats - which is definitely true to some extent - and that it only promotes building\nweaponized versions of it. On the other hand OSS ransomware is very useful to get a true\nbaseline reading from a sandbox system since you know for sure what it will do next. So\nwhat should you think about it know? If you ask me the bad outweighs the good here: Per\nday multiple new weaponized versions of Hidden Tear hit AnyRun, VT and Co. that are\npacked/obfuscated or modified with numerous evasion techniques. If it shows us one thing\nit's that building ransomware isn't hard. Even worse: it is not like ransomware is a dual use\ntool (like e.g. a hammer). Nobody will call you out for build a PoC binary to better understand\nthe inner workings and how to analyse it afterwards. Don't get me wrong: I'm a HUGE\nadvocate of open source software, but please don't push your \"Proof of Concepts\" to Github\nif they can literally be turned into malware by exchanging a URL and Bitcoin address.\n\n\n-----\n\n## IOCs\n\n### Hidden Tear (SHA256 / SSDEEP)\n```\n454364vodafone-e-fatura.exe\nfd5de1631c95041fde92042dd760e1fe27c7fe217d30e6568cc2e69eb812fb85 \n24576:8NA3R5drXfZAeMQ7MSTlRVHJ88iV4npWuSp008q75pVQNohig1w2YHgLo/:95BAvu7TD1YV0xJYtYOhH\ncryptoJoker.exe / \"Shade Ransomware creater is stupid fxxxxx.exe\"\nba978eee90be06b1ce303bbee33c680c2779fbbc5b90c83f0674d6989564a70a\n12288:gnSKwjzsZpds2JbrpolSKwjzuZpXs2JTypo:USKwWes6lSKw88s/ \n\n URLs\nhxxp://fairybreathes.6te[.]net/write.php?info=\n\n Affected File Extensions\n\".txt\", \".doc\", \".docx\", \".xls\", \".xlsx\", \".ppt\", \".pptx\", \".odt\", \"jpeg\", \".png\",\n\".csv\", \".sql\", \".mdb\", \".sln\", \".php\", \".asp\", \".aspx\", \".html\", \".xml\", \".psd\",\n\".sql\", \".mp4\", \".7z\", \".rar\", \".m4a\", \".wma\", \".avi\", \".wmv\", \".csv\", \".d3dbsp\",\n\".zip\", \".sie\", \".sum\", \".ibank\", \".t13\", \".t12\", \".qdf\", \".gdb\", \".tax\", \".pkpass\",\n\".bc6\", \".bc7\", \".bkp\", \".qic\", \".bkf\", \".sidn\", \".sidd\", \".mddata\", \".itl\", \".itdb\",\n\".icxs\", \".hvpl\", \".hplg\", \".hkdb\", \".mdbackup\", \".syncdb\", \".gho\", \".cas\", \".svg\",\n\".map\", \".wmo\", \".itm\", \".sb\", \".fos\", \".mov\", \".vdf\", \".ztmp\", \".sis\", \".sid\",\n\".ncf\", \".menu\", \".layout\", \".dmp\", \".blob\", \".esm\", \".vcf\", \".vtf\", \".dazip\",\n\".fpk\", \".mlx\", \".kf\", \".iwd\", \".vpk\", \".tor\", \".psk\", \".rim\", \".w3x\", \".fsh\",\n\".ntl\", \".arch00\", \".lvl\", \".snx\", \".cfr\", \".ff\", \".vpp_pc\", \".lrf\", \".m2\",\n\".mcmeta\", \".vfs0\", \".mpqge\", \".kdb\", \".db0\", \".dba\", \".rofl\", \".hkx\", \".bar\",\n\".upk\", \".das\", \".iwi\", \".litemod\", \".asset\", \".forge\", \".ltx\", \".bsa\", \".apk\",\n\".re4\", \".sav\", \".lbf\", \".slm\", \".bik\", \".epk\", \".rgss3a\", \".pak\", \".big\", \"wallet\",\n\".wotreplay\", \".xxx\", \".desc\", \".py\", \".m3u\", \".flv\", \".js\", \".css\", \".rb\", \".p7c\",\n\".pk7\", \".p7b\", \".p12\", \".pfx\", \".pem\", \".crt\", \".cer\", \".der\", \".x3f\", \".srw\",\n\".pef\", \".ptx\", \".r3d\", \".rw2\", \".rwl\", \".raw\", \".raf\", \".orf\", \".nrw\", \".mrwref\",\n\".mef\", \".erf\", \".kdc\", \".dcr\", \".cr2\", \".crw\", \".bay\", \".sr2\", \".srf\", \".arw\",\n\".3fr\", \".dng\", \".jpe\", \".jpg\", \".cdr\", \".indd\", \".ai\", \".eps\", \".pdf\", \".pdd\",\n\".dbf\", \".mdf\", \".wb2\", \".rtf\", \".wpd\", \".dxg\", \".xf\", \".dwg\", \".pst\", \".accdb\",\n\".mdb\", \".pptm\", \".pptx\", \".ppt\", \".xlk\", \".xlsb\", \".xlsm\", \".xlsx\", \".xls\", \".wps\",\n\".docm\", \".docx\", \".doc\", \".odb\", \".odc\", \".odm\", \".odp\", \".ods\", \".odt\", \".lnk\",\n\".iso\"\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-10-26 - Earn-quick-BTC-with-Hiddentear.mp4 - About Open Source Ransomware.pdf"
    ],
    "report_names": [
        "2019-10-26 - Earn-quick-BTC-with-Hiddentear.mp4 - About Open Source Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535859,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653701279,
    "ts_modification_date": 1653701279,
    "files": {
        "pdf": "https://archive.orkl.eu/95190baadaaa789f724a01601748fb2c02518b10.pdf",
        "text": "https://archive.orkl.eu/95190baadaaa789f724a01601748fb2c02518b10.txt",
        "img": "https://archive.orkl.eu/95190baadaaa789f724a01601748fb2c02518b10.jpg"
    }
}