{
    "id": "a9c9ca29-d262-4885-91b2-aae21701f266",
    "created_at": "2023-01-12T15:04:53.369032Z",
    "updated_at": "2025-03-27T02:06:06.116365Z",
    "deleted_at": null,
    "sha1_hash": "145fe8a0bf47cd6f37439846539db61eaeb6e9e1",
    "title": "2022-12-08 - Mallox Ransomware showing signs of Increased Activity",
    "authors": "",
    "file_creation_date": "2022-12-29T00:30:40Z",
    "file_modification_date": "2022-12-29T00:30:40Z",
    "file_size": 1717252,
    "plain_text": "# Mallox Ransomware showing signs of Increased Activity\n\n**[blog.cyble.com/2022/12/08/mallox-ransomware-showing-signs-of-increased-activity/](https://blog.cyble.com/2022/12/08/mallox-ransomware-showing-signs-of-increased-activity/)**\n\n## Ransomware potentially targeting organizations dealing in Critical Infrastructure\n\n\nDecember 8, 2022\n\n\n[“TargetCompany” is a type of ransomware that was first identified in June 2021. The researchers named it](https://id-ransomware.blogspot.com/2021/06/tohnichi-ransomware.html)\n_TargetCompany ransomware because it adds the targeted company name as a file extension to the_\n[encrypted files. In September 2022, researchers identified a TargetCompany ransomware variant targeting](https://asec.ahnlab.com/en/39152/)\nMicrosoft SQL servers and adding the “Fargo” extension to the encrypted files. TargetCompany\nransomware is also known to add a “Mallox” extension after encrypting the files.\n\nCyble Research and Intelligence Labs (CRIL) recently observed a spike in Mallox ransomware samples.\nThe figure below shows the statistics of Mallox Ransomware samples in the wild, indicating that the\nransomware is active, spreading rapidly, and infecting users in recent weeks.\n\n\n-----\n\nFigure 1 – Timeline of Samples Count Observed In The Wild\nThese Mallox ransomware samples are downloaded and loaded by an unknown loader. The loader further\ndownloads Mallox ransomware from the remote server and encrypts files in the victim’s machine.\nAdditionally, the ransomware group maintains a leak site with information related to the victims of the\nransomware attacks. The figure below shows the leak site of Mallox Ransomware.\n\nFigure 2 – Mallox Ransomware Leak Site\n\n## Technical Analysis\n\n\n-----\n\n### Loader analysis:\n\nAn unknown .NET-based loader downloads Mallox ransomware. Our research indicates that the loader is\nknown to be downloading other malware families such as Agentesla, Remcos, Snake keylogger, etc. This\nloader usually arrives via spam email with different flavors to lure the users into downloading and executing\nthe email attachment.\n\nThe loader acts as a downloader that downloads encrypted malicious content from the remote server,\ndecrypts it in the loader memory, and executes it. The loader executes the malicious content in the memory\nwithout saving the actual payload in the disk to evade anti-virus detection. The loader downloads\nencrypted payloads with a file extension such as png, jpeg, or bmp.\n\nThe loader is 32-bit .Net executable file with the file name “Cqasdqtamip.exe” and sha265 as\ne3a0bbd623db2b865fc3520c8d05e8b92016af2e535f0808460295cb8435836a. Additional details are\nshown in the figure below.\n\nFigure 3 – File Details of Mallox Loader\nUpon execution, the loader downloads the encrypted malicious content from the URL\n_hxxp://80[.]66[.]75[.]98/Chseiyk.jpeg._\n\nThe figure below shows the hardcoded URL and code to download the file.\n\n\n-----\n\nFigure 4\n\n– Malicious URL and Code to Download the Encrypted Payload\nAfter downloading, the loader keeps the encrypted content in the memory to decrypt it. The malicious\ncontent is encrypted with the AES encryption algorithm using the key “Cwgoawrnxz”, which is hardcoded in\nthe loader’s binary.\n\nThe figure below shows the encrypted payload in the memory and decryption key.\n\n\n-----\n\nFigure 5 – Loader Code to Decrypt the Malicious Content\nThe loader now decrypts the payload to get the actual ransomware binary in the memory and further\nexecutes this binary to perform ransomware activities. The below Figure shows the Decrypted ransomware\nDLL file in the memory.\n\nFigure 6 – Routine to Decrypt Downloaded Payload\n\n### Mallox Ransomware Payload Analysis:\n\nThe downloaded and decrypted file is a 32-bit .NET-based DLL with the name “Wwxjdcapjnmuq.dll” and\nsha256 as b64606198c158f79287b215343d286adf959e89acb054f8f3db706f3c06f48aa.\n\nThe following figure shows additional details.\n\n\n-----\n\nFigure 7 – Details of Malicious DLL Payload\nThe DLL file is further obfuscated with an IntelliLock obfuscator to make malware reversal more difficult.\nThe loader now loads the decrypted ransomware DLL as assembly using the Assembly.Load() function.\n\nAfter loading DLL, the loader enumerates methods from the DLL file and creates a list of method names\nand objects from the loaded assembly. The loader now creates a thread pool of the methods for executing\nthe ransomware code. The figure below shows the code to load the DLL as assembly, creating the list of\nmethods and thread pool for executing the ransomware code.\n\n\n-----\n\nFigure 8 –\n\nCode to Dynamically Load the Methods from the Ransomware\nAfter creating the thread pool, the loader then uses the InvokeMember() function to execute the threads for\n_a list of previously created methods. The following figure shows the code to execute threads for the_\nmethods created from the loaded assembly.\n\n\n-----\n\nFigure 9 – Code to Execute the Methods for Ransomware Operation\nAfter execution, the ransomware drops a batch file “Axfiysgodhtrlqmrgpchkiller.bat” into the temp folder and\nexecutes it. This batch file stops numerous services and programs so that associated files are encrypted\nwithout any interruption during the encryption process.\n\nThe following figure shows the contents of the batch file.\n\nFigure 10 – Contents of the Batch File\nInterestingly, the ransomware also stops GPS-related programs, indicating that the ransomware could be\ntargeting organizations dealing in the critical infrastructure sector.\n\nThe figure below shows the commands to stop running GPS-related programs.\n\n\n-----\n\nFigure 11 – Batch File Containing GPS-Related Program\nThe ransomware disables several services and stops running programs in the system. Some important\nservices and programs are:\n\n**Database Related Services: MSSQL, MSSQL Server, PostgreSQL, Oracle, etc.**\n**Backup Related Services: VSS, Veeam, etc.**\n**Windows Related Programs: OneDrive, Excel, Outlook, WinWord, etc.**\n**File Sharing and Servers Related programs: FileZilla FTP Server, Apache Tomcat Server,**\nMicrosoft Exchange Server, OpenSSH, WAMP Server, Nginx, etc.\n**Business Management Software: SAP Business One, Jenkins, Redis, SVN Server, Turbo CRM,**\nKingdee, etc.\n**Virtualization Programs and Services: VirtualBox, VMware. Etc.**\n**GPS Related Commands: GPSDaemon, GPSUserSvr, GPSDownSvr, GPSStorageSvr,**\nGPSDataProcSvr, GPSGatewaySvr, etc.\n\nBefore encrypting the files, the ransomware exfiltrates system information such as Operating system\nversion, Desktop name, etc., and sends it to the Command & Control (C&C) server using a POST request\nas shown below.\n\nFigure 12 – Victim information being exfiltrated to Ransomware’s C&C\nThe ransomware then encrypts the files, appends “.Mallox” as a file extension, and drops a ransom note in\nthe folders, as shown below.\n\n\n-----\n\nFigure 13 – Encrypted Files and Ransom Note\nThe figure below shows the ransom note dropped on the victim system.\n\nFigure 14 – Contents of the Mallox Ransomware Note\nThe ransom note also contains a private chat link for the victims to connect with the Threat Actor. The Chat\npage contains information such as TargetID, hard disk size, Payment Details, etc.\n\nThe TA has also provided features in their Chat page to their victims for uploading encrypted samples to\ntest the decryption.\n\n\n-----\n\nFigure 15 – Victim’s chat page\n\n## Conclusion\n\nOver the last few days, we have observed increased levels of activity from the Mallox ransomware group.\nThe ransomware group is using an unknown loader which is used for downloading and executing the\nransomware. Additionally, Mallox ransomware stopped GPS-related services, indicating their targets could\nbe organizations dealing in Operation Technology and Critical Infrastructure.\n\n## Our Recommendations\n\nWe have listed some of the essential cybersecurity best practices that create the first line of control against\nattackers. We recommend that our readers follow the best practices given below:\n\n**Safety Measures Needed to Prevent Ransomware Attacks**\n\nConduct regular backup practices and keep those backups offline or in a separate network.\nTurn on the automatic software update feature on your computer, mobile, and other connected\ndevices wherever possible and pragmatic.\nUse a reputed anti-virus and Internet security software package on your connected devices, including\nPC, laptop, and mobile.\nRefrain from opening untrusted links and email attachments without verifying their authenticity.\n\n\n-----\n\n**Users Should Take the Following Steps After the Ransomware Attack**\n\nDetach infected devices on the same network.\nDisconnect external storage devices if connected.\nInspect system logs for suspicious events.\n\n**Impact And Cruciality of Ransomware**\n\nLoss of valuable data.\nLoss of the organization’s reputation and integrity.\nLoss of the organization’s sensitive business information.\nDisruption in organization operation.\nMonetary loss.\n\n## MITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\n**Execution** [T1204](https://attack.mitre.org/techniques/T1204/) User Execution\n\n\n**Defense Evasion** [T1140](https://attack.mitre.org/techniques/T1140/)\n\n[T1562](https://attack.mitre.org/techniques/T1562/)\n\n**Discovery** [T1082](https://attack.mitre.org/techniques/T1082/)\n\n[T1083](https://attack.mitre.org/techniques/T1083/)\n\n\nDeobfuscate/Decode Files or Information\n\nImpair Defences\n\nSystem Information Discovery\n\nFile and Directory Discovery\n\n\n**Impact** [T1486](https://attack.mitre.org/techniques/T1486/) Data Encrypted for Impact\n\n**Command and Control** [T1071](https://attack.mitre.org/techniques/T1071/) Application Layer Protocol\n\n**Exfiltration** [T1020](https://attack.mitre.org/techniques/T1020/) Automated Exfiltration\n\n## IoCs\n\n**Indicators** **Indicator**\n**Type**\n\n\n**Description**\n\nMallox\nLoader\n\nChseiyk.jpeg\nEncrypted\nPayload\n\nMallox\nPayload\n\nMallox\nLoader\n\n\n**2456c01f5348e5c08f7e818d51862c1a**\n\n**625be3e4dbfb0bd35c9cda216a9bca7232dbec07**\n\n**34da973f1d154672b245f7a13e6268b4ffc88dea1ca608206b32759ec5be040c**\n\n**b739be28cb9a30868112d4786bc11d37**\n\n**296e19773f6fb7190d914ac556abe0125e5d7aa5**\n\n**b3ccec8ca26bc3b6597ddb0424a455eb7809e7608f5d62f6c7f5d757d4d32253**\n\n**86344d7e6e5b371717313032632cbbe1**\n\n**3921694be80b2fd5d8007c8155bee018c32fecbb**\n\n**b64606198c158f79287b215343d286adf959e89acb054f8f3db706f3c06f48aa**\n\n**688e0b37794395cfecaf9cc519e3c26a**\n\n**d215d4166dfa07be393459c99067319036eb80ba**\n\n**77fdce66e7f909300e4493cbe7055254f7992ba65f9b7445a6755d0dbd9f80a5**\n\n\nMD5\n\nSHA1\n\nSHA256\n\nMD5\n\nSHA1\n\nSHA256\n\nMD5\n\nSHA1\n\nSHA256\n\nMD5\n\nSHA1\n\nSHA256\n\n\n-----\n\n**6080b540d975b7a4f66cd54ee83ed600**\n\n**62324b38a5a5a2533f3bd401d7afd1c6c4235b08**\n\n**89c9c14af6ab4f3f93705325dbc32bde6c232d26d22e8f835db24efc18007ea4**\n\n**2ffae162e07ba8debdf25694e8fd8325**\n\n**a1289c3e585e091a7c8f89869a76e40f7e3880fd**\n\n**d691f44b587c6ed47c2d57b2bf99323877821a318cb0d5aa9899c40a44e81ef3**\n\n**cacbed12b83529ebb99b0297d52b0749**\n\n**db6d67f55bce0425baef2348e70f1478d022820e**\n\n**58726aac2652bedfe47b7e1c73ba39d028e2e6ad188f4ed735d614097be4a23b**\n\n**da3f02b82e982f5ce5a71d769a067f3b**\n\n**e165cac5ab2b2312f7ed8569c69a75bae48b8316**\n\n**7164ba41639c8edcd9ff1cf41a806c9a23de566b56a7f34a0205ba1f84575a48**\n\n**38454291f7b871d71a512b5dd5100d9e**\n\n**9e9c04f00822aacaa15d0bcc4749f8e6920d4550**\n\n**45391bfbb06263f421ac739e1e4b438fb99a0757dcecc68de79b2dbe02c1641e**\n\n**7be2a76577f6ee05ec08c77c41cd9dd4**\n\n**f3cfca7a2160559aa62b4cf42cd15870a4abcae7**\n\n**87a923319c6ea74a9cef5ed7528afdbd4a05e7600ce7f4359e5990ff8769a2ff**\n\n**6e542eda455e8c8600df96874c8deceb**\n\n**670530d36967c5927955d31052dff165a187c1f2**\n\n**d755cd96077cebbed84a86e69d1fd84b95e3e5763abc8ac8ec0a7f1df30e9585**\n\n\nMD5\n\nSHA1\n\nSHA256\n\nMD5\n\nSHA1\n\nSHA256\n\nMD5\n\nSHA1\n\nSHA256\n\nMD5\n\nSHA1\n\nSHA256\n\nMD5\n\nSHA1\n\nSHA256\n\nMD5\n\nSHA1\n\nSHA256\n\nMD5\n\nSHA1\n\nSHA256\n\n\nMallox\nLoader\n\nMallox\nLoader\n\nMallox\nLoader\n\nMallox\nLoader\n\nMallox\nLoader\n\nMallox\nLoader\n\nMallox\nLoader\n\n\n**hxxp://80[.]66[.]75[.]98/Chseiyk.jpeg** URL Malicious\nURL\n\n**hxxp://193[.]106[.]191[.]141/QWEwqdsvsf/ap.php** URL Connected\nURL\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-12-08 - Mallox Ransomware showing signs of Increased Activity.pdf"
    ],
    "report_names": [
        "2022-12-08 - Mallox Ransomware showing signs of Increased Activity.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535893,
    "ts_updated_at": 1743041166,
    "ts_creation_date": 1672273840,
    "ts_modification_date": 1672273840,
    "files": {
        "pdf": "https://archive.orkl.eu/145fe8a0bf47cd6f37439846539db61eaeb6e9e1.pdf",
        "text": "https://archive.orkl.eu/145fe8a0bf47cd6f37439846539db61eaeb6e9e1.txt",
        "img": "https://archive.orkl.eu/145fe8a0bf47cd6f37439846539db61eaeb6e9e1.jpg"
    }
}