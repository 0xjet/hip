{
    "id": "316926fc-5c76-46a2-9c2b-8fefd936e767",
    "created_at": "2023-01-12T15:09:33.134712Z",
    "updated_at": "2025-03-27T02:05:26.905808Z",
    "deleted_at": null,
    "sha1_hash": "611a4f0eda92369a09ee6045b5c5722e0d7651f0",
    "title": "2021-10-19 - Trickbot module descriptions",
    "authors": "",
    "file_creation_date": "2022-05-28T04:49:03Z",
    "file_modification_date": "2022-05-28T04:49:03Z",
    "file_size": 452538,
    "plain_text": "# Trickbot module descriptions\n\n**securelist.com/trickbot-module-descriptions/104603/**\n\nAuthors\n\nOleg Kupreev\n\nTrickbot (aka TrickLoader or Trickster), is a successor of the [Dyre banking Trojan that was](https://threats.kaspersky.com/en/threat/Trojan-Banker.Win32.Dyre/)\n[active from 2014 to 2016 and performed man-in-the-browser attacks in order to steal banking](https://encyclopedia.kaspersky.com/glossary/man-in-the-browser-attack/?utm_source=securelist&utm_medium=blog&utm_campaign=termin-explanation)\ncredentials. Trickbot was first discovered in October 2016. Just like Dyre, its main\nfunctionality was initially the theft of online banking data. However, over time, its tactics and\ngoals have changed. Currently Trickbot is focused on penetration and distribution over the\n[local network, providing other malware (such as Ryuk ransomware) with access to the](https://securelist.com/story-of-the-year-2019-cities-under-ransomware-siege/95456/)\ninfected system, though that’s not the only functionality it supports.\n\nOver the years, Trickbot has acquired dozens of auxiliary modules that steal credentials and\nsensitive information, spread it over the local network using stolen credentials and\nvulnerabilities, provide remote access, proxy network traffic, perform brute-force attacks and\ndownload other malware. In this document, we decided to provide a brief description of the\nTrickbot modules. Despite the fact the dates indicated in the PE headers of some modules\nare quite old, these modules are still available for download and can be used by threat\nactors. Such information should simplify analysis of any activity related to Trickbot.\n\n\n-----\n\n## Technical details\n\n### How to obtain Trickbot modules for analysis\n\nModules can be downloaded from one of Trickbot’s C2s using simple GET requests like\nhttps://<CC_IP>:<CC_PORT>/<gtag>/<bot_ID>/5/<module_name>/. Keep in mind that\nmodule names are case sensitive, and although we describe 32-bit modules in this article in\nmost cases 64-bit versions can be downloaded by replacing ’32’ with ’64’ in the module\nname. In most cases valid values of <gtag> and <bot_ID> are not needed for successful\ndownload. Here is an example of the URL to download the pwgrab64 module:\n\nhttps[:]//87.97.178[.]92:447/asdasdasd/asdasdasd_asdasdasd.asdasdasd/5/pwgrab64/\n\nDownloaded modules are encrypted, and can be decrypted with the Python script below.\n\n**_Python script with modules decryption routine_**\n\nThe table below contains the list of modules, and simplifies module description searches.\nPlease keep in mind that these modules were received at the end of May and their\nfunctionality and names may differ at the time of publication.\n\n**Module Name** **PE TimeStamp** **PE Internal Name** **Description link**\n\nadll32 14.11.2019 ADll.dll adll32\n\nadllog32 14.11.2019 ADll.dll adll32\n\nbexecDll32 13.04.2020 mexec.dll aexecDll32\n\n\n-----\n\nmexecDll32 29.11.2019 mexec.dll aexecDll32\n\nonixDll32 29.11.2019 mexec.dll aexecDll32\n\naexecDll32 17.06.2020 m001c.dll aexecDll32\n\nshadnewDll32 13.06.2019 inj_32.dll anubisDll32\n\nanubisDll32 08.10.2019 tbmf_32.dll anubisDll32\n\nbcClientDllNew32 05.02.2019 socks5dll.dll bcClientDll32\n\nbcClientDllTestTest32 29.08.2019 socks5dll.dll bcClientDll32\n\nTwoBCtestDll32 06.10.2019 client.dll bcClientDll32\n\nbcClientDll32 20.04.2017 bcClientDll.dll bcClientDll32\n\ntvncDll32 17.05.2021 VNCSRV.dll bvncDll32\n\nvncDll32 20.04.2021 VNCSRV.dll bvncDll32\n\nbvncDll32 11.02.2020 VNCSRV.dll bvncDll32\n\ncookiesDll32 04.07.2019 Cookies.dll cookiesDll32\n\ndomainDll32 16.01.2018 module32.dll domainDll32\n\nfscanDll32 23.12.2019 TestLib.dll fscanDll32\n\noimportDll32 24.07.2020 grabber.dll importDll32\n\ntimportDll32 22.03.2021 grabber.dll importDll32\n\nimportDll32 24.03.2021 grabber.dll importDll32\n\ntotinjectDll32 14.06.2019 webinject32.dll injectDll32\n\ninjectDll32 17.09.2020 <none> injectDll32\n\nsokinjectDll32 14.06.2019 webinject32.dll injectDll32\n\ntinjectDll32 25.02.2021 webinject32.dll injectDll32\n\nmailsearcher32 22.04.2019 mailsearcher.dll mailsearcher32\n\nmasrvDll32 04.12.2020 masrv.dll masrvDll32\n\nmlcDll32 18.11.2019 MailClient.dll mlcDll32\n\nnetworkDll32 14.12.2020 dll.dll networkDll32\n\n\n-----\n\nnetworknewDll32 06.04.2020 dll.dll networkDll32\n\ntnetworkDll32 14.12.2020 dll.dll networkDll32\n\nsocksDll32 07.04.2021 socksbot.dll NewBCtestnDll32\n\nNewBCtestnDll32 07.04.2021 socksbot.dll NewBCtestnDll32\n\noutlookDll32 <none> OutlookX32.dll outlookDll32\n\nowaDll32 21.10.2019 owa.dll owaDll32\n\npermaDll32 19.10.2020 user_platform_check.dll permaDll32\n\npsfin32 05.11.2018 dll.dll psfin32\n\nrdpscanDll32 10.06.2020 rdpscan.dll rdpscanDll32\n\ntrdpscanDll32 10.07.2020 rdpscan.dll rdpscanDll32\n\nshadDll32 12.03.2019 inj_32.dll shadDll32\n\ntshareDll32 21.04.2020 templ.dll shareDll32\n\nshareDll32 01.02.2021 <none> shareDll32\n\nsharesinDll32 22.01.2020 dlltest1.dll sharesinDll32\n\nsqlscanDll32 14.12.2019 sqlscan.dll sqlscanDll32\n\nsquDll32 23.04.2020 mailFinder_x86.dll squDll32\n\nsqulDll32 19.04.2018 mailFinder_x86.dll squlDll32\n\nsysteminfo32 13.09.2019 SystemInfo.dll systeminfo32\n\nstabDll32 02.07.2020 <random> tabDll32\n\ntabDll32 03.08.2020 tabdll_x86.dll tabDll32\n\ntesttabDll32 04.06.2019 tabdll_x86.dll tabDll32\n\nttabDll32 30.07.2020 tabdll.dll tabDll32\n\npwgrab32 19.03.2021 <random> tdpwgrab32\n\npwgrabb32 19.03.2021 <random> tdpwgrab32\n\ntpwgrab32 26.02.2021 <random> tdpwgrab32\n\ndpwgrab32 19.03.2020 pwgrab.dll tdpwgrab32\n\n\n-----\n\ntdpwgrab32 26.02.2021 <random> tdpwgrab32\n\nvpnDll32 04.06.2020 vpnDll.dll vpnDll32\n\nwebiDll32 11.05.2021 webinject32.dll webiDll32\n\ntwormDll32 15.10.2019 testinfo.dll wormDll32\n\nwormDll32 18.02.2021 <random> wormDll32\n\nwormwinDll32 22.01.2020 <random> wormDll32\n\n**adll32**\n\nThe new Trickbot module ADLL dumps Active Directory database files (ntds.dit and ntds.jfm)\nand registry hives using the ntdsutil and reg tools. For example, it utilizes the “Install from\nMedia (IFM)” ntdsutil command to dump the Active Directory database and various registry\nhives to the %Temp% folder. These files are then compressed and sent back to the\nattackers.\n\n**_Part of the adll32 function of collecting information using the ntdsutil tool_**\n\n**_Part of the adll32 function collecting information using the reg tool_**\n\nThe module uses the ntdsutil and reg tools with the following command line arguments:\n\nntdsutil “ac in ntds” “ifm” “cr fu %TEMP%\\<random>0.dat” q q\nreg save HKLM\\SAM %TEMP%\\<random>1.dat /y\nreg save HKLM\\SECURITY %TEMP%\\<random>2.dat /y\nreg save HKLM\\SYSTEM %TEMP%\\<random>3.dat /y\n\nThese commands will dump the Active Directory database as well as the SAM, SECURITY,\nand SYSTEM hives. Threat actors can decrypt these files and dump the usernames,\npassword hashes, computer names, groups, and other data. This data can then be used for\n\n\n-----\n\nspreading further across the network.\n\n**aexecDll32**\n\nThis module is a simple downloader. It downloads a payload (e.g., another Trickbot module\nor third-party malware) by hardcoded URL and executes it.\n\n**_Part of the aexecDll32 download routine_**\n\n**anubisDll32**\n\n[This is a man-in-the-browser module. It contains a full implementation of the IcedID main](https://securelist.com/malicious-spam-campaigns-delivering-banking-trojans/102917/)\nmodule. It can intercept web traffic on the victim machine. This module also contains\nembedded binary Anubis VNC (also known as HDESK Bot), which is a custom RAT based\non the VNC (Virtual Network Computing) protocol that’s used by IcedID for remote control.\n\n**bcClientDll32**\n\nThis is a reverse proxy module with custom implementation of SOCKS5 protocol. It is used\nto bypass traffic through the compromised host.\n\n**bvncDll32**\n\nThis module is an implementation of Hidden VNC, which is a custom remote administration\ntool based on the VNC (Virtual Network Computing) protocol. Hidden means that this\nmodification of the VNC creates an additional desktop hidden from the user, allowing\nattackers to work with the compromised system in the same way as via an RDP connection\nwithout attracting the user’s attention. Web sessions and user passwords saved in the\nbrowser are available in hVNC sessions. An attacker can freely run a web browser on a\nremote system, accessing any web service when there is an active user session.\n\n**cookiesDll32**\n\n\n-----\n\nThe module steals cookie data from web browsers. It targets the storage databases of\nChrome, Firefox, Internet Explorer and Microsoft Edge.\n\n**domainDll32**\n\nThe module is also called DomainGrabber. It collects domain controller information on\ncompromised systems by accessing the SYSVOL folder. The first modification of this module\nwas querying for groups.xml, services.xml, scheduledtasks.xml, datasources.xml,\nprinters.xml and drives.xml files. The current modification of this module only queries for\ngroup policies (groups.xml).\n\n**_Routines for group policies collecting in DomainGrabber module_**\n\n**tdpwgrab32**\n\nThis module is a password stealer module. It can steal credentials stored in registry,\ndatabases of different applications, configuration and “precious files”, i.e., private keys, SSL\ncertificates and crypto wallet data files. It is also able to grab autofill information from web\nbrowsers. The module is capable of stealing data from the following applications: Git,\n\n\n-----\n\nTeamViewer, OpenSSH, OpenVPN, KeePass, Outlook, FileZilla, Internet Explorer, Mozilla\nFirefox, Google Chrome, Microsoft Edge, RDP, WinSCP, VNC, UltraVNC, RealVNC,\nTigerVNC, PuTTY, AnyConnect. Note that newer module versions may also target other\napplications.\n\n**fscanDll32**\n\nThis is an FTP (File Transfer Protocol) and SFTP (SSH File Transfer Protocol) file scanner\nbased on the open-source software project cURL. The module receives a list of rules for\nmatching files and FTP/SSH resources, enumerates the files on the targeted resource and\nreports back to the C2.\n\n**_Part of SFTP read routine_**\n\n**importDll32**\n\nThis module steals data from web browsers, including browser configuration, cookies,\nhistory, title, visit count, HTML5 local storage. The browsers Internet Explorer, Mozilla\nFirefox, Google Chrome, and Microsoft Edge are targeted. The module also gathers\ninformation about installed browser plugins and components.\n\n**_Fragment of the browser information grabbing routine_**\n\n**injectDll32**\n\n\n-----\n\nThis module is used to intercept activity related to banking websites in browsers. It uses web\ninjects to steal financial information. Two types of attack are supported: “static” and\n“dynamic”. Static attacks redirect user requests to a malicious phishing page, while dynamic\nattacks pass all traffic through the malicious proxy server, making it possible to grab\ninformation from input forms and modify banking website responses by injecting additional\nmalicious scripts in returned pages.\n\n**_Examples of “static” and “dynamic” configs_**\n\nIn order to intercept traffic, an old version of the module (active before 2019) used to inject\nitself into numerous browser processes and hook networking API functions responsible for\nan SSL cipher routine and website certificate validation: HttpSendRequest, InternetReadFile\nfor Internet Explorer, PR_Read, PR_Write for Mozilla Firefox, SSL_read, SSL_write for\nGoogle Chrome.\n\nHowever, in early 2019 an updated module was released. The developers abandoned the\ninterception of multiple functions in different browsers and concentrated on hooking just a\nfew basic Microsoft Windows network functions: the ws2_32::connect() function and WSA\nextension function mswsock::ConnectEx(). In order to perform an attack on SSL\nconnections, the module generates a self-signed certificate, and inserts it into the certificate\nstore. Different internal browser APIs are used to install self-signed certificate in different\nbrowsers. The functions crypt32::CertGetCertificateChain() and\ncrypt32::CertVerifyCertificateChainPolicy() are also hooked to bypass certificate validation.\n\n**EMBEDDED MODULE PE timestamp:2020-09-17 InternalName:<payload32.dll>**\n\n\n-----\n\nThis submodule injects itself into browser processes (Internet Explorer, Mozilla Firefox,\nGoogle Chrome, Microsoft Edge) and intercepts a networking API in order to redirect\nbrowser traffic through a local proxy based on a modified SOCKS protocol. It also intercepts\nAPIs responsible for certificate chain validation, in order to spoof the results of checking.\n\n**mailsearcher32**\n\nThis module enumerates all disks and folders, and searches for email patterns in files. It\nignores files with selected extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav’,\n.ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico. In addition it unpacks files with .xlsx, .docx, and\n.zip extensions, and performs the same email patterns search in the extracted file. Every\ntime scanning of a disk ends, the module sends the list of found addresses back to the C2\nserver.\n\n**masrvDll32**\n\nThis module is a network scanner based on source code of the Masscan software project.\nThe module requests the range of IP addresses from the C2, scans all IPs in this range for\nthe opened port, and sends the list of found addresses and ports back to the C2 server.\n\n**mlcDll32**\n\nThis module implements the main functionality of the Gophe spambot. The Gophe spambot\nwas used to propagate Dyre malware. As the successor to Dyre, it comes as no surprise that\nTrickbot has also inherited Gophe’s source code. It can grab emails from Outlook and send\nspam through Outlook using MAPI. It also removes traces of spamming by deleting emails\nfrom the Outlook Sent Items folder. This module is also propagated by Trickbot as a\nstandalone executable known as TrickBooster.\n\n**networkDll32**\n\nThis module gets information about the network from the local system. It uses the following\n[ADSI (Active Directory Service Interfaces) property methods to gather information:](https://docs.microsoft.com/en-us/windows/win32/adsi/iadsadsysteminfo-property-methods)\n\nComputerName;\nSiteName;\nDomainShortName;\nDomainDNSName;\nForestDNSName;\nDomainController.\n\nIt retrieves the DNS names of all the directory trees in the local computer’s forest. It also gets\na full process list and system information snapshot (OS Architecture / ProductType / Version\n/ Build / InstalationDate / LastBootUpTime / SerialNumber / User / Organization /\nTotalPhysicalMemory).\n\n\n-----\n\nThe module executes and gathers the results of selected commands:\n\n“ipconfig /all”\n“net config workstation”\n“net view /all”\n“net view /all /domain”\n“nltest /domain_trusts”\n“nltest /domain_trusts /all_trusts”\n\n**NewBCtestnDll32**\n\nThis module is a reverse proxy module with custom implementation of the SOCKS5 protocol.\nIt’s used to bypass traffic through the compromised host. The module can determine the\nexternal network IP address by STUN protocol using Google’s STUN servers. It can also\ncreate new processes by receiving a command line from a proxy-C2. It can’t download\nbinaries for execution, but the ability to create new processes by starting powershell.exe with\na Base64 encoded script in the command line transforms this module into a backdoor. Note\nthat this is a common tactic for many actors.\n\n**outlookDll32**\n\nThis module is written in Delphi, which is uncommon. The module tries to retrieve credentials\nfrom the Outlook profile stored in the system registry.\n\n**owaDll32**\n\nThis module receives a list of domains, logins and passwords from the C2, and tries to find\nan OWA service on selected domains. To do so, it creates a URL by adding subdomains\n(‘webmail.’, ‘mail.’, ‘outlook.’) to domains from the list, and setting the URL path to ‘/owa’.\nAfter that it makes a POST request to the crafted URL, and checks the response for strings,\ntags or headers that are specific to an OWA service. The module then reports back to the C2\nabout the OWA URLs it finds. It can also perform a brute-force attack on the OWA URLs with\nlogins and passwords received from the C2.\n\n\n-----\n\n**_Part of the C2 report routine in owaDll32 module_**\n\n**permaDll32**\n\nThis module contains the encrypted embedded module RwDrv.sys. It installs RwDrv.sys\ndriver to get low-level access to hardware. It identifies the hardware platform, checks the\nUEFI/BIOS write protection, and reports back to the C2. It can’t write any implants to UEFI or\nany shellcode into physical memory. However, the code of the module can easily be updated\nwith this functionality.\n\n**EMBEDDED SYS MODULE timestamp:2013-03-25 InternalName:RwDrv.sys**\n\nThis is a driver from the RWEverything utility. This utility enables access to computer\nhardware.\n\n**psfin32**\n\nUsing Active Directory Service Interfaces (ADSI), this module makes Lightweight Directory\nAccess Protocol (LDAP) and GlobalCatalog (GC) queries for organizational unit names, site\nname, group account name, personal account name, computer host name, with selected\nmasks ‘*POS*’, ‘*REG*’, ‘*CASH*’, ‘*LANE*’, ‘*STORE*’, ‘*RETAIL*’, ‘*BOH*’, ‘*ALOHA*’,\n‘*MICROS*’, ‘*TERM*’.\n\n\n-----\n\n**_Part of C2 report routine in psfin32 module_**\n\n**_GlobalCatalog (GC) queries using ADSI_**\n\n**rdpscanDll32**\n\n\n-----\n\nThis module receives a list of domains, IPs, logins and passwords from the C2, performs a\ncheck for RDP connection on the list of targets, and reports back to the C2 about the online\nstatus of targets. It can perform brute-force attacks on targeted systems, using the received\nlogins and passwords. It also has the ability to brute force credentials by mutating IPs,\ndomain names and logins, for instance, by replacing, swapping or removing letters, numbers,\ndots, switching from lower to upper case or vice versa, performing string inversion, etc.\n\n**shadDll32**\n\nThis is the first implementation of the anubisDll32 module. It does not include the Anubis\nVNC embedded binary.\n\n**shareDll32**\n\nThis module is used to spread Trickbot over the network. It downloads Trickbot from the URL\nhttp[:]//172[.]245.6.107/images/control.png and saves it as tempodile21.rec. It then\nenumerates network resources and tries to copy the downloaded Trickbot to selected shares\nC$ or ADMIN$ as nats21.exe. It then creates and starts a remote service on the\ncompromised system in the following paths:\n\n%SystemDrive%\\nats21.exe\n%SystemRoot%\\system32\\nats21.exe\n\nThe following service names are used to hide the presence of nats21.exe:\n\nSystemServiceHnet\nHnetSystemService\nTechnoHnetService\nAdvancedHnexTechnic\nServiceTechnoSysHnex\nHnexDesktop\n\n**sharesinDll32**\n\nThis module has the same functionality as shareDll32. However, the Trickbot binary dropped\nby this module has the name nicossc.exe, and the URL it uses to get Trickbot is\nhttp[:]//185[.]142.99.26/image/sdocuprint.pdf. The service names are also different:\n\nCseServiceControl\nControlServiceCse\nBoxCseService\nTechCseService\nAdvanceCseService\nServiceCseControl\nCseServiceTech\n\n\n-----\n\nTechCseServiceControl\n\n**sqlscanDll32**\n\nThis module tries to implement the SQLi vulnerability scanner. It receives list of target\ndomains, and tries to extend it with subdomains by querying the Entrust web interface\nhttps[:]//ctsearch.entrust[.]com/api/v1/certificates?fields=subjectDN&domain=\n<targeted_doma in>&includeExpired=true&exactMatch=false&limit=100. It then performs\nmultiple HTTP queries with malformed data on pages and forms of the targeted domains,\nmeasures the time or difference in responses in order to check if the targeted resource is\npotentially vulnerable.\n\n**squDll32**\n\nThis module gathers addresses of SQL servers. It enumerates registry values at\nHKLM\\SOFTWARE\\Microsoft\\Microsoft SQL Server\\Instance Names\\SQL to obtain SQL\nserver instances. It also makes a broadcast UDP request on ports 1433 and 1434 to obtain\nSQL server instances from the SQL Server Browser service that usually runs on these ports.\nAfter gathering SQL server instances, it drops the submodule mailCollector and passes the\ncollected targets to it.\n\n**EMBEDDED EXE MODULE timestamp:2020-04-23 InternalName:**\n**<none>AliasName:mailCollector**\n\nThis submodule uses the ADODBI interface to communicate with SQL servers, enumerate\ndatabases, and make search queries for the extraction of email addresses. The following\nquery templates are used:\n\nselect COUNT(*) from [%s] where [%s] like ‘%%@%%.%%’\nselect [%s] as MAIL from [%s] where [%s] like ‘%%@%%.%%’\n\n**squlDll32**\n\nThis is an old version of squDll32. It uses SQLDMO.dll to enumerate the available SQL\nserver instances.\n\n**tabDll32**\n\nThis module propagates Trickbot via the EternalRomance exploit. It enables WDigest\nAuthentication by modifying the UseLogonCredential value in the\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest registry key. This\nmodification is forced to save credentials in lsass.exe memory (Local Security Authority\nSubsystem Service). The tabDll32 module then injects the embedded module screenLocker\nin explorer.exe and locks the workstation with the lock screen, forcing the user to login again.\nIt waits for next user login and scrapes the credentials from LSASS memory utilizing\n\n\n-----\n\nMimikatz functionality. Stolen credentials are sent back to the C2. After that tabDll32\ndownloads the payload from hardcoded URLs – usually the Trickbot loader (downloader) –\nstarts up to 256 threads and uses the EternalRomance exploit to rapidly spread the\ndownloaded payload over the network. Another embedded module, ssExecutor_x86, is used\nto set up persistence for the downloaded payload on exploited systems. This module also\ncontains the main code of the shareDll32 module, and uses it to spread over the network.\n\nThe module ssExecutor_x86 copies the payload into the C:\\WINDOWS\\SYSTEM32\\ and\nC:\\WINDOWS\\SYSTEM32\\TASKS folders, and executes the payload. It enumerates user\nprofiles in registry, copies the payload to C:\\Users\\<User Profile>\\AppData\\Roaming\\ and\nestablishes persistence by creating shortcuts in the profile’s Startup folder and creating a\n‘Run’ key in the profile’s registry.\n\nThe tabDll32 module also exists in the form of a standalone executable with the alias\n‘spreader’.\n\n**systeminfo32**\n\nThis module gathers basic system information. It uses WQL to get information about the OS\nname, architecture, version, CPU and RAM information. It also collects user account names\non the local computer and gathers information about installed software and services by\nenumerating HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall’ and\n‘HKLM\\SYSTEM\\CurrentControlSet\\Services registry keys.\n\n**vpnDll32**\n\nThis module uses an RAS (Remote Access Service) API to establish a VPN (Virtual Private\nNetwork) connection. The destination VPN server, and credentials for connection are\nprovided by the C2’s command and configuration files.\n\n**_Setting the RAS (Remote Access Service) entry._**\n\n\n-----\n\n<\n\n**_The vpnDll32 module establishes a VPN connection_**\n\n**webiDll32**\n\nThis module is used to intercept activity related to banking websites in browsers. It uses web\ninjects to steal financial information. In addition to typical static and dynamic injections, this\nmodification also supports web injects in the Zeus format, and can modify pages on the client\nside.\n\n**_Trickbot web inject configuration file in Zeus format_**\n\n**wormDll32**\n\nThis module propagates Trickbot with the EternalBlue exploit. It enumerates computers using\nNetwork Management API and Active Directory Service Interfaces. It uses the EternalBlue\nexploit to inject shellcode in LSASS process memory. The injected shellcode downloads\nTrickbot from a hardcoded URL and executes it.\n\nDescription of other modules\n\n\n-----\n\n**Module** **Description**\n\nadllog32 Debug version of adll32 module\n\nbcClientDllNew32 Same as bcClientDll32\n\nbcClientDllTestTest32 Same as bcClientDll32\n\nbexecDll32 Same as aexecDll32\n\ndpwgrab32 Same as tdpwgrab32\n\npwgrab32 Same as tdpwgrab32\n\npwgrabb32 Same as tdpwgrab32\n\nsokinjectDll32 Same as injectDll32\n\ntinjectDll32 Same as injectDll32\n\ntotinjectDll32 Same as injectDll32\n\nmexecDll32 Same as aexecDll32\n\nnetworknewDll32 Same as networkDll32\n\nsocksDll32 Same as NewBCtestnDll32\n\noimportDll32 Same as importDll32\n\nonixDll32 Same as aexecDll32\n\npwgrab32 Same as dpwgrab32\n\npwgrabb32 Same as dpwgrab32\n\nshadnewDll32 Same as anubisDll32\n\nsocksDll32 Same as NewBCtestnDll32\n\nsokinjectDll32 Same as injectDll32\n\nstabDll32 Same as tabDll32\n\ntabtinDll32 Same as tabDll32\n\ntesttabDll32 Same as tabDll32\n\nttabDll32 Previous modification of tabDll32\n\ntimportDll32 Same as importDll32\n\ntinjectDll32 Same as injectDll32\n\n\n-----\n\ntnetworkDll32 Same as networkDll32\n\ntotinjectDll32 Same as injectDll32\n\ntpwgrab32 Same as dpwgrab32\n\ntrdpscanDll32 Same as rdpscanDll32\n\ntshareDll32 Same as shareDll32\n\nttabDll32 Same as tabDll32\n\ntvncDll32 Same as bvncDll32\n\nTwoBCtestDll32 Same as bcClientDll32\n\ntwormDll32 Same as wormDll32\n\nwormwinDll32 Same as wormDll32\n\nvncDll32 Same as bvncDll32\n\n## Geography of Trickbot attacks\n\n_[(download)](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2021/10/18152151/01-en-trickbot-map.png)_\n\nWe analyzed Trickbot detections that occurred between January 2021 and early October\n2021. Most of the affected users were located in the USA (13.21%), Australia (10.25%) and\nChina (9.77%), followed by Mexico (6.61%) and France (6.30%).\n\n## Indicators of compromise (Trickbot C2 servers)\n\n[185.56.175[.]122](https://opentip.kaspersky.com/185.56.175.122/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [117.222.61[.]115](https://opentip.kaspersky.com/117.222.61.115/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [202.65.119[.]162](https://opentip.kaspersky.com/202.65.119.162/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [185.234.72[.]84](https://opentip.kaspersky.com/185.234.72.84/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[46.99.175[.]217](https://opentip.kaspersky.com/46.99.175.217/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [117.222.57[.]92](https://opentip.kaspersky.com/117.222.57.92/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [202.9.121[.]143](https://opentip.kaspersky.com/202.9.121.143/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [45.155.173[.]242](https://opentip.kaspersky.com/45.155.173.242/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[179.189.229[.]254](https://opentip.kaspersky.com/179.189.229.254/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [136.228.128[.]21](https://opentip.kaspersky.com/136.228.128.21/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [139.255.65[.]170](https://opentip.kaspersky.com/139.255.65.170/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [51.89.115[.]121](https://opentip.kaspersky.com/51.89.115.121/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[181.129.167[.]82](https://opentip.kaspersky.com/181.129.167.82/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [103.47.170[.]130](https://opentip.kaspersky.com/103.47.170.130/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [103.146.232[.]154](https://opentip.kaspersky.com/103.146.232.154/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [194.190.18[.]122](https://opentip.kaspersky.com/194.190.18.122/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[128.201.76[.]252](https://opentip.kaspersky.com/128.201.76.252/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [36.91.186[.]235](https://opentip.kaspersky.com/36.91.186.235/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [36.91.88[.]164](https://opentip.kaspersky.com/36.91.88.164/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [186.4.193[.]75](https://opentip.kaspersky.com/186.4.193.75/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[24.162.214[.]166](https://opentip.kaspersky.com/24.162.214.166/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [103.194.88[.]4](https://opentip.kaspersky.com/103.194.88.4/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [103.47.170[.]131](https://opentip.kaspersky.com/103.47.170.131/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [36.91.117[.]231](https://opentip.kaspersky.com/36.91.117.231/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[45.36.99[.]184](https://opentip.kaspersky.com/45.36.99.184/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [116.206.153[.]212](https://opentip.kaspersky.com/116.206.153.212/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [122.117.90[.]133](https://opentip.kaspersky.com/122.117.90.133/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [36.89.228[.]201](https://opentip.kaspersky.com/36.89.228.201/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[97.83.40[.]67](https://opentip.kaspersky.com/97.83.40.67/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [58.97.72[.]83](https://opentip.kaspersky.com/58.97.72.83/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [103.9.188[.]78](https://opentip.kaspersky.com/103.9.188.78/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [103.75.32[.]173](https://opentip.kaspersky.com/103.75.32.173/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[184.74.99[.]214](https://opentip.kaspersky.com/184.74.99.214/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [139.255.6[.]2](https://opentip.kaspersky.com/139.255.6.2/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [210.2.149[.]202](https://opentip.kaspersky.com/210.2.149.202/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [36.95.23[.]89](https://opentip.kaspersky.com/36.95.23.89/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n\n-----\n\n[62.99.76[.]213](https://opentip.kaspersky.com/62.99.76.213/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [45.115.172[.]105](https://opentip.kaspersky.com/45.115.172.105/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [118.91.190[.]42](https://opentip.kaspersky.com/118.91.190.42/?utm_source=SL&utm_medium=SL&utm_campaign=SL) [103.123.86[.]104](https://opentip.kaspersky.com/103.123.86.104/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[Financial malware](https://securelist.com/tag/financial-malware/)\n[Malware](https://securelist.com/tag/malware/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Malware Statistics](https://securelist.com/tag/malware-statistics/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[Trickbot](https://securelist.com/tag/trickbot/)\n[Trojan Banker](https://securelist.com/tag/trojan-banker/)\n\nAuthors\n\nOleg Kupreev\n\nTrickbot module descriptions\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-19 - Trickbot module descriptions.pdf"
    ],
    "report_names": [
        "2021-10-19 - Trickbot module descriptions.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536173,
    "ts_updated_at": 1743041126,
    "ts_creation_date": 1653713343,
    "ts_modification_date": 1653713343,
    "files": {
        "pdf": "https://archive.orkl.eu/611a4f0eda92369a09ee6045b5c5722e0d7651f0.pdf",
        "text": "https://archive.orkl.eu/611a4f0eda92369a09ee6045b5c5722e0d7651f0.txt",
        "img": "https://archive.orkl.eu/611a4f0eda92369a09ee6045b5c5722e0d7651f0.jpg"
    }
}