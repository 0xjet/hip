{
    "id": "e7a992a6-4345-4423-be33-49ca5453a1ab",
    "created_at": "2022-10-25T16:48:11.128293Z",
    "updated_at": "2025-03-27T02:16:26.401614Z",
    "deleted_at": null,
    "sha1_hash": "19bcbebb8dfd7742dd92603a63b0d655dfc5efa7",
    "title": "",
    "authors": "",
    "file_creation_date": "2013-01-25T19:57:09Z",
    "file_modification_date": "2013-01-25T19:57:09Z",
    "file_size": 770725,
    "plain_text": "# Practical Attacks against Mobile Device Management (MDM)\n\n##### Daniel Brodie, Sr. Security Researcher, Lacoon Mobile Security\n\n### Introduction \nMobile Device Management (MDM) solutions are perceived to be the ultimate solution for mobile\nsecurity in the enterprise. According to Gartner Inc’s October 2012 report: “Over the next five years,\n65% of enterprises will adopt a mobile device management (MDM) solution for their corporate liable\nusers”.\n\nBut do MDM solutions really provide the security that corporations are looking for?\n\nIn this whitepaper, we show how spyphones - surveillance tools surreptitiously planted on a user’s\nhandheld device – are able to circumvent common MDM security offerings, such as secure containers.\n\n### A Short Primer to MDMs and Secure Containers\n\n#### Mobile Device Management (MDM)\nAs their names imply, MDMs are mobile policy and configuration management tools. With the rise of\nconsumer-owned and –enabled mobile devices in the enterprise (aka BYOD), organizations have\nrecognized the challenge of establishing and enforcing a standard policy to help them manage the influx\nof these devices. MDM addresses these needs by providing management across four different layers:\n\n        - **Software management. Manages mobile applications, content and operating systems,**\nincluding:\n\n           - Provisioning and configuration\n\n           - Updates, patches and fixes\n\n           - Authorized software monitoring\n\n           - Backup/restore procedures\n\n        - **Network service management. Gains network-device information such as location, usage and**\ncellular/ WiFi, in order to support:\n\n           - Provisioning\n\n           - Billing\n\n           - Help desk/ support\n\n        - **Hardware management. Manages the physical device components, including:**\n\n           - Provisioning\n\n           - Inventory\n\n           - Activation/ Deactivation\n\n**Lacoon Security LTD | 1 Bezalel St., Ramat Gan 5252101, Israel | +972-3-3730358| info@lacoonsecurity.com** | www.lacoonsecurity.com\n\n\n-----\n\n           - Performance\n\n        - **Security management. Enforcement of security policies, including:**\n\n           - Remote wipe\n\n           - Remote lock\n\n           - Secure configuration enforcement\n\n           - Encryption\n\n#### Secure Containers\nSecure containers separate between business and personal data on the mobile and prevent business\ncritical data from leaking out to unauthorized individuals. This is done by encrypting the data on the\nphone and providing additional data security features, such as copy-paste DLP. A common scenario for\nsecure containers is to enable companies to perform a “remote-wipe” only on an ex-employee’s\nbusiness data, rather than removing all mobile data. Thus relieving the anguish (and possibly, also the\nlegal ramifications) of deleting the employee’s personal photographs as well.\n\nPopular MDM tools offered with the additional layer of a secure container include: MobileIron,\nAirWatch, FiberLink, Zenprise and Good Technologies.\n\n**How do secure containers work?**\nThe secure container runs in the mobile’s OS supplied sandbox, where the separation between business\nand personal data is implemented through encryption. All business data in the container is encrypted.\nIn addition, all communications with enterprise assets such as the Exchange Server and cloud-based\ncorporate apps, are performed under SSL encryption.\n\nIn particular, for iOS, Apple provides additional APIs for MDM solutions which are unavailable to regular\niOS apps. These may be used to retrieve information and manage policies. However, the MDM solutions\nare still restricted in their enforcement capabilities.\n\n### The Mobile Threatscape\nLooking at the mobile threat landscape, there are two separate categories of malicious mobile\napplications:\n\n1. **Mass Mobile Malicious Apps. These are consumer-oriented malicious applications with the**\n\nobvious financial motivation. Examples of such malicious apps include apps that monetize on\npremium text, dialers, SMS spammers, and mobile banking trojans.\nThese types of applications are not considered too sophisticated. Typically, the malware\ndeveloper places the malicious tool on Google Play – or other third party application market – in\nhopes of reaching as many downloads as possible. Further, as a consumer-focused mass\nmalware, a device infected with one of these apps does not have much impact on an\norganization.\n\n**Lacoon Security LTD | 1 Bezalel St., Ramat Gan 5252101, Israel | +972-3-3730358| info@lacoonsecurity.com** | www.lacoonsecurity.com\n\n\n-----\n\n2. **Targeted Mobile Attacks, aka Spyphones. These are mobile surveillance software installed on**\n\nparticular individuals. Once installed, spyphones are privy to all data on the mobile, as well as to\nall communication passed on the device.\nAs opposed to the mass malware apps, spyphones are installed on a per-device basis.\nAccordingly, attackers invest heavily in discovering, creating and developing new techniques to\ninstall and hide spyphones on the user’s device.\nThis type of malicious software is used to target the organization, with the goal of cyberespionage. As such, the impact of such an attack on the organization is extremely high – from\ngaining access to corporate emails and exfiltrating memos discussing the company’s roadmap,\nto recordings of confidential phone calls and board meetings.\nSpyphones are not used only against high-end targets. Private individuals have been known too\nto be victims of spyphones - for example, in the case of cheating spouses.\n\n#### Spyphone Capabilities\nMost spyphones provide, at a minimum, the following capabilities which may prove to be costly to the\nbusiness:\n\n        - **Eavesdropping and surround recording. Examples: listening in real time on customer calls and**\nrecordings of board meetings.\n\n        - **Extracting call and text logs. Examples: text messages which contain board meetings follow-ups**\nand voice memos.\n\n        - **Tracking location. Examples: tracking the location of executives at key accounts meetings.**\n\n        - **Snooping on corporate emails and application data. Examples: retrieving corporate emails**\nregarding upcoming M&A activity.\n\n#### The Range of Spyphones\nLacoon’s Mobile Threat Intelligence (MoTI) arm identified more than 50 families of spyphones. These\nspyphones run the gamut from dedicated high-end groups targeting specific nations and corporations,\nto low-end software targeting the private consumers.\n\nPublicized examples of spyphones from the high-end of the spectrum include:\n\n         - FinSpy, by The Gamma Group (August 2012) [http://bits.blogs.nytimes.com/2012/08/13/elusive-finspy-spyware-pops-up-in-10-countries/](http://bits.blogs.nytimes.com/2012/08/13/elusive-finspy-spyware-pops-up-in-10-countries/)\n\n         - DaVinci Remote Control System (RCS), by the Hacking Team (July 2012) [http://www.cso.com.au/article/431882/_crisis_os_x_trojan_made_by_lawful_intercept_ve](http://www.cso.com.au/article/431882/_crisis_os_x_trojan_made_by_lawful_intercept_vendor_hackingteam/)\n[ndor_hackingteam/](http://www.cso.com.au/article/431882/_crisis_os_x_trojan_made_by_lawful_intercept_vendor_hackingteam/)\n\n         - LuckyCat (July 2012) [http://www.darkreading.com/mobile-security/167901113/security/attacks-](http://www.darkreading.com/mobile-security/167901113/security/attacks-breaches/240004623/luckycat-apt-campaign-building-android-malware.html)\n[breaches/240004623/luckycat-apt-campaign-building-android-malware.html](http://www.darkreading.com/mobile-security/167901113/security/attacks-breaches/240004623/luckycat-apt-campaign-building-android-malware.html)\n\n         - Red October’s mobile component (January 2013) \n**Lacoon Security LTD | 1 Bezalel St., Ramat Gan 5252101, Israel | +972-3-3730358| info@lacoonsecurity.com** | www.lacoonsecurity.com\n\n\n-----\n\n[https://threatpost.com/en_us/blogs/rocra-espionage-malware-campaign-uncovered-after-](https://threatpost.com/en_us/blogs/rocra-espionage-malware-campaign-uncovered-after-five-years-activity-011413)\n[five-years-activity-011413](https://threatpost.com/en_us/blogs/rocra-espionage-malware-campaign-uncovered-after-five-years-activity-011413)\n\nAt the lower end of the spectrum are spyphones which most commonly portray themselves as\npromoting parental controls and spouse monitoring. The operators of these spyphones follow a SaaS\nbusiness model where the exfiltrated data is stored and managed as a dedicated cloud service. Similarly\nto a well-run business, the operators of these tools promise professional world-wide support. Their GUI\nis simple and user-friendly to enable all users – from the tech-savvy to the technologically impaired – to\nrun their service.\n\nThe difference between the military and non-military grade spyphones? The device infection vectors\nand accordingly, their cost. Current estimates hold nation-targeted spyphones at $350K[1]. In the\nmeanwhile, the commoners-targeted spyphones follow a monthly low licensing model– sometimes as\nlow as $4.99.\nThe amazing part is that the end-result is essentially the same on the targeted devices. So for just a bit\nmore than the price of a Starbucks latte, an attacker can purchase a spyphone with nearly identical\ncapabilities to that of a top-end spyphone.\n\n#### Spyphones in the Wild\nTo paint a better picture of how common spyphones are in the wild, Lacoon Mobile Security partnered\nwith global cellular network providers to sample 250,000 subscribers. Sampling was performed on two\nseparate occasions. The first was conducted during March 2012 and the second in late October 2012.\n\nIt is important to note that these samplings were done on a statistically diverse group of cellular\nnetwork users and that there was nothing to suggest a higher usage of spyphones than the usual.\n\nThis type of monitoring provided real-time insights on the infection rates of the different devices. In\naddition, it allowed the content inspection of the communications to the C&C servers and the analysis of\nthe data that the attackers gathered from users’ mobile devices.\n\n**Survey Findings**\n\n        - **Infection Rates.**\nThe first sampling showed that 1 of 3000 devices had a spyphone installed.\nIn the second sampling, 1 in 1000 devices were infected with a spyphone.\n\n        - **Spyphone distribution by OS:**\nIn the first sampling – with 48 compromised devices- an overwhelming 74% of infected devices\nwere iOS-enabled.\nThe second sampling showed that 52% of 175 compromised devices were attributed to iOS\ndevices.\n\n1 http://bits.blogs.nytimes.com/2012/08/13/elusive-finspy-spyware-pops-up-in-10-countries/\n\n**Lacoon Security LTD | 1 Bezalel St., Ramat Gan 5252101, Israel | +972-3-3730358| info@lacoonsecurity.com** | www.lacoonsecurity.com\n\n\n-----\n\nThe following figure shows the OS distribution amongst the different compromised mobile\ndevices witnessed during the second sampling:\n\n\n## Distribution of Infected Mobile Devices\n\nOther\n\n6%\n\nNokia\n\n7%\n\niPhone\n\n51%\n\nAndroid\n\n35%\n\niPod Touch 3g\n\n1%\n\n\nOther\n\n6%\n\nNokia\n\n7%\n\niPhone\n\n51%\n\nAndroid\n\n35%\n\n\n### Myth-Busting the Security of Secure Containers\nSecure containers may rely on different defense mechanisms to protect the corporate data:\n\n        - Detection of JailBreaking (iOS) and Root (Android) devices.\n\n        - Prevention of the installation of applications from third-party markets in order to protect\nagainst malware.\n\n        - Encryption of data\n\n        - The built-in Mobile OS Sandbox component\n\nHowever, these measures can be easily bypassed:\n\n        - **There’s a huge Internet community involved in JailBreaking/ Rooting efforts. A quick Google[2]**\nsearch will retrieve not only hacker-oriented details, but also step-by-step guidelines[3] for the\nlayman on JailBreaking the device.\n\n        - **The JailBreaking/Rooting detection mechanisms are quite restricted. Usually, checks are**\nperformed only against the features which signify a JailBroken/Rooted device. For example, it\n\n2 http://www.cultofmac.com/177385/why-i-love-my-jailbroken-iphone/\n3 http://www.gizmag.com/how-jailbreak-ios-6-cydia-iphone-4-ipod-touch-4g/24552/\n\n**Lacoon Security LTD | 1 Bezalel St., Ramat Gan 5252101, Israel | +972-3-3730358| info@lacoonsecurity.com** | www.lacoonsecurity.com\n\n\n-----\n\nwill check whether Cydia – an iOS app which allows the downloading of third party applications\n– is installed, or SU – the tool used by Android to allow privileged operations. More importantly,\nthere are no detection mechanisms for exploitation. So even if the secure container recognizes a\nJailBroken/Rooted device, there are no techniques to detect the actual privilege escalation.\n\n        - **Android, for example, attempts to prevent malicious app installation. However, these**\nmeasures are placed with mass malware in mind. Furthermore, third party application\nrestrictions should protect against malware. As a security mechanism, this has previously been\nproved to be defeated[4].\n\n#### Behind the Scenes: Bypassing the Secure Container\nIn the following sections we present proof of concepts for bypassing the secure container – both for\nAndroid, and for iOS-based devices.\n\n**Android-based devices**\nA spyphone targeting Android-based devices can work in the following manner:\n\n1. As demonstrated in BlackHat Vegas 2012, the attacker creates a “two-stage” application which\n\nbypasses the market’s malicious app identification measures (e.g. Bouncer). By using the “twostage”, the attacker can publish a seemingly innocent application. Once the victim installs the\napp, the app refers to the malicious code which is then downloaded.\n2. The app exploits a mobile OS vulnerability which allows for privilege escalation. For example, the\n\nrecent vulnerability in the Exynos[5] chipset in the drivers used by the camera and multimedia\ndevices.\n3. The spyphone creates a hidden ‘suid’ binary and uses it for privileged operations, such as\n\nreading the mobile logs (discussed in the next step). The file is placed in an execute-only\ndirectory (i.e. --x--x--x), which allows it to remain hidden from most root detectors.\n4. The spyphone listens to events in the ‘adb’ logs. These logs, and their corresponding access\n\npermissions, differ between Android versions. For versions 2.3 or less, it’s possible to simply use\nthe logging permissions. For Android version 4.0 and higher, root permissions are required in\norder to view the logs.\n5. The spyphone waits for a log event that signifies that the user is reading an email:\n\n4 Black Hat Vegas 2012: Adventures in BouncerLand - http://media.blackhat.com/bh-us12/Briefings/Percoco/BH_US_12_Percoco_Adventures_in_Bouncerland_WP.pdf\n5 http://www.securityweek.com/samsung-patch-vulnerable-exynos-powered-devices\n\n**Lacoon Security LTD | 1 Bezalel St., Ramat Gan 5252101, Israel | +972-3-3730358| info@lacoonsecurity.com** | www.lacoonsecurity.com\n\n\n-----\n\n6. The spyphone dumps the heap using /proc/<pid>/maps and /mem. Accordingly, it can find the\n\nemail structure, extract it and send it home.\n\n**iOS-based devices**\nA spyphone targeting iOS-based devices generally needs to first Jailbreak the device, and then installs\nthe container-bypassing software.\n\n1. The attacker installs a signed application on the targeted device, through the Enterprise/\n\nDeveloper certificate.\n2. The attacker uses a Jailbreak exploit in order to inject code into the secure container. We use\n\nthe standard DYLD_INSERT_LIBRARIES technique to insert our libraries into the shared memory.\nIn this manner, our (signed) dylib will be loaded into memory when the secure container\nexecutes.\n3. The attacker removes any trace of the Jailbreak.\n4. The spyphone places hooks into the secure container using standard Objective-C hooking\n\nmechanisms.\n5. The spyphone is alerted when an email is read and pulls the email from the UI elements of the\n\napp.\n6. Finally, the spyphone sends every email loaded to the spyphone’s C&C server\n\n### Conclusions\nThe underlying notion of the secure container is that they depend on the integrity of the host system.\nThis encourages us to deliberate the added value of the secure container:\n\n        - If the host system is uncompromised, what is the added value?\n\n        - If the host system is compromised, what is the added value?\n\nSince the security of these secure containers is dependent on the integrity of the host system, it is\nenough for the attacker to target the host system.\n\nIn fact, we have been through this movie before. Desktop applications which have attempted to secure\nthemselves, were targeted through the underlying OS. Although mobile OSes attempt to circumvent\n\n**Lacoon Security LTD | 1 Bezalel St., Ramat Gan 5252101, Israel | +972-3-3730358| info@lacoonsecurity.com** | www.lacoonsecurity.com\n\n\n-----\n\nsimilar attacks by blocking off the OS to attackers and users alike, common and ever increasing\nJailBreaking/Rooting methods are rendering this safety mechanism irrelevant to targeted attacks.\n\nIn a similar fashion, the lessons learnt from the desktop equivalent may be applied here. If today the\nsecurity industry understands that controls on devices themselves are not sufficient anymore to the\nreal-world, we can expect the same in the mobile world.\n\nIt is important to recognize that infection is inevitable. As demonstrated throughout this whitepaper,\nMDMs cannot provide absolute security. They are certainly a beneficial tool in order to separate\nbetween business and personal data. As such, MDMs should be used – but as part of a baseline for a\nmulti-layered approach. To quote from RSA’s Security for Business Innovation Council report, “Realizing\n_the Mobile Enterprise”, “Mitigating the effects of malware on corporate data, rather than trying to keep_\nmalware off a device entirely, may be a better strategy”. This approach requires thinking outside of the\nbox and the industry is now starting to wake up to this challenge and looking at the network level for\nthreat mitigation. For example, solutions can look at different network parameters and aberrant\nbehavior to signify an infected device. Parameters may be traffic to well-known C&C servers, heuristic\nbehavioral analysis which signify abnormal behavior, sequences of events and data intrusion detection.\n\n**Lacoon Security LTD | 1 Bezalel St., Ramat Gan 5252101, Israel | +972-3-3730358| info@lacoonsecurity.com** | www.lacoonsecurity.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://media.blackhat.com/eu-13/briefings/Brodie/bh-eu-13-lacoon-attacks-mdm-brodie-wp.pdf"
    ],
    "report_names": [
        "bh-eu-13-lacoon-attacks-mdm-brodie-wp.pdf"
    ],
    "threat_actors": [
        {
            "id": "1a651080-cb2f-49bb-87cb-b9c6f6f99ce9",
            "created_at": "2022-10-25T16:07:23.809467Z",
            "updated_at": "2025-03-27T02:02:09.988548Z",
            "deleted_at": null,
            "main_name": "Lucky Cat",
            "aliases": [],
            "source_name": "ETDA:Lucky Cat",
            "tools": [
                "Comfoo",
                "Comfoo RAT",
                "Lucky Cat",
                "LuckyCat",
                "Sojax",
                "Syndicasec",
                "WMI Ghost",
                "Wimmie"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9792e41f-4165-474b-99fa-e74ec332bd87",
            "created_at": "2023-01-06T13:46:38.986789Z",
            "updated_at": "2025-03-27T02:00:02.970288Z",
            "deleted_at": null,
            "main_name": "Lucky Cat",
            "aliases": [
                "White Dev 9",
                "TA413"
            ],
            "source_name": "MISPGALAXY:Lucky Cat",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1359143829,
    "ts_modification_date": 1359143829,
    "files": {
        "pdf": "https://archive.orkl.eu/19bcbebb8dfd7742dd92603a63b0d655dfc5efa7.pdf",
        "text": "https://archive.orkl.eu/19bcbebb8dfd7742dd92603a63b0d655dfc5efa7.txt",
        "img": "https://archive.orkl.eu/19bcbebb8dfd7742dd92603a63b0d655dfc5efa7.jpg"
    }
}