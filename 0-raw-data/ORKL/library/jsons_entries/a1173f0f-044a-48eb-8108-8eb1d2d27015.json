{
    "id": "a1173f0f-044a-48eb-8108-8eb1d2d27015",
    "created_at": "2023-01-12T15:09:29.28834Z",
    "updated_at": "2025-03-27T02:05:45.72661Z",
    "deleted_at": null,
    "sha1_hash": "00cabe07301355e33affbaa4bd39198e9fa8974a",
    "title": "2009-10-01 - Detecting ZeuS",
    "authors": "",
    "file_creation_date": "2022-05-28T00:28:54Z",
    "file_modification_date": "2022-05-28T00:28:54Z",
    "file_size": 254477,
    "plain_text": "# Detecting ZeuS | eternal-todo.com\n\n**eternal-todo.com/blog/detecting-zeus**\n\n[Home »](http://eternal-todo.com/) [Blog » Detecting ZeuS](http://eternal-todo.com/blog)\n\n## Detecting ZeuS\n\n[Botnet](http://eternal-todo.com/category/botnet)\n[Detection](http://eternal-todo.com/category/detection)\n[Malware](http://eternal-todo.com/category/malware)\n[ZeuS](http://eternal-todo.com/category/zeus)\n\n[In the S21sec blog we have been](http://blog.s21sec.com/2009/05/re-deuda-pendiente.html) [talking](http://securityblog.s21sec.com/2009/04/when-bot-master-goes-mad-kill-os.html) [some time ago about our dear friend, almost one](http://blog.s21sec.com/2009/01/nuevas-muestras-de-zeus.html)\nmore colleague: ZeuS. It is a malware with more than 3 years of life which continues\nchanging and evolving to hide itself better and making the fraud more efficient. But what\nwe maybe have not mentioned yet is how to know if our little friend is here, spying all our\nmovements and reporting all of this to its parents, because sometimes the AV software is\nnot so effective as we expect.\n\nThere are several evidences in its different versions which mean that we are infected with\nZeuS:\n\nFilesystem\nZeuS leaves a trace in the filesystem when it's installed in the computer, but it hides\nand blocks all the files it creates, avoiding that a normal user can see and delete\nthem. The solution to find these files is using antirootkit software which will show us\nthe hidden files.\n\n\n-----\n\nNowadays the usual binary name is sdra64.exe and its configuration directory\nc:\\windows\\system32\\lowsec, but this can change depending on the version. We\nalready mentioned the various names for the configuration files, so now I'll only\ncomment the different names for binary files:\n\nntos.exe\noembios.exe\ntwext.exe\ntwex.exe\nsdra64.exe\nbootlist32.exe\nuserinit32.exe\nbootwindows.exe\n\nWindows registry\nSearching the Windows registry is another way to detect the infection. The trojan is\nable to execute itself after each reboot thanks to the inclusion of the binary path in\nthe following registry entry:\n\nHKLM/SOFTWARE/Microsoft/WindowsNT/Winlogon@Userinit\n\nThus simply opening the registry editor (regedit.exe) we could locate our ZeuS:\n\nHooks\nZeuS needs to put several hooks in different functions in order to make the code\ninjection, intercept data, etc. We can find these hooks in most of the executed\nprocesses and the most common ones are the following:\n\nntdll.dll\n\nNtCreateThread\nLdrLoadDll\nLdrGetProcedureAddress\nNtQueryDirectoryFile\n\nuser32.dll\n\nGetClipboardData\nTranslateMessage\n\n\n-----\n\nTo know if we have these hooks in our system we must use an antirootkit program\ntoo:\n\nOnline banking strange behaviour\nWe can expect that people who use online banking on daily basis can notice some\nchange in the application like an extra field asking for the password needed to make\ntransactions or asking for all the positions of the coordinates card. This is what our\ntrojan makes. Perhaps it will be harder to detect for people who use it occasionally,\nso the solution here is to pay attention while doing online banking and talk with the\nbank if there is any suspicious behaviour. This is an example of a login page before\nand after of ZeuS injection:\n\nExtra parameters (server-side)\nUsually when ZeuS adds extra fields in the bank page through HTML injection these\nadditional parameters will be sent to the bank server where, depending on the\ninjected code, could be intercepted and being possible to warn the user of a possible\ninfection.\n\n\n-----\n\nTrojan mutexes\nFinally, we can detect the trojan in the system thanks to the mutexes that it creates.\nFor example, with the OpenMutex function we can check if the ZeuS mutexes exist\nor not, showing the malware trace in the system. Until the moment the mutexes we\nhave seen are:\n\n__SYSTEM__64AD0625__\n\n_H_64AD0625_\n\n_AVIRA_2109\n\n_LILO_1909\n\n_SOSI_1909\n\nSubmitted by jesparza on Thu, 2009/10/01 - 12:25\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2003 - 2009/2009-10-01 - Detecting ZeuS.pdf"
    ],
    "report_names": [
        "2009-10-01 - Detecting ZeuS.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536169,
    "ts_updated_at": 1743041145,
    "ts_creation_date": 1653697734,
    "ts_modification_date": 1653697734,
    "files": {
        "pdf": "https://archive.orkl.eu/00cabe07301355e33affbaa4bd39198e9fa8974a.pdf",
        "text": "https://archive.orkl.eu/00cabe07301355e33affbaa4bd39198e9fa8974a.txt",
        "img": "https://archive.orkl.eu/00cabe07301355e33affbaa4bd39198e9fa8974a.jpg"
    }
}