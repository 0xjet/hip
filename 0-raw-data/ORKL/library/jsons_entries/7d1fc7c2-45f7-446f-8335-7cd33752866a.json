{
    "id": "7d1fc7c2-45f7-446f-8335-7cd33752866a",
    "created_at": "2023-01-12T15:04:22.640475Z",
    "updated_at": "2025-03-27T02:09:17.796343Z",
    "deleted_at": null,
    "sha1_hash": "5c1426f87d1d3d6c1d1585213830820dac535919",
    "title": "2022-08-25 - BlueSky Ransomware - AD Lateral Movement, Evasion and Fast Encryption Put Threat on the Radar",
    "authors": "",
    "file_creation_date": "2022-09-01T10:28:51Z",
    "file_modification_date": "2022-09-01T10:28:51Z",
    "file_size": 1225365,
    "plain_text": "# BlueSky Ransomware | AD Lateral Movement, Evasion and Fast Encryption Put Threat on the Radar\n\n**[sentinelone.com/blog/bluesky-ransomware-ad-lateral-movement-evasion-and-fast-encryption-puts-threat-on-the-radar/](https://www.sentinelone.com/blog/bluesky-ransomware-ad-lateral-movement-evasion-and-fast-encryption-puts-threat-on-the-radar/)**\n\nAugust 25, 2022\n\nBlueSky ransomware is an emerging threat that researchers have been paying increasing\nattention to since its initial discovery in late June 2022. The ransomware has been observed\nbeing spread via trojanized downloads from questionable websites as well as in phishing\nemails.\n\nAlthough infections at this time remain low, the ransomware‚Äôs characteristics, described\nbelow, suggest it has been carefully developed for a sustained campaign. In this post, we\ncover the latest intelligence on BlueSky ransomware to help security teams defend against\nthis developing threat.\n\n\n-----\n\n## Emergence of BlueSky Ransomware\n\n[BlueSky was first noted on VirusTotal by researcher @Kangxiaopao in late June 2022.](https://twitter.com/Kangxiaopao/status/1541627210611978240?s=20&t=u6j7vK9Xtpt8yy1Z3yxKew)\nSubsequently, analysts from [CloudSek and](https://cloudsek.com/threatintelligence/tracking-the-operators-of-the-newly-emerged-bluesky-ransomware/) [Unit42 have documented some of BlueSky‚Äôs](https://unit42.paloaltonetworks.com/bluesky-ransomware/)\nbehavior.\n\nAt present, BlueSky has not stood up a public data leak site and BTC wallets associated with\nknown samples have not registered any transactions, indicating that the threat actor‚Äôs\ndistribution campaign is still in its infancy.\n\nInitial delivery vectors seen to date include trojanized downloads from websites hosting\n‚Äúcracks‚Äù and ‚Äúkeygens‚Äù as well as malicious attachments delivered via email. Some observed\n[mechanisms include delivery via third-party frameworks such as Cobalt Strike and BRc4.](https://www.sentinelone.com/labs/lockbit-ransomware-side-loads-cobalt-strike-beacon-with-legitimate-vmware-utility/)\n\nUpon infection, BlueSky uses fast encryption techniques to rapidly process files on the target\nand connected hosts. The ransomware has the ability to move laterally via SMB and has\n[been observed doing so in Active Directory environments. Encrypted files will be marked with](https://www.sentinelone.com/blog/top-10-ways-to-protect-your-active-directory/)\nthe `.bluesky extension. Victims are instructed to contact the attackers via a TOR-based`\nportal to obtain a decrypter.\n\n\n-----\n\n[A multi-stage attack leading to a BlueSky infection was documented by Germ√°n Fern√°ndez](https://twitter.com/1ZRR4H/status/1543339315756994563?s=20&t=9PTi8w_D3cEiSVvEcwP4Fg)\nin early July.\n\n[Interesting, cracks/activators site distributes Powershell that installs #RemcosRAT (C2:](https://twitter.com/hashtag/RemcosRAT?src=hash&ref_src=twsrc%5Etfw)\n80.66.75.88:2807).\n\nDepending on environment and privileges it also executes:\n\n‚Äì JuicyPotato ‚Üì\n\n‚Äì CVE-2022-21882 ‚Üì\n\n[‚Äì CVE-2020-0796 aka #SMBGhost ‚Üì](https://twitter.com/hashtag/SMBGhost?src=hash&ref_src=twsrc%5Etfw)\n\n‚Äì [#BlueSky Ransomware üí•](https://twitter.com/hashtag/BlueSky?src=hash&ref_src=twsrc%5Etfw)\n\n1/X [pic.twitter.com/9DKzWi3dD3](https://t.co/9DKzWi3dD3)\n\n[‚Äî Germ√°n Fern√°ndez (@1ZRR4H) July 2, 2022](https://twitter.com/1ZRR4H/status/1543339315756994563?ref_src=twsrc%5Etfw)\n\n[Fern√°ndez tweeted details around an infection chain that, depending on the client,](https://twitter.com/1ZRR4H/status/1543339315756994563?s=20&t=9PTi8w_D3cEiSVvEcwP4Fg)\n[resembles JuicyPotato, exploiting an elevation of privilege flaw (CVE-2022-21882) in](https://www.sentinelone.com/labs/relaying-potatoes-another-unexpected-privilege-escalation-vulnerability-in-windows-rpc-protocol/)\nMicrosoft Windows and a remote code execution vulnerability (CVE-2020-0796) in Microsoft\nServer Message Block (SMB), before dropping the BlueSky ransomware.\n\nThe use of trojanized downloads was documented by CloudSEK. Trojanized downloads of\nBlueSky ransomware were briefly made available via a website known to host questionable\nexecutables such as application ‚Äúcracks‚Äù and ‚Äúkeygens‚Äù, license generators for software\nproducts such as Windows 10.\n\n\n-----\n\nMalicious Site Hosting BlueSky Payloads\nOne such site was observed being hosted at `kmsauto[.]us . The following list of malicious`\nURLs were recorded as hosting BlueSky ransomware payloads. Note the redundant use of\nboth HTTP and HTTPS.\n```\nhttp[:]//kmsauto[.]us/alguien/l.exe\n\nhttp[:]//kmsauto[.]us/alguien/potato.exe\n\nhttp[:]//kmsauto[.]us/alguien/spooler.exe\n\nhttp[:]//kmsauto[.]us/off/off.bin\n\nhttp[:]//kmsauto[.]us/someone/ghost.exe\n\nhttp[:]//kmsauto[.]us/someone/I.exe\n\nhttp[:]//kmsauto[.]us/someone/potato.exe\n\nhttp[:]//kmsauto[.]us/sti/sti.bin\n\nhttps[:]//kmsauto[.]us/alguien/l.exe\n\nhttps[:]//kmsauto[.]us/alguien/spooler.exe\n\nhttps[:]//kmsauto[.]us/ekonomika/\n\nhttps[:]//kmsauto[.]us/someone/l.exe\n\nhttps[:]//kmsauto[.]us/someone/potato.exe\n\nhttps[:]//kmsauto[.]us/someone/start.ps1\n\nhttps[:]//kmsauto[.]us/v-mire/\n\n\n## BlueSky Ransomware Technical Details\n\n```\n[The first stage of a BlueSky ransomware infection involves a compressed, base64-encoded](https://www.sentinelone.com/blog/guide-encode-decoded-base64/)\nPowerShell script, `start.ps1 . On execution, the script produces a further PowerShell`\nscript, `stage.ps1 . If` `stage.ps1 is run without administrator privileges, it first seeks to`\nelevate privileges through CVE-2021-1732 or CVE-2022-21882.\n\nEncrypted content of start.ps1\n\n\n-----\n\nOnce sufficient privileges are acquired, the script downloads the ransomware payload,\n```\nl.exe, and writes it to disk at the following file path:\n%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\javaw.exe.\n\n\n```\n[The payload contains anti-analysis logic including leveraging NtSetInformationThread to hide](https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/ntifs/nf-ntifs-ntsetinformationthread)\nthreads launched by the malware executable.\n\nSetting `ThreadInformationClass to the value of 0x11 prevents certain events from being`\nviewed or hooked by debuggers, or from being detected by certain EDR hooking\nmechanisms. As noted by Unit32, BlueSky uses a multithreaded queue for faster encryption.\n\nThe ransomware makes use of the `NtQueryInformationProcess API for process`\ndiscovery before calling `TerminateProcess .`\n\nLocal drives are discovered and stored via `GetLogicalDriveStringsW, with the`\nransomware traversing each drive serially.\n\n[BlueSky‚Äôs ability to spread laterally across accessible networks is enabled by way of SMB](https://attack.mitre.org/techniques/T1021/002/)\n(Server Message Block) and the `NetShareEnum (+WNetOpenEnumW) API.`\n\nPayload output, NetShareEnum\nIn some cases, 1000ms Sleep intervals are inserted between each remote connection\nattempt.\n\n\n-----\n\nSleep MS count in hex\n[Previous researchers have noted that file targeting is inverted compared to typical](https://unit42.paloaltonetworks.com/bluesky-ransomware/#post-124417-_kkllbv828k78)\nransomware behavior: rather than targeting specific file extensions, BlueSky instead lists file\ntypes to be excluded from encryption. The following extensions are reportedly excluded:\n```\nldf, scr, icl, 386, cmd, ani, adv, theme, msi, rtp, diagcfg, msstyles, bin, hlp, shs,\ndrv, wpx, bat, rom, msc, lnk, cab, spl, ps1, msu, ics, key, msp, com, sys, diagpkg,\nnls, diagcab, ico, lock, ocx, mpa, cur, cpl, mod, hta, exe, ini, icns, prf, dll,\nbluesky, nomedia, idx\n\n\n## Post-Infection and Ransom Demands\n\n```\nThe ransom note ‚Äú# DECRYPT FILES BLUESKY #.html ‚Äù is written into each folder\ncontaining encrypted items. With the exception of the victim‚Äôs ‚Äòrecover ID‚Äô, all ransom notes\nregardless of the target are identical. In addition, the malware drops notes in both text and\nHTML format.\n\nBlueSky ransom note, .txt version\n\n\n-----\n\nBlueSky ransom note, html version\nAfter infection, victims are instructed to visit the BlueSky ‚ÄòDECRYPTOR‚Äô portal and enter the\nunique recovery ID embedded in the ransom note. The portal displays the time limit and the\nincreasing dollar amounts required to regain access to encrypted data.\n\n\n-----\n\nBlueSky Decryptor Portal\nIn the pool of samples we analyzed, victims were given seven days to pay the ransom\ndemand, after which the ransom amount doubled.\n\n## Detecting and Protecting Against BlueSky Ransomware\n\nAs demonstrated in the following video, SentinelOne Singularity‚Ñ¢ fully protects against\nBlueSky ransomware, preventing lateral movement across Active Directory and connected\ndevices.\n\n\n-----\n\nWatch Video At:\n\nhttps://youtu.be/5EF6nZ9QAoQ\n\n## Conclusion\n\nBlueSky ransomware has the ability to rapidly encrypt the local host and move laterally by\nexploiting known vulnerabilities. BlueSky campaigns appear to be in their infancy, but the\narchitecture of both droppers and payloads indicates that the actors have invested significant\neffort and will be looking to reap the returns. Now is the time for security teams to get ahead\nby bolstering their protection and detection posture.\n\n## Indicators of Compromise\n\n**SHA256**\n\n3e035f2d7d30869ce53171ef5a0f761bfb9c14d94d9fe6da385e20b8d96dc2fb\n\n840af927adbfdeb7070e1cf73ed195cf48c8d5f35b6de12f58b73898d7056d3d\n\ne75717be1633b5e3602827dc3b5788ff691dd325b0eddd2d0d9ddcee29de364f\n\n2280898cb29faf1785e782596d8029cb471537ec38352e5c17cc263f1f52b8ef\n\nd6386b2747335f7b0d13b1f69d995944ad8e9b71e09b036dbc0b907e583d857a\n\nc75748dc544629a8a5d08c0d8ba7fda3508a3efdaed905ad800ffddbc8d3b8df\nc3d5248230230e33565c04019801892174a6e5d8f688d61002e369b0b9e441ff\n\nb5b105751a2bf965a6b78eeff100fe4c75282ad6f37f98b9adcd15d8c64283ec\n\ndcdba086e6d0cd3067d3998bb624be16c805b2cde76a451c0ceaf30d66ba7349 (decryptor)\n\n**SHA1**\n\nd8369cb0d8ccec95b2a49ba34aa7749b60998661\na306aa69d4ac0087c6dad1851c7f500710c829e3\n\n\n-----\n\n720714032a7a8ee72f034ddbb0578b910e6c9885\n1bab1913533d5748e9cda388f55c446be6b770ff\n\n71e3cc4a53a9cf4cb5e5c3998afe891cd78c09aa\n\n429237548351288fac00e0909616b1518d5487b9\n\n9fc631bdd0d05d750e343c802e132b56e5121243\n\n59e756e0da6a82a0f9046a3538d507c75eb95252\n\na9233cb65ab53a08a4cce24a134c5b9296672a32 (decryptor)\n\n**Connections**\n\nccpyeuptrlatb2piua4ukhnhi7lrxgerrcrj4p2b5uhbzqm2xgdjaqid[.]onion\n\nkmsauto[.]us\n\n**MITRE ATT&CK**\n\n[T1552.001 ‚Äì Unsecured Credentials: Credentials In Files](https://attack.mitre.org/techniques/T1552/001/)\n\n[T1049 ‚Äì System Network Connections Discovery](https://attack.mitre.org/techniques/T1049/)\n\n[T1422 ‚Äì System Network Configuration Discovery](https://attack.mitre.org/techniques/T1422/)\n\n[T1083 ‚Äì File and Directory Discovery](https://attack.mitre.org/techniques/T1083/)\n\n[T1012 ‚Äì Query Registry](https://attack.mitre.org/techniques/T1012/)\n\n[T1082 ‚Äì System Information Discovery](https://attack.mitre.org/techniques/T1082/)\n\n[T1119 ‚Äì Automated Collection](https://attack.mitre.org/techniques/T1119/)\n\n[T1005 ‚Äì Data from Local System](https://attack.mitre.org/techniques/T1005/)\n\n[T1486 ‚Äì Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486/)\n\n[T1135 ‚Äì Network Share Discovery](https://attack.mitre.org/techniques/T1135/)\n\n[T1021.002 ‚Äì Remote Services: SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002/)\n\n[T0809 ‚Äì Data Destruction](https://attack.mitre.org/techniques/T0809/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-25 - BlueSky Ransomware - AD Lateral Movement, Evasion and Fast Encryption Put Threat on the Radar.pdf"
    ],
    "report_names": [
        "2022-08-25 - BlueSky Ransomware - AD Lateral Movement, Evasion and Fast Encryption Put Threat on the Radar.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535862,
    "ts_updated_at": 1743041357,
    "ts_creation_date": 1662028131,
    "ts_modification_date": 1662028131,
    "files": {
        "pdf": "https://archive.orkl.eu/5c1426f87d1d3d6c1d1585213830820dac535919.pdf",
        "text": "https://archive.orkl.eu/5c1426f87d1d3d6c1d1585213830820dac535919.txt",
        "img": "https://archive.orkl.eu/5c1426f87d1d3d6c1d1585213830820dac535919.jpg"
    }
}