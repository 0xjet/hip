{
    "id": "c0f01651-46d3-419e-b4ca-7e8f2b1d6445",
    "created_at": "2023-01-12T15:08:22.579235Z",
    "updated_at": "2025-03-27T02:08:40.868268Z",
    "deleted_at": null,
    "sha1_hash": "1780cad198cbba188b05dddf42218c92d511a2cf",
    "title": "2017-09-25 - A simple example of a complex cyberattack",
    "authors": "",
    "file_creation_date": "2022-09-01T10:19:08Z",
    "file_modification_date": "2022-09-01T10:19:08Z",
    "file_size": 388179,
    "plain_text": "# A simple example of a complex cyberattack\n\n**[securelist.com/a-simple-example-of-a-complex-cyberattack/82636](https://securelist.com/a-simple-example-of-a-complex-cyberattack/82636)**\n\nAuthors\n\n[Vasily Berdnikov](https://securelist.com/author/vasilyberdnikov/)\n\n[Dmitry Karasovsky](https://securelist.com/author/dmitrykarasovsky/)\n\n[Alexey Shulmin](https://securelist.com/author/alexeyshulmin/)\n\n## How cyberspies achieve their goals by using cheap tools and careful aiming\n\n[We’re already used to the fact that complex cyberattacks use 0-day vulnerabilities,](https://encyclopedia.kaspersky.com/glossary/zero-day-exploit/?utm_source=securelist&utm_medium=blog&utm_campaign=termin-explanation)\nbypassing digital signature checks, virtual file systems, non-standard encryption algorithms\nand other tricks. Sometimes, however, all of this may be done in much simpler ways, as was\nthe case in the malicious campaign that we detected a while ago – we named it ‘Microcin’\nafter microini, one of the malicious components used in it.\n\n\n-----\n\n[We detected a suspicious RTF file. The document contained an exploit to the previously](https://encyclopedia.kaspersky.com/glossary/exploit/?utm_source=securelist&utm_medium=blog&utm_campaign=termin-explanation)\n[known and patched vulnerability CVE-2015-1641; however, its code had been modified](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1641)\nconsiderably. Remarkably, the malicious document was delivered via websites that targeted\na very narrow audience, so we suspected early on that we were dealing with a targeted\nattack. The threat actors took aim at users visiting forums with discussions on the statesubsidized housing that Russian military personnel and their families are entitled to.\n\nA forum post with a link to the malicious document\n\nThis approach appears to be very effective, as it substantially increases the chance that a\npotential victim will download and open the malicious document: the hosting forum is\nlegitimate, and the malicious document is named accordingly (“Housing acceptance\nprocedure” in Russian).\n\nAll links in the forum messages lead to the URL address files[.]maintr**plus[.]com, where the\nRTF document with the exploit was hosted. The threat actors sometimes used PPT files\n[containing an executable PE file which did not contain the exploit, as the payload was](https://encyclopedia.kaspersky.com/glossary/payload/?utm_source=securelist&utm_medium=blog)\nlaunched by a script embedded into the PPT file.\n\nIf a Microsoft Office vulnerability is successfully exploited, the exploit creates an executable\nPE file on the hard drive and launches it for execution. The malicious program is a platform\nused to deploy extra (add-on) malicious modules, store them stealthily and thus add new\ncapabilities for the threat actors. The attack unfolds in several stages, as described below:\n\n\n-----\n\n1. The exploit is activated, and an appropriate (32-bit or 64-bit) version of the malicious\n\nprogram is installed on the victim computer, depending on the type of operating system\ninstalled on it. To do this installation, malicious code is injected into the system process\n‘explorer.exe’ rather than into its memory. The malicious program has a modular\nstructure: its main body is stored in the registry, while its add-on modules are\ndownloaded following the instruction arriving from the C&C server. DLL hijacking (use\nof a modified system library) is used to ensure that the main module is launched each\ntime the system is rebooted.\n2. The main module of the malicious program receives an instruction to download and\n\nlaunch add-on modules, which opens new capabilities for the threat actors.\n3. The malicious add-on modules provide opportunities to control the victim system, take\n\nscreenshots of windows and intercept information entered from the keyboard. We have\nseen them in other cyber-espionage campaigns as well.\n4. The threat actors use PowerSploit, a modified set of PowerShell scripts, and various\n\nutilities to steal files and passwords found on the victim computer.\n\nThe cybercriminals were primarily interested in .doc, .ppt, .xls, .docx, .pptx, .xlsx, .pdf, .txt\nand .rtf files on the victim computers. The harvested files were packed into a passwordprotected archive and sent to the threat actors’ server.\n\nOverall, the tactics, techniques and procedures that the cybercriminals used in their attacks\ncan hardly be considered complicated or expensive. However, there were a few things that\ncaught our eye:\n\nThe payload (at least one of the modules) is delivered using some simple\nsteganography. Within traffic, it looks like a download of a regular JPEG image;\nhowever, the encrypted payload is loaded immediately after the image data. Microcin\nsearches for a special ‘ABCD’ label in such a file; it is followed by a special structure,\nafter which the payload comes, to be decrypted by Microcin. This way, new, platformindependent code and/or PE files can be delivered.\nIf the Microcin installer detects the processes of some anti-malware programs running\nin the system, then, during installation, it skips the step of injecting into ‘explorer.exe’,\nand the modified system library used for establishing the malicious program within the\nsystem is placed into the folder %WINDIR%; to do this, the system app ‘wusa.exe’ is\nused with the parameter “/extract” (on operating systems with UAC).\n\n## Conclusion\n\nNo fundamentally new technologies are used in this malicious campaign, be it 0-day\nvulnerabilities or innovations in invasion or camouflaging techniques. The threat actors’\ntoolkit includes the following:\n\nA watering hole attack with a Microsoft Office exploit;\n\n\n-----\n\nFileless storage of the main set of malicious functions (i.e., the shellcode) and the addon modules;\nInvasion into a system process without injecting code into its memory;\nDLL hijacking applied to a system process as a means of ensuring automatic launch\nthat does not leave any traces in the registry’s autorun keys.\n\nThe attackers also make use of PowerShell scripts that are used extensively in penetration\ntests. We have seen backdoors being used in different targeted attacks, while PowerSploit is\nan open-source project. However, cybercriminals can use known technologies as well to\nachieve their goals.\n\nThe most interesting part of this malicious campaign, in our view, is the attack vectors used\nin it. The organizations that are likely to find themselves on the cybercriminals’ target lists\noften do not pay any attention to these vectors.\n\nFirst, if your corporate infrastructure is well protected and therefore ‘expensive’ to attack (i.e.,\nan attack may require expensive 0-day exploits and other complicated tools), then the\nattackers will most likely attempt to attack your rank-and-file employees. This step follows a\nsimple logic: an employee’s personal IT resources (such as his/her computer or mobile\ndevice) may become the ‘door’ leading into your corporate perimeter without the need of\nlaunching a direct attack. Therefore, it is important for organizations to inform their\nemployees about the existing cyber threats and how they work.\n\nSecond, Microcin is just one out of a multitude of malicious campaigns that use tools and\nmethods that are difficult to detect using standard or even corporate-class security solutions.\nTherefore, we recommend that large corporations and government agencies use\ncomprehensive security solutions to protect against targeted attacks. These products are\ncapable of detecting an ongoing attack, even if it employs only a minimum of manifestly\nmalicious tools, as the attackers instead seek to use legal tools for penetration testing,\nremote control and other tasks.\n\nThe implementation of a comprehensive security system can substantially reduce the risk of\nthe organization falling victim to a targeted attack, even though it is still unknown at the time\nof the attack. There is no way around it; without proper protection, your secrets may be\nstolen, and information is often more valuable than the cost of its reliable protection.\n\n[For more details of this malicious attack, please read Attachment (PDF).](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07170759/Microcin_Technical_4PDF_eng_final_s.pdf)\n\n[DLL hijacking](https://securelist.com/tag/dll-hijacking/)\n[Dropper](https://securelist.com/tag/dropper/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[Microsoft Word](https://securelist.com/tag/microsoft-word/)\n[Phishing](https://securelist.com/tag/phishing/)\n[Social engineering](https://securelist.com/tag/social-engineering/)\n\n\n-----\n\n[Steganography](https://securelist.com/tag/steganography/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n[Vulnerabilities and exploits](https://securelist.com/tag/vulnerabilities-and-exploits/)\n[Watering hole attacks](https://securelist.com/tag/watering-hole-attacks/)\n\nAuthors\n\n[Vasily Berdnikov](https://securelist.com/author/vasilyberdnikov/)\n\n[Dmitry Karasovsky](https://securelist.com/author/dmitrykarasovsky/)\n\n[Alexey Shulmin](https://securelist.com/author/alexeyshulmin/)\n\nA simple example of a complex cyberattack\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-09-25 - A simple example of a complex cyberattack.pdf"
    ],
    "report_names": [
        "2017-09-25 - A simple example of a complex cyberattack.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "df9bfbf1-bb9d-492f-b381-95b9e1482267",
            "created_at": "2022-10-25T16:07:24.394491Z",
            "updated_at": "2025-03-27T02:02:10.207352Z",
            "deleted_at": null,
            "main_name": "Whitefly",
            "aliases": [
                "ATK 83",
                "Bronze Walker",
                "Mofang",
                "SectorM04",
                "TEMP.Mimic"
            ],
            "source_name": "ETDA:Whitefly",
            "tools": [
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Nibatad",
                "Shim RAT",
                "ShimRAT",
                "Vcrodat"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536102,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1662027548,
    "ts_modification_date": 1662027548,
    "files": {
        "pdf": "https://archive.orkl.eu/1780cad198cbba188b05dddf42218c92d511a2cf.pdf",
        "text": "https://archive.orkl.eu/1780cad198cbba188b05dddf42218c92d511a2cf.txt",
        "img": "https://archive.orkl.eu/1780cad198cbba188b05dddf42218c92d511a2cf.jpg"
    }
}