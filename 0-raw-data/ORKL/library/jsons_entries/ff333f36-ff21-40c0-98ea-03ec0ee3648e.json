{
    "id": "ff333f36-ff21-40c0-98ea-03ec0ee3648e",
    "created_at": "2023-01-12T15:01:46.99365Z",
    "updated_at": "2025-03-27T02:16:25.521164Z",
    "deleted_at": null,
    "sha1_hash": "ca56255c91d216d3089899264f4b387ceb30d5eb",
    "title": "2022-03-24 - Another cyber espionage campaign in the Russia-Ukrainian ongoing cyber attacks",
    "authors": "",
    "file_creation_date": "2022-05-28T01:19:54Z",
    "file_modification_date": "2022-05-28T01:19:54Z",
    "file_size": 5723992,
    "plain_text": "# Another cyber espionage campaign in the Russia-Ukrainian ongoing cyber attacks\n\n**[lab52.io/blog/another-cyber-espionage-campaign-in-the-russia-ukrainian-ongoing-cyber-attacks/](https://lab52.io/blog/another-cyber-espionage-campaign-in-the-russia-ukrainian-ongoing-cyber-attacks/)**\n\nFrom lab52, in connection to the latest events related to the Russia’s ongoing cyberattacks in Ukraine,\nbeyond destructive artifacts seen like Wipers and others, a new wave of malicious office documents\n(hereinafter maldocs) has been observed attempting to compromise systems leveraging a variant of\nwell-know and open-source malware known as Quasar RAT.\n\nRecently, we identified a maldoc named “Ukraine Conflict Update 16_0.doc” with a creation time 2022[03-16 and whose content appears to be retrieved directly from the Institute for the Study of War](http://www.understandingwar.org/)\nwebsite. Due to the creation time, the maldoc was generated with the latest information updated since\nthe most recent information published by this website is from March 23 (considering it at this point in\ntime).\n\nThe latest content of the Institute for the Study of War website, aligned with the current time we are\nwriting this post (2022-03-24), is shown below:\n\n\n-----\n\nBack to the maldoc analysis, it contains a VBA function that trigger the execution of a base64 encoded\nWindows PowerShell command:\n\nApplying de-obfuscating techniques, we finally rebuilt the PowerShell command and we found a HTTP\nGET request from a list of command-and-control servers with the main purpose of obtaining a\nWindows PE file from the C2 and execute it as a new process of Powershell.exe (PE file obtained\n\n\n-----\n\nfrom the C2 will be saved into the %TEMP% path and will be renamed as sarewfdsdfh.exe).\n\nTake a look at the highlighted domains, they will be commented later on.\n\nRelated to the C2 domains inside this sample, we have found an interesting list of other samples, with\nthe same subject matter that seems to be part of an ongoing campaing. One of them was a ZIP format\ncompressed file (“Ukraine Conflict Update 16_0.zip”) containing both a “.xlsm” and a “.docm” MS\nOffice documents with same naming. From what we can assume the initial attack vector goes through\na spear phishing email.\n\nBoth files have obfuscated VBA macros, which are responsible for building a script to deploy the\ninfection chain without containing any encoded PowerShell command.\n\n\n-----\n\nRebuilding the scripts by deobfuscating the VBA marcos has made it possible to trace what malicious\nactions are taken to infect the victim machine. As we can see below, both documents perform all the\nsame actions, sending a HTTP GET request to the C2 asking for a PE file named b29.exe.\n\nAfterwards, if the HTTP response from the command and control server (C2) was succeeded\n(response code = 200), the Windows PE file will be stored into the %TEMP% directory and later\nexecuted by the WINWORD.EXE process.\n\n\n-----\n\nRegarding network communication, the C2 is hosted on b29[.]bet, which resolves to an IP address\n(104.18.24[.]213) that belongs to Cloudflare.\n\nWith the next domain registrant information:\n\n\n-----\n\nSetting our sights on the recent & related artifacts downloaded from the C2, we identified, through the\nuri hxxp://b29[.]bet/SoftwareUpdate.exe, another related maldoc with an interesting topic:\n\nFrom the aforementioned URI we found a new malicious document contacting to the same C2. This\nmaldoc is named “Leaked_Kremlin_emails_show_Minsk_protoco.doc” and its content is shown below:\n\n\n-----\n\nAnalyzing the information contained in the maldoc we found that it was a copy of a new published in\nthe Euromaidan Press, Ukraine Internet-based newspaper. The report from the official source\n[Euromaidan Press can be read here . The analysis has revealed some similarities in the infection](https://euromaidanpress.com/2019/10/25/leaked-kremlin-emails-show-minsk-protocol-designed-as-path-to-ukraines-capitulation-euromaidan-press-report/)\nchain, due to the fact that it is formed by malicious VBA macros and as described below, it uses the\nsame C2 domain and it also uses an encoded PowerShell command.\n\n\n-----\n\nThe maldoc, mainly, uses a base64 encoded Windows PowerShell command (as we saw in the first\nmaldoc analyzed) to perform the download from the C2 and then execute it through a WScript object.\n\nNetwork communications through the PowerShell command are made with the HTTP protocol,\nsending a HTTP GET request without using HTTP headers such as User-Agent nor Accept as seen in\nthe previously maldocs. Furthermore, we saw the maldoc contacts with a C2 which domain is\ncontained in the domain list extracted from the first maldoc.\n\n\n-----\n\nWe also saw it on the online malware sandbox ANYRUN with the same network behavior.\n\nWhat’s more, this maldoc contacts with the same domain list we found in the first maldoc requesting a\nWindows PE file named SoftwareUpdate.exe.\n\nSo far, we have seen that the most demanded Windows PE file by every maldoc analyzed was\nSoftwareUpdate.exe and depending on the requesting moment it could be distributed by the C2 or not.\nAfter getting this Windows PE file from the C2 and starting to analyze it, based on a simple static\nanalysis we could quickly conclude it was a variant of well-know and open-source malware known as\nQuasar RAT developed in .NET framework.\n\n\n-----\n\nQuasar RAT is a software distributed under the MIT (Massachusetts Institute of Technology) licensed\n[and freely available on GitHub, as you can see here:](https://github.com/quasar/Quasar)\n\n\n-----\n\nSubsequently, with a behavior-based approach debugging the sample, we realized this sample checks\nthe current path on which it is executed and copy itself in a new directory named “PDF Reader” into\nthe %PROGRAMFILES% directory. Then, the next step is hiding itself from disk setting its file\nattributes as hidden. For this purpose, the sample modifies its own enumerate property FileAttributes\nsetting it to Hidden (Application.ExecutablePath -> FileAttributes.Hidden).\n\nThen, with a ready environment, Quasar tries to contact with the C2 notifying a new computer\ncompromised successfully. It was here, at this point of analysis, where we found the same domain list\nthat it had been identified previously through the maldocs analyzed. This C2 domain list is stored in a\ndynamic object variable named hostsManager, specifically into the attribute queue_0 and each value\nstore every domain, IP address and port associated to contact with the C2. Note that Quasar RAT\ncommunicates with the C2 using the same TCP port 4782 and every communication will be encrypted\nthrough HTTPS except only one relative to the domain b29[.]bet.\n\n\n-----\n\nFinally, we found its SSL certificate, identifying the subject as a Quasar Server CA with an expiration\ndate 31/12/9999 and it appears that it have been generated since March 04, 2022.\n\nOn the whole, beyond destructive artifacts seen into the Russia’s ongoing cyberattacks in Ukraine, it\nseems there is a place for cyberespionage campaigns which are taking advantage of the information\npublished relative to the Russia’s ongoing cyberwar events. However, we do not have enough\nevidence to make any kind of attribution up to now.\n\n\n-----\n\n**INDICATORS OF COMPROMISE:**\n\nMALDOCS:\n\n**FILENAME** **SHA1**\n\nUkraine Conflict Update 16_0.doc 6e7775277b18a481ca4ce24d5e13fd38ab1b5991\n\nUkraine Conflict Update 16_0.docm 079037f3abff65ce012af1c611f8135726ef0ad2\n\nUkraine Conflict Update 16_0.xlsm 35c6d3b40ba88f5da444083632c8e414a67db267\n\nUkraine Conflict Update 16_0.zip 296f26fb9b09a50f13bdf6389c05f88019bac13f\n\nLeaked_Kremlin_emails_show_Minsk_protoco.doc 4476657d32a55ca0d89d21d2a828a8d8cbc5dbab\n\nQUASAR RAT:\n\n**FILENAME** **SHA1**\n\n\nThe increasingly complicated\nRussia-Ukraine crisis\nexplained.zip\n\nThe increasingly complicated\nRussia-Ukraine crisis\nexplained.exe.pdf\n\n\n34dfdf16d13f974a06f46486ab4ad7034db8e9d5\n\nbbb9bf63efc448706f974050bef23bb1edd13782\n\n\nSoftwareUpdate.exe bbb9bf63efc448706f974050bef23bb1edd13782\n\nNETWORK:\n\n**Domain** **list**\n\ntaisunwin.]club\n\nweb.sunwinvn.]vip\n\nsunvn.]vin\n\nb29.]bet\n\nplay.go88vn.]vin\n\nplaygo88.]fun\n\nchoigo88.]us\n\ngo88c.]net\n\ngo88.]gold\n\ngo88vn.]vin\n\nplay.go88vn.]vin\n\n\n-----\n\ngo88code.]com\n\nthesieutoc.]net\n\nsun.]fun\n\nCustomers with Lab52’s APT intelligence private feed service already have more tools and means of\ndetection for this campaign.\nIn case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already\nbeen applied.\n\nIf you need more information about Lab52’s private APT intelligence feed service, you can contact us\n[through the following link](https://lab52.io/contact)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-24 - Another cyber espionage campaign in the Russia-Ukrainian ongoing cyber attacks.pdf"
    ],
    "report_names": [
        "2022-03-24 - Another cyber espionage campaign in the Russia-Ukrainian ongoing cyber attacks.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535706,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653700794,
    "ts_modification_date": 1653700794,
    "files": {
        "pdf": "https://archive.orkl.eu/ca56255c91d216d3089899264f4b387ceb30d5eb.pdf",
        "text": "https://archive.orkl.eu/ca56255c91d216d3089899264f4b387ceb30d5eb.txt",
        "img": "https://archive.orkl.eu/ca56255c91d216d3089899264f4b387ceb30d5eb.jpg"
    }
}