{
    "id": "83df3ea7-a051-4935-8bbf-b1095fc8a47a",
    "created_at": "2023-01-12T15:06:08.444569Z",
    "updated_at": "2025-03-27T02:11:43.431131Z",
    "deleted_at": null,
    "sha1_hash": "47ce22a58c58a5abc24ee8206386b9429957754d",
    "title": "2020-12-08 - Threat Assessment- Egregor Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T19:05:52Z",
    "file_modification_date": "2022-05-28T19:05:52Z",
    "file_size": 1378638,
    "plain_text": "# Threat Assessment: Egregor Ransomware\n\n**[unit42.paloaltonetworks.com/egregor-ransomware-courses-of-action/](https://unit42.paloaltonetworks.com/egregor-ransomware-courses-of-action/)**\n\nDoel Santos, Brittany Barbehenn, Robert Falcone December 9, 2020\n\nBy [Doel Santos,](https://unit42.paloaltonetworks.com/author/doel-santos/) [Brittany Barbehenn and](https://unit42.paloaltonetworks.com/author/brittany-ash/) [Robert Falcone](https://unit42.paloaltonetworks.com/author/robertfalcone/)\n\nDecember 8, 2020 at 6:00 PM\n\n[Category: Ransomware,](https://unit42.paloaltonetworks.com/category/ransomware/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [egregor,](https://unit42.paloaltonetworks.com/tag/egregor/) [threat assessment](https://unit42.paloaltonetworks.com/tag/threat-assessment/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/egregor-ransomware-courses-of-action/)\n\n## Executive Summary\n\nSince September 2020, Unit 42 researchers have observed Egregor ransomware affecting\nmultiple industries globally, including those within the U.S, Europe, Asia Pacific and Latin\nAmerica, following the decline in operations utilizing the Maze ransomware. Egregor\noperations mimic that of Maze operations, leading us to believe that although Maze\noperators [announced a shutdown of the “Maze Team Project,” the operators behind those](https://www.bleepingcomputer.com/news/security/maze-ransomware-is-shutting-down-its-cybercrime-operation/)\nactivities have simply developed a new ransomware to move their objectives forward.\n\n\n-----\n\nDue to the surge in Egregor ransomware activity, we ve created this general threat\nassessment for overall threat awareness. Full visualization of the techniques observed and\n[their relevant courses of action can be viewed in the Unit 42 ATOM Viewer.](https://unit42.paloaltonetworks.com/atoms/egregor-ransomware/)\n\n## Malware Overview\n\nEgregor is a variant of the Sekhmet ransomware family. It has been observed since at least\nSeptember 2020, around the same time when Maze ransomware operators announced an\nintent to shut down their operations. Affiliates who utilized the Maze ransomware to conduct\ntheir activities now appear to have likely moved on to Egregor to avoid disrupting their\noperations.\n\nMaze ransomware leveraged malware such as Trickbot, and Egregor has followed suit, using\n[commodity malware such as Qakbot, IcedID and Ursnif for initial access.](https://www.group-ib.com/blog/egregor) [Ryuk ransomware](https://unit42.paloaltonetworks.com/ryuk-ransomware/)\nalso leveraged both Trickbot and BazaLoader in a similar fashion to gain initial access to a\nvictim system.\n\nAfter initial infection, scripts are used to modify victim firewalls and enable Remote Desktop\nProtocol (RDP). Cobalt Strike is used to conduct network reconnaissance, move laterally\nacross the network, exfiltrate data and prepare for execution.\n\nDuring our analysis, we observed a ZIP file containing a PowerShell script (Figure 1) that\nattempts to uninstall a McAfee endpoint agent. It then uses BITS to download the Egregor\nDLL from a malicious server and execute the payload using Rundll32.\n\nFigure 1.PowerShell script used to download Egregor ransomware.\nEgregor uses multiple anti-analysis and evasion techniques, such as disabling a system’s\nantivirus software and heavily obfuscating the payload. Also, the payload can only be\nexecuted with a key using the expected command-line argument, in this case “passegregor10”. When run on the victim’s system, Egregor changes the files’ extensions to a\nrandom set of characters. When the encryption of files is complete, the ransomware creates\nthe ransom note file “RECOVER-FILES.txt” in all folders that contain encrypted files.\n\n\n-----\n\nFigure 2. Egregor’s “Hall of Shame.”\nThe ransom note provides instructions with a three-day deadline to pay the ransom. If no\ncontact is made within that timeframe, the victim risks exposure of all exfiltrated data on the\nEgregor “Hall of Shame” (Figure 2). Visible on the Hall of Shame is a visitor number and a\nprogress percentage apparently referring to uploading data. We suspect that these numbers\nare used to aid the threat actors’ ransom negotiations.\n\nMore information on ransomware can be found in the 2021 Unit 42 Ransomware Threat\nReport.\n\n## Courses of Action\n\nThis section documents relevant tactics, techniques and procedures (TTPs) used with\nEgregor and maps them directly to Palo Alto Networks product(s) and service(s). It also\nfurther instructs customers on how to ensure their devices are configured correctly.\n\n**Product / Service** **Course of Action**\n\n**Initial Access, Execution, Privilege Escalation,**\n**Defense Evasion**\n\nThe below courses of action mitigate the following\ntechniques:\n\n[Spearphishing Attachment [T1566.001], Valid Accounts](https://attack.mitre.org/techniques/T1566/001/)\n\n[[T1078], PowerShell [T1059.001], DLL Side-Loading](https://attack.mitre.org/techniques/T1078)\n\n[[T1574.002], Process Injection [T1055], Obfuscated Files](https://attack.mitre.org/techniques/T1574/002/)\n[or Information [T1027], Rundll32 [T1218.011]](https://attack.mitre.org/techniques/T1027)\n\nNGFW Set up File Blocking\n\nEnsure that User-ID is only enabled for internal trusted\ninterfaces\n\nEnsure that 'Include/Exclude Networks' is used if User-ID\nis enabled\n\n\n-----\n\nEnsure that the User-ID Agent has minimal permissions if\nUser-ID is enabled\n\nEnsure that the User-ID service account does not have\ninteractive logon rights\n\nEnsure remote access capabilities for the User-ID service\naccount are forbidden\n\nThreat Prevention† Ensure that antivirus profiles\nare set to block on all\ndecoders except 'imap' and\n'pop3'\n\nEnsure a secure antivirus profile is applied to all relevant\nsecurity policies\n\nEnsure that all zones have Zone Protection Profiles with\nall Reconnaissance Protection settings enabled, tuned and\nset to appropriate actions\n\n\nWildFire† Ensure that WildFire file size\nupload limits are maximized\n\nEnsure forwarding is enabled for all applications and file\ntypes in WildFire file blocking profiles\n\nEnsure a WildFire Analysis profile is enabled for all\nsecurity policies\n\nEnsure forwarding of decrypted content to WildFire is\nenabled\n\nEnsure all WildFire session information settings are\nenabled\n\nEnsure alerts are enabled for malicious files detected by\nWildFire\n\nEnsure 'WildFire Update Schedule' is set to download and\ninstall updates every minute\n\nCortex XDR Enable Anti-Exploit\nProtection\n\nEnable Anti-Malware Protection\n\nCortex XSOAR Deploy XSOAR Playbook Phishing Investigation Generic V2\n\n\n-----\n\nDeploy XSOAR Playbook - Endpoint Malware\nInvestigation\n\n**Discovery**\n\nThe below courses of action mitigate the following\ntechniques:\n\n[Account Discovery [T1087], Domain Trust Discovery](https://attack.mitre.org/techniques/T1087)\n\n[[T1482], File and Directory Discovery [T1083]](https://attack.mitre.org/techniques/T1482)\n\nNGFW Ensure application security\npolicies exist when allowing\ntraffic from an untrusted zone\nto a more trusted zone\n\nEnsure 'Service setting of ANY' in a security policy\nallowing traffic does not exist\n\nEnsure 'Security Policy' denying any/all traffic to/from IP\naddresses on Trusted Threat Intelligence Sources Exists\n\nCortex XDR Configure Behavioral Threat\nProtection under the Malware\nSecurity Profile\n\n**Impact**\n\nThe below courses of action mitigate the following\ntechniques:\n\n[Data Encrypted for Impact [T1486]](https://attack.mitre.org/techniques/T1486)\n\nCortex XSOAR Deploy XSOAR Playbook Ransomware Manual for\nincident response.\n\n_Table 1. Courses of Action for Egregor ransomware.†These capabilities are part of the NGFW security subscriptions service._\n\n## Conclusion\n\nIn the short period of its observed activities, Egregor ransomware has compromised\nindustries globally, including those within the U.S, Europe, Asia Pacific and Latin America.\nOrganizations should be aware of and monitor the use of commodity malware, such as\nQakbot, IcedID and Ursnif, that could end up delivering Egregor ransomware as a secondstage payload. Like Maze and other current variants, Egregor ransomware affiliates use\ndouble extortion. They host an extortion website called the “Hall of Shame” site to create\nadditional pressure and shame their victims into paying the ransom.\n\n\n-----\n\nWith the fall of Maze ransomware and the rise of Egregor, we suspect the group behind this\nransomware will remain active in the following months and will continue their efforts to target\nhigh-profile organizations.\n\n[Indicators associated with this Threat Assessment are available on GitHub, have been](https://github.com/pan-unit42/iocs/tree/master/Egregor)\n[published to the Unit 42 TAXII feed and are viewable via the ATOM Viewer.](https://unit42.paloaltonetworks.com/atoms/egregor-ransomware)\n\nIn addition to the above courses of action, AutoFocus customers can review additional\nactivity by using the tag [Egregor.](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Egregor)\n\nPalo Alto Networks has shared our findings, including file samples and indicators of\ncompromise, in this report with our fellow Cyber Threat Alliance members. CTA members\nuse this intelligence to rapidly deploy protections to their customers and to systematically\ndisrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visit\n[www.cyberthreatalliance.org.](http://www.cyberthreatalliance.org/)\n\n## Additional Resources\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-08 - Threat Assessment- Egregor Ransomware.pdf"
    ],
    "report_names": [
        "2020-12-08 - Threat Assessment- Egregor Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3c864b3-fac9-4d56-8500-7c06c829fbf8",
            "created_at": "2023-01-06T13:46:39.071873Z",
            "updated_at": "2025-03-27T02:00:02.990045Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Storm-0216",
                "DEV-0216",
                "UNC2198",
                "Maze Team",
                "TWISTED SPIDER",
                "GOLD VILLAGE"
            ],
            "source_name": "MISPGALAXY:TA2101",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e9f85280-337c-4321-b872-0919f8ef64a6",
            "created_at": "2022-10-25T16:07:24.261761Z",
            "updated_at": "2025-03-27T02:02:10.153781Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Gold Village",
                "Maze Team",
                "TA2101",
                "Twisted Spider"
            ],
            "source_name": "ETDA:TA2101",
            "tools": [
                "7-Zip",
                "Agentemis",
                "BokBot",
                "Buran",
                "ChaCha",
                "Cobalt Strike",
                "CobaltStrike",
                "Egregor",
                "IceID",
                "IcedID",
                "Mimikatz",
                "PsExec",
                "SharpHound",
                "VegaLocker",
                "WinSCP",
                "cobeacon",
                "nmap"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535968,
    "ts_updated_at": 1743041503,
    "ts_creation_date": 1653764752,
    "ts_modification_date": 1653764752,
    "files": {
        "pdf": "https://archive.orkl.eu/47ce22a58c58a5abc24ee8206386b9429957754d.pdf",
        "text": "https://archive.orkl.eu/47ce22a58c58a5abc24ee8206386b9429957754d.txt",
        "img": "https://archive.orkl.eu/47ce22a58c58a5abc24ee8206386b9429957754d.jpg"
    }
}