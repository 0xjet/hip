{
    "id": "32a49e36-44b4-4810-9601-0fbd561f843e",
    "created_at": "2022-10-25T16:48:11.481736Z",
    "updated_at": "2025-03-27T02:16:41.13725Z",
    "deleted_at": null,
    "sha1_hash": "f8b1d371008a2108bb7ded054b7b0b7cdc4d5295",
    "title": "Command And Control In The Fifth Domain",
    "authors": "Command Five Pty Ltd",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 615514,
    "plain_text": "# Command and Control in the Fifth Domain\n\nCommand Five Pty Ltd\nFebruary 2012\n\n**ABSTRACT**\n\nThis paper presents the findings of an extensive investigation into\ncommand and control infrastructure used by an Advanced Persistent\nThreat. Findings include technical details of malicious software, and\nassociated command and control protocols. These findings are drawn\nupon to identify modus operandi and demonstrate links between a\nnumber of major targeted attacks including the recent Sykipot attacks,\nthe July 2011 SK Communications hack, the March 2011 RSA breach,\nand the series of coordinated cyber attacks dubbed NightDragon.\n\n\n**WARNING**\n\nThis paper discusses malicious activity and identifies\nInternet Protocol (IP) addresses, domain names, and\nwebsites that may contain malicious content. For\nsafety reasons these locations should not be accessed,\nscanned, probed, or otherwise interacted with unless\ntheir trustworthiness can be verified.\n\n**BACKGROUND**\n\nOn 28 July 2011 SK Communications announced it\nhad been the subject of a hack which resulted in the\ntheft of the personal details of up to 35 million\npeople[1]. The attackers infected a number of SK\nCommunications computers with malicious software\n(malware) and, by issuing command and control (C2)\ninstructions to the malware, were able to gain access\nto, and exfiltrate large quantities of data. The attack\nitself was complex, well planned and likely part of a\nbroader, concerted hacking effort attributable to an\nAdvanced Persistent Threat[2].\n\n1 For details of the hack refer to the Command Five paper ‘SK Hack\nby an Advanced Persistent Threat’. (Command Five Pty Ltd, 2011)\n2 For a definition of the term ‘Advanced Persistent Threat’ refer to\nthe Command Five paper ‘Advanced Persistent Threats: A Decade\nin Review’. (Command Five Pty Ltd, 2011)\n\n\nThe malware used in the attack was programmed\nto communicate with several ‘callback’ domains. The\nmalware located its C2 server(s) by resolving these\ndomains into IP addresses using the ubiquitous\nDomain Name System (DNS) [3] protocol. These\ncommunications are depicted in Figure 1.\n\n1.\nDNS server\n\nComputer 2.\ninfected with\n\nmalware 3.\nCommand and\n\n4. control (C2) server\n\nUsing the Domain Name System (DNS) protocol, the computer\nasks a DNS server for directions to the callback domain.\nThe DNS server advises that the callback domain is located at IP\naddress x.x.x.x.\nThe malware communicates with the C2 server located at IP\naddress x.x.x.x to obtain C2 instructions and/or to send a\nresponse.\nThe C2 server provides additional C2 instructions to the malware.\n\nFIGURE 1: DEPICTION OF COMMUNICATIONS\n\n3 DNS is fundamental on the Internet. It is a form of directory\nassistance to help computers communicate with other computers.\nIts use is analogous to a person calling directory assistance to find\nout what phone number to dial to speak to a certain person.\n\n\n**1.** Using the Domain Name System (DNS) protocol, the computer\nasks a DNS server for directions to the callback domain.\n**2.** The DNS server advises that the callback domain is located at IP\naddress x.x.x.x.\n**3.** The malware communicates with the C2 server located at IP\naddress x.x.x.x to obtain C2 instructions and/or to send a\nresponse.\n**4.** The C2 server provides additional C2 instructions to the malware.\n\n\nDNS server\n\n\n3.\n\n\n2.\n\n\nPAGE 1 OF 29\n\n\nComputer\ninfected with\n\nmalware\n\n\n4.\n\n\n-----\n\nOne of the callback locations used in the SK\nCommunications hack was ‘update.alyac.org’. The\ndomain was registered on 24 September 2010 using\nregistration information almost identical to that of a\nlegitimate company – a tactic used by the attacker on\nseveral occasions[4].\n\nFollowing the intrusion into the SK\nCommunications network it became widely known\nthat the domain was being used for malicious\npurposes, and perhaps for this reason, the one year\nregistration was not renewed by the attacker. Despite\nthis, a number of victims around the world continued\nto use the domain to locate their C2 server, resulting\nin attempted communications to a C2 server that no\nlonger exists.\n\n**THE VICTIMS**\n\nComputers using IP addresses allocated to France,\nthe People’s Republic of China, Portugal, South Korea,\nTaiwan, the United Kingdom and the United States\nare among those that attempted to communicate with\n‘alyac.org’ subdomains after the attacker’s\nregistration lapsed in September 2011.\n\nWhile some of these computers belong to\nsecurity researchers who deliberately installed\nmalware for research purposes, most are victims\ncompromised by the attacker either directly or\nindirectly. The victims are from a variety of\nindustries including the technology sector, high\nprecision manufacturing, research and development,\ntesting and certification, global market research,\nexecutive headhunting and mentoring, and\nwebhosting providers.\n\n**THE COMMUNICATIONS**\n\nEight different types of C2 communications were\nobserved to ‘alyac.org’ subdomains from the\ncompromised computers. These communication\ntypes will be referred to as ‘LURK’, ‘X­Shell C601’,\n‘Update?’, ‘Murcy’, ‘Oscar’, ‘BB’, ‘DB’, and ‘Qdigit’\nrespectively. Several victims communicated via both\n‘Update?’ and ‘Oscar’ which are believed to be\nassociated with the same malware. No other victims\nwere observed communicating with ‘alyac.org’\nsubdomains via more than one C2 protocol.\n\n4 Other domains registered using a similar tactic include\n‘bomuls.com’, ‘nprotects.org’, and ‘trendmicros.net’. (Command\nFive Pty Ltd, 2011)\n\n\n**THE ‘LURK’ COMMUNICATIONS**\n\nA single computer was observed communicating with\nthe callback domain ‘path.alyac.org’ on Transmission\nControl Protocol (TCP) 80 via the ‘LURK’ protocol.\nThe communications contained a 15­byte header\nfollowed by data compressed using the DEFLATE[5]\n\ncompression method. The header contained a\nprotocol identifier, size and compression information\nas shown in Table 1.\n\n\n0 4 LURK protocol identifier.\nHexadecimal bytes ‘0x4C 0x55 0x52\n0x4B’ (or “LURK” in ASCII\nrepresentation).\n\n4 1 Hexadecimal byte ‘0x30’ (“0”) in all\nobserved samples. Byte may form\npart of the protocol identifier.\n\n5 4 Sizec ­ Compressed message size in\nbytes (including header).\n\n9 4 Decompressed data size in bytes.\n\n13 2 ZLIB[6] stream header. Hexadecimal\nbytes ‘0x78 0x9c’[7] in all observed\ncommunications, denoting that the\nDEFLATE compression method was\nused to compress the data (with a\nwindow size of 32K).\n\n15 [Sizec – 15] DEFLATE compressed data.\n\n- ALL VALUES ARE LITTLE­ENDIAN UNLESS OTHERWISE STATED.\n\nTABLE 1: LURK PROTOCOL FORMAT\n\nThe decompressed data reveals information\nabout the compromised computer such as its name,\ncomputer specifications and operating system (OS)\ninformation as shown in Table 2. For example, it\nreveals that the compromised computer\ncommunicating with ‘path.alyac.org’ is running\nWindows 2003 Server Web Edition, Service Pack 2.\n\n5 The DEFLATE compression method is specified in RFC 1951.\n(Deutsch, 1996)\n6 ZLIB is a compressed data format scheme specified in RFC 1950.\n(Deutsch, ZLIB Compressed Data Format Specification version 3.3,\n1996)\n7 As described in Section 2.2 of RFC 1950, bits 0 to 3 in the first\nbyte of the ZLIB stream header represent the compression method\nused, and bits 4 to 8 represent compression information. The\nsecond byte in the header contains bits for an integrity check,\nalong with two additional flags. With a second byte of ‘9c’ the\nintegrity check passes (as 30876 is divisible by 31), the preset\ndictionary flag is not set, and the compression level flag indicates\nthat the default algorithm was used for compression. (Deutsch,\nZLIB Compressed Data Format Specification version 3.3, 1996)\n\n\nBYTE\nPOSITION\n\n\nSIZE (BYTES) DESCRIPTION*\n\n\nPAGE 2 OF 29\n\n\n-----\n\nBYTE\nPOSITION\n\n\nSIZE\n(BYTES)\n\n\nDESCRIPTION*\n\n\n0 4 Possible protocol identifier. Fixed bytes ‘0x82\n0x69 0x74 0x6B’ in all observed\ncommunications.\n\n4 260 ‘0x00’ bytes in all observed communications.\n\n264 1 ‘0xD0’ in all observed communications.\n\n265 31 Null­terminated computer name.\n\n296 24 ‘0x00’ bytes in all observed communications.\n\n320 156 OSVERSIONINFOEX[8] structure (format shown\nin Annex A).\n\n476 9 Null­terminated account name.\n\n485 19 Unknown.\n\n504 4 Horizontal screen resolution (pixels).\n\n508 4 Vertical screen resolution (pixels).\n\n512 92 Unknown.\n\n604 4 Computer Processor Unit speed in megahertz\n(MHz).\n\n608 8 Null­terminated string containing amount of\nmemory and unit of measurement (e.g.\n“1023MB”).\n\n616 120 Unknown.\n\n- ALL VALUES ARE LITTLE­ENDIAN UNLESS OTHERWISE STATED.\n\nTABLE 2: FORMAT OF DECODED LURK\nCOMMUNICATIONS\n\nSimilar communications [9] are known to be\ngenerated by malware that communicates with the\ncallback domain ‘office.windowupdate.org’ – a\ndomain that is linked to ‘alyac.org’ not only by the\ncommunications protocol but also by both domain\nregistration tactic and infrastructure.\n\nThe domain ‘windowupdate.org’ is ostensibly\nregistered to ‘Microsoft Corporation’. The\nadministrative address and contact information listed\nin the domain registration is identical to that listed\nfor the legitimate Microsoft domain\n‘windowsupdate.com’[10]. This is the same tactic used\nby the attacker with registration of ‘alyac.org’[11].\n\n8 The OSVERSIONINFOEX system information structure includes\nmajor and minor version numbers, a build number, platform\nidentifier and information about product suites and the latest\nService Pack installed. (Microsoft Corporation, 2011)\n9 The malware ‘Troj/Agent­UDR’ with MD5 hash ‘4237 7E72 4875\n2912 5EBE 7C95 02B9 4CD7’ is known to generate\ncommunications of the format ‘LURK0\\xAC\\x01’,\n’LURK0\\xAD\\x01’, ‘LURK0\\B3\\x01’ and ‘LURK0\\xB5\\x01’.\n(Sophos Ltd., 2011)\n10 The legitimate domain ‘windowsupdate.com’ is used by\nMicrosoft to deliver updates to the Windows OS.\n11 The domain ‘alyac.org’ was registered using registration details\nthat made the domain appear as though it was associated with the\nlegitimate, trusted entity ESTsoft – the producer of ALYac antivirus\nsoftware. (Command Five Pty Ltd, 2011)\n\n\nThe domain ‘windowupdate.org’ previously\npointed to South Korean IP address 222.122.20.241­\nan IP address to which ‘alyac.org’ also previously\npointed. This shared infrastructure further suggests\nthat the observed communications to ‘path.alyac.org’\nand those to ‘office.windowupdate.org’ may be linked\nto the same attacker.\n\nThe malware that generates the LURK\ncommunications sent to ‘office.windowupdate.org’\nwas signed using a compromised code signing\ncertificate belonging to YNK Japan Inc – a producer of\nonline games. The same certificate has been used in a\nnumber of attacks including by Hupigon malware[12]\n\nand malware similar to that used in the SK\nCommunications hack. Details of the compromised\ncode signing certificate are shown in Figure 2.\n(Fagerland, 2011)\n\n\nSerial Number: 046931BF57EBC5947D3DC4EE7A236E\nCommon Name: YNK JAPAN Inc\nStatus: Revoked\nValidity (GMT): Nov 27, 2009 – Nov 27 2011\nClass: Digital ID Class 3 – Software Validation\nOrganisation: YNK JAPAN Inc\nOrganisational Digital ID Class 3 – Microsoft Software\nUnit: Validation v2\nState: Chuo­ku\nCity/Location: Nihonbashi Kodenmachou10­6\nCountry: JP\nSerial Number: 6724340ddbc7252f7fb714b812a5c04d\nIssuer Digest: 96c16fb10ef41f9736c50c5bac0ddd67\n\n\nFIGURE 2: COMPROMISED CERTIFICATE DETAILS\n\nThe compromised code signing certificate was\nrevoked on 29 July 2011 but, as the malware was\nsigned on 3 July 2010 and the revocation was not\nactive for software signed before 29 July 2011 [13], the\ncertificate continued to validate for this malware\nafter the revocation. (Fagerland, 2011)\n\nThe date of effect of the revocation has since\nbeen backdated to prevent this malware’s certificate\nfrom validating[14]. The new date of effect still may not\nprevent the validation of all malware using this\ncompromised code signing certificate.\n\n12 Hupigon is a remote administration tool from China. It has\nrootkit functionality, can log user activity and establishes\noutbound communications to a C2 server. (F­Secure Corporation)\n13 The revocation is active from the ‘revocationDate’ (in this case,\n29 July 2011) specified in the Certificate Revocation List.\n14 The revocation for the compromised code signing certificate has\nbeen backdated to 12 April 2010 so that the earliest known\nmalware signed with it no longer validates. (Verisign, 2011)\n\n\nSerial Number: 046931BF57EBC5947D3DC4EE7A236E\nCommon Name: YNK JAPAN Inc\nStatus: Revoked\nValidity (GMT): Nov 27, 2009 – Nov 27 2011\nClass: Digital ID Class 3 – Software Validation\nOrganisation: YNK JAPAN Inc\nOrganisational Digital ID Class 3 – Microsoft Software\nUnit: Validation v2\nState: Chuo­ku\nCity/Location: Nihonbashi Kodenmachou10­6\nCountry: JP\nSerial Number: 6724340ddbc7252f7fb714b812a5c04d\nIssuer Digest: 96c16fb10ef41f9736c50c5bac0ddd67\n\n\nPAGE 3 OF 29\n\n\n-----\n\n**THE ‘X­SHELL C601’ COMMUNICATIONS**\n\nNumerous compromised computers communicated\nwith ‘path.alyac.org’ on TCP port 443 ­a port\ncommonly used for SSL. These communications,\nhowever, were not SSL but instead unencrypted\ncommunications likely generated by a version of the\ncommand­line based ‘X­Shell 601’ Remote\nAdministration Tool (RAT)[15].\n\nA summary of the observed X­Shell\ncommunications, and the information they reveal\nabout the compromised computer, is shown in Table\n3. The ‘C’ immediately preceding the ‘601’ in the\ncommunications is believed to indicate that the\nmalware is not a free version but instead a custom, or\ncommercial, version of the X­Shell 601 RAT.\n\n\nBYTE\nPOSITION\n\n\nSIZE\n(BYTES)\n\n\nDESCRIPTION*\n\n\n0 8 ‘0x00’ bytes in all observed samples.\n\n8 4 Tick count (number of milliseconds\nsince system was started – resets after\n49.7 days).\n\n12 4 ‘0x00’ bytes in all observed samples.\n\n16 4 Protocol identifier – ’0x43 0x36 0x30\n0x31’ (“C601”).\n\n20 28 Null­terminated username (if\nsuccessfully obtained from the system).\n\n48 156 OSVERSIONINFOEX structure (format\nshown in Annex A).\n\n204 52 Unknown.\n\n256 32 Null­terminated computer name (if\nsuccessfully obtained from the system).\n\n288 12 Process name.\n\n300 52 ‘0x00’ bytes in all observed\ncommunications.\n\n352 36 SYSTEM_INFO[16] structure (format\nshown in Annex B).\n\n388 72 ‘0x00’ bytes in all observed samples.\n\n460 12 Unknown.\n\n472 4 Locale identifier[17].\n\n476 4 Tick count (repeated).\n\n480 300 Unknown. Mainly ’0x00’ bytes in\nobserved communications.\n\n - ALL VALUES ARE LITTLE­ENDIAN UNLESS OTHERWISE STATED.\n\nTABLE 3: X­SHELL C601 COMMUNICATION FORMAT\n\n15 The X­Shell RAT is commercial software. (XTiger, Xdoors.net,\n2011)\n16 The SYSTEM_INFO structure contains information about a\ncomputer such as its architecture, type of processor and number of\nprocessors used. (Microsoft Corporation, 2011)\n17 A locale is a collection of language­related user preference\ninformation that typically identifies a user’s country and dialect.\n(Microsoft Corporation, 2011)\n\n\nIn all observed communications the process\nname listed at byte 288 was ‘svchost.exe’[18]. Based on\nthis, the malware has likely modified the system\nregistry on the compromised computers in such a\nway that the RAT gets executed as a service by the\ntrusted process ‘svchost.exe’ each time the computer\nis started. This process name, along with the callback\nlocation, is configurable, and can be configured after\nthe RAT has been compiled into executable form.\n\nWhile X­Shell supports numerous versions of the\nWindows OS (including Windows XP, Vista, Windows\n7, and Windows 2000, 2003 and 2008 server ­ both\n32 and 64 bit versions), only computers running\nWindows XP were observed communicating with\n‘path.alyac.org’.\n\nThe functionality of the RAT depends on the\nversion, release number, plugins installed and the OS\non which the RAT is installed[19]. Several versions of\nthe X­Shell RAT exist, including a free version and a\n‘spy’ version[20]. The free version of the RAT is no\nlonger available for download from the XDoors\nwebsite, however, development of the software\ncontinues[21]. Current release numbers of the X­Shell\nRAT include 601 and 603. Previous releases date\nback to at least 2006[22].\n\nSome functionality comes standard in all\nversions of the RAT including the ability to start a\ncommand shell, control processes and services,\nupload/download files, terminate TCP connections,\ncreate user accounts, retrieve system information, log\nuser activity (via a keylogger), modify timestamps on\nfiles, conduct process injection, conduct denial of\nservice attacks and shutdown or restart the\ncomputer. Commands supported by the X­Shell\nsoftware are listed in Annex C. (XTiger)\n\n18 The process ‘svchost.exe’ is a generic host process for services\nwhich run from DLLs. (Microsoft, A description of Svchost.exe in\nWindows XP Professional Edition 2007)\n19 Not all features are supported in each OS. For example, raw\nsocket sniffing is only supported in Windows 2000 and 2003.\n(XTiger)\n20 Versions of X­Shell include a ‘personal’ edition, a ‘mini’ version,\nan ‘advanced’ version, a ‘spy’ version and an ‘enterprise’ version.\n(XTiger ­ Crackersoftware, 2011)\n21 Due to the author wanting to avoid “unnecessary trouble”, as of\n16 March 2011, the free version of the X­Shell RAT (and also its\nsister product the X­Door RAT) is no longer available for download\nfrom the ‘xdoors.net’ webpage, however, an online forum\ncontaining a list of changes made to the RAT continues to be\nupdated. (XTiger, forum.xdoors.net. Topic: X­Door/X­Shell free\ndownload paused, 2011)\n22 Previous releases of X­Shell include release numbers 323, 325,\n327, 329, 331, 333, 335 and 337. (XTiger, 2010)\n\n\nPAGE 4 OF 29\n\n\n-----\n\nThe RAT is Virtual Machine (VM) aware, proxy\naware and can also use a specified DNS server to\nresolve callback domains. Some versions have rootkit\nfunctionality and can avoid detection by antivirus\nsoftware. Third­party plugins can be developed and\nintegrated into the product.\n\nOptional features include encrypted file search,\nan SMS notification service, and functionality that\nenables the compromised computer to be used as\npart of a botnet to send spam or to conduct\ndistributed denial of service attacks. This broad range\nof functionality makes the software fit for a number\nof purposes and reflects the commercial nature of the\nsoftware. (XTiger)\n\nThe X­Shell RAT is generated by the X­Shell\nControl Program ­ the same program from which the\nmalware is controlled. The control program can be\nrun in either Chinese language mode or English\nlanguage mode, and allows the malware to be easily\nconfigured. It provides options to digitally sign the\nmalware, specify its connection mode\n(connect/listen/sniff), install the malware in one of\nseveral covert manners, recover the System Service\nDispatch Table (SSDT)[23] before installation, and abort\ninstallation if a virtual machine is detected. (XTiger)\n\nWhen X­Shell malware is generated, and the\n‘connect’ connection mode[24] selected, the malware is\nconfigured with a static C2 host (IP address or\ncallback domain) and control port. Additionally, an\noption can be selected during the generation process\nto actively notify the malware of a new C2 host and\nport via a configuration webpage[25]. If this option is\nselected, the malware communicates with both a\nconfiguration webpage, and a C2 server at regular\nintervals. The interval for each can be separately\nconfigured to a value of between 30 and 3600\nseconds (inclusive). (XTiger)\n\nThe X­Shell RATs that communicated with the C2\nhost ‘path.alyac.org’ had been configured to use a 36\nsecond interval. It is not known whether the malware\nwas configured solely with a static C2 host or\n\n23 The SSDT is often used by kernel mode rootkits to evade\ndetection.\n24 In the ‘connect’ mode the malware attempts to communicate\nwith its C2 server, as opposed to the ‘listen’ mode in which it waits\nfor a C2 server to attempt to connect to it.\n25 The configuration webpage is often named ‘xcip.asp’ and can be\ngenerated and uploaded from within the control program. ‘Xcip’ is\npresumably an acronym for ‘X­door Configure IP address’ or\nsomething similar.\n\n\nwhether the malware also retrieves its C2 host and\nport from a configuration webpage.\n\n_X­Shell Configuration Webpages_\n\nX­Shell configuration webpages contain, in encoded\nform, a colon­separated IP address (or callback\ndomain) and port for the malware to use to\ncommunicate with its C2 server. The encoded IP\naddress (or callback domain) and control port can be\ndecoded one byte at a time using the formula:\n\ndi = ei – ((i%8)+x),\n\nwhere i is the byte index, di is the decoded byte, ei is\nthe encoded byte and x is a one byte key. This is the\nequivalent of subtracting both the key and the byte\nposition number [0­7] from each byte. The position\nnumber is modulo 8 i.e. repeats every 8 bytes.\n\nFor example, if the compromised computers\nreceived a C2 host of ‘PATH.ALYAC.ORG’ and a\ncontrol port of 443 from a configuration webpage,\nand a key of 0x16 (22 in decimal) was used to encode\nthe control information, the configuration webpage\nwould have contained the encoded string\n‘fXlaH\\hvWZFhlbVQJJ’.\n\n**THE ‘UPDATE?’ COMMUNICATIONS**\n\nHyperText Transfer Protocol (HTTP) POST ‘Update?’\nrequests were sent to both ‘path.alyac.org’ and\n‘update.alyac.org’ from compromised computers.\nTwo request formats were observed; Variant A\n(shown in Figure 3) in which the file path requested\nwas ‘/update?product=windows’, and Variant B\n(shown in Figure 4) in which the file path requested\nwas ‘/update?id=number’, where number refers to an\neight digit hexadecimal number that changes\nbetween requests. The domain ‘path.alyac.org’ only\nreceived Variant B requests, while both variants were\nsent to ‘update.alyac.org’.\n\n\nPAGE 5 OF 29\n\n\n-----\n\nPOST /update?product=windows HTTP/1.1\nAccept: */*\nX-Session: 0\nX-Status: 0\nX-Size: 61456\nX-Sn: 1\nUser-Agent: Mozilla/4.0 (compatible; MSIE\n6.0; Windows NT 5.1;SV1;\nHost: update.alyac.org\nContent-Length: 0\nConnection: Keep-Alive\nCache-Control: no-cache\nCookie: VisitorID=c2a4b456-e11e-4c37-88d8e770aa88058d&Exp=9/25/2014 6:14:17 AM\n\n\nFIGURE 3: VARIANT A COMMUNICATIONS\n\nPOST /update?id=3109c2a2 HTTP/1.1\nAccept: */*\nX-Session: 0\nX-Status: 0\nX-Size: 61456\nX-Sn: 1\nUser-Agent: Mozilla/4.0 (compatible; MSIE\n6.0; Windows NT 5.1;SV1;\nHost: path.alyac.org\nContent-Length: 0\nConnection: Keep-Alive\nCache-Control: no-cache\nCookie: VisitorID=bd5ab197-355d-42cb-ae1b8d23f1dd55ed&Exp=9/25/2014 6:03:33 AM\n\nFIGURE 4: VARIANT B COMMUNICATIONS\n\nThe format of Variant A is identical to the\ncommunications generated by the Destory RAT used\nin the SK Communications hack[26]. The format of\nVariant B is identical to the communications\ngenerated by malware that uses the callback domain\n‘gm1.network­sec.net’[27].\n\nBoth variants are associated with the Destory\nRAT family of malware that dates back at least as far\nas January 2007[28] and has been used in several major\ntargeted attacks.\n\n26 For a detailed analysis of the Destory RAT used in the SK\nCommunications hack (including a complete list of deobfuscated\nstrings) refer to the Command Five paper ‘SK Hack by an Advanced\nPersistent Threat’. (Command Five Pty Ltd, 2011)\n27 Malware detected as ‘Troj_Inject.AMR’ submits HTTP POST\nrequests to ‘gm1.network­sec.net/update?id={value}’. The domain\n‘gm1.network­sec.net’ is a known callback of malware detected as\nBackdoor:Win32/Thoper.A. (Mendoza, 2011) (Wong, 2011)\n28 The Destory RAT with MD5 hash ‘70CD C9A2 D9CC 276B C5D1\nD47D 21FB 24DF‘ was compiled on 3 January 2007.\n\n\nThe Destory RAT family includes malware that is\ndetected as:\n\n� Backdoor.Sogu,\n� Backdoor:Win32/Thoper.A[29],\n� Trojan.Downloader:Win32/Thoper B[30].\n\nThe observed communications to the ‘alyac.org’\nsubdomains all occurred on TCP port 80, however, a\nvariety of ports (TCP ports 8080, 443, 12345 etc.)\nhave been used by this particular family of malware\nfor similar requests. The port used depends on how\nthe malware is configured.\n\nConnection attempts from each of the\ncompromised computers occurred frequently while\nthe computers were powered on. For example, one\ncomputer connected at 16 second intervals and\nanother approximately every 200 seconds (±15\nseconds). Three HTTP POST requests were submitted\nduring each connection, each approximately one\nsecond apart.\n\nThe following malformed user­agent[31] is present\nin the HTTP POST requests of both variants (spaces\nshown here as ‘·’):\n\n‘Mozilla/4.0·(compatible;·MSIE·6.0;·Windows·NT\n\n- .1;SV1;’\n\nThis user­agent is consistent with that which\nmay be generated by version 6.0 of the Microsoft\nInternet Explorer web browser running on the\nMicrosoft Windows XP OS, except that it is missing a\nclosing bracket after the last semicolon and a space\nafter the second to last semicolon. This malformed\nuser­agent is hardcoded into the malware and can be\nused as a signature to detect the communications.\n\nFour custom headers are also present in the\nHTTP requests: ‘X­Session’, ‘X­Status’, ‘X­Size’, and ‘X­\nSn’. For some malware in the Destory RAT family not\nall of these headers will be present.\n\n29 The Destory RAT with MD5 hash ‘5FCE 1FC1 8283 D76C 396A\n3CCC 64BD BBDE’ is detected by antivirus software as both\nBackdoor.Sogu and Backdoor:Win32/Thoper.A. This malicious file\nis identical to that used in the SK Communications hack except for\nits configuration. (Hispasec Sistemas, 2011)\n30 The Destory RAT with MD5 hash ‘7543 64D9 DB70 2DC7 1532\n7B40 BF97 E556’ is detected by antivirus software as both\nBackdoor.Sogu and TrojanDownloader:Win32/Thoper.B.\n(Hispasec Sistemas, 2011)\n31 User­agents are used in HTTP communications to tell\nwebservers which OS and web browser their clients are using, so\nthey can serve compatible webpages.\n\n\nPOST /update?id=3109c2a2 HTTP/1.1\nAccept: */*\nX-Session: 0\nX-Status: 0\nX-Size: 61456\nX-Sn: 1\nUser-Agent: Mozilla/4.0 (compatible; MSIE\n6.0; Windows NT 5.1;SV1;\nHost: path.alyac.org\nContent-Length: 0\nConnection: Keep-Alive\nCache-Control: no-cache\nCookie: VisitorID=bd5ab197-355d-42cb-ae1b8d23f1dd55ed&Exp=9/25/2014 6:03:33 AM\n\n\nPAGE 6 OF 29\n\n\n-----\n\n_Cookie Stealing_\n\nCookies were sent with the HTTP POST requests from\nall but three IP addresses. A cookie named ‘VistorID’\nwas present any time a cookie was sent. On occasion\na ‘Yahoo’, ‘SessionId’ and/or ‘fcVal’ cookie was also\npresent in the requests. The transmission of these\ncookies could facilitate session stealing and, in the\ncase of the Yahoo cookie, enable unauthorised\nwebmail access.\n\nEach VisitorID cookie contained an expiry time\nbetween 9/25/2014 5:50:03 AM and 9/25/2014\n6:14:17 AM. The expiry time is unique for each victim\nand remained constant (per victim) across the HTTP\nPOST requests. It is possible the victims received the\ncookie from a C2 server with which they had\npreviously communicated, or, from a server hosting a\nwebpage that caused the initial infection. It is also\npossible that the cookie, and the propinquity of the\ntimes in the cookies, is coincidental, and that the\nvictims received the cookie from other locations.\n\n**THE ‘MURCY’ COMMUNICATIONS**\n\nMultiple Chinese IP addresses were observed\nsubmitting HTTP GET requests to the host\n‘path.alyac.org’. Data contained within the\ncommunications indicated that the requests were all\nsent from a single computer, and therefore that\ncomputer was not using a static IP address.\n\nThe data from the computer was carried in the\nrequests in an encoded form (as described below)\nwithin a HTTP header named ‘Extra­Data’. Two other\nunique headers were also present in the requests;\n‘Extra­Data­Bind’ and ‘Extra­Data­Space’. The\ncommunications appear to be generated by malware\nknown as ‘Backdoor.Murcy’ that is reportedly not in\nwidespread use[32]. An example of an actual HTTP GET\nrequest is shown in Figure 5.\n\n32 Symantec Corporation assesses the number of Backdoor.Murcy\ninfections to be less than 50. (Ward, 2011)\n\n\nGET /150828 HTTP/1.0\nConnection: Keep-Alive\nAccept: */*\nHost: path.alyac.org\nUser-Agent: Mozilla/4.0 (compatible; MSIE\n6.0; Windows NT 5.1)\nExtra-Data-Bind: DE6A34D80D43B930\nExtra-Data-Space: 65536\nExtra-Data:\n\n4ZFNSAAEAAh2AoNAAAAAAgRCHACwoSogAjKhCCf/HA\nAVNAAAAeAAAgDBAAABIAAAs0kAAUAAAAQAAAAAooAA\nAIAAAAATAAAAKCAAAgKAAAgqAAAA4CAAAgNAAAAOAM\nDA3AgQAxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\nxxxxAEEAzAQOAADA5AAMAkDAwAgNAkDAxAAAAMFAlB\ngcAYHApBwYAUGAgAAUAEGAjBwaAACAzAAAAAAATBQW\nAMFAUBQRA0EAAAwVA8EAXBQLAUEA4AQRAxxxxxxxxx\nxxxxxxxxxx2AAAAAAA\nCache-Control: no-cache\nPragma: no-cache\nContent-Length: 0\n\n\nFIGURE 5: SAMPLE OF MURCY COMMUNICATIONS\n\nThe path in the HTTP GET requests is the\ncomputer’s tick count (i.e. the number of milliseconds\nsince the system was started). The requests from the\nvictim occurred approximately every 11 seconds\nwhen the computer was turned on. Accordingly, the\nnumber in the URI increased by approximately 11000\neach request. Where there was a break in the\ncommunications (presumably due to the computer\nbeing shut down or rebooted), the counter reset and\nwas between 128703 and 133243 in the next\ncommunication. This indicates that the malware\nbegan communicating from this compromised\ncomputer within minutes of the computer being\nbooted.\n\nThe encoded data within the ‘Extra­Data’ header\ncan be decoded using the standard Base64 alphabet\nbut with modified bit placement. The standard\nBase64 algorithm decodes encoded strings using\nconsecutive bits read left to right i.e. bits 0­7 would\nform the first decoded byte (shown in Figure 6). For\nMurcy communications, the input bits that form each\noutput byte are not taken contiguously. Figure 7\ndescribes how the first three decoded bytes are\nconstructed, and can be used to implement a\ndecoding algorithm.\n\n\nPAGE 7 OF 29\n\n\n-----\n\n|0|1|2|3|4|5|6|7|8|9|10|11|\n|---|---|---|---|---|---|---|---|---|---|---|---|\n|1st decoded byte||||||||2nd||||\n\n|12|13|14|15|16|17|18|19|20|21|22|23|\n|---|---|---|---|---|---|---|---|---|---|---|---|\n|decoded byte||||3rd decoded byte||||||||\n\n|10|11|0|1|2|3|4|5|\n|---|---|---|---|---|---|---|---|\n\n|14|15|16|17|6|7|8|9|\n|---|---|---|---|---|---|---|---|\n\n|18|19|20|21|22|23|12|13|\n|---|---|---|---|---|---|---|---|\n\n\n78 56 34 12 00 10 00 10 DA 00 DA 00 ; xV4.........\n00 00 00 00 18 09 07 20 C0 A8 84 82 ; ....... ....\nC0 A8 84 82 F0 FD 07 00 54 0D 00 00 ; ........T...\n80 07 00 00 38 04 00 00 04 08 00 00 ; ....8.......\n2C 4D 02 00 05 00 00 00 01 00 00 00 ;,M..........\n28 0A 00 00 02 00 00 00 4C 00 00 00 ; (.......L...\n8A 00 00 00 A8 00 00 00 AA 00 00 00 ; ............\nB8 00 00 00 D8 00 00 00 38 00 33 00 ; ........8.3.\n37 00 42 00 xx xx xx xx xx xx xx xx ; 7.B.xxxxxxxx\nxx xx xx xx xx xx xx xx xx xx xx xx ; xxxxxxxxxxxx\nxx xx xx xx xx xx xx xx xx xx xx xx ; xxxxxxxxxxxx\nxx xx xx xx xx xx xx xx xx xx xx xx ; xxxxxxxxxxxx\nxx xx 36 00 39 00 31 00 00 00 53 00 ; xx6.9.1...S.\n65 00 72 00 76 00 69 00 63 00 65 00 ; e.r.v.i.c.e.\n20 00 50 00 61 00 63 00 6B 00 20 00 ; .P.a.c.k. .\n33 00 00 00 00 00 53 00 59 00 53 00 ; 3.....S.Y.S.\n54 00 45 00 4D 00 00 00 57 00 4F 00 ; T.E.M...W.O.\n57 00 2D 00 45 00 38 00 45 00 xx xx ; W.-.E.8.E.xx\nxx xx xx xx xx xx xx xx xx xx xx xx ; xxxxxxxxxxxx\n36 00 00 00 00 00          ; 6.....\n\n\n2[nd] decoded\nbyte\n\n\n1[st] decoded\nbyte\n\n\n1[st] Base64 encoded character 2\n\n\n4[th] Base64 encoded character\n\n\n3[rd] decoded byte\n\n\n2[nd]\n\n\nPAGE 8 OF 29\n\n\nFIGURE 6: BIT PLACEMENT IN BASE64 DECODING\n\n\n2[nd] Base64 encoded character\n\n\n1[st] decoded byte\n\n\n-----\n\nThe data sent to the C2 server is dependent on\nthe C2 instructions received. Commands the Murcy\nmalware reportedly understands are shown in Annex\nD. (SafeZoneCast, 2011)\n\nThe Murcy malware is commonly named\n‘cydll.dll’, creates a mutual exclusion (mutex [35] )\nhandle named ‘Cy1.0Mutex’, and installs a service\nnamed ‘CyService’ with a display name of ‘CyService\nService’. It also commonly gains persistence by\ncreating the registry key ‘ServiceDll =\n%System%\\cydll.com’ in the ‘ControlSet001’ key in\nthe Local Machine hive of the Windows registry.\n\nSymantec Corporation discovered\nBackdoor.Murcy on 31 July 2011, yet the same\nmalware appears to have been first detected by\nKaspersky Lab on 11 January 2010 [36] . Malware\nsamples with the same attributes date back to at least\nOctober 2009 [37] . This suggests that the Murcy\nmalware has been in use for at least two years.\n\nKnown Murcy malware uses the callback\ndomains ‘albertstein.ddns.us’ 38,\n‘alvington.jetos.com’[39], ‘ftp.xmahone.ocry.com’[40], and\n‘superaround.ns02.biz’ [41] . These callback domains\nwere all also reportedly used in the March 2011\nintrusion into RSA’s network. That intrusion resulted\nin the theft of information related to RSA’s SecurID\ntwo­factor authentication products. The stolen\ninformation was later used to enable targeting of\ndefence contractors. (Coviello, 2011). (Rasmussen,\n2011) (US­CERT, 2011).\n\n35 A mutex is a technical construct used to control access to system\nresources. In this case the technical meaning is less significant than\nthe fact that the mutex in the Murcy malware is uniquely named.\n36 Malware that fits the profile of Murcy malware was detected on\n11 January 2010 as ‘Backdoor.Win32.Agent.anvj’. (Kaspersky Lab\nZAO, 2010)\n37 Malware detected in 2009 with the MD5 hashes ‘3FDE A18B\n9610 CBC9 B63B A7A4 4899 FBFB’ and ‘42E8 163B 7F08 DD38\n3E62 E4BD B7F0 7C08’ is known to callback to IP address\n203.160.67.130. (Sunbelt, 2009) (Sunbelt Security, 2009)\n38 Malware with the MD5 hashes ‘19B0 227B EC75 BEF9 3C6C\nCC54 9B6D 2BA0’ and ‘3DF0 D0AB 4AD9 DA45 59A1 C646 4C85\n26D1’ callback to the domain ‘albertstein.ddns.us’. (GFI Software,\n2010) (Sandbox, 2010)\n39 Malware with the MD5 hashes ‘91A2 68B3 17D2 CC65 69B8\n5BB0 3A5F F841’ and ‘69ED 8F7B 0046 9560 45A9 0E36 E3C8\n3F6A’ callback to the domain ‘www.alvington.JetOS.com’. (GFI\nSandBox, 2011) (Sunbelt Security, 2010)\n40 Malware with the MD5 hashes ‘0D38 D6C2 B9EB 817B 40AF\nC427 2545 A43B’, ‘3E37 36DF FEDA F2A0 AE4D 9485 6793 3B3F’\nand ‘9ADD C6D5 7330 9399 E2B8 7887 3A00 A921’ callback to the\ndomain ‘ftp.xmahone.ocry.com’. (GFI Sandbox, 2011) (Telus, 2011)\n(Threat Expert Ltd, 2011) (GFI Sandbox, 2011)\n41 Malware with MD5 hash ‘3740 5D5B CF64 FB95 47CA CDA9\n5F4C E8B4’ is known to callback to ‘www.superaround.ns02.biz’.\n(GFI Sandbox, 2010)\n\n\n**THE ‘OSCAR’ PROTOCOL**\n\nNumerous computers were observed communicating\nwith an ‘alyac.org’ subdomain on TCP port 80 via the\n‘Oscar’ protocol. Most, but not all, of the computers\nalso communicated to the same domain via the\n‘Update?’ communications. The protocol is believed\nto be associated with the same malware that\nproduces the ‘Update?’ communications – the Destory\nRAT.\n\nEach compromised computer communicated at a\ndifferent interval to the others, and accordingly, the\nmalware on each of the compromised computers\nappears to have been individually configured. For\nexample, one computer communicated every 12\nseconds and another every 16 seconds.\n\nEncrypted data was sent during each\ncommunication. The length of the encrypted data in\neach packet varied between 16 bytes and 89 bytes.\nAfter sending the encrypted data the malware waited\nfor a response.\n\n**THE ‘BB’ PROTOCOL**\n\nTwo computers were observed communicating with\n‘update.alyac.org’ via the ‘BB’ protocol. One of the\ncomputers used a Chinese IP address, the other a\nSouth Korean IP address. The ‘BB’ protocol has a 21\nbyte header containing a 4 byte XOR key that can be\nused to decode the remaining bytes in the packet. The\npacket format is described in Table 5.\n\n\nBYTE\nPOSITION\n\n\nSIZE\n(BYTES)\n\n\nDESCRIPTION*\n\n\n0 4 SizeBB ­ Size in bytes (including\nheader).\n\n4 4 Possible communication type\nindicator. ‘0x01 0x00 0x00 0x00’ in all\nobserved communications.\n\n8 4 Victim specific bytes.\n\n12 4 XOR key.\n\n16 4 Unknown. ‘0x01 0x04 0x01 0x00’ in all\nobserved communications.\n\n20 1 Unknown. ’0x00’ in all observed\ncommunications.\n\n21 [SizeBB] Data encoded using the 4 byte XOR key\nspecified in bytes 12­15.\n\n- ALL VALUES ARE LITTLE­ENDIAN UNLESS OTHERWISE STATED.\n\nTABLE 5: 'BB' PROTOCOL PACKET FORMAT\n\nOnce decoded, the data reveals a basic beacon\ncontaining the computer name and IP address of the\ninfected computer.\n\n\nPAGE 9 OF 29\n\n\n-----\n\nAfter sending the basic beacon, the compromised\ncomputers waited for a response from the server,\nthen closed the connection when they had not\nreceived a response from the server within five\nseconds.\n\nBoth of the compromised computers reattempted\nthe communications approximately every eight\nseconds. On some days the high frequency of the\nbeacon activity resulted in over 10000 connection\nattempts per victim in a 24 hour period.\n\n**THE ‘DB’ PROTOCOL**\n\nA single computer was observed communicating with\nthe domain ‘update.alyac.org’ via the ‘DB’ protocol.\nThe communications originated from the same\nChinese computer network as one of the ‘BB’ victims\nbut from a different computer on that network. It is\nnot known what malware generates the ‘DB’\ncommunications, or whether it is the same malware\nthat generates the ‘BB’ communications.\n\nThe communications reveal detailed OS and\nsystem information about the compromised\ncomputer as shown in Table 6. The OS information\nreveals that the compromised computer is running\nWindows 2003 Server Service Pack 2. The detailed\nsystem information reveals that the compromised\ncomputer has an Intel Pentium Pro­class processor,\nfour logical processors and an LGA 775[42] Central\nProcessing Unit (CPU) socket.\n\n\nBYTE\nPOSITION[43]\n\n\nSIZE\n(BYTES)\n\n\nDESCRIPTION\n\n\n0 156 OSVERSIONINFOEX structure (format\nshown in Annex A).\n\n156 36 SYSTEM_INFO structure (format shown in\nAnnex B).\n\n192 10 Computer name.\n\nTABLE 6: SUMMARY OF FIRST 202 BYTES OF A ‘DB’\nPACKET\n\nThe DB communications typically occurred at\nintervals of between 4 and 92 seconds, however,\nsometimes they were much further apart. After\nsending the detailed beacon to the command and\ncontrol server, the compromised computer appeared\nto expect a response from the server.\n\n42 The combined processor level and processor revision\ninformation indicates the computer has an LGA 775 CPU socket\n(Intel family 6/ model 15/ stepping 11). (Microsoft Corporation,\n2011) (Wikipedia)\n43 On several occasions the 4 bytes ‘70 17 00 00’ were prepended\nto the communications.\n\n\n**THE ‘QDIGIT’ PROTOCOL**\n\nOne computer using a static South Korean IP address\nwas observed sending the five bytes 0x51 0x31 0x39\n0x21 0x00 (“\\x51Q19!”) to ‘update.alyac.org’ on TCP\nport 80 up to nearly 800 times a day. While the\ncommunications did not occur continuously (likely\ndue to the computer being turned off), when they did\noccur a new connection was attempted, and the\npacket containing ‘Q19!’ sent, approximately every\nminute.\n\nIt is assumed these communications are\ngenerated by malware but it is not known what\nmalware, or which other callback domains that\nmalware uses. The malware appeared to expect a\nresponse from the server after it sent each packet.\n\n**FREQUENCY OF COMMUNICATIONS**\n\nThe communications to ‘alyac.org’ subdomains\noccurred frequently from each compromised\ncomputer. A summary of typical observed intervals\nbetween communications, broken down by protocol,\nis shown in Table 7.\n\nPROTOCOL TYPICAL BEACON INTERVAL*\n(SECONDS)\n\nLURK 26\n\nX­Shell C601 36\n\nUpdate? 1 to 13, 12±3, 16, 104±3 or 200 ±15\n\nMurcy 11\n\nOscar 12±2, 13, 15, 16, (55 or 155±5), (7.5, 8.5 or 15),\n(45, 55, 106)\n\nBB 8\n\nDB 4 to 92\n\nQdigit 60\n\n- Commas indicate that the interval changed between victims.\nBrackets indicate that a variety of intervals were observed from\na single computer.\n\nTABLE 7: INTERVAL BETWEEN COMMUNICATIONS\n\nThe single LURK victim was typically observed\nbeaconing at 26 second intervals, the Murcy victim at\n11 second intervals, and the Qdigit victim at 60\nsecond intervals. All of the X­Shell C601 victims were\ntypically observed beaconing at 36 second intervals,\nand the BB victims at 8 second intervals. The\nbeaconing interval of the other victims does not\nappear to be a fixed time, and instead a degree of\nrandomness appears to be employed.\n\n\nPAGE 10 OF 29\n\n\n-----\n\n_Ports used_\n\nAs shown in Table 8, the observed communications\nall occurred on TCP port 80 or TCP port 443 ­ ports\ncommonly used for legitimate purposes[44].\n\nPROTOCOL PORT\n\nLURK 80\n\nX­Shell C601 443\n\nUpdate? 80\n\nMurcy 80\n\nOscar 80\n\nBB 80\n\nDB 80\n\nQdigit 80\n\nTABLE 8: COMMUNICATION PORTS USED\n\n**NAME SERVERS**\n\nWhile most malware uses the local DNS server\nsettings of the compromised computer to resolve its\ncallback domain to an IP address, in some observed\ncommunications the attackers appear to have\nspecifically chosen the DNS servers.\n\nThe majority of X­Shell C601 malware that called\nback to ‘path.alyac.org’ used Google DNS servers,\npresumably instead of the DNS settings on the\ncompromised computers. The X­Shell C601 malware\nsupports use of a specified DNS server to resolve\ncallback domains, and it appears the attackers have\nmade use of this functionality.\n\nThe ‘Update?’, Oscar, Murcy and Qdigit victims all\nappear to have used their local DNS server settings to\nresolve the callback domains. On the other hand, the\nsingle LURK victim used Google DNS servers to\nresolve its callback domain, as did the Chinese BB\nvictim (and associated DB victim) but not the South\nKorean BB victim. This suggests that the LURK, BB\nand DB malware may also have the same DNS\nfunctionality as X­Shell, although it is possible that\nthe victims are configured to use the Google servers\nas their regular DNS servers, and that the malware is\nnot using different servers.\n\n44 TCP ports 80 and 443 are commonly used for legitimate HTTP\nand HTTPS activity respectively, and as such communications to\nthese ports are often allowed through firewalls.\n\n\n**ASSOCIATION WITH MALWARE AND ATTACKS**\n\nThe observed communications have links to a variety\nof malware and to a number of attacks, as illustrated\nin Figure 9, and detailed below.\n\nThe ‘Update?’ communications and the Oscar\ncommunications are both associated with the Destory\nRAT family of malware. This malware family has been\nused in a number of targeted attacks including the\nJuly 2011 SK Communications hack. Through shared\ninfrastructure the malware has links to the series of\ncoordinated, covert and targeted cyber attacks\ndubbed ‘NightDragon’[45], and also to the recent series\nof targeted attacks that have used ‘Sykipot’ [46]\n\nmalware.\n\nThrough a shared callback domain the Destory\nRAT malware also has links to socially engineered\nemails including those that targeted experts on the\nrelationship of the United States with Japan, China\nand Taiwan. The Destory RAT is also connected to\nLURK malware via a compromised code signing\ncertificate which was used to sign both pieces of\nmalware, and to IP2B communications by a shared\ncallback domain.\n\nThe X­Shell RAT has been used in numerous\nattacks but many of these attacks are not expected to\nbe associated with the same attackers. On the other\nhand, the callback domains used by Murcy malware\nsuggest that the malware is used, perhaps solely, by\nthe attackers responsible for the March 2011 RSA\nbreach.\n\nIP addresses, to which ‘alyac.org’ and its\nsubdomains previously pointed, associate the\ndomain, and the attackers behind it, with a raft of\nactivity. This includes activity involving callback\ndomains registered to appear as though they were\nassociated with legitimate, trusted entities, and\ndomains registered to a ‘Lee Cooper’ that tie back to\nthe SK Communications hack.\n\n45 The NightDragon series of attacks began in, or prior to,\nNovember 2009 and targeted global oil and petrochemical\ncompanies. (McAfee Foundation Professional Services and McAfee\nLabs, 2011)\n46 Sykipot is a family of malware used since 2007 to steal\nintellectual property. The malware has been used in a series of\nsocially engineered email campaigns against a variety of sectors.\nOn a number of occasions, the attackers have exploited zero day\nvulnerabilities to install the malware. Some variants of the\nmalware include features that enable it to hijack smartcards.\n(Thakur, 2011) (Lelli, 2010) (Blasco, 2012)\n\n\nPAGE 11 OF 29\n\n\n-----\n\n.duamlive.com\n\n\nro.diggfunny.com Lee Cooper\n\n\nAlyac.org\nand its\nsubdomains\n\n\nUnique\ndirectory\n(03a075fb70d5d6\n\n75f9dc26fc)\n\n\nTrojan.Win32.Generic\n(tcomoniter.exe)\n\n\nRSA Breach\n\n\nX­Shell C601\ncommunications\n\n\nOscar\nprotocol\n\n\nThe LURK\nprotocol\n\n\nalbertstein\n.ddns.us\n\n\nCommunications\n\nhack\n\n\n*.world\nsecuritys.com\n\n\nftp.xmahone\n.ocry.com\n\n\n*.network­\nsec.net\n\n\nLURK\nmalware\n\n\nIP2B\nprotocol\n\n\nwww.adv138mail.com\n\n\nSeveral\nattacks\n\n\npc.nprotects\n.org\n\n\nQdigit\nmalware\n\n\npu.flower­show.org\n\n\nro.diggfunny.com\n\n\nX­Shell\nRAT\n\n\nDestory\nRAT\n\n\nDB malware\n\n\n*.mail­kr2.com\n\n\n*.oerco.com\n\n\nLee Cooper\n\n\nSeveral\nattacks\n\n\n202.30.224.240\n\n\n*.bluelightness.com\n\n\n68.178.232.100\n\n\n209.133.72.83\n\n\nSykipot\n\n\n209.53.155.244\n\n\nDB protocol\n\n\n112.121.171.94\n\n\n222.122.20.241\n\n\n*.afbjz.com\n\n\nFIGURE 9: ILLUSTRATION OF LINKS\nPAGE 12 OF 29\n\n\nCompromised code\n\nsigning certificate\n\n(6724340ddbc7252f7fb\n\n714b812a5c04d)\n\n\nQdigit\ncommunications\n\n\n*.windowupdate.org\n\n\nTrojan.Win32.\nAgentBypass\n\n\nsuperaround\n.ns02.biz\n\n\n*.todaygonever.\ncom\n\n\nalvington\n.jetos.com\n\n\n*.topix21\ncentury.com\n\n\n‘madconnon\n@126.com’\n\n\n*.welldone\n123.net\n\n\nPoison\nIvy RAT\n\n\nnewhose.ntimobile.com\n\n\nBB\nmalware\n\n\nIP2B\nmalware\n\n\n*.join3com.com\n\n\nNightDragon\n\n\n175.45.22.220\n\n\n‘Janagreen2000’\n\n\nbbs.ezxsoft.com\n\n\n-----\n\n_NightDragon_\n\nDestory RAT malware is known to communicate with\nthe callback domain ‘vupdate.mail­kr2.com’[47], while\nNightDragon malware is known to communicate with\n‘ma2.mail­kr2.com’ [48] and ‘www2.mail­kr2.com’ [49] .\nThe communications sent to ‘www2.mail­kr2.com’\nare similar 50, but not identical, to IP2B\ncommunications, further linking the observed\nactivity. Other ‘mail­kr2.com’ subdomains include\n‘cb85.mail­kr.com’, ‘sa****.mail­kr2.com’, and\n‘skylie.mail­kr2.com’ ­ at least two of which are\nknown to be associated with malware[51].\n\nDestory RAT malware is known to use the\ncallback domain ‘bbs.afbjz.com’ [52], while known\nNightDragon malware uses the callback domain\n‘blog.afbjz.com’[53]. As of 3 February 2012, both of the\nsubdomains point to US IP address 67.90.204.228.\nThis overlap in infrastructure appears to be of\nparticular significance given the following links\nbetween other activity on the same IP address.\n\nAs of 6 February 2012, the domains ‘gmail.mail­\nru2.com’, ‘live.mail­ru2.com’, ‘mail­ru2.com’,\n‘msn.mail­ru2.com’, ‘usaisbig.oerco.com’,\n‘whois.oerco.com’, ‘www.afbjz.com’, and\n‘www2.oerco.com’ also point to IP address\n67.90.204.228. At least one of these domains is\notherwise known to be associated with malware[54].\n\n47 The Destory RAT with MD5 hash ‘9555 8985 D211 F768 1ACC\n1AC9 2DCB 07C8 A096 B403’ uses the callback location\n‘vupdate.mail­kr2.com’.\n48 Malware with MD5 hash ‘2D8A 9038 E151 FB30 D45E A866\n8AFD 2A8E’, known to call back to ‘ma2.mail­kr2.com’, is detected\nby antivirus software as ‘TrojanDropper:Win32.RedSip.A’, an alias\nfor NightDragon malware. (ThreatExpert Ltd., 2010) (Hispasec\nSistemas, 2011) (Kurc, 2011)\n49 Malware with MD5 hash ‘5BC5 97E4 8270 F04E C9B6 8343\n2432 E352’, known to call back to ‘www2.mail­kr2.com’, is\ndetected by antivirus software as ‘Backdoor:Win32/RedSip.A!svc’,\nan alias for NightDragon malware. (Sunbelt Security, 2010)\n(Hispasec Sistemas, 2010)\n50 Both communications begin with a 16 byte header containing the\nprotocol identifier ‘0x12345678’ and a data size, and the data in\nboth contains similar system information but in a different order.\n51 Malicious files are separately known to attempt communications\nwith ‘sa*****.mail­kr2.com’ on TCP port 8000, and ‘cb85.mail­\nkr2.com’ on TCP port 6543. (Doctor Web, 2011) (Sunbelt Security,\n2011)\n52 The domain ‘bbs.afbjz.com’ is a known callback domain of\nDestory RAT malware that is detected by antivirus software as\nboth Backdoor:Win32/Thoper.A and Backdoor.Sogu. (Wong, 2011)\n(Mullaney, 2011)\n53 The domain ‘blog.afbjz.com’ is a known callback domain of\nNightDragon malware that is detected by antivirus software as\n‘Trojan.Dropper:Win32/Redsip.A’. (Kurc, 2011)\n54 Malware that is detected by antivirus software as\n‘Trojan.DownLoader4.8565’ communicates with\nus****ig.oerco.com on TCP port 100. (Dr. Web, 2011)\n\n\nThe ‘oerco.com’ domain is registered to the same\nperson as ‘afbjz.com’[55], associating the two domains\nwith a single entity. The ‘mail­ru2.com’ domain\nappears to be associated with the same entity as the\n‘mail­kr2.com’ domain used by NightDragon malware\nand the Destroy RAT (as described above). While the\ndomains were registered using different details, they\nwere registered on the same day through the same\ndomain name registrar, and the records later updated\nminutes apart[56]. This suggests that all C2 activity\ninvolving IP address 67.90.204.228 may be\nassociated with a single entity.\n\nThe recently expired domain ‘todaygonever.com’\nalso previously pointed to the same IP address. As\nwill be discussed later in the paper,\n‘todaygonever.com’ is directly associated with\nmalware and has links to the recent series of Sykipot\nattacks. The recently expired domains\n‘goodfeelingauto.com’ and ‘deadlinely.com’ also\npointed to the same IP address and were likely\nassociated with the same attackers.\n\n_Socially Engineered Emails_\n\nOther Destory RAT callback domains are also\notherwise linked to malicious activity. For example,\nthe callback domain 'www.adv138mail.com' [57] was\nused by a Poison Ivy RAT[58] sent in a July 2011\nsocially engineered email campaign. The emails\ncontained an attachment, named ‘Meeting\nAgenda.pdf’, which attempted to exploit a\nvulnerability specified by the Common\nVulnerabilities and Exposure (CVE) number 2010­\n2883[59] to install the Poison Ivy RAT. A clean decoy\nPDF file was shown to the user when the attachment\nwas opened. A copy of the text used in the socially\nengineered email campaign is shown in Figure 10[60].\n\n55 Both domains are registered to a person whose contact email\naddress is ‘madconnon@126.com’. The name and address details\nare identical for both domain registrations.\n56 The domain ‘mail­kr2.com’ was last modified on 24 February\n2012 at 1:40:32, while the domain ‘mail­ru2.com’ was last\nmodified on the same day at 1:43:53. Both domains were\nregistered through 35 Technology Co., Ltd on 8 March 2010.\n57 The domain ‘www.adv138mail.com’ is listed as a Backdoor.Sogu\ncallback. (Mullaney, 2011)\n58 The Poison Ivy RAT is an advanced remote administration tool\nfor Windows. Both free and paid versions of the RAT are available.\n(shapeless n.d.)\n59 CVE 2010­2883 refers to a particular vulnerability in certain\nversions of Adobe Reader and Acrobat which an attacker can use to\ntake control of affected Windows, Macintosh and UNIX systems.\n(Adobe Systems Incorporated 2010)\n60 Email courtesy of Mila Parkour of ‘contagiodump.blogspot.com’.\n(Parkour 2011)\n\n\nPAGE 13 OF 29\n\n\n-----\n\nBest Regards,\n<purported sender>\n\n\nDear <recipient>,\n\nThe Sasakawa Peace Foundation would like\nto extend to you an invitation to be our\nguest speaker at the America’s Strategic\nRestraint and its Implications for the\nU.S.- Japan Alliance.\nAs you know, the Sasakawa Peace Foundation\nis interested in the U.S.- Japan Alliance\nSince you are familiar with the field, we\nknow your views will be extremely\ninteresting to us.\nplease find enclosed further details, we\nwould appreciate having your acceptance\nsoon so we may complete our agenda.\n\nBest wishes,\n<purported sender>\n\n\nFIGURE 10: TEXT OF A SOCIALLY ENGINEERED\nEMAIL ASSOCIATED WITH WWW.ADV138MAIL.COM\n\nThe domain ‘www.adv138mail.com’ is also\nassociated with malware detected by antivirus\nsoftware as ‘Backdoor.Win32.Delf.abow’ [61] . Other\nknown subdomains include:\n\n� ‘asm.adv138mail.com’,\n� ‘dns.adv138mail.com’,\n� ‘ftp.adv138mail.com’,\n� ‘ihi.adv138mail.com’[62],\n� ‘nov.adv138mail.com’.\n\nThese domains (with the possible exception of\nthe ‘dns’ and ‘ihi’ subdomains) have all pointed to the\nsame infrastructure [63] as the domains ‘pu.flower­\nshow.org’ and ‘www.mailsignin.net’. That shared\ninfrastructure is known to have been used to send\nsocially engineered emails that contained an\nattachment named ‘invtation.pdf’ [sic]. Similar to the\n‘Meeting Agenda’ attachment, ‘invtation’ installs a\nPoison Ivy RAT, but one configured to communicate\nwith the callback domain ‘pu.flower­show.org’[64]. The\ntext used in the emails is shown in Figure 11[65].\n\n61 The malware with MD5 hash ‘F0B8 48A8 41D4 EF34 06A6 F9C4\n766C 540B’ modifies the ‘hosts’ file on computers it is run on so\nthat the file contains an entry for ‘www.adv138mail.com’.\n(ThreatExpert Ltd., 2011)\n62 The domain ‘ihi.adv138mail.com’ is listed as a\nBackdoor:Win32/Thoper.A callback location. (Wong, 2011)\n63 The domains previously pointed to a C2 server located at IP\naddress 112.121.171.94.\n64 The socially engineered email that communicated back to\n‘pu.flower­show.org’ was sent from IP address 112.121.171.94 –\nthe same IP address to which the callback domain pointed.\n65 Email courtesy of Mila Parkour of ‘contagiodump.blogspot.com’.\n(Parkour, contagio: Jul 5 CVE­2010­2883 PDF invitation.pdf with\nPoison Ivy from 112.121.171.94 | pu.flower­show.org, 2011)\n\n\nDear Sir/Madam,\n\nI’m greatly honored to invite you to the\nseminar about technology, which will be\nheld on 28th,July.We would appreciate it\nif you would take your spare time to\nshare the occasion with us. The detail\ninformation is in the attachment. Please\nconfirm your participation at your\nearlist convenience. Looking forward to\nyour reply.Thanks very much.\n\nBest Regards,\n<purported sender>\n\n\nFIGURE 11: TEXT OF A SOCIALLY ENGINEERED\nEMAIL SENT FROM IP ADDRESS 112.121.171.94\n\n_Additional Destory RAT Links_\n\nIn addition to having previously shared\ninfrastructure with the known Destory RAT callback\ndomain ‘www.adv138mail.com’, the domain\n‘www.mailsignin.net’ has also previously shared\ninfrastructure with at least two other known Destory\nRAT callback domains. The domain\n‘www.mailsignin.net’ previously pointed to IP\naddress 175.45.22.220, as did the known Destory\nRAT callback domains ‘newhose.ntimobile.com’ and\n‘sms.servegame.com’[66]. A number of subdomains of\nthe Destory RAT­associated domain ‘join3com.com’\nalso previously pointed to the same IP address[67].\n\nThese links suggest that many attacks in which\nthe Destory RAT has been used are linked, not only\nby the malware, but also through C2 infrastructure.\nThis further supports the notion that the Destory\nRAT was developed by, or for, particular attackers\nand that most, if not all, of the malicious activity\ninvolving it is attributable to those attackers.\n\nThe Destory callback domains also have links to\nadditional malware. For example, the domain\n‘network­sec.net’ has been used by the Destory RAT\n(‘gm1.network­sec.net’), by Poison Ivy malware\n(‘yoyo.network­sec.net’ [68] ) and by ‘Backdoor­FCQ’\n\n66 The domains ‘newhose.ntimobile.com’ and ‘sms.servegame.com’\nare listed as known callbacks for Backdoor.Sogu and Thoper.A\nrespectively. (Wong, 2011) (Mullaney, 2011)\n67 The ‘join3com.com’ subdomains ‘123.join3com.com’,\n‘dow.join3com.com’, ‘ftp.join3com.com’, and ‘ico.join3com.com’ are\nall known to have pointed to IP address 175.45.22.220. The\ndomain ‘catalog.join3com.com’ is listed as a known\nBackdoor:Win32/Thoper.A callback location. (Wong, 2011)\n68 The domain ‘yoyo.network­sec.net’ is used by malware with\nMD5 hash ‘3703 7F67 4BCB BB7E EF38 89AB 6EB3 0268’. (Threat\nExpert Ltd., 2008)\n\n\nPAGE 14 OF 29\n\n\n-----\n\n(‘pingabm.network­sec.net’,’ ‘psbm11025.network­\nsec.net’ and ‘psbm10.network­sec.net’[69]).\n\n_Compromised Code Signing Certificate_\n\nThe observed LURK communications appear to be the\nsame as those generated by malware that was\ndigitally signed using a compromised code signing\ncertificate that was used to sign a Destory RAT, and\nother malware used in several attacks [70] . That\nmalware communicates with the domain\n‘office.windowupdate.org’ – a domain that is linked to\n‘alyac.org’ not only by the communications protocol\nbut also by both domain registration tactic and\ninfrastructure[71]. (Fagerland, 2011)\n\n_Travlman Links_\n\nThe Destory RAT malware used in the SK\nCommunications hack[72] is identical, except for its\nconfiguration, to malware[73] that communicates with\nthe callback domain ‘wow.travlman.com’. The\ncallback domain previously pointed to the same IP\naddress as that used in the SK Communications\nhack[74]. Both of the malicious files were compiled\nfrom the same code on 27 September 2010 at\n09:17:04 Greenwich Mean Time (GMT)[75], and later\nconfigured.\n\nThe callback domain ‘wow.travlman.com’ is also\nused by malware 76 that produces ‘IP2B’\ncommunications of an identical format to those\ndecoded from the ‘Extra­Data’ in the Murcy\ncommunications. This highlights an additional link\n\n69 Backdoor­FCQ uses several ‘network­sec.net‘ subdomains as\ncallback locations. (McAfee Inc., 2011)\n70 The first reported abuse of the certificate was in relation to the\nHupigon trojan with MD5 hash ‘8800 8398 71A3 3801 B2B4 6F9E\n23B7 B7A5’. (Hispasec Sistemas, 2011) (Common Computer\nSecurity Standards)\n71 Refer to the ‘LURK Communications’ section for additional\ninformation.\n72 The Destory RAT used in the SK Communications hack was\nhosted on a toolbox as ‘nateon.exe’, and called back to\n‘nateon.duamlive.com’. It has a SHA1 hash of ‘F84C D73D ABF1\n8660 7F98 6DF9 8C54 02A5 7BB5 8AD1’ and MD5 of ‘4618 84F1\nD41E 9E07 09B4 0AB2 CE5A FCA7’. (Command Five Pty Ltd, 2011)\n73 Malware with the MD5 hash ‘5FCE 1FC1 8283 D76C 396A 3CCC\n64BD BBDE’ calls back to ‘wow.travlman.com’.\n74 Both ‘wow.travlman.com’ and ‘duamlive.com’ previously pointed\nto IP address 203.160.67.131. (rbls, shenqi.travlman.com is not\nlisted in any blacklists, 2011) (DomainTools, LLC)\n75 Automated analysis reports confirm the compilation time of the\ncode and that, while the MD5 hash of each of the files is different,\nthe MD5 hashes of each of the code sections, except for the .data\nsection, are identical. (Hispasec Sistemas, 2011) (Hispasec\nSistemas, 2011)\n76 Malware with MD5 hash ‘B098 AEE1 6BD1 38C4 1207 5C9D\n315A EFC9’. (Threat Expert Ltd, 2010)\n\n\nbetween the Destory RAT and the IP2B\ncommunications.\n\nSeveral other ‘travlman.com’ sub­domains are\nknown to exist [77] including at least one that is\nassociated with malware. The sub­domain\n‘dm.travlman.com’[78] is the callback used by malware\ndetected by antivirus software as\n‘Trojan:Win32/Boupke’[79].\n\n_Link to RSA Breach_\n\nThe majority of the known callback domains for\nMurcy malware were used in the March 2011 RSA\nbreach. This suggests that the attackers responsible\nfor the RSA breach also use the Murcy malware.\nGiven that the malware is reportedly not in\nwidespread use, the Chinese server communicating\nwith ‘path.alyac.org’ may have been compromised by\nthe same attackers responsible for the RSA breach.\n\n_X­Shell RAT_\n\nThe X­Shell RAT is commercially available software\nthat appears to have been used in a number of\nattacks. There are numerous versions of the X­Shell\nRAT, and not all produce the same communications.\n\nMalware that generates the same X­Shell C601\ncommunications 80 observed to ‘path.alyac.org’\nappears to have been used in a number of attacks.\nMalware that generates similar communications also\nappears to have been used in a number of attacks[81].\nThat malware is thought to be an X­Shell C603 RAT\nand not an X­Shell C601 RAT. It is not known whether\nany of these malicious files were used by the same\n\n77 The following are known ‘travlman.com’ subdomains;\n‘dm.travlman.com’, ‘g.travlman.com’, ‘g1.travlman.com’,\n‘g2.travlman.com’, ‘luandao.travlman.com’, ‘mail.travlman.com’,\n‘seo.travlman.com’, ‘shenqi.travlman.com’, ‘wayi.travlman.com’,\nand ‘www.travlman.com’.\n78 Malware with MD5 hash ‘70A8 8091 E1F9 A7BE E246 488C\nCE79 936A’ is known to request the webpage\n‘http://dm.travlman.com/up.txt’. (Sunbelt Security, 2009)\n79 Malware with MD5 hash ‘70A8 8091 E1F9 A7BE E246 488C\nCE79 936A’ is detected by antivirus software as\n‘Trojan.Win32.Boupke!IK’, ‘Trojan:Win32/Boupke.gen!A’, and\n‘Trojan.Win32.Boupke’. (Hispasec Sistemas, 2009)\n80 Automated analysis reports exist on the Internet for probable X­\nShell 601 malware with MD5 hash ‘6581 3CBB 660E 91CD 5FA0\n8300 E177 EB09’, ‘2299 47CC 71A4 601B 8B77 94B4 02E5 36A9’,\n‘DA2F 9831 5F4C 56FC E212 73E2 1E45 3B76’, and ‘F4C0 8D3D\nF5ED E079 0E34 EAE0 C5DB 8A7A’.(Hispasec Sistemas, 2011)\n(Threat Expert Ltd, 2011) (Threat Expert Ltd, 2011) (Threat\nExpert Ltd, 2011)\n81Automated analysis reports exist on the Internet for probable X­\nShell 603 malware with MD5 hash ‘6799 93AD 2CF8 EFDC 788E\n0BA2 04D6 9B0D’, and ’CE93 8C64 7831 080B 7116 5389 E43E\n744D’. (Hispasec Sistemas, 2011) (Hispasec Sistemas, 2011)\n\n\nPAGE 15 OF 29\n\n\n-----\n\nattackers who used the X­shell malware which\ncommunicates with ‘path.alyac.org’.\n\n_Shared Alyac Infrastructure_\n\nThe domain ‘alyac.org’ previously pointed to a C2\nserver located at IP address 222.122.20.241 and\nanother located at IP address 202.30.224.240. These\nIP addresses are associated with a number of other\ncallback domains including ‘bbs.ezxsoft.com’,\n‘pc.nprotects.org’, and ‘wow.travlman.com’ ­ the\nlatter being linked to both the Destory RAT and IP2B\ncommunications (as previously discussed) [82].\n\nIn addition to both having shared infrastructure\nwith ‘alyac.org’, the two callback domains\n‘bbs.ezxsoft.com’ and ‘pc.nprotects.org’ are used by\nmalware that creates a uniquely named directory[83].\nThis indicates a direct relationship between the two\npieces of malware.\n\nThe domain ‘ezxsoft.com’ was registered by the\nsame entity (‘Lee Cooper’) as a domain used in the SK\nCommunications hack (‘ro.diggfunny.com’), further\nlinking it to the same attackers. The C2 server and the\ncallback domains also have links to a myriad of other\nmalicious activity[84].\n\n_Sykipot Activity_\n\nAs previously discussed, before it expired,\n‘todaygonever.com’ pointed to a C2 server associated\nwith both the Destroy RAT and NightDragon\nmalware. The same domain is also associated with\nSykipot activity through shared C2 server\ninfrastructure, and domain registration information.\n\nOver its lifetime the domain ‘todaygonever.com’\npointed to numerous IP addresses, many of which are\nnot noteworthy as they were assigned to servers that\nhosted numerous websites. Four of the IP addresses,\nhowever, are of particular note – IP addresses\n67.90.204.228 (as previously discussed),\n67.79.149.90, 209.133.72.83 and an IP address\nallocated to a large US financial institution.\n\n82 Malware detected as 'Trojan.Win32.AgentBypass' uses the\ncallback domain 'bbs.ezxsoft.com'. Malware detected as\n‘Trojan.Win32.Generic’ uses the callback domain ‘pc.nprotects.org’.\n(GFI SandBox 2011) (GFI SandBox 2011)\n83 Both pieces of malware create a directory named\n‘03a075fb70d5d675f9dc26fc’ and a subdirectory named ‘update’.\n(GFI SandBox 2011) (GFI SandBox 2011)\n84 For further details of the links, refer to the paper ‘SK Hack by an\nAdvanced Persistent Threat’. (Command Five Pty Ltd, 2011)\n\n\nIP address 67.79.149.90 previously hosted the\nknown Sykipot domain ‘help.newcarstyle.com’. Both\nIP address 67.79.149.90 and IP address\n209.133.72.83 previously hosted ‘bluelightness.com’\nsubdomains[85]. They therefore have additional links to\nSykipot activity as ‘shopping.bluelightness.com’ was\npreviously hosted on IP address 209.53.155.244 ­ the\nsame IP address as the known Sykipot domains\n‘www.topix21century.com’ and\n‘notes.topix21century.com’[86]. The ‘bluelightness.com’\ndomain is also linked to ‘mail­kr2.com’ ­ a Destory\nRAT and NightDragon domain previously discussed.\nBoth domains share infrastructure with the domain\n‘worldsecuritys.com’[87].\n\nAs of 6 February, the domains\n‘file.filesdelete.com’, ‘news.welldone123.net’ and\n‘well.welldone123.net’ all point to the IP address\nallocated to the large US financial institution (to\nwhich ‘todaygonever.com’ also previously pointed.)\nThe domain ‘welldone123.net’ is a known Sykipot\ncallback domain[88]. The domain ‘filesdelete.com’ is\nalso otherwise associated with malware[89].\n\nThe email address listed in the domain\nregistration for ‘todaygonever.com’ was\n‘janagreen2000@gmail.com’. The same contact email\naddress (but different name, address, and phone and\nfax numbers) was also used in the domain\nregistration for ‘centurycpc.com’, ‘filesdelete.com’,\n‘greenrightway.com’, ‘quicklyfindme.com’, and\n‘newcarstyle.com’ – at least two of which are known\nSykipot malware domains[90].\n\n85 IP address 67.79.149.90 previously hosted\n‘helpdesk.bluelightness.com’ and IP address 209.133.72.83\npreviously hosted ‘shopping.bluelightness.com’.\n86 IP address 209.53.155.244 previously hosted\n‘notes.topix21century.com’, ‘shopping.bluelightness.com’, and\n‘www.topix21century.com’. The webpage ‘topix21century.com’\nwas used, in what is believed to have been a targeted attack, to\ninstall Sykipot malware on computers which visited the webpage.\nThe installed malware then communicated with a C2 server\nlocated at ‘notes.topix21century.com’. (Symantec Corporation,\n2010) (MalwareGroup.com)\n87 In 2011 both the known callback domain ‘cb85.mail­kr2.com’\nand ‘test.worldsecuritys.com’ pointed to IP address 12.68.249.62,\nthe later still points there as of 9 February 2012. In 2011,\n‘bluelightness.com’ and ‘worldsecuritys.com’ both pointed to IP\naddress 68.178.232.100, the later still points there as of 9 February\n2012.\n88 The domain ‘welldone123.net’ is known to be associated with\nthe Sykipot series of attacks. (Symantec Corporation, 2012)\n89 The domain ‘www.filesdelete.com’ is associated with\n‘Troj/Bdoor­BDM’. (Sophos Ltd., 2012)\n90 The domain ‘help.newcarstyle.com’ is a known Sykipot callback,\nas is ‘greenrightway.com’. (Symantec Corporation, 2012) (Malware\nDomains, 2012)\n\n\nPAGE 16 OF 29\n\n\n-----\n\n**INSIGHTS**\n\n� Increasingly, instead of malware using the\ndefault DNS servers on a compromised\ncomputer to resolve its callback domains to\nIP addresses, attackers will specify DNS\nservers for the malware to use. This has\nsignificant implications for network\ndefenders. Such requests, if allowed, will\nbypass the victim’s DNS servers and defeat\nany blacklists used by the victim’s own DNS\nservers. Furthermore, the requests will not\nappear in the victim’s DNS server logs,\nmaking detection and investigation more\ndifficult.\n� Organisations should consider blocking\ninternal DNS traffic to all locations other\nthan the company’s own DNS servers.\nFurthermore they should be alert to any DNS\ncommunication attempts to locations other\nthan the company’s own DNS servers, as this\nmay be an indicator of a malware infection.\n� When code signing certificates are revoked\nthe date of effect of the revocation is chosen\nso that, where possible, legitimate software\nsigned with the certificate continues to\nvalidate. Unfortunately, this means that\nsometimes malware signed with a\ncompromised certificate will also continue to\nvalidate (despite the revocation).\n� Some malware attempts to communicate\nwith C2 infrastructure at frequent intervals.\nThe frequency of these communication\nattempts can be used to detect the malicious\nactivity.\n� TCP port 443 traffic is often allowed out of a\nnetwork without inspection by network\nsecurity appliances as it is expected to be\nlegitimate, encrypted SSL communications\nthat can be difficult to inspect. Unfortunately,\n\n**DISCLAIMER**\n\n\nattackers take advantage of this by using the\nport to bypass security appliances to\ncommunicate with a C2 server (such as with\nthe observed X­Shell communications).\n� Attackers often reuse the same code for their\nmalware. Sometimes they will recompile the\ncode, sometimes they will merely\nreconfigure the malware. This alters the file\nhash and therefore such a hash is not an\neffective signature for other configurations\nof the malware. Hashes of the individual code\nsections (e.g. .text, .rdata, .reloc) make for\nmore robust detection as sections within the\nmalicious files often remain the same.\n� The majority of legitimate external network\ncommunications use the DNS protocol to\ndetermine their destination’s IP address.\nOutbound network activity that occurs\nwithout a DNS lookup should be treated with\nsuspicion until the purpose of the\ncommunications can otherwise be\ndetermined.\n� Blocking outbound communication attempts\nthat are not preceded by a DNS lookup can\nbe effective in blocking C2 communication\nattempts that are made direct to an IP\naddress (such as to an IP address listed\nwithin an X­Shell configuration webpage).\nLegitimate destination IP addresses should\nbe whitelisted to prevent legitimate activity\nfrom also being blocked.\n� Attackers will sometimes continue to use a\ncallback domain even when it is listed on\nblacklists and in multiple malware analysis\nreports.\n� Blacklisting a domain can be useful but\ntaking the time to research the domain and\nassociated activity can help with the\ndevelopment of more effective, longer term\nmitigation strategies.\n\n\nMachine translation software and automated malware analysis reports\nhave been heavily relied on throughout the development of this paper.\nWhile data has been verified against multiple sources where possible,\nCommand Five Pty Ltd does not guarantee the veracity of sources or the\naccuracy of the information. Command Five Pty Ltd reminds readers to\nexercise caution when visiting untrusted websites and/or opening\nuntrusted digital documents. Command Five Pty Ltd does not warrant\nthat the websites referenced in this paper are trustworthy.\n\nPAGE 17 OF 29\n\n\n-----\n\n**REFERENCES**\n\nBlasco, J. (2012, January 12). Sykipot variant hijacks DOD and Windows smart cards. Retrieved February 05, 2012,\nfrom Alienvault Labs: http://labs.alientvault.com/labs/index.php/2012/when­the­apt­owns­your­smart­\ncards­and­certs/\n\nCommand Five Pty Ltd. (2011, June). Advanced Persistent Threats: A Decade in Review. Retrieved September 24,\n2011, from Command Five Pty Ltd:\nhttp://www.commandfive.com/papers/C5_APT_ADecadeInReview.pdf\n\nCommand Five Pty Ltd. (2011, September). SK Hack by an Advanced Persistent Threat. Retrieved January 06, 2012,\nfrom Command Five Pty Ltd: http://www.commandfive.com/papers/C5_APT_SKHack.pdf\n\nCommon Computer Security Standards. (n.d.). Digital Certificates Used by Malware. Retrieved February 02, 2012,\nfrom CCSS Forum: http://www.ccssforum.org/malware­certificates.php?&pag=4\n\nCoviello, A. (2011, March 17). Open Letter to RSA Customers. Retrieved June 13, 2011, from RSA:\nhttp://www.rsa.com/node.aspx?id=3872\n\nDeutsch, P. (1996, May). DEFLATE Compressed Data Format Specification version 1.3. Retrieved January 08, 2012,\nfrom IETF RFC 1951: http://www.ietf.org/rfc/rfc1951.txt\n\nDeutsch, P. (1996, May). ZLIB Compressed Data Format Specification version 3.3. Retrieved January 25, 2012, from\nIETF RFC 1951: http://www.ietf.org/rfc/rfc1950.txt\n\nDoctor Web. (2011, December 29). Dr. Web Anti­virus ­ How To Remove Virus (Trojan.DownLoader4.20396) ­\n\n_[DRWEBHK.COM]. Retrieved December 29, 2011, from Dr. Web HK:_\nhttp://www.drwebhk.com/en/virus_techinfo/Trojan.DownLoader4.20396.html\n\nDomainTools, LLC. (n.d.). 203.160.67.131 IP Address | WHOIS | DomainTools.com. Retrieved from DomainTools:\nhttp://whois.domaintools.com/203.160.67.131\n\nDr. Web. (2011, July 10). Dr.Web ­ innovation IT­security solutions. Complex protection against Internet threats.\nRetrieved 02 03, 2012, from Dr.Web: http://vms.drweb.com/virus/?i=1007435\n\nFagerland, S. (2011, November 17). Invisible YNK, a Code Signing Conundrum | Norman Blog. Retrieved December\n13, 2011, from Norman.com: http://blogs.norman.com/2011/malware­detection­team/invisble­ynk­a­\ncode­signing­conundrum\n\nF­Secure Corporation. (n.d.). Threat Description: Backdoor: W32/Hupigon. Retrieved December 23, 2011, from F­\nSecure: http://www.f­secure.com/v­descs/backdoor_w32_hupigon.shtml\n\nGFI Sandbox. (2010, May 07). GFI Sandbox Analysis Report. Retrieved January 06, 2011, from GFI Sandbox:\nhttp://xml.ssdsandbox.net/index.php/37405d5bcf64fb9547cacda95f4ce8b4\n\nGFI SandBox. (2011, August 04). GFI SandBox Analysis Report. Retrieved October 17, 2011, from GFI SandBox:\nhttp://xml.ssdsandbox.net/index.php/91a268b317d2cc6569b85bb03a5ff841\n\nGFI SandBox. (2011, July 15). GFI SandBox Malware Analysis Report: Trojan.Win32.AgentBypass. Retrieved August\n25, 2011, from http://xml.ssdsandbox.net/view/fdf2c5c2b1874efe7fd335092df2d3bc\n\nGFI Sandbox. (2011, September 04). GFI Sandbox Malware Analysis Report: Trojan.Win32.Generic. Retrieved\nJanuary 06, 2012, from GFI Sandbox:\nhttp://xml.ssdsandbox.net/index.php/9addc6d573309399e2b878873a00a921\n\nPAGE 18 OF 29\n\n\n-----\n\nGFI SandBox. (2011, May 29). GFI SandBox Malware Analysis Report: Trojan.Win32.Generic!SB\n_Trojan.Trojan.Win32.Generic. Retrieved September 2011, 2011, from_\nhttp://www.xml.ssandbox.net/view/bce1069dd099f15170c5fd05bae921b5\n\nGFI Sandbox. (2011, March 20). GFI Sandbox Malware Analysis Report: Trojan­Dropper.Win32.Wykores. Retrieved\nJanuary 06, 2012, from GFI Sandbox:\nhttp://xml.ssdsandbox.net/index.php/0d38d6c2b9eb817b40afc4272545a43b\n\nGFI Software. (2010, December 26). CWSandbox Report by MD5 at Sunbelt Security. Retrieved December 27, 2011,\nfrom Sunbelt Security:\nhttp://www.sunbeltsecurity.com/partnerresources/cwsandbox/md5.aspx?id=19b0227bec75bef93c6ccc\n549b6d2ba0\n\nHispasec Sistemas. (2009, April 15). Antivirus scan for 70a88091e1f9a7bee246488cce79936a at 2009­04­15\n_11/52/02 UTC. Retrieved February 02, 2012, from VirusTotal:_\nhttps://www.virustotal.com/file/63ac63f59700dbcc3778a9c1e9f5689869c86ac2aa3295ad93278f9244c\nff7f4\n\nHispasec Sistemas. (2010, May 22). Antivirus scan for 5bc597e48270f04ec9b683432432e352 at 2010­05­22\n_17/52/37 UTC ­ VirusTotal. Retrieved February 07, 2012, from VirusTotal:_\nhttps://www.virustotal.com/file/e4711259a3dd9af85b649cc8afcf34bc86d1d68ed7286db35f7b260e60\n27c110/analysis/\n\nHispasec Sistemas. (2011, August 15). Antivirus scan for 2d8a9038e151fb30d45ea8668afd2a8e at 2011­08­15\n_13/34/31 UTC ­ VirusTotal. Retrieved February 03, 2012, from VirusTotal:_\nhttps://www.virustotal.com/file/76747e708d79925ba0817d48c96f4c85938bfe3f0f5b681ff204a09bd3e\nbc1cc/analysis\n\nHispasec Sistemas. (2011, August 19). Antivirus scan for 461884f1d41e9e0709b40ab2ce5afca7 at 2011­08­19\n_13/31/35 UTC. Retrieved February 02, 2012, from VirusTotal:_\nhttps://www.virustotal.com/file/74455d5e8f99272aec64bce106b1e8ff39a122a7d27d362a274af31ab5\na4fb1fe\n\nHispasec Sistemas. (2011, November 06). Antivirus scan for 5fce1fc18283d76c396a3ccc64bdbbde at 2011­11­06\n_09/44/14 UTC. Retrieved January 30, 2012, from VirusTotal:_\nhttps://www.virustotal.com/file/4dc0c7d8d84838c9b209ea727bd4ab7471a88fba55b786f7e37ce6394\n565b6aa/analysis\n\nHispasec Sistemas. (2011, November 08). Antivirus scan for 754364d9db702dc715327b40bf97e556 at 2011­11­08\n_18/29/09 UTC. Retrieved January 30, 2012, from VirusTotal:_\nhttps://www.virustotal.com/file/781c30714ff5304b7e9530ec879ef4ed7e94a0138537563b4c12b158c7\nbcab40/analysis\n\nHispasec Sistemas. (2011, May 10). VirusTotal ­ Free Online Virus, Malware and URL Scanner. Retrieved December\n30, 2011, from VirusTotal:\nhttp://www.virustotal.com/report.html?id=5e29960ba0bb544623b52e5db592242f30c05ca1336ec667\nd0a162b9a7584f90\n\nHispasec Sistemas. (2011, November 21). VirusTotal ­ Free Online Virus, Malware and URL Scanner. Retrieved\nDecember 30, 2011, from VirusTotal: http://www.virustotal.com/file­\nscan/report.html?id=deb83be93eb74a66b8c654ddb28c3a1c58ee89abf3a72ce616755deb6f9902c­\n1321864468\n\nPAGE 19 OF 29\n\n\n-----\n\nHispasec Sistemas. (2011, December 21). VirusTotal ­ Free Online Virus, Malware and URL Scanner. Retrieved\nDecember 30, 2011, from VirusTotal: http://www.virustotal.com/file­\nscan/report.html?id=251b196f94d6a858941cb2e18b6879fc2d3f4ef580a8cae338f42e7776229fc­\n1324454798\n\nHispasec Sistemas. (2011, May 24). VirusTotal ­ Free Online Virus, Malware and URL Scanner. Retrieved January 04,\n2012, from VirusTotal: http://www.virus­scan/file­\nscan/report.html?id=5999da598ee19708c997e77650b0b423c0337ebff16c6ad7d929fc3a84f10f13\n\nKaspersky Lab ZAO. (2010, January 12). Backdoor.Win32.Agent.anvj. Retrieved December 09, 2011, from\nSecurelist: http://www.securelist.com/en/descriptions/7440365/Backdoor.Win32.Agent.anvj\n\nKurc, D. (2011, April 17). Encyclopedia entry: TrojanDropper:Win32/Redsip.A ­ Learn more about malware ­\n_Microsoft Malware Protection Center. Retrieved January 25, 2012, from Microsoft Malware Protection_\nCenter:\nhttp://www.microsoft.com/security/portal/threat/Encyclopedia/Entry.aspx?Name=Trojan.Dropper%3\nAWin32%2FRedsip.A\n\nLelli, A. (2010, March 12). Zero­Day Attack on IE6 ­ JS.Sykipot Doesn't Spare Retired Software. Retrieved February\n01, 2012, from Symantec Connect Community: http://www.symantec.com/connect/blogs/zero­day­\nattack­ie6­jssykipot­doesn­t­spare­retired­software\n\nMalware Domains. (2012, January 16). Malware Domains. Retrieved January 30, 2012, from Malware Domains:\nhttp://mirror1.malwaredomains.com/updates/20120116.txt\n\nMalwareGroup.com. (n.d.). 209.53.155.244 | Ipaddress . Retrieved January 18, 2012, from MalwareGroup:\nhttp://www.malwaregroup.com/ipaddresses/details/209.53.155.244\n\nMcAfee Foundation Professional Services and McAfee Labs. (2011, February 10). Global Energy Cyberattacks:\n_\"Night Dragon\". Retrieved June 13, 2011, from McAfee: http://www.mcafee.com/us/resources/white­_\npapers/wp­global­energy­cyberattacks­night­dragon.pdf\n\nMcAfee Inc. (2011, December 22). Backdoor­FCQ ­ Malware ­ McAfee Labs Threat Center. Retrieved February 02,\n2012, from McAfee Labs Threat Center: http://www.mcafee.com/threat­\nintelligence/malware/default.aspx?id=670739\n\nMendoza, E. (2011). TROJ_INJECT.AMR | Low Risk | Trend Micro Threat Encyclopedia. Retrieved November 21,\n2011, from Trend Micro: http://about­\nthreats.trendmicro.com/malware/aspx?language=au&name=TROJ_INJECT.AMR\n\nMicrosoft. (2007, December 10). A description of Svchost.exe in Windows XP Professional Edition. Retrieved\nSeptember 07, 2011, from Microsoft Support: http://support.microsoft.com/?kbid=314056\n\nMicrosoft Corporation. (2011, September 07). Locales and Languages (Windows). Retrieved January 24, 2012,\nfrom Microsoft Software Development Network: http://msdn.microsoft.com/en­\nus/library/dd318716.aspx\n\nMicrosoft Corporation. (2011, September 07). OSVERSIONINFOEX structure. Retrieved January 17, 2012, from\nMicrosoft Software Development Network: http://msdn.microsoft.com/en­\nus/library/windows/desktop/ms724833(v=vs.85).aspx\n\nMicrosoft Corporation. (2011, September 07). SYSTEM_INFO structure. Retrieved January 24, 2012, from Microsoft\nMSDN: http://msdn.microsoft.com/en­us/library/windows/desktop/ms724958(v=vs.85).aspx\n\nPAGE 20 OF 29\n\n\n-----\n\nMullaney, C. (2011, July 30). Backdoor.Sogu Technical Details | Symantec. Retrieved August 18, 2011, from\nhttp://www.symantec.com/security_response/writeup.jsp?docid=2011­073003­5345­99&tabid=2\n\nParkour, M. (2011, July 05). contagio: Jul 5 CVE­2010­2883 PDF invitation.pdf with Poison Ivy from 112.121.171.94 |\n_pu.flower­show.org. Retrieved January 28, 2012, from Contagio:_\nhttp://contagiodump.blogspot.com/2011/07/message­targeting­experts­on­Japan.html\n\nParkour, M. (2011, July 14). Jul 13 CVE­2010­2883 PDF Meeting Agenda with more Poison Ivy www.adv138mail.com\n_| 112.121.171.94. Retrieved September 22, 2011, from Contagiodump Blog:_\nhttp://contagiodump.blogspot.com/2011/07/jul­13­cve­2010­2883­pdf­meeting­agenda.html\n\nRasmussen, R. (2011). Practical Usage of Passive DNS Monitoring for E­Crime Investigations. Retrieved January 04,\n2011, from http://conferences.npl.co.uk/satin/presentations/satin2011slide3­Rasmussen.pdf\n\nrbls. (2011, November 01). shenqi.travlman.com is not listed in any blacklists. Retrieved November 01, 2011, from\nrbls: http://rbls.org/shenqi.travlman.com\n\nSafeZoneCast. (2011, August 09). SafeZoneCast. Retrieved December 30, 2011, from\nhttp://safezonecast.lgcns.com/Common/MenaceInfo/pop.MenaceInfo.jsp?code=SZ1108­0003NS\n\nSandbox, G. (2010, December 26). GFI Sandbox Malware Analysis Report: Trojan­Downloader.Win32.Generic.\nRetrieved November 29, 2011, from GFI Sandbox:\nhttp://xml.ssdsandbox.net/view/3df0d0ab4ad9da4559a1c6464c8526d1\n\nshapeless. (n.d.). Poison Ivy 2.3.0 Documentation. Retrieved August 17, 2011, from Poison Ivy ­ Remote\nAdministration Tool: http://www.poisonivy­rat.com/dl.php?file=230docs\n\nSophos Ltd. (2011, November 25). Detailed Analysis ­ Troj/Agent­UDR ­ Viruses and Spyware ­ Threat Analyses ­\n_Threat Center ­ Sophos. Retrieved December 8, 2011, from Sophos: http://www.sophos.com/en­_\nus/threat­center/threat­analyses/viruses­and­spyware/Troj~Agent­UDR/detailed­analysis.aspx\n\nSophos Ltd. (2012, January 19). Detailed Analysis ­ Troj/Bdoor­BDM ­ Viruses and Spyware ­ Threat Analyses ­\n_Threat Center ­ Sophos. Retrieved January 31, 2012, from Sophos Threat Center:_\nhttp://www.sophos.com/en­us/threat­center/threat­analyses/viruses­and­spyware/Troj~BDoor­\nBDM/detailed­analysis.aspx\n\nSunbelt. (2009, October 15). Sunbelt CWSandbox Malware Analysis Report: Backdoor.Win32.Pasur. Retrieved\nDecember 19, 2011, from Sunbelt Security Sandbox:\nhttp://xml.ssdsandbox.net/archive/42e8163b7f08dd383e62e4bdb7f07c08\n\nSunbelt Security. (2009, May 03). Sunbelt CWSandbox Malware Analysis Report. Retrieved December 01, 2011,\nfrom Sunbelt Security Sandbox:\nhttp://xml.ssdsandbox.net/archive/70a88091e1f9a7bee246488cce79936a\n\nSunbelt Security. (2009, October 16). Sunbelt CWSandbox Malware Analysis Report: Trojan.Win32.Sisproc.\nRetrieved December 19, 2011, from Sunbelt Security Sandbox:\nhttp://xml.ssdsandbox.net/archive/3fdea18b9610cbc9b63ba7a44899fbfb\n\nSunbelt Security. (2010, December 31). CWSandbox Report by MD5 at Sunbelt Security. Retrieved October 25,\n2011, from Sunbelt Security:\nhttp://www.sunbeltsecurity.com/partnerresources/cwsandbox/md5.aspx?id=69ed8f7b0046956045a90\ne36e3c83f6a\n\nSunbelt Security. (2010, May 12). GFI SandBox Analysis Report. Retrieved February 07, 2012, from Sunbelt\nSecurity SandBox: http://xml.ssdsandbox/archive/5bc597e48270f04ec9b683432432e352\n\nPAGE 21 OF 29\n\n\n-----\n\nSunbelt Security. (2011, June 01). GFI SandBox Malware Analysis Report/ Trojan.Win32.Generic!SB. Retrieved\nJanuary 23, 2012, from GFI SandBox:\nhttp://xml.ssdsandbox.net/view/228191d05a09877f90c8b802617bb25f\n\nSymantec Corporation. (2010, March 11). Backdoor.Sykipot At Work. Retrieved February 02, 2012, from Symantec\nConnect Community: http://www.symantec.com/connect/blogs/backdoorsykipot­work\n\nSymantec Corporation. (2012, January 26). Insight into Sykipot Operations | Symantec Connect Community.\nRetrieved February 05, 2012, from Symantec Connect Community:\nhttp://www.symantec.com/connect/blogs/insight­sykipot­operations­0\n\nTelus. (2011, August 03). Backdoor.Win32.Murcy.A ­ TELUS Security Labs. Retrieved December 06, 2011, from\nTELUS Security Labs: http://telussecuritylabs.com/threats/show/TSL20110803­01\n\nThakur, V. (2011, December 14). The Sykipot Attacks | Symantec Connect Community. Retrieved February 04, 2012,\nfrom Symantec Connect Community: http://www.symantec.com/connect/blogs/sykipot­attacks\n\nThreat Expert Ltd. (2010, June 15). ThreatExpert Report. Retrieved January 11, 2012, from ThreatExpert:\nhttp://www.threatexpert.com/report.aspx?md5=b098aee16bd138c412075C9d315aefc9\n\nThreat Expert Ltd. (2011, July 26). ThreatExpert Report: Backdoor.Win32.Agent.anvj, Trojan­Downloader.Delphi.\nRetrieved December 17, 2011, from ThreatExpert:\nhttp://www.threatexpert.com/report.aspx?md5=3e3736dffedaf2a0ae4d948567933b3f\n\nThreat Expert Ltd. (2011, November 04). ThreatExpert report: Mal/Behav­027, Backdoor:Win32/Idicaf.gen!B.\nRetrieved November 25, 2011, from ThreatExpert:\nhttp://www.threatexpert.com/report.aspx?md5=229947cc71a4601b8b7794b402e536a9\n\nThreat Expert Ltd. (2011, October 06). ThreatExpert Report: Mal/Behav­027, Virus/Win32.Atraps.CK. Retrieved\nNovember 21, 2011, from ThreatExpert:\nhttp://www.threatexpert.com/report.aspx?md5=da2f98315f4c56fce21273e21e453b76\n\nThreat Expert Ltd. (2011, September 25). ThreatExpert Report: TrojanDropper: Win32/Idicaf.C,\n_Virus.Win32.Atraps.CK, Backdoor.Win32.Agent.bhxn. Retrieved December 25, 2011, from ThreatExpert:_\nhttp://www.threatexpert.com/report.aspx?md5=f4c08d3df5ede0790e34eae0c5db8a7a\n\nThreat Expert Ltd. (2008, December 18). ThreatExpert Report: Mal/EncPk­BL, Worm:Win32/Emerleox.J,\n_Packed.Win32.Klone.af. Retrieved January 15, 2012, from ThreatExpert:_\nhttp://www.threatexpert.com/report.aspx?md5=37037f674bcbbb7eef3889ab6eb30268\n\nThreatExpert Ltd. (2010, March 18). ThreatExpert Report: Troj/Agent­MSC, BinImage/Agent.283805. Retrieved\nJanuary 26, 2012, from ThreatExpert:\nhttp://www.threatexpert.com/report.aspx?md5=2d8a9038e151fb30d45ea8668afd2a8e\n\nThreatExpert Ltd. (2011, December 09). ThreatExpert Report: Backdoor.Win32.Delf.abow, Trojan.Win32.CDur,\n_Mal/Behav­058.. Retrieved February 03, 2012, from ThreatExpert:_\nhttp://www.threatexpert.com/report.aspx?md5=f0b848a841d4ef3406a6f9c4766c540b\n\nUS­CERT. (2011, March 26). Early Warning and Indicator Notice (EWIN)­11­077­01A UPDATE. Retrieved January\n06, 2011, from Incident Prevention and Detection: Protecting Information Security of National Banks:\nhttp://www.occ.treas.gov/news­issuances/alerts/2011/alert­2011­4b.pdf\n\nVerisign. (2011). Verisign Authentication Services. Retrieved December 29, 2011, from Verisign Class 3 Code\nSigning Certificate Revocation List: http://crl.verisign.com/CSC3­2009.crl\n\nPAGE 22 OF 29\n\n\n-----\n\nWard, E. (2011, July 31). Backdoor.Murcy | Symantec. Retrieved January 05, 2011, from Symantec:\nhttp://www.symantec.com/security_response/writeup.jsp?docid=2011­080105­2030­99\n\nWikipedia. (n.d.). List of Intel microprocessors. Retrieved January 21, 2012, from Wikipedia, the free encyclopedia:\nhttp://en.wikipedia.org/wiki/List_of_Intel_microprocessors\n\nWong, J. (2011, August 16). Encyclopedia entry:Backdoor.Win32/Thoper.A. Retrieved January 24, 2012, from\nMicrosoft Malware Protection Center:\nhttp://www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=Backdoor%3AWin\n32%2FThoper.A\n\nXTiger ­ Crackersoftware. (2011, February 14). All for Dream... Retrieved December 23, 2011, from xdoors.net:\nhttp://www.xdoors.net/faq/index.html\n\nXTiger. (2010, April 28). forum.xdoors.net. Retrieved December 19, 2011, from xdoors.net:\nhttp://forum.xdoors.net/viewtopic.php?f=4&t=7\n\nXTiger. (2011, March 16). forum.xdoors.net. Topic: X­Door/X­Shell free download paused. Retrieved December 27,\n2011, from forum.xdoors.net: http://forum.xdoors.net/viewtopic.php?f=5&t=76\n\nXTiger. (2011). Xdoors.net. Retrieved December 23, 2011, from All for dream...: http://www.xdoors.net\n\nXTiger. (n.d.). X­Shell. Retrieved December 23, 2011, from XDoors: http://www.xdoors.net/help/X­Shell.htm\n\nPAGE 23 OF 29\n\n\n-----\n\n**ANNEX A**\n\n**FORMAT OF OSVERSIONINFOEX STRUCTURE**\n\nOFFSET LENGTH (IN BYTES) MEMBER DESCRIPTION\n\n0 4 Structure size in bytes. ‘0x9C’ (156 bytes).\n\n4 4 OS major version.\n\n8 4 OS minor version.\n\n12 4 OS build number.\n\n16 4 An identifier for the OS platform.\n\n20 128 A null­terminated string that indicates the latest Service Pack installed.\n\n148 2 Service Pack major version number.\n\n150 2 Service Pack minor version number.\n\n152 2 A bit mask[91] that identifies the product suites installed on the system.\n\n154 1 Product type that indicates whether the system is a workstation (‘0x01’), a domain controller\n(‘0x02’) or an NT server but not a domain controller (‘0x03’).\n\n155 1 A byte reserved for future use.\n\n91 For a detailed description of the product suite bit mask refer to the Microsoft MSDN OSVERSIONINFOEX reference page. (Microsoft\nCorporation, 2011)\n\nPAGE 24 OF 29\n\n\n-----\n\n**ANNEX B**\n\n**FORMAT OF SYSTEM_INFO STRUCTURE**\n\nOFFSET LENGTH (IN BYTES) MEMBER DESCRIPTION\n\n0 2 A number indicating the processor architecture of the installed OS.\n\n2 2 Bytes reserved for future use.\n\n4 4 Page size used and the granularity of page protection and commitment.\n\n8 4 Minimum application address. This is the lowest memory address that applications and\nDLLs can access.\n\n12 4 Maximum application address. This is the highest memory address that applications\nand DLLs can access.\n\n16 4 A mask representing the set of processors configured into the system.\n\n20 4 The number of logical processors.\n\n24 4 Processor type.\n\n28 4 Granularity for the starting address at which virtual memory can be allocated.\n\n32 2 The architecture­dependent processor level.\n\n34 2 The architecture­dependent processor revision.\n\nPAGE 25 OF 29\n\n\n-----\n\n**ANNEX C**\n\n**SUMMARY OF X­SHELL COMMANDS**\n\nCOMMAND COMMAND DESCRIPTION\n\nsvc Service control (list/stop/start/view/install etc.).\n\npslist Lists processes.\n\npskill Kills process.\n\nshell Starts a command shell.\n\nreboot Restarts the computer.\n\nshutdown Shuts down the computer.\n\nfiletime Modifies timestamp on a file (date created etc.).\n\nuninstall Uninstalls RAT.\n\nmlist Gets process module specific information.\n\nidle Gets host mouse and keyboard idle time.\n\nuptime Gets system uptime.\n\nupdate Update plugin from URL.\n\nurlh Opens a URL in hidden view.\n\nurln Opens a URL in normal view.\n\nexeh Executes a program in hidden view.\n\nexen Executes a program in normal view.\n\nzip Compresses a file or folder to a Cab file.\n\nmhost Gets current Control Host IP address and port.\n\nfputs Uploads a file to the Control Host.\n\nfgets Downloads a file from the Control Host or a URL.\n\ninject Injects a plugin into another process. (The default process to inject into is ‘IEXPLORE.EXE’.)\n\npei Infects a portable executable file.\n\nper Repairs a portable executable file.\n\navinfo Displays information about installed antivirus software.\n\nhtan TCP port forwarding and mapping.\n\ndevcon Device manager.\n\nkeylog Keylogger control.\n\ncleanl Cleans event log.\n\ndisplay Displays control proxy.\n\nproxy HTTP proxy service.\n\nsocks5 SOCK5 proxy service.\n\ntcpagent TCP port forwarding.\n\nclipboard Clipboard control.\n\ntcplist Lists TCP connections.\n\ntcpkill Terminates a TCP connection.\n\nsysinfo Gets system information.\n\nspilist SPI layer information.\n\ncdrom Controls CD­ROM (open/close).\n\nsens Extracts sensitive information.\n\nrebind Rebinds TCP port to get password.\n\nPAGE 26 OF 29\n\n\n-----\n\nfport Displays port information with process path.\n\nuser User control (list/add/delete/ control etc.). Supports cloning and cloning check flood.\n\nflood Initiates a flood attack.\n\nterm Terminal management settings (viewport/setport/start/stop).\n\nfindpass Attempts to find current user’s login password.\n\nmyplug An interface to third­party developed plugins.\n\nPAGE 27 OF 29\n\n\n-----\n\n**ANNEX D**\n\n**SUMMARY OF MURCY COMMANDS**\n\nCOMMAND CODE COMMAND DESCRIPTION\n\n0x1003 Generate Sxl value from the registry key group.\n\n0x1004 Add Sxl description to registry key.\n\n0x2000 Lock computer.\n\n0x2001 Log off.\n\n0x2002 Reboot.\n\n0x2003 Shutdown.\n\n0x2004 Execute file.\n\n0x2005 Execute msg.exe.\n\n0x3000 Get system drive information.\n\n0x3001 File search.\n\n0x3003 File search.\n\n0x300A Create directory.\n\n0x300B Create process.\n\n0x300C Delete file(s).\n\n0x3200 Perform file operations.\n\n0x5000 Obtain process information.\n\n0x5002 Obtain process information.\n\n0x5004 Kill process.\n\n0x6000 List services.\n\n0x6002 Delete service.\n\n0x6003 Modify service configuration.\n\n0x6004 Start service.\n\n0x6005 Stop service.\n\n0x7000 Input/output generated in the process with a named pipe.\n\n0x8000 Get environment string.\n\nPAGE 28 OF 29\n\n\n-----\n\n**COPYRIGHT NOTICE**\n\nCopyright © Command Five Pty Ltd. All rights reserved.\n\nThis document is provided by the copyright holders under the licence\nthat follows. By obtaining, using, and/or distributing this document you\nagree that you have read, understood, and agree to the terms and\nconditions that follow.\n\nThe names and trademarks of Command Five Pty Ltd may not be\nused in advertising or publicity relating to this document or its contents\nwithout specific, prior, written permission.\n\nNo permission is given for this document to be used for commercial\npurposes or as part of any commercial activity or undertaking,\nincluding, but not limited to, use in or relating to advertising or\npublicity, and/or use in support of, or as part of, any pre­sales or sales\nactivities.\n\nNo permission is given to create modified or derivative works. You\nmay distribute this document in its original form for non­commercial\npurposes in accordance with the other terms and conditions stated\nherein. Copyright title will at all times remain with the copyright\nholders.\n\nAll referenced trademarks remain the property of their respective\nowners.\n\nTHIS DOCUMENT IS PROVIDED ‘AS IS’ FOR INFORMATIONAL\nPURPOSES ONLY WITH NO REPRESENTATIONS OR WARRANTIES OF\nANY KIND, INCLUDING BUT NOT LIMITED TO ANY WARRANTY,\nEXPRESS OR IMPLIED, OF MERCHANTABILITY OR FITNESS FOR A\nPARTICULAR PURPOSE; WARRANTY OF NON­INFRINGEMENT, OR\nTITLE; NOR ANY WARRANTIES PERTAINING TO THE ACCURACY OR\nCOMPLETENESS OF CONTENT.\n\nANY OPINIONS EXPRESSED IN THIS DOCUMENT MAY CHANGE\nWITHOUT NOTICE AND ARE NOT NECESSARILY THE CONSIDERED\nOPINIONS OF COMMAND FIVE PTY LTD, ITS PARTNERS, EMPLOYEES,\nOR AFFILIATE ORGANISATIONS. ANY ADVICE OFFERED IN THIS\nDOCUMENT IS OFFERED WITHOUT WARRANTY OF ANY KIND.\n\nCommand Five Pty Ltd\nABN: 49 149 576 670\n\nhttp://www.commandfive.com\ninfo@commandfive.com\n\nPAGE 29 OF 29\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/yfduvs6jw8w3ankhjkbi4ei5ykqho368",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2012/2012.02.03.Fifth_Domain_CnC/C5_APT_C2InTheFifthDomain.pdf"
    ],
    "report_names": [
        "C5_APT_C2InTheFifthDomain"
    ],
    "threat_actors": [
        {
            "id": "ea844ee6-eb12-42c0-8426-11395fe81e6f",
            "created_at": "2022-10-25T15:50:23.300796Z",
            "updated_at": "2025-03-27T02:00:55.434471Z",
            "deleted_at": null,
            "main_name": "Night Dragon",
            "aliases": [
                "Night Dragon"
            ],
            "source_name": "MITRE:Night Dragon",
            "tools": [
                "at",
                "gsecdump",
                "zwShell",
                "PsExec",
                "ASPXSpy",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dcba8e2b-93e0-4d6e-a15f-5c44faebc3b1",
            "created_at": "2022-10-25T16:07:23.816991Z",
            "updated_at": "2025-03-27T02:02:09.991944Z",
            "deleted_at": null,
            "main_name": "Lurk",
            "aliases": [],
            "source_name": "ETDA:Lurk",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "09a8f8fe-e907-47b4-8709-a97717dde3cc",
            "created_at": "2022-10-25T16:07:23.90252Z",
            "updated_at": "2025-03-27T02:02:10.020919Z",
            "deleted_at": null,
            "main_name": "Night Dragon",
            "aliases": [],
            "source_name": "ETDA:Night Dragon",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Cain & Abel",
                "gsecdump",
                "zwShell"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bbefc37d-475c-4d4d-b80b-7a55f896de82",
            "created_at": "2022-10-25T15:50:23.571783Z",
            "updated_at": "2025-03-27T02:00:55.502112Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "BRONZE BUTLER",
                "REDBALDKNIGHT"
            ],
            "source_name": "MITRE:BRONZE BUTLER",
            "tools": [
                "Mimikatz",
                "build_downer",
                "cmd",
                "ABK",
                "at",
                "BBK",
                "schtasks",
                "down_new",
                "Daserf",
                "ShadowPad",
                "Windows Credential Editor",
                "gsecdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "68cc6e37-f16d-4995-a75b-5e8e2a6cbb3d",
            "created_at": "2024-05-01T02:03:07.943593Z",
            "updated_at": "2025-03-27T02:05:17.259709Z",
            "deleted_at": null,
            "main_name": "BRONZE EDISON",
            "aliases": [
                "DarkSeoul",
                "Maverick Panda ",
                "Sykipot ",
                "TG-0623 ",
                "getkys",
                "APT4 "
            ],
            "source_name": "Secureworks:BRONZE EDISON",
            "tools": [
                " Wkysol",
                " ZxPortMap",
                "Gh0st RAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "020794ec-7315-47de-818c-2032c362fd15",
            "created_at": "2023-01-06T13:46:38.306576Z",
            "updated_at": "2025-03-27T02:00:02.800515Z",
            "deleted_at": null,
            "main_name": "Night Dragon",
            "aliases": [
                "G0014"
            ],
            "source_name": "MISPGALAXY:Night Dragon",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4ac28d1-66eb-4f2d-9f9b-a72394349fd0",
            "created_at": "2023-01-06T13:46:38.667954Z",
            "updated_at": "2025-03-27T02:00:02.887442Z",
            "deleted_at": null,
            "main_name": "APT4",
            "aliases": [
                "PLA Navy",
                "MAVERICK PANDA",
                "BRONZE EDISON",
                "SODIUM",
                "Salmon Typhoon"
            ],
            "source_name": "MISPGALAXY:APT4",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "6fbff48b-7a3e-4e54-ac22-b10f11e32337",
            "created_at": "2022-10-25T16:07:23.318008Z",
            "updated_at": "2025-03-27T02:02:09.734465Z",
            "deleted_at": null,
            "main_name": "APT 4",
            "aliases": [
                "APT 4",
                "Bronze Edison",
                "Maverick Panda",
                "Salmon Typhoo",
                "Sodium",
                "Sykipot",
                "TG-0623",
                "Wisp Team"
            ],
            "source_name": "ETDA:APT 4",
            "tools": [
                "Getkys",
                "Sykipot",
                "Wkysol",
                "XMRig"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041801,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/f8b1d371008a2108bb7ded054b7b0b7cdc4d5295.pdf",
        "text": "https://archive.orkl.eu/f8b1d371008a2108bb7ded054b7b0b7cdc4d5295.txt",
        "img": "https://archive.orkl.eu/f8b1d371008a2108bb7ded054b7b0b7cdc4d5295.jpg"
    }
}