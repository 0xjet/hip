{
    "id": "c714b813-0071-4c7e-ae7f-8594df8e4e7b",
    "created_at": "2023-01-12T15:02:08.298304Z",
    "updated_at": "2025-03-27T02:09:07.861049Z",
    "deleted_at": null,
    "sha1_hash": "9163da1f8455cab8a3a64453c6b473bcc423f7c3",
    "title": "2022-07-21 - Attackers target Ukraine using GoMet backdoor",
    "authors": "",
    "file_creation_date": "2022-08-18T03:31:29Z",
    "file_modification_date": "2022-08-18T03:31:29Z",
    "file_size": 882238,
    "plain_text": "# Attackers target Ukraine using GoMet backdoor\n\n**[blog.talosintelligence.com/2022/07/attackers-target-ukraine-using-gomet.html](https://blog.talosintelligence.com/2022/07/attackers-target-ukraine-using-gomet.html)**\n\n## Executive summary\n\nSince the Russian invasion of Ukraine began, Ukrainians have been under a nearly constant\nbarrage of cyber attacks. Working jointly with Ukrainian organizations, Cisco Talos has\ndiscovered a fairly uncommon piece of malware targeting Ukraine — this time aimed at a\nlarge software development company whose software is used in various state organizations\nwithin Ukraine. We believe that this campaign is likely sourced by Russian state-sponsored\nactors or those acting in their interests. As this firm is involved in software development, we\ncannot ignore the possibility that the perpetrating threat actor's intent was to gain access to\nsource a supply chain-style attack, though at this time we do not have any evidence that they\nwere successful. Cisco Talos confirmed that the malware is a slightly modified version of the\n[open-source backdoor named \"GoMet.\" The malware was first observed on March 28, 2022.](https://github.com/Laeeth/GoMet)\n\n## GoMet backdoor\n\nThe story of this backdoor is rather curious — there are two documented cases of its usage\nby sophisticated threat actors. First, in 2020, attackers were deploying this malware after the\n[successful exploitation of CVE-2020-5902, a vulnerability in F5 BIG-IP so severe that](https://blog.talosintelligence.com/2020/07/snort-rule-f5-rce-critical-vuln.html)\n[USCYBERCOM posted a tweet urging all users to patch the application. The second is more](https://twitter.com/CNMF_CyberAlert/status/1279151966178902016)\n\n\n-----\n\n[recent and involved the successful exploitation of](https://news.sophos.com/en-us/2022/06/15/sophos-uncovers-how-apt-groups-carried-out-highly-targeted-attack/) [CVE-2022-1040, a remote code execution](https://www.sophos.com/en-us/security-advisories/sophos-sa-20220325-sfos-rce)\nvulnerability in Sophos Firewall.\n\nBoth cases are very similar. They both start with the exploitation of a public vulnerability on\nappliances where the malicious actors then dropped GoMet as a backdoor. As of publishing\ntime, Cisco Talos has no reason to believe these cases are related to the usage of this\nbackdoor in Ukraine.\n\nThe original GoMet author posted the code on GitHub on March 31, 2019 and had commits\nuntil April 2, 2019. The commits didn't add any features but did fix some code convention\naesthetics. The backdoor itself is a rather simple piece of software written in the Go\nprogramming language. It contains nearly all the usual functions an attacker might want in a\nremotely controlled agent. Agents can be deployed on a variety of operating systems (OS) or\narchitectures (amd64, arm, etc.). GoMet supports job scheduling (via Cron or task scheduler\ndepending on the OS), single command execution, file download, file upload or opening a\nshell. An additional notable feature of GoMet lies in its ability to daisy chain — whereby the\nattackers gain access to a network or machine and then use that same information to gain\naccess to multiple networks and computers — connections from one implanted host to\nanother. Such a feature could allow for communication out to the internet from otherwise\ncompletely \"isolated\" hosts.\n\nThis version was changed by malicious actors, in the original code, the cronjob is configured\nto be executed once every hour on the hour. In our samples, the cronjob is configured to run\nevery two seconds. This change makes the sample slightly more noisy since it executes\nevery two seconds, but also prevents an hour-long sleep if the connection fails which would\nallow for more aggressive reconnection to the C2.\n\nThe objective of the cron job defined in the main part of the malware is to check if it's\nconnected to the C2, if not it will start the agent component again and connect to the C2. The\npicture below shows the execution flow of the C2 setup routine Agent.Start.\n\n\n-----\n\nThis flow reveals another change to the GitHub versions. If the C2 is unreachable, the\nsample will sleep for a random amount of time between five and 10 minutes. GO's sleep\nimplementation uses nanoseconds. The Pseudo Code would look like the following:\ntime_Sleep(1000000000 * (rnd_val + 300)).\n\nThe 'WaitGroup_Add' call in the disassembly screenshot can also be confusing. The trick is,\nthe Go compiler is changing the source code WaitGroup.Done() to WaitGroup.Add(-1).\n\nAfter the Agent.start routine is done, the next cron job triggered the execution of the serve()\nroutine and tried to start another instance of the Agent.\n\nThe simplified source code of the GitHub version looks like this:\n\n\n-----\n\nThe simplified pseudo-code for the samples in the wild looks like this:\n\n\n-----\n\nTalos found two samples of this version of the backdoor:\n\nf24158c5132943fbdeee4de4cedd063541916175434f82047b6576f86897b1cb (FctSec.exe)\n\n950ba2cc9b1dfaadf6919e05c854c2eaabbacb769b2ff684de11c3094a03ee88\n(SQLocalM86.exe)\n\nThese samples have minor differences but are likely built from the same source code, just\nwith a slightly different configuration.\n\nIf we look closely at the functions, they are not 100% equal, but we can see that the changes\nare mainly strings and similar victim or compiler-dependent data, along with researcher\ncomments. Below is the Main.Main function as an example.\n\n\n-----\n\nThe malicious activity we detected included a fake Windows update scheduled tasks created\nby the GoMet dropper. Additionally, the malware used a somewhat novel approach to\npersistence. It enumerated the autorun values and, instead of creating a new one, replaced\none of the existing goodware autorun executables with the malware. This potentially could\navoid detection or hinder forensic analysis.\n\nIn one of the cases, about 60 seconds before the schtask query is executed, a blank CMD\nprocess is opened and then subsequently executes systeminfo and schtask queries rather\nthan these queries being chain opened by svchost or services or another process. This\nexecution looks like:\n\nC:\\WINDOWS\\system32\\cmd.exe 7)\n\nsysteminfo\n\nschtasks /query /tn microsoft\\windows\\windowsupdate\\scheduled\n\nschtasks /query /tn microsoft\\windows\\windowsupdate\\scheduled /v\n\n## Infrastructure\n\n\n-----\n\nBoth samples have the command and control (C2) IP address hardcoded, which is\n111.90.139[.]122. Communication occurs via HTTPS on the default port.\n\nThe certificate on this server was issued on April 4, 2021 as a self-signed certificate, with the\n9b5e112e683a3605c9481d8f565cfb3b7e2feab7 SHA-1 fingerprint. This indicates that this\ncampaign preparation began as early as April 2021. At the moment, there are no known\ndomains associated with this IP address and the last time there was a domain associated\nwith it was on Jan. 23, 2021, which is outside the known attack time frame.\n\n## Conclusion\n\nAs the war in Ukraine rages on with little resolution in sight, we are reminded that attackers\nwill try just about anything to gain additional leverage over their Ukrainian adversaries. Cisco\nTalos expects to see the continued deployment of a range of cyber weapons targeting the\nUkrainian government and its counterparts. We remain vigilant and are committed to helping\nUkraine defend its networks against such cyber attacks and working closely with our\n[strategic allies in the region to gather and provide actionable threat intelligence.](https://blog.talosintelligence.com/2022/02/current-executive-guidance-for-ongoing.html)\n\nIn this instance, we saw a software company targeted with a backdoor designed for\nadditional persistent access. We also observed the threat actor take active steps to prevent\ndetection of their tooling by obfuscating samples and utilizing novel persistence techniques.\nThis access could be leveraged in a variety of ways, including deeper access or launching\nadditional attacks, including the potential for software supply chain compromise. It's a\nreminder that although the cyber activities haven't necessarily risen to the level many have\nexpected, Ukraine is still facing a well-funded, determined adversary that can inflict damage\nin a variety of ways — this is just the latest example of those attempts.\n\nWe assess with moderate to high confidence that these actions are being conducted by\nRussian state-sponsored actors or those acting in their interests.\n\n## Coverage\n\nWays our customers can detect and block this threat are listed below.\n\n\n-----\n\n[Cisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/index.html)\n[execution of the malware detailed in this post. Try Secure Endpoint for free here.](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/free-trial.html?utm_medium%3Dweb-referral?utm_source%3Dcisco%26utm_campaign%3Damp-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Damp-free-trial)\n\n[Cisco Secure Web Appliance web scanning prevents access to malicious websites and](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\ndetects malware used in these attacks.\n\n[Cisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by](https://www.cisco.com/c/en/us/products/security/email-security/index.html)\nthreat actors as part of their campaign. You can try Secure Email for free [here.](https://www.cisco.com/c/en/us/products/security/cloud-mailbox-defense?utm_medium%3Dweb-referral%26utm_source%3Dcisco%26utm_campaign%3Dcmd-free-trial-request%26utm_term%3Dpgm-talos-trial)\n\n[Cisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\nsuch as [Threat Defense Virtual,](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw-virtual/datasheet-c78-742858.html) [Adaptive Security Appliance and](https://www.cisco.com/c/en/us/products/security/adaptive-security-appliance-asa-software/index.html) [Meraki MX can detect](https://meraki.cisco.com/products/appliances)\nmalicious activity associated with this threat.\n\n\n-----\n\n[Cisco Secure Network/Cloud Analytics (Stealthwatch/Stealthwatch Cloud) analyzes network](https://www.cisco.com/c/en/us/products/security/stealthwatch/index.html)\ntraffic automatically and alerts users of potentially unwanted activity on every connected\ndevice.\n\n[Cisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds](https://www.cisco.com/c/en/us/products/security/threat-grid/index.html)\nprotection into all Cisco Secure products.\n\n[Umbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs and URLs, whether users are on or off the corporate network. Sign up for a\n[free trial of Umbrella here.](https://signup.umbrella.com/?utm_medium%3Dweb-referral?utm_source%3Dcisco%26utm_campaign%3Dumbrella-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Dautomated-free-trial)\n\n[Cisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\npotentially dangerous sites and tests suspicious sites before users access them.\n\nAdditional protections with context to your specific environment and threat data are available\nfrom the [Firewall Management Center.](https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html)\n\n[Cisco Duo provides multi-factor authentication for users to ensure only those authorized are](https://signup.duo.com/?utm_source%3Dtalos%26utm_medium%3Dreferral%26utm_campaign%3Dduo-free-trial)\naccessing your network.\n\nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\n## Indicators of Compromise\n\n### SHA-256 Hashes\n\nf24158c5132943fbdeee4de4cedd063541916175434f82047b6576f86897b1cb\n\n950ba2cc9b1dfaadf6919e05c854c2eaabbacb769b2ff684de11c3094a03ee88\n\n### IPs\n\n111.90.139[.]122\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-21 - Attackers target Ukraine using GoMet backdoor.pdf"
    ],
    "report_names": [
        "2022-07-21 - Attackers target Ukraine using GoMet backdoor.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535728,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1660793489,
    "ts_modification_date": 1660793489,
    "files": {
        "pdf": "https://archive.orkl.eu/9163da1f8455cab8a3a64453c6b473bcc423f7c3.pdf",
        "text": "https://archive.orkl.eu/9163da1f8455cab8a3a64453c6b473bcc423f7c3.txt",
        "img": "https://archive.orkl.eu/9163da1f8455cab8a3a64453c6b473bcc423f7c3.jpg"
    }
}