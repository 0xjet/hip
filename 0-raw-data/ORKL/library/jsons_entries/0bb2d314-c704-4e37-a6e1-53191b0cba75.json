{
    "id": "0bb2d314-c704-4e37-a6e1-53191b0cba75",
    "created_at": "2022-10-25T16:48:19.294119Z",
    "updated_at": "2025-03-27T02:09:38.836047Z",
    "deleted_at": null,
    "sha1_hash": "c9534efcbf1a9c020ba864ee090e0c0b03d32181",
    "title": "TRISIS Malware",
    "authors": "Dragos",
    "file_creation_date": "2017-12-13T14:00:36Z",
    "file_modification_date": "2017-12-13T14:00:40Z",
    "file_size": 5162733,
    "plain_text": "# TRISIS Malware\n### Analysis of Safety System Targeted Malware\n\n###### Dragos Inc. www.dragos.com\n\n\n-----\n\ny\n##### Executive Summary\n\nIn mid-November 2017, the Dragos, Inc. team discovered ICS-tailored malware deployed against at least\none victim in the Middle East. The team identifies this malware as TRISIS because it targets Schneider Elec­\ntric’s Triconex safety instrumented system (SIS) enabling the replacement of logic in final control elements.\nTRISIS is highly targeted and likely does not pose an immediate threat to other Schneider Electric custom­\ners, let alone other SIS products. Importantly, the malware leverages no inherent vulnerability in Schneider\nElectric products. However, this capability, methodology, and tradecraft in this very specific event may now\nbe replicated by other adversaries and thus represents an addition to industrial asset owner and opera­\ntors’ threat models.\n\n##### Why Are We Publishing This?\n\nThe Dragos team notified our ICS WorldView customers immediately after validating the malicious nature\nof the software. Following that notification, the team sent a notification to the U.S. Department of Home­\nland Security, Department of Energy, Electric Sector Information Sharing Analysis Center (E-ISAC), and part­\nners. We broadcasted to our customers and partners that we would not be releasing a public report until\nthe information became public through other channels. It is Dragos’ approach around industrial threats to\nnever be the first to identify new threats publicly; infrastructure security is a highly sensitive matter and the\nmore time the infrastructure community has to address new challenges without increased public attention\nis ideal. Dragos’ focus is on keeping customers informed and ideally keeping sensitive information out of\nthe public where the narrative can be quickly lost and sensationalized. However, once information about\nthreats or new capabilities are made public, it is Dragos’ approach to follow-up with public reports that\ncapture the nuance to avoid hype while reinforcing lessons learned and advice to the industry.\n\n\n-----\n\ny\n##### Key Take-Aways\n\n - The malware targets Schneider Electric’s Triconex safety instrumented system (SIS) thus the name\nchoice of TRISIS for the malware.\n\n - TRISIS has been deployed against at least one victim.\n\n - The victim identified so far is in the Middle East, and currently, there is no intelligence to support that\nthere are victims outside of the Middle East.\n\n - The Triconex line of safety systems are leveraged in numerous industries - however, each SIS is unique\nand to understand process implications would require specific knowledge of the process. This means\nthat this is not a highly scalable attack that could be easily deployed across numerous victims without\nsignificant additional work.\n\n - The Triconex SIS Controller was configured with the physical keyswitch in ‘program mode’ during op­\neration. If the controller is placed in Run mode (program changes not permitted), arbitrary changes in\nlogic are not possible substantially reducing the likelihood of manipulation.\n\n - Although the attack is not highly scalable, the tradecraft displayed is now available as a blueprint to\nother adversaries looking to target SIS and represents an escalation in the type of attacks seen to date\nas it is specifically designed to target the safety function of the process.\n\n - Compromising the security of an SIS does not necessarily compromise the safety of the system. Safety\nengineering is a highly specific skill set and adheres to numerous standards and approaches to ensure\nthat a process has a specific safety level. As long as the SIS performs its safety function the compro­\nmising of its security does not represent a danger as long as it fails safe.\n\n - It is not currently known what exactly the safety implications of TRISIS would be. Logic changes on the\nfinal control element implies that there could be risk to the safety as set points could be changed for\nwhen the safety system would or would not take control of the process in an unsafe condition\n\n\n-----\n\ny\n##### SIS Background\n\nSafety systems are those control systems, often identified as Safety Instrumented Systems (SIS), maintain­\ning safe conditions if other failures occur. It is not currently known what the specific safety implications of\nTRISIS would be in a production environment. However, alterations to logic on the final control element\nimply that there could be a risk to operational safety. Set points on the remainder of the process control\nsystem could be changed to conditions that would result in the process shifting to an unsafe condition.\nWhile TRISIS appears to be focused, ICS owners and operators should view this event as an expansion of\nICS asset targeting to previously-untargeted SIS equipment. Although many aspects of TRISIS are unique\nfor the environment and technology targeted, the general methodology provides an example for ICS de­\nfenders to utilize when future, subsequent SIS-targeted operations emerge.\n\nSafety controllers are designed to provide robust safety for critical processes. Typically, safety controllers\nare deployed to provide life-saving stopping logic. These may include mechanisms to stop rotating machin­\nery when a dangerous condition is detected, or stop inflow or heating of gasses when a dangerous tem­\nperature, pressure, or other potentially life-threatening condition exists. Safety controllers operate inde­\npendently of normal process control logic systems and are focused on detecting and preventing dangerous\nphysical events. Safety controllers are most often connected to actuators which will make it impossible for\nnormal process control systems to continue operating. This is by design since the normal process control\nsystem’s continued operation would feed into the life-threatening situation that has been detected.\n\nSafety controllers are generally a type of programmable logic controller (PLC). They allow engineers to con­\nfigure logic, typically in IEC-61131 logic. While on their face they are similar to PLCs, safety controllers have\na higher standard of design, construction, and deployment. They are designed to be more accurate and\nless prone to failure. Both the hardware and the software for these controllers must be designed and built\nto the Safety Integrity Level (SIL) blanket of standards (IEC-61508). This includes the use of error correcting\nmemories and redundant components and design that favors failing an operation safety over continuing\noperations. Each SIS is deployed for specific process requirements after a process hazard analysis (PHA)\nidentifies the needs for a specific industrial environment. In this way, the systems are unique in their im­\nplementation even when the vendor technology remains the same.\n\nSafety controller components have more flexibility than a typical PLC. A safety controller’s output cards will\nusually have a firmware, and a configuration, which allows the output card to fail into a safe state should\nthe main processors fail entirely. This may even include failing outputs to a known-safe state in the event\nthat the safety controller loses power.\n\nMany safety controllers offer redundancy, in the form of redundant processor modules. In the case of the\nTriconex system, the controller utilizes three separate processor modules. The modules all run the same\nlogic, and each module is given a vote on the output of its logic function blocks on each cycle. If one of the\nmodules offers a different set of outputs from the other two, that module is considered faulted and is au­\ntomatically removed from service. This prevents a module that is experiencing an issue such as an internal\ntransient or bit-flip from causing an improper safety decision.\n\n\n-----\n\ny\nSafety controller architecture has been debated in the industry. Many end users opt to use the same con­\ntrol LAN for both systems. LOGIIC (Linking the Oil and Gas Industry to Improve Cybersecurity) has identi­\nfied[1] three distinct integration strategies of SIS with control systems networks. In the case of attacks such\nas TRISIS, these architectures can be reduced to two, as the security implications of two identified archi­\ntectures remain the same. End users decide the level of risk that they are willing to accept with their safety\nsystem, and use this to determine how tightly they couple their safety system with their DCS (Distributed\nControl System). A tightly-coupled architecture, shown in figure 1, can provide cost savings, since data from\nan SIS controller may be incorporated into general operator HMI systems. In addition, network wiring and\nsupport is shared between the systems. Sensors data may also be shared, in both directions, between the\nnormal process controllers and the SIS controllers. However, a downside to such an architecture is that\nattacker who gains access to the Control LAN systems may attack the SIS directly.\n\nFigure 1: Typical (Insecure) SIS integration\n\n|DCS HMI/ DCS EWS/ DCS EWS/ DCS OPC/ SIS EWS/ Operator Terminal Engineering Station Remote Station Application Server Safety Eng Station|Col2|Col3|\n|---|---|---|\n||L2 Process LAN||\n\n\nDCS Controller\n\n\nSIS Controller\n\n\nActuators & Sensors Actuators & Sensors\n\n1 Cyber Security Implications of SIS Integration with Control Networks\n\nhttps://www.automationfederation.org/filestore/af/logiic/LOGIIC%20SIS%20REPORT%20for%20ISA%20August%2025%20\n\n2011%20mod%20jan%202013.pdf\n\n\n-----\n\ny\nThis architecture can be especially dangerous when combined with engineering remote access. A common\npractice at many sites is to allow access to the process control network to engineers via the Remote Desk­\ntop Protocol. The engineer will most frequently use their corporate workstation to access an RDP jump box\ninside of the process control DMZ. From there, the engineering may RDP to either the L3 or L2 process LAN.\nCompromise of this process, either through an infected corporate workstation or theft of the engineer’s\ncredentials, can give an attacker access to the L2 engineering systems. In the case of a tightly integrated\nDCS and SIS, the attacker then has access to all services of the SIS, including the programming service. The\nattacker may also be able to gain access to the SIS Engineering Station and gain a better understanding of\nhow the SIS is programmed.\n\nFigure 2: Architecture with application-layer ‘Read-Only’ firewall between L2 and SIS LAN\n\nDMZ LAN\n\nHistorian/ RDP Jump Box/ Patch Management\nData Replication Remote Station\n\nL3 Process LAN\n\nHistorian OPC Server RDP Jump Box/ Domain Controller\nRemote Station\n\nDCS HMI/ DCS EWS/ DCS EWS/ DCS OPC/ SIS EWS/\nOperator Terminal Engineering Station Remote Station Application Server Safety Eng Station\n\n|DCS HMI/ DCS EWS/ DCS EWS/ DCS OPC/ Operator Terminal Engineering Station Remote Station Application Se|Col2|\n|---|---|\n||L2 Process LAN|\n\n\nDCS Controller\n\n\nSIS Controller\n\n\nActuators & Sensors Actuators & Sensors\n\n\n-----\n\ny\nAlternate architectures have been suggested. Many security-conscious asset owners will instrument their\nSIS Controller with a ‘read-only’ application-layer firewall as shown in figure 2. These firewalls typically sup­\nport protocols such as Modbus/TCP or OPC and are specifically designed to prevent the assertion of safety\noutputs from the process LAN. These firewalls will also prevent access to the proprietary configuration\nservices of the SIS, closing that avenue of attack. Placing both the SIS Engineering Workstation (EWS) and\nSIS Controllers on the secure side of this firewall will prevent easy access to the SIS programming proto­\ncols. In this architecture, an attacker who gains access to the L2 LAN will not be able to impact the safety\nsystem, unless the attacker also identifies a weakness in the firewall protecting the SIS from the rest of the\nL2 Process LAN. A downside of this architecture is that an engineer will need to physically access the SIS\nworkstation to make changes to the safety programming. However, SIS programming changes should be\nmuch less frequent than normal DCS updates.\n\nOther methods use data diodes or completely separate safety networks which provide data to the DCS via\na DC Controller add-on card. These mechanisms further increase security, although in the case of a com­\npletely separate safety network, prevent end users from using potentially valuable safety sensor data for\nordinary process control.\n\nA potential attack on SIS can have multiple implications. Two that immediately come to mind and represent\nmost-likely targets include the following scenarios:\n\n###### Attack Scenario #1: Plant Shutdown\n\nThe most likely and operationally easy impact scenario from SIS manipulation or attack is a plant shut­\ndown – and not necessarily due to follow-on physical damage as the result of SIS alteration. There are two\ngeneral methods of achieving an operational ‘mission kill’ without physically impacting any element of the\ntarget environment:\n\n1. Create operational uncertainty. By altering an SIS where some noticeable effect is produced, even\n\nif only recognizing a configuration change or tripping a safety fault where no corresponding phys­\nical condition is observed, doubt is introduced into operations as to safety system accuracy and\nreliability. While the problem is investigated and troubleshooting takes place, operations will like­\nly be significantly reduced if not outright stopped.\n\n2. Trip safety ‘fail-safes’ to halt operations. Changing underlying logic to enter safety-preserving\n\nconditions during normal operations can trip SIS-managed equipment to enter ‘fail-safe’ modes\nwhen such conditions are not actually present. This will lead to a likely halt or stop to the affected\nprocess, and likely bring about a much longer shutdown as this scenario rapidly transitions to the\nitem outlined in no. 1 above due to extensive troubleshooting.\n\nSome level of general and plant-specific knowledge is required in order to execute this attack, but the level\nof knowledge is not as extensive as more fine-toothed, subtle changes to SIS configuration. Simply intro­\nducing any noticeable change in the system – which may, through unintended follow-on effects, result in\na much more serious issue – results at least in case #1. A slightly more refined approach focusing on spe­\ncific logic and devices managed can be used to create case #2. Alternatively, an adversary can attempt to\nleverage insecure authentication to pull existing configuration information from the SIS and simply reverse\nvalues to cause safety faults where none exist.\n\n\n-----\n\ny\n###### Attack Scenario #2: Unsafe Physical State\n\nLikely the most obvious and assumed attack scenario is creating an unsafe physical condition within the\ntarget environment resulting in physical damage to the environment. While this may be the most obvious\nconceptual attack, the requirements for actually executing make this scenario significantly more difficult –\nand thus less likely in reality – than scenario #1.\n\nEnsuring an SIS alteration results in physical damage or destruction requires knowledge of the underlying\nphysical processes and controls managed by the targeted SIS. More specifically, knowledge of specific pro­\ncess points where removing a logical fail-safe at the SIS will result in an uncontrolled, damaging physical\nstate – with no complementary physical safety fail-safe in place to prevent damage. The amount of knowl­\nedge required specific to the SIS and process installation targeted is significant, and likely not possible to\nobtain through purely network espionage means. If even possible, the amount of time, effort, and resourc­\nes required to: obtain necessary environment information; develop and design software tailored to the\ntarget environment; and finally, to maintain access and avoid detection throughout these steps all require\na lengthy, highly skilled intrusion.\n\nWhile the above is certainly not impossible – in many ways, it is analogous to the efforts required to launch\nCRASHOVERRIDE – the combined requirements make this a less-likely scenario attainable only by high­\nly-skilled, well-resourced adversaries with lengthy timelines. Typical operations safety layering, where SIS\nforms only part (albeit a large one) in overall safety management, should work to mitigate the worst-case\ndamage a destruction scenario in most instances.\n\n\n-----\n\ny\n##### SIS Defense Status\n\nIn theory, SIS equipment is isolated from other operations within the ICS environment, and network con­\nnectivity is either extremely limited or non-existent. In practice, operational and convenience concerns of­\nten result in more connectivity with other ICS devices than ideal, or that ICS operators may even be aware\nof. An operator may choose to connect a safety controller to their wider plant network in order to retrieve\ndata from the controller to facilitate business intelligence and process control information gathering. This\ncarries the risk that the safety controller may be affected by malicious network activity, or accessible to an\nintruder that has penetrated the ICS network.\n\nSafety controllers generally have the same security profile as a standard PLC. Controller projects offer\npassword protection; however, projects typically contain two backdoor accounts by default that the user\nhas no control over. While suboptimal from a security perspective, such accounts are vital to ensure ad­\nministrator-level access and control over the device in an emergency situation. A reverse engineer with\nmoderate skill may uncover these accounts and use them to gain unauthorized access to the project and\nto the safety controller.\n\nWhile common to many SIS devices, the newer versions of Schneider Electric’s Triconex units are not sus­\nceptible to this attack. The older controller (which was deployed at the victim site) is protected by following\nthe deployment recommendations, listed below, to prevent arbitrary changes in SIS functionality via a\nphysical control. Newer model controllers removed the backdoor accounts entirely and added X.509 mu­\ntual authentication to the controllers.\n\nExamining SIS devices generally, backdoor accounts cannot typically be disabled due to the operational\nneed for the reasons outlined above. SIS network isolation is critical in preventing abuse of this feature in\nvulnerable devices it is appropriate to monitor connections to such systems more so than blocking activity\nwithout an understanding of the impact.\n\n##### TRISIS Capabilities\n\nTRISIS is a Stage 2 ICS Attack capability, as defined by the ICS Cyber Kill Chain as shown in figure 3. Given its\ndesign and assessed use, TRISIS has no role or applicability to IT environments and is a focused ICS effects\ntool. As a result, TRISIS’ use and deployment requires that an adversary has already achieved success in\nStage 1 of the ICS Cyber Kill Chain and either compromised the business IT network or has identified an\nalternative means of accessing the ICS network. Once in position, the adversary can deploy TRISIS on its\ntarget: an SIS device.\n\n\n-----\n\ny\n\n\nFigure 3: ICS Cyber Kill-Chain\n\n### Weaponization\n\n**STAGE 1**\n\n**STAGE 2**\n\n\nSTAGE\n### Delivery 01\n\n\nSTAGE\n### Install / Modify 01\n\n\nSTAGE\n### Test 02\n\n\nSTAGE\n### Reconnaissance 01\n\n\nSTAGE\n### C2 01\n\n\nSTAGE\n### Deliver 02\n\n\nSTAGE\n### Targeting 01\n\n\n-----\n\ny\n\nTRISIS is a compiled Python script using the publicly-available ‘py2exe’ compiler. This allows TRISIS to ex­\necute in an environment without Python installed natively, which would be the case in most ICS environ­\nments and especially in SIS equipment. The script aims to change the underlying logic on a target SIS – in\nthis case, a Schneider Electric Triconex device. Subsequent code analysis indicated the script is designed\nto target Triconex 3008 processor modules specifically. The executable takes its target as a command-line\nargument passed to it on execution. The implications of this are specifically in targeting at run-time, unless\ncalled through an additional script, and based on a review of the code, limiting TRISIS to impacting a single\ntarget per execution.\n\nThe core logic alteration functionality works through a combination of four binaries that are uploaded to\nthe target SIS:\n\n     - Two embedded binary payloads within the compiled Python script.\n\n     - Two additional, external binaries that are specifically referenced by name within the script but\nlocated in separate files.\n\nDragos analysis indicates that the embedded items are used to prepare and load the external modules,\nwhich contain the replacement logic. As part of a general attack flow, an adversary would need to take the\nfollowing steps to deploy and execute TRISIS as shown in figure 4 on the next page.\n\n\nfollowing steps to deploy and execute TRISIS as shown in figure 4 on the next page.\n\n\n-----\n\n**Completion of Stage 1 of the ICS Cyber Kill Chain:**\n\nIdentify and gain access to a system able to commu­\nnicate with target SIS.\n\n**Stage 2 Develop:**\n\nIdentify target SIS type and develop TRISIS with re­\nplacement logic and loader\n\n**Stage 2 Test:**\n\nEnsure TRISIS works as intended, likely off network in\nthe adversary environment\n\n**Stage 2 Deliver:**\n\nTransfer TRISIS to the SIS which contains the ‘loader’\nmodule for the new logic and support binaries that\nprovide the new logic\n\n**Stage 2 Install/Modify:**\n\nUpon running the TRISIS executable, disguised as\nTriconex software for analyzing SIS logs, the mali­\ncious software utilizes the embedded binary files to\nidentify the appropriate location in memory on the\ncontroller for logic replacement and uploads the ‘ini­\ntializing code’ (4-byte sequence)\n\n**Stage 2 Execute ICS Attack:**\n\nTRISIS verifies the success of the previous step and\nthen uploads new ladder logic to SIS\n\n\ny\n\nFigure 4: TRISIS Attack Flow\n\n\nStep 2: Identify Memory Location for\nStep 1: Verify Communications to SIS\nLogic Upload\n\n\nStage 1 of the ICS Cyber Kill Chain Completed\n\n\nStep 1: Verify Communications to SIS\n\n\n-----\n\ny\n\nBased on the description above, TRISIS itself represents a facilitating capability or framework for the actual\nladder logic change that has the potential, as outlined in the scenarios above, to alter the environment. As\nsuch, TRISIS itself could be repurposed to deliver alternative payloads to either deliver different logic files\n(the external binaries uploaded by TRISIS to the target SIS) or to utilize differently embedded binaries to\ntarget different SIS types entirely. While both are quite plausible, the work involved would be significant\nand represents the largest amount of effort and required resources for TRISIS efficacy: ensuring that the\nembedded binaries identify the correct portion of SIS memory for replacement ladder logic upload, and\nthen developing appropriate ladder logic for the target system. Neither of these is trivial, and make scaling\nor spreading this attack to other environments – and potentially the same Triconex devices but in different\ninstallations – extremely difficult.\n\nDragos was not provided with the external binaries used in the TRISIS attack, and we are therefore unable\nto determine what precise impact would result on the victim SIS. Nonetheless, any modification to SIS in\nan operational environment represents a significant risk and potential for damage or even loss of life. The\nprecise attack path is also unknown at this time, but based upon available information and functionality of\nTRISIS, the target SIS must be network accessible from a device the adversary was able to compromise and\nestablish reasonably persistent command and control over. As a result, TRISIS activity – from initial instal­\nlation through periodic control followed by ultimate payload delivery – represents multiple steps across\nStages 1 and 2 of the ICS Cyber Kill Chain.\n\nWhile TRISIS as a Python program allows for some level of flexibility in that different modules could be ref­\nerenced or included to provide different effects, as an attack vector such alterations are difficult to execute\nin practice for the reasons outlined above. As such, TRISIS is a very focused, target-specific malware that\nwould not be capable of delivering equivalent effects in another environment without significant modifi­\ncation.\n\nAn additional point to emphasize is that no real vulnerability or exploit is utilized by TRISIS. Rather, TRISIS\nfunctionality depends upon understanding how Triconex SIS devices function and specifics about the pro­\ncess environment. With a full understanding of these items, the adversary then must design and deploy\nladder logic to create the desired impact on the target SIS.\n\n\n-----\n\ny\n\n##### Implications\n\nTRISIS represents, in several ways, ‘game-changing’ impact for the defense of ICS networks. While previ­\nously identified in theoretical attack scenarios, targeting SIS equipment specifically represents a danger­\nous evolution within ICS computer network attacks. Potential impacts include equipment damage, system\ndowntime, and potentially loss of life. Given these implications, it is important to ensure nuance in how the\nindustry responds and communicates about this attack.\n\nFirst, adversaries are becoming bolder, and an attack on an SIS is a considerable step forward in causing\nharm. This requires the industry to continue its focus on reliability and safety by pursuing appropriate and\nmeasured steps towards securing industrial processes. Information technology security best practices are\nnot necessarily appropriate to such situations and an ICS, and a mission-focused approach must be taken\ninto consideration of secondary effects.\n\nSecond, the attack of an SIS cannot be taken lightly but should not be met with hype and fear. Eventually,\ninformation about this attack will leak to the media and public community. At that point, those in the in­\ndustrial security community can have a nuanced conversation noting that this attack is not a highly scalable\nattack that has immediate repercussions to the community. Or simply stated, the public nor government\nshould invoke fear. The industrial asset owner, operator, and vendor community have had a significant\ndedication to safety and reliability, and now it is obvious that the community is taking steps forward in se­\ncurity. Dragos cautions the community not to use this attack to further other causes as the impact of hype\ncan be far-reaching and crippling. TRISIS is a learning moment to push for more security but in a proper\nand measured way.\n\nThird, this attack does have implications for all industrial asset owners and operators that leverage SIS. The\nfact that Schneider Electric’s Triconex was targeted should have no bearing on how defenders respond to\nthis case. This was a clear attack on the community. There can be no victim blaming or product shaming\nthat is reasonable nor will it make the community better. The implication is that adversaries are targeting\nSIS and defenders must live in this reality presented adapting as appropriate to ensure safety and reliability\nof the operations our society depend upon.\n\n\n-----\n\ny\n\n##### Defending Against TRISIS\n\nSIS system implementation should begin with relevant vendor recommendations. The recommendations\nsurrounding methods on network isolation are especially critical to preserving SIS autonomy. In the case of\nTRISIS, Schneider Electric has provided the following recommendations for Triconex Controllers\n\n     - Safety systems should always be deployed on isolated networks.\n\n     - Physical controls should be in place so that no unauthorized person would have access to the\nsafety controllers, peripheral safety equipment, or the safety network.\n\n     - All controllers should reside in locked cabinets and never be left in the “Program” mode.\n\n     - All Tristation terminals (Triconex programming software) should be kept in locked cabinets and\nshould never be connected to any network other than the safety network.\n\n     - All methods of mobile data exchange with the isolated safety network such as CDs, USB drives,\netc. should be scanned before use in the Tristation terminals or any node connected to this net­\nwork.\n\n     - Laptops that have connected to any other network besides the safety network should never be\nallowed to connect to the safety network without proper sanitation. Proper sanitation includes\nchecking for changes to the system not simply running anti-virus software against it (in the case\nof TRISIS no major anti-virus vendor detected it at the time of its use).\n\n     - Operator stations should be configured to display an alarm whenever the Tricon key switch is in\nthe “Program Mode.”\n\nIt is important to understand that TRISIS represents only the second stage of the ICS Cyber Kill Chain. This\nreport does not infer or suggest what stage 1 of the attack may be and instead focuses on what has been\nconfirmed through capability analysis. This puts defenders in the position of not stopping activities prior\nto impact but during or after the SIS impact. Keep in mind there is a wide range of defenses to detect and\nstop the attacker prior to exposing human safety and equipment during stage 1 and earlier stage 2 phases.\n\n\n-----\n\ny\n\n###### Stage 2 ICS Attack: Delivery\n\nTRISIS requires being executed from a host that can directly communicate with the SIS controller(s). In\nfigure 1 cited above any host on L2: Process LAN can serve this purpose. This allows more options for the\nattacker and greater scope of what needs to be defended. Delivery of TRISIS to any one of these hosts may\nbe accomplished through network transfer or USB/media transfer.\n\n     - Strong architecture can deter, delay or detect adversarial actions as they deliver TRISIS from an­\nother network to a host that can communicate to the SIS environment. This is traditional network\nconcepts of segmentation through firewalls, dual factor authentication of interactive access, etc.\n\n     - Once architectural foundations are in place, both active and passive defenses are needed. Au­\ntomated log collection, passive network collection provides the basis of information needed for\nforensic analysis after an event while strong tailoring of firewalls may limit/prevent delivery or\nminimally serve as a triggering event for defenses to investigate and respond.\n\n###### Stage 2 ICS Attack: Install/Modification\n\nOnce TRISIS resides on a host that has direct access, it is now in a dormant state until either the attacker\nor unwitting user executes the binary. Once the TRISIS package is on the host, there are several options for\nthe defenders to stop or detect it proactively.\n\n     - If the network architecture were already revised to limit what hosts can communicate to the SIS,\nthen the number of hosts that can successfully run TRISIS against SIS has already been reduced.\nAgain, this limits the attacker’s options while allowing more focused security controls. Strong\nmechanisms to limit removable media can be considered- both technical (USB whitelisting or out­\nright disabling of USB ports) or administrative (enforcing scanning of a USB drive prior to usage\nin production equipment) are valuable. Strong filesystem permissions or execution whitelisting\ntechnology become much easier to implement for engineering workstations or hosts that have\naccess to communicate with SIS.\n\n     - Reliance on traditional signature-based detection (antivirus) is not sufficient. At the time of dis­\ncovery, TRISIS was undetected by all antivirus engines. Instead, a more proactive approach is\nrequired. For instance, Worldview customers were provided Yara signatures to identify TRISIS.\nThose signatures also detect any binary compiled with py2exe as any such tool within an ICS or\nSIS environment is an outlier and immediately suspect.\n\n     - Additional proactive baselining can also occur. Hosts such as engineering workstations are often\nnot well managed. They generally are not part of Active Directory and have the option of running\na wide range of agents. However, baselining of known files, applications, services, USB insertions,\nand user accounts can find deviations that could detect TRISIS files on the system. This can offer\nassurances of the limited number of hosts that can communicate to the SIS.\n\n\n-----\n\ny\n\n###### Stage 2 ICS Attack: Execute\n\nThe execution of the TRISIS attack can be broken down into two components: the launch of the process on\nthe host and the network communications from the compromised host to the SIS controller(s).\n\nArchitecturally limiting the TRISIS executable to run on the host via execution and/or hampering its ability\nto communicate to the controllers via windows host firewall would stop any impact.\n\nAdditionally, proactive detection – such as identifying when a host is communicating with an SIS controller\ncan serve as an alarm. Even with strong architectures, misconfigurations occur that may allow a host that\nshouldn’t have access to an SIS to communicate to it. Such alarms, even if they fail to stop an attack, are\nvital to understanding and isolating the cause of the attack.\n\nSIS environments can be some of the most defensible systems. They are largely simplistic and static- usu­\nally the most static of any ICS environment. However, good architecture, passive defenses, and active de­\nfenses are key to understand when an attack is in progress and how to repel when the attackers use novel\ntechniques. There is no such thing as an undetectable or unpreventable cyber attack, and as defenders, it\nshould be a priority to secure and monitor the safety systems responsible for protecting human life, the\nenvironment, and the physical processes.\n\nDragos applies expert human intelligence and behavioral analytics to redefne industrial control system (ICS) cyber­\nsecurity. Its industry-first, ICS/OT cybersecurity ecosystem provides control systems operators with unprecedented\nsituational awareness over their environments, with comprehensive threat intelligence, detection, and response\ncapabilities. Dragos’ solutions include the Dragos Platform, providing ICS/OT-specifc threat detection and response;\nDragos Threat Operations Center, providing ICS compromise assessment, threat hunting, and incident response\nservices; and Dragos WorldView, providing global, ICS-specifc threat intelligence. Headquartered in metropolitan\nWashington DC, Dragos’ team of ICS cybersecurity experts are practitioners who’ve lived the problems the industry\nfaces hailing from across the U.S. Intelligence Community to private sector industrial companies.\n\n\n-----\n\ny\n\n##### FAQ\n\n**Who Did It?**\n\nAchieving a level of confidence on attribution is not as difficult as often positioned. However, achieving a\nhigh confidence of attribution can be incredibly difficult without access to a significant set of data or a long\nperiod of historical analysis across numerous intrusions into victim environments. Infrastructure attacks\nare often geopolitically sensitive topics that can carry real considerations between states. In addition, there\nis little to no value in true attribution (state, agency, or operator identity) to defense teams. In many cases,\nattribution can actually negatively affect defense teams. Due to the lack of value to defenders and the ram­\nifications of incorrect attribution Dragos does not comment publicly on attribution.\n\n**Is TRISIS a Big Deal?**\n\nTRISIS is the fifth ever publicly known ICS-tailored malware following STUXNET, HAVEX, BLACKENERGY2,\nand CRASHOVERRIDE. It is the first ever publicly known ICS-tailored malware to target safety instrumented\nsystems. For these reasons, it is of significant importance to the ICS community, and it should be analyzed\nfully to capture lessons learned. The malware is not capable of scalable and long-term disruptions or de­\nstruction nor should there be any hype about the ability to leverage this malware all around the commu­\nnity. Attacks on an industrial process that are as specific in nature as TRISIS are considerably difficult to\nrepurpose against other sites although the tradecraft does reveal a blueprint to adversaries to replicate the\neffort. However, because SIS are specifically designed and deployed to ensure the safety of the process, en­\nvironment, and human life an assault on one of these systems is bold and unsettling. While fear and hype\nare not appropriate in this situation, this is absolutely an escalation in the types of attacks we see against\nICS and should not be taken lightly.\n\n**Could This Attack Lead to Loss of Life?**\n\nYes. BUT, not easily nor likely directly. Just because a safety system’s security is compromised does not\nmean it’s safety function is. A system can still fail-safe, and it has performed its function. However, TRISIS\nhas the capability to change the logic on the final control element and thus could reasonably be leveraged\nto change set points that would be required for keeping the process in a safe condition. TRISIS would likely\nnot directly lead to an unsafe condition but through its modifying of a system could deny the intended\nsafety functionality when it is needed. Dragos has no intelligence to support any such event occurred in the\nvictim environment to compromise safety when it was needed.\n\n**What are the Indicators of Compromise?**\n\nDragos supplied Yara rules to our ICS WorldView customers to help defenders scope their environments\nfor this or similar malware. However, indicators of compromise (IOCs) are not appropriate in most cases\nfor industrial threats and capabilities. Technical data is often not similar in adversary capabilities between\nvictims. Defenders should instead focus on defense recommendations and the adversary tradecraft and\ntechniques.\n\n\n-----\n\ny\n\n**I Do Not Use Triconex Should I Care About TRISIS?**\n\nVendors targeted in specific malware implementations such as Schneider Electric with TRISIS are victims.\nThe malware was not designed because Triconex was a good choice for this attack; the malware would\nhave been designed because the intended victim was using Triconex. If the victim was leveraging a differ­\nent type of SIS, it is reasonable to conclude the malware would have targeted a different vendor. Therefore,\ndefenders should instead focus on monitoring their environments and being aware of how they have SIS\nconfigured if it’s deployed according to best practices, and the ability to respond if there was an issue de­\ntected with the SIS. The Triconex connection is specific to this malware, but the lessons learned apply to\nanyone using safety systems.\n\n**What Questions Should Executives Ask?**\n\nExecutives should ask, and thus their security teams should anticipate these questions, questions such as:\nDo we have an SIS and if so where and what type(s)? If we needed to collect data from the environment or\nvalidate the system has not been modified could we? If the SIS is disrupted is there a cybersecurity compo­\nnent to the processes in place to determine root cause analysis and if an attack has occurred? Do we have\nan incident response plan that factors in the loss of the SIS even if it does not immediately lead to an unsafe\nsituation? Is our SIS properly segmented off of the network and if not what monitoring do we have in place\nto ensure it is not impacted?\n\n**I Want to Speak on or Write About Safety Instrumented System Security What Should I Know?**\n\nPlease ensure you talk to a certified safety engineer. The security of SIS is important, but safety engineering\nis a very specific skillset. What seems feasible and nuanced from security professionals may not fully rep­\nresent the reality of the situation. I.e., please avoid sensationalist writing on the subject by including both\nsecurity and an engineering input. There have been presentations and topics at information security con­\nferences on safety systems before that impress generalist audiences but are known to the community to\nbe inaccurate or simplistic; fantastic research but not holistic in how it is often implemented or discussed.\nWhat that translates into is the “what is possible in a given scenario” should have an expert on the threat\nand an expert on the SIS speaking.\n\n**Contact Information**\n\n1745 Dorsey Road\nHanover, MD 21076 USA\nd | i f @d\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        },
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://dragos.com/blog/trisis/TRISIS-01.pdf",
        "https://app.box.com/s/lczcjm4izqlu3fuve5lf7yof2gpcxn0h",
        "https://papers.vx-underground.org/papers/ICS SCADA/Triton/TRISIS Malware - Analysis of Safety System Targeted Malware.pdf"
    ],
    "report_names": [
        "TRISIS-01.pdf",
        "Dragos_TRISIS-01(12-14-2017)",
        "TRISIS Malware - Analysis of Safety System Targeted Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041378,
    "ts_creation_date": 1513173636,
    "ts_modification_date": 1513173640,
    "files": {
        "pdf": "https://archive.orkl.eu/c9534efcbf1a9c020ba864ee090e0c0b03d32181.pdf",
        "text": "https://archive.orkl.eu/c9534efcbf1a9c020ba864ee090e0c0b03d32181.txt",
        "img": "https://archive.orkl.eu/c9534efcbf1a9c020ba864ee090e0c0b03d32181.jpg"
    }
}