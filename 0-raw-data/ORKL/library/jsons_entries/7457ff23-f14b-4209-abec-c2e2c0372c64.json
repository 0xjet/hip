{
    "id": "7457ff23-f14b-4209-abec-c2e2c0372c64",
    "created_at": "2022-10-25T16:48:20.882905Z",
    "updated_at": "2025-03-27T02:16:04.371426Z",
    "deleted_at": null,
    "sha1_hash": "93b3ec0cec9636d7815424be3030ae54c2eb79b5",
    "title": "Operation Tropic Trooper: Relying On Tried-And-Tested Flaws To Infiltrate Secret Keepers",
    "authors": "Trend Micro",
    "file_creation_date": "2015-04-24T14:54:31Z",
    "file_modification_date": "2015-04-27T10:22:17Z",
    "file_size": 1754682,
    "plain_text": "## Operation Tropic Trooper\n\n#### Relying on Tried-and-Tested Flaws to Infiltrate Secret Keepers\n\n##### Kervin Alintanahin Targeted Attack Defense Response Team\n\n\n-----\n\n# Contents\n\nIntroduction................................................................................................ii\n\nTargets...................................................................................................... 1\n\nCampaign Components............................................................................ 2\n\nPoint of Entry........................................................................................ 2\n\nInitial Payload: TROJ_YAHOYAH..................................................... 3\n\nInstallation Routine....................................................................... 3\n\nDownload Routine........................................................................ 4\n\nMaintaining Persistence....................................................................... 6\n\nBackdoor Payload: BKDR_YAHAMAM............................................. 7\n\nCommand-and-Control Communication............................................... 7\n\nLateral Movement............................................................................... 10\n\nPossible Connections............................................................................. 12\n\nDefending Against Operation Tropic Trooper......................................... 14\n\nThreat Intelligence Gathering............................................................. 14\n\nDownload Links.............................................................................. 14\n\nStrings............................................................................................ 15\n\nServices.......................................................................................... 15\n\nSolution Use....................................................................................... 15\n\nConclusion................................................................................................iii\n\nAppendix..................................................................................................iv\n\nMalicious Files......................................................................................iv\n\nReferences...............................................................................................vi\n\n\nTREND MICRO LEGAL DISCLAIMER\n\nThe information provided herein is for general\ninformation and educational purposes only. It is not\nintended and should not be construed to constitute\nlegal advice. The information contained herein may\nnot be applicable to all situations and may not reflect\nthe most current situation. Nothing contained herein\nshould be relied on or acted upon without the benefit\nof legal advice based on the particular facts and\ncircumstances presented and nothing herein should\nbe construed otherwise. Trend Micro reserves the\nright to modify the contents of this document at any\ntime without prior notice.\n\nTranslations of any material into other languages\nare intended solely as a convenience. Translation\naccuracy is not guaranteed nor implied. If any\nquestions arise related to the accuracy of a\ntranslation, please refer to the original language\nofficial version of the document. Any discrepancies\nor differences created in the translation are not\nbinding and have no legal effect for compliance or\nenforcement purposes.\n\nAlthough Trend Micro uses reasonable efforts to\ninclude accurate and up-to-date information herein,\nTrend Micro makes no warranties or representations\nof any kind as to its accuracy, currency, or\ncompleteness. You agree that access to and use\nof and reliance on this document and the content\nthereof is at your own risk. Trend Micro disclaims all\nwarranties of any kind, express or implied. Neither\nTrend Micro nor any party involved in creating,\nproducing, or delivering this document shall be liable\nfor any consequence, loss, or damage, including\ndirect, indirect, special, consequential, loss of\nbusiness profits, or special damages, whatsoever\narising out of access to, use of, or inability to use,\nor in connection with the use of this document, or\nany errors or omissions in the content thereof. Use\nof this information constitutes acceptance for use in\n“ i ” diti\n\n\n-----\n\n# INTRODUCTION\n\nTaiwan and the Philippines have become the targets Operation Tropic Trooper took advantage of two of\nof an ongoing campaign called “Operation Tropic the most-exploited Windows® vulnerabilities to date—\nTrooper.” Active since 2012, the attackers behind CVE-2010-3333 and CVE-2012-0158—to infiltrate\nthe campaign have set their sights on the Taiwanese their chosen networks. Part of its success could be\ngovernment as well as a number of companies in attributed to the use of basic steganography or image\nthe heavy industry. The same campaign has also file attachments laced with malicious code, combined\ntargeted key Philippine military agencies. Though with clever social engineering.\nthe motivations behind the operation are still unclear,\n\nThis research paper provides in-depth technical\n\nthe tools and tactics used reveal potential areas of\n\ninformation on Operation Tropic Trooper’s targets,\n\nweakness both countries should look into.\n\ncomponents, tools, and tactics.[*]\n\n                                        - Special thanks to Ronnie Giagone for additional\nanalyses and insights.\n\n\n-----\n\n# Targets\n\nMalware used in Operation Tropic Trooper shared similar characteristics\nwith those used in attacks targeting various organizations in Vietnam and\nIndia as early as 2011. [1]\n\nOperation Tropic Trooper targets government institutions, military\nagencies, and companies in the heavy industry in Taiwan and the\nPhilippines. [2]\n\n\n_Operation Tropic Trooper campaign flow_\n\n\n-----\n\n# Campaign Components\n\n### Point of Entry\n\nThe actors behind Operation\nTropic Trooper used spearphishing emails with weaponized\nattachments to exploit old\nvulnerabilities, particularly CVE2010-3333 and CVE-20120158. [3–5] These bugs have\nbeen two of the most exploited\nvulnerabilities since their\ndiscovery. [6–7]\n\nTo infiltrate target networks, the\n\n_Spear-phishing email sample_\n\nattackers relied on crafty social\nengineering tricks. They used\ncontextually relevant subjects, content, and aptly named attachments\nsuch as “Statement” to convince chosen recipients to download and\nopen the files supposedly sent for review.\n\n\nThe following filenames were also used:\n\n_•_ _3AD 28 March 2013, SI re ASG Plan Bombing in Zamboanga_\n_City.doc_\n\n_•_ _Troops Disposition 26 FEB 13.doc_\n\n_•_ _2nd qtr 2013 AR PF15.doc_\n\n_•_ _Draft AS-PH MLSA - v3 DAGTS_CFO_ILOG_DSA Clean.doc_\n\n   - 關於104年中央政府總預算.doc (translation: About 104 years total\n_central government budget.doc)_\n\n   - 實驗室電話表.doc (translation: Laboratory telephone table.doc)\n\n\n-----\n\n_•_ _[REDACTED]自荐信及个人简历.doc_\n(translation: [REDACTED] cover letter and\n_your resume.doc)_\n\nOpening the attachment runs an embedded malicious\nexecutable file, normally a downloader that accesses\na malicious site to download an image file. Some\nattachments open decoy documents to hide their\nmalicious nature.\n\n\n_Sample decoy documents (left: for Filipino targets; right:_\n_for Taiwanese targets)_\n\n\n#### Initial Payload: TROJ_YAHOYAH\n\nThe downloader typically attached to emails related to\nOperation Tropic Trooper is detected by Trend Micro\nas TROJ_YAHOYAH, a downloader with 32- and 64bit support. It has an encrypted configuration file and\nuses HTTP GET requests to download other files that\nare then decrypted and executed in memory.\n\n\n##### Installation Routine\n\nWhen executed, TROJ_YAHOYAH checks if the\ninfected system’s Windows OS is 64-bit capable or\nnot. If it is, the Trojan will decrypt a 64-bit copy of itself\nusing a simple XOR cipher with a single-byte key at\n_“0x90.”_\n\nIf the infected system\nis not 64-bit capable,\nthe Trojan will just drop\na 32-bit executable\ncopy of itself (%APP\n_DATA%\\Microsoft\\_\n_Credentials\\Credentials._\n_exe, detected as_\nTROJ_YAHOYAH),\nalong with an encrypted\nconfiguration file\n_(%APP DATA%\\_\n_Microsoft\\Credentials\\_\n_Credentials.dat). The_ _Code that decrypts the_\nconfiguration file was _configuration file using_\nencrypted using the _“0x95,0x99,0x9d,0xc3,0xc7,_\nsame simple algorithm _0xcb,0xd7,0xe5,0xbd,0xa9,_\nfeatured in the _0xb5,0xeb,0xf7,0xe3,0xe7,_\npreviously cited Rapid7 _0xed” as key_\nreport on KeyBoy.\nUnlike the KeyBoy Trojan though, which searches\nfor the string, “IJUDHSDJFKJDE,” TROJ_YAHOYAH\nsearches for “MDDEFGEGETGIZ.” These strings,\nfound at the beginning of the decrypted code,\nrepresent the configuration file. Absence of the said\nfile terminates the infection process.\n\n\n-----\n\n**_•_** **_NA: Checks for the system’s hostname_**\n\n**_•_** **_VR: Hard-coded string only used when_**\naccessing download sites to track which\ndownloader was used on a target.\n\n\n_TROJ_YAHOYAH’s decrypted configuration file_\n\n\nTROJ_YAHOYAH’s configuration file, when\ndecrypted, contains the links to sites from which it can\ndownload the files it needs to continue its routines.\nAfter decryption, it executes a dropped copy using the\n_-Embedding parameter then attempts to delete itself._\n\nThe downloader’s name was inspired by its selfdeletion routine after dropping its payload. YAHOYAH\nwas derived from the Visayan term “hayohay,” which\nloosely translates to an easily discarded “servant” in\nEnglish. [8]\n\n##### Download Routine\n\nTROJ_YAHOYAH attempts to access links and\ndownload files via HTTP GET requests. To move to\nanother attack phase, it uses the following user-agent\nstrings:\n\n**_•_** **_MSIE: Checks for the system’s Internet_**\nExplorer® version\n\n**_•_** **_NT: Checks for the system’s Windows OS_**\nversion\n\n**_•_** **_AV: Checks for installed antimalware solutions_**\n\n**_•_** **_OV: Checks for the system’s Microsoft™_**\nOffice® version\n\n\n_HTTP GET request sample_\n\n\nTROJ_YAHOYAH checks for the following\nantimalware solution processes:\n\n_•_ _360rp.exe_\n\n_•_ _360tray.exe_\n\n_•_ _ALMon.exe_\n\n_•_ _ALsvc.exe_\n\n_•_ _ashserv.exe_\n\n_•_ _Avastsvc.exe_\n\n_•_ _avgam.exe_\n\n_•_ _avguard.exe_\n\n_•_ _avp.exe_\n\n_•_ _avpmapp.exe_\n\n_•_ _consctl.exe_\n\n_•_ _CyberoamClient.exe_\n\n_•_ _econceal.exe_\n\n_•_ _econser.exe_\n\n_•_ _ekrn.exe_\n\n_•_ _escanmon.exe_\n\n\n-----\n\n_•_ _mcshield.exe_\n\n_•_ _nod32krn.exe_\n\n_•_ _pccntmon.exe_\n\n_•_ _rtvscan.exe_\n\n_•_ _SAVAdminService.exe_\n\n_•_ _SavService.exe_\n\n_•_ _sfctlcom.exe_\n\n_•_ _swi_service.exe_\n\n_•_ _uiwatchdog.exe_\n\nTROJ_YAHOYAH temporarily saves downloaded files\nin a specially created folder named “%APP DATA%\\\n_tasks\\up{random characters}.msi.”_\n\n\n_Sample .MSI file opened on Microsoft Paint_\n\n\n_Sample .MSI file with a malicious .JPG header_\n\n\nThe image is supposed to be an 800 x 600 wallpaper\nthat is way heavier than the real one named “Wind.\n_jpg” normally found in Windows XP systems’_\n_%WINDOWS%\\wallpaper\\web folder. The actors_\nbehind Operation Tropic Trooper may be using\na simple steganography technique to mask the\nbackdoor’s routines in order to evade antimalware\nand network perimeter detection. [9] We have seen\nthe actors use other images found in the same folder\nsuch as “Ascent.jpg,” “Friend.jpg,” and “Home.jpg.”\n\n\n-----\n\nA more in-depth analysis\nof the downloaded file\nreveals that malicious\ncode has been\nappended to it. This\nallows TROJ_YAHOYAH\nto check offset 0x0F\nbytes from the end of\nthe file code to identify\na marker where the\nmalicious binary code\nwill be added, thus\nincreasing the file’s size.\n\nTROJ_YAHOYAH\nlooks for the string,\n_“EHAGBPSL,” and_\ndecrypts the appended\nbinary code. When\ndecrypted, an .EXE file\nis executed in memory. It\nautomatically runs if the\nuser has administrator\nprivileges. If the user has _Other images used in_\nlimited privileges though, _attacks_\nit will first attempt to\nobtain administrator privileges by bypassing User\nAccount Control (UAC) but only on Windows 7. It will\nthen decrypt another XOR-encrypted file using the\nkey “0x90” in memory then check if the “StartWork”\nfunction was exported then execute it.\n\n\n### Maintaining Persistence\n\nThe last file that TROJ_YAHOYAH executes in\nmemory is the main installer. It contains two more files\nthat install a .DLL file detected as TROJ_YAHAMAM.\nThis file is registered as a service named “INCS” to\nmaintain persistence. It also drops the following XORencrypted malware-laced image files:\n\n_•_ _% windows %\\System32\\mfc41.dll (detected_\nas TROJ_YAHAMAM)\n\n_•_ _% windows %\\inf\\mfc41.inf (a configuration_\nfile)\n\n_•_ _% windows %\\Fonts\\mfc41.tff (a copy of the_\nconfiguration file)\n\n_•_ _%windows%\\Web Wallpaper\\images.jpg_\n(contains BKDR_YAHAMAM)\n\nA batch (.BAT) file is used to start the INCS service.\nTROJ_YAHAMAM uses a trick similar to that of\nTROJ_YAHOYAH in order to decrypt files. When\ndecrypted, TROJ_YAHAMAM executes the backdoor\npayload.\n\n\n_Malicious code appended to that of the .JPG file_\n\n\n-----\n\n#### Backdoor Payload: BKDR_ YAHAMAM\n\nBKDR_YAHAMAM is usually encrypted then\nembedded in an image file. When decrypted, it is\nloaded and executed in memory by a .DLL file that\nis registered as a service (TROJ_YAHAMAM). It\nexfiltrates data from infected systems, downloads and\nuploads files, and has a remote shell. It also drops\na rootkit component named “usb.sys,” detected as\nRTKT_HIDEPORT.ZTCA-XO. The rootkit creates\nthe service, usb30, and hides evidence of port\ncommunication to evade detection and remain\npersistent.\n\n### Command-and-Control Communication\n\nWhen executed, BKDR_YAHAMAM checks if it runs\nunder svchost.exe. It uses the configuration file,\n_%windows %\\Fonts\\mfc41.tff, which contains the_\nfollowing information:\n\n_•_ _C&C1_\n\n_•_ _C&C2_\n\n_•_ _C&C3_\n\n_•_ _ControlPort_\n\n_•_ _DownloadURL1_\n\n_•_ _DownloadURL2_\n\n\n\n_•_ _DownloadURL3_\n\n_•_ _LoginPass (for authentication purposes)_\n\n_•_ _Port1_\n\n_•_ _Port2_\n\n_•_ _Port3_\n\n_•_ _USB_\n\n_•_ _UserMark_\n\nBKDR_YAHAMAM encrypts C&C communication\nusing multiplication with a 1-byte key. Attackers can\nuse the “?” and “Help” commands to see the various\noptions the backdoor offers as shown in its code.\n\n\n_Tool used to emulate command-and-control (C&C)_\n_communication with a 64-bit version of BKDR__\n_YAHAMAM_\n\n\nWe were able to download some files from two of the\nC&C servers that TROJ_YAHAMAM accesses. These\nhad some image files that the 32- and 64-bit versions\nof the backdoor can choose from for use in attacks.\n\n\n-----\n\n-----\n\nThe following table lists the unique SHA-1 hashes that TROJ_YAHAMAM downloads, along with their backdoor\npayloads.\n\n\n_C&C servers TROJ_YAHAMAM accesses to download malicious payloads_\n\n|Filename|SHA-1 Hash|Backdoor Payload|Trend Micro Detection Name|\n|---|---|---|---|\n|3.jpg|c5359ecc1651a98125bf7ea2668f85af64a7a 533|HL3.7x86_20140711|BKDR_YAHAMAM|\n|32.jpg|872cbe46a84fb88836db2a15e92d8c80d420 9af3|HL3.7x86_20150122|BKDR_YAHAMAM|\n|bd2015.24.jpg|8ee9bdab29970c95f9ed5915813543609b7f 438c|HL3.7x86_20150122|BKDR_YAHAMAM|\n|lclc_0725.jpg|fedb2c7b5f6a11ddefd29eb034e85f17c612e 3ba|HL3.7x86_20140508|BKDR_YAHAMAM|\n|SmartNavport0205.32.gif|75940e926894b65652bb84d96fe42fe709a1 83f5|HL3.7x86_20150122|BKDR_YAHAMAM|\n|ualband.24.jpg|6d82e1aafd910b93ebf2ece773d43e9ccbbf8 4f3|HL3.7x64_20140711|BKDR_YAHAMAM|\n\n\nInterestingly, a BKDR_POISON variant was found on the sites’ folders as well, leading us to believe that the\nattackers also use it for Operation Tropic Trooper.\n\n\n-----\n\n|Filename|SHA-1 Hash|Trend Micro Detection Name|\n|---|---|---|\n|wshif.dll|a7b4381b1f9161992b358eda9bd58a6b219a13d3|BKDR_POISON.TUFN|\n|wship.dll|4eedf918aeb1a2bedc6278e89ebf3005d0b95d41|BKDR_POISON.TUFN|\n\n\nBKDR_YAHAMAM can steal practically any type of file saved on infected systems. Apart from stealing data,\nit can also perform more harmful actions like kill processes and services, delete files and directories, and put\nsystems to sleep, among others.\n\nBKDR_YAHAMAM also attempts to install an accompanying executable rootkit (%windows %\\system32\\\n_drivers\\usb30.sys, detected as RTKT_HIDEPORT.ZTCA-XO). RTKT_HIDEPORT.ZTCA-XO is also XOR_\nencrypted and found at byte key, “0x90,” to hide the port that the backdoor should use according to the\nconfiguration file. It will only hide communication activities occurring in the first of three port entries indicated in\nthe configuration file. After creating and starting the rootkit service, BKDR_YAHAMAM then attempts to delete\nthe rootkit and the related service. This will not stop the rootkit from running in the background.\n\nBKDR_YAHAMAM variants with rootkits for 32-bit systems run on 32-bit versions of Windows XP. On Windows\n7 64-bit systems, however, the backdoor works but the rootkit does not.\n\n### Lateral Movement\n\nIn the course of doing research, we also managed to get hold of the following tools that the actors behind\nOperation Tropic Trooper used in an attack:\n\n**•** **HKTL_GETOS: Detects a target system’s OS version. [10]**\n\n**•** **HKTL_SHARESCAN: Performs the following:**\n\n� **_-pr: Scans for open ports on target systems._**\n\n� **_-letmein: Scans for saved usernames and passwords on_**\ntarget systems.\n\n\n� **_-arp: Views the Address Resolution Protocol (ARP) on each_**\ntarget system.\n\n� **_-netview: Scans target systems for shared resources._**\n\n\n_HKTL_GETOS’s OS-version-sniffing_\n_routine_\n\n\n-----\n\n_HKTL_SHARESCAN’s routines (top left: -pr; top right: -letmein; bottom left: -arp; bottom right: -netview_\n\n\nThese hacking tools were possibly remotely downloaded by the attackers onto infected systems. They aided in\nlateral movement and further intelligence gathering. Data such as credentials saved on infected systems can\nbe stolen via Address Resolution Protocol (ARP) poisoning or main-in-the-middle (MiTM) Layer 2 and passthe-hash attacks. [11–12] The stolen credentials allow attackers laterally move throughout a network. The threat\nactors no longer have to hack their way in, they have the ability to log in as legitimate users.\n\n\n-----\n\n# Possible Connections\n\nBased on the specially crafted documents we were able to gather,\nOperation Tropic Trooper has been active since 2012. We have seen\nmalware samples from 2011 that behaved the same way and used\nsimilar file markers. [13]\n\nThe following table provides more detailed information on Operation\nTropic Trooper’s downloader, TROJ_YAHOYAH.\n\n|SHA-1 Hash|Campaign ID Hard- Coded into Malware|\n|---|---|\n|17ee08b92aeefb8d3d73a02beb03e634b453b5fe|PH4.0 Q20121012|\n|3a8bed630679a30c8f945a7f9fe9eef18dd18ef8|PH4.0 Q20131218|\n|3ff3519749764f64f5f208347f39bd77f7e2fa92|PH4.0 Q20130527|\n|47747dccd1fc57a6456cf2a06d654966193545e5|PH4.0 Q20120730|\n|542ca28d4154e4e4382f9dfe4e0C37983046e93d|PH4.0 Q20131218|\n|56680180af5a792dca8e6112c57810b5e06bca1b|PH4.0 Q20120730|\n|593ab027f90d8651e685581b8f09d87a2c95f244|PH4.0 Q20140723|\n|5c5a4ceea45c3f0e67085b9d323da13eedcf6e1b|PH4.0 Q20121012|\n|6099001d54d39bcdd7c874672e8b28789e79721f|PH4.0 Q20121012|\n|7d5fd316f12ff39e5a9b43dabd66eccdcdb164e7|PH4.0 Q20141104|\n\n\n-----\n\n|SHA-1 Hash|Campaign ID Hard- Coded into Malware|\n|---|---|\n|973e522edeb08bea948098ce7c8b83866857de9c|PH4.0 Q20130527|\n|aef101fb24bd39e3cc14c26796c0336f2cb1d540|PH4.0 Q20131218|\n|b1fdb46cbe73cc14f784bebac47e33606b259967|PH4.0 Q20121012|\n|b767e1325bf103e672183e9487093ac068b75bc8|PH4.0 Q20140723|\n|ba71031ec0dccf09fbc48af61a22e5faa6b055a4|PH4.0 Q20140910|\n|bb8fddcd993a3ca94c6dd583f36df76bb5227ca5|PH4.0 Q20130527|\n|c4ae20ef0a90f095a88a9ea9920e97733a4d5626|PH4.0 Q20141104|\n|d50c657ff3068bd03ef74cfa5a289bbda87f33ef|PH4.0 Q20121012|\n|f8ac7ccf99485f485a435e05420bf3c103a3a549|PH4.0 Q20131218|\n\n\n-----\n\n# Defending Against Operation Tropic Trooper\n\n\n### Threat Intelligence Gathering\n\nNetwork and system administrators can protect\nagainst Operation Tropic Trooper by blocking user\naccess to related C&C servers. They should also\nkeep an eye out for related strings as well as services\nand their corresponding paths.\n\n#### Download Links\n\nTROJ_YAHOYAH downloads the following image\nfiles:\n\n_•_ _113.10.183.104/imgs/phh121018.jpg_\n\n_•_ _113.10.221.89/images/kong.jpg_\n\n_•_ _113.10.221.89/images/phonedpp.jpg_\n\n_•_ _113.10.221.89/Pictures/dzh_0925.jpg_\n\n\n\n_•_ _113.10.221.89/underwater.jpg_\n\n_•_ _173.252.220.169/underwater.jpg_\n\n_•_ _198.211.3.83/images/ph06.jpg_\n\n_•_ _202.153.193.73/images/kong.jpg_\n\n_•_ _202.153.193.73/images/phonedpp.jpg_\n\n_•_ _208.187.167.126/images/dfsy.jpg_\n\n_•_ _208.187.167.126:88/images/dmjs.jpg_\n\n_•_ _208.187.167.126/images/phzy.jpg_\n\n_•_ _50.117.38.164/Pictures/dzh_0925.jpg_\n\n_•_ _61.218.145.179/monitor/images/_\n_Smartxy130619.gif_\n\n_•_ _61.221.169.31/images/kongj.jpg_\n\n_•_ _61.221.169.31/images/phonedpp.jpg_\n\n_•_ _61.222.31.83/monitor/images/Smartxy130619._\n_gif_\n\n_•_ _69.221.169.31/underwater.jpg_\n\n\n-----\n\n_•_ _air88.ddns.us/images/af130218.jpg_\n\n_•_ _air88.ddns.us/js/af130901.jpg_\n\n_•_ _air88.ns01.us:53/js/af130901.jpg_\n\n_•_ _air88.ns01.us/images/af130218.jpg_\n\n_•_ _air88.ns01.us:53/js/af130901.jpg_\n\n_•_ _air99.ns01.us/js/af130901.jpg_\n\n_•_ _info.acmetoy.com/imgs/phh121018.jpg_\n\n_•_ _msc.ddns.us:443/images/ph06.jpg_\n\n_•_ _nevermore.onmypc.org/images/ph06.jpg_\n\n_•_ _ph11.dns1.us:53/images/phzy.jpg_\n\n_•_ _ph11.dns1.us/images/dfsy.jpg_\n\n_•_ _ph11.dns1.us/images/dmjs.jpg_\n\n_•_ _ph11.ns01.us:443/images/phzy.jpg_\n\n_•_ _ph11.ns01.us:5050/images/dmjs.jpg_\n\n_•_ _ph11.ns01.us/images/dfsy.jpg_\n\n_•_ _ware.compress.to/imgs/phh121018.jpg_\n\n_•_ _www . amberisic611 . 4dq . com / monitor /_\n_images / Smartzh140222 . gif_\n\n_•_ _www . bannered . 4dq . com / monitor / images /_\n_Smartzh131225 . gif_\n\n_•_ _www . bannered . 4dq . com / monitor / images /_\n_Smartzh140222 . gif_\n\n_•_ _www . cham . com . tw / images / dzh _ 0925 . jpg_\n\n_•_ _www . forensic611 . 3 - a . net / monitor / images /_\n_Smartzh131225 . gif_\n\n_•_ _www . forensic611 . 3 - a . net / monitor / images /_\n_Smartxy130619 . gif_\n\n_•_ _www . forensic . zyns . com / monitor / images /_\n_Smartzh131225 . gif_\n\n_•_ _www . metacu . ygto . com / monitor / images /_\n_Smartzh140222 . gif_\n\n\n#### Strings\n\nTROJ_YAHOYAH looks for the following strings to\ncontinue performing its malicious routines:\n\n_•_ _EHAGBPSL_\n\n_•_ _MDDEFGEGETGIZ_\n\n#### Services\n\nNetwork and system administrators can also look out\nfor the following services, which are related to TROJ_\nYAHAMAM:\n\n**•** **ServiceName: INCS**\n\n� **DisplayName: IPSEC Network**\nConnections Services;\n\n� **ImagePath: %SystemRoot%\\System32\\**\n_svchost.exe -k incsvc_\n\n**•** **ServiceName: usb30**\n\n� **DisplayName: usb30**\n\n� **ImagePath: %SystemRoot%\\\\System32\\**\n_DRIVERS\\usb30.sys_\n\n### Solution Use\n\nWe also recommend a Custom Defense strategy\nthat uses a comprehensive “Detect—Analyze—\nRespond” life cycle to address threats particular to an\norganization. This can provide in-depth threat profile\ninformation as well as advanced threat detection\nat the network level to discover malicious content\n(malware), communication, and attacker activity that\nare not typically visible to traditional security solutions.\n\n\n-----\n\nThe following table shows how a custom defense solution such as Trend Micro™ Deep Discovery can aid in\ndetecting the components of Operation Tropic Trooper.\n\n|Attack Component|Deep Discovery Component|Description|\n|---|---|---|\n|Spear-phishing emails|Email Inspector|Detects spear-phishing emails used to infiltrate, establish a foothold in, and launch targeted attacks against targets; has email-inspection capabilities that detect malicious content, attachments, and URLs that pass unnoticed through standard email security solutions|\n|Malicious image files|Analyzer|Detects even previously unknown threats by analyzing a broad range of file types, sizes, and sources using customizable sandbox environments that attackers design and build to match organization’s desktop and device platforms|\n|Detects even previously unknown threats by analyzing a broad range of file types, sizes, and sources using Analyzer customizable sandbox environments that attackers design and build to Malware match organization’s desktop and • BKDR_POISON.TUFN device platforms • BKDR_YAHAMAM • RTKT_HIDEPORT.ZTCA-XO • TROJ_YAHOYAH Identifies suspicious activities anywhere on networks, including those related to lateral movement and Inspector C&C; also detects traffic generated by malware-download-related behaviors via HTTP GET requests|Analyzer|Detects even previously unknown threats by analyzing a broad range of file types, sizes, and sources using customizable sandbox environments that attackers design and build to match organization’s desktop and device platforms|\n||Inspector|Identifies suspicious activities anywhere on networks, including those related to lateral movement and C&C; also detects traffic generated by malware-download-related behaviors via HTTP GET requests|\n\n\n-----\n\n# CONCLUSION\n\nOperation Tropic Trooper is not highly sophisticated. for the targeted organizations to pinpoint and fix\nBut the fact that it has attained some degree of security gaps in their networks.\nsuccess and has managed to infiltrate crucial\n\nBuilding threat intelligence is crucial in the fight\n\norganizations in both Taiwan and the Philippines\n\nagainst targeted attacks. Identifying the tools,\n\nshows the urgent need for targeted entities to rectify\n\ntactics, and procedures (TTPs) that threat actors\n\ntheir shortcomings in terms of security.\n\nuse based on external reports and internal historical\n\nAs with other targeted attacks, Operation Tropic and current monitoring can help create a strong\nTrooper brings great risks, especially since its database of indicators of compromise (IoCs) that can\ntargets include government institutions and military serve as basis for action. Using the right tools for\nagencies. Although we were not able to collect advanced threat protection should also be part of an\nenough information to determine the identities and expanded security monitoring strategy. This includes\nmotivations of the actors behind Operation Tropic establishing and empowering incident response\nTrooper, we were able to gather enough intelligence teams and training employees, partners, and vendors\nto help potential victims defend against the campaign. on social engineering and computer security. [14]\nKnowing that attackers are still using old techniques\nand exploiting known vulnerabilities will make it easier\n\n\n-----\n\n# APPENDIX\n\n\n### Malicious Files\n\n|Filename|SHA-1 Hash|Trend Micro Detection Name|\n|---|---|---|\n|credentials.exe|17ee08b92aeefb8d3d73a02beb03e634b453b5fe 25c2540125a4f6db5bd9e71b9130ba19aed4af2c 3a8bed630679a30c8f945a7f9fe9eef18dd18ef8 3ff3519749764f64f5f208347f39bd77f7e2fa92 43f565273e9b2bcfa9640c41ebb591f5dccca23e 47747dccd1fc57a6456cf2a06d654966193545e5 542ca28d4154e4e4382f9dfe4e0c37983046e93d 56680180af5a792dca8e6112c57810b5e06bca1b 5c5a4ceea45c3f0e67085b9d323da13eedcf6e1b 6099001d54d39bcdd7c874672e8b28789e79721f 77eaac29dc3f46fdd4782b3a633a9c4b35fbdf20 7d5fd316f12ff39e5a9b43dabd66eccdcdb164e7 973e522edeb08bea948098ce7c8b83866857de9c a31d398abf230f18bee6487732ad477e98a4f784 a7713afd111b40da066449cc4450338316e51462 aef101fb24bd39e3cc14c26796c0336f2cb1d540 b1fdb46cbe73cc14f784bebac47e33606b259967 ba71031ec0dccf09fbc48af61a22e5faa6b055a4 bb8fddcd993a3ca94c6dd583f36df76bb5227ca5 c4ae20ef0a90f095a88a9ea9920e97733a4d5626 d50c657ff3068bd03ef74cfa5a289bbda87f33ef dd011e35df5b529f4a92d480428c63faa8a6da3f f8ac7ccf99485f485a435e05420bf3c103a3a549|TROJ_YAHOYAH.A|\n|(Image).jpg|0360098a17c5c68004350f3eb34ab6c2b5b7b6f6 2f853796b9598a85ce90c499f4e4e194b1348e0c 5adcea95439abf2c2c335af187dbeb92cb5587c0 70b0dafe10f2399bb3ae767be376b6f5cd68db19 84842226e9b626b2b4fca325fb1d13058aabf1be a149a79149ab080004adee3051bf0fd874177e97|BKDR_YAHAMAM.A|\n|mfc41.dll/rpcrt32.dll|0f7f277c57a7656e116894bb3460a15669bffaa3 49f4db863e4ac5b2c55e1bc7540ee865f5126dba 52084036ed353e24423e0bd1f10ea741096e8fbd 7835e3ca339626f87738644092bdf91a8a15eaac aa7e591951c085e0ab50748e6e0d96be99ad3f1a ac1bfb13e8d79a2cbd33cf3e4ef94a6f0c32abfc afe298099de7af1c43c97dce3e649f0c83164707 e771cff898649a5a00b4421db186859b1b04cac9|TROJ_YAHAMAM.A|\n\n\n-----\n\n**Trend Micro Detection**\n**Filename** **SHA-1 Hash**\n**Name**\n\n|(Exploit).doc|159a91f9c9a83493c03f83c22f478019b7f6e8ca 2665e536de618760cfe4b57c8f679d95fbb3da0b 2bd3f8356d4a3415e07311ffdc2d4834c0141029 305dcb0e9257875d0699567d7d10e69e6014eed1 312cc84043490b7a3b54fecff977cab75785f0c0 3631faf525863d8bd24e571e04b41bdced047734 4236be3aa2abc45e49a27d9bf87b6e5003d805c5 7676bd47deaf69a8a3a17a3f9e261b7aca1dac24 7b48460b5f6f8bc68fedb78a07f7884f57c66b57 8136ce73e502882fa187f7b53b549376bfb52ba2 a5ce827db51b204af7fef1a5b12b10a2566430bc|TROJ_MDROPPER.RDY|\n|---|---|---|\n\n\n-----\n\n# REFERENCES\n\n[1] Nex. (7 June 2013). Rapid7 Community. “KeyBoy, Targeted Attacks\nAgainst Vietnam and India.” Last accessed on 7 April 2015, https://\ncommunity.rapid7.com/community/infosec/blog/2013/06/07/keyboytargeted-attacks-against-vietnam-and-india.\n\n[2] Investopedia, LLC. (2015). Investopedia. “Heavy Industry.” Last\naccessed on 22 April 2015, http://www.investopedia.com/terms/h/\nheavy_industry.asp.\n\n[3] Loucif Kharouni. (10 January 2014). TrendLabs Security Intelligence\n_Blog. “Targeted Attack Methodologies for Cybercrime.” Last accessed_\non 7 April 2015, http://blog.trendmicro.com/trendlabs-securityintelligence/whatever-works-targeted-attack-methodologies-forcybercrime/.\n\n[4] Kyle Wilhoit. (15 December 2013). TrendLabs Security Intelligence\n_Blog. “Cybercriminals Using Targeted Attack Methodologies (Part_\n1).” Last accessed on 7 April 2015, http://blog.trendmicro.com/\ntrendlabs-security-intelligence/cybercriminals-using-targeted-attackmethodologies-part-1/.\n\n[5] Maersk Menrige. (17 June 2014). TrendLabs Security Intelligence\n_Blog. “Template Document Exploit Found in Several Targeted Attacks.”_\nLast accessed on 7 April 2015, http://blog.trendmicro.com/trendlabssecurity-intelligence/template-document-exploit-found-in-severaltargeted-attacks/.\n\n[6] Ryan Flores. (9 May 2012). TrendLabs Security Intelligence Blog.\n“Snapshot of Exploit Documents for April 2012.” Last accessed on 7\nApril 2015, http://blog.trendmicro.com/trendlabs-security-intelligence/\nsnapshot-of-exploit-documents-for-april-2012/.\n\n[7] Trend Micro Incorporated. (2014). Trend Micro Security Intelligence.\n“Cashing in on Digital Information: An Onslaught of Online Banking\nMalware and Ransomware.” Last accessed on 7 April 2015, http://\nwww.trendmicro.com/cloud-content/us/pdfs/security-intelligence/\nreports/rpt-cashing-in-on-digital-information.pdf.\n\n[8] Wikimedia Foundation, Inc. (12 October 2014). Wikipedia. “Alipin.”\nLast accessed on 8 April 2015, http://en.wikipedia.org/wiki/Alipin.\n\n[9] Jennifer Gumban. (3 March 2014). TrendLabs Security Intelligence\n_Blog. “Sunsets and Cats Can Be Hazardous to Your Online Bank_\nAccount.” Last accessed on 10 April 2015, http://blog.trendmicro.com/\ntrendlabs-security-intelligence/sunsets-and-cats-can-be-hazardous-toyour-online-bank-account/.\n\n[10] Trend Micro Incorporated. (2015). Threat Encyclopedia. “HKTL_\nGETOS.” Last accessed on 10 April 2015, http://about-threats.\ntrendmicro.com/ArchiveGrayware.aspx?language=cn&name=HKTL_\nGETOS.\n\n\n-----\n\nin-the-Middle) Attack and Mitigation Techniques.” Last accessed on 20\nApril 2015, http://www.cisco.com/c/en/us/products/collateral/switches/\ncatalyst-6500-series-switches/white_paper_c11_603839.html.\n\n[12] SANS Institute. (2010). SANS Institute InfoSec Reading Room. “Passthe-Hash Attacks: Tools and Mitigation.” Last accessed on 20 April\n2015, http://www.sans.org/reading-room/whitepapers/testing/pass-thehash-attacks-tools-mitigation-33283.\n\n[13] McAfee, Inc. (2014‒2015). McAfee for Business. “Generic\nDropper!dyh!4929C723EA9D.” Last accessed on 1 April 2015, http://\nwww.mcafee.com/threat-intelligence/malware/default.aspx?id=570595.\n\n[14] Trend Micro Incorporated. (2015). Trend Micro Security News.\n“Targeted Attack Campaigns and Trends: 2014 Annual Report.” Last\naccessed on 14 April 2015, http://www.trendmicro.com/vinfo/us/\nsecurity/news/cyber-attacks/targeted-attack-campaigns-and-trends2014-annual-report.\n\n\n-----\n\nCreated by:\n\nThe Global Technical Support & R&D Center of TREND MICRO\n\nTrend Micro Incorporated, a global leader in security software, strives to make the world\nsafe for exchanging digital information. Our innovative solutions for consumers, businesses\nand governments provide layered content security to protect information on mobile\ndevices, endpoints, gateways, servers and the cloud. All of our solutions are powered by\ncloud-based global threat intelligence, the Trend Micro™ Smart Protection Network™, and\nare supported by over 1,200 threat experts around the globe. For more information, visit\n\n225 E. John Carpenter Freeway\n\nwww.trendmicro.com.\n\nSuite 1500\n\n© 2015 by Trend Micro, Incorporated. All rights reserved. Trend Micro and the Trend Micro Irving, Texas\nt-ball logo are trademarks or registered trademarks of Trend Micro, Incorporated. All other 75062 U.S.A.\nproduct or company names may be trademarks or registered trademarks of their owners.\n\nPhone: +1.817.569.8900\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/h3xtomk798hufzzqxnhn2kjmvt6yrcxh",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.05.14.Operation_Tropic_Trooper/wp-operation-tropic-trooper.pdf",
        "https://documents.trendmicro.com/assets/wp/wp-operation-tropic-trooper.pdf"
    ],
    "report_names": [
        "wp-operation-tropic-trooper",
        "wp-operation-tropic-trooper.pdf"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f74e4fe6-6281-45e7-8866-0ff4316381cc",
            "created_at": "2024-05-01T02:03:07.959101Z",
            "updated_at": "2025-03-27T02:05:17.270819Z",
            "deleted_at": null,
            "main_name": "BRONZE HOBART",
            "aliases": [
                "Pirate Panda ",
                "Tropic Trooper ",
                "KeyBoy "
            ],
            "source_name": "Secureworks:BRONZE HOBART",
            "tools": [
                " KeyBoy",
                " Pfine",
                "DSNGInstaller"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "61ea51ed-a419-4b05-9241-5ab0dbba25fc",
            "created_at": "2023-01-06T13:46:38.354607Z",
            "updated_at": "2025-03-27T02:00:02.81258Z",
            "deleted_at": null,
            "main_name": "APT23",
            "aliases": [
                "KeyBoy",
                "Tropic Trooper",
                "BRONZE HOBART",
                "G0081",
                "Red Orthrus",
                "Earth Centaur",
                "PIRATE PANDA"
            ],
            "source_name": "MISPGALAXY:APT23",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bef7800a-a08f-4e21-b65c-4279c851e572",
            "created_at": "2022-10-25T15:50:23.409336Z",
            "updated_at": "2025-03-27T02:00:55.463048Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "Tropic Trooper",
                "Pirate Panda",
                "KeyBoy"
            ],
            "source_name": "MITRE:Tropic Trooper",
            "tools": [
                "USBferry",
                "ShadowPad",
                "PoisonIvy",
                "BITSAdmin",
                "YAHOYAH",
                "KeyBoy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041764,
    "ts_creation_date": 1429887271,
    "ts_modification_date": 1430130137,
    "files": {
        "pdf": "https://archive.orkl.eu/93b3ec0cec9636d7815424be3030ae54c2eb79b5.pdf",
        "text": "https://archive.orkl.eu/93b3ec0cec9636d7815424be3030ae54c2eb79b5.txt",
        "img": "https://archive.orkl.eu/93b3ec0cec9636d7815424be3030ae54c2eb79b5.jpg"
    }
}