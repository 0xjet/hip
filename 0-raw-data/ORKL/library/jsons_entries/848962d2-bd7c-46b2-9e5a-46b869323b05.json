{
    "id": "848962d2-bd7c-46b2-9e5a-46b869323b05",
    "created_at": "2023-01-12T15:02:18.682903Z",
    "updated_at": "2025-03-27T02:05:57.393954Z",
    "deleted_at": null,
    "sha1_hash": "2eb70201644a717b050a07c20ae6a027fc5b5b33",
    "title": "2013-08-02 - Surtr Malware Family Targeting the Tibetan Community",
    "authors": "",
    "file_creation_date": "2022-05-28T03:58:15Z",
    "file_modification_date": "2022-05-28T03:58:15Z",
    "file_size": 119636,
    "plain_text": "# Surtr Malware Family Targeting the Tibetan Community\n\n**[citizenlab.ca/2013/08/surtr-malware-family-targeting-the-tibetan-community/](https://citizenlab.ca/2013/08/surtr-malware-family-targeting-the-tibetan-community/)**\n\nAugust 2, 2013\n\n[Research](https://citizenlab.ca/category/research/)\n\n\n-----\n\n[Targeted Threats](https://citizenlab.ca/category/research/targeted-threats/)\nBy [Katie Kleemola and](https://citizenlab.ca/author/kkleemola/) [Seth Hardy](https://citizenlab.ca/author/sethhardy/)\nAugust 2, 2013\n\n## Background\n\nAs part of [our ongoing study into targeted attacks on human rights groups and civil society](https://citizenlab.ca/hrpublic-call/)\norganizations, the Citizen Lab analyzed a malicious email sent to Tibetan organizations in\nJune 2013. The email in question purported to be from a prominent member of the Tibetan\ncommunity and repurposed content from a community mailing list. Attached to the email\nwere what appeared to be three Microsoft Word documents (.doc), but which were trojaned\nwith a malware family we call “Surtr”.1 All three attachments drop the exact same malware.\nWe have seen the Surtr malware family used in attacks on Tibetan groups dating back to\nNovember 2012.\n\n## Delivery Mechanism\n\nWhile the malicious attachments appear to be DOC files due to their file extension, they are\nactually RTFs crafted to exploit a vulnerability in Microsoft Word: [CVE-2012-0158.](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0158)\n\nThis particular vulnerability was first exploited in early April 2012 and a patch was released\nby Microsoft on April 10, 2012. Currently, the sample is detected as malicious by 34 percent\n[of antivirus (AV) engines on VirusTotal (VT).](https://www.virustotal.com/en/file/240cc911820690373851423dece631049c969c1b59f99b9e888f2e890e345825/analysis/)\n\nFigure 1: Hexdump of the malicious attachment\n\n\n-----\n\nAlthough CVE-2012-0158 was first published and used in the wild in April 2012, samples\nusing this template were only initially detected by three AV engines (on VT). Therefore, while\na third of AV engines had a detection signature for CVE-2012-0158 as late as April 2013, it\nwas possible to design a document using a year old vulnerability that was recognized as\nmalicious by very few AV products. This number has since risen and it is currently being\ndetected by 34 percent of the AV products listed on VT.\n\nThis vulnerability highlights the need to keep both operating systems and applications up to\ndate as well as to exercise vigilance concerning links and email attachments.\n\nMalicious attachments with this template all use a similar dropper which originally drops the\npayload to the temporary file directory.\n\n## Payload\n\nSurtr creates either a new explorer or iexplore process and injects itself into this new process\nusing CreateRemoteThread function.\n\nIt also creates the following folders:\n\n%ALL USERS%/Application Data/Microsoft/Windows/123\n\n%ALL USERS%/Application Data/Microsoft/Windows/Burn\n\n%ALL USERS%/Application Data/Microsoft/Windows/LiveUpdata_Mem\n\nIt creates multiple copies of the payload including in both the Burn and LiveUpdata_Mem\nfolders. The copy in the Burn folder is called [VICTIM COMPUTER NAME].dll and there are\nthree copies in the LiveUpdata_Mem folder whose names consist of 6 random alphanumeric\ncharacters which are then appended with .dll, _Fra.dll and _One.dll. These copies will differ\nfrom the original payload dropped in the %TEMP% folder by filling the resource section with\nvarying amounts of 00 bytes. This also results in the malware having a much larger file size\n(30-50mb) possibly in an attempt to evade antivirus heuristics.\n\n\n-----\n\nSurtr connects to a command and control server (C2) and downloads a stage two\ncomponent to %ALL USERS%/Application Data/Microsoft/Windows/Burn/_[VICTIM\nCOMPUTER NAME].log. This particular sample connects to internet.3-a.net on port 9696.\n\nIn May 2012, internet.3-a.net resolved to the same IP (184.82.123.143) as\nandroid.uyghur.dnsd.me, which is a C2 used in Android malware attacks that targeted the\n[Tibetan community as previously documented by the Citizen Lab.](https://citizenlab.ca/2013/04/permission-to-spy-an-analysis-of-android-malware-targeting-tibetans/)\n\nThe stage two component that was downloaded in this particular case has an internal name\nof x86_GmRemote.dll, however we have seen an alternate stage two used with the name\nRemote.dll as well. Our analysis in this post focuses on the GmRemote variation as it has\nbeen seen in multiple attacks.\n\nSurtr’s capabilities include listing of file directories and contents on the victim computer and\nany USB drives connected to a victim machine, viewing web cache, executing remote\ncommands and logging keystrokes.\n\nIn order to store temporary information, Surtr creates the following folders:\n\n%ALL USERS%/Application Data/Microsoft/Windows/MpCache\n%ALL USERS%/Application Data/Microsoft/Windows/nView_DiskLoydb\n%ALL USERS%/Application Data/Microsoft/Windows/nView_KeyLoydb\n%ALL USERS%/Application Data/Microsoft/Windows/nView_skins\n%ALL USERS%/Application Data/Microsoft/Windows/UsbLoydb\nFor example, in nView_DiskLoydb, a file called FileList.db that contains file and directory\nlistings will be placed and nView_KeyLoydb will contain text files with keylogger output. The\nkeylogger output is disguised by adding a constant to the ordinal value of the character.\n\nThis data can then be sent to the C2. It is compressed using zlib DEFLATE so the network\ntraffic is not human readable without decompression.\n\nIt can also download additional malware onto the victim computer, which can provide\nattackers with further abilities like accessing the victim computer’s webcam or microphone. In\nparticular, we have seen Surtr used in conjunction with the Gh0st RAT derived LURK0\nmalware.\n\nFor persistency, Surtr adds a key to the registry to ensure it runs when the infected computer\nis restarted. It also stores its C2 information and a campaign code in the registry.\n\nFigure 2: Encrypted data in XC key\n\n\n-----\n\nFigure 3: Decrypted data (note: e0 25 is 0x25e0 which is 9696 in hex)\n\n\n-----\n\n## Other Samples & Variations\n\nWe have seen a large number of similar samples sent to Tibetan groups that use the same\nstage two (GmRemote) and communicate with the following C2s: dtl.dnsd.me, dtl.eatuo.com,\ndtl6.mooo.com and tbwm.wlyf.org. These C2s were also used in previous attacks\n[documented in an earlier Citizen Lab post on LURK0 malware targeting the Tibetan](https://citizenlab.ca/2012/07/recent-observations/)\ncommunity.\n\nOne particular sample (md5: ad9e5f79585eb62bc40b737e98bfd62e) which connects to C2\ndomain dtl6.mooo.com (which resolved to the same IP as the other dtl domains mentioned\nabove) on port 6178 was seen to download LURK0 malware after the initial Surtr infection.\nThis LURK0 sample had the campaign code ZQ6 that connects to C2 domain tbwm.wlyf.org\non port 3103. This domain also resolved to the same IP as the dtl domains.\n\nWe have also found reports of other Surtr stage 2 (GmRemote) samples that have campaign\ncodes which suggest they may be targeted at commercial and government targets.\n\n[The first sample was found via ThreatExpert. It uses campaign code kmlg-0308, and](http://www.threatexpert.com/report.aspx?md5=6da1abd5d7ed21a3328d9fdfaf061f24)\nconnects to a C2 at flyoutside.com. This domain and eight others are registered to\n[toucan6712@163.com:](http://10.10.0.46/mailto:toucan6712@163.com)\n\nflyoutside.com 67.198.227.162\n\n52showfly.com 112.121.169.189\n\nmydreamfly.com 112.121.186.60\n\ndreaminshy.com 119.42.147.101\n\n52flyfeel.com 119.42.147.101\n\neyesfeel.com 180.178.63.10 (now registered to lili@nuo.cn)\n\noutsidefly.com 74.55.57.85\n\nshowflyfeel.com 199.119.101.40\n\n51aspirin.com not resolving\n\nSearching for more samples in Virus Total Intelligence (VTI) using domains and other\nidentifying features reveals four related files:\n\n7fbdd7cb8b46291e944fcecd5f97d135 – connects to C2 domain www.flyoutside.com,\ncampaign code kmlg-0409tb\n\n58ff38412ebbedb611a3afe4b3dbd8b0 – connects to C2 IP 112.121.182.149 (similar to\nabove), campaign code lly-0311\n\n\n-----\n\n81bc8974967e1c911b107a9a91e3178b – connects to C2 domain\nwww.paulfrank166.2waky.com (192.198.85.102), campaign code 0201-2116\n\n44758b9a7a6cafd1b8d1bd4c773a2577 – connects to C2 domain www.flyoutside.com (same\nas the first sample found on ThreatExpert), campaign code lg-0109\n\nMost of these samples have campaign codes that suggest commercial targets. However, we\ndo not have information about where these samples were submitted from, so the target\nsector and victims cannot be confirmed.\n\n[A second GmRemote sample was found via the web, called Trojan/Subxe.89E1 by Anchiva.](http://lab.anchiva.com/n_view.asp?lang=en&vname=Trojan/Subxe.89E1)\nThis sample connects to google.djkcc.com and uses campaign code in1102. Other\nsubdomains under djkcc.com include:\n\nairforce.djkcc.com\ndomain.djkcc.com\ngoogle.djkcc.com\nindianembassy.djkcc.com\nmailnic.djkcc.com (MailNIC is an Indian email site at the National Informatics Centre)\nmicrosoft.djkcc.com\nrediffmail.djkcc.com (Rediffmail is an Indian email site)\n\nWhile we do not have information about what victims these samples target, the campaign\ncode, C2 domain, and related subdomains give some possible indications.\n\nOne additional find via VTI is a GmRemote sample internally named:\nGmKeyBoradServer_DLL.dll (MD5 e7e1c69496ad7cf093945d3380a2c6f4).\n\nIt exports functions (GmFunctionType, GmInitPoint, GmMyInitPoint, GmRecvPoint,\nGmShutPoint, GmVerSion) that are referenced in other GmRemote samples, although none\nof them have any real content.\n\nThese additional samples suggest that Surtr is being used to target groups beyond the\nTibetan community and is possibly being utilized by multiple threat actors.\n\n## Conclusions and Recommendations\n\nThe attacks we have observed that use the Surtr malware family are another example of the\npersistent targeted malware campaigns the Tibetan community faces. The specific attack\nreported in this post demonstrates that attackers are actively monitor mailing lists and\ndiscussion groups used by the Tibetan community and repurpose the content for use in\ntargeted malware attacks.\n\nFor communities under persistent threat from targeted malware campaigns, user vigilance\nand education are essential for reducing risk.\n\n\n-----\n\nUsers should carefully examine the sender s email address of emails and exercise\ncaution in opening unexpected or unsolicited attachments or opening unverified links.\n\nSee Citizen Lab’s [Recommendations for defending against targeted cyber threats for](https://citizenlab.ca/docs/recommendations.html)\nadditional information, and Tibet Action Institute’s [Detach from Attachments and](https://tibetaction.net/detach-from-attachments/) Think\nBefore You Click campaigns.\n\nThe Citizen Lab is continuing to monitor targeted malware campaigns using Surtr and will\npost updates as they are available.\n\n—\n\n## Appendix MD5’s & Identifiers\n\n### Email Attachment Names & MD5s:\n\n1) TCCC PRESIDENT & BOARD MEMBERS NOMINATION & ELECTION POLICY &\nPROCEDURE.doc – 8c06aec37c7e51f581aaa41f66d4ebad2) communication1.doc –\n28444ee593653a4816deb186a6eddee83) communication2.doc –\nc269b3cf3d336a40c2fd7c2111b52982\n\n**Stage 1**\n\nSection: .text\n\nMD5 hash: d4f9b3b573a8f1d70d58aa8daf9cb256\n\nSHA-1 hash: a1d5128cd50959bc7008be1fdfe2cf6339ed7098\n\nSHA-256 hash:\naef9f55931d054dbf027639e30d0abf587696b13d8993aab6c22eb7d47f0de83\n\nSection: .rdata\n\nMD5 hash: e130ff2adbf4515b1af88b451396e1f6\n\nSHA-1 hash: 248691810ae34407aa3486ef3faca6fe3286f630\n\nSHA-256 hash:\nadae7b2306d7fc145ebd90fd1147bc352c56937d58e1996b89d5368cebdb438d\n\nSection: .data\n\nMD5 hash: c4fc864da3ee8462c5c25054f00e703f\n\nSHA-1 hash: b28a02f68cbacdaa89cf274dc79b3c802a21599d\n\nSHA-256 hash:\n203ca80897fd63ca3fc55ec4be22cd302d5d81729ee8f347bd8f22c73ad1b61d\n\nSection: .reloc\n\nMD5 hash: bc2c349c1f4c338c6834a79c03c461fb\n\nSHA-1 hash: c71504a96ea72656ef826677a53f9a5230fcb049\n\n\n-----\n\nSHA-256 hash:\n58c192f73afe761b42493a36ded1a5724f06e14f44304b946341eb46b3bdfa7d\n\nThe hashes of the resource section vary based on how much it is padded.\n\nNotable Strings:\n\ncScCssvdcfhgshtj\nCrtRunTime.log\naCvVpR\n_One.dll\n_Fra.dll\nasasdasrqwfsdvctyqwm\nefskdfjaslkfjlaksd\ndksfjasdklfjasd\ncasfjaklsdjfaskdlf\nbakjfasdkljfkldfjaslkd\nadskjfksldjfklsad\nsoul\nLiveUpdata_Mem\\\nBurn\\\n\n**Stage 2 (downloaded component)**\n\nMD5: 21aa9dd44738d5bf9d8a8ecf53c3108c\n\nNotable Strings:\n\nx86_GmRemote.dll\n\nMark\n\nD:\\Project\\GTProject\\Public\\List\\ListManager.cpp\n\n## Footnote\n\n1 Surtr is a fire giant in Norse Mythology. We chose Surtr as this malware family’s namesake\n\nbecause the malware creates a folder named ‘Burn’\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2013/2013-08-02 - Surtr Malware Family Targeting the Tibetan Community.pdf"
    ],
    "report_names": [
        "2013-08-02 - Surtr Malware Family Targeting the Tibetan Community.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535738,
    "ts_updated_at": 1743041157,
    "ts_creation_date": 1653710295,
    "ts_modification_date": 1653710295,
    "files": {
        "pdf": "https://archive.orkl.eu/2eb70201644a717b050a07c20ae6a027fc5b5b33.pdf",
        "text": "https://archive.orkl.eu/2eb70201644a717b050a07c20ae6a027fc5b5b33.txt",
        "img": "https://archive.orkl.eu/2eb70201644a717b050a07c20ae6a027fc5b5b33.jpg"
    }
}