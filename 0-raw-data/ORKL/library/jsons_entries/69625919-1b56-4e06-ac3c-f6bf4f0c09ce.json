{
    "id": "69625919-1b56-4e06-ac3c-f6bf4f0c09ce",
    "created_at": "2023-01-12T14:59:14.134471Z",
    "updated_at": "2025-03-27T02:08:40.621605Z",
    "deleted_at": null,
    "sha1_hash": "2adf9e3faf4e08c37e8a953737b698bf2f46bc2b",
    "title": "2022-08-17 - Switching side jobs Links between ATMZOW JS-sniffer and Hancitor",
    "authors": "",
    "file_creation_date": "2022-09-01T10:14:36Z",
    "file_modification_date": "2022-09-01T10:14:36Z",
    "file_size": 4607209,
    "plain_text": "# Switching side jobs\n\n**blog.group-ib.com/switching-side-jobs**\n\n17.08.2022\n\nLinks between ATMZOW JS-sniffer and Hancitor\n\nVictor Okorokov\n\nGroup-IB lead Threat Intelligence analyst\n\nThe hacker group ATMZOW and its JavaScript-sniffer became known in 2020, thanks to the\n[Malwarebytes researchers, when the group installed a JS sniffer on a website that was](https://twitter.com/MBThreatIntel/status/1215693928764063744)\ncollecting donations for victims of the Australia bushfires.\n\nHowever, based on a specific obfuscation technique used by the group, we can track its\nactivities back to 2015 as \"Magento Guruincsite malware\". Moreover, one of the first domain\nnames, used by the group, was created in 2016.\n\nAccording to Group-IB Threat Intelligence data, ATMZOW has successfully infected at least\n**483 websites belonging to the domain zones of Italy, Germany, France, UK, Australia,**\n\n\n-----\n\n**India, Brazil etc. since the beginning of 2019.**\n\nGroup-IB specialists collected information about ATMZOW’s recent activity and found ties\nwith a phishing campaign targeting clients of a US bank based on the same JS obfuscation\ntechnique and a connection between the domain names used for the JS sniffer and the\nphishing domains on account of the same email address used. Further analysis showed that\n[the same phishing kit was used during the activity of Prometheus TDS, when an unknown](https://blog.group-ib.com/prometheus-tds)\nadversary used phishing pages as a final redirect when distributing Hancitor malware. With\nmoderate confidence, we can conclude that both the ATMZOW JS sniffer campaign and\nrelated phishing attacks could have been conducted by the Hancitor group.\n**ATMZOW: recent activity**\n\nIn May 2022 Group-IB specialists discovered that ATMZOW started using Google Tag\nManager (GTM) to deliver malicious payloads. Google Tag Manager is a tag management\nsystem that allows website owners to quickly and easily update various code snippets known\nas tags on websites and mobile apps.\n\nThe hackers created a Google Tag Manager link with ID GTM-WNV8QFR and started using\nlegitimate GTM code to inject JS sniffers. Injection starts with a common GTM snippet.\n\n\n-----\n\nFigure 1: Google Tag Manager snippet with the attacker's ID\n\nThis GTM script contains a specific tag (\"vtp_html\") with the next stage injector.\n\nFigure 2: Google Tag Manager script with the attacker's injector\n\nExecuting the script loaded by Google Tag Manager appends the injector to the DOM of the\ninfected website.\n\nFigure 3: The attacker’s injector\n\nThe injector checks if the current user's address in the address bar contains a \"checkout\"\nsubstring. If it does, the injector loads the final payload from\n**https://designestylelab[.]com/css/. The script loaded from**\n**https://designestylelab[.]com/css/ is a sample of the ATMZOW JS sniffer, but it contains**\nan additional layer of obfuscation\n\n\n-----\n\nFigure 4: ATMZOW sample with additional obfuscation\n\nIf we remove the junk symbols from the long string in this sample, we obtain a Base64encoded string. After decoding, we obtain an ATMZOW sample with its common obfuscation.\n\nFigure 5: ATMZOW sample\n\n\n-----\n\nAfter decrypting the strings used in this sample, we obtain a clean script of the ATMZOW JS\nsniffer.\n\nFigure 6: Use of a fake payment form in a sample of the ATMZOW JS sniffer\n\n\n-----\n\nFigure 7: Exfiltration address https://gvenlayer[.]com/track/ in a sample of the ATMZOW JS\nsniffer\n\n**Phishing campaign**\n\nIn January 2022 Group-IB specialists detected several phishing pages targeting clients of a\nUS-based bank. The pages used IDN domain names. A noteworthy fact about the pages is\nthat they have a JavaScript script, which was presumably obfuscated by the same tool as\nused by ATMZOW for the group’s samples of JS sniffers.\n\nFigure 8: Screenshot of a JS script from the page\n\nhttps://xn--keyvigatrs-key-7oc4531jsva[.]com/ktt/cmd/logon\n\n\n-----\n\nSince then we have detected only 7 unique domains used for phishing pages with a similar\nobfuscated JS:\n\nxn--kys-nvigatorky-zp8g5mna[.]com\nxn--kynavigatos-ky-pwc6541jna[.]com\nnavlgator-kcy[.]com\nxn--kyavigator-ky-jjc7914ima[.]com\nxn--ky-vigatorkey-kjc9383i4ka[.]com\nxn--key-vigatrs-key-wuc9688j1wa[.]com\nxn--keyvigatrs-key-7oc4531jsva[.]com\n\n**Connection between the JS-sniffer and the phishing campaign**\n\nWhen we detected the same obfuscation technique on a phishing website for the first time,\nwe hypothesized that the method was not unique to ATMZOW, but that other hackers could\nbe using the same obfuscator. However, further analysis of the group's recent activity\nshowed additional evidence that attacks involving the JS sniffer and the phishing campaign\nwere conducted by the same group.\n\nWhen ATMZOW started using Google Tag Manager as the initial stage of their infections,\nthey used a website with the domain name designestylelab[.]com as the storage location\n[for their payloads. With a patented technology named Group-IB Graph, we discovered that](https://www.group-ib.com/media/graph/)\nthis domain was created using the email address anne5lindt@winocs.com. The same email\naddress was used to create two more IDN domains for phishing pages targeting clients of\nthe same bank as the pages with the ATMZOW-like obfuscation, which we first detected in\nJanuary 2022:\n\nkẹy-ņạvigatorkey.com (xn--ky-vigatorkey-kjc9383i4ka[.]com)\nkey-ņạvigatọrskey.com (xn--key-vigatrskey-8oc4531jsva[.]com)\n\n\n-----\n\nFigure 9: Graph shows a connection between JS sniffer storage and phishing domains\n\nIn addition, one of these domains created with the email address anne5lindt@winocs.com\n(xn--ky-vigatorkey-kjc9383i4ka[.]com) was tagged as a phishing page with ATMZOW-like\nobfuscated JS script. It was detected on January 27, 2022.\n\nBased on the same JS obfuscation technique and the connection between the domain\nnames used for the JS sniffer and the phishing domains (the same email address), we can\nconclude with a high degree of reliability that both campaigns were conducted by the same\nthreat group.\n**Connection between the phishing campaign and Hancitor malware**\n\n[While analyzing Prometheus TDS, Group-IB Threat Intelligence specialists detected several](https://blog.group-ib.com/prometheus-tds)\ncases when phishing pages targeting clients of the same bank were used as a final redirect\nafter downloading the malicious payload distributed by Prometheus TDS. In all cases, the\n\n\n-----\n\nmalicious payload was Microsoft Office documents with a macro that dropped Hancitor\nmalware.\n\nFor example, a common method of distribution via Prometheus TDS was the use of Google\n[Docs with a link to the compromised website with Prometheus.Backdoor installed. In this](https://urlscan.io/result/53833a56-df34-4777-a0d1-385ef7050bf6/)\ncase, the Prometheus.Backdoor link was hXXp://www.swingsidebilbao[.]com/wpcontent/plugins/contact-form-7/includes/block-editor/carl.php. If a user clicked on the link,\nthey would receive a malicious Office document \"0210_4367220121562.doc\" (SHA1:\nbe3effcb9069ac6d66256c8246fde33e55980403) and then would be redirected to the\nphishing website hXXps://xn--keynvigatorkeyyp8g[.]com/ktt/cmd/logon0210_4367220121562.doc. If the user opened the malicious\ndocument and enabled macros then, the document would drop the Hancitor DLL (SHA1:\n17693bca881ec9bc9851fcb022a664704c048b9d).\n\nAs we can see, in this case the hackers used IDN domains again to spoof a real banking\nwebsite. Moreover, if we compare unique URLs generated while analyzing phishing pages\nfrom both campaigns, it is clear that both phishing pages were created using the same kit,\nwith slight modifications.\n\nBased on the information we collected, we can therefore conclude with a high degree of\nreliability that both clusters of phishing pages are part of a long-running phishing campaign\nconducted by one cybercriminal group.\n\n**IoCs**\n\nPhishing websites with ATMZOW-like obfuscation\n\nxn--kys-nvigatorky-zp8g5mna.com\nxn--kynavigatos-ky-pwc6541jna.com\nnavlgator-kcy.com\nxn--kyavigator-ky-jjc7914ima.com\nxn--ky-vigatorkey-kjc9383i4ka.com\nxn--key-vigatrs-key-wuc9688j1wa.com\nxn--keyvigatrs-key-7oc4531jsva.com\n\nPhishing websites detected in the Hancitor campaign with Prometheus TDS\n\nxn--avigatorkey-56b.com\nxn--nvigators-key-if2g.com\nxn--keynvigatorkey-yp8g.com\nxn--xprss53-s8ad.com\n\n\n-----\n\nATMZOW GTM ID\n\nGTM-WNV8QFR\n\nATMZOW JS sniffer storage\n\ndesignestylelab.com\n\nATMZOW JS sniffer gates\n\ngvenlayer.com\nmetahtmlhead.com\nwinsiott.com\ncongolo.pro\nvamberlo.com\nnmdatast.com\nseclib.org\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-17 - Switching side jobs Links between ATMZOW JS-sniffer and Hancitor.pdf"
    ],
    "report_names": [
        "2022-08-17 - Switching side jobs Links between ATMZOW JS-sniffer and Hancitor.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535554,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1662027276,
    "ts_modification_date": 1662027276,
    "files": {
        "pdf": "https://archive.orkl.eu/2adf9e3faf4e08c37e8a953737b698bf2f46bc2b.pdf",
        "text": "https://archive.orkl.eu/2adf9e3faf4e08c37e8a953737b698bf2f46bc2b.txt",
        "img": "https://archive.orkl.eu/2adf9e3faf4e08c37e8a953737b698bf2f46bc2b.jpg"
    }
}