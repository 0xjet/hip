{
    "id": "c9ea58b3-f5a1-40ec-9eb0-9bcb5ba51b69",
    "created_at": "2023-01-12T15:01:53.178815Z",
    "updated_at": "2025-03-27T02:15:13.874043Z",
    "deleted_at": null,
    "sha1_hash": "488ad90c305220093b270984a0ac1ef56cd7b236",
    "title": "2020-06-26 - US Local Government Services Targeted by New Magecart Credit Card Skimming Attack",
    "authors": "",
    "file_creation_date": "2022-05-27T22:34:33Z",
    "file_modification_date": "2022-05-27T22:34:33Z",
    "file_size": 117822,
    "plain_text": "# New Magecart Attack Target US Local Government Services\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/us-local-government-services-targeted-by-new-magecart-credit-card-skimming-attack/](https://blog.trendmicro.com/trendlabs-security-intelligence/us-local-government-services-targeted-by-new-magecart-credit-card-skimming-attack/)**\n\nJune 26, 2020\n\nCyber Threats\n\nEight cities across three states in the United States have fallen victim to a Magecart card skimming attack.\nWebsites were compromised to host credit card skimmers which passed on the credit card information of\nresidents to cybercriminals.\n\nBy: Joseph C Chen June 26, 2020 Read time: ( words)\n\n[Eight cities across three states in the United States have fallen victim to a Magecart card skimming attack. In](https://blog.trendmicro.com/trendlabs-security-intelligence/fin6-compromised-e-commerce-platform-via-magecart-to-inject-credit-card-skimmers-into-thousands-of-online-shops/)\nthese attacks, their websites were compromised to host credit card skimmers which passed on the credit\ncard information of residents to cybercriminals.\n\n[These sites all appear to have been built using Click2Gov, a web-based platform meant for use by local](https://www.centralsquare.com/public-administration/citizen-engagement)\ngovernments. It is used to provide services such as community engagement, issues reporting, and online\npayment for local goverments. Residents can use the platform to pay for city services, such as utilities.\nBreaches in these sites, however, are not new: In [2018 and](https://geminiadvisory.io/hacked-click2gov-exposed-payment-data/) [2019, the websites of several towns and cities](https://geminiadvisory.io/second-wave-of-click2gov-breaches-hits-united-states/)\nusing Click2Gov were compromised.\n\nFigure 1. Credit card skimming attack chain\n\nOur research identified eight cities whose websites had been compromised with a JavaScript-based\nskimmer, as expected from a Magecart attack. The information exfiltrated included:\n\nCredit card information (card number, expiration date, CVV)\nPersonal information (Name and contact address)\n\n\n-----\n\nOur analysis of both the skimmer and the infrastructure used could not find any connections between this\nbreach and the incidents in 2018 and 2019. Nevertheless, five of the eight cities were also affected in the\nprevious breaches; we believe that these attacks started on April 10 of this year, and are still active.\n\n**Analysis of the card skimming attack**\n\nThe attack occurs when victims make an online payment on the compromised Click2Gov website.\nJavaScript code was injected into the payment page which loads a credit card skimmer when victims browse\nthe payment page.\n\nUnlike other skimmers which grab data on various types of payment forms, the skimmer used here is rather\nsimple and only works on a Click2Gov payment form. No obfuscation or anti-debugging techniques were\n[used. The skimmer hooks the submit event of the payment form; when a victim clicks the button to send the](https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/submit_event)\npayment information, the skimmer will grab the information from the selected columns inside the payment\nform and immediately send the collected information to remote server via a HTTP POST request.\n\nFigure 2. Screenshot of credit card skimmer injected on Click2Gov payment page\n\n**Exfiltrated Data Type** **Targeted Column ID** **Exfiltration Request Schema**\n\nCredit card number accountNumber accountNumber\n\nCredit card CVV number cvv2 cvv\n\nCredit card expiration year expirationDate.year year\n\nCredit card expiration month expirationDate.month month\n\nCredit card expiration date expirationDate.date date\n\nFirst name of cardholder firstName firstName\n\nMiddle name of cardholder middleInitial middleInitial\n\nLast name of cardholder lastName lastName\n\nContact address 1 contact.address1 address1\n\nContact address 2 contact.address2 address2\n\nCity of contact address contact.city city\n\nState of contact address contact.state State\n\nZip code of contact address contact.zip ZipCode\n\nTable 1. Details of exfiltrated information\n\nWe were able to identify two of the exfiltration servers used in the attack. Both hosted the actual JavaScript\nskimmer, as well as a .JSP file used to receive the exfiltrated data. One of the servers was used for three\nsites, while the other server used for the remaining five sites. The two skimmers used are identical, save for\nthe change in the hostname of the exfiltration servers.\n\nFigure 3. Screenshot of the credit card skimmer script\n\nFigure 4. Example of exfiltration request\n\n\n-----\n\n**Background and attribution**\n\nClick2Gov has been hit by various breaches and attacks in the past. CentralSquare Technologies, its\ndeveloper, released a [2018 statement concerning security issues on various locally hosted sites. Other](https://web.archive.org/web/20181202232810/https:/www.superion.com/click2gov-update/)\n[researchers uncovered a breach of around 300,000 records from Click2Gov sites](https://geminiadvisory.io/hacked-click2gov-exposed-payment-data/)\n\n[Click2Gov at the end of that year. Another 2018 report showed a similar case where a site built using](https://www.fireeye.com/blog/threat-research/2018/09/click-it-up-targeting-local-government-payment-portals.html)\nClick2Gov was targeted by an attacker to exfiltrate credit card information from its users. In 2019, another\n[breach was discovered, where it became apparent that data from eight cities was being sold in the](https://geminiadvisory.io/second-wave-of-click2gov-breaches-hits-united-states/)\nunderground market.\n\nIt is not clear at this time if this attack which we identified is connected to the earlier breaches, since nothing\nabout their technical details indicate a connection. The only connection is that five of the affected cities in the\ncurrent incident were also affected in 2018; while two were included in the 2019 incident.\n\n**Conclusion**\n\nCredit card skimming attacks are still a major threat to online merchants. Victims not limited to only typical e[commerce sites. During 2019, we also saw that academic institutions and](https://blog.trendmicro.com/trendlabs-security-intelligence/mirrorthief-group-uses-magecart-skimming-attack-to-hit-hundreds-of-campus-online-stores-in-us-and-canada/) [hotel chains were targeted by](https://blog.trendmicro.com/trendlabs-security-intelligence/magecart-skimming-attack-targets-mobile-users-of-hotel-chain-booking-websites/)\nsimilar attacks. This time, the attacker targeted the websites of various local governments. This shows the\nimportance of keeping payment portals secure to protect both an organization and its customers.\n\nThe following Trend Micro solutions protect users and businesses by blocking the scripts and preventing\naccess to the malicious domains:\n\n[Trend Micro™ Security](https://blog.trendmicro.com/en_us/forHome/products.html)\n[Smart Protection Suites and](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) [Worry-Free™ Business Security](https://blog.trendmicro.com/en_us/small-business.html)\n[Trend Micro Network Defense](https://blog.trendmicro.com/en_us/business/products/network.html)\n[Hybrid Cloud Security](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud.html)\n\n**Indicators of Compromise (IOCs)**\n\n**SHA256 Hash/URL** **Type**\n\n\n99840885c7f248779838b08559a9f3feb16e646fad7a3d36015e4b4ca4b4173b\n\n\nCredit Card Skimmer\n(detected as\nTrojanSpy.JS.MAGECART.G)\n\n\na7db455dc25d107caf8f74f7d4c492541c5d37c38bf68604a6e85b06b61af26a Credit Card Skimmer\n(detected as\nTrojanSpy.JS.MAGECART.G)\n\nhttps[:]//cdns-static[.]com/recurring.js Credit Card Skimmer URL\n\nhttps[:]//renew-analytics[.]com/recurring.js Credit Card Skimmer URL\n\nhttps[:]//cdns-static[.]com/validate/index.jsp Exfiltration URL\n\nhttps[:]//renew-analytics[.]com/validate/index.jsp Exfiltration URL\n\ncdns-static[.]com Credit Card Skimmer Domain\n\nrenew-analytics[.]com Credit Card Skimmer Domain\n\n\n-----\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-26 - US Local Government Services Targeted by New Magecart Credit Card Skimming Attack.pdf"
    ],
    "report_names": [
        "2020-06-26 - US Local Government Services Targeted by New Magecart Credit Card Skimming Attack.pdf"
    ],
    "threat_actors": [
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ee3363a4-e807-4f95-97d8-b603c31b9de1",
            "created_at": "2023-01-06T13:46:38.485884Z",
            "updated_at": "2025-03-27T02:00:02.845851Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "Camouflage Tempest",
                "MageCart Group 6",
                "G0037",
                "TA4557",
                "SKELETON SPIDER",
                "ITG08",
                "White Giant",
                "GOLD FRANKLIN",
                "ATK88"
            ],
            "source_name": "MISPGALAXY:FIN6",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "12517c87-040a-4627-a3df-86ca95e5c13f",
            "created_at": "2022-10-25T16:07:23.61665Z",
            "updated_at": "2025-03-27T02:02:09.889471Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "ATK 88",
                "Camouflage Tempest",
                "FIN6",
                "Gold Franklin",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "TAG-CR2",
                "White Giant"
            ],
            "source_name": "ETDA:FIN6",
            "tools": [
                "AbaddonPOS",
                "Agentemis",
                "AmmyyRAT",
                "Anchor_DNS",
                "BlackPOS",
                "CmdSQL",
                "Cobalt Strike",
                "CobaltStrike",
                "FlawedAmmyy",
                "FrameworkPOS",
                "Grateful POS",
                "JSPSPY",
                "Kaptoxa",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LockerGoga",
                "MMon",
                "Magecart",
                "Meterpreter",
                "Mimikatz",
                "More_eggs",
                "NeverQuest",
                "POSWDS",
                "Reedum",
                "Ryuk",
                "SCRAPMINT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Terra Loader",
                "TerraStealer",
                "Vawtrak",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "cobeacon",
                "grabnew"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b3acfb48-b04d-4d3d-88a8-836d7376fa2e",
            "created_at": "2024-06-19T02:03:08.052814Z",
            "updated_at": "2025-03-27T02:05:17.368029Z",
            "deleted_at": null,
            "main_name": "GOLD FRANKLIN",
            "aliases": [
                "ITG08 ",
                "MageCart Group 6 ",
                "Skeleton Spider ",
                "White Giant ",
                "FIN6 "
            ],
            "source_name": "Secureworks:GOLD FRANKLIN",
            "tools": [
                " Metasploit",
                " Meterpreter",
                " Mimikatz",
                " PowerSploit",
                " PowerUpSQL",
                " RemCom",
                "FrameWorkPOS"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ea7bfe06-7c23-481d-b8ba-eafa6cda3bc9",
            "created_at": "2022-10-25T15:50:23.317961Z",
            "updated_at": "2025-03-27T02:00:55.440858Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "FIN6",
                "Magecart Group 6",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "Camouflage Tempest"
            ],
            "source_name": "MITRE:FIN6",
            "tools": [
                "FlawedAmmyy",
                "GrimAgent",
                "FrameworkPOS",
                "More_eggs",
                "Cobalt Strike",
                "Windows Credential Editor",
                "AdFind",
                "PsExec",
                "LockerGoga",
                "Ryuk",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535713,
    "ts_updated_at": 1743041713,
    "ts_creation_date": 1653690873,
    "ts_modification_date": 1653690873,
    "files": {
        "pdf": "https://archive.orkl.eu/488ad90c305220093b270984a0ac1ef56cd7b236.pdf",
        "text": "https://archive.orkl.eu/488ad90c305220093b270984a0ac1ef56cd7b236.txt",
        "img": "https://archive.orkl.eu/488ad90c305220093b270984a0ac1ef56cd7b236.jpg"
    }
}