{
    "id": "2cd71085-76e4-47ba-8b46-f72d8b5af2df",
    "created_at": "2023-01-12T15:03:44.529058Z",
    "updated_at": "2025-03-27T02:16:26.120109Z",
    "deleted_at": null,
    "sha1_hash": "74640a7afb701ea9ad4b26f587a4de1f8c864a5f",
    "title": "2021-09-29 - PixStealer- a new wave of Android banking Trojans abusing Accessibility Services",
    "authors": "",
    "file_creation_date": "2022-05-29T01:27:27Z",
    "file_modification_date": "2022-05-29T01:27:27Z",
    "file_size": 1213421,
    "plain_text": "# PixStealer: a new wave of Android banking Trojans abusing Accessibility Services\n\n**[research.checkpoint.com/2021/pixstealer-a-new-wave-of-android-banking-trojans-abusing-accessibility-services/](https://research.checkpoint.com/2021/pixstealer-a-new-wave-of-android-banking-trojans-abusing-accessibility-services/)**\n\nSeptember 29, 2021\n\nSeptember 29, 2021\nResearch by: Israel Wernik, Bohdan Melnykov\n\n## Introduction\n\nBy limiting physical interactions, the COVID-19 pandemic significantly accelerated the\ndigitization of the banking industry to fulfill customer needs. To cope with the demand,\nimprove access and awareness of financial services, banks and governments are developing\nnew infrastructure, protocols and tools. One of the most successful examples of such\ninitiatives launched during COVID is Pix, the instant payments solution created by the\n[Central Bank of Brazil. Released only in November 2020, Pix has already reached 40 million](https://tecnoblog.net/477918/pix-bate-recorde-e-ultrapassa-40-milhoes-de-transferencias-em-um-dia/)\ntransactions a day, moving a total of $4.7 billion a week.\n\nOf course, with evolving technology comes evolving hackers. A significant increase in\nconsumers’ use of mobile apps and websites for their banking transactions naturally did not\nescape the notice of malicious actors, especially those targeting mobile banking.\n\n\n-----\n\nCheck Point Research recently discovered a new wave of malicious Android applications\ntargeting the Pix payment system and Brazilian bank applications. These malicious apps,\nonce distributed on Google Store, seem to be an evolution of an unclassified family of\n[Brazilian bankers analyzed by security researchers back in April, and were discovered to](https://cryptax.medium.com/localizeapp-banking-trojan-yet-again-abusing-accessibility-services-ae7567b1cf0b)\nhave been updated with new techniques and capabilities. One of the versions we found\ncontains never-before-seen functionality to steal victims’ money using Pix transactions. Due\nto its unique functionality and implementation, we named this version PixStealer.\n\nPixStealer is a very minimalistic malware that doesn’t perform any “classic” banker actions\nlike stealing credentials from targeted bank applications and communicating with a C&C. Its\n“big brother” MalRhino, by contrast, contains a variety of advanced features and introduces\nthe use of open-source Rhino JavaScript Engine to process Accessibility events.\n\nIn this article, we provide the technical analysis of these malware variants and discuss the\ninnovative techniques they use to avoid detection, maximize the threat actor’s gain, and\nabuse very specific digital banking features such as the Pix system.\n\n## PixStealer: a technical analysis\n\nThe PixStealer malware’s internal name is “Pag Cashback 1.4″. It was distributed on\nGoogle Play as a fake PagBank Cashback service and targeted only the Brazilian PagBank.\n\nThe package name com.pagcashback.beta indicates the application might be in the beta\nstage.\n\nPixStealer uses a “less is more” technique: as a very small app with minimum permissions\nand no connection to a C&C, it has only one function: transfer all of the victim’s funds to an\nactor-controlled account.\n\nWith this approach, the malware cannot update itself by communicating with a C&C, or steal\nand upload any information about the victims, but achieves the very important goal: to stay\nundetectable.\n\nFigure 1: Virus Total detections of the PixStealer sample.\n\nLike many of the banking Trojans that appeared in the last few years (Evenbot, Gustaff,\nMedusa, and others), PixStealer abuses Android’s Accessibility Service. AAS’s main purpose\nis to assist users with disabilities to use Android devices and apps. However, when a victim\n\n\n-----\n\nis lured by banking malware into enabling this service, the Accessibility Service turns into a\nweapon, granting the application ability to read anything a regular user can access and\nperform any action a user can do on an Android device.\n\nWhen the application starts, the malware shows the victim a message box asking to activate\nthe Accessibility Service to get the alleged “cashback” functionality:\n\nFigure 2: The PixStealer malware asking for access to the Android Accessibility Service.\n\nSimilar to the previous versions of the malware, the service is named\ncom.gservice.autobot.Acessibilidade.\n\nAfter receiving the Accessibility Service permission, the malware shows a text message with\na call to open the PagBank application for synchronization. We should mention that once it\nhas the Accessibility Service access, the malware can open the app by itself. Most likely, it\nwaits for the user to open the app to avoid displaying typical “malware behavior”, which helps\nit remain undetected.\n\n\n-----\n\nAfter the victim opens the bank account and enters credentials, the malware uses the\nAccessibility to click the “show” button to retrieve the victim’s current balance.\n\nFigure 3: The malware will click on the “eye” icon to retrieve the account balance.\n\nThis number is saved to SharedPrefences under the key “valor” (“value” in Portuguese):\n\n\n-----\n\nFigure 4: The malware saving the account balance to SharedPreferences under key “valor”\n\nNext, the malware shows a fake overlay view asking the user to wait for the synchronization\nto finish:\n\nFigure 5: “Synchronizing your access… Do not turn off your mobile screen” overlay screen.\n\nThis overlay screen plays a very important role: it hides the fact that in the background the\nmalware is transferring all the funds to the actor-controlled account.\n\nTo perform the transfer, the malware first searches for the Transfer button:\n\n\n-----\n\nFigure 6 : The malware searches for the Transfer button.\n\nThe malware clicks on it by using the following Accessibility actions:\n\n\n-----\n\nFigure 7: The malware “click on button” function.\n\nThe transfer amount is the value that was retrieved at the start of the app – the entire\nbalance stored in the “valor” key in SharedPreferences:\n\n\n-----\n\nFigure 8: The malware searches for the text with the string “Informe o valor da transf”\n(“provide transaction value”) and enters the entire balance value to the transfer amount field.\n\nThe last action left is to enter the payment beneficiary. The malware searches for the\nCPF/CNPJ (Brazilian taxpayer identification number) field:\n\nFigure 9: The malware searches for the Brazilian ID field\n\nand then enters the threat actor’s “CPF” (Brazilian ID number) via accessibility functionality.\n\nFigure 10: The malware enters the actor-controlled ID for transfer using Pix.\n\n\n-----\n\nThis short video demonstrates the full malicious flow:\n\nPagBank application, targeted by PixStealer, implements an identity verification process\nbefore allowing the user to perform a Pix transaction. The process makes sure the device\nbelongs to the owner of the bank account and requires the user to pass the following steps\nfor each mobile device:\n\ntwo-factor authentication (credentials and SMS)\nupload documents that confirm the ownership of the account\ncapture a selfie with the device’s camera.\n\nOnly when the documents and the selfie pass manual check on the bank’s side, Pix transfer\nis enabled on the device. These measures guarantee that stolen credentials and even SIM\nswapping is not enough to be able to perform Pix transactions. The danger of malware like\nPixStealer is that it actually bypasses all these checks as it’s running on the victim’s device\nthat already passed the identification stage.\n\n## MalRhino – PixStealer’s “big brother”\n\nA standalone banker stealer that does not require a C&C connection is lightweight and\nalmost undetectable, but lacks the ability to dynamically make adjustments. By looking for\nsimilar applications, we found another version of the same family which has multiple code\nsimilarities with PixStealer: manifest, logs messages, service and method names.\n\n\n-----\n\nFigure 11: Example of similar logging functions in MalRhino (on the top) and PixStealer\nsamples.\n\nThe malicious application is a fake iToken app for Brazilian Inter Bank, with the package\nname com.gnservice.beta, and it was also distributed via Google Play Store.\n\nThe MalRhino variant uses JavaScript via Mozilla’s Rhino framework to process Accessibility\nEvents dynamically, depending on the top running app to provide the actor remote with code\nexecution access. This technique is not commonly used on mobile malware and shows how\nmalicious actors are becoming more innovative to avoid detection and get inside Google\nPlay. The last time our researchers found RhinoJS used for malicious actions was by the\nXbot banker malware in 2016.\n\nJust like in the previous version, the malware shows the victim a message trying to convince\nthem to give Accessibility permission:\n\nFigure 12: “To continue, activate accessibility service from the iToken developed by Inter\nDigital Development”.\n\nWhen it obtains Accessibility access, the malware performs the actions that are typical for\nthis malware and implements them the same way as in the previous versions:\n\nCollect the installed application and send the list to the C&C server together with the\nvictim’s device info\n\n\n-----\n\nRun banks applications\nRetrieve pin from the Nubank application\n\n## Targeted applications\n\nTo check if the top running application in the system is a supported banking app, the\nmalware uses a package name. To avoid detection of banking package names strings inside\nthe app, the malware reads the package name, calculates the MD5 checksum, and then\ncompares it with the pre-defined list:\n\nFigure 13: The malware checks the package name using MD5 hashes\n\nName Package Name Md5\n\nInter bank br.com.intermidium 2ef536239b84195e099013cfda06d3dd\n\nNuBank com.nu.production 678212691ab75ea925633512d9e3b5f4\n\nNext br.com.bradesco.next d74e8b32e9d704633bd69581a15f55de\n\nSantander com.santander.app 38737771e1ddab60c062cd0be323e89b\n\nUOL PagBank br.com.uol.ps.myaccount 5b3deb74ec783b05645b3fff5d56667d\n\nBanco original br.com.original.bank 64679e8af5f494db86fb7b7312e79ba9\n\nTable 1: List of bank applications targeted by MalRhino variant.\n\n## RhinoJS dynamic code execution\n\n**Rhino is a JavaScript engine written fully in Java and managed by the Mozilla Foundation as**\n[open-source software. Malware developers used an open-source rhino-android library that](https://github.com/F43nd1r/rhino-android)\nallows executing JavaScript code with the bridge to Java code.\n\nIf the running application is the one supported by the malware, it performs the request to the\nC&C server to get JavaScript code with Rhino JS “macros”:\n\n\n-----\n\nFigure 14: The malware runs the GetMacroForPackage function (top) which requests the\nserver for JS code according to the top running app.\n\nThe response from the C&C server contains JavaScript code to be executed by Using the\nRhino engine:\n\nFigure 15: The malware executes JavaScript code inside the targeted app.\n\nUsing Rhino JS engine the malware has the ability to perform remote code execution when a\nneeded app is launched. AccessibilityService code contains various utility methods that are\nnot used from Java code and are most likely intended to be triggered from the JavaScript\n\n\n-----\n\ncode the malware gets from the C&C server. These utility methods include creating fake\nwindows with PIN request, click on something, make gestures, input text etc.\n\nFigure 16: The utility methods performing different actions using the Accessibility Service.\n\n## Conclusion\n\nIn this article, we analyzed two significantly different versions of the banking malware. Both\nof them introduced new innovative techniques to perform different actions on victims’ mobile\nbank accounts. PixStealer version uses the Pix instant payment system to transfer all the\nfunds in the victim’s account to an actor-controlled one by abusing the Accessibility Service\non an unsuspecting user’s phone. The MalRhino version uses a JavaScript-based framework\nto run commands inside banking applications. With the increasing abuse of the Accessibility\nService by mobile bankers malware, users should be wary of enabling the relevant\npermissions even in the applications distributed via known app stores such as Google Play.\n\n[Check Point Harmony Mobile is a Mobile Threat Defense solution that keeps corporate data](https://www.checkpoint.com/harmony/mobile-security/mobile/)\nsafe by securing employees’ mobile devices across all attack vectors: apps, network and OS\n\n## IOCs\n\nPixStealer\n\n\n-----\n\n28e8170485bbee78e1a54aae6a955e64fe299978cbb908da60e8663c794fd195\ncom.pagcashback.beta\n\nc0585b792c0a9b8ef99b2b31edb28c5dac23f0c9eb47a0b800de848a9ab4b06c\ncom.pagback.beta\n\n8b4f064895f8fac9a5f25a900ff964828e481d5df2a2c2e08e17231138e3e902\ncom.gnservice.beta\n\nMalRhino\n\n2990f396c120b33c492d02e771c9f1968239147acec13afc9f500acae271aa11\ncom.gnservice.beta\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-29 - PixStealer- a new wave of Android banking Trojans abusing Accessibility Services.pdf"
    ],
    "report_names": [
        "2021-09-29 - PixStealer- a new wave of Android banking Trojans abusing Accessibility Services.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535824,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653787647,
    "ts_modification_date": 1653787647,
    "files": {
        "pdf": "https://archive.orkl.eu/74640a7afb701ea9ad4b26f587a4de1f8c864a5f.pdf",
        "text": "https://archive.orkl.eu/74640a7afb701ea9ad4b26f587a4de1f8c864a5f.txt",
        "img": "https://archive.orkl.eu/74640a7afb701ea9ad4b26f587a4de1f8c864a5f.jpg"
    }
}