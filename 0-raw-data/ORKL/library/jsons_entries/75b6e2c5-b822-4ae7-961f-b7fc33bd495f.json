{
    "id": "75b6e2c5-b822-4ae7-961f-b7fc33bd495f",
    "created_at": "2023-01-12T15:01:16.56077Z",
    "updated_at": "2025-03-27T02:06:05.134818Z",
    "deleted_at": null,
    "sha1_hash": "b8d9a2f00b5a015097aec9003294065dec38c9f7",
    "title": "2016-11-14 - Ransoc Desktop Locking Ransomware Ransacks Local Files and Social Media Profiles",
    "authors": "",
    "file_creation_date": "2022-05-28T19:50:11Z",
    "file_modification_date": "2022-05-28T19:50:11Z",
    "file_size": 1307564,
    "plain_text": "# Ransoc Desktop Locking Ransomware Ransacks Local Files and Social Media Profiles\n\n**[proofpoint.com/us/threat-insight/post/ransoc-desktop-locking-ransomware-ransacks-local-files-social-media-profiles](https://www.proofpoint.com/us/threat-insight/post/ransoc-desktop-locking-ransomware-ransacks-local-files-social-media-profiles)**\n\nNovember 14, 2016\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nRansoc Desktop Locking Ransomware Ransacks Local Files and Social Media Profiles\n\n\n-----\n\nNovember 14, 2016 Proofpoint Staff\n\n**Overview**\n\n[Ransomware has exploded in the last year, becoming the malware of choice for many threat](https://www.proofpoint.com/us/threat-reference/ransomware)\nactors because of its easy monetization and ease of distribution, whether via massive email\ncampaigns or through a variety of exploit kits. Proofpoint research suggests that the number\nof ransomware variants has grown tenfold since December 2015. While most such malware\nencrypts a victim's files and demands that a ransom be paid in Bitcoins to decrypt them,\nProofpoint researchers recently discovered a new variant that scrapes Skype and social\nmedia profiles for personal information while it scans files and torrents for potentially\nsensitive information. Instead of encrypting files, it threatens victims with fake legal\nproceedings if they fail to pay the ransom.\n\n**The Discovery**\n\nIn the last week of October, our colleague at FoxIT InTELL, Frank Ruiz, pointed us to a new\nbrowser locker variant. Unlike traditional encrypting ransomware like Locky, browser lockers\nare full-screen web apps that prevent users from accessing their operating systems or\nclosing the browser window. In this case, the browser locker displays a fake \"Penalty Notice\"\noffering to let the victim \"settle [their] case out of court,\" avoiding the threat of legal actions\nand much larger penalties for objectionable content and suspicious activity purportedly\ndiscovered on the victim's computer (Figure 1).\n\n\n-----\n\n_Figure 1: Browser locker “Penalty Notice”_\n\nThis browser locker was spread in United States via malvertising traffic (primarily fed by the\nPlugrush and Traffic Shop traffic exchanges on adult websites) aimed at Internet Explorer on\nWindows and Safari on OS X.\n\nThis type of threat was endemic between 2012 and 2014 and was frequently seen spreading\nconcurrently via exploit kit with “Police Locker” malware [1]. Since then, the same kind of\ntraffic has largely focused on exploit kit distribution of crypto ransomware and other malware\nas well as Tech Support scams in which victims are told to contact a fake tech support\nservice to remove malware from their PCs, usually for a fee to be paid by credit card.\n\nHowever, in the first week of November, we discovered an unusual malware variant that we\nbelieve is tied to the “Penalty Notice” browlock shown in Figure 1 based on visual and\nthematic similarities and distribution mechanisms. Note, however, that while the browser\nlocker functions cross-platform, the related malware, dubbed Ransoc, is a Windows binary.\n\n**Ransoc**\n\n\n-----\n\nIn a sandbox environment, we observed this new malware perform an IP check and send all\nof its traffic through the Tor network. Further examination revealed that the malware scanned\nlocal media filenames for strings associated with child pornography.\n\nWe also noticed that it was running several routines interacting with Skype, LinkedIn, and\nFacebook profiles (Figure 2).\n\n\n-----\n\n-----\n\n_Figure 2: Code examining Skype and social media profiles_\n\nThe code also examined folders from Torrent software (Figure 3).\n\n_Figure 3: Code examining Torrent folder contents_\n\nTo determine the nature of the malware's interaction with these services, we ran it manually\nin our sandbox. We logged into fake social network accounts then closed the browser and\nlaunched the Skype desktop application. As suspected, after running the malware, we saw it\nconnecting to the fake Facebook and LinkedIn profiles we created (Figure 4).\n\n\n-----\n\n_Figure 4: Ransoc capturing photos from social media account profiles_\n\nThe malware, which we call Ransoc because of its connections to social media, then\ndisplayed a Penalty Notice that was visually and functionally similar to the browser locker\nshown in Figure 1. The new Penalty Notice is shown in Figure 5. It appears that this penalty\nnotice only appears if the malware finds potential evidence of child pornography or media\nfiles downloaded via Torrents and customizes the penalty notice based on what it finds. If we\nmanually changed file names to match specific strings, we were able to trigger the penalty\nnotice.\n\n\n-----\n\n_Figure 5: New penalty notice with social media profile information and a threat stating that_\n_“All Collected Data will be made public and the case goes to trial!”_\n\nThe ransom message displays accurate personal data captured from Skype and social\nmedia profiles, including profile photos. It threatens to expose the collected \"evidence\" to the\npublic, with legitimate social profile information being used as a social engineering lure to\nconvince victims that sensitive information may actually be at risk of exposure. Unlike most\nransomware variants, the target here is the victim's reputation rather than their files. Ransoc\nalso includes code that may allow it to access a victim's webcam, although we did not verify\nthis functionality.\n\nThe ransom message is actually a full-screen window that functions much like the browser\nlocker application shown in Figure 1. However, Ransoc checks every 100ms for regedit,\nmsconfig, and taskmgr, killing the processes before victims have a chance to remove or\ndisable the malware. Ransoc only uses a registry autorun key to persist, though, so\nrebooting in Safe Mode should allow users to remove the malware. The sample we\n\n\n-----\n\nexamined had an HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\JavaErrorHandler\nregistry key with a value of a shortcut pathname ending in 'JavaErrorHandler.lnk', although\nfuture versions may use a different key.\n\nThe payment system (Figure 6) is also unusual.\n\n_Figure 6: Ransoc payment page_\n\nCredit card payment is almost unheard of in ransomware schemes. While it removes the\nhassle and confusion for many victims associated with Bitcoin processing, it also potentially\nallows law enforcement to trace activity back to the cybercriminal more easily.\n\nThis fairly bold approach to ransom payments suggests the threat actors are quite confident\nthat people paying the ransom have enough to hide that they will probably not seek support\nfrom law enforcement. In fact, while Ransoc may seem to be motivated by vigilantism\nagainst genuine criminals, the motives are likely less-than-altruistic, as the attackers target\n\n\n-----\n\nusers who will be unlikely to resist or inform the authorities and thus increase the likelihood\nof payment. This theory is further bolstered by the fact that most victims encounter this\nmalware via malvertising on adult websites and the penalty notice only appears when\nRansoc encounters potential evidence of illegally downloaded media (via BitTorrent) and\ncertain types of pornography. To encourage payment, the ransom note also claims that\nmoney will be sent back if the victim is not caught again in the 180 days.\n\n**Conclusion**\n\nAlthough exploit kit activity has dropped off precipitously over the past year, malvertising\nactivity remains strong, with threat actors exploring new ways to infect victims and extort\nmoney through this vector. By incorporating data from social media accounts and Skype\nprofiles Ransoc creates a coercive, socially engineered ransom note to convince its targets\nthat they are in danger of prosecution for their browsing habits and the contents of their hard\ndrives. With bold approaches to collecting payments, the threat actors appear confident in\ntheir targeting, introducing new levels of sophistication to ransomware distribution and\nmonetization.\n\n**Indicators of Compromise (IOCs)**\n\n**Date** **Domain** **IP** **Comment**\n\n2016-10-27 cis-criminal-report[.]com 5.45.86.171 Browlock for IE Windows\n\n2016-10-27 criminal-report[.]in 5.45.86.171 Browlock for Safari OSX\n\n2016-11-03 violation-report[.]in 5.45.86.171 Browlock for IE and Safari\n\n2016-11-02 latexfetishsex[.]com 78.47.134.204 Intermediate Redirector/TDS\n\n2016-11-03 italy-girls[.]mobi 5.9.86.131 Intermediate Redirector/TDS\n\n2016-11-10 N/A 5.45.86.148 IP found in the Ransoc\n\n**sha256** **Comment**\n\nfee53dc4e165b2aa45c3e7bd100b49c367aa8b7f81757617114ff50a584a1566 Ransoc\nPenaltyNotice\n\n\n-----\n\nReferences\n\n[1] [http://malware.dontneedcoffee.com/2014/05/police-locker-available-for-your.htm](http://malware.dontneedcoffee.com/2014/05/police-locker-available-for-your.html)\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-11-14 - Ransoc Desktop Locking Ransomware Ransacks Local Files and Social Media Profiles.pdf"
    ],
    "report_names": [
        "2016-11-14 - Ransoc Desktop Locking Ransomware Ransacks Local Files and Social Media Profiles.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535676,
    "ts_updated_at": 1743041165,
    "ts_creation_date": 1653767411,
    "ts_modification_date": 1653767411,
    "files": {
        "pdf": "https://archive.orkl.eu/b8d9a2f00b5a015097aec9003294065dec38c9f7.pdf",
        "text": "https://archive.orkl.eu/b8d9a2f00b5a015097aec9003294065dec38c9f7.txt",
        "img": "https://archive.orkl.eu/b8d9a2f00b5a015097aec9003294065dec38c9f7.jpg"
    }
}