{
    "id": "fafc989c-c402-47b6-961a-94ee6c34d917",
    "created_at": "2023-01-12T15:06:12.422036Z",
    "updated_at": "2025-03-27T02:15:35.47176Z",
    "deleted_at": null,
    "sha1_hash": "1d1dd66f1ad47d05905ac5830d38d2d0909bdb52",
    "title": "2022-06-30 - PennyWise Stealer- An Evasive Infostealer Leveraging YouTube To Infect Users",
    "authors": "",
    "file_creation_date": "2022-07-18T18:05:54Z",
    "file_modification_date": "2022-07-18T18:05:54Z",
    "file_size": 2768212,
    "plain_text": "# PennyWise Stealer: An Evasive Infostealer leveraging YouTube to infect users\n\n**blog.cyble.com/2022/06/30/infostealer/**\n\nJune 30, 2022\n\n## Multi-Threading Approach used For Rapid Exfiltration\n\nDuring our routine Threat-Hunting exercise, Cyble Research Labs came across a new stealer named\n[“PennyWise” shared by a researcher. The stealer appears to have been developed recently. Though this](https://twitter.com/James_inthe_box/status/1525249950900072448)\nstealer is fresh, the Threat Actor(s) (TA) has already rolled an updated version, 1.3.4.\n\nOur investigation indicates that the stealer is an emerging threat, and we have witnessed multiple samples of\nthis stealer active in the wild. In its current iteration, this stealer can target over 30 browsers and\ncryptocurrency applications such as cold crypto wallets, crypto-browser extensions, etc.\n\nThe stealer is built using an unknown crypter which makes the debugging process tedious. It uses\nmultithreading to steal user data and creates over 10 threads, enabling faster execution and stealing. The\nbelow figure shows the Pennywise stealer’s C&C panel.\n\n\n-----\n\nFigure 1 – Command\n\nand Control Server\n\n## Initial Infection: Spreading via YouTube\n\nThe TA spreads this PennyWise stealer as free Bitcoin mining software. The TA has created a video on\nYouTube containing the link to download the malware. In this campaign, the users who look for Bitcoin mining\nsoftware may become victims of Pennywise stealer.\n\nFigure 2 – Hosting Malware Campaign on YouTube\n\n\n-----\n\nWhen a user visits the link, the TA instructs them to download the malware hosted on the file hosting service.\nThe malware file is zipped and password protected. To appear legitimate, the TA has shared a VirusTotal link\nof a clean file that is not related to the file available for download. The TA also tricks the users into disabling\ntheir antivirus for successful malware execution, as shown below.\n\nFigure 3 – Manipulating User\nThe zip file contains an installer that drops the Pennywise stealer, executes it, and finally, the stealer\nexfiltrates the victim’s data to the C&C server. The figure below shows the network communication.\n\nFigure 4 – Network Communication\n\nAs per our observations, the TA has created over 80 Videos on their YouTube channel for mass infection. We\nhave also observed a few download links from the TA’s YouTube Channel that spread Pennywise stealer. The\nbelow figure shows the videos created for spreading malware via YouTube.\n\n\n-----\n\nFigure 5 – Over 80 videos created on the TA’s YouTube Channel\n\n## Technical Analysis\n\nThe infection starts with the loader (SHA256:\n_e43b83bf5f7ed17b0f24e3fb7e95f3e7eb644dbda1977e5d2f33e1d8f71f5da0) which injects the Pennywise_\nstealer into a legitimate .NET binary named “AppLaunch.exe” using a technique called “process hollowing”.\n\nFigure 6 – Process Hollowing\nThe .NET binary (SHA256: _3bbd6cdbc70a5517e5f39ed9dfad0897d5b200feecd73d666299876e35fa4c90) is_\ninjected into AppLaunch.exe which is the actual payload of Pennywise stealer. The Pennywise stealer has\nencoded strings that are decoded during the initial execution of malware. The figure below shows the function\n“Class84.method 0“, which is responsible for decoding these strings.\n\n\n-----\n\nFigure\n\n7 – Function for Decoding Strings\nUpon execution, the stealer initializes the variables that support the stealing functionality. The values are\ndecoded and assigned to these variables during run time, as shown in the below table.\n\n**Name** **Value** **Description**\n\n**string_0** 1.3.4 Stealer Version\n\n**string_1** 0 Flag\n\n**string_2** CRYPTED:ygBdfUqyTjr827lyAL47dg== Encrypted TA name\n\n**string_3** 9D16FBEF0D8A8F87529DE06A1C43C737 Mutex name\n\n**string_4** 0 Flag\n\n**string_5** 1 Flag\n\n**string_6** 7 Integer Value\n\n**string_7** 1 Flag\n\n**string_8** 0 Flag\n\n\n-----\n\n**string_9** 1 Flag\n\n**string_10** 0 Flag\n\n**string_11** — CreateChannel — String\n\n**string_12** 1 Flag\n\n\n**string_13** CRYPTED:vuw8jLF2e/Ljzrqrw2oAEBJLqFB8KtttiM5T7ns\n2bs4Dsnmons6Ixd82gskRZISF\n\n\nEncrypted C2 URL\n\n\n**dictionary_0** Document: RTF, Doc, Docx, txt, json Files stealer will be\nstealing\n\nThe stealer then creates a mutex named “9D16FBEF0D8A8F87529DE06A1C43C737” to ensure that only one\ninstance of malware is running at any given time on the victims’ machine. The malware terminates its\nexecution if the mutex is already present.\n\nFigure 8 – Running a Single\n\nInstance\nThe malware then gets the path of the targeted browsers for stealing user data. It targets the following\nbrowsers:\n\n30+ Chrome-based browsers\n5+ Mozilla-based browsers\nOpera\nMicrosoft Edge\n\n\n-----\n\nFigure 9 – Targeted browsers\nOnce the browser path is obtained, the malware fetches username, machine name, system language, and\ntimezone details from the victim’s system. In this case, the malware converts the timezone into Russian\nStandard Time (RST), as shown below.\n\n\n-----\n\nFigure 10 – Converting date-time to Russian Standard Time\nThe malware then retrieves the system language code using the CultureInfo class and gets the graphic driver\nand processor names of the victim’s machine using a WMI query. After this, it creates a string in the below\nformat to generate an MD5 hash.\n\n**_“mutex_name-Username-Machine_Name-Loanguage_code-Processor_name-Graphics_Driver_Name”_**\n\nThe hash value will be used to name a folder created with hidden attributes in the AppData\\Local directory\nand save the stolen data.\n\nFigure 11 – Creating a folder\n\nwith hidden attributes\nThe malware tries to identify the victim’s country using the CultureInfo class and terminates its execution if the\nvictim is based outside the following locations.\n\nRussia\nUkraine\nBelarus\nKazakhstan\n\nThis could indicate that the TA is trying to avoid scrutiny by Law Enforcement Agencies in these particular\ncountries.\n\n\n-----\n\nFigure 12 – Preventing Execution in certain countries\nThe malware performs multiple Anti-Analysis and Anti-Detection checks to prevent the execution of the\nmalware in a controlled environment. It uses Win32_ComputerSystem class to detect any virtual machine.\n\nThen, it checks for the following Dynamic-Link Library (DLL) files to identify the presence of antivirus\napplications and sandbox environments.\n\nSbieDll: Sandboxie\nSxIn: 360 Total Security\nSf2: Avast Antivirus\nSnxhk: Avast Antivirus\ncmdvrt32: COMODO\n\nIt also checks the running processes in the victims’ machine and terminates its execution if the following\nprocesses are running.\n\nprocesshacker\nnetstat\nnetmon\ntcpview\nwireshark\nfilemon\nregmon\ncain\nhttpanalyzerstdv7\nfiddler\nfiddler everywhere\nhttpdebuggersvc\n\n\n-----\n\nAfter this, the malware decrypts string_2 and string_13 in Table 1, which are encrypted using the Rijndael\nalgorithm. These strings possibly contain the TA’s user name and Command & Control (C&C) URL.\n\nFigure 13 – Decrypted Strings\nThe malware then creates a folder under the folder which was created initially in the Appdata\\Local directory\nin the following format:\n\n**_“UserName@MachineName_Loanguage_code_Year_Month_Date_Hour_Minute_Second@StealerVersion”_**\n\nThe malware uses multithreading to steal data from the victim’s system. Every individual thread is responsible\nfor performing a different operation, such as stealing the victim’s files, harvesting Chromium/Mozilla browser\ndata, stealing the browser’s cryptocurrency extension data, taking screenshots, stealing sessions of chat\napplications, etc.\n\nThe malware creates over 10 threads and executes them using Thread.Start() method.\n\nFigure 14 – Use of\n\nmultithreading by the TA\nThe malware only steals files smaller than 20KB and has RTF, Doc, Docx, txt, and JSON extensions which\nare saved in a folder named “grabber.”\n\n\n-----\n\nUsing the Directory.Exists() method, the malware identifies whether a targeted browser is present in the\nvictims’ machine and steals data if these browsers are found. The malware steals data from Chromium and\nMozilla-based browsers using the following method:\n\nThe sensitive user data, such as login credentials and cookies, stored in Chromium-based browsers is\npresent in an encrypted form.\n\nThe malware enumerates and gets the names of all files in the “Browser-name\\User Data\\” folder and checks\nfor the “Local State” file, which stores the encrypted key. The CryptUnprotectData() function decrypts the\nencrypted key, which will now be used to decrypt the login data file containing all users’ credentials.\n\nIn Mozilla-based browsers, the malware targets certain SQLite files named “cookies.sqlite”, “key4.db,”\netc., which store data such as encryption keys and master passwords for login.json. The login.json file\nwill be decrypted using these keys containing user credentials. The stolen cookies from browsers are\nsaved into a file named “[browser name_Default]_Cookies.txt”.\n\nFigure 15 – Checking\n\nwhether a targeted browser exists on the victim system\nFor stealing Discord tokens, the malware targets the following directories:\n\n_Discord\\Local Storage\\leveldb_\n_Discord PTB\\Local Storage\\leveldb_\n_Discord Canary\\leveldb_\n\nThe malware steals Telegram sessions by copying files from the “Telegram Desktop\\tdata” folder.\n\nIt also fetches the list of running processes using the Process.GetProcesses method and writes the data,\nincluding Process Name, PID, and execution path, to the “Processes.txt” file.\n\nFigure 16 – Fetching all running processes data\nThe malware takes a screenshot of the victim’s system and stores it as a file named “Screenshot.jpg.” It\ncreates a file named “Information.txt” that saves data such as location, details of the victim’s system, hardware\ndetails, antivirus, stealer version, victim’s unique ID, and date.\n\nThe malware queries the registry key\n_HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall to find the list of installed_\napplications and write this data to a file named “Software.txt” in the following format:\n\n\n-----\n\nApplication\nVersion\nLocation\n\nThe stealer queries the registry to identify the location of cryptocurrencies such as Litecoin, Dash, and Bitcoin,\nas shown in the figure below. It obtains the path from registry data “strDataDir” in\nthe HKEY_CURRENT_USER\\Software\\Blockchain_name\\ Blockchain_name-Qt registry key.\n\nFigure 17 – Querying Registry\nIt targets cold crypto-wallets such as Zcash, Armory, Bytecoin, Jaxx, Exodus, Ethereum, Electreum, Atomic\nWallet, Guarda, and Coinomi. To steal data from these wallets, the malware looks for wallet files in the\ndirectory shown in the figure below and copies them for exfiltration.\n\nFigure 18 –\n\nStealing data from cold crypto-wallets\nThis malware also targets crypto extensions of Chromium-based browsers for stealing data. The figure below\nshows the crypto extensions, along with their ID. It enumerates all files in the Browser_name\\User Data folder\nand checks for the “Local Extension Settings” folder where extension related data is stored This folder finds\n\n\n-----\n\nthe crypto browser extension using their extension ID.\n\nFigure 19 – Stealing data from crypto browser extensions\nThe malware then compiles the count for harvested data, as shown in Figure 16. Additionally, it compresses\nthe folder in which the stolen data was saved and exfiltrates it to “http[:]//185[.]246.116.237[:]5001/getfile“.\nThis folder is then deleted, removing all traces.\n\nFigure 20 – Exfiltration of data\n\n## Conclusion\n\n\n-----\n\nPennywise is an emerging stealer which is already making a name for itself. We have witnessed multiple\nsamples of Pennywise out in the wild, indicating that Threat Actors may already be deploying it. Though there\nis not much information regarding its adoption by cybercriminals at the moment, in the future, we may see\nnew variants of this stealer and observe further samples in the wild.\n\n## Our Recommendations\n\nAvoid downloading pirated software from unverified sites.\nUse strong passwords and enforce multi-factor authentication wherever possible.\nKeep updating your passwords after certain intervals.\nUse a reputed anti-virus and internet security software package on your connected devices, including\nPC, laptop, and mobile.\nRefrain from opening untrusted links and email attachments without first verifying their authenticity.\nBlock URLs that could be used to spread the malware, e.g., Torrent/Warez.\nMonitor the beacon on the network level to block data exfiltration by malware or TAs.\nEnable Data Loss Prevention (DLP) Solutions on employees’ systems.\n\n## MITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\n**Execution** [T1204](https://attack.mitre.org/techniques/T1204/) User Execution\n\n\n**Defense Evasion** [T1140](https://attack.mitre.org/techniques/T1140/)\n\n[T1497](https://attack.mitre.org/techniques/T1497/)\n\n[T1055.012](https://attack.mitre.org/techniques/T1055/012/)\n\n**Credential Access** [T1555](https://attack.mitre.org/techniques/T1555/)\n\n[T1539](https://attack.mitre.org/techniques/T1539/)\n\n[T1552](https://attack.mitre.org/techniques/T1552/)\n\n[T1528](https://attack.mitre.org/techniques/T1528/)\n\n\nDeobfuscate/Decode Files or Information\n\nVirtualization/Sandbox Evasion\n\nProcess Injection: Process Hollowing\n\nCredentials from Password Stores\n\nSteal Web Session Cookies\n\nUnsecured Credentials\n\nSteal Application Access Token\n\n\n**Collection** [T1113](https://attack.mitre.org/techniques/T1113/) Screen Capture\n\n\n**Discovery** [T1518](https://attack.mitre.org/techniques/T1518/)\n\n[T1124](https://attack.mitre.org/techniques/T1124/)\n\n[T1007](https://attack.mitre.org/techniques/T1007/)\n\n\nSoftware Discovery\n\nSystem Time Discovery\n\nSystem Service Discovery\n\n\n**Command and Control** [T1071](https://attack.mitre.org/techniques/T1071/) Application Layer Protocol\n\n**Exfiltration** [T1041](https://attack.mitre.org/techniques/T1041/) Exfiltration Over C2 Channel\n\n## Indicators of Compromise (IOCs)\n\n**Indicators** **Indicator**\n**type**\n\n\n**Description**\n\n\nhttp[:]//185[.]246.116.237[:]5001/getfile **URL** **C2 URL**\n\n\neef01a6152c5a7ecd4e952e8086abdb3\n\nfd3c1844af6af1552ff08e88c1553cc6565fe455\n\ne43b83bf5f7ed17b0f24e3fb7e95f3e7eb644dbda1977e5d2f33e1d8f71f5da0\n\n\n**Md5**\n\n**SHA-1**\n\n**SHA-256**\n\n\n**Loader**\n\n\n-----\n\n66502250f78c6f61e7725a3daa0f4220\n\n8cfc5d40a8008e91464fd89a1d6cb3a7b3b7a282\n\n05854ea1958ef0969a2c717ce6cb0c67cd3bcd327badac6aa7925d95a0b11232\n\na1249d31ea72e00055286c94592bc0e3\n\n8644ac0cc1a805f1682a0b0f65052a1835e599b1\n\n01c83c32ab5c2f0fda5c04aee7b02dc30d59c91c1db70e168a6cc1215cc53ab7\n\ne062fedb25bbf55894711100c35130c1\n\nb28568c19eaafd0e8212b81ea7b87340554e1340\n\nc5e9d0aa26ca6255559708bcf957d79e3adb4d2b08146cd765182f7b834227f4\n\nf71d077c9889d005c8c71f3a2fe20fd0\n\n2ba8275af7b7708a7f79bb442c980ec3d3c04b91\n\ndcd2c2073c227e5b496ca0cb13e31d18b45899dca0de1633f2eeb25d264258de\n\na6064cd1760ea08973b20bdc0e7ea699\n\nc5f3342e9fcc159eef81a459d54eb7b6ce80feb1\n\nbc709e3aea5732c3d07c7f59ea22f8a5c026e45558d0e2aa3fb35ac78f39d9f4\n\nc9ac6deb0ef78785d469033117411e3d\n\n15622e8ec3ec4c29f09b3871678199599d285e43\n\n0eb43cef2e674aa72b24cccd36b349ce0e4eb347c0fbf373bc53c97713e8e94f\n\nda9f8ec6d3337315435fa9d9d7868980\n\nebf6edd68e97bd13d4ed3e878c7bd11dfb5a628c\n\n117d5155fe3659a816f10faf859ff68c6094457eb1902d6699df74fac309befd\n\nd72619b4ededa0f8cfe9554557bf2c7f\n\nee456a4b32eff2eddf14c6ae5385d977081308b4\n\n4da90f77a26a16eee48cb73ca920e681974554be0d87a225e7ad9416adbf34c6\n\n215c203f7f3e3f63c5ae9e35d8625463\n\nb6bfbbd9c49cc94e4fcab413f62a12bb23485cdf\n\nbc51e019e91bbb8e704ee4b7027dab4f7168b3b4e947e83d43bf4c488aa2b612\n\nece1ffba058735ab9521ee1ed5cf969c\n\n35a06ba7f2cffaf5c2f97c7fe02d235c6317ebf2\n\n6dbeb13c7efbd62561bf2fea3b1e3d36021e701b80a993e28498182d0884ce6f\n\nf0807f8ec6349d726b19713ece98c57b\n\ne341cd9abfca8e02bef0d0af94343949a23ce6c4\n\nbf46b901e1899533629b751f28bd4adab3f11f0ddf8b509c9f90af25a1a73b5b\n\n88facb451a849d37a272ab9a7a83a47c\n\n27c66fa23f8af20be0234f95b35e64ccea7d73ae\n\n5b11938d67a8a0c629bf4ec1f8b77c6ba0910546984d4d983f43a25d4e7b72ac\n\n\n**Md5**\n\n**SHA-1**\n\n**SHA-256**\n\n**Md5**\n\n**SHA-1**\n\n**SHA-256**\n\n**Md5**\n\n**SHA-1**\n\n**SHA-**\n**256**\n\n**Md5**\n\n**SHA-1**\n\n**SHA-256**\n\n**Md5**\n\n**SHA-1**\n\n**SHA-256**\n\n**Md5**\n\n**SHA-1**\n\n**SHA-256**\n\n**Md5**\n\n**SHA-1**\n\n**SHA-256**\n\n**Md5**\n\n**SHA-1**\n\n**SHA-256**\n\n**Md5**\n\n**SHA-1**\n\n**SHA-256**\n\n**Md5**\n\n**SHA-1**\n\n**SHA-256**\n\n**Md5**\n\n**SHA-1**\n\n**SHA-256**\n\n**Md5**\n\n**SHA-1**\n\n**SHA-256**\n\n\n**Stealer**\n**Payload**\n\n**Stealer**\n**Payload**\n\n**Stealer**\n**Payload**\n\n**Stealer**\n**Payload**\n\n**Stealer**\n**Payload**\n\n**Stealer**\n**Payload**\n\n**Stealer**\n**Payload**\n\n**Stealer**\n**Payload**\n\n**Stealer**\n**Payload**\n\n**Stealer**\n**Payload**\n\n**Stealer**\n**Payload**\n\n**Stealer**\n**Payload**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-30 - PennyWise Stealer- An Evasive Infostealer Leveraging YouTube To Infect Users.pdf"
    ],
    "report_names": [
        "2022-06-30 - PennyWise Stealer- An Evasive Infostealer Leveraging YouTube To Infect Users.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535972,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1658167554,
    "ts_modification_date": 1658167554,
    "files": {
        "pdf": "https://archive.orkl.eu/1d1dd66f1ad47d05905ac5830d38d2d0909bdb52.pdf",
        "text": "https://archive.orkl.eu/1d1dd66f1ad47d05905ac5830d38d2d0909bdb52.txt",
        "img": "https://archive.orkl.eu/1d1dd66f1ad47d05905ac5830d38d2d0909bdb52.jpg"
    }
}