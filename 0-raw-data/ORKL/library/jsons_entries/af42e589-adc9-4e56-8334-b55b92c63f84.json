{
    "id": "af42e589-adc9-4e56-8334-b55b92c63f84",
    "created_at": "2022-10-25T16:48:24.403038Z",
    "updated_at": "2025-03-27T02:09:30.067014Z",
    "deleted_at": null,
    "sha1_hash": "61d6c5357eb7d3f894947eca04307396beb7d77f",
    "title": "0day.jp (ゼロデイ.JP): English Report of \"FHAPPI Campaign\" : FreeHosting APT PowerSploit Poison Ivy",
    "authors": "",
    "file_creation_date": "2018-07-18T07:19:58Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 5188939,
    "plain_text": "### { マルウェア | 脆弱性 | スパム | 0day | ボットネット } のセキュリティ・ブログ\n\n# English Report of \"FHAPPI Campaign\" : FreeHosting APT PowerSploit Poison Ivy\n\n_This is the English translation of analysis I made in Japanese: \"#OCJP-136: 「FHAPPI」 Geocities.jpとPoison Ivy(スパ_\n[イウェア)のAPT事件\", it has been translated by a professional hacker and translator, Mr. \"El\" Kentaro. He is very](https://twitter.com/elkentaro)\n**_good so I will not change any words he wrote, please contact him for the Japanese/English \"techie\" translation. -_**\n_rgds, @unixfreaxjp_\n\n|2|1|8|0|2|2|1|\n|---|---|---|---|---|---|---|\n\n\nリンク / 案内\n\n[記事のアーカイブ](http://blog.0day.jp/p/blog-page.html)\n\n[RSS](http://blog.0day.jp/rss.xml)\n\n[OCJPって何？](http://blog.0day.jp/2012/01/cleanup-japan-ocjp.html)\n\n[ファイル送る便（英語版）](http://x.malwaremustdie.org/sendsample.html)\n\n[ファイル送る便（バックアップ）](http://www.geocities.jp/arc_ocd/sendsamplejp.html)\n\n\nモバイル アクセス\n\n記事の検索\n\nアーカイブ・ダイレクトリー\n\nアーカイブ・ダイレクトリー\n\n最近の記事\n\n今日のお勧め解析記事\n\n|Col1|検索|\n|---|---|\n\n|アーカイブ・ダイレクトリー|Col2|\n|---|---|\n\n\n#### #OCJP 134 ダブル「 h ELF リ\n\n\n# 2 1 8 0 2 2 1\n\n\n-----\n\nVXRL(credit) contacted us regarding an APT phishing email that included a download link to a malware being hosted on\na Geocities website.\n\nSample/Evidence.\n\n*) Because we think its an APT attack we cannot disclose all of the contents of the email.\n\nAfter receiving the request to takedown and URL information, much of the received malware information was very\nunclear. I also examined the signature detection rate which turned out to be none. There was too few details. Without\nthe definite proof Geocities would not be able to do anything I decided to reverse engineer the APT.\n\nHere are the results of my analysis please use it to remove the malware.\n\nFrom the URL the malware was hosted on GeoCities Japan, Geocities is not a malware or malicious site but a free\nwebsite hosting for blogs and homepage.\n\n\n[#OCJP-128: ロシア系マルウェアボッ](http://blog.0day.jp/2015/10/ocjp-128-11.html)\nトネットのカムバック\n\n[【研究情報】暗号化されているマル](http://blog.0day.jp/2015/06/python.html)\nウェアデータが何とかPythonで…\n\nLockyランサムウェア: インフェック\n[ション仕組みのモニタリング・レコー](http://blog.0day.jp/2016/07/locky.html)\nド\n\n#OCJP-130: スパムボットに感染され\n[たPCからのスパムメール(マルウェア](http://blog.0day.jp/2016/07/pc.html)\nurl)\n\nPEStudio 8.18, Wireshark &\n[VirusTotalを使いマルウェア調査ガイ](http://blog.0day.jp/2014/04/pestudio-818-wireshark-virustotal.html)\nドビデオを作りました\n\n\nのレポートを書かせて頂きます。 内容的\nには「Linux OS x86」、「ELFバイナリリ\nバーシング」と「シェルコード」の絡み\nとなります。 この記事を読むだけでも\nOKですし、もし再現したい場合ASM 、\ngccとLinuxリバーシン...\n\n\n**0day.JPの人気の投稿**\n\n#OCJP-098： 【警告】 285件日本国内\nのウェブサイトが「Darkleech\n[Apache Module」に感染されて、IEで](http://blog.0day.jp/2013/03/ocjp-098-285blackhole-exploit-kit.html)\nアクセスすると「Blackhole」マル\nウェア感染サイトに転送されてしまい\nます！\n\n[bash 0dayマルウェア感染の「real](http://blog.0day.jp/2014/09/bash-0dayreal-time.html)\ntime」リバースエンジニアリング\n\n[【警告】新規Linux/Mayhemマルウェ](http://blog.0day.jp/2015/06/linuxmayhem.html)\nアの感染\n\n\n-----\n\n**MalwareMustDie! (MMD)**\n\n[Linux Malware Research List](http://blog.malwaremustdie.org/2016/11/linux-malware.html)\n\n[MMD-0061-2016 - Linux/OverkillMod](http://blog.malwaremustdie.org/2016/11/mmd-0061-2016-emech-for-ddos.html)\n\n[MMD-0060-2016 - Linux/UDPfker](http://blog.malwaremustdie.org/2016/10/mmd-0060-2016-linuxudpfker-and-chinaz.html)\n\n[MMD-0059-2016 - Linux/IRCTelnet](http://blog.malwaremustdie.org/2016/10/mmd-0059-2016-linuxirctelnet-new-ddos.html)\n\n\nThe account “vbiayay1” was used to host the actual malware sample.\n\nThe contents of the hosted malware file was VBScript encoded script.\n\n\n[MMD-0058-2016 - Linux/NyaDrop](http://blog.malwaremustdie.org/2016/10/mmd-0058-2016-elf-linuxnyadrop.html)\n\n[MMD-0057-2016 - Linux/LuaBot](http://blog.malwaremustdie.org/2016/09/mmd-0057-2016-new-elf-botnet-linuxluabot.html)\n\n[MMD-0056-2016 - Linux/Mirai](http://blog.malwaremustdie.org/2016/08/mmd-0056-2016-linuxmirai-just.html)\n\n[MMD-0055-2016 - Linux/PnScan](http://blog.malwaremustdie.org/2016/08/mmd-0054-2016-pnscan-elf-worm-that.html)\n\n[MMD-0054-2016 - ATMOS botnet](http://blog.malwaremustdie.org/2016/06/mmd-0054-2016-atmos-botnet-and-facts.html)\n\n[MMD-0053-2016 - Linux/STD IRCBot](http://blog.malwaremustdie.org/2016/04/mmd-0053-2016-bit-about-elfstd-irc-bot.html)\n\n\n[MMD-0052-2016 - Overall Linux DDoS](http://blog.malwaremustdie.org/2016/02/mmd-0052-2016-skidddos-elf-distribution.html)\n\n[MMD-0051-2016 - Linux/Tiny ELF-2](http://blog.malwaremustdie.org/2016/02/mmd-0051-2016-debungking-tiny-elf.html)\n\n[MMD-0050-2016 - Linux/Torte](http://blog.malwaremustdie.org/2016/01/mmd-0050-2016-incident-report-elf.html)\n\n[MMD-0049-2016 - Java/DldrRCE](http://blog.malwaremustdie.org/2016/01/mmd-0049-2016-case-of-java-trojan.html)\n\n[MMD-0048-2016 - Linux/DDOS.TF](http://blog.malwaremustdie.org/2016/01/mmd-0048-2016-ddostf-new-elf-windows.html)\n\n[MMD-0047-2015 - Linux/SSHV HidePID](http://blog.malwaremustdie.org/2015/12/mmd-0047-2015-sshv-ssh-bruter-elf.html)\n\n[MMD-0045-2015 - Linux/KDefend](http://blog.malwaremustdie.org/2015/12/mmd-0045-2015-kdefend-new-elf-threat.html)\n\n[MMDブログアーカイブ](http://blog.malwaremustdie.org/2016/)\n\n**JVN脆弱性情報**\n\n最新CVE情報\n\n**Cyber Awareness (US-CERT)**\n\n\n**E** **l it (最新版のみ)**\n\n\n-----\n\n_VBScript is a subset of Visual Basic and for people who have used Visual Basic or any VBA macro it should be a_\n_familiar programming language. However VBScript is designed to be run and executed within the browser and only_\n_can call functions considered basic such as file access and printing. Microsoft VBScript can be executed under_\n_Windows Script Host or Powershell._\n\n## 2. Reversing marathon of base64\n\nFirst I manually decoded the VBScript encoded sample, leading to the following code:\n\n*) if you want to know how this is possible contact me directly @malwaremustdie\n\nThe code by using Windows Script Host VBScript creates and object in the shell (read: CMD) and executes a run of the\nfollowing code:\n\n**powershell.exe -w hidden -ep bypass -Enc \"etc etc etc\".**\n\nThe meaning is, during script execution powershell hides the output (-w hidden) and executes \"etc etc etc\" which is\n**the base 64 coded command (Enc = EncodedCommand) without authentication (-ep bypass, ep = ExecutionPolicy).**\n\n\n**[malekal's site](https://www.malekal.com)**\nRéparer l’association de fichiers sur\nWindows\n_21 時間前_\n\n**[Didier Stevens](https://blog.didierstevens.com)**\n!exploitable Crash Analyzer –\nStatically Linked CRT\n_1 日前_\n\n**[Sucuri Blog](https://blog.sucuri.net)**\n[Persistent Malicious Redirect](https://blog.sucuri.net/2018/07/persistent-malicious-redirect-variants.html)\nVariants\n_1 日前_\n\n**[Virus Bulletin news](https://www.virusbulletin.com/rss)**\nNew paper: Does malware based on\nSpectre exist?\n_1 日前_\n\n**[Errata Security](https://blog.erratasec.com/)**\nYour IoT security concerns are\nstupid\n_5 日前_\n\n**[Dynamoo's Blog](https://blog.dynamoo.com/)**\n[Phishing and fraudulent sites hosted](https://blog.dynamoo.com/2018/05/phishing-and-fraudulent-sites-hosted-on.html)\non 188.241.58.60 (Qhoster)\n\n\n**Linuxセキュリティ・アップデート**\n\nマイクロソフト・セキュリティ情報\n\n\nおすすめ研究サイト一覧\n\n**[Schneier on Security](https://www.schneier.com/blog/)**\n[Installing a Credit Card Skimmer on a](https://www.schneier.com/blog/archives/2018/07/installing_a_cr.html)\nPOS Terminal\n_19 時間前_\n\n\n-----\n\n_Designed on the basis of object oriented, it is based on .NET Framework. PowerShell is having strict policy for_\n_performing the script execution, however, by using optional execution parameter the attacker can utilize PowerShell_\n_to run a malicious script. Once called Microsoft Shell (MSH, codenamed Monad)._\n\nContinuing the decoding of the \"etc etc etc\" code, leads to the following script↓\n\nOnce again its a VBScript, this script creates a web client object and uses the proxy setting and user rights to\ndownload a file from a url and execute the file.\n\nThis allow the opening of a .doc (MS word) file.\n\n\n**[XyliBox](http://www.xylibox.com/)**\n[Citadel 0.0.1.1 (Atmos)](http://www.xylibox.com/2016/02/citadel-0011-atmos.html)\n_2 年前_\n\n**Andre' M. DiMino -**\n**SemperSecurus**\nAnother look at a cross-platform\nDDoS botnet\n_4 年前_\n\n\n**[contagio](http://contagiodump.blogspot.com/)**\nRootkit Umbreon / Umreon - x86,\nARM samples\n_3 か月前_\n\n**[MALware FORensics SECurity](http://malforsec.blogspot.com/)**\n[Sundown Exploit kit](http://feedproxy.google.com/~r/MalwareForensicsSecurity/~3/ZdM7yb7ydkg/sundown-exploit-kit.html)\n_1 年前_\n\n\n**[S!Ri.URZ](http://siri-urz.blogspot.com/)**\n[ThinkPoint](http://siri-urz.blogspot.com/2016/05/thinkpoint.html)\n_2 年前_\n\n\n-----\n\nThen by utilizing IEX (Invoke-Expression) commandlet will allow it to execute a script under Windows PowerShell and\ndownload and execute a .ps1 file from another url.\n\nLets dive into the .ps1 file↓\n\n\n-----\n\nOnce again its a base 64 encoded code, and it shows that it used the IEX command to decode.\n\nLooks like this malicious actor really likes base 64, so back to reversing the base 64 manually.\n\n\n-----\n\nThe above is the decoded code, but its another base 64 encoded code. (_ _|||)；；；；\n\nHowever it finally revealed some of the infection code, the actual malware payload is in this base 64 code.\n\nThe code also revealed infection vectors for 32 bit and 64 bit, it hides itself as a fake “Security Update” process and\nuses powershell.exe to execute the base 64 code by decoding it with an IEX command.\n\nOk, back to decoding base 64 again!!\nOnce decoded the 2 functions came up and a shellcode appeared.\n\n\n-----\n\nThe above codes are all self-explanatory, read the commands line by line. It explains how a powershell can be used as\nlethal vector to exploit a bad malware by process injection, and all are in a script!!!\n\n## ３．Copy/Pasting PowerSploit/CodeExecution PoC\n\n\n-----\n\nCopy-and-Paste rulzzz….(maybe)\n\nThis is one of the reasons I am against releasing malware code to the public.\nGitHub is full of these types source codes.\n\n## ４．ShellCode\n\nThe main payload of this sample turned out to be mostly a copy and paste job of the PowerSploit/CodeExection and\nthe shell code and multilayered base64 encoding is original to this sample.\n\nSo to reveal the actually shell code we have decode the rest using base 64 again…oh no..\n\n**$Shellcode = [System.Convert]::FromBase64String($Shellcode32)**\n\nOnce decoded the shellcode header can be analyzed as:↓\n\n\n-----\n\nWe could just reverse engineer it as is, however it might take some time..\n\n\n-----\n\nSo looks like we need and XOR Key “0xe9” and byte length: 0x2183 I didn't want to write it further before but now\n\n\n-----\n\nIts getting late and I need my beauty sleep, and I can’t spend much time on this so I will share a neat way to handle\nthis shellcode :)\n\nSo I used assembly and created a PE binary file using this shellcode.\n\nSaving the shell code data in the .text section of the assembly file and the entry point(EP) will be \"adjusted\" by the\ncompiler during compilation process therefore you can execute this shellcode as a binary PE file. This method is very\nuseful when analyzing shellcodes. And by using a Unix environment you can create this PE without risking an infection.\n(For this sample I conducted most of my analysis in FreeBSD)\n\n\n-----\n\nBy using gcc or nasm to compile the PE file can be created in FreeBSD.\n\nSo we can now analyze the code for further analysis and behavior analysis of the malware without any risk.（＾－＾ｖ\n\nSo it turns out that much of the behavior of the sample conducts many malware actions, the shellcode extracts\ninformation of its victim and calls back to a C2 server and other nefarious actions.\nWriting out exactly what the payload does will take a very long time but here is the draft of the sample’s payload\nb h i di i h d i i I d f d i i ( f l h d i i ) ↓\n\n\n-----\n\n(This hand writing diagram contains the shellcode process, for both shellcodes used by FHAPPI. The first one is what\nhad been injected by the powershell.exe, the second one is what had been injected into the userinit.exe process. I’ll\nclean up once I get to it, besides the malicious actor could be reading this post too. So once the necessary steps are\ntaken I might clean this up)\n\n_Shellcode is a piece of code used as a payload that uses software security holes in computer security. Shell codes are_\n_often written in machine language. In order to allow an attacker to control an intruding machine, they often launches_\n_a shell, for that a machine language code is executed._\n_Shell code is not necessarily just to start a shell, even without opening any shell, intrusion of malicious commands_\n_can be performed, for example, executing a specific function of a library by addressing specific work space in kernel_\n_for execution of a malicious activities, so it is said that the name of shell code is insufficient. However, other terms_\n_have not been established so far._\n\n## ５．POISON IVY\n\nThe shell code utilizes many system calls and hence the shell code itself is somewhat bloated\n\n\n(This hand writing diagram contains the shellcode process, for both shellcodes used by FHAPPI. The first one is what\n\n\n-----\n\n_*) you will need to sort these out by analyzing the flow of the malware in assembly mode._\n\nI notices this is a 「Poison Ivy」 during the first stage of trace-assembly analysis of the shellcode:\n\n\n_*) you will need to sort these out by analyzing the flow of the malware in assembly mode._\n\n\n-----\n\nAs you can see a fake 「userinit.exe」process was made, and a malicious code was injected in the process and then\nto be executed. The victims will see a BAD 「userinit.exe」process is doing bad stuff. This is a typical Poison Ivy\nscheme. Further, the usage of the certain combination of DLL is showing a typical pattern of the threat too. More\nover, the date stamped in the MUTEX name is mostly used by Poison Ivy (specific format).\n\n_What looks like a mouse, should be a mouse.._\n\nIf you want to see the whole figure of Poison Ivy used by this campaign, you will need to compile it as a binary and\nanalyze it as per described above, or you can decrypt the XOR with a patience, and then go by opcode per opcode\nreversing. It is very do-able, and as the proof you can see the following screenshots of what I decrypted by radare2 (I\nonly use one r2 shell for this under a FreeBSD OS, no fancy stuff, if I can do this then you can do the same)\n\n\n-----\n\n## Another shellcode in a shellcode..\n\n\n-----\n\nThis second shell code was generated during the XOR-decrypting process when PowerSploit (malware script of\npowershell.exe) injected the first shell code, and the first shell code to then injecting this second shell code into\nuserinit.exe process. First shell code is the whole PoisonIvy itself, second shellcode is the installed infectious\n**payload to the client's PC. See the screenshot I took while cracking the first shell code by XOR below in radare2, it**\nshows the second shell code was formed during the first shell code was XOR-decrypted itself:\n\n\n-----\n\n↑It's hard to see or noticing malicious part of the second shellcode by ASCII view, let's see it in binary mode↓\n\n\n-----\n\nNow I see the suspicious「 CreateThread 」DLL call printed out in there, very suspicious.\nThe type of this shellcode is in x86-32 with the size of 255 bytes.\n\nTo get more idea on how it works, you will have to see it's flow with any tool you prefer, but I have my beloved one,\nand the result is like this:\n\n\n-----\n\n-----\n\n**_GetComputerNameA, GetPriorityClass, SetPriorityClass DLL functions were called._**\n\nTo explain it a bit more, Poison Ivy shellcode during injection of the userinit.exe process was direct/undirectly\ninvolved in loading the necessary DLLs in the kernel space. The second shellcode (injected to the userinit.exe) has\ntwo types of \"calls\", the short ones are caling to the \"Hint\" address of the function in a DLL in memory map and\nsecond one is aiming for the \"RVA\" addresses.\n\nTo confirm about which address belongs to which functions of what DLL, one needs to know which DLL that was\nbeforehand used or loaded by the malware and then during the condition of \"infection\" or during the simulation of that\ninfection, the dump of the related DLL can show exact addresses that are applicable. For this case, there are many\nways to dissect this, in the Windows OS there is tool called PE Dumper. This tool (or similar ones) will show which are\nRVA and Hint calls addresses and goes to specific functions. This is why I can know precisely which call were used.\nNoted: I can not be too transparent for not inspiring other bad guys to do the same.\n\nIn my test PC (it's a 64bit windows since I run it as image under BSD) the snapshot of kernel.dll calls can be seen as\nper following screenshot picture:\n\n\n-----\n\nThe reversed process for the second shellcode can be disassembled as per what I did in below report (it is the \"head\"\nof the longer analysis).\n\n\n-----\n\nYou can see this \"bad\" userinit.exe is operated and creating the file called 「Plug1.dat」, it made socket for the\nfurther works, and querying PC info through 「HKEY_LOCAL_MACHINE\\SYSTEM\\Setup の SystemSetupInProgress」,\nwe'll see the values sent afterward. The next malicious process will be executed too. And these overall process will be\nlooped. I had to terminate the process of loop itself in the 9th time, so I save the data of the Plug1.dat to Plug9.dat.\n\nThe process being executed by the second shellcode can be seen clearly. I made a graph to describe it as per below:\n\n\n-----\n\n※）memo: A hand-made diagram I wrote was actually describing the whole process of the shellcode injected via\npowershell.exe, which also having the process traced of the second shellcode. The both shellcode are in interaction\nduring the infection process.\n\n_...now it started to sound like a mouse too..it is a mouse!_\n\nUp to this point, there is no doubt this is a Poison Ivy.\n\n\n-----\n\nseems that there is a socket(),gethostbyname() and a connect() call. These revealed hostname and IP address for the\ncallback, along with minor information.\n\nThe IP address is a dial-up IP in South Korea.↓\n\nNetwork/BGP Information→「61.97.243.15||4766 | 61.97.243.0/24 | KIXS-AS | KR | kisa.or.kr | KRNIC」\n\nSo the hacker was utilizing another country for the CNC purpose, let's see more:\n\nHostname: web.outlooksysm.net\n\n\nNetwork/BGP Information 61.97.243.15||4766 | 61.97.243.0/24 | KIXS-AS | KR | kisa.or.kr | KRNIC\n\n\n-----\n\nThis is the used domain's WHOIS info:\n\nDomain Name: outlooksysm.net\nRegistry Domain ID: 10632213\nRegistrar WHOIS Server: grs-whois.cndns.com\nRegistrar URL: http://www.cndns.com\nUpdated Date: 2016-05-27T11:24:02Z\nCreate Date: 2016-05-27T11:19:45Z\nRegistrar Registration Expiration Date: 2017-05-27T11:19:45Z\nRegistrar: SHANGHAI MEICHENG TECHNOLOGY INFORMATION DEVELOPMENT CO., LTD.\nRegistrar IANA ID: 1621\nRegistrar Abuse Contact Email: domain@cndns.com\nRegistrar Abuse Contact Phone: +86.2151697771\nReseller: (null)\nDomain Status: ok https://icann.org/epp#ok\nRegistry Registrant ID:\nRegistrant Name: Liu Ying\nRegistrant Organization: Liu Ying\nRegistrant Street: Nan An Shi Jing Hua Lu 88Hao\nRegistrant City: NanAnShi\nRegistrant State/Province: FuJian\nRegistrant Postal Code: 009810\nRegistrant Country: CN\nRegistrant Phone : +86 13276905963\n\n\n-----\n\nSo we know where this asshole is coming from...\n\nJust analyzing the code is not enough evidence, I needed a safe way to execute PE file to conduct further behavioral\nanalysis. This way I could capture all the CNC/C2 traffic.↓\n\nIn this traffic was sent my test PC info (knew this after decoded) （＠。＠；；\n\n\n-----\n\nThe first transmission has a size of 256 bytes…this looks interesting…↓\n\n\n-----\n\nSo by looking ups some reference material turns out that this 256 byte transmission is an identifiable traffic pattern\nfor the Poison Ivy RAT. (The Challenge and Response Traffic for Poison Ivy) ↓\n\n\n-----\n\n_Poison Ivy: Poison Ivy also known as PIVY is a RAT (Remote Administration Tool), its a back door style malware._\n_Many espionage related malware utilize this Poison Ivy kit in APT(Targeted Attacks)_\n\n## ７．Conclusion\n\nThis APT campaign utilized many variants to falsely have the victim download a malicious VBScript, which then\ndownloaded a secondary staged attack .doc file and opening it. Behind this action it quietly executes a\nPowerShell(PowerSploit) attack to infect the victims with Poison Ivy into a process running in memory.\n\n\n-----\n\nPowerSploit used shellcode. The concept of infection is fileless, its avoiding known signature for detection by multiple\nencodings and wraps, and it is also 100% avoiding the original attacker's working territory. This will make the current\nAPT campaign has better chance of success other cases caused by similar payload.\n\nThis APT campaign utilized multiple accounts on Geocities Japan, leading to the possibility that there is a larger APT\ncampaign being conducted. The TPPs of this attack were the first to be recognized in Japan, and after discussing the\nattack with my friends and fellow researchers we have named it “Free Hosting (pivoted) APT PowerSploit Poison Ivy”\n(FHAPPI)\n\nCredit: El Kentaro (FHAPPI Idea and logo、credit), Luffy, Syota Shinogi 、Ino Yuji (credit) ++\n\nTo avoid further victims I really hope that the vbiayay1 account on Geocities.jp gets taken down quickly and the\nmalware deleted. I hope that this analysis can help in the investigation and the countering of this threat.\nAlso from the analysis I am certain that the Korean IP address 61.97.243.15 is a CNC for Poison Ivy therefore\nrecommend blocking access to and from this IP.\n\nI also have already contacted Gmail regarding the email sender, the following address were used:\n**1. wisers.data@gmail.com**\n**2. health.pro.demo30@gmail.com**\n\nThese accounts can be used in other APT campaigns, so I suggest blocking & start tracing these addresses.\nI also hope that malware source codes and PoC are not shared in public.\n\n## ８．Sample\n\nI’m still working on this, so I will only share the hashes for the samples.\nI will add the VT URLs once I am done.\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n1.MD5 (Meeting_sumｘｘ.doc) = 0011fb4f42ee9d68c0f2dc62562f53e0\n2.MD5 (ｘｘｘ0301.ps1)    = b862a2cfe8f79bdbb4e1d39e0cfcae3a\n3.MD5 (Meeting_ｘｘｘ.doc)  = 0011fb4f42ee9d68c0f2dc62562f53e0\n4.MD5 (ｘｘｘ0301.ps1)    = b862a2cfe8f79bdbb4e1d39e0cfcae3a\n5.MD5 (ｘｘｘ0301.wsc)    = 7c9689e015563410d331af91e0a0be8c\n6.MD5 (shellcode-bin)    = cb9a199fc68da233cec9d2f3d4deb081\n7.MD5 (stupid-shellcode.exe) = 661d4e056c8c0f6804cac7e6b24a79ec\n\nOther samples. (credit: Syota Shinogi)\nMD5 (f0921.ps1)      = e798a7c33a58fc249965ac3de0fee67b\n\n\n-----\n\nThanks to Syota Shinogi’s help (credit) in further researching he found another Geocities Japan account.\nIt uses the same PowerSploit shell code and the .doc file was a document in Mongolian, possibly targeting users in or\nrelated to Mongol.\n\nScreen shot ↓\n\n\n-----\n\n９，２．File name contains the APT information\n\nURL and attack campaign related information : ↓\n\nThis shows the attack date, target ID and some form of versioning/series type of information.\n\n９．３．The Deletion process of the APT malware files\n\nWith the help of the Yahoo Incident Response Division (YIRD) and JP-CERT/CC and other great security folks in Japan\nthe files was successfully deleted.\n\nThe following files were deleted.↓\n\n\n-----\n\n※）Deletion confirmed time : 2017 March. 11th 10:00 am\n\nthank you all for your help.\n\n９．４．FHAPPI Campaign targeting Mongol\n\nThe user lgxpoy6」contains data for Mongolian APT target. The infection vector is the same, judging from the date it\nstarted sometime in September of last year. Many artifacts and web sigs has gone or faded but, what the heck, so\nlets analyze this too for the malware improvement comparison..\n\nThe first installer script was not obfuscated using base 64.\n\n\n-----\n\nThe encode command executed by powershell.exe has the same format ↓\n\nMongolian Decoy Document ↓\n\n\n-----\n\nStill uses PowerSploit to inject the malware into memory, no changes here.↓\n\n\n-----\n\nA slightly different shell code design ↓\n\n\n-----\n\nThe Mongolia related campaign also uses XOR but a different key “0xd4” but the byte length is the same “0x2183”\n\n\n-----\n\nThe CNC is in the mainland of China, with the hostname(S) that I will expose later can be seen in screenshots in next\npart)\n\n\n-----\n\nThe Poison Ivy version used in the Mongolia campaign is the same as the main analysis shown above that aims other\ncountry.\n\nThe interesting part is the hostnames used in the Mongolia campaign were hardcoded two hostnames instead of one\n(the main analysis APT is only have one hardcoded domains). However please see the template used, this version of\nPIVY can contains up to 3 (three) hostnames (or IPs).\n\n\n-----\n\nPS: Did you see what domains that was used? ;)\n\nHmm, okay, good, now we know exactly who is behind this attack..\n\n\n-----\n\nThu Mar 15 05:42:14 JST 2017 @luffy(credit) corrected some Japanese wording in documentation. (thank you)\n[Fri Mar 17 00:48:30 JST 2017 @elkentaro translated the whole documents into English](https://twitter.com/elkentaro)\n\n※）PS: I might update this later with more material.\n\n# 0 件のコメント:\n\n コメントを投稿\n\nコメントを入力...\n\nコメントの記入者: [Google ][アカウン]\n\n公開公開 プレビュープレビュー\n\n[ホーム](http://blog.0day.jp/)\n\n[登録: 投稿 (Atom)](http://blog.0day.jp/feeds/posts/default)\n\n人気の投稿\n\n#OCJP-098： [【警告】 285件日本国内のウェブサイトが「Darkleech Apache Module」に感染されて、IEでアクセスすると「Blackhole」マルウェア感染サイトに転送され](http://blog.0day.jp/2013/03/ocjp-098-285blackhole-exploit-kit.html)\nてしまいます！\n\n\nコメントを入力...\n\n\n公開公開\n\n\n-----\n\n[bash 0dayマルウェア感染の「real time」リバースエンジニアリング](http://blog.0day.jp/2014/09/bash-0dayreal-time.html)\nゼロデイが出るといつも大忙し。 特にリバースエンジニアリングの僕らの手が回らない状態です。 《一日目》 CVE-2014-6271（bash 0day）の発表後24時間\n以内にMalwareMustDieのチームメートから連絡があり、私が調査してマルウェア感染攻撃を発見し...\n\n[【警告】新規Linux/Mayhemマルウェアの感染](http://blog.0day.jp/2015/06/linuxmayhem.html)\n下記のＩＰアドレスから Linux/Mayhemマルウェア の感染動きを発見、wordpressのサイトが狙われています。 wordpressの安全性が低いパスワードを狙いbruteで攻撃さ\nれ、クラッキングされるとＰＨＰマルウェアインストーラーファイルをサーバーにアップロードさ...\n\n[#OCJP-128: ロシア系マルウェアボットネットのカムバック](http://blog.0day.jp/2015/10/ocjp-128-11.html)\n以前の 0day.jp記事に も日本国内に対して「Kelihosマルウェア・ボットネット」の感染を報告しましたが 今回このロシア系マルウェア感染ボットネットが\n「カムバック」しましたので、 今日我々「MalwareMustDie」が12時間モニターしたら、日本国内の感染IP1...\n\n[(c) 2017, ZeroDay Japan | http://blog.0day.jp |. 「シンプル」テーマ. Powered by Blogger.](https://www.blogger.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2017/2017.03.15.FHAPPI_Campaign/english-report-of-fhappi-freehosting.pdf"
    ],
    "report_names": [
        "english-report-of-fhappi-freehosting"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1531898398,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/61d6c5357eb7d3f894947eca04307396beb7d77f.pdf",
        "text": "https://archive.orkl.eu/61d6c5357eb7d3f894947eca04307396beb7d77f.txt",
        "img": "https://archive.orkl.eu/61d6c5357eb7d3f894947eca04307396beb7d77f.jpg"
    }
}