{
    "id": "4715a684-22a8-4d59-8821-a2118e82d937",
    "created_at": "2023-01-12T15:07:01.40812Z",
    "updated_at": "2025-03-27T02:05:37.060094Z",
    "deleted_at": null,
    "sha1_hash": "83c315fdd74688f5ced7b84422311e27f66d3243",
    "title": "2021-04-12 - Deep water- exploring phishing kits",
    "authors": "",
    "file_creation_date": "2022-05-28T05:12:01Z",
    "file_modification_date": "2022-05-28T05:12:01Z",
    "file_size": 1708202,
    "plain_text": "# Deep water: exploring phishing kits\n\n**blog.group-ib.com/phishing-kits**\n\n12.04.2021\n\nIvan Lebedev\n\nCERT-GIB analyst\n\nAbout 10 years ago, Group-IB started developing a unique system to collect phishing kits.\nPhishing kits, a tool used by scammers, already had quite a rich history at the time. Over this\nperiod, Group-IB's Computer Emergency Response Team (CERT-GIB) built a solid phishing\nkit database, which was updated regularly. The database helps Group-IB fight phishing that\ntargets specific brands.\n\n\n-----\n\nPhishing kits are archive files with a set of scripts that ensure a phishing website works.\nSimply put, it is a toolset used to build phishing websites in large numbers. Such kits allow\nscammers with basic programming skills to deploy hundreds of phishing pages, often using\nthem as substitute for each other.\n\n**Brands**\n\nIn 2020, Group-IB discovered phishing kits that targeted over 260 unique brands. The most\npopular brand exploited in phishing kits was Microsoft and its products and services such as\nMicrosoft Live, Microsoft Office 365, Microsoft OneDrive, and Microsoft Outlook. Other\npopular brands targeted by phishing kits include PayPal, Google, and Yahoo.\n\nCybercriminals mainly target online services (30.7%). By stealing user account credentials,\nhackers gain access to the data contained in linked bank cards. Email services became less\nappealing last year, with the share of phishing kits targeting them dropping to 22.8%.\nFinancial institutions turned out to be the third favorite among scammers, with their share\ntotaling above 20%.\n\nMost kits continue to use email to exfiltrate stolen data. As it stands, only 6% of phishing kits\ndo not use any email addresses, while 64% of them use two or more email addresses.\n\n\n-----\n\nCybercriminals most often use free email services to exfiltrate stolen data. For example, the\ntop 10 most common email domains found in phishing kits include public email services only.\nThey account for 61% of the total number of emails used in phishing kits.\n\nAs a rule, scammers use disposable temporary emails in phishing kits. Only 23% of emails\nfound in Group-IB's phishing kit database were used more than once.\n\nAlternative methods of exfiltrating stolen data\n\n\n-----\n\nCERT-GIB analysts divide alternative ways for cybercriminals to obtain data into two main\ncategories: local (when the data is stored in a file located on the phishing resource itself) and\nremote (when it is sent to a different host).\n\nLocal techniques:\n\nText files: They usually have a .txt extension, but others exist as well, for example .jpg.\nIn any case, the data is usually written in text format. The stolen data files are stored on\nthe same hosting as the phishing site and can be downloaded externally.\n\nMySQL databases: This technique is difficult to implement and therefore rarely used. It\nis not easy to extract data from the source. The problem is that creating the database\nrequires additional effort, which is not usually automated by the developer of the\nphishing kit. A typical phishing kit contains only a brief guide to setting up a database,\nwhich requires basic knowledge of how to operate one.\n\nRemote techniques:\n\n- Sending a GET/POST request to a remote server: The server can be legitimate or owned\nby the attackers. Some cybercriminals use Google Forms to transfer stolen data, for\nexample.\n\n- Sending data via Telegram API: This is an increasingly popular technique that makes it\npossible to send compromised data to a private Telegram channel using a special script. To\ndo so, scammers require only an API key and a channel ID. There is a special Telegram\nplatform for creating and performing phishing attacks. A recent study by Group-IB about the\nClassiscam scheme describes the platform in detail.\n\nA script used to transfer data to a private Telegram channel:\n\n\n-----\n\nExtra features\n\nSometimes the functionality of phishing kits goes beyond creating phishing pages. They may\nbe used to upload a malicious file to the victim's device. One of the phishing kits examined\nby CERT-GIB allowed the scammers to create a temporary file using the VBScript language\nand then add the malicious code of the Ramnit worm to it in binary form, byte by byte. The\ncode was then run using the Windows Script Host.\n\nAn example of a script for uploading malware to the host of a user who visited the phishing\npage:\n\n\n-----\n\nThere is also another well-known phishing kit peculiarity. Usually, phishing kits are created to\nbe sold on the darknet to scammers with poor developer skills, which is why about 10% of\nphishing kits contain backdoors that the original developers use to extract stolen data or\neven assume control over the hosting resource.\n\nTo extract stolen data, the developer needs to discreetly indicate an additional email address\nthat will receive the data. In the example below, the buyer of a phishing kit is asked to specify\nan \"email\" using the \"yourmail\" variable:\n\nIn this case, the sending function uses not only the variable \"yourmail\", but also the array\n\"send\", which contains not only the \"legal\" email address but also a \"token\" decoded from the\nhexadecimal code.\n\nAn example of sending hidden data to the developer of the phishing kit is shown below:\n\n\n-----\n\nThe \"token\" variable is initialized with a POST request from other scripts that control the\nreceipt of stolen data.\n\nInitializing the \"token\" variable with a hexadecimal string:\n\n**Decoded data from the \"token\" variable**\n\nAfter decoding, the string looks like this:\n\nThe first sending function is followed by a second one, which sends information only to the\nhidden addresses specified in the \"mail\" variable.\n\n**Encoded and decoded hidden email of the phishing kit developer**\n\nDevelopers of phishing kits may use more sophisticated ways of hiding additional emails. In\nthe example below, the email is hidden in the IP variable. At first glance, it may seem that it\nis not specified anywhere at all, and it cannot be found using a regular file search.\n\nA smarter way to hide the email of the phishing kit developer:\n\n\n-----\n\nHowever, it should be noted that the sec.gif script shown below was connected.\n\nObfuscated sec.gif script:\n\nThe objective of this script is to set the value of the IP variable to noreply@mi—Å***ite[.]com.\n\nDevelopers do not limit themselves to hiding additional emails. There are scripts that open\nweb shells on hosting resources unknown to the buyer of the kit. A web shell is a malicious\nscript (program) that allows scammers to control websites and servers by executing terminal\ncommands, brute-forcing passwords, accessing the file system, and more. Most often,\nscammers exploit vulnerabilities in the website code or use brute-force to deliver the script.\n\nIn the example below, the web shell is part of the robots.php script.\n\nA web shell embedded in a phishing kit:\n\nThe web shell interface is quite straightforward. It allows uploading any file to the hosting\nresource.\n\nWeb shell interface:\n\n\n-----\n\nAccess to the web shell requires a password, which after SHA1 and MD5 hashing will look\nlike this: aafedc957d39b975c5d15413825b033f.\n\nAnother case study by CERT-GIB shows a more complicated technique. The web shell was\nnot located in the phishing kit but required downloading from a Pastebin, the link to which\nwas assembled part by part.\n\nHidden web shell download:\n\nIt should be mentioned that the antibot.php script is a simple way to bypass automatic\ndetection of phishing resources, which restricts access to phishing pages from specific IP\naddresses or using specific user agents/hostnames. In this specific example, the link is\nspecified in the array of known bots/crawlers, for which access to the phishing resource will\nbe limited.\n\nArray with a disassembled link:\n\nThe downloadable script consists of two parts. The first one is a public web shell that works\nsimilarly to the previous one and simply uploads files to the hosting resource.\n\nPublic web shell:\n\n\n-----\n\nThe second one, obfuscated using a simple algorithm and hidden after the lure text, is an\nadditional web shell. The developer of the phishing kit is notified when the web shell is\ninstalled.\n\nHidden web shell:\n\nSome developers leave additional traces in phishing kits, which can make it easier to\nattribute them in the future:\n\n\n-----\n\n-----\n\n-----\n\nShare\n\nReceive insights on the latest cybercrime trends\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-12 - Deep water- exploring phishing kits.pdf"
    ],
    "report_names": [
        "2021-04-12 - Deep water- exploring phishing kits.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536021,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1653714721,
    "ts_modification_date": 1653714721,
    "files": {
        "pdf": "https://archive.orkl.eu/83c315fdd74688f5ced7b84422311e27f66d3243.pdf",
        "text": "https://archive.orkl.eu/83c315fdd74688f5ced7b84422311e27f66d3243.txt",
        "img": "https://archive.orkl.eu/83c315fdd74688f5ced7b84422311e27f66d3243.jpg"
    }
}