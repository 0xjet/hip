{
    "id": "530463b0-d64c-45f4-802f-35d5fa6e3b04",
    "created_at": "2023-01-12T15:05:26.675366Z",
    "updated_at": "2025-03-27T02:05:46.439979Z",
    "deleted_at": null,
    "sha1_hash": "48a6bb45a154ec0659fee495645a52eba5ec854a",
    "title": "2017-08-31 - Lookout discovers sophisticated xRAT malware tied to 2014 “Xsser - mRAT” surveillance campaign against Hong Kong protesters",
    "authors": "",
    "file_creation_date": "2022-05-28T00:44:13Z",
    "file_modification_date": "2022-05-28T00:44:13Z",
    "file_size": 1446949,
    "plain_text": "# XRAT Malware Tied to \"Xsser/MRAT\" Surveillance\n\n**blog.lookout.com/xrat-mobile-threat**\n\nLookout researchers have identified a mobile trojan called xRAT with extensive data\ncollection functionality and the ability to remotely run a suicide function to avoid detection.\nThe malware is associated with the high-profile Xsser / mRAT malware, which made\nheadlines after targeting both iOS and Android devices of pro-democracy Hong Kong\nactivists in late 2014.\n\nLookout continues to regularly acquire new Android-variant samples of mRAT from multiple\nsources, and we have seen detections that show it has been live on Android devices in\nrecent months. The frequency with which these samples are being deployed in the wild\nsuggests that this family is still under continual development and actively used in various\ncampaigns.\n\nLookout identified xRAT due to a combination of suspicious capabilities it uses, such as\ndynamically loading additional code, executing native libraries, using specific ciphers, and\naccessing sensitive user information. Samples from both mRAT and xRAT families have an\nalmost identical code structure, make use of the same decryption key, share certain\nheuristics and naming conventions, and interestingly contain anti-debugging techniques that\ncause the a frequently-used malware researcher tool, the dex2jar decompiler, to crash.\nThese many similarities strongly suggest that mRAT and xRAT have been developed by the\nsame threat actor.\n\n\n-----\n\nThe command and control servers for xRAT are also linked to Windows malware, indicating\nthat the malicious actors behind this threat are conducting multi-platform attacks against the\nPCs and mobile devices of targeted groups.\n\n## What it does\n\nThe discovery of xRAT and continued improvements to both xRAT and mRAT clearly\ndemonstrate that threat actors are capable of deploying sophisticated tools to retrieve\nintelligence from mobile endpoints. Like mRAT, xRAT supports an impressive set of\ncapabilities that include flexible reconnaissance and information gathering, detection\nevasion, specific checks for antivirus, app and file deletion functionality, and other\nfunctionality listed below. It also searches for data belonging to popular communications\napps like QQ and WeChat. The threat actors themselves are able to remotely control much\nof its functionality in real time (e.g., which files to retrieve and what the settings of its\nautomatic file retrieval module should be).\n\nListed below are the types of data gathered by xRAT and features that enable it to perform\nreconnaissance, run remote code, and exfiltrate data from Android devices:\n\nBrowser history\nDevice metadata (such as model, manufacturer, SIM number, and device ID)\nText messages\nContacts\nCall logs\nData from QQ and WeChat\nWifi access points a device has connected to and the associated passwords\nEmail database and any email account username / passwords\nDevice geolocation\nInstalled apps, identifying both user and system applications\nSIM Card information\nProvide a remote attacker with a shell\nDownload attacker specified files and save them to specified locations\nDelete attacker specified files or recursively delete specified directories\nEnable airplane mode\nList all files and directories on external storage\nList the contents of attacker specified directories\nAutomatically retrieve files that are of an attacker specified type that are between a\nminimum and maximum size\nSearch external storage for a file with a specific MD5 hash and, if identified, retrieve it\nUpload attacker specified files to C2 infrastructure\nMake a call out to an attacker specified number\nRecord audio and write it directly to an already established command and control\nnetwork socket\n\n\n-----\n\nExecutes attacker specified command as the root user\nInstructs an infected device to repeatedly download, and then delete, large files exhausting a user's mobile data.\n\n## xRAT runs a suicide function to avoid detection\n\nxRAT also contains suicide functionality. When triggered, xRAT will clean out its installation\ndirectory before issuing a package manager command to uninstall itself. The developers\nbehind xRAT created an alert system, flagging to the malware operator if any of the following\nantivirus applications are present on a compromised device.\n\n管家 (housekeeper)\n安全 (safety)\n权限 (Authority)\n卫士 (Guardian)\n\n清理 (Cleanup)\n杀毒 (Antivirus)\nDefender\nSecurity\n\nOur analysis found xRAT contains a robust file deletion module, capable of removing large\nportions of a device or attacker-specified files. xRAT can be remotely instructed to perform\nthe following deletion operations:\n\nRemove images from certain directories on the SDCard\nRemove audio files from certain directories on the SDCard\nWipe a device, removing large portions; including all files from the SDCard, all apps\nand data that exists under the path /data/data/, and all system apps installed under the\npath /system/app/.\nRemove specific input method editors (IME). This includes\ncom.htc.android.htcime,\nHTC_IME.apk, com.samsung.inputmethod,\nSamsungChineseIME.apk,\ncom.tencent.qqpinyin,\ncom.sohu.inputmethod.sogou,\ncom.iflytek.inputmethod,\ncom.google.android.inputmethod.pinyin, com.tencent.qqpinyin-1.apk,\ncom.sohu.inputmethod.sogou-1.apk,\ncom.google.android.inputmethod.pinyin-1.app,\ncom.iflytek.inputmethod-1.apk, and\nother generic instances of IME apps.\nRemoves messaging applications from a compromised device. This includes\ncom.tencent.mm,\n\n\n-----\n\nim.yixin, com.tencent.mobileqq,\ncom.whatsapp, and\nother messaging applications that may have a similar package name.\n\nThese features further highlight the considerable amount of control xRAT operators have\nover a compromised phone, allowing it to evade detection by covering its tracks and deleting\nentire sections of a device.\n\n## Command and control infrastructure\n\nThe majority of command and control servers used by xRAT in the past have been based in\nChina with some appearing in Hong Kong. After analyzing recently acquired samples, we\nfurther identified attacker infrastructure on the East Coast of the United States. This may\nindicate an expansion in deployment from the actor behind this family as they've previously\nused servers geographically close to regions where their tooling is being deployed.\n\n\n-----\n\nInterestingly, the adversary infrastructure has Windows malware associated to it. One\nparticular malicious executable is named MyExam, indicating that the actors behind this\nfamily may be continuing to target students, similar to how attackers used mRAT during the\nprotests in 2014.\n\n\n-----\n\n## Data compromise via xRAT highlights valuable data on mobile devices\n\nxRAT appears to specifically target political groups, but it's also a good example of how\nmuch data can be compromised via a mobile device.\n\nEnterprises must be prepared for these types of threats that compromise contacts,\nmessaging app conversations, email, Wi-Fi passwords, SIM card information, audio, and text\nmessages. Data compromise via mobile presents a significant risk to company-confidential\ndata, and can risk an enterprise's compliance standing, potentially resulting in hefty fines.\n\nThis is particularly concerning for businesses who will be subject to GDPR come May 2018,\nwhich demands enterprises protect personal information for anyone it interacts with or sends\nto the European Union. Enterprises should invest in a mobile threat detection solution to\n\n\n-----\n\ncomplement EMM/MDM technologies, providing invaluable visibility into threats and risks to\nenterprise data via mobile devices.\n\nLookout is continuing to investigate the actor behind xRAT, its supporting infrastructure, and\nthe evolving capabilities of the surveillanceware itself.\n\n_Interested in learning more about our Threat Intelligence service or how a threat like xRAT_\n_[could impact your enterprise? Contact us today.](https://www.lookout.com/info/enterprise-contact-us?camp=701i0000001De2A)_\n\nSHA-1s\n\n0a58d677ad5fc1562b6ceb6395cfb7b819cc511f\n20e9b876c2d4253ce61bff01ae364c06b7fa61f4\n655599f68ec019d3ad8c2d66283958e2dd1e3b9d\ncd20dcd07278714083c757aa07db3a6f663a0b36\n9e71b0d6bc2b6ffe6f5774b5218de710cee7fe7a\n701fe85b177b9eba92e1c7e99e64381d950a7b62\ncd1f88caeb30e3f4b0467093175c952fbd433872\ne9fc56c772a70002358c78bc65ba0c0cc0f70447\n585fc6502ed786db13a7afff8ba61e2eed8e26b9\n979da00fe2986a0cbc12b60a9419232ab1bf7218\n2125c20ffd03eff2be2c46dfdd8a2092b73e5766\n35eb14fca9dd8f95c0b8c416d2d4191388d40e01\n26325f1e6066e1069d88ca570116bb8bac311a23\n0aed0f17af2998593b08dad254d3c01dfc6d4d8e\n6836826b47fcc0c0128ed35c8e546d7c1f7076bd\ndac7a2baa45e47e251ffe5446228914141edd077\neea40659209a2df7fb4106e9040fe4931c1da3cc\naaaab3bed79ce615de0e22576e6118cd2d5f624d\nfc583449a9da921995a909bb78a29c794af2fa37\nf006fb13d238a7f39e7cf7fe4521a79664cf8a4a\n\nLookout researchers have identified a mobile trojan called xRAT with extensive data\ncollection functionality and the ability to remotely run a suicide function to avoid detection.\nThe malware is associated with the high-profile Xsser / mRAT malware, which made\nheadlines after targeting both iOS and Android devices of pro-democracy Hong Kong\nactivists in late 2014.\n\nLookout continues to regularly acquire new Android-variant samples of mRAT from multiple\nsources, and we have seen detections that show it has been live on Android devices in\nrecent months. The frequency with which these samples are being deployed in the wild\n\n\n-----\n\nsuggests that this family is still under continual development and actively used in various\ncampaigns.\n\nLookout identified xRAT due to a combination of suspicious capabilities it uses, such as\ndynamically loading additional code, executing native libraries, using specific ciphers, and\naccessing sensitive user information. Samples from both mRAT and xRAT families have an\nalmost identical code structure, make use of the same decryption key, share certain\nheuristics and naming conventions, and interestingly contain anti-debugging techniques that\ncause the a frequently-used malware researcher tool, the dex2jar decompiler, to crash.\nThese many similarities strongly suggest that mRAT and xRAT have been developed by the\nsame threat actor.\n\nThe command and control servers for xRAT are also linked to Windows malware, indicating\nthat the malicious actors behind this threat are conducting multi-platform attacks against the\nPCs and mobile devices of targeted groups.\n\n## What it does\n\nThe discovery of xRAT and continued improvements to both xRAT and mRAT clearly\ndemonstrate that threat actors are capable of deploying sophisticated tools to retrieve\nintelligence from mobile endpoints. Like mRAT, xRAT supports an impressive set of\ncapabilities that include flexible reconnaissance and information gathering, detection\nevasion, specific checks for antivirus, app and file deletion functionality, and other\nfunctionality listed below. It also searches for data belonging to popular communications\napps like QQ and WeChat. The threat actors themselves are able to remotely control much\nof its functionality in real time (e.g., which files to retrieve and what the settings of its\nautomatic file retrieval module should be).\n\nListed below are the types of data gathered by xRAT and features that enable it to perform\nreconnaissance, run remote code, and exfiltrate data from Android devices:\n\nBrowser history\nDevice metadata (such as model, manufacturer, SIM number, and device ID)\nText messages\nContacts\nCall logs\nData from QQ and WeChat\nWifi access points a device has connected to and the associated passwords\nEmail database and any email account username / passwords\nDevice geolocation\nInstalled apps, identifying both user and system applications\nSIM Card information\nProvide a remote attacker with a shell\nDownload attacker specified files and save them to specified locations\n\n\n-----\n\nDelete attacker specified files or recursively delete specified directories\nEnable airplane mode\nList all files and directories on external storage\nList the contents of attacker specified directories\nAutomatically retrieve files that are of an attacker specified type that are between a\nminimum and maximum size\nSearch external storage for a file with a specific MD5 hash and, if identified, retrieve it\nUpload attacker specified files to C2 infrastructure\nMake a call out to an attacker specified number\nRecord audio and write it directly to an already established command and control\nnetwork socket\nExecutes attacker specified command as the root user\nInstructs an infected device to repeatedly download, and then delete, large files exhausting a user's mobile data.\n\n## xRAT runs a suicide function to avoid detection\n\nxRAT also contains suicide functionality. When triggered, xRAT will clean out its installation\ndirectory before issuing a package manager command to uninstall itself. The developers\nbehind xRAT created an alert system, flagging to the malware operator if any of the following\nantivirus applications are present on a compromised device.\n\n管家 (housekeeper)\n安全 (safety)\n权限 (Authority)\n卫士 (Guardian)\n\n清理 (Cleanup)\n杀毒 (Antivirus)\nDefender\nSecurity\n\nOur analysis found xRAT contains a robust file deletion module, capable of removing large\nportions of a device or attacker-specified files. xRAT can be remotely instructed to perform\nthe following deletion operations:\n\nRemove images from certain directories on the SDCard\nRemove audio files from certain directories on the SDCard\nWipe a device, removing large portions; including all files from the SDCard, all apps\nand data that exists under the path /data/data/, and all system apps installed under the\npath /system/app/.\nRemove specific input method editors (IME). This includes\ncom.htc.android.htcime,\nHTC IME.apk, com.samsung.inputmethod,\n\n\n-----\n\nSamsungChineseIME.apk,\ncom.tencent.qqpinyin,\ncom.sohu.inputmethod.sogou,\ncom.iflytek.inputmethod,\ncom.google.android.inputmethod.pinyin, com.tencent.qqpinyin-1.apk,\ncom.sohu.inputmethod.sogou-1.apk,\ncom.google.android.inputmethod.pinyin-1.app,\ncom.iflytek.inputmethod-1.apk, and\nother generic instances of IME apps.\nRemoves messaging applications from a compromised device. This includes\ncom.tencent.mm,\nim.yixin, com.tencent.mobileqq,\ncom.whatsapp, and\nother messaging applications that may have a similar package name.\n\nThese features further highlight the considerable amount of control xRAT operators have\nover a compromised phone, allowing it to evade detection by covering its tracks and deleting\nentire sections of a device.\n\n## Command and control infrastructure\n\nThe majority of command and control servers used by xRAT in the past have been based in\nChina with some appearing in Hong Kong. After analyzing recently acquired samples, we\nfurther identified attacker infrastructure on the East Coast of the United States. This may\nindicate an expansion in deployment from the actor behind this family as they've previously\nused servers geographically close to regions where their tooling is being deployed.\n\n\n-----\n\nInterestingly, the adversary infrastructure has Windows malware associated to it. One\nparticular malicious executable is named MyExam, indicating that the actors behind this\nfamily may be continuing to target students, similar to how attackers used mRAT during the\nprotests in 2014.\n\n\n-----\n\n## Data compromise via xRAT highlights valuable data on mobile devices\n\nxRAT appears to specifically target political groups, but it's also a good example of how\nmuch data can be compromised via a mobile device.\n\nEnterprises must be prepared for these types of threats that compromise contacts,\nmessaging app conversations, email, Wi-Fi passwords, SIM card information, audio, and text\nmessages. Data compromise via mobile presents a significant risk to company-confidential\ndata, and can risk an enterprise's compliance standing, potentially resulting in hefty fines.\n\nThis is particularly concerning for businesses who will be subject to GDPR come May 2018,\nwhich demands enterprises protect personal information for anyone it interacts with or sends\nto the European Union. Enterprises should invest in a mobile threat detection solution to\n\n\n-----\n\ncomplement EMM/MDM technologies, providing invaluable visibility into threats and risks to\nenterprise data via mobile devices.\n\nLookout is continuing to investigate the actor behind xRAT, its supporting infrastructure, and\nthe evolving capabilities of the surveillanceware itself.\n\n_Interested in learning more about our Threat Intelligence service or how a threat like xRAT_\n_[could impact your enterprise? Contact us today.](https://www.lookout.com/info/enterprise-contact-us?camp=701i0000001De2A)_\n\nSHA-1s\n\n0a58d677ad5fc1562b6ceb6395cfb7b819cc511f\n20e9b876c2d4253ce61bff01ae364c06b7fa61f4\n655599f68ec019d3ad8c2d66283958e2dd1e3b9d\ncd20dcd07278714083c757aa07db3a6f663a0b36\n9e71b0d6bc2b6ffe6f5774b5218de710cee7fe7a\n701fe85b177b9eba92e1c7e99e64381d950a7b62\ncd1f88caeb30e3f4b0467093175c952fbd433872\ne9fc56c772a70002358c78bc65ba0c0cc0f70447\n585fc6502ed786db13a7afff8ba61e2eed8e26b9\n979da00fe2986a0cbc12b60a9419232ab1bf7218\n2125c20ffd03eff2be2c46dfdd8a2092b73e5766\n35eb14fca9dd8f95c0b8c416d2d4191388d40e01\n26325f1e6066e1069d88ca570116bb8bac311a23\n0aed0f17af2998593b08dad254d3c01dfc6d4d8e\n6836826b47fcc0c0128ed35c8e546d7c1f7076bd\ndac7a2baa45e47e251ffe5446228914141edd077\neea40659209a2df7fb4106e9040fe4931c1da3cc\naaaab3bed79ce615de0e22576e6118cd2d5f624d\nfc583449a9da921995a909bb78a29c794af2fa37\nf006fb13d238a7f39e7cf7fe4521a79664cf8a4a\n\n## Lookout Discovers Sophisticated xRAT Malware Tied to 2014 “Xsser / mRAT” Surveillance Campaign Against Hong Kong Protesters\n\nAugust 31, 2017\n\nDownload Case Study\n**{{consumer=\"/components/cta/consumer\"}}**\n\nTAGS:\n\n\n-----\n\n|\n\n[Threat Intelligence](https://blog.lookout.com/tag/threat-intelligence)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-08-31 - Lookout discovers sophisticated xRAT malware tied to 2014 “Xsser - mRAT” surveillance campaign against Hong Kong protesters.pdf"
    ],
    "report_names": [
        "2017-08-31 - Lookout discovers sophisticated xRAT malware tied to 2014 “Xsser - mRAT” surveillance campaign against Hong Kong protesters.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "16f2436b-5f84-44e3-a306-f1f9e92f7bea",
            "created_at": "2023-01-06T13:46:38.745572Z",
            "updated_at": "2025-03-27T02:00:02.907444Z",
            "deleted_at": null,
            "main_name": "APT40",
            "aliases": [
                "ISLANDDREAMS",
                "TEMP.Jumper",
                "BRONZE MOHAWK",
                "GADOLINIUM",
                "KRYPTONITE PANDA",
                "TA423",
                "MUDCARP",
                "Gingham Typhoon",
                "TEMP.Periscope",
                "G0065",
                "ATK29",
                "Red Ladon",
                "ITG09"
            ],
            "source_name": "MISPGALAXY:APT40",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "59be3740-c8c7-47aa-84c8-e80d0cb7ea3a",
            "created_at": "2022-10-25T15:50:23.481057Z",
            "updated_at": "2025-03-27T02:00:55.480695Z",
            "deleted_at": null,
            "main_name": "Leviathan",
            "aliases": [
                "MUDCARP",
                "Kryptonite Panda",
                "Gadolinium",
                "BRONZE MOHAWK",
                "TEMP.Jumper",
                "APT40",
                "TEMP.Periscope",
                "Gingham Typhoon"
            ],
            "source_name": "MITRE:Leviathan",
            "tools": [
                "Windows Credential Editor",
                "BITSAdmin",
                "HOMEFRY",
                "Derusbi",
                "at",
                "BLACKCOFFEE",
                "BADFLICK",
                "gh0st RAT",
                "PowerSploit",
                "MURKYTOP",
                "NanHaiShu",
                "Orz",
                "Cobalt Strike",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535926,
    "ts_updated_at": 1743041146,
    "ts_creation_date": 1653698653,
    "ts_modification_date": 1653698653,
    "files": {
        "pdf": "https://archive.orkl.eu/48a6bb45a154ec0659fee495645a52eba5ec854a.pdf",
        "text": "https://archive.orkl.eu/48a6bb45a154ec0659fee495645a52eba5ec854a.txt",
        "img": "https://archive.orkl.eu/48a6bb45a154ec0659fee495645a52eba5ec854a.jpg"
    }
}