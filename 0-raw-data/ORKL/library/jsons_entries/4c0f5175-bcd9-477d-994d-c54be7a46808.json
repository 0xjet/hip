{
    "id": "4c0f5175-bcd9-477d-994d-c54be7a46808",
    "created_at": "2023-01-12T15:07:27.441193Z",
    "updated_at": "2025-03-27T02:08:33.296002Z",
    "deleted_at": null,
    "sha1_hash": "1881d1278330887ebf6b078a202c128bedc266cc",
    "title": "2022-01-23 - [QuickNote] Emotet epoch4 & epoch5 tactics",
    "authors": "",
    "file_creation_date": "2022-05-28T15:24:02Z",
    "file_modification_date": "2022-05-28T15:24:02Z",
    "file_size": 1564270,
    "plain_text": "# [QuickNote] Emotet epoch4 & epoch5 tactics\n\n**[kienmanowar.wordpress.com/2022/01/23/quicknote-emotet-epoch4-epoch5-tactics/](https://kienmanowar.wordpress.com/2022/01/23/quicknote-emotet-epoch4-epoch5-tactics/)**\n\nJanuary 23, 2022\n\n[This article is based on samples collected by Mr. Brad Duncan through his excellent lab:](https://unit42.paloaltonetworks.com/author/bduncan/)\n[2022-01-20 (THURSDAY) – EMOTET EPOCH 4 AND EPOCH 5 INFECTIONS](https://www.malware-traffic-analysis.net/2022/01/20/index.html)\n\n**Emotet epoch4:**\n\nThe time of the initial infection in the pcap file ( 2022-01-20-Emotet-epoch4-infection```\nwith-spambot-activity.pcap ) is around 2022-01-20 19:37 UTC, when the victim\n\n```\nclicks on the link in the spam mail, they will access the address\n```\nmangaloresoundandlights[.]com :\n\n```\nIf the access is successful, the victim will be asked to download an Excel file similar to the\nimage below (this file will have a random name after each access. As in Mr. Brad Duncan’s\n_summary, the file he downloaded has file name:_ `12772684608453.xls ):`\n\n\n-----\n\nAnalyzing the downloaded xls file, this file uses XLM macro, when the victim opens and\nallows macro for executing, it will call `mshta.exe to load the` `fe2.html` file at the address\n```\nhxxp://0xb907d607 :\n\n```\n[The host contains a hexadecimal representation of the IP address. Using CyberChef, I can](https://gchq.github.io/CyberChef/)\nconverted the hexadecimal numbers to retrieve the real IP address: `185[.]7[.]214[.]7`\n\nThe pcap file has result similar to the following:\n\nThe above html file contains javascript, so `mshta.exe will execute this script:`\n\n\n-----\n\nJavascript when executed will spawn Powershell process to download the `fe2.png file at`\nthe same address. Based on the powershell command, it can be seen that the `png` file will\nalso be a powershell script.\n\nLooking at the pcap file:\n\nCompare the content between the file provided by Mr. Brad Duncan and the file I\ndownloaded:\n\nBased on the content of the png file, it can be seen that this powershell script will iterate all\nthe list of urls and try download payload and save it under the name\n```\n\"C:\\Users\\Public\\Documents\\ssd.dll\" . If the download is successful, it will call\nrundll32.exe to execute ssd.dll .\n\n```\nI tried downloading the Dll from one of the urls in the `fe2.png file:`\n\nIn the pcap file, the result is similar to the following:\n\n\n-----\n\nFrom the Dll file provided by Mr. Brad Duncan as well as the Dll file that I downloaded, it is\neasy to unpack the [emotet core Dll:](https://www.virustotal.com/gui/file/931cf2ec23e034d8677c61e6be19ca79591a49c8a664d256f465a2d1e8331bd1)\n\nWith Emotet’s core Dll unpacked, I can find and extract C2 configuration information as well\nas the keys used to encrypt traffic and verify data:\n\n[The results obtained are similar to the analysis at https://tria.ge/220121-wxp5xaafb2. As](https://tria.ge/220121-wxp5xaafb2)\ndescribed by Mr. Brad Duncan, 33 minutes after the initial infection, the victim was turned\ninto a spam-bot after being infected by the malware.\n\n**Emotet epoch5:**\n\nThe time of the initial infection in the pcap file ( 2022-01-20-Emotet-epoch5-infection```\nwith-spambot-activity.pcap ) is around 2022-01-20 17:46 UTC, when the victim\n\n```\nclicks on the link in the spam mail, they will access the address `mt.yoshimax[.]net :`\n\n\n-----\n\nAt the time of blogging, this address is no longer accessible. Therefore, I will use the files\nthat Mr. Brad Duncan provided for further analysis:\n\nAnalyze excel file: `2022-01-20-Emotet-epoch5-Excel-file.bin . Similar to the above`\nepoch4, its macro code is as follows:\n\nThe javascript in the file `2022-01-20-Emotet-epoch5-fe1.html.txt when executed will`\nspawn powershell process to download the png file (also a powershell script):\n\nThe content of the file `fe1.png is as follows:`\n\n\n-----\n\nLike above, this script also browses the urls to download the dll file and saves it as\n\n`sdc.dll . Then, call` `rundll32.exe` to execute the sdc.dll file saved at the path\n```\n\"C:\\Users\\Public\\Documents\\ssd.dll\" .\n\n```\n[Easily unpack to get Emotet core Dll:](https://www.virustotal.com/gui/file/03d9ed197cbb92759e7660668a99b11a7b4db66176f9a858cd233fc9148205bd/detection)\n\n\n-----\n\nWith Emotet’s core Dll unpacked, I can extract C2 configuration information as well as the\nkeys used to encrypt traffic and verify data:\n\n[The results obtained are similar to the analysis at https://tria.ge/220123-j3vw5afeel. As](https://tria.ge/220123-j3vw5afeel)\ndescribed by Mr. Brad Duncan, 26 minutes after the initial infection, the victim was turned\ninto a spam-bot after being infected by the malware.\n\n**_Other notes:_**\n\n\n-----\n\nI also observed another Emotet spam campaigns using octal representations of IP\naddresses, [the malicious Excel file also uses XML macro to run the malware once the](https://www.virustotal.com/gui/file/c376ffe4c231464c947bc77a323936d8eb64d85bcd1ddcd33bcc161dae53ef15/detection)\ndocument is opened and enabled by victim.\n\nWith the help of [CyberChef we can decode this IP address:](https://gchq.github.io/CyberChef/)\n\n**Refs:**\n\nRegards,\n\n**m4n0w4r**\n\n[View at Medium.com](https://medium.com/threat-intel/emotet-dangerous-malware-keeps-on-evolving-ac84aadbb8de)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-23 - [QuickNote] Emotet epoch4 & epoch5 tactics.pdf"
    ],
    "report_names": [
        "2022-01-23 - [QuickNote] Emotet epoch4 & epoch5 tactics.pdf"
    ],
    "threat_actors": [
        {
            "id": "5d2bd376-fcdc-4c6a-bc2c-17ebbb5b81a4",
            "created_at": "2022-10-25T16:07:23.667223Z",
            "updated_at": "2025-03-27T02:02:09.916086Z",
            "deleted_at": null,
            "main_name": "GCHQ",
            "aliases": [
                "Government Communications Headquarters",
                "Operation Socialist"
            ],
            "source_name": "ETDA:GCHQ",
            "tools": [
                "Prax",
                "Regin",
                "WarriorPride"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536047,
    "ts_updated_at": 1743041313,
    "ts_creation_date": 1653751442,
    "ts_modification_date": 1653751442,
    "files": {
        "pdf": "https://archive.orkl.eu/1881d1278330887ebf6b078a202c128bedc266cc.pdf",
        "text": "https://archive.orkl.eu/1881d1278330887ebf6b078a202c128bedc266cc.txt",
        "img": "https://archive.orkl.eu/1881d1278330887ebf6b078a202c128bedc266cc.jpg"
    }
}