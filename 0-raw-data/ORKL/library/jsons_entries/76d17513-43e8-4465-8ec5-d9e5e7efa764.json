{
    "id": "76d17513-43e8-4465-8ec5-d9e5e7efa764",
    "created_at": "2023-01-12T15:01:46.802763Z",
    "updated_at": "2025-03-27T02:16:37.218364Z",
    "deleted_at": null,
    "sha1_hash": "2a01c55b2aa02f5e88567af6fb94e44e3a607611",
    "title": "2019-05-13 - ScarCruft continues to evolve, introduces Bluetooth harvester",
    "authors": "",
    "file_creation_date": "2022-05-28T02:04:01Z",
    "file_modification_date": "2022-05-28T02:04:01Z",
    "file_size": 362642,
    "plain_text": "# ScarCruft continues to evolve, introduces Bluetooth harvester\n\n**[securelist.com/scarcruft-continues-to-evolve-introduces-bluetooth-harvester/90729/](https://securelist.com/scarcruft-continues-to-evolve-introduces-bluetooth-harvester/90729/)**\n\nAuthors\n\nGReAT\n\n## Executive summary\n\nAfter publishing our initial series of blogposts back in 2016, we have continued to track the\nScarCruft threat actor. ScarCruft is a Korean-speaking and allegedly state-sponsored threat\nactor that usually targets organizations and companies with links to the Korean peninsula.\nThe threat actor is highly skilled and, by all appearances, quite resourceful.\n\nWe recently discovered some interesting telemetry on this actor, and decided to dig deeper\ninto ScarCruft’s recent activity. This shows that the actor is still very active and constantly\ntrying to elaborate its attack tools. Based on our telemetry, we can reassemble ScarCruft’s\n\n\n-----\n\nbinary infection procedure. It used a multi-stage binary infection to update each module\neffectively and evade detection. In addition, we analyzed the victims of this campaign and\nspotted an interesting overlap of this campaign with another APT actor known as DarkHotel.\n\n## Multi-stage binary infection\n\nThe ScarCruft group uses common malware delivery techniques such as spear phishing and\n[Strategic Web Compromises (SWC). As in Operation Daybreak, this actor performs](https://securelist.com/operation-daybreak/75100/)\nsophisticated attacks using a zero-day exploit. However, sometimes using public exploit code\nis quicker and more effective for malware authors. We witnessed this actor extensively\n[testing a known public exploit during its preparation for the next campaign.](https://github.com/smgorelik/Windows-RCE-exploits)\n\nIn order to deploy an implant for the final payload, ScarCruft uses a multi-stage binary\ninfection scheme. As a rule, the initial dropper is created by the infection procedure. One of\nthe most notable functions of the initial dropper is to bypass Windows UAC (User Account\nControl) in order to execute the next payload with higher privileges. This malware uses the\n[public privilege escalation exploit code CVE-2018-8120 or](https://github.com/leeqwind/HolicPOC/blob/master/windows/win32k/CVE-2018-8120/x86.cpp) [UACME which is normally used](https://github.com/hfiref0x/UACME)\nby legitimate red teams. Afterwards, the installer malware creates a downloader and a\nconfiguration file from its resource and executes it. The downloader malware uses the\nconfiguration file and connects to the C2 server to fetch the next payload. In order to evade\nnetwork level detection, the downloader uses steganography. The downloaded payload is an\nimage file, but it contains an appended malicious payload to be decrypted.\n\n_Multi-stage binary infection_\n\n\n-----\n\nThe final payload created by the aforementioned process is a well known backdoor, also\nknown as [ROKRAT by Cisco Talos. This cloud service-based backdoor contains many](https://blog.talosintelligence.com/2017/11/ROKRAT-Reloaded.html)\nfeatures. One of its main functions is to steal information. Upon execution, this malware\ncreates 10 random directory paths and uses them for a specially designated purpose. The\nmalware creates 11 threads simultaneously: six threads are responsible for stealing\ninformation from the infected host, and five threads are for forwarding collected data to four\ncloud services (Box, Dropbox, Pcloud and Yandex). When uploading stolen data to a cloud\nservice, it uses predefined directory path such as /english, /video or /scriptout.\n\n_Cloud-based backdoor_\n\nThe same malware contains full-featured backdoor functionality. The commands are\ndownloaded from the /script path of a cloud service provider and the respective execution\nresults are uploaded to the /scriptout path. It supports the following commands, which are\nenough to fully control the infected host:\n\nGet File/Process listing\nDownload additional payload and execute\nExecute Windows command\nUpdate configuration data including cloud service token information\nSave screenshot and an audio recording\n\nThe ScarCruft group keeps expanding its exfiltration targets to steal further information from\ninfected hosts and continues to create tools for additional data exfiltration. During our\nresearch, we confirmed that they have an interest in mobile devices.\n\n\n-----\n\nWe also discovered an interesting piece of rare malware created by this threat actor – a\nBluetooth device harvester. This malware is responsible for stealing Bluetooth device\ninformation. It is fetched by a downloader, and collects information directly from the infected\nhost. This malware uses Windows Bluetooth APIs to find information on connected Bluetooth\ndevices and saves the following information.\n\nInstance Name: Name of device\nAddress: Address of device\nClass: Class of the device\nConnected: Whether the device is connected(true or false)\nAuthenticated: Whether the device is authenticated(true or false)\nRemembered: Whether the device is a remembered device(true or false)\n\nThe attackers appear to be increasing the scope of the information collected from victims.\n\n_Build path of Bluetooth information harvester_\n\n## Victimology\n\nWe have found several victims of this campaign, based on our telemetry – investment and\ntrading companies in Vietnam and Russia. We believe they may have some links to North\nKorea, which may explain why ScarCruft decided to closely monitor them. ScarCruft also\nattacked a diplomatic agency in Hong Kong, and another diplomatic agency in North Korea.\nIt appears ScarCruft is primarily targeting intelligence for political and diplomatic purposes.\n\n_Victimology of this campaign_\n\n\n-----\n\n## Overlap with other actors\n\nWe discovered one victim from Russia that also triggered a malware detection while staying\nin North Korea in the past. The fact that this victim visits North Korea makes its special and\nsuggests that it may have valuable information about North Korean affairs. ScarCruft infected\nthis victim on September 21, 2018. But before the ScarCruft infection, however, another APT\ngroup also targeted this victim with the host being infected with GreezeBackdoor on March\n26, 2018.\n\n[GreezeBackdoor is a tool of the DarkHotel APT group, which we have previously written](https://securelist.com/the-darkhotel-apt/66779/)\nabout. In addition, this victim was also attacked by the Konni malware on 03 April 2018. The\nKonni malware was disguised as a North Korean news item in a weaponized documents (the\nname of the document was “Why North Korea slams South Korea’s recent defense talks with\nU.S-Japan.zip”)\n\n_Infection timeline_\n\nThis is not the first time we have seen an overlap of ScarCruft and DarkHotel actors.\nMembers from our team have already presented on the conflict of these two threat actors at\n[security conferences. We have also shared more details with our threat intelligence](https://www.virusbulletin.com/blog/2017/10/vb2017-paper-walking-your-enemys-shadow-when-fourth-party-collection-becomes-attribution-hell/)\ncustomers in the past. They are both Korean-speaking threat actors and sometimes their\nvictimology overlaps. But both group seem to have different TTPs (Tactics, Techniques and\nProcedures) and it leads us to believe that one group regularly lurks in the other’s shadow.\n\n## Conclusions\n\nThe ScarCruft has shown itself to be a highly-skilled and active group. It has a keen interest\nin North Korean affairs, attacking those in the business sector who may have any connection\nto North Korea, as well as diplomatic agencies around the globe. Based on the ScarCruft’s\nrecent activities, we strongly believe that this group is likely to continue to evolve. For more\n[information please contact: intelreports@kaspersky.com](http://10.10.0.46/mailto:intelreports@kaspersky.com)\n\n## Appendix I – Indicators of Compromise\n\n**File hashes (malicious documents, Trojans, emails, decoys)**\n\n\n-----\n\n**ScarCruft tools**\n\n02681a7fe708f39beb7b3cf1bd557ee9 Bluetooth info harvester\nC781f5fad9b47232b3606e4d374900cd Installer\n032ed0cd234f73865d55103bf4ceaa22 Downloader\n22aaf617a86e026424edb7c868742495 AV Remover\n07d2200f5c2d03845adb5b20841faa94 AV Remover\n1f5ac2f1744ed9c3fd01fe72ee8d334f Initial Dropper\n4d20f7311f4f617104f559a04afd2fbf Installer\n03e5e566c1153cb1d18b8bc7c493025f Downloader\nC66ef71830341bb99d30964a8089a1fc Loader\n5999e01b83aa1cc12a2ad6a0c0dc27c3 Installer\n4d3c34a3070643c225be1dbbb3457ad4 Injector\n0790F1D7A1B9432AA5B8590286EB8B95 Downloader\n04371bf88b598b56691b0ad9da08204b Installer\ne8b23cfc805353f55ed67cf0af58f305 UAC bypass(UACME)\n5380a173757e67d9b12f316771012768 Installer\nEc0e77b57cb9dd7a04ab6e453810937c Downloader\n25701492a18854ffdb05317ec7d19c29 Installer\n172b4dc27e41e4a0c84a803b0b944d3e UAC bypass(UACME)\n7149c205d634c4d17dae33fffb8a68ab Image file embedded ROKRAT\nA76c4a79e6ff73bfd7149a49852e8916 ROKRAT\nF63fc2d11fcebd37be3891def5776f6c Dropper\n899e90a0851649a5c270d1f78baf60f2 Simple HTTP Downloader\nE88f7f285163d0c080c8d3e525b35ab3 Simple HTTP Downloader\nD7c94c5ba028dc22a570f660b8dee5b9 Simple HTTP Downloader\nA6bd2cf7bccf552febb8e8347d07529a Simple HTTP Downloader\n7a338d08226f5a38353385c8a5dec746 Simple HTTP Downloader\n46F66D2D990660661D00F5177306309C Simple HTTP Uploader\n\n**GreezaBackdoor of DarkHotel**\n\n5e0e11bca0e94914e565c1dcc1ee6860\n\n**Konni**\n\n4c2016df6b546326d67ac2a79dea1343\n\n**URLs**\n\nhttp://34.13.42[.]35/uploads/1.jpg\nhttp://34.13.42[.]35/uploads/2.jpg\nhttp://34.13.42[.]35/uploads/qwerty.jpg\nhttp://34.13.42[.]35/uploads/girl.jpg\n\n\n-----\n\nhttp://34.13.42[.]35/uploads/girllisten.jpg\nhttps://34.13.42[.]35/uploads/newmode.php\nhttp://acddesigns.com[.]au/demo/red/images/slider-pic-6.jpg\nhttp://kmbr1.nitesbr1[.]org/UserFiles/File/image/index.php\nhttp://kmbr1.nitesbr1[.]org/UserFiles/File/images.png\nhttp://www.stjohns-burscough[.]org/uploads/images.png\nhttp://lotusprintgroup[.]com/images.png\nhttps://planar-progress.000webhostapp[.]com/UserFiles/File/image/image/girl.jpg\nhttps://planar-progress.000webhostapp[.]com/userfiles/file/sliderpic.jpg\nhttp://www.jnts1532[.]cn/phpcms/templates/default/message/bottom.jpg\nhttp://www.rhooters[.]com/bbs/data/m_photo/bottom.jpg\nhttps://buttyfly.000webhostapp[.]com/userfiles/file/sliderpic.jpg\n\n**Domains and IPs**\n\nbuttyfly.000webhostapp[.]com\nplanar-progress.000webhostapp[.]com\n120.192.73[.]202\n180.182.52[.]76\n\n[APT](https://securelist.com/tag/apt/)\n[Backdoor](https://securelist.com/tag/backdoor/)\n[Malware](https://securelist.com/tag/malware/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[Vulnerabilities and exploits](https://securelist.com/tag/vulnerabilities-and-exploits/)\n\nAuthors\n\nGReAT\n\nScarCruft continues to evolve, introduces Bluetooth harvester\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-05-13 - ScarCruft continues to evolve, introduces Bluetooth harvester.pdf"
    ],
    "report_names": [
        "2019-05-13 - ScarCruft continues to evolve, introduces Bluetooth harvester.pdf"
    ],
    "threat_actors": [
        {
            "id": "1dadf04e-d725-426f-9f6c-08c5be7da159",
            "created_at": "2022-10-25T15:50:23.624538Z",
            "updated_at": "2025-03-27T02:00:55.508759Z",
            "deleted_at": null,
            "main_name": "Darkhotel",
            "aliases": [
                "Darkhotel",
                "DUBNIUM",
                "Zigzag Hail"
            ],
            "source_name": "MITRE:Darkhotel",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "81dde5cc-c29f-430d-8c6e-e5e92d5015e7",
            "created_at": "2022-10-25T16:07:23.704358Z",
            "updated_at": "2025-03-27T02:02:09.932453Z",
            "deleted_at": null,
            "main_name": "Harvester",
            "aliases": [],
            "source_name": "ETDA:Harvester",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Graphon",
                "Metasploit",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e90ec9cb-9959-455d-b558-4bafef64d645",
            "created_at": "2022-10-25T16:07:24.222081Z",
            "updated_at": "2025-03-27T02:02:10.14365Z",
            "deleted_at": null,
            "main_name": "Sphinx",
            "aliases": [
                "APT-C-15"
            ],
            "source_name": "ETDA:Sphinx",
            "tools": [
                "AnubisSpy",
                "Backdoor.Oldrea",
                "Bladabindi",
                "Fertger",
                "Havex",
                "Havex RAT",
                "Jorik",
                "Oldrea",
                "PEACEPIPE",
                "njRAT",
                "yellowalbatross"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b43c8747-c898-448a-88a9-76bff88e91b5",
            "created_at": "2024-02-02T02:00:04.058535Z",
            "updated_at": "2025-03-27T02:00:03.302832Z",
            "deleted_at": null,
            "main_name": "Opal Sleet",
            "aliases": [
                "OSMIUM",
                "Konni",
                "Vedalia"
            ],
            "source_name": "MISPGALAXY:Opal Sleet",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bbe36874-34b7-4bfb-b38b-84a00b07042e",
            "created_at": "2022-10-25T15:50:23.375277Z",
            "updated_at": "2025-03-27T02:00:55.457787Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "APT37",
                "InkySquid",
                "ScarCruft",
                "Group123",
                "TEMP.Reaper",
                "Ricochet Chollima"
            ],
            "source_name": "MITRE:APT37",
            "tools": [
                "BLUELIGHT",
                "CORALDECK",
                "KARAE",
                "SLOWDRIFT",
                "ROKRAT",
                "SHUTTERSPEED",
                "POORAIM",
                "HAPPYWORK",
                "Final1stspy",
                "Cobalt Strike",
                "NavRAT",
                "DOGCALL",
                "WINERACK"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "552ff939-52c3-421b-b6c9-749cbc21a794",
            "created_at": "2023-01-06T13:46:38.742547Z",
            "updated_at": "2025-03-27T02:00:02.906537Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "ScarCruft",
                "Venus 121",
                "Moldy Pisces",
                "Group 123",
                "APT 37",
                "Group123",
                "Operation Daybreak",
                "Operation Erebus",
                "Red Eyes",
                "TA-RedAnt",
                "InkySquid",
                "Reaper Group",
                "Ricochet Chollima",
                "ATK4",
                "G0067"
            ],
            "source_name": "MISPGALAXY:APT37",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b13c19d6-247d-47ba-86ba-15a94accc179",
            "created_at": "2024-05-01T02:03:08.149923Z",
            "updated_at": "2025-03-27T02:05:17.422065Z",
            "deleted_at": null,
            "main_name": "TUNGSTEN BRIDGE",
            "aliases": [
                "DUBNIUM ",
                "DarkHotel ",
                "CTG-1948 "
            ],
            "source_name": "Secureworks:TUNGSTEN BRIDGE",
            "tools": [
                "Nemim"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b9458777-d970-4e89-b2d2-e532140a390f",
            "created_at": "2024-05-01T02:03:08.140328Z",
            "updated_at": "2025-03-27T02:05:17.41728Z",
            "deleted_at": null,
            "main_name": "NICKEL JUNIPER",
            "aliases": [
                "OSMIUM ",
                "Opal Sleet ",
                "Konni"
            ],
            "source_name": "Secureworks:NICKEL JUNIPER",
            "tools": [
                "KONNI"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2b4eec94-7672-4bee-acb2-b857d0d26d12",
            "created_at": "2023-01-06T13:46:38.272109Z",
            "updated_at": "2025-03-27T02:00:02.790029Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "DUBNIUM",
                "Fallout Team",
                "Luder",
                "Tapaoux",
                "Shadow Crane",
                "APT-C-06",
                "SIG25",
                "Karba",
                "Nemim",
                "Nemin",
                "G0012",
                "ATK52",
                "T-APT-02",
                "TUNGSTEN BRIDGE",
                "Zigzag Hail"
            ],
            "source_name": "MISPGALAXY:DarkHotel",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535706,
    "ts_updated_at": 1743041797,
    "ts_creation_date": 1653703441,
    "ts_modification_date": 1653703441,
    "files": {
        "pdf": "https://archive.orkl.eu/2a01c55b2aa02f5e88567af6fb94e44e3a607611.pdf",
        "text": "https://archive.orkl.eu/2a01c55b2aa02f5e88567af6fb94e44e3a607611.txt",
        "img": "https://archive.orkl.eu/2a01c55b2aa02f5e88567af6fb94e44e3a607611.jpg"
    }
}