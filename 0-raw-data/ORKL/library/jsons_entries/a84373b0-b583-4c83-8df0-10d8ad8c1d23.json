{
    "id": "a84373b0-b583-4c83-8df0-10d8ad8c1d23",
    "created_at": "2023-01-12T15:07:34.630636Z",
    "updated_at": "2025-03-27T02:08:33.335667Z",
    "deleted_at": null,
    "sha1_hash": "c38dfc5c91578cf00a7a4a44e174b5ccf57e40f3",
    "title": "2022-01-26 - [QuickNote] Analysis of malware suspected to be an APT attack targeting Vietnam",
    "authors": "",
    "file_creation_date": "2022-05-28T15:24:06Z",
    "file_modification_date": "2022-05-28T15:24:06Z",
    "file_size": 783490,
    "plain_text": "# [QuickNote] Analysis of malware suspected to be an APT attack targeting Vietnam\n\n**kienmanowar.wordpress.com/2022/01/26/quicknote-analysis-of-malware-suspected-to-be-an-apt-attack-targeting-**\nvietnam/\n\nJanuary 25, 2022\n\nRecently, on the twitter of [Shadow Chaser Group, they tweet information about malware](https://twitter.com/ShadowChasing1)\nsample that targeting Vietnam.\n\n\n-----\n\n_Sample info:_\n\n**SHA-256:**\n[341dee709285286bc5ba94d14d1bce8a6416cb93a054bd183b501552a17ef314](https://www.virustotal.com/gui/file/341dee709285286bc5ba94d14d1bce8a6416cb93a054bd183b501552a17ef314/details)\n**ITW:** `Bien ban thong nhat ke hoach dao tao_VPB.Voffice.docx`\n**Submitted from VN:** `2022-01-24 02:52:14 UTC`\n\n\n-----\n\nCause this sample related to Vietnam, so I decided to taking time to perform a quick analysis\nof this malicious document. A quick check of this document shows that it uses the Template\nInjection technique. The advantage of this technique is that when the user open the file, it will\nautomatically download the `fav.ico` file from the address\n```\nhxxp://office[.]oiqezet[.]com/portals/office/fav.ico .\n\n```\n\n-----\n\nIn addition, based on the `<AppVersion> tag information, it is possible to know that the`\nattacker created this document from `Office 2010 :`\n\nAt the time of analysis, I could still download the `fav.ico` (MD5:\n9521e4138fd0e6996072778cd4f1f06a) file:\n\nThe downloaded `fav.ico file is not a PE file, it is an` `RTF file :`\n\n\n-----\n\nChecking it with the `rtfobj tool, the results show that this RTF file has an embedded`\nobject named `qax23.xp, with size: 167831 bytes, and has MD5 =`\n‘ 935553d110e5ded158006d0679226641 ‘.\n\n[This technique reminds me some of samples that I’ve analyzed before: [1], [2], [3], [4].](https://blog.vincss.net/2021/05/re022-part1-quick-analysis-of-malicious-sample-forging-the-%20official-dispach-of-the-Central-Inspection-Committee.html)\nThanks to [nao_sec for updating the](https://twitter.com/nao_sec) `rr_decoder tool to decode the encrypted object.`\n\n\n-----\n\nAfter dumping the object and then use `rr_decoder, I got the Dll file with the original name`\n\n```\nDownload.dll.\n\n```\n\n-----\n\nHere is the result when I upload this Dll to tria.ge site: https://tria.ge/220124k8nknsdhf8/behavioral1\n\n\n-----\n\nAs shown in the figure, the malware after executing will send encrypted data to the address\n```\nhttp://office[.]oiqezet[.]com/portals/office/log.php?, whereby the IP address\n\n```\nof remote address is from Vietnam. To be able to decode the above data, I quickly reversed\ncode of the Dll file.\n\nThe code of this Dll shows that it will collect and aggregate information about the victim’s\ncomputer, including: `Host Name, OS Name, OS Version, System type, Architecture,`\n```\nUser Name, InternetInformation, Antivirus product .\n\n```\n\n-----\n\nAll collected information will be encrypted with the RC4 algorithm, with the\nencryption/decryption key is `\"123abc\", then this encrypted data will continue to be`\nencoded by the Base64 algorithm before being sent to C2 as picture above.\n\n\n-----\n\n[Based on the analysis results, by using CyberChef, I can decrypt the encrypted data when](https://gchq.github.io/CyberChef)\nsent to C2 as follows:\n\nEnd.\n\nRegards,\n\nm4n0w4r\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-26 - [QuickNote] Analysis of malware suspected to be an APT attack targeting Vietnam.pdf"
    ],
    "report_names": [
        "2022-01-26 - [QuickNote] Analysis of malware suspected to be an APT attack targeting Vietnam.pdf"
    ],
    "threat_actors": [
        {
            "id": "5d2bd376-fcdc-4c6a-bc2c-17ebbb5b81a4",
            "created_at": "2022-10-25T16:07:23.667223Z",
            "updated_at": "2025-03-27T02:02:09.916086Z",
            "deleted_at": null,
            "main_name": "GCHQ",
            "aliases": [
                "Government Communications Headquarters",
                "Operation Socialist"
            ],
            "source_name": "ETDA:GCHQ",
            "tools": [
                "Prax",
                "Regin",
                "WarriorPride"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536054,
    "ts_updated_at": 1743041313,
    "ts_creation_date": 1653751446,
    "ts_modification_date": 1653751446,
    "files": {
        "pdf": "https://archive.orkl.eu/c38dfc5c91578cf00a7a4a44e174b5ccf57e40f3.pdf",
        "text": "https://archive.orkl.eu/c38dfc5c91578cf00a7a4a44e174b5ccf57e40f3.txt",
        "img": "https://archive.orkl.eu/c38dfc5c91578cf00a7a4a44e174b5ccf57e40f3.jpg"
    }
}