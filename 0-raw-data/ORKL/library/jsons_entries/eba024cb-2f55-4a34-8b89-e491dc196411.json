{
    "id": "eba024cb-2f55-4a34-8b89-e491dc196411",
    "created_at": "2023-01-12T15:03:13.014617Z",
    "updated_at": "2025-03-27T02:05:21.896258Z",
    "deleted_at": null,
    "sha1_hash": "7530e799f61ed92cc3817aae18f253e2d6d0498c",
    "title": "2019-11-16 - Fresh PlugX October 2019",
    "authors": "",
    "file_creation_date": "2022-05-27T23:02:36Z",
    "file_modification_date": "2022-05-27T23:02:36Z",
    "file_size": 278566,
    "plain_text": "# Fresh PlugX October 2019\n\n**[silascutler.blogspot.com/2019/11/fresh-plugx-october-2019.html](https://silascutler.blogspot.com/2019/11/fresh-plugx-october-2019.html)**\n\nSC\n\nOn 15 November 2019, I received a VirusTotal notification for a copy of PlugX that had been\nuploaded ( Yara - PlugXBootLDRCode from https://github.com/citizenlab/malwaresignatures/blob/master/malware-families/plugx.yara ).\n\nMD5     : ce67994a4ee7cf90645e93aec084230d\n\nSHA1     : b42c84f851b8b7d2d2ddfbc9ac94e001204faf45\n\nSHA256    :\n6b46e36245b5b9ed13c0fbfae730b49c04aba43b98deb75e388e03695ff5cbd1\n\nType     : Win32 DLL\n\nFirst seen  : 2019-11-15 08:04:32 UTC\n\nLast seen  : 2019-11-15 08:04:32 UTC&nbsp\n\nFirst name  : plugx.dll\n\nWhat stood out from the notification (outside of the file being named plugx.dll) was a\ncompilation time of Fri Oct 4 08:34:45 2019 UTC (a little more then a month before the\nwriting of this post).\n\n**Initial Validation**\n\nThis specific rule matches on operations for assembling a set of API calls - shown below\n\n$ yara -s All.yara sample\n\nPlugXBootLDRCode [PlugX,Family]\n6b46e36245b5b9ed13c0fbfae730b49c04aba43b98deb75e388e03695ff5cbd1\n\n0x7708:$GetProcAdd: 80 38 47 75 36 80 78 01 65 75 30 80 78 02 74 75 2A 80 78 03 50\n\n0x7786:$L4_LoadLibraryA: C7 85 5C FF FF FF 4C 6F 61 64 C7 85 60 FF FF FF 4C 69 62\n\n0x7859:$L4_ExitThread: C7 85 FC FE FF FF 45 78 69 74 C7 85 00 FF FF FF 54 68 72 65\n\n\n-----\n\nScreenshot of match condition in IDA\n\n_As a general note, the -s flag in Yara is used for outputting the matched strings and is_\n_extremely useful for debugging rules and evaluating why a file matched._\n\nFrom a quick comparison of the strings, a quick Google search found previous reporting\nconfirming this file was PlugX (ref: http://takahiroharuyama.github.io/blog/2014/03/27/idslash-idapython-scripts-extracting-plugx-configs/)\n\n**DEMO...**\n\n**THIS IS A DEMO VERSION!!!**\n\n\\\\.\\PIPE\\RUN_AS_USER(%d)\n\n%WINDIR%\\SYSTEM32\\SERVICES.EXE\n\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Run\n\nSystem\\CurrentControlSet\\Services\n\ndebug.hlp\n\nC:\\Windows\\System32\\rundll32.exe \"%s\" BypassUAC %s\n\nPI[%8.8X]\n\n%s\\%d.plg\n\nmytilus3.hlp\n\n%04d-%02d-%02d %02d:%02d:%02d\n\n**Overlaps with versions**\n\n\n-----\n\nA outstanding point of reference evaluating PlugX is the Sophos report\n(https://www.sophos.com/en-us/medialibrary/pdfs/technical%20papers/plugxthenextgeneration.pdf). On Page 7, Gabor Szappanos has a table covering the supported\ncommands. In this copy, sub_10008DE acts as a command handler for evaluating operator\ncommands and can be used to evaluate this copy against that from 2014:\n\nIn the above screenshot, many of the commands from the 2014 version are present; some\nadditional commands are present, however, handled withing sub-functions of sub_10008DE.\n\nWhat did appear unique was a set of commands for monitor clipboard activity:\n\n\n-----\n\nAn initial Google search did not show any hits for these being previously documented\ncommands in PlugX - suggesting it may be a new feature - however, further analysis is\nneeded to validate this.\n\n## Backdooring a HID Reader\n\n Lazarus obfuscation in Feb 2019\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-11-16 - Fresh PlugX October 2019.pdf"
    ],
    "report_names": [
        "2019-11-16 - Fresh PlugX October 2019.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535793,
    "ts_updated_at": 1743041121,
    "ts_creation_date": 1653692556,
    "ts_modification_date": 1653692556,
    "files": {
        "pdf": "https://archive.orkl.eu/7530e799f61ed92cc3817aae18f253e2d6d0498c.pdf",
        "text": "https://archive.orkl.eu/7530e799f61ed92cc3817aae18f253e2d6d0498c.txt",
        "img": "https://archive.orkl.eu/7530e799f61ed92cc3817aae18f253e2d6d0498c.jpg"
    }
}