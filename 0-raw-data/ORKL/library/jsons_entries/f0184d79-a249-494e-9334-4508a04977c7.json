{
    "id": "f0184d79-a249-494e-9334-4508a04977c7",
    "created_at": "2023-01-12T15:09:07.752086Z",
    "updated_at": "2025-03-27T02:17:27.548623Z",
    "deleted_at": null,
    "sha1_hash": "60c458a2d48a1db61fb8fc0d6000cbf330261769",
    "title": "2019-06-06 - APT34- Jason project",
    "authors": "",
    "file_creation_date": "2022-05-28T17:54:19Z",
    "file_modification_date": "2022-05-28T17:54:19Z",
    "file_size": 1427554,
    "plain_text": "# APT34: Jason project\n\n**marcoramilli.com/2019/06/06/apt34-jason-project/**\n\nView all posts by marcoramilli June 6, 2019\n\nToday I want to share a quick analysis on a new leaked APT34 Tool in order to track\nsimilarities between APT34 public available toolsets. This time is the APT34 Jason –\n**Exchange Mail BF project to be leaked by Lab Dookhtegan on June 3 2019.**\n\n\n-----\n\nOriginal Leak\n\n## Context\n\nAccording to FireEye, APT 34 has been active since 2014. APT 34, also referred to as\n“OilRig” or Helix Kitten, has been known to target regional corporations and industries.\nAlthough there was information about APT34 prior to 2019, a series of leaks on the website\nTelegram by an individual named “Lab Dookhtegan”, including Jason project, exposed many\nnames and activities of the organization.\n\n“APT34 conducts cyber espionage on behalf of Iran. Iran seeks to diminish the\ncapabilities of other regional powers to create leverage and better establish itself. This\nstrategy is especially important against nations it sees as a threat to its regional power\nsuch as Saudi Arabia and the United Arab Emirates.”\n\n_Michael Lortz_\n\n## Analysis\n\nJason is a graphic tool implemented to perform Microsoft exchange account brute-force in\norder to “harvest” the highest possible emails and accounts information. Distributed in a ZIP\n[container (a copy is available here) the interface is quite intuitive: the Microsoft exchange](https://github.com/marcoramilli/APT34)\n\n\n-----\n\naddress and its version shall be provided (even if in the code a DNS-domain discovery mode\nfunction is available). Three brute-force methods could be selected: EWS (Exchange Web\nService), OAB (Offline Address Book) or both (All). Username and password list can be\nselected (included in the distributed ZIP file) and threads number should be provided in order\nto optimize the attack balance.\n\nJason Project GUI\n\nDeflating the ZIP container three artifacts are facing out. `Jason.exe representing the`\ngraphic user interface and the main visible tool. `Microsoft.Exchange.WebService.dll`\nwhich includes the real functionalities used by `Jason.exe, it’s a Microsoft developed`\nlibrary, `PassSample which includes some patterns implementation of possible Passwords`\n(ie.[User@first]@@[user@first]123) and a folder named `PasswordPatters which includes`\nbuilding blocks for password guessing. For example it wraps up a file called `Year.txt`\nincluding numbers from 1900 to 2020, a file called `numspecial.txt including special`\nnumbers patterns and special chars patterns, a file called `num4.txt including numbers`\nfrom 0 to 999 and from 0002 (why not 0001 or 0000?) to 9998 (why not 9999?) and finally a\nfile called `num4special.txt including special number patters like: 1234,7890,0707, and so`\non and so forth.\n\nLeaked ZIP content\n\nDigging a little bit into the two Microsoft artifacts we might find out that both of them (\n```\nJason.exe and Microsoft.Exchange.WebService.dll ) have been written using .NET\n\n```\nframework. The used .dll provides a managed interface for developing .NET client\napplications that use EWS. By using the EWS Managed API, the developer can access\nalmost all the information stored in an Office 365, Exchange Online, or Exchange Server\nmailbox. The attacker used an old version of `Microsoft.Exchange.WebService.dll`\n[tagged as 15.0.0.0 which according to Microsoft documentation dates back to 2012.](https://www.microsoft.com/en-gb/download/details.aspx?id=35371)\n\n\n-----\n\nWebService.dll\n\nassemply version\nThe last available `Microsoft.Exchange.WebService.dll dates back to 2015, as shown`\nin the following image, which might suggest a Jason dating period, even if it’s not an\nirrefutable evidence.\n\nLast Microsoft\n\nExchange WebServices dll version dates to 2015\nAnalyzing the reversed byte-code a real eye catcher (at least in my persona point of view) is\nin the “exception securities” that have been placed. In other words, the developer used many\nchecks such as: variable checks, Nullbytes avoidance, objects indexes and object key\nchecks in order to reduce the probability of not managed software exceptions. These\n“exception protections” are usually adopted in two main scenarios: (i) the end-user is not a\nsuper “techy” guy, so he might end-up with some unexpected conditions or (ii) the attacker is\na professional developer who is trained to write product oriented code and not simple\nworking software (which is what attackers usually do). The following images show a couple\nof code snippets in where the developer decided to protect codes from unexpected user\nbehavior.\n\n\n-----\n\nprevention 1\n\n\nBasic exception\n\nBasic exception\n\n\nprevention 2\nComparing the code style with my previous analyses on APT34 (OilRig) which you might find\n[here and](https://marcoramilli.com/2019/04/23/apt34-webmask-project/) [here, we might observe a similar code protection. Even if the code language is](https://marcoramilli.com/2019/05/02/apt34-glimpse-project/)\ndifferent the similarity in the basic exception prevention from Jason and -for example- the\n[“ICAP.py script injection” function is very close. Another weak similarity is in the logging style.](https://marcoramilli.com/2019/04/23/apt34-webmask-project/)\n[Jason and -for example- Glimpse project have a similar file logging function which includes](https://marcoramilli.com/2019/05/02/apt34-glimpse-project/)\nstring concatenation using special operators (no “flying casting” or “safe conversions”, ie:\n“%s”) and one line file logging into function focal points.\n\nI am aware that these are weak similarities and there is no additional evidence or ties with\nprevious leaked APT34 except for the trusted source (Lab Dookhtegan), so I am not giving\nany personal attribution since it gets very hard to attribute Jason directly to APT34 for what is\nknown.\n\nOn the other hand Jason project doesn’t share the main source code language with previous\nAPT34 analyses, it doesn’t include DNS tricks and or DNS usage evidences, it doesn’t\ninclude distinguishing patterns or language mistakes, it have been recompiled on January\n2019 but using older technology. As already discussed it shares just few code style\nsimilarities with Glimpse and WebMask.\n\n**IoC**\n\n\n-----\n\n9762444b94fa6cc5a25c79c487bbf97e007cb680118afeab0f5643d211fa3f78\n(Jason.exe)\n0cf66c68c265191d36fc9648b4ef879a80be0c3b6da289de5891ede1554de48d (Original\nZIP File)\n\n**YARA**\n```\nrule _APT34_Jason {\n  meta:\n   description = \"APT34 Jason\"\n   date = \"2019-06-05\"\n   hash1 = \"9762444b94fa6cc5a25c79c487bbf97e007cb680118afeab0f5643d211fa3f78\"\n  strings:\n   $s1 = \"lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0,\nCulture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R\" ascii\n   $s2 = \"D:\\\\Project\\\\Jason\\\\obj\\\\Release\\\\Jason.pdb\" fullword ascii\n   $s3 = \"Jason.exe\" fullword wide\n   $s4 = \"get_PasswordPattern\" fullword ascii\n   $s5 = \"get_PasswordFile\" fullword ascii\n   $s6 = \"get_pCurrentPassword\" fullword ascii\n   $s7 = \"Microsoft.Exchange.WebServices.Data\" fullword ascii\n   $s8 = \"Total Login Successful :\" fullword wide\n   $s9 = \"Login Successful\" fullword wide\n   $s10 = \"<PasswordPattern>k__BackingField\" fullword ascii\n   $s11 = \"<pCurrentPassword>k__BackingField\" fullword ascii\n   $s12 = \"Jason - Exchange Mail BF - v 7.0\" fullword wide\n   $s13 = \"Please enter Password File\" fullword wide\n   $s14 = \"get_UsernameStart\" fullword ascii\n   $s15 = \"get_UserPassFile\" fullword ascii\n   $s16 = \"get_pCurrentUsername\" fullword ascii\n   $s17 = \"set_pCurrentPassword\" fullword ascii\n   $s18 = \"set_PasswordFile\" fullword ascii\n   $s19 = \"set_PasswordPattern\" fullword ascii\n   $s20 = \"connection was closed\" fullword wide\n  condition:\n   uint16(0) == 0x5a4d and filesize < 100KB and\n   8 of them\n}\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-06-06 - APT34- Jason project.pdf"
    ],
    "report_names": [
        "2019-06-06 - APT34- Jason project.pdf"
    ],
    "threat_actors": [
        {
            "id": "ce10c1bd-4467-45f9-af83-28fc88e35ca4",
            "created_at": "2022-10-25T15:50:23.458833Z",
            "updated_at": "2025-03-27T02:00:55.475188Z",
            "deleted_at": null,
            "main_name": "APT34",
            "aliases": null,
            "source_name": "MITRE:APT34",
            "tools": [
                "netstat",
                "Systeminfo",
                "PsExec",
                "SEASHARPEE",
                "Tasklist",
                "Mimikatz",
                "POWRUNER",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3eebdb3f-f4e3-42e5-bb4d-f02a13328316",
            "created_at": "2024-05-01T02:03:08.014303Z",
            "updated_at": "2025-03-27T02:05:17.306592Z",
            "deleted_at": null,
            "main_name": "COBALT EDGEWATER",
            "aliases": [
                "Cold River ",
                "DNSpionage ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT EDGEWATER",
            "tools": [
                " DNSpionage",
                " Karkoff",
                " MailDropper",
                " SideTwist",
                " TWOTONE",
                "AgentDrable"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536147,
    "ts_updated_at": 1743041847,
    "ts_creation_date": 1653760459,
    "ts_modification_date": 1653760459,
    "files": {
        "pdf": "https://archive.orkl.eu/60c458a2d48a1db61fb8fc0d6000cbf330261769.pdf",
        "text": "https://archive.orkl.eu/60c458a2d48a1db61fb8fc0d6000cbf330261769.txt",
        "img": "https://archive.orkl.eu/60c458a2d48a1db61fb8fc0d6000cbf330261769.jpg"
    }
}