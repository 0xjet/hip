{
    "id": "39f74e4b-4903-4b46-a2d1-ce34581747f6",
    "created_at": "2023-01-12T15:04:04.217149Z",
    "updated_at": "2025-03-27T02:15:25.650438Z",
    "deleted_at": null,
    "sha1_hash": "7b6152013eaaffc640a3d02d86863084dcb2e1bc",
    "title": "2021-05-27 - Re-Checking Your Pulse- Updates on Chinese APT Actors Compromising Pulse Secure VPN Devices",
    "authors": "",
    "file_creation_date": "2022-05-28T17:32:15Z",
    "file_modification_date": "2022-05-28T17:32:15Z",
    "file_size": 137537,
    "plain_text": "# Re-Checking Your Pulse: Updates on Chinese APT Actors Compromising Pulse Secure VPN Devices\n\n**[fireeye.com/blog/threat-research/2021/05/updates-on-chinese-apt-compromising-pulse-secure-vpn-devices.html](https://www.fireeye.com/blog/threat-research/2021/05/updates-on-chinese-apt-compromising-pulse-secure-vpn-devices.html)**\n\nThreat Research\n\nDan Perez, Sarah Jones, Greg Wood, Stephen Eckels, Emiel Haeghebaert\n\nMay 27, 2021\n\n19 mins read\n\nAdvanced Persistent Threats (APTs)\n\nThreat Actors\n\n\n-----\n\nOn April 20, 2021, Mandiant published detailed results of our investigations into\n[compromised Pulse Secure devices by suspected Chinese espionage operators. This blog](https://www.fireeye.com/resources/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day)\npost is intended to provide an update on our findings, give additional recommendations to\nnetwork defenders, and discuss potential implications for U.S.-China strategic relations.\n\nMandiant continues to gather evidence and respond to intrusions involving\ncompromises of Pulse Secure VPN appliances at organizations across the defense,\ngovernment, high tech, transportation, and financial sectors in the U.S. and Europe\n(Figure 1).\nReverse engineers on the FLARE team have identified four additional code families\nspecifically designed to manipulate Pulse Secure devices.\nWe now assess that espionage activity by UNC2630 and UNC2717 supports key\nChinese government priorities. Many compromised organizations operate in verticals\nand industries aligned with Beijing’s strategic objectives outlined in China’s recent 14th\nFive Year Plan.\nWhile there is evidence of data theft at many organizations, we have not directly\nobserved the staging or exfiltration of any data by Chinese espionage actors that could\n[be considered a violation of the Obama-Xi agreement.](https://obamawhitehouse.archives.gov/the-press-office/2015/09/25/fact-sheet-president-xi-jinpings-state-visit-united-states)\nMandiant Threat Intelligence assesses that Chinese cyber espionage activity has\ndemonstrated a higher tolerance for risk and is less constrained by diplomatic\npressures than previously characterized.\n\n\n-----\n\nOrganizations with compromised Pulse Secure devices by vertical and geographic\nlocation\n\nFigure 1: Organizations with compromised Pulse Secure devices by vertical and geographic\nlocation\nPulse Secure continues to work closely with Mandiant, affected customers, government\npartners, and other forensic experts to address these issues. Pulse Secure’s parent\ncompany, Ivanti, has released patches to proactively address software vulnerabilities and\n[issued updated Security Advisories and](https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784) [Knowledge Articles to assist customers. (Please see](https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755)\nthe Forensics, Remediation, and Hardening Guidelines section for additional details.)\n\n**UNC2630 and UNC2717 Tradecraft and Response to Disclosure**\n\nMandiant is tracking 16 malware families exclusively designed to infect Pulse Secure VPN\nappliances and used by several cyber espionage groups which we believe are affiliated with\nthe Chinese government. Between April 17 and April 20, 2021, Mandiant incident responders\nobserved UNC2630 access dozens of compromised devices and remove webshells like\nATRIUM and SLIGHTPULSE.\n\n\n-----\n\nUnder certain conditions, the Integrity Checker Tool (ICT) will show no evidence of\ncompromise on appliances which may have had historical compromise. This false\nnegative may be returned because the ICT cannot scan the rollback partition. If a\nbackdoor or persistence patcher exists on the rollback partition and a Pulse Secure\nappliance is rolled back to the prior version, the backdoor(s) will be present on the\nappliance. Please see the Forensics, Remediation, and Hardening Guidelines section\nfor important information regarding the ICT and upgrade process.\nIn at least one instance, UNC2630 deleted their webshell(s) but did not remove the\npersistence patcher, making it possible to regain access when the device was\nupgraded. The remaining persistence patcher causes the malicious code to be\nexecuted later during a system upgrade, re-inserts webshell logic into various files on\nthe appliance, and recompromises the device.\nIt is unusual for Chinese espionage actors to remove a large number of backdoors\nacross several victim environments on or around the time of public disclosure. This\naction displays an interesting concern for operational security and a sensitivity to\npublicity.\n\nBoth UNC2630 and UNC2717 display advanced tradecraft and go to impressive lengths to\navoid detection. The actors modify file timestamps and regularly edit or delete forensic\nevidence such as logs, web server core dumps, and files staged for exfiltration. They also\ndemonstrate a deep understanding of network appliances and advanced knowledge of a\ntargeted network. This tradecraft can make it difficult for network defenders to establish a\ncomplete list of tools used, credentials stolen, the initial intrusion vector, or the intrusion start\ndate.\n\n**Updates from Incident Response Investigations**\n\nWe continue to suspect that multiple groups including UNC2630 and UNC2717 are\nresponsible for this activity, despite the use of similar exploits and tools. There is a high\ndegree of variation in attacker actions within victim environments, with actors inconsistently\nusing a combination of tools and command and control IP addresses.\n\nReverse engineers on the FLARE team have identified four additional malware families\nspecifically designed to manipulate Pulse Secure devices (Table 1). These utilities have\nsimilar functions to the 12 previously documented malware families: harvesting credentials\nand sensitive system data, allowing arbitrary file execution, and removing forensic evidence.\nPlease see the Technical Annex for detailed analysis of these code families.\n\n\n**Malware**\n**Family**\n\n\n**Description** **Actor**\n\n\n-----\n\nBLOODMINE BLOODMINE is a utility for parsing Pulse Secure Connect\nlog files. It extracts information related to logins, Message\nIDs and Web Requests and copies the relevant data to\nanother file.\n\nBLOODBANK BLOODBANK is a credential theft utility that parses two files\ncontaining password hashes or plaintext passwords and\nexpects an output file to be given at the command prompt.\n\nCLEANPULSE CLEANPULSE is a memory patching utility that may be used\nto prevent certain log events from occurring. It was found in\nclose proximity to an ATRIUM webshell.\n\nRAPIDPULSE RAPIDPULSE is a webshell capable of arbitrary file read. As\nis common with other webshells, RAPIDPULSE exists as a\nmodification to a legitimate Pulse Secure file. RAPIDPULSE\ncan serve as an encrypted file downloader for the attacker.\n\nTable 1: New malware families identified\n\n_Initial Compromise_\n\n\nUNC2630\n\nUNC2630\n\nUNC2630\n\nUNC2630\n\n\nThe actors leveraged several vulnerabilities in Pulse Secure VPN appliances. Mandiant\nobserved the use of the recently patched vulnerability CVE-2021-22893 to compromise fully\npatched Pulse Secure appliances as well as previously disclosed vulnerabilities from 2019\nand 2020. In many cases, determining the initial exploitation vector and timeframe was not\npossible to determine because the actors altered or deleted forensic evidence, or the\nappliance had undergone subsequent code upgrades thereby destroying evidence related to\nthe initial exploitation.\n\n_Establish Foothold_\n\nIn some cases, Mandiant observed the actors create their own Local Administrator account\noutside of established credential management controls on Windows servers of strategic\nvalue. This allowed the actor to maintain access to systems with short-cycle credential\nrotation policies and provided a sufficient level of access to operate freely within their target\nenvironment. The actors also maintained their foothold into the targeted environments\nexclusively through Pulse Secure webshells and malware without relying on backdoors\ndeployed on internal Windows or Linux endpoints.\n\n_Escalate Privileges_\n\nMandiant observed the actors use three credential harvesting techniques on Windows\nsystems:\n\n\n-----\n\nTargeting of clear text passwords and hashes from memory using the credential\nharvesting tool Mimikatz. Instead of being copied locally and executed on the target\nsystem, Mandiant saw evidence of the Mimikatz binary on the source system of an\nRDP session (i.e. the threat actor’s system that was connected to the VPN) through an\nRDP mapped drive.\nCopying and exfiltration of the SAM, SECURITY, and SYSTEM registry hives which\ncontained cached NTLM hashes for Local and Domain accounts.\nLeveraging the Windows Task Manager process to target the Local Security Authority\nSubsystem Service (LSASS) process memory for NTLM hashes.\n\nIn addition to these privilege escalation techniques, the actors specifically targeted separate\nprivileged accounts belonging to individuals whose unprivileged accounts were previously\ncompromised (likely through the Pulse Secure credential harvesting malware families). It is\nunclear how the account associations were made by the actor.\n\n_Internal Reconnaissance_\n\nMandiant found evidence that the actors renamed their own workstations that they\nconnected to the VPN of victim networks to mimic the naming convention of their target\nenvironment. This practice aligns with the actor’s objective for long-term persistence and\nevading detection and demonstrates a familiarity with the internal hostnames in the victim\nenvironment.\n\nThe actors operated solely by utilizing Windows-based utilities to carry out tasks. Some of\nthe utilities observed were net.exe, quser.exe, powershell.exe, powershell_ise.exe,\nfindstr.exe, netstat.exe, cmd.exe, reg.exe and tasklist.exe.\n\n_Move Laterally_\n\nMost lateral movement originated from compromised Pulse Secure VPN appliances to\ninternal systems within the environment. While connected to the Pulse VPN appliance, the\nactor’s system was assigned an IP address from the Pulse VPN DHCP pool and they moved\nlaterally throughout the environments by leveraging the Remote Desktop Protocol (RDP), the\nSecure Shell Protocol (SSH), and browser-based communication to HTTPS hosted\nresources. The actors also accessed other resources such as Microsoft M365 cloud\nenvironments using stolen credentials they had previously acquired.\n\nMandiant also observed the actors targeting ESXi host servers. The actor enabled SSH on\nESXi hosts that were previously disabled via the web interface. When their operations on the\nsystem were finished, the actors disabled SSH on the ESXi host again and cleared or\npreemptively disabled all relevant logging associated with the performed activities. This\nincludes authentication, command history, and message logging on the system.\n\n_Maintain Presence_\n\n\n-----\n\nMandiant observed the threat actor maintain persistence by compromising the upgrade\nprocess on the Pulse Secure Appliance. Persistence was primarily achieved by modifying\nthe legitimate DSUpgrade.pm file to install the ATRIUM webshell across each upgrade\nperformed by an administrator. The actor likely chose DSUpgade.pm to host their patch\nlogic as it is a core file in the system upgrade procedure, ensuring the patch is applied during\nupdates. The patcher modifies content in /tmp/data as this directory holds the extracted\nupgrade image the newly upgraded system will boot into. This results in a persistence\nmechanism which allows the actor to maintain access to the system across updates.\n\nThe actors also achieved persistence in other cases by prepending a bash script to the file\n/bin/umount normally used to unmount a Linux filesystem. This binary was targeted by the\nactor because it is executed by the Pulse Secure appliance during a system upgrade. The\nactor’s script verifies that the umount binary executes with a specific set of arguments, which\nare identical to the arguments used by the Pulse Secure appliance to executes the binary.\nThe inserted malicious bash script remounts the filesystem as read-write and iterates\nthrough a series of bash routines to inject the ATRIUM webshell, hide SLOWPULSE from a\nlegacy file integrity bash script, remove or add itself from the umount file, and validate the\nweb process was running after a reboot to return the filesystem back to read-only.\n\n_Complete Mission_\n\nThe threat actor’s objectives appear to be stealing credentials, maintaining long-term\npersistent access to victim networks, and accessing or exfiltrating sensitive data. Mandiant\nhas observed the attackers:\n\nStaging data related to sensitive projects, often in C:\\Users\\Public\nNaming exfiltration archives to resemble Windows Updates (KB) or to match the format\nKB<digits>.zip\nUsing the JAR/ZIP file format for data exfiltration\nDeleting exfiltrated archives\n\nAnalysis of new malware families is included in the Technical Annex to enable defenders to\nquickly assess if their respective appliances have been affected. Relevant MITRE ATT&CK\n[techniques, Yara rules and hashes are published on Mandiant’s GitHub page.](https://github.com/mandiant/pulsesecure_exploitation_countermeasures)\n\n**Forensics, Remediation, and Hardening Guidelines**\n\nTo begin an investigation, Pulse Secure users should contact their Customer Support\nRepresentative for assistance completing the following steps:\n\n1. Capture memory and a forensic image of the appliance\n2. Run the Pulse Integrity Checker Tool found online\n3. Request a decrypted image of each partition and a memory dump\n\nTo remediate a compromised Pulse Secure appliance:\n\n\n-----\n\n1. Caution must be taken when determining if a Pulse Secure device was compromised at\n\nany previous date. If the Integrity Checker Tool (ICT) was not run before the appliance\nwas updated, the only evidence of compromise will exist in the system rollback partition\nwhich cannot be scanned by the ICT. If an upgrade was performed without first using\nthe ICT, a manual inspection of the rollback partition is required to determine if the\ndevice was previously compromised.\n2. To ensure that no malicious logic is copied to a clean device, users must perform\n\nupgrades from the appliance console rather than the web interface. The console\nupgrade process follows a separate code path that will not execute files such as\nDSUpgrade.pm.\n3. Previous versions of the ICT will exit if run on an unsupported software version. For\n\nevery ICT scan, ensure that the ICT would have supported the device's version\nnumber.\n4. Reset all passwords in the environment.\n5. Upgrade to the most recent software version.\n\nTo secure the appliance and assist with future investigations, consider implementing the\nfollowing:\n\n1. Enable unauthenticated logging and configure syslog for Events, User & Admin Access\n2. Forward all logs to a central log repository\n3. Review logs for unusual authentications and evidence of exploitation\n4. Regularly run the Integrity Checker Tool\n5. Apply patches as soon as they are made available\n\n**Geopolitical Context and Implications for U.S.-China Relations**\n\nIn collaboration with intelligence analysts at BAE Systems Applied Intelligence, Mandiant has\nidentified dozens of organizations across the defense, government, telecommunications,\nhigh tech, education, transportation, and financial sectors in the U.S. and Europe that have\nbeen compromised via vulnerabilities in Pulse Secure VPNs. Historic Mandiant and BAE\ninvestigations identified a significant number of these organizations as previous APT5\ntargets.\n\nNotably, compromised organizations operate in verticals and industries aligned with Beijing’s\nstrategic objectives as outlined in China’s 14th Five Year Plan. Many manufacturers also\ncompete with Chinese businesses in the high tech, green energy, and telecommunications\nsectors. Despite this, we have not directly observed the staging or exfiltration of any data by\nChinese espionage actors that could be considered a violation of the Obama-Xi agreement.\n\nTargets of Chinese cyber espionage operations are often selected for their alignment with\nnational strategic goals, and there is a strong correlation between pillar industries listed in\npolicy white papers and targets of Chinese cyber espionage activity.\n\n\n-----\n\nChina has outlined eight key areas of vital economic interest for development and production\nwhich it views as essential to maintaining global competitiveness, under the following\ncategories: energy, healthcare, railway transportation, telecommunications, national defense\nand stability, advanced manufacturing, network power, and sports and culture.\n\n_Historical Context_\n\nIn the _[Red Line Drawnreport, Mandiant documented a significant decline in the volume of](https://www.fireeye.com/content/dam/fireeye-www/current-threats/pdfs/rpt-china-espionage.pdf)_\nChinese cyberespionage activity in 2014 and assessed that the restructuring of China's\nmilitary and civilian intelligence agencies significantly impacted Chinese cyber operations.\nThen, in September 2015, President Xi of China concluded a bilateral agreement with U.S.\nPresident Obama to prohibit state-sponsored theft of intellectual property for the purpose of\nproviding commercial advantage. Commercial IP theft has historically been a prominent\ncharacteristic of Chinese cyber espionage activity.\n\n[In 2018 we conducted an extensive review of Chinese cyber espionage operations, both](https://www.fireeye.com/content/dam/fireeye-www/summit/cds-2018/presentations/cds18-executive-s05-redline-redrawn.pdf)\nbefore and after the official announcement of the PLA reforms and bilateral agreement to\ndetermine if there were any corresponding changes in the tactics, techniques, and\nprocedures (TTPs) used during Chinese cyberespionage operations. We observed two\nimportant changes in the type of information stolen and the geographic distribution of the\ntargets.\n\nDespite examining hundreds of incidents from January 2016 through mid 2019, we did\nnot find definitive evidence of purely commercial application intellectual property theft in\nthe US. Recent [indictments by the US Department of Justice suggest that this theft did](https://www.justice.gov/opa/pr/two-chinese-hackers-working-ministry-state-security-charged-global-computer-intrusion)\noccur. While we observed other malicious activity, including geopolitical targeting, theft\nof intellectual property with military applications, and theft of confidential business\ninformation, we did not find evidence that these cyber operations violated the ObamaXi agreement.\nBetween January 2016 and mid-2019, the geographic focus of Chinese cyber\noperations shifted dramatically to Asia and away from the U.S. and Europe. While the\nU.S. remained the single most frequently targeted country, it became a much smaller\npercentage of observed activity. From 2012–2015, U.S. targeting constituted nearly 70\npercent of all observed Chinese cyber espionage, while from January 2016 through\nAugust 2019, U.S. targeting fell to approximately 20 percent of Chinese activity.\nTargeting of Europe represented a similar proportion of overall Chinese activity to\ntargeting of the Americas.\n\n_Changes in Chinese Espionage Activity between 2019 and 2021_\n\nBased on developments observed between 2019-2021, Mandiant Threat Intelligence\nassesses that most Chinese APT actors now concentrate on lower-volume but moresophisticated, stealthier operations collecting strategic intelligence to support Chinese\n\n\n-----\n\nstrategic political, military, and economic goals. While some of the technical changes may be\nthe result of the restructuring of China's military and civilian organizations, some changes\npossibly reflect larger technical trends in cyber operations overall.\n\nBefore the reorganization, it was common to observe multiple Chinese espionage\ngroups targeting the same organization, often targeting the same types of information.\nPost-2015, this duplication of efforts is rare.\nChinese espionage groups developed more efficient and purposeful targeting patterns\nby transitioning away from spearphishing and relying on end user software\nvulnerabilities and instead began exploiting networking devices and web facing\napplications in novel ways. Chinese APT actors also began to leverage supply chain\nvulnerabilities and to target third party providers to gain access to primary targets.\nRecently observed Chinese cyber espionage activity exhibits an increased diligence in\noperational security, familiarity with network defender investigation techniques, and\ncognizance of the forensic evidence they leave behind.\nWe observe the resurgence of older Chinese espionage groups, including APT4 and\nAPT5 after long periods of dormancy and currently active groups engage in frequent\nand widespread campaigns.\n\n_Redline Withdrawn?_\n\nThe Obama-Xi agreement prohibits the theft of intellectual property with purely commercial\napplications for the purpose of gaining a competitive advantage. It does not cover\ngovernment or diplomatic information, sensitive business communications, IT data, PII, or\nintellectual property with military or dual use applications.\n\nWe have direct evidence of UNC2630, UNC2717 and other Chinese APT actors\nstealing credentials, email communications, and intellectual property with dual\ncommercial and military applications.\nThroughout our investigations, we did not directly observe the staging or exfiltration of\nany data by Chinese espionage actors that could be considered a violation of the\nObama-Xi agreement.\n\nGiven the narrow definition of commercial intellectual property theft and the limited\navailability of forensic evidence, it is possible that our assessment will change with the\ndiscovery of new information.\n\nEvidence collected by Mandiant over the past decade suggests that norms and diplomatic\nagreements do not significantly limit China's use of its cyber threat capabilities, particularly\nwhen serving high-priority missions.\n\nThe greater ambition and risk tolerance demonstrated by Chinese policymakers since 2019\nindicates that the tempo of Chinese state-sponsored activity may increase in the near future\nand that the Chinese cyber threat apparatus presents a renewed and serious threat to US\n\n\n-----\n\nand European commercial entities.\n\n**Acknowledgements**\n\nMandiant would like to thank analysts at BAE Systems Applied Intelligence, Stroz Friedberg,\nand Pulse Secure for their hard work, collaboration and partnership. The team would also\nlike to thank Scott Henderson, Kelli Vanderlee, Jacqueline O'Leary, Michelle Cantos, and all\nthe analysts who worked on Mandiant’s Red Line Redrawn project. The team would also like\nto thank Mike Dockry, Josh Villanueva, Keith Knapp, and all the incident responders who\nworked on these engagements.\n\n**Additional Resources**\n\n**Detecting the Techniques**\n\nThe following table contains specific FireEye product detection names for the malware\nfamilies associated with this updated information.\n\n**Platform(s)** **Detection Name**\n\n\nNetwork Security\n\nEmail Security\n\nDetection On Demand\n\nMalware File Scanning\n\nMalware File Storage\nScanning\n\n\nFE_APT_Tool_Linux32_BLOODMINE_1\nFE_APT_Tool_Linux_BLOODMINE_1\nFE_APT_Tool_Linux32_BLOODBANK_1\nFE_APT_Tool_Linux_BLOODBANK_1\nFE_APT_Tool_Linux32_CLEANPULSE_1\nFE_APT_Tool_Linux_CLEANPULSE_1\nFE_APT_Webshell_PL_RAPIDPULSE_1\nFEC_APT_Webshell_PL_RAPIDPULSE_1\n\n\nEndpoint Security **Real-Time Detection (IOC)**\n\nBLOODBANK (UTILITY)\nBLOODMINE (UTILITY)\n\n\n-----\n\nHelix **Establish Foothold**\n\nWINDOWS METHODOLOGY [User Account Created]\nWINDOWS METHODOLOGY [User Created - Net\nCommand]\n\n**Escalate Privileges**\n\nWINDOWS METHODOLOGY [Mimikatz Args]\nWINDOWS METHODOLOGY [Invoke-Mimikatz\nPowershell Artifacts]\nWINDOWS METHODOLOGY [LSASS Memory Access]\nWINDOWS METHODOLOGY [LSASS Generic Dump\nActivity]\n\n**Internal Reconnaissance**\n\nWINDOWS ANALYTICS [Recon Commands]\n\n**Move Laterally**\n\nWINDOWS ANALYTICS [Abnormal RDP Logon]\nOFFICE 365 ANALYTICS [Abnormal Logon]\n\n**Technical Annex**\n\n_BLOODMINE_\n\nBLOODMINE is a utility for parsing Pulse Secure Connect log files. It extracts information\nrelated to logins, Message IDs and Web Requests and copies the relevant data to another\nfile.\n\nThe sample takes three command line arguments\n\n1. Filename to read\n2. Filename to write\n3. Timeout interval\n\nIt parses the input file for login status codes:\n\nAUT31504\n\nAUT24414\n\nAUT22673\n\n\n-----\n\nAUT22886\n\nAUT23574\n\nIt parses the input file for web results code WEB20174. If it finds a web result code, it looks\nfor file extensions:\n\n.css\n\n.jpg\n\n.png\n\n.gif\n\n.ico\n\n.js\n\n.jsp\n\nThese strings indicate the type of data that is collected from web requests:\n\nWeb login, IP: %s, User: %s, Realm: %s, Roles: %s, Browser: %s\n\nAgent login, IP: %s, User: %s, Realm: %s, Roles: %s, Client: %s\n\nLogout, IP: %s, User: %s, Realm: %s, Roles: %s\n\nSession end, IP: %s, User: %s, Realm: %s, Roles: %s\n\nNew session, IP: %s, User: %s, Realm: %s, Roles: %s, New IP: %s\n\nHost check, Policy: %s\n\n\n-----\n\nWebRequest completed, IP: %s, User: %s, Realm: %s, Roles: %s, %s to %s://%s:%s/%s\nfrom %s\n\n_BLOODBANK_\n\nBLOODBANK is a credential theft utility that parses two LMDB (an in memory database) files\nand expects an output file to be given at the command prompt. BLOODBANK takes\nadvantage of a legitimate process that supports Single Sign On functionality and looks for\nplaintext passwords when they are briefly loaded in memory.\n\nThe utility parses the following two files containing password hashes or plaintext passwords:\n\n/home/runtime/mtmp/lmdb/data0/data.mdb\n/home/runtime/mtmp/system\n\nBLOODBANK expects an output file as a command line parameter, otherwise it prints file\nopen error. It contains the following strings which it likely tries to extract and target.\n\nPRIMARY\n\nSECONDARY\n\nremoteaddr\n\nuser@\n\nlogicUR\n\nlogicTim\n\npassw@\n\nuserAge\n\nrealm\n\nSourc\n\n_CLEANPULSE_\n\n\n-----\n\nCLEANPULSE is a memory patching utility that may be used to prevent certain log events\nfrom occurring. The utility inserts two strings from the command line into the target process\nand patches code to conditionally circumvent a function call in the original executable.\n\nFile Name File Type Size Compile Time\n\ndsrlog ELF.X86 13332\n\nThe utility expects to be run from the command line as follows:\n\ndrslog <pid> <code2_string> <code3_string> <command>\n\nWhere <pid> is the pid process ID to patch in memory, <code2_string> and <code3_string>\nare two strings to write into the target process, and <command> is either 'e' or 'E' for\ninstallation or 'u' or 'U' for uninstallation.\n\nDuring installation (using the 'e' or 'E' <command>), the <code2_string> <code3_string>\ncommand line strings are written to the target process at hard-coded memory addresses, a\nsmall amount of code is written, and a jump instruction to the code snippet is patched in\nmemory of the target process. The added code checks whether an argument is equal to\neither <code2_string> <code3_string> strings, and if, so skips a function call in the target\nprocess.\n\nDuring uninstall (using the 'u' or 'U' <command>) the patch jump location is overwritten with\nwhat appears to be the original 8 bytes of instructions, and the two additional memory buffers\nand the code snippet appear to be overwritten with zeros.\n\nThe CLEANPULSE utility is highly specific to a victim environment. It does not contain any\nvalidation code when patching (i.e. verifying that code is expected prior to modifying it), and it\ncontains hard-coded addresses to patch.\n\nThe target code to patch appears to be the byte sequence: 89 4C 24 08 FF 52 04. This\nappears as the last bytes in the patched code, and is the 8-bytes written when the uninstall\n'u' command is given.\n\nThese bytes correspond to the following two instructions:\n\n.data:0804B138 89 4C 24 08         mov   [esp+8], ecx\n\n.data:0804B13C FF 52 04            call  dword ptr [edx+4]\n\n\n-----\n\nThis byte sequence occurs at the hard-coded patch address the utility expects, dslogserver.\nBased on status and error messages in nearby functions the executable dslogserver appears\nto be related to log event handling, and the purpose of the CLEANPULSE utility may be to\nprevent certain events from being logged.\n\nThere are several un-referenced functions that appear to have been taken from the open\nsource project PUPYRAT. It is likely that the actor re-purposed this open source code, using\nPUPYRAT as a simple template project.\n\n_RAPIDPULSE_\n\nRAPIDPULSE is a webshell capable of arbitrary file read. As is common with other\nwebshells, RAPIDPULSE exists as a modification to a legitimate Pulse Secure file.\n\nThe webshell modifies the legitimate file's main routine which compares the HTTP query\nparameter with key name: deviceid to a specific key with value. If the parameter matches,\nthen the sample uses an RC4 key to decrypt HTTP query parameter with key name:\nhmacTime. This decrypted value is a filename which the sample then opens, reads, RC4\nencrypts with the same key, base64 encodes, then writes to stdout. The appliance redirects\nstdout as the response to HTTP requests. This serves as an encrypted file download for the\nattacker.\n\n**Integrity Checker Tool and Other Validation Checks**\n\nIn our public report, we noted two code families that manipulate check_integrity.sh, a\nlegitimate script used during a normal system upgrade. This validation script was modified by\nthe actor to exit early so that it would not perform the intended checks.\n\nPer Ivanti, the validation provided by check_integrity.sh is a separate validation feature and\nnot the same as the [Integrity Checker Tool (ICT) available on their website. They recommend](https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755)\nthat organizations use the online ICT to confirm that hashes of files on their Pulse Secure\ndevices match Ivanti’s list of known good hashes. Please note that the ICT does not scan the\nrollback partition.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-27 - Re-Checking Your Pulse- Updates on Chinese APT Actors Compromising Pulse Secure VPN Devices.pdf"
    ],
    "report_names": [
        "2021-05-27 - Re-Checking Your Pulse- Updates on Chinese APT Actors Compromising Pulse Secure VPN Devices.pdf"
    ],
    "threat_actors": [
        {
            "id": "e44de7cd-80f0-4f0e-a348-33da1947fd25",
            "created_at": "2023-12-08T02:00:05.724516Z",
            "updated_at": "2025-03-27T02:00:03.261772Z",
            "deleted_at": null,
            "main_name": "UNC2717",
            "aliases": [],
            "source_name": "MISPGALAXY:UNC2717",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7e75ee53-c4d3-4260-8106-ed7b61d35f02",
            "created_at": "2023-12-08T02:00:05.765868Z",
            "updated_at": "2025-03-27T02:00:03.269367Z",
            "deleted_at": null,
            "main_name": "UNC2630",
            "aliases": [],
            "source_name": "MISPGALAXY:UNC2630",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "13bedce4-3115-4563-afd5-068e3930e68e",
            "created_at": "2023-01-06T13:46:38.623775Z",
            "updated_at": "2025-03-27T02:00:02.8761Z",
            "deleted_at": null,
            "main_name": "APT5",
            "aliases": [
                "KEYHOLE PANDA",
                "BRONZE FLEETWOOD",
                "TEMP.Bottle",
                "Mulberry Typhoon",
                "Poisoned Flight"
            ],
            "source_name": "MISPGALAXY:APT5",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "68cc6e37-f16d-4995-a75b-5e8e2a6cbb3d",
            "created_at": "2024-05-01T02:03:07.943593Z",
            "updated_at": "2025-03-27T02:05:17.259709Z",
            "deleted_at": null,
            "main_name": "BRONZE EDISON",
            "aliases": [
                "DarkSeoul",
                "Maverick Panda ",
                "Sykipot ",
                "TG-0623 ",
                "getkys",
                "APT4 "
            ],
            "source_name": "Secureworks:BRONZE EDISON",
            "tools": [
                " Wkysol",
                " ZxPortMap",
                "Gh0st RAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e0ffe8ec-caee-414f-8fd5-b69ffd262e6f",
            "created_at": "2024-05-01T02:03:07.950544Z",
            "updated_at": "2025-03-27T02:05:17.265795Z",
            "deleted_at": null,
            "main_name": "BRONZE FLEETWOOD",
            "aliases": [
                "DPD ",
                "Keyhole Panda ",
                "Mulberry Typhoon ",
                "Poisoned Flight ",
                "TG-2754 ",
                "APT5 "
            ],
            "source_name": "Secureworks:BRONZE FLEETWOOD",
            "tools": [
                " Comfoo",
                " Gh0st RAT",
                " Isastart",
                " Leouncia",
                " OrcaRAT",
                " PCShare",
                " Skeleton Key",
                " SlyPidgin",
                " VinSelf",
                "Binanen"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d4ac28d1-66eb-4f2d-9f9b-a72394349fd0",
            "created_at": "2023-01-06T13:46:38.667954Z",
            "updated_at": "2025-03-27T02:00:02.887442Z",
            "deleted_at": null,
            "main_name": "APT4",
            "aliases": [
                "PLA Navy",
                "MAVERICK PANDA",
                "BRONZE EDISON",
                "SODIUM",
                "Salmon Typhoon"
            ],
            "source_name": "MISPGALAXY:APT4",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6d69ef1b-b6f3-47e1-be5a-87ac0fd5ff55",
            "created_at": "2024-04-24T02:00:49.599348Z",
            "updated_at": "2025-03-27T02:00:55.521185Z",
            "deleted_at": null,
            "main_name": "APT5",
            "aliases": [
                "APT5",
                "Mulberry Typhoon",
                "BRONZE FLEETWOOD",
                "Keyhole Panda",
                "UNC2630"
            ],
            "source_name": "MITRE:APT5",
            "tools": [
                "Tasklist",
                "PoisonIvy",
                "RAPIDPULSE",
                "PcShare",
                "Mimikatz",
                "SLOWPULSE",
                "SLIGHTPULSE",
                "Skeleton Key",
                "gh0st RAT",
                "PULSECHECK",
                "netstat"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535844,
    "ts_updated_at": 1743041725,
    "ts_creation_date": 1653759135,
    "ts_modification_date": 1653759135,
    "files": {
        "pdf": "https://archive.orkl.eu/7b6152013eaaffc640a3d02d86863084dcb2e1bc.pdf",
        "text": "https://archive.orkl.eu/7b6152013eaaffc640a3d02d86863084dcb2e1bc.txt",
        "img": "https://archive.orkl.eu/7b6152013eaaffc640a3d02d86863084dcb2e1bc.jpg"
    }
}