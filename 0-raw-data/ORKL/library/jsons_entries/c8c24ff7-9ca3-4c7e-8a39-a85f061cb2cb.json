{
    "id": "c8c24ff7-9ca3-4c7e-8a39-a85f061cb2cb",
    "created_at": "2023-01-12T15:02:22.360154Z",
    "updated_at": "2025-03-27T02:14:39.209837Z",
    "deleted_at": null,
    "sha1_hash": "6aa9b438341e5d80fed337028390d1851da4a2dc",
    "title": "2018-06-28 - The New Face of Necurs- Noteworthy Changes to Necurs’ Behaviors",
    "authors": "",
    "file_creation_date": "2022-05-28T23:51:26Z",
    "file_modification_date": "2022-05-28T23:51:26Z",
    "file_size": 663398,
    "plain_text": "# New Noteworthy Changes to Necurs’ Behaviors\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/the-new-face-of-necurs-noteworthy-changes-to-necurs-behaviors](https://blog.trendmicro.com/trendlabs-security-intelligence/the-new-face-of-necurs-noteworthy-changes-to-necurs-behaviors)**\n\nJune 28, 2018\n\nMalware\n\nWe recently discovered noteworthy changes to the way Necurs makes use of its bots, such\nas pushing infostealers on them and showing a special interest in bots with specific\ncharacteristics.\n\nBy: Anita Hsieh, Rubio Wu, Kawabata Kohei, Fyodor Yarochkin June 28, 2018 Read time: (\nwords)\n\nAssets Filter Enter path Images Select Tag(s) Publish status Loading results NEW\nNOTEWORTHY CHANGES TO NECURS’ BEHAVIORSEditPreview Text\n\nSix years after it was first spotted in the wild, the Necurs malware botnet is still out to prove\nthat it’s a malware chameleon. We recently discovered noteworthy changes to the way\nNecurs makes use of its bots, such as pushing infostealers on them and showing a special\ninterest in bots with specific characteristics. These behavioral changes could potentially\ncreate a big impact as Necurs has been used in large-scale cybercriminal deployments in the\npast.\n\n\n-----\n\nAs a modularized malware, Necurs can run any module on its network of bots. In 2017, we\nsaw Necurs pushing spamming and proxy modules onto its bots. This year, however, there’s\na notable decrease on Necurs’ spam volume compared to its spam campaigns in the last\nquarter of 2017. Instead, we see Necurs pushing cryptocurrency miners and infostealers —\nFlawedAmmyy RAT, AZORult, and a .NET module — as modules onto its bots.\n\n**Necurs pushes XMRig to its bots to mine Monero**\nIn March, we saw Necurs pushing a Monero Miner — XMRig — to its bots. At the time we\nchecked it, the wallet owner was able to earn around $USD 1,200.00 in 24 hours.\n\nFigure 1. A screen capture showing the wallet owner's earnings using the XMRig to mine\nMonero. The user in the configuration of this XMRig module is\n“47CCqA1ERkT6jUT8yhgJj7dkdHXhBw86\nxiKsCdZ6auDmCC3mAQLpBxP2nhpGuHA27tToNeZM98Tz\nFKe6vjCajdHdCz67iRB.worker” .\n\nIn April, we observed that it pushed the remote access trojan FlawedAmmyy onto its bots.\nFlawedAmmyy is trojanized from a legitimate remote access tool Ammyy Admin. Like the\nremote desktop tool, FlawedAmmyy has the functionalities of Ammyy Admin, including\nremote desktop control, file system management, proxy support and audio chat capabilities.\nNecurs pushes different modules via C&C commands. These modules check the bots if they\nqualify for any of the following criteria:\n\n1. Bots that are with crypto wallets.[1] The Necurs modules check if the machines have\nfiles that contain any of the following strings that exist under “%APPDATA%” such as:\n\n_WALLET.DAT_\n_BITCOIN-QT_\n_ELECTRUM_\n_COINBASE_\n_MULTIBITHD_\n_WALLET.AES_\n_LITECOIN_\n_MONERO_\n_BITCOINCORE_\n\n\n2. Bots that are under or able to reach bank-related domains.[2] The modules execute\ncommands such as “net view” and “net user” to check for the following strings:\n\n_BANQ_\n_BANK_\n_BANC_\n_SWIFT_\n\n\n-----\n\n_BITCOIN_\n_WESTERNUNION_\n_MONEYGRAM_\n_CARD_\n\n3. Bots that are running in a network with more than 100 employees or users.[3] The\nmodules execute “net user” and “net domain” to see if a machine is connected to a network\nwith more than 100 users.\n\n\n4. Bots that run POS-related processes.[4]\n\n5. Bots that are logged in using an email address on a hardcoded list.[5] The modules,\nwhich contain some hardcoded lists, will check whether the email accounts associated with a\nmachine is on the list. We will detail this part in the section “Necurs Pushes Modules for\nEmail Extraction” below.\n\n\nIf the bots qualify based on the criteria listed above, the modules will install the\nFlawedAmmyy RAT onto its bots. After the session initializes, the FlawedAmmyy RAT on the\ninfected bots steals and sends back the information, which includes:\n\n_id_\n_os_\n_priv (privilege)_\n_cred (DOMAIN\\username)_\n_pcname (Computer name)_\n_avname (Antivirus name)_\n_build_time (Malware build time)_\n_card (whether smart-card is connected or not)_\n\nFigure 2. The information sent back by FlawedAmmyy RAT.\n\n**Necurs pushes modules for email extraction**\n\nIn late May, we saw some Necurs modules that exfiltrated email accounts and sent them to\nhxxp://185[.]176[.]221[.]24/l/s[.]php. If someone installs and logs in to Outlook, Outlook\ncreates a directory “%AppData%\\Roaming\\Microsoft\\Outlook\\” wherein it will store\ncredentials with an email string in the filename (Figure 3). The module will search for the files\nwith email strings in the filenames and send those strings back.\n\nFigure 3. Example: the directory storing credentials with a string in email format as part of the\nfilename\n\n\n-----\n\nAfter just a few days, we saw four new modules that also dropped FlawedAmmyy RATs but\nwith a distinct feature — they contained hardcoded email lists inside. The four modules\nchecked if the email addresses on the bots were in any of the lists — the same manner in\nwhich they were able to extract the email addresses that make up the lists — and if so,\ndropped the FlawedAmmyy RATs.\n\nAfter checking the hardcoded email lists, we discovered that it’s possible that the threat\nactors used keyword matching to pick up email addresses that interest them.\n\nFigure 4. A list of email addresses that feature notable similarities. Aside from bank-related\nemail addresses, some of the email addresses on the list seem to belong to government\ninstitutions.\n\nAfter further analysis, we extracted the different keywords used in the email address lists.\nBased on the keywords, threat actors appear to show interest in governments, financial\ninstitutions, tourism and food industries, and real estate companies.\n\nFigure 5. Keywords extracted from the email address lists in the four Necurs modules.\n\n**A possible change in spamming tactics**\n\nAnother notable action of Necurs is the possible change in its spamming tactics.\n\nOn June 11, 2018, we saw Necurs push a .NET spamming module that is capable of sending\nemails and stealing credentials from Internet Explorer, Chrome, and Firefox. Some parts of\nthis .NET spamming module overlap with an open-source remote access tool.\n\nFigure 6. The Firefox StealerModule in the .NET spamming module on the left-hand side\nhas overlaps with QuasarRAT on the right-hand side.\n\nWhen Necurs drops the .NET spamming module onto its bots, it gives the arguments that the\nbots should execute the binary. The following is a screen capture of the command we\nreceived from Necurs’ C&Cs:\n\nFigure 7. A .NET module command screen capture.\n\nThe .NET spamming module (sha1: c25fcdf464202ef4226d085b8e495f4e5064125e)\nperforms different actions according to the arguments given (“args” in Figure 7). The\nfollowing are some arguments it accepts:\n\n“-sendcorp”: send the emails via victims’ Outlook\n“-sendprivate”: send emails via victims’ Gmail and Yahoo\n“-subject”: the subject for the email\n\n\n-----\n\n-attach : the attachment for the email in base64 format\n“-name”: the “FROM” address for the email\n“-body”: the body for the email in base64 format\n“-demo”: send a copy to the given email address\n\nThe mail sent with the arguments in Figure 7 will be as follows:\n\nFigure 8. The email sent by .NET spamming module with the arguments in Figure 7.\n\nThe following are some of the .NET module’s noteworthy features: it can send spam using\nthe logged-in email accounts on a victim’s machine, and it can access a victim’s contact list\nstored in email clients and the email addresses with which a victim has previously\ncorresponded. The victims will not be able to notice the spam being sent from their email\naddresses as the .NET module can delete the last email sent from the victim’s email account\nand catch all alerts.\n\nIn the past, Necurs sent spam to its victims directly via its bots, which allowed blacklisting bot\nIPs to block them. However, if the spam emails are sent via legitimate email clients with\nwhitelisted IPs, the IP-blocking solution might not work properly. Moreover, those spam\nemails are from email accounts that the receivers already recognize. Although this technique\nis not new — some malware campaigns such as EMOTET and Ursnif/Dreambot have\nalready adopted this kind of spamming technique — this is a new technique for Necurs.\n\nWith the “demo” argument set, we believe that this module is a test run for possible future\ncampaigns and a way for the malware author to demonstrate the .NET module’s capabilities\nto possible customers.\n\n**Defending against Necurs malware**\n\nTo defend against Necurs and other continuously evolving spammed threats, businesses can\n[take advantage of Trend Micro™ endpoint solutions such as Trend Micro](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) Smart Protection\nSuites and [Worry-Free™](https://blog.trendmicro.com/en_us/small-business/worry-free-services-suites.html) [Business Security. Both solutions can protect users and](https://blog.trendmicro.com/en_us/small-business/worry-free-services-suites.html)\nbusinesses from threats by detecting malicious files, and spammed messages as well as\n[blocking all related malicious URLs. Trend Micro](https://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection.html) [Deep Discovery™ has an email inspection](https://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection.html)\nlayer that can protect enterprises by detecting malicious attachment and URLs. Deep\nDiscovery can detect the remote script despite it not being downloaded in the physical\nendpoint.\n\n[Trend Micro™](https://blog.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/email-security.html) [Hosted Email Security is a no-maintenance cloud solution that delivers](https://blog.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/email-security.html)\ncontinuously updated protection to stop spam, malware, spear phishing, ransomware, and\nadvanced targeted attacks before they reach the network. It protects Microsoft\nExchange, [Microsoft Office 365, Google Apps, and other hosted and on-premises email](https://blog.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/cloud-app-security.html)\nsolutions.\n\n\n-----\n\n[Trend Micro™](https://blog.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html) [OfficeScan™ with](https://blog.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html) [XGen™ endpoint security infuses high-fidelity machine](https://blog.trendmicro.com/en_us/business.html)\nlearning with other detection technologies and global threat intelligence for comprehensive\n[protection against advanced malware.  A list of all the hashes (SHA256) is in this list.](https://documents.trendmicro.com/assets/pdf/TheNewFaceofNecurs_NoteworthyChangestoNecursBehaviors_Appendix_Final.pdf)\n\n[1] List of strings gathered as of April 11, 2018. [2] First detected on April 11, 2018. [3] First\ndetected on April 18, 2018. [4] First detected on April 26, 2018. [5] First detected on June 1,\n2018.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-06-28 - The New Face of Necurs- Noteworthy Changes to Necurs’ Behaviors.pdf"
    ],
    "report_names": [
        "2018-06-28 - The New Face of Necurs- Noteworthy Changes to Necurs’ Behaviors.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535742,
    "ts_updated_at": 1743041679,
    "ts_creation_date": 1653781886,
    "ts_modification_date": 1653781886,
    "files": {
        "pdf": "https://archive.orkl.eu/6aa9b438341e5d80fed337028390d1851da4a2dc.pdf",
        "text": "https://archive.orkl.eu/6aa9b438341e5d80fed337028390d1851da4a2dc.txt",
        "img": "https://archive.orkl.eu/6aa9b438341e5d80fed337028390d1851da4a2dc.jpg"
    }
}