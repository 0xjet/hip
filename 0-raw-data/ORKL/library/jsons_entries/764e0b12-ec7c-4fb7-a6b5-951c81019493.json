{
    "id": "764e0b12-ec7c-4fb7-a6b5-951c81019493",
    "created_at": "2023-01-12T15:10:35.031524Z",
    "updated_at": "2025-03-27T02:05:58.325824Z",
    "deleted_at": null,
    "sha1_hash": "292a01c792aa3c9976009b731b9397ce552ffe4d",
    "title": "2016-12-28 - Switcher- Android joins the ‘attack-the-router’ club",
    "authors": "",
    "file_creation_date": "2022-05-27T21:59:58Z",
    "file_modification_date": "2022-05-27T21:59:58Z",
    "file_size": 862902,
    "plain_text": "# Switcher: Android joins the ‘attack-the-router’ club\n\n**[securelist.com/blog/mobile/76969/switcher-android-joins-the-attack-the-router-club/](https://securelist.com/blog/mobile/76969/switcher-android-joins-the-attack-the-router-club/)**\n\nAuthors\n\nNikita Buchka\n\nRecently, in our never-ending quest to protect the world from malware, we found a\nmisbehaving Android trojan. Although malware targeting the Android OS stopped being a\nnovelty quite some time ago, this trojan is quite unique. Instead of attacking a user, it attacks\nthe Wi-Fi network the user is connected to, or, to be precise, the wireless router that serves\nthe network. The trojan, dubbed Trojan.AndroidOS.Switcher, performs a brute-force\npassword guessing attack on the router’s admin web interface. If the attack succeeds, the\nmalware changes the addresses of the DNS servers in the router’s settings, thereby\nrerouting all DNS queries from devices in the attacked Wi-Fi network to the servers of the\ncybercriminals (such an attack is also known as DNS-hijacking). So, let us explain in detail\nhow Switcher performs its brute-force attacks, gets into the routers and undertakes its DNShijack.\n\n## Clever little fakes\n\nTo date, we have seen two versions of the trojan:\n\n\n-----\n\nacdb7bfebf04affd227c93c97df536cf; package name – com.baidu.com\n64490fbecefa3fcdacd41995887fe510; package name – com.snda.wifi\n\nThe first version (com.baidu.com), disguises itself as a mobile client for the Chinese search\n[engine Baidu, simply opening a URL http://m.baidu.com inside the application. The second](http://m.baidu.com/)\nversion is a well-made fake version of a popular Chinese app\n(http://www.coolapk.com/apk/com.snda.wifilocating) for sharing information about Wi-Fi\nnetworks (including the security password) between users of the app. Such information is\nused, for example, by business travelers to connect to a public Wi-Fi network for which they\ndon’t know the password. It is a good place to hide malware targeting routers, because users\nof such apps usually connect with many Wi-Fi networks, thus spreading the infection.\n\nThe cybercriminals even created a website (though badly made) to advertise and distribute\nthe aforementioned fake version of com.snda.wifilocating. The web server that hosts the site\nis also used by the malware authors as the command-and-control (C&C) server.\n\n\n-----\n\n## The infection process\n\nThe trojan performs the following actions:\n\n1. Gets the BSSID of the network and informs the C&C that the trojan is being activated in\n\na network with this BSSID\n2. Tries to get the name of the ISP (Internet Service Provider) and uses that to determine\n\nwhich rogue DNS server will be used for DNS-hijacking. There are three possible DNS\nservers – 101.200.147.153, 112.33.13.11 and 120.76.249.59; with 101.200.147.153\nbeing the default choice, while the others will be chosen only for specific ISPs\n\n\n-----\n\n3. Launches a brute-force attack with the following predefined dictionary of logins and\n\npasswords:\n\nadmin:00000000\nadmin:admin\nadmin:123456\nadmin:12345678\nadmin:123456789\nadmin:1234567890\nadmin:66668888\nadmin:1111111\nadmin:88888888\nadmin:666666\nadmin:87654321\nadmin:147258369\nadmin:987654321\nadmin:66666666\nadmin:112233\nadmin:888888\nadmin:000000\nadmin:5201314\nadmin:789456123\nadmin:123123\nadmin:789456123\nadmin:0123456789\nadmin:123456789a\nadmin:11223344\nadmin:123123123\n\nThe trojan gets the default gateway address and then tries to access it in the embedded\nbrowser. With the help of JavaScript it tries to login using different combinations of logins and\npasswords. Judging by the hardcoded names of input fields and the structures of the HTML\ndocuments that the trojan tries to access, the JavaScript code used will work only on web\ninterfaces of TP-LINK Wi-Fi routers\n\nIf the attempt to get access to the admin interface is successful, the trojan navigates to\nthe WAN settings and exchanges the primary DNS server for a rogue DNS controlled by the\ncybercriminals, and a secondary DNS with 8.8.8.8 (the Google DNS, to ensure ongoing\nstability if the rogue DNS goes down). The code that performs these actions is a complete\nmess, because it was designed to work on a wide range of routers and works in\nasynchronous mode. Nevertheless, I will show how it works, using a screenshot of the web\ninterface and by placing the right parts of the code successively.\n\n\n-----\n\n-----\n\nIf the manipulation with DNS addresses was successful, the trojan report its success to the\nC&C\n\n## So, why it is bad?\n\nTo appreciate the impact of such actions it is crucial to understand the basic principles of\nhow DNS works. The DNS is used for resolving a human-readable name of the network\nresource (e.g. website) into an IP address that is used for actual communications in the\ncomputer network. For example, the name “google.com” will be resolved into IP address\n87.245.200.153. In general, a normal DNS query is performed in the following way:\n\n\n-----\n\nWhen using DNS-hijacking, the cybercriminals change the victim’s (which in our case is the\nrouter) TCP/IP settings to force it to make DNS queries to a DNS server controlled by them –\na rogue DNS server. So, the scheme will change into this:\n\n\n-----\n\nAs you can see, instead of communicating with the real google.com, the victim will be fooled\ninto communicating with a completely different network resource. This could be a fake\ngoogle.com, saving all your search requests and sending them to the cybercriminals, or it\ncould just be a random website with a bunch of pop-up ads or malware. Or anything else.\nThe attackers gain almost full control over the network traffic that uses the name-resolving\nsystem (which includes, for example, all web traffic).\n\nYou may ask – why does it matter: routers don’t browse websites, so where’s the risk?\nUnfortunately, the most common configuration for Wi-Fi routers involves making the DNS\nsettings of the devices connected to it the same as its own, thus forcing all devices in the\nnetwork use the same rogue DNS. So, after gaining access to a router’s DNS settings one\ncan control almost all the traffic in the network served by this router.\n\nThe cybercriminals were not cautious enough and left their internal infection statistics in the\nopen part of the C&C website.\n\n\n-----\n\nAccording to them, they successfully infiltrated 1,280 Wi-Fi networks. If this is true, traffic of\nall the users of these networks is susceptible to redirection.\n\n## Conclusion\n\nThe Trojan.AndroidOS.Switcher does not attack users directly. Instead, it targets the entire\nnetwork, exposing all its users to a wide range of attacks – from phishing to secondary\ninfection. The main danger of such tampering with routers’ setting is that the new settings will\nsurvive even a reboot of the router, and it is very difficult to find out that the DNS has been\nhijacked. Even if the rogue DNS servers are disabled for some time, the secondary DNS\nwhich was set to 8.8.8.8 will be used, so users and/or IT will not be alerted.\n\nWe recommend that all users check their DNS settings and search for the following rogue\nDNS servers:\n\n101.200.147.153\n112.33.13.11\n120.76.249.59\n\n\n-----\n\nIf you have one of these servers in your DNS settings, contact your ISP support or alert the\nowner of the Wi-Fi network. Kaspersky Lab also strongly advises users to change the default\nlogin and password to the admin web interface of your router to prevent such attacks in the\nfuture.\n\n[DNS](https://securelist.com/tag/dns/)\n[Google Android](https://securelist.com/tag/google-android/)\n[Mobile Malware](https://securelist.com/tag/mobile-malware/)\n[Router](https://securelist.com/tag/router/)\n\nAuthors\n\nNikita Buchka\n\nSwitcher: Android joins the ‘attack-the-router’ club\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-12-28 - Switcher- Android joins the ‘attack-the-router’ club.pdf"
    ],
    "report_names": [
        "2016-12-28 - Switcher- Android joins the ‘attack-the-router’ club.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536235,
    "ts_updated_at": 1743041158,
    "ts_creation_date": 1653688798,
    "ts_modification_date": 1653688798,
    "files": {
        "pdf": "https://archive.orkl.eu/292a01c792aa3c9976009b731b9397ce552ffe4d.pdf",
        "text": "https://archive.orkl.eu/292a01c792aa3c9976009b731b9397ce552ffe4d.txt",
        "img": "https://archive.orkl.eu/292a01c792aa3c9976009b731b9397ce552ffe4d.jpg"
    }
}