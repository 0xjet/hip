{
    "id": "1d64c160-5c3d-4ebb-924a-8c34b416ec7f",
    "created_at": "2023-01-12T15:08:57.741682Z",
    "updated_at": "2025-03-27T02:17:24.722429Z",
    "deleted_at": null,
    "sha1_hash": "8aa98c37fc538d7b3db73a4f377913beb453ddee",
    "title": "2020-08-07 - BlackWater Malware Leveraging Beirut Tragedy in New Targeted Campaign",
    "authors": "",
    "file_creation_date": "2022-05-28T17:49:09Z",
    "file_modification_date": "2022-05-28T17:49:09Z",
    "file_size": 796926,
    "plain_text": "# BlackWater Malware Leveraging Beirut Tragedy in New Targeted Campaign\n\n**[quointelligence.eu/2020/08/blackwater-malware-leveraging-beirut-tragedy-in-new-targeted-campaign/](https://quointelligence.eu/2020/08/blackwater-malware-leveraging-beirut-tragedy-in-new-targeted-campaign/)**\n\nAugust 7, 2020\n\n### [Updated on August 11, 2020]\n\n## Executive Summary\n\n[QuoIntelligence discovered a new targeted campaign delivering the novel BlackWater](https://quointelligence.eu/)\nmalware\nThe campaign used the Beirut incident to lure the targets, with an attempt to spoof an\nofficial OSCE report\nThe campaign was launched on 5 August, only one day after the Beirut incident. The\nprovider hosting the attack infrastructure promptly shot down the C2 servers after our\nnotification on 7 August\nThe attack used state-of-the-art techniques, such as DNS over HTTPs (DoH)\nBased on the advanced TTPs and the discovered targets, we classify the threat actor\nas an Advanced Persistent Threat (APT) group named “ReconHellcat”\nObserved ReconHellcat targets consist of -at least- defense and diplomatic\ngovernment bodies in Bulgaria and Azerbaijan\n\n## Introduction\n\nOn 6 August, QuoIntelligence discovered a malicious file uploaded to VirusTotal using the\nBeirut incident as a theme to lure the targets. Further analysis attributed the analysed artifact\nto BlackWater: [a recently-discovered malware that uses](https://www.bleepingcomputer.com/news/security/blackwater-malware-abuses-cloudflare-workers-for-c2-communication/) [Cloudflare Workers as a C2](https://blog.cloudflare.com/cloudflare-workers-unleashed/)\ncommunication interface and DNS over HTTPS (DoH) as name resolution channel.\n\nWe publicly disclosed our preliminary results on 7 August and made Cloudflare aware of the\nmalicious infrastructure. Cloudflare promptly shutdown the C2 servers after our notification.\n\n## Technical Analysis\n\n[On 5 August, a compressed archive was uploaded to VirusTotal from Azerbaijan, containing](https://www.virustotal.com/gui/file/b4ed39b6852bce329686ec44e2e8e39b1c0be9b7095cec2e1682e6e2ef724c69)\na malicious, macro-enabled Word Document (maldoc) themed for the recent explosion in\nBeirut. The name of the maldoc (047-20 – OSCE Report Beirut explosion.doc) might indicate\n[attackers’ intent to spoof the Organization for Security and Co-operation in Europe (OSCE),](https://www.osce.org/)\nhowever, we discovered that attackers weaponized a legit Word document available in the\nweb portal of the [Organismo Supervisor de las Contrataciones del Estado (OSCE), which is](https://www.gob.pe/en/osce)\n\n\n-----\n\na supervisory body of the Peruvian Ministry of Economy. The image below shows the\ncomparison between the maldoc and the legit Word file from the Peruvian OCSE available in\ntheir website.\n\nThe maldoc contains an obfuscated macro that retrieves the second-stage encrypted\npayload from one of the three hardcoded C2 URLs depending on the user’s Windows\nversion. To decrypt the payload, attackers implemented the old-fashion substitution cipher\n[technique Book cipher using the legit Windows file](https://en.wikipedia.org/wiki/Book_cipher) `C:\\Windows\\Fonts\\cambriab.tff as`\nkey. To note that the content of this file differs depending on the Windows version, this is\nwhy the malicious macro checks the Windows version at the beginning of its execution, and\ncontacts a specific URL depending of the result of this check. Finally, the decrypted payload\nis written in `%APPDATA%\\\\Microsoft\\Word\\STARTUP\\Moon.wll . By storing a Word add-in`\nin such path allows Microsoft Word to load and execute it a malicious payload whenever it is\n[launched. Although this technique (T1137/006) was firstly documented by F-Secure in](https://attack.mitre.org/techniques/T1137/006/)\n2017, only this year researchers publicly reported two APT groups firstly using it: Naikon\nAPT and [Vicious Panda.](https://research.checkpoint.com/2020/vicious-panda-the-covid-campaign/)\n\nThe malicious `Moon.wll` contains another encrypted set of three different C2 URLs, and\nonce executed by Word, it downloads an encrypted x64 executable as the final backdoor.\nThe decryption technique used to decrypt the x64 backdoor still uses the Windows font file\nas key, however, the C2 URL is passed as an encrypted parameter which is decrypted via a\ndifferent substitution cipher relying on an hardcoded alphabet as a key.\n\nFinally, the Blackwater backdoor starts communicating with the Clouldflare Worker via\nJSON. Notably, both the loader and the backdoor resolve the C2 hostnames via DNS-overHTTP (DoH) by using a built-in feature of libcurl. Only the malicious Macro is using the\nsystem’s default DNS server to get the first-stage payload.\n\nTo note that all the samples we have analysed had a very low AV detection rate when they\nwere firstly uploaded to VirusTotal.\n\n\n-----\n\nThe C2 infrastructure was hosted on Cloudflare Workers platform, which is a service\nenabling users to register a subdomain and then have serverless code running to handle\nrequests.\n\n## Attribution\n\nOur technical findings overlap with the Tactics, Techniques and Procedures (TTPs)\npreviously attributed to the BlackWater malware campaign first identified in March:\n\nCompressed archive containing a maldoc\nBlackwater strings within the malware\nDoH communications using `cloudflare-dns.com`\nC2 hosted on Cloudflare Workers service\nJSON encoded communications\n\nAs shown in the picture below, the analysis of the x64 sample revealed multiple strings\ncontaining the word “BlackWater”.\n\nWe researched the targets of both BlackWater campaigns (March and August) and\nconcluded that -at least- defense and diplomatic government bodies in Bulgaria and\nAzerbaijan were highly likely targeted. Based on the advanced TTPs and the targeted\ninstitutions we classify the threat actor as an Advanced Persistent Threat (APT) group. Since\nwe have not found yet any solid overlap with any already-known APT group, we are naming\nthe attackers behind the two BlackWater campaigns as “ReconHellcat”.\n\nDo you want to stay informed of cyber and geopolitical threats targeting your organization?\nAre you interested in receiving exclusive and unpublished intelligence?\n\n[Get in touch!](https://quointelligence.eu/#contact)\n\n## Appendix I\n\n\n-----\n\n## Early Indicators of Compromise\n\n**047-20 – OSCE Report Beirut explosion.rar**\nb4ed39b6852bce329686ec44e2e8e39b1c0be9b7095cec2e1682e6e2ef724c69\n**047-20 – OSCE Report Beirut explosion.doc**\n8b5ae22661e690b6689ea5894cb05e288c64927c2f0ccf8c11c814ad56968376\n\n**Second Stage – Office Plugin – moon1.wll**\n\n9b35a2bddc006ff5ab7262f5fb15f8c7ab9aee8f34bf02815f81f0c74222438b\n\n**Third-stage x64 (decrypted)**\n\nf984bc0896813553ec8b6dbb9b72769b3bbc8fbbe401566049df2e2061f1a829\n\nhttps://b1[.]earth09[.]workers[.]dev/\n\nhttps://b2[.]earth09[.]workers[.]dev/\n\nhttps://b3[.]earth09[.]workers[.]dev/\n\nhttps://moon3[.]earth09[.]workers[.]dev\n\nhttps://moon1[.]earth09[.]workers[.]dev\n\nhttps://moon2[.]earth09[.]workers[.]dev\n\n## Join Our Newsletter!\n\nSubscribe to our newsletter to receive Weekly Intelligence Summaries, cyber news, and\nexciting updates!\n\nOnly valid business emails will be approved.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-08-07 - BlackWater Malware Leveraging Beirut Tragedy in New Targeted Campaign.pdf"
    ],
    "report_names": [
        "2020-08-07 - BlackWater Malware Leveraging Beirut Tragedy in New Targeted Campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "30ed778d-15b3-484e-a90b-e1e05b36a42f",
            "created_at": "2023-01-06T13:46:38.290626Z",
            "updated_at": "2025-03-27T02:00:02.795711Z",
            "deleted_at": null,
            "main_name": "APT30",
            "aliases": [
                "G0013"
            ],
            "source_name": "MISPGALAXY:APT30",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f5c5d5d4-3969-4e34-9982-55144c3908eb",
            "created_at": "2022-10-25T16:07:24.37846Z",
            "updated_at": "2025-03-27T02:02:10.200339Z",
            "deleted_at": null,
            "main_name": "Vicious Panda",
            "aliases": [
                "Bronze Dudley"
            ],
            "source_name": "ETDA:Vicious Panda",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "BBSRAT",
                "Byeby",
                "Cmstar",
                "Enfal",
                "Lurid",
                "Pylot",
                "RoyalRoad",
                "Travle",
                "meciv"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c416260c-7ff6-4a74-a5ba-a15f40d3543f",
            "created_at": "2024-05-01T02:03:07.939268Z",
            "updated_at": "2025-03-27T02:05:17.25652Z",
            "deleted_at": null,
            "main_name": "BRONZE DUDLEY",
            "aliases": [
                "Temp.Hex ",
                "Vicious Panda ",
                "TA428 "
            ],
            "source_name": "Secureworks:BRONZE DUDLEY",
            "tools": [
                "PoisonIvy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ad154227-6fcf-43c5-a540-0c09534e040f",
            "created_at": "2024-05-01T02:03:07.952927Z",
            "updated_at": "2025-03-27T02:05:17.267077Z",
            "deleted_at": null,
            "main_name": "BRONZE GENEVA",
            "aliases": [
                "BRONZE STERLING ",
                "CTG-5326 ",
                "Naikon ",
                "Override Panda ",
                "APT30 "
            ],
            "source_name": "Secureworks:BRONZE GENEVA",
            "tools": [
                " ShadowPad",
                "Lecna"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2912fc0-c34e-4e4b-82e9-665416c8fe32",
            "created_at": "2023-04-20T02:01:50.979595Z",
            "updated_at": "2025-03-27T02:00:02.79494Z",
            "deleted_at": null,
            "main_name": "Naikon",
            "aliases": [
                "BRONZE GENEVA",
                "G0019",
                "Naikon",
                "BRONZE STERLING",
                "G0013",
                "PLA Unit 78020",
                "OVERRIDE PANDA",
                "Camerashy"
            ],
            "source_name": "MISPGALAXY:Naikon",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9f1ce7e3-77cd-4af0-bedb-1643f55c9baf",
            "created_at": "2022-10-25T15:50:23.31611Z",
            "updated_at": "2025-03-27T02:00:55.439974Z",
            "deleted_at": null,
            "main_name": "Naikon",
            "aliases": [
                "Naikon"
            ],
            "source_name": "MITRE:Naikon",
            "tools": [
                "ftp",
                "netsh",
                "WinMM",
                "Systeminfo",
                "RainyDay",
                "RARSTONE",
                "HDoor",
                "Sys10",
                "SslMM",
                "PsExec",
                "Tasklist",
                "Aria-body"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "6e79c98d-c678-4f28-b869-5723a78e71f4",
            "created_at": "2023-01-06T13:46:39.422441Z",
            "updated_at": "2025-03-27T02:00:03.08607Z",
            "deleted_at": null,
            "main_name": "Vicious Panda",
            "aliases": [
                "SixLittleMonkeys"
            ],
            "source_name": "MISPGALAXY:Vicious Panda",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b69484be-98d1-49e6-aed1-a28dbf65176a",
            "created_at": "2022-10-25T16:07:23.886782Z",
            "updated_at": "2025-03-27T02:02:10.014032Z",
            "deleted_at": null,
            "main_name": "Naikon",
            "aliases": [
                "Hellsing",
                "ITG06",
                "Lotus Panda",
                "Naikon",
                "Operation CameraShy"
            ],
            "source_name": "ETDA:Naikon",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "AR",
                "ARL",
                "Agent.dhwf",
                "Aria-body",
                "Aria-body loader",
                "Asset Reconnaissance Lighthouse",
                "BackBend",
                "Creamsicle",
                "Custom HDoor",
                "Destroy RAT",
                "DestroyRAT",
                "Flashflood",
                "FoundCore",
                "Gemcutter",
                "HDoor",
                "JadeRAT",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "LadonGo",
                "Lecna",
                "Living off the Land",
                "NBTscan",
                "Naikon",
                "NetEagle",
                "Neteagle_Scout",
                "NewCore RAT",
                "Orangeade",
                "PlugX",
                "Quarks PwDump",
                "RARSTONE",
                "RainyDay",
                "RedDelta",
                "RoyalRoad",
                "Sacto",
                "Sandboxie",
                "ScoutEagle",
                "Shipshape",
                "Sisfader",
                "Sisfader RAT",
                "Sogu",
                "SslMM",
                "Sys10",
                "TIGERPLUG",
                "TVT",
                "TeamViewer",
                "Thoper",
                "WinMM",
                "Xamtrav",
                "XsFunction",
                "ZRLnk",
                "nbtscan",
                "nokian",
                "norton",
                "xsControl",
                "xsPlus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536137,
    "ts_updated_at": 1743041844,
    "ts_creation_date": 1653760149,
    "ts_modification_date": 1653760149,
    "files": {
        "pdf": "https://archive.orkl.eu/8aa98c37fc538d7b3db73a4f377913beb453ddee.pdf",
        "text": "https://archive.orkl.eu/8aa98c37fc538d7b3db73a4f377913beb453ddee.txt",
        "img": "https://archive.orkl.eu/8aa98c37fc538d7b3db73a4f377913beb453ddee.jpg"
    }
}