{
    "id": "2052a51b-e652-4b84-a4ab-0c52f9968ca0",
    "created_at": "2023-01-12T15:02:15.423236Z",
    "updated_at": "2025-03-27T02:06:09.226682Z",
    "deleted_at": null,
    "sha1_hash": "9e41b9027fce3b8e1a7d76f02a467aa521bbfd24",
    "title": "2022-02-14 - NFT Lure Used to Distribute BitRAT",
    "authors": "",
    "file_creation_date": "2022-11-28T19:08:23Z",
    "file_modification_date": "2022-11-28T19:08:23Z",
    "file_size": 2130413,
    "plain_text": "# NFT Lure Used to Distribute BitRAT\n\n**fortinet.com/blog/threat-research/nft-lure-used-to-distribute-bitrat**\n\nFebruary 14, 2022\n\nDespite being around for many years, blockchain captured the zeitgeist of the digital movement with the\nadvent of Bitcoin. Digital currencies, however, are not the only application of this technology. Non-fungible\ntokens (NFT) entered the popular lexicon in 2021. An NFT is a digital token that uses blockchain to verify\nthe authenticity of digital content and ownership, such as art, music, collectibles, and in-video-game items.\n\nThe first major NFT splash came in March 2021, when the digital work of art “Everydays – The First 5000\nDays” created by the digital artist “Beeple” was auctioned and sold for a record-breaking $69 million. Later\nthat month, the NFT of the very first tweet posted by then-Twitter CEO Jack Dorsey was sold for $2.9\nmillion. NFTs even gave new life to a popular 10-year-old internet meme, “Nyan Cat.” The original creator\nremastered the GIF and sold it as an NFT for 10 Ethereum ($590,000).\n\nExclusive possession of unique assets tends to drive the desire for ownership—and the price—sky-high.\nAnd predictably, online criminals are there trying to exploit this activity.\n\nFortiGuard Labs recently came across a peculiar-looking Excel spreadsheet that seemingly included NFTrelated information. But instead, it downloads and installs the BitRAT malware in the background. This blog\ndescribes how this attack works\n\n\n-----\n\n**Affected Platforms: Windows**\n**Impacted Users: Windows users**\n\n**Impact: Compromised machines are under the control of the threat actor**\n\n**Severity Level: Medium**\n\n## Strange looking Excel macro file (XLSM) and target\n\nThe original source of the malicious Excel file has not been identified. However, the file provides some\nclues as to its origin and target. First, the XLSM is named “NFT_Items.xlsm”. Second, the file has two\nworkbooks, one of which is in Hebrew. That workbook contains what appears to be legitimate Discord\nrooms that deal with NFTs. It also includes the names of NFTs, forecasts for potential investment returns\n(hyped, solid, and 50/50), and selling quantities. Finally, like many similar recent attacks, this attack abuses\nDiscord by using it to host malicious files. These points provide enough evidence to conclude that the\nattacker likely sent a message to NFT enthusiasts in Israel to entice them to download and open the\nmalicious XLSM.\n\nFigure 1. Malicious XLSM file, “NFT_Item.xlsm”\n\nThe XLSM contains a malicious macro, which the user is asked to enable upon opening the file. Once the\nXLSM file is opened, and the macro is enabled, the XLSM drops a batch file. It then uses a PowerShell\nscript to download another file from Discord, NFTEXE.exe.\n\nFigure 2. Malicious macro in NFT_Item.xlsx\n\nFigure 3. Windows batch file dropped by the malicious macro in NFT_Item.xlsx\n\nFigure 4. Decoded PowerShell script delivered by the batch file in Figure 3\n\nThe downloaded NFTEXE.exe is a .NET executable file that attempts to run \"ipconfig /renew\" and then pull\ndown yet another file, NFTEXE.png, from Discord. Disguised as an image file, NFTEXE.png is pure data\nwith all its strings flipped (see Figure 5.).\n\nFigure 5. Reversed strings in NFTEXE.png\n\nRunning \"ipconfig/renew\" is an attempt to disrupt analysis of the malware should it find itself running in a\ncloud environment by dropping the connection to the analyst so that the NFTEXE.png will not be\ndownloaded.\n\nNFTEXE.exe then reverses these strings into the next stage file, “Nnkngxzwxiuztittiqgz.dll”. A .NET DLL\nappears to have been compiled on January 2nd, 2022. Since the malicious XLSM was made available on a\npublic online scan service on January 3, the XLSM file was distributed soon after compilation.rd\n\n\nNFTEXE.exe copies itself as C:\\Users\\[username]\\AppData\\Roaming\\Microsoft\\Windows\\Start\nMenu\\Programs\\Adobe\\Cloud.exe, which runs at every startup to maintain persistence. NFTEXE.exe also\nmakes a copy of MSBuild.exe, a legitimate Windows file, to C:\\Users\\[username]\\AppData\\Local and runs\nit. NFTEXE.exe then injects a malicious payload into the running MSBuild.exe using\nNnkngxzwxiuztittiqgz.dll.\n\n## BitRAT\n\n\n-----\n\nOur analysis determined that the payload is BitRAT, a Remote Access Trojan (RAT) that was first sold in a\nhacking forum in August 2020.\n\nOne trait of the BitRAT sample that FortiGuard Labs analyzed is its usage of Hidden VNC (HVNC). HVNC\nprovides an attacker with remote access to the compromised machine. BitRAT is known to have borrowed\nthe HVNC code from another malware, TinyNuke, the source code of which was leaked in 2017. Another\nnotable thing included in the BitRAT sample is a string, “AVE_MARIA”, used as a traffic header value when\nan HVNC client communicates to its C2 server for verification. The HVNC communication is designed to\nfail if the traffic header value is not “AVE_MARIA”.\n\nMore BitRAT functionality was revealed during our analysis once additional strings were decrypted. For\nexample, we were able to see that BitRAT can bypass User Account Control (UAC)—a Windows security\nfeature first introduced in Windows Vista that helps prevent unauthorized changes to the operating system\n—and Windows Defender— an anti-malware component of Microsoft Windows first released with Windows\nXP. We also found that this variant can also monitor the screen and, if present, utilize the webcam.\n\nFigure 6. More BitRAT capabilities\n\nAfter the strings were decrypted, it also became apparent that BitRAT uses Slowloris for its DDoS\ncapabilities.\n\nFigure 7. Slowloris DDOS\n\nOther BitRAT functionality includes:\n\nStealing credentials from browsers and applications installed on the compromised machine\nMining Monero cryptocurrency\nLogging keystrokes\nUploading and downloading additional files to the compromised machine\nListening live through a microphone\n\nIn an attempt to hide stolen information, this variant of BitRAT stores collected data (keystrokes, clipboard\ndata, etc.) in an alternate data stream (ADS) file that is majority encoded in Base64.\n\nFigure 8. BitRAT writing to ADS file C:\\Users\\REM\\AppData\\Local:11-01-22\n\nAs can be inferred by the file name above, a new file will be created each day and given the name of the\ncurrent date.\n\nFigure 9. Contents of the ADS log file.\n\nThe C2 server (205[.]185[.]118[.]52) this particular BitRAT variant connects to belongs to FranTech\nSolutions, a hosting provider that is known as a bulletproof hosting service provider. A bulletproof hosting\nservice is just like a regular web hosting service in that they are used to store content. The difference is\nthat a bulletproof hosting service also hosts illegal content, such as malware, C2, exploit kits, and fake\nshopping sites. They also tend to be more resistant to complaints and takedown requests.\n\n## Conclusion\n\nIn this attack, NFT was used to lure a victim into opening a malicious XLSM file to deliver BitRAT, which put\nthe victim’s data and machine at risk.\n\n\n-----\n\nNFT is a new internet phenomenon that some view as a legitimate investment and money-making\nopportunity. Any investment comes with risk, but certain risks taken before money changes hands are\navoidable. Be mindful that attackers often use attractive and trendy subjects as lures. As NFTs become\nincreasingly popular, they will be used to entice victims into opening malicious files or clicking on malicious\nlinks. Standard security practices such as not opening files downloaded from untrusted or suspicious\nsources can prevent threat actors from gaining access to users’ money and valuable data.\n\n## Fortinet Protections\n\nThe FortiGuard Antivirus Service detects and blocks this threat as MSIL/Agent.JWX!tr.dldr and\nVBA/Agent.XC!tr.\n\nFortiEDR detects the downloaded NFTEXE.exe as malicious based on its behavior.\n\nAll network IOCs are blocked by the WebFiltering client.\n\n## IOCs\n\nSample SHA-256:\n\n88ef347ad571f74cf1a450d5dad85a097bb29ab9b416357501cdc4c00388f796\n342a5102bc7eedb62d5192f7142ccc7413dc825a3703e818cf32094638ebd17a\n\nNetwork IOCs:\n\nhxxps://cdn[.]discordapp.com/attachments/923977279179202600/927289948825079828/NFT_LIST.xlsm\nhxxps://cdn[.]discordapp.com/attachments/927290851930013766/927291495604699167/NFT_LIST.xlsm\nhxxps://cdn[.]discordapp.com/attachments/923858595353874472/928279600659234826/NFTEXE.EXE\n205[.]185[.]118[.]52\n\n_Learn more about Fortinet’s_ _[FortiGuard Labs threat research and intelligence organization and the](https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguard-labs)_\n_[FortiGuard Security Subscriptions and Services portfolio.](https://www.fortinet.com/fortiguard/labs?tab=security-bundles&utm_source=blog&utm_campaign=security-bundles)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-14 - NFT Lure Used to Distribute BitRAT.pdf"
    ],
    "report_names": [
        "2022-02-14 - NFT Lure Used to Distribute BitRAT.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535735,
    "ts_updated_at": 1743041169,
    "ts_creation_date": 1669662503,
    "ts_modification_date": 1669662503,
    "files": {
        "pdf": "https://archive.orkl.eu/9e41b9027fce3b8e1a7d76f02a467aa521bbfd24.pdf",
        "text": "https://archive.orkl.eu/9e41b9027fce3b8e1a7d76f02a467aa521bbfd24.txt",
        "img": "https://archive.orkl.eu/9e41b9027fce3b8e1a7d76f02a467aa521bbfd24.jpg"
    }
}