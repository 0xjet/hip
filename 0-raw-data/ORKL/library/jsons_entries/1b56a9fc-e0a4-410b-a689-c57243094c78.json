{
    "id": "1b56a9fc-e0a4-410b-a689-c57243094c78",
    "created_at": "2023-01-12T15:06:36.126911Z",
    "updated_at": "2025-03-27T02:16:59.261134Z",
    "deleted_at": null,
    "sha1_hash": "71c0d578e23d017ef5cfb4739e92185a2c9f12d7",
    "title": "2020-12-24 - Dark Side Of BlackNET RAT",
    "authors": "",
    "file_creation_date": "2022-05-28T04:59:02Z",
    "file_modification_date": "2022-05-28T04:59:02Z",
    "file_size": 1018622,
    "plain_text": "# Dark Side Of BlackNET RAT\n\n**labs.k7computing.com/**\n\nBy K7 Labs December 24, 2020\n\nThe global impact of the COVID-19 pandemic on people’s lives has been significant, be it\non health, livelihood or work life. This has proven advantageous for the threat actors who\nhave begun to look for vulnerabilities, especially, in remote access services, thereby\nexploiting the Work From Home situation of the general public. The pandemic has also\ncreated enormous opportunities for n00b malware authors, especially with the Malware-asa-Service (MaaS) business model taking shape in the cybercrime world.\n\nNowadays, social media applications are being used for interacting within the cybersec\ncommunity and keeping oneself updated. Some of the most prevalent social media apps\nare Telegram and Discord. In this pandemic time, we found lots of channels being created\nin Telegram and Discord that share malware and hacking tools which pose a threat to the\nusers. We, the Threat Intelligence Team at K7 Labs have been monitoring hacker forums\nand these kinds of social media applications for possible threats. While monitoring, we\nnoticed a builder version of BlackNET tool being shared in the channel (as shown in Figure\n1) and on the same day we also noticed a compiled version of BlackNET RAT in the wild.\nBlackNET caught our attention because it was advertised as a RAT with strong lateral\nmovement capabilities.\n\n\n-----\n\n_Figure 1: Telegram Channel_\n\nThis BlackNET RAT is not new; there are already a few blogs on the same which have\n[been posted publicly like “c0d3inj3cT”, “Malwarebytes”, however, this tool is still being](http://www.pwncode.io/2019/12/blacknet-rat-when-you-leave-panel.html)\n[updated and the latest version is BlackNet v3.7 which is freely available on GitHub and the](https://github.com/FarisCode511/BlackNET)\ndeveloper calls himself “BlackHacker511”.\n\nThis is part 1 of our blog on BlackNET RAT that discusses how the compiled malicious\nexecutable from this tool propagates via USB, Dropbox including its Anti-Analyzing, AntiVM, keylogging and Remote Desktop functionalities. Other interesting techniques used by\nthis malware will be discussed in detail in our upcoming blog posts.\n\nBlackNET RAT is a Remote Access Trojan that adds devices to the BlackNET botnet. It is\na free, advanced and modern Windows botnet with a secure PHP panel built using\nVB.NET. This botnet controller comes with a lot of features such as:\n\nKeylogger\nPassword Stealer\nStealing Browser History and Cookies\nExecuting Shell Command\nUninstalling Client\nUSB spread and Dropbox spread\nBitcoin wallets\n\n\n-----\n\nImportant point to be noted is that the developers of this tool update the RAT quite\nfrequently with newer functionalities.\n\nThis tool’s compiled executable output mimics the file version of legitimate svchost.exe so\nas to operate covertly. This malevolent executable is also equipped with Anti-debugging\nand Anti-VM features that complicates the reversing process.\n\nThis malware uses multiple techniques such as Anti-detection, DDOS attack, Keylogger,\nRemote Desktop, Watchdog, USB spread, Dropbox spread and also persistence\ntechniques as shown in Figure 2.\n\n_Figure 2: Malicious functions named after_\n\n_techniques used_\n**Anti-Analyzing**\n\nThis malware carries a predefined list of tool names which are typically used by a malware\nresearcher to monitor a malware’s behaviour (as shown in Figure 3). The malware checks\nwhether any of the tools from the predefined list is running in the victim’s system by\nfetching the active process names using GETPROCESSESBYNAME method and kills the\nprocess which are matching in the list. The malware also looks for the main window name\nof the open windows in the system by using PROCESS.MAINWINDOWTITLE method and\ncompares it with the predefined list of malware analysing tools names as shown in Figure\n3.\n\n\n-----\n\n_Figure 3:_\n\n_Predefined list of malware analysis tool names_\n**Anti-VM Technique**\n\nThis malware verifies if it is running within a controlled virtual environment by checking for\nspecific dll names like “vmguestlib.dll” for VmWare, “vboxmrxnp.dll” for Virtual Box and\nby using LoadLibrary API it loads “sbiedll.dll” to check whether the dll is available inside\nthe system to detect Sandboxie VMs (as shown in Figure 4). Once a virtual environment is\ndetected, the malware uses cmd.exe to self delete and exit the environment.\n\n\n-----\n\n_Figure 4: Anti-VM Technique_\n**Keylogger**\n\nThe BlackNET RAT developer uses LimeLogger code for logging the key strokes. Since\nthese developers are genuine, they have mentioned the use of LimeLogger code in their\nbuilder file, and have given credits to the creator on their GitHub page as shown in Figure\n5.\n\n_Figure 5:_\n\n_[github/FarisCode511/BlackNET](https://github.com/FarisCode511)_\nUsing HookCallback function and KeyboardLayout function they collect all the keystrokes\nand store them in a text file under temp folder as shown in Figure 6 and it also stores sent\ninformation from malware and receives information from C&C server in the same log file.\n\n\n-----\n\n_Figure 6: LimeLogger Code_\nIn the HookCallback function, the threat actor have used the GetKeyState API to capture\nthe keystrokes and call the KeyboardLayout function. Here MapVirtualKey API is used to\ntranslate the captured virtual key into scan code and ToUnicodeEx API is used to convert\nscan code to character and stores it in a buffer. Then it returns the key character and\nwrites it in the log file as shown in Figure 7 and Figure 8.\n\n_Figure 7: Keylogger function_\n\n_Figure 8: KeyboardLayout function_\n**Remote Desktop**\n\n\n-----\n\nThe main feature for this malware is to capture screenshots of the victim s system screen\nand send it to the current host domain “hxxp[:]//redbulllogistics[.]online/blackie“ which\nhas been pre-defined in its Form1 function as shown in Figure 9.\n\n_Figure 9:_\n\n_Domain name used by attacker_\nThe domain “hxxp[:]//redbulllogistics[.]online/blackie” was registered on June 18, 2020 and\nupdated on Dec 5, 2020 which was the day this client malware file was detected in the\nwild.\n\nThe remote desktop function takes screenshots using Graphics.CopyFromScreen\nfunction. Then it saves the file as company.png in the temp folder and uploads the files to\n**“hxxp[:]//redbulllogistics[.]online/blackie/upload.php?id=” using socket.uploadfile**\nfunction as shown in Figure 10.\n\n_Figure 10: Function to take screenshot and send it to the attacker_\n\n\n-----\n\nThe attacker uses mutex in this malware to check whether the file is already running in the\nsystem, mutex value used by this malware is “BN[GRLdNjTe-8793677]”.\n\n**Dropbox Spread**\n\nThe latest feature of BlackNET malware is Dropbox spread, a cloud storage provider. Here\nthe attacker penetrates into the userprofile and creates a folder name as dropbox under\nthe victim’s user profile. Then it drops the malware and changes the malware file’s name to\n**“Adobe Photoshop CS.exe” as shown in Figure 11.**\n\n_Figure 11: Dropbox spread_\n**USB Spread**\n\nThis is the most important feature available on this BlackNET RAT where it also shows\nworm behaviour. Initially, when the malware is installed, it also checks whether the USB\nDrive is mounted or not. With that information, the attacker sends instruction via the C&C\nserver to spread through removable drives. In Figure 12, we can see that if an external\ndrive is available, it checks for availability of free space and whether it is a removable drive\nor CD-ROM. Then it copies the malware to the removable drive with a link file for the\nmalware with a default text icon and re-names it as “Windows_update.exe” with a hidden\nattribute.\n\n\n-----\n\n_Figure 12: Copying the malware to the removable Drive_\nTo create lnk file in a removable drive it calls lnk function as shown in Figure 13. The\nmalware first deletes the old file with lnk extensions and using wscript.shell creates a new\nlnk file and using cmd.exe it executes inside the drive to infect another system which uses\nthis removable drive. Through this method it propagates to different systems.\n\n_Figure 13: Creating lnk File on Removable Drive_\nIn the upcoming blog we will be discussing how the attacker sends instructions to the\nbotnet along with how the client file is updated with newer functionalities and the\nmalware’s persistence techniques to stay stealthy. Next blog post also throws light on\nother malicious behaviour of the BlackNET RAT like disabling windows defender,\npassword stealing, stealing browser cookies and XMR Mining.\n\n**Indicators Of Compromise (IOCs):**\n\n**MD5** **File name** **K7 Detection**\n**Name**\n\nd826c6d5d9deef005d705b99cac11016 invoice.exe Trojan\n(004b9b591)\n\n\n-----\n\n0e8b2a12d51fe0257ccf231606eda3dd svchost.exe Trojan (\n005722cc1 )\n\naf54eda77ed2ea3b3ab8b8ed6d2883bf svchost.exe Trojan (\n0052d5341 )\n\n5abc07a97fa739ba257b4f90bc1464c3 Antidetect7.exe Trojan (\n005721421 )\n\nE426C21445DAE36D36BB5D1CFE9D383B Blacknet Builder Trojan (\n0001140e1 )\n\n35DCBC7EB742DD4F1EDFBCCF7826C724 Stub.exe Trojan\n(004c54d71)\n\nD13D370C3858C9811E70F95D554D2C6 Watcher.exe Riskware\n(0040eff71)\n\n15AC279DFAB997846C0BB9441861F0FA Passwordstealer.dll Spyware\n(004bf6371)\n\n## to Part 2…\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-24 - Dark Side Of BlackNET RAT.pdf"
    ],
    "report_names": [
        "2020-12-24 - Dark Side Of BlackNET RAT.pdf"
    ],
    "threat_actors": [
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535996,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653713942,
    "ts_modification_date": 1653713942,
    "files": {
        "pdf": "https://archive.orkl.eu/71c0d578e23d017ef5cfb4739e92185a2c9f12d7.pdf",
        "text": "https://archive.orkl.eu/71c0d578e23d017ef5cfb4739e92185a2c9f12d7.txt",
        "img": "https://archive.orkl.eu/71c0d578e23d017ef5cfb4739e92185a2c9f12d7.jpg"
    }
}