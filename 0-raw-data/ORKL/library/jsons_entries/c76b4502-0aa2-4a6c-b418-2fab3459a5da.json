{
    "id": "c76b4502-0aa2-4a6c-b418-2fab3459a5da",
    "created_at": "2023-01-12T15:03:04.181046Z",
    "updated_at": "2025-03-27T02:05:33.463203Z",
    "deleted_at": null,
    "sha1_hash": "0fb9c95bf85d0677d57adbf4d33013e92d5208d5",
    "title": "2018-03-28 - Quick summary about the Port 8291 scan",
    "authors": "",
    "file_creation_date": "2022-05-28T02:23:33Z",
    "file_modification_date": "2022-05-28T02:23:33Z",
    "file_size": 245811,
    "plain_text": "# Quick summary about the Port 8291 scan\n\n**blog.netlab.360.com/quick-summary-port-8291-scan-en/**\n\nRootKiter March 28, 2018\n\n28 March 2018 / [Hajime](https://blog.netlab.360.com/tag/hajime/)\n\n## Summary\n\nThis 8291 scan event is caused by a Hajime botnet variant. Compared to the old Hajime, this\none adds two new features:\n\n1. Check port 8291 to determine if the target is a MikroTik device\n2. Use ‘Chimay Red’ Stack Clash Remote Code Execution Loophole vulnerabilities to\n\ninfect and spread.\n\n[For more details about the Hajime, please check our previous blog here](https://blog.netlab.360.com/hajime-status-report-en/)\n\n## The sharp scan increase\n\n[At around 0:00 on March 25, Beijing time, our Scanmon system suggested a large number of](https://scan.netlab.360.com/#/dashboard?tsbeg=1521648000000&tsend=1522252800000&dstport=8291&toplistname=srcip&topn=10&sortby=sum)\nscan activity is happening on port 8291 on a global scale.\n\nAround 2 pm, our honeypot data indicated this sudden spike was related to Hajime. Our\npreliminary conclusion based on its UPX_MAGIC_LE32 and some sample features\nconfirmed that the sample is Hajime based. And we found the ‘Chimay Red’ Stack Clash\nRemote Code Execution” vulnerability related attack code in their atk module.\n\n[https://www.exploit-db.com/exploits/44283/](https://www.exploit-db.com/exploits/44283/)\n\n\n-----\n\n## Infection process\n\nThis Hajime variant adds a support of using “‘Chimay Red’ Stack Clash Remote Code\n“Execution” to perform worm-like spreading, and its propagation process is roughly divided\ninto two steps:\n\n1. Find a MikroTik device by checking if the target port is open on port 8291, if this port is\n\nopen,the other common web ports (80,81,82,8080,8081,8082,8089,8181,8880) will be\nprobed next.\n2. Check the version number of the device and send the Exploit which carried the\n\nShellcode. Once the vulnerability is successfully exploited, Hajime will be downloaded\nand executed.\n\n## Number of unique ips\n\nFrom 2018-03-25 00:00 to 2018-03-27 12:36(GMT+8), We logged a total of 861,131 unique\nscan source IPs (72 Hours).(Please bear in mind that device may change ip due to device\nreboot etc and it does not necessary mean all these devices are MikroTik devices as all the\nHajime bots will perform this task as long as they have the most recent version of Hajime\ncode running. Also naturally there will be some noises such as researcher ips in it)\n\n## Scan Source Distribution\n\n\n-----\n\nFrom the above figure, it is not difficult to find the top three sources of the scan source are:\nBrazil (585k), Iran (51.8k), Russia (26.4k).\n\n## Mitigation\n\n1. block unnecessary 8291 port request\n2. Update to the latest version from MikroTik.\n\nWe will continue to monitor this activity, if readers have new discoveries, feel free to contact\n[us on our twitter.](https://twitter.com/360Netlab)\n\n## IOC\n\n06B4D50254C6C112437A3ED893EF40B4 .i.mipseb\n\n93A1A080FCDE07E512E7485C92861B69 atk.mipseb\n\nfc834c015b357c687477cb9116531de7 atk.mipseb.upx.unpack\n\n## Refer\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-03-28 - Quick summary about the Port 8291 scan.pdf"
    ],
    "report_names": [
        "2018-03-28 - Quick summary about the Port 8291 scan.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535784,
    "ts_updated_at": 1743041133,
    "ts_creation_date": 1653704613,
    "ts_modification_date": 1653704613,
    "files": {
        "pdf": "https://archive.orkl.eu/0fb9c95bf85d0677d57adbf4d33013e92d5208d5.pdf",
        "text": "https://archive.orkl.eu/0fb9c95bf85d0677d57adbf4d33013e92d5208d5.txt",
        "img": "https://archive.orkl.eu/0fb9c95bf85d0677d57adbf4d33013e92d5208d5.jpg"
    }
}