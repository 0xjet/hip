{
    "id": "5221d3d3-5a1a-4a9d-9706-e029c4ecd335",
    "created_at": "2023-01-12T15:07:24.801015Z",
    "updated_at": "2025-03-27T02:15:35.752116Z",
    "deleted_at": null,
    "sha1_hash": "60c5c1324abb7a0057fb05322fae83d783810ac2",
    "title": "Elastic Security - Sandboxing Antimalware Products",
    "authors": "",
    "file_creation_date": "2022-02-07T12:35:36Z",
    "file_modification_date": "2022-02-07T12:35:36Z",
    "file_size": 152894,
    "plain_text": "#### elastic.github.io /security-research/whitepapers/2022/02/02.sandboxing-antimalware-products-for-fun-and-profit/article/\n\n# Sandboxing Antimalware Products for Fun and Profit - Elastic Security Research\n\nGabriel Landau · @gabriellandau 2022-02-02 ⋮\n\n[Windows Internals Protected Processes Security Vulnerability](https://elastic.github.io/security-research/tags/#windows-internals)\n\nThis article demonstrates a flaw that allows attackers to bypass a Windows security mechanism which\nprotects anti-malware products from various forms of attack. This is of particular interest because we\nbuild and maintain two anti-malware products that benefit from this protection.\n\n## Protected Anti-Malware Services¶\n\n[Windows 8.1 introduced a concept of Protected Antimalware Services. This enables specially-signed](https://docs.microsoft.com/en-us/windows/win32/services/protecting-anti-malware-services-)\nprograms to run such that they are immune from tampering and termination, even by administrative\n[users. Microsoft’s documentation (archived) describes this as:](https://web.archive.org/web/20211019010629/https://docs.microsoft.com/en-us/windows/win32/services/protecting-anti-malware-services-)\n\nIn Windows 8.1, a new concept of protected service has been introduced to allow antimalware user-mode services to be launched as a protected service. After the service is\nlaunched as protected, Windows uses code integrity to only allow trusted code to load into\nthe protected service. Windows also protects these processes from code injection and other\nattacks from admin processes.\n\nThe goal is to prevent malware from instantly disabling your antivirus and then running amok. For the rest\n[of this article, we call them Protected Process Light (PPL). For more depth, Alex Ionescu goes into great](https://twitter.com/aionescu)\n[detail on protected processes in his talk at NoSuchCon 2014.](https://www.youtube.com/watch?v=35L_qJNMu1A)\n\nTo be able to run as a PPL, an anti-malware vendor must apply to Microsoft, prove their identity, sign\n[binding legal documents, implement an Early Launch Anti-Malware](https://docs.microsoft.com/en-us/windows/win32/w8cookbook/secured-boot) (ELAM) driver, run it through a test\nsuite, and submit it to Microsoft for a special Authenticode signature. It is not a trivial process. Once this\nprocess is complete, the vendor can use this [ELAM driver to have Windows protect their anti-malware](https://docs.microsoft.com/en-us/windows/win32/api/sysinfoapi/nf-sysinfoapi-installelamcertificateinfo)\nservice by running it as a PPL.\n\nYou can see PPL in action yourself by running the following from an elevated administrative command\nprompt on a default Windows 10 install:\n\nProtected Process Light in Action\n\n```\nC:\\WINDOWS\\system32>whoami\nnt authority\\system\nC:\\WINDOWS\\system32>whoami /priv | findstr \"Debug\"\nSeDebugPrivilege        Debug programs          Enabled\n\n```\n\n-----\n\n```\nC:\\WINDOWS\\system32>taskkill /f /im MsMpEng.exe\nERROR: The process \"MsMpEng.exe\" with PID 2236 could not be terminated.\nReason: Access is denied.\n\n```\n\nAs you can see here, even a user running as SYSTEM (or an elevated administrator) with\n`SeDebugPrivilege cannot terminate the` PPL Windows Defender anti-malware Service\n\n(MsMpEng.exe). This is because non-PPL processes like taskkill.exe cannot obtain handles with\n\nthe PROCESS_TERMINATE access right to [PPL processes using APIs such as OpenProcess.](https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocess)\n\nIn summary, Windows attempts to protect PPL processes from non-PPL processes, even those with\nadministrative rights. This is both documented and implemented. That being said, with\n```\nPROCESS_TERMINATE blocked, let’s see if there are other ways we can interfere with it instead.\n\n## Windows Tokens¶\n\n```\nA Windows token can be thought of as a security credential. It says who you are and what you’re allowed\nto do. Typically when a user runs a process, that process runs with their token and can do anything the\nuser can do. Some of the most important data within a token include:\n\nUser identity\nGroup membership (e.g. Administrators)\nPrivileges (e.g. SeDebugPrivilege)\nIntegrity level\n\nTokens are a critical part of Windows authorization. Any time a Windows thread accesses a securable\nobject, the OS performs a security check. It compares the thread’s effective token against the security\ndescriptor of the object being accessed. You can read more about tokens in the Microsoft access token\n[documentation and the Elastic blog post that introduces Windows tokens.](https://www.elastic.co/blog/introduction-to-windows-tokens-for-security-practitioners)\n\n### Sandboxing Tokens¶\n\nSome applications, such as web browsers, have been repeated targets of exploitation. Once an attacker\nsuccessfully exploits a browser process, the exploit payload can perform any action that the browser\nprocess can perform. This is because it shares the browser’s token.\n\nTo mitigate the damage from such attacks, web browsers have moved much of their code into lowerprivilege worker processes. This is typically done by creating a restricted security context called a\nsandbox. When a sandboxed worker needs to perform a privileged action on the system, such as saving\na downloaded file, it can ask a non-sandboxed “broker” process to perform the action on its behalf. If the\nsandboxed process is exploited, the goal is to limit the payload’s ability to cause harm to only resources\naccessible by the sandbox.\n\nWhile modern sandboxing involves several components of OS security, one of the most important is a\nlow-privilege, or restricted, token. New sandbox tokens can be created with APIs such as\n```\nCreateRestrictedToken. Sometimes a sandboxed process needs to lock itself down after performing\n\n```\n[some initialization. The AdjustTokenPrivileges and AdjustTokenGroups APIs allow this](https://docs.microsoft.com/en-us/windows/win32/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges)\n\n\n-----\n\nadjustment. These APIs enable privileges and groups to be forfeit from an existing process s token in\nsuch a way that they cannot be restored without creating a new token outside the sandbox.\n\n[One commonly used sandbox today is part of Google Chrome. Even some security products are getting](https://chromium.googlesource.com/chromium/src/+/master/docs/design/sandbox.md)\ninto sandboxing these days.\n\n### Accessing Tokens¶\n\n[Windows provides the OpenProcessToken API to enable interaction with process tokens.](https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocesstoken) MSDN states\n\nthat one must have the PROCESS_QUERY_INFORMATION right to use OpenProcessToken. Since a\n\nnon-protected process can only get PROCESS_QUERY_LIMITED_INFORMATION access to a PPL\n\nprocess (note the LIMITED), it is seemingly impossible to get a handle to a PPL process’s token.\n\nHowever, MSDN is incorrect in this case. With only PROCESS_QUERY_LIMITED_INFORMATION, we can\n\n[successfully open the token of a protected process. James Forshaw explains this documentation](https://twitter.com/tiraniddo)\n[discrepancy in more depth, showing the underlying de-compiled kernel code.](https://www.tiraniddo.dev/2017/05/reading-your-way-around-uac-part-2.html)\n\nTokens are themselves securable objects. As such, regular access checks still apply. The effective token\nof the thread attempting to access the token is checked against the security descriptor of the token being\naccessed for the requested access rights (TOKEN_QUERY, TOKEN_WRITE, TOKEN_IMPERSONATE, etc).\n\n[For more detail about access checks, see the Microsoft article, “How Access Checks Work.”](https://docs.microsoft.com/en-us/windows/win32/secauthz/how-dacls-control-access-to-an-object)\n\n## The Attack¶\n\n[Process Hacker provides a nice visualization of token security descriptors. Taking a look at Windows](https://github.com/processhacker/processhacker/releases/tag/v2.39)\nDefender’s (MsMpEng.exe) token, we see the following Discretionary Access Control List (DACL):\n\n\n-----\n\nNote that the SYSTEM user has full control over the token. This means, unless some other mechanism is\n[protecting the token, a thread running as SYSTEM can modify the token. When such modification is](https://powersploit.readthedocs.io/en/latest/Privesc/Get-System/)\npossible, it violates the desired “PPL is protected from administrators” design goal.\n\n### Demo¶\n\nAlas, there is no other mechanism protecting the token. Using this technique, an attacker can forcefully\n[remove all privileges from the MsMpEng.exe token and reduce it from system to untrusted integrity.](https://docs.microsoft.com/en-us/windows/win32/secauthz/mandatory-integrity-control)\n\nBeing nerfed to untrusted integrity prevents the victim process from accessing most securable resources\non the system, quietly incapacitating the process without terminating it.\n\nIn this video, the attacker could have further restricted the token, but the privilege and integrity changes\nwere sufficient to prevent MsMpEng.exe from detecting and blocking a Mimikatz execution. We felt this\n\nillustrated a valid proof of concept.\n\n## Defense¶\n\nNewer versions of Windows include an undocumented feature called “trust labels.” Trust labels are part of\n[the System Access Control List (SACL), an optional component of every security descriptor. Trust labels](https://docs.microsoft.com/en-us/windows/win32/ad/retrieving-an-objectampaposs-sacl)\nallow Windows to restrict specific access rights to certain types of protected processes. For example,\n[Windows protects the \\KnownDlls object directory from modification by malicious administrators using a](https://www.elastic.co/blog/protecting-windows-protected-processes)\n\n[trust label. We can see this with WinObjEx64:](https://github.com/hfiref0x/WinObjEx64)\n\n\n-----\n\nLike \\KnownDlls, tokens are securable objects, and thus it is possible to protect them against\n\nmodification by malicious administrators. Elastic Security does this, in fact, and is immune to this attack,\nby denying TOKEN_WRITE access to processes with a trust label below “Anti-Malware Light.” Because\n\nthis protection is applied at runtime, however, there is still a brief window of vulnerability until it can apply\nthe trust label.\n\nIdeally, Windows would apply such a trust label to each PPL process’s token as it is created. This would\neliminate the race condition and fix the vulnerability in the PPL mechanism. There is precedent. With a\nkernel debugger, we can see that Windows is already protecting the System process’ token on Windows\n(21H1 shown below) with a trust label:\n\nTrust Label on System Process Token\n```\n 1: kd> dx -r1 (((nt!_OBJECT_HEADER*)((@$cursession.Processes[0x4] >KernelObject->Token->Object - sizeof(nt!_OBJECT_HEADER)) & ~0xf)) >SecurityDescriptor & ~0xf)\n (((nt!_OBJECT_HEADER*)((@$cursession.Processes[0x4]->KernelObject->Token >Object - sizeof(nt!_OBJECT_HEADER)) & ~0xf))->SecurityDescriptor & ~0xf)\n : 0xffffe00649c46c20\n 1: kd> !sd 0xffffe00649c46c20\n ->Revision: 0x1\n ->Sbz1  : 0x0\n ->Control : 0x8814\n       SE_DACL_PRESENT\n       SE_SACL_PRESENT\n       SE_SACL_AUTO_INHERITED\n       SE_SELF_RELATIVE\n ->Owner  : S-1-5-32-544\n ->Group  : S-1-5-32-544\n ->Dacl  :\n\n```\n\n-----\n\n```\n >Dacl  : >AclRevision: 0x2\n ->Dacl  : ->Sbz1    : 0x0\n ->Dacl  : ->AclSize  : 0x1c\n ->Dacl  : ->AceCount  : 0x1\n ->Dacl  : ->Sbz2    : 0x0\n ->Dacl  : ->Ace[0]: ->AceType: ACCESS_ALLOWED_ACE_TYPE\n ->Dacl  : ->Ace[0]: ->AceFlags: 0x0\n ->Dacl  : ->Ace[0]: ->AceSize: 0x14\n ->Dacl  : ->Ace[0]: ->Mask : 0x000f01ff\n ->Dacl  : ->Ace[0]: ->SID: S-1-5-18\n ->Sacl  :\n ->Sacl  : ->AclRevision: 0x2\n ->Sacl  : ->Sbz1    : 0x0\n ->Sacl  : ->AclSize  : 0x34\n ->Sacl  : ->AceCount  : 0x2\n ->Sacl  : ->Sbz2    : 0x0\n ->Sacl  : ->Ace[0]: ->AceType: SYSTEM_MANDATORY_LABEL_ACE_TYPE\n ->Sacl  : ->Ace[0]: ->AceFlags: 0x0\n ->Sacl  : ->Ace[0]: ->AceSize: 0x14\n ->Sacl  : ->Ace[0]: ->Mask : 0x00000001\n ->Sacl  : ->Ace[0]: ->SID: S-1-16-16384\n ->Sacl  : ->Ace[1]: ->AceType: SYSTEM_PROCESS_TRUST_LABEL_ACE_TYPE\n ->Sacl  : ->Ace[1]: ->AceFlags: 0x0\n ->Sacl  : ->Ace[1]: ->AceSize: 0x18\n ->Sacl  : ->Ace[1]: ->Mask : 0x00020018\n ->Sacl  : ->Ace[1]: ->SID: S-1-19-1024-8192\n\n```\nThe SYSTEM_PROCESS_TRUST_LABEL_ACE_TYPE access control entry limits access to\n```\nREAD_CONTROL, TOKEN_QUERY, and TOKEN_QUERY_SOURCE (0x00020018) unless the caller is a\nWinTcb protected process (SID S-1-19-1024-8192). That SID can be interpreted as follows:\n\n```\n[1: Revision 1](https://github.com/gabriellandau/ctypes-windows-sdk/blob/0a5bfaa9385391038a7d31928b14d6fe5b76fa97/cwinsdk/um/winnt.py#L1794)\n[19: SECURITY_PROCESS_TRUST_AUTHORITY](https://github.com/gabriellandau/ctypes-windows-sdk/blob/0a5bfaa9385391038a7d31928b14d6fe5b76fa97/cwinsdk/um/winnt.py#L2097)\n\n[1024: SECURITY_PROCESS_PROTECTION_TYPE_FULL_RID](https://github.com/gabriellandau/ctypes-windows-sdk/blob/0a5bfaa9385391038a7d31928b14d6fe5b76fa97/cwinsdk/um/winnt.py#L2100)\n\n[8192: SECURITY_PROCESS_PROTECTION_LEVEL_WINTCB_RID](https://github.com/gabriellandau/ctypes-windows-sdk/blob/0a5bfaa9385391038a7d31928b14d6fe5b76fa97/cwinsdk/um/winnt.py#L2104)\n\n### Mitigation¶\n\n[Alongside this article, we are releasing an update to the PPLGuard proof-of-concept that protects all](https://github.com/elastic/PPLGuard)\nrunning anti-malware PPL processes against this attack. It includes example code that anti-malware\nproducts can employ to protect themselves. Here it is in action, protecting Defender:\n\n## Disclosure¶\n\n\n-----\n\n[We disclosed this vulnerability and proposed fixes to the Microsoft Security Response Center](https://www.microsoft.com/en-us/msrc?rtc=1) (MSRC) on\n2022-01-05. They responded on 2022-01-24 that they have classified it as moderate severity, and will not\naddress it with a security update. However, they may address it in a future version of Windows.\n\n## Conclusion¶\n\nIn this article, we disclosed a flaw in the Windows Protected Process Light (PPL) mechanism. We then\ndemonstrated how malware can use this flaw to neutralize PPL anti-malware products. Finally, we\nshowed a simple ACL fix (with sample code) that anti-malware products can employ to defend against\nthis attack. Elastic Security already incorporates this fix, but we hope that Windows implements it (or\nsomething equivalent) by default in the near future.\n\nLast update: February 2, 2022\n\nCreated: February 2, 2022\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/AV Tech/Elastic Security - Sandboxing Antimalware Products.pdf"
    ],
    "report_names": [
        "Elastic Security - Sandboxing Antimalware Products.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536044,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1644237336,
    "ts_modification_date": 1644237336,
    "files": {
        "pdf": "https://archive.orkl.eu/60c5c1324abb7a0057fb05322fae83d783810ac2.pdf",
        "text": "https://archive.orkl.eu/60c5c1324abb7a0057fb05322fae83d783810ac2.txt",
        "img": "https://archive.orkl.eu/60c5c1324abb7a0057fb05322fae83d783810ac2.jpg"
    }
}