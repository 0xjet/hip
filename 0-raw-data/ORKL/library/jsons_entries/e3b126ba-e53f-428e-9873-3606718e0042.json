{
    "id": "e3b126ba-e53f-428e-9873-3606718e0042",
    "created_at": "2023-01-12T15:01:41.680542Z",
    "updated_at": "2025-03-27T02:05:21.117783Z",
    "deleted_at": null,
    "sha1_hash": "d658019b21d9104d1325332e4b722aa777d7ca08",
    "title": "2021-12-07 - XE Group – Exposed- 8 Years of Hacking & Card Skimming for Profit",
    "authors": "",
    "file_creation_date": "2022-05-28T18:14:21Z",
    "file_modification_date": "2022-05-28T18:14:21Z",
    "file_size": 1041090,
    "plain_text": "# XE Group – Exposed: 8 Years of Hacking & Card Skimming for Profit\n\n**[volexity.com/blog/2021/12/06/xe-group-exposed-8-years-of-hacking-card-skimming-for-profit/](https://www.volexity.com/blog/2021/12/06/xe-group-exposed-8-years-of-hacking-card-skimming-for-profit/)**\n\nDecember 7, 2021\n\nby Volexity Threat Research\n\nIn 2020 and 2021, Volexity identified multiple compromises related to a relatively unknown criminal threat actor that refers to itself as \"XE\nGroup\". Volexity believes that XE Group is likely a Vietnamese-origin criminal threat actor whose intrusions follow an approximate pattern:\n\nCompromise of externally facing services via known exploits (e.g., Telerik UI vulnerabilities)\nMonetization of these compromises through installation of password theft or credit card skimming code for web services related to these\nservers\n\n[There has been previously reported XE Group activity in a blog by Malwarebytes from 2020; this post serves to provide additional insight into](https://blog.malwarebytes.com/threat-analysis/2020/07/credit-card-skimmer-targets-asp-net-sites/)\nXE Group and an update on its current operations.\n\n## Analysis\n\nVolexity first encountered XE Group activity in early 2020 following a web server compromise at a customer site. The breach of the web server\nwas automated, and it was remediated quickly after discovery, with no notable actions taken by the attacker. That one incident was a small blip\non the radar and appeared rather isolated. Recently, however, Volexity detected XE Group activity across several of its customers by way of\nVolexity's Network Security Monitoring service. This time, the activity was coming from client systems rather than web servers. A deeper dive\ninto the activity revealed clients were visiting compromised websites and potentially falling victim to a widespread credit card skimming\noperation.\n\nAfter finding this new XE Group activity, Volexity investigated and quickly found infrastructure used by the attacker. In many cases, it was not\ndifficult to enumerate the attackers' infrastructure using basic pivots such as WHOIS registrants and passive DNS. Much of this infrastructure\nstill tied back to items described in the aforementioned Malwarebytes blog. The attacker uses email addresses relating to “xe[word]” and has\nconsistently used the same custom nameservers (ns1.xegroups[.]com and ns2.xegroups[.]com) with their domains for a number of years.\n\n[An overview of the infrastructure used in the last three years is given in Figure 1 below. A full list can be found on Github here.](https://github.com/volexity/threat-intel/blob/main/2021/2021-12-06%20-%20XEGroup/indicators/indicators.csv)\n\n\n-----\n\n_Figure 1. XE Group infrastructure can be closely linked via passive DNS, WHOIS data, and other patterns_\n\nIn the Figure 1, each red dot is a malware sample. A large number of the samples belong to a group of malware families that the attacker\nrefers to collectively as “XEReverseShell”. Despite the singular name, in practice several of these offer different functionality. The malware\nfamilies are mostly written in .NET and AutoIT, although the attacker sometimes uses loaders for their malware family written in C++.\n\n[Sometimes, the attacker even labels their malware as belonging to XE Group, as shown below:](https://www.virustotal.com/gui/file/42b71d9548a8dfac0e4b3fd3946329972bdc0e156402ca47e6bb1cd58ab9f77c/details)\n\n_Figure 2. Sometimes the malware authors label malware with their brand._\n\nDespite this, the bread and butter of attacks from XE Group is credit card skimming, and the other tools Volexity has identified are only used to\nhelp facilitate this purpose.\n\n## Credit Card Skimming\n\nThe most recent credit card skimming activity identified by Volexity was found based on suspicious redirects to the domain “object[.]fm”, a\ndomain using the xegroups[.]com nameserver. The code used to load the malicious JavaScript from this page reveals that the attacker uses\nan interesting technique: the JavaScript keyword \"object\" is used to populate the domain value:\n\n_Figure 3. Example code added to compromised sites to load malicious JavaScript_\n\nThe effect of this code is to append a script to the loading page where the \"src\" value is as follows:\n\n\n-----\n\ntypeo ({}) /g t js\n\nSince typeof({}) evaluates to \"object\", this becomes:\n\nobject[.]fm/gmt.js\n\nVolexity searched for other websites containing similar scripts to load additional JavaScript and found that the attacker is using the same\nmethod to load scripts from the domain \"object.sbs\".\n\nThe [gmt.js file loaded on infected sites is used for credit card skimming and shares much of the same code as the original skimmer identified](https://www.virustotal.com/gui/file/348e8494d32e6f7e8dcbe1f295ca9efd2af047d92d73eaf0091cd20efe48eb79)\nby Malwarebytes. The effect of the credit card skimmer is that any form data submitted to pages loading the JavaScript in question is also\nexfiltrated to an attacker URL. An example of the type of form data stolen is shown below:\n\n{\"rcgnAdultsCheckBoxon”:””,”firstNameTextBox”:”[name]”:,”lastNameTextBox”:”[surname]”:,”birthdateTextBox”:”[date]”,”genderCodeDropDown\n2222-3333-4444:”,”ddlExpirationMonth”:”[month]”,”ddlExpirationYear:”[year],”txtSecurityCode”:”[code]\"}\n\nThe new version of the credit card skimming code shows slight differences to the 2020 version:\n\nThere is additional use of “.join()” and .”replace()” to rebuild obfuscated strings.\nSince the attacker is using \"object\" for their subdomains, they use another trick to obfuscate the domain name in the script itself:\n\nk = typeof {}\n\nr = location.toString().replace(/^(.*?\\:\\/\\/).*?(\\.).*$/g, '$1' + k+'$2')\n\nHere, \"k\" is a JavaScript Object; \"r\" takes the current location (e.g., the current URL) as a string and replaces the entire location with the\ncontents of \"k\" (i.e., \"object\").\n\nThe URI used to send stolen data to is pseudo randomized using arrays of words and random integers.\nFunctionality to look for passwords has been removed in the cases Volexity has identified.\nAdditional checks are done within the script to make sure the window has finished loading before key functionality is run by the script.\nThis avoids a race condition between scripts on the infected page and the malicious JavaScript.\nIn older versions of the credit card skimmer, exfiltrated data was encoded in plain hex in the URL. In newer versions, colons and tilde\ncharacters are used to denote key value pairs and end of field markers respectively. A script to decode an exfiltration URL is provided on\nGitHub [here.](https://github.com/volexity/threat-intel/blob/main/2021/2021-12-06%20-%20XEGroup/scripts/decode_uri.py)\n\nAdditionally, in some cases the attacker appears to find the results of their standard credit card skimmer are insufficient or hard to parse, so\n[they have included additional code to skim specific fields from compromised sites, an example of which is given below:](https://www.virustotal.com/gui/file/f2642c6179a06c3a98d9e5499ebc14c249e34e61fb88d065b0125ca1ad7290d5/details)\n\n_Figure 4. Additional skimming code included on one compromised page to scrape specific fields_\n\n## Affected Websites\n\nAfter identifying a number of attacker command-and-control (C2) servers, Volexity searched various data sources—including its own telemetry\n—in order to discover websites that are compromised and hosting the credit card skimmer described above. Compromised sites vary a great\ndeal in popularity and nature; examples of compromised sites include the following industries/sectors:\n\nTravel\n\n\n-----\n\nestau a t\nArt & Culture\nNon-profit\n\nThe variety of affected sites suggests no clear strategy on the attacker's part, and therefore suggests it may be a case of attempted bulk\nexploitation and indiscriminate attacks.\n\nIn one case, however, the attacker appears to have been able to compromise a web design company that specializes in designing and\nmaintaining websites for storefronts. This means that each site owned by that company is currently serving a credit card skimmer.\n\n## Who Is XE Group?\n\nVolexity believes XE Group is likely a Vietnamese-origin threat actor; several things led to this conclusion. First, the WHOIS information for\nseveral of the malicious domains is for an individual located in Vietnam:\n\n_Figure 5. Screenshot from DomainTools Iris showing WHOIS information for “xemembers.com”_\n\n[While this information is often faked, there is indeed a user with the name “Joe Nguyen”, username \"xethanh\", with an empty repository](https://github.com/xethanh)\n“xegroupdev” present on GitHub.\n\n_Figure 6. GitHub profile of \"Joe Nguyen\" / \"xethanh\" which are terms seen in WHOIS records for known C2 addresses_\n\nThis is a largely unused GitHub profile using a custom \"XE\" avatar and referencing both \"Joe Nguyen\" (the same name seen in the previously\nmentioned WHOIS records) and \"xegroupdev\".\n\nA user with username “xethanh” previously existed on the now-abandoned forum crdclub[.]su which advertised stolen credit card information:\n\n_Figure 7. Post on crdclub[.]su shows a user with the same handle seen on Github (\"xethanh\") advertising stolen credit card data_\n\n\n-----\n\nUse s t t e sa e a e e st o ot e ca d g o u s as e, suc as cybe ca de s[ ]su a d ca d g o u [ ]co a o a a e t st,\nthere is also a YouTube profile with the handle \"xethanh\" which uses the same name and XE avatar as the Github profile.\n\n_Figure 8. YouTube profile for user \"xethanh\" with the same avatar and username as the previously mentioned Github profile_\n\nCrucially, in the About section of the YouTube profile, there is a link to xegroups[.]com/xethanh. The site xegroups[.]com is a C2 for older\nmalware samples and a nameserver for newer infrastructure used by the group. While the name \"Joe Nguyen\" may be a pseudonym, it seems\nmost likely that the user behind the GitHub and YouTube accounts is the attacker.\n\nIt could be that XE Groups is a compromised organization of some kind, but this seems unlikely since a number of the tools used by the\nattacker over a long period of time has used \"xe[word]\" nomenclature in descriptions, original filenames, and PDB strings. Furthermore, a\nnumber of the malware files discovered in VirusTotal were first observed being uploaded from Vietnamese web users, many of whom only\nhave a single VirusTotal upload. It is likely these were uploaded by the attacker in order to test detection rates of their malware prior to\ndeploying them in real environments.\n\n## Conclusion\n\nXE Group's credit card skimming operation has been ongoing since at least early 2020, using a relatively limited set of infrastructure. The\nattacker primarily focuses on compromising IIS environments and uses their access to deploy credit card skimming JavaScript code on\naffected websites.\n\nThere is a relatively clear trail of evidence to help identify XE Group. The attacker appears to be of Vietnamese origin. They often use the\nbrand “XE Group”, and a number of \"xe[word]\" themed domains have been registered and linked to the group. Volexity has identified a likely\npersona on carding forums associated with this activity, which suggests the attacker monetizes stolen credit card data through sales rather\nthan direct use of stolen cards themselves. The persona used for the GitHub and carding account, and several of the domains, have a history\ngoing back to 2013, which suggests the attacker may have been attempting similar attacks for up to eight years, with only one significant public\n[mention of their activity. The oldest malware sample Volexity was able to identify relating to XE Group dates back to late 2014.](https://www.virustotal.com/gui/file/02c48917b15015ddd02738bc1f480f9c6379165618435855030f4c63ce372485)\n\nTo prevent these specific attacks from being successful, Volexity recommends the following:\n\n[Block related network indicators provided (link).](https://github.com/volexity/threat-intel/blob/main/2021/2021-12-06%20-%20XEGroup/indicators/indicators.csv)\n[Use signatures provided (link) to identify related activity.](https://github.com/volexity/threat-intel/blob/main/2021/2021-12-06%20-%20XEGroup/indicators/yara.yar)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-07 - XE Group – Exposed- 8 Years of Hacking & Card Skimming for Profit.pdf"
    ],
    "report_names": [
        "2021-12-07 - XE Group – Exposed- 8 Years of Hacking & Card Skimming for Profit.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535701,
    "ts_updated_at": 1743041121,
    "ts_creation_date": 1653761661,
    "ts_modification_date": 1653761661,
    "files": {
        "pdf": "https://archive.orkl.eu/d658019b21d9104d1325332e4b722aa777d7ca08.pdf",
        "text": "https://archive.orkl.eu/d658019b21d9104d1325332e4b722aa777d7ca08.txt",
        "img": "https://archive.orkl.eu/d658019b21d9104d1325332e4b722aa777d7ca08.jpg"
    }
}