{
    "id": "e67f82ea-b3df-4300-948d-653df43cf71f",
    "created_at": "2023-01-12T15:10:05.127773Z",
    "updated_at": "2025-03-27T02:16:26.03696Z",
    "deleted_at": null,
    "sha1_hash": "8cead2e537922622bc66d24a9d7a78c4a1e5a3f3",
    "title": "2021-11-11 - TeamTNT Upgrades Arsenal, Refines Focus on Kubernetes and GPU Environments",
    "authors": "",
    "file_creation_date": "2022-05-28T00:42:21Z",
    "file_modification_date": "2022-05-28T00:42:21Z",
    "file_size": 1275527,
    "plain_text": "# TeamTNT Upgrades Arsenal, Refines Focus on Kubernetes and GPU Environments\n\n**[trendmicro.com/en_us/research/21/k/teamtnt-upgrades-arsenal-refines-focus-on-kubernetes-and-gpu-env.html](https://www.trendmicro.com/en_us/research/21/k/teamtnt-upgrades-arsenal-refines-focus-on-kubernetes-and-gpu-env.html)**\n\nNovember 11, 2021\n\nUsing a new batch of campaign samples, we take a look at its more recent cybercrime contributions and compare\nthem with its previous deployments to demonstrate the group’s use of upgraded tools and payloads.\n\nBy: David Fiser, Alfredo Oliveira November 11, 2021 Read time: ( words)\n\n[In previous entries, we described how the hacking group TeamTNT targeted](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/teamtnt-activities-probed) [unsecured Redis instances,](https://www.trendmicro.com/en_us/research/20/d/exposed-redis-instances-abused-for-remote-code-execution-cryptocurrency-mining.html) exposed\n[Docker APIs, and vulnerable Kubernetes clusters in order to deploy cryptocurrency-mining payloads](https://www.trendmicro.com/en_us/research/21/e/teamtnt-targets-kubernetes--nearly-50-000-ips-compromised.html)\n[and credential stealers. TeamTNT was one of the first cybercriminal groups to focus on cloud service providers](https://www.trendmicro.com/en_us/research/21/e/teamtnt-extended-credential-harvester-targets-cloud-services-other-software.html)\n(CSPs), specifically the metadata stored on elastic computing instances being run on cloud services. It is mainly\nengaged in the theft of environmental metadata used by CSPs. Because instance metadata and user data can’t\nbe authenticated or encrypted, it’s important for users to avoid storing sensitive data in metadata fields, including\nsecrets and CSP-related preauthorization data which can then be used in other services such\nas [serverless deployments.](https://www.trendmicro.com/en_us/devops/20/h/securing-weak-points-in-serverless.html)\n\nIf a running instance used by a CSP customer is not properly configured or has a security weakness such as\nexposed APIs or leaked credentials, malicious actors who are able to abuse these security flaws might be able to\nuse other services as well. Therefore, it’s important for organizations to safeguard critical authentication\ncredentials, or secrets, to ensure that they are out of cybercriminals’ reach.\n\nToday, TeamTNT remains to actively exploit compromised cloud environments in its campaigns. Using a new\nbatch of campaign samples, we take a look at its more recent cybercrime contributions and compare them with its\nprevious deployments to demonstrate the group’s use of upgraded tools and payloads.\n\nTeamTNT’s upgraded arsenal\n\nWhat stands out from our analysis is that the samples obtained from TeamTNT’s recent campaigns look more\nprofessionally developed than previous versions. The samples, which cover more corner cases and include bug\nfixes, show marked improvements in how the hacking group targets misconfigured Amazon Web Services (AWS)\nor Kubernetes services.With cybercriminals setting their sights on cloud deployments, it’s important for cloud\nusers to understand the importance of the shared responsibility model. Users play an important role in the overall\nsecurity of their cloud environments. Cloud users are in charge of securing the data, platforms, applications, and\noperating systems that they run within their respective cloud services. Hence, they must also be aware of where\nto place critical data within the cloud environment for it not to be targeted by malicious actors.\n\nRather than incorporating all-in-one samples with multiple functionalities, TeamTNT’s attacks have become more\nmodular. The samples have a defined scope and feature well-defined functions, showing how the group has\nevolved to apply a more targeted approach to its campaigns.\n\n\n-----\n\nFigure 1. TeamTNT’s typical attack chain\n\nFigure 2. An older version of TeamTNT’s AWS credential stealer (left) compared with newer versions (middle and\nright) from instances that they have already compromised\nEarlier this year, we detailed how TeamTNT crafted a hard-coded shell script that targeted credentials\nfrom [vulnerable AWS instances. Aside from AWS, we have also observed how TeamTNT has refined its](https://www.trendmicro.com/en_ph/research/21/c/teamtnt-continues-attack-on-the-cloud--targets-aws-credentials.html)\ndevelopment of tools specifically for one of its primary targets, Kubernetes.\n\nFigure 3 shows TeamTNT samples that target different Kubernetes environments, obtained in August and\nSeptember 2021. These show that TeamTNT has developed multiple payloads for different targeted Kubernetes\nenvironments. Upon closer look, the payloads have minor changes specifically geared toward adapting a bit\nbetter to the infected environment: They are less noisy as they are less generic, and they change command-andcontrol addresses as they get updated.\n\nFigure 3. TeamTNT tools targeting Kubernetes environments using different payloads\nChecking this trend with Shodan data, we see that TeamTNT’s focus on Kubernetes deployments makes sense\nsince the number of open and exposed Docker APIs has been decreasing. In September 2021, the number of\nexposed Docker APIs was 836, down from 7,276 12 months prior. Meanwhile, the number of vulnerable\n\n\n-----\n\nKubernetes APIs has been increasing since June 2021. In September 2021, exposed Kubernetes APIs even\nreached 161,993.\n\nFigure 4. Shodan data showing a significant decrease in exposed Docker APIs from the latter part of 2020 to\n2021\n\nFigure 5. Shodan data showing a significant increase in exposed Kubernetes APIs in 2021\nTeamTNT is also extending its focus on its mining hash rate by enhancing its chances to exploit devices equipped\nwith GPUs by having toolsets designed for multiple GPU manufacturers. This is no surprise as the actual reward\nfor mining monero cryptocurrency is getting lower. Thus, to mine the same amount of moneroj, a bigger\ncontribution (with hashes provided) is needed, which in this case is indicated by the hash rate. Simply put, the\nbigger the hash rate, the higher the amount of money mined.\n\n\n-----\n\nFigure 6. TeamTNT tools that target GPU environments\nConclusion and security recommendations\n\nThis entry highlights our three major observations on TeamTNT’s recent campaigns. The first concerns the\nchanges the group has employed in its arsenal development. Rather than using messy, all-in-one malicious files,\nits new-generation payloads seem to be more professionally developed and targeted, and generates less noise\nduring infection by reducing the number of executions and deploying more accurately.\n\nAnother crucial observation is that TeamTNT is developing more tools targeting Kubernetes. This is backed by inthe-wild Shodan data showing the number of exposed Kubernetes APIs. Because the hacking team has also\nmentioned the launch of a new Kubernetes campaign on its social media account, we highly recommend that\nKubernetes users pay special attention to its deployments. However, despite TeamTNT’s apparent preference for\nexposed Kubernetes APIs, it still targets CSPs.\n\nThe final point is that the payloads now identify GPU-based environments and deploy specific payloads to target\ninstances running in CSPs and take advantage of the computational power and generate more cryptocurrency by\nill means.\n\nWith organizations relying on cloud services now more than ever, attacks targeting cloud services are likely to\nbecome more ubiquitous and sophisticated in the coming years. To keep systems and services protected against\nevolving threats, organizations should create strong security policies that highlight the shared responsibility\nmodel and the [principle of least privilege. It is also a good practice to encrypt metadata or use obfuscated or](https://www.trendmicro.com/vinfo/us/security/news/virtualization-and-cloud/securing-the-4-cs-of-cloud-native-systems-cloud-cluster-container-and-code#:~:text=Container%2C%20and%20Code-,Securing%20the%204%20Cs%20of%20Cloud%2DNative%20Systems%3A%20Cloud%2C,%2C%20container%2C%20cluster%2C%20code.)\notherwise non-sensitive metadata to ensure that critical data is kept secure. AWS provides a detailed example of\n[encrypting metadata with the AWS Glue Data Catalog and a listing of](https://docs.aws.amazon.com/glue/latest/dg/encrypt-glue-data-catalog.html) [ITAR-controlled data related to each AWS](https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/using-services.html)\nservice.\n\nOrganizations can also benefit from prioritizing continuous monitoring and auditing, and regularly patching and\nupdating their systems.\n\nIndicators of compromise\n\nSHA-256 Detection name\n\n024445ae9d41915af25a347e47122db2fbebb223e01acab3dd30de4b3546496 TROJAN.SH.KIMERA.YXBJ3\n\n06e8e4e480c4f19983f58c789503dbd31ee5076935a81ed0fe1f1af69b6f1d3d TROJAN.SH.KIMERA.YXBJ3\n\n4a00f99ce55f6204abcfa0b0392c6ee4c6a9fa46e8c1015a7c411ccd1b456720 TROJAN.SH.KIMERA.YXBJ3\n\n\n-----\n\n6075906fbc8898515fe09a046d81ca66429c9b3052a13d6b3ca6f8294c70d207 TROJANSPY.SH.CHIMAERA.AA\n\n71af0d59f289cac9a3a80eacd011f5897e0c8a72141523c1c0a3e623eceed8a5 TROJAN.SH.KIMERA.YXBJ3\n\n8bb87c1bb60cbf88724e88cf75889e6aa4fba24ab92a14aa108be04841a7aa86 TROJAN.SH.KIMERA.YXBJ3\n\n9ad4daaa5503bef61bb9ae7e5e75e92c3afd7077296c9a0ddee8ee38a0ce380e TROJAN.SH.KIMERA.YXBJ3\n\nb07ca49abd118bc2db92ccd436aec1f14bb8deb74c29b581842499642cc5c473 TROJAN.SH.KIMERA.YXBJ3\n\nc57f61e24814c9ae17c57efaf4149504e36bd3e6171e9299fd54b6fbb1ec108c TROJAN.SH.KIMERA.YXBJ3\n\nfa2a7374219d10a4835c7a6f0906184daaffd7dec2df954cfa38c3d4dd62d30d TROJAN.SH.KIMERA.YXBJ3\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-11 - TeamTNT Upgrades Arsenal, Refines Focus on Kubernetes and GPU Environments.pdf"
    ],
    "report_names": [
        "2021-11-11 - TeamTNT Upgrades Arsenal, Refines Focus on Kubernetes and GPU Environments.pdf"
    ],
    "threat_actors": [
        {
            "id": "81dde5cc-c29f-430d-8c6e-e5e92d5015e7",
            "created_at": "2022-10-25T16:07:23.704358Z",
            "updated_at": "2025-03-27T02:02:09.932453Z",
            "deleted_at": null,
            "main_name": "Harvester",
            "aliases": [],
            "source_name": "ETDA:Harvester",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Graphon",
                "Metasploit",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536205,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653698541,
    "ts_modification_date": 1653698541,
    "files": {
        "pdf": "https://archive.orkl.eu/8cead2e537922622bc66d24a9d7a78c4a1e5a3f3.pdf",
        "text": "https://archive.orkl.eu/8cead2e537922622bc66d24a9d7a78c4a1e5a3f3.txt",
        "img": "https://archive.orkl.eu/8cead2e537922622bc66d24a9d7a78c4a1e5a3f3.jpg"
    }
}