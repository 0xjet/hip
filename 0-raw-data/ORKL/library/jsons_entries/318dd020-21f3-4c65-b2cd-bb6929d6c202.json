{
    "id": "318dd020-21f3-4c65-b2cd-bb6929d6c202",
    "created_at": "2023-05-06T02:09:15.141058Z",
    "updated_at": "2025-03-27T02:17:23.613422Z",
    "deleted_at": null,
    "sha1_hash": "5c3bff459626aee7c5dc6dbc23d755d88c091a75",
    "title": "2023-04-20 - 3CX Software Supply Chain Compromise Initiated by a Prior Software Supply Chain Compromise; Suspected North Korean Actor Responsible",
    "authors": "",
    "file_creation_date": "2023-05-05T02:04:41Z",
    "file_modification_date": "2023-05-05T02:04:41Z",
    "file_size": 1182209,
    "plain_text": "# 3CX Software Supply Chain Compromise Initiated by a Prior Software Supply Chain Compromise; Suspected North Korean Actor Responsible\n\n**[mandiant.com/resources/blog/3cx-software-supply-chain-compromise](https://www.mandiant.com/resources/blog/3cx-software-supply-chain-compromise)**\n\nIn March 2023, Mandiant Consulting responded to a supply chain compromise that affected\n3CX Desktop App software. During this response, Mandiant identified that the initial\ncompromise vector of 3CX’s network was via malicious software downloaded from Trading\nTechnologies website. This is the first time Mandiant has seen a software supply chain attack\nlead to another software supply chain attack.\n\n## Overview\n\n3CX Desktop App is enterprise software that provides communications for its users including\n[chat, video calls, and voice calls. In late March, 2023, a software supply chain compromise](https://www.3cx.com/blog/news/desktopapp-security-alert/)\nspread malware via a trojanized version of 3CX’s legitimate software that was available to\n\n\n-----\n\ndownload from their website. The affected software was 3CX DesktopApp 18.12.416 and\nearlier, which contained malicious code that ran a downloader, SUDDENICON, which in turn\nreceived additional command and control (C2) servers from encrypted icon files hosted on\nGitHub. The decrypted C2 server was used to download a third stage identified as\nICONICSTEALER, a dataminer that steals browser information. Mandiant tracks this activity\nas UNC4736, a suspected North Korean nexus cluster of activity.\n\nFigure 1: 3CX software supply chain compromise linked to Trading Technologies software\nsupply chain compromise\n\n## Software Supply Chain Exploitation Explained\n\nMandiant Consulting’s [investigation of the 3CX supply chain compromise has uncovered the](https://www.3cx.com/blog/news/mandiant-security-update2/)\ninitial intrusion vector: a malware-laced software package distributed via an earlier software\nsupply chain compromise that began with a tampered installer for X_TRADER, a software\n\n\n-----\n\npackage provided by Trading Technologies (Figure 1). Mandiant determined that a complex\nloading process led to the deployment of VEILEDSIGNAL, a multi-stage modular backdoor,\nand its modules.\n\n## VEILEDSIGNAL Backdoor Analysis\n\nMandiant Consulting identified an installer with the filename X_TRADER_r7.17.90p608.exe\n(MD5: ef4ab22e565684424b4142b1294f1f4d) which led to the deployment of a malicious\nmodular backdoor: VEILEDSIGNAL.\n\nAlthough the X_TRADER platform was reportedly discontinued in 2020, it was still available\nfor download from the legitimate Trading Technologies website in 2022. This file was signed\nwith the subject “Trading Technologies International, Inc” and contained the executable file\nSetup.exe that was also signed with the same digital certificate. The code signing certificate\nused to digitally sign the malicious software was set to expire in October 2022.\n\nThe installer contains and executes Setup.exe which drops two trojanized DLLs and a\nbenign executable. Setup.exe uses the benign executable to side-load one of the malicious\nDLLs. Side-loading relies on legitimate Windows executables to load and execute a\nmalicious file that has been disguised as a legitimate dependency. The loaded malicious\nDLLs contains and uses SIGFLIP and DAVESHELL to decrypt and load the payload into\nmemory from the other dropped malicious executable. SIGFLIP relies on RC4 stream-cipher\nto decrypt the payload of choice and uses the byte sequence FEEDFACE to find the\nshellcode, in this case DAVESHELL, during the decryption stage.\n\nSIGFLIP and DAVESHELL extract and execute a modular backdoor, VEILEDSIGNAL, and\ntwo corresponding modules. VEILEDSIGNAL relies on the two extracted modules for\nprocess injection and communications with the C2 server.\n\nVEILEDSIGNAL and the accompanying two components provide the following functionality:\n\nThe VEILEDSIGNAL backdoor supports three commands: send implant data, execute\nshellcode, and terminate itself.\n\nThe process injection module injects the C2 module in the first found process instance\nof Chrome, Firefox, or Edge. It also monitors the named pipe and reinjects the\ncommunication module if necessary.\n\nThe C2 module creates a Windows named pipe and listens for incoming\ncommunications, which it then sends to the C2 server encrypted with AES-256 in\nGalois Counter Mode (GCM).\n\n\n-----\n\nThe C2 configuration of the identified sample of VEILEDSIGNAL (MD5:\nc6441c961dcad0fe127514a918eaabd4) relied on the following hard-coded URL:\n```\nwww.tradingtechnologies[.]com/trading/order-management.\n\n## VEILEDSIGNAL Similarities and Code Comparison\n\n```\nThe compromised X_TRADER and 3CXDesktopApp applications both contain, extract, and\nrun a payload in the same way, although the final payload is different. Mandiant analyzed\nthese samples and observed the following similarities:\n\nUsage of the same RC4 key 3jB(2bsG#@c7 in the SIGFLIP tool configuration to encrypt\nand decrypt the payload.\n[Usage of SIGFLIP, a publicly available project on GitHub leveraging CVE-2013-3900](https://github.com/med0x2e/SigFlip)\n(MS13-098).\n[Reliance on DAVESHELL, a publicly available open-source project that converts PE-](https://github.com/monoxgas/sRDI)\nCOFF files to position-independent code or shellcode and that leverages reflective\nloading techniques to load the payload in memory.\nUse of the hardcoded cookie variable __tutma in the payloads.\nBoth payloads encrypt data with AES-256 GCM cipher.\n\n## Compromise of the 3CX Build Environment\n\n[The attacker used a compiled version of the publicly available Fast Reverse Proxy project, to](https://github.com/fatedier/frp)\nmove laterally within the 3CX organization during the attack. The file MsMpEng.exe (MD5:\n19dbffec4e359a198daf4ffca1ab9165), was dropped in C:\\Windows\\System32 by the threat\nactor.\n\nMandiant was able to reconstruct the attacker’s steps throughout the environment as they\nharvested credentials and moved laterally. Eventually, the attacker was able to compromise\nboth the Windows and macOS build environments. On the Windows build environment, the\nattacker deployed a TAXHAUL launcher and COLDCAT downloader that persisted by\nperforming DLL search order hijacking through the IKEEXT service and ran with\nLocalSystem privileges. The macOS build server was compromised with POOLRAT\nbackdoor using Launch Daemons as a persistence mechanism.\n\nPrevious reporting mentioned the macOS build server was compromised with SIMPLESEA.\nMandiant Intelligence completed analysis of the sample and determined it to be the backdoor\nPOOLRAT instead of a new malware family.\n\n## Threat Actor Spotlight: UNC4736\n\n\n-----\n\nUNC4736 demonstrates varying degrees of overlap with multiple North Korean operators\ntracked by Mandiant Intelligence, especially with those involved in financially-motivated\ncybercrime operations. These clusters have demonstrated a sustained focus on\ncryptocurrency and fintech-related services over time.\n\nMandiant assesses with moderate confidence that UNC4736 is related to financially\nmotivated North Korean “AppleJeus” activity as reported by CISA. This is further\ncorroborated with findings from Google TAG who reported the compromise of\n```\nwww.tradingtechnologies[.]com in February 2022, preceding the distribution of\n\n```\ncompromised X_TRADER updates from the site.\n\n[TAGreported on a cluster of North Korean activity exploiting a remote code execution](https://blog.google/threat-analysis-group/countering-threats-north-korea/)\nvulnerability in Chrome, [CVE-2022-0609, and identified it as overlapping with](https://chromereleases.googleblog.com/2022/02/stable-channel-update-for-desktop_14.html)\n“AppleJeus” targeting cryptocurrency services.\nThe site www.tradingtechnologies[.]com was compromised and hosting a hidden\nIFRAME to exploit visitors, just two months before the site was known to deliver a\ntrojanized X_TRADER software package.\nWithin the 3CX environment, Mandiant identified the POOLRAT backdoor using\n```\n   journalide[.]org as its configured C2 server.\n\n```\nAn older sample of POOLRAT (MD5: 451c23709ecd5a8461ad060f6346930c) was\n[previouslyreported by CISA as part of the trojanized CoinGoTrade application used in](https://www.cisa.gov/news-events/analysis-reports/ar21-048e)\nthe AppleJeus operation (Figure 2).\n\nThe older sample’s infrastructure also has ties to another trojanized trading\napplication, JMT Trading, also tracked under AppleJeus.\n\n\n-----\n\nFigure 2: POOLRAT Link to CoinGoTrade and JMT Trading Activity\nWeak infrastructure overlap was also identified between UNC4736 and two clusters of\n[suspected APT43 activity, UNC3782 and UNC4469.](https://www.mandiant.com/resources/blog/apt43-north-korea-cybercrime-espionage)\n\nDNS resolutions reveal infrastructure overlap between UNC4736 and activity linked to\nAPT43 with moderate confidence (Tables 1 – 3)\nAPT43 frequently targets cryptocurrency users and related services, highlighting such\ncampaigns are widespread across North Korea-nexus cyber operators.\n\nTable 1: Resolutions for IP 89.45.67.160\n\n**Date** **Domain** **UNC**\n\n\n-----\n\n2022-12-20 `curvefinances[.]com` UNC4469\n\n2022-12-29 `pbxphonenetwork[.]com` UNC4736\n\nTable 2: Resolutions for IP 172.93.201.88\n\n**Date** **Domain** **UNC**\n\n2022-04-08 `journalide[.]org` UNC4736\n\n2021-11-26 `nxmnv[.]site` UNC3782\n\nTable 3: Resolutions for IP 185.38.151[.]11\n\n**Date** **Domain** **UNC**\n\n2023-01-09 `msedgepackageinfo[.]com` UNC4736\n\n2023-03-22 `apollo-crypto.org.shilaerc20[.]com` UNC4469\n\n## Outlook and Implications\n\nThe identified software supply chain compromise is the first we are aware of which has led to\na cascading software supply chain compromise. It shows the potential reach of this type of\ncompromise, particularly when a threat actor can chain intrusions as demonstrated in this\ninvestigation. Research on UNC4736 activity suggests that it is most likely linked to\nfinancially motivated North Korean threat actors. Cascading software supply chain\ncompromises demonstrate that North Korean operators can exploit network access in\ncreative ways to develop and distribute malware, and move between target networks while\nconducting operations aligned with North Korea’s interests.\n\n## Malware Definitions\n\n**ICONICSTEALER**\n\nICONICSTEALER is a C/C++ data miner that collects application configuration data as well\nas browser history.\n\n**DAVESHELL**\n\n\n-----\n\nDAVESHELL is shellcode that functions as an in-memory dropper. Its embedded payload is\nmapped into memory and executed.\n\n**SIGFLIP**\n\nSigFlip is a tool for patching authenticode signed PE-COFF files to inject arbitrary code\nwithout affecting or breaking the file's signature.\n\n**POOLRAT**\n\nPOOLRAT is a C/C++ macOS backdoor capable of collecting basic system information and\nexecuting commands. The commands performed include running arbitrary commands,\nsecure deleting files, reading and writing files, updating the configuration.\n\n**TAXHAUL**\n\nTAXHAUL is a DLL that, when executed, decrypts a shellcode payload expected at\n```\nC:\\Windows\\System32\\config\\TxR\\<machine hardware profile GUID>.TxR.0.regtransms. Mandiant has seen TAXHAUL persist via DLL search order hijacking.\n\n```\n**COLDCAT**\n\nCOLDCAT is a complex downloader. COLDCAT generates unique host identifier information,\nand beacons it to a C2 that is specified in a separate file via POST request with the data in\nthe cookie header. After a brief handshake, the malware expects base64 encoded shellcode\nto execute in response.\n\n**VEILEDSIGNAL**\n\nVEILEDSIGNAL is a backdoor written in C that is able to execute shellcode and terminate\nitself. Additionally, VEILEDSIGNAL relies on additional modules that connect via Windows\nnamed pipes to interact with the C2 infrastructure.\n\n## Acknowledgments\n\nSpecial thanks to Michael Bailey, Willi Ballenthin, Michael Barnhart, and Jakub Jozwiak for\ntheir collaboration and review. Mandiant would also like to thank the Google Threat Analysis\nGroup (TAG) and Microsoft Threat Intelligence Center (MSTIC) for their collaboration in this\nresearch.\n\n## Technical Annex: MITRE ATT&CK \n\n_Resource Development_\n\nT1588 Obtain Capabilities\n\n\n-----\n\nT1588.004 Digital Certificates\nT1608 Stage Capabilities\nT1608.003 Install Digital Certificate\n\n_Initial Access_\n\nT1190 Exploit Public-Facing Application\nT1195 Supply Chain Compromise\nT1195.002 Compromise Software Supply Chain\n\n_Persistence_\n\nT1574 Hijack Execution Flow\nT1574.002 DLL Side-Loading\n\n_Privilege Escalation_\n\nT1055 Process Injection\nT1574 Hijack Execution Flow\nT1574.002 DLL Side-Loading\n\n_Defense Evasion_\n\nT1027 Obfuscated Files or Information\nT1036 Masquerading\nT1036.001 Invalid Code Signature\nT1055 Process Injection\nT1070 Indicator Removal\nT1070.001 Clear Windows Event Logs\nT1070.004 File Deletion\nT1112 Modify Registry\nT1140 Deobfuscate/Decode Files or Information\nT1497 Virtualization/Sandbox Evasion\nT1497.001 System Checks\nT1574 Hijack Execution Flow\nT1574.002 DLL Side-Loading\nT1620 Reflective Code Loading\nT1622 Debugger Evasion\n\n_Discovery_\n\nT1012 Query Registry\nT1082 System Information Discovery\nT1083 File and Directory Discovery\nT1497 Virtualization/Sandbox Evasion\n\n\n-----\n\nT1497.001 System Checks\nT1614 System Location Discovery\nT1614.001 System Language Discovery\nT1622 Debugger Evasion\n\n_Command and Control_\n\nT1071 Application Layer Protocol\nT1071.001 Web Protocols\nT1071.004 DNS\nT1105 Ingress Tool Transfer\nT1573 Encrypted Channel\nT1573.002 Asymmetric Cryptography\n\n_Impact_\n\nT1565 Data Manipulation\nT1565.001 Stored Data Manipulation\n\n## Technical Annex: Detection Rules\n\n### YARA Rules\n```\n rule M_Hunting_3CXDesktopApp_Key {\n  meta:\n   disclaimer = \"This rule is meant for hunting and is not tested to run in\n a production environment\"\n   description = \"Detects a key found in a malicious 3CXDesktopApp file\"\n   md5 = \"74bc2d0b6680faa1a5a76b27e5479cbc\"\n   date = \"2023/03/29\"\n   version = \"1\"\n  strings:\n   $key = \"3jB(2bsG#@c7\" wide ascii\n  condition:\n   $key\n }\n\n```\n\n-----\n\n```\nrule M_Hunting_3CXDesktopApp_Export {\n meta:\n  disclaimer = \"This rule is meant for hunting and is not tested to run in\na production environment\"\n  description = \"Detects an export used in 3CXDesktopApp malware\"\n  md5 = \"7faea2b01796b80d180399040bb69835\"\n  date = \"2023/03/31\"\n  version = \"1\"\n strings:\n  $str1 = \"DllGetClassObject\" wide ascii\n  $str2 = \"3CXDesktopApp\" wide ascii\n condition:\n  all of ($str*)\n}\nrule TAXHAUL\n{\n meta:\n author = \"Mandiant\"\n created = \"04/03/2023\"\n modified = \"04/03/2023\"\n version = \"1.0\"\n strings:\n  $p00_0 = {410f45fe4c8d3d[4]eb??4533f64c8d3d[4]eb??4533f64c8d3d[4]eb}\n  $p00_1 = {4d3926488b01400f94c6ff90[4]41b9[4]eb??8bde4885c074}\n condition:\n  uint16(0) == 0x5A4D and any of them\n}\n\n```\n\n-----\n\n```\nrule M_Hunting_MSI_Installer_3CX_1\n{\nmeta:\nauthor = \"Mandiant\"\nmd5 = \"0eeb1c0133eb4d571178b2d9d14ce3e9, f3d4144860ca10ba60f7ef4d176cc736\"\nstrings:\n$ss1 = { 20 00 5F 64 33 64 63 6F 6D 70 69 6C 65 72 5F 34 37 2E 64 6C 6C 5F }\n$ss2 = { 20 00 5F 33 43 58 44 65 73 6B 74 6F 70 41 70 70 2E }\n$ss3 = { 20 00 5F 66 66 6D 70 65 67 2E 64 6C 6C 5F }\n$ss4 = \"3CX Ltd1\" ascii\n$sc1 = { 1B 66 11 DF 9C 9A 4D 6E CC 8E D5 0C 9B 91 78 73 }\n$sc2 = \"202303\" ascii\ncondition:\n(uint32(0) == 0xE011CFD0) and filesize > 90MB and filesize < 105MB and all\nof them\n}\n\n```\n\n-----\n\n```\nrule M_Hunting_TAXHAUL_Hash_1\n{\nmeta:\nauthor = \"Mandiant\"\ndisclaimer = \"This rule is meant for hunting and is not tested to run in a\nproduction environment\"\ndescription = \"Rule looks for hardcoded value used in string hashing\nalgorithm observed in instances of TAXHAUL.\"\nmd5 = \"e424f4e52d21c3da1b08394b42bc0829\"\nstrings:\n$c_x64 = { 25 A3 87 DE [4-20] 25 A3 87 DE [4-20] 25 A3 87 DE }\ncondition:\nfilesize < 15MB and uint16(0) == 0x5a4d and uint32(uint32(0x3C)) ==\n0x00004550 and any of them\n}\n\n```\n\n-----\n\n```\nrule M_Hunting_SigFlip_SigLoader_Native\n{\nmeta:\nauthor = \"Mandiant\"\ndisclaimer = \"This rule is meant for hunting and is not tested to run in a\nproduction environment\"\ndescription = \"Rule looks for strings present in SigLoader (Native)\"\nmd5 = \"a3ccc48db9eabfed7245ad6e3a5b203f\"\nstrings:\n$s1 = \"[*]: Basic Loader...\" ascii wide\n$s2 = \"[!]: Missing PE path or Encryption Key...\" ascii wide\n$s3 = \"[!]: Usage: %s <PE_PATH> <Encryption_Key>\" ascii wide\n$s4 = \"[*]: Loading/Parsing PE File '%s'\" ascii wide\n$s5 = \"[!]: Could not read file %s\" ascii wide\n$s6 = \"[!]: '%s' is not a valid PE file\" ascii wide\n$s7 = \"[+]: Certificate Table RVA %x\" ascii wide\n$s8 = \"[+]: Certificate Table Size %d\" ascii wide\n$s9 = \"[*]: Tag Found 0x%x%x%x%x\" ascii wide\n$s10 = \"[!]: Could not locate data/shellcode\" ascii wide\n$s11 = \"[+]: Encrypted/Decrypted Data Size %d\" ascii wide\ncondition:\nfilesize < 15MB and uint16(0) == 0x5a4d and uint32(uint32(0x3C)) ==\n0x00004550 and 4 of ($s*)\n}\n\n```\n\n-----\n\n```\nrule M_Hunting_Raw64_DAVESHELL_Bootstrap\n{\nmeta:\nauthor = \"Mandiant\"\ndisclaimer = \"This rule is meant for hunting and is not tested to run in a\nproduction environment\"\ndescription = \"Rule looks for bootstrap shellcode (64 bit) present in\nDAVESHELL\"\nmd5 = \"8a34adda5b981498234be921f86dfb27\"\nstrings:\n$b6ba50888f08e4f39b43ef67da27521dcfc61f1e = { E8 00 00 00 00 59 49 89 C8 48\n81 C1 ?? ?? ?? ?? BA ?? ?? ?? ?? 49 81 C0 ?? ?? ?? ?? 41 B9 ?? ?? ?? ?? 56\n48 89 E6 48 83 E4 F0 48 83 EC 30 C7 44 24 20 ?? ?? ?? ?? E8 ?? 00 00 00 48\n89 F4 5E C3 }\n$e32abbe82e1f957fb058c3770375da3bf71a8cab = { E8 00 00 00 00 59 49 89 C8 BA\n?? ?? ?? ?? 49 81 C0 ?? ?? ?? ?? 41 B9 ?? ?? ?? ?? 56 48 89 E6 48 83 E4 F0\n48 83 EC 30 48 89 4C 24 28 48 81 C1 ?? ?? ?? ?? C7 44 24 20 ?? ?? ?? ?? E8\n?? 00 00 00 48 89 F4 5E C3 }\ncondition:\nfilesize < 15MB and any of them\n}\n\n```\n\n-----\n\n```\nrule M_Hunting_MSI_Installer_3CX_1\n{\nmeta:\nauthor = \"Mandiant\"\ndisclaimer = \"This rule is meant for hunting and is not tested to run in a\nproduction environment\"\ndescription = \"This rule looks for hardcoded values within the MSI installer\nobserved in strings and signing certificate\"\nmd5 = \"0eeb1c0133eb4d571178b2d9d14ce3e9\"\nstrings:\n$ss1 = { 20 00 5F 64 33 64 63 6F 6D 70 69 6C 65 72 5F 34 37 2E 64 6C 6C 5F }\n$ss2 = { 20 00 5F 33 43 58 44 65 73 6B 74 6F 70 41 70 70 2E }\n$ss3 = { 20 00 5F 66 66 6D 70 65 67 2E 64 6C 6C 5F }\n$ss4 = \"3CX Ltd1\" ascii\n$sc1 = { 1B 66 11 DF 9C 9A 4D 6E CC 8E D5 0C 9B 91 78 73 }\n$sc2 = \"202303\" ascii\ncondition:\n(uint32(0) == 0xE011CFD0) and filesize > 90MB and filesize < 100MB and all\nof them\n}\n\n```\n\n-----\n\n```\nrule M_Hunting_VEILEDSIGNAL_1\n{\nmeta:\nauthor = \"Mandiant\"\ndisclaimer = \"This rule is meant for hunting and is not tested to run in a\nproduction environment\"\nmd5 = \"404b09def6054a281b41d309d809a428, c6441c961dcad0fe127514a918eaabd4\"\nstrings:\n$rh1 = { 68 5D 7A D2 2C 3C 14 81 2C 3C 14 81 2C 3C 14 81 77 54 10 80 26 3C\n14 81 77 54 17 80 29 3C 14 81 77 54 11 80 AB 3C 14 81 D4 4C 11 80 33 3C 14\n81 D4 4C 10 80 22 3C 14 81 D4 4C 17 80 25 3C 14 81 77 54 15 80 27 3C 14 81\n2C 3C 15 81 4B 3C 14 81 94 4D 1D 80 28 3C 14 81 94 4D 14 80 2D 3C 14 81 94\n4D 16 80 2D 3C 14 81 }\n$rh2 = { 00 E5 A0 2B 44 84 CE 78 44 84 CE 78 44 84 CE 78 1F EC CA 79 49 84\nCE 78 1F EC CD 79 41 84 CE 78 1F EC CB 79 C8 84 CE 78 BC F4 CA 79 4A 84 CE\n78 BC F4 CD 79 4D 84 CE 78 BC F4 CB 79 65 84 CE 78 1F EC CF 79 43 84 CE 78\n44 84 CF 78 22 84 CE 78 FC F5 C7 79 42 84 CE 78 FC F5 CE 79 45 84 CE 78 FC\nF5 CC 79 45 84 CE 78}\n$rh3 = { DA D2 21 22 9E B3 4F 71 9E B3 4F 71 9E B3 4F 71 C5 DB 4C 70 94 B3\n4F 71 C5 DB 4A 70 15 B3 4F 71 C5 DB 4B 70 8C B3 4F 71 66 C3 4B 70 8C B3 4F\n71 66 C3 4C 70 8F B3 4F 71 C5 DB 49 70 9F B3 4F 71 66 C3 4A 70 B0 B3 4F 71\nC5 DB 4E 70 97 B3 4F 71 9E B3 4E 71 F9 B3 4F 71 26 C2 46 70 9F B3 4F 71 26\nC2 B0 71 9F B3 4F 71 9E B3 D8 71 9F B3 4F 71 26 C2 4D 70 9F B3 4F 71 }\n$rh4 = { CB 8A 35 66 8F EB 5B 35 8F EB 5B 35 8F EB 5B 35 D4 83 5F 34 85 EB\n5B 35 D4 83 58 34 8A EB 5B 35 D4 83 5E 34 09 EB 5B 35 77 9B 5E 34 92 EB 5B\n35 77 9B 5F 34 81 EB 5B 35 77 9B 58 34 86 EB 5B 35 D4 83 5A 34 8C EB 5B 35\n8F EB 5A 35 D3 EB 5B 35 37 9A 52 34 8C EB 5B 35 37 9A 58 34 8E EB 5B 35 37\n9A 5B 34 8E EB 5B 35 37 9A 59 34 8E EB 5B 35 }\ncondition:\nuint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and 1 of ($rh*)\n}\n\n```\n\n-----\n\n```\nrule M_Hunting_VEILEDSIGNAL_2\n{\nmeta:\nauthor = \"Mandiant\"\ndisclaimer = \"This rule is meant for hunting and is not tested to run in a\nproduction environment\"\nmd5 = \"404b09def6054a281b41d309d809a428\"\nstrings:\n$sb1 = { C1 E0 05 4D 8? [2] 33 D0 45 69 C0 7D 50 BF 12 8B C2 41 FF C2 C1 E8\n07 33 D0 8B C2 C1 E0 16 41 81 C0 87 D6 12 00 }\n$si1 = \"CryptBinaryToStringA\" fullword\n$si2 = \"BCryptGenerateSymmetricKey\" fullword\n$si3 = \"CreateThread\" fullword\n$ss1 = \"ChainingModeGCM\" wide\n$ss2 = \"__tutma\" fullword\ncondition:\n(uint16(0) == 0x5A4D) and (uint32(uint32(0x3C)) == 0x00004550) and\n(uint16(uint32(0x3C)+0x18) == 0x020B) and all of them\n}\n\n```\n\n-----\n\n```\nrule M_Hunting_VEILEDSIGNAL_3\n{\nmeta:\nauthor = \"Mandiant\"\ndisclaimer = \"This rule is meant for hunting and is not tested to run in a\nproduction environment\"\nmd5 = \"c6441c961dcad0fe127514a918eaabd4\"\nstrings:\n$ss1 = { 61 70 70 6C 69 63 61 74 69 6F 6E 2F 6A 73 6F 6E 2C 20 74 65 78 74\n2F 6A 61 76 61 73 63 72 69 70 74 2C 20 2A 2F 2A 3B 20 71 3D 30 2E 30 31 00\n00 61 63 63 65 70 74 00 00 65 6E 2D 55 53 2C 65 6E 3B 71 3D 30 2E 39 00 00\n61 63 63 65 70 74 2D 6C 61 6E 67 75 61 67 65 00 63 6F 6F 6B 69 65 00 00 }\n$si1 = \"HttpSendRequestW\" fullword\n$si2 = \"CreateNamedPipeW\" fullword\n$si3 = \"CreateThread\" fullword\n$se1 = \"DllGetClassObject\" fullword\ncondition:\n(uint16(0) == 0x5A4D) and (uint32(uint32(0x3C)) == 0x00004550) and\n(uint16(uint32(0x3C)+0x18) == 0x020B) and all of them\n}\n\n```\n\n-----\n\n```\nrule M_Hunting_VEILEDSIGNAL_4\n{\nmeta:\nauthor = \"Mandiant\"\ndisclaimer = \"This rule is meant for hunting and is not tested to run in a\nproduction environment\"\nmd5 = \"404b09def6054a281b41d309d809a428, c6441c961dcad0fe127514a918eaabd4\"\nstrings:\n$sb1 = { FF 15 FC 76 01 00 8B F0 85 C0 74 ?? 8D 50 01 [6-16] FF 15 [4] 48 8B\nD8 48 85 C0 74 ?? 89 ?? 24 28 44 8B CD 4C 8B C? 48 89 44 24 20 }\n$sb2 = { 33 D2 33 C9 FF 15 [4] 4C 8B CB 4C 89 74 24 28 4C 8D 05 [2] FF FF 44\n89 74 24 20 33 D2 33 C9 FF 15 }\n$si1 = \"CreateThread\" fullword\n$si2 = \"MultiByteToWideChar\" fullword\n$si3 = \"LocalAlloc\" fullword\n$se1 = \"DllGetClassObject\" fullword\ncondition:\n(uint16(0) == 0x5A4D) and (uint32(uint32(0x3C)) == 0x00004550) and\n(uint16(uint32(0x3C)+0x18) == 0x020B) and all of them\n}\n\n```\n\n-----\n\n```\nrule M_Hunting_VEILEDSIGNAL_5\n{\nmeta:\nauthor = \"Mandiant\"\ndisclaimer = \"This rule is meant for hunting and is not tested to run in a\nproduction environment\"\nmd5 = \"6727284586ecf528240be21bb6e97f88\"\nstrings:\n$sb1 = { 48 8D 15 [4] 48 8D 4C 24 4C E8 [4] 85 C0 74 ?? 48 8D 15 [4] 48 8D\n4C 24 4C E8 [4] 85 C0 74 ?? 48 8D 15 [4] 48 8D 4C 24 4C E8 [4] 85 C0 74 ??\n48 8D [3] 48 8B CB FF 15 [4] EB }\n$ss1 = \"chrome.exe\" wide fullword\n$ss2 = \"firefox.exe\" wide fullword\n$ss3 = \"msedge.exe\" wide fullword\n$ss4 = \"\\\\\\\\.\\\\pipe\\\\*\" ascii fullword\n$ss5 = \"FindFirstFileA\" ascii fullword\n$ss6 = \"Process32FirstW\" ascii fullword\n$ss7 = \"RtlAdjustPrivilege\" ascii fullword\n$ss8 = \"GetCurrentProcess\" ascii fullword\n$ss9 = \"NtWaitForSingleObject\" ascii fullword\ncondition:\n(uint16(0) == 0x5A4D) and (uint32(uint32(0x3C)) == 0x00004550) and\n(uint16(uint32(0x3C)+0x18) == 0x020B) and all of them\n}\n\n```\n\n-----\n\n```\nrule M_Hunting_VEILEDSIGNAL_6\n{\nmeta:\nauthor = \"Mandiant\"\ndisclaimer = \"This rule is meant for hunting and is not tested to run in a\nproduction environment\"\nmd5 = \"00a43d64f9b5187a1e1f922b99b09b77\"\nstrings:\n$ss1 = \"C:\\\\Programdata\\\\\" wide\n$ss2 = \"devobj.dll\" wide fullword\n$ss3 = \"msvcr100.dll\" wide fullword\n$ss4 = \"TpmVscMgrSvr.exe\" wide fullword\n$ss5 = \"\\\\Microsoft\\\\Windows\\\\TPM\" wide fullword\n$ss6 = \"CreateFileW\" ascii fullword\ncondition:\n(uint16(0) == 0x5A4D) and (uint32(uint32(0x3C)) == 0x00004550) and\n(uint16(uint32(0x3C)+0x18) == 0x010B) and all of them\n}\nrule MTI_Hunting_POOLRAT {\n meta:\n  author = \"Mandiant\"\n  disclaimer = \"This rule is meant for hunting and is not tested to run in\na production environment\"\n  description = \"Detects strings found in POOLRAT. \"\n  md5 = \"451c23709ecd5a8461ad060f6346930c\"\n  date = \"10/28/2020\"\n  version = \"1\"\n strings:\n  $str1 = \"name=\\\"uid\\\"%s%s%u%s\" wide ascii\n  $str2 = \"name=\\\"session\\\"%s%s%u%s\" wide ascii\n  $str3 = \"name=\\\"action\\\"%s%s%s%s\" wide ascii\n  $str4 = \"name=\\\"token\\\"%s%s%u%s\" wide ascii\n  $boundary = \"--N9dLfqxHNUUw8qaUPqggVTpX-\" wide ascii nocase\n condition:\n  any of ($str*) or $boundary\n}\n\n```\n\n-----\n\n```\n rule M_Hunting_FASTREVERSEPROXY\n {\n    meta:\n    author = \"Mandiant\"\n    disclaimer = \"This rule is meant for hunting and is not tested to run\n in a production environment\"\n    md5 = \"19dbffec4e359a198daf4ffca1ab9165\"\n    strings:\n    $ss1 = \"Go build ID:\" fullword\n    $ss2 = \"Go buildinf:\" fullword\n    $ss3 = \"net/http/httputil.(*ReverseProxy).\" ascii\n    $ss4 = \"github.com/fatedier/frp/client\" ascii\n    $ss5 = \"\\\"server_port\\\"\" ascii\n    $ss6 = \"github.com/armon/go-socks5.proxy\" ascii\n    condition:\n    uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and all of\n them\n }\n\n### Snort Rules\n alert tcp any any -> any any (msg:\"Possible malicious 3CXDesktopApp\n Identified\"; content:\"raw.githubusercontent.com/IconStorages/images/main/\";\n threshold:type limit, track by_src, count 1, seconds 3600; sid: 99999999;)\n alert tcp any any -> any any (msg:\"Possible malicious 3CXDesktopApp\n Identified\";\n content:\"3cx_auth_id=%s\\;3cx_auth_token_content=%s\\;__tutma=true\";\n threshold:type limit, track by_src, count 1, seconds 3600; sid: 99999999;)\n alert tcp any any -> any any (msg:\"Possible malicious 3CXDesktopApp\n Identified\"; content:\"__tutma\"; threshold:type limit, track by_src, count 1,\n seconds 3600; sid: 99999999;)\n alert tcp any any -> any any (msg:\"Possible malicious 3CXDesktopApp\n Identified\"; content:\"__tutmc\"; threshold:type limit, track by_src, count 1,\n seconds 3600; sid: 99999999;)\n\n```\n\n-----\n\n## Mandiant Security Validation\n\nOrganizations can validate their security controls using the following actions with Mandiant\nSecurity Validation.\n\n**VID** **Name**\n\n\nA106319\n\n\nCommand and Control - UNC4736, DNS Query, Variant #1\n\n\nA106321\n\n\nCommand and Control - UNC4736, DNS Query, Variant #2\n\n\nA106323\n\n\nCommand and Control - UNC4736, DNS Query, Variant #3\n\n\nA106324\n\n\nHost CLI - UNC4736, 3CX Run Key, Registry Modification\n\n\nA106322\n\n\nMalicious File Transfer - UNC4736, SUDDENICON, Download, Variant #1\n\n\nS100272\n\n\nEvaluation: UNC4736 Conducting Supply Chain Attack Targeting 3CX Phone\nManagement System\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-04-20 - 3CX Software Supply Chain Compromise Initiated by a Prior Software Supply Chain Compromise; Suspected North Korean Actor Responsible.pdf"
    ],
    "report_names": [
        "2023-04-20 - 3CX Software Supply Chain Compromise Initiated by a Prior Software Supply Chain Compromise; Suspected North Korean Actor Responsible.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c306e698-3b48-46d7-b571-3dfa0c828379",
            "created_at": "2023-05-16T02:02:09.957677Z",
            "updated_at": "2025-03-27T02:00:03.129777Z",
            "deleted_at": null,
            "main_name": "APT43",
            "aliases": [],
            "source_name": "MISPGALAXY:APT43",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e265bb3a-eb4c-4999-9b1d-c24a0d05a7f0",
            "created_at": "2023-12-21T02:00:06.096716Z",
            "updated_at": "2025-03-27T02:00:03.27337Z",
            "deleted_at": null,
            "main_name": "UNC4736",
            "aliases": [],
            "source_name": "MISPGALAXY:UNC4736",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "dc78f675-b309-431d-8160-b8dcff037d4f",
            "created_at": "2024-05-01T02:03:08.142224Z",
            "updated_at": "2025-03-27T02:05:17.417972Z",
            "deleted_at": null,
            "main_name": "NICKEL KIMBALL",
            "aliases": [
                "Black Banshee ",
                "Crooked Pisces ",
                "Emerald Sleet ",
                "Kimsuky ",
                "Opal Sleet ",
                "SharpTongue ",
                "TA427 ",
                "THALLIUM ",
                "Velvet Chollima ",
                "APT43 "
            ],
            "source_name": "Secureworks:NICKEL KIMBALL",
            "tools": [
                " KONNI",
                " KimJongRAT",
                " Kimsuky",
                "BabyShark"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1683338955,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1683252281,
    "ts_modification_date": 1683252281,
    "files": {
        "pdf": "https://archive.orkl.eu/5c3bff459626aee7c5dc6dbc23d755d88c091a75.pdf",
        "text": "https://archive.orkl.eu/5c3bff459626aee7c5dc6dbc23d755d88c091a75.txt",
        "img": "https://archive.orkl.eu/5c3bff459626aee7c5dc6dbc23d755d88c091a75.jpg"
    }
}