{
    "id": "b117b2b7-ea44-40b5-a3a1-79acc9bdacbe",
    "created_at": "2023-01-12T15:08:40.002068Z",
    "updated_at": "2025-03-27T02:08:00.195218Z",
    "deleted_at": null,
    "sha1_hash": "bc35d1b0700dc2cfdb3dabb183cde40c8a6ef8f0",
    "title": "2016-08-10 - CryptXXX - CrypMIC – intensywnie dystrybuowany ransomware w ramach exploit-kitów",
    "authors": "",
    "file_creation_date": "2011-08-29T09:25:32Z",
    "file_modification_date": "2011-09-15T09:53:27Z",
    "file_size": 2821008,
    "plain_text": "# Vulnerability Analysis of Energy Delivery Control Systems \n\n## September 2011\n\n\n##### Idaho National Laboratory\n Idaho Falls, Idaho 83415\n http://www.inl.gov\n\n**Prepared for the**\n**U.S. Department of Energy**\n**Office of Electricity Delivery and Energy**\n**Reliability**\n**Under DOE Idaho Operations Office**\n\n**Contract DE-AC07-05ID14517**\n\n\nThe INL is a U.S. Department of Energy National Laboratory\noperated by Battelle Energy Alliance\n\n\n-----\n\n**DISCLAIMER**\nThis information was prepared as an account of work sponsored by an\nagency of the U.S. Government. Neither the U.S. Government nor any\nagency thereof, nor any of their employees, makes any warranty, expressed\nor implied, or assumes any legal liability or responsibility for the accuracy,\ncompleteness, or usefulness, of any information, apparatus, product, or\nprocess disclosed, or represents that its use would not infringe privately\nowned rights. References herein to any specific commercial product,\nprocess, or service by trade name, trade mark, manufacturer, or otherwise,\ndoes not necessarily constitute or imply its endorsement, recommendation,\nor favoring by the U.S. Government or any agency thereof. The views and\nopinions of authors expressed herein do not necessarily state or reflect\nthose of the U.S. Government or any agency thereof.\n\n\n-----\n\n#### EXECUTIVE SUMMARY\n\n\n**A serious and ongoing challenge**\n\nCybersecurity for energy delivery systems has\nemerged as one of the Nation’s most serious grid “Industry estimates that the production of\nmodernization and infrastructure protection issues. malware has reached its highest levels, with\nCyber adversaries are becoming increasingly an average of 60,000 new pieces identified\ntargeted, sophisticated, and better financed. The per day...”[32.]\nStuxnet worm—designed to attack a specific control _-James R. Clapper, Director of National_\nsystem similar to those found in some energy sector _Intelligence, February 10, 2011_\napplications—underscores the seriousness of\ntargeted cyber attacks on energy control systems. The energy sector must research, develop and\ndeploy new cybersecurity capabilities faster than the adversary can launch new attack tools and\ntechniques.\n\n\nCybersecurity technologies that are developed to protect business IT computer systems and\nnetworks can break an energy delivery control system. The computers and networks that control\nour Nation’s power grid are very different from those on our desks. Energy delivery control\nsystems are uniquely designed and operated to control real-time physical processes that deliver\ncontinuous and reliable power to support national and economic security. These differences must\nbe respected when securing these systems or the cybersecurity protective measures themselves\ncould create a power disruption that rivals that of an intentional cyber-attack.\n\nThe goal of the U.S. Department of Energy Office of Electricity Delivery and Energy\nReliability (DOE/OE) National Supervisory Control and Data Acquisition (SCADA) Test Bed\n(NSTB) program is to enhance the reliability and resiliency of the Nation’s energy infrastructure\nby reducing the risk of energy disruptions due to cyber attacks. A key part of the program is\nSCADA system vulnerability analysis that identifies and provides mitigation approaches for\nvulnerabilities that could put these systems at risk. A cybersecurity vulnerability is a weakness in\na computing system that can result in harm to the system or its operation, especially when this\nweakness is exploited by a hostile actor or is present in conjunction with particular events or\ncircumstances.\n\nIn 2006, DOE collaborated with energy owners and operators to develop a strategy to secure\nenergy control systems going forward, made available through the Roadmap to Secure Control\n_Systems in the Energy Sector. In 2011 the Roadmap was updated to keep pace with advances in_\ntechnology and the evolving threat landscape, and renamed the Roadmap to Achieve Energy\n_Delivery Systems Cybersecurity. The Roadmap lays out a vision that by 2020, resilient energy_\ndelivery systems are designed, installed, operated and maintained to survive a cyber incident\nwhile sustaining critical functions. One of the Roadmap strategic directions needed to achieve this\nvision is to assess and monitor risk, which is the subject of this report.\n\n**About this report**\n\nThis Vulnerability Analysis of Energy Delivery Systems report describes common\nvulnerabilities found in assessments performed from 2003 to 2010 by Idaho National Laboratory\n(INL) on behalf of the DOE/OE NSTB program. INL performs cybersecurity assessments on\nenergy sector supervisory control and data acquisition/energy management systems\n(SCADA/EMS, hereafter referred to as SCADA) under private sector and government programs.\nThe vulnerabilities described in this report were routinely discovered in NSTB assessments using\na variety of typical attack methods to manipulate or disrupt system operations.\n\n\n-----\n\nThe purpose of this report is to provide recommendations to the SCADA vendor and/or\nowner to identify and reduce the risk of these vulnerabilities in their systems. Vulnerabilities and\nmitigation recommendations are presented at a high-level to provide awareness of the most\ncommon and significant SCADA security vulnerability areas without divulging product-specific\ninformation. The common vulnerabilities in this report were found on two or more unique\nSCADA configurations. Even though SCADA functions, designs, and configurations vary among\nvendors, versions, and installations, their high-level vulnerabilities and defensive\nrecommendations are similar.\n\nThis report begins with a history, purpose, and scope of NSTB vulnerability analysis. Section\ntwo describes the standard terminology and proposes a metrics-based approach to evaluate the\nrelative risk associated with common SCADA vulnerabilities and guide risk reduction efforts.\nSection three discusses several ways to categorize vulnerabilities found in NSTB assessments,\nand presents the relative frequency of vulnerabilities observed in NSTB assessments using each\nof these categorizations. Section four presents NSTB detailed vulnerability assessment findings\nand recommended mitigations with references to further related security information. Finally,\nsection five summarizes general security recommendations for SCADA developers and\nadministrators to help mitigate the risk posed by common vulnerabilities found in NSTB SCADA\ncybersecurity assessments.\n\n**Method of investigation**\n\nThe NSTB assessment process is highly flexible and is tailored to the mutual interests of the\nindustry partner and the NSTB program. The granularity of report findings depends on the nature\nof the problem, the time allocated for that target, and how widespread the problem is. More\ninformation about the NSTB assessment methodology is provided in Appendix A, “NSTB\nAssessment Methodology.” The following summary describes the main aspects of the process\nused for conducting the NSTB vulnerability assessments involved in this report:\n\n    - SCADA product assessments targeted core components using typical attack vectors to\nidentify and understand the vulnerabilities they may be most affected by, and how their\ndesign and operational requirements could affect host and network security. The assessments\nfocused on vulnerabilities that were inherent in the product, and were therefore representative\nof installed systems. Configuration and password findings were reported only if they were\nrepresentative of production system settings. Network architecture and firewall rules were\nonly assessed if they were provided as recommended configurations.\n\n    - Production SCADA assessments (i.e., onsite assessments) concentrated on the aspects of the\nSCADA that the system owner is able to control, such as secure configurations and layers of\ndefense. The assessment team only performed penetration testing on disconnected backup or\ndevelopment systems.\n\n    - NSTB report findings are mapped to software weakness types defined by the Common\nWeakness Enumeration (CWE) to the extent possible. Findings are reported as CWEs so that\nSCADA vendors and owners can refer to the CWE for additional guidance in identifying,\nmitigating, and preventing weaknesses that cause vulnerabilities.[9]\n\nIn this report, we introduce a standard metrics-based approach to evaluate the relative risk\nassociated with common SCADA vulnerabilities. We used the Common Vulnerability Scoring\n\n\n-----\n\nSystem Version 2 (CVSS) and CWE methodologies to apply standard terminology and metricsbased scores to common SCADA vulnerabilities.\n\nWhile it is not possible to quantify an absolute measurement of risk, it can be useful to apply\na formal, structured process that characterizes relative risk associated with a particular\nvulnerability taking into account the environment within which that vulnerability exists. The\nCVSS metrics evaluate vulnerabilities so that higher risk vulnerabilities can be mitigated first,\nusing mitigations that reduce CVSS scores, and the risk these scores reflect, the most. This report\nrecommends mitigations that reduce risk of cyber-attack and will consequently lower CVSS\nscores in SCADA installations where these mitigations are implemented.\n\nIn appendix C, we have scored each of the ten vulnerabilities identified by SANS, The Top\nCyber Security Risks,[1] according to the CVSS process. We used input values to the CVSS\nmetrics that we found to be the most common values observed in NSTB assessments to create a\ngeneric score.\n\nIt is important to recognize that the generic CVSS scores found in Appendix C do not\ndescribe the risk to a particular SCADA configuration because each system installation is unique\nand the same vulnerability in different environments poses different risks. Technical mitigations,\noperating procedures and cybersecurity policies in place in different operational environments\nwill result in different, in some cases very different, CVSS scores.\n\n**Key findings: common SCADA vulnerabilities identified in NSTB assessments**\n\nThe NSTB has seen a significant improvement in operating system (OS) and network security\nsince 2003. Some improvement has been observed in reducing host exposure by reducing the\nnumber of available ports and services on SCADA hosts and in vulnerability remediation and\nsecure development of new products. However, vulnerabilities caused by less secure coding\npractices can be found in new and old products alike, and the introduction of Web applications\ninto SCADA systems has created more, as well as new, types of vulnerabilities. The 10 most\nsignificant cybersecurity risks identified during NSTB software and production SCADA\nassessments are listed in Table EX-1.\n\nTable EX-1. Ten common vulnerabilities identified in NSTB assessments.\n\n|Common vulnerability|Reason for concern|\n|---|---|\n|Unpatched published known vulnerabilities|Most likely attack vector|\n|Web Human-Machine Interface (HMI) vulnerabilities|Supervisory control access|\n|Use of vulnerable remote display protocols|Supervisory control access|\n|Improper access control (authorization)|SCADA functionality access|\n|Improper authentication|SCADA applications access|\n|Buffer overflows in SCADA services|SCADA host access|\n\n\n-----\n\n|Common vulnerability|Reason for concern|\n|---|---|\n|SCADA data and command message manipulation and injection|Supervisory control access|\n|SQL injection|Data historian access|\n|Use of standard IT protocols with clear-text authentication|SCADA host access|\n|Unprotected transport of application credentials|SCADA credentials gathering|\n\n\n**Recommendations for mitigating vulnerabilities identified in NSTB assessments**\n\nNSTB assessments identify and analyze SCADA system vulnerabilities that could allow\nunauthorized access to SCADA hosts, applications, and data, or unauthorized manipulations that\naffect operations, that spoof or manipulate SCADA data and commands or that impose a DoS that\ncould impede communications and jeopardize SCADA functionality. Recommended mitigations,\norganized according to the location of the vulnerability within the energy delivery control system\narchitecture, include:\n\n    - **The SCADA cyber-attack surface is protected through secure code and removal of**\nunneeded ports and services. The attack surface comprises all possible avenues of attacking a\nsystem. All open ports, installed services and applications that can potentially be exploited\ncreate the attack surface. Recommendations:\n\no Design and implement secure code to protect against vulnerabilities, such as buffer\noverflow, structured query language (SQL) injection, cross-site scripting (XSS), and\ndirectory traversal\n\n� Replace potentially dangerous functions with safe counterparts\n\n� Validate input data\n\no Minimize the number of open ports, installed services and applications\n\n    - **Known vulnerabilities are mitigated through effective patch management and removal of**\nunneeded applications and services. New vulnerabilities in computer applications and\nservices are found every day. Some are published shortly after their discovery. Others are\nkept a close secret by those who discover them. These remain unpatched and can be exploited\nat will by their discoverers. Recommendations:\n\no Implement effective patch management\n\no Remove all unneeded applications and services\n\n    - **Communication channel vulnerabilities are mitigated through protected transmission of**\nauthentication credentials, secure control of local and remote access and SCADA data\nintegrity checks. As SCADA systems become increasingly connected to company intranets\nand to the external Internet, they can also become more exposed to cyber attack. SCADA\ncommunication channels may use common IT communication protocols that provide\ncommon IT functionality in SCADA systems, as well as SCADA communication protocols to\ntransmit SCADA data and command messages. They often connect different network security\n\n\n-----\n\nzones and may have access rights and functionality to manipulate the SCADA system.\nRecommendations:\n\no Rigorously protect authentication credentials during transmission\n\no Implement secure communications practices in utilization of common IT protocols for\nlocal and remote access\n\no Detect data corruption or manipulation by performing SCADA data integrity checks that\nare designed to prevent recalculation\n\no Consider the benefits and challenges of implementing data encryption for SCADA\nsystems\n\n- **Communication endpoint vulnerabilities are mitigated through secure coding practices that**\nenforce rigorous input data validation in SCADA and ICCP services, database applications\nand web services. Network services at communication end-points listen for messages to\naccept, and can be exposed to attacks that exploit input and output validation vulnerabilities\nto gain unauthorized access to their host. Recommendations:\n\no Implement secure coding practices that enforce rigorous input data validation in SCADA\nand ICCP services, database applications, and web services\n\n- **Authentication vulnerabilities are mitigated through authentication at both the server and**\nthe client, and effective management of authentication credentials. Authentication is the act\nof validating the identity of a person or a process requesting access, and is used to enforce\naccess controls. Recommendations:\n\no Implement authentication at both the server and the client\n\no Manage authentication credentials, that is, change default passwords, use strong\npasswords, implement an effective password policy, and rigorously protect authentication\ncredentials\n\n- **Authorization vulnerabilities are mitigated through least-privileges access control, removal**\nof unneeded functionality and secure configuration of SCADA components. Authorization is\nthe act of validating access rights through controls that restrict access to entities in a network,\nhost, or software system and can be incorporated into SCADA components to help prevent\nand contain compromise. If an attacker gains full access to a host, all functions that the server\ncan execute can be under the attacker’s control. In addition, host access gives the attacker\naccess to the resources of the compromised server, including communications with other\ndevices and servers. Recommendations:\n\no Implement least-privilege access control\n\no Limit functionality only to that required, which enables the ability to implement\nleast-privilege access control\n\no Implement a secure design of SCADA components that compartmentalizes\nfunctionality\n\n- **Network access vulnerabilities are mitigated through network segmentation, strong firewall**\nrules that enforce secure connections across security zones and intrusion detection. Attackers\ncan search for vulnerabilities in firewalls, routers, and switches and use those to gain access\nto sensitive data and target networks, redirect traffic on a network to a malicious or\ncompromised system masquerading as a trusted system, and to intercept and alter information\nduring transmission. Recommendations:\n\n\n-----\n\no Segment networks\n\no Implement strong firewall rules\n\no Secure connections across security zones\n\no Implement intrusion detection\n\no Implement secure access to network devices\n\n**Next Steps**\n\nThe security of SCADA systems used in critical energy infrastructure installations throughout\nthe United States relies on a cooperative effort between SCADA product vendors and the owners\nof critical infrastructure assets. These recommendations can be used by SCADA vendors to\ndeliver and support systems that are able to survive attack without compromising critical\nfunctionality, by SCADA integrators to configure their systems securely before they are put into\nproduction, and by SCADA owners to perform due diligence in procuring, configuring, securing,\nand protecting these energy delivery control systems.\n\n\n-----\n\n#### ACKNOWLEDGEMENT\n\nThis document was developed for the U.S. Department of Energy to provide a methodology\nfor industry to apply an industry standardized metrics approach to vulnerability classification for\nenergy sector control systems. This document was made possible by the exceptional technical\nexpertise and sincere dedication of May Chaffin.\n\n\n-----\n\n-----\n\n#### CONTENTS\n\n1. INTRODUCTION .............................................................................................................................. 1\n\n2. PRIORITIZE COMMON SCADA VULNERABILITIES ................................................................ 6\n2.1 SCADA and the Common Vulnerability Scoring System ....................................................... 6\n2.2 SCADA cybersecurity risk reduction ....................................................................................... 9\n\n3. CATEGORIZE COMMON SCADA VULNERABILITIES ........................................................... 11\n3.1 Relative frequency of NSTB observed vulnerabilities by type .............................................. 12\n3.1.1 Assessment targets associated with each vulnerability type ..................................... 12\n3.2 Relative frequency of NSTB observed vulnerabilities by SCADA component .................... 13\n3.3 Relative frequency of observed vulnerabilities by SCADA component function ................. 14\n3.4 Relative frequency of observed vulnerabilities by SCADA architecture functionallevel ........................................................................................................................................ 15\n\n4. NSTB ASSESSMENT RESULTS ................................................................................................... 17\n4.1 Secure the cyber-attack surface .............................................................................................. 17\n4.1.1 Design and implement secure code ........................................................................... 17\n4.1.2 Minimize ports and services ..................................................................................... 25\n4.2 Known vulnerabilities ............................................................................................................ 26\n4.2.1 Minimize applications and services .......................................................................... 27\n4.2.2 Implement effective patch management ................................................................... 27\n4.2.3 Recommendations and resources .............................................................................. 29\n4.3 Communication channel vulnerabilities ................................................................................. 30\n4.3.1 Common IT protocols in SCADA systems ............................................................... 30\n4.3.2 SCADA data and command message communication protocols .............................. 32\n4.3.3 Protect SCADA data and command messages against man-in-the-middle .............. 37\n4.4 Communication endpoint vulnerabilities ............................................................................... 38\n4.4.1 SCADA and ICCP services ....................................................................................... 38\n4.4.2 Database applications and services ........................................................................... 41\n4.4.3 Web applications and services .................................................................................. 43\n4.4.4 Recommendations and resources .............................................................................. 44\n4.5 Authentication vulnerabilities ................................................................................................ 46\n4.5.1 Perform authentication at both the server and the client ........................................... 47\n4.5.2 Manage authentication credentials ............................................................................ 47\n4.5.3 Recommendations and resources .............................................................................. 51\n4.6 Authorization vulnerabilities .................................................................................................. 52\n4.6.1 Restrict privileges, permissions and access to the least needed ................................ 53\n4.6.2 Remove unnecessary functionality ........................................................................... 55\n4.6.3 Secure SCADA component configuration ................................................................ 55\n4.6.4 Recommendations and resources .............................................................................. 56\n4.7 Network access control vulnerabilities .................................................................................. 56\n4.7.1 Secure network device access ................................................................................... 57\n4.7.2 Secure network architecture ...................................................................................... 57\n4.7.3 Monitor network to detect intrusion .......................................................................... 63\n4.7.4 Recommendations and resources .............................................................................. 65\n\n\n-----\n\n4.8 SCADA Vulnerabilities Summary ......................................................................................... 66\n\n5. ADDITIONAL SCADA SECURITY RECOMMENDATIONS ..................................................... 68\n5.1 Recommendations for SCADA vendors to improve product security ................................... 68\n5.1.1 Create a Security Culture .......................................................................................... 69\n5.1.2 Enhance SCADA Test Suites .................................................................................... 70\n5.2 Secure SCADA Installation and Maintenance for Owners/Operators ................................... 71\n5.2.1 Restrict Physical Access to SCADA Network and Devices ..................................... 72\n\n6. CONCLUSION ................................................................................................................................ 74\n\n7. REFERENCES ................................................................................................................................. 76\n\nA-1. Reporting Methodology .................................................................................................................... 81\n\nB-1. CVSS VERSION 2.0 METRICS ..................................................................................................... 84\n\nC-1. Most Likely Access Vector: Unpatched Published Vulnerabilities.................................................. 94\n\nC-2. Supervisory Control Access: Web HMI Vulnerabilities .................................................................. 98\n\nC-3. Supervisory Control Access: Use of Vulnerable Remote Display Protocols ................................. 107\n\nC-4. Access to SCADA Functionality: Improper Access Control (Authorization) ................................ 115\n\nC-5. Access to SCADA Applications: Improper Authentication ........................................................... 123\n\nC-6. SCADA Host Access: Buffer Overflows in SCADA Services ...................................................... 129\n\nC-7. Supervisory Control Access: SCADA Data and Command Message Manipulation and\nInjection .......................................................................................................................................... 138\n\nC-8. Data Historian Access: SQL Injection ............................................................................................ 144\n\nC-9. SCADA Host Access: Use of Standard IT Protocols with Clear-text Authentication ................... 149\n\nC-10. SCADA Credentials Gathering: Unprotected Transport of SCADA Application Credentials ...... 155\n\nC-11. SCADA Environmental Security Requirements ............................................................................ 160\n\nC-12. Summary of SCADA Common Vulnerability Evaluation ............................................................. 162\n\n#### FIGURES\n\nFigure 1. Percentage of NSTB assessment findings by vulnerability type ................................................. 12\n\nFigure 2. Percentage of NSTB assessment findings by SCADA component category .............................. 14\n\nFigure 3. Percentage of NSTB assessment findings by component function ............................................. 14\n\nFigure 4. Percentage of NSTB assessment findings by SCADA architecture functional-level .................. 15\n\nFigure 5. ISA SCADA architecture by functional-level reference model .................................................. 16\n\n\n-----\n\nFigure 6. Example of an SQL injection attack via Web applications ......................................................... 22\n\nFigure 7. Percentage of unpatched components NSTB assessments found integrated into SCADA\nsystems........................................................................................................................................ 29\n\nFigure 8. Sample ICCP network ................................................................................................................. 39\n\nFigure 9. Recommended defense-in-depth SCADA architecture ............................................................... 62\n\nFigure 10. Replicated data server ................................................................................................................ 63\n\nFigure C-1. Operator screens are remotely displayed from HMI LAN. ................................................... 108\n\nFigure C-2. Operator screens are remotely displayed from a remote network. ........................................ 109\n\n#### TABLES\n\nTable EX-1. Ten common vulnerabilities identified in NSTB assessments. ............................................... v\n\nTable 1. Ten common vulnerabilities identified in NSTB assessments ........................................................ 1\n\nTable 2. CVSS Base-metrics. ........................................................................................................................ 7\n\nTable 3. CVSS Temporal-metrics. ................................................................................................................ 8\n\nTable 4. CVSS Environmental-metrics. ........................................................................................................ 9\n\nTable 5. Actions for SCADA vendors to reduce vulnerability scores ........................................................ 10\n\nTable 6. Actions for SCADA owners to reduce vulnerability scores ......................................................... 10\n\nTable 7. Types of vulnerabilities, and associated assessment targets that could allow access to\ncore SCADA functionality ......................................................................................................... 13\n\nTable 8. Common vulnerabilities associated with insecure SCADA code design and\nimplementation. .......................................................................................................................... 19\n\nTable 9. Five of the 2010 most dangerous programming errors related to buffer overflows. .................... 21\n\nTable 10. Common vulnerabilities associated with insecure common IT communications\nprotocols ..................................................................................................................................... 31\n\nTable 11. Common vulnerabilities found in software used by SCADA for remote access to\nsupervisory control functions. .................................................................................................... 31\n\nTable 12. Common vulnerabilities associated with transmission of unprotected SCADA\nauthentication credentials ........................................................................................................... 33\n\nTable 13. Common vulnerabilities associated with the historian database ................................................. 42\n\nTable 14. Common vulnerabilities associated with Web services .............................................................. 44\n\nTable 15. OWASP and CWE Web security resources ................................................................................ 46\n\nTable 16. Common vulnerabilities associated with bypass of HMI authentication .................................... 47\n\nTable 17. Common vulnerabilities associated with lack of SCADA application authentication ................ 49\n\nTable 18. Common vulnerabilities associated with weak password requirements. .................................... 50\n\nTable 19. Common vulnerabilities associated with weak protection of user authentication\ncredentials ................................................................................................................................... 51\n\n\n-----\n\nTable 20. Common vulnerabilities associated with network device configuration .................................... 57\n\nTable 21. Common vulnerabilities associated with insecure network design ............................................. 58\n\nTable 22. Common vulnerabilities associated with unnecessary exposure from firewall rules .................. 61\n\nTable 23. Common vulnerabilities associated with external communications. .......................................... 63\n\nTable 24. Common vulnerabilities not mitigated by perimeter defenses .................................................... 67\n\nTable A-1. Generic SCADA security assessment targets. .......................................................................... 81\n\nTable B-1. CVSS v2 Base scoring metrics. ................................................................................................ 84\n\nTable B-2. CVSS v2 Temporal scoring metrics.......................................................................................... 85\n\nTable B-3. CVSS v2 environmental scoring metrics. ................................................................................. 86\n\nTable C-1. Top 10 most critical SCADA vulnerabilities. ........................................................................... 91\n\nTable C-2. Most critical SCADA vulnerability attributes. ......................................................................... 92\n\nTable C-3. Lowering risk due to the probability of a vulnerability being exploited. .................................. 93\n\nTable C-4. Lowering risk due to the potential impact of vulnerability exploitation. .................................. 93\n\nTable C-5. Summary of unpatched published vulnerabilities’ security characteristics. ............................. 94\n\nTable C-6. Generic CVSS v2 score for published vulnerabilities. ............................................................. 95\n\nTable C-7. CVSS v2 Remediation Level metric values. ............................................................................. 97\n\nTable C-8. Lowering risk due to the probability of a known vulnerability being exploited. ...................... 97\n\nTable C-9. Lowering risk due to the potential impact of known vulnerability exploitation. ...................... 98\n\nTable C-10. Summary of SCADA Web application security characteristics. ............................................ 99\n\nTable C-11. Generic CVSS v2 score for SCADA Web application vulnerabilities. .................................. 99\n\nTable C-12. Web HMI CVSS v2 Access Complexity scenarios. ............................................................. 100\n\nTable C-13. Web HMI CVSS v2 Authentication scenarios. ..................................................................... 101\n\nTable C-14. Web HMI CVSS v2 Integrity Requirement scenarios. ......................................................... 102\n\nTable C-15. Web HMI CVSS v2 Availability Requirement scenarios. .................................................... 103\n\nTable C-16. Web HMI vulnerability CVSS v2 Exploitability scenarios. ................................................. 104\n\nTable C-17. Web HMI vulnerability CVSS v2 Remediation Level scenarios. ......................................... 104\n\nTable C-18. Web HMI vulnerability CVSS v2 Report Confidence scenarios. ......................................... 105\n\nTable C-19. Lowering risk due to the probability of a Web application or server being exploited. ......... 106\n\nTable C-20. Lowering risk due to the potential impact of Web application or server exploitation. ......... 106\n\nTable C-21. Summary of remote display protocols’ security characteristics. .......................................... 107\n\nTable C-22. Generic CVSS v2 score for the use of remote display protocols on SCADAs. .................... 109\n\nTable C-23. SCADA remote display vulnerabilities CVSS v2 Access Vector scenarios. ........................ 110\n\nTable C-24. SCADA remote display vulnerabilities CVSS v2 Access Complexity scenarios. ................ 111\n\nTable C-25. SCADA remote display vulnerabilities CVSS v2 Authentication scenarios. ....................... 111\n\nTable C-26. SCADA remote display vulnerabilities CVSS v2 Exploitability scenarios. ......................... 113\n\n\n-----\n\nTable C-27. Lowering risk due to the probability of a remote display protocol being exploited. ............ 114\n\nTable C-28. Lowering risk due to the potential impact of remote display protocol exploitation. ............ 114\n\nTable C-29. Summary of Improper Access Control security characteristics. ........................................... 116\n\nTable C-30. Generic CVSS v2 score for least user privileges violations. ................................................ 116\n\nTable C-31. Improper SCADA access control CVSS v2 Access Vector scenarios. ................................. 117\n\nTable C-32. Improper SCADA access control CVSS v2 Access Complexity scenarios. ......................... 118\n\nTable C-33. Improper SCADA access control CVSS v2 Authentication scenarios. ................................ 119\n\nTable C-34. Improper SCADA access control CVSS v2 Remediation Level scenarios. ......................... 121\n\nTable C-35. Lowering risk due to the chance of authorization mechanism exploitation. ......................... 122\n\nTable C-36. Lowering risk due to the potential impact of SCADA authorization exploitation. ............... 122\n\nTable C-37. Summary of improper authentication to SCADA applications security characteristics. ...... 124\n\nTable C-38. Generic CVSS v2 score for improper authentication to SCADA applications. .................... 124\n\nTable C-39. Improper SCADA authentication CVSS v2 Access Vector scenarios. ................................. 125\n\nTable C-40. Improper SCADA authentication CVSS v2 Access Complexity scenarios. ......................... 126\n\nTable C-41. Improper SCADA authentication CVSS v2 Exploitability scenarios. .................................. 127\n\nTable C-42. Improper SCADA authentication CVSS v2 Remediation Level scenarios. ......................... 128\n\nTable C-43. Lowering risk due to the chance of SCADA authentication mechanism exploitation. ......... 128\n\nTable C-44. Lowering risk due to the potential impact of SCADA authentication exploitation. ............. 129\n\nTable C-45. Summary of buffer overflow characteristics. ........................................................................ 130\n\nTable C-46. CVSS v2 score for buffer overflow vulnerabilities in SCADA protocol server\napplications. .............................................................................................................................. 131\n\nTable C-47. SCADA service buffer overflow CVSS v2 Access Complexity scenarios. .......................... 132\n\nTable C-48. SCADA service buffer overflow CVSS v2 Authentication scenarios. ................................. 132\n\nTable C-49. SCADA service buffer overflow CVSS v2 Confidentiality Impact scenarios. ..................... 133\n\nTable C-50. SCADA service buffer overflow CVSS v2 Integrity Impact scenarios. ............................... 133\n\nTable C-51. SCADA service buffer overflow CVSS v2 Availability Impact scenarios. .......................... 134\n\nTable C-52. SCADA service buffer overflow CVSS v2 Exploitability metric value. .............................. 135\n\nTable C-53. SCADA service buffer overflow CVSS v2 Remediation Level scenarios. .......................... 136\n\nTable C-54. Lowering risk due to the probability of a buffer overflow being exploited. ......................... 137\n\nTable C-55. Lowering risk due to the potential impact of buffer overflow exploitation. ......................... 137\n\nTable C-56. Summary of vulnerable SCADA network protocols’ security characteristics. ..................... 138\n\nTable C-57. Generic CVSS v2 score for SCADA protocol vulnerabilities. ............................................. 140\n\nTable C-58. SCADA protocol traffic manipulation and injection CVSS v2 Access Vector\nscenarios. .................................................................................................................................. 140\n\nTable C-59. SCADA protocol traffic manipulation and injection CVSS v2 Access Complexity. ........... 141\n\n\n-----\n\nTable C-60. SCADA protocol traffic manipulation and injection CVSS v2 Authentication\nscenarios. .................................................................................................................................. 141\n\nTable C-61. SCADA protocol traffic manipulation and injection CVSS v2 Impact metric values. ......... 142\n\nTable C-62. SCADA protocol traffic manipulation and injection CVSS v2 Exploitability\nscenarios. .................................................................................................................................. 143\n\nTable C-63. SCADA protocol traffic manipulation and injection CVSS v2 Remediation Level. ............ 143\n\nTable C-64. Lowering risk of SCADA protocols being exploited. ........................................................... 143\n\nTable C-65. Lowering potential impact of SCADA protocol exploitation. .............................................. 144\n\nTable C-66. Summary of SQL injection characteristics. .......................................................................... 145\n\nTable C-67. Generic CVSS v2 score for Data Historian SQL injection. .................................................. 146\n\nTable C-68. SCADA SQL injection CVSS v2 Access Vector scenarios. ................................................. 146\n\nTable C-69. SCADA SQL injection CVSS v2 Access Complexity scenarios. ......................................... 147\n\nTable C-70. SCADA SQL injection CVSS v2 Remediation Level scenarios. ......................................... 148\n\nTable C-71. Lowering risk due to the chance of SQL injection exploitation in SCADA\napplications. .............................................................................................................................. 148\n\nTable C-72. Lowering risk due to the potential impact of SQL injection exploitation. ............................ 149\n\nTable C-73. Summary of clear-text authentication protocols’ security characteristics. ........................... 150\n\nTable C-74. Generic CVSS v2 score for the use of clear-text authentication protocols on\nSCADAs. .................................................................................................................................. 150\n\nTable C-75. Clear-text IT authentication CVSS v2 Access Vector scenarios. ......................................... 151\n\nTable C-76. Clear-text IT authentication CVSS v2 Access Complexity and Authentication values. ...... 151\n\nTable C-77 Clear-text IT authentication CVSS v2 Impact metric values. ................................................ 152\n\nTable C-78. Clear-text IT authentication CVSS v2 Exploitability metric values. .................................... 153\n\nTable C-79. Clear-text IT authentication CVSS v2 Remediation Level scenarios. .................................. 153\n\nTable C-80. Lowering risk due to the probability of a clear-text authentication protocol being\nexploited. .................................................................................................................................. 154\n\nTable C-81. Lowering risk due to the potential impact of clear-text authentication protocols. ................ 154\n\nTable C-82. Unprotected transport of SCADA application credentials summary. ................................... 155\n\nTable C-83. Generic CVSS v2 score for unprotected transport of SCADA application credentials. ....... 156\n\nTable C-84. Unprotected transport of SCADA credentials CVSS v2 Access Vector scenarios. .............. 157\n\nTable C-85. Unprotected transport of credentials Access Complexity and Authentication values. ......... 157\n\nTable C-86. Unprotected transport of SCADA credentials CVSS v2 Impact metric values. ................... 158\n\nTable C-87. Unprotected transport of credentials CVSS v2 Exploitability and Report Confidence\nvalues. ....................................................................................................................................... 159\n\nTable C-88. Unprotected transport of SCADA credentials CVSS v2 Remediation Level scenarios. ...... 159\n\nTable C-89. Lowering risk of unprotected transport of SCADA application credentials being\nexploited. .................................................................................................................................. 159\n\n\n-----\n\nTable C-90. Lowering potential impact of the unprotected transport of SCADA application\ncredentials. ................................................................................................................................ 160\n\nTable C-91. SCADA scenarios for each of the CVSS v2 Confidentiality Requirement metric\nvalues. ....................................................................................................................................... 161\n\nTable C-92. SCADA scenarios that fit each of the CVSS v2 Integrity Requirement metric values. ....... 161\n\nTable C-93. SCADA scenarios that fit each of the CVSS v2 Availability Requirement metric\nvalues. ....................................................................................................................................... 162\n\n\n-----\n\n#### ACRONYMS\n\nACL Access Control List\n\nAPI Application Programming Interface\n\nARP Address Resolution Protocol\n\nASVS Application Security Verification Standard\n\nCAPEC Common Attack Pattern Enumeration and Classification\n\nCVSS v2 Common Vulnerability Scoring System Version 2.0\n\nCWE Common Weaknesses Enumeration\n\nDMZ Demilitarized Zone\n\nDNP3 Distributed Network Protocol Version 3\n\nDNS Domain Name System\n\nDOE Department of Energy\n\nDOE-OE Department of Energy-Office of Electricity Delivery and Energy Reliability\n\nDoS Denial of Service\n\nEMS Energy Management System\n\nFTP File Transfer Protocol\n\nHMI Human-Machine Interface\n\nHTML Hypertext Markup Language\n\nHTTP Hypertext Transfer Protocol\n\nHTTPS Hypertext Transfer Protocol over Secure Socket Layer\n\nICCP Inter-Control Center Communications Protocol\n\nICS Industrial Control System\n\nIDS Intrusion Detection Systems\n\nIKE Internet Key Exchange\n\nINL Idaho National Laboratory\n\nIP Internet Protocol\n\nIPSec Internet Protocol Security\n\nIT Information Technology\n\nLAN Local Area Network\n\nLM Windows LAN Manager\n\nMAC Media Access Control\n\nMitM Man-in-the-Middle\n\nNIST National Institute of Standards and Technology\n\nNSTB National Supervisory Control and Data Acquisition Test Bed\n\n\n-----\n\nNTLM Windows NT LAN Manager\n\nNTP Network Time Protocol\n\nOLE Object Linking and Embedding\n\nOPC Object Linking and Embedding (OLE) for Process Control\n\nOS Operating System\n\nOWASP Open Web Application Security Project\n\nSAMM Software Assurance Maturity Model\n\nSANS SysAdmin, Audit, Network, Security\n\nSCADA Supervisory Control and Data Acquisition System\n\nSDL Security Development Lifecycle\n\nSDLC Software Development Life Cycle\n\nSQL Structured Query Language\n\nSSH Secure Shell\n\nSSL Secure Sockets Layer\n\nTASE.2 Tele-control Application Service Element 2.0\n\nURL Universal Resource Locator\n\nUS-CERT United States Computer Emergency Readiness Team\n\nVLAN Virtual Local Area Network\n\nVPN Virtual Private Network\n\nXSS Cross-site Scripting\n\n\n-----\n\n#### 1. INTRODUCTION\n\nThe U.S. Department of Energy (DOE) established the National Supervisory Control and\nData Acquisition (SCADA) Test Bed (NSTB) program to assist industry and government in\nimproving the security of Supervisory Control and Data Acquisition/Energy Management\nSystems (SCADA/EMS, hereafter referred to as SCADA) used in the nation’s critical energy\ninfrastructures. The NSTB program is funded and directed by the DOE Office of Electricity\nDelivery and Energy Reliability (DOE-OE).\n\nThroughout the developed world, governments, defense\nindustries, and companies in finance, power, and\ntelecommunications are increasingly targeted by overlapping\nsurges of cyber attacks from criminals and nation-states seeking\neconomic or military advantage.[1]\n\nThe DOE-OE NSTB program, established in 2003, supports national laboratory, academia,\nand industry collaborative research and development activities that strengthen our Nation’s\nenergy sector cybersecurity posture, and reduce the risk of cyber-attack against the computers and\nnetworks that control energy delivery. A key part of the program is SCADA system vulnerability\nanalysis that identifies and provides mitigation approaches for vulnerabilities that could put these\nsystems at risk of a cyber attack. A cybersecurity vulnerability is a weakness in a computing\nsystem that can result in harm to the system or its operation, especially when this weakness is\nexploited by a hostile actor or is present in conjunction with particular events or circumstances.\nThese weaknesses are not usually a problem unless exploited by a cyber attack.\n\nThe NSTB has seen a significant improvement in operating system (OS) and network security\nsince 2003. Some improvement has been observed in reducing host exposure by reducing the\nnumber of available ports and services on SCADA hosts and in vulnerability remediation and\nsecure development of new products. However, vulnerabilities caused by less secure coding\npractices can be found in new and old products alike, and the introduction of Web applications\ninto SCADAs has created more, as well as new, types of vulnerabilities.\n\nThis report presents vulnerabilities at a high level to provide awareness of the common\nSCADA security vulnerability areas without divulging product-specific information.\nVulnerabilities that could be used as part of an attack against an SCADA are consolidated into\ngeneric common SCADA vulnerabilities. Even though SCADA functions, designs, and\nconfigurations vary among vendors, versions, and installations, their vulnerabilities and defensive\nrecommendations are quite similar at a high level. The 10 most significant cybersecurity risks\nidentified during NSTB software and production SCADA assessments. These are listed in Table\n1.\n\nTable 1. Ten common vulnerabilities identified in NSTB assessments\n\n|Common vulnerability|Reason for concern|\n|---|---|\n|Unpatched published vulnerabilities|Most likely attack vector|\n|Web Human-Machine Interface (HMI) vulnerabilities|Supervisory control access|\n|Use of vulnerable remote display protocols|Supervisory control access|\n|Improper access control (authorization)|SCADA functionality access|\n\n\n-----\n\n|Common vulnerability|Reason for concern|\n|---|---|\n|Improper authentication|SCADA applications access|\n|Buffer overflows in SCADA services|SCADA host access|\n|SCADA data and command message manipulation and injection|Supervisory control access|\n|SQL injection|Data historian access|\n|Use of standard IT protocols with clear-text authentication|SCADA host access|\n|Unprotected transport of application credentials|SCADA credentials gathering|\n\n\n**The NSTB SCADA vulnerability assessment process**\n\nThe NSTB assessment process is highly flexible and may be tailored to the mutual interests\nof the industry partner and the NSTB program. SCADA product assessments focus on\nvulnerabilities that are inherent in the product, and are therefore representative of installed\nsystems. The reporting standard is to only report configuration and password findings if they are\nrepresentative of production system settings. Network architecture and firewall rules are only\nassessed if they are provided as recommended configurations.\n\nThe attacker must be able to access the SCADA to do harm. From a cybersecurity\nperspective, this means that they must create an attack path from their attack computer to the\nSCADA. An attack could potentially start from any point between the Internet and the physical\nequipment that the SCADA is monitoring. Layers of defense are necessary for protection against\nmultiple threat vectors.\n\nAny computer that is connected to the Internet, directly or indirectly, is a potential risk for an\nattack from viruses or external attackers. An attack initiated from the Internet must create a path\nto the SCADA network. The number of possible paths to the target is the system’s exposure.\nSCADAs are generically exposed to attack through connections to the corporate network for\nbusiness functions, connections to peers (i.e., ICCP connections), connections to remote sites,\nremote access allowed to vendors, system administrators and operators, and connections to field\nequipment. Insider threats have a shorter attack path based on their access level.\n\nProduction SCADA assessments (i.e., onsite assessments) concentrate on the aspects of the\nSCADA that the system owner is able to control, such as secure configurations and layers of\ndefense. The assessment team only performs penetration testing on disconnected backup or\ndevelopment systems.\n\nThe SCADA network administrators review and discuss production network diagrams,\nACLs, firewall rules, and IDS signatures with the assessment team. They can then perform handson assessments of SCADA and network component configurations together. This includes a\nreview and tour of the production system to help identify through documentation, observation,\nand conversation any possible security problems with the production system and network\nconfiguration without putting the operational (production) system at risk. This is a learning\nopportunity for both the assessment team and the asset owner personnel.\n\n\n-----\n\nThe NSTB approach has always been to assess SCADA security and educate vendors and\nowners on how they can make their systems more secure. The granularity of report findings\ndepends on the nature of the problem, the time allocated for that target, and how widespread the\nproblem is. For example, some NSTB SCADA security assessments identified general security\nproblems, such as the use of insecure C functions, and then demonstrated that they could be\nexploited by creating an exploit for at least one example of the problem. The wording used in\nreports for this type of finding is similar to:\n\nBuffer overflow in the specified application allows a remote\nattacker to execute arbitrary code and gain full control of the ICS\nhost it runs on. This is caused by the use of insecure C functions\nsuch as strcpy, etc. Other buffer overflow vulnerabilities were\nidentified in this and other applications. Replace all instances of\ndangerous C functions with their safe alternatives.\n\nNSTB report findings are mapped to software weakness types defined by the CWE to the\nextent possible. Findings are reported as CWEs to aid in the understanding of SCADA\nvulnerabilities. SCADA vendors and asset owners can refer to the CWE for additional guidance\nin identifying, mitigating, and preventing weaknesses that cause vulnerabilities.[9]\n\nThe common weaknesses in this report are similar security weaknesses found on two or more\nunique SCADA configurations. Findings that mapped to very specific CWEs are reported as a\nhigher level CWE that describes multiple similar weaknesses. Weaknesses are then categorized in\nvarious ways to illustrate when they were created and the types of SCADA components they were\nfound in.\n\nMore information about the NSTB assessment methodology is provided in Appendix A,\n“NSTB Assessment Methodology.” The typical process includes the following sequence:\n\n1. Establish agreement that defines the working relationship (scope, personnel, equipment,\nfacilities, cost sharing) and ensures protection of sensitive information\n\n2. Work with partner to establish goals or assessment targets\n\n3. Obtain equipment and training from the industry partner\n\n4. Set up equipment with support from the industry partner\n\n5. Perform assessment to identify cyber vulnerabilities\n\n6. Provide detailed assessment report to industry partner\n\n7. Issue information suitable for public release to Web sites, conferences, and users' groups.\n\n**Responsible sharing of non-attributable information**\n\nA key objective of the NSTB program is to share relevant information obtained through\nsecurity assessments with potentially impacted industry stakeholders, with an emphasis on asset\nowners and users. However, it is recognized that much of the information obtained in assessments\nis business sensitive to the industry partner whose system or technology has been assessed. The\nprogram works with the industry partner to determine what information obtained or derived from\nthe assessment process is appropriate for disclosure outside the partnership and to identify an\nappropriate format and forum for disclosure. NSTB does not release attributable information\nwithout written concurrence of the industry partner.\n\n\n-----\n\n**Characterize risk using the Common Vulnerability Scoring System Version 2**\n\nDOE-OE supported and participated in development of the Roadmap to Secure Control\n_Systems in the Energy Sector, published in January 2006 and updated in the 2011 Roadmap to_\n_Achieve Energy Delivery System Cybersecurity. The roadmap development effort was a_\ncollaboration of asset owners, vendors, government, national laboratories, and members from\nvarious energy sector organizations. One of the four main goals outlined in the roadmap is to\n“Measure and Assess Security Posture.” The goal is that “Companies should thoroughly\nunderstand their current security posture to determine system vulnerabilities and the actions\nrequired to address them.” One of the mid-term milestones (2–5 years) is “Common metrics\navailable for benchmarking security posture.” The INL NSTB program previously published\ncommon vulnerability reports in 2006 and 2008. Vulnerabilities common to the control systems\nevaluated by the INL NSTB program were detailed in those reports with mitigation information\nprovided to help utilities and vendors develop and implement cybersecurity strategies and\nimplementations.\n\nIn the present report, we introduce a standard metrics-based approach to evaluate the relative\nrisk associated with common SCADA vulnerabilities. We used the Common Vulnerability\nScoring System Version 2 (CVSS) and Common Weakness Enumeration methodologies to apply\nstandard terminology and metrics-based scores to common SCADA vulnerabilities.\n\nWhile it is not possible to quantify an absolute measurement of risk, it can be useful to apply\na formal, structured process that characterizes relative risk associated with a particular\nvulnerability taking into account the environment within which that vulnerability exists. The\nCVSS metrics evaluate vulnerabilities so that higher risk vulnerabilities can be mitigated first,\nusing mitigations that reduce CVSS scores, and the risk these scores reflect, the most.\n\nIn appendix C, we have scored each of the ten common vulnerabilities identified by SANS,\nThe Top Cyber Security Risks[1], according to the CVSS process. We used input values to the\nCVSS metrics that we found to be the most common values observed in NSTB assessments. This\ncreates a generic score for each of the ten most common vulnerabilities.\n\nThe generic CVSS scores found in Appendix C do not describe the risk to a particular\nSCADA configuration because each system installation is unique and the same vulnerability in\ndifferent environments poses different risks. Technical mitigations, operating procedures and\ncybersecurity policies in place in different operational environments will result in different, in\nsome cases very different, CVSS scores.\n\nThis report recommends mitigations that reduce risk of cyber-attack and will consequently\nlower CVSS scores in SCADA installations where these mitigations are implemented. These\ntools allow a qualitative analysis of the vulnerabilities found in control systems by INL\nresearchers and are applied in this report to help vendors and asset owners evaluate their relative\nrisk profile associated with vulnerabilities that apply to their systems and reference additional\nsecurity information on reducing this risk.\n\nSCADA system security priorities and obstacles are different from those of common IT\ncomputers and networks. SCADA systems cannot be evaluated using common IT security\nassessment techniques or protected using common IT security solutions. The main goal of\nSCADA cybersecurity is to prevent unauthorized manipulation of the physical system under\ncontrol. Secondary goals are the availability and integrity of system state data and control\ncommands. Protecting the physical system and its data from malicious manipulation requires\nprotection mechanisms in each of the many networks, applications, and hosts that make up the\nSCADA system. There is no single solution that can completely secure the SCADA system from\ncyber attack, so this defense-in-depth approach is needed.\n\n\n-----\n\nSCADA system cybersecurity measures protect system data and functionality from\nunauthorized access, use, disclosure, disruption, modification, or destruction by preventing\nactions that violate security goals for data confidentiality, integrity, and availability of cyber\nassets. In this respect, SCADA systems and common IT computers and networks share\ncybersecurity objectives,\n\n- Protect confidentiality of private information\n\n- Ensure availability of information to authorized users on a timely basis\n\n- Protect the integrity of information (i.e., accuracy, reliability, and validity).\n\nHowever, SCADA systems prioritize cybersecurity objectives differently depending on the\nphysical system under control and the functionality provided by the individual SCADA\ncomponent.\n\nThis version of this document differs from a released draft version in that it clearly highlights\nactions that can be performed by SCADA vendors and owners to reduce the risk to the most\nsignificant weakness areas identified through NSTB assessments. The goal of NSTB assessments\nis to identify the most significant security vulnerabilities in SCADA products and production\ninstallations and provide guidance in remediating these risks. NSTB assessment reports provide\nspecific and detailed recommendations to the SCADA vendor or owner for addressing the\nsecurity vulnerabilities found in their systems. This report addresses common vulnerabilities and\nsecurity weaknesses that are routinely identified during NSTB SCADA security assessments. The\ngoal of this document is to share this information with the rest of the industry so that all energy\nstakeholders can use this information to identify and mitigate vulnerabilities in their systems.\n\nIn the next section of this document, section two, we describe how CVSS metrics evaluate\nrisk associated with common SCADA vulnerabilities and guide risk reduction efforts. Next,\nsection three discusses several ways to categorize vulnerabilities found in NSTB assessments, and\npresents the relative frequency of vulnerabilities using each of these categorizations. Section four\npresents NSTB detailed vulnerability assessment findings and recommended mitigations with\nreferences to further related security information. Finally, section five summarizes\nrecommendations for SCADA developers and administrators to help mitigate the risk posed by\ncommon vulnerabilities found in NSTB SCADA security assessments.\n\n\n-----\n\n#### 2. PRIORITIZE COMMON SCADA VULNERABILITIES\n\nThe most significant vulnerabilities identified in SCADA systems are those that allow\nunauthorized control of the physical system. Compromise of the SCADA system’s availability\nand ability to function correctly may also have significant consequences to the control systems\nand physical infrastructure it manages. Security efforts are made most effective by addressing the\nhigh consequence and high threat vector vulnerabilities first.\n\nThis report uses The Common Vulnerability Scoring System, version 2 (CVSS) vulnerability\nscoring methodology prioritizes common SCADA system vulnerabilities. The goal of CVSS\nmetrics is to provide “an open framework for communicating the characteristics and impacts of\nIT vulnerabilities.”[2] This standardized scoring system accounts for the consequence of\ncompromise of a vulnerable SCADA component(s), and also the level of risk due to available\nexploit techniques and mitigations. CVSS metrics provide a standard way to prioritize\nvulnerabilities according to the relative risk they pose to the SCADA system.\n\nSection 2.1 describes CVSS and its application to SCADA. The following section 2.2 shows\nhow CVSS scores appropriately tailored to the unique configuration of a particular SCADA\nsystem are used to evaluate and mitigate vulnerabilities to reduce risk.\n\n#### 2.1 SCADA and the Common Vulnerability Scoring System\n\nThe Common Vulnerability Scoring System (CVSS) provides an\nopen framework for communicating the characteristics and\nimpacts of Information Technology (IT) vulnerabilities. CVSS\nconsists of three groups: Base, Temporal, and Environmental.\nEach group produces a numeric score ranging from 0 to 10, and\na Vector, a compressed textual representation that reflects the\nvalues used to derive the score. The Base group represents the\nintrinsic qualities of vulnerability. The Temporal group reflects\nthe characteristics of vulnerability that change over time. The\nEnvironmental group represents the characteristics of\nvulnerability that are unique to any user’s environment.[2]\n\nThe Tables 2, 3, and 4 present the CVSS Base, Temporal and Environmental-metrics\nrespectively. Base-metrics describe an inherent characteristic of the vulnerability and are not\nunique to SCADA systems. Security vulnerabilities in individual software programs, network\nprotocols, or hardware have intrinsic characteristics described by the Base-metrics.\n\nThese same vulnerabilities also have characteristics that may change with time and depend on\nthe surrounding environment. These characteristics include varying potential impacts and ease of\nexploitability that depend on the type of system the vulnerability resides on and the protective\nmeasures that have been applied to that system. CVSS attempts to capture these important factors\nthrough Temporal and Environmental metrics and to provide a standard method for individual\nsystem owners to assess their unique risk to a particular vulnerability.\n\nFor instance, CVSS Base-metrics used to evaluate the potential consequences of a\ncompromise are Confidentiality Impact, Integrity Impact, and Availability Impact. These three\nBase-metrics characterize the direct effect that the vulnerability, if exploited, will have on an IT\nasset and are defined respectively as the degree of loss of confidentiality, integrity, and\navailability.\n\n\n-----\n\nHowever, the influence of a particular environment changes the risk represented by these\nBase-metrics. To describe impact for a particular environment, the Base-metrics are weighted and\nthe result is represented by the Security Requirement Environmental-metrics. Likewise, Collateral\nDamage Potential is the Environmental-metric that includes the potential physical and monetary\nimpacts in the risk equation.\n\nThe Base-metric scores that describe exploitability evaluate the probability of compromise by\nassessing the exposure, or difficulty in accessing the vulnerability. These are Access Vector,\nAccess Complexity, and Authentication. Temporal-metrics further refine this probability\nestimation based on the current offensive and defensive tools and techniques available as\ncharacterized by the Exploitability Temporal-metric. Finally, the Target Distribution\nEnvironmental-metric customizes the probability of exploitation on an individual SCADA\nsystem. As discussed further in section 4.2 on the mitigation of known vulnerabilities,\n\nInitially, real-world exploitation may only be theoretical.\nPublication of proof of concept code, functional exploit code, or\nsufficient technical details necessary to exploit the vulnerability\nmay follow. Furthermore, the exploit code available may\nprogress from a proof-of-concept demonstration to exploit code\nthat is successful in exploiting the vulnerability consistently. In\nsevere cases, it may be delivered as the payload of a networkbased worm or virus.[2]\n\nTable 2 summarizes the CVSS Base-metrics. Secure software development and system\nadministration practices can reduce the number of vulnerabilities on a SCADA system, and also\nreduce the severity assessed by the Base-metrics. Vendors can affect Base-metrics by following\nthe “principle of least privilege” when designing and implementing SCADA products. SCADA\ncomputer and network administrators may do the same on their installed systems, but can be\nlimited by vendor support restrictions and/or the potential risk to system availability.\n\nTable 2. CVSS Base-metrics.\n\n|Base Metric|Assessment Criteria|Scoring|\n|---|---|---|\n|Access Vector|How the vulnerability is exploited|The more remote an attacker can be to attack a host, the greater the vulnerability score|\n|Access Complexity|Complexity of the attack required to exploit the vulnerability once an attacker has gained access to the target system|The lower the required complexity, the higher the vulnerability score|\n|Authentication|Number of times an attacker must authenticate to a target to exploit a vulnerability|The fewer authentication instances that are required, the higher the vulnerability score|\n|Confidentiality Impact|Impact on confidentiality of a successfully exploited vulnerability|Increased confidentiality impact increases the vulnerability score|\n|Integrity Impact|Impact to integrity of a successfully exploited vulnerability|Increased integrity impact increases the vulnerability score|\n|Availability Impact|Impact to availability of a successfully exploited vulnerability|Increased availability impact increases the vulnerability score|\n\n\n-----\n\nTable 3 summarizes the CVSS Temporal-metrics. Temporal-metrics, like Base-metrics, are\ndirectly tied to the vulnerability, but unlike Base-metrics change over time as exploit techniques,\nas well as mitigation techniques, are developed and automated. SCADA owners can affect\nTemporal-metric scores by using available mitigations that may include patches, updates, and\ntemporary fixes from the software vendor, as well as unofficial patches or workarounds\ndeveloped by users. SCADA owners can apply, and in some cases create, workaround techniques\nto mitigate vulnerabilities on their systems that do not have a patch available or for which the\nofficial patch cannot be applied. A security obstacle for SCADA owners is the unavailability of\npatches for vulnerabilities in their SCADA software, or the inability to apply patches to thirdparty software. Temporal metrics provide scores for workaround mitigations to vulnerabilities\nthat do not have patches available. The effectiveness of the available work-around mitigations is\nused to adjust the Temporal score of the remaining vulnerabilities.\n\nFor instance, the Remediation Level Temporal-metric may not be valid for an installed\nsystem if the available patch or temporary fix cannot be applied without compromising SCADA\nfunctionality. If patch testing results indicate that a patch cannot be applied or the old version\ncannot be replaced with a secure version, then altering the SCADA product to accommodate the\npatch or otherwise mitigate the problem may become a top priority for the SCADA vendor\n(depending on the risk to which this vulnerability exposes the system). The scoring system\nprovides the selection - “Unavailable: There is either no solution available or it is impossible to\napply”[2] – to allow for this situation.\n\nTable 3. CVSS Temporal-metrics.\n\n**Temporal Metric** **Assessment Criteria** **Scoring**\nExploitability Current state of exploit The more easily a vulnerability can be\ntechniques or code exploited, the higher the vulnerability score\navailability\n\nRemediation Level of remediation The less official and permanent a fix, the\nLevel available higher the vulnerability score\n\nReport Degree of confidence in The more a vulnerability is validated by the\nConfidence the existence of the vendor or other reputable sources, the\n\nvulnerability and the higher the score\ncredibility of the known\ntechnical details\n\nTable 4 summarizes the CVSS Environmental-metric group that captures the characteristics\nof a vulnerability associated with a specific environment. The same vulnerability in different\nenvironments poses different risks to an organization and its stakeholders. Environmental-metrics\ncapture the risk that a vulnerability poses to the unique SCADA installation. These metrics reflect\nthe criticality of the affected component in its environment. As an example, denial of service\n(DoS) vulnerabilities in SCADA components that require higher availability in a particular\nenvironment will receive higher criticality scores. Security Requirements Environmental-metrics\nenable SCADA owners to customize the CVSS score depending on the importance of the affected\ncomponent to their own organization, measured in terms of confidentiality, integrity, and\navailability.\n\nSCADA vendors and owners can use these metrics to separate high-consequence\nvulnerabilities from those that are less significant in their SCADA environment, or to change\ntheir environments to reduce the potential impact that could result were these vulnerabilities to be\nexploited.\n\n|Temporal Metric|Assessment Criteria|Scoring|\n|---|---|---|\n|Exploitability|Current state of exploit techniques or code availability|The more easily a vulnerability can be exploited, the higher the vulnerability score|\n|Remediation Level|Level of remediation available|The less official and permanent a fix, the higher the vulnerability score|\n|Report Confidence|Degree of confidence in the existence of the vulnerability and the credibility of the known technical details|The more a vulnerability is validated by the vendor or other reputable sources, the higher the score|\n\n\n-----\n\nTable 4. CVSS Environmental-metrics.\n\n**Environmental**\n**Metric** **Assessment Criteria** **Scoring**\nCollateral Potential for loss of life or physical The greater the damage potential,\nDamage assets through damage or theft of the higher the vulnerability score\nPotential property or equipment\n\nTarget Proportion of vulnerable systems The greater the proportion of\nDistribution vulnerable systems, the higher the\n\nscore\nSecurity Importance of the affected IT asset to The greater the security\nRequirements a user’s organization, measured in requirement, the higher the score\n\nterms of confidentiality, integrity,\nand availability\n\nThe CVSS metrics were applied “generically” to evaluate the most significant vulnerabilities\nidentified during NSTB assessments. These “generic” scores were derived from the most\nrepresentative, prevalent, and persistent values, and are presented in Appendix C, “Top 10 Most\nCritical SCADA Vulnerabilities.”[2] It is important to note that actual CVSS scores are unique to\nindividual environments and must be customized to the particular vendor software or installed\nsystem. In this way, CVSS metrics can be used by SCADA vendors and owners to help prioritize\nsecurity risks for mitigation in their unique, individual environment.\n\nSCADA vendors and owners can use these scores as a starting point for vulnerability\nidentification and evaluation on their own systems. They can conduct internal and third-party\nassessments of their systems to identify vulnerabilities then use CVSS metrics to:\n\n1. Evaluate risk\n\n2. Prioritize remediation and mitigation efforts\n\n3. Evaluate risk reduction due to remediation and mitigation efforts.\n\nThe following section explores how SCADA vendors and owners can evaluate and reduce\nrisk in the context of CVSS metrics tailored to their unique, individual environment. Additional\ninformation on CVSS criticality scoring is in Appendix B, “Vulnerability Scoring,” and at the\nCVSS Web site.[2] Owners and developers can review generic CVSS scores for ten of the most\ncommon and critical SCADA security vulnerabilities in Appendix C, and consider the mitigations\ndiscussed there as options for lowering risk.\n\n#### 2.2 SCADA cybersecurity risk reduction\n\nThe ultimate goal of security activities is to reduce risk. Business risk is a function of threat,\nimpact/consequence, and vulnerability[3], that is, the consequence that would result if a threat\nsuccessfully exploited a vulnerability, and the probability that this could take place. It can be\nthought of as “the relative impact that an exploited vulnerability would have to a user’s\nenvironment.”[2] Understanding exposure to attack, attacker awareness of the vulnerability, and\nexploitation knowledge helps to assess the probability of a successful attack. To reduce risk,\nreduce the probability that a threat can exploit a vulnerability, and reduce the consequences that\nwould follow if this did occur.\n\nCVSS provides a qualitative analysis tool for vulnerability analysts, vendors and control\nsystem users to characterize their cybersecurity risk profile. Tables 5 and 6 list examples of how\nSCADA vendors and owners, respectively, can reduce the CVSS scores for their products.\n\n|Environmental Metric|Assessment Criteria|Scoring|\n|---|---|---|\n|Collateral Damage Potential|Potential for loss of life or physical assets through damage or theft of property or equipment|The greater the damage potential, the higher the vulnerability score|\n|Target Distribution|Proportion of vulnerable systems|The greater the proportion of vulnerable systems, the higher the score|\n|Security Requirements|Importance of the affected IT asset to a user’s organization, measured in terms of confidentiality, integrity, and availability|The greater the security requirement, the higher the score|\n\n\n-----\n\nTable 5. Actions for SCADA vendors to reduce vulnerability scores\n\n**CVSS** **Section of this report where this**\n**Action that can reduce CVSS score**\n**metric** **is discussed**\n\nSecure development practices Section 4.1.1 Design and\n\nimplement secure code\n\nApply the concept of least privileges to compartmentalize Section C-3 Supervisory Control\nand limit the privileges of all users and Access: Use of vulnerable remote\n\nBase\n\nservices/applications display Protocols\n\nSection 4.1.1.3 Design and\n\nTest software for weaknesses vulnerable to common implement secure code\nexploit techniques (and remediate)\n\nRapid patch testing for third-party patches Section 4.2.2 Implement effective\nProvide publicly-accessible contacts for reporting patch management\nsecurity issues within products and services (e.g., a\n“/security” URL directly and prominently accessible\nfrom the vendor main Web page with contact information\nand disclosure policies)\n\nSection 4.2.2 Implement effective\n\nTemporal: Rapid patch development\n\npatch management\n\nRemediation\nLevel\n\nSupport security products and techniques\n\n4.3.2.4 SCADA data and\n\nUse and support strong authentication and encryption\n\ncommand message\n\nmechanisms\n\ncommunication protocols\n\nProvide detailed documentation of necessary\n\n4.1.2.2 Minimize ports and\n\ncommunications between SCADA components to enable\n\nservices\n\ndevelopment of specific firewall and IDS rules.\n\nTable 6. Actions for SCADA owners to reduce vulnerability scores\n\n|CVSS metric|Action that can reduce CVSS score|Section of this report where this is discussed|\n|---|---|---|\n|Base|Secure development practices Apply the concept of least privileges to compartmentalize and limit the privileges of all users and services/applications Test software for weaknesses vulnerable to common exploit techniques (and remediate)|Section 4.1.1 Design and implement secure code Section C-3 Supervisory Control Access: Use of vulnerable remote display Protocols Section 4.1.1.3 Design and implement secure code|\n|Temporal: Remediation Level|Rapid patch testing for third-party patches Provide publicly-accessible contacts for reporting security issues within products and services (e.g., a “/security” URL directly and prominently accessible from the vendor main Web page with contact information and disclosure policies) Rapid patch development Support security products and techniques Use and support strong authentication and encryption mechanisms Provide detailed documentation of necessary communications between SCADA components to enable development of specific firewall and IDS rules.|Section 4.2.2 Implement effective patch management Section 4.2.2 Implement effective patch management 4.3.2.4 SCADA data and command message communication protocols 4.1.2.2 Minimize ports and services|\n\n|CVSS Metric|Action that can reduce CVSS score|Section of this report where this is discussed|\n|---|---|---|\n|Temporal: Remediation Level|Establish security function to monitor user groups and vendor announcements for release of security and vulnerability notifications Rapid patch testing and deployment Identify and apply work-around mitigations for vulnerabilities that cannot be patched Restrict SCADA user privileges to only those required Use and support strong authentication and encryption mechanisms Protect critical functions Create and deploy specific firewall and IDS rules Closely monitor critical functions as well as security and operational logs for signs of abnormal/exceptional activity.|Section 4.2.2 Implement effective patch management Section 4.2.2 Implement effective patch management (unpatched vulnerabilities) Section 5.2 Secure SCADA Installation and Maintenance for the Owners/Operators|\n\n\n-----\n\n#### 3. CATEGORIZE COMMON SCADA VULNERABILITIES \n\nCommon SCADA vulnerabilities can be categorized in different ways to support different\nanalytic objectives. The first step in the NSTB vulnerability assessment process is to identify the\nAssessment Targets (AT) and involves a collaborative effort between vendor representatives and\nINL researchers. ATs are points of entry, processes, protocols, and/or pieces of equipment that if\ncompromised could result in a severe impact on the control system. A typical vulnerability\nassessment project on a SCADA control system includes approximately 900-1000 hours of cyber\nresearcher effort to evaluate the selected ATs. The team selects ATs reflecting what is considered\n“low hanging fruit” or more vulnerable targets.\n\nThe scope of vulnerabilities identified in this report is limited to the selected ATs, and to the\ncontrol systems selected for NSTB assessments. It is important to note that the relative\nfrequencies presented here do not necessarily reflect those that would be observed if all ATs, on\nall control systems operating in the “real world” were represented.\n\nSCADA systems are comprised of components including process equipment, process control\nhardware, network equipment, and computers. SCADA component products include software,\nhardware, firmware, and network equipment built to support supervisory control and data\nacquisition.\n\nSCADA component function provides operational functionality of the system. Physical\nequipment can be monitored and controlled through connections to basic control devices. These\ndevices are computer hardware running a minimalistic operating system referred to as firmware,\ncreated by a SCADA vendor.\n\nSupervisory control software is installed on traditional computer hardware and operating\nsystems. The system that software runs on is referred to as its host. Supervisory control software\ntypically comprises multiple applications and can be installed on multiple computer hosts. The\nsupervisory control host computers, control hardware, and equipment under control are all\nconnected using networking equipment, which may include common IT computer network\nprotocols and devices, as well as computer network protocols and devices created specifically for\nSCADA systems.\n\nSCADA systems can be categorized into operational zones such as shown in Figure 5, ISA\nSCADA architecture functional-level reference model. This model separates the overall system\narchitecture into levels starting at the monitored and controlled physical device to the I/O\n(input/output) Network (level 0) through several zones to the Corporate Network (level 4). The\nmain focus of the NSTB vulnerability assessment project has been in the level 2 Supervisory\nControl LAN with some work in the Level 1 and 3 zones.\n\nThis section presents the relative frequency of SCADA vulnerabilities observed in NSTB\nassessments, categorized by:\n\n- Section 3.1: Vulnerability type, with a discussion of associated attack paths\n\n- Section 3.2: SCADA component\n\n- Section 3.3: SCADA component function\n\n- Section 3.4: SCADA architecture functional-level\n\n\n-----\n\n#### 3.1 Relative frequency of NSTB observed vulnerabilities by type \n\nFigure 1 shows the relative frequency of vulnerabilities found in NSTB assessments,\ncategorized by vulnerability type.\n\nAn understanding of the way in which we counted vulnerabilities is needed for meaningful\ninterpretation of the relative frequency distributions shown here. For instance, there are many\nmore buffer overflow (and similar) type vulnerabilities than the other kinds of vulnerabilities\nshown. Consider that fifty buffer overflows found in an application represent fifty attack vectors,\nand are counted as one vulnerability. A single way to bypass authentication is also counted as one\nvulnerability. Improper authentication or no authentication found for an application is counted as\none vulnerability (maybe more if there are multiple ways to authenticate or steps taken in the\nauthentication process); however, there can be many buffer overflow or other input validation\nvulnerabilities in that application.\n\nIn the SCADA environment a single vulnerability can be much more critical or far-reaching\nthan others. For instance, a communication channel vulnerability in a SCADA protocol affects\nthe whole system, but is counted as a single vulnerability. CVSS environmental scoring takes this\ninto consideration.\n\n**Prevalence of Common NSTB SCADA Vulnerability Categories**\n\n**11%** **7%**\n\n**8%**\n\n**8%**\n\nPublished Vulnerabilities (7%)\n\nUn‐Published Vulnerabilities (8%) **7%** **16%**\n\nCommunication Channel Vulnerabilities (16%)\n\nCommunication Endpoint Vulnerabilities (43%)\n\nSCADA Authentication Vulnerabilities (7%)\n\nAuthorization Vulnerabilities (8%) **43%**\n\nSCADA Network Access Control Vulnerabilities (11%)\n\nFigure 1. Percentage of NSTB assessment findings by vulnerability type\n\n##### 3.1.1 Assessment targets associated with each vulnerability type\n\nNSTB assessments prioritize assessment targets based on the likelihood and impact of\ncompromise as determined through the combined experience of the assessment team and the\nSCADA vendor and/or owner. Table 7 shows SCADA vulnerability types and associated\nassessment targets that could allow access to core SCADA functionality.\n\n\n**11%** **7%**\n\n**8%**\n\n**8%**\n\n**7%** **16%**\n\n\n-----\n\nTable 7. Types of vulnerabilities, and associated assessment targets that could allow access to\ncore SCADA functionality\n\n**Vulnerability**\n**Assessment Target Category** **Source of Vulnerability**\n**Type**\n\nUnpatched Or Old Versions Of Third\nKnown Party Applications Incorporated Into\nMost Likely Attack Paths\nVulnerabilities SCADA Products\n\nUnpatched OS on SCADA Hosts\n\nExcessive SCADA Host Exposure\n\nUn-Published Potential 0-day and\n\nThrough Unnecessary Services\n\nVulnerabilities Unpatched Vulnerabilities\n\nImproper SCADA Code Quality\n\nRemote Access Protocols Vulnerable to\n\nUnauthorized Access to\n\nCommunication Spoofing and MitM Attacks\n\nSCADA Functionality\n\nChannel\n\nthrough Vulnerable SCADA Protocols Vulnerable to\n\nVulnerabilities\n\nCommunication Channels Spoofing and MitM Attacks\n\nVulnerable Server Applications for\nSCADA Communication and Data\n\nCommunication Unauthorized Access to or\n\nTransfer Protocols\n\nEndpoint DoS of SCADA Hosts and\nVulnerabilities Applications Database Vulnerabilities\n\nWeb Vulnerabilities\n\nAuthentication Bypass Issues\n\nSCADA\n\nAccess to SCADA\n\nApplication\n\nApplications by Exploiting\n\nAuthentication\n\nAuthentication Mechanisms Credentials Management\n\nVulnerabilities\n\nSCADA Host\n\nAbility to Cause Harm from\n\nAuthorization Failure to Secure Host Environment\n\nan SCADA Account\n\nVulnerabilities\n\nImproper Network Design\n\nSCADA Access to SCADA Hosts and\n\nWeak Firewall Rules\n\nNetwork Functionality through\n\nFailure to Secure Network Devices\n\nVulnerabilities Available Network Paths\n\nImproper Network Monitoring\n\n#### 3.2 Relative frequency of NSTB observed vulnerabilities by SCADA component\n\nFigure 2 shows the relative frequency of vulnerabilities found in NSTB assessments,\ncategorized by SCADA component. Vulnerabilities in SCADA component products could allow\nan attacker to gather information about, disrupt, or manipulate SCADA operations. Figure 2\nshows that NSTB assessments have focused on SCADA component products to characterize the\nvulnerabilities they are most affected by, and evaluate ways in which their design and operational\nrequirements affect host and network security.\n\n|Vulnerability Type|Assessment Target Category|Source of Vulnerability|\n|---|---|---|\n|Known Vulnerabilities|Most Likely Attack Paths|Unpatched Or Old Versions Of Third- Party Applications Incorporated Into SCADA Products|\n|||Unpatched OS on SCADA Hosts|\n|Un-Published Vulnerabilities|Potential 0-day and Unpatched Vulnerabilities|Excessive SCADA Host Exposure Through Unnecessary Services|\n|||Improper SCADA Code Quality|\n|Communication Channel Vulnerabilities|Unauthorized Access to SCADA Functionality through Vulnerable Communication Channels|Remote Access Protocols Vulnerable to Spoofing and MitM Attacks|\n|||SCADA Protocols Vulnerable to Spoofing and MitM Attacks|\n|Communication Endpoint Vulnerabilities|Unauthorized Access to or DoS of SCADA Hosts and Applications|Vulnerable Server Applications for SCADA Communication and Data Transfer Protocols|\n|||Database Vulnerabilities|\n|||Web Vulnerabilities|\n|SCADA Application Authentication Vulnerabilities|Access to SCADA Applications by Exploiting Authentication Mechanisms|Authentication Bypass Issues|\n|||Credentials Management|\n|SCADA Host Authorization Vulnerabilities|Ability to Cause Harm from an SCADA Account|Failure to Secure Host Environment|\n|SCADA Network Vulnerabilities|Access to SCADA Hosts and Functionality through Available Network Paths|Improper Network Design|\n|||Weak Firewall Rules|\n|||Failure to Secure Network Devices|\n|||Improper Network Monitoring|\n\n\n-----\n\n**10%**\n**16%**\n\n**74%**\n\n\nFigure 2. Percentage of NSTB assessment findings by SCADA component category\n\n#### 3.3 Relative frequency of observed vulnerabilities by SCADA component function\n\nFigure 3 shows the relative frequency of vulnerabilities found in NSTB assessments,\ncategorized by SCADA component function. This provides insight into the system consequence\nwere the function to be compromised, and illustrates the high percentage of vulnerabilities that\nNSTB assessments found in SCADA server applications (services).\n\nThe distribution is skewed by the SCADA products that were selected for evaluation.\nSupervisory control protocols were available for assessment on almost all NSTB assessments. In\nthis report the representation of SCADA protocols that are used for external communications is\nskewed based on their availability for assessment. The Inter-Control Center Communications\nProtocol (ICCP) was selected for an in-depth assessment[5] while “basic” or “local” control\nprotocols like Distributed Network Protocol Version 3 (DNP3) were not configured on every\nassessed system.\n\n##### NSTB Assessment Findings by Component Functionality\n\n**4%** **3%**\n\nICCP Services and Protocol Stack (25%) **4%**\n\nSupervisory Control Protocol Services (17%) **5%** **25%**\n\nSCADA Hosts (16%) **5%**\n\nHistorian Database (8%) **6%**\n\nSupervisory Control Protocols (7%)\n\nControl Protocol Services (6%) **7%**\n\n**17%**\n\nNetwork Devices (5%)\n\n**8%**\n\nFirewall Rules (5%)\n\n**16%**\n\nWeb Services (4%)\n\nHMI (4%)\n\nControl Protocols (3%)\n\nFigure 3. Percentage of NSTB assessment findings by component function\n\n\n**4%** **3%**\n**4%**\n**5%** **25%**\n\n**5%**\n\n**6%**\n\n**7%**\n\n**17%**\n\n**8%**\n\n**16%**\n\n\n-----\n\n#### 3.4 Relative frequency of observed vulnerabilities by SCADA architecture functional-level\n\nFigure 4 shows the relative frequency of vulnerabilities found in NSTB assessments,\ncategorized by SCADA architecture functional-level using the ISA99 reference model, which is\nshown in Figure 5.[4] This model describes a SCADA system as a series of logical levels based on\nfunctionality. It is useful to categorize vulnerabilities by this established frame of reference.\n\nThe NSTB focus on core SCADA functionality is evident in Figure 4. Individual SCADA\ncomponents can be evaluated by the risk they contribute to the overall security of the system\nbased on their SCADA functionality. The largest portion of products and functionalities that\nNSTB tested belong in the supervisory control and operations management categories.\n\n### NSTB Assessment Findings by SCADA Function\n\n**5%** **10%**\n\nLevel 1: Local or Basic Control (10%)\n\nLevel 2: Supervisory Control (45%) **40%**\n\nLevel 3: Operations Management (40%)\n\n**45%**\n\nLevel 4: Enterprise Systems (5%)\n\nFigure 4. Percentage of NSTB assessment findings by SCADA architecture functional-level\n\n\n**5%** **10%**\n\n**40%**\n\n**45%**\n\n\n-----\n\nFigure 5. ISA SCADA architecture by functional-level reference model\n\n\n-----\n\n#### 4. NSTB ASSESSMENT RESULTS\n\nNSTB assessments identify and analyze SCADA system vulnerabilities that could allow\nunauthorized access to SCADA hosts, applications, and data, or unauthorized manipulations that\naffect operations, that spoof or manipulate SCADA data and commands or that impose a DoS that\ncould impede communications and jeopardize SCADA functionality. This section presents\ncommon vulnerabilities found in NSTB assessments, and recommends mitigations. First, it\ndiscusses ways to secure the SCADA cyber-attack surface through secure code and removal of\nunneeded ports and services. Then it describes:\n\n  - Known vulnerabilities mitigated through removal of all unneeded applications and\nservices and effective patch management.\n\n  - Communication channel vulnerabilities mitigated through protected transmission of\nauthentication credentials, secure control of local and remote access and SCADA data\nintegrity checks.\n\n  - Communication endpoint vulnerabilities mitigated through secure coding practices that\nenforce rigorous input data validation in SCADA and ICCP services, database\napplications and web services.\n\n  - Authentication vulnerabilities mitigated through authentication at both the server and the\nclient, and effective management of authentication credentials.\n\n  - Authorization vulnerabilities mitigated through least-privileges access control, removal\nof unneeded functionality and secure configuration of SCADA components.\n\n  - Network access vulnerabilities mitigated through network segmentation, strong firewall\nrules, secure connections across security zones and intrusion detection.\n\n#### 4.1  Secure the cyber-attack surface\n\nThe attack surface comprises all possible avenues of attacking a system. “A system’s attack\nsurface is the set of ways in which an adversary can enter the system and potentially cause\ndamage. Hence the smaller the attack surface, the more secure the system.”[8] All open ports,\ninstalled services and applications that can potentially be exploited create the attack surface. This\nsection first discusses the design and implementation of secure code to decrease the number of\nvulnerabilities that could be exploited. Then it addresses the need to minimize the number of open\nports, installed services and applications. This, in turn, will minimize the number of both known\nand existing but unknown vulnerabilities and further decrease the attack surface.\n\n##### 4.1.1 Design and implement secure code \n\nSecure coding practices minimize vulnerabilities in SCADA applications and services.\nInsecure coding practices can introduce bugs that could be exploited for malicious purposes and\ncould also make SCADA systems fragile, so that administrators may hesitate to implement\nchanges after the initial configuration.\n\nMany SCADA protocols and core applications were built before the rise of the Internet and\nbefore the concepts of secure design and coding practices became well established. These legacy\nSCADA systems were developed as stand-alone systems with reliability and efficiency the\nprimary design requirements. Many SCADA protocols and core applications still in use today\nwere developed before Internet connection became common practice. Although security is an\n\n\n-----\n\nadded requirement for many new SCADA applications, NSTB assessments have found that\ntoday’s systems share many of the same vulnerabilities in the design and coding principles as\nlegacy SCADA software.\n\nSCADA code review and reverse engineering exercises suggest that SCADA software may\nnot always be designed or implemented using secure software development concepts. SCADA\nsoftware vulnerabilities observed in NSTB assessments often result from insecure coding\npractices and inadequate testing. NSTB assessments revealed a common need to increase secure\ncoding practices. The three most common observations were the need to strengthen input\nvalidation, authentication, and access controls. Most of the SCADA vulnerabilities identified\nduring NSTB assessments that allow remote code execution result from the use of potentially\ndangerous functions. Adherence to secure programming standards and guidelines can strengthen\ncode against these vulnerabilities during software development and automated source code\nanalysis tools can identify existing vulnerabilities for remediation.\n\nThe NSTB code audits and fuzz testing revealed numerous potential vulnerabilities. It was\ninfeasible to investigate every unsafe function call and the cause of every crash to determine\nwhich among these could be exploited for malicious remote code execution. The NSTB\nassessment demonstrates the existence and impacts of at least one instance of unsafe coding then\nrecommends that unsafe function calls be remediated. As a result, these vulnerabilities may be\nunder-represented in this report.\n\nSCADA software vendors can conduct third-party security source code audits and then\nremediate the problems identified during the audits. Independent source code auditing can help\nensure quality and security in software products. An outside professional opinion of software\ndesign and implementation based on the actual source code and build process of the SCADA\nproduct can greatly enhance quality and security, or confirm the security of the product. In this\nway, SCADA vendors can thoroughly test all SCADA features to validate SCADA stability and\nsecurity levels before release, and SCADA customers can require products to be tested by a third\nparty and vulnerabilities remediated before acceptance of a SCADA product.\n\nSCADA software can have large, complex, and legacy codebases, SCADA operations require\nhigh availability and update scenarios are complicated. Unlike the standard off-the-shelf\ncomputer software model, the cost of security fixes, support, and maintenance has traditionally\nbeen transferred to the SCADA customer. With the new focus and requirements for SCADA\nsecurity, including SCADA product vulnerabilities starting to be publicly announced, vendors\nmay find code audits and associated code changes to be very cost effective in comparison to\nfixing individual vulnerabilities as they are publicly announced.\n\nSecure coding resources are available for all application types and languages. The CWE list[9]\nprovides information about all types of software weaknesses including the most common SCADA\nprogramming errors listed in Table 8.\n\n\n-----\n\nTable 8. Common vulnerabilities associated with insecure SCADA code design and\nimplementation.\n\n**Weakness**\n**Classification** **Common Vulnerability**\nCWE-19: Data Handling CWE-228: Improper Handling of Syntactically Invalid\n\nStructure\nCWE-229: Improper Handling of Values\nCWE-230: Improper Handling of Missing Values\nCWE-20: Improper Input Validation\nCWE-116: Improper Encoding or Escaping of Output\nCWE-195: Signed to Unsigned Conversion Error\nCWE-198: Use of Incorrect Byte Ordering\nCWE-119: Failure to CWE-120: Buffer Copy without Checking Size of Input\nConstrain Operations (“Classic Buffer Overflow”)\nwithin the Bounds of a\n\nCWE-121: Stack-based Buffer Overflow\n\nMemory Buffer\n\nCWE-122: Heap-based Buffer Overflow\nCWE-125: Out-of-bounds Read\nCWE-129: Improper Validation of Array Index\nCWE-131: Incorrect Calculation of Buffer Size\nCWE-170: Improper Null Termination\nCWE-190: Integer Overflow or Wraparound\nCWE-680: Integer Overflow to Buffer Overflow\nCWE-398: Indicator of CWE-454: External Initialization of Trusted Variables or Data\nPoor Code Quality Stores\n\nCWE-456: Missing Initialization\nCWE-457: Use of Uninitialized Variable\nCWE-476: NULL Pointer Dereference\nCWE-400: Uncontrolled Resource Consumption (“Resource\nExhaustion”)\nCWE-252: Unchecked Return Value\nCWE-690: Unchecked Return Value to NULL Pointer\nDereference\nCWE-772: Missing Release of Resource after Effective\nLifetime\nCWE-442: Web CWE-22: Improper Limitation of a Pathname to a Restricted\nProblems Directory (“Path Traversal”)\n\nCWE-79: Failure to Preserve Web Page Structure (“Cross-site\nScripting”)\nCWE-89: Failure to Preserve SQL Query Structure (“SQL\nInjection”)\nCWE-703: Failure to CWE-431: Missing Handler\nHandle Exceptional\n\nCWE-248: Uncaught Exception\n\nConditions\n\nCWE-755: Improper Handling of Exceptional Conditions\nCWE-390: Detection of Error Condition Without Action\n\n|Weakness Classification|Common Vulnerability|\n|---|---|\n|CWE-19: Data Handling|CWE-228: Improper Handling of Syntactically Invalid Structure|\n||CWE-229: Improper Handling of Values|\n||CWE-230: Improper Handling of Missing Values|\n||CWE-20: Improper Input Validation|\n||CWE-116: Improper Encoding or Escaping of Output|\n||CWE-195: Signed to Unsigned Conversion Error|\n||CWE-198: Use of Incorrect Byte Ordering|\n|CWE-119: Failure to Constrain Operations within the Bounds of a Memory Buffer|CWE-120: Buffer Copy without Checking Size of Input (“Classic Buffer Overflow”)|\n||CWE-121: Stack-based Buffer Overflow|\n||CWE-122: Heap-based Buffer Overflow|\n||CWE-125: Out-of-bounds Read|\n||CWE-129: Improper Validation of Array Index|\n||CWE-131: Incorrect Calculation of Buffer Size|\n||CWE-170: Improper Null Termination|\n||CWE-190: Integer Overflow or Wraparound|\n||CWE-680: Integer Overflow to Buffer Overflow|\n|CWE-398: Indicator of Poor Code Quality|CWE-454: External Initialization of Trusted Variables or Data Stores|\n||CWE-456: Missing Initialization|\n||CWE-457: Use of Uninitialized Variable|\n||CWE-476: NULL Pointer Dereference|\n||CWE-400: Uncontrolled Resource Consumption (“Resource Exhaustion”)|\n||CWE-252: Unchecked Return Value|\n||CWE-690: Unchecked Return Value to NULL Pointer Dereference|\n||CWE-772: Missing Release of Resource after Effective Lifetime|\n|CWE-442: Web Problems|CWE-22: Improper Limitation of a Pathname to a Restricted Directory (“Path Traversal”)|\n||CWE-79: Failure to Preserve Web Page Structure (“Cross-site Scripting”)|\n||CWE-89: Failure to Preserve SQL Query Structure (“SQL Injection”)|\n|CWE-703: Failure to Handle Exceptional Conditions|CWE-431: Missing Handler|\n||CWE-248: Uncaught Exception|\n||CWE-755: Improper Handling of Exceptional Conditions|\n||CWE-390: Detection of Error Condition Without Action|\n\n\n-----\n\n**_4.1.1.1_** **_Replace potentially dangerous functions with safe counterparts_**\n\nWell-known unsafe C/C++ functions - in particular unsafe string and memory functions - can\nbe replaced by safe counterparts and secured by proper input validation. For example, the strcpy\nfunction in C is a potentially dangerous function, and has a safe counterpart strncpy. Maliciously\nmalformed input to strcpy could create a buffer overflow and allow an attacker to execute remote\ncode.\n\nThe SCADA software developer is responsible for writing secure code that properly validates\nfunction input, and for replacing dangerous functions with their safe counterparts wherever\npossible. However, the prevalence of publicly announced buffer overflow vulnerabilities and\nother vulnerabilities exposed through malformed input, suggest that reliance on the software\ndeveloper to secure potentially dangerous functions can introduce high risk.\n\n**_4.1.1.2_** **_Validate input data_**\n\nInput data validation is used to ensure that the content provided to an application does not\ngrant an attacker access to unintended functionality or privilege escalation. Improper input\nvalidation is a high-level root cause of many types of vulnerabilities. All of the weaknesses in the\n_2010 CWE/SANS Top 25 Most Dangerous Programming Errors[10] can be associated with_\nimproper input validation. Like other software products, the most significant security weakness in\nSCADA is inadequate input validation. Many different kinds of input validation errors were\nidentified in NSTB assessments. Only the most significant ones are specifically addressed here in\nrelation to the SCADA system components most affected by them.\n\nNSTB assessments found that SCADA applications frequently suffer from coding practices\nthat could allow an adversary to use unexpected input data to modify program execution. A\nfunction that does not check the validity of input data can cause the application to crash or\nexecute malicious commands provided as input by an adversary. Software that does not properly\ncheck the size of user input, does not sanitize user input by filtering out unneeded but potentially\nmalicious character sequences, or does not initialize and clear variables properly could be\nvulnerable to remote compromise.\n\nAttackers can inject specific exploits, including buffer overflows, SQL injection attacks, and\nXSS code to gain control over vulnerable machines. An attacker may be able to impose a DoS,\nbypass authentication, access unintended functionality, execute remote code, steal data and\nescalate privileges. While some input validation vulnerabilities may not allow exploitation for\nremote access, they might still be exploited to cause a crash or a DoS attack.\n\nInput validation vulnerabilities were found in server applications written to process SCADA\nprotocol traffic. Most result in unauthorized access to the host on which the server was running.\nSanity checks of incoming messages can ensure that the lengths and counts seem reasonable, that\nthe data in the message is valid, and that the message is valid given the state of the connection.\nThe impact of these vulnerabilities can be reduced by limiting the server’s privileges. The\nattacker will inherit the rights of the exploited process, so it is recommended that least-privileges\nbe implemented so that service privileges are minimized as much as possible to reduce risk.\n\nWeak or missing security features in SCADA software leave the system components\nvulnerable to manipulation by any threats to which they are exposed. Giving each component of\nthe SCADA its own protection mechanisms can be a good defensive measure. As another layer of\ndefense, compiler protection options can be used when compiling C/C++ code to increase the\ndifficulty for an attacker to execute exploit code. This decreases the impact of vulnerability from\n\n\n-----\n\nan exploit that allows the attacker to run commands on the computer or use it as a launching point\nalong an attack path into the core of the SCADA to a DoS-type attack.\n\n**Protect against buffer overflow**\n\nSecure coding practices protect SCADA system software against buffer overflow\nvulnerabilities, which are the most common type of input validation weaknesses reported on\nNSTB assessments. Buffer overflows can be caused by programmer oversight and result when a\nprogram tries to write more data into a buffer than the space allocated in memory. The “extra”\ndata then overwrites adjacent memory, and ultimately results in abnormal operation of the\nprogram. A carefully planned and executed memory overwrite can cause the program to begin\nexecution of actual code submitted by the attacker. Exploit code can use the buffer overflow to\ncreate an interactive session and send malicious commands with the privileges of the exploited\nprogram.\n\nFor instance, secure coding practices advise against using the input value to determine the\nbuffer size. Even if values are never input directly by a user, sometimes data are not correctly\nformatted, and hardware or operating system protections are not always sufficient.\n\nBuffer overflows in applications that process network traffic can be exploited by intercepting\nand altering input values in transit. Consequently, network protocol implementations that do not\nvalidate input values can be vulnerable to buffer overflow attacks, so it is best to implement\nnetwork data bounds and integrity checking as well.\n\nAn application that calls a potentially dangerous function must properly validate input to that\nfunction or risk exposure of a buffer overflow vulnerability through an unsafe function call. For\nexample, the developer might assume that no one would ever create a username longer than 1,024\ncharacters. If he then reserves a 1024-byte memory buffer for the username and does not validate\ninput, an attacker could try a few usernames to discover that more than 1,024 characters creates a\nbuffer overflow and provides an avenue for attack. The developer can mitigate this vulnerability\nby validating that the size of the input does not exceed the size allocated for the memory buffer\nthat stores the input. Safe functions, such as strncpy require that the memory buffer size be\nspecified and eliminate this risk. As another example, the developer might assume that input such\nas array index values will always be bounded within an expected range. However, if negative or\nexceedingly large numbers can be input for array index values this could result in unexpected\nbehavior such as causing essential services to crash.\n\nFive of the 2010 SANS/CWE Top 25 Most Dangerous Programming Errors[10 ]are types of\nbuffer overflows. Table 9 lists CWE entries related to buffer overflows.[9]\n\nTable 9. Five of the 2010 most dangerous programming errors related to buffer overflows.\n\n**Rank** **Programming Error**\n3 [CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer](http://cwe.mitre.org/top25/index.html#CWE-120)\nOverflow')\n12 [CWE-805: Buffer Access with Incorrect Length Value](http://cwe.mitre.org/top25/index.html#CWE-805)\n15 [CWE-129: Improper Validation of Array Index](http://cwe.mitre.org/top25/index.html#CWE-129)\n16 [CWE-190: Integer Overflow or Wraparound](http://cwe.mitre.org/top25/index.html#CWE-190)\n18 [CWE-131: Incorrect Calculation of Buffer Size](http://cwe.mitre.org/top25/index.html#CWE-131)\n\n|Rank|Programming Error|\n|---|---|\n|3|CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')|\n|12|CWE-805: Buffer Access with Incorrect Length Value|\n|15|CWE-129: Improper Validation of Array Index|\n|16|CWE-190: Integer Overflow or Wraparound|\n|18|CWE-131: Incorrect Calculation of Buffer Size|\n\n\n-----\n\n**Protect against Structured Query Language (SQL) injection**\n\nSecure coding practices protect the SCADA historian database against SQL injection\nvulnerabilities, which result from incorrect or inadequate filtering of user input that does not\nassure the integrity of special elements used in an SQL query statement. For instance, if an\nattacker inserts literal escape characters into a database query, the attacker may gain arbitrary\nread or write access to the database. The SQL statements used to communicate with the database\ncould be modified to steal, corrupt, or otherwise change data in the database. Also, if SQL queries\nare used for security controls such as authentication, attackers could alter the logic of those\nqueries to bypass security.\n\nSQL injection vulnerabilities are accessible through client (often Web) applications. SQL\ninjection exploits the database by forwarding SQL commands to the database, where they are\nexecuted. If database-backed applications get and receive data from a server on a secure network,\nit is a target for SQL injection. For example, if a client application connects to a database on a\nsecure network through a Web server that is isolated in a DMZ (as shown in Figure 6), SQL\ninjection attacks the SQL server within the secure network. A successful compromise could give\nthe attacker control of the SQL server within the secure network, even if the firewall blocks all\nother connections to that host.\n\nFigure 6. Example of an SQL injection attack via Web applications\n\n**Protect against cross-site scripting**\n\nSecure coding practices protect SCADA system web applications and services against crosssite scripting vulnerabilities (XSS). The root cause of a XSS vulnerability is the same as that of an\nSQL injection, lack of input data validation. However, a XSS attack is unique in the sense that the\nWeb application itself unwittingly sends the malicious code to the user. According to the 2010\n_CWE/SANS Top 25 Most Dangerous Programming Errors[10] report, XSS is the most widespread_\nand critical programming error.[5] It is dangerous because it allows attackers to inject code into the\nWeb pages generated by the vulnerable Web application. Attack code is executed on the client\nwith the privileges of the Web server.\n\nCross-site scripting takes advantage of Web servers that return dynamically generated Web\npages or allow users to post viewable content to execute arbitrary Hypertext Markup Language\n(HTML) and active content such as JavaScript, ActiveX, and VBScript on a remote machine that\nis browsing the site within the context of a client-server session.\n\nMany XSS attacks rely on user interaction and typically take the form of a malicious link sent\nby the attacker. Users may be deceived into clicking on a link that appears to be associated with a\n\n\n-----\n\nknown, respected and trusted entity. In many cases, the attack can be launched without the victim\neven being aware of it. Attackers frequently use a variety of methods to encode the malicious\nportion of the attack, such as URL encoding or Unicode, so the request looks less suspicious even\nto careful users.\n\nIt is possible for an attacker to inject malicious script into a link and have a Web site return\nthe malicious script to the victim as though it was legitimate. The victim’s Web browser will then\nrun the malicious script, trusting it because it came from the server and potentially compromise\nthe victim’s computer by using one of many browser exploits. There are many such scenarios that\nallow for this behavior, all of which are caused by a lack of input data validation.\n\nOnce the malicious script is injected, the attacker can perform a variety of malicious\nactivities. The most common attack performed with XSS involves the disclosure of information\nstored in user cookies that may include session information. In this way, the attacker could\ntransfer private information from the victim’s machine to the attacker. Since the site requesting to\nrun the script has access to the cookies in question, the malicious script does also. XSS\nvulnerabilities can be exploited to: manipulate or steal cookies; create requests that can be\nmistaken for those of a valid user; compromise confidential information; execute malicious code\non the end user systems; redirect the Web page to a malicious location; hijack the client-server\nsession; exploit a vulnerability in the Web browser itself, possibly taking over the authorized\nSCADA Web client host; engage in network reconnaissance; install Trojan horse programs; plant\nbackdoor programs; run “Active X” controls (under Microsoft Internet Explorer) from sites the\nuser perceives as trustworthy; and modify content viewed by the user.\n\n**Protect against directory traversal**\n\nSecure coding practices protect SCADA system applications and services against directory\ntraversal vulnerabilities, which occur when file paths are not validated. A directory traversal\nvulnerability can occur when the software uses external input to construct a pathname that is\nintended to identify a file or directory located underneath a restricted parent directory but the\nsoftware does not properly neutralize special elements within the pathname so that the pathname\nresolves to a location outside of the restricted directory.[33.] Directory traversals are commonly\nassociated with Web applications, but all types of applications can have this class of vulnerability.\n\nThe attacker may be able to read, overwrite or create critical files such as programs, libraries,\nor important data by exploiting a directory traversal vulnerability. This may allow an attacker to:\nexecute unauthorized code or commands; read or modify files or directories; and crash, exit, or\nrestart critical files or programs, potentially causing a DoS.\n\nThe damage that a directory traversal vulnerability can cause is related to the permission of\nthe vulnerable application. If the vulnerable application has limited read/write permissions, the\nattacker may not be able to do anything of importance. However, if the application has system or\nroot privileges then the damages can be extensive.\n\n**_4.1.1.3_** **_Recommendations and resources_**\n\nTo find and remediate cyber-attack surface vulnerabilities, such as insecure code, input\nvalidation, buffer overflow, SQL injection, XSS, and directory traversal, it is recommended that:\n\n- All stakeholders follow secure development standards when developing new products\n\n- All stakeholders redesign or patch current products to remediate vulnerabilities\n\n\n-----\n\n- All stakeholders redesign SCADA-specific protocols to include strong authentication and\nintegrity checks\n\n- All stakeholders who write custom applications train developers in secure coding practices\n\n- Vendors follow secure coding best practices, such as\n\no Validate input and output data\n\no Use safe string and buffer functions\n\no Use robust integer operations and data types for memory operations\n\n- Vendors carefully test and evaluate internally developed and third-party application software:\n\no In all of their SCADA components that handle data from other components, starting with\nservices that are exposed to less-trusted networks and working inward\n\no During SCADA software development, including thorough code reviews via manual and\nautomated processes\n\no Using automated static analysis tools\n\no Using dynamic tools and techniques such as fuzz testing, robustness testing, and fault\ninjection\n\no Using a qualified third part that performs additional security testing\n\n- Owners work with vendors to explicitly address the security of SCADA products during the\nprocurement and acceptance processes\n\no Conduct a security audit of a SCADA product\n\no Determine appropriate mitigations to meet specified security levels\n\no Require and validate that products are delivered with secure configurations\n\n- Owners verify that third-party application software vendors have conducted detailed security\ntesting of their products\n\n- Owners verify that IT products deployed on the SCADA network pass a security review\n\nTo help prevent exploitation or limit damage from cyber-attack surface vulnerabilities, it is\nrecommended that additional precautions be implemented, such as:\n\n- Vendors, and possibly owners, thoroughly assess, secure and test SCADA products, starting\nwith the most exposed and powerful functions\n\n- Vendors use compiler options to detect some types of buffer overflows; however, an attack\ncould still cause a DoS, since the typical mitigation is to exit the application\n\n- Vendors and owners if possible, can use as part of a defense in depth solutions, a CPU and\nOS that offers protection against buffer overflow attacks\n\n- Owners identify critical components and develop corresponding risk analysis and mitigation\nstrategies for both operations and security\n\nSCADA vendors and owners can use this report for high-level information on common types\nof software vulnerabilities identified in SCADA systems. More detailed information is needed to\nimplement the software security recommendations. SCADA developers can reference the CWE\nsite for additional secure development information and references on security weaknesses that\nlead to vulnerabilities.[9] SCADA administrators can use this information to better understand\n\n\n-----\n\nSCADA software vulnerabilities. They can then work with their vendors to mitigate the\nassociated risks as much as possible in existing systems, and create procurement requirements\nthat enforce security standards.\n\nAll weaknesses listed on the 2010 CWE/SANS Top 25 Most Dangerous Programming\n_Errors[10] have been found during SCADA assessments. SCADA developers can refer to this list of_\nmore detailed weaknesses and the associated 2010 CWE/SANS Top 25: Monster Mitigations[11] for\nguidance in preventing the most dangerous programming errors.\n\nSecure coding guides and standards are available in a wide range of languages and software\ntypes. Some examples include:\n\n      - _CERT Secure Coding Standards[12]_\n\n      - SAFECode Secure Coding Standards[13,14]\n\n      - _[20 Critical Security Controls: Critical Control 7: Application Software Security[15]](http://www.sans.org/critical-security-controls/guidelines.php)_\n\n##### 4.1.2 Minimize ports and services\n\nServices or applications running on a system may open network ports to communicate with\nthe outside world. An attacker can only gain access to and receive information from the SCADA\nthrough an open port. Each open port provides a possible access path for an attacker that may be\nused to send exploits and receive data. If an attacker can remotely connect to services listening on\naccessible network ports, she then has a foothold onto the protected network, and can target all\nservices listening on the local network hosts because she has breached the perimeter controls. A\nvulnerable network application may be exploited by an attacker and used to send malicious code\nas well as receive unauthorized data.\n\nThe more services listening at open ports on the SCADA hosts, the more exposed the\nSCADA system is to attack. It is consequently of the utmost importance that only required\nservices and applications run on SCADA systems so that no ports are opened unnecessarily.\nHowever, SCADA vendors may not always provide enough documentation of required\ncomponent communications.\n\n**_4.1.2.1_** **_Identify necessary ports and services_**\n\nNSTB vulnerability assessments evaluated open ports and running services on vendorconfigured SCADA hosts and found that, in some cases, vendor- published ports and services did\nnot match those ports and services actually observed. Because the lists of required ports and\nservices have been found to disagree with delivered systems, SCADA owners can validate the\nnecessity of services installed on new systems before they are deployed.\n\nSCADA owners can monitor their own system traffic and create rules that describe their\nsystem’s behavior. This must be done with care to avoid overly restrictive rules that create the\nrisk of DoS for legitimate control traffic. In some cases communications cannot be blocked and\nsometimes communications require access between security zones. The design of the\ncommunication protocol determines the degree to which access to these services can be restricted.\nAnother concern is that some SCADA protocols require an excessive number of ports to be\nopened. For example, NSTB assessments found one service that required over 21,000 ports to be\nopened.\n\nTraffic monitoring between system components during all phases of acceptance testing can\nbe used to help identify required communications. Ideally this testing and verification of required\n\n\n-----\n\nports and services can be determined by the vendor during system design, then tested and verified\nby the owner/operator before operation. This technique may eliminate communications not\nrequired by a particular SCADA configuration. This can create a more secure system, if owners\nexercise all potential functionality to ensure that it will be available when needed.\n\nThis same process can be used with great care to minimize risk on an operational SCADA\nsystem. The service can first be moved onto a backup or development system to insulate the\nprimary system from potential damage. Before stopping any services or programs on an\noperational system, SCADA administrators can ask the vendor to confirm that the service is not\nneeded for system functionality. The administrator can also create an IDS rule that watches for\nthe use of installed services until there is sufficient confidence that a service is not necessary. In\naddition, IDS logs and system logs may also inform administrators when requested services are\nnot available. Finally, it is necessary to employ monitoring systems that ensure removed or\ndisabled services are not re-installed or re-enabled.\n\n**_4.1.2.2_** **_Recommendations and resources_**\n\nTo minimize the cyber-attack surface, such as possible access paths in unnecessary ports and\nservices, it is recommended that:\n\n    - Vendors create a secure configuration\n\no Restrict the ports, installed services and applications used to support their systems to the\nminimum necessary\n\no Identify and disable all OS or third-party application services not explicitly needed for\nthe SCADA to operate\n\n    - Vendors identify and document\n\no All OS or third-party application dynamic port services and respective port ranges\n\no The services needed by each SCADA component and the port ranges that each needed\nservice uses, and also explicitly identify each device that is allowed to initiate a\nconnection with one of these ports\n\n    - Vendors include ports and services documentation and secure configuration as part of the\nproduct deliverable\n\n    - Owners create a secure network architecture\n\no Use vendors’ documentation and secure configuration\n\no Validate the necessity of services installed before they are deployed\n\no Remove unneeded applications and services with great care\n\no Owners document the way SCADA system components use the network so that effective\nfirewall and IDS rules can be created\n\n#### 4.2 Known vulnerabilities\n\nKnown vulnerabilities in common IT products installed on SCADA hosts have a high\nprobability of being attacked and may provide an attack path into the system using publically\navailable exploit code. While the NSTB has taken care to inform only the responsible SCADA\nvendors of vulnerabilities identified in their products, other security researchers are starting to\n\n\n-----\n\nannounce SCADA vulnerabilities in more open forums. “Public availability of easy-to-use exploit\ncode increases the number of potential attackers by including those who are unskilled, thereby\nincreasing the severity of the vulnerability.”[2 ]\n\nNew vulnerabilities in computer applications and services are found every day. Some are\npublished shortly after their discovery. Others are kept a close secret by those who discover them.\nThese remain unpatched and can be exploited at will by their discoverers. They may not result in\ndirect control of the SCADA, but may help provide an attack path into the system for external\nattackers as well as malicious insiders. The NSTB SCADA assessments use publically available\ntools to identify and develop mitigations for publically known vulnerabilities. This section\ndiscusses mitigation of known vulnerabilities through removal of all unneeded applications and\nservices, and effective patch management.\n\n##### 4.2.1 Minimize applications and services\n\nThe risk of successful exploitation due to existing vulnerabilities in available services\nincreases with each additional service. Reducing the number of installed applications and services\ndecreases the likelihood of an attacker finding a vulnerability.\n\nBefore stopping any services or programs, the vendor can confirm the service is not needed\nfor system functionality. For example, a standard security measure is to shut off the auxiliary\nservices such as echo, chargen, daytime, discard, and finger. However, if the echo port is being\nused as the system pulse to confirm that the system is up and running, shutting off these services\ncould disable the entire system.\n\nAs discussed further in the next section, adequate resources need to be allocated to ensure\nthat all services and applications are completely patched and up-to-date. SCADA\nowners/operators must rely on their SCADA vendor for validation of patch compatibility before\ntesting and applying patches to their operational system themselves. One way to reduce this\nresource-intensive activity is to reduce the number of applications that need to be patched.\nTherefore, removing all unneeded applications and services is recommended.\n\n##### 4.2.2 Implement effective patch management\n\nNSTB assessment findings make clear the importance of effective patch management for\noperating system (OS) and non-OS applications, services and libraries, as well as third-party\nsoftware. SCADA product vendors can provide mitigation to vulnerabilities in their products by\ndeploying patches to their users. Identifying and patching vulnerabilities rapidly minimizes the\nrisk of public discovery before mitigation is implemented. SCADA vendors can also test patches\nto third-party products and incorporate them into their base product. This is especially important\nfor upgrades to third-party products, which may require changes to the SCADA code that\ninterfaces with them.\n\nOperating system patches repair vulnerabilities in the operating system that could allow an\nattacker to exploit the computer. OS patch management support has improved to the point where\nOS patching is common for most situations, and in particular has been improving in new product\ninstallations and on production systems. Many SCADA vendors now provide timely OS patch\ntest results for their newer releases.\n\nWhile operating system (OS) patch management support has improved and many SCADA\nvendors now provide timely OS patch test results, application patching is difficult and often\ndelayed. According to the SysAdmin, Audit, Network, Security (SANS) 2009 Top Cyber Security\n\n\n-----\n\n_Risks report, “during the last few years, the number of vulnerabilities being discovered in_\napplications is far greater than the number of vulnerabilities discovered in operating systems. As\na result, more exploitation attempts are recorded on application programs.”[1]\n\nNSTB assessments found that applications, services, and libraries not included as part of the\nOS tend not to get patched on many SCADA systems. Non-OS services and libraries are\ninconspicuous and consequently often neglected. Many developers and administrators may not\neven be aware of them. Statically linked libraries can be independently kept up-to-date if they are\ndifferent from the libraries associated with the operating system.\n\nSCADA software generally uses third-party applications such as common Web servers,\ndatabase servers, remote access services, and encryption services. NSTB assessments have\ndiscovered out-of-date, unpatched and vulnerable versions of third-party software applications\nand services incorporated into new SCADA software, on production SCADA. This indicates that\nnew SCADA systems may be installed with vulnerable software and that SCADA system vendors\nmay not be supporting third-party patch management for their software. This becomes a\nsignificant problem if these products cannot be patched by the SCADA owners.\n\nPatching SCADA machines can present unique challenges. Application patching becomes\nincreasingly difficult if security fixes change the way that the SCADA software interfaces with\nother applications. Often new versions of third-party applications, services and libraries have\nchanged the Application Programming Interface (API) so that the third-party product cannot be\nupgraded without changing the vendor’s SCADA code that it interfaces with, and SCADA\nowners may be unable to make the needed modifications to the SCADA vendor’s code.\n\nOS and application patching is resource-intensive for SCADA users since patches need to be\nthoroughly tested in a development environment prior to use in production systems. Thorough\ntesting by both the SCADA vendor and owner is needed to ensure the patch does not jeopardize\nSCADA functionality, security, and timeliness.\n\nThe patching process requires close collaboration with vendor support to ensure SCADA\napplication integrity is maintained. Any patch process test should be first performed on a backup\nor development system before being implemented on an operational system, to isolate the primary\nsystem from potential damage. The testing process can exercise all functionality to reveal any\nundesired behavior that may result from the patch. Functionality tests used during development,\nfactory acceptance, and site acceptance testing can be used for patch testing on the vendor’s code\nbase and the owners’ test systems.\n\nAsset owners/operators can identify and deploy security workarounds, defense-in-depth\nstrategies, and use monitoring methods and tools to mitigate risk introduced by the presence of\nunpatched vulnerabilities until patches can be properly tested and deployed. For example,\nproperly configured firewalls, IDS, and antivirus solutions can be deployed to mitigate risk\n\nFigure 7 shows the percentage of NSTB assessments that found un-patched software in\nSCADA system, categorized by the SCADA software product.\n\n\n-----\n\n**5%**\n**13%**\n\n**29%**\n\n**24%**\n\n**29%**\n\n\nFigure 7. Percentage of unpatched components NSTB assessments found integrated into SCADA\nsystems.\n\n##### 4.2.3  Recommendations and resources\n\nTo mitigate known vulnerabilities through effective patch management, it is recommended\nthat:\n\n    - Vendors create a procedure and have personnel assigned to integrate updates into their\nproducts\n\no Upgrade and patch products and services used by the SCADA system to current version\nand patch levels prior to deployment\n\no Test operating system patches for compatibility with their SCADA system and provide\nthe testing results to users as soon as possible after the patch release, to limit the length of\ntime the customer’s system remains vulnerable.\n\no Test and approve OS, non-OS and third-party software patches\n\no Statically linked libraries are independently kept up-to-date if they are different from the\nlibraries associated with the operating system.\n\n    - Vendors strengthen methods of notifying customers about potential security problems and\npatches\n\no Create and maintain security mailing lists with readily-accessible contact information of\nresearchers and customers\n\no Practice the procedures used to notify customers about security problems\n\n    - Vendors design SCADA products that have third-party services and applications incorporated\ninto their functionality to be updated or replaced as easily as possible\n\n    - Owners test patches before deployment, even if the vendor has approved them and\nparticularly if vendor support is unavailable\n\nMore detailed guidance on production SCADA patch management can be found in the DHS\n_Recommended Practice for Patch Management of Control Systems[6] and the National Institute of_\nStandards and Technology (NIST) Guide to Industrial Control Systems (ICS) Security.[7]\n\n\n-----\n\n#### 4.3 Communication channel vulnerabilities\n\nAs SCADA systems become increasingly connected to company intranets and to the external\nInternet, they can also become more exposed to cyber attack. Communication channels are a\nfocus of NSTB assessments because they often connect different network security zones and may\nhave access rights and functionality to manipulate the SCADA system. NSTB assessments looked\nfor communication channel vulnerabilities that allow:\n\n    - SCADA authentication credentials gathering\n\n    - SCADA data and command spoofing and manipulation\n\n    - DoS of SCADA communications that jeopardizes functionality.\n\nThis section first discusses common IT communication protocols used for common IT\nfunctionality in SCADA systems then discusses SCADA communication protocols used to\ntransmit SCADA data and command messages. The discussion covers the shared need for\nrigorous protection of authentication credentials during transmission in both cases. Then it\ndescribes the need to secure remote access using common IT protocols, and the opportunity to\ndetect intrusion by performing SCADA data integrity checks. Finally, this section explores the\nbenefits and challenges of data encryption for SCADA systems.\n\n##### 4.3.1 Common IT protocols in SCADA systems\n\nSCADA systems use common IT protocols for common IT functionality, such as network\ndevice management, remote logins, or file transfers. Although more secure alternatives are\navailable for most of these services, active unused or obsolete services may still be present in\nmany SCADA systems and may be vulnerable to spoofing and MitM attacks. SANS.org defines\nspoofing[34] as “Attempt by an unauthorized entity to gain access to a system by posing as an\nauthorized user” in the Glossary of Security Terms, SearchSecurity.com defines Man in the\nMiddle[35] attack as “…an exploit in which an intruder intercepts and alters communications\nbetween two parties.”\n\nBecause they are not used for real-time functionality, they can be replaced with their secure\ncounterparts in most cases. As an example, SSH can replace all file transfer and remote login\nprotocols such as FTP, telnet, and rlogin with encrypted versions. Also, any communication\nprotocol can be “tunneled” through SSH, and HTTP can be sent over the Secure Socket Layer\n(HTTPS).\n\nThe use of insecure IT protocols in SCADA systems can be high risk because attackers are\naware of their known vulnerabilities, and may have access to automated tools created to exploit\nthese vulnerabilities. For example, network protocol analysis tools can intercept and decode most\ncommon protocols.[36] Likewise, password cracking tools can decode messages and passwords that\nhave been encrypted with weak or improperly implemented encryption schemes.[37]\n\nInsecure protocols and services connected to the SCADA system hosts can create a high-risk\naccess path into the system. This introduces a significant vulnerability because it can provide\nremote access to SCADA hosts along with access to the functionality allowed by the privilegelevel of the remote user whose authentication credentials were stolen.\n\n**_4.3.1.1_** **_Protect IT authentication credentials during transmission_**\n\nClear-text authentication credentials can be captured (sniffed) during transmission. If an\nattacker is able to capture a username and password, then the attacker can log onto the system\n\n\n-----\n\nwith that user’s privileges. Therefore, plain-text remote login services can be replaced with\nencrypted services such as SSH, as discussed above. This can be particularly important in\nmultipoint networks such as Ethernet. Table 10 lists examples of common vulnerabilities\nassociated with clear-text authentication protocols used in SCADA systems.\n\nTable 10. Common vulnerabilities associated with insecure common IT communications\nprotocols\n\n**Common Vulnerability** **Potential Impact**\nFile Transfer Protocol (FTP) available Capture of ID and\npassword\nThe test system is running the plain-text protocols FTP and telnet\nUnencrypted ports were open including FTP, Hypertext Transfer\nProtocol (HTTP), RPCBIND (Traffic analysis reveals no\nindication of authentication or encryption)\nrlogin, rsh, FTP, telnet on one workstation\n\n**_4.3.1.2_** **_Implement secure remote access_**\n\nRemote display protocols and applications provide the ability to logon and remotely control\nanother machine using a graphical display. The use of common remote display software for\nremote access to supervisory control functions could be the most significant vulnerability on a\nSCADA system. Easily exploited known vulnerabilities in common remote display software\ncould allow unauthorized remote access to graphical supervisory control software, as well as any\nother functionality allowed to the remote user. Vulnerability exposure depends on how and where\nthe connection is initiated.\n\nNSTB assessments have found common remote display protocols used by SCADA systems\nthat accept connections from anywhere and transport credentials in clear text or by a weak\nencryption algorithm. Even if strong encryption is used, if the remote display client’s host is\ncompromised, the attacker may also have access to the remote SCADA host’s display and all of\nthe client’s functionality including the encrypted channel. Table 11 lists examples of common\nvulnerabilities found in remote display protocols. In the appendix, Table C-10 “Summary of\nSCADA Web application security characteristics” lists common vulnerabilities in remote display\nsoftware used by SCADA for remote access to supervisory control functions.\n\nTable 11. Common vulnerabilities found in software used by SCADA for remote access to\nsupervisory control functions.\n\n|Common Vulnerability|Potential Impact|\n|---|---|\n|File Transfer Protocol (FTP) available|Capture of ID and password|\n|The test system is running the plain-text protocols FTP and telnet||\n|Unencrypted ports were open including FTP, Hypertext Transfer Protocol (HTTP), RPCBIND (Traffic analysis reveals no indication of authentication or encryption)||\n|rlogin, rsh, FTP, telnet on one workstation||\n\n|Common Vulnerability|Potential Impact|\n|---|---|\n|No access controls for remote display|Attacker is able to connect to remote display service from anywhere|\n|Clear-text transmission of remote display credentials|Attacker is able to steal remote display credentials by “sniffing” network traffic while a remote display connection is established|\n|Use of remote display service that uses a weak or improperly implemented cryptographic algorithm|Attacker is able to steal remote display credentials by “sniffing” and decrypting network traffic while a remote display connection is established|\n\n\n-----\n\n**_4.3.1.3_** **_Recommendations and resources_**\n\nTo find and remediate communication channel vulnerabilities in common IT protocols and\ncommon remote display protocols, it is recommended that:\n\n    - All stakeholders follow IT security practices and use the current secure versions of common\nprotocols\n\n    - All stakeholders where possible replace insecure versions of common IT services with their\nsecure versions\n\no Replace plain-text remote login services with encrypted services such as SSH.\n\no When replacement is not feasible, minimize access to the services, and limit unencrypted\ncommunication to within the SCADA whenever possible.\n\n    - Vendors remove insecure protocols in their products\n\n    - Vendors provide secure options for remote access of SCADA hosts and provide secure\ndefault configurations that include access restrictions and secure authentication, including\nconfiguration of the host to validate the security of the remote access client to protect against\nunauthorized access through a trusted compromised client host.\n\n    - Vendors notify owners when more secure remote access and file transfer solutions are\navailable\n\n    - Owners configure remote access protocols and services on SCADA hosts to limit access,\nrequire strong authentication, use a trusted path, and be kept up to date\n\n##### 4.3.2 SCADA data and command message communication protocols \n\nSCADA network protocols, including those used to send control commands and status data,\ncan be vulnerable to MitM attacks, altered, replayed, or spoofed if they lack sufficient access\ncontrol and integrity checking mechanisms. This vulnerability can be exploited with minimal skill\nto intercept or create the network messages. An attacker’s ability to intelligently interpret and\nmanipulate process status depends on how much of the SCADA protocol and physical process\ncan be discovered and reverse engineered.\n\nThe SCADA network design and implementation determines the exposure of control protocol\nvulnerabilities. This class of vulnerability is potentially exposed to anyone who has gained\nnetwork access to the supervisory control network, or a network that is allowed access to control\nequipment.\n\nMost SCADA network protocols were designed with the original SCADA code base to be\nfast and are not designed to provide robust authentication and integrity checks. As a result, many\nprotocol designs contain common security pitfalls. When possible, network protocols, and the\nservice applications that implement them, can be re/designed to improve security by avoiding\ncommon security pitfalls such as designs that make implementation difficult, and by including\nsecure authentication and encryption methods.\n\nSeveral characteristics of secure protocol are relevant to this discussion. Secure protocols are\nsimple, minimize duplicate data, are streamlined, have secure authentication methods and options\nfor encryption or data integrity and do not rely on security by obscurity.\n\nProtocols that are secure are also simple. More complex protocols are more likely to have\nvulnerabilities within the implementation.\n\n\n-----\n\nProtocols that are secure minimize duplicate data. If data appear multiple times within the\nprotocol, then portions of the implementation will invariably use one version of the data while\nother portions use another version. This allows an attacker to put the implementation into an\nunknown state by sending conflicting versions of the data.\n\nProtocols that are secure are streamlined. They contain enough functionality to get the job\ndone and nothing more. Protocols with many optional fields and features are less secure because\nno two implementations will agree on what is optional, which invites incorrect assumptions. Also,\nif protocols contain seldom used or never used components, then those components tend to\ncontain more vulnerabilities than well-used components because they will be tested to a lesser\ndegree.\n\nProtocols that are secure have secure authentication methods and options for encryption or\ndata integrity.\n\nProtocols that are secure do not rely on security by obscurity. Insider knowledge or reverse\nengineering can be used to recreate valid network packets. Some SCADA protocol analyzers have\nalready been developed and, given the increasing interest in SCADA security, one can expect to\nsee more.\n\nSCADA vendors can create parsers for their custom protocols for use by common IDSs. This\nmakes intrusion detection monitoring more effective through the ability to watch for illegal or\nabnormal values in SCADA traffic. The bulk of the current IDS technology is focused on\ndetecting exploits, not vulnerabilities. These systems are not as effective in the SCADA\nenvironment due to the lack of known exploits to detect. If dissectors for the SCADA protocols\nexist, rules could be written for the IDSs that verify network messages are within reasonable\nbounds and attempt to detect an exploitation of vulnerability.\n\n**_4.3.2.1_** **_Protect SCADA authentication credentials during transmission_**\n\nAuthentication can protect against unauthorized access to SCADA applications. If a SCADA\nsystem allows clear-text authentication credentials (username and password), they can be sniffed\nduring transmission and used by an attacker to authenticate to the SCADA application. The\nattacker can then log into the SCADA application with that user’s privileges. Table 12 lists\nexamples of unprotected SCADA application credentials sent over the network.\n\nTable 12. Common vulnerabilities associated with transmission of unprotected SCADA\nauthentication credentials\n\n**Common Vulnerability** **Potential Impact**\nOperator and developer applications transmit login information Capture of ID and password\nin plain text\n\nClear-text password traffic\n\n**_4.3.2.2_** **_Implement secure access control and check data integrity_**\n\nSCADA communication protocols may not have been designed and implemented to\nadequately verify the identity of actors at both ends of a communication channel, or ensure the\nintegrity of the channel, in a way that prevents the channel from being accessed or influenced by\nan actor that is not a legitimate endpoint. Weak authentication can prevent the protocol from\ndetecting that the message is from an unauthorized sender. However, some SCADA protocols\nmay rely on weak authentication, such as hostname or IP address, which can be easily spoofed. In\n\n|Common Vulnerability|Potential Impact|\n|---|---|\n|Operator and developer applications transmit login information in plain text|Capture of ID and password|\n|Clear-text password traffic||\n\n\n-----\n\na spoofing attack, false information could be sent to the operator’s console. Likewise, inadequate\ndata integrity checks can prevent a protocol from detecting bad or corrupted data. If integrity\ncheck values or “checksums” are omitted from a protocol, there is no way of determining whether\ndata have been corrupted in transmission. If integrity check values are easily reverse engineered\nand duplicated, data manipulation in transmission can remain undiscovered despite security\ninspection.\n\n**_4.3.2.3_** **_SCADA data encryption considerations_**\n\nA long-term mitigation to secure SCADA communication channels could be to replace\nSCADA protocols with an encrypted version of the protocol. However, there is no drop-in\nreplacement currently available—with the exception of secure ICCP. Even if there were, it would\nbe an infeasible task to rewrite, test and validate all of the software involved.\n\nOne near-term mitigation option is to use IPSec with only the authentication header (AH).\nIPsec[38] is a network layer security control implemented through a framework of open standards\nfor ensuring private communications over public networks. AH mode does not encrypt the data,\nbut it provides a cryptographically authenticated wrapper that prevents tampering. Another\nadvantage of this mode is that an IDS can still monitor the communications and detect anomalies\nin the conversation.\n\nAnother near-term mitigation option is to transmit the insecure protocol through an encrypted\nprotocol tunnel, such as IPSec, SSL, etc. Encryption solutions, such as IPSec and VPN tunneling,\ncan be used for confidentiality, integrity, authenticity, and/or replay protection.\n\nThis would require that the components at the communication endpoints have the software\ninstalled, configured, and tested to ensure the setup is correct and secure, which could be a\nsubstantial task, depending on the capabilities of the devices involved. It is also quite possible\nthat some devices may not have the necessary computing power to handle the added burden. Even\nif the computing resources exist, this approach introduces the need for dedicating labor resources\nto key management.\n\nAnother difficulty of this option is that all of the communications between the systems can be\nblocked if the end points are susceptible to ARP cache poisoning. In this case, depending on the\nparticular IPSec configuration communications would either stop, or continue in an unencrypted\nmode.\n\nA recent trend in the SCADA industry has been to encrypt core SCADA communications\nwith IPSec which can be configured not to jeopardize critical communications. SCADA hosts that\nrequire high availability can be configured with an IPSec “request” policy instead of “require”.\nThis means that encryption is requested, but communications will continue in clear text if the\nIPSec connection cannot be established. On the other hand, if the IPSec policy is set to “require”\nIPSec for communications this failure can cause DoS. If the IPSec policy is set to “request,” then\nan attacker can force IPSec to disable itself. The decision for configuring this implementation of\nIPSec with a “request” policy versus a “require” policy is based on whether the highest priority\nfor the communication between the IPSec partners is encryption (confidentiality, integrity,\nauthenticity, or replay protection) or is high availability.\n\nEncryption solutions that tunnel SCADA protocols have been tested in NSTB assessments. In\nsome cases, the components were incorrectly configured and the encrypted connections were still\nvulnerable to a MitM attack. In other cases, the system integrators were not able to successfully\nimplement the encryption solution on the test system.\n\n\n-----\n\nA final near-term mitigation option is to employ separate encryption hardware (so-called\n“bump-in-the-wire”) devices to encrypt the traffic for a system. In addition to the cost, these\ndevices have their own configuration and key management challenges. However, the addition of\nencryption capabilities to SCADA products may allow the communication channels to be\nsecured.\n\nSCADA vendors may find secure design and vulnerability remediation activities to be\nimpractical due to time, cost, and/or backward compatibility issues and look toward encryption of\nSCADA communications as mitigation to all vulnerabilities on the SCADA. While adding\nencryption can limit exposure, this does not prevent access through the encrypted channel if an\nattacker has compromised an encryption endpoint. Consequently, these encryption solutions\ncannot be used as a replacement for fixing vulnerabilities because a VPN connection extends the\nattack surface of the system to the VPN client’s computer. These encryption solutions do not\nprevent an attacker from compromising a VPN endpoint computer and using the VPN tunnel as\nan encrypted pathway to exploit vulnerabilities in the other endpoint host.\n\nA remote end-point joins the trusted domain when it is allowed to remotely connect to the\nSCADA network. If VPN endpoints (hosts) are compromised, an attacker may be able to utilize\nthe VPN connection when it is established so secure these hosts to the maximum extent possible.\nEnd-point management software can be used to help determine the security posture of the remote\ndevice and how it is allowed to connect to the protected network, but is not recommended as the\nonly defense measure. VPN access can be granted to the minimum set of hosts and users when\nnecessary and those VPN connections can be restricted to allow access only to the necessary\ncomponents.\n\nThe difficulty of implementation and the introduction of an impediment to viewing network\ncommunications when needed for trouble-shooting can prevent the use of encryption for\noperational IDS. Encryption can pose a risk to network throughput, bandwidth, availability, and\nIDS capabilities, as well as CPU availability on endpoint systems. Encryption can also make\nsystem monitoring difficult, and can add undesired latency to communications. NSTB experience\nand feedback have shown that encryption of SCADA communications is difficult and is rarely\naccomplished successfully. NSTB assessments have found insecure encryption configurations.\nEncryption might not be implemented because it could not be accomplished without disabling\nSCADA communications, or because the communications partner did not support it.\n\nHowever, encryption can be implemented as a layer of defense, where confidentiality or\nintegrity is a higher priority than availability (i.e., external and non-critical connections), to\nprovide confidentiality and prevent MitM attacks between encryption endpoints. Encryption can\nbe used to support strong authentication and authorization, and protect from unauthorized access\nto data in files or in transit, but it is not recommended as a primary mitigation for other types of\nvulnerabilities, such as input validation weaknesses. SCADA designers and administrators can\ncarefully consider the priorities of each communication channel when implementing encryption.\nAn appropriate encryption solution can be selected for each SCADA communication channel that\ncan handle the associated risk, support encryption, and be configured securely and safely to\nsupport the SCADA’s priorities. Administrators can securely manage and protect cryptographic\nkeys that are strong and are not hard-coded, default, published, or discoverable. SCADA\ndesigners and customers can refer to current and specific documentation on network cryptography\noptions and implementation instructions from their providers and reference standards and\nguidance material from the NIST Cryptographic Toolkit[39] project. Encryption may not fix the\nvulnerabilities in a SCADA system, but it can be used as a layer of defense.\n\n\n-----\n\n**_4.3.2.4_** **_Recommendations and resources_**\n\nTo protect SCADA data and command messages from manipulation and ensure they have not\nbeen altered in transit, it is recommended that:\n\nStakeholders:\n\n    - Use secure authentication and data integrity checks\n\n    - Require physical access for controller configuration and firmware update\n\n    - Vigorously protect user credentials and make inaccessible to an attacker\n\n    - Secure as much as possible communications between security zones\n\n    - For long-term mitigations, replace insecure SCADA protocols with protocols that provide\nstrong authentications and integrity checks\n\n    - Vendors:\n\n    - Ensure their system design implements strong authentication into SCADA communication\nprotocols\n\n    - Validate that their products securely encrypt or hash passwords before storing or transmitting\nthem\n\n    - Integrate the latest ICCP protocol stack into their products\n\n    - Owners:\n\n    - Take defensive actions to reduce exposure including secure network access, anomaly\ndetection, and content filtering rules\n\n    - Use IDS monitoring to detect the attacker’s presence on the network and MitM activities\n\n    - Configure network equipment to prevent MitM attacks, possible defensive options include:\n\no Hard-code the Media Access Control (MAC) addresses of the communication endpoints\nin each system’s ARP tables.\n\no Employ all of the features of the installed networking equipment, such as port security on\nswitches and 1-to-1 rules on firewalls.\n\no Employ IDS solutions that detect ARP MitM activities\n\n    - When using Web applications with Secure Sockets Layer (SSL), SSL is used for the entire\nsession from login to logout and not just for the initial login page\n\n    - Secure VPN end-point hosts to the maximum extent possible\n\n    - May be able to secure SCADA application connections using third-party encryption solutions\n\n    - Validate that their ICCP implementations use the latest versions or patches\n\nMore information about communication channel vulnerabilities can be found in the related\nsecurity weaknesses from the CWE[9]:\n\n    - [CWE-300: Channel Accessible by Non-Endpoint (“Man-in-the-Middle”)](http://cwe.mitre.org/data/definitions/300.html)\n\n    - [CWE-285: Improper Access Control (Authorization)](http://cwe.mitre.org/top25/#CWE-285)\n\n    - [CWE-311: Missing Encryption of Sensitive Data](http://cwe.mitre.org/data/definitions/311.html)\n\n    - [CWE-306: Missing Authentication for Critical Function](http://cwe.mitre.org/data/definitions/306.html)\n\n\n-----\n\n    - [CWE-327: Use of a Broken or Risky Cryptographic Algorithm.](http://cwe.mitre.org/data/definitions/327.html)\n\nDomain Name System (DNS) spoofing can be protected against by using the available DNS\nsecurity measures.[16]\n\nThe DHS Control Systems Communications Encryption Primer[17] provides SCADA specific\ninformation on encryption. More detailed information on recommended configurations is\navailable in the NIST Special Publication 800-113.[18]\n\n##### 4.3.3 Protect SCADA data and command messages against man-in-the-middle\n\nNetwork traffic can be exposed to man-in-the-middle (MitM) attacks that gather unauthorized\ninformation, alter messages, or drop messages. A MitM attack is possible if the communication\nprotocol does not authenticate the identity of each communication partner or ensure the integrity\nof the message. If an attacker can pose as a legitimate communication partner and formulate the\ncorrect integrity check values for a new or altered message, the communication channel is at risk.\n\nThe Address Resolution Protocol (ARP) MitM attack is a popular method used by an attacker\nto gain access to the network communications of a target system. The ARP protocol is used to\ndetermine which hardware addresses coincide with the Internet Protocol (IP) addresses on the\nnetwork. The MitM attack can be effective against multipoint networks because the hosts send\ntheir data to the attacker’s (compromised) computer thinking it is the intended recipient of their\ndata. This attack exploits the network ARP caches of hosts on the LAN and generally requires\nthat the attacker compromise a host on the victim computer’s LAN. The MitM attack sends\ndeceptive ARP commands that direct the two hosts to communicate with the attacker computer\nwhich poses as the intended recipient. In a successful MitM attack, the hosts on each side of the\nattack are unaware that their network data has been redirected through the attacker’s computer,\nwhich must forward all packets to the intended host so the connection stays synchronized and\ndoes not time out. Multiple free, publicly available tools exist to perform ARP poisoning and\nMitM attacks, as well as brute-force and dictionary attacks (attacks where a password can be\nobtained by systematically entering every word in a dictionary as a password) against Terminal\nServices to local or remote access applications.\n\nIf the attacker has gained access to a host that is allowed to send control messages, then the\nattacker need not invest effort in implementing a MitM attack. In that case, even if the control\nprotocol is encrypted the attacker can still send control messages by gaining access to the host\nthat encrypts the packet.\n\nSCADA communication protocols may be vulnerable to spoofing and MitM attacks because\nthey may not have been designed and implemented to prevent these attacks. Strategically\nmanipulating the communications on a control network requires an in-depth understanding of the\nprotocol and process being manipulated. The NSTB assessment team is generally able to gather\nenough information about a network protocol to perform a network layer attack against the\nsystem. With a full ARP MitM attack in place, an attacker can intercept and manipulate\ncommands and messages that control SCADA devices, control field equipment and/or modify\ndata flowing back to the operator’s console to misrepresent the system state. This tampering\ncould allow an attacker to manipulate the system and keep the operator unaware of the attacker’s\ninterference so that the operator is deceived into performing dangerous actions or not taking the\nappropriate preventative actions.\n\nThe following attack scenario was demonstrated in multiple NSTB assessments, and could be\naccomplished on any network link between the client and server: Using a freely available tool\ncalled Cain, the NSTB assessment team poisoned the ARP caches of the HMI server and a client,\n\n\n-----\n\ntelling each that the other was located at the attacker’s address. Once the MitM was established,\nthe client connected through the attacker.\n\nOne defensive measure against MitM attacks is to hard-code the Media Access Control\n(MAC) addresses of the communication endpoints in each system’s ARP tables. The systems will\nthen ignore the spoofed ARPs sent during an ARP MitM attack, which makes the attack\nineffective. This mitigation approach comes with several challenges. Some systems do not\nprovide a way to hard-code the ARP tables. Some systems provide a temporary method, but it\nmust be repeated every time the system is started (volatile storage). Replacement of a remote\ndevice requires updating the ARP tables on every system component in the communication path.\nAnd finally, this only protects against one MitM attack method, ARP spoofing. Another defensive\nmeasure that is also relatively inexpensive is to employ all of the features of the installed\nnetworking equipment, such as port security on switches and 1-to-1 rules, static addressing, on\nfirewalls. However, this may not be a viable option because firewalls are not commonly used in\nthe basic control communications path. A third option is to employ IDS solutions that detect ARP\nMitM activities. LAN MitM techniques include ARP spoofing, DNS spoofing, IP address\nspoofing, port stealing, and STP (Spanning-Tree Protocol) mangling.[40] Techniques that can be\nused to create a MitM from a local network to a remote network through a gateway include ARP\npoisoning, DNS spoofing, DHCP spoofing, Gateway spoofing, ICMP redirection, and route\nmangling. Remote MitM attacks can be performed using DNS poisoning, route mangling and\ntraffic tunneling.\n\n#### 4.4 Communication endpoint vulnerabilities\n\nNetwork services at communication end-points listen for messages to accept, and can be\nexposed to attacks that exploit input and output validation vulnerabilities to create a buffer\noverflow or perform an SQL injection. These services are vulnerable to remote compromise if\nthey do not properly check the size of user input, filter out unneeded and potentially malicious\ncharacter sequences, and initialize and clear variables properly, as discussed above in section 4.3.\n\nNSTB assessments look for SCADA programming errors in functions that parse network\ncode without proper validation or “sanity check” of input values. Vulnerabilities in services that\nparse network traffic can allow unauthorized access to their host. NSTB assessments also focus\non authentication systems because these systems can allow authentication bypass if they are not\nimplemented correctly.\n\nThis section discusses vulnerabilities in SCADA and ICCP services that could be exploited to\ncreate a buffer overflow. Then it presents vulnerabilities found in SCADA historian database that\ncould be exploited by an SQL injection. Finally, it describes vulnerabilities found in SCADA web\napplications and services that could be exploited to allow directory traversal or cross-site\nscripting. Each of these cyber-attacks – buffer overflow, SQL injection, directory traversal and\ncross-site scripting – were discussed above in section 4.3 and are mitigated through secure coding\npractices that enforce validation of input data integrity.\n\n##### 4.4.1 SCADA and ICCP services\n\nNSTB assessments have found input validation vulnerabilities in custom server applications\nwritten to process SCADA protocol messages and other SCADA network traffic. These\napplications are:\n\n    - Control protocol services\n\n\n-----\n\n- Supervisory control protocol services\n\n- ICCP services.\n\nThe NSTB partnered with two major ICCP stack providers and four major SCADA/EMS\nvendors to assess the security of their ICCP products and implementations. A total of three thirdparty stacks and five SCADA/EMS ICCP implementations were tested. Although nearly every\nmajor SCADA/Energy Management System (EMS) vendor offers ICCP software as an integrated\nor standalone part of their overall systems, many of them purchase the underlying protocol layers\nfrom a third-party vendor.\n\nICCP, also called Telecontrol Application Service Element 2.0 (TASE.2), is an international\nprotocol standard that is used extensively in the electrical power industry. ICCP communication\nlinks are used to exchange information among electric utilities, independent system operators,\nregional transmission organizations, and independent power producers, among others. This\ninformation is typically exchanged over private networks or leased lines; in some cases, Virtual\nPrivate Network (VPN) connections over the Internet may also be used. Because of the\ninterconnections these links provide between entities, and the resulting risk of a coordinated cyber\nattack on multiple entities through these links, the ICCP protocol was chosen as the subject of an\nNSTB assessment. Figure 8 shows how these entities could be connected via ICCP.\n\nFigure 8. Sample ICCP network\n\n\n-----\n\nThe majority of NSTB findings in the ICCP assessment were vulnerabilities that, if exploited,\ncould cause buffer overflow and DoS. Buffer overflow vulnerabilities can potentially allow an\nattacker to take control of the ICCP server, providing a possible path to the SCADA network.\nDoS events are less severe, but can be used to cause an outage of the ICCP service. The NSTB\nalso found that the complexity of the ICCP protocol contributed to the number of vulnerabilities\nfound. Even if all functionality in the ICCP protocol is not used, the vulnerabilities in the unused\nlayers can still be available for attackers. In addition, some new ICCP implementations were\nfound to use older versions of the third-party protocol stack. These older versions contained\nknown vulnerabilities, including multiple vulnerabilities that could be exploited to create DoS\nand vulnerabilities that could lead to remote code execution. SCADA vendors can integrate the\nlatest ICCP protocol stack into their products, and owners validate that their ICCP\nimplementations use the latest versions or patches. The results from these ICCP assessments have\nbeen consolidated into a public report, available from the NSTB.[5]\n\n**_4.4.1.1_** **_Protect SCADA services against buffer overflow_**\n\nMost buffer overflows identified in NSTB assessments were in the server applications that\nprocess SCADA protocol traffic. In most cases, values input from network traffic were\nintercepted and altered in transit. Therefore, network data bounds and integrity checking can be\nimplemented to reduce risk.\n\nEvery network protocol has an associated program that builds packets or processes\ncommunications traffic off the network. These applications are written by the SCADA vendor for\ntheir propriety protocols as well as for common SCADA protocols, such as Object Linking and\nEmbedding (OLE) for Process Control (OPC), ICCP, and DNP3. If these applications are\nvulnerable to invalid input, then an attacker who is able to gain network access may exploit this\nvulnerability to create a buffer overflow. In this case exploitation by anyone who is able to gain\naccess to the SCADA host and port is possible. Remotely exploitable vulnerabilities can be\naccessed over the network (i.e., an attacker does not require local network access or local host\naccess). The more remote an attacker can be to attack a host, the more likely it is that the host will\nbe exploited.[2]\n\nVulnerabilities in services that are exposed to less-trusted networks may have higher\nconsequences because they may provide a path from the lower security zone to the higher\nsecurity zone. Remote code execution through buffer overflow attacks is a common attack\nmethod for gaining unauthorized access to hosts. SCADA design requires that SCADA protocols\nbe allowed through firewalls to support external data collection and sharing. These protocols and\nservices should have top priority for vulnerability remediation activities.\n\nData integrity checks can be designed and implemented into SCADA communication\nprotocols. The lack of, or weak, data integrity checks prevent a protocol from detecting bad data.\nAn attacker can take advantage of the improper integrity checks to send malformed packets to\ncause DoS attacks or trigger a buffer overflow and compromise the system. An attacker does not\nalways have to send malformed packets for manipulation of otherwise valid alarm or command\nmessages sent over the wire if the SCADA protocol has improper integrity checks.\n\n**_4.4.1.2_** **_Recommendations and resources_**\n\nTo protect against buffer overflow cyber attack, it is recommended that SCADA software\nvendors:\n\n    - Provide validation of all input data, not just those proven to cause buffer overflows.\n\n\n-----\n\n    - Ensure programmers are trained in secure coding practices\n\n    - Review and test all code for input functions that could be susceptible to buffer overflow\nattacks.\n\n    - Use automated static analysis tools to detect buffer overflow vulnerabilities in their code.\n\n    - Use dynamic tools and techniques such as fuzz testing, robustness testing, and fault injection.\n\n    - Integrate the latest ICCP protocol stack into their products\n\nOwners are recommended to validate that their ICCP implementations use the latest versions\nor patches.\n\nWhen allocating and managing an application’s memory, the MITRE Common Weakness\nEnumeration report recommendations include:\n\n            - Double check that your buffer is as large as you specify.\n\n            - When using functions that accept a number of bytes to copy,\nsuch as strncpy(), be aware that if the destination buffer size\nis equal to the source buffer size, it may not NULL-terminate\nthe string.\n\n            - Check buffer boundaries if accessing the buffer in a loop and\nmake sure you are not in danger of writing past the allocated\nspace.\n\n            - If necessary, truncate all input strings to a reasonable length\nbefore passing them to the copy and concatenation\nfunctions.[9]\n\nVendors, and possibly owners, can take additional precautions to help prevent exploitation or\nlimit damage from buffer overflow vulnerabilities. Languages, libraries, and frameworks that do\nnot allow for some types of buffer overflows may be used in software development. C-based\nprograms are known for their vulnerability to buffer overflows. Older programming languages\nsuch as FORTRAN and Pascal are vulnerable as well, but are becoming less common, especially\nin programs performing network activity. The interpreted languages such as Java, C#, and Perl,\nwhich include most Web applications, are generally immune to buffer overflow attacks.\nHowever, they are still vulnerable to other types of attacks.\n\nDevelopers can also use compiler options to detect some types of buffer overflows; however,\nan attack could still cause a DoS, since the typical mitigation is to exit the application.\n\nSome SCADAs only support one CPU and/or OS. SCADA vendors and owners if possible,\ncan use a CPU and OS that offers protection against buffer overflow attacks. Again, this is only a\ndefense in depth solution because they will not prevent all attacks and could still cause DoS\nbecause the typical mitigation is to exit the application.\n\n##### 4.4.2 Database applications and services\n\nAn historian server archives data, performs analyses and is integral to most SCADA systems.\nIt is usually located in a DMZ or on the corporate network. Consequences of an exploited\nvulnerability for the historian include compromise of the historian host and data corruption.\nSCADA historians typically use a common SQL server as the backend, and historical data are\noften made available for viewing via a custom Web interface or application that uses SQL queries\nto retrieve information.\n\n\n-----\n\nThe historian client applications can be high-risk components because they are often\naccessible from the corporate environment and can provide an attacker with a point of entry to the\nSCADA network if not properly secured. Additionally, an attacker may gain access to\nunauthorized information which, in some cases, can be used to cause economic damage.\n\nNSTB assessments have found unsafe function calls in code written to parse historian data\nmessages (see Table 13). Rigorous input validation is required to protect against a DoS or\nunauthorized access to the associated host. One potential attack pathway is SQL injection,\nanother is weak authentication that may be defeated to gain database access.\n\nTable 13. Common vulnerabilities associated with the historian database\n\n**Common Vulnerability** **Potential Impact**\nMultiple SQL injection vulnerabilities Execution of unauthorized database\ncommands\nDatabase access code susceptible to SQL injection attack\nof database server\nVulnerability in Database server when large SQL\nstatement is parsed\nInsecure C/C++ routines Unauthorized access to or DoS of\nHistorian database or host\nDatabase server protocol vulnerabilities can be exploited to Historian DoS\ncause a DoS\n\nConnection to Historian without user name or password Unauthorized access to Historian\ndatabase\nDatabase ports are remotely accessible\nBoth the client and server use the same certificate to\nencrypt/authenticate connections\n\n**_4.4.2.1_** **_Protect SCADA historian against Structured Query Language (SQL) injection_**\n\nSQL injection vulnerabilities in applications that access data from the SCADA historian\ndatabase allow an attacker to execute arbitrary SQL queries and/or commands on the database. A\nsuccessful SQL injection exploit of a SCADA historian may allow the attacker to:\n\n    - bypass authentication to the historian-backed application,\n\n    - read historical data from the database (and potentially user names and passwords),\n\n    - modify historical data,\n\n    - execute administration operations on the database (such as shutdown the historian database),\n\n    - recover the content of a files present on the historian’s host file system, and\n\n    - in some cases, issue commands to the historian’s host operating system.\n\n**_4.4.2.2_** **_Recommendations and resources_**\n\nTo find and remediate database application and services vulnerabilities, such as SQL\ninjection and weak authentication, it is recommended that:\n\n    - All stakeholders use the principle of least privilege\n\n|Common Vulnerability|Potential Impact|\n|---|---|\n|Multiple SQL injection vulnerabilities|Execution of unauthorized database commands|\n|Database access code susceptible to SQL injection attack of database server||\n|Vulnerability in Database server when large SQL statement is parsed||\n|Insecure C/C++ routines|Unauthorized access to or DoS of Historian database or host|\n|Database server protocol vulnerabilities can be exploited to cause a DoS|Historian DoS|\n|Connection to Historian without user name or password|Unauthorized access to Historian database|\n|Database ports are remotely accessible||\n|Both the client and server use the same certificate to encrypt/authenticate connections||\n\n\n-----\n\n    - Vendors use vetted libraries or frameworks that prevent SQL injection vulnerabilities or\nprovide constructs that make these vulnerabilities easier to avoid\n\n    - Vendors use secure coding practices when constructing SQL queries\n\n    - Owners replicate databases out to the DMZ\n\n    - Owners with Web servers use an application firewall to detect common Web attacks\n\nInformation regarding SQL injection that is specific to SCADA systems is available from the\nICS-CERT portal.[19] For further information on SQL injection:\n\n    - [CWE-89: Improper Sanitization of Special Elements used in an SQL Command ('SQL](http://cwe.mitre.org/data/definitions/89.html)\n[Injection')[9]](http://cwe.mitre.org/data/definitions/89.html)\n\n    - _SQL Injection Attacks by Example[20]_\n\nThe Open Web Application Security Project (OWASP) Top Ten for 2010[21] document provides\nbasic techniques for mitigating the highest Web application risks along with additional\nreferences. Risk A1, Injection, addresses SQL injection risks. A summary of the recommendations\nfor avoiding injection flaws follows:\n\n1. Avoid the interpreter entirely\n\n2. Use an interface that supports bind variables (e.g., prepared statements, or stored procedures)\n\na. Bind variables allow the interpreter to distinguish between code and data\n3. Encode all user input before passing it to the interpreter\n\na. Always perform “white list” input validation on all user-supplied input\nb. Always minimize database privileges to reduce the impact of a flaw\n4. Follow the guidance from the OWASP SQL Injection Cheat Sheet.[22]\n\n##### 4.4.3 Web applications and services\n\nMany SCADA systems have recently incorporated Web applications and services to allow\nremote supervisory control, monitoring or corporate analysis of SCADA data. NSTB assessments\nhave found unauthorized directory traversal and authentication vulnerabilities within SCADA\nWeb implementations. Many of the code quality and input validation vulnerability findings in this\nreport refer to proprietary Web applications.\n\nCommon vulnerabilities found in SCADA Web services along with associated potential\nimpacts are listed below in Table 14. Like SQL injection vulnerabilities, directory traversal, and\nXSS vulnerabilities are caused by insufficient or incorrect handling of user input values and can\nlead to similar consequences.\n\nThe SANS 2009 report indicates that Web vulnerabilities are critical:\n\nThe most ‘popular’ applications for exploitation tend to change\nover time since the rationale for targeting a particular application\noften depends on factors like prevalence or the inability to\neffectively patch. Due to the current trend of converting trusted\nWeb sites into malicious servers, browsers and client-side\napplications that can be invoked by browsers seem to be\nconsistently targeted. Automated tools, designed to target custom\nWeb application vulnerabilities, make it easy to discover and\ninfect several thousand Web sites.[1 ]\n\n\n-----\n\nNSTB assessment indicate that lack of good programming practices can result in SCADA\nWeb services being vulnerable to the most popular attack techniques such as Structured Query\nLanguage (SQL) injection, cross-site scripting (XSS), directory traversal and authentication\nbypass. SCADA Web applications tend to be more exposed to attack than most SCADA\ncomponents, and may provide the capability to alter SCADA data or state. Table 14 shows\ncommon vulnerabilities NSTB assessments found associated with Web services.\n\nTable 14. Common vulnerabilities associated with Web services\n\n**Common Vulnerability** **Potential Impact**\nNo authentication between corporate clients and Unauthorized access from corporate\nWeb server on DMZ network to DMZ\n\nHTTP Port 80 had no default page. Displayed Unauthorized access to files and\ndirectory structure. directories on the Web server\n\nArbitrary files can be read on Web server by adding Compromise of Web server\n../../ or ..\\..\\ in front of file name.\nMultiple cross-site scripting Vulnerabilities Compromise of Web client\nPersistent cross-site scripting Vulnerability\nCross-site scripting on Login and History Analysis\nPages\nBrowser plug-in exploit allowed control of\nworkstation\n\n**_4.4.3.1_** **_Control access to web services_**\n\nNSTB assessments have found authentication, session tracking, structured SQL injection and\nXSS vulnerabilities that can allow unauthorized access to Web servers and applications. Web\nservices developed for SCADA systems can be vulnerable to attacks that exploit the SCADA\nWeb server to gain unauthorized access. System architectures often use network DMZs to protect\ncritical systems and limit exposure of network components. Vulnerabilities in SCADA DMZ\nWeb servers may provide the first step in the attack path by allowing access within the SCADA\nexterior boundary. Vulnerabilities in lower-level component’s Web servers can provide the next\nsteps in the attack path.\n\n**_4.4.3.2_** **_Protect SCADA web services against cross-site scripting_**\n\nCross-site scripting presents an entry point for attackers to access and manipulate SCADA\nnetworks. The attacker could send malicious requests to a Web site on behalf of the victim, which\ncould be especially dangerous if the victim has supervisory control privileges through that Web\napplication.\n\n##### 4.4.4 Recommendations and resources\n\nTo find and remediate web application and services vulnerabilities, such as SQL, injection,\ndirectory traversal, XSS, authentication, and session tracking, it is recommended that:\n\n    - All stakeholders that perform security checks on the client side duplicate them on the server\nside.\n\n|Common Vulnerability|Potential Impact|\n|---|---|\n|No authentication between corporate clients and Web server on DMZ|Unauthorized access from corporate network to DMZ|\n|HTTP Port 80 had no default page. Displayed directory structure.|Unauthorized access to files and directories on the Web server Compromise of Web server|\n|Arbitrary files can be read on Web server by adding ../../ or ..\\..\\ in front of file name.||\n|Multiple cross-site scripting Vulnerabilities|Compromise of Web client|\n|Persistent cross-site scripting Vulnerability||\n|Cross-site scripting on Login and History Analysis Pages||\n|Browser plug-in exploit allowed control of workstation||\n\n\n-----\n\n- All stakeholders decode and convert inputs to the application’s current internal representation\nbefore being validated. When the set of acceptable objects, such as filenames or URLs, is\nlimited or known, developers can create a mapping from a set of fixed input values (such as\nnumeric IDs) to the actual filenames or URLs, and reject all other inputs.\n\n- Vendors design their systems to perform security checks on the server side.\n\n- Vendors perform input validation using a white list of acceptable inputs that strictly conform\nto specifications, reject any input that does not strictly conform to specifications, or transform\nthe input so that it does conform to specification\n\n- Owners minimize and validate that the access controls are configured to restrict all unwanted\nusers and available functionality of:\n\no Web servers and clients\n\no SCADA\n\no Owners place web servers on a DMZ\n\nThe DHS Recommended Practice Case Study: Cross-Site Scripting suggests the following\nseven defensive actions:\n\n1. SCADA Internet access policy\n\n2. SCADA user awareness and training\n\n3. Coordination of security efforts between corporate IT network and SCADA network\n\n4. Firewall between the SCADA network and the information technology network\n\n5. Up-to-date patches\n\n6. Web browser and e-mail security\n\n7. Secure code.[23,24]\n\nThe OWASP is an open community dedicated to enabling organizations to conceive, develop,\nacquire, operate, and maintain applications that can be trusted. OWASP tools and documents can\nbe used to detect and to guard against security-related design and implementation flaws, as well\nas to add security-related activities into the Software Development Life Cycle (SDLC). The\n_OWASP Top Ten[21] ranks the most critical Web application security flaws and provides basic_\ntechniques for mitigating the highest Web application risks along with additional references. Risk\nA3, Broken Authentication and Session Management, the Authentication Cheat Sheet and the\n_Transport Layer Protection Cheat Sheet can be referenced for Web authentication information.[22]_\nThe CWE can also be referenced for information about Web security weaknesses. CWE\n[categories, CWE-287: Improper Authentication and CWE-442: Web Problems, contain related](http://cwe.mitre.org/data/definitions/287.html)\nauthentication and Web programming information as well.[9] Table 15 lists related OWASP and\nCWE resources.\n\n\n-----\n\nTable 15. OWASP and CWE Web security resources\n\n**Web Security Reference Title** **Location**\nOWASP Developer’s Guide [http://www.owasp.org/](http://www.owasp.org/)\nOWASP Testing Guide\nOWASP Code Review Guide\nApplication Security Verification Standard (ASVS)\nOpen Software Assurance Maturity Model (SAMM)\nOWASP Prevention Cheat Sheet Series\nTop 10-2010 The Ten Most Critical Web Application Security Risks\n\n[CWE-442: Web Problems](http://cwe.mitre.org/data/definitions/442.html) http://cwe.mitre.org\n[CWE-79: Failure to Preserve Web Page Structure ('Cross-site](http://cwe.mitre.org/data/definitions/79.html)\n[Scripting')](http://cwe.mitre.org/data/definitions/79.html)\n[CWE-89: Improper Sanitization of Special Elements used in an SQL](http://cwe.mitre.org/data/definitions/89.html)\n[Command ('SQL Injection')](http://cwe.mitre.org/data/definitions/89.html)\n[CWE-98: Improper Control of Filename for Include/Require](http://cwe.mitre.org/data/definitions/98.html)\n[Statement in PHP Program ('PHP File Inclusion')](http://cwe.mitre.org/data/definitions/98.html)\n[CWE-22: Improper Limitation of a Pathname to a Restricted](http://cwe.mitre.org/data/definitions/22.html)\n[Directory ('Path Traversal')](http://cwe.mitre.org/data/definitions/22.html)\n\n#### 4.5 Authentication vulnerabilities\n\nHigh risk or common SCADA authentication vulnerabilities are discussed further below, and\ninclude:\n\n- Outward facing services (that allow access from another network)\n\n- Default accounts\n\n- Support services, such as SQL services\n\nMany of the input and output validation vulnerabilities described in Section 4.4,\nCommunications end point vulnerabilities, have the potential to bypass authentication.\nAuthentication is used to enforce access controls. Weak authentication can allow access controls\nto be subverted. NSTB SCADA security assessments have shown that access to process data and\ncontrol functionality can be achieved because authentication is not required, or authentication can\nbe circumvented.\n\nStrong authentication and encryption mechanisms can be implemented and strenuously tested\nto mitigate authentication vulnerabilities.\n\nApplications that process network traffic or accept network connections can use strong\nauthentication to prevent unauthorized access and messages. Without sufficient protection, weak\nauthentication in network protocols may allow information disclosure, or replay or spoof attacks\nthat send unauthorized messages. Improper authentication may also allow unauthorized users or\ncomputers to connect to a device or application. The lack of authentication in most SCADAspecific network protocols may allow for manipulation of time synchronization and process\nalarms, commands, and data updates. Improper authentication in protocol server applications can\nallow unauthorized access to SCADA components, including SCADA hardware. Proven\nauthentication services can be used when available.\n\nPersonnel experienced in authentication and encryption systems can be involved in creating\nauthentication and encryption mechanisms. Authentication and encryption systems are complex\nand one small mistake or oversight may render the authentication or encryption ineffective. The\n\n|Web Security Reference Title|Location|\n|---|---|\n|OWASP Developer’s Guide OWASP Testing Guide OWASP Code Review Guide Application Security Verification Standard (ASVS) Open Software Assurance Maturity Model (SAMM) OWASP Prevention Cheat Sheet Series Top 10-2010 The Ten Most Critical Web Application Security Risks|http://www.owasp.org/|\n|CWE-442: Web Problems CWE-79: Failure to Preserve Web Page Structure ('Cross-site Scripting') CWE-89: Improper Sanitization of Special Elements used in an SQL Command ('SQL Injection') CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP File Inclusion') CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')|http://cwe.mitre.org|\n\n\n-----\n\nauthentication and encryption system can be tested rigorously to ensure the systems are working\ncorrectly before deploying the solutions.\n\nA well-vetted encryption algorithm considered to be strong by experts in the field and welltested implementations can be used. It is best if software is designed so that one cryptographic\nalgorithm can be replaced with another, improving upgrade capability to stronger algorithms.\n\nSCADA vendors can periodically examine their systems to ensure that the current encryption\nmethods used have not been broken because many old algorithms and implementations have\nbecome obsolete or have been discovered to be flawed.\n\nProtecting SCADA applications, like the operator’s user interface, from unauthorized access\nis important because they possess the functionalities and permissions to affect the physical\nprocess. The operator interface, or Human Machine Interface (HMI), provides graphical monitor\nand control of the physical system. Table 16 lists common vulnerabilities that allow HMI\nauthentication to be bypassed.\n\nTable 16. Common vulnerabilities associated with bypass of HMI authentication\n\n**Common Vulnerability** **Potential Impact**\nLogin information remembered Authentication without credentials\nKerberos authentication always succeeds\nClient-side user and password validation\nNo limit on authentication attempts Password guessing or cracking\n\nThis section first presents the recommendation that authentication take place at both the\nserver and the client. It then discusses several ways to manage authentication credentials,\nincluding changing default passwords, the use of strong passwords, implementation of an\neffective password policy, and rigorous protection of authentication credentials.\n\n##### 4.5.1 Perform authentication at both the server and the client \n\nApplications that authenticate users locally trust the client that is connecting to a server to\nperform the authentication. Because the information needed to authenticate is stored on the client\nside, a hacker can extract that information or modify the client to not require authentication.\nAttackers can bypass the client-side checks by modifying values after the checks have been\nperformed, or by changing the client to remove the client-side checks entirely. Then, these\nmodified values can be submitted to the server.\n\nSCADA developers can implement robust authentication by the server or component that is\ngranting access.\n\n##### 4.5.2 Manage authentication credentials \n\nPasswords can be the weakest link in an authentication architecture. Typically, this is due to\nhuman and policy factors and can only be partially addressed by technical remedies. SCADA\nsystems have many levels of passwords that could be the weak link an attacker needs to gain\naccess to the system. OS-level passwords are used when the user logs onto a machine, and for\nauthenticating OS-level services, like network file systems. With Windows computers,\nadministrators can ensure that both the local accounts and the domain accounts have strong\npasswords.\n\n|Common Vulnerability|Potential Impact|\n|---|---|\n|Login information remembered|Authentication without credentials|\n|Kerberos authentication always succeeds||\n|Client-side user and password validation||\n|No limit on authentication attempts|Password guessing or cracking|\n\n\n-----\n\nThe reality of working on an SCADA is that most user IDs and passwords are shared among\nthe different operators of the system. This sharing exists, in many cases, because of the\ncontinuous operational criticality of the system the operators are running and the corresponding\nemphasis on availability. The cost of an outage because of a locked user ID or a forgotten\npassword may be too high.\n\nIf user-level authentication is not an option, using different user IDs and passwords for the\nDMZ, as well as different user IDs and passwords for the business LAN, can help increase\nsecurity. This prevents an attacker from using a user ID and password obtained from the business\nLAN to gain access to the SCADA DMZ and/or the SCADA LAN and may also prevent\nauthorized users from performing actions that cannot easily be attributed to them. Likewise,\neffective passwords that meet minimum security requirements and are frequently changed are key\ncomponents of secure authentication to these systems. Typical continual manning of operating\nconsoles can provide additional physical security that reduces the need for distinct operator user\nIDs and passwords.\n\nApplication-level passwords can be managed as well. This includes Web applications,\nSCADA applications, etc.\n\nPasswords that protect backend services, such as SQL services, can be overlooked because\nthey are usually not directly exposed to the user. This can be dangerous because many of these\nservices will provide full server access to anyone who connects to them. For example, strong\npasswords at the OS-level may not provide much protection if the database still has the default\naccounts and passwords, and allows a remote connection to execute shell commands as the\nsystem user.\n\n**_4.5.2.1_** **_Change default passwords_**\n\nNSTB assessments have identified many cases of third-party products delivered with the\nSCADA system that had no passwords or had default passwords. These accounts can remain unconfigured, sometimes because SCADA owners are unaware that they exist.\n\nSome assessments discovered applications that had been configured without passwords, so\nthat access to these applications guarantees the ability to authenticate and interact with them.\nDefault database accounts were often found without passwords. Another common finding during\nNSTB assessments was that even though secure authentication applications were used,\ninstallations and configurations were not correct. This may be due to oversight during test system\nconfiguration rather than a problem with the default settings on a newly deployed system.\n\nHosts can be exposed to attack by anyone able to connect and authenticate using the default\naccounts and passwords. Default passwords can give an attacker easy access to the equipment\nthat controls the process. Exploiting a system with default accounts is possible with access to the\ndocumentation, or access to a sample system that allows an attacker can discover the accounts for\nthemselves. In many cases default passwords are globally available on the Internet.\n\nUnless disallowed by SCADA software requirements, SCADA owners can change default\npasswords from the manufacturers of SCADA and networking equipment to a robust,\nunpublished password. In the case that the software uses hardcoded passwords, SCADA owners\nmay be able to work with the vendor to fix this vulnerability. They can then implement a\npassword policy that enforces strong passwords to greatly impede password cracking and\nguessing.\n\nConfiguration procedures can be put in place to ensure secure and consistent default\nconfigurations.\n\n\n-----\n\nDefault accounts can be removed, with each installation using different and strong passwords.\nImplementing different accounts and passwords on different systems prevents an attacker from\ntranslating knowledge learned on one system to another system.\n\nDocumentation about the default accounts can be distributed to all users so they know that the\naccounts exist and can take the initiative to remove or change their passwords.\n\nStrong passwords can be required and deployed on networking, client, and server equipment\nand that passwords are implemented on SCADA components to prevent unauthorized access.\n\nAdministrators can change the default manufacturer passwords on SCADA and networking\nequipment. Default passwords may give an attacker easy access to the equipment that controls the\nprocess. Owners/Operators should change default passwords to robust, unpublished passwords. In\nthe case that the software uses hardcoded passwords, SCADA Owners/Operators can work with\nthe vendor to address this vulnerability. They can then implement a password policy that enforces\nstrong passwords which impedes password cracking and guessing.\n\nCommon practice for an attacker once access is gained is to create backup administrative\naccounts in case the compromised account is detected. Therefore, regular polling of all usernames\ncan not only help ensure that accounts have passwords, but also help detect compromised\nsystems.\n\nIn some SCADA operations, user IDs and passwords are shared among the different\noperators of the system. This sharing must exist, in many cases, because of the criticality of the\nsystem operation. Unacceptable consequences might occur because of a locked user ID or a\nforgotten password. Typical continual staffing of operating consoles can provide additional\nphysical security that reduces the need for distinct operator user IDs and passwords. If user-level\nauthentication is not an option for operators, integrators or administrators can ensure all users\nhave separate accounts for all other account types in the SCADA to help increase security and\naccountability. These actions can prevent an attacker from using a user ID and password obtained\nfrom the business LAN to gain access to the SCADA DMZ and/or the SCADA LAN and also\nprevent authorized users from performing actions that cannot easily be attributed to them.\n\n**_4.5.2.2_** **_Use strong passwords_**\n\nSome passwords can easily be guessed by humans or computer algorithms to gain\nunauthorized access. The longer and more complex a password is, the more time needed to guess\nor crack the password. Cracking a password can be trivial or virtually impossible depending on\nthe combination of different character types used with larger password lengths.\n\nA password strength policy can contain the following attributes: (1) minimum and maximum\nlength; (2) require mixed character sets (alpha, numeric, special, mixed case); (3) do not contain\nuser name; (4) expiration; and (5) no password reuse. Authentication mechanisms require\nsufficiently complex passwords and require that they be periodically changed.[5] Table 17 lists\ncommon vulnerabilities associated with lack of SCADA application authentication.\n\nTable 17. Common vulnerabilities associated with lack of SCADA application authentication\n\n**Common Vulnerability** **Potential Impact**\n\nNo authentication between corporate clients and Web Unauthorized access to DMZ from\nserver on DMZ corporate network\n\nConnection to Historian without user name or password Unauthorized access to Historian\n\n|Common Vulnerability|Potential Impact|\n|---|---|\n|No authentication between corporate clients and Web server on DMZ|Unauthorized access to DMZ from corporate network|\n|Connection to Historian without user name or password|Unauthorized access to Historian|\n\n\n-----\n\n**_4.5.2.3_** **_Implement an effective password policy_**\n\nPasswords exist at multiple locations, many of which don’t have automated policies that can\nbe applied. If a product does not use strong passwords, it is easier for attackers to compromise\nuser accounts. “An authentication mechanism is only as strong as its credentials. For this reason,\nit is important to require users to have strong passwords.”[5]\n\nThe length, strength, and complexity of passwords are balanced with security and operational\nease of access within the capabilities of the software and underlying operating system. If a\npassword is too complicated and difficult to remember, or it changes too often, users may\nundermine their security to remember them. Passwords have been found in control rooms on\nsmall pieces of paper on the bottom of the keyboard, in a drawer, etc. Complex passwords do\nprotect against some of the advanced password cracking attacks, but they can create a physical\nand social engineering vulnerability that could be exploited by an attacker. Therefore, passwords\ncan be created from passphrases or other memorable means rather than auto-generated.\n\nPassword policies can be implemented to define when passwords are needed, how strong they\nmust be and how they should be maintained. Without a password policy, systems might not have\nappropriate password controls, making unauthorized access more likely. Passwords that are short,\nsimple (e.g., all lower-case letters), or otherwise do not meet typical strength requirements are\nvulnerable to being cracked. Password strength also depends on whether the specific SCADA\napplication was designed to support more stringent passwords. Table 18 shows general weak\npassword findings.\n\nTable 18. Common vulnerabilities associated with weak password requirements.\n\n**Common Vulnerability** **Potential Impact**\nPassword was found on the device it was meant to protect Unauthorized access\nMaximum password length is too short Password guessing or cracking\nMinimum password length is too short\nNo minimum length for user interface password\n\n**_4.5.2.4_** **_Protect user authentication credentials_**\n\nUser authentication credentials can be vigorously protected and made inaccessible to an\nattacker. Whenever credentials are passed in clear text, they are susceptible to being captured. If\nstored password hashes are not properly protected, they may be accessed by an attacker and\ncracked.\n\nPassword files can be secured by making hashed passwords more difficult to acquire (e.g.,\nrestrict access by using a shadow password file or equivalent on UNIX systems). Services can be\nreplaced or modified so that all user credentials are passed through an encrypted channel.\n\nLAN Manager (LM) password hashes can be cracked within seconds using freely available\ntools. All Windows hosts support LM passwords and all versions before Windows Vista and\nWindows Server 2008 compute and store passwords using the LM hash algorithm by default. LM\nhashes can be disabled on all Windows hosts and domain controllers.26 Client security policies\ncan be configured so that only the Windows NT (NTLM) response is given.\n\nIf LM authentication is required, the configuration settings can be updated so that only the\nnew NTLM network authentication is used. Because LM hashing does not support passwords\nlonger than 14 characters, users can prevent a LM hash from being generated for their password\nby using a password at least 15 characters in length.\n\n|Common Vulnerability|Potential Impact|\n|---|---|\n|Password was found on the device it was meant to protect|Unauthorized access|\n|Maximum password length is too short|Password guessing or cracking|\n|Minimum password length is too short||\n|No minimum length for user interface password||\n\n\n-----\n\nTable 19 shows examples of weak protection of user credentials.\n\nTable 19. Common vulnerabilities associated with weak protection of user authentication\ncredentials\n\n**Common Vulnerability** **Potential Impact**\nUser names and passwords are stored in database Discovery of ID and password\nDatabase user name and password found in\ndocumentation\n\n##### 4.5.3 Recommendations and resources\n\nTo find and remediate authentication vulnerabilities, in outward facing services, default\naccounts, and support services, it is recommended that:\n\n    - All stakeholders follow well-vetted strong authentication and cryptographic practices\n\no In applications that process network traffic or accept network connections\n\no When available, use proven authentication services\n\no When creating authentication and encryption mechanisms, involve experienced personnel\n\no Before deploying solutions, rigorously test authentication and encryption systems for\ncorrectness\n\no After solution implementation, strenuously test authentication and encryption\nmechanisms for correctness on the server and client\n\n    - Vendors periodically examine their systems for broken encryption\n\n    - Vendors distribute documentation about any default accounts to all owners\n\n    - Vendors implement support for strong passwords and protect authentication credentials in the\nsoftware\n\n    - Owners develop, implement, and enforce password policies as part of an overall SCADA\nsecurity program, including:\n\no Strong password mandates\n\no On networking, client, and server equipment\n\no On both the local and domain accounts of Windows computers\n\no For all cyber assets inside the electronic perimeter with a reasonable lifespan limit\n\no Take into account the capabilities of the SCADA system to handle the most complex\npasswords as possible\n\no Are created from passphrases or other memorable means rather than auto-generated\n\no Password mandates on SCADA components\n\no Discouragement of the use of common passwords, especially common administrative\npasswords\n\n|Common Vulnerability|Potential Impact|\n|---|---|\n|User names and passwords are stored in database|Discovery of ID and password|\n|Database user name and password found in documentation||\n\n\n-----\n\n- Owners develop and implement authentication procedures to ensure secure and consistent\ndefault configurations\n\no System integrators and administrators configure the systems to require and protect strong\npasswords\n\no Remove default accounts, use different passwords for each installation, and make each\npassword strong\n\no Change the default manufacturer passwords for SCADA and networking equipment\n\no Follow and test instructions for secure installation and proper configuration for each\napplication\n\no Implement authentication mechanisms that require sufficiently complex passwords and\nrequire that they be periodically changed\n\no Vigorously protect and make inaccessible user authentication credentials\n\no SCADA administrators ensure that all users on any system are documented and have\nsecure passwords\n\no Regularly poll all usernames to help ensure that all accounts have passwords, and also\nhelp detect compromised systems\n\no Users create and protect their own authentication credentials\n\no If user-level authentication is not an option for operators, integrators or administrators\nensure all users have separate accounts for all other account types in the SCADA\n\nThe SANS Institute’s sample password policies provide guidance on creating, protecting, and\nchanging passwords.[24,25] Tips for creating strong passwords are widely available. A few\nexamples are listed below:\n\n- [CWE-521: Weak Password Requirements, http://cwe.mitre.org/data/definitions/521.html](http://cwe.mitre.org/data/definitions/521.html)\n\n- _Secrets to the Best Passwords,_\n[http://www.computerworld.com/s/article/82883/Secrets_to_the_best_passwords](http://www.computerworld.com/s/article/82883/Secrets_to_the_best_passwords)\n\n- _Password Security, Red Hat,_ [http://www.redhat.com/docs/manuals/linux/RHL-8.0-](http://www.redhat.com/docs/manuals/linux/RHL-8.0-Manual/security-guide/s1-wstation-pass.html)\n[Manual/security-guide/s1-wstation-pass.html](http://www.redhat.com/docs/manuals/linux/RHL-8.0-Manual/security-guide/s1-wstation-pass.html)\n\n- _Minimum Password Complexity Standard,_\n[https://security.berkeley.edu/MinStds/Passwords.html](https://security.berkeley.edu/MinStds/Passwords.html)\n\n- The SANS Institute’s sample password policies.[24,25]\n\n#### 4.6 Authorization vulnerabilities\n\nAccess controls restrict access to entities in a network, host, or software system. Access\ncontrol mechanisms check whether an entity is authorized to have access to a given object or\nperform a given action. This act of validating access rights is called authorization.\n\nAccess controls can be incorporated into SCADA components to help prevent and contain\ncompromise. The SCADA environment can be locked down by providing strong authentication,\ncompartmentalizing functionality, and limiting application, service, and user permissions to only\nthe required access and functionality necessary.\n\n\n-----\n\nIf an attacker gains full access to a host, all functions that the server can execute can be under\nthe attacker’s control. In addition, host access gives the attacker access to the resources of the\ncompromised server, including communications with other devices and servers.\n\nSCADA developers and owners can reduce the attack surface by restricting access to\nfunctionality, hosts and networks. Restrict SCADA information and functionality to those who\nrequire access to them. Enforce authorization for applications that perform SCADA functions and\nthe computers that host them. Implement mechanisms to control access to SCADA hosts and\nfunctionality. All applications, hosts and networks can be locked down as much as possible to\nlimit the consequences of compromise. Once an attacker has gained access to a host,\ncompartmentalization and access controls can be used to contain them.\n\nAccess control mechanisms rely on proper identification and authentication (i.e., user name\nand password). Identification is an assertion of who someone is or what something is.\nAuthentication is the act of verifying a claim of identity.\n\nAccess control mechanisms determine which system resources a person, program, or\ncomputer is allowed to access and which actions are allowed (run, view, create, delete, or change)\nafter successful identification and authentication. Access control mechanism configuration can\nenforce policies that describe what information and computing services can be accessed, by\nwhom, and under what conditions.\n\nAuthentication credentials must be protected from unauthorized access. Encryption can\nprotect confidentiality of authentication credentials. However, cryptography can introduce\nsecurity problems when not implemented correctly. Protect keys used for encryption and\ndecryption.\n\nThis section discusses the need to implement least-privilege access control and the associated\nrecommendation to limit functionality only to that required, which enables the ability to\nimplement least-privilege access control. Finally, this section discusses authorization\nvulnerabilities that may arise through configuration of SCADA components.\n\n##### 4.6.1 Restrict privileges, permissions and access to the least needed \n\nPrivileges, permissions and access can be restricted to the least needed to perform the work at\nhand. This includes access privileges for user accounts, file permissions, Web server and\ndatabase, as well as process execution privileges for services.\n\nSCADA vendors can implement or enhance access controls and authentication in their\nproducts to limit within them the severity of vulnerabilities. Running SCADA services and\napplications with full privileges can increase the potential consequences of compromise.\nApplications that require high privileges usually require that the user have elevated privileges as\nwell. Limiting the access privileges of users and programs to the required privileges and\nfunctionality can limit the ability of an attacker to successfully exploit associated vulnerabilities\nby creating less-accessible attack vectors and increasing the attack complexity. The potential\nimpacts to the system can be limited to the privileges and available functionality of the exploited\nprogram.\n\nDefensive measures can minimize vulnerability exposure and the opportunity for malicious\nactions. Restricting access and permissions of processes and users can minimize potential\ndamages from successful attacks. Good design can also raise the potential costs of attacking in\nterms of time and equipment needed to penetrate. Hardening and protective measures, such as\ncompartmentalization to enable privilege separation, can be designed into all critical\ninfrastructure SCADA systems.\n\n\n-----\n\nIn the case that users operate a computer system (consoles, servers, etc.) with more\npermissions than required, an attacker may be able to redirect execution; exploit code will run\nwith those same privileges giving the attacker full access to that device.\n\nCarefully evaluate user accounts to determine the lowest set of permissions necessary. File\naccess can then be restricted to those who require access. If network access to a file is necessary,\naccess can be restricted as much as possible and require strong authentication.\n\nMany SCADA user accounts are given administrator or root privileges which gives the\nauthenticated user full access over the host. User accounts used for interactive logon can be\ncarefully evaluated for the proper set of permissions. The OS access control capabilities can be\nconfigured with Access Control Lists (ACLs) using a “default deny” policy. SCADA vendors can\nspecify the minimum set of access controls necessary for users of their system to perform the\nrequired operations. Otherwise, SCADA owners may not make changes due to concerns that\nvendor support may be unavailable.\n\nLikewise, file shares can be restricted to only those users who require access and to the access\nlevel they require. Files shared by SCADA vendors and owners can be restricted to only the\ncomputers and accounts that require them. To implement this:\n\n- Restrict the read and write permissions of shared files and directories to the minimum\nrequired for each user\n\n- Restrict ability to create network shares to the users that need this functionality (generally\nadministrators)\n\n- Use network segmentation and firewall rules that block access to file sharing ports.\n\nFor Web server access control for Web applications, SCADA developers can make sure that\nthe access control mechanism is enforced correctly at the server side on every page. Another way\nto reduce exposure is to prevent users from accessing unauthorized functionality or information\nthrough a simple request for direct access to that page. One way to do this is for SCADA\ndevelopers to ensure that all pages containing sensitive information are not cached, and that all\nsuch pages restrict access to requests that are accompanied by an active and authenticated session\ntoken associated with a user who has the required permissions to access that page.\n\nFor database access control, SCADA vendors can ensure that their database functionalities\nfollow the principle of least privilege. Database access controls may need to be more specific than\nthe generic roles-based rules. Access control checks can be based on the SCADA’s functionality\nand business logic. For example, database access should be based on the record being accessed,\nnot just by database user.\n\nProcess execution with unnecessary privileges is a high-level root cause of many\nvulnerabilities. By default, some SCADA installations start services as the root user and root\ngroup. Many services may not need to be started with this privilege level, and doing so may\nexpose system resources to preventable risks. A common problem with applications and services\nis that they are run with system or root-level privileges. Software products may run with these\nsuper user permissions by default even though their functions do not require them. Therefore,\npermission levels of applications and services can be lowered to that necessary for their required\nfunctions. Applications and services that execute with higher than necessary privileges may\nincrease the risk and impact of exploitation. Successful exploitation grants the attacker the same\nprivileges as the compromised application. This includes network privileges of the compromised\nuser and/or host. An attacker may also be able to utilize unnecessary functionality incorporated\ninto applications and services, even if they are disabled.\n\n\n-----\n\nExploitation of a service could allow an attacker a foothold on the SCADA network with the\nexploited service’s permissions. Services are restricted to the user rights granted through the user\naccount associated with the service. Privilege escalation can be accomplished by exploiting a\nvulnerable service running with more privileges than the attacker has currently obtained. If\nsuccessfully exploited, services running as a privileged user could allow full access to the\nexploited host. By restricting necessary privileges during SCADA design and implementation,\nSCADA vendors can significantly reduce the window of exposure and criticality of impact in the\nevent that a vulnerability is found in that service.\n\nSecurity policy defines that security goals and measures be incorporated and enforced\nthrough access control mechanisms in design, code, security features, and the host and network\nenvironment.\n\n##### 4.6.2 Remove unnecessary functionality\n\nSCADA applications, services and protocols with unnecessary functionality can prevent the\nimplementation of least-privileges by the users. Compartmentalization of functionality can help\nrestrict individual SCADA functions to the applications and users that require them. This can also\nhelp implement least-privileges by separating out the functionalities that do require elevated\nprivileges.\n\nIncorporation of the principle of least privilege may require a redesign of some SCADA\ncomponents. Removing unnecessary functionality on SCADA hosts includes removing all\nservices and applications that are not necessary for each individual host’s role. This requires\ndocumentation on required services, communication partners, and direction of communication.\n\n##### 4.6.3 Secure SCADA component configuration \n\nNSTB assessments have encountered quality control issues related to configuration errors.\nHost configurations are inconsistently deployed by SCADA vendors. The installation,\nconfiguration, and patching of OSs, applications, services, and libraries varies by integrator or\nsystem administrator. When secure configuration documentation does exist, it may not be\nsufficiently detailed or followed.\n\nSCADA vendors can create a methodical and documented procedure or automated process\nfor configuring SCADA components. Procedures can be customized for specific SCADA\ncomponents and functionality. SCADA integrators and administrators can request security\ndocumentation, procedures, and/or tools and use them to secure their systems. SCADA owners\ncan specifically request and enforce this support either during system procurement or when\nnegotiating security contracts.\n\nSCADA customers can conduct security audits of SCADA products and determine\nappropriate mitigations to meet specified security levels as part of the procurement process. This\nallows the SCADA customers to identify security risks of the products and determine whether\nthey are acceptable and/or able to be mitigated. SCADA owners/operators can also conduct\nexternal security audits on their existing systems to identify risks that need to be mitigated.\n\nComplete documentation and/or automated setup of security features can be provided to\nallow for straightforward and more consistent implementation of SCADA components and\nsecurity features. Security features that are difficult to configure and implement are typically not\nused or are used incorrectly in the field installations of SCADA. Security features that are\n\n\n-----\n\ninconsistently implemented or provide inconsistent results may be a risk to reliability and\navailability of the SCADA in an operational environment.\n\n##### 4.6.4 Recommendations and resources\n\nTo find and remediate compromise in authorization vulnerabilities, it is recommended that:\n\n    - All stakeholders share files only to the computers and accounts that require them\n\n    - All stakeholders implement protection schemes that deny access by default and can identify\nconditions under which access is permitted\n\n    - Vendors provide complete documentation of security features\n\no Specify the minimum set of access controls necessary for users of their system to perform\nthe required operations\n\no Specify necessary applications, services, user accounts, as well as the necessary\nprivileges and communications for each\n\n    - Vendors provide where possible automated setup of security features, including processes for\nconfiguring SCADA components\n\n    - Owners work with Vendors to restrict user accounts, applications, and services to the lowest\nset of privileges, permissions, and access necessary for system functionality\n\n    - Owners individually restrict the privileges granted to user accounts, applications and services\n\nImproper Access Control (Authorization) is fifth on the 2010 CWE/SANS Top 25 Most\n_Dangerous Programming Errors list.[10] The third recommendation in the SANS/CWE software_\n“Monster Mitigation” list addresses unnecessary privileges.[11]\n\n#### 4.7 Network access control vulnerabilities\n\nAttackers can take advantage of the tendency for network devices to become less securely\nconfigured over time as system users demand exceptions for specific and temporary business\nneeds, the exceptions are deployed and are often not removed when the business need is no\nlonger applicable. In some cases, the security risk of the exception is not properly analyzed, nor is\nthis risk measured against the associated business need.\n\nAttackers can search for electronic holes in firewalls, routers, and switches and use those to\npenetrate defenses. Attackers have exploited flaws in these network devices to gain access to\ntarget networks, redirect traffic on a network (to a malicious system masquerading as a trusted\nsystem), and to intercept and alter information while in transmission. Through such actions, the\nattacker can gain access to sensitive data, alter important information, or use one compromised\nmachine to pose as another trusted system on the network.\n\nComplete information on how their system operates can help SCADA customers develop\neffective network isolation architectures and configurations to mitigate some of the identified\nvulnerabilities and others that may arise. To this end, SCADA vendors can identify and delineate\nall required ports and services necessary to support their products. This will better equip the end\nuser with the tools needed to achieve effective network isolation for their implementation of the\nSCADA product.\n\n\n-----\n\nThis section discusses the need to implement secure access to network devices, and to\nconfigure a secure network architecture through segmentation, strong firewall rules and secure\nconnections across security zones. Finally, it explores the use of intrusion detection techniques in\nthe SCADA system.\n\n##### 4.7.1 Secure network device access\n\nA common NSTB assessment finding was that network device access control lists did not\nrestrict management access to the required IP addresses. Network devices were also found that\nwere configured to allow remote management over clear-text authentication protocols. Without\nthese restrictions, an attacker can gain control by changing the network device configurations.\n\nGiven the static nature of SCADA environments, port security may be used to ensure MAC\naddresses do not change and new devices are not introduced to the network. Actions such as\nlimiting known MAC addresses to specific interfaces and disabling unused interfaces can be\nimplemented to assist in network security.\n\nUnauthorized network access through physical access to network equipment includes the lack\nof physical access control to the equipment, including the lack of security configuration functions\nthat limit functionality even if physical access is obtained. A lack of port security on network\nequipment was a common finding in NSTB assessments. A malicious user who has physical\naccess to a port on a network switch behind the firewall can circumvent its incoming filtering\nprotection. Table 20 shows network device configuration common vulnerabilities.\n\nTable 20. Common vulnerabilities associated with network device configuration\n\n**Common Vulnerability** **Risk**\nNetwork device configured for management Management credentials can be sniffed off the\nover insecure protocols network\n\nNetwork device ACLs do not restrict by IP Device management access is not restricted\naddresses\n\nNetwork switch not configured with port Switch is not protected against physical connections\nsecurity\n\n##### 4.7.2 Secure network architecture\n\nFirewall rules implement the network design. They determine which network packets are\nallowed in and out of a network. Without outbound restrictions the system can be vulnerable to\nindirect attack on connections that originated from the SCADA. Packets can be filtered based on\nIP address, port number, direction, and content. The protection provided by a firewall depends on\nthe rules it is configured to use.\n\nFirewall rules restrict traffic flow as much as possible. They enforce network access\npermissions and allowed message types and content.\n\n**_4.7.2.1_** **_Use network segmentation_**\n\nNetwork segmentation creates security zones that separate systems with different security and\naccess requirements to provide access control. Components on the same network segment are\neffectively given the same level of trust. Each security zone includes components that need to\ncommunicate and can be allowed the same trust levels.\n\n|Common Vulnerability|Risk|\n|---|---|\n|Network device configured for management over insecure protocols|Management credentials can be sniffed off the network|\n|Network device ACLs do not restrict by IP addresses|Device management access is not restricted|\n|Network switch not configured with port security|Switch is not protected against physical connections|\n\n\n-----\n\nNSTB assessments have revealed that the security level of production SCADAs can be\nlargely dependent on the effectiveness of the SCADA network design to prevent unauthorized\naccess. Networks can be separated into layers and zones based on security levels and\nfunctionality with specific access rules to restrict all communication to only that necessary for\nsystem functionality. Although not all cyber attacks will have a catastrophic impact, these attacks\ncan be prevented, detected, or stopped before they have the opportunity to affect critical SCADA\nfunctions. If the network has been designed and implemented correctly, an attacker is limited to\nfinding vulnerabilities in the network equipment, authorized users/systems, protocols, or\nassociated applications/servers allowed into each network segment only, and must do so without\nbeing detected.\n\nNetworks with minimal or no security zones allow vulnerabilities and exploitations to gain\nimmediate full control of the systems, which could cause high-level consequences. Backdoor\nnetwork access is also not recommended and could cause direct access to the SCADA for\nattackers to exploit and take full control of the system.\n\nSCADA components with connections located on the business network are subject to the\nsame exposure as any other device with a business host connection. Host security levels may\nvary, but communication channels between network security zones are exposed to threats on both\nnetworks (and any intermediate networks).\n\nEven with good network design that uses security zones, SCADA vulnerabilities can be\nexposed to less-trusted networks that provide remote monitoring, data sharing, historical, and\nother remote access functions. Because access to SCADA software vulnerabilities cannot be\nprevented entirely, vulnerability remediation remains necessary.\n\nTo provide defense-in-depth, firewalls can be used to separate different layers of the SCADA\nnetwork (i.e., the HMI level LAN from the SCADA DMZ from the corporate network). These\nlayers can be further segregated into security zones to protect systems from attack through\ncompromised systems on that layer. Consider creation of multiple DMZs, or security zones, for\nseparate functionalities and access privileges, such as peer connections, the data historian, the\nOPC server or ICCP server in SCADA systems, the security servers, replicated servers, and\ndevelopment servers.\n\nAny connection into the SCADA LAN is considered part of the perimeter. Often these\nperimeters may not be well documented and some connections may be neglected. All entry points\ninto the SCADA LAN can be determined and strictly managed by a security policy. Ensuring all\nconnections are routed to the SCADA LAN through the firewall will enforce proper configuration\nmanagement policy and monitoring. Maintaining an accurate network diagram of the SCADA\nLAN and its connections to other protected subnets, DMZs, the corporate network, and the\noutside is essential for network administrators. Table 21shows common vulnerabilities found\nwithin SCADA network designs.\n\nTable 21. Common vulnerabilities associated with insecure network design\n\n**Common Vulnerability** **Potential Impact**\nSingle Point of Failure Network DoS\nHistorian Server is on the Corporate LAN Unnecessary exposure\nFirewall Bypass (circumvented) Unprotected attack path\n\n|Common Vulnerability|Potential Impact|\n|---|---|\n|Single Point of Failure|Network DoS|\n|Historian Server is on the Corporate LAN|Unnecessary exposure|\n|Firewall Bypass (circumvented)|Unprotected attack path|\n\n\n-----\n\n**Training**\n\nIn some cases, the individuals in charge of securing the SCADA network may not have\nadequate security training. Training can provide an understanding of the security implications of a\ngiven network architecture and how to design a more secure network. Educating or hiring\nnetwork administrators with skills to design and manage the SCADA network and its perimeter\ndefenses with the most current security techniques may be essential.\n\n**_4.7.2.2_** **_Use strong firewall rules_**\n\nFirewall rules implement network segmentation. Firewall rules determine which network\npackets are allowed in and out of a network. Packets can be filtered based on port number, IP\naddress, direction, and content. The protection provided by a firewall depends on the rules with\nwhich it is configured. Enforcement of network access permissions, allowed message types, and\ncontent is executed by firewall rules.\n\nWell-configured firewalls are critical to SCADA security. Communications can be restricted\nto those necessary for system functionality. SCADA traffic can be monitored, and rules\ndeveloped that allow only necessary access. Any exceptions created in the firewall rule set should\nbe as specific as possible, including host, protocol, and port information. All rules should be\nconcise and well documented. The IDS sensors can then be used to audit the firewall rule set.\n\nThe top priority of most SCADA installations is availability. The risk to availability of any\nsecurity feature must be weighed against the expected added security benefit (lowered risk).\nSCADA network administrators may not want to risk the chance of impacting SCADA\nfunctionality by redesigning the network or updating rules as components are added or removed.\nNetwork traffic can be monitored for a long enough period to be confident all possible scenarios\nhave occurred. Rules can then be created starting with the standard restrictions and working\ntoward a rule set that excludes all unnecessary traffic. Once the necessary traffic has been\ndetermined, a safer configuration can then be created that blocks all traffic with exceptions for the\nspecific host, protocol, and port combinations that require access in each direction through the\nfirewall.\n\nImplement firewall rules on production SCADA carefully, slowly working toward a rule set\nthat excludes all traffic, with exceptions for including needed communication. Once the necessary\noutbound traffic has been determined, a more secure configuration can then be created that blocks\nall traffic with exceptions for necessary communication.\n\nSCADA owners can determine necessary communication by monitoring network traffic,\nimplementing IDS rules first, and then altering the rules, based on alerts from valid traffic, until\nconfidence is gained that the rules will not impair system functionality. Monitor firewall logs for\nindications that legitimate system traffic is being blocked.\n\n**Port numbers**\n\nThe attacker may remotely connect to services listening on ports allowed through a firewall.\nOpen ports and services that are not necessary may provide a potential foothold or path for an\nattacker. All unneeded applications and services should be removed and then blocked by the\nfirewall as well. In the event that a service is installed or enabled, this layer of defense can\nprevent connections to unauthorized services through the firewall.\n\nNetwork protocols specify how information is packaged and sent across a computer network.\nClient and server applications are used to send and receive data that conforms to a given protocol.\n\n\n-----\n\nFor every network protocol, an application (known as a server) must wait for and process the data\noff the network. Corresponding client applications initiate communication sessions for that\nprotocol. The client is able to identify the correct server to connect to by the port number on\nwhich it is listening. For example, common IT protocols use standard port numbers that all\nversions of server applications listen on. An FTP client knows to request a connection on Port 21.\n\nFirewalls can restrict access on a host by specifying the port numbers of the applications that\nare allowed to accept connections. A host can be configured to only accept connections on the\nSSH Port 22, for example. This means that if an attacker wants to attack this host, it will have to\nbe done by exploiting the SSH protocol, the SSH server installed on that machine, or an account\nthat has privileges to establish SSH connections with that host.\n\nSome SCADA vendor proprietary protocols use ranges of port numbers for their servers.\nFirewall rules must then allow connections to system hosts on any of the port numbers in this\nrange. With access to the host, an attacker could download his own server and configure it to\nlisten on one of these open ports.\n\n**Inbound and outbound directions**\n\nFirewall and router filtering deficiencies allow access to SCADA components through\nexternal and internal networks. The lack of incoming access restrictions can create access paths\ninto critical networks.\n\nA common oversight in firewall configuration is not restricting outbound traffic. Firewall\nrules considering both directions through the firewall are recommended. An exploit that cannot\nconnect back to the attacker is limited to blind attacks. To be successful, an attacker needs to\nobtain information from and send files and commands to the SCADA network. To remotely\ncontrol exploit code running on a SCADA computer, a return connection must be established\nfrom the SCADA network. Because of the nature of most vulnerabilities, exploit code must be\nsmall and contain just enough code to get an attacker onto the computer. Insufficient space is\navailable to add expensive logic for the attacker to use advanced functionality. Therefore,\nadditional instructions are needed from the attacker to continue with the discovery portion of the\nattack. If outbound filtering is implemented correctly, the attacker will not receive this return\nconnection and cannot discover and control the exploited machine.\n\nIn contrast, insufficient outbound restrictions can make the system vulnerable to indirect\nattack on connections that originated from the SCADA. The lack of outgoing access restrictions\ncan allow access from internal components that may have been compromised. For an attacker to\nremotely control exploit code running on the user’s computer, a return connection must be\nestablished from the victim network.\n\nAnother common NSTB assessment finding was that firewall rules allowed access to unused\nIP addresses traceable to legacy configuration of the firewall. This can create an attack path that\nallows an attacker to use this IP address to gain access through the firewall.\n\nThe remaining specific NSTB assessment finding associated with this vulnerability involved\naccess to specific ports granted for an entire address space or unrestricted by an IP address at all.\nFirewall rules that restrict access to specific ports, but not IP addresses, provide little protection.\nAssessment findings that fall under this vulnerability are firewall rules that are based on address\ngroups that include a wider range than may be necessary.\n\nNetwork defenses that utilize specific firewall and Intrusion Detection System (IDS) rules\ncan help control and monitor access, even if an attacker has gained access inside the SCADA\nperimeter. The better legitimate traffic can be defined, the more likely unauthorized network\n\n\n-----\n\ntraffic can be blocked or detected. This requires an understanding of the network protocol,\nincluding the valid structure and value ranges. An attacker who has gained access and privileges\nof a legitimate user often performs actions not typical for that user (or the SCADA).\n\nSpecific firewall and IDS rules can block or detect abnormal activity. An IDS does not add\nrisk of compromising operations because it is passive and only alerts on suspicious traffic.\nHowever, accurate, custom rules along with dedicated and qualified monitoring are necessary for\neffective intrusion detection.\n\nGreater assurance that network security changes will not affect operations can be obtained by\nimplementing changes as IDS rules. IDS logs can be monitored for alerts identifying traffic that\nwould have been prevented by the new segmentation or access rules. All proposed network\nchanges can be tested as IDS rules for as long as necessary to provide assurance that they will not\naffect critical functions. Because IDSs do not prevent access, closely monitoring IDS logs during\nthis period and immediate investigation of unexpected communication is recommended.\n\nNot all assessment findings were related to system functionality. Many findings from\nproduction SCADA assessments related to firewall rules that allowed IP addresses to initiate\nconnections between networks even though they did not require this access for SCADA\nfunctionality. Firewall rules that apply to functional groups can use defined finite groups that are\nrestricted to required IP addresses. Firewall rules that are no longer needed can be removed as\npart of a change management procedure or periodic system review or audit. Access control lists\ncan be used to limit management access of network equipment to only those who need it. Table\n22 lists specific NSTB assessment findings associated with overly permissive firewall rules.\n\nTable 22. Common vulnerabilities associated with unnecessary exposure from firewall rules\n\n**Common Vulnerability** **Potential Impact**\nLack of or improper segmentation into security zones Unnecessary exposure from\nconnected networks\nAccess to excessive number of ports is allowed\nAccess to excessive number of IPs is allowed\nLack of directional rules\nOut of date access control rules\nLack of egress filtering\n\nBusiness applications sometimes require connections from the corporate network into the\nSCADA. These connections can create potential attack paths from the Internet onto the corporate\nnetwork and then into the SCADA networks. For instance, some business applications require\nconnections to the historian database for access to historical data. They may also connect to the\nWeb HMI server to allow real-time viewing of the process. Any connection to SCADA functions\ncan extend the exposure of associated vulnerabilities to the corporate network (or to wherever the\nconnection is initiated).\n\nSCADA owners can reduce the risk of business application connections by minimizing\nexposure to the business network and closely monitoring the necessary communication paths.\nDifferent DMZs can be created for separate functionalities/access privileges, such as a peer\nconnection like the ICCP server in SCADA systems, the data historian, the security servers,\nreplicated servers, and development servers. Figure 9 shows this separation into multiple DMZs.\n\n|Common Vulnerability|Potential Impact|\n|---|---|\n|Lack of or improper segmentation into security zones|Unnecessary exposure from connected networks|\n|Access to excessive number of ports is allowed||\n|Access to excessive number of IPs is allowed||\n|Lack of directional rules||\n|Out of date access control rules||\n|Lack of egress filtering||\n\n\n-----\n\nFigure 9. Recommended defense-in-depth SCADA architecture\n\nPerimeter protection techniques minimize the necessary connections, and corresponding\nexposure, to the business network, but vulnerabilities in the protocols and services used for\nbusiness functions can be exploited to gain access inside the SCADA perimeter. The design of\nSCADA protocols can force sub-optimal network designs and implementations. For example, the\nuse of protocols that require access to wide port ranges limits the ability to prevent unauthorized\nsystem access with firewall rules.\n\nData sharing protocols such as ICCP and OPC are used to send and receive data from remote\nsites and peer utilities. These connections are un-trusted if the remote site or intermediate\npathway networks are unknown. Vulnerabilities in services that must be allowed to accept\nconnections from less-trusted networks are exposed to possible exploitation from these networks.\n\nTable 23 lists typical types of SCADA services that must be exposed to possible attack from\nexternal networks.\n\n\n-----\n\nTable 23. Common vulnerabilities associated with external communications.\n\n**Common Vulnerability** **Potential Impact**\nBusiness applications require holes through the firewall Increases exposure to the corporate\nfrom the corporate network into the SCADA networks network\n\nConnections to remote sites Increases exposure to less-trusted\nremote networks and the networks that\nprovide the pathway\nData sharing protocols require connections to networks Increases exposure to unknown\nthe SCADA owner has no control over external networks\n\nSCADA vendor and administrator VPN connections\n\nOne way to prevent direct access to the SCADA LAN from the corporate clients is by using a\nreplicated data server in a DMZ as shown in Figure 10. In this architecture, a Web server is\nlocated in a DMZ between the SCADA and corporate networks. Replication of data from the\nSCADA is accomplished by the data application running on the SCADA server and the data\napplication running on the Web server. The Web server then becomes a replicated data server,\nallowing corporate clients read-only access to SCADA data.\n\nFigure 10. Replicated data server\n\n##### 4.7.3 Monitor network to detect intrusion \n\nAn intrusion detection system (IDS) looks for actions that attempt to compromise the\nconfidentiality, integrity, or availability of a resource. Intrusion detection is not a single product\nor technology. A comprehensive set of tools providing network monitoring can give an\n\n|Common Vulnerability|Potential Impact|\n|---|---|\n|Business applications require holes through the firewall from the corporate network into the SCADA networks|Increases exposure to the corporate network|\n|Connections to remote sites|Increases exposure to less-trusted remote networks and the networks that provide the pathway|\n|Data sharing protocols require connections to networks the SCADA owner has no control over|Increases exposure to unknown external networks|\n|SCADA vendor and administrator VPN connections||\n\n\n-----\n\nadministrator a complete picture of how the network is being utilized. Implementing a variety of\nthese tools will help create a defense-in-depth architecture that will be more effective in\nidentifying attacker activities.\n\nIDSs don’t determine the nature of the probable intrusion or take action to prevent the\nintrusion. Intrusion prevention systems are not generally recommended along paths of critical\nfunctionality.\n\nIntrusion detection can be manual or automatic. Manual intrusion detection is done by\nexamining log files or other evidence for signs of intrusions, such as abnormal network traffic.\nAutomated approaches monitor system logs, network traffic flow, and packets, then send an alert\nwhen a “probable intrusion” is identified. As an example, SCADA networks have predictable\nnormal activity so IDS rules can look for abnormal behavior such as a protocol that is not\nnormally used between two computers.\n\nAlthough intrusion detection was not a focus for NSTB assessments, in many cases it was\nnoted whether the system gave any indication of abnormal conditions, such as alerts on the\noperator screen. NSTB laboratory assessments found that SCADA systems lacked adequate\nindicators of abnormal conditions. A common observation during onsite assessments was that the\ninstallation, monitoring, validation and updating of IDS tools deployed on SCADA networks also\noffered opportunities for improvement.\n\nEvent logging (applications, events, login activities, security attributes, etc.) can be turned on\nand monitored to identify security issues. Logs and other security sensors monitored on a realtime basis allow security incidents to be rapidly detected and countered. Train assigned\nindividuals and give them the responsibility of monitoring system data logs and keeping the\nvarious tool configurations current.\n\n**_4.7.3.1_** **_Customize IDS Rules for the SCADA and Closely Monitor Logs_**\n\nThe configuration and deployment of IDSs for SCADA is not as straightforward as it is for\ntypical IT computer networks. Traditionally, specific payloads and port numbers for the unique\ncommunications protocols used in SCADA systems - such as Modbus or DNP3 - have not been\nincluded as signatures in contemporary IDSs. Although IDS signatures are available to detect a\nwide range of attacks, few SCADA-specific signatures are available. Consequently, modern IDSs\ndeployed on SCADA networks may be blind to the types of attacks that a SCADA system could\nexperience.\n\nNSTB assessments showed the advantage of developing security signatures and rules in a\ncooperative relationship with the SCADA vendor. Many security vendors, including those\nspecializing in SCADA security, have created signatures for the IDS that are deployed in control\narchitectures.\n\nAn IDS deployed in a SCADA network benefits from the ability to add unique SCADAspecific signatures. Likewise, the need to remove some default signatures and response capability\nis commonplace, as they may have no relevance to an SCADA network. Rules sets and signatures\nunique to the SCADA domain are imperative for deploying effective IDSs on SCADA networks.\nAnalysis that ensures the inherent capability of the IDS is leveraged, with some of the capability\nrefined and augmented, is useful.\n\nIDS logs can also be used to identify normal communication patterns between each of the\nSCADA components. Investigate all unexpected traffic and either include it on the required\ncommunication list or blocked it by firewalls. A one-to-one mapping of firewall rules and IDS\n\n\n-----\n\nsignatures allows the IDS sensor to alert if a firewall rule is not successfully applied, and allows\nadministrators to take corrective action on the firewall.\n\nThe external IDS sensor provides notification of malicious attempts on the firewall and\nmonitors egress rules from the SCADA out to the DMZ or corporate networks. The internal IDS\nsensor and the DMZ IDS sensor closely monitor the exceptions in the firewall for malicious\nactivity.\n\n##### 4.7.4 Recommendations and resources\n\nTo find and remediate access control vulnerabilities in network devices, architectures, and\ninbound and outbound communications, it is recommended that:\n\n    - Vendors redesign their systems for security, giving protocols and services that connect to\nless-trusted networks top priority in SCADA software vulnerability remediation activities\n\n    - Vendors provide documentation on how the SCADA system components use the network so\nthat effective firewall and IDS rules can be created\n\no If SCADA network requirements and protocol specifications are not available, owners\ncan monitor network traffic to identify normal system behavior. Validate network\ncommunications to the extent possible, to avoid base-lining malicious activity. Vendors\ncan document their system requirements using this method as well.\n\n    - Owners make network access rules as restrictive as possible\n\no Use access control lists to limit management access of network equipment to only those\nwho need it\n\no Restrict host and user network permissions and access rights as much as possible\n\no Restrict access to the required port numbers and IP addresses\n\no Use directional rules to prevent activities such as database connections initiated from the\ncorporate network\n\no Set as specific as possible, any exceptions created in the firewall rule set, including host,\nprotocol, and port information\n\n    - Owners configure a secure network architecture\n\no Set up network devices to only allow access using secure protocols\n\no Consider the direction of network packets in rule configuration\n\no Limit connectivity of ports to hardware interfaces.\n\no Segment networks into security zones\n\no Use firewalls to create DMZs\n\no Firewalls restrict communications to only what is necessary for system functionality\n\no Remove as part of a change management procedure or periodic system review or audit\nany firewall rules that are no longer needed\n\no Route all connections to the SCADA LAN through the firewall and eliminate hardwired\nconnections that circumvent the firewall\n\n\n-----\n\no Place Web servers, Historian Databases, and other servers required for business functions\non DMZs that have been segmented into security zones\n\n  - Owners use change management procedures that include\n\no Updates to network diagrams and other documentation whenever changes are made to the\nSCADA networks\n\no Access for network administrators to an accurate network diagram of their SCADA LAN\nand its connections to the other protected subnets, DMZs, corporate network, and\nexternal networks\n\n  - Owners enable logging, monitor system traffic, and implement rules that allow only\nnecessary access\n\n  - Owners initiate connections from trusted networks rather than less-trusted networks and filter\noutbound connections\n\nSCADA-specific network security recommendations can be found in the following references:\n\n  - _21 Steps to Improve Cyber Security of SCADA Networks[27]_\n\n  - [NIST SP 800-82, Guide to Industrial Control Systems (ICS) Security,[7] pages 5-1 to 5-19](http://csrc.nist.gov/publications/drafts/800-82/draft_sp800-82-fpd.pdf)\n\n  - _Recommended Practice: Improving Industrial Control Systems Cybersecurity with Defense-_\n_In-Depth Strategies[28]_\n\n  - _Control Systems Cyber Security: Defense in Depth Strategies[29]_\n\n  - _Good Practice Guide on Firewall Deployment for SCADA and Process Control Networks[30]_\n\nGeneral network access control recommendations can be found in the Twenty Critical Security\n_Controls for Effective Cyber Defense[15]_\n\n  - Critical Control 4: Secure Configurations for Network Devices such as Firewalls, Routers,\nand Switches\n\n  - Critical Control 5: Boundary Defense\n\n  - Critical Control 6: Maintenance, Monitoring, and Analysis of Audit Logs.\n\n#### 4.8 SCADA Vulnerabilities Summary\n\nNSTB assessments look for access paths to SCADA resources and functionality.\n\nWeak or missing security features in SCADA software can leave the system components\nvulnerable to manipulation by any threats to which they are exposed. Protection mechanisms for\neach component of the SCADA can help reduce risk.\n\nVendors have different standard processes for building, testing, and installing a SCADA\nsystem. Some vendors have integrators who work with customers to create and install the system.\nOther vendors have just a product model. Often, integration consultants with specific SCADA\nproduct training are available for installation and configuration. All systems are unique; generally\nwith new features introduced in each one. The level of security in each SCADA installation is\ndependent on those responsible for installing and configuring the operating systems, SCADA\napplications, and third-party applications.\n\nEach SCADA installation provides a unique combination of components and functionality\noffered by a SCADA product vendor to meet specific customer specifications. Large scale\n\n\n-----\n\nSCADA systems are generally major purchases, requiring much time and money. Few systems\nfrom each SCADA product line are delivered before features are added and a new version is\nreleased. The large investment of financial and personnel resources needed for SCADA upgrades\ncan contribute to insufficient standard procedures for securely configuring each SCADA product.\n\nAssurance of a secure configuration can be increased through automated security\nconfiguration packages and detailed instructions provided by the SCADA vendor. Automated\ndisabling of unnecessary services and applications and lists of required applications and services\nwith associated permissions required can be included in instructions. Required ports and\ncomponents allowed to connect can also be defined. Owners can require this information during\nthe procurement process to insure the ability to securely configure their systems.\n\nVulnerabilities may exist because of the way that a SCADA has been implemented, or in how\nit is used. Vulnerable third-party products can be replaced, but in some cases SCADA vendor\nassistance or code changes may be necessary. SCADA vendors can remove unnecessary\nfunctionality from SCADA applications and default application and OS configurations. SCADA\nowners can work with their vendors to secure system configurations. Production SCADA\ninstallations can implement secure practices where possible and apply computer and network\nsecurity techniques to remove or mitigate remaining vulnerabilities.\n\nConsider risk and consequence in implementing security mitigations and prioritizing efforts\nfor enhancing security. Weigh the risk of system compromise by an intruder with the risk of\npotentially degrading system operability. Also, security solutions need to be practical enough for\nbusy system administrators to implement and maintain. Above all, SCADA must be reliable.\nTherefore, the suggested approach is to add security in small increments, using backup\nconfigurations, so that if any security measure conflicts with system operation it can quickly be\nreversed.\n\nTable 24 summarizes the security vulnerabilities that cannot be completely remediated\nthrough perimeter defenses.\n\nTable 24. Common vulnerabilities not mitigated by perimeter defenses\n\n**Common Vulnerability** **Limitations of Perimeter Defenses**\nUnsecure coding practices Necessary protocols cannot be blocked\nEncryption does not fix vulnerabilities\nUnpatched OS, third-party products, and The SCADA may not be compatible with the\nthird-party libraries newer, or patched, versions\n\nLeast privileges violations Privileges are required by the SCADA products\nUnneeded/Unused/Unsafe Services Unnecessary services may be hard to infer if they\nhave not been defined\nUnused services may not be unneeded in some\ncircumstances\nNetwork layout effectiveness limited by Protocol designs limit the effectiveness of\nSCADA protocol requirements network security mechanisms (i.e., large port\n\nranges)\nInsecure protocols Necessary protocols cannot be blocked\n\n|Common Vulnerability|Limitations of Perimeter Defenses|\n|---|---|\n|Unsecure coding practices|Necessary protocols cannot be blocked Encryption does not fix vulnerabilities|\n|Unpatched OS, third-party products, and third-party libraries|The SCADA may not be compatible with the newer, or patched, versions|\n|Least privileges violations|Privileges are required by the SCADA products|\n|Unneeded/Unused/Unsafe Services|Unnecessary services may be hard to infer if they have not been defined Unused services may not be unneeded in some circumstances|\n|Network layout effectiveness limited by SCADA protocol requirements|Protocol designs limit the effectiveness of network security mechanisms (i.e., large port ranges)|\n|Insecure protocols|Necessary protocols cannot be blocked|\n\n\n-----\n\n#### 5. ADDITIONAL SCADA SECURITY RECOMMENDATIONS\n\nThe classifications of vulnerabilities identified in this report can be used during selfassessment activities to assist in identifying potential problem areas that can aid in identification\nand mitigation of vulnerabilities in SCADA networks, components, services, and code. SCADA\nsystem installations have varying performance and reliability requirements and use operating\nsystems and applications that may be considered unconventional compared to typical IT systems.\nIn addition, for SCADA systems, the goals of safety and efficiency may conflict with security in\nthe design and operation of SCADA. Security solutions (i.e., requiring password authentication\nand authorization) must not interfere with emergency actions for SCADA or compromise critical\noperational functionality. Therefore, all security functions integrated into the SCADA must be\ntested in a safe mode (such as offline on a comparable SCADA system configuration) to verify\nthat they do not compromise normal operational functionality and safety. It is recommended that\nSCADA vendors and Owners/Operators use qualified security and SCADA experts to verify that\nthe proposed mitigation will be effective and ensure that the actions will not impair the system’s\nreliability and operational requirements.\n\nThere are multiple ways the SCADA system and the physical process it controls can be\nthreatened. Each component of the SCADA system can have its own protection mechanisms to\nprotect both the information and physical systems. The building-up, layering and overlapping of\nsecurity measures is called defense in depth. With this defense in depth strategy, should one\ndefensive measure fail there are other defensive measures in place that continue to provide\nprotection.\n\nRemediation and mitigation of cyber risk starts with a defense-in-depth strategy to securing\nSCADA systems. It is essential that energy asset Owners/Operators and SCADA vendors work\ntogether to implement the defensive measures necessary to support an acceptable risk posture\nwithout compromising system functionality. For the vendor this includes identification and\nremediation of existing vulnerabilities in current products, development of secure new products,\nand support for patching and secure configurations of system components. Energy asset\nOwners/Operators can determine business risk associated with critical operational nodes, then\ninstall, maintain and monitor secure operating system, software, SCADA systems, and network\nconfigurations. Additional SCADA-specific security resources can be found on the NSTB, United\nStates Computer Emergency Readiness Team (US-CERT), and other Web sites:\n\n  - [http://www.controlsystemsroadmap.net/documents.shtml](http://www.controlsystemsroadmap.net/documents.shtml)\n\n  - [http://www.oe.energy.gov/controlsecurity.htm](http://www.oe.energy.gov/controlsecurity.htm)\n\n  - [http://www.us-cert.gov/control_systems/csdocuments.html](http://www.us-cert.gov/control_systems/csdocuments.html)\n\nIn addition to the specific recommendations identified in Section 4, there are additional\nactions the vendors and owner/operators can take to make the control system more secure from\ncyber attack. The following sections address these SCADA specific issues that should also be\nconsidered.\n\n#### 5.1 Recommendations for SCADA vendors to improve product security\n\nVendors can incorporate cybersecurity into every phase of the product development life cycle\nand can use both manual and automated means to ensure proper bounds checking. Once products\nare deployed, vendors can establish a process to manage and mitigate product security defects.\n\n\n-----\n\nNSTB assessment results and discussions with the vendor indicate that the top SCADA vendor\nrecommendations are:\n\n    - Create and maintain a culture that emphasizes security\n\n    - Educate/train developers to use secure coding practices\n\n    - Expeditiously test security patches\n\n    - Create the necessary communication paths to quickly notify customers/users of security\nproblems, and create the methods needed to provide patches in an effective way\n\n    - Implement and strenuously test strong authentication and encryption mechanisms\n\n    - Increase the robustness of network parsing code\n\n    - Document how the systems use the network so that effective firewall and IDS rules can be\ncreated\n\n    - Have third-party security source code audits performed and fix problems identified during the\naudit\n\n    - Redesign network protocols to avoid common problems and enhance security\n\n    - Enhance test suites to perform more testing for failure with emphasis on testing for potential\nvulnerabilities\n\n    - Create custom protocol parsers for common IDSs so they can be more effective.\n\n##### 5.1.1 Create a Security Culture\n\nSCADA vendors can educate/train developers in secure coding and help create a culture that\nemphasizes security. Hardware, operating system, and software application vendors have\nexperienced the cost and negative publicity that accompany public announcement of security\nflaws to force quicker patch response time. The security development lifecycle (SDL), created by\nMicrosoft in 2002 as a response to heightened awareness of cybersecurity threats, is a highvisibility example of a security culture change. This process was developed to catch security\nflaws during the product development lifecycle, not just after the product is released. For\nexample, Microsoft created a culture that promotes safe code development by forcing all new\ncode to pass a series of tests before incorporation into the main product. All developers are put\nthrough secure development training to support this new culture. Performance evaluation of\nsoftware products, as well as the product managers and their teams, also changed to include a\nfocus on security. Although new Microsoft vulnerabilities are still abundant six years later, this\nculture change has made a significant difference in the security level of Microsoft products.\n\nSCADA products have gained considerable attention in recent years as cybersecurity threats\nhave been identified and publicized. Public announcements of SCADA vulnerabilities are starting\nto appear and SCADA protocol dissectors are becoming available. Those companies willing to\nembrace a security culture change will benefit from fewer security patches for deployed systems\nand greater customer confidence and loyalty.\n\nSCADA vendors may need to adapt to changing customer needs for security in the products\nused to control physical systems where compromise can have catastrophic consequences. It is\ndifficult to attach security onto a product that has already matured and it is practically impossible\nto find and prevent all bugs.\n\n\n-----\n\nSecurity must also compete with functionality for product time and budget. Vendors must\naccept that security improvements will require an investment. The earlier in the life cycle that\nsecurity is integrated into the product, the better chance it has of competing in a market where\nSCADA products are required to survive cyber attack without compromising critical\nfunctionality.\n\nSCADA vendors can work toward a culture where software security best practices are\nadopted throughout the product development organizations and software development life cycles\nare adjusted to use the best practices. Security practices can be consolidated, integrated, and\ncentralized into a security process that supports the defined strategy for creating the most secure\nproduct possible. Numerous resources are available for information and training on building a\nsecurity culture and software security best practices. SCADA vendors can use the following\nsoftware security best practices to create more secure products:\n\n    - Develop or acquire the necessary personnel security skills\n\n    - Define security requirements to protect critical functions for the end user\n\n    - Have a continual product improvement process that identifies vulnerabilities in SCADA\ncomponent designs and then redesign the identified components or develop secure\nmitigations for the legacy components\n\n    - Require secure source coding handling to protect against malicious vulnerabilities\n\n    - Perform thorough security testing\n\n    - Provide security documentation\n\n##### 5.1.2 Enhance SCADA Test Suites\n\nSCADA product test suites should be enhanced to perform testing to failure with an emphasis\non potential vulnerabilities. SCADA software code logic has been found to only test for failures\nand other problems that may occur during normal operations.\n\nSCADA product design and code logic can be implemented to properly handle invalid or\nunwanted cases, even if they never occur. The connection of SCADA to other networks has\ncreated the threat of cyber attacks that can cause errors that would never occur naturally or by\naccident. The possibility of malicious input requires protective logic that handles every possible\nerror condition.\n\nUnconventional scenarios, that test various input values and abnormal conditions, should be\nincluded in SCADA test suites. This may require tests built by individuals who can create\ncomprehensive and “out of the box” scenarios and are not involved in the design and\nimplementation of the SCADA product.\n\nThe NSTB assessment methodology is based on this idea of identifying security weaknesses\nthrough an attacker’s perspective and communicating the security issues to the industry partner\nfrom this perspective. This testing approach has been successful in increasing awareness of the\nunconventional attacks the SCADA sector needs to defend against.\n\nResources such as the Common Attack Pattern Enumeration and Classification project can\nhelp in developing test packages:\n\nBuilding software with an adequate level of security assurance\nfor its mission becomes more and more challenging every day as\nthe size, complexity, and tempo of software creation increases\n\n\n-----\n\nand the number and the skill level of attackers continues to grow.\nThese factors each exacerbate the issue that, to build secure\nsoftware, builders must ensure that they have protected every\nrelevant potential vulnerability; yet, to attack software, attackers\noften have to find and exploit only a single exposed\nvulnerability. To identify and mitigate relevant vulnerabilities in\nsoftware, the development community needs more than just good\nsoftware engineering and analytical practices, a solid grasp of\nsoftware security features, and a powerful set of tools. All of\nthese things are necessary but not sufficient. To be effective, the\ncommunity needs to think outside of the box and to have a firm\ngrasp of the attacker’s perspective and the approaches used to\nexploit software.\n\nAttack patterns are a powerful mechanism to capture and\ncommunicate the attacker’s perspective. They are descriptions of\ncommon methods for exploiting software. They derive from the\nconcept of design patterns applied in a destructive rather than\nconstructive context and are generated from in-depth analysis of\nspecific real-world exploit examples.\n\nTo assist in enhancing security throughout the software\ndevelopment lifecycle, and to support the needs of developers,\ntesters and educators, the Common Attack Pattern Enumeration\nand Classification (CAPEC) is sponsored by the Department of\nHomeland Security as part of the Software Assurance strategic\ninitiative of the National Cyber Security Division. The objective\nof this effort is to provide a publicly available catalog of attack\npatterns along with a comprehensive schema and classification\ntaxonomy.[31]\n\n#### 5.2 Secure SCADA Installation and Maintenance for Owners/Operators\n\nA successful method for securing an SCADA is to gather industry-recommended practices\nand engage in a proactive, collaborative effort among management, the controls engineer and\noperator, and the IT organization. This team can draw upon the wealth of information available\nfrom ongoing federal government, industry groups, vendor, and standards organizational\nactivities. SCADA owners/operators can perform risk-based assessments on their systems and\ntailor the recommended guidelines and solutions to meet their specific security, business, and\noperational requirements.\n\nPlanning efforts can be implemented for prioritization of the tasks necessary to enhance\nSCADA security. Important considerations in this process are cost, probability, and consequence.\nDecisions concerning methods of mitigating cyber vulnerabilities include balancing the risk of\nsystem compromise by an intruder with the risk of potentially degrading system operability.\nAbove all, the SCADA must be reliable and perform its required mission. The recommended\napproach is to build security into a system before it is put into production or add security into an\nexisting system in small increments. When adding security to a production system, it should be\ntested on a backup system first to allow quick recovery to the previous configuration in the event\n\n\n-----\n\nany security measure affects system operation. The risks can be weighed and the appropriate\namount of security measures added for the specific situation.\n\nAsset Owners/Operators may use enforceable procurement specifications to ensure that\nsecurity development life-cycle requirements are met by the vendor. For example, asset\nOwners/Operators may require that the SCADA products be reviewed by an independent security\nassessment team and that all findings be remediated prior to purchase. Vulnerability and patch\nmanagement programs and policies can be established and enforced.\n\nAn effective cybersecurity program for SCADA may apply a strategy known as defense-indepth[28, 29], layering security mechanisms to minimize the impact of a failure in any one\nmechanism. Implementing security controls, such as intrusion detection software, antivirus\nsoftware, and file integrity checking software, where technically feasible, may prevent, deter,\ndetect, and mitigate the introduction, exposure, and propagation of malicious software to, within,\nand from the SCADA. Good defense in-depth perimeter protections can be used to help prevent\naccess to vulnerable components and communication on SCADA networks. Part of a good\ndefense in-depth strategy is identifying and mitigating known vulnerabilities and weaknesses in\nthe system that may help an attacker manipulate or cause damage to the system. Continuous\nmonitoring of IDS logs can allow system administrators to catch and block attempts to\ncircumvent these defenses before serious damage is done.\n\nOwners/Operators can increase the security of their systems by implementing the following\nrecommendations:\n\n    - Redesign network layouts to implement a network topology for the SCADA that has multiple\nlayers, with the most critical communications occurring in the most secure and reliable layer.\n\n    - Restrict physical access to the SCADA network and devices\n\n    - Expeditiously deploy security patches after testing all patches under field conditions on a test\nsystem before installation on the SCADA\n\n    - Work with vendors to test and apply patches for all operating systems and software on the\nSCADA networks\n\n    - Customize IDSs for the SCADA hosts and networks (network security administrators should\nbe able to write custom IDS signatures tailored to their environment)\n\n    - Restrict SCADA user privileges to only those that are required to perform each person’s job\n(i.e., establishing role-based access control and configuring each role based on the principle\nof least privilege)\n\n    - Develop a password management plan to enforce strong passwords with minimum length,\nmixed character sets, expiration, no password reuse, etc., and change all default passwords\n\n    - Conduct continued product cybersecurity improvement through internal and external audits\n\n##### 5.2.1 Restrict Physical Access to SCADA Network and Devices\n\nAccess to SCADA system equipment should only be allowed for authorized personnel.\nContinual manning of operating consoles can provide physical security that reduces the need for\ndistinct operator user IDs and passwords.\n\nRequire physical access for controller configuration and firmware updates. Requiring\nphysical access to implement modifications and updates helps prevent possible exploitation over\n\n\n-----\n\nthe network. Authentication and data integrity checks also protect against unauthorized physical\naccess and manipulation of software and firmware files.\n\n\n-----\n\n#### 6. CONCLUSION\n\nNSTB SCADA security assessments evaluate SCADA products and production\nconfigurations. SCADA product assessments focus on vulnerabilities that are inherent in the\nproduct, and are therefore representative of installed systems. Production SCADA assessments\nconcentrate on the aspects of the SCADA that the system owner is able to control, such as secure\nconfigurations and layers of defense.\n\nAn attacker must be able to access the SCADA to do harm. From a cybersecurity perspective,\nthis means that they must create an attack path from their attack computer to the SCADA. An\nattack could potentially start from any point between the Internet and the physical equipment that\nthe SCADA is monitoring. Layers of defense are necessary to protect against multiple threat\nvectors. Perimeter protection alone cannot fully mitigate vulnerabilities that exist in the SCADA.\n\nNSTB assessments found large SCADA attack surfaces created by excessive open ports\nallowed through firewalls and insecure and excessive services listening on them. Well-known\ninsecure coding practices account for most of the SCADA software vulnerabilities, which result\nin system access vulnerability or Denial of Service (DoS). However, improper patch management\nprovides more likely attack targets because the vulnerabilities are public and attack tools are\navailable for them. Once SCADA network access is obtained, status data and control commands\ncan be manipulated as they are communicated by insecure SCADA protocols.\n\nPerimeter defenses, implemented by SCADA owners to protect their systems, cannot fully\nmitigate vulnerabilities associated with required services between security zones. Vulnerabilities\nin Web services, database applications, and data transfer protocols can provide attack paths\nthrough firewalls. SCADA network protocol applications can also be exploited to gain access to\nSCADA hosts. Weak authentication and integrity checks may allow unauthorized control or data\nmanipulation, once SCADA network access has been obtained.\n\nThe most significant vulnerabilities associated with the assessment target research evaluated\nby the NSTB assessment program can be mitigated by patch management, elimination of\nunnecessary and unsafe services, implementation of strong authentication and integrity checks to\nnetwork protocols, and securing applications that accept external input, particularly network\ntraffic. Secure configurations and network layers of defense can then be used to protect these\ncritical assets.\n\nSCADA vendors can establish a culture where software security best practices are adopted\nthroughout the product development life cycles. Security practices should be consolidated,\nintegrated, and centralized into a security process that supports the defined strategy for creating\nthe most secure product possible. Numerous resources are available for information and training\non building a security culture and software security best practices. The following is a summary of\nrecommendations for SCADA vendors:\n\n- Create a security culture\n\n- Enhance SCADA test suites\n\n- Create and test patches\n\n- Redesign network protocols for security\n\n- Increase robustness of network parsing code\n\n- Create custom protocol parsers for common IDSs\n\n- Document necessary services and communication channels\n\n\n-----\n\n- Implement and test strong authentication and encryption mechanisms\n\n- Improve security through external software security assessments\n\nVendor support is needed to remediate the unnecessary exposure and vulnerabilities caused\nby excessive services and unpatched systems. SCADA software not designed for security\ndecreases the ability to reduce exposure by implementing least user privileges and firewall rules.\nThe following common SCADA security risks cannot be minimized by SCADA owners alone:\n\n- Unpatched OS, third-party products, and third-party libraries\n\n- Unneeded/unused/unsafe services\n\n- Improper network layout due to SCADA protocol requirements\n\n- Privilege levels\n\nSCADA vendors can improve the security of the SCADAs used in critical energy\ninfrastructure installations by identifying and remediating existing vulnerabilities in current\nSCADA products, developing secure new products, and supporting patching and secure\nconfigurations of SCADA components. SCADA owners can then more effectively secure their\nsystems by installing, maintaining, and monitoring secure OS, software, SCADA, and network\nconfigurations.\n\nSCADA owners can work with vendors to better understand known system vulnerabilities\nand do what they can to implement as many defensive protective measures as possible without\ncompromising system functionality. Owners/operators are recommended to increase the security\nof their systems by completing the following recommendations:\n\n- Restrict SCADA user privileges to only those required\n\n- Change all default passwords and require strong passwords\n\n- Test and apply patches\n\n- Protect critical functions with network security zones and layers\n\n- Customize IDS rules for the SCADA and closely monitor logs\n\n- Force security through external software security assessments\n\nThe security of SCADAs used in critical energy infrastructure installations throughout the\nUnited States relies on a cooperative effort between SCADA product vendors and the owners of\ncritical infrastructure assets. SCADA product vendors can deliver and support systems that are\nable to survive attack without compromising critical functionality. SCADA integrators can\nconfigure systems securely before they are put into production. SCADA owners can ensure that\nthe physical systems they operate do not put lives, economy, or environment at risk by\nperforming due diligence in procuring, configuring, securing, and protecting the SCADA for\ncritical infrastructure.\n\n\n-----\n\n#### 7. REFERENCES\n\n1. SANS, The Top Cyber Security Risks, SysAdmin, Audit, Network, Security, September 2009,\n\n[http://www.sans.org/top-cyber-security-risks/, Web page accessed May 2010.](http://www.sans.org/top-cyber-security-risks/)\n\n2. Mell, Peter, Scarfone, Karen, and Romanosky, Sasha, A Complete Guide to the Common\n_Vulnerability Scoring System Version 2.0, Forum of Incident Response and Security Teams,_\nJune 2007, [http://www.first.org/cvss/cvss-guide.html, Web page accessed May 2010.](http://www.first.org/cvss/cvss-guide.html)\n\n3. CPNI Report, “Good Practice Guide, Process Control and SCADA Security - Guide 1.\nUnderstand the Business Risk”: Centre for the Protection of National Infrastructure, PA\nConsulting Group, 2008, [http://www.cpni.gov.uk/documents/publications/2008/2008031-](http://www.cpni.gov.uk/documents/publications/2008/2008031-gpg_scada_security_good_practice.pdf)\n[gpg_scada_security_good_practice.pdf, webpage accessed March 2011.](http://www.cpni.gov.uk/documents/publications/2008/2008031-gpg_scada_security_good_practice.pdf)\n\n4. ISA, ANSI/ISA–99.00.01–2007 Security for Industrial Automation and Control Systems Part\n_1: Terminology, Concepts, and Models, International Society for Automation, October 29,_\n2007,\n[http://www.isa.org/filestore/expo/2009/PressKit/Information%20about%20ISA/Membership/](http://www.isa.org/filestore/expo/2009/PressKit/Information%20about%20ISA/Membership/Samples%20of%20Free%20ISA%20Standards%20and%20Technical%20Papers/ANSI%20ISA%2099-00-01%20%202007.pdf)\n[Samples%20of%20Free%20ISA%20Standards%20and%20Technical%20Papers/ANSI%20I](http://www.isa.org/filestore/expo/2009/PressKit/Information%20about%20ISA/Membership/Samples%20of%20Free%20ISA%20Standards%20and%20Technical%20Papers/ANSI%20ISA%2099-00-01%20%202007.pdf)\n[SA%2099-00-01%20%202007.pdf, Web page accessed May 2010.](http://www.isa.org/filestore/expo/2009/PressKit/Information%20about%20ISA/Membership/Samples%20of%20Free%20ISA%20Standards%20and%20Technical%20Papers/ANSI%20ISA%2099-00-01%20%202007.pdf)\n\n5. Lee, Kathy, et al., NSTB ICCP Security Assessment, U.S. Department of Energy Office of\nElectricity Delivery and Energy Reliability, February 2010.\n\n6. DHS, Recommended Practice for Patch Management of Control Systems, Department of\nHomeland Security,\nhttp://csrp.inl.gov/Documents/PatchManagementRecommendedPractice_Final.pdf, December\n2008.\n\n7. NIST, NIST SP 800-82, Guide to Industrial Control Systems (ICS) Security, Final Public\nDraft, National Institute of Standards and Technology, September 29, 2008.\n\n8. Pratyusa Manadhata and Jeannette Wing, An Attack Surface Metric, IEEE Transactions on\nSoftware Engineering, 2010, http://www.cs.cmu.edu/~pratyus/tse10.pdf.\n\n9. MITRE, CWE (Common Weaknesses Enumeration), Department of Homeland Security,\nJanuary 11, 2009, [http://cwe.mitre.org/, Web page accessed May 2010.](http://cwe.mitre.org/)\n\n10. Christey, Steve, 2010 CWE/SANS Top 25 Most Dangerous Programming Errors, MITRE,\n[April 5, 2010, http://cwe.mitre.org/top25/, Web page accessed May 2010.](http://cwe.mitre.org/top25/)\n\n11. SANS/CWE, 2010 CWE/SANS Top 25: Monster Mitigations, SysAdmin, Audit, Network,\nSecurity, February 15, 2010, [http://cwe.mitre.org/top25/mitigations.html, Web page accessed](http://cwe.mitre.org/top25/mitigations.html)\nMay 2010.\n\n12. Seacord, Robert, CERT Secure Coding Standards, Carnegie Mellon University, June 7, 2010,\n\n[https://www.securecoding.cert.org, Web page accessed May 2010.](https://www.securecoding.cert.org/)\n\n13. SAFECode, Software Assurance: An Overview of Current Industry Best Practices, Software\nAssurance Forum for Excellence in Code, February 2008,\n[http://www.safecode.org/publications/SAFECode_BestPractices0208.pdf, Web page accessed](http://www.safecode.org/publications/SAFECode_BestPractices0208.pdf)\nMay 2010.\n\n14. SAFECode, Fundamental Practices for Secure Software Development, Software Assurance\nForum for Excellence in Code, October 2008,\n[http://www.safecode.org/publications/SAFECode_Dev_Practices1108.pdf, Web page](http://www.safecode.org/publications/SAFECode_Dev_Practices1108.pdf)\naccessed May 2010.\n\n\n-----\n\n15. CSIS, Twenty Critical Controls for Effective Cyber Defense: Consensus Audit Guidelines,\nCenter for Strategic and International Studies, August 10, 2009,\n[http://csis.org/files/publication/Twenty_Critical_Controls_for_Effective_Cyber_Defense_CA](http://csis.org/files/publication/Twenty_Critical_Controls_for_Effective_Cyber_Defense_CAG.pdf)\n[G.pdf, Web page accessed May 2010.](http://csis.org/files/publication/Twenty_Critical_Controls_for_Effective_Cyber_Defense_CAG.pdf)\n\n16. Arends, R., Austein, R., Larson, M., Massey, D., and Rose, S., DNS Security Introduction\n_and Requirements, RFC 4033, March 2005,_ [http://www.faqs.org/rfcs/rfc4033.html, Web page](http://www.faqs.org/rfcs/rfc4033.html)\naccessed May 2010.\n\n17. Wright, Jason, Control Systems Communications Encryption Primer, Department of\nHomeland Security, December 2009, [http://www.us-](http://www.us-cert.gov/control_systems/pdf/Encryption%20Primer%20121109.pdf)\n[cert.gov/control_systems/pdf/Encryption%20Primer%20121109.pdf, Web page accessed](http://www.us-cert.gov/control_systems/pdf/Encryption%20Primer%20121109.pdf)\nMay 2010.\n\n18. Frankel, S., et al., Guide to SSL VPNs, National Institute of Standards and Technology, July\n2008, [http://csrc.nist.gov/publications/nistpubs/800-113/SP800-113.pdf, Web page accessed](http://csrc.nist.gov/publications/nistpubs/800-113/SP800-113.pdf)\nMay 2010.\n\n19. Rolston, Bri, Attack Methodology Analysis: SQL Injection Attacks, United States Computer\nEmergency Readiness Team, September 2005,\n[http://www.inl.gov/technicalpublications/Documents/3395025.pdf, Web page accessed May](http://www.inl.gov/technicalpublications/Documents/3395025.pdf)\n2010.\n\n20. Friedl, Steven, SQL Injection Attacks by Example, October 10, 2007,\n\n[http://www.unixwiz.net/techtips/sql-injection.html, Web page accessed May 2010.](http://www.unixwiz.net/techtips/sql-injection.html)\n\n21. OWASP, OWASP Top 10-2010 The Ten Most Critical Web Application Security Risks, Open\nWeb Application Security Project, April 2010,\n[http://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project, Web page accessed](http://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project)\nMay 2010.\n\n22. OWASP, OWASP Cheat Sheets, Open Web Application Security Project, June 22, 2009,\n\n[http://www.owasp.org/index.php/Category:Cheatsheets, Web page accessed May 2010.](http://www.owasp.org/index.php/Category:Cheatsheets)\n\n23. DHS, DHS Recommended Practice Case Study: Cross-Site Scripting, Department of\nHomeland Security, February 2007, [http://www.us-](http://www.us-cert.gov/control_systems/practices/documents/xss_10-24-07_Final.pdf)\n[cert.gov/control_systems/practices/documents/xss_10-24-07_Final.pdf, Web page accessed](http://www.us-cert.gov/control_systems/practices/documents/xss_10-24-07_Final.pdf)\nMay 2010.\n\n24. SANS, Password Policy, SysAdmin, Audit, Network, Security, 2006,\n\n[http://www.sans.org/security-resources/policies/Password_Policy.pdf, Web page accessed](http://www.sans.org/security-resources/policies/Password_Policy.pdf)\nMay 2010.\n\n25. SANS, DB Password Policy, SysAdmin, Audit, Network, Security, 2006,\n\n[http://www.sans.org/security-resources/policies/DB_Credentials_Policy.doc, Web page](http://www.sans.org/security-resources/policies/DB_Credentials_Policy.doc)\naccessed May 2010.\n\n26. Microsoft, How to Prevent Windows from Storing a LAN Manager Hash of Your Password in\n_Active Directory and Local SAM Databases, December 3, 2007,_\n[http://support.microsoft.com/kb/299656, Web page accessed May 2010.](http://support.microsoft.com/kb/299656)\n\n27. DOE-OE, 21 Steps to Improve Cyber Security of SCADA Networks, U.S. Department of\nEnergy Office of Electricity Delivery and Energy Reliability,\n[http://www.oe.netl.doe.gov/docs/prepare/21stepsbooklet.pdf, Web page accessed May 2010.](http://www.oe.netl.doe.gov/docs/prepare/21stepsbooklet.pdf)\n\n28. DHS, Recommended Practice: Improving Industrial Control Systems Cybersecurity with\n_Defense-In-Depth Strategies, Department of Homeland Security, October 2009,_\n\n\n-----\n\n[http://www.us-cert.gov/control_systems/practices/documents/Defense_in_Depth_Oct09.pdf,](http://www.us-cert.gov/control_systems/practices/documents/Defense_in_Depth_Oct09.pdf)\nWeb page accessed May 2010.\n\n29. Idaho National Laboratory, Control Systems Cyber Security: Defense in Depth Strategies,\nHomeland Security External Report # INL/EXT-06-11478, May 2006,\n[http://csrp.inl.gov/Documents/Defense%20in%20Depth%20Strategies.pdf, Web page](http://csrp.inl.gov/Documents/Defense%20in%20Depth%20Strategies.pdf)\naccessed May 2010.\n\n30. _CPNI, Good Practice Guide on Firewall Deployment for SCADA and Process Control_\n_Networks, National Infrastructure Security Coordination Centre, London, 2005,_\n[http://www.cpni.gov.uk/docs/re-20050223-00157.pdf, Web page accessed May 2010.](http://www.cpni.gov.uk/docs/re-20050223-00157.pdf)\n\n31. MITRE, Common Attack Pattern Enumeration and Classification (CAPEC),\n\n[http://capec.mitre.org/, May 18, 2010.](http://capec.mitre.org/)\n\n32. Clapper, R. James, Statement for the Record on the Worldwide Threat Assessment of the U.S.\n_Intelligence Community for the House Permanent Select Committee on Intelligence, Office of_\nthe Director of National Intelligence, February 10, 2011,\n[www.dni.gov/testimonies/20110210_testimony_clapper.pdf, Web page accessed July 2011.](http://www.dni.gov/testimonies/20110210_testimony_clapper.pdf)\n\n33. MITRE, CWE-22: Improper Limitation of a Pathname to a Restricted Directory (‘Path\n_Traversal’),_ [http://cwe.mitre.org/data/definitions/22.html, Web page accessed July 2011.](http://cwe.mitre.org/data/definitions/22.html)\n\n[34. SANS.org, Glossary of Security Terms, http://www.sans.org/security-resources/glossary-of-](http://www.sans.org/security-resources/glossary-of-terms/s)\n\n[terms/s, Web page accessed July 2011.](http://www.sans.org/security-resources/glossary-of-terms/s)\n\n35. SearchSecurity.com,\n\n[http://searchsecurity.techtarget.com/search/query?start=0&filter=1&q=mitm, Web page](http://searchsecurity.techtarget.com/search/query?start=0&filter=1&q=mitm)\naccessed July 2011.\n\n36. Wireshark, [http://www.wireshark.org/, Web page accessed July 2011.](http://www.wireshark.org/)\n\n[37. Kismet, http://www.kismetwireless.net/, Web page accessed July 2011.](http://www.kismetwireless.net/)\n\n38. NIST, NIST SP 800-77, Guide to IPsec VPNs, December 2005.\n\n[http://csrc.nist.gov/publications/nistpubs/800-77/sp800-77.pdf](http://csrc.nist.gov/publications/nistpubs/800-77/sp800-77.pdf)\n\n[39. NIST, Cryptographic Toolkit, http://csrc.nist.gov/groups/ST/toolkit/index.html, Web page](http://csrc.nist.gov/groups/ST/toolkit/index.html)\naccessed July 2011.\n\n[40. IT Toolkit, Man-in-the-Middle Attack, http://it.toolbox.com/wiki/index.php/Man-in-the-](http://it.toolbox.com/wiki/index.php/Man-in-the-Middle_Attack)\n\n[Middle_Attack, Web page accessed July 2011.](http://it.toolbox.com/wiki/index.php/Man-in-the-Middle_Attack)\n\n\n-----\n\n-----\n\n## Appendix A\n NSTB Assessment Methodology\n\nNSTB assessments target core supervisory control components using typical attack vectors. NSTB\nassessments have focused on the SCADA products to identify and understand the vulnerabilities they may\nbe most affected by, and how their design and operational requirements could affect host and network\nsecurity.\n\nNSTB product assessments focus on the core components of new SCADA products. This includes the\ncustom software components that relay commands to control hardware, provide system state data, store\nhistorical data, and provide other supervisory control and management functions. Common computer\nsoftware products are integrated into these complex systems, such as Web servers, database applications,\nand remote access and file transfer services. Since supervisory control software usually only supports one\nor two operating systems, operating systems can also be thought of as integrated into the SCADA.\n\nSecurity information about common IT operating systems, applications, services, and network\nprotocols is widely available, as well as secure configuration guides. NSTB assessments look for known\nvulnerabilities in these components or configuration errors that can be exploited to gain access to SCADA\ncomponents or manipulate the system. Widely known vulnerabilities and configuration errors represent\nthe most likely attack paths of a SCADA because the information and tools for discovering and exploiting\nthem are publicly available.\n\nTo cause damage, a SCADA cyber threat must compromise a SCADA component or network traffic\nwith the ability to control the physical system or alter, insert, or delete system operational status data.\n\nSCADA software is evaluated for vulnerabilities that would allow access to critical SCADA\nfunctionalities. Protocols that transfer system state data and commands, or are used for communication\nchannels between security zones, are evaluated for vulnerabilities that could allow manipulation or\nspoofing of system communication messages, DoS of system communication, or information gathering.\n\nProgramming errors are identified in SCADA applications that can be exploited for unauthorized\naccess, privilege escalation, data manipulation, DoS attacks, etc. Server applications, that parse network\ntraffic, are top priority because of their exposure to the network.\n\nSCADA user interface applications are evaluated for weak authentication or other vulnerabilities that\ncould allow unauthorized access to system diagrams and monitoring and control functionalities.\n\nSCADA and OS user accounts, services, and applications are evaluated for unnecessary privileges to\nfiles and SCADA and OS commands. SCADA functionalities and user accounts that are not\ncompartmentalized can make it hard to contain an attacker who has gained access to a system component.\n\nNSTB assessments evaluate SCADA installation network defenses, as well as SCADA vendor\nnetwork recommendations. They test the effectiveness of network designs and implementations at\npreventing unauthorized traffic to and from SCADA networks. The ability of the network defense\nstrategy to effectively filter and monitor traffic, given the SCADA system design, is also evaluated.\n\nThe most common and significant SCADA vulnerability types are described in this report. The\ninformation is presented at a high level to facilitate reporting and understanding of the major SCADA\nsecurity issues without disclosing system-specific details. Vulnerabilities are derived from NSTB\nSCADA security assessments of varying subsets of components and functionalities, ranging from\nminimal supervisory control test systems to full production systems used for electric power generation\nand transmission. Assessment results are the vulnerabilities discovered using typical attack\nmethodologies, in the allotted timeframe. Attack targets vary, but always support the goal of creating an\nattack path through necessary communication channels and manipulating or disrupting system operations.\nTable A-1 shows high level, generic SCADA security assessment targets.\n\n\n-----\n\nTable A-1. Generic SCADA security assessment targets.\n\n**Assessment Target** **Targeted Component** **Methods**\n\nIdentify Known Vulnerabilities Unauthorized access to Vulnerability and port scans\nand Listening Services SCADA hosts and applications Common attack tools\n\nEvaluate Communication Network traffic MitM\nChannels Analyze network traffic\n\nReverse engineer protocol\nSpoof, drop, or alter messages\n\nEvaluate Network Services Server applications (aka Network fuzzing\nprotocol implementations) Reverse engineer binaries\n\nCode reviews\n\nEvaluate Authentication Applications and services used Penetration testing\nMechanisms for SCADA operations Analyze network traffic\n\nEvaluate Security User accounts, services, and Evaluate user accounts\nConfigurations applications Evaluate permissions and access controls\n\nEvaluate credentials management\n\nEvaluate Network Defenses Network device configurations Traffic captures and analysis\nand firewall rules Production network diagrams, ACLs, firewall\n\nrules and Intrusion Detection System (IDS)\nsignatures are reviewed and discussed with\nthe network administrator\n\n#### A-1. Reporting Methodology\n\nSCADA product assessments focus on vulnerabilities that are inherent in the product, and are\ntherefore representative of installed systems. The reporting standard is to only report configuration and\npassword findings if they are representative of production system settings. Network architecture and\nfirewall rules are only assessed if they are provided as recommended configurations.\n\nThe attacker must be able to access the SCADA to do harm. From a cybersecurity perspective, this\nmeans that they must create an attack path from their attack computer to the SCADA. An attack could\npotentially start from any point between the Internet and the physical equipment that the SCADA is\nmonitoring. Layers of defense are necessary for protection against multiple threat vectors.\n\nAny computer that is connected to the Internet, directly or indirectly, is a potential risk for an attack\nfrom viruses or external attackers. An attack initiated from the Internet must create a path to the SCADA\nnetwork. The number of possible paths to the target is the system’s exposure. SCADAs are generically\nexposed to attack through connections to the corporate network for business functions, connections to\npeers (i.e., ICCP connections), connections to remote sites, remote access allowed to vendors, system\nadministrators and operators, and connections to field equipment. Insider threats have a shorter attack\npath based on their access level.\n\nProduction SCADA assessments (i.e., onsite assessments) concentrate on the aspects of the SCADA\nthat the system owner is able to control, such as secure configurations and layers of defense. The\nassessment team only performs penetration testing on disconnected backup or development systems.\n\nThe SCADA network administrators review and discuss production network diagrams, ACLs,\nfirewall rules, and IDS signatures with the assessment team. They can then perform hands-on assessments\nof SCADA and network component configurations together. This includes a review and tour of the\n\n|Assessment Target|Targeted Component|Methods|\n|---|---|---|\n|Identify Known Vulnerabilities and Listening Services|Unauthorized access to SCADA hosts and applications|Vulnerability and port scans Common attack tools|\n|Evaluate Communication Channels|Network traffic|MitM Analyze network traffic Reverse engineer protocol Spoof, drop, or alter messages|\n|Evaluate Network Services|Server applications (aka protocol implementations)|Network fuzzing Reverse engineer binaries Code reviews|\n|Evaluate Authentication Mechanisms|Applications and services used for SCADA operations|Penetration testing Analyze network traffic|\n|Evaluate Security Configurations|User accounts, services, and applications|Evaluate user accounts Evaluate permissions and access controls Evaluate credentials management|\n|Evaluate Network Defenses|Network device configurations and firewall rules|Traffic captures and analysis Production network diagrams, ACLs, firewall rules and Intrusion Detection System (IDS) signatures are reviewed and discussed with the network administrator|\n\n\n-----\n\nproduction system to help identify through documentation, observation, and conversation any possible\nsecurity problems with the production system and network configuration without putting the operational\n(production) system at risk. This is a learning opportunity for both the assessment team and the asset\nowner personnel.\n\nThe NSTB approach has always been to assess SCADA security and educate vendors and owners on\nhow they can make their systems more secure. The granularity of report findings depends on the nature of\nthe problem, the time allocated for that target, and how widespread the problem is. For example, some\nNSTB SCADA security assessments identified general security problems, such as the use of insecure C\nfunctions, and then demonstrated that they could be exploited by creating an exploit for at least one\nexample of the problem. The wording used in reports for this type of finding is similar to:\n\nBuffer overflow in the specified application allows a remote attacker to\nexecute arbitrary code and gain full control of the ICS host it runs on.\nThis is caused by the use of insecure C functions such as strcpy, etc.\nOther buffer overflow vulnerabilities were identified in this and other\napplications. Replace all instances of dangerous C functions with their\nsafe alternatives.\n\nNSTB report findings are mapped to software weakness types defined by the CWE to the extent\npossible. Findings are reported as CWEs to aid in the understanding of SCADA vulnerabilities. SCADA\nvendors and asset owners can refer to the CWE for additional guidance in identifying, mitigating, and\npreventing weaknesses that cause vulnerabilities.[9]\n\nThe common weaknesses in this report are similar security weaknesses found on two or more unique\nSCADA configurations. Findings that mapped to very specific CWEs are reported as a higher level CWE\nthat describes multiple similar weaknesses. Weaknesses are then categorized in various ways to illustrate\nwhen they were created and the types of SCADA components they were found in.\n\n\n-----\n\n-----\n\n## Appendix B\n Vulnerability Scoring\n\nThe most significant vulnerabilities identified in SCADA are those that allow unauthorized control of\nthe physical system. Compromise of the SCADA’s availability and ability to function correctly may also\nhave significant consequences.\n\nLikelihood of a successful attack must also be considered when assessing risk. Exposure to attack,\nattacker awareness of the vulnerability, and exploitation knowledge help assess the probability of a\nsuccessful attack.\n\n#### B-1. CVSS VERSION 2.0 METRICS\n\nGeneric SCADA vulnerabilities are scored in this report using the Common Vulnerability Scoring\nSystem Version 2.0 (CVSS v2) and the most common or highest impact characteristics. CWE\ncharacterization of weaknesses were used where appropriate as well. The following CVSS v2 scoring\ncriteria are taken from the CVSS Scoring Guide.[2]\n\n#### B-1.1 CVSS v2 Base Metrics\n\nThe Base metric group captures the characteristics of a vulnerability that are constant with time and\nacross user environments. The Access Vector, Access Complexity, and Authentication metrics capture\nhow the vulnerability is accessed and whether or not extra conditions are required to exploit it. The three\nimpact metrics measure how a vulnerability, if exploited, will directly affect an Information Technology\n(IT) asset, where the impacts are independently defined as the degree of loss of confidentiality, integrity,\nand availability. CVSS v2 Base scoring metrics are summarized in Table B-1.\n\nTable B-1. CVSS v2 Base scoring metrics.\n\n|Base Metrics|Metric Value|Metric Description|\n|---|---|---|\n|Access Vector|Local|Requires the attacker to have either physical access to the vulnerable system or a local (shell) account.|\n||Adjacent Network|Requires the attacker to have access to either the broadcast or collision domain of the vulnerable software, local IP subnet, for example.|\n||Network|The vulnerable software is bound to the network stack and the attacker does not require local network access or local access, aka “remotely exploitable.”|\n|Access Complexity|High|Specialized access conditions exist.|\n||Medium|The access conditions are somewhat specialized.|\n||Low|Specialized access conditions or extenuating circumstances do not exist.|\n|Authentication|Multiple|Exploiting the vulnerability requires that the attacker authenticate two or more times, even if the same credentials are used each time.|\n||Single|The vulnerability requires an attacker to be logged into the system (such as at a command line or via a desktop session or Web interface).|\n||None|Authentication is not required to exploit the vulnerability.|\n|Confidentiality Impact|None|There is no impact to the confidentiality of the system.|\n||Partial|There is considerable informational disclosure.|\n||Complete|There is total information disclosure, resulting in all system files being revealed.|\n\n\n-----\n\nTable B-1. (continued).\n\n**Base Metrics** **Metric Value** **Metric Description**\nIntegrity None There is no impact to the integrity of the system.\nImpact\n\nPartial Modification of some system files or information is possible, but the attacker\ndoes not have control over what can be modified, or the scope of what the\nattacker can affect is limited.\nComplete There is a total compromise of system integrity. There is a complete loss of\nsystem protection, resulting in the entire system being compromised.\nAvailability None There is no impact to the availability of the system.\nImpact\n\nPartial There is reduced performance or interruptions in resource availability. An\nexample is a network-based flood attack that permits a limited number of\nsuccessful connections to an Internet service.\nComplete There is a total shutdown of the affected resource. The attacker can render\nthe resource completely unavailable.\n\n#### B-1.2 CVSS v2 Temporal Metrics\n\nThe Temporal exploitability metric measures the current state of exploit techniques or code\navailability. Public availability of easy-to-use exploit code increases the number of potential attackers by\nincluding those who are unskilled, thereby increasing the severity of the vulnerability.\n\nThe effectiveness of available work-around mitigations is used to adjust the Temporal score. CVSS\nv2 Temporal scoring metrics are summarized in Table B-2.\n\nTable B-2. CVSS v2 Temporal scoring metrics.\n\n|Base Metrics|Metric Value|Metric Description|\n|---|---|---|\n|Integrity Impact|None|There is no impact to the integrity of the system.|\n||Partial|Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.|\n||Complete|There is a total compromise of system integrity. There is a complete loss of system protection, resulting in the entire system being compromised.|\n|Availability Impact|None|There is no impact to the availability of the system.|\n||Partial|There is reduced performance or interruptions in resource availability. An example is a network-based flood attack that permits a limited number of successful connections to an Internet service.|\n||Complete|There is a total shutdown of the affected resource. The attacker can render the resource completely unavailable.|\n\n|Temporal Metrics|Metric Value|Metric Description|\n|---|---|---|\n|Exploitability|Unproven|No exploit code is available, or an exploit is entirely theoretical.|\n||Proof-of- Concept|Proof-of-concept exploit code or an attack demonstration that is not practical for most systems is available. The code or technique is not functional in all situations and may require substantial modification by a skilled attacker.|\n||Functional|Functional exploit code is available. The code works in most situations where the vulnerability exists.|\n||High|Either the vulnerability is exploitable by functional mobile autonomous code, or no exploit is required (manual trigger) and details are widely available. The code works in every situation, or is actively being delivered via a mobile autonomous agent (such as a worm or virus).|\n||Not Defined|Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.|\n|Remediation Level|Official Fix|A complete vendor solution is available. Either the vendor has issued an official patch, or an upgrade is available.|\n||Temporary Fix|There is an official but temporary fix available. This includes instances where the vendor issues a temporary hotfix, tool, or workaround.|\n||Workaround|There is an unofficial, non-vendor solution available. In some cases, users of the affected technology will create a patch of their own or provide steps to work around or otherwise mitigate the vulnerability.|\n||Unavailable|There is either no solution available or it is impossible to apply.|\n||Not Defined|Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.|\n\n\n-----\n\nTable B-2. (continued).\n\n**Temporal Metrics** **Metric Value** **Metric Description**\nReport Confidence Unconfirmed There is a single unconfirmed source or possibly multiple conflicting\nreports. There is little confidence in the validity of the reports. An\nexample is a rumor that surfaces from the hacker underground.\nUncorroborated There are multiple non-official sources, possibly including independent\nsecurity companies or research organizations. At this point there may be\nconflicting technical details or some other lingering ambiguity.\nConfirmed The vulnerability has been acknowledged by the vendor or author of the\naffected technology. The vulnerability may also be confirmed when its\nexistence is confirmed from an external event such as publication of\nfunctional or proof-of-concept exploit code or widespread exploitation.\nNot Defined Assigning this value to the metric will not influence the score. It is a\nsignal to the equation to skip this metric.\n\n#### B-1.3 CVSS v2 Environmental Metrics\n\nAssessments have shown that different environments can have a bearing on the risk that a\nvulnerability poses to an organization and its stakeholders. The CVSS v2 Environmental metric group\ncaptures the characteristics of a vulnerability that are associated with a specific environment. For this\nreport, generic SCADA security requirements are used to score generic SCADA vulnerabilities.\n\nSecurity requirements metrics enable SCADA owners to customize the CVSS v2 score depending on\nthe importance of the affected component to their own organization, measured in terms of confidentiality,\nintegrity, and availability. DoS vulnerabilities in SCADA components that require high availability will\nreceive higher criticality scores than they otherwise would. The effectiveness of available work-around\nmitigations is used to adjust the Temporal score. CVSS v2 environmental scoring metrics are summarized\nin Table B-3.\n\nTable B-3. CVSS v2 environmental scoring metrics.\n\n|Temporal Metrics|Metric Value|Metric Description|\n|---|---|---|\n|Report Confidence|Unconfirmed|There is a single unconfirmed source or possibly multiple conflicting reports. There is little confidence in the validity of the reports. An example is a rumor that surfaces from the hacker underground.|\n||Uncorroborated|There are multiple non-official sources, possibly including independent security companies or research organizations. At this point there may be conflicting technical details or some other lingering ambiguity.|\n||Confirmed|The vulnerability has been acknowledged by the vendor or author of the affected technology. The vulnerability may also be confirmed when its existence is confirmed from an external event such as publication of functional or proof-of-concept exploit code or widespread exploitation.|\n||Not Defined|Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.|\n\n|Environmental Metrics|Metric Value|Metric Description|\n|---|---|---|\n|Collateral Damage Potential|None|There is no potential for loss of life, physical assets, productivity or revenue.|\n||Low|A successful exploit of this vulnerability may result in slight physical or property damage. Or, there may be a slight loss of revenue or productivity to the organization.|\n||Low- Medium|A successful exploit of this vulnerability may result in moderate physical or property damage. Or, there may be a moderate loss of revenue or productivity to the organization.|\n||Medium- High|A successful exploit of this vulnerability may result in significant physical or property damage or loss. Or, there may be a significant loss of revenue or productivity.|\n||High|A successful exploit of this vulnerability may result in catastrophic physical or property damage and loss. Or, there may be a catastrophic loss of revenue or productivity.|\n||Not Defined|Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.|\n\n\n-----\n\nTable B-3. (continued).\n\n\nAssigning this value to the metric will not influence the score. It is a\nsignal to the equation to skip this metric.\n\n|Environmental Metrics|Metric Value|Metric Description|\n|---|---|---|\n|Target Distribution|None|No target systems exist, or targets are so highly specialized that they only exist in a laboratory setting. Effectively 0% of the environment is at risk.|\n||Low|Targets exist inside the environment, but on a small scale. Between 1% and 25% of the total environment is at risk.|\n||Medium|Targets exist inside the environment, but on a medium scale. Between 26% and 75% of the total environment is at risk.|\n||High|Targets exist inside the environment on a considerable scale. Between 76% and 100% of the total environment is considered at risk.|\n||Not Defined|Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.|\n|Security Requirements|Low|Loss of [confidentiality | integrity | availability] is likely to have only a limited adverse effect on the organization or individuals associated with the organization (e.g., employees, customers).|\n||Medium|Loss of [confidentiality | integrity | availability] is likely to have a serious adverse effect on the organization or individuals associated with the organization (e.g., employees, customers).|\n||High|Loss of [confidentiality | integrity | availability] is likely to have a catastrophic adverse effect on the organization or individuals associated with the organization (e.g., employees, customers).|\n||Not Defined|Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.|\n\n\n-----\n\n## Appendix C\n\n Top 10 Most Critical SCADA Vulnerabilities\n\n#### CONTENTS\n\nC-1. Most Likely Access Vector: Unpatched Published Vulnerabilities.................................................. 94\n\nC-1.1 Generic CVSS v2 Score ......................................................................................................... 94\nC-1.2 Scoring and Reducing the CVSS V2 Risk Metrics ................................................................ 96\n\nC-1.2.1 Base Metrics .............................................................................................................. 96\nC-1.2.2 Environmental Metrics .............................................................................................. 96\nC-1.2.3 Temporal Metrics ...................................................................................................... 97\nC-1.2.4 Unpatched Published Vulnerabilities Recommendations ......................................... 97\nC-1.2.5 SCADA Vendor Recommendations ......................................................................... 98\nC-1.2.6 SCADA Owner Recommendations........................................................................... 98\n\nC-2. Supervisory Control Access: Web HMI Vulnerabilities .................................................................. 98\n\nC-2.1 Generic CVSS v2 Score ......................................................................................................... 99\nC-2.2 Scoring and Reducing the Web HMI CVSS Risk Metrics ................................................... 100\n\nC-2.2.1 Base Exploitability Metrics ..................................................................................... 100\nC-2.2.2 Impact Metrics ........................................................................................................ 102\nC-2.2.3 Percentage of Vulnerable Systems (Target Distribution) ....................................... 103\nC-2.2.4 Temporal Metrics .................................................................................................... 103\nC-2.2.5 Web HMI Recommendation Summary ................................................................... 105\n\nC-3. Supervisory Control Access: Use of Vulnerable Remote Display Protocols ................................. 107\n\nC-3.1 Generic CVSS v2 Score ....................................................................................................... 108\nC-3.2 Scoring and Reducing the CVSS Risk Metrics .................................................................... 110\n\nC-3.2.1 Base Exploitability Metrics ..................................................................................... 110\nC-3.2.2 Impact Metrics ........................................................................................................ 111\nC-3.2.3 Percentage of Vulnerable Systems (Target Distribution) ....................................... 112\nC-3.2.4 Temporal Score Metrics .......................................................................................... 113\nC-3.2.5 Remote Access Recommendation Summary .......................................................... 114\n\nC-4. Access to SCADA Functionality: Improper Access Control (Authorization) ................................ 115\n\nC-4.1 Generic CVSS v2 Score ....................................................................................................... 116\nC-4.2 Scoring and Reducing the CVSS Risk Metrics .................................................................... 117\n\nC-4.2.1 Base Exploitability Metrics ..................................................................................... 117\nC-4.2.2 Impact Metrics ........................................................................................................ 119\nC-4.2.3 Percentage of Vulnerable Systems (Target Distribution) ....................................... 120\nC-4.2.4 Temporal Score Metrics .......................................................................................... 120\nC-4.2.5 Improper Access Control Recommendation Summary ........................................... 121\n\nC-5. Access to SCADA Applications: Improper Authentication ........................................................... 123\n\nC-5.1 Generic CVSS v2 Score ....................................................................................................... 124\nC-5.2 Scoring and Reducing the CVSS Risk Metrics .................................................................... 125\n\n\n-----\n\nC-5.2.1 Base Exploitability Metrics ..................................................................................... 125\nC-5.2.2 Impact Metrics ........................................................................................................ 126\nC-5.2.3 Percentage of Vulnerable Systems (Target Distribution) ....................................... 127\nC-5.2.4 Temporal Score Metrics .......................................................................................... 127\nC-5.2.5 Improper Authentication Recommendation Summary ........................................... 128\n\nC-6. SCADA Host Access: Buffer Overflows in SCADA Services ...................................................... 129\n\nC-6.1 Generic CVSS v2 Score ....................................................................................................... 130\nC-6.2 Scoring and Reducing the CVSS Risk Metrics .................................................................... 131\n\nC-6.2.1 Base Exploitability Metrics ..................................................................................... 132\nC-6.2.2 Impact Metrics ........................................................................................................ 133\nC-6.2.3 Percentage of Vulnerable Systems (Target Distribution) ....................................... 135\nC-6.2.4 Temporal Score Metrics .......................................................................................... 135\nC-6.2.5 SCADA Services Recommendation Summary ....................................................... 136\n\nC-7. Supervisory Control Access: SCADA Data and Command Message Manipulation and\nInjection .......................................................................................................................................... 138\nC-7.1 Generic CVSS v2 Score ....................................................................................................... 139\nC-7.2 Scoring and Reducing the CVSS Risk Metrics .................................................................... 140\n\nC-7.2.1 Base Exploitability Metrics ..................................................................................... 140\nC-7.2.2 Base Impact Metrics ................................................................................................ 142\nC-7.2.3 Percentage of Vulnerable Systems (Target Distribution) ....................................... 142\nC-7.2.4 Temporal Score Metrics .......................................................................................... 142\nC-7.2.5 SCADA Protocol Recommendation Summary ....................................................... 143\n\nC-8. Data Historian Access: SQL Injection ............................................................................................ 144\n\nC-8.1 Generic CVSS v2 Score ....................................................................................................... 145\nC-8.2 Scoring and Reducing the CVSS Risk Metrics .................................................................... 146\n\nC-8.2.1 Base Exploitability Metrics ..................................................................................... 146\nC-8.2.2 Impact Metrics ........................................................................................................ 147\nC-8.2.3 Percentage of Vulnerable Systems (Target Distribution) ....................................... 148\nC-8.2.4 Temporal Score Metrics .......................................................................................... 148\nC-8.2.5 SQL Injection Recommendation Summary ............................................................ 148\n\nC-9. SCADA Host Access: Use of Standard IT Protocols with Clear-text Authentication ................... 149\n\nC-9.1 Generic CVSS v2 Score ....................................................................................................... 150\nC-9.2 Scoring and Reducing the CVSS Risk Metrics .................................................................... 151\n\nC-9.2.1 Base Exploitability Metrics ..................................................................................... 151\nC-9.2.2 Impact Metrics ........................................................................................................ 152\nC-9.2.3 Temporal Score Metrics .......................................................................................... 153\nC-9.2.4 Clear-text Protocol Recommendation Summary .................................................... 154\n\nC-10. SCADA Credentials Gathering: Unprotected Transport of SCADA Application Credentials ...... 155\n\nC-10.1 Generic CVSS v2 Score .......................................................................................... 156\nC-10.2 Scoring and Reducing the CVSS Risk Metrics ....................................................... 157\nC-10.2.1 Base Exploitability Metrics ........................................................................ 157\nC-10.2.2 Impact Metrics ........................................................................................... 157\nC-10.2.3 Percentage of Vulnerable Systems (Target Distribution) .......................... 158\nC-10.2.4 Temporal Score Metrics ............................................................................. 158\n\n\n-----\n\nC-10.2.5 Clear-text Transmission of SCADA Application Credentials\nRecommendation Summary .................................................................................... 159\n\nC-11. SCADA Environmental Security Requirements ............................................................................ 160\n\nC-11.1 SCADA Component Confidentiality Requirements ............................................... 160\nC-11.2 SCADA Component Integrity Requirements .......................................................... 161\nC-11.3 SCADA Component Availability Requirements .................................................... 161\n\nC-12. Summary of SCADA Common Vulnerability Ranking ................................................................. 162\n\n\n-----\n\n## Top 10 Most Critical SCADA Vulnerabilities\n\nThe most significant SCADA vulnerabilities are listed in Table C-1 using CVSS v2 metrics applied\ngenerically to the vulnerabilities identified during NSTB assessments. These scores can be adjusted for\nspecific vulnerabilities on individual SCADA installations.\n\nThis list does not represent the state of all SCADA products and systems. It represents the most\nsignificant common vulnerabilities identified on SCADA products and systems that have been evaluated\nby the INL DOE-OE NSTB program from 2003 through 2011. This list is intended as awareness of\ncommon security weaknesses in SCADA that can have serious consequences if exploited. SCADA\nvendors and owners can assess their systems for these common SCADA vulnerabilities and remediate or\nmitigate them to the extent possible.[a]\n\nTable C-1. Top 10 most critical SCADA vulnerabilities.\n\n**Vulnerability** **SCADA Impact**\n\nUnpatched Published Vulnerabilities Most Likely Access Vector\n\nWeb Human-machine Interface (HMI) Vulnerabilities Supervisory Control Access\n\nUse of Vulnerable Remote Display Protocols Supervisory Control Access\n\nAccess to SCADA\nImproper Access Control (Authorization)\nFunctionality\n\nAccess to SCADA\nImproper Authentication\nApplications\n\nBuffer Overflows in SCADA Services SCADA Host Access\n\nSCADA Data and Command Message Manipulation and\nSupervisory Control Access\nInjection\n\nSQL Injection Data Historian Access\n\nSCADA Credentials\nUse of Standard IT Protocols with Clear-text Authentication\nGathering\n\nSCADA Credentials\nUnprotected Transport of SCADA Application Credentials\nGathering\n\na. CVSS metrics are intended for specific vulnerabilities. This section attempts to use the concepts of the CVSS generically to\nhelp explain the risks associated with vulnerabilities commonly found in SCADAs. In an attempt to illustrate how the\nseverity of vulnerabilities depends on how and where the affected SCADA components are used, some of the examples may\ndeviate from the intended use which is to focus on a particular vulnerability.\n\n|Vulnerability|SCADA Impact|\n|---|---|\n|Unpatched Published Vulnerabilities|Most Likely Access Vector|\n|Web Human-machine Interface (HMI) Vulnerabilities|Supervisory Control Access|\n|Use of Vulnerable Remote Display Protocols|Supervisory Control Access|\n|Improper Access Control (Authorization)|Access to SCADA Functionality|\n|Improper Authentication|Access to SCADA Applications|\n|Buffer Overflows in SCADA Services|SCADA Host Access|\n|SCADA Data and Command Message Manipulation and Injection|Supervisory Control Access|\n|SQL Injection|Data Historian Access|\n|Use of Standard IT Protocols with Clear-text Authentication|SCADA Credentials Gathering|\n|Unprotected Transport of SCADA Application Credentials|SCADA Credentials Gathering|\n\n\n-----\n\nPatterned after the 2010 CWE/SANS Top 25 Most Dangerous Programming Errors,[10] the most\ncritical SCADA vulnerability types are summarized in Sections C1–C10 using the attributes in Table C-2,\nwhen applicable. Attributes assigned to weaknesses that appeared on the SANS/CWE Most Dangerous\nProgramming Errors list were used for associated vulnerabilities.\n\nTable C-2. Most critical SCADA vulnerability attributes.\n\n**Vulnerability Attribute** **Attribute Description**\n**Possible Consequences** When this weakness occurs in software to form a vulnerability, what are the typical\nconsequences of exploiting it?[10]\n\n**SCADA Impact** SCADA specific consequences.\n\n**Vulnerable Components** SCADA components that may have this vulnerability.\n\n**Ease of Detection** How easy it is for an attacker to find this weakness.[10]\n\n**Attacker Awareness** The likelihood that an attacker is going to be aware of this particular weakness,\nmethods for detection, and methods for exploitation.[10]\n\n**Internet Attack Frequency** How often the weakness occurs in vulnerabilities that are exploited by an\nattacker.[10]\n\n**Remediation Cost** The amount of effort required to fix the weakness.[10]\n\n**Weakness Prevalence** How often the issue is encountered in software.[10]\n\n**SCADA Prevalence** How often the weakness is encountered during assessments.\n\nThe10 vulnerability types were selected because they are commonly seen on SCADA assessments\nand can pose a significant risk to a SCADA. CVSS scores are designed to support vulnerability mitigation\nprioritization. Scores for common vulnerabilities found on SCADAs have been generated using the most\ncommon attributes for the individual SCADA installations.\n\nThese vulnerabilities generally have a higher probability of being exploited and can potentially have a\nhigher impact on an SCADA. High risk factors (probability and potential impact scores) and the\nwidespread nature of these security weaknesses put these vulnerabilities at the top of the list for\nremediation in SCADAs as a whole. SCADA vendors and owners can assess their systems for these types\nof vulnerabilities, prioritize them using CVSS scores tailored to each vulnerability and the unique\nSCADA environment, and remediate them to the extent possible.\n\nComplete remediation is not always feasible. Mitigation techniques can be guided by the CVSS\nmetric values. Actions that alter vulnerability characteristics to a lower metric value lower the actual risk\nto the SCADA. For example, removing the vulnerable application from hosts that do not require it will\nreduce the probability of exploit, measured by the Target Distribution metric. Table C-3 lists generic\nguidance on lowering the probability of a vulnerability being exploited (aka exploitability).\n\n|Vulnerability Attribute|Attribute Description|\n|---|---|\n|Possible Consequences|When this weakness occurs in software to form a vulnerability, what are the typical consequences of exploiting it?10|\n|SCADA Impact|SCADA specific consequences.|\n|Vulnerable Components|SCADA components that may have this vulnerability.|\n|Ease of Detection|How easy it is for an attacker to find this weakness.10|\n|Attacker Awareness|The likelihood that an attacker is going to be aware of this particular weakness, methods for detection, and methods for exploitation.10|\n|Internet Attack Frequency|How often the weakness occurs in vulnerabilities that are exploited by an attacker.10|\n|Remediation Cost|The amount of effort required to fix the weakness.10|\n|Weakness Prevalence|How often the issue is encountered in software.10|\n|SCADA Prevalence|How often the weakness is encountered during assessments.|\n\n\n-----\n\nTable C-3. Lowering risk due to the probability of a vulnerability being exploited.\n\n**Recommendation** **Potential Methods**\nIncrease Access Complexity Restrict physical and electronic access to hosts, services, applications and\nother devices to the extent possible using method such as:\n\n               - Detailed host and network firewall rules (directional, by IP, port, etc.)\n\n               - Restrict physical access, including port security on network switches\nIncrease Level of Authentication Increase access complexity by enforcing access controls with strong\nNeeded authentication.\n\n               - Configure hosts, services, applications and other devices to require\ncredentials\n\n               - Utilize multi-factor authentication where feasible and prudent (i.e.. VPN\nconnections)\nDecrease Target Distribution Uninstall vulnerable service or application wherever possible\nIncrease Level of Remediation Vendor: Develop and distribute a fix\nOwner: Develop and share a workaround mitigation for unsupported\ncomponents\n\nTable C-4 lists generic guidance on lowering the potential impact of a vulnerability being exploited.\n\nTable C-4. Lowering risk due to the potential impact of vulnerability exploitation.\n\n**Recommendation** **Potential Methods**\nReduce Base Impact Lower the privileges that users, applications, and services are granted\nReduce Environmental Impact Remove unnecessary functionality from SCADA hosts, applications, and\nservices\n\nBase metrics are intrinsic qualities of a specific vulnerability, but vendors and owners may be able to\nremove or change their vulnerabilities. Base characteristics about how a vulnerability can be accessed and\nits potential impacts cannot be directly changed, but may be indirectly changed with mitigating\ntechniques that change how the vulnerability can be accessed, by whom, and the number of credentials\nrequired. Configuration changes may also be made that lessen the accessibility and potential impacts.\n\nAssessments have shown that vulnerabilities in SCADA products can be introduced by their design,\ncode, or integration of third-party products. SCADA vendors may be able to remediate vulnerabilities by\nredesign, code changes, or changing which third-party products they integrate with. They also have the\nability to prevent vulnerabilities in new products.\n\nSome attributes are configuration dependent and some vulnerabilities are caused by insecure\nconfigurations. SCADA vendors and/or owners can affect these vulnerabilities.\n\nEnvironmental metrics adjust the Base metrics for the effect the vulnerability has on the unique\norganization’s environment. For example, an SCADA environment is more vulnerable to availability\nimpacts than most other types of computer systems. This helps SCADA vendors and owners evaluate the\nrisk individual vulnerabilities bring to their particular environments.\n\nSections C1–C10 summarize each of the 10 most critical common SCADA vulnerabilities. Attributes\nused in determining their criticality are listed, as well as the potential CVSS metric values. Specific\ninformation on each of the CVSS metrics is given to aid in understanding and scoring these types of\nvulnerabilities. This information may help SCADA vendors and owners identify ways they can lower the\nprobability of exploitation or potential impact due to these common SCADA vulnerability types. Some of\n\n|Recommendation|Potential Methods|\n|---|---|\n|Increase Access Complexity|Restrict physical and electronic access to hosts, services, applications and other devices to the extent possible using method such as: • Detailed host and network firewall rules (directional, by IP, port, etc.) • Restrict physical access, including port security on network switches|\n|Increase Level of Authentication Needed|Increase access complexity by enforcing access controls with strong authentication. • Configure hosts, services, applications and other devices to require credentials • Utilize multi-factor authentication where feasible and prudent (i.e.. VPN connections)|\n|Decrease Target Distribution|Uninstall vulnerable service or application wherever possible|\n|Increase Level of Remediation|Vendor: Develop and distribute a fix Owner: Develop and share a workaround mitigation for unsupported components|\n\n|Recommendation|Potential Methods|\n|---|---|\n|Reduce Base Impact|Lower the privileges that users, applications, and services are granted|\n|Reduce Environmental Impact|Remove unnecessary functionality from SCADA hosts, applications, and services|\n\n\n-----\n\nthese risk factors cannot be influenced for a vulnerability type. Environmental attributes specific to the\ncommon vulnerability are addressed. Common SCADA environmental security requirements are\ndiscussed in Section C11. Section C12 summarizes ways of lowering the risk associated with the highest\nrisk common cyber vulnerabilities in SCADA systems.\n\n#### C-1. Most Likely Access Vector: Unpatched Published Vulnerabilities\n\nIn general, patches are the highest priority because they remediate vulnerabilities with the highest\nthreat. “Public availability of easy-to-use exploit code increases the number of potential attackers by\nincluding those who are unskilled, thereby increasing the severity of the vulnerability.”[2]\n\nTable C-5 summarizes the security relevant attributes of unpatched software and their potential risk to\nSCADAs.\n\nTable C-5. Summary of unpatched published vulnerabilities’ security characteristics.\n\n**Unpatched Published Vulnerabilities**\n\n**Possible Consequences** Compromise of SCADA hosts and applications. May allow DoS, code execution,\ndata loss, or security bypass.\n\n**SCADA Impact** Unauthorized access to SCADA components: Most likely access vector\n\n**Vulnerable Components** Unpatched operating systems, applications, services and libraries on SCADA hosts\n\n**Ease of Detection** Easy\n\n**Attacker Awareness** High\n\n**Internet Attack Frequency** High\n\n**Remediation Cost** Low\n\n**SCADA Prevalence** High\n\n#### C-1.1 Generic CVSS v2 Score\n\nEach vulnerability must be scored individually. The criticality of each unpatched vulnerability is\ndifferent. CVSS v2 scores of published vulnerabilities are available from multiple vulnerability databases,\nsuch as the National Vulnerability Database.[b] Base scores can then be tailored to the current Temporal\nvalues and the particular environment. For a set of vulnerabilities with equal base and environmental\nimpact scores, the published vulnerabilities are higher priority.\n\nThe example scores in Table C-6 represent the most dangerous known vulnerabilities identified on\nSCADA systems for commonly unpatched components.\n\nIn general, OS services are network accessible and do not require authentication to exploit.\nVulnerabilities in OS services can potentially be exploited to gain control of the host. The Access\nComplexity is “Low” because no additional access or specialized circumstances need to exist for the\nexploit to be successful.\n\nIf an attacker successfully exploits a network service, they may be able to execute arbitrary code with\nthe privileges of the exploited application. If the vulnerable service is executed with administrative\n(system) privileges, a complete host compromise is possible. If the privileges gained allow access to\n\nb. http://web.nvd.nist.gov/view/vuln/search\n\n|Unpatched Published Vulnerabilities|Col2|\n|---|---|\n|Possible Consequences|Compromise of SCADA hosts and applications. May allow DoS, code execution, data loss, or security bypass.|\n|SCADA Impact|Unauthorized access to SCADA components: Most likely access vector|\n|Vulnerable Components|Unpatched operating systems, applications, services and libraries on SCADA hosts|\n|Ease of Detection|Easy|\n|Attacker Awareness|High|\n|Internet Attack Frequency|High|\n|Remediation Cost|Low|\n|SCADA Prevalence|High|\n\n\n-----\n\nSCADA functionality, a successful exploit may result in catastrophic physical or property damage and\nloss; or there may be a catastrophic loss of revenue or productivity.\n\nPotential CVSS v2 metric values are summarized in Table C-6.\n\nTable C-6. Generic CVSS v2 score for published vulnerabilities.\n\n|Metric|Value|\n|---|---|\n|Base Metric||\n|Access Vector|Network|\n|Access Complexity|Low|\n|Authentication|None|\n|Confidentiality Impact|Complete|\n|Integrity Impact|Complete|\n|Availability Impact|Complete|\n|Base Score|10.0|\n|Temporal Metric||\n|Exploitability|High|\n|Remediation Level|Not Defined|\n|Report Confidence|Confirmed|\n|Temporal Score|10.0|\n|Environmental Metrics||\n|Collateral Damage Potential|High|\n|Target Distribution|Not Defined|\n|Availability Requirement|Medium|\n|Integrity Requirement|High|\n|Confidentiality Requirement|Medium|\n|Environmental Score|10.0|\n|Total Score|10.0|\n|10||\n\n\n**10**\n\n\n-----\n\n#### C-1.2 Scoring and Reducing the CVSS V2 Risk Metrics\n\n**C-1.2.1** **Base Metrics**\n\nBase metric values are fundamental characteristics of each individual vulnerability. All Base metric\nvalues are possible for unpatched published vulnerabilities. Most published vulnerabilities along with\nBase metric values are available from the National Vulnerability Database.[c]\n\n**C-1.2.2** **Environmental Metrics**\n\nAll Environmental metric values are possible and depend on the SCADA and its vulnerable\ncomponents.\n\n**_C-1.2.2.1_** **_Environmental Security Requirements_**\n\nSecurity Requirements are characteristics of the individual SCADA components that host the\nvulnerable service or application. They measure the potential for loss of revenue or life due to loss of\nconfidentiality, integrity, or availability of the vulnerable SCADA hosts or devices. See Section C-11,\n“SCADA Environmental Security Requirements,” below.\n\n**_C-1.2.2.2_** **_Collateral Damage Potential_**\n\nA remote attacker will most likely gain access to the SCADA by exploiting a known vulnerability.\nUnpatched published vulnerabilities are the most likely access vector because exploits for published\nvulnerabilities do not require knowledge of the SCADA. The potential impact to the SCADA depends on\nthe individual vulnerability.\n\nCollateral damage potential may be reduced by removing the vulnerable application from systems\nwhere comprise could lead to unacceptable loss of revenue, safety, or productivity (if possible).\n\n**_C-1.2.2.3_** **_Target Distribution_**\n\nTarget Distribution is the percentage of SCADA hosts and devices that have the vulnerable software\ninstalled on them.\n\nTarget Distribution can be reduced by removing the vulnerable application from as many systems as\npossible. SCADA vendors can help by using up to date third-party applications that do not contain\npublished vulnerabilities.\n\nSCADA owners can lower the Target Distribution metric by removing the vulnerable application\nfrom as many systems as possible.\n\nc. http://web.nvd.nist.gov/view/vuln/search\n\n\n-----\n\n**C-1.2.3** **Temporal Metrics**\n\nSCADA vendors and owners cannot change the publicity of vulnerabilities and associated attack\ntechniques. They may have the power to change the available mitigations as well as the host, network,\nand SCADA access that can be acquired via compromise of the vulnerability in their environment.\n\n**_C-1.2.3.1_** **_Remediation Level_**\n\nSCADA vendors can reduce the risk due to published vulnerabilities by delivering new systems\nwithout known vulnerabilities and test patches for third-party products as they are released. In some cases\nchanges to the SCADA code is necessary for interaction with new versions of third-party products.\n\nSCADA owners can test patches and updates themselves if SCADA vendor support is not available.\nSCADA owners may need to choose between applying patches and vendor support, if the SCADA vendor\nwill not support the application of third-party patches or updates to their system. Table C-7 shows\npotential Remediation Level scenarios.\n\nTable C-7. CVSS v2 Remediation Level metric values.\n\n**Metric Value** **Metric Description**\nOfficial Fix A complete vendor solution is available. The application vendor has issued an official patch or\nan upgrade is available, and the SCADA vendor has approved it.\nTemporary Fix There is an official but temporary fix available. This includes instances where the vendor\nissues a temporary hotfix, tool, or workaround.\nWorkaround There is an unofficial, non-vendor solution available. SCADA owners have created a patch of\ntheir own or provided steps to work around or otherwise mitigate the vulnerability.\nUnavailable There is either no solution available or it is impossible to apply. For example, an upgrade is\navailable, but it will void SCADA support or it has been proven to be incompatible with the\nSCADA.\n\n**C-1.2.4** **Unpatched Published Vulnerabilities Recommendations**\n\nSCADA vendors and owners cannot change the publicity of vulnerabilities and associated attack\ntechniques. They also may not be able to change the criticality of each system component. However, they\ncan change the available mitigations as well as the host, network, and SCADA access that can be acquired\nvia compromise of the vulnerability in their environment.\n\nTable C-8 lists specific recommendations for lowering the probability of a known vulnerability being\nexploited (aka exploitability).\n\nTable C-8. Lowering risk due to the probability of a known vulnerability being exploited.\n\n|Metric Value|Metric Description|\n|---|---|\n|Official Fix|A complete vendor solution is available. The application vendor has issued an official patch or an upgrade is available, and the SCADA vendor has approved it.|\n|Temporary Fix|There is an official but temporary fix available. This includes instances where the vendor issues a temporary hotfix, tool, or workaround.|\n|Workaround|There is an unofficial, non-vendor solution available. SCADA owners have created a patch of their own or provided steps to work around or otherwise mitigate the vulnerability.|\n|Unavailable|There is either no solution available or it is impossible to apply. For example, an upgrade is available, but it will void SCADA support or it has been proven to be incompatible with the SCADA.|\n\n|Recommendation|Potential Methods|\n|---|---|\n|Increase Access Complexity|Restrict access to vulnerable applications and services|\n|Decrease Target Distribution|Uninstall the vulnerable service or application wherever possible|\n|Increase Level of Remediation|Vendor: Deliver new systems without known vulnerabilities and test patches for third-party products as they are released Owner: Develop and share a workaround mitigation for unsupported components|\n\n\n-----\n\nTable C-9 lists recommendations on lowering the potential impact of a known vulnerability being\nexploited.\n\nTable C-9. Lowering risk due to the potential impact of known vulnerability exploitation.\n\n**Recommendation** **Potential Methods**\nReduce Base Impact Minimize the privileges of users, applications and services that are allowed\nto access vulnerable applications, services, etc.\nReduce Environmental Impact Remove unnecessary data and functionality from SCADA components that\nhost vulnerable applications\n\nSee Section 4.1, “Published Vulnerabilities,” for more information about this vulnerability.\n\n**C-1.2.5** **SCADA Vendor Recommendations**\n\nSCADA vendors can reduce this score by changing the Remediation Level metric. The most\nimportant things that SCADA vendors can do to reduce the risk due to published vulnerabilities is to\ndeliver new systems without known vulnerabilities and test patches for third-party products as they are\nreleased.\n\n**C-1.2.6** **SCADA Owner Recommendations**\n\nSCADA owners may be able to reduce the risk from a known vulnerability on their system by\ncreating a patch of their own or providing steps to work around or otherwise mitigate the vulnerability. If\nvendor support is not available for testing patches, owners can test patches and mitigations on backup or\ntest systems. If SCADA code is available, owners can alter the code to interface with new third-party\nApplication Programming Interfaces (APIs). Firewall rules or IDS signatures may be able to prevent or\ndetect attempts to exploit the vulnerability.\n\n#### C-2. Supervisory Control Access: Web HMI Vulnerabilities\n\nAssessments have found that web services developed for the SCADA tend to be vulnerable to attacks\nthat can exploit the SCADA Web server to gain unauthorized access. System architectures often use\nnetwork Demilitarized Zones (DMZs) to protect critical systems and to limit exposure of network\ncomponents. Vulnerabilities in SCADA DMZ Web servers may provide the first step in the attack path by\nallowing access within the SCADA exterior boundary. Vulnerabilities in lower level components’ Web\nservers can provide more steps in the attack path.\n\nSCADA assessments have also found improper authentication, improper session tracking, SQL\ninjection, and XSS vulnerabilities that can allow unauthorized access to Web servers and applications.\nImproper authentication can allow an attacker to impersonate another user’s identity.\n\nThe use of vulnerable Web applications or servers for supervisory control functions can pose the\nsame risk to the physical system as remote display protocols because it allows unauthorized remote access\nto graphical supervisory control software, as well as any other functionality built into the Web application\nor allowed to the Web server. Table C-10 summarizes the relevant security attributes of SCADA Web\napplication vulnerabilities and their potential risks to the SCADA.\n\n|Recommendation|Potential Methods|\n|---|---|\n|Reduce Base Impact|Minimize the privileges of users, applications and services that are allowed to access vulnerable applications, services, etc.|\n|Reduce Environmental Impact|Remove unnecessary data and functionality from SCADA components that host vulnerable applications|\n\n\n-----\n\nCommon Web vulnerability details are given in Section 4.4.3, “Web applications and services.”\n\nTable C-10. Summary of SCADA Web application security characteristics.\n\n**SCADA Web Application Vulnerabilities**\n\n**Possible Consequences** User accounts compromised or user sessions hijacked\n\nExposure of resources or functionality to unintended actors, possibly providing\nattackers with sensitive information or allowing execution of arbitrary code\n\n**SCADA Impact** Unauthorized access to Web HMI, Web server, or other Web applications and\nfunctionalities: possible unauthorized remote access to graphical supervisory\ncontrol software, as well as any other functionality built into the Web application or\nallowed to the Web server\n\n**Vulnerable Components** SCADA Web applications and servers and/or SCADA Web clients’ and servers’\nhosts\n\n**Ease of Detection** Medium to High\n\n**Attacker Awareness** High\n\n**Remediation Cost** Low\n\n**SCADA Prevalence** High\n\n#### C-2.1 Generic CVSS v2 Score\n\nSince an attacker can remotely exploit Web applications over the network, the Access Vector is\n“Network”. All other Base metrics are possible.\n\nWeb attack techniques are well known, even if a particular SCADA’s Web vulnerabilities are\nunknown. Automated tools for identifying and exploiting Web vulnerabilities are available, so\nExploitability is set to “High.”\n\nCollateral Damage Potential is high because a successful compromise of the Web HMI application or\nserver may result in supervisory control access. CVSS v2 metrics for the use of remote display protocols\non SCADAs are summarized in Table C-11 using the most common or critical values seen on SCADA.\n\nTable C-11. Generic CVSS v2 score for SCADA Web application vulnerabilities.\n\n|SCADA Web Application Vulnerabilities|Col2|\n|---|---|\n|Possible Consequences|User accounts compromised or user sessions hijacked|\n||Exposure of resources or functionality to unintended actors, possibly providing attackers with sensitive information or allowing execution of arbitrary code|\n|SCADA Impact|Unauthorized access to Web HMI, Web server, or other Web applications and functionalities: possible unauthorized remote access to graphical supervisory control software, as well as any other functionality built into the Web application or allowed to the Web server|\n|Vulnerable Components|SCADA Web applications and servers and/or SCADA Web clients’ and servers’ hosts|\n|Ease of Detection|Medium to High|\n|Attacker Awareness|High|\n|Remediation Cost|Low|\n|SCADA Prevalence|High|\n\n|Metric|Values|\n|---|---|\n|Base Metric||\n|Access Vector|Network|\n|Access Complexity|Low|\n|Authentication|None|\n|Confidentiality Impact|Complete|\n|Integrity Impact|Complete|\n|Availability Impact|Complete|\n|Base Score|10.0|\n|Temporal Metric||\n|Exploitability|High|\n\n\n-----\n\n|Metric|Values|\n|---|---|\n|Remediation Level|Not Defined|\n|Report Confidence|Not Defined|\n|Temporal Score|10.0|\n|Environmental Metrics||\n|Collateral Damage Potential|High|\n|Target Distribution|Not Defined|\n|Availability Requirement|Medium|\n|Integrity Requirement|High|\n|Confidentiality Requirement|Medium|\n|Environmental Score|10.0|\n|Overall CVSS Score|10.0|\n|10||\n\n\n**10**\n\n\n#### C-2.2 Scoring and Reducing the Web HMI CVSS Risk Metrics\n\n**C-2.2.1** **Base Exploitability Metrics**\n\n**_C-2.2.1.1_** **_Related Exploit Range (Access Vector)_**\n\nWeb HMI applications are bound to the network stack. Since an attacker can remotely exploit Web\napplications over the network, the Access Vector is Network. This is the nature of Web applications, and\ncannot be changed.\n\nSCADA vendors should have all code evaluated for security. Network accessible applications should\nbe first priority because they are most exposed to attack. Web applications that provide SCADA control\nfunctionality should be at the top of the list for vulnerability identification and remediation.\n\n**_C-2.2.1.2_** **_Access Complexity_**\n\nAccess Complexity measures the complexity of the attack required to exploit the vulnerability once\nan attacker has gained access to the target system. Table C-12 gives example scenarios that fit each of the\nAccess Complexity metric values in an SCADA environment.\n\nTable C-12. Web HMI CVSS v2 Access Complexity scenarios.\n\n|Metric Value|Web HMI Access Complexity Scenarios|\n|---|---|\n|High|Specialized access conditions exist. For example, if access to the Web HMI is filtered, the attacking party is limited to the group of systems or users that have been given authorization. This does include, however, an attacker who is able to spoof or gain access to an authorized system or user account (i.e., access to the Web HMI is limited to a group of systems and users).|\n|Medium|The access conditions are somewhat specialized; the following are examples: • The attacking party is limited to a group of systems or users at some level of authorization,|\n\n\n-----\n\n        - The vulnerable configuration is default or ubiquitous (i.e., the default Web HMI\nconfiguration does not use authentication or encryption, or allows control of the physical\nprocess).\n\nSCADA owners may want to make access to a Web HMI as difficult as possible. The group of\nsystems and users that have access to the Web HMI can be restricted as much as possible. Web HMI\nmonitor and control functionality can be as limited as possible, also. Permissions can be customized to the\nindividual clients and users that must be given access.\n\nSCADA vendors can provide the functionality to restrict access and provide a secure communication\npath to the SCADA Web server. The default configuration should have all security features enabled.\n\n**_C-2.2.1.3_** **_Level of Authentication Needed_**\n\nThe Authentication metric measures the number of times an attacker must authenticate before\nexploiting the Web HMI vulnerability. The fewer authentication instances that are required, the higher the\nvulnerability score. The more different passwords and different types of authentication required before\none is able to gain access to a Web HMI, the less likely it will be that an attacker will gain the access\nrequired to exploit the vulnerability.\n\nA vulnerability can be scored as None, Single or Multiple, depending on how many instances of\nauthentication must occur before exploiting a vulnerability. Table C-13 gives example scenarios that fit\neach of the Authentication metric values in an SCADA environment.\n\nTable C-13. Web HMI CVSS v2 Authentication scenarios.\n\n**Metric Value** **Web HMI Authentication Scenarios**\n**Multiple** A user must provide multiple credentials to gain the access required to exploit the Web HMI.\n\n**Single** To exploit the Web HMI, attacker must provide credentials once. For example, credentials are\nrequired to access the Web HMI, but after authenticating, the user can escalate from read-only\naccess and gain unauthorized SCADA control functionality.\n\n**None** Unauthorized access to the Web HMI can be gained without providing credentials. For example,\naccess to the Web HMI is only filtered by IP address. If the attacker is able to spoof an\nauthorized IP address, he can gain access to the Web HMI without providing credentials.\n\nSCADA vendors can make sure that the Web HMI supports secure authentication and it is\nrecommended that they use proven authentication products.\n\nSCADA owners should require a password to log in to the Web HMI that is different from the\npassword required to log onto the client machine. This prevents an attacker from automatically gaining\nWeb HMI access to an SCADA host after compromising an authorized client.\n\n|Col1|possibly untrusted (i.e., access to the Web HMI server is granted to the business LAN). • The attack requires a small amount of social engineering that might occasionally fool cautious users. Many Web vulnerabilities require the victim to perform an action, such as phishing attacks that require the user to click on a link or download a file.|\n|---|---|\n|Low|Specialized access conditions or extenuating circumstances do not exist. The following are examples: • Access to the Web HMI is not filtered. • The vulnerable configuration is default or ubiquitous (i.e., the default Web HMI configuration does not use authentication or encryption, or allows control of the physical process).|\n\n|Metric Value|Web HMI Authentication Scenarios|\n|---|---|\n|Multiple|A user must provide multiple credentials to gain the access required to exploit the Web HMI.|\n|Single|To exploit the Web HMI, attacker must provide credentials once. For example, credentials are required to access the Web HMI, but after authenticating, the user can escalate from read-only access and gain unauthorized SCADA control functionality.|\n|None|Unauthorized access to the Web HMI can be gained without providing credentials. For example, access to the Web HMI is only filtered by IP address. If the attacker is able to spoof an authorized IP address, he can gain access to the Web HMI without providing credentials.|\n\n\n-----\n\n**C-2.2.2** **Impact Metrics**\n\nPotential consequences of SCADA Web application vulnerabilities include user account compromise\nand hijacking of user Web sessions. Exploitation of SCADA Web applications may lead to exposure of\nresources or functionality to unintended actors, possibly providing attackers with sensitive information or\nallowing access to the Web client’s or server’s host.\n\nConfidentiality, integrity and availability impacts depend on the individual vulnerability. The Web\nclient’s host, the Web server, and the Web HMI application are possible targets of attack. Complete\ncompromise of any of these components is possible.\n\n**_C-2.2.2.1_** **_Environmental Security Requirements_**\n\nSecurity Requirements are characteristics of the individual SCADA components. They measure the\npotential for loss of revenue or life due to loss of confidentiality, integrity, or availability of the affected\nSCADA hosts or devices. This may include the Web Server, Database server, and Web HMI client hosts.\n\nSecurity requirements for the Web client’s host and the Web server depend on the supervisory control\nfunctionalities they possess and are responsible for, the data they contain, and the physical process they\nare connected to.\n\nConfidentiality is generally not as important as integrity or availability for an HMI. Integrity of\nSCADA data is generally the highest priority in relation to confidentiality and availability. Availability is\nknown for being the highest priority for an SCADA, but improper integrity of SCADA process or system\ndata can be dangerous.\n\nConfidentiality requirements of Web clients and servers depend on the organization’s confidentiality\nrequirements for the SCADA data processed by the Web HMI.\n\nThe impact on integrity of unauthorized access to the Web HMI depends on the functionality\navailable in the Web HMI. If the Web HMI provides supervisory control functionality, unauthorized\naccess to, or exploitation of, the Web HMI client or server could allow an attacker supervisory control\naccess. Table C-14 gives example scenarios for the Integrity Requirement metric values in an SCADA\nenvironment.\n\nTable C-14. Web HMI CVSS v2 Integrity Requirement scenarios.\n\n**Metric Value** **Web HMI Integrity Requirement Scenarios**\n**Low** Loss of data integrity on the Web HMI is likely to have limited effect on the operation of the\nSCADA or its organization’s business interests. For example, the Web HMI is used for status\ninformation and the process is not affected by data going to and from the Web HMI.\n\n**Medium** Manipulation of data on the SCADA host could have a serious adverse effect on the business or\nsafety. For example, access to a Web HMI could give an attacker the ability to control the\nSCADA.\n\n**High** Depending on the system or process under control and the individual component, Web HMI\nfunctionality could have a catastrophic adverse effect on the business or safety. Alteration of\nsystem data or malicious operation of the physical system may result in economic,\nenvironmental or safety catastrophes.\n\nThe Availability Requirement metric measures the potential for loss of revenue or life due to loss of\navailability of the Web HMI. Table C-15 gives example scenarios for the Availability Requirement metric\nvalues in an SCADA environment.\n\n|Metric Value|Web HMI Integrity Requirement Scenarios|\n|---|---|\n|Low|Loss of data integrity on the Web HMI is likely to have limited effect on the operation of the SCADA or its organization’s business interests. For example, the Web HMI is used for status information and the process is not affected by data going to and from the Web HMI.|\n|Medium|Manipulation of data on the SCADA host could have a serious adverse effect on the business or safety. For example, access to a Web HMI could give an attacker the ability to control the SCADA.|\n|High|Depending on the system or process under control and the individual component, Web HMI functionality could have a catastrophic adverse effect on the business or safety. Alteration of system data or malicious operation of the physical system may result in economic, environmental or safety catastrophes.|\n\n\n-----\n\nTable C-15. Web HMI CVSS v2 Availability Requirement scenarios.\n\n**Metric Value** **Web HMI Availability Requirement Scenarios**\n**Low** Loss of availability of the Web HMI is likely to have limited effect on the operation of the\nSCADA or its organization’s business interests. For example, Web HMI functionality is not\nrequired for SCADA operations.\n\n**Medium** Loss of the Web HMI availability could have a serious adverse effect on the business or safety.\nFor example, monitor and control of the system or process is only available through Web HMI\naccess.\n\n**High** Loss of the Web HMI is likely to have catastrophic adverse effect on the business or safety. For\nexample, SCADA monitor and control capability is only available through the Web HMI and\nloss of this capability could result in catastrophic consequences.\n\n**_C-2.2.2.2_** **_Organization Specific Potential for Loss (Collateral Damage Potential)_**\n\nAll environmental metric values are possible and depend on the SCADA and its vulnerable\ncomponents. SCADA-specific impacts include unauthorized access to the Web HMI, Web server or other\nWeb applications and functionalities. This can possibly lead to unauthorized remote access to graphical\nsupervisory control software, as well as any other functionality built into the Web application or allowed\nto the Web server.\n\n**_C-2.2.2.3_** **_Reducing Potential Impact_**\n\nCollateral damage potential can be reduced by removing functionality from the Web HMI where\ncompromise could lead to unacceptable loss of revenue, safety, or productivity (if possible).\n\nSCADA vendors and owners can lower their actual Confidentiality Impact from unauthorized Web\nHMI access by limiting the information that can be accessed through the Web HMI.\n\nSCADA vendors can lower the Integrity Impact from unauthorized Web HMI access by reducing the\nWeb HMI’s functionality. Web HMI access may have no impact on system integrity if only monitor\nfunctionality is built in.\n\n**C-2.2.3** **Percentage of Vulnerable Systems (Target Distribution)**\n\nThe Target Distribution is the percentage of SCADA components hosting the vulnerable SCADA\nWeb applications or servers. The Web HMI server(s) generally represent a small portion of the SCADA\nenvironment. If the vulnerability is in the Web HMI (client) software, the target distribution depends on\nthe percentage of hosts in the SCADA environment that have the Web HMI software installed. All hosts\nthat have the software installed should be counted.\n\nTarget Distribution can be reduced by removing the Web HMI software from as many systems as\npossible.\n\n**C-2.2.4** **Temporal Metrics**\n\nThese metrics describe elements about the vulnerability that change over time.\n\n|Metric Value|Web HMI Availability Requirement Scenarios|\n|---|---|\n|Low|Loss of availability of the Web HMI is likely to have limited effect on the operation of the SCADA or its organization’s business interests. For example, Web HMI functionality is not required for SCADA operations.|\n|Medium|Loss of the Web HMI availability could have a serious adverse effect on the business or safety. For example, monitor and control of the system or process is only available through Web HMI access.|\n|High|Loss of the Web HMI is likely to have catastrophic adverse effect on the business or safety. For example, SCADA monitor and control capability is only available through the Web HMI and loss of this capability could result in catastrophic consequences.|\n\n\n-----\n\n**_C-2.2.4.1_** **_Availability of Exploit (Exploitability)_**\n\nVendors and owners cannot change the availability of exploits, but they should prioritize the\nmitigation of vulnerabilities that have exploit code or tools published.\n\nEven if there is not a specific exploit developed for a vulnerability in a proprietary SCADA\napplication, common security weaknesses and associated exploit techniques are well known for Web\napplications. The SysAdmin, Audit, Network, Security (SANS) 2009 Top Cyber Security Risks report\nstates: “The most ‘popular’ applications for exploitation tend to change over time since the rationale for\ntargeting a particular application often depends on factors like prevalence or the inability to effectively\npatch. Due to the current trend of converting trusted Web sites into malicious servers, browsers, and\nclient-side applications that can be invoked by browsers seem to be consistently targeted. Automated\ntools, designed to target custom Web application vulnerabilities, make it easy to discover and infect\nseveral thousand Web sites.”[1] Due to improper programming practices, SCADA Web services are\nvulnerable to the most popular attack techniques, such as Structured Query Language (SQL) injection,\nXSS, directory traversal, and authentication bypass. SCADA Web applications are also more exposed to\nattack than most SCADA components, and may provide the capability to alter SCADA data or state.\n\nVendors and owners can conduct in-house and third-party security assessments of their products and\nremediate identified vulnerabilities. Table C-16 shows potential scenarios.\n\nTable C-16. Web HMI vulnerability CVSS v2 Exploitability scenarios.\n\n**Metric Value** **Web HMI Vulnerability Exploitability Scenarios**\n**Unproven** No exploit code is available, or an exploit is entirely theoretical. This should not apply to most\nWeb vulnerabilities.\n\n**Proof-of-** Web attack techniques are well known, even if a particular SCADA’s Web vulnerabilities are\n**Concept** unknown. This applies to most Web vulnerabilities that do not have specific exploit code\n\navailable and cannot be exploited via automated tools.\n\n**Functional** Functional exploit code is available. The code works in most situations where the vulnerability\nexists.\n\n**High** According to the SANS top cybersecurity risks report, if the Web application is vulnerable, there\nare automated tools available to discover and exploit them. “Automated tools, designed to target\ncustom Web application vulnerabilities, make it easy to discover and infect several thousand\nWeb sites.”[1]\n\n**_C-2.2.4.2_** **_Type of Fix Available (Remediation Level)_**\n\nSCADA vendors have the power to remediate vulnerabilities in their own products. Table C-17 shows\npotential scenarios.\n\nTable C-17. Web HMI vulnerability CVSS v2 Remediation Level scenarios.\n\n|Metric Value|Web HMI Vulnerability Exploitability Scenarios|\n|---|---|\n|Unproven|No exploit code is available, or an exploit is entirely theoretical. This should not apply to most Web vulnerabilities.|\n|Proof-of- Concept|Web attack techniques are well known, even if a particular SCADA’s Web vulnerabilities are unknown. This applies to most Web vulnerabilities that do not have specific exploit code available and cannot be exploited via automated tools.|\n|Functional|Functional exploit code is available. The code works in most situations where the vulnerability exists.|\n|High|According to the SANS top cybersecurity risks report, if the Web application is vulnerable, there are automated tools available to discover and exploit them. “Automated tools, designed to target custom Web application vulnerabilities, make it easy to discover and infect several thousand Web sites.”1|\n\n|Metric Value|Web HMI Vulnerability Remediation Level Scenarios|\n|---|---|\n|Official Fix|The SCADA vendor has issued an official patch, or an upgrade is available.|\n|Temporary Fix|The SCADA vendor has issued a temporary hotfix, tool, or workaround.|\n|Workaround|There is an unofficial, non-vendor solution available. For example, SCADA users have created a patch of their own or provided steps to work around or otherwise mitigate the vulnerability.|\n|Unavailable|There is either no solution available or it is impossible to apply.|\n\n\n-----\n\nSCADA applications should use well-known and tested third-party Web servers to serve their Web\napplications. Web applications should be thoroughly tested for malformed input and other vulnerabilities\nthat could lead to a compromise of the SCADA Web server.\n\nIf Web HMI functionality is not intended to provide control of the SCADA, this functionality should\nnot be built into the Web HMI application. This removes the possibility of unauthorized control through\nthe Web HMI.\n\n**_C-2.2.4.3_** **_Level of Verification that Vulnerability Exists (Report Confidence)_**\n\nNSTB assessments have found vulnerabilities in Web HMI server and client applications. These\nvulnerabilities are reported to the SCADA vendors with supporting information to aid in remediation.\nTable C-18 lists potential SCADA Web vulnerability reporting scenarios.\n\nTable C-18. Web HMI vulnerability CVSS v2 Report Confidence scenarios.\n\n**Metric Value** **Web HMI Report Confidence Scenarios**\n**Unconfirmed** Web HMI vulnerabilities may be announced by independent security companies or research\norganizations, but the SCADA vendor has not confirmed the vulnerability and no known\nexploits exist.\n\n**Uncorroborated** Web HMI vulnerabilities may be announced by independent security companies or research\norganizations, but there are conflicting technical details or other lingering ambiguity.\n\n**Confirmed** Known vulnerabilities may exist in the Web server or even in the SCADA vendor’s code. The\nSCADA or Web server vendor has confirmed the vulnerability or exploit code has been\npublished.\n\n**C-2.2.5** **Web HMI Recommendation Summary**\n\nTable C-19 lists specific recommendations for lowering the probability of a Web application or server\nbeing exploited.\n\n|Metric Value|Web HMI Report Confidence Scenarios|\n|---|---|\n|Unconfirmed|Web HMI vulnerabilities may be announced by independent security companies or research organizations, but the SCADA vendor has not confirmed the vulnerability and no known exploits exist.|\n|Uncorroborated|Web HMI vulnerabilities may be announced by independent security companies or research organizations, but there are conflicting technical details or other lingering ambiguity.|\n|Confirmed|Known vulnerabilities may exist in the Web server or even in the SCADA vendor’s code. The SCADA or Web server vendor has confirmed the vulnerability or exploit code has been published.|\n\n\n-----\n\nTable C-19. Lowering risk due to the probability of a Web application or server being exploited.\n\n**Recommendation** **Potential Methods**\nIncrease Access Complexity SCADA vendors and owners can restrict access to SCADA Web servers and\nauthorized clients:\n\n               - SCADA vendors can implement and test proven access control\nmechanisms, making sure to correctly enforce access controls on the\nserver side.\n\n               - SCADA owners can configure Web servers to restrict access to the\nminimum IP range, ports, and users necessary.\nDecrease Target Distribution SCADA owners can minimize the distribution of SCADA Web applications\nand the number of authorized clients.\nIncrease Level of Remediation SCADA vendors can assess Web applications for vulnerabilities and\nremediate the applications using secure Web programming resources such as\nthe Open Web Application Security Project (OWASP).[d]\nSCADA owners can use an application firewall that can detect typical Web\nattacks. Secure hosts and browser settings to the extent possible. They can\nalso educate employees on how to detect and avoid attacks aimed at users,\nsuch as phishing attacks. Users can mitigate some vulnerabilities by using\nHTTPS for the entire Web session.\n\nTable C-20 lists recommendations on lowering the potential impact of a Web application or server\nbeing exploited.\n\nTable C-20. Lowering risk due to the potential impact of Web application or server exploitation.\n\n**Recommendation** **Potential Methods**\nReduce Base Impact Potential impacts can be reduced by minimizing the privileges required to\nrun Web applications and the privileges of Web clients on the Web server.\nSCADA vendors can design and implement Web applications to run using\nthe lowest privileges that are required to accomplish the necessary tasks.\nSCADA owners can configure user accounts and run services and\napplications with the least privileges necessary.\nReduce Environmental Impact SCADA vendors can remove unnecessary functionality from the SCADA\nWeb server and client applications.\nSCADA owners can ensure that unwanted (unnecessary) functionality is not\navailable in SCADA Web applications. Disable unnecessary functionality\nand validate that it cannot be accessed.\n\n**_C-2.2.5.1_** **_SCADA Vendor Recommendations_**\n\nSCADA applications should use well-known and tested third-party Web servers to serve their Web\napplications. Web applications should be thoroughly tested for malformed input and other vulnerabilities\nthat could lead to a compromise of the SCADA Web server.\n\nThe OWASP Top Ten[21] document provides basic techniques for mitigating the highest Web\napplication risks along with additional references. Risk A3, Broken Authentication and Session\n_Management, the Authentication Cheat Sheet and the Transport Layer Protection Cheat Sheet can be_\nreferenced for Web authentication information.[22]\n\nd. http://www.owasp.org/index.php/Main_Page\n\n|Recommendation|Potential Methods|\n|---|---|\n|Increase Access Complexity|SCADA vendors and owners can restrict access to SCADA Web servers and authorized clients: • SCADA vendors can implement and test proven access control mechanisms, making sure to correctly enforce access controls on the server side. • SCADA owners can configure Web servers to restrict access to the minimum IP range, ports, and users necessary.|\n|Decrease Target Distribution|SCADA owners can minimize the distribution of SCADA Web applications and the number of authorized clients.|\n|Increase Level of Remediation|SCADA vendors can assess Web applications for vulnerabilities and remediate the applications using secure Web programming resources such as the Open Web Application Security Project (OWASP).d SCADA owners can use an application firewall that can detect typical Web attacks. Secure hosts and browser settings to the extent possible. They can also educate employees on how to detect and avoid attacks aimed at users, such as phishing attacks. Users can mitigate some vulnerabilities by using HTTPS for the entire Web session.|\n\n|Recommendation|Potential Methods|\n|---|---|\n|Reduce Base Impact|Potential impacts can be reduced by minimizing the privileges required to run Web applications and the privileges of Web clients on the Web server. SCADA vendors can design and implement Web applications to run using the lowest privileges that are required to accomplish the necessary tasks. SCADA owners can configure user accounts and run services and applications with the least privileges necessary.|\n|Reduce Environmental Impact|SCADA vendors can remove unnecessary functionality from the SCADA Web server and client applications. SCADA owners can ensure that unwanted (unnecessary) functionality is not available in SCADA Web applications. Disable unnecessary functionality and validate that it cannot be accessed.|\n\n\n-----\n\nCWE categories, _[CWE-287: Improper Authentication and CWE-442: Web Problems, contain related](http://cwe.mitre.org/data/definitions/287.html)_\nauthentication and Web programming information as well.[9]\n\nThe DHS Recommended Practice Case Study: Cross-Site Scripting suggests the following seven\ndefensive actions:\n\n1. SCADA Internet access policy\n\n2. SCADA user awareness and training\n\n3. Coordination of security efforts between corporate IT network and SCADA network\n\n4. Firewall between the SCADA network and the information technology network\n\n5. Up-to-date patches\n\n6. Web browser and e-mail security\n\n7. Secure code.[23]\n\n**_C-2.2.5.2_** **_SCADA Owner Recommendations_**\n\nSCADA owners should minimize access and available functionality of Web servers and clients. They\nshould validate that the access controls are configured to restrict all unwanted users and SCADA\nfunctionality. Web servers should be placed on a DMZ and use a replicated database on the DMZ as well.\n\n#### C-3. Supervisory Control Access: Use of Vulnerable Remote Display Protocols\n\nRemote display protocols and applications are used to remotely access a machine, providing the\nability to logon and remotely control another machine using the graphical display. Applications and OS\nservices that allow remote display are widely used by SCADA to administer SCADA hosts remotely or\naccess operator screens and other SCADA applications. Remote display protocols used by SCADA have\nbeen found to accept connections from anywhere, transport credentials in clear text, or use a broken\nencryption algorithm. Even if strong encryption is used, if the remote display client’s host is\ncompromised, the attacker may also have access to the remote SCADA host’s display.\n\nThe use of remote display software for remote access to supervisory control functions could be the\nmost significant vulnerability on an SCADA because it allows unauthorized remote access to graphical\nsupervisory control software, as well as any other functionality allowed to the remote user. (Remote\ndisplay vulnerabilities are well known.) Table C-21 summarizes the relevant security attributes of remote\ndisplay protocols and their potential risk to SCADAs.\n\nSee Section 4.3.1.2, “Implement secure remote access ” for more information.\n\nTable C-21. Summary of remote display protocols’ security characteristics.\n\n|Use of Vulnerable Remote Display Protocols|Col2|\n|---|---|\n|Possible Consequences|May allow DoS, code execution, data loss, or security bypass.|\n|SCADA Impact|Unauthorized access to SCADA components: Possible unauthorized remote access to graphical supervisory control software, as well as any other functionality allowed to the remote user.|\n\n\n-----\n\n|Possible Consequences|May allow DoS, code execution, data loss, or security bypass.|\n|---|---|\n|Vulnerable Components|SCADA hosts that allow remote display connections and the applications that the remote users are allowed to access|\n|Ease of Detection|Easy|\n|Attacker Awareness|High|\n|Remediation Cost|Low|\n|SCADA Prevalence|High|\n\n\n#### C-3.1 Generic CVSS v2 Score\n\nFrom an SCADA perspective, exposure depends on how and from where the connection is initiated.\nConnections from within the same local area network (LAN) can only be exploited by someone who has\naccess to that network. Figures C-1 and C-2 illustrate these different scenarios. Figure 1 illustrates the\nscenario where the operator screens are displayed using a remote display protocol from an HMI, or\noperator screen, server on the local SCADA LAN. The exposure for this scenario is the supervisory\ncontrol LAN because an attacker must gain access to this network before the remote display protocol can\nbe exploited.\n\nFigure C-1. Operator screens are remotely displayed from HMI LAN.\n\nFigure C-2 illustrates how remote display connections from outside the SCADA LAN create higher\nexposure to attack. Many sites utilize remote X-servers or other remote display protocols for remote\nsupervisory control access (as well as other remote management capabilities.) This greatly increases the\nexposure of weaknesses in these protocols. It is also necessary to trust the client, which may not be under\nthe site’s management or control. An attacker may be able to gain access to supervisory control\nfunctionality by gaining access to the client host or intercepting the remote display connection. This is\ntrue of the scenario described by Figure C-1, but the attacker does not need to gain access to the SCADA\nLAN in the second scenario in Figure C-2.\n\n\n-----\n\nFigure C-2. Operator screens are remotely displayed from a remote network.\n\nThe Access Complexity is “Low” because no additional access or specialized circumstances need to\nexist for the exploit to be successful.\n\nEach of the Impact metrics is set to “Complete” because remote display access allows remote access\nto graphical supervisory control software, as well as any other functionality allowed to the remote user.\n\nCVSS v2 metrics for the use of remote display protocols on SCADAs are summarized in Table C-22\nusing the most common or critical values seen on SCADA.\n\nTable C-22. Generic CVSS v2 score for the use of remote display protocols on SCADAs.\n\n|Metric|Remote Connection|Same-LAN Connection|\n|---|---|---|\n|Base Metric|Value|Value|\n|Access Vector|Network|Adjacent Network|\n|Access Complexity|Low|Low|\n|Authentication|None|None|\n|Confidentiality Impact|Complete|Complete|\n|Integrity Impact|Complete|Complete|\n|Availability Impact|Complete|Complete|\n|Base Score|10.0|8.3|\n|Temporal Metric|||\n|Exploitability|Functional Exploit Exists|Functional Exploit Exists|\n|Remediation Level|Not Defined|Not Defined|\n|Report Confidence|Confirmed|Confirmed|\n|Temporal Score|9.5|7.9|\n|Environmental Metrics|||\n|Collateral Damage Potential|High|High|\n|Target Distribution|Not Defined|Not Defined|\n|Availability Requirement|High|High|\n|Integrity Requirement|High|High|\n|Confidentiality Requirement|Medium|Medium|\n|Environmental Score|9.8|9.0|\n\n\n-----\n\n|Metric|Remote Connection|Same-LAN Connection|\n|---|---|---|\n|Overall CVSS Score|9.8|9.0|\n|9.8|||\n\n\n**9.8**\n\n\n#### C-3.2 Scoring and Reducing the CVSS Risk Metrics\n\nSCADA vendors and owners cannot change the publicity of vulnerabilities and associated attack\ntechniques. They also may not be able to change the criticality of each system component. They can\nchange the available mitigations as well as the host, network, and SCADA access that can be acquired via\ncompromise of the vulnerability in their environment.\n\n**C-3.2.1** **Base Exploitability Metrics**\n\n**_C-3.2.1.1_** **_Related Exploit Range (Access Vector)_**\n\nIn strict terms, remote display protocols are bound to the network stack, but whether the attacker\nrequires local network access or local access to the client depends on how the server is configured and\nhow it is accessed. SCADA vendors and owners can affect the Access Vector metric by the way they\nconfigure and use remote display protocols. Table C-23 gives example scenarios that fit each of the\nAccess Vector metric values in an SCADA environment.\n\nTable C-23. SCADA remote display vulnerabilities CVSS v2 Access Vector scenarios.\n\n**Metric Value** **Remote Display Access Vector Scenarios**\n**Adjacent** A vulnerability exploitable with adjacent network access requires the attacker to have access to\n**Network** either the broadcast or collision domain of the vulnerable software. In general, MitM attacks\n\nrequire local network access. If remote display protocols are unencrypted or use weak encryption,\nthey are vulnerable to MitM attack by anyone who is able to access the network traffic along its\npath between the SCADA host and the remote display client. If the remote display client and\nserver are on the same local network, an attacker would have to gain access to the SCADA local\nnetwork to be able to intercept it.\n\n**Network** A vulnerability exploitable with network access means the vulnerable software is bound to the\nnetwork stack and the attacker does not require local network access or local access. If the remote\ndisplay protocol server is configured on the SCADA host to allow access to any client, an attacker\ncan connect to it from a remote network. Even if the SCADA host is configured to only allow\nremote display connections to a set of IP addresses, an attacker may be able to spoof an authorized\nIP address and gain access.\n\n**_C-3.2.1.2_** **_Access Complexity_**\n\nThe configuration of the remote display access controls determines the access complexity. The\ndefault configuration or the most common configuration is generally used for scoring a vulnerability, but\nSCADA vendors can apply the criteria to their default configurations and owners can apply the\nappropriate level for how they have configured access to their SCADA displays. Table C-24 gives\nexample scenarios that fit each of the Access Complexity metric values in an SCADA environment.\n\n|Metric Value|Remote Display Access Vector Scenarios|\n|---|---|\n|Adjacent Network|A vulnerability exploitable with adjacent network access requires the attacker to have access to either the broadcast or collision domain of the vulnerable software. In general, MitM attacks require local network access. If remote display protocols are unencrypted or use weak encryption, they are vulnerable to MitM attack by anyone who is able to access the network traffic along its path between the SCADA host and the remote display client. If the remote display client and server are on the same local network, an attacker would have to gain access to the SCADA local network to be able to intercept it.|\n|Network|A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access. If the remote display protocol server is configured on the SCADA host to allow access to any client, an attacker can connect to it from a remote network. Even if the SCADA host is configured to only allow remote display connections to a set of IP addresses, an attacker may be able to spoof an authorized IP address and gain access.|\n\n\n-----\n\nTable C-24. SCADA remote display vulnerabilities CVSS v2 Access Complexity scenarios.\n\n**Metric Value** **Remote Display Access Complexity Scenarios**\n**Medium-** If access to the remote display protocol is filtered, the attacking party is limited to the group of\n**High** systems or users that have been given authorization. This does include, however, an attacker who\n\nis able to spoof or gain access to an authorized system or user account.\n\n**Low** If a remote display protocol is configured to accept connections from anywhere, the access\ncomplexity is low. Once an attacker has gained access to the remote display port on the SCADA\nhost, he can view its display.\nAccess complexity is low if remote display traffic is unencrypted. It is also low if the encryption\nused by the protocol can be broken by script kiddie tools.\n\n**_C-3.2.1.3_** **_Level of Authentication Needed_**\n\nThis metric measures the number of times an attacker must authenticate before they are able to gain\nremote display access to an SCADA server. The fewer authentication instances that are required, the\nhigher the vulnerability score. The more different passwords and different types of authentication required\nbefore one is able to gain access to an SCADA host’s display, the harder it will be for anyone to gain\nunauthorized access.\n\nSCADA vendors can make sure that the remote access functionality that they provide supports secure\nauthentication. They can also be sure that the remote access protocols and encryption protocols integrated\ninto their products are up to date and do not have unpatched vulnerabilities.\n\nSCADA owners can require a password to establish a remote display connection that is different from\nthe password required to log onto the client machine. This prevents an attacker from automatically\ngaining remote display access to an SCADA host after compromising an authorized client. Make sure the\npassword is sent securely and any encryption keys are securely stored.\n\nTable C-25 gives example scenarios that fit each of the Authentication metric values in an SCADA\nenvironment.\n\nTable C-25. SCADA remote display vulnerabilities CVSS v2 Authentication scenarios.\n\n**Metric Value** **Remote Display Authentication Scenarios**\n**Multiple** A user must provide multiple credentials to remotely access an SCADA host’s display. For\nexample, after authenticating as a user on an authorized client, one must then use another\npassword to establish a remote display connection to an SCADA host. Strong host authentication\nis used so that the authorized client cannot be spoofed and the remote display password cannot\nbe sniffed or decrypted. Another password should be required for access to SCADA applications.\n\n**Single** To access an SCADA display remotely, the attacker must be logged into the system. This means\nthat they must provide credentials once.\n\n**None** If remote display protocols are configured to allow access to anyone, or even a set of IPs,\ncredentials are not required to establish a connection.\n\n**C-3.2.2** **Impact Metrics**\n\nPossible consequences from the use of vulnerable remote display protocols include DoS, code\nexecution, data loss, or security bypass. This depends on the privileges granted to the account that was\ngiven remote access.\n\n|Metric Value|Remote Display Access Complexity Scenarios|\n|---|---|\n|Medium- High|If access to the remote display protocol is filtered, the attacking party is limited to the group of systems or users that have been given authorization. This does include, however, an attacker who is able to spoof or gain access to an authorized system or user account.|\n|Low|If a remote display protocol is configured to accept connections from anywhere, the access complexity is low. Once an attacker has gained access to the remote display port on the SCADA host, he can view its display. Access complexity is low if remote display traffic is unencrypted. It is also low if the encryption used by the protocol can be broken by script kiddie tools.|\n\n|Metric Value|Remote Display Authentication Scenarios|\n|---|---|\n|Multiple|A user must provide multiple credentials to remotely access an SCADA host’s display. For example, after authenticating as a user on an authorized client, one must then use another password to establish a remote display connection to an SCADA host. Strong host authentication is used so that the authorized client cannot be spoofed and the remote display password cannot be sniffed or decrypted. Another password should be required for access to SCADA applications.|\n|Single|To access an SCADA display remotely, the attacker must be logged into the system. This means that they must provide credentials once.|\n|None|If remote display protocols are configured to allow access to anyone, or even a set of IPs, credentials are not required to establish a connection.|\n\n\n-----\n\nCompromise of accounts with root-level access can lead to a complete loss of confidentiality,\nintegrity, and availability, while compromise of accounts with user-level access should only lead to a\npartial loss of confidentiality, integrity, and availability.\n\n**_C-3.2.2.1_** **_Environmental Security Requirements_**\n\nSecurity Requirements are characteristics of the individual SCADA components that host the\nvulnerable remote display services. They measure the potential for loss of revenue or life due to loss of\nconfidentiality, integrity, or availability of the SCADA hosts or devices that can be accessed using the\nvulnerable remote display protocol. See Section C-11, “SCADA Environmental Security Requirements,”\nbelow.\n\n**_C-3.2.2.2_** **_Organization Specific Potential for Loss (Collateral Damage Potential)_**\n\nAssessments have found that exploitation of remote display protocols can lead to unauthorized access\nto SCADA components; possible unauthorized remote access to graphical supervisory control software,\nas well as any other functionality allowed to the remote user.\n\nFrom an SCADA perspective, the most severe impact that can result from the use of vulnerable\nremote display protocols is unauthorized supervisory control access. In CVSS terms, this translates to\nprocess integrity and availability.\n\n**_C-3.2.2.3_** **_Reducing Potential Impact_**\n\nCollateral Damage Potential can be reduced by removing remote access capability from systems\nwhere comprise could lead to unacceptable loss of revenue, safety, or productivity (if possible).\n\nSCADA vendors can lower the impact from unauthorized remote display access by reducing the\nprivileges needed to run applications that utilize remote display protocols, such as the HMI.\n\nSCADA owners can lower the impact from unauthorized remote display access by limiting the\nprivileges of accounts that are allowed to be remote accessed. They can also limit the data that resides on\nservers that allow remote access.\n\nSCADA vendors and owners can also limit the functionality and data that resides on servers that\nallow remote access. If remote access is only needed for viewing system status, the remote user should\nnot have privileges to change system information. The safest route is to not build control functionality\ninto applications that are meant only for viewing purposes. This ensures that they cannot be exploited to\ngain control access.\n\nSCADA vendors and owners can lower the Integrity requirement by designing their systems so that\nthey do not rely on data from servers that allow remote access. For example, system data can be\nduplicated (push operation) onto the remote access server. Placing a copy of the system database on a\nDMZ SCADA server used for remote access guarantees that compromise of the database by the remote\nuser does not compromise the integrity of the main system data.\n\n**C-3.2.3** **Percentage of Vulnerable Systems (Target Distribution)**\n\nTarget Distribution is the percentage of SCADA hosts that allow remote display connections. Target\nDistribution can be reduced by removing or securing vulnerable remote access applications and services\non as many systems as possible. SCADA vendors can help by using up to date third-party applications\nthat do not contain published vulnerabilities.\n\n\n-----\n\nSCADA owners can lower the Target Distribution metric by removing remote access capability from\nas many systems as possible.\n\n**C-3.2.4** **Temporal Score Metrics**\n\nThese metrics describe elements about the vulnerability that change over time. SCADA vendors and\nowners cannot change the publicity of vulnerabilities and associated attack techniques. They may have\nthe power to change the available mitigations as well as the host, network, and SCADA access that can be\nacquired via compromise of the vulnerability in their environment.\n\n**_C-3.2.4.1_** **_Availability of Exploit (Exploitability)_**\n\nVendors and owners cannot change the availability of exploits, but they can prioritize the mitigation\nof vulnerabilities that have exploit code or tools published. Vendors and owners can search for\nvulnerabilities and exploits available for the services they support and use. Table C-26 shows the potential\nscenarios.\n\nTable C-26. SCADA remote display vulnerabilities CVSS v2 Exploitability scenarios.\n\n**Metric Value** **Remote Display Exploit Availability Scenarios**\n**Unproven** No exploit code is available, or an exploit is entirely theoretical. Many Secure Shell (SSH)\nvulnerabilities are theoretical or have no exploit code available. If SSH is used to tunnel the\nremote display connection, it could fall into this category. Other encryption solutions or remote\ndisplay protocols may fit as well.\n\n**Proof-of-** Proof-of-concept exploit code or an attack demonstration that is not practical for most systems is\n**Concept** available.\n\n**Functional** Functional exploit code is available. The code works in most situations where the vulnerability\nexists. Graphic User Interface (GUI) MitM tools exist and some have options that target specific\nremote display protocols.\n\n**High** The CVSS definition does not apply to the exploitation of remote display protocols: “Either the\nvulnerability is exploitable by functional mobile autonomous code, or no exploit is required\n(manual trigger) and details are widely available. The code works in every situation, or is\nactively being delivered via a mobile autonomous agent (such as a worm or virus).”\n\n**_C-3.2.4.2_** **_Type of Fix Available (Remediation Level)_**\n\nMitM and access control vulnerabilities can be fixed with access control rules, secure authentication,\nand strong encryption. There are many encryption products that can be used to secure the channel\nbetween the SCADA server and remote client. There is still risk associated with allowing remote access\ndue to the level of trust that is given to the client. Although the channel can be secured using encryption,\nan attacker may be able to gain access by compromising the client.\n\nPossible mitigations include:\n\n- **Risk Remediation: Disable or remove remote display protocols.**\n\n- **Access Vector Risk Reduction:**\n\n   - Only allow connections from hosts that you control and maintain a high level of security.\n\n   - Only allow connections from clients in the same security zone or local network.\n\n- **Access Complexity:**\n\n   - Configure remote display protocol servers to restrict access to minimal set of IPs and users.\n\n|Metric Value|Remote Display Exploit Availability Scenarios|\n|---|---|\n|Unproven|No exploit code is available, or an exploit is entirely theoretical. Many Secure Shell (SSH) vulnerabilities are theoretical or have no exploit code available. If SSH is used to tunnel the remote display connection, it could fall into this category. Other encryption solutions or remote display protocols may fit as well.|\n|Proof-of- Concept|Proof-of-concept exploit code or an attack demonstration that is not practical for most systems is available.|\n|Functional|Functional exploit code is available. The code works in most situations where the vulnerability exists. Graphic User Interface (GUI) MitM tools exist and some have options that target specific remote display protocols.|\n|High|The CVSS definition does not apply to the exploitation of remote display protocols: “Either the vulnerability is exploitable by functional mobile autonomous code, or no exploit is required (manual trigger) and details are widely available. The code works in every situation, or is actively being delivered via a mobile autonomous agent (such as a worm or virus).”|\n\n\n-----\n\n   - Place a server in a DMZ and duplicate applications for remote access or to proxy access to\nSCADA hosts.\n\n   - Encrypt remote display traffic using strong encryption (e.g., SSH tunnel or IPSec).\n\n- **Authentication:**\n\n   - Require a password to establish a remote display connection that is different from the password\nrequired to log onto the client machine. This prevents an attacker from automatically gaining\nremote display access to an SCADA host after compromising an authorized client. Make sure the\npassword is sent securely and any encryption keys are securely stored.\n\n- **Impact Reduction:**\n\n   - Allow the least privileges necessary to remote access accounts.\n\n   - Install the least functionality necessary on remote access servers.\n\n**_C-3.2.4.3_** **_Level of Verification that Vulnerability Exists (Report Confidence)_**\n\nRemote access protocols are widely used and vulnerabilities are well known. Vendors and owners can\nsearch for vulnerabilities associated with the protocols they use and alternative products.\n\n**C-3.2.5** **Remote Access Recommendation Summary**\n\nVendors can apply remote access recommendations to default configurations. Owners can apply them\nto their systems.\n\nTable C-27 lists specific recommendations for lowering the probability of a remote display service or\nconnection being exploited (aka exploitability).\n\nTable C-27. Lowering risk due to the probability of a remote display protocol being exploited.\n\n**Recommendation** **Potential Methods**\nIncrease Access Complexity SCADA vendors and owners can restrict access to remote display services.\nDecrease Target Distribution SCADA vendors and owners can uninstall or disable remote display services\non SCADA hosts that do not require remote access\nIncrease Level of Remediation SCADA vendors can design HMI clients to securely connect to HMI\nservers; support and recommend secure remote access options; and provide\nsecure configuration documentation that includes required services for each\nSCADA host, application, or device along with required communication\npartners.\nSCADA owners can tunnel required insecure connections using secure shell,\nVPN technology, or other encryption products. Restrict access and validate\nthe security of authorized remote access clients.\n\nTable C-28 lists recommendations on lowering the potential impact of a remote display service or\nconnection being exploited.\n\nTable C-28. Lowering risk due to the potential impact of remote display protocol exploitation.\n\n|Recommendation|Potential Methods|\n|---|---|\n|Increase Access Complexity|SCADA vendors and owners can restrict access to remote display services.|\n|Decrease Target Distribution|SCADA vendors and owners can uninstall or disable remote display services on SCADA hosts that do not require remote access|\n|Increase Level of Remediation|SCADA vendors can design HMI clients to securely connect to HMI servers; support and recommend secure remote access options; and provide secure configuration documentation that includes required services for each SCADA host, application, or device along with required communication partners. SCADA owners can tunnel required insecure connections using secure shell, VPN technology, or other encryption products. Restrict access and validate the security of authorized remote access clients.|\n\n|Recommendation|Potential Methods|\n|---|---|\n|Reduce Base Impact|SCADA vendors and owners can minimize the privileges of users that are allowed to remotely access SCADA hosts.|\n\n\n-----\n\n**Recommendation** **Potential Methods**\nReduce Environmental Impact SCADA vendors and owners can remove unnecessary data and functionality\nfrom SCADA hosts that allow remote access. They can add a DMZ host to\nproxy remote requests or provide SCADA status.\n\n**_C-3.2.5.1_** **_SCADA Vendor Recommendations_**\n\nAccess Vector, Access Complexity, and Authentication are affected by the way the remote access\nprotocols are configured and utilized. SCADA vendors can reduce this score for their systems by\nproviding secure options for remotely accessing the HMI and providing secure default configurations.\nSecure configurations include access restrictions and secure authentication.\n\nConfidentiality, Integrity, and Availability impact depends on the permissions of the users allowed to\nremotely connect. SCADA vendors can reduce these metrics by reducing the permissions required to run\nSCADA applications.\n\n**_C-3.2.5.2_** **_SCADA Owner Recommendations_**\n\nSCADA owners can reduce the risk from vulnerable remote access protocols by configuring remote\naccess protocols on SCADA hosts to limit access, require secure authentication, and use a trusted path.\nWhen configuring SCADA hosts for remote access, administrators and integrators must configure the\nhost to validate the security of the remote access client to protect against unauthorized access through a\ntrusted compromised client host.\n\nAccess Vector, Access Complexity, and Authentication scores can be lowered by minimizing remote\naccess and requiring that they be accessed through secure channels. The level of authentication needed\ncan reduce risk by requiring single or multi-factor authentication.\n\nConfidentiality, Integrity, and Availability impact depends on the permissions of the users allowed to\nremotely connect. Owners can reduce these metrics by limiting the permissions of the accounts that are\nallowed to connect.\n\n#### C-4. Access to SCADA Functionality: Improper Access Control (Authorization)\n\nAccess control mechanisms determine which network, host, and SCADA resources and services can\nbe accessed, by whom, and under what conditions. The impact of a compromised account, application, or\nhost depends on the privileges it has been granted.\n\nOnce an attacker has gained access to a host, compartmentalization and access controls can contain\nthem. By default, some SCADA installations start services as the root user and root group. Many services\nmay not need to be started with this privilege level, and doing so exposes system resources to preventable\nrisks. By restricting necessary privileges during SCADA design and implementation, the window of\nexposure and criticality of impact is significantly reduced in the event that a flaw is found in that service.\n\nServices are restricted to the user rights granted through the user account associated with them.\nExploitation of any service could allow an attacker a foothold on the SCADA network with the exploited\nservice’s permissions. Privilege escalation can be accomplished by exploiting a vulnerable service\nrunning with more privileges than the attacker has currently obtained. If successfully exploited, services\nrunning as a privileged user would allow full access to the exploited host.\n\nUnnecessary functionality in SCADA protocols, services, and applications may increase the impact\nfrom compromise as well.\n\n|Recommendation|Potential Methods|\n|---|---|\n|Reduce Environmental Impact|SCADA vendors and owners can remove unnecessary data and functionality from SCADA hosts that allow remote access. They can add a DMZ host to proxy remote requests or provide SCADA status.|\n\n\n-----\n\nThis is a significant vulnerability because it allows unauthorized access to SCADA networks, hosts,\nand functionality. Table C-29 summarizes the security relevant attributes of improper access control.\n\nTable C-29. Summary of Improper Access Control security characteristics.\n\n**Improper Access Control**\n**Possible Consequences** Security bypass: including information leaks, DoS, and arbitrary code execution\n**SCADA Impact** Unauthorized access to SCADA functionality\n**Vulnerable Components** SCADA networks, hosts and functionality\n**Ease of Detection** Moderate\n**Attacker Awareness** High\n**Remediation Cost** Low to Medium\n**Attack Frequency** Often\n**Weakness Prevalence** High\n**SCADA Prevalence** Widespread\n\n#### C-4.1 Generic CVSS v2 Score\n\nMany SCADA services are allowed unnecessary privileges. Assuming that some access was\nintentionally granted, “Authentication” is the number of credentials that were required. The worst-case\noption is “None.”\n\nThe Access Complexity is “Low” because no additional access or specialized circumstances need to\nexist for the exploit to be successful.\n\nEach of the Impact metrics is set to “Complete.” The actual impact depends on the application.\n\nCVSS v2 metrics for least user privileges violations on SCADAs are summarized in Table C-30 using\nthe most common or critical values seen on SCADA. See Section 4.6, “Authorization,” for additional\ninformation.\n\nTable C-30. Generic CVSS v2 score for least user privileges violations.\n\n|Improper Access Control|Col2|\n|---|---|\n|Possible Consequences|Security bypass: including information leaks, DoS, and arbitrary code execution|\n|SCADA Impact|Unauthorized access to SCADA functionality|\n|Vulnerable Components|SCADA networks, hosts and functionality|\n|Ease of Detection|Moderate|\n|Attacker Awareness|High|\n|Remediation Cost|Low to Medium|\n|Attack Frequency|Often|\n|Weakness Prevalence|High|\n|SCADA Prevalence|Widespread|\n\n|Metric|Value|\n|---|---|\n|Base Metric||\n|Access Vector|Network|\n|Access Complexity|Low|\n|Authentication|None|\n|Confidentiality Impact|Complete|\n|Integrity Impact|Complete|\n|Availability Impact|Complete|\n|Base Score|10.0|\n|Temporal Metric||\n|Exploitability|Proof-of-Concept|\n|Remediation Level|Not Defined|\n|Report Confidence|Confirmed|\n|Temporal Score|9.0|\n\n\n-----\n\n|Metric|Value|\n|---|---|\n|Environmental Metrics||\n|Collateral Damage Potential|High|\n|Target Distribution|Not Defined|\n|Availability Requirement|High|\n|Integrity Requirement|High|\n|Confidentiality Requirement|Medium|\n|Environmental Score|9.5|\n|Overall CVSS Score|9.5|\n|9.5||\n\n\n**9.5**\n\n\n#### C-4.2 Scoring and Reducing the CVSS Risk Metrics\n\nAccess controls are security mechanisms used to limit access to SCADA components. SCADA\nvendors build functionality into their applications and services. These applications and services must be\ngranted permission to perform the functions and access the files necessary. If SCADA vendors design\ntheir systems to execute programs with unnecessary privileges, SCADA users may require unnecessary\nprivileges.\n\nSCADA vendors can reduce the probability and impact of compromise by removing unnecessary\nfunctionality from SCADA services and applications, and minimizing the system privileges they require.\n\nSCADA owners can reduce the probability and impact of compromise by installing and running only\nthe necessary services and applications, and creating user accounts with the least privileges necessary to\nperform their functions.\n\n**C-4.2.1** **Base Exploitability Metrics**\n\n**_C-4.2.1.1_** **_Related Exploit Range (Access Vector)_**\n\nThe access vector for exploiting SCADA access control vulnerabilities depends on how the\nvulnerable access control mechanism is designed. Access control mechanisms built for users logged into\nthe associated host fit under the “Local” category. Access control mechanisms built to allow access over\nthe network can either be vulnerable to attackers that have gained access to the local network “Adjacent\nNetwork,” or remote attackers “Network” depending on how they are implemented.\n\nTable C-31 gives example scenarios that fit each of the Access Vector metric values in an SCADA\nenvironment.\n\nTable C-31. Improper SCADA access control CVSS v2 Access Vector scenarios.\n\n|Metric Value|Improper Access Control: Access Vector Scenarios|\n|---|---|\n|Local|Local access controls apply to the user accounts on a host.|\n|Adjacent Network|Adjacent network access controls apply to permissions that are granted at the local network level, such as local network such as a TCP/IP subnet or a wireless or Bluetooth network.|\n\n\n-----\n\n**Metric Value** **Improper Access Control: Access Vector Scenarios**\n**Network** Improper network access controls apply to firewall and router access control lists that allow\nmore than the necessary IP addresses and ports in and out of the SCADA’s network security\nzones.\n\n**_C-4.2.1.2_** **_Access Complexity_**\n\nAccess Complexity measures the complexity of the attack required to exploit the vulnerability once\nan attacker has gained access to the target system. An access control vulnerability is lower risk if it can\nonly be exploited when specific conditions exist, in rare configurations, or by easily detected social\nengineering methods.\n\nExploitation of authorization requires that the attacker have access to the target, albeit with an\naccount that is less privileged than could be appropriate for the targeted resources. The target must have\nincorrectly configured their access control mechanisms such that sensitive information, which should only\nbe accessible to more trusted users, remains accessible to less trusted users. Table C-32 gives example\nscenarios that fit each of the Access Complexity metric values in an SCADA environment.\n\nSCADA vendors can increase the access complexity by deploying their systems with minimal\nprivileges by default. SCADA owners would have to change the default configuration to grant users\nunnecessary privileges.\n\nSCADA vendors can reduce the attack surface when designing applications by carefully mapping\nroles with data and functionality. Developers can then use role-based access controls to enforce the roles\nat the appropriate boundaries.\n\nTable C-32. Improper SCADA access control CVSS v2 Access Complexity scenarios.\n\n**Metric Value** **Improper Access Control: Access Complexity Scenarios**\n**High** The SCADA default configuration grants minimal privileges and SCADA owners would have to\ngrant users unnecessary privileges.\n\n**Medium** The access conditions are somewhat specialized, for example either:\n\n        - The affected configuration is non-default, and is not commonly configured\n\n        - The access is granted to a limited group of systems or users.\n\n**Low** Specialized access conditions or extenuating circumstances do not exist, for example either:\n\n       - The SCADA design requires overly permissive access controls\n\n       - The SCADA software does not properly constrain access to resources or functionality.\n\n**_C-4.2.1.3_** **_Level of Authentication Needed_**\n\nThis metric measures the number of times an attacker must authenticate before they are given the\nunnecessary access. It is important to note that the Authentication metric is different from Access Vector.\nHere, authentication requirements are considered once the system has already been accessed. Specifically,\nfor locally exploitable vulnerabilities, this metric should only be set to “single” or “multiple” if\nauthentication is needed beyond what is required to log into the system.\n\nTable C-33 gives example scenarios that fit each of the Authentication metric values in an SCADA\nenvironment.\n\n|Metric Value|Improper Access Control: Access Vector Scenarios|\n|---|---|\n|Network|Improper network access controls apply to firewall and router access control lists that allow more than the necessary IP addresses and ports in and out of the SCADA’s network security zones.|\n\n|Metric Value|Improper Access Control: Access Complexity Scenarios|\n|---|---|\n|High|The SCADA default configuration grants minimal privileges and SCADA owners would have to grant users unnecessary privileges.|\n|Medium|The access conditions are somewhat specialized, for example either: • The affected configuration is non-default, and is not commonly configured • The access is granted to a limited group of systems or users.|\n|Low|Specialized access conditions or extenuating circumstances do not exist, for example either: • The SCADA design requires overly permissive access controls • The SCADA software does not properly constrain access to resources or functionality.|\n\n\n-----\n\nTable C-33. Improper SCADA access control CVSS v2 Authentication scenarios.\n\n**Metric Value** **Improper Access Control Authentication Scenarios**\n**Multiple** A user must provide multiple credentials to authenticate to the SCADA application, but\nadditional authorization checks are not made for SCADA functionalities that should not be\navailable to all users.\n\n**Multiple -** A user must provide multiple credentials to authenticate to the SCADA application, but\n**Single** additional authorization checks are not made for SCADA functionalities that should not be\n\navailable to all users.\n\n**None** No credentials are necessary to access the SCADA application.\n\n**C-4.2.2** **Impact Metrics**\n\nAccess control mechanisms determine which network, host, and SCADA resources and services can\nbe accessed, by whom, and under what conditions. The impact of a compromised account, application, or\nhost depends on the privileges it has been granted.\n\nOnce an attacker has gained access to a host, compartmentalization and access controls can contain\nthem. By default, some SCADA installations start services as the root user and root group. Many services\ndo not need to be started with this privilege level, and doing so exposes system resources to preventable\nrisks. By restricting necessary privileges during SCADA design and implementation, the window of\nexposure and criticality of impact may be significantly reduced in the event that a flaw is found in that\nservice.\n\nServices are restricted to the user rights granted through the user account associated with them.\nExploitation of any service could allow an attacker a foothold on the SCADA network with the exploited\nservice’s permissions. Privilege escalation can be accomplished by exploiting a vulnerable service\nrunning with more privileges than the attacker has currently obtained. If successfully exploited, services\nrunning as a privileged user would allow full access to the exploited host.\n\nBase impact metrics measure the impact on confidentiality, integrity, and availability due to granting\nor not restricting unnecessary access to an SCADA network, host, or application. The possible\nconsequences of weak access controls include information leaks.\n\n**_C-4.2.2.1_** **_Environmental Security Requirements_**\n\nSecurity Requirements are characteristics of the individual SCADA components. They measure the\npotential for loss of revenue or life due to loss of confidentiality, integrity, or availability of the SCADA\nhosts or devices that lack sufficient access controls. See Section C-11, “SCADA Environmental Security\nRequirements,” below.\n\n**_C-4.2.2.2_** **_Organization Specific Potential for Loss (Collateral Damage Potential)_**\n\nUnauthorized access to information or functionality provided by SCADA hosts and applications can\nresult is unauthorized supervisory control access. Unnecessary functionality in SCADA protocols,\nservices, and applications increases the impact from compromise as well.\n\n**_C-4.2.2.3_** **_Reducing Potential Impact_**\n\nCollateral damage potential can be reduced by adding access controls to the software, hosts, and\nnetworks where comprise could lead to loss of revenue, safety, or productivity (if possible).\n\n|Metric Value|Improper Access Control Authentication Scenarios|\n|---|---|\n|Multiple|A user must provide multiple credentials to authenticate to the SCADA application, but additional authorization checks are not made for SCADA functionalities that should not be available to all users.|\n|Multiple - Single|A user must provide multiple credentials to authenticate to the SCADA application, but additional authorization checks are not made for SCADA functionalities that should not be available to all users.|\n|None|No credentials are necessary to access the SCADA application.|\n\n\n-----\n\n**C-4.2.3** **Percentage of Vulnerable Systems (Target Distribution)**\n\nTarget Distribution depends on the percentage of hosts the unnecessary access is granted.\n\nSCADA vendors and owners can remove unnecessary applications and users from SCADA hosts\nindividually, and restrict access to SCADA hosts, applications and networks as much as possible.\n\n**C-4.2.4** **Temporal Score Metrics**\n\n**_C-4.2.4.1_** **_Availability of Exploit (Exploitability)_**\n\nExploitability of individual vulnerabilities can range between “Unproven” and “High.” Attack\nmethods are well known, so the exploitability of improper SCADA access control mechanisms is “Proofof-concept.”\n\nAccording to the Common Attack Pattern Enumeration and Classification (CAPEC), CAPEC-1:\n_Accessing Functionality Not Properly Constrained by ACLs requires a low skill or knowledge level. “In_\norder to discover unrestricted resources, the attacker does not need special tools or skills. The attacker\nonly has to observe the resources or access mechanisms invoked as each action is performed and then try\nand access those access mechanisms directly.”[e]\n\n**_C-4.2.4.2_** **_Type of Fix Available (Remediation Level)_**\n\nSome access control weaknesses exist because firewalls, network devices, hosts, applications,\nSCADA devices, etc., were not configured as securely as they could be. They allow access that is not\nrequired for SCADA operation. This can be remediated by removing unnecessary applications and\nindividually restricting the privileges granted to user accounts, applications, and services. Any exceptions\ncreated in the firewall rule set should be as specific as possible, including host, protocol, and port\ninformation. All rules should be concise and well documented.\n\nOther access control weaknesses exist because SCADA owners do not know what access must be\nallowed for SCADA operation. SCADA vendors can remediate this problem by providing documentation\non required services, permissions, and communication channels. For each SCADA component, the\nnecessary services should be documented along with the associated port ranges and which components\nare allowed to initiate a connection to that component. SCADA owners can work with vendors to identify\nsystem access requirements.\n\nSCADA owners can deduce this information themselves, if necessary. Applications can be removed\nand permissions can be lowered on a test or backup system. Network traffic can be monitored for a long\nenough period to be confident all possible scenarios have occurred. Rules can then be created starting\nwith the standard restrictions; working toward a rule set that excludes all unnecessary traffic. Once the\nnecessary traffic has been determined, a safer configuration can then be created that blocks all traffic with\nexceptions for the specific host, protocol, and port combinations that require access in each direction\nthrough the firewall.\n\nA third scenario is that the SCADA design prevents the application of sufficient network and host\naccess controls. For example:\n\n- Some SCADA applications require users to log in with administrative privileges\n\n- Some SCADA services require administrative privileges\n\ne. http://capec.mitre.org/data/definitions/1.html\n\n\n-----\n\n- Some SCADA protocols require large port ranges to be opened\n\n- Some SCADA protocols require access between network security zones.\n\nSCADA vendors can redesign their products using the principle of least privileges, but until an update\nis released the remediation level is “Unavailable.”\n\nSCADA software authorization vulnerabilities are bugs in code written to perform authorization\nchecks by the application. Generally, the SCADA vendor must release a patch to remediate this type of\nvulnerability.\n\nTable C-34 lists possible SCADA access control weakness remediation scenarios.\n\nTable C-34. Improper SCADA access control CVSS v2 Remediation Level scenarios.\n\n**Metric Value** **Improper Access Control Remediation Level Scenarios**\n**Official Fix** There is a patch available that fixes a vulnerability in an application’s access control\nmechanism.\n\n**Temporary Fix** The SCADA vendors document known requirements as they work toward identifying and\nreducing all requirements.\n\n**Workaround** SCADA owners can lock down test system hosts to safely identify necessary applications and\nthe least privileges necessary.\nSCADA owners can monitor their systems and create detailed firewall rules.\n\n**Unavailable** The vendor has not provided a solution and no workaround mitigation can be applied. For\nexample, SCADA design prevents the application of sufficient network and host access\ncontrols.\n\n**_C-4.2.4.3_** **_Level of Verification that Vulnerability Exists (Report Confidence)_**\n\nAll Report Confidence values are possible. SCADA owners can verify the lack of application level\naccess control mechanisms with the SCADA vendor. They can also verify that overly permissive\nnetwork, host, and application access controls on their systems are required for SCADA operation.\n\n**C-4.2.5** **Improper Access Control Recommendation Summary**\n\nAccess controls are the basis of protecting a system from attack. They offer the best protection for\nunknown vulnerabilities in particular. Preventing an attacker from reaching the vulnerability addresses the\nrisk of exploitation. Potential impact is reduced as well if less functionality and network access is\navailable to an attacker who has gained access to an SCADA component. Therefore, the recommended\nsolution for access control weaknesses are mechanisms that allow more control over access privileges and\nthe most restrictive use of these mechanisms.\n\nSCADA vendors can build strong access control mechanisms into their products and provide\ndocumentation that allows customers to remove unnecessary applications and minimize privileges on\ntheir systems.\n\nTable C-35 lists specific recommendations for lowering the probability of unauthorized access to an\nSCADA application. See Section 4.6, “Authorization,” for additional information.\n\n|Metric Value|Improper Access Control Remediation Level Scenarios|\n|---|---|\n|Official Fix|There is a patch available that fixes a vulnerability in an application’s access control mechanism.|\n|Temporary Fix|The SCADA vendors document known requirements as they work toward identifying and reducing all requirements.|\n|Workaround|SCADA owners can lock down test system hosts to safely identify necessary applications and the least privileges necessary. SCADA owners can monitor their systems and create detailed firewall rules.|\n|Unavailable|The vendor has not provided a solution and no workaround mitigation can be applied. For example, SCADA design prevents the application of sufficient network and host access controls.|\n\n\n-----\n\nTable C-35. Lowering risk due to the chance of authorization mechanism exploitation.\n\n**Recommendation** **Potential Methods**\nIncrease Access Complexity SCADA vendors and owners can lock down the SCADA environment as\nmuch as possible:\n\n                 - SCADA vendors can reduce the attack surface when designing\napplications by carefully mapping roles with data and functionality.\nDevelopers can then use role-based access controls to enforce the roles\nat the appropriate boundaries.\n\n                 - SCADA vendors can deploy their systems with minimal privileges by\ndefault.\n\n                 - SCADA owners can restrict access to SCADA hosts and networks.\nThey may be able to configure user accounts in SCADA applications\nand restrict access to network applications to the necessary minimum IP\nrange, ports, and users.\nIncrease Authentication SCADA vendors can implement strong authentication methods to enforce\naccess controls.\nSCADA owners can to enforce access controls by implementing strict\npassword policies in applications, hosts, and devices that support them.\nDecrease Target Distribution SCADA vendors and owners can remove unnecessary applications and users\nfrom SCADA hosts individually, and restrict access to SCADA hosts,\napplications and networks as much as possible.\nIncrease Level of Remediation SCADA vendors can provide more access control capabilities in their\nproducts. They can also provide secure configuration documentation that\nidentifies required applications and services.\nSCADA owners may be able to test and apply access control capabilities\navailable in host and network equipment to control access as much as\npossible and provide defense in depth.\n\nTable C-36 lists recommendations on lowering the potential impact of SCADA access controls being\nexploited.\n\nTable C-36. Lowering risk due to the potential impact of SCADA authorization exploitation.\n\n**Recommendation** **Potential Methods**\nReduce Base Impact Potential impacts can be reduced by minimizing the privileges SCADA\napplications run with and the privileges of SCADA application users.\n\n                 - SCADA vendors can design and implement SCADA applications to run\nusing the lowest privileges that are required to accomplish the necessary\ntasks.\n\n               - SCADA owners can configure user accounts and run services and\napplications with the least privileges necessary.\nReduce Environmental Impact SCADA vendors can compartmentalize critical SCADA functionality so that\nit can only be given to those who need it, when they need it. They can also\nremove unnecessary functionality from SCADA applications.\nSCADA owners may be able to disable unnecessary functionality from\nSCADA applications and only give critical functionality to those who\nrequire it.\n\n|Recommendation|Potential Methods|\n|---|---|\n|Increase Access Complexity|SCADA vendors and owners can lock down the SCADA environment as much as possible: • SCADA vendors can reduce the attack surface when designing applications by carefully mapping roles with data and functionality. Developers can then use role-based access controls to enforce the roles at the appropriate boundaries. • SCADA vendors can deploy their systems with minimal privileges by default. • SCADA owners can restrict access to SCADA hosts and networks. They may be able to configure user accounts in SCADA applications and restrict access to network applications to the necessary minimum IP range, ports, and users.|\n|Increase Authentication|SCADA vendors can implement strong authentication methods to enforce access controls. SCADA owners can to enforce access controls by implementing strict password policies in applications, hosts, and devices that support them.|\n|Decrease Target Distribution|SCADA vendors and owners can remove unnecessary applications and users from SCADA hosts individually, and restrict access to SCADA hosts, applications and networks as much as possible.|\n|Increase Level of Remediation|SCADA vendors can provide more access control capabilities in their products. They can also provide secure configuration documentation that identifies required applications and services. SCADA owners may be able to test and apply access control capabilities available in host and network equipment to control access as much as possible and provide defense in depth.|\n\n|Recommendation|Potential Methods|\n|---|---|\n|Reduce Base Impact|Potential impacts can be reduced by minimizing the privileges SCADA applications run with and the privileges of SCADA application users. • SCADA vendors can design and implement SCADA applications to run using the lowest privileges that are required to accomplish the necessary tasks. • SCADA owners can configure user accounts and run services and applications with the least privileges necessary.|\n|Reduce Environmental Impact|SCADA vendors can compartmentalize critical SCADA functionality so that it can only be given to those who need it, when they need it. They can also remove unnecessary functionality from SCADA applications. SCADA owners may be able to disable unnecessary functionality from SCADA applications and only give critical functionality to those who require it.|\n\n\n-----\n\n**_C-4.2.5.1_** **_SCADA Vendor Recommendations_**\n\nSCADA vendors can increase the security of their products by following the principle of least\nprivileges during design and implementation.\n\nAutomated analysis may detect many or all possible interfaces that do not require authorization, but\nmanual analysis is required to determine the correctness of custom authorization mechanisms and whether\nthe lack of authorization violates business logic. This can be accomplished with penetration testing, threat\nmodeling, and interactive tools that allow the tester to record and modify an active session. SCADA\nvendors can specifically request that security assessments of their products test for authorization\nweaknesses.\n\nComplete documentation and/or automated setup of security features can be provided to allow for\nquicker, easier, and more consistent implementation of SCADA components and security features.\nSecurity features that are obtuse or difficult to configure and implement are typically not used or are used\nincorrectly in the field installations of SCADA. Security features that are inconsistently implemented or\nprovide inconsistent results are considered a risk to reliability and availability of the SCADA in an\noperational environment.\n\n**_C-4.2.5.2_** **_SCADA Owner Recommendations_**\n\nLock down the host environments as much as possible by individually restricting the privileges\ngranted to user accounts, applications, and services. SCADA integrators and administrators can use the\naccess control capabilities built into the host operating systems and network devices to define customized\naccess control lists. Use a “default deny” policy when defining these ACLs. This means that, by default,\naccess is denied and the protection scheme identifies conditions under which access is permitted.\n\nApply the principle of least privilege when assigning access rights to entities in a software system.\nCommunication, user and application permission levels may be restricted to levels that are necessary to\nmaintain function.\n\n#### C-5. Access to SCADA Applications: Improper Authentication\n\nAuthentication is used to enforce access controls. Weak authentication allows access controls to be\nsubverted. SCADA security assessments have shown that access to process data and control functionality\ncan be trivial because authentication is not required, or can be easily circumvented.\n\nMany custom SCADA applications implement authentication improperly, or not at all. A common\nerror is known as client side authentication, where the client application authenticates users locally. Since\nthe information needed to authenticate is stored on the client side, it is easy for a moderately skilled\nhacker to extract that information, or to modify the client to not require authentication.\n\nThis is a significant vulnerability because it allows unauthorized access to SCADA functionality.\nTable C-37 summarizes the security relevant attributes of improper authentication.\n\n\n-----\n\nTable C-37. Summary of improper authentication to SCADA applications security characteristics.\n\n**Improper SCADA Application Authentication**\n**Possible Consequences** Security bypass: including information leaks, DoS, and arbitrary code execution\n**SCADA Impact** Unauthorized access to SCADA functionality\n**Vulnerable Components** SCADA networks, hosts, and functionality\n**Ease of Detection** Moderate\n**Attacker Awareness** High\n**Remediation Cost** Low to Medium\n**Attack Frequency** Often\n**SCADA Prevalence** High\n\n#### C-5.1 Generic CVSS v2 Score\n\nMany SCADA applications are “Network” accessible. Access to other applications requires an\nattacker to be logged into the system (such as at a command line or via a desktop session or Web\ninterface). For these applications, “Authentication” is “Single” or “Multiple.”\n\nThe Access Complexity is “Low” because no additional access or specialized circumstances need to\nexist for the exploit to be successful.\n\nEach of the Impact metrics is set to “Complete.” The actual impact depends on the application. CVSS\nv2 metrics for improper authentication to SCADA applications are summarized in Table C-38 using the\nmost common or critical values seen on SCADA. See Section 4.5, “Authentication vulnerabilities,” for\nadditional information.\n\nTable C-38. Generic CVSS v2 score for improper authentication to SCADA applications.\n\n|Improper SCADA Application Authentication|Col2|\n|---|---|\n|Possible Consequences|Security bypass: including information leaks, DoS, and arbitrary code execution|\n|SCADA Impact|Unauthorized access to SCADA functionality|\n|Vulnerable Components|SCADA networks, hosts, and functionality|\n|Ease of Detection|Moderate|\n|Attacker Awareness|High|\n|Remediation Cost|Low to Medium|\n|Attack Frequency|Often|\n|SCADA Prevalence|High|\n\n|Metric|Value|\n|---|---|\n|Base Metric||\n|Access Vector|Network|\n|Access Complexity|Low|\n|Authentication|None|\n|Confidentiality Impact|Complete|\n|Integrity Impact|Complete|\n|Availability Impact|Complete|\n|Base Score|10.0|\n|Temporal Metric||\n|Exploitability|Proof-of-Concept|\n|Remediation Level|Not Defined|\n|Report Confidence|Not Defined|\n|Temporal Score|9.0|\n|Environmental Metrics||\n|Collateral Damage Potential|High|\n|Target Distribution|Not Defined|\n\n\n-----\n\n|Metric|Value|\n|---|---|\n|Base Metric||\n|Availability Requirement|High|\n|Integrity Requirement|High|\n|Confidentiality Requirement|Medium|\n|Environmental Score|9.5|\n|Overall CVSS Score|9.5|\n|9.5||\n\n\n**9.5**\n\n\n#### C-5.2 Scoring and Reducing the CVSS Risk Metrics\n\nSCADA vendors and owners cannot change the publicity of vulnerabilities and associated attack\ntechniques. They also may not be able to change the criticality of each system component; however, they\ncan change the available mitigations as well as the host, network, and SCADA access that can be acquired\nvia compromise of the vulnerability in their environment.\n\n**C-5.2.1** **Base Exploitability Metrics**\n\n**_C-5.2.1.1_** **_Related Exploit Range (Access Vector)_**\n\nThe access vector for exploiting SCADA authentication vulnerabilities depends on how the\nvulnerable authentication mechanism is designed. Authentication mechanisms built for users logged into\nthe associated host fit under the “Local” category. Authentication mechanisms built to allow access over\nthe network can either be vulnerable to attackers that have gained access to the local network “Adjacent\nNetwork,” or remote attackers “Network,” depending on how they are implemented.\n\nTable C-39 gives example scenarios that fit each of the Access Vector metric values in an SCADA\nenvironment.\n\nTable C-39. Improper SCADA authentication CVSS v2 Access Vector scenarios.\n\n|Metric Value|Improper Authentication Access Vector Scenarios|\n|---|---|\n|Local|An SCADA application’s authentication vulnerability is only exploitable after an attacker has gained local access to the SCADA host. This requires the attacker to have either physical access to the SCADA host it runs on or a local (shell) account. This means that a user cannot login to the SCADA application over the network. For example, the HMI application does not require a password, or does not support complex passwords. If unauthorized personnel (or an attacker over the Internet) is able to login to the operator’s workstation, he can then exploit the authentication vulnerability to gain access to the HMI application.|\n|Adjacent Network|The SCADA application’s authentication vulnerability is only exploitable after an attacker has gained local network access.|\n|Network|The SCADA application’s authentication vulnerability is remotely exploitable over the network. The SCADA application is designed to allow access over the network, but the authentication mechanism is improperly implemented. For example, • the SCADA application authenticates authorized clients by IP address or hostname|\n\n\n-----\n\n(which can be spoofed), or\n\n         - authentication is built into the client component of the SCADA application.\n\n**_C-5.2.1.2_** **_Access Complexity_**\n\nAccess Complexity measures the complexity of the attack required to exploit the vulnerability once\nan attacker has gained access to the target system. An authentication vulnerability is lower risk if it can\nonly be exploited when specific conditions exist, in rare configurations, or by easily detected social\nengineering methods. Table C-40 gives example scenarios that fit each of the Access Complexity metric\nvalues in an SCADA environment.\n\nTable C-40. Improper SCADA authentication CVSS v2 Access Complexity scenarios.\n\n**Metric Value** **Improper Authentication Access Complexity Scenarios**\n**High** The authentication method can only be bypassed when specialized conditions exist, for\nexample the SCADA owner must change the default configuration to an insecure method,\nand this is rarely done in practice.\n\n**Medium** The access conditions are somewhat specialized, for example either:\n\n          - The affected configuration is non-default, and is not commonly configured\n\n          - Client-side authentication is used, but the attacker must obtain a copy of the client\napplication (or knowledge of the server) before it can be exploited.\n\n**Low** Specialized access conditions or extenuating circumstances do not exist, for example either:\n\n         - The weak configuration is default or used by most SCADA customers\n\n         - Password gathering can be performed by well-known methods, such as sniffing plain text\npasswords or replaying hashes off the network.\n\n**_C-5.2.1.3_** **_Level of Authentication Needed_**\n\nThis metric measures the number of times an attacker must authenticate before they are able to\ncircumvent the SCADA application’s authentication. The CVSS scoring guide states, “If the vulnerability\nexists in an authentication scheme itself (e.g., PAM, Kerberos) or an anonymous service (e.g., public FTP\nserver), the metric should be scored as ‘None’ because the attacker can exploit the vulnerability without\nsupplying valid credentials.”[f]\n\n**C-5.2.2** **Impact Metrics**\n\nImproper authentication can allow unauthorized access to information or functionality provided by\nSCADA applications. Authentication vulnerabilities in SCADA applications typically have partial\nconfidentiality, integrity, or availability impacts to the SCADA hosts they are installed on. Vulnerabilities\nthat give root-level access to SCADA hosts or devices should be scored with complete loss of\nconfidentiality, integrity, and availability.\n\n**_C-5.2.2.1_** **_Environmental Security Requirements_**\n\nSecurity Requirements are characteristics of the individual SCADA components that host the\nvulnerable SCADA application. They measure the potential for loss of revenue or life due to loss of\n\nf. http://www.first.org/cvss/cvss-guide.html\n\n|Col1|(which can be spoofed), or • authentication is built into the client component of the SCADA application.|\n|---|---|\n\n|Metric Value|Improper Authentication Access Complexity Scenarios|\n|---|---|\n|High|The authentication method can only be bypassed when specialized conditions exist, for example the SCADA owner must change the default configuration to an insecure method, and this is rarely done in practice.|\n|Medium|The access conditions are somewhat specialized, for example either: • The affected configuration is non-default, and is not commonly configured • Client-side authentication is used, but the attacker must obtain a copy of the client application (or knowledge of the server) before it can be exploited.|\n|Low|Specialized access conditions or extenuating circumstances do not exist, for example either: • The weak configuration is default or used by most SCADA customers • Password gathering can be performed by well-known methods, such as sniffing plain text passwords or replaying hashes off the network.|\n\n\n-----\n\nconfidentiality, integrity, or availability of the SCADA hosts or devices the vulnerable application is\ninstalled on. See Section C-11, “SCADA Environmental Security Requirements,” below.\n\n**_C-5.2.2.2_** **_Organization Specific Potential for Loss (Collateral Damage Potential)_**\n\nImproper authentication can allow unauthorized access to SCADA applications. From an SCADA\nperspective, the most severe impact that can result is unauthorized supervisory control access. In CVSS\nterms, process confidentiality, integrity and availability may be compromised.\n\n**_C-5.2.2.3_** **_Reducing Potential Impact_**\n\nCollateral damage potential can be reduced by removing the vulnerable application from systems\nwhere comprise could lead to unacceptable loss of revenue, safety, or productivity (if possible).\n\n**C-5.2.3** **Percentage of Vulnerable Systems (Target Distribution)**\n\nTarget Distribution is the percentage of hosts in the SCADA environment that have the vulnerable\napplication installed.\n\n**C-5.2.4** **Temporal Score Metrics**\n\n**_C-5.2.4.1_** **_Availability of Exploit (Exploitability)_**\n\nVendors and owners cannot change the availability of exploits, but they can prioritize the mitigation\nof vulnerabilities that have exploit code or tools published. Vendors and owners should have their\nsystems assessed for vulnerabilities. Authentication mechanisms should be evaluated by the assessment\nteams. Table C-41 shows potential authentication exploit scenarios.\n\nTable C-41. Improper SCADA authentication CVSS v2 Exploitability scenarios.\n\n**Metric Value** **Improper Authentication Exploit Availability Scenarios**\n**Unproven** No exploit code is available, or an exploit is entirely theoretical. For example, the code\nwritten to validate identity in the SCADA application can be bypassed, but no exploit code\nhas been published for it.\n\n**Proof-of-** Proof-of-concept exploit code or an attack demonstration that is not practical for most\n**Concept** systems has been released.\n\n**Functional** Functional exploit code is available. The code works in most situations where the\nvulnerability exists. For example, GUI MitM tools exist and can be used to capture\nunprotected transmission of passwords.\n\n**High** No exploit is required. For example, no authentication is implemented or configured.\n\n**_C-5.2.4.2_** **_Type of Fix Available (Remediation Level)_**\n\nThe remediation level depends on whether the vendor has released a patch or if the vulnerability can\nbe mitigated with available security products. Table C-42 shows potential scenarios.\n\n|Metric Value|Improper Authentication Exploit Availability Scenarios|\n|---|---|\n|Unproven|No exploit code is available, or an exploit is entirely theoretical. For example, the code written to validate identity in the SCADA application can be bypassed, but no exploit code has been published for it.|\n|Proof-of- Concept|Proof-of-concept exploit code or an attack demonstration that is not practical for most systems has been released.|\n|Functional|Functional exploit code is available. The code works in most situations where the vulnerability exists. For example, GUI MitM tools exist and can be used to capture unprotected transmission of passwords.|\n|High|No exploit is required. For example, no authentication is implemented or configured.|\n\n\n-----\n\nTable C-42. Improper SCADA authentication CVSS v2 Remediation Level scenarios.\n\n**Metric Value** **Improper Authentication Remediation Level Scenarios**\n**Official Fix** There is a patch available that fixes the vulnerability in the application’s authentication\nmechanism.\n\n**Temporary Fix** The SCADA vendor has released or recommended a temporary mitigation while the official\nfix is being developed.\n\n**Workaround** Potential workaround mitigations include:\n\n          - The SCADA owner is able to use an encryption product to tunnel authentication traffic\nor securely store application credentials.\n\n          - The SCADA owner is able to prevent authentication via the vulnerable method.\n\n**Unavailable** The vendor has not provided a solution and no workaround mitigation can be applied. For\nexample, potential mitigations such as encryption or firewall rules cannot be applied without\nbreaking the system functionality or are not effective when configured for system\nrequirements.\n\n**_C-5.2.4.3_** **_Level of Verification that Vulnerability Exists (Report Confidence)_**\n\nReport confidence is “Unconfirmed” or “Uncorroborated” until the vendor acknowledges the\nvulnerability or exploit code is released. The lack of authentication or ability to create complex passwords\ncan be easily validated by the application owners. Storage and transmission of plain text passwords can be\neasily verified as well.\n\n**C-5.2.5** **Improper Authentication Recommendation Summary**\n\nVendors can audit their applications for strong authentication methods and remediate any weak or\nvulnerable implementations. Owners can securely configure their authentication settings and regularly\naudit their passwords and system settings.\n\nTable C-43 lists specific recommendations for lowering the probability of unauthorized access to an\nSCADA application. See Section 4.5.3, “Recommendations and resources” for additional information.\n\nTable C-43. Lowering risk due to the chance of SCADA authentication mechanism exploitation.\n\n|Metric Value|Improper Authentication Remediation Level Scenarios|\n|---|---|\n|Official Fix|There is a patch available that fixes the vulnerability in the application’s authentication mechanism.|\n|Temporary Fix|The SCADA vendor has released or recommended a temporary mitigation while the official fix is being developed.|\n|Workaround|Potential workaround mitigations include: • The SCADA owner is able to use an encryption product to tunnel authentication traffic or securely store application credentials. • The SCADA owner is able to prevent authentication via the vulnerable method.|\n|Unavailable|The vendor has not provided a solution and no workaround mitigation can be applied. For example, potential mitigations such as encryption or firewall rules cannot be applied without breaking the system functionality or are not effective when configured for system requirements.|\n\n|Recommendation|Potential Methods|\n|---|---|\n|Increase Access Complexity|SCADA vendors and owners can restrict access to SCADA applications: • SCADA vendors can implement and test proven identity proofing mechanisms, making sure to correctly enforce access controls on the server side. • SCADA owners can restrict access to SCADA hosts and networks. They may be able to configure user accounts in SCADA applications and restrict access to network applications to the minimum IP range, ports, and users necessary.|\n|Increase Authentication|SCADA vendors can implement strong authentication methods. SCADA owners can require the use of passwords in applications that support them.|\n|Decrease Target Distribution|SCADA owners can uninstall unnecessary applications from each SCADA host.|\n|Increase Level of Remediation|SCADA vendors can assess authentication mechanisms in SCADA applications and remediate weaknesses.|\n\n\n-----\n\nSCADA owners may be able to change default passwords, enforce strong\npasswords, and securely store credentials.\n\nTable C-44 lists recommendations on lowering the potential impact of SCADA application identity\nproofing being exploited.\n\nTable C-44. Lowering risk due to the potential impact of SCADA authentication exploitation.\n\n**Recommendation** **Potential Methods**\nReduce Base Impact Potential impacts can be reduced by minimizing the privileges SCADA\napplications run with and the privileges of SCADA application users.\n\n                 - SCADA vendors can design and implement SCADA applications to run\nusing the lowest privileges that are required to accomplish the necessary\ntasks.\n\n               - SCADA owners can configure user accounts and run services and\napplications with the least privileges necessary.\nReduce Environmental Impact SCADA vendors can remove unnecessary functionality from SCADA\napplications.\nSCADA owners may be able to disable unnecessary functionality from\nSCADA applications.\n\n**_C-5.2.5.1_** **_SCADA Vendor Recommendations_**\n\nSCADA vendors can reduce this score for their applications by implementing and supporting strong\nauthentication methods. Verify that any security checks that are performed on the client side are\nduplicated on the server side. Avoid implementing custom authentication routines; use authentication\ncapabilities provided by the surrounding framework, operating system, or environment if possible.\nAuthentication vulnerabilities are easier to avoid when using a vetted library or framework. For example,\nconsider using libraries with authentication capabilities such as OpenSSL.\n\n**_C-5.2.5.2_** **_SCADA Owner Recommendations_**\n\nSCADA owners can reduce the risk of unauthorized access to their SCADA applications by utilizing\navailable authentication methods and preventing access to vulnerable methods. For example, owners can\nenforce strong password policies for applications that support them. Owners can configure applications to\nnot allow insecure features and prevent access through host and network firewalls.\n\n#### C-6. SCADA Host Access: Buffer Overflows in SCADA Services\n\nBuffer overflow vulnerabilities are the most common type of input validation weaknesses reported on\nSCADA assessments. Buffer overflows are the result of programmer oversight. Most exploit code allows\nthe attacker to create an interactive session and send commands with the privileges of the program with\nthe buffer overflow. Any software with network parsing code that does not validate input values may be\nvulnerable to buffer overflow or other input validation attacks.\n\nRemote code execution through buffer overflow attacks is a common attack method for gaining\nunauthorized access to hosts. SCADA design requires that certain protocols are allowed through firewalls\nto support external data collection and sharing. These protocols and services should have top priority for\nvulnerability remediation activities. Vulnerabilities in services that are exposed to less-trusted networks\n\n|Col1|SCADA owners may be able to change default passwords, enforce strong passwords, and securely store credentials.|\n|---|---|\n\n|Recommendation|Potential Methods|\n|---|---|\n|Reduce Base Impact|Potential impacts can be reduced by minimizing the privileges SCADA applications run with and the privileges of SCADA application users. • SCADA vendors can design and implement SCADA applications to run using the lowest privileges that are required to accomplish the necessary tasks. • SCADA owners can configure user accounts and run services and applications with the least privileges necessary.|\n|Reduce Environmental Impact|SCADA vendors can remove unnecessary functionality from SCADA applications. SCADA owners may be able to disable unnecessary functionality from SCADA applications.|\n\n\n-----\n\nhave higher consequences because they may provide a path from the lower security zone to the higher\nsecurity zone.\n\nTable C-45 summarizes the security relevant attributes of buffer overflow vulnerabilities and their\npotential risk to SCADAs.\n\nTable C-45. Summary of buffer overflow characteristics.\n\n**Buffer Overflows in SCADA Services**\n\n**Possible Consequences** Compromise of SCADA hosts and applications. May allow DoS, code execution,\ndata loss, or security bypass.\n\n**SCADA Impact** Unauthorized access to SCADA components, many times from a different\nsecurity zone\n\n**Vulnerable Components** Services and other applications that parse or accept parsed network traffic\n\n**Ease of Detection** Easy\n\n**Attacker Awareness** High\n\n**Internet Attack Frequency** High\n\n**Remediation Cost** Low\n\n**Weakness Prevalence** Widespread\n\n**SCADA Prevalence** Widespread\n\n#### C-6.1 Generic CVSS v2 Score\n\nIn general, the server application vulnerabilities are network accessible, or remotely exploitable.\nSCADA protocols generally do not require authentication, therefore the Access Vector is “Network” and\n“Authentication” is “None.”\n\nThe Access Complexity is “Low” because no additional access or specialized circumstances need to\nexist for the exploit to be successful. The CVSS v2 guide states, “This metric measures the complexity of\nthe attack required to exploit the vulnerability once an attacker has gained access to the target system. For\nexample, consider a buffer overflow in an Internet service: once the target system is located, the attacker\ncan launch an exploit at will.”[g]\n\nSuccessful exploitation of buffer overflow vulnerabilities in network applications may allow the\nattacker to execute arbitrary code with the privileges of the exploited application. SCADA network\napplications are often executed with administrative (system) privileges. Each of the Impact metrics is set\nto “Complete” because of the possibility of a complete system compromise.\n\nKnown exploits do not currently exist for SCADA service vulnerabilities, so Exploitability is\n“Unproven.” Some SCADA vendors have released patches for at least some of the vulnerabilities\ndiscovered, so the Remediation Level metric varies between “Unavailable” and “Official-Fix.” Many\nbuffer overflow vulnerabilities may still exist in SCADA network applications, and mitigation techniques\ncan only reduce their exposure. Therefore, the Remediation Level metric for this generic “common”\nvulnerability is scored as “Unavailable” in this report. Report Confidence is scored as “Confirmed”\nbecause all SCADA vendors review and provide feedback before assessment reports are finalized.\n\nSecurity requirements are dependent on the host functionality and the nature of the SCADA. Full\ncompromise of any SCADA host is likely to provide an attacker with access to system data or\nfunctionality. DoS of the vulnerable service or host has potential to cause an adverse effect. Security\n\ng. [http://www.first.org/cvss/cvss-guide.html](http://www.first.org/cvss/cvss-guide.html)\n\n|Buffer Overflows in SCADA Services|Col2|\n|---|---|\n|Possible Consequences|Compromise of SCADA hosts and applications. May allow DoS, code execution, data loss, or security bypass.|\n|SCADA Impact|Unauthorized access to SCADA components, many times from a different security zone|\n|Vulnerable Components|Services and other applications that parse or accept parsed network traffic|\n|Ease of Detection|Easy|\n|Attacker Awareness|High|\n|Internet Attack Frequency|High|\n|Remediation Cost|Low|\n|Weakness Prevalence|Widespread|\n|SCADA Prevalence|Widespread|\n\n\n-----\n\nrequirements are therefore rated as “Medium,” but will range between “Low” and “High” for individual\nsystems and hosts.\n\nA successful compromise of an SCADA host may result in catastrophic physical or property damage\nand loss, or there may be a catastrophic loss of revenue or productivity.\n\nAlmost all hosts in an SCADA environment are running custom SCADA network applications. If\nthey are exploitable, most of the SCADA is at risk.\n\nThe CVSS v2 values for this generic vulnerability are listed in Table C-46.\n\nTable C-46. CVSS v2 score for buffer overflow vulnerabilities in SCADA protocol server applications.\n\n**Remote Code**\n\n**Metric** **Execution Possible** **DoS Impact Only**\n\n**Base Metric** **Value** **Value**\n\nAccess Vector Network Network\n\nAccess Complexity Low Low\n\nAuthentication None None\n\nConfidentiality Impact Complete None\n\nIntegrity Impact Complete None\n\nAvailability Impact Complete Complete\n\n**Base Score** 10 7.8\n\n**Temporal Metric**\n\nExploitability Proof-of-Concept Unproven\n\nRemediation Level Not Defined Not Defined\n\nReport Confidence Not Defined Not Defined\n\n**Temporal Score** 9.0 7.0\n\n**Environmental** **Metrics**\n\nCollateral Damage Potential High High\n\nTarget Distribution Not Defined Not Defined\n\nAvailability Requirement Medium Medium\n\nIntegrity Requirement High High\n\nConfidentiality Requirement Medium Medium\n\n**Environmental Score** 9.5 8.5\n\n**Total Score** **9.5** **8.5**\n\n**9.5**\n\n#### C-6.2 Scoring and Reducing the CVSS Risk Metrics\n\nSCADA vendors and owners cannot change the publicity of vulnerabilities and associated attack\ntechniques. They also may not be able to change the criticality of each system component. They can\n\n|Metric|Remote Code Execution Possible|DoS Impact Only|\n|---|---|---|\n|Base Metric|Value|Value|\n|Access Vector|Network|Network|\n|Access Complexity|Low|Low|\n|Authentication|None|None|\n|Confidentiality Impact|Complete|None|\n|Integrity Impact|Complete|None|\n|Availability Impact|Complete|Complete|\n|Base Score|10|7.8|\n|Temporal Metric|||\n|Exploitability|Proof-of-Concept|Unproven|\n|Remediation Level|Not Defined|Not Defined|\n|Report Confidence|Not Defined|Not Defined|\n|Temporal Score|9.0|7.0|\n|Environmental Metrics|||\n|Collateral Damage Potential|High|High|\n|Target Distribution|Not Defined|Not Defined|\n|Availability Requirement|Medium|Medium|\n|Integrity Requirement|High|High|\n|Confidentiality Requirement|Medium|Medium|\n|Environmental Score|9.5|8.5|\n|Total Score|9.5|8.5|\n|9.5|||\n\n\n**9.5**\n\n\n-----\n\nchange the available mitigations as well as the host permissions that can be acquired via compromise of\nthe SCADA service vulnerabilities in their environment.\n\n**C-6.2.1** **Base Exploitability Metrics**\n\n**_C-6.2.1.1_** **_Related Exploit Range (Access Vector)_**\n\nService vulnerabilities are remotely exploitable; therefore, the Access Vector is “Network.”\n\n**_C-6.2.1.2_** **_Access Complexity_**\n\nThis metric measures the complexity of the attack required to exploit the vulnerability once an\nattacker has gained access to the target system. Access complexity of a buffer overflow in a network\nservice depends on whether additional steps are required after the target system is located before the\nattacker can launch an exploit. Table C-47 gives example scenarios that fit each of the Access Complexity\nmetric values in an SCADA environment.\n\nTable C-47. SCADA service buffer overflow CVSS v2 Access Complexity scenarios.\n\n**Metric Value** **Buffer Overflow Vulnerabilities in SCADA Services Access Complexity Scenarios**\n**Medium** The access conditions are somewhat specialized. SCADA services often employ weak access\ncontrol methods such as IP address or host name which can be easily spoofed.\n\n**Low** Specialized access conditions are not required for some SCADA services. Once an SCADA host\nis located, the attacker can launch an exploit at will.\n\n**_C-6.2.1.3_** **_Level of Authentication Needed_**\n\nAn attacker does not need to authenticate before launching an exploit against an SCADA service.\nMany SCADA vendors and owners are protecting SCADA communications with IPSec encryption. If\nIPSec is configured to only allow connections from authenticated IPSec partners, an attacker would have\nto authenticate to (or compromise) an IPSec partner before launching an exploit against the SCADA\nservice. Table C-48 gives example scenarios that fit each of the Authentication metric values in an\nSCADA environment.\n\nTable C-48. SCADA service buffer overflow CVSS v2 Authentication scenarios.\n\n**Metric Value** **SCADA Service Buffer Overflow Authentication Scenarios**\n**Multiple** A user must provide multiple credentials before launching an exploit against an SCADA service.\nFor example, IPSec is configured to only allow connections from authenticated IPSec partners,\nand two-factor authentication is required to authenticate as a user on all hosts authorized as\nIPSec partners.\n\n**Single** A user must provide credentials before launching an exploit against an SCADA service. For\nexample, IPSec is configured to only allow connections from authenticated IPSec partners, and a\npassword is required to authenticate as a user on all hosts authorized as IPSec partners.\n\n**None** An attacker can send network packets to a target service on an SCADA host. The host will\nprocess the malicious packet without requiring credentials, which is the typical scenario.\n\n|Metric Value|Buffer Overflow Vulnerabilities in SCADA Services Access Complexity Scenarios|\n|---|---|\n|Medium|The access conditions are somewhat specialized. SCADA services often employ weak access control methods such as IP address or host name which can be easily spoofed.|\n|Low|Specialized access conditions are not required for some SCADA services. Once an SCADA host is located, the attacker can launch an exploit at will.|\n\n|Metric Value|SCADA Service Buffer Overflow Authentication Scenarios|\n|---|---|\n|Multiple|A user must provide multiple credentials before launching an exploit against an SCADA service. For example, IPSec is configured to only allow connections from authenticated IPSec partners, and two-factor authentication is required to authenticate as a user on all hosts authorized as IPSec partners.|\n|Single|A user must provide credentials before launching an exploit against an SCADA service. For example, IPSec is configured to only allow connections from authenticated IPSec partners, and a password is required to authenticate as a user on all hosts authorized as IPSec partners.|\n|None|An attacker can send network packets to a target service on an SCADA host. The host will process the malicious packet without requiring credentials, which is the typical scenario.|\n\n\n-----\n\n**C-6.2.2** **Impact Metrics**\n\nSuccessful exploitation of many SCADA service vulnerabilities results in a buffer overflow condition\nallowing the attacker to execute arbitrary code with the privileges the service is running as. Many times,\nSCADA services run with administrative (system) privileges.\n\nThe impact of a buffer overflow exploit is access to the portion of memory used by the operation for\nexecuting programs. Instructions for running the vulnerable service can be altered to include malicious\ncode sent by the attacker. Buffer overflow vulnerabilities are most often used to run services that connect\nback to the attacker or allow the attacker to connect to the host. The attacker gains the privileges of the\nservice that was exploited on the SCADA host. Other vulnerabilities on the host may then be exploited to\nescalate privileges.\n\nEach of the Impact metrics is set to “Complete” for the generic common vulnerability because of the\npossibility of a complete system compromise. If the service is not running with system privileges, the\nimpact values will be lower.\n\n**_C-6.2.2.1_** **_Confidentiality and Integrity Impacts_**\n\nThe Confidentiality and Integrity impacts depend on the read and write privileges given to the\nvulnerable service. Many times, SCADA services are given administrative (system) privileges.\n\nTable C-49 gives example scenarios that fit each of the Confidentiality Impact metric values in an\nSCADA environment. Table C-50 gives these scenarios with respect to the impact on confidentiality.\n\nTable C-49. SCADA service buffer overflow CVSS v2 Confidentiality Impact scenarios.\n\n**Metric Value** **SCADA Service Buffer Overflow Confidentiality Impact Scenarios**\n**None** The buffer overflow can only be exploited to cause the service to crash; remote code cannot be\nexecuted and the attacker is not able to gain access to information on the host. Protections have\nbeen built into many new processors, operating systems, and compilers to help protect against\nbuffer overflow attacks. These protections can prevent code execution aimed at gaining access to\nthe host.\n\n**Partial** The SCADA service is running with limited permissions. Code executed by overflowing the\nbuffer will run with the permissions of the SCADA service. Information available to the SCADA\nservice could be disclosed to the attacker.\n\n**Complete** Vulnerable SCADA services running with root or administrator privileges may be exploited to\ngain full control of the host. The attacker is able to read all of the system’s data (memory, files,\netc.)\n\nTable C-50. SCADA service buffer overflow CVSS v2 Integrity Impact scenarios.\n\n|Metric Value|SCADA Service Buffer Overflow Confidentiality Impact Scenarios|\n|---|---|\n|None|The buffer overflow can only be exploited to cause the service to crash; remote code cannot be executed and the attacker is not able to gain access to information on the host. Protections have been built into many new processors, operating systems, and compilers to help protect against buffer overflow attacks. These protections can prevent code execution aimed at gaining access to the host.|\n|Partial|The SCADA service is running with limited permissions. Code executed by overflowing the buffer will run with the permissions of the SCADA service. Information available to the SCADA service could be disclosed to the attacker.|\n|Complete|Vulnerable SCADA services running with root or administrator privileges may be exploited to gain full control of the host. The attacker is able to read all of the system’s data (memory, files, etc.)|\n\n|Metric Value|SCADA Service Buffer Overflow Integrity Impact Scenarios|\n|---|---|\n|None|The buffer overflow can only be exploited to cause the service to crash; remote code cannot be executed and the attacker is not able to alter information on the host. Protections have been built into many new processors, operating systems, and compilers to help protect against buffer overflow attacks. These protections can prevent code execution aimed at gaining access to the host.|\n|Partial|The SCADA service is running with limited permissions. Code executed by overflowing the buffer will run with the permissions of the SCADA service. Information available to the SCADA service could be disclosed to the attacker.|\n|Complete|Vulnerable SCADA services running with root or administrator privileges may be exploited to|\n\n\n-----\n\ngain full control of the host. The attacker is able to read all of the system's data (memory, files,\netc.)\n\nThe impact to confidentiality and integrity can be eliminated by preventing the ability to overwrite\nmemory and execute the inserted commands. Protections have been built into processors, operating\nsystems, and compilers. Attackers have found methods for circumventing many of these controls, but\nthese protections can increase the difficulty of exploiting vulnerabilities caused by insecure coding\npractices or limit their impact. The potential impacts are configuration dependent. The security of an\nSCADA application will vary depending on the compiler options used when the particular instance was\ncompiled and the hardware and operating system it is installed on.\n\nSCADA vendors should audit their source code for the usage of functions that do not truncate input to\nthe size of the buffer. These unsafe function calls should be replaced with their safe counterparts, which\ntake the buffer size as a parameter to prevent buffer overruns. All code that processes input data should be\nassessed and modified to validate all input data. This includes numeric input data used to determine the\nsize of the input or position in an array. Secure coding resources are widely available and should be used\nand enforced by SCADA vendors. Developers should take advantage of their compilers’ security options\nand resolve all warnings.\n\n**_C-6.2.2.2_** **_Availability Impact_**\n\nBuffer overflow vulnerabilities always have the ability to impact availability. Overflowing a buffer\nresults in overwriting of other program data or instructions. This situation typically leads to a crash of the\nprogram (SCADA service), unless the data fed into the buffer was specially designed to overwrite\nmemory with valid instructions. Typical vulnerability discovery and exploit development methods feed\ninvalid input to a service or application, using a crash as the indicator of vulnerability.\n\nThe final exploit code may not crash the service to reduce the chance of being detected, but a crash is\nstill possible.\n\nNew “safe” C functions have been designed to crash a process when a buffer overflow is attempted.\nThis prevents unauthorized code execution with the assumption that availability is low priority. SCADA\ndevelopers should implement input validation to services that require high availability.\n\nTable C-51 gives example scenarios that fit each of the Availability metric values in an SCADA\nenvironment. The CVSS definition refers to the availability of the information resources on a system.\n\nTable C-51. SCADA service buffer overflow CVSS v2 Availability Impact scenarios.\n\n**Metric Value** **SCADA Service Buffer Overflow Availability Impact Scenarios**\n**Partial** There is reduced performance or interruptions in SCADA service availability.\n**Complete** The service can be rendered unavailable. The attacker is able to crash the service as quickly as it\ncan be restarted. For example, the service may require a reboot to restart or stop restarting after a\nspecified number of crashes.\n\n**_C-6.2.2.3_** **_SCADA Environmental Security Requirements_**\n\nSCADA security requirements measure the importance of the affected component to the SCADA\nproduct or installed system, measured in terms of confidentiality, integrity, and availability. They measure\nthe potential for loss of revenue or life due to loss of confidentiality, integrity, or availability of the\nSCADA hosts or devices that run servers for SCADA protocols.\n\n|Col1|gain full control of the host. The attacker is able to read all of the system's data (memory, files, etc.)|\n|---|---|\n\n|Metric Value|SCADA Service Buffer Overflow Availability Impact Scenarios|\n|---|---|\n|Partial|There is reduced performance or interruptions in SCADA service availability.|\n|Complete|The service can be rendered unavailable. The attacker is able to crash the service as quickly as it can be restarted. For example, the service may require a reboot to restart or stop restarting after a specified number of crashes.|\n\n\n-----\n\nSCADA have higher integrity and availability requirements than confidentiality requirements for\nstatus and command data. See Section C-11, “SCADA Environmental Security Requirements,” below.\n\n**_C-6.2.2.4_** **_Organization Specific Potential for Loss (Collateral Damage Potential)_**\n\nExploitation of buffer overflow vulnerabilities in SCADA services can lead to unauthorized access to\nSCADA components, many times from a different security zone. Buffer overflow vulnerabilities can be\nexploited to crash the SCADA service as well. This can make critical SCADA communications\nunavailable until the services are restarted, which requires a system reboot in some cases. An attacker\nmay also repeatedly crash a service until the attack can be blocked.\n\n**_C-6.2.2.5_** **_Reducing Potential Impact_**\n\nCollateral damage potential can be reduced by reducing the privileges SCADA services run as and the\navailable information and functionality on the hosts on which they run.\n\n**C-6.2.3** **Percentage of Vulnerable Systems (Target Distribution)**\n\nTarget Distribution can be reduced by removing the vulnerable application from as many systems as\npossible. SCADA vendors can re-evaluate the need for SCADA services on each component. SCADA\nowners can make sure that they are only running the services needed for their environment.\n\n**C-6.2.4** **Temporal Score Metrics**\n\nSCADA vendors and owners cannot change the publicity of vulnerabilities and associated attack\ntechniques. They may be able to change the available mitigations as well as the host, network, and\nSCADA access that can be acquired via compromise of the vulnerability in their environment.\n\n**_C-6.2.4.1_** **_Availability of Exploit (Exploitability)_**\n\nVendors and owners cannot change the availability of exploits, but they can prioritize the mitigation\nof vulnerabilities that have exploit code or tools published. Vendors and owners should search for\nvulnerabilities and exploits available for the services they support and use. Table C-52 shows the potential\nscenarios.\n\nKnown exploits specifically for SCADA service buffer overflow vulnerabilities are not currently\navailable. However, buffer overflow exploit techniques are well known.\n\nTable C-52. SCADA service buffer overflow CVSS v2 Exploitability metric value.\n\n**Metric Value** **SCADA Service Buffer Overflow Exploit Availability Scenarios**\n**Proof-of-** Instructions on writing exploit code have been widely available for many years. Fuzzers and\n**Concept** instructions for other detection methods are widely available. Shell code that can be used to gain\n\naccess to the host is available for all processors and can be inserted into code for a specific buffer\noverflow exploit.\n\n**_C-6.2.4.2_** **_Type of Fix Available (Remediation Level)_**\n\nIf the vendor has patched the vulnerability, the Remediation Level is “Official-Fix” and the Report\nConfidence is “Confirmed” for that vulnerability. If security assessments identify buffer overflows in\n\n|Metric Value|SCADA Service Buffer Overflow Exploit Availability Scenarios|\n|---|---|\n|Proof-of- Concept|Instructions on writing exploit code have been widely available for many years. Fuzzers and instructions for other detection methods are widely available. Shell code that can be used to gain access to the host is available for all processors and can be inserted into code for a specific buffer overflow exploit.|\n\n\n-----\n\nSCADA services, the Remediation Level is “Unavailable” until a patch is released. If the assessment was\nordered by an SCADA owner, or announced by another non-official source, a Workaround may be\ndeveloped that prevents the vulnerability from being exploited. Table C-53 shows the potential scenarios.\n\nTable C-53. SCADA service buffer overflow CVSS v2 Remediation Level scenarios.\n\n**Metric Value** **SCADA Service Buffer Overflow Remediation Level Scenarios**\n**Official Fix** There is a patch available from the SCADA vendor.\n**Temporary** There is an official but temporary fix available. Many SCADA vendors have addressed service\n**Fix** vulnerabilities with encryption. Encryption can reduce the exposure to attack, but does not fix\n\nthe vulnerabilities in the protocol server applications.\n**Workaround** Many SCADA users are employing as many defense in depth measures as possible to reduce\ntheir risk of compromise through vulnerabilities in the SCADA products they use. The following\nare examples of workaround mitigations to reduce the probability of SCADA service\nexploitation:\n\n        - Network security zones\n\n        - Limiting access with firewall rules\n\n        - Network traffic monitoring\n\n        - Operating system memory protection features\n\n        - Encryption.\n\n**Unavailable** There is either no solution available or it is impossible to apply.\n\n**_C-6.2.4.3_** **_Level of Verification that Vulnerability Exists (Report Confidence)_**\n\nConfidence is “Unconfirmed” or “Uncorroborated” until the vendor acknowledges the vulnerability\nor exploit code is released. NSTB assessments have identified and reported buffer overflow and other\nvulnerabilities in SCADA services to the responsible vendors. Some buffer overflow vulnerabilities in\nSCADA services have been reported by other security researchers and can be found in public\nvulnerability databases.\n\n**C-6.2.5** **SCADA Services Recommendation Summary**\n\nSCADA design requires that some protocols be allowed through firewalls to support external data\ncollection and sharing. Vulnerabilities in services that are exposed to less-trusted networks have higher\nconsequences because they may provide a path from the lower security zone to the higher security zone.\nRemote code execution through buffer overflow attacks is a common attack method for gaining\nunauthorized access to hosts. These protocols and services should have top priority for vulnerability\nremediation activities.\n\nSection 4.1.1, “Design and implement secure code,” contains additional guidance and references for\navoiding and remediating this type of programming errors. Table C-54 lists specific recommendations for\nlowering the probability of a buffer overflow being exploited.\n\n|Metric Value|SCADA Service Buffer Overflow Remediation Level Scenarios|\n|---|---|\n|Official Fix|There is a patch available from the SCADA vendor.|\n|Temporary Fix|There is an official but temporary fix available. Many SCADA vendors have addressed service vulnerabilities with encryption. Encryption can reduce the exposure to attack, but does not fix the vulnerabilities in the protocol server applications.|\n|Workaround|Many SCADA users are employing as many defense in depth measures as possible to reduce their risk of compromise through vulnerabilities in the SCADA products they use. The following are examples of workaround mitigations to reduce the probability of SCADA service exploitation: • Network security zones • Limiting access with firewall rules • Network traffic monitoring • Operating system memory protection features • Encryption.|\n|Unavailable|There is either no solution available or it is impossible to apply.|\n\n\n-----\n\nTable C-54. Lowering risk due to the probability of a buffer overflow being exploited.\n\n**Recommendation** **Potential Methods**\nIncrease Access Complexity SCADA vendors can document system communication channels to aid\nowners in locking down, restricting access, and monitoring their systems.\nSCADA vendors can provide a list of required services for each SCADA\ncomponent, including:\n\n               - Required or potential communication partners\n\n               - Direction of communication initiation\n\n               - Port ranges\n\n               - Valid message formats.\nSCADA owners can configure host and network firewall and IDS rules to\nfilter SCADA network traffic as much as possible. Owners can monitor their\nown traffic to identify normal traffic patterns and create IDS rules that alert\non atypical traffic (without affecting SCADA operations).\nIncrease Level of Remediation SCADA vendors can assess network code for vulnerabilities and remediate\nthem using basic secure programming principles.\nSCADA vendors and owners can use options built into compilers and\noperating systems for mitigating some types of buffer overflow\nvulnerabilities.\nDecrease Exploitability Compiler and operating system level buffer protection technologies\ngenerally do not remediate the risk, but increase the difficulty of exploit.\n\nTable C-55 lists recommendations on lowering the potential impact of a buffer overflow being\nexploited.\n\nTable C-55. Lowering risk due to the potential impact of buffer overflow exploitation.\n\n**Recommendation** **Potential Methods**\nReduce Base Impact Potential impacts can be reduced by compiler and operating system level\nbuffer protections. Many times these features prevent code execution by\nexiting the application, reducing the potential impact only to DoS\n(availability).\nSCADA vendors can design and implement SCADA services to run using\nthe lowest privileges that are required to accomplish the necessary tasks.\nSCADA owners can validate that SCADA services are running with the least\nprivileges necessary.\nReduce Environmental Impact SCADA vendors can separate functionality, or remove unnecessary\nfunctionality from SCADA services.\nSCADA owners may potentially be able to remove vulnerable services from\ncritical components.\n\n**_C-6.2.5.1_** **_SCADA Vendor Recommendations_**\n\nInput validation should be implemented in all code. Programmers can be trained in secure coding\npractices, and all code should be reviewed and tested for input functions that could be susceptible to\nbuffer overflow attacks. All input should be validated, not just those proven to cause buffer overflows.\nInput should be validated for length, and buffer size should not be determined based on an input value.\nLength validation is especially important in the C and C++ programming languages, which contain string\nand memory function calls that can be used insecurely.\n\n|Recommendation|Potential Methods|\n|---|---|\n|Increase Access Complexity|SCADA vendors can document system communication channels to aid owners in locking down, restricting access, and monitoring their systems. SCADA vendors can provide a list of required services for each SCADA component, including: • Required or potential communication partners • Direction of communication initiation • Port ranges • Valid message formats. SCADA owners can configure host and network firewall and IDS rules to filter SCADA network traffic as much as possible. Owners can monitor their own traffic to identify normal traffic patterns and create IDS rules that alert on atypical traffic (without affecting SCADA operations).|\n|Increase Level of Remediation|SCADA vendors can assess network code for vulnerabilities and remediate them using basic secure programming principles. SCADA vendors and owners can use options built into compilers and operating systems for mitigating some types of buffer overflow vulnerabilities.|\n|Decrease Exploitability|Compiler and operating system level buffer protection technologies generally do not remediate the risk, but increase the difficulty of exploit.|\n\n|Recommendation|Potential Methods|\n|---|---|\n|Reduce Base Impact|Potential impacts can be reduced by compiler and operating system level buffer protections. Many times these features prevent code execution by exiting the application, reducing the potential impact only to DoS (availability). SCADA vendors can design and implement SCADA services to run using the lowest privileges that are required to accomplish the necessary tasks. SCADA owners can validate that SCADA services are running with the least privileges necessary.|\n|Reduce Environmental Impact|SCADA vendors can separate functionality, or remove unnecessary functionality from SCADA services. SCADA owners may potentially be able to remove vulnerable services from critical components.|\n\n\n-----\n\nWhen performing input validation, consider all potentially relevant properties, including length, type\nof input, the full range of acceptable values, missing or extra inputs, syntax, consistency across related\nfields, and conformance to protocol specifications. Programmers should use a whitelist of acceptable\ninputs that strictly conform to specifications and reject any input that does not strictly conform to\nspecifications, or transform it into something that does conform.\n\nEven if values are never input directly by a user, data will not always be correctly formatted, and\nhardware or operating system protections are not always sufficient. Most buffer overflows identified in\nNSTB assessments were in the server applications that process SCADA protocol traffic. In most cases,\nvalues input from network traffic were intercepted and altered in transit. Therefore, network data bounds\nand integrity checking should be implemented.\n\nSCADA vendors need to perform code reviews of all SCADA applications responsible for handling\nnetwork traffic. Network traffic cannot be trusted, so better security and sanity checks need to be\nimplemented to prevent crashes and DoS attacks, even if input validation vulnerabilities cannot be\nexploited for remote access.\n\n**_C-6.2.5.2_** **_SCADA Owner Recommendations_**\n\nSCADA owners can use defense in depth methods to reduce the risk from service vulnerabilities.\n\nSCADA owners can reduce the risk from vulnerable services by limiting access to and monitoring\nthem. They can also monitor vulnerability databases and vendor alerts for identified vulnerabilities in\nsoftware and other components of the installed SCADA. For this type of vulnerability, search for\nvulnerabilities in services installed on the SCADA, such as ICCP, DNP, and vendor-proprietary services.\n\n#### C-7. Supervisory Control Access: SCADA Data and Command Message Manipulation and Injection\n\nSCADA network protocols, including those used to send control commands and status data, can be\naltered, replayed, or spoofed because they lack sufficient access control and integrity checking\nmechanisms. This vulnerability requires minimal skills to intercept or create the network messages. The\nability to intelligently interpret and manipulate process status depends on the level of protocol and process\nreverse engineering performed. SCADA and network programming skills are needed for this attack. The\nSCADA network design and implementation determines the exposure of control protocol vulnerabilities.\nThis vulnerability is exposed to anyone who has gained network access to the supervisory control\nnetwork, or a network that is allowed access to control equipment.\n\nSCADA network protocol vulnerabilities can pose the same risk to the physical system as remote\ndisplay protocols and vulnerable Web HMI applications because it allows supervisory control abilities.\nTable C-56 summarizes the security relevant attributes of SCADA network protocol channel\nvulnerabilities and their potential risks to the SCADA.\n\nTable C-56. Summary of vulnerable SCADA network protocols’ security characteristics.\n\n|SCADA Data and Command Message Manipulation and Injection|Col2|\n|---|---|\n|Possible Consequences|Data exposure, manipulation, or loss|\n||Exposure of resources or functionality to unintended actors, possibly providing attackers with sensitive information or allowing execution of arbitrary code.|\n|SCADA Impact|Unauthorized access to network level supervisory control functionalities|\n\n\n-----\n\n**SCADA Prevalence** Widespread\n\n#### C-7.1 Generic CVSS v2 Score\n\nThese attacks bypass authentication, therefore “Authentication” is “None.”The Access Complexity is\n“Medium”.\n\nMitM attack tools exist, and protocol analyzers are available for some control protocols, so\nExploitability is “proof-of-concept.” Network traffic can be encrypted in some cases, so the Remediation\nLevel metric varies between “Unavailable” and “Temporary-Fix.” The Remediation Level metric for this\ngeneric “common” vulnerability is scored as “Workaround” in this report. Report Confidence is scored as\n“Confirmed” because all SCADA vendors review and provide feedback before assessment reports are\nfinalized.\n\nSecurity requirements are dependent on the protocol functionality and the nature of the SCADA.\nInterception of SCADA protocol traffic provides access to system data or functionality. DoS of the\nprotocol traffic has potential to cause an adverse effect. Therefore, security requirements are rated as\n“Medium,” but will range between “Low” and “High” for individual systems and hosts.\n\nAlmost all hosts in an SCADA environment are communicating using SCADA network protocols. If\nthey are vulnerable to MitM attack or spoofing, the SCADA is at risk. The Environmental metric values\nshould be modified for individual systems.\n\nThe CVSS v2 values for this generic vulnerability are listed in Table C-57. See Section 4.3.2,\n“SCADA data and command message communication protocols,” for more information on this\nvulnerability.\n\n|SCADA Data and Command Message Manipulation and Injection|Col2|\n|---|---|\n|Vulnerable Components|SCADA communication channels, potentially between security zones|\n|Ease of Detection|Medium to High|\n|Attacker Awareness|High|\n|Remediation Cost|High|\n|SCADA Prevalence|Widespread|\n\n\n-----\n\nTable C-57. Generic CVSS v2 score for SCADA protocol vulnerabilities.\n\n**Metric** **Value**\n**Base Metric**\nAccess Vector Network\nAccess Complexity Medium\nAuthentication None\nConfidentiality Impact Complete\nIntegrity Impact Complete\nAvailability Impact Complete\n**Base Score** 9.3\n**Temporal Metric**\nExploitability Proof-of-concept\nRemediation Level Not Defined\nReport Confidence Confirmed\n**Temporal Score** 8.4\n**Environmental** **Metrics**\nCollateral Damage Potential High\nTarget Distribution Not Defined\nAvailability Requirement High\n\nIntegrity Requirement High\n\nConfidentiality Requirement Medium\n\n**Environmental Score** 9.2\n\n**Overall CVSS Score** **9.2**\n\n**9.2**\n\n#### C-7.2 Scoring and Reducing the CVSS Risk Metrics\n\n**C-7.2.1** **Base Exploitability Metrics**\n\n**_C-7.2.1.1_** **_Related Exploit Range (Access Vector)_**\n\nThis vulnerability is exposed to anyone who has gained network access to the supervisory control\nnetwork, or a network that is allowed access to control equipment. In general, MitM attacks require local\nnetwork access, or “Adjacent Network.” Table C-58 gives example scenarios that fit each of the Access\nVector metric values in an SCADA environment.\n\nTable C-58. SCADA protocol traffic manipulation and injection CVSS v2 Access Vector scenarios.\n\n**Metric Value** **SCADA Data and Command Message Manipulation and Injection Access Vector Scenarios**\n**Adjacent** MitM altering of SCADA network traffic requires access to the SCADA network traffic. MitM\n**Network** attacks require access to one of the networks that the traffic passes through.\n\n**Network** Spoofing of SCADA status and command messages can be executed by a remote attacker.\n\n|Metric|Value|\n|---|---|\n|Base Metric||\n|Access Vector|Network|\n|Access Complexity|Medium|\n|Authentication|None|\n|Confidentiality Impact|Complete|\n|Integrity Impact|Complete|\n|Availability Impact|Complete|\n|Base Score|9.3|\n|Temporal Metric||\n|Exploitability|Proof-of-concept|\n|Remediation Level|Not Defined|\n|Report Confidence|Confirmed|\n|Temporal Score|8.4|\n|Environmental Metrics||\n|Collateral Damage Potential|High|\n|Target Distribution|Not Defined|\n|Availability Requirement|High|\n|Integrity Requirement|High|\n|Confidentiality Requirement|Medium|\n|Environmental Score|9.2|\n|Overall CVSS Score|9.2|\n|9.2||\n\n|Metric Value|SCADA Data and Command Message Manipulation and Injection Access Vector Scenarios|\n|---|---|\n|Adjacent Network|MitM altering of SCADA network traffic requires access to the SCADA network traffic. MitM attacks require access to one of the networks that the traffic passes through.|\n|Network|Spoofing of SCADA status and command messages can be executed by a remote attacker.|\n\n\n**9.2**\n\n\n-----\n\n**_C-7.2.1.2_** **_Access Complexity_**\n\nAccess Complexity measures the complexity of the attack required to exploit the vulnerability once\nan attacker has gained access to the target system. The Access Complexity is “Low” because no\nadditional access or specialized circumstances need to exist for the exploit to be successful. SCADA\nprotocols generally do not require strong authentication or integrity checks. Access complexity is\ngenerally rated “Low” for network sniffing attacks. Table C-59 gives example scenarios that fit each of\nthe Access Complexity metric values in an SCADA environment.\n\nTable C-59. SCADA protocol traffic manipulation and injection CVSS v2 Access Complexity.\n\n**Metric Value** **SCADA Data and Command Message Manipulation and Injection Access Vector Scenarios**\n**Medium -** The access conditions are specialized (High) or somewhat specialized (Medium). For example\n**High** either:\n\n        - An SCADA network may only be connected to other networks for short periods of time,\nwhen necessary.\n\n        - The associated service or network traffic is not always available. An attacker must wait for\nthe service to be running to intercept or spoof messages to it.\nInformation gathering is required for intelligently altering or initiating command messages to the\nphysical system. Even if the attacker understands the SCADA protocol, knowledge of the\nphysical system is required to interpret and intelligently set individual values.\n\n**Low** SCADAs are commonly configured to regularly report status data. They are designed for high\navailability and generally accept command messages at any time. Special conditions are not\nnormally required to sniff, alter, or spoof SCADA traffic.\n\n**_C-7.2.1.3_** **_Level of Authentication Needed_**\n\nAn attacker does not need to authenticate before launching an exploit against an SCADA service.\nMany SCADA vendors and owners are protecting SCADA communications with IPSec encryption. If\nIPSec is configured to only allow connections from authenticated IPSec partners, an attacker would have\nto authenticate to (or compromise) an IPSec partner before spoofing the SCADA protocol. Table C-60\ngives example scenarios that fit each of the Authentication metric values in an SCADA environment.\n\nTable C-60. SCADA protocol traffic manipulation and injection CVSS v2 Authentication scenarios.\n\n**Metric Value** **SCADA Data and Command Message Manipulation and Injection Access Vector Scenarios**\n**Multiple** A user must provide multiple credentials before spoofing SCADA messages. For example, IPSec\nis configured to only allow connections from authenticated IPSec partners, and two-factor\nauthentication is required to authenticate as a user on all hosts authorized as IPSec partners.\n\n**Single** A user must provide credentials before spoofing SCADA messages. For example, IPSec is\nconfigured to only allow connections from authenticated IPSec partners, and a password is\nrequired to authenticate as a user on all hosts authorized as IPSec partners. SCADA services\noften employ weak authentication methods such as IP address or host name, which can be easily\nspoofed.\n\n**None** An attacker can intercept/manipulate/spoof network packets to a target service on an SCADA\nhost. The host will process the altered packet without requiring authentication, which is the\ntypical scenario.\n\n|Metric Value|SCADA Data and Command Message Manipulation and Injection Access Vector Scenarios|\n|---|---|\n|Medium - High|The access conditions are specialized (High) or somewhat specialized (Medium). For example either: • An SCADA network may only be connected to other networks for short periods of time, when necessary. • The associated service or network traffic is not always available. An attacker must wait for the service to be running to intercept or spoof messages to it. Information gathering is required for intelligently altering or initiating command messages to the physical system. Even if the attacker understands the SCADA protocol, knowledge of the physical system is required to interpret and intelligently set individual values.|\n|Low|SCADAs are commonly configured to regularly report status data. They are designed for high availability and generally accept command messages at any time. Special conditions are not normally required to sniff, alter, or spoof SCADA traffic.|\n\n|Metric Value|SCADA Data and Command Message Manipulation and Injection Access Vector Scenarios|\n|---|---|\n|Multiple|A user must provide multiple credentials before spoofing SCADA messages. For example, IPSec is configured to only allow connections from authenticated IPSec partners, and two-factor authentication is required to authenticate as a user on all hosts authorized as IPSec partners.|\n|Single|A user must provide credentials before spoofing SCADA messages. For example, IPSec is configured to only allow connections from authenticated IPSec partners, and a password is required to authenticate as a user on all hosts authorized as IPSec partners. SCADA services often employ weak authentication methods such as IP address or host name, which can be easily spoofed.|\n|None|An attacker can intercept/manipulate/spoof network packets to a target service on an SCADA host. The host will process the altered packet without requiring authentication, which is the typical scenario.|\n\n\n-----\n\n**C-7.2.2** **Base Impact Metrics**\n\nMitM attacks allow viewing, altering, and dropping of messages. Table C-61 shows the Impact metric\nvalues for SCADA network protocol channel vulnerabilities.\n\nTable C-61. SCADA protocol traffic manipulation and injection CVSS v2 Impact metric values.\n\n**Metric** **Metric Value** **Rational**\n**Confidentiality** **Partial** Clear-text transmission of SCADA messages allows disclosure of SCADA\ndata.\n\n**Integrity** **Partial** Altering of SCADA messages compromises SCADA data integrity.\n\n**Availability** **Partial** MitM techniques can make SCADA data unavailable.\n\nSCADA security requirements depend on the importance of the affected component to the SCADA\nproduct or installed system. They measure the potential for loss of revenue or life due to loss of\nconfidentiality, integrity, or availability of the SCADA hosts or devices that use vulnerable SCADA\ncommunication protocols. In general, SCADA have higher integrity and availability requirements than\nconfidentiality requirements for status and command data.\n\n**_C-7.2.2.1_** **_Organization Specific Potential for Loss (Collateral Damage Potential)_**\n\nFrom a SCADA perspective, the most severe impact that can result is unauthorized supervisory\ncontrol access. In CVSS terms, process confidentiality, integrity and availability may be compromised.\n\nCollateral damage potential can be reduced by removing these services from systems where\ncompromise could lead to unacceptable loss of revenue, safety, or productivity (if possible).\n\n**C-7.2.3** **Percentage of Vulnerable Systems (Target Distribution)**\n\nTarget Distribution is the percentage of SCADA hosts and devices that use the vulnerable protocol.\n\n**C-7.2.4** **Temporal Score Metrics**\n\n**_C-7.2.4.1_** **_Exploitability and Report Confidence_**\n\nVendors and owners cannot change the availability of exploits. MitM attack tools exist, and protocol\nanalyzers are available for some control protocols, but at least some reverse engineering of the captured\nSCADA traffic is required, so Exploitability is “Proof-of-concept.”\n\nReport Confidence is scored as “Confirmed,” in general, because all SCADA vendors review and\nprovide feedback before assessment reports are finalized. All protocols tested by the INL NSTB\nassessment teams have been vulnerable to manipulation and injection attacks due to improper identity\nproofing and integrity checks, but other SCADA protocols may be scored differently. Note that the\nSCADA protocols are vulnerable to manipulation and injection attacks; however, some SCADA vendors\nand owners have used encryption to mitigate this vulnerability.\n\nTable C-62 shows the Exploit Availability and Report Confidence values for SCADA protocol\nmanipulation and injection vulnerabilities.\n\n|Metric|Metric Value|Rational|\n|---|---|---|\n|Confidentiality|Partial|Clear-text transmission of SCADA messages allows disclosure of SCADA data.|\n|Integrity|Partial|Altering of SCADA messages compromises SCADA data integrity.|\n|Availability|Partial|MitM techniques can make SCADA data unavailable.|\n\n\n-----\n\nTable C-62. SCADA protocol traffic manipulation and injection CVSS v2 Exploitability scenarios.\n\n**Metric** **Metric Value** **Rational**\n**Exploit** **Proof of** At least some reverse engineering of the captured SCADA traffic is required\n**Availability** **Concept** to understand or manipulate SCADA data.\n\n**Level of** **Unconfirmed** SCADA vendors and owners can easily monitor their own network traffic for\n**Verification** **- Confirmed** clear-text messages and test MitM attacks with available tools.\n**that**\n**Vulnerability**\n**Exists**\n\n**_C-7.2.4.2_** **_Type of Fix Available (Remediation Level)_**\n\nSome SCADA vendors and owners have used encryption to mitigate this vulnerability. This is\nclassified as a Workaround or Temporary Fix because it does not fix the SCADA protocol. SCADA\nintegrators and administrators must be able to implement encryption of these protocols on their systems\nwhile maintaining system functionality. SCADA vendors have not been able to implement encryption on\ntest systems sent for assessment. Similar to situations in the real world, encryption was disabled to restore\nfunctionality. SCADA administrators may disable encryption for trouble-shooting purposes and not\nrestore it again. Encryption prevents many trouble shooting and intrusion detection techniques such as\nfrom monitoring traffic. Due to high availability requirements, encryption is not an ideal mitigation, but\nrather a temporary fix. SCADA protocols need to be redesigned for better security and reliability.\n\nTable C-63 shows potential Remediation Level scenarios for SCADA protocols.\n\nTable C-63. SCADA protocol traffic manipulation and injection CVSS v2 Remediation Level.\n\n**Metric Value** **Remediation Level Scenarios**\n**Official Fix** The SCADA protocol is redesigned to incorporate strong authentication and integrity checks\nby default.\n\n**Temporary Fix** The SCADA vendor has released or recommended a temporary mitigation while the protocol\nis being redesigned. For example, the vendor has provided instructions for encrypting SCADA\ntraffic.\n\n**Workaround** SCADA owners have implemented their own mitigation. For example, an SCADA\nadministrator added identity proofing and integrity checks on top of SCADA traffic using a\nthird-party product, such as IPSec. Instructions are shared with other users at users’ group\nmeetings.\n\n**Unavailable** The vendor has not provided a solution and no workaround mitigation can be applied. For\nexample, potential mitigations such as encryption or firewall rules cannot be applied without\nbreaking the system functionality or are not effective when configured for system\nrequirements.\n\n**C-7.2.5** **SCADA Protocol Recommendation Summary**\n\nTable C-64 lists specific recommendations for lowering the probability of SCADA protocols being\nexploited.\n\nTable C-64. Lowering risk of SCADA protocols being exploited.\n\n|Metric|Metric Value|Rational|\n|---|---|---|\n|Exploit Availability|Proof of Concept|At least some reverse engineering of the captured SCADA traffic is required to understand or manipulate SCADA data.|\n|Level of Verification that Vulnerability Exists|Unconfirmed - Confirmed|SCADA vendors and owners can easily monitor their own network traffic for clear-text messages and test MitM attacks with available tools.|\n\n|Metric Value|Remediation Level Scenarios|\n|---|---|\n|Official Fix|The SCADA protocol is redesigned to incorporate strong authentication and integrity checks by default.|\n|Temporary Fix|The SCADA vendor has released or recommended a temporary mitigation while the protocol is being redesigned. For example, the vendor has provided instructions for encrypting SCADA traffic.|\n|Workaround|SCADA owners have implemented their own mitigation. For example, an SCADA administrator added identity proofing and integrity checks on top of SCADA traffic using a third-party product, such as IPSec. Instructions are shared with other users at users’ group meetings.|\n|Unavailable|The vendor has not provided a solution and no workaround mitigation can be applied. For example, potential mitigations such as encryption or firewall rules cannot be applied without breaking the system functionality or are not effective when configured for system requirements.|\n\n|Recommendation|Potential Methods|\n|---|---|\n|Increase Level of|SCADA vendors can redesign SCADA communication protocols to implement strong|\n\n\n-----\n\n|Remediation|authentication and integrity checks. SCADA owners can monitor their network for MitM attacks and unusual messages.|\n|---|---|\n\n\nTable C-65 lists recommendations on lowering the potential impact of SCADA protocols being\nexploited.\n\nTable C-65. Lowering potential impact of SCADA protocol exploitation.\n\n**Recommendation** **Potential Methods**\n\nReduce SCADA vendors can compartmentalize functionality, or remove unnecessary\nEnvironmental functionality from SCADA services.\nImpact\n\n**_C-7.2.5.1_** **_SCADA Vendor Recommendations_**\n\nThe system design needs to implement strong authentication into SCADA communication protocols.\nSecure authentication and data integrity checks should be used to ensure that process commands and\nupdates have not been altered in transit. These security procedures offer protection against spoofing\nattacks, in which false information is sent to the operator’s console to give them an altered view from\nreality. Authentication also protects against unauthorized commands being sent to the SCADA process\ndevices.\n\nPhysical access to the controller should be required for configuration and firmware updates. Ensuring\nthat updates occur in this environment will help prevent possible exploitation over the network.\nAuthentication and data integrity checks should also be used to protect against unauthorized physical\naccess and manipulation of firmware files.\n\nSCADA vendors can change the Remediation Level metric by providing a temporary fix while\ndeveloping a complete solution. Some SCADA vendors recommend using a third-party encryption\nproduct as a temporary fix. In some cases this qualifies as unavailable because it affects system\nfunctionality or is inadequately supported by the vendor.\n\n**_C-7.2.5.2_** **_SCADA Owner Recommendations_**\n\nDefenses that reduce exposure to this vulnerability are network access and content filtering rules. IDS\nmonitoring can detect the attacker’s presence on the network and MitM activities. Administrators can\nconfigure network equipment to prevent MitM attacks, but MitM is not necessary if the attacker has\ngained access to a host that is allowed to send control messages. Even if the control protocol is encrypted,\nthe attacker may still send control messages if he has gained access to the host that encrypts the packet.\n\n#### C-8. Data Historian Access: SQL Injection\n\nA Historian server is used for data archiving and analysis and is typically an integral part of an\nSCADA. It is usually located in a DMZ or on the corporate network. Threats to the historian include\ncompromise of the historian host and data corruption. SCADA historians typically utilize a common SQL\nserver as its backend. The historical data is often made available for viewing via a custom Web interface\nor application.\n\n|Recommendation|Potential Methods|\n|---|---|\n|Reduce Environmental Impact|SCADA vendors can compartmentalize functionality, or remove unnecessary functionality from SCADA services.|\n\n\n-----\n\nThe Historian client applications are high-risk components because they are often accessible from the\ncorporate environment and can provide an attacker with a point of entry into the SCADA network.\nAdditionally, an attacker may gain access to unauthorized information, which in some cases can be used\nto cause economic damage.\n\nHistorian database applications use SQL queries to retrieve information. An SQL injection\nvulnerability is caused when an application incorrectly or inadequately filters user input. If an attacker\ninserts literal escape characters into a database query, they may gain arbitrary read or write access to the\ndatabase. Attackers could alter the logic of SQL queries in security controls (such as authentication) to\nbypass security.\n\nAccording to the 2010 CWE/SANS Top 25 Most Dangerous Programming Errors[10] report, SQL\ninjection is the second-most widespread and critical programming error. Table C-66 summarizes the\nsecurity relevant attributes of SQL injection vulnerabilities and their potential risk to SCADAs.\n\nTable C-66. Summary of SQL injection characteristics.\n\n**SQL Injection**\n\n**Possible Consequences** Data loss: Unauthorized read or write access to the database\nSecurity bypass: DoS of the database service or unauthorized access to the\nassociated host\n\n**SCADA Impact** Historical data exposure, loss, or manipulation\nAttack path into the SCADA network\n\n**Vulnerable Components** Historian and other databases and hosts\nDatabase-backed Web applications\n\n**Ease of Detection** Easy\n\n**Attacker Awareness** High\n\n**Internet Attack Frequency** Often\n\n**Remediation Cost** Low\n\n**Weakness Prevalence** High\n\n**SCADA Prevalence** Common\n\n#### C-8.1 Generic CVSS v2 Score\n\nIf the Historian and other SCADA databases hold sensitive data, loss of confidentiality will have a\nhigh impact. Historian data may also be altered or deleted with a SQL injection attack. This may include\nauthentication and authorization data if it is stored in a database.\n\nA successful compromise of an SCADA database may result in a significant loss of revenue or\nproductivity. CVSS v2 metrics for Data Historian SQL injection are summarized in Table C-67 using the\nmost common or critical values seen on an SCADA. See Section 4.4.2, “Database applications and\nservices,” for general database security recommendations and references.\n\n|SQL Injection|Col2|\n|---|---|\n|Possible Consequences|Data loss: Unauthorized read or write access to the database Security bypass: DoS of the database service or unauthorized access to the associated host|\n|SCADA Impact|Historical data exposure, loss, or manipulation Attack path into the SCADA network|\n|Vulnerable Components|Historian and other databases and hosts Database-backed Web applications|\n|Ease of Detection|Easy|\n|Attacker Awareness|High|\n|Internet Attack Frequency|Often|\n|Remediation Cost|Low|\n|Weakness Prevalence|High|\n|SCADA Prevalence|Common|\n\n\n-----\n\nTable C-67. Generic CVSS v2 score for Data Historian SQL injection.\n\n**Metric** **Value**\n**Base Metric**\nAccess Vector Network\nAccess Complexity Low\nAuthentication None\nConfidentiality Impact Partial\nIntegrity Impact Partial\nAvailability Impact Partial\n**Base Score** 7.5\n**Temporal Metric**\nExploitability Proof-of-Concept\nRemediation Level Not Defined\nReport Confidence Not Defined\n**Temporal Score** 6.8\n**Environmental** **Metrics**\nCollateral Damage Potential Medium-High\nTarget Distribution Not Defined\nAvailability Requirement High\nIntegrity Requirement High\nConfidentiality Requirement Medium\n**Environmental Score** 8.6\n**Overall CVSS Score** **8.6**\n\n**8.6**\n\n#### C-8.2 Scoring and Reducing the CVSS Risk Metrics\n\nSCADA vendors and owners cannot change the publicity of vulnerabilities and associated attack\ntechniques. They also may not be able to change the criticality of each system component. They may be\nable to change the available mitigations as well as the host, network, and SCADA access that can be\nacquired via compromise of the vulnerability in their environment.\n\n**C-8.2.1** **Base Exploitability Metrics**\n\n**_C-8.2.1.1_** **_Related Exploit Range (Access Vector)_**\n\nThe access vector metric reflects how the vulnerable database-backed application is accessed. This\nmeasures the difficulty of the attack vector. Table C-68 gives example scenarios that fit potential SQL\ninjection Access Vector metric values.\n\nTable C-68. SCADA SQL injection CVSS v2 Access Vector scenarios.\n\n**Metric Value** **SQL Injection Access Vector Scenarios**\n**Local** The vulnerable database application requires local access to the database server.\n\n**Network** The vulnerable database application is available over the network.\n\n|Metric|Value|\n|---|---|\n|Base Metric||\n|Access Vector|Network|\n|Access Complexity|Low|\n|Authentication|None|\n|Confidentiality Impact|Partial|\n|Integrity Impact|Partial|\n|Availability Impact|Partial|\n|Base Score|7.5|\n|Temporal Metric||\n|Exploitability|Proof-of-Concept|\n|Remediation Level|Not Defined|\n|Report Confidence|Not Defined|\n|Temporal Score|6.8|\n|Environmental Metrics||\n|Collateral Damage Potential|Medium-High|\n|Target Distribution|Not Defined|\n|Availability Requirement|High|\n|Integrity Requirement|High|\n|Confidentiality Requirement|Medium|\n|Environmental Score|8.6|\n|Overall CVSS Score|8.6|\n|8.6||\n\n|Metric Value|SQL Injection Access Vector Scenarios|\n|---|---|\n|Local|The vulnerable database application requires local access to the database server.|\n|Network|The vulnerable database application is available over the network.|\n\n\n**8.6**\n\n\n-----\n\n**_C-8.2.1.2_** **_Access Complexity_**\n\nAccess complexity depends on the number of systems and users that have access to the vulnerable\ndatabase application. Table C-69 gives example scenarios that fit each of the Access Complexity metric\nvalues in an SCADA environment.\n\nTable C-69. SCADA SQL injection CVSS v2 Access Complexity scenarios.\n\n**Metric Value** **SQL Injection Access Complexity Scenarios**\n**High** The vulnerable database application is only accessible to a few trusted users.\n\n**Medium** The vulnerable database application is only accessible to an authorized group.\n\n**Low** The vulnerable database application is accessible to a wide range of systems and users.\n\n**_C-8.2.1.3_** **_Level of Authentication Needed_**\n\nThis metric measures the number of times an attacker must authenticate after gaining access to the\nsystem defined by the access vector. This metric should be set to the number of times an attacker must\nprovide credentials to a database application before exploitation. All values are possible.\n\n**C-8.2.2** **Impact Metrics**\n\nVulnerabilities that give root-level access should be scored with complete loss of confidentiality,\nintegrity, and availability, while vulnerabilities that give user-level access should be scored with only\npartial loss of confidentiality, integrity, and availability.\n\nSuccessful injection can cause information disclosure as well as the ability to add or modify data in\nthe database. Impact metric values for SQL injection are “Partial” or “Complete,” depending on the\naccess gained by the attacker. When malicious SQL content is executed by the database, it can lead to\narbitrary queries being executed, causing disclosure of information, unauthorized access, privilege\nescalation, and possibly system compromise.\n\n**_C-8.2.2.1_** **_Environmental Security Requirements_**\n\nThese metrics enable SCADA vendors and owners to customize the CVSS score depending on the\nimportance of the affected database server to the SCADA product or installed system, measured in terms\nof confidentiality, integrity, and availability. They measure the potential for loss of revenue or life due to\nloss of confidentiality, integrity, or availability of the affected system.\n\nThe Historian database may have a high integrity requirement. The SCADA real-time database\ntypically has high integrity and availability requirements. Other SCADA databases, such as an operator\ndatabase, may also have high integrity and availability requirements.\n\n**_C-8.2.2.2_** **_Organization Specific Potential for Loss (Collateral Damage Potential)_**\n\nA Historian server is used for data archiving and analysis and is typically an integral part of an\nSCADA. Compromise of the Historian may provide an attacker with a point of entry into the SCADA\nnetwork.\n\nIf the Historian and other SCADA databases hold sensitive data, loss of confidentiality will have a\nhigh impact. Historian data may also be altered or deleted with a SQL injection attack. This may include\nauthentication and authorization data if it is stored in a database.\n\n|Metric Value|SQL Injection Access Complexity Scenarios|\n|---|---|\n|High|The vulnerable database application is only accessible to a few trusted users.|\n|Medium|The vulnerable database application is only accessible to an authorized group.|\n|Low|The vulnerable database application is accessible to a wide range of systems and users.|\n\n\n-----\n\nCollateral damage potential can be reduced by providing a replicated database for business\napplications.\n\n**C-8.2.3** **Percentage of Vulnerable Systems (Target Distribution)**\n\nTarget Distribution is generally low for SQL injection because database servers make up less than\n25% of a typical SCADA environment.\n\n**C-8.2.4** **Temporal Score Metrics**\n\n**_C-8.2.4.1_** **_Availability of Exploit (Exploitability)_**\n\nExploitability of individual vulnerabilities can range between “Unproven” and “High.” Attack\nmethods are well known, so the exploitability of SQL injection vulnerabilities is “Proof-of-concept.”\n\nSQL injection is a standard attack pattern that requires a low skill or knowledge level. “It is fairly\nsimple for someone with basic SQL knowledge to perform SQL injection, in general. In certain instances,\nhowever, specific knowledge of the database employed may be required.”[h]\n\n**_C-8.2.4.2_** **_Type of Fix Available (Remediation Level)_**\n\nSCADA vendors can lower the probability of an SQL injection attack by assessing database backed\napplications and remediating vulnerabilities with strong input validation. Table C-70 shows potential\nscenarios.\n\nTable C-70. SCADA SQL injection CVSS v2 Remediation Level scenarios.\n\n**Metric Value** **Remediation Level Scenarios**\n**Official Fix** A complete vendor solution is available. The SCADA vendor has made a patch available.\n\n**Unavailable** There is either no solution available or it is impossible to apply.\n\n**C-8.2.5** **SQL Injection Recommendation Summary**\n\nTable C-71 lists specific recommendations for lowering the probability of SQL injection.\n\nTable C-71. Lowering risk due to the chance of SQL injection exploitation in SCADA applications.\n\n**Recommendation** **Potential Methods**\nIncrease Access Complexity SCADA vendors and owners can restrict access to SCADA database\napplication.\nIncrease Authentication SCADA vendors can implement strong authentication methods to enforce\naccess controls.\nSCADA owners can to enforce access controls by implementing strict\npassword policies in applications that support them.\nDecrease Target Distribution SCADA vendors and owners can remove database applications SCADA\nhosts that do not require them.\nIncrease Level of Remediation SCADA vendors can validate input to database applications.\n\nh. [http://capec.mitre.org/data/definitions/66.html](http://capec.mitre.org/data/definitions/66.html)\n\n|Metric Value|Remediation Level Scenarios|\n|---|---|\n|Official Fix|A complete vendor solution is available. The SCADA vendor has made a patch available.|\n|Unavailable|There is either no solution available or it is impossible to apply.|\n\n|Recommendation|Potential Methods|\n|---|---|\n|Increase Access Complexity|SCADA vendors and owners can restrict access to SCADA database application.|\n|Increase Authentication|SCADA vendors can implement strong authentication methods to enforce access controls. SCADA owners can to enforce access controls by implementing strict password policies in applications that support them.|\n|Decrease Target Distribution|SCADA vendors and owners can remove database applications SCADA hosts that do not require them.|\n|Increase Level of Remediation|SCADA vendors can validate input to database applications.|\n\n\n-----\n\nTable C-72 lists recommendations on lowering the potential impact of SQL injection being exploited.\n\nTable C-72. Lowering risk due to the potential impact of SQL injection exploitation.\n\n**Recommendation** **Potential Methods**\nReduce Base Impact Developers can decrease the potential impact by following the principle of\nleast privilege.\nReduce Environmental Impact SCADA owners can reduce the potential impact by replicating databases on\na DMZ.\n\n**_C-8.2.5.1_** **_SCADA Vendor Recommendations_**\n\nSCADA vendors can reduce the number of SQL injection vulnerabilities by using vetted libraries or\nframeworks that do not allow them to occur or provide constructs that make this weakness easier to avoid.\nFor example, they can use persistence layers such as Hibernate or Enterprise Java Beans, which can\nprovide significant protection against SQL injection if used properly.\n\nDevelopers should use care when constructing SQL queries, including stored procedures that are\nlocated on the SQL server itself. They should follow Web programming security guidelines to help\nmitigate common mistakes, validate input, and properly encode, escape, and quote output.\n\nDevelopers can decrease the potential impact by following the principle of least privilege. For\nexample, use the strictest permissions possible on all database objects, such as execute-only for stored\nprocedures.\n\n**_C-8.2.5.2_** **_SCADA Owner Recommendations_**\n\nSCADA owners can reduce the potential impact by replicating databases on a DMZ. If an attacker\nfinds and exploits an SQL injection, he will simply own another server in the DMZ rather than jumping\ndirectly into the SCADA network.\n\nAdministrators of SCADAs with Web servers can use an application firewall that can detect common\nWeb attacks. This might not catch all attacks, and it might require some effort for customization.\nHowever, it is a layer of defense that can be used to help reduce the risk of vulnerabilities in Web\napplications that expose the SCADA historian and Web servers to attack from the Web client’s network.\n\n#### C-9. SCADA Host Access: Use of Standard IT Protocols with Clear-text Authentication\n\nInsecure services developed for IT systems have been adopted for use in SCADA for common IT\nfunctionality. Although more secure alternatives exist for most of these services, active unused or\nobsolete services still exist in many SCADAs. Clear-text authentication credentials can be sniffed during\ntransmission and used by an attacker to authenticate to the system. If an attacker is able to capture a\nusername and password, he is able to legitimately log onto the system with that user’s privileges. For this\nreason, plain-text remote login services should be replaced with encrypted services such as SSH.\n\nThe use of insecure protocols and services to connect to the SCADA hosts creates a high-risk access\npath into the system. This is a significant vulnerability because it allows unauthorized remote access to\nSCADA hosts and the functionality allowed to the compromised account. Table C-73 summarizes the\nsecurity relevant attributes of the use of clear-text authentication protocols and their potential risk to\nSCADAs. See Section 4.3.1, “Common IT protocols in SCADA systems,” for more information.\n\n|Recommendation|Potential Methods|\n|---|---|\n|Reduce Base Impact|Developers can decrease the potential impact by following the principle of least privilege.|\n|Reduce Environmental Impact|SCADA owners can reduce the potential impact by replicating databases on a DMZ.|\n\n\n-----\n\nTable C-73. Summary of clear-text authentication protocols’ security characteristics.\n\n**Use of Standard IT Protocols with Clear-text Authentication**\n\n**Possible Consequences** Lack of identity proofing\n\n**SCADA Impact** Unauthorized access to SCADA components: Possible unauthorized remote\naccess to hosts with privileges to any functionality granted to the compromised\nremote user.\n\n**Vulnerable Components** SCADA hosts running clear-text authentication protocol services\n\n**Ease of Detection** Easy\n\n**Attacker Awareness** High\n\n**Remediation Cost** Low\n\n**Weakness Prevalence** High\n\n**SCADA Prevalence** High\n\n#### C-9.1 Generic CVSS v2 Score\n\nCVSS v2 metrics for the use of clear-text authentication protocols on SCADAs are summarized in\nTable C-74 using the most common or critical values seen on SCADA. The actual impact depends on the\nprivileges of the account whose credentials were stolen.\n\nTable C-74. Generic CVSS v2 score for the use of clear-text authentication protocols on SCADAs.\n\n|Use of Standard IT Protocols with Clear-text Authentication|Col2|\n|---|---|\n|Possible Consequences|Lack of identity proofing|\n|SCADA Impact|Unauthorized access to SCADA components: Possible unauthorized remote access to hosts with privileges to any functionality granted to the compromised remote user.|\n|Vulnerable Components|SCADA hosts running clear-text authentication protocol services|\n|Ease of Detection|Easy|\n|Attacker Awareness|High|\n|Remediation Cost|Low|\n|Weakness Prevalence|High|\n|SCADA Prevalence|High|\n\n|Metric|Value|\n|---|---|\n|Base Metric||\n|Access Vector|Network|\n|Access Complexity|High|\n|Authentication|None|\n|Confidentiality Impact|Complete|\n|Integrity Impact|Complete|\n|Availability Impact|Complete|\n|Base Score|7.6|\n|Temporal Metric||\n|Exploitability|Functional Exploit Exists|\n|Remediation Level|Not Defined|\n|Report Confidence|Confirmed|\n|Temporal Score|7.2|\n|Environmental Metrics||\n|Collateral Damage Potential|High|\n|Target Distribution|Not Defined|\n|Availability Requirement|Medium|\n|Integrity Requirement|High|\n|Confidentiality Requirement|High|\n|Environmental Score|8.6|\n|Overall CVSS Score|8.6|\n\n\n-----\n\n|Metric|Value|\n|---|---|\n|8.6||\n\n\n**8.6**\n\n\n#### C-9.2 Scoring and Reducing the CVSS Risk Metrics\n\nSome SCADA applications still utilize insecure IT protocols between SCADA hosts. Some SCADA\noperators and administrators still use these protocols to remotely access SCADA hosts.\n\n**C-9.2.1** **Base Exploitability Metrics**\n\n**_C-9.2.1.1_** **_Related Exploit Range (Access Vector)_**\n\nProtocols that transmit passwords in clear text allow remote attackers to obtain authentication\ncredentials by sniffing the network. Table C-75 gives example scenarios that fit each of the Access Vector\nmetric values in an SCADA environment.\n\nTable C-75. Clear-text IT authentication CVSS v2 Access Vector scenarios.\n\n**Metric Value** **Use of Standard IT Protocols with Clear-text Authentication Access Vector Scenarios**\n**Adjacent** If these protocols are only used between hosts on the same local network (i.e., an SCADA\n**Network** security zone), an attacker would require access to that network to capture usernames and\n\npasswords as they are transmitted in plain text.\n\n**Network** Connections using clear-text authentication protocols in and out of SCADA networks can be\nsniffed by remote attackers to gather credentials that can be used to log into SCADA hosts.\n\n**_C-9.2.1.2_** **_Access Complexity and Level of Authentication Needed_**\n\nAccess Complexity measures the complexity of the attack required to exploit the vulnerability once\nan attacker has gained access to the target system. The Access Complexity is “High” because this\nvulnerability is not exploitable at the attacker's whim. There is an additional layer of complexity because\nthe attacker must wait for a user to login using a clear-text authentication protocol.\n\nThis vulnerability allows the capture of SCADA host account user names and passwords. An attacker\ndoes not need to provide credentials to sniff plain-text network traffic.\n\nTable C-76 shows the Access Complexity and Authentication metric values.\n\nTable C-76. Clear-text IT authentication CVSS v2 Access Complexity and Authentication values.\n\n**Metric** **Metric Value** **Rational**\n**Access** High The access conditions are somewhat specialized:\n**Complexity**\n\n               - The attacker must wait for a user to login\n\n               - The network must be vulnerable to MitM attacks (commonly the case)\n\n**Authentication** None An attacker does not need authenticate to a system to sniff plain-text network\n**Needed** traffic.\n\n|Metric Value|Use of Standard IT Protocols with Clear-text Authentication Access Vector Scenarios|\n|---|---|\n|Adjacent Network|If these protocols are only used between hosts on the same local network (i.e., an SCADA security zone), an attacker would require access to that network to capture usernames and passwords as they are transmitted in plain text.|\n|Network|Connections using clear-text authentication protocols in and out of SCADA networks can be sniffed by remote attackers to gather credentials that can be used to log into SCADA hosts.|\n\n|Metric|Metric Value|Rational|\n|---|---|---|\n|Access Complexity|High|The access conditions are somewhat specialized: • The attacker must wait for a user to login • The network must be vulnerable to MitM attacks (commonly the case)|\n|Authentication Needed|None|An attacker does not need authenticate to a system to sniff plain-text network traffic.|\n\n\n-----\n\n**C-9.2.2** **Impact Metrics**\n\nClear-text messages can be viewed by anyone able to gain access to the network traffic. This\nconfidentiality vulnerability discloses authentication information. An attacker can then use these\ncredentials to login. The potential impact depends on the privileges of the compromised account. If an\nadministrative user’s credentials are captured, then a full system compromise is possible. Since the most\nharmful case must be considered, each of the three Impact metrics is set to “Complete.” Owners can\nadjust these values to “Partial” if administrative users are not allowed to login remotely using clear-text\nprotocols. Table C-77 shows the Impact metric values for the use of standard it protocols with clear-text\nauthentication.\n\nTable C-77 Clear-text IT authentication CVSS v2 Impact metric values.\n\n**Metric** **Metric Value** **Use of Standard IT Protocols with Clear-text Authentication Impacts**\n**Confidentiality** Partial - The use of plain-text authentication protocols allows disclosure of SCADA\nComplete host account credentials (as well as other data sent). The attacker can then log\n\nin and view all data visible to the compromised account.\n\nPartial **Integrity** The attacker can log in using the stolen credentials and alter any data the\nComplete\n\ncompromised account has permission to edit.\n\nPartial **Availability** The attacker can delete any data or stop any services and applications the\nComplete\n\ncompromised account is able to.\n\n**_C-9.2.2.1_** **_SCADA Environmental Security Requirements_**\n\nThese metrics enable SCADA vendors and owners to customize the CVSS score depending on the\nimportance of the vulnerable components to the SCADA product or installed system, measured in terms\nof confidentiality, integrity, and availability. They measure the potential for loss of revenue or life due to\nloss of confidentiality, integrity, or availability of the SCADA hosts or devices that run servers for\ninsecure protocols. See Section C-11, “SCADA Environmental Security Requirements,” below.\n\n**_C-9.2.2.2_** **_Organization Specific Potential for Loss (Collateral Damage Potential)_**\n\nThe use of insecure protocols and services to connect to the SCADA hosts creates a high-risk access\npath into the system. This is a significant vulnerability because it allows unauthorized remote access to\nSCADA hosts and the functionality allowed to the compromised account.\n\nCollateral damage potential can be reduced by removing these services from systems where comprise\ncould lead to unacceptable loss of revenue, safety, or productivity (if possible).\n\n**_C-9.2.2.3_** **_Percentage of Vulnerable Systems (Target Distribution)_**\n\nTarget Distribution is the percentage of SCADA hosts that have servers for plain-text authentication\nprotocols installed.\n\nTarget Distribution can be reduced by removing services for clear-text authentication protocols.\n\n|Metric|Metric Value|Use of Standard IT Protocols with Clear-text Authentication Impacts|\n|---|---|---|\n|Confidentiality|Partial - Complete|The use of plain-text authentication protocols allows disclosure of SCADA host account credentials (as well as other data sent). The attacker can then log in and view all data visible to the compromised account.|\n|Integrity|Partial - Complete|The attacker can log in using the stolen credentials and alter any data the compromised account has permission to edit.|\n|Availability|Partial - Complete|The attacker can delete any data or stop any services and applications the compromised account is able to.|\n\n\n-----\n\n**C-9.2.3** **Temporal Score Metrics**\n\n**_C-9.2.3.1_** **_Exploitability and Report Confidence_**\n\nVendors and owners cannot change the availability of exploits. GUI MitM tools exist and can be used\nto capture unprotected transmission of passwords. The availability of plain-text protocol exploits is\n“Functional.” Table C-78 shows the CVSS v2 Exploitability metric values.\n\nTable C-78. Clear-text IT authentication CVSS v2 Exploitability metric values.\n\n**Metric** **Metric Value** **Description**\n**Exploit** **Functional** Functional exploit code is available. The code works in most situations where\n**Availability** the vulnerability exists. For example, GUI MitM tools exist and can be used to\n\ncapture unprotected transmission of passwords.\n\n**Report** **Confirmed** Clear-text transmission of credentials is a well known vulnerability. SCADA\n**Confidence** vendors and owners can assess their hosts for these services and monitor their\n\nown network traffic for their use.\n\n**_C-9.2.3.2_** **_Type of Fix Available (Remediation Level)_**\n\nThe remediation level depends on whether the vulnerable protocols can be replaced or removed from\nthe SCADA. In some cases, the SCADA owner cannot remove the dependence on insecure protocols. The\nSCADA vendor must alter the SCADA code that calls these services.\n\nSome SCADA devices do not support secure protocols for remote administration. SCADA vendors\nshould include secure remote login services on their devices. SCADA owners can implement workaround\nmitigations for their vulnerable devices by directly connecting them to a server capable of secure\nauthentication. Remote device administration can then be proxied through the server, and the clear-text\ncredentials are only sent on the direct connection between the proxy and SCADA device.\n\nTable C-79 lists potential scenarios for each of the CVSS v2 Remediation Level metric values.\n\nTable C-79. Clear-text IT authentication CVSS v2 Remediation Level scenarios.\n\n**Metric Value** **Use of Standard IT Protocols with Clear-text Authentication Remediation Level**\n**Scenarios**\n**Official Fix** There is a patch available that removes the dependence on insecure protocols.\n\n**Temporary Fix** The SCADA vendor has released or recommended a temporary mitigation while the official\nfix is being developed.\n\n**Workaround** Potential workaround mitigations include:\n\n          - The SCADA owner is able to use an encryption product to tunnel authentication traffic.\n\n          - The SCADA owner is able to isolate the clear-text traffic to a single network and limit\naccess to the extent possible.\n\n**Unavailable** The vendor has not provided a solution and no workaround mitigation can be applied. For\nexample, potential mitigations such as encryption or firewall rules cannot be applied without\nbreaking the system functionality or are not effective when configured for system\nrequirements.\n\n|Metric|Metric Value|Description|\n|---|---|---|\n|Exploit Availability|Functional|Functional exploit code is available. The code works in most situations where the vulnerability exists. For example, GUI MitM tools exist and can be used to capture unprotected transmission of passwords.|\n|Report Confidence|Confirmed|Clear-text transmission of credentials is a well known vulnerability. SCADA vendors and owners can assess their hosts for these services and monitor their own network traffic for their use.|\n\n|Metric Value|Use of Standard IT Protocols with Clear-text Authentication Remediation Level Scenarios|\n|---|---|\n|Official Fix|There is a patch available that removes the dependence on insecure protocols.|\n|Temporary Fix|The SCADA vendor has released or recommended a temporary mitigation while the official fix is being developed.|\n|Workaround|Potential workaround mitigations include: • The SCADA owner is able to use an encryption product to tunnel authentication traffic. • The SCADA owner is able to isolate the clear-text traffic to a single network and limit access to the extent possible.|\n|Unavailable|The vendor has not provided a solution and no workaround mitigation can be applied. For example, potential mitigations such as encryption or firewall rules cannot be applied without breaking the system functionality or are not effective when configured for system requirements.|\n\n\n-----\n\n**C-9.2.4** **Clear-text Protocol Recommendation Summary**\n\nUsers of clear-text authentication protocols should be aware of more secure remote access and file\ntransfer solutions that are available.\n\nInsecure versions of common IT services should be replaced where possible by their secure versions.\nSCADAs use common IT protocols for common IT functionality, such as network device management,\nremote logins, or file transfers. Because they are not used for real-time functionality, in most cases they\ncan be replaced with their secure counterparts. SSH can replace all file transfer and remote login\nprotocols such as FTP, telnet, and rlogin with encrypted versions. Any communication protocol can be\n“tunneled” through SSH. HTTP can be sent over the Secure Socket Layer (HTTPS).\n\nTable C-80 lists specific recommendations for lowering the probability of a clear-text authentication\nprotocol being exploited.\n\nTable C-80. Lowering risk due to the probability of a clear-text authentication protocol being exploited.\n\n**Recommendation** **Potential Methods**\n\nIncrease Access SCADA vendors can minimize the use of insecure IT protocols in their products.\nComplexity SCADA owners can minimize the use of insecure IT protocols. These protocols should\n\nonly be necessary on devices that must be remotely accessed, but do not support secure\nprotocols.\nDecrease Target SCADA vendors and owners can uninstall or disable these protocols on SCADA hosts\nDistribution that do not require them for SCADA functionality.\n\nIncrease Level of SCADA vendors can assess their products for the use of IT protocols that transmit\nRemediation credentials in clear text (or use other weak authentication mechanisms) and replace them\n\nwith secure alternatives. They should securely configure them by default and provide\nsecure configuration documentation to their customers.\nSCADA owners can monitor their network for the use of insecure protocols and test the\nremoval or replacement of the associated services on backup or test systems. Owners can\nfind their own work-around solutions. For example, they can proxy remote\nadministration of SCADA devices through a server that supports encryption and is\ndirectly connected to the device.\n\nTable C-81 lists recommendations on lowering the potential impact of a clear-text authentication\nprotocol being exploited.\n\nTable C-81. Lowering risk due to the potential impact of clear-text authentication protocols.\n\n**Recommendation** **Potential Methods**\nReduce Base Impact SCADA vendors and owners can minimize the privileges of users that are allowed to\nuse these protocols.\nReduce Environmental SCADA vendors and owners can separate functionality, or remove unnecessary\nImpact functionality from SCADA hosts and user accounts.\n\n**_C-9.2.4.1_** **_SCADA Vendor Recommendations_**\n\nSCADA vendors and customers should follow IT security practices and use the current secure\nversions of common protocols. In some cases, the SCADA owner cannot remove the dependence on\ninsecure protocols. The SCADA vendor must alter the SCADA code that calls these services.\n\n|Recommendation|Potential Methods|\n|---|---|\n|Increase Access Complexity|SCADA vendors can minimize the use of insecure IT protocols in their products. SCADA owners can minimize the use of insecure IT protocols. These protocols should only be necessary on devices that must be remotely accessed, but do not support secure protocols.|\n|Decrease Target Distribution|SCADA vendors and owners can uninstall or disable these protocols on SCADA hosts that do not require them for SCADA functionality.|\n|Increase Level of Remediation|SCADA vendors can assess their products for the use of IT protocols that transmit credentials in clear text (or use other weak authentication mechanisms) and replace them with secure alternatives. They should securely configure them by default and provide secure configuration documentation to their customers. SCADA owners can monitor their network for the use of insecure protocols and test the removal or replacement of the associated services on backup or test systems. Owners can find their own work-around solutions. For example, they can proxy remote administration of SCADA devices through a server that supports encryption and is directly connected to the device.|\n\n|Recommendation|Potential Methods|\n|---|---|\n|Reduce Base Impact|SCADA vendors and owners can minimize the privileges of users that are allowed to use these protocols.|\n|Reduce Environmental Impact|SCADA vendors and owners can separate functionality, or remove unnecessary functionality from SCADA hosts and user accounts.|\n\n\n-----\n\nSome SCADA devices do not support secure protocols for remote administration. SCADA vendors\nshould include secure remote login services on their devices.\n\n**_C-9.2.4.2_** **_SCADA Owner Recommendations_**\n\nSCADA owners should follow IT security practices and use the current secure versions of common\nprotocols. When replacement is not feasible, access to the services should be minimized, and unencrypted\ncommunication should be limited to within the SCADA whenever possible. Communications between\nsecurity zones should be secured as much as possible.\n\nSCADA owners can implement workaround mitigations for their vulnerable devices by directly\nconnecting them to a server capable of secure authentication. Remote device administration can then be\nproxied through the server, and the clear-text credentials are only sent on the direct connection between\nthe proxy and SCADA device.\n\n#### C-10. SCADA Credentials Gathering: Unprotected Transport of SCADA Application Credentials\n\nThe difference between this vulnerability and use of clear-text authentication protocols in\nSection C-9, “SCADA Host Access: Use of Standard IT Protocols with Clear-text Authentication,” above\nis how well known the protocols are and what they are used for. Both vulnerabilities are due to the\nunprotected transportation of credentials. In this case, if the attacker is able to capture SCADA\napplication credentials, he can then log into the SCADA application and gain access to the associated\nSCADA functionality. This may include controlling the physical process, altering data, or reconfiguring\nSCADA devices.\n\nThis is a significant vulnerability because it allows unauthorized remote access to SCADA\nfunctionality, possibly the HMI application (control functionality). Table C-82 summarizes the relevant\nsecurity attributes of transmitting SCADA application credentials across the network in clear text.\n\nTable C-82. Unprotected transport of SCADA application credentials summary.\n\n|Unprotected Transport of SCADA Application Credentials|Col2|\n|---|---|\n|Possible Consequences|Lack of identity proofing|\n|SCADA Impact|Unauthorized access to SCADA applications: Possible unauthorized remote access to supervisory control functionality.|\n|Vulnerable Components|SCADA applications|\n|Ease of Detection|Easy|\n|Attacker Awareness|High|\n|Remediation Cost|Medium|\n|Weakness Prevalence|High|\n|SCADA Prevalence|Common|\n\n\n-----\n\n#### C-10.1 Generic CVSS v2 Score\n\nThese attacks bypass authentication; therefore, “Authentication” is “None.”\n\nThe Access Complexity is “High” because the attacker must wait for a user to login to the SCADA\napplication.\n\nEach of the Impact metrics is set to “Complete.” The actual impact depends on the application and\nprivileges of the account whose credentials were stolen.\n\nUser credentials require high confidentiality. SCADA system data and functionality require integrity\nand availability.\n\nA successful compromise of an SCADA host may result in catastrophic physical or property damage\nand loss. Or, there may be a catastrophic loss of revenue or productivity.\n\nCVSS v2 metrics for unprotected transport of SCADA application credentials are summarized in\nTable C-83 using the most common or critical values seen on SCADA. See Section 4.3.2.1, “33Protect\nSCADA authentication credentials during transmission” for more information.\n\nTable C-83. Generic CVSS v2 score for unprotected transport of SCADA application credentials.\n\n|Metric|Value|\n|---|---|\n|Base Metric||\n|Access Vector|Network|\n|Access Complexity|High|\n|Authentication|None|\n|Confidentiality Impact|Complete|\n|Integrity Impact|Complete|\n|Availability Impact|Complete|\n|Base Score|7.6|\n|Temporal Metric||\n|Exploitability|Functional Exploit Exists|\n|Remediation Level|Not Defined|\n|Report Confidence|Confirmed|\n|Temporal Score|7.2|\n|Environmental Metrics||\n|Collateral Damage Potential|High|\n|Target Distribution|Not Defined|\n|Availability Requirement|High|\n|Integrity Requirement|High|\n|Confidentiality Requirement|Medium|\n|Environmental Score|8.6|\n|Overall CVSS Score|8.6|\n|8.6||\n\n\n**8.6**\n\n\n-----\n\n#### C-10.2 Scoring and Reducing the CVSS Risk Metrics\n\n**C-10.2.1 Base Exploitability Metrics**\n\n**_C-10.2.1.1 Related Exploit Range (Access Vector)_**\n\nClear-text transmission of SCADA credentials allows remote attackers to access SCADA applications\nafter gathering the required credentials by sniffing them off the network.\n\nTable C-84 gives example scenarios that fit each of the Access Vector metric values in an SCADA\nenvironment.\n\nTable C-84. Unprotected transport of SCADA credentials CVSS v2 Access Vector scenarios.\n\n**Metric Value** **Clear-text Transmission of SCADA Application Credentials Access Vector Scenarios**\n**Adjacent** If the application is accessed from the same local network (i.e., an SCADA security zone), an\n**Network** attacker would require access to that network to capture usernames and passwords as they are\n\ntransmitted in plain text.\n\n**Network** Authentication traffic to SCADA applications from an external network can be sniffed by\nremote attackers to gather credentials that can be used to log into the applications themselves.\n\n**_C-10.2.1.2 Access Complexity and Level of Authentication Needed_**\n\nAccess Complexity measures the complexity of the attack required to exploit the vulnerability once\nan attacker has gained access to the target system. The Access Complexity is “High” because this\nvulnerability is not exploitable at the attacker’s whim. The attacker must wait for a user to login to the\nSCADA application. He must also obtain a copy of the client application to use the stolen credentials.\n\nThis vulnerability may allow the capture of SCADA application credentials. An attacker does not\nneed to authenticate to any additional system to sniff plain-text network traffic.\n\nTable C-85 shows the Access Complexity and Authentication metric values in an SCADA\nenvironment.\n\nTable C-85. Unprotected transport of credentials Access Complexity and Authentication values.\n\n**Metric** **Metric Value** **Rational**\n**Access** **High** The access conditions are somewhat specialized:\n**Complexity**\n\n               - The attacker must wait for a user to login\n\n               - The network must be vulnerable to MitM attacks (commonly the case).\n\n**Authentication** **None** An attacker does not need to provide credentials to sniff plain-text network\n**Needed** traffic.\n\n**C-10.2.2 Impact Metrics**\n\nClear-text transmission of SCADA credentials can allow unauthorized access to information or\nfunctionality provided by SCADA applications. If the attacker is able to capture SCADA application\ncredentials, he can then log into the SCADA application and gain access to the associated SCADA\nfunctionality. This may include controlling the physical process, altering data, or reconfiguring SCADA\ndevices.\n\nFrom an SCADA perspective, the most severe impact that can result is unauthorized supervisory\ncontrol access. In CVSS terms, process confidentiality, integrity, and availability may be compromised.\n\n|Metric Value|Clear-text Transmission of SCADA Application Credentials Access Vector Scenarios|\n|---|---|\n|Adjacent Network|If the application is accessed from the same local network (i.e., an SCADA security zone), an attacker would require access to that network to capture usernames and passwords as they are transmitted in plain text.|\n|Network|Authentication traffic to SCADA applications from an external network can be sniffed by remote attackers to gather credentials that can be used to log into the applications themselves.|\n\n|Metric|Metric Value|Rational|\n|---|---|---|\n|Access Complexity|High|The access conditions are somewhat specialized: • The attacker must wait for a user to login • The network must be vulnerable to MitM attacks (commonly the case).|\n|Authentication Needed|None|An attacker does not need to provide credentials to sniff plain-text network traffic.|\n\n\n-----\n\nTable C-86 shows the Impact metric values for SCADA applications that use clear-text\nauthentication.\n\nTable C-86. Unprotected transport of SCADA credentials CVSS v2 Impact metric values.\n\n**Metric** **Metric Value** **Rational**\n**Confidentiality** **Partial -** Clear-text transmission of SCADA credentials allows disclosure of SCADA\n**Complete** application account credentials. The attacker can then log in to the SCADA\n\napplication and view all data available to the compromised account.\n\n**Integrity** **Partial -** The attacker can log in using the stolen credentials and perform any SCADA\n**Complete** functions for which that user has access.\n\n**Availability** **Partial -** The attacker can impact host or SCADA availability if that functionality is\n**Complete** provided to the compromised account by the SCADA application.\n\n**_C-10.2.2.1 Environmental Security Requirements_**\n\nThese metrics enable SCADA vendors and owners to customize the CVSS score depending on the\nimportance of the vulnerable components to the SCADA product or installed system, measured in terms\nof confidentiality, integrity, and availability. They measure the potential for loss of revenue or life due to\nloss of confidentiality, integrity, or availability of the SCADA hosts or devices have the vulnerable\napplication installed on them. See Section C-11, “SCADA Environmental Security Requirements,”\nbelow.\n\n**_C-10.2.2.2 Organization Specific Potential for Loss (Collateral Damage Potential)_**\n\nIf the attacker is able to capture SCADA application credentials, he can then log into the SCADA\napplication and gain access to the associated SCADA functionality. This may include controlling the\nphysical process, altering data, or reconfiguring SCADA devices.\n\nThis is a significant vulnerability because it allows unauthorized remote access to SCADA\nfunctionality, possibly the HMI application (control functionality).\n\n**C-10.2.3 Percentage of Vulnerable Systems (Target Distribution)**\n\nTarget Distribution depends on the percentage of SCADA components on which the vulnerable\napplications are installed.\n\n**C-10.2.4 Temporal Score Metrics**\n\nThese metrics describe elements about the vulnerability that change over time.\n\n**_C-10.2.4.1 Exploitability and Report Confidence_**\n\nVendors and owners cannot change the availability of exploits. GUI MitM tools exist and can be used\nto capture unprotected transmission of passwords. The availability of plain-text protocol exploits is\n“Functional.” Table C-87 shows the CVSS v2 Exploitability and Report Confidence metric values for the\nunprotected transport of credentials.\n\n|Metric|Metric Value|Rational|\n|---|---|---|\n|Confidentiality|Partial - Complete|Clear-text transmission of SCADA credentials allows disclosure of SCADA application account credentials. The attacker can then log in to the SCADA application and view all data available to the compromised account.|\n|Integrity|Partial - Complete|The attacker can log in using the stolen credentials and perform any SCADA functions for which that user has access.|\n|Availability|Partial - Complete|The attacker can impact host or SCADA availability if that functionality is provided to the compromised account by the SCADA application.|\n\n\n-----\n\nTable C-87. Unprotected transport of credentials CVSS v2 Exploitability and Report Confidence values.\n\n**Metric** **Metric Value** **Rational**\n**Exploit** **Functional** Functional exploit code is available. The code works in most situations\n**Availability** where the vulnerability exists. For example, GUI MitM tools exist and can\n\nbe used to capture unprotected transmission of passwords.\n\n**Level of** **Unconfirmed** Clear-text transmission of credentials can be identified or validated by\n**Verification** **- Confirmed** capturing the network traffic as a user authenticates to the application over\n**that** the network. SCADA vendors and owners can easily confirm whether\n**Vulnerability** passwords are transmitted in clear text.\n**Exists**\n\n**_C-10.2.4.2 Type of Fix Available (Remediation Level)_**\n\nSCADA vendors can encrypt or hash application credentials in a way that prevents them from being\ncaptured and replayed. SCADA owners may be able to secure SCADA application connections using\nthird-party encryption solutions. Table C-88 lists example scenarios that fit the potential CVSS\nRemediation Level metric values.\n\nTable C-88. Unprotected transport of SCADA credentials CVSS v2 Remediation Level scenarios.\n\n**Metric Value** **Clear-text Transmission of SCADA Application Credentials Remediation Level**\n**Scenarios**\n**Official Fix** There is a patch available that securely transmits application credentials.\n\n**Temporary Fix** The SCADA vendor has released or recommended a temporary mitigation while the official\nfix is being developed.\n\n**Workaround** Potential workaround mitigations include:\n\n          - The SCADA owner is able to use an encryption product to tunnel authentication traffic.\n\n          - The SCADA owner is able to isolate the clear-text traffic to a single network and limit\naccess to the extent possible.\n\n**Unavailable** The vendor has not provided a solution and no workaround mitigation can be applied. For\nexample, potential mitigations such as encryption or firewall rules cannot be applied without\nbreaking the system functionality or are not effective when configured for system\nrequirements.\n\n**C-10.2.5 Clear-text Transmission of SCADA Application Credentials Recommendation**\n**Summary**\n\nTable C-89 lists specific recommendations for lowering the probability of the unprotected transport of\nSCADA application credentials being exploited.\n\nTable C-89. Lowering risk of unprotected transport of SCADA application credentials being exploited.\n\n|Metric|Metric Value|Rational|\n|---|---|---|\n|Exploit Availability|Functional|Functional exploit code is available. The code works in most situations where the vulnerability exists. For example, GUI MitM tools exist and can be used to capture unprotected transmission of passwords.|\n|Level of Verification that Vulnerability Exists|Unconfirmed - Confirmed|Clear-text transmission of credentials can be identified or validated by capturing the network traffic as a user authenticates to the application over the network. SCADA vendors and owners can easily confirm whether passwords are transmitted in clear text.|\n\n|Metric Value|Clear-text Transmission of SCADA Application Credentials Remediation Level Scenarios|\n|---|---|\n|Official Fix|There is a patch available that securely transmits application credentials.|\n|Temporary Fix|The SCADA vendor has released or recommended a temporary mitigation while the official fix is being developed.|\n|Workaround|Potential workaround mitigations include: • The SCADA owner is able to use an encryption product to tunnel authentication traffic. • The SCADA owner is able to isolate the clear-text traffic to a single network and limit access to the extent possible.|\n|Unavailable|The vendor has not provided a solution and no workaround mitigation can be applied. For example, potential mitigations such as encryption or firewall rules cannot be applied without breaking the system functionality or are not effective when configured for system requirements.|\n\n|Recommendation|Potential Methods|\n|---|---|\n|Increase Access Complexity|SCADA vendors can minimize the unprotected transportation of credentials in their products. SCADA owners can minimize the use of SCADA applications that do not transmit credentials securely.|\n|Decrease Target Distribution|SCADA owners can uninstall vulnerable applications from SCADA hosts that do not require them.|\n\n\n-----\n\nIncrease Level of SCADA vendors can assess their server applications and use vetted mechanisms for\nRemediation securely transmitting credentials over the network.\n\nSCADA owners can monitor their network for clear-text transmission of credentials.\nSCADA owners may be able to secure SCADA application connections using thirdparty encryption solutions.\n\nTable C-90 lists recommendations on lowering the potential impact of unprotected transport of\nSCADA application credentials being exploited.\n\nTable C-90. Lowering potential impact of the unprotected transport of SCADA application credentials.\n\n**Recommendation** **Potential Methods**\nReduce Base Impact SCADA vendors can compartmentalize application account types and functionality.\nSCADA owners can grant the minimum privileges necessary for each user.\nReduce Environmental SCADA vendors can separate functionality, or remove unnecessary functionality from\nImpact SCADA applications.\n\n**_C-10.2.5.1 SCADA Vendor Recommendations_**\n\nUser credentials should be vigorously protected and made inaccessible to an attacker. Whenever\ncredentials are passed in clear text, they are susceptible to being captured by the attacker. Passwords\nshould be securely encrypted or hashed before being stored or transmitted. When using Web applications\nwith Secure Sockets Layer (SSL), use SSL for the entire session from login to logout, not just for the\ninitial login page.\n\n**_C-10.2.5.2 SCADA Owner Recommendations_**\n\nSCADA owners may be able to secure SCADA application connections using third-party encryption\nsolutions.\n\n#### C-11. SCADA Environmental Security Requirements\n\nEnvironmental impact metrics enable SCADA vendors and owners to customize the CVSS score\ndepending on the importance of the affected component to the SCADA product or installed system,\nmeasured in terms of confidentiality, integrity, and availability. They measure the potential for loss of\nrevenue or life due to loss of confidentiality, integrity, or availability of the SCADA host or device. This\nis based on the host’s security objectives due to its role as part of the SCADA.\n\nThe security requirements of the data and applications installed on an SCADA host or device\ndetermine that component’s security requirements. In general, SCADA have higher integrity and\navailability requirements than confidentiality requirements for status data and command functions.\n\n#### C-11.1 SCADA Component Confidentiality Requirements\n\nConfidentiality is generally not as important as integrity or availability for an SCADA, but it may be\nfor individual SCADA components. Table C-91 gives example scenarios that fit each of the\nConfidentiality Requirement metric values in an SCADA environment.\n\n|Recommendation|Potential Methods|\n|---|---|\n|Increase Level of Remediation|SCADA vendors can assess their server applications and use vetted mechanisms for securely transmitting credentials over the network. SCADA owners can monitor their network for clear-text transmission of credentials. SCADA owners may be able to secure SCADA application connections using third- party encryption solutions.|\n\n|Recommendation|Potential Methods|\n|---|---|\n|Reduce Base Impact|SCADA vendors can compartmentalize application account types and functionality. SCADA owners can grant the minimum privileges necessary for each user.|\n|Reduce Environmental Impact|SCADA vendors can separate functionality, or remove unnecessary functionality from SCADA applications.|\n\n\n-----\n\nSCADA vendors and owners can lower the confidentiality requirement by minimizing the\nconfidential information on SCADA hosts.\n\nTable C-91. SCADA scenarios for each of the CVSS v2 Confidentiality Requirement metric values.\n\n**Metric Value** **SCADA Component Confidentiality Requirement Scenarios**\n**Low** Loss of confidentiality of the information on an SCADA host is likely to have limited effect on\nthe operation of the SCADA or its organization’s business interests.\n\n**Medium** Disclosure of information on an SCADA host could have a serious adverse effect on the business\nor safety. For example, data on SCADA hosts could give an attacker the system-specific\ninformation needed to intelligently control the SCADA.\n\n**High** Depending on the system or process under control and the individual component, disclosure of\ninformation on the SCADA host could have a catastrophic adverse effect on the business or\nsafety.\n\n#### C-11.2 SCADA Component Integrity Requirements\n\nIntegrity of SCADA data is generally the highest priority in relation to confidentiality and\navailability, but it may not be for individual SCADA components. Table C-92 gives example scenarios\nfor the Integrity Requirement metric values in an SCADA environment.\n\nThe integrity of data on SCADA hosts is high, but the potential impact is dependent on the nature of\nthe individual system or process.\n\nTable C-92. SCADA scenarios that fit each of the CVSS v2 Integrity Requirement metric values.\n\n**Metric Value** **SCADA Component Integrity Requirement Scenarios**\n**Low** Loss of data integrity on an SCADA host is likely to have limited effect on the operation of the\nSCADA or its organization’s business interests. For example, the SCADA is not the primary\nmethod used to monitor and control the process.\n\n**Medium** Manipulation of data on the SCADA host could have a serious adverse effect on the business or\nsafety. For example, inaccurate process data or unauthorized commands may require the plant to\nthrow out a batch of product, but could not endanger lives.\n\n**High** Depending on the system or process under control and the individual component, data\nmanipulation on the SCADA host could have a catastrophic adverse effect on the business or\nsafety. Alteration of system data or malicious operation of the physical system may result in\neconomic, environmental, or safety catastrophes.\n\n#### C-11.3 SCADA Component Availability Requirements\n\nThis metric measures the potential for loss of revenue or life due to loss of availability of the SCADA\nhost. This is unique to the host and its security objectives based on its role as part of the SCADA. Table\nC-93 gives example scenarios that fit each of the Availability Requirement metric values in an SCADA\nenvironment.\n\nThis depends on the functionality of the SCADA service and host.\n\n|Metric Value|SCADA Component Confidentiality Requirement Scenarios|\n|---|---|\n|Low|Loss of confidentiality of the information on an SCADA host is likely to have limited effect on the operation of the SCADA or its organization’s business interests.|\n|Medium|Disclosure of information on an SCADA host could have a serious adverse effect on the business or safety. For example, data on SCADA hosts could give an attacker the system-specific information needed to intelligently control the SCADA.|\n|High|Depending on the system or process under control and the individual component, disclosure of information on the SCADA host could have a catastrophic adverse effect on the business or safety.|\n\n|Metric Value|SCADA Component Integrity Requirement Scenarios|\n|---|---|\n|Low|Loss of data integrity on an SCADA host is likely to have limited effect on the operation of the SCADA or its organization’s business interests. For example, the SCADA is not the primary method used to monitor and control the process.|\n|Medium|Manipulation of data on the SCADA host could have a serious adverse effect on the business or safety. For example, inaccurate process data or unauthorized commands may require the plant to throw out a batch of product, but could not endanger lives.|\n|High|Depending on the system or process under control and the individual component, data manipulation on the SCADA host could have a catastrophic adverse effect on the business or safety. Alteration of system data or malicious operation of the physical system may result in economic, environmental, or safety catastrophes.|\n\n\n-----\n\nTable C-93. SCADA scenarios that fit each of the CVSS v2 Availability Requirement metric values.\n\n**Metric Value** **SCADA Component Availability Requirement Scenarios**\n**Low** Loss of the data, services, or applications on the affected SCADA component is likely to have\nlimited effect on the operation of the SCADA or its organization’s business interests. The service\nand host are not critical SCADA components that require high availability.\n\n**Medium** Loss of the data, services, or applications on the affected SCADA component could have a\nserious adverse effect on the business or safety. For example, the service or the SCADA\ncomponents it runs on require high availability, and the loss of either will result in serious\nconsequences.\n\n**High** Loss of the data, services, or applications on the affected SCADA component is likely to have\ncatastrophic adverse effect on the business or safety. For example, the service or the SCADA\ncomponents it runs on are critical SCADA components that require high availability, and the loss\nof either will result in catastrophic consequences.\n\n#### C-12. Summary of SCADA Common Vulnerability Evaluation\n\nCommon vulnerabilities identified during NSTB vulnerability assessments were evaluated and\ndiscussed in this appendix to aid SCADA vendors and owners in assessing, prioritizing, and mitigating\nvulnerabilities in the systems in which they are responsible. This prioritizes common vulnerability types\nto help guide vulnerability identification and mitigation activities. Mitigation of risk associated with these\n10 vulnerability types should lead to the greatest reduction in the total risk to an SCADA from\ncybersecurity events. In summary, the following 10 recommendations can be used as a starting point for\nmitigating the highest risk vulnerabilities commonly identified on SCADAs:\n\n**1.** **Routinely assess all SCADA components, including operating systems, applications, services,**\n**network devices, etc., for published vulnerabilities.**\n\n**Vendors: SCADA vendors can reduce the risk due to published vulnerabilities by delivering new**\nsystems without known vulnerabilities and testing patches for third-party products as they are\nreleased.\n\n**Owners: Apply patches as quickly as possible. Work with vendor to test and apply patches for all**\noperating systems and software on the SCADA networks. If patches are not available or cannot be\napplied, SCADA owners can restrict access to and closely monitor vulnerable systems. They can also\ndisable or remove the vulnerable application wherever possible.\n\n**2.** **Web servers and clients should be assessed and secured, especially those that allow access to the**\n**physical system.**\n\n**Vendors: SCADA applications should use well-known and tested third-party Web servers to serve**\ntheir Web applications. Web applications should be thoroughly tested for malformed input and other\nvulnerabilities that could lead to a compromise of the SCADA Web server. Vendors should prioritize\nand remediate vulnerabilities as quickly as possible.\n\n**Owners: Minimize access and available functionality of Web servers and clients. Validate that the**\naccess controls are configured to restrict all unwanted users and SCADA functionality.\n\nAdministrators of SCADA with Web servers should use an application firewall that can detect\ncommon Web attacks. This might not catch all attacks, and it might require some effort for\ncustomization. However, it is a layer of defense that can be used to help reduce the risk of\nvulnerabilities in Web applications that expose the SCADA historian and Web servers to attack from\nthe Web client’s network.\n\n|Metric Value|SCADA Component Availability Requirement Scenarios|\n|---|---|\n|Low|Loss of the data, services, or applications on the affected SCADA component is likely to have limited effect on the operation of the SCADA or its organization’s business interests. The service and host are not critical SCADA components that require high availability.|\n|Medium|Loss of the data, services, or applications on the affected SCADA component could have a serious adverse effect on the business or safety. For example, the service or the SCADA components it runs on require high availability, and the loss of either will result in serious consequences.|\n|High|Loss of the data, services, or applications on the affected SCADA component is likely to have catastrophic adverse effect on the business or safety. For example, the service or the SCADA components it runs on are critical SCADA components that require high availability, and the loss of either will result in catastrophic consequences.|\n\n\n-----\n\n**3.** **Minimize usage, exposure, and available functionality of remote display protocols.**\n\n**Vendors: Provide secure options for remotely accessing the HMI and secure default configurations.**\nSecure configurations include access restrictions and secure authentication.\n\n**Owners: Configure remote access protocols on SCADA hosts to limit access, require secure**\nauthentication, and use a trusted path.\n\n**4.** **Lock down all applications, hosts, and networks to limit the consequences of compromise as**\n**much as possible. Once an attacker has gained access to a host, compartmentalization and**\n**access controls can contain them. SCADA customers need better and more concise information**\n**on how their system operates to guide the development of effective network isolation**\n**architectures and configurations. This is necessary to mitigate some of the identified**\n**vulnerabilities and others that may evolve.**\n\n**Vendors: All SCADA system ports and services necessary to support system operation needs to**\nidentified and delineated. Document how SCADA system components use the network so that\neffective firewall and IDS rules can be created. For each SCADA component, the necessary services\nshould be documented along with the associated port ranges and which components are allowed to\ninitiate a connection to that component.\n\n**Owners: Use good defense in-depth perimeter protections to help prevent access to vulnerable**\ncomponents and communication on SCADA networks. Redesign network layouts to take full\nadvantage of firewalls, VPNs, etc. Create security zones using multiple layers, with the most critical\ncommunications occurring in the most secure and reliable layer. Customize IDSs for the SCADA\nhosts and networks. Restrict SCADA user privileges to only those that are required to perform each\nperson’s job (i.e., establishing role-based access control and configuring each role based on the\nprinciple of least privilege).\n\nReplace insecure versions of common IT services where possible with their secure versions. SCADA\nvendors and customers should follow IT security practices and use the current secure versions of\ncommon protocols. When replacement is not feasible, access to the services should be minimized, and\nunencrypted communication should be limited to within the SCADA whenever possible.\nCommunications between security zones should be secured as much as possible.\n\n**5.** **Use proven authentication services when available. Strong authentication and encryption**\n**mechanisms should be implemented and strenuously tested.**\n\n**Vendors: Vendors can audit their applications for strong authentication methods and remediate any**\nweak or vulnerable implementations.\n\n**Owners: Owners can securely configure their authentication settings and regularly audit their**\npasswords and system settings.\n\n**6.** **Remediate vulnerabilities in SCADA services.**\n\n**Vendors: Code can be written to validate input data. All programmers should be trained in secure**\ncoding practices, and all code should be reviewed and tested for input functions that could be\nsusceptible to buffer overflow attacks. All input should be validated, not just those proven to cause\nbuffer overflows.\n\n**Owners: SCADA owners can reduce the risk from vulnerable SCADA services by limiting and**\nmonitoring their access.\n\n**7.** **Redesign SCADA network protocols and the service applications that implement them for**\n**security.**\n\n\n-----\n\n**Vendors: Document how the systems use the network so that effective firewall and IDS rules can be**\ncreated. Create custom protocol parsers for common IDSs so that they can be more effective.\n\n**8.** **Protect SCADA databases.**\n\n**Vendors: Developers should use vetted libraries or frameworks that do not allow SQL injection and**\nXSS weaknesses to occur or provide constructs that make this weakness easier to avoid. Developers\nshould use care when constructing SQL queries, including stored procedures that are located on the\nSQL server itself. They should follow Web programming security guidelines to help mitigate\ncommon mistakes, validate input, and properly encode, escape, and quote output.\n\nFollow the principle of least privilege. Use the strictest permissions possible on all database objects,\nsuch as execute-only for stored procedures.\n\n**Owners: Databases should be replicated out to the DMZ. If an attacker finds and exploits an SQL**\ninjection, he will simply own another server in the DMZ rather than jumping into a more secure\nnetwork.\n\n**9.** **Use secure protocols to access SCADA components.**\n\n**Vendors: Replace the use of insecure protocols in SCADA code with secure alternatives. This may**\nrequire a redesign of data sharing between SCADA components.\n\nProvide secure services and methods for connections to, and remote administration of, SCADA\ndevices.\n\nDeliver SCADA hosts and devices securely configured by default and provide secure configuration\ndocumentation.\n\n**Owners: Uninstall or disable insecure services where possible. Correctly configure services to protect**\ncredentials and provide secure authentication. Use secure protocols to connect to SCADA\ncomponents.\n\n**10.** **Protect user credentials and make them inaccessible to an attacker. Passwords should be**\n**securely encrypted or hashed before being stored or transmitted.**\n\n**Vendors: Implement secure authentication in SCADA applications. Validate that all SCADA**\napplication credentials are securely stored and transferred. When using Web applications with SSL,\nuse SSL for the entire session from login to logout, not just for the initial login page.\n\n**Owners: Correctly configure all applications to securely store and transfer credentials.**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/ICS SCADA/ICS Vulnerabilities/Vulnerability Analysis of Energy Delivery Control Systems.pdf"
    ],
    "report_names": [
        "Vulnerability Analysis of Energy Delivery Control Systems.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536120,
    "ts_updated_at": 1743041280,
    "ts_creation_date": 1314609932,
    "ts_modification_date": 1316080407,
    "files": {
        "pdf": "https://archive.orkl.eu/bc35d1b0700dc2cfdb3dabb183cde40c8a6ef8f0.pdf",
        "text": "https://archive.orkl.eu/bc35d1b0700dc2cfdb3dabb183cde40c8a6ef8f0.txt",
        "img": "https://archive.orkl.eu/bc35d1b0700dc2cfdb3dabb183cde40c8a6ef8f0.jpg"
    }
}