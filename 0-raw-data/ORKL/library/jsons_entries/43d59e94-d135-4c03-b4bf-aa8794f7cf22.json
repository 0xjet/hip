{
    "id": "43d59e94-d135-4c03-b4bf-aa8794f7cf22",
    "created_at": "2022-10-25T16:48:11.87917Z",
    "updated_at": "2025-03-27T02:14:22.175566Z",
    "deleted_at": null,
    "sha1_hash": "73a8169eff8f50cefe587c1097d67fb45e71a046",
    "title": "Operation Woolen-Goldfish When Kittens Go Phishing",
    "authors": "Trend Micro",
    "file_creation_date": "2015-03-19T15:58:12Z",
    "file_modification_date": "2015-03-19T15:58:27Z",
    "file_size": 4715394,
    "plain_text": "## Operation WOOLEN-GOLDFISH\n\n### When Kittens Go Phishing\n\n##### Cedric Pernet and Kenney Lu\n\n\n-----\n\n# Contents\n\nIntroduction.................................................................................................i\n\nVictims and Targets.............................................................................. 1\n\nRocket Kitten’s New Campaign Matures.............................................. 2\n\nThe GHOLE Campaign.................................................................... 2\n\nExport Function: Function............................................................. 2\n\nRelated Samples.......................................................................... 3\n\nUse of Malware Scanner.............................................................. 4\n\nGHOLE Malware Communication and Control............................. 5\n\nOperation Woolen-GoldFish: Rocket Kitten’s New Campaign.......... 7\n\nPoint of Entry................................................................................ 7\n\nInitial Compromise........................................................................ 8\n\nPossible Attribution............................................................................... 8\n\nWool3n.H4t....................................................................................... 8\n\nWool3n.H4t’s Recent Activities: CWoolger Keylogger.................... 10\n\nIndicators of Compromise................................................................... 13\n\nConclusion.................................................................................................ii\n\nReferences...............................................................................................iii\n\nAppendix..................................................................................................iv\n\n\nTREND MICRO LEGAL DISCLAIMER\n\nThe information provided herein is for general\ninformation and educational purposes only. It is not\nintended and should not be construed to constitute\nlegal advice. The information contained herein may\nnot be applicable to all situations and may not reflect\nthe most current situation. Nothing contained herein\nshould be relied on or acted upon without the benefit\nof legal advice based on the particular facts and\ncircumstances presented and nothing herein should\nbe construed otherwise. Trend Micro reserves the\nright to modify the contents of this document at any\ntime without prior notice.\n\nTranslations of any material into other languages\nare intended solely as a convenience. Translation\naccuracy is not guaranteed nor implied. If any\nquestions arise related to the accuracy of a\ntranslation, please refer to the original language\nofficial version of the document. Any discrepancies\nor differences created in the translation are not\nbinding and have no legal effect for compliance or\nenforcement purposes.\n\nAlthough Trend Micro uses reasonable efforts to\ninclude accurate and up-to-date information herein,\nTrend Micro makes no warranties or representations\nof any kind as to its accuracy, currency, or\ncompleteness. You agree that access to and use\nof and reliance on this document and the content\nthereof is at your own risk. Trend Micro disclaims all\nwarranties of any kind, express or implied. Neither\nTrend Micro nor any party involved in creating,\nproducing, or delivering this document shall be liable\nfor any consequence, loss, or damage, including\ndirect, indirect, special, consequential, loss of\nbusiness profits, or special damages, whatsoever\narising out of access to, use of, or inability to use,\nor in connection with the use of this document, or\nany errors or omissions in the content thereof. Use\nof this information constitutes acceptance for use in\n“ i ” diti\n\n\n-----\n\n# Introduction\n\nState-sponsored cyberwarfare is no different than physical battles or terrorist attacks in terms of scope and damage.\nArguably, cyber attacks are much worse because the identity of attackers are easily concealed, slowing down any\nprocess that could bring perpetrators to justice. Attackers are also not restricted by time and location. Interestingly,\nMiddle Eastern countries and some members of the European Union (EU) have recently figured in targeted attacks,\neither as an aggressor or a victim, for seemingly political reasons.\n\nAt the recently concluded “31st Chaos Communication Congress of the Chaos Computer Club (31C3),” cybersecurity\nresearchers discussed the ways and means by which threat actors can use widely available software to cover their\ntracks and carry out their campaigns. [1] The focus of this particular lecture was the GHOLE malware used in targeted\nattack campaigns. GHOLE is believed to have been active since 2011 based on the compilation date of its oldest samples.\n\nTargeted attacks are well-planned cyberthreat activities aimed at specific organizations. In this paper, we delve\ninto the malicious activities of a cyberthreat group, known in the cybersecurity industry as Rocket Kitten, which has\nbeen hitting different public and private Israeli and European organizations. Rocket Kitten has so far launched two\ncampaigns—“GHOLE” malware attacks and one we have dubbed “Operation Woolen-GoldFish.” We named it as\nsuch because “Woolen” is attributed to the malware developer and one of the threat actors behind this campaign;\n“GoldFish” serves as an attribute to the location of origin with which the campaign was seemingly launched from.\n\nThe Rocket Kitten group used spear-phishing emails in order to penetrate their target systems. Based on the malware\nsamples we have obtained from files with macro malware specific to the GHOLE malware campaign, we found that\nthey were mostly interested in the defense industry, the IT sector, government entities, and academic organizations.\nCertain details from the malware samples show that Operation Woolen-GoldFish was most likely to be a statesponsored campaign.\n\n\n-----\n\n### Victims and Targets\n\nThe content of the files we have collected from this group of attackers is quite straightforward. They contain\ninformation that is very customized in relation to the target entity. Some files are written in German, while\nothers contain information specific to just one vertical. All of these have been used for spear-phishing emails\nagainst various targets.\n\nSeeing the content of these files, we suspect they have all been used for spear phishing against the following:\n\n   - Civilian organizations in Israel\n\n   - Academic organizations in Israel\n\n   - German-speaking government organizations\n\n   - European organizations\n\n   - European private company\n\n\n_Attack overview_\n\n\n-----\n\n### Rocket Kitten’s New Campaign Matures\n\n#### The GHOLE Campaign\n\nIn February 2015, the Trend Micro™ Smart Protection Network™ received an alert from Europe that triggered\nseveral targeted attack indicators related to a specific malware family, prompting our threat defense experts\nto investigate further. The alert showed an infected Microsoft™ Excel® file that soon proved to have been\nlaunched by Rocket Kitten. When a user opens the Excel file attachment in the spear-phishing attempt, a .DLL\nfile is dropped onto the system and is executed using a macro embedded in the file. Macros are small scripts\nwithin files that are usually used to automate common repetitive tasks. However, these can also be used for\nmalicious intent, such as infecting machines of unsuspecting users with malware, just like in this situation.\nTrend Micro detects the malware as TROJ_GHOLE.A. It is common for Rocket Kitten to use GHOLE in their\ntargeted attack campaigns. The dropped .DLL file (SHA1 hash: 07a77f8b9f0fcc93504dfba2d7d9d26246e5878f;\nBKDR_GHOLE.B) is scanned on VirusTotal, but there were no results, raising further interest to analyze the\nbinary. [2‒3]\n\nThe .DLL file contained an export function named, “function,” instead of the usual, “gholee,” found in previous\nsamples from this malware family. We suspect that the attacker did this on purpose so the malware can bypass\ndetection and stay within the targeted system that would eventually give it more freedom to move laterally.\n\n##### Export Function: Function\n\nThe top-right boxed code in the screenshot, displayed to the right, shows\nan unusual code that uses “push” to pass values like those shown in the\nscreenshots below it. When passed to WINAPI, it will look like a string on\nstack.\n\nThe first block contains the address of the command-and-control (C&C)\nserver of the malware, which is located at IP address, 83.170.33.60. This\nvalue is specified in the code, as shown in the third screenshot.\n\n\nThe second boxed code in function, ZKXdu80x, is the client version. The\nthird is an encryption key with a length of 256 bytes (2,048 bits) used for\nnetwork communications, and starts with the pattern,\n_GET /index.php?c=xxxxxxxx&r=xxxxx&u=1&t=._\n\nIn all samples we have analyzed, the “c” argument is 8 bytes long and\ndiffers across variants. This can be used as a unique identifier for each\nof the infected machines. The “r” argument has a variable length, 5–7\nbytes; the “u” argument is always 1 byte long.\n\nOther communication patterns can be found in the binary and can be\nused as indicators of compromise:\n\n_•_ _index.php?c=%s&r=%lx_\n\n_•_ _index.php?c=%s&r=%lx&u=1&t=%s_\n\n_•_ _index.php?c=%s&r=%x_\n\n\n_Export function, function_\n\n\n_Use of the “push” mnemonic to_\n_pass values in the code_\n\n\n_IP address_\n\n\n-----\n\n##### Related Samples\n\nWe found several Microsoft Office® files containing variants of the GHOLE malware family that were used to\ninfect machines. As the Excel spreadsheet used in this campaign is disguised to look relevant and important,\nusers were prompted to open it and execute the embedded macro. The use of macros to infect computers is\ndeemed amateur. This shows that there is a gap between the maturity of the malware, which is good enough\nfor its purpose, and the way it is delivered, which raises questions about the attackers’ professional capacity.\n\nWe decided to look at the spear-phishing attempts from a wider perspective and analyzed more samples from\nthis malware family. Based on available evidence, only the Rocket Kitten group is known to have used GHOLE\nin the attacks related to Operation Woolen-GoldFish. It is interesting to note that the GHOLE malware is in fact\na modified CORE IMPACT® product. CORE IMPACT is a sophisticated penetration-testing tool from CORE, a\nlegitimate company. [4]\n\n\n_Sample content from a malicious Office file after_\n\n_running the macro; the content is common and_\n\n_publicly available on the Internet_\n\n\n_Sample content from malicious Microsoft Office files;_\n\n_the attacker needs the user to enable the macro to_\n_infect the computer_\n\n\n-----\n\nAfter studying the sample infected and dropped files, we established a timeline using the dates when the\nexecutable files were compiled. This timeline should be reliable unless the attackers played with the time\nstamps, which would be surprising in this campaign since all binary compilation dates fit quite well with the\nspear-phishing attacks.\n\nAs is often the case with malware families specifically used in targeted attacks, there are actually very few\ndifferent samples in the wild, compared with traditional cybercrime malware.\n\n\n_Number of malware samples compiled_\n\n\nThe Microsoft Office files used by the attackers to infiltrate their targets’ networks are also very interesting\nbecause they contain metadata. Metadata can be defined as “the information about the information,” which\nin this case is the information pertaining to the file itself. Some of details of the available metadata were\nuseful, particularly, the creation date, modification date, author, and last modification author. We will tackle the\nmetadata later on in this paper.\n\n##### Use of Malware Scanner\n\nDuring the course of this investigation, we found out that some samples of the GHOLE malware have been\nsubmitted to an online-malware-scanning site, av.zerodays.ir, to estimate the detection rate of their malware.\n\n[5] Three samples appeared to have been scanned using this service before they appeared elsewhere. One\nsample was submitted 26 days before it was scanned in other online malware analysis service sites. This\nled us to believe that the malware controllers submitted the original samples to the av.zerodays.ir system\nthemselves. We would like to point out that the av.zerodays.ir online service is free and available to everyone\non the Internet. We contacted a representative of the company, who in turn told us that they “do not condone\ncybercrime or in any way affiliated to any entity that could have been part of this campaign.”\n\n\n-----\n\n##### GHOLE Malware Communication and Control\n\nThe communications established by this malware family from an infected workstation\nto the C&C server are done by directly communicating with the IP addresses hardcoded in the binaries, as seen in the export function display. There were no domain\nnames involved in this campaign. We were able to obtain a list of C&C servers, which\nare mostly hosted in Germany, via a satellite communication service provider known\nas Industrieanlagen-Betriebsgesellschaft mbH (IABG): [6]\n\n_•_ _83.170.33.37_\n\n_•_ _83.170.33.60_\n\n_•_ _83.170.43.67_\n\n_•_ _83.170.33.80_\n\n_•_ _84.11.26.230_\n\n_•_ _84.11.75.220_\n\n_•_ _84.11.146.55_\n\nThe last IP address, 84.11.146.55, was associated with one malware sample. It belongs\nto IABG with only the following information available:\n\n_•_ _inetnum: 84.11.146.0 - 84.11.146.255_\n\n_•_ _netname: DE-IABG-TELEPORT-ERTEBATAT_\n\n_•_ _descr: IABG - Teleport customer Ertebatat_\n\n_•_ _country: DE_\n\nThe other IP addresses were used by different malware samples. These IP addresses\nalso belonged to IABG and could all be connected to the same customer. In fact, all of\nthe IP ranges on which these C&C servers are identified belonged to one customer,\nwho rents the following IP ranges from IABG:\n\n_•_ _84.11.26.224–84.11.26.255_\n\n_•_ _84.11.37.128–84.11.37.159_\n\n_•_ _84.11.75.192–84.11.75.255_\n\n_•_ _83.170.33.32–83.170.33.63_\n\n_•_ _83.170.33.64–83.170.33.95_\n\n_•_ _83.170.43.64–83.170.43.95_\n\n\n-----\n\n```\n    netname: DE-IABG-TELEPORT-MAHDAVI_8\n    descr: IABG - Teleport customer Mehdi Mahdavi\n    country: DE\n    person: Mehdi Mahdavi\n    address: No 83 - Baharestan st\n    address: Isfahan\n    address: IR\n    phone: +98 913 115 8009\n    email: mahdavi@livenetsat.com\n\n```\nRegistration for the livenetsat.com domain used here expired in 2010. It was registered using this information:\n\nRegistrant:\n```\n    Mehdi Mahdavi mehdi_mahdavi@yahoo.com +1.5149092726\n    Joinebiz\n    2021 Atwater Street, #1414\n    Montreal,QC,CA H3H-2P2\n\n```\nThe first historical information about this domain, in 2003, has the following details:\n\nRegistrant:\n```\n    Mehdi Mahdavi technical@joinebiz.com 514-989-8066\n    Joinebiz\n    2021 Atwater Street, #1414\n    Montreal, QC, Canada H3H-2P2\n\n```\n\n_Screenshot from joinebiz.com in 2001_\n\n\n_Joinebiz.com was an e-business solution provider that ceased to operate in 2006. Incidentally, it held office in_\nIsfahan, Iran, which is the country Mr. Mehdi Mahdavi used as reference for renting the IP ranges used by the\nGHOLE malware.\n\nThese details can loosely be tied to the entities presented above but caution is strongly advised because the\nnames are quite common. We have yet to determine if these names belong to one person, if the same person\nis the one who rents IP ranges from IABG, if his servers were compromised and used as proxy servers, or if he\nprovides part of his infrastructure to the Operation Woolen-GoldFish targeted attack group.\n\n\n-----\n\n#### Operation Woolen-GoldFish: Rocket Kitten’s New Campaign\n\n##### Point of Entry\n\nSending out spear-phishing emails is a common\ntechnique used as a point of entry in the initial stage\nof compromise. It is, in fact, still widely used in\nattempts to gain privileges in targeted companies’\nsystems. Several social engineering tricks can be\nused to make a user click a link or open a file.\n\nOne of the spear-phishing emails sent out by the\nRocket Kitten group looked like a simple office\ncorrespondence.\n\nThe attachment was a Microsoft Office file. User\nparticipation is needed to execute the macros in the\nfile. If the user does not run the macros, the computer\nwill not be infected by the GHOLE malware. By the\nend of 2014, however, we saw significant changes\nin the attack behavior of the Rocket Kitten group in\nterms of spear-phishing campaigns and malware\ninfection scheme. The second spear-phishing email\nsample has been sent to one target in Israel.\n\nThis email sample was sent sometime in February\n2015. This also used the identity of a recognized\nIsraeli engineer. We anonymized the email address,\nas well as the OneDrive™ link. We also removed the\nsignature used in it.\n\nA known figure in the Israeli defense field was used\nin a similar tactic with the same email content. The\ndecoy file used an Adobe® .PDF file instead of a\nMicrosoft PowerPoint™ presentation. The .PDF file\nwas a Web article from the Washington Post. The file\nshowed “pc12” as the author and the last modifier.\nsystem’s record\n\n\n_Sample spear-phishing email used by the group_\n_in 2014_\n\n\n_Sample spear-phishing email sent to a targeted_\n_organization in Israel_\n\n\n-----\n\n##### Initial Compromise\n\nThe attackers used a OneDrive link in their campaign. OneDrive is a free online cloud\nstorage system from Microsoft that comes with several gigabytes of data storage\ncapacity.\n\nThe OneDrive link leads to an archive file containing a file named, “Iran’s Missiles\n_Program.ppt.exe.” This file, which has been taken offline, used the PowerPoint_\nicon but was really an executable file. The attackers probably decided to store their\nmalicious binaries online rather than sent them as an attachment to bypass email\ndetection.\n\nOnce executed, the file drops a nonmalicious PowerPoint file used as a decoy\nfile, while silently infecting the system with a variant of the CWoolger keylogger.\nWe decided not to show the content of this file given the sensitivity of the persona\nimpersonated in this social engineering lure.\n\nWe tried to look for this decoy file on the Internet but it was nowhere to be found,\nwhich was quite surprising. We compared the metadata on this file with the other\nfiles authored by the spoofed engineer and it showed the same exact file properties,\nparticularly the way the “author” field was written. The file also shows a “Last modified\n_by:” field containing the information pc12._\n\nRocket Kitten has signed pc12 at the last modified section of some of the files used\nin their spear-phishing activities. We do not know if this string refers to one Rocket\nKitten member or to a third party, who could have edited the files. The latter is very\nunlikely though, since it has been used both in campaigns and files aimed at different\ntargets. We believe pc12 is, indeed, an indicator of Rocket Kitten activities.\n\nWe have a strong suspicion, based on the PowerPoint file, that the spoofed\nengineer’s computer was compromised by the Rocket Kitten group because he\npresents an interesting profile and is well-known in his field. Therefore, the file sent to\nother Israeli targets could have been stolen directly from this person’s computer.\n\n### Possible Attribution\n\n#### Wool3n.H4t\n\nCybercriminals quite often forget about metadata, which is generated by the software\nthey use to produce or modify the files. Those who are more meticulous alter this\ninformation to lead investigators to false tracks.\n\n\n_Malware binary_\n_shows the_\n_PowerPoint icon to_\n_trick the user_\n\n\n-----\n\n|SHA1 Hash|Creation Date|Modification Date|Author|Last Modified By|\n|---|---|---|---|---|\n|ec692cf82aef16cf61574b5d15e5c5f8135df288|02/07/2014|30/07/2014|YUSI|YUSI|\n|788d881f3bb2c82e685a98d8f405f375c0ac2162|23/06/2014|27/07/2014|Woole3n.H4t|uk|\n|2c3edde41e9386bafef248b71974659543a3d774|23/06/2014|15/07/2014|Woole3n.H4t|uk|\n|0f4bf1d89d080ed318597754e6d3930f8eec49b0|20/06/2013|01/12/2014|REDACTED|pc12|\n|2627cdc3324375e6f41f93597a352573e45c0f1e|23/06/2014|07/07/2014|Woole3n.H4t|aikido1|\n|ad6c9b003285e01fc6a02148917e95c780c7d751|26/04/2014|28/04/2014|Woole3n.H4t|Hoffman|\n|9579e65e3ae6f03ff7d362be05f9beca07a8b1b3|23/04/2014|23/04/2014|Woole3n.H4t|Woole3n.H4t|\n|4711f063a0c67fb11c05efdb40424377799efafd|02/07/2014|24/07/2014|REDACTED|YUSI|\n|e2728cabb35c210599e248d0da9791991e38eb41|23/06/2014|02/07/2014|Woole3n.H4t|aikido1|\n|ae18bb317909e16f765ba2e88c3d72d648db2798|23/06/2014|27/07/2014|Woole3n.H4t|uk|\n|ed5615ffb5578f1adee66f571ec65a992c033a50|23/04/2014|23/04/2014|Woole3n.H4t|Woole3n.H4t|\n|0482fc2e332918456b9c97d8a9590781095b2b53|29/10/2014|16/12/2014|Woole3n.H4t|uSA|\n|a9245de692c16f90747388c09e9d02c3ee34577e|20/06/2013|11/11/2014|REDACTED|REDACTED|\n|6571f2b9a0aea89f45899b256458da78ac51e6bb|07/08/2014|07/08/2014|YUSI|merah|\n|c727b8c43943986a888a0428ae7161ff001bf603|20/06/2013|01/12/2014|REDACTED|pc12|\n|1a999a131144afe8cb7316ebb842da4f38101ac5|02/07/2014|13/07/2014|YUSI|YUSI|\n|f51de6c25ff8e1d9783ed5ac13a53d1c0ea3ef33|29/10/2014|16/12/2014|Woole3n.H4t|USA|\n\n\n_Microsoft Office files and some of their metadata leaked by the attackers_\n\n\n-----\n\nAs seen above, different authors worked on these files. Wool3n.H4t seemed to be the main author who\ncollaborated with aikido1 and Hoffman. No particular information could be found on aikido1 and Yusi, the\nsupposed partners of Wool3n.h4t. There were also times when Wool3n.H4t used U.S. and U.K. country codes\nas last modification information. The most recent modification in the two PowerPoint files told us that W00l3n.H4t\nslowly changed his infecting methods around October 2014.\n\nThere was not much information on Wool3n.H4t, which is not a common nickname, on the Internet. However,\nwe found that this nickname owned an inactive blog hosted by a free service in Iran and was registered in\nseveral underground hacking forums. The blog only contained two posts signed by Masoud_pk, which could be\npart of the real identity of Wool3nh4t. Masoud is the one of the top 50 commonly used first names in Iran.\n\n\n_Part of wool3n.H4t’s blog showing_\n_“Masoud_pk”_\n\n\n#### Wool3n.H4t’s Recent Activities: CWoolger Keylogger\n\nOne malware sample (SHA1 hash: d5b2b30fe2d4759c199e3659d561a50f88a7fb2e; detected as TSPY_\nWOOLERG.A) surfaced as we tried to look for more information on Wool3n.H4t. [7] We took interest in this\nbecause the binary contained the following debug string:\n\n_•_ _C:\\Users\\Wool3n.H4t\\Documents\\Visual Studio 2010\\Projects\\C-CPP\\CWoolger\\Release\\CWoolger.pdb_\n\nDebug strings are strings that are sometimes left behind in binaries, revealing information about the developer\nbehind the code. This debug string shows us that the binary was compiled by a user account named\n“Wool3n.H4t,” and that the project behind this code was dubbed “CWoolger.”\n\nThis malware is a keylogger, although from a technical point of view, it is not as advanced as its\ncontemporaries. The malware also embedded some File Transfer Protocol (FTP) credentials of the attackers in\nclear text in the binary.\n\nConsistent with the other malware used by the threat actors involved in Operation Woolen-GoldFish, the C&C\nreference is hard-coded as an IP address in the binary. A domain name was not used. Moreover, it lands on the\nsystem with a name, which is very similar to some GHOLE malware variants, NTUSER.dat{…}.exe.\n\nThe malware starts by creating a mutex called “woolger” and creates a copy of itself, %TEMP%\\NTSuser.exe,\nin the TEMP folder before executing it. It creates a VBScript in the same folder named “wsc.vbs.”\n\n\n-----\n\n_The wsc.vbs script in charge of installing the persistence_\n_mechanism of the malware_\n\n\nThe script installs the persistence mechanism of the malware, a link named, “WinDefender,” in the startup\nfolder, which uses the Notepad icon.\n\n\n_Startup folder entry, showing the Notepad icon but leading_\n_to the malware_\n\n\nIt then enables keylogging by calling the SetWindowsHookExW application programming interface (API) and\ncalls SetTimer API to prepare a timer job for uploading the log files.\n\n\n_Keylogging and timer setting_\n\n\nOnce the machine is infected, the keylogger records all keystrokes in %temp%/wlg.dat using the following\nformat:\n```\n    *********************************************************\n    [Windows Title] – [Application Name] ([Language])\n    *********************************************************\n    [Context]\n\n```\n\n-----\n\nThe upload function of this malware ran at specific intervals based on a previous random value. If the log file is\nlarger than 3,000 bytes, an uploadToCnC function will be called to transfer the log file via FTP.\n\n\n_Upload function_\n\n\nThe C&C server reached in our sample is 107.6.181.116, which belongs to SingleHop (AS32475). The\ncredentials used to connect with the FTP server are hard-coded in clear text in the binary. When the file is sent\nto the server, it is renamed using the following format:\n```\n    LOG_(UserName)_[tm_year]_[tm_mon]_[tm_mday]_[tm_hour]_[tm_min]_[tm_sec]\n\n```\n|Member|Type|Meaning|Range|\n|---|---|---|---|\n|tm_sec|int|seconds after the minute|0–61*|\n|tm_min|int|minutes after the hour|0–59|\n|tm_hour|int|hours since midnight|0–23|\n|tm_mday|int|day of the month|1–31|\n|tm_mon|int|months since January|0–11|\n|tm_year|int|years since 1990||\n|tm_wday|int|days since Sunday|0–6|\n|tm_yday|int|days since January 1|0–365|\n|tm_isdst|int|Daylight Saving Time flag||\n\n\n_Source: http://www.cplusplus.com/reference/ctime/tm/_\n\n\nWe have been able to detect other samples of this family acting in a similar way and referenced in the Appendix. One of the\nmost recent samples was compiled on 7 February 2015.\n\n\n-----\n\n### Indicators of Compromise\n\n   - The GHOLE malware campaign infiltrates networks via a spear-phishing\nemail with an attachment containing a malicious macro. It could also contain\na malicious link that leads to Microsoft OneDrive, where the malicious file is\nhosted.\n\n   - The GHOLE malware campaign also sends a GET request to the C&C server,\nstarting with the pattern, GET /index.php?c=xxxxxxxx&r=xxxxx&u=1&t=.\n\n   - Other network communication patterns:\n\n� _index.php?c=%s&r=%lx_\n\n� _index.php?c=%s&r=%lx&u=1&t=%s_\n\n� _index.php?c=%s&r=%x_\n\n   - It uses malware for the final payload detected as GHOLE or WOOLERG.\n\n\n-----\n\n# Conclusion\n\nOperation Woolen-GoldFish is alive and active. From a technical point of view, the threat actors involved in\nthis campaign are less mature in terms of technical capacity and tactic sophistication compared with other\ntargeted attack groups we are monitoring, yet they are improving and gaining traction. The spear-phishing\nemail attacks are getting a little more aggressive and now have less user interaction at the point of entry.\nNevertheless, it is unfortunately not because an attacker is inferior in skills that there are fewer victims.\nOperation Woolen-GoldFish has managed to successfully infiltrate several companies and organizations in\nIsrael and Europe. One PowerPoint file used as a lure in spear-phishing attempts seems to indicate that the\ngroup has successfully victimized one well-known engineer in Israel and used one of his unreleased files\nas bait. Time and again, lack of proper security understanding and implementation has led individual and\ncorporate users around the world to fall victim to creative malicious activities of threat actors. Threat actors\nare also known to be multiskilled.\n\nIn this case, we were able to confirm that Wool3n.H4t was not only responsible for most of the infecting Office\nfiles used, but was also capable of developing malware. The discovery of the CWoolger keylogger compiled\non 7 February 2015 may be the strongest indication that this targeted attack group, where Woole3n.H4t seems\nto a part of, is very active and may be developing its own malware. With Wool3n.H4t as both the malware\ndeveloper and infrastructure controller, it can be loosely deducted that the group comprise of very few people.\n\nSeeing the evolution of this targeted attack group, we believe its members, especially Wool3n.H4t, are\ntraditional or old-fashioned cybercriminals. This assumption is based on the way the campaign spreads and\nevolves, including the use of nicknames and password used by Wool3n.H4t, which indicates that he rather\ncomes from an underground hacking group. This campaign, like the first one the group launched, shows\nthat the targeted entities do have a particular interest for the Islamic Republic of Iran. While motives behind\ntargeted attack campaigns may differ, the end results are one and the same—shift in power control, either\neconomically or politically.\n\nThe authors would like to thank Ilja Lebedev for his valuable input in this research.\n\n\n-----\n\n# References\n\n[1] Gadi Evron and Tillmann Werner. (28 December 2014). 31st Chaos\n_Communication Congress of the Chaos Computer Club (31C3)._\n“Rocket Kitten: Advanced Off-the-Shelf Targeted Attacks Against\nNation States.” Last accessed on 10 March 2015,\n[https://www.youtube.com/watch?v=WIhKovlHDJ0.](https://www.youtube.com/watch?v=WIhKovlHDJ0)\n\n[2] Trend Micro Incorporated. (2015). Threat Encyclopedia. “BKDR_\nGHOLE.B.” Last accessed on 13 March 2015,\n[http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/](http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/BKDR_GHOLE.B)\n[BKDR_GHOLE.B.](http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/BKDR_GHOLE.B)\n\n[3] VirusTotal. (2015). VirusTotal Scan. Last accessed on 10 March 2015,\n[https://www.virustotal.com/.](https://www.virustotal.com/)\n\n[4] Pierluigi Paganini. (9 September 2014). Security Affairs. “Clearsky\nDetected Gholee Malware—The Israel-Gaza Conflict Takes to the\nCyber Arena.” Last accessed on 11 March 2015,\n[http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.](http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.html)\n[html.](http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.html)\n\n[5] ZeroVirus. (2015). Virus Scanner. Last accessed on 11 March 2015,\n[http://av.zerodays.ir/.](http://av.zerodays.ir/)\n\n[6] Industrieanlagen-Betriebsgesellschaft mbH. (2015). IndustrieanlagenBetriebsgesellschaft mbH. Last accessed on 11 March 2015,\n[http://www.iabg.de/en/.](http://www.iabg.de/en/)\n\n[7] Trend Micro Incorporated. (2015). Threat Encyclopedia. “TSPY_\nWOOLERG.A.” Last accessed on 13 March 2015,\n[http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/](http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/TSPY_WOOLERG.A)\n[TSPY_WOOLERG.A.](http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/TSPY_WOOLERG.A)\n\n\n-----\n\n# Appendix\n\nThis section provides the list of SHA1 hashes found in relation to Operation Woolen-GoldFish and their\ncorresponding Trend Micro detection names.\n\n|SHA1 Hashes|Trend Micro Detection Names|\n|---|---|\n|GHOLE Malware Campaign||\n|8074ed48b99968f5d36a494cdeb9f80685beb0f5|BKDR_GHOLE.A|\n|e6964d467bd99e20bfef556d4ad663934407fd7b|BKDR_GHOLE.A|\n|fd8793ce4ca23988562794b098b9ed20754f8a90|TROJ_GHOLE.A|\n|6e30d3ef2cd0856ff28adce4cc012853840f6440|BKDR_GHOLE.A|\n|07a77f8b9f0fcc93504dfba2d7d9d26246e5878f|BKDR_GHOLE.B|\n|25d3688763e33eac1428622411d6dda1ec13dd43|TROJ_GHOLE.A|\n|729f9ce76f20822f48dac827c37024fe4ab8ff70|TROJ_GHOLE.A|\n|86222ef166474e53f1eb6d7e6701713834e6fee7|TROJ_GHOLE.A|\n|476489f75fed479f19bac02c79ce1befc62a6633|TROJ_GHOLE.A|\n|c1edf6e3a271cf06030cc46cbd90074488c05564|TROJ_GHOLE.A|\n|c6db3e7e723f20ed3bcf4c53fc4748e9591f4c40|BKDR_GHOLE.A|\n|cabdfe7e9920aeaa5eaca7f5415d97f564cdec11|TROJ_GHOLE.A|\n|ce03790d1df81165d092e89a077c495b75a14013|BKDR_GHOLE.A|\n|e8dbcde49c7f760165ebb0cb3452e4f1c24981f5|TROJ_GHOLE.A|\n\n\n-----\n\n|SHA1 Hashes|Trend Micro Detection Names|\n|---|---|\n|efd1c6a926095d36108177045db9ad21df926a6e|TROJ_GHOLE.A|\n|fa5b587ceb5d17f26fe580aca6c02ff2e20ad3c4|TROJ_GHOLE.A|\n|fe3436294f302a93fbac389291dd20b41b038cba|TROJ_GHOLE.A|\n|ffead364ae7a692afec91740d24649396e0fa981|TROJ_GHOLE.A|\n|0b0cdf47363fd27bccbfba6d47b842e44a365723|TROJ_GHOLE.A|\n|02b04563ef430797051aa13e48971d3490c80636|TROJ_GHOLE.A|\n|7ad0eb113bc575363a058f4bf21dbab8c8f7073a|TROJ_GHOLE.A|\n|7fef48e1303e40110798dfec929ad88f1ad4fbd8|BKDR_GHOLE.A|\n|22f6a61aa2d490b6a3bc36e93240d05b1e9b956a|TROJ_GHOLE.A|\n|37ad0e426f4c423385f1609561422a947a956398|BKDR_GHOLE.A|\n|47b1c9caabe3ae681934a33cd6f3a1b311fd7f9f|BKDR_GHOLE.A|\n|53340f9a49bc21a9e7267173566f4640376147d9|TROJ_GHOLE.A|\n|58045d7a565f174df8efc0de98d6882675fbb07f|BKDR_GHOLE.A|\n|62172eee1a4591bde2658175dd5b8652d5aead2a|TROJ_GHOLE.A|\n|Related Macro-based Malware||\n|788d881f3bb2c82e685a98d8f405f375c0ac2162|X2KM_DROPPR.DF|\n|2627cdc3324375e6f41f93597a352573e45c0f1e|X2KM_DROPPR.DF|\n|4711f063a0c67fb11c05efdb40424377799efafd|X2KM_DROPPR.DF|\n|6571f2b9a0aea89f45899b256458da78ac51e6bb|X2KM_DROPPR.DH|\n|9579e65e3ae6f03ff7d362be05f9beca07a8b1b3|X2KM_DROPPR.DF|\n\n\n-----\n\n|SHA1 Hashes|Trend Micro Detection Names|\n|---|---|\n|a9245de692c16f90747388c09e9d02c3ee34577e|X2KM_DROPPR.DG|\n|ad6c9b003285e01fc6a02148917e95c780c7d751|X2KM_DROPPR.DF|\n|ae18bb317909e16f765ba2e88c3d72d648db2798|X2KM_DROPPR.DF|\n|c727b8c43943986a888a0428ae7161ff001bf603|X2KM_DROPPR.DF|\n|e2728cabb35c210599e248d0da9791991e38eb41|X2KM_DROPPR.DF|\n|ec692cf82aef16cf61574b5d15e5c5f8135df288|X2KM_DROPPR.DF|\n|ed5615ffb5578f1adee66f571ec65a992c033a50|X2KM_DROPPR.DF|\n|0f4bf1d89d080ed318597754e6d3930f8eec49b0|X2KM_DROPPR.DF|\n|CWoolger Keylogger (WOOLERG.A)||\n|a42f1ad2360833baedd2d5f59354c4fc3820c475|TSPY_WOOLERG.A|\n|d5b2b30fe2d4759c199e3659d561a50f88a7fb2e|TSPY_WOOLERG.A|\n|5d334e0cb4ff58859e91f9e7f1c451ffdc7544c3|TSPY_WOOLERG.A|\n\n\n-----\n\nTrend Micro Incorporated, a global leader in security software, strives to make the\nworld safe for exchanging digital information. Our innovative solutions for consumers,\nbusinesses and governments provide layered content security to protect information\non mobile devices, endpoints, gateways, servers and the cloud. All of our solutions\nare powered by cloud-based global threat intelligence, the Trend Micro™ Smart\nProtection Network™, and are supported by over 1,200 threat experts around the\n[globe. For more information, visit www.trendmicro.com.](http://www.trendmicro.com/us/index.html)\n\n225 E. John Carpenter Freeway\n\n© 2015 by Trend Micro, Incorporated. All rights reserved. Trend Micro and the Suite 1500\nTrend Micro t-ball logo are trademarks or registered trademarks of Trend Micro, Irving, Texas\nIncorporated. All other product or company names may be trademarks or registered 75062 U.S.A.\ntrademarks of their owners.\n\nPhone: +1.817.569,8900\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://documents.trendmicro.com/assets/wp/wp-operation-woolen-goldfish.pdf",
        "https://app.box.com/s/pqe4y802utfswg27g3jeyaup46zje5b0",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.03.19.Goldfish_Phishing/wp-operation-woolen-goldfish.pdf"
    ],
    "report_names": [
        "wp-operation-woolen-goldfish.pdf",
        "wp-operation-woolen-goldfish"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e034b94b-9655-42c4-a72e-a58807dce299",
            "created_at": "2022-10-25T16:07:24.133537Z",
            "updated_at": "2025-03-27T02:02:10.118581Z",
            "deleted_at": null,
            "main_name": "Rocket Kitten",
            "aliases": [
                "Group 83",
                "NewsBeef",
                "Newscaster",
                "Operation Newscaster",
                "Operation Woolen-GoldFish",
                "Parastoo",
                "Rocket Kitten"
            ],
            "source_name": "ETDA:Rocket Kitten",
            "tools": [
                "CoreImpact (Modified)",
                "FireMalv",
                "Ghole",
                "Gholee"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8faa11f5-2a14-479c-9ea8-3779e6de9749",
            "created_at": "2022-10-25T15:50:23.814205Z",
            "updated_at": "2025-03-27T02:00:55.551798Z",
            "deleted_at": null,
            "main_name": "Ajax Security Team",
            "aliases": [
                "Ajax Security Team",
                "Operation Woolen-Goldfish",
                "AjaxTM",
                "Rocket Kitten",
                "Flying Kitten",
                "Operation Saffron Rose"
            ],
            "source_name": "MITRE:Ajax Security Team",
            "tools": [
                "sqlmap",
                "Havij"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b0261705-df2e-4156-9839-16314250f88a",
            "created_at": "2023-01-06T13:46:38.373617Z",
            "updated_at": "2025-03-27T02:00:02.817313Z",
            "deleted_at": null,
            "main_name": "Rocket Kitten",
            "aliases": [
                "Operation Woolen-Goldfish",
                "Thamar Reservoir",
                "Timberworm",
                "TEMP.Beanie",
                "Operation Woolen Goldfish"
            ],
            "source_name": "MISPGALAXY:Rocket Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041662,
    "ts_creation_date": 1426780692,
    "ts_modification_date": 1426780707,
    "files": {
        "pdf": "https://archive.orkl.eu/73a8169eff8f50cefe587c1097d67fb45e71a046.pdf",
        "text": "https://archive.orkl.eu/73a8169eff8f50cefe587c1097d67fb45e71a046.txt",
        "img": "https://archive.orkl.eu/73a8169eff8f50cefe587c1097d67fb45e71a046.jpg"
    }
}