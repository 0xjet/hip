{
    "id": "bdf07846-b2f7-4e70-9c3e-987f7f0fe9d4",
    "created_at": "2023-01-12T15:07:03.266626Z",
    "updated_at": "2025-03-27T02:15:35.539598Z",
    "deleted_at": null,
    "sha1_hash": "0e978670d703f9ffe151cab1c9291781dbb309c5",
    "title": "2021-08-12 - Threat Thursday- Ficker Infostealer Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T23:14:30Z",
    "file_modification_date": "2022-05-28T23:14:30Z",
    "file_size": 1817238,
    "plain_text": "# Threat Thursday: Ficker Infostealer Malware\n\n**[blogs.blackberry.com/en/2021/08/threat-thursday-ficker-infostealer-malware](https://blogs.blackberry.com/en/2021/08/threat-thursday-ficker-infostealer-malware)**\n\nThe BlackBerry Research & Intelligence Team\n\nFicker is a malicious information-stealer that is sold and distributed on underground\nRussian online forums by a threat actor using the alias @ficker. This Malware-as-a-Service\n(MaaS) was first uncovered in the wild in mid-2020.\n\nFicker has been previously distributed via Trojanized web links and compromised websites.\nFor example, it could direct victims to pages purportedly offering free downloads of\nlegitimate paid services like Spotify and YouTube Premium. It has also recently been\ndeployed via the known malware downloader, [Hancitor.](https://blogs.blackberry.com/en/2021/07/threat-thursday-hancitor-malware)\n\nNotably [written in Rust, Ficker has several targets for its information stealing, including web](https://blogs.blackberry.com/en/2021/07/old-dogs-new-tricks-attackers-adopt-exotic-programming-languages)\nbrowsers, credit card information, crypto-wallets, FTP clients and other applications. Along\nwith anti-analysis checks, the malware can also deploy further functionality and download\nadditional malware once a system is successfully compromised.\n\n### Operating System\n\n\n-----\n\n### Risk & Impact\n\nFicker offers several paid packages, with different levels of subscription fees to use their\nmalicious program. Once the malware subscription is purchased, the malware author\nprovides a web-based panel to the buyer to collect and examine information stolen from\nvictims, as well as the executable of the information stealer itself.\n\n_Figure 1: Ficker is named after its creator/promoter_\nThe creator of the malware is frequently active on the forums related to the malware, as\nseen in the image below:\n\n\n-----\n\n_Figure 2: Translated update log from malware author_\n\nSince its introduction last year, Ficker has been deployed in a wide variety of ways. This is\nlikely due to multiple threat actors using the malware differently in smaller individual\ncampaigns.\n\nIn its early days, Ficker victims had mostly downloaded and executed the threat accidentally\nafter visiting compromised websites or inadvertently clicking on malicious web links. Threat\nactors will often create fake ads for legitimate and popular services to lure unsuspecting\nusers into visiting or clicking on Trojanized material.\n\nFor example, Ficker has previously been hosted on lure pages masquerading as a\n“Microsoft® Store” webpage, to entice users to download malicious applications while lulling\nthem into a false sense of security.\n\n### Hancitor\n\nIn recent months, Ficker has been deployed and dropped by the known malware family\n[Hancitor. Hancitor’s attack chain often begins with the threat actor sending out fake](https://blogs.blackberry.com/en/2021/07/threat-thursday-hancitor-malware)\nDocuSign malspam emails, which results in a victim unknowingly downloading a Trojanized\nMicrosoft® Word document, thinking they are getting a real DocuSign doc.\n\nOnce the fake DocuSign document is opened and its malicious macro code is allowed to\nrun, Hancitor will often reach out to its command and control (C2) infrastructure to receive a\nmalicious URL containing a sample of Ficker to download, as seen below:\n\n_Figure 3: Example of Hancitor downloading Ficker infostealer_\n\nDepending on the commands the Hancitor C2 sends, Ficker is often injected into an\ninstance of svchost.exe on a victim’s machine, as seen below. It does this to further avoid\ndetection and hide the activity of this malicious executable.\n\n\n-----\n\n_Figure 4: Process Flow of Ficker via Hancitor initial infection_\n\n### Anti-Analysis and Initial Checks\n\nWhen analyzing the file statically, we found that Ficker is heavily obfuscated. It also\ncontains multiple anti-analysis checks, which are meant to thwart analysis and prevent the\nmalware from executing in virtualized environments.\n\nThe malware author has also included checks so that the malware will not execute if it is\nrunning in selected countries, which is likely intended to protect the threat actors who tend\nto purchase such malware. Ficker achieves this by checking the keyboard layout of the\nvictim’s machine. If their keyboard layout is related to one of these nations, the malware will\nterminate:\n\n**Keyboard Layout** **Country**\n\nru-RU Russia\n\nbe-BY Belarus\n\nUz-UZ Uzbekistan\n\nhy-AM Armenia\n\nkk-KZ Kazakhstan\n\n\n-----\n\naz-AZ Azerbaijan\n\nTo do this, Ficker will reach out to the web API at api[.]ipify[.]org. This is a public IP address\nweb API used by the malware to gather the external IP address of the victim’s device. The\nthreat likely uses this as another anti-virtualized environment check, as the malware will not\nreach out to its C2 infrastructure if it doesn’t get a successful response to this API call.\n\nOnce the victim’s IP address is obtained, the malware will attempt to reach out to its C2\nserver. If a response is sent successfully, the malware will receive its configuration\ncommands to perform its desired actions. If the malware cannot obtain such information\nfrom this API call, it will wait until an Internet connection is re-established before reaching\nout to its C2.\n\n### Stolen Data\n\nUnlike traditional information stealers, Ficker does not write its stolen data to disk.\nTraditional infostealer families will often store a local copy of the data it intends to steal, and\nthen exfiltrate it after a set period of time. Instead, Ficker loops through its instructions and\nsends its information directly to the operator of the malware.\n\nThe malware author has designed Ficker to have another unique feature: decrypting stolen\ndata server-side rather than “victim-side.” This is likely done to avoid detection, but it also\ngives Ficker’s creator greater control over who is allowed to use their malware.\n\nWhen sending stolen data, Ficker will initially encrypt it using an XOR rotation. During\nanalysis, it appears that the same XOR key (0x0A) is used across all samples.\n\nDepending on its commands, Ficker will attempt to exfiltrate the following information:\n\nChromium web browsers\n\nSaved login credentials\nCookies\nAuto-compete history\nMozilla-based web-browsers.\n\nSaved login credentials\nCookies\nAuto-complete history\nCredit card information\nCryptocurrency wallets\nFileZilla FTP client\nWinScp FTP client\nDiscord login\n\n\n-----\n\nSteam accounts\nPidgin accounts\nThunderbird accounts\n\nThe malware will also gather system information, as shown below:\n\n_Figure 5: Decoded system information sent by Ficker to its C2_\n\n\n-----\n\nThe malware also has screen-grab abilities, which allow the malware s operator to remotely\ncapture an image of the victim’s screen. The malware also enables file-grabbing and\nadditional downloading capabilities once connection to its C2 is established, as shown\nbelow. This enables further stages of exploitation on a victim’s device.\n\n_Figure 6: Example of Ficker dashboard_\n\nOnce information is sent back to Ficker’s C2, the malware operator can access and search\nfor all exfiltrated data.\n\n### YARA Rule\n\nThe following YARA rule was authored by the BlackBerry Research & Intelligence Team to\ncatch the threat described in this document:\n\n\n-----\n\nimport \"pe\"\n\nrule Mal_Infostealer_Win32_Ficker_Stealer\n\n{\nmeta:\n\ndescription = \"Yara rule to detect Ficker Stealer\"\n\nauthor = \"Blackberry Threat Research Team\"\n\ndate = \"04-08-2021\"\n\nstrings:\n\n$x1 = \"kindmessage\"\n\n$x2 = \"SomeNone\"\n\n$x3 = \".Kind\"\n\ncondition:\n\n//PE File\n\nuint16(0) == 0x5A4D and\n\n// Must have the following sections in the following order\n\npe.section_index(\".text\") == 0 and\n\npe.section_index(\".data\") == 1 and\n\npe.section_index(\".rdata\") == 2 and\n\npe.section_index(\"/4\") == 3 and\n\npe.section_index(\".bss\") == 4 and\n\npe.section_index(\".idata\") == 5 and\n\npe.section_index(\".CRT\") == 6 and\n\npe.section_index(\".tls\") == 7 and\n\n// Must be less than\n\nfilesize < 300KB and\n\n//One of $x\n\n(2 of ($x*))\n\n}\n\n### Indicators of Compromise (IoCs)\n\n\n-----\n\nOperating System: Windows\n\n### Mutex\n\nserhershesrhsfesrf\nhrth\no;jtfytyjftyjftyjftyj;ijo;\nijlhlkwaftyjftyjftjftyh;joi;i\nah;waeh;jftyjftyjfiftfdgaf\nhotyjftyj;afdh\nwhftyjftyjftyjtfyjtfyjtfyj;ijo;h\nwhoareyoutellmeandilltellwhoyou\n\n**Network Communication**\n\n**Ficker Download IOC:**\n\n**Domain** **Created** **Registrar**\n\ns0lom0n[.]ru/7hsjfd9w4refsd[.]exe  \nmin0sra[.]ru/7t4dfgnmkk7[.]exe  \nfalan4zadron[.]ru/7hsjfd9w4refsd.exe  \n4a5ikol[.]ru/7jkio8943wk[.]exe  \npirocont70l[.]ru/7hjujnfds[.]exe  \n**Ficker C2:**\n\n**Domain** **Created** **Registrar**\n\npospvisis[.]com January 19, 2021  \nfunctionalrejh[.]com September 22, 2020  \nasfasfvcxvdbs[.]com July 7, 2021  \n### BlackBerry Assistance\n\n\n-----\n\nIf you’re battling Ficker malware or a similar threat, you’ve come to the right place,\nregardless of your existing BlackBerry relationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated to](https://www.blackberry.com/us/en/services/incident-response)\nhandling response and containment services for a wide range of incidents, including\nransomware and Advanced Persistent Threat (APT) cases.\n\nWe have a global consulting team standing by to assist you providing around-the-clock\nsupport, where required, as well as local assistance. Please contact us here:\n\nhttps://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incident-responsecontainment\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats,\nproviding intelligence analysis for the benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-12 - Threat Thursday- Ficker Infostealer Malware.pdf"
    ],
    "report_names": [
        "2021-08-12 - Threat Thursday- Ficker Infostealer Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536023,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1653779670,
    "ts_modification_date": 1653779670,
    "files": {
        "pdf": "https://archive.orkl.eu/0e978670d703f9ffe151cab1c9291781dbb309c5.pdf",
        "text": "https://archive.orkl.eu/0e978670d703f9ffe151cab1c9291781dbb309c5.txt",
        "img": "https://archive.orkl.eu/0e978670d703f9ffe151cab1c9291781dbb309c5.jpg"
    }
}