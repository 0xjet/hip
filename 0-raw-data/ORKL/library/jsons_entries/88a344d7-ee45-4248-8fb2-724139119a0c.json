{
    "id": "88a344d7-ee45-4248-8fb2-724139119a0c",
    "created_at": "2023-01-12T14:58:50.894497Z",
    "updated_at": "2025-03-27T02:06:15.845518Z",
    "deleted_at": null,
    "sha1_hash": "d2b54489eda50933ed9502c65a15fe8a576f1f2b",
    "title": "2018-02-08 - DarkSky Botnet",
    "authors": "",
    "file_creation_date": "2022-05-28T19:27:25Z",
    "file_modification_date": "2022-05-28T19:27:25Z",
    "file_size": 886331,
    "plain_text": "# DarkSky Botnet\n\n**blog.radware.com/security/2018/02/darksky-botnet/**\n\nFebruary 8, 2018\n\nRadware’s Threat Research has recently discovered a new botnet, dubbed DarkSky.\nDarkSky features several evasion mechanisms, a malware downloader and a variety of\nnetwork- and application-layer DDoS attack vectors. This bot is now available for sale for\nless than $20 over the Darknet.\n\nAs published by its authors, this malware is capable of running under Windows XP/7/8/10,\nboth x32 and x64 versions, and has anti-virtual machine capabilities to evade security\ncontrols such as a sandbox, thereby allowing it to only infect ‘real’ machines.\n\n## Background\n\nRadware has been monitoring this malware since its early versions in May, 2017. Developers\nhave been enhancing its functionality and released the latest version in December, 2017. Its\npopularity and use is increasing.\n\n\n-----\n\nOn New Year’s Day, 2018, Radware witnessed a spike in different variants of the malware.\nThis is suspected to be the result of an increase in sales or testing of the newer version\nfollowing its launch. However all communication requests were to the same host\n(“http://injbot.net/”), a strong indication of “testing” samples.\n\n## Infection Methods\n\nRadware suspects the bot spreads via traditional means of infection such as exploit kits,\nspear phishing and spam emails.\n\n## Capabilities\n\n1. Perform DDoS Attack:\n\nThe malware is capable of performing DDoS attacks using several vectors:\n\nDNS Amplification\nTCP (SYN) Flood\nUDP Flood\nHTTP Flood\n\n\n-----\n\nFigure 2: DarkSky attack panel\nThe server also has a “Check Host Availability” function to check if the DDoS attack\nsucceeded. When the malware performs HTTP DDoS attack, it uses the HTTP structure\nseen below. In the binaries, Radware witnessed hard-coded lists of User-Agents and\nReferers that are randomly chosen when crafting the HTTP request.\n\nFigure 3: HTTP structure\n\n1. Downloader\n\nThe malware is capable of downloading malicious files from a remote server and executing\nthe downloaded files on the infected machine. After looking at the downloaded files from\nseveral different botnets, Radware noticed cryptocurrency-related activity where some of the\nfiles are simple Monero cryptocurrency miners and others are the latest version of the\n“1ms0rry” malware associated with downloading miners and cryptocurrencies.\n\n\n-----\n\nFigure 4: Darksky communication to the server\n\n1. Proxy\n\nThe malware can turn the infected machine to a SOCKS/HTTP proxy to route traffic through\nthe infected machine to a remote server.\n\n**_[[You might also like: JenX – Los Calvos de San Calvicie]](https://blog.radware.com/security/2018/02/jenx-los-calvos-de-san-calvicie/)_**\n\n**Malware Behavior**\n\nThe malware has a quick and silent installation with almost no changes on the infected\nmachine. To ensure persistence on the infected machine it will either create a new key under\nthe registry path “RunOnce” or create a new service on the system:\n\n1. HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\Registry Driver\n2. HKLM\\System\\CurrentControlSet\\Services\\Icon Codec Service\\\n\n## Communication\n\nWhen the malware executes, it will generate an HTTP GET request to “/activation.php?key=”\nwith a unique User-Agent string “2zAz.” The server will then respond with a “Fake 404 Not\nFound” message if there are no commands to execute on the infected machine.\n\n\n-----\n\nFigure 5: Example of HTTP GET request and 404 Not Found\n**Communication Obfuscation Example**\n\nThe GET request param value is base64 encrypted.\n\nThe final readable string contains infected machine information as well as user information.\nWhen a new command is sent from the server “200 OK,” a response return is executed with\nthe request to download a file from the server or execute a DDoS attack (see Figure below).\n\n**Evasion**\n\nWhen the malware executes it will perform several anti-virtual machine checks:\n\n1. VMware:\n\n1. Dbghelp.dll\n2. Software\\Microsoft\\ProductId != 76487-644-3177037-23510\n\n\n-----\n\n2. Vbox:\n\n1. VBoxService.exe\n2. VBoxHook.dll\n3. Sandboxie\n\n1. SbieDll.dll\n\nIt will also look for the Syser kernel debugger presence searching for the following devices:\n\n1. \\\\.\\Syser\n2. \\\\.\\SyserDbgMsg\n3. \\\\.\\SyserBoot\n\n**_[[You might also like: Malware and Botnet Attack Services Found on the Darknet]](https://blog.radware.com/security/2016/07/malware-and-botnet-attack-services-found-on-the-darknet/)_**\n\n## IOCs\n\n Effective DDoS Protection Essentials\n\n\n-----\n\n**[Hybrid DDoS Protection – On-premise and cloud DDoS protection for real-time](https://www.radware.com/products/cloud-ddos-services/)** DDoS\nattack prevention that also addresses high volume attacks and protects from pipe\nsaturation\n**Behavioral-Based Detection – Quickly and accurately identify and block anomalies**\nwhile allowing legitimate traffic through\n**Real-Time Signature Creation – Promptly protect from unknown threats and zero-day**\nattacks\n**A Cyber-Security Emergency Response Plan – A dedicated emergency team of**\nexperts who have experience with Internet of Things security and handling IoT\noutbreaks\n**Intelligence on Active Threat Actors – high fidelity, correlated and analyzed date for**\npreemptive protection against currently active known attackers.\n\nFor further [network and application protection measures, Radware urges companies to](https://www.radware.com/solutions/ddos-protection/)\ninspect and patch their network in order to defend against risks and threats.\n\n**Learn More at DDoS Warriors**\n\nTo know more about today’s attack vector landscape, understand the business impact of\n[cyber-attacks or learn more about emerging attack types and tools visit DDoSWarriors.com.](https://security.radware.com/)\n[Created by Radware’s Emergency Response Team (ERT), it is the ultimate resource for](https://www.radware.com/Products/ERT/)\neverything security professionals need to know about DDoS attacks and cyber security.\n\n### Read “2017-2018 Global Application & Network Security Report” to learn more.\n\n[Download Now](https://www.radware.com/social/ert-report-2017/?utm_source=RadwareBlog&utm_campaign=FixedCTA&utm_term=7840)\n\n### LEAVE A REPLY\n\nPlease enter your comment!\n\nPlease enter your name here\n\nYou have entered an incorrect email address!\n\nPlease enter your email address here\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-02-08 - DarkSky Botnet.pdf"
    ],
    "report_names": [
        "2018-02-08 - DarkSky Botnet.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535530,
    "ts_updated_at": 1743041175,
    "ts_creation_date": 1653766045,
    "ts_modification_date": 1653766045,
    "files": {
        "pdf": "https://archive.orkl.eu/d2b54489eda50933ed9502c65a15fe8a576f1f2b.pdf",
        "text": "https://archive.orkl.eu/d2b54489eda50933ed9502c65a15fe8a576f1f2b.txt",
        "img": "https://archive.orkl.eu/d2b54489eda50933ed9502c65a15fe8a576f1f2b.jpg"
    }
}