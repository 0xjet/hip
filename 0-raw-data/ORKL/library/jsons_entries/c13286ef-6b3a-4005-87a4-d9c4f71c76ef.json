{
    "id": "c13286ef-6b3a-4005-87a4-d9c4f71c76ef",
    "created_at": "2023-01-12T15:01:05.267554Z",
    "updated_at": "2025-03-27T02:16:39.971295Z",
    "deleted_at": null,
    "sha1_hash": "8aa12fc67bc6f52652a2f72dd5f816abcf2018e8",
    "title": "2020-10-07 - GhostDNSbusters (Part 2)",
    "authors": "",
    "file_creation_date": "2022-05-28T00:25:13Z",
    "file_modification_date": "2022-05-28T00:25:13Z",
    "file_size": 1115749,
    "plain_text": "# GhostDNSbusters (Part 2)\n\n**team-cymru.com/blog/2020/10/07/ghostdnsbusters-part-2/**\n\nS2 Research Team View all posts by S2 Research Team October 7, 2020\n\n**[This research was undertaken in collaboration with Manabu Niseki (@ninoseki on Twitter) and CERT.br (https://cert.br).](https://cert.br/)**\n\n**Manabu is a Tokyo-based researcher who has been tracking GhostDNS for a number of years. His leads and insight into**\n**GhostDNS assisted in confirming the findings documented in this blog post.**\n\n**We will continue to collaborate with CERT.br on a shared goal of identifying the threat actors operating the**\n**infrastructure detailed in this blog.**\n\nThis post picks up where we left off in our [September 8, 2020 blog post titled “GhostDNSbusters”. In that post, we identified:](https://team-cymru.com/blog/2020/09/08/ghostdnsbusters/)\n\nIP addresses being used by miscreants to compromise home routers\nIP addresses of rogue DNS servers\nDomain names affected by those DNS servers, directing users to phishing pages\n\nThis post will provide details on newly identified GhostDNS infrastructure, provide information about the phishing servers in use,\nand enumerate additional domain names targeted by miscreants.\n\nInfrastructure Groups\n\nDuring the process of identifying active GhostDNS-related infrastructure, we observed several distinct “groups” of servers. Most\ninvolve a single DNS resolver and a single HTTP server used to host the phishing pages. However, one group uses six different\nDNS resolvers and two HTTP servers, and changes the HTTP servers on a weekly basis.\n\nInternal Name Timeframe Observed DNS Server(s) HTTP Server(s) TTL Wildcard DNS?\n\n\nCDD 14-MAY – current 45.62.198.73\n45.62.198.74\n\n45.62.198.89\n\n45.62.198.242\n\n45.62.198.243\n\n162.248.164.36\n\n\nTwo, which rotate each Monday.\nFor the week of Oct 5:\n\n45.62.198.165\n\n45.62.198.166\n\n\n60 YES\n\n\nEDA 18-AUG – current 149.56.152.185 149.56.79.217 10800 NO\n\nTOS 12-SEP – current 144.217.42.134 192.99.208.102 10800 NO\n\nDDS 10-SEP – 23-SEP 107.155.152.20 107.155.152.26 10800 NO\n\nODA 08-AUG – current 107.155.152.13 70.37.165.155 10800 NO\n\n_Table 1: List of recently active GhostDNS infrastructure_\n\nThe bottom four groups shown in Table 1 are configured in a similar way. Each has a single DNS server, which acts as\nauthoritative for a distinct list of targeted domain names. When the domain name, or select hostnames within them are queried,\nthe servers respond with the IP address of their associated phishing HTTP server. That response has a “time-to-live” of 10800\n(measured in seconds, which is three hours).\n\nFor example, here are some example queries and results from the “EDA” group, starting with one of the targeted domain names:\n\n\n-----\n\n_Figure 1: Example query for a domain poisoned by the “EDA” DNS server_\n\nA query for the “www” hostname within that domain will also point to the phishing IP address:\n\n_Figure 2: Example hostname query for a domain poisoned by the “EDA” DNS server_\n\nHowever, DNS wildcards are not used by this group, as seen here:\n\n_Figure 3: Example NXDOMAIN query for a domain poisoned by the “EDA” DNS server_\n\nIn the figure above (Figure 3), we see that the “img.americanas.com.br” query isn’t directed to the phishing server. Instead, a\nNXDOMAIN response is returned, which indicates that the hostname does not exist. (In reality, that hostname does exist, but\nsince this DNS server is (maliciously) configured to be authoritative for the americanas.com.br. zone (domain), but doesn’t\ncontain a record for the “img” hostname, and isn’t configured to perform DNS wildcarding, it returns an NXDOMAIN response.)\n\nIn contrast to the behavior observed by the other infrastructure groups, the CDD group takes a different approach. For all DNS\nzones that the DNS server is configured to answer authoritatively for, any hostname query will return a response with the IP\naddress of a phishing HTTP server. Here’s an example:\n\n\n-----\n\n_Figure 4: Example wildcard response for a domain poisoned by a “CDD” DNS server_\n\nAlso unique to the CDD group (compared to the four others mentioned in this blog post) are the weekly rotation of phishing\nservers, and the availability of SSL/TLS on them. CDD’s phishing servers have a self-signed x.509 certificate that is reused when\nthey rotate in new phishing servers. The x.509 certificate in use recently changed, presumably because it was due to expire\nsoon.\n\nCertificate observed prior to 2020-09-24:\n```\nsubject= /C=BR/ST=SAO PAULO/L=OSASCO/O=Google. Inc./OU=Principal/CN=SAY MY NAME/emailAddress=localserver@google.com\nissuer= /C=BR/ST=SAO PAULO/L=OSASCO/O=Google. Inc./OU=Principal/CN=SAY MY NAME/emailAddress=localserver@google.com\nserial=D7AF0B2CBAD8370B\nlocalserver@google.com\nnotBefore=Oct 8 23:28:42 2019 GMT\nnotAfter=Oct 7 23:28:42 2020 GMT\nMD5: FCB3ECAA96C6A9026CD933281A30551F\nSHA1: 4E04C2D45F37D7D4E757C27A0A0735B503F319E4\n\n```\nCertificate observed after 2020-09-24:\n```\nsubject= /C=BR/ST=CATARINA/L=SUL/O=SULAMERICA/OU=SULAMERICA APPS/CN=MANITO MIGUELITO/emailAddress=manito@miguelito.com\nissuer= /C=BR/ST=CATARINA/L=SUL/O=SULAMERICA/OU=SULAMERICA APPS/CN=MANITO MIGUELITO/emailAddress=manito@miguelito.com\nserial=B7BDA9E48E5D2B43\nmanito@miguelito.com\nnotBefore=Sep 24 19:44:55 2020 GMT\nnotAfter=Sep 24 19:44:55 2021 GMT\nMD5: EE8CF31BE39C5BC046BF5EB25FDACC80\nSHA1: 8D9B394BA67D1913566115094C1AD0257FEFF26E\n\n```\nThis reuse of x.509 certificates allows us to identify new and historical phishing servers used by this group, as we can use\n[Augury to show us where/when this x.509 certificate has been observed.](https://team-cymru.com/products/augury/)\n\nTargeted Domains\n\n[Similar to the earlier blog post in this series, Passive DNS (PDNS) and DNS Query datasets from Augury were utilized in order to](https://team-cymru.com/products/augury/)\nprovide further context around the nature of the requests being targeted by the attackers – for which their rogue DNS servers\nprovide redirects to phishing pages. Each group has a unique list of domains that are hijacked. The following is a list of targeted\ndomain names in use by recently-active GhostDNS servers, broken down by the “Internal Name” indicated earlier in this article:\n\n\n-----\n\nCDD EDA TOS DDS ODA\n\n\nbanco.bradesco\nbancobrasil.com.br\n\nbb.com.br\n\nbradesco.com.br\n\nbradesconetempresa.b.br\n\ncaixa.gov.br\n\nitau.b.br\n\nitau.com.br\n\nitaupersonnalite.com.br\n\nsantander.com.br\n\nsantandernet.com.br\n\nsantandernetibe.com.br\n\nsicredi.com.br\n\n\namericanas.com.br\nbanco.bradesco\n\nbb.com.br\n\nbradescocelular.com.br\n\nbradesco.b.br\n\nbradesco.com.br\n\nbradescopj.com.br\n\nbradescoprime.com.br\n\ncaixa.gov.br\n\ncef.com.br\n\ncitibank.com\n\ncitibank.com.br\n\nhotmail.com\n\nhotmail.com.br\n\nitau.com.br\n\nitaupersonnalite.com.br\n\nlive.com\n\nlojasamericanas.com.br\n\nmsn.com\n\nmsn.com.br\n\nnetflix.com\n\noutlook.com\n\npaypal.com\n\nsantander.com.br\n\nsantandernet.com.br\n\nsantandernetibe.com.br\n\nshoptime.com.br\n\nterra.com.br\n\n\namericanas.com.br\nbanco.bradesco\n\nbancobrasil.com.br\n\nbb.com.br\n\nbradescocelular.com.br\n\nbradesco.b.br\n\nbradesco.com.br\n\nbradescopj.com.br\n\nbradescoprime.com.br\n\ncaixa.gov.br\n\ncef.com.br\n\ncitibank.com\n\ncitibank.com.br\n\nitau.com.br\n\nitaupersonnalite.com.br\n\nnetflix.com\n\npaypal.com\n\nsantander.com.br\n\nsantandernet.com.br\n\nsantandernetibe.com.br\n\nshoptime.com.br\n\nsubmarino.com.br\n\n\namericanas.com.br\nbanco.bradesco\n\nbb.com.br\n\nbradescocelular.com.br\n\nbradesco.b.br\n\nbradesco.com.br\n\nbradescopj.com.br\n\nbradescoprime.com.br\n\ncaixa.gov.br\n\ncef.com.br\n\ncitibank.com\n\ncitibank.com.br\n\nitau.com.br\n\nitaupersonnalite.com.br\n\nsantander.com.br\n\nsantandernet.com.br\n\nsantandernetibe.com.br\n\nshoptime.com.br\n\n\nbanco.bradesco\nbradescocelular.com.br\n\nbradesco.b.br\n\nbradesco.com.br\n\nbradescopj.com.br\n\nbradescoprime.com.br\n\ncaixa.gov.br\n\ncef.com.br\n\n\n_Table 2: List of domains targeted by each active GhostDNS infrastructure_\n\nExamples of Real Site vs. Phishing Sites\n\nHere, we show a snapshot of the real Web site for banco.bradesco, as it appears in Internet Explorer 11:\n\n\n-----\n\n_Figure 5: Snapshot of the resulting page when typing “banco.bradesco” into IE11 and pressing Enter_\n\nWe did not specify HTTPS when accessing the page – we simply typed banco.bradesco into the address bar and pressed Enter.\nAs seen in the above screenshot (Figure 7), the address bar shows that we were taken to an SSL-encrypted URL. Also, because\nthe address bar is highlighted in green, we know that the SSL (x.509) certificate presented for this session is a valid, EV\ncertificate, issued by a trusted certificate authority.\n\nWhen the same action (typing banco.bradesco into the address bar and pressing Enter) is taken, but using the phishing server in\nuse by the “EDA” group, the result is a non-encrypted page, using an outdated background, copied from the banco.bradesco site:\n\n_Figure 6: Snapshot of the banco.bradesco page, as served by the “EDA” group phishing server_\n\nAs seen in Figure 8, the page served by the “EDA” phishing server does not show an SSL-enabled connection in the address\nbar. A similar experience is observed when performing the same action, but using the “CDD” group phishing server:\n\n\n-----\n\n_Figure 7: Snapshot of the banco.bradesco page, as served by the CDD group phishing server_\n\nWhen using a URL that specifies SSL (HTTPS), the “EDA” phishing server doesn’t respond, as the server is not listening on the\nport used by HTTPS (443/tcp).\n\n_[Figure 8: Snapshot of attempting to access https://banco.bradesco/, via the “EDA” group phishing server](https://banco.bradesco/)_\n\nAttempting to access the same (HTTPS) URL when using the “CDD” phishing server will cause an SSL certificate mismatch error\nto be displayed in the browser, as seen here:\n\n_[Figure 9: Snapshot of attempting to access https://banco.bradesco/, via the “CDD” group phishing server](https://banco.bradesco/)_\n\nIndicators of Compromise\n\n**NOTE: This list contains GhostDNS-related DNS server and HTTP server IP addresses, as identified as active at some point**\nbetween our previous GhostDNS blog post (September 8, 2020) and this one. Earlier indicators of compromise are available at\nthe end of [that blog post.](https://team-cymru.com/blog/2020/09/08/ghostdnsbusters/)\n\nRogue DNS servers [10]\n\n45.62.198.73\n\n45.62.198.74\n\n45.62.198.89\n\n\n-----\n\n45.62.198.242\n\n45.62.198.243\n\n107.155.152.13\n\n107.155.152.20\n\n144.217.42.134\n\n149.56.152.185\n\n162.248.164.36\n\nHTTP Phishing servers [13]\n\n45.62.198.154\n\n45.62.198.155\n\n45.62.198.156\n\n45.62.198.157\n\n45.62.198.160\n\n45.62.198.161\n\n45.62.198.162\n\n45.62.198.163\n\n45.62.198.165\n\n45.62.198.166\n\n70.37.165.155\n\n107.155.152.26\n\n149.56.79.215\n\n149.56.79.217\n\n192.99.208.102\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-07 - GhostDNSbusters (Part 2).pdf"
    ],
    "report_names": [
        "2020-10-07 - GhostDNSbusters (Part 2).pdf"
    ],
    "threat_actors": [
        {
            "id": "6b9fc913-06c6-4432-8c58-86a3ac614564",
            "created_at": "2022-10-25T16:07:24.185236Z",
            "updated_at": "2025-03-27T02:02:10.135195Z",
            "deleted_at": null,
            "main_name": "SideWinder",
            "aliases": [
                "APT-C-17",
                "APT-Q-39",
                "BabyElephant",
                "GroupA21",
                "HN2",
                "Hardcore Nationalist",
                "Rattlesnake",
                "Razor Tiger",
                "SideWinder",
                "T-APT-04"
            ],
            "source_name": "ETDA:SideWinder",
            "tools": [
                "BroStealer",
                "Capriccio RAT",
                "callCam"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "173f1641-36e3-4bce-9834-c5372468b4f7",
            "created_at": "2022-10-25T15:50:23.349637Z",
            "updated_at": "2025-03-27T02:00:55.450857Z",
            "deleted_at": null,
            "main_name": "Sidewinder",
            "aliases": [
                "Sidewinder",
                "T-APT-04"
            ],
            "source_name": "MITRE:Sidewinder",
            "tools": [
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d0c0a5ea-3066-42a5-846c-b13527f64a3e",
            "created_at": "2023-01-06T13:46:39.080551Z",
            "updated_at": "2025-03-27T02:00:02.992026Z",
            "deleted_at": null,
            "main_name": "RAZOR TIGER",
            "aliases": [
                "SideWinder",
                "APT-C-17",
                "T-APT-04"
            ],
            "source_name": "MISPGALAXY:RAZOR TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535665,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1653697513,
    "ts_modification_date": 1653697513,
    "files": {
        "pdf": "https://archive.orkl.eu/8aa12fc67bc6f52652a2f72dd5f816abcf2018e8.pdf",
        "text": "https://archive.orkl.eu/8aa12fc67bc6f52652a2f72dd5f816abcf2018e8.txt",
        "img": "https://archive.orkl.eu/8aa12fc67bc6f52652a2f72dd5f816abcf2018e8.jpg"
    }
}