{
    "id": "516e1972-3916-4f13-9883-6f819e3f23a3",
    "created_at": "2023-01-12T15:07:54.361674Z",
    "updated_at": "2025-03-27T02:09:18.138855Z",
    "deleted_at": null,
    "sha1_hash": "9021b886631848275da4b4520f195193179305da",
    "title": "2021-06-30 - MTR in Real Time- Hand-to-hand combat with REvil ransomware chasing a $2.5 million pay day",
    "authors": "",
    "file_creation_date": "2022-05-28T23:50:31Z",
    "file_modification_date": "2022-05-28T23:50:31Z",
    "file_size": 1118114,
    "plain_text": "# MTR in Real Time: Hand-to-hand combat with REvil ransomware chasing a $2.5 million pay day\n\n**news.sophos.com/en-us/2021/06/30/mtr-in-real-time-hand-to-hand-combat-with-revil-ransomware-chasing-a-2-5-**\nmillion-pay-day/\n\nTilly Travers June 30, 2021\n\n_A few weeks ago, a mid-sized, 24/7 media company that had moved critical activities online_\n_[during the pandemic, found itself locked in live combat with REvil ransomware attackers](https://news.sophos.com/en-us/2021/06/11/relentless-revil-revealed/)_\n_determined to secure a multi-million-dollar pay-out. The attack failed, but the company has_\n_yet to fully recover._\n\nIn early June 2021, a detection of Cobalt Strike on the network of a mid-size media company\ntriggered a security alert. Cobalt Strike is a remote access agent that is widely used by\nadversaries as a precursor to ransomware attack.\n\nAttackers released ransomware a few hours later at 4 am local time. For the next four hours,\nthe target’s IT team and Sophos’ [Rapid Response team were locked in live combat with the](https://www.sophos.com/en-us/products/managed-threat-response/rapid-response.aspx)\nhuman adversaries orchestrating the attack.\n\nThe attack ultimately failed, but not before the attackers encrypted the data on unprotected\ndevices, deleted online backups, and decimated one online and undefended domain.\n\nThe ransom note left on encrypted devices demanded a payment of $2.5 million and was\n[signed by REvil, also known as Sodinokibi.](https://news.sophos.com/en-us/2021/06/11/relentless-revil-revealed/)\n\n## How it began\n\n\n-----\n\nREvil is a ransomware-as-a-service offering, which means that criminal customers can lease\nthe malware from the developers and then use their own tools and resources to target and\nperform the attack. The target for this particular REvil customer was a media company with\napproximately 600 computing devices – 25 of them servers – and three Active Directory\ndomains, which were critical to the company’s ability to maintain its 24/7 operations.\n\n## The rush to remote and online operations\n\nLike so many organizations during the early stages of the COVID-19 pandemic, the target\nhad rushed to equip and enable a remote workforce, and not all devices carried the same\nlevel of protection. The company also decided to internet-connect a network that was\npreviously air-gapped. Unfortunately, these actions would come back to bite them.\n\nOnce the intruders were inside the network, they made straight for the unprotected devices\nand other online systems they could gain access to, installing their attack tools and using\nthem to spread the attack to other devices.\n\n## The unfolding attack\n\nWhen Sophos’ Rapid Response team arrived on the scene, they discovered that the\nattackers had already managed to compromise a number of accounts and had been able to\nmove unimpeded between unprotected computers.\n\n“One of the biggest challenges for incident response is a lack of visibility about what’s\nhappening on unprotected devices,” said Paul Jacobs, incident response lead, Sophos. “We\ncan see and block inbound attacks coming from these devices to a protected endpoint, but\nwe can’t centrally remove the intruder from those devices or see what they’re up to.”\n\nThe team also looked at the software applications installed on devices to check for any that\nmight be used as part of the attack.\n\n“As a result of the pandemic, it’s not unusual to find remote access applications installed on\nemployee devices,” said Jacobs. “When we saw Screen Connect on 130 endpoints, we\nassumed it was there intentionally to support people working from home. It turned out the\ncompany knew nothing about it – the attackers had installed the software to ensure they\ncould maintain access to the network and compromised devices.”\n\nThis was just one of several mechanisms the attackers implemented to maintain persistence.\nThe attackers also created their own domain admin account as a fallback after stealing\nanother set of domain admin credentials.\n\n## Hand-to-hand combat\n\n\n-----\n\nAs the attack became noisier, the attackers knew they would be detected and blocked. We\ncould tell that they knew we were there, and they were doing everything they could to defeat\nus,” said Jacobs. “Our security products have a behavioral feature called CryptoGuard that\ndetects and blocks attempts to encrypt files even if the source is a remote, unprotected\ndevice. Once we started to see such detections, we knew the ransomware had been\nunleashed and the battle was on.”\n\nThe attackers tried repeatedly to breach protected devices and encrypt files, launching\nattacks from different unprotected devices they had been able to compromise.\n\nEvery attempt needed to be blocked and investigated to ensure there was nothing else going\non and that there was no further damage – even though by then the next attack attempt was\nalready underway. This task was made harder than normal because the organization needed\nto keep most of its servers online to support the 24/7 broadcasting systems.\n\nEventually, the onslaught began to slow down. By day two, inbound attacks were still\ndetected intermittently but it was clear the main attack attempt was over and had failed.\n\n## The aftermath\n\nAs the incident responders and the company’s IT security team took stock, they found that\ndamage was mainly limited to the unprotected devices and domains. The previously airgapped, online domain was completely destroyed and needed to be rebuilt and online\nbackups had been deleted, but the company wasn’t totally crippled by the attack, and it didn’t\nneed to pay the exorbitant ransom. Despite this, the return to full operations has been a slow\nprocess and is ongoing at the time of publication.\n\n## The lessons learned\n\n“In most cases, by the time we are called in the attack has already taken place, and we are\nthere to help contain, neutralize and investigate the aftermath,” said Peter Mackenzie,\nmanager of Sophos Rapid Response. “On this occasion we were there as the final stage of\nthe attack unfolded and could see at first hand the determination and growing frustration of\nthe attackers, who threw everything at us, from as many directions as they could.”\n\nSophos experts believe there are two important lessons defenders can take away from this\nincident:\n\n1. The first is about risk management. When you make changes to your environment, for\n\nexample, changing a network from air-gapped to online as in the case of this business,\nyour level of risk changes. New areas of vulnerability open up and IT security teams\nneed to understand and address that\n\n\n-----\n\n2. The second is about preserving data. The first compromised account in this attack\n\nbelonged to one of the IT team. All the data had been wiped and this meant that\nvaluable information, such as details of the original breach, which could have been\nused for forensic analysis and investigation was lost. The more information is kept\nintact, the easier it is to see what happened and to ensure it can’t happen again\n\n## Recommendations\n\nSophos recommends the following best practices to help defend against REvil and other\nfamilies of ransomware and related cyber-attacks:\n\n1. Monitor and respond to alerts – Ensure the appropriate tools, processes, and\n\nresources (people) are available to monitor, investigate and respond to threats seen in\nthe environment. Ransomware attackers often time their strike during off-peak hours, at\nweekends or during the holidays, on the assumption that few or no staff are watching\n2. Set and enforce strong passwords – Strong passwords serve as one of the first lines\n\nof defense. Passwords should be unique or complex and never re-used. This is easier\nto do if you provide staff with a password manager that can store their credentials\n3. Multi Factor Authentication (MFA) – Even strong passwords can be compromised.\n\nAny form of multifactor authentication is better than none for securing access to critical\nresources such as e-mail, remote management tools, and network assets\n4. Lock down accessible services – Perform scans of your organization’s network from\n\nthe outside and identify and lock down the ports commonly used by VNC, RDP, or other\nremote access tools. If a machine needs to be reachable using a remote management\ntool, put that tool behind a VPN or zero-trust network access solution that uses MFA as\npart of its login\n5. Segmentation and Zero-Trust – Separate critical servers from each other and from\n\nworkstations by putting them into separate VLANs as you work towards a zero-trust\nnetwork model\n6. Make offline backups of information and applications, keep them up to date and\n\nkeep a copy offline\n7. Inventory your assets and accounts – Unprotected and unpatched devices in the\n\nnetwork increase risk and create a situation where malicious activities could pass\nunnoticed. It is vital to have a current inventory of all connected computers and IOT\ndevices. Use network scans and physical checks to locate and catalog them\n8. Install layered protection to block attackers at as many points as possible – and\n\nextend that security to all endpoints that you allow onto your network\n9. Product configuration – Under-protected systems and devices are vulnerable too. It\n\nis important that you ensure security solutions are configured properly and to check\nand, where necessary, update security policies regularly. New security features are not\nalways enabled automatically\n\n\n-----\n\n10. Active Directory (AD) – Conduct regular audits on all accounts in AD, ensuring that\n\nnone have more access than is needed for their purpose. Disable accounts for\ndeparting employees as soon as they leave the company\n11. Patch everything – Keep Windows and other software up to date. This also means\n\ndouble checking that patches have been installed correctly and, in particular, are in\nplace for critical systems like internet-facing machines or domain controllers\n\n## Additional advice for security leadership\n\n1. Understand the tactics, techniques and procedures (TTPs) that attackers [can use](https://news.sophos.com/en-us/2021/05/18/the-active-adversary-playbook-2021/)\n\nand how to spot the [early warning signs of an imminent attack](https://news.sophos.com/en-us/2020/08/04/the-realities-of-ransomware-five-signs-youre-about-to-be-attacked)\n2. Have an incident response plan that is continuously reviewed and updated to reflect\n\nchanges in your IT environment and business operations and how they impact your\nsecurity posture and level of risk\n3. Turn to external support if you don’t have the resources or expertise in house to\n\nmonitor activity on the network or respond to an incident. Ransomware is often\nunleashed at the end of attack, so you need both dedicated anti-ransomware\n[technology and human-led threat hunting to detect the tell-tale tactics, techniques, and](https://www.sophos.com/en-us/products/managed-threat-response.aspx)\nprocedures that indicate an attacker is in or attempting to get into the environment\n[4. If you do get hit, there are incident response experts available 24/7 you can call on to](https://www.sophos.com/en-us/products/managed-threat-response/rapid-response.aspx)\n\ncontain and neutralize the attack\n\n_Technical information on the tactics, techniques and procedures (TTPs) used in this and_\n_other REvil attacks can be found in the following companion articles, What to Expect When_\n_You’ve Been Hit with REvil Ransomware, and Relentless REvil, Revealed: RaaS as Variable_\n_as the Criminals Who Use It._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-30 - MTR in Real Time- Hand-to-hand combat with REvil ransomware chasing a $2.5 million pay day.pdf"
    ],
    "report_names": [
        "2021-06-30 - MTR in Real Time- Hand-to-hand combat with REvil ransomware chasing a $2.5 million pay day.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536074,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653781831,
    "ts_modification_date": 1653781831,
    "files": {
        "pdf": "https://archive.orkl.eu/9021b886631848275da4b4520f195193179305da.pdf",
        "text": "https://archive.orkl.eu/9021b886631848275da4b4520f195193179305da.txt",
        "img": "https://archive.orkl.eu/9021b886631848275da4b4520f195193179305da.jpg"
    }
}