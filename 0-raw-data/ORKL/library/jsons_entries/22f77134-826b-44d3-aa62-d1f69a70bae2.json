{
    "id": "22f77134-826b-44d3-aa62-d1f69a70bae2",
    "created_at": "2022-10-25T16:48:20.848048Z",
    "updated_at": "2025-03-27T02:17:00.81853Z",
    "deleted_at": null,
    "sha1_hash": "936cb9520f2670cdb6a69623ece2fffc36e27aa2",
    "title": "WhisperGate Malware Update - Emerging Threat",
    "authors": "",
    "file_creation_date": "2022-02-01T18:32:33Z",
    "file_modification_date": "2022-02-01T18:32:33Z",
    "file_size": 841601,
    "plain_text": "# HUNTER\n## EMERGING THREATS\n\n### WHISPERGATE MALWARE - UPDATE\n\n#### Cyborg Security has published additional hunt packages, as well as updated a hunt package already available in the Hunter platform, as a result of additional analysis and research of the WhisperGate attack. These new packages work to identify techniques employed by WhisperGate specifically, as well as broader techniques employed by multiple malware variants. Each of the packages help to identify a portion of the attack chain observed by the stage 2 and stage 3 binaries utilized in the WhisperGate attack against the Ukrainian government in January 2022. Multiple packages were developed around general techniques, with the intent to identify future attacks by the same group or malware, even if revisions are made, as well as other malwares employing techniques in similar ways.\n\n\n-----\n\n### Threat Summary\n\n#### The WhisperGate malware variant was first identified by the MSTIC (Microsoft Threat Intelligence center) on January 13, 2022 and has attributed to the nation-state threat group given the name \\\"DEV-0586\\\" (temporary name given by MS until origin/identity is received).\n\n This threat group has been observed conducting operations on Ukrainian government and organizations, during the geopolitical tensions between Ukraine and Russia. Specific Intent and targets was not identified in the MSTIC article but due to the political climate, systems within or associated to Ukraine should be prepared accordingly - as of today, there has been dozens of impacted systems identified and potentially growing that fall under that umbrella.\n\n\n#### The variant has been observed as a Wiper, disguised as ransomware - similar to the NotPetya attack in 2017. Seen in both variants, a ransom demand is displayed upon boot but is deceptive, as the malware wipes data files rather than encrypting them like typical ransomware does. The intent is destruction rather than using the data as leverage. Although currently targeting Ukraine, the potentiality of this malware or a modified version of it or its techniques being utilized by another threat group is possible.\n\n\n-----\n\n### Synopsis\n\nThe WhisperGate malware variant was discovered targeting Ukraine government and\norganizations in early January by the MSTIC, and identified as a form of Wiper malware that is\nmasquerading as ransomware. With that being said, although the variant is designed to be\nransomware, there is no intention of allowing the recovery of the data that is affected. This\nreveals that the intent of the actor is seeking damage, rather than leverage with infections.\n\n\nThe malware has been observed to have two stages, the first is the overwriting of the Master\nBoot Records - this is where the fake ransom note is revealed as well to the victim. Due to the\nMaster Boot Record being corrupted/overwritten, the recovery of the system if the user decides\nto potentially reboot or shutdown/startup. The MSTIC report mentions that the ransom note is\nunusual in the way it is crafted as well, with the irregularities including the same explicit\npayment amounts and wallet addresses being specified for each note and the absence of a\ncustom ID that a victim is usually told to reference in communications.\n\nThe second stage that has been observed is the execution of a downloader (identified as\nStage2.exe), that pulls the next stage malware and executes in memory. The malware then\nsprawls and corrupts files in specified directories on the system with specific file extensions (the\nspecific extensions can be found in the MSTIC report). The corruption entails the overwriting of\nthe contents of the file and renaming them with a random extension.\n\nFurther information regarding WhisperGate, as well as the extensions mentioned and IOCs\nidentified can be found at the original MSTIC article at:\nhttps://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainianorganizations\n\n\n-----\n\n### Hunt Packages\n\n**[Sign up for Free HUNTER Access](https://huntwithcyb.org/etsignup)**\n\n**AdvancedRun/InstallUtil Utilities Executed From Unusual Directory**\nAs part of stage3 and stage4 of the WhisperGate malware attack, the WhisperGate malware dropped\nAdvancedRun.exe to the host's temp directory, and copied InstallUtil.exe from it's default location to\nAppData\\Local\\Temp. In the case of InstallUtil.exe, the malware utilized this for process hallowing to have\na legitimate appearing binary running malicious code injected by WhisperGate. The AdvancedRun.exe\nutility was utilized by WhisperGate to further impair Windows Defender beyond the path exclusions\nadded by a VBS file.\n**[https://hunter.cyborgsecurity.io/details/use-case/74aab14a-4f32-498c-8e9d-d13cfd064744](https://hunter.cyborgsecurity.io/details/use-case/74aab14a-4f32-498c-8e9d-d13cfd064744)**\n\n\n**Microsoft Defender Overly Broad Exclusion Change via PowerShell - Potential Malware**\n**Infection**\nMicrosoft Windows Defender can be modified via PowerShell Set-MpPrefernce function. This allows\nsetting exclusions for folders, processes, extensions, IPs as well as other configuration changes. Although a\npackage already available in Hunter could identify when the Set-MpPreference was utilized\n[(https://hunter.cyborgsecurity.io/details/use-case/aa6e2535-e1e3-4f0f-80e4-68cc47fc2684), this package](https://hunter.cyborgsecurity.io/details/use-case/aa6e2535-e1e3-4f0f-80e4-68cc47fc2684)\nfocuses more on the specific folders being added as exclusions. The logic was developed based on\nresearch performed by Cyborg Security analysts, revealing several commands performed by PowerShell to\ninhibit Windows Defender's abilities to protect the compromised host. In the WhisperGate attack, the C:\\\n\"folder\" (root drive) was added as an excluded path. Cyborg Security analysts took this a step further and\nadded other commonly abused folders by malware, which may be attempted in future attacks to exclude\nfrom monitoring or protection.\n**[https://hunter.cyborgsecurity.io/details/use-case/32aa754b-f078-4d7f-aceb-ffc9b74d1191](https://hunter.cyborgsecurity.io/details/use-case/32aa754b-f078-4d7f-aceb-ffc9b74d1191)**\n\n**VBS File Written to AppData\\Local\\Temp Directory - Potential Defense Evasion**\nAnalysis and research revealed the stage3 binary associated with the WhisperGate malware attack on the\nUkrainian government, the use of a VBS file dropped into the host's temp directory. This VBS file, located\nin AppData\\Local\\Temp, was utilized to run PowerShell commands to impair Windows Defender.\n**[https://hunter.cyborgsecurity.io/details/use-case/b75bbec2-6ef3-4914-b640-3771c613f183](https://hunter.cyborgsecurity.io/details/use-case/b75bbec2-6ef3-4914-b640-3771c613f183)**\n\n**Windows Defender Bypass via Deleting the Directory - CommandLine Arguments**\nThis packages identifies the activity surrounding command-line arguments that are executed to remove\nthe Windows Defender directory (C:\\ProgramData\\Microsoft\\Windows Defender) via PowerShell script\nblock logging.\n**[https://hunter.cyborgsecurity.io/details/use-case/d489b464-2127-4cd5-bf32-56fbd32ddef7](https://hunter.cyborgsecurity.io/details/use-case/d489b464-2127-4cd5-bf32-56fbd32ddef7)**\n\n**Execute Payload as Trusted Installer**\nThis will identify the use of administrative tools to execute a payload as a Trusted Installer in order to\nelevate privileges and bypass security controls.\n**[https://hunter.cyborgsecurity.io/details/use-case/d8160c37-219d-43c4-a975-90770d2e4437](https://hunter.cyborgsecurity.io/details/use-case/d8160c37-219d-43c4-a975-90770d2e4437)**\n\n\n-----\n\n### Hunt Packages Continued\n\n**[Sign up for Free HUNTER Access](https://huntwithcyb.org/etsignup)**\n\n**Windows Defender Tampering - Possible Malware Activity**\n**[https://hunter.cyborgsecurity.io/details/use-case/aa6e2535-e1e3-4f0f-80e4-68cc47fc2684](https://hunter.cyborgsecurity.io/details/use-case/d489b464-2127-4cd5-bf32-56fbd32ddef7)**\n\n**DLL File Dropped in AppData Directory Matching WhisperGate Schema**\n**[https://hunter.cyborgsecurity.io/details/use-case/e37582e3-f7dc-4d40-907f-9b2a3063a1db](https://hunter.cyborgsecurity.io/details/use-case/d489b464-2127-4cd5-bf32-56fbd32ddef7)**\n\n**Potential Download from Discord - Known Malware Delivery Technique**\n**[https://hunter.cyborgsecurity.io/details/use-case/f03300e2-df9f-4b3b-8fae-2ff170e4aa38](https://hunter.cyborgsecurity.io/details/use-case/d489b464-2127-4cd5-bf32-56fbd32ddef7)**\n\n\n**Network Activity to Discord By Non-Discord App - Possible Malware Payload Delivery**\n**[https://hunter.cyborgsecurity.io/details/use-case/f5f4d9cc-b4cd-40eb-af06-a5dfa03b95fb](https://hunter.cyborgsecurity.io/details/use-case/d489b464-2127-4cd5-bf32-56fbd32ddef7)**\n\n**WScript Executing VBS From Temp Folder Locations - Potential Malware**\n**[https://hunter.cyborgsecurity.io/details/use-case/5b2420d4-68de-47a8-bce3-123e918ee2ff](https://hunter.cyborgsecurity.io/details/use-case/d489b464-2127-4cd5-bf32-56fbd32ddef7)**\n\n\n-----\n\n### Context\n\n#### MITRE: Technique Names:\n\n\n#### Tactic Names: \n Command and Control Privilege Escalation Defense Evasion Execution\n\n\n#### InstallUtil Access Token Manipulation Command and Scripting Interpreter Visual Basic Trusted Developer Utilities Proxy Execution PowerShell Disable or Modify Tools Process Injection Ingress Tool Transfer Web Service Threat Names:\n WhisperGate Meteor\n\n\n-----\n\n### References\n\n**https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-**\n**ukraine-9d5d158f19f3**\n\n**https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-**\n**ukrainian-organizations/**\n\n**https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-**\n**ukrainian-organizations/**\n\n**https://www.reliaquest.com/blog/threat-advisory-whispergate-malware-attacks-against-**\n**ukrainian-systems/**\n\n\n**https://github.com/Neo23x0/signature-**\n**base/blob/master/yara/apt_ua_wiper_whispergate.yar**\n\n**https://www.virustotal.com/gui/file/a196c6b8ffcb97ffb276d04f354696e2391311db3841ae16c8c**\n**9f56f36a38e92**\n\n**[https://github.com/CyberSoldiers/IOCs/blob/main/WhisperGate](https://threatpost.com/deadringer-targeted-exchange-servers-before-discovery/168300/)**\n\n**https://github.com/cado-**\n**security/DFIR_Resources_Whispergate/tree/58742dbebb54cf1d34a16d045515f1df6a7c405d**\n\n**https://securityboulevard.com/2022/01/ttps-used-by-dev-0586-apt-group-in-whispergate-**\n**attack-targeting-ukraine/**\n\n**[https://thehackernews.com/2022/01/experts-find-strategic-similarities-bw.html](https://thehackernews.com/2022/01/experts-find-strategic-similarities-bw.html)**\n\n**https://research.nccgroup.com/2020/06/23/wastedlocker-a-new-ransomware-variant-**\n**developed-by-the-evil-corp-group**\n\n**https://www.winhelponline.com/blog/run-program-as-trustedinstaller-locked-registry-keys-**\n**files/**\n\n**https://www.zdnet.com/article/researchers-break-down-whispergate-wiper-malware-used-**\n**in-ukraine-website-defacement/**\n\n**[https://unit42.paloaltonetworks.com/ukraine-cyber-conflict-cve-2021-32648-whispergate/](https://unit42.paloaltonetworks.com/ukraine-cyber-conflict-cve-2021-32648-whispergate/)**\n\n**https://docs.microsoft.com/en-us/windows-server/administration/windows-**\n**commands/wscript**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://info.cyborgsecurity.com/hubfs/Emerging%20Threats/WhisperGate%20Malware%20Update%20-%20Emerging%20Threat.pdf"
    ],
    "report_names": [
        "WhisperGate%20Malware%20Update%20-%20Emerging%20Threat.pdf"
    ],
    "threat_actors": [
        {
            "id": "025b7171-98f8-4391-adc2-66333629c715",
            "created_at": "2023-06-23T02:04:34.120175Z",
            "updated_at": "2025-03-27T02:02:09.797581Z",
            "deleted_at": null,
            "main_name": "Cadet Blizzard",
            "aliases": [
                "DEV-0586",
                "Operation Bleeding Bear",
                "Ruinous Ursa"
            ],
            "source_name": "ETDA:Cadet Blizzard",
            "tools": [
                "GO Simple Tunnel",
                "GOST",
                "Impacket",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "P0wnyshell",
                "PAYWIPE",
                "Ponyshell",
                "Pownyshell",
                "WhisperGate",
                "WhisperKill",
                "netcat",
                "reGeorg"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6c4f98b3-fe14-42d6-beaa-866395455e52",
            "created_at": "2023-01-06T13:46:39.169554Z",
            "updated_at": "2025-03-27T02:00:03.011739Z",
            "deleted_at": null,
            "main_name": "Evil Corp",
            "aliases": [
                "GOLD DRAKE"
            ],
            "source_name": "MISPGALAXY:Evil Corp",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c28760b2-5ec6-42ad-852f-be00372a7ce4",
            "created_at": "2022-10-27T08:27:13.172734Z",
            "updated_at": "2025-03-27T02:00:55.511386Z",
            "deleted_at": null,
            "main_name": "Ember Bear",
            "aliases": [
                "Ember Bear",
                "UNC2589",
                "Bleeding Bear",
                "DEV-0586",
                "Cadet Blizzard",
                "Frozenvista",
                "UAC-0056"
            ],
            "source_name": "MITRE:Ember Bear",
            "tools": [
                "P.A.S. Webshell",
                "CrackMapExec",
                "ngrok",
                "WhisperGate",
                "Saint Bot",
                "PsExec",
                "Rclone",
                "Impacket",
                "OutSteel"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "50068c14-343c-4491-b568-df41dd59551c",
            "created_at": "2022-10-25T15:50:23.253218Z",
            "updated_at": "2025-03-27T02:00:55.408128Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Indrik Spider",
                "Evil Corp",
                "Manatee Tempest",
                "DEV-0243",
                "UNC2165"
            ],
            "source_name": "MITRE:Indrik Spider",
            "tools": [
                "Mimikatz",
                "PsExec",
                "Dridex",
                "WastedLocker",
                "BitPaymer",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9806f226-935f-48eb-b138-6616c9bb9d69",
            "created_at": "2022-10-25T16:07:23.73153Z",
            "updated_at": "2025-03-27T02:02:09.950784Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Blue Lelantos",
                "DEV-0243",
                "Evil Corp",
                "Gold Drake",
                "Gold Winter",
                "Manatee Tempest",
                "UNC2165"
            ],
            "source_name": "ETDA:Indrik Spider",
            "tools": [
                "Advanced Port Scanner",
                "Agentemis",
                "Babuk",
                "Babuk Locker",
                "Babyk",
                "BitPaymer",
                "Bugat",
                "Bugat v5",
                "Cobalt Strike",
                "CobaltStrike",
                "Cridex",
                "Dridex",
                "EmPyre",
                "EmpireProject",
                "FAKEUPDATES",
                "FakeUpdate",
                "Feodo",
                "FriedEx",
                "Hades",
                "IEncrypt",
                "LINK_MSIEXEC",
                "MEGAsync",
                "Macaw Locker",
                "Metasploit",
                "Mimikatz",
                "PayloadBIN",
                "Phoenix Locker",
                "PowerShell Empire",
                "PowerSploit",
                "PsExec",
                "QNAP-Worm",
                "Raspberry Robin",
                "RaspberryRobin",
                "SocGholish",
                "Vasa Locker",
                "WastedLoader",
                "WastedLocker",
                "cobeacon",
                "wp_encrypt"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b296f34c-c424-41da-98bf-90312a5df8ef",
            "created_at": "2024-06-19T02:03:08.027585Z",
            "updated_at": "2025-03-27T02:05:17.350153Z",
            "deleted_at": null,
            "main_name": "GOLD DRAKE",
            "aliases": [
                "Indrik Spider ",
                "Evil Corp"
            ],
            "source_name": "Secureworks:GOLD DRAKE",
            "tools": [
                " Cobalt Strike",
                " Covenant",
                " Donut",
                " Dridex",
                " Hades",
                " Koadic",
                " LockBit",
                " Macaw Locker",
                " Mimikatz",
                " Payload.Bin",
                " Phoenix CryptoLocker",
                " PowerSploit",
                " Powershell Empire",
                " SocGholish",
                " WastedLocker",
                "BitPaymer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bdbf873a-048d-4c5d-9d92-922327cc83a8",
            "created_at": "2023-01-06T13:46:39.387696Z",
            "updated_at": "2025-03-27T02:00:03.071819Z",
            "deleted_at": null,
            "main_name": "DEV-0586",
            "aliases": [
                "Ruinous Ursa",
                "Cadet Blizzard"
            ],
            "source_name": "MISPGALAXY:DEV-0586",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041820,
    "ts_creation_date": 1643740353,
    "ts_modification_date": 1643740353,
    "files": {
        "pdf": "https://archive.orkl.eu/936cb9520f2670cdb6a69623ece2fffc36e27aa2.pdf",
        "text": "https://archive.orkl.eu/936cb9520f2670cdb6a69623ece2fffc36e27aa2.txt",
        "img": "https://archive.orkl.eu/936cb9520f2670cdb6a69623ece2fffc36e27aa2.jpg"
    }
}