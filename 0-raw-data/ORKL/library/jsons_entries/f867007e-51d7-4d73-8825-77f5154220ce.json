{
    "id": "f867007e-51d7-4d73-8825-77f5154220ce",
    "created_at": "2022-10-25T16:48:10.542794Z",
    "updated_at": "2025-03-27T02:17:14.505738Z",
    "deleted_at": null,
    "sha1_hash": "42da0553f984992fca55238adb710a7a8c081816",
    "title": "APT10: Tracking down the stealth activity of the A41APT campaign",
    "authors": "",
    "file_creation_date": "2021-02-25T18:00:47Z",
    "file_modification_date": "2021-02-25T18:00:47Z",
    "file_size": 4517727,
    "plain_text": "## APT10: Tracking down the stealth activity of the A41APT campaign\n\n###### Suguru Ishimaru / Yusuke Niwa / Charles Li / Motohiko Sato / Hajime Yanagishita\n\n 2020/02/25 GReAT Ideas Green tea edition\n\n\n-----\n\n#### Presenter / Coauthor\n\n###### Charles Li Hajime Yanagishita Team T5 Macnica Networks Chief Analyst of TeamT5 Security Researcher\n\n Yusuke Niwa Motohiko Sato ITOCHU Corporation. ITOCHU Corporation. ITCCERT Cyber Security Researcher ITCCERT Sr. Cyber Security Researcher\n\n Suguru Ishimaru Kaspersky GReAT Malware Researcher\n\n\n-----\n\n#### Agenda\n\n##### 1. Campaign Overview\n\n 2. Malware Analysis\n\n 3. Characteristics of Intrusion\n\n 4. Threat Actor’s Infrastructure\n\n 5. Consideration of Threat Actor’s Attribution\n\n 6. Summary\n\n\n-----\n\n```\n    １．A41APT Campaign Overview\n\n```\n\n-----\n\n#### A41APT Campaign Overview\n\n###### � Period of Activity: March 2019 to January 2021\n\n � Target: Japan (Japanese companies including overseas branches)\n\n � Infection Vector: SSL-VPN abuse (Could not observed spear-phishing)\n\n � Implants: DESLoader, SodaMaster, P8RAT and FYAntiLoader etc.\n\n � Characteristics: Very tough to detect attacker’s intrusion\n\n We call this threat campaign A41APT from the hostname feature “DESKTOP-A41UVJV” that is continuously used during the initial intrusion.\n\n\n-----\n\n#### Public info\n\n###### 【緊急レポート】Microsoft社のデジタル署名ファイルを Japan-Linked Organizations Targeted in Long-Running and 悪用する「SigLoader」による標的型攻撃を確認 [1] Sophisticated Attack Campaign[2]\n\n @Int2e ’s tweet[3] Attacks Exploiting Vulnerabilities in Pulse\n\n\n-----\n\n```\n    ２．Malware Analysis\n\n```\n\n-----\n\n#### ２． Malware Analysis\n\n###### 1.DESLoader\n\n 1.Payloads of DESLoader\n```\n   • SodaMaster\n   • P8RAT\n\n • FYAntiLoader ⇒ .NET Loader(ConfuserEx v1.0.0) ⇒ xRAT\n\n```\n\n-----\n\n#### 2-1．DESLoader\n\n###### Aka. SigLoader, Ecipekac, HEAVYHAND\n Legitimate EXE\n  Unique multi-layer loader for payloads policytool.exe\n\n  Use 4 files in the same directory\n Layer I loader for side-loading\n  DLL Side-Loading\n jli.dll\n  DLLs contains encrypted shellcode of\n DLL contains encrypted\n Layer II and IV loader.\n shellcode: Layer II loader\n  Layer II, III, IV loaders and payload are vac.dll\n fileless implants.\n DLL contains encrypted shellcode: Layer IV loader\n\n\n-----\n\n#### Example of DESLoader's payload loading flow\n\n###### reflective fileless implants\n side-loading load decrypt dll injection\n\n policytool.exe\n jli.dll vac.dll shellcode1 embedded DLL1\n Legitimate EXE\n Layer I Layer II Layer III\n load\n\n reflective\n decrypt dll injection\n\n pcasvc.dll shellcode2 embedded DLL2\n Layer IV Payload\n\n Layer I: junk codes are found using OutputDebugStringA(),\n time64() rand() srand() for anti-reversing\n\n\n-----\n\n#### jli.dll: Layer I Loader\n\n###### Multiple algorithms (XOR, DES, AES and RSA) are implemented, and the order of using them is configured. It read encrypted data in vac.dll from the end of data till configured size and decrypt.\n\n load decrypt\n\n jli.dll vac.dll shellcode1 Layer I Layer II\n MZ PE\n ...skipped...\n Section table +\n 1. XOR key = 0x9F\n Section 1 … N\n\n Embedded data\n ...skipped...\n Defined crypto algorithms 2. AES key = 83H4uREKfFClDH8ziYTH8xsBYa32p3wl\n (CBC mode) IV = 83H4uREKfFClDH8z\n\n\n-----\n\n#### shellcode1: Layer II Loader\n\n###### Layer II Loader checks magic_bytes \"ecipekac\"(or “9F 8F 7F 6F” or “BF AF BF AF”). Then, it reconstructs and loads each part of the embedded DLL1 in the correct order of PE format for reflective DLL injection.\n\n reflective dll injection\n\n shellcode1 embedded DLL1\n Layer II Layer III\n\n 0x00000\n 0x00000 MZ\n shellcode\n 0x000E0\n 0x00bf5 PE\n ecipekac\n 0x00bfd 0x001E8\n Size of buf Section table\n 0x00c01\n Size of code\n 0x00c05 0x01000\n Section 1\n Section table Section1 … N\n 0x39a1d\n PE\n 0x39b25\n 0xXXXXX\n\n\n-----\n\n#### embedded PE1: Layer III Loader\n\n###### Layer III Loader is similar to Layer I Loader. The sequence of algorithms is in the reverse order compared to the layer I Loader. The hardcoded keys are also different respectively.\n\n load decrypt\n\n 1.AES\n embedded DLL1 pcasvc.dll key = K4jcj02QSLWp8lK9gMK9h7W0L9iB2eEW, shellcode2\n Layer III IV = K4jcj02QSLWp8lK9 Layer IV\n\n MZ PE\n\n Section table +\n Section 1 … N\n\n Embedded data\n\n Defined crypto algorithms\n\n\n-----\n\n|offset|data|description|\n|---|---|---|\n|0x000|90 90 90 90 90 90 90 90|magic bytes for Identification, this is used for comparision before data processing|\n|0x008|0x11600|Size of encrypted data, only this value (size) is observed|\n|0x00C|A9 5B 7B 84 9C CB CF E8 B6 79 F1 9F 05 B6 2B FE|16 bytes RC4 key (each sample has different key)|\n\n\n#### shellcode2: Layer IV Loader\n\n###### Three different types of shellcode were confirmed as Layer IV loader:\n\n 1. ​Similar to Layer II shellcode for P8RAT and FYAnti loader\n\n 2. Cobalt strike’s stager shellcode reflective dll injection\n\n 3. Shellcode dedicated for SodaMaster\n shellcode2 embedded DLL2\n Layer IV Payload\n\n**offset** **data** **description**\n\n0x000 `90 90 90 90 90 90 90 90` magic bytes for Identification, this is used for comparision before data processing\n\n0x008 `0x11600` Size of encrypted data, only this value (size) is observed\n\n###### shellcode2 Layer IV 0x00C A9 5B 7B 84 9C CB CF E8 16 bytes RC4 key (each sample has different key) for SodaMaster B6 79 F1 9F 05 B6 2B FE contains data structure\n\n0x01C `C7 36 7E 93 D3 07 1E 86` Encrypted SodaMaster payload with RC4\n\n\n-----\n\n|Col1|Col2|Col3|\n|---|---|---|\n||SodaMaster||\n\n\n#### DESLoader TimeLine\n\n###### The timeline of DESLoader based on compilation time. Also shown filename and its payloads. (+Cobalt Strike’s stager)\n\n**SodaMaster**\n\njli.dll WTSAPI32.DLL jli.dll vmtools.dll jli.dll\n\nNETAPI32.DLL SECUR32.dll jli.dll JLI.dll\nDBUS-1-3.DLL VMTOOLS.DLL LIBEAY32.DLL\n\n**Cobalt Strike’s stager**\n\nsbiedll.dll dbus-1-3.dll sbiedll.dll\n\nGLIB-2.0.DLL JLI.DLL\n\nSBIEDLL.DLL DBUS-1-3.DLL jli.dll\n\n**P8RAT**\n\nkbb.dll vmtools.dll\n\nuxtheme.dll kbb.dll jli.dll\n\njli.dll vmtools.dll\n\n**FYAnti**\n\nCCFIPC64.DLL\n\nOct 2019 Dec 2019 May 2020 Jun 2020 Jul 2020 Sep 2020 Oct 2020 Dec 2020\n\n\n-----\n\n#### 2-2．Payloads of DESLoader\n\n###### 1. SodaMaster 2. P8RAT 3. FYAntiLoader ⇒ .NET Loader(ConfuserEx v1.0.0) ⇒ xRAT\n\n\n-----\n\n#### SodaMaster\n\n###### Aka. DelfsCake, dfls, DARKTOWN\n\n  One of DESLoader's payloads\n\n  Fileless RAT(x64/x86)\n\n  Command identifiers are d, f, l and s\n\n  Check VM environment from the following\n registry value\n  HKCR\\Applications\\VMwareHostOpen.exe\n\n\n-----\n\n#### SodaMaster\n\n###### base64(RSA key) + 12bytes data\n\n  Mutex value = reverse order of  CRC32\n CRC32 calculated from hardcoded 0x8d01ca9f base64 string + 12 bytes\n\n  Initial C2 communication data is\n Mutex = 9FCA018D\n encrypted with RSA.\n Encrypted using RSA key\n User\n  The RSA key is hardcoded base64\n host\n key_blob and data contains PID randomly generated RC4 key os_ver\n soket Exec Date\n  Further communication data is\n RC4key\n encrypted with RC4\n\n RC4 encryption\n\n\n-----\n\n#### P8RAT\n\n###### Aka. GreetCake, HEAVYPOT\n\n  One of DESLoader's payloads\n\n  x64 fileless RAT\n\n  10 backdoor commands.\n\n  Main feature looks command 301:\n\n  Execution of secondary PE\n based payload downloaded into memory\n\n  P8RAT checks VMware and VirtualBox\n\n  vboxservice.exe  vmtools.exe\n\n\n-----\n\n|Col1|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n|cmd|Description|Compilation time of P8RAT|||\n|||2020-03-30|2020-08-26|2020-12-14|\n|300|Closing socket|Enable|Enable|Enable|\n|301|Creating a thread for executing/loading of a downloaded PE|Enable|Enable|Enable|\n|302|No functionality|Enable|Removed|Removed|\n|303|Sending randomly generated data|Enable|Enable|Enable|\n|304|Executing/loading downloaded PE/shellcode|Enable|Removed|Removed|\n|305|Setting value of “Set Online Time”, and the string of the setting value was removed from the P8RAT which was built on 2020-08-26.|Enable|Enable|Enable|\n|306|Setting value of “Set Reconnect TimeOut”, and the string of the setting value was removed from the P8RAT which was built on 2020-08-26.|Enable|Enable|Enable|\n|307|Setting value of “Set Reconnect times”, and the string of the setting value was removed from the P8RAT which was built on 2020-08-26.|Enable|Enable|Enable|\n|308|Setting value of “Set Sleep time”, and the string of the setting value was removed from the P8RAT which was built on 2020- 08-26.|Enable|Enable|Enable|\n\n\n#### P8RAT backdoor commands\n\n**Compilation time of P8RAT**\n\n###### cmd Description 2020-03-30 2020-08-26 2020-12-14\n\n 300 Closing socket Enable Enable Enable\n\n 301 Creating a thread for executing/loading of a downloaded PE Enable Enable Enable\n\n 302 No functionality Enable Removed Removed\n\n 303 Sending randomly generated data Enable Enable Enable\n\n 304 Executing/loading downloaded PE/shellcode Enable Removed Removed\n\nSetting value of “Set Online Time”, and the string of the setting value was removed from the P8RAT which was built on\n###### 305 Enable Enable Enable\n\n2020-08-26.\n\nSetting value of “Set Reconnect TimeOut”, and the string of the setting value was removed from the P8RAT which was built\n###### 306 Enable Enable Enable\n\non 2020-08-26.\n\nSetting value of “Set Reconnect times”, and the string of the setting value was removed from the P8RAT which was built on\n###### 307 Enable Enable Enable\n\n2020-08-26.\n\nSetting value of “Set Sleep time”, and the string of the setting value was removed from the P8RAT which was built on 2020-\n###### 308 Enable Enable Enable\n\n08-26.\n\n\n-----\n\n#### FYAntiLoader\n\n###### Aka. DILLJUICE stage2\n\n  One of DESLoader's payloads\n\n  Fileless type multi-layer loader module\n\n  Provocative Export function name\n\n  Loads .NET Loader using CppHostCLR\n\n  Contains .NET Loader packed\n with ConfuserEx v1.0.0\n\n  Finally, Payload is xRAT (QuasarRAT)\n\n\n-----\n\n#### Example of FYAntiLoader's payload loading flow\n\n###### reflective\n fileless implants\n side-loading load decrypt dll injection\n\n FYAnti\n usoclient.exe\n CCFIPC64.dll msftedit.prf.coo shellcode1 embedded DLL1\n Legitimate EXE\n Layer I Layer II Layer III\n load\n\n reflective\n decrypt dll injection CppHostCLR load decrypt\n\n msdtcuiu.adi.wdb shellcode2 embedded DLL2 .NET loader web_lowtrust.config.uninstall xRAT\n Layer IV FYAnti\n\n Looking for specific directory and search file\n\n\n-----\n\n#### xRAT (payload of FYAntiLoader)\n\n###### VERSION 2.0.0.0 HOSTS 45.138.157.83:443; RECONNECTDELAY 1846872 KEY [redacted] AUTHKEY [redacted] DIRECTORY Environment.SpecialFolder.ApplicationData SUBDIRECTORY Subdir INSTALLNAME Client.exe INSTALL false STARTUP false MUTEX 3n5HUTePmoGqIF8CZanamdGw STARTUPKEY Quasar Client Startup HIDEFILE false ENABLELOGGER false ENCRYPTIONKEY KCYcz6PCYZ2VSiFyu2GU TAG [redacted] LOGDIRECTORYNAME Logs HIDEDIRECTORY false Obfuscated configuration data decrypts HIDEINSTALLSUBDIRECTOR false\n\n\n-----\n\n```\n    ３．Characteristics of Intrusion\n\n```\n\n-----\n\n#### Intrusion method in A41APT campaign\n\n###### Internal Recon. Persistence of C2 Initial Intrusion Trace Removal Lateral Movement malware Communication\n\nPenetration via SSL-VPN Perform a port scan to search Persistence by scheduled task Communicate with C2 server Delete the event log after\nusing vulnerabilities or stolen for open RDP or SMB port. registration to execute the via DESLoader’s payload or communication with C2 is\ncredentials Then, connect to RDP with an legitimate PE PowerShell remoting finished.\n\nadministrator account.\n\nScheduled task registration Event log deletion\n\nC2 Server\n\nServer*\n\n**In Memory**\n\nServer\n\nDESLoader\n\nPayload\n\n###### OR\n\nPowerShell\n\nAD Server Laptop Legitimate PE\n\n\n-----\n\n#### Characteristics of Compromise\n\n###### 1. Initial intrusion using SSL-VPN products\n\n 2. Network scanning and credential theft\n\n 3. PowerShell remoting to remove event logs\n\n 4. Persistence of malware by scheduled task\n\n\n-----\n\n###### ３-１． Initial intrusion via SSL-VPN (e.g. session hijacking)\n\n • In October 2019, an attacker used the hostname DESKTOP-A41UVJV to hijack sessions to enter the internal network via SSL-VPN product, Pulse Secure.\n\n • JPCERT also reported a similar attack targeting SSL-VPN [4].\n\n • In some cases, attackers used credentials that they had stolen in the past intrusion.\n\n\n-----\n\n###### ３-2． Network scanning and credential theft\n\n Network scanning and RDP Credential theft\n\n ▪After the intrusion by SSL-VPN, perform\n\n ▪Run csvde.exe, a CSV export command line\n internal network scanning to find open port\n tool provided by Microsoft.\n RDP (3389/TCP) and SMB (445/TCP).\n\n ▪Execute AdFind provided by joeware.\n\n ▪ Use an administrator account to deploy RDP to servers with free RDP.\n\n ▪Dump of SYSTEM/SECURITY/SAM hive, etc.\n\n e.g. server types that are frequently\n compromised by RDP\n AD server File server Anti Virus management server\n Backup server\n\n\n-----\n\n###### ３-3． PowerShell remoting to delete event logs\n\n • Event log: the end of a PowerShell remoting session\n\n • Windows PowerShell.evtx EID: 403\n\n • The \"C2 address\" and the \"*.nls file name\" are changed, but the rest is the same ⇒ probably common tools execution\n\n\n-----\n\n```\n  ３-４．Persistence of malware by scheduled task\n\n###### ▪Registered a task scheduler that executes a legitimate executable file that loads DESLoader\n every 15 minutes.\n\n ▪It is unlikely that the same scheduled task name is created on the compromised hosts.\n\n```\n\n-----\n\n|Scheduled Tasks|PE name|\n|---|---|\n|\\Microsoft\\Windows\\Sysmain\\HybridDriveCachePrepopulate|HybridDrive.exe|\n|\\Microsoft\\Windows\\Shell\\FamilySafetyMonitor|wpcmon.exe|\n|\\Microsoft\\Windows\\NetworkAccessProtection\\NAPStatus UI|NAPStatus.exe|\n|\\Microsoft\\Windows\\SideShow\\AutoWake|AutoWake.exe|\n|\\Microsoft\\Windows\\SystemRestore\\SR|srtasks.exe|\n|\\Microsoft\\Windows\\Shell\\FamilySafetyUpload|FamilySafety.exe|\n|\\Microsoft\\Windows\\File Classification Infrastructure\\Property Definition Sync|DefinitionSync.exe|\n|\\Microsoft\\Windows\\UpdateOrchestrator\\Refresh Settings|usoclient.exe|\n|\\Microsoft\\Windows\\WindowsUpdate\\AUSessionConnect|AUSession.exe|\n|\\Microsoft\\Windows\\Shell\\WindowsParentalControls|ParentalControls.exe|\n|\\Microsoft\\Windows\\UpdateOrchestrator\\Schedule Retry Scan|usoclient.exe|\n|\\Microsoft\\Windows\\LanguageComponentsInstaller\\ReconcileLanguageResources|DiagPackage.exe|\n|\\Microsoft\\Windows\\Setup\\EOSNotify|EOSNotify.exe|\n\n\n###### e.g. Improperly registered scheduled tasks observed in the past\n\n Scheduled Tasks PE name\n\n \\Microsoft\\Windows\\Sysmain\\HybridDriveCachePrepopulate HybridDrive.exe\n\n \\Microsoft\\Windows\\Shell\\FamilySafetyMonitor wpcmon.exe\n\n \\Microsoft\\Windows\\NetworkAccessProtection\\NAPStatus UI NAPStatus.exe\n\n \\Microsoft\\Windows\\SideShow\\AutoWake AutoWake.exe\n\n \\Microsoft\\Windows\\SystemRestore\\SR srtasks.exe\n\n \\Microsoft\\Windows\\Shell\\FamilySafetyUpload FamilySafety.exe\n\n \\Microsoft\\Windows\\File Classification Infrastructure\\Property Definition Sync DefinitionSync.exe\n\n \\Microsoft\\Windows\\UpdateOrchestrator\\Refresh Settings usoclient.exe\n\n \\Microsoft\\Windows\\WindowsUpdate\\AUSessionConnect AUSession.exe\n\n \\Microsoft\\Windows\\Shell\\WindowsParentalControls ParentalControls.exe\n\n \\Microsoft\\Windows\\UpdateOrchestrator\\Schedule Retry Scan usoclient.exe\n\n \\Microsoft\\Windows\\LanguageComponentsInstaller\\ReconcileLanguageResources DiagPackage.exe\n\n \\Microsoft\\Windows\\Setup\\EOSNotify EOSNotify.exe\n\n\n-----\n\n```\n    ４．Threat Actor’s Infrastructure\n\n```\n\n-----\n\n#### Threat Actor’s Infrastructure\n\n###### 1. The hostname used for the intrusion via SSL-VPN\n\n 2. Characteristics of the C2 infrastructure\n\n\n-----\n\n|Hostname|Observation Time|\n|---|---|\n|DESKTOP-A41UVJV|2019/10 - 2020/01|\n|dellemc_N1548P|2020/04 - 2020/05|\n|DESKTOP-LHC2KTF|2020/12|\n|DESKTOP-O2KM1VL|2019/10, 2020/12|\n|DESKTOP-V24F9JL|2020/12|\n\n\n###### Hostname used for the initial intrusion via SSL-VPN\n\n ▪Tendency to use distinctive hostnames and attempt intrusions\n while changing IP addresses\n\n ✔Host names used in breaches observed in the past\n\n Hostname Observation Time\n\n DESKTOP-A41UVJV 2019/10 - 2020/01\n\n dellemc_N1548P 2020/04 - 2020/05\n\n DESKTOP-LHC2KTF 2020/12\n\n DESKTOP-O2KM1VL 2019/10, 2020/12\n\n DESKTOP-V24F9JL 2020/12\n\n ▪Tendency to use an IP for intrusion that is different from the C2 server’s IP\n\n\n-----\n\n###### Characteristics of the C2 infrastructure\n\n ▪For C2, there is a tendency to use IP addresses and not to use domains.\n\n ▪From the observed C2 IP addresses, there is little bias toward country and AS, and we\n observed that there is a tendency not to reuse IP addresses repeatedly.\n\n\n-----\n\n```\n    ５．Consideration of Threat Actor’s Attribution\n\n```\n\n-----\n\n#### Considerations for attribution of A41APT\n\n###### 1. Relevance to APT10\n\n 2. Relevance to BlackTech\n\n\n-----\n\n```\n  １．Relevance to APT10\n\n###### Common TTPs\n\n ▪ Two ways linked to APT10:\n\n - Multilayers loading\n\n ▪ Confirmed the existence of an early version of - CPPHostDLR loader SodaMaster (x86) in March 2019, which was involved - F**kYouAnti export\n ShellCode - Look for payloads under\n in an attack against Turkey and attributed to APT10 “C:\\Windows\\Microsoft.Net” (mentioned [5])\n ▪ xRAT observed in A41APT campaign has common load TTPs with BlackBerry Cylance reports in 2019 was Common TTPs confirmed [6].\n\n SodaMaster xRAT/QuasarRAT\n\n```\nconnect\n\nMenuPass/QuasarRAT\n\nBackdoor Report\n\n###### Run dll payload\n\nAttribute\n\n###### Run Shellcode payload rare-coisns[.]com\n\nAPT10\n\n\n-----\n\n```\n  ２．Relevance to BlackTech\n\n###### SodaMaster TSCookie\n\n ▪Identified common features between\n SodaMaster and TSCookie [7].\n\n ▪The same information is collected\n from the compromised host in the initial stage\n   – Username\n   – Computer name\n   – Current process ID\n\n ▪Observed existence of two malware,\n SodaMaster and TSCookie, on multiple compromised hosts\n\n```\n\n-----\n\n```\n    ６．Summary\n\n```\n\n-----\n\n#### Wrap up：A41APT Campaign\n\n###### ▪ Intrusion via SSL-VPN ADVERSARY\n\n ▪ Heavy usage of RDP for lateral movement (mainly servers) ▪Strong association with APT10\n\n ▪ Abusing DLL-Sideloading ▪Potential relevance to BlackTech\n\n ▪ Remove traces\n\n CAPABILITIES INFRASTRUCTURE\n\n ▪ Targeting Japanese companies ▪ Heavy usage of IP addresses for C2 including overseas branches (no domain usage)\n\n ▪ Wide range of industries such as ▪ Less reuse of IP addresses for C2 manufacturing\n\n\n-----\n\n#### Wrap up： TTPs ~MITRE ATT&CK Mapping~\n\n###### Tactics Techniques\n\n Initial Access External Remote Services (T1133) : Intrusion via SSL-VPN using vulnerabilities or stolen credentials\n\n Execution Command and Scripting Interpreter: PowerShell (T1059.001) Base64 obfuscated PowerShell commands (delete event log) Windows Management Instrumentation (T1047) : WMIC collects services for security products\n\n Persistence Scheduled Task/Job: Scheduled Task (T1053.005) :\n\n Privilege Escalation Hijack Execution Flow: DLL Search Order Hijacking (T1574.001)\n\n Defense Evasion Deobfuscate/Decode Files or information (T1140) Indicator Removal on Host: Clear Windows Event Logs (T1070.001) Hijack Execution Flow: DLL Search Order Hijacking (T1574.001)\n\n Credential Access OS Credential Dumping: Security Account Manager (T1003.002) OS Credential Dumping: NTDS (T1003.003)\n\n Discovery Account Discovery: Domain Account (T1087.002) Domain Trust Discovery (T1482) Software Discovery: Security Software Discovery (T1518.001)\n\n Lateral Movement Remote Services: Remote Desktop Protocol (T1021.001)\n\n Collection Archive Collected Data: Archive via Utility (T1560.001) : Compression by WinRAR\n\n\n-----\n\n#### Wrap up： Features of this campaign\n\n###### ✔ Targeting the kryptonite of EDR/FSA detection\n\n • Malware is written on the disk by the attacker's manual operation via SSL-VPN instead of malware-\n\n originated intrusion from Spear phishing email (legitimate file, loader, encrypted file)\n\n • Intrusion from group affiliates, including overseas companies\n\n • Malware is mostly placed on servers, and the number of compromised servers are very small.\n\n • Most of the malware detected in the same period have different C2 addresses, so there is little tendency\n\n to use the same samples.\n\n ✔ After the intrusion, some rough operations were seen.\n\n • Heavy usage of network discovery using RDP\n\n • Common traces deletion method of event logs\n\n\n-----\n\n#### Examples of countermeasures against this campaign\n\n###### SSL-VPN Governance（Overseas/affilates）\n\n                                                                - Framework for sharing information (Incident, Threat Intel and\n\n###### • Implementation of MFA\n\nsecurity situation )\n\n###### • Patch adaptation operation\n\n                                                                - Apply same security level\n\n###### • Monitoring\n\n                                                                - Apply same level of detection in each intrusion method\n\n###### End User\n Additional threat visibility Additional Monitoring\n\n                                                                      - Audit authentication attemp of administrator account (success/failure)\n\n                   - Network Monitor by NTA\n\n                                                                      - Monitor deletion of Windows event log\n\n                   - Strengthen security measures for servers\n\n                                                                      - Monitor login from host that is not in list of organization asset\n\n                   - Hunting stealthy attack by using EDR/FSA\n\n                                                                      - Monitor SSL-VPN log for suspicious login from unknown host ( e.g.\n\n                   - Leverage Yara rule to detect loader or payload on memory hostname is not in organization asset )\n\n###### Strengthen Monitoring for Authentication\n\n Vendor\n\n • Talk with end user to know white-list ( username, hostname, IP address and date/time ) of\n (SOC)\n authentication and give proactive alert to end user\n\n\n-----\n\n#### on intrusion method)\n\n###### Internal Recon. Persistence of Initial Intrusion C2 Communication Trace Removal Lateral Movement malware\n\n  - Implementation of MFA   - NW monitoring by NTA   - Monitor the creation of   - Payload detection by Yara   - Monitor for traces of\n\n  - Patch adaptation operation   - Strengthen security measures for suspicious scheduled task   - C2 identification and blocking by suspicious event log deletions.\n\n  - Monitor suspicious logins from servers (EDR/FSA etc.) events. malware analysis\noverseas   - Monitoring of administrator\n\nauthentication attempt                     - Identify and block C2 by traces\n(success/failure) of suspicious PowerShell\n\n                     - Suspicious login monitoring from remoting in event logs\nhosts outside of asset\nmanagement\n\nScheduled task registration Event log deletion\n\nEvent log\n\nPatch application Server C2\n\n**In Memory** monitoring\n\noperation Server\n\nMonitoring\nMonitoring\n\nNTA DESLoader **OR**\nNTA\n\npayloads\n\n###### MFA\n\nPowerShell\n\n\n-----\n\n#### At the end...\n\n######  A41APT campaign is very stealthy and difficult to detect, but it is not undetectable.\n\n  The compromised target has shifted from endpoint to server, and the intrusion route has also\n\n shifted from spear phishing to abusing SSL-VPN. Security measures need to be reviewed in\n\n your organization to respond to change in attack method.\n\n  By refining daily security operations and thoroughly reviewing the security holes in each\n\n organization's environment, it may be possible to detect and protect attacks from even small\n\n anomalies.\n\n\n-----\n\n#### Reference\n\n###### 1. 【緊急レポート】Microsoft社のデジタル署名ファイルを悪用する「SigLoader」による標的型攻撃を確認 https://www.lac.co.jp/lacwatch/report/20201201_002363.html\n\n 2. Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/cicada-apt10-japan-espionage\n\n 3. https://twitter.com/Int2e_/status/1333501729359466502?s=20\n\n 4. Attacks Exploiting Vulnerabilities in Pulse Connect Secure https://blogs.jpcert.or.jp/en/2020/04/attacks-exploiting-vulnerabilities-in-pulse-connect-secure.html\n\n 5. APT10 THREAT ANALYSIS REPORT (ADEO IT Consulting Services) https://adeo.com.tr/wp-content/uploads/2020/02/APT10_Report.pdf\n\n 6. Threat Spotlight: MenuPass/QuasarRAT Backdoor https://blogs.blackberry.com/en/2019/06/threat-spotlight-menupass-quasarrat-backdoor\n\n 7. https://blogs.jpcert.or.jp/ja/2018/03/tscookie.html\n\n 8. A41APT case ~Analysis of the Stealth APT Campaign Threatening Japan https://jsac.jpcert.or.jp/archive/2021/pdf/JSAC2021_202_niwa-yanagishita_en.pdf\n\n\n-----\n\n#### IoCs\n\n**MD5** **File name** **Payloads** **Comment** **Path of Encrypted xRAT**\n\nf6ed714d29839574da3e368e4437eb99 usoclient.exe xRAT Legitimate EXE Microsoft.NET\\test\\Framework\\v4.0.30319\\Config\\\n\nweb_lowtrust.config.uninstall\n\ndd672da5d367fd291d936c8cc03b6467 CCFIPC64.DLL xRAT DESLoader\n\nEncrypted Layer II\n335ce825da93ed3fdd4470634845dfea msftedit.prf.cco xRAT **Hostname of Intruded via SSL-VPN**\n\nshellcode\n\nEncrypted Layer IV DESKTOP-A41UVJV\nf4c4644e6d248399a12e2c75cf9e4bdf msdtcuiu.adi.wdb xRAT\n\nshellcode\n\ndellemc_N1548P\n\nweb_lowtrust.config.\n019619318e1e3a77f3071fb297b85cf3 xRAT Encrypted xRAT DESKTOP-LHC2KTF\n\nuninstall\n\nDESKTOP-O2KM1VL\n\n7e2b9e1f651fa5454d45b974d00512fb policytool.exe P8RAT Legitimate EXE\n\nbe53764063bb1d054d78f2bf08fb90f3 jli.dll P8RAT DESLoader DESKTOP-V24F9JL\n\nEncrypted Layer II\nf60f7a1736840a6149d478b23611d561 vac.dll P8RAT\n\nshellcode\n\n**C2** **Payloads**\n\nEncrypted Layer IV\n59747955a8874ff74ce415e56d8beb9c pcasvc.dll P8RAT\n\nshellcode\n\n45.138.157[.]83 xRAT\n\nc5994f9fe4f58c38a8d2af3021028310 80f55.rec.dll SodaMaster(x86) Mem dump\n\n037261d5571813b9640921afac8aafbe 10000000.dll SodaMaster(x86) Mem dump\n\n151.236.30[.]223 P8RAT\n\nbca0a5ddacc95f94cab57713c96eacbf ResolutionSet.exe SodaMaster Legitimate EXE\n\ncca46fc64425364774e5d5db782ddf54 vmtools.dll SodaMaster DESLoader 193.235.207[.]59 Stager Shellcode\n\nwiaky002_CNC1755 Encrypted Layer II\n4638220ec2c6bc1406b5725c2d35edc3 SodaMaster\n\nD.dll shellcode www.rare-coisns[.]com SodaMaster(x86)\n\n\n-----\n\n# Any Questions?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2021/2021.02.25.A41APT/greatidea_A41_v1.0.pdf"
    ],
    "report_names": [
        "greatidea_A41_v1.0"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "04b07437-41bb-4126-bcbb-def16f19d7c6",
            "created_at": "2022-10-25T16:07:24.232628Z",
            "updated_at": "2025-03-27T02:02:10.146043Z",
            "deleted_at": null,
            "main_name": "Stone Panda",
            "aliases": [
                "APT 10",
                "ATK 41",
                "Bronze Riverside",
                "CTG-5938",
                "CVNX",
                "Cuckoo Spear",
                "Earth Kasha",
                "Granite Taurus",
                "Happyyongzi",
                "Hogfish",
                "ITG01",
                "Operation A41APT",
                "Operation Cache Panda",
                "Operation ChessMaster",
                "Operation Cloud Hopper",
                "Operation Cuckoo Spear",
                "Operation New Battle",
                "Operation Soft Cell",
                "Operation TradeSecret",
                "Potassium",
                "Red Apollo",
                "Stone Panda",
                "TA429",
                "menuPass",
                "menuPass Team"
            ],
            "source_name": "ETDA:Stone Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Anel",
                "AngryRebel",
                "BKDR_EVILOGE",
                "BKDR_HGDER",
                "BKDR_NVICM",
                "BUGJUICE",
                "CHINACHOPPER",
                "ChChes",
                "China Chopper",
                "Chymine",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "DARKTOWN",
                "DESLoader",
                "DILLJUICE",
                "DILLWEED",
                "Darkmoon",
                "DelfsCake",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Ecipekac",
                "Emdivi",
                "EvilGrab",
                "EvilGrab RAT",
                "FYAnti",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "GreetCake",
                "HAYMAKER",
                "HEAVYHAND",
                "HEAVYPOT",
                "HTran",
                "HUC Packet Transmit Tool",
                "Ham Backdoor",
                "HiddenFace",
                "Impacket",
                "Invoke the Hash",
                "KABOB",
                "Kaba",
                "Korplug",
                "LODEINFO",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MiS-Type",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "NBTscan",
                "NOOPDOOR",
                "Newsripper",
                "P8RAT",
                "PCRat",
                "PlugX",
                "Poison Ivy",
                "Poldat",
                "PowerSploit",
                "PowerView",
                "PsExec",
                "PsList",
                "Quarks PwDump",
                "Quasar RAT",
                "QuasarRAT",
                "RedDelta",
                "RedLeaves",
                "Rubeus",
                "SNUGRIDE",
                "SPIVY",
                "SharpSploit",
                "SigLoader",
                "SinoChopper",
                "SodaMaster",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "UpperCut",
                "Vidgrab",
                "WinRAR",
                "WmiExec",
                "Wmonder",
                "Xamtrav",
                "Yggdrasil",
                "Zlib",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "dfls",
                "lena",
                "nbtscan",
                "pivy",
                "poisonivy",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716490,
    "ts_updated_at": 1743041834,
    "ts_creation_date": 1614276047,
    "ts_modification_date": 1614276047,
    "files": {
        "pdf": "https://archive.orkl.eu/42da0553f984992fca55238adb710a7a8c081816.pdf",
        "text": "https://archive.orkl.eu/42da0553f984992fca55238adb710a7a8c081816.txt",
        "img": "https://archive.orkl.eu/42da0553f984992fca55238adb710a7a8c081816.jpg"
    }
}