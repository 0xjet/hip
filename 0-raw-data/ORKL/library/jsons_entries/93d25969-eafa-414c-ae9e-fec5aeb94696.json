{
    "id": "93d25969-eafa-414c-ae9e-fec5aeb94696",
    "created_at": "2022-10-25T16:48:25.21229Z",
    "updated_at": "2025-03-27T02:05:58.903226Z",
    "deleted_at": null,
    "sha1_hash": "54c39c3b9a25c6fd9e4b8ed7ea672a095d2af31e",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-01-11T07:29:12Z",
    "file_modification_date": "2018-01-11T07:29:12Z",
    "file_size": 666712,
    "plain_text": "# module 50251 and the “Qwerty” keylogger\n\n###### By Costin Raiu, Igor Soumenkov on January 27, 2015. 11:00 am\n\nOn January 17 2015, Spiegel.de published an extensive article based on\n\ndocuments obtained from Edward Snowden. At the same time, they\n\nprovided a copy of a malicious program codenamed “QWERTY”\n\n[(http://www.spiegel.de/media/media-35668.pdf), supposedly used by](http://www.spiegel.de/media/media-35668.pdf)\n\nseveral governments in their CNE operations.\n\nWe’ve obtained a copy of the malicious files published by Der Spiegel and\n\n[when we analyzed them, they immediately reminded us of Regin. Looking](http://securelist.com/blog/research/67741/regin-nation-state-ownage-of-gsm-networks/)\n\nat the code closely, we conclude that the “QWERTY” malware is identical\n\nin functionality to the Regin 50251 plugin.\n\n## Analysis\n\nThe Qwerty module pack consists of three binaries and accompanying\n\nconfiguration files. One file from the package– 20123.sys – is particularly\n\ninteresting.\n\nThe “20123.sys” is a kernel mode part of the keylogger. As it turns out, it\n\nwas built from source code that can also be found one Regin module, the\n\n“50251” plugin.\n\nUsing a binary diff it is easy to spot a significant part of code that is shared\n\nbetween both files:\n\n\n-----\n\nMost of the shared code belongs to the function that accesses the system\n\nkeyboard driver:\n\n\n-----\n\nMost of the “Qwerty” components call plugins from the same pack (with\n\nplugin numbers 20121 – 20123), however there is also one piece code\n\nthat references plugins from the Regin platform. One particular part of\n\ncode is used in both the “Qwerty” 20123 module and the Regin’s 50251\n\ncounterpart, and it addresses the plugin 50225 that can be found in the\n\nvirtual filesystems of Regin. The Regin’s plugin 50225 is reponsible for\n\nkernel-mode hooking.\n\nThis is a solid proof that the Qwerty plugin can only operate as part of\n\nthe Regin platform, leveraging the kernel hooking functions from plugin\n\n50225.\n\nAs an additional proof that both modules use the same software\n\nplatform, we can take a look at functions exported by ordinal 1 of both\n\nmodules. They contain the startup code that can be found in any other\n\n\n-----\n\nmakes sense if the modules are used with the Regin platform\n\norchestrator.\n\nThe reason why the two modules have different plugin IDs is unknown.\n\nThis is perhaps because they are leveraged by different actors, each one\n\nwith its own allocated plugin ID ranges.\n\n## Conclusions\n\nOur analysis of the QWERTY malware published by Der Spiegel indicates it\n\nis a plugin designed to work part of the Regin platform. The QWERTY\n\nkeylogger doesn’t function as a stand-alone module, it relies on kernel\n\nhooking functions which are provided by the Regin module 50225.\n\nConsidering the extreme complexity of the Regin platform and little\n\nchance that it can be duplicated by somebody without having access to\n\nits sourcecodes, we conclude the QWERTY malware developers and the\n\nRegin developers are the same or working together.\n\nAnother important observation is that Regin plugins are stored inside an\n\nencrypted and compressed VFS, meaning they don’t exist directly on the\n\nvictim’s machine in “native” format. The platform dispatcher loads and\n\nexecutes there plugins at startup. The only way to catch the keylogger is\n\nby scanning the system memory or decoding the VFSes.\n\n### Appendix (MD5 hashes):\n\nQWERTY 20123.sys:\n\n\n1\n\n0ed11a73694999bc45d18b4189f41ac2\n\n\n-----\n\ne9a43ea2882ac63b7bc036d954c79aa1\n\n\n[APT](https://securelist.com/all?tag=538) [KEYLOGGERS](https://securelist.com/all?tag=97) [TARGETED ATTACKS](https://securelist.com/all?tag=53)\n\n### Related Posts\n\n\nShare post on:\n\n####   \n\n\n###### Happy IR in the New Year!\n\n\n###### Kaspersky Security Bulletin: Review of the Year 2017\n\n\n###### Threat Predictions for Connected Health in 2018\n\n\n##### THERE ARE 4 COMMENTS\n\n[Hausverwaltung Essen](http://www.gottschling-immobilien.de/)\n\nPosted on January 27, 2015. 2:24 pm\n\nIs it just as siple, as it seems???\n\nLecaf@geocities.com\n\nPosted on January 27, 2015. 2:38 pm\n\nAny similarity with bugbear keylogger? Just curious.\n\n[jashon](http://si-salud.com/)\n\nPosted on March 21, 2015. 10:19 pm\n\ndoes this thing affect android 4.1?\n\nErich Vansunn\n\nPosted on May 2, 2017. 8:21 pm\n\n\n[REPLY](https://securelist.com/comparing-the-regin-module-50251-and-the-qwerty-keylogger/68525/?replytocom=352742#respond)\n\n\n[REPLY](https://securelist.com/comparing-the-regin-module-50251-and-the-qwerty-keylogger/68525/?replytocom=352755#respond)\n\n\n[REPLY](https://securelist.com/comparing-the-regin-module-50251-and-the-qwerty-keylogger/68525/?replytocom=454395#respond)\n\n\nThis is astonishing information. It seems, if they put their collective\n\nminds to it they could take over the planet Reminds me of earlry\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.01.27.QWERTY_keylog_Regin_compare/Comparing_Regin_Qwerty.pdf"
    ],
    "report_names": [
        "Comparing_Regin_Qwerty"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716505,
    "ts_updated_at": 1743041158,
    "ts_creation_date": 1515655752,
    "ts_modification_date": 1515655752,
    "files": {
        "pdf": "https://archive.orkl.eu/54c39c3b9a25c6fd9e4b8ed7ea672a095d2af31e.pdf",
        "text": "https://archive.orkl.eu/54c39c3b9a25c6fd9e4b8ed7ea672a095d2af31e.txt",
        "img": "https://archive.orkl.eu/54c39c3b9a25c6fd9e4b8ed7ea672a095d2af31e.jpg"
    }
}