{
    "id": "cb8b3dbf-7c26-4aca-bab7-6758c0806c1b",
    "created_at": "2023-01-12T14:59:48.005213Z",
    "updated_at": "2025-03-27T02:05:27.206155Z",
    "deleted_at": null,
    "sha1_hash": "8f2a0d7b8632c0665ae481cb82c1637e3e82dd27",
    "title": "2022-01-25 - An Exhaustively Analyzed IDB for ComLook",
    "authors": "",
    "file_creation_date": "2022-05-28T18:26:58Z",
    "file_modification_date": "2022-05-28T18:26:58Z",
    "file_size": 159606,
    "plain_text": "# An Exhaustively Analyzed IDB for ComLook\n\n**[msreverseengineering.com/blog/2022/1/25/an-exhaustively-analyzed-idb-for-comlook](https://www.msreverseengineering.com/blog/2022/1/25/an-exhaustively-analyzed-idb-for-comlook)**\n\nJanuary 25, 2022 [Rolf Rolles](http://10.10.0.46/blog?author=5111cf9ee4b0a36262da10df)\n\n\nJanuary 25, 2022\n\n\nThis blog entry announces the release of an exhaustive analysis of ComLook, a newlydiscovered malware family about which little information has been published. It was recently\n[discovered by ClearSky Cyber Security, and announced in a thread on Twitter. You can find](https://twitter.com/ClearskySec/status/1484211242474561540)\nthe [IDB for the DLL here, in which every function has been analyzed, and every data](https://github.com/RolfRolles/IDBs/tree/master/ComLook)\nstructure has been recovered.\n\n[Like the previous two entries in this series on ComRAT v4 and](https://www.msreverseengineering.com/blog/2020/8/31/an-exhaustively-analyzed-idb-for-comrat-v4) [FlawedGrace, I did this](https://www.msreverseengineering.com/blog/2021/3/2/an-exhaustively-analyzed-idb-for-flawedgrace)\nanalysis as part of my preparation for an upcoming class on C++ reverse engineering. The\nanalysis took about a one and a half days (done on Friday and Saturday). ComLook is an\nOutlook plugin that masquerades as Antispam Marisuite v1.7.4 for The Bat!. It is fairly\nstandard as far as remote-access trojans go; it spawns a thread to retrieve messages from\na C&C server over IMAP, and processes incoming messages in a loop. Its command\nvocabulary is limited; it can only read and write files to the victim server, run commands and\nretrieve the output, and update/retrieve the current configuration (which is saved\npersistently in the registry). See the IDB for complete details.\n\n(Note that if you are interested in the forthcoming C++ training class, it is nearing\ncompletion, and should be available in Q2 2022. More generally, remote public classes\n(where individual students can sign up) are temporarily suspended; remote private classes\n(multiple students on behalf of the same organization) are currently available. If you would\nlike to be notified when public classes become available, or when the C++ course is ready,\n[please sign up on our no-spam, very low-volume, course notification mailing list. (Click the](https://www.msreverseengineering.com/training-classes)\nbutton that says \"Provide your email to be notified of public course availability\".) )\n\nThis analysis was performed with IDA Pro 7.7 and Hex-Rays 32-bit. All analysis has been\ndone in Hex-Rays; go there for all the gory details, and don't expect much from the\ndisassembly listing. All of the programmer-created data structures have been recovered\nand applied to the proper Hex-Rays variables. The functionality has been organized into\nfolders, as in the following screenshot:\n\n\n-----\n\n-----\n\nThe binary was compiled with MSVC 10.0 with RTTI, and uses standard C++ template\ncontainers:\n\nstring/wstring\n\nshared_ptr\n\nvector\n\nlist\n\nmap\n\nThe primary difficulty in analyzing this sample was that it was compiled in debug mode.\nAlthough this does simplify some parts of the analysis (e.g., error message contain the raw\nSTL typenames), it also slows the speed of comprehension due to a lack of inlining, and\nincludes a huge amount of code to validate so-called C++ debug iterators. This makes\nlocating the real programmer-written functionality more time-consuming. STL functions\ninvolving iterators that, in a release build, would have consumed less than a page of\ndecompilation, often consumed five or more pages due to debug iterator validation.\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-25 - An Exhaustively Analyzed IDB for ComLook.pdf"
    ],
    "report_names": [
        "2022-01-25 - An Exhaustively Analyzed IDB for ComLook.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535588,
    "ts_updated_at": 1743041127,
    "ts_creation_date": 1653762418,
    "ts_modification_date": 1653762418,
    "files": {
        "pdf": "https://archive.orkl.eu/8f2a0d7b8632c0665ae481cb82c1637e3e82dd27.pdf",
        "text": "https://archive.orkl.eu/8f2a0d7b8632c0665ae481cb82c1637e3e82dd27.txt",
        "img": "https://archive.orkl.eu/8f2a0d7b8632c0665ae481cb82c1637e3e82dd27.jpg"
    }
}