{
    "id": "421bac9e-25c8-43f6-aa2a-a43b33afeb52",
    "created_at": "2023-04-05T02:08:40.245057Z",
    "updated_at": "2025-03-27T02:08:42.796035Z",
    "deleted_at": null,
    "sha1_hash": "5152bec77b2b9379eb5f185c3ddf11652ada8b47",
    "title": "2016-02-09 - Bedep Lurking in Angler's Shadows",
    "authors": "",
    "file_creation_date": "2023-04-03T08:49:46Z",
    "file_modification_date": "2023-04-03T08:49:46Z",
    "file_size": 1027097,
    "plain_text": "# Bedep Lurking in Angler's Shadows\n\n**blog.talosintelligence.com/bedep-actor/**\n\nAlexander Chiu February 9, 2016\n\nBy [Alexander Chiu](https://blog.talosintelligence.com/author/alexander-chiu/)\n\nTuesday, February 9, 2016 16:02\n\n_[This post is authored by Nick Biasini.](http://blogs.cisco.com/author/NickBiasini?ref=blog.talosintelligence.com)_\n\nIn October 2015, Talos released our detailed investigation of the Angler Exploit Kit which\noutlined the infrastructure and monetary impact of an exploit kit campaign delivering\nransomware. During the investigation we found that two thirds of Angler's payloads were\nsome variation of ransomware and noted one of the other major payloads was Bedep.\nBedep is a malware downloader that is exclusive to Angler. This post will discuss the Bedep\nside of Angler and draw some pretty clear connections between Angler and Bedep.\n\nAdversaries continue to evolve and have become increasingly good at hiding the\nconnections to the nefarious activities in which they are involved. As security researchers\nwe are always looking for the bread crumbs that can link these threats together to try and\nidentify the connections and groups that operate. This is one of those instances were a\ncouple of crumbs came together and formed some unexpected connections. By tying\ntogether a couple of registrant accounts, email addresses, and domain activity Talos was\n\n\n-----\n\nable to track down a group that has connections to threats on multiple fronts including:\nexploit kits, trojans, email worms, and click fraud. These activities all have monetary value,\nbut are difficult to quantify unlike a ransomware payload with a specific cost to decrypt.\n\n## Back in the 0-Day\n Let's start a little more than a year ago with the Angler Flash 0-day (CVE-2015-0310). It's not the 0-day that's of interest. Instead, it's the group that was hosting it. This was around the time when Angler began distribution via Domain Shadowing, accounting for the majority of domain activity hosting Angler. Domain Shadowing is the process of leveraging hacked registrant accounts to host malicious activity under subdomains. It started with Angler and has propagated through most exploit kits. What was interesting about the Flash 0-day was that it initially wasn't being hosted using shadowed domains. Instead, it was using registered domains. A sample of the domains being used can be found below.\n\nDuring the investigation, we began looking deeper at these domains and found that they\nwere all registered under a single email address: yingw90@yahoo.com. At this point Talos\nwas already blocklisting the domains associated with this registrant account and began\ntracking it accordingly.\n\n## Angler Research\n Let's fast forward to the months leading up to our report published in October 2015. Talos gathered landing page URLs as well as URLs associated with the rest of the Angler infection chain. We looked at additional ways to group and slice the data specifically associated with landing pages. While inspecting the length of the parameters we found something interesting. For 90% of the landing pages, we\n\n\n-----\n\n## found the parameters were less than 50 characters in length. The payloads associated with this 90% varied quite considerably, but was predominantly ransomware.\n\nWe found a group of ~10% that had a parameter around 100 characters. That was a\nsignificant deviation from what would be considered \"normal\" parameter length. We began\nthen looking at the payloads and found that every instance we traced that had a parameter\nof greater than 100, was delivering Bedep. There are some interesting implications here. Is\nit possible that the instance or instances delivering Bedep are different from the instances\ndelivering additional payloads?\n\nThis became an even stronger possibility when we started finding double Angler infections.\nIt started with users being compromised by Angler and getting an initial payload of Bedep.\nThis was followed up with, command and control or C2 communication and a download of\nclick fraud software. This is normal behavior for Bedep. However there was an additional\nstep. At some point after the infection we began seeing users being directed to other Angler\ninstances. These systems were delivering other payloads, most commonly ransomware\nvariants. These seemed to point further to the Angler instances delivering Bedep are\ndifferent from those delivering other payloads. Why would one Angler user direct their\ncompromised users to other Angler instances?\n\nWe've mentioned multiple times the Bedep C2 communication, the next section will focus\non Bedep. Below are some samples of the domains we started to encounter.\n\n## Bedep\n This is obviously using a domain generating algorithm, or DGA. It's been documented that Bedep makes use of the exchange rates being hosted by the European Central Bank, as one of the seeds for the DGA, which is an indicator of Bedep infection. If investigating a potential Angler infection and a GET request to www.ecb.europa.eu\n\n\n-----\n\n## is observed there is a high probability the sytem was compromised with Bedep. We had a large list of DGA based domains and found our first interesting connection.\n\nThe majority of the C2 domains were registered to the same registrant. This registrant also\nheld all of the domains that were first seen hosting the Flash 0-day. There is a basic pattern\nfor Bedep C2: the DGA domains for that particular day are registered, they are active while\nusers connect to them, and then go dark. We profiled these sites and found that they use\nthe same \"stock\" webpage. A sample of the web page is shown below:\n\nThis is a unique \"stock\" webpage with an image of pills in the header and a section of links\nin the body. In general these links do not go anywhere redirecting back to this main page.\n\n## Rabbit Hole Referers\n The analysis continued with a focus on the referer data with a couple of interesting discoveries. They have been labeled as \"rabbit hole referers\" because they led us down a rabbit hole of domains, IPs, and compromise. This lead us to the threat actor(s) responsible for a significant amount of Angler activity and a close link to the Bedep downloader.\n\n\n-----\n\nFirst, Talos noticed a set of referers that were using a group of domains that resembled\nnews4newsXXXX.com where XXXX is some variant of year (i.e. 14, 15, 2014, 2015).\nLeveraging OpenDNS, Talos found that a single registrant account was responsible for all\nthese domains. One interesting thing to note is the use of BizCN registrar. There has been\ninformation around various other exploit kits using BizCN registered domains as a gate.\nThis could be yet another exploit kit making use of the same type of service.\n\nTalos viewed these web pages and they appear to be a normal news site, a sample of\nwhich is shown below.\n\nHowever, whenever Angler redirection was found, there were a couple of interesting\nfeatures. First, the syntax used was similar to the following:\n\n\n-----\n\nnews4news14[.]com/?source=7-381898&campaign_id=2849\n\nThis syntax indicates it may be part of a malvertising campaign based on the campaign_id\nvariable. However, browsing to something as simple as 'news4news14.com/?q=junk', the\nuser was directed to an Angler URL with no malicious data served. The second interesting\nfeature relates to the sites that referred to news4newsXXX.com. There were a large number\nof referers that appeared to be using some sort of search function to direct users. However,\nTalos was not able to find any legitimate traffic to these domains. It appeared to be\nexclusively used as a referrer. Talos dove deeper on two of these referrers in particular:\n\ndinorinwass[.]com/search.php\n\nwittalparuserigh[.]com\n\nAgain, leveraging OpenDNS, Talos was able to identify more information regarding the first\ndomain.\n\nThe registrant email address potrafamin44as@gmail.com was then used to gather\ninformation from DomainTools. This led Talos to a name of 'David Bowers' that had a\nsignificant amount of domains registered to them, as well as, a list of other domains that\nOpenDNS had categorized as malicious from potrafamin44as@gmail.com. We were also\nable to pull a screen capture of the default webpage for this site. The results are familiar,\nbut not identical to the other sites. This site makes use of notes in the top left of the header\nas opposed to the pills present in the other examples.\n\n\n-----\n\nResearch into some of these domains turned up some interesting results. Talos found that\nthis particular registrant account was also tied to domains associated with other threats\nincluding Bedep, Kazy, Symmi, and Chir mail worm. The registrant held domains that are\nclosely related to those Trojans. As far as its relation to Bedep, we found DGA domains\nregistered to this registrant, as well as domains hosting click-fraud ads. Below are samples\nof the requests to the DGA as well as a GET request for one of the ads.\n\nSample Bedep DGA\n\nSample Click Fraud Ad\n\nThe name 'David Bowers' became increasingly important when looking through the\ndomains associated with yingw90@yahoo.com. It turns out that the same name and\naddress are being used for a portion of domains associated with yingw90@yahoo.com.\n\n\n-----\n\nThe other referer that kept showing up repeatedly was wittalparuserigh[.]com. The\ninteresting part was that we could find numerous instances where that site was a referer to\none of the news4news sites, but we could not find a single instance of a user browsing to\nthat page or any subpage directly. At this point, we were curious about the actual redirecting\nweb page contents, so we went to the URL and found:\n\nThat image should look familiar. It is an exact copy of the all the webpages that were found\non the sites running the C2 for Bedep. The data pointed to a connection to\nyingw90@yahoo.com. The next step was to start investigating wittalparuserigh[.]com.\n\nHowever, as shown above, we did not find any reference to yingw90@yahoo.com. Instead\nwe found a different email address associated with the domain. Next we looked at what\nadditional domains were registered with this email address. This user had a interesting mix\n\n\n-----\n\nof websites including normal looking domains, DGA-like domains, and adult websites. It s\nhard to imagine this user could be linked to Angler using the same default web page as the\nBedep C2 sites and not have some connection.\n\nTaking these domains and running a quick search in ThreatGrid found matches for some of\nthe domains. Additional analysis shows that this account's domains are tied to multiple\ndifferent threats, such as a Necurs Variant, Kazy, and Lurk.\n\n## Recap\n Let's pause for a minute and recap all that has been discussed to this point. It started a year ago with the Adobe Flash 0-Day that was incorporated into Angler (CVE-2015-0310). The infrastructure used to deliver the Flash 0-day exploit led Talos to a series of domains\n\n\n-----\n\n## that were not shadowed and registered to a single email address (yingw90@yahoo.com). Talos then started investigating these various leads and ended up with a group of three email addresses:\n\nThere is one final note here. While Talos was continuing its research, @Kafeine posted a\n[story about 'XXX' or the true name of the Angler exploit kit. In this post, there was a](http://malware.dontneedcoffee.com/2015/12/xxx-is-angler-ek.html?ref=blog.talosintelligence.com)\ndiscussion regarding one of the original Angler users --the indexm.html instance. While\nlooking at the information we noticed something very interesting, some of the domains\npointed back to this same email yingw90@yahoo.com.\n\n## Angler Exploit Server Visibility\n Moving back to the recent research of Angler. The image below should look familiar. It is the diagram illustrating the infrastructure we exposed.\n\n\n-----\n\nAfter our research was published, Talos was able to get some information regarding the\ncommunications of an Angler exploit server. This included repeated connections on TCP\nport 225 from the exploit server to another host. This port is actually a reserved IANA port,\nbut in this case was being used as an HTTP server with basic authentication.\n\nThis connection was made repeatedly and each time returned an executable, with a\ndifferent hash, that was being used to deliver content to the compromised user. This\nappeared to be the system that was delivering payloads to the users. The payload host was\nspecified in the HTTP transactions, but was not accompanied by DNS requests. We\nimmediately began looking at this host and found an overlap.\n\nThe domain specified in the HTTP requests to the Exploit Server is owned by the same\nregistrant account that was redirecting users to Angler landing pages with a web site using\nthe \"stock\" Bedep C2 web page. This brought the data full circle and cemented the link\nbetween Angler and Bedep.\n\n## List of Domains Registered yingw90@yahoo.com Domains\n potrafamin44as@gmail.com Domains\n john.bruggink@yahoo.co.uk Domains\n\n\n-----\n\nNote that these addresses are actively registering domains so the list may not be\nexhaustive\n\n## Conclusion\n The organizations responsible for these exploit kit campaigns are generating millions of dollars in revenue. As a result they are continually evolving to maximize the amount of users that are impacted. Security researchers are constantly trying to find common threads or connections between threats or groups of threats. This research is an excellent example of how leveraging little crumbs of information and gathering over long periods of time can provide meaningful results.\n\nAt this point Talos can draw strong connections between Angler and Bedep. It stands to\nreason that the instances of Angler that are delivering Bedep are actually tied to Angler\nitself. This would explain Bedep being leveraged to drive users to other Angler instances. It\nwould ensure, as an Angler customer, a certain amount of users would be guaranteed to be\ndriven to the Angler instance. This would also tie back to the instance that was initially\ndelivering the Flash 0-day was also owned by the same group. The additional connection\non the back-end of Angler activity to the system delivering the payloads is yet another\nthread that keeps these two groups closely aligned. It's not possible with the data we have\nto say for certain that the two groups are in fact the same. However, there are a lot of\ncoincidences that we have outlined to make the case that they are at the very least closely\nrelated and leveraging some of the same infrastructure.\n\nAdditionally, through this investigation we have found links between these activities and\nother threats including several different trojans that can be delivered through multiple\nmethods including as email attachments. This points to a larger organization that is using\nvarious threats to infect users for monetary gain.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-02-09 - Bedep Lurking in Angler's Shadows.pdf"
    ],
    "report_names": [
        "2016-02-09 - Bedep Lurking in Angler's Shadows.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dcba8e2b-93e0-4d6e-a15f-5c44faebc3b1",
            "created_at": "2022-10-25T16:07:23.816991Z",
            "updated_at": "2025-03-27T02:02:09.991944Z",
            "deleted_at": null,
            "main_name": "Lurk",
            "aliases": [],
            "source_name": "ETDA:Lurk",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1680660520,
    "ts_updated_at": 1743041322,
    "ts_creation_date": 1680511786,
    "ts_modification_date": 1680511786,
    "files": {
        "pdf": "https://archive.orkl.eu/5152bec77b2b9379eb5f185c3ddf11652ada8b47.pdf",
        "text": "https://archive.orkl.eu/5152bec77b2b9379eb5f185c3ddf11652ada8b47.txt",
        "img": "https://archive.orkl.eu/5152bec77b2b9379eb5f185c3ddf11652ada8b47.jpg"
    }
}