{
    "id": "7d4e64d1-e1b5-452f-8c77-56755f2b434e",
    "created_at": "2023-01-12T15:07:08.244833Z",
    "updated_at": "2025-03-27T02:05:58.533626Z",
    "deleted_at": null,
    "sha1_hash": "d703a9eb19a79500391b4ec48ecd0b502fd8c991",
    "title": "2020-06-25 - DarkCrewBot – The Return of the Bot Shop Crew",
    "authors": "",
    "file_creation_date": "2022-05-29T10:34:13Z",
    "file_modification_date": "2022-05-29T10:34:13Z",
    "file_size": 2097552,
    "plain_text": "# DarkCrewBot – The Return of the Bot Shop Crew\n\n**[research.checkpoint.com/2020/the-return-of-the-bot-shop-crew/](https://research.checkpoint.com/2020/the-return-of-the-bot-shop-crew/)**\n\nJune 25, 2020\n_Research By: Liron Yosefian and Ori Hamama, Network Research_\n\n## Introduction\n\n\nJune 26, 2020\n\n\nCheck Point Researchers recently discovered an ongoing, evolving campaign from a known\nhackers’ group, “DarkCrewFriends.” This campaign targets PHP servers, focusing on\ncreating a botnet infrastructure that can be leveraged for several purposes such as\nmonetization and shutting down critical services.\n\nDarkCrewFriends has been quite active over the last few years. The group offers a variety of\nservices ranging from bots to traffic services for websites, and was mentioned as the party\nresponsible for causing a data breach in an Italian news site.\n\nThe attack chain of the current campaign includes exploiting an unrestricted file upload\nvulnerability, uploading a malicious PHP web shell, and communicating with a C&C server\nusing an IRC channel. The attackers can leverage the malware’s capabilities for various\nscenarios, such as DDoS attack types and shell command execution.\n\n\n-----\n\n## The Attack Chain\n\nThe campaign’s chain includes these stages:\n\n**Figure 1: The infection chain.**\n\n**The Exploited Vulnerability**\n\nIn our initial analysis, we observed a PHP backdoor on the victims’ servers. These PHP web\nshell files were uploaded to the vulnerable servers by the attackers.\n\nMany applications allow users to upload certain files to their servers, such as images or\ndocuments. These files can put the system at risk if they are not properly handled. A remote\nattacker can send a specially-crafted request to a vulnerable server and upload an\nunrestricted file while bypassing the server’s file extension check. This can eventually result\nin arbitrary code execution on the affected system.\n\nBased on our research, the victims’ servers host Content Management sites. These\nplatforms have multiple unrestricted file upload vulnerabilities in which attackers can upload\nmalicious files to the vulnerable servers. One of these vulnerabilities has an exploit created\nand published by DarkCrewFriends.\n\n\n-----\n\n**Figure 2: The unrestricted file upload exploit published by the DarkCrewFriends.**\n\nBased on their previous exploits, this group of attackers is very familiar with this type of\nvulnerability. We can assume that the attackers used an unrestricted file upload vulnerability\nto establish their backdoor on the victims’ servers.\n\n**The PHP Backdoor**\n\nTo exploit the move_uploaded_file vulnerability and create a backdoor on the affected server,\nthe attackers uploaded the following web shell on the victim’s server. The code defines a\nGET parameter called osc and executes a decompressed base64 string. We also detected\nanother version of this PHP backdoor used by the attackers which utilizes a GET parameter\ncalled anon that was defined in the web shell code.\n\n**PHP Web Shell**\n\n**Figure 3: The PHP backdoor code.**\n\nWhen we accessed the uploaded file, the DarkCrewFriends headline appears:\n\n\n-----\n\n**Figure 4: An HTTP response from the PHP backdoor including DarkCrewFriends headline.**\n\nIn addition, the file also includes a base64 string. When we decoded this string, we saw the\nfollowing code:\n\n**Decoded Base64**\n\n\n-----\n\n**Figure 5: The decoded base64 string.**\n\n**Downloading the Malicious Files**\n\nAfter the successful backdoor initialization, the attackers call a parameter known as osc. The\nattackers then access the file and pass arguments to their code through this parameter, and\nexecute the following code:\n\n\n-----\n\nWhen we decoded the string, we discovered commands to download and execute two .aff\nfiles. Afterward, all .aff files are removed.\n\n**Decoded Base64**\n\n**Figure 7: The decoded base64 string from the log.**\n\nWhen we downloaded both .aff files, we saw that those files were actually PHP and Perl\nfiles. The hidden file extension is used to avoid detection and confuse the issue. We obtained\nthe attacker’s source IP address, 190.145.107.220, from the attack log. Further investigation\nrevealed that the related domain to this address is lubrisabana[.]com.\n\n**Figure 8: The DNS history of the attacker’s IP related domain:**\n\nWe also investigated the history of the pkalexeivic[.]com domain, which was used to store\nthe malicious .aff files. We checked this domain’s DNS history and were surprised to see that\nthe last activity there also happened on the same day.\n\n\n-----\n\n**Figure 9: The DNS history of the domain used to store the aff files pkalexeivic[.]com**\n\nWe assume that this is an indicator of new activity related to this campaign.\nIn addition, we noticed that the variables names and comments in the files are written in\nItalian.\n\n**Malware Analysis**\n\nThe malware has a wide range of capabilities, including:\n\nOpen multiple processes at the same time.\nPause the script to avoid detection.\nExecute shell commands.\nExtract all the running services on the host computer.\nDownload\\Upload FTP file.\nScan open ports.\nConduct multiple DDoS attacks – UDP & TCP DDoS, “Mega DDoS”, HTTP flood, IRC\nCTCP flood, and leverage multiple open proxies to a consolidated DDoS attack.\nExecute multiple IRC commands.\n\nThe malware communicates using the IRC (Internet Relay Chat) protocol. IRC includes\nvarious commands to allow the user to perform certain actions in the IRC channels. Those\ncommands are co-opted by the malware to perform its activities. Alongside other actions, the\nbot uses the IRC commands to infect/attack other IRC servers and also to communicate with\nthe remote C&C server.\n\nAs mentioned above, various DDoS attacks are supported, and the menu of the relevant\nattack types is sent to the malware’s operator via PRIVMSG, a private message transferred\nbetween IRC users. The desired action is fetched from the C&C’s reply.\n\n**Figure 10: The multiple DDoS attack types supported by the malware.**\n\nIn the following function, the attacker downloads and executes files and performs a remote\ncode execution on the affected system:\n\n\n-----\n\n**Figure 11: The function to execute every file on the affected system.**\n\nThe attackers can also execute shell commands on the affected machine. The commands\nare sent by the C&C server:\n\n\n-----\n\n**Figure 12: The function to execute shell commands.**\n\nThe malware also has FTP upload and download capabilities:\n\n\n-----\n\n**Figure 13: The function to upload files via FTP.**\n\nFollowing the malware analysis, we noticed that variants of this malware are widely spread\nonline.\n\n\n-----\n\n**Figure 14: The Perl malware variant found in a malware samples repository.**\n\n\n-----\n\n**Figure 15: The PHP malware code in a GitHub repository:**\n\nAs of this writing, none of the files were uploaded to Virus Total.\n\n**Security Impact**\n\nThis malware has a large range of attack types and capabilities that can be used to achieve\nvarious goals. The bot can be used to steal sensitive information, damage the affected\nsystem or even crash it completely. Following the various scenarios and attack methods\ndepicted in the Malware Analysis section above, we conclude that the impact on the victim’s\ninfrastructure can be severe and have significant repercussions.\n\n**Threat Actors**\n\nBased on our code and intelligence analysis, we concluded that the threat actors responsible\nfor this campaign are linked to the hackers group DarkCrewFriends. Here are some of the\nobvious clues:\n\n\n-----\n\n**Figure 16: The DarkCrewFriends signature in the web shell code.**\n\n**Figure 17: The “real name” of the bot admin.**\n\nIn the past, this group was linked to a hacking attempt of an Italian news site:\n\n**Figure 18: The News coverage of the DarkCrewFriends news site hack.**\n\nIn addition, a deeper search in a hacking forum led us to a user named “SOULDRK” who\npublicizes his group’s exploit services. While reviewing this user’s posts in the hacking\nforum, we surmised that this user is probably Italian.\n\n\n-----\n\n**Figure 19: The user SOULDRK’s promotion of the DarkCrew services.**\n\nAs mentioned previously, the group offers a number of different services, including bots and\ntraffic services for websites. All their services are priced and the payment is in BTC only. We\ntracked multiple threads and related posts in the forum. Those posts were published\nbetween 2013-2015 which is consistent with the malware repositories dates and the Italian\nnews site hacking.\n\nFurthermore, we saw the following recent post from September 2019:\n\n**Figure 20: A recent post by SOULDRK.**\n\nIn this post, the attackers sought a new domain to host their malware associated with the\naforementioned campaign.\n\n**The Bot Shop Services**\n\nThe attackers create a network of botnets by using the IRC protocol to infect connected\nservers. This provides them with a more powerful attack tool and is also used in the traffic\nservices they offer for sale.\n\n\n-----\n\n**Figure 21: Advertisement for the DarkCrew traffic services.**\n\n\n-----\n\n**Figure 22: Advertisement for the DarkCrew bot shop services.**\n\nThe tool offered for sale can be used for a variety of purposes and comes with a user-friendly\nexplanation. DarkCrew also offers customers a range of services including installing,\nmanaging and updating their exploits.\n\n**Figure 23: Advertisement for the DarkCrew integration services**\n\n\n-----\n\n**Summary**\n\nWe have been tracking an evolving and multi-dimensional campaign carried out by\nDarkCrew Friends which targets PHP servers to create a vast botnet infrastructure. The\nassociated botnet has a broad range of attack capabilities, and can be leveraged to steal\nsensitive information and damage the victims’ systems.\n\nWe will continue to monitor the malware presence and further activity of the\nDarkCrewFriends group.\n[Check Point provides multiple layers of security coverage to its customers, including IPS .](https://www.checkpoint.com/products/intrusion-prevention-system-ips/)\n\nCheck Point Security Coverage for this campaign includes the following:\n\n**IPS protections:**\n\nCommand Injection Over HTTP\nPHP Web Shell Generic Backdoor\n\n**IOCs**\n\n**C&C server:**\n\n182[.]53.220.81\n\n**Domains:**\n\npkalexeivic[.]com\n\n**Files hashes:**\n\n52fed95c6428ceca398d601a0f0a6a36dedb51799ae28f56f4e789917226dd84\n0f3062e22d8facfa05e6e6a1299b34d6bcbf7c22aa65241f6e332b71dcc80e15\n\n**References:**\n\n[https://www.unphp.net/decode/fab0fdff9d71db61690eb90a388651eb/](https://www.unphp.net/decode/fab0fdff9d71db61690eb90a388651eb/)\n\n[https://0day.today/exploit/21551](https://0day.today/exploit/21551)\n\n[https://oucsace.cs.ohio.edu/~tysko/Attacks/2013-05-28-private-edition-perl-script.txt](https://oucsace.cs.ohio.edu/~tysko/Attacks/2013-05-28-private-edition-perl-script.txt)\n\nhttps://github.com/bartblaze/PHP[backdoors/blob/master/Deobfuscated/WebShell_0d7c88a18a0cba44f1f808de084fed1273d4](https://github.com/bartblaze/PHP-backdoors/blob/master/Deobfuscated/WebShell_0d7c88a18a0cba44f1f808de084fed1273d4911e.php)\n911e.php\n\n[https://www.zonedombratv.it/qdark-crew-friendsq-hacker-oscurano-giornale-online/](https://www.zonedombratv.it/qdark-crew-friendsq-hacker-oscurano-giornale-online/)\n\n[https://www lancianonews net/notizie/attualita/2276/attacco-hacker-per-ilgiornaledabruzzoit](https://www.lancianonews.net/notizie/attualita/2276/attacco-hacker-per-ilgiornaledabruzzoit)\n\n\n-----\n\n[https://www.stratosphereips.org/blog/2018/5/29/high-level-overview-of-a-malicious-perl-bot](https://www.stratosphereips.org/blog/2018/5/29/high-level-overview-of-a-malicious-perl-bot)\n\n[https://www.networksorcery.com/enp/protocol/irc.htm](https://www.networksorcery.com/enp/protocol/irc.htm)\n\n**Attack Source IP Addresses:**\n\n144.76.225.77\n120.132.59.40\n162.219.176.101\n117.50.19.93\n120.132.59.70\n18.85.192.253\n52.59.102.42\n95.25.166.196\n106.75.104.107\n52.32.223.195\n23.129.64.165\n199.249.230.82\n85.203.22.24\n106.75.25.223\n50.112.232.10\n35.230.27.30\n83.31.183.32\n190.145.107.220\n107.178.231.220\n34.83.169.165\n95.28.190.165\n46.101.94.163\n188.166.98.249\n54.202.149.41\n54.201.200.187\n193.90.12.119\n204.13.201.139\n185.220.101.34\n204.13.201.138\n185.220.101.62\n107.178.194.59\n34.220.40.173\n84.177.11.240\n83.31.251.106\n178.128.239.126\n54.186.178.251\n178.175.132.230\n\n\n-----\n\n107.178.194.57\n204.101.161.159\n83.31.37.12\n209.99.133.234\n37.72.190.80\n35.233.193.69\n23.129.64.102\n106.75.22.46\n185.244.212.203\n34.83.7.127\n35.233.247.62\n37.204.248.193\n120.132.95.35\n35.164.172.2\n87.112.169.71\n23.129.64.201\n194.187.249.55\n106.75.97.43\n5.228.5.132\n212.199.61.23\n83.31.19.16\n83.167.254.100\n213.33.190.164\n185.255.112.112\n54.37.16.241\n34.221.157.213\n73.253.254.129\n185.220.101.57\n95.130.12.33\n195.181.165.242\n212.83.146.139\n155.254.115.69\n199.249.230.85\n87.112.144.70\n54.213.216.220\n199.249.230.68\n185.220.102.7\n194.186.142.7\n89.208.29.60\n185.220.101.3\n197.231.221.211\n157.230.173.0\n\n\n-----\n\n34.222.104.87\n185.189.113.105\n191.101.201.28\n157.55.171.26\n52.237.155.65\n35.161.55.221\n168.90.196.138\n165.231.105.95\n84.247.60.18\n165.231.105.254\n191.101.201.84\n132.148.137.222\n52.33.162.252\n34.83.111.71\n71.243.234.3\n213.234.235.200\n181.177.119.171\n196.245.217.196\n92.23.56.239\n196.52.84.57\n190.61.28.2\n196.251.250.63\n34.208.235.9\n54.202.145.204\n89.208.29.55\n207.244.70.35\n104.129.58.15\n65.19.167.131\n185.101.32.29\n185.101.32.76\n84.177.12.149\n82.211.57.232\n92.23.62.33\n83.31.236.99\n191.101.63.19\n95.174.65.123\n147.75.111.228\n194.99.106.150\n\n144.76.225.77\n120.132.59.40\n162.219.176.101\n117.50.19.93\n\n\n-----\n\n120.132.59.70\n18.85.192.253\n52.59.102.42\n95.25.166.196\n106.75.104.107\n52.32.223.195\n23.129.64.165\n199.249.230.82\n85.203.22.24\n106.75.25.223\n50.112.232.10\n35.230.27.30\n83.31.183.32\n190.145.107.220\n107.178.231.220\n34.83.169.165\n95.28.190.165\n46.101.94.163\n188.166.98.249\n54.202.149.41\n54.201.200.187\n193.90.12.119\n204.13.201.139\n185.220.101.34\n204.13.201.138\n185.220.101.62\n107.178.194.59\n34.220.40.173\n84.177.11.240\n83.31.251.106\n178.128.239.126\n54.186.178.251\n178.175.132.230\n107.178.194.57\n204.101.161.159\n83.31.37.12\n209.99.133.234\n37.72.190.80\n35.233.193.69\n23.129.64.102\n106.75.22.46\n185.244.212.203\n\n\n-----\n\n34.83.7.127\n35.233.247.62\n37.204.248.193\n120.132.95.35\n35.164.172.2\n87.112.169.71\n23.129.64.201\n194.187.249.55\n106.75.97.43\n5.228.5.132\n212.199.61.23\n83.31.19.16\n83.167.254.100\n213.33.190.164\n185.255.112.112\n54.37.16.241\n34.221.157.213\n73.253.254.129\n185.220.101.57\n95.130.12.33\n195.181.165.242\n212.83.146.139\n155.254.115.69\n199.249.230.85\n87.112.144.70\n54.213.216.220\n199.249.230.68\n185.220.102.7\n194.186.142.7\n89.208.29.60\n185.220.101.3\n197.231.221.211\n157.230.173.0\n34.222.104.87\n185.189.113.105\n191.101.201.28\n157.55.171.26\n52.237.155.65\n35.161.55.221\n168.90.196.138\n165.231.105.95\n84.247.60.18\n\n\n-----\n\n165.231.105.254\n191.101.201.84\n132.148.137.222\n52.33.162.252\n34.83.111.71\n71.243.234.3\n213.234.235.200\n181.177.119.171\n196.245.217.196\n92.23.56.239\n196.52.84.57\n190.61.28.2\n196.251.250.63\n34.208.235.9\n54.202.145.204\n89.208.29.55\n207.244.70.35\n104.129.58.15\n65.19.167.131\n185.101.32.29\n185.101.32.76\n84.177.12.149\n82.211.57.232\n92.23.62.33\n83.31.236.99\n191.101.63.19\n95.174.65.123\n147.75.111.228\n194.99.106.150\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-25 - DarkCrewBot – The Return of the Bot Shop Crew.pdf"
    ],
    "report_names": [
        "2020-06-25 - DarkCrewBot – The Return of the Bot Shop Crew.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536028,
    "ts_updated_at": 1743041158,
    "ts_creation_date": 1653820453,
    "ts_modification_date": 1653820453,
    "files": {
        "pdf": "https://archive.orkl.eu/d703a9eb19a79500391b4ec48ecd0b502fd8c991.pdf",
        "text": "https://archive.orkl.eu/d703a9eb19a79500391b4ec48ecd0b502fd8c991.txt",
        "img": "https://archive.orkl.eu/d703a9eb19a79500391b4ec48ecd0b502fd8c991.jpg"
    }
}