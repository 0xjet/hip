{
    "id": "ed6a4167-cf4e-4be3-b063-6b99c2b82ef4",
    "created_at": "2023-01-12T15:03:48.8773Z",
    "updated_at": "2025-03-27T02:15:37.997921Z",
    "deleted_at": null,
    "sha1_hash": "05b072a589b15ed2e2c0e71753aa3f7cac55cfff",
    "title": "2019-04-10 - OSINT Reporting Regarding DPRK and TA505 Overlap",
    "authors": "",
    "file_creation_date": "2022-05-28T17:01:05Z",
    "file_modification_date": "2022-05-28T17:01:05Z",
    "file_size": 303101,
    "plain_text": "# OSINT Reporting Regarding DPRK and TA505 Overlap\n\n**[norfolkinfosec.com/osint-reporting-on-dprk-and-ta505-overlap/](https://norfolkinfosec.com/osint-reporting-on-dprk-and-ta505-overlap/)**\n\nnorfolk April 10, 2019\n\nYesterday, at SAS2019, BAE Systems [presented findings related to DPRK SWIFT heist](https://www.wired.com/story/atm-hacks-swift-network/)\nactivity that took place in 2018. As part of this research (a leaked video of the presentation is\navailable online), BAE included two key points not previously disclosed in the public domain:\n\n– The existence of a PowerShell backdoor attributable to DPRK, which the researchers\ndubbed PowerBrace\n\n– A possible overlap between TA505 intrusions and DPRK intrusions, suggesting a possible\nhand-off between the two groups.\n\nThis blog will leave a full analysis of those two points and the supporting context to the\npeople that found them, as it’s theirs to share; however, data that may support such\nconclusions have been available in open source for quite some time.\n\n[In early January, VNCert issued an alert regarding attacks targeting financial institutions,](http://www.vncert.gov.vn/baiviet.php?id=109)\ncontaining a mix of DPRK IOCs (including a keylogger referred to as PSLogger previously\n[analyzed by this blog), TA505 IOCs (previously published by 360 TIC), and a handful of](https://ti.360.net/blog/articles/excel-4.0-macro-utilized-by-ta505-to-target-financial-institutions-recently-en/)\nPowerShell scripts that are generally identical aside from a handful of configuration changes.\nFurthermore, the aforementioned keylogger was first uploaded by a submitter (fabd7a52) in\nPakistan in December 2018. That same submitter acted as the first uploader for one of the\nPowerShell samples identified below (b88d4d72fdabfc040ac7fb768bf72dcd), further\ncorroborating a possible link.\n\nGiven the multi-sourced reporting overlaps and the additional Pakistan findings mentioned\nabove, this blog assesses that the PowerShell scripts in question likely belong to the same\nfamily of DPRK-attributable malware reported by BAE systems.\n\nA listing of selected IOCs is below the fold, alongside a few brief notes (and a script) for how\nto analyze the PowerShell malware.\n**IOCs from VNCert**\n\nTA505:\n\nThese contain infrastructure overlaps with reporting from the same month found here:\nhttps://ti.360.net/blog/articles/excel-4.0-macro-utilized-by-ta505-to-target-financialinstitutions-recently-en/\n\nMD5: 5B7244C47104F169B0840440CDEDE788\n\nMD5: cc29adb5b78300b0f17e566ad461b2c7\n\nMD5: E00499E21F9DCF77FC990400B8B3C2B5\n\n\n-----\n\nMD5: 53F7BE945D5755BB628DEECB71CDCBF2\nMD5: 9c35e9aa9255aa2214d704668b039ef6\nMD5: 2e0d13266b45024153396f002e882f15\nMD5: 26f09267d0ec0d339e70561a610fb1fd\nMD5: 09e4f724e73fccc1f659b8a46bfa7184\n\nDPRK:\nHSMBalance.exe MD5:34404a3fb9804977c6ab86cb991fb130 – Keylogger\nICAS.ps1 MD5: b12325a1e6379b213d35def383da2986 – Possible PowerBrace\nMD5: 8a41520c89dce75a345ab20ee352fef0 – Possible PowerBrace\nMD5: 7c651d115109fd8f35fddfc44fd24518 – Possible PowerBrace\nMD5: b88d4d72fdabfc040ac7fb768bf72dcd – Possible PowerBrace\nMD5: 3be75036010f1f2102b6ce09a9299bca – Possible PowerBrace\n\nSeveral hashes were omitted: these were EML files that belong to specific financial\norganizations. Others were not on VirusTotal or were not read properly by OCR.\n**A Few Notes on the PowerShell Backdoor**\n\nMD5 Used: b12325a1e6379b213d35def383da2986 (ICAS.ps1)\nC2: 192.95.14.128\n\nAs previously mentioned, this blog will not be publishing a full analysis of this backdoor in\ndeference to the people who first found it; however, in the interest of helping analysts who\nneed the data, there are a few key points to mention:\n\n– The backdoor uses a configuration file that includes two C2 servers and a series of Base64\nencoded commands\n– Most of the malware’s function names have been replaced with MD5 hashes\n\n**A snippet of the encoded configuration and obfuscated functions. Right click and**\n**open in a new tab to expand.**\n\nA script below has been included that performs the Base64 transformation on values where it\ncan find them. To analyze this script, this blog then recommends the following process:\n\n\n-----\n\n1) Using an easily identifiable command name (decoded by the script), locate that\ncommand’s use in a function\n2) Identify references between that command and other functions\n3) Rename those other functions\n4) Repeat\n\nAn example of decoded data (with variables and functions renamed manually) is below:\n\n**A portion of the partially decoded and deobfuscated PowerShell backdoor**\nA script to assist with this is here:\n\n\n-----\n\n```\nimport base64\nimport re\nc = open(\"c:\\\\users\\\\[username]\\\\desktop\\\\[filename]\").readlines()\nline_list = []\nfor line in c:\n  #print(line)\n  try:\n    enc = re.search(\"(?<=\\$\\(\\[Text.Encoding\\]::Unicode.GetString\\(\\\n[Convert\\]::FromBase64String\\().*?(?=\\))\",line).group()\n          print(line)\n          print(enc)\n          d = ('\"' + base64.b64decode(enc) + '\"')\n          e = (re.sub(\"\\$\\(\\[Text.Encoding\\]::Unicode.GetString\\(\\\n[Convert\\]::FromBase64String\\(.*?\\)\\)\\)\",d,line))\n          f = re.sub(\"\\0\",\"\",e)\n          line_list.append(f)\n  except:\n    line_list.append(line)\nwith open(\"c:\\\\users\\\\[username]\\\\desktop\\\\laz_decoded.ps1\",\"wt\") as t:\n  for unit in line_list:\n    t.write(unit)\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-04-10 - OSINT Reporting Regarding DPRK and TA505 Overlap.pdf"
    ],
    "report_names": [
        "2019-04-10 - OSINT Reporting Regarding DPRK and TA505 Overlap.pdf"
    ],
    "threat_actors": [
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535828,
    "ts_updated_at": 1743041737,
    "ts_creation_date": 1653757265,
    "ts_modification_date": 1653757265,
    "files": {
        "pdf": "https://archive.orkl.eu/05b072a589b15ed2e2c0e71753aa3f7cac55cfff.pdf",
        "text": "https://archive.orkl.eu/05b072a589b15ed2e2c0e71753aa3f7cac55cfff.txt",
        "img": "https://archive.orkl.eu/05b072a589b15ed2e2c0e71753aa3f7cac55cfff.jpg"
    }
}