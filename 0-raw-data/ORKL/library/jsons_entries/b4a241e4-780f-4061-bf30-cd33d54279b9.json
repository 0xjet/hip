{
    "id": "b4a241e4-780f-4061-bf30-cd33d54279b9",
    "created_at": "2023-01-12T15:00:47.316774Z",
    "updated_at": "2025-03-27T02:12:03.960911Z",
    "deleted_at": null,
    "sha1_hash": "3b859d80d04b8021482c51a2836aa3ef364daac3",
    "title": "2021-03-09 - Microsoft Exchange attacks cause panic as criminals go shell collecting",
    "authors": "",
    "file_creation_date": "2022-05-27T19:59:12Z",
    "file_modification_date": "2022-05-27T19:59:12Z",
    "file_size": 188197,
    "plain_text": "# Microsoft Exchange attacks cause panic as criminals go shell collecting\n\n**blog.malwarebytes.com/malwarebytes-news/2021/03/microsoft-exchange-attacks-cause-panic-as-criminals-go-shell-**\ncollecting/\n\nPieter Arntz March 9, 2021\n\n[Only last week we posted a blog about multiple zero-day exploits being used to attack on-](https://blog.malwarebytes.com/exploits-and-vulnerabilities/2021/03/patch-now-exchange-servers-attacked-by-hafnium-zero-days/)\npremises versions of Microsoft Exchange Server in limited and targeted attacks. Seeing how\nthis disclosure came with a patch being available, under normal circumstances you would\nsee some companies update quickly and others would dally until it bubbled up to the top of\ntheir to-do list.\n\nThis attack method, called ProxyLogon and attributed to a group called Hafnium, was\ndifferent. It went from “limited and targeted attacks” to a full-size panic in no time. Attackers\nare using the Exchange bugs to access vulnerable servers before establishing web shells to\ngain persistence and steal information.\n\n## How did this situation evolve? A timeline\n\nTo demonstrate how this situation came about we want to show you this timeline of\ndevelopments:\n\n[December 2020, CVE-2021-26855 is discovered by DEVCORE, who named the](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26855)\nvulnerability ProxyLogon.\nJanuary 2021, DEVCORE send an advisory and exploit to Microsoft through the MSRC\nportal.\n[January 2021, Volexity and](https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/) [Dubex start to see exploitation of Exchange vulnerabilities.](https://www.dubex.dk/aktuelt/nyheder/please-leave-an-exploit-after-the-beep)\nJanuary 27, 2021, Dubex shares its findings with Microsoft.\nFebruary 2, 2021, Volexity informs Microsoft of its findings.\n[March 2, 2021, Microsoft publishes a patch and advisory, which has been updated a](https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/)\nfew times since then.\nMarch 4, 2021, The Cybersecurity and Infrastructure Security Agency issues an\n[emergency directive after CISA partners observe active exploitation of vulnerabilities in](https://cyber.dhs.gov/ed/21-02/)\nMicrosoft Exchange on-premises products.\nMarch 5, 2021, Microsoft and many security vendors see increased use of these\nvulnerabilities in attacks targeting unpatched systems, by multiple malicious actors, not\njust Hafnium.\nMarch 8, 2021, CISA issues a [warning that it is aware of widespread domestic and](https://us-cert.cisa.gov/ncas/current-activity/2021/03/06/microsoft-ioc-detection-tool-exchange-server-vulnerabilities)\ninternational exploitation of these vulnerabilities.\n\n[The attacks went from a limited Advanced Persistent Threat (APT) used against targeted](https://blog.malwarebytes.com/glossary/advanced-persistent-threat-apt/)\nvictims to [cryptomining operations run by “common” cybercriminals in no time flat.](https://www.carbonblack.com/blog/cb-tau-technical-analysis-dltminer-campaign-targeting-corporations-in-asia/)\n\n\n-----\n\nWhat often happens after vulnerabilities get disclosed and patched is that criminals reverse\nengineer the fix to create their own copycat exploits, so they can attack while systems are\nunpatched. Sometimes it takes a lot of skills and perseverance to get a vulnerability to work\nfor you, but looking at the rapid introduction of these Exchange exploits into the threat\nlandscape, this one looks like a piece of cake.\n\n## Victims\n\nAs of 8 March, Malwarebytes had detected malicious web shells on close to 1,000 unique\nmachines already. Although most of the recorded attacks have occurred in the United States,\norganizations in other countries are under attack as well.\n\n_Instances found of Backdoor.Hafnium_\nChris Krebs, the former director of CISA, reckons government agencies and small\nbusinesses will be more affected by these attacks than large enterprises. Enterprises tend to\nuse different software than on-premises Exchange Servers.\n\n\n-----\n\nDistribution of Backdoor.Hafnium detections by country by 8 March, 2021\nBut Brian Krebs, in a post on his site, states that the Hafnium hackers have accelerated\nattacks on vulnerable Exchange servers since Microsoft released the patches. His sources\ntold him that 30,000 organizations in the US have been hacked as part of this campaign.\n\n## Web shells\n\nA web shell is as a malicious script used by an attacker that allows them to escalate and\nmaintain persistent access on an already compromised web application. (Not every web\nshell is malicious, but the non-malicious ones are not interesting to us in this context.)\n\nWeb shells don’t attack or exploit a remote vulnerability, they are always the second step of\nan attack. Even if it opens the door to further exploitation, a web shell itself is always\ndropped after an initial exploitation.\n\nWeb shell scripts can be written in any of the programming languages designed for use on\nthe web. You will find PHP, ASP, Perl, and many others. Attackers who successfully use web\nshells take advantage of the fact that many organizations do not have complete visibility into\nthe HTTP sessions on their servers. And most web shells are basically non-executable files,\n[which can make it hard for traditional antivirus software to detect them. The tiniest web shell](https://www.pentestpartners.com/security-blog/the-tiniest-php-system-shell-ever/)\nin PHP on record is only this big:\n\n\n-----\n\n```\n<? $_GET[1] ?>\n\n```\nA shell like this will simply execute whatever command an attacker sends to the\ncompromised server. They run it by calling the script in their browser, or from a command\nline HTTP client. For example, the following url would cause a tiny web shell running on\nexample.com to execute whatever we put replaced `{command} with:`\n```\nwww.example.com/index.html?1={command}\n\n```\nAs you can see the use of this type of backdoor is easy. Once you have planted the web\nshell, you can use it to create additional web shells or steal information from the server.\n\n## What can we do?\n\nPatch as soon as you can.\n\n[Microsoft’s team has published a script on GitHub that can check the security status of](https://github.com/microsoft/CSS-Exchange/tree/main/Security)\nExchange servers. The script has been updated to include indicators of compromise (IOCs)\nlinked to the four zero-day vulnerabilities found in Microsoft Exchange Server.\n\nIt was important to patch last week, when it was just targeted attacks, but it’s all the more\nurgent now that it’s wild west out there. If you can’t patch your Exchange server, block\ninternet access to it, or restrict access to it by blocking untrusted connections, or putting the\nserver behind your VPN.\n\nScan your server for the presence of malicious web shells. Security vendors have added\ndetection for the publicly posted IOCs and some will detect other malicious web shells as\nwell.\n\nMalwarebytes’ generic detection name for malicious web shells is Backdoor.WebShell and\nthe detection name for the web shells that are tied directly to the Hafnium group is\n[Backdoor.Hafnium.](https://blog.malwarebytes.com/detections/backdoor-hafnium/)\n\n\n-----\n\nMalwarebytes detecting Backdoor.Hafnium\n[We’ll update the timeline in our first article on this topic as more developments and fresh](https://blog.malwarebytes.com/exploits-and-vulnerabilities/2021/03/patch-now-exchange-servers-attacked-by-hafnium-zero-days/)\ninformation comes to light.\n\nStay safe, everyone!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-09 - Microsoft Exchange attacks cause panic as criminals go shell collecting.pdf"
    ],
    "report_names": [
        "2021-03-09 - Microsoft Exchange attacks cause panic as criminals go shell collecting.pdf"
    ],
    "threat_actors": [
        {
            "id": "529c1ae9-4579-4245-86a6-20f4563a695d",
            "created_at": "2022-10-25T16:07:23.702006Z",
            "updated_at": "2025-03-27T02:02:09.93109Z",
            "deleted_at": null,
            "main_name": "Hafnium",
            "aliases": [
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "ETDA:Hafnium",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7c969685-459b-4c93-a788-74108eab6f47",
            "created_at": "2023-01-06T13:46:39.189751Z",
            "updated_at": "2025-03-27T02:00:03.017103Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "ATK233",
                "G0125",
                "Operation Exchange Marauder",
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "MISPGALAXY:HAFNIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2704d770-43b4-4bc4-8a5a-05df87416848",
            "created_at": "2022-10-25T15:50:23.306305Z",
            "updated_at": "2025-03-27T02:00:55.43633Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "HAFNIUM",
                "Operation Exchange Marauder",
                "Silk Typhoon"
            ],
            "source_name": "MITRE:HAFNIUM",
            "tools": [
                "Tarrask",
                "ASPXSpy",
                "Impacket",
                "PsExec",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535647,
    "ts_updated_at": 1743041523,
    "ts_creation_date": 1653681552,
    "ts_modification_date": 1653681552,
    "files": {
        "pdf": "https://archive.orkl.eu/3b859d80d04b8021482c51a2836aa3ef364daac3.pdf",
        "text": "https://archive.orkl.eu/3b859d80d04b8021482c51a2836aa3ef364daac3.txt",
        "img": "https://archive.orkl.eu/3b859d80d04b8021482c51a2836aa3ef364daac3.jpg"
    }
}