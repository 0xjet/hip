{
    "id": "ec927dce-a065-4b7b-b282-38c973598c59",
    "created_at": "2023-01-12T15:07:23.353947Z",
    "updated_at": "2025-03-27T02:09:29.595708Z",
    "deleted_at": null,
    "sha1_hash": "dbc8ebd4a0154266bd9bd31dd2767ee5c69c7f36",
    "title": "2017-03-15 - MajikPOS Combines PoS Malware and RATs to Pull Off its Malicious Tricks",
    "authors": "",
    "file_creation_date": "2022-05-28T21:53:51Z",
    "file_modification_date": "2022-05-28T21:53:51Z",
    "file_size": 131153,
    "plain_text": "# MajikPOS Uses PoS Malware, RATs for Malicious Tricks\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/majikpos-combines-pos-malware-and-rats/](http://blog.trendmicro.com/trendlabs-security-intelligence/majikpos-combines-pos-malware-and-rats/)**\n\nMarch 15, 2017\n\nMalware\n\nWe’ve uncovered a new breed of point-of-sale (PoS) malware currently affecting businesses\nacross North America and Canada: MajikPOS. MajikPOS is designed to steal information,\nbut its modular approach in execution makes it distinct.\n\nBy: Cyber Safety Solutions Team March 15, 2017 Read time: ( words)\n\n[We’ve uncovered a new breed of point-of-sale (PoS) malware currently affecting businesses](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/PoS-(point-of-sale)-malware)\nacross North America and Canada: MajikPOS (detected by Trend Micro as\nTSPY_MAJIKPOS.A). Like a lot of other PoS malware, MajikPOS is designed to steal\ninformation, but its modular approach in execution makes it distinct. We estimate that\nMajikPOS’s initial infection started around January 28, 2017.\n\n[While other PoS malware FastPOS (its updated version), Gorynych and](http://blog.trendmicro.com/trendlabs-security-intelligence/fastpos-updates-in-time-for-retail-sale-season/) [ModPOS also](http://blog.trendmicro.com/trendlabs-security-intelligence/operation-black-atlas-endangers-in-store-card-payments-and-smbs-worldwide-switches-between-blackpos-and-other-tools/)\nfeature multiple components with entirely different functions like keylogging, MajikPOS’s\nmodular tack is different. MajikPOS needs only another component from the server to\nconduct its RAM scraping routine.\n\nMajikPOS is named after its command and control (C&C) panel that receives commands and\nsends exfiltrated data. MajikPOS’s operators use a combination of PoS malware and remote\naccess Trojan (RAT) to attack their targets, to daunting effects. MajikPOS is a reflection of\n\n\n-----\n\nthe [increasing complexity that bad guys are predicted to employ in their malware to neuter](https://www.trendmicro.com/vinfo/tmr/?/us/security/research-and-analysis/predictions/2017)\ntraditional defenses.\n\n**Entry Point and Attack Chain**\n\nFeedback from our [Smart Protection Network™ enabled us to determine the methods the](http://blog.trendmicro.com/en_us/business/technologies/smart-protection-network.html)\nbad guys used to illicitly gain access to the victims’ endpoints. Among them are Virtual\nNetwork Computing (VNC) and Remote Desktop Protocol (RDP), poorly secured by easy-toguess username and password combinations; and RATs previously installed in the system.\n\nAfter fingerprinting the targets—ascertaining if VNC and RDP services exist and are\naccessible—attackers will attempt to gain access using generic credentials or via brute force.\nThe common denominator in the MajikPOS compromises we’ve observed involving RATs is\nthe timeline of their infection. The RATs were installed in the endpoints somewhere between\nAugust and November, 2016.\n\nIf the endpoint piques the malefactors’ interest, they use a combination of VNC, RDP, RAT\naccess, command-line FTP (File Transfer Protocol), and sometimes a modified version of\nAmmyy Admin—a legitimate, commercially available remote administration tool—to install\nMajikPOS by directly downloading the files usually hosted on free file-hosting sites. In the\ncase of Ammyy Admin, its file manager capability is used instead. The modified version is\nsometimes named VNC_Server.exe or Remote.exe.\n\n**Configuration and C&C Communication**\n\nMajikPOS contacts its C&C server to register the infected system. Once registered, the\nserver then sends a “configuration” with three important entries that will be used in later\nsteps.\n\n_Figure 1: C&C server responds with configuration details after registration_\n\nThe C&C panel in these servers is called “Magic Panel”, as shown below:\n\n_Figure 2: Magic Panel’s login page_\n\n**RAM-scraping Routine**\n\n_Conhost.exe is the component responsible for RAM scraping (looking for credit card data on_\nthe victim’s machine). It uses information from the configuration file for this routine.\n\nMajikPOS checks a sizeable range of cards, such as American Express, Diners Club,\nDiscover, Maestro, Mastercard, and Visa. After verifying the credit card’s track data, the\ninformation is sent to the C&C server via HTTP POST, Action=”bin”.\n\n_Figure 3: Snapshot of a “Magic Dump” shop selling stolen credit card data_\n\n\n-----\n\n**Online Shops for Stolen Credit Card Data**\n\nOur foray into one of MajikPOS’s C&C servers, umbpan[.]xyz, led us to more websites with\nthe same registrant, one of which is another Magic Panel. The rest of the websites are\n“Magic Dump” shops where stolen credit card information is sold.\n\nThe Dump shops currently contain around 23,400 stolen credit card tracks, sold from US $9\nto $39 each, depending on the type of card. They can also be bought in bulk packages of 25,\n50, and 100, priced at $250, $400, and $700, respectively. Some of these websites were\nadvertised on carding forums as early as February 2017 by a user called “MagicDumps”,\nwho has been updating the forums for new dumps based on location—mostly in the U.S. and\nCanada.\n\n**MajikPOS’s Timeline**\n\nHere is a rough timeline of events related to MajikPOS, based on our findings:\n\n**Other MajikPOS Tricks**\n\nMajikPOS was written using .NET. It’s an uncommon technique, but not unheard of.\nGamaPOS, discovered in 2015, was the first documented PoS malware to use the .NET\nframework. MajikPOS, like many of today’s malware, uses encrypted communication to\nmake it harder to detect on the network level. It took advantage of open RDP ports, similar to\n[other related threats like Operation Black Atlas.](http://blog.trendmicro.com/trendlabs-security-intelligence/operation-black-atlas-endangers-in-store-card-payments-and-smbs-worldwide-switches-between-blackpos-and-other-tools/)\n\nWe also spotted instances where MajikPOS’s operators utilized commonly used lateral\nmovement hacking tools. This can be an indication of their attempts to further access the\nvictim’s network. In separate incidents, we saw a command-line tool abused to deploy\nMajikPOS, along with other PoS malware. MajikPOS is also notable with how it tries to hide\nby mimicking common file names in Microsoft Windows.\n\n**Mitigation**\n\n[Properly configured chip-and-pin credit cards with end-to-end encryption (EMVs) should be](http://blog.trendmicro.com/trendlabs-security-intelligence/moving-forward-with-emv-and-other-payment-technologies/)\nunaffected by this threat. Unfortunately, terminals that don’t support them are at risk to\nthreats like MajikPOS.\n\nWhile the U.S. has adopted EMVs—thanks to the implementation of the EMV Liability Shift\nlast October 2015—the transition has been a challenge. From July 2015 to June 2016, the\nU.S. [lagged behind in terms of EMV-based transactions. While businesses and consumers](https://www.emvco.com/about_emvco.aspx?id=202)\nacross the country are increasingly deploying and using chip-based PoS terminals, many\nmerchants, for instance, still haven’t implemented the PIN part of the chip-and-PIN process.\n[Although the use of EMV Chip-and-PIN credit cards is not a silver bullet,](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/a-year-after-the-emv-liability-shift-are-emv-cards-safe) EMVs are still a\n\n\n-----\n\n[more secure alternative compared to magnetic stripe-based credit cards that are most](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/security-technology/faq-emv-credit-cards)\naffected by PoS malware like MajikPOS. In fact, [MasterCard and](http://newsroom.mastercard.com/press-releases/u-s-emv-adoption-by-merchants-issuers-continues-industry-collaborates-on-solutions-to-speed-transaction-times/) [Visa reported a decline in](https://usa.visa.com/dam/VCOM/global/visa-everywhere/documents/chip-technology-infographic-jun16.pdf)\ncredit card fraud since utilizing EMV-enabled cards and PoS systems.\n\n[It would also be useful to take note of a good PoS Defense Model. To further mitigate](http://blog.trendmicro.com/trendlabs-security-intelligence/defending-against-pos-ram-scrapers/)\nMajikPOS, it’s recommended to properly secure remote access functionalities like remote\ndesktops and VNC, especially when these expose the host or system to the internet. For\ninfosec professionals and IT/system administrators who protect their organization’s\n[endpoints, consulting the appropriate documentation for securing Remote Desktop and](https://technet.microsoft.com/en-us/library/cc753488(v=ws.11).aspx)) [VNC](https://www.realvnc.com/docs/security-features.html)\nis a good place to start.\n\n**Trend Micro Solutions**\n\n[Endpoint application control or whitelisting can be employed to reduce attack exposure by](http://blog.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\nensuring only updates associated with whitelisted applications can be installed. Trend\nMicro’s [OfficeScan™ has many security features including Behavior Monitoring, which can](http://blog.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\nbe used to detect these names (csrss.exe and conhost.exe) by the event, “Duplicated\nSystem File”. It can also detect and prevent other malicious indicators like RATs. Trend\nMicro’s [Deep Discovery Inspector can be used to determine attempts to perform lateral](http://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection.html)\nmovement and possible brute-force activity. MajikPOS’s C&C traffic is already blocked by\nTrend Micro™ Web Reputation Services.\n\nTrend Micro’s advanced endpoint solutions such as Trend Micro™ [Smart Protection Suites,](http://blog.trendmicro.com/en_us/business/products/user-protection/sps.html)\n[and Trend Micro™ Worry-Free™](http://blog.trendmicro.com/en_us/small-business/worry-free-services-suites.html) [Business Security provide both detection and blocking of](http://blog.trendmicro.com/en_us/small-business/worry-free-services-suites.html)\nall the relevant, malicious files and C&C traffic. Implementing application control in PoS\ndevices also significantly mitigates similar attacks by ensuring that only whitelisted\napplications are allowed to execute. TippingPoint customers are protected from this threat\nwith the following ThreatDV filter:\n\n27432: HTTP: TSPY_MAJIKPOS.A Checkin\n\n[Learn more about our analysis of MajikPOS in this technical brief—its Indicators of](https://documents.trendmicro.com/assets/majikpos-combines-pos-malware-and-rats-to-pull-off-its-malicious-tricks.pdf)\nCompromise (IoCs), an in-depth look into its attack chain and malicious routines, and how\n[the stolen data are sold in underground forums and websites.](https://www.trendmicro.com/vinfo/tmr/?/us/security/threat-intelligence-center/deep-web/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-03-15 - MajikPOS Combines PoS Malware and RATs to Pull Off its Malicious Tricks.pdf"
    ],
    "report_names": [
        "2017-03-15 - MajikPOS Combines PoS Malware and RATs to Pull Off its Malicious Tricks.pdf"
    ],
    "threat_actors": [
        {
            "id": "5c457d56-6078-4a86-ac5c-e3e91fa278e7",
            "created_at": "2022-10-25T16:07:23.934665Z",
            "updated_at": "2025-03-27T02:02:10.036117Z",
            "deleted_at": null,
            "main_name": "Operation Black Atlas",
            "aliases": [],
            "source_name": "ETDA:Operation Black Atlas",
            "tools": [
                "Alina POS",
                "BlackPOS",
                "Diamond Fox",
                "DiamondFox",
                "FrameworkPOS",
                "Gorynch",
                "Gorynych",
                "Kaptoxa",
                "MMon",
                "ModPOS",
                "NewPosThings",
                "POSWDS",
                "Reedum",
                "alina_eagle",
                "alina_spark",
                "aline_joker",
                "katrina",
                "straxbot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536043,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653774831,
    "ts_modification_date": 1653774831,
    "files": {
        "pdf": "https://archive.orkl.eu/dbc8ebd4a0154266bd9bd31dd2767ee5c69c7f36.pdf",
        "text": "https://archive.orkl.eu/dbc8ebd4a0154266bd9bd31dd2767ee5c69c7f36.txt",
        "img": "https://archive.orkl.eu/dbc8ebd4a0154266bd9bd31dd2767ee5c69c7f36.jpg"
    }
}