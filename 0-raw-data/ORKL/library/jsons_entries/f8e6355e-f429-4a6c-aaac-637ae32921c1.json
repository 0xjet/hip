{
    "id": "f8e6355e-f429-4a6c-aaac-637ae32921c1",
    "created_at": "2023-01-12T15:07:07.747172Z",
    "updated_at": "2025-03-27T02:06:00.958122Z",
    "deleted_at": null,
    "sha1_hash": "389c704861389e35653888a2bddb7aad87f2c3a1",
    "title": "2021-10-26 - High(er) Fidelity Software Supply Chain Attack Detection",
    "authors": "",
    "file_creation_date": "2022-05-28T05:03:42Z",
    "file_modification_date": "2022-05-28T05:03:42Z",
    "file_size": 783679,
    "plain_text": "# High(er) Fidelity Software Supply Chain Attack Detection\n\n**[splunk.com/en_us/blog/security/high-er-fidelity-software-supply-chain-attack-detection.html](https://www.splunk.com/en_us/blog/security/high-er-fidelity-software-supply-chain-attack-detection.html)**\n\nOctober 26, 2021\n\nBy [Marcus LaFerrera October 26, 2021](https://www.splunk.com/en_us/blog/author/mlaferrera.html)\nOver the last year, many of us have been introduced to the term “Software Supply Chain”.\nFor better or worse, it is now part of our defense vernacular and won’t be going away any\ntime soon. If anything, it has consumed us in many ways and has been the cause of many\n[nights of lost sleep. Well, that could just be us on the SURGe team here at Splunk.](http://www.splunk.com/surge)\n\nLast year, after the [Solarwinds Orion supply chain attack, we decided to take a closer look](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html)\n\n\n-----\n\nat software supply chain attacks. We knew it would be a challenging subject to tackle,\nespecially considering the wide swath of software, services, infrastructure, people, and all of\nthe other bits and bobs that make up our computing life. It turns out that software supply\nchain attacks are far more common than we’d like to think. The European Union Agency for\n[Cybersecurity (EINSA) recently published a report detailing about 25 known software](https://www.enisa.europa.eu/news/enisa-news/understanding-the-increase-in-supply-chain-security-attacks)\nsupply chain attacks between January 2020 and July of 2021 alone.\n\n\n-----\n\n_Source:_ _[https://www.enisa.europa.eu/publications/threat-landscape-for-supply-chain-attacks](https://www.enisa.europa.eu/publications/threat-landscape-for-supply-chain-attacks)_\n\nOver the last few months, we’ve embarked on some research to explore methods to\npotentially detect supply chain attacks and shed some light on this dark corner of cyber\ndefense. We purposefully limited our scope to methodologies that had the potential to be\nuseful in detecting abnormal activity on critical servers that are terrifying to look at\nsideways, nevermind patching. Why would we limit our scope so much? Well, it turns out\ndetecting supply chain attacks isn’t easy. It’s actually pretty hard. We also wanted to ensure\nthat whatever the end result was, it would be useful for a majority of our readers, not just\n[the wizards, as Ryan Kovar, leader of the SURGe team, would say.](https://www.splunk.com/en_us/blog/author/rkovar.html)\n\nAfter much deliberation, we came to the conclusion that focusing on JA3 and JA3s hashes\nwould be a fun and perhaps rewarding path forward. What is this magical alphanumeric\nstring I speak of? I’m glad you asked. We won’t go into much detail here, but suffice it to say\nit is a fairly simple, yet ingenious, method to fingerprint TLS negotiations between a client\nand a server. I know, you want to know more. Well, we recommend that you check out\n\n\n-----\n\n[some amazing research by Lee Brotherson and even more from the fine folks over at](https://blog.squarelemon.com/tls-fingerprinting/)\n[Salesforce that](https://engineering.salesforce.com/tls-fingerprinting-with-ja3-and-ja3s-247362855967) [open-sourced their JA3 code. After reading that, you should come away](https://github.com/salesforce/ja3)\nwith a great understanding of TLS fingerprinting and how JA3 works.\n\n## Can You At Least Show Me Something?\n\nOf course! Let’s go over the useful information rather than just talk about our inspirational\njourney. What would a Splunk blog post be without some screenshots of Splunk? One of\nthe queries we developed uses Splunk’s [anomalydetection command. In this query we’re](https://docs.splunk.com/Documentation/Splunk/latest/SearchReference/Anomalydetection)\ngoing to simply try to find some anomalous TLS sessions in our Zeek logs coming from our\ncritical server netblock, 192.168.70.0/24.\n```\nsourcetype=\"bro:ssl:json\" ja3=\"*\" ja3s=\"*\" src_ip IN (192.168.70.0/24)\n| anomalydetection method=histogram action=annotate pthresh=0.0001 src_ip, ja3, ja3s\n| stats sparkline max(log_event_prob) AS \"Max Prob\", min(log_event_prob) AS \"Min\nProb\", values(probable_cause) AS \"Probable Causes\", values(dest_ip) AS \"Dest IPs\",\nvalues(server_name) AS \"Server Names\", values(ja3) AS \"JA3\", values(src_ip) as\n\"Source IPs\" count by ja3s\n| table \"Server Names\", \"Probable Causes\", \"Max Prob\", \"Min Prob\", \"Dest IPs\", ja3s,\n\"JA3\", \"Source IPs\", count\n| sort \"Min Prob\" asc\n\n```\nOnce we run this query, we’ll be able to see that there are some anomalies in the data we\nshould probably take a look at. Namely, the TLS sessions that are reaching out to\nmanic.imperial-stout.org and update.lunarstiiiness.com.\n\n\n-----\n\nTo make these results even more useful, we can also include an allow list in our query. This\nwill help to ensure some of the more benign hosts that we would expect to see (such as\nlegitimate software update sessions) aren’t included in our results.\n\nNow we’re getting somewhere. All of our suspicious queries have bubbled their way right to\nthe top of our list. Right where suspicious data belongs.\n\n## Great Teaser, Is There More We Can See?\n\nWe spent a lot of time not only conducting our research, but we also wrote a beautiful white\npaper that provides far more detail than this blog post. Not enough? No problem. Ryan\nKovar and I are also presenting on this very topic at Splunk’s annual conference, .conf21.\nYou can check out our talk Hunting the Known Unknown: Supply Chain Attacks\n[(SEC1745C) to see us in all of our on-screen glory. Still want more? Did I mention that](https://conf.splunk.com/learn/session-scheduler.html?search=SEC1745C#/)\nwe’ve written a white paper? You can check out all of the queries we’ve developed, along\nwith a few bits of code we developed specifically for this research. One of them being a nifty\n[way to generate anomalous TLS sessions that mimic Zeek](https://zeek.org/) [SSL logs.](https://docs.zeek.org/en/master/logs/ssl.html)\n\nDo you want even more? Well then, you’ve come to the right place. You can also play along\ntoday, as in right now, with [Boss of the SOC (BOTS). A software supply chain scenario was](https://bots.splunk.com/)\n[designed and built out by John Stoner, which was integral to our research efforts.](https://www.splunk.com/en_us/blog/author/jstoner.html)\n\nIf software supply chain in the DevSecOps realm is more your cup of tea, we’d highly\n[suggest you take a look at Dave Herrald and](https://www.splunk.com/en_us/blog/author/dherrald.html) [Chris Riley’s talk from this years’ .conf21,](https://www.splunk.com/en_us/blog/author/criley.html)\n[Enabling DevSecOps and Securing the Software Factory with Splunk (SEC1108C). They](https://conf.splunk.com/learn/session-scheduler.html?search=SEC1108C)\nput together a lot of terrific content to better understand how Splunk can be used in your\nDevSecOps pipeline to better defend against and detect software supply chain attacks.\n\n## One Step Ahead\n\nSoftware supply chain attacks are not going away. As our network defenses improve,\nadversaries must move up the chain to stay a step ahead of our defenses. This cat and\nmouse game is the nature of network defense. It’s why we lose sleep, working to think of\nnew and novel ways to help everyone detect adversaries and stay safe. Our research\npresented here sadly isn’t a silver bullet. It won’t solve the software supply chain problem\n\n\n-----\n\ntoday, or at all. What it will do however, is provide everyone with another tool and means of\nstaying ahead of adversaries. With any luck, it will also help start a conversation and inspire\nothers to explore interesting avenues of detection, ensuring we can all sleep better at night.\n\nPosted by\n\n**[Marcus LaFerrera](https://www.splunk.com/en_us/blog/author/mlaferrera.html)**\n\nUS | JP | Pentagon | DARPA | Splunk\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-26 - High(er) Fidelity Software Supply Chain Attack Detection.pdf"
    ],
    "report_names": [
        "2021-10-26 - High(er) Fidelity Software Supply Chain Attack Detection.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536027,
    "ts_updated_at": 1743041160,
    "ts_creation_date": 1653714222,
    "ts_modification_date": 1653714222,
    "files": {
        "pdf": "https://archive.orkl.eu/389c704861389e35653888a2bddb7aad87f2c3a1.pdf",
        "text": "https://archive.orkl.eu/389c704861389e35653888a2bddb7aad87f2c3a1.txt",
        "img": "https://archive.orkl.eu/389c704861389e35653888a2bddb7aad87f2c3a1.jpg"
    }
}