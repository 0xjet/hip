{
    "id": "e1f9662f-7303-4695-971f-2a8d21199731",
    "created_at": "2023-01-12T15:02:29.321549Z",
    "updated_at": "2025-03-27T02:09:08.003306Z",
    "deleted_at": null,
    "sha1_hash": "55c9b6cdaabaa726a627eed38952ae847eff4f6c",
    "title": "2021-01-06 - All About Doki Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T19:14:31Z",
    "file_modification_date": "2022-05-28T19:14:31Z",
    "file_size": 197860,
    "plain_text": "# All About Doki Malware\n\n**securecoding.com/blog/all-about-doki-malware/**\n\n1 Like Unlike\nJanuary 6th, 2021\n\n\nJanuary 6, 2021\n\n\nSoftware is as competent as the programmers who develop it. This has led to a world of\nmarvellous and effective technologies across a wide spectrum of channels and media. It also\nleads along the way to the creation of software that is incredibly malicious, and in some\ncases quite dangerous.\n\nWe are talking about malware. Malware, or malicious software, is any device or directory\nwhich is harmful to the machine of a user. It is the standard term of a diverse range of\nmalicious software types including viruses, ransomware, and spyware.\n\nIn the past several decades, almost everything has fundamentally changed when it comes to\nmalware and malware analysis. Threats such as malicious software have been around for\ndecades but during this period they were referred to as viruses. The Creeper virus from\n1971, developed as a test by BBN Technologies engineer Robert Thomas, was among the\nfirst notable malware.\n\n\n-----\n\nHowever, Yisrael Rada first introduced the term malware in 1990. Most of these early\ncontagious programs were originally released as tricks or prototypes but attackers are now\nusing malware to harvest corporate, financial, and private data.\n\nDifferent forms of malware have distinct characteristics and functionality. These malicious\nprograms may perform various functions, such as pilfering, intercepting or erasing\nconfidential data, modifying or sabotaging fundamental computing functions, and tracking\nusers’ computer operations without their consent.\n\n## Doki Malware and Its Cause\n\nDoki malware is a recent trojan that spreads via the Ngrok botnet using Dogecoin wallets for\nits C2. It targets publicly accessible Docker servers. Doki has been unrecognized for more\nthan seven months as malware on VirusTotal, saying it is”an undetected backdoor.”\n\nAccording to Intezer cybersecurity researchers, Doki has a pervasive code-execution\ncapability on a compromised server, gearing up for any variety of malware-based operations,\nfrom denial-of – service/subversion to data eavesdropping to malware.\n\n\n-----\n\nDoki operates as an unnoticeable loophole for Linux, which constitutes an extension of the\nNgrok Botnet program from two years ago. Disconcertingly, since it was first discovered in\nJanuary 2020, it has also managed to avoid each of the 60 malware platforms identified on\nVirusTotal.\n\nDoki uses a previously unrecognized approach to access its user by breaching the Dogecoin\ncrypto-currency blockchain in a particular means to develop its C2 domain address remotely.\n\nThe vulnerability targets faulty containerized cloud systems. The hackers search for and\nmanipulate publicly available Docker API terminals to mount their containers and deploy\nmalware on the infrastructure of the perpetrators. Throughout that attack, the intruders revive\nand delete several containers.\n\nEvery container produced during the attack is predicated on an alpine image configured with\ncurl. The image on the Docker platform is not malevolent, but to perform malicious activities\nit is being misused. Curl commands are implemented using a curl application picture as soon\nas the container is likely to launch.\n\n## Prevention\n\nHigher security hygiene and stipulations designed especially for container conditions can\ndefeat Doki.\n\n### Step 1\n\n\n-----\n\nDoki sets off their invasion by searching a network for a poorly configured port of the Docker\nAPI. The attacker calls the Docker API to cause a request and open a clean container after\nthey have identified a Docker port to manipulate. Security testing engines won’t find any\nproblems with this. Before the attack escalates, it is a test site.\n\nAttackers will use the containers they are manipulating to build more containers easily to\ncause any suspicious attacks. Doki creates a command-and-control connection, using the\nngrok tunneling tool. Several specific short-lived URLs allow attackers to quickly download\npayloads into the file server of the container.\n\n### Step 2\n\nWhen logs are gathered and warnings are sent, the container is gone without a hint. By\nlinking the host root file system the attack container uploads the host system. Then it\nmodifies the cron functionality and achieves resources for host execution. Typical of\ncontainer attacks, the malicious application may try to return to the host once an entitled\ncontainer is managed.\n\n### Step 3\n\nThe attack creates a host cron job with a network detector and a plugin script that\nimplements every minute a malicious script. Using a list of public domain IP ranges, the\nnetwork scanner scans for another target.\n\n### Step 4\n\nThis Doki malware will function as a container or as a server, and can easily be scaled up.\nDoki requests the Dogecoin API, uses SHA265 protection and generates a run-time URL\naddress interactively. This bypasses network infrastructure security screening like the URL /\nIP blacklist lists.\n\n## Conclusion\n\n“Doki” is a complex malware attack that exploits the current Docker architecture to strike,\nexploit, and distribute the architecture. To detect and block complex links, unwanted\nprocess/file operation, and privilege incursions, modern container and cloud infrastructures\nneed similarly contemporary information security.\n\nThe Doki malware is lightweight and unchanging, taking just several minutes to afflict and\nramp up an attack. Runtime containers and host teams consisting of manufacturing\nenvironments are the most important protections to combat Doki (and subsequent attacks\nthat have come and will come) before they can cause mayhem.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-06 - All About Doki Malware.pdf"
    ],
    "report_names": [
        "2021-01-06 - All About Doki Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535749,
    "ts_updated_at": 1743041348,
    "ts_creation_date": 1653765271,
    "ts_modification_date": 1653765271,
    "files": {
        "pdf": "https://archive.orkl.eu/55c9b6cdaabaa726a627eed38952ae847eff4f6c.pdf",
        "text": "https://archive.orkl.eu/55c9b6cdaabaa726a627eed38952ae847eff4f6c.txt",
        "img": "https://archive.orkl.eu/55c9b6cdaabaa726a627eed38952ae847eff4f6c.jpg"
    }
}