{
    "id": "2d8aa29e-aa2a-4758-b7f3-9a1fa861bcd1",
    "created_at": "2023-01-12T15:05:46.278558Z",
    "updated_at": "2025-03-27T02:11:01.626875Z",
    "deleted_at": null,
    "sha1_hash": "9c08a277e991dbfcad10fb8f9cf38ea901c008fd",
    "title": "2020-06-04 - Threat Spotlight- Tycoon Ransomware Targets Education and Software Sectors",
    "authors": "",
    "file_creation_date": "2022-05-28T18:08:56Z",
    "file_modification_date": "2022-05-28T18:08:56Z",
    "file_size": 3997792,
    "plain_text": "# Threat Spotlight: Tycoon Ransomware Targets Education and Software Sectors\n\n**[blogs.blackberry.com/en/2020/06/threat-spotlight-tycoon-ransomware-targets-education-and-software-sectors](https://blogs.blackberry.com/en/2020/06/threat-spotlight-tycoon-ransomware-targets-education-and-software-sectors)**\n\nThe BlackBerry Research & Intelligence Team, KPMG’s UK Cyber Response Services Team\n\n**Overview**\n\nTycoon is a multi-platform Java ransomware targeting Windows® and Linux® that has been observed in-the-wild since at least December\n2019[1]. It is deployed in the form of a Trojanized Java Runtime Environment (JRE) and leverages an obscure Java image format to fly under\nthe radar.\n\nThe threat actors behind Tycoon were observed using highly targeted delivery mechanisms to infiltrate small to medium sized companies and\ninstitutions in education and software industries, where they would proceed to encrypt file servers and demand a ransom. However, due to\nthe reuse of a common RSA private key it may be possible to recover data without the need for payment in earlier variants.\n\n**Delivery**\n\nThe BlackBerry Research and Intelligence Team in partnership with KPMG’s UK Cyber Response Services recently unearthed a new\nransomware strain written in Java. The ransomware was deployed in a targeted attack against an organization, where the system\nadministrators had been locked out of their systems following an attack on their domain controller and file servers. After conducting forensic\ninvestigations of the infected systems, it became apparent that the initial intrusion occurred via an Internet-facing RDP jump-server.\n\nThe following illustration demonstrates how the attackers managed to gain initial access and started infecting systems across the estate:\n\n\n-----\n\n_Figure 1: Attack timeline_\n\nPost-incident analysis of the Internet-facing RDP server could not be performed as it had already been restored. However, our analysis of the\nvictim machines revealed that some of the techniques used by the attacker were unusual and noteworthy:\n\nTo achieve persistence on the victim’s machine, the attackers had used a technique called Image File Execution Options (IFEO)\n[injection[2]. IFEO settings are stored in the Windows registry. These settings give developers an option to debug their software through](https://attack.mitre.org/techniques/T1183/)\nthe attachment of a debugging application during the execution of a target application.\n\nA backdoor was then executed alongside the Microsoft Windows On-Screen Keyboard (OSK) feature of the operating system:\n\n_Figure 2: Registry key used to execute the backdoor_\n\nThe attackers disabled the organization’s anti-malware solution with the use of the ProcessHacker utility and changed the passwords for\nActive Directory servers. This leaves the victim unable to access their systems.\n\nMost of the attacker files were timestomped, including the Java libraries and the execution script, and had file date timestamps of 11th\nApril 2020, 15:16:22:\n\n\n-----\n\n_Figure 3: File timestamp_\n\nFinally, the attackers executed the Java ransomware module, encrypting all file servers including backup systems that were connected to the\nnetwork.\n\n**Execution**\n\nTycoon ransomware comes in form of a ZIP archive containing a Trojanized Java Runtime Environment (JRE) build. The malware is compiled\ninto a Java image file (JIMAGE) located at lib\\modules within the build directory.\n\nJIMAGE is a special file format that stores custom JRE images which is designed to be used by the Java Virtual Machine (JVM) at runtime. It\nencompasses resources and class files of all Java modules that support the specific JRE build. The format was first introduced in Java\nversion 9 and is sparsely documented. Unlike the popular Java Archive format (JAR), JIMAGE is mostly internal to the JDK and rarely used\nby developers:\n\n_Figure 4: Malicious “modules” file; JIMAGE format uses a header starting with 0xDADAFECA signature_\n\nThe OpenJDK9 jimage utility can extract and decompile Java image files:\n\n_$ ./jimage --help_\n_Usage: jimage <extract|recreate|info|list|verify> <options> jimage..._\n\nAfter extraction, the ransomware image contains three modules related to a project called \"tycoon\":\n\n\n-----\n\n_Figure 5: Contents of the ZIP archive (left) and structure of the decompiled Java modules JIMAGE (right)_\n\nThe ransomware is triggered by executing a shell script that runs the Main function of the malicious Java module using the java -m command.\n\nThe malicious JRE build contains both Windows® and Linux® versions of this script, suggesting that the threat actors are also targeting\nLinux® servers:\n\n_Figure 6: Shell scripts used to execute the ransomware, and Java “release” file_\n\n**Configuration**\n\nThe malware configuration is stored in the project’s BuildConfig file and includes information such as:\n\nThe attacker’s email address\nThe RSA public key\n\n\n-----\n\ne co te t o t e a so ote\nThe exclusions list\nThe list of shell commands to be executed\n\n**Value Name** **Example Value**\n\n**EMAIL_1** “dataissafe[at]protonmail[.]com”\n\n**EMAIL_2** “dataissafe[at]mail[.]com”\n\n**FILE_EXTENSION** “thanos”\n\n**PUBLIC_KEY** “-----BEGIN PUBLIC KEY----\\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDa+whJSxr9ngcD1T5GmjDNSUEY\\ngz5e\nvy4lE9g2M3PvVc9iLw9Ybe+NMqJwHB8FYCTled48mXQmCvRH2Vw3lPkA\\nTrQ4zbVx0fgEsoxekq\nb3GbK2NseXEeavCi5lo5/jXZi4Td7nlWTu27CluyxRSgv\\nL0O19CwzvckTM91BKwIDAQAB\\n\n-----END PUBLIC KEY-----”\n\n**NUMBER_OF_KEYS_PER_ROOT_PATH** 100\n\n**CHUNK_SIZE** 10485760L (10 MB)\n\n**ENCRYPTION_PATTERN** true, true, false, false, false, true, true, false, false, false, false, false, false, false, false, false\n\n**HEADER** 0x68, 0x61, 0x70, 0x70, 0x79, 0x6E, 0x79, 0x33, 0x2E, 0x31 (ASCII for “happyny3.1”)\n\n**DIR_BLACKLIST** \"Windows\", \"Boot\", \"System Volume Information\", \"Program Files\\\\Common Files\\\\Microsoft Shared\n\"Program Files\\\\Common Files\\\\System\", \"Program Files\\\\Common Files\\\\Services\", \"Program\nFiles\\\\Common Files\\\\SpeechEngines\", \"Program Files (x86)\\\\Common Files\\\\microsoft shared\",\n\"Program Files (x86)\\\\Common Files\\\\System\", \"Program Files (x86)\\\\Common Files\\\\Services\", \"Pro\nFiles (x86)\\\\Common Files\\\\SpeechEngines\", \"Program Files\\\\Internet Explorer\", \"Program Files\\\\Int\nExplorer\", \"Program Files\\\\Windows Mail\", \"Program Files\\\\Windows Media Player\", \"Program\nFiles\\\\Windows Photo Viewer\", \"Program Files\\\\Windows Sidebar\", \"Program Files\\\\DVD Maker\",\n\"Program Files\\\\MSBuild\", \"Program Files\\\\Reference Assemblies\", \"Program Files\\\\Windows Defen\n\"Program Files\\\\Windows NT\", \"Program Files (x86)\\\\Internet Explorer\", \"Program Files (x86)\\\\Windo\nMail\", \"Program Files (x86)\\\\Windows Media Player\", \"Program Files (x86)\\\\Windows Photo Viewer\"\n\"Program Files (x86)\\\\Windows Sidebar\", \"Program Files (x86)\\\\MSBuild\", \"Program Files\n(x86)\\\\Reference Assemblies\", \"Program Files (x86)\\\\Windows Defender\", \"Program Files\n(x86)\\\\Windows NT\", \"ProgramData\\\\Microsoft\", \"Users\\\\All Users\"\n\n**EXTENSION_BLACKLIST** \"mui\", \"exe\", \"dll\", \"lolz\"\n\n**FILE_BLACKLIST** \"decryption.txt\", \"$Mft\", \"$Mft (NTFS Master File Table)\", \"$MftMirr\", \"$LogFile\", \"$LogFile (NTFS Vo\nLog)\", \"$Volume\", \"$AttrDef\", \"$Bitmap\", \"$BitMap\", \"$BitMap (NTFS Free Space Map)\", \"$Boot\",\n\"$BadClus\", \"$Secure\", \"$Upcase\", \"$Extend\", \"$Quota\", \"$ObjId\", \"$Reparse\", \"$Extend\", \"bootmg\n\"BOOTSECT.BAK\", \"pagefile.sys\", \"pagefile.sys (Page File)\", \"boot.ini\", \"bootfont.bin\", \"io.sys\"\n\n**EXEC_COMMANDS** \"vssadmin delete shadows /all /quiet\", \"wmic shadowcopy delete\", \"bcdedit /set {default} bootstatusp\nignoreallfailures\", \"bcdedit /set {default} recoveryenabled no\", \"wbadmin delete catalog -quiet\", \"nets\nadvfirewall set currentprofile state off\", \"netsh firewall set opmode mode=disable\"\n\n**TXT** _content of the ransom note (see IOCs)_\n\n_Figure 7: Example configuration values_\n\n\n-----\n\n_Figure 8: A fragment of BuildConfig file_\n\n**Behavior**\n\nUpon execution the malware will run a set of shell commands specified in the BuildConfig file:\n\n_vssadmin delete shadows /all /quiet_\n\n_wmic shadowcopy delete_\n\n_bcdedit /set {default} bootstatuspolicy ignoreallfailures_\n\n_bcdedit /set {default} recoveryenabled no_\n\n_wbadmin delete catalog -quiet_\n\n_netsh advfirewall set currentprofile state off_\n\n_netsh firewall set opmode mode=disable_\n\nAn install_id value will be generated for each victim using the first four bytes from a SHA256 hash of the system UUID value. To obtain the\nUUID the malware executes the following wmic command:\n\n_wmic csproduct get UUID_\n\n\n-----\n\nThe list of paths to encrypt can be passed as parameter; alternatively, the malware will generate a list of all root paths in the system. A\nseparate encryption thread will be created for each item in the path list.\n\nAfter the encryption process is completed, the malware will ensure that the files are not recoverable by overwriting deleted files in each\nencryption path. It uses an embedded Windows utility called cipher.exe for this task:\n\n_Figure 9: Secure deletion of original files_\n\n**File Encryption**\n\n[The files are encrypted using an AES-256 algorithm in Galois/Counter (GCM) mode[3]](https://en.wikipedia.org/wiki/Galois/Counter_Mode) with a 16-byte long GCM authentication tag, which\nensures data integrity. A 12-byte long initialization vector (IV) is generated for each encryption chunk using the java.security.SecureRandom\nfunction. The encryption chunk size is specified in BuildConfig and is set to 10 MB while a pattern setting specifies the pattern in which file\nchunks are to be processed. By skipping parts of the bigger files, the attackers speed up the encryption process while damaging the files and\nmaking them unusable.\n\nFor each encryption path, an array of AES-256 keys is generated using java.security.Secure.Random function. The maximum number of keys\nper path is set in BuildConfig and may differ between samples. Each file (or file chunk, in case of files bigger than the chunk size) is encrypted\nwith a different AES key, then encrypted with the attacker’s RSA-1024 public key and saved in the chunk metadata block:\n\n\n-----\n\n_Figure 10: AES key generation_\n\nThe metadata added to each encrypted chunk contains the following:\n\nHeader value specified in BuildConfig\nChunk index (8 bytes)\nChunk size (8 bytes)\nPer-chunk generated AES IV (12 bytes)\nAES GCM tag (16 bytes)\nRSA-encrypted AES key scheme (128 bytes), containing:\n\no  Victim ID (4 bytes)\n\no  AES key (32 bytes)\n\no  SHA512 hash of victim ID and AES key (64 bytes)\n\n\n-----\n\n_Figure 11: Encrypted file with highlighted metadata_\n\nBecause of the use of asymmetric RSA algorithm to encrypt the securely generated AES keys, the file decryption requires obtaining the\nattacker's private RSA key. Factoring a 1024-bit RSA key, although theoretically possible, has not been achieved yet and would require\nextraordinary computational power.\n\n[However, one of the victims seeking help on the BleepingComputer forum[4]](https://www.bleepingcomputer.com/forums/t/709143/help-me-to-identify-ransomware-with-redrum-extension/page-2) posted a private RSA key presumably coming from a decryptor\nthe victim purchased from the attackers. This key has proven to be successful in decryption of some of the files affected by the earliest\nversion of Tycoon ransomware that added the .redrum extension to the encrypted files:\n\n_Figure 12: Decrypted AES key metadata: install_id (red), AES key (green), sha512 hash (blue)_\n\n\n-----\n\n_Figure 13: Recovering a .redrum file with the use of decrypted AES key_\n\nUnfortunately, it doesn't work for the more recent “happyny3.1” version that adds the .grinch and .thanos extensions to the encrypted files.\n\n**Conclusions**\n\nMalware writers are constantly seeking new ways of flying under the radar. They are slowly moving away from conventional obfuscation and\nshifting towards uncommon programming languages and obscure data formats. We have already seen a substantial increase in ransomware\nwritten in languages such as Java and Go. This is the first sample we've encountered that specifically abuses the Java JIMAGE format to\ncreate a custom malicious JRE build.\n\nTycoon has been in the wild for at least six months, but there seems to be a limited number of victims. This suggests the malware may be\nhighly targeted. It may also be a part of a wider campaign using several different ransomware solutions, depending on what is perceived more\nsuccessful in specific environments.\n\nThe overlap in some of the email addresses, as well as the text of the ransom note and the naming convention used for encrypted files,\nsuggests a connection between Tycoon and Dharma/CrySIS ransomware. Indicators of Compromise (IOCs)\n\n**JIMAGE module (lib\\modules):**\n\neddc43ee369594ac8b0a8a0eab6960dba8d58c0b499a51a717667f05572617fb\n\n**Email Addresses:**\n\npay4dec[at]cock[.]lu\ndataissafe[at]protonmail[.]com\ndataissafe[at]mail[.]com\nfoxbit[at]tutanota[.]com\nmoncler[at]tutamail[.]com\nmoncler[at]cock[.]li\nrelaxmate[at]protonmail[.]com\ncrocodelux[at]mail[.]ru\nsavecopy[at]cock[.]li\nbazooka[at]cock[.]li\nfuntik[at]tutamail[.]com\nproff-mariarti[at]protonmail[.]com\n\n**Encrypted Files Extension:**\n\nthanos\ngrinch\nredrum\n\n\n-----\n\n**c ypted** **es S g atu e**\n\nhappyny3.1\nredrum3_0\n\n**RSA Public Key (happyny3.1 version):**\n\n-----BEGIN PUBLIC KEY----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDa+whJSxr9ngcD1T5GmjDNSUEY\ngz5esbymvy4lE9g2M3PvVc9iLw9Ybe+NMqJwHB8FYCTled48mXQmCvRH2Vw3lPkA\nTrQ4zbVx0fgEsoxekqtb3GbK2NseXEeavCi5lo5/jXZi4Td7nlWTu27CluyxRSgv\nL0O19CwzvckTM91BKwIDAQAB\n-----END PUBLIC KEY----\n**RSA Private Key (redrum3_0 version):**\n\n-----BEGIN RSA PRIVATE KEY----\nMIICXQIBAAKBgQCyNELzNaPcGBlt2YEARamc+a+uyM8/mRadrMLLQ9tuzkppvdWI\niM/LH+xATZUgByknwzaMtRQZi6R2pQ8nBG6DxNtdhla33L+njQLTW+7wo1tSaaJz\n6Of0FvCUZNPZ0mF5OrJO+Z6ZfDxafcwv653Ii7aTwaKlhjFoZijBMrA43wIDAQAB\nAoGAPJ+I0yJBX0OXiwY+W3BXdj5+5LANyS30QqmeDvZDtRtat0RMW0lnn0t53JpI\nDABDoPJJIW8MqnAWAALA994LFhk9jUtJTUgwsViyKL/Q/dOCeBPJU3xyXNkqhmCN\nImP4v7DxjvWp1pomrIIRCW68GkbB+cSGyLAzUo+1KHVh6LECQQDdL26UsVNsNYTX\nrfv6BZItGO1HJHYTiz0cI82n4woZY2fS2lpBDEvy3Rl8E4Y7F9tQby4odDLHi/9l\nRCeoif45AkEAzkDsPGauMmWsPXAbXrjzq3/0+MWgh7Vd8Gpgn83QUYjTO2RxtE1n\nzAYzTLrFFtM8zmCAubpKM1dyi4Xs7hlv1wJBAJD5ofV8NT3b5nKn61z5gdJlYEEd\nOPeecDOdlBLS0a/KZCbkT/wK300UdrvI4FajUHDsLsj9QLtim8f4YDYsHKECQQCX\nR40+XD3mnyZvRbv9hQDMyKSglyvAfimxvgSzEZ17QDVWubygd6nrPpz/6XnH3RYb\ndTLVhysHb1uHtKpslWGvAkAf0kivk9miSFnVeoO1XZumRAwrhTh6Rxhkg6MJCLBP\nThoY7wYXmV9zNPo02xYTvZlyhwnWspz4Kx4LsUutWmBs\n\n-----END RSA PRIVATE KEY----\n**Ransom Note:**\n\n\n-----\n\nHello!\n\nAll your documents, photos, databases and other important files have been ENCRYPTED! Do you really interested to restore your files?\n\nIf so, you must buy decipher software and private key to unlock your data!\nWrite to our email - %s and tell us your unique %s\nWe will send you full instruction how to decrypt all your files.\nIn case of no answer in 24 hours write us on additional e-mail address - %s\n\n=============================================================================================================\nFAQ FOR DECRYPTION YOUR FILES:\n=============================================================================================================\n\n - WHATS HAPPENED ???\n\nYour files are NOT DAMAGED! Your files have been modified and encrypted with strong cipher algorithm. This modification is reversible. The on\ndecrypt your files is to purchase the decipher software and private key. Any attempts to restore your files with the third-party software will be fata\nbecause would damage data essential for decryption !\n\nNote !!! You have only 24 hours to write us on e-mail or all your files will be lost or the decryption price will be \"increased!\"\n\n====================================================================================\n====================================\n\n - HOW TO RECOVERY MY FILES ???\n\nYou have to pay for decryption in Bitcoins. The price depends on how fast you write to us. After payment we will send you the decipher software\nkey that will decrypt all your files.\n\n=============================================================================================================\n\n - FREE DECRYPTION !!!\n\nFree decryption as guarantee! If you don't believe in our service and you want to see a proof, you can ask us about test\" for decryption. You send\nmodified files. Use file-sharing service and Win-Rar to send files for test. Files have to be less than 1 MB (non archived). Files should not be imp\nsend us databases, backups, large excel files, etc. We will decrypt and send you your decrypted files back as a proof!\"\n\n=============================================================================================================\n\n - WHY DO I NEED A TEST???\n\nThis is done so that you can make sure that only we can decrypt your files and that there will be no problems with the decryption!\n\n=============================================================================================================\n\n - HOW TO BUY BITCOINS ???\n\nThere are two simple ways to by bitcoins:\nhttps://exmo.me/en/support#/1_3\nhttps://localbitcoins.net/guides/how-to-buy-bitcoins\n\nRead this information carefully because it's enough to purchase even in large amounts\n\n=============================================================================================================\n\n!!! ATTENTION !!!\n\n!!! After 60 hours the price for your encryption will increase 10 percent each day\n!!! Do not rename encrypted files.\n!!! Do not try to decrypt your data using third party software, it may cause permanent data loss.\n!!! Decryption of your files with the help of third parties may cause increased price (they add their fee to our) or you can become a victim of a sca\n\n**Citations:**\n\n_[1]_ _[https://www.bleepingcomputer.com/forums/t/709143/help-me-to-identify-ransomware-with-redrum-extension/](https://www.bleepingcomputer.com/forums/t/709143/help-me-to-identify-ransomware-with-redrum-extension/)_\n\n_[[2] https://attack.mitre.org/techniques/T1183/](https://attack.mitre.org/techniques/T1183/)_\n\n_[3]_ _[https://en.wikipedia.org/wiki/Galois/Counter_Mode](https://en.wikipedia.org/wiki/Galois/Counter_Mode)_\n\n_[4]_ _[https://www.bleepingcomputer.com/forums/t/709143/help-me-to-identify-ransomware-with-redrum-extension/page-2](https://www.bleepingcomputer.com/forums/t/709143/help-me-to-identify-ransomware-with-redrum-extension/page-2)_\n\n\n-----\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats, providing intelligence analysis for the benefit of\ndefenders and the organizations they serve.\n\n## About KPMG’s UK Cyber Response Services Team\n\nKPMG’s UK Cyber Response Services Team provides incident response, forensic investigations, and crisis management services across\ncorporate, insurance and legal service sectors. KPMG has over 3,500 cyber professionals in offices around the globe with cyber response\nlabs across 12 major regions. Our professionals have experience working on various forms of cybercrime, including insider threats, data\nbreaches, hacktivism, and advanced persistent threat-style intrusions by highly motivated adversaries.\n\nOur services include on-demand incident response readiness and response, host and enterprise-based forensics, network forensics, threat\nintelligence, and SOC enhancement.\n\n[For further information, please visit kpmg.co.uk/cyber or email cyber[at]kpmg.co.uk.](https://home.kpmg/uk/en/home/services/advisory/risk-consulting/technology-risk/cyber-security.html)\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-04 - Threat Spotlight- Tycoon Ransomware Targets Education and Software Sectors.pdf"
    ],
    "report_names": [
        "2020-06-04 - Threat Spotlight- Tycoon Ransomware Targets Education and Software Sectors.pdf"
    ],
    "threat_actors": [
        {
            "id": "b98eb1ec-dc8b-4aea-b112-9e485408dd14",
            "created_at": "2022-10-25T16:07:23.649308Z",
            "updated_at": "2025-03-27T02:02:09.906895Z",
            "deleted_at": null,
            "main_name": "FunnyDream",
            "aliases": [
                "Bronze Edgewood",
                "Red Hariasa",
                "TAG-16"
            ],
            "source_name": "ETDA:FunnyDream",
            "tools": [
                "Chinoxy",
                "Filepak",
                "FilepakMonitor",
                "FunnyDream",
                "Keyrecord",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Md_client",
                "PCShare",
                "ScreenCap",
                "TcpBridge",
                "Tcp_transfer",
                "ccf32"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535946,
    "ts_updated_at": 1743041461,
    "ts_creation_date": 1653761336,
    "ts_modification_date": 1653761336,
    "files": {
        "pdf": "https://archive.orkl.eu/9c08a277e991dbfcad10fb8f9cf38ea901c008fd.pdf",
        "text": "https://archive.orkl.eu/9c08a277e991dbfcad10fb8f9cf38ea901c008fd.txt",
        "img": "https://archive.orkl.eu/9c08a277e991dbfcad10fb8f9cf38ea901c008fd.jpg"
    }
}