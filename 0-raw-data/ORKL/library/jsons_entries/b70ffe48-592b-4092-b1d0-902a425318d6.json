{
    "id": "b70ffe48-592b-4092-b1d0-902a425318d6",
    "created_at": "2024-06-21T02:06:23.621694Z",
    "updated_at": "2025-03-27T02:16:34.635253Z",
    "deleted_at": null,
    "sha1_hash": "5e18de5ab28be9a11816b578adc86093081103b1",
    "title": "",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 2120392,
    "plain_text": "## Estudio del análisis de\n Nobelium\n\n\n-----\n\n**_Septiembre 2022_**\n\n**INCIBE-CERT_ESTUDIO_ANALISIS_NOBELIUM_2022_v1**\n\n\nLa presente publicación pertenece a INCIBE (Instituto Nacional de Ciberseguridad) y está bajo una licencia Reconocimiento-No\ncomercial 3.0 España de Creative Commons. Por esta razón, está permitido copiar, distribuir y comunicar públicamente esta obra\nbajo las siguientes condiciones:\n\n- Reconocimiento. El contenido de este informe se puede reproducir total o parcialmente por terceros, citando su procedencia\ny haciendo referencia expresa tanto a INCIBE o INCIBE-CERT como a su sitio web: [https://www.incibe.es/. Dicho reconocimiento](https://www.incibe.es/)\nno podrá en ningún caso sugerir que INCIBE presta apoyo a dicho tercero o apoya el uso que hace de su obra.\n\n- Uso No Comercial. El material original y los trabajos derivados pueden ser distribuidos, copiados y exhibidos mientras su uso\nno tenga fines comerciales.\n\nAl reutilizar o distribuir la obra, tiene que dejar bien claro los términos de la licencia de esta obra. Alguna de estas condiciones\npuede no aplicarse si se obtiene el permiso de INCIBE-CERT como titular de los derechos de autor. Texto completo de la licencia:\n[https://creativecommons.org/licenses/by-nc-sa/3.0/es/.](https://creativecommons.org/licenses/by-nc-sa/3.0/es/)\n\n\n-----\n\n# Índice\n\n###### Índice de figuras ................................................................................................... 3 ÍNDICE DE TABLAS .............................................................................................. 4 1. Sobre este estudio ........................................................................................... 5 2. Organización del documento .......................................................................... 6 3. Introducción ...................................................................................................... 7 4. Informe técnico ................................................................................................. 8\n\n 4.1. Cadena de infección .................................................................................. 10 4.2. Análisis de la infección ............................................................................... 11\n\n 5. Campañas anteriores ..................................................................................... 23\n\n5.1.1. Boombox ........................................................................................................25\n\n5.1.2. Nativezone ......................................................................................................25\n\n5.1.3. Beatdrop .........................................................................................................25\n\n5.1.4. Boommic .........................................................................................................25\n\n5.1.5. Nuevos Artefactos ...........................................................................................25\n\n###### 6. Referencias ..................................................................................................... 27 Anexo 1: Indicadores de compromiso (IOC) .................................................... 28 Anexo 2: Regla Yara de detección .................................................................... 32\n\n#### ÍNDICE DE FIGURAS\n\nFigura 1: Contenido “NV.iso” .............................................................................................................. 8\nFigura 2: Contenido del archivo “61315171.pdf” ................................................................................ 9\nFigura 3: Búsqueda del archivo AcroSup en VirusTotal .................................................................... 9\nFigura 4: Ejecución archivo “NV.lnk” ................................................................................................ 10\nFigura 5: Funciones adicionales en vcruntime140.dll ...................................................................... 10\nFigura 6: Comparativa de los imports en vcruntime140.dll .............................................................. 11\nFigura 7: Flujo de ejecución de la infección ..................................................................................... 11\nFigura 8: Comprobación de la cadena AcroSup.exe en el proceso en ejecución. .......................... 12\nFigura 9: Llamada a la función call_to_ntdll_with_bypass_hooks ................................................... 12\nFigura 10: Paso de la API hasheada como argumento ................................................................... 13\nFigura 11: Búsqueda del SSN .......................................................................................................... 13\nFigura 12: Código para la construcción de la tabla de hashes ........................................................ 14\nFigura 13: Construcción de la tabla de hashes en tiempo de ejecución. ........................................ 15\nFigura 14: Obtención de la API en tiempo de ejecución. ................................................................. 15\nFigura 15: Cambio de contexto a la función “main_loop” ................................................................ 16\nFigura 16: Librería gdi32.dll cargada en memoria por duplicado ..................................................... 16\nFigura 17: Función mapping_modules_overwrittern_text_section ................................................... 17\nFigura 17: Llamada a la función mapping_modules_overwrittern_text_section desde “main_loop” 17\nFigura 18: Solicitud de token de acceso a Dropbox......................................................................... 18\nFigura 19: Respuesta con token de acceso ..................................................................................... 18\nFigura 20: Movimiento de archivos a %APPDATA% ....................................................................... 19\nFigura 21: Creación de persistencia en HKCU ................................................................................ 19\nFigura 22: Solicitud POST “Upload” a Dropbox ............................................................................... 19\nFigura 23: Ejemplo de estructura de archivo .mp3 .......................................................................... 20\n\n\n-----\n\nFigura 24: Ejemplo de estructura de archivo .mp3 .......................................................................... 20\nFigura 25: Recopilación de datos a exfiltrar ..................................................................................... 20\nFigura 26: Cifrado de datos mediante XOR ..................................................................................... 21\nFigura 27: Empaquetado de la información a exfiltrar ..................................................................... 21\nFigura 28: Solicitud POST “Download” a Dropbox ........................................................................... 21\nFigura 29: Solicitud POST “Download” a Dropbox ........................................................................... 22\nFigura 30: Ejecución de los módulos descargados.......................................................................... 22\nFigura 31: Vector de entrada utilizado en las campañas de Nobelium ........................................... 23\nFigura 32: Artefactos utilizados por Nobelium en campañas (2021) ............................................... 24\nFigura 33: Artefactos utilizados por Nobelium en campañas (2022)[7] ........................................... 24\nFigura 34: Código de Boombox para contactar con el C2 ............................................................... 26\nFigura 35: Tabla comparativa entre los diferentes artefactos de Nobelium .................................... 26\n\n#### ÍNDICE DE TABLAS\n\nNo se encuentran elementos de tabla de ilustraciones.\n\n\n-----\n\n### 1. Sobre este estudio\n\nEste estudio se basa en el análisis de una muestra de malware que nos ayudará a conocer\nen detalle las herramientas y técnicas utilizadas, así como su funcionamiento, desde que\nse propaga por correo electrónico, el flujo de ejecución completo de la infección, hasta los\nmétodos de ofuscación y persistencia.\n\nEl objetivo del estudio reside en facilitar la información necesaria para poder identificar las\ncaracterísticas propias de esta amenaza, su comportamiento y técnicas empleadas,\npermitiendo así una mejor identificación y respuesta ante ella.\n\nLas acciones realizadas para su elaboración han seguido una metodología que comprende\ntanto el análisis estático como dinámico de la muestra dentro de un entorno controlado. Se\nhan utilizado herramientas como Pestudio, Dnspy y PE-Bear para los ejecutables o editores\nde texto como SublimeText para los ficheros de scripting; o VirtualBox, InetSim, PolarProxy,\nWireshak, IDA Pro y ProcessHacker, que ha permitido observar su impacto en un equipo,\ny extraer su configuración y cadenas más características de la memoria una vez se\nencontraba en ejecución.\n\nAdemás, también se hace un repaso por diferentes campañas de Nobelium,\ncomparándolas con la muestra analizada y se aportan los diferentes indicadores de\ncompromiso y una regla Yara.\n\n\n-----\n\n### 2. Organización del documento\n\nEste documento consta de una parte de 3.- Introducción en la que se expone brevemente\nel origen y trasfondo del malware analizado, el cual presenta muchas similitudes con otras\nmuestras de código malicioso asociado al grupo NOBELIUM, mencionando su origen y\nevolución histórica.\n\nA continuación, en el apartado 4.- Informe técnico, se recogen los resultados de los análisis,\ndinámicos y estáticos, realizados sobre la muestra.\n\nPosteriormente, en el apartado 5.- Campañas se comparan las similitudes y diferencias\ndel código analizado con otras muestras de campañas anteriores, en base a la información\npública disponible.\n\nFinalmente, el apartado 6.- Referencias aporta las referencias consultadas a lo largo del\nanálisis.\n\nAdicionalmente, el documento cuenta con dos anexos: en el Anexo 1: Indicadores de\ncompromiso (IOC) se recogen los indicadores de compromiso (IOC) asociados a Nobelium,\ny el Anexo 2: Regla Yara de detección consta de las reglas de Yara para la detección de\nmuestras maliciosas de este malware.\n\n\n-----\n\n### 3. Introducción\n\nLos resultados recogidos en este informe se han obtenido durante el análisis de una\nmuestra de código malicioso distribuida el 26 de abril de 2022 mediante correo electrónico.\n\nEl _malware_ analizado tiene similitudes con otras muestras que se han asociado\npreviamente al grupo Nobelium, pero a su vez presenta características novedosas que\nmuestran un incremento en su sofisticación, como un _downloader_ para el que no se ha\nencontrado ningún análisis previo en fuentes abiertas.\n\nNobelium es la denominación de Microsoft para un grupo de atacantes que, según la\natribución llevada a cabo por la Agencia de Seguridad de Infraestructura y Ciberseguridad\n(CISA) de Estados Unidos, pertenecen al Servicio de Inteligencia Exterior (SRV) de Rusia.\n\nOtras empresas de seguridad denominan a este grupo APT29, UNC2452, Silverfish,\nDarkHalo, o StellarParticle. Este grupo criminal es especialmente conocido por el ataque a\nla cadena de suministro de SolarWinds que salió a la luz en 2020 [1]. Más tarde, en enero\nde 2021, el grupo cambio su proceder realizando una campaña masiva de _phishing [2]_\nhaciéndose pasar por una empresa de desarrollo estadounidense. Las técnicas, tácticas y\nprocedimientos (TTPs) identificadas en esta ocasión tienen numerosas similitudes con la\ncampaña reportada en 2021.\n\n\n-----\n\n### 4. Informe técnico\n\nEl análisis parte de un correo electrónico que contiene un enlace a un fichero HTML alojado\nen un servidor externo, que mediante la técnica de HTML Smuggling (T1027.006)[1] oculta\nun archivo de tipo ISO llamado “NV.iso”, cuyo _hash_ en SHA-256 es\n2931C944C166B610BDADF1A26668023DB919D6BA35B1193399081474BE4BC1F6.\n\nAl abrir el archivo nos encontramos con 5 ficheros, los cuales se encuentran ocultos salvo\n“NV.lnk”, el cual detona la infección si es ejecutado por el usuario.\n\n**_Figura 1: Contenido “NV.iso”_**\n\nLos ficheros, con sus hashes, son los siguientes:\n\n###### Nombre Hash SHA-256\n**61315171.pdf** 5FDCA439BEA2482B7DB9FDAA75C7FDF15E4014A82F570A27F09D0E551C528015\n\n**AcroSup.exe** E8E63F7CF6C25FB3B93AA55D5745393A34E2A98C5AEACBC42F1362DDF64EB0DA\n\n**AcroSup64.dll** 3AC8C22EB7C59D35FE49C20F2A0ECA06765543DFB15F455A5557AF4428066641\n\n**NV.lnk** 18E0526350E135EE76EF408BC2702F204A576102F8EA5061414D9DC63A563FE5\n\n**Vcruntime140.dll** 2028C7DEAF1C2A46F3EBBF7BBDF76781D84F9321107D65D9B9DD958E3C88EF5A\n\nEn primer lugar, el archivo “61315171.pdf” es un señuelo que se muestra a la víctima\nmientras se realiza la infección, en el que se suplanta al Ministerio de Asuntos Exteriores\nucraniano, aprovechando su conflicto abierto con Rusia. El documento informa sobre el\ncierre de la embajada de Ucrania en la República de Macedonia del Norte durante el día\n25 de abril de 2022.\n\n[1 Obfuscated Files or Information: HTML Smuggling. https://attack.mitre.org/techniques/T1027/006/](https://attack.mitre.org/techniques/T1027/006/)\n\n|Nombre|Hash SHA-256|\n|---|---|\n|61315171.pdf|5FDCA439BEA2482B7DB9FDAA75C7FDF15E4014A82F570A27F09D0E551C528015|\n|AcroSup.exe|E8E63F7CF6C25FB3B93AA55D5745393A34E2A98C5AEACBC42F1362DDF64EB0DA|\n|AcroSup64.dll|3AC8C22EB7C59D35FE49C20F2A0ECA06765543DFB15F455A5557AF4428066641|\n|NV.lnk|18E0526350E135EE76EF408BC2702F204A576102F8EA5061414D9DC63A563FE5|\n|Vcruntime140.dll|2028C7DEAF1C2A46F3EBBF7BBDF76781D84F9321107D65D9B9DD958E3C88EF5A|\n\n\n-----\n\n**_Figura 2: Contenido del archivo “61315171.pdf”_**\n\nPor otro lado, también tenemos el archivo AcroSup.exe el cual tiene una marca de tiempo\nanterior al resto. Al buscar por _hash en VirusTotal, encontramos coincidencia con un_\narchivo sin detecciones.\n\n**_Figura 3: Búsqueda del archivo AcroSup en VirusTotal_**\n\nEl nombre real del archivo es _WCChromeNativeMessagingHost.exe, un_ _plug-in listener_\nlegítimo de Adobe Create PDF para Chrome. El malware utilizará este archivo legítimo para\ncargar las DLLs (AcroSup64.dll y vcruntime.dll) maliciosas.\n\n\n-----\n\n##### 4.1. Cadena de infección\n\nCuando el usuario abre el archivo ISO, sólo encuentra el fichero “NV.lnk” puesto que el\nresto de los archivos se encuentran ocultos. Al ejecutar el archivo LNK, se lanza la\nejecución de AcroSup.exe utilizando el terminal de comandos.\n\n**_Figura 4: Ejecución archivo “NV.lnk”_**\n\nComo ya se ha comentado el archivo AcroSup.exe es legítimo. Sin embargo, al buscar la\nlibrería legítima vcruntime140.dll, los actores consiguen cargar su DLL maliciosa del mismo\nnombre que han situado al lado del ejecutable. A esta técnica se la conoce como DLL SideLoad (T1574.002)[2].\n\nLa librería _vcruntime140.dll_ es una DLL legítima de Windows que permite la correcta\nejecución de los programas escritos en C. Al comparar la DLL original con la que acompaña\nal malware se observa que existen algunas funciones que son diferentes, como se puede\nver en la siguiente comparativa:\n\n**_Figura 5: Funciones adicionales en vcruntime140.dll_**\n\nLos resultados arrojan 216 funciones coincidentes y 18 adicionales. Analizando cada una\nde las funciones no observamos nada inusual, por lo que parece que la DLL no tiene lógica\nmaliciosa.\n\n[2 Hijack Execution Flow: DLL Side-Loading. https://attack.mitre.org/techniques/T1574/002/](https://attack.mitre.org/techniques/T1574/002/)\n\n\n-----\n\nEn los imports de la librería vcruntime140.dll que viene con el fichero ISO, se observa que\ncontiene un import más que la original.\n\n**_Figura 6: Comparativa de los imports en vcruntime140.dll_**\n\nCuando se cargue la librería vcruntime140.dll que está junto a AcroSup.exe se cargará de\nmanera automática AcroSup64.dll y se ejecutará su DllMain.\n\nCon lo anteriormente comentado, el flujo de la infección sería el siguiente:\n\n**_Figura 7: Flujo de ejecución de la infección_**\n\n##### 4.2. Análisis de la infección\n\nLa DLL principal encargada de realizar las comunicaciones y la ejecución es AcroSup64.dll,\nla cual se carga en memoria mediante DLL Side-Loading a través de la DLL que hace de\nproxy para la carga (vcruntime140.dll).\n\nLa lógica maliciosa no está en la función exportada, sino que se encuentra directamente\nen la función DllMain. DllMain comprueba que la imagen del binario del proceso en\nejecución se llame AcroSup.exe (binario legítimo).\n\n\n-----\n\n**_Figura 8: Comprobación de la cadena AcroSup.exe en el proceso en ejecución_**\n\nDurante el análisis de esta muestra se ha observado que utiliza una técnica para evitar los\n_hooks de usuario y para realizar una invocación directa a syscalls o más concretamente a_\nSSNs (System Service Numbers). Este tipo _hooks es habitual entre el_ _software de_\nseguridad para monitorizar los procesos en ejecución y de ese modo detectar\ncomportamientos maliciosos, es por ello que el malware intenta sortearlos para garantizar\nsu ejecución.\n\nEn este caso se ha podido ver que la muestra tiene una función que implementa esta\ntécnica de bypass. A continuación se muestra una figura donde se visualiza una llamada a\nesta función (call_to_ntdll_with_bypass_hooks).\n\n**_Figura 9: Llamada a la función call_to_ntdll_with_bypass_hooks_**\n\nAl introducirnos en la función se observa cómo hay una llamada a otra función pasándole\ncomo argumento el valor: 0x0B4A8D256. Este valor se corresponde con el _hash del_\n\n\n-----\n\nnombre de una función de la librería NTDLL.dll. El resultado de la llamada a esta función\nse almacenará en el registro RAX y se corresponderá con el SSN (System Service Number)\nque se le pasará a la instrucción syscall[3].\n\n**_Figura 10: Paso de la API hasheada como argumento_**\n\nLa función que se muestra a continuación es la que recibe por parámetro el _hash de la_\nfunción. En la siguiente imagen se aprecia cómo va a buscar el SSN (System Service\n_Number) en la tabla que construye en la función que hemos renombrado como_\nGetSysCallList(). Después, en el bucle while, es donde compara los valores y lo retorna:\n\n**_Figura 11: Búsqueda del SSN_**\n\nDentro de la función GetSysCallList() se construye la tabla de hashes de los nombres de\nla librería ntdll.dll, se puede ver a continuación el código:\n\n[3 SYSCALL — Fast System Call: https://www.felixcloutier.com/x86/syscall](https://www.felixcloutier.com/x86/syscall)\n\n\n-----\n\n**_Figura 12: Código para la construcción de la tabla de hashes_**\n\nEn tiempo de ejecución se puede observar cómo, en el momento en el que está\nconstruyendo la tabla de hashes, el registro r11 está apuntando a todos los nombres de las\nAPIs con prefijo Zw:\n\n\n-----\n\n**_Figura 13: Construcción de la tabla de hashes en tiempo de ejecución._**\n\nSi observamos el registro r8 que es donde va poniendo el hash calculando y el registro r11\nque es donde va ubicando la API, podremos ver qué API está utilizando en esta ocasión el\n_malware._\n\n**_Figura 14: Obtención de la API en tiempo de ejecución._**\n\nEn el registro r8 se observa el valor 0xB4A8D256 y vemos en la parte inferior izquierda en\nla vista hexadecimal que está sincronizada con el registro r11 como la API es\nZwCreateThreadEx().\n\nObservando el código y su comportamiento se ha identificado que la técnica implementada\nestá descrita en la sección número 8 del artículo “Bypassing User-Mode Hooks and Direct\n_Invocation of System Calls for Red Teams” (MDSec Research, s.f.) de la empresa de_\nciberseguridad MDSec. En resumen, se trata de una manera de obtener los SSN en tiempo\nde ejecución sin tener que mapear de nuevo ntdll, con el objetivo que ya se ha comentado.\n\nNo se ha observado que ninguna fuente pública, encontrada por el analista, mencione esta\ntécnica en las últimas campañas del actor.\n\n\n-----\n\nUna vez realizada esta acción, reconduce el flujo de ejecución a una función que es el\nbucle principal, la cual hemos renombrado como “main_loop”. La redirección del flujo se\nproduce suspendiendo el hilo y cambiando del contexto del hilo la siguiente instrucción a\nejecutar.\n\n**_Figura 15: Cambio de contexto a la función “main_loop”_**\n\nEn la imagen anterior se observa cómo fija la variable Context.Rip a la función main_loop\ny a continuación realiza un Resume para iniciar la ejecución del bucle principal.\n\nEn esta función main_loop(), observamos que como mecanismo _antihook existe una_\nfunción (mapping_modules_overwritten_text_section) que mapea de nuevo todas las\nlibrerías. Puede verse a continuación un ejemplo de cómo en un instante temporal,\nponiendo un breakpoint en el momento en el que carga una librería, el espacio de memoria\ndel proceso dispone de dos copias de la misma librería cargada en memoria (gdi32.dll)\n\n**_Figura 16: Librería gdi32.dll cargada en memoria por duplicado_**\n\nDespués de mapear cada uno de los módulos que tiene cargados, la función mueve la\nsección .text, del módulo recién cargado de disco, a la zona .text del módulo cargado en el\nmomento del arranque de la aplicación. Al machacar la sección justo al comenzar el bucle\nprincipal (“main_loop”) el malware intenta asegurarse de quitar todos los posibles hooks en\n_usermode._\n\n\n-----\n\n**_Figura 17: Función mapping_modules_overwrittern_text_section_**\n\n**_Figura 17: Llamada a la función mapping_modules_overwrittern_text_section desde “main_loop”_**\n\nTras analizar y observar el comportamiento se ha buscado en fuentes abiertas alguna\nimplementación pública de esta técnica, y se ha encontrado el código implementado en el\nartículo Full DLL Unhooking with C++ (Full DLL Unhooking with C++, s.f.), confirmando el\ncomportamiento y dando una visión más sencilla del mismo.\n\nIgual que sucede con la técnica anterior, no se han visto referencias públicas haciendo\nmención del uso de esta técnica en esta campaña por parte de este grupo.\n\n\n-----\n\nUna vez terminadas las tareas de _antihook, la primera operación que realiza el bucle_\nprincipal de “main_loop” es entablar comunicación haciendo uso de la API de Dropbox\n(Dropbox Platform Team, 2020).\n\nEn primer lugar, la muestra solicita un token de acceso a Dropbox realizando una petición\na api.dropbox.com de la siguiente forma:\n\n**_Figura 18: Solicitud de token de acceso a Dropbox_**\n\nEn la petición podemos observar cómo busca refrescar el token de acceso, proporcionando\nla API Key en Base64\n\n“aWM1eGkwYzE4cDk5cW05OjhxMWd1a3lud3gwbWd5aQ==”\n\n_ic5xi0c18p99qm9:8q1gukynwx0mgyi_\n\n_api_key:api_secret_\n\nLa petición responde con un token de acceso válido durante 14.400 segundos (4 horas).\n\n**_Figura 19: Respuesta con token de acceso_**\n\nSi la petición ha obtenido respuesta, “main_loop” ejecuta una función a la que hemos\nllamado “copia_ficheros_persistencia”. Esta función comienza realizando una copia de los\nficheros 6131517.pdf y AcroSup.exe a %AppData%.\n\n\n-----\n\n**_Figura 20: Movimiento de archivos a %APPDATA%_**\n\nDespués, mediante un bucle, monta la clave de registro en la que añadirá la ruta para\nobtener persistencia en el equipo infectado.\n\n**_Figura 21: Creación de persistencia en HKCU_**\n\nLa siguiente petición que realiza el _malware es a la nube de Dropbox:_\ncontent.dropboxapi.com:\n\n**_Figura 22: Solicitud POST “Upload” a Dropbox_**\n\nEn la petición se puede observar la ruta de un archivo en la cabecera “Dropbox-API-Arg”:\n\n_Rock_beb47b4715d735c9672940f2ef4a624b.mp3_\n\n\n-----\n\nPodemos observar también una cadena al final que comienza con _“ID3…….#TSSE” y_\ntermina con repetidos caracteres “U”. Esta es la estructura que siguen los archivos .mp3,\ncomo se puede ver en la siguiente imagen:\n\n**_Figura 23: Ejemplo de estructura de archivo .mp3_**\n\nEn la lógica del malware podemos ver este comportamiento en la función “main_loop”.\n\n**_Figura 24: Ejemplo de estructura de archivo .mp3_**\n\nEn primer lugar, reserva 260 bytes de memoria y accede a la función “format_string”. Esta\nfunción renombra el buffer como “Rock_” seguido de una cadena de 32 caracteres en\nhexadecimal. La creación de este identificador no está inicializada en el código por lo que\npodría ser que el malware lo haga de forma dinámica, pero durante el análisis no se ha\npodido verificar este extremo.\n\nA continuación, “main_loop” se encarga de preparar la información que se desea exfiltrar.\nLa información que busca exfiltrar es el “UserName” y “ComputerName” formateado de la\nsiguiente forma “UserName::ComputerName”.\n\n**_Figura 25: Recopilación de datos a exfiltrar_**\n\nPosteriormente, realiza un bucle en el que byte a byte realiza una operación XOR para\ncifrar la información.\n\n\n-----\n\n**_Figura 26: Cifrado de datos mediante XOR_**\n\nFinalmente, en la función “stego_id3_exfilt” se puede observar cómo añade al _buffer la_\ncabecera y el ending propio de un archivo mp3.\n\n**_Figura 27: Empaquetado de la información a exfiltrar_**\n\nLa última petición que realiza la muestra es bastante similar a la anterior:\n\n**_Figura 28: Solicitud POST “Download” a Dropbox_**\n\nLa estructura es igual salvo que esta vez accede al directorio /download/, lo que parece\nindicar que busca descargarse un recurso. El archivo a descargar tiene el mismo nombre\nque el fichero exfiltrado, salvo por la extensión “backup”.\n\n\n-----\n\nHay una función dentro del bucle principal a la que hemos renombrado como\n“load_modules”. Esta función recibe por parámetros el módulo “.backup” descargado en la\nanterior petición.\n\n**_Figura 29: Solicitud POST “Download” a Dropbox_**\n\nEsta función tiene una estructura similar, por no decir idéntica, a DllMain, permitiendo que\nel módulo suspenda un hilo, cambie el contexto a la dirección de inicio del módulo y\nreanude la ejecución. Este mecanismo permite a los actores ejecutar capacidades\nmodulares simplemente poniendo el fichero con extensión “.backup” y de esta forma no\ncomprometer su arsenal. Esta técnica no genera nuevos hilos de ejecución, sino que\nobtiene el contexto de uno ya activo.\n\n**_Figura 30: Ejecución de los módulos descargados_**\n\nLamentablemente, la ruta no es accesible y no se ha podido acceder al módulo en cuestión,\npor lo que no se ha podido analizar al siguiente paso de la campaña.\n\n\n-----\n\n### 5. Campañas anteriores\n\nEn este apartado se pretende comparar las campañas de Nobelium que han salido a la luz\ndesde 2021, con la muestra analizada en estén informe.\n\nDe acuerdo a la fuentes comprobadas, el grupo ha mantenido el mismo vector de entrada\nen todas las campañas desde 2021 (Microsoft Threat Intelligence Center (MSTIC), 2021).\n\n**_Figura 31: Vector de entrada utilizado en las campañas de Nobelium_**\n\nEl actor envía a la víctima un correo de spear phishing con un fichero HTML adjunto, y este\nfichero (apodado Envyscout por Microsoft) descarga y monta un archivo ISO o IMG\nmediante la técnica HTML Smuggling. Dentro de este archivo contenedor se encuentran\nlos artefactos con los que el actor dará comienzo a la infección.\n\n**24/02/2021** **12/05/2021**\n**ENVYSCOUT** **Invitation.html** **ENVYSCOUT** **NV.html**\nCONTENEDOR Invitation Document.iso CONTENEDOR nv.img\nLNK FILE Plending forms.lnk LNK FILE nv.lnk\nCOBALT STRIKE Graphical_Component.dll BOOMBOX boom.exe\nCONTENEDOR SMM_Report.img SEÑUELO nv.pdf\nLNK FILE Programme outline.lnk **ENVYSCOUT** **nv.html**\nCOBALT STRIKE dxgim.dll CONTENEDOR NV.img\nLNK FILE NV.lnk\n**02/03/2021** BOOMBOX boom.exe\n**ENVYSCOUT** **information.html** 2º ETAPA CertPKlProvider.dll\nCONTENEDOR topics_of_discussion.iso SEÑUELO Meeting Info.docx\nCONTENEDOR information.iso CONTENEDOR Attachment.img\nCOBALT STRIKE information.exe LNK FILE Attachment.lnk\nCOBALT STRIKE WRAR600.EXE BOOMBOX boom.exe\n2º ETAPA NativeCacheSvc.dll\n**17/03/2021**\n**ENVYSCOUT** **Reply slip.html** **20/05/2021**\nCONTENEDOR Reply slip.iso **ENVYSCOUT** **NV.html**\nLNK FILE Reply slip.rtf.lnk CONTENEDOR ICA-declass.iso\nCOBALT STRIKE desktop.dll NATIVEZONE RtlSvcMicro.dll\n2º ETAPA Wbtr.dll\n**29/03/2021** SEÑUELO Ica-declass.pdf\n**ENVYSCOUT** **cert.html**\nCONTENEDOR dppy_empty.iso\nLNK FILE information.txt.lnk\nCOBALT STRIKE mstu.dll\n\n\n-----\n\n**22/04/2021**\n**ENVYSCOUT** **attachment.html**\nCONTENEDOR attachment.iso\nLNK FILE attachment.lnk\n\n**_Figura 32: Artefactos utilizados por Nobelium en campañas (2021)_**\n\n**18/01/2022** **26/04/2022 – Muestra analizada**\n\n**ENVYSCOUT** **FW (2).html** **ENVYSCOUT** **NV.html**\nCONTENEDOR Ambassador_Absense.docx CONTENEDOR NV.iso\nBOOMMIC javafx_font.dll LNK FILE NV.lnk\nEXE LEGITIMO jucheck.exe - AcroSup64.dll\nBEATDROP IconCacheService.dll EXE LEGITIMO AcroSup64.exe\nDLL MALICIOSA versions.dll - vcruntime140.dll\nBEATDROP Trello.dll SEÑUELO 61315171.pdf\nBEATDROP msvcr170.dll\nBEATDROP Trello.dll\n\n**14/02/2022**\n\n**ENVYSCOUT** **Covid.html**\nCONTENEDOR Covid.iso\nLNK FILE Covid.lnk\nCOBALT STRIKE DeleteDateConnectionPosition.dll\n\n**14/03/2022**\n\n**ENVYSCOUT** **-**\n\nCONTENEDOR inform.iso\nLNK FILE information.lnk\nCOBALT STRIKE WinScrollbarForUninitialize.dll\n\n**_Figura 33: Artefactos utilizados por Nobelium en campañas (2022)[7]_**\n\nHasta abril del año pasado, el grupo utilizaba este vector ataque para distribuir muestras\nde CobaltStrike. No es hasta mayo de 2021 cuando vemos un cambio en sus\nprocedimientos, pasando a distribuir muestras propias, las cuales [Microsoft [6] bautizó](https://www.microsoft.com/security/blog/2021/05/28/breaking-down-nobeliums-latest-early-stage-toolset/)\ncomo Boombox y Nativezone.\n\nA principios del año 2022, Nobelium retomó las campañas de phishing siguiendo el mismo\nmétodo de infección. En estas campañas encontramos dos nuevos artefactos en forma de\nDLL. Mandiant (WOLFRAM, HAWLEY, MCLELLAN, SIMONIAN, & VEJLBY, 2022) ha\nllamado a estos downloaders Boommic y Beatdrop.\n\nA partir de abril de 2022, parece que el grupo ha vuelto a cambiar de malware, ya que las\nmuestras de _AcroSup.dll_ y _vcruntime140.dll analizadas en este informe presentan_\ndiferencias con Boommic o Beatdrop respecto código y técnicas empleadas en muestras\nanteriores.\n\nEn los siguientes apartados se pretenden resumir las capacidades de cada uno de los\nartefactos que han compuesto el arsenal de Nobelium para lograr un vector de entrada.\n\n\n-----\n\n###### 5.1.1. Boombox\n\nBoombox es un _downloader desarrollado en C# que utiliza la API de Dropbox para_\ncomunicarse con el servidor de comando y control (C2). En primer lugar, Boombox recopila\nla información del equipo, la formatea, la cifra, la esconde en un documento PDF y la exfiltra\nmediante Dropbox. Posteriormente, se descarga en la carpeta %AppData% la siguiente\netapa de infección camuflada en un documento PDF de la misma forma.\n\n###### 5.1.2. Nativezone\n\nNativezone es una DLL downloader cuya función es principalmente llamar a rundll32.exe,\npara ejecutar el verdadero payload malicioso. La lógica se encuentra en uno de los exports\nde la DLL maliciosa.\n\n###### 5.1.3. Beatdrop\n\nBeatdrop es un _downloader escrito en C que utiliza la API de Trello, un software de_\nadministración de proyectos, para comunicarse con el C2. En primer lugar, Beatdrop carga\nla librería _ntdll.dl, suspende un hilo y apunta al mismo, de esta forma puede realizar un_\n_bypass del antivirus y de posibles herramientas del analista. Posteriormente, recopila_\ninformación del equipo en un formato determinado y la envía al C2 para identificar a la\nvíctima. Una vez el usuario se encuentra identificado, queda a la espera hasta que este\nreciba el payload con la siguiente etapa de la infección.\n\n###### 5.1.4. Boommic\n\nBoommic (también denominado como VaporRage por Microsoft) es otro Downloader\nescrito en C que se comunica mediante HTTPS. La ejecución de Boommic es posible\ngracias a un archivo ejecutable legítimo que carga una DLL maliciosa mediante la técnica\n_DLL Side-Loading._\n\nEsta DLL maliciosa no tiene lógica alguna, pero contiene en sus _imports a Boommic,_\nhaciéndola necesaria para su ejecución.\n\n###### 5.1.5. Nuevos Artefactos\n\nEn el análisis de AcroSup64.dll hemos indicado cómo esta utiliza la API de Dropbox para\ncontactar con el C2, al igual que el malware Boombox. Se ha analizado una muestra de\nBoombox (Microsoft Threat Intelligence Center (MSTIC), 2021) y se ha observado que\nforma las peticiones a la ruta _“/2/files/download/” de la misma forma que lo hace_\n_AcroSup64.dll._\n\n\n-----\n\n**_Figura 34: Código de Boombox para contactar con el C2_**\n\nAsí mismo, AcroSup64.dll también camuflaba la información a exfiltrar en formato MP3, de\nmanera similar a lo que hace Boombox con el formato PDF.\n\nPor otro lado, _AcroSup64.dll_ también guarda relación con Beatdrop. Ambas muestras\nsecuestran el flujo suspendiendo el hilo en ejecución y cambiando el contexto. La diferencia\nes que la muestra de Beatdrop exporta una función maliciosa que contiene esa lógica,\nmientras que AcroSup64.dll ejecuta su código al cargar la librería.\n\nFinalmente, el uso de la técnica DLL Side-Load y la necesidad de una DLL intermedia para\nque el programa funcione, son características que AcroSup64.dll comparte con Boommic.\nDe nuevo, la diferencia reside en que AcroSup64.dll no ejecuta lógica desde los exports.\n\nA modo de resumen se presenta la siguiente tabla que compara la muestra AcroSup64.dll\ncon el resto de los artefactos que componen el arsenal de Nobelium para el vector de\nentrada. Como se puede observar, AcroSup64.dll contiene capacidades de varias de estas\nmuestras, fruto de un incremento en la sofisticación de las campañas.\n\n**BOOMBOX BEATDROP BOOMMIC AcroSup64.dll**\n\n**Lenguaje de Programación** .NET C C C\n**API Legítima explotada** Dropbox Trello Trello Dropbox\n**Tipo de Archivo** EXE DLL DLL DLL\nSystem Owner/User Discovery **x** **x** **x**\n\nMasqueranding **x** **x** **x** **x**\n\nExfiltration over C2 **x** **x**\n\nT1055.012 Process Injection: Process Hollowing **x** **x**\n\nT1547.001 Boot or Logon Autostart Exec.: Reg. Run Keys/Startup Folders **x** **x**\n\nT1547.009 Boot or Logon Autostart Execution: Shortcut Modification **x** **x** **x** **x**\n\nT1548.002 Abuse Elevation Control Mechanism: Bypass UAC **x**\n\nT1562.001 Impair Defenses: Disable or Modify Tools **x** **x**\n\nT1573.001 Encrypted Channel: Symmetric Crytpography **x** **x**\n\nT1574.002 Hijack Execution Flow: DLL Side-Loading **x** **x** **x** **x**\n\n**_Figura 35: Tabla comparativa entre los diferentes artefactos de Nobelium_**\n\n|Col1|BOOMBOX|BEATDROP|BOOMMIC|AcroSup64.dll|\n|---|---|---|---|---|\n|Lenguaje de Programación|.NET|C|C|C|\n|API Legítima explotada|Dropbox|Trello|Trello|Dropbox|\n|Tipo de Archivo|EXE|DLL|DLL|DLL|\n|T1033 System Owner/User Discovery T1036 Masqueranding T1041 Exfiltration over C2 T1055.012 Process Injection: Process Hollowing T1547.001 Boot or Logon Autostart Exec.: Reg. Run Keys/Startup Folders T1547.009 Boot or Logon Autostart Execution: Shortcut Modification T1548.002 Abuse Elevation Control Mechanism: Bypass UAC T1562.001 Impair Defenses: Disable or Modify Tools T1573.001 Encrypted Channel: Symmetric Crytpography T1574.002 Hijack Execution Flow: DLL Side-Loading||x|x|x|\n||x|x|x|x|\n||||x|x|\n||x|||x|\n|||x||x|\n||x|x|x|x|\n|||||x|\n|||x||x|\n||||x|x|\n||x|x|x|x|\n\n\n-----\n\n### 6. Referencias\n\n[1] Team, Microsoft 365 Defender Research, «Analyzing Solorigate, the compromised DLL\n\nfile that started a sophisticated cyberattack, and how Microsoft Defender helps protect\ncustomers,» Microsoft, 18 12 2020. [En línea]. Available:\nmicrosoft.com/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-filethat-started-a-sophisticated-cyberattack-and-how-microsoft-defender-helps-protect/.\n\n[Último acceso: 10 05 2022].\n\n[2] Microsoft Threat Intelligence Center (MSTIC), «New sophisticated email-based attack\n\nfrom NOBELIUM,» Microsoft, 27 05 2021. [En línea]. Available:\nhttps://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-basedattack-from-nobelium/ . [Último acceso: 10 05 2022].\n\n[3] MDSec Research, «Bypassing User-Mode Hooks and Direct Invocation of System Calls\n\nfor Red Teams,» MDSec, [En línea]. Available:\nhttps://www.mdsec.co.uk/2020/12/bypassing-user-mode-hooks-and-direct-invocationof-system-calls-for-red-teams/. [Último acceso: 10 05 2022].\n\n[4] «Full DLL Unhooking with C++,» iRed.team, [En línea]. Available:\nhttps://www.ired.team/offensive-security/defense-evasion/how-to-unhook-a-dll-usingc++. [Último acceso: 11 05 2022].\n\n[5] Dropbox Platform Team, «OAuth Guide,» Developers Dropbox, 07 12 2020. [En línea].\n\nAvailable: https://developers.dropbox.com/es-es/oauth-guide. [Último acceso: 10 05\n2022].\n\n[6] Microsoft Threat Intelligence Center (MSTIC), «Breaking down NOBELIUM’s latest\n\nearly-stage toolset,» Microsoft, 28 05 2021. [En línea]. Available:\nhttps://www.microsoft.com/security/blog/2021/05/28/breaking-down-nobeliums-latestearly-stage-toolset/. [Último acceso: 10 05 2022].\n\n[7] J. WOLFRAM, S. HAWLEY, T. MCLELLAN, N. SIMONIAN y A. VEJLBY, «Trello From\n\nthe Other Side: Tracking APT29 Phishing Campaigns,» Mandiant, 28 04 2022. [En\nlínea]. Available: https://www.mandiant.com/resources/tracking-apt29-phishingcampaigns. [Último acceso: 10 05 2022].\n\n\n-----\n\n### Anexo 1: Indicadores de compromiso (IOC)\n\n#### Muestra analizada\n\n**Ficheros**\n\n**Fichero** **Hash SHA256**\n\n**NV.iso** 2931c944c166b610bdadf1a26668023db919d6ba35b1193399081474be4bc1f6\n\n**NV.lnk** 18e0526350e135ee76ef408bc2702f204a576102f8ea5061414d9dc63a563fe5\n\n**Acrosup64.dll** 3ac8c22eb7c59d35fe49c20f2a0eca06765543dfb15f455a5557af4428066641\n\n**61315171.pdf** 5fdca439bea2482b7db9fdaa75c7fdf15e4014a82f570a27f09d0e551c528015\n\n**Acrosup.exe** E8e63f7cf6c25fb3b93aa55d5745393a34e2a98c5aeacbc42f1362ddf64eb0da\n\n**Conexiones de red**\n\n**Tipo** **URL**\n\nhttp://content.dropboxapi.com/2/files/upload/Rock_65c56713159f20d3e51c04e53aee217\n**C2**\nf.mp3\n\nhttp://content.dropboxapi.com/2/files/download/Rock_65c56713159f20d3e51c04e53aee\n**C2**\n217f.mp3.backup\n\n#### Muestras de campañas anteriores\n\n**[Ficheros](https://www.microsoft.com/security/blog/2021/05/28/breaking-down-nobeliums-latest-early-stage-toolset/)** (Microsoft Threat Intelligence Center (MSTIC), 2021) (WOLFRAM, HAWLEY,\nMCLELLAN, SIMONIAN, & VEJLBY, 2022)\n\n|Ficheros|Col2|\n|---|---|\n|Fichero|Hash SHA256|\n|NV.iso|2931c944c166b610bdadf1a26668023db919d6ba35b1193399081474be4bc1f6|\n|NV.lnk|18e0526350e135ee76ef408bc2702f204a576102f8ea5061414d9dc63a563fe5|\n|Acrosup64.dll|3ac8c22eb7c59d35fe49c20f2a0eca06765543dfb15f455a5557af4428066641|\n|61315171.pdf|5fdca439bea2482b7db9fdaa75c7fdf15e4014a82f570a27f09d0e551c528015|\n|Acrosup.exe|E8e63f7cf6c25fb3b93aa55d5745393a34e2a98c5aeacbc42f1362ddf64eb0da|\n\n|Conexiones de red|Col2|\n|---|---|\n|Tipo|URL|\n|C2|http://content.dropboxapi.com/2/files/upload/Rock_65c56713159f20d3e51c04e53aee217 f.mp3|\n|C2|http://content.dropboxapi.com/2/files/download/Rock_65c56713159f20d3e51c04e53aee 217f.mp3.backup|\n\n|Fichero|Hash SHA256|\n|---|---|\n|FW (2).html|207132befb085f413480f8af9fdd690ddf5b9d21a9ea0d4a4e75f34f023ad95d|\n|Invitation.html|ca83d7456a49dc5b8fe71007e5ac590842b146dd5c45c9a65fe57e428a8bd7c6|\n|information.html|065e9471fb4425ec0b3a2fd15e1546d66002caca844866b0764cbf837c21a72a|\n|Reply slip.html|f5bc4a9ffc2d33d4f915e41090af71544d84b651fb2444ac91f6e56c1f2c70d5|\n|attachment.html|cfb57906cf9c5e9c91bc4aa065f7997b1b32b88ff76f253a73ee7f6cfd8fff2f|\n|NV.html|279d5ef8f80aba530aaac8afd049fa171704fc703d9cfe337b56639732e8ce11|\n|nv.html|9301e48ea3fa7d39df871f04072ee47b9046d76aa378a1c5697f3b2c14aef1d6|\n|NV.html|f7e8c9d19efd71f5c8217bf12bdd3f6c88d5f56ab65fea02dc2777c5402a18f1|\n|Covid.html|a896c2d16cadcdedd10390c3af3399361914db57bde1673e46180244e806a1d0|\n|cert.html|dcf48223af8bb423a0b6d4a366163b9308e9102764f0e188318a53f18d6abd25|\n|Invitation Document.iso|6e2069758228e8d69f8c0a82a88ca7433a0a71076c9b1cb0d4646ba8236edf23|\n|topics_of_discussion.iso|a45a77ad5c138a149aa71fb323a1e2513e7ac416be263d1783a7db380d06d2fc|\n|information.iso|112f92cfecdc4e177458bc1caebcc4420b5879840f137f249fac360ddac64ddd|\n|dppy_empty.iso|d19ff098fe0f5947e08ec23be27d3a3355e14fb20135d8c4145126caa8be4b05|\n|attachment.iso|98473e1b8f7bedd5cfa3b83dad611db48eee23faec452e62797fb7752228c759|\n\n\n-----\n\n|ICA-declass.iso|94786066a64c0eb260a28a2959fcd31d63d175ade8b05ae682d3f6f9b2a5a916|\n|---|---|\n|ICA-declass-2.iso|d035d394a82ae1e44b25e273f99eae8e2369da828d6b6fdb95076fd3eb5de142|\n|ICA-declass.iso|2523f94bd4fba4af76f4411fe61084a7e7d80dec163c9ccba9226c80b8b31252|\n|Covid.iso|3cb0d2cff9db85c8e816515ddc380ea73850846317b0bb73ea6145c026276948|\n|inform.iso|34e7482d689429745dd3866caf5ddd5de52a179db7068f6b545ff51542abb76c|\n|Reply slip.iso|873717ea2ea01ae6cd2c2dca9d6f832a316a6e0370071bb4ee6ecff3163f8d18|\n|SMM_Report.img|5f7d08eb2039a9d2e99ebf3d0ef2796b93d0a01e9b8ec403fec8fcdf46448693|\n|nv.img|749bf48a22ca161d86b6e36e71a6817b478a99d935cd721e8bf3dba716224c84|\n|NV.img|e41a7616a3919d883beb1527026281d66e7bcdaff99600e462d36a58f1bdc794|\n|Meeting Info.img|8421950453751b992dad11ceedd637b8134d4dfc0889deeb3bcf8f062b7b7acc|\n|Attachment.img|60e20576b08a24cdaeaabc4849011885fb7517713226e2663031d9533d2187bc|\n|attachment.lnk|3c86859207ac6071220976c52cef99abf18ae37ae702c5d2268948dda370910b|\n|Plending forms.lnk|6866041f93141697ec166fe64e35b00c5fcd5d009500ecf58dd0b7e28764b167|\n|Programme outline.lnk|24caf54e7c3fe308444093f7ac64d6d520c8f44ea4251e09e24931bdb72f5548|\n|Reply slip.rtf.lnk|b81beb17622d4675a1c6f4efb358cc66903366df75eb5911bca725465160bdb6|\n|information.txt.lnk|194f4d1823e93905ee346d7e1fffc256e0befd478735f4b961954df52558c618|\n|reports-2.lnk|e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855|\n|nv.lnk|eae312c5ec2028a2602c9654be679ecde099b2c0b148f8d71fca43706efe4c76|\n|reports.lnk|48b5fb3fa3ea67c2bc0086c41ec755c39d748a7100d71b81f618e82bf1c479f0|\n|NV.lnk|0585ed374f47d823f8fcbb4054ad06980b1fe89f3fa3484558e7d30f7b6e9597|\n|Covid.lnk|fdce78f3acfa557414d3f2c6cf95d18bdb8de1f6ffd3585256dfa682a441ac04|\n|Attachment.lnk|eae312c5ec2028a2602c9654be679ecde099b2c0b148f8d71fca43706efe4c76|\n|information.lnk|e5de12f16af0b174537bbdf779b34a7c66287591323c2ec86845cecdd9d57f53|\n|Meeting Info.lnk|244c101f10b722b352faa1160fce05f4e19a2d840b70ef054da26de7dbb0a9da|\n|CertPKIProvider.dll|b0bfe6a8aa031f7f5972524473f3e404f85520a7553662aaf886055007a57db5|\n|imgmountingservice.dll|2ebbb99b8dae0c7b0931190fa81add987b44d4435dafcf53a9cde0f19bb91398|\n|NativeCacheSvc.dll|136f4083b67bc8dc999eb15bb83042aeb01791fc0b20b5683af6b4ddcf0bbc7d|\n|IconCacheService.dll|95bbd494cecc25a422fa35912ec2365f3200d5a18ea4bfad5566432eb0834f9f|\n|javafx_font.dll|8cb64b95931d435e01b835c05c2774b1f66399381b9fa0b3fb8ec07e18f836b0|\n|msvcr170.dll|2f11ca3dcc1d9400e141d8f3ee9a7a0d18e21908e825990f5c22119214fbb2f5|\n|DeleteDateConnectionPosition. dll|6ee1e629494d7b5138386d98bd718b010ee774fe4a4c9d0e069525408bb7b1f7|\n|WinScrollbarForUninitialize.dll|e8da0c4416f4353aad4620b5a83ff84d6d8b9b8a748fdbe96d8a4d02a4a1a03c|\n|mstu.dll|1f5a915e75ad96e560cee3e24861cf6f8de299fdf79e1829453defbfe2013239|\n|GraphicalComponent.dll|a4f1f09a2b9bc87de90891da6c0fca28e2f88fd67034648060cef9862af9a3bf|\n|dxgim.dll|292e5b0a12fea4ff3fc02e1f98b7a370f88152ce71fe62670dd2f5edfaab2ff8|\n|desktop.dll|f9a74ac540a6584fc3ba7ccc172f948c6b716cceea313ce1d9e7b735fa2a5687|\n|RtlSvcMicro.dll|6d08b767117a0915fb86857096b4219fd58596b42ccf61462b137432abd3920e|\n\n\n-----\n\n|Wbtr.dll|b295c5ad4963bdffa764b93421c3dd512ca6733b79bdff2b99510e7d56a70935|\n|---|---|\n|Trello.dll|5f01eb447cb63c40c2d923b15c5ecb5ba47ea72e600797d5d96e228f4cf13f13|\n|Trello-2.dll|8bdd318996fb3a947d10042f85b6c6ed29547e1d6ebdc177d5d85fa26859e1ca|\n|boom.exe|0acb884f2f4cfa75b726cb8290b20328c8ddbcd49f95a1d761b7d131b95bafec|\n|boom.exe|8199f309478e8ed3f03f75e7574a3e9bce09b4423bd7eb08bb5bff03af2b7c27|\n|boom.exe|cf1d992f776421f72eabc31d5afc2f2067ae856f1c9c1d6dc643a67cb9349d8c|\n|information.exe|88c95954800827cb68e1efdacd99093f7f9646d82613039472b5c90e5978444d|\n|WRAR600.EXE|88c95954800827cb68e1efdacd99093f7f9646d82613039472b5c90e5978444d|\n|NV.exe|e8e63f7cf6c25fb3b93aa55d5745393a34e2a98c5aeacbc42f1362ddf64eb0da|\n|AcroSup64.dll|6618a8b55181b1309dc897d57f9c7264e0c07398615a46c2d901dd1aa6b9a6d6|\n|vcruntime140.dll|2028c7deaf1c2a46f3ebbf7bbdf76781d84f9321107d65d9b9dd958e3c88ef5a|\n|documents-2.dll (Cobalt Strike)|ee42ddacbd202008bcc1312e548e1d9ac670dd3d86c999606a3a01d464a2a330|\n|documents.dll (Cobalt Strike)|ee44c0692fd2ab2f01d17ca4b58ca6c7f79388cbc681f885bb17ec946514088c|\n|ICA-declass-2.pdf|7288b7ed63a39f98a196ef735a23c522c63f46d8344dc36fffd1920d32057c55|\n|ica-declass.pdf|7d34f25ad8099bd069c5a04799299f17d127a3866b77ee34ffb59cfd36e29673|\n|Meeting info.docx|d37347f47bb8c7831ae9bb902ed27a6ce85ddd9ba6dd1e963542fd63047b829c|\n|blank.pdf|0622971147486e1900037eff229d921d14f5b51aac7171729b2b66f81cdf6585|\n|state ellection changes.docx|574b7a80d8b9791cb74608bc4a9fcba4e4574fafef8e57bdee340728445ebd16|\n|ICA-declass.pdf|7d34f25ad8099bd069c5a04799299f17d127a3866b77ee34ffb59cfd36e29673|\n|nv.pdf|73ca0485f2c2c8ba95e00188de7f5509304e1c1eb20ed3a238b0aa9674f9104e|\n|Ambassador_Absense .docx|7ff9891f4cfe841233b1e0669c83de4938ce68ffae43afab51d0015c20515f7b|\n\n\n**[Conexiones de red (Microsoft Threat Intelligence Center (MSTIC), 2021) (WOLFRAM,](https://www.microsoft.com/security/blog/2021/05/28/breaking-down-nobeliums-latest-early-stage-toolset/)**\n**HAWLEY, MCLELLAN, SIMONIAN, & VEJLBY, 2022)**\n\n|Tipo|URL / IP|\n|---|---|\n|C2 URL|aimsecurity.net|\n|C2 URL|cdn.theyardservice.com|\n|C2 URL|cdnappservice.firebaseio.com|\n|C2 URL|cityloss.com|\n|C2 URL|content.pcmsar.net|\n|C2 URL|cross-checking.com|\n|C2 URL|dailydews.com|\n|C2 URL|dataplane.theyardservice.com|\n|C2 URL|doggroomingnews.com|\n|C2 URL|email.theyardservice.com|\n|C2 URL|emergencystreet.com|\n|C2 URL|enpport.com|\n\n\n-----\n\n**C2 IP** 51.38.85.225\n\n|C2 URL|eventbrite-com-default-rtdb.firebaseio.com|\n|---|---|\n|C2 URL|financialmarket.org|\n|C2 URL|giftbox4u.com|\n|C2 URL|hanproud.com|\n|C2 URL|holescontracting.com|\n|C2 URL|humanitarian-forum-default-rtdb.firebaseio.com|\n|C2 URL|newsplacec.com|\n|C2 URL|newstepsco.com|\n|C2 URL|pcmsar.net|\n|C2 URL|security-updater-default-rtdb.firebaseio.com|\n|C2 URL|smtp2.theyardservice.com|\n|C2 URL|static.theyardservice.com|\n|C2 URL|stockmarketon.com|\n|C2 URL|stsnews.com|\n|C2 URL|supportcdn-default-rtdb.firebaseio.com|\n|C2 URL|tacomanewspaper.com|\n|C2 URL|techiefly.com|\n|C2 URL|theadminforum.com|\n|C2 URL|theyardservice.com|\n|C2 URL|trendignews.com|\n|C2 URL|usaid.theyardservice.com|\n|C2 URL|worldhomeoutlet.com|\n|C2 URL|cdnappservice.web.app|\n|C2 URL|logicworkservice.web.app|\n|C2 URL|humanitarian-forum.web.app|\n|C2 URL|security-updater.web.app|\n|C2 URL|eventbrite-com-default-rtdb.firebaseio.com|\n|C2 URL|supportcdn.web.app|\n|C2 IP|139.99.167.177|\n|C2 IP|185.158.250.239|\n|C2 IP|195.206.181.169|\n|C2 IP|37.120.247.135|\n|C2 IP|45.135.167.27|\n|C2 IP|51.254.241.158|\n|C2 IP|51.38.85.225|\n\n\n-----\n\n### Anexo 2: Regla Yara de detección\n\n\nimport \"pe\"\n\nrule NOBELIUM_AcroSup {\n\nstrings:\n\n$op1 = \"AcroSup\"\n\n$op2 = \".mp3\"\n\n$op3 = \".backup\"\n\n$op4 = \"vcruntime140\"\n\n$exfilt = \"%s::%s\" ascii wide\n\n$s1 = \"POST\" ascii wide\n\n$s2 = \".pdf\" ascii wide nocase\n\n$s3 = \"sl\" ascii wide nocase\n\n$hex1 = { ?? ?? ?? ?? ?? 48 8B F0 C7 44 24 50 04 01 00 00 33 C0 48 8D BD E0 00 00 00 B9 04 01\n00 00 4C 8D 44 24 50 F3 AA 8D 48 02 48 8D 95 E0 00 00 00 ?? ?? ?? ?? ?? ?? 48 8D 85 E0 00 00 00 4C 89 7C\n24 60 49 83 C8 FF C7 44 24 68 01 23 45 67 C7 44 24 6C 89 AB CD EF C7 44 24 70 FE DC BA 98 C7 44 24 74 76\n54 32 10 0F 1F 40 00 }\n\n$hex2 = { 48 8D 95 E0 00 00 00 48 8D 4C 24 60 ?? ?? ?? ?? ?? 48 8D 4C 24 60 ?? ?? ?? ?? ?? B9\n10 00 00 00 ?? ?? ?? ?? ?? 0F 10 45 B8 B9 04 01 00 00 48 8B D8 0F 11 00 ?? ?? ?? ?? ?? 48 8B F8 4C 8B E8 33\nC0 B9 04 01 00 00 F3 AA 8D 78 10 66 66 66 0F 1F 84 00 00 00 00 00 }\n\ncondition:\n\npe.number_of_exports == 1 and pe.imports(\"wininet.dll\") and pe.imports(\"secur32.dll\") and\n\n(all of ($s*) or 3 of ($op*)) and\n\n$exfilt and all of ($hex*) and pe.is_dll()\n\n}\n\n\n-----\n\n-----",
    "language": "ES",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.incibe.es/sites/default/files/contenidos/estudios/doc/incibe-cert_estudio_analisis_nobelium_2022_v1.pdf"
    ],
    "report_names": [
        "incibe-cert_estudio_analisis_nobelium_2022_v1.pdf"
    ],
    "threat_actors": [
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "821d8858-a784-4ab2-9ecb-56c7afeed7d7",
            "created_at": "2023-11-21T02:00:07.403629Z",
            "updated_at": "2025-03-27T02:00:03.252703Z",
            "deleted_at": null,
            "main_name": "SilverFish",
            "aliases": [],
            "source_name": "MISPGALAXY:SilverFish",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1718935583,
    "ts_updated_at": 1743041794,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/5e18de5ab28be9a11816b578adc86093081103b1.pdf",
        "text": "https://archive.orkl.eu/5e18de5ab28be9a11816b578adc86093081103b1.txt",
        "img": "https://archive.orkl.eu/5e18de5ab28be9a11816b578adc86093081103b1.jpg"
    }
}