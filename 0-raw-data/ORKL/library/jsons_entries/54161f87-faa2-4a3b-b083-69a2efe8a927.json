{
    "id": "54161f87-faa2-4a3b-b083-69a2efe8a927",
    "created_at": "2022-10-25T16:48:18.207067Z",
    "updated_at": "2025-03-27T02:11:43.468552Z",
    "deleted_at": null,
    "sha1_hash": "3b2344dc14801bb90465cdb9637b5f1ef15ba37f",
    "title": "Avaddon ransomware: an in-depth analysis and decryption of infected systems",
    "authors": "",
    "file_creation_date": "2021-02-10T03:05:38Z",
    "file_modification_date": "2021-02-10T03:05:38Z",
    "file_size": 526494,
    "plain_text": "## Avaddon ransomware: an in-depth analysis and decryption of infected systems\n\n### Javier Yuste[a,][∗], Sergio Pastrana[b]\n\n_aUniversidad Rey Juan Carlos, Madrid_\n_bUniversidad Carlos III, Madrid_\n\n\n### Abstract\n\n This modus operandi disrupts legitimate businesses, which may become unavailable until the data is restored, thus\n\n\n### Keywords:\n\n 1. Introduction\n\n\n_∗Corresponding author_\n_Email address: javier.yuste@urjc.es (Javier Yuste)_\n\n\n-----\n\n### initiated by a threat actor named TWISTED SPIDER in\n somware which is is to publicly ‘blame and shame’ victims\n been leaked and exposed online[1]. In addition, Avaddon\n\n1For ethical and legal reasons, we have not downloaded nor\nchecked the veracity of the exposed data since otherwise this would\ncause additional harm to users, and such analysis is not of public\ninterest for the community [16]\n\n\n### their modus operandi is similar. As a result of our\n\n 2. Background and related work\n\n 2.1. The Ransomware threat\n\n\n-----\n\n### stance, Huang et al. were able to track over $16 million\n be split in 8 stages [26]: fingerprint, propagate, communi- cate, map, encrypt, lock, delete and threaten. Kharaz et al. focused the detection on common tasks performed by\n\n 2.2. The ecosystem of Avaddon Avaddon[2] is a ransomware that was offered as an affil promoted on other underground forums afterwards.[3] Ac\n2The name of the ransomware, Avaddon, may be derived from\nthe Hebrew term Abaddon, the name of an angel of the abyss in the\nBible, mainly associated with the meaning of “destruction” [18].\n3Due to ethical reasons, and to avoid promoting the site, we do\nnot provide the name of the forums.\n\n\n### ities and modus operandi. However, no decryption option\n\n\n-----\n\n### 3. Ransomware analysis\n\n Ninja [4], x64dbg [5] and Pestudio [6]) and a virtual machine\n ronment on top of VirtualBox [7] and install Windows 7 x64\n The analyzed binary (MD5:c9ec0d9ff44f445ce5614\n```\ncc87398b38d) is a Portable Executable (PE) file.\n\n```\n4https://binary.ninja/\n5https://x64dbg.com/\n6https://www.winitor.com/\n7https://www.virtualbox.org/\n\n\n### 3.1. Packing protections\n\n 3.2. Imported functions\n\n (e.g., CryptGenKey or CryptEncrypt), persistence (e.g., RegCreateKeyW, StartServiceW ), anti-analysis (e.g., Is- DebuggerPresent) or activity control (e.g., DeleteService or TerminateProcess).\n\n\n-----\n\n### 3.3. Strings\n to folders or files (e.g., “C:\\Temp”). While we initially can\n (i.e., “Microsoft Enhanced Cryptographic Provider v1\n```\n.0” and “Microsoft Enhanced RSA and AES Cryptograph\nic Provider”). These strings are normally used to acquire\n banal et al. [44].\n\n```\n\n### Algorithm 1: One of the functions responsible\n\n**1 0x4012a0: push 0x30;**\n```\n // Size of the encrypted string\n\n```\n**2 0x4012a2: push 0x49e180;**\n```\n // Encrypted string\n\n```\n**3 0x4012a7: mov ecx, 0x4f8a28;**\n```\n // Global variable\n\n```\n**4 0x4012ac: call 0x40a390;**\n```\n // Creates a global variable at ecx\n   (0x4f8a28 in this case) with the string\n   stored at the value previously pushed\n   (0x49e180 in this case)\n\n```\n**5 0x4012b1: push 0x4874a0;**\n```\n // Destructor\n\n```\n**6 0x4012b6: call _atexit;**\n```\n // Register the destructor function to be\n   called when the process ends\n\n```\n**7 0x4012bb: pop ecx;**\n\n**8 0x4012bc: retn;**\n\n### CommandLine = DecryptString(GlobalVariable);\n\n CreateProcess(CommandLine);\n\n\n-----\n\n### Algorithm 2: Decryption of a global variable\n\n**1 0x40d110: mov edx, 0x4f8a28;**\n```\n  // Global variable that contains an\n   encrypted string\n\n```\n**2 0x40d115: lea ecx, [esp+0x8];**\n```\n  // Local variable that will hold the\n   decrypted string\n\n```\n**3 0x40d119: call decrypt_string;**\n```\n  // Decrypts the string at edx (the global\n   variable) and stores the result in ecx\n   (the local variable)\n\n```\n**4 0x40d11e: push eax;**\n```\n  // eax now contains the decrypted string\n   (it is equal to [esp+0x8], the local\n   variable) which, in this case, is a\n   command line\n\n```\n**5 0x40d11f: call create_process;**\n```\n  // Creates a process with the command line\n   received as argument\n\n### Algorithm 3: Characters decryption.\n\n```\n**1 0x40c820: mov al, byte [esi];**\n```\n  // Move the current character to al (the\n   lower 8 bits of eax)\n\n```\n**2 0x40c822: mov edx, dword [ebp-0x1c];**\n\n**3 0x40c825: sub al, 0x2;**\n```\n  // Substract two units from the character\n\n```\n**4 0x40c827: mov edi, dword [ebp-0x18];**\n\n**5 0x40c82a: xor al, 0x43;**\n```\n  // XOR the result with 0x43\n\n```\n**6 0x40c82c: mov byte [ebp-0x30], al;**\n\n**7 0x40c82f: cmp edx, edi;**\n\n**8 0x40c831: jae 0x40c84d;**\n\n### automates these tasks using the Binary Ninja tool in our public repository [8].\n\n 3.4. Anti-analysis techniques\n\n[8https://github.com/JavierYuste/AvaddonDecryptor](https://github.com/JavierYuste/AvaddonDecryptor)\n\n\n### String obfuscation. As mentioned in prior sections,\n Anti-debugging. We found a call to IsDebuggerPre- sent at offset 0x42e03d. Debuggers are programs designed\n ticular, IsDebuggerPresent is a function provided by the\n\n 1. Hook the call to IsDebuggerPresent so it always re When a call to IsDebuggerPresent is made, it re\n that may parse the PEB (i.e., not using IsDebuggerPre- sent), we decided to implement the second option.\n\n 3.5. Language checks\n\n\n-----\n\n### 3.6. Privilege escalation\n\n 1. HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windo\n```\n   ws\\CurrentVersion\\Policies\\System EnableLUA\n   =0 (disables the “administrator in Admin Approval\n 2. HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windo\n   ws\\CurrentVersion\\Policies\\System ConsentPr\n   omptBehaviorAdmin=0 (this option allows the Con 3. HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Wind\n   ows\\CurrentVersion\\Policies\\System EnableL\n   inkedConnections=1 (makes user mapped drives\n\n```\n\n### is “{3E5FC7F9-9A51-4367-9063-A120244FBEC7}”,\n the value “{6EDD6D74-C007-4E75-B76A-E5740995E\n```\n   24C}”. For the rest of this section, we refer to it as\n value “Elevation:Administrator!new:”.\n string is built by concatenating “Elevation:Admini\n   strator!new:” and CLSID_CMSTPLUA.\n 5. Next, the execution calls the function CoGetObject\n   CoGetObject(“Elevation:Administrator!new:\n   {3E5FC7F9-9A51-4367-9063-A120244FBEC7}”, 0x\n   24, &IID_ICMLuaUtil, &CMLuaUtil)\n\n named ShellExec (CMLuaUtil−→lpVtbl−→ShellExec).\n file (via a call to GetModuleFileNameW ) the binary\n ing ShellExec with the following parameters:\n   ShellExec(CMLuaUtil, “C:\\[...]\\sample.ex\n   e”, [...])\n\n 3.7. Persistence and infection tracking\n\n```\n\n-----\n\n### • HKU\\S-1-5-21-2724635997-1903860598-41043018\n```\n   68-1000\\Software\\Microsoft\\Windows\\CurrentV\n   ersion\\Run\\update: \"C:\\Users\\%UserProfile%\\\n   AppData\\Roaming\\%sample%.exe\"\n\n • HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\n   \\CurrentVersion\\Run\\update: \"C:\\Users\\%User\n   Profile%\\AppData\\Roaming\\%sample%.exe\"\n\n sample is dropped at runtime in \"C:\\Users\\%UserProfil\ne%\\AppData\\Roaming\\%sample%.exe\", where “%sample%”\n more than once, a mutex is created with the value {2A0E\n9C7B-6BE8-4306-9F73-1057003F605B}. If this mutex is\n\n 3.8. Process and service manipulation\n\n```\n\n### 3.9. Key generation\n\n Public key import. The function at 0x413600 is responsi calling the Windows API function CryptImportKey with\n```\n  CryptImportKey(hProv:CSP, pbData: Key to be imp\norted, dwDataLen: Length of the key, hPubKey: 0, d\nwFlags: 0, phKey: Handle to the imported key after\nthe call)\n\n```\n\n-----\n\n### parameter hPubKey must be equal to 0 when the key to be imported is a public key (a PUBLICKEYBLOB object).\n\n Generated key. After importing the public key, a random\n CryptGenKey, with the following parameters:\n```\n  CryptGenKey(hProv: CSP, Algid: CALG_AES_256, d\nwFlags: CRYPT_EXPORTABLE, phKey: Handle to the gen\nerated key after the call)\n\n The parameter Algid indicates that the generated key\n\n Keys destruction. Finally, the function located at 0x413f50\n\n 3.10. File encryption\n\n```\n\n\n### • wmic.exe SHADOWCOPY /nointeractive\n\n • wbadmin DELETE SYSTEMSTATEBACKUP\n\n • wbadmin DELETE SYSTEMSTATEBACKUP -deleteOlde\n```\n   st\n\n • bcdedit.exe /set {default} recoveryenabled No\n\n • bcdedit.exe /set {default} bootstatuspolicy i\n   gnoreallfailures\n\n • vssadmin.exe Delete Shadows /All /Quiet\n\n Windows API function SHEmptyRecycleBinW.\n path is encrypted (i.e., C:\\\\*). Finally, shared folders and mapped volumes are enumerated and encrypted (e.g., D:\n\\\\*, Y:\\\\*, or \\\\VBoxSvr\\\\shared_folder\\\\*). There\n 1. C:\\\\Program Files\\\\Microsoft\\\\Exchange Serve\n   r\\\\*\n 2. C:\\\\Program Files (x86)\\\\Microsoft\\\\Exchange\n   Server\\\\*\n 3. C:\\\\ProgramFiles\\\\Microsoft SQL Server\\\\* 4. C:\\\\Program Files (x86)\\\\MicrosoftSQLServer\\\n   \\*\n 5. C:\\\\*\n\n 1. Strings from a whitelist.\n 2. File extensions. The extension of the file is checked.\n the following: bin, ini, sys, dll, lnk, dat, exe, dr\n   v, rdp, prf, swp, mdf, mds and sql.\n 3. Prevent re-encryption. The third test checks if\n\n```\n\n-----\n\n### are encrypted. This is due to the last call to SetFilePoint- erEx, which sets the file pointer to the end of the file (line\n the parameter Final (line 15) in the call to the encryption routine is always set to False. This parameter should be True if the block to encrypt is the last block of the file.\n\n 4. Decryption of infected systems\n\n\n### Algorithm 4: Function responsible for encrypt\n Input: File, file to be encrypted Key, a duplicate of the AES256 key\n\n**1 buffer_size ←** CryptEncrypt(hKey: Key, Final:\n\n**2 file_size ←** GetFileSizeEx(hFile: File);\n\n**3 file_pointer ←** 0;\n\n**4 do**\n\n**5** _bytes_read, number_of_bytes_read ←_\n### ReadFile(hFile: File, offset: file_pointer,\n\n**6** _i ←_ 0;\n\n**7** **do**\n\n**8** _bytes_to_encrypt ←_\n### bytes_read[i:i+0x2000] ;\n```\n    // The file is encrypted in blocks\n      of 0x2000 bytes\n\n```\n**9** _encrypted_bytes ←_ CryptEncrypt(hKey:\n### Key, Final: False, pbData: bytes_to_encrypt);\n\n**10** WriteFile(hFile: File, lpBuffer:\n### encrypted_bytes);\n\n**11** _i = i + 0x2000;_\n\n**12** **while i ≤** _number_of_bytes_read - 0x2000_ ;\n\n**13** **if number_of_bytes_read - i < 0x2000 then**\n\n**14** _bytes_to_encrypt ←_ _bytes_read[i:]_ ;\n\n**15** _encrypted_bytes ←_ CryptEncrypt(hKey:\n### Key, Final: False, pbData: bytes_to_encrypt);\n\n**16** WriteFile(hFile: File, lpBuffer:\n### encrypted_bytes);\n\n**17** **end**\n\n**18** _file_pointer ←_ SetFilePointerEx(hFile: File,\n### liDistanceToMove: 0, dwMoveMethod: FILE_END) ;\n```\n   // This call sets the file pointer to\n     the end of the file. This is done\n     to stop processing more bytes from\n     the file\n\n```\n**19 while number_of_bytes_read ≥** _0x100000 &&_\n### file_pointer < file_size;\n\n**20 WriteFile(hFile: File, lpBuffer: VictimID);**\n```\n // The Victim ID is written to the end of\n   the file\n\n```\n**21 signature ←** GetSignature();\n\n**22 WriteFile(hFile: File, lpBuffer: signature);**\n```\n // The signature is also written at the\n   end\n\n```\n\n-----\n\n### the Windows API. The eleventh field, hCryptProv, points\n CryptAcquireContext or a similar function). Finally, the\n\n\n### The key_data_s structure contains three fields whose\n\n • alg contains the algorithm ID of the algorithm for\n\n • flags contains the value of the flags parameter passed in the call to CryptGenKey at 0x48f024. Therefore,\n\n • key_size, as it name hints, contains the size of the\n\n showed in Algorithm 4, the Final parameter in the Cryp- tEncrypt calls was never set to True. According to the documentation, this parameter should be True when the\n CryptDecrypt.\n\n\n-----\n\n```\nhttps://github.com/JavierYuste/AvaddonDecryptor.\n\n### 5. Experimentation\n\n nals suite [9]. Note that we can freely drop executable files in the system before stopping Avaddon, since the exe ex\n```\n[9https://docs.microsoft.com/en-us/sysinternals/](https://docs.microsoft.com/en-us/sysinternals/)\n\n|Col1|Col2|\n|---|---|\n|||\n|||\n|||\n|||\n|||\n\n\nTable 1: Results of the experimentation in a virtual environment.\n\n### 6. Conclusions\n\n present. Indeed, the modus operandi of Avaddon, that we\n\n\n-----\n\n### Acknowledgements\n\n References\n\n[1] T. C. of Economic Advisers, The Cost of Malicious Cyber Ac[tivity to the U.S. Economy, https://www.whitehouse.gov/wp-](https://www.whitehouse.gov/wp-content/uploads/2018/02/The-Cost-of-Malicious-Cyber-Activity-to-the-U.S.-Economy.pdf)\n```\n  content/uploads/2018/02/The-Cost-of-Malicious-Cyber\n```\n`Activity-to-the-U.S.-Economy.pdf,` [Online; accessed 28September-2020] (2 2018).\n\n[2] B. Collier, R. Clayton, A. Hutchings, D. Thomas, Cybercrime\nis (often) boring: maintaining the infrastructure of cybercrime\neconomies, 2020, workshop on the Economics of Information\nSecurity, WEIS ; Conference date: 14-12-2020 Through 15-122020.\n\n[3] National Intelligence Officer, A Guide to Cyber Attribution, `https://www.dni.gov/files/CTIIC/documents/ODNI_`\n`A_Guide_to_Cyber_Attribution.pdf,` [Online; accessed 09October-2020] (9 2018).\n\n[4] Infosec, The Attribution Problem in Cyber Attacks,\n```\n  https://resources.infosecinstitute.com/attribution\n```\n`problem-in-cyber-attacks/,` [Online; accessed 09-October2020] (2 2013).\n\n[5] K. Huang, M. Siegel, S. Madnick, Systematically understanding\nthe cyber attack business: A survey 51 (4).\n\n[6] S. Pastrana, A. Hutchings, A. Caines, P. Buttery, Characterizing eve: Analysing cybercrime actors in a large underground\nforum, in: International symposium on research in attacks, intrusions, and defenses, Springer, 2018, pp. 207–227.\n\n[7] PandaLabs, PandaLabs Reveals its Predictions for Cybersecurity Trends in 2018, `https://www.pandasecurity.com/`\n```\n  mediacenter/pandalabs/annual-report-cybersecurity  predictions-2018/, [Online; accessed 28-September-2020] (11\n\n```\n2017).\n\n[8] R. Van Wegberg, S. Tajalizadehkhoob, K. Soska, U. Akyazi,\nC. H. Ganan, B. Klievink, N. Christin, M. Van Eeten, Plug and\nprey? measuring the commoditization of cybercrime via online\nanonymous markets, in: 27th {USENIX} security symposium\n({USENIX} security 18), 2018, pp. 1009–1026.\n\n[9] Auld, Andy, What’s behind the increase in ransomware attacks\n[this year?, https://www.pwc.co.uk/issues/cyber-security-](https://www.pwc.co.uk/issues/cyber-security-services/insights/what-is-behind-ransomware-attacks-increase.html)\n```\n  services/insights/what-is-behind-ransomware-attacks  increase.html, [Online; accessed 03-October-2020] (2020).\n\n```\n[10] S. Ghafur, S. Kristensen, K. Honeyford, G. Martin, A. Darzi,\nP. Aylin, A retrospective impact analysis of the wannacry cyberattack on the nhs, NPJ digital medicine 2 (1) (2019) 1–7.\n\n[11] The CrowdStrike Intel Team, Double Trouble: Ransomware with Data Leak Extortion, Part 1, `https:`\n```\n  //www.crowdstrike.com/blog/double-trouble-ransomware\n```\n`data-leak-extortion-part-1/,` [Online; accessed 28September-2020] (9 2020).\n\n[12] Panda security, Ransomware has a new trick: pay up or suffer\n[a data breach, https://www.pandasecurity.com/mediacenter/](https://www.pandasecurity.com/mediacenter/security/ransomware-data-breach-blackmail/)\n```\n  security/ransomware-data-breach-blackmail/, [Online; ac\n```\ncessed 28-September-2020] (3 2020).\n\n\n\n[13] C. Cimpanu, Conti (Ryuk) joins the ranks of ransomware gangs operating data leak sites, `https:`\n```\n  //www.zdnet.com/article/conti-ryuk-joins-the-ranks  of-ransomware-gangs-operating-data-leak-sites/, [Online;\n\n```\naccessed 28-September-2020] (8 2020).\n\n[14] M. J. Schwartz, Ransomware + Exfiltration + Leaks\n[= Data Breach, https://www.bankinfosecurity.com/blogs/](https://www.bankinfosecurity.com/blogs/ransomware-exfiltration-leaks-data-breach-p-2913)\n`ransomware-exfiltration-leaks-data-breach-p-2913,` [Online; accessed 28-September-2020] (7 2020).\n\n[15] Intel471, Ransomware-as-a-service: The pandemic within a\npandemic, `https://intel471.com/blog/ransomware-as-a-`\n```\n  service-2020-ryuk-maze-revil-egregor-doppelpaymer/,\n\n```\n[Online; accessed 18-December-2020] (2020).\n\n[16] D. R. Thomas, S. Pastrana, A. Hutchings, R. Clayton, A. R.\n[Beresford, Ethical issues in research using datasets of illicit ori-](https://doi.org/10.1145/3131365.3131389)\n[gin, in: Proceedings of the 2017 Internet Measurement Con-](https://doi.org/10.1145/3131365.3131389)\nference, IMC ’17, Association for Computing Machinery, New\nYork, NY, USA, 2017, p. 445–462. `doi:10.1145/3131365.`\n```\n  3131389.\n\n```\n[URL https://doi.org/10.1145/3131365.3131389](https://doi.org/10.1145/3131365.3131389)\n\n[[17] S. Tripathi, Avaddon Ransomware, https://www.subexsecure.](https://www.subexsecure.com/pdf/malware-reports/June-2020/Avaddon_Ransomware.pdf)\n```\n  com/pdf/malware-reports/June-2020/Avaddon_Ransomware.\n  pdf, [Online; accessed 22-September-2020] (6 2020).\n\n```\n[[18] A. Ivanov, Avaddon Ransomware, https://id-ransomware.](https://id-ransomware.blogspot.com/2020/06/avaddon-ransomware.html)\n`blogspot.com/2020/06/avaddon-ransomware.html,` [Online;\naccessed 14-October-2020] (6 2020).\n\n[19] H. Security, Avaddon: From seeking affiliates to in-the-wild\nin 2 days, `https://www.hornetsecurity.com/en/security-`\n```\n  information/avaddon-from-seeking-affiliates-to-in-the  wild-in-2-days/, [Online; accessed 23-August-2020] (6 2020).\n\n```\n[20] M. Malubay, Ransom.Win32.AVADDON.YJAF-A, `https:`\n```\n  //www.trendmicro.com/vinfo/us/threat-encyclopedia/\n\n```\n`malware/Ransom.Win32.AVADDON.YJAF-A,` [Online; accessed\n22-September-2020] (6 2020).\n\n[21] R. Brewer, Ransomware attacks: detection, prevention and\ncure, Network Security 2016.\n\n[22] K. Zetter, What Is Ransomware? A Guide to the Global\n[Cyberattack’s Scary Method, https://www.wired.com/2017/](https://www.wired.com/2017/05/hacker-lexicon-guide-ransomware-scary-hack-thats-rise/)\n```\n  05/hacker-lexicon-guide-ransomware-scary-hack-thats  rise/, [Online; accessed 16-October-2020] (5 2017).\n\n```\n[23] D. Y. Huang, M. M. Aliapoulios, V. G. Li, L. Invernizzi,\nE. Bursztein, K. McRoberts, J. Levin, K. Levchenko, A. C.\nSnoeren, D. McCoy, Tracking ransomware end-to-end, in: 2018\nIEEE Symposium on Security and Privacy (SP), 2018, pp. 618–\n631.\n\n[24] S. Pastrana, G. Suarez-Tangil, A first look at the crypto-mining\nmalware ecosystem: A decade of unrestricted wealth, in: Proceedings of the Internet Measurement Conference, IMC ’19, Association for Computing Machinery, New York, NY, USA, 2019,\np. 73–86.\n\n[25] R. Richardson, M. North, Ransomware: Evolution, mitigation\nand prevention, International Management Review 13 (2017)\n10.\n\n[26] G. Hull, H. John, B. Arief, Ransomware deployment methods\nand analysis: views from a predictive model and human responses, Crime Science 8 (2019) 1–22.\n\n[27] A. Kharaz, S. Arshad, C. Mulliner, W. Robertson, E. Kirda,\nUNVEIL: A large-scale, [automated approach to detecting](https://www.usenix.org/conference/usenixsecurity16/technical-sessions/presentation/kharaz)\n[ransomware, in: 25th USENIX Security Symposium (USENIX](https://www.usenix.org/conference/usenixsecurity16/technical-sessions/presentation/kharaz)\nSecurity 16), USENIX Association, 2016, pp. 757–772.\nURL `https://www.usenix.org/conference/`\n```\n  usenixsecurity16/technical-sessions/presentation/\n  kharaz\n\n```\n[28] E. Kolodenker, W. Koch, G. Stringhini, M. Egele, Paybreak:\nDefense against cryptographic ransomware, in: Proceedings of\nthe 2017 ACM on Asia Conference on Computer and Communications Security, ASIA CCS ’17, Association for Computing\nMachinery, 2017, p. 599–611.\n\n[29] D. Sgandurra, L. Muñoz-González, R. Mohsen, E. Lupu, Automated dynamic analysis of ransomware: Benefits, limitations\nand use for detection, ArXiv abs/1609.03020.\n\n\n-----\n\n[30] R. Vinayakumar, K. P. Soman, K. K. Senthil Velan,\nS. Ganorkar, Evaluating shallow and deep networks for ransomware detection and classification, in: 2017 International\nConference on Advances in Computing, Communications and\nInformatics (ICACCI), 2017, pp. 259–265.\n\n[31] K. Lee, S. Lee, K. Yim, Machine learning based file entropy\nanalysis for ransomware detection in backup systems, IEEE Access 7 (2019) 110205–110215.\n\n[32] J. Caballero, C. Grier, C. Kreibich, V. Paxson, Measuring payper-install: the commoditization of malware distribution., in:\nUsenix security symposium, Vol. 13, 2011.\n\n[33] Kaspersky, xDedic – the shady world of hacked servers\n[for sale, https://securelist.com/xdedic-the-shady-world-](https://securelist.com/xdedic-the-shady-world-of-hacked-servers-for-sale/75027/)\n`of-hacked-servers-for-sale/75027/, [Online;` accessed 04February-2021] (6 2016).\n\n[34] R. Bhalerao, M. Aliapoulios, I. Shumailov, S. Afroz, D. McCoy,\nMapping the underground: supervised discovery of cybercrime\nsupply chains, in: 2019 APWG Symposium on Electronic Crime\nResearch (eCrime), IEEE, 2019, pp. 1–16.\n\n[35] PintSizeNore, AVADDON Ransomware (.avdn; [id][readme.html) Support Topic, https://www.bleepingcomputer.](https://www.bleepingcomputer.com/forums/t/724607/avaddon-ransomware-avdn;-id-readmehtml-support-topic/page-2#entry5061940)\n```\n  com/forums/t/724607/avaddon-ransomware-avdn;-id\n```\n`readmehtml-support-topic/page-2#entry5061940,` [Online;\naccessed 14-October-2020] (09 2020).\n\n[36] M. De Jesus, M. Malubay, A. Christelle Ramos, Ransomware Report: Avaddon and New Techniques Emerge,\nIndustrial Sector Targeted, `https://www.trendmicro.`\n```\n  com/vinfo/us/security/news/cybercrime-and-digital  threats/ransomware-report-avaddon-and-new-techniques\n```\n`emerge-industrial-sector-targeted,` [Online; accessed\n22-September-2020] (7 2020).\n\n[37] M. J. Schwartz, Avaddon Ransomware Joins Data-Leaking\nClub, `https://www.bankinfosecurity.com/avaddon-`\n`ransomware-joins-data-leaking-club-a-14809,` [Online;\naccessed 22-September-2020] (8 2020).\n\n[38] L. Abrams, Avaddon ransomware launches data leak site to\nextort victims, `https://www.bleepingcomputer.com/news/`\n```\n  security/avaddon-ransomware-launches-data-leak-site  to-extort-victims/, [Online; accessed 22-September-2020] (8\n\n```\n2020).\n\n[39] L. Abrams, Avaddon ransomware launches data leak site to\nextort victims, `https://www.bleepingcomputer.com/news/`\n```\n  security/another-ransomware-now-uses-ddos-attacks-to  force-victims-to-pay/, [Online; accessed 03-February-2021]\n\n```\n(1 2021).\n\n[40] Emsisoft, Urgently Needed! Avaddon ransomware (.avdn),\n```\n  https://support.emsisoft.com/topic/33623-urgently\n```\n`needed-avaddon-ransomware-avdn/,` [Online; accessed 21October-2020] (2020).\n\n[41] B. Computer, AVADDON Ransomware (.avdn; [id][readme.html) Support Topic, https://www.bleepingcomputer.](https://www.bleepingcomputer.com/forums/t/724607/avaddon-ransomware-avdn;-id-readmehtml-support-topic/page-2)\n```\n  com/forums/t/724607/avaddon-ransomware-avdn;-id\n```\n`readmehtml-support-topic/page-2,` [Online; accessed 21October-2020] (2020).\n\n[42] Microsoft, PE Format, `https://docs.microsoft.com/en-`\n`us/windows/win32/debug/pe-format,` [Online; accessed 01October-2020] (2020).\n\n[43] R. Lyda, J. Hamrock, Using entropy analysis to find encrypted\nand packed malware, IEEE Security and Privacy 5 (2) (2007)\n40–45.\n\n[44] P. V. Sabanal, M. V. Yason, Reversing c++, Black Hat DC.\n\n[45] hfiref0x2017, UAC bypass using CMSTPLUA COM\ninterface, `https://gist.github.com/api0cradle/`\n`d4aaef39db0d845627d819b2b6b30512,` [Online; accessed 31August-2020] (2017).\n\n[46] A. Osipov, Trickbot Trojan leveraging a new Windows 10 UAC\n[bypass, https://blog.morphisec.com/trickbot-uses-a-new-](https://blog.morphisec.com/trickbot-uses-a-new-windows-10-uac-bypass)\n`windows-10-uac-bypass,` [Online; accessed 31-August-2020]\n(2020).\n\n[47] S. in bits, UAC bypass analysis (Stage 1) Ataware Ransomware\n– Part 0x2, `https://www.securityinbits.com/malware-`\n\n```\n  analysis/uac-bypass-analysis-stage-1-ataware\n```\n`ransomware-part-2/,` [Online; accessed 31-August-2020]\n(2019).\n\n[48] Microsoft, EnableLUA, `https://docs.microsoft.com/en-`\n```\n  us/openspecs/windows_protocols/ms-gpsb/958053ae-5397\n```\n`4f96-977f-b7700ee461ec,` [Online; accessed 21-July-2020]\n(2019).\n\n[49] Microsoft, ConsentPromptBehaviorAdmin, `https://docs.`\n```\n  microsoft.com/en-us/openspecs/windows_protocols/ms\n```\n`gpsb/341747f5-6b5d-4d30-85fc-fa1cc04038d4,` [Online;\naccessed 21-July-2020] (2019).\n\n[50] Microsoft, Mapped drives are not available from an elevated\nprompt when UAC is configured to \"Prompt for credentials\" in Windows, `https://support.microsoft.com/en-`\n```\n  us/help/3035277/mapped-drives-are-not-available-from\n```\n`an-elevated-prompt-when-uac-is-co,` [Online; accessed\n21-July-2020] (2015).\n\n[51] Lockheed Martin, The Cyber Kill Chain, `https://www.`\n```\n  lockheedmartin.com/en-us/capabilities/cyber/cyber  kill-chain.html, [Online; accessed 08-October-2020].\n\n```\n[52] B. Baskin, TAU Threat Analysis: Medusa Locker Ransomware, `https://www.carbonblack.com/blog/tau-threat-`\n`analysis-medusa-locker-ransomware/,` [Online; accessed\n19-October-2020] (June 2020).\n\n[53] A. Zsigovits, Ransomware-LockBit, `https://github.com/`\n```\n  sophoslabs/IoCs/blob/master/Ransomware-LockBit, [Online;\n\n```\naccessed 19-October-2020] (2020).\n\n[54] Microsoft, CryptImportKey function, `https://docs.`\n```\n  microsoft.com/en-us/windows/win32/api/wincrypt/nf  wincrypt-cryptimportkey, [Online; accessed 27-August-2020]\n\n```\n(2018).\n\n[55] Sasza, Structure of HCRYPTKEY Data, `https:`\n```\n  //forums.codeguru.com/showthread.php?79163-Structure\n```\n`of-HCRYPTKEY-Data,` [Online; accessed 26-September-2020]\n(2020).\n\n[56] Microsoft, ALG_ID, `https://docs.microsoft.com/en-`\n`us/windows/win32/seccrypto/alg-id,` [Online; accessed\n26-September-2020] (2018).\n\n\n-----\n\n### Appendix A\n\nTable 2: List of whitelisted strings in the encryption process.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://arxiv.org/pdf/2102.04796.pdf"
    ],
    "report_names": [
        "2102.04796.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c3c864b3-fac9-4d56-8500-7c06c829fbf8",
            "created_at": "2023-01-06T13:46:39.071873Z",
            "updated_at": "2025-03-27T02:00:02.990045Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Storm-0216",
                "DEV-0216",
                "UNC2198",
                "Maze Team",
                "TWISTED SPIDER",
                "GOLD VILLAGE"
            ],
            "source_name": "MISPGALAXY:TA2101",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e9f85280-337c-4321-b872-0919f8ef64a6",
            "created_at": "2022-10-25T16:07:24.261761Z",
            "updated_at": "2025-03-27T02:02:10.153781Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Gold Village",
                "Maze Team",
                "TA2101",
                "Twisted Spider"
            ],
            "source_name": "ETDA:TA2101",
            "tools": [
                "7-Zip",
                "Agentemis",
                "BokBot",
                "Buran",
                "ChaCha",
                "Cobalt Strike",
                "CobaltStrike",
                "Egregor",
                "IceID",
                "IcedID",
                "Mimikatz",
                "PsExec",
                "SharpHound",
                "VegaLocker",
                "WinSCP",
                "cobeacon",
                "nmap"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041503,
    "ts_creation_date": 1612926338,
    "ts_modification_date": 1612926338,
    "files": {
        "pdf": "https://archive.orkl.eu/3b2344dc14801bb90465cdb9637b5f1ef15ba37f.pdf",
        "text": "https://archive.orkl.eu/3b2344dc14801bb90465cdb9637b5f1ef15ba37f.txt",
        "img": "https://archive.orkl.eu/3b2344dc14801bb90465cdb9637b5f1ef15ba37f.jpg"
    }
}