{
    "id": "c84f8bdc-46ff-4d5e-bd44-35ce8d1ed3c7",
    "created_at": "2022-10-25T16:48:14.682906Z",
    "updated_at": "2025-03-27T02:05:51.002345Z",
    "deleted_at": null,
    "sha1_hash": "b55304b4523636851d274df6734b56c5efa5315c",
    "title": "PowerPoint Presentation",
    "authors": "",
    "file_creation_date": "2019-11-28T09:34:01Z",
    "file_modification_date": "2019-11-28T09:34:01Z",
    "file_size": 8407684,
    "plain_text": "## Demystifying banking trojans from Latin America\n\n###### Juraj Horňák | Malware analyst Jakub Souček | Malware analyst\n\n\n-----\n\n##### Before we begin …\n\n\n-----\n\n# What sets LATAM banking\n trojans apart?\n\n\n-----\n\n##### Characteristics\n\n### • Delphi\n • Backdoor commands\n • Targets Spanish- or Portugese-speaking countries\n • Abusing legitimate tools and software\n • Looong distribution chains\n • Multiple components\n\n\n-----\n\n##### … and also\n\n### • Payload(s) usually come in ZIP archives\n • Generally unknown crypto algorithms\n • One URL used to submit victim information\n • Fake pop-up windows + social engineering\n\n\n-----\n\n-----\n\n-----\n\n##### Problem\n\n### • The banking trojans are very similar\n • Generic detection names\n\n##### • Win32/Spy.Banker.XXXX\n • Trojan-Banker.Win32.Generic\n • Trojan:Win32/Banbra\n\n### • Analysis required to identify malware families\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Mekotio Lokorrito\n\n\n-----\n\n#### • Binaries\n • Distribution chains\n • Network\n • OPSEC\n • Easter eggs & human error\n • Similarities\n\n\n-----\n\n# Strings\n\n\n-----\n\n##### Strings useful for identifying malware families\n\n#### • Synchronization object\n names (mutex)\n • Format of web requests\n\n###### • User-Agent\n • Query arguments\n\n#### • Names of commands\n • Debug messages\n\n\n-----\n\n# Strings obfuscation\n & encryption\n\n\n-----\n\n##### String concatenation\n\n\n-----\n\n##### String tables\n\n\n-----\n\n|Malware family|TripleKey|BookDecrypt|XOR_FF|KeySub|BigAlpha|Division|Known crypto algorithm|\n|---|---|---|---|---|---|---|---|\n|Amavaldo||||||||\n|Casbaneiro||||||||\n|Grandoreiro||||||||\n|Guildma||||||||\n|Krachulka||||||||\n|Lokorrito||||||||\n|Mispadu||||||||\n|Numando||||||||\n|Mekotio||||||||\n|Vadokrist||||||||\n|Zumanek||||||||\n\n\n##### Cryptographic algorithms overview\n\n###### Known crypto Malware family TripleKey BookDecrypt XOR_FF KeySub BigAlpha Division\n algorithm\n\n Amavaldo \n\n Casbaneiro   \n\n Grandoreiro  \n\n Guildma  \n\n Krachulka \n\n Lokorrito \n\n Mispadu \n\n Numando  \n\n Mekotio \n\n Vadokrist   \n\n Zumanek \n\n\n-----\n\n|Malware family|TripleKey|BookDecrypt|XOR_FF|KeySub|BigAlpha|Division|Known crypto algorithm|\n|---|---|---|---|---|---|---|---|\n|Amavaldo||||||||\n|Casbaneiro||||||||\n|Grandoreiro||||||||\n|Guildma||||||||\n|Krachulka||||||||\n|Lokorrito||||||||\n|Mispadu||||||||\n|Numando||||||||\n|Mekotio||||||||\n|Vadokrist||||||||\n|Zumanek||||||||\n\n\n##### Cryptographic algorithms overview\n\n###### Known crypto Malware family TripleKey BookDecrypt XOR_FF KeySub BigAlpha Division\n algorithm\n\n Amavaldo \n\n Casbaneiro   \n\n Grandoreiro  \n\n Guildma  \n\n Krachulka \n\n Lokorrito \n\n Mispadu \n\n Numando  \n\n Mekotio \n\n Vadokrist   \n\n Zumanek \n\n\n-----\n\n# Extremely large binaries\n\n\n-----\n\n##### Overview\n\n### • Simple, yet effective\n • Binary included in ZIP archive\n • Compression: 350 MB -> 15 MB\n • Hard to work with such files\n\n##### • Upload\n • Automated processing\n\n### • MITRE ATT&CK: Binary padding\n\n\n-----\n\n##### Bytes in overlay\n\n### • Easy to remove\n • Original MZ remains\n intact\n • Casbaneiro, Mekotio\n\n\n-----\n\n##### Bytes in overlay\n\n### • Hard to remove\n • Complicated if\n original MZ should be kept valid\n • Grandoreiro\n\n\n-----\n\n# Following the distribution\n chains\n\n\n-----\n\n##### Reason 1: Data\n\n#### • Receiving 300+ MB • Early detection  chain\n large binaries? Unlikely is broken  no payload\n information\n\n\n-----\n\n##### Reason 2: Context\n\n### • Configuration files\n • Injectors\n • Data passed between\n distribution chain stages\n\n\n-----\n\n##### Reason 2: Context\n\n### • Configuration files\n • Injectors\n • Data passed between\n distribution chain stages\n\n\n-----\n\n##### Reason 2: Context\n\n### • Configuration files\n • Injectors\n • Data passed between\n distribution chain stages\n\n\n-----\n\n##### Reason 3: Knowledge\n\n### • Way of execution • Script obfuscation\n • Persistence method • Function and variable\n names\n\n • Open directories\n\n • Payload names\n • Web requests format\n\n##### • User-agent\n • POST data\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n# Do you C what I C?\n\n\n-----\n\n##### Encrypted, hardcoded\n\n### • Key\n\n##### • Hardcoded\n\n### • Domain\n\n##### • Hardcoded\n • Encrypted\n\n### • Port\n\n##### • Hardcoded\n\n\n-----\n\n##### Embedded in a remote document (v1)\n\n### • Key\n\n##### • Hardcoded\n\n### • Domain\n\n##### • Encrypted\n • Stored between “!”\n\n### • Port\n\n##### • Hardcoded\n\n\n-----\n\n##### Embedded in a remote document (v2)\n\n### • Key\n\n##### • Hardcoded\n\n### • Domain\n\n##### • Encrypted\n • Stored (“sundski”)\n\n### • Port\n\n##### • Stored (“thedoor”)\n\n\n-----\n\n##### Embedded in a crafted website\n\n### • Key\n\n##### • Part of data\n\n### • Domain\n\n##### • Encrypted\n • Stored (“<google-site-\n verification>”)\n\n### • Port\n\n##### • Hardcoded\n\n\n-----\n\n##### Embedded in a crafted website\n\n### • Key\n\n##### • Part of data\n\n### • Domain\n\n##### • Encrypted\n • Stored (“<google-site-\n verification>”)\n\n### • Port\n\n##### • Hardcoded\n\n\n-----\n\n##### Embedded in a legitimate website\n\n### • Key\n\n##### • Part of data\n\n### • Domain\n\n##### • Encrypted\n • Stored (fake link)\n\n### • Port\n\n##### • Hardcoded\n\n\n-----\n\n##### Embedded in a legitimate website\n\n### • Key\n\n##### • Part of data\n\n### • Domain\n\n##### • Encrypted\n • Stored (fake link)\n\n### • Port\n\n##### • Hardcoded\n\n\n-----\n\n##### Generated using a fake DNS entry\n\n### • Inputs\n\n##### • Base domain (“abc.de.xyz)\n • List of suffixes ([“1”,”2”,”3”])\n • Number (10)\n\n\n-----\n\n##### Generated using a fake DNS entry\n\n### 1. Take base domain abc.de.xyz\n\n\n-----\n\n##### Generated using a fake DNS entry\n\n### 1. Take base domain abc1.de.xyz 2. Modify it by suffix\n\n\n-----\n\n##### Generated using a fake DNS entry\n\n### 1. Take base domain 127.0.0.1 2. Modify it by suffix 3. Resolve it to an IP\n\n\n-----\n\n##### Generated using a fake DNS entry\n\n### 1. Take base domain 0x7F000001 2. Modify it by suffix 3. Resolve it to an IP 4. Convert to number\n\n\n-----\n\n##### Generated using a fake DNS entry\n\n### 1. Take base domain 0x7F000001 + 0xA 2. Modify it by suffix = 0x7F00000B 3. Resolve it to an IP 4. Convert to number 5. Add the number\n\n\n-----\n\n##### Generated using a fake DNS entry\n\n### 1. Take base domain 127.0.0.11 2. Modify it by suffix 3. Resolve it to an IP 4. Convert to number 5. Add the number 6. Convert to IP\n\n\n-----\n\n##### Generated using a fake DNS entry (for port)\n\n### 1. Take base domain (127+0+0+11) * 7 = 2. Modify it by suffix 138 * 7 = 3. Resolve it to an IP 966 4. Convert to number 5. Add the number 6. Convert to IP 7. Sum octets * 7\n\n\n-----\n\n# C&C communication\n\n\n-----\n\n##### C&C communication\n\n### • Clients do not ask server for commands\n • They connect, stay connected and wait\n • When the server sends a command, they react\n\n\n-----\n\n##### C&C communication\n\n### • Example: the Grandoreiro family\n • Like a chat room\n • How it works:\n\n##### • Perform handshake\n • Periodically receive commands\n • The first one is …\n\n\n-----\n\n##### C&C communication\n\n\n-----\n\n##### C&C communication\n\n### • … a list of all connected victims\n\n##### • PC name\n • MAC address\n • Installed / running banking application(s)\n • Protection software (Trusteer / Warsaw GAS Tecnologia)\n • Windows version\n • Banking trojan version\n\n\n-----\n\n# OPSEC\n\n\n-----\n\n##### Open directory\n\n### • Victim information\n • New versions\n • Related malware\n • C&C panel\n\n\n-----\n\n##### Victim information (Mekotio)\n\n### • PC name\n • IP address\n • Banking trojan version\n • Windows version\n • AV installed\n • Timestamp\n\n\n-----\n\n##### New versions (Zumanek)\n\n\n-----\n\n##### New versions (Zumanek)\n\n\n-----\n\n##### New versions (Zumanek)\n\n\n-----\n\n##### Control panel (Casbaneiro)\n\n\n-----\n\n##### Control panel (Casbaneiro)\n\n\n-----\n\n##### Control panel (Casbaneiro)\n\n\n-----\n\n# Easter eggs\n\n\n-----\n\n##### Server-side requests checking\n\n\n-----\n\n##### Payload archives content\n\n\n-----\n\n##### Payload archives content\n\n\n-----\n\n##### Payload archives content\n\n\n-----\n\n##### Payload archives content\n\n\n-----\n\n# Human error\n\n\n-----\n\n##### Don t forget to …\n\n\n-----\n\n##### Careful with that DGA\n\n### • Grandoreiro\n • C&C domain\n obtained by DGA\n • Input: alphabet\n dependant on hour of day\n\n\n-----\n\n##### Careful with that DGA\n\n### • 10:00 PM\n • Night hours\n • C&C “offline”\n\n\n-----\n\n##### Careful with that DGA\n\n### • 03:00 AM\n • First phase begins\n • Use alphabet 1\n\n\n-----\n\n##### Careful with that DGA\n\n### • 08:00 AM\n • Transition\n • Use alphabet 2\n\n\n-----\n\n##### Careful with that DGA\n\n### • 01:00 PM\n • Transition\n • Use alphabet 3\n\n\n-----\n\n##### Careful with that DGA\n\n### • 09:00 PM\n • Transition…\n\n\n-----\n\n##### Careful with that DGA\n\n### • 09:00 PM\n • Transition…\n\n\n-----\n\n##### Careful with that DGA\n\n### • 09:00 PM\n • Transition…\n • Malware crashes \n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n String table Mekotio Lokorrito\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n HTTP query\n Mekotio Lokorrito\n parameters\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Crypto algorithm Mekotio Lokorrito (BookDecrypt)\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Crypto algorithm Mekotio Lokorrito (BigAlpha)\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Crypto algorithm Mekotio Lokorrito (TripleKey)\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Response decryption\n Mekotio Lokorrito\n algorithm\n (XOR_FF)\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Delphi\n Mekotio Lokorrito\n downloader\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Delphi\n Mekotio Lokorrito\n downloader\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Delphi\n Mekotio Lokorrito\n downloader\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Injector technique + Mekotio Lokorrito mutex name\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n VBS\n Mekotio Lokorrito\n downloader\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n “Zipada”\n Mekotio Lokorrito\n variable name\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n „Windows Activator“ Mekotio Lokorrito downloader\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n PowerShell obfuscation Mekotio Lokorrito\n method\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n BAT obfuscation\n Mekotio Lokorrito\n method\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n JavaScript obfuscation Mekotio Lokorrito\n method\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n „BAT to VBS“\n obfuscation Mekotio Lokorrito\n method\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n HTTP verb\n Mekotio Lokorrito\n („111SA“)\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Payload name\n and content Mekotio Lokorrito\n (md.zip)\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Mekotio Lokorrito\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Mekotio Lokorrito\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Mekotio Lokorrito\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Mekotio Lokorrito\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Mekotio Lokorrito\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Mekotio Lokorrito\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Mekotio Lokorrito\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Mekotio Lokorrito\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Mekotio Lokorrito\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Mekotio Lokorrito\n\n\n-----\n\n###### Zumanek Grandoreiro\n\n Vadokrist Guildma\n\n Mispadu Krachulka\n\n Mekotio Lokorrito\n\n\n-----\n\n### Jakub Souček Juraj Horňák\n\n###### Malware Analyst Malware Analyst\n\n jakub.soucek@eset.cz juraj.hornak@eset.cz\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.botconf.eu/wp-content/uploads/2019/12/B2019-Soucek-Hornak-DemystifyingBankingTrojansFromLatinAmerica.pdf"
    ],
    "report_names": [
        "B2019-Soucek-Hornak-DemystifyingBankingTrojansFromLatinAmerica.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041151,
    "ts_creation_date": 1574933641,
    "ts_modification_date": 1574933641,
    "files": {
        "pdf": "https://archive.orkl.eu/b55304b4523636851d274df6734b56c5efa5315c.pdf",
        "text": "https://archive.orkl.eu/b55304b4523636851d274df6734b56c5efa5315c.txt",
        "img": "https://archive.orkl.eu/b55304b4523636851d274df6734b56c5efa5315c.jpg"
    }
}