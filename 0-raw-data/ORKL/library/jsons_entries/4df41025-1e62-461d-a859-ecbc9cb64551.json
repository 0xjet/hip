{
    "id": "4df41025-1e62-461d-a859-ecbc9cb64551",
    "created_at": "2023-01-12T14:58:59.824058Z",
    "updated_at": "2025-03-27T02:08:40.498868Z",
    "deleted_at": null,
    "sha1_hash": "6372c22c4dea622c236a52c576feb403ba1e12d7",
    "title": "2018-08-09 - Bokbot- The (re)birth of a banker",
    "authors": "",
    "file_creation_date": "2022-05-28T03:58:12Z",
    "file_modification_date": "2022-05-28T03:58:12Z",
    "file_size": 712784,
    "plain_text": "# Bokbot: The (re)birth of a banker\n\n**[blog.fox-it.com/2018/08/09/bokbot-the-rebirth-of-a-banker/](https://blog.fox-it.com/2018/08/09/bokbot-the-rebirth-of-a-banker/)**\n\nAugust 9, 2018\n\n_This blogpost is a follow-up to a presentation with the same name, given at SecurityFest in_\n_[Sweden by Alfred Klason.](https://twitter.com/tehsyntx)_\n\n## Summary\n\nBokbot (aka: IcedID) came to Fox-IT‚Äôs attention around the end of May 2017 when we\nidentified an unknown sample in our lab that appeared to be a banker. This sample was also\nprovided by a customer at a later stage.\n\nHaving looked into the bot and the operation, the analysis quickly revealed that it‚Äôs\nconnected to a well-known actor group that was behind an operation publically known as\n_76service and later Neverquest/Vawtrak, dating back to 2006._\n\nNeverquest operated for a number of years before an arrest lead to its downfall in January\n2017. Just a few months afterwards we discovered a new bot, with a completely new code\nbase but based on ideas and strategies from the days of Neverquest. Their business ties\nremains intact as they still utilize services from the same groups as seen before but also\nexpanded to use new services.\n\nThis suggests that at least parts of the group behind Neverquest is still operating using\nBokbot. It‚Äôs however unclear how many of the people from the core group that have\ncontinued on with Bokbot.\n\nBokbot is still a relatively new bot, just recently reaching a production state where they have\nstreamlined and tested their creation. Even though it‚Äôs a new bot, they still have strong\nconnections within the cybercrime underworld which enables them to maintain and grow their\noperation such as distributing their bot to a larger number of victims.\n\n\n-----\n\nBy looking back in history and the people who are behind this, it is highly likely that this is a\nthreat that is not going away anytime soon. Fox-IT rather expects an expansion of both the\nbotnet size and their target list.\n\n## 76service and Neverquest\n\n76service was, what one could call, a big-data mining service for fraud, powered by CRM\n(aka: Gozi). It was able to gather huge amounts of data from its victims using, for example,\nformgrabbing where authorization and log-in credentials are retrieved from forms submitted\nto websites by the infected victim.\n\n76service login page (source: krebsonsecurity.com)\n\nThe service was initially spotted in 2006 and was put into production in 2007, where the\nauthors started to rent out access to their platform. When given access to the platform, the\nfraudulent customers of this service could free-text search in the stolen data for credentials\nthat provide access to online services, such as internet banking, email accounts and other\nonline platforms.\n\n76service operated uninterrupted until November 2010, when an Ukrainian national named\n[Nikita Kuzmin got arrested in connection with the operation. This marked the end of the](https://www.justice.gov/usao-sdny/pr/nikita-kuzmin-creator-gozi-virus-sentenced-manhattan-federal-court)\n76service service.\n\n## Nice Catch! ‚Äì The real name of Neverquest\n\nA few months before the arrest of Nikita he shared the source code of CRM within a private\ngroup of people which would enable them to continue the development of the malware. This,\nover time, lead to the appearance of multiple Gozi strains, but there was one which stood out\nmore than the others, namely: Catch.\n\nCatch was the name given internally by the malware authors, but to the security community\nand the public it was known as Vawtrak or Neverquest.\n\n\n-----\n\nDuring this investigation into Catch it became clear that 76service and Catch shared several\ncharacteristics. They both, for example, separated their botnets into projects within the panel\nthey used for administering their infrastructure and botnets. Instead of having one huge\nbotnet, they assigned every bot build with a project ID that would be used by the bot to let\nthe Command & Control (C2) server know which specific project the bot belonged to.\n\n76service and Catch also shared the same business model, where they shifted back and\nforth between a private and rented model.\n\nThe private business model meant that they made use of their own botnet, for their own gain,\nand the rented business model meant that they rented out access to their botnet to\ncustomers. This provided them with an additional income stream, instead of only performing\nthe fraud themselves.\n\nThe shift between business models could usually be correlated with either: backend servers\nbeing seized or people with business ties to the group being arrested. These types of events\nmight have spooked the group as they limited their infrastructure, closing down access for\ncustomers.\n\nFor the sake of simplicity, Catch will from here on be referred to as Neverquest in this post.\n\n## ‚ÄúQuest means business‚Äù ‚Äì Affiliations\n\nIf one would identify a Neverquest infection it might not be the only malware that is lurking on\nthe infected system. Neverquest has been known to cooperate with other crimeware groups,\neither to distribute additional malware or use existing botnets to distribute Neverquest.\n\nDuring the investigation and tracking of Neverquest Fox-IT identified the following ties:\n\n\n**Crimeware/malware**\n**group**\n\n\n**Usage/functionality**\n\n\nDyre Download and execute Dyre on Neverquest infections\n\n\nTinyLoader &\nAbaddonPOS\n\n\nDownload and execute TinyLoader on Neverquest infections.\nTinyLoader was later seen downloading AbaddonPOS (as\n[mentioned by Proofpoint)](https://www.proofpoint.com/us/threat-insight/post/AbaddonPOS-A-New-Point-Of-Sale-Threat-Linked-To-Vawtrak)\n\n\nChanitor/Hancitor Neverquest leverages Chanitor to infect new victims.\n\nBy leveraging these business connections, especially the connection with Dyre, Neverquest\nis able to maximize the monetization of the bots. This since Neverquest could see if a bot\nwas of interest to the group and if not, it could be handed off to Dyre which could cast a\nwider net, targeting for example a bigger or different geographical region and utilize a bot in\na different way.\n\n\n-----\n\nMore on these affiliations in a later section.\n\n## The never ending quest comes to an end\n\nNeverquest remained at large from around 2010, causing huge amounts of financial losses,\nranging from ticket fraud to wire fraud to credit card fraud. Nevertheless, in January 2017 the\n[quest came to an end, as an individual named Stanislav Lisov was arrested in Spain. This](https://en.crimerussia.com/gromkie-dela/spain-to-finally-extradite-russian-hacker-lisov-to-us/)\nindividual was proven to be a key player in the operation: soon after the arrest the backend\nservers of Neverquest went offline, never to come back online, marking the end of a 6 year\nlong fraud operation.\n\n[A more detailed background on 76service and Neverquest can be found in a blogpost by](https://info.phishlabs.com/blog/the-unrelenting-evolution-of-vawtrak)\nPhishLabs.\n\n## A wild Bokbot appears!\n\nEarly samples of Bokbot were identified in our lab in May 2017 and also provided to us by a\ncustomer. At this time the malware was being distributed to US infections by the Geodo (aka:\nEmotet) spam botnet. The name Bokbot is based on a researcher who worked on the very\nearly versions of the malware (you know who you are üòâ ).\n\nInitial thoughts were that this was a new banking module for Geodo, as this group had not\nbeen involved in banking/fraud since May 2015. This scenario was quickly dismissed after\nhaving discovered evidence that linked Bokbot to Neverquest, which will be further outlined\nhereafter.\n\n## Bokbot internals\n\nFirst, let‚Äôs do some housekeeping and look into some of the technical aspects of Bokbot.\n\n### Communication\n\nAll communication between a victim and the C2 server is sent over HTTPS using POST- and\nGET-requests. The initial request sent to the C2 is a POST-request containing some basic\ninformation about the machine it‚Äôs running on, as seen in the example below. Any additional\nrequests like requesting configs or modules are sent using GET-requests, except for the\nuploading of any stolen data such as files, HTML code, screenshots or credentials which the\nvictim submits using POST-requests.\n\n\n-----\n\nEven though the above request is from a very early version (14) of the bot, the principle still\napplies to the current version (101), first seen 2018-07-17.\n\n\n**URL**\n**param.**\n\n\n**Comment**\n\n\nb Bot identifier, contains the information needed to identify the individual bot and\nwhere it belongs. More information on this in later a section.\n\nd Type of uploaded information. For example screenshot, grabbed form, HTML or\na file\n\ne Bot build version\n\ni System uptime\n\n**POST-data param.** **Comment**\n\nk Computer name (Unicode, URL-encoded)\n\nl Member of domain‚Ä¶ (Unicode, URL-encoded)\n\nj Bot requires signature verification for C2 domains and self-updates\n\nn Bot running with privilege level‚Ä¶\n\nm Windows build information (version, arch., build, etc.)\n\nThe parameters that are not included in the table above are used to report stolen data to the\nC2.\n\nThe C2 response of this particular bot version is a simple set of integers which tells the bot\nwhich command(s) that should be executed. This is the only C2 response that is\nunencrypted, all other responses are encrypted using RC4. Some responses are, like the\nconfigs, also compressed using LZMAT.\n\nAfter a response is decrypted, the bot will check if the first 4 bytes equal ‚Äúzeus‚Äù.\n\nIf the first 4 bytes are equal to ‚Äúzeus‚Äù, it will decompress the rest of the data.\n\n\n-----\n\nThe reason for choosing zeus as the signature remains unknown, it could be an intentional\nfalse flag, in an attempt to trick analysts into thinking that this might be a new ZeuS strain.\nSimilar elusive techniques have been used before to trick analysts. A simpler explanation\ncould be that the developer simply had an ironic sense of humor, and chose the first malware\nname that came to mind as the 4 byte signature.\n\n### Configs\n\nBokbot supports three different types of configs, which all are in a binary format rather than\nsome structured format like XML, which is, for example, used by TheTrick.\n\n**Config** **Comment**\n\nBot The latest C2 domains\n\nInjects Contains targets which are subject to web injects and redirection attacks\n\nReporting Contains targets related to HTML grabbing and screenshots\n\nThe first config, which includes the bot C2 domains, is signed. This to prevent that a takeover\nof any of the C2 domains would result in a sinkholing of the bots. The updates of the bot\nitself are also signed.\n\nThe other two configs are used to control how the bot will interact with the targeted entities,\nsuch as redirecting and modifying web traffic related to for example internet banking and/or\nemail providers, for the purpose of harvesting credentials and account information.\n\nThe reporting config is used for a more generic purpose, where it‚Äôs not only used for\nscreenshots but also for HTML grabbing, which would grab a complete HTML page if a\nvictim browses to an ‚Äúinteresting‚Äù website, or if the page contains a specific keyword. This\nenables the actors to conduct some reconnaissance for future attacks, like being able to\nwrite web injects for a previously unknown target.\n\n## Geographical foothold\n\nEver since the appearance Bokbot has been heavily focused on targeting financial\ninstitutions in the US even though they‚Äôre still gathering any data that they deem interesting\nsuch as credentials for online services.\n\nBased on Fox-IT‚Äôs observation of the malware spread and the accompanied configs we find\nthat North America seems to be Bokbot‚Äôs primary hunting ground while high infection counts\nhave been seen in the following countries:\n\nUnited States\nCanada\n\n\n-----\n\nIndia\nGermany\nNetherlands\nFrance\nUnited Kingdom\nItaly\nJapan\n\n## ‚ÄúI can name fingers and point names!‚Äù ‚Äì Connecting the two groups\n\nThe two bots, on a binary level, do not show much similarity other than the fact that they‚Äôre\nboth communicating over HTTPS and use RC4 in combination with LZMAT compression. But\nthis wouldn‚Äôt be much of an attribution as it‚Äôs also a combination used in for example ZeuS\nGameover, Citadel and Corebot v1.\n\nThe below tables provides a short summary of the similarities between the groups.\n\n**Connection** **Comment**\n\n\nBot and\nproject ID\nformat\n\n\nThe usage of projects and the bot ID generation are unique to these groups\nalong with the format that this information is communicated to the C2.\n\n\nInject config The injects and redirection entries are very similar and the format haven‚Äôt\nbeen seen in any other malware family.\n\n\nReporting\nconfig\n\n\nThe targeted URLs and ‚Äúinteresting‚Äù keywords are almost identical between\nthe two.\n\n\nAffiliations The two group share business affiliations with other crimeware groups.\n\n## Bot ID, URL pattern and project IDs\n\nWhen both Neverquest and Bokbot communicate with their C2 servers, they have to identify\nthemselves by sending their unique bot ID along with a project ID.\n\nAn example of the string that the server uses in order to identify a specific bot from its C2\ncommunication is shown below:\n\n\n-----\n\nThe placement of this string is of course different between the families, where Neverquest (in\nthe latest version) placed it, encoded, in the Cookie header field. Older version of\nNeverquest sent this information in the URL. Bokbot on the other hand sends it in the URL\nas shown in a previous section.\n\nOne important difference is that Neverquest used a simple number for their project ID, 7, in\nthe example above. Bokbot on the other hand is using a different, unknown format for its\nproject ID. A theory is that this could be the CRC checksum of the project name to prevent\nany leakage of the number of projects or their names, but this is pure speculation.\n\nAnother difference is that Bokbot has implemented an 8 bit checksum that is calculated using\nthe project ID and the bot ID. This checksum is then validated on the server side and if it\ndoesn‚Äôt match, no commands will be returned.\n\nTo this date there has been a total of 20 projects over 25 build versions observed, numbers\nthat keeps on growing.\n\n## Inject config ‚Äì Dynamic redirect structure\n\nThe inject config not only contain web injects but also redirects. Bokbot supports both static\nredirects which redirects a static URL but also dynamic redirects which redirects a request\nbased on a target matched using a regular expression.\n\nThe above example is a redirect attack from a Neverquest config. They use a regular\nexpression to match on the requested URL. If it should match they will extract the name of\nthe requested file along with its extension. The two strings are then used to construct a\nredirect URL controlled by the actors. Thereby, the $1 will be replaced with the file name and\n_$2 will be replaced with the file extension._\n\nHow does this compare with Bokbot?\n\nNotice how the redirect URL contains $1 and $2, just as with Neverquest. This could of\ncourse be a coincidence but it should be mentioned that this is something that has only been\nobserved in Neverquest and Bokbot.\n\n## Reporting config\n\n\n-----\n\nThis config was one of the very first things that hinted about a connection between the two\ngroups. By comparing the configs it becomes quite clear that there is a big overlap in\ninteresting keywords and URLs:\n\nNeverquest is on the left and Bokbot on the right. Note that this is a simple string comparison\nbetween the configs which also includes URLs that are to be excluded from reporting.\n\n## ‚ÄúGuilt by association‚Äù ‚Äì Affiliations\n\nNone of these groups are short on connections in the cybercrime underworld. It‚Äôs already\nmentioned that Neverquest had ties with Dyre, a group which by itself caused substantial\nfinancial losses. But it‚Äôs also important to take into account that Dyre didn‚Äôt completely go\naway after the group got dismantled but was rather replaced with TheTrick which gives a\nfurther hint of a connection.\n\n\n**Neverquest affil.** **Bokbot**\n**affil.**\n\n\n**Comment**\n\n\nDyre TheTrick Neverquest downloads &\nexecutes Dyre\n\nBokbot downloads & executes TheTrick\n\nTinyLoader TinyLoader Neverquest downloads &\nexecutes TinyLoader which\ndownloads AbaddosPOS\n\nBokbot downloads & executes TinyLoader,\nadditional payload remains unknown at this\ntime\n\n\n-----\n\nChanitor Chanitor Neverquest utilizes\nChanitor for distribution of\nNeverquest\n\nBokbot utilizes Chanitor for distribution of\nBokbot, downloads SendSafe spam malware\nto older infections.\n\nGeodo Bokbot utilizes Geodo for\ndistributing Bokbot\n\nGozi-ISFB Bokbot utilizes Gozi-ISFB\nfor distributing Bokbot\n\nThere are a few interesting observations with the above affiliations. The first is for the\nChanitor affiliation.\n\nWhen Bokbot was being distributed by Chanitor, an existing Bokbot infection that was\nrunning an older version than the one being distributed by Chanitor, would receive a\ndownload & execute command which pointed to the SendSafe spambot, used by the\nChanitor group to send spam. Suggesting that they may have exchanged ‚Äúinfections for\ninfections‚Äù.\n\nThe Bokbot affiliation with Geodo is something that cannot be linked to Neverquest, mostly\ndue to the fact that Geodo has not been running its spam operation long enough to overlap\nwith Neverquest.\n\nThe below graph show all the observed affiliations to date.\n\n\n-----\n\n## Events over time\n\nAll of the above information have been collected over time during the development and\ntracking of Bokbot. The events and observations can be observed on the below timeline.\n\n\n-----\n\nThe first occurrence of TheTrick being downloaded was in July 2017 but Bokbot has since\nbeen downloading TheTrick at different occasions.\n\nAt the end of December 2017 there was little Bokbot activity, likely due to the fact that it was\nholidays. It‚Äôs not uncommon for cybercriminals to decrease their activity during the turn of the\nyear, supposedly everyone needs holidays, even cybercriminals. They did however push an\ninject config to some bots which targeted *.com with the goal of injecting Javascript to mine\nMonero cryptocurrency. As soon as an infected user visits a website with a .com top-level\ndomain (TLD), the browser would start mining Monero for the Bokbot actors. This was likely\nan attempt to passively monetize the bots while the actors was on holiday.\n\nBokbot remains active and shows no signs of slowing down. Fox-IT will continue to monitor\nthese actors closely.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-08-09 - Bokbot- The (re)birth of a banker.pdf"
    ],
    "report_names": [
        "2018-08-09 - Bokbot- The (re)birth of a banker.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535539,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653710292,
    "ts_modification_date": 1653710292,
    "files": {
        "pdf": "https://archive.orkl.eu/6372c22c4dea622c236a52c576feb403ba1e12d7.pdf",
        "text": "https://archive.orkl.eu/6372c22c4dea622c236a52c576feb403ba1e12d7.txt",
        "img": "https://archive.orkl.eu/6372c22c4dea622c236a52c576feb403ba1e12d7.jpg"
    }
}