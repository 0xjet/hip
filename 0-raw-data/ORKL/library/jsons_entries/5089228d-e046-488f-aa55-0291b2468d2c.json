{
    "id": "5089228d-e046-488f-aa55-0291b2468d2c",
    "created_at": "2023-06-05T02:07:00.767997Z",
    "updated_at": "2025-03-27T02:10:10.671078Z",
    "deleted_at": null,
    "sha1_hash": "40215a84fd1be4d1ccbe60f93f99fed7fc33babb",
    "title": "2023-05-09 - Threat Assessment- Royal Ransomware",
    "authors": "",
    "file_creation_date": "2023-06-04T12:40:07Z",
    "file_modification_date": "2023-06-04T12:40:07Z",
    "file_size": 1130184,
    "plain_text": "# Threat Assessment: Royal Ransomware\n\n**unit42.paloaltonetworks.com/royal-ransomware/**\n\nDoel Santos, Daniel Bunce, Anthony Galiette May 9, 2023\n\nBy [Doel Santos,](https://unit42.paloaltonetworks.com/author/doel-santos/) [Daniel Bunce and](https://unit42.paloaltonetworks.com/author/daniel-bunce/) [Anthony Galiette](https://unit42.paloaltonetworks.com/author/anthony-galiette/)\n\nMay 9, 2023 at 6:00 AM\n\n[Category: Ransomware,](https://unit42.paloaltonetworks.com/category/ransomware/) [Threat Briefs and Assessments](https://unit42.paloaltonetworks.com/category/threat-briefs-assessments/)\n\nTags: [Cortex XDR,](https://unit42.paloaltonetworks.com/tag/cortex-xdr/) [next-generation firewall,](https://unit42.paloaltonetworks.com/tag/next-generation-firewall/) [Royal Ransomware,](https://unit42.paloaltonetworks.com/tag/royal-ransomware/) [WildFire](https://unit42.paloaltonetworks.com/tag/wildfire/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/royal-ransomware/)\n\n## Executive Summary\n\nRoyal ransomware has been involved in high-profile attacks against critical infrastructure,\nespecially healthcare, since it was first observed in September 2022. Bucking the popular\ntrend of hiring affiliates to promote their threat as a service, Royal ransomware operates as a\nprivate group made up of former members of Conti.\n\nThe Unit 42 team has observed this group compromising victims through a BATLOADER\ninfection, which threat actors usually spread through search engine optimization (SEO)\npoisoning. This infection involves dropping a Cobalt Strike Beacon as a precursor to the\nransomware execution. Unit 42 incident responders have participated in 15 cases involving\nRoyal ransomware in the last 9 months\n\n\n-----\n\nRoyal ransomware also expanded their arsenal by developing an ELF variant to impact Linux\nand ESXi environments. The ELF variant is quite similar to the Windows variant, and the\nsample does not contain any obfuscation. All strings, including the RSA public key and\nransom note, are stored as plaintext.\n\nPalo Alto Networks customers receive protections against ransomware used by the Royal\nransomware group from Cortex XDR, as well as from the WildFire Cloud-Delivered Security\nService for the Next-Generation Firewall. The Unit 42 Incident Response team can also be\nengaged to help with a compromise or to provide a proactive assessment to lower your risk.\n\n**Related Unit 42 Topics** **[Ransomware,](https://unit42.paloaltonetworks.com/category/ransomware/)** **[Malware](https://unit42.paloaltonetworks.com/category/malware-2/)**\n\n## Table of Contents\n\nOverview\n\nVictimology\n\nInfection Chain\n\nDefense Evasion\n\nLateral Movement\n\nCommand and Control (C2)\n\nExfiltration\n\nRansomware Functionality\n\nWindows Variant\n\nLinux Variant\n\nConclusion\n\nProtections and Mitigations\n\nIndicators of Compromise\n\nAdditional Resources\n\n## Overview\n\nThe Royal ransomware group was first observed in September 2022, compromising victims\n[and using multi-extortion to pressure victims to pay their fee. Before their first appearance,](https://www.paloaltonetworks.com/blog/2023/03/multi-extortion-techniques/)\nthis group had been linked to a previous ransomware family named Zeon, starting in January\nof the same year.\n\nUnlike major ransomware groups like LockBit 3.0, which typically operate as a ransomwareas-a-service (RaaS) by hiring affiliates and promoting their RaaS model, we have not\nobserved this particular group using a similar approach. It is suspected that this group is\n[made up mainly of former members of the Conti ransomware group, who operate covertly](https://unit42.paloaltonetworks.com/conti-ransomware-gang/)\n[and behind closed doors. The ex-members that formed this group are known as Team One.](https://www.trendmicro.com/en_us/research/22/l/conti-team-one-splinter-group-resurfaces-as-royal-ransomware-wit.html)\n\n\n-----\n\nBecause some of the people behind this threat were part of the development of Ryuk\n(discovered in 2018), which is the predecessor of Conti, they have many years of\nexperience. This means they have a solid base for carrying out attacks and know what works\nwhen extorting victims. Perhaps due to this experience, the group has already impacted\nnumerous organizations across the globe. We’ve observed them making demands up to $25\nmillion dollars in BTC.\n\nRoyal also has frequently threatened certain critical infrastructure sectors, such as\nmanufacturing and healthcare. In a few months in 2022, the group impacted 14\nmanufacturing organizations, according to their leak site, and then followed up by publicizing\nclaims of attacking 26 additional manufacturing organizations in 2023. They have also\nimpacted eight healthcare organizations since their inception. The U.S. Department of Health\n[and Human Services issued a warning about the threat Royal ransomware poses to the](https://www.hhs.gov/sites/default/files/royal-blackcat-ransomware-tlpclear.pdf)\nhealthcare sector in January 2023.\n\nRoyal also has been one of the ransomware groups disrupting the education industry. We\nobserved that they impacted 14 organizations in the education sector, including school\ndistricts and universities. In fact, in just the first few days of May 2023, the group had already\nimpacted four educational institutions.\n\nThis group has leveraged their leak site to publicly extort victims into paying the ransom, as\nshown in Figure 1. The Royal group will harass victims until the payment is secured, using\ntechniques such as emailing victims and mass-printing ransom notes.\n\n\n-----\n\nFigure 1. Royal\n\nransomware leak site.\nThe Royal ransomware threat actor has an active Twitter account that was created in\nOctober 2022, called “LockerRoyal.” Most of the account content is announcements of\ncompromised victims, tagging the victim’s Twitter account. In some cases, the threat actor\nwill also reply to those same announcements.\n\nIt’s not unusual to see threat actor groups create social media accounts to keep spreading\ntheir brand and announcements. It’s clear that this group is trying to get attention from\nmultiple organizations through any means necessary.\n\n\n-----\n\nFigure 2. Royal Twitter account replying to an alert.\nThis particular ransomware group has been observed using multiple initial access vectors to\nsecure access into vulnerable systems, such as the following:\n\n[Callback phishing](https://www.bleepingcomputer.com/news/security/ransomware-gangs-move-to-callback-social-engineering-attacks/)\n[SEO poisoning](https://www.microsoft.com/en-us/security/blog/2022/11/17/dev-0569-finds-new-ways-to-deliver-royal-ransomware-various-payloads/)\nExposed remote desktop protocol (RDP) accounts\nCompromised credentials\n\nOnce access is secured, this group uses multiple tools to support the intrusion operation, like\nthe TCP/UDP tunnel Chisel and the Active Directory query tool AdFind, among others.\n\n### Victimology\n\nRoyal ransomware has impacted a variety of industries, including small businesses and large\ncorporations alike. Based on information from their leak site and public reporting outlets, we\ncan see that Royal ransomware has impacted industries such as manufacturing, as well as\nwholesale and retail. Since 2022, Royal ransomware has claimed responsibility for impacting\n157 organizations on their leak site.\n\nIt's important to note that the impact of Royal ransomware extends beyond just financial\nlosses. There have been instances where the group has targeted critical infrastructure, such\nas healthcare organizations and agricultural facilities. Since 2022, we have observed this\n[group impacting seven local government entities – like the recent attack on the city of Dallas](https://www.bleepingcomputer.com/news/security/city-of-dallas-hit-by-royal-ransomware-attack-impacting-it-services/?utm_campaign=wp_the_cybersecurity_202&utm_medium=email&utm_source=newsletter&wpisrc=nl_cybersecurity202)\n– in the United States and Europe.\n\nUnit 42 incident responders have participated in 15 cases involving Royal ransomware.\n\nThis demonstrates the potential for broader and more severe consequences, as shown in\nFigure 3.\n\n\n-----\n\nFigure 3. Industries distribution per Royal leak site post.\nMost of the organizations impacted by this ransomware are located in the United States,\ncomprising 64% of the impacted organizations. Canada is the country second most impacted\nby this ransomware family, making the total for North America 73.2%. The next most\nimpacted countries include Germany, the United Kingdom, Brazil, Italy and others (shown in\nFigure 4).\n\nFigure 4. Countries impacted distribution per Royal leak site post.\n\n### Infection Chain\n\n\n-----\n\nThere are several different infection chains that lead to Royal ransomware. In some cases,\nwe have observed instances where SEO poisoning and malvertising were used as initial\naccess vectors. The goal of these two methods is to trick a victim into downloading and\nexecuting a malicious file that masquerades as legitimate software.\n\nThis kicks off a complex infection chain with multiple stages, including PowerShell scripts\nand MSI files. In certain cases, this leads to infection with BATLOADER.\n\nBATLOADER will then attempt to download further payloads to the infected machine, such\nas VidarStealer, Ursnif/ISFB and Redline Stealer, as well as legitimate tooling such as the\nsystem management tool NSudo and the Syncro remote monitoring and management\n[(RMM) tool. Most importantly, BATLOADER has been seen loading Cobalt Strike, which is](https://unit42.paloaltonetworks.com/tag/cobalt-strike/)\noften a precursor to ransomware distribution.\n\nIn one particular case where we saw Royal ransomware deployed, a snippet of C# code was\nidentified that was originally pulled down from Pastebin. This code, when compiled, would\ndecrypt and load shellcode. The shellcode appeared to be a simple Meterpreter stager that\nwould reach out to an IP address and execute the final Meterpreter beacon. The IP address\nalso hosted a Cobalt Strike server, from which we were able to retrieve the Cobalt Strike\nconfiguration.\n\nThe configuration contained fairly standard values, although the watermark appeared to be\nsomewhat unique and not randomly generated: 12345. Querying for live Cobalt Strike\nservers on Shodan with the same watermark returned just over 50 results.\n\nWhile this unique watermark could indicate a cracked version of Cobalt Strike, examining the\ndomain names for these C2s revealed commonalities across the board. Almost every\ndomain was named to resemble a security company.\n\nFor example, the following servers hosted Cobalt Strike beacons with the watermark 12345:\n\naltocloudzone[.]live\ncloudmane[.]online\npalaltocloud[.]online\nkasperslkyupdate[.]com\npalalto[.]live\naltocdn[.]online\npaloaltokey[.]store\nkasperskyupdates[.]com\nRapidfinact[.]com\n\nNote that the names above are the work of a threat actor attempting to impersonate\nlegitimate organizations and do not represent actual affiliations with that organization. The\nthreat actor’s impersonation does not imply a vulnerability in the legitimate organizations’\n\n\n-----\n\nproducts or services.\n\n### Defense Evasion\n\nUnit 42 researchers observed Royal ransomware operators using PowerTool. This is a piece\nof software that has access to the kernel and is ideal for removing endpoint security\nsoftware. They also executed batch scripts to disable security-related services, and deleted\nshadow file copies and logs after successful exfiltration.\n\n### Lateral Movement\n\nUnit 42 researchers observed Royal threat actors using the network discovery software\nNetScan to identify and map out various connected computer resources such as other user\ntargets and shares. In addition to using NetScan, we also observed them using PsExec for\nconducting lateral movement within the infected environments.\n\n### Command and Control (C2)\n\nUnit 42 researchers observed threat actors using various popular legitimate remote\nmanagement software also used heavily by other ransomware operations to maintain access\nto the infected environment. The use of Cobalt Strike and related beacons were also\nobserved for C2. An interesting observation of a tool used for maintaining access was the\nuse of Chisel, a TCP/UDP tunneling tool written in Golang.\n\n### Exfiltration\n\nUnit 42 researchers observed Royal threat actors using Rclone, a legitimate tool to manage\nfiles between two systems, for exfiltrating stolen data before the deployment of ransomware.\nWe found Rclone deployed in folders such as ProgramData, or renamed and masquerading\nin other folders. One popular filename used was svchost.exe.\n\n## Ransomware Functionality\n\n### Windows Variant\n\nIt is important to note that, while many ransomware families employ various forms of antianalysis, as of late April, Royal ransomware does not employ anti-analysis tricks or string\nencryption.\n\nThere are five possible arguments for the Windows variant of Royal ransomware:\n\n**Argument** **Purpose**\n\n-path Path to be used for targeting encryption\n\n\n-----\n\n-id 32-character ID for running sample\n\n-ep Encryption percentage - indicates the percentage of each file to be\nencrypted\n\n-localonly Encrypt only the local system\n\n\nnetworkonly\n\n\nEncrypt file shares connected to system\n\n\nIn Figure 5 below, the decompiled view contains the various command-line arguments to be\nevaluated at the start of the binary being executed.\n\n\n-----\n\nFigure 5. Command-line arguments Royal accepts as inputs.\nUpon evaluating the command-line arguments provided, the ransomware then will create a\ncmd.exe process with the parameter to execute vssadmin delete shadows /all /quiet. The\ncommand is part of the standard ransomware playbook for impacting restoration services.\n\nFor the encryption process, Royal ransomware has a hard-coded RSA public key within the\nbinary and uses AES for encryption. The AES encryption is set up using a 32-byte key and a\n16-byte initialization vector (IV). The encrypted files are encrypted with the extension\n.royal_w.\n\nDuring file enumeration and encryption, the sample avoids files with the following extensions\nand filenames (also shown in Figure 6):\n\n\n-----\n\nExtensions:\n\n.exe\n.dll\n.bat\n.lnk\n.royal_w\n.royal_u\n\nFiles and folders:\n\nREADME.TXT\nWindows\nRoyal\nRecycle.bin\nGoogle\nPerflogs\nMozilla\nTor browser\nBoot\n$Windows.~ws\n$Windows.~bt\nWindows.old\n\nDuring the encryption process, if a file is encountered which is actively being used by the\ncomputer system, the ransomware can use the RestartManager API functionality to close a\nfile. As shown in Figure 6, the strings related to skipped extensions and folder paths are\nshown in the .rdata section of the binary.\n\n\n-----\n\nFigure 6. Extensions and folders excluded.\nThe ransom note dropped as a README.txt is shown in Figure 7 below.\n\n\n-----\n\nFigure 7. Royal ransomware ransom note.\nRoyal also contains functionality to encrypt network shares connected to the victim machine.\nThe decompiled view of the code path responsible for enumerating shares is shown in Figure\n8 below.\n\n\n-----\n\nFigure 8. Enumerates network shares and excludes ADMIN and IPC shares.\nFor supporting cryptographic operations used in the ransomware, the code is statically\ncompiled with OpenSSL. The cryptographic references can be seen in Figure 9 below and\n[can be cross-referenced by examining the library on GitHub.](https://github.com/openssl/openssl)\n\n\n-----\n\nFigure 9. OpenSSL library statically compiled with ransomware binary.\n\n### Linux Variant\n\n[During development of this post, a Linux variant of Royal ransomware was identified by](https://twitter.com/BushidoToken/status/1621087221905514496?s=20)\n[@BushidoToken on Feb. 1, 2023. This is the first known version not targeting Windows](https://twitter.com/BushidoToken?)\nsystems. However, considering many ransomware families have an ESXi/Linux focused\n\n\n-----\n\nvariant, this isn t unusual. It only makes sense that this group would expand their arsenal to\nimpact other environments.\n\nThere are minimal differences between the Linux and Windows variants in terms of\nencryption. AES-256 is used for symmetric encryption, while RSA-4096 is used for\nasymmetric encryption within the sample.\n\nAdditionally, there is a lack of obfuscation within the Linux sample. All strings are stored as\nplaintext, including the RSA public key and the ransom note.\n\nThere are five possible arguments for the Linux variant of Royal ransomware:\n\n**Argument** **Purpose**\n\n-id 32-character ID for running sample\n\n-ep Encryption percentage – indicates the percentage of each file that will be\nencrypted\n\n-stopv Indicates to the sample whether to stop VM-linked processes or not\n\n-fork Forks the current process for encryption\n\n-logs Informs the sample to log information to a file\n\nDuring file enumeration and encryption, the sample avoids files with the following extensions\nand filenames:\n\nExtensions:\n\n.v00\n.b00\n.sf\n.royal_u\n.royal_w\n.royal_log_\n.readme\n\nThe variant is also compiled with the OpenSSL library, resulting in a large number of\nunreferenced crypto-linked strings.\n\n\n-----\n\nFigure 10. OpenSSL strings seen within Linux ransomware binary.\n\n## Conclusion\n\nRoyal ransomware has been more active this year, using a wide variety of tools and more\naggressively targeting critical infrastructure organizations. Organizations should implement\nsecurity best practices and be wary of the ongoing threat of ransomware. This is true not\nonly for Royal ransomware but for other opportunistic criminal groups as well.\n\nThe Unit 42 team recommends that defenders have advanced logging capabilities deployed\n[and configured properly. This includes tools such as Sysmon, Windows command-line](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon)\nlogging and PowerShell logging.\n\nIdeally, you should be forwarding these logs to a security information and event management\ntool (SIEM) to create queries and detection opportunities. Keep computer systems patched\nand up to date wherever possible to reduce the attack surface related to exploitation\ntechniques.\n\nDeploy an XDR/EDR solution to perform in-memory inspection and detect process injection\ntechniques. Perform threat hunting looking for signs of unusual behavior related to security\nproduct defense evasion, service accounts for lateral movement and domain administratorrelated user behavior.\n\n## Protections and Mitigations\n\nPalo Alto Networks customers receive protections from the threats discussed above through\nthe following products.\n\n\n-----\n\nIf you think you may have been compromised or have an urgent matter, get in touch with the\n[Unit 42 Incident Response team or call:](https://start.paloaltonetworks.com/contact-unit42.html)\n\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42)\nEMEA: +31.20.299.3130\nAPAC: +65.6983.8730\nJapan: +81.50.1790.0200\n\nPalo Alto Networks has shared these findings, including file samples and indicators of\ncompromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this\nintelligence to rapidly deploy protections to their customers and to systematically disrupt\n[malicious cyber actors. Learn more about the Cyber Threat Alliance.](https://www.cyberthreatalliance.org/)\n\n## Indicators of Compromise\n\nHashes\n\n595c869f8ec7eaf71fef44bad331d81bb934c886cdff99e1f013eec7acdaf8c9 Royal\nWindows\nVariant\n\nb57e5f0c857e807a03770feb4d3aa254d2c4c8c8d9e08687796be30e2093286c Royal\nLinux\nVariant\n\nb64acb7dcc968b9a3a4909e3fddc2e116408c50079bba7678e85fee82995b0f4 Royal\nLinux\nVariant\n\nb64acb7dcc968b9a3a4909e3fddc2e116408c50079bba7678e85fee82995b0f4 Royal\nLinux\nVariant\n\n12a6d61b309171b41347d6795002247c8e2137522a756d35bb8ece5a82fc3774 Royal\nLinux\nVariant\n\nInfrastructure\n\nroyal2xthig3ou5hd7zsliqagy6yygk2cdelaxtni2fyad6dpmpxedid[.]onion\n\n## Additional Resources\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\n\n-----\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-05-09 - Threat Assessment- Royal Ransomware.pdf"
    ],
    "report_names": [
        "2023-05-09 - Threat Assessment- Royal Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cf4d333d-ef79-40aa-b233-886e6de875a3",
            "created_at": "2023-12-08T02:00:05.754609Z",
            "updated_at": "2025-03-27T02:00:03.266797Z",
            "deleted_at": null,
            "main_name": "DEV-0569",
            "aliases": [
                "Storm-0569"
            ],
            "source_name": "MISPGALAXY:DEV-0569",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1685930820,
    "ts_updated_at": 1743041410,
    "ts_creation_date": 1685882407,
    "ts_modification_date": 1685882407,
    "files": {
        "pdf": "https://archive.orkl.eu/40215a84fd1be4d1ccbe60f93f99fed7fc33babb.pdf",
        "text": "https://archive.orkl.eu/40215a84fd1be4d1ccbe60f93f99fed7fc33babb.txt",
        "img": "https://archive.orkl.eu/40215a84fd1be4d1ccbe60f93f99fed7fc33babb.jpg"
    }
}