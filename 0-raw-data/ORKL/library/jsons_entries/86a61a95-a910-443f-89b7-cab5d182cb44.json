{
    "id": "86a61a95-a910-443f-89b7-cab5d182cb44",
    "created_at": "2023-01-12T15:07:32.953033Z",
    "updated_at": "2025-03-27T02:15:46.070667Z",
    "deleted_at": null,
    "sha1_hash": "241567ef8d07d5344fabf594e4d95c6066062188",
    "title": "2022-02-23 - NSA-linked Bvp47 Linux backdoor widely undetected for 10 years",
    "authors": "",
    "file_creation_date": "2022-05-28T03:10:20Z",
    "file_modification_date": "2022-05-28T03:10:20Z",
    "file_size": 698072,
    "plain_text": "# NSA-linked Bvp47 Linux backdoor widely undetected for 10 years\n\n**[bleepingcomputer.com/news/security/nsa-linked-bvp47-linux-backdoor-widely-undetected-for-10-years/](https://www.bleepingcomputer.com/news/security/nsa-linked-bvp47-linux-backdoor-widely-undetected-for-10-years/)**\n\nIonut Ilascu\n\nBy\n[Ionut Ilascu](https://www.bleepingcomputer.com/author/ionut-ilascu/)\n\nFebruary 23, 2022\n07:21 PM\n5\n\nA report released today dives deep into technical aspects of a Linux backdoor now tracked\nas Bvp47 that is linked to the Equation Group, the advanced persistent threat actor tied to\nthe U.S. National Security Agency.\n\nBvp47 survived until today almost undetected, despite being submitted to the Virus Total\nantivirus database for the first time close to a decade ago, in late 2013.\n\nUntil this morning, only one antivirus engine on Virus Total detected the Bvp47 sample. As\nthe report spread in the infosec community, detection started to improve, being flagged by\nsix engines at the moment of writing.\n\n\n-----\n\nsource: BleepingComputer\n\n## The Equation Group connection\n\nThe Advanced Cyber Security Research team at Pangu Lab, a Chinese cybersecurity\ncompany, says that it found the elusive malware in 2013, during a “forensic investigation of\na host in a key domestic department.”\n\nThe Bvp47 sample obtained from the forensic investigation proved to be an advanced\nbackdoor for Linux with a remote control function protected through the RSA asymmetric\ncryptography algorithm, which requires a private key to enable.\n\n[They found the private key in the leaks published by the Shadow Brokers hacker group](https://en.wikipedia.org/wiki/The_Shadow_Brokers#cite_note-3)\nbetween 2016-2017, which contained hacking tools and zero-day exploits used by NSA’s\ncyberattack team, the Equation Group.\n\n[Some components in the Shadow Brokers leaks were integrated into the Bvp47 framework](https://github.com/x0rz/EQGRP)\n\n- “dewdrop” and “solutionchar_agents” - indicating that the implant covered Unix-based\noperating systems like mainstream Linux distributions, Juniper’s JunOS, FreeBSD, and\nSolaris.\n\nApart from Pangu Lab attributing the Bvp47 malware to the Equation Group, automated\nanalysis of the backdoor also shows similarities with another sample from the same actor.\n\n\n-----\n\nKaspersky s Threat Attribution Engine (KTAE) shows that 34 out of 483 strings match those\nfrom another Equation-related sample for Solaris SPARC systems, which had a 30%\nsimilarity with yet [another Equation malware submitted to Virus Total in 2018 and posted by](https://twitter.com/deresz666/status/1485626389407703044)\nthreat intel researcher Deresz on January 24, 2022.\n\nsource: Kaspersky\nCostin Raiu, director of Global Research and Analysis Team at [Kaspersky, told](https://twitter.com/kaspersky)\nBleepingComputer that Bvp47’s code-level similarities match a single sample in the\ncompany’s current malware collection.\n\nThis indicates that the malware was not used extensively, as it usually happens with\nhacking tools from high-level threat actors, who use them in highly targeted attacks.\n\nIn the case of the Bvp47 Linux backdoor, Pangu Lab researchers say that it was used on\ntargets in the telecom, military, higher-education, economic, and science sectors.\n\nThey note that the malware hit more than 287 organizations in 45 countries and went\nlargely undetected for over 10 years.\n\nsource: Pangu Lab\n\n\n-----\n\n## Attack stages\n\nPangu Lab’s incident analysis involved three servers, one being the target of an external\nattack and two other internal machines - an email server and a business server.\n\nsource: Pangu Lab\nAccording to the researchers, the threat actor pivoted established a connection between the\nexternal server and the email server via a TCP SYN packet with a 264-byte payload.\n\n“At almost the same time, the [email] server connects to the [business] server's SMB\nservice and performs some sensitive operations, including logging in to the [business]\nserver with an administrator account, trying to open terminal services, enumerating\n[directories, and executing Powershell scripts through scheduled tasks” - Pangu Lab](https://www.pangulab.cn/en/post/the_bvp47_a_top-tier_backdoor_of_us_nsa_equation_group/)\n\nThe business server then connected to the email machine to download additional files,\n“including the Powershell script and the encrypted data of the second stage.”\n\nAn HTTP server is started on one of the two compromised machines, serving two HTML\nfiles to the other. One of the files was a base64-encoded PowerShell script that downloads\n“index.htm,” which contains asymmetrically encrypted data.\n\nA connection between the two internal machines is used to communicate encrypted data\nvia “its own protocol ” Pangu Lab researchers say in their report\n\n\n-----\n\nThe researchers were able to restore the communication between the servers and\nsummarized it into the following steps, where machine A is the external system and V1/V2\nare the email and business server, respectively:\n\n1. Machine A connects to port 80 of the V1 server to send a knock request and start the\n\nbackdoor program on the V1 server\n2. The V1 server reversely connects the high-end port of machine A to establish a data\n\npipeline\n3. The V2 server connects to the backdoor web service opened on the V1 server, and\n\nobtains PowerShell execution from the V1 server\n4. The V1 server connects to the SMB service port of the V2 server to perform command\n\noperations\n5. The V2 server establishes a connection with the V1 server on the high-end port and\n\nuses its own encryption protocol for data exchange\n6. The V1 server synchronizes data interaction with the A machine, and the V1 server\n\nacts as a data transfer between the A machine and the V2 server\n\nReferring to the above communication technology between the three servers, the\nresearchers assess that the backdoor is the creation of “an organization with strong\ntechnical capabilities.”\n\n## Related Articles:\n\n[BPFDoor malware uses Solaris vulnerability to get root privileges](https://www.bleepingcomputer.com/news/security/bpfdoor-malware-uses-solaris-vulnerability-to-get-root-privileges/)\n\n[BPFDoor: Stealthy Linux malware bypasses firewalls for remote access](https://www.bleepingcomputer.com/news/security/bpfdoor-stealthy-linux-malware-bypasses-firewalls-for-remote-access/)\n\n[Malicious PyPI package opens backdoors on Windows, Linux, and Macs](https://www.bleepingcomputer.com/news/security/malicious-pypi-package-opens-backdoors-on-windows-linux-and-macs/)\n\n[New ‘Cheers’ Linux ransomware targets VMware ESXi servers](https://www.bleepingcomputer.com/news/security/new-cheers-linux-ransomware-targets-vmware-esxi-servers/)\n\n[Gain foundational skills in Linux and IT with this course bundle deal](https://www.bleepingcomputer.com/offer/deals/gain-foundational-skills-in-linux-and-it-with-this-course-bundle-deal/)\n\n[Backdoor](https://www.bleepingcomputer.com/tag/backdoor/)\n[Equation Group](https://www.bleepingcomputer.com/tag/equation-group/)\n[Linux](https://www.bleepingcomputer.com/tag/linux/)\n[NSA](https://www.bleepingcomputer.com/tag/nsa/)\n\n[Ionut Ilascu](https://www.bleepingcomputer.com/author/ionut-ilascu/)\n\nIonut Ilascu is a technology writer with a focus on all things cybersecurity. The topics he\nwrites about include malware, vulnerabilities, exploits and security defenses, as well as\nresearch and innovation in information security. His work has been published by\nBitdefender, Netgear, The Security Ledger and Softpedia.\n\n[Previous Article](https://www.bleepingcomputer.com/news/security/network-hackers-focus-on-selling-high-value-targets-in-the-us/)\n[Next Article](https://www.bleepingcomputer.com/offer/deals/these-10-deals-help-you-gear-up-for-the-tax-season/)\n\n\n-----\n\n## Comments\n\n[blitz120 - 3 months ago](https://www.bleepingcomputer.com/forums/u/1239917/blitz120/)\n\nA great followup would be an investigation of WHY the backdoor was not addressed\nfor so long. Did the NSA strong arm malware detection companies and researchers?\nIf that turns out to be the case, then extreme pressure needs to be put on the US\ngovernment to expose and expel those who did so from any government work going\nforward, including consultation.\n\n\n-----\n\n[h_b_s - 3 months ago](https://www.bleepingcomputer.com/forums/u/1211617/h-b-s/)\n\n\"A great followup would be an investigation of WHY the backdoor was not addressed\nfor so long. Did the NSA strong arm malware detection companies and researchers?\nIf that turns out to be the case, then extreme pressure needs to be put on the US\ngovernment to expose and expel those who did so from any government work going\nforward, including consultation.\"\n\nProbably because nearly all anti-malware vendors concentrate on Windows malware\nand Linux malware is not their concern. Very few even have Linux native products,\nand those that have are concentrated on preventing malware from getting through to\nWindows clients (and Windows servers which lack some of Unix's robust security\ntools) rather than scanning the system area on Linux servers.\n\nA highly alert Linux admin shouldn't need a separate proprietary malware scanner for\nLinux servers because they're schooled in how to manage Unix security. There are\nbuilt in tools to alert to unknown file alterations along with monitoring for abnormal\nnetwork traffic (tripwire, throw-away VMs, aggregate & deep packet network analysis,\nclamscan, account security, etc). Obviously, not everyone managing Linux servers is\nthat educated or they may be hamstrung by budgets, or both. If that's the case, no\nmalware scanner is going to help, because they won't buy it anyway because they're\nalso ignorant of the tools already available for free.\n\nNot that I'm going to convince the tin hat brigade, but no, there's no government\nconspiracy here. Just the market at work. There's no market for *Linux* malware\nscanners either for the server or desktop. The only real market for malware scanners\nis to protect client endpoints which are nearly always Windows. Linux native malware\nwill nearly always drop through the cracks except perhaps for the ClamAV team which\nis FOSS.\n\n\n-----\n\n[lonegull - 3 months ago](https://www.bleepingcomputer.com/forums/u/1122141/lonegull/)\n\nBurn Linux, burn!!\n\n[bbbaldie - 3 months ago](https://www.bleepingcomputer.com/forums/u/1240086/bbbaldie/)\n\nWell aren't you special. I hereby sentence you to a world without Linux. Good luck.\n\n[nintendo1889 - 3 months ago](https://www.bleepingcomputer.com/forums/u/279344/nintendo1889/)\n\nlink is fuxored\ntry [https://archive.is/tDcNQ](https://archive.is/tDcNQ)\n\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n## You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-23 - NSA-linked Bvp47 Linux backdoor widely undetected for 10 years.pdf"
    ],
    "report_names": [
        "2022-02-23 - NSA-linked Bvp47 Linux backdoor widely undetected for 10 years.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4f7cf97-9c98-409c-8b95-b80d14c576a5",
            "created_at": "2022-10-25T16:07:24.561104Z",
            "updated_at": "2025-03-27T02:02:10.281202Z",
            "deleted_at": null,
            "main_name": "Shadow Brokers",
            "aliases": [],
            "source_name": "ETDA:Shadow Brokers",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "08623296-52be-4977-8622-50efda44e9cc",
            "created_at": "2023-01-06T13:46:38.549387Z",
            "updated_at": "2025-03-27T02:00:02.859535Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "Tilded Team",
                "EQGRP",
                "G0020"
            ],
            "source_name": "MISPGALAXY:Equation Group",
            "tools": [
                "EquationLaser",
                "EquationDrug",
                "DoubleFantasy",
                "TripleFantasy",
                "GrayFish"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "171b85f2-8f6f-46c0-92e0-c591f61ea167",
            "created_at": "2023-01-06T13:46:38.830188Z",
            "updated_at": "2025-03-27T02:00:02.929729Z",
            "deleted_at": null,
            "main_name": "The Shadow Brokers",
            "aliases": [
                "Shadow Brokers",
                "ShadowBrokers",
                "The ShadowBrokers",
                "TSB"
            ],
            "source_name": "MISPGALAXY:The Shadow Brokers",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2d9fbbd7-e4c3-40e5-b751-27af27c8610b",
            "created_at": "2024-05-01T02:03:08.144214Z",
            "updated_at": "2025-03-27T02:05:17.419705Z",
            "deleted_at": null,
            "main_name": "PLATINUM COLONY",
            "aliases": [
                "Equation Group "
            ],
            "source_name": "Secureworks:PLATINUM COLONY",
            "tools": [
                " EquationDrug",
                " EquationLaser",
                " Fanny",
                " GrayFish",
                " TripleFantasy",
                "DoubleFantasy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e0fed6e6-a593-4041-80ef-694261825937",
            "created_at": "2022-10-25T16:07:23.593572Z",
            "updated_at": "2025-03-27T02:02:09.879892Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "APT-C-40",
                "Platinum Colony",
                "Tilded Team"
            ],
            "source_name": "ETDA:Equation Group",
            "tools": [
                "Bvp47",
                "DEMENTIAWHEEL",
                "DOUBLEFANTASY",
                "DanderSpritz",
                "DarkPulsar",
                "DoubleFantasy",
                "DoubleFeature",
                "DoublePulsar",
                "Duqu",
                "EQUATIONDRUG",
                "EQUATIONLASER",
                "EQUESTRE",
                "Flamer",
                "GRAYFISH",
                "GROK",
                "OddJob",
                "Plexor",
                "Prax",
                "Regin",
                "Skywiper",
                "TRIPLEFANTASY",
                "Tilded",
                "UNITEDRAKE",
                "WarriorPride",
                "sKyWIper"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536052,
    "ts_updated_at": 1743041746,
    "ts_creation_date": 1653707420,
    "ts_modification_date": 1653707420,
    "files": {
        "pdf": "https://archive.orkl.eu/241567ef8d07d5344fabf594e4d95c6066062188.pdf",
        "text": "https://archive.orkl.eu/241567ef8d07d5344fabf594e4d95c6066062188.txt",
        "img": "https://archive.orkl.eu/241567ef8d07d5344fabf594e4d95c6066062188.jpg"
    }
}