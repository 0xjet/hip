{
    "id": "65ac9ac2-4095-49e1-804a-ead4d930361b",
    "created_at": "2022-10-25T16:48:16.775362Z",
    "updated_at": "2025-03-27T02:16:49.082916Z",
    "deleted_at": null,
    "sha1_hash": "02b643715ddf9a0b2e11a5cb49cdf2c9fa8d28b4",
    "title": "",
    "authors": "",
    "file_creation_date": "2015-05-14T14:45:25Z",
    "file_modification_date": "2015-05-14T14:45:29Z",
    "file_size": 4125963,
    "plain_text": "R E P O R T\n\nF I R E E Y E L A B S / F I R E E Y E T H R E A T I N T E L L I G E N C E\n### HIDING IN PLAIN SIGHT:\n\n###### FIREEYE AND MICROSOFT EXPOSE\n OBFUSCATION TACTIC\n\n# SECURITY\n\n\n-----\n\n###### Using Microsoft TechNet, a web portal for IT professionals, APT17 posted in forum threads and created profile pages to host encoded CnC IP addresses that would direct a variant of the BLACKCOFFEE backdoor to their CnC server.\n\n\nireEye Threat Intelligence and the Microsoft\nThreat Intelligence Center investigated a\ncommand-and-control (CnC) obfuscation\n\n## F\n\ntactic used on Microsoft’s TechNet, a web portal for\nIT professionals. TechNet’s security was in no way\ncompromised by this tactic, which is likely possible\non other message boards and forums.\n\nFireEye Threat Intelligence assesses that APT17,\na China-based threat group, was behind the\nattempt. Other groups have used legitimate\nwebsites to host CnC IP address in the past.\nAPT17 was embedding the encoded CnC IP\naddress for the BLACKCOFFEE malware in\nlegitimate Microsoft TechNet profiles pages and\nforum threads, a method some in the information\nsecurity community call a “dead drop resolver.”\nEncoding the IP address makes it more difficult\nto identify the true CnC address for network\nsecurity professionals.\n\nFew security companies have publicly discussed\nthis tactic. After discovering the BLACKCOFFEE\nactivity, the FireEye-Microsoft team encoded\na sinkhole IP address into the profile pages and\nforum threads and locked the accounts to prevent\nthe threat actors from making any changes. This\ncollaborative approach allowed the team to\nobserve the malware and its victims. Though the\nsecurity community has not yet broadly discussed\nthis technique, FireEye has observed other threat\ngroups adopting these measures and expect\nthis trend to continue on other community sites.\nToday, FireEye released Indicators of Compromise\n(IOCs) for BLACKCOFFEE and Microsoft released\nsignatures for its anti-malware products.\n\n\n###### FIREEYE HAS OBSERVED THE CHINA- BASED APT17 DISGUISING THEIR TRAFFIC\n[APT17, also known as DeputyDog, is a China-](https://www.fireeye.com/blog/threat-research/2013/09/operation-deputydog-zero-day-cve-2013-3893-attack-against-japanese-targets.html)\nbased threat group that FireEye Intelligence has\nobserved conducting network intrusions against\nU.S. government entities, the defense industry, law\nfirms, information technology companies, mining\ncompanies, and non-government organizations.\nBLACKCOFFEE’s functionality includes uploading\nand downloading files; creating a reverse shell;\nenumerating files and processes; renaming, moving,\nand deleting files; terminating processes; and\nexpanding its functionality by adding new backdoor\ncommands. FireEye has monitored APT17’s use of\nBLACKCOFFEE variants since 2013 to masquerade\nmalicious communication as normal web traffic by\ndisguising the CnC communication as queries to\nweb search engines.\n\n###### THREAT ACTORS’ CnC: FROM OBVIOUSLY MALICIOUS TO THOUGHTFULLY OBFUSCATED\nThe use of BLACKCOFFEE demonstrates threat\nactors’ evolving use of public websites to hide\nin plain sight. In the past, threat actors would\nmodify easily compromised websites to host CnC\ncommands and configuration, as observed in the\nChina-based APT1’s WEBCnC suite of backdoors.\nNow, threat actors are using well-known\n\n\nwebsites—that they do not need to compromise—\nto host CnC IP addresses. They simply use the\nwebsite for legitimate purposes, such as posting\nforum threads or creating profile pages.\n\nAPT17 went further to obfuscate their CnC IP\naddress and employed a multi-layered approach\nfor the malware to finally beacon the true CnC\nIP. They used legitimate infrastructure—the\nability to post or create comments on forums and\nprofile pages—to embed a string that the malware\nwould decode to find and communicate with the\ntrue CnC IP address. This additional obfuscation\nputs yet another layer between APT17 and the\nsecurity professionals attempting to chase them\ndown.\n\n###### HOW BLACKCOFFEE WORKS\nThis BLACKCOFFEE variant contains one or\nmore URLs that link to the biography sections of\nattacker-created profiles as well as forum threads\nthat contain comments from those same profiles.\nA URL is randomly selected and the malware\nsearches at that location for an encoded IP\naddress located between two tags, “@MICR0S0FT”\nand “C0RP0RATI0N”.\n\n\n-----\n\n#### APT17’s Malicious Use of Technet\n\n###### APT17 encodes an IP address A TechNet forum thread modified by BLACKCOFFEE: on a newly created TechNet profile or encodes the IP address on a forum thread using one of their profiles\n\nThe malware then communicates directly with the retrieved and decoded\nIP address to receive commands and send stolen information. If the CnC\nserver is discovered or shut down, the threat actors can update the encoded\nIP address on TechNet to maintain control of the victims’ machines.\nBLACKCOFFEE supports an initial set of fifteen commands, including\ncreating a reverse shell, uploading and downloading files, and enumerating\nfiles and processes. The attackers can also extend BLACKCOFFEE’s\nfunctionality through additional commands sent as shellcode.\n\n###### IOCS/MD5S\n[Indicators of compromise are available on Github at github.com/fireeye/iocs.](https://github.com/fireeye/iocs)\n\n|Col1|Col2|BLACKCOFFEE checks the altered TechNet page for encoded tag|\n|---|---|---|\n||A TechNet forum thread modified by BLACKCOFFEE:|TechNet page for encoded tag containing address of CnC server Encoded command and control server IP is sent back to BLACKCOFFEE on the victim’s computer 10100101001010100101001 01010101001010010101001 10100101001010100101001 10100101001010100101001 01010101001010010101001 10100101001010100101001 10100101001010100101001 01010101001010010101001 The victim’s network 10100101001010100101001 security monitors see traffic from TechNet|\n||||\n\n\n###### EXPECT MORE THREAT GROUPS TO EMPLOY LEGITIMATE WEBSITES IN OPERATIONS\nWe have already observed threat actors adopting similar techniques and\nmoving some CnC activity to legitimate websites that they do not need to\ncompromise. In the same vein, some threat actors have already begun using\n[social media sites such as Twitter and Facebook for malware distribution and](http://www.wired.com/2009/08/botnet-tweets/)\nCnC. APT17’s tactic—using a dead drop resolver and embedding encoded\nIP addresses as opposed to displaying it in plain text—can delay detection,\ndiscourage IT staff from discovering the actual CnC IP address, and prevent\ndiscovery of the CnC IP via binary analysis. FireEye expects that threat groups\nare already using this technique, with their own unique variations, and others\nwill adopt similar measures to hide in plain sight.\n\n```\n    101001010010101001010010\n    010101010010100101010010\n    101001010010101001010010\n    101001010010101001010010\n    010101010010100101010010\n    101001010010101001010010\n    101001010010101001010010\n    010101010010100101010010\n\n###### The victim’s network security monitors see\n    101001010010101001010010 traffic from TechNet\n\n```\n\n###### Actual Command and Control traffic is sent\n to the decoded CnC IP\n\n\n-----\n\n###### To download this or other\n\n FireEye Threat Intelligence reports,\n\n visit: https://www.fireeye.com/reports.html\n\n\n[FireEye, Inc. | 1440 McCarthy Blvd. Milpitas, CA 95035 | 408.321.6300 | 877.FIREEYE (347.3393) | info@fireeye.com | www.fireeye.com](mailto:info%40FireEye.com)\n\n© 2015 FireEye, Inc. All rights reserved. FireEye is a registered trademark of\nFireEye, Inc. All other brands, products, or service names are or may be trademarks\nor service marks of their respective owners. WP.HPS.EN-US.052015\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www2.fireeye.com/rs/fireye/images/APT17_Report.pdf"
    ],
    "report_names": [
        "APT17_Report.pdf"
    ],
    "threat_actors": [
        {
            "id": "2150d1ac-edf0-46d4-a78a-a8899e45b2b5",
            "created_at": "2022-10-25T15:50:23.269339Z",
            "updated_at": "2025-03-27T02:00:55.416524Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "APT17",
                "Deputy Dog"
            ],
            "source_name": "MITRE:APT17",
            "tools": [
                "BLACKCOFFEE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "dabb6779-f72e-40ca-90b7-1810ef08654d",
            "created_at": "2022-10-25T15:50:23.463113Z",
            "updated_at": "2025-03-27T02:00:55.47619Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "APT1",
                "Comment Crew",
                "Comment Group",
                "Comment Panda"
            ],
            "source_name": "MITRE:APT1",
            "tools": [
                "Seasalt",
                "ipconfig",
                "Cachedump",
                "PsExec",
                "GLOOXMAIL",
                "Lslsass",
                "PoisonIvy",
                "WEBC2",
                "Mimikatz",
                "gsecdump",
                "Pass-The-Hash Toolkit",
                "Tasklist",
                "xCmd",
                "pwdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1edcac0b-efd9-47b1-9aca-33827d5bd085",
            "created_at": "2024-05-01T02:03:07.964773Z",
            "updated_at": "2025-03-27T02:05:17.273595Z",
            "deleted_at": null,
            "main_name": "BRONZE KEYSTONE",
            "aliases": [
                "Aurora Panda ",
                "DeputyDog ",
                "Group 72 ",
                "Hidden Lynx ",
                "Shell Crew",
                "TG-8153 ",
                "Tailgater Team",
                "APT17 "
            ],
            "source_name": "Secureworks:BRONZE KEYSTONE",
            "tools": [
                " BlackCoffee",
                " DeputyDog",
                " Derusbi",
                " Gh0stHTTPSDropper",
                " HiKit",
                " InternalCMD",
                " PlugX",
                " PoisonIvy",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "86fd71d3-06dc-4b73-b038-cedea7b83bac",
            "created_at": "2022-10-25T16:07:23.330793Z",
            "updated_at": "2025-03-27T02:02:09.740703Z",
            "deleted_at": null,
            "main_name": "APT 17",
            "aliases": [
                "APT 17",
                "ATK 2",
                "Beijing Group",
                "Bronze Keystone",
                "Deputy Dog",
                "Elderwood",
                "Elderwood Gang",
                "Operation Aurora",
                "Operation DeputyDog",
                "Operation Ephemeral Hydra",
                "Operation RAT Cook",
                "SIG22",
                "Sneaky Panda",
                "TEMP.Avengers",
                "TG-8153",
                "Tailgater Team"
            ],
            "source_name": "ETDA:APT 17",
            "tools": [
                "9002 RAT",
                "AGENT.ABQMR",
                "AGENT.AQUP.DROPPER",
                "AGENT.BMZA",
                "AGENT.GUNZ",
                "Agent.dhwf",
                "AngryRebel",
                "BlackCoffee",
                "Briba",
                "Chymine",
                "Comfoo",
                "Comfoo RAT",
                "Darkmoon",
                "DeputyDog",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Fexel",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Gresim",
                "HOMEUNIX",
                "HiKit",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Jumpall",
                "Kaba",
                "Korplug",
                "Linfo",
                "MCRAT.A",
                "McRAT",
                "MdmBot",
                "Mdmbot.E",
                "Moudour",
                "Mydoor",
                "Naid",
                "Nerex",
                "PCRat",
                "PNGRAT",
                "Pasam",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trojan.Naid",
                "Vasport",
                "Wiarp",
                "Xamtrav",
                "Zox",
                "ZoxPNG",
                "ZoxRPC",
                "gresim",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041809,
    "ts_creation_date": 1431614725,
    "ts_modification_date": 1431614729,
    "files": {
        "pdf": "https://archive.orkl.eu/02b643715ddf9a0b2e11a5cb49cdf2c9fa8d28b4.pdf",
        "text": "https://archive.orkl.eu/02b643715ddf9a0b2e11a5cb49cdf2c9fa8d28b4.txt",
        "img": "https://archive.orkl.eu/02b643715ddf9a0b2e11a5cb49cdf2c9fa8d28b4.jpg"
    }
}