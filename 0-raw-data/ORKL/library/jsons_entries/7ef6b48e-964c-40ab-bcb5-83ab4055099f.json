{
    "id": "7ef6b48e-964c-40ab-bcb5-83ab4055099f",
    "created_at": "2023-01-12T15:05:58.79044Z",
    "updated_at": "2025-03-27T02:05:30.202209Z",
    "deleted_at": null,
    "sha1_hash": "3a61780d37dcb38387ca77a14b76ab10aa5f3d6e",
    "title": "2020-04-14 - Understanding the relationship between Emotet Ryuk and TrickBot",
    "authors": "",
    "file_creation_date": "2022-05-25T12:09:31Z",
    "file_modification_date": "2022-05-25T12:09:31Z",
    "file_size": 85704,
    "plain_text": "# Understanding the relationship between Emotet, Ryuk and TrickBot\n\n**[intel471.com/blog/understanding-the-relationship-between-emotet-ryuk-and-trickbot](https://intel471.com/blog/understanding-the-relationship-between-emotet-ryuk-and-trickbot/)**\n\nBy the Intel 471 Malware Intelligence team. One of the more notable relationships in the\nworld of cybercrime is that between Emotet, Ryuk and TrickBot. This loader-ransomwarebanker trifecta has wreaked havoc in the business world over the past two years, causing\nmillions of dollars in damages and ransoms paid. Our Malware Intelligence team receives a\nlot of great questions from our clients on this subject, so we thought it would be good to do a\nQ/A style blog covering some of the more general questions.\n\nMost perspectives on Ryuk come from a threat-hunting or incident-response point of view. In\ncontrast, Intel 471's perspective is based on detailed knowledge of the malware itself and how\n[it's being used. Our Malware Intelligence offering provides our clients with near real-time](https://www.intel471.com/products/malware-intelligence/)\nvisibility into malware activity at the controller level. This activity includes infrastructure\nupdates, new module/plugin downloads, targets being added to injects or configs, and many\nother data points.\n\n**Q: Are TrickBot campaigns operated by a single group?**\n\nA: TrickBot likely is operated by a single group as a malware-as-a-service (MaaS) platform\nthat caters to a relatively small number of top-tier cybercriminals. Available information\nleads us to believe that individual TrickBot campaigns can be attributed to these different\ncustomers using the Group Tag (Gtag) parameter, and each customer may bring their own\ntactics, techniques and procedures (TTPs) and engage in highly targeted attacks.\n\n**Q: If multiple actors or groups are leveraging TrickBot, how is it possible to**\n**track the respective campaigns?**\n\nA: One technique is to focus on the Gtag parameter and map it to associated delivery\nmethods. The Gtag value is hardcoded into each TrickBot sample and is thought to be a\ncampaign identifier. For example, a Gtag could be “fred372,” where “fred” is the group ID\nand the numerical value is thought to be a specific campaign or wave that can be linked to a\nmethod of delivery.\n\n**Q: How many different Gtag values are out there and why are they significant?**\n\nA: It’s difficult to say exactly how many unique Gtag values there are, but we can offer some\nobservations based on about 18 months of technical tracking and 37,000 unique TrickBot\nsamples. We’ve seen about 1,000 unique Gtag values, but if we focus on just the group ID,\nthere are only 59 unique values. The majority of samples in our data set — more than 92% —\ncan be attributed to just a handful of group IDs — jim, lib, ono, sat and tot.\n\n\n-----\n\nFurthermore, we can link the individual group IDs to specific spreading methods as\npreviously mentioned. For example, It’s suspected that jimXX, libXX and totXX are\nprimarily delivered by malspam. We know that every morXX-related sample we observed\nwas delivered via Emotet. All samples attributed to sinXX, tinXX and winXX were\ndelivered via Bokbot aka IcedID. Samples attributed to wmdXX seem to utilize several\ndifferent loaders, such as Amadey, FastLoader and an unnamed loader. Lastly, satXX,\n**summ1 and trg1 all utilized the Ostap JavaScript loader for delivery.**\n\nAside from the tracking perspective, Gtags also are significant from an incident response\npoint of view. For example, if TrickBot samples are found in workstations and analysis shows\nthem to be from morXX campaigns, getting rid of the TrickBot infection will not ensure the\ncleaning of the network, as there likely also will be Emotet binaries there.\n\n**Q: Are the Ryuk outbreaks connected with any specific Gtag?**\n\nA: Given the targeted and manual nature of Ryuk delivery, it’s difficult to gain sufficient\nvisibility into the samples to link them to specific Trickbot Gtags and Ryuk ransomware.\nHowever, from privately shared information, it appears that some Gtags are linked to the\npost-exploitation and deployment of Ryuk ransomware. The Gtag most often associated with\nRyuk is said to be morXX. However, while the \"mor\" Group ID only surfaced in September\n2019, the Trickbot to Ryuk connection has been observed since at least January 2019, and\nreportedly has been seen via other Gtags since then. One of those Gtags is onoXX which\nreportedly was linked to Ryuk attacks by several organizations in public information reports.\n\n**Q: Is there other specific behavior spotted with the morXX Gtag which has not**\n**been observed for other Gtag values?**\n\nA: Emotet malware typically is used as a loader for TrickBot campaigns, however, our\nmonitoring registered 3 controller events — Feb. 7, 2020, April 1, 2020 and April 11 — where\nthe roles were reversed and TrickBot Gtag morXX was used to download Emotet. Since\nAugust 2018 and across millions of controller events, we’ve not observed this behavior\noutside of these two examples. It suggests the actors behind morXX may have direct access\nto or some relationship with Emotet, however, the level and extent is unknown.\n\n**Q: It seems that in most of the Ryuk outbreaks, Emotet and TrickBot also were**\n**in the network. How does the chain work?**\n\nA: While it is true that many of the Ryuk incidents we’ve been privy to have involved both\nEmotet and TrickBot, it’s important to specify where in the chain Ryuk enters. Emotet often\nis the precursor to TrickBot being loaded onto the system. TrickBot then uses several\nmodules to carry out various activities on the victim system, allow for lateral movement and\nallow utilities such as BloodHound, Cobalt Strike and/or Empire to be loaded manually by\nthe operators. The deployment of Cobalt Strike does not appear to be automated, but instead\n\n\n-----\n\nis initiated on specific bots that match a profile. Once post-exploitation tools are loaded, the\ndomain controller (DC) is attacked. When privileged access to the DC is acquired, Ryuk can\nbe deployed across the network at the botnet operator’s will.\n\n**Q: What is the best way to protect from Ryuk?**\n\nA: The first order of business for any organization is to have good security hygiene, including\nbut not limited to ongoing security monitoring, a detection strategy, and response and\nrecovery. There are at least two opportunities to stop both Emotet and TrickBot before a\nRyuk outbreak occurs. The first is to stop Emotet from downloading TrickBot. The second is\nto stop TrickBot from spreading across the network, or at least stop it from communicating\nback to its command and control servers.\n\nOnce TrickBot has identified a domain controller on the network, the network defender is\nracing against the clock. If the infected machine is on a small-to-medium-sized business\nnetwork, there is a very good chance threat actors will attack the domain controller and\ndeploy Ryuk. Unfortunately, defensive measures such as anti-virus agents are unlikely to stop\nRyuk, since the attacker can easily disable them (i.e., via a group policy object (GPO)).\n\n**Q: So, based on the capabilities of TrickBot mentioned above, is it still accurate**\n**to call it a banking trojan?**\n\nWhile TrickBot essentially is a banking trojan, the ability to extend its features by adding\nadditional modules distinctly enhanced opportunities for groups running malware\noperations. Over the years we’ve seen TrickBot evolve from being a banker to an “all of the\nabove” malware using case-specific modules.\n\nBefore the widespread use of ransomware, the actors behind Trickbot were engaged in\nfraudulent money transfer operations. The objective was to mass-infect as many computers\nas possible and look for high-value targets — individuals with high-balance bank accounts or\nsmall businesses. Using the banking trojan and web-injects, the botnet operators could make\nmoney transfers to money-mule accounts and then proceed to cash out. There are two\nproblems with this operation:\n\n1. Banks are getting better at detecting fraudulent transactions and eliminating money\n\nmule accounts.\n2. These operations are high maintenance and very costly to operate because of the need\n\nto manage money mules, update web-injects, and maintain both the botnet\ninfrastructure and the constant supply of new bots from new campaigns. While many of\nthese things can be outsourced, each “partner” comes with added cost and risk.\n\nWith ransomware, the goals of the adversary remain the same, but the path to clean,\nlaundered money is much shorter. Instead of dealing with money mules and bypassing access\nrestrictions on banking accounts, the adversary convinces the victim to pay them directly in\n\n\n-----\n\nbitcoins. Attackers no longer need to understand the intricacies of financial systems, since\nthere now is a single blueprint that fits many targets: Find the domain controller and you\nhave the keys to a network.\n\n**Q. What is the outlook for ransomware?**\n\nWe’ve seen a number of things transpire in the world of cybercrime over the past three years\nas ransomware has taken the top spot for most lucrative malicious endeavors.\n\nThe 2016 U.S. presidential election showed the world the power of exposing sensitive\ndata and there's no doubt ransomware operators and developers were watching. It's\nnow commonplace to see ransomware groups use blackmail tactics to compel victims to\npay the ransom, while maintaining blogs to expose non-paying victims. In late 2019,\nthe Maze ransomware team was the first to release data from non-paying ransomware\nvictims, but the tactic subsequently was replicated by several ransomware-as-a-service\n(RaaS) operators. Intel 471 observed this tactic implemented by others, such as\nDoppelPaymer, MegaCortex, Nemty and REvil aka Sodinokibi. We'll continue to see\nthis trend, giving companies yet another thing to worry about as they navigate the\nransomware threat both to them directly, and the risk it brings them via their thirdparty vendors and suppliers.\n\nEmotet, Ryuk and Trickbot are by no means the only tools that team up to deliver\nransomware. We’ve also observed connections between some Dridex and DanaBot\nactors, likely for ransomware delivery. MaaS operations cannot be written off as merely\n“commodity” malware, since their client pool includes very skilled groups that can and\nwill cause serious damage if allowed to do so.\n\nRansomware has helped revamp and boost a submarket where criminals can\ncrowdsource the identification of potential targets. The sale of compromised accesses is\nnothing new in the underground marketplace, however, over the past 18 months there’s\nbeen an explosion of such sales by actors ranging in sophistication from inexperienced\nto highly knowledgeable. Ransoms over the past three years have skyrocketed and now\nare in the millions in some cases, making ransomware operations a very lucrative\nactivity. Purchasing a simple remote desktop protocol (RDP) access for thousands of\ndollars will provide a return on investment (ROI) for both sides of the sale. As malwarebased vectors are considered, so too must the accesses being obtained through simple\naccount takeovers or other means.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-04-14 - Understanding the relationship between Emotet Ryuk and TrickBot.pdf"
    ],
    "report_names": [
        "2020-04-14 - Understanding the relationship between Emotet Ryuk and TrickBot.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535958,
    "ts_updated_at": 1743041130,
    "ts_creation_date": 1653480571,
    "ts_modification_date": 1653480571,
    "files": {
        "pdf": "https://archive.orkl.eu/3a61780d37dcb38387ca77a14b76ab10aa5f3d6e.pdf",
        "text": "https://archive.orkl.eu/3a61780d37dcb38387ca77a14b76ab10aa5f3d6e.txt",
        "img": "https://archive.orkl.eu/3a61780d37dcb38387ca77a14b76ab10aa5f3d6e.jpg"
    }
}