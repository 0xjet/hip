{
    "id": "da54ba31-3595-4b88-8686-c8b6499d3c10",
    "created_at": "2022-10-25T16:48:14.162491Z",
    "updated_at": "2025-03-27T02:05:31.66353Z",
    "deleted_at": null,
    "sha1_hash": "ffaffd68561570f499110bb3e38d9e23eaf5ddee",
    "title": "Technical Analysis of Babuk Ransomware",
    "authors": "",
    "file_creation_date": "2021-02-24T14:39:10Z",
    "file_modification_date": "2021-02-24T13:53:47Z",
    "file_size": 5615618,
    "plain_text": "#### Thomas Roccia, and John Fokker\n\n\n-----\n\n### Table of Contents\n\n##### 4 Summary of Findings 5 Infection Map 5 Underground 7 Underground Observations 8 Update for Unix Machines 9 Technical Details 14 Vasa Locker: v1 Before the v1? 16 Conclusion 16 Additional Resources 17 Coverage 17 MITRE ATT&CK Techniques 18 IOCs 19 Services List 19 Process List 19 Mutexes 19 YARA Rule 23 McAfee ATR 24 About McAfee\n\n\n**Authors**\n\nThis report was researched\nand written by:\n\n- **Alexandre Mundo**\n\n- **Thibault Seret**\n\n- **Thomas Roccia**\n\n- **John Fokker**\n\n**[Subscribe to receive threat](https://www.mcafee.com/enterprise/en-us/forms/threat-information-subscription.html?eid=X7AOM1OW)**\n**[information.](https://www.mcafee.com/enterprise/en-us/forms/threat-information-subscription.html?eid=X7AOM1OW)**\n\n\n-----\n\n### Introduction\n\n#### Babuk ransomware is a new ransomware threat discovered in 2021 that attacked at least five big enterprises, with one already paying the criminals $85,000 after negotiations. This ransomware, as other variants, is deployed in the network of enterprises that the criminals carefully target and compromise. This modus operandi is known as the Big-Game hunting strategy.\n\n The group behind Babuk has also adopted the same strategies as other ransomware groups and has leaked the stolen data.\n\n The sample analyzed in this report has the following hash:\n\n 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.\n\n This hash is related to version 1 of Babuk. It comes as an executable of 32 bits compiled in Visual C/C++ and has a small size of 30kb. This initial version is neither protected nor obfuscated.\n\n In this report, McAfee[®] Advanced Threat Research (ATR) provides a deep insight of this new ransomware variant called Babuk.\n\n\nConnect With Us\n\n\n-----\n\n## Technical Analysis of Babuk Ransomware\n\n\n###### Summary of Findings\n\n- Babuk ransomware is a new ransomware family originally\n\ndetected at the beginning of 2021.\n\n- Its operators adopted the same operating methods as\n\nother ransomware families and leaked the stolen data.\n\n- Babuk’s codebase and artefacts are highly similar to Vasa\n\nLocker’s.\n\n- Babuk advertises on both English-speaking and Russian\nspeaking forums.\n\n- The individuals behind Babuk ransomware have\n\nexplicitly expressed themselves negatively against the\nBlackLivesMatter (BLM) and LGBT communities.\n\n- At least five companies have been breached as of\n\nJanuary 15, 2021.\n\n\n\n- The ransomware supports command line operation\n\nand embeds three different built-in commands used to\nspread itself and encrypt network resources.\n\n- It checks the services and processes running so it can kill\n\na predefined list and avoid detection.\n\n- There are no local language checks, in contrast to other\n\nransomware gangs that normally spare devices in certain\ncountries.\n\n- The limited diffusion of the ransomware may indicate\n\nthat those behind it are not working within an organized\ngroup or with other partners.\n\n- The most recent variant has been spotted packed (see\n\nthe ‘Additional Resources’ section).\n\n\nConnect With Us\n\n\n-----\n\n###### Infection Map\n\nFigure 1. Infection map.\n\n\n###### Underground\n\nBabuk actors have been very verbose on an underground forum. The\nfollowing screenshot shows a post where the authors advertised their leaks\nand their new support website.\n\n\n-----\n\nAs seen in the screenshot below, the persona with the username “Biba99,”\ncreated on August 26, 2020, has been active on the forum. All of Biba99’s\nposts are in the English language.\n\nPublished evidence suggests the group breached companies in the transport,\nhealthcare, plastic, electronics, and agricultural sectors.\n\nHowever, only two companies so far have had their data published by those\nbehind the Babuk ransomware. This may indicate that the other victims\ndecided to pay the ransom to avoid having their data leaked. The Babuk\noperators have indicated they may have breached several other companies.\n\n\nTwo websites are currently accessible; one is used to release the stolen data\nwhile the other is used as a support website:\n\n- hxxp://gtmx56k4hutn3ikv.onion\n\n- hxxp://babukq4e2p4wu4iq.onion\n\n\n-----\n\nInterestingly, in the new version of the website, the malware developers\nchanged the name from Babuk to Babyk. In Russian, the Cyrillic letter Y\nsounds similar to the Latin letter U.\n\nIt is interesting to note that the Babuk authors are making efforts to gain\nlegitimacy on underground forums, either to advertise for future stolen data\nor to find potential new partners.\n\n\n###### Underground Observations\n\nThe team behind Babuk first gained attention by advertising its activity on\nan English-speaking forum. Initially this was a bit out of the ordinary, since\nmost major ransomware families prominently advertise and communicate\non the Russian-speaking forums, though it was not long before we noticed\nBabuk activity on them too. Below is a screenshot of an affiliate recruitment\nadvertisement, machine translated from Russian.\n\nThe advertisements on the Russian-speaking forums were more geared\ntowards affiliate recruitment and details on technical improvements of their\nmalware, whereas the English-speaking forum advertisements were more\nfocused on victim announcements.\n\n\n-----\n\nAs mentioned earlier, Babuk’s posts are quite verbose. In its initial\nintroductory message, Babuk states that it does not attack (whitelist)\nhospitals, non-profits, schools, or companies with less than a certain amount\nof revenue.\n\nHowever, what stands out is the explicit mention that it does attack\norganizations that support the LGBTQ or BlackLivesMatter causes. We have\nnot observed this explicit mentioning before and believe, with a medium\nlevel of confidence, that this might be an indication that the criminals\nbehind Babuk are from a social climate where LGBTQ and equality are not\nsupported.\n\nThe explicit mentioning of the business intelligence tool ZoomInfo confirms\nour belief that ransomware criminals not only use the breached access to\ntheir victim’s network to determine a ransom amount, but also rely on such\ntools to determine the net worth of an organization.\n\n\n###### Update for Unix Machines\n\nIn a recent post we observed a new comment from the Babuk authors, which\nsuggests they have prepared a Unix variant of the ransomware, to target\nNAS, ESXi servers or any other Unix system.\n\nThis message shows that Babuk authors are enforcing their relationship with\npotential partners or customers and extending their capabilities to other\nsystems. We are actively monitoring this threat to detect future versions of\nthe ransomware.\n\n\n-----\n\n###### Technical Details\n\nThe compiled timestamp is December 30, 2020. The sample was compiled\nwithout support for operating systems prior to Windows Vista. This is the first\nversion released by the Babuk actors.\n\nMore information about the sample can be seen in the following table:\n\n**Name** 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9\n\n**Size** 31232 bytes\n\n**File-Type** EXE\n\n**SHA 256** 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9\n\n**Compile time** 30 December 2020 (seems legit)\n\nThe malware is a 32-bit executable (“.EXE”).\n\nFigure 2. Information about the sample.\n\nThe malware is not protected in any way and does not use any packer.\n\n\nThe first action is a check for the arguments provided in the command line,\nusing the function “GetCommandLineA.” This is done later with a custom\nfunction to get the buffer of arguments prepared.\n\nFigure 3. Get command line and arguments.\n\nIf no argument is passed, the malware has a mode to encrypt the network by\ndefault, but the following arguments can be added in the command line:\n\n\n-lanfirst\n\n-lansecond\n\n-nolan\n\n\n\n- The switch “-lanfirst” forces the mode of behavior to be “1”\n\n- “-lansecond” forces the mode of behavior to be “0” (default value)\n\n- “-nolan” forces the mode of behavior to be “-1”\n\n\n-----\n\nFigure 4. Check arguments.\n\nThese command line options allow the malware to be very flexible,\nencrypting the mounted folder before or after the local disk. This support\nto use arguments gives the operators an easy way to encrypt the network\nresources.\n\nAt this point, we can note a programming mistake. The malware checks all\narguments in the command line for these three switches and overrides the\nbehavior mode based on the last valid argument. The malware developers\ndo not use a “break” instruction to finish the argument loop when they get a\nvalid argument, wasting time.\n\nFor example, “malware.exe -lanfirst -nolan” prevents the malware from\nencrypting the network as “-nolan” overrides the behavior mode of “-lanfirst.”\n\nThe next action is changing its shutdown level, setting this level to 0 with\nthe function “SetProcessShutdownParameters.” This behavior is not very\ncommon in ransomware, but this forces the operating system to show a\nwarning message at shutdown/reboot time, saying the malware process\ncannot be closed. The user is forced to reboot or shutdown the machine\nmanually.\n\n\nFigure 5. Set shutdown level as critical process.\n\nThe next action is enumerating all services in the system and stopping all of\nthose which exist in a hardcoded list in the malware.\n\nTo perform this action, the ransomware gets the Service Control Manager\nusing the function “OpenSCManagerA” and, with this handle, enumerates all\nservices in the system.\n\nFigure 6. Get Service Control Manager.\n\n\n-----\n\nThe malware checks the status of the service if it is running. If this is the case,\nit receives the list of services that depend on it and stops them.\n\nFigure 7. Get service to stop.\n\nFor these actions, the functions “QueryServiceStatusEx,” “OpenServiceA,”\n“EnumDependentServicesA,” and “ControlService” are used. The list of the\nservices closed can be read in the IOC part of this report.\n\n\nThe next action is checking the processes running in the victim system and\nclosing them if they have a name within a hardcoded list in the malware.\n\nFigure 8. Get processes list in the victim machine.\n\nFor this, the malware uses the functions “CreateToolhelp32Snapshot,”\n“Process32FirstW,” “Process32NextW,” “OpenProcess,” and\n“TerminateProcess.”\n\nFigure 9. Open the process and terminate it.\n\n\n-----\n\nThe next action is destroying the shadow volumes of the victim machine.\nIt checks if the operating system is 64-bit or 32-bit using the function\n“IsWow64Process” in a dynamic call (as it does not exist in 32-bit operating\nsystems) and removes the file system redirection to destroy the volumes.\n\nFigure 10. Check operating system version.\n\nTo destroy the volume, it uses the native command “vssadmin.exe” with\n“ShellExecuteW.”\n\nFigure 11. Destroy the shadow volumes.\n\nThe malware performs this action twice, first at the time of running, then\nafter encrypting all files.\n\n\nBabuk checks its behavior mode and encrypts the files in the\nnetwork resources, using the functions “WNetOpenEnumW” and\n“WNetEnumResourceW.”\n\nFigure 12. Enumerate network resources.\n\nIn the encryption code, the developers made a slight mistake where they\ncreate a number of threads based on double the value of CPU cores on the\nvictim machine. However, they later instantiate only one thread per logic disk\nto encrypt. This means that the encryption process is slow, as it depends\non the number of disks, which is most likely lower than the number of\nprocessors.\n\nFiles are enumerated in the typical way for ransomware, but Babuk has\na curious check that other ransomwares do not have; it only encrypts a\nmaximum of 16 folders deep, meaning that if one folder has 17 or more\nsubfolders, the 17th and onward are ignored. This is probably to speed up\nthe encryption process.\n\n\n-----\n\nFigure 13. Check level of folder encryption.\n\nThe encryption process uses the ChaCha algorithm and protects the key and\nnonce with ECDH (Elliptic Curves). The key and nonce are generated randomly\nwith the function “RltGenRandom.” The private and public keys for ECDH are\ngenerated as such so that these keys are secure, finally using a public ECDH\nhardcoded in the malware to get the final key that is used to protect the\nChaCha keys.\n\nOnly the malware developers can get this information as they have the\nprivate key to decrypt these keys. Babuk saves the public key generated on\nthe disk in a file called “ecdh_pub_k.bin.” (NB: Version 2 of Babuk is not using\nthis file anymore.)\n\nThe files and folders to encrypt are checked with a typical hardcoded list with\nblacklisted names. After checking if the name is valid to encrypt, it checks\nwhether the file has the ransom note name. In this case, it fetches the size of\nthe target file.\n\n\nFigure 14. Save public key on disk.\n\nIf the size is less than 41,943,040 bytes, it encrypts it directly. If the size is\nlarger, it will split it into three parts.\n\nLike other ransomware variants, Babuk uses the Windows cache to write the\nfiles using “MapViewofFile.” This allows the malware to be faster and bypass\nsome security programs.\n\nFigure 15. Map files to hasten the encryption process.\n\n\n-----\n\nPreviously encrypted files have a new extension, “.__NIST_K571__,” appended\nto them. The malware avoids all files that have this extension.\n\nFigure 16. Add the extension hardcoded as encrypted file.\n\nAfter encrypting all files in the folder, the malware drops a ransom note with\nthe hardcoded name of the victim. This may indicate that only one sample\nper target is prepared. The ransomware note name is “How to Restore Your\nFiles.txt.”\n\nFigure 17. Create ransomware note.\n\n\nAnother curious thing about Babuk is that before starting the encryption\nprocess, it deletes the contents of the Recycle Bin using the function\n“SHEmptyRecycleBinA.”\n\nFigure 18. Empty all recycle bins in the system.\n\n###### Vasa Locker: v1 Before the v1?\n\nLooking into Babuk’s history gives us insights into the team’s past activity.\nBy doing this research, we can potentially determine the duration of the\ndevelopment process of the malware. We discovered a sample with a lot of\nsimilarities named “Vasa Locker” on VirusTotal:\n\n**Name** malware.exe_\n\n**Size** 28160 bytes\n\n**File-Type** EXE\n\n**SHA 256** 06d370217abec9468bc22c30ba3be72b8de1a7459f9e927656dcf2613a314bf6\n\n**Compile time** 30 November 2020\n\nBy briefly looking at the information, we can see that the sample was\ncompiled one month before the first release of Babuk v1.\n\n\n-----\n\nVasa Locker has a lot of similarities with Babuk v1:\n\n- Ransom notes look quite similar.\n\n- In Vasa Locker’s ransom note, victims are asked to contact the actor by\n\nusing the mail babukrip@protonmail.ch.\n\n- The extension added to encrypted files is the same for both samples\n\n“__NIST_K571__.”\n\n- The same cryptographic method is used by both samples.\n\n- The process kill list is the same.\n\n- The directories list is the same.\n\n\n-----\n\nBy analyzing code similarities between Vasa Locker and the first version of\nBabuk, we can see that around 86% of the code is shared:\n\n\n###### Conclusion\n\nBabuk ransomware is a new threat that first appeared in January 2021. The\nteam is gaining more visibility by advertising on underground forums.\n\nThe encryption function does not differ much from other ransomware. An\nimportant point to note is the fact that no language blacklist is embedded in\nthe malware.\n\nThe codebase itself and artefacts dropped, like the ransom notes, are highly\nsimilar to what was previously observed in Vasa Locker activities. There is a\nclear connection between the two variants, and probably between the teams,\nif indeed they are not one and the same.\n\nWhat stands out with Babuk is the racial and anti-LGBTQ statements in its\nadvertisements.\n\nWe believe that the team started this business very recently, with limited\nransomware coding experience besides a potential Vasa Locker connection,\nas the code appears to embed several bugs and has been delivered without\nany obfuscation. However, the encryption algorithm used remains solid. Since\nwe began this write up, a new variant was discovered, improving some of\nthe mechanisms mentioned in this analysis. Additionally, a packed version of\nBabuk has also been found.\n\nMcAfee ATR is actively monitoring this threat and will update accordingly.\n\n###### Additional Resources\n\n- [https://sebdraven.medium.com/babuk-is-distributed-packed-](https://sebdraven.medium.com/babuk-is-distributed-packed-78e2f5dd2e62)\n\n[78e2f5dd2e62](https://sebdraven.medium.com/babuk-is-distributed-packed-78e2f5dd2e62)\n\n- [http://chuongdong.com/reverse%20engineering/2021/01/03/](http://chuongdong.com/reverse engineering/2021/01/03/BabukRansomware/)\n\n[BabukRansomware/](http://chuongdong.com/reverse engineering/2021/01/03/BabukRansomware/)\n\n- [https://www.bleepingcomputer.com/news/security/babyk-ransomware-](https://www.bleepingcomputer.com/news/security/babyk-ransomware-wont-hit-charities-unless-they-support-lgbt-blm/)\n\n[wont-hit-charities-unless-they-support-lgbt-blm/](https://www.bleepingcomputer.com/news/security/babyk-ransomware-wont-hit-charities-unless-they-support-lgbt-blm/)\n\n\n-----\n\n###### Coverage\n\nWe cover this malware with the name Ransom!Babuk<hash>.\n\n###### MITRE ATT&CK Techniques\n\n**Tactic** **Technique** **Observable** **IOCs**\n\n\n**Defense Evasion** Obfuscated Files or Information (T1027) Use ChaCha algorithm and protect the key and nonce with ECDH.\nThe key and nonce are generated randomly.\n\n\nFunction:\n\n“RtlGenRandom”\n\n\n**Discovery** File and Directory Discovery (T1083) Enumerates files on the system. **Functions:**\n\n“FindFirstFile”\n\n“FindNextFile”\n\n“FindClose”\n\n\nSystem Information Discovery (T1082) Enumerates disk volumes on the system, get disk information,\nquery service status.\n\n\n**Functions:**\n\n“FindFirstVolume”\n\n“FindNextVolume”\n\n“FindVolumeClose”\n\n“GetDriveType”\n\n“GetVolumePathNamesForVolumeName”\n\n“GetLogicalDrives”\n\n“QueryServiceStatusEx”\n\n\nProcess Discovery (T1057) Enumerates processes on the system. **Functions:**\n\n“CreateToolhelp32Snapshot”\n\n“Process32First”\n\n“Process32Next”\n\nSystem Network Connections Discovery (T1049) Babuk encrypts the files in the network resource. **Functions:**\n\n“WNetOpenEnumW”\n\n“WNetEnumResourceW”\n\n**Execution** Shared Modules (T1129) Link function at runtime. **Functions:**\n\n“LoadLibrary”\n\n“GetProcAddress”\n\n“GetModuleHandle”\n\n**Impact** Inhibit System Recovery (T1490) Delete the shadow volumes. **Command:**\n\n“vssadmin.exe”\n\n**Function:**\n\n\n-----\n\n###### IOCs\n\n```\n550771bbf8a3e5625d6ec76d70ed86f6e443f07ce80f­\nf73e47f8249ddd72a8cf\n704a0fa7de19564bc743fb68aa0652e38bf86e8ab694bc079b15f­\n945c85f4320\n8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f­\n0495fa9\n30fcff7add11ea6685a233c8ce1fc30abe67044630524a6e­\nb363573a4a9f88b8\n1b9412ca5e9deb29aeaa37be05ae8d0a8a636c12fdff­\n8c17032aa017f6075c02\n8140004ff3cf4923c928708505754497e48d26d822a95d63bd­\n2ed54e14f19766\nc5167053129bd4a5542cfef9e739b0443e22e184cb4c0b57c049b448f­\n030cf15\nbc4066c3b8d2bb4af593ced9905d1c9c78fff5b10ab8dbed7f­\n45da913fb2d748\n3dda3ee9164d6815a18a2c23651a53c35d52e3a5ad375001ec­\n824cf532c202e6\n391cfcd153881743556f76de7bbca5b19857f8b69a6f6f6dfde6fd9b­\n06c17f5e\n\n```\n\n-----\n\n###### Services List\n\n\n###### Mutexes\n\n```\nvss, sql, svc$, memtas, mepocs, sophos, veeam, backup,\nGxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr,\nccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService,\nIntuit.QuickBooks.FCS, QBCFMonitorService, YooBackup,\nYooIT, zhudongfangyu, sophos, stc _ raw _ agent, VSNAPVSS,\nVeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc,\nveeam, PDVFSService, BackupExecVSSProvider, BackupExecA­\ngentAccelerator, BackupExecAgentBrowser,\nBackupExecDiveciMediaService, BackupExecJobEngine,\nBackupExecManagementService, BackupExecRPCService,\nAcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc,\n\n```\n```\n\\Sessions\\1\\BaseNamedObjects\\babuk _ v2\n\\Sessions\\1\\BaseNamedObjects\\babuk _ v3\n\\Sessions\\1\\BaseNamedObjects\\DoYouWantToHaveSexWith­\nCoungDong\n\n```\n\n###### YARA Rule\n\n\n###### Process List\n\n```\nsql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe,\nagntsvc.exe, isqlplussvc.exe,\nxfssvccon.exe, mydesktopservice.exe, ocautoupds.exe,\n\n```\nencsvc.exe, firefox.exe, tbirdconfig.exe,\n```\nmydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreser­\nvice.exe, excel.exe, infopath.exe, msaccess.exe,\nmspub.exe, onenote.exe, outlook.exe, powerpnt.exe,\nsteam.exe, thebat.exe, thunderbird.exe,\nvisio.exe, winword.exe, wordpad.exe, notepad.exe\n\n```\n```\nrule Ransom _ Babuk {\n    meta:\n       \u0007description = “Rule to detect Babuk Locker\n       unpacked”\n       author = “McAfee ATR”\n       date = “2021-01-19”\n       hash = “e10713a4a5f635767dcd54d609bed977”\n       rule _ version = “v1.1”\n       malware _ family = “Ransom:Win/Babuk”\n       malware _ type = “Ransom”\n       \u0007mitre _ attack = “T1027, T1083, T1057, T1082,\n       T1129, T1490, T1543.003”\n\n```\n\n-----\n\n```\nstrings:\n    $s1 = “How To Restore Your Files.txt” fullword ascii\n    $s2 = “delete shadows /all /quiet” fullword wide\n    \u0007$pattern1 = {4DE88914818B55F483C2018955F4C645FE00EB600FB645FD85C074128B4DF0034DF8C601008B55F883C2018955F­\n    8C645FD00C645FE01EB3CC645FD010FB645FE85C074188B4DF0034DF88B55F48B45E8890C908B4DF483C101894DF48B55F­\n    00355F88A45FF88028B4DF8}\n    \u0007$pattern2 = {FFFF83C040398578FFFFFF7D398B8D78FFFFFF3B4D1C7C02EB2C8B5514039578FFFFFF0FB6028B8D78FFFFFF2B8D74FFF\n    FFF0FB6540DBC33C28B4D18038D78FFFFFF8801EBA7E940FFFFFF8B4DFC33CDE8}\n    \u0007$pattern3 = {280FBE55FF83FA227506C645FC00EB148B45F00345F88A4DFF88088B55F883C2018955F8E9B50000000FBE45F­\n    F8945E48B4DE483E909894DE4837DE41977638B55E4}\n    \u0007$pattern4 = {08C7040A65787061B804000000C1E0008B4D08C704016E642033BA04000000D1E28B­\n    4508C70410322D6279B9040000006BD1038B4508C704107465206BC745FC0000}\ncondition:\n\n```\nfilesize >= 15KB and filesize <= 80KB and\n```\n    1 of ($s*) and 3 of ($pattern*)\n\n```\n```\n}\n\n```\n\n-----\n\n```\nrule RANSOM _ Babuk _ Packed _ Feb2021 {\n    meta:\n       description = “Rule to detect Babuk Locker packed”\n       author = “McAfee ATR”\n       date = “2021-02-19”\n       hash = “48e0f7d87fe74a2b61c74f0d32e6a8a5”\n       rule _ version = “v1”\n       malware _ family = “Ransom:Win/Babuk”\n       malware _ type = “Ransom”\n       mitre _ attack = “T1027.005, T1027, T1083, T1082, T1059, T1129”\n    strings:\n       // First stage\n\n```\n\u0007$first _ stage1 = { 81 ec 30 04 00 00 68 6c 49 43 00 ff 15 74 20 43 00 a3 60 4e f8 02 b8 db d9 2b 00 ba c5\n```\n       62 8e 76 b9 35 11 5f 39 eb 09 8d a4 24 00 00 00 00 8b ff 89 14 24 89 4c 24 04 81 04 24 25 10 a3 3b 81 04 24\n       cf e0 fb 07 81 04 24 35 26 9f 42 81 04 24 65 2b 39 06 81 04 24 3c 37 33 5b 81 44 24 04 48 4f c2 5d 83 e8 01\n       c7 05 54 4e f8 02 00 00 00 00 75 bf 8b 0d 54 aa 43 00 53 8b 1d 58 20 43 00 55 8b 2d 60 20 43 00 56 81 c1 01\n       24 0a 00 57 8b 3d 50 20 43 00 89 0d 64 4e f8 02 33 f6 eb 03 8d 49 00 81 f9 fc 00 00 00 75 08 6a 00 ff 15 40\n       20 43 00 6a 00 ff d7 8b 0d 64 4e f8 02 81 f9 7c 0e 00 00 75 19 6a 00 ff d3 6a 00 6a 00 8d 44 24 48 50 6a\n       00 6a 00 ff d5 8b 0d 64 4e f8 02 81 fe e5 84 c1 09 7e 0a 81 7c 24 2c 0f 11 00 00 75 12 46 8b c6 99 83 fa 14\n       7c aa 7f 07 3d 30 c1 cf c7 72 a1 51 6a 00 ff 15 2c 20 43 00 8b 0d 08 a4 43 00 33 f6 a3 f4 31 f8 02 89 0d f4\n       07 fb 02 39 35 64 4e f8 02 76 10 8b c6 e8 56 e4 ff ff 46 3b 35 64 4e f8 02 72 f0 8b 35 80 20 43 00 bf f0 72\n\n```\n\n-----\n\n```\ne9 00 8b ff 81 3d 64 4e f8 02 4d 09 00 00 75 04 6a 00 ff d6 83 ef 01 75 eb e8 d6 e3 ff ff e8 11 fe ff ff\ne8 0c e4 ff ff 5f 5e 5d 33 c0 5b 81 c4 30 04 00 00 c3 }\n\n```\n\u0007$first _ stage2 = {81ec3??4????68????????ff??????????a3????????b8????????ba????????b9????????eb??8914248\n94c240481????????????81????????????81????????????81????????????81????????????81??????????????83e801c7????\n??????????????75??8b??????????538b??????????558b??????????5681??????????578b??????????89??????????33f6eb­\n??81??????????75??6a??ff??????????6a??ffd78b??????????81??????????75??6a??ffd36a??6a??8d442448506a??6a??ffd­\n58b??????????81??????????7e??817c242c0f11????75??468bc69983????7c??7f??3d????????72??516a??ff??????­\n????8b??????????33f6a3????????89??????????39??????????76??8bc6e8????????463b??????????72??8b??????????bf????????8bf\nf81??????????????????75??6a??ffd683ef0175??e8????????e8????????e8????????5f5e5d33c05b81c43??4????c3}\n\n\u0007$first _ stage3 = {81ec3??4????68????????ff??????????a3????????b8????????ba??????\n??b9????????[2-6]891424894c240481????????????81????????????81????????????81???????­\n?????81????????????81??????????????83e801c7??????????????????[26]8b??????????538b??????????558b??????????5681??????????578b??????????89??????????3\n3f6[2-6]81??????????[2-6]6a??ff??????????6a??ffd78b??????????81??????????[2-6]6a??ff­\nd36a??6a??8d442448506a??6a??ffd58b??????????81??????????[2-6]817c242c0f11????[2-6]468bc69983????[2-6]\n\n[2-6]3d????????[2-6]516a??ff??????????8b??????????33f6a3????????89??????????39??????????[2-6]8b­\nc6e8????????463b??????????[2-6]8b??????????bf????????8bff81??????????????????[2-6]6a??ffd683ef01[2-6]e8????????e8???\n?????e8????????5f5e5d33c05b81c43??4????c3}\n\n\u0007$first _ stage4 = { 81 EC 30 04 00 00 68 6C 49 43 00 FF 15 ?? ?? ?? ?? A3 ?? ?? ?? ?? B8 DB D9 2B 00 BA C5\n62 8E 76 B9 35 11 5F 39 EB ?? 8D A4 24 ?? ?? ?? ?? 8B FF 89 14 24 89 4C 24 ?? 81 04 24 25 10 A3 3B 81 04 24\nCF E0 FB 07 81 04 24 35 26 9F 42 81 04 24 65 2B 39 06 81 04 24 3C 37 33 5B 81 44 24 ?? 48 4F C2 5D 83 E8 01\nC7 05 ?? ?? ?? ?? 00 00 00 00 75 ?? 8B 0D ?? ?? ?? ?? 53 8B 1D ?? ?? ?? ?? 55 8B 2D ?? ?? ?? ?? 56 81 C1 01\n24 0A 00 57 8B 3D ?? ?? ?? ?? 89 0D ?? ?? ?? ?? 33 F6 EB ?? 8D 49 ?? 81 F9 FC 00 00 00 75 ?? 6A 00 FF 15 ??\n?? ?? ?? 6A 00 FF D7 8B 0D ?? ?? ?? ?? 81 F9 7C 0E 00 00 75 ?? 6A 00 FF D3 6A 00 6A 00 8D 44 24 ?? 50 6A 00\n6A 00 FF D5 8B 0D ?? ?? ?? ?? 81 FE E5 84 C1 09 7E ?? 81 7C 24 ?? 0F 11 00 00 75 ?? 46 8B C6 99 83 FA 14 7C\n?? 7F ?? 3D 30 C1 CF C7 72 ?? 51 6A 00 FF 15 ?? ?? ?? ?? 8B 0D ?? ?? ?? ?? 33 F6 A3 ?? ?? ?? ?? 89 0D ?? ??\n?? ?? 39 35 ?? ?? ?? ?? 76 ?? 8B C6 E8 ?? ?? ?? ?? 46 3B 35 ?? ?? ?? ?? 72 ?? 8B 35 ?? ?? ?? ?? BF F0 72 E9\n00 8B FF 81 3D ?? ?? ?? ?? 4D 09 00 00 75 ?? 6A 00 FF D6 83 EF 01 75 ?? E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? E8 ??\n?? ?? ?? 5F 5E 5D 33 C0 5B 81 C4 30 04 00 00 C3}\n\n\n-----\n\n```\n    // Files encryption function\n\n```\n\u0007$files _ encryption1 = { 8a 46 02 c1 e9 02 88\n```\n    47 02 83 ee 02 83 ef 02 83 f9 08 72 88 fd f3\n    a5 fc ff 24 95 20 81 40 00 }\n\n```\n\u0007$files _ encryption2 = {8a4602c1e90288470283ee0\n283ef0283????72??fdf3a5fcff????????????}\n\n\u0007$files _ encryption3 = { 8A 46 ?? C1 E9 02 88\n47 ?? 83 EE 02 83 EF 02 83 F9 08 72 ?? FD F3\nA5 FC FF 24 95 ?? ?? ?? ??}\n```\ncondition:\n\n```\nfilesize <= 300KB and\n\nany of ($first _ stage*) and\n\nany of ($files _ encryption*)\n\n\n###### McAfee ATR\n\nThe McAfee Advanced Threat Research Operational Intelligence team\noperates globally around the clock, keeping watch of the latest cyber\ncampaigns and actively tracking the most impactful cyber threats. Several\nMcAfee products and reports, such as MVISION Insights and APG ATLAS, are\nfueled with the team’s intelligence work. In addition to providing the latest\nThreat Intelligence to our customers, the team also performs unique quality\nchecks and enriches the incoming data from all of McAfee’s sensors in a way\nthat allows customers to hit the ground running and focus on the threats that\nmatter.\n\n[Subscribe to receive our Threat Information.](https://www.mcafee.com/enterprise/en-us/forms/threat-information-subscription.html?eid=X7AOM1OW)\n\n```\n}\n\n```\n\n-----\n\n###### About McAfee\n\nMcAfee is the device-to-cloud cybersecurity company.\nInspired by the power of working together, McAfee\ncreates business and consumer solutions that make\nour world a safer place. By building solutions that\nwork with other companies’ products, McAfee helps\nbusinesses orchestrate cyber environments that are\ntruly integrated, where protection, detection, and\ncorrection of threats happen simultaneously and\ncollaboratively. By protecting consumers across all\ntheir devices, McAfee secures their digital lifestyle\nat home and away. By working with other security\nplayers, McAfee is leading the effort to unite against\ncybercriminals for the benefit of all.\n\n**[www.mcafee.com](http://www.mcafee.com)**\n\n6220 America Center Drive\nSan Jose, CA 95002\n888.847.8766\n[www mcafee com](http://www.mcafee.com)\n\n\nMcAfee and the McAfee logo are trademarks or registered trademarks of McAfee, LLC or its subsidiaries in the US and other countries.\nOther marks and brands may be claimed as the property of others. Copyright © 2021 McAfee, LLC. 4711_0221\nFEBRUARY 2021\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.mcafee.com/enterprise/en-us/assets/reports/rp-babuk-ransomware.pdf"
    ],
    "report_names": [
        "rp-babuk-ransomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041131,
    "ts_creation_date": 1614177550,
    "ts_modification_date": 1614174827,
    "files": {
        "pdf": "https://archive.orkl.eu/ffaffd68561570f499110bb3e38d9e23eaf5ddee.pdf",
        "text": "https://archive.orkl.eu/ffaffd68561570f499110bb3e38d9e23eaf5ddee.txt",
        "img": "https://archive.orkl.eu/ffaffd68561570f499110bb3e38d9e23eaf5ddee.jpg"
    }
}