{
    "id": "1aaa2f16-3152-4bc5-b03b-e398cfe283a3",
    "created_at": "2023-01-12T15:01:45.158357Z",
    "updated_at": "2025-03-27T02:10:49.408049Z",
    "deleted_at": null,
    "sha1_hash": "38bb6b83d7d1fdfddcec0e19a299ec5e7c96018e",
    "title": "2022-08-08 - An inside view of domain anonymization as-a-service — the BraZZZerSFF infrastructure",
    "authors": "",
    "file_creation_date": "2022-09-01T10:21:28Z",
    "file_modification_date": "2022-09-01T10:21:28Z",
    "file_size": 2853978,
    "plain_text": "# An inside view of domain anonymization as-a-service — the BraZZZerSFF infrastructure\n\n**medium.com/csis-techblog/inside-view-of-brazzzersff-infrastructure-89b9188fd145**\n\nBenoit ANCEL August 8, 2022\n\n[Benoit ANCEL](https://medium.com/@benkow_?source=post_page-----89b9188fd145--------------------------------)\n\nAug 8\n\n\n15 min read\n\nOne, if not the main, challenge with producing good intelligence is to have access to the right information at the right moment. The right\ntelemetry from the right angle helps you to detect and dig out the right signal. Sometimes, in order to obtain good telemetry, you need a bit of\nluck .\n\nThe story we are writing here will try to explain how, from a simple mistake made by an operator, we managed to collect and exploit a lot of\nprecious information from a “Fast Flux” network called BraZZZerS Fast Flux between end of 2018 and 2022.\n\nAfter sharing this data as TLP:amber with partners for years, the service now going into decline and the misconfiguration finally being fixed, we\nthink it is now the right time to release this data and explain what can be found inside. It is a good occasion to try to fill any holes in your\ndocumentation and keep track of the technical facts about the cybercrime history.\n\n## BraZZZerS Fast Flux: Domain anonymization for all\n\nDuring mid-2018, we observed an actor using the nickname BrazzzersFF to promote a service based on a system of domain anonymization\ndescribed as a fast flux:\n\n\n-----\n\ney e a e ca ed a e s, a d e o t ee t gs\n1. On the Internet, millions of projects, but “locating” the server of any of them is easy — thanks to the IP-address.\n\n2. Projects are different. There are some who, for certain reasons, better hide the IP address.\n\n3. It is possible to make sure that no one knows about the real location of the server. No one — from the word “in general”.\n\nFor this, we have FastFlux technology, which will change your IP addresses faster than anyone can track them. We are ready to install\nthis system on your servers and in the future to ensure that it will work as a clock. And we will do it around the clock, since we, unlike\nmost of the services of this type, have real and professional support 24 hours a day, without holidays and weekends.\n\nWe are BraZZZers. We are a group of experienced professionals, who at one time separated from another similar company in order to\nmake the quality of our services even better. And we will make you completely invisible, elusive and impregnable.\n\nNow it is more concrete. Except actually FastFlux, we offer you a lot of additional privileges.\n\n1. Qualitative, professional round-the-clock technical support in any time zone.\n\n2. Launch services within 15 minutes after payment.\n\n3. Own control panel FastFlux:\n\n   - with automation of actions and processes\n\n   - with domain registrations — coming soon\n\n   - with automatic billing and notifications — coming soon\n\n   - with instructions for any types of records for domains (MX, etc.) — coming soon\n\n   - and with a lot of other pleasant and useful bonuses, over which we are working hard.\n\n4. The tariff includes server rental, at your service:\n\n   - a set of standard configurations, as well as the ability to select a server with individual parameters according to your request\n\n   - constant protection from DDoS attacks\n\n   - 24-hour monitoring and support\n\n  - Guaranteed communication channel.\n\n5. Absolute bulletproof / fault tolerance. All systems are under round-the-clock automatic and manual monitoring of our specialists.\n\n6. A large database of own DNS-addresses, which is constantly expanding.\n\n7. The ability to create or configure your own DNS addresses with the required geography.\n\n8. We are always ready to meet you and completely create FastFlux for you with your individual settings and conditions.\n9. We have the highest uptime on the market. We guarantee this.\n\n10. Support for .bit domains and SSL certificates (getting or creating your own certificate in one click).\n\n11. You choose the traffic receiving port yourself.\n\n12. Our technical support is quite extensive. We will be happy to set up your server, install the necessary software and help with other\ntechnical issues.\n\nWe are working to ensure that the list of our advantages is expanded and expanded. More detailed conditions we will discuss with you\npersonally and strictly confidential.\n\nAlso, we have a keshbek system. If for some reason, for some reason, we can not provide you with the agreed services in full, you are\nguaranteed to get your money back. It should be remembered that the cacheback does not work in the following cases:\n\n   - If your project failed due to reasons beyond our control\n\n   - If your software is not installed for some reason (in the conditions that we have installed a predefined OS, php version, etc.)\n\n   - If you are blocked by the server after launching traffic directly, bypassing FastFlux.\n\nAre you tired of the constant failures of the old supplier? Or do you want to receive services at a more attractive price? For us this is a\nmatter of principle. We guarantee that we will pay you less than our competitors. In addition, we have an extremely flexible pricing policy,\nand we are ready to consider the individual tariff for each of your requests.\n\nAlso, we are working on improving our panel every day. Therefore, new features and capabilities will always appear.\n\nIn general, if you are looking for a reliable and optimal provider of Internet privacy services, then you are at the right address. The only\nnuance is we are absolutely against violence against children and animals, therefore on our servers will never be neither childish nor\nzoo. And in the rest — write to us and enjoy online invisibility!\n\nP.S. If you are a reseller who is tired of the administration and imperfection of your product, we will happily take on your shoulders your\ncares for customers. Right now we are developing API for resellers — and you can safely work on our software under your own brand.\nYou will need a minimum deposit, and we are ready to discuss the remaining conditions individually.\n\nThe service is described as a Fast flux but in reality it’s more a simple proxy system. BraZZZers rents a pool of VPSs all around the internet\nand uses them as proxy IPs in order to hide the real IP of a server.\n\n\n-----\n\nBrazzzers mechanism\nThe domains involved are resolving to a list of IPs, (we observed from 1 up to more than 20 IPs per domain) that are just redirecting the traffic\nto the real server. The abuse complaints are usually sent to the host of the IP resolving to the malicious domain but with BraZZZers each\ndomain has backup volatile IPs and the real malicious server is protected.\n\nIn order to configure their domains, each client of BraZZZers has access to a panel where they can configure their domain records. In the early\nbeginning, BraZZZers suggested the use of their own name servers but they ended up proposing DNSpod by default like most criminals are\nnow doing.\n\n\n-----\n\nBraZZZers login panel\n\nBraZZZers client panel\n[BraZZZers is just another domain protection service like Yalishanda or even](https://krebsonsecurity.com/2019/07/meet-the-worlds-biggest-bulletproof-hoster/) [Sandiflux/Fluxxy.](https://www.proofpoint.com/us/threat-insight/post/sandiflux-another-fast-flux-infrastructure-used-malware-distribution-emerges)\n\n\n-----\n\no de to d a d t ac a e s c e ts t e d, e ad to a e su e t at t e ast u e e e obse g as ea y a e s a d ot\none of the other similar services. In December 2018, an announcement made on the forum BHF helped us to understand where to look in\norder to find BraZZZers nodes.\n\n19 Dec 2018\n\nIn connection with recent events, the fact that the author decided to completely close the sale and support of software, people are\nalready appearing on the Internet forums who speculate on this situation. Please be vigilant.\n\nI decided to create one topic, which will be considered official and unified in order not to produce a lot of topics when questions arise.\n\nThe author left us a builder so that we could rebuild further our clients. Don’t panic :)\n\nLet’s, in case of any questions about the software, ask them here, answer each other, to the point and without unnecessary flooding,\nplease.\n\nI propose to exterminate the rats, to prevent them from getting rich on the panic in the market.\n\nAt the end of 2018, the manager of the Azorult stealer gave up on the project and left a builder to the BraZZZers admins.\n\nSimilar signs came from the managers of the password stealer KPOT who where directly reselling BraZZZers with the KPOT package:\n\nThe price now is $ 75, but you can still buy at the old price ($ 65) in the case of buying a pre-installed KPOT on the BraZZZerS hosting.\nThe price for everything will be $ 215 and $ 150 for each subsequent month of hosting. When buying a pre-installed version, you\nimmediately get a ready-to-work admin and build, initially configured for a bit domain, change it if necessary. The number of pre-installed\nversions is limited!\n\nThanks to those posts and several other intel signals (like the association to MoreneHost) we managed to attribute the correct IPs and map the\nBraZZZers network.\n\n## Mapping BraZZZers nodes\n\nMapping the BraZZZers infrastructure is actually quite simple.\n\nThe first and easiest way is to use passive DNS.\n\nYou identify a BraZZZers customer\nYou resolve their domains\nYou use pDNS on the IPs (BraZZZers nodes are shared between customers)\nYou pivot until covering the maximum of IPs.\n\nHowever, the pDNS method has its limits for mapping infrastructure since you can only discover known DNS resolutions and must to be very\ncareful with the time frame while pivoting in pDNS.\n\nIn the same way, we quickly observed that since 2018, BraZZZers used the same TLS certificate for its nodes:\n\n03:21:56:e1:5c:92:6a:e6:3d:a4:c1:b6:51:54:c3:ff:cc:35\n\nYou can then use your favorite mass scan provider and look for new IPs.\n\n\n-----\n\nWe also realized that every BraZZZers node uses the hostname “ns4.dnsdns.gdns”, which makes the nodes searchable for mass scan\nproviders and then pDNS pivot is possible.\n\nYet, we found an even better way to map the network. By analyzing each node of the infrastructure we discovered an interesting Nginx\nconfiguration problem.\n\n## The Nginx misconfiguration\n\nWhile configuring the deployment of a new node for protecting domains, the Nginx vhost configuration was setup to disable error_log logging.\n\nThe admins edited the Nginx configuration file by setting “error_log off” where “off” should actually be a path. The way the virtual hosts were\nconfigured ended up writing the error_log in a file called “off” in the html directory!\n\nThe logs contain two types of logs. The first kind are the upstream errors:\n\nThe upstream error tells us:\n\nA client: tried to resolve\nThe connection between the proxy node and the real server has failed, generating an upstream error.\nThe upstream shows us that on the 2019/09/02\nThe request was generated from a referrer: https://check host net/check report/b0f5f12kdac\n\n\n-----\n\ny oo g at t at og e ca u de sta d t at t s a equest se t o a c ec [ost accou t, a](https://check-host.net/) eb se ce used to o to t e up t e o a\ndomain.\n\nThe second kind is less interesting but still leak a lot of information, it’s basic error_log information. Every 404 detected on the nodes (you can\nsee a lot of mass web crawlers mass scanning IPs for example). These errors are often generated when a domain is resolving to a BraZZZers\nnode and that node doesn't have a virtual host configured for the domain. Example of log:\n\nIn the log we can see that:\n\nA client 96.57.xx.xxx\nSent a web request “GET tuneappservice.org/l3k42hj56h634gkj2lk14356jk4gh23k5jl6h4/gate.php?\nped=RTY3M0E4NjhDQ0I5JE1DLTEwNw”\n\nWe can see here what looks like a malware callback, it’s in fact [Riltok (Android malware). The log leaks victims information (IP and “ped”) but](https://securelist.com/mobile-banker-riltok/91374/)\nalso a web path 3k42hj56h634gkj2lk14356jk4gh23k5jl6h4/gate.php. Enough data to generate more intel.\n\nRiltok panel\nAfter understanding the value of that data, we quickly built different tools to store and parse those logs and just like that started a very\ninteresting 4 years journey.\n\nAs a reminder, these logs represent a very small fraction of the BraZZZers traffic. We only catch the requests that have failed. If we compare\nthe number of requests collected on BraZZZers with a botnet like Dreambot and the effective traffic captured on the control server, the\nerror_logs represent less than 5% of the total traffic; but those 5% are still gold.\n\nWe will now try to describe a few use cases observable in these logs in order to demonstrate what kind of data are available.\n\n## Use cases\n\n**Nemty ransomware and JWT leak**\n\n\n-----\n\ne ty as us g a e s to p otect ts do a s e ty top a d e ty\n\nThe logs showed us that the Nemty’s web panel was based (until the last year of Nemty’s life) on [socket.io. The polling service was leaking](https://socket.io/)\nvery important information on a GET request: the JWT token. By reusing that token in a cookie, you could access the Nemty’s panel\nauthenticated as the user related to the token:\n\nBy observing Nemty’s requests, we can easily analyze which IPs are contacting the admin panel section and then start an intel operation\nagainst the threat actors.\n\n\n-----\n\nA simple config mistake from BraZZZers ended up compromising the whole operation. Like most of the other clients of BraZZZers, Nemty\ntrusted the service to hide their backend and didn’t take any extra precaution to hide the real IP from the BraZZZers network.\n\n**The hidden panel of Azorult**\n\nThe leaked BraZZZers logs has been particularly handy with the Azorult stealer. In order to protect the webpanel of Azorult, the developers of\nthe stealer forced the installation of the webpanel into a web directory with a random name (I.E.\ndomain.com/fsebkjfxbefxdrhvbrghjkvb/admin.php)\n\nThis random name makes it theoretically impossible for anybody to guess the webpanel URL.\n\nWhen the Azorult project was abandoned, the malware was still very active in the wild and omnipresent around BraZZZers infrastructure.\n\nThanks to the logs, you can now follow every hidden panel and filter every request sent to the admin panel php pages in order to collect threat\nactor information.\n\nThe hidden panel / random directory name trick is very popular among malware developer and BraZZZers helped us a lot to collect precious\nintel.\n\n**DJVU/STOP ransomware**\n\nAnother example of client of BraZZZers leaking its panel was DJVU/STOP ransomware:\n\n\n-----\n\nThe logs leaked the hidden web panel “sjdhgfgshdgfhhjsdpenelop26” giving us access to an affiliates panel:\n\n[Some developers also used a password in a GET request to display the login form of the panel. The interesting Coalabot was doing this years](https://malware.dontneedcoffee.com/2017/10/coalabot-http-ddos-bot.html)\nago, and again BraZZZers compromised them.\n\n**ISFB**\n\nOne of the most interesting clients of BraZZZers is for sure ISFB. We observed several branches of ISFB using BraZZZers to hide its domains,\n[the most active branch was Dreambot. The BraZZZers proxies were responsible for huge damage to the Dreambot setup.](https://medium.com/csis-techblog/the-end-of-dreambot-a-loved-piece-of-gozi-24cc9bfc8122)\n\n\n-----\n\nst, t e upst ea ogs o cou se ea ed t e co t o pa e s\n\nRequests like this were very typical for ISFB bots. With Dreambot, the port 80 of the control server was reserved for the bots and the port 3000\nfor the panel.\n\nEven if we imagine that the Dreambot operators were using basic security like, for example, not using admin:admin as credentials, the\nBraZZZers requests acted like a sinkhole and allowed us to capture and analyse lots of Dreambot campaigns and alert victims.\n\nWhen BraZZZers leaked a log like:\n\nhttp://antidoping.at/images/W7DM8fQnAkZl5/w_2BSbbA/6KBhhx7wg5evMuvuMv1oao4/U6yRGzURZD/XiL01nc5vbfiBN4bX/1hU3GL4_2F8A/_2Br5AtZ\n\n[We could easily (thanks here to Fumiko) parse those requests and extract campaigns data without even having to look for a binary:](https://twitter.com/fumik0_)\n\n\n-----\n\nTop 20 hits by an ISFB domains to BraZZZers\n\nISFB versions distribution from the logs\n\nDreambot serpent keys observed in the logs\n\n\n-----\n\nVictims clusters, showing the 3 botnets US, JP, DE/BG/EU\nWhile parsing the logs we found some interesting ISFB requests, like the early deployments of IAP2; or even surprisingly GoziAT with domains\nconfigured on localhost.\n\n**Cryptbot Stealer**\n\n[Another cool piece of malware to follow in these logs is Cryptbot. The operator of Cryptbot managed to build a huge botnet hidden behind a](https://www.gdatasoftware.com/blog/2020/02/35802-bitbucket-abused-as-malware-slinger)\nquite resilient infrastructure. It has been very hard to obtain intel - until we looked at BraZZZers.\n\nWe can observe the early days of Cryptbot dating back to 2019. Thanks to the upstream we were able to monitor them using the same IP as\ncentral CnC for months: 5.182.39[.]172.\n\nIf you do a reverse lookup and look for all the domains configured to that IP, you will see that Cryptbot in its early days was hosting its own\nmarketplace in order to resell their stolen logs.\n\n\n-----\n\nOn top of the usual .top domains used as CnC gateway, we saw the infrastructure hosting shops like larek.info or magazzz.top\n\nMonth after month you can observe the botnet evolving into multiple botnets split on different infrastructures.\n\nThis is just another example of how useful these logs can be. Looking up every domain attached to the same hidden IP is a great way to help\nyour attribution. Lots of actors were sloppy with real server IPs, thinking they were protected by BraZZZers.\n\n**Marketplaces**\n\nBraZZZers was not only reserved to malware, we observed a fair amount of Market places / carding shops. Some well-known ones like\nslilpp.top or cop.su could be found here.\n\n\n-----\n\nWe extracted a list of the most known ones from the logs:\n\ndarknet.so\ncop.su\nvor.nz\nsrost.biz\nslilpp\nv-market\ncvv2.name\ncvvshop.lv\nhybra2web.ru\nvault.ug\n\n**Magecart**\n\nAs a final example, we will show how to exploit the referrers with Magecart (a.k.a. eCommerce skimmers) . Several domains on BraZZZers\nwere used for Magecart attacks:\n\nBy looking at the referrer in the logs, we could see that the domain toplevelstatic.com is called from several shops blockandcompany.com,\n_thepinkdoormemphis.com… From the logs you can easily create a list of web shops infected by a web skimmer._\n\nAs can be seen from those few examples, different approaches are possible in order to extract valuable data. Those logs are quite diverse,\nyou can see requests from multiple botnet families, for example ISFB, PsixBot, DJVU, Nemty, Ako, Riltok, Coalabot, Cryptbot, Megumin,\nAzorult, KPOT, Betabot, ZLoader, DiamandFox, Vidar, Lokibot, TinyNuke, OSX malware…\n\n## Global stats\n\n\n-----\n\nga, p ease bea d t at t ese ogs o y s o t e a ed equests o t e a e s ast uctu e e be o stat st cs ca e p to see\ntendencies but cannot necessarily be used to determine who was receiving the most traffic.\n\nTop hits by domains in the BraZZZers logs\n\nTop hosters used to host the BraZZZers proxy nodes\nThis story teach us that nobody is immune from a incompetent supply chain. It’s a good example of the limits of the open cybercrime industry.\nThe business is mainly based on trust and reviews and we have seen several cases where BraZZZers admins were pushing fake reviews to\nboost the reputation of the service. From here it’s the snow ball effect and it just needs one big name like Azorult or a ransomware group\npatient enough to tolerate the poor quality service to attract more clients.\n\nWhile following the business side of BraZZZers, we observed several users reporting the poor quality of the service, the grey links to the\nhosting company MoreneHost or the low frequency of nodes renewal but that hasn’t been enough to scare away the majority of customers.\n\n\n-----\n\ne e pect to see o e a d o e cases e t s o e e cybe c e dust y s g o g uc aste t a t e s s o t e cybe c a s\nAlmost every step of fraudulent activity is now supported by a third party within the market. Malware, VNC, infrastructure, drop data, drops,\nmarketplaces. The industry end up with a multitude of poorly developed services sold in open marketplaces to customers completely unable to\nunderstand if a service should be trusted or not as long as it works.\n\n## Opening the data\n\nAs explained in the introduction, the data is composed of upstream and 404 logs from end of 2018 to March 2022. To make the interesting data\navailable, while trying not to expose victims IPs, we are opening all the upstream logs without client IPs as TLP;WHITE.\n\nThe file is a csv: date,domain,upstream,referrer.\n\n[[Download] — Zip password: infected](https://benkow.cc/braZZZersUpstream2018-2022_.zip)\n\nef2a69c94e5420f44ee0932abbfaf8e3b4f5f5bb6308a4928dc4dd4bc06f6d4c\n\nWe hope these logs will maybe make somebody out there able to look at them from yet another angle.\n\nHappy hunting!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-08 - An inside view of domain anonymization as-a-service — the BraZZZerSFF infrastructure.pdf"
    ],
    "report_names": [
        "2022-08-08 - An inside view of domain anonymization as-a-service — the BraZZZerSFF infrastructure.pdf"
    ],
    "threat_actors": [
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535705,
    "ts_updated_at": 1743041449,
    "ts_creation_date": 1662027688,
    "ts_modification_date": 1662027688,
    "files": {
        "pdf": "https://archive.orkl.eu/38bb6b83d7d1fdfddcec0e19a299ec5e7c96018e.pdf",
        "text": "https://archive.orkl.eu/38bb6b83d7d1fdfddcec0e19a299ec5e7c96018e.txt",
        "img": "https://archive.orkl.eu/38bb6b83d7d1fdfddcec0e19a299ec5e7c96018e.jpg"
    }
}