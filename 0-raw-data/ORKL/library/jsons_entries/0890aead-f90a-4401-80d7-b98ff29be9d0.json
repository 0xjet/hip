{
    "id": "0890aead-f90a-4401-80d7-b98ff29be9d0",
    "created_at": "2022-10-25T16:48:18.715266Z",
    "updated_at": "2025-03-27T02:05:55.991784Z",
    "deleted_at": null,
    "sha1_hash": "ef73a118e3f84a58d71c7781a880024869ccd74f",
    "title": "",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 2866092,
    "plain_text": "# WHY ATTACKER TOOLSETS\n DO WHAT THEY DO\n\n### (or.. “Reasons they just keep working”)\n\n\n-----\n\n# OVER THE LAST YEAR\n\n#### 50+ engagements\n\n Good chunk of different verticals, industries, etc.\n\n Varying qualities and effectiveness of defenses\n\n Collective noun of different Threat Groups\n\n … but really? Similar tools and tactics\n\n\n-----\n\n# THE MAGIC OF INTERPRETIVE DANCE\n\n#### Pick through this year’s interesting engagements\n\n Construct a convenient narrative\n\n Discuss the common blind-spots the tools keep leveraging\n\n Explore Reasons They Just Keep Working (RIJKW)\n\n\n-----\n\n# OUR SCENARIO\n\n\n-----\n\n# RTJKW #1: AD HOC DEPLOYMENTS\n\n#### Deploy and forget (bonus: default configurations)\n\n External teams not looping in the security team\n\n Third-party systems without patch management\n\n Cloud infrastructure: the new frontier of terrible\n\n\n-----\n\n# THE VOLUME GAME\n\n#### Scan and exploit; because eventually it will work\n\n\n-----\n\n# CHINACHOPPER POST\n\n#### Webshell all the things\n\n\n-----\n\n-----\n\n-----\n\n# OWA: WHO NEEDS THE DC?\n\n#### ISAPI filter (.NET)\n\n##### OwaAuth.Application_EndRequest()\n\n - Receives request after submitted\n - Extract username and password from login, save to\n text file\n - Parse traffic for magic key, password, and params for\n backdoor\n\n\n-----\n\n##### - List, read, write, delete, modify, files and directories\n - Timestomp file or directory\n - Download file from URL\n - Launch process\n - Connect, query, write to SQL server\n\n\n-----\n\n# OUR SCENARIO… SO FAR\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n|Col1|ACEHASH: ALL THE HASHES|\n|---|---|\n|Mimikatz|Custom-compiled PE executes sekurlsa:: logonpasswords command automatically|\n|Ace1|Custom DLL, uses samsrv.dll APIs to dump hashes from disk/registry|\n|Ace2|Custom DLL, based on WCE, uses msv1_0.dll APIs for LM/NTLM|\n|InjectMemDll|Inject above when required|\n\n\n# ACEHASH: ALL THE HASHES\n\n###### Mimikatz Custom-compiled PE executes sekurlsa:: logonpasswords command automatically\n\n Ace1 Custom DLL, uses samsrv.dll APIs to dump hashes from disk/registry\n\n Ace2 Custom DLL, based on WCE, uses msv1_0.dll APIs for LM/NTLM\n\n InjectMemDll Inject above when required\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n# OUR SCENARIO… SO FAR\n\n\n-----\n\n# RTJKW #2: CREDENTIAL “ISSUES”\n\n#### Golden images are convenient, as is scripting installs\n\n Same local Admin passwords is … not great\n\n Failing to restrict local Admin over network\n\n Insecurely storing passwords on network\n\n\n-----\n\n###### \"net\" time /domain \"net\" start query \"netstat\" -an \"ping\" -n 1 www.nba.com \"net\" view /domain \"net\" localgroup administrators \"net\" user adm_it /domain \"cmd\" /c dir C:\\users\\ \"net\" group \"Domain Admins\" /domain \"C:\\Windows\\system32\\net1 group \"Domain Admins\" /domain \"nltest\" /trust_domain\n\n\n-----\n\n###### \"cmd\" /c dir \\\\10.16.2.208\\c$ \"dir \\\\10.16.2.208\\c$ \"net\" use \\\\10.16.2.208\\c$ \"Changeme!\" /user:CORP\\CS_ADM_IT\n\n \"C:\\windows\\temp\\acehash64.exe -s adm_qa:CORP: AAD3B435B51404EEAAD3B435B51404EE:A5B440A4C4E1965E6F5905A08AF6F2DE \"dir \\\\10.16.2.233\\c$\" \"C:\\windows\\temp\\acehash64.exe -s Administrator:123: AAD3B435B51404EEAAD3B435B51404EE:A67C071444ED771589B736189B08F2AD \"dir \\\\10.16.2.208\\c$\" \"C:\\windows\\temp\\acehash64.exe -s Administrator:123: AAD3B435B51404EEAAD3B435B51404EE:A67C071444ED771589B736189B08F2AD \"dir \\\\10.16.2.204\\c$\\inetpub\\\"\n\n\n-----\n\n# OUR SCENARIO… SO FAR\n\n\n-----\n\n# RTJKW #3: BOTTLENCK BRO?\n\n#### Chokepoints using (authenticating) proxies\n\n Central point to log, gather/apply intel, block, etc.\n\n Many basic RATs/Toolsets/Malware won’t work\n\n Unfettered internet access is a terrible idea\n\n\n-----\n\n# POISON IVY\n\n#### Grandfather of Chinese targeted RATs (circa 2004)\n\n Custom TCP C&C protocol\n\n Still deployed, updated but only basic proxy support seen this year\n\n Volatility + Chopshop + metasploit modules available\n\n\n-----\n\n###### namesvrtwo.serveftp.com,8888 ga2a.no-ip.biz namesvrone.myftp.org,8989 exw.no-ip.info m2013.no-ip.org,443 60.235.12.64 update17.ignorelist.com,443 hack43mila.no-ip.biz sap123.no-ip.biz,3480 cool-t.no-ip.biz sap123.servehttp.com,5460 alnweer2009.no-ip.info statictwo.myftp.org,9999 alnweer2009.no-ip.org staticone.hopto.org,9898 test.no-ip.org banse.zapto.org,4444 sero.ddns.net gserverhost.no-ip.biz,6666 serix21.no-ip.biz gserverhost.myftp.org,5555 evil3322.no-ip.biz connektme.no-ip.org,6460 zxoo.no-ip.biz connektme.hopto.org,7539 m55m55m44.no-ip.org easyconnect.zapto.org,3333 easyconnect.no-ip.org,4444\n\n\n-----\n\n-----\n\n# OUR SCENARIO… SO FAR\n\n\n-----\n\n# RTJKW #4: DOMAIN SEPARATION\n\n#### Strict separation, limited accounts, hardcore logging\n\n Extends to shared infrastructure, third parties, BYOD\n\n Trying to avoid these points being like those really fun ball pits, but for privileged credentials\n\n\n-----\n\n-----\n\n# OUR SCENARIO… SO FAR\n\n\n-----\n\n# RTJKW #5: POROUS FIREWALLS\n\n#### Don’t forget about the non-TCP protocols\n\n Unit test and regression test the perimeter\n\n Segmentation is a thing\n\n\n-----\n\n-----\n\n# EXPOSING YOUR BITS\n\n#### Windows update component for file transfer\n\n\n-----\n\n# PLUGX\n\n#### Been around since 2011, actively developed\n\n Modular construction to evade sandboxing, etc.\n\n C&C via UDP, DNS over UDP, CUSTOM over TCP, HTTP, HTTPS, ICMP, customer over IP\n\n Plugin infrastructure\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n# PLUGINS\n\n#### - Read/write/enumerate files, registry\n - Download/execute files\n - Enumerate, read, write, inject, kill processes\n - Port forward/proxy traffic, enumerate network\n - Full SQL driver interface\n - RDP keylog screenshot video\n\n\n-----\n\n# OUR SCENARIO… SO FAR\n\n\n-----\n\n# RIJKW #6: INTERNAL BLINDNESS\n\n#### Some visibility inside the network is … useful\n\n Common for newer RATs to have P2P\n\n Routing traffic through the network to reach other targets\n\n\n-----\n\n# RBDOOR\n\n#### Alternative to PlugX, full RAT functionality too\n\n Both 64 and 32 bit versions\n\n C&C via TCP, UDP, HTTP, HTTPS, ...\n\n Traffic relay is also built in ...\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n# RBDOOR ROUTING\n\n#### Everything done via IP/TCP header modification\n\n Main functionality:\n\n - Drop packets from blacklist\n - Route packets to new destination port in whitelist\n - Capture session cookies by routing to magic port\n\n\n-----\n\n# NOT EVEN NORTON DSE WILL SAVE YOU\n\n#### Sometimes you just want to load your dodgy network driver on an x64 system\n\n DSE from Vista onwards “stops” that\n\n Unless … it doesn’t?\n\n\n-----\n\n-----\n\n# OUR SCENARIO… SO FAR\n\n\n-----\n\n# TL; DR\n\n#### “APT”s - mostly not very A, but usually very P\n\n 80/20 of network security will thwart the average intruder\n\n The adversary reuses tools and tactics; if they get in, you should have home ground advantage. Use it.\n\n\n-----\n\n# REFERENCES & QUESTIONCES\n\n#### DYNDNS LIST https://github. com/EmergingThreats/et-luajit-scripts\n\n DNSTUNNEL https://github.com/iagox86/dnscat2\n\n FWUNIT http://fwunit.readthedocs.org/en/latest/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "http://2015.ruxcon.org.au/assets/2015/slides/Ruxcon%202015%20-%20McCormack.pdf"
    ],
    "report_names": [
        "Ruxcon%202015%20-%20McCormack.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041155,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/ef73a118e3f84a58d71c7781a880024869ccd74f.pdf",
        "text": "https://archive.orkl.eu/ef73a118e3f84a58d71c7781a880024869ccd74f.txt",
        "img": "https://archive.orkl.eu/ef73a118e3f84a58d71c7781a880024869ccd74f.jpg"
    }
}