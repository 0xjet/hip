{
    "id": "dc81c940-1091-4b48-b426-565a3b474018",
    "created_at": "2023-06-05T02:07:40.137927Z",
    "updated_at": "2025-03-27T02:05:49.890762Z",
    "deleted_at": null,
    "sha1_hash": "d21b0b976547feaf85ecb002169f316d919be28c",
    "title": "2022-11-03 - P2P Botnets- Review - Status - Continuous Monitoring",
    "authors": "",
    "file_creation_date": "2023-06-04T12:54:56Z",
    "file_modification_date": "2023-06-04T12:54:56Z",
    "file_size": 1375848,
    "plain_text": "# P2P Botnets: Review - Status - Continuous Monitoring\n\n**[blog.netlab.360.com/p2p-botnets-review-status-continuous-monitoring/](https://blog.netlab.360.com/p2p-botnets-review-status-continuous-monitoring/)**\n\n360Netlab November 3, 2022\n\n## Origins\n\nP2P networks are more scalable and robust than traditional C/S structures, and these\nadvantages were recognized by the botnet authors early on and used in their botnets. In\nterms of time, [Storm, which appeared in 2007, can be considered the progenitor of this area,](https://en.wikipedia.org/wiki/Storm_botnet)\nwhen botnet threats were first known to the public. after Storm, there have been Karen,\n[ZeroAccess, GameOver, Hijime, mozi and other kinds of P2P botnes, P2P botnets come and](https://ijcttjournal.org/archives/ijctt-v12p112)\ngo, and some, for example, Mozi keep on going even though the author had been caught.\n\nThe early P2P botnets mainly targeted Windows machines, such as Storm, ZeroAccess and\nGameOver, which were infected with the Windows operating system. after Mirai appeared in\n2016, Linux IoT devices, which exist in large numbers on the network and lack some basic\nsecurity defense, started to become the target of many botnets. For example, Hijime, mozi,\npink all target Linux devices.\n\nBecause of the \"centerless\" nature of P2P networks, it is somewhat difficult to assess their\nsize using traditional means. To try to solve this problem, security researchers have invented\nP2P crawler technology, which can track a P2P botnet and obtain node IPs, download links\nand configuration information for scale assessment and targeted removal.\n\nOur team(360 netlab) has been focusing on discovering and tracking active botnets for a\nlong time, and P2P botnets are surely on our radar. For example, we first disclosed the mozi\nbotnet in 2019. In order to gain better visibility, we built an industrial-level tracking system for\nP2P botnets, with the goal of covering major active P2P botnets, This blog article will briefly\nanalyze the current status of the following 5 families based on the tracking data generated by\nthis system.\n\n(In addition to the 5 families mentioned in this article, readers are also welcomed to leave\ncomments below about new|active families of interest, and we will look into them\naccordingly)\n\n## Overview of tracking Strategy\n\nThis section will briefly introduce the main tracking strategies used in our tracking system.\n\n## Tracking Goals\n\n\n-----\n\nThe main goal of the system is to record the IPs of all the p2p nodes, we create a node by\nsimulating the communication protocol, so it can join the corresponding P2P network to\nparticipate in the data message exchange. Every time a message exchange is successfully\ncompleted, the IP of the other party is recorded, this goes on and on and finally the majority\nof the nodes from the target P2P network would be recorded.\n\n## Methods\n\nThe protocol design of each P2P family varies, but following are some common strategies,\nnormally at least one of these would be selected as the tracking method.\n\n**Active Probe: This strategy is somewhat similar to a public network scanner in terms of**\nworking principle. It first feeds probe messages to the target node, then parses the received\nreply messages, and identifies the peer as a peer node when the returned message format\nmatches the family characteristics. In practice, we will first delineate a probe range and then\nprobe the nodes within this range (where the probe range may consist of a suspicious\nnetwork segment or suspicious nodes generated from other policies).\n\n**Recent communications：Common P2P families maintain a \"recent communications list\"**\nof recent peers in each node's memory. In some families, this list is also available to other\nnodes via specific commands, and would commonly be used as a seed list when the node\n“boots up”, so that they can quickly join the P2P network. In this case, we can discover more\npeer nodes by traversing this \"recent communication list\".\n\n**Node heartbeat: When a node maintains a \"recent communication list\", it will send heartbeat**\nmessages to the nodes on the list periodically to declare its online status. Based on this, we\ncan add the \"fake node\" to the other node's active list to get the active status of the\ncorresponding node at any time. In some cases, we also send heartbeat messages to\nensure that we don’t get kicked out by the network.\n\n**[Wait and see: \"Hajime\" and \"Mozi\", for example, use \"Distributed Hash Table\" to implement](https://en.bitcoinwiki.org/wiki/Kademlia)**\ntheir P2P network structure. This technique is designed to speed up data lookup by adding a\nrule of information-to-node distance and prioritizing the information to be stored on those\nnodes that are closer. Based on this rule, we can forge a “we-are-more-closer” node then\nwait for the arrival of other nodes. When other nodes try to obtain the information of the\ncorresponding family from the forged node, we can directly record the other IP as the\ntracking result.\n\n## How to read the Data\n\n Tracking family selection basis\n\n\n-----\n\nWe consider the following two dimensions to screen the appropriate families for tracking to\nensure the relative objectivity of the final results.\n\n**Based on size: When selecting families, the most priority indicator is that the size of the**\nbotnet has to be large, or once historically large enough, in this case \"Hajime\"/\"Mozi\"/ “pink\"\nall stand out.\n\n**Recent Disclosures: The next choice is the newly emerged ones that have been active at**\nlease for a little while, based on this, we have chosen \"panchan\" and \"frizefrog\" as they are\nnewly discovered this year.\n\n## Size of the infected bot nodes\n\nDepending on the type of the host device, the number of bot IPs does not necessarily reflect\nthe true number of infected devices.\n\n_Bots are servers: In order to provide stable services, the public IPs of servers usually do not_\nchange, so the numbers are more accurate.\n\n_Bots are IoT devices: These devices are usually found in the residential network. We all_\nknow that the IP addresses of residents devices change frequently. This can lead to a large\nuncertainty in the mapping relationship between the public IP and the device. Multiple\ndevices might share a common public IP (NAT scenario), and devices can switch to different\nIPs multiple times within a time window (dial-up Internet scenario).\n\n## Daily activity of each family\n\nAs a comparison, if we take the daily activity of each Monday since August as a sample to\nplot the medium- and long-term tracking graph, the following is shown.\n\n\n-----\n\nWe can clearly see the order of the family size:\n\nPink > Hajime > Mozi >> FritzFrog <> Panchan\n\nWe can see that the daily activity data of each family has not changed much over the three\nmonths period (see the discussion below for Pink's fluctuations in August)\n\n## Statistics by family\n\n Pink\n\nAt one point, the Pink family had infected more than one million devices in China, it has\nsome cleverly designed command and control protocols. For time sensitive instructions, the\ncontrol commands are pushed to the bots through a centralized mechanism, On the other\nhand, if the instructions are not urgent, P2P would be used. For more information, please\nrefer to our previous report.\n\n[《Pink, a botnet that competed with the vendor to control the massive infected devices》](https://blog.netlab.360.com/pink-en/)\n\n**Geographical distribution**\n\nAs shown in the figure, Pink's scope of influence is mainly domestic IoT devices, and the\nfollowing is its distribution in China.\n\n\n-----\n\n**Daily activity fluctuation**\n\nIt is worth mentioning in particular that the daily activity data of the family has fluctuated\ngreatly since July, first dropping by an order of magnitude in a week starting on July 12,\nreaching a daily activity of about 20,000, then returning to zero for about 10 days after\nAugust 20, and then returning to 20,000 in September. The fluctuation of daily activity can be\nseen in the following chart.\n\nNow let’s take a look at daily activity data of July 12, July 26 and September 1. It is easy to\ntell that the number of daily activities in most provinces decreased significantly with time\ngoes by.\n\n\n-----\n\nSo, it is very likely that starting from July, the major device vendor carried out a national wide\nclean up effort, resulting in a significant decrease in the number of infected devices.\n\n\n-----\n\nThe fluctuations in late August, on the other hand, are likely due to a national wide C2\nblocking action in place.\n\n## Hajime\n\nHajime, which emerged in the same year as MIRAI, less than a few months apart, has been\nclaimed to be run by \"white hats\" in its alert messages, and its components function with the\nprimary goal of self-propagation. The communication and management between its\ncomponents makes extensive use of asymmetric encryption and decryption algorithms,\nmaking it an extremely classic P2P botnet family. We have covered this botnet in our\nprevious blog.\n\n[《Is Hajime botnet dead?》](https://blog.netlab.360.com/hajime-status-report/)\n\n**Geographical distribution**\n\n**Iran tops the list**\n\nWe normally don’t see Iran on our security event list, but with Hajime infection, Iran is leading\nthe pack, which is pretty interesting. Please leave comments below if you have more\ninsights.\n\n**CPU distribution in Hajime**\n\nHajime is a P2P network built on file exchanging and each Hajime bot tries to find the latest\nversion of .i.xxx and atk.xxx files (e.g. atk.arm7/.i.arm7) when it runs. This gives us an\nopportunity to evaluate the CPU distribution in the \"Hajime network\". When the Hajime node\nasks us which nodes contain the corresponding files, we gets a DHT.search count. When a\nHajime node asks us to download the corresponding file, we gets a uTP.Request count.\nPutting these two types of files and two types of counts together, we would have the\nfollowing four pie charts:\n\n\n-----\n\nBased on the above pie charts, we can see that MIPS based bots are the majority in the\nHajime network, far exceeding the sum of the other types of hosts, while MIPSEL has the\nfewest host nodes.\n\nIf we consider that Hajime had integrated a large number of vulnerabilities for propagation,\nthis data can even reflect to some extent the distribution of each type of CPU in smart\ndevices.\n\n## Mozi\n\nMozi started out as a P2P family performing DDoS attacks for profits, and later added a\nmining component. Its network topology is built on the basis of the DHT protocol. More\ninformation can be found in our previously published reports.\n\n[《Mozi, Another Botnet Using DHT》](https://blog.netlab.360.com/mozi-another-botnet-using-dht/)\n\n[《The Mostly Dead Mozi and Its’ Lingering Bots》](https://blog.netlab.360.com/the-mostly-dead-mozi-and-its-lingering-bots/)\n\n**Geographical Distribution**\n\n\n-----\n\n## FritzFrog\n\nFritzFrog is a mining P2P family which relies on SSH services to build P2P networks. It was\nfirst disclosed by akamai. More details can be found in the following report (interestingly,\nFritzFrog wallet address is related to Mozi).\n\n[《FritzFrog: P2P Botnet Hops Back on the Scene》](https://www.akamai.com/blog/security/fritzfrog-p2p)\n\n**Geographical Distribution**\n\n**Account Passwords in FritzFrog**\n\nSince FritzFrog's P2P is based on SSH implementation, the password of the infected nodes\nare reflected in the crawled data, the following are the top passwords.\n\n\n-----\n\nThe No.1 weak password starts with 1, can anyone take a guess what it is?\n\n## Panchan\n\nPanchan is a mining P2P botnet developed in Go language, it also uses SSH weak\npasswords for propagation. Its code contains a lot of Japanese katakana, which suggests\nthat Panchan's developers are fluent in Japanese. Another interesting point is that it\nimplements an interactive console on the listening port, using the idea of protocol reuse,\nallowing administrators to perform some simple queries and management of the nodes from\nthe network. More detailed information can be found in the following Akamai report.\n\n[《Panchan’s Mining Rig: New Golang Peer-to-Peer Botnet Says “Hi!”》](https://www.akamai.com/blog/security/new-p2p-botnet-panchan)\n\n**Geographic Distribution**\n\n## Conclusion\n\n\n-----\n\nNormally we end our blog with some conclusion, do we have one here? Not really, we just\nwant to shout out to our readers again: if you have seen some interesting p2p botnet, leave a\ncomment, shoot us an email(netlab[at]360.cn) or on **[twitter.](https://twitter.com/360Netlab)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-11-03 - P2P Botnets- Review - Status - Continuous Monitoring.pdf"
    ],
    "report_names": [
        "2022-11-03 - P2P Botnets- Review - Status - Continuous Monitoring.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1685930860,
    "ts_updated_at": 1743041149,
    "ts_creation_date": 1685883296,
    "ts_modification_date": 1685883296,
    "files": {
        "pdf": "https://archive.orkl.eu/d21b0b976547feaf85ecb002169f316d919be28c.pdf",
        "text": "https://archive.orkl.eu/d21b0b976547feaf85ecb002169f316d919be28c.txt",
        "img": "https://archive.orkl.eu/d21b0b976547feaf85ecb002169f316d919be28c.jpg"
    }
}