{
    "id": "6e79cf29-e160-4528-b507-eeaad37d602f",
    "created_at": "2023-01-12T15:04:35.633436Z",
    "updated_at": "2025-03-27T02:05:48.495477Z",
    "deleted_at": null,
    "sha1_hash": "29920ac8a632cfa83696ec600bb10884977f58c3",
    "title": "2016-08-10 - CryptXXX - CrypMIC – intensywnie dystrybuowany ransomware w ramach exploit-kitów",
    "authors": "",
    "file_creation_date": "2022-05-28T01:19:26Z",
    "file_modification_date": "2022-05-28T01:19:26Z",
    "file_size": 326030,
    "plain_text": "# CryptXXX \\ CrypMIC – intensywnie dystrybuowany ransomware w ramach exploit-kitów\n\n**[cert.pl/news/single/cryptxxx-crypmic-ransomware-dystrybuowany-ramach-exploit-kitow/](https://www.cert.pl/news/single/cryptxxx-crypmic-ransomware-dystrybuowany-ramach-exploit-kitow/)**\n\n[W ostatnim czasie otrzymujemy zgłoszenia związane z infekcją ransomware znanym jako](https://www.sans.org/sites/default/files/newsletters/ouch/issues/OUCH-201608_po.pdf)\nCryptXXX i jego naśladowcą CrypMIC.\n\n## Kampania\n\nZagrożenie pojawiło się kilka miesięcy temu jako moduł exploit-kita Neutrino. Infekcja\n[następuje po wejściu na stronę na której publikowane są złośliwe reklamy (malvertising).](https://blog.malwarebytes.com/101/2016/06/truth-in-malvertising-how-to-beat-bad-ads/)\n\nCelem ataku jest głównie nieaktualna wtyczka Adobe Flash Player (wersje do 21.0.0.213,\n[podatność CVE-2016-4117). Złośliwe oprogramowanie dystrybuowane jest zamiennie z](https://helpx.adobe.com/security/products/flash-player/apsa16-02.html)\nransomware takim jak CryptoWall, TeslaCrypt, CryptoLocker i Cerber.\n\nW ciągu dwóch tygodni czerwca twórcom CryptXXX udało się zarobić 70 BTC (na dzień\nwpisu jest to około 160 000 PLN / 41 000 USD). Lukratywność tego przedsięwzięcia\nspowodowała pojawienie się naśladowców, szukających szybkiego zarobku za\npomocą malware określanego jako CrypMIC.\n\nBardzo rzadko zdarza się tyle podobieństw pomiędzy niespokrewnionymi rodzinami\nmalware:\n\nDostarczane jako biblioteki .DLL (w niektórych wersjach ten sam entry-point:\nXMS0\\MMS0)\nSchemat nazewnictwa pliku w postaci: rad[losowy_ciąg_znaków].tmp.dll\nŻądany okup w wysokości 1,2 – 2,4 BTC\nNazwy plików z informacją o okupie róźnią się jedynie jedną literą (‚!’ na\npoczątku) i mają takie same rozszerzenia (.TXT, .BMP)\nWłasny protokół komunikacji po TCP (port 443)\nTakie same stringi, mające identyfikować (prawdopodobnie) kampanię\n\n\n-----\n\nSzyfrowanie udziałów sieciowych oraz dysków wymiennych podłączonych do\nkomputera w momencie infekcji\nZbliżony układ graficzny i tekst na bitmapach z żądaniem okupu, ustawianych\njako tapeta na pulpicie\n\n## Szczegóły techniczne CryptXXX\n\nCryptXXX jest napisany w Delphi i dystrybuowany, jak już wcześniej było wspomniane, jako\nbiblioteka DLL. Uruchamiany jest w systemie ofiary za pomocą rundll32.exe lub\nregsvr32.exe. Poniższy opis dotyczy wersji oznaczonej przez programistów jako 5.003 z dnia\n25.07.16 (MD5: fb43d0a186f9952523a7e9ac1202da2a).\n\nPo infekcji do folderu autostart użytkownika dodawany jest skrót o nazwie\n\n[12_znakowy_identyfikator_użytkownika].lnk, który wyświetla po uruchomieniu systemu\nżądanie okupu. Malware ma również funkcję przesłonięcia pulpitu z wiadomością o okupie,\nco skutkuje niemożnością korzystania z systemu operacyjnego.\n\n\n-----\n\nStringi, które odpowiadają za realizację funkcjonalności CryptXXX są zaciemnione za\npomocą operacji bitowej XOR ze stałą wartością 0xEh (widoczne na zrzucie ekranowym\nponiżej). Malware korzysta jedynie z packera oraz niestandardowego protokołu komunikacji\nw celu utrudnienia analizy. Nie ma natomiast funkcjonalności wykrywania i blokady analizy w\ndebuggerach czy środowiskach wirtualnych.\n\n\n-----\n\nNa chwilę obecną szyfrowane są pliki o 933 rozszerzeniach (pełna lista rozszerzeń znajduje\nsię [tutaj). Programiści postarali się i na liście rozszerzeń, oprócz tych najpopularniejszych,](https://www.cert.pl/uploads/2016/08/cryptxxx_file_extensions.txt)\nznajdziemy również takie jak: mobilne formaty wideo, aplikacje Android APK czy projekty\nśrodowiska programistycznego Apple Xcode. Szyfrowanie następuje za pomocą kombinacji\nalgorytmów RSA i RC4. Po infekcji domeny do opłacenia okupu otrzymywane są od C&C.\n\nW wersji 5.001 wysyłany jest również moduł o nazwie fx100.dll, służący do wykradania\ndanych z przeglądarek internetowych, klientów poczty, klientów VPN czy komunikatorów.\nNiestety nie udało się go pozyskać z ostatniej wersji próbki.\n\n## Szczegóły techniczne CrypMIC\n\nW przeciwieństwie do swojego pierwowzoru CrypMIC wyróżnia sie dużo mniejszym\nskomplikowaniem – stringi nie są zaciemnione oraz nie jest wykorzystywany moduł służący\ndo kradzieży danych. Również ilość rozszerzeń szyfrowanych plików jest mniejsza – jest ich\n[„zaledwie” 901 (pełna lista rozszerzeń znajduje się tutaj). Pliki szyfrowane są za pomocą](https://www.cert.pl/uploads/2016/08/crypmic_file_extensions.txt)\nalgorytmu AES-256. Opis dotyczy wersji z dnia 05.08.16\n(MD5: 584a2227d62e9e29b770d98c4b83844d).\n\nCo ciekawe, CrypMIC potrafi wykryć uruchomienie w środowisku wirtualnym, jednak nie\nprzeszkadza mu to w szyfrowaniu plików. Warto wspomnieć również o kasowaniu kopii\nplików wykonanych za pomocą mechanizmu Volume Shadow Copy – operacja wymaga\n\n\n-----\n\npodniesienia uprawnień, co spowoduje wyświetlenie okienka z User Account Control. Nie\nudzielenie zgody w tym oknie spowoduje zablokowanie operacji i ciągłe jego wyświetlanie do\nmomentu udzielenia uprawnień.\n\n**Aktualizacja 01.09.16**\nFirma Fortinet [odnotowała również ataki CrypMIC (błędnie rozpoznany we wpisie jako](https://blog.fortinet.com/2016/08/22/cryptxxx-ransomware-emerges-for-a-slice-of-the-pie)\nCryptXXX) w wersji .exe (MD5: 7bb58c27b807d0de43de40178ca30154). Poza\nzmianą sposobu uruchamiania nie odnotowaliśmy żadnych zmian w logice działania\nransomware.\n\n## Jak sobie poradzić z ransomware?\n\nW chwili obecnej najpewniejszym sposobem odzyskania plików po zaszyfrowaniu, jest\nposiadanie ich aktualnej kopii zapasowej. W przypadku CrypMIC programiści udostępnili\nniedziałający program deszyfrujący o nazwie Microsoft Decryptor – nawet po zapłaceniu\nokupu, odzyskanie plików było niemożliwe. Oczywiście należy również pamiętać o\naktualizacjach zainstalowanego oprogramowania, systemu operacyjnego oraz sygnatur\nmalware.\n\nDla zaawansowanych użytkowników, godne polecenia są dwa programy: honeypot\n[AntiRansom, który tworzy i monitoruje fałszywe pliki pakietu Office, wykrywa procesy](https://github.com/YJesus/AntiRansom)\npróbujące je modyfikować i je zamyka (dodatkowo tworzy zrzut pamięci procesu do\n[późniejszej analizy), oraz ProcFilter wykorzystujący reguły YARA do wykrywania](https://github.com/godaddy/procfilter)\nniepożądanych procesów.\n\n\n-----\n\nW przypadku CryptXXX \\ CrypMIC infekcji są w stanie zapobiec blockery reklam i skryptów\n[(uBlock Origin,](https://chrome.google.com/webstore/detail/ublock-origin/cjpalhdlnbpafiamejdnhcphjbkeiagm?hl=en) [NoScript,](https://addons.mozilla.org/en-US/firefox/addon/noscript/) [uMatrix), włączenie w przeglądarce funkcji click-to-play oraz](https://chrome.google.com/webstore/detail/umatrix/ogfcmafjalglgifnmanfmnieipoejdcf?hl=pl)\naktualna przeglądarka i komponent Adobe Flash Player.\n\n## Hashe próbek i reguły YARA\n\nCrypMIC (05/08/16) SHA256:\n52611b0c008fe84ecd68f89b9223c4a644935e42d7b8638dffe2e27552c2321e\n\nCrypMIC (wersja EXE) SHA256:\neb72bef17b4f62a3cef6e36385cbdd65cf916f36b28d86b37b2990e2fc9e5330\n\nCryptXXX (25/07/16) SHA256:\ndc527934c6b26e65ce9cfdcd026795e978a53b7ee9a672551990ee583ed2a083\n\nrule cryptxxx : ransomware\n\n{\nmeta:\n\nauthor=\"kamilf\"\n\nstrings:\n\n$string_decryption_loop = { 8B 55 FC 0F B7 54 5A FE 33 D7 66 89 54 58 FE 43 4E 75 E5 }\n\n$dll_entry_point = { ( 4D | 58 ) 4D 53 ( 30 | 31 | 32 ) }\n\n$file_encryption_loop = { 8B 45 E4 50 8D 45 E0 50 8D 85 5F FF FF FF 50 6A ?? 6A ?? 6A\n?? }\n\n$ransom_wallpaper_creation = { 8D 45 ?? 50 6A ?? 8D 85 [4] 50 8B [2] 50 E8 [4] 89 45 ??\n33 D2 55 68 [4] 64 FF 32 64 89 22 8B 45 ?? 50 }\n\ncondition:\n\n3 of ($string_decryption_loop, $dll_entry_point, $file_encryption_loop,\n$ransom_wallpaper_creation)\n\n}\n\nrule crypmic : ransomware\n\n{\nmeta:\n\nauthor=\"kamilf\"\n\nstrings:\n\n$vss_removal_tool = \"vssadmin\" wide\n\n$ransom_note_loop = { 8A 8A [4] 88 0C 10 42 81 FA [4] 72 EE }\n\n$readme_file_loop = { 8D 40 01 66 89 0C 17 8D 14 00 33 DB 0F B7 8A [4] 66 3B D9 }\n\n$victim_id = { F3 0F 7E 05 [4] A0 [4] 8B 96 [4] 66 0F [4] F3 0F 7E 05 [4] 66 0F [4] }\n\ncondition:\n\n2 of ($ransom_note_loop, $vss_removal_tool, $readme_file_loop, $victim_id)\n\n\n-----\n\n}\n\n\n-----",
    "language": "PL",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-08-10 - CryptXXX - CrypMIC – intensywnie dystrybuowany ransomware w ramach exploit-kitów.pdf"
    ],
    "report_names": [
        "2016-08-10 - CryptXXX - CrypMIC – intensywnie dystrybuowany ransomware w ramach exploit-kitów.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535875,
    "ts_updated_at": 1743041148,
    "ts_creation_date": 1653700766,
    "ts_modification_date": 1653700766,
    "files": {
        "pdf": "https://archive.orkl.eu/29920ac8a632cfa83696ec600bb10884977f58c3.pdf",
        "text": "https://archive.orkl.eu/29920ac8a632cfa83696ec600bb10884977f58c3.txt",
        "img": "https://archive.orkl.eu/29920ac8a632cfa83696ec600bb10884977f58c3.jpg"
    }
}