{
    "id": "89f5465f-5708-49d6-8998-b86693603e1b",
    "created_at": "2023-02-02T02:08:06.128083Z",
    "updated_at": "2025-03-27T02:10:10.67221Z",
    "deleted_at": null,
    "sha1_hash": "ae78e935bc8ce7fe741c48cd06fa42deb80ab7e5",
    "title": "2022-11-17 - DEV-0569 finds new ways to deliver Royal ransomware, various payloads",
    "authors": "",
    "file_creation_date": "2023-02-01T07:43:31Z",
    "file_modification_date": "2023-02-01T07:43:31Z",
    "file_size": 388591,
    "plain_text": "# DEV-0569 finds new ways to deliver Royal ransomware, various payloads\n\n**microsoft.com/en-us/security/blog/2022/11/17/dev-0569-finds-new-ways-to-deliver-royal-ransomware-various-**\npayloads/\n\nNovember 17, 2022\n\nRecent activity from the threat actor that Microsoft tracks as DEV-0569, known to distribute\nvarious payloads, has led to the deployment of the Royal ransomware, which first emerged\nin September 2022 and is being distributed by multiple threat actors. Observed DEV-0569\nattacks show a pattern of continuous innovation, with regular incorporation of new discovery\ntechniques, defense evasion, and various post-compromise payloads, alongside increasing\nransomware facilitation.\n\nDEV-0569 notably relies on malvertising, phishing links that point to a malware downloader\nposing as software installers or updates embedded in spam emails, fake forum pages, and\nblog comments. In the past few months, Microsoft security researchers observed the\nfollowing tweaks in the group’s delivery methods:\n\nUse of contact forms on targeted organizations’ websites to deliver phishing links\nHosting fake installer files on legitimate-looking software download sites and legitimate\nrepositories to make malicious downloads look authentic to targets, and\nExpansion of their malvertising technique by using Google Ads in one of their\ncampaigns, effectively blending in with normal ad traffic\n\nThese methods allow the group to potentially reach more targets and ultimately achieve their\ngoal of deploying various post-compromise payloads. DEV-0569 activity uses signed binaries\nand delivers encrypted malware payloads. The group, also known to rely heavily on defense\nevasion techniques, has continued to use the open-source tool Nsudo to attempt disabling\nantivirus solutions in recent campaigns.\n\nIn this blog we share details of DEV-0569’s tactics, techniques, and procedures (TTPs) and\nobserved behavior in recent campaigns, which show that DEV-0569 will likely continue\nleveraging malvertising and phishing for initial access. We also share preventive measures\nthat organizations can adopt to thwart DEV-0569’s delivery methods involving malicious links\nand phishing emails using solutions like Microsoft Defender SmartScreen and Microsoft\nDefender for Office 365, and to reduce the impact of the group’s follow-on activities.\nMicrosoft Defender for Endpoint detects the DEV-0569 behavior discussed in this blog,\nincluding the code signing certificates in use and the attempts to disable Microsoft Defender\nAntivirus.\n\n\n-----\n\nMicrosoft uses DEV-#### designations as a temporary name given to an unknown,\nemerging, or developing cluster of threat activity, allowing Microsoft to track it as a unique set\nof information until we can reach high confidence about the origin or identity of the actor\nbehind the activity. Once it meets defined criteria, a DEV group is converted to a named\nactor.\n\n## DEV-0569 attack chain: Delivery tactics tweaked\n\nDEV-0569 has multiple methods for delivery of their initial payload. In some cases, DEV0569 payloads are delivered via phishing campaigns run by other malicious actors that offer\ndelivery of malware payloads as a service.\n\nHistorical observation of typical DEV-0569 attack begins with malicious links delivered to\ntargets via malicious ads, fake forum pages, blog comments, or through phishing emails.\nThese links lead to malicious files signed by the attacker using a legitimate certificate. The\nmalicious files, which are malware downloaders known as BATLOADER, pose as installers\nor updates for legitimate applications like Microsoft Teams or Zoom. When launched,\nBATLOADER uses MSI Custom Actions to launch malicious PowerShell activity or run batch\nscripts to aid [in disabling security solutions and lead to the delivery of various encrypted](https://www.microsoft.com/security/blog/2022/04/13/dismantling-zloader-how-malicious-ads-led-to-disabled-security-tools-and-ransomware/)\nmalware payloads that is decrypted and launched with PowerShell commands.\n\n### Posing as legitimate software download sites\n\nFrom August to October 2022, Microsoft observed DEV-0569 activity where BATLOADER,\ndelivered via malicious links in phishing emails, posed as legitimate installers for numerous\napplications like TeamViewer, Adobe Flash Player, Zoom, and AnyDesk. BATLOADER was\nhosted on attacker-created domains posing as legitimate software download sites\n(anydeskos[.]com, for example) and on legitimate repositories like GitHub and OneDrive.\nMicrosoft takes down verified malicious content from these repositories as they are found or\nreported.\n\n\n-----\n\n_Figure 1. DEV-0569 activity seen in September 2022, where the landing site hosted_\n_BATLOADER posing as a TeamViewer installer_\n\n### Use of VHD file formats\n\nAside from using installer files, Microsoft has also observed the use of file formats like Virtual\nHard Disk (VHD) impersonating legitimate software for first-stage payloads. These VHDs\nalso contain malicious scripts that lead to the download of DEV-0569’s malware payloads.\n\n### PowerShell and batch scripts for downloading\n\nDEV-0569 has used varied infection chains using PowerShell and batch scripts that\nultimately led to the download of malware payloads like information stealers or a legitimate\nremote management tool used for persistence on the network. The management tool can\nalso be an access point for the staging and spread of ransomware.\n\n### NSudo to disable antivirus solutions\n\nDEV-0569 also continues to tamper with antivirus products. In September and October 2022,\nMicrosoft saw activity where DEV-0569 used the open-source NSudo tool to attempt\ndisabling antivirus solutions.\n\n\n-----\n\n_Figure 2. High-level view of observed DEV-0569 infection chains between August to October_\n_2022_\n\n### September 2022: Adopting contact forms to gain access to targets and deliver information stealers\n\nIn September 2022, Microsoft observed a campaign using contact forms to deliver DEV-0569\npayloads. Using contact forms on public websites to distribute malware has been seen in\n[other campaigns, including IcedID malware. Attackers use this technique as a defense](https://www.microsoft.com/en-us/security/blog/2021/04/09/investigating-a-unique-form-of-email-delivery-for-icedid-malware/)\nevasion method since contact forms can bypass email protections and appear trustworthy to\nthe recipient.\n\nIn this campaign, DEV-0569 sent a message to targets using the contact form on these\ntargets’ websites, posing as a national financial authority. When a contacted target responds\nvia email, DEV-0569 replied with a message that contained a link to BATLOADER. Microsoft\nDefender for Office 365 detects the spoofing behavior as well as the malicious links in these\nemails.\n\nThe malicious links in the contact forms led to BATLOADER malware hosted on abused web\nservices like GitHub and OneDrive. The installers launched a PowerShell script that issued\nmultiple commands, including downloading a NirCmd command-line utility provided by\nfreeware developer NirSoft:\n```\nnircmd elevatecmd exec hide \"requestadmin.bat\"\n\n```\nIf successful, the command allows the attacker to elevate from local admin to SYSTEM\nrights, similar to executing a scheduled task as SYSTEM.\n\n\n-----\n\nThe PowerShell script also delivered additional executables from a remote website (e.g.,\n_updateea1[.]com), including an AES-encrypted Gozi banking trojan and the information_\nstealer known as Vidar Stealer, which used Telegram to receive command and control (C2)\ninformation. DEV-0569 frequently diversifies their payloads and has shifted from delivering\nZLoader at the beginning of 2022, possibly in response to disruption efforts against Zloader\nin April 2022.\n\n### September 2022: Deploying Royal ransomware\n\nMicrosoft identified instances involving DEV-0569 infection chains that ultimately facilitated\nhuman-operated ransomware attacks distributing Royal ransomware. Based on tactics\nobserved by Microsoft, ransomware attackers likely gained access to compromised networks\nvia a BATLOADER-delivered Cobalt Strike Beacon implant.\n\nDEV-0569’s widespread infection base and diverse payloads likely make the group an\nattractive [access broker for ransomware operators.](https://www.microsoft.com/en-us/security/blog/2022/05/09/ransomware-as-a-service-understanding-the-cybercrime-gig-economy-and-how-to-protect-yourself/)\n\n### October 2022: Leveraging Google Ads to deliver BATLOADER selectively\n\nIn late October 2022, Microsoft researchers identified a DEV-0569 malvertising campaign\nleveraging Google Ads that point to the legitimate traffic distribution system (TDS) Keitaro,\nwhich provides capabilities to customize advertising campaigns via tracking ad traffic and\nuser- or device-based filtering. Microsoft observed that the TDS redirects the user to a\nlegitimate download site, or under certain conditions, to the malicious BATLOADER\ndownload site. Microsoft reported this abuse to Google for awareness and consideration for\naction.\n\nUsing Keitaro, DEV-0569 can use traffic filtering provided by Keitaro to deliver their payloads\nto specified IP ranges and targets. This traffic filtering can also aid DEV-0569 in avoiding IP\nranges of known security sandboxing solutions.\n\n## Defending against DEV-0569\n\nDEV-0569 will likely continue to rely on malvertising and phishing to deliver malware\n[payloads. Solutions such as network protection and Microsoft Defender SmartScreen can](https://learn.microsoft.com/windows/security/threat-protection/microsoft-defender-smartscreen/microsoft-defender-smartscreen-overview)\n[help thwart malicious link access. Microsoft Defender for Office 365 helps guard against](https://www.microsoft.com/security/business/siem-and-xdr/microsoft-defender-office-365)\nphishing by inspecting the email body and URL for known patterns. Since DEV-0569’s\n[phishing scheme abuses legitimate services, organizations can also leverage mail flow rules](https://learn.microsoft.com/exchange/security-and-compliance/mail-flow-rules/manage-mail-flow-rules)\nto capture suspicious keywords or review broad exceptions, such as those related to IP\n[ranges and domain-level allow lists. Enabling Safe Links for emails, Microsoft Teams, and](https://learn.microsoft.com/microsoft-365/security/office-365-security/safe-links?view=o365-worldwide)\nOffice Apps can also help address this threat.\n\nDefenders can also apply the following mitigations to reduce the impact of this threat:\n\n\n-----\n\nEncourage users to use Microsoft Edge and other web browsers that support\nSmartScreen, which identifies and blocks malicious websites, including phishing sites,\nscam sites, and sites that contain exploits and host malware. Turn on network\nprotection to block connections to malicious domains and IP addresses.\nBuild organizational resilience against email threats by educating users about\nidentifying social engineering attacks and preventing malware infection. Use Attack\nsimulation training in Microsoft Defender for Office 365 to run attack scenarios,\nincrease user awareness, and empower employees to recognize and report these\nattacks.\nPractice the principle of least-privilege and maintain credential hygiene. Avoid the use\nof domain-wide, admin-level service accounts. Restricting local administrative\nprivileges can help limit installation of RATs and other unwanted applications.\nTurn on [cloud-delivered protection and automatic sample submission on Microsoft](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/enable-cloud-protection-microsoft-defender-antivirus?view=o365-worldwide)\nDefender Antivirus. These capabilities use artificial intelligence and machine learning to\nquickly identify and stop new and unknown threats.\nTurn on [tamper protection features to prevent attackers from stopping security](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/prevent-changes-to-security-settings-with-tamper-protection?view=o365-worldwide)\nservices.\n\n[Microsoft Defender customers can turn on attack surface reduction rules to prevent common](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/attack-surface-reduction?view=o365-worldwide)\nattack techniques used in ransomware attacks:\n\n## Detection details\n\n Microsoft Defender Antivirus\n\nMicrosoft Defender Antivirus detects threat components as the following malware:\n\nNSudo activity is detected by the tamper protection capability as:\n\nNsudo file drop\nNsudo runtime\nNsudo AV tampering commandline\n\n## Microsoft Defender for Endpoint\n\nAlerts with the following titles in the security center can indicate threat activity on your\nnetwork:\n\nRansomware-linked DEV-0569 activity group\n\nWhile the following alerts might indicate activity associated with this threat, they could also\nbe triggered by unrelated threat activity:\n\n\n-----\n\nRansomware-linked DEV-0858 activity group\nCobalt Strike activity detected\nCobalt Strike activity observed\nCobalt Strike artifact observed\nCobalt Strike attack tool\nCobalt strike named pipes\n‘Vidar’ credential theft malware was detected\n‘VidarStealer’ malware was detected\n‘Gozi’ malware was detected\nAn active ‘Nsudo’ hacktool in a command line was detected while executing\nAn active ‘NSudo’ hacktool process was detected while executing\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-11-17 - DEV-0569 finds new ways to deliver Royal ransomware, various payloads.pdf"
    ],
    "report_names": [
        "2022-11-17 - DEV-0569 finds new ways to deliver Royal ransomware, various payloads.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cf4d333d-ef79-40aa-b233-886e6de875a3",
            "created_at": "2023-12-08T02:00:05.754609Z",
            "updated_at": "2025-03-27T02:00:03.266797Z",
            "deleted_at": null,
            "main_name": "DEV-0569",
            "aliases": [
                "Storm-0569"
            ],
            "source_name": "MISPGALAXY:DEV-0569",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1675303686,
    "ts_updated_at": 1743041410,
    "ts_creation_date": 1675237411,
    "ts_modification_date": 1675237411,
    "files": {
        "pdf": "https://archive.orkl.eu/ae78e935bc8ce7fe741c48cd06fa42deb80ab7e5.pdf",
        "text": "https://archive.orkl.eu/ae78e935bc8ce7fe741c48cd06fa42deb80ab7e5.txt",
        "img": "https://archive.orkl.eu/ae78e935bc8ce7fe741c48cd06fa42deb80ab7e5.jpg"
    }
}