{
    "id": "40034e2c-5da9-4ce4-bae3-08d6722a347b",
    "created_at": "2023-01-12T15:02:13.151246Z",
    "updated_at": "2025-03-27T02:15:35.560733Z",
    "deleted_at": null,
    "sha1_hash": "62dfdd1348b01e5bf586b3c0a692e9c4bae19efe",
    "title": "2016-07-26 - Threat Actors Using Legitimate PayPal Accounts To Distribute Chthonic Banking Trojan",
    "authors": "",
    "file_creation_date": "2022-05-28T17:45:44Z",
    "file_modification_date": "2022-05-28T17:45:44Z",
    "file_size": 717364,
    "plain_text": "# Threat Actors Using Legitimate PayPal Accounts To Distribute Chthonic Banking Trojan\n\n**[proofpoint.com/us/threat-insight/post/threat-actors-using-legitimate-paypal-accounts-to-distribute-chthonic-banking-trojan](https://www.proofpoint.com/us/threat-insight/post/threat-actors-using-legitimate-paypal-accounts-to-distribute-chthonic-banking-trojan)**\n\nJuly 26, 2016\n\nJuly 26, 2016\n\n**_Updated August 2, 2016, to reflect new information a bout the malware referenced in this post; additional details_**\n**_added at the bottom._**\n\nWhile many email providers, clients, and anti-spam engines have become adept at detecting spam, malicious messages\nsent via high-profile, legitimate providers are much harder to catch. Threat actors continue to look for new ways to bypass\nthese engines and, in the latest example of innovative approaches to malware distribution, have managed to co-opt\nPayPal services in a small campaign.\n\nProofpoint analysts recently noticed an interesting abuse of legitimate service in order to deliver malicious content.\nSpecifically, we observed emails with the subject “You’ve got a money request” that came from PayPal. The sender does\nnot appear to be faked: instead, the spam is generated by registering with PayPal (or using stolen accounts) and then\n\n\n-----\n\nusing the portal to request money. We are not sure how much of this process was automated and how much manual,\nbut the email volume was low.\n\n_Figure 1: Email delivering malicious content_\n\nAlthough the actual email address is obscured in Figure 1, this message was sent to a Gmail inbox. Gmail failed to block\nthe email since it appears legitimate. PayPal’s money request feature allows adding a note along with the request, where\nthe attacker crafted a personalized message and included a malicious URL. In a double whammy, the recipient here can\nfall for the social engineering and lose $100, click on the link and be infected with malware, or both.\n\nIf the user does click on the Goo.gl link, they are redirected to katyaflash[.]com/pp.php, which downloads an obfuscated\nJavaScript file named paypalTransactionDetails.jpeg.js to the user’s system. If the user then opens the JavaScript file, it\ndownloads an executable from wasingo[.]info/2/flash.exe. This executable is Chthonic, a variant of the Zeus banking\nTrojan. The command and control (C&C) for this instance is kingstonevikte[.]com. The following screenshot more clearly\nillustrates the sequence of events:\n\n_Figure 2: Network traffic generated starting with user clicking on the malicious URL and opening the downloaded_\n_JavaScript_\n\nIt is also interesting that Chthonic downloads a second-stage payload, a previously undocumented malware “AZORult”\nwhich we are currently investigating:\n\n\n-----\n\n_Figure 3: Logo used internally by the AZORult module_\n\n**Conclusion**\n\nAlthough the scale of this campaign appeared to be relatively small (this particular example was only detected through\none of our spamtraps; as of the writing of this blog, the malicious link has only been clicked 27 times according to Google\nAnalytics for the URL shortener), the technique is both interesting and troubling. For users without anti-malware services\nthat can detect compromised links in emails and/or phone homes to a C&C, the potential impact is high. At the same\ntime, the combined social engineering approach of requesting money via PayPal from what appears to be a legitimate\nsource creates additional risk for untrained or inattentive recipients, even if they are not infected with the malicious\npayload.\n\nPayPal has been notified of this particular abuse of service but this represents yet another technique threat actors can\nuse to bypass traditional defenses, regardless of the specific provider.\n\n**Indicators of Compromise (IOC’s)**\n\n\n**IOC** **IOC**\n**Type**\n\n\n**Description**\n\n\n\n[hxxp://goo[.]gl/G7z1aS?paypal-nonauthtransaction.jpg] URL URL in the email message\n\n[hxxp://katyaflash[.]com/pp.php] URL URL after the goo.gl redirect\n(hosting the js)\n\n865d2e9cbf5d88ae8b483f0f5e2397449298651381f66c55b7afd4b750eb4da4 SHA256 paypalTransactionDetails.jpeg.js\n\n[hxxp://wasingo[.]info/2/flash.exe] URL JavaScript payload\n\n0d2def167ecf39a69a7e949c88bb2096cfd76f7d4bf72f1b0fe27a9da686c141 SHA256 flash.exe\n\n\n-----\n\nkingstonevikte[.]com Domain Chthonic C&C\n\n[hxxp://www.viscot[.]com/system/helper/bzr.exe] URL Chthonic 2nd Stage hosting\n\n10d159b0ddb92e9f4b395e90f9cfaa554622c4e77f66f7da176783777db5526a SHA256 Chthonic 2nd Stage (AZORult)\n\n[91.215.154[.]202/AZORult/gate.php] URL AZORult C&C\n\n_Select ET Signatures that would fire on such traffic:_\n\n2810099 || ETPRO TROJAN Chthonic CnC Beacon\n\n2811901 || ETPRO TROJAN Chthonic CnC Beacon\n\n2821358 || ETPRO TROJAN Win32/Zbot Variant Checkin\n\n**_The information below was added based on additional background research conducted by Proofpoint analysts._**\n\nOn July 31, Proofpoint researchers discovered an advertisement in an underground forum for the AZORult information\nstealer. This was the second-stage payload that Chthonic delivered to infected machines. The original ad in mixed\nRussian and English appears on top with our translation below:\n\n**_Original Ad_**\n\n[AZORult - Passwords, cookies, bitcoin, desktop files, etc stealer]\n\nМногофункциональный стиллер.\n\nФункционал:\n\n- Stealer сохраненных паролей из следующих программ(browsers, email, ftp, im):\n\nСпойлер\n\nGoogle Chrome\n\nGoogle Chrome x64\n\nYandexBrowser\n\nOpera\n\nMozilla Firefox\n\nInternetMailRu\n\nComodoDragon\n\nAmigo\nBromium\n\nChromium\n\nOutlook\n\nThunderbird\n\nFilezilla\n\nPidgin\n\nPSI\n\nPSI Plus\n\n- Stealer cookies(Стиллер куков) из браузеров + данные автозаполнения форм(formhistory, autofill)\n\nПоддерживаемые браузеры:\n\nСпойлер\n\nGoogle Chrome\n\nGoogle Chrome x64\n\nYandexBrowser\n\nOpera\n\nMozilla Firefox\n\n\n-----\n\nInternetMailRu\nComodoDragon\nAmigo\nBromium\nChromium\n\nКуки в следующем формате, для удобного экспорта(Netscape cookie file format):\nСпойлер\n\nInstagram[.]com  FALSE   /  FALSE   11129062731157896   csrftoken ebc08a134952abc6a5c36fb54c1aaaa\n.microsoft[.]com  TRUE /  FALSE   13140111158000000 TocPosition   1\nwww.searchengines[.]ru FALSE   /  FALSE   11138811175911879   OAИCAP  640.1\nvsokovikov.narod[.]ru  FALSE   /  FALSE   11168272384aaa000   __utma\n1.211136481.14511109932.14658111726.1496725111.1\nvsokovikov.narod[.]ru  FALSE   /  FALSE   13111168384000111   __utmz   1.1250111526.1.1.utmcsr=\n(direct)|utmccn=(direct)|utmcmd=(none)\n\n- Bitcoin clients files\nСобирает файлы wallet.dat популярных биткоин клиентов (bitcoin, litecoin, etc)\n\n- Skype message history.\nГрабит файл с базой данных переписки. Файл читается специальными утилитами.\n\n- Desktop files grabber.\nСобирает файлы указанных расширений с рабочего стола. Фильтр по размеру файла. Также рекурсивно ищет\nфайлы во вложенных папках.\n\n- Список установленных программ.\n\n- Список запущенных процессов.\n\n- Username, compname, OS, RAM\n\nНеобходимый функционал можно включать/выключать в админке.\n\nВ админке просматривается список поступивших отчетов, список сохраненных паролей из этих отчетов. Фильтры\nпо дате, по типу паролей, поиск по базе.\nОстальные данные сохраняются в zip архив(отдельный для каждого отчета). Данные в архиве разложны по\nпапкам. В архиве хранятся все данные, в админке только список отчетов и пароли.\n\nСпойлер\n\n[]Browsers\n-[]Autocomplete\n--Google_Chrome_Default.txt\n-[]Cookies\n--Google_Chrome_Default.txt\n--MozillaFirefox_tpsasn.default-111340945411.txt\n\n[]Coins\n-[]Bitcoin\n--wallet.dat\n-[]Litecoin\n--wallet.dat\n...\nInfo.txt\nPasswords.txt\nProcess.txt\nProgramms.txt\n\n\n-----\n\nСофт поставляется в виде:\n.EXE - при запуске собирается необходимая инфа и отправляется на сервер\n.DLL - при подгрузке dll (DLL_PROCESS_ATTACH) собирается необходимая инфа и отправляется на сервер\n.DLL(thread) - при подгрузке dll (DLL_PROCESS_ATTACH) создается отдельный поток, в котором производится\nнеобходимая работа(собирается необходимая инфа и отправляется на сервер). Например для использования как\nплагина для популярных лоадеров.\n\nСкриншоты:\nСпойлер\n\n[Screenshots linked in the original ad – displayed here]\n\n\n-----\n\n-----\n\nЦена: $100\nРебилд: $30\n\nСвязь(jabber): [Redacted]@exploit[.]im\n\n**************************************\n\n**_Translation:_**\n\n[AZORult - Passwords, cookies, bitcoin, desktop files, etc stealer]\nMultifunctional Stealer.\nFunctions:\n\n- Stealer of saved passwords from following programs (browsers, email, ftp, im):\nGoogle Chrome\nGoogle Chrome x64\nYandexBrowser\nOpera\nMozilla Firefox\nInternetMailRu\nComodoDragon\nAmigo\nBromium\nChromium\nOutlook\nThunderbird\nFilezilla\nPidgin\nPSI\nPSI Plus\n\n\n-----\n\nStealer of cookies from browsers and forms (form history, autofill)\nSupported Browsers:\nGoogle Chrome\nGoogle Chrome x64\nYandexBrowser\nOpera\nMozilla Firefox\nInternetMailRu\nComodoDragon\nAmigo\nBromium\nChromium\n\nCookies are in following format, for easy export (Netscape cookie file format):\ninstagram[.]com FALSE /\nFALSE 11129062731157111\ncsrftoken yyyc08a1349526c46a5c36fb54c1ayyy\n.microsoft[.]com TRUE /\nFALSE 11140260158000111\nTocPosition 1\nwww.searchengines[.]ru FALSE /\nFALSE 11138826175965111\nOAИCAP 111.1\nvsokovikov.narod[.]ru FALSE /\nFALSE 11168272384000111\n__utma 1.111136481.1458509111.1465826111.1496725111.1\nvsokovikov.narod[.]ru FALSE /\nFALSE 13120968384000111\n__utmz 1.1110722526.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)\n\n- Bitcoin clients files\nCollects wallet.dat files from popular bitcoin clients (bitcoin, litecoin, etc)\n\n- Skype message history.\nGrabs files from chat history. Files are read with special utilities.\n\n- Desktop files grabber.\nCollects files with specified extensions from Desktop. Filter by file size. Recursively searches files in folders.\n\n- List of installed programs\n\n- List of running processes\n\n- Username, compname, OS, RAM\n\nNecessary functions that can be turned on and of in admin panel\n\nThe admin panel has a list of received reports, list of saved passwords from those reports. Has filters by date, type of\npassword, search in the base.\nThe rest of data from reports is save as a zip aarchive, different one for each report. The data is sorted into folders. The\narchive contains all data, while the admin panel only list of reports and passwords.\n\n[]Browsers\n-[]Autocomplete\n--Google_Chrome_Default.txt\n-[]Cookies\n--Google_Chrome_Default.txt\n--MozillaFirefox_tpasdn.default-111140945111.txt\n\n[]Coins\n\n\n-----\n\n[]Bitcoin\n--wallet.dat\n-[]Litecoin\n--wallet.dat\n...\nInfo.txt\nPasswords.txt\nProcess.txt\nProgramms.txt\n\nSoftware is delivered as:\n.EXE - when started, collects necessary info and sends to server\n.DLL - when started the dll (DLL_PROCESS_ATTACH) collects necessary info and sends to server\n.DLL(thread) - when started dll (DLL_PROCESS_ATTACH) creates a new thread which does the work (collects\nnecessary info and sends to server)\n\nPrice: $100\nRebuild: $30\n\nContact(jabber): [Redacted]@exploit[.]im\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-07-26 - Threat Actors Using Legitimate PayPal Accounts To Distribute Chthonic Banking Trojan.pdf"
    ],
    "report_names": [
        "2016-07-26 - Threat Actors Using Legitimate PayPal Accounts To Distribute Chthonic Banking Trojan.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535733,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1653759944,
    "ts_modification_date": 1653759944,
    "files": {
        "pdf": "https://archive.orkl.eu/62dfdd1348b01e5bf586b3c0a692e9c4bae19efe.pdf",
        "text": "https://archive.orkl.eu/62dfdd1348b01e5bf586b3c0a692e9c4bae19efe.txt",
        "img": "https://archive.orkl.eu/62dfdd1348b01e5bf586b3c0a692e9c4bae19efe.jpg"
    }
}