{
    "id": "6ada5d5f-bdcf-47bc-9c33-55b6aeb19145",
    "created_at": "2023-01-12T15:10:25.871406Z",
    "updated_at": "2025-03-27T02:05:51.732609Z",
    "deleted_at": null,
    "sha1_hash": "0fe76993a85081f06edd3e797f25daa388340902",
    "title": "2016-12-20 - New Linux-Rakos threat- devices and servers under SSH scan (again)",
    "authors": "",
    "file_creation_date": "2022-05-28T04:00:32Z",
    "file_modification_date": "2022-05-28T04:00:32Z",
    "file_size": 322839,
    "plain_text": "# New Linux/Rakos threat: devices and servers under SSH scan (again)\n\n**welivesecurity.com/2016/12/20/new-linuxrakos-threat-devices-servers-ssh-scan/**\n\nDecember 20, 2016\n\nESET’s Peter Kálnai and Michal Malik report on a new Linux/Rakos threat – devices and servers are under SSH scan again.\n\nApparently, frustrated users complain more often recently on various forums about their embedded devices being overloaded with\ncomputing and network tasks. What these particular posts have in common is the name of the process causing the problem. It is\nexecuted from a temporary directory and disguised as a part of the Java framework, namely “.javaxxx”. Additional names like\n“.swap” or “kworker” are also used. A few weeks ago, we discussed the recent Mirai incidents and Mirai-connected IoT security\n[problems in The Hive Mind: When IoT devices go rogue and all that was written then still holds true.](http://www.welivesecurity.com/2016/10/26/hive-mind-iot-devices-go-rogue/)\n\n## Attack vector\n\nThe attack is performed via brute force attempts at SSH logins, in a similar way to that in which many Linux worms operate,\n[including Linux/Moose (which spread by attacking Telnet logins) – also referenced here – as analyzed by ESET since last year. The](http://www.welivesecurity.com/wp-content/uploads/2015/05/Dissecting-LinuxMoose.pdf)\ntargets include both embedded devices and servers with an open SSH port and where a very weak password has been set. The\nobvious aim of this trojan is to assemble a list of unsecured devices and to have an opportunity to create a botnet consisting of as\nmany zombies as possible. The scan starts with not too extensive list of IPs and spreads incrementally to more targets. Only\nmachines that represent low-hanging fruit from the security perspective are compromised. Note that victims reported cases when\nthey had had a strong password but they forgot their device that had online service enabled and it was reverted to a default\npassword after a factory reset. Just a couple of hours of online exposure was enough for such a reset machine to end up\ncompromised!\n\n## Analysis\n\nThe malware is written in the Go language and the binary is usually compressed with the standard UPX tool. The awkward thing\nwas that the function names were stripped from the binary in the usual way, but they are still present in a special section anyway.\nWith the help of a script by [RedNaga Security that maps symbols back to their respective function in the IDA Pro disassembling](http://rednaga.io/2016/09/21/reversing_go_binaries_like_a_pro/)\nsoftware, the whole analysis was simplified to reviewing the features that function names suggested, like main_loadConfig,\nmain_startLocalHttp, main_Skaro_Upgrade, main_IPTarget_checkSSH etc. There are strings like “Skaro” and “dalek” in the binary.\nThe author(s) possibly had in mind a connection to a fictional planet in the science fiction television series Doctor Who from whence\nthe Daleks originated.\n\n[As a first step, [Linux/]Rakos loads its configuration via standard input (stdin) in YAML format. The configuration file contains](http://yaml.org/)\ninformation like lists of C&Cs, all the credentials that are tried against its targets, and internal parameters:\n\n\n-----\n\n—\nversion: 30\n\nlogging: no\n\ngeneration: 0\n\nskaro:\n\nips:\n\n– “193.0.178.151”\n\n– “46.8.44.55”\n\n– “5.34.183.231”\n\n– “185.82.216.125”\n\n– “195.123.210.100”\nping: 60\n\ncheckers:\n\n– “http://193.0.178.151”\n– “http://46.8.44.55”\n\n– “http://5.34.183.231”\n\n– “http://185.82.216.125”\n\n– “http://195.123.210.100”\n\n– “http://httpbin.org/ip”\n\nuserpass: [\n\n“root:qwerty”,\n\n“user:admin”,\n\n“ubnt:ubnt”,\n\n“root:12345”,\n\n\n“guest:1234”,\n\n“root:1111”,\n\n“test:test”,\n\n“support:password”,\n\n“admin:1”,\n\n“test:test123”,\n\n“manager:manager”,\n\n“fax:fax”,\n\n“service:service”,\n\n“root:letmein”,\n\n“sales:sales”,\n\n“guest:guest”,\n\n“shell:sh”,\n“enable:system”,\n\n“user:password”,\n\n“backup:backup”,\n\n“ftpuser:ftpuser”,\n\n“admin:password123”,\n\n“monitor:monitor”,\n\n“bin:bin”,\n\n“root:ikwb”,\n\n“admin:manager”,\n\n“oracle:oracle”,\n\n“test:12345”,\n\n“bob:bob”,\n\n“user1:1234”,\n\n“root:1234”,\n\n“root:system”,\n\nPlcmSpIp:PlcmSpIp”,\n\n\n“user1:123456”,\n\n“1:1”,\n“root:1”,\n\n“support:123456”,\n\n“nagios:nagios”,\n\n“demo:demo”,\n\n“admin:1111”,\n\n“PlcmSpIp:PlcmSpIp”,\n\n“pos:pos”,\n\n“support:12345”,\n\n“root:baseball”,\n\n“guest:12345”,\n\n“admin:1234”,\n\n“apache:apache”,\n\n“root:123456”,\n\n“adam:adam”,\n\n“root:alpine”,\n\n“tester:retset”,\n\n“root:raspberry”,\n\n“pi:raspberry”,\n\n“administrator:1234”,\n\n“admin:abc123”,\n\n“admin:qwerty”,\n\n“root:openelec”,\n\n“admin:admin1234”,\n\n“shipping:shipping”,\n\n“ftpuser:asteriskftp”,\n\n“operator:operator”,\n\n]\n\n\nThe full plain text Linux/Rakos configuration is available on ESET’s Github: [https://github.com/eset/malware-ioc/tree/master/rakos.](https://github.com/eset/malware-ioc/tree/master/rakos)\n\nFollowing this, it starts a local HTTP service available at http://127.0.0.1:61314. There are two reasons why this is installed: the first\nis as a cunning method for the future versions of the bot to kill the running instances regardless of their name by requesting\nhttp://127.0.0.1:61314/et; second, it tries to parse a URL query for parameters “ip”, “u”, “p” by requesting http://127.0.0.1:61314/ex.\nThe purpose of this /ex HTTP resource is still unclear at the time of writing and it seems not to be referenced elsewhere in the code.\n\nThe bot also creates a web server listening on all interfaces. In the early versions, it was listening on TCP port 13666, but now the\nport is picked randomly from 20,000 to 60,000. Sending a remote request to the device on this port returns the response …\n\n{“origin”:”192.168.18.1″}\n\n[… where the IP address corresponds to the client side. This output is in the same format as the public test server http://httpbin.org](http://httpbin.org/ip)\nwith /ip request. On the side running Linux/Rakos, one might see the following logged to stdout:\n\n“{2016/11/21 09:02:03 INFO StartChecker.func1 ▶ 001 check: 192.168.18.1}”\n\nNext, it sends an initial HTTP request containing important information about the victim device to https://{C&C}/ping. The data sent\nmay appear as follows (some fields have been edited):\n\n\n-----\n\n{\n“arch”: “amd64”,\n\n“config”: 30,\n\n“fork”: 0,\n\n“generation”: 0,\n\n“ip”: “192.168.18.1”,\n\n“origin”: “unknown”,\n\n“password”: “shipping”,\n\n“services:”: {“http”:{“addr”:”192.168.18.1:80″,”available”:false,”running”:false},\n\n“dns”:{“addr”:””,”available”:false,”running”:false},\n\n“checker”:{“addr”:”192.168.18.1:22418″,”available”:false,”running”:true}},\n\n“stats”: {\n\n“cnt”: “load: 0 scan: 0 bless: 0 sm:0 ins: 0 mem: 2692k”,\n\n“cpu”: “1 x Intel(R) Core(TM) i7-4790 CPU @ 3.60GHz 3591Mhz”,\n\n“facts”: “host: ubuntu pid: 10219 uid: 0 args: [/tmp/.javaxxx]”,\n\n“load”: “1.14 0.45 0.17”,\n\n“mem”: “592MB / 1983MB free (35.21% used)”},“uptime”: 514,\n\n“username”: “shipping”,\n\n“uuid”: “ab-97-b1-d5-2d-8f”,\n\n“version”: 706\n\n}\n\nThe main feature of this bot is its scanning of the SSH service on various IP addresses, which are obtained from the C&C server by\nasking for the list located at https://{C&C}/scan. This list seems to be modified frequently. The previous versions of the trojan also\nscanned for the SMTP service, but the attackers have disabled this feature in current build. We speculate that this feature might be\nunder further development together with additional network scanning features.\n\nThe main attack is performed as follows: if one of the username:password pairs from the configuration file results in a successful\nlogin to one of the target devices connection to target is successful, two commands are run on that newly-accessed victim (id,\nuname -m), and other checks are performed and their results reported. Finally the binary checks whether if it is possible to upload\nto the new victim and does so if the answer is affirmative. We simulated an attack locally with two targets picked, 127.0.0.1 and\n127.0.0.100 (originally, the attackers try 200 simultaneous targets every 10 seconds). Suppose the bot fails to connect to the first\none which it then marks as FORGET, while the latter one is successful with the INSTALL notice (a SSH connection was established\nwith the correct shipping:shipping login credentials; also note that the uploaded executable is deleted immediately after execution):\n\n\n-----\n\n1_skaro_logs\n\n\nMoreover, the backdoor is capable of:\n\nupdating the configuration file (from https://{C&C}/upgrade/vars.yaml)\nupgrading itself\n\nNo unequivocally malicious activities that might be expected, like DDoS attacks or spam spreading (yet!), are implemented.\nHowever, sending back the IP address, username and password allows the attackers to do anything they want with the machine\nafterwards. Together with the foul language used in the code, we think it is unlikely that this is just an invasive but innocent\nexperiment or an unfortunate exercise in academic research.\n\n[There are reports online about the compromises. For example, one from August 23rd, 2016, may be found on Pastebin. The table](http://pastebin.com/pzeFBbuu)\nbelow contains the output of running “lsof –n” on the guilty process. Note that the IP address ranges tried by SSH attempts seem\nrandom:\n\n**CMD** **PID** **USER** **FD** **TYPE** **SIZE/OFF** **NODE** **NAME**\n\n\n-----\n\n**CMD** **PID** **USER** **FD** **TYPE** **SIZE/OFF** **NODE** **NAME**\n\n.javaxxx 2773 root txt REG 5822568 /tmp/.javaxxx (deleted)\n\n.javaxxx 2773 root 5u IPv6 0t0 TCP *:13666 (LISTEN)\n\n.javaxxx 2773 root 6u IPv4 0t0 TCP 127.0.0.1:61314 (LISTEN)\n\n.javaxxx 2773 root 7u IPv4 0t0 TCP 192.168.88.210:59958->66.209.103.211:ssh (ESTABLISHED)\n\n.javaxxx 2773 root 10u IPv4 0t0 TCP 192.168.88.210:57370->139.196.21.134:ssh (ESTABLISHED)\n\n.javaxxx 2773 root 13u IPv4 0t0 TCP 192.168.88.210:52507->148.75.167.198:ssh (SYN_SENT)\n\n.javaxxx 2773 root 16u IPv4 0t0 TCP 192.168.88.210:54746->208.9.162.70:ssh (SYN_SENT)\n\n.javaxxx 2773 root 17u IPv4 0t0 TCP 192.168.88.210:54533->148.75.167.191:ssh (SYN_SENT)\n\n.javaxxx 2773 root 18u IPv4 0t0 TCP 192.168.88.210:51856->139.196.20.79:ssh (ESTABLISHED)\n\n.javaxxx 2773 root 19u IPv4 0t0 TCP 192.168.88.210:57210->208.9.162.95:ssh (SYN_SENT)\n\n.javaxxx 2773 root 24u IPv4 0t0 TCP 192.168.88.210:45946->148.75.167.99:ssh (SYN_SENT)\n\n.javaxxx 2773 root 25u IPv4 0t0 TCP 192.168.88.210:55928->208.9.162.25:ssh (SYN_SENT)\n\n.javaxxx 2773 root 27u IPv4 0t0 TCP 192.168.88.210:50041->139.196.21.177:ssh (ESTABLISHED)\n\n## Mitigation and cleanup\n\nThe trojan isn’t able to maintain persistence after the system is rebooted. Instead, available devices may be compromised\nrepeatedly.\n\nThe steps needed to clean up after a compromise are as follows:\n\nconnect to your device using SSH/Telnet,\nlook for a process named .javaxxx,\nrun commands like netstat or lsof with -n switch to confirm that it is responsible for unwanted connections,\n(voluntarily) collect forensic evidence by dumping the memory space of the corresponding process (with gcore for example).\nOne could also recover the deleted sample from /proc with cp /proc/{pid}/exe {output_file}\nthe process with the -KILL\n\nNeedless to say that victims have to secure their SSH credentials and have to do that after every factory reset.\n\nWe also prepared a plugin for Volatility Framework called vf_ioc_linux_rakos_a.py that would detect indicators of compromise if a\nwhole memory dump supported by this framework is acquired. Moreover, it extracts from the malicious process space data such as\n[configuration or information sent to the C&C. It is available here: https://github.com/eset/malware-ioc/tree/master/rakos](https://github.com/eset/malware-ioc/tree/master/rakos)\n\n## Conclusion\n\nWe have presented here another example of a Linux backdoor spreading through a well-known channel. It seems worthwhile for\nattackers to write new pieces of malicious software to misuse loopholes in the current state of network security. Our advice is this:\nDon’t build walls around your devices from sticks and straws, but from bricks and stones. The internet is a windy place.\n\n_[Special thanks to Marc-Étienne Léveillé.](http://www.welivesecurity.com/author/marc-etienne)_\n\n## IoCs\n\n### Samples\n\nThe malware binary is removed after successful execution therefore there are not many samples collected.\n\n**SHA1** **First seen** **Arch** **Size** **Version**\n\nf80836349d6e97251030190ecd30dda0047f1ee6 2016-08-17 EM_X86_64 7 360 928 B 688\n\ndef04ec688ac6b41580dd3a6e78445b56536ba34 2016-09-27 EM_X86_64 1 606 936 B 694\n\n\n-----\n\n**SHA1** **First seen** **Arch** **Size** **Version**\n\n3435ca5505ce8dfe8e1b22e0ebd4f41c60050cc0 2016-09-27 EM_X86_64 1 613 292 B 695\n\ne53c73fe6a552eab720e7ee685ea4e159ebd4fdd 2016-09-27 EM_X86_64 1 613 292 B 697\n\nc93bddd9cdb4f2e185b54a4931257954e25e7c37 2016-09-28 EM_X86_64 1 614 436 B 698\n\n14af6254d9ca310b4d52778d050cb8dd7a5de1d8 2016-10-21 EM_MIPS 4 095 740 B ???\n\nc54d50025d9f66ce2ace3361a8626aee468d94ba 2016-11-09 EM_386 1 697 592 B 700\n\n36b2fffe98f517355425797fc242f2cb82271c0c 2016-11-21 EM_386 1 875 844B 706\n\nE46E8E5E823EB0466981AFB7683FD918D6FE78A9 2016-12-16 EM_386 1 876 888 B 708\n\n0492E5C07C1426AF9CE73AD33E00A3FD8477C6C2 2016-12-16 EM_386 5 688 388 B 711\n\n### C&C Servers\n\n217.12.208.28\n\n217.12.203.31\n\n193.169.245.68\n\n46.8.44.55\n\n195.123.210.100\n\n5.34.183.231\n\n5.34.180.64\n\n185.82.216.125\n\n185.14.30.78\n\n185.14.29.65\n\n185.20.184.117\n\n20 Dec 2016 - 03:00PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-12-20 - New Linux-Rakos threat- devices and servers under SSH scan (again).pdf"
    ],
    "report_names": [
        "2016-12-20 - New Linux-Rakos threat- devices and servers under SSH scan (again).pdf"
    ],
    "threat_actors": [
        {
            "id": "c4bc6ac9-d3e5-43f1-9adf-e77ac5386788",
            "created_at": "2022-10-25T15:50:23.722608Z",
            "updated_at": "2025-03-27T02:00:55.533377Z",
            "deleted_at": null,
            "main_name": "Thrip",
            "aliases": [
                "Thrip"
            ],
            "source_name": "MITRE:Thrip",
            "tools": [
                "PsExec",
                "Mimikatz",
                "Catchamas"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "eaa8168f-3fab-4831-aa60-5956f673e6b3",
            "created_at": "2022-10-25T16:07:23.805824Z",
            "updated_at": "2025-03-27T02:02:09.986613Z",
            "deleted_at": null,
            "main_name": "Lotus Blossom",
            "aliases": [
                "ATK 1",
                "ATK 78",
                "Billbug",
                "Bronze Elgin",
                "CTG-8171",
                "Dragonfish",
                "Lotus Blossom",
                "Operation Lotus Blossom",
                "Red Salamander",
                "Spring Dragon",
                "Thrip"
            ],
            "source_name": "ETDA:Lotus Blossom",
            "tools": [
                "BKDR_ESILE",
                "Catchamas",
                "EVILNEST",
                "Elise",
                "Group Policy Results Tool",
                "Hannotog",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "PsExec",
                "Rikamanu",
                "Sagerunex",
                "Spedear",
                "Syndicasec",
                "WMI Ghost",
                "Wimmie",
                "gpresult"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a0548d4e-edc2-40c1-a4e2-c1d6103012eb",
            "created_at": "2023-01-06T13:46:38.793461Z",
            "updated_at": "2025-03-27T02:00:02.920553Z",
            "deleted_at": null,
            "main_name": "Thrip",
            "aliases": [
                "G0076",
                "ATK78"
            ],
            "source_name": "MISPGALAXY:Thrip",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536225,
    "ts_updated_at": 1743041151,
    "ts_creation_date": 1653710432,
    "ts_modification_date": 1653710432,
    "files": {
        "pdf": "https://archive.orkl.eu/0fe76993a85081f06edd3e797f25daa388340902.pdf",
        "text": "https://archive.orkl.eu/0fe76993a85081f06edd3e797f25daa388340902.txt",
        "img": "https://archive.orkl.eu/0fe76993a85081f06edd3e797f25daa388340902.jpg"
    }
}