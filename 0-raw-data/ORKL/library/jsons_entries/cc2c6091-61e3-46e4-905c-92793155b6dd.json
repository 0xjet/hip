{
    "id": "cc2c6091-61e3-46e4-905c-92793155b6dd",
    "created_at": "2023-01-12T15:00:57.901273Z",
    "updated_at": "2025-03-27T02:16:23.227296Z",
    "deleted_at": null,
    "sha1_hash": "44b5834beaa3295b2d833906a0bc0eb289adad0e",
    "title": "2021-05-27 - Apostle Ransomware Analysis",
    "authors": "",
    "file_creation_date": "2022-05-27T23:04:18Z",
    "file_modification_date": "2022-05-27T23:04:18Z",
    "file_size": 1143922,
    "plain_text": "# Apostle Ransomware Analysis\n\n**[cyberpunkleigh.wordpress.com/2021/05/27/apostle-ransomware-analysis/](https://cyberpunkleigh.wordpress.com/2021/05/27/apostle-ransomware-analysis/)**\n\n## Here we go another ransomware writeup üôÇ\n\n\nMay 27, 2021\n\n\nSmall note sorry if not the best quality I am new to blogging and working on improving!\n\n## What is this Ransomware?\n\n\n-----\n\nApostle ransomware appears to be a ransomware connected with attacks on israel with\nIOC‚Äôs many reports pointing towards Iran APTs but also a group formed in 2020 dubbed\n‚ÄúAgrius‚Äú.\n\nThis ransomware is another one developed in .NET which as seen recently is starting to\nbecome a trend which is very good for us not so good for the bad guy.\n\nFilename(s): Apostle.exe / alldata-3.5.exe\nFile Hash:\n19DBED996B1A814658BEF433BAD62B03E5C59C2BF2351B793D1A5D4A5216D27E\nSample Download:\n[https://vxug.fakedoma.in/samples/Exotic/NonAPTs/Agrius/Agrius.zip](https://vxug.fakedoma.in/samples/Exotic/NonAPTs/Agrius/Agrius.zip)\nScan Online: https://www.malwares.com/report/file?\n[hash=19DBED996B1A814658BEF433BAD62B03E5C59C2BF2351B793D1A5D4A521](https://www.malwares.com/report/file?hash=19DBED996B1A814658BEF433BAD62B03E5C59C2BF2351B793D1A5D4A5216D27E)\n6D27E\n\n## We got the sample, and now what?\n\nThe first thing I did upon getting the sample was to look on VirusTotal to try and identify some\nkey information such as what language was used to write the malware, In this case we\ndiscovered that it has been identified by a few of the detection‚Äôs on VirusTotal as shown\nbelow.\n\nThe above image displays some great news about the malware, .NET is normally very trivial\nto decompile and get a understanding of what is actually going on with tools such as:\n\n[https://github.com/icsharpcode/ILSpy](https://github.com/icsharpcode/ILSpy)\n[https://github.com/dnSpy/dnSpy](https://github.com/dnSpy/dnSpy)\n\n\n-----\n\n## Decompiling the executable\n\nUsing the tool ‚ÄúILSpy‚Äù I loaded my fresh sample to see what we could find inside the code\nmaybe some juicy details or maybe we can look at the methods involved or just pull some\njuicy information.\n\nWhat a surprise its obfuscated\n\n## OH NO ITS OBFUSCATED!?!\n\nLets give it a good ol‚Äô rub with de4dot and see if it detects and deobfuscates it, there is no\nway this is going to work right all these AdVaNcEd ThReAt AcToRs would be using custom\nobfuscation to prevent an ancient tool from working?!?\n\n\n-----\n\nOH NO IT WORKED\n\nIts just free code for us to look at\n\n## Okay we are deobfuscated let take a look around\n\nFirst of all lets take a look and see if we can find any kind of unique strings or indicators.\n\nUgh the strings are obfuscated lets find how strings are used\n\n\n-----\n\nHere is a simple XOR string function inside that references SC\n\nSC is just a XOR index table\n\nwith SC being a cached version assuming to be StringCache\n\n## Thanks for the string method\n\nNow lets yoink this method and put it all together in a simple C# app\n\n\n-----\n\nAs you can see here it has worked\n\n## Self Deletion\n\nHere is the way that it deletes itself after run it creates a .bat file to bypass file locks\n\n## Setting process tokens\n\nThis method attempts to set token privs to one that allows SeShutdownPrivilege\n\n## File Destruction\n\n\n-----\n\nA way to flag for files also would be using this timestamp as identifier: 2037, 1, 1, 0, 0, 0\n‚ÄúY,M,D,H,M,S‚Äù\n\n## Making sure it only runs once\n\nThis function is called and generates a MUTEX for preventing multiple runs\n\n## Encryption Key\n\n\n-----\n\nline argument\n\n## Stopping SQL services\n\n\nEncryption key is passed in as a command\n\nThis\n\n\nis the stop function which the below screenshot uses\n\nv\\u0096√Ø turns into ‚ÄúSQL‚Äù\n\n## RSA Encryption\n\n\n-----\n\nThis function handles RSA Encryption\n\n## Damaging data blocks\n\nFunction to literally damage data blocks\n\n## I hope maybe you learned something or just enjoyed looking at the pretty screenshots <333\n\n Credits:\n\nSentinelOne ‚Äì For great research and publication regarding this malware\n[https://twitter.com/SentinelOne](https://twitter.com/SentinelOne)\n[https://labs.sentinelone.com/from-wiper-to-ransomware-the-evolution-of-agrius/](https://labs.sentinelone.com/from-wiper-to-ransomware-the-evolution-of-agrius/)\n\nvx-underground ‚Äì Hosting the samples and generally having an awesome community\n[https://twitter.com/vxunderground](https://twitter.com/vxunderground)\n[https://vx-underground.org/samples.html](https://vx-underground.org/samples.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-27 - Apostle Ransomware Analysis.pdf"
    ],
    "report_names": [
        "2021-05-27 - Apostle Ransomware Analysis.pdf"
    ],
    "threat_actors": [
        {
            "id": "21e01940-3851-417f-9e90-1a4a2da07033",
            "created_at": "2022-10-25T16:07:23.299369Z",
            "updated_at": "2025-03-27T02:02:09.725295Z",
            "deleted_at": null,
            "main_name": "Agrius",
            "aliases": [
                "AMERICIUM",
                "Agonizing Serpens",
                "BlackShadow",
                "DEV-0227",
                "Pink Sandstorm",
                "SharpBoys"
            ],
            "source_name": "ETDA:Agrius",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agrius",
                "BFG Agonizer",
                "BFG Agonizer Wiper",
                "DEADWOOD",
                "DETBOSIT",
                "Detbosit",
                "IPsec Helper",
                "Moneybird",
                "MultiLayer Wiper",
                "PW",
                "PartialWasher",
                "PartialWasher Wiper",
                "SQLShred",
                "Sqlextractor"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "89c0c674-c35d-47a6-bd7c-1e6c1b6beacc",
            "created_at": "2024-05-01T02:03:08.042533Z",
            "updated_at": "2025-03-27T02:05:17.3236Z",
            "deleted_at": null,
            "main_name": "COBALT SHADOW",
            "aliases": [
                "AMERICIUM ",
                "Agrius",
                "BlackShadow",
                "DEV-0227 ",
                "Malek Team",
                "Pink Sandstorm ",
                "Agonizing Serpens "
            ],
            "source_name": "Secureworks:COBALT SHADOW",
            "tools": [
                " DEADWOOD",
                " Fantasy wiper",
                " Host2IP",
                " IPsec Helper",
                " Jennlog Loader",
                " MiniDump",
                " Moneybird ransomware",
                " PSexec",
                " Plink",
                " Sandals",
                " SecretsDump",
                " SoftPerfect Network Scanner",
                "Apostle"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4023e661-f566-4b5b-a06f-9d370403f074",
            "created_at": "2024-02-02T02:00:04.064685Z",
            "updated_at": "2025-03-27T02:00:03.304692Z",
            "deleted_at": null,
            "main_name": "Pink Sandstorm",
            "aliases": [
                "Agonizing Serpens",
                "AMERICIUM",
                "BlackShadow",
                "DEV-0022",
                "Agrius"
            ],
            "source_name": "MISPGALAXY:Pink Sandstorm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7d982d5b-3428-483c-8804-c3ab774f1861",
            "created_at": "2024-11-01T02:00:52.70975Z",
            "updated_at": "2025-03-27T02:00:55.517246Z",
            "deleted_at": null,
            "main_name": "Agrius",
            "aliases": [
                "Agrius",
                "Pink Sandstorm",
                "AMERICIUM",
                "Agonizing Serpens",
                "BlackShadow"
            ],
            "source_name": "MITRE:Agrius",
            "tools": [
                "NBTscan",
                "Mimikatz",
                "IPsec Helper",
                "Moneybird",
                "MultiLayer Wiper",
                "DEADWOOD",
                "BFG Agonizer",
                "ASPXSpy"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535657,
    "ts_updated_at": 1743041783,
    "ts_creation_date": 1653692658,
    "ts_modification_date": 1653692658,
    "files": {
        "pdf": "https://archive.orkl.eu/44b5834beaa3295b2d833906a0bc0eb289adad0e.pdf",
        "text": "https://archive.orkl.eu/44b5834beaa3295b2d833906a0bc0eb289adad0e.txt",
        "img": "https://archive.orkl.eu/44b5834beaa3295b2d833906a0bc0eb289adad0e.jpg"
    }
}