{
    "id": "f7700b35-17f6-43b0-b560-8e158d85d41d",
    "created_at": "2023-01-12T15:02:19.034671Z",
    "updated_at": "2025-03-27T02:13:47.907261Z",
    "deleted_at": null,
    "sha1_hash": "108d90f50f5371764bde92854ca1d68f5d16489f",
    "title": "2021-07-06 - Is Diavol Ransomware Connected to Wizard Spider-",
    "authors": "",
    "file_creation_date": "2022-05-29T00:54:40Z",
    "file_modification_date": "2022-05-29T00:54:40Z",
    "file_size": 207804,
    "plain_text": "# Is Diavol Ransomware Connected to Wizard Spider?\n\n**[heimdalsecurity.com/blog/is-diavol-ransomware-connected-to-wizard-spider/](https://heimdalsecurity.com/blog/is-diavol-ransomware-connected-to-wizard-spider/)**\n\nDora Tudor July 6, 2021\n\nAs Diavol Ransomware Is New on the Threat Landscape Researchers Weren’t Sure Where it\nWould Fit.\n\nLAST UPDATED ON JULY 6, 2021\n\nQUICK READ\n\n2 min\n\nLet's get started!\n\n\n-----\n\nWe recently witnessed the appearance of a new ransomware strain that was dubbed as\n[Diavol ransomware by the security researchers from FortiGuard Lab.](https://heimdalsecurity.com/blog/diavol-ransomware-a-new-ransomware-in-the-cybersecurity-landscape/)\n\nDiavol ransomware could be linked to the Wizard Spider threat actor as the researchers\ndiscovered a few similarities in the M.O. used by the malware. Wizard Spider is a\ncybercrime group from Russia that uses Trickbot, Ryuk, and Conti ransomware as their\nprimary tools.\n\n[It is believed that the Health Service Executive cyberattack in Ireland could’ve been](https://heimdalsecurity.com/blog/hse-hit-by-a-ransomware-attack/)\nconducted by this very organization. The cybercrime group has been known to have a\ntendency towards wire fraud previously when they also used Diavol and Conti threat\npayloads in ransomware attacks back in early June this year.\n\n## What’s New?\n\nAs Diavol ransomware is a relatively new actor in the threat landscape, researchers weren’t\nsure where it would fit, but a recent report indicates a strong connection with Wizard Spider.\n\nBoth Diavol and Conti ransomware families’ samples use the same asynchronous I/O\noperations for file encryption queuing, along with virtually identical command-line\nparameters.\nHowever, despite similarities, the researchers couldn’t find a strong connection\nbetween Diavol and Wizard Spider. Some notable differences, making the attribution\nimpossible have been identified.\nThere are no built-in checks in Diavol that stop the payloads from running on Russian\ntargets’ systems, as Conti does. Additionally, there is no evidence of data exfiltration\nabilities before encryption.\n\nDiavol’s encryption uses user-mode Asynchronous Procedure Calls (APCs), a function that\nexecutes without synchronization in the context of a particular threat.\n\n[The technique is also known as AtomBombing, and is a code injection technique that often](https://www.enisa.europa.eu/publications/info-notes/atombombing-2013-a-new-code-injection-attack)\ngoes undetected by antivirus solutions. The APC in question uses an asymmetric\nencryption algorithm, thus making it stand apart from other ransomware families, and on\nthat very chain of thought, it also speeds up significantly the encryption process.\n\nSymmetric algorithms are often used to significantly speed up the encryption process,\ntherefore are being used by the vast majority of ransomware families.\n\nDiavol ransomware also lacks any type of obfuscation as does not use packing or antidisassembly methods, thus making the analysis harder as the malware gets stored in\nbitmap images.\n\n\n-----\n\nAnother interesting aspect about Diavol ransomware is the fact that upon execution, the\nransomware manages to extract the code from the images’ PE resource section in order to\nthen load them within a buffer with permissions to run, with the code extracting 14 different\nroutines that will execute in the following order:\n\nCreate an identifier for the victim\nInitialize configuration\nRegister with the C&C server and update the configuration\nStop services and processes\nInitialize encryption key\nFind all drives to encrypt\nFind files to encrypt\nPrevent recovery by deleting shadow copies\nEncryption\nChange the desktop wallpaper\n\nRight before Diavol ransomware is done, it will change each encrypted Windows device’s\nbackground to a black wallpaper with the following message: “All your files are encrypted!\nFor more information see README-FOR-DECRYPT.txt”\n\n[Source](https://www.bleepingcomputer.com/news/security/trickbot-cybercrime-group-linked-to-new-diavol-ransomware/)\n\nConti payloads named locker.exe were found in the network, thus strengthening the\npossibility that the threat actor could indeed be Wizard Spider.\n\nThe journalists at CYWARE believe that the connection of this ransomware to already\nestablished cybercrime groups shows how ransomware operations are constantly evolving,\nand it will probably not be a surprise if more of such established cybercrime groups will be\njoining the list of ransomware operators in the upcoming months.\n\n\n-----\n\nRELATED\n\n[Diavol Ransomware, a New Ransomware in the Cybersecurity Landscape](https://heimdalsecurity.com/blog/diavol-ransomware-a-new-ransomware-in-the-cybersecurity-landscape/)\n\n[Conti Ransomware Leaks Police Citations and Forces the City of Tulsa to Issue a Data Breach Warning](https://heimdalsecurity.com/blog/conti-ransomware-leaks-police-citations-and-forces-the-city-of-tulsa-to-issue-a-data-breach-warning/)\n\n[Emotet and Trickbot Banking Trojans Acquire Internet Worm Capabilities](https://heimdalsecurity.com/blog/emotet-trickbot-internet-worm/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-06 - Is Diavol Ransomware Connected to Wizard Spider-.pdf"
    ],
    "report_names": [
        "2021-07-06 - Is Diavol Ransomware Connected to Wizard Spider-.pdf"
    ],
    "threat_actors": [
        {
            "id": "63061658-5810-4f01-9620-7eada7e9ae2e",
            "created_at": "2022-10-25T15:50:23.752974Z",
            "updated_at": "2025-03-27T02:00:55.538582Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "Wizard Spider",
                "UNC1878",
                "TEMP.MixMaster",
                "Grim Spider",
                "FIN12",
                "GOLD BLACKBURN",
                "ITG23",
                "Periwinkle Tempest",
                "DEV-0193"
            ],
            "source_name": "MITRE:Wizard Spider",
            "tools": [
                "TrickBot",
                "AdFind",
                "BITSAdmin",
                "Bazar",
                "LaZagne",
                "Nltest",
                "GrimAgent",
                "Dyre",
                "Ryuk",
                "Conti",
                "Emotet",
                "Rubeus",
                "Mimikatz",
                "Diavol",
                "PsExec",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f6f91e1c-9202-4497-bf22-9cd5ef477600",
            "created_at": "2023-01-06T13:46:38.86765Z",
            "updated_at": "2025-03-27T02:00:02.938998Z",
            "deleted_at": null,
            "main_name": "WIZARD SPIDER",
            "aliases": [
                "FIN12",
                "UNC2053",
                "Pistachio Tempest",
                "TEMP.MixMaster",
                "GOLD BLACKBURN",
                "Periwinkle Tempest",
                "DEV-0193",
                "Storm-0193",
                "Trickbot LLC",
                "DEV-0237"
            ],
            "source_name": "MISPGALAXY:WIZARD SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e6a21528-2999-4e2e-aaf4-8b6af14e17f3",
            "created_at": "2022-10-25T16:07:24.422115Z",
            "updated_at": "2025-03-27T02:02:10.216817Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "DEV-0193",
                "Gold Blackburn",
                "Gold Ulrick",
                "Grim Spider",
                "ITG23",
                "Operation BazaFlix",
                "Periwinkle Tempest",
                "TEMP.MixMaster",
                "Wizard Spider"
            ],
            "source_name": "ETDA:Wizard Spider",
            "tools": [
                "AdFind",
                "Agentemis",
                "Anchor_DNS",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "Conti",
                "Diavol",
                "Dyranges",
                "Dyre",
                "Dyreza",
                "Dyzap",
                "Gophe",
                "Invoke-SMBAutoBrute",
                "KEGTAP",
                "LaZagne",
                "LightBot",
                "PowerSploit",
                "PowerTrick",
                "PsExec",
                "Ryuk",
                "SessionGopher",
                "TSPY_TRICKLOAD",
                "Team9Backdoor",
                "The Trick",
                "TheTrick",
                "Totbrick",
                "TrickBot",
                "TrickLoader",
                "TrickMo",
                "Upatre",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bc119938-a79c-4e5f-9d4d-dc96835dfe2e",
            "created_at": "2024-06-04T02:03:07.799286Z",
            "updated_at": "2025-03-27T02:05:17.337094Z",
            "deleted_at": null,
            "main_name": "GOLD BLACKBURN",
            "aliases": [
                "Periwinkle Tempest ",
                "Wizard Spider ",
                "ITG23 "
            ],
            "source_name": "Secureworks:GOLD BLACKBURN",
            "tools": [
                " Buer Loader",
                " Dyre",
                " Team9",
                " TrickBot",
                "BazarLoader"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535739,
    "ts_updated_at": 1743041627,
    "ts_creation_date": 1653785680,
    "ts_modification_date": 1653785680,
    "files": {
        "pdf": "https://archive.orkl.eu/108d90f50f5371764bde92854ca1d68f5d16489f.pdf",
        "text": "https://archive.orkl.eu/108d90f50f5371764bde92854ca1d68f5d16489f.txt",
        "img": "https://archive.orkl.eu/108d90f50f5371764bde92854ca1d68f5d16489f.jpg"
    }
}