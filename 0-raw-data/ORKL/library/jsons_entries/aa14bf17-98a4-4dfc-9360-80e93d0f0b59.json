{
    "id": "aa14bf17-98a4-4dfc-9360-80e93d0f0b59",
    "created_at": "2023-01-12T15:10:33.290321Z",
    "updated_at": "2025-03-27T02:05:47.376258Z",
    "deleted_at": null,
    "sha1_hash": "1831e70097ae7b8920d1dc6b88448f7d13b98caf",
    "title": "2022-07-10 - Lockbit 3.0 AKA Lockbit Black is here, with a new icon, new ransom note, new wallpaper, but less evasiveness-",
    "authors": "",
    "file_creation_date": "2022-07-18T18:28:14Z",
    "file_modification_date": "2022-07-18T18:28:14Z",
    "file_size": 1203418,
    "plain_text": "# Lockbit 3.0 AKA Lockbit Black is here, with a new icon, new ransom note, new wallpaper, but less evasiveness?\n\n**blog.minerva-labs.com/lockbit-3.0-aka-lockbit-black-is-here-with-a-new-icon-new-ransom-note-new-wallpaper-but-**\nless-evasiveness\n\n[Tweet](https://twitter.com/share)\n\n\n-----\n\nThis month the Lockbit ransomware gang announced their first Bug Bounty program as part\nof their evolution into Lockbit 3.0. A first sample of the new version was published by Arda\nBüyükkaya. According to their new ransomware wallpaper that appears after encryption, this\nspecific version has been named ‘Lockbit Black’, which interestingly follows their new\nexecution method which is pretty similar to the BlackCat ransomware execution method.\nThere are actually even more similarities between the two ransomwares.\n\n## Lockbit Black - Execution\n\nThe new Lockbit ransomware requires a “pass” to be supplied as a parameter upon\nexecution, Similar to BlackCat with requires an “access-token”. The “pass” for the published\n[sample was also provided by Arda Büyükkaya:](https://twitter.com/WhichbufferArda)\n\n_Figure 1 - The execution command_\n\n## Lockbit Black – Packer and dynamic imports\n\nLockbit Black is well packed, and its imports table is almost empty. Most API functions calls\nare resolved dynamically by calling a trampoline function which decrypts the API function\nusing XOR encryption:\n\n_Figure 2 - Trampoline function performing XOR encryption_\n\n## Lockbit Black – UAC bypass\n\nWhen executing without Admin privileges, Lockbit Black (much like its previous versions)\nperforms a CMSTPLUA COM UAC bypass.\n\n## Lockbit Black – Service Delete and Process Termination\n\nLockbit Black enumerates services and processes against a pre-defined “Blacklist”. The new\nversion however has a much shorter list than its predecessors. The list is effectively a\n“Blacklist”, and all services that appear in the list are designated to be either deleted. The\n\n\n-----\n\nservice list of the new version seems like a combined and shorter version of the services that\nwere previously deleted by Lockbit and BlackCat together and contains:\n\n1. vss\n2. sql\n3. svc$\n4. memtas\n5. mepocs\n6. msexchange\n7. sophos\n8. veeam\n9. backup\n10. GxVss\n\n11. GxBlr\n12. GxFWD\n13. GxCVD\n14. GxCIMgr\n\n_Figure 3 - Service deletion by Lockbit Black_\n\nThe new Lockbit also uses the same method to terminate a number of processes if they are\nfound to be running on victim’s PC:\n\n1. sql\n2. oracle\n3. ocssd\n4. dbsnmp\n5. synctime\n6. agntsvc\n7. isqlplussvc\n8. xfssvccon\n9. mydesktopservice\n\n\n-----\n\n10. ocautoupds\n\n11. ncsvc\n12. firefox\n13. tbirdconfig\n14. mydesktopqos\n15. ocomm\n16. dbeng50\n17. sqbcoreservice\n18. excel\n19. infopath\n20. msaccess\n21. mspub\n22. onenote\n23. outlook\n24. powerpnt\n25. steam\n26. thebat\n27. thunderbird\n28. visio\n29. winword\n30. wordpad\n31. notepad\n\n_Figure 4 - Process Termination_\n\n## Lockbit Black – Default language check\n\nPrevious versions of the Lockbit ransomware performed a default language check on the\nsystem and the current user through the Windows API calls GetSystemDefaultUILanguage\nand GetUserDefaultUILanguage. If the language code identifier matched the one specified,\nthe program shuts down. The new version seems to extend the country list to also include\nSyria:\n\n\n-----\n\n**New Version**\n\n419 – Russian\n\n422 – Ukrainian\n\n423 – Belarusian\n\n428 – Tajik\n\n42B - Armenian\n\n42C – Azerbaijani (Latin)\n\n437 – Georgian\n\n43F – Kazakh\n\n440 – Kyrgyz\n\n442 – Turkmen\n\n443 – Uzbek (Latin)\n\n444 – Tatar\n\n818 - Romanian (Moldova)\n\n819 - Russian (Moldova)\n\n82C – Azerbaijani (Cyrillic)\n\n843 - Uzbek (Cyrillic)\n\n2801 - Arabic (Syria)\n\n\n-----\n\n## Lockbit Black – Mutex\n\nLockbit Black creates a “2cae82bd1366f4e0fdc7a9a7c12e2a6b” mutex.\n\n## Lockbit Black – New icon, wallpaper and ransom note\n\nLockbit's Black’s icon, wallpaper and ransom note were updated in the new version:\n\n_Figure 5 - Lockbit Black icon_\n\n_Figure 6 - Lockbit Black wallpaper_\n\n\n-----\n\n_Figure 7 - Part of the new ransom note_\n\nThe new ransom note comes in the form of a text file and contains a reference to Elon\nMusk’s Twitter (Ilon Musk), but with a link to a more generic #lockbit hashtag page on\nTwitter.\n\nThere are several chat list URLs added to the link which lead to several Lockbit Darknet\nwebsites.\n\n## Lockbit Black – hiding threads from the debugger\n\nHiding threads from the debugger is not a new behavior for Lockbit but is has increased\nusage in the new version. The thread hiding is performed by calling the\nNtSetInformationThread API with the undocumented value\nTHREAD_INFORMATION_CLASS::ThreadHideFromDebugger (0x11):\n\n\n-----\n\n_Figure 8 - hiding thread from the debugger_\n\nLockbit Black –Windows Defender Log tampering\n\nIn order to disable Windows Defender logs, Lockbit Black sets\n‘HKLMSoftware\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-WindowsWindows Defender/Operational\\Enabled’ to ‘0’ as well changing the ‘ChannelAccess’ to\n‘(O:BAG:SYD:(A;;0x1;;;SY)(A;;0x5;;;BA)(A;;0x1;;;LA)’.\n\n_Figure 9 - Windows Defender Log Disabled_\n\nAs in most ransomware cases the encryption is performed by several threads for faster and\nefficient work.\n\n\n-----\n\n## Minerva Lockbit 3.0 Prevention of the UAC bypass\n\nMinerva customers don't need to worry, as many of Minerva's modules block Lockbit Black\nin its earliest stages, including the UAC Bypass stage, shutting it down completely before the\nencryption stage even begins.\n\n_Figure 10 - UAC bypass prevention by Minerva_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-10 - Lockbit 3.0 AKA Lockbit Black is here, with a new icon, new ransom note, new wallpaper, but less evasiveness-.pdf"
    ],
    "report_names": [
        "2022-07-10 - Lockbit 3.0 AKA Lockbit Black is here, with a new icon, new ransom note, new wallpaper, but less evasiveness-.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536233,
    "ts_updated_at": 1743041147,
    "ts_creation_date": 1658168894,
    "ts_modification_date": 1658168894,
    "files": {
        "pdf": "https://archive.orkl.eu/1831e70097ae7b8920d1dc6b88448f7d13b98caf.pdf",
        "text": "https://archive.orkl.eu/1831e70097ae7b8920d1dc6b88448f7d13b98caf.txt",
        "img": "https://archive.orkl.eu/1831e70097ae7b8920d1dc6b88448f7d13b98caf.jpg"
    }
}