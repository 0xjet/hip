{
    "id": "8338f1a3-e3d0-499e-910a-bde55114b9f7",
    "created_at": "2023-01-12T14:59:38.735547Z",
    "updated_at": "2025-03-27T02:17:11.294695Z",
    "deleted_at": null,
    "sha1_hash": "ca3546688a47b847d5f7c407d5398fdc04eb9e54",
    "title": "2020-11-12 - The CostaRicto Campaign- Cyber-Espionage Outsourced",
    "authors": "",
    "file_creation_date": "2022-05-28T22:08:09Z",
    "file_modification_date": "2022-05-28T22:08:09Z",
    "file_size": 1930787,
    "plain_text": "# The CostaRicto Campaign: Cyber-Espionage Outsourced\n\n**[blogs.blackberry.com/en/2020/11/the-costaricto-campaign-cyber-espionage-outsourced](https://blogs.blackberry.com/en/2020/11/the-costaricto-campaign-cyber-espionage-outsourced)**\n\nThe BlackBerry Research & Intelligence Team\n\n_With the undeniable success of Ransomware-as-a-Service (RaaS), the cybercriminal market has expanded its portfolio to_\n_add dedicated phishing and espionage campaigns to the list of illicit services on offer…_\n\n[During the past six months, the BlackBerry Research and Intelligence team have been monitoring a cyber-espionage](https://blogs.blackberry.com/en/author/the-blackberry-research-and-intelligence-team)\ncampaign that is targeting disparate victims around the globe. The campaign, dubbed CostaRicto by BlackBerry, appears to\nbe operated by “hackers-for-hire”, a group of APT mercenaries who possess bespoke malware tooling and complex VPN\nproxy and SSH tunnelling capabilities.\nMercenary groups offering APT-style attacks are becoming more and more popular. Their tactics, techniques, and\nprocedures (TTPs) often resemble highly sophisticated state-sponsored campaigns, but the profiles and geography of their\nvictims are far too diverse to be aligned with a single bad actor’s interests.\n\nAlthough in theory the customers of a mercenary APT might include anyone who can afford it, the more sophisticated actors\nwill naturally choose to work with patrons of the highest profile – be it large organizations, influential individuals, or even\ngovernments. Having a lot at stake, the cybercriminals must choose very carefully when selecting their commissions to\navoid the risk of being exposed.\n\nOutsourcing an espionage campaign, or part of it, to a mercenary group might be very compelling, especially to businesses\nand individuals who seek intelligence on their competition yet may not have the required tooling, infrastructure and\nexperience to conduct an attack themselves. But even notorious adversaries experienced in cyber-espionage can benefit\nfrom adding a layer of indirection to their attacks. By using a mercenary as their proxy, the real attacker can better protect\ntheir identity and thwart attempts at attribution.\n\n**Key Findings:**\n\n\n-----\n\nCostaRicto targets are scattered across different countries in Europe, Americas, Asia, Australia and Africa, but the\nbiggest concentration appears to be in South Asia (especially India, Bangladesh and Singapore), suggesting that the\nthreat actor could be based in that region, but working on a wide range of commissions from diverse clients.\n\nThe command-and-control (C2) servers are managed via Tor and/or through a layer of proxies; a complex network of\nSSH tunnels are also established in the victim’s environment. These practices reveal better-than-average operation\nsecurity.\n\nThe backdoor used as a foothold is a new strain of never-before-seen malware – a custom-built tool with a suggestive\nproject name, well-structured code, and detailed versioning system. The earliest timestamps are from October 2019,\nand based on the version numbers, the project appears to be in the debug testing phase. It’s not clear as of now if it’s\nsomething that the threat actors developed in-house or obtained for exclusive use as part of beta testing from another\nentity.\n\nThe timestamps of payload stagers go back to 2017, which might suggest the operation itself has been going on for a\nwhile, but used to deliver a different payload. It’s not impossible, though, that the stagers are simply being reused\nwithout recompilation (i.e.: by changing the C2 URLs via binary editing).\n\n[The backdoor project is called Sombra, which is a reference to an Overwatch game persona – an agent of the](https://overwatch.fandom.com/wiki/Sombra)\nantagonist organization, who specializes in espionage and intelligence assessment and is characterized by stealth,\ninfiltration and hacking skills.\n\nSome of the domain names hardcoded in the backdoor binaries seem to spoof legitimate domains (e.g.: the malicious\ndomain sbibd[.]net spoofing a legitimate domain of the State Bank of India Bangladesh, sbibd.com). However, victims\naffected by these backdoors are unrelated, suggesting reuse of existing infrastructure which served another purpose.\n\nOne of the IP addresses which the backdoor domains were registered to overlaps with an earlier phishing campaign\nattributed to [APT28 (i.e.: according to RiskIQ data, the SombRAT domain akams[.]in was at the time of attack](https://blogs.blackberry.com/en/2019/08/inside-the-apt28-dll-backdoor-blitz)\nregistered to the same IP address as the phishing domain mail.kub-gas[.]com). However, BlackBerry researchers\nbelieve that a direct link between CostaRicto and APT28 is highly unlikely. It might be that the IP overlap is\ncoincidental, or – just as plausible – that the earlier phishing campaigns have been outsourced to the mercenary on\nbehalf of the actual threat actor.\n\n**Targeting**\n\nUnlike most of the state-sponsored APT actors, the CostaRicto adversary seems to be indiscriminate when it comes to the\nvictims' geography. Their targets are located in numerous countries across the globe with just a slight concentration in the\nSouth-Asian region:\n\nIndia\nBangladesh\nSingapore\nChina\nU.S.\nBahamas\nAustralia\nMozambique\nFrance\nNetherlands\n\n\n-----\n\nAustria\nPortugal\nCzechia\n\nThe victims’ profiles are diverse across several verticals, with a large portion being financial institutions.\n\n**Delivery**\n\nAfter gaining access to the victim’s environment (presumably by using stolen credentials, either obtained via phishing, or\nbought on the dark web), the attacker sets up remote tunnelling using a SSH tool. The tool is configured to redirect traffic\nfrom a malicious domain to a proxy that is listening on a local port. The tunnel is authenticated using the attacker’s private\nkey.\n\nIn order to pull down the backdoor, a payload stager, either HTTP or reverse-DNS, is executed with the use of a scheduled\ntask.\n\nThe backdoor comes either wrapped up in a PowerSploit reflective loader, or in the form of a custom-built dropper that uses\na simple virtual machine (VM) mechanism to decode and inject the payload.\n\n**Toolset**\n\nSombRAT: A custom backdoor (with both x86 and x64 versions)\nCostaBricks: A custom VM-based payload loader (seen only with x86 SombRAT payloads so far)\n[PowerSploit’s reflective PE injection module (seen with x64 SombRAT payloads)](https://powersploit.readthedocs.io/en/latest/CodeExecution/Invoke-ReflectivePEInjection/)\nHTTP and reverse-DNS payload stagers\nnmap: Port scanner\nPsExec\n\n**PS1 Loader (x64)**\n\nThe 64-bit backdoor is deployed in a fairly standard way. It is distributed as a set of scripts and encrypted files and utilizes a\nPowerShell loader based on the Invoke-ReflectivePEInjection PowerSploit module to decode and inject the final payload\nDLL into memory:\n\n**File Name** **Function**\n\n**autorun.bat** Obfuscated batch script that sets PowerShell execution policy to unrestricted and executes autorun.ps1\n\n**autorun.ps1** Obfuscated PowerShell script that decodes and executes another PowerShell loader stored in ntuser.c file\n\n**ntuser.a** XOR key used to decode the PowerShell loader and payload binary\n\n**ntuser.b** XOR encoded payload binary\n\n**ntuser.c** XOR encoded Invoke-ReflectivePEInjection module, modified to add payload decryption routine\n\n**CostaBricks Loader (x86)**\n\nThe loader used with 32-bit backdoors is more technically compelling. It implements a simple custom-built virtual machine\nmechanism that will execute an embedded bytecode to decode and inject the payload into memory.\n\nThis attempt at obfuscation, although not new, is rather uncommon in relation to targeted attacks. Code virtualization has\nbeen most prevalent in commercial software protectors which use much more advanced solutions; simpler virtual machines\nare sometimes also featured in off-the-shelf malicious packers used by widespread financial crimeware. This particular\n\n\n-----\n\nimplementation, however, is unique (there are just a handful of samples in the public domain) and seems to be used only\nwith SombRAT payloads – which makes us believe it is a custom-built tool that is private to the attackers.\n\nTo further confuse anti-malware solutions, the loader contains the entire unobfuscated code of a legitimate open source\n[application called Blink (https://github.com/crosire/blink), which never gets executed:](https://github.com/crosire/blink)\n\n_Figure 1: Strings belonging to Blink code_\n\nThere is also an unused zlib decompression routine that seems to be leftover code from an older version of the loader.\n\nThe compilation timestamps suggest that both the loader and the embedded payload are compiled at the same time (with\nonly a few seconds difference).\n\nOne of the loaders had the following PDB path, suggesting that the internal name of the project is CostaRicto/ CostaBricks:\n\n_Figure 2: PDB path from one of the x86 loader samples_\n\n**Virtual Machine Internals**\n\nThe virtual machine mechanism is implemented with the usage of C++ objects and classes. There are 20 different VM\ninstructions, each having between zero and three operands. A pointer to the bytecode to execute is passed as a parameter\nto the VM initialization routine:\n\n\n-----\n\n_Figure 3: Initialization of the virtual machine_\n\nA VM instance is initialized by setting its context structure, which contains the instruction pointer, zero flag, instructions list\nand pointer to the registers:\n\n**Offset** **Field** **Description**\n\n**0x00** Instruction pointer Index of the bytecode instruction to execute\n\n**0x04** Zero flag Used for conditional jumps\n\n**0x08** Instructions_list.first Points to the first instruction in the list\n\n**0x0C** Instructions_list.current Points to the current instruction in the list\n\n**0x10** Instructions_list.next Points to the next instruction in the list\n\n**0x14** Registers pointer Points to the list of registers\n\n**0x18** Registers count Incremented when new register is allocated\n\n**_Instructions and Operands_**\n\nInstructions, operands, and opcode handlers are implemented as doubly linked lists. Each VM instruction has its own index\nand contains information such as the opcode number, flags, operands count, and the operands:\n\n_Figure 4: An example of VM instruction format for the SUB opcode_\n\nThe operands can either be immediate values or \"registers\". Dynamically allocated “registers” are small memory regions\norganized in the form of dictionary objects in doubly linked list. Each register has its own unique index that can store up to 8\nbytes of data (including pointers to larger memory buffers) and can be either read or written to.\n\nIf the operand metadata specifies the index value, the operand is a \"register\"; otherwise the operand contains an immediate\nvalue. The value (either immediate or pointed to by a \"register\") is an integer: qword by default, but different lengths (byte,\nword or double-word) can be specified in the metadata:\n\n**Offset** **Field** **Notes**\n\n**0x00** Instruction index Consecutive numbers starting with 0\n\n**0x04** Opcode 0 – 0x13 (19.)\n\n**0x06** Skip bool If set, then the instruction will be ignored\n\n**0x08** Operands count 0 – 3\n\n**0x0C** Operand type read (0) or write (1)\n\n**0x0E** Operand flag Specifies length: 0x10 = byte, 0x20 = word, 0x40 = dword\n\n\n-----\n\n**0x10** Operand register index Consecutive numbers starting with 0x9435C739\n\n**0x14** Operand value Immediate value (if operand is not a register)\n\n**0x1C** Operand 2 Optional\n\n**0x2C** Operand 3 Optional\n\n**_Opcodes_**\n\nEach opcode has its own handler routine, which is executed in the main VM loop:\n\n_Figure 5: Loop processing VM instructions_\n\nThe handler routine will check to see if the number and types of operands are valid, read operand values from VM\n“registers”, perform a specific action (arithmetic/byte operation, comparison, jump, API call), and save results to a\ndestination “register”:\n\n\n-----\n\nFigure 6: XOR opcode handler routine\n\n\n**Opcode**\n**(hex)**\n\n\n**Operands** **Instruction** **Description**\n\n\n**0x00** dst, src mov Move from src (either immediate value or pointer/register) to register at\ndst. If no operands, this acts as a NOP instruction, used mostly as a label\nto jump to\n\n**0x01** dst, src xor Exclusive or dst with src, result pointed by dst\n\n**0x02** dst, src add Add src to dst, result pointed by dst\n\n**0x03** dst, src and And dst with src, result pointed by dst\n\n**0x04** dst, src sub Subtract src from dst, result pointed by dst\n\n**0x05** addr call Call address in operand 1 (can be immediate value or register)\n\n**0x06** - ret Return 1\n\n**0x07** mem_ptr, size virtual_alloc Allocate memory (call VirtualAlloc), size in operand 2, pointer returned in\noperand 1 (register)\n\n**0x08** mem_ptr virtual_free Free memory (VirtualFree), pointer in operand 1 (register)\n\n\n-----\n\n**0x09** dst, src, size memmove Source pointed by operand 2, destination pointed by operand 1, size in\noperand 3\n\n**0x0A** dst, src cmp Compare value at dst (register) with src (immediate or register value), set\nzero flag in VM context structure\n\n**0x0B** dst, src alldiv Dividend in operand 1 register, divisor in operand 2 (immediate or\nregister), result in operand 1 register\n\n**0x0C** dst jnz If zero flag not set, jump to location specified by operand\n\n**0x0D** dst jz If zero flag set, jump to location specified by operand\n\n**0x0E** dst jmp Unconditional jump; set instruction pointer to the value of operand\n\n\n**0x0F** dll_handle,\ndll_name\n\n**0x10** dll_handle,\nproc_name,\napi_address\n\n\nload_library Call LoadLibraryA, pointer to library name in operand 2 (register), handle\nto loaded library in operand 1 (register)\n\nget_proc_addr Call GetProcAddress, pointer to DLL handle in operand 1, pointer to\nprocess name in operand 2, API address returned in operand 3 (all\noperands are registers)\n\n\n**0x11** - exit_proc Call ExitProcess(0)\n\n**0x12** dst, src shr Shift right (divide dst by src)\n\n**0x13** dst, src shl Shift left (multiply dst by src)\n\n**The Bytecode**\n\nAll of the x86 loaders BlackBerry has seen thus far embed the exact same bytecode that is 1800 (0x708) lines long. Most of\nthese 1800 instructions are superfluous (i.e.: have no influence on the code functionality) and were inserted there for\nobfuscation only.\n\nThe purpose of the bytecode is to decrypt the embedded payload, load it into memory reflectively and execute it:\n\n\n-----\n\n_Figure 7: A fragment of VM bytecode - setting the decryption key_\n\nThe payload decryption routine uses a custom symmetric algorithm based on arithmetic and byte-shift instructions – a\ncombination of SHL/SHR/SUB/ADD/XOR – with hardcoded keys.\n\nThese constant values are used in all x86 SombRAT droppers we’ve seen so far:\n\n\n-----\n\n_Figure 8: Payload decoding algorithm_\n\n**SombRAT Backdoor**\n\nThe backdoor delivered by the above-mentioned loaders is a C++ compiled executable developed with heavy usage of\nobjects, classes, and interfaces. It has a plugin architecture and basic functionality of a foothold RAT that is mainly used to\ndownload and execute other malicious payloads – either as its own plugins or standalone binaries. It can also perform other\nsimple actions, like collecting system information, listing and killing processes, and uploading files to the C2.\n\n**Features:**\n\nCommunication over DNS tunnel with a hardcoded domain name and DGA-generated subdomain\nC2 traffic encrypted with RSA-2048\nCustom AES-encrypted storage format used to store configuration, plugins, and harvested data\n\nUnique version number for each sample\n\n\n-----\n\n_Figure 9: Backdoor classes hierarchy_\n\nAccording to a PDB path found in the 64-bit specimens, the project was originally called Sombra – possibly in reference to\nthe [Overwatch game character:](https://overwatch.fandom.com/wiki/Sombra)\n\n\n-----\n\n_Figure 10: PDB path from 64 bit backdoor with project name Sombra_\n\nIn the Overwatch game world, Sombra is an agent of an antagonist organization called Talon. She is skilled in computer\nhacking and cryptography and specializes in espionage and intelligence assessment:\n\n_“One of the world's most notorious hackers, Sombra uses information to manipulate those in power._\n\n_Sombra's skills include computer hacking and cryptography; these are activities she greatly enjoys, to the point where the_\n_desire to get past locks and solving mysteries is ingrained in her personality. She is a known associate of Reaper,_\n_specializing in espionage and intelligence assessment._\n\n_Stealth and debilitating attacks make Sombra a powerful infiltrator. Her hacking can disrupt her enemies, ensuring they're_\n_easier to take out, while her EMP provides the upper hand against multiple foes at once. Sombra’s ability to Translocate and_\n_camouflage herself makes her a hard target to pin down.”1_\n\nEmbedded in each sample is a hardcoded version number, with the following versions observed thus far:\n\n**Version** **Compilation timestamp** **Architecture**\n\n**0.0.1.114499** 31-10-2019 21:22:39 UTC x86\n\n**0.0.1.14630 (T)** 09-11-2019 21:53:44 UTC x86\n\n**0.1.60 (DT)** 11-11-2019 14:55:45 UTC x86\n\n**0.1.208 (DT)** 17-11-2019 20:58:25 UTC x86\n\n**0.1.724 (DT)** 24-12-2019 10:33:41 UTC x64\n\n**0.2.404 (DT)** 20-08-2020 01:36:50 UTC x64\n\nOne of the backdoor samples (0.1.60 (DT)) was found to be hosted on http[://]159.65.31[.]84/svolcdst.exe.\n\n**Behaviour**\n\nBefore entering the command processing loop, the backdoor will check to see if it’s running as a service, and will create a\nrun-once mutex consisting of %HOSTNAME% with a postfix of “S”, “U”, or “SU”, depending on which privileges it was\nexecuted with.\n\nThe C2 domain name for the DNS communication is hardcoded and obfuscated using XOR. The backdoor will generate a\nsubdomain using a custom domain generation algorithm (DGA) and try to send an initial beacon to the C2 via DNS\ntunneling:\n\n\n-----\n\n_Figure 11: Decoding the C2 domain name_\n\nThe configuration, along with downloaded plugins and all harvested data are stored in a custom database format inside a\nsingle file under the %TEMP% directory. The file name is hardcoded and obfuscated with XOR. The storage file is encrypted\nwith AES-256 using a hardcoded key and is decrypted each time the malware needs to read or write it and re-encrypted\nafter new data is added:\n\n_Figure 12. Hardcoded AES key for storage encryption_\n\nStrings used as backdoor commands and in debugging messages sent to the C2 are encoded with a simple alphabet\nsubstitution. These are not decrypted by the backdoor on the victim’s side, and the key for decryption is not present in the\nbinary. Most probably the backdoor client decrypts them locally:\n\n_Figure 13: Substitution-encoded strings_\n\n**Command and Control (C2)**\n\nThe C2 communication can either be performed via DNS tunnelling or TCP sockets. Traffic is SSL-encrypted and can\nbypass HTTP/SOCKS5 proxies. The C2 domain name is hardcoded in the binary and obfuscated with a single-byte XOR\nkey which differs between samples. In order to establish communication, the malware first uses a DGA (Domain Generation\nAlgorithm) to generate the subdomain to connect to. Depending on an internal boolean setting, one of the following URL\nformats is used:\n\nimages%x.%s\nimages%x.elmako.%s\n\nwhere %s is the hardcoded domain name and %x contains 8 hexadecimal characters generated based on the result of the\nGetTickCount API:\n\nIf the connection is unsuccessful, the backdoor will try to generate and connect to several other URLs in the same domain,\nusing the same algorithm but without the “images” prefix.\n\n\n-----\n\nIt seems that in most cases, the malware sends out data using DNS_TYPE_TEXT requests, while the attackers issue\ncommands separately over the TCP channel with the IP address associated with the DGA-generated subdomain.\n\nAll the communication is compressed with zlib and encrypted with AES. Additionally, an embedded RSA public key is used\nto secure the AES key exchange:\n\n_Figure 14: RSA key used for C2 traffic encryption_\n\n**Backdoor Commands**\n\nBoth the x86 and x64 versions of the backdoor feature approximately 50 different commands organized into six groups,\neach group served by a different interface:\n\nCore\nTaskman\nConfig\nStorage\nDebug\nNetwork\n\n**Command** **Type** **Description**\n\n\n**networkdisconnected**\n**broadcast**\n\n**informationaccepted**\n**broadcast**\n\n**networkconnected**\n**broadcast**\n\n\nCore Broadcast “networkdisconnected” message\n\nCore Save provided session ID to memory struct, broadcast “informationaccepted”\nmessage\n\nCore Broadcast session ID and system info\n\n\n**ping** Core Send a \"ping\" to the C2 server\n\n**loadasdll** Core Load additional DLL into memory\n\n**loadfromstorage** Core Inject DLL into memory (from storage)\n\n**loadfromfile** Core Inject DLL into memory (from disk)\n\n**loadfrommem** Core Inject DLL into memory (from memory)\n\n\n-----\n\n**loadplugincomplete** Core Execute a plugin that is already loaded\n\n\n**initializeandloadpluginby-**\n**uniqid**\n\n\nCore Load and execute a plugin; plugins are stored as zlib-compressed and AES\nencrypted PE files inside the storage and referred to by unique identifier\n\n\n**getinfo** Core Obtain environment strings, computer name, username, OS version\ninformation, system time, etc.\n\n**restart** Core Respawn using ShellExecuteW\n\n**shutdown** Core Exit process\n\n**uninstall** Core (unimplemented)\n\n**updatemyself** Core Create backup of itself (with .old extension) and spawn new instance via\nCreateProcessW\n\n**pluginunload** Core Unload and remove plugin from storage\n\n**getprocesslist** Taskman Obtain a list of running processes\n\n**killprocessbypid** Taskman Terminate a process by PID\n\n**killprocessbyname** Taskman Terminate a process by name\n\n**get** Config Read specified values from .config file in storage and send to the C2\n\n**set** Config Set specific config fields and save to .config file in storage\n\n**del** Config Delete specified config fields from .config file in storage\n\n**initdefaults** Config Initialize config fields with default values and save to .config file in storage\n\n**clear** Config Zero-out config fields and save to .config file in storage\n\n**save** Config Save provided config values to .config file in storage\n\n**enum** Config Read values from .config file in storage to memory\n\n**write** Storage Encrypt and write data to storage file\n\n**create** Storage Create new encrypted storage file\n\n**close** Storage Encrypt and flush data to storage file\n\n**drop** Storage Write supplied file content to storage file\n\n**delete** Storage Delete file with specified ID from storage; enumerate files in storage\n\n\n-----\n\n**enum** Storage Enumerate files in storage (name, written, size)\n\n**upload** Storage Decrypt and upload file with specified ID from storage file\n\n**clearall** Storage Remove all files from storage\n\n**archivebypath** Storage Read file(s) from specified path and save to storage file, then enumerate\nstorage\n\n**restorestorage** Storage Delete storage file and open a new storage\n\n\n**cancel1**\n**/closeanddeletestorage**\n\n\nStorage Remove all files from storage and delete storage temp file\n\n\n**closestorage** Storage Close storage temp file\n\n**openstorage** Storage Open storage temp file\n\n**getcontent** Storage (unimplemented)\n\n**awaitcreate** Storage Create new encrypted storage file\n\n**await&putcontent** Storage Read from C2 and save to the storage file\n\n**await&getcontent** Storage Read from content from storage and send via C2\n\n**debuglog** Debug Enable debug logging\n\n**broadcast** Network Set networkconnected or networkdisconnected bool in memory\n\n**touchconnect** Network Send the networkconnected bool setting to the C2\n\n**stats** Network Send details of sent/received bytes\n\n**reconnect** Network Close socket and reconnect\n\n**disconnect** Network Close socket\n\n**switchtotcp** Network Switch C2 communication to TCP/IP\n\n**switchdns** Network Switch C2 communication to DNS\n\n**setproxy2** Network Set proxy type, host, port, domain, user, password\n\n\n**checkproxy2** Network (unimplemented)\n\n**getproxy3** Network Send current proxy configuration to C2\n\n\n-----\n\n**resetproxy3** Network (unimplemented)\n\n_1 – before v0.1.60t_\n_2 – since at least v0.1.208_\n_3 – since at least v0.1.724_\n\nNetwork\n\n_Infosportals[.]com_\n\nFirst active during October 2019, infosportals[.]com was utilized by early SombRATs as the primary C2 domain. Since then,\nthe domain shifted IP address multiple times, was then taken offline between February and May, before being reactivated\nbriefly between late May and mid-June as part of another offensive:\n\n_Figure 15: Timeline of IP resolutions for infosportals[.]com_\n\n_Figure 16: Table of IP resolutions for infosportals[.]com_\n\n**_Sbibd[.]net_**\n\nA phishing domain mimicking the legitimate sbibd.com (registered to the State Bank of India, Bangladesh), sbibd[.]net was\nfirst active for a short spell from early November to December 2019, then reactivated again between February and March\n2020 and was used as the primary C2 with several SombRAT variants:\n\nFigure 17: Timeline of IP resolutions for sbibd[.]net\n\n\n-----\n\n_Figure 18: Table of IP resolutions for sbibd[.]net_\n\n**_Akams[.]in_**\n\nFirst active for a few weeks from late December 2019 to mid-January 2020, akams[.]in was also used by multiple SombRAT\nsamples for C2 communications. One of the prior resolutions, for IP 45.89.175.206, is particularly interesting, as it overlaps\nwith another domain called mail[.]kub-gas[.]com, which was implicated as being associated with an APT-28/Fancy\n[Bear/Sofacy phishing campaigns in a report by Area 1 Security. However, after much scrutiny, it would appear highly likely](https://cdn.area1security.com/reports/Area-1-Security-PhishingBurismaHoldings.pdf)\nthat there is no direct connection between the SombRAT campaign and APT-28 activity.\n\nFigure 19: Timeline of IP resolutions for akams[.]in\n\n_Figure 20: Table of IP resolutions for akams[.]in_\n\n**_newspointview[.]com_**\nRegistered and active during late June 2020, newspointview[.]com has been used with more recent SombRAT variants as\nthe primary C2 domain:\n\n_Figure 21: Timeline of IP resolutions for newspointview[.]com_\n\n\n-----\n\n_Figure 22: Table of IP resolutions for newspointview[.]com_\n\n**Timeline**\n\nThe following timeline shows key domain/IP resolutions and known SombRAT releases:\n\n_Figure 23: Timeline of IP resolutions and SombRAT versions_\n\n\n-----\n\n**Conclusions**\n\nThere are several factors that lead us to the assumption that the threat actor behind CostaRicto is a mercenary group:\n\nThe toolset used in CostaRicto campaign consists of bespoke malware that appeared around October 2019 and has\nbeen rarely seen in the wild since. It therefore appears to be private to this particular adversary.\n\nMoreover, the constant development, detailed versioning system and well-structured code that allows for easy\nfunctionality expansion – all suggest that the toolset is part of a long-term project, rather than a one-off campaign.\n\nThe apparent sharing of network infrastructure with a previous, seemingly unrelated phishing campaign attributed to\nAPT28, as well as the reuse of phishing domain names as C2 servers in attacks against unrelated victims, indicates\nthat the same entity is likely behind a diverse range of attacks.\n\nFinally, the diversity and geography of the victims doesn’t fit a picture of a campaign sponsored by a particular state;\nrather, it’s a mix of targets that could be explained by different assignments commissioned by disparate entities.\n\nWith the undeniable success of Ransomware-as-a-Service (RaaS), it's not surprising that the cybercriminal market has\nexpanded its portfolio to add dedicated phishing and espionage campaigns to the list of services on offer. Outsourcing\nattacks or certain parts of the attack chain to unaffiliated mercenary groups has several advantages for the adversary – it\nsaves their time and resources and simplifies the procedures, but most importantly it provides an additional layer of\nindirection, which helps to protect the real identity of the threat actor.\n\nResearchers and investigators tend to group adversaries based on similar tactics, techniques and procedures, code reuse,\nand physical infrastructure overlap. The attribution is often derived by analyzing the nature and geography of the campaign\ntargets in relation to geopolitical situation. However, in the case of mercenary APTs, the selection of victims might appear\nrandom and will rarely reveal a bigger picture about the motives behind the campaigns.\n\nWhen dealing with threat actors that outsource their campaigns, only the entity that performed the attack can be tracked,\nwhile the actual perpetrator becomes more elusive than ever.\n\n**Indicators of Compromise (IoCs):**\n\n**Indicator** **Type** **Description**\n\n130fa726df5a58e9334cc28dc62e3ebaa0b7c0d637fce1a66daff66ee05a9437 SHA256 SombRAT x86 loader\n\n8062e1582525534b9c52c5d9a38d6b012746484a2714a14febe2d07af02c32d5 SHA256 SombRAT x86 loader\n\nd69764b22d1b68aa9462f1f5f0bf18caebbcff4d592083f80dbce39c64890295 SHA256 SombRAT x86 loader\n\nf6ecdae3ae4769aaafc8a0faab30cb66dab8c9d3fff27764ff208be7a455125c SHA256 SombRAT x86 loader\n\n561bf3f3db67996ce81d98f1df91bfa28fb5fc8472ed64606ef8427a97fd8cdd SHA256 SombRAT x86 payload\n(memory dump)\n\n8323094c43fcd2da44f60b46f043f7ca4ad6a2106b6561598e94008ece46168b SHA256 SombRAT x86 payload\n\n\nee0f4afee2940bbe895c1f1f60b8967291a2662ac9dca9f07d9edf400d34b58a\n\nee0f4afee2940bbe895c1f1f60b8967291a2662ac9dca9f07d9edf400d34b58a\n\n\nSHA256 SombRAT x86 payload\n(UPX)\n\n\n-----\n\n70d63029c65c21c4681779e1968b88dc6923f92408fe5c7e9ca6cb86d7ba713a SHA256 SombRAT encoded payload\n(x64)\n\n79009ee869cec789a3d2735e0a81a546b33e320ee6ae950ba236a9f417ebf763 SHA256 SombRAT decoded payload\n(x64)\n\nd8189ebdec637fc83276654635343fb422672fc5e3e2818df211fb7c878a3155 SHA256 Payload stager\n\nfa74f70baa15561c28c793b189102149d3fb4f24147adc5efbd8656221c0960b SHA256 GO-socks5 proxy\n\nc0db3dadf2e270240bb5cad8a652e5e11e3afe41b8ee106d67d47b06f5163261 SHA256 Pcheck proxy\n\n6df8271ae0380737734b2dd6d46d0db3a30ba35d7379710a9fb05d1510495b49 SHA256 Pcheck proxy\n\n7424d6daab8407e85285709dd27b8cce7c633d3d4a39050883ad9d82b85198bf SHA256 Pscan port scanner\n\nsvolcdst.exe Filename SombRAT loader\n\ntunnusvcen.exe Filename SombRAT loader\n\n\nC:\\Projects\\Sombra\\_Bin\\x64\\Release\\Sombra.pdb PDB\npath\n\nC:\\Wokrflow\\CostaRicto\\Release\\CostaBricks.pdb PDB\npath\n\n\nSombRAT x64\n\nSombRAT loader\n\n\n%HOSTNAME%UI724 Mutex Run-once mutex\n\n%HOSTNAME%SUI724 Mutex Run-once mutex\n\nsbibd[.]net Domain SombRAT C2\n\ninfosportals[.]com Domain SombRAT C2\n\nakams[.]in Domain SombRAT C2\n\nnewspointview[.]com Domain SombRAT C2\n\n159.65.31.84 IP SombRAT hosting place\n\n212.83.61.227 IP sbibd[.]net\n\n144.217.53.146 IP sbibd[.]net, akams[.]in,\ninfosportals[.]com\n\n45.89.175.206 IP akams[.]in\n\n45.138.172.54 IP newspointview[.]com\n\n\n-----\n\n212.114.52.98 IP infosportals[.]com\n\n**MITRE ATT&CK:**\n\n**Tactic** **ID** **Name** **Description**\n\nInitial Access [T1078](https://attack.mitre.org/techniques/T1078/) Valid Accounts Suspected initial compromise\nusing stolen credentials\n\nExecution [T1106](https://attack.mitre.org/techniques/T1106/) Execution through API SombRAT – C2 command\n\n\n[T1053/005](https://attack.mitre.org/techniques/T1053/005/) Scheduled Task/Job:\nScheduled Task\n\n[T1059/001](https://attack.mitre.org/techniques/T1059/001/) Command and Scripting\nInterpreter: PowerShell\n\n\nUsed to download SombRAT\nloader\n\nUsed to load x64 SombRAT\n\n\nDefence\nEvasion\n\n\n[T1055](https://attack.mitre.org/techniques/T1055/) Process Injection Invoke-ReflectivePEInjection\nPowerSploit module\n\n\n[T1140](https://attack.mitre.org/techniques/T1140/) Deobfuscate/Decode Files or\nInformation\n\n\nSombRAT – Decode strings and\ncustom storage data\n\n\nDiscovery [T1057](https://attack.mitre.org/techniques/T1057/) Process Discovery SombRAT – C2 command\n\n[T1082](https://attack.mitre.org/techniques/T1082/) System Information Discovery SombRAT – C2 command\n\n[T1124](https://attack.mitre.org/techniques/T1124/) System Time Discovery SombRAT – C2 command\n\n[T1046](https://attack.mitre.org/techniques/T1046/) Network Service Scanning pscan, nmap\n\n\nCollection [T1560/003](https://attack.mitre.org/techniques/T1560/003/) Archive Collected Data: Archive\nvia Custom Method\n\n\nSombRAT – Custom storage file\n\n\nCommand\nand Control\n\n\n[T1572](https://attack.mitre.org/techniques/T1572/) Protocol Tunneling SombRAT - DNS tunnelling for C2\n\n\n[T1071/001](https://attack.mitre.org/techniques/T1071/001/) Application Layer Protocol:\nWeb Protocols\n\n[T1573/002](https://attack.mitre.org/techniques/T1573/002/) Encrypted Channel:\nAsymmetric Cryptography\n\n\nSombRAT – HTTP for C2\n\nSombRAT – RSA for C2\nencryption\n\n\n[T1090/002](https://attack.mitre.org/techniques/T1090/002/) Proxy: External Proxy pcheck HTTP/S proxy, GO\nSOCKS5 proxy, PuTTY\n\nExfiltration [T1041](https://attack.mitre.org/techniques/T1041/) Exfiltration Over C2 Channel SombRAT\n\n**Yara Hunting Rules:**\n\nimport \"pe\"\nimport \"hash\"\n\n\n-----\n\n**rule costaricto_vm_dropper**\n{\nmeta:\ndescription = \"Rule to detect SombRAT loader by code similarity\"\nauthor = \"BlackBerry Threat Hunting and Intelligence Team\"\n\nstrings:\n// vm class name\n$classname = \"VMBASERUNNER\" ascii wide nocase\n\n// start of vm bytecode\n$vmbytecode = {37C7359438C73594}\n\n// start of encrypted payload\n$encpayload_1 = {77D2C7AC59B2EB0DF37028AC950971FB}\n\n// binary string from enc payload (some payloads differ only in the header)\n$encpayload_2 = {06359D29C83125C321C201CF9AE7D1626B8F4281C33617EECE86BD106C628FE593936F00C2C\n68E28843BE5374F876840FCD1BFD014D5DEFF4BA8EB6A5FFFB24F932138B04C1BE6D5BD8BB572B8116799AE1C8F0\nD5DB774ABA4884B9E706981FC3740B4CD891F8A0EA6900D41B675CFC98A}\n\n// vm execution loop\n$vmcode_1 = {8B ?? 08 8B ?? 0C 89 ?? 29 ?? C1 ?? 02 39 ?? 74 4E 83 ?? ?? 08 8D ?? ?? 8B ?? ?? 8D ?? 01 89 ??\n8B ?? ?? 66 83 ?? 08 00 75 28 8B ?? ?? 8D ?? 04 5? 5? E8 ?? ?? FF FF 8B ?? ?? 83 ?? 0C 5? 8B ?? 0C 89 ?? 5? FF ?? 14\n83 C4 08 8B ?? 8B ?? 08 8B ?? 0C 89 ?? 29 ?? C1 ?? 02 39 ?? 89 ?? 75 B9}\n\n// vm execution loop (sample from Nov 2019)\n$vmcode_2 = {8B ?? 4? 89 ?? 8B ?? 08 8B ?? 88 33 ?? 66 39 ?? 08 75 19 8D ?? 04 5? 8D ?? 08 E8 ?? ?? 00 00 8B ??\n8D ?? 0C 5? 5? FF ?? 5? 5? 8B ?? 8B ?? 0C 2B ?? 08 C1 ?? 02 3B ?? 75 C7}\n\ncondition:\nuint16(0) == 0x5a4d and filesize < 5MB and filesize > 20KB and any of them\n}\n\n**rule costaricto_vm_dropper_pdb_path**\n{\nmeta:\ndescription = \"Rule to detect samples with CostaRicto PDB path\"\nauthor = \"BlackBerry Threat Hunting and Intelligence Team\"\npdb_string = \"C:\\\\Wokrflow\\\\CostaRicto\\\\Release\\\\CostaBricks.pdb\"\n\nstrings:\n$a = \"CostaRicto\" ascii wide nocase\n$b = \"CostaBricks.pdb\" ascii wide nocase\n$c1 = \"C:\\\\Wokrflow\\\\\" ascii wide nocase\n$c2 = \"Release\" ascii wide nocase\n$c3 = \".pdb\" ascii wide nocase\n\ncondition:\nuint16(0) == 0x5a4d and filesize < 5MB and filesize > 20KB and ($a or $b or all of ($c*))\n}\n\n**rule costaricto_sobmrat_pdb_path**\n{\nmeta:\ndescription = \"Rule to detect samples with SombRAT PDB path\"\nauthor = \"BlackBerry Threat Hunting and Intelligence Team\"\npdb_string = \"C:\\\\Projects\\\\Sombra\\\\_Bin\\\\x64\\\\Release\\\\Sombra.pdb\"\npdb_string_2 = \"c:\\\\projects\\\\sombra\\\\libraries\"\n\nstrings:\n$a = \"\\\\Projects\\\\Sombra\\\\\" ascii wide nocase\n$b = \"Sombra.pdb\" ascii wide nocase\n\ncondition:\nuint16(0) == 0x5a4d and filesize < 5MB and filesize > 20KB and ($a or $b)\n}\n\n\n-----\n\n**u e costa cto_bac doo ed_b**\n{\nmeta:\ndescription = \"Rule to detect backdoored Blink application\"\nauthor = \"BlackBerry Threat Hunting and Intelligence Team\"\n\nstrings:\n$a1 = \"Failed to open target application process!\"\n$a2 = \"Machine architecture mismatch between target application and this application!\"\n$a3 = \"Failed to create new communication pipe!\"\n$b = \"Plauger, licensed by Dinkumware, Ltd.\"\n\ncondition:\nuint16(0) == 0x5a4d and filesize < 5MB and filesize > 50KB and ($b and 1 of ($a*))\n}\n\n**rule costaricto_rich_header**\n{\nmeta:\ndescription = \"Rule to detect Rich header associated with CostaRicto campaign\"\nauthor = \"BlackBerry Threat Hunting and Intelligence Team\"\n\ncondition:\npe.rich_signature.toolid(0xf1, 40116) and\npe.rich_signature.toolid(0xf3, 40116) and\npe.rich_signature.toolid(0xf2, 40116) and\npe.rich_signature.toolid(0x105, 26706) and\npe.rich_signature.toolid(0x104, 26706) and\npe.rich_signature.toolid(0x103, 26706) and\npe.rich_signature.toolid(0x93, 30729) and\npe.rich_signature.toolid(0x109, 27023) and\npe.rich_signature.toolid(0xff, 27023) and\npe.rich_signature.toolid(0x97, 0) and\npe.rich_signature.toolid(0x102, 27023)\n}\n\n**rule costaricto_rich_header_august**\n{\nmeta:\ndescription = \"Rule to detect Rich header associated with CostaRicto campaign\"\nauthor = \"BlackBerry Threat Hunting and Intelligence Team\"\n\ncondition:\npe.rich_signature.toolid(0xf1, 40116) and\npe.rich_signature.toolid(0xf2, 40116) and\npe.rich_signature.toolid(0xf3, 40116) and\npe.rich_signature.toolid(0x102, 26428) and\npe.rich_signature.toolid(0x103, 26131) and\npe.rich_signature.toolid(0x104, 26131) and\npe.rich_signature.toolid(0x105, 26131) and\npe.rich_signature.toolid(0x103, 26433) and\npe.rich_signature.toolid(0x104, 26433) and\npe.rich_signature.toolid(0x109, 26428) and\npe.rich_signature.toolid(0x93, 30729) and\npe.rich_signature.toolid(0xff, 26428)\n}\n\n**rule costaricto_rich_xor_key**\n{\nmeta:\ndescription = \"Rule to detect Rich header associated with CostaRicto campaign\"\nauthor = \"BlackBerry Threat Hunting and Intelligence Team\"\n\ncondition:\n// x86 droppers\npe.rich_signature.key == 0x2e8d923f or\npe.rich_signature.key == 0x97d94c45 or\n\n// x86 payload\n\npe.rich signature.key == 0xef257087 or\n\n\n-----\n\npe c _s g a u e ey 0 5 08 o\npe.rich_signature.key == 0x1e816e7e or\n// x64 payload\npe.rich_signature.key == 0xd1e5ae6c or\npe.rich_signature.key == 0x5df9c60b\n}\n\n**rule costaricto_sombrat_unpacked**\n{\nmeta:\ndescription = \"Rule to detect unpacked SombRAT backdoor\"\nauthor = \"BlackBerry Threat Hunting and Intelligence Team\"\n\nstrings:\n// class names\n$a1 = \"PEHeadersBackup\"\n$a2 = \"PeLoaderDummy\"\n$a3 = \"PeLoaderLocal\"\n$a4 = \"PeLoaderBaseClass\"\n$a5 = \"PDTaskman\"\n$a6 = \"PDMessageParamArray\"\n$a7 = \"NetworkDriverLayerWebsockets\"\n$a8 = \"NetworkDriverLayerDNSReader\"\n$a9 = \"WaitForPluginIOCPFullyClosed\"\n\n// substitution-encrypted strings\n$b1 = \"~ydcv{{rs{~|r\"      // installedlike\n$b2 = \"~yg{vcqxez\"       // winplatform\n$b3 = \"~yqxezvc~xyvttrgcrs\"   // informationaccepted\n$b4 = \"xvsqexzdcxevpr\"     // loadfromstorage\n$b5 = \"xvsqexzzrzxen\"      // loadfrommemory\n$b7 = \"xgrydcxevpr\"       // openstorage\n$b8 = \"g{bp~y{xvstxzg{rcr\"   // pluginloadcomplete\n$b9 = \"g{bp~yby{xvs\"      // pluginunload\n\n// AES-encrypted strings\n$c1 = {44 5B 7F 52 0C 13 52 1A 16 45 4C 75 65 72 60 53}\n\n// RSA public key\n$d1 = {EF C9 77 B9 A3 8E 48 92 77 C8 E1 E1 0C 46 35 2B}\n\ncondition:\nuint16(0) == 0x5a4d and filesize < 5MB and filesize > 20KB and any of them\n}\n\n**rule costaricto_pcheck_proxy**\n{\nmeta:\ndescription = \"Rule to detect a custom proxy tool related to the CostaRicto campaign\"\nauthor = \"BlackBerry Threat Hunting and Intelligence Team\"\n\nstrings:\n$a = \"exe.exe host host_port proxy_host proxy_port\"\n$b = \"Tool jobs done\"\n\ncondition:\nuint16(0) == 0x5a4d and filesize < 500KB and filesize > 10KB and ($a or $b)\n}\n\n**rule costaricto_pscan_port_scanner**\n{\nmeta:\ndescription = \"Rule to detect a custom proxy tool related to the CostaRicto campaign\"\nauthor = \"BlackBerry Threat Hunting and Intelligence Team\"\n\nstrings:\n$a1 = \"Invalid arguments count (ver \"\n$a2 = \"Example: ./pscan\"\n\n\n-----\n\n$a3 30 0 0\n$b1 = \"[output.txt]\"\n$b2 = \"Invalid ip address range\"\n\ncondition:\nuint16(0) == 0x5a4d and filesize < 500KB and filesize > 10KB and any of ($a*) or all of ($b*)\n}\n\n**IDAPython Scripts:**\n\n#!/usr/bin/python\n\n**import sys, os, struct, array**\n\nfin = sys.argv[1]\nfout = \"%s_decoded\" %(fin)\nf = open(fin, \"r+w+b\")\nf2 = open(fout, \"w+b\")\nencsize = os.path.getsize(fin) **/ 4**\n\nkey_1 = 0x14820285\nkey_2 = 0x26820323\nkey_3 = 0x35223562\nkey_4 = 0x41256421\ncst_1 = 0x61C88647\ncst_2 = 0x9E3779B9\n\nenc = array.array('I')\nenc.read(f, encsize)\n\ni = 0\n\n**while i < encsize:**\nencdw_1 = enc[i]\nencdw_2 = enc[i+1]\n\ntmp_1a = encdw_1 << 4 & 0xffffffff\ntmp_1b = encdw_1 >> 5 & 0xffffffff\ntmp_1c = encdw_1 - cst_1 & 0xffffffff\ntmp_2a = tmp_1a + key_3 & 0xffffffff\ntmp_2b = tmp_1b + key_4 & 0xffffffff\ntmp_3 = tmp_2a ^ tmp_1c\n\nkeydw_2 = tmp_3 ^ tmp_2b\ndecdw_2 = encdw_2 - keydw_2 & 0xffffffff\n\nmagic_1 = decdw_2 << 4 & 0xffffffff\nmagic_2 = decdw_2 >> 5 & 0xffffffff\nkey_1a = key_1 + magic_1 & 0xffffffff\nkey_2a = key_2 + magic_2 & 0xffffffff\ncst_2a = cst_2 + decdw_2 & 0xffffffff\ntmp_5 = key_1a ^ cst_2a\n\nkeydw_1 = tmp_5 ^ key_2a\ndecdw_1 = encdw_1 - keydw_1 & 0xffffffff\n\ndata1 = struct.pack('I', decdw_1)\ndata2 = struct.pack('I', decdw_2)\n\nf2.seek(i*4)\nf2.write(data1)\nf2.seek(i*4+4)\nf2.write(data2)\n\ni = i + 2\n\n_Figure 24: SombRAT payload decryption script_\n\n\n-----\n\n**import idc, idaapi, idautils**\n**import idautils**\n**import string, array, struct, binascii**\n\n**def isprintable(s, codec='ascii'):**\n**try: s.decode(codec)**\n**except UnicodeDecodeError:** **return** **False**\n**else:** **return** **True**\n\n**def get_int(addr):**\n**return struct.unpack('I', get_bytes(addr, 4))[0]**\n\n**def add_comment(offset, comment):**\nidc.MakeComm(offset, comment)\ntarget = idc.DfirstB(offset)\n**while target != BADADDR:**\nidc.MakeComm(target, comment)\ntarget = idc.DnextB(offset, target)\n\n**def substitution(start, size, patch):**\ndec = \"\"\nenclen = size\nplain = \"`abcdefghijklmnopqrstuvwxyz{|}~H&\\x7F\"\nkey =  \"wvutsrqp\\x7F~}|{zyxgfedcba`onmlkji&Hh\"\n**if len(key)** **!= len(plain):**\nwarning(\"Lenght differs!\")\ni = 0\n**for i in range(enclen):**\nc = Byte(start + i)\nidx = key.find(str(chr(c)))\n**if idx !=** **-1:**\nc = plain[idx]\n**else:**\nc = str(chr(c))\ndec = dec + c\n**if patch ==** **True:**\npatch_byte(start + i, c)\ni += 1\n**return dec**\n\n# iterate over all segments\n**for s in idautils.Segments():**\n**if \".data\" in idc.SegName(s):**\nstart = idc.GetSegmentAttr(s, idc.SEGATTR_START)\nend = idc.GetSegmentAttr(s, idc.SEGATTR_END)\nnum = 0\n**while start < end - 4:**\n**if get_int(start)** **== 0:**\nenclen = get_int(start+4)\nencstrcheck = get_int(start+8)\n**if enclen > 1 and enclen < 100 and encstrcheck > 0x2020:**\nencstr = idc.get_bytes(start+8, enclen)\n**if isprintable(encstr)** **==** **True:**\nnum += 1\nstartaddr = start+8\n\n**print(\"#%i\")** **%num**\n**print(\"address = 0x{:08x}\".format(start))**\n**print(\"len = %i\")** **%enclen**\n**print(\"encstr = %s\")** **%encstr**\ndecstr = \"\"\ndecstr = substitution(startaddr, enclen, 0)\n**print(\"decstr =%s\") % decstr**\n**print(\"-----------------------------------------\")**\nidc.MakeComm(start, \"{}\".format(decstr))\ndecname = \"s_\" +\n**(''.join(e for e in decstr if e.isalnum()))[:20]**\n\n\n-----\n\ndec a e dec a e s p()\nres = MakeNameEx(start, decname,\nSN_NOCHECK | SN_NOWARN | 0x800)\n\nstart += 4\n\nFigure 25: SombRAT string decoding IDA Python script (for x86 payloads)\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats, providing intelligence analysis for\nthe benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-12 - The CostaRicto Campaign- Cyber-Espionage Outsourced.pdf"
    ],
    "report_names": [
        "2020-11-12 - The CostaRicto Campaign- Cyber-Espionage Outsourced.pdf"
    ],
    "threat_actors": [
        {
            "id": "c72c09b8-81ba-4e6e-9094-cd84ee4bda79",
            "created_at": "2022-10-25T15:50:23.667393Z",
            "updated_at": "2025-03-27T02:00:55.517974Z",
            "deleted_at": null,
            "main_name": "CostaRicto",
            "aliases": [
                "CostaRicto"
            ],
            "source_name": "MITRE:CostaRicto",
            "tools": [
                "PowerSploit",
                "SombRAT",
                "PsExec",
                "PS1",
                "CostaBricks"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b77f9b40-dca7-449d-819e-115cd2295b41",
            "created_at": "2022-10-25T16:07:23.502671Z",
            "updated_at": "2025-03-27T02:02:09.834738Z",
            "deleted_at": null,
            "main_name": "CostaRicto",
            "aliases": [],
            "source_name": "ETDA:CostaRicto",
            "tools": [
                "CostaBricks",
                "PowerSploit",
                "PsExec",
                "SombRAT",
                "nmap"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "115cf618-02a8-42b8-8d25-305292eafedb",
            "created_at": "2023-11-21T02:00:07.396534Z",
            "updated_at": "2025-03-27T02:00:03.251048Z",
            "deleted_at": null,
            "main_name": "CostaRicto",
            "aliases": [],
            "source_name": "MISPGALAXY:CostaRicto",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535578,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653775689,
    "ts_modification_date": 1653775689,
    "files": {
        "pdf": "https://archive.orkl.eu/ca3546688a47b847d5f7c407d5398fdc04eb9e54.pdf",
        "text": "https://archive.orkl.eu/ca3546688a47b847d5f7c407d5398fdc04eb9e54.txt",
        "img": "https://archive.orkl.eu/ca3546688a47b847d5f7c407d5398fdc04eb9e54.jpg"
    }
}