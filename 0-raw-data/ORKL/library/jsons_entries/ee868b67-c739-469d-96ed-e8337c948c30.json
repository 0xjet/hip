{
    "id": "ee868b67-c739-469d-96ed-e8337c948c30",
    "created_at": "2023-01-12T14:59:49.873088Z",
    "updated_at": "2025-03-27T02:09:29.849629Z",
    "deleted_at": null,
    "sha1_hash": "4ff8f1be08a9b88f814a49e9da2dea7636f2b8c0",
    "title": "2016-07-06 - New OSX-Keydnap malware is hungry for credentials",
    "authors": "",
    "file_creation_date": "2009-07-21T15:19:39Z",
    "file_modification_date": "2009-07-21T15:37:32Z",
    "file_size": 1054142,
    "plain_text": "# Common Cyber Security Vulnerabilities\n\n Observed in DHS Industrial Control Systems\n\n Assessments\n\n## July 2009\n\n\n-----\n\n-----\n\n#### EXECUTIVE SUMMARY\n\nThe U.S. Department of Homeland Security (DHS) National Cyber Security\nDivision’s Control Systems Security Program (CSSP) performs cyber security\nassessments of Industrial Control Systems (ICS) to help industry improve the\nsecurity of the ICS used in critical infrastructures throughout the United States. A\nkey part of this mission is the assessment of ICS to identify vulnerabilities that\ncould put critical infrastructures at risk from a cyber attack.\n\nThis report presents results from 15 ICS assessments performed under the\nCSSP from 2004 through 2008. Although information found in individual\nstakeholder reports is protected from disclosure, the security of the critical\ninfrastructure as a whole can be improved by sharing information on common\nsecurity problems with those in industry responsible for developing and\nmaintaining ICS. For this reason, vulnerability information was collected,\nanalyzed, and organized in a way that the most prevalent issues could be\nidentified and mitigated by those responsible for individual systems without\ndisclosing the identity of the associated ICS product.\n\nCommon vulnerabilities were derived from correlated vulnerabilities\nidentified by the 15 ICS assessments and grouped into general categories. Poor\nnetwork protocol implementations, information disclosure, and authentication\nproblems contain the most report findings. The common assessment findings are\ndescribed under their respective categories along with specific examples and\nrecommendations. General recommendations are based on empirical knowledge\ngained through performing security assessments on ICS products and operational\ninstallations.\n\nThe assessment findings were also categorized by where the security\nproblems occur within the ICS software, hardware, and network components.\nProprietary ICS applications had the highest vulnerability count because most\nCSSP assessments to date have been on new vendor product releases.\n\nThis information will benefit vendors, asset owners, and other stakeholders\nresponsible for securing the systems that control the nation’s critical\ninfrastructure. System vendors learn of common weaknesses in ICS applications,\nservices, and protocols, and how to better secure their products. Asset owners can\nevaluate possible weaknesses in their installed system configurations and learn\nhow they can fix or mitigate them with secure firewall configurations, intrusion\ndetection systems, and network architectures. Understanding the types of\nvulnerabilities commonly found and mitigating them can serve to help protect the\nsystems currently in development as well as those already installed in critical\ninfrastructure applications.\n\nThis report represents a steadily growing understanding of ICS security\nissues and methods for mitigating current vulnerabilities as well as new\ntechnologies and approaches being developed in response to ICS security\nchallenges. The assessment effort is expanding to new technologies as CSSP\nseeks a continuing understanding of the control systems being planned and\ndeployed.\n\n\n-----\n\n-----\n\n#### CONTENTS\n\nEXECUTIVE SUMMARY .........................................................................................................................iii\n\nACRONYMS...............................................................................................................................................ix\n\n1. INTRODUCTION.............................................................................................................................. 1\n\n2. ASSESSMENT METHODOLOGIES ............................................................................................... 2\n2.1 Approach Limitations .............................................................................................................. 3\n2.2 Impact on ICS Security............................................................................................................ 5\n\n3. COMMON ICS ASSESSMENT FINDINGS .................................................................................... 6\n3.1 CSSP Findings Mapped to the ISA SP99 Reference Model Levels ...................................... 10\n3.1.1 Level 4: Enterprise Systems...................................................................................... 11\n3.1.2 Level 3: Operations Management............................................................................. 12\n3.1.3 Level 2: Supervisory Control.................................................................................... 13\n3.1.4 Level 1: Local or Basic Control................................................................................ 14\n\n4. UNDERSTANDING COMMON ICS VULNERABILITIES ......................................................... 16\n4.1 Common ICS Software Vulnerabilities ................................................................................. 16\n4.1.1 Poor Code Quality..................................................................................................... 16\n4.1.2 Vulnerable Web Services.......................................................................................... 17\n4.1.3 Poor Network Protocol Implementations.................................................................. 18\n4.1.4 Information Disclosure ............................................................................................. 22\n4.1.5 Poor Patch Management ........................................................................................... 25\n4.1.6 ICS Performs Weak Authentication.......................................................................... 26\n4.1.7 Least User Privileges Violation ................................................................................ 27\n4.1.8 Summary of Common ICS Software Vulnerabilities................................................ 27\n4.2 Common ICS Configuration (Implementation) Vulnerabilities............................................. 29\n4.2.1 Poor Patch Management ........................................................................................... 29\n4.2.2 Weak User Authentication........................................................................................ 30\n4.2.3 Information Disclosure ............................................................................................. 32\n4.2.4 Summary of Common ICS Configuration Vulnerabilities........................................ 33\n4.3 Common ICS Network Vulnerabilities.................................................................................. 33\n4.3.1 Common ICS Network Design Vulnerabilities......................................................... 34\n4.3.2 Common ICS Network Component Configuration (Implementation)\nVulnerabilities........................................................................................................... 34\n4.3.3 Summary of Common ICS Network Vulnerabilities................................................ 35\n\n5. ICS SECURITY RECOMMENDATIONS...................................................................................... 37\n5.1 Recommendations for Vendors.............................................................................................. 37\n5.1.1 Create a Security Culture.......................................................................................... 38\n5.1.2 Enhance ICS Test Suites........................................................................................... 39\n5.1.3 Create and Test Patches ............................................................................................ 40\n5.1.4 Redesign Network Protocols for Security................................................................. 41\n5.1.5 Increase Robustness of Network Parsing Code ........................................................ 41\n5.1.6 Create Custom Protocol Parsers for Common IDSs ................................................. 41\n5.1.7 Document Necessary Services and Communication Channels................................. 42\n\n\n-----\n\n5.1.8 Implement and Test Strong Authentication and Encryption Mechanisms................ 42\n5.1.9 Improve Security through External Software Security Assessments........................ 43\n5.2 Recommendations for ICS Owners and Operators ................................................................ 43\n5.2.1 Restrict ICS User Privileges to only those Required ................................................ 44\n5.2.2 Change All Default Passwords and Require Strong Passwords................................ 45\n5.2.3 Test and Apply Patches............................................................................................. 45\n5.2.4 Protect Critical Functions with Network Security Zones and Layers....................... 46\n5.2.5 Customize IDS Rules for the ICS and Closely Monitor Logs .................................. 47\n5.2.6 Force Security through External Software Security Assessments ............................ 47\n\n6. SUMMARY ..................................................................................................................................... 49\n\n7. REFERENCES................................................................................................................................. 50\n\nAppendix A—CSSP Assessment Processes ............................................................................................... 51\n\nAppendix B—Common Vulnerability Identification.................................................................................. 55\n\nAppendix C—Terms and Definitions ......................................................................................................... 59\n\n#### FIGURES\n\nFigure 1. Percentage of CSSP assessment findings in each vulnerability category......................................7\n\nFigure 2. Percentage of CSSP assessment findings per ICS component type. .............................................9\n\nFigure 3. Percentage of CSSP assessment finding types. .............................................................................9\n\nFigure 4. Categorization of CSSP assessment findings using ISA99 reference model levels. ...................11\n\nFigure 5. Types of CSSP assessment findings in ISA SP99 Level 4..........................................................12\n\nFigure 6. Percentage of component types with CSSP assessment findings in ISA SP99 Level 4..............12\n\nFigure 7. Types of CSSP assessment findings in ISA SP99 Level 3..........................................................13\n\nFigure 8. Percentage of component types with CSSP assessment findings in ISA SP99 Level 3..............13\n\nFigure 9. Types of CSSP assessment findings in ISA SP99 Level 2..........................................................14\n\nFigure 10. Percentage of component types with CSSP assessment findings in ISA SP99 Level 2............14\n\nFigure 11. Types of CSSP assessment findings in ISA SP99 Level 1........................................................15\n\nFigure 12. Percentage of component types with CSSP assessment findings in ISA SP99 Level 1............15\n\nFigure 13. Generic Man-in-the-Middle attack. ...........................................................................................22\n\nFigure 14. CSSP assessment findings related to ICS products...................................................................28\n\nFigure 15. CSSP assessment ICS implementation findings........................................................................33\n\nFigure 16. CSSP assessment network security findings. ............................................................................36\n\n\n-----\n\n#### TABLES\n\nTable 1. Summary of common CSSP ICS assessment findings. ..................................................................8\n\nTable 2. Reference model for ISA99 standards. .........................................................................................10\n\nTable 3. Summary of common ICS software assessment findings.............................................................28\n\nTable 4. Summary of common ICS configuration findings........................................................................33\n\nTable 5. Summary of common ICS assessment network findings..............................................................36\n\n\n-----\n\n-----\n\n#### ACRONYMS\n\nARP address resolution protocol\n\nCAPEC Common Attack Pattern Enumeration and Classification\n\nCRADA Cooperative Research and Development Agreement\n\nCSSP Control Systems Security Program\n\nCVE common vulnerability enumeration\n\nDCOM Distributed Component Object Model\n\nDHS U.S. Department of Homeland Security\n\nDLL dynamic-link library\n\nDMZ demilitarized zone\n\nDNP distributed network protocol\n\nDOE-OE U.S. Department of Energy - Office of Electricity Delivery and Energy Reliability\n\nDoS denial-of-service\n\nFTP File Transfer Protocol\n\nHMI human-machine interface\n\nHTTP Hypertext Transfer Protocol\n\nHTTPS Hypertext Transfer Protocol over Secure Socket Layer\n\nIACS Industrial Automation and Control Systems\n\nICCP Inter-Control Center Communications Protocol\n\nICMP Internet Control Message Protocol\n\nICS industrial control system(s)\n\nIDS intrusion detection system(s)\n\nIEC International Electrotechnical Commission\n\nIP Internet Protocol\n\nIPSec Internet Protocol security\n\nIT Information Technology\n\nLAN local area network\n\nLM LAN Manager (password hash)\n\nMAC media access control\n\nMitM Man-in-the-Middle\n\nNDA nondisclosure agreement\n\nNTLM NT LAN Manager\n\nOLE Object Linking and Embedding\n\nOPC OLE for Process Control\n\n\n-----\n\nOS operating system\n\nPLC programmable logic controller\n\nRPC Remote Procedure Call\n\nrsh remote shell\n\nRTU remote terminal unit\n\nSCADA Supervisory Control and Data Acquisition\n\nSDL security development lifecycle\n\nSIS Safety Instrumented System\n\nSQL Structured Query Language\n\nSSH Secure Shell\n\nSSL Secure Sockets Layer\n\nTASE Telecontrol Application Service Element\n\nVPN virtual private network\n\nWAN wide area network\n\n\n-----\n\n### Common Cyber Security Vulnerabilities Observed in DHS ICS Assessments\n\n#### 1. INTRODUCTION\n\nThe U.S. Department of Homeland Security (DHS) National Cyber Security Division established the\nControl System Security Program (CSSP) to help industry and government improve the security of the\nindustrial control systems (ICS) used in critical infrastructures throughout the United States. A key part of\nthe CSSP mission is the assessment of ICS to identify vulnerabilities that could put critical infrastructures\nat risk for a cyber attack. Once these vulnerabilities are identified, mitigation strategies are developed to\nenhance ICS security.\n\nCSSP has established a collaborative effort among vendors, owners/operators, industry partners, and\nother national laboratories to provide an assessment environment where ICS can be evaluated for security\nvulnerabilities. This controlled environment allows realistic assessments of systems and components\nwithout the adverse consequences resulting from potential system failures.\n\nThe CSSP performs assessments to evaluate vendors’ ICS software and assess security issues due to\nthe interdependencies and network design of operational ICS installations. Operational ICS assessments\nuse nonintrusive methods, such as reviewing the production system network diagrams and firewall rules,\nand performing a hands-on assessment of a duplicate nonproduction installation of the system.\n\nAssessment efforts focus on identifying and understanding the vulnerabilities in ICS that require\naccess to the hardware and software that comprise these systems. This report documents common\nfindings generated from the cyber security assessments.\n\nThe term “ICS,” as used throughout this report, includes Supervisory Control and Data Acquisition\nSystems, Process Control Systems, Distributed Control Systems, and other control systems specific to any\nof the critical infrastructure industry sectors. Although differences in these systems exist, their similarities\nenable a common framework for discussing and defining security controls. Standard cyber security\nconcepts apply to all computer hardware and software and can be discussed in general as well as specific\nterms to issues common in ICS. General causes of common ICS vulnerabilities and associated\nrecommendations are discussed in this report. High-level analysis of the problem areas provides insight\ninto the current state of ICS security as indicated by assessments of the latest products available and\nselected ICS installations.\n\nFirst, the CSSP assessment methodologies are discussed. Next, the common ICS assessment findings\nare analyzed according to the different security priorities and vulnerabilities commonly found in each of\nthe ISA99 network levels. Then the common ICS vulnerabilities are presented according to categories\nthat describe a general problem observed in multiple ICS security assessments. These general categories\nare grouped by (1) vulnerabilities inherent in the ICS product; (2) vulnerabilities caused during the\ninstallation, configuration, and maintenance of the ICS; and (3) the lack of adequate protection due to\npoor network design or configuration. Sanitized assessment findings are listed with the common\nvulnerability descriptions to aid in understanding the issues. General recommendations based on\nempirical knowledge gained through performing ICS security assessments are then grouped by software\ndevelopment recommendations for ICS vendors, ICS network configuration, and maintenance\nrecommendations for ICS owners. More information on the CSSP assessment process, common\nvulnerability recommendation identification, and terms and definitions is available in the appendixes.\n\n\n-----\n\n#### 2. ASSESSMENT METHODOLOGIES\n\nThe primary goal of the CSSP cyber assessments is to improve the security of the critical\ninfrastructure by delivering to each industry partner a report of all security problems found during the\nassessment along with associated recommendations for improving the security of their product or\ninfrastructure (as appropriate). The CSSP has performed assessments on a large variety of systems. For\neach assessment, the assessment plan and methodology are tailored to provide the most value to the\ncustomer owning the system. System configurations also vary considerably depending on ICS\nfunctionality, negotiated objectives, and whether the assessment was conducted in a laboratory or onsite.\nIn all cases, the architecture and boundaries for the system under test are carefully determined.\nAssessment targets are developed individually for each assessment based on the system configuration and\nassessment focus in order to address the concerns of the partners. Although a common approach is used\nfor all assessments, the details of each assessment vary; the fact that a vulnerability was not listed on a\nparticular system report does not imply that it did not exist on that system. Common vulnerabilities listed\nin this report are, therefore, limited to those tested for and found in multiple systems.\n\nLaboratory assessments are designed to evaluate vendor-specific products and services, such as\ncustom protocols, field equipment, applications, and services. The model is to assess systems in multiple\nphases: (1) a baseline system assessment that identifies vulnerabilities in the vendor’s default\nconfiguration and (2) an evaluation of the system following implementation of mitigation strategies based\non baseline assessment results. In some cases, more than two assessments have been performed on\ndifferent versions of an ICS. Assessment projects typically leverage a full-disclosure approach with the\nvendor and asset-owner partners. The CSSP focus is on the ICS and its perimeter. By collecting\nbackground architecture, policy, and configuration data from a project partner, the team can perform a\nmore thorough assessment of the system. Penetration testing is a security validation process performed by\nmany commercial entities. CSSP does not simulate a blind attack or penetration of the system, but instead\nworks with the project partner to gain the best understanding possible and provide insight to help mitigate\nvulnerabilities found in their ICS.\n\nA laboratory assessment generally starts with a basic information technology (IT) assessment of the\nsystem, including port scanning, vulnerability scanning, network mapping, password cracking, and\nnetwork sniffing and fuzzing. In addition to the IT assessment, specific targets or functional pieces of the\nsystem are evaluated. These targets are referred to as assessment targets. Testing is often conducted on the\nICS local area network (LAN), with the assumption that the attacker has penetrated perimeter protection\nand is on the ICS network. Typical assessment targets may be “Changing Alarms and Commands” or\n“Unauthorized Database Access.” If the test environment contains connections external to the ICS\nnetwork, such as to the corporate network, field equipment, or demilitarized zone (DMZ), these\nconnections can be assessed. Typical assessment targets for this portion of the ICS may be “Compromise\nthe Front End Processor” or “Assess Vulnerabilities in DMZ Servers.”\n\nAssessment targets are given a priority based on the level of functionality they provide to the system\nand their operational impacts to the system. Each target is allocated an appropriate amount of testing time\naccording to its priority level. The timeframe may be modified during the assessment based on testing\nresults. Depending on the complexity of the system, testing time for laboratory assessments is generally\nallotted up to 900 cyber security researcher-hours. The impact to the system is described, and a mitigation\nstrategy is proposed for each finding identified.\n\nOnsite system assessments generally assess how securely external connections, firewall\nconfigurations, intrusion detection systems (IDS), network architecture, and any other components are\ndeployed and installed. These assessments generally leverage findings from laboratory assessments with\nthe associated ICS vendor. This technique is commonly coined “ground truthing” because laboratory\nassessment findings are validated on installed systems. This interaction includes discussion on the\n\n\n-----\n\nviability of possible mitigations and defenses. Onsite assessments generally include 2 weeks of\nassessment at the asset owner’s site, and can take up to 300 cyber security researcher-hours.\n\nAssessment plans are tailored to each system and to each vendor. Objectives outlined in the\nassessment plan cover steps that might be potential goals of a real attacker attempting to exploit the ICS\nand cause damage to equipment, interrupt service, or harm people or the environment.\n\nThe methodology used for ICS cyber security assessments includes the following activities:\n\n- ICS target selection\n\nTogether with vendor or plant personnel, the CSSP assessment team identifies a list of assessment\ntarget areas. These targets are specific objectives for which the system owners identified or requested\nas priorities for security review, along with those identified to be of strategic interest to potential\nattackers. These targets are included in subsequent assessments of the same system.\n\n- Identification of vulnerabilities in selected targets\n\nUsing a combination of commercial, proprietary, and open-source tools, the cyber assessment team\ndiscovers information about the targets that may allow the assessment team to compromise the\npredefined targets. During the course of this discovery, the assessment team may also identify\nadditional targets.\n\n- Attempts to exploit the identified vulnerabilities\n\nWith the information gleaned from antecedent activities, the cyber assessment team attempts to\nexploit the vulnerabilities they have identified.\n\n- Characterization of identified vulnerabilities\n\nBy documenting their course of action and the results of each activity, the assessment team\ncharacterizes the vulnerabilities they have found in terms of the exposure of the vulnerability, the\nimpact of exploiting the vulnerability, and the simplicity of exploiting the vulnerability.\n\n- Recommendations for remediation of identified vulnerabilities\n\nHaving characterized the identified vulnerabilities, the assessment team provides their best\nrecommendation to remediate the vulnerabilities. These recommendations are based primarily on the\nexperience of the assessment team and input from the ICS vendor. They may not be fiscally feasible or\nreflect the operational constraints of the process ICS, but should be considered for risk management\npurposes. Appendix A contains more assessment information.\n\n#### 2.1 Approach Limitations\n\nThis report represents an attempt to assess the most critical vulnerabilities that could put ICS at risk\nfrom a cyber attack but does not provide a complete accounting of all possible vulnerabilities associated\nwith ICS.\n\nAssessment reports detail the system under test, the targeted components, the tests performed, the\nresults, and mitigation recommendations. This focus on identifying security problems and solutions was\nchosen because securing products used in critical infrastructure is part of the process. The focus has not\nbeen to simply measure security levels and produce reliable, repeatable, and comparable statistics\nrequired for common vulnerability reporting.\n\nKnowledge gained from CSSP assessments performed to assess and help improve the security of ICS\ndoes not have the exposure, scrutiny, and security culture change that common IT applications have\nreceived. Understanding the unique priorities, vulnerabilities, impacts, limitations, and operation inherent\nin ICS has been a research effort with evolving assessment procedures. As a result, assessments are\ncustomized and tailored to the specific ICS security constraints that the vendor and CSSP assessment\n\n\n-----\n\nteams determine to be critical to the protection of key resources. These security constraints are a\ncombination of targets based on perceived vulnerabilities, impacts or exposure of system components,\nfunctionality, and evaluation of security measures built into, or placed around, the ICS.\n\nStandard assessment methodology has a common general theme but not all systems have been tested\nfor the same vulnerabilities. The CSSP assessment methodology is based on this idea of identifying\nsecurity weaknesses through an attacker’s perspective and communicating the security issues to the\nindustry partner from this perspective. CSSP ICS assessments are guided by assessment goals created and\ncustomized with industry partners in order to evaluate the ICS functionality both partners feel are highest\npriority for increasing the security of the particular product or installed ICS. The scope of assessments\nvaried from a proof of concept test of a single attack against a single ICS component, to level of effort\nidentification of possible attack vectors that would allow compromise of the ICS. A broad assessment\nscope has been very successful in helping increase awareness of the “out-of-the-box” attack methods for\nwhich the ICS sector needs to defend. However, this approach has not produced documented data on a\nconsistent set of vulnerabilities for each system assessed.\n\nA lack of consistent vulnerability data occurs because, many assessment goals are result-based, which\ntests whether an action such as causing a breaker to close could be accomplished by any means, instead of\na methodical assessment approach that tests for a given set of potential security flaws. Also, another\nfactor that contributed to the disparity of vulnerability tests was that not all systems configured for\nassessment have the same set of components and functionality. ICS inherently have many configuration\noptions, such as:\n\n- Operating system\n\n- Functionality shared on the same computer\n\n- Amount of redundancy\n\n- Connected field devices\n\n- Proprietary protocols used to communicate with field devices\n\n- Security features such as security zones, intrusion detection, and up-to-date methods.\n\nThe size and architecture of assessed systems varied widely. For example, assessed systems ranged\nfrom:\n\n- An ICS with the most basic functionality on a single local area network (LAN) with a few computers\n\n- An ICS with partial optional functionality, simulated data, and some network security defense devices\n\n- All available ICS functionality connected to control hardware with the recommended network\narchitecture and perimeter defenses\n\n- An operational system with duplicate system for interactive testing.\n\nThis disparity leads to differences in assessment focus based on what was available on the system for\nassessment and priority lists for which part of the system will be evaluated in the allotted timeframe.\n\nThe observations and recommendations in this report are based on common security practices and the\nexperience of the assessment team. There are many security issues and solutions common to ICS which\nhave been generalized in this report. The possible affects on the unique operation, maintenance, and\narchitecture of each ICS installation should be evaluated before implementing security mitigations.\nObservations and recommendations are based on the findings documented in CSSP assessment reports\nthat have been tailored toward the vendor and CSSP assessment teams’ knowledge and methods.\n\n\n-----\n\n#### 2.2 Impact on ICS Security\n\nReports generated from the assessment of ICS products and installations have been used by vendors\nand asset owners to understand and mitigate cyber vulnerabilities found during each assessment.\nAlthough not all findings have been addressed, most systems have been modified to improve security\nbased on assessment reports. After-action validation of mitigations to identified security flaws are\nperformed by the CSSP assessment team to help ensure the security assessments are successful in\nincreasing critical infrastructure security. Some of the vendors have been forthright in sharing the results\nwith their customers, and some have felt that any disclosure of vulnerabilities could lead to exposure of\ntheir customers to potential cyber attacks. Whether specific results were shared with ICS customers or\nnot, CSSP has shared general ICS security knowledge gained through the assessment process . Cyber\nsecurity and ICS researchers have presented results at varying levels of detail, and provided security\ntraining to attendees of the various vendor user group conferences. ICS security awareness has also been\nincreased through training, presentations, and documents generated from multiple assessments’ results.\n\nOnsite assessments have been conducted on installed ICS in order to help secure the particular site,\nverify laboratory findings, and gather common recommendations. This brings laboratory vendor\nassessments full circle to help the ICS software, operational implementations, and the associated critical\ninfrastructure become more secure.\n\n\n-----\n\n#### 3. COMMON ICS ASSESSMENT FINDINGS\n\nCommon CSSP assessment findings in this report were not derived from a comprehensive or even\nconsistent set of assessments or fully operational ICS. The common assessment findings that follow are\nsimilar security problems found on two or more unique ICS configurations. Common assessment findings\nand common ICS vulnerabilities refer to common vulnerabilities found in CSSP assessments. They are\nderived from detailed assessment findings. In order to maintain ICS product anonymity and bring findings\nup to a high enough level, different detailed findings were grouped into one common vulnerability. For\nexample, the common vulnerability, ICS protocol uses weak authentication, was derived from the\nfollowing assessment findings:\n\n- MitM altering of ICS communication possible between ICS and controller equipment\n\n- Firmware update uses weak integrity checks\n\n- MitM altering of ICS inter-process communication possible between ICS components\n\n- MitM altering of ICS communication possible between controller and field equipment.\n\nEach of these detailed findings may actually apply to one or multiple systems. There may also be\nother findings that were not listed because they were too indicative of the affected system. Remember,\nICS Protocol authentication may not have been evaluated on all systems. Therefore, an inference cannot\nbe made that vulnerabilities not included in this report are not common to ICS or that three detailed\nfindings under a common vulnerability means that only three systems assessed were susceptible to that\nvulnerability.\n\nTable 1 lists the common vulnerabilities found through CSSP security assessments. A common\nvulnerability describes findings from a minimum of two different ICS product lines or installed systems.\nVulnerability descriptions are generalized to remove specific vendor-identifying information and details\nthat would hinder the ability to group common vulnerabilities.\n\nAs with all common vulnerability categorization methods, overlaps exist between the different\ncategories that comprise each taxonomy. For example, poor code quality is a category that could contain\nall application types as subcategories (i.e., the database, Web, human-machine interface (HMI), and\nservices applications that make up an ICS product). Each of these subcategories would then contain a\n“lack of input validation” common vulnerability. Another option is to list lack of input validation as a\ngeneral vulnerability with or without specifying where it has been found to be a problem. Many different\ncategories can conceivably be used to view the vulnerability data, and will most likely result in different\nvulnerabilities being categorized together.\n\nAt a high level, common vulnerabilities in this document are categorized differently based on how the\nproblem is being viewed. Table 1 groups common ICS vulnerabilities according to nine general security\nproblems that sum up the main weaknesses that ICS products and installations are prone to have due to\nlegacy code, lack of security training and requirements, and ICS operational requirements. These\ncategories are not mutually exclusive, but highlight the main causes of vulnerabilities that put ICS at risk\nto cyber attack. Figure 1 shows the percentage of CSSP assessment findings for each of the categories in\nTable 1.\n\n\n-----\n\nFigure 1. Percentage of CSSP assessment findings in each vulnerability category.\n\n\n-----\n\nTable 1. Summary of common CSSP ICS assessment findings.\n\n**Category** **Common Vulnerability**\nPoor Code Quality Use of potentially dangerous functions in proprietary ICS application\nVulnerable Web Poor authentication\nServices\nDirectory traversal enabled\n\nUnauthenticated access to Web server\nPoor Network Protocol Lack of input validation: Buffer overflow in ICS service\nImplementations\nLack of input validation: Lack of bounds checking in ICS Service\n\nICS protocol uses weak authentication\nICS protocol uses weak integrity checks\nICS product relies on standard IT protocol that uses weak encryption\nPoor Patch Management Unpatched or old versions of third-party applications incorporated into ICS\nsoftware\n\nUnpatched operating system\n\nWeak Authentication ICS uses standard IT protocol that uses weak encryption\nUse of standard IT protocol with clear-text authentication\n\nClient-side enforcement of server-side security\nImproper security configuration\nNo password required\nWeak passwords\nWeak password requirements\nLeast User Privileges Unauthorized directory traversal allowed\nViolation\nServices running with unnecessary privileges\nInformation Disclosure Unencrypted proprietary ICS protocol communication\nUnencrypted nonproprietary ICS protocol communication\n\nUnencrypted services common in IT systems\nOpen network shares on ICS hosts\nWeak protection of user credentials\nInformation leak through unsecure service configuration\nNetwork Design Lack of network segmentation\nVulnerabilities\nFirewall bypassed\nNetwork Component Access to specific ports on host not restricted to required IP addresses\nConfiguration\n\nPort security not implemented on network equipment\n\nVulnerabilities\n\nICS are made up of process equipment, process control hardware, network devices, and computers.\nVulnerabilities in network devices and protocols, or the operating systems, ICS software, and other\nsoftware running on the ICS computers could allow an attacker to gather information about, disrupt, or\nmanipulate ICS operations. The percentage of CSSP assessment vulnerabilities that were found in each\nICS component are shown in Figure 2 below.\n\n|Category|Common Vulnerability|\n|---|---|\n|Poor Code Quality|Use of potentially dangerous functions in proprietary ICS application|\n|Vulnerable Web Services|Poor authentication|\n||Directory traversal enabled|\n||Unauthenticated access to Web server|\n|Poor Network Protocol Implementations|Lack of input validation: Buffer overflow in ICS service|\n||Lack of input validation: Lack of bounds checking in ICS Service|\n||ICS protocol uses weak authentication|\n||ICS protocol uses weak integrity checks|\n||ICS product relies on standard IT protocol that uses weak encryption|\n|Poor Patch Management|Unpatched or old versions of third-party applications incorporated into ICS software|\n||Unpatched operating system|\n|Weak Authentication|ICS uses standard IT protocol that uses weak encryption|\n||Use of standard IT protocol with clear-text authentication|\n||Client-side enforcement of server-side security|\n||Improper security configuration|\n||No password required|\n||Weak passwords|\n||Weak password requirements|\n|Least User Privileges Violation|Unauthorized directory traversal allowed|\n||Services running with unnecessary privileges|\n|Information Disclosure|Unencrypted proprietary ICS protocol communication|\n||Unencrypted nonproprietary ICS protocol communication|\n||Unencrypted services common in IT systems|\n||Open network shares on ICS hosts|\n||Weak protection of user credentials|\n||Information leak through unsecure service configuration|\n|Network Design Vulnerabilities|Lack of network segmentation|\n||Firewall bypassed|\n|Network Component Configuration Vulnerabilities|Access to specific ports on host not restricted to required IP addresses|\n||Port security not implemented on network equipment|\n\n\n-----\n\nFigure 2. Percentage of CSSP assessment findings per ICS component type.\n\nEach CSSP finding is a security risk to the ICS, but may not actually qualify as a vulnerability. To\npromote better understanding of assessment findings, Figure 3 displays the categories of finding types.\nConfiguration problems are security risks due to the way a system or application was installed and\nconfigured. This includes password policies, firewall, IDS and switch rules and placement, Web server\naccess rules, etc. Configuration problems are not vulnerabilities in the component itself but in specific\ncomponent usage.\n\nIn cyber security, known vulnerabilities are vulnerabilities that have been publically announced.\nSomeone has written or possibly published exploits for that vulnerability. All CSSP known vulnerability\nfindings had patches available. This report does not include findings from automated vulnerability scans\nunless the component was verified to be vulnerable. No large focus is generated for known vulnerabilities\nin CSSP assessments because the goal is to help identify security problems specific to the ICS software,\nwhich has not been subjected to the scrutiny as the more widespread products. Typically, assessment\nfindings note that vulnerable versions of operating systems, services, or applications are available on the\nICS and should be patched, upgraded, or removed. Known vulnerabilities are therefore a bigger problem\nthan Figure 3 portrays because patch management is not straightforward on ICS because of the risk that a\npatch or upgrade may adversely affect operations. The vendor and owner must be able to test the affect of\neach patch thoroughly on a representative system, and vendors may have to change ICS code to work\nwith new application versions.\n\nFigure 3. Percentage of CSSP assessment finding types.\n\nICS zero days are vulnerabilities found in ICS specific applications and protocols during assessments.\nZero days are known as such even though they have been disclosed to the vendor who may have disclosed\n\n\n-----\n\nthem to customers at some level. This report does not contain information on the number of ICS\nvulnerabilities that have been fixed or whether patches were released for existing systems.\n\nThe security risk category includes all findings that cannot be called a vulnerability per se, but do put\nthe ICS at a higher risk of attack. For example, having open ports on a host is necessary for\ncommunication. Otherwise, any open port could be disconnected from the network and it would only be\nat risk to physical attack. Services or applications running on a system open up different network ports to\nbe able to communicate to the outside world. Each open port provides a possible access path for an\nattacker that can be used to send exploits and receive data. An attacker can only gain access to and receive\ninformation from the ICS through an open port. The more ports and services that are accessible, the\ngreater the risk of successful exploits due to existing vulnerabilities in the services. Even if no known\nvulnerabilities exist in the current system, new vulnerabilities are found every day in the applications and\nservices that run on computers. Some of these vulnerabilities are published shortly after their discovery,\nand some are kept a close secret, allowing a few hackers to exploit computers at will, with no patches\navailable to stop them. Decreasing the number of installed applications and services decreases the\nlikelihood of an attacker finding a vulnerability on the computer. Example assessment findings\ncategorized as security risks are:\n\n- Use of a high-risk service with a history of vulnerability announcements\n\n- System has a large number of services running\n\n- Unencrypted communication\n\n- Lack of IDS.\n\n#### 3.1 CSSP Findings Mapped to the ISA SP99 Reference Model Levels\n\nThe ISA reference model creates a framework for referencing general Industrial Automation and\nControl Systems (IACS) network levels.[1] Although all CSSP assessment system networks were not\ndesigned consistently, this framework allows the findings to be consistently categorized by logical\nnetwork layers. Each level represents a class of functionality.[a] Table 2 lists the ISA SP99 reference model\nlevels and associated IACS and Supervisory Control and Data Acquisition (SCADA) functions.\n\nTable 2. Reference model for ISA99 standards.\n\n**ISA99 Standard IACS** **SCADA Reference Model**\n\n**ISA Level** **Functions** **Functions** **Functions**\nLevel 4 Enterprise Systems Business Planning & Engineering Systems\nLogistics\n\nLevel 3 Operations Operations Management System Management\nManagement Supervisory Control\n\nLevel 2 Supervisory Control Supervisory Control Site Monitoring & Local\nDisplay\nLevel 1 Local or Basic Control Basic Control Local Control\nSafety and Protection Protection\n\nLevel 0 Process Equipment Under Control Equipment Under Control\n\na. Note: The ISA IACS models are currently in the process of being updated.\n\n|ISA Level|Functions|ISA99 Standard IACS Functions|SCADA Reference Model Functions|\n|---|---|---|---|\n|Level 4|Enterprise Systems|Business Planning & Logistics|Engineering Systems|\n|Level 3|Operations Management|Operations Management|System Management Supervisory Control|\n|Level 2|Supervisory Control|Supervisory Control|Site Monitoring & Local Display|\n|Level 1|Local or Basic Control|Basic Control Safety and Protection|Local Control Protection|\n|Level 0|Process|Equipment Under Control|Equipment Under Control|\n\n\n-----\n\nThe majority of functionality evaluated in CSSP assessments was at the supervisory control level.\nNone of the assessments used for this report listed findings at the process level. Figure 4 illustrates the\npercentage of CSSP assessment findings identified in each of the ISA reference model levels. An Internet\nlevel was added for findings referring to information found on the Internet that could be used in an attack.\n\nFigure 4. Categorization of CSSP assessment findings using ISA99 reference model levels and an Internet\nlevel.\n\n##### 3.1.1 Level 4: Enterprise Systems\n\nLevel 4 can be thought of as the systems on the enterprise network used for business planning and\nlogistics. This level includes the business-related activities needed to manage a manufacturing\norganization. Functions include enterprise or regional financial systems and other enterprise infrastructure\ncomponents such as production scheduling, operational management, and maintenance management for\nan individual plant or site in an enterprise. Engineering systems are also considered to be in this level;\nhowever, CSSP engineering station findings were categorized in Level 2 because they were specific to the\n“normal” configuration where the engineering station was placed in the HMI LAN.\n\nFigure 5 groups the unsecure Web server configurations, weak passwords, IDS and firewall problems,\nand ICS information found on corporate LANs into the configuration problem category. Web HMI\nApplication zero-day vulnerabilities were also included in this level. Although vulnerabilities in Level 4\nmay aid an attacker by providing information about the ICS, the business planning and logistics functions\nare separate from the ICS functions in the lower layers. Compromise should only provide an attacker with\nprocess information or a launching point into the ICS (unless a Web HMI on the corporate network is\nallowed control of the process). The ISA model does not include ICS functions in Level 4 because\nsupervisory or process control functions need to be isolated and protected as much as possible due to high\npossible consequences.\n\n\n-----\n\nFigure 5. Types of CSSP assessment findings in ISA SP99 Level 4.\n\nFigure 6 shows that most CSSP assessment findings in Level 4 are in proprietary ICS applications\nused for business planning and logistics, including Web HMI applications. The rest are security risks due\nto the configuration of common applications and services, operating systems, and network components.\n\nFigure 6. Percentage of component types with CSSP assessment findings in ISA SP99 Level 4.\n\n##### 3.1.2 Level 3: Operations Management\n\nLevel 3 includes functions that manage ICS production (e.g., planning, scheduling, and quality\nassurance). The CSSP assessment components categorized in this level include all ICS management\nfunctions that can be separated from the supervisory control LAN such as data historians, ICS Web\nservers, Inter-Control Center Communications Protocol (ICCP) servers, and Object Linking and\nEmbedding (OLE) for Process Control (OPC) servers.\n\nFigure 7 illustrates that the majority of findings are ICS zero-day vulnerabilities with significant\nnumbers of configuration problems and known vulnerabilities. Figure 8 shows many Level 3 network\nperimeter defense problems have been found along with vulnerabilities in network protocols used to\ncommunicate with Level 3 applications. If the Level 3 perimeter defenses allow communications using\nvulnerable protocols or connections to vulnerable applications, an attacker may be able to gain a foothold\nonto the ICS network.\n\nThe elimination of known vulnerabilities is extremely important because they are generally easily\ndiscovered and exploited. ICS users are well advised to configure network perimeter defenses as securely\nas possible to prevent access to the ICS. All network protocols allowed between Level 4 enterprise\nsystems and the outer layer of the ICS network should be minimized and secured along with the\napplications that handle them. Finally, the importance of compartmentalization and security of all other\ntraffic and applications at this layer to prevent a Level 3 compromise from going deeper into the ICS\nnetwork cannot be underemphasized.\n\n\n-----\n\nFigure 7. Types of CSSP assessment findings in ISA SP99 Level 3.\n\nFigure 8. Percentage of component types with CSSP assessment findings in ISA SP99 Level 3.\n\n##### 3.1.3 Level 2: Supervisory Control\n\nLevel 2 includes the functions involved in monitoring and controlling the physical process. These\nfunctions include operator HMI applications that can send control commands and receive monitor data,\nalarms, and alerts.\n\nKnown vulnerabilities and configuration problems can provide pathways from a compromised\nLevel 3 component to the vulnerable Level 2 component. Operating systems and common third-party\nsoftware account for the known vulnerabilities in Figure 9. Configuration problems such as weak\npasswords and poor network design and access rules can also allow unauthorized access to Level 2\ncomponents.\n\nProprietary ICS protocols allowed between Levels 2 and 3 have been found susceptible to Man-inthe-Middle (MitM) attacks, which can be used for ICS information gathering and manipulation. The\napplications written to handle ICS traffic have been found vulnerable to invalid input exploits that can\ncause denial-of-service (DoS) of ICS communications or unauthorized access to Level 2 components.\nDoS of the protocols used to transfer ICS data on the supervisory control network can cause high impacts\nto systems that require monitor and control availability.\n\n\n-----\n\nFigure 9. Types of CSSP assessment findings in ISA SP99 Level 2.\n\nFigure 10 shows that CSSP assessments found the most Level 2 security problems in operating\nsystems, followed by proprietary ICS software used for supervisory control, common third-party\napplications, network devices, and then proprietary ICS communication protocols. Vulnerabilities and\nconfiguration problems with services shipped with the operating system are included in the Operating\nSystem count.\n\nFigure 10. Percentage of component types with CSSP assessment findings in ISA SP99 Level 2.\n\n##### 3.1.4 Level 1: Local or Basic Control \n\nLevel 1 is the control network that connects the supervisory control level to lower-level control\nmodules, including the functions used for sensing and manipulating the physical process.\n\nFigure 11 shows that half of the Level 1 assessment findings are ICS zero-day vulnerabilities. This\nvulnerability type is mapped to the ICS software, firmware, network protocols, hardware devices (e.g.,\nprogrammable logic controllers [PLCs], controllers, safety integrated systems, and remote terminal units\n\n[RTUs]) and security devices that make up 73% of the Level 1 vulnerable components in Figure 12. If an\nattacker is able to gain access to this level and reverse engineer the protocols and process, a malicious\nprevention or manipulation of sensing and control functions at the lowest level can occur.\n\nKnown vulnerabilities and configuration problems in the operating systems and applications running\non the control network devices and ICS devices provide opportunities for unauthenticated access to the\ncontrol network. CSSP assessments have found Web servers on PLCs and switches that do not require\nauthentication. Many communication protocols used to transfer process data, program ICS hardware, etc.,\nare plain text and use weak authentication and data integrity methods.\n\n\n-----\n\nFigure 11. Types of CSSP assessment findings in ISA SP99 Level 1.\n\nFigure 12. Percentage of component types with CSSP assessment findings in ISA SP99 Level 1.\n\n\n-----\n\n#### 4. UNDERSTANDING COMMON ICS VULNERABILITIES\n\nCSSP ICS security assessments have identified the vulnerabilities described in this section in a\nmajority of the systems that included the associated functionality. In addition to a subset of these common\nvulnerabilities, additional vulnerabilities unique to the individual ICS software and implementations were\nidentified. All these vulnerabilities can be mitigated by following secure software design and\ndevelopment principles, and secure platform, software, and network configuration guidelines.\n\nThe difference in securing ICS and a typical computer system is in the nonstandard ICS components\nthat do not use off-the-shelf hardware or software and have non-typical security priorities. Custom ICS\nhardware and software have not been scrutinized like common computer products. Therefore, although\nthey contain a high degree of vulnerabilities, very few of them have been publically announced. While\nadding security measures to ICS components, keep in mind the importance of functional requirements.\nUnlike typical IT systems, ICS security objectives are typically prioritized as:\n\n1. Availability\n\n2. Integrity\n\n3. Confidentiality.\n\nViolating operational requirements while implementing security features in ICS could cause more\ndamage than a cyber attack.\n\n#### 4.1 Common ICS Software Vulnerabilities\n\nThe ICS vendor software assessment findings are described in the following sections. Sanitized\nassessment details are listed with each common vulnerability description to aid in understanding the real\nissues. Multiple assessments may have findings that match the same vulnerability details, and one\nassessment may have multiple specific detailed vulnerabilities relating to one common vulnerability.\nSome common vulnerabilities have only one detailed example that describes all findings from the\nassociated assessments. The number of systems that were found at risk to a given vulnerability is not\nlisted in order to avoid any implication that all systems were tested for that vulnerability and to help lend\nanonymity to the ICS associated with common vulnerabilities and the related specific details listed.\n\n##### 4.1.1 Poor Code Quality\n\nPoor code quality refers to code issues that are not necessarily vulnerabilities, but indicate that it was\nnot securely developed. These products are more likely to contain vulnerabilities than those that were\ndeveloped using secure development concepts and other good programming practices. “If a program is\ncomplex, difficult to maintain, not portable, or shows evidence of neglect, then there is a higher likelihood\nthat weaknesses are buried in the code.”[2 ]\n\nICS code review and reverse engineering exercises indicate that ICS software has not been designed\nor implemented using secure software development concepts in general. The relatively greater ages of\ncore ICS applications increase the likelihood of development as stand-alone systems with only reliability\nand efficiency as requirements. However, new ICS applications tend to suffer from the same lack of\nsecure coding principles.\n\n**_4.1.1.1_** **_Use of Potentially Dangerous Functions in Proprietary ICS Applications_**\n\nOtherwise known as unsafe function calls, the application calls a potentially dangerous function that\ncould introduce vulnerability if used incorrectly, but the function also can be used safely. The problem\nwith using unsafe functions is that the developer is responsible for validating input. The number of\npublicly announced buffer overflow and other malformed input vulnerabilities is evidence that\nimplementing this validation is a high risk.\n\n\n-----\n\nUnsafe C/C++ function calls are the most notorious potentially dangerous functions. All have safe\ncounterparts, so there is no reason to use unsafe functions or not replace them in existing code. The\nstrcpy() function in C is an example of a potentially dangerous function because of introducing a buffer\noverflow vulnerability. If the input to strcpy can in any way be influenced, a chance exists that an attacker\ncan find a way to circumvent the developer’s logic. In many cases, the logic is only based on what would\nnormally happen, and a buffer overflow attack is successful because the developer decided that no one\nwould ever create a username longer than 1,024 characters. The attacker simply needs to try a few\nusernames to figure out that more than 1,024 characters causes problems. The developer can test to make\nsure nothing larger than the memory buffer he created is sent to strcpy(), but strncpy() eliminates this risk\nby requiring that the buffer size is specified. The following are specific assessment findings associated\nwith unsafe C/C++ function calls:\n\n- Several instances of unsafe function calls found in proprietary communications processing code\n\n- Unsafe C/C++ function calls in proprietary ICS code\n\n- Unsafe C/C++ functions in OPC dynamic-link libraries (DLLs)\n\n- Use of potentially dangerous functions in proprietary ICS application.\n\n**Recommendation: ICS applications tend to suffer from poor code quality. Vendors and asset owners**\nwho write custom applications should train developers in secure coding practices. All custom software\nshould undergo thorough code review via both manual and automated processes to identify security issues\nwhile the code is still in the development stage. ICS-specific protocols should be redesigned to include\nstrong authentication and integrity checks. IT products deployed on the ICS network should also have\npassed a security review. Asset owners should explicitly address the security of these products during the\nprocurement process.\n\n##### 4.1.2 Vulnerable Web Services\n\nMany ICS have recently incorporated Web applications and services to allow remote supervisory\ncontrol, monitoring, or corporate ICS data analysis. ICS assessments have found unauthorized directory\ntraversal and authentication problems with ICS Web implementations. Many of the poor code quality and\ninput validation findings in this section refer to proprietary Web applications.\n\n**_4.1.2.1_** **_Directory Traversal Enabled_**\n\nWeb application directory traversal vulnerabilities occur when file paths are not validated. Directory\ntraversals are commonly associated with Web applications, but all types of applications can have this\nclass of vulnerability. Directory Traversals occur when the developer uses a path provided by the user, but\nfails to validate the path in order to ensure that the user can only access the necessary files. For example,\nthe classic Hypertext Transfer Protocol (HTTP) “GET” directory traversal attack is performed by\nsubmitting “../” to tell the operating system (OS) to look up one directory. If the HTTP server was\nvulnerable to a directory traversal attack, this GET request would cause the HTTP to get the /etc/passwd\nfile. Directory traversal attacks can be used to gather information by downloading files, or to gain access\nto the ICS by uploading the exploit code to be executed. The damage that a directory traversal\nvulnerability can cause is related to the permission of the application that was vulnerable. If the\nvulnerable application has limited read/write permissions, the attacker may not be able to do anything of\nimportance. However, when running as system or root, then the damages can be extensive. Being able to\ndownload arbitrary files is more common then being able to upload files.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- Web servers on multiple assessment systems had directory traversal enabled\n\n- Web server directory browsing was enabled.\n\n\n-----\n\n**Recommendation: The file permissions on the Web server need to be set to grant the least privileges**\nnecessary. The system design needs to be evaluated to reduce necessary file access as much as possible.\nFeatures on the Web server, such as unrestricted browsing, need to be disabled and additional security of\nHTTP can be gained by utilizing the Secure Sockets Layer (SSL) where possible. The Web server should\nfilter input to screen incoming filenames and exclude the “..” string. Disabling unused ports and keeping\nthe Web server patched to current standards are good practices. Write permissions are most dangerous,\nbut read permissions may disclose valuable information or information that can be used for an attack.\n\n**_4.1.2.2_** **_Unauthenticated Access to Web Server_**\n\nWeb services developed for the ICS tend to be vulnerable to attacks that can exploit the ICS Web\nserver to gain unauthorized access. System architectures often use network demilitarized zones (DMZs) to\nprotect critical systems and to limit exposure of network components. Vulnerabilities in ICS DMZ Web\nservers may provide the first step in the attack path by allowing access within the ICS exterior boundary.\nVulnerabilities in lower level component’s Web servers can provide more steps in the attack path.\n\nICS assessments have also found poor authentication, poor session tracking, Structured Query\nLanguage (SQL) injection, and cross-site scripting vulnerabilities that can allow unauthorized access to\nWeb servers and applications. These types of issues were categorized in Section 4.1.3, Poor Network\nProtocol Implementations.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- Web server on controller required no authentication\n\n- Unauthenticated access to Web HMI Web server\n\n- Web HMI Web server username/password authentication bypass.\n\n**Recommendation: ICS applications should use well known and tested third-party Web servers to serve**\ntheir Web applications. Web applications should be thoroughly tested for malformed input and other\nvulnerabilities that could lead to a compromise of the ICS Web server.\n\n##### 4.1.3 Poor Network Protocol Implementations\n\nNetwork protocols specify how information is packaged and sent across a computer network. For\nevery network protocol, an application (known as server) must wait for and process the data off the\nnetwork. All ICS products use at least one protocol created specifically for ICS component\ncommunication. In order to communicate using standard (nonproprietary) ICS protocols, each ICS vendor\nmust implement their own server application to process the network traffic.\n\nPart of the protocol specification is if and how authentication, integrity checks, and confidentiality\nwill be implemented. Services that employ weak authentication methods can be exploited to gain\nunauthorized privilege. Poorly protected credentials can be found in documentation or code, sniffed “off\nthe wire,” cracked, or guessed.\n\n**_4.1.3.1_** **_Lack of input validation: Buffer Overflow in ICS Service_**\n\nInput validation is used to ensure that the content provided to an application does not grant an attacker\naccess to unintended functionality or privilege escalation. Buffer overflows are the result of programmer\noversight. This usually happens because the programmer only considered what should happen and what\ncould happen by mistake, but not all the “out of the box” possibilities such as entering a 2,000-characterlong last name.\n\nBuffer overflows result when a program tries to write more data into a buffer than the space allocated\nin memory. The “extra” data then overwrites adjacent memory, and ultimately results in abnormal\noperation of the program. A careful and successful memory overwrite can cause the program to begin\nexecution of actual code submitted by the attacker. Most exploit code allows the attacker to create an\n\n\n-----\n\ninteractive session and send commands with the privileges of the program with the buffer overflow.\nNetwork protocol implementations, which do not validate input values can be vulnerable to buffer\noverflow attacks.\n\nServices written by ICS vendors frequently suffer from coding practices that allow attackers to supply\nunexpected data and thus modify program execution. Some ICS protocol implementations are vulnerable\nto packets that are malformed or contain illegal or otherwise unexpected field values. Even though some\nICS protocols are commonly used, the services that receive and interpret the protocol traffic are usually\ncustomized to the vendor product. Vulnerabilities in these services were a main target of many\nassessments because buffer overflows in the ICS services are possible entry points onto the ICS\ncomponents.\n\nThe following are five specific assessment findings associated with this vulnerability:\n\n1. Multiple assessments found buffer overflows in ICS protocol implementations\n\na. Stack-based buffer overflows allowed remote code execution on ICS hosts\nb. Heap-based buffer overflows allowed remote code execution on ICS hosts\n2. Multiple assessments found buffer overflows in ICS application services\n\na. A buffer overflow was found in a proprietary historian database (historian communication\nprotocol server application)\nb. Username and Password Buffer Overflows in Web HMI Web Server\nc. Exploitable stack overflow in OPC server.\n\n**Recommendation: All code should be written to validate input data. All programmers should be trained**\nin secure coding practices, and all code should be reviewed and tested for input functions that could be\nsusceptible to buffer overflow attacks. All input should be validated, not just those proven to cause buffer\noverflows. Input should be validated for length, and buffer size should not be determined based on an\ninput value. Length validation is especially important in the C and C++ programming languages, which\ncontain string and memory function calls that can be used insecurely.\n\nEven if values are never input directly by a user, data will not always be correctly formatted, and\nhardware or operating system protections are not always sufficient. Most buffer overflows identified in\nCSSP assessments were in the server applications that process ICS protocol traffic. In most cases, values\ninput from network traffic were intercepted and altered in transit. Therefore, network data bounds and\nintegrity checking should be implemented.\n\nPerform a code review of all ICS applications responsible for handling network traffic. Network\ntraffic cannot be trusted, so better security and sanity checks need to be implemented so fuzzing attempts\nwill not cause crashes or a DoS.\n\n**_4.1.3.2_** **_Lack of Input Validation: Lack of Bounds Checking in ICS Service_**\n\nThe lack of input validation for values that are expected to be in a certain range, such as array index\nvalues, can cause unexpected behavior. For instance, unvalidated input, negative, or too large numbers\ncan be input for array access and cause essential services to crash.\n\nICS applications frequently suffer from coding practices that allow attackers to supply unexpected\ndata and thus modify program execution. Even though ICS applications pass valid data values during\nnormal operation, a common vulnerability discovery approach is to alter or input unexpected values.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- DoS caused by out of range index values:\n\n   - Crashed ICS communications service by altering input value to negative number\n\n\n-----\n\n   - Crashed proprietary fault tolerant network equipment protocol.\n\n**Recommendation: All code should be written to validate input data. Every programmer should be**\ntrained in secure coding practices. All code should be reviewed and tested for input functions that could\nbe susceptible to buffer overflow attacks. All input should be validated, not just those proven to cause\nbuffer overflows. Input values should be validated.\n\nEven if values are never input directly by a user, data will not always be correctly formatted, and\nhardware or operating system protections can be insufficient. Further ICS traffic may be intercepted and\naltered in transit. Therefore, Network data value and integrity checking should be implemented.\n\n**_4.1.3.3_** **_ICS Protocol Uses Weak Authentication_**\n\nCommands from the HMI cause actions in the ICS. Alarms are sent to the HMI that notify operators\nof triggered events. The integrity and timely delivery of alarms and commands is critical in an ICS.\n\nWeak authentication in ICS protocols allows replay or spoof attacks to send unauthorized messages,\nand a possibility of sending messages that update the HMI or RTU must be considered. The attacker may\nbe able to cause invalid data to be displayed on a console or create invalid commands or alarm messages.\n\nClear-text authentication credentials can be sniffed and used by an attacker to authenticate to the\nsystem.\n\nThe following specific assessment findings associated with this vulnerability were identified on\nmultiple assessments:\n\n- Common ICS protocol uses weak authentication between controller and field equipment\n\n- Proprietary ICS protocol uses weak authentication between controller and HMI\n\n- Firmware update uses weak authentication\n\n- Proprietary ICS protocol uses weak authentication between ICS components\n\n- Blind trust relationships based on the IP address as specified in the /etc/hosts file\n\n- Lack of secure authentication for session initiation and message authentication means the attacker can\ninitiate sessions or alter established sessions with little difficulty\n\n- HMI login transmits passwords in clear text, which allows remote attackers to sniff the operator\npassword\n\n- Remote telnet-style applications with weak authentication run in plain text on the ICS network\n\n- HMI LAN communication protocol authentication by IP address.\n\n**Recommendation: The system** design needs to implement strong authentication into ICS communication\nprotocols and encrypt communications if appropriate and possible. Secure authentication and data\nintegrity checks should be used to ensure that process commands and updates have not been altered in\ntransit. These security procedures offer protection against spoofing attacks, in which false information is\nsent to the operator’s console in order to give them an altered view from reality. Authentication also\nprotects against unauthorized commands being sent to the ICS process devices.\n\nPhysical access to the controller while the controller is disconnected from a production Ethernet\nnetwork should be required for firmware updates. Ensuring that updates occur in this environment will\nhelp prevent possible exploitation and will also prevent the information disclosure of the device’s\nfirmware. Authentication and data integrity checks should also be used to protect against unauthorized\nphysical access and manipulation of firmware files.\n\n\n-----\n\n**_4.1.3.4_** **_ICS Protocol Uses Weak Integrity Checks_**\n\nThe lack of, or weak, data integrity checks prevent a protocol from detecting bad data. An attacker is\nable to manipulate alarm or command messages sent over the wire if the ICS protocol has poor integrity\nchecks. This manipulation creates an identical effect where the attacker may be able to cause invalid data\nto be displayed on a console or create invalid command or alarm messages.\n\nIf an attacker has access to ICS communication paths and reverse engineered the ICS network\ncommunications protocol, manipulation is possible of the data flowing between the systems components.\nThis includes commands and messages sent to update operator screens and control field equipment.\nAltering the operator’s view of the system received from the ICS can be used to either trick the operator\ninto performing actions or hide what an attacker is doing with the system.\n\nIf integrity check values or “checksums” are omitted from a protocol, no way of determining if data\nhave been corrupted in transmission can be found. Likewise, if integrity check values are easily reverse\nengineered and duplicated, data manipulation in transmission is invisible upon security inspection.\n\nThe following specific assessment findings associated with this vulnerability were identified on\nmultiple assessments:\n\n- MitM altering of ICS communication possible between ICS and controller equipment\n\n- Firmware update uses weak integrity checks\n\n- MitM altering of ICS inter-process communication possible between ICS components\n\n- MitM altering of ICS communication possible between controller and field equipment.\n\nMitM is possible when the communication protocol does not insure the identity of each\ncommunication partner or the integrity of the message. If an attacker can pose as a trusted communication\npartner (if necessary) and formulate the correct integrity check values for a new or altered message, the\ncommunication channel is at risk.\n\nManipulating the communications on a control network requires an in-depth understanding of the\nprotocol to be manipulated. The cyber assessment team is generally able to gather enough information\nabout a network protocol to perform a network layer attack against the system. Most effective network\nattacks use the address resolution protocol (ARP) MitM attack to achieve their objectives.\n\nThe ARP MitM attack is a popular method used by an attacker to gain access to the network flow of a\ntarget system. In this style of attack the network ARP cache of machines on the LAN are targeted,\nconfusing whom they think they are communicating with. The ARP protocol is used to determine which\nhardware addresses coincide with the IP addresses on the network. The MitM attack is initiated by\nsending gratuitous ARP commands to confuse each host. These ARP commands tell the two hosts that the\nattacker computer is really the computer they want to send data. When a successful MitM attack is\nperformed, the hosts on each side of the attack are unaware that their network data is taking a different\nroute through the attacker’s computer. The attacker computer then needs to forward all packets to the\nintended host so the connection stays in sync and does not time out. Figure 13 illustrates a typical MitM\nattack.\n\n\n-----\n\nHost 1\n\nFigure 13. Generic Man-in-the-Middle attack.\n\n\nHost 2\n\n\nThe MitM attack is effective against any switched network because it effectively puts the attacker\ncomputer between the two hosts. This means the hosts send their data to the attacker’s (compromised)\ncomputer thinking it is the host they intended to send the data. The attacker generally needs to be able to\ncompromise a host on (or between) the victim computers’ LANs.\n\nWith a full ARP MitM attack in place, manipulation of ICS devices and/or modification of data\nflowing back to the operator’s console to give false information of the state of the system (spoofing) can\noccur. This tampering could allow an attacker to manipulate the system or the operator’s response.\n\n**Recommendation: Data integrity checks need to be designed and implemented in ICS communication**\nprotocols. Use hardcoded ARP tables for static IP addresses or dynamic ARP inspection of dynamic IP\naddresses, if feasible. Monitoring the network traffic for changing media access control (MAC) addresses\nusing an Intrusion Detection System (IDS), such as ARPWatch, can help detect MitM attacks. Using port\nsecurity on all network equipment is another good practice, which helps protect against unauthorized\nphysical connections into the network.\n\nThe vulnerabilities that were exploited by the assessment team are inherent in the protocols. The only\nrecommended mitigations for field device protocols are to change to a secure alternative protocol or to\ntunnel the traffic over an encrypted channel that would require “bump-in-the-wire” devices to handle the\nencryption, at least on the field end.\n\n\nReworking the protocol with sequence numbers that are more difficult to predict and incorporating\nauthentication is another option, but this would be expensive and difficult to retrofit to the existing\ninstalled base.\n\nAccess to an operational ICS network and ICS devices should be restricted. Authentication and/or\nencryption of the firmware upgrade process should be required. Requiring physical access to upgrade a\ncontroller prevents unauthorized remote firmware downloads.\n\n##### 4.1.4 Information Disclosure\n\n\nAn information leak is the intentional or unintentional disclosure of information to an actor that is not\nexplicitly authorized to have access to that information. The information is either (1) regarded as sensitive\nwithin the product’s own functionality, such as a private message or (2) provides information about the\nproduct or its environment that could be useful in an attack, but is normally not available to the attacker\nsuch as the configuration of the process being controlled.\n\nCredentials sent across the network in clear text leave the system at risk to the unauthorized use of a\nlegitimate user’s credentials. If attackers are able to capture usernames and passwords, they will be able to\nlog onto the system with that user’s privileges. Any unencrypted information concerning the ICS source\ncode, topology, or devices is a potential benefit for an attacker and should be limited.\n\n\n-----\n\nOne of the greatest security issues the assessment teams have identified is the widespread use of\nunencrypted plain-text network communications protocols. Many applications and services use protocols\nthat include human-readable characters and strings. Network “sniffing” tools, many of which are freely\ndownloadable, can be used to view this type of network traffic. As a result, the content of the ICS\ncommunication packets can be intercepted, read, and manipulated. Vulnerable data in this scenario\ninclude usernames, passwords, and ICS commands. Examples of these applications and services are\nproprietary ICS protocols and remote access services, such as telnet, File Transfer Protocol (FTP), and\nremote shell (rsh), which do not even encrypt the password or obfuscate it with a one-way hash function.\n\n**_4.1.4.1_** **_Unencrypted Proprietary ICS Protocol Communication_**\n\nClear-text communications without authentication and integrity checks offer an attacker the\nopportunity to intercept and alter the communications. The captured communications may be used to\nreverse engineer the proprietary protocols and modify or insert commands in ways that suit the attacker’s\npurpose.\n\nAll systems evaluated used clear-text protocols on the ICS network. Most of these protocols were\nproprietary to the system vendor. However, being unpublished does not equate to being secure because\nreverse engineering was accomplished on each system tested. To reverse engineer a protocol, network\npackets are captured and analyzed for patterns to understand the inner workings of the protocol. Once a\nprotocol has been reverse engineered, an attacker can use it to perform unauthorized operations on the\nsystem (using a MitM or replay attack) and to keep such operations undetected by spoofing the operator’s\nconsole. A more advanced skill level is required to reverse engineer a protocol.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- The backbone proprietary ICS communication protocol is clear text and susceptible to being reverse\nengineered\n\n- Proprietary ICS distributed communications protocol used for Web HMI communication\n\n- Unencrypted historian protocol used to connect to an untrusted network\n\n- Communication between the controller and HMI was unencrypted and susceptible to reverse\nengineering\n\n- Proprietary clear-text protocol between controller and HMI that allowed for easy packet monitoring.\n**Recommendation: When possible, standard secure versions of protocols should be used. When**\nproprietary protocols are used, ideally, they should be encrypted and every message’s integrity validated.\nIn situations where encryption of messages or provision for encrypted channels is infeasible, access to the\nproprietary protocols and associated communications should be kept to a minimum level and, preferably,\nkept within the confines of a well-protected ICS security zone.\n\n**_4.1.4.2_** **_Unencrypted Nonproprietary ICS Protocol Communication_**\n\nClear-text communications without authentication and integrity checks offer an attacker the\nopportunity to intercept and alter the communications. The captured communications may be used to\nbetter understand the specific structural function of the various field devices in the system, and to modify\nor insert commands in ways that suit the attacker’s purpose.\n\nThe following is a specific common assessment finding associated with this vulnerability:\n\n- Communication between the controller and process equipment was unencrypted and susceptible to\nMitM and reverse engineering to alter values to and from field devices.\n\n- OPC communications cross the firewall. OPC uses standard Distributed Component Object Model\n(DCOM)/Remote Procedure Call (RPC) protocols that are decipherable. These communications are\nable to be decoded and reveal what methods and objects are being passed between the client and\nserver.\n\n\n-----\n\n**Recommendation: Future protocols should be designed with greater security including encrypted**\nmessaging. If possible, immediate application of encrypted channels would be beneficial. If supported by\nthe field devices, configure the field equipment to only allow connections from the IP addresses of the\nsystems that are expected to connect to those devices. While not preventing information leakage, this\nmitigation could make a successful attack more difficult.\n\n**_4.1.4.3_** **_Unencrypted Services Common in IT Systems_**\n\nUnsecure services developed for IT systems have been adopted for use in ICS for common IT\nfunctionality. Although more secure alternatives exist for most of these services, active unused or\nobsolete services still exist in many ICS. Unfortunately, lingering obsolete services in ICS led to\nvulnerabilities readily accessible to an attacker who has gained a toehold on the ICS or has access to an\nunencrypted communication channel to or from the system.\n\nIf an attacker is able to capture a username and password, he is able to legitimately log onto the\nsystem with that user’s privileges. In addition, in order to strategically attack an ICS, the attacker must\nperform discovery of the particular ICS environment. Attackers accomplish this by monitoring the ICS\ncommunication traffic to see which computers are performing specific functions and the protocols and\ncommands used. These issues illustrate the security issue of data confidentiality. For this reason, plaintext protocols should be eliminated where possible and at a minimum, plain-text remote access services\nshould be replaced with encrypted services such as secure shell (SSH). Encrypting other communications,\nsuch as proprietary ICS protocols, is a complex task and should be carefully addressed by the system\nvendor. Another issue to consider prior to encrypting everything is that it prevents the ability to\nimplement network-monitoring tools on communication channels.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- Use of clear-text Information Technology (IT) protocols on ICS LAN (e.g., telnet, FTP, “r” services)\nidentified in multiple assessments\n\n- Network file system, which has relatively limited security features, is used as the network file system\n\n- Telnet access available on controller\n\n- Post authentication sniffing or hijacking opportunities available on the dial-up connection.\n\n**Recommendation: Encryption is a direct answer to information leaks due to clear-text communication.**\nUnfortunately, encryption is not always feasible on ICS networks. Timing concerns may make encryption\nimpractical, and in addition, encryption reduces the ability to monitor network traffic and to troubleshoot\nthe system.\n\nUnsecure versions of common IT services should be replaced where possible by their secure versions.\nICS use common IT protocols for common IT functionality, such as network device management, remote\nlogins, or file transfers. Because they are not used for real-time functionality, they can be replaced with\ntheir secure counterparts in most cases. SSH can replace all file transfer and remote login protocols such\nas FTP, telnet, and rlogin with encrypted versions. Any communication can be “tunneled” through SSH.\nHTTP can be sent over the Secure Socket Layer (HTTPS). Users of these products should be aware more\nsecure network file sharing solutions available. ICS vendors and customers should follow IT security\npractices and use the current secure versions of common protocols. When replacement is not feasible,\naccess to the services should be minimized, and unencrypted communication should be limited to within\nthe ICS whenever possible. Communications between security zones should be secured as much as\npossible.\n\n**_4.1.4.4_** **_Open Network Shares on ICS Hosts_**\n\nThe storage of ICS artifacts, such as source code and system configuration on a shared file system,\nprovides significant potential for information mining by an attacker.\n\n\n-----\n\nThe following are assessment finding examples associated with this vulnerability:\n\n- Publically available network shares on ICS hosts\n\n- Two shares discovered on work station and server computers\n\n- Common shares on multiple systems\n\n- Files available for read access\n\n- Information leak through shared directories\n\n- Large number of publically available network shares on ICS hosts\n\n- The source code for the ICS is shared on ICS hosts. Source code could be downloaded and used to\nfind vulnerabilities.\n\n**Recommendation: Share files to only the computers and accounts that require them. Restrict the read and**\nwrite permissions of these shared files and directories to the minimum required for each user. Restrict\nability to create network shares to the users that need this functionality (generally administrators). Use\nnetwork segmentation and firewall rules that block access to file sharing ports (e.g., TCP Port 139 and\n445 on Windows systems).\n\n##### 4.1.5 Poor Patch Management\n\nVulnerabilities in ICS can occur because of flaws, misconfigurations, or poor maintenance of their\nplatforms, including hardware, operating systems, and ICS applications. These vulnerabilities can be\nmitigated through various security controls, such as OS and application patching, physical access control,\nand security software (e.g., antivirus software).\n\nA computer system is vulnerable to attack from the time a vulnerability is discovered and publicly\ndisclosed, to when a patch is generated, disseminated, and finally applied. The number of publicly\nannounced vulnerabilities has been steadily increasing over the past decade to the point where patch\nmanagement is a necessary part of maintaining a computer system. Although patching may be difficult in\nhigh-availability environments, unpatched systems are often trivial to exploit due to the ease of\nrecognizing product version and the readiness of exploit code.\n\n**_4.1.5.1_** **_Unpatched or Old Versions of Third-party Applications Incorporated into ICS_**\n**_Software_**\n\nIn multiple assessments, unpatched or old versions of applications were built into the ICS. Some had\nnewer versions available just for security fixes. These applications possess vulnerabilities that may\nprovide an attack path into the system. The software is well known, and available exploit code makes\nthem an easy target.\n\nThe following are assessment finding examples associated with this vulnerability:\n\n- Vulnerable database version\n\n- Vulnerable Web server version\n\n- OPC relies on RPC and DCOM—without updated patches, OPC is vulnerable to the known\nRPC/DCOM vulnerabilities.\n\n**Recommendation: The vendor bears responsibility to incorporate the latest versions of third-party (and**\nOS) software into the current version of the ICS product. The vendor should also support customers in\npatch testing and providing patches for their own software.\n\n\n-----\n\n##### 4.1.6 ICS Performs Weak Authentication \n\nEven if a protocol provides for strong authentication, implement correctly with strong passwords that\nremain private. Users are responsible for creating and protecting authentication credentials. Application\ndevelopers are responsible for supporting strong passwords and protecting authentication credentials in\nthe software. System integrators and administrators are responsible for configuring the systems to require\nand protect strong passwords as well.\n\n**_4.1.6.1_** **_ICS Uses Standard IT Protocol with Weak Encryption_**\n\nSome standard IT encryption protocols used in assessment systems were exploited due to encryption\nweaknesses. A published attack was used in multiple assessments to crack a terminal service encryption\nand view the user credentials during authentication.\n\nThe following are common specific assessment findings associated with this vulnerability:\n\n- Remote display application encryption can be cracked\n\n- LAN Manager (LM) password hashes found in ICS network traffic.\n\n**Recommendation: Perform the necessary background research before choosing and properly**\nimplementing an encryption solution. Keep informed on published vulnerabilities and weaknesses of the\ndeployed protocols and keep patches up-to-date.\n\nThe use of LM password hashes is a bad practice due to the easy decoding provided by tools such as\nJohn the Ripper and the Rainbow Tables. Users must assume that any passwords used on the network that\nwere stored as LM hashes are compromised. Prevent storage of the LM hash if it is not needed for\nbackward compatibility. Windows 2000 and later systems also create stronger NT LAN manager (NTLM)\nhashes, but create LM hashes for interoperability with older Windows systems.\n\n**_4.1.6.2_** **_Use of Standard IT Protocol with Clear-text Authentication_**\n\nClear-text authentication credentials can be sniffed and used by an attacker to authenticate the system.\n\nThe following are sanitized findings associated with this vulnerability from multiple assessments:\n\n- Standard IT clear-text authentication protocol services are running on multiple ICS hosts\n\n- Telnet access available on controller\n\n- Clear-text IT protocols are used by the ICS (e.g., telnet, FTP, “r” services). This finding was common\nto multiple assessments.\n**Recommendation: Reduce the number of necessary services as much as possible. If necessary services**\nare vulnerable to attack, these services should be replaced with more secure counterparts. For example,\nthe clear-text protocols FTP, telnet, rshell, rexec, and rlogin can be replaced with SSH and secure FTP (a\nstraightforward procedure for system access). This effort is not trivial if these services are integrated into\nthe system functionality and may require rewriting code, architecting secure authentication, or even\nreengineering system communications.\n\n**_4.1.6.3_** **_Client-Side Enforcement of Server-Side Security_**\n\nApplications that authenticate users locally trust the client that is connecting to a server to perform the\nauthentication. Because the information needed to authenticate is stored on the client side, a moderately\nskilled hacker may easily extract that information or modify the client to not require authentication.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- Client side validation of HMI application username\n\n- Client side user and password validation for remote controller configuration.\n**Recommendation: Implement robust authentication by the server or component that is granting access.**\n\n\n-----\n\n##### 4.1.7 Least User Privileges Violation\n\n**_4.1.7.1_** **_Unauthorized Directory Traversal Allowed_**\n\nFindings were reported that directory traversal was allowed beyond intended file access. Either\nremotely connecting to a Web server, database, open network share or proprietary ICS application can\naccomplish this task.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- Proprietary ICS protocol allowed ICS system hosts to read or overwrite files on other hosts, without\nany logging\n\n- Documentation and configuration information was being shared freely (read only)\n\n- Common shares on multiple systems\n\n- Oracle listener allows arbitrary file write and read/write database access.\n\n**Recommendation: Ensure share permissions for nonessential folders are removed. Whenever possible,**\nshared folders should only allow read access. Ensure that even read-only shares are not providing critical\ninformation to public queries.\n\n**_4.1.7.2_** **_Services Running with Unnecessary Privileges_**\n\nServices are restricted to the user rights granted through the user account associated with them.\nExploitation of any service could allow an attacker a foothold on the ICS network with the exploited\nservice’s permissions. Privilege escalation can be accomplished by exploiting a vulnerable service\nrunning with more privileges than the attacker has currently obtained. If successfully exploited, services\nrunning as a privileged user would allow full access to the exploited host.\n\nThis vulnerability was very common. The following are some specific assessment findings associated\nwith this vulnerability:\n\n- Manager account overused\n\n- Remote exploitation of ICS application services allowed root-level access on ICS hosts\n\n- Database service running as administrator.\n\n**Recommendation: By default, some ICS installations start services as the root user and root group. Many**\nservices do not need to be started with this privilege level, and doing so exposes system resources to\npreventable risks. By restricting necessary privileges during ICS design and implementation, the window\nof exposure and criticality of impact is significantly reduced in the event that a flaw is found in that\nservice. Essentially, running with minimum privileges is a recommended practice because it reduces the\npotential harm that a service can cause due to a bug, accident, or malicious exploit. The most secure\nservice available should be used for a given functionality and then kept patched and up-to-date to help\nprevent exploitation.\n\n##### 4.1.8 Summary of Common ICS Software Vulnerabilities\n\nICS software mostly suffers from the lack of secure software design and coding practices. ICS\nnetwork protocols and associated server applications are prone to MitM data viewing and alteration, as\nwell as compromise through invalid input. This lack of security culture contributes to poor code quality,\nnetwork protocol implementations that rely on weak authentication and allow information disclosure, and\nvulnerable custom ICS Web services.\n\nICS software generally uses third-party applications such as common Web servers, remote access\nservices, and encryption services. Many out-of-date and vulnerable third-party software applications and\n\n\n-----\n\nservices have been identified on new ICS version; all indications show that the ICS vendor is not\nsupporting third-party patch management for their software.\n\nTable 3 lists the ICS software categories and vulnerabilities identified in multiple CSSP assessments.\nFigure 14 shows the category findings’ frequency of occurrence.\n\nTable 3. Summary of common ICS software assessment findings.\n\n**Category** **Common Vulnerability**\nPoor Code Quality Use of potentially dangerous functions in proprietary ICS application\nVulnerable Web Services Directory traversal enabled\n\nUnauthenticated access to Web server\nPoor Network Protocol Lack of input validation: Buffer overflow in ICS service\nImplementations\nLack of input validation: Lack of bounds checking in ICS service\n\nICS protocol uses weak authentication\n\nICS protocol uses weak integrity checks\n\nICS product relies on standard IT protocol that uses weak encryption\n\nPoor Patch Management Unpatched or old versions of third-party software incorporated into ICS\nsoftware\nWeak Authentication ICS use standard IT protocol with weak encryption\nUse of standard IT protocol with clear-text authentication\n\nClient-side enforcement of server-side security\n\nLeast User Privileges Unauthorized directory traversal allowed\nViolation\nServices running with unnecessary privileges\n\nInformation Disclosure Unencrypted proprietary ICS protocol communication\nUnencrypted nonproprietary ICS protocol communication\n\nUnencrypted services common in IT systems\n\nOpen network shares on ICS hosts\n\nFigure 14. CSSP assessment findings related to ICS products.\n\n|Category|Common Vulnerability|\n|---|---|\n|Poor Code Quality|Use of potentially dangerous functions in proprietary ICS application|\n|Vulnerable Web Services|Directory traversal enabled|\n||Unauthenticated access to Web server|\n|Poor Network Protocol Implementations|Lack of input validation: Buffer overflow in ICS service|\n||Lack of input validation: Lack of bounds checking in ICS service|\n||ICS protocol uses weak authentication|\n||ICS protocol uses weak integrity checks|\n||ICS product relies on standard IT protocol that uses weak encryption|\n|Poor Patch Management|Unpatched or old versions of third-party software incorporated into ICS software|\n|Weak Authentication|ICS use standard IT protocol with weak encryption|\n||Use of standard IT protocol with clear-text authentication|\n||Client-side enforcement of server-side security|\n|Least User Privileges Violation|Unauthorized directory traversal allowed|\n||Services running with unnecessary privileges|\n|Information Disclosure|Unencrypted proprietary ICS protocol communication|\n||Unencrypted nonproprietary ICS protocol communication|\n||Unencrypted services common in IT systems|\n||Open network shares on ICS hosts|\n\n\n-----\n\n#### 4.2 Common ICS Configuration (Implementation) Vulnerabilities\n\nVulnerabilities in the previous section are inherent in the ICS products. Other vulnerabilities can be\nintroduced by the way the ICS is installed and maintained. Each ICS installation is a unique combination\nof components and functionality offered by an ICS product vendor. ICS are generally such major\npurchases in time and money required that very few systems from each ICS product line are delivered\nbefore features are added and a new version is released. A large investment of financial and personnel\nresources needed for ICS upgrade contributes to a lack of, or insufficient, standard procedures for\nsecurely configuring each ICS product.\n\nAll vendors have different standard processes for building, testing, and installing an ICS. Some\nvendors have integrators who work with customers to create and install the system. Other vendors have\njust a product model. Often, integration consultants with specific ICS product training are available for\ninstallation and configuration. All systems are unique; generally with new features introduced in each\none, the level of security in each ICS installation is dependent on those responsible for installing and\nconfiguring the operating systems, ICS applications, and third-party applications.\n\nCommon security problems that can arise from ICS configuration are unpatched OS, application, and\nservice vulnerabilities, failure to configure and implement applications and services securely\n(i.e., selecting security options and protecting credentials), changing all default passwords, setting\npassword policies to require strong passwords, limiting user accounts, applications and services to only\nthe required permissions, installing or enabling security features correctly, and restricting unnecessary\nconnections.\n\nAssurance of a secure configuration can be increased through automated security configuration\npackages and detailed instructions provided by the ICS vendor. Automated disabling of unnecessary\nservices and applications and lists of required applications and services with associated permissions\nrequired should be included in instructions. Required ports and components allowed to connect should\nalso be defined. Owners should require this information during the procurement process to insure the\nability to securely configure their systems.\n\nAlthough some vulnerability is inherent in ICS products, many ICS component vulnerabilities are\ndependent on how an ICS product was implemented. Even though security configuration can be limited\nby the design of the ICS, ICS owners can control their risk of cyber attack by securely configuring their\nsystems.\n\nThe ICS assessment findings that are due to installation and configuration errors are described below.\nThese issues also apply to the maintenance of the operational ICS.\n\n##### 4.2.1 Poor Patch Management\n\nChange management is paramount to maintaining the integrity of both IT and ICS. Unpatched\nsoftware represents one of the greatest vulnerabilities to a system. Software updates on IT systems,\nincluding security patches, are typically applied in a timely fashion based on appropriate security policy\nand procedures. In addition, these procedures are often automated using server-based tools. Software\nupdates on ICS cannot always be implemented on a timely basis because these updates need to be\nthoroughly tested by the vendor of the industrial control application and the end user of the application\nbefore being implemented and ICS outages often must be planned and scheduled days/weeks in advance.\nThe ICS may also require revalidation as part of the update process. Another issue is that many ICS\nutilize older versions of operating systems that are no longer supported by the vendor. Consequently,\navailable patches may not be applicable. Change management is also applicable to hardware and\nfirmware. The change management process, when applied to ICS, requires careful assessment by ICS\nexperts (e.g., control engineers) working in conjunction with security and IT personnel.\n\n\n-----\n\n**_4.2.1.1_** **_Unpatched Operating System_**\n\nVulnerabilities that have had patches available for a long time are still being seen on ICS. Unpatched\noperating systems open ICS to attack through known operating system service vulnerabilities. For\nexample, in 2003 the Slammer worm disabled an Ohio Davis-Besse nuclear power plant safety\nmonitoring system for nearly 5 hours. The Davis-Besse plant was in a maintenance cycle at this time and\nnot generating power. According to reports, plant computer engineers had not installed the patch for the\nMicrosoft SQL vulnerability that Slammer exploited. In fact, they did not know there was a patch, which\nMicrosoft released 6 months before Slammer struck.[3]\n\nThe following are sanitized findings associated with this vulnerability from multiple assessments:\n\n- Operating system vendor patches were not applied\n\n- System computers vulnerable to operating system service vulnerabilities\n\n- Vulnerable version of Sendmail\n\n- Sun rpc.cmsd has an integer overflow problem in xdr_array\n\n- Vulnerable version of RPC\n\n- Inconsistent application of current patches on HMIs.\n\n**Recommendation: A timely patch management process is critical to reduce vulnerabilities. OS patches**\nrepair vulnerabilities in the OS that could allow an attacker to exploit the computer. The importance to\nsystem security of keeping OS patches up-to-date cannot be over emphasized. However, patching ICS\nmachines can present unique challenges. Among the factors to consider are system functionality, security\nbenefit, and timeliness. This process requires elements of IT, IT security, process control engineering, and\nsenior management and incorporates elements of an Incident Response Plan, a Disaster Recovery Plan,\ntestbed testing, and a Configuration Management Plan. Where patching is not an option, work-arounds\nand defense-in-depth techniques and tactics can be used.[4 ]\n\nStatically linked libraries need to be independently kept up-to-date if they are different from the\nlibraries associated with the operating system.\n\n##### 4.2.2 Weak User Authentication\n\n**_4.2.2.1_** **_Improper Security Configuration_**\n\nA common problem found during assessments was that even though secure authentication\napplications were used, installations and configurations were not correct.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- Security options not enabled\n\n- OPC client and server use the Microsoft LM authentication process, which contains known\nvulnerabilities.\n\n**Recommendation: Instructions for secure installation and proper configuration for each application need**\nto be followed and tested. Do not allow login information to be hard coded into scripts and user programs\nor stored so that reauthentication on that computer is never required again.\n\nLM hashes should be disabled on all Windows hosts and domain controllers. If LM authentication is\nrequired, update the configuration settings so that only the new NTLM network authentication is used.\nBecause LM hashing does not support passwords longer than 14 characters, users can prevent a LM hash\nfrom being generated for their password by using a password at least 15 characters in length.\n\n\n-----\n\n**_4.2.2.2_** **_No Password Required_**\n\nSome assessments discovered applications that had been configured without passwords, which means\nthat anyone able to access these applications are guaranteed to be able to authenticate and interact with\nthem.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- Database service was configured without a password on multiple assessments\n\n- Null connection allows remote hosts to query each system for information without requiring\nauthentication\n\n- Password length can have zero characters. Any user on the system can have a blank password.\n\n**Recommendation: Strong passwords need to be required and deployed on networking, client, and server**\nequipment. Passwords should be implemented on ICS components to prevent unauthorized access.\n\n**_4.2.2.3_** **_Weak Passwords_**\n\nPoorly chosen passwords can easily be guessed by humans or computer algorithms to gain\nunauthorized access. The longer and more complex a password is, the time to guess or crack the password\nincreases. Cracking a password can be trivial or virtually impossible depending on the combination of\ndifferent character types used with larger password length.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- Some ICS hosts had very weak 3-character administrative passwords\n\n- The weak passwords were recovered and provided root-level access to all system resources\n\n- Default SNMP community string was used by 89 hosts\n\n- Several weak passwords were found\n\n- Default password had not been changed.\n\n**Recommendation: A policy** mandating the use of strong passwords for all cyber assets inside the\nelectronic perimeter with a reasonable lifespan limit needs to be mandated and enforced. Usage of\ncommon administrative passwords needs to be discouraged.\n\n**_4.2.2.4_** **_Weak Password Requirements_**\n\nPassword policies are needed to define when passwords must be used, how strong they must be, and\nhow they must be maintained. Without a password policy, systems might not have appropriate password\ncontrols, making unauthorized access to systems more likely. Passwords that are short, simple (e.g., all\nlower-case letters), or otherwise do not meet typical strength requirements are vulnerable to being\ncracked. Password strength also depends on whether the specific ICS application was designed to support\nmore stringent passwords.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- Many of the accounts, including the administrator account, had no password expiration date\n\n- Account lockout policy not defined\n\n- Password complexity disabled\n\n- Password history set to remember zero previous passwords.\n\n**Recommendation: Password policies should be developed as part of an overall ICS security program**\ntaking into account the capabilities of the ICS and its personnel to handle more complex passwords.\nSystem administrators should enforce the usage of strong passwords. A password strength policy should\ncontain the following attributes: (1) minimum and maximum length (2) require mixed character sets\n\n\n-----\n\n(alpha, numeric, special, mixed case); (3) do not contain user name; (4) expiration; and (5) no password\nreuse. Authentication mechanisms should always require sufficiently complex passwords and require that\nthey be periodically changed.[ 42]\n\n##### 4.2.3 Information Disclosure\n\n**_4.2.3.1_** **_Weak Protection of User Credentials_**\n\nUser credentials should be vigorously protected and made inaccessible to an attacker. Whenever\ncredentials are passed in clear text, they are susceptible to being captured and then cracked if necessary by\nthe attacker. If stored password hashes are not properly protected, they may be accessed by an attacker\nand cracked. In every case, the lack of protection of user credentials may lead to the attacker gaining\nincreased privileges on the ICS and thus being able to more effectively advance the attack.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- Services such as FTP, telnet, and rlogin transmit user credentials in clear text\n\n- OPC client responds with both newer NTLM and older LM password hashes, making discovery of\npasswords easier\n\n- Password hash files are not properly secured\n\n- Found LM password hashes.\n\n**Recommendation: Properly secure password files by making hashed passwords more difficult to acquire**\n(e.g., restrict access by using a shadow password file or equivalent on UNIX systems). Replace or modify\nservices so that all user credentials are passed through an encrypted channel.\n\nLM password hashes are crackable by freely available tools within seconds. All Windows hosts\nsupport LM passwords and all versions before Windows Vista and Windows Server 2008 compute and\nstore passwords using the LM hash algorithm by default. LM hashes should be disabled on all Windows\nhosts and domain controllers. OPC Client security policies should be configured so that only the NTLM\nresponse is given. Because LM hashing does not support passwords longer than 14 characters, users can\nprevent a LM hash from being generated for their password by using a password at least 15 characters in\nlength.\n\n**_4.2.3.2_** **_Information Leak through Insecure Service Configuration_**\n\nInformation that can be used in determining system vulnerabilities can be gathered from services that\nhave been configured to reply with debug or other information. For example, null sessions could be used\nto enumerate user accounts on the system and allow the use of available network shares. An attacker can\nuse this sort of information to configure a sniffer more accurately or to check if the attacker already has\nlogin information for one of the given accounts. This information also could be potentially useful for a\nsocial engineering attempt.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- Controller answered to an ICMP_MASKREQ query\n\n- Controller answered to an Internet Control Message Protocol (ICMP) timestamp, which allows an\nattacker to know the date that is set on the machine\n\n- Nessus was able to gather NetBIOS names from the HMI and was able to determine the MAC address\nfor the network adapter\n\n- Information leak through debug information: Web interface had debugging enabled\n\n- Information leak through directory viewing: Web interface allowed directory viewing\n\n- DNS queries indicate hostnames reveal function of host (e.g., antivirus, keyserver)\n\n\n-----\n\n- Null sessions enabled\n\n- ICMP responses from the router were different based on whether the target address referenced a valid\nmachine.\n\n**Recommendation: Any information that is not necessary to the functionality should be removed in order**\nto lower both the overhead and the possibility of security sensitive data being sent.\n\n##### 4.2.4 Summary of Common ICS Configuration Vulnerabilities\n\nTable 4 lists the common vulnerabilities related to ICS configuration issues that were identified with\nthe assessment activities for the CSSP. Figure 15 shows that the most ICS configuration problems found\nwere due to weak passwords and password policies.\n\nTable 4. Summary of common ICS configuration findings.\n\n**Category** **Common Vulnerability**\nPoor Patch Management Unpatched operating system\nWeak User Improper security configuration\nAuthentication\nNo password required\n\nWeak passwords\nWeak password requirements\nInformation Disclosure Weak protection of user credentials\n\nInformation leak through insecure service configuration\n\nFigure 15. CSSP assessment ICS implementation findings.\n\n#### 4.3 Common ICS Network Vulnerabilities\n\nThe network architecture needs to be securely designed and implemented to allow remote control and\nmonitoring of a process and provide process data for business functions while preventing any other traffic\nfrom entering or leaving the control network. Security zones with access control rules that limit the traffic\nallowed in and out of the zone, will reduce the risk of intentional or unintentional attacks from sources\noutside the zones, to attacks from allowed IP addresses that exploit the protocols allowed through the\ngiven security zone’s perimeter. The security features built into the protocols used to transfer data in and\nout of the control network must be relied on to prevent attacks that pass access control requirements.\nSecurity features, such as authentication and integrity checks, can be wrapped around unsecure protocols\nthat must be used for communication with the ICS, making understanding the limitations of protection\nthey do and do not provide essential for proper implementation.\n\n|Category|Common Vulnerability|\n|---|---|\n|Poor Patch Management|Unpatched operating system|\n|Weak User Authentication|Improper security configuration|\n||No password required|\n||Weak passwords|\n||Weak password requirements|\n|Information Disclosure|Weak protection of user credentials|\n||Information leak through insecure service configuration|\n\n\n-----\n\nAn effective cyber security program for an ICS should apply a strategy known as “defense-in-depth,”\nlayering security mechanisms such that the impact of a failure in any one mechanism is minimized.\n\n##### 4.3.1 Common ICS Network Design Vulnerabilities\n\nThe network infrastructure environment within the ICS has often been developed and modified based\non business and operational requirements, with little consideration for the potential security impacts of the\nchanges. Over time, security gaps may have been inadvertently introduced within particular portions of\nthe infrastructure. Without remediation, these gaps may represent backdoors into the ICS.\n\n**_4.3.1.1_** **_Lack of Network Segmentation_**\n\nMinimal or no security zones allows vulnerabilities and exploitations to gain immediate full control\nof the systems, which could cause high-level consequences.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- Lack of internal segmentation of the ICS production network: ICCP servers not on DMZ\n\n- Lack of internal segmentation of the ICS production network: Host with dedicated serial link for data\ntransfer using high-risk application not on DMZ\n\n- Control-related systems are accessible on the corporate LAN\n\n- Connections to and from remote facilities to the ICS do not pass through a firewall.\n\n**Recommendation: At a minimum, the ICS network should be separated from the corporate network by a**\nfirewall, and a DMZ should be implemented to provide the corporate network access to the required\ninformation from the ICS network. The systems located in the DMZ are not production systems and also\nshould be treated as hostile. Exceptions between the DMZ and the ICS networks should be kept to an\nabsolute minimum, and exceptions from the corporate to the ICS should be eliminated. Additional\nsecurity zones can be created within these segments.\n\n**_4.3.1.2_** **_Firewall Bypassed_**\n\nBackdoor network access is also not recommended and could cause direct access to ICS for attackers\nto exploit and take full control of the system.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- Physical cables connected directly to the ICS LAN, bypassing firewall\n\n- SSH server bridges corporate and ICS LANs, bypassing firewall\n\n- Third network card on ICCP server connects directly to ICS LAN.\n\n**Recommendation: A firewall should limit access to the different LAN segments to only necessary**\ncommunication. The ICS network should be separated from the corporate network by a firewall, and a\nDMZ is implemented to provide the corporate network access to the required information from the ICS\nnetwork. The systems located in the DMZ are not production systems and should be treated as hostile.\nExceptions between the DMZ and the ICS networks should be kept to an absolute minimum, and\nexceptions from the corporate to the ICS should be eliminated.\n\n##### 4.3.2 Common ICS Network Component Configuration (Implementation) Vulnerabilities\n\nFirewall and router filtering deficiencies allow access to ICS components through external and\ninternal networks. The lack of incoming access restrictions creates access paths into critical networks.\n\nThe lack of outgoing access restrictions allows access from internal components that may have been\ncompromised. For an attacker to remotely control exploit code running on the user’s computer, a return\n\n\n-----\n\nconnection must be established from the victim network. If outbound filtering is implemented correctly,\nthe attacker will not receive this return connection and cannot control the exploited machine.\n\n**_4.3.2.1_** **_Access to Specific Ports on Host Not Restricted to Required IP Addresses_**\n\nDetailed findings under this common vulnerability involve firewall rules restricting access to specific\nports, but not IP addresses. A common finding was that network device access control lists did not restrict\nmanagement access to the required IP addresses.\n\nAnother common detailed finding was that firewall rules allowed access to unused IP addresses\ntraceable to legacy configuration of the firewall allowed access to unused IP addresses. This finding\nilluminates an attack path by using this IP address in order to be allowed through the firewall.\n\nThe remaining specific assessment details associated with this vulnerability involved access to\nspecific ports being given to either an entire address space or were not restricted by an IP address at all.\nAssessment findings that fall under this vulnerability are firewall rules that are based on address groups\nthat include a wider range than should be allowed.\n\nThe following are specific assessment findings associated with this vulnerability:\n\n- More configuration needs to be performed on the personal firewalls\n\n- Router inside and outside interfaces had 24-bit netmask rather than 16-bit\n\n- Access lists defined but not applied. No inbound filtering\n\n- Access lists incorrect for required ports\n\n- Access to network printer services on corporate LAN was not restricted by password protection or\naccess control list\n\n- E-mail client on DMZ had access to corporate LAN and Internet\n\n- Inadequate outgoing access restrictions.\n\n**Recommendations: Firewall rules that apply to functional groups should use defined finite groups that**\nare restricted to required IP addresses. Firewall rules that are no longer needed should be removed as part\nof a change management procedure or periodic system review or audit. Access control lists should be\nused to limit management access of network equipment to only those who need it.\n\n**_4.3.2.2_** **_Port Security Not Implemented on Network Equipment_**\n\nUnauthorized network access through physical access to network equipment includes the lack of\nphysical access control to the equipment, including the lack of security configuration functions that limit\nfunctionality even if physical access is obtained. The common finding was a lack of port security on\nnetwork equipment. A malicious user who has physical access to an unsecured port on a network switch\ncould plug into the network behind the firewall to defeat its incoming filtering protection.\n\n**Recommendation: Port security should be implemented to limit connectivity to hardware interfaces.**\nGiven the static nature of ICS environments, port security can be used to ensure MAC addresses do not\nchange and new devices are not introduced to the network. Actions, such as limiting known MAC\naddresses to specific interfaces and disabling unused interfaces, should be implemented to assist in\nnetwork security. Given the static nature of the environment, port security can be used to ensure MAC\naddresses do not change and new devices are not introduced to the network.\n\n##### 4.3.3 Summary of Common ICS Network Vulnerabilities\n\nTable 5 lists the common vulnerabilities related to ICS network vulnerabilities that were identified\nwith the assessment activities for the CSSP. Figure 16 shows that most assessment findings were due to\ninsufficient access controls.\n\n\n-----\n\nTable 5. Summary of common ICS assessment network findings.\n\n**Category** **Common Vulnerability**\nNetwork Design Vulnerabilities Lack of network segmentation\n\nFirewall bypassed\nNetwork Component Configuration Access to specific ports on host not restricted to required IP\n(Implementation) Vulnerabilities addresses\n\nPort security not implemented on network equipment\n\nFigure 16. CSSP assessment network security findings.\n\n|Category|Common Vulnerability|\n|---|---|\n|Network Design Vulnerabilities|Lack of network segmentation|\n||Firewall bypassed|\n|Network Component Configuration (Implementation) Vulnerabilities|Access to specific ports on host not restricted to required IP addresses|\n||Port security not implemented on network equipment|\n\n\n-----\n\n#### 5. ICS SECURITY RECOMMENDATIONS\n\nICS vendors and owners can learn and apply many common computer security concepts and practices\nto secure and protect their systems. Security should be designed and implemented by qualified security\nand ICS experts who are able to verify that the solutions are effective and can make sure that the solutions\ndo not impair the system’s reliability and timing requirements.\n\nICS vendors and asset owners are encouraged use this report as a guide to help focus further efforts to\nimprove the overall security of their systems. They should investigate whether the identified\nvulnerabilities affect their systems and if so, follow the recommendations in this report along with more\ndetailed and tailored recommendations from other resources. The classes of vulnerabilities identified in\nthis report can help identify problem areas for self-assessment activities that can be conducted to identify\nand mitigate vulnerabilities in ICS networks, components, services, and code.\n\nBy mitigating the vulnerabilities identified in this report, an ICS can be made more secure, but\nadditional vulnerabilities most likely exist in all systems. The path to a more secure system is a\ncontinuous journey and as new attack scenarios are identified or developed, new defenses must be\nimplemented. In addition to the specific mitigations and recommendations made for the vulnerabilities\ncalled out in the previous sections of this report, several general recommendations are given below.\n\nICS have different performance and reliability requirements and use operating systems and\napplications that may be considered unconventional to typical IT support personnel. Furthermore, the\ngoals of safety and efficiency can sometimes conflict with security in the design and operation of ICS\n(e.g., requiring password authentication and authorization should not hamper or interfere with emergency\nactions for ICS.) All security solutions must not compromise critical functionality. All security functions\nintegrated into the ICS must be tested (i.e., offline on a comparable ICS) to prove that they do not\ncompromise normal ICS functionality.\n\nIn order to reduce the risk of a successful attack against an ICS, the likelihood of a high-impact\nincident can be reduced by implementing as many perimeter protection and vulnerability reduction\nstrategies as possible (aka defense-in-depth). A mitigation strategy should not be chosen from a list of\npossible mitigations for a given identified or possible vulnerability. As many mitigation techniques as\nreasonably possible should be employed to stand in a line of defense and prevent access to vulnerable\ncomponents and network traffic. The probability that an attack is able to defeat or circumvent security\ndefenses is increasingly reduced as the number of security measures are implemented and gaps are filled\nin the line of protection formed by the other security features on the ICS. However, the risk of the layers\nof defense to the operation of the ICS must be considered and mitigated as well.\n\nThe operational and risk differences between ICS and IT systems create the need for increased\nsophistication in applying cyber security and operational strategies. A cross-functional team of control\nengineers, ICS operators, and IT security professionals needs to work closely together to understand the\npossible implications of the installation, operation, and maintenance of security solutions in conjunction\nwith ICS operation. IT professionals working with ICS need to understand the reliability impacts of\ninformation security technologies before deployment. Some of the OSs and applications running on ICS\nmay not operate correctly with commercial-off-the-shelf IT cyber security solutions because of\nspecialized ICS environment architectures.\n\n#### 5.1 Recommendations for Vendors\n\nVendors need to incorporate security into every phase of the product development life cycle and rely\non manual and automated means to ensure proper bounds checking. Once products are deployed, vendors\nneed to establish a process to manage and mitigate product security defects. The vendor team should\nconsist of representatives of key business functions, such as product development, public relations, and\nlegal. A single point of contact leads resolution on reported security issues and must assist asset owners in\n\n\n-----\n\naddressing reported security issues in a timely manner. Common industry practice is to host a “/security”\nWeb page off the corporate main domain where information on security issues and the designated contact\nor team can easily be found. The vendor is responsible for responding to reported security concerns that\ninclude issue validation, patch development, patch testing and validation, and response coordination.\n\nICS security assessment reports show a common need to increase secure coding practices. The three\nmost common problems are the lack of input validation, authentication, and integrity checks. The top nine\nICS vendor recommendations are listed and then discussed below.\n\n- Educate/train developers in secure coding and create a culture that emphasizes security\n\n- Expeditiously test and provide security patches to affected customers\n\n- Create the necessary communication paths that are needed to quickly notify customers of security\nproblems, and create the methods needed to provide patches in an effective way\n\n- Implement and strenuously test strong authentication and encryption mechanisms\n\n- Dramatically increase the robustness of network parsing code\n\n- Document how the systems use the network so that effective firewall and IDS rules can be created\n\n- Pay for a third-party security source code audit and fix the problems identified during the audit\n\n- Redesign network protocols to avoid common problems and enhance security\n\n- Enhance test suites to perform more testing for failure with emphases on testing for potential\nvulnerabilities\n\n- Create custom protocol parsers for common IDS so that they can be more effective.\n\n##### 5.1.1 Create a Security Culture\n\nEducate/train developers in secure coding and create a culture that emphasizes security.\n\nThe security development lifecycle (SDL), created by Microsoft in 2002 as a response to heightened\nawareness of cyber security threats, is a high-visibility example of a security culture change. This process\nwas developed to catch security flaws during the product development lifecycle, not just after the product\nis released. For example, Microsoft has created a culture that promotes safe code development by forcing\nall new code to pass a set of tests before incorporation into the main product. All developers were put\nthrough secure development training to support this new culture. Performance evaluation of software\nproducts, as well as the product managers and their teams, also changed to include a focus on security.\nAlthough new Microsoft vulnerabilities are still abundant 6 years later, this culture change has made a\nsignificant difference in the security level of Microsoft products.\n\nICS products have gained considerable attention in recent years as the cyber security threats due to\nconnection to the Internet have been realized. Microsoft and other hardware, operating system, and\nsoftware application vendors have experienced the cost and difficulties that arise from public\nannouncement of security flaws to force quicker patch response time. Those companies willing to\nembrace a security culture change will benefit from fewer security patches for deployed systems and\ngreater customer confidence and loyalty. Public announcements of ICS vulnerabilities are starting to\nappear and ICS protocol dissectors are becoming available.\n\nICS vendors must adapt to changing customer needs for security in the products used to control\nphysical systems where compromise can have catastrophic consequences. Even Microsoft has\nexperienced difficulty bolting security onto a mature product and impossible to find and prevent all bugs.\nSecurity must also compete with functionality for product time and budget. Vendors must accept that\nsecurity improvements will require an investment. The sooner security is integrated into the product, the\nbetter chance it has of competing in a market where ICS products are required to survive cyber attack\nwithout compromising critical functionality.\n\n\n-----\n\nICS vendors should work toward a culture where software security best practices are adopted\nthroughout the product development organizations and software development life cycles are adjusted to\nuse the best practices. Security practices should be consolidated, integrated, and centralized into a security\nprocess that supports the defined strategy for creating the most secure product possible. Most important is\na change in attitudes to a realization that security is important because it is associated with consequences\nfor everyone. ICS vendors can create a security cultural change within their companies by incorporating\nICS product security into personnel performance.\n\nNumerous resources are available for information and training on building a security culture and\nsoftware security best practices. ICS vendors can use the following software security best practices to\ncreate more secure products:\n\n- Develop or acquire the necessary personnel security skills\n\n- Define security requirements to protect critical functions\n\n- Identify ICS component designs that violate security\n\n- Develop secure design or redesign of identified components\n\n- Require secure source coding handling to protect against malicious vulnerabilities\n\n- Perform thorough security testing\n\n- Provide security documentation.\n\nMany ICS vulnerabilities are due to the lack of input validation. Programmers should be trained in\nsecure coding practices to minimize vulnerabilities such as buffer overflows that are due to programmer\noversight. All code should be reviewed and tested for input functions that could be susceptible to buffer\noverflow attacks. The C and C++ unsafe string and memory function calls should be replaced with their\nsafe counterparts. Input validation should be used to ensure that the content provided to an application\ndoes not grant an attacker access to unintended functionality or privilege escalation. All input should be\nvalidated, not just those proven to cause buffer overflows. Input should be validated for length and buffer\nsize should not be determined based on an input value. Even if values are never input directly by a user,\ndata are not necessarily correctly formatted, and hardware or operating system protections are not always\nsufficient. Buffer overflows in applications that process network traffic can be exploited by intercepting\nand altering input values in transit. Therefore, network data bounds and integrity checking should be\nimplemented as well.\n\nAs a layer of defense, compiler protection options should be used when compiling C/C++ code to\nincrease the difficulty for an attacker to execute exploit code. This decreases the impact of a vulnerability\nfrom an exploit that allows the attacker to run commands on the computer or use it as a launching point\nalong an attack path into the core of the ICS to a DoS-type attack.\n\n##### 5.1.2 Enhance ICS Test Suites\n\nICS product test suites should be enhanced to perform testing to failure with an emphasis on potential\nvulnerabilities. ICS software code logic has been found to only test for failures and other problems that\nmay occur during normal operations.\n\nThe design and code logic of ICS products should prevent all invalid or unwanted cases, even if they\nshould never occur. ICS experts can be blinded by their goal of creating a system that works reliably and\nprotects against normal failures and mistakes. The connection of ICS to other networks has created the\nthreat of cyber attack. ICS test suites should include “out of the box” scenarios that test all kinds of input\nvalues and abnormal conditions. This requires tests built by individuals who can create comprehensive\nand “out of the box” scenarios and are not involved in the design and implementation of the ICS product.\n\n\n-----\n\nThe CSSP assessment methodology is based on this idea of identifying security weaknesses through\nan attacker’s perspective and communicating the security issues to the industry partner from this\nperspective. This testing approach has been a very successful in increase awareness of the “out-of-thebox” attack methods the ICS sector needs to defend against.\n\nResources such as the Common Attack Pattern Enumeration and Classification project can help in\ndeveloping test packages:\n\nBuilding software with an adequate level of security assurance for its mission becomes more\nand more challenging every day as the size, complexity, and tempo of software creation\nincreases and the number and the skill level of attackers continues to grow. These factors\neach exacerbate the issue that, to build secure software, builders must ensure that they have\nprotected every relevant potential vulnerability; yet, to attack software, attackers often have\nto find and exploit only a single exposed vulnerability. To identify and mitigate relevant\nvulnerabilities in software, the development community needs more than just good software\nengineering and analytical practices, a solid grasp of software security features, and a\npowerful set of tools. All of these things are necessary but not sufficient. To be effective, the\ncommunity needs to think outside of the box and to have a firm grasp of the attacker’s\nperspective and the approaches used to exploit software.\n\nAttack patterns are a powerful mechanism to capture and communicate the attacker’s\nperspective. They are descriptions of common methods for exploiting software. They derive\nfrom the concept of design patterns applied in a destructive rather than constructive context\nand are generated from in-depth analysis of specific real-world exploit examples.\n\nTo assist in enhancing security throughout the software development lifecycle, and to support\nthe needs of developers, testers and educators, the Common Attack Pattern Enumeration and\nClassification (CAPEC) is sponsored by the Department of Homeland Security as part of the\nSoftware Assurance strategic initiative of the National Cyber Security Division. The\nobjective of this effort is to provide a publicly available catalog of attack patterns along with\na comprehensive schema and classification taxonomy.”[5]\n\n##### 5.1.3 Create and Test Patches\n\nExpeditiously test and provide security patches to affected customers. Create the necessary\ncommunication paths that are needed to quickly notify customers of security problems and create the\nmethods needed to provide patches in an effective way. Currently, most ICS venders have poor methods\nof notifying customers about potential security problems and patches. Experience has shown that patches\ngenerated as the result of previous security assessments have been slow in being deployed with many end\nusers unaware about the existence of the patches. ICS vendors should create and maintain security\nmailing lists and also test the procedures needed to notify the end users about security problems.\nIncreasing accessibility for end users to obtain the necessary information will greatly increase the use and\neffectiveness of patching. Many ICS vendors do publish security information, but frequently locate this\ninformation in an obscure location on their website that can easily be overlooked. This information should\nhave a more prominent location and should be easy for the users to find. If this advice is followed, ICS\nvendors would provide strong benefit by making it easier for end users to obtain and install patches.\n\nVendors should test and approve OS patches, along with all other third-party software. Products and\nservices such as NTP should be kept at current version and patch levels prior to deployment at asset\nowner sites and be included in the patch testing process. ICS products that have third-party services and\napplications incorporated into their functionality should be designed so that these applications can be\nupdated or replaced as easily as possible.\n\nICS vendor software vulnerabilities should be patched and made available to affected customers as\nwell.\n\n\n-----\n\n##### 5.1.4 Redesign Network Protocols for Security\n\nICS network protocols and the service applications that implement them need to be redesigned for\nsecurity. Most ICS network protocols were designed with the original ICS code base to be fast and only\navoid failure issues and are not designed to provide robust authentication and integrity checks. Many ICS\nprotocol designs contain common security pitfalls. A number of characteristics of a secure protocol are\nrelevant to this discussion.\n\n- Secure protocols should be simple. The more complex a protocol is, the higher the likelihood of bugs\nand vulnerabilities within the implementation.\n\n- Protocols should also minimize duplicate data. If data appear multiple times within the protocol, then\nportions of the implementation will invariably use one version of the data while other portions use\nanother version. This allows an attacker to put the implementation into an unknown state by sending\nconflicting versions of the data.\n\n- Protocols with many optional fields and features are less secure because no two implementations will\nagree on what is optional and tend to make incorrect assumptions.\n\n- Secure protocols are also targeted; they contain enough functionality to get the job done and nothing\nmore. If protocols contain seldom used or never used components then those components tend to be\nmore buggy and contain more vulnerabilities than the components that are actually being used\nbecause they will be tested to a lesser degree.\n\n- Secure protocols also have secure authentication methods and options for encryption or data integrity.\nSecurity by obscurity cannot be relied on because insider knowledge or reverse engineering can be\nused to recreate valid network packets. Some ICS protocol analyzers have already been developed,\nand one should expect to see more given the increasing interest in ICS security.\n\nWhen possible, network protocols should be redesigned to improve security by avoiding common\nsecurity pitfalls, avoiding designs that lead to implementation issues, and by including secure\nauthentication and encryption methods.\n\n##### 5.1.5 Increase Robustness of Network Parsing Code\n\nDramatically increase the robustness of network parsing code. Part of every network protocol is an\nassociated program to build packets or process the traffic off the network. These applications are written\nby the ICS vendor for their propriety protocols as well as for common ICS protocols, such as OPC, ICCP,\nand Distributed Network Protocol Version 3 (DNP3). If these applications contain invalid input\nvulnerabilities such as buffer overflows, exploitation by anyone who is able to gain access to the ICS host\nand port is possible. Such action could cause a communication DoS, with an attacker gaining access to the\ncomputer with the privileges of the account service was running as, or other problems for the ICS.\n\nData integrity checks need to be designed and implemented into ICS communication protocols. The\nlack of, or weak, data integrity checks prevent a protocol from detecting bad data. An attacker can take\nadvantage of the poor integrity checks to send malformed packets in order to cause DoS attacks or to\ntrigger a buffer overflow and compromise the system. An attacker does not always have to send\nmalformed packets for manipulation of otherwise valid alarm or command messages sent over the wire if\nthe ICS protocol has poor integrity checks.\n\n##### 5.1.6 Create Custom Protocol Parsers for Common IDSs\n\nICS vendors should create parsers for their custom protocols that can be used by common IDSs. In\nthis manner, intrusion detection monitoring is made more effective by providing the ability to watch for\nillegal or abnormal values in ICS traffic. The bulk of the current IDS technology is focused on detecting\nexploits, not vulnerabilities. These systems are not very effective in the ICS environment due to the lack\n\n\n-----\n\nof known exploits to detect. If dissectors for the ICS protocols exist, rules could be written for the IDSs\nthat verify network messages are within reasonable bounds and attempt to detect an exploitation of\nvulnerability.\n\n##### 5.1.7 Document Necessary Services and Communication Channels\n\nDocument how the ICS system components use the network so that effective firewall and IDS rules\ncan be created. For each ICS component, document the necessary services along with the associated port\nranges and which components are allowed to initiate a connection to that component.\n\nProvide complete documentation and/or automated setup of security features to allow for quicker,\neasier, and more consistent implementation of ICS components and security features. Security features\nthat are obtuse or difficult to configure and implement are typically not used or are used incorrectly in the\nfield installations of ICS. Security features that are inconsistently implemented or provide inconsistent\nresults are considered a risk to reliability and availability of the ICS in an operational environment.\n\n##### 5.1.8 Implement and Test Strong Authentication and Encryption Mechanisms\n\nImplement and strenuously test strong authentication and encryption mechanisms. Applications that\nprocess network traffic or accept network connections must use strong authentication to prevent\nunauthorized access and messages. Weak authentication in network protocols allows replay or spoof\nattacks to send unauthorized messages. Poor authentication also allows unauthorized users or computers\nto connect to a device or application. The lack of authentication in most ICS-specific network protocols\nallows for manipulation of time synchronization and process alarms, commands, and data updates. Poor\nauthentication in protocol server applications allows unauthorized access to ICS components, including\nICS hardware. Proven authentication services should be used when available.\n\nExperienced personnel in authentication and encryption systems involved in creating these systems\nshould be a part of any cyber security staff. Authentication and encryption systems are complex and one\nsmall mistake or oversight can render the authentication or encryption ineffective. Test rigorously that the\nauthentication and encryption system are working correctly before deploying the solutions.\n\nUse a well-vetted encryption algorithm that is currently considered to be strong by experts in the\nfield, and select well-tested implementations. Design software so that one cryptographic algorithm can be\nreplaced with another, improving upgrade capability to stronger algorithms. Periodically ensure that\ncurrent methods used have not been broken. Many old algorithms and implementations have become\nobsolete or discovered to be flawed.\n\nSecurely manage and protect cryptographic keys. Keys should be strong and should not be hardcoded, default, published, or discoverable in any other way.\n\nA remote end-point joins the trusted domain when it is allowed to remotely connect to the ICS\nnetwork. If virtual private network (VPN) endpoints (hosts) are compromised, an attacker can utilize the\nVPN connection when it is established. Importantly, these hosts must be secured to the maximum extent\npossible. End-point management software can be used to help determine the security posture of the\nremote device and how it is allowed to connect to the protected network, but should not be the only\ndefense measure. VPN access should only be granted to the minimum set of hosts and users when\nnecessary and those VPN connections should be restricted to only allow access to the necessary\ncomponents.\n\nInternet Protocol security (IPSec) and VPN tunneling cannot be used as a replacement for fixing\nvulnerabilities. A VPN connection extends the attack surface of the system to the VPN client’s computer.\nAn attacker cannot be prevented from compromising a VPN endpoint computer and using the VPN tunnel\nas an encrypted pathway to exploit the vulnerabilities.\n\n\n-----\n\nIPsec can be used for confidentiality, integrity, authenticity, and/or replay protection. If an attacker\nintends to disable IPSec or perform a DoS if he may attempt to gain access to any point between two\nIPSec partners. The implementation of IPSec included with Microsoft Windows XP, Windows Server\n2003 and newer uses the identity proofing afforded by Active Directory. This authentication can be\nintercepted, causing IPSec to fail. This failure can cause a DoS if the IPSec policy is set to require IPSec\nfor communications. If the IPSec policy is set to request, then an attacker can force IPSec to disable itself\nit they interfere with the communications long enough to fall back onto unencrypted channels. The\ndecision for configuring this implementation of IPSec with a “request” policy versus a “require” policy\nshould be made based on whether the communication between the IPSec partners must be confidential (or\ninsure integrity, authenticity, or replay protection) or the availability of communication based on\ncriticality.\n\nA number of concerns about the mal-effects of cryptography on ICS have also been raised. The four\nmost common concerns are latency, bandwidth, availability, and IDS interaction. Difficulty of\nimplementation and viewing traffic for trouble-shooting are other issues that can prevent encryption from\nbeing used in operational ICS. Still, IPSec and VPN tunneling should not be used as layers of defense.\n\n##### 5.1.9 Improve Security through External Software Security Assessments\n\nICS software vendors should pay for a third-party security source code audit and fix the problems\nidentified during the audit. Independent source code auditing can help ensure quality and security in\nsoftware products. An outside professional opinion of software design and implementation based on the\nactual source code and build process of the ICS product will greatly enhance quality and security, or\nconfirm the security of the product.\n\nICS software can have large, complicated and legacy codebases. ICS operations require high\navailability, and update scenarios are complicated. Unlike the standard off-the-shelf computer software\nmodel, the cost of security fixes and support and maintenance has traditionally been transferred to the ICS\ncustomer. With the new focus and requirements for ICS security, including ICS product vulnerabilities\nstarting to be publicly announced, vendors may find the cost of code audits and associated code changes\nto be very cost effective versus fixing single vulnerabilities as they are publically announced.\n\n#### 5.2 Recommendations for ICS Owners and Operators\n\nAn effective cyber security program for ICS should apply a strategy known as defense-in-depth,\nlayering security mechanisms such that the impact of a failure in any one mechanism is minimized.\nImplementing security controls, such as intrusion detection software, antivirus software, and file integrity\nchecking software, where technically feasible, will prevent, deter, detect, and mitigate the introduction,\nexposure, and propagation of malicious software to, within, and from the ICS.\n\nThe most successful method for securing an ICS is to gather industry- recommended practices and\nengage in a proactive, collaborative effort between management, the controls engineer and operator, the\nIT organization, and a trusted automation advisor. This team should draw upon the wealth of information\navailable from ongoing federal government, industry groups, vendor, and standards organizational\nactivities. ICS owners should perform risk-based assessments on their systems and tailor the\nrecommended guidelines and solutions to meet their specific security, business, and operational\nrequirements.\n\nPlanning efforts need to be implemented for prioritization of the tasks necessary to enhance ICS\nsecurity. Important considerations in this process are cost, probability, and consequence. Decisions\nconcerning methods of mitigating cyber vulnerabilities include balancing the risk of system compromise\nby an intruder with the risk of potentially degrading system operability. Above all, the ICS must be\nreliable and perform its required mission. Therefore, the suggested approach is to build security into a\nsystem before it is put into production or add security into an existing system in small increments. When\nadding security to a production system, test on a backup system first to allow quick recovery to the\n\n\n-----\n\nprevious configuration in the event any security measure affects system operation. Always weigh the risks\nand add the appropriate amount of security measures for the specific situation.\n\nAsset owners must use procurement specifications to ensure that security development life-cycle\nrequirements are met by the vendor. Asset owners also may hire independent security assessment teams to\nreview demonstration vendor products for security issues prior to purchase. Vulnerability and patch\nmanagement programs and policies must be established and enforced.\n\nGood defense in-depth perimeter protections should be used to help prevent access to vulnerable\ncomponents and communication on ICS networks. Part of a good defense in-depth strategy is identifying\nand mitigating known vulnerabilities and weaknesses in the system that may help an attacker manipulate\nor cause damage to the system. Continuous monitoring of IDS logs can allow system administrators to\ncatch and block attempts to circumvent these defenses before serious damage is done.\n\nFirewalls, IDS, and antivirus solutions should be deployed and properly configured at all appropriate\nlocations. Asset owners must identify and deploy security workarounds, defense-in-depth strategies, and\nuse monitoring (access logs and intrusion detection systems) to mitigate risk introduced by the presence\nof unpatched vulnerabilities until patches can be properly tested and deployed.\n\nOwners/Operators are recommended to increase the security of their systems by completing the\nfollowing recommendations:\n\n- Redesign network layouts to take full advantage of firewalls, VPNs, etc.\n\n- Implement a network topology for the ICS that has multiple layers, with the most critical\ncommunications occurring in the most secure and reliable layer\n\n- Restrict physical access to the ICS network and devices\n\n- Expeditiously deploy security patches after testing all patches under field conditions on a test system\nif possible, before installation on the ICS\n\n- Work with vendor to test and apply patches for all operating systems and software on the ICS\nnetworks\n\n- Customize IDSs for the ICS hosts and networks\n\n- Restrict ICS user privileges to only those that are required to perform each person’s job\n(i.e., establishing role-based access control and configuring each role based on the principle of least\nprivilege)\n\n- Develop a password management plan to enforce strong passwords with minimum length, mixed\ncharacter sets, expiration, no password reuse, etc., and change all default passwords.\n\n##### 5.2.1 Restrict ICS User Privileges to only those Required\n\nA common problem with applications and services is that they are run with system or root-level\nprivileges. If this case is applicable, and an attacker is able to redirect execution, exploit code will run\nwith those same privileges giving him full access to that device. A number of software products run with\nthese super user permissions by default even though their functions do not require them. Therefore,\npermission levels of applications and services should be lowered to that necessary for their required\nfunctions.\n\nAnother common problem is allowing users to operate a computer system (consoles, servers, etc.)\nwith more permissions than necessary. User accounts used for interactive logon should be carefully\nevaluated for the lowest set of permissions necessary.\n\nFile access should then be restricted to those who require access. If network access to a file is\nnecessary, restrict access as much as possible and require strong authentication.\n\n\n-----\n\n##### 5.2.2 Change All Default Passwords and Require Strong Passwords\n\nIn some ICS operations, user IDs, and passwords are shared among the different operators of the\nsystem. This sharing must exist, in many cases, because of the criticality of the system operation.\nUnacceptable consequences might occur because of a locked user ID or a forgotten password. Typical\ncontinual manning of operating consoles provides additional physical security that reduces the need for\ndistinct operator user IDs and passwords. If user-level authentication is not an option for operators, ensure\nall users have separate accounts for all other account types in the ICS to help increase security and\naccountability. These prudent actions can prevent an attacker from using a user ID and password obtained\nfrom the business LAN to gain access to the ICS DMZ and/or the ICS LAN and also prevent authorized\nusers from performing actions that cannot easily be attributed to them.\n\nICS and networking equipment should not be left with the default manufacturer passwords. Default\npasswords can give an attacker easy access to the equipment that controls the process. Unless required by\nthe ICS software, default passwords should always be changed to robust, unpublished passwords. In the\ncase that the software uses hardcoded passwords, work with the vendor to fix this vulnerability.\nImplement a password policy that enforces strong passwords to greatly impede password cracking and\nguessing.\n\nPasswords have been found in control rooms on small pieces of paper on the bottom of the keyboard,\nin a drawer, etc. If a password is too complicated and difficult to remember, or changes too often, users\nwill undermine their security in order to remember them. Complex passwords do protect against some of\nthe advanced password cracking attacks, but they create a physical and social engineering vulnerability\nthat could be exploited by an attacker. Therefore, passwords should not be auto-generated, but instead\ncreated from passphrases or other memorable means.\n\n##### 5.2.3 Test and Apply Patches \n\nICS owners must rely on their ICS vendor in some part for validation of patch compatibility before\napplying them to their operational system. One way to reduce this problem is to reduce the number of\napplications that need patched.\n\nServices or applications running on a system open up different network ports to be able to\ncommunicate to the outside world. Each open port provides a possible access path for an attacker that can\nbe used to send exploits and receive data. An attacker can only gain access to and receive information\nfrom the ICS through an open port. The more ports and services that are accessible, the greater the risk of\nsuccessful exploits due to existing vulnerabilities in the services.\n\nNew vulnerabilities are found every day in the applications and services that run on computers. Some\nof these vulnerabilities are published shortly after their discovery, and some are kept a close secret,\nallowing a few hackers to exploit computers at will, with no patches available to stop them. Decreasing\nthe number of installed applications and services decreases the likelihood of an attacker finding a\nvulnerability on the computer. Therefore, all unneeded applications and services should be removed.\nAlso, adequate resources must be allocated to ensure that all services and applications are completely\npatched and up-to-date using the process described in the preceding patches section.\n\nThe patching process should be worked closely with vendor support to ensure ICS application\nintegrity is maintained. Before stopping any services or programs, the vendor should confirm that the\nservice is not needed for system functionality. For conformation, any patch process test should be\nperformed on a backup or development system first, to isolate the primary system from any potential\ndamage. For example, a standard security measure is to shut off the auxiliary services such as echo,\nchargen, daytime, discard, and finger. However, if the echo port is being used as the system pulse to\nconfirm that the system is up and running, shutting off these services would disable the entire system.\n\n\n-----\n\n##### 5.2.4 Protect Critical Functions with Network Security Zones and Layers\n\nIn many cases, the individuals in charge of the ICS network do not have adequate security training.\nThis situation is generally due to a lack of funding or appreciation for the importance of this training.\nTraining provides an understanding of the security implications of a given network architecture and how\nto design a more secure network. Educating or hiring network administrators with skills to design and\nmanage the ICS network and its perimeter defenses with the most current security techniques is essential.\nNetwork attacks must be prevented, detected, or stopped before they have the opportunity to affect critical\nICS functions. ICS security is largely dependent on the effectiveness of the network design to prevent\nunauthorized access. Network administrators need to understand security concepts such as layering,\nsecurity, and functionality zones, and specific access rules to restrict all communication to only that\nwhich is necessary for system functionality. If the network administrator has designed the network\ncorrectly, an attacker is limited to finding vulnerabilities in the authorized users/systems, protocols, or\nassociated applications/servers allowed into each network segment, without being detected.\n\nTo provide defense-in-depth, firewalls can be used to separate different layers of the ICS network\n(i.e., the HMI level LAN from the ICS DMZ from the Enterprise network). These layers can be further\nsegregated into security zones to protect systems from attack through compromised systems on that layer.\nMultiple DMZs, or security zones, should be created for separate functionalities and access privileges,\nsuch as peer connections, the data historian, the OPC server or ICCP server in SCADA systems, the\nsecurity servers, replicated servers, and development servers.\n\nAny connection into the ICS LAN is considered part of the perimeter. Often these perimeters are not\nwell documented and some connections are neglected. All entry points into the ICS LAN should be\nknown and strictly managed by a security policy. Route all connections to the ICS LAN through the\nfirewall, with no connections circumventing it. Network administrators need to keep an accurate network\ndiagram of their ICS LAN and its connections to other protected subnets, DMZs, the corporate network,\nand the outside.\n\nWell-configured firewalls are critical to ICS security. Communications should be restricted to that\nnecessary for system functionality. ICS traffic should be monitored, and rules should be developed that\nallow only necessary access. Any exceptions created in the firewall rule set should be as specific as\npossible, including host, protocol, and port information. All rules should be concise and well documented.\nThe IDS sensors can then be used to audit the firewall rule set.\n\nA common oversight is not restricting outbound traffic. Firewall rules should consider both directions\nthrough the firewall. An exploit that cannot connect back to the attacker is limited to blind attacks. An\nattacker needs to obtain information from and send files and commands to the ICS network. To remotely\ncontrol exploit code running on an ICS computer, a return connection must be established from the ICS\nnetwork. Because of the nature of most vulnerabilities, exploit code must be small and contain just\nenough code to get an attacker onto the computer; insufficient space is present to add expensive logic for\nthe attacker to get advanced functionality. Therefore, additional instructions are needed from the attacker\nto continue with the discovery portion of the attack. If outbound filtering is implemented correctly, the\nattacker will not receive this return connection and cannot discover and control the exploited machine.\n\nThe top priority of most ICS installations is availability. The risk to availability of any security\nfeature must be weighed against the expected added security benefit (lowered risk). ICS network\nadministrators may not want to risk the chance of impacting ICS functionality by redesigning the network\nor updating rules as components are added or removed. In this case, network traffic can be monitored for\na long enough period to be confident all possible scenarios have occurred. Rules can then be created\nstarting with the standard restrictions; working toward a rule set that excludes all unnecessary traffic.\nOnce the necessary traffic has been determined, a safer configuration can then be created that blocks all\ntraffic with exceptions for the specific host, protocol, and port combinations that require access in each\ndirection through the firewall.\n\n\n-----\n\nGreater assurance that network security changes will not affect operations can be obtained by\nimplementing changes as IDS rules. IDS logs can be monitored for alerts identifying traffic that would\nhave been prevented by the new segmentation or access rules. All proposed network changes can be\ntested as IDS rules for as long as necessary to provide assurance that they will not affect critical functions.\nBecause IDSs do not prevent access, closely monitor IDS logs during this period and immediately\ninvestigate unexpected communication.\n\n##### 5.2.5 Customize IDS Rules for the ICS and Closely Monitor Logs\n\nThe configuration and deployment of IDS for an ICS is not as straightforward as it is for typical\ncomputer networks. IDS signatures are available to detect a wide range of attacks, but the signatures\nrequired to monitor for malicious traffic in control networks are not adequate. When looking at the unique\ncommunications protocols used in ICS, such as Modbus or DNP3, specific payload and port numbers\nhave traditionally not been a part of the signatures seen in a contemporary IDS. In short, modern IDSs\ndeployed on ICS networks may be blind to the types of attacks that an ICS would experience.\n\nWhen deploying IDS in an ICS network, the ability to add unique signatures must be used. Removal\nof some default signatures and response capability is commonplace, as it may have no relevance to ICS\nnetwork. However, analysis must be made to ensure some of the inherent capability of the IDS is\nleveraged, with some of the capability refined and augmented. Many security vendors, including those\nspecializing in ICS security, have created signatures for the IDS that are deployed in control architectures.\nRules sets and signatures unique to that domain be used are imperative when deploying IDS on ICS\nnetworks. Developing security signatures and rules in a cooperative relationship with the ICS vendor are\nshown through study as very advantageous.\n\nOne of the common problems observed in industry is that tools deployed for network monitoring are\nimplemented but improperly updated, monitored, or validated. Assigned individuals should be trained and\ngiven the responsibility of monitoring system data logs and keeping the various tool configurations\ncurrent.\n\nIDS logs can also be used to identify normal communication between each of the ICS components.\nAll unexpected traffic can be investigated and either added to the required communication list or blocked\nby firewalls.\n\nA one-to-one mapping of firewall rules and IDS signatures should exist so when a firewall rule is not\nsuccessfully applied; the IDS sensor will alert and allow administrators to take corrective action on the\nfirewall.\n\nThe external IDS sensor is used for notification of malicious attempts on the firewall and for\nmonitoring egress rules from the ICS out to the DMZ or corporate networks. The internal IDS sensor and\nthe DMZ IDS sensor are used to closely monitor the exceptions in the firewall for malicious activity.\n\nIntrusion detection is not a single product or technology. A comprehensive set of tools providing\nnetwork monitoring can give an administrator a complete picture of how the network is being utilized.\nImplementing a variety of these tools will help create a defense-in-depth architecture that will be more\neffective in identifying attacker activities.\n\n##### 5.2.6 Force Security through External Software Security Assessments\n\nICS customers can require a security audit of an ICS product and fixes in order to meet specified\nsecurity levels as part of the procurement process. This allows the ICS customers to identify security risks\nof the products and determine whether they are acceptable and/or able to be mitigated. ICS owners can\nalso have external security audits on their existing systems to identify risks that need to be mitigated.\nSecurity audits also help fulfill regulatory requirements, but the audit should be used to help secure the\nICS as much as possible, not just to fill a requirement.\n\n\n-----\n\nAs ICS industry security requirements have begun to be created, some facilities have learned that they\ncan get away with documenting exceptions to the rules. The requirements developed in an effort to help\nICS owners increase their security levels have failed in some cases. ICS owners should look at the\ndevelopment of standards as an opportunity to obtain assistance in securing their assets. Requirements\nsuch as yearly security audits can be viewed by those responsible for ICS systems as help in convincing\nmanagement to spend money on security.\n\n\n-----\n\n#### 6. SUMMARY\n\nCSSP has conducted 15 ICS assessment and identified two hundred and forty five vulnerabilities that\ncould put the critical systems at risk from a cyber attack. The CSSP assessments are performed to assist in\nthe identification and mitigation of vulnerabilities to support the reduction of risk to critical infrastructure.\nAssessments were designed to test vendor-specific products and services such as custom protocols, field\nequipment, applications, and services. Onsite system assessments generally assessed how securely\nexternal connections, firewall configurations, IDS, network architecture, and other components are\ndeployed and installed.\n\nThe identified common vulnerabilities from the CSSP assessments are being shared to increase\nsecurity awareness and mitigation. ICS vendors and owners can learn and apply many common computer\nsecurity concepts and practices to secure and protect their systems. Security should be designed and\nimplemented by qualified security and ICS experts who are able to verify that the solutions are effective\nand can make sure that the solutions do not impair the system’s reliability and timing requirements. Given\nthe nature of the vulnerabilities found in ICS, asset owners cannot always directly fix them. Thus, as asset\nowners wait for vendor patches and fixes, the design and implementation of defense-in-depth security\nstrategies that aid in protecting the ICS from attack is part of an effective proactive security program.\n\nAttack strategies are constantly evolving to compensate for increasing defense mechanisms. Vendors\nshould offer or support security products and features that can be used as layers of defense to help protect\nICS installations. Owners should add the additional network perimeter layers of defense, and actively\nupdate and monitor the system. Increasing the hurdles required to attack a system decreases the chance\nthat attackers are able to subvert all hurdles and increases the chance that the attackers will give up before\naccomplishing their goals. Designing security into the system and using secure coding and security best\npractices can also minimize damage from attacks by insiders, social engineers, or anyone else with access\nbehind the ICS network perimeter.\n\nICS product vendors are responsible to deliver systems that are able to survive attack without\ncompromising critical functionality. ICS owners have the responsibility to ensure that the physical\nsystems they operate do not put lives, economy, or environment at risk by failing to perform due diligence\nin procuring, configuring, securing, and protecting the ICS for critical infrastructure.\n\n\n-----\n\n#### 7. REFERENCES\n\n1. ANSI/ISA–99.00.01–2007, “Security for Industrial Automation and Control Systems Part 1:\nTerminology, Concepts, and Models,” October 2007, pages 69–73.\n\n[2. CWE (Common Weaknesses Enumeration), MITRE, http://cwe.mitre.org/, January 11, 2009.](http://cwe.mitre.org/)\n\n3. Kevin Poulsen, “Slammer worm crashed Ohio nuke plant network,”\n\n[http://www.securityfocus.com/news/6767, August 2003.](http://www.securityfocus.com/news/6767)\n\n4. Control Systems Security Center, “Control Systems Cyber Security: Defense in Depth Strategies,”\n\n[http://csrp.inl.gov/Recommended_Practices.html#nogo, May 2006.](http://csrp.inl.gov/Recommended_Practices.html#nogo)\n\n5. Jaikumar Vijayan, “Gates pushed change in security culture at Microsoft,”\n\n[http://www.computerworld.com/action/article.do?command=viewArticleBasic&articleId=9102998,](http://www.computerworld.com/action/article.do?command=viewArticleBasic&articleId=9102998)\nJune 2008.\n\n\n-----\n\n### Appendix A\n CSSP Assessment Processes\n\n\n-----\n\n-----\n\n### Appendix A\n CSSP Assessment Information\n\nThe current overall impact of the CSSP on the stakeholder community encompasses strong user\ninterest in the information from the assessment reports. CSSP assessment team members in conjunction\nwith the vendors are able to inform ICS owners of vendor-approved findings and recommendations at\nvendor user group conferences and through other vendor-approved channels. ICS owners have requested\nassessments of their sites, and both utilities and vendors have requested follow-up assessments on the\nvendors’ ICS software. After-action validation of mitigations to identified security flaws are also\nperformed to help ensure the security assessments are successful in increasing critical infrastructure\nsecurity. General knowledge gained through performing multiple ICS security assessments and\ncorrelating assessment report findings is shared through security awareness training, presentations, and\nreports such as this.\n\n#### A-1. Laboratory Assessments\n\nThe CSSP performs assessments under Cooperative Research and Development Agreements\n(CRADAs) or Nondisclosure Agreements (NDAs). The CSSP assessment team develops the test plans,\nperforms the cyber security assessments, and reports the results. These agreements also protect the vendor\nfrom public disclosure of the assessment findings.\n\nAssessments are usually performed on the latest release of the vendors’ systems that is represented\nwithin industry which is based on a typical or turnkey installation. This allows CSSP assessment team to\ninfluence the system that is currently under development. Identifying a baseline or default architecture is\ngenerally difficult because every installation includes some degree of custom configuration. Vendors may\nsupport multiple operating systems, features, and ICS protocols. Customers can choose from an\nassortment of functionality, which can be separated on different servers or combined on one, and many\nlevels of redundancy can be provided. Therefore, CSSP works closely with each vendor to ensure that to\nthe extent possible, the components most commonly found in customer facilities are included in the test\narchitecture.\n\n#### A-2. Onsite Assessments\n\nOnsite assessments differ from laboratory assessments largely in the amount of time spent on testing\nand the functional areas of focus for the system assessment. Onsite assessments are completed in 2 or 3\nweeks, as compared to 2 or 3 months for more in-depth laboratory assessments. Because an intrusive\nexamination of the operational ICS itself is not appropriate, and system owners and operators cannot\nmodify the ICS software themselves, the focus for onsite assessments is usually network security and\nperimeter protection. These two areas of focus from the main areas system owners and operators have\ndirect control over for mitigating findings on their assessment and the associated vendor assessment.\n\nThe focus of the assessment is changed in order to analyze a fielded system and mechanisms for\nimplementation and protection in production. This changes the assessment to resemble a “network\nsecurity layers of defense” analysis. This includes a review and tour of the production system to help\nidentify through documentation, observation, and conversation any possible security problems with the\nproduction system and network configuration without putting the operational system at risk. Analysis of\nthe actual site’s ICS software is done on a backup or test system so that the custom installation can be\nevaluated based on vulnerabilities found in the associated vendor laboratory assessment. Any mitigating\nrecommendations can then be given to the customer while the vendor fixes the underlying problem.\n\n#### A-3. REFERENCES\n\n\n-----\n\nPermann, May, Kenneth Rohde, “Cyber Assessment Methods for SCADA Security,”\nhttp://www.isa.org/InTechTemplate.cfm?Section=Article_Index1&template=/ContentManagement/Conte\nntDisplay.cfm&ContentID=49890, November 2005.\n\n\n-----\n\n### Appendix B\n Common Vulnerability Identification\n\n\n-----\n\n-----\n\n### Appendix B\n Common Vulnerability Identification\n\n#### B-1. Identification of Recommended Mitigations\n\nReported assessment findings were extracted, combined, and categorized as described in Common\n_Cyber Security Vulnerabilities Observed in DHS ICS Assessments and were given corresponding_\nrecommendations and mitigations. These recommendations and mitigations are based on those indicated\nin the assessment reports. The mitigations are general in nature, with the intent of being applicable to\nfindings identified in multiple assessments. As such, they are high-level generic recommendations and\nrequire further refinement before implementation on any specific system. Most of the assessments to date\nonly evaluated the ICS software, rather than hardware. Therefore, a majority of the recommendations\nrequire vendor development, not just a configuration change that can be done by the end users. Based on\ntypical maintenance agreements, changes may have to be approved by the maintenance provider prior to\nimplementation. All changes will have to be tested to determine the impact to production and operations.\nSome may even require extensive rewrites and are not feasible for incorporation into current software\nreleases. In these cases, other defensive measures need to be defined and implemented. Each system\nneeds to be considered on an individual basis following the applicable standards, policies, and procedures\nrespective to all contracts and legal obligations.\n\n#### B-2. Frequency of Occurrence\n\nEach assessment had different goals and vulnerability identification coverage. Therefore, specific\ncommon vulnerabilities are reported, but the number of assessments that tested for that particular\nvulnerability is not necessarily known.\n\nNot all systems were tested identically, not all vulnerability types were looked for in all systems, and\nno single standardized testing methodology was used. In addition, not all vulnerabilities found are\nincluded in this report. To prevent identifying a specific system or vendor, this report includes only\nfindings determined to be common to multiple systems. Future assessments will test for all common\nvulnerabilities identified in this report. However, new common vulnerabilities also will be identified in\nthe future that have not been tested for in all assessments.\n\n\n-----\n\n-----\n\n### Appendix C\n Terms and Definitions\n\n\n-----\n\n-----\n\n### Appendix C\n Terms and Definitions\n\nAccess Authorization Access authorization restricts access to or from a computer, server, Web site,\nor network to a group of users through the application of authentication\nsystems. These systems can protect either the whole computer, such as\nthrough an interactive logon screen, or individual services, such as an FTP\nserver. Many methods are available for identifying and authenticating users,\nsuch as passwords, identification cards, smart cards, and biometric systems.\n\nAccess Control List An access control list is a list of permissions attached to a firewall, server, or\nother device on a network. The list specifies who or what is allowed to\naccess the device and what operations are allowed to be performed on the\ndevice.\n\nAntivirus Software Antivirus software consists of a computer program that attempts to identify,\nneutralize, or eliminate malicious software (i.e., viruses, Trojan horses,\nmalware, spyware).\n\nARP Address resolution protocol (ARP) is the standard method for finding a\nhost’s hardware address when only its network layer address is known.\n\nBuffer Overflow There are two types: stack buffer overflow and heap buffer overflow. Both\ntypes of overflow occur when an amount of data larger than the target data\nbuffer area is written to that buffer. The extra data overwrites adjacent\nmemory locations in either the stack (temporary memory) or the heap\n(dynamic memory) with corrupt data values causing erroneous program\nresults or malicious code to be executed.\n\nChange Management The change management process is the process of requesting, determining\nattainability, planning, implementing, and evaluation of changes to a system.\nIt has two main goals: supporting the processing of changes and enabling\ntraceability of changes.\n\nControl System A device or set of devices to manage, command, direct, or regulate the\nbehavior of other devices or systems.\n\nDMZ A demilitarized zone (DMZ), more appropriately known as demarcation\nzone or perimeter network, is a physical or logical subnetwork that interfaces\nan organization’s external services to a larger, untrusted network, usually the\nInternet. The DMZ adds an additional layer of security to an organization’s\nLocal Area Network (LAN).\n\n\n-----\n\nEncryption Encryption is the process of transforming information (referred to as\nplaintext or clear text) using an algorithm (called a cipher) to make it\nunreadable to anyone except those possessing special knowledge, usually\nreferred to as a key.\n\nExploit An exploit (from the same word in the French language, meaning\n“achievement” or “accomplishment”) is a piece of software, a chunk of data,\nor sequence of commands that take advantage of a bug, glitch, or\nvulnerability in order to cause unintended or unanticipated behavior to occur\non computer software, hardware, or something electronic (usually\ncomputerized). This frequently includes such things as gaining control of a\ncomputer system or allowing privilege escalation or a denial-of-service\nattack.\n\nFinding An item identified during an assessment. It can be a vulnerability, an\nobservation, a weakness, a flaw, a code error, or a concern.\n\nFirewall Firewalls can either be hardware devices or software programs. They\nprovide some protection from online intrusion. They are systems that help\nprotect computers and computer networks from attack and subsequent\nintrusion by restricting the network traffic that can pass through them, based\non a set of system administrator defined rules.\n\n\nFuzzing or Fuzz\nTesting\n\n\nA software testing technique that uses random data, also known as “fuzz,” as\ninput to the software. This technique attempts to exercise code by using\nvalues that may be outside the normal range of values for which the software\nwas designed. By doing this the testing, it will uncover areas of the code that\nwere inadequate in handling input values outside the normally desired\nranges.\n\n\nICCP The Inter-Control Center Communications Protocol (ICCP or\nIEC 60870-6/TASE.2) is being specified by utility organizations throughout\nthe world to provide data exchange over wide-area networks (WANs)\nbetween utility control centers, utilities, power pools, regional control\ncenters, and Non-Utility Generators. ICCP is also an international standard:\nInternational Electrotechnical Commission (IEC) Telecontrol Application\nService Element 2 (TASE.2).\n\nGround Truthing The technique of verifying that results obtained from lab testing or\nsimulations are repeatable in real-world situations. An example: lab results\nshow a particular configuration creates a vulnerability. Ground truthing of\nthis is accomplished by checking the production system and verifying that\nindeed a vulnerability exists.\n\nInformation Leaks Inside information that is carelessly disseminated such as passwords written\non sticky notes or shared among users. This can also include information\nitems such as user IDs, passwords, and other system information that is not\nencrypted when transmitted or when stored.\n\n\n-----\n\nLeast Privileges The technique of assigning privileges for doing certain functions to only\nthose that require them. For example, restricting the ability to create new\nuser accounts to only the system administrator or a user that should only be\nable to query a database, but has privileges to delete the folder containing the\ndatabase file.\n\n\nMan-in-the-Middle\nAttack\n\n\nThe man-in-the-middle (MitM) attack or bucket-brigade attack is a form of\nactive eavesdropping in which the attacker makes independent connections\nwith computers that communicate with one another and relays messages\nbetween them, making them believe that they are talking directly to each\nother over a private connection when in fact the entire conversation is\ncontrolled by the attacker.\n\n\nOPC Object Linking and Embedding (OLE) is a technology that allows\nembedding and linking to documents and other objects developed by\nMicrosoft. OLE for Process Control (OPC) is the standards specification for\nthe communication of UUreal-time plant data between control devices from\ndifferent manufacturers.\n\nProtocol A protocol is the set of standard rules for data representation, signaling,\nauthentication, and error detection required to send information over a\ncommunications channel.\n\nReliability Reliability is the ability of a system to perform and maintain its functions in\nroutine circumstances as well as hostile or unexpected circumstances.\n\nSafety System A Safety System or Safety Instrumented System (SIS) is a control system\nconsisting of sensors, one or more controllers, and final elements. The\npurpose of an SIS is to monitor an industrial process for potentially\ndangerous conditions and to alarm or execute preprogrammed action to\neither prevent a hazardous event from occurring or mitigate the\nconsequences of such an event should it occur.\n\n\nSocial Engineering\nAwareness\n\n\nKeeping employees aware of the dangers of social engineering and having a\npolicy in place to prevent social engineering can reduce successful breaches\nof the network and servers.\n\n\nTaxonomy The science, laws, or principles of classification.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/ICS SCADA/ICS Vulnerabilities/Common Cyber Security Vulnerabilities Observed in ICS (2009).pdf"
    ],
    "report_names": [
        "Common Cyber Security Vulnerabilities Observed in ICS (2009).pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535589,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1248189579,
    "ts_modification_date": 1248190652,
    "files": {
        "pdf": "https://archive.orkl.eu/4ff8f1be08a9b88f814a49e9da2dea7636f2b8c0.pdf",
        "text": "https://archive.orkl.eu/4ff8f1be08a9b88f814a49e9da2dea7636f2b8c0.txt",
        "img": "https://archive.orkl.eu/4ff8f1be08a9b88f814a49e9da2dea7636f2b8c0.jpg"
    }
}