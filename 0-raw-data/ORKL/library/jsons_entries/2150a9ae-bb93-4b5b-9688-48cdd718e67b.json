{
    "id": "2150a9ae-bb93-4b5b-9688-48cdd718e67b",
    "created_at": "2023-01-12T15:01:41.184849Z",
    "updated_at": "2025-03-27T02:08:40.194254Z",
    "deleted_at": null,
    "sha1_hash": "571b58af6b23fb4b2c4018b99826ebce3486ffe2",
    "title": "2021-03-17 - Satori- Mirai Botnet Variant Targeting Vantage Velocity Field Unit RCE Vulnerability",
    "authors": "",
    "file_creation_date": "2022-05-29T10:46:40Z",
    "file_modification_date": "2022-05-29T10:46:40Z",
    "file_size": 1312261,
    "plain_text": "# Satori: Mirai Botnet Variant Targeting Vantage Velocity Field Unit RCE Vulnerability\n\n**[unit42.paloaltonetworks.com/satori-mirai-botnet-variant-targeting-vantage-velocity-field-unit-rce-vulnerability/](https://unit42.paloaltonetworks.com/satori-mirai-botnet-variant-targeting-vantage-velocity-field-unit-rce-vulnerability/)**\n\nHaozhe Zhang, Vaibhav Singhal, Zhibin Zhang, Jun Du March 17, 2021\n\nBy [Haozhe Zhang,](https://unit42.paloaltonetworks.com/author/haozhe-zhang/) [Vaibhav Singhal,](https://unit42.paloaltonetworks.com/author/vaibhav-singhal/) [Zhibin Zhang and](https://unit42.paloaltonetworks.com/author/zhibin-zhang/) [Jun Du](https://unit42.paloaltonetworks.com/author/jun-du/)\n\nMarch 17, 2021 at 3:35 PM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [botnet,](https://unit42.paloaltonetworks.com/tag/botnet/) [CVE-2020-9020,](https://unit42.paloaltonetworks.com/tag/cve-2020-9020/) [IoT,](https://unit42.paloaltonetworks.com/tag/iot/) [Mirai variant,](https://unit42.paloaltonetworks.com/tag/mirai-variant/) [vulnerabilities](https://unit42.paloaltonetworks.com/tag/vulnerability/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/satori-mirai-botnet-variant-targeting-vantage-velocity-field-unit-rce-vulnerability/)\n\n## Executive Summary\n\n[On Feb. 20, 2021, Unit 42 researchers observed attempts to exploit CVE-2020-9020, which is a Remote Command Execution](https://nvd.nist.gov/vuln/detail/CVE-2020-9020)\n(RCE) vulnerability in Iteris’ Vantage Velocity field unit version 2.3.1, 2.4.2 and 3.0. As a travel data measurement system,\nVantage Velocity captures travel data with a large number of vehicles. If a device is compromised, it will be under control of\nattackers, who can then leak sensitive data or conduct further attacks, such as Distributed Denial-of-Service (DDoS) attacks.\nThe vulnerability has a critical rating (i.e., CVSS 3.1 score of 9.8) due to its low attack complexity, but critical security impact.\nThe exploit captured by Unit 42 researchers utilized the vulnerability to spread Satori, a Mirai botnet variant.\n\n[Palo Alto Networks Next-Generation Firewall customers with security subscriptions such as Threat Prevention,](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention) [WildFire,](https://www.paloaltonetworks.com/products/secure-the-network/wildfire) URL\nFiltering and [IoT Security are able to detect and prevent the exploit traffic and the malware.](https://www.paloaltonetworks.com/network-security/iot-security)\n\n## Vulnerability Analysis\n\nThe vulnerable devices lack a check on the htmlNtpServer parameter of /cgi-bin/timeconfig.py, allowing attackers to inject\n[commands via crafted HTTP requests and have them executed on victim’s devices. This vulnerability was disclosed in early](https://sku11army.blogspot.com/2020/01/iteris-vantage-velocity-field-unit-os.html)\n2020, but the National Vulnerability Database (NVD) published it recently, not long before the exploit attempts.\n\n## Exploit in the Wild\n\nOn Feb. 20, 2021, Palo Alto Networks Next-Generation Firewall caught the first exploit attempt. As shown in Figure 1, the\nexploit attempted to download the file arm7 from the server 198[.]23[.]238[.]203 with the system command wget and then\nchange the access permissions of the downloaded file to ensure it can be executed with the current user privileges.\n\n\n-----\n\nFigure 1. Exploit request in the wild.\nThe server 198[.]23[.]238[.]203 was first noticed (serving a malicious shell script) by the security community on Feb. 17, 2021,\naccording to VirusTotal. At the time of this writing, the server is still accessible. It provides an HTTP service on port 80, based\non Apache2 HTTP server, that provides a malware downloading service. It also has port 5684 opened, which is believed to\nserve as the command and control (C2).\n\nAccording to our investigation, nine samples with similar functions but different platform compatibility were found on the server.\nThey are able to run and compromise devices across multiple mainstream architectures. Thus, these malware can be easily\nutilized again when the attacker changes the exploit against other target systems.\n\nThe information for all nine samples are listed in the Indicators of Compromise (IoCs) section.\n\n## Mirai Botnet Variant (Satori)\n\nBased on our in-depth investigation into the behaviors and patterns, we believe that the malware samples hosted on the server\n198[.]23[.]238[.]203 are highly likely to be a variant of the Mirai botnet, Satori.\n\nWhen executed, it prints the message “hello friend :)” to the console. Then, four child processes are spawned and detached\nfrom the main process.\n\nThe malware was observed to scan port 23 of random hosts (as shown in Figure 2) and tries to login with its embedded\npassword dictionary when port 23 is open.\n\nFigure 2. Satori port scanning.\n\n\n-----\n\nFigure 3. Passwords encrypted with XOR algorithm and key 0x07.\nThe passwords are encrypted using the XOR algorithm with a single byte key of 0x07, as shown in Figure 3.\n\nThe encrypted C2 traffic over SSL was also observed between the victim and 198[.]23[.]238[.]203:5684, as shown in Figure 4.\n\nFigure 4. Traffic to C2 server.\nThe malware also contains multiple predefined operating system (OS) commands, as shown in Figure 5. Those commands are\nused to download and execute malicious payload from remote C2 servers to deploy bots on new victim devices.\n\n\n-----\n\nFigure 5. Predefined OS commands.\n\n## Conclusion\n\nCVE-2020-9020 is easy to exploit and can lead to RCE. After gaining control, attackers can take advantage and include the\ncompromised devices in their botnet. Therefore, we strongly advise to apply patches and upgrade when possible.\n\nPalo Alto Networks customers are protected from the vulnerability by the following products and services:\n\nNext-Generation Firewalls with a Threat Prevention security subscription can block the attacks with Best Practices via\n[Threat Prevention signature 90769.](https://threatvault.paloaltonetworks.com/?query=90769)\nWildFire can stop the malware with static signature detections.\nURL Filtering can block malicious malware domains.\n\n\n-----\n\nIoT Security can provide coverage on legacy IoT sensors.\n\n## Indicators of Compromise (IoCs)\n\n51[.]81[.]24[.]157\n\n198[.]23[.]238[.]203\n\n**Filename** **URL** **SHA256**\n\n_arm_ http://198[.]23[.]238[.]203/arm 0d74227dbc3bdd74a3854d81e47cf6048da2d95c3010b953de407e5989beb066\n\n_arm7_ http://198[.]23[.]238[.]203/arm7 fe8e5e7041dfda470f9e2ad9abe9e0da3e43ddb5b24209e42ce0e3ebee1a7bfe\n\n_mips_ http://198[.]23[.]238[.]203/mips 320d7067d60f9ed7e7f3e9408a5d3b0a6fdccddde494c0a2a4f4e77aecb80814\n\n_mips_ http://198[.]23[.]238[.]203/mipsel fbe314dc3b284ce2db1f37478338fdba8130bf44e484f5028ca92eb9326417e4\n\npowerpc http://198[.]23[.]238[.]203/powerpc 3c62d16451db32f72464a854d6aceb7c7ba2f07c38850f6a247a5243c0f473cb\n\nsh4 http://198[.]23[.]238[.]203/sh4 13ce782d393f2b4ce797747d12f377afad9d6e56c10f52948034a234654a9d30\n\nsparc http://198[.]23[.]238[.]203/sparc 985127ed1610cfca49f6dba273bb0783f20adf763e1d553c38e5a0f9f89328c3\n\nm68k http://198[.]23[.]238[.]203/m68k e458dca7ddceae3412e815e5c70e365f6cc918be2d512e69b5746ed885e80268\n\nx86_64 http://198[.]23[.]238[.]203/x86_64 989e49f9aaff3645c40a2c40b8959e28e4ff0a645e169bb81907055a34f84dfb\n\nx86_32 http://198[.]23[.]238[.]203/x86_32 _22818ae75823ee5807d5d220500eb9d5829927d57e10ce87312d1c22843fb407_\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-17 - Satori- Mirai Botnet Variant Targeting Vantage Velocity Field Unit RCE Vulnerability.pdf"
    ],
    "report_names": [
        "2021-03-17 - Satori- Mirai Botnet Variant Targeting Vantage Velocity Field Unit RCE Vulnerability.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535701,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653821200,
    "ts_modification_date": 1653821200,
    "files": {
        "pdf": "https://archive.orkl.eu/571b58af6b23fb4b2c4018b99826ebce3486ffe2.pdf",
        "text": "https://archive.orkl.eu/571b58af6b23fb4b2c4018b99826ebce3486ffe2.txt",
        "img": "https://archive.orkl.eu/571b58af6b23fb4b2c4018b99826ebce3486ffe2.jpg"
    }
}