{
    "id": "aa7e929f-8ae2-406b-8529-a0d9b26d6a64",
    "created_at": "2023-01-12T15:07:37.382718Z",
    "updated_at": "2025-03-27T02:09:18.805293Z",
    "deleted_at": null,
    "sha1_hash": "d6795dafd1600dda09daa415e3229d8c19f64a42",
    "title": "2020-10-18 - Ryuk in 5 Hours",
    "authors": "",
    "file_creation_date": "2022-05-28T18:02:38Z",
    "file_modification_date": "2022-05-28T18:02:38Z",
    "file_size": 789736,
    "plain_text": "# Ryuk in 5 Hours\n\n**thedfirreport.com/2020/10/18/ryuk-in-5-hours/**\n\n### Intro\n\n\nOctober 18, 2020\n\n\n#### The Ryuk threat actors went from a phishing email to domain wide ransomware in 5 hours. They escalated privileges using Zerologon (CVE-2020-1472), less than 2 hours after the initial phish. They used tools such as Cobalt Strike, AdFind, WMI, and PowerShell to accomplish their objective.\n\n Ryuk has been one of the most proficient ransomware gangs in the past few years, with the FBI claiming $61 million USD having been paid to the group as of February 2020. Earlier in the year, the group grew a little quiet, but that seems to have changed in the past few weeks, with incidents like what occurred at UHS hospitals.\n\n### Case Summary\n\n#### In our previous Ryuk case, we saw the threat actors leverage access to an environment via the Bazar Loader malware. This time around, we saw them accomplish their objective faster, but the general tactics and techniques stayed similar between incidents.\n\n Bazar was introduced to the environment again with the delivery via phishing emails. For an in depth breakdown on this loader, see this analysis by Roman Marshanski & Vitali Kremez. Bazar, once running, was seen again injecting into explorer.exe, svchost.exe, and spawning\n\n\n-----\n\n#### command shell processes.\n\n From this loader we saw initial mapping of the domain, using built-in windows utilities such as Nltest. However, unlike the last case, the threat actors started at a lower privileged user and rather than proceed slowly or cautiously, they exploited the recently disclosed Zerologon vulnerability (CVE-2020-1472) to reset the machine password of the primary domain controller.\n\n Lateral movement was initiated via SMB file transfers and WMI executions of Cobalt Strike Beacons. The network indicators align similarly to the prior campaign and were noted by Kyle Ehmke in response to our last post pivoting off the prior report’s intel. From memory analysis, we were also able to conclude the actors were using a trial version of Cobalt Strike with the EICAR string present in the network configuration for the beacon. Both portable executable and DLL beacons were used.\n\n After moving laterally to the secondary domain controller, the threat actor started on more domain discovery via Net and the PowerShell Active Directory module. From there, the threat actors appeared to use the default named pipe privilege escalation module on the server. At this point, the threat actors used RDP to connect from the secondary domain controller, to the first domain controller, using the built in Administrator account.\n\n Once on the main domain controller, another Cobalt Strike beacon was dropped and executed. Then more domain reconnaissance was performed using AdFind. Once this completed, at the four hour mark, the threat actors were ready for their final objective.\n\n Four hours and 10 minutes in, the threat actors used the pivot from the primary domain controller to RDP into the Backup server. Backup servers were again targeted first for deployment of the ransomware executable, followed by servers and then workstations.The threat actors finished their objective by executing the ransomware on the primary domain controller, and at the 5 hour mark, the attack completed.\n\n While last time we commented on the lead time between the first and second day to aid detection and response activity, this case goes to show that you can’t count on that kind of timescale. You need to be ready to act in less than an hour, to make sure you can effectively disrupt the threat actor.\n\n### Timeline\n\n\n-----\n\n-----\n\n### MITRE ATT&CK\n\n Initial Access\n\n#### Access was initiated by a phishing email leading to the Bazar Loader malware executable.\n\n### Execution\n\n#### Bazar relies on user execution of an executable to run. This user was a Domain User and did not have any other permissions.\n\n### Privilege Escalation\n\n#### CVE-2020-1472 was used to reset the credentials on one of the domain controllers in the environment. After resetting the password, the threat actors then targeted a different domain controller, potentially due to breaking services by use of their exploit.\n\n\n-----\n\n#### Packet showing the zeroed out password.\n\n On one of the domain controllers we saw use of the Cobalt Strike named pipe escalation.\n```\nC:\\Windows\\system32\\cmd.exe /c echo 92d8cc45954 >; \\\\.\\pipe\\446b3c\n\n### Defense Evasion\n\n#### On the first domain controller that the treat actors connected to after their initial connection, they dropped a DLL and executed it via rundll32.\nC:\\Windows\\system32\\cmd.exe /C rundll32 C:\\Windows\\system32\\SQL.dll, StartW\n\n Dropped via RDP and executed via rundll32 on the second domain controller.\nrundll32 C:\\PerfLogs\\arti64.dll, rundll\n\n Shortly after, the DLL was called again via regsrv32.\nregsvr32 C:\\PerfLogs\\arti64.dll\n\n Then a 2nd DLL was dropped and executed in a similar manner on the 2nd DC.\nrundll32 C:\\\\PerfLogs\\\\socks64.dll, rundll\n\n### Discovery\n\n```\n\n-----\n\n#### Ran on the beachhead.\n```\nnltest /domain_trusts /all_trusts\nnltest /dclist:DOMAIN\nnet group \"Domain admins\" /DOMAIN\n\n Ran on a domain controller.\nnet group \"enterprise admins\" /domain\nnltest /domain_trusts /all_trusts\nnltest /dclist:\"DOMAIN\"\nping DOMAINCONTROLLER\ncmd.exe /C time\nnet user administrator /domain\n\n Then they imported the PowerShell Active Directory module.\n\n They then ran the following looking for host names, operating systems and last logon dates of all AD systems.\nC:\\Windows\\system32\\cmd.exe /C Get-ADComputer -Filter {enabled -eq $true} -properties\n*|select Name, DNSHostName, OperatingSystem, LastLogonDate | Export-CSV\nC:\\Users\\AllWindows.csv -NoTypeInformation -Encoding UTF8\n\n After already completing the above discovery work and having already pivoted to their 2nd domain controller, the threat actors moved on to AdFind for further domain reconnaissance.\nC:\\Windows\\Temp\\adf\\AdFind.exe\nC:\\Windows\\Temp\\adf\\adf.bat\n\n Contents of the script ran the following with AdFind.\nadfind.exe -f \"(objectcategory=person)\"\nadfind.exe -f \"objectcategory=computer\"\nadfind.exe -f \"(objectcategory=organizationalUnit)\"\nadfind.exe -sc trustdmp\nadfind.exe -subnets -f (objectCategory=subnet)\nadfind.exe -f \"(objectcategory=group)\"\nadfind.exe -gcb -sc trustdmp\n\n The threat actor then ran this command a few times.\nnltest /domain_trusts /all_trusts\n\n### Lateral Movement\n\n```\n\n-----\n\n#### The first lateral movement occurred to the domain controller not affected by the use of CVE- 2020-1472. An executable was transferred to it via SMB using a domain administrator account.\n\n After transferring the exe, the threat actors utilized WMI from the beachhead host to execute the file.\n```\nC:\\Windows\\system32\\cmd.exe /C WMIC/node:\"DC.DOMAIN.local\" process call create \"cmd\n/c C:\\PerfLogs\\servisess.exe\\\"\n\n The presence of the EICAR strings point to the Cobalt Strike software being used as a trial version.\n\n They accessed the GPO’s for the domain but none were modified or added.\nmmc.exe\" \"C:\\Windows\\System32\\gpedit.msc\"\n\n Shortly there after we saw a Cobalt Strike DLL transferred via the RDP connection.\n\n```\n\n-----\n\n#### RDP was used to pivot from the main domain controller and distribute the final ransomware payload enterprise wide.\n\n### Command and Control\n\n#### After our previous report, @kyleehmke pivoted off of our prior Ryuk report and used the network data to link several of these domains which we saw in this case.\n\n Bazar:\n\n Report_Print.exe\n\n 3.137.182.114:443\n\n cstr3.com\n\n Cobalt Strike:\n\n servisses.exe\n\n 88.119.171.94:443 Certificate [86:77:d8:5e:51:69:ac:e2:08:07:2e:b0:dc:6c:10:9e:25:80:70:a6 ] Not Before 2020/10/06 13:33:55 UTC Not After 2021/10/06 13:33:55 UTC Issuer Org lol Subject Common havemosts.com Subject Org lol Public Algorithm rsaEncryption JA3: 57f3642b4e37e28f5cbe3020c9331b4c JA3s: e35df3e00ca4ef31d42b34bebaa2f86e SQL.dll 5.2.64.174:443 Certificate [36:d5:68:f9:be:2a:34:e1:76:3d:89:78:e5:62:4d:fc:ae:02:97:ad ] Not Before 2020/10/02 16:45:57 UTC Not After 2021/10/02 16:45:57 UTC Issuer Org lol Subject Common quwasd.com Subject Org lol Public Algorithm rsaEncryption JA3: a0e9f5d64349fb13191bc781f81f42e1 JA3s: ae4edc6faf64d08308082ad26be60767\n\n### Impact\n\n\n-----\n\n#### Starting around 4.5 hours after the initial Bazar malware was executed, the Ryuk threat actors acted on their final objectives and initiated RDP connections from the domain controller previously exploited, to the rest of the environment. This time they initiated the ransomware first on the secondary domain controller (their 1st pivot) and transferred the Ryuk executable over the RDP connection.\n\n Enjoy our report? Please consider donating $1 or more to the project using Patreon. Thank you for your support!\n\n We also have pcaps, files, memory images, Kape and Redline packages available here.\n\n## IOCs\n\n\n-----\n\n#### https://misppriv.circl.lu/events/view/80223 & https://otx.alienvault.com/pulse/5f8cce76f5614d9b220181b6\n\n### Network\n```\n3.137.182.114:443\ncstr3.com\n88.119.171.94:443\nhavemosts.com\n5.2.64.174:443\nquwasd.com\n\n File\nservisses.exe\nd971827d974effedaeaf7d62b619b1dd\nc3a846eb04e2fe765e56fa15a0d5c1eb650ccba3\n1d8b7faf5f290465cc742e07abca78fac419135b191071cc77912263cd1dde1d\nsocks64.dll\n890206f0c506366d480e02fc9fed988a\nba1542d9b55fff21bda9495ed884404b0436cff2\nfeb8c2bcb71da02dbbeecb999869e053cf96af8cce6f9705cadca4338133d3b5\nSQL.dll\n3785d87f6995b4b95d9b55f8d2556237\n9b44a8f0bb2d65fb19e7ca7bbd85b36c176f3d60\nd67461ba45a4edf3b2a69b3e64303fda8130bd1fc7a1173f35c1fe67b40c9639\narti64.dll\n3785d87f6995b4b95d9b55f8d2556237\n9b44a8f0bb2d65fb19e7ca7bbd85b36c176f3d60\nd67461ba45a4edf3b2a69b3e64303fda8130bd1fc7a1173f35c1fe67b40c9639\nxxx.exe\n5b8b66ddbbf1fd67211e9a4bf78c1700\ncdb042dd8e9dc17f677c991b386f4cd242f2628d\nccde47a0d315dcd4740fccfe8e8110fbb1fd85bb305734fec409f52051790c98\n\n## Detections\n\n### Network\nGPL NETBIOS SMB-DS IPC$ share access\nET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement\nET POLICY SMB2 NT Create AndX Request For an Executable File\n\n Sigma\n\n#### https://github.com/Neo23x0/sigma/blob/master/rules/windows/malware/win_mal_ryuk.yml\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_powers hell_suspicious_parameter_variation.yml\n\n```\n\n-----\n\n#### https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_w mi_execution.yml\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_trust_di scovery.yml\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_n et_execution.yml\n\n Detects AdFind usage from a past case:\n```\ntitle: AdFind Recon\ndescription: Threat Actor using AdFind for reconnaissance. \nauthor: The DFIR Report\ndate: 2019/8/2\nreferences:\n  - https://thedfirreport.com/2020/08/03/dridex-from-word-to-domain-dominance/\ntags:\n  - attack.remote_system_discovery\n  - attack.T1018\nlogsource:\n  category: process_creation\n  product: windows\ndetection:\n  selection_1:\n    CommandLine|contains:\n      - adfind -f objectcategory=computer\n  selection_2:\n    CommandLine|contains:\n      - adfind -gcb -sc trustdmp\n  condition: selection_1 or selection_2 \nfalsepositives:\n  - Legitimate Administrator using tool for Active Directory querying\nlevel: medium\nstatus: experimental\n\n### Yara\n\n```\n\n-----\n\n```\n/\nYARA Rule Set\nAuthor: The DFIR Report\nDate: 2020-10-13\nIdentifier: Case 1006 Ryuk\nReference: https://thedfirreport.com\n*/\n/* Rule Set ----------------------------------------------------------------- */\nimport \"pe\"\nrule ryuk_1006_servisses_procdump {\nmeta:\ndescription = \"files - file servisses-procdump.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2020-10-13\"\nhash1 = \"387894a0b404c67e722799308b12ff2be31d2e8ce798aa53d971f0c13805d54d\"\nstrings:\n$s1 = \"c:/crossdev/src/winpthreads-svn6233/src/mutex.c\" fullword ascii\n$s2 = \"mutex_global_shmem\" fullword ascii\n$s3 = \"mutex_global_static_shmem\" fullword ascii\n$s4 = \"_pthread_key_dest_shmem\" fullword ascii\n$s5 = \"_pthread_key_sch_shmem\" fullword ascii\n$s6 = \"_pthread_key_max_shmem\" fullword ascii\n$s7 = \"_pthread_key_lock_shmem\" fullword ascii\n$s8 = \"cannot find name of executable\" fullword ascii\n$s9 = \"tiles32.png\" fullword ascii\n$s10 = \"GetModuleFileName: %s\" fullword ascii\n$s11 = \"IP_DEST_HOST_UNREACHABLE (11003)\" fullword ascii\n$s12 = \"This program requires Windows NT!\" fullword ascii\n$s13 = \"SNMP INVALID_SESSION\" fullword ascii\n$s14 = \"SNMP TRAP_ERRORS\" fullword ascii\n$s15 = \"SNMP SELECT_FDERRORS\" fullword ascii\n$s16 = \"Some different radices: %d %x %o %#x %#o \" fullword ascii\n$s17 = \"c:/crossdev/src/winpthreads-svn6233/src/rwlock.c\" fullword ascii\n$s18 = \"_pthread_tls_shmem\" fullword ascii\n$s19 = \"IP_DEST_PORT_UNREACHABLE (11005)\" fullword ascii\n$s20 = \"pthr_root_shmem\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 2000KB and\n( pe.imphash() == \"a90d500745a1ce2417c01fecefbc2851\" or 8 of them )\n}\nrule ryuk_1006_files_socks64 {\nmeta:\ndescription = \"files - file socks64.dll\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2020-10-13\"\nhash1 = \"feb8c2bcb71da02dbbeecb999869e053cf96af8cce6f9705cadca4338133d3b5\"\nstrings:\n$x1 = \"C:\\\\Users\\\\Izidu\\\\Desktop\\\\2019\\\\WindowsSDK7-Samples-master\\\\WindowsSDK7Samples-master\\\\winui\\\\pictures\\\\acquisitionplugin\\\\x64\" ascii\n\n```\n\n-----\n\n```\n$s2 C:\\\\Users\\\\Izidu\\\\Desktop\\\\2019\\\\WindowsSDK7 Samples master\\\\WindowsSDK7\nSamples-master\\\\winui\\\\pictures\\\\acquisitionplugin\\\\x64\" ascii\n$s3 = \"PluginSample.dll\" fullword ascii\n$s4 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$s5 = \"luginSample.pdb\" fullword ascii\n$s6 = \"rundll\" fullword ascii\n$s7 = \"AcquireSamplePlugin::DisplayConfigureDialog\" fullword wide\n$s8 = \"AppPolicyGetThreadInitializationType\" fullword ascii\n$s9 = \"`template-parameter-\" fullword ascii\n$s10 = \"operator<=>\" fullword ascii\n$s11 = \"operator co_await\" fullword ascii\n$s12 = \"AppPolicyGetWindowingModel\" fullword ascii\n$s13 = \"Transfer Completed Successfully!\" fullword wide\n$s14 = \"AppPolicyGetShowDeveloperDiagnostic\" fullword ascii\n$s15 = \"noexcept\" fullword ascii\n$s16 = \"Read-Only Photo Acquire Plugin\" fullword wide\n$s17 = \"api-ms-win-appmodel-runtime-l1-1-2\" fullword wide\n$s18 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Photo\nAcquisition\\\\Plugins\\\\%ws\" fullword wide\n$s19 = \"[email protected]@\" fullword ascii\n$s20 = \"g0DVNrB\\\"Rtf#\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 2000KB and\n( pe.imphash() == \"0fd22f187f22ab4ec2eb55f91ccefa7a\" and (\npe.exports(\"SGeruIUrgVdfMaxMccIKRh\") and pe.exports(\"rundll\") ) or ( 1 of ($x*) and 4\nof them ) )\n}\nrule ryuk_1006_Report_Print {\nmeta:\ndescription = \"files - file Report_Print.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2020-10-13\"\nhash1 = \"23ac461f9b5128841cafabb4282432252ea7b57874595cf6fe8457fc1ac65007\"\nstrings:\n$s1 = \"kErNel32.Dll\" fullword wide\n$s2 = \"DOOKOL.exe\" fullword ascii\n$s3 = \"c:/crossdev/src/winpthreads-svn6233/src/mutex.c\" fullword ascii\n$s4 = \"hmutex\" fullword ascii\n$s5 = \"._FindPESectionExec\" fullword ascii\n$s6 = \"mutex_global_shmem\" fullword ascii\n$s7 = \"processthreadsapi.h\" fullword ascii\n$s8 = \"mutex_global_static_shmem\" fullword ascii\n$s9 = \"TargetIp\" fullword ascii\n$s10 = \"c:\\\\crossdev\\\\gccmaster\\\\build-tdm64\\\\gcc\\\\x86_64-w64-mingw32\\\\libgcc\"\nfullword ascii\n$s11 = \"h:\\\\crossdev\\\\gccmaster\\\\build-tdm64\\\\runtime\\\\mingw-w64-crt\" fullword ascii\n$s12 = \"J__mingw_winmain_lpCmdLine\" fullword ascii\n$s13 = \"GNU C 4.8.1 -mtune=generic -march=x86-64 -g -O2 -O2 -O2 -fbuilding-libgcc fno-stack-protector\" fullword ascii\n$s14 = \"GNU C 4.8.1 -mtune=generic -march=x86-64 -g -O2 -O2 -O2 -fbuilding-libgcc fno-stack-protector -fno-exceptions\" fullword ascii\n$s15 = \"GNU C 4.8.1 -m64 -mtune=generic -march=x86-64 -g -O2 -std=gnu99\" fullword\nascii\n\n```\n\n-----\n\n```\n$s16 GNU C 4.8.1 mtune generic march x86 64 g O2 O2 O2 fbuilding libgcc\nfno-stack-protector -fexceptions\" fullword ascii\n$s17 = \"9lpszCommandLine\" fullword ascii\n$s18 = \"=__mingw_GetSectionForAddress\" fullword ascii\n$s19 = \"__mingw_winmain_lpCmdLine\" fullword ascii\n$s20 = \"%Target\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 3000KB and\n( pe.imphash() == \"8f0088451a1156246379abc67514cacf\" and\npe.exports(\"CSBhvSWCvFRvfCfAoJdoFuAUmK\") or 8 of them )\n}\nrule ryuk_1006_files_xxx {\nmeta:\ndescription = \"files - file xxx.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2020-10-13\"\nhash1 = \"ccde47a0d315dcd4740fccfe8e8110fbb1fd85bb305734fec409f52051790c98\"\nstrings:\n$s1 = \"DOOKOL.exe\" fullword ascii\n$s2 = \"c:/crossdev/src/winpthreads-svn6233/src/mutex.c\" fullword ascii\n$s3 = \"hmutex\" fullword ascii\n$s4 = \"mutex_global_shmem\" fullword ascii\n$s5 = \"processthreadsapi.h\" fullword ascii\n$s6 = \"mutex_global_static_shmem\" fullword ascii\n$s7 = \"fake_get_output_format\" fullword ascii\n$s8 = \"&rvaTarget\" fullword ascii\n$s9 = \"h:\\\\crossdev\\\\gccmaster\\\\build-tdm64\\\\runtime\\\\mingw-w64-crt\" fullword ascii\n$s10 = \"c:\\\\crossdev\\\\gccmaster\\\\build-tdm64\\\\gcc\\\\x86_64-w64-mingw32\\\\32\\\\libgcc\"\nfullword ascii\n$s11 = \"E__mingw_winmain_lpCmdLine\" fullword ascii\n$s12 = \"GNU C 4.8.1 -m32 -mtune=generic -march=x86-64 -g -O2 -O2 -O2 -fbuildinglibgcc -fno-stack-protector\" fullword ascii\n$s13 = \"GNU C 4.8.1 -m32 -mtune=generic -march=x86-64 -g -O2 -O2 -O2 -fbuildinglibgcc -fno-stack-protector -fno-exceptions\" fullword ascii\n$s14 = \"GNU C 4.8.1 -m32 -mtune=generic -march=x86-64 -g -O2 -O2 -O2 -fbuildinglibgcc -fno-stack-protector -fexceptions\" fullword ascii\n$s15 = \"GNU C 4.8.1 -m32 -mtune=generic -march=x86-64 -g -O2 -std=gnu99\" fullword\nascii\n$s16 = \"__mingw_winmain_lpCmdLine\" fullword ascii\n$s17 = \"Npthread_getspecific\" fullword ascii\n$s18 = \"__gthread_getspecific\" fullword ascii\n$s19 = \"=__mingw_GetSectionForAddress\" fullword ascii\n$s20 = \"4lpszCommandLine\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 2000KB and\n( pe.imphash() == \"00f3261b5b33a9b1e8b6003f4056a885\" and\npe.exports(\"CSBhvSWCvFRvfCfAoJdoFuAUmK\") or 8 of them )\n}\nrule ryuk_1006_servisses {\nmeta:\ndescription = \"files - file servisses.exe\"\nauthor = \"The DFIR Report\"\n\n```\n\n-----\n\n```\nreference https://thedfirreport.com \ndate = \"2020-10-13\"\nhash1 = \"1d8b7faf5f290465cc742e07abca78fac419135b191071cc77912263cd1dde1d\"\nstrings:\n$s1 = \"DOOKOL.exe\" fullword ascii\n$s2 = \"c:/crossdev/src/winpthreads-svn6233/src/mutex.c\" fullword ascii\n$s3 = \"mutex_global_shmem\" fullword ascii\n$s4 = \"mutex_global_static_shmem\" fullword ascii\n$s5 = \"_pthread_key_dest_shmem\" fullword ascii\n$s6 = \"_pthread_key_max_shmem\" fullword ascii\n$s7 = \"_pthread_key_sch_shmem\" fullword ascii\n$s8 = \"_pthread_key_lock_shmem\" fullword ascii\n$s9 = \"cannot find name of executable\" fullword ascii\n$s10 = \"tiles32.png\" fullword ascii\n$s11 = \"GetModuleFileName: %s\" fullword ascii\n$s12 = \"IP_DEST_HOST_UNREACHABLE (11003)\" fullword ascii\n$s13 = \"This program requires Windows NT!\" fullword ascii\n$s14 = \"SNMP INVALID_SESSION\" fullword ascii\n$s15 = \"SNMP TRAP_ERRORS\" fullword ascii\n$s16 = \"SNMP SELECT_FDERRORS\" fullword ascii\n$s17 = \"Some different radices: %d %x %o %#x %#o \" fullword ascii\n$s18 = \"c:/crossdev/src/winpthreads-svn6233/src/rwlock.c\" fullword ascii\n$s19 = \"_pthread_tls_shmem\" fullword ascii\n$s20 = \"IP_DEST_PORT_UNREACHABLE (11005)\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 2000KB and\n( pe.imphash() == \"a90d500745a1ce2417c01fecefbc2851\" and\npe.exports(\"KADWEGAFSTWUATQFFFFkxcEEF\") or 8 of them )\n}\nrule ryuk_1006_files_SQL {\nmeta:\ndescription = \"files - file SQL.dll\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2020-10-13\"\nhash1 = \"d67461ba45a4edf3b2a69b3e64303fda8130bd1fc7a1173f35c1fe67b40c9639\"\nstrings:\n$s1 = \".data$_ZN12_GLOBAL__N_110fake_mutexE\" fullword ascii\n$s2 = \".data$_ZZN12_GLOBAL__N_116get_static_mutexEvE4once\" fullword ascii\n$s3 = \"DOOKOL.dll\" fullword ascii\n$s4 = \"_ZN12_GLOBAL__N_110fake_mutexE\" fullword ascii\n$s5 = \"_ZZN12_GLOBAL__N_116get_static_mutexEvE4once\" fullword ascii\n$s6 = \".data$_ZN12_GLOBAL__N_115emergency_mutexE\" fullword ascii\n$s7 = \".data$_ZN12_GLOBAL__N_1L12static_mutexE\" fullword ascii\n$s8 = \"__shmem_winpthreads_grabber_mutex_global_shmem\" fullword ascii\n$s9 = \"__shmem_winpthreads_init_mutex_global_shmem\" fullword ascii\n$s10 = \"__shmem_winpthreads_ptr_mutex_global_shmem\" fullword ascii\n$s11 = \"c:/crossdev/src/winpthreads-svn6233/src/mutex.c\" fullword ascii\n$s12 = \"pthread_mutex_lock_intern\" fullword ascii\n$s13 = \"__shmem_winpthreads_init_mutex_global_static_shmem\" fullword ascii\n$s14 = \"__shmem_winpthreads_grabber_mutex_global_static_shmem\" fullword ascii\n$s15 = \"__shmem_winpthreads_ptr_mutex_global_static_shmem\" fullword ascii\n$s16 = \"_Z7ExecutePv\" fullword ascii\n$s17 = \"hmutex\" fullword ascii\n\n```\n\n-----\n\n```\n$s18 ._FindPESectionExec fullword ascii\n$s19 = \"_ZN9__gnu_cxx17__recursive_mutex6unlockEv\" fullword ascii\n$s20 = \".text$_ZN9__gnu_cxx17__recursive_mutex6unlockEv\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 2000KB and\n( pe.imphash() == \"d16819dafefb97404d0d0e42adb82e5c\" and (\npe.exports(\"CSBhvSWCvFRvfCfAoJdoFuAUmK\") and pe.exports(\"StartW\") ) or 8 of them )\n}\n\n#### If you have detections you would like to add to this section, please contact us and we will credit you.\n\n## MITRE\n\n#### Spearphishing Link – T1192 \n\n Remote Desktop Protocol – T1076 \n\n Remote File Copy – T1105 \n\n Windows Management Instrumentation – T1047 \n\n Command-Line Interface – T1059 \n\n Domain Trust Discovery – T1482 \n\n Remote System Discovery – T1018 \n\n System Time Discovery – T1124 \n\n Data Encrypted for Impact – T1486 \n\n Commonly Used Port – T1043 \n\n Standard Application Layer Protocol – T1071 \n\n Standard Cryptographic Protocol – T1032 \n\n User Execution – T1204 \n\n Valid Accounts – T1078 \n\n Exploitation for Privilege Escalation – T1068 \n\n Signed Binary Proxy Execution – T1218 \n\n Rundll32 – T1085 \n\n Regsvr32 – T1117 \n\n```\n\n-----\n\n#### (internal case 1006)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-18 - Ryuk in 5 Hours.pdf"
    ],
    "report_names": [
        "2020-10-18 - Ryuk in 5 Hours.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536057,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653760958,
    "ts_modification_date": 1653760958,
    "files": {
        "pdf": "https://archive.orkl.eu/d6795dafd1600dda09daa415e3229d8c19f64a42.pdf",
        "text": "https://archive.orkl.eu/d6795dafd1600dda09daa415e3229d8c19f64a42.txt",
        "img": "https://archive.orkl.eu/d6795dafd1600dda09daa415e3229d8c19f64a42.jpg"
    }
}