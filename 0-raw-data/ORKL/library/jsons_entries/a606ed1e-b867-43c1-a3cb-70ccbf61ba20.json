{
    "id": "a606ed1e-b867-43c1-a3cb-70ccbf61ba20",
    "created_at": "2023-01-12T15:04:10.439361Z",
    "updated_at": "2025-03-27T02:16:26.343754Z",
    "deleted_at": null,
    "sha1_hash": "4f51ca7008a9052db406b0f332ceb2868d7004a7",
    "title": "2019-08-07 - MoqHao Related Android Spyware Targeting Japan and Korea Found on Google Play",
    "authors": "",
    "file_creation_date": "2022-05-28T17:12:17Z",
    "file_modification_date": "2022-05-28T17:12:17Z",
    "file_size": 2684082,
    "plain_text": "# MoqHao Related Android Spyware Targeting Japan and Korea Found on Google Play\n\n**securingtomorrow.mcafee.com/other-blogs/mcafee-labs/moqhao-related-android-spyware-targeting-japan-and-korea-**\nfound-on-google-play/\n\nAugust 7, 2019\n\n[Chanung Pak](https://www.mcafee.com/blogs/author/chanung-pak/)\nAug 07, 2019\n\n7 MIN READ\n\nThe McAfee mobile research team has found a new type of Android malware for the MoqHao\nphishing campaign (a.k.a. [XLoader and](https://blog.trendmicro.com/trendlabs-security-intelligence/xloader-android-spyware-and-banking-trojan-distributed-via-dns-spoofing/) [Roaming Mantis) targeting Korean and Japanese](https://securelist.com/roaming-mantis-part-iv/90332/)\nusers. A series of attack campaigns are still active, mainly targeting Japanese users. The\nnew spyware has very different payloads from the existing MoqHao samples. However, we\nfound evidence of a connection between the distribution method used for the existing\ncampaign and this new spyware. All the spyware we found this time pretends to be security\n\n\n-----\n\napplications targeting users in Japan and Korea. We discovered a phishing page related to\n[DNS Hijacking attack, designed to trick the user into installing the new spyware, distributed](https://www.networkworld.com/article/3389747/cisco-talos-details-exceptionally-dangerous-dns-hijacking-attack.html)\non the Google Play store.\n\n## Fake Japanese Security Apps Distributed on Google Play\n\nWe found two fake Japanese security applications. The package names are com.jshop.test\nand com.jptest.tools2019. These packages were distributed on the Google Play store. The\nnumber of downloads of these applications was very low. Fortunately, the spyware apps had\nbeen immediately removed from the Google Play store, so we acquired the malicious bullets\nthanks to the Google Android Security team.\n\n_Figure 1. Fake security applications distributed on Google Play_\n\nThis Japanese spyware has four command and control functions. Below is the server\ncommand list used with this spyware. The spyware attempts to collect device information like\nIMEI and phone number and steal SMS/MMS messages on the device. These malicious\ncommands are sent from a push service of Tencent Push Notification Service.\n\n_Figure 2. Command registration into mCommandReceiver_\n\n_Table 1. The command lists_\n\n\n-----\n\n*1 _Not implemented correctly due to the difference from the functionality guessed from the_\n\n_command name_\n\nWe believe that the cybercriminal included minimal spyware features to bypass Google’s\nsecurity checks to distribute the spyware on the Google Play store, perhaps with the\nintention of adding additional functionality in future updates, once approved.\n\n## Fake Korean Police Apps\n\nFollowing further investigation, we found other very similar samples to the above fake\nJapanese security applications, this time targeting Korean users. A fake Korean police\napplication disguised itself as an anti-spyware application. It was distributed with a filename\nof cyber.apk on a host server in Taiwan (that host has previously been associated with\nmalicious phishing domains impersonating famous Japanese companies). It used the official\nicon of the Korean police application and a package name containing ‘kpo’, along with\nreferences to com.kpo.scan and com.kpo.help, all of which relate to the Korean police.\n\n_Figure 3. This Korean police application icon was misappropriated_\n\nThe Trojanized package was obfuscated by the Tencent packer to hide its malicious spyware\npayload. Unlike the existing samples used in the MoqHao campaign, where the C&C server\naddress was simply embedded in the spyware application; MoqHao samples hide and\naccess the control server address via Twitter accounts.\n\n\n-----\n\nThe malware has very similar spyware functionality to the fake Japanese security\napplication. However, this one features many additional commands compared to the\nJapanese one. Interestingly, the Tencent Push Service is used to issue commands to the\ninfected user.\n\n_Figure 4. Tencent Push Service_\n\nThe code and table below show characteristics of the server command and content list.\n\n_Figure 5. Command registration into mCommandReceiver_\n\n_Table 2. The command lists_\n\n\n-----\n\n*1 _Seems to be under construction due to the difference from the functionality guessed from_\n\n_the command name_\n\nThere are several interesting functions implemented in this spyware. To execute an\nautomated phone call function on a default calling application, KAutoService class has an\nimplementation to check content in the active window and automatically click the start call\nbutton.\n\n_Figure 6. KAutoSevice class clicks start button automatically in the active calling application_\n\nAnother interesting function attempts to disable anti-spam call applications (e.g. whowho –\nCaller ID & Block), which warns users if it is suspicious in the case of incoming calls from an\nunknown number. The disable function of these call security applications in the spyware\nallows cyber criminals to make a call without arousing suspicion as no alert is issued from\nthe anti-spam call apps, thus increasing the success of social engineering.\n\n\n-----\n\n_Figure 7. Disable anti-spam-call applications_\n\n_Figure 8. Disable anti-spam-call applications_\n\n_Table 3. List of disabled anti-spam call applications_\n\n\n-----\n\n## Connection with Active MoqHao Campaigns\n\nThe malware characteristics and structures are very different from the existing MoqHao\n[samples. We give special thanks to @ZeroCERT and](https://twitter.com/ZeroCERT) [@ninoseki, without who we could not](https://twitter.com/ninoseki)\nhave identified the connection to the active MoqHao attack and DNS hijacking campaigns.\nThe server script on the phishing website hosting the fake Chrome application leads victims\nto a fake Japanese security application on the Google Play store\n[(https://play.google.com/store/apps/details?id=com.jptest.tools2019) under specific browser](https://play.google.com/store/apps/details?id=com.jptest.tools2019)\nconditions.\n\n_Figure 9. The server script redirects users to a fake security application on Google Play_\n_(Source:_ _[@ninoseki)](https://twitter.com/ninoseki/status/1118886018990497795)_\n\n\n-----\n\nThere is a strong correlation between both the fake Japanese and Korean applications we\nfound this time. This malware has common spy commands and shares the same crash\nreport key on a cloud service. Therefore, we concluded that both pieces of spyware are\nconnected to the ongoing MoqHao campaigns.\n\n## Conclusion\n\nWe believe that the spyware aims to masquerade as a security application and perform spy\nactivities, such as tracking device location and eavesdropping on call conversations. It is\ndistributed via an official application store that many users trust. The attack campaign is still\nongoing, and it now features a new Android spyware that has been created by the\ncybercriminals. McAfee is working with Japanese law enforcement agencies to help with the\ntakedown of the attack campaign. To protect your privacy and keep your data from cyberattacks, please do not install apps from outside of official application stores. Keep firmware\nup to date on your device and make sure to protect it from malicious apps by installing\nsecurity software on it.\n\nMcAfee Mobile Security detects this threat as Android/SpyAgent and alerts mobile users if it\nis present, while protecting them from any data loss. For more information about McAfee\nMobile Security, visit [https://www.mcafeemobilesecurity.com](https://www.mcafeemobilesecurity.com/)\n\n## Appendix – IOCs\n\n_Table 4. Fake Japanese security application IOCs_\n\n_Table 5. Fake Korean police application IOCs_\n\n\n-----\n\n[Chanung Pak](https://www.mcafee.com/blogs/author/chanung-pak/)\nChanung is a Security Researcher on McAfee's Mobile Research Team. Previously focused\non finding new vulnerabilities in both software and hardware. He specializes in mobile threats\nand malware, and focuses...\n\n## More from McAfee Labs\n\n[Crypto Scammers Exploit: Elon Musk Speaks on Cryptocurrency](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/crypto-scammers-exploit-talk-on-cryptocurrency/%20)\n\nBy Oliver Devane Update: In the past 24 hours (from time of publication) McAfee has\nidentified 15...\n\nMay 05, 2022 |  4 MIN READ\n\n[Instagram Credentials Stealer: Disguised as Mod App](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/instagram-credentials-stealer-disguised-as-mod-app/%20)\n\nAuthored by Dexter Shin McAfee’s Mobile Research Team introduced a new Android\nmalware targeting Instagram users who...\n\nMay 03, 2022 |  4 MIN READ\n\n[Instagram Credentials Stealers: Free Followers or Free Likes](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/instagram-credentials-stealers-free-followers-or-free-likes/%20)\n\nAuthored by Dexter Shin Instagram has become a platform with over a billion monthly active\nusers. Many...\n\nMay 03, 2022 |  6 MIN READ\n\n[Scammers are Exploiting Ukraine Donations](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/scammers-are-exploiting-ukraine-donations/%20)\n\nAuthored by Vallabh Chole and Oliver Devane Scammers are very quick at reacting to\ncurrent events, so...\n\nApr 01, 2022 |  7 MIN READ\n\n\n-----\n\n[Imposter Netflix Chrome Extension Dupes 100k Users](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/imposter-netflix-chrome-extension-dupes-100k-users/%20)\n\nAuthored by Oliver Devane, Vallabh Chole, and Aayush Tyagi McAfee has recently\nobserved several malicious Chrome Extensions...\n\nMar 10, 2022 |  8 MIN READ\n\n[Why Am I Getting All These Notifications on my Phone?](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/why-am-i-getting-all-these-notifications-on-my-phone/%20)\n\nAuthored by Oliver Devane and Vallabh Chole  Notifications on Chrome and Edge, both\ndesktop browsers, are commonplace,...\n\nFeb 25, 2022 |  5 MIN READ\n\n[Emotet’s Uncommon Approach of Masking IP Addresses](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/emotets-uncommon-approach-of-masking-ip-addresses/%20)\n\nIn a recent campaign of Emotet, McAfee Researchers observed a change in techniques. The\nEmotet maldoc was...\n\nFeb 04, 2022 |  4 MIN READ\n\n\n-----\n\n[HANCITOR DOC drops via CLIPBOARD](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/hancitor-doc-drops-via-clipboard/%20)\n\nHancitor, a loader that provides Malware as a Service, has been observed distributing\nmalware such as FickerStealer,...\n\nDec 13, 2021 |  6 MIN READ\n\n[‘Tis the Season for Scams](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/tis-the-season-for-scams/%20)\n\n‘Tis the Season for Scams\n\nNov 29, 2021 |  18 MIN READ\n\n[The Newest Malicious Actor: “Squirrelwaffle” Malicious Doc.](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/the-newest-malicious-actor-squirrelwaffle-malicious-doc/%20)\n\nAuthored By Kiran Raj Due to their widespread use, Office Documents are commonly used\nby Malicious actors...\n\nNov 10, 2021 |  4 MIN READ\n\n\n-----\n\n[Social Network Account Stealers Hidden in Android Gaming Hacking Tool](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/social-networks-account-stealer-hidden-in-android-gaming-hacking-tool/%20)\n\nAuthored by: Wenfeng Yu McAfee Mobile Research team recently discovered a new piece of\nmalware that specifically...\n\nOct 19, 2021 |  6 MIN READ\n\n[Malicious PowerPoint Documents on the Rise](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/malicious-powerpoint-documents-on-the-rise/%20)\n\nAuthored by Anuradha M McAfee Labs have observed a new phishing campaign that utilizes\nmacro capabilities available...\n\nSep 21, 2021 |  6 MIN READ\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-08-07 - MoqHao Related Android Spyware Targeting Japan and Korea Found on Google Play.pdf"
    ],
    "report_names": [
        "2019-08-07 - MoqHao Related Android Spyware Targeting Japan and Korea Found on Google Play.pdf"
    ],
    "threat_actors": [
        {
            "id": "f9bc28d0-ce98-4991-84ae-5036e5f9d4e3",
            "created_at": "2022-10-25T16:07:24.546437Z",
            "updated_at": "2025-03-27T02:02:10.277573Z",
            "deleted_at": null,
            "main_name": "Roaming Mantis",
            "aliases": [
                "Roaming Mantis Group",
                "Shaoye"
            ],
            "source_name": "ETDA:Roaming Mantis",
            "tools": [
                "MoqHao",
                "Roaming Mantis",
                "SmsSpy",
                "Wroba",
                "XLoader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c94cb0e9-6fa9-47e9-a286-c9c9c9b23f4a",
            "created_at": "2023-01-06T13:46:38.823793Z",
            "updated_at": "2025-03-27T02:00:02.928254Z",
            "deleted_at": null,
            "main_name": "Roaming Mantis",
            "aliases": [
                "Roaming Mantis Group"
            ],
            "source_name": "MISPGALAXY:Roaming Mantis",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535850,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653757937,
    "ts_modification_date": 1653757937,
    "files": {
        "pdf": "https://archive.orkl.eu/4f51ca7008a9052db406b0f332ceb2868d7004a7.pdf",
        "text": "https://archive.orkl.eu/4f51ca7008a9052db406b0f332ceb2868d7004a7.txt",
        "img": "https://archive.orkl.eu/4f51ca7008a9052db406b0f332ceb2868d7004a7.jpg"
    }
}