{
    "id": "e94e2815-3b73-4a2a-8159-8a9bf84ef074",
    "created_at": "2023-01-12T15:03:05.718751Z",
    "updated_at": "2025-03-27T02:05:33.857475Z",
    "deleted_at": null,
    "sha1_hash": "169ae074c0de04e2aff4da26af5baed96438d686",
    "title": "2011-01-20 - Beschreibung des Virus Backdoor.Win32. Buterat.afj",
    "authors": "",
    "file_creation_date": "2022-05-27T19:09:40Z",
    "file_modification_date": "2022-05-27T19:09:40Z",
    "file_size": 86095,
    "plain_text": "# Описание работы вируса Backdoor.Win32. Buterat.afj\n\n**[antivirnews.blogspot.com/2011/01/backdoorwin32-buteratafj.html](http://antivirnews.blogspot.com/2011/01/backdoorwin32-buteratafj.html)**\n\nВредоносная программа, предоставляющая злоумышленнику удаленный доступ к\nзараженной машине. Является приложением Windows (PE-EXE файл). Имеет размер\n89088 байт. Упакована неизвестным упаковщиком. Распакованный размер – около 181\nКБ. Написана на C++.\n\n### Инсталляция\n\nПосле запуска бэкдор копирует свое тело в файл:\n```\n%APPDATA%\\netprotocol.exe\n\n```\nПри этом для противодействия сигнатурным анализаторам антивирусных программ, в\nкопии модифицируются 2 байта:\nПодвергнутая подобной модификации копия детектируется Антивирусом Касперского\nкак \"Trojan-PSW.Win32.Qbot.aem\". Для автоматического запуска созданной копии при\nкаждом следующем старте системы создается ключ системного реестра:\n```\n[HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]\n\"Netprotocol\" = \"%APPDATA%\\netprotocol.exe\"\n\n```\nЕсли данный ключ создать не удается, бэкдор создает ключ:\n```\n[HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]\n\"Netprotocol\" = \"%APPDATA%\\netprotocol.exe\"\n\n```\nПосле этого бэкдор запускает созданную копию на выполнение.\n\n## Деструктивная активность\n\nБэкдор способен копировать свое тело в файл:\n```\n%WorkDir%\\netprotocol.dll\n\n```\nи, используя экспортируемую функцию \"_ClearEvent@12\", внедрять в адресное\nпространство процессов браузеров:\n```\nfirefox.exe\niexplore.exe\nopera.exe\n\n```\nисполняемый код, перехватывающий вызовы API-функций:\n\n\n-----\n\n```\nWSARecv\nrecv\nsend\n\n```\nбиблиотеки \"ws2_32.dll\". Таким образом, бэкдор получает возможность следить за\nвходящим и исходящим трафиком браузеров, и по команде злоумышленника собирать\nинформацию о поисковых запросах пользователя на сайты:\n```\nhttp://rupoisk.ru\nhttp://ru.search.yahoo.com\nhttp://www.bing.com\nhttp://nigma.ru\nhttp://search.qip.ru\nhttp://nova.rambler.ru\nhttp://www.google.ru\nhttp://yandex.ru\n\n```\nа также перенаправлять пользователя на следующие ресурсы:\n```\nhttp://aut***gun.ru    \nhttp://sear***tnik1.ru    \nhttp://autoc***gun.ru\nhttp://ppc***gun.ru\n\n```\nТакже по команде злоумышленника бэкдор может обновлять свой исполняемый файл,\nзагружая обновление с сервера злоумышленника. Кроме того, может загружаться\nфайл, сохраняемый в рабочем каталоге бэкдора как:\n```\n%WorkDir%\\netprotdrvss\n\n```\nПосле успешной загрузки файл запускается на выполнение. Запросы к серверу\nзлоумышленника, к примеру, могут иметь следующий вид:\n\nуспешная установка бэкдора в системе:\n```\n   /nconfirm.php?rev=294&code=3 m=2&num=\n   40401870851072\n\n```\nзапрос на получение команды:\n```\n   /njob.php?num=&rev=294\n\n```\nзапрос на загрузку файла \"netprotdrvss\":\n```\n   /nconfirm.php?rev=294&code=7 m=0&num\n   =40401870851072\n\n```\nЧисло \"\" генерируется на основе текущего системного времени. Подстрока \"\" – имя\nсервера злоумышленника, может принимать значения:\n\n\n-----\n\n```\nhttp://sjd sla.com\nhttp://sa***d.com\nhttp://se***nd.com\nhttp://ha***rd.net\nhttp://he***cy.com\n\n```\nНа момент создания описания подключиться к указанным серверам не удалось. Имена\nкоманд, обрабатываемых бэкдором:\n```\nZORKASITE\nZORKAFEED\nBODYCLICK\nKEYWORDS\nRUPFEED\nRUPPUBL\nXMLFEED\nREKLOSOFT\nTEASERNET\nMARKETGID\nSUPERPOISK\nRSCONTEXT\nSPUTNIK\nDIRECTST\nGOOGADS\nHOTLOGCH\nLIVINETCH\nBEGUNCH\nUPDATE\nSPLICEPROC\nCOOKREJCT\nZORKAFST\nSEPARATEPROC\nTERMINATE\nDESTROY\n\n```\nТакже после запуска бэкдор выполняет следующие действия:\n\nбудучи запущенным с параметрами:\n```\n   /updatefile3\n   /updatefile2\n   /updatefile1\n\n```\nбэкдор обновляет свой исполняемый файл, загружая обновление с сервера\nзлоумышленника.\nВызывая функцию \"InternetClearAllPerSiteCookieDecisions\", очищает содержимое\nветви системного реестра:\n```\n   [HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\\n   P3P\\History]\n\n```\n\n-----\n\nСоздает ключи системного реестра:\n```\n[HKLM\\Software\\Microsoft\\Netprotocol]\n\"UniqueNum\" = \"\"\n[HKCU\\AppEvents\\Schemes\\Apps\\Explorer\\Navigating\\.Current]\n\"(Default)\" = \"\"\n[HKCR\\MIME\\Database\\Content Type\\application/x-javascript]\n\"CLSID\" = \"{25336920-03F9-11cf-8FD0-00AA00686F13}\"\n[HKCR\\MIME\\Database\\Content Type\\text/javascript]\n\"CLSID\" = \"{25336920-03F9-11cf-8FD0-00AA00686F13}\"\n\n```\n\n-----",
    "language": "RU",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2011/2011-01-20 - Beschreibung des Virus Backdoor.Win32. Buterat.afj.pdf"
    ],
    "report_names": [
        "2011-01-20 - Beschreibung des Virus Backdoor.Win32. Buterat.afj.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535785,
    "ts_updated_at": 1743041133,
    "ts_creation_date": 1653678580,
    "ts_modification_date": 1653678580,
    "files": {
        "pdf": "https://archive.orkl.eu/169ae074c0de04e2aff4da26af5baed96438d686.pdf",
        "text": "https://archive.orkl.eu/169ae074c0de04e2aff4da26af5baed96438d686.txt",
        "img": "https://archive.orkl.eu/169ae074c0de04e2aff4da26af5baed96438d686.jpg"
    }
}