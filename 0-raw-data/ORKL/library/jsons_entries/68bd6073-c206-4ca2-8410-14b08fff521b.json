{
    "id": "68bd6073-c206-4ca2-8410-14b08fff521b",
    "created_at": "2023-01-12T15:06:25.383175Z",
    "updated_at": "2025-03-27T02:16:59.191523Z",
    "deleted_at": null,
    "sha1_hash": "4c8f628893a26870306ea73527d4df8a72bdf542",
    "title": "2021-06-04 - Glupteba back on track spreading via EternalBlue exploits",
    "authors": "",
    "file_creation_date": "2022-05-28T00:46:52Z",
    "file_modification_date": "2022-05-28T00:46:52Z",
    "file_size": 862782,
    "plain_text": "# Glupteba back on track spreading via EternalBlue exploits\n\n**labs.k7computing.com/**\n\nBy admin June 4, 2021\n\nGlupteba malware was first seen in the year 2014 and was active till 2020 when it faded\noff. But recently we at K7 Labs noticed a spike in the Glupteba malware in our K7\nEnterprise Security telemetry.\n\nOn analyzing the telemetry, we came across a huge number of hits for a handful of specific\nsystems, and on pivoting further, we realised that each of those systems were hit by tools\nhanded down from the Equation Group and Shadow Brokers, namely EternalBlue and\nDoublePulsar. Along with these, many of those systems had the Ranumbot malware as\nwell. The collective presence of all of these malware families led us on to the trail of their\nnext of kin, Glupteba.\n\nChecking the timestamp on which the malware occurrences are found in the telemetry, we\nnoticed that they were found at regular intervals and, therefore, must have tallied with\nsome scheduled spread from the infected system. We inferred that there must be at least\none unprotected, probably unpatched, system that must have been infected and it was\nbombarding other protected systems on the network, a common scenario in many\nEnterprise networks.\n\n\n-----\n\nThe Firewall telemetry events for these systems were checked along with the\ncorresponding IDS rules, viz. MS17-010 TRANS2 SECONDARY REQUEST and MS17010 Echo Response. They were all found to be attempts to exploit SMB vulnerabilities. We\nwere able to confirm that the local and remote IPs were internal, and that clearly indicates\nthat there was attempted lateral movement within the LAN.\n\nBasically Glupteba malware are Remote Access (Backdoor) Trojans, capable of spreading\nusing EternalBlue exploits. The malware, once it has breached a system, looks for SMB\nvulnerabilities and tries to exploit them to move laterally within the LAN.\n\nTaking a look at one of the recent Glupteba malware samples, we realise it still prefers the\nGo language. As a first step of its execution it copies itself to another location and creates\npersistence by changing the autorun values in the registry. The self-copied malware is\nplaced in: C:\\Windows\\rss\\csrss.exe\n\nCsrss.exe drops a file named windefender.exe which is the Ranumbot malware, another\nbackdoor capable of establishing remote connections and exfiltrating system information.\n\nFigure 1: Dropped\n\nfile location\nThis Glupteba malware attempts to evade detection on Windows Defender by modifying\nthe registry at HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\n_Defender\\Exclusions\\Paths to add exclusions to the paths wherever it is located, and uses_\nthe command line utility to bypass the default firewall.\n\nThe registry HKCU\\Software\\Classes\\mscfile\\shell\\open\\command with default key value\nis created by the malwarein order to abuse CompMgmtLauncher.exe and bypass UAC\n(User Account Control). Consequently, an unchallenged execution or download of further\npayload is enabled.\n\nFigure 2: Abuses\n\nCompMgmtLauncher.exe to bypass UAC\nThe malware collects details about the system and stores the configuration information in\nthe registry key HKCU\\Software\\ Microsoft\\a31263b0. Some of the system information that\nwill be POSTed to the C2 include build_number, firmware_type, mac, machine_guid,\nsecure_boot, etc, along with the list of softwares installed in the machine. The\nconsumption of this registry key along with a previously predominant name “TestApp”, has\nbeen seen quite a lot amongst Glupteba malware, and can definitely be considered as an\nIndicator of Compromise (IoC). The purpose of storing the data this way is that it can be\nused by the malware in later stages of the infection chain.\n\n\n-----\n\nFigure 3: Stores\n\nconfiguration information in HKCU\\Software\\Microsoft\\a31263b0\nThe malware uses the registry key TSAppCompat to check if the system is running in\napplication compatibility mode and the registry key TSUserEnabled, to check if the users\ncan log on to the terminal server\n\nFigure 4: Remote connection query\nIt then defines a default access permission list for the computer using the\n_DefaultAccessPermission and EveryoneIncludesAnonymous registries to allow anyone to_\nlogin without a password.\n\n\n-----\n\nFigure 5: Permission for anonymous user to login\nA malicious network connection is made to 172.67.137.101 and to\n“hxxps://sndvoices.com”, “hxxps://2makestorage.com”, “hxxps://stiambat.com”,\n“hxxps://spolaect.info”. All of these connections attempted are malicious sites to which the\nexfiltrated data can be sent.\n\nFigure 6: Malicious\n\nconnection\nTrying to connect to\n_hxxps://blinkroast.info/c544b71e73e7595b36b20b7fcb8b4204/watchdog.exe failed. The_\nURL not being active anymore, we were not able to grab the file for further analysis.\n\nGlupteba’s infection vectors in the past have included downloading pirated software, fake\ninstallers or adware. Once the malware has entered the system it looks for a specific list of\nvulnerabilities and uses them for lateral movement to enter into other systems connected\nin the network. In our case it is very evident that this Glupteba malware attempts to exploit\nSMB vulnerabilities to move laterally within the LAN.\n\nHere at K7, proactively monitoring our K7 Ecosystem Threat Intelligence, we were able to\nsee that Glupteba is back on active mode. Installing a reputed product like K7 Endpoint\n**Security will keep you protected from all kinds of threats.**\n\n**Indicators Of Compromise(IOCs)**\n\n**MD5** **K7 Detection Name**\n\n1a7e7794c44762d411d383fac32d45f2 Trojan ( 0057c9a81 )\n\n6512ae7c9f36206f6433f78296102419 Trojan ( 0055a98e1 )\n\n**MITRE ATT&CK**\n\n\n-----\n\nExecution Scheduled Task (T1053)\n\nService Execution (T1035)\n\nCommand-Line Interface (T1059)\n\nPersistence Registry Run Key / Startup Folder\n(T1060)\n\nHidden Files and Directories (T1158)\n\nNew Service (T1050)\n\nPrivilege Escalation Bypass User Account Control (T1088)\n\nDefensive Evasion Bypass User Account Control (T1088)\n\nDisabling Security Tools (T1089)\n\nFile and Hidden Files and Directories\n(T1158)\n\nFile Deletion (T1107)\n\nProcess Injection (T1055)\n\nModify Registry (T1112)\n\nDiscovery System Owner/User Discovery (T1033)\n\nSecurity Software Discovery (T1063)\n\nLateral Movement Exploitation of Remote Services (T1210)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-04 - Glupteba back on track spreading via EternalBlue exploits.pdf"
    ],
    "report_names": [
        "2021-06-04 - Glupteba back on track spreading via EternalBlue exploits.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4f7cf97-9c98-409c-8b95-b80d14c576a5",
            "created_at": "2022-10-25T16:07:24.561104Z",
            "updated_at": "2025-03-27T02:02:10.281202Z",
            "deleted_at": null,
            "main_name": "Shadow Brokers",
            "aliases": [],
            "source_name": "ETDA:Shadow Brokers",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "08623296-52be-4977-8622-50efda44e9cc",
            "created_at": "2023-01-06T13:46:38.549387Z",
            "updated_at": "2025-03-27T02:00:02.859535Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "Tilded Team",
                "EQGRP",
                "G0020"
            ],
            "source_name": "MISPGALAXY:Equation Group",
            "tools": [
                "EquationLaser",
                "EquationDrug",
                "DoubleFantasy",
                "TripleFantasy",
                "GrayFish"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "171b85f2-8f6f-46c0-92e0-c591f61ea167",
            "created_at": "2023-01-06T13:46:38.830188Z",
            "updated_at": "2025-03-27T02:00:02.929729Z",
            "deleted_at": null,
            "main_name": "The Shadow Brokers",
            "aliases": [
                "Shadow Brokers",
                "ShadowBrokers",
                "The ShadowBrokers",
                "TSB"
            ],
            "source_name": "MISPGALAXY:The Shadow Brokers",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2d9fbbd7-e4c3-40e5-b751-27af27c8610b",
            "created_at": "2024-05-01T02:03:08.144214Z",
            "updated_at": "2025-03-27T02:05:17.419705Z",
            "deleted_at": null,
            "main_name": "PLATINUM COLONY",
            "aliases": [
                "Equation Group "
            ],
            "source_name": "Secureworks:PLATINUM COLONY",
            "tools": [
                " EquationDrug",
                " EquationLaser",
                " Fanny",
                " GrayFish",
                " TripleFantasy",
                "DoubleFantasy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e0fed6e6-a593-4041-80ef-694261825937",
            "created_at": "2022-10-25T16:07:23.593572Z",
            "updated_at": "2025-03-27T02:02:09.879892Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "APT-C-40",
                "Platinum Colony",
                "Tilded Team"
            ],
            "source_name": "ETDA:Equation Group",
            "tools": [
                "Bvp47",
                "DEMENTIAWHEEL",
                "DOUBLEFANTASY",
                "DanderSpritz",
                "DarkPulsar",
                "DoubleFantasy",
                "DoubleFeature",
                "DoublePulsar",
                "Duqu",
                "EQUATIONDRUG",
                "EQUATIONLASER",
                "EQUESTRE",
                "Flamer",
                "GRAYFISH",
                "GROK",
                "OddJob",
                "Plexor",
                "Prax",
                "Regin",
                "Skywiper",
                "TRIPLEFANTASY",
                "Tilded",
                "UNITEDRAKE",
                "WarriorPride",
                "sKyWIper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535985,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653698812,
    "ts_modification_date": 1653698812,
    "files": {
        "pdf": "https://archive.orkl.eu/4c8f628893a26870306ea73527d4df8a72bdf542.pdf",
        "text": "https://archive.orkl.eu/4c8f628893a26870306ea73527d4df8a72bdf542.txt",
        "img": "https://archive.orkl.eu/4c8f628893a26870306ea73527d4df8a72bdf542.jpg"
    }
}