{
    "id": "eb8d654c-8fc7-4346-8ad1-596968d98b65",
    "created_at": "2024-04-16T02:06:31.868744Z",
    "updated_at": "2025-03-27T02:14:39.181868Z",
    "deleted_at": null,
    "sha1_hash": "9ec1b981b05591b6267daa9c680dba5714a8d1e3",
    "title": "Glupteba - Virus Bulletin",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 2083587,
    "plain_text": "## UNCOVERING A BROAD CRIMINAL ECOSYSTEM POWERED BY ONE OF THE LARGEST BOTNETS, GLUPTEBA\n\n###### Sept, 2022\n\n**LUCA NAGY**\n\n\n-----\n\n##### Luca Nagy\n\n###### Security Engineer @ Google\n\n Threat Analysis Group (TAG)\n\n CRIME\n\n\n-----\n\n# DISCLAIMER\n\n\n-----\n\n#### AGENDA\n\n\n**DISTRIBUTION**\n\n\n**CAPABILITIES & MODULES**\n\n\n-----\n\n#### AGENDA\n\n\n### ACTORS\n\n\n-----\n\n#### AGENDA\n\n\n-----\n\n#### AGENDA\n\n\n-----\n\n## GLUPTEBA\n\n\n-----\n\n#### DISTRIBUTION\n\n\n\n###### ● Since 2011\n ● PPI network/TDS\n ● 1M bot\n\n\n-----\n\n#### DROPPER CAPABILITIES\n\n\n\n###### ● Winmon\n\n ○ Process concealment (EPROCESS list)\n\n\n###### ROOTKIT\n\n\n\n###### ● WinmonFS\n\n ○ Hiding objects (FsFilter callback)\n\n\nKernel drivers to hide itself.\n\n\n\n###### ● WinmonProcessMonitor\n\n ○ Monitoring and terminating service processes\n\n (1224 process)\n\n\n-----\n\n#### DROPPER CAPABILITIES\n\n###### BACKDOOR\n\n\nControlling the machine by using backdoor\n\nfunctions.\n\n\n-----\n\n#### DROPPER CAPABILITIES\n\n###### BLOCKCHAIN\n\nFor updating C2 domains.\n\n\n\n- Hardcoded btc address\n\n - Hardcoded AES key\n\n\n-----\n\n#### DROPPER CAPABILITIES\n\n\n\n###### ● Github\n\n ○ Public json list of default electrum servers\n\n\n###### BLOCKCHAIN\n\nFor updating C2 domains.\n\n\n\n###### ● Hardcoded list\n\n ○ Electrum servers\n\n\n\n###### ● Blockchain.com\n\n ○ HTTP request for blockchain.com\n\n\n-----\n\n#### DROPPER CAPABILITIES\n\n\n###### GAIN PERSISTENCE\n\nAutorun registry key, scheduled tasks.\n\n###### SPREADING ON LAN\n\nEternalBlue.\n\n\n-----\n\n#### DROPPER CAPABILITIES\n\n###### ANTI-VM TECHNIQUES\n\nChecking VM environment.\n\n###### SUPPRESS SECURITY\n\n\nAdding Windows Defender exclusions,\n\nFirewall rules,\n\nDisabling PatchGuard, DSE.\n\n\n-----\n\n#### GLUPTEBA MODULES\n\n\n###### CHROME EXTENSION\n\n\n-----\n\n#### PROXY MODULE\n\n\n##### PROXIES\n\n\n\n###### ● TUNNELED PROXY\n\n <GUID>.server-<d>.domain, where the <d> is randomly selected then incremented. E.G.: 808f38e3-d84b-45c8-b461-2a4c006a0f4a.server-3.easywbdesign.com\n\n**Bot registration, then connect on port**\n\n**8000**\n\n**Sending request**\n\n**Response with a random port**\n\n**number**\n\n**Providing result**\n\n**Connect back on that port** **PROXIES**\n\n###### Request C2 server and establish connection Machine (tunnel)\n Victim machine\n\n\n**PROXIES**\n\n\n-----\n\n#### ANDROID - ADS MODULE\n\n\n###### 1. Glupteba APK requests: http://domainforwork.com/api/pollc with sent information 2. Received response\n\n [{\"command\":\"showDialog\",\"payload\":{\"arg\":\"{\\\"link\\\":true,\\\"advanced_webview\\\":true,\\\"can_close\\\":true,\\\"block_back\\\":false,\\\"click_url\\\":\\\"http://domainforwork.c om/ads/click?id=7132411\\\",\\\"content\\\":\\\"https://click.trafspin.com/ads/view-url?id=xxx&url=...\n\n**Requesting C2 server**\n\n**For what to display**\n\n**Response with a link for** **ANDROID**\n\n**the ad content URL** **GLUPTEBA**\n\n###### C2 server GLUPTEBA ON\n\n\n**ANDROID**\n**GLUPTEBA**\n\n\n-----\n\n#### BROWSER STEALER\n\n\n###### BROWSER\n STEALER\n\n\n**BROWSER**\n**STEALER**\n\n\n-----\n\n#### WHERE ARE THESE MONETISED?\n\n\n###### CHROME EXTENSION\n\n\n-----\n\n## ACTORS\n\n\n-----\n\n#### CODE EVIDENCES\n\n###### GLUPTEBA BINARIES GIT URIS\n\n**Proxy module** **git.voltronwork.com**\n\n\n-----\n\n## SERVICES\n\n\n-----\n\n#### LEGAL ENTITY BASED EVIDENCES\n\n\n###### ACTORS\n\n\n-----\n\n#### LEGAL ENTITY BASED EVIDENCES\n\n\n-----\n\n#### WHAT ARE THESE SERVICES?\n\n\n###### AWMPROXY\n\nResidential proxy provider\n\n\n###### TRAFSPIN\n\nAdvertising network\n\n\n###### DONT.FARM\n\nAds account service\n\n\n-----\n\n#### ARE THESE ASSOCIATED WITH THE MODULES?\n\n\n###### AWMPROXY\n\nResidential proxy provider\n\n\n###### TRAFSPIN\n\nAdvertising network\n\n\n###### DONT.FARM\n\nAds account service\n\n###### CHROME FINGERPRINT GLUPTEBA\n\n\n###### BROWSER\n STEALER\n\n CHROME FINGERPRINT\n\n\n-----\n\n#### AWMPROXY\n\n###### AWMPROXY\n\nResidential proxy provider\n\n\n-----\n\n###### PROXY SERVICE\n\n\n-----\n\n###### PROXY SERVICE\n\n\n**PROXIES**\n\n###### Victim machine\n\n\n-----\n\n###### PROXY SERVICE\n\n\n**PROXIES**\n\n###### Victim machine\n\n\n**PROXIES**\n\n\n-----\n\n#### TRAFSPIN\n\n###### TRAFSPIN\n\nAdvertising network\n\n\n-----\n\n###### RTB ADVERTISING NETWORK\n\n\n###### r\n\n\n-----\n\n###### RTB ADVERTISING NETWORK\n\n\n###### GLUPTEBA\n\n\n###### ANDROID\n\n**ANDROID**\n**GLUPTEBA** **GLUPTEBA**\n\n\n###### C2 server\n\n\n**ANDROID**\n**GLUPTEBA**\n\n\n-----\n\n###### RTB ADVERTISING NETWORK\n\n\n###### C2 server\n\n\n**ANDROID**\n**GLUPTEBA**\n\n\n-----\n\n#### DONT.FARM\n\n###### DONT.FARM\n\nAds account service\n\n\n-----\n\n###### ADS ACCOUNT SERVICE\n\n\n###### Access Set to\n\nChrome profile folder **Proxy**\n\n###### Customer gateway\n\n|Proxy server Set Chrome profile folder|to|\n|---|---|\n|||\n\n\n###### Virtual Machine of dont.farm\n\n\n-----\n\n###### ADS ACCOUNT SERVICE\n\n|Proxy server Set Chrome profile folder|to|\n|---|---|\n|||\n\n\n**BROWSER**\n**STEALER**\n\n\n**PROXIES**\n\n\n###### C2\n\n\n###### Victim machine\n\n\n-----\n\n## CRIMINAL ECOSYSTEM\n\n\n-----\n\n#### ECOSYSTEM\n\n\n**V lt**\n\n\n-----\n\n## CLOSING REMARKS\n\n\n-----\n\n#### AFTER DISRUPTION\n\n\n\n###### ● Overall botnet size decreased to less than its quarter (from 1M to 220K)\n ● Went away from Google products\n ● Partially disrupted services\n ● No new distribution until end of May\n ● Distribution of new samples by Integral PPI network since May -> Botnet size slightly increasing.\n\n ○ New BTC addresses\n ○ Simple XOR encoded C2 domains in blockchain\n ○ .onion C2 domains\n ○ Using Discord for downloading TOR\n ○ Using Opera VPN - opera-proxy client (recently started)\n\n\n-----\n\n#### LESSONS LEARNED\n\n\n\n###### ● Glupteba actors make mistakes\n ● Diverse botnet, diverse usage (services)\n ● Complex, organized ecosystem, end-to-end solution\n ● TAG continues to monitor\n\n\n-----\n\n# THANK YOU!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.virusbulletin.com/uploads/pdf/conference/vb2022/slides/VB2022-Uncovering-a-broad-criminal-ecosystem-Glupteba.pdf"
    ],
    "report_names": [
        "VB2022-Uncovering-a-broad-criminal-ecosystem-Glupteba.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1713233191,
    "ts_updated_at": 1743041679,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/9ec1b981b05591b6267daa9c680dba5714a8d1e3.pdf",
        "text": "https://archive.orkl.eu/9ec1b981b05591b6267daa9c680dba5714a8d1e3.txt",
        "img": "https://archive.orkl.eu/9ec1b981b05591b6267daa9c680dba5714a8d1e3.jpg"
    }
}