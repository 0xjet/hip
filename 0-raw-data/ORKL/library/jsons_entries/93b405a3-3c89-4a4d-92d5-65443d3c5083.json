{
    "id": "93b405a3-3c89-4a4d-92d5-65443d3c5083",
    "created_at": "2023-01-12T15:08:28.688114Z",
    "updated_at": "2025-03-27T02:08:41.031662Z",
    "deleted_at": null,
    "sha1_hash": "6b28d059dd3d8d7a3478f87cb070d1259cc92c8c",
    "title": "2019-02-27 - Protecting Against WinRAR Vulnerabilities",
    "authors": "",
    "file_creation_date": "2022-05-28T17:41:00Z",
    "file_modification_date": "2022-05-28T17:41:00Z",
    "file_size": 305294,
    "plain_text": "# Protecting Against WinRAR Vulnerabilities\n\n**[blog.checkpoint.com/2019/02/27/protecting-against-winrar-vulnerabilities/](https://blog.checkpoint.com/2019/02/27/protecting-against-winrar-vulnerabilities/)**\n\nFebruary 27, 2019\n\n[A 19 year old, yet major, vulnerability was recently found by Check Point Research in the](https://research.checkpoint.com/extracting-code-execution-from-winrar/)\n[popular web application, WinRAR, that could potentially put over 500 million users at risk.](https://www.win-rar.com/start.html?&L=0)\nThe exploit works by simply extracting an archive from an innocent looking ACE file which\ncould lead to a remote code execution.\n\nFollowing the discovery, it was not long at all before the Check Point Research team, as\nwell as a [researcher from NCC Group, spotted malware sample leveraging this vulnerability](https://twitter.com/buffaloverflow/status/1099628244406550529?s=19)\nin the wild. In this case, the malware is an ace archive containing a JS file that is, in turn,\nwritten to startup. It will download and run an executable when initiated. The downloaded\nexecutable is a .NET RAT called Orcus.\n\nFortunately, Check Point customers were already protected against this type of attack\nbefore the publication of this WinRAR vulnerability was made last week. By taking a closer\nlook at how Check Point SandBlast Agent works we can get a better understanding of both\nthe attack and protection against it.\n\n\n-----\n\n**Figure 1: Forensics Report from Sand Blast Agent (in detect only mode to showcase the**\nwhole attack) highlighting the script drop and execution upon reboot. (Click here for the full\nreport).\n\nThe attack begins by the user extracting an archive using WinRAR believing he is extracting\na rbxm file which is a 3D model for Roblox, a popular online gaming platform. In addition to\nthe 3D model, there is a hidden JS file with custom path to user’s startup folder as\nhighlighted below.\n\n\n-----\n\n**Figure 2: WinRAR archive containing JS file.**\n\n[Meanwhile, we can see from the Sand Blast Agent Forensics report that the JS payload file](https://forensics.checkpoint.com/wrarexp/tree.html)\nis actually extracted to the user’s start-up folder where it will then be launched once the\nuser reboots the machine or simply logs off and logs back on.\n\n**Figure 3: WinRAR process writing JS file to startup folder.**\n\n\n-----\n\n**Figure 4: Execution of JS file, download and launch of the Orcus RAT.**\n\nSandBlast Agent is able to catch such activity through the SandBlast Agent Behavioral\nGuard protection name Gen.Win.WrarExp.A.\n\nBy performing Advanced Behavioral Analysis along with threat extraction and sandboxing\ntechniques remotely on public or private cloud servers, SandBlast Agent is able to use a\nlow-overhead, non-intrusive approach to protect users against modern malware techniques.\n\nThe exploitation of vulnerabilities in such commonly used applications like WinRAR\nhighlights once again how easily users can be exposed to malware when downloading files.\nBy doing so, they can inadvertently put an enterprise’s entire IT network at risk of infection.\n\nWhen suspicious events do occur, it is essential that organizations have immediate access\nto the information required to fully understand and triage attacks to quickly identify source\nand scope, and to determine the best path of resolution.\n\n[Check Point SandBlast Agent is a progressive new solution that extends advanced threat](http://www.checkpoint.com/press/2016/server-room-airport-check-point-extends-zero-day-security-systems)\nprevention to endpoint devices to defend against zero-day and targeted threats. With the\ncapture and automatic analysis of complete forensics data, SandBlast Agent provides\nactionable attack insight and context to enable rapid remediation in the event of a breach.\n\n[For more information, please request a demo of Sand Blast Agent.](https://www.checkpoint.com/products/advanced-endpoint-threat-prevention/)\n\n\n-----\n\n**Check Point customers are protected IPS protections:**\nRARLAB WinRAR ACE Format Input Validation Remote Code Execution (CVE-201820250)\n\nIOCs:\nSample: 8b1ec801a22884efde29c9d596d42bccbe9e6a981f65aecc69819bf427387d3f\nhttps://www.virustotal.com/gui/file/8b1ec801a22884efde29c9d596d42bccbe9e6a981f65aec\nc69819bf427387d3f/detection\n\nDownloaded RAT:\n3a15f711370a667b41067f63ce181624451f542ca023825983446425d388fb70\nhttps://www.virustotal.com/gui/file/3a15f711370a667b41067f63ce181624451f542ca023825\n983446425d388fb70/detection\n\nC2 Server: [galrov.warzonedns.com](http://galrov.warzonedns.com/)\nPort: 1604\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-02-27 - Protecting Against WinRAR Vulnerabilities.pdf"
    ],
    "report_names": [
        "2019-02-27 - Protecting Against WinRAR Vulnerabilities.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536108,
    "ts_updated_at": 1743041321,
    "ts_creation_date": 1653759660,
    "ts_modification_date": 1653759660,
    "files": {
        "pdf": "https://archive.orkl.eu/6b28d059dd3d8d7a3478f87cb070d1259cc92c8c.pdf",
        "text": "https://archive.orkl.eu/6b28d059dd3d8d7a3478f87cb070d1259cc92c8c.txt",
        "img": "https://archive.orkl.eu/6b28d059dd3d8d7a3478f87cb070d1259cc92c8c.jpg"
    }
}