{
    "id": "6cfcb9b3-9cdc-4303-8075-26a1757720bb",
    "created_at": "2023-01-12T15:09:22.895382Z",
    "updated_at": "2025-03-27T02:12:11.085147Z",
    "deleted_at": null,
    "sha1_hash": "8effd6607d6ad79f7642c4dd137d92b6c75df766",
    "title": "2020-09-08 - Attackers Abusing Legitimate Cloud Monitoring Tools to Conduct Cyber Attacks",
    "authors": "",
    "file_creation_date": "2022-05-28T00:42:34Z",
    "file_modification_date": "2022-05-28T00:42:34Z",
    "file_size": 419358,
    "plain_text": "# Attackers Abusing Legitimate Cloud Monitoring Tools to Conduct Cyber Attacks\n\n**intezer.com/blog/cloud-workload-protection/attackers-abusing-legitimate-cloud-monitoring-tools-to-conduct-cyber-**\nattacks/\n\nSeptember 8, 2020\n\nWritten by Nicole Fishbein - 8 September 2020\n\n### Get Free Account\n\nJoin Now\n\n## Introduction\n\nTeamTNT is a cybercrime group that targets cloud environments including Docker and\n[Kubernetes instances. The group has been previously documented using several tools](https://www.cadosecurity.com/2020/08/17/teamtnt-the-first-crypto-mining-worm-to-steal-aws-credentials/)\nincluding crypto-miners and Amazon Web Services (AWS) credential stealing worms.\n\n\n-----\n\nTeamTNT has also been spotted using a malicious Docker image which can be found on\nDocker Hub to infect its victims’ servers. Now the group is evolving. In a recent attack\n[observed by Intezer, TeamTNT uses a new technique by abusing Weave Scope, a trusted](https://www.weave.works/oss/scope/)\ntool which gives the user full access to their cloud environment and is integrated with\nDocker, Kubernetes, the Distributed Cloud Operating System (DC/OS), and AWS Elastic\nCompute Cloud (ECS). The attackers install this tool in order to map the cloud environment\nof their victim and execute system commands without deploying malicious code on the\nserver.\n\n**To our knowledge, this is the first time attackers have been caught using legitimate**\n**third party software to target cloud infrastructure. When abused, Weave Scope gives**\nthe attacker full visibility and control over all assets in the victim’s cloud environment,\nessentially functioning as a backdoor.\n\nBelow we will describe the attack flow and the use of Weave Scope by the attacker.\n\n## Attack Flow\n\nTeamTNT’s attacks typically involve the use of malicious Docker images from the Docker\nHub in addition to crypto-miners and malicious scripts. The uniqueness of the recent attack\nobserved by Intezer is the group abuses a legitimate open source tool called Weave Scope\nto gain full control over the victim’s cloud infrastructure.\n\n[Weave Scope is an open source tool from Weave Works, a company that offers automation](https://www.weave.works/oss/scope/)\ntools for working with containerized applications. It provides monitoring, visualization, and\ncontrol over Docker and Kubernetes. Using a dashboard accessible from the browser the\nuser gains full control over the infrastructure including all information and metadata about\ncontainers, processes, and hosts.\n\nWeave Scope is a powerful utility, giving the attackers access to all information about the\nvictim’s server environment with the ability to control them including: installed applications,\nconnection between the cloud workloads, use of the memory and CPU, and a list of existing\ncontainers with the ability to start, stop, and open interactive shells in any of these\ncontainers. By installing a legitimate tool such as Weave Scope the attackers reap all the\nbenefits as if they had installed a backdoor on the server, with significantly less effort and\nwithout needing to use malware.\n\n\n-----\n\n_The image above is a Weave Scope visualization of a Linux server. On the left is the open_\n_terminal of a Nginx-based container. On the right is a view of all the containers on the_\n_server._\n\nTo install Weave Scope on the server the attackers use an exposed Docker API port and\ncreate a new privileged container with a clean Ubuntu image. The container is configured to\nmount the file system of the container to the filesystem of the victim server, thus gaining the\nattackers access to all files on the server. The initial command given to the container is to\ndownload and execute several cryptominers.\n\nThe attackers then attempt to gain root access to the server by setting up a local privileged\nuser named ‘hilde’ on the host server and use it in order to connect back via SSH.\n\nNext the attackers download and install Weave Scope. As described in the installation\n[guide in Weave Scope’s git, it takes only a few commands to complete installation of the](https://github.com/weaveworks/scope)\ntool.\n\nOnce installed, the attackers can connect to the Weave Scope dashboard via HTTP on port\n4040 and gain full visibility and control over the victim’s infrastructure.\n\nFrom the dashboard the attackers can see a visual map of the Docker runtime cloud\nenvironment and give shell commands without needing to deploy any malicious backdoor\ncomponent. Not only is this scenario incredibly rare, to our knowledge this is the first time\nan attacker has downloaded legitimate software to use as an admin tool on the Linux\noperating system\n\n\n-----\n\n## Mitigation Recommendations\n\nPrecise and correct configuration of cloud workloads and services can prevent many\nattacks which is why it’s important to take the time and effort to check them. To protect\nyourself from this attack we recommend to:\n\n**Close exposed Docker API ports: This attack takes advantage of a common**\nmisconfiguration of the Docker API which gives the attacker full control over the\nDocker service. Therefore, Docker API ports should be closed or contain restricted\naccess policies in the firewall.\n**Block incoming connections to port 4040: Weave Scope uses default port 4040 to**\nmake the dashboard accessible and anyone with access to the network can view the\ndashboard. Similar to the Docker API port, this port should be closed or restricted by\nthe firewall.\nBlock the IOCs provided below.\n[Check out our article Best Practice for Securing a Docker Runtime environment.](https://www.intezer.com/container-security/best-practices-for-securing-a-docker-runtime-environment/)\n[Take advantage of the free Intezer Protect community edition to protect your Linux](https://protect.intezer.com/signup)\ncloud servers and containers in runtime against unauthorized code.\n\n## Apply Zero Trust Execution to Your Workloads\n\nZero Trust Execution is viewed by market research firms as the best practice for securing\ncloud workloads for reasons like the nature of this TeamTNT attack. ZTE creates a trusted\nbaseline of your workloads and monitors for any new process or injected code. Any\nunauthorized code or applications that drift from the pre-approved baseline are blocked\nfrom running in your cloud environment, allowing you to retain a trusted state.\n\nIn this scenario, although Weave Scope is a legitimate administration tool (it’s not malware\nand therefore doesn’t contain malicious code), the application was still flagged by ZTE\nbecause it’s unauthorized code that deviates from the trusted baseline.\n\n[This article explains how you can adopt a genetic-based ZTE approach to alleviate some of](https://www.intezer.com/blog/cloud-workload-protection/what-is-zero-trust-execution-definition-adoption-more/)\nthe high overhead caused by traditional implementations.\n\nLearn more about Intezer’s support for [runtime Cloud Workload Protection.](https://www.intezer.com/blog/cloud-security/what-is-cloud-workload-protection/)\n\n## Update from Weave Works\n\n\n-----\n\n[Weave Works has since provided this in-depth article on how to prevent malicious attacks](https://www.weave.works/blog/preventing-malicious-use-of-weave-scope/)\nusing Weave Scope. The article covers both how Scope is used and how you can prevent it\nbeing misused by securing it in any Kubernetes installation.\n\n_A special thank you to Idan Katz for his contribution to this research._\n\n## IOCs\n\n85[.]214.149.236\n\nhttps://iplogger[.]org/2Xvkv5\n\n24d7d21c3675d66826da0372369ec3e8\n\n8c6681daba966addd295ad89bf5146af\n\n656eca480e2161e8645f9b29af7e4762\n\n8ffdba0c9708f153237aabb7d386d083\n\n45385f7519c11a58840931ee38fa3c7b\n\n**Nicole Fishbein**\nNicole is a malware analyst and reverse engineer. Prior to Intezer she was an embedded\nresearcher in the Israel Defense Forces (IDF) Intelligence Corps.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-08 - Attackers Abusing Legitimate Cloud Monitoring Tools to Conduct Cyber Attacks.pdf"
    ],
    "report_names": [
        "2020-09-08 - Attackers Abusing Legitimate Cloud Monitoring Tools to Conduct Cyber Attacks.pdf"
    ],
    "threat_actors": [
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536162,
    "ts_updated_at": 1743041531,
    "ts_creation_date": 1653698554,
    "ts_modification_date": 1653698554,
    "files": {
        "pdf": "https://archive.orkl.eu/8effd6607d6ad79f7642c4dd137d92b6c75df766.pdf",
        "text": "https://archive.orkl.eu/8effd6607d6ad79f7642c4dd137d92b6c75df766.txt",
        "img": "https://archive.orkl.eu/8effd6607d6ad79f7642c4dd137d92b6c75df766.jpg"
    }
}