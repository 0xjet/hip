{
    "id": "fb264733-0534-4eef-832d-2ff7c574e72b",
    "created_at": "2023-01-12T15:09:11.890639Z",
    "updated_at": "2025-03-27T02:05:42.049388Z",
    "deleted_at": null,
    "sha1_hash": "677b469ee5c39cb006186c6f82ac30866f49b31d",
    "title": "2021-04-01 - Cybereason vs. DarkSide Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T17:00:29Z",
    "file_modification_date": "2022-05-28T17:00:29Z",
    "file_size": 1457507,
    "plain_text": "# Cybereason vs. DarkSide Ransomware\n\n**cybereason.com/blog/cybereason-vs-darkside-ransomware**\n\nWritten By\nCybereason Nocturnus\n\nApril 1, 2021 | 6 minute read\n\n\n-----\n\nDarkSide is a relatively new ransomware strain that made its first appearance in August 2020. DarkSide\nfollows the RaaS (ransomware-as-a-service) model, and, according to Hack Forums, the DarkSide team\nrecently made an announcement that DarkSide 2.0 has been released. According to the group, it is equipped\nwith the [fastest encryption speed on the market, and even includes Windows and Linux versions.](https://www.israeldefense.co.il/en/node/48908)\n\nThe team is very active on hack forums and keeps its customers updated with news related to the\n[ransomware. In an effort to grow and expand their operations, the group has started an affiliates program for](https://twitter.com/3xp0rtblog/status/1369727242562134017)\npotential users.\n\n[Like many other ransomware variants, DarkSide follows the double extortion trend, which means the threat](https://www.cybereason.com/blog/ransomware-attacks-remain-persistent-and-pervasive)\nactors not only encrypt the user’s data, but first exfiltrate the data and threaten to make it public if the ransom\ndemand is not paid. This technique effectively renders the strategy of backing up data as a precaution\nagainst a ransomware attack moot.\n\nDarkSide is observed being used against targets in English-speaking countries, and appears to avoid targets\nin countries associated with former Soviet Bloc nations. The ransom demand ranges between US$200,000\nto $2,000,000, and according to their website, the group has published stolen data from more than 40\nvictims, which is estimated to be just a fraction of the overall number of victims:\n\n_DarkSide Leaks website_\n\nUnlike many ransomware variants such as Maze, which was employed to successfully attack suburban\nWashington schools, the group behind DarkSide appears to have a code of conduct that prohibits attacks\nagainst hospitals, hospices, schools, universities, non-profit organizations, and government agencies:\n\n\n-----\n\n_One of the rules of the affiliates program - prohibited sectors to attack_\n\n### Key details\n\n**• Emerging Threat: In a short amount of time, the DarkSide group has established a reputation for being a**\nvery “professional” and “organized” group that has potentially generated millions of dollars in profits from the\nransomware.\n\n**• High Severity: The Cybereason Nocturnus Team assesses the threat level as HIGH given the destructive**\npotential of the attacks.\n\n**• Human Operated Attack: Prior to the deployment of the ransomware, the attackers attempt to infiltrate and**\nmove laterally throughout the organization, carrying out a fully-developed attack operation.\n\n**• Aiming Towards the DC: The DarkSide group is targeting domain controllers (DCs), which puts targets**\nand the whole network environment at great risk.\n\n**• Detected and Prevented:** [The Cybereason Defense Platform fully detects and prevents the DarkSide](https://www.cybereason.com/platform)\nransomware.\n\n_Cybereason Blocks DarkSide Ransomware_\n\nThe DarkSide group is a relatively new player in the game of ransomware. Despite being a new group,\nthough, the DarkSide team has already built itself quite a reputation for making their operations more\nprofessional and organized. The group has a phone number and even a help desk to facilitate negotiations\nwith victims, and they are making a great effort at collecting information about their victims - not just technical\ninformation about their environment, but more general information about the company itself, like the\norganization’s size and estimated revenue.\n\nBy collecting information about the victims, the group is making sure the ransomware is only used against\nthe “right targets.” The group claims they only target large, profitable companies in their ransomware attacks,\nand claim to have extorted millions of dollars from companies in an effort to \"make the world a better place.\"\n[The group even wrote in a forum that \"some of the money the companies have paid will go to charity… No](https://www.bbc.com/news/technology-54591761)\n\n\n-----\n\nmatter how bad you think our work is, we are pleased to know that we helped change someone s life. Today\nwe sended (sic) the first donations.\"\n\n_[The attackers posted tax receipts for their donations](https://www.bbc.com/news/technology-54591761)_\n\nThe Darkside group has reportedly tried to donate around $20,000 in stolen bitcoin to different charities, but\nthe charities refused to accept the funds because of the source.\n\n## Breaking Down the Attack\n\n### Downloading the Ransomware\n\nAfter gaining an initial foothold in the network, the attackers start to collect information about the environment\nand the company. If it turns out that the potential target is on the attacker’s list of prohibited organizations to\nattack (ie: hospitals, hospices, schools, universities, non-profit organizations, or government agencies), they\n\n\n-----\n\ndon t move forward with the attack.\n\nIf not on the prohibited list, the attackers continue to carry out the operation:\n\n**• The attackers begins to collect files, credentials and other sensitive information, and exfilitrate it.**\n\n**• The attackers use PowerShell to download the DarkSide binary as “update.exe” using the “DownloadFile”**\n[command, abusing Certutil.exe and](https://lolbas-project.github.io/lolbas/Binaries/Certutil/) [Bitsadmin.exe in the process:](https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/)\n\n_Downloading the_\n\n_DarkSide ransomware binary using DownloadFile command_\n\n_Downloading the DarkSide ransomware binary using Certutil.exe_\n\nIn addition to downloading the DarkSide binary into the C:\\Windows and temporary directories, the attacker\nalso creates a shared folder on the infected machine and uses PowerShell to download a copy of the\nmalware there.\n\n### Conquering the Domain Controller\n\nAfter successfully gaining a foothold on one machine in the environment, the attacker begins to move\nlaterally in the environment, with the main goal of conquering the Domain Controller (DC).\n\nOnce the attackers make it to the DC, they start to collect other sensitive information and files, including\n[dumping the SAM hive that stores targets' passwords:](https://en.wikipedia.org/wiki/Security_Account_Manager)\n\n_Using reg.exe to steal_\n\n_credentials stored in the SAM hive on the DC_\n\nIn addition to collecting data from the DC, the attackers use PowerShell to download the DarkSide binary\nfrom the shared folder created on the previously infected host:\n\n\n-----\n\n_The PowerShell command executed_\n\n_on the DC_\n\nThe attackers also create a shared folder using the company’s name on the DC itself, and copies the\nDarkSide binary. Later in the attack, after all data has been exfiltrated, the attackers use bitsadmin.exe to\ndistribute the ransomware binary from the shared folder to other assets in the environment in order to\nmaximize the damage:\n\n_Downloading_\n\n_the DarkSide ransomware binary from a remote machine using shared folders_\n\nIn order to execute the ransomware on the DC, the attackers create a scheduled task called “Test1” that is\nconfigured to execute the ransomware:\n\n_Execution of the DarkSide ransomware via a scheduled task_\n\n\n-----\n\n_The scheduled task \\Test1, used to run the ransomware on_\n\n_the DC_\n\n### DarkSide Analysis\n\nWhen the DarkSide ransomware first executes on the infected host, it checks the language on the system,\nusing GetSystemDefaultUILanguage() and GetUserDefaultLangID() functions to avoid systems located in the\nformer Soviet Bloc countries from being encrypted:\n\n_Debugging the ransomware - checking if the installed language is Russian (419)_\n\n\n-----\n\nThe malware doesn t encrypt files on systems with the following languages installed:\n\nRussian - 419 Azerbaijani (Latin) - 42C Uzbek (Latin) - 443 Uzbek (Cyrillic) - 843\n\nUkranian - 422 Georgian - 437 Tatar - 444 Arabic (Syria) - 2801\n\nBelarusian - 423 Kazakh - 43F Romanian (Moldova) - 818\n\nTajik - 428 Kyrgyz (Cyrillic) - 440 Russian (Moldova) - 819\n\nArmenian - 42B Turkmen - 442 Azerbaijani (Cyrillic) - 82C\n\nDarkSide then proceeds to stop the following services related to security and backup solutions:\n\nvss sql svc memtas\n\nmepocs sophos veeam backup\n\n_Debugging the ransomware - stopping services, and creates connection to the hardcoded C2_\n\nIt then creates a connection to its C2 (command and control) server, and in different samples analyzed, the\nattackers use the following domains and IPs:\n\n\n-----\n\n198.54.117[.]200\n\n198.54.117[.]198\n\n198.54.117[.]199\n\n198.54.117[.]197\n\n\ntemisleyes[.]com\n\ncatsdegree[.]com\n\n\nAfter uninstalling the Volume Shadow Copy Service (VSS), DarkSide then deletes the shadow copies by\nlaunching an obfuscated PowerShell script that uses WMI to delete them:\n\n_Debugging the ransomware - creating a PowerShell process_\n\n_The PowerShell commands_\n\n_as shown in the Cybereason defence platform_\n\nThe de-obfuscated PowerShell script:\n\nGet-WmiObject Win32_Shadowcopy | ForEach-Object {$_.Delete();}\n\nThe malware then enumerates the running processes and terminates different processes to unlock their files\nso it can both steal related information stored in the files and encrypt them.\n\nDarkSide creates a unique User_ID string for the victim, and adds it to the encrypted files extension as\nfollows:\n<File_name>.{userid}. In addition, the malware also changes the icons for the encrypted files and changes\nthe background of the desktop:\n\n\n-----\n\n_Background set by DarkSide_\n\nAnd, of course, it leaves a ransom note: “README.{userid}.TXT”:\n\n_DarkSide ransom note_\n\n### Cybereason Detection and Prevention\n\nThe Cybereason Defense Platform is able to prevent the execution of the DarkSide Ransomware using multilayer protection that detects and blocks malware with threat intelligence, machine learning, and next-gen\nantivirus (NGAV) capabilities. Additionally, when the Anti-Ransomware feature is enabled, behavioral\ndetection techniques in the platform are able to detect and prevent any attempt to encrypt files and generates\na MalopTM for it:\n\n\n-----\n\n_Malop for DarkSide ransomware as shown in the Cybereason Defence Platform_\n\n_DarkSide ransomware as shown in the Cybereason Defence Platform_\n\n\n_Malop for_\n\n\nUsing the Anti-Malware feature with the right configurations (listed in the recommendations below), the\n[Cybereason Defense Platform will also detect and prevent the execution of the ransomware and ensure that](https://www.cybereason.com/platform)\nit cannot encrypt targeted files. The prevention is based on machine learning, which blocks both known and\nunknown malware variants:\n\n_Prevention alert of DarkSide ransomware as shown in the Cybereason Defence Platform_\n\n_Cybereason user notification for preventing the execution of DarkSide_\n\n### Security Recommendations\n\n**• Enable the Anti-Ransomware Feature on Cybereason NGAV: Set Cybereason Anti-Ransomware**\nprotection mode to Prevent - [more information for customers can be found here](https://nest.cybereason.com/documentation/product-documentation/190/anti-ransomware-settings#set-protection-mode)\n\n**• Enable Anti-Malware Feature on Cybereason NGAV: Set Cybereason Anti-Malware mode to Prevent and**\n[set the detection mode to Moderate and above - more information can be found here](https://nest.cybereason.com/documentation/product-documentation/190/anti-malware-settings)\n\n**• Keep Systems Fully Patched: Make sure your systems are patched in order to mitigate vulnerabilities**\n\n\n-----\n\n**• Regularly Backup Files to a Remote Server: Restoring your files from a backup is the fastest way to**\nregain access to your data\n\n**• Use Security Solutions: Protect your environment using organizational firewalls, proxies, web filtering, and**\nmail filtering\n\n### MITRE ATT&CK TECHNIQUES\n\n\n**Lateral**\n**Movement**\n\nTaint\n[Shared](https://attack.mitre.org/techniques/T1080/)\nContent\n\n\n**Execution** **Persistence** **Defense**\n**Evasion**\n\n\nCommand\nand\n[Scripting](https://attack.mitre.org/techniques/T1059/001/)\nInterpreter:\nPowerShell\n\n\n**Discovery** **Command**\n**and**\n**Control**\n\n\nScheduled\nTask/Job\n\n\nDeobfuscate /\n[Decode Files](https://attack.mitre.org/techniques/T1140/)\nor Information\n\n\n**Credential**\n**Access**\n\nCredentials\nfrom\nPassword\nStores\n\n\nAccount\nDiscovery\n\n\n**Impact**\n\nData\n[Encrypted](https://attack.mitre.org/techniques/T1486/)\nfor Impact\n\nService\nStop\n\n\n[Masquerading](https://attack.mitre.org/techniques/T1036) System\n[Information](https://attack.mitre.org/techniques/T1082/)\nDiscovery\n\nFile and\n[Directory](https://attack.mitre.org/techniques/T1083/)\nDiscovery\n\nProcess\nDiscovery\n\n\nCommonly\nUsed Port\n\nRemote\nFile Copy\n\nStandard\nApplication\nLayer\nProtocol\n\nIngress\nTool\nTransfer\n\n\n**Lior Rochberger**\n\nLior is a senior threat researcher at Cybereason, focusing on threat hunting and malware research. Lior\nbegan her career as a team leader in the security operations center in the Israeli Air Force, where she mostly\nfocused on incident response and malware analysis.\n\n## Darkside Ransomware | Indicators of Compromise\n\n\n-----\n\n**Indicator** **Type** **Comment**\n\n\n243dff06fc80a049f4fb37292f8b8def0fce29768f345c88ee10699e22b0ae60\n\n12ee27f56ec8a2a3eb2fe69179be3f7a7193ce2b92963ad33356ed299f7ed975\n\n9cee5522a7ca2bfca7cd3d9daba23e9a30deb6205f56c12045839075f7627297\n\n5860f2415aa9a30c045099e3071f099313f653ae1806d6bcdb5f47d5da96c6d7\n\n78782fd324bc98a57274bd3fff8f756217c011484ebf6b614060115a699ee134\n\ndc4b8dfff72ff08ec4daa8db4c096a350a9a1bf5434ba7796ab10ec1322ac38c\n\n8cfd28911878af048fb96b6cc0b9da770542576d5c2b20b193c3cfc4bde4d3bc\n\n4edb883d1ac97824ee42d9f92917cc84b52995abcd17b2852a7e3d5bb567ffbe\n\ne9417cb1baec2826e3f5a6f64ade26c1374d74d8aa41bfabd29ea20ea5894b14\n\nfb76b4a667c6d790c39fcc93a3aac8cd2a224f0eb9ece4ecfd7825f606c2a8b6\n\n4d9432e8a0ceb64c34b13d550251b8d9478ca784e50105dc0d729490fb861d1a\n\n508dd6f7ed6c143cf5e1ed6a4051dd8ee7b5bf4b7f55e0704d21ba785f2d5add\n\ncc54647e8c3fe7b701d78a6fa072c52641ac11d395a6d2ffaf05f38f53112556\n\n68872cc22fbdf0c2f69c32ac878ba9a7b7cf61fe5dd0e3da200131b8b23438e7\n\n1ef8db7e8bd3aaba8b1cef96cd52fde587871571b1719c5d40f9a9c98dd26f84\n\n43e61519be440115eeaa3738a0e4aa4bb3c8ac5f9bdfce1a896db17a374eb8aa\n\nec153c3cb67f742b12a35a498d93cd80f47b19ea7b7eb0de217139f136ea0073\n\n533672da9d276012ebab3ce9f4cd09a7f537f65c6e4b63d43f0c1697e2f5e48d\n\n1cc7c198a8a2c935fd6f07970479e544f5b35a8eb3173de0305ebdf76a0988cb\n\n151fbd6c299e734f7853497bd083abfa29f8c186a9db31dbe330ace2d35660d5\n\nac092962654b46a670b030026d07f5b8161cecd2abd6eece52b7892965aa521b\n\n06cfe7f5d88e82f7adda6d8333ca8b302debb22904c68a942188be5730e9b3c8\n\nafb22b1ff281c085b60052831ead0a0ed300fac0160f87851dacc67d4e158178\n17139a10fd226d01738fe9323918614aa913b2a50e1a516e95cced93fa151c61\n\n0839aabe5fd63b16844a27b3c586c02a044d119010a1a40ee4035501c34eae0d\n\nf42bcc81c05e8944649958f8b9296c5523d1eb8ab00842d66530702e476561ef\n\nadcb912694b1abcdf9c467b5d47abe7590b590777b88045d10992d34a27aa06e\n6228f75f52fd69488419c0e0eb3617b5b894a566a93e52b99a9addced7364cff\n\nbac2149254f5ce314bab830f574e16c9d67e81985329619841431034c31646e0\n\nf764c49daffdacafa94aaece1d5094e0fac794639758e673440329b02c0fda39\n\n691515a485b0b3989fb71c6807e640eeec1a0e30d90500db6414035d942f70a5\n\n6d656f110246990d10fe0b0132704b1323859d4003f2b1d5d03f665c710b8fd3\n\ne0c0cbc50a9ed4d01a176497c8dba913cbbba515ea701a67ef00dcb7c8a84368\n\n48a848bc9e0f126b41e5ca196707412c7c40087404c0c8ed70e5cee4a418203a\n\ntemisleyes[.]com\n\ncatsdegree[.]com\n\n198.54.117[.]200\n\n198.54.117[.]198\n\n198.54.117[.]199\n\n198.54.117[.]197\n\n185.117.119[.]87\n\n\nSHA256 DarkSide\nbinaries\n\nDomains C2\n\nIP C2\n\n\n-----\n\nAbout the Author\n\n**Cybereason Nocturnus**\n\nThe Cybereason Nocturnus Team has brought the world’s brightest minds from the military, government\nintelligence, and enterprise security to uncover emerging threats across the globe. They specialize in\nanalyzing new attack methodologies, reverse-engineering malware, and exposing unknown system\nvulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya\nand Bad Rabbit cyberattacks.\n\n[All Posts by Cybereason Nocturnus](https://www.cybereason.com/blog/authors/cybereason-nocturnus)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-01 - Cybereason vs. DarkSide Ransomware.pdf"
    ],
    "report_names": [
        "2021-04-01 - Cybereason vs. DarkSide Ransomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536151,
    "ts_updated_at": 1743041142,
    "ts_creation_date": 1653757229,
    "ts_modification_date": 1653757229,
    "files": {
        "pdf": "https://archive.orkl.eu/677b469ee5c39cb006186c6f82ac30866f49b31d.pdf",
        "text": "https://archive.orkl.eu/677b469ee5c39cb006186c6f82ac30866f49b31d.txt",
        "img": "https://archive.orkl.eu/677b469ee5c39cb006186c6f82ac30866f49b31d.jpg"
    }
}