{
    "id": "a0a60a61-d022-44df-aa94-b5441b62e74c",
    "created_at": "2023-01-12T15:03:33.792164Z",
    "updated_at": "2025-03-27T02:16:25.593921Z",
    "deleted_at": null,
    "sha1_hash": "c12bd78defe41a0e7764eeeb330229caeb1cf4dc",
    "title": "2020-05-22 - Insidious Android malware gives up all malicious features but one to gain stealth",
    "authors": "",
    "file_creation_date": "2022-05-28T23:30:39Z",
    "file_modification_date": "2022-05-28T23:30:39Z",
    "file_size": 647849,
    "plain_text": "# Insidious Android malware gives up all malicious features but one to gain stealth\n\n**[welivesecurity.com/2020/05/22/insidious-android-malware-gives-up-all-malicious-features-but-one-gain-stealth/](https://www.welivesecurity.com/2020/05/22/insidious-android-malware-gives-up-all-malicious-features-but-one-gain-stealth/)**\n\nMay 22, 2020\n\nESET researchers detect a new way of misusing Accessibility Service, the Achilles’ heel of Android\nsecurity\n\n[Lukas Stefanko](https://www.welivesecurity.com/author/lstefanko/)\n22 May 2020 - 03:00PM\n\nESET researchers detect a new way of misusing Accessibility Service, the Achilles’ heel of Android\nsecurity\n\nESET researchers have analyzed an extremely dangerous Android app that can perform a host of\nnefarious actions, notably wiping out the victim’s bank account or cryptocurrency wallet and taking over\ntheir email or social media accounts. Called “DEFENSOR ID”, the banking trojan was available on Google\n\n\n-----\n\nPlay at the time of the analysis. The app is fitted with standard information-stealing capabilities; however,\nthis banker is exceptionally insidious in that after installation it requires a single action from the victim –\nenable Android’s Accessibility Service – to fully unleash the app’s malicious functionality.\n\nThe DEFENSOR ID app made it onto the heavily guarded Google Play store thanks to its extreme stealth.\nIts creators reduced the app’s malicious surface to the bare minimum by removing all potentially malicious\nfunctionalities but one: abusing Accessibility Service.\n\nAccessibility Service is long known to be the Achilles’ heel of the Android operating system. Security\nsolutions can detect it in countless combinations with other suspicious permissions and functions, or\nmalicious functionalities – but when faced with no additional functionality nor permission, all failed to\ntrigger any alarm on DEFENSOR ID.\n\nBy “all” we mean all security mechanisms guarding the official Android app store (including the detection\nengines of the members of the App Defense Alliance) and all security vendors participating in the\nVirusTotal program (see Figure 1).\n\n\n-----\n\n_Figure 1. According to the VirusTotal service, no security vendor detected the DEFENSOR ID app until it was pulled_\n\n_off the Play store_\n\nDEFENSOR ID was released on Feb 3, 2020 and last updated to v1.4 on May 6, 2020. The latest version\nis analyzed here; we weren’t able to determine if the earlier versions were also malicious. According to its\nprofile at Google Play (see Figure 2) the app reached a mere 10+ downloads. We reported it to Google on\nMay 16, 2020 and since May 19, 2020 the app has no longer been available on Google Play.\n\nThe developer name used, GAS Brazil, suggests the criminals behind the app targeted Brazilian users.\nApart from including the country’s name, the app’s name is probably intended to imply a relationship with\nthe antifraud solution named GAS Tecnologia. That security software is commonly installed on computers\nin Brazil as several banks require it to log into their online banking. However, there is also an English\nversion of the DEFENSOR ID app (see Figure 3) besides the Portuguese one, and that app has neither\ngeographical nor language restrictions.\n\nPlaying further off the suggested GAS Tecnologia link, the app promises better security for its users. The\ndescription in Portuguese promises more protection for the user’s applications, including end-to-end\nencryption. Deceptively, the app was listed in the Education section.\n\n\n-----\n\n_Figure 2. The DEFENSOR ID app on Google Play – Portuguese version (translates roughly as: “Your new Defensor_\n\n_app available for: / Individuals / Legal entities / From now on you will have more protection when using your_\n\n_applications, encryption for end-to-end users”)_\n\n\n-----\n\n_Figure 3. The DEFENSOR ID app on Google Play – English version_\n\n## Functionality\n\nAfter starting, DEFENSOR ID requests the following permissions:\n\nallow modify system settings\npermit drawing over other apps, and\nactivate accessibility services.\n\nIf an unsuspecting user grants these permissions (see Figure 4), the trojan can read any text displayed in\nany app the user may launch – and send it to the attackers. This means the attackers can steal the\nvictim’s credentials for logging into apps, SMS and email messages, displayed cryptocurrency private\nkeys, and even software-generated 2FA codes.\n\nThe fact the trojan can steal both the victim’s credentials and also can control their SMS messages and\ngenerated 2FA codes means DEFENSOR ID’s operators can bypass two-factor authentication. This opens\nthe door to, for example, fully controlling the victim’s bank account.\n\nTo make sure the trojan survives a device restart, it abuses already activated accessibility services that will\nlaunch the trojan right after start.\n\n\n-----\n\n-----\n\n_Figure 4. The permission requests by DEFENSOR ID_\n\nOur analysis shows the DEFENSOR ID trojan can execute 17 commands received from the attackercontrolled server such as uninstalling an app, launching an app and then performing any click/tap action\ncontrolled remotely by the attacker (see Figure 5).\n\n\n-----\n\n_Figure 5. The list of commands DEFENSOR ID may get from its C&C server_\n\nIn 2018, we saw [similar behavior, but all the click actions were hardcoded and suited only for the app of](https://www.welivesecurity.com/2018/12/11/android-trojan-steals-money-paypal-accounts-2fa/)\nthe attacker’s choice. In this case, the attacker can get the list of all installed apps and then remotely\nlaunch the victim’s app of their choice to either steal credentials or perform malicious actions (e.g. send\nfunds via a wire transfer).\n\nWe believe that this is the reason the DEFENSOR ID trojan requests the user to allow “Modify system\n[settings”. Subsequently, the malware will change the screen off time-out to 10 minutes. This means that,](https://developer.android.com/reference/android/provider/Settings.System#SCREEN_OFF_TIMEOUT)\nunless victims lock their devices via the hardware button, the timer provides plenty of time for the malware\nto remotely perform malicious, in-app operations.\n\nIf the device gets locked, the malware can’t unlock it.\n\n## Malware data leak\n\nWhen we analyzed the sample, we realized that the malware operators left the remote database with\nsome of the victims’ data freely accessible, without any authentication. The database contained the last\nactivity performed on around 60 compromised devices. We found no other information stolen from the\nvictims to be accessible.\n\nThanks to this data leak, we were able to confirm that the malware really worked as designed: the attacker\nhad access to the victims’ entered credentials, displayed or written emails and messages, etc.\n\nOnce we reached the non-secured database, we were able to directly observe the app’s malicious\nbehavior. To illustrate the level of threat the DEFENSOR ID app posed, we performed three tests.\n\nFirst, we launched a banking app and entered the credentials there. The credentials were immediately\navailable in the leaky database – see Figure 6.\n\n\n-----\n\n_Figure 6. The banking app test: the credentials as entered (left) and as available in the database (right)_\n\nSecond, we wrote a test message in an email client. We saw the message uploaded to the attackers’\nserver within a second – see Figure 7.\n\n_Figure 7. The email message test: the message as written (left) and as available in the database (right)_\n\nThird, we documented the trojan retrieving the Google Authenticator 2FA code.\n\n_Figure 8. The software generated 2FA code as it appeared on the device’s display (left) and as available in the_\n\n_database (right)_\n\nAlong with the malicious DEFENSOR ID app, another malicious app named Defensor Digital was\ndiscovered. Both apps shared the same C&C server, but we couldn’t investigate the latter as it had already\nbeen removed from the Google Play store.\n\n## Indicators of Compromise (IoCs)\n\n\n**Package Name** **Hash**\n\n\n**ESET detection**\n**name**\n\n\n-----\n\n**Package Name** **Hash**\n\n\n**ESET detection**\n**name**\n\n\ncom.secure.protect.world F17AEBC741957AA21CFE7C7D7BAEC0900E863F61 Android/Spy.BanBra.A\n\ncom.brazil.android.free EA069A5C96DC1DB0715923EB68192FD325F3D3CE Android/Spy.BanBra.A\n\n## MITRE ATT&CK techniques\n\n**Tactic** **ID** **Name** **Description**\n\n\nInitial\nAccess\n\n\n[T1475](https://attack.mitre.org/techniques/T1475/) Deliver Malicious App via\nAuthorized App Store\n\n\nImpersonates security app on\nGoogle Play.\n\n\n[T1444](https://attack.mitre.org/techniques/T1444/) Masquerade as\nLegitimate Application\n\n\nImpersonates legitimate GAS\nTecnologia application.\n\n\nDiscovery [T1418](https://attack.mitre.org/techniques/T1418/) Application Discovery Sends list of installed apps on\ndevice.\n\nImpact [T1516](https://attack.mitre.org/techniques/T1516/) Input Injection Can enter text and perform\nclicks on behalf of user.\n\nCollection [T1417](https://attack.mitre.org/techniques/T1417/) Input Capture Records user input data.\n\n\nCommand\nand Control\n\n\n[T1437](https://attack.mitre.org/techniques/T1437/) Standard Application Layer\nProtocol\n\n\nUses Firebase Cloud\nMessaging for C&C.\n\n\n22 May 2020 - 03:00PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-22 - Insidious Android malware gives up all malicious features but one to gain stealth.pdf"
    ],
    "report_names": [
        "2020-05-22 - Insidious Android malware gives up all malicious features but one to gain stealth.pdf"
    ],
    "threat_actors": [
        {
            "id": "f276b8a6-73c9-494a-8ab2-13e2f1da4c53",
            "created_at": "2022-10-25T16:07:24.441133Z",
            "updated_at": "2025-03-27T02:02:10.231958Z",
            "deleted_at": null,
            "main_name": "Achilles",
            "aliases": [],
            "source_name": "ETDA:Achilles",
            "tools": [
                "RDP",
                "Remote Desktop Protocol"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535813,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653780639,
    "ts_modification_date": 1653780639,
    "files": {
        "pdf": "https://archive.orkl.eu/c12bd78defe41a0e7764eeeb330229caeb1cf4dc.pdf",
        "text": "https://archive.orkl.eu/c12bd78defe41a0e7764eeeb330229caeb1cf4dc.txt",
        "img": "https://archive.orkl.eu/c12bd78defe41a0e7764eeeb330229caeb1cf4dc.jpg"
    }
}