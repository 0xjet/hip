{
    "id": "d16f4255-8447-43f3-992d-c3cbba210dad",
    "created_at": "2023-01-12T15:03:55.546796Z",
    "updated_at": "2025-03-27T02:05:37.246203Z",
    "deleted_at": null,
    "sha1_hash": "8af93eb21e8e583fc63fefab27719eb439df4e46",
    "title": "2021-09-23 - Threat Thursday- BlackMatter RaaS - Darker Than DarkSide-",
    "authors": "",
    "file_creation_date": "2022-05-28T23:16:16Z",
    "file_modification_date": "2022-05-28T23:16:16Z",
    "file_size": 2757940,
    "plain_text": "# Threat Thursday: BlackMatter RaaS - Darker Than DarkSide?\n\n**[blogs.blackberry.com/en/2021/09/threat-thursday-blackmatter-ransomware-as-a-service](https://blogs.blackberry.com/en/2021/09/threat-thursday-blackmatter-ransomware-as-a-service)**\n\nThe BlackBerry Research & Intelligence Team\n\nFirst identified in July 2021, BlackMatter is a new player in the Ransomware-as-as-Service (RaaS)\narena that many researchers have dubbed the successor to the recently retired Russian ransomware\ngang [DarkSide. However, a](https://blogs.blackberry.com/en/2021/05/threat-thursday-delving-into-the-darkside) [spokesperson for BlackMatter insists they are not the same operators.](https://therecord.media/an-interview-with-blackmatter-a-new-ransomware-group-thats-learning-from-the-mistakes-of-darkside-and-revil/)\n\nBlackMatter has recently made headlines as the likely culprit behind cybersecurity incidents affecting\na [major medical technology company and a](https://techcrunch.com/2021/09/12/technology-giant-olympus-hit-by-blackmatter-ransomware/) [U.S. farming cooperative.](https://www.bleepingcomputer.com/news/security/us-farmer-cooperative-hit-by-59m-blackmatter-ransomware-attack/)\n\n### Operating System\n\n Risk & Impact\n\n\n-----\n\n### About the BlackMatter Group\n\nBlackMatter has been advertised on Russian underground forums, such as XSS and Exploit, looking\n[to recruit affiliates. They claim to have adopted the “best” attributes of DarkSide,](https://blogs.blackberry.com/en/2021/05/threat-thursday-delving-into-the-darkside) [REvil and](https://blogs.blackberry.com/en/2021/05/threat-thursday-dr-revil-ransomware-strikes-again-employs-double-extortion-tactics) [LockBit.](https://blogs.blackberry.com/en/2021/08/threat-spotlight-lockbit-2-0-ransomware-takes-on-top-consulting-firm)\n\n[Although these underground forums are among those that have banned ransomware advertisements](https://therecord.media/three-major-hacking-forums-ban-ransomware-ads-as-some-ransomware-gangs-shut-down/)\n[in the wake of the ransom attack on Colonial Pipeline in May 2021, BlackMatter circumvented this](https://www.vox.com/recode/22428774/ransomeware-pipeline-colonial-darkside-gas-prices)\nrestriction by advertising for “initial access brokers.” These brokers are criminal groups that have\ngained access to corporate networks or machines.\n\nIn their posts, BlackMatter offers a payment of up to $100,000 USD. They state they are looking for\naccess to corporate networks in English-speaking countries, with targets that have between 500 and\n1500 hosts and a revenue of over $100M.\n\nThe BlackMatter website provides information about the group and even its motivations. The RaaS\nprovider says it aims to fill a void in the market left by DarkSide and REvil pausing their activities. The\ngroup’s advertising promotes the strengths of its malware to compete with existing offerings,\npresumably to attract the most successful affiliates.\n\nOn their blog site, BlackMatter includes a list of rules defining sectors they do not attack; they claim to\noffer free decryption to any victims in these sectors. This is most likely an attempt to avoid the\nbacklash suffered by REvil, [Conti, and DarkSide in targeting such industries during 2021.](https://blogs.blackberry.com/en/2021/05/threat-thursday-conti-ransoms-over-400-organizations-worldwide)\n\nUnlike DarkSide and REvil, BlackMatter does not include any checks to ensure victims in certain\ngeolocations are not encrypted. BlackMatter will encrypt Russian systems, which may be another way\nthey’re trying to distinguish themselves from other threat groups.\n\n\n-----\n\n_Figure 1: BlackMatter \"About\" information_\n\n### Technical Analysis\n\nSince July there have already been several versions and updates of BlackMatter identified. These\ninclude versions 1.2, 1.6, 1.9 & 2.0. Additionally, a Linux® variant is available.\n\nStatically analyzing a recent sample identifies the file as a Windows® 32-bit executable with a compile\nstamp from the Aug. 16,2021. The file includes a .rsrc section, although the binary contains no\nresources. This section is instead where the encoded configuration information is stored. The sample\nreviewed is a BlackMatter variant version 2.0.\n\nThe binary uses only three libraries, and its import table contains a short list of Application\nProgramming Interfaces (APIs).\n\n_Figure 2: Static analysis of the file's imported libraries_\n\n\n-----\n\nBlackMatter employs various methods to help evade detection and hinder researchers. For example,\nmost of the APIs and important strings are obfuscated. The executable will de-obfuscate these during\nruntime as required. Although this approach is common with threat actors, the way it is implemented\nby BlackMatter is very similar to the functionality found in DarkSide.\n\nDirectly after the file’s entry point, the binary resolves the addresses of the APIs it requires when\nexecuting. The function shown in the image below dynamically loads additional libraries and APIs.\n\n_Figure 3: Function to resolve APIs and functions_\n\nThe DWORD values point to blocks of encrypted hashes for each API, followed by a trailing\n0xCCCCCCCC. Each hash is decrypted by an XOR operation.\n\n_Figure 4: Block of encrypted hashes_\n\n\n-----\n\nThe image below illustrates the libraries loaded before execution of the function sub_407DB0.\n\n_Figure 5: DLLs loaded before function has executed_\n\nThe following image illustrates the DLLs loaded into memory after the function to resolve APIs has\nexecuted.\n\n_Figure 6: DLLs loaded after the function has executed_\n\nBlackMatter also employs anti-debugging techniques to hide threads from the debugger, which makes\nit trickier to analyze. If it is analyzed while running under a debugger, the application will crash.\n\nThe binary accepts command line arguments when executed. If no argument is supplied, its default\naction is to first verify the rights of the current user. If required, it will attempt to elevate privileges and\nbypass User Account Control (UAC).\n\nThe malware creates a mutex to ensure that only one instance of the ransomware is running. The\nmutex name is generated from a registry value relating to the MachineGuid; for example,\n“Global\\21661c2e54b253e217f64acc8644f973”.\n\nThe executable deletes three services relating to shadow copies – “vmicvss,” “vmvss” and “vss.”\nRemoving shadow copies is a common practice with ransomware, as it prevents victims from easily\nrestoring their systems.\n\n\n-----\n\nBlackMatter will terminate common productivity-related processes to increase its impact. Terminating\nthese processes ensures that important files will not be locked, and valuable files can be encrypted.\n\nThe ransomware takes a multithreaded approach to enumerating the filesystem and executing the\nencryption routine, to ensure that files are locked quickly. Local files and any found on connected\ndrives will be encrypted, while vital system files are skipped.\n\nThe BlackMatter encryption routine shares similarities with that of DarkSide. It uses custom\nimplementations of the Salsa20 and RSA-1024 algorithms. Only the first megabyte of each file is\nencrypted, and the encrypted key is added to the end of the file. Partially encrypting files makes the\nprocess much faster, which shortens the attack duration and leaves little time for the victim to react.\n\nEncrypted files are appended with an extension consisting of an alpha-numeric string that varies\nbetween attacks. Below is an example of an encrypted filename.\n\n_Figure 7: Encrypted file with appended extension “.3LqOKCiOu”_\n\nThe ransomware drops a bitmap image file to C:\\ProgramData\\ and sets this as the victim’s\nbackground through the registry.\n\n_Figure 8: Defining wallpaper image in the registry - 3LqOKCiOu.bmp_\n\nThe wallpaper notifies the user their files have been encrypted by BlackMatter. The image itself\nappears very similar to the one used by DarkSide.\n\n\n-----\n\n_Figure 9: Desktop wallpaper of an infected endpoint_\n\nA ransom note is also dropped into each directory as a text file. This text file is named using the same\nextension as the encrypted files, appended with README.txt. For example,\n“3LqOKCiOu.README.txt.”\n\n_Figure 10: BlackMatter ransom note_\n\n[The ransom note provides the URL of an onion website (one accessible via TOR) where the victim](https://www.torproject.org/)\ncan pay if they wish to obtain the decryptor for their network.\n\n\n-----\n\n_Figure 11: BlackMatter payment website_\n\nThe malware collects information from the victim’s machine and sends this data to its command-andcontrol (C2) servers in an encoded POST request. During our analysis, the sample in question\ncommunicated with http[s]://mojobiden[.]com and http[s]://nowautomation[.]com.\n\n_Figure 12: POST request to C2_\n\n\n-----\n\nLike most modern RaaS providers, BlackMatter uses the technique of double extortion. A leak site is\navailable on the dark net. Victims are threatened that their confidential data will be released publicly if\nthey choose not to pay.\n\n_Figure 13: BlackMatter leak site_\n\n### YARA Rule\n\nThe following YARA rule was authored by the BlackBerry Research & Intelligence Team to catch the\nthreat described in this document:\n\nimport \"pe\"\n\nimport \"hash\"\n\nrule Mal_Win_Ransom_BlackMatter {\n\nmeta:\n\ndescription = \"BlackMatter Ransomware September 2021\"\n\nauthor = \"BlackBerry Threat Research Team\"\n\ndate = \"2021-09\"\ncondition:\n\npe.is_32bit() and\n\nfilesize < 90KB and\n\nfilesize > 60KB and\n\npe.number_of_imports == 3 and\n\npe.imphash() == \"2e4ae81fc349a1616df79a6f5499743f\" and\n\nhash.md5(pe.sections[0].raw_data_offset, pe.sections[0].raw_data_size) ==\n\"100da8cf342d6d8f3bd24b367e0ea999\" and\n\npe.sections[3].name == \".rsrc\" and\n\npe.number_of_signatures == 0 and\n\npe.number_of_sections == 5\n\n}\n\n### Indicators of Compromise (IoCs)\n\n\n-----\n\n**Files Dropped:**\n\nC:\\ProgramData\\<alpha-numeric_extension>.bmp\n\n_e.g.: C:\\ProgramData\\3LqOKCiOu. Bmp_\n\n**Mutex**\n\nGlobal\\<alpha-numeric_string>\n\n_e.g.: Global\\21661c2e54b253e217f64acc8644f973_\n\n**Services Terminated**\n\nVmicvss\n\nVmvss\n\nVss\n\n**Encrypted Files:**\n\n<filename>.<alpha-numeric_extension>\n\n_e.g.: test.jpg.3LqOKCiOu_\n\n**Ransom note:**\n\n< alpha-numeric_extension >.README.txt\n\n_e.g.: 3LqOKCiOu.README.txt_\n\n**CnC Servers:**\n\nhttp[s]://mojobiden[.]com\n\nhttp[s]://nowautomation[.]com\n\n**Payment URL:**\nhxxp://supp24yy6a66hwszu2piygicgwzdtbwftb76htfj7vnip3getgqnzxid.onion/O3KTUJZRE6CB4Q1OBR\n\n### BlackBerry Assistance\n\nIf you’re battling this malware or a similar threat, you’ve come to the right place, regardless of your\nexisting BlackBerry relationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated to handling](https://www.blackberry.com/us/en/services/incident-response)\nresponse and containment services for a wide range of incidents, including ransomware and\nAdvanced Persistent Threat (APT) cases.\n\nWe have a global consulting team standing by to assist you by providing around-the-clock support, if\nrequired, as well as local assistance. Please contact us\nhere: https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incident-responsecontainment\n\n_Want to learn more about this threat? Watch our new demo video: BlackBerry vs. BlackMatter_\n**_RaaS._**\n\n\n-----\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats, providing\nintelligence analysis for the benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-23 - Threat Thursday- BlackMatter RaaS - Darker Than DarkSide-.pdf"
    ],
    "report_names": [
        "2021-09-23 - Threat Thursday- BlackMatter RaaS - Darker Than DarkSide-.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535835,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1653779776,
    "ts_modification_date": 1653779776,
    "files": {
        "pdf": "https://archive.orkl.eu/8af93eb21e8e583fc63fefab27719eb439df4e46.pdf",
        "text": "https://archive.orkl.eu/8af93eb21e8e583fc63fefab27719eb439df4e46.txt",
        "img": "https://archive.orkl.eu/8af93eb21e8e583fc63fefab27719eb439df4e46.jpg"
    }
}