{
    "id": "5bec971d-b215-4a8f-9e59-b3f6bbaf298e",
    "created_at": "2023-01-12T15:07:41.013963Z",
    "updated_at": "2025-03-27T02:13:47.847374Z",
    "deleted_at": null,
    "sha1_hash": "c0208f42afd5ad75a3192bbba0dbb387eaebe826",
    "title": "2020-01-14 - Ryuk Ransomware Uses Wake-on-Lan To Encrypt Offline Devices",
    "authors": "",
    "file_creation_date": "2022-05-27T01:59:16Z",
    "file_modification_date": "2022-05-27T01:59:16Z",
    "file_size": 478603,
    "plain_text": "# Ryuk Ransomware Uses Wake-on-Lan To Encrypt Offline Devices\n\n**[bleepingcomputer.com/news/security/ryuk-ransomware-uses-wake-on-lan-to-encrypt-offline-devices/](https://www.bleepingcomputer.com/news/security/ryuk-ransomware-uses-wake-on-lan-to-encrypt-offline-devices/)**\n\nLawrence Abrams\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nJanuary 14, 2020\n03:30 AM\n5\n\nThe Ryuk Ransomware uses the Wake-on-Lan feature to turn on powered off devices on a\ncompromised network to have greater success encrypting them.\n\nWake-on-Lan is a hardware feature that allows a powered down device to be woken up, or\npowered on, by sending a special network packet to it. This is useful for administrators who\nmay need to push out updates to a computer or perform scheduled tasks when it is\npowered down.\n\nAccording to a [recent analysis of the Ryuk Ransomware by Head of SentinelLabs Vitali](https://twitter.com/VK_Intel/status/1216351931020476417)\nKremez, when the malware is executed it will spawn subprocesses with the argument '8\nLAN'.\n\n**Spawning subprocess with 8 Lan argument**\n\n\n-----\n\nWhen this argument is used, Ryuk will scan the device s ARP table, which is a list of known\nIP addresses on the network and their associated mac addresses, and check if the entries\nare part of the private IP address subnets of \"10.\", \"172.16.\", and \"192.168.\"\n\n**Checking for private network**\nIf the ARP entry is part of any of those networks, Ryuk will send a Wake-on-Lan (WoL)\npacket to the device's MAC address to have it power up. This WoL request comes in the\nform of a 'magic packet' containing 'FF FF FF FF FF FF FF FF'.\n\n**Ryuk sending a WoL packet**\nIf the WoL request was successful, Ryuk will then attempt to mount the remote device's C$\nadministrative share\n\n\n-----\n\n**Mount drive to the Remote C$ Share**\nIf they can mount the share, Ryuk will encrypt that remote computer's drive as well.\n\nIn conversations with BleepingComputer, Kremez stated that this evolution in Ryuk's tactics\nallow a better reach in a compromised network from a single device and shows the Ryuk\noperator's skill traversing a corporate network.\n\n\"This is how the group adapted the network-wide ransomware model to affect more\nmachines via the single infection and by reaching the machines via WOL & ARP,\" Kremez\ntold BleepingComputer. \"It allows for more reach and less isolation and demonstrates their\nexperience dealing with large corporate environments.\"\n\nTo mitigate this new feature, administrators should only allow Wake-on-Lan packets from\nadministrative devices and workstations.\n\nThis would allow administrators to still benefit from this feature while adding some security\nto the endpoints.\n\nAt the same time, this does not help if an administrative workstation is compromised, which\nhappens quite often in targeted ransomware attacks.\n\n**[Update 1/14/20 11:28 AM: CrowdStrike also has analysis of this feature here.](https://www.crowdstrike.com/blog/wizard-spider-adds-new-feature-to-ryuk-ransomware/)**\n\n## Related Articles:\n\n[Windows 11 KB5014019 breaks Trend Micro ransomware protection](https://www.bleepingcomputer.com/news/security/windows-11-kb5014019-breaks-trend-micro-ransomware-protection/)\n\n[Industrial Spy data extortion market gets into the ransomware game](https://www.bleepingcomputer.com/news/security/industrial-spy-data-extortion-market-gets-into-the-ransomware-game/)\n\n[New ‘Cheers’ Linux ransomware targets VMware ESXi servers](https://www.bleepingcomputer.com/news/security/new-cheers-linux-ransomware-targets-vmware-esxi-servers/)\n\n[SpiceJet airline passengers stranded after ransomware attack](https://www.bleepingcomputer.com/news/security/spicejet-airline-passengers-stranded-after-ransomware-attack/)\n\n[US Senate: Govt’s ransomware fight hindered by limited reporting](https://www.bleepingcomputer.com/news/security/us-senate-govt-s-ransomware-fight-hindered-by-limited-reporting/)\n\n[ARP](https://www.bleepingcomputer.com/tag/arp/)\n[Packet](https://www.bleepingcomputer.com/tag/packet/)\n[Ransomware](https://www.bleepingcomputer.com/tag/ransomware/)\n[Ryuk](https://www.bleepingcomputer.com/tag/ryuk/)\n[Wake-on-LAN](https://www.bleepingcomputer.com/tag/wake-on-lan/)\n[WoL](https://www.bleepingcomputer.com/tag/wol/)\n\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\n\n-----\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence s\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/news/microsoft/windows-7-reaches-end-of-life-tomorrow-what-you-need-to-know/)\n[Next Article](https://www.bleepingcomputer.com/news/security/united-nations-targeted-with-emotet-malware-phishing-attack/)\n\n## Comments\n\n[navidas73 - 2 years ago](https://www.bleepingcomputer.com/forums/u/1137328/navidas73/)\n\nTerrifying how much criminal energy goes into the development of RYUK ransomware.\n\n[Alovalovayea - 2 years ago](https://www.bleepingcomputer.com/forums/u/1152126/alovalovayea/)\n\nHello, i've found SEVERAL WAYS to recover Ryuk encrypted files. I would be glad if\nanyone could give me some sample because it could be useful in finding a way to\ncalculate the key instead of just recovering files. This ransomware is so advanced (in\nterms of his code and process) that they forgot about some SIMPLE WINDOWS'S\nENVIROMENTS things that are helpful in recovering files.\n\n\n-----\n\n[buddy215 - 2 years ago](https://www.bleepingcomputer.com/forums/u/64042/buddy215/)\n\nOther than using external backup copies of files encrypted on the computer....what\nother way have you found for \"recovering\" encrypted files other than decryting?\nInquiring minds want to know.\n\n[Alovalovayea - 2 years ago](https://www.bleepingcomputer.com/forums/u/1152126/alovalovayea/)\n\nJust to tell you something, working on file history could let you recover everything on a\ncompany network. Every workstation can help you decrypt another workstation, but I\ncan't give you details for now. Talking about any other method, would result on helping\nthe hacker team behind ryuk and that's why I want to use my samples (and some\nmore, If can get some) to calculate the key (it's not that difficult understanding how if\nyou analyze the infection through a network sniffer on a sandbox)\n\n[Alovalovayea - 2 years ago](https://www.bleepingcomputer.com/forums/u/1152126/alovalovayea/)\n\nSodinokibi (post August 2019 version) successfully decrypted thanks to a Facebook\ngroup who submitted samples. Ryuk's taking a bit more time but it's \"vulnerable to the\nsame method\", could someone send samples?\n\n\n-----\n\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n## You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-14 - Ryuk Ransomware Uses Wake-on-Lan To Encrypt Offline Devices.pdf"
    ],
    "report_names": [
        "2020-01-14 - Ryuk Ransomware Uses Wake-on-Lan To Encrypt Offline Devices.pdf"
    ],
    "threat_actors": [
        {
            "id": "9792e41f-4165-474b-99fa-e74ec332bd87",
            "created_at": "2023-01-06T13:46:38.986789Z",
            "updated_at": "2025-03-27T02:00:02.970288Z",
            "deleted_at": null,
            "main_name": "Lucky Cat",
            "aliases": [
                "White Dev 9",
                "TA413"
            ],
            "source_name": "MISPGALAXY:Lucky Cat",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "63061658-5810-4f01-9620-7eada7e9ae2e",
            "created_at": "2022-10-25T15:50:23.752974Z",
            "updated_at": "2025-03-27T02:00:55.538582Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "Wizard Spider",
                "UNC1878",
                "TEMP.MixMaster",
                "Grim Spider",
                "FIN12",
                "GOLD BLACKBURN",
                "ITG23",
                "Periwinkle Tempest",
                "DEV-0193"
            ],
            "source_name": "MITRE:Wizard Spider",
            "tools": [
                "TrickBot",
                "AdFind",
                "BITSAdmin",
                "Bazar",
                "LaZagne",
                "Nltest",
                "GrimAgent",
                "Dyre",
                "Ryuk",
                "Conti",
                "Emotet",
                "Rubeus",
                "Mimikatz",
                "Diavol",
                "PsExec",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3b1367ff-99dc-41f0-986f-4a1dcb41bbbf",
            "created_at": "2022-10-25T16:07:24.273478Z",
            "updated_at": "2025-03-27T02:02:10.157226Z",
            "deleted_at": null,
            "main_name": "TA413",
            "aliases": [
                "White Dev 9"
            ],
            "source_name": "ETDA:TA413",
            "tools": [
                "Exile RAT",
                "ExileRAT",
                "Sepulcher"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f6f91e1c-9202-4497-bf22-9cd5ef477600",
            "created_at": "2023-01-06T13:46:38.86765Z",
            "updated_at": "2025-03-27T02:00:02.938998Z",
            "deleted_at": null,
            "main_name": "WIZARD SPIDER",
            "aliases": [
                "FIN12",
                "UNC2053",
                "Pistachio Tempest",
                "TEMP.MixMaster",
                "GOLD BLACKBURN",
                "Periwinkle Tempest",
                "DEV-0193",
                "Storm-0193",
                "Trickbot LLC",
                "DEV-0237"
            ],
            "source_name": "MISPGALAXY:WIZARD SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e6a21528-2999-4e2e-aaf4-8b6af14e17f3",
            "created_at": "2022-10-25T16:07:24.422115Z",
            "updated_at": "2025-03-27T02:02:10.216817Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "DEV-0193",
                "Gold Blackburn",
                "Gold Ulrick",
                "Grim Spider",
                "ITG23",
                "Operation BazaFlix",
                "Periwinkle Tempest",
                "TEMP.MixMaster",
                "Wizard Spider"
            ],
            "source_name": "ETDA:Wizard Spider",
            "tools": [
                "AdFind",
                "Agentemis",
                "Anchor_DNS",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "Conti",
                "Diavol",
                "Dyranges",
                "Dyre",
                "Dyreza",
                "Dyzap",
                "Gophe",
                "Invoke-SMBAutoBrute",
                "KEGTAP",
                "LaZagne",
                "LightBot",
                "PowerSploit",
                "PowerTrick",
                "PsExec",
                "Ryuk",
                "SessionGopher",
                "TSPY_TRICKLOAD",
                "Team9Backdoor",
                "The Trick",
                "TheTrick",
                "Totbrick",
                "TrickBot",
                "TrickLoader",
                "TrickMo",
                "Upatre",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bc119938-a79c-4e5f-9d4d-dc96835dfe2e",
            "created_at": "2024-06-04T02:03:07.799286Z",
            "updated_at": "2025-03-27T02:05:17.337094Z",
            "deleted_at": null,
            "main_name": "GOLD BLACKBURN",
            "aliases": [
                "Periwinkle Tempest ",
                "Wizard Spider ",
                "ITG23 "
            ],
            "source_name": "Secureworks:GOLD BLACKBURN",
            "tools": [
                " Buer Loader",
                " Dyre",
                " Team9",
                " TrickBot",
                "BazarLoader"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536061,
    "ts_updated_at": 1743041627,
    "ts_creation_date": 1653616756,
    "ts_modification_date": 1653616756,
    "files": {
        "pdf": "https://archive.orkl.eu/c0208f42afd5ad75a3192bbba0dbb387eaebe826.pdf",
        "text": "https://archive.orkl.eu/c0208f42afd5ad75a3192bbba0dbb387eaebe826.txt",
        "img": "https://archive.orkl.eu/c0208f42afd5ad75a3192bbba0dbb387eaebe826.jpg"
    }
}