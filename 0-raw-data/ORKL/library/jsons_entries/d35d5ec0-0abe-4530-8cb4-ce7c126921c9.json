{
    "id": "d35d5ec0-0abe-4530-8cb4-ce7c126921c9",
    "created_at": "2023-01-12T15:04:09.26184Z",
    "updated_at": "2025-03-27T02:05:47.201557Z",
    "deleted_at": null,
    "sha1_hash": "21f7760c564e9371991ccb874c19a43068a235d9",
    "title": "2016-11-15 - CryptoLuck Ransomware being Malvertised via RIG-E Exploit Kits",
    "authors": "",
    "file_creation_date": "2022-05-25T14:44:21Z",
    "file_modification_date": "2022-05-25T14:44:21Z",
    "file_size": 430652,
    "plain_text": "# CryptoLuck Ransomware being Malvertised via RIG-E Exploit Kits\n\n**[bleepingcomputer.com/news/security/cryptoluck-ransomware-being-malvertised-via-rig-e-exploit-kits](https://www.bleepingcomputer.com/news/security/cryptoluck-ransomware-being-malvertised-via-rig-e-exploit-kits/)**\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nNovember 15, 2016\n03:46 PM\n0\n\nA new ransomware called CryptoLuck has been discovered by Proofpoint security researcher\n[and exploit kit expert Kafeine that is being distributed via the RIG-E exploit kit. While it has](https://twitter.com/kafeine)\nbecome common to see new ransomware variants being distributed daily, it is not as\ncommon to find new ransomware infections being distributed via exploit kits. Seeing this\ntype of activity typically indicates that a particular ransomware will see much wider\ndistribution and thus a larger amount of victims.\n\nCryptoLuck also utilizes an interesting method of infecting a victim through the legitimate\nGoogleUpdate.exe executable and DLL hijacking. Once infected, a victim's data will be\nencrypted and then be given a 72 hour countdown to pay a 2.1 bitcoin, or approximately\n$1,500 USD, ransom payment.\n\n\n-----\n\n**CryptoLuck**\n\n## CryptoLuck distributed via Exploit kits after Redirection from Compromised Websites and Malvertising Chains\n\nAccording to Kafeine, CryptoLuck has been spotted being distributed via the RIG-E (Empire)\nexploit kit through malvertising. While Kafeine only specifically saw this sample through\nadvertising in the Adult web site space, he said there is a good possibility of it also being\ndistributed through other sources such as compromised sites.\n\n\n-----\n\n**RIG-E Exploit Kit installing CryptoLuck**\n\n**Source: Kafeine**\n\n## CryptoLuck installed via bundled Googleupdate.exe and DLL Hijacking\n\nAn interesting feature of CryptoLuck is that it uses a legitimate and code signed program\nfrom Google called GoogleUpdate.exe and DLL hijacking to install the ransomware. To\nunderstand how this works, we need to take a look at how the ransomware is installed.\n\nThis ransomware is distributed using a RAR SFX file that includes the crp.cfg,\nGoogleUpdate.exe, and goopdate.dll files. The SFX file also contains instructions that when\nit is executed it will extract these files into the %AppData%\\76ff folder and then silently\nexecute the GoogleUpdate.exe program.\n\n**CryptoLuck RAR SFX File**\n\nThe GoogleUpdate.exe is a legitimate Google program that is signed by Google as shown\nbelow.\n\n\n-----\n\n**Signed Google Executable**\n\nWhen the GoogleUpdate.exe program is run, it will look for a DLL file called goopdate.dll file\nand load it. The problem is that it will first look for this file in the same folder that the\nGoogleUpdate.exe resides in. This allows a malware developer to create their own malicious\ngoopdate.dll file and have it loaded by GoogleUpdate.\n\nThis is the case with the CryptoLuck developer, who had put all of the ransomware related\ncode into their own malicious goopdate.dll file. Then when the legitimate GoogleUpdate.exe\nfile is executed it loads the malicious DLL rather than the legitimate one normally used by\nGoogle.\n\n## How CryptoLuck Encrypts your Files\n\nWhen CryptoLuck infects a computer it will first check to see if it is being run within a virtual\nmachine, and if it is, the process will terminate. Otherwise, it will scan the computer, its\nmounted drives, and unmapped network shares for files that contain certain file extensions.\n[According to Fabian Wosar of Emsisoft, when it detects a targeted file it will generate](https://twitter.com/fwosar)\n\n\n-----\n\na unique AES encryption key for that file and encrypt the file using AES-256 encryption. This\nfile's encryption key is then encrypted with an embedded public RSA key and the resulting\nencrypted AES key is embedded in the encrypted file.\n\nThe current public RSA encryption key for CryptoLuck is:\n```\n-----BEGIN PUBLIC KEY----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAnoamWzd2h7DKzMKYAhdJ\nqoQDpVAd0mirVhWElZsstWdTVfb4WxYMftVJx1CN2MG0FxSF7Rp825Iokm/6MWry\ncXeaafM5vK/AD7j9X/4oxuxZI1zb+BJBvN/kzThDeH2oSmVsSuvT1JlIqn7iGfrG\nD93Ej7ENL53r0SVFXFFB6WhOji54eJlLTkJGH2cYubsREvobBQ4SytKUxEkxbaHp\n6kOM9l3UOaJm6tEepeQmiW4ZaGJmGLGgc1dL0cw+YPooz8egLuLSvLGnBw4W+RyN\nVHKamYLN7JX11rzw5ZnhknS7BFKcSY0nV0tD+CgcQsaaM06qMmsMTT1vW9wtotDX\nFwIDAQAB\n-----END PUBLIC KEY----\n```\nWhen files are encrypted they will have the .[victim_id]_luck extension appended to\nfilename. For example, if a victim had an ID of 0054B131 and a file called test.jpg was\nencrypted by CryptoLuck its new name would be test.jpg.0054B131_luck. The original name\nof each encrypted file is then added as an entry under the\nHKCU\\Software\\sosad_[victim_idfile]\\files key.\n\n**CryptoLuck Encrypted Files**\n\nThe files targeted by CryptoLuck are:\n\n\n-----\n\n```\n.3ds .3fr .4db .4dd .7z .7zip .accdb .accdt .aep .aes .ai .apk .arch00 .arj .arw\n.asset .bar .bay .bc6 .bc7 .big .bik .bkf .bkp .blob .bpw .bsa .cas .cdr .cer .cfr\n.cr2 .crp .crt .crw .csv .d3dbsp .das .dazip .db0 .dba .dbf .dbx .dcr .der .desc .dmp\n.dng .doc .docm .docx .dot .dotm .dotx .dwfx .dwg .dwk .dxf .dxg .eml .epk .eps .erf\n.esm .fdb .ff .flv .forge .fos .fpk .fsh .gdb .gho .gpg .gxk .hkdb .hkx .hplg .hvpl\n.ibank .icxs .idx .ifx .indd .iso .itdb .itl .itm .iwd .iwi .jpe .jpeg .jpg .js .kdb\n.kdbx .kdc .key .kf .ksd .layout .lbf .litemod .lrf .ltx .lvl .m2 .map .max .mcmeta\n.mdb .mdbackup .mddata .mdf .mef .menu .mlx .mpd .mpp .mpqge .mrwref .msg .myo .nba\n.nbf .ncf .nrw .nsf .ntl .nv2 .odb .odc .odm .odp .ods .odt .ofx .orf .p12 .p7b .p7c\n.pak .pdb .pdd .pdf .pef .pem .pfx .pgp .pkpass .ppj .pps .ppsx .ppt .pptm .pptx\n.prproj .psd .psk .pst .psw .ptx .py .qba .qbb .qbo .qbw .qdf .qfx .qic .qif .r3d\n.raf .rar .raw .rb .re4 .rgss3a .rim .rofl .rtf .rw2 .rwl .saj .sav .sb .sdc .sdf\n.sid .sidd .sidn .sie .sis .sko .slm .snx .sql .sr2 .srf .srw .sum .svg .sxc .syncdb\n.t12 .t13 .tar .tax .tbl .tib .tor .txt .upk .vcf .vcxproj .vdf .vfs0 .vpk .vpp_pc\n.vtf .w3x .wallet .wb2 .wdb .wotreplay .wpd .wps .x3f .xf .xlk .xls .xlsb .xlsm .xlsx\n.xxx .zip .ztmp\n\n```\nLast, but not least, when CryptoLuck scans for files to encrypt, it will skip files whose names\ncontain the following strings:\n```\nWindows\nProgram Files\nProgram Files (x86)\nProgramData\nAppData\nApplication Data\nTemporary Internet Files\nTemp\nGames\nnvidia\nintel\n$Recycle.Bin\nCookies\n\n```\nWhen it has finished encrypting the files and available network shares, it will display a\nransom note named %AppData%\\@WARNING_FILES_ARE_ENCRYPTED.\n\n**[victim_id].txt. This ransom note will contain instructions on how to download the**\ndecryptor and make the ransom payment. The text of this ransom note is:\n\n\n-----\n\n```\nA T T E N T I O N !\nYOUR PERSONAL FILES ARE ENCRYPTED!\nPERSONAL ID: 0054B131\nYour important files encryption produced on this computer: photos, videos, documents,\netc. Encryption was produced using a unique public key RSA-2048 generated for this\ncomputer. To decrypt files you need to obtain the private key.\nIf you see this text but don't see Decryptor Wizard window - please, disable any\nFirewalls and antivirus products, and download Decryptor Wizard on this URL:\nhttp://dropmefiles.com/304718\nYou have 72 hours for payment.\nAfter this time the private key will be destroyed.\nFor more info and support, please, contact us at this email address:\nYAFUNN@YAHOO.COM\n\n```\nThe victim will then be shown a Decryption Wizard that walks the victim through making a\npayment and then waits for the payment to be made. If a ransom payment is made, the\ndecryptor states it will automatically decrypt the victim's files.\n\n\n-----\n\n**Waiting for Payment**\n\nUnfortunately, as each file is encrypted using their own unique AES key and only the\nmalware developer knows the master RSA decryption key, this ransomware is not currently\ndecryptable. For those who are looking for further support or who have questions regarding\nCryptoLuck, you can ask in the CryptoLuck Help and Support Topic.\n\n### Files associated with CryptoLuck:\n```\n%AppData%\\@WARNING_FILES_ARE_ENCRYPTED.0054B131.txt\n%AppData%\\info_[vicitm_id].info\n%AppData%\\76ff\\\n%AppData%\\76ff\\crp.cfg\n%AppData%\\76ff\\GoogleUpdate.exe\n%AppData%\\76ff\\goopdate.dll\n\n Registry entries associated with CryptoLuck:\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\GoogleUpdate.exe\n%AppData%\\76ff\\GoogleUpdate.exe\nHKCU\\Software\\sosad_[victim_id]\n\n```\n\n-----\n\n### IOCs:\n```\nSHA256: d399d7eb0e02123a5262549f822bb06e27b4bc8749260363788a5e39a0ce5c2a\n\n Network Communication:\nhttp://pandares.top/two/index.php\n\n```\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/news/software/firefox-50-released-with-enhanced-download-protection-better-search-function/)\n[Next Article](https://www.bleepingcomputer.com/news/security/secret-backdoor-in-some-low-priced-android-phones-sent-data-to-a-server-in-china/)\n\n[Post a Comment Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-11-15 - CryptoLuck Ransomware being Malvertised via RIG-E Exploit Kits.pdf"
    ],
    "report_names": [
        "2016-11-15 - CryptoLuck Ransomware being Malvertised via RIG-E Exploit Kits.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535849,
    "ts_updated_at": 1743041147,
    "ts_creation_date": 1653489861,
    "ts_modification_date": 1653489861,
    "files": {
        "pdf": "https://archive.orkl.eu/21f7760c564e9371991ccb874c19a43068a235d9.pdf",
        "text": "https://archive.orkl.eu/21f7760c564e9371991ccb874c19a43068a235d9.txt",
        "img": "https://archive.orkl.eu/21f7760c564e9371991ccb874c19a43068a235d9.jpg"
    }
}