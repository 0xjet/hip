{
    "id": "1c21e2d3-0e65-4d51-918a-d22a173bf514",
    "created_at": "2023-01-12T15:01:36.194199Z",
    "updated_at": "2025-03-27T02:16:26.609822Z",
    "deleted_at": null,
    "sha1_hash": "95df2b2800ee810a5559ee728d5a71fb76f914d3",
    "title": "2017-10-10 - LokiBot - The first hybrid Android malware",
    "authors": "",
    "file_creation_date": "2022-05-28T01:21:55Z",
    "file_modification_date": "2022-05-28T01:21:55Z",
    "file_size": 661363,
    "plain_text": "# LokiBot - The first hybrid Android malware\n\n**[threatfabric.com/blogs/lokibot_the_first_hybrid_android_malware.html](https://www.threatfabric.com/blogs/lokibot_the_first_hybrid_android_malware.html)**\n\n## Abstract\n\nLately we have been seeing a new variant of Android banking malware which is welldeveloped and provides numerous unique features such as a ransomware module. Based\non the BTC addresses that are used in the source code it seems that the actors behind this\nnew Android malware are successful cybercriminals with over 1.5 million dollars in BTC.\n\n_Bitcoin wallet details_\n\nIt is very unlikely that the actors behind Android LokiBot have gained this amount of money\nusing only LokiBot since the requested fee for ransomware is between $70 and $100 and the\nbot counts in the various campaigns we have seen is usually around 1000. The malware is\nsold as a kit. A full license including updates costs $2000 in BTC. The main attack vector of\nthe malware is showing phishing overlays on a large amount of banking apps (often around\n100) and a handful of other popular apps such as Skype, Outlook and WhatsApp. The\nransomware stage is activated when victims disable the administrative rights of the malware\n\n\n-----\n\nor try to uninstall it. Besides the automatic activation of the ransomware module the bot also\nhas a “Go_Crypt” command, enabling the actors to trigger it. The ransomware attack\nhowever does not seem to be the main focus of their campaign at the time of writing.\n\n## Malware characteristics\n\nLokiBot, which works on Android 4.0 and higher, has pretty standard malware capabilities,\nsuch as the well-known overlay attack all bankers have. It can also steal the victim’s contacts\nand read and send SMS messages. It has a specific command to spam all contacts with\nSMS messages as a means to spread the infection. The victim’s browser history isn’t safe\neither, as this can be uploaded to the C2. To top it off there is an option to lock the phone\npreventing the user from accessing it.\n\nLokiBot also has some more unique features. For one it has the ability to start the victim’s\nbrowser app and open a given web page. Additionally, it implements SOCKS5, can\nautomatically reply to SMS messages and it can start a user’s banking application. Combine\nthis with the fact that LokiBot can show notifications which seem to come from other apps,\ncontaining for example a message that new funds have been deposited to the victim’s\naccount and interesting phishing attack scenarios arise! The phishing notifications use the\noriginal icon of the application they try to impersonate. In addition, the phone is made to\nvibrate right before the notification is shown so the victim will take notice of it. When the\nnotification is tapped it will trigger an overlay attack.\n\nAnother very interesting and unique feature of LokiBot is its ransomware capabilities. This\nransomware triggers when you try to remove LokiBot from the infected device by revoking its\nadministrative rights. It won’t go down without a fight and will encrypt all your files in the\nexternal storage as a last resort to steal money from you, as you need to pay Bitcoins to\ndecrypt your files.\n\nWhat’s also interesting to note is that the malware obfuscates its network traffic in the exact\n[same way as we’ve seen in previously discovered Bankbot variants. This is probably also the](https://www.threatfabric.com/blogs/banking_malware_in_google_play_targeting_many_new_apps.html)\nreason why our great friend Nikolaos Chrysaidos (Head of Mobile Threats & Security at\nAvast) has [reported very early stages of lokibot campaign as Bankbot.](https://twitter.com/virqdroid/status/878255898044452864)\n\n### Panel features\n\nThe C2 web panel is well rounded and has a couple of interesting features. It provides you\nwith a built-in APK builder which allows you to customize the icon, name, build date and C2\nURL, making it trivial to create numerous different samples targeting different user groups. It\nwill also automatically generate certificate to sign each APK.\n\nIn addition to building the APK an actor can also customize all aspects of the overlays which\nwill be shown to the victims and do advanced searches on all collected data, such as logs,\nhistory and geolocation.\n\n\n-----\n\n_Malware command and control panel_\n\n## Ransomware details\n\nThe ransomware stage is automatically activated when victims tries to remove the malware.\nIn addition, it can be activated from the C2 by sending the “Go_Crypt” command.\n\n_Automatic ransomware activation when disabling ‘device admin’_\n\nAs soon as the ransomware is activated, it starts searching for all files and directories in the\nprimary shared or external storage directory (traditionally the SD card) and encrypts them\nusing AES. The key is generated randomly under default AES/ECB/PKCS5 padding and\n128-bit key size. However, the encryption function in this ransomware utterly fails, because\neven though the original files are deleted, the encrypted file is decrypted and written back to\nitself. Thus, victims won’t lose their files, they are only renamed.\n\nEven though the encryption part fails pretty badly, the screen locker still works and will lock\nthe victim’s screen using the administrative permissions it has gained from the user when the\nmalware was first started. A threat is then shown on the screen: “Your phone is locked for\n\n\n-----\n\nviewing child pornography. The payment amount varies between $70 and $100. The Bitcoin\naddresses of LokiBot are hardcoded in the APK and can’t be updated from C2 server.\n\n_Screen shown_\n\n_when the ransomware locks the phone_\n\n_Hardcoded Bitcoin address_\n\n## Dynamic analysis evasion\n\nThe techniques used by LokiBot to prevent dynamic analysis are not very advanced, but\nseem to be more extensive than those used by other banking malware we have seen. Over\ntime we see continueing improvements on this part, indicating the developer is still working\non this. The following techniques are found in the latest version of LokiBot:\n\n- Detecting Qemu files: /dev/socket/qemud, /dev/qemu_pipe,\n/system/lib/libc_malloc_debug_qemu.so, /sys/qemu_trace, /system/bin/qemu-props; Detecting Qemu properties: init.svc.qemud, init.svc.qemu-props, qemu.hw.mainkeys; \n\n-----\n\nDetecting emulator (goldfish) drivers in /proc/tty/drivers; - Checking installed packages for\nTaintDroid package org.appanalysis; - Checking prescence of TaintDroid class\ndalvik.system.Taint.\n\n## Conclusion\n\nSince early this summer we have seen at least 30 to 40 samples with bot counts varying\nbetween 100 to 2000 bots. We believe that the actors behind LokiBot are successful, based\non their BTC traffic and regular bot updates. In fact, we have seen new features emerge in\nthe bot almost every week which shows that LokiBot is becoming a strong Android trojan,\ntargeting many banks and popular apps.\n\n## Targeted apps (sorted by package name)\n\n1.  BAWAG P.S.K. (at.bawag.mbanking) 2.  Easybank (at.easybank.mbanking) 3.\nErsteBank/Sparkasse netbanking (at.spardat.netbanking) 4.  Volksbank Banking\n(at.volksbank.volksbankmobile) 5.  Bankwest (au.com.bankwest.mobile) 6.  ING Australia\nBanking (au.com.ingdirect.android) 7.  NAB Mobile Banking (au.com.nab.mobile) 8.\nSuncorp Bank (au.com.suncorp.SuncorpBank) 9.  ING Direct France\n(com.IngDirectAndroid) 10.  Raiffeisen Smart Mobile (com.advantage.RaiffeisenBank) 11.\nAkbank Direkt (com.akbank.android.apps.akbank_direkt) 12.  澳盛行動夥伴\n(com.anz.android) 13.  ANZ goMoney Australia (com.anz.android.gomoney) 14.  AOL News, Mail & Video (com.aol.mobile.aolapp) 15.  Axis Mobile (com.axis.mobile) 16.  Bank\nAustria MobileBanking (com.bankaustria.android.olb) 17.  Bankinter Móvil\n(com.bankinter.launcher) 18.  BBVA | España (com.bbva.bbvacontigo) 19.  BBVA net cash\n| ES & PT (com.bbva.netcash) 20.  Bendigo Bank (com.bendigobank.mobile) 21.\nBoursorama Banque (com.boursorama.android.clients) 22.  Banque\n(com.caisseepargne.android.mobilebanking) 23.  Chase Mobile (com.chase.sig.android)\n24.  CIBC Mobile Banking:registered: (com.cibc.android.mobi) 25.  CIC\n(com.cic_prod.bad) 26.  Citibank Australia (com.citibank.mobile.au) 27.  Fifth Third Mobile\nBanking (com.clairmail.fth) 28.  Crédit Mutuel (com.cm_prod.bad) 29.  Alior Mobile\n(com.comarch.mobile) 30.  CommBank (com.commbank.netbank) 31.  iMobile by ICICI\nBank (com.csam.icici.bank.imobile) 32.  Meine Bank (com.db.mm.deutschebank) 33.\nGumtree: Search, Buy & Sell (com.ebay.gumtree.au) 34.  Facebook (com.facebook.katana)\n35.  Messenger (com.facebook.orca) 36.  QNB Finansbank Cep Şubesi\n(com.finansbank.mobile.cepsube) 37.  La Banque Postale\n(com.fullsix.android.labanquepostale.accountaccess) 38.  Garanti Mobile Banking\n(com.garanti.cepsubesi) 39.  Getin Mobile (com.getingroup.mobilebanking) 40.  Google\nPlay Games (com.google.android.play.games) 41.  Groupama toujours là\n(com.groupama.toujoursla) 42.  Lloyds Bank Mobile Banking\n(com.grppl.android.shell.CMBlloydsTSB73) 43.  Halifax: the banking app that gives you\nextra (com.grppl.android.shell.halifax) 44.  HSBC Mobile Banking\n(com.htsu.hsbcpersonalbanking) 45.  Bank of America Mobile Banking (com.infonow.bofa)\n\n\n-----\n\n46.  ING-DiBa Banking + Brokerage (com.ing.diba.mbbr2) 47.  Raiffeisen ELBA\n(com.isis_papyrus.raiffeisen_pay_eyewdg) 48.  Capital One:registered: Mobile\n(com.konylabs.capitalone) 49.  Citi Handlowy (com.konylabs.cbplpat) 50.  Kutxabank\n(com.kutxabank.android) 51.  MACIF Assurance et Banque\n(com.macif.mobile.application.android) 52.  Microsoft Outlook (com.microsoft.office.outlook)\n53.  Skrill (com.moneybookers.skrillpayments) 54.  NETELLER\n(com.moneybookers.skrillpayments.neteller) 55.  Crédit du Nord pour Mobile\n(com.ocito.cdn.activity.creditdunord) 56.  PayPal (com.paypal.android.p2pmobile) 57.\nİşCep (com.pozitron.iscep) 58.  ruralvía (com.rsi) 59.  State Bank Freedom\n(com.sbi.SBFreedom) 60.  SBI Anywhere Personal (com.sbi.SBIFreedomPlus) 61.  Skype\n\n- gratis chatberichten en video-oproepen (com.skype.raider) 62.  HDFC Bank\nMobileBanking (com.snapwork.hdfc) 63.  Sparkasse+\n(com.starfinanz.smob.android.sbanking) 64.  Sparkasse\n(com.starfinanz.smob.android.sfinanzstatus) 65.  SunTrust Mobile App\n(com.suntrust.mobilebanking) 66.  TD Canada (com.td) 67.  Banca Móvil Laboral Kutxa\n(com.tecnocom.cajalaboral) 68.  Halkbank Mobil (com.tmobtech.halkbank) 69.\nBancolombia App Personas (com.todo1.mobile) 70.  Union Bank Mobile Banking\n(com.unionbank.ecommerce.mobile.android) 71.  USAA Mobile\n(com.usaa.mobile.android.usaa) 72.  U.S. Bank (com.usbank.mobilebanking) 73.\nVakıfBank Mobil Bankacılık (com.vakifbank.mobile) 74.  Viber Messenger (com.viber.voip)\n75.  Wells Fargo Mobile (com.wf.wellsfargomobile) 76.  WhatsApp Messenger\n(com.whatsapp) 77.  Yahoo Mail Blijf georganiseerd (com.yahoo.mobile.client.android.mail)\n78.  Yapı Kredi Mobile (com.ykb.android) 79.  Ziraat Mobil (com.ziraat.ziraatmobil) 80.\ncomdirect mobile App (de.comdirect.android) 81.  Commerzbank Banking App\n(de.commerzbanking.mobil) 82.  Consorsbank (de.consorsbank) 83.  DKB-Banking\n(de.dkb.portalapp) 84.  VR-Banking (de.fiducia.smartphone.android.banking.vr) 85.\nPostbank Finanzassistent (de.postbank.finanzassistent) 86.  SpardaApp\n(de.sdvrz.ihb.mobile.app) 87.  Popular (es.bancopopular.nbmpopular) 88.  Santander\n(es.bancosantander.apps) 89.  Bankia (es.cm.android) 90.  EVO Banco móvil\n(es.evobanco.bancamovil) 91.  CaixaBank (es.lacaixa.mobile.android.newwapicon) 92.\nBank Pekao (eu.eleader.mobilebanking.pekao) 93.  PekaoBiznes24\n(eu.eleader.mobilebanking.pekao.firm) 94.  Mobilny Bank\n(eu.eleader.mobilebanking.raiffeisen) 95.  HVB Mobile B@nking\n(eu.unicreditgroup.hvbapptan) 96.  Mon AXA (fr.axa.monaxa) 97.  Banque Populaire\n(fr.banquepopulaire.cyberplus) 98.  Ma Banque (fr.creditagricole.androidapp) 99.  Mes\nComptes - LCL pour mobile (fr.lcl.android.customerarea) 100. Mobile Banking\n(hr.asseco.android.jimba.mUCI.ro) 101. Baroda mPassbook\n(in.co.bankofbaroda.mpassbook) 102. Maybank (may.maybank.android) 103. L’Appli Société\nGénérale (mobi.societegenerale.mobile.lappli) 104. Santander MobileBanking\n(mobile.santander.de) 105. Mes Comptes BNP Paribas (net.bnpparibas.mescomptes) 106.\nBankSA Mobile Banking (org.banksa.bank) 107. Bank of Melbourne Mobile Banking\n(org.bom.bank) 108. St.George Mobile Banking (org.stgeorge.bank) 109. Westpac Mobile\n\n\n-----\n\nBanking (org.westpac.bank) 110. BZWBK24 mobile (pl.bzwbk.bzwbk24) 111. eurobank\nmobile (pl.eurobank) 112. INGMobile (pl.ing.ingmobile) 113. Token iPKO (pl.ipko.mobile) 114.\nmBank PL (pl.mbank) 115. IKO (pl.pkobp.iko) 116. Banca Transilvania (ro.btrl.mobile) 117.\nIDBI Bank GO (src.com.idbi) 118. TSB Mobile Banking (uk.co.tsb.mobilebank) 119. Bank\nMillennium (wit.android.bcpBankingApp.millenniumPL)\n\n## Sample hashes\n\nbe02cf271d343ae1665588270f59a8df3700775f98edc42b3e3aecddf49f649d\n1979d60ba17434d7b4b5403c7fd005d303831b1a584ea2bed89cfec0b45bd5c2\na10f40c71721668c5050a5bf86b41a1d834a594e6e5dd82c39e1d70f12aadf8b\n5c1857830053e64082d065998ff741b607186dc3414aa7e8d747614faae3f650\ncd44705b685dce0a6033760dec477921826cd05920884c3d8eb4762eaab900d1\nbae9151dea172acceb9dfc27298eec77dc3084d510b09f5cda3370422d02e851\n418bdfa331cba37b1185645c71ee2cf31eb01cfcc949569f1addbff79f73be66\na9899519a45f4c5dc5029d39317d0e583cd04eb7d7fa88723b46e14227809c26\n6fb961a96c84a5f61d17666544a259902846facb8d3e25736d93a12ee5c3087c\nc9f56caaa69c798c8d8d6a3beb0c23ec5c80cab2e99ef35f2a77c3b7007922df\n39b7ff62ec97ceb01e9a50fa15ce0ace685847039ad5ee66bd9736efc7d4a932\n78feb8240f4f77e6ce62441a6d213ee9778d191d8c2e78575c9e806a50f2ae45\na09d9d09090ea23cbfe202a159aba717c71bf2f0f1d6eed36da4de1d42f91c74\nf4d0773c077787371dd3bebe93b8a630610a24d8affc0b14887ce69cc9ff24e4\n18c19c76a2d5d3d49f954609bcad377a23583acb6e4b7f196be1d7fdc93792f8\ncda01f288916686174951a6fbd5fbbc42fba8d6500050c5292bafe3a1bcb2e8d\n7dbcecaf0e187a24b367fe05baedeb455a5b827eff6abfc626b44511d8c0029e\n\n## Bitcoin wallets\n\n19tUaovjwW5FSUfmXuECFKn7aA5hXTvqUr 191JVE2XxLEwxZYp4j7atzsoDJ3xZEkgRC\n1139UN4Xd6Y9748fRhCxQMTxdfD3Eq3qTf\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-10-10 - LokiBot - The first hybrid Android malware.pdf"
    ],
    "report_names": [
        "2017-10-10 - LokiBot - The first hybrid Android malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535696,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653700915,
    "ts_modification_date": 1653700915,
    "files": {
        "pdf": "https://archive.orkl.eu/95df2b2800ee810a5559ee728d5a71fb76f914d3.pdf",
        "text": "https://archive.orkl.eu/95df2b2800ee810a5559ee728d5a71fb76f914d3.txt",
        "img": "https://archive.orkl.eu/95df2b2800ee810a5559ee728d5a71fb76f914d3.jpg"
    }
}