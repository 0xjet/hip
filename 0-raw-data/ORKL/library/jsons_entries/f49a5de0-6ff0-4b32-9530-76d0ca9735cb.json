{
    "id": "f49a5de0-6ff0-4b32-9530-76d0ca9735cb",
    "created_at": "2024-06-26T02:03:41.75965Z",
    "updated_at": "2025-03-27T02:16:55.358151Z",
    "deleted_at": null,
    "sha1_hash": "ce8f234c7f931dbe1f9378e9cb75184c063f19dd",
    "title": "(3) Kimsuky is targeting an arms manufacturer in Europe. | LinkedIn",
    "authors": "",
    "file_creation_date": "2024-06-25T07:09:12Z",
    "file_modification_date": "2024-06-25T07:09:12Z",
    "file_size": 826060,
    "plain_text": "# Kimsuky is targeting an arms manufacturer in Europe.\n\n**[linkedin.com/pulse/kimsuky-targeting-arms-manufacturer-europe-dmitry-melikov-dquge](https://www.linkedin.com/pulse/kimsuky-targeting-arms-manufacturer-europe-dmitry-melikov-dquge/)**\n\n[Dmitry Melikov](https://www.linkedin.com/in/dmitry-melikov-210000142/)\n\n## Dmitry Melikov\n\nCyber threats researcher. Malware researcher.\n\n[2 articles](https://www.linkedin.com/in/dmitry-melikov-210000142/recent-activity/posts/)\nJune 7, 2024\n\nDate of the report (05/24/2024)\n\n**Summary**\n\nOn May 16, 2024, we discovered attempted intrusions targeting organizations that\nproduce weapons components in western Europe. We assess with high confidence that\nthe state-sponsored group known as Kimsuky is behind these attacks. This report details\nthe attacker's methods and tools and provides indicators to detect future activity.\n\n**Key Findings:**\n\n1)The threat actor used new espionage tools.\n\n2)The primary target appears to be an western European weapons manufacturer.\n\n3)The threat actor used the \"General Dynamics\" brand, a prominent military contractor, as\na visual lure.\n\n**Context**\n\nNorth Korean state-sponsored threat actors have long targeted weapons-producing\norganizations. At various times, Different threat clusters have targeted defense industry\nprofessionals and companies that develop weapons components or are military\ncontractors. This campaign is a new round of escalation during which arms\nmanufacturers are being targeted.\n\n**Attack Vector**\n\nThe attack vector is a spear-phishing email sent to the organization's employees. The\nemail contains a malicious JavaScript file attachment named \"Safety Manager JD\n(General Dynamics HR Division II).jse.\" This filename employs a deceptive lure, posing\nas a document describing a job position within General Dynamics.\n\n**Execution Flow**\n\n\n-----\n\nFor the malicious code to execute, the user must open the \"Safety Manager JD (General\nDynamics HR Division II).jse\" file. This file contains JavaScript code that decodes two\nbase64 data blocks. The first block is a benign PDF file displayed to the user as a decoy.\nThe second block contains the malicious payload, which executes silently in the\nbackground.\n\nAs a visual lure, once the malware is launched, the user will see a PDF document that is\na description of an open job opening for the position of system security manager.\n\nFigure 1. A visual lure that the user will see.\n\n\n-----\n\nFigure 2. Code decrypting and launching a PDF file and payload.\n\n**Weaponization**\n\nAs described above, after running the file named Safety Manager JD (General\n**Dynamics HR Division II), two files will run on the system: a legitimate PDF file that is**\nintended to distract the user and a second file that is an executable library.\n\nInterestingly, the data block from where JavaScript retrieves the executable dll library is\nencoded with double base64. It contains two identical executable libraries.\n\nDouble Base64 allows some antivirus product engines to analyze it a bit more complexly.\nWe don't know why two identical executable libraries are located in this data block, but it\nhas no effect on malicious code execution\n\n**Executable Library Details:**\n\n**sha-256:**\n3314B6EA393E180C20DB52448AB6980343BC3ED623F7AF91DF60189FEC637744\n\n**ITW File Name :zT1fbtn.oN5L**\n\n**Compilation Stamp :2024-05-13 02:01:12 UTC**\n\n**File Type/Signature :X64 PE DLL**\n\n**File Size :258.00 KB (264192 bytes)**\n\n**Compiler Name/Version :Microsoft Visual C/C+**\n\nThis executable library is a new espionage tool containing functions for remote execution\nby the attacker. Many strings within the library are encrypted and decrypted at runtime to\nevade detection. API function names called by the program are also encrypted.\n\n\n-----\n\nMany API function names that the program calls at runtime are also encrypted.\n\nFigure 3. Before use, the names of some API functions are decoded before execution.\n\n**Persistence and Communication**\n\nDuring startup, the program creates a new service called “CacheDB” with the start=auto\nparameter.\n\nThe program inscribes itself in the following registry key, ensuring its permanent presence\nin the system. This means the malicious tool will be launched every time the system\nreboots.\n\n**HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run**\n\nWhen establishing the connection for the very first time, the server registers the infected\nsystem with a particular unique identifier. This unique identifier is then used for\ncommunications between the bot and the server. The program uses the following UserAgent to communicate with the remote server.\n\n**Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like**\n**Gecko) Chrome/109.0.3729.169 Safari/537.36**\n\nAfter the remote server has successfully registered a new victim, the program sends\nsystem data and waits for further commands from the threat actor. The attacker is able to\nperform the following actions with this spy tool.\n\n**Espionage Tool Capabilities**\n\nThe attacker can use this tool to:\n\n1. Enumerate directories and files, exfiltrating the information to the C2 server.\n\n\n-----\n\n2.   Retrieve the full path of running processes and send it to the C2 server.\n\n3.   Capture screenshots and exfiltrate them to the C2 server.\n\n4.   Establish socket connections to specified IP addresses and report the connection\nstatus to the C2 server.\n\n5.   Execute additional processes provided by the attacker.\n\n6.   Download and execute secondary payloads from the C2 server.\n\n7.   Enter a sleep mode for one hour.\n\n8.   Remove itself from the compromised system, including cleaning up registry entries.\n\n**Network Infrastructure**\n\nCommand and Control initially calls back to hxxp://download.uberlingen[.]com/index.php.\nThis domain resolves to 94.131.120[.]80, which points to many domains with illegitimate\ngovernment naming schemes.\n\n94.131.120[.]80 has a reverse dns name of apple[.]mac and was hosted on Stark\nIndustries infrastructure (ASN 44477). Another IP address shared some of the same\nproperties. 103.113.70[.]148 is also Stark Industries hosted, reverse dns of apple[.]macfree, identical XAMPP default SSL certificate, forward DNS of de.uberlingen[.]com and\naccounts.login.idm.uberlingen[.]com.\n\nTwo IP addresses are currently hosted on Stark Industries with the same SSL certificate.\nOverlap with the use of *.r-e[.]kr gives at least low confidence that these are new Kimsuky\nC2.\n```\nNetwork Indicators:\ndownload.uberlingen.com 94.131.120.80 C2\nlogo.kalbas.com.vn      94.131.120.80 C2\nshare.dihl-defence.o-r.kr     94.131.120.80 C2\nshare-defence.ohbah.com 94.131.120.80 C2\nshare-defence.verymad.net 94.131.120.80 C2\nshare-defence.uberlingen.com 94.131.120.80 C2\nonline.viewers.r-e.kr     94.131.120.80 C2\necloud.uberlingen.n-e.kr     94.131.120.80 C2\ncloud.adoubleu.de         94.131.120.80 C2\nnews.uberlingen.com     94.131.120.80 C2\nde.uberlingen.com         103.113.70.148 C2\naccounts.login.idm.uberlingen.com 103.113.70.148 C2\nnero1.r-e.kr             95.164.62.157 Possible C2\nqntks.shadir.com 94.131.9.51 Possible C2\n\n```\n\n-----\n\n**Targets**\n\nThis malicious attack targeted; a military production facility located in western Europe.\n\n**Attribution**\n\nResearch into the network infrastructure of this malware campaign shows that it overlaps\nwith the network infrastructure of the Kimsuky threat actor. Based on this data, it is highly\nlikely that a threat actor called Kimsuky is behind this campaign.\n\n**Conclusions**\n\nAs the targeted manufacturer plays a crucial role in the defense supply chain, this\nincident underscores the escalating risks and potential geopolitical implications of cyber\nwarfare targeting essential military industries. We believe the Kimsuky attacker will\ncontinue targeting military- and aerospace-related targets worldwide. We will continue to\nmonitor the actions of this attacker.\n\n**IoCs (Indicators of Compromise)**\n```\nSha256 - 24A42A912C6AD98AB3910CB1E031EDBDF9ED6F452371D5696006C9CF24319147\nMD5 - 8346D90508B5D41D151B7098C7A3E868\nSha256 - 3314B6EA393E180C20DB52448AB6980343BC3ED623F7AF91DF60189FEC637744\nMD5 - 537806C02659A12C5B21EFA51B2322C1\nPDF File Visual lure\nSha256 - F58A9905AAD4D82A89A787017F1A357309CAA01E2DA081D76671F3319C66AA74\nMD5 - 6E5D5A8D06452852F1CCBC9B6DBAB3EB\nNetwork Indicators hxxp://download.uberlingen[.]com/index[.]php\nLaunch commands C:\\Program Files (x86)\\Adobe\\Acrobat Reader\nDC\\Reader\\AcroRd32.exe\" \"C:\\ProgramData\\System Safety Manager JD (General Dynamics\nHR Division II).pdf\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -windowstyle hidden\ncertutil -decode C:\\Windows\\..\\ProgramData\\vjVr53p.yOOL\nC:\\Windows\\..\\ProgramData\\zT1fbtn.oN5L\n\n```\n\n-----\n\n```\nrule Kimsuky_Spy_Tool {\nmeta:\n  description =\"Kimsuky Spy tool\"\n  author =\"The BlackBerry Research and Intelligence Team\"\n  date = \"2024-05-23\"\n  hash =\"3314b6ea393e180c20db52448ab6980343bc3ed623f7af91df60189fec637744\"\n  version = \"1.0\"\nstrings: \n  $a1 = {42 4B 62 68 54 62 7E 58 42 4B 21 3B BA 28 C3 14}\n  $a2 = {31 40 4E 57 67 79 78 65 48 5C 5F 62 70 64 67 63}\n  $a3 = {44 24 50 53 71 80 60 0F 11 45 E8 C7 44 24 54 71}\n  $a4 = {44 24 64 54 57 55 57 49 8B CE C7 44 24 68 47 57}\n  $b1 = {AE 1B C8 96 70 3F B1 5C 40 32 E2 95 32 48 7C C9\n      65 07 71 A3 B9 98 FC 3F 71 28 3F 1A 24 63 BD C5\n      6B C2 70 17 29 1D 06 1A B9 74 B2 12 CE 06 28 6A\n      5C 36 CB 2B 98 68 0D 1A 50 D6 F1 67 51 B8 BC 24\n      AE 2B}\ncondition:\n  uint16(0) == 0x5a4d and ((filesize < 2000KB) and all of ($a*) or any of ($b*))\n}\n\n```\n**Strings that will be decrypted at runtime**\n\n\n-----\n\n```\nCreateFileW          \nCloseHandle         \nMoveFileW          \nDeleteFileW         \nGetFileAttributesW      \nGGetFileAttributesW      \nTGetFileTime         \nSetFileTime         \nGetCurrentDirectoryW     \nGetCurrentProcess      \nNGetTokenInformation     \nkernel32.dll         \nXLoadLibraryA         \nuser32.dll          \nLoadLibraryA         \nJLoadLibraryA         \nkLoadLibraryA         \nSurlmon.dll          \nKLoadLibraryA         \nadvapi32.dll         \nCreateProcessW        \nRegOpenKeyExW         \nCacheDB            \nRegQueryValueExW       \nWCacheDB           \nIGetModuleFileNameW      \nRRegSetValueExW        \nVRegCloseKey         \nDGetModuleFileNameW      \nxRGdcsedfd@#%dg9ser3$#$^@34sd…\nRGdcsedfd@#%dg9ser3$#$^@34sdf…\n%s:info            \nGetTempPathW         \nrGetTempFileName       \nCreateProcessW        \nerror             \nrWaitForSingleOb       \nFGetExitCodeProcUFF      \nRTerminateProcesW       \nGCloseHandle         \nGCreateFileW         \nSetFilePointer\n\n### Published by\n\n```\n[Dmitry MelikovDmitry Melikov](https://www.linkedin.com/in/dmitry-melikov-210000142/)\nCyber threats researcher. Malware researcher.Cyber threats researcher. Malware\nresearcher.\n\n\n-----\n\nPublished • 2w\n[2 articles](https://www.linkedin.com/in/dmitry-melikov-210000142/recent-activity/posts/)\nBlogpost about \"Kimsuky is targeting an arms manufacturer in Europe.\"\n[hashtag#Kimsuky hashtag#IoCs](https://www.linkedin.com/feed/hashtag/?keywords=kimsuky&highlightedUpdateUrns=urn%3Ali%3Aactivity%3A7204589596922277888)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2024/2024.06.10.Kimsuky_Europe/%283%29%20Kimsuky%20is%20targeting%20an%20arms%20manufacturer%20in%20Europe.%20_%20LinkedIn.pdf"
    ],
    "report_names": [
        "(3) Kimsuky is targeting an arms manufacturer in Europe. _ LinkedIn"
    ],
    "threat_actors": [
        {
            "id": "dc78f675-b309-431d-8160-b8dcff037d4f",
            "created_at": "2024-05-01T02:03:08.142224Z",
            "updated_at": "2025-03-27T02:05:17.417972Z",
            "deleted_at": null,
            "main_name": "NICKEL KIMBALL",
            "aliases": [
                "Black Banshee ",
                "Crooked Pisces ",
                "Emerald Sleet ",
                "Kimsuky ",
                "Opal Sleet ",
                "SharpTongue ",
                "TA427 ",
                "THALLIUM ",
                "Velvet Chollima ",
                "APT43 "
            ],
            "source_name": "Secureworks:NICKEL KIMBALL",
            "tools": [
                " KONNI",
                " KimJongRAT",
                " Kimsuky",
                "BabyShark"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1719367421,
    "ts_updated_at": 1743041815,
    "ts_creation_date": 1719299352,
    "ts_modification_date": 1719299352,
    "files": {
        "pdf": "https://archive.orkl.eu/ce8f234c7f931dbe1f9378e9cb75184c063f19dd.pdf",
        "text": "https://archive.orkl.eu/ce8f234c7f931dbe1f9378e9cb75184c063f19dd.txt",
        "img": "https://archive.orkl.eu/ce8f234c7f931dbe1f9378e9cb75184c063f19dd.jpg"
    }
}