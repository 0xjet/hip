{
    "id": "121cc782-4511-451d-a787-00704666d258",
    "created_at": "2023-01-12T15:08:25.561347Z",
    "updated_at": "2025-03-27T02:05:31.168421Z",
    "deleted_at": null,
    "sha1_hash": "490593d55b88ff6919aac24deff7a384262321ba",
    "title": "2017-08-29 - From Onliner Spambot to millions of email's lists and credentials",
    "authors": "",
    "file_creation_date": "2022-05-27T19:06:31Z",
    "file_modification_date": "2022-05-27T19:06:31Z",
    "file_size": 182374,
    "plain_text": "# From Onliner Spambot to millions of email's lists and credentials\n\n**[benkowlab.blogspot.com/2017/08/from-onliner-spambot-to-millions-of.html](https://benkowlab.blogspot.com/2017/08/from-onliner-spambot-to-millions-of.html)**\n\nHey! It's time for another writeup about spambot. Here I will explain how I have found millions\nof emails and credentials on a spambot server and why your creds can be in these\ndatabases.\n\n[Processing the largest list of data ever seen in @haveibeenpwned courtesy of a nasty](https://twitter.com/haveibeenpwned)\nspambot. I'm in there, you probably are too.\n\n— Troy Hunt (@troyhunt) [28 août 2017](https://twitter.com/troyhunt/status/902084044220809216)\n\nI have written a lot about spambot on this blog for many reason. Spambots are often ignored\nby researchers and I don't understand why. In a successful cybercrime campaign there are\ndifferent parts, the final payload is important but the spam process is very critical too. Some\nmalware campaigns like Locky are successful also because the spamming process works\nwell. This case is a good example :).\n\n## Spam the world\n\n\n-----\n\nAs introduction, we will have a look at what is a spambot, why crooks use them and why they\nneed huge list of credentials. In the past, it used to be easier for attackers to send mass\nspams: they just had to scan the Internet to find vulnerable SMTP server (with weak\n[passwords or in Open Relay mode) and use them to send Spams. However, nowadays, it's](https://www.spamhaus.org/news/article/706/the-return-of-the-open-relays)\nmore complicated. There are a lot of anti spam companies, products or firewalls. Most of the\nopen relays are blacklisted and the attackers have to find another way to send mass spams.\nAmong the available options, I have seen 2 very common behaviour:\n\n### PHP Mailer\n\nThe most used tricks I have seen is to use compromised websites. For instance, this kind of\n[spamming campaign has been used for a big Andromeda campaign. The principle is simple:](https://thisissecurity.stormshield.com/2016/04/12/gamarue-loves-malicious-javascript-too/)\n\nThe spammer hacks a lot (10k/20k) of websites (via well known vulnerabilities on\nWordpress, Joomla, OpenCart or FTP/SSH bruteforce etc) or buy access to a lot of\nwebsites on a random shop\n[He uses these websites for hosting a PHP script in charge of sending emails.](https://pastebin.com/8W6FXnZz)\nHe controls all the websites via a software or a web panel and uses them to send spam\n\nDue to the almost infinite number of out-of-date websites on the Internet, it's difficult to\nblacklist every websites and it's really easy to use them for the spammer.\n\n### Malware spammer\n\nThe other common way to send spam is more brutal. Here, the attacker creates or buys a\nspecifique malware used to infects people and send spams. The more the attacker infects\npeople, the more he can distribute spams through different IPs. However, a random pwned\nWindows machine is not enought to send spam. For that, the attacker needs some email\nserver (SMTP) credentials. This is where you can be concerned by Spambot :) Indeed, to\nsend spam, the attacker needs a huge list of SMTP credentials. To do so, there are only two\noptions: create it or buy it :D And it's the same as for the IPs: the more SMTP servers he can\nfind, the more he can distribute the campaign. Lets go through an example to see how\nattackers create SMTP credentials lists:\n\n## Credentials: Spambots gasoline\n\nI will take as an example the Onliner spambot. This spambot is used since at least 2016 to\nspread a banking trojan called Gozi. I have seen this spambot targeting specific countries\nlike Italy, or specific business like Hotels. Some emails example: DHL notification: Email\ntargeting Hotel business: If you're curious about this case, I have tried to give some details in\n3 blog posts:\n\n[A journey inside Gozi campaign](https://benkowlab.blogspot.fr/2017/01/a-journey-inside-ursnif-campaign.html)\n[Spambot safari #2 - Online Mail System](https://benkowlab.blogspot.fr/2017/02/spambot-safari-2-online-mail-system.html)\n[A third look at JSDropper/Gozi campaign - Proxy Statistics](https://benkowlab.blogspot.fr/2017/08/a-third-look-in-jsdropperursnif.html)\n\n\n-----\n\nTL;DR: this malware, after infecting your machine, uses 2 modules:\n\nA module in charge of sending spam\nA module in charge of creating a huge list of SMTP credentials\n\nTo create the list, the attacker provides to the second module a list of emails and credentials\nlike sales@cliffordanddrew.co.uk / 123456 or peter.warner@mcswholesale.co.uk /\nMysuperPass. Then, the module tries to send an email using this combinaison. If it works,\ncredential are added to the SMTP list. Else, credentials are ignored. Thanks to free email\nservices like outlook, gmail or your ISP, the attacker can suppose that a lot of people reuse\nthe same password and use your outlook adress to send spam :)\n\nIt's difficult to know where those lists of credentials came from. I have obviously seen a lot of\npublic leaks (like Linkedin, Baidu or with every passwords in clear text) but credentials can\nalso came from phishing campaigns, credentials stealer malwares like Pony, or they can also\nbe found in a shop. Somebody even show me a spambot with a SQL injection scanner which\nscan Internet, looks for SQLi, retrieves SQL tables with names like \"user\" or \"admin\". Thanks\nto an open directory on the web server of the Onliner Spambot CNC, I was able to grab all\nthe spamming data It's composed of ~40GB of emails, credentials or SMTP configuration.\nThese data are composed of:\n\nHuge lists of credentials like email:password (in clear text)\nHuge lists of Emails to spam\nSpambot configuration files\n\n\n-----\n\nI have found around 80 millions credentials (unsorted, it s an estimation, I cannot deal with so\nbig txt files). One part (~2 millions) seems to come from a Facebook phishing campaign,\nthose I have tested seems to be working and were not on HIBP. Therefore, it's difficult to say\nwhere did your credentials come from.\n\n## Making emails lists like a pro\n\nInside all these data, we can see a lot of emails (used for sending spam to). Because I have\nbeen following these guys for almost a year I'm able to explain how they built these lists.\nAfter looking at the spambot logs, I have seen that it was used to send fingerprinting spam.\nWhat does this mean?. Before starting a new malware campaign, the attacker used the\nspambot to send this kind of emails: If you look at the email you will see that inside this\nrandom spam, there is a hidden 1x1 gif. This method is well known in the marketing industry.\nIndeed, when you open this random spam, a request with your IP and your User-Agent will\nbe sent to the server that hosts the gif. With these information, the spammer is able to know\nwhen you have opened the email, from where and on which device (Iphone ? Outlook?...). At\nthe same time, the request also allows the attacker to know that the email is valid and people\nactually open spams :). This is an example of a classification script found on one Onliner\nspambot server: Example of output : As a reminder: DON'T OPEN SPAM!\n\n## Conclusion\n\nIf you're a malware researcher, it's time to look deeper in the spambot business. It's a\ncreative market which interracts with a lot of other cybercrime business. Around Spambot\nyou will often found phisher, password stealer botmaster, website scanners, malware\ndevelopers, dropper developers, payload hosters, and so on. The way is maybe short\nbetween the lame Pony you have received last month in a stupid .ace archive and a spambot\n\nthat spread Gozi.\n\n## Annexe\n\nSome urls found in spam configuration files:\n\nhxxp://119 28 18 104/IMG 8026 zip\n\n\n-----\n\nhxxp://21emb.com/IMG_0557.zip\nhxxp://cielitodrive.com/2.docm\nhxxp://cielitodrive.com/IMG_0557.zip\nhxxp://dcipostdoc.com/3.docm\nhxxp://fondazioneprogenies.com/1.docm\nhxxp://fondazioneprogenies.com/IMG_7339.zip\nhxxp://intesols.com/IMG_8026.zip\nhxxp://jltl.net/IMG_8026.zip\nhxxp://liyuesheng.com/Report_Bill_ID20039421.zip\nhxxp://lopezdelaisidra.com/107490427.zip\nhxxp://maikaandfriends.com/Report_Bill_ID20593601.zip\nhxxp://mc-keishikai.com/Report_Bill_ID73086492.zip\nhxxp://pacific-centre.com/IMG_8026.zip\nhxxp://reliancemct.com/IMG_9647.zip\nhxxp://resital.net/IMG_0557.zip\nhxxp://speaklifegreetings.com/IMG_9647.zip\nhxxp://tspars.com/087578952.zip\nhxxp://usedtextilemachinerylive.com/IMG_9647.zip\nhxxp://webtoaster.net/IMG_0273.zip\nhxxp://whatisaxapta.com/5.docm\nhxxp://womenepic.com/4.docm\nhxxp://www.loidietxarri.com/Report_Bill_ID87793518.zip\n\nThanks to [Hydraze for reviewing \\o/](https://twitter.com/Hydraze)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-08-29 - From Onliner Spambot to millions of email's lists and credentials.pdf"
    ],
    "report_names": [
        "2017-08-29 - From Onliner Spambot to millions of email's lists and credentials.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536105,
    "ts_updated_at": 1743041131,
    "ts_creation_date": 1653678391,
    "ts_modification_date": 1653678391,
    "files": {
        "pdf": "https://archive.orkl.eu/490593d55b88ff6919aac24deff7a384262321ba.pdf",
        "text": "https://archive.orkl.eu/490593d55b88ff6919aac24deff7a384262321ba.txt",
        "img": "https://archive.orkl.eu/490593d55b88ff6919aac24deff7a384262321ba.jpg"
    }
}