{
    "id": "2abf04b0-114e-4f2c-8914-fcf8282929a8",
    "created_at": "2023-01-12T15:02:46.710568Z",
    "updated_at": "2025-03-27T02:11:43.574782Z",
    "deleted_at": null,
    "sha1_hash": "8b5b25e4a673c5bf9eb1b553c8d728e3a60f269d",
    "title": "2021-04-29 - Investigating TA413 Threat Actor Group Using OpenCTI in Maltego",
    "authors": "",
    "file_creation_date": "2022-05-28T23:11:09Z",
    "file_modification_date": "2022-05-28T23:11:09Z",
    "file_size": 7104837,
    "plain_text": "# Investigating TA413 Threat Actor Group Using OpenCTI in Maltego\n\n**[maltego.com/blog/investigating-ta413-threat-actor-group-using-opencti-in-maltego/](https://www.maltego.com/blog/investigating-ta413-threat-actor-group-using-opencti-in-maltego/)**\n\n[29 Apr 2021 Tutorial](https://www.maltego.com/categories/tutorial/) [Cyber security investigation](https://www.maltego.com/categories/cyber-security-investigation/)\n\n\n-----\n\nMaltego Team\nIn [Part 1 of the article series, we announced the new release of Maltego‚Äôs](https://www.maltego.com/blog/unleashing-the-power-of-cyber-threat-intelligence-with-maltego-stix-and-opencti/) [STIX2 Entities](https://www.maltego.com/transform-hub/stix/)\n[and OpenCTI Hub item. In this article, we will demonstrate how investigators can use](https://www.maltego.com/transform-hub/opencti/)\n**STIX2 Entities and OpenCTI in Maltego by taking a look at TA413.**\n\nThreat Actors have been steadily improving their Tactics, Techniques, and Procedures\n(TTP) over the last few years, allowing them to carry out complex campaigns against\nmultiple targets with the same effort that it used to take to attack a single target.\n\nA recent example is the ‚ÄúSolorigate‚Äù attack (commonly known as the SolarWinds Hack),\nwhich spread to the company‚Äôs clients and went undetected for months. The attack allowed\nhackers to spy on private companies like the elite cybersecurity firm FireEye and important\n\n\n-----\n\nUS Government entities, including the Department of Homeland Security and Treasury\nDepartment.\n\n## Introduction üîó\n\n[We will use the public demo instance of OpenCTI (https://demo.opencti.io), which is open to](https://demo.opencti.io/)\nthe public. If you don‚Äôt have an OpenCTI instance, all you need to do is create an account\n[here to start exploring right away. Once you have registered, you will also get an API key](https://auth.citeum.org/auth/realms/citeum/login-actions/registration?client_id=6d5ac3ab-8a2a-4362-a1c7-19adc7fb8b60&tab_id=QZ3-ZNFI_0E)\nthat you can use with Maltego if you want to follow along.\n\n## What or Who is our target for this investigation? üîó\n\n[A few weeks ago, Proofpoint published an excellent article about TA413 and how this group](https://www.proofpoint.com/us/blog/threat-insight/ta413-leverages-new-friarfox-browser-extension-target-gmail-accounts-global)\nwas targeting the Tibetan diaspora. The image below illustrates the attack vectors used by\nthe TA413 group.\n\nThe APT group known as TA413 has been associated with the Chinese state. While they\nare regionally known for their attacks against the Tibetan diaspora, their worldwide renown\ncame about in March 2020 when they began targeting Western economies that were\nsuffering under the effects of COVID-19 to collect intelligence.\n\nBased on Proofpoint‚Äôs article, we will now attempt to map TA413‚Äôs infrastructure while trying\nto find any additional IOCs (Indicators of Compromise) that the author of the article may\nhave missed.\n\n### Let‚Äôs Make Sure We Have Everything We Need for Our Investigation! üîó\n\nAs previously mentioned, once you have created an OpenCTI account, you can sign into\ntheir demo instance to retrieve your API Key. The first thing you will see is a friendly\ndashboard, but to get the API key, all you need to do is go to the upper right corner of the\n\n\n-----\n\nscreen, click on the Account icon and then select the Profile option from the submenu.\n\nThe API key should be visible at the bottom of the screen. Remember that this key can\noften change with the demo instance, which means you will need to check your API key\nwhenever you want to use it; otherwise, you may face issues with Maltego.\n\nYou will also need to install the OpenCTI Transforms and the STIX2 Utilities in Maltego.\n\n\n-----\n\n[Once you click on Install on the OpenCTI Hub item, you should get a prompt window asking](https://www.maltego.com/transform-hub/opencti/)\nyou for the below information.\n\n[OpenCTI Instance URL: Enter https://demo.opencti.io for the demo instance. In case](https://demo.opencti.io/)\nyou are using your own instance, you should add said URL here.\nOpenCTI API Token: Provided with your OpenCTI profile.\nVerify SSL (true or false): In this case, we will be using SSL, so you should enter\n‚Äútrue‚Äù.\n\n[The installation for STIX2 Utilities is straightforward for this item since it does not require](https://www.maltego.com/transform-hub/stix/)\nany custom settings.\n\nWe should be good to go now!\n\n## Investigating TA413 Using Maltego and OpenCTI üîó\n\n### Finding Relevant Intelligence in OpenCTI üîó\n\nWe will start our investigation by looking into OpenCTI and seeing what general information\nwe can find about TA413. To do so, we can use the search box on the upper right corner of\nthe main dashboard, type in ‚ÄúTA413‚Äù, and hit Enter.\n\nBelow is a snapshot of the information found in OpenCTI for this Threat Actor, where we\nnoticed that OpenCTI categorized this information as an ‚ÄúIntrusion Set.‚Äù\n\nAccording to Oasis, an Intrusion Set is a STIX2 Domain Object that represents a grouped\nset of adversarial behaviors and resources with common properties that are believed to be\norchestrated by a single organization.\n\n\n-----\n\nLet‚Äôs now look for any observables for this intrusion set under the ‚ÄúIndicators‚Äù tab. As we\ncan see, OpenCTI provides a comprehensive list of IOCs associated with TA413‚Äîsome of\nthem mentioned in Proofpoint‚Äôs article‚Äîwhich will be helpful in our investigation.\n\n### Enriching the STIX Standard IDs Using Maltego üîó\n\nWe can now pivot into Maltego. To do so, let‚Äôs go back to OpenCTI‚Äôs overview tab and copy\nthe STIX Standard ID associated with this Intrusion Set so we can drop it into Maltego.\n\n\n-----\n\nMaltego does a great job understanding the type of Entity that we need, as it automatically\ncreates a Maltego.STIX2.intrusion-set Entity for us upon dropping the ID.\n\nBut wait, why is the new Entity showing up as ? It is important to note the Entity itself is not\nentirely devoid of information; if you double-click on it, and go to the Properties tab, you will\nfind that the id and type fields are populated. We still need to query OpenCTI to retrieve the\nremaining details associated with the STIX Standard ID.\n\n\n-----\n\nLet‚Äôs close the Details window and request the details of this intrusion Set from OpenCTI.\nWe can do this by selecting the Maltego.STIX2.intrusion-set Entity and running the\n**Intrusion Set to Details [OpenCTI] Transform in the To Details [OpenCTI] Transform set**\nof the OpenCTI Hub item.\n\nNow we can see an updated Entity in our graph and its populated properties in the Detail\nView.\n\n\n-----\n\nThat was simple, but we should be able to get more details about this intrusion Set from\nOpenCTI. Let‚Äôs select the Maltego.STIX2.intrusion-set Entity and run the Intrusion Set to\n**all Entities [OpenCTI] Transform.**\n\nIn just a few clicks, Maltego retrieved all the details from OpenCTI and pulled them into our\ngraph. Let‚Äôs take a minute to review these new Entities, which are based on and closely\nresemble the STIX2 Entities original Objects.\n\n\n-----\n\nLet‚Äôs take a minute to understand what we have found so far. In the upper half of our graph,\nwhere we can see that all Entities are STIX2 Indicator Entities and contain the same\nobservables that we saw under the Indicators tab of OpenCTI.\n\nWe can also see an ‚Äúindicates‚Äù label next to the links between the Indicator Entities and the\nIntrusion Set Entity, which follows the STIX2 Relationship Objects (SROs) structure.\n\n_Image from_ _[Oasis](https://oasis-open.github.io/cti-documentation/stix/intro.html)_\n\nIn the lower half of our graph, we see a few new maltego.STIX2.attack-pattern and\n**maltego.STIX2.malware Entities, which will help us understand the Tactics and Techniques**\nused by the TA413 group.\n\n\n-----\n\nWe now have an excellent idea of how this Threat Actor operates and its infrastructure, but\nlet‚Äôs see how we can leverage some of our other Transforms to further enrich the\ninformation we have on TA413‚Äôs infrastructure.\n\nFirst, we use the [Collections feature of Maltego to simplify our graph by grouping Entities](https://docs.maltego.com/support/solutions/articles/15000010775-collections-tab)\nbased on their type, grouping all the Observable Entities into a single box.\n\nWe then select the Collection Node and run the Indicator to all Observables [OpenCTI]\nTransform. This will allow us to use our existing Transforms to find additional infrastructure\nassociated with TA413 and not listed in the report nor OpenCTI.\n\n\n-----\n\nAs we can see, Maltego returned a few STIX2 Domain Name Entities to most of the\nselected Observables.\n\nWe will select the STIX2 Domain Name Entities and run the To Resolved IPs [VirusTotal\n**Public API] Transform to see if VirusTotal knows about any additional IP addresses**\nassociated with these domains.\n\nIt looks like we have found some additional IP addresses. We will try to further expand our\nresults by looking for suspicious file names or hashes associated with TA413.\n\nFirst, we will check if any of the IP addresses belong to prominent hosting providers, as\nthese tend to be shared or reassigned rather quickly, and we could save time and focus our\nattention on relevant IOCs by ignoring these noisy IP addresses for now.\n\nSelecting the IP Address Entities, we run the To AS Number [VirusTotal Public API]\nTransform and on the resulting AS Entities, the To Network [Peering DB] Transform.\n\nWe can immediately observe one specific IP associated with Google. We will exclude this\nIP from our next step.\n\n\n-----\n\nWe will select the IP Address Entities again and run the Communication Relationships\n\n**[VirusTotal Public API] Transform.**\n\nIn this case, VirusTotal returned a set of malicious files, including one linked to Cobalt\nStrike, a threat emulation software heavily abused by threat actors.\n\nFinally, we can run the To Hash [VirusTotal Public API] Transform to retrieve the hashes\nassociated with these files. These will be of great help as we can use them for blocking and\nalerting any sightings of these in our network.\n\n\n-----\n\nAnd that wraps up our OpenCTI Transform demonstration!\n\n## Start Using the Maltego OpenCTI Transforms to Unleash Your Threat Intelligence Investigations üîó\n\nThroughout this investigation, we found additional infrastructure used by TA413 for their\ncampaigns, such as domains, IP addresses, file names and hashes.\n\nThese are very relevant as we can now use them to feed our Threat Intelligence and Threat\nHunting processes and also for blocking and alerting purposes.\n\nMaltego elevates your investigations to the next level by allowing you to visually analyze\nwhat the attack looked like as it took place and can help you to find patterns and additional\ninfrastructure used by these attackers, all within a single interface.\n\n[Don‚Äôt forget to follow us on Twitter and](https://www.twitter.com/MaltegoHQ) [LinkedIn and](https://www.linkedin.com/company/maltego) [sign up for our email newsletter to stay](https://www.maltego.com/newsletter-signup/)\nupdated on the latest news, tutorials, and events.\n\nHappy Threat Hunting!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-29 - Investigating TA413 Threat Actor Group Using OpenCTI in Maltego.pdf"
    ],
    "report_names": [
        "2021-04-29 - Investigating TA413 Threat Actor Group Using OpenCTI in Maltego.pdf"
    ],
    "threat_actors": [
        {
            "id": "9792e41f-4165-474b-99fa-e74ec332bd87",
            "created_at": "2023-01-06T13:46:38.986789Z",
            "updated_at": "2025-03-27T02:00:02.970288Z",
            "deleted_at": null,
            "main_name": "Lucky Cat",
            "aliases": [
                "White Dev 9",
                "TA413"
            ],
            "source_name": "MISPGALAXY:Lucky Cat",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3b1367ff-99dc-41f0-986f-4a1dcb41bbbf",
            "created_at": "2022-10-25T16:07:24.273478Z",
            "updated_at": "2025-03-27T02:02:10.157226Z",
            "deleted_at": null,
            "main_name": "TA413",
            "aliases": [
                "White Dev 9"
            ],
            "source_name": "ETDA:TA413",
            "tools": [
                "Exile RAT",
                "ExileRAT",
                "Sepulcher"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535766,
    "ts_updated_at": 1743041503,
    "ts_creation_date": 1653779469,
    "ts_modification_date": 1653779469,
    "files": {
        "pdf": "https://archive.orkl.eu/8b5b25e4a673c5bf9eb1b553c8d728e3a60f269d.pdf",
        "text": "https://archive.orkl.eu/8b5b25e4a673c5bf9eb1b553c8d728e3a60f269d.txt",
        "img": "https://archive.orkl.eu/8b5b25e4a673c5bf9eb1b553c8d728e3a60f269d.jpg"
    }
}