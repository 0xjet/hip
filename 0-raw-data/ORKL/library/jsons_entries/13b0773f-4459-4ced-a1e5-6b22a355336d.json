{
    "id": "13b0773f-4459-4ced-a1e5-6b22a355336d",
    "created_at": "2023-01-12T15:10:18.316034Z",
    "updated_at": "2025-03-27T02:06:10.624185Z",
    "deleted_at": null,
    "sha1_hash": "1ce9917e3c25f49f30919e7d2d529fab14126b4c",
    "title": "2021-09-29 - Google Drive abused in document exfiltration operation against Afghanistan",
    "authors": "",
    "file_creation_date": "2022-05-28T23:16:19Z",
    "file_modification_date": "2022-05-28T23:16:19Z",
    "file_size": 82753,
    "plain_text": "# Google Drive abused in document exfiltration operation against Afghanistan\n\n**[telsy.com/google-drive-abused-in-document-exfiltration-operation-against-afghanistan/](https://www.telsy.com/google-drive-abused-in-document-exfiltration-operation-against-afghanistan/)**\n\nSeptember 29, 2021\n\n[Telsy analyzed a new campaign that targeted Afghanistan and aimed to steal documents.](https://www.telsy.com/)\n\n## Introduction\n\nTelsy last June analyzed a new campaign that targeted Afghanistan, specifically researchers\nand government employees.\n\nThe attack aimed to steal documents from the attacked systems and put them in an external\n_Google Drive._\n\nMost likely, the attack was conducted via spear-phishing and also used a decoy document to\nhide the real actions.\n\nThe peculiarity of the attack is that the payload, which opens the decoy document and\nreleased the malware into the system, was hosted on an Indian website\n“hxxps://dadsasoa.in“, which is linked to the Defense Accounts Department (DAD) of India.\n\nThe Defense Accounts Department (DAD) operates under the administrative control of\nIndia’s Ministry of Defense and is headed by the Controller General of Defense Accounts.\n\nThe website has been, several times, used as an infection vector due to compromise, i.e.\nallowing the download of malicious payloads.\n\n\n-----\n\n## Analysis\n\nThe attack starts with an lnk file, most likely, sent as an attachment through the mail.\n\nThe shortcut downloads from a website “hxxps://dadsasoa.in” an hta file and then execute it.\n\nThe hta is a javascript file that open a decoy document and drops the real payload to\nexfiltrate documents.\n\nThe final payload, i.e. winstr.exe, is used just to exfiltrate documents of the system\nuploading them to a private Google Drive.\n\nOnce executed, the malware will check for the following file types in certain locations to\nupload them into Google Drive: pdf, doc, docx, xls, xlsx, ppt, pptx and txt.\n\n[This malware is written in GOLang and uses the common libraries to interact with Google](https://golang.org/)\nDrive API.\n\nIn order to use the Google Drive API, it’s required to create a Google application and then\nthe account that wants to use the API should ‘agree’ and install the application.\n\nIn order to upload the files to Google Drive, the client_id and client_secret were embedded\non the malware, together with a refresh token.\n\nRefresh tokens are needed as part of the OAuth 2.0 protocol, which is used by Google Drive.\n\nThis protocol is used by Twitter, Facebook and other sites to use their accounts to log in to a\ndifferent website. Access tokens are used to have access on a Google Drive account.\n\nHowever, access tokens expire so refresh tokens are needed to get new access tokens.\n\nOnce the access token expires, the application uses the refresh token, that never expires, to\nobtain a new one.\n\nIf you try to install the google application, it is highlighted that the app is not signed and the\ndeveloper’s email revealed: gillufarooq[@]gmail.com.\n\nThen, the research has been driven to the Google Drive, trying to figure out wich entity was\ncompromised.\n\nIndeed using the information hardcoded in the sample, we were able to list the files on the\nGoogle Drive and get some information on the owner of the drive self.\n\nThe Google Drive owner is: daafghanistanbankbank[@]gmail.com.\n\nSince the gmail space used is 0 bytes and photos space too, it is most likely that this account\nis not a compromised one but just an account created by the attacker.\n\n\n-----\n\nAnother evidence of this, is that this email seems to be not available on official channels of\nthe Afghanistan.\n\nFirst thing done was to list the directories and through the Ips trying to discern the virtual\nmachine and real attacked systems.\n\nSome of these are virtual machine used to analyze malwares, some other are real victims of\nthe campaign like Dell-PC\\\\Dell IP =180.94.xx.xx\n\nThis IP uploaded something like 5000 documents, most of them are government\ncommunications and letters between governement employees.\n\nThe system infected seems to belong to an office manager of Ministry of Borders and Tribal\n_Affairs of the Afghanistan._\n\nThis type of spear-phishing campaign, using Google Drive as an exfiltration channel,\nmanages to evade the main detection systems as it generates traffic that is not categorized\nas malicious.\n\n**Click the link below to download the full report**\n\n[https://www.telsy.com/download/5101/](https://www.telsy.com/download/5101/)\n\n[Check other cyber reports on our blog.](https://www.telsy.com/category/cyber-threat-intelligence/)\n\nThis report was produced by Telsy’s “Cyber Threat Intelligence” team with the help of its CTI\nplatform, which allows to analyze and stay updated on adversaries and threats that could\nimpact customers’ business.\n\n4\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-29 - Google Drive abused in document exfiltration operation against Afghanistan.pdf"
    ],
    "report_names": [
        "2021-09-29 - Google Drive abused in document exfiltration operation against Afghanistan.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536218,
    "ts_updated_at": 1743041170,
    "ts_creation_date": 1653779779,
    "ts_modification_date": 1653779779,
    "files": {
        "pdf": "https://archive.orkl.eu/1ce9917e3c25f49f30919e7d2d529fab14126b4c.pdf",
        "text": "https://archive.orkl.eu/1ce9917e3c25f49f30919e7d2d529fab14126b4c.txt",
        "img": "https://archive.orkl.eu/1ce9917e3c25f49f30919e7d2d529fab14126b4c.jpg"
    }
}