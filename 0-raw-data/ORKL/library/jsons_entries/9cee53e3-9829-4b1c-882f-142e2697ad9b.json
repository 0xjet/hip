{
    "id": "9cee53e3-9829-4b1c-882f-142e2697ad9b",
    "created_at": "2023-01-12T15:05:45.057303Z",
    "updated_at": "2025-03-27T02:05:53.841415Z",
    "deleted_at": null,
    "sha1_hash": "3ef0708949e74013b38420509279ae9401fae47f",
    "title": "2021-07-01 - REvil’s new Linux version",
    "authors": "",
    "file_creation_date": "2022-05-27T22:17:16Z",
    "file_modification_date": "2022-05-27T22:17:16Z",
    "file_size": 1392318,
    "plain_text": "# REvil’s new Linux version\n\n**[cybersecurity.att.com/blogs/labs-research/revils-new-linux-version](https://cybersecurity.att.com/blogs/labs-research/revils-new-linux-version)**\n\n[1. AT&T Cybersecurity](https://cybersecurity.att.com/)\n[2. Blog](https://cybersecurity.att.com/blogs)\n\nJuly 1, 2021 | [Fernando Martinez](https://cybersecurity.att.com/blogs/author/fmartinez)\n_This blog was jointly authored with Ofer Caspi._\n\n## Executive summary\n\nThe ransomware-as-a-service (RaaS) operation behind REvil have become one of the most prolific and\nsuccessful threat groups since the ransomware first appeared in May 2019. REvil has been primarily used\nto target Windows systems. However, new samples have been identified targeting Linux systems. AT&T\nAlien Labs™ is closely monitoring the ransomware landscape and has already identified four of these\n[samples in the wild during the last month, after receiving a tip from](https://twitter.com/VK_Intel/status/1409598638981058564?s=20) [MalwareHuntingTeam. The purpose of](https://twitter.com/malwrhunterteam/status/1409577829289934851?s=20)\nthis blog is to share recent findings and a summary of the adversary, malware family, and detection\noptions.\n\n## Key Takeaways:\n\nREvil ransomware authors have expanded their arsenal to include Linux ransomware, which allows\nthem to target ESXi and NAS devices.\nThe new Linux version has similarities to the Windows version, which has impacted companies such\n[as JBS, Acer, and Travelex, as already reported by the FBI and the media.](https://www.zdnet.com/article/fbi-attributes-jbs-ransomware-attack-to-revil/)\n\n## Background\n\n\n-----\n\nREvil is also known as Sodinokibi or Sodin. It is a ransomware family operated as a ransomware-as-aservice (RaaS). Deployments of REvil were first observed in April 2019, exploiting a published vulnerability\nin Oracle WebLogic (CVE-2019-2725). Since then, REvil has become one of the most prolific RaaS\n[groups, after being attributed ransom attacks to JBS,](https://www.zdnet.com/article/fbi-attributes-jbs-ransomware-attack-to-revil/) [Acer,](https://www.bleepingcomputer.com/news/security/computer-giant-acer-hit-by-50-million-ransomware-attack/) [Travelex, and the most recent one U.K.-based](https://www.bbc.com/news/business-51017852)\n[fashion brand French Connection this week.](https://threatpost.com/fcuk-fashion-medical-diagnostics-revil/167245/)\n\n**REVIL Victims**\n\n**Company** **Industry** **Country**\n\nNational Western Life Financial United States\n\nEurecat (Eurecat SA) Energy France, United States\n\nLight S.A. Energy Brazil\n\nQuest Worldwide Consulting Australia\n\nBrown Forman Corporation Food and Beverage Services United States\n\nArafmi Healthcare Australia\n\n4datanet.com Information Technology United States\n\nmalabs.com Technology United States\n\nViva Resorts Hospitality United States\n\nSchramm Inc. Manufacturing United States\n\nCAT RICAMBI SR Automotive Italy\n\nQuanta Computer Information Technology Taiwan\n\nJBS Food and Beverage Services Brasil, United States\n\nAcer Information Technology Taiwan\n\nTravelex Financial United Kingdom\n\nFrench Connection Fashion United Kingdom\n\n\n-----\n\nGrupo Fleury Healthcare Brazil\n\nInvenergy Energy United States\n\nRansomware-as-a-service is a method for individuals to purchase prebuilt malware families for their own\nmalicious use. RaaS has been sold on the dark web and has been the approach used by a variety of other\ncriminal groups, such as DarkSide. One thing to keep in mind is RaaS is not limited to buyers who lack\ntheir own capabilities. For example, a highly skilled adversarial team supporting a nation state could make\nuse of RaaS families to gain access into a targeted network to avoid pre- and post- compromise attribution\nand objective identification.\n\n## Analysis\n\nThe threat actors behind REvil ransomware have expanded their arsenal to include Linux ransomware. As\n[announced on a dark web blog and reported by AdvIntel in early May 2021, REvil has ported their](https://twitter.com/y_advintel/status/1391450354051653633)\nWindows ransomware version to the Linux architecture.\n\nThese software upgrades follow the trend seen in other popular RaaS groups, like DarkSide, where they\nhave added Linux capabilities to include ESXi in their scope of potential targets. The hypervisor ESXi\nallows multiple virtual machines (VM) to share the same hard drive storage. However, this also enables\nattackers to encrypt the centralized virtual hard drives used to store data from across VMs, potentially\ncausing disruptions to companies. According to the blog post, in addition to targeting ESXi, REvil is also\ntargeting NAS devices as another storage platform with the potential to highly impact the affected\ncompanies.\n\nIn late May 2021 the first REvil ransomware samples affecting *nix systems and ESXi were observed in the\nwild. The samples are ELF64 executables, with similarities to the Windows REvil executable, being the\nmost noticeable among the configuration options.\n\nBefore encrypting all the files, REvil runs the esxcli command line tool to list all running ESXi VMs and\nterminate them. By doing this, the attacker ensures no other VM is handling the files to be encrypted,\navoiding corruption issues of the encrypted files. However, the executable has a specific parameter to run\nin silent mode, which avoids debugging without stopping any VMs.\n\nFigure 1: ESXi command to kill running VMs, as captured by Alien Labs.\n\nIn addition to the above-mentioned parameter, the threat actor can specify the number of threads to use\n(the default value is 50) and the path to encrypt. (By default, the malware will encrypt the current directory\nand its subfolders.)\n\nDuring execution, the malware will first check if its configuration exists. The configuration file format is very\nsimilar to the one observed for REvil Windows samples, but with fewer fields. Some of the fields presented\nin both versions include:\n\nPk: Base64-encoded value containing the attacker's public key used to encrypt files\nSub: 7987 representing the affiliate identifier\nDbg: Determines if the victim is Russian, terminating the execution if the language set in the victim’s\nsystem is not the expected one\n\n\n-----\n\nNbody: Ransom note body contents encoded in base64; decoded contents are shown in Figure 3\nNname: Ransom note filename\nRdmcnt: Unique value not previously seen in REvil configurations\nExt: Encrypted extension, which appears to be five random character; the observed extensions\ninclude .rhkrc, .qoxaq, .naixq, and . 7rspj.\n\nFigure 2: Hard-coded config file, as captured by Alien Labs.\n\nFigure 3: Hard-coded ransom note after decoding, as captured by Alien Labs.\n\nThe malware will loop through the target folder, encrypting the files in it. Before encryption, it will check to\nsee if the file has already been encrypted by looking at the filename extension.\n\nDuring encryption, the malware will generate a 64 bytes XOR key, based on the pk key given in the config\nfile. It will use this key during the encryption process. After encryption, the malware will write the generated\nkey “IV” at the end of each file and leave a ransom note in each folder.\n\n\n-----\n\nFigure 4: Main encryption routine, as captured by Alien Labs.\n\nFigure 5: Main encryption routine, as captured by Alien Labs.\n\nThe malware will log all the files it goes through, stating if the file was encrypted or if it was unable to\nencrypt due to OS protection.\n\n\n-----\n\nFigure 6: Encryption logs, as captured by Alien Labs.\n\nFigure 7: Execution output, as captured by Alien Labs. .\n\n## Conclusion\n\n\n-----\n\nThe threat actors behind REvil RaaS have rapidly developed a Linux version to compete against the\nrecently released Linux version of DarkSide. It is hard to clarify if these two RaaS are competing against\n[each other or collaborating team members, as stated by other security researchers. Nevertheless, both](https://krebsonsecurity.com/2021/06/justice-dept-claws-back-2-3m-paid-by-colonial-pipeline-to-ransomware-gang/)\nactors have been very active in the ransomware landscape during the last months, and these upgrades will\nkeep them in the spotlight due to the increased attacking spectrum.\n\n## Appendix A. Detection Methods\n\nThe following associated detection methods are in use by Alien Labs. They can be used by readers to tune\nor deploy detections in their own environments or for aiding additional research.\n\nYARA RULES\n```\n rule REvilLinux\n {\n   meta:\n     author = \"AlienLabs\"\n     description = \"REvil Linux\"\n     sha256 =\n \"ea1872b2835128e3cb49a0bc27e4727ca33c4e6eba1e80422db19b505f965bc4 \"\n   strings:\n     $func = \"File [%s] was NOT encrypted\"\n     $sleep = \"esxcli\"\n     $re = \"[%s] is protected by os\"\n     $a3 = \"Error create note in dir %s\"\n   condition:\n     uint32(0) == 0x464C457F and 3 of them\n }\n\n## Appendix B. Associated Indicators (IOCs)\n\n```\nThe following technical indicators are associated with the reported intelligence. A list of indicators is also\n[available in the OTX Pulse. Please note, the pulse may include other activities related but out of the scope](https://otx.alienvault.com/pulse/60da2c80aa5400db8f1561d5)\nof the report.\n\nTYPE INDICATOR DESCRIPTION\n\nSHA256 ea1872b2835128e3cb49a0bc27e4727ca33c4e6eba1e80422db19b505f965bc4 REvil Linux\nsample\n\n\n-----\n\nSHA256 d6762eff16452434ac1acc127f082906cc1ae5b0ff026d0d4fe725711db47763 REvil Linux\nsample\n\nSHA256 796800face046765bd79f267c56a6c93ee2800b76d7f38ad96e5acb92599fcd4 REvil Linux\nsample\n\nSHA256 3d375d0ead2b63168de86ca2649360d9dcff75b3e0ffa2cf1e50816ec92b3b7d REvil Linux\nsample\n\n## Appendix C. Mapped to MITRE ATT&CK\n\n[The findings of this report are mapped to the following MITRE ATT&CK Matrix techniques:](https://attack.mitre.org/)\n\nTA0043: Reconnaissance\n\nTA1592: Gather Victim Host Information\nTA0042: Resource Development\n\nT1583: Acquire Infrastructure\nT1587: Develop Capabilities\nTA0005: Defense Evasion\n\nT1027: Obfuscated Files or Information\nTA0007: Discovery\n\nT1083: File and Directory Discovery\nTA0009: Collection\n\nT1005: Data from Local System\nTA0040: Impact\n\nT1486: Data Encrypted for Impact\n\n### Share this with others\n\nTags: [malware,](https://cybersecurity.att.com/blogs/tag/malware) [alien labs,](https://cybersecurity.att.com/blogs/tag/alien+labs) [ransomware,](https://cybersecurity.att.com/blogs/tag/ransomware) [otx pulse,](https://cybersecurity.att.com/blogs/tag/otx+pulse) [security,](https://cybersecurity.att.com/blogs/tag/security) [labs,](https://cybersecurity.att.com/blogs/tag/labs) [linux,](https://cybersecurity.att.com/blogs/tag/linux) [raas,](https://cybersecurity.att.com/blogs/tag/raas) [revil](https://cybersecurity.att.com/blogs/tag/revil)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-01 - REvil’s new Linux version.pdf"
    ],
    "report_names": [
        "2021-07-01 - REvil’s new Linux version.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535945,
    "ts_updated_at": 1743041153,
    "ts_creation_date": 1653689836,
    "ts_modification_date": 1653689836,
    "files": {
        "pdf": "https://archive.orkl.eu/3ef0708949e74013b38420509279ae9401fae47f.pdf",
        "text": "https://archive.orkl.eu/3ef0708949e74013b38420509279ae9401fae47f.txt",
        "img": "https://archive.orkl.eu/3ef0708949e74013b38420509279ae9401fae47f.jpg"
    }
}