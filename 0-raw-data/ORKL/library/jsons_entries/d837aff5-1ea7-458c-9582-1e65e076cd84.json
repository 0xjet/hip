{
    "id": "d837aff5-1ea7-458c-9582-1e65e076cd84",
    "created_at": "2022-10-25T16:48:13.765907Z",
    "updated_at": "2025-03-27T02:09:18.378227Z",
    "deleted_at": null,
    "sha1_hash": "12830c1b1fd37b4be618466e09411a64cbd6359c",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-05-06T14:07:49Z",
    "file_modification_date": "2021-05-06T14:07:50Z",
    "file_size": 160034,
    "plain_text": "# Cobalt Strikes Out\n\n## Cisco Talos IR and SecureX team up with client to repel attack\n\n\nIn 2020, an employee at a publicly traded company with\nmore than $8 billion in revenue going through a merger and\nacquisition downloaded a malicious document containing\n[the commodity banking trojan Qakbot. Unfortunately, the](https://blog.talosintelligence.com/search/label/qakbot%22%20/)\nhost was configured to trust and enable macros on all Excel\ndocuments on the internet. Therefore, there was no warning\nof the macros’ existence before they were automatically\nexecuted. Shortly after downloading the maldoc, a user\nopened it and a macro attempted to download a payload\nfrom an actor-controlled URL. It was saved to the victim\nmachine and executed using a legitimate Windows\ncomponent: rundll32.exe.\n\nShortly afterward, the adversary used PowerShell to\ndownload penetration-testing tool Cobalt Strike onto the\nvictim machine. CTIR observed the adversary executing\nmultiple Cobalt Strike-encoded commands reaching out\nto their command and control (C2) over ports 80, 443 and\n8080. The adversary also engaged in some initial profiling\nand system discovery, using PowerShell to enumerate\nDomain Controllers on the domain, and the open-source\nActive Directory profiling tool Bloodhound to identify users\nand systems within the domain.\n\nShortly after Bloodhound was downloaded, a .JSON file\nwas created in a user’s Downloads folder, likely containing\nthe output of information about the users within the\ndomain from the Bloodhound execution. The adversaries\nthen dropped a Cobalt Strike executable on two Domain\nControllers and used open-source Active Directory profiling\ntool ADFind to enumerate other hosts. Similar to the\nBloodhound .JSON output file, the adversary also directed\nthe output of their AdFind enumeration commands into a\n.CSV file. The adversary later deleted this file.\n\nAnalysis of the Cobalt Strike beacons revealed they\nwere executed from the ADMIN$ share, such as “\\\nADMIN$\\9b0c536.exe,” suggesting this executable was\nexecuted remotely from another system. One of the Cobalt\nStrike payloads was also installed on a host as a service\nand executed — additional evidence of the adversary’s\nability to execute payloads remotely.\n\nCTIR observed the suspicious PowerShell activity in\ntheir SecureX telemetry, and sent a notification to the\n\n\ncustomer warning that the TTPs were consistent with\npre-ransomware activity. This alert contained the specific\nhostname and indicators observed in SecureX that\nindicated a Cobalt Strike beacon reaching out to a C2.\n\nAfter notification, CTIR began forensic analysis focusing\non three key systems including patient zero and the two\ncompromised Domain Controllers. CTIR was given access\nto the customer’s Cisco Secure Endpoint console to search\nfor malicious activity in the environment. CTIR then notified\nthe customer of the affected hosts which had activity\nrelated to this incident. All of the affected hosts had already\nbeen found and remediated by the customer’s team.\n\nThis customer had an existing IR Retainer with CTIR and\na strong relationship that was formed over extensive\npre-incident engagements and drills. Similar to the case\nabove, the customer’s alacrity in implementing CTIR\nrecommendations avoided a disastrous outcome. CTIR\nrecommendations included:\n\n### • Reimaging the patient zero endpoint to a known good\nimage with up-to-date patches installed, placed on a\nVLAN that cannot route to the infected VLAN to prevent\nreinfection.\n\n### • Credential reset, similar to the case above, to prevent\nreinfection of affected hosts.\n\n### • Issuing a Group Policy Object limiting macro execution\nin Microsoft Office documents, which would prevent a\nsimilar attack from leveraging that infection vector.\n\n### • Instituting multi-factor authentication for all critical\nservices to prevent remote-based compromise and\npost-compromise lateral movement.\n\n### • Issuing a Group Policy Object limiting the use of Win­\ndows utilities, such as PowerShell PSExec and Remote\nDesktop, to trusted accounts.\n\nThe collaborative, joint incident response between the\ncustomer’s IR team and CTIR led to a quick containment\nand full eradication of the active adversary in the\nenterprise IT environment that had the capability to deploy\nransomware to complete actions on objective.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://s3.amazonaws.com/talos-intelligence-site/production/document_files/files/000/095/542/original/CTIR_casestudy_2.pdf"
    ],
    "report_names": [
        "CTIR_casestudy_2.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1620310069,
    "ts_modification_date": 1620310070,
    "files": {
        "pdf": "https://archive.orkl.eu/12830c1b1fd37b4be618466e09411a64cbd6359c.pdf",
        "text": "https://archive.orkl.eu/12830c1b1fd37b4be618466e09411a64cbd6359c.txt",
        "img": "https://archive.orkl.eu/12830c1b1fd37b4be618466e09411a64cbd6359c.jpg"
    }
}