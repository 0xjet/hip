{
    "id": "0bf81667-6089-4934-b9f5-d2f09c9a8367",
    "created_at": "2022-10-25T16:48:25.194726Z",
    "updated_at": "2025-03-27T02:09:26.456562Z",
    "deleted_at": null,
    "sha1_hash": "3cf67c051ba29f706367860714b2c7ce56889ea6",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-01-07T08:07:45Z",
    "file_modification_date": "2021-01-07T08:07:45Z",
    "file_size": 338917,
    "plain_text": "# The Icefog APT Hits US Targets With Java Backdoor\n\n**[securelist.com/the-icefog-apt-hits-us-targets-with-java-backdoor/58209](https://securelist.com/the-icefog-apt-hits-us-targets-with-java-backdoor/58209/)**\n\nIn September 2013, we published our extensive analysis of Icefog, an APT campaign that\nfocused on the supply chain – targeting government institutions, military contractors,\nmaritime and ship-building groups.\n\nIcefog, also known as the “Dagger Panda” by Crowdstrike’s naming convention, infected\ntargets mainly in South Korea and Japan. You can find our Icefog APT analysis and\ndetailed report here.\n\nSince the publication of our report, the Icefog attackers went completely dark, shutting\ndown all known command-and-control servers. Nevertheless, we continued to monitor\nthe operation by sinkholing domains and analysing victim connections. During this\nmonitoring, we observed an interesting type of connection which seemed to indicate a\nJava version of Icefog, further to be referenced as “Javafog”.\n\n## Meet “Lingdona”\n\nThe Icefog operation has been operational since at least 2011, with many different\nvariants released during this time. For Microsoft Windows PCs, we identified at least 6\ndifferent generations:\n\nThe “old” 2011 Icefog – sends stolen data by e-mail; this version was used against\nthe Japanese House of Representatives and the House of Councillors in 2011.\nType “1” “normal” Icefog – interacts with command-and-control servers via a set of\n“.aspx” scripts.\nType “2” Icefog – interacts with a script-based proxy server that redirects\ncommands from the attackers to another machine.\n\n\n-----\n\nType 3 Icefog – a variant that uses a certain type of C&C server with scripts named\n“view.asp” and “update.asp”\nType “4” Icefog – a variant that uses a certain type of C&C server with scripts named\n“upfile.asp”\nIcefog-NG – communicates by direct TCP connection to port 5600\n\nIn addition to these, we also identified “Macfog”, a native Mac OS X implementation of\nIcefog that infected several hundred victims worldwide.\n\nBy correlating registration information for the different domains used by the malware\nsamples, we were able to identify 72 different command-and-control servers, of which we\nmanaged to sinkhole 27.\n\nOne interesting domain in particular was “lingdona[dot]com”, which expired in\nSeptember 2013 and we took over in October 2013. Here’s what the original contact\ninformation looked like:\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n\nDomain Name: LINGDONA.COM\n\nRegistrant Contact:\n\nlin ming hua\n\nlin ming kevistin@qq.com\n\ntelephone: +86.031185878412\n\nfax: +86.031185878412\n\nfuzhoushi Fuzhou Shi Fujian Sheng 412141\n\nCN\n\n\nThe domain was originally hosted in Hong Kong, at IP 206.161.216.214 and\n**103.20.195.140, and appeared suspicious because of the registration data, which**\nseemed to match other known Icefog domains. As soon as we sinkholed it, we observed a\nnumber of suspicious connections, almost every 10 seconds:\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n\n69.59.x.x www.lingdona.com - [26/Oct/2013:23:59:39 +0000] \"POST\n/news/latestnews.aspx?title=2.0_1593925273 HTTP/1.1\" 404 345 \"-\"\n\"Java/1.7.0_25\"\n\n69.59.x.x www.lingdona.com - [26/Oct/2013:23:59:45 +0000] \"POST\n/news/latestnews.aspx?title=2.0_1593925273 HTTP/1.1\" 404 345 \"-\"\n\"Java/1.7.0_25\"\n\n38.100.x.x www.lingdona.com - [26/Oct/2013:23:59:48 +0000] \"GET\n/news/latestnews.aspx?title=1.1_1254592001 HTTP/1.1\" 404 345 \"-\"\n\"Java/1.7.0_40\"\n\n38.100.x.x www.lingdona.com - [26/Oct/2013:23:59:58 +0000] \"GET\n/news/latestnews.aspx?title=1.1_1254592001 HTTP/1.1\" 404 345 \"-\"\n\"Java/1.7.0_40\"\n\n\nInterestingly, the User-Agent string indicated the client could be a Java application,\nhowever, this was unusual because all other Icefog variants used regular IE User-Agent\nstrings.\n\n## Finding the sample\n\nWhile we suspected there was a malware sample in the wild connecting to the domain\n“lingdona[dot]com”, we didn’t have a copy of that particular Icefog trojan.\n\nLuck seemed to strike when we came by a JSUNPACK submission that appeared quite\ninteresting.\n\nIn November 2012, someone submitted an interesting URL to the public JSUNPACK\nservice which was hosted on the “sejonng[dot]org” server, a known Icefog domain. It also\nappeared to reference “starwars123[dot]net”, another known Icefog domain.\n\n\n-----\n\nMost interestingly, the HTML page references a Java applet policyapplet.jar with a long\nhexadecimal string parameter named “jar”. Unfortunately, we were not able to recover the\n“policyapplet.jar” file, which was most likely a Java exploit. Decoding the hexadecimal\nstring, we found another Java applet with the following information:\n\n\n1\n\n2\n\n\nSize: 8697 bytes\n\nMD5: d26af487534c1d575e747ff240ee6357\n\n\nLater, we discovered the extracted applet was also uploaded to a virus scanning service\naround the same time.\n\n## The Javafog\n\nThe “jar” applet caught our attention so we analysed to determine how it works.\n\nThe JAR format uses ZIP compression to store the data in compact form. The ZIP header\nuses timestamps to track when files were added to the archive. This helps understanding\nwhen the JAR file could have been created. Here is ZIP directory information from the\napplet:\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n\nDate Time Attr Size Compressed Name\n\n---------- --- ------ ------ -----------\n2012-10-30 16:47:50 ..... 129 115 META-INF/MANIFEST.MF\n\n2012-10-30 16:47:50 ..... 259 206 META-INF/B8228E45.SF\n\n2012-10-30 16:47:50 ..... 5365 3610 META-INF/B8228E45.RSA\n\n2010-10-29 22:44:06 ..... 7726 4226 JavaTool.class\n\n\nThis means that the JAR file was most likely created on 30th November 2012, while the\nmain class JavaTool.class was compiled two years before that, on 29th November 2010.\n\nUpon startup, it tries to register itself as a startup entry to achieve persistence. The\nmodule writes a registry value to ensure it is automatically started by Windows:\n\n\n1\n\n2\n\n\n\n[HKEY_CURRENT_USERsoftwaremicrosoftwindowscurrentversionrun]\n\nJavaUpdate=%TEMP%update.jar\n\n\nIt is worth noting that the module does not copy itself to that location. It is possible that\nthe missing file “policyapplet.jar” contains the parts of the installation routine.\n\n\n-----\n\nNext, it enters a loop where it keeps calling its main C&C function, with a delay of\n1000ms. The main loop contacts the well known Icefog C&C server –\n“www.lingdona[dot]com/news” and interacts with it.\n\nFirst of all, it sends the full system information profile, which the attackers can use to\ndetermine if the victim is “interesting” or has any real value. Here’s a PCAP of the\nconversation:\n\n\n-----\n\nIn the screenshot above, “title=2.0_1651809722” indicates a unique victim ID that is\ncomputed by hashing the hostname. This can be used by the operators to uniquely\nidentify the victim and send commands to it.\n\nAs a reply to the uploaded system information, the backdoor expects an “order”, which\ncan have different values:\n\nCommand Description:\n\n**upload_* – Upload a local file specified after the command to the C&C server by**\nURL “%C&C server URL%/uploads/%file name%”. Uploaded data is encrypted with\na simple XOR operation with key 0x99.\n**cmd_UpdateDomain – Migrate to a new C&C server URL specified after the**\ncommand. The new URL is also written to the file “%TEMP%update.dat”\n**cmd_* – Execute the string specified after the command using “cmd.exe /c”. The**\nresults are uploaded to the C&C server by URL “%C&C server\nURL%/newsdetail.aspx?title=2.0_%host name%”.\nBesides the above, the backdoor doesn’t do much else. It allows the attackers to\ncontrol the infected system and download files from it. Simple, yet very effective.\n\n## Geography of victims\n\nOne might wonder what is the purpose of something like the Javafog backdoor. The truth\nis that even at the time of writing, detection for Javafog is extremely poor (3/47 on\nVirusTotal). Java malware is definitively not as popular as Windows PE malware, and can\n\n\n-----\n\nbe harder to spot.\n\nDuring the sinkholing operation for the “lingdona[dot]com” domain, we observed 8 IPs\nfor three unique victims of Javafog, all of them in the United States. Interestingly, during\nthe observation period, two of the victims updated the Java version from “Java/1.7.0_25”\nto “Java/1.7.0_45”.\n\nBased on the IP address, one of the victims was identified as a very large American\nindependent Oil and Gas corporation, with operations in many other countries.\n\nAs of today, all victims have been notified about the infections. Two of the victims have\nremoved it already.\n\n## Conclusions\n\nWith Javafog, we are turning yet another page in the Icefog story by discovering another\ngeneration of backdoors used by the attackers.\n\nIn one particular case, we observed the attack commencing by exploiting a Microsoft\nOffice vulnerability, followed by the attackers attempting to deploy and run Javafog, with\na different C&C. We can assume that based on their experience, the attackers found the\nJava backdoor to be more stealthy and harder to notice, making it more attractive for long\nterm operations. (Most Icefog operations being very short – the “hit and run” type).\n\nThe focus on the US targets associated with the only known Javafog C&C could indicate a\nUS-specific operation run by the Icefog attackers; one that was planned to take longer\nthan usual, such as, for instance, long term collection of intelligence on the target. This\nbrings another dimensions to the Icefog gang’s operations, which appear to be more\ndiverse than initially thought.\n\nThe Icefog APT Hits US Targets With Java Backdoor\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.01.14.Icefog_APT/securelist.com-The%20Icefog%20APT%20Hits%20US%20Targets%20With%20Java%20Backdoor.pdf"
    ],
    "report_names": [
        "securelist.com-The Icefog APT Hits US Targets With Java Backdoor"
    ],
    "threat_actors": [
        {
            "id": "5d9dfc61-6138-497a-b9da-33885539f19c",
            "created_at": "2022-10-25T16:07:23.720008Z",
            "updated_at": "2025-03-27T02:02:09.944484Z",
            "deleted_at": null,
            "main_name": "Icefog",
            "aliases": [
                "ATK 23",
                "Dagger Panda",
                "Icefog",
                "Red Wendigo"
            ],
            "source_name": "ETDA:Icefog",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Dagger Three",
                "Fucobha",
                "Icefog",
                "Javafog",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1aead86d-0c57-4e3b-b464-a69f6de20cde",
            "created_at": "2023-01-06T13:46:38.318176Z",
            "updated_at": "2025-03-27T02:00:02.803684Z",
            "deleted_at": null,
            "main_name": "DAGGER PANDA",
            "aliases": [
                "IceFog",
                "RedFoxtrot",
                "Red Wendigo",
                "PLA Unit 69010"
            ],
            "source_name": "MISPGALAXY:DAGGER PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716505,
    "ts_updated_at": 1743041366,
    "ts_creation_date": 1610006865,
    "ts_modification_date": 1610006865,
    "files": {
        "pdf": "https://archive.orkl.eu/3cf67c051ba29f706367860714b2c7ce56889ea6.pdf",
        "text": "https://archive.orkl.eu/3cf67c051ba29f706367860714b2c7ce56889ea6.txt",
        "img": "https://archive.orkl.eu/3cf67c051ba29f706367860714b2c7ce56889ea6.jpg"
    }
}