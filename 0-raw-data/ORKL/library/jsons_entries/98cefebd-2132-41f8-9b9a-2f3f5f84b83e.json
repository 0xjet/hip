{
    "id": "98cefebd-2132-41f8-9b9a-2f3f5f84b83e",
    "created_at": "2023-01-12T15:00:32.113422Z",
    "updated_at": "2025-03-27T02:15:26.139623Z",
    "deleted_at": null,
    "sha1_hash": "28987e455c154efb2f47af6d2b6ba19b8bd2d3f3",
    "title": "2021-12-16 - Noberus- Technical Analysis Shows Sophistication of New Rust-based Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T23:18:58Z",
    "file_modification_date": "2022-05-28T23:18:58Z",
    "file_size": 1120647,
    "plain_text": "# Noberus: Technical Analysis Shows Sophistication of New Rust-based Ransomware\n\n**[symantec-enterprise-blogs.security.com/blogs/threat-intelligence/noberus-blackcat-alphv-rust-ransomware](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/noberus-blackcat-alphv-rust-ransomware)**\n\nThreat Hunter TeamSymantec\n\n## New ransomware used in mid-November attack, ConnectWise was likely infection vector.\n\nSymantec’s Threat Hunter Team has additional technical information to share on the new\nALPHV/BlackCat ransomware that was first published about last week, and which we have been\ntracking for several weeks.\n\n[Symantec, a division of Broadcom Software, tracks this ransomware as Ransom.Noberus and our](https://software.broadcom.com/)\nresearchers first spotted it on a victim organization on November 18, 2021, with three variants of\nNoberus deployed by the attackers over the course of that attack. This would appear to show that\nthis ransomware was active earlier than was previously reported, with MalwareHunterTeam\n[having told BleepingComputer they first saw this ransomware on November 21.](https://www.bleepingcomputer.com/news/security/alphv-blackcat-this-years-most-sophisticated-ransomware/)\n\n\n-----\n\nNoberus is an interesting ransomware because it is coded in Rust, and this is the first time we\nhave seen a professional ransomware strain that has been used in real-world attacks coded in\nthis programming language. Noberus appears to carry out the now-typical double extortion\nransomware attacks where they first steal information from victim networks before encrypting\nfiles. Noberus adds the .sykffle extension to encrypted files.\n\nThis blog contains information about the attack chain we observed in one victim organization, as\nwell as technical details about the operation of this ransomware.\n\nThe first suspicious activity observed by Symantec occurred on a victim’s network on November\n3, approximately two weeks before Noberus was deployed. During this time, suspicious network\nactivity was observed. Later on November 18, shortly before Noberus was deployed,\nConnectWise was also executed. A few hours later, Noberus was deployed, indicating that the\nattackers may have leveraged access to ConnectWise to deploy their payload. While it is a\nlegitimate tool, ConnectWise has frequently been exploited by ransomware attackers in recent\ntimes to gain access to victim networks.\n\n## Anatomy of an attack\n\nOn November 3, suspicious Server Message Block (SMB) requests occurred on the earliest\nmachine to get infected on the victim network. This was followed by remote Local Security\nAuthority (LSA) registry dump attempts from a remote machine on the network. This suggests the\nattackers may have compromised another machine on the network where we didn't have visibility,\nor they could also have added a new machine to the domain from which they were launching\nattacks to dump credentials.\n\nOn the same day, PsExec was also executed from a remote machine to launch a command\nprompt. The attackers used this to disable a restricted remote administration feature known as\n‘RestrictedAdmin mode’ via the Windows registry. This effectively disables safeguards guarding\nagainst 'pass the hash' attacks targeting Remote Desktop Protocol (RDP), allowing the attackers\nto attempt to gain higher administrative privileges.\n\n_reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa /v DisableRestrictedAdmin /t_\n_REG_DWORD /d 0_\n\nThe next activity occurred on November 18 when PsExec was used to run multiple PowerShell\ncommands to effectively disable Windows Defender. Specifically, the PowerShell command used\nadded *.exe to an exclusion list for AV scanning, and this command was executed across the\nentire organization.\n\nLater on November 18, the first instance of Noberus ransomware was deployed via PsExec.\n\nIn order for Noberus to execute properly, it requires a specific ‘access-token’. This acts as a\nunique key, which is used to distinguish the victim when visiting the Noberus operators’ Tor site.\nThe following similar commands were observed being executed:\n\n\n-----\n\n_CSIDL_WINDOWS\\temp\\psexec.exe -accepteula \\\\[REDACTED] -u [REDACTED] -p_\n\n_[REDACTED] -s -d -f -c [REDACTED].exe --access-token [REDACTED] --no-prop-servers \\\\_\n\n[REDACTED] --propagated\n\n_[REDACTED].exe --access-token [REDACTED] --no-net_\n\nIn the above, PsExec is launched with the following specific command line arguments:\n\ns – Run under the System account\nd – Run as a non-interactive process (don’t wait for the process to terminate)\nf, c – Copy Noberus file to the remote machine\n\nFor the second command above, the ‘no-net’ command line argument instructs Noberus not to\nprocess network shares during propagation. See the Technical Details below for a full list of\nsupport command line arguments and their description.\n\nIn all the samples of Noberus that we have access to, the victim’s administrative credentials are\nembedded as part of the configuration block, showing that this attack was specifically targeted at\nthis victim.\n\nOnce Noberus is executed, the ransomware first deletes any available shadow copies, which is\ntypical in ransomware attacks, in order to stop the organization from restoring encrypted files.\n\n_cmd /c vssadmin.exe delete shadows /all /quiet_\n\nNoberus then runs commands to collect system information via WMIC, in order to collect\nUniversally Unique Identifiers (UUIDs) from each machine. These are then used to generate the\n‘access token’ that makes up part of the unique Tor address victims are instructed to visit.\n\n_Navigate to: http://mu75ltv3lxd24dbyu6gtvmnwybecigs5auki7fces437xvvflzva2nqd.onion/?_\n_access-key=${ACCESS_KEY}\"_\n\nWe also saw a fsutil command being executed by Noberus. Fsutil performs tasks that are related\nto file allocation table (FAT) and NTFS file systems. In this incident, the attacker is specifically\nmodifying the SymLink Evaluation behavior to modify the type of symbolic links that can be\ncreated on the system. Symbolic links create a file in your directory that acts as a shortcut to\nanother file or folder.\n\n_cmd /c fsutil behavior set SymlinkEvaluation R2L:1_\n_cmd /c fsutil behavior set SymlinkEvaluation R2R:1_\n\nThis is used to follow various types of shortcuts (local and remote), likely to ensure Noberus can\nfollow these shortcuts and perform encryption.\n\nAs part of the propagation mechanism, Noberus attempts to mount hidden partitions. It then\nattempts to spread via the ‘net use’ command. The embedded administrative credentials are used\nas part of this mechanism along with PsExec, which is embedded in a compressed form within\nNoberus.\n\n\n-----\n\nDuring the attack, the attackers were also seen modifying the maximum limit of concurrent\nrequests machines could make via PsExec.\n\n_cmd /c reg add_\n_HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters_\n_/v MaxMpxCt /d 65535 /t REG_DWORD /f_\n\nThis was likely to aid in the propagation of Noberus across the network.\n\nAt this stage, Noberus proceeds to terminate a set of pre-defined processes and begin the\nencryption process.\n\nAt some point during the attack the organization became aware of the infection and deployed\nremediation software. However, despite this, it appears the attackers were able to return and\ndeploy another variant of their ransomware to other systems on the network. In total, three\nvariants of this ransomware were identified during this intrusion, leading to at least 261 machines\non the network becoming infected with Noberus.\n\n## Ransom.Noberus: Technical Details\n\nA technical analysis of Noberus itself found that a lot of its behavior is consistent with the activity\nwe saw on the victim network.\n\nThe first step it takes after being deployed on victim networks is to remove shadow copies:\n\n_cmd /c vssadmin.exe delete shadows /all /quiet_\n\nIt then issues a command to collect Universally Unique Identifiers (UUIDs) from infected\nmachines.\n\n_cmd /c wmic csproduct get UUID_\n\nThe UUID and parameter ‘access token’ are then used to generate \"ACCESS_KEY\".\n\n_Navigate to: http://mu75ltv3lxd24dbyu6gtvmnwybecigs5auki7fces437xvvflzva2nqd.onion/?_\naccess-key=${ACCESS_KEY}\"\n\nNoberus then enables the remote-to-local and remote-to-remote symbolic link evaluations.\n\n_cmd /c fsutil behavior set SymlinkEvaluation R2L:1_\n_cmd /c fsutil behavior set SymlinkEvaluation R2R:1_\n\nIt then attempts to mount a hidden partition, by issuing the following commands:\n\n_Enumerates volumes by_\n\n_FindFirstVolume_\n_FindNextVolume_\n_FindVolumeClose_\n\n\n-----\n\n_Then gets the pathname by:_\n\n_GetVolumePathNamesForVolumeName_\n_If the volume does not have a pathname, Noberus mounts it with:_\n\n_SetVolumeMountPoint._\n\nNoberus then cleans up the Recycle Bin and attempts to propagate via network share.\n\nIt looks for available shares by using the ‘net use’ command or NetShareEnum function.\nEmbedded administrative credentials may then be used for propagation via network share.\n\nNoberus also attempts to propagate via PsExec.\n\n_locker::core::windows::psexec_\n\nThe PsExec module is embedded in the Noberus code (see Figure 1). It is compressed with zlib\n(Figure 2).\n\nFigure 1. PsExec embedded in ransomware code\n\n\n-----\n\nFigure 2. PsExec compressed by zlib in ransomware code\nThe decompressed PsExec file is a legitimate Microsoft-signed clean file (Figure 3).\n\nFigure 3. Decompressed PsExec file\n\n\n-----\n\nOnce it has gained access to a machine, Noberus then proceeds to kill the following processes\nand services:\n\n_\"encsvc\",\"thebat\",\"mydesktopqos\",\"xfssvccon\",\"firefox\",\"infopath\",\"winword\",\"steam\",\"synctime\",_\n_\"notepad\",\"ocomm\",\"onenote\",\"mspub\",\"thunderbird\",\"agntsvc\",\"sql\",\"excel\",\"powerpnt\",_\n_\"outlook\",\"wordpad\",\"dbeng50\",\"isqlplussvc\",\"sqbcoreservice\",\"oracle\",\"ocautoupds\",_\n_\"dbsnmp\",\"msaccess\",\"tbirdconfig\",\"ocssd\",\"mydesktopservice\",\"visio\", \"sql*\",_\n_\"mepocs\",\"memtas\",\"veeam\",\"svc$\",\"backup\",\"sql\",\"vss\",\"msexchange\"_\n\nIt also excludes certain directories, filenames, and file extensions from the encryption process,\nsuch as:\n\n_\"system volume information\",\"intel\",\"$windows.~ws\",\"application data\",\"$recycle.bin\",_\n_\"mozilla\",\"program files (x86)\",\"program_\n_files\",\"$windows.~bt\",\"public\",\"msocache\",\"windows\",\"default\",\"all users\", \"tor browser\",_\n_\"programdata\",\"boot\",\"config.msi\",\"google\",\"perflogs\",\"appdata\", \"windows.old\",_\n_\"desktop.ini\",\"autorun.inf\",\"ntldr\",\"bootsect.bak\",\"thumbs.db\",\"boot.ini\",\"ntuser.dat\",_\n_\"iconcache.db\",\"bootfont.bin\",\"ntuser.ini\",\"ntuser.dat.log\",\"themepack\",\"nls\",\"diagpkg\",_\n_\"msi\",\"lnk\",\"exe\",\"cab\",\"scr\",\"bat\",\"drv\",\"rtp\",\"msp\",\"prf\",\"msc\", \"ico\",_\n_\"key\",\"ocx\",\"diagcab\",\"diagcfg\",_\n_\"pdb\",\"wpx\",\"hlp\",\"icns\",\"rom\",\"dll\",\"msstyles\",\"mod\",\"ps1\",\"ics\",\"hta\",\"bin\",\"cmd\",\"ani\",_\n_\"386\",\"lock\",\"cur\",\"idx\",\"sys\",\"com\",\"deskthemepack\",\"shs\",\"ldf\",\"theme\",\"mpa\",\"nomedia\",_\n_\"spl\",\"cpl\",\"adv\",\"icl\",\"msu\"_\n\nNoberus then proceeds to encrypt files using either AES or ChaCha20 encryption.\n\nThe private key for encrypted machines appears to be generated randomly. It appears that\nNoberus generates a random number using BCryptGenRandom and calculates each byte with\nthe string shown in Figure 4.\n\nFigure 4. String used to calculate the private key\nFiles that have been encrypted have .sykffle appended to the end of their filename, in the\nfollowing format:\n\n_[original filename].[extension].sykffle_\n\nNoberus then creates a ransomware note, creating a .txt and a .png file that are displayed to\nvictims, with the following filenames:\n\n_RECOVER-sykffle-FILES.txt_\n_RECOVER-sykffle-FILES.txt.png_\n\nThe text file tells victims the following:\n\n\n-----\n\n_> Introduction_\n\n_Important files on your system was ENCRYPTED and now they have \"sykffle\" extension._\n\n_In order to recover your files you need to follow instructions below._\n\n_>> Sensitive Data_\n\n_Sensitive data on your system was DOWNLOADED and it will be PUBLISHED if you refuse to_\n_cooperate._\n\n_Data includes:_\n\n_- Employees personal data, CVs, DL, SSN._\n\n_- Complete network map including credentials for local and remote services._\n\n_- Financial information including clients’ data, bills, budgets, annual reports, bank statements._\n\n_- Complete datagrams/schemas/drawings for manufacturing in solidworks format_\n\n_- And more..._\n\n_Private preview is published here:_\n_http://zujgzbu5y64xbmvc42addp4lxkoosb4tslf5mehnh7pvqjpwxn5gokyd[.]onion/[REDACTED]_\n\n_>> CAUTION_\n\n_DO NOT MODIFY FILES YOURSELF._\n\n_DO NOT USE THIRD PARTY SOFTWARE TO RESTORE YOUR DATA._\n\n_YOU MAY DAMAGE YOUR FILES, IT WILL RESULT IN PERMANENT DATA LOSS._\n\n_YOUR DATA IS STRONGLY ENCRYPTED, YOU CAN NOT DECRYPT IT WITHOUT CIPHER_\n_KEY._\n\n_>> Recovery procedure_\n\n_Follow these simple steps to get in touch and recover your data:_\n\n_1) Download and install Tor Browser from: https://torproject.org/_\n\n_2) Navigate to: http://mu75ltv3lxd24dbyu6gtvmnwybecigs5auki7fces437xvvflzva2nqd[.]onion/?_\n_access-key=[REDACTED]_\n\nFigure 5. Noberus ransom note\n\n\n-----\n\n## Significance of this new ransomware\n\nThis is a sophisticated new ransomware with no apparent weaknesses in its encryption process,\nmeaning unless victims have comprehensive backups they will be obliged to pay the ransom to\nrecover their files. The fact it is written in Rust is interesting, as while Rust is not typically seen\nbeing used by malware developers, it is growing in popularity and it shows that ransomware\ndevelopers too are not afraid to innovate in this area.\n\nWhile the reported number of victims of this ransomware so far appears to be small, the\nsophistication of Noberus itself and the level of determination shown by the attackers in the attack\nwe did observe indicates it is likely we will see more of this ransomware in the future. It is also\nreported that the developers behind this ransomware are actively seeking affiliates on Russianspeaking hacking forums, meaning the number of malicious actors deploying this ransomware is\nlikely to grow.\n\n## Protection\n\n**File-based**\n\nRansom.Noberus\n\n[For the latest protection updates, please visit the Symantec Protection Bulletin.](https://www.broadcom.com/support/security-center/protection-bulletin)\n\nBroadcomSymantec Enterprise Blogs\nYou might also enjoy\n\nThreat Intelligence3 Min Read\n\n## Yanluowang: Further Insights on New Ransomware Threat\n\n### At least one attacker now using Yanluowang may have previously been linked to Thieflock ransomware operation.\n\n\n-----\n\n## About the Author\n\n### Threat Hunter Team\n\n**Symantec**\n\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to\ninvestigate targeted attacks, drive enhanced protection in Symantec products, and offer analysis\nthat helps customers respond to attacks.\n\n## Want to comment on this post?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-16 - Noberus- Technical Analysis Shows Sophistication of New Rust-based Ransomware.pdf"
    ],
    "report_names": [
        "2021-12-16 - Noberus- Technical Analysis Shows Sophistication of New Rust-based Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "6e23ce43-e1ab-46e3-9f80-76fccf77682b",
            "created_at": "2022-10-25T16:07:23.303713Z",
            "updated_at": "2025-03-27T02:02:09.727245Z",
            "deleted_at": null,
            "main_name": "ALPHV",
            "aliases": [
                "ALPHV",
                "ALPHVM",
                "BlackCat Gang",
                "UNC4466"
            ],
            "source_name": "ETDA:ALPHV",
            "tools": [
                "ALPHV",
                "ALPHVM",
                "BlackCat",
                "GO Simple Tunnel",
                "GOST",
                "Impacket",
                "LaZagne",
                "MEGAsync",
                "Mimikatz",
                "Munchkin",
                "Noberus",
                "PsExec",
                "Remcom",
                "RemoteCommandExecution",
                "WebBrowserPassView"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535632,
    "ts_updated_at": 1743041726,
    "ts_creation_date": 1653779938,
    "ts_modification_date": 1653779938,
    "files": {
        "pdf": "https://archive.orkl.eu/28987e455c154efb2f47af6d2b6ba19b8bd2d3f3.pdf",
        "text": "https://archive.orkl.eu/28987e455c154efb2f47af6d2b6ba19b8bd2d3f3.txt",
        "img": "https://archive.orkl.eu/28987e455c154efb2f47af6d2b6ba19b8bd2d3f3.jpg"
    }
}