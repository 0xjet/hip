{
    "id": "df0b720b-2194-4c84-b4ec-c2c47689f3a4",
    "created_at": "2023-01-12T15:06:56.652794Z",
    "updated_at": "2025-03-27T02:15:35.559359Z",
    "deleted_at": null,
    "sha1_hash": "55b32d5da7db4c7d6a47f19b05e53b99c2f685e5",
    "title": "2019-01-24 - Razy in search of cryptocurrency",
    "authors": "",
    "file_creation_date": "2022-05-29T01:17:26Z",
    "file_modification_date": "2022-05-29T01:17:26Z",
    "file_size": 1802121,
    "plain_text": "# Spoofing search results and infecting browser extensions\n\n**securelist.com/razy-in-search-of-cryptocurrency/89485/**\n\n[Research](https://securelist.com/category/research/)\n\n## Razy in search of cryptocurrency\n\n[Research](https://securelist.com/category/research/)\n\n24 Jan 2019\n\nminute read\n\n\n-----\n\nAuthors\n\n[Victoria Vlasova](https://securelist.com/author/victoria-vlasova/)\n\n[Vyacheslav Bogdanov](https://securelist.com/author/vyacheslavbogdanov/)\n\nLast year, we discovered malware that installs a malicious browser extension on its victim’s computer or infects\nan already installed extension. To do so, it disables the integrity check for installed extensions and automatic\nupdates for the targeted browser. Kaspersky Lab products detect the malicious program as\nTrojan.Win32.Razy.gen – an executable file that spreads via advertising blocks on websites and is distributed\nfrom free file-hosting services under the guise of legitimate software.\n\nRazy serves several purposes, mostly related to the theft of cryptocurrency. Its main tool is the script main.js\nthat is capable of:\n\nSearching for addresses of cryptocurrency wallets on websites and replacing them with the threat actor’s\nwallet addresses\nSpoofing images of QR codes pointing to wallets\nModifying the web pages of cryptocurrency exchanges\nSpoofing Google and Yandex search results\n\n## Infection\n\nThe Trojan Razy ‘works’ with Google Chrome, Mozilla Firefox and Yandex Browser, though it has different\ninfection scenarios for each browser type.\n\n**Mozilla Firefox**\n\n\n-----\n\nFor Firefox, the Trojan installs an extension called Firefox Protection with the ID {ab10d63e 3096 4492 ab0e\n5edcf4baf988} (folder path: “%APPDATA%\\Mozilla\\Firefox\\Profiles\\.default\\Extensions\\{ab10d63e-3096-4492ab0e-5edcf4baf988}”).\n\nFor the malicious extension to start working, Razy edits the following files:\n\n“%APPDATA%\\Mozilla\\Firefox\\Profiles\\.default\\prefs.js”,\n“%APPDATA%\\Mozilla\\Firefox\\Profiles\\.default\\extensions.json”,\n“%PROGRAMFILES%\\Mozilla Firefox\\omni.js”.\n\n**Yandex Browser**\n\nThe Trojan edits the file ‘%APPDATA%\\Yandex\\YandexBrowser\\Application\\\\browser.dll’ to disable extension\nintegrity check. It renames the original file ‘browser.dll_’ and leaves it in the same folder.\n\nTo disable browser updates, it creates the registry key\n‘HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\YandexBrowser\\UpdateAllowed” = 0 (REG_DWORD).\n\nThen the extension Yandex Protect is installed to folder ‘%APPDATA%\\Yandex\\YandexBrowser\\User\nData\\Default\\Extensions\\acgimceffoceigocablmjdpebeodphgc\\6.1.6_0’. The ID\nacgimceffoceigocablmjdpebeodphgc corresponds to a legitimate extension for Chrome called Cloudy\nCalculator, version 6.1.6_0. If this extension has already been installed on the user’s device in Yandex Browser,\nit is replaced with the malicious Yandex Protect.\n\n**Google Chrome**\n\nRazy edits the file ‘%PROGRAMFILES%\\Google\\Chrome\\Application\\\\chrome.dll’ to disable the extension\nintegrity check. It renames the original chrome.dll file chrome.dll_ and leaves it in the same folder.\n\nIt creates the following registry keys to disable browser updates:\n\n“HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Google\\Update\\AutoUpdateCheckPeriodMinutes” = 0\n(REG_DWORD)\n“HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Google\\Update\\DisableAutoUpdateChecksCheckboxValue”\n= 1 (REG_DWORD)\n“HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Google\\Update\\InstallDefault” = 0 (REG_DWORD)\n“HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Google\\Update\\UpdateDefault” = 0 (REG_DWORD)\n\nWe have encountered cases where different Chrome extensions were infected. One extension in particular is\n[worth mentioning: Chrome Media Router is a component of the service with the same name in browsers based](http://www.chromium.org/developers/design-documents/media-router)\non Chromium. It is present on all devices where the Chrome browser is installed, although it is not shown in the\nlist of installed extensions. During the infection, Razy modified the contents of the folder where the Chrome\nMedia Router extension was located: ‘%userprofile%\\AppData\\Local\\Google\\Chrome\\User\nData\\Default\\Extensions\\pkedcjkdefgpdelpbcmbmeomcjbeemfm’.\n\n## Scripts used\n\nIrrespective of the targeted browser type, Razy added the following scripts it brought along to the folder\ncontaining the malicious script: bgs.js, extab.js, firebase-app.js, firebase-messaging.js and firebase-messaging_sw.js. The file manifest.json was created in the same folder or was overwritten to ensure these scripts get_\ncalled.\n\n\n-----\n\n_Left: list of files of the original Chrome Media Router extension._\n\n_Right: list of files of the modified Chrome Media Router extension._\n\nThe scripts firebase-app.js, firebase-messaging.js and firebase-messaging-sw.js are legitimate. They belong to\nthe Firebase platform and are used to send statistics to the malicious actor’s Firebase account.\n\nThe scripts bgs.js and extab.js are malicious and are obfuscated with the help of the tool obfuscator.io. The\nformer sends statistics to the Firebase account; the latter (extab.js) inserts a call to the script i.js with\nparameters tag=&did=&v_tag=&k_tag= into each page visited by the user.\n\nIn the above example, the script i.js is distributed from the web resource gigafilesnote[.]com\n(gigafilesnote[.]com/i.js?tag=&did=&v_tag=&k_tag=). In other cases, similar scripts were detected in the\ndomains apiscr[.]com, happybizpromo[.]com and archivepoisk-zone[.]info.\n\nThe script i.js modifies the HTML page, inserts advertising banners and video clips, and adds adverts into\nGoogle search results.\n\n\n-----\n\n_YouTube page with banners added by the script i.js_\n\nThe culmination of the infection is main.js – a call to the script is added to each page visited by the user.\n\n_Fragment of the script i.js code that inserts the script main.js to web pages._\n\nThe script main.js is distributed from the addresses:\n\nNolkbacteria[.]info/js/main.js?_=\n2searea0[.]info/js/main.js?_=\ntouristsila1[.]info/js/main.js?_=\nsolkoptions[.]host/js/main.js?_=\n\nThe script main.js is not obfuscated and its capabilities can be seen from the function names.\n\n\n-----\n\nThe screenshot above shows the function findAndReplaceWalletAddresses that searches for Bitcoin and\nEthereum wallets and replaces them with the addresses of the threat actor’s wallets. Notably, this function\nworks on almost all pages except those located on Google and Yandex domains, as well as on popular\ndomains like instagram.com and ok.ru.\n\nImages of QR codes that point to wallets also get substituted. The substitution occurs when the user visits the\nweb resources gdax.com, pro.coinbase.com, exmo.*, binance.* or when an element with\nsrc=’/res/exchangebox/qrcode/’ is detected on the webpage.\n\nAs well as the functionality described above, main.js modifies the webpages of the cryptocurrency exchanges\nEXMO and YoBit. The following script calls are added to the pages’ codes:\n\n/js/exmo-futures.js?_= – when exmo.*/ru/* pages are visited\n/js/yobit-futures.js?_= – when yobit.*/ru/* pages are visited\n\nwhere is one of the domains nolkbacteria[.]info, 2searea0[.]info, touristsila1[.]info, or archivepoisk-zone[.]info.\n\nThese scripts display fake messages to the user about “new features” in the corresponding exchanges and\noffers to sell cryptocurrency at above market rates. In other words, users are persuaded to transfer their money\nto the cybercriminal’s wallet under the pretext of a good deal.\n\n\n-----\n\n_Example of a scam message on the EXMO website_\n\n_Main.js also spoofs Google and Yandex search results. Fake search results are added to pages if the search_\nrequest search request is connected with cryptocurrencies and cryptocurrency exchanges, or just music\ndownloading or torrents:\n\n/(?:^|\\s)(gram|телеграм|токен|ton|ico|telegram|btc|биткойн|bitcoin|coinbase|крипта|\nкриптовалюта|,bnrjqy|биржа|бираж)(?:\\s|$)/g;\n/(скачать.*музык|музык.*скачать)/g;\n/тор?рент/g;\n\nThis is how an infected user is enticed to visit infected websites or legitimate cryptocurrency-themed sites\nwhere they will see the message described above.\n\n\n-----\n\n_Google search results that were modified by the infected extension_\n\nWhen the user visits Wikipedia, main.js adds a banner containing a request for donations to support the online\nencyclopedia. The cybercriminals’ wallet addresses are used in place of bank details. The original Wikipedia\nbanner asking for donations (if present) is deleted.\n\n_Fake banner on Wikipedia asking for donations_\n\n\n-----\n\nWhen the user visits the webpage telegram.org, they will see an offer to buy Telegram tokens at an incredibly\nlow price.\n\n_The infected extension loads content on the telegram.org site from the phishing web resource ton-ico[.]network_\n\n_Fake banner shown at telegram.org. The link leads to the phishing website ton-ico[.]network_\n\nWhen users visit the pages of Russian social network Vkontakte (VK), the Trojan adds an advertising banner to\nit. If a user clicks on the banner, they are redirected to phishing resources (located on the domain ooo_ooo[.]info), where they are prompted to pay a small sum of money now to make a load of money later on._\n\n\n-----\n\n_Fraudulent banner on the vk.com website_\n\n## Indicators of compromise\n\nKaspersky Lab’s products detect scripts associated with Razy as HEUR:Trojan.Script.Generic.\n\nBelow are all the wallet addresses detected in the analyzed scripts:\n\nBitcoin: ‘1BcJZis6Hu2a7mkcrKxRYxXmz6fMpsAN3L’, ‘1CZVki6tqgu2t4ACk84voVpnGpQZMAVzWq’,\n‘3KgyGrCiMRpXTihZWY1yZiXnL46KUBzMEY’, ‘1DgjRqs9SwhyuKe8KSMkE1Jjrs59VZhNyj’,\n’35muZpFLAQcxjDFDsMrSVPc8WbTxw3TTMC’, ’34pzTteax2EGvrjw3wNMxaPi6misyaWLeJ’.\nEthereum: ’33a7305aE6B77f3810364e89821E9B22e6a22d43′,\n‘2571B96E2d75b7EC617Fdd83b9e85370E833b3b1′,\n’78f7cb5D4750557656f5220A86Bc4FD2C85Ed9a3’.\n\nAt the time of writing, total incoming transactions on all these wallets amounted to approximately 0.14 BTC plus\n25 ETH.\n\n**MD5**\n\n**Trojan.Win32.Razy.gen**\n\n707CA7A72056E397CA9627948125567A\n\n2C274560900BA355EE9B5D35ABC30EF6\n\nBAC320AC63BD289D601441792108A90C\n\n90A83F3B63007D664E6231AA3BC6BD72\n\n66DA07F84661FCB5E659E746B2D7FCCD\n\n**Main.js**\n\n2C95C42C455C3F6F3BD4DC0853D4CC00\n\n2C22FED85DDA6907EE8A39DD12A230CF\n\n**i.js**\n\n387CADA4171E705674B9D9B5BF0A859C\n\n67D6CB79955488B709D277DD0B76E6D3\n\n**Extab.js**\n\n60CB973675C57BDD6B5C5D46EF372475\n\n**Bgs.js**\n\nF9EF0D18B04DC9E2F9BA07495AE1189C\n\n**Malicious domains**\n\ngigafilesnote[.]com\n\napiscr[.]com,\n\nhappybizpromo[.]com,\n\n\n-----\n\narchivepoisk zone[.]info,\narchivepoisk[.]info,\nnolkbacteria[.]info,\n2searea0[.]info,\ntouristsila1[.]info,\ntouristsworl[.]xyz,\nsolkoptions[.]host.\nsolkoptions[.]site\nmirnorea11[.]xyz,\nmiroreal[.]xyz,\nanhubnew[.]info,\nkidpassave[.]xyz\n\n**Phishing domains**\n\nton-ico[.]network,\n\nooo-ooo[.]info.\n\n[Adware](https://securelist.com/tag/adware/)\n[Browser Plugins](https://securelist.com/tag/browser-plugins/)\n[Cryptocurrencies](https://securelist.com/tag/cryptocurrencies/)\n[JavaScript](https://securelist.com/tag/javascript/)\n[spoofing](https://securelist.com/tag/spoofing/)\n\nAuthors\n\n[Victoria Vlasova](https://securelist.com/author/victoria-vlasova/)\n\n[Vyacheslav Bogdanov](https://securelist.com/author/vyacheslavbogdanov/)\n\nRazy in search of cryptocurrency\n\nYour email address will not be published. Required fields are marked *\n\nGReAT webinars\n\nFrom the same authors\n\n\n-----\n\n### Web skimming with Google Analytics\n\n A MitM extension for Chrome\n\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-01-24 - Razy in search of cryptocurrency.pdf"
    ],
    "report_names": [
        "2019-01-24 - Razy in search of cryptocurrency.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536016,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1653787046,
    "ts_modification_date": 1653787046,
    "files": {
        "pdf": "https://archive.orkl.eu/55b32d5da7db4c7d6a47f19b05e53b99c2f685e5.pdf",
        "text": "https://archive.orkl.eu/55b32d5da7db4c7d6a47f19b05e53b99c2f685e5.txt",
        "img": "https://archive.orkl.eu/55b32d5da7db4c7d6a47f19b05e53b99c2f685e5.jpg"
    }
}