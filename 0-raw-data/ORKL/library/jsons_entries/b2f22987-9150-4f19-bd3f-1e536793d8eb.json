{
    "id": "b2f22987-9150-4f19-bd3f-1e536793d8eb",
    "created_at": "2022-10-25T16:48:10.864404Z",
    "updated_at": "2025-03-27T02:15:38.083764Z",
    "deleted_at": null,
    "sha1_hash": "3aaa08c08ae5f7adadadc35a1e4302dc943be6c2",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-05-29T09:03:29Z",
    "file_modification_date": "2019-05-29T09:03:29Z",
    "file_size": 1530398,
    "plain_text": "# TA505 is Expanding its Operations\n\n**[blog.yoroi.company/research/ta505-is-expanding-its-operations](https://blog.yoroi.company/research/ta505-is-expanding-its-operations/)**\n\nZLAB-YOROI May 29, 2019\n\n## Introduction\n\nIn the last few days, during monitoring activities, Yoroi CERT noticed a suspicious attack\nagainst an Italian organization. The malicious email contains a highly suspicious sample\nwhich triggered the ZLAB team to investigate its capabilities and its possible attribution,\ndiscovering a potential expansion of the TA505 operation. The threat group is also\nknown for its recent attack campaign against Bank and Retail business sectors, but the\nlatest evidence indicates a potential expansion of its criminal operation to other\nindustries too.\n\n## Technical Analysis\n\n**Hash** 0c88e285b6fc183c96b6f03ca5700cc9ca7c83dfccc6ad14a946d1868d1cc273\n\n**Threat** Dropper\n\n\n**Brief**\n**Descrip‐**\n**tion**\n\n\nExcel file with malicious macro\n\n\n**Ssdeep** 3072:Mc38TehYTdeHVhjqabWHLtyeGxml8/dgzxXYhh3vVYwrq\n8/P5HKuPF1+bkm13Kkf:B38TehYTdeHVhjqabWHLty/xml8/dgNr\n\n_Table 1. Information about initial dropper_\n\nThe intercepted attack starts with a spear phishing email embedding a spreadsheet. The\ndocument is weaponized with malicious macro code triggered when the user opens the\ndocument to see the content under the obfuscated view.\n\n\n-----\n\nFigure 1. XLS document\n\nTo understand its capabilities, the macro code has been isolated and analyzed in detail.\nPart of the macro’s content is shown in the following figure.\n\n\n-----\n\nFigure 2. Part of extracted macro\n\n\n-----\n\nSurprisingly, the source code is composed by more than 1600 lines of code and it is\nhighly obfuscated. Paying more attention during the code analysis, we discovered that it\nis full of junk instructions used to declare and initialize variables never used, as shown in\nFigure 2. Only a small portion of this code is actually used to start the infection, the rest\nis just junk code.\n\nFigure 3. Example of junk instructions used in macro\n\nOnce the macro is executed, the malware downloads two files from “kentona[.su”, using\nan SSL encrypted communication, and stores them in “C:\\Users\\Public” path:\n“rtegre.exe” and “wprgxyeqd79.exe”.\n\n**Hash** aafa83d5e0619e69e64fcac4626cfb298baac54c7251f479721df1c2eb16bee7\n\n**Threat** Generic\n\n\n**Brief**\n**Descrip‐**\n**tion**\n\n\nTrojan/Downloader (Executable file)\n\n\n**Ssdeep** 12288:3gL3qJxG5hfNV6oYYbDRcY4KhbmwPMCchbjBxwhrVm\nHAyzNkyRJK7hRMCQ:3mqkhfzYZY4kmgsbdm2HAENk0K7Dm\n\n_Table 2. Information about “rtegre.exe” downloaded from “kentona[.su”_\n\n\n-----\n\n**Hash** 6f1a8ee627ec2ed7e1d818d32a34a163416938e‐\nb13a97783a71f9b79843a80a2\n\n**Threat** Trojan\n\n\n**Brief**\n**Descrip‐**\n**tion**\n\n\nSFX (self-extracting archive) (Executable file)\n\n\n**Ssdeep** 49152:sIWB74MncmEWy4i1LkjoAwG2PI/mfqtftvMKcr+7Ao95\nxQW1vB38PELaacVzWTV3:sICtHsJoMAwG\n\n_Table 3. Information about “wprgxyeqd79.exe” (SFX) downloaded from “kentona[.su”_\n\n\nThe “wprgxyeqd79.exe” sample\nactually is a Self Extracting\nArchive (SFX/SFA) containing\nfour files designed to be\nextracted in the %TEMP%\nfolder. After that, it executes\n“exit.exe” which launches the\n“i.cmd” batch script.\n\n\nFigure 4. Files contained\nin “wprgxyeqd79.exe”\n(SFX)\n\n\nFigure 5. “i.cmd” script contained in “pasmmm.exe”\n\nThis new script performs a ping to “www[.cloudflare[.com” for three times with a delay of\n3000ms, testing the connectivity of the victim machine. If the host is successfully\nreached, the script renames a file named “kernel.dll”, obviously not the real one, in\n“uninstall.exe”, another misleading name. Then it invokes the renamed executable and\nruns it passing a series of parameter: “uninstall.exe x -pQELRatcwbU2EJ5 -y”\n\nThese parameters are needed to self-decrypt the “uninstall.exe” file which is again\nanother SFX archive. The “-p” parameter, indeed, specify the password of the archive to\nbe extracted. The crucial file, at this point of the infection, is the SFX executable named\n“uninstall.exe”. It has a structure similar to previous “wprgxyeqd79.exe” file: two of their\nfiles have the same name, but the content of this new SFX is extracted in the\n_“%ALLUSERSPROFILE%\\Windows Anytime Upgrade” directory._\n\n\n-----\n\nFigure 6. Files contained in “uninstall.exe” (SFX)\n\nAnother time, the execution flow moves from “exit.exe to “i.cmd”. The script is quite\ndifferent from the previous one: it guarantees its persistence on the victim machine\nthrough the setting of “HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run” registry\nkey, creating a new entry named “Windows Anytime Upgrade” which points to\n_“winserv.exe”, just stored into the same folder. Thus, the script provides to run_\n_“winserv.exe”._\n\nFigure 7. “i.cmd” script contained in “uninstall.exe”\n\nAn interesting part of the script is the continuous killing of every “rundll32.exe” process\nrunning into the victim machine, generates a huge amount of noise, as visible in the\nfollowing process explorer view.\n\n_:Repeat_\n\n_taskkill /f /im “rundll32.exe” || goto :Repeat_\n\n\n-----\n\nFigure 8. List of malware’s processes\n\nAnyway, just before the kill loop, the real malicious payload is executed: the\n“winserv.exe” file. Analyzing it in depth, we discover it actually is the RMS (Remote\nManipulator System) client by [TektonIT, encrypted using the](https://rmansys.ru/support/news/release_5-0/) [MPress PE compressor](http://www.matcode.com/mpress.htm)\nutility, a legitimate tool, to avoid antivirus detection.\n\nFigure 9. Information about MPress packer used in “winserv.exe” payload\n\nTektonIT RMS acts as a remote administration tool, allowing the attacker to gain\ncomplete access to the victim machine. Together with the RMS executable, there is\nanother file named “settings.dat” containing the custom configuration prepared by the\nattacker. It contains information like:\n\nServer address and port the client will connect to\nThe password chosen by the attacker for the remote access\nThe ID associated to the victim client\n\n\n-----\n\nAll these information are automatically loaded by the RMS executable and firstly stored\nin the registry key “HKCU\\Software\\tektonik\\Remote MANIPULATOR\n_System\\Host\\parameters”. At the next startup, the software will directly load the_\nconfiguration from the just created key.\n\nFigure 10. Registry key set by “winserv.exe” (on the left); “settings.dat” file (on the right)\n\nThe client establishes a new connection with the remote command and control server\nhosted on a Bulgarian remote host 217.12.201.159, part of a Virtual Dedicated Server\nsubnet of the AS-21100, operated by ITL LLC.\n\nFigure 11. C2’s parameters\n\nThe attack is composed by a complex flow we synthesize in the following scheme:\n\n\n-----\n\nFigure 12. Complete infection chain\n\n### The TA505 Connection\n\nAfter the reconstruction of the full infection chain, we noticed strong similarities with a\nrecent spear-phishing attack campaign against an unspecified US retail company. The\nattack, as stated by [CyberInt, leveraged a command and control server located in](https://e.cyberint.com/hubfs/Report%20Legit%20Remote%20Access%20Tools%20Turn%20Into%20Threat%20Actors%20Tools/CyberInt_Legit%20Remote%20Access%20Tools%20Turn%20Into%20Threat%20Actors%27%20Tools_Report.pdf)\nGermany related to the TA505 actor: a very active group involved in cyber-criminal\noperation all around the world, threatening a wide range of high profile companies,\nactive since 2014.\n\n\n-----\n\nFigure 13. Comparison between infection chains\n\nThe comparison of the infection chains reveals in both cases the attacker used a couple\nof SFX stages to deploy the “RMS” software: a legitimate remote administration tool\nproduced by the Russian company “TektonIT”. The tool is able to grant remote access\nand full, direct control of the infected machine to the group. Also, some code pieces are\ndirectly re-used in the analyzed campaigns, such as the “i.cmd” and “exit.exe” files, and,\nat the same time, some new components have been introduced, for instance the\n_“rtegre.exe” and the “veter1605_MAPS_10cr0.exe” file._\n\nDuring the analysis, we also noticed the “veter1605_MAPS_10cr0.exe” file slightly\nchanged run after run, a few hours after the initial discovery the infection chain dropped\nit with different icons, different suffix, from “cr0” to “cr24”, and appendix from\n“veter1605_” to “veter2005_”. This may indicate the campaign is still ongoing.\n\n## Conclusion\n\nThe TA505 group is one of the most active threat groups operating since 2014, it has\ntraditionally targeted Banking and Retail industries, as we recently documented during\n[the analysis of the “Stealthy Email Stealer” part of their arsenal. The peculiarity of this](https://blog.yoroi.company/research/the-stealthy-email-stealer-in-the-ta505-arsenal/)\nrecent attack wave is it actually hit a company not strictly in the Banking or Retail sector,\nas they recently did, suggesting the threat group could be potentially widening their\ncurrent operations.\n\n## Indicators of Compromise\n\n\n-----\n\nDropurl:\n\nkentona[.su – 47.245.58.124\nhxxps://kentona[.su/xpepriubgpokejifuv7efrhguskdgfjn/ananas.exe\nhxxps://kentona[.su/xpepriubgpokejifuv7efrhguskdgfjn/pasmmm.exe\nC2:\n\n217[.12.201.159\nPersistence:\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nHash:\n\n0c88e285b6fc183c96b6f03ca5700cc9ca7c83dfccc6ad14a946d1868d1cc273\n1ee1ba514212f11a69d002005dfc623b1871cc808f18ddfa2191102bbb9f623b\nfd701894e7ec8d8319bc9b32bba5892b11bdf608c3d04c2f18eff83419eb6df0\nc69ce39ac3e178a89076136af7418c6cb664844b0ce5cb643912ed56c373a08a\n5310c2397ba4c783f7ee9724711a6da9b5c603b5c9781fff3407b46725e338b3\naafa83d5e0619e69e64fcac4626cfb298baac54c7251f479721df1c2eb16bee7\n210bb55664d291d82b94b9cea6fcf41029eded9eca6e7fe7b7d58715407a0703\n2b5eefc4bc2d34cbe5093332c47b5405cf5c32e8156767fc8bc9ddd9cdcf3018\n609b0a416f9b16a6df9b967dc32cd739402af31566e019a8fb8abdf3cb573e30\n6f1a8ee627ec2ed7e1d818d32a34a163416938eb13a97783a71f9b79843a80a2\n\n### Yara Rules\n\n\n-----\n\nrule excel_dropper {\nmeta:\ndescription = \"Yara rule for excel dropper\"\nauthor = \"Cybaze - Yoroi ZLab\"\nlast_updated = \"2019-05-22\"\ntlp = \"white\"\ncategory = \"informational\"\nstrings:\n$a1 = { 98 C3 AB F0 E7 F3 BD F4 }\n$a2 = { 41 6E D5 7E F0 10 AB A7 }\n$a3 = \"gxbgarjktzyu\"\n$a4 = \"Bob Brown\"\n\ncondition:\nall of them\n}\n\nimport \"pe\"\nrule pasmmm_exe {\nmeta:\ndescription = \"Yara rule for pasmmm SFX archive\"\nauthor = \"Cybaze - Yoroi ZLab\"\nlast_updated = \"2019-05-22\"\ntlp = \"white\"\ncategory = \"informational\"\nstrings:\n$a1 = { 1C Cf 43 39 C8 32 B4 B0 }\n$a2 = { 60 6C B8 7C 5F FA }\n$a3 = \"LookupPrivilege\"\n$a4 = \"LoadBitmap\"\n\ncondition:\npe.number_of_sections == 6 and all of them\n}\n\nimport \"pe\"\nrule uninstall_exe {\nmeta:\ndescription = \"Yara rule for uninstall SFX archive\"\nauthor = \"Cybaze - Yoroi ZLab\"\nlast_updated = \"2019-05-22\"\ntlp = \"white\"\ncategory = \"informational\"\nstrings:\n$a1 = { E8 68 BA 01 00 51 }\n$a2 = { 58 E9 8B C6 4F 6F 7A }\n$a3 = { D9 4E D5 FA D4 34 }\n\ncondition:\npe.number_of_resources == 24 and all of them\n}\n\nimport \"pe\"\nrule winserv_exe {\nmeta:\ndescription = \"Yara rule for winserv backdoor\"\nauthor = \"Cybaze - Yoroi ZLab\"\nlast_updated = \"2019-05-22\"\ntlp = \"white\"\n\n\n-----\n\ncategory informational\nstrings:\n$a1 = \"MPRESS1\"\n$a2 = { 90 C4 73 05 E6 92 }\n$a3 = { E9 64 4B 56 3F EC }\n$a4 = { 10 EF D0 E1 36 E1 14 3C }\n\ncondition:\nall of them and pe.version_info[\"CompanyName\"] contains \"tox\"\n}\n\nimport \"pe\"\nrule veter_random {\nmeta:\ndescription = \"Yara rule for veter_trojan\"\nauthor = \"Cybaze - Yoroi ZLab\"\nlast_updated = \"2019-05-22\"\ntlp = \"white\"\ncategory = \"informational\"\nstrings:\n$a = { 5E C2 04 00 F6 44 24 04 01 56 }\n\n$b1 = { 01 8B 02 8B 48 04 03}\n$b2 = { 4A 3B C2 7E 08 8B C2 }\n\n$c1 = { E8 83 CA 04 89 55 E8 }\n$c2 = { 1F DF 70 07 22 84 82 }\n\ncondition:\n$a and (($b1 and $b2 and pe.version_info[\"CompanyName\"] contains \"Miranda\")\nor ($c1 and $c2 and pe.version_info[\"InternalName\"] contains \"DrldwgRom\"))\n}\n\n_This blog post was authored by Davide Testa, Antonio Farina and Luca Mella of Cybaze-_\n_Yoroi Z-LAB_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.05.29.TA505/TA505%20is%20Expanding%20its%20Operations.pdf"
    ],
    "report_names": [
        "TA505 is Expanding its Operations"
    ],
    "threat_actors": [
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716490,
    "ts_updated_at": 1743041738,
    "ts_creation_date": 1559120609,
    "ts_modification_date": 1559120609,
    "files": {
        "pdf": "https://archive.orkl.eu/3aaa08c08ae5f7adadadc35a1e4302dc943be6c2.pdf",
        "text": "https://archive.orkl.eu/3aaa08c08ae5f7adadadc35a1e4302dc943be6c2.txt",
        "img": "https://archive.orkl.eu/3aaa08c08ae5f7adadadc35a1e4302dc943be6c2.jpg"
    }
}