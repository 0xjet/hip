{
    "id": "8040dd82-4643-4acc-949a-4cf83e8e0ea4",
    "created_at": "2023-02-10T02:07:19.505569Z",
    "updated_at": "2025-03-27T02:14:45.075625Z",
    "deleted_at": null,
    "sha1_hash": "b5235b49985c0f2cc4619a126d53372bb5e697ad",
    "title": "",
    "authors": "",
    "file_creation_date": "2023-01-16T11:14:18Z",
    "file_modification_date": "2023-01-16T11:14:18Z",
    "file_size": 1428107,
    "plain_text": "# Panda Goes Full Global\n\n##### How MustangPanda refuses to abandon PlugX\n\n###### Still Hsu\n\n\n-----\n\n### whoami\n\n###### Still Hsu / Azaka Sekai 安坂星海\n Threat Intelligence Researcher @ TeamT5 Topic of interest\n .NET Windows Gaming & malware reverse engineering Non-binary (they/them)\n\n\n-----\n\n### Disclaimer\n\n###### Collaborated research with Sean Sabo @ Recorded Future\n\n\n-----\n\n## History\n\n\n-----\n\n### History Lesson Time!\n\n Polaris (better known as MustangPanda)\n\n###### has been active since 2011.\n\n China-based APT group\n\n\n Highly interested in antique infection\n\n###### methods via USB devices (especially post- 2019) or third-party web hosts.\n\n Previously focused its campaigns on\n\n###### (South) East Asian territories\n\n Myanmar\n\n Mongolia\n\n Philippines\n\n Japan\n\n …many more\n\n\n-----\n\n### History Lesson Time!\n\n Polaris loves using PlugX and refuses to\n\n###### abandon it.\n\n Various PlugX variants were developed\n\n###### over the years\n\n PlugX Fast\n\n “THOR” variant\n\n PlugDisk\n\n PlugX + UDiskShell/USB infection ability\n\n MiniPlug\n\n Miniaturized/rewrite version of PlugX\n\n we’ll get to this one later\n\n\n-----\n\n### History Lesson Time!\n\n#### So what’s new?\n\n Expanded territory\n\n New tech (but also not really)\n\n Less blatant (but also not really)\n\n\n-----\n\n## Expanded Territory\n\n\n-----\n\n### Previously…\n\n\n-----\n\n### Now…\n\n\n-----\n\n## So what happened?\n\n###### A quick rundown in ten minutes or so...\n\n\n-----\n\n### Another Brief History Lesson\n\n Everything before...\n\n Prepended 10-byte XOR decoding key in blobs\n\n Used simple stack strings to avoid basic\n\n###### detections\n\n Late 2020\n\n Increased XOR key length\n\n Late 2021\n\n Detected PlugDisk\n\n New payload encoding scheme\n\n Control-flow flattening obfuscation began to\n\n###### crop up\n\n Custom OLLVM implementation\n\n\n-----\n\n###### Earlier stackstring-only command handler\n\n\n-----\n\n###### Control-flow flattened command handler\n\n\n-----\n\n###### New payload encoding scheme\n\n\n-----\n\n### Another Brief History Lesson\n\n Some time around mid January 2022, a\n\n###### mysterious sample triggered our detection system.\n\n `State_aid__Commission_approves_`\n```\n                  2022                  2027_regional_aid_map_for_Greec\n                  e.exe\n\n```\n `d404e3cd5f1c6a50f10f56f5c5b9c1e`\n```\n                  3\n\n```\n What did the detection flag the sample as?\n\n###### PlugDisk\n\n\n-----\n\n###### Execution flow\n\n\n-----\n\n###### Execution flow\n\n\n-----\n\n###### Slightly modified payload encoding scheme\n\n\n-----\n\n### But hang on...\n\n Polaris had barely specifically targeted EU\n\n###### up until this point.\n\n TTPs are wildly different from before.\n\n Different payload encoding scheme\n\n Downloader\n\n Targets EU\n\n Slightly different PlugX behavior\n\n\n-----\n\n### But hang on...\n\n Slightly different PlugX behavior\n\n Much smaller PlugX\n\n Contains fewer command code support\n\n HTTP headers are now almost completely\n\n###### different from before\n\n Hard to fully disassemble due to the level of\n\n###### obfuscation\n\n We now refer this variant as MiniPlug due\n\n###### to the miniaturized nature of it\n\n\n-----\n\n### We kept observing...\n\n Polaris continued to tamper with the\n\n###### encoding schemes\n\n Single-byte XOR\n\n Single-byte XOR + appended shellcode\n\n We’ll get back to this\n\n Skipping X number of bytes + single\n###### byte XOR\n\n Mathematical XORs based on filesizes\n\n Use of archive files and obscure file paths.\n\n EU-targeted attacks continue along with\n\n###### other campaigns and regions featuring PlugX and other custom malware\n\n\n-----\n\n### We kept observing...\n\n The appended shellcode could be dated\n\n###### back much earlier on in the operation that was previously attributed to Polaris back in 2018.\n\n Code reuse -> further attributing the attack\n\n###### to Polaris\n\n\n-----\n\n###### Self-XORing shellcode loader\n\n\n-----\n\n### We kept observing...\n\n######  Over the last few months, they’ve continued to evolve TTPs by...\n\n Started experimenting with more and more launchers\n\n Started using ISOs as distribution method\n\n Extremely frequent attacks (at least once or twice per month)\n\n\n-----\n\n###### Bundled decoy document within the PE\n Rotated C2 servers almost every attack\n\n\n-----\n\n### Conclusion\n\n######  Polaris/MustangPanda is continuing to evolve their TTPs\n\n Frequent attacks\n\n Now carry multiple campaigns focusing on a wide variety of targets\n\n EU-related governmental entities <-> MiniPlug\n\n Asia-focused USB spreader/general monitoring <-> PlugDisk / PlugX Fast\n\n Long-time operation\n\n SEA-focused high-profile ops <-> NoFive\n\n Perhaps another day...\n\n\n-----\n\n## THANK YOU!\n\n###### links.azaka.fun\n\n still@teamt5.org sean.sabo@recordedfuture.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://jsac.jpcert.or.jp/archive/2023/pdf/JSAC2023_2_LT4.pdf"
    ],
    "report_names": [
        "JSAC2023_2_LT4.pdf"
    ],
    "threat_actors": [
        {
            "id": "b69037ec-2605-4de4-bb32-a20d780a8406",
            "created_at": "2023-01-06T13:46:38.790766Z",
            "updated_at": "2025-03-27T02:00:02.919758Z",
            "deleted_at": null,
            "main_name": "MUSTANG PANDA",
            "aliases": [
                "TEMP.HEX",
                "TA416",
                "TANTALUM",
                "Twill Typhoon",
                "Earth Preta",
                "Stately Taurus",
                "LuminousMoth",
                "Polaris",
                "BRONZE PRESIDENT",
                "HoneyMyte",
                "Red Lich"
            ],
            "source_name": "MISPGALAXY:MUSTANG PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9baa7519-772a-4862-b412-6f0463691b89",
            "created_at": "2022-10-25T15:50:23.354429Z",
            "updated_at": "2025-03-27T02:00:55.45162Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Mustang Panda",
                "TA416",
                "RedDelta",
                "BRONZE PRESIDENT"
            ],
            "source_name": "MITRE:Mustang Panda",
            "tools": [
                "Cobalt Strike",
                "RCSession",
                "NBTscan",
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2ee03999-5432-4a65-a850-c543b4fefc3d",
            "created_at": "2022-10-25T16:07:23.882813Z",
            "updated_at": "2025-03-27T02:02:10.0116Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Bronze President",
                "Camaro Dragon",
                "Earth Preta",
                "HoneyMyte",
                "Mustang Panda",
                "Operation SMUGX",
                "Operation SmugX",
                "PKPLUG",
                "Red Lich",
                "Stately Taurus",
                "TEMP.Hex"
            ],
            "source_name": "ETDA:Mustang Panda",
            "tools": [
                "9002 RAT",
                "AdFind",
                "Agent.dhwf",
                "Agentemis",
                "CHINACHOPPER",
                "China Chopper",
                "Chymine",
                "ClaimLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "DCSync",
                "DOPLUGS",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Farseer",
                "Gen:Trojan.Heur.PT",
                "HOMEUNIX",
                "Hdump",
                "HenBox",
                "HidraQ",
                "Hodur",
                "Homux",
                "HopperTick",
                "Hydraq",
                "Impacket",
                "Kaba",
                "Korplug",
                "LadonGo",
                "MQsTTang",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "NBTscan",
                "NetSess",
                "Netview",
                "Orat",
                "POISONPLUG.SHADOW",
                "PUBLOAD",
                "PVE Find AD Users",
                "PlugX",
                "Poison Ivy",
                "PowerView",
                "QMAGENT",
                "RCSession",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Sogu",
                "TIGERPLUG",
                "TONEINS",
                "TONESHELL",
                "TVT",
                "TeamViewer",
                "Thoper",
                "TinyNote",
                "WispRider",
                "WmiExec",
                "XShellGhost",
                "Xamtrav",
                "Zupdax",
                "cobeacon",
                "nbtscan",
                "nmap",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1675994839,
    "ts_updated_at": 1743041685,
    "ts_creation_date": 1673867658,
    "ts_modification_date": 1673867658,
    "files": {
        "pdf": "https://archive.orkl.eu/b5235b49985c0f2cc4619a126d53372bb5e697ad.pdf",
        "text": "https://archive.orkl.eu/b5235b49985c0f2cc4619a126d53372bb5e697ad.txt",
        "img": "https://archive.orkl.eu/b5235b49985c0f2cc4619a126d53372bb5e697ad.jpg"
    }
}