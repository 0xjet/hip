{
    "id": "604c9ac1-b582-4423-9c46-7f6228838050",
    "created_at": "2023-01-12T15:06:21.799902Z",
    "updated_at": "2025-03-27T02:06:12.4353Z",
    "deleted_at": null,
    "sha1_hash": "066e30d284611042be400892e077b63291f3ad11",
    "title": "2022-03-23 - Midas Ransomware - Tracing the Evolution of Thanos Ransomware Variants",
    "authors": "",
    "file_creation_date": "2022-05-27T23:21:47Z",
    "file_modification_date": "2022-05-27T23:21:47Z",
    "file_size": 2253219,
    "plain_text": "# Midas Ransomware: Tracing the Evolution of Thanos Ransomware Variants\n\n**[zscaler.com/blogs/security-research/midas-ransomware-tracing-evolution-thanos-ransomware-variants](https://www.zscaler.com/blogs/security-research/midas-ransomware-tracing-evolution-thanos-ransomware-variants)**\n\n**Key Takeaways: An in-depth analysis of Midas and trends across other Thanos ransomware variants reveals how**\nransomware groups shifted tactics in 2021 to:\n\n**lower sunk costs by using RaaS builders to reduce development time**\n**increase payouts with double extortion tactics by using their own data leak sites**\n**extend the length and effectiveness of campaigns to get the highest investment returns by updating**\n**payloads and/or rebranding their own ransomware group**\n\nAdvertised on the darkweb for Ransomware-as-a-Service (RaaS), Thanos ransomware was first identified in February\n[2020. Written in C# language running on the .net framework, this serious offender reboots systems in safeboot mode to](https://www.fortinet.com/blog/threat-research/analysis-of-net-thanos-ransomware-supporting-safeboot-with-networking-mode)\nbypass antivirus detection and includes a builder that enables threat actors to create new variants by customizing\nsamples. Source code of Thanos builder also leaked and there are lots of different variants that have been seen based\non that. Here we discuss the four 2021 variants shown in Figure 1 below that used double extortion tactics.\n\n\n-----\n\n_Figure 1:Timeline of Thanos derived ransomware variations_\n\nBeginning in February 2021, the Prometheus ransomware variant emerged as one of the new Thanos built variants of\n[the year. It encrypts files and appends “.[{ID}],.PROM[[email protected]{.}ch], {ID}[[email protected]{.}com] “ extension](https://www.zscaler.com/cdn-cgi/l/email-protection)\nand drop “RESTORE_FILES_INFO.txt, RESTORE_FILES_INFO.hta” ransom note. The Prometheus group which\noperates the variant has claimed to be part of the notorious REvil ransomware group responsible for the Kaseya supply\nchain attack, however experts doubt the claim as a solid connection between the two has never been established. This\nvariant is known for using double extortion techniques to make organizations pay that include threatening to leak\nvaluable data on their leak site. A quick check reveals that the leak site is currently down, but the threat still holds\npotential weight\n\nIn July 2021, another Thanos derived ransomware called Haron was discovered. It encrypts files and appends “.\n{Targeted Company name}” extension and drops “RESTORE_FILES_INFO.hta,RESTORE_FILES_INFO.txt” ransom\nnote. Haron ransomware group also have their own data leak site used for double extortion. This variant has striking\n[similarities with Avaddon ransomware based on examination of the ransom note and data leak site information.](https://medium.com/s2wblog/quick-analysis-of-haron-ransomware-feat-avaddon-and-thanos-1ebb70f64dc4)\n\nSeptember 2021, the Thanos builder was used again to develop the Spook ransomware variant. It encrypts files and\nappends “.{ID}” extension and drops “RESTORE_FILES_INFO.hta,RESTORE_FILES_INFO.txt” ransom note. Similar\nto the other variants, Spook ransomware also uses double extortion techniques with their own data leak site as shown in\nthe screenshot below.\n\nRounding out the year in October 2021, another Thanos ransomware family emerged with the Midas variant that\nappends “.{Targeted Company name}” extension and drops “RESTORE_FILES_INFO.hta and\n**[RESTORE_FILES_INFO.txt” ransom note. In January 2022, ThreatLabz investigated a report of Midas ransomware](https://news.sophos.com/en-us/2022/01/25/windows-services-lay-the-groundwork-for-a-midas-ransomware-attack/)**\nbeing slowly deployed over a 2-month period and the attacker was observed using different powershell scripts, remote\naccess tools and an open source windows utility.\n\nLike the others, Midas features its own data leak site for double extortion. Interestingly, the site contains leaked victim\ndata from a Haron ransomware attack, suggesting to researchers that Midas is potentially linked to the Haron\nransomware operators.\n\n\n-----\n\n_Figure 2: Count of companies with leaked data by 2021 Thanos ransomware variants._\n\n## Identifying Thanos as the Source for the Prometheus, Haron, Spook, and Midas ransomware variants\n\nTracing the evolution of Thanos based ransomware variants back to the source provides threat researchers with an\ninside look at how ransomware gangs operate and evolve over time. To establish a connection between each variant,\nthe ThreatLabz team looked for the use of common signatures and indicators that would point back to the Thanos\nransomware builder. After determining that each variant was derived using the builder, the team set about analyzing the\nsimilarities and differences in the shifting techniques adversaries employ to make new variants of a common origin\nransomware more effective. These observations help us to gain insights into the cooperation happening between\nadversary groups and better understand the development lifecycle and alternating impacts of ransomware through its\nvariants.\n\nThe analysis that follows walks you through identifying Thanos variants through an examination of common signatures\nfound in the ransom note key identifiers and the consistent use of a common file marker “GotAllDone”. Followed by an\nin-depth analysis of the latest Midas variant.\n\n**Identifying Thanos Variants**\n\nAll four of the 2021 Thanos based ransomware variants contain a key identifier with common signatures for the Thanos\nbuilder found in the ransom notes as shown in Figure 3 below.\n\n\n-----\n\n_Figure 3: Screenshots of ransom notes showing the common signature ‘Key Identifier’ for 2021 Thanos ransomware_\n_variants: Prometheus, Haron, Spook and Midas._\n\nAnother similarity is that after encryption they append base 64 encoded key after encrypting data of every file.\nPrometheus, Haron, Spook, and Midasall contain the same FileMarker that is “GotAllDone” appended at the end of each\nencrypted file. Below screenshot displays the FileMarker info and Base64 encoded key appended after the data\nencrypted by Midas ransomware.\n\n\n-----\n\n_Figure 4: Screenshots of FileMarker and Base64 encoded key appended_\n\n## Midas Ransomware\n\nThe Midas data leak site currently displays data from 29 victim companies including data from several victims previously\nseen on the Haron data leak site which is now inactive.\n\n\n-----\n\n_Figure 5: Screenshot of the Midas ransomware data leak site index page._\n\n\n-----\n\n_Figure 6: Screenshot of victim companies listed on Midas ransomware data leak site._\n\n### Technical analysis\n\nMidas ransomware is written in C# and obfuscated using smartassembly. Once executed this variant starts terminating\nprocesses using taskkill.exe. It terminates processes that inhibit encryption processes and processes related to security\nsoftware, database related programs so it can encrypt more files. Below is a list of the common processes typically\nterminated by Thanos based ransomware.\n\n**Most commonly terminated processes:**\n\n\n-----\n\nRaccineSettings.exe\n\nmspub.exe\n\nCNTAoSMgr.exe\n\nxfssvccon.exe\n\nmydesktopqos.exe\n\nsqlbrowser.exe\n\nsqlwriter.exe\n\ntbirdconfig.exe\n\nvisio.exe\n\nsqlservr.exe\n\nsqbcoreservice.exe\n\nthebat64.exe\n\nmysqld.exe\n\ndbeng50.exe\n\nNtrtscan.exe\n\n\nisqlplussvc.exe\n\nsynctime.exe\n\nfirefoxconfig.exe\n\nwinword.exe\n\nocomm.exe\n\nagntsvc.exe\n\ninfopath.exe\n\nocautoupds.exe\n\nmysqld-opt.exe\n\nsqlagent.exe\n\npowerpnt.exe\n\nsteam.exe\n\nzoolz.exe\n\nencsvc.exe\n\nthebat.exe\n\n\ntmlisten.exe\n\nmbamtray.exe\n\nPccNTMon.exe\n\nmydesktopservice.exe\n\nexcel.exe\n\nonenote.exe\n\nmsftesql.exe\n\nwordpad.exe\n\nocssd.exe\n\nmysqld-nt.exe\n\noracle.exe\n\ndbsnmp.exe\n\noutlook.exe\n\nmsaccess.exe\n\n\n[It also deletes the process, schedule task and registry related to the Raccine tool. It is a ransomware prevention tool that](https://github.com/Neo23x0/Raccine)\nprotects the system from ransomware processes to delete shadow copy.\n\nPrometheus, Haron, Spook and Midas have been seen terminating Raccine related artifacts.\n\n_Figure 7: Command used to terminate Vaccine process and other artifacts._\n\nThe Midas variant is designed to stop service related to security products, database software, backups and email\nexchanges.\n\n**List of most commonly disrupted services:**\n\nstart Dnscache /y stop msexchangeimap4 /y stop MSSQLServerADHelper /y\n\nstart FDResPub /y stop ARSM /y stop McAfeeEngineService /y\n\nstart SSDPSRV /y stop MSSQL$BKUPEXEC /y stop VeeamHvIntegrationSvc /y\n\nstart upnphost /y stop unistoresvc_1af40a /y stop MSSQLServerADHelper100 /y\n\nstop avpsus /y stop BackupExecAgentAccelerator /y stop McAfeeFramework /y\n\nstop McAfeeDLPAgentService /y stop MSSQL$ECWDB2 /y stop VeeamMountSvc /y\n\n\n-----\n\nstop mfewc /y stop audioendpointbuilder /y stop MSSQLServerOLAPService /y\n\nstop BMR Boot Service /y stop BackupExecAgentBrowser /y stop\nMcAfeeFrameworkMcAfeeFramework\n/y\n\n\nstop NetBackup BMR MTFTP\nService /y\n\n\nstop MSSQL$PRACTICEMGT /y stop VeeamNFSSvc /y\n\n\nstop DefWatch /y stop BackupExecDeviceMediaService /y stop MySQL57 /y\n\nstop ccEvtMgr /y stop MSSQL$PRACTTICEBGC /y stop McShield /y\n\nstop ccSetMgr /y stop BackupExecJobEngine /y stop VeeamRESTSvc /y\n\nstop SavRoam /y stop MSSQL$PROD /y stop MySQL80 /y\n\nstop RTVscan /y stop AcronisAgent /y stop McTaskManager /y\n\nstop QBFCService /y stop BackupExecManagementService /y stop VeeamTransportSvc /y\n\nstop QBIDPService /y stop MSSQL$PROFXENGAGEMENT /y stop OracleClientCache80 /y\n\nstop Intuit.QuickBooks.FCS /y stop Antivirus /y stop mfefire /y\n\nstop QBCFMonitorService /y stop BackupExecRPCService /y stop wbengine /y\n\nstop YooBackup /y stop MSSQL$SBSMONITORING / stop ReportServer$SQL_2008 /y\n\nstop YooIT /y stop MSSQL$SBSMONITORING /y stop mfemms /y\n\nstop zhudongfangyu /y stop AVP /y stop wbengine /y\n\nstop stc_raw_agent /y stop BackupExecVSSProvider /y stop RESvc /y\n\nstop VSNAPVSS /y stop MSSQL$SHAREPOINT /y stop mfevtp /y\n\nstop VeeamTransportSvc /y stop DCAgent /y stop sms_site_sql_backup /y\n\n\nstop VeeamDeploymentService\n/y\n\n\nstop bedbg /y stop SQLAgent$BKUPEXEC /y\n\n\nstop VeeamNFSSvc /y stop MSSQL$SQL_2008 /y stop MSSQL$SOPHOS /y\n\nstop veeam /y stop EhttpSrv /y stop\nSQLAgent$CITRIX_METAFRAME /y\n\nstop PDVFSService /y stop MMS /y stop sacsvr /y\n\nstop BackupExecVSSProvider /y stop MSSQL$SQLEXPRESS /y stop SQLAgent$CXDB /y\n\n\nstop\nBackupExecAgentAccelerator /y\n\nstop BackupExecAgentBrowser\n/y\n\n\nstop ekrn /y stop SAVAdminService /y\n\nstop mozyprobackup /y stop SQLAgent$ECWDB2 /y\n\n\n-----\n\nstop\nBackupExecDiveciMediaService\n/y\n\n\nstop MSSQL$SYSTEM_BGC /y stop SAVService /y\n\n\nstop BackupExecJobEngine /y stop EPSecurityService /y stop SQLAgent$PRACTTICEBGC /y\n\n\nstop\nBackupExecManagementService\n/y\n\n\nstop MSSQL$VEEAMSQL2008R2 /y stop SepMasterService /y\n\n\nstop BackupExecRPCService /y stop MSSQL$TPS /y stop SQLAgent$PRACTTICEMGT /y\n\nstop AcrSch2Svc /y stop EPUpdateService /y stop ShMonitor /y\n\nstop AcronisAgent /y stop ntrtscan /y stop SQLAgent$PROD /y\n\nstop CASAD2DWebSvc /y stop MSSQL$TPSAMA /y stop Smcinst /y\n\nstop CAARCUpdateSvc /y stop EsgShKernel /y stop\nSQLAgent$PROFXENGAGEMENT /y\n\nstop sophos /y stop PDVFSService /y stop SmcService /y\n\nstop MsDtsServer /y stop MSSQL$VEEAMSQL2008R2 /y stop SQLAgent$SBSMONITORING\n/y\n\nstop IISAdmin /y stop ESHASRV /y stop SntpService /y\n\nstop MSExchangeES /y stop SDRSVC /y stop SQLAgent$SHAREPOINT /y\n\nstop EraserSvc11710 /y stop MSSQL$VEEAMSQL2012 /y stop sophossps /y\n\nstop MsDtsServer100 /y stop FA_Scheduler /y stop SQLAgent$SQL_2008 /y\n\nstop NetMsmqActivator /y stop SQLAgent$VEEAMSQL2008R2 /y stop SQLAgent$SOPHOS /y\n\n\nstop MSExchangeIS /y stop\nMSSQLFDLauncher$PROFXENGAGEMENT\n/y\n\n\nstop SQLAgent$SQLEXPRESS /y\n\n\nstop SamSs /y stop KAVFS /y stop svcGenericHost /y\n\nstop ReportServer /y stop SQLWriter /y stop SQLAgent$SYSTEM_BGC /y\n\n\nstop MsDtsServer110 /y stop\nMSSQLFDLauncher$SBSMONITORING /y\n\n\nstop swi_filter /y\n\n\nstop POP3Svc /y stop KAVFSGT /y stop SQLAgent$TPS /y\n\nstop MSExchangeMGMT /y stop VeeamBackupSvc /y stop swi_service /y\n\nstop SMTPSvc /y stop MSSQLFDLauncher$SHAREPOINT /y stop SQLAgent$TPSAMA /y\n\nstop ReportServer$SQL_2008 /y stop kavfsslp /y stop swi_update /y\n\nstop msftesql$PROD /y stop VeeamBrokerSvc /y stop SQLAgent$VEEAMSQL2008R2\n/y\n\n\n-----\n\nstop SstpSvc /y stop MSSQLFDLauncher$SQL_2008 /y stop swi_update_64 /y\n\nstop MSExchangeMTA /y stop klnagent /y stop SQLAgent$VEEAMSQL2012 /y\n\n\nstop\nReportServer$SYSTEM_BGC /y\n\n\nstop VeeamCatalogSvc /y stop TmCCSF /y\n\n\nstop MSOLAP$SQL_2008 /y stop MSSQLFDLauncher$SYSTEM_BGC /y stop SQLBrowser /y\n\nstop UI0Detect /y stop macmnsvc /y stop tmlisten /y\n\nstop MSExchangeSA /y stop VeeamCloudSvc /y stop SQLSafeOLRService /y\n\nstop ReportServer$TPS /y stop MSSQLFDLauncher$TPS /y stop TrueKey /y\n\n\nstop MSOLAP$SYSTEM_BGC\n/y\n\n\nstop masvc /y stop SQLSERVERAGENT /y\n\n\nstop W3Svc /y stop VeeamDeploymentService /y stop TrueKeyScheduler /y\n\nstop MSExchangeSRS /y stop MSSQLFDLauncher$TPSAMA /y stop SQLTELEMETRY /y\n\nstop ReportServer$TPSAMA /y stop MBAMService /y stop TrueKeyServiceHelper /y\n\nstop MSOLAP$TPS /y stop VeeamDeploySvc /y stop SQLTELEMETRY$ECWDB2 /y\n\nstop msexchangeadtopology /y stop MSSQLSERVER /y stop WRSVC /y\n\nstop AcrSch2Svc /y stop MBEndpointAgent /y stop mssql$vim_sqlexp /y\n\nstop MSOLAP$TPSAMA /y stop VeeamEnterpriseManagerSvc /y stop vapiendpoint /y\n\nAnother technique used by most variants of Thanos based ransomware is to evade detection by finding and terminating\nprocesses for analysis tools by searching the list of keywords shown below:\n\nhttp analyzer stand-alone NetworkTrafficView CFF Explorer\n\nfiddler HTTPNetworkSniffer protection_id\n\neffetech http sniffer tcpdump pe-sieve\n\nfiresheep intercepter MegaDumper\n\nIEWatch Professional Intercepter-NG UnConfuserEx\n\ndumpcap ollydbg Universal_Fixer\n\nwireshark dnspy-x86 NoFuserEx\n\nwireshark portable dotpeek cheatengine\n\nsysinternals tcpview dotpeek64\n\nNetworkMiner RDG Packer Detector\n\nFurther, it changes the configuration of specific services as shown below.\n\n\n-----\n\n_Figure 8: Screenshot of service configuration changes._\n\nIt deletes shadow copy using powershell command so the system is unable to recover data.\n\nCommand : \"powershell.exe\" & Get-WmiObject Win32_Shadowcopy | ForEach-Object { $_Delete(); }\n\n**File Encryption**\n\nMidas ransomware searches through each drive and directory and encrypts the files. It creates a random key and\nencrypts a file using Salsa20 algorithm. Then the Salsa20 key is encrypted by the RSA public key as shown in the\nscreenshot below. The encryption key is encoded in base64 and appended to each impacted file. It also added\nFileMarker “GotAllDone” at the end of each encrypted file. The encrypted key is also saved in the Registry under\n“HKEY_CURRENT_USER\\SOFTWARE\\KEYID\\myKeyID”. After encryption, it drops the “reload1.lnk” file to open a\nransom note at every restart.\n\nPath: \"C:\\\\Users\\\\{Username}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start\n**Menu\\\\Programs\\\\Startup\\\\reload1.lnk\".**\n\n_Figure 9: Screenshot of encrypting Salsa20 key with RSA public key._\n\nIt encrypts the file contained below extensions:\n\n\n-----\n\nAfter encryption it appends .{Targeted Company name} extension and drops **RESTORE_FILES_INFO.hta and**\n**RESTORE_FILES_INFO.txt” ransom note. Below is the screenshot of the ransom note. RESTORE_FILES_INFO.hta**\ndoesn’t contain Key ID but RESTORE_FILES_INFO.txt contains key ID.\n\n_Figure 10: Ransom note of Midas_\n\n### Cloud Sandbox Detection\n\n\n-----\n\n_Figure 11: Zscaler Cloud Sandbox detection of Midas ransomware_\n\nIn addition to sandbox detections, Zscaler’s multilayered cloud security platform detects indicators at various levels.\n\nWin32.Ransom.Thanos\n\n[https://threatlibrary.zscaler.com/?threatname=win32.ransom.thanos](https://threatlibrary.zscaler.com/?threatname=win32.ransom.thanos)\n\nWin32.Ransom.Prometheus\n\n[https://threatlibrary.zscaler.com/?threatname=win32.ransom.prometheus](https://threatlibrary.zscaler.com/?threatname=win32.ransom.prometheus)\n\nWin32.Ransom.Spook\n\n[https://threatlibrary.zscaler.com/?threatname=win32.ransom.spook](https://threatlibrary.zscaler.com/?threatname=win32.ransom.spook)\n\nWin32.Ransom.Haron\n\n[https://threatlibrary.zscaler.com/?threatname=win32.ransom.haron](https://threatlibrary.zscaler.com/?threatname=win32.ransom.haron)\n\nWin32.Ransom.Midas\n\n[https://threatlibrary.zscaler.com/?threatname=win32.ransom.midas](https://threatlibrary.zscaler.com/?threatname=win32.ransom.midas)\n\n### MITRE ATT&CK Technique\n\n**ID** **Technique**\n\nT1059 Command and Scripting Interpreter\n\nT1569.002 Service Execution\n\n\n-----\n\nT1112 Modify Registry\n\nT1562.001 Disable or Modify Tools\n\nT1010 Application Window Discovery\n\nT1057 Process Discovery\n\nT1518.001 Security Software Discovery\n\nT1083 File and Directory Discovery\n\nT1490 Inhibit System Recovery\n\nT1489 Service Stop\n\nT1486 Data Encrypted for Impact\n\n### IOC\n\nMD5:3767a7d073f5d2729158578a7006e4c4\n\n**About ThreatLabz**\n\nThreatLabz is the security research arm of Zscaler. This world-class team is responsible for hunting new threats and\nensuring that the thousands of organizations using the global Zscaler platform are always protected. In addition to\nmalware research and behavioral analysis, team members are involved in the research and development of new\nprototype modules for advanced threat protection on the Zscaler platform, and regularly conduct internal security audits\nto ensure that Zscaler products and infrastructure meet security compliance standards. ThreatLabz regularly publishes\n[in-depth analyses of new and emerging threats on its portal, research.zscaler.com.](https://research.zscaler.com/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-23 - Midas Ransomware - Tracing the Evolution of Thanos Ransomware Variants.pdf"
    ],
    "report_names": [
        "2022-03-23 - Midas Ransomware - Tracing the Evolution of Thanos Ransomware Variants.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535981,
    "ts_updated_at": 1743041172,
    "ts_creation_date": 1653693707,
    "ts_modification_date": 1653693707,
    "files": {
        "pdf": "https://archive.orkl.eu/066e30d284611042be400892e077b63291f3ad11.pdf",
        "text": "https://archive.orkl.eu/066e30d284611042be400892e077b63291f3ad11.txt",
        "img": "https://archive.orkl.eu/066e30d284611042be400892e077b63291f3ad11.jpg"
    }
}