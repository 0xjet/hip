{
    "id": "b20fe54c-43e6-4425-b39c-870c74d8303c",
    "created_at": "2023-01-12T15:07:10.738852Z",
    "updated_at": "2025-03-27T02:09:29.689747Z",
    "deleted_at": null,
    "sha1_hash": "b8f57e518accba986207880b4a89e4805075013b",
    "title": "2020-01-16 - TrickBot Now Uses a Windows 10 UAC Bypass to Evade Detection",
    "authors": "",
    "file_creation_date": "2022-05-27T01:59:20Z",
    "file_modification_date": "2022-05-27T01:59:20Z",
    "file_size": 566187,
    "plain_text": "# TrickBot Now Uses a Windows 10 UAC Bypass to Evade Detection\n\n**[bleepingcomputer.com/news/security/trickbot-now-uses-a-windows-10-uac-bypass-to-evade-detection/](https://www.bleepingcomputer.com/news/security/trickbot-now-uses-a-windows-10-uac-bypass-to-evade-detection/)**\n\nLawrence Abrams\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nJanuary 16, 2020\n04:00 PM\n7\n\nThe TrickBot Trojan has received an update that adds a UAC bypass targeting the Windows\n10 operating system so that it infects users without displaying any visible prompts.\n\nA UAC bypass allows programs to be launched without displaying a User Account Control\nprompt that asks users to allow a program to run with administrative privileges.\n\n\n-----\n\n**Example of UAC prompt**\n\n[In a new TrickBot sample, Head of SentinelLabs Vitali Kremez discovered that the trojan is](https://twitter.com/VK_Intel)\nnow using the Windows 10 Fodhelper bypass.\n\n## Using Windows 10 UAC bypass\n\nWhen executed, TrickBot will check if the operating system is Windows 7 or Windows 10.\n\n[If it is Windows 7, TrickBot will utilize the CMSTPLUA UAC bypass and if Windows 10, will](https://msitpros.com/?p=3960)\nnow use the [Fodhelper UAC Bypass.](https://www.bleepingcomputer.com/news/security/windows-10-uac-bypass-uses-apps-and-features-utility/)\n\nThe Fodhelper bypass was discovered in 2017 and uses the legitimate Microsoft\nC:\\Windows\\system32\\fodhelper.exe executable to execute other programs with\nadministrative privileges.\n\n\"Fodhelper.exe is a trusted binary on Windows 10 that TrickBot uses to execute the\nmalware stage bypassing UAC via the registry method,\" Kremez told BleepingComputer in\na conversation.\n\nWhen properly configured, when executed Fodhelper will also launch any command stored\nin the default value of the HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command key.\n\nAs Fodhelper is a trusted Windows executable, it allows auto-elevation without displaying a\nUAC prompt. Any programs that it executes will be executed without showing a UAC\nprompt as well.\n\nTrickBot utilizes this bypass to launch itself without a warning to the user and thus evading\ndetection by the user.\n\n\n-----\n\n**Command executed by the Fodhelper UAC bypass**\nAs more users move to Windows 10 and as Windows Defender matures, more malware\nhas begun to target the operating system and its security features.\n\nIn September 2019 we reported how the GootKit banking Trojan also added the\nFodhelper bypass in 2019 to execute a command that whitelists the malware executable's\npath in Windows Defender.\n\nIn July 2019, TrickBot also targeted Windows Defender by trying to disable various scan\noptions. With the inclusion of Fodhelper, we continue to see the malware developers\nattempt to reduce the security features found in Windows 10.\n\n### Related Articles:\n\n[Emergency Windows 10 updates fix Microsoft Store app issues](https://www.bleepingcomputer.com/news/microsoft/emergency-windows-10-updates-fix-microsoft-store-app-issues/)\n\n[Microsoft emergency updates fix Windows AD authentication issues](https://www.bleepingcomputer.com/news/microsoft/microsoft-emergency-updates-fix-windows-ad-authentication-issues/)\n\n[Windows admins frustrated by Quick Assist moving to Microsoft Store](https://www.bleepingcomputer.com/news/microsoft/windows-admins-frustrated-by-quick-assist-moving-to-microsoft-store/)\n\n[Microsoft: Windows 10 20H2 has reached end of service](https://www.bleepingcomputer.com/news/microsoft/microsoft-windows-10-20h2-has-reached-end-of-service/)\n\n[New stealthy Nerbian RAT malware spotted in ongoing attacks](https://www.bleepingcomputer.com/news/security/new-stealthy-nerbian-rat-malware-spotted-in-ongoing-attacks/)\n\n[Fodhelper](https://www.bleepingcomputer.com/tag/fodhelper/)\n[TrickBot](https://www.bleepingcomputer.com/tag/trickbot/)\n[Trojan](https://www.bleepingcomputer.com/tag/trojan/)\n[UAC Bypass](https://www.bleepingcomputer.com/tag/uac-bypass/)\n[Windows 10](https://www.bleepingcomputer.com/tag/windows-10/)\n\n\n-----\n\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/news/security/pocs-for-windows-cryptoapi-bug-are-out-show-real-life-exploit-risks/)\n[Next Article](https://www.bleepingcomputer.com/news/security/wordpress-plugin-bugs-let-hackers-wipe-or-takeover-your-site/)\n\n### Comments\n\n[berite100 - 2 years ago](https://www.bleepingcomputer.com/forums/u/1053100/berite100/)\n\nany remediation?\n\n[Lawrence Abrams - 2 years ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nNo, unfortunately not. Microsoft does not give UAC bypasses much priority.\n\n\n-----\n\n[DavidChipman - 2 years ago](https://www.bleepingcomputer.com/forums/u/1152088/davidchipman/)\n\nHere's hoping they might now? Or is that expecting too much?\n\n[RocketPak - 2 years ago](https://www.bleepingcomputer.com/forums/u/1132364/rocketpak/)\n\nBest thing you can do is crank UAC to up to the max setting. Then it will still pop up a\nUAC prompt even when windows trusted executable need admin privileges.\n\n[gabry89 - 2 years ago](https://www.bleepingcomputer.com/forums/u/1152168/gabry89/)\n\nYou can set UAC to \"Always Notify\" and you should be safe from this bypass attack.\nEDIT: i'm too late :)\n\n\n-----\n\n[ken_smon - 2 years ago](https://www.bleepingcomputer.com/forums/u/1120756/ken-smon/)\n\nThe world: Windows in insecure\nMicrosoft: OK, here's UAC\nMalware writer: Lets use fodhelper.exe to bypass it\nMicrosoft: ...\n\n[Quadroodlesublimated - 2 years ago](https://www.bleepingcomputer.com/forums/u/1152286/quadroodlesublimated/)\n\nHow do you set UAC to \"Always Notify\" ? Explain, step by step!\n\nalso: MSFT itself does not reliably sign every piece of software it publishes. Why? If\nthey can't even follow their own rules, then what's the point of UAC ? Am I getting this\nright? Is there something I should know?\n\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-16 - TrickBot Now Uses a Windows 10 UAC Bypass to Evade Detection.pdf"
    ],
    "report_names": [
        "2020-01-16 - TrickBot Now Uses a Windows 10 UAC Bypass to Evade Detection.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536030,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653616760,
    "ts_modification_date": 1653616760,
    "files": {
        "pdf": "https://archive.orkl.eu/b8f57e518accba986207880b4a89e4805075013b.pdf",
        "text": "https://archive.orkl.eu/b8f57e518accba986207880b4a89e4805075013b.txt",
        "img": "https://archive.orkl.eu/b8f57e518accba986207880b4a89e4805075013b.jpg"
    }
}