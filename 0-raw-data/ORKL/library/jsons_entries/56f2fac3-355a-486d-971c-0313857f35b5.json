{
    "id": "56f2fac3-355a-486d-971c-0313857f35b5",
    "created_at": "2023-01-12T15:01:51.717299Z",
    "updated_at": "2025-03-27T02:17:14.709933Z",
    "deleted_at": null,
    "sha1_hash": "532eb5e9a24e3d1423b3a5d75e14776ea4d89bbc",
    "title": "2021-06-10 - BackdoorDiplomacy- Upgrading from Quarian to Turian",
    "authors": "",
    "file_creation_date": "2022-06-13T04:03:55Z",
    "file_modification_date": "2022-06-13T04:03:55Z",
    "file_size": 413355,
    "plain_text": "# BackdoorDiplomacy: Upgrading from Quarian to Turian\n\n**welivesecurity.com/2021/06/10/backdoordiplomacy-upgrading-quarian-turian/**\n\nESET researchers discover a new campaign that evolved from the Quarian backdoor\n\n[Adam Burgher](https://www.welivesecurity.com/author/aburgher/)\n10 Jun 2021 - 02:00PM\n\nESET researchers discover a new campaign that evolved from the Quarian backdoor\n\n## Executive summary\n\n\nJune 10, 2021\n\n\nAn APT group that we are calling BackdoorDiplomacy, due to the main vertical of its victims, has been targeting Ministries of\nForeign Affairs and telecommunication companies in Africa and the Middle East since at least 2017. For initial infection\nvectors, the group favors exploiting vulnerable internet-exposed devices such as web servers and management interfaces\nfor networking equipment. Once on a system, its operators make use of open-source tools for scanning the environment\nand lateral movement. Interactive access is achieved in two ways: (1) via a custom backdoor we are calling Turian that is\nderived from the Quarian backdoor; and (2) in fewer instances, when more direct and interactive access is required, certain\nopen-source remote access tools are deployed. In several instances, the group has been observed targeting removable\nmedia for data collection and exfiltration. Finally, both Windows and Linux operating systems have been targeted.\n\n## Links with known groups\n\nBackdoorDiplomacy shares commonalities with several other Asian groups. Most obvious among them is the connection\nbetween the Turian backdoor and the Quarian backdoor. Specific observations regarding the Turian-Quarian connection are\nrecorded below in the Turian section. We believe this group is also linked with a group Kaspersky referred to as\n\n\n-----\n\n_[CloudComputating that was also analyzed by Sophos.](https://securelist.com/apt-trends-report-q2-2020/97937/)_\n\n[Several victims were compromised via mechanisms that closely matched the Rehashed Rat and a](https://www.fortinet.com/blog/threat-research/rehashed-rat-used-in-apt-campaign-against-vietnamese-organizations) _[MirageFox-APT15](https://www.intezer.com/blog/research/miragefox-apt15-resurfaces-with-new-tools-based-on-old-ones/)_\ncampaign documented by Fortinet in 2017 and Intezer in 2018, respectively. The BackdoorDiplomacy operators made use\nof their specific form of DLL Search-Order Hijacking.\n\n[Finally, the network encryption method BackdoorDiplomacy uses is quite similar to a backdoor Dr.Web calls](https://news.drweb.com/show/?i=13907&lng=en)\n_[Backdoor.Whitebird.1. Whitebird was used to target government institutions in Kazakhstan and Kyrgyzstan (both neighbors](https://vms.drweb.co.jp/search/?q=BackDoor.Whitebird.1&lng=en)_\nof a BackdoorDiplomacy victim in Uzbekistan) within the same 2017-to-present timeframe in which BackdoorDiplomacy has\nbeen active.\n\n## Victimology\n\n[Quarian was used to target the Syrian Ministry of Foreign Affairs in 2012, as well as the](https://securelist.com/a-targeted-attack-against-the-syrian-ministry-of-foreign-affairs/34742/) _[US State Department in 2013. This](https://threatconnect.com/blog/divide-and-conquer/)_\ntrend of targeting Ministries of Foreign Affairs continues with Turian.\n\nVictims have been discovered in the Ministries of Foreign Affairs of several African countries, as well as in Europe, the\nMiddle East, and Asia. Additional targets include telecommunication companies in Africa, and at least one Middle Eastern\ncharity. In each case, operators employed similar tactics, techniques, and procedures (TTPs), but modified the tools used,\neven within close geographic regions, likely to make tracking the group more difficult. See Figure 1 for a map of victims by\ncountry and vertical.\n\n_Figure 1. Victims by country and vertical_\n\n## Attack vectors\n\nBackdoorDiplomacy targeted servers with internet-exposed ports, likely exploiting unpatched vulnerabilities or poorly\nenforced file-upload security. In one specific instance, we observed the operators exploit an F5 BIP-IP vulnerability (CVE_2020-5902) to drop a Linux backdoor. In another, a Microsoft Exchange server was exploited via a PowerShell dropper that_\n[installed China Chopper, a well-known webshell in use, by various groups, since 2013. In a third, we observed a Plesk](https://attack.mitre.org/software/S0020/)\nserver with poorly configured file-upload security execute another webshell similar to China Chopper. See Figure 2 for an\noverview of the exploit chain.\n\n\n-----\n\n_Figure 2. Exploit chain from initial compromise to backdoor with C&C communications_\n\n## Reconnaissance and lateral movement\n\nFollowing the initial compromise, in many instances the BackdoorDiplomacy group employed open-source reconnaissance\nand red-team tools to evaluate the environment for additional targets of opportunity and lateral movement. Among the tools\ndocumented are:\n\n_[EarthWorm, a simple network tunnel with SOCKS v5 server and port transfer functionalities](https://rootkiter.com/EarthWorm/en/index.html)_\n_[Mimikatz, and various versions including SafetyKatz](https://github.com/gentilkiwi/mimikatz/wiki)_\n_[Nbtscan, a command line NetBIOS scanner for Windows](http://www.unixwiz.net/tools/nbtscan.html)_\n_[NetCat, a networking utility that reads and writes data across network connections](http://netcat.sourceforge.net/)_\n_[PortQry, a tool to display the status of TCP and UDP ports on remote systems](https://ss64.com/nt/portqry.html)_\n_[SMBTouch, used to determine whether a target is vulnerable to EternalBlue](https://github.com/3gstudent/Smbtouch-Scanner)_\nVarious tools from the ShadowBrokers dump of NSA tools including, but not limited to:\n\nDoublePulsar\nEternalBlue\nEternalRocks\nEternalSynergy\n\nCommonly used directories for staging recon and lateral movement tools include:\n\nC:\\Program Files\\Windows Mail\\en-US\\\n%LOCALAPPDATA%\\Microsoft\\InstallAgent\\Checkpoints\\\nC:\\ProgramData\\ESET\\ESET Security\\Logs\\eScan\\\n%USERPROFILE%\\ESET\\ESET Security\\Logs\\eScan\\\nC:\\Program Files\\hp\\hponcfg\\\nC:\\Program Files\\hp\\hpssa\\\nC:\\hp\\hpsmh\\\nC:\\ProgramData\\Mozilla\\updates\\\n\nOf the tools listed above, many were obfuscated with VMProtect (v1.60-2.05), a recurring theme with BackdoorDiplomacy\ntools.\n\n## Windows\n\n### Backdoor droppers\n\nIn some instances, operators were observed uploading backdoor droppers. Operators attempted to disguise their backdoor\ndroppers and evade detection in various ways.\n\nNaming conventions designed to blend into normal operations (e.g. amsc.exe, msvsvr.dll, alg.exe)\nDropping implants in folders named for legitimate software (e.g., C:\\Program Files\\hp, C:\\ProgramData\\ESET,\nC:\\ProgramData\\Mozilla)\n_[DLL search order hijacking](https://attack.mitre.org/techniques/T1574/001/)_\n\n\n-----\n\nIn one such instance, the operators uploaded, via a webshell, both ScnCfg.exe (SHA 1:\n573C35AB1F243D6806DEDBDD7E3265BC5CBD5B9A), a legitimate McAfee executable, and vsodscpl.dll, a malicious\nDLL named after a legitimate McAfee DLL that is called by ScnCfg.exe. The version of vsodscpl.dll (SHA-1:\nFCD8129EA56C8C406D1461CE9DB3E02E616D2AA9) deployed was called by ScnCfg.exe, at which point vsodscpl.dll\nextracted Turian embedded within its code, wrote it to memory, and executed it.\n\nOn a different system, operators dropped a legitimate copy of credwize.exe, the Microsoft Credential Backup and Restore\nWizard, on disk and used it to execute the malicious library New.dll, another Turian variant.\n\n### Turian\n\nAbout half of the samples we collected were obfuscated with VMProtect. A compilation of observed operator commands is\nincluded in the Operator commands section. Unique network encryption schemes are individually discussed below as well.\n\n**Similarities with Quarian**\n\nThe initial reporting by Kaspersky notes that the victims of Quarian were at the Syrian Ministry of Foreign Affairs, a similar\ntarget-set of Turian.\n\nIn many of the Turian samples we collected, there are obvious similarities with Quarian. Mutexes are used by both to verify\nthat only one instance is running, although the mutexes used are dissimilarly named. We observed the following mutexes\nused by Turian:\n\nwinsupdatetw\nclientsix\nclient\nupdatethres\nOthers: dynamically generated based on the system’s hostname, limited to eight hex characters, lower-case, and\nprefaced with a leading zero\n\nC&C server domains and IP addresses are extracted with similar XOR routines; where Quarian uses a decryption key of\n0x44, Turian uses 0xA9.\n\nTurian and Quarian both read the first four bytes from the file cf in the same directory as the malware’s executable, which\nare then used as the sleep length as part of the C&C beacon routine.\n\nThe Turian network connection process follows a similar pattern to Quarian, attempting to make a direct connection. If that\nfails due to a local proxy with a response of 407 (Authorization Required), both try to use locally cached credentials.\nHowever, the request sent to the proxy by Turian does not contain any of the grammatical mistakes that Quarian sent. See\nFigure 3 for a comparison of proxy connection attempts.\n\n_Figure 3. Comparison of proxy connection attempts, Turian (left) and Quarian (right)_\n\nFinally, both Turian and Quarian create a remote shell by copying cmd.exe to alg.exe.\n\n**Persistence**\n\nAfter initial execution, Turian establishes persistence by creating the file tmp.bat in the current working directory, writing the\nfollowing lines to the file, then running the file:\n\nReG aDd HKEY_CURRENT_USER\\sOFtWArE\\MIcrOsOft\\WindOwS\\CurRentVeRsiOn\\RuN /v Turian_filename> /t\nREG_SZ /d “<location_of_Turian_on_disk>\\<Turian_fiilename>” /f\n\nReG aDd HKEY_LOCAL_MACHINE\\sOFtWArE\\MIcrOsOft\\WindOwS\\CurRentVeRsiOn\\RuN /v <Turian_filename> /t\nREG_SZ /d “<location_of_Turian_on_disk>\\<Turian_fiilename>” /f\n\n\n-----\n\ndel %0\n\nTurian then checks for the presence of the file Sharedaccess.ini in its working directory. If that file is present, Turian\nattempts to load the C&C IP or domain from there, if present. We did not observe Turian pass IPs or domains in this manner\nbut testing confirmed Turian looks to load the C&C address from here first. After checking Sharedaccess.ini, Turian\nattempts to connect with a hardcoded IP or domain and sets up its network encryption protocol.\n\n**Network encryption**\n\nQuarian is known to have used both an eight-byte XOR key (see Talos on _[Quarian: Reversing the C&C Protocol) and an](https://blog.talosintelligence.com/2012/12/quarian.html)_\neight-byte nonce to create a session key (see ThreatConnect on Quarian Network Protocol Analysis in Divide and Conquer:\n_Unmasking China’s ‘Quarian’ Campaigns Through Community). Turian has a distinct method for exchanging network_\nencryption keys. See Figure 4 for a breakdown of the Turian network encryption setup.\n\n_Figure 4. Turian network encryption setup_\n\nAfter receiving the last 56-byte packet, Turian calls the network encryption initialization function in Figure 5, and accepts the\n56 bytes of data in the last C&C packet as the only argument.\n\n\n-----\n\n_Figure 5. Hex-Rays decompiled view of the encryption key initialization function_\n\nA second network encryption setup was also observed, as depicted in Figure 6.\n\n\n-----\n\n_Figure 6. Second Turian network encryption set up protocol_\n\nThe last iteration of the four-iteration loop (QWORD byte[5]) is used as the seed for the key initialization function, as shown\nbelow in Figure 7.\n\n\n-----\n\n_Figure 7. Second key initialization function_\n\n### Operator commands\n\nThe full list of Turian operator commands is shown in Table 1.\n\n_Table 1. Turian C&C commands_\n\n**ID** **Description**\n\n0x01 Get system information including OS version, memory usage, local hostname, system adapter info, internal\nIP, current username, state of the directory service installation and domain data.\n\n0x02 Interactive shell – copy %WINDIR%\\system32\\cmd.exe to %WINDIR%\\alg.exe and spawn alg.exe in a new\nthread.\n\n0x03 Spawn a new thread, acknowledge the command and wait for one of the three-digit commands below.\n\n0x04 Take screenshot.\n\n\n-----\n\n**ID** **Description**\n\n0x103/203 Write file.\n\n0x403 List directory.\n\n0x503 Move file.\n\n0x603 Delete file.\n\n0x703 Get startup info.\n\n## Targeting removable media\n\nA subset of victims was targeted with data collection executables that were designed to look for removable media (most\nlikely USB flash drives). The implant routinely scans for such drives, specifically targeting removable media (return value of\nGetDriveType is 2). If found, the implant uses an embedded version of WinRAR to execute these hardcoded commands:\n\nCMD.exe /C %s a -m5 -hp1qaz@WSX3edc -r %s %s\\\\*.*\nCMD.exe /C %s a -m5 -hpMyHost-1 -r %s %s\\\\*.*\nCMD.exe /C rd /s /q \\”%s”\\\n\nThe parameters in the command break out to:\n\na == add files to archive\n-m[0:5] == compression level\n-hp<password>\n-r == recurse subdirectories\nrd == remove directory\n/s == delete a directory tree\n/q == quiet mode\n\\”%s”\\ == directory to act on\n\nThe implant, upon detecting a removable media being inserted, attempts to copy all the files on the drive to a passwordprotected archive and puts the archive in the following directory, which is hardcoded and so the same for every victim:\n\nC:\\RECYCLER\\S-1-3-33-854245398-2067806209-0000980848-2003\\\n\nThe implant also has the capability to delete files, based on the third command listed above.\n\n### Remote access tools\n\nOccasionally, BackdoorDiplomacy’s operators require a greater degree of access or more interactivity than that provided by\n[Turian. On those occasions, they employ open-source remote access tools such as Quasar, which offers a wide variety of](https://github.com/quasar/Quasar)\ncapabilities and runs on virtually all versions of Windows.\n\n## Linux\n\n[We discovered, via a shared C&C server domain, a Linux backdoor using similar network infrastructure and that was](https://isc.sans.edu/diary/F5+BigIP+vulnerability+exploitation+followed+by+a+backdoor+implant+attempt/26322)\ndeployed after exploiting a known vulnerability in F5 BIG-IP load balancers’ traffic management user interface (TMUI),\n[which permits remote code execution (RCE). The Linux variant attempts to persist by writing itself to /etc/init.d/rc.local](https://www.programmersought.com/article/62905849883/)\n\nNext, it runs through a loop to extract strings from memory:\n\nbash -version\necho $PWD\n/bin/sh\n/tmp/AntiVirtmp\neth0\n/proc/%d/exe\n\n\n-----\n\nThen, it calls its daemon function and forks off a child process which then begins the work of decrypting the C&C IP address\nand/or domain name then initiates a loop that reaches out to the C&C using Mozilla/5.0 (X11; Linux i686; rv:22.0)\nFirefox/22.0 as its user-agent. This C&C loop continues until a successful connection is made. Once a connection is\nestablished, the Linux agent goes through a similar network encryption setup to what the Windows version of Turian carries\nout. See Figure 8 for the network encryption protocol used by the Linux variant of Turian.\n\n_Figure 8. Linux Turian variant – network encryption protocol setup routine_\n\nAfter receiving the last 56-byte packet, the Linux agent calls the network encryption key initialization function depicted in\nFigure 9.\n\n\n-----\n\n_Figure 9. Hex-Rays decompiled network encryption key initialization function_\n\nUpon successful completion of the network protocol setup, it forks off another child process and attempts to spawn a TTY\nreverse shell :\n\npython -c ‘import pty; pty.spawn(“/bin/sh”)’\n\n## Conclusion\n\nBackdoorDiplomacy is a group that primarily targets diplomatic organizations in the Middle East and Africa, and less\nfrequently, telecommunication companies. Their initial attack methodology is focused on exploiting vulnerable internetexposed applications on webservers, in order to drop and execute a webshell. Post compromise, via the webshell,\nBackdoorDiplomacy deploys open-source software for reconnaissance and information gathering, and favors the use of\nDLL search order hijacking to install its backdoor, Turian. Finally, BackdoorDiplomacy employs a separate executable to\ndetect removable media, likely USB flash drives, and copy their contents to the main drive’s recycle bin.\n\nBackdoorDiplomacy shares tactics, techniques, and procedures with other Asian groups. Turian likely represents a next\nstage evolution of Quarian, the backdoor last observed in use in 2013 against diplomatic targets in Syria and the United\nStates. Turian’s network encryption protocol is nearly identical to the network encryption protocol used by Whitebird, a\nbackdoor operated by Calypso, another Asian group. Whitebird was deployed within diplomatic organizations in Kazakhstan\nand Kyrgyzstan during the same timeframe as BackdoorDiplomacy (2017-2020). Additionally, BackdoorDiplomacy and\nAPT15 use the same techniques and tactics to drop their backdoors on systems, namely the aforementioned DLL search\norder hijacking.\n\nBackdoorDiplomacy is also cross-platform group targeting both Windows and Linux systems. The Linux variant of Turian\nshares the same network encryption protocol characteristics and attempts to return a TTY reverse shell to the operator.\n\n## IoCs\n\n### Samples\n\n\n**SHA-1** **Filename**\n\n\n**ESET Detection**\n**Name** **Description**\n\n\n3C0DB3A5194E1568E8E2164149F30763B7F3043D logout.aspx ASP/Webshell.H BackdoorDiplomacy\nwebshell – variant\nN2\n\n\n-----\n\n**SHA-1** **Filename**\n\n\n**ESET Detection**\n**Name** **Description**\n\n\n32EF3F67E06C43C18E34FB56E6E62A6534D1D694 current.aspx ASP/Webshell.O BackdoorDiplomacy\nwebshell – variant\nS1\n\n8C4D2ED23958919FE10334CCFBE8D78CD0D991A8 errorEE.aspx ASP/Webshell.J BackdoorDiplomacy\nwebshell – variant\nN1\n\nC0A3F78CF7F0B592EF813B15FC0F1D28D94C9604 App_Web_xcg2dubs.dll MSIL/Webshell.C BackdoorDiplomacy\nwebshell – variant\nN3\n\nCDD583BB6333644472733617B6DCEE2681238A11 N/A Linux/Agent.KD Linux Turian\nbackdoor\n\nFA6C20F00F3C57643F312E84CC7E46A0C7BABE75 N/A Linux/Agent.KD Linux Turian\nbackdoor\n\n5F87FBFE30CA5D6347F4462D02685B6E1E90E464 ScnCfg.exe Win32/Agent.TGO Windows Turian\nbackdoor\n\nB6936BD6F36A48DD1460EEB4AB8473C7626142AC VMSvc.exe Win32/Agent.QKK Windows Turian\nbackdoor\n\nB16393DFFB130304AD627E6872403C67DD4C0AF3 svchost.exe Win32/Agent.TZI Windows Turian\nbackdoor\n\n9DBBEBEBBA20B1014830B9DE4EC9331E66A159DF nvsvc.exe Win32/Agent.UJH Windows Turian\nbackdoor\n\n564F1C32F2A2501C3C7B51A13A08969CDC3B0390 AppleVersions.dll Win64/Agent.HA Windows Turian\nbackdoor\n\n6E1BB476EE964FFF26A86E4966D7B82E7BACBF47 MozillaUpdate.exe Win32/Agent.UJH Windows Turian\nbackdoor\n\nFBB0A4F4C90B513C4E51F0D0903C525360FAF3B7 nvsvc.exe Win32/Agent.QAY Windows Turian\nbackdoor\n\n2183AE45ADEF97500A26DBBF69D910B82BFE721A nvsvcv.exe Win32/Agent.UFX Windows Turian\nbackdoor\n\n849B970652678748CEBF3C4D90F435AE1680601F efsw.exe Win32/Agent.UFX Windows Turian\nbackdoor\n\nC176F36A7FC273C9C98EA74A34B8BAB0F490E19E iexplore32.exe Win32/Agent.QAY Windows Turian\nbackdoor\n\n626EFB29B0C58461D831858825765C05E1098786 iexplore32.exe Win32/Agent.UFX Windows Turian\nbackdoor\n\n40E73BF21E31EE99B910809B3B4715AF017DB061 explorer32.exe Win32/Agent.QAY Windows Turian\nbackdoor\n\n255F54DE241A3D12DEBAD2DF47BAC5601895E458 Duser.dll Win32/Agent.URH Windows Turian\nbackdoor\n\nA99CF07FBA62A63A44C6D5EF6B780411CF1B1073 Duser.dll Win64/Agent.HA Windows Turian\nbackdoor\n\n934B3934FDB4CD55DC4EA1577F9A394E9D74D660 Duser.dll Win32/Agent.TQI Windows Turian\nbackdoor\n\nEF4DF176916CE5882F88059011072755E1ECC482 iexplore32.exe Win32/Agent.QAY Windows Turian\nbackdoor\n\n\n-----\n\n### Network\n\n**C&Cs**\n\n**AS** **Hoster** **IP address** **Domain**\n\nAS20473 AS-CHOOPA 199.247.9[.]67 bill.microsoftbuys[.]com\n\nAS132839 POWER LINE DATACENTER 43.251.105[.]218 dnsupdate.dns2[.]us\n\n43.251.105[.]222\n\nAS40065 Cnservers LLC 162.209.167[.]154\n\nAS132839 POWER LINE DATACENTER 43.225.126[.]179 www.intelupdate.dns1[.]us\n\nAS46573 LAYER-HOST 23.247.47[.]252 www.intelupdate.dns1[.]us\n\nAS132839 POWER LINE DATACENTER 43.251.105[.]222 winupdate.ns02[.]us\n\nAS40065 Cnservers LLC 162.209.167[.]189\n\nAS25820 IT7NET 23.83.224[.]178 winupdate.ns02[.]us\n\n23.106.140[.]207\n\nAS132839 POWER LINE DATACENTER 43.251.105[.]218\n\nAS20473 AS-CHOOPA 45.76.120[.]84 icta.worldmessg[.]com\n\nAS20473 AS-CHOOPA 78.141.243[.]45\n\n78.141.196[.]159 Infoafrica[.]top\n\n45.77.215[.]53 szsz.pmdskm[.]top\n\n207.148.8[.]82 pmdskm[.]top\n\nAS132839 POWER LINE DATACENTER 43.251.105[.]139 www.freedns02.dns2[.]us\n\n43.251.105[.]139 web.vpnkerio[.]com\n\nAS20473 AS-CHOOPA 45.77.215[.]53\n\nAS135377 UCloud (HK) Holdings Group Limited 152.32.180[.]34\n\nAS132839 POWER LINE DATACENTER 43.251.105[.]218 officeupdates.cleansite[.]us\n\nAS25820 IT7NET 23.106.140[.]207 dynsystem.imbbs[.]in\n\nofficeupdate.ns01[.]us\n\nsysteminfo.oicp[.]net\n\nAS40676 Psychz Networks 23.228.203[.]130 systeminfo.myftp[.]name\n\nsysteminfo.cleansite[.]info\n\nupdateip.onmypc[.]net\n\nbuffetfactory.oicp[.]io\n\n**Registrars**\n\n**Registrar** **Domain**\n\nexpdns[.]net update.officenews365[.]com\n\n\n-----\n\n**Registrar** **Domain**\n\nezdnscenter[.]com bill.microsoftbuys[.]com\n\nchangeip[.]org dnsupdate.dns2[.]us\n\ndnsupdate.dns1[.]us\n\nwww.intelupdate.dns1[.]us\n\nwinupdate.ns02[.]us\n\nwww.freedns02.dns2[.]us\n\nofficeupdates.cleansite[.]us\n\nofficeupdate.ns01[.]us\n\nsysteminfo.cleansite[.]info\n\nupdateip.onmypc[.]net\n\nhichina[.]com Infoafrica[.]top\n\ndomaincontrol[.]com web.vpnkerio[.]com\n\nexhera[.]com dynsystem.imbbs[.]in\n\nsysteminfo.oicp[.]net\n\n## MITRE ATT&CK techniques\n\n_[Note: This table was built using version 9 of the MITRE ATT&CK framework.](https://attack.mitre.org/resources/versions/)_\n\n**Tactic** **ID** **Name** **Description**\n\n\nInitial\nAccess\n\n\n[T1190](https://attack.mitre.org/versions/v9/techniques/T1190/) Exploit Public-Facing Application BackdoorDiplomacy exploits the\nvulnerability CVE-2020-5902.\n\n\nExecution [T1059.003](https://attack.mitre.org/versions/v9/techniques/T1059/003/) Windows Command Shell Turian relies on a batch script to create\npersistence.\n\n\n[T1203](https://attack.mitre.org/versions/v9/techniques/T1203/) Exploitation for\nClient Execution\n\n\nTurian has exploited client software\nvulnerabilities for execution, such as CVE2020-5902.\n\n\nPersistence [T1547.001](https://attack.mitre.org/versions/v9/techniques/T1547/001/) Registry Run Keys / Startup Folder Turian uses the HKLM and HKCU\nCurrentVersion Run keys to persist after\nreboot.\n\n\n[T1548.002](https://attack.mitre.org/versions/v9/techniques/T1548/002/) Bypass User\nAccount Control\n\n\nTurian uses JuicyPotato to bypass UAC.\n\n\nPrivilege\nEscalation\n\n\n[T1547.001](https://attack.mitre.org/versions/v9/techniques/T1547/001/) Registry Run Keys / Startup Folder Turian uses the HKLM and HKCU\nCurrentVersion Run keys to persist after\nreboot.\n\n\n[T1548.002](https://attack.mitre.org/versions/v9/techniques/T1548/002/) Bypass User\nAccount Control\n\n\nTurian uses JuicyPotato to bypass UAC.\n\n\nDefense\nEvasion\n\n\n[T1140](https://attack.mitre.org/versions/v9/techniques/T1140/) Deobfuscate/Decode Files or Information Turian uses VMProtect to obfuscate its\ncode.\n\n\n[T1550](https://attack.mitre.org/versions/v9/techniques/T1550/) Use Alternate\nAuthentication\nMaterial\n\n\nTurian uses Mimikatz.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1083](https://attack.mitre.org/versions/v9/techniques/T1083/) File and Directory\nDiscovery\n\n\nTurian lists drives.\n\n\nDiscovery [T1550](https://attack.mitre.org/versions/v9/techniques/T1550/) Use Alternate Authentication Material Turian uses Mimikatz.\n\n\nLateral\nMovement\n\n\n[T1005](https://attack.mitre.org/versions/v9/techniques/T1005/) Data from Local System Turian collects files from the victim’s\nmachine.\n\n\nCollection [T1113](https://attack.mitre.org/versions/v9/techniques/T1113/) Screen Capture Turian captures screenshots.\n\n[T1071.001](https://attack.mitre.org/versions/v9/techniques/T1071/001/) Web Protocols Turian uses HTTP to communicate with the\nC&C server.\n\n\nCommand\nand Control\n\n\n[T1573.001](https://attack.mitre.org/versions/v9/techniques/T1573/001/) Symmetric Cryptography Turian uses XOR routine to encrypt\ncommunication with the C&C server.\n\n\n[T1095](https://attack.mitre.org/versions/v9/techniques/T1095/) Non-Application\nLayer Protocol\n\n10 Jun 2021 - 02:00PM\n\n\nTurian uses raw sockets to communicate\nwith the C&C server.\n\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n\n-----\n\n### Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-10 - BackdoorDiplomacy- Upgrading from Quarian to Turian.pdf"
    ],
    "report_names": [
        "2021-06-10 - BackdoorDiplomacy- Upgrading from Quarian to Turian.pdf"
    ],
    "threat_actors": [
        {
            "id": "709ceea7-db99-405e-b5a7-a159e6c307e0",
            "created_at": "2022-10-25T16:07:23.373699Z",
            "updated_at": "2025-03-27T02:02:09.768341Z",
            "deleted_at": null,
            "main_name": "BackdoorDiplomacy",
            "aliases": [],
            "source_name": "ETDA:BackdoorDiplomacy",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3b56d733-88da-4394-b150-d87680ce67e4",
            "created_at": "2023-01-06T13:46:39.287189Z",
            "updated_at": "2025-03-27T02:00:03.040775Z",
            "deleted_at": null,
            "main_name": "BackdoorDiplomacy",
            "aliases": [
                "BackDip",
                "CloudComputating",
                "Quarian"
            ],
            "source_name": "MISPGALAXY:BackdoorDiplomacy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4f7cf97-9c98-409c-8b95-b80d14c576a5",
            "created_at": "2022-10-25T16:07:24.561104Z",
            "updated_at": "2025-03-27T02:02:10.281202Z",
            "deleted_at": null,
            "main_name": "Shadow Brokers",
            "aliases": [],
            "source_name": "ETDA:Shadow Brokers",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3c5b0e7e-2388-4b63-9b97-6b027bec4bf7",
            "created_at": "2023-01-06T13:46:39.068694Z",
            "updated_at": "2025-03-27T02:00:02.989445Z",
            "deleted_at": null,
            "main_name": "Calypso",
            "aliases": [
                "BRONZE MEDLEY"
            ],
            "source_name": "MISPGALAXY:Calypso",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "13d9c5fc-af82-4474-90dd-188c4e40a399",
            "created_at": "2022-10-25T16:07:23.435079Z",
            "updated_at": "2025-03-27T02:02:09.800346Z",
            "deleted_at": null,
            "main_name": "Calypso",
            "aliases": [
                "Bronze Medley"
            ],
            "source_name": "ETDA:Calypso",
            "tools": [
                "Agent.dhwf",
                "Byeby",
                "Calypso RAT",
                "DCSync",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EternalBlue",
                "EternalRomance",
                "FlyingDutchman",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "NBTscan",
                "OS_Check_445",
                "PlugX",
                "Quarks PwDump",
                "RedDelta",
                "SAMRID",
                "Sogu",
                "SysInternals",
                "TCP Port Scanner",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Whitebird",
                "Xamtrav",
                "ZXPortMap",
                "nbtscan",
                "netcat"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "0a03e7f0-2f75-4153-9c4f-c46d12d3962e",
            "created_at": "2022-10-25T15:50:23.453824Z",
            "updated_at": "2025-03-27T02:00:55.473216Z",
            "deleted_at": null,
            "main_name": "Ke3chang",
            "aliases": [
                "Ke3chang",
                "APT15",
                "Vixen Panda",
                "GREF",
                "Playful Dragon",
                "RoyalAPT",
                "Nylon Typhoon"
            ],
            "source_name": "MITRE:Ke3chang",
            "tools": [
                "Okrum",
                "Systeminfo",
                "netstat",
                "spwebmember",
                "Mimikatz",
                "Tasklist",
                "MirageFox",
                "Neoichor",
                "ipconfig"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "171b85f2-8f6f-46c0-92e0-c591f61ea167",
            "created_at": "2023-01-06T13:46:38.830188Z",
            "updated_at": "2025-03-27T02:00:02.929729Z",
            "deleted_at": null,
            "main_name": "The Shadow Brokers",
            "aliases": [
                "Shadow Brokers",
                "ShadowBrokers",
                "The ShadowBrokers",
                "TSB"
            ],
            "source_name": "MISPGALAXY:The Shadow Brokers",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7c8cf02c-623a-4793-918b-f908675a1aef",
            "created_at": "2023-01-06T13:46:38.309165Z",
            "updated_at": "2025-03-27T02:00:02.801298Z",
            "deleted_at": null,
            "main_name": "APT15",
            "aliases": [
                "BRONZE PALACE",
                "Nylon Typhoon",
                "VIXEN PANDA",
                "Playful Dragon",
                "BRONZE DAVENPORT",
                "BRONZE IDLEWOOD",
                "G0004",
                "Red Vulture",
                "Ke3Chang",
                "Metushy",
                "Lurid",
                "Social Network Team",
                "Royal APT"
            ],
            "source_name": "MISPGALAXY:APT15",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7d5531e2-0ad1-4237-beed-af009035576f",
            "created_at": "2024-05-01T02:03:07.977868Z",
            "updated_at": "2025-03-27T02:05:17.283109Z",
            "deleted_at": null,
            "main_name": "BRONZE PALACE",
            "aliases": [
                "BRONZE DAVENPORT ",
                "BRONZE IDLEWOOD ",
                "CTG-9246 ",
                "Ke3chang ",
                "Playful Dragon",
                "Vixen Panda ",
                "APT15 "
            ],
            "source_name": "Secureworks:BRONZE PALACE",
            "tools": [
                " BS2005",
                " Enfal",
                " Mirage",
                " RoyalCLI",
                " RoyalDNS",
                "BMW"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "17b1b76b-16da-4c4f-8b32-f6fede3eda8c",
            "created_at": "2022-10-25T16:07:23.750796Z",
            "updated_at": "2025-03-27T02:02:09.961401Z",
            "deleted_at": null,
            "main_name": "Ke3chang",
            "aliases": [
                "APT 15",
                "BackdoorDiplomacy",
                "Bronze Davenport",
                "Bronze Idlewood",
                "Bronze Palace",
                "CTG-9246",
                "GREF",
                "Ke3chang",
                "Metushy",
                "Nylon Typhoon",
                "Operation Ke3chang",
                "Operation MirageFox",
                "Playful Dragon",
                "Playful Taurus",
                "Red Vulture",
                "Royal APT",
                "Social Network Team",
                "Vixen Panda"
            ],
            "source_name": "ETDA:Ke3chang",
            "tools": [
                "Agentemis",
                "Anserin",
                "BS2005",
                "BleDoor",
                "CarbonSteal",
                "Cobalt Strike",
                "CobaltStrike",
                "DarthPusher",
                "DoubleAgent",
                "EternalBlue",
                "GoldenEagle",
                "Graphican",
                "HenBox",
                "HighNoon",
                "IRAFAU",
                "Ketrican",
                "Ketrum",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MS Exchange Tool",
                "Mebroot",
                "Mimikatz",
                "MirageFox",
                "NBTscan",
                "Okrum",
                "PluginPhantom",
                "PortQry",
                "ProcDump",
                "PsList",
                "Quarian",
                "RbDoor",
                "RibDoor",
                "Royal DNS",
                "RoyalCli",
                "RoyalDNS",
                "SAMRID",
                "SMBTouch",
                "SilkBean",
                "Sinowal",
                "SpyWaller",
                "Theola",
                "TidePool",
                "Torpig",
                "Turian",
                "Winnti",
                "XSLCmd",
                "cobeacon",
                "nbtscan",
                "netcat",
                "spwebmember"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "401a2035-ed5a-4795-8e37-8b7465484751",
            "created_at": "2022-10-25T15:50:23.616232Z",
            "updated_at": "2025-03-27T02:00:55.506403Z",
            "deleted_at": null,
            "main_name": "BackdoorDiplomacy",
            "aliases": [
                "BackdoorDiplomacy"
            ],
            "source_name": "MITRE:BackdoorDiplomacy",
            "tools": [
                "Turian",
                "China Chopper",
                "Mimikatz",
                "NBTscan",
                "QuasarRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535711,
    "ts_updated_at": 1743041834,
    "ts_creation_date": 1655093035,
    "ts_modification_date": 1655093035,
    "files": {
        "pdf": "https://archive.orkl.eu/532eb5e9a24e3d1423b3a5d75e14776ea4d89bbc.pdf",
        "text": "https://archive.orkl.eu/532eb5e9a24e3d1423b3a5d75e14776ea4d89bbc.txt",
        "img": "https://archive.orkl.eu/532eb5e9a24e3d1423b3a5d75e14776ea4d89bbc.jpg"
    }
}