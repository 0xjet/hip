{
    "id": "7d81abed-26e3-4be8-8f9c-cfe398c241cb",
    "created_at": "2025-03-06T02:05:54.518181Z",
    "updated_at": "2025-03-27T02:12:11.061337Z",
    "deleted_at": null,
    "sha1_hash": "b130c081c89a51831e4cbaf5ce20cc4ea5ec614c",
    "title": "",
    "authors": "",
    "file_creation_date": "2023-06-07T19:30:37Z",
    "file_modification_date": "2023-06-07T19:30:37Z",
    "file_size": 25920826,
    "plain_text": "# Compromising the Keys to the Kingdom: Exfiltrating Data to Own and Operate the Exploited Systems\n\n###### Aditya K Sood Sr. Director of Threat Research and Security Strategy Office of the CTO, F5\n\n\n-----\n\n##### ▪ Dr. Aditya K Sood\n\n#### • Security Practitioner and Researcher\n • Working in the security field for more than 15 years\n\nà At present, Sr. Director of Threat Research and Security Strategy, Office of the CTO, F5\n\n#### • Regular speaker at industry leading security conferences\n • Author of “Targeted Cyber Attacks” and “Empirical Cloud Security” Books\n • W: https://www.adityaksood.com\n • T: @adityaksood \n • LinkedIn: https://www.linkedin.com/adityaks\n\n\n-----\n\n###### Research presented in this talk is for sharing intelligence with security community to strengthen the efforts for enhancing the security of critical\n infrastructure and protecting users on the Internet.\n\n\n-----\n\n-----\n\n-----\n\n##### ▪ Advanced malicious code running inside the systems and capable of:\n\n#### • subverting the integrity and confidentiality of system including data.\n • launching network attacks and exploit additional systems\n • exfiltrating sensitive data from compromised cloud workloads\n • transforming organizational cloud assets to launchpads for conducting cybercrime\n • abusing the internal cloud environment controls for unauthorized operations\n • impacting the organizational operations, customers and brand value\n\n##### ▪ Advanced threats characteristics: actions ?\n\n#### • masquerading, tampering, hijacking, subverting, persistence, modification, evasion, etc.\n\n##### ▪ Threat actors - that own and operate advanced threats !\n\n#### • attackers, malicious insiders, nation-state actor, cybercriminals and others\n\n\n-----\n\nInformation Remote\n\nPayload\n\nRansomware Stealers Administration\n\nDownloaders\n\nToolkits (RATs)\n\nMalicious code Stealing credentials, Wrapper\ntargeting users for sensitive data from Used for privilege packages used for\n\nmonetary gains compromised escalation, lateral downloading exploit\n\nsystems to conduct movement and\n\npayloads – (Drive-by\n\nfraud maintaining\n\nDownload Attacks)\n\npersistence\n\nService Booters Scanners and Communication\n\nCryptominers\n\nExploit Hijackers\n\nAbusing network Frameworks\n\nUtilizing the\n\nprotocols for Malicious code used\n\ncompromised\n\nsubverting service to hijack\n\nsystems to mine Scanning, Phishing\n\navailability by communication\n\ncrypto currency via and exploiting\n\nlaunching DDoS channels to conduct\n\nCryptojacking vulnerable systems\n\nMitM, MitC and\n\nMitB attacks\n\n\n-----\n\n#### Advanced Attacks and Malicious Code\n Case Studies\n\n\n-----\n\nAttacker / TeamTNT\n\nInfected\n\nPod\n(1) Kubernetes\n\n(2) Cluster\n\nNode\n\nCompromised\n\nKubelet\n\n(5) (3)\n\n1. The attacker exploits exposed and vulnerable Kubelet.\n2. The attacker compromises the pods (installing utilities to trigger\nprivilege escalation and launch reverse shell) running in a\nspecific node in targeted Kubernetes cluster (4)\n3. Malicious payloads are downloaded from the remote location\nfrom the Internet\n4. The compromised pod environment is enhanced by installing\n\nMalicious Payload Server\n\nnew packages such as Nvidia drivers to enhance the GPU Command and Control\ncapabilities (C&C) Server\n5. Compromised nod is then used to install crypt miners to start\ncrypto mining operations\n\n\n-----\n\n###### Kubernetes root payloads (scripts ) are fetched from the\n NVIDIA drivers were fetched and installed on the\n compromised node which install XMLRig crypto miner\n compromised pod (running in nodes) to conduct robust\n crypto mining operations\n\n\n-----\n\n###### MongoDB database infected with ransomware\n\n Elasticsearch database infected with ransomware\n\n\n-----\n\n###### Enfilade Tool: Detecting ransomware infection in MongoDB\n databases\n\n Strafer Tool: Detecting ransomware infection in\n Elasticsearch databases\n\n\n-----\n\n###### Loki: bot management commands\n\n Loki Botnet: data exfiltration techniques used to own, operate and exfiltrate data from compromised systems\n\n\n-----\n\n###### Loki RAT: toolkit used to successfully infiltrate into\n government systems and exfiltrate data\n\n\n-----\n\n|Loki RAT: Data Exfiltration Case|Col2|Col3|Col4|\n|---|---|---|---|\n|Loki RAT: exfiltrating me|||eting recordings|\n|||||\n|||||\n\n\n###### Loki RAT: exfiltrating meeting recordings\n\n Loki RAT: examples of exfiltrated data\n using known techniques.\n\n Loki RAT: exfiltrating email client screenshots\n\n\n-----\n\n|Col1|Col2|Col3|Col4|\n|---|---|---|---|\n|||||\n|Nexus Stealer||||\n|||||\n\n\n###### Aurora Stealer\n\n Titan Stealer\n\n Nexus Stealer\n\n\n-----\n\n#### Need of the Hour - Exploiting Command\n\n###### and Control (C&C) panels (crimeware) to extract and analyze exfiltrated data related to\n compromised systems to generate threat intelligence and design proactive strategies to\n combat future threats\n\n\n-----\n\n##### ▪ restrict the infections by jamming\n\n###### the communication between the\n\n compromised systems and the C&C\n\n panel\n\n##### ▪ generate threat intelligence by\n\n###### analyzing the inherent\n\n functionalities of the bot\n\n##### ▪ analyze the exfiltrated data from the\n\n###### compromised systems to determine\n\n potential security breaches\n\n\n-----\n\n###### Nexus Android C&C Panel\n\n Successful Exploitation of SQL Injection\n Vulnerability in C&C Panel\n\n\n-----\n\n###### Successful compromise of Nexus Android botnet C&C\n panel resulting significant information disclosure and\n internal design\n\n\n-----\n\n-----\n\n###### Scanning the SystemBC C&C host resulted in number of TCP ports being opened. On further analysis, it was Let’s see if we can connect to this TCP port via\n discovered remote host was running proxy services. browser.\n Check for TCP port 4011.\n\n\n-----\n\n###### Testing client should be seen as an infected system in\n the list of compromised systems in the C&C\n\n After specifying the SOCKS5 proxy address “93.115.29.50” on TCP port 4011, HTTP proxy was\n Test browser was used to configure SOCKS5 proxy\n configured using the IP address of the testing client.\n with IP address and TCP port 4011 obtained earlier\n while scanning the C&C host.\n\n\n-----\n\n###### On accessing the C&C panel. The testing client IP address was added to the list of compromised system\n in the SystemBC C&C panel.\n\n This shows how scanning the remote C&C host\n and analyzing SOCKS5 proxy ports, once can\n enumerate the list of infected systems on the\n Internet.\n\n\n-----\n\n## Demo\n\n\n-----\n\n###### Data Dumped as zip files on the C&C host\n\n Crash Loader C&C Panel – Exposed “statistics.php” Webpage\n\n\n-----\n\n###### BlackGuard stores stolen data from the compromised machines in zipped files on the\n C&C server\n\n\n-----\n\n###### Mars stealer: At first, guest access was not obtained to the C&C host. Guest access was\n obtained if default key is known.\n\n\n-----\n\n#### Cyber Wars and Data Abuse Paradigm\n\n\n-----\n\n###### Data Destruction\n\nMalicious Code: System Wipers,\n\n###### • System sabotage Ransomware, etc.\n • Render data useless and ineffective\n\nSystem Compromise Data Exfiltration\n\nMalicious Code: Advanced\n\n###### • Steal Intellectual Property (IP) information stealers, RATs, etc.\n • Exfiltrate critical data\n\nNetwork Breach\n\nThreat Actor: Nation- Denial of Service\n\nstate adversaries,\nCybercriminals, etc. Malicious Code: Bots, Booters, etc.\n\n###### • Denying access to critical network services\n • Exfiltrate Critical Data\n\n\n-----\n\n###### Stage 1 Infection Stage 2 Infection\n\n Overwrite the Master Boot Record\n\n File Wiping Code\n\n Display a Fake Ransom Note\n\n Targeted File Types for\n Corrupting Records\n\n\n-----\n\n###### Targeted File Types for\n Corrupting Records\n\n\n-----\n\n-----\n\n-----\n\n##### ▪ Data is new currency\n\n ▪ Using an offensive approach to threat research help to generate threat intelligence\n\n ▪ Vulnerabilities in C&C panels reveal the weaknesses that exist in the server-side software\n\n###### used by the botnet (malware) operators to command and control the malicious code\n\n running on compromised systems\n\n##### ▪ Information from C&C panels can help to build indicators of compromise (IoCs)\n\n ▪ Understanding the design of C&C internals helps us to gain intelligence\n\n ▪ Intelligence gained from the C&C panels can be used to harden security solutions\n\n ▪ Threat intelligence allows building threat profiles to understand the threat landscape\n\n###### better\n\n\n-----\n\n##### Questions or Queries?\n\n Thank you!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.first.org/resources/papers/conf2023/FIRSTCON23-TLPCLEAR-Sood-Compromising-the-Keys-to-the-Kingdom.pdf"
    ],
    "report_names": [
        "FIRSTCON23-TLPCLEAR-Sood-Compromising-the-Keys-to-the-Kingdom.pdf"
    ],
    "threat_actors": [
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1741226754,
    "ts_updated_at": 1743041531,
    "ts_creation_date": 1686166237,
    "ts_modification_date": 1686166237,
    "files": {
        "pdf": "https://archive.orkl.eu/b130c081c89a51831e4cbaf5ce20cc4ea5ec614c.pdf",
        "text": "https://archive.orkl.eu/b130c081c89a51831e4cbaf5ce20cc4ea5ec614c.txt",
        "img": "https://archive.orkl.eu/b130c081c89a51831e4cbaf5ce20cc4ea5ec614c.jpg"
    }
}