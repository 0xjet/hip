{
    "id": "d565cbee-5b6f-446c-bab5-8510e38d91c8",
    "created_at": "2023-01-12T15:09:46.236336Z",
    "updated_at": "2025-03-27T02:15:17.333552Z",
    "deleted_at": null,
    "sha1_hash": "a7c49f0823d110d9c31bc4a198bcf10eebfbaf75",
    "title": "2022-11-06 - Analysis Of Netwire RAT",
    "authors": "",
    "file_creation_date": "2022-12-29T00:23:57Z",
    "file_modification_date": "2022-12-29T00:23:57Z",
    "file_size": 1947093,
    "plain_text": "# Analysis of Netwire RAT\n\n**lmntrix.com/lab/analysis-of-netwire-rat/**\n\nThe NetWire RAT is malicious remote access trojan that emerged in the wild in 2012. This\nmulti-platform malware was developed by World Wired Labs, and the program has since\nundergone several developmental upgrades. It is capable of infecting Windows, Linux, Mac\nOS operating systems. The malware developers have another program called PWNDROID\nreleased in mid-2020, for the Android platform. A company advertising the remote access\ntool frequently used by criminals and, nation-state threats may be serving as a front for\nChinese hacking groups, according to new research published recently.\n\nThe PWNDROID Android malware type, which can be used to listen in on targets’ phone\ncalls, capture audio, send and receive text messages, and track victims’ geolocation. Multiple\ngroups with possible ties to the Chinese government, is thought to have used it, according to\nLMNTRIX CDC.\n\nRecent APT attacks which leverage and drop the NetWire payload get distributed via social\nengineering e-mails. This Trojan (RAT) is mainly focused on password stealing and\nkeylogging, as well as including remote control capabilities. Recently, NetWire has been\ndistributed via Microsoft office documents and spreading their secondary payload attacks\nespecially GuLoader campaigns.\n\nTarget OS: Windows, Linux, Mac OS\n\nMotivation: Remote Access Tool & APT Campaigns\n\nThreat Actors: APT33, The White Company & Silver Terrier groups potentially use the\nNetwire RAT.\n\n## Static Analysis\n\nSample: NetWire Remote Access Tool\n\nSHA256: e4029ef5d391b9a380ed98a45f3e5a01eece6b7a1120ab17d6db0f8bb1309a47\n\nFiletype: Portable Executable (EXE)\n\n**Common Anti-Debugging Methods Used**\n\nWhen the sample was loaded into Ollydbg, and we got the disassembly to start with, NetWire\ndisplayed the following error message. In addition to this error message, the malware uses\nNtWow64ReadVirtualMemory64 from NTDLL to query the PEB (process environment block),\n\n\n-----\n\nand a timing based check such as GetTickCount from Kernel32.DLL are used to thwart\ndebugging.\n\n**Keylogger Functions**\n\nBased on the familiar CPP functions & a lot of functions being imported from MSVBVM60,\nMSVCRT and MSCOREE DLL files, we believe the developers may be using Microsoft VC++\nand/or Delphi for NetWire RAT.\n\n\n-----\n\nGetUserName, GetSecurityInfo, GetMonitorInfoA, GetLogonSessionData, and Key Press\nEvents are monitored by the NetWire malware sample. A logged on user’s session data,\nencoded base 64 strings, key state, key press and keyboard events being monitored could\nhint at keylogging functionality.\n\n\n-----\n\nAfter dumping the strings from our sample PE file, and decoding them with IDAPython, we\ncan realize that the keylogger also records and sends login data from popular web browers\nsuch as Firefox, Chrome and Internet Explorer to the NetWire Admin Workstation. The\nNetWire keylogger module encodes the keystrokes logged after stealing credentials from the\nlogged on user, prior to sending it to NetWire Admin Workstation. You can find a copy of the\nNetWire log decoder from GitHub.\n\nRefer [https://github.com/ArsenalRecon/NetWireLogDecoder](https://github.com/ArsenalRecon/NetWireLogDecoder)\n\n**Payment Data Being Stolen**\n\n\n-----\n\nLMNTRIX CDC analysts discovered payment being collected for exfiltration by NetWire\ntrojan while investigating the keylogger module further.\n\n**Remote Access Tool (RAT)**\n\n\n-----\n\nNetwire Developers from World Wired Labs have implemented the remote access tool\nfunctionality using a simple TCP Client-Server model with sockets.\n\n## Dynamic Analysis\n\n**Infection Chain**\n\n\n-----\n\nNetWire infects its victims using initial infection vectors of the mal-spam variety with e-mail\nattachment (EML). It contains a Microsoft Office (Excel) document with VBA macro enabled\ncontent. The malware tricks the user to enable the macros to perform malicious actions.\nOnce the user enables the macro content, using Wscript file to drop a payload file in the\n%temp% folder, it then invokes a web-request and connects with the designated C2 server\nfor further infection.\n\n**Sample Information**\n\n**Technical Analysis of XLS**\n\n\n-----\n\nOnce the user opens the attached document, there s a fake Excel template displaying a\nmessage “Document created in earlier version of MS Excel” upon enabling the content, the\nvictim now views the content. With the help of this malware the threat actor can trick the user\nto view the document, and infect them for further malicious actions.\n\n**Embedded Macro Content: Screenshot 1**\n\n**Embedded Macro Content: Screenshot 2**\n\n\n-----\n\nVBA code in the screenshot (above) is obfuscated with random functions in order to hide the\nexact code. It’s one of the tricks used by the malware author. Macros is a programmable\npattern which translates a certain sequence of input into a preset sequence of output.\nMacros can make tasks less repetitive automating a complicated sequence of keystrokes,\nmouse movements, commands, or other types of user input.\n\n**Macro-Enabled, Process Tree**\n\nOnce the macros are enabled, using the Wscript shell to execute and drop the payload file in\n%temp% folder [ Actual, file will be BIN[.]exe].\n\n**Dropped VBS Script**\n\n\n-----\n\nHere the command is very straight forward, using the cmd[..]exe the malware connects to the\nmalicious domain and drops the payload file in the Windows %temp% folder. The dropped\nvbs file gets executed in %temp% folder as well.\n\n**Dropped Payload file**\n\n**Initial – Indicator of Compromises [IOC]**\n\nOnce communicating with the malicious URL, it’s silently drops a .VBS script file in the\n%AppData% folder to perform further malicious actions.\n\n## Preventive Measures\n\nUsage of anti-malware software such as antivirus or, any endpoint protection such as\nLMNTRIX EDR / EPP with updates.\nBeware of e-mails from unknown contacts or, untrusted external sources.\n\n\n-----\n\nAlways make it a practice to scan attachments that you may find suspicious, especially\nwhen the e-mails are related to financial or delivery correspondence, documents, and\nURLs.\nUse a strong password, preferably 16 to 18 characters, or more with a combination of\nalphabets, numbers and symbols.\nWe recommend using multi factor authentication for website login / passwords for all\nwebsites.\n\n## Indicators of Compromise to detect NetWire RAT\n\nIP Addresses\n\n94[[.]]237[[.]]28[[.]]110\n\n194[[.]]5[[.]]98[[.]]48\n\n185[[.]]183[[.]]98[[.]]166\n\n185[[.]]222[[.]]57[[.]]164\n\n194[[.]]5[[.]]98[[.]]188\n\n171[[.]]22[[.]]30[[.]]21\n\n185[[.]]140[[.]]53[[.]]252\n\n194[[.]]147[[.]]140[[.]]4\n\n87[[.]]66[[.]]106[[.]]20\n\n71[[.]]81[[.]]62[[.]]106\n\n31[[.]]41[[.]]244[[.]]150\n\n154[[.]]118[[.]]25[[.]]216\n\n79[[.]]134[[.]]225[[.]]28\n\n104[[.]]168[[.]]148[[.]]85\n\n185[[.]]140[[.]]53[[.]]61\n\n79[[.]]134[[.]]225[[.]]10\n\n185[[.]]140[[.]]53[[.]]183\n\n184[[.]]75[[.]]221[[.]]171\n\n\n-----\n\n45[[.]]137[[.]]22[[.]]101\n\n213[[.]]152[[.]]161[[.]]133\n\n185[.]29[.]9[.]11\n\nHashes\n\n07336CC7355B9C4A1553A93D24EBB30A502053339E05FFB57476890D2967B6FC\n\n2387DFD712B954C865BB4927F0628C54BF30B9A115B2383C2DFF63456885463A\n\nF488FEAC7359DABA38B793855A5D2369404956892CA23DB7530DC04D77530490\n\nF6226702EC3DED25EC5E0D7D1CBAAE386540E990857EC7604EC93284113B4897\n\n0005A4FB06BB5CACCA4A89B372543A3EFFB0931AF26B0B17D8661B691B401811\n\nE4029EF5D391B9A380ED98A45F3E5A01EECE6B7A1120AB17D6DB0F8BB1309A47\n\nDCAC7C0A08250B164343C102EF9D863A49C44343C6CE3E0CD1197CB7E3198937\n\n8F24221CAEF706D4502572968C0CF1317E632EBCB64157A5A1DAFBDDE7FC642C\n\n1F8B6EBC0FBDB35C0B214652B69360C8DD78B569C9AF9C1B355DD11F277624E2\n\nBC0A8E730EBBE66A98F6AA755671661158A982983898E45D306F79EC608250FE\n\n50050A189F878A24B57ACEDF046ACFE5011DAE30F50A21054A75FCDA2947FF5B\n\n459A609FFDE4325A1E55F7B9A788AB5CF978D3E07C54349B9F9E50F1E6875C89\n\nF631EF4CE81B9A0984D44A9468DB2AE30CB37BDAD67AAEB43F53D50039D8C5AA\n\n0CDC6A0C287876DBCFC14A93CAE8EB6FEB6938142814A9FB4E403F000D469CAB\n\n3AFEECA8EE5FA67BF62BB84C10E02FE82032CBE034CCB4588708367FD5D66E8F\n\n45CFB912F4CEED9DCF0EEE01F36A1C581A0E881301D73A2E1E459E48488B95BA\n\nA21C8EF38B35EDA08AF936729863498EAD8F750DE997BC2D55FF9DA429872E33\n\n848A8084A39B1BFA98C65B0E55BF91460B82470A3F9F5B31D7464C400A9DA355\n\n637E17723EA88878915BA42095680EE5438C22A88A4538137B3174DD4E2E8C6A\n\n4C01CC3DD96C524054207F6B37A334C62549857F\n\nDomains\n\n\n-----\n\n8ea1042a1912[[.]]ngrok[[.]]io\n\ne0fb-34-121-202-111[[.]]ngrok[[.]]io\n\nd61a2ce46962[[.]]ngrok[[.]]io\n\n2d9076b51d13[[.]]ngrok[[.]]io\n\n8ef628b4602c[[.]]ngrok[[.]]io\n\nebc79a7f69ed[[.]]ngrok[[.]]io\n\n3a47ff971faf[[.]]ngrok[[.]]io\n\n30fdb4c296af[[.]]ngrok[[.]]io\n\n192913f09fa8[[.]]ngrok[[.]]io\n\n52e0ff58833f[[.]]ngrok[[.]]io\n\nce47174fc1d2[[.]]ngrok[[.]]io\n\n9ea2ac777bb9[[.]]ngrok[[.]]io\n\n4651479e198f[[.]]ngrok[[.]]io\n\n6856dac09e83[[.]]ngrok[[.]]io\n\n0b1a1cdfc942[[.]]ngrok[[.]]io\n\nc5040e5692cf[[.]]ngrok[[.]]io\n\ne5d6f8fc0027[[.]]ngrok[[.]]io\n\njcole-lms[[.]]ngrok[[.]]io\n\n877de57c5ace[[.]]ngrok[[.]]io\n\ne5927c359c3c[[.]]ngrok[[.]]io\n\nlove82[.]duckdns[.]org\n\nRegistry Entry\n\nHKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\nHKEY_CURRENT_USER\\Software\\NetWire\n\nHKEY CURRENT USER\\Software\\NetWire\\HostId\n\n\n-----\n\n## MITRE ATT&CK Tactics & Techniques\n\nID Tactic Technique\n\n\nTA0001 Initial\nAccess\n\n\nT1566.001 – Spearphishing Attachment T1566.002 –\nSpearphishing Link\n\n\nTA0002 Execution T1027 – Obfuscated Files or Information T1059.005 – Visual\nBasic T1204.002 – Malicious File\n\n\nTA0003\nPersistence\n\nTA0004 Privilege\nEscalation\n\nTA0005 Defense\nEvasion\n\nTA0006 Credential\nAccess\n\n\nT1053.005 – Scheduled Task T1547.001 – Registry Run Keys /\nStartup Folder\n\nT1053.005 – Scheduled Task\n\nT1027.002 – Software Packing T1055 – Process Injection\nT1055.012 – Process Hollowing T1497.001 – System Checks\n\nT1003 – OS Credential Dumping T1110.001 – Password Guessing\nT1555.003 – Credentials from Web Browsers\n\n\nTA0007 Discovery T1016 – System Network Configuration Discovery\n\n\nTA0011 C&C\nServer\n\n\nT1071.001 – Web Protocols T1090 – Proxy T1090.002 – External\nProxy\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-11-06 - Analysis Of Netwire RAT.pdf"
    ],
    "report_names": [
        "2022-11-06 - Analysis Of Netwire RAT.pdf"
    ],
    "threat_actors": [
        {
            "id": "9962552c-9d9d-4627-97f6-4558183fdd7f",
            "created_at": "2022-10-25T15:50:23.448869Z",
            "updated_at": "2025-03-27T02:00:55.472343Z",
            "deleted_at": null,
            "main_name": "The White Company",
            "aliases": [
                "The White Company"
            ],
            "source_name": "MITRE:The White Company",
            "tools": [
                "Revenge RAT",
                "NETWIRE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "aa57c036-b3e5-4bc4-83b8-cac8498b6c24",
            "created_at": "2023-01-06T13:46:38.589041Z",
            "updated_at": "2025-03-27T02:00:02.867594Z",
            "deleted_at": null,
            "main_name": "SilverTerrier",
            "aliases": [],
            "source_name": "MISPGALAXY:SilverTerrier",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0451922a-d2c6-4917-a2fd-3f3b3547d697",
            "created_at": "2022-10-25T16:07:24.391313Z",
            "updated_at": "2025-03-27T02:02:10.206474Z",
            "deleted_at": null,
            "main_name": "The White Company",
            "aliases": [
                "Operation Shaheen"
            ],
            "source_name": "ETDA:The White Company",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b23e717c-0b27-47e0-b3c8-4defe6dd857f",
            "created_at": "2023-01-06T13:46:38.367369Z",
            "updated_at": "2025-03-27T02:00:02.815758Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "ATK35",
                "Peach Sandstorm",
                "TA451",
                "APT 33",
                "Elfin",
                "Refined Kitten",
                "MAGNALLIUM",
                "HOLMIUM",
                "COBALT TRINITY",
                "G0064"
            ],
            "source_name": "MISPGALAXY:APT33",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9fe49a5b-f3e6-4fbf-99a1-db15dad460c3",
            "created_at": "2024-05-01T02:03:08.045004Z",
            "updated_at": "2025-03-27T02:05:17.325038Z",
            "deleted_at": null,
            "main_name": "COBALT TRINITY",
            "aliases": [
                "Elfin ",
                "HOLMIUM ",
                "MAGNALIUM ",
                "Peach Sandstorm ",
                "Refined Kitten ",
                "TA451 ",
                "APT33 "
            ],
            "source_name": "Secureworks:COBALT TRINITY",
            "tools": [
                " Cadlotcorg",
                " Dello RAT",
                " Imminent Monitor",
                " KDALogger",
                " Koadic",
                " NanoCore",
                " NetWire",
                " POWERTON",
                " PoshC2",
                " Poylog",
                " PupyRAT",
                " Schoolbag",
                "AutoCore"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ecff5c60-4f8b-4d7c-9784-f279eb056518",
            "created_at": "2022-10-25T15:50:23.49538Z",
            "updated_at": "2025-03-27T02:00:55.485485Z",
            "deleted_at": null,
            "main_name": "SilverTerrier",
            "aliases": [
                "SilverTerrier"
            ],
            "source_name": "MITRE:SilverTerrier",
            "tools": [
                "NanoCore",
                "Agent Tesla",
                "NETWIRE",
                "DarkComet",
                "Lokibot"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e5ff825b-0456-4013-b90a-971b93def74a",
            "created_at": "2022-10-25T15:50:23.824058Z",
            "updated_at": "2025-03-27T02:00:55.553346Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "APT33",
                "HOLMIUM",
                "Elfin",
                "Peach Sandstorm"
            ],
            "source_name": "MITRE:APT33",
            "tools": [
                "PowerSploit",
                "AutoIt backdoor",
                "PoshC2",
                "Mimikatz",
                "NanoCore",
                "DEADWOOD",
                "StoneDrill",
                "POWERTON",
                "LaZagne",
                "TURNEDUP",
                "NETWIRE",
                "Pupy",
                "ftp",
                "Shamoon"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536186,
    "ts_updated_at": 1743041717,
    "ts_creation_date": 1672273437,
    "ts_modification_date": 1672273437,
    "files": {
        "pdf": "https://archive.orkl.eu/a7c49f0823d110d9c31bc4a198bcf10eebfbaf75.pdf",
        "text": "https://archive.orkl.eu/a7c49f0823d110d9c31bc4a198bcf10eebfbaf75.txt",
        "img": "https://archive.orkl.eu/a7c49f0823d110d9c31bc4a198bcf10eebfbaf75.jpg"
    }
}